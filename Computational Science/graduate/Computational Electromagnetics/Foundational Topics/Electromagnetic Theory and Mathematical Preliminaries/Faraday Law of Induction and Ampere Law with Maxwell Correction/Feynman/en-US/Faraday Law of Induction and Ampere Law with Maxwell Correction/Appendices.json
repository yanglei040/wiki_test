{
    "hands_on_practices": [
        {
            "introduction": "Understanding the sources of the magnetic field is a cornerstone of electromagnetism. This first practice focuses on the Ampère-Maxwell law, $\\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} = I_{\\text{enc}}$, challenging you to compute the total enclosed current. This current includes both the flow of charges (conduction current, $\\mathbf{J}$) and the effect of a time-varying electric field (displacement current, $\\partial \\mathbf{D}/\\partial t$). By working through a hypothetical scenario with piecewise-defined sources , you will gain hands-on experience with the kind of spatial integration that is fundamental to many computational electromagnetics techniques.",
            "id": "3306604",
            "problem": "Consider a homogeneous, isotropic, source-driven time-varying electromagnetic field in free space modified by a dielectric inclusion. Let the rectangular surface $\\mathcal{S}$ lie in the $z=0$ plane with outward unit normal $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$ and boundary $\\partial\\mathcal{S}$ oriented counterclockwise when viewed from $+\\hat{\\mathbf{z}}$. The rectangle spans $x \\in [0,L_{x}]$ and $y \\in [0,L_{y}]$, with $L_{x} = 0.3 \\ \\mathrm{m}$ and $L_{y} = 0.2 \\ \\mathrm{m}$. The conduction current density is piecewise constant and purely normal to $\\mathcal{S}$:\n- In the subregion $R_{1}: x \\in [0,0.1], y \\in [0,0.2]$, $\\mathbf{J}(x,y)=J_{1}\\hat{\\mathbf{z}}$ with $J_{1}=5 \\ \\mathrm{A/m^{2}}$.\n- In the subregion $R_{2}: x \\in [0.1,0.2], y \\in [0.1,0.2]$, $\\mathbf{J}(x,y)=J_{2}\\hat{\\mathbf{z}}$ with $J_{2}=-3 \\ \\mathrm{A/m^{2}}$.\n- In the subregion $R_{3}: x \\in [0.2,0.3], y \\in [0,0.05]$, $\\mathbf{J}(x,y)=J_{3}\\hat{\\mathbf{z}}$ with $J_{3}=20 \\ \\mathrm{A/m^{2}}$.\nEverywhere else in $\\mathcal{S}$, $\\mathbf{J}(x,y)=\\mathbf{0}$.\n\nAdditionally, in the subregion $D_{1}: x \\in [0,0.3], y \\in [0.05,0.1]$, a time-harmonic electric field $\\mathbf{E}(x,y,t)=E_{0}\\cos(\\omega t)\\,\\hat{\\mathbf{z}}$ is present, with $E_{0}=100 \\ \\mathrm{V/m}$ and $\\omega = 10^{6} \\ \\mathrm{rad/s}$. The dielectric permittivity in $D_{1}$ is $\\varepsilon=\\varepsilon_{r}\\varepsilon_{0}$ with relative permittivity $\\varepsilon_{r}=4$ and vacuum permittivity $\\varepsilon_{0}=8.8541878128 \\times 10^{-12} \\ \\mathrm{F/m}$. Everywhere else, the permittivity is immaterial for this calculation because the electric field is zero. Assume the magnetic field $\\mathbf{H}$ is sufficiently smooth for Stokes’ theorem to apply.\n\nStarting from fundamental electromagnetic laws, compute the circulation $\\displaystyle \\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell}$ at the time instant $t_{0}=\\pi/(2\\omega)$, and verify its equality with the surface integral of $\\mathbf{J}+\\partial \\mathbf{D}/\\partial t$ over $\\mathcal{S}$ in the Ampère-Maxwell law. Express the final circulation in $\\mathrm{A}$ and round your answer to four significant figures.",
            "solution": "The problem requires the computation of the circulation of the magnetic field $\\mathbf{H}$ around the boundary $\\partial\\mathcal{S}$ of a rectangular surface $\\mathcal{S}$. The problem statement asks to verify its equality with the total current passing through $\\mathcal{S}$, as dictated by the Ampère-Maxwell law. The wording implies that the circulation is to be computed by evaluating the total current.\n\nThe fundamental principle governing this phenomenon is the Ampère-Maxwell law in its integral form, which relates the circulation of the magnetic field $\\mathbf{H}$ around a closed loop $\\partial\\mathcal{S}$ to the total current passing through the surface $\\mathcal{S}$ bounded by the loop. Applying Stokes' theorem, the law is written as:\n$$ \\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} = \\iint_{\\mathcal{S}} \\left( \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t} \\right) \\cdot d\\mathbf{S} $$\nwhere $\\mathbf{J}$ is the conduction current density and $\\frac{\\partial \\mathbf{D}}{\\partial t}$ is the displacement current density, with $\\mathbf{D}$ being the electric displacement field. The total current, $I_{\\text{total}}$, is the sum of the conduction current, $I_c = \\iint_{\\mathcal{S}} \\mathbf{J} \\cdot d\\mathbf{S}$, and the displacement current, $I_d = \\iint_{\\mathcal{S}} \\frac{\\partial \\mathbf{D}}{\\partial t} \\cdot d\\mathbf{S}$.\n\nOur task is to compute this total current at the specific time instant $t_{0}=\\pi/(2\\omega)$. The surface $\\mathcal{S}$ lies in the $z=0$ plane, so the differential surface element is $d\\mathbf{S} = dx\\,dy\\,\\hat{\\mathbf{z}}$. The outward normal is given as $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$, which is consistent with the counterclockwise path orientation.\n\nFirst, we compute the total conduction current, $I_c$, passing through the surface $\\mathcal{S}$. The conduction current density $\\mathbf{J}$ is given as piecewise constant and directed along $\\hat{\\mathbf{z}}$. Thus, $\\mathbf{J} \\cdot d\\mathbf{S} = J(x,y)\\,dx\\,dy$. The total conduction current is the sum of the currents through the subregions where $\\mathbf{J}$ is non-zero.\nThe integral for the conduction current is:\n$$ I_c = \\iint_{\\mathcal{S}} \\mathbf{J} \\cdot d\\mathbf{S} = \\iint_{R_1} J_1\\,dx\\,dy + \\iint_{R_2} J_2\\,dx\\,dy + \\iint_{R_3} J_3\\,dx\\,dy $$\nSince the current densities are constant within their respective rectangular regions, the integrals are the product of the density and the area of each region.\nThe area of subregion $R_{1}$ ($x \\in [0,0.1]$, $y \\in [0,0.2]$) is $A_{1} = (0.1 - 0)\\,\\mathrm{m} \\times (0.2 - 0)\\,\\mathrm{m} = 0.02\\,\\mathrm{m}^2$.\nThe area of subregion $R_{2}$ ($x \\in [0.1,0.2]$, $y \\in [0.1,0.2]$) is $A_{2} = (0.2 - 0.1)\\,\\mathrm{m} \\times (0.2 - 0.1)\\,\\mathrm{m} = 0.01\\,\\mathrm{m}^2$.\nThe area of subregion $R_{3}$ ($x \\in [0.2,0.3]$, $y \\in [0,0.05]$) is $A_{3} = (0.3 - 0.2)\\,\\mathrm{m} \\times (0.05 - 0)\\,\\mathrm{m} = 0.005\\,\\mathrm{m}^2$.\n\nUsing the given values for the current densities, $J_{1}=5 \\ \\mathrm{A/m^{2}}$, $J_{2}=-3 \\ \\mathrm{A/m^{2}}$, and $J_{3}=20 \\ \\mathrm{A/m^{2}}$, the total conduction current is:\n$$ I_c = J_{1}A_{1} + J_{2}A_{2} + J_{3}A_{3} = (5\\,\\mathrm{A/m^2})(0.02\\,\\mathrm{m^2}) + (-3\\,\\mathrm{A/m^2})(0.01\\,\\mathrm{m^2}) + (20\\,\\mathrm{A/m^2})(0.005\\,\\mathrm{m^2}) $$\n$$ I_c = 0.1\\,\\mathrm{A} - 0.03\\,\\mathrm{A} + 0.1\\,\\mathrm{A} = 0.17\\,\\mathrm{A} $$\n\nNext, we compute the displacement current, $I_d$, at time $t_{0}=\\pi/(2\\omega)$. The electric field $\\mathbf{E}$ is non-zero only in the subregion $D_1: x \\in [0,0.3], y \\in [0.05,0.1]$. In this region, $\\mathbf{E}(t) = E_{0}\\cos(\\omega t)\\,\\hat{\\mathbf{z}}$. The medium is a linear dielectric with permittivity $\\varepsilon = \\varepsilon_r\\varepsilon_0$, so the electric displacement field is $\\mathbf{D} = \\varepsilon\\mathbf{E}$.\n$$ \\mathbf{D}(t) = \\varepsilon_r\\varepsilon_0 E_{0}\\cos(\\omega t)\\,\\hat{\\mathbf{z}} $$\nThe displacement current density is the time derivative of $\\mathbf{D}$:\n$$ \\frac{\\partial \\mathbf{D}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left(\\varepsilon_r\\varepsilon_0 E_{0}\\cos(\\omega t)\\,\\hat{\\mathbf{z}}\\right) = -\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\sin(\\omega t)\\,\\hat{\\mathbf{z}} $$\nWe evaluate this at the specific time $t_{0} = \\pi/(2\\omega)$:\n$$ \\left.\\frac{\\partial \\mathbf{D}}{\\partial t}\\right|_{t=t_0} = -\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\sin\\left(\\omega \\frac{\\pi}{2\\omega}\\right)\\,\\hat{\\mathbf{z}} = -\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\sin\\left(\\frac{\\pi}{2}\\right)\\,\\hat{\\mathbf{z}} = -\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\,\\hat{\\mathbf{z}} $$\nThis displacement current density is spatially uniform over the region $D_1$ and zero elsewhere on $\\mathcal{S}$. The total displacement current is the integral of this density over the surface $\\mathcal{S}$. The integral is non-zero only over $D_1$.\n$$ I_d(t_0) = \\iint_{\\mathcal{S}} \\left.\\frac{\\partial \\mathbf{D}}{\\partial t}\\right|_{t=t_0} \\cdot d\\mathbf{S} = \\iint_{D_1} (-\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\,\\hat{\\mathbf{z}}) \\cdot (dx\\,dy\\,\\hat{\\mathbf{z}}) $$\nSince the integrand is constant, the integral is the product of the integrand and the area of region $D_1$.\nThe area of subregion $D_1$ is $A_{D1} = (0.3 - 0)\\,\\mathrm{m} \\times (0.1 - 0.05)\\,\\mathrm{m} = 0.3\\,\\mathrm{m} \\times 0.05\\,\\mathrm{m} = 0.015\\,\\mathrm{m}^2$.\nNow, we substitute the given numerical values: $\\varepsilon_r=4$, $\\varepsilon_{0}=8.8541878128 \\times 10^{-12} \\ \\mathrm{F/m}$, $E_{0}=100 \\ \\mathrm{V/m}$, and $\\omega = 10^{6} \\ \\mathrm{rad/s}$.\n$$ I_d(t_0) = -(\\varepsilon_r\\varepsilon_0 E_{0}\\omega) A_{D1} $$\n$$ I_d(t_0) = -(4)(8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m})(100\\,\\mathrm{V/m})(10^6\\,\\mathrm{rad/s})(0.015\\,\\mathrm{m^2}) $$\n$$ I_d(t_0) = -(4 \\times 100 \\times 10^6 \\times 0.015) \\times (8.8541878128 \\times 10^{-12}) \\ \\mathrm{A} $$\n$$ I_d(t_0) = -(6 \\times 10^6) \\times (8.8541878128 \\times 10^{-12}) \\ \\mathrm{A} $$\n$$ I_d(t_0) = -53.1251268768 \\times 10^{-6} \\ \\mathrm{A} \\approx -0.000053125 \\ \\mathrm{A} $$\nThe total current is the sum of the conduction and displacement currents:\n$$ I_{\\text{total}}(t_0) = I_c + I_d(t_0) = 0.17\\,\\mathrm{A} - 0.0000531251268768\\,\\mathrm{A} = 0.16994687487312\\,\\mathrm{A} $$\nThe circulation is equal to this total current:\n$$ \\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} = 0.16994687487312\\,\\mathrm{A} $$\nThe problem asks for the answer to be rounded to four significant figures. The first four significant figures are $1$, $6$, $9$, $9$. The fifth digit is $4$, so we round down.\n$$ \\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} \\approx 0.1699\\,\\mathrm{A} $$\nThis result verifies the equality demanded by the Ampère-Maxwell law by explicitly calculating the right-hand side of the equation.",
            "answer": "$$ \\boxed{0.1699} $$"
        },
        {
            "introduction": "The true power of Maxwell's equations is revealed when Faraday's law and the Ampère-Maxwell law are considered together, as they describe how electric and magnetic fields can sustain each other to form propagating waves. However, it is not always necessary or efficient to solve the full wave equations. This exercise  has you derive the wave equation and then assess the validity of the electroquasistatic (EQS) approximation by comparing the electromagnetic wavelength to the size of the system, a critical skill in computational modeling that balances physical accuracy with computational cost.",
            "id": "3306587",
            "problem": "A homogeneous, isotropic, lossless dielectric body occupies free space. There are no free charges or currents in the region. The material parameters are given as $ \\epsilon = \\epsilon_{r}\\,\\epsilon_{0} $ with $ \\epsilon_{r} = 9.000 $, and $ \\mu = \\mu_{r}\\,\\mu_{0} $ with $ \\mu_{r} = 1.000 $. The largest linear extent of the geometry is $ L = 2.000 \\times 10^{-2}\\,\\text{m} $. The body is excited by a time-harmonic field of frequency $ f = 1.000 \\times 10^{7}\\,\\text{Hz} $ (use radians for any phase quantities). The vacuum constants are $ \\epsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1} $ and $ \\mu_{0} = 4\\pi \\times 10^{-7}\\,\\text{H}\\,\\text{m}^{-1} $.\n\nUsing only Faraday’s law of induction $ \\nabla \\times \\mathbf{E} = -\\dfrac{\\partial \\mathbf{B}}{\\partial t} $ and Ampère's law with Maxwell’s correction $ \\nabla \\times \\mathbf{H} = \\dfrac{\\partial \\mathbf{D}}{\\partial t} $ in a source-free, homogeneous medium, together with the constitutive relations $ \\mathbf{D} = \\epsilon \\mathbf{E} $ and $ \\mathbf{B} = \\mu \\mathbf{H} $, derive the dispersion relation, infer the phase velocity $ v_{p} $ and wavelength $ \\lambda $, and quantify the electroquasistatic (EQS) validity using the dimensionless parameter $ kL $, where $ k $ is the wavenumber. Report the numerical value of $ kL $ for the given data. Round your answer to four significant figures. Express the final result as a dimensionless number with no units.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on the fundamental principles of classical electromagnetism as described by Maxwell's equations. All provided data is physically realistic and sufficient for a unique solution.\n\nThe derivation begins with the two curl equations from Maxwell's theory for a source-free ($ \\rho = 0 $, $ \\mathbf{J} = 0 $), homogeneous, isotropic, and lossless medium.\n\nFaraday’s law of induction is given as:\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\nAmpère’s law with Maxwell’s correction is:\n$$ \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t} $$\nThe constitutive relations for the linear, isotropic medium are:\n$$ \\mathbf{D} = \\epsilon \\mathbf{E} $$\n$$ \\mathbf{B} = \\mu \\mathbf{H} $$\nwhere $ \\epsilon = \\epsilon_{r}\\,\\epsilon_{0} $ and $ \\mu = \\mu_{r}\\,\\mu_{0} $ are the permittivity and permeability of the medium, respectively.\n\nSubstituting the constitutive relations into Maxwell's equations, we obtain:\n$$ \\nabla \\times \\mathbf{E} = -\\mu \\frac{\\partial \\mathbf{H}}{\\partial t} \\quad (1) $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t} \\quad (2) $$\nTo derive a wave equation for the electric field $ \\mathbf{E} $, we take the curl of equation $(1)$:\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla \\times \\left(-\\mu \\frac{\\partial \\mathbf{H}}{\\partial t}\\right) $$\nSince the medium is homogeneous, $ \\mu $ is spatially constant. Additionally, the space and time derivatives are independent, so we can commute the operators:\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\mu \\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{H}) $$\nSubstituting equation $(2)$ into the right-hand side yields:\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\mu \\frac{\\partial}{\\partial t}\\left(\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}\\right) = -\\mu\\epsilon \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} $$\nWe now apply the vector identity $ \\nabla \\times (\\nabla \\times \\mathbf{V}) = \\nabla(\\nabla \\cdot \\mathbf{V}) - \\nabla^2 \\mathbf{V} $ to the left-hand side:\n$$ \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E} = -\\mu\\epsilon \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} $$\nIn a source-free region ($ \\rho=0 $), Gauss's law for electricity, $ \\nabla \\cdot \\mathbf{D} = \\rho $, simplifies to $ \\nabla \\cdot \\mathbf{D} = 0 $. Given $ \\mathbf{D} = \\epsilon \\mathbf{E} $ and a homogeneous permittivity $ \\epsilon $, this implies $ \\nabla \\cdot \\mathbf{E} = 0 $. The equation thus reduces to the homogeneous vector wave equation:\n$$ \\nabla^2 \\mathbf{E} - \\mu\\epsilon \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} = 0 $$\nFor a time-harmonic field with angular frequency $ \\omega $, the fields have a time dependence of the form $ e^{i\\omega t} $. Consequently, the time derivative operator can be replaced by $ \\frac{\\partial}{\\partial t} \\to i\\omega $, and the second time derivative by $ \\frac{\\partial^2}{\\partial t^2} \\to (i\\omega)^2 = -\\omega^2 $. The wave equation becomes the vector Helmholtz equation:\n$$ \\nabla^2 \\mathbf{E} - \\mu\\epsilon (-\\omega^2\\mathbf{E}) = 0 $$\n$$ \\nabla^2 \\mathbf{E} + \\omega^2\\mu\\epsilon\\mathbf{E} = 0 $$\nTo find the dispersion relation, we consider a plane wave solution of the form $ \\mathbf{E}(\\mathbf{r}) = \\mathbf{E}_{0} e^{-i\\mathbf{k} \\cdot \\mathbf{r}} $, where $ \\mathbf{k} $ is the wave vector. For this solution, the Laplacian operator acts as $ \\nabla^2 \\to -|\\mathbf{k}|^2 = -k^2 $. Substituting this into the Helmholtz equation:\n$$ -k^2\\mathbf{E} + \\omega^2\\mu\\epsilon\\mathbf{E} = 0 $$\nFor a non-trivial solution ($ \\mathbf{E} \\neq 0 $), the scalar coefficient must be zero. This gives the dispersion relation for the medium:\n$$ k^2 = \\omega^2\\mu\\epsilon $$\nThe phase velocity $ v_p $ is defined as $ v_p = \\frac{\\omega}{k} $. From the dispersion relation, we infer:\n$$ v_p = \\frac{\\omega}{\\omega\\sqrt{\\mu\\epsilon}} = \\frac{1}{\\sqrt{\\mu\\epsilon}} $$\nThe wavelength is $ \\lambda = \\frac{2\\pi}{k} $, which can also be expressed as $ \\lambda = \\frac{v_p}{f} $.\n\nNow we calculate the numerical value of the dimensionless parameter $ kL $. The wavenumber $ k $ is given by:\n$$ k = \\omega \\sqrt{\\mu\\epsilon} = (2\\pi f) \\sqrt{(\\mu_r\\mu_0)(\\epsilon_r\\epsilon_0)} = 2\\pi f \\sqrt{\\mu_r\\epsilon_r} \\sqrt{\\mu_0\\epsilon_0} $$\nThe speed of light in vacuum is $ c = 1/\\sqrt{\\mu_0\\epsilon_0} $. Thus, we can write $ k $ as:\n$$ k = \\frac{2\\pi f \\sqrt{\\mu_r\\epsilon_r}}{c} $$\nThe dimensionless parameter $ kL $ is therefore:\n$$ kL = \\frac{2\\pi f L \\sqrt{\\mu_r\\epsilon_r}}{c} $$\nThe problem provides the following values:\n$ f = 1.000 \\times 10^{7}\\,\\text{Hz} $\n$ L = 2.000 \\times 10^{-2}\\,\\text{m} $\n$ \\epsilon_{r} = 9.000 $\n$ \\mu_{r} = 1.000 $\n$ \\epsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1} $\n$ \\mu_{0} = 4\\pi \\times 10^{-7}\\,\\text{H}\\,\\text{m}^{-1} $\n\nFirst, we calculate the speed of light $ c $ from the given vacuum constants:\n$$ c = \\frac{1}{\\sqrt{\\mu_0 \\epsilon_0}} = \\frac{1}{\\sqrt{(4\\pi \\times 10^{-7}\\,\\text{H}\\,\\text{m}^{-1})(8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1})}} = 299\\,792\\,458\\,\\text{m}\\,\\text{s}^{-1} $$\nNow, we substitute the values into the expression for $ kL $:\n$$ kL = \\frac{2\\pi (1.000 \\times 10^{7}) (2.000 \\times 10^{-2}) \\sqrt{9.000 \\times 1.000}}{299\\,792\\,458} $$\n$$ kL = \\frac{2\\pi (2.000 \\times 10^{5}) \\sqrt{9.000}}{299\\,792\\,458} = \\frac{2\\pi (2.000 \\times 10^{5}) (3.000)}{299\\,792\\,458} $$\n$$ kL = \\frac{12.00\\pi \\times 10^{5}}{299\\,792\\,458} \\approx \\frac{3\\,769\\,911.18}{299\\,792\\,458} $$\n$$ kL \\approx 0.012575028 $$\nThe electroquasistatic (EQS) approximation is valid when the dimensions of the system are much smaller than the wavelength, i.e., $ L \\ll \\lambda $. This is equivalent to the condition $ kL \\ll 2\\pi $, and more strictly $ kL \\ll 1 $. The small value of $ kL $ obtained confirms that the EQS approximation would be highly accurate for this scenario.\n\nRounding the result to four significant figures:\nThe first four significant digits are $ 1 $, $ 2 $, $ 5 $, and $ 7 $. The fifth digit is $ 5 $, which requires rounding up the fourth digit.\n$$ kL \\approx 0.01258 $$",
            "answer": "$$\\boxed{0.01258}$$"
        },
        {
            "introduction": "Moving beyond forward problems, this advanced computational practice immerses you in an inverse problem: recovering unknown fields from measured data. You are tasked with building a numerical solver to reconstruct a time-varying magnetic field from boundary measurements of the electromotive force. Success requires you to discretize and simultaneously enforce Faraday's law, the divergence-free nature of the magnetic field, and a wave-equation-based regularization. This exercise  provides direct experience with the sophisticated methods that power real-world applications from geophysical exploration to medical imaging.",
            "id": "3306628",
            "problem": "You are tasked with designing and implementing an inverse solver in computational electromagnetics to recover a time-varying magnetic flux distribution consistent with Faraday's law of induction and Ampère's law with Maxwell's correction. The recovery must enforce a divergence-free constraint. The program must be complete and runnable.\n\nA rectangular domain of dimensions $L_x$, $L_y$, and $L_z$ in vacuum is discretized into a uniform grid of $N_x \\times N_y \\times N_z$ cells using a finite-volume layout. Let the cell sizes be $h_x = L_x/N_x$, $h_y = L_y/N_y$, and $h_z = L_z/N_z$. Faces are grouped by their outward normal directions: $x$-faces, $y$-faces, and $z$-faces. For each face $f$, define the magnetic flux $\\Phi_f(t) = \\int_{S_f} \\mathbf{B}(\\mathbf{r},t)\\cdot \\mathbf{n}_f \\, dS$ with units in weber. For each rectangular face $f$, the time-varying electromotive force (EMF) measured along the rectangular loop bounding that face is given by the line integral $\\mathcal{E}_f(t) = \\oint_{\\partial S_f} \\mathbf{E}(\\mathbf{r},t) \\cdot d\\mathbf{l}$ in volts, and Faraday’s law of induction implies $\\mathcal{E}_f(t) = - \\frac{d}{dt}\\Phi_f(t)$. You are given synthetic EMF data on the loops bounding each face over a set of discrete times, and you must recover the face fluxes $\\Phi_f(t)$ at those times.\n\nTo ensure physical consistency, you must impose the divergence-free constraint from Maxwell’s equations, $\\nabla \\cdot \\mathbf{B} = 0$, in finite-volume form: for each cell $c$ at time $t$, the sum of outward magnetic fluxes across its six faces must be $0$. In addition, in vacuum and with no free currents, Ampère’s law with Maxwell’s correction in differential form, $\\nabla \\times \\mathbf{B} = \\mu_0 \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$, combined with Faraday’s law $\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$, yields the homogeneous wave equation for the magnetic flux density, $\\nabla^2 \\mathbf{B} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{B}}{\\partial t^2} = \\mathbf{0}$, where $c = \\frac{1}{\\sqrt{\\mu_0 \\epsilon_0}}$ is the speed of light in vacuum. Your recovery must regularize the solution to be consistent with this wave equation, discretized appropriately on the face-centered grid and across discrete times.\n\nYou must implement a linear least-squares inverse solver that, for all faces $f$ and discrete times $t_k$, enforces the measurement relations implied by Faraday’s law via discrete time derivatives, the finite-volume divergence-free constraint for each cell and time, and a wave-equation regularization consistent with Ampère’s law with Maxwell’s correction and Faraday’s law. Use vacuum parameters $\\mu_0 = 4\\pi \\times 10^{-7}$ henries per meter and $\\epsilon_0 = 8.854187817 \\times 10^{-12}$ farads per meter; report any magnetic field quantities in tesla and magnetic flux in weber; EMF must be in volts; time must be in seconds; lengths must be in meters; angles are not used. Implement central differences for interior time points and appropriate spatial finite differences for the Laplacian operator on face-centered unknowns, applied component-wise.\n\nDefine the following test suite with three cases, each run on the same grid and time set:\n\n- Grid and time parameters common to all test cases:\n  - Domain sizes: $L_x = 1.0\\,\\mathrm{m}$, $L_y = 1.0\\,\\mathrm{m}$, $L_z = 1.0\\,\\mathrm{m}$.\n  - Grid: $N_x = 2$, $N_y = 2$, $N_z = 2$.\n  - Time samples: $t_k = k \\Delta t$ for $k \\in \\{0,1,2,3,4\\}$ with $\\Delta t = 1.0\\times 10^{-9}\\,\\mathrm{s}$.\n- Case $1$ (noise-free plane wave): A source-free vacuum plane wave magnetic flux density given by $\\mathbf{B}(\\mathbf{r},t) = B_0 \\cos(k x - \\omega t)\\, \\hat{\\mathbf{y}}$, where $B_0 = 1.0 \\times 10^{-6}\\,\\mathrm{T}$, $k = 2\\pi\\,\\mathrm{m}^{-1}$, and $\\omega = c\\,k$. The EMF data is generated by applying Faraday’s law to the rectangular loops bounding each face: for a $y$-oriented face $f$ lying in the $x$-$z$ plane with area $A_y = h_x h_z$, $\\Phi_f(t) = A_y B_y(\\mathbf{r}_f,t)$ and $\\mathcal{E}_f(t) = - \\frac{d}{dt}\\Phi_f(t)$; for other faces, $\\Phi_f(t) = 0$ and $\\mathcal{E}_f(t) = 0$.\n- Case $2$ (static): Zero EMF on all face loops for all times: $\\mathcal{E}_f(t) = 0$ for all $f$ and $t$, with corresponding true magnetic flux $\\Phi_f(t) = 0$.\n- Case $3$ (noisy plane wave): Same as Case $1$, but the EMF data is contaminated with additive zero-mean Gaussian noise with standard deviation $\\sigma_{\\mathcal{E}} = 5.0 \\times 10^{-3}$ times the maximum absolute EMF magnitude in Case $1$ across all faces and times.\n\nYour program must:\n- Construct the synthetic EMF data $\\mathcal{E}_f(t_k)$ for each test case.\n- Formulate and solve the linear least-squares system to recover the face fluxes $\\Phi_f(t_k)$ across all faces and times, using:\n  - Discrete Faraday constraints: for each face $f$ at interior time indices $k \\in \\{1,2,3\\}$, enforce $\\frac{\\Phi_f(t_{k+1}) - \\Phi_f(t_{k-1})}{2\\Delta t} + \\mathcal{E}_f(t_k) = 0$.\n  - Discrete divergence-free constraints: for each cell $c$ and time $k \\in \\{0,1,2,3,4\\}$, the sum of outward fluxes across the six faces of cell $c$ must be $0$.\n  - Discrete wave-equation regularization: for each $y$-face $f$ at interior time indices $k \\in \\{1,2,3\\}$, penalize departures from $\\frac{\\Phi_f(t_{k+1}) - 2\\Phi_f(t_k) + \\Phi_f(t_{k-1})}{\\Delta t^2} - c^2 \\nabla^2 \\Phi_f(t_k) = 0$, where the discrete Laplacian $\\nabla^2$ on $y$-faces is defined by second-order central differences using neighboring $y$-faces along $x$, $y$, and $z$ directions with appropriate grid spacings $h_x$, $h_y$, and $h_z$.\n  - Use physically sensible regularization weights to stabilize the inversion. All constraints should be linear in the unknown fluxes.\n- Recover the $y$-component magnetic flux density on $y$-faces by $B_y(\\mathbf{r}_f,t_k) = \\Phi_f(t_k) / A_y$. For $x$- and $z$-faces, the true $B$-component is $0$.\n- Compute, for each test case, the root-mean-square error in tesla between the recovered $B_y$ on $y$-faces and the true $B_y$ on $y$-faces across all $y$-faces and times.\n\nYour program should produce a single line of output containing the three root-mean-square errors for the three test cases as a comma-separated list enclosed in square brackets, in the format $[r_1,r_2,r_3]$, where each $r_i$ is a float in tesla. No other text may be printed. All calculations must be carried out in SI units as specified above. Angles are not used and must not appear in the output. The final program must be self-contained and must not read input from any external source, nor require any user interaction.",
            "solution": "The problem posed is an inverse problem in computational electromagnetics, which requires the recovery of a time-varying magnetic flux distribution from synthetic electromotive force (EMF) data. The solution must be consistent with Faraday's law of induction, the divergence-free condition for the magnetic field ($\\nabla \\cdot \\mathbf{B} = 0$), and be regularized by the homogeneous electromagnetic wave equation. The problem is scientifically grounded, well-posed with the inclusion of regularization, and provides a clear, objective task. All physical laws, constants, and discretization schemes are standard and appropriate for the domain of computational electromagnetics. A minor ambiguity regarding the boundary conditions for the discrete Laplacian operator is resolved by assuming periodic boundary conditions, which is consistent with the plane wave solution provided for generating test data.\n\nThe solution is formulated as a linear least-squares problem, expressed as minimizing $\\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}\\|_2^2$. The vector of unknowns $\\mathbf{x}$ consists of the magnetic fluxes $\\Phi_f(t_k)$ for all faces $f$ of a discretized rectangular grid at a set of discrete times $t_k$. The matrix $\\mathbf{A}$ and vector $\\mathbf{b}$ are constructed by assembling equations representing the physical constraints.\n\n1.  **Discretization and Variables**: The domain is a $1.0\\,\\mathrm{m} \\times 1.0\\,\\mathrm{m} \\times 1.0\\,\\mathrm{m}$ cube, discretized into a $N_x=2, N_y=2, N_z=2$ grid of cells. The magnetic flux unknowns are defined on the faces of these cells. This results in $(N_x+1)N_y N_z = 12$ x-faces, $N_x(N_y+1)N_z = 12$ y-faces, and $N_x N_y (N_z+1) = 12$ z-faces, for a total of $36$ faces. Fluxes are to be recovered at $5$ discrete time points. Therefore, the total number of scalar unknowns is $36 \\times 5 = 180$. These are arranged into a single column vector $\\mathbf{x}$.\n\n2.  **Constraint Equations**:\n    *   **Faraday's Law**: For each of the $36$ faces and for interior time indices $k \\in \\{1,2,3\\}$, a constraint is imposed based on the central-difference approximation of Faraday's law: $\\frac{\\Phi_f(t_{k+1}) - \\Phi_f(t_{k-1})}{2\\Delta t} = - \\mathcal{E}_f(t_k)$. This yields $36 \\times 3 = 108$ linear equations. These equations form the primary data-fitting part of the least-squares system.\n    *   **Divergence-Free Constraint**: For each of the $N_x N_y N_z = 8$ cells and for all $5$ time steps, the finite-volume form of $\\nabla \\cdot \\mathbf{B}=0$ is enforced. This states that the sum of magnetic fluxes out of the six faces of a cell is zero. This provides $8 \\times 5 = 40$ homogeneous linear equations.\n    *   **Wave Equation Regularization**: To ensure a physically smooth and stable solution, the homogeneous wave equation $\\nabla^2 \\mathbf{B} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{B}}{\\partial t^2} = \\mathbf{0}$ is imposed as a regularization constraint. This equation is discretized for the fluxes on the $12$ y-faces at interior times $k \\in \\{1,2,3\\}$, providing $12 \\times 3 = 36$ additional homogeneous equations. The temporal second derivative is approximated using a central difference. The spatial Laplacian $\\nabla^2$ is also discretized using second-order central differences. To handle faces near the domain boundary, periodic boundary conditions are assumed, which is consistent with the nature of the plane-wave test case.\n\n3.  **System Formulation and Scaling**: The total set of constraints comprises $108 + 40 + 36 = 184$ linear equations for $180$ unknowns, forming an overdetermined system. To balance the influence of the different physical principles, the equations are weighted. The divergence equations are scaled by a factor $w_{div} = 1/(2\\Delta t)$ to match the coefficient magnitudes of the Faraday's law equations. The wave equation constraints, which act as regularization, are scaled by $w_{wave} = \\Delta t/2$ to ensure their coefficients are also of a comparable order of magnitude. This choice of \"physically sensible\" weights leads to a well-conditioned least-squares problem.\n\n4.  **Solver and Evaluation**: The complete system $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ is constructed, where $\\mathbf{A}$ contains the coefficients of the flux unknowns from all weighted constraints, and $\\mathbf{b}$ contains the (negated) EMF data and zeros for the homogeneous constraints. The system is solved for $\\mathbf{x}$ using a standard linear least-squares solver (`numpy.linalg.lstsq`). For each test case, the recovered fluxes on the y-faces are converted to magnetic field strengths $B_y = \\Phi_y / A_y$ and compared against the known true values. The root-mean-square error (RMSE) is calculated over all y-faces and all time steps to quantify the accuracy of the reconstruction. This process is repeated for the three specified test cases: a noise-free plane wave, a static zero-field case, and a noisy plane wave.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the root-mean-square error for an inverse electromagnetic problem.\n    \"\"\"\n    \n    # Grid and time parameters\n    Lx, Ly, Lz = 1.0, 1.0, 1.0\n    Nx, Ny, Nz = 2, 2, 2\n    hx, hy, hz = Lx / Nx, Ly / Ny, Lz / Nz\n    dt = 1.0e-9\n    times = np.arange(5, dtype=float) * dt\n    Nt = len(times)\n\n    # Physical constants\n    mu0 = 4 * np.pi * 1e-7\n    eps0 = 8.854187817e-12\n    c = 1 / np.sqrt(mu0 * eps0)\n\n    # Enumerate all faces and create mappings for easy lookup.\n    # A face is identified by its type ('x', 'y', 'z') and grid indices (i, j, k).\n    faces = []\n    face_map = {}\n    face_id_counter = 0\n\n    # X-faces: (Nx+1) x Ny x Nz\n    for i in range(Nx + 1):\n        for j in range(Ny):\n            for k in range(Nz):\n                center = np.array([i * hx, (j + 0.5) * hy, (k + 0.5) * hz])\n                f_props = {'id': face_id_counter, 'type': 'x', 'i': i, 'j': j, 'k': k, 'center': center, 'area': hy * hz}\n                faces.append(f_props)\n                face_map[('x', i, j, k)] = f_props\n                face_id_counter += 1\n    \n    # Y-faces: Nx x (Ny+1) x Nz\n    y_face_ids = []\n    for i in range(Nx):\n        for j in range(Ny + 1):\n            for k in range(Nz):\n                center = np.array([(i + 0.5) * hx, j * hy, (k + 0.5) * hz])\n                f_props = {'id': face_id_counter, 'type': 'y', 'i': i, 'j': j, 'k': k, 'center': center, 'area': hx * hz}\n                faces.append(f_props)\n                face_map[('y', i, j, k)] = f_props\n                y_face_ids.append(face_id_counter)\n                face_id_counter += 1\n    num_y_faces = len(y_face_ids)\n\n    # Z-faces: Nx x Ny x (Nz+1)\n    for i in range(Nx):\n        for j in range(Ny):\n            for k in range(Nz + 1):\n                center = np.array([(i + 0.5) * hx, (j + 0.5) * hy, k * hz])\n                f_props = {'id': face_id_counter, 'type': 'z', 'i': i, 'j': j, 'k': k, 'center': center, 'area': hx * hy}\n                faces.append(f_props)\n                face_map[('z', i, j, k)] = f_props\n                face_id_counter += 1\n    \n    num_faces = len(faces)\n    num_unknowns = num_faces * Nt\n\n    # Construct the least-squares matrix A\n    num_faraday_eqs = num_faces * (Nt - 2)\n    num_div_eqs = Nx * Ny * Nz * Nt\n    num_wave_eqs = num_y_faces * (Nt - 2)\n    num_eqs = num_faraday_eqs + num_div_eqs + num_wave_eqs\n    \n    A = np.zeros((num_eqs, num_unknowns))\n    \n    # Regularization weights chosen to balance coefficient magnitudes\n    w_div = 1.0 / (2 * dt)\n    w_wave = dt / 2.0\n\n    def get_flux_idx(face_id, time_idx):\n        return face_id * Nt + time_idx\n\n    row_idx = 0\n\n    # 1. Faraday's Law constraints\n    for f in faces:\n        for k_t in range(1, Nt - 1):\n            A[row_idx, get_flux_idx(f['id'], k_t + 1)] = 1.0 / (2 * dt)\n            A[row_idx, get_flux_idx(f['id'], k_t - 1)] = -1.0 / (2 * dt)\n            row_idx += 1\n\n    # 2. Divergence-free constraints\n    for ic in range(Nx):\n        for jc in range(Ny):\n            for kc in range(Nz):\n                face_ids = [\n                    face_map[('x', ic + 1, jc, kc)]['id'], face_map[('x', ic, jc, kc)]['id'],\n                    face_map[('y', ic, jc + 1, kc)]['id'], face_map[('y', ic, jc, kc)]['id'],\n                    face_map[('z', ic, jc, kc + 1)]['id'], face_map[('z', ic, jc, kc)]['id']\n                ]\n                signs = [1, -1, 1, -1, 1, -1]\n                for k_t in range(Nt):\n                    for i_f, f_id in enumerate(face_ids):\n                        A[row_idx, get_flux_idx(f_id, k_t)] = signs[i_f] * w_div\n                    row_idx += 1\n\n    # 3. Wave equation regularization for y-faces\n    for f_id in y_face_ids:\n        f = faces[f_id]\n        i, j, k = f['i'], f['j'], f['k']\n        for k_t in range(1, Nt - 1):\n            # Time derivative part\n            A[row_idx, get_flux_idx(f_id, k_t + 1)] = w_wave / (dt**2)\n            A[row_idx, get_flux_idx(f_id, k_t)]     -= 2 * w_wave / (dt**2)\n            A[row_idx, get_flux_idx(f_id, k_t - 1)] = w_wave / (dt**2)\n\n            # Spatial derivative (Laplacian) part, assuming periodic BCs\n            laplacian_term = 0.0\n            # x-neighbors\n            f_xp = face_map[('y', (i + 1) % Nx, j, k)]['id']\n            f_xn = face_map[('y', (i - 1 + Nx) % Nx, j, k)]['id']\n            A[row_idx, get_flux_idx(f_xp, k_t)] -= w_wave * c**2 / hx**2\n            laplacian_term += 2.0 / hx**2\n            A[row_idx, get_flux_idx(f_xn, k_t)] -= w_wave * c**2 / hx**2\n            # y-neighbors\n            f_yp = face_map[('y', i, (j + 1) % (Ny + 1), k)]['id']\n            f_yn = face_map[('y', i, (j - 1 + Ny + 1) % (Ny + 1), k)]['id']\n            A[row_idx, get_flux_idx(f_yp, k_t)] -= w_wave * c**2 / hy**2\n            laplacian_term += 2.0 / hy**2\n            A[row_idx, get_flux_idx(f_yn, k_t)] -= w_wave * c**2 / hy**2\n            # z-neighbors\n            f_zp = face_map[('y', i, j, (k + 1) % Nz)]['id']\n            f_zn = face_map[('y', i, j, (k - 1 + Nz) % Nz)]['id']\n            A[row_idx, get_flux_idx(f_zp, k_t)] -= w_wave * c**2 / hz**2\n            laplacian_term += 2.0 / hz**2\n            A[row_idx, get_flux_idx(f_zn, k_t)] -= w_wave * c**2 / hz**2\n            \n            A[row_idx, get_flux_idx(f_id, k_t)] += w_wave * c**2 * laplacian_term\n            row_idx += 1\n\n    # --- Test Cases ---\n    results = []\n    \n    # Test Case Parameters\n    B0 = 1.0e-6\n    k_wave = 2 * np.pi / Lx\n    omega = c * k_wave\n    \n    def true_B_y(x, t): return B0 * np.cos(k_wave * x - omega * t)\n    def true_EMF_y(x, t, area): return area * B0 * omega * np.sin(k_wave * x - omega * t)\n\n    # --- Generate data for all cases ---\n    # Case 1: Noise-free plane wave\n    emf_case1 = np.zeros(num_faraday_eqs)\n    true_fluxes_case1 = np.zeros(num_unknowns)\n    true_B_y_vals = np.zeros(num_y_faces * Nt)\n    b_y_idx = 0\n    faraday_row_counter = 0\n    for f in faces:\n        for k_t in range(Nt):\n            if f['type'] == 'y':\n                val = true_B_y(f['center'][0], times[k_t])\n                true_fluxes_case1[get_flux_idx(f['id'], k_t)] = f['area'] * val\n                true_B_y_vals[b_y_idx] = val\n                b_y_idx += 1\n        for k_t in range(1, Nt - 1):\n             if f['type'] == 'y':\n                 emf_case1[faraday_row_counter] = -true_EMF_y(f['center'][0], times[k_t], f['area'])\n             faraday_row_counter += 1\n\n    # Case 2: Static (zero field)\n    emf_case2 = np.zeros(num_faraday_eqs)\n    true_fluxes_case2 = np.zeros(num_unknowns)\n    true_B_y_vals_case2 = np.zeros_like(true_B_y_vals)\n\n    # Case 3: Noisy plane wave\n    max_emf_abs = np.max(np.abs(emf_case1)) if emf_case1.size > 0 else 0\n    sigma_emf = 5.0e-3 * max_emf_abs\n    rng = np.random.default_rng(seed=42) # for reproducibility\n    noise = rng.normal(0, sigma_emf, num_faraday_eqs)\n    emf_case3 = emf_case1 + noise\n\n    test_cases_data = [\n        (\"Case 1\", emf_case1, true_B_y_vals),\n        (\"Case 2\", emf_case2, true_B_y_vals_case2),\n        (\"Case 3\", emf_case3, true_B_y_vals)\n    ]\n\n    for name, emf_data, true_B_vals in test_cases_data:\n        # Construct the b vector for the least-squares system\n        b = np.zeros(num_eqs)\n        b[:num_faraday_eqs] = emf_data\n        \n        # Solve the system\n        recovered_fluxes, _, _, _ = np.linalg.lstsq(A, b, rcond=None)\n        \n        # Extract recovered B_y and calculate RMSE\n        recovered_B_y_vals = np.zeros(num_y_faces * Nt)\n        b_y_idx = 0\n        for f_id in y_face_ids:\n            area = faces[f_id]['area']\n            for k_t in range(Nt):\n                recovered_B_y_vals[b_y_idx] = recovered_fluxes[get_flux_idx(f_id, k_t)] / area\n                b_y_idx += 1\n        \n        rmse = np.sqrt(np.mean((recovered_B_y_vals - true_B_vals)**2))\n        results.append(rmse)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}