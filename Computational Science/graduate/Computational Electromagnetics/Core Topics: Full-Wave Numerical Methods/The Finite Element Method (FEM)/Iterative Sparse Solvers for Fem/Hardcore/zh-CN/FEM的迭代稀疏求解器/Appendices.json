{
    "hands_on_practices": [
        {
            "introduction": "在有限元方法 (FEM) 中，我们处理大型稀疏矩阵，如刚度矩阵 $A$ 和质量矩阵 $M_{\\epsilon}$。本练习将揭开这些抽象算子的神秘面纱。通过在一个小而具体的网格上手动构建这些矩阵，您将对网格拓扑、单元类型和自由度排序如何直接决定最终系统矩阵的结构、稀疏性和带宽有一个切实的理解 。这对于调试和性能优化是一项基本技能。",
            "id": "3321760",
            "problem": "考虑在一个小网格上，二维空间中横向电场近似的频域麦克斯韦旋度-旋度公式，该公式在一个适定边（Whitney $1$-形式）有限元空间中。设计算域由三个具有逆时针方向的三角形网格化，其顶点坐标如下：\n$$\n\\mathbf{v}_{0}=(0,0),\\quad \\mathbf{v}_{1}=(1,0),\\quad \\mathbf{v}_{2}=(0,1),\\quad \\mathbf{v}_{3}=(1,1),\\quad \\mathbf{v}_{4}=(2,0).\n$$\n单元（面）如下：\n$$\nK_{1}=\\triangle(\\mathbf{v}_{0},\\mathbf{v}_{1},\\mathbf{v}_{2}),\\quad K_{2}=\\triangle(\\mathbf{v}_{1},\\mathbf{v}_{3},\\mathbf{v}_{2}),\\quad K_{3}=\\triangle(\\mathbf{v}_{1},\\mathbf{v}_{4},\\mathbf{v}_{3}).\n$$\n使用与全局定向边相关的最低阶 Nedelec（Whitney $1$-形式）基函数。定义以下全局定向边集和自由度（DOF）的排序：\n$$\ne_{1}=(\\mathbf{v}_{0}\\rightarrow\\mathbf{v}_{1}),\\quad\ne_{2}=(\\mathbf{v}_{0}\\rightarrow\\mathbf{v}_{2}),\\quad\ne_{3}=(\\mathbf{v}_{1}\\rightarrow\\mathbf{v}_{2}),\\quad\ne_{4}=(\\mathbf{v}_{1}\\rightarrow\\mathbf{v}_{3}),\\quad\ne_{5}=(\\mathbf{v}_{2}\\rightarrow\\mathbf{v}_{3}),\\quad\ne_{6}=(\\mathbf{v}_{1}\\rightarrow\\mathbf{v}_{4}),\\quad\ne_{7}=(\\mathbf{v}_{3}\\rightarrow\\mathbf{v}_{4}).\n$$\n设磁导率在 $K_{k}$ 上为分段常数 $\\mu(\\mathbf{x})=\\mu_{k}0$（对于 $k\\in\\{1,2,3\\}$），介电常数在 $K_{k}$ 上为分段常数 $\\epsilon(\\mathbf{x})=\\epsilon_{k}0$（对于 $k\\in\\{1,2,3\\}$）。用 $\\omega0$ 表示角频率。在弱形式中，旋度-旋度算子由矩阵表示\n$$\nA = C^{\\top} M_{\\mu^{-1}} C,\n$$\n其中 $C$ 是由所选的全局边方向和逆时针面方向导出的面-边关联（离散旋度）矩阵，而 $M_{\\mu^{-1}}$ 是权重为 $\\mu^{-1}$ 的 $2$-形式（面）的 $L^{2}$ Hodge 星算子。权重为 $\\epsilon$ 的边（Whitney $1$-形式）上的 $L^{2}$ Hodge 星算子是质量矩阵 $M_{\\epsilon}$。\n\n从麦克斯韦方程组和弱 $H(\\mathrm{curl})$ 形式出发，并根据 Whitney $1$-形式的重心坐标定义，对上述网格和自由度排序执行以下所有操作：\n\n1. 使用给定的全局边方向和逆时针面方向，显式构造面-边关联矩阵 $C\\in\\mathbb{R}^{3\\times 7}$。\n2. 利用每个三角形上 $\\mu$ 的常数性以及三角形上 Whitney $1$-形式的分段常数旋度，构造 $M_{\\mu^{-1}}\\in\\mathbb{R}^{3\\times 3}$。\n3. 在每个三角形上使用重心坐标和 Whitney $1$-形式的定义 $w_{ij}=\\lambda_{i}\\nabla\\lambda_{j}-\\lambda_{j}\\nabla\\lambda_{i}$，计算每个单元 $K_{1}$、$K_{2}$ 和 $K_{3}$ 上权重为 $\\epsilon_{k}$ 的局部 $3\\times 3$ 边质量矩阵，并将它们组装成全局边质量矩阵 $M_{\\epsilon}\\in\\mathbb{R}^{7\\times 7}$。\n4. 确定矩阵 $A+\\omega^{2} M_{\\epsilon}$ 的精确稀疏模式（零/非零结构），并在指定的自由度排序 $e_{1},\\dots,e_{7}$ 下，计算其半带宽 $b$，定义为\n$$\nb=\\max\\{\\,|i-j|:\\ (A+\\omega^{2}M_{\\epsilon})_{ij}\\neq 0\\,\\}.\n$$\n\n将单个整数 $b$ 作为最终答案报告。无需四舍五入。最终报告值中不应包含任何单位。",
            "solution": "用户提供了一个在计算电磁学中定义明确的问题。该问题要求计算特定二维网格的有限元系统矩阵的半带宽。我将按照问题陈述中列出的四个任务进行。\n\n网格的顶点由以下给出：\n$$\n\\mathbf{v}_{0}=(0,0),\\quad \\mathbf{v}_{1}=(1,0),\\quad \\mathbf{v}_{2}=(0,1),\\quad \\mathbf{v}_{3}=(1,1),\\quad \\mathbf{v}_{4}=(2,0).\n$$\n单元（三角形）如下：\n$$\nK_{1}=\\triangle(\\mathbf{v}_{0},\\mathbf{v}_{1},\\mathbf{v}_{2}),\\quad K_{2}=\\triangle(\\mathbf{v}_{1},\\mathbf{v}_{3},\\mathbf{v}_{2}),\\quad K_{3}=\\triangle(\\mathbf{v}_{1},\\mathbf{v}_{4},\\mathbf{v}_{3}).\n$$\n全局排序和定向的边（自由度）如下：\n$$\ne_{1}=(\\mathbf{v}_{0}\\rightarrow\\mathbf{v}_{1}),\\quad\ne_{2}=(\\mathbf{v}_{0}\\rightarrow\\mathbf{v}_{2}),\\quad\ne_{3}=(\\mathbf{v}_{1}\\rightarrow\\mathbf{v}_{2}),\\quad\ne_{4}=(\\mathbf{v}_{1}\\rightarrow\\mathbf{v}_{3}),\\quad\ne_{5}=(\\mathbf{v}_{2}\\rightarrow\\mathbf{v}_{3}),\\quad\ne_{6}=(\\mathbf{v}_{1}\\rightarrow\\mathbf{v}_{4}),\\quad\ne_{7}=(\\mathbf{v}_{3}\\rightarrow\\mathbf{v}_{4}).\n$$\n\n最终目标是确定矩阵 $S = A+\\omega^{2} M_{\\epsilon}$ 的半带宽 $b$，定义为 $b=\\max\\{\\,|i-j|:\\ S_{ij}\\neq 0\\,\\}$。假设对于任意正材料参数 $\\mu_k, \\epsilon_k$ 和频率 $\\omega$ 不存在偶然抵消，则 $S$ 的稀疏模式是 $A$ 和 $M_{\\epsilon}$ 稀疏模式的并集。如果对于这些参数的一般选择，一个条目是非零的，那么它被认为是结构上非零的。\n\n**1. 面-边关联矩阵 $C$ 的构造**\n\n面-边关联矩阵 $C \\in \\mathbb{R}^{3\\times 7}$ 编码了面（单元）和边之间的拓扑关系。如果边 $e_i$ 是面 $K_k$ 边界的一部分且方向匹配（面为逆时针方向），则条目 $C_{ki}$ 为 $+1$；如果方向相反，则为 $-1$；如果边不在该面的边界上，则为 $0$。\n\n- **面 $K_1 = \\triangle(\\mathbf{v}_0, \\mathbf{v}_1, \\mathbf{v}_2)$:** 逆时针边界为 $\\mathbf{v}_0 \\to \\mathbf{v}_1 \\to \\mathbf{v}_2 \\to \\mathbf{v}_0$。\n  - 边 $e_1 = (\\mathbf{v}_0 \\to \\mathbf{v}_1)$：方向匹配。$C_{11} = +1$。\n  - 边 $e_3 = (\\mathbf{v}_1 \\to \\mathbf{v}_2)$：方向匹配。$C_{13} = +1$。\n  - 边 $e_2 = (\\mathbf{v}_0 \\to \\mathbf{v}_2)$：与边界段 $(\\mathbf{v}_2 \\to \\mathbf{v}_0)$ 方向相反。$C_{12} = -1$。\n  - $C$ 的第 1 行为 $\\begin{pmatrix} 1  -1  1  0  0  0  0 \\end{pmatrix}$。\n\n- **面 $K_2 = \\triangle(\\mathbf{v}_1, \\mathbf{v}_3, \\mathbf{v}_2)$:** 逆时针边界为 $\\mathbf{v}_1 \\to \\mathbf{v}_3 \\to \\mathbf{v}_2 \\to \\mathbf{v}_1$。\n  - 边 $e_4 = (\\mathbf{v}_1 \\to \\mathbf{v}_3)$：方向匹配。$C_{24} = +1$。\n  - 边 $e_5 = (\\mathbf{v}_2 \\to \\mathbf{v}_3)$：与边界段 $(\\mathbf{v}_3 \\to \\mathbf{v}_2)$ 方向相反。$C_{25} = -1$。\n  - 边 $e_3 = (\\mathbf{v}_1 \\to \\mathbf{v}_2)$：与边界段 $(\\mathbf{v}_2 \\to \\mathbf{v}_1)$ 方向相反。$C_{23} = -1$。\n  - $C$ 的第 2 行为 $\\begin{pmatrix} 0  0  -1  1  -1  0  0 \\end{pmatrix}$。\n\n- **面 $K_3 = \\triangle(\\mathbf{v}_1, \\mathbf{v}_4, \\mathbf{v}_3)$:** 逆时针边界为 $\\mathbf{v}_1 \\to \\mathbf{v}_4 \\to \\mathbf{v}_3 \\to \\mathbf{v}_1$。\n  - 边 $e_6 = (\\mathbf{v}_1 \\to \\mathbf{v}_4)$：方向匹配。$C_{36} = +1$。\n  - 边 $e_7 = (\\mathbf{v}_3 \\to \\mathbf{v}_4)$：与边界段 $(\\mathbf{v}_4 \\to \\mathbf{v}_3)$ 方向相反。$C_{37} = -1$。\n  - 边 $e_4 = (\\mathbf{v}_1 \\to \\mathbf{v}_3)$：与边界段 $(\\mathbf{v}_3 \\to \\mathbf{v}_1)$ 方向相反。$C_{34} = -1$。\n  - $C$ 的第 3 行为 $\\begin{pmatrix} 0  0  0  -1  0  1  -1 \\end{pmatrix}$。\n\n合并这些行，矩阵 $C$ 为：\n$$\nC = \\begin{pmatrix}\n1  -1  1  0  0  0  0 \\\\\n0  0  -1  1  -1  0  0 \\\\\n0  0  0  -1  0  1  -1\n\\end{pmatrix}\n$$\n\n**2. 矩阵 $M_{\\mu^{-1}}$ 的构造**\n\n矩阵 $M_{\\mu^{-1}}$ 是从 2-形式（面）映射到对偶 0-形式的 Hodge 星算子矩阵。对于一个 2-形式的基，这些基是每个单元（面）上的特征函数，并且在单元 $K_k$ 上具有分段常数材料属性 $\\mu_k$，此矩阵是对角的。其条目由 $(M_{\\mu^{-1}})_{kk} = |K_k| / \\mu_k$ 给出，其中 $|K_k|$ 是单元 $K_k$ 的面积。我们来计算三角形的面积。\n- $|K_1| = \\frac{1}{2} | \\det(\\mathbf{v}_1 - \\mathbf{v}_0, \\mathbf{v}_2 - \\mathbf{v}_0) | = \\frac{1}{2} | \\det\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} | = \\frac{1}{2}$。\n- $|K_2| = \\frac{1}{2} | \\det(\\mathbf{v}_3 - \\mathbf{v}_1, \\mathbf{v}_2 - \\mathbf{v}_1) | = \\frac{1}{2} | \\det\\begin{pmatrix} 0  -1 \\\\ 1  1 \\end{pmatrix} | = \\frac{1}{2}$。\n- $|K_3| = \\frac{1}{2} | \\det(\\mathbf{v}_4 - \\mathbf{v}_1, \\mathbf{v}_3 - \\mathbf{v}_1) | = \\frac{1}{2} | \\det\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} | = \\frac{1}{2}$。\n\n所有单元的面积均为 $1/2$。因此，$M_{\\mu^{-1}}$ 是一个 $3 \\times 3$ 的对角矩阵：\n$$\nM_{\\mu^{-1}} = \\begin{pmatrix}\n\\frac{1}{2\\mu_1}  0  0 \\\\\n0  \\frac{1}{2\\mu_2}  0 \\\\\n0  0  \\frac{1}{2\\mu_3}\n\\end{pmatrix}\n$$\n由于 $\\mu_k  0$，所有对角线条目都是非零的。\n\n**3. 和 4. $A+\\omega^{2} M_{\\epsilon}$ 的稀疏模式和半带宽**\n\n我们首先确定 $A = C^{\\top} M_{\\mu^{-1}} C$ 的稀疏模式。条目 $A_{ij}$ 由下式给出：\n$$\nA_{ij} = (C^{\\top} M_{\\mu^{-1}} C)_{ij} = \\sum_{k=1}^3 \\sum_{l=1}^3 (C^{\\top})_{ik} (M_{\\mu^{-1}})_{kl} C_{lj}\n$$\n由于 $M_{\\mu^{-1}}$ 是对角的，这可以简化为：\n$$\nA_{ij} = \\sum_{k=1}^3 C_{ki} (M_{\\mu^{-1}})_{kk} C_{kj}\n$$\n当且仅当存在至少一个单元 $K_k$，使得 $C_{ki} \\neq 0$ 和 $C_{kj} \\neq 0$ 都成立时，条目 $A_{ij}$ 才非零。这意味着边 $e_i$ 和 $e_j$ 必须是某个公共单元 $K_k$ 边界的一部分。这就是“共面”关系。\n\n接下来，我们确定质量矩阵 $M_{\\epsilon}$ 的稀疏模式。其条目由下式给出：\n$$\n(M_\\epsilon)_{ij} = \\int_\\Omega \\epsilon(\\mathbf{x}) \\mathbf{w}_i \\cdot \\mathbf{w}_j \\, d\\Omega = \\sum_{k=1}^3 \\int_{K_k} \\epsilon_k \\mathbf{w}_i \\cdot \\mathbf{w}_j \\, d\\Omega\n$$\n其中 $\\mathbf{w}_i$ 是与边 $e_i$ 相关联的 Whitney 1-形式基函数。$\\mathbf{w}_i$ 的支集是与 $e_i$ 相邻的单元的并集。积分 $\\int_{K_k} \\mathbf{w}_i \\cdot \\mathbf{w}_j \\, d\\Omega$ 仅当 $\\mathbf{w}_i$ 和 $\\mathbf{w}_j$ 在单元 $K_k$ 上都非零时才非零。这当且仅当边 $e_i$ 和 $e_j$ 都是单元 $K_k$ 的边时才成立。因此，对于一个通用网格和正的材料属性，$(M_\\epsilon)_{ij}$ 非零当且仅当边 $e_i$ 和 $e_j$ 是共面的。\n\n$A$ 和 $M_\\epsilon$ 具有相同的稀疏模式，该模式由共面边-边关系定义。系统矩阵 $S = A+\\omega^{2} M_{\\epsilon}$ 也将具有相同的稀疏模式，因为对于任意正的 $\\mu_k, \\epsilon_k, \\omega$，不会因抵消而产生结构零。\n\n当且仅当边 $e_i$ 和 $e_j$ 属于同一个三角形时，条目 $S_{ij}$ 非零。我们为每个三角形确定边索引集：\n- $K_1$：边为 $e_1, e_2, e_3$。索引集为 $\\{1, 2, 3\\}$。\n- $K_2$：边为 $e_3, e_4, e_5$。索引集为 $\\{3, 4, 5\\}$。\n- $K_3$：边为 $e_4, e_6, e_7$。索引集为 $\\{4, 6, 7\\}$。\n\n矩阵 $S$ 中的非零条目 $(i,j)$ 是那些 $i$ 和 $j$ 同属于这些集合之一的条目。我们现在通过检查每个集合内的最大索引差来找到半带宽 $b=\\max\\{\\,|i-j|:\\ S_{ij}\\neq 0\\,\\}$。\n- 对于 $\\{1, 2, 3\\}$：最大差值为 $|3-1| = 2$。\n- 对于 $\\{3, 4, 5\\}$：最大差值为 $|5-3| = 2$。\n- 对于 $\\{4, 6, 7\\}$：最大差值为 $|7-4| = 3$。\n\n总体最大差值是这些值的最大值。\n$$\nb = \\max(2, 2, 3) = 3.\n$$\n这个最大差值出现在索引对 $(4, 7)$ 上。边 $e_4$ 和 $e_7$ 都是三角形 $K_3$ 的一部分，因此条目 $S_{47}$（和 $S_{74}$）是非零的。差值 $|4-7|=3$ 对半带宽有贡献。没有其他共面边对具有更大的索引差。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "一旦组装好有限元系统 $A x = b$，下一个挑战就是高效地求解它。共轭梯度法 (CG) 是求解电磁学中常见的对称正定 (SPD) 系统的基石迭代求解器。本练习深入探讨了 CG 算法的机理及其收敛特性，通过推导其递推关系并分析预条件处理的作用，您将理解如何通过聚集系统矩阵的特征值来显著提高求解器的性能 。",
            "id": "3321767",
            "problem": "考虑一个单连通、理想导电腔体中电场的频域麦克斯韦旋度-旋度方程，其中材料参数——磁导率和介电常数——为正值且随空间变化。设其弱形式通过有限元方法 (FEM)，在协调的四面体网格上使用一阶 Nédélec 边元进行离散化，得到稀疏线性系统\n$$\nA x = b,\n$$\n其中对称正定 (SPD) 系统矩阵是质量增广的旋度-旋度算子\n$$\nA = C^{\\top} \\Lambda C + \\eta M.\n$$\n此处，$C$ 是离散旋度算子，$\\Lambda$ 是逆磁导率权重的对角矩阵，$M$ 是与介电常数相关的 $L^{2}$ 质量矩阵，而 $\\eta  0$ 是一个严格为正的增广参数。假设在切向意义上采用齐次 Dirichlet 边界条件以确保矫顽性。设 $A$ 通过共轭梯度 (CG) 法求解。\n\n从 CG 的 Galerkin 最优性原理出发——即第 $k$ 次迭代在由 Krylov 子空间张成的仿射空间上最小化误差的 $A$-范数——推导应用于 $A$ 的 CG 短程递推关系，包括：\n- 搜索方向的三项更新。\n- 以可通过稀疏矩阵向量运算实现的内积形式表示的步长和递推系数。\n\n然后，考虑使用 SPD 预条件子 $P$ 进行左预处理：求解\n$$\nP^{-1} A x = P^{-1} b\n$$\n使用预处理共轭梯度 (PCG) 法。使用 CG 的多项式逼近观点和 Chebyshev 多项式的极值性质，证明预处理算子 $P^{-1} A$ 的谱如何决定 $k$ 次迭代后误差的 $A$-范数的渐近界，并给出以 $P^{-1} A$ 的条件数表示的该界的闭合形式。\n\n最后，对于一个预条件子 $P$，其构造使得 $P^{-1} A$ 的谱完全位于区间 $[\\theta_{\\min}, \\theta_{\\max}] = [0.5, 2]$ 内，计算经过 $k = 20$ 次 PCG 迭代后，误差的 $A$-范数减小的理论上界因子。将答案四舍五入至四位有效数字。将最终值表示为无量纲数。",
            "solution": "该问题分三部分解答：共轭梯度 (CG) 算法的推导，预处理共轭梯度 (PCG) 收敛性分析，以及最后的数值计算。\n\n### 第 1 部分：共轭梯度 (CG) 算法的推导\n\n共轭梯度法生成方程 $Ax=b$ 解的一系列近似值 $x_k$。它基于嵌套的 Krylov 子空间上的 Galerkin 最优性原理。对于初始猜测 $x_0$ 和初始残差 $r_0 = b - Ax_0$，第 $k$ 次迭代值 $x_k$ 从仿射空间 $x_0 + \\mathcal{K}_k(A, r_0)$ 中选取，使得误差 $e_k = x - x_k$ 在 $A$-范数（定义为 $\\|e_k\\|_A = \\sqrt{e_k^\\top A e_k}$）下最小化。Krylov 子空间为 $\\mathcal{K}_k(A, r_0) = \\text{span}\\{r_0, Ar_0, \\dots, A^{k-1}r_0\\}$。\n\n这种最小化等价于 Galerkin 条件，即残差 $r_k = b - Ax_k = -Ae_k$ 与子空间 $\\mathcal{K}_k(A, r_0)$ 正交：\n$$\nr_k^\\top v = 0 \\quad \\forall v \\in \\mathcal{K}_k(A, r_0)\n$$\n\nCG 算法构造一系列搜索方向 $\\{p_0, p_1, \\dots, p_{k-1}\\}$，它们构成 $\\mathcal{K}_k(A, r_0)$ 的一个 $A$-正交基，即当 $i \\neq j$ 时，$p_i^\\top A p_j = 0$。迭代更新如下：\n$$\nx_{k+1} = x_k + \\alpha_k p_k\n$$\n其中 $\\alpha_k$ 是步长。相应的残差更新为：\n$$\nr_{k+1} = b - A x_{k+1} = b - A(x_k + \\alpha_k p_k) = (b - A x_k) - \\alpha_k A p_k = r_k - \\alpha_k A p_k\n$$\n\n为推导这些系数的表达式，我们利用算法的性质。\n新的搜索方向 $p_k$ 被构造成与先前的方向 $A$-正交，同时位于子空间 $\\mathcal{K}_{k+1}(A, r_0)$ 中。搜索方向的标准“短程递推”是一种双项更新形式：\n$$\np_k = r_k + \\beta_{k-1} p_{k-1} \\quad (p_0 = r_0)\n$$\n\n**1. 步长 $\\alpha_k$ 的推导**\n步长 $\\alpha_k$ 的选择是为了最小化 $\\|e_{k+1}\\|_A$。当 $e_{k+1}$ 与搜索方向 $p_k$ 是 $A$-正交时，即可实现这一点。\n$$\ne_{k+1} = x - x_{k+1} = x - (x_k + \\alpha_k p_k) = e_k - \\alpha_k p_k\n$$\n$A$-正交性条件为 $\\langle e_{k+1}, p_k \\rangle_A = 0$：\n$$\n0 = e_{k+1}^\\top A p_k = (e_k - \\alpha_k p_k)^\\top A p_k = e_k^\\top A p_k - \\alpha_k p_k^\\top A p_k\n$$\n求解 $\\alpha_k$：\n$$\n\\alpha_k = \\frac{e_k^\\top A p_k}{p_k^\\top A p_k} = \\frac{(A e_k)^\\top p_k}{p_k^\\top A p_k} = \\frac{(-r_k)^\\top p_k}{p_k^\\top A p_k}\n$$\n根据构造 $p_k = r_k + \\beta_{k-1}p_{k-1}$，我们有 $p_k^\\top r_k = (r_k + \\beta_{k-1}p_{k-1})^\\top r_k = r_k^\\top r_k + \\beta_{k-1}p_{k-1}^\\top r_k$。\n第 $k$ 次迭代的 Galerkin 条件表明 $r_k \\perp \\mathcal{K}_k(A, r_0)$。由于 $p_{k-1} \\in \\mathcal{K}_k(A, r_0)$，我们有 $p_{k-1}^\\top r_k = 0$。\n因此，$p_k^\\top r_k = r_k^\\top r_k$。将此代入分子：\n$$\n\\alpha_k = \\frac{r_k^\\top r_k}{p_k^\\top A p_k}\n$$\n这个表达式是可实现的，因为它只涉及内积和一次稀疏矩阵向量乘积 ($Ap_k$)。\n\n**2. 递推系数 $\\beta_k$ 的推导**\n搜索方向更新 $p_{k+1} = r_{k+1} + \\beta_k p_k$ 中的系数 $\\beta_k$ 是为了强制 $p_{k+1}$ 和 $p_k$ 的 $A$-正交性而选择的：\n$$\n0 = p_{k+1}^\\top A p_k = (r_{k+1} + \\beta_k p_k)^\\top A p_k = r_{k+1}^\\top A p_k + \\beta_k p_k^\\top A p_k\n$$\n求解 $\\beta_k$：\n$$\n\\beta_k = -\\frac{r_{k+1}^\\top A p_k}{p_k^\\top A p_k}\n$$\n根据残差更新公式，$A p_k = \\frac{1}{\\alpha_k}(r_k - r_{k+1})$。将其代入分子：\n$$\nr_{k+1}^\\top A p_k = r_{k+1}^\\top \\frac{1}{\\alpha_k}(r_k - r_{k+1}) = \\frac{1}{\\alpha_k} (r_{k+1}^\\top r_k - r_{k+1}^\\top r_{k+1})\n$$\nCG 的一个基本性质是残差的正交性：当 $i \\neq j$ 时，$r_i^\\top r_j = 0$。这可以从 Galerkin 条件推导得出：对于 $j   k$，$r_j \\in \\mathcal{K}_{j+1}(A, r_0) \\subset \\mathcal{K}_k(A, r_0)$，所以 $r_k^\\top r_j = 0$。\n因此，$r_{k+1}^\\top r_k = 0$，分子简化为 $-\\frac{1}{\\alpha_k} r_{k+1}^\\top r_{k+1}$。\n将此代回 $\\beta_k$ 的表达式：\n$$\n\\beta_k = - \\frac{-\\frac{1}{\\alpha_k} r_{k+1}^\\top r_{k+1}}{p_k^\\top A p_k} = \\frac{r_{k+1}^\\top r_{k+1}}{\\alpha_k (p_k^\\top A p_k)}\n$$\n使用 $\\alpha_k$ 的表达式，我们有 $\\alpha_k(p_k^\\top A p_k) = r_k^\\top r_k$。因此：\n$$\n\\beta_k = \\frac{r_{k+1}^\\top r_{k+1}}{r_k^\\top r_k}\n$$\n\n问题陈述要求“搜索方向的三项更新”。标准 CG 算法采用双项递推 $p_{k+1} = r_{k+1} + \\beta_k p_k$。这个名称可以解释为涉及三个不同向量项（$p_{k+1}$、$r_{k+1}$、$p_k$）的更新。然而，在数值分析中，“三项递推”通常指形如 $v_{k+1} = c_k^{(1)} v_k + c_k^{(2)} v_{k-1}$ 的关系。残差 $\\{r_k\\}$ 确实满足这样的递推关系，这源于底层的 Lanczos 过程的三项递推。搜索方向 $\\{p_k\\}$ 也可以被证明满足一个更复杂的三项递推关系，但双项更新才是标准算法高效性的关键。\n\n### 第 2 部分：PCG 收敛性分析\n\n对于预处理系统 $P^{-1}Ax = P^{-1}b$，其中 $P$ 是一个 SPD 预条件子，应用 PCG 方法。这等价于将标准 CG 方法应用于一个算子为 SPD 的变换后的系统。设 $P = L_P L_P^\\top$ 是 $P$ 的 Cholesky 分解。该系统等价于：\n$$\n(L_P^{-1} A L_P^{-\\top}) (L_P^\\top x) = L_P^{-1} b\n$$\n设 $\\hat{A} = L_P^{-1} A L_P^{-\\top}$，$\\hat{x} = L_P^\\top x$，以及 $\\hat{b} = L_P^{-1} b$。我们使用 CG 求解 $\\hat{A}\\hat{x} = \\hat{b}$。矩阵 $\\hat{A}$ 是 SPD。$\\hat{A}$ 的特征值与预处理矩阵 $P^{-1}A$ 的特征值相同。\n\n对加帽系统的 CG 收敛性是以其误差 $\\hat{e}_k = \\hat{x} - \\hat{x}_k$ 的 $\\hat{A}$-范数来衡量的。这个范数与原始误差 $e_k = x - x_k$ 的 $A$-范数直接相关：\n$$\n\\|\\hat{e}_k\\|_{\\hat{A}}^2 = \\hat{e}_k^\\top \\hat{A} \\hat{e}_k = (L_P^\\top e_k)^\\top (L_P^{-1} A L_P^{-\\top}) (L_P^\\top e_k) = e_k^\\top L_P L_P^{-1} A L_P^{-\\top} L_P^\\top e_k = e_k^\\top A e_k = \\|e_k\\|_A^2\n$$\n因此，最小化 $\\|\\hat{e}_k\\|_{\\hat{A}}$ 等价于最小化 $\\|e_k\\|_A$。\n\n从多项式逼近的角度来看， $k$ 次迭代后的 CG 误差由 $\\hat{e}_k = \\mathcal{P}_k(\\hat{A})\\hat{e}_0$ 给出，其中 $\\mathcal{P}_k$ 是一个次数至多为 $k$ 且满足 $\\mathcal{P}_k(0)=1$ 的多项式。CG 找到最小化误差的 $\\hat{A}$-范数的特定多项式。这给出了界：\n$$\n\\frac{\\|\\hat{e}_k\\|_{\\hat{A}}}{\\|\\hat{e}_0\\|_{\\hat{A}}} = \\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\le \\min_{\\mathcal{P}_k \\in \\Pi_k^1} \\max_{\\lambda \\in \\sigma(\\hat{A})} |\\mathcal{P}_k(\\lambda)|\n$$\n其中 $\\Pi_k^1$ 是次数至多为 $k$ 且满足 $\\mathcal{P}_k(0)=1$ 的多项式集合。\n\n设 $\\hat{A}$（也就是 $P^{-1}A$）的谱包含在区间 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 内。该界变为：\n$$\n\\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\le \\min_{\\mathcal{P}_k \\in \\Pi_k^1} \\max_{z \\in [\\lambda_{\\min}, \\lambda_{\\max}]} |\\mathcal{P}_k(z)|\n$$\n这个极小化极大问题由一个缩放和平移的第一类 Chebyshev 多项式 $T_k(y)$ 解出。最优多项式由下式给出：\n$$\n\\mathcal{P}_k(z) = \\frac{T_k\\left(\\frac{\\lambda_{\\max}+\\lambda_{\\min}-2z}{\\lambda_{\\max}-\\lambda_{\\min}}\\right)}{T_k\\left(\\frac{\\lambda_{\\max}+\\lambda_{\\min}}{\\lambda_{\\max}-\\lambda_{\\min}}\\right)}\n$$\n该多项式满足 $\\mathcal{P}_k(0)=1$。当 $y \\in [-1, 1]$ 时，$|T_k(y)|$ 的最大值为 $1$。该变换将 $z \\in [\\lambda_{\\min}, \\lambda_{\\max}]$ 映射到 $y \\in [-1, 1]$。因此，$|\\mathcal{P}_k(z)|$ 在谱区间上的最大值由分母给出。设 $\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$ 为预处理算子 $P^{-1}A$ 的条件数。\n$$\n\\frac{\\lambda_{\\max}+\\lambda_{\\min}}{\\lambda_{\\max}-\\lambda_{\\min}} = \\frac{\\kappa+1}{\\kappa-1}\n$$\n那么收敛界为：\n$$\n\\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\le \\frac{1}{T_k\\left(\\frac{\\kappa+1}{\\kappa-1}\\right)}\n$$\n对于自变量 $|y|1$，Chebyshev 多项式由 $T_k(y) = \\cosh(k \\cdot \\text{arccosh}(y))$ 给出。这导出了著名的渐近界，通常表示为 $2\\left(\\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}\\right)^k$。\n\n### 第 3 部分：数值计算\n\n已知：预处理算子 $P^{-1}A$ 的谱完全位于 $[\\theta_{\\min}, \\theta_{\\max}] = [0.5, 2]$ 内。PCG 迭代次数为 $k=20$。\n\n任务是计算误差的 $A$-范数减小的理论上界因子，即上面推导出的界的值。\n\n1.  **条件数**：\n    预处理矩阵的条件数为 $\\kappa = \\frac{\\theta_{\\max}}{\\theta_{\\min}} = \\frac{2}{0.5} = 4$。\n\n2.  **Chebyshev 多项式的自变量**：\n    自变量为 $\\frac{\\kappa+1}{\\kappa-1} = \\frac{4+1}{4-1} = \\frac{5}{3}$。\n\n3.  **评估界**：\n    上界因子为 $\\frac{1}{T_{20}(5/3)}$。我们使用公式 $T_k(y) = \\cosh(k \\cdot \\text{arccosh}(y))$。\n    首先，计算 $\\text{arccosh}(5/3)$：\n    设 $u = \\text{arccosh}(5/3)$。这意味着 $\\cosh(u) = 5/3$。\n    使用恒等式 $\\text{arccosh}(y) = \\ln(y + \\sqrt{y^2-1})$（对于 $y \\ge 1$）：\n    $$\n    u = \\ln\\left(\\frac{5}{3} + \\sqrt{\\left(\\frac{5}{3}\\right)^2 - 1}\\right) = \\ln\\left(\\frac{5}{3} + \\sqrt{\\frac{25}{9} - \\frac{9}{9}}\\right) = \\ln\\left(\\frac{5}{3} + \\sqrt{\\frac{16}{9}}\\right) = \\ln\\left(\\frac{5}{3} + \\frac{4}{3}\\right) = \\ln(3)\n    $$\n    现在，计算 $T_{20}(5/3)$：\n    $$\n    T_{20}(5/3) = \\cosh(20 \\cdot \\text{arccosh}(5/3)) = \\cosh(20 \\ln 3)\n    $$\n    使用定义 $\\cosh(z) = \\frac{\\exp(z) + \\exp(-z)}{2}$：\n    $$\n    \\cosh(20 \\ln 3) = \\frac{\\exp(20 \\ln 3) + \\exp(-20 \\ln 3)}{2} = \\frac{\\exp(\\ln 3^{20}) + \\exp(\\ln 3^{-20})}{2} = \\frac{3^{20} + 3^{-20}}{2}\n    $$\n    上界因子是此值的倒数：\n    $$\n    \\text{Bound Factor} = \\frac{1}{\\frac{3^{20} + 3^{-20}}{2}} = \\frac{2}{3^{20} + 3^{-20}}\n    $$\n\n4.  **数值**：\n    我们计算该表达式的值：\n    $$\n    3^{20} = (3^{10})^2 = (59049)^2 = 3,486,784,401\n    $$\n    $3^{-20}$ 极小，对于此精度水平，其对和的贡献可以忽略不计。\n    $$\n    \\text{Bound Factor} = \\frac{2}{3486784401 + \\frac{1}{3486784401}} \\approx \\frac{2}{3486784401} \\approx 5.73596... \\times 10^{-10}\n    $$\n    四舍五入到四位有效数字，我们得到 $5.736 \\times 10^{-10}$。",
            "answer": "$$\n\\boxed{5.736 \\times 10^{-10}}\n$$"
        },
        {
            "introduction": "计算电磁学中的一个关键问题是，纯旋度-旋度算子通常是奇异的（半正定），拥有一个由梯度场构成的非平凡零空间。这使得像 CG 这样的求解器无法直接使用。本练习旨在挑战您分析不同的边界条件（PEC、PMC、周期性）和域拓扑如何影响这个零空间的结构 。正确识别并约束这个零空间对于构建一个适定且可解的问题至关重要。",
            "id": "3321772",
            "problem": "在有限元法 (FEM) 中，一个单连通 Lipschitz 多面体域 $\\Omega \\subset \\mathbb{R}^3$ 被协调的四面体网格上的第一类最低阶 Nédélec 边元离散化。考虑与旋度-旋度算子相关的对称双线性形式\n$$\na(\\mathbf{E},\\mathbf{v}) \\;=\\; \\int_{\\Omega} \\mu^{-1} \\, (\\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{v}) \\, \\mathrm{d}\\Omega,\n$$\n其中 $\\mu0$ 是分片常数。由此产生的刚度矩阵是对称半正定的。对于计算电磁学中常用的三种边界条件设置，你需要分析离散零空间的结构，并设计约束条件，以便能在纯旋度-旋度算子（即没有附加质量项）产生的线性系统上使用共轭梯度法 (CG)。这些设置是：\n- 理想电导体 (PEC)：在 $\\partial \\Omega$ 上的本质边界条件 $\\mathbf{E}\\times \\mathbf{n} = \\mathbf{0}$。\n- 理想磁导体 (PMC)：在 $\\partial \\Omega$ 上的自然边界条件 $\\mathbf{n}\\times (\\mu^{-1}\\nabla\\times \\mathbf{E})=\\mathbf{0}$。\n- 在立方体网格的相对面上施加周期性（零相位）边界条件，使得计算拓扑为一个 $3$-维环面。\n\n假设连接节点、边和面空间的标准离散 de Rham 序列是恰当的，并且符合所施加的边界条件。令 $G$ 表示从节点（拉格朗日）空间到边（Nédélec）空间的离散梯度算子，其中三种设置分别对应着合适的带边界条件的变体 $G_{\\mathrm{PEC}}$、$G_{\\mathrm{PMC}}$ 和 $G_{\\mathrm{per}}$。令 $M_e$ 表示与 $L^2$ 内积相关的边空间质量矩阵。当需要时，假设右端项是相容的（即与零空间正交）。\n\n哪个选项正确地指出了每种设置下的离散零空间，并指定了一种有效的最小约束策略，该策略能在不改变底层微分算子的前提下，使得离散旋度-旋度算子在受约束的子空间上是对称正定的，从而能够使用 CG 方法？\n\nA. PEC：零空间等于 $\\mathrm{range}(G_{\\mathrm{PEC}})$。施加代数规范 $G_{\\mathrm{PEC}}^\\top M_e \\mathbf{x} = \\mathbf{0}$ 来消除它。PMC：零空间等于 $\\mathrm{range}(G_{\\mathrm{PMC}})$。施加 $G_{\\mathrm{PMC}}^\\top M_e \\mathbf{x} = \\mathbf{0}$。周期性（零相位）：零空间等于 $\\mathrm{range}(G_{\\mathrm{per}})$ 加上一个对应于非平凡一阶上同调（全局环量）的 $3$-维调和子空间。施加 $G_{\\mathrm{per}}^\\top M_e \\mathbf{x} = \\mathbf{0}$ 并添加 $3$ 个独立的全局环量约束（例如，沿 $3$ 个周期性方向的平均线积分为零）来移除调和模。\n\nB. PEC：由于本质边界条件，零空间是平凡的。PMC：零空间由梯度场以及一个 $3$-维常向量空间组成。周期性（零相位）：零空间中只存在梯度场。在所有情况下，将单个任意边自由度钉扎为零；这足以启用 CG。\n\nC. PEC：零空间等于离散梯度空间。PMC：零空间等于离散梯度空间。周期性（零相位）：零空间等于离散梯度空间（没有额外分量）。在每种设置中施加 $G^\\top \\mathbf{x}=\\mathbf{0}$（与梯度的欧几里得正交性）；不需要其他约束。\n\nD. PEC：零空间等于切向迹为零的无散场。PMC：零空间被自然边界条件消除。周期性（零相位）：零空间等于梯度场加上一个单一的常向量模。通过离散散度约束施加 $\\mathrm{div}\\,\\mathbf{E}=0$，以在各种设置中移除所有零模并启用 CG。",
            "solution": "问题的核心是刻画由双线性形式 $a(\\mathbf{E},\\mathbf{v}) = \\int_{\\Omega} \\mu^{-1} (\\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{v}) \\, \\mathrm{d}\\Omega$ 推导出的离散旋度-旋度算子的零空间。一个由系数向量 $\\mathbf{x}$ 表示的离散向量场，如果 $A\\mathbf{x} = \\mathbf{0}$，则它位于相应刚度矩阵 $A$ 的零空间中。这等价于对于所有离散测试函数 $\\mathbf{v}_h$，$a(\\mathbf{E}_h, \\mathbf{v}_h) = 0$，其中 $\\mathbf{E}_h$ 是对应于 $\\mathbf{x}$ 的场。令 $\\mathbf{v}_h = \\mathbf{E}_h$，我们有 $a(\\mathbf{E}_h, \\mathbf{E}_h) = \\int_{\\Omega} \\mu^{-1} |\\nabla \\times \\mathbf{E}_h|^2 \\, \\mathrm{d}\\Omega = 0$。由于 $\\mu > 0$，这意味着在整个 $\\Omega$ 上 $\\nabla \\times \\mathbf{E}_h = \\mathbf{0}$。\n\n因此，零空间由所有属于有限元空间（即最低阶 Nédélec 边元空间）且满足指定边界条件的离散无旋向量场组成。该问题依赖于有限元外微分 (FEEC) 的理论，特别是离散 de Rham 序列。问题陈述该序列是恰当的，这意味着在区域拓扑是平凡的情况下，离散旋度算子的核 $\\mathrm{ker}(C)$ 等于离散梯度算子的值域 $\\mathrm{range}(G)$，即 $\\ker(C) = \\mathrm{range}(G)$。当拓扑非平凡时，这种恰当性被破坏，且上同调群 $H_h^1 = \\ker(C) / \\mathrm{range}(G)$ 是非平凡的。\n\n让我们分析每一种边界条件设置。\n\n**1. 理想电导体 (PEC)：$\\mathbf{E}\\times \\mathbf{n} = \\mathbf{0}$ on $\\partial \\Omega$**\n这是施加在有限元空间上的本质边界条件。Nédélec 空间被限制为在边界 $\\partial\\Omega$ 上具有零切向迹的函数。设此空间为 $V_{h,0}^1$。此空间中的无旋场 $\\mathbf{E}_h$ 可以写为标量势的梯度，即 $\\mathbf{E}_h = \\nabla \\phi_h$。边界条件 $(\\nabla \\phi_h) \\times \\mathbf{n} = \\mathbf{0}$ 意味着梯度的切向分量为零，这意味着 $\\phi_h$ 在边界 $\\partial\\Omega$ 上必须为常数。由于域 $\\Omega$ 是单连通的，其边界是连通的。不失一般性，我们可以将此常数设为零。在离散设置中，这意味着边界上的节点势自由度被设置为零。离散梯度算子，记作 $G_{\\mathrm{PEC}}$，从这个节点函数空间（在边界上为零）映射到 Nédélec 空间 $V_{h,0}^1$。因此，离散旋度-旋度算子的零空间恰好是该梯度算子的值域，即 $\\mathrm{range}(G_{\\mathrm{PEC}})$。只要网格中存在内部节点，这个空间就是非平凡的。\n\n**2. 理想磁导体 (PMC)：$\\mathbf{n}\\times (\\mu^{-1}\\nabla\\times \\mathbf{E})=\\mathbf{0}$ on $\\partial \\Omega$**\n这是一个自然边界条件。它被弱形式自动满足，并且不对 $\\mathbf{E}_h$ 的试探/测试函数空间施加任何约束。我们使用网格上的完整 Nédélec 空间 $V_h^1$。零空间同样由离散无旋场组成。由于域 $\\Omega$ 是单连通的，任何连续无旋场都是某个标量势的梯度。恰当离散 de Rham 序列的假设确保了这一点在离散情况下也成立：零空间是 $\\mathrm{range}(G_{\\mathrm{PMC}})$。算子 $G_{\\mathrm{PMC}}$ 从完整的节点空间 $V_h^0$（包括边界节点）映射到 $V_h^1$。$G_{\\mathrm{PMC}}$ 的核由常数标量势组成，因此 $\\dim(\\ker(G_{\\mathrm{PMC}}))=1$。零空间的维数是 $\\dim(\\mathrm{range}(G_{\\mathrm{PMC}})) = \\dim(V_h^0) - 1$。\n\n**3. 立方体上的周期性（零相位）**\n这种设置将计算域的拓扑从单连通集变为一个 $3$-维环面 $T^3$。一个 $3$-维环面不是单连通的；其第一贝蒂数是 $b_1(T^3)=3$。根据 de Rham 理论，这意味着存在 $3$ 个线性无关的调和 $1$-形式：它们是无旋、无散的向量场，但不是任何单值势的梯度。这些对应于围绕环面三个基本环路的全局环量。\n在离散设置中，de Rham 序列在边空间上不再是恰当的。离散旋度算子的核 $\\ker(C)$ 比离散梯度空间 $\\mathrm{range}(G_{\\mathrm{per}})$ 更大。商空间 $\\ker(C) / \\mathrm{range}(G_{\\mathrm{per}})$ 是一阶离散上同调群 $H_h^1$，它是一个近似于调和场空间的 $3$-维空间。因此，离散旋度-旋度算子的零空间是 $\\ker(C) = \\mathrm{range}(G_{\\mathrm{per}}) \\oplus \\mathcal{H}_h^1$，其中 $\\mathcal{H}_h^1$ 是 $3$-维离散调和空间。\n\n**约束策略**\n共轭梯度 (CG) 法需要一个对称正定 (SPD) 矩阵。原始刚度矩阵 $A$ 是对称半正定的。为了得到一个 SPD 系统，我们必须将问题限制在一个与零空间交集为平凡的子空间上。一种标准方法是寻找一个与零空间正交的解 $\\mathbf{x}$。\n\n-   对于零空间的梯度场分量（在所有情况下都是 $\\mathrm{range}(G)$），我们可以在 $L^2$ 内积下强制正交性。两个系数向量为 $\\mathbf{x}$ 和 $\\mathbf{y}$ 的边元场的 $L^2$ 内积是 $\\mathbf{x}^\\top M_e \\mathbf{y}$，其中 $M_e$ 是边质量矩阵。梯度空间由 $G$ 的矩阵表示的列向量张成。因此，如果一个解 $\\mathbf{x}$ 与所有这些基向量都 $L^2$-正交，那么它就与所有梯度场 $L^2$-正交。这导出了约束条件 $G^\\top M_e \\mathbf{x} = \\mathbf{0}$。这通常被称为代数规范条件。\n\n-   对于周期性情况下的调和分量，我们必须再添加 $3$ 个约束。我们需要将 $3$-维调和空间 $\\mathcal{H}_h^1$ 投影出去。这可以通过强制场 $\\mathbf{E}_h$ 沿着环面的 $3$ 个独立的大尺度环路的线积分为零来实现。每个这样的约束消除一个调和模。\n\n现在我们来评估给出的选项。\n\n**选项 A:**\n-   **PEC:** 正确地指出了零空间为 $\\mathrm{range}(G_{\\mathrm{PEC}})$ 并提出了有效的约束 $G_{\\mathrm{PEC}}^\\top M_e \\mathbf{x} = \\mathbf{0}$。\n-   **PMC:** 正确地指出了零空间为 $\\mathrm{range}(G_{\\mathrm{PMC}})$ 并提出了有效的约束 $G_{\\mathrm{PMC}}^\\top M_e \\mathbf{x} = \\mathbf{0}$。\n-   **周期性:** 正确地指出了零空间为 $\\mathrm{range}(G_{\\mathrm{per}})$ 加上一个 $3$-维调和空间。它正确地提出了一个两部分的约束策略：$G_{\\mathrm{per}}^\\top M_e \\mathbf{x} = \\mathbf{0}$ 用于梯度部分，以及 $3$ 个额外的约束用于调和模。\n这个选项与上述分析一致。\n**结论：正确**\n\n**选项 B:**\n-   声称 PEC 零空间是平凡的，这是错误的。\n-   声称 PMC 零空间包含常向量，这对于单连通域是错误的。\n-   声称周期性零空间只包含梯度场，这是错误的。\n-   提出钉扎单个自由度，这对于多维零空间来说是一种不充分且不鲁棒的约束策略。\n**结论：不正确**\n\n**选项 C:**\n-   错误地指出周期性零空间除了梯度场外没有其他分量。它遗漏了 3D 调和空间。\n-   提出约束 $G^\\top \\mathbf{x}=\\mathbf{0}$，它强制的是欧几里得内积下的正交性，而不是物理上相关的 $L^2$ 内积（应为 $G^\\top M_e \\mathbf{x} = \\mathbf{0}$）。虽然相关，但这并非标准或最严谨的表述。更重要的是，它没有为周期性情况下的调和模指定任何约束。\n**结论：不正确**\n\n**选项 D:**\n-   从根本上误解了零空间，声称它由无散场组成。旋度-旋度算子的零空间是无旋场（梯度场和调和场）。\n-   错误地声称 PMC 边界条件消除了零空间。\n-   错误地将周期性情况下调和空间的维数认定为一。\n-   所提出的约束，强制 $\\mathrm{div}\\,\\mathbf{E}=0$，虽然能正确地消除梯度模糊性，但无法移除调和模，因为调和模也是无散的。\n**结论：不正确**\n\n基于详细分析，选项 A 是唯一一个为所有三种情况提供了完全准确的零空间结构描述，并提出了一种有效、完整且标准的约束策略，以使系统适用于 CG 求解器的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}