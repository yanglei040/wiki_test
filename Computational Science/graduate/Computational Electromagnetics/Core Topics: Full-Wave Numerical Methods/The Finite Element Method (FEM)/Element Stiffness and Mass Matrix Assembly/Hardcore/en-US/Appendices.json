{
    "hands_on_practices": [
        {
            "introduction": "We begin with the fundamental building block of any finite element simulation: the element itself. The accuracy of the global solution is critically dependent on how accurately we compute the local element matrices. This exercise  provides a concrete calculation for a standard 2D bilinear element, allowing you to see directly how the choice of numerical quadrature—a necessary tool in practice—affects the resulting stiffness and mass matrices. By comparing an exact integration with an under-integrated result, you will quantify the introduced error and gain an appreciation for the importance of choosing an appropriate quadrature rule.",
            "id": "3305143",
            "problem": "Consider the two-dimensional time-harmonic Transverse Electric (TE) scalar Helmholtz formulation discretized by the Finite Element Method (FEM) on a single isoparametric bilinear quadrilateral ($p=1$, $Q_1$) element that is an axis-aligned rectangle in physical space with side lengths $a$ and $b$ (in meters). The medium is homogeneous and isotropic with constant permittivity $\\varepsilon$ and permeability $\\mu$, and the angular frequency is $\\omega$. Let the reference element be the square $[-1,1] \\times [-1,1]$ with standard bilinear shape functions $N_{i}(\\xi,\\eta)$, $i=1,\\dots,4$, and affine mapping to the physical element with Jacobian determinant $\\det J = ab/4$.\n\nThe local element stiffness and mass matrices in this TE scalar setting are defined by\n$$\n(K_{e})_{ij} \\;=\\; \\int_{\\Omega_{e}} \\frac{1}{\\mu} \\nabla N_{i} \\cdot \\nabla N_{j} \\, \\mathrm{d}\\Omega, \n\\qquad\n(M_{e})_{ij} \\;=\\; \\int_{\\Omega_{e}} \\omega^{2} \\varepsilon \\, N_{i} N_{j} \\, \\mathrm{d}\\Omega.\n$$\n\nTasks:\n1. Starting from the weak form definitions above and the isoparametric mapping, express $K_{e}$ and $M_{e}$ as reference integrals over $[-1,1]^{2}$ and carry out their exact evaluation using the $2 \\times 2$ Gauss–Legendre rule (nodes $\\pm 1/\\sqrt{3}$ in each direction, unit weights). Give the exact element matrices in terms of $a$, $b$, $\\mu$, $\\varepsilon$, and $\\omega$.\n\n2. Using the $1 \\times 1$ Gauss rule (single node at $(0,0)$ with weight $4$ on $[-1,1]^{2}$), compute the corresponding quadrature approximations $K_{e}^{(1\\times 1)}$ and $M_{e}^{(1\\times 1)}$.\n\n3. Quantify the quadrature error incurred by the $1 \\times 1$ rule, for both $K_{e}$ and $M_{e}$, using the relative Frobenius norm error\n$$\nE_{K} \\;=\\; \\frac{\\|\\,K_{e}^{(1\\times 1)} - K_{e}\\,\\|_{F}}{\\|\\,K_{e}\\,\\|_{F}},\n\\qquad\nE_{M} \\;=\\; \\frac{\\|\\,M_{e}^{(1\\times 1)} - M_{e}\\,\\|_{F}}{\\|\\,M_{e}\\,\\|_{F}}.\n$$\n\nEvaluate these errors for $a = 0.3$, $b = 0.2$. Express the final answer as the row vector $(E_{K}, E_{M})$ and round your answer to four significant figures. Report the final answer as dimensionless numbers.",
            "solution": "The problem is first subjected to a validation procedure.\n\n### Step 1: Extract Givens\n- **Formulation**: Two-dimensional time-harmonic Transverse Electric (TE) scalar Helmholtz equation.\n- **Method**: Finite Element Method (FEM).\n- **Element**: Single isoparametric bilinear quadrilateral ($p=1$, $Q_1$) element.\n- **Physical Domain**: Axis-aligned rectangle $\\Omega_e$ with side lengths $a$ and $b$ (in meters).\n- **Reference Domain**: Square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ in coordinates $(\\xi, \\eta)$.\n- **Mapping**: Affine mapping from reference to physical element with Jacobian determinant $\\det J = ab/4$.\n- **Material Properties**: Homogeneous and isotropic medium with constant permittivity $\\varepsilon$ and permeability $\\mu$.\n- **Frequency**: Angular frequency $\\omega$.\n- **Shape Functions**: Standard bilinear shape functions $N_{i}(\\xi,\\eta)$, for $i=1, \\dots, 4$.\n- **Element Matrices Definitions**:\n  - Stiffness matrix: $(K_{e})_{ij} = \\int_{\\Omega_{e}} \\frac{1}{\\mu} \\nabla N_{i} \\cdot \\nabla N_{j} \\, \\mathrm{d}\\Omega$\n  - Mass matrix: $(M_{e})_{ij} = \\int_{\\Omega_{e}} \\omega^{2} \\varepsilon \\, N_{i} N_{j} \\, \\mathrm{d}\\Omega$\n- **Task 1 Quadrature**: Exact evaluation using $2 \\times 2$ Gauss-Legendre quadrature.\n- **Task 2 Quadrature**: Approximate evaluation using $1 \\times 1$ Gauss quadrature.\n- **Task 3 Error Metric**: Relative Frobenius norm error, $E_X = \\|\\,X_{e}^{(1\\times 1)} - X_{e}\\,\\|_{F}/\\|\\,X_{e}\\,\\|_{F}$ for $X \\in \\{K, M\\}$.\n- **Task 3 Parameters**: $a = 0.3$, $b = 0.2$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard application of the Finite Element Method to the Helmholtz equation, a cornerstone of computational electromagnetics. The definitions of the stiffness and mass matrices are correct for the TE scalar formulation. The isoparametric mapping is standard. The specified Jacobian determinant is correct for an affine map from a $2 \\times 2$ square to an $a \\times b$ rectangle. The integrands for the stiffness and mass matrices on the reference element are polynomials of degree at most $2$ in each variable ($\\xi$ and $\\eta$). A $2 \\times 2$ Gauss-Legendre quadrature rule integrates polynomials of degree up to $2 \\times 2 - 1 = 3$ in each variable exactly. Therefore, the statement that this rule provides the exact evaluation is correct. The problem is well-posed, objective, self-contained, and all data are physically and mathematically consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe solution proceeds by first transforming the integrals from the physical element $\\Omega_e$ to the reference element $\\hat{\\Omega}$, then evaluating these integrals to find the matrices, and finally computing the specified errors.\n\n**1. Isoparametric Mapping and Integral Transformation**\nLet the physical coordinates be $(x,y)$ and reference coordinates be $(\\xi,\\eta)$. For an axis-aligned rectangle with a corner at the origin, the affine mapping is $x = \\frac{a}{2}(1+\\xi)$ and $y = \\frac{b}{2}(1+\\eta)$. The Jacobian matrix of this transformation is\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2} & 0 \\\\ 0 & \\frac{b}{2} \\end{pmatrix}\n$$\nThe determinant is $\\det(J) = \\frac{ab}{4}$, and the inverse Jacobian is $J^{-1} = \\begin{pmatrix} 2/a & 0 \\\\ 0 & 2/b \\end{pmatrix}$.\nThe gradient operator in physical coordinates transforms as:\n$$\n\\nabla_{(x,y)} = \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = (J^{-1})^T \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{a} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{2}{b} \\frac{\\partial}{\\partial \\eta} \\end{pmatrix}\n$$\nThe differential area element transforms as $\\mathrm{d}\\Omega = \\det(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta = \\frac{ab}{4} \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$.\n\nThe bilinear shape functions are:\n$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n\n**Task 1: Exact Element Matrices ($K_e$, $M_e$)**\n\nThe mass matrix integral is transformed to the reference element:\n$$\n(M_e)_{ij} = \\int_{-1}^{1} \\int_{-1}^{1} \\omega^2 \\varepsilon N_i N_j \\left(\\frac{ab}{4}\\right) \\mathrm{d}\\xi \\mathrm{d}\\eta = \\frac{\\omega^2 \\varepsilon ab}{4} \\int_{-1}^{1} \\int_{-1}^{1} N_i N_j \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\nLet $M_{ij}^{\\text{ref}} = \\int_{-1}^{1} \\int_{-1}^{1} N_i N_j \\, \\mathrm{d}\\xi \\mathrm{d}\\eta$. Exact integration (or the equivalent $2 \\times 2$ Gauss rule) yields the well-known reference mass matrix:\n$$\nM^{\\text{ref}} = \\frac{1}{9} \\begin{pmatrix} 4 & 2 & 1 & 2 \\\\ 2 & 4 & 2 & 1 \\\\ 1 & 2 & 4 & 2 \\\\ 2 & 1 & 2 & 4 \\end{pmatrix}\n$$\nThus, the exact element mass matrix is:\n$$\nM_e = \\frac{\\omega^2 \\varepsilon ab}{36} \\begin{pmatrix} 4 & 2 & 1 & 2 \\\\ 2 & 4 & 2 & 1 \\\\ 1 & 2 & 4 & 2 \\\\ 2 & 1 & 2 & 4 \\end{pmatrix}\n$$\n\nThe stiffness matrix integral is transformed:\n$$\n(K_e)_{ij} = \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{\\mu} (\\nabla_{(x,y)} N_i \\cdot \\nabla_{(x,y)} N_j) \\left(\\frac{ab}{4}\\right) \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\nThe dot product is $\\nabla N_i \\cdot \\nabla N_j = \\frac{4}{a^2} \\frac{\\partial N_i}{\\partial \\xi}\\frac{\\partial N_j}{\\partial \\xi} + \\frac{4}{b^2} \\frac{\\partial N_i}{\\partial \\eta}\\frac{\\partial N_j}{\\partial \\eta}$.\n$$\n(K_e)_{ij} = \\frac{ab}{4\\mu} \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\frac{4}{a^2} \\frac{\\partial N_i}{\\partial \\xi}\\frac{\\partial N_j}{\\partial \\xi} + \\frac{4}{b^2} \\frac{\\partial N_i}{\\partial \\eta}\\frac{\\partial N_j}{\\partial \\eta} \\right) \\mathrm{d}\\xi \\mathrm{d}\\eta = \\frac{b}{a\\mu} K_{ij}^\\xi + \\frac{a}{b\\mu} K_{ij}^\\eta\n$$\nwhere $K_{ij}^\\xi = \\int_{-1}^1 \\int_{-1}^1 \\frac{\\partial N_i}{\\partial \\xi}\\frac{\\partial N_j}{\\partial \\xi} \\mathrm{d}\\xi \\mathrm{d}\\eta$ and $K_{ij}^\\eta = \\int_{-1}^1 \\int_{-1}^1 \\frac{\\partial N_i}{\\partial \\eta}\\frac{\\partial N_j}{\\partial \\eta} \\mathrm{d}\\xi \\mathrm{d}\\eta$.\nExact integration gives the standard reference matrices:\n$$\nK^{\\xi} = \\frac{1}{6} \\begin{pmatrix} 2 & -2 & -1 & 1 \\\\ -2 & 2 & 1 & -1 \\\\ -1 & 1 & 2 & -2 \\\\ 1 & -1 & -2 & 2 \\end{pmatrix}, \\quad K^{\\eta} = \\frac{1}{6} \\begin{pmatrix} 2 & 1 & -1 & -2 \\\\ 1 & 2 & -2 & -1 \\\\ -1 & -2 & 2 & 1 \\\\ -2 & -1 & 1 & 2 \\end{pmatrix}\n$$\nCombining these, the exact element stiffness matrix is:\n$$\nK_e = \\frac{1}{6\\mu} \\left[ \\frac{b}{a} \\begin{pmatrix} 2 & -2 & -1 & 1 \\\\ -2 & 2 & 1 & -1 \\\\ -1 & 1 & 2 & -2 \\\\ 1 & -1 & -2 & 2 \\end{pmatrix} + \\frac{a}{b} \\begin{pmatrix} 2 & 1 & -1 & -2 \\\\ 1 & 2 & -2 & -1 \\\\ -1 & -2 & 2 & 1 \\\\ -2 & -1 & 1 & 2 \\end{pmatrix} \\right]\n$$\n\n**Task 2: Approximate Matrices ($K_e^{(1\\times 1)}$, $M_e^{(1\\times 1)}$) with $1 \\times 1$ Gauss Rule**\n\nThe $1 \\times 1$ Gauss rule on $\\hat{\\Omega}$ approximates an integral as $\\int_{-1}^1 \\int_{-1}^1 f(\\xi,\\eta) \\mathrm{d}\\xi\\mathrm{d}\\eta \\approx 4 f(0,0)$.\nAt $(\\xi,\\eta)=(0,0)$, $N_i(0,0) = 1/4$ for all $i=1,\\dots,4$.\nThe integrand for the reference mass matrix becomes $N_i(0,0)N_j(0,0) = 1/16$.\n$$\n(M_{e}^{(1\\times 1)})_{ij} = \\frac{\\omega^2 \\varepsilon ab}{4} \\left( 4 \\times N_i(0,0)N_j(0,0) \\right) = \\frac{\\omega^2 \\varepsilon ab}{4} \\left( 4 \\times \\frac{1}{16} \\right) = \\frac{\\omega^2 \\varepsilon ab}{16}\n$$\nThis results in a constant matrix:\n$$\nM_e^{(1\\times 1)} = \\frac{\\omega^2 \\varepsilon ab}{16} \\begin{pmatrix} 1 & 1 & 1 & 1 \\\\ 1 & 1 & 1 & 1 \\\\ 1 & 1 & 1 & 1 \\\\ 1 & 1 & 1 & 1 \\end{pmatrix}\n$$\nFor the stiffness matrix, we evaluate the shape function derivatives at $(0,0)$:\n$\\frac{\\partial N_1}{\\partial\\xi}=-\\frac{1}{4}, \\frac{\\partial N_2}{\\partial\\xi}=\\frac{1}{4}, \\frac{\\partial N_3}{\\partial\\xi}=\\frac{1}{4}, \\frac{\\partial N_4}{\\partial\\xi}=-\\frac{1}{4}$\n$\\frac{\\partial N_1}{\\partial\\eta}=-\\frac{1}{4}, \\frac{\\partial N_2}{\\partial\\eta}=-\\frac{1}{4}, \\frac{\\partial N_3}{\\partial\\eta}=\\frac{1}{4}, \\frac{\\partial N_4}{\\partial\\eta}=\\frac{1}{4}$\nApproximating $K^\\xi$ and $K^\\eta$ with the $1 \\times 1$ rule:\n$(K^{\\xi, (1\\times 1)})_{ij} = 4 \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\frac{\\partial N_j}{\\partial \\xi}(0,0)$. This gives:\n$$\nK^{\\xi, (1\\times 1)} = \\frac{4}{16} \\begin{pmatrix} -1 \\\\ 1 \\\\ 1 \\\\ -1 \\end{pmatrix} \\begin{pmatrix} -1 & 1 & 1 & -1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1 & -1 & -1 & 1 \\\\ -1 & 1 & 1 & -1 \\\\ -1 & 1 & 1 & -1 \\\\ 1 & -1 & -1 & 1 \\end{pmatrix}\n$$\nSimilarly,\n$$\nK^{\\eta, (1\\times 1)} = \\frac{4}{16} \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} -1 & -1 & 1 & 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1 & 1 & -1 & -1 \\\\ 1 & 1 & -1 & -1 \\\\ -1 & -1 & 1 & 1 \\\\ -1 & -1 & 1 & 1 \\end{pmatrix}\n$$\nThe approximate stiffness matrix is $K_e^{(1\\times 1)} = \\frac{b}{a\\mu}K^{\\xi, (1\\times 1)} + \\frac{a}{b\\mu}K^{\\eta, (1\\times 1)}$, which is:\n$$\nK_e^{(1\\times 1)} = \\frac{1}{4\\mu} \\left[ \\frac{b}{a} \\begin{pmatrix} 1 & -1 & -1 & 1 \\\\ -1 & 1 & 1 & -1 \\\\ -1 & 1 & 1 & -1 \\\\ 1 & -1 & -1 & 1 \\end{pmatrix} + \\frac{a}{b} \\begin{pmatrix} 1 & 1 & -1 & -1 \\\\ 1 & 1 & -1 & -1 \\\\ -1 & -1 & 1 & 1 \\\\ -1 & -1 & 1 & 1 \\end{pmatrix} \\right]\n$$\n\n**Task 3: Quadrature Error Evaluation**\n\nThe relative Frobenius norm error is $E_X = \\frac{\\|X_e^{(1\\times 1)} - X_e\\|_F}{\\|X_e\\|_F}$. Note that common scalar factors cancel.\n\nFor the mass matrix, $E_M = \\frac{\\|\\frac{\\omega^2 \\varepsilon ab}{16} J_4 - \\frac{\\omega^2 \\varepsilon ab}{4} M^{\\text{ref}}\\|_F}{\\|\\frac{\\omega^2 \\varepsilon ab}{4} M^{\\text{ref}}\\|_F} = \\frac{\\|\\frac{1}{4} J_4 - M^{\\text{ref}}\\|_F}{\\|M^{\\text{ref}}\\|_F}$, where $J_4$ is the $4 \\times 4$ matrix of ones.\nLet $\\Delta M = \\frac{1}{4} J_4 - M^{\\text{ref}} = \\frac{1}{36} \\left( 9 J_4 - 4 \\begin{pmatrix} 4 & 2 & 1 & 2 \\\\ \\dots \\end{pmatrix} \\right) = \\frac{1}{36} \\begin{pmatrix} -7 & 1 & 5 & 1 \\\\ 1 & -7 & 1 & 5 \\\\ 5 & 1 & -7 & 1 \\\\ 1 & 5 & 1 & -7 \\end{pmatrix}$.\n$\\|\\Delta M\\|_F^2 = (\\frac{1}{36})^2 \\left( 4 \\times ((-7)^2 + 1^2 + 5^2 + 1^2) \\right) = (\\frac{1}{36})^2 (4 \\times 76) = \\frac{304}{1296}$.\n$\\|M^{\\text{ref}}\\|_F^2 = (\\frac{1}{9})^2 \\left( 4 \\times (4^2+2^2+1^2+2^2) \\right) = (\\frac{1}{81}) (4 \\times 25) = \\frac{100}{81}$.\n$E_M^2 = \\frac{304/1296}{100/81} = \\frac{304}{1296} \\frac{81}{100} = \\frac{304}{16 \\times 100} = \\frac{19}{100} = 0.19$.\n$E_M = \\sqrt{0.19} \\approx 0.435889...$\nThis error is independent of $a$ and $b$.\n\nFor the stiffness matrix, we let $\\alpha = a/b$ and $\\beta = b/a$. The factor $1/\\mu$ cancels.\nLet $K'_e = 6\\mu K_e = \\beta(6K^\\xi) + \\alpha(6K^\\eta)$ and $K'^{(1\\times 1)}_e = 4\\mu K_e^{(1\\times 1)} = \\beta(4K^{\\xi,(1\\times 1)}) + \\alpha(4K^{\\eta,(1\\times 1)})$. The scaling is different. Let's work with $K_e' = \\mu K_e$ and $K_e'^{(1\\times 1)} = \\mu K_e^{(1\\times 1)}$.\n$\\Delta K' = K_e'^{(1\\times 1)} - K_e' = \\beta(K^{\\xi,(1\\times 1)}-K^\\xi) + \\alpha(K^{\\eta,(1\\times 1)}-K^\\eta)$.\n$K^{\\xi,(1\\times 1)}-K^\\xi = \\frac{1}{4} \\begin{pmatrix} 1 & \\dots \\end{pmatrix} - \\frac{1}{6} \\begin{pmatrix} 2 & \\dots \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} -1 & 1 & -1 & 1 \\\\ 1 & -1 & 1 & -1 \\\\ -1 & 1 & -1 & 1 \\\\ 1 & -1 & 1 & -1 \\end{pmatrix} = \\frac{1}{12}U$.\nIt can be shown that $K^{\\eta,(1\\times 1)}-K^\\eta = \\frac{1}{12}U$ as well.\nSo, $\\Delta K' = \\beta(\\frac{1}{12}U) + \\alpha(\\frac{1}{12}U) = \\frac{\\alpha+\\beta}{12}U$.\n$\\|\\Delta K'\\|_F^2 = \\left(\\frac{\\alpha+\\beta}{12}\\right)^2 \\|U\\|_F^2 = \\left(\\frac{\\alpha+\\beta}{12}\\right)^2 \\times 16 = \\frac{(\\alpha+\\beta)^2}{9}$.\nThe denominator is $\\|K'_e\\|_F^2 = \\|\\beta K^\\xi + \\alpha K^\\eta\\|_F^2 = \\beta^2\\|K^\\xi\\|_F^2 + \\alpha^2\\|K^\\eta\\|_F^2 + 2\\alpha\\beta \\langle K^\\xi, K^\\eta \\rangle_F$.\n$\\|K^\\xi\\|_F^2_F = \\|K^\\eta\\|_F^2 = (\\frac{1}{6})^2(40) = \\frac{40}{36} = \\frac{10}{9}$.\n$\\langle K^\\xi, K^\\eta \\rangle_F = (\\frac{1}{6})^2 \\sum (6K^\\xi)_{ij}(6K^\\eta)_{ij} = \\frac{1}{36}(4) = \\frac{1}{9}$.\n$\\|K'_e\\|_F^2 = \\beta^2(\\frac{10}{9}) + \\alpha^2(\\frac{10}{9}) + 2\\alpha\\beta(\\frac{1}{9}) = \\frac{2}{9}(5\\alpha^2+5\\beta^2+\\alpha\\beta)$.\n$E_K^2 = \\frac{\\|\\Delta K'\\|_F^2}{\\|K'_e\\|_F^2} = \\frac{(\\alpha+\\beta)^2/9}{ \\frac{2}{9}(5\\alpha^2+5\\beta^2+\\alpha\\beta) } = \\frac{(\\alpha+\\beta)^2}{2(5\\alpha^2+5\\beta^2+\\alpha\\beta)}$.\n\nNow, we substitute $a=0.3$ and $b=0.2$.\n$\\alpha = a/b = 1.5 = 3/2$. $\\beta = b/a = 2/3$.\n$\\alpha\\beta = 1$. $\\alpha+\\beta = 3/2 + 2/3 = 13/6$. $\\alpha^2 = 9/4$. $\\beta^2=4/9$.\n$E_K^2 = \\frac{(13/6)^2}{2(5(9/4) + 5(4/9) + 1)} = \\frac{169/36}{2(45/4 + 20/9 + 1)} = \\frac{169/36}{2((405+80+36)/36)} = \\frac{169}{2(521)} = \\frac{169}{1042}$.\n$E_K = \\sqrt{169/1042} = 13/\\sqrt{1042} \\approx 0.402720...$\n\nThe final errors, rounded to four significant figures, are:\n$E_K \\approx 0.4027$\n$E_M \\approx 0.4359$\n\nThe final answer is the row vector $(E_K, E_M)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 0.4027 & 0.4359 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once element matrices are computed, they are assembled into global systems. In time-domain simulations using explicit schemes, a diagonal (\"lumped\") mass matrix offers significant computational savings by avoiding a matrix inversion at each time step. This practice  explores the consequences of this common approximation. You will perform a numerical dispersion analysis to quantify how lumping the mass matrix, while simplifying the computation, impacts the phase velocity of propagating waves, a crucial measure of simulation fidelity.",
            "id": "3305148",
            "problem": "Consider the lossless, source-free, one-dimensional ($1$D) Transverse Electromagnetic (TEM) reduction of Maxwell’s equations on a uniform mesh of spacing $h$ with periodic boundary conditions in nondimensional units where the wave speed is $c = 1$. Eliminating the magnetic field from Faraday’s and Ampère’s laws yields the second-order wave equation for the electric field component $E(x,t)$,\n$$\n\\frac{\\partial^2 E}{\\partial t^2} = c^2 \\frac{\\partial^2 E}{\\partial x^2}.\n$$\nUsing the Galerkin Finite Element Method (FEM) with continuous, piecewise-linear basis functions on the uniform mesh, the semi-discrete system obtained by assembling element contributions over the mesh is\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},\n$$\nwhere $\\mathbf{u}(t)$ are the nodal values of the electric field, $\\mathbf{M}$ is the element-assembled mass matrix, and $\\mathbf{K}$ is the element-assembled stiffness matrix. Define two mass matrix variants:\n- The consistent mass matrix $\\mathbf{M}_{\\mathrm{c}}$ obtained from exact element integrals.\n- The lumped mass matrix $\\mathbf{M}_{\\mathrm{l}}$ obtained by row-sum lumping of the consistent matrix.\n\nAdvance in time using an explicit central-difference scheme with a uniform step $\\Delta t$,\n$$\n\\mathbf{M}\\,\\frac{\\mathbf{u}^{n+1} - 2\\,\\mathbf{u}^{n} + \\mathbf{u}^{n-1}}{\\Delta t^2} + \\mathbf{K}\\,\\mathbf{u}^{n} = \\mathbf{0},\n$$\nwhere $\\mathbf{u}^{n}$ denotes the nodal vector at time level $t^n = n\\,\\Delta t$.\n\nYour tasks:\n- Starting from the above fundamental laws and definitions, derive the element matrices for a single linear finite element on an interval of length $h$ and the resulting assembled tri-diagonal forms for $\\mathbf{M}_{\\mathrm{c}}$, $\\mathbf{M}_{\\mathrm{l}}$, and $\\mathbf{K}$ on a uniform periodic mesh.\n- Using Fourier (von Neumann) analysis on the infinite uniform grid, derive the discrete dispersion relation connecting the nondimensional temporal frequency $\\Omega$, the nondimensional spatial phase increment $\\theta = k\\,h$, the time step $\\Delta t$, and the Fourier symbols of the assembled operators for both $\\mathbf{M}_{\\mathrm{c}}$ and $\\mathbf{M}_{\\mathrm{l}}$.\n- Define the discrete phase velocity as\n$$\nc_{\\mathrm{ph}}^{\\mathrm{num}}(\\theta,\\Delta t) = \\frac{(\\Omega/\\Delta t)}{(k)} = \\frac{h\\,\\Omega}{\\Delta t\\,\\theta},\n$$\nand the relative phase-velocity error as\n$$\ne(\\theta,\\Delta t) = \\left|\\,c_{\\mathrm{ph}}^{\\mathrm{num}}(\\theta,\\Delta t) - 1\\,\\right|.\n$$\n- To ensure a fair comparison under a common stability restriction, choose the time step as\n$$\n\\Delta t = \\alpha\\,\\frac{h}{c}\\,\\sqrt{\\frac{1}{3}},\n$$\nwith a user-selected Courant-like factor $\\alpha \\in (0,1)$ applied identically to both $\\mathbf{M}_{\\mathrm{c}}$ and $\\mathbf{M}_{\\mathrm{l}}$.\n\nImplement a program that:\n- For each test case specified below, computes the relative phase-velocity errors $e_{\\mathrm{c}}$ and $e_{\\mathrm{l}}$ for the consistent and lumped mass matrices, respectively, using the dispersion relation derived from the assembled element matrices and the explicit scheme.\n- Aggregates the results as a list of pairs $[e_{\\mathrm{c}}, e_{\\mathrm{l}}]$, one pair per test case, and prints them on a single line as a Python-style list.\n\nUse the following test suite, where each case specifies $(h, \\theta, \\alpha)$:\n- Case $1$: $h = 0.1$, $\\theta = \\pi/16$, $\\alpha = 0.2$.\n- Case $2$: $h = 0.1$, $\\theta = \\pi/2$, $\\alpha = 0.9$.\n- Case $3$: $h = 0.1$, $\\theta = 7\\pi/8$, $\\alpha = 0.9$.\n- Case $4$: $h = 0.1$, $\\theta = \\pi$, $\\alpha = 0.99$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one sublist per test case in the same order as above, for example, $[[e_{\\mathrm{c},1}, e_{\\mathrm{l},1}],[e_{\\mathrm{c},2}, e_{\\mathrm{l},2}],\\dots]$.\n- Each $e_{\\mathrm{c}}$ and $e_{\\mathrm{l}}$ must be a floating-point number.\n- Angles are in radians, and no physical units are used (dimensionless formulation).",
            "solution": "The problem is assessed as valid as it is scientifically grounded in the principles of computational electromagnetics and numerical analysis, is well-posed with a complete and consistent set of definitions, and is expressed in objective, formal language. We may therefore proceed with the derivation and solution.\n\nThe primary objective is to analyze the numerical dispersion characteristics of a Galerkin Finite Element Method (FEM) solution to the $1$D wave equation,\n$$\n\\frac{\\partial^2 E}{\\partial t^2} = c^2 \\frac{\\partial^2 E}{\\partial x^2},\n$$\nwith wave speed $c=1$. The analysis compares two variants of the mass matrix, consistent ($\\mathbf{M}_{\\mathrm{c}}$) and lumped ($\\mathbf{M}_{\\mathrm{l}}$), when using an explicit central-difference time integration scheme.\n\n**1. Weak Formulation and Derivation of Element Matrices**\n\nThe Galerkin FEM begins with the weak (or variational) form of the governing equation. We multiply the wave equation by a test function $\\phi(x)$ and integrate over the spatial domain. After integration by parts of the spatial derivative term, the semi-discrete weak form is: Find the electric field approximation $E_h(x,t) = \\sum_j u_j(t) \\phi_j(x)$ such that for every basis function $\\phi_i$,\n$$\n\\int \\phi_i \\frac{\\partial^2 E_h}{\\partial t^2} dx + \\int c^2 \\frac{\\partial \\phi_i}{\\partial x} \\frac{\\partial E_h}{\\partial x} dx = 0.\n$$\nSubstituting the expansion for $E_h$ and with $c=1$, this becomes the matrix system $\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}$, where the entries of the global mass matrix $\\mathbf{M}$ and stiffness matrix $\\mathbf{K}$ are assembled from element-level contributions:\n$$\nM_{ij} = \\int \\phi_i \\phi_j dx \\quad \\text{and} \\quad K_{ij} = \\int \\frac{\\partial \\phi_i}{\\partial x} \\frac{\\partial \\phi_j}{\\partial x} dx.\n$$\nWe consider a single finite element of length $h$ defined on the local interval $[0, h]$. The continuous, piecewise-linear basis functions (hat functions) for nodes $1$ and $2$ of this element are:\n$$\n\\phi_1(x) = 1 - \\frac{x}{h}, \\quad \\phi_2(x) = \\frac{x}{h} \\quad \\text{for } x \\in [0, h].\n$$\nTheir derivatives are $\\frac{d\\phi_1}{dx} = -\\frac{1}{h}$ and $\\frac{d\\phi_2}{dx} = \\frac{1}{h}$.\n\nThe element stiffness matrix $\\mathbf{K}^{(e)}$ is computed as:\n$$\nK_{ij}^{(e)} = \\int_0^h \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} dx \\implies \\mathbf{K}^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}.\n$$\nThe element consistent mass matrix $\\mathbf{M}_{\\mathrm{c}}^{(e)}$ is computed by integrating the products of the basis functions:\n$$\nM_{c,ij}^{(e)} = \\int_0^h \\phi_i(x) \\phi_j(x) dx \\implies \\mathbf{M}_{\\mathrm{c}}^{(e)} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\n\n**2. Assembled Operators and Lumping**\n\nFor a uniform periodic grid, the global matrices are circulant. The action of such a matrix on a vector can be described by a repeating stencil applied at each node $j$. The stencil is formed by assembling contributions from the two elements sharing node $j$: $[x_{j-1}, x_j]$ and $[x_j, x_{j+1}]$.\nThe stencil for the stiffness operator $\\mathbf{K}$ acting on the nodal vector $\\mathbf{u}$ at node $j$ is:\n$$\n(\\mathbf{K}\\mathbf{u})_j = \\frac{1}{h}(-u_{j-1} + 2u_j - u_{j+1}), \\quad \\text{stencil: } \\frac{1}{h}[-1, 2, -1].\n$$\nThe stencil for the consistent mass operator $\\mathbf{M}_{\\mathrm{c}}$ is:\n$$\n(\\mathbf{M}_{\\mathrm{c}}\\ddot{\\mathbf{u}})_j = \\frac{h}{6}(\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}), \\quad \\text{stencil: } \\frac{h}{6}[1, 4, 1].\n$$\nThe lumped mass matrix $\\mathbf{M}_{\\mathrm{l}}$ is obtained by summing the entries of each row of $\\mathbf{M}_{\\mathrm{c}}$ and placing the result on the diagonal. For the stencil $\\frac{h}{6}[1, 4, 1]$, the row sum is $\\frac{h}{6}(1+4+1) = h$. This results in a diagonal matrix $\\mathbf{M}_{\\mathrm{l}} = h\\mathbf{I}$, where $\\mathbf{I}$ is the identity matrix. The operator action is simply:\n$$\n(\\mathbf{M}_{\\mathrm{l}}\\ddot{\\mathbf{u}})_j = h\\ddot{u}_j.\n$$\n\n**3. Fourier Analysis and Operator Symbols**\n\nWe perform a Fourier analysis by substituting a discrete plane wave solution $u_j^n = \\hat{u} e^{i(k x_j - \\Omega t^n)}$ into the fully discretized central-difference scheme:\n$$\n\\mathbf{M}\\,\\frac{\\mathbf{u}^{n+1} - 2\\,\\mathbf{u}^{n} + \\mathbf{u}^{n-1}}{\\Delta t^2} + \\mathbf{K}\\,\\mathbf{u}^{n} = \\mathbf{0}.\n$$\nLet $\\theta = kh$ be the nondimensional spatial phase increment per element. The action of a stencil-based operator on this wave becomes multiplication by its Fourier symbol.\nThe Fourier symbol $\\hat{K}(\\theta)$ of the stiffness operator is:\n$$\n\\hat{K}(\\theta) = \\frac{1}{h}(-e^{-i\\theta} + 2 - e^{i\\theta}) = \\frac{1}{h}(2 - 2\\cos\\theta) = \\frac{4\\sin^2(\\theta/2)}{h}.\n$$\nThe Fourier symbol $\\hat{M}_{\\mathrm{c}}(\\theta)$ of the consistent mass operator is:\n$$\n\\hat{M}_{\\mathrm{c}}(\\theta) = \\frac{h}{6}(e^{-i\\theta} + 4 + e^{i\\theta}) = \\frac{h}{6}(4 + 2\\cos\\theta) = \\frac{h}{3}(2 + \\cos\\theta).\n$$\nThe Fourier symbol $\\hat{M}_{\\mathrm{l}}(\\theta)$ of the lumped mass operator is simply $\\hat{M}_{\\mathrm{l}}(\\theta) = h$.\nThe time-difference operator becomes:\n$$\n\\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{\\Delta t^2} \\rightarrow \\frac{e^{-i\\Omega} - 2 + e^{i\\Omega}}{\\Delta t^2} = \\frac{2(\\cos\\Omega - 1)}{\\Delta t^2} = -\\frac{4\\sin^2(\\Omega/2)}{\\Delta t^2}.\n$$\n\n**4. Derivation of the Discrete Dispersion Relation**\n\nSubstituting the symbols into the transformed discrete equation yields:\n$$\n\\hat{M}(\\theta) \\left( -\\frac{4\\sin^2(\\Omega/2)}{\\Delta t^2} \\right) + \\hat{K}(\\theta) = 0 \\implies \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\frac{\\Delta t^2}{4} \\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)}.\n$$\nThis gives the general dispersion relation:\n$$\n\\Omega = 2 \\arcsin\\left(\\frac{\\Delta t}{2} \\sqrt{\\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)}}\\right).\n$$\nWe now specialize this for the two mass matrices.\n\nFor consistent mass ($\\mathbf{M}_{\\mathrm{c}}$):\n$$\n\\frac{\\hat{K}(\\theta)}{\\hat{M}_{\\mathrm{c}}(\\theta)} = \\frac{4\\sin^2(\\theta/2)/h}{h/3(2+\\cos\\theta)} = \\frac{12\\sin^2(\\theta/2)}{h^2(2+\\cos\\theta)} = \\frac{12\\sin^2(\\theta/2)}{h^2(3-2\\sin^2(\\theta/2))}.\n$$\nFor lumped mass ($\\mathbf{M}_{\\mathrm{l}}$):\n$$\n\\frac{\\hat{K}(\\theta)}{\\hat{M}_{\\mathrm{l}}(\\theta)} = \\frac{4\\sin^2(\\theta/2)/h}{h} = \\frac{4\\sin^2(\\theta/2)}{h^2}.\n$$\nSubstituting these ratios into the equation for $\\Omega$ gives the specific dispersion relations for $\\Omega_{\\mathrm{c}}$ and $\\Omega_{\\mathrm{l}}$.\n\n**5. Numerical Phase Velocity and Error**\n\nThe problem specifies the time step $\\Delta t = \\alpha \\frac{h}{c} \\sqrt{\\frac{1}{3}} = \\alpha h \\sqrt{1/3}$ since $c=1$.\nThe numerical phase velocity is defined as $c_{\\mathrm{ph}}^{\\mathrm{num}} = \\frac{\\Omega/\\Delta t}{k} = \\frac{h\\Omega}{\\theta\\Delta t}$. Substituting the expression for $\\Delta t$:\n$$\nc_{\\mathrm{ph}}^{\\mathrm{num}} = \\frac{h\\Omega}{\\theta (\\alpha h \\sqrt{1/3})} = \\frac{\\sqrt{3}\\,\\Omega}{\\alpha\\,\\theta}.\n$$\nFor the **consistent mass matrix**, substituting the corresponding ratio into the formula for $\\Omega$:\n$$\n\\Omega_{\\mathrm{c}} = 2 \\arcsin\\left( \\frac{\\alpha h \\sqrt{1/3}}{2} \\sqrt{\\frac{12\\sin^2(\\theta/2)}{h^2(3-2\\sin^2(\\theta/2))}} \\right) = 2 \\arcsin\\left( \\frac{\\alpha \\sin(\\theta/2)}{\\sqrt{3-2\\sin^2(\\theta/2)}} \\right).\n$$\nThe phase velocity is therefore:\n$$\nc_{\\mathrm{ph}, \\mathrm{c}}^{\\mathrm{num}} = \\frac{2\\sqrt{3}}{\\alpha\\,\\theta} \\arcsin\\left( \\frac{\\alpha \\sin(\\theta/2)}{\\sqrt{3-2\\sin^2(\\theta/2)}} \\right).\n$$\nFor the **lumped mass matrix**, the derivation is analogous:\n$$\n\\Omega_{\\mathrm{l}} = 2 \\arcsin\\left( \\frac{\\alpha h \\sqrt{1/3}}{2} \\sqrt{\\frac{4\\sin^2(\\theta/2)}{h^2}} \\right) = 2 \\arcsin\\left( \\frac{\\alpha}{\\sqrt{3}} \\sin(\\theta/2) \\right).\n$$\nThe phase velocity is:\n$$\nc_{\\mathrm{ph}, \\mathrm{l}}^{\\mathrm{num}} = \\frac{2\\sqrt{3}}{\\alpha\\,\\theta} \\arcsin\\left( \\frac{\\alpha}{\\sqrt{3}} \\sin(\\theta/2) \\right).\n$$\nThe relative phase-velocity error for each case is calculated as $e = |c_{\\mathrm{ph}}^{\\mathrm{num}} - 1|$. These are the final formulas implemented in the program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative phase-velocity errors for a 1D FEM wave equation\n    simulation using consistent and lumped mass matrices.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (h, theta, alpha)\n    test_cases = [\n        (0.1, np.pi / 16.0, 0.2),\n        (0.1, np.pi / 2.0, 0.9),\n        (0.1, 7.0 * np.pi / 8.0, 0.9),\n        (0.1, np.pi, 0.99),\n    ]\n\n    results = []\n    for h, theta, alpha in test_cases:\n        # The mesh spacing 'h' is not needed in the final algebraic expressions\n        # for the normalized phase velocity, but is kept for contextual clarity.\n        \n        # Common terms\n        sin_theta_half = np.sin(theta / 2.0)\n        sqrt3 = np.sqrt(3.0)\n\n        # --- Consistent Mass Matrix Calculation ---\n        \n        # Argument of arcsin for the numerical frequency Omega_c\n        arg_c_arcsin = (alpha * sin_theta_half) / np.sqrt(3.0 - 2.0 * sin_theta_half**2)\n        \n        # The argument must be <= 1 for a stable, non-dissipative scheme.\n        if arg_c_arcsin > 1.0:\n            arg_c_arcsin = 1.0 # Cap at stability limit for a real result\n            \n        # Numerical frequency Omega_c\n        omega_c = 2.0 * np.arcsin(arg_c_arcsin)\n        \n        # Numerical phase velocity c_ph_c\n        # Formula: c_ph = (sqrt(3) * Omega) / (alpha * theta)\n        c_ph_c = (sqrt3 * omega_c) / (alpha * theta)\n        \n        # Relative phase velocity error e_c\n        e_c = np.abs(c_ph_c - 1.0)\n        \n        # --- Lumped Mass Matrix Calculation ---\n        \n        # Argument of arcsin for the numerical frequency Omega_l\n        arg_l_arcsin = (alpha * sin_theta_half) / sqrt3\n\n        # The argument must be <= 1 for stability.\n        if arg_l_arcsin > 1.0:\n            arg_l_arcsin = 1.0\n\n        # Numerical frequency Omega_l\n        omega_l = 2.0 * np.arcsin(arg_l_arcsin)\n        \n        # Numerical phase velocity c_ph_l\n        c_ph_l = (sqrt3 * omega_l) / (alpha * theta)\n\n        # Relative phase velocity error e_l\n        e_l = np.abs(c_ph_l - 1.0)\n\n        results.append([e_c, e_l])\n\n    # Format the output string as a Python-style list of lists,\n    # with no spaces within sublists, e.g., [[e_c1,e_l1],[e_c2,e_l2]].\n    output_str = f\"[{','.join(f'[{ec},{el}]' for ec, el in results)}]\"\n    \n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The final step in setting up a simulation involves assembling the global matrices and applying boundary conditions. The properties of the resulting linear system are paramount for solver efficiency and stability. This exercise  focuses on a key diagnostic: the condition number of the operator $M^{-1}K$. By assembling the system for a simple 1D problem and observing how the condition number scales with mesh refinement, you will uncover a fundamental behavior of FEM discretizations that has profound implications for the performance of iterative solvers in large-scale simulations.",
            "id": "3305124",
            "problem": "Consider the one-dimensional time-harmonic reduction of Maxwell's equations for a transverse electric mode in a perfectly conducting cavity, which on the interval domain $[0,1]$ with homogeneous Dirichlet boundary conditions ($E(0)=0$ and $E(1)=0$) can be represented by the scalar eigenvalue problem in weak form: find $u \\neq 0$ in $H_0^1(0,1)$ such that\n$$\\int_{0}^{1} \\frac{d u}{d x} \\frac{d v}{d x} \\, dx = \\lambda \\int_{0}^{1} u \\, v \\, dx \\quad \\text{for all } v \\in H_0^1(0,1),$$\nwhere $\\lambda$ is a nonnegative eigenvalue. Using the Finite Element Method (FEM), the discretization with conforming, piecewise-polynomial basis functions produces a symmetric positive-definite stiffness matrix $K$ and a symmetric positive-definite mass matrix $M$ so that the discrete generalized eigenproblem reads\n$$K \\, \\mathbf{u} = \\lambda \\, M \\, \\mathbf{u},$$\nwhere $\\mathbf{u}$ is the vector of coefficients of the discrete field. The Condition Number (CN) of the operator $M^{-1}K$ induced by the $M$-inner product equals the ratio of the largest to the smallest generalized eigenvalue $\\lambda$ of the pair $(K,M)$:\n$$\\kappa(M^{-1}K) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}.$$\nYour task is to assemble the global element stiffness and mass matrices for a family of uniformly refined meshes on $[0,1]$ using standard, continuous, piecewise-linear Lagrange basis functions of fixed polynomial order $p=1$, enforce the homogeneous Dirichlet boundary conditions, and compute the numerical value of $\\kappa(M^{-1}K)$ for each mesh.\n\nYou must start from the weak form above and use the following fundamental modeling and discretization steps, without introducing any shortcut formulas that skip these steps:\n- Define a uniform mesh with $N$ elements over $[0,1]$, with nodes at $x_i = i h$ for $i = 0,1,\\dots,N$, where $h = 1/N$.\n- On each element, use the two local, continuous, piecewise-linear Lagrange basis functions that span the local approximation space and map them onto the physical element.\n- Compute the local element stiffness and mass contributions exactly by evaluating the integrals of the products of basis functions and their derivatives over each element.\n- Assemble these local contributions into the global stiffness matrix $K$ and mass matrix $M$ consistent with the mesh topology.\n- Enforce homogeneous Dirichlet boundary conditions by removing the degrees of freedom (DOF) associated with the boundary nodes at $x=0$ and $x=1$, resulting in reduced matrices of size $(N-1) \\times (N-1)$.\n- Compute the generalized eigenvalues of the pair $(K,M)$ for the reduced system and then compute $\\kappa(M^{-1}K)$ as the ratio of the largest to the smallest eigenvalue.\n\nScientific realism requirement: the model is dimensionless, and all quantities are computed in consistent dimensionless units on the unit interval $[0,1]$.\n\nDesign a program that performs the above steps and computes $\\kappa(M^{-1}K)$ for the following test suite of uniform meshes:\n- Happy path: $N = 16$, $N = 32$.\n- Boundary-like minimal interior DOF case: $N = 2$.\n- Moderate refinements: $N = 4$, $N = 8$.\n- Significant edge case for refinement trend: $N = 64$, $N = 128$.\n\nYour program should produce a single line of output containing the condition numbers for these meshes, ordered as $[N=2,N=4,N=8,N=16,N=32,N=64,N=128]$, as a comma-separated list enclosed in square brackets (for example, $[a_1,a_2,\\dots,a_7]$), where each $a_i$ is a floating-point number representing $\\kappa(M^{-1}K)$ for the corresponding $N$.",
            "solution": "The problem requires the computation of the condition number $\\kappa(M^{-1}K)$ for a finite element discretization of a one-dimensional eigenvalue problem. The analysis proceeds by following the specified steps of the Finite Element Method (FEM).\n\nThe weak form of the eigenvalue problem is to find a non-trivial function $u \\in H_0^1(0,1)$ and a corresponding eigenvalue $\\lambda \\ge 0$ such that:\n$$ \\int_{0}^{1} \\frac{d u}{d x} \\frac{d v}{d x} \\, dx = \\lambda \\int_{0}^{1} u \\, v \\, dx $$\nfor all test functions $v \\in H_0^1(0,1)$. The space $H_0^1(0,1)$ consists of functions with square-integrable first derivatives on the interval $[0,1]$ that are zero at the boundaries $x=0$ and $x=1$.\n\nThe discrete form of this problem is the generalized matrix eigenvalue problem $K \\mathbf{u} = \\lambda M \\mathbf{u}$, where $K$ is the stiffness matrix and $M$ is the mass matrix. The condition number is defined as the ratio of the largest to the smallest eigenvalue, $\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$.\n\n**1. Discretization and Basis Functions**\nThe domain $[0,1]$ is discretized into a uniform mesh of $N$ elements, each of length $h = 1/N$. The nodes are located at positions $x_i = i h$ for $i \\in \\{0, 1, \\dots, N\\}$. We use continuous, piecewise-linear ($p=1$) Lagrange basis functions. On a reference element $\\hat{I} = [0, 1]$, the two local basis functions are:\n$$ \\hat{\\phi}_1(\\hat{x}) = 1 - \\hat{x} $$\n$$ \\hat{\\phi}_2(\\hat{x}) = \\hat{x} $$\nTheir derivatives with respect to the reference coordinate $\\hat{x}$ are:\n$$ \\frac{d\\hat{\\phi}_1}{d\\hat{x}} = -1 \\quad \\text{and} \\quad \\frac{d\\hat{\\phi}_2}{d\\hat{x}} = 1 $$\n\n**2. Elemental Matrices**\nAn affine mapping transforms the reference element coordinate $\\hat{x} \\in [0,1]$ to the physical coordinate $x$ in an element $I_e = [x_{i-1}, x_i]$ of length $h$:\n$$ x(\\hat{x}) = x_{i-1} + h\\hat{x} $$\nThe change of variables for integration is $dx = h \\, d\\hat{x}$, and the chain rule for derivatives gives $\\frac{d\\phi}{dx} = \\frac{d\\hat{\\phi}}{d\\hat{x}}\\frac{d\\hat{x}}{dx} = \\frac{1}{h}\\frac{d\\hat{\\phi}}{d\\hat{x}}$.\n\nThe local $2 \\times 2$ element stiffness matrix $K^e$ has entries given by:\n$$ K^e_{ij} = \\int_{I_e} \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} \\, dx = \\int_{0}^{1} \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_i}{d\\hat{x}}\\right) \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_j}{d\\hat{x}}\\right) h \\, d\\hat{x} = \\frac{1}{h} \\int_{0}^{1} \\frac{d\\hat{\\phi}_i}{d\\hat{x}}\\frac{d\\hat{\\phi}_j}{d\\hat{x}} \\, d\\hat{x} $$\nEvaluating this integral for $i,j \\in \\{1,2\\}$ yields:\n$$ K^e = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nThe local $2 \\times 2$ element mass matrix $M^e$ has entries given by:\n$$ M^e_{ij} = \\int_{I_e} \\phi_i \\phi_j \\, dx = \\int_{0}^{1} \\hat{\\phi}_i(\\hat{x}) \\hat{\\phi}_j(\\hat{x}) h \\, d\\hat{x} = h \\int_{0}^{1} \\hat{\\phi}_i(\\hat{x})\\hat{\\phi}_j(\\hat{x}) \\, d\\hat{x} $$\nEvaluating this integral yields:\n$$ M^e = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$\n\n**3. Global Assembly**\nThe global stiffness matrix $K$ and mass matrix $M$ are of size $(N+1) \\times (N+1)$, corresponding to the $N+1$ nodes in the mesh. They are assembled by summing the contributions from each of the $N$ local element matrices. For an element connecting nodes $i-1$ and $i$, its local matrix entries are added to the corresponding global matrix locations. This process results in the following symmetric, tridiagonal global matrices (before applying boundary conditions):\n$$ K = \\frac{1}{h} \\begin{pmatrix} 1 & -1 & & & \\\\ -1 & 2 & -1 & & \\\\ & \\ddots & \\ddots & \\ddots & \\\\ & & -1 & 2 & -1 \\\\ & & & -1 & 1 \\end{pmatrix}, \\quad M = \\frac{h}{6} \\begin{pmatrix} 2 & 1 & & & \\\\ 1 & 4 & 1 & & \\\\ & \\ddots & \\ddots & \\ddots & \\\\ & & 1 & 4 & 1 \\\\ & & & 1 & 2 \\end{pmatrix} $$\n\n**4. Boundary Condition Enforcement**\nThe homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$ imply that the solution coefficients associated with the boundary nodes (node $0$ and node $N$) are zero. These degrees of freedom are eliminated from the system by removing the first (index $0$) and last (index $N$) rows and columns from the global matrices. This produces the reduced stiffness matrix $K_{red}$ and mass matrix $M_{red}$, both of size $(N-1) \\times (N-1)$, which correspond to the interior nodes $1, 2, \\dots, N-1$.\n$$ K_{red} = \\frac{1}{h} \\begin{pmatrix} 2 & -1 & & \\\\ -1 & 2 & -1 & \\\\ & \\ddots & \\ddots & \\ddots \\\\ & & -1 & 2 & -1 \\\\ & & & -1 & 2 \\end{pmatrix}_{(N-1) \\times (N-1)} $$\n$$ M_{red} = \\frac{h}{6} \\begin{pmatrix} 4 & 1 & & \\\\ 1 & 4 & 1 & \\\\ & \\ddots & \\ddots & \\ddots \\\\ & & 1 & 4 & 1 \\\\ & & & 1 & 4 \\end{pmatrix}_{(N-1) \\times (N-1)} $$\n\n**5. Generalized Eigenproblem and Condition Number**\nThe final step is to solve the reduced generalized eigenvalue problem $K_{red}\\mathbf{u}_{int} = \\lambda M_{red}\\mathbf{u}_{int}$ for the $N-1$ eigenvalues $\\{\\lambda_j\\}$. These are computed numerically. The condition number is then found by taking the ratio of the largest and smallest of these computed eigenvalues:\n$$ \\kappa(M^{-1}K) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} $$\nThe algorithm below implements this procedure for the specified values of $N$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Computes the condition number of the FEM operator M^-1 K for a 1D\n    eigenvalue problem on a series of uniformly refined meshes.\n    \"\"\"\n    # Define the test cases from the problem statement, ordered as required for output.\n    test_cases = [2, 4, 8, 16, 32, 64, 128]\n\n    results = []\n    for N in test_cases:\n        # Mesh parameter\n        h = 1.0 / N\n        \n        # Reduced system size (number of interior nodes)\n        # N elements, N+1 total nodes, N-1 interior nodes\n        size_reduced = N - 1\n\n        if size_reduced <= 0:\n            # If N=1, there are no interior nodes, the problem is ill-defined.\n            # For N=2, size_reduced is 1, a valid 1x1 system.\n            # All test cases have N>=2.\n            raise ValueError(\"Number of elements N must be >= 2 for interior DOFs.\")\n\n        # Step 1: Define local element stiffness and mass matrices.\n        # These are computed from the integrals of basis functions and their\n        # derivatives over a reference element.\n        K_local = (1.0 / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n        M_local = (h / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n\n        # Step 2: Assemble global matrices.\n        # Global matrices are of size (N+1)x(N+1) corresponding to all nodes.\n        size_global = N + 1\n        K_global = np.zeros((size_global, size_global))\n        M_global = np.zeros((size_global, size_global))\n\n        # Loop over elements and add local contributions to global matrices.\n        for i in range(N):\n            # Element `i` connects nodes `i` and `i+1`.\n            # The local 2x2 matrix is added to the corresponding block \n            # of the global matrix.\n            K_global[i:i+2, i:i+2] += K_local\n            M_global[i:i+2, i:i+2] += M_local\n\n        # Step 3: Enforce homogeneous Dirichlet boundary conditions.\n        # This is done by removing the rows and columns corresponding to the\n        # boundary nodes (node 0 and node N). The reduced matrices correspond\n        # to the interior nodes (1, 2, ..., N-1).\n        K_reduced = K_global[1:N, 1:N]\n        M_reduced = M_global[1:N, 1:N]\n\n        # Step 4: Compute the generalized eigenvalues.\n        # eigh is used because the matrices are symmetric and positive-definite.\n        # It solves the problem A*x = lambda*B*x.\n        eigenvalues = eigh(K_reduced, M_reduced, eigvals_only=True)\n        \n        # Step 5: Compute the condition number.\n        # For a single eigenvalue (case N=2), max and min are the same.\n        lambda_min = np.min(eigenvalues)\n        lambda_max = np.max(eigenvalues)\n        \n        condition_number = lambda_max / lambda_min\n        results.append(condition_number)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}