{
    "hands_on_practices": [
        {
            "introduction": "要高效地使用稀疏直接求解器，首先必须理解待解矩阵的结构。本实践练习将带您回到起点：从一个简单的二维网格生成全局有限元系统矩阵。通过亲手分析其稀疏性和带宽等属性，您将对网格连通性和自由度排序如何直接影响求解器的计算挑战建立起基本直觉。这是一项诊断性能和设计高效求解策略的基础技能。",
            "id": "3299951",
            "problem": "考虑一个二维横电 (TE) 腔体，其壁为理想电导体 (PEC)，占据单位正方形区域 $\\Omega = [0,1] \\times [0,1]$。在频域中，控制方程由麦克斯韦方程组导出，适用于电场 $\\mathbf{E}$ 和磁通量密度 $\\mathbf{B}$，并假设场为角频率为 $\\omega$、磁导率 $\\mu$ 均匀、介电常数 $\\varepsilon$ 均匀的时谐场。该腔体使用一阶 Nédélec 边元（第一类）进行离散化，其剖分方式为：将 $\\Omega$ 细分为一个 $m=2$ 乘 $n=2$ 的结构化正方形网格，然后通过从每个正方形的左下顶点到右上顶点的直线将其分割，从而得到一个协调三角剖分。有限元法 (FEM) 的未知量与三角剖分的有向边相关联，对应于电场 $\\mathbf{E}$ 沿每条边的切向分量。PEC 边界条件强制要求 $\\mathbf{E}$ 在所有边界边上的切向分量为零。\n\n执行以下任务：\n\n- 从麦克斯韦方程组和 PEC 边界条件出发，推导适用于二维 TE 腔体问题的弱形式，并确定其离散对应形式（按单元）定义了旋度-旋度 (刚度) 矩阵和质量矩阵的双线性形式，用参考三角形上的 Nédélec 基函数和到物理坐标的单元映射来表示。\n\n- 使用推导出的弱形式，说明三角形上一阶 Nédélec 边元的局部单元矩阵的结构，用基函数旋度的积分和基函数乘积的积分来表示。不要调用任何预先推导的 FEM 模板；相反，应直接从弱形式和边基函数的定义给出表达式。\n\n- 在施加 PEC 边界约束之前，预测组装好的系统矩阵的全局稀疏模式，解释哪些自由度 (DOF) 对是耦合的及其原因，并讨论在通过强施加约束（狄利克雷消除）来消除边界自由度后，该模式如何变化。\n\n- 将对称稀疏矩阵在给定排序下的半带宽 $b$ 定义为 $b = \\max\\{ j - i \\,:\\, a_{ij} \\neq 0,\\, j \\geq i\\}$，并在以下明确的自由度排序规则下，计算施加边界约束前后全局矩阵的精确半带宽：所有边自由度按边中点的 $y$ 坐标升序排序；若中点 $y$ 坐标相等，则按中点 $x$ 坐标升序排序；若 $(x,y)$ 坐标均相等，则先排水平方向的边，再排垂直方向的边，最后排对角线方向的边。施加边界约束后，舍弃边界边，并对剩余的内部边使用相同的排序规则重新编号。\n\n该三角剖分包含以下边，通过其中点描述：位于 $y=0$ 的水平边，中点为 $(0.25,0)$ 和 $(0.75,0)$；位于 $y=0.5$ 的水平边，中点为 $(0.25,0.5)$ 和 $(0.75,0.5)$；位于 $y=1$ 的水平边，中点为 $(0.25,1)$ 和 $(0.75,1)$；位于 $x=0$ 的垂直边，中点为 $(0,0.25)$ 和 $(0,0.75)$；位于 $x=0.5$ 的垂直边，中点为 $(0.5,0.25)$ 和 $(0.5,0.75)$；位于 $x=1$ 的垂直边，中点为 $(1,0.25)$ 和 $(1,0.75)$；以及每个正方形内的对角线边，中点为 $(0.25,0.25)$、$(0.75,0.25)$、$(0.25,0.75)$ 和 $(0.75,0.75)$。每个正方形内的对角线方向为从左下到右上。边界边是位于 $x=0$、$x=1$、$y=0$ 或 $y=1$ 上的边；所有对角线边都是内部边。假设材料系数是均匀的，且网格是协调的。\n\n在施加边界约束并根据所述排序规则对内部边进行重新编号后，精确计算半带宽。将最终答案表示为一个整数。不需要四舍五入。",
            "solution": "该问题提出了一个关于二维电磁腔体有限元法 (FEM) 分析的综合性问题。它要求推导控制方程的弱形式，分析所得矩阵系统的结构，并在特定自由度排序下精确计算矩阵的半带宽。我们将通过依次完成每个指定任务来解决该问题。\n\n### 问题验证\n\n问题陈述已经过评估，并被确定为**有效**。它在科学上基于麦克斯韦方程组和计算电磁学，问题提法良好，目标清晰且可实现，并且自洽，包含了计算所需的所有必要数据。网格、单元类型、边界条件和自由度排序都得到了明确的规定，确保了半带宽存在唯一解。未发现逻辑矛盾、事实错误或不科学的前提。因此，我们可以进行完整求解。\n\n### 第1部分：弱形式的推导\n\n分析始于在无源、均匀介质中的时谐麦克斯韦方程组，其磁导率为 $\\mu$，介电常数为 $\\varepsilon$：\n$$ \\nabla \\times \\mathbf{E} = -j\\omega \\mathbf{B} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega \\mathbf{D} $$\n利用本构关系 $\\mathbf{B} = \\mu\\mathbf{H}$ 和 $\\mathbf{D} = \\varepsilon\\mathbf{E}$，我们可以消去磁场 $\\mathbf{H}$。由第一个方程可得 $\\mathbf{H} = \\frac{1}{-j\\omega\\mu}\\nabla \\times \\mathbf{E}$。将其代入第二个方程，得到：\n$$ \\nabla \\times \\left( \\frac{1}{-j\\omega\\mu} \\nabla \\times \\mathbf{E} \\right) = j\\omega\\varepsilon\\mathbf{E} $$\n整理各项，我们得到电场 $\\mathbf{E}$ 的矢量波动方程：\n$$ \\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) - \\omega^2\\varepsilon\\mathbf{E} = \\mathbf{0} $$\n这是控制方程的强形式。问题指定了一个二维区域 $\\Omega$，其边界为理想电导体 (PEC)。使用 Nédélec 边元对 $\\mathbf{E}$ 进行离散化，意味着电场矢量位于该区域的平面内，即 $\\mathbf{E} = E_x(x,y)\\hat{\\mathbf{x}} + E_y(x,y)\\hat{\\mathbf{y}}$。PEC 边界条件要求电场的切向分量在边界 $\\partial\\Omega$ 上为零：\n$$ \\mathbf{E} \\times \\hat{\\mathbf{n}} = \\mathbf{0} \\quad \\text{on } \\partial\\Omega $$\n这里，$\\hat{\\mathbf{n}}$ 是边界的单位外法向矢量。\n\n为了推导弱形式，我们采用加权余量法。我们将矢量波动方程乘以一个矢量测试函数 $\\mathbf{F}$，并在区域 $\\Omega$ 上积分：\n$$ \\int_{\\Omega} \\mathbf{F} \\cdot \\left( \\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) - \\omega^2\\varepsilon\\mathbf{E} \\right) dA = 0 $$\n$\\mathbf{E}$ 和 $\\mathbf{F}$ 的合适函数空间是 $H(\\mathbf{curl}, \\Omega) = \\{ \\mathbf{u} \\in (L^2(\\Omega))^2 : \\nabla \\times \\mathbf{u} \\in L^2(\\Omega) \\}$。测试函数 $\\mathbf{F}$ 选自空间 $H_0(\\mathbf{curl}, \\Omega)$，该空间包含了齐次边界条件 $\\mathbf{F} \\times \\hat{\\mathbf{n}} = \\mathbf{0}$ on $\\partial\\Omega$。\n\n我们对第一项应用一个矢量微积分恒等式（分部积分）：\n$$ \\int_{\\Omega} \\mathbf{F} \\cdot (\\nabla \\times \\mathbf{G}) \\, dA = \\int_{\\Omega} (\\nabla \\times \\mathbf{F}) \\cdot \\mathbf{G} \\, dA - \\oint_{\\partial\\Omega} (\\mathbf{F} \\times \\mathbf{G}) \\cdot \\hat{\\mathbf{n}} \\, dL $$\n令 $\\mathbf{G} = \\mu^{-1}\\nabla \\times \\mathbf{E}$，积分变为：\n$$ \\int_{\\Omega} (\\nabla \\times \\mathbf{F}) \\cdot (\\mu^{-1} \\nabla \\times \\mathbf{E}) \\, dA - \\int_{\\Omega} \\omega^2\\varepsilon \\mathbf{F} \\cdot \\mathbf{E} \\, dA - \\oint_{\\partial\\Omega} (\\mathbf{F} \\times (\\mu^{-1}\\nabla \\times \\mathbf{E})) \\cdot \\hat{\\mathbf{n}} \\, dL = 0 $$\n由于测试函数 $\\mathbf{F}$ 属于 $H_0(\\mathbf{curl}, \\Omega)$，其沿边界的切向分量为零，即 $\\mathbf{F} \\times \\hat{\\mathbf{n}} = \\mathbf{0}$ on $\\partial\\Omega$。边界积分项因涉及 $\\mathbf{F}$ 的切向分量而消失。\n\n得到的弱形式为：寻找 $(\\omega, \\mathbf{E}) \\in \\mathbb{R} \\times H_0(\\mathbf{curl}, \\Omega)$ 且 $\\mathbf{E} \\ne \\mathbf{0}$，使得对于所有 $\\mathbf{F} \\in H_0(\\mathbf{curl}, \\Omega)$：\n$$ \\int_{\\Omega} \\mu^{-1} (\\nabla \\times \\mathbf{F}) \\cdot (\\nabla \\times \\mathbf{E}) \\, dA - \\omega^2\\varepsilon \\int_{\\Omega} \\mathbf{F} \\cdot \\mathbf{E} \\, dA = 0 $$\n这是一个广义特征值问题。两个双线性形式是：\n1.  **旋度-旋度 (刚度) 形式**：$a(\\mathbf{E}, \\mathbf{F}) = \\int_{\\Omega} \\mu^{-1} (\\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{F}) \\, dA$\n2.  **质量形式**：$m(\\mathbf{E}, \\mathbf{F}) = \\int_{\\Omega} \\varepsilon \\mathbf{E} \\cdot \\mathbf{F} \\, dA$\n\n### 第2部分：局部单元矩阵的结构\n\n在 FEM 框架中，电场被近似为基函数的线性组合，$\\mathbf{E}_h = \\sum_{j} E_j \\mathbf{N}_j$，其中 $\\mathbf{N}_j$ 是与网格边相关联的一阶 Nédélec 矢量基函数。将此展开式代入弱形式，并对每个基函数 $i$ 选择 $\\mathbf{F} = \\mathbf{N}_i$，得到矩阵特征值问题 $S \\mathbf{e} = \\omega^2 M \\mathbf{e}$。矩阵 $S$ 和 $M$ 是由三角剖分中每个单元 $K$ 的贡献组装而成的。\n\n对于单个三角形单元 $K$，局部刚度矩阵 $S^K$ 和局部质量矩阵 $M^K$ 的元素由该单元上的双线性形式积分给出，使用与三角形三条边相关联的局部基函数 $\\mathbf{N}_i^K$ 和 $\\mathbf{N}_j^K$。\n这个 $3 \\times 3$ 局部矩阵的元素为：\n-   **局部刚度矩阵元素 ($S^K_{ij}$)**：这源自旋度-旋度形式。对于二维情况，平面内矢量场的旋度是一个沿 $z$ 方向的标量场。\n    $$ S^K_{ij} = \\int_K \\mu^{-1} (\\nabla \\times \\mathbf{N}_i^K) (\\nabla \\times \\mathbf{N}_j^K) \\, dA $$\n-   **局部质量矩阵元素 ($M^K_{ij}$)**：这源自质量形式。\n    $$ M^K_{ij} = \\int_K \\varepsilon (\\mathbf{N}_i^K \\cdot \\mathbf{N}_j^K) \\, dA $$\n这些表达式按照要求，直接用物理单元 $K$ 上的基函数定义了局部矩阵。\n\n### 第3部分：全局稀疏模式\n\n全局刚度矩阵和质量矩阵 $S$ 和 $M$ 是通过对所有单元矩阵 $S^K$ 和 $M^K$ 的贡献求和组装而成的。全局系统矩阵（$S$ 或 $M$）的元素 $A_{ij}$ 非零，当且仅当自由度 (DOF) $i$ 和 $j$ 是耦合的。在此背景下，自由度与网格边相关联。\n\n-   **施加边界约束之前**：两个自由度，对应于边 $e_i$ 和 $e_j$，是耦合的，当且仅当存在至少一个三角形单元 $K$ 同时包含 $e_i$ 和 $e_j$ 作为其边。矩阵大小为 $N_{dof} \\times N_{dof}$，其中 $N_{dof}$ 是网格中的总边数。对于给定的网格，共有 16 条边，因此矩阵为 $16 \\times 16$。其稀疏模式是对称的，并反映了网格的连通性。\n\n-   **施加边界约束之后**：PEC 边界条件 $\\mathbf{E} \\times \\hat{\\mathbf{n}} = \\mathbf{0}$ 被强施加。这意味着与边界 $\\partial\\Omega$ 上所有边对应的自由度被设置为零。这等效于从全局系统矩阵中移除与这些边界边相关联的行和列。得到的线性系统仅涉及内部自由度。简化后的矩阵大小为 $N_{int} \\times N_{int}$，其中 $N_{int}$ 是内部边的数量。这个较小矩阵的稀疏模式由内部边的连通性决定。如果内部边 $e_i$ 和 $e_j$ 属于同一个三角形，则存在一个非零元素 $(i,j)$。\n\n### 第4部分：半带宽计算\n\n最后的任务是在特定的自由度排序下，计算（施加边界条件后）简化系统矩阵的半带宽 $b = \\max\\{ j - i \\,:\\, a_{ij} \\neq 0,\\, j \\geq i\\}$。\n\n**第1步：识别内部自由度并排序**\n首先，我们列出 8 条内部边及其中心点：\n-   水平 (H)：$(0.25, 0.5)$、$(0.75, 0.5)$\n-   垂直 (V)：$(0.5, 0.25)$、$(0.5, 0.75)$\n-   对角线 (D)：$(0.25, 0.25)$、$(0.75, 0.25)$、$(0.25, 0.75)$、$(0.75, 0.75)$\n\n接下来，我们应用指定的排序规则：按中点 $y$ 坐标升序排序，然后按中点 $x$ 坐标升序排序，最后按类型（H、V、D）排序。这产生了重新编号的内部自由度：\n\n| 新索引 ($i'$) | 中点 $(x,y)$ | 类型 | 边描述 |\n|:---:|:---:|:---:|:---|\n| 1 | $(0.25, 0.25)$ | D | 正方形 $[0,0.5]\\times[0,0.5]$ 内的对角线 |\n| 2 | $(0.5, 0.25)$ | V | 线 $x=0.5$ 上的垂直边，下半部分 |\n| 3 | $(0.75, 0.25)$ | D | 正方形 $[0.5,1]\\times[0,0.5]$ 内的对角线 |\n| 4 | $(0.25, 0.5)$ | H | 线 $y=0.5$ 上的水平边，左半部分 |\n| 5 | $(0.75, 0.5)$ | H | 线 $y=0.5$ 上的水平边，右半部分 |\n| 6 | $(0.25, 0.75)$ | D | 正方形 $[0,0.5]\\times[0.5,1]$ 内的对角线 |\n| 7 | $(0.5, 0.75)$ | V | 线 $x=0.5$ 上的垂直边，上半部分 |\n| 8 | $(0.75, 0.75)$ | D | 正方形 $[0.5,1]\\times[0.5,1]$ 内的对角线 |\n\n**第2步：确定内部自由度之间的耦合关系**\n我们确定哪些内部边对属于同一个三角形。该网格由 8 个三角形组成。我们分析每个三角形的边。边由其新索引表示。\n\n-   **T1**：顶点为 $(0,0), (0.5,0), (0.5,0.5)$。其内部边为左下角正方形的对角线（索引 1）和位于 $x=0.5$ 上的下部垂直边（索引 2）。耦合：$\\{1, 2\\}$。\n-   **T2**：顶点为 $(0,0), (0,0.5), (0.5,0.5)$。其内部边为对角线（索引 1）和位于 $y=0.5$ 上的左侧水平边（索引 4）。耦合：$\\{1, 4\\}$。\n-   **T3**：顶点为 $(0.5,0), (1,0), (1,0.5)$。其唯一的内部边是右下角正方形的对角线（索引 3）。没有内部边对。\n-   **T4**：顶点为 $(0.5,0), (0.5,0.5), (1,0.5)$。其内部边为位于 $x=0.5$ 上的下部垂直边（索引 2）、对角线（索引 3）和位于 $y=0.5$ 上的右侧水平边（索引 5）。耦合：$\\{2, 3, 5\\}$。\n-   **T5**：顶点为 $(0,0.5), (0.5,0.5), (0.5,1)$。其内部边为位于 $y=0.5$ 上的左侧水平边（索引 4）、左上角正方形的对角线（索引 6）和位于 $x=0.5$ 上的上部垂直边（索引 7）。耦合：$\\{4, 6, 7\\}$。\n-   **T6**：顶点为 $(0,0.5), (0,1), (0.5,1)$。其唯一的内部边是对角线（索引 6）。没有内部边对。\n-   **T7**：顶点为 $(0.5,0.5), (1,0.5), (1,1)$。其内部边为位于 $y=0.5$ 上的右侧水平边（索引 5）和右上角正方形的对角线（索引 8）。耦合：$\\{5, 8\\}$。\n-   **T8**：顶点为 $(0.5,0.5), (0.5,1), (1,1)$。其内部边为位于 $x=0.5$ 上的上部垂直边（索引 7）和对角线（索引 8）。耦合：$\\{7, 8\\}$。\n\n**第3步：计算半带宽**\n半带宽为 $b = \\max \\{j' - i'\\}$，其中 $(i', j')$ 是所有满足 $j'>i'$ 的耦合对。我们检查每个耦合组产生的最大差值：\n-   来自 T1，耦合 $\\{1, 2\\}$：$2 - 1 = 1$。\n-   来自 T2，耦合 $\\{1, 4\\}$：$4 - 1 = 3$。\n-   来自 T4，耦合 $\\{2, 3, 5\\}$：$\\max(3-2, 5-2, 5-3) = \\max(1, 3, 2) = 3$。\n-   来自 T5，耦合 $\\{4, 6, 7\\}$：$\\max(6-4, 7-4, 7-6) = \\max(2, 3, 1) = 3$。\n-   来自 T7，耦合 $\\{5, 8\\}$：$8 - 5 = 3$。\n-   来自 T8，耦合 $\\{7, 8\\}$：$8 - 7 = 1$。\n\n所有差值 $j'-i'$ 的集合是 $\\{1, 3\\}$。在所有耦合中观察到的最大差值为 $3$。\n\n因此，在施加边界约束并重新编号后，全局矩阵的半带宽为 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "稀疏直接求解器（如基于 Cholesky 分解的求解器）的效率不仅取决于原始矩阵中的非零元数量，还取决于在消元过程中产生的“填充”（fill-in）。这个过程可以通过一个强大的图论工具——消元树——来理解和预测。本实践问题旨在揭示这一核心概念，要求您为一个小型有限元矩阵构建邻接图，并推导出相应的消元树，从而清晰地展示求解器符号分解阶段的内部工作原理。",
            "id": "3299957",
            "problem": "在频域计算电磁学中，考虑一个均匀各向同性导体，其标量势公式由应用于电标量势 $u$ 的椭圆算子描述，并使用基于四面体网格的一阶 Lagrange 有限元法（FEM）进行离散化。全局刚度矩阵 $K$ 的矩阵元为\n$$\nK_{ij} \\;=\\; \\sum_{e} \\int_{\\Omega_e} \\sigma \\,\\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dV \\;+\\; \\alpha \\int_{\\Omega} \\phi_i \\phi_j \\, dV,\n$$\n其中 $\\sigma>0$ 是电导率，$\\alpha>0$ 是确保对称正定性的正则化参数，$\\phi_i$ 是节点基函数，求和遍及所有四面体单元 $\\Omega_e$。两个节点 $i$ 和 $j$ 耦合当且仅当它们的支集在至少一个公共四面体上重叠。因此，稀疏矩阵 $K$ 的邻接图完全由网格连接性确定。\n\n考虑一个网格，其节点坐标如下：\n- 节点 $1$：$(0,0,0)$，\n- 节点 $2$：$(1,0,0)$，\n- 节点 $3$：$(0,1,0)$，\n- 节点 $4$：$(0,0,1)$，\n- 节点 $5$：$(1,1,1)$，\n以及两个四面体\n- $T_1 = (1,2,3,4)$，\n- $T_2 = (1,2,3,5)$，\n它们共享面 $(1,2,3)$。\n\n假设所有 $5$ 个节点都是自由度（未施加本质边界条件），并使用未知量的自然序 $1 \\prec 2 \\prec 3 \\prec 4 \\prec 5$。构建 $K$ 的无向邻接图（节点代表未知量，边代表非零的非对角耦合），然后考虑通过 Cholesky 分解进行对称分解，并导出由此自然序生成的相应消去树。消去树的定义如下：节点 $j$ 的父节点是 Cholesky 因子第 $j$ 列对角线下方的第一个非零元的索引，等价于在通过该排序进行高斯消去所产生的填充图中，与 $j$ 相邻的最小索引 $i>j$。\n\n计算消去树的高度，其定义为最长根到叶路径上的节点数。请将您的最终答案表示为一个不带单位的整数。",
            "solution": "用户要求我找出由有限元法（FEM）离散化产生的稀疏矩阵的消去树的高度。\n\n### 第1步：问题验证\n\n该问题经过严格的验证过程。\n\n**1.1. 提取已知条件**\n- **公式**：均匀各向同性导体的标量势 $u$ 上的椭圆算子。\n- **离散化**：四面体网格上的一阶Lagrange有限元法。\n- **刚度矩阵 ($K$) 矩阵元**：$K_{ij} = \\sum_{e} \\int_{\\Omega_e} \\sigma \\,\\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dV \\;+\\; \\alpha \\int_{\\Omega} \\phi_i \\phi_j \\, dV$，其中电导率 $\\sigma>0$，正则化参数 $\\alpha>0$。\n- **稀疏性规则**：两个节点 $i$ 和 $j$ 耦合（即，当 $i \\neq j$ 时，$K_{ij} \\neq 0$）当且仅当它们属于同一个四面体。$K$ 的邻接图由网格连接性确定。\n- **网格节点**：\n    - 节点 $1$：$(0,0,0)$\n    - 节点 $2$：$(1,0,0)$\n    - 节点 $3$：$(0,1,0)$\n    - 节点 $4$：$(0,0,1)$\n    - 节点 $5$：$(1,1,1)$\n- **网格单元（四面体）**：\n    - $T_1 = (1,2,3,4)$\n    - $T_2 = (1,2,3,5)$\n- **自由度**：所有5个节点都是自由度。\n- **排序**：自然序 $1 \\prec 2 \\prec 3 \\prec 4 \\prec 5$。\n- **任务**：构建 $K$ 的邻接图，导出给定排序下 Cholesky 分解的消去树，并计算该树的高度。\n- **消去树定义**：节点 $j$ 的父节点是 `parent(j)` $= \\min\\{i > j \\text{ | } (i,j) \\text{ 是填充图中的一条边}\\}$。\n- **高度定义**：树的高度是最长根到叶路径上的节点数。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据**：该问题在计算电磁学和数值线性代数领域有坚实的理论基础。它描述了一个标准的有限元法公式以及相关的稀疏矩阵分析，使用了诸如Cholesky分解、填充图和消去树等概念。这些都是该领域的基础课题。\n- **适定性**：该问题是适定的。对网格的描述、矩阵稀疏性规则、节点排序以及消去树及其高度的定义都精确且自洽，能够导出一个唯一解。\n- **客观性**：该问题以客观、正式的语言陈述，没有任何主观或模糊的术语。\n\n**1.3. 结论与行动**\n该问题在科学上是合理的、适定的和客观的。它不包含任何使其无效的缺陷。因此，它被判定为**有效**。我将继续构建解决方案。\n\n### 第2步：求解\n\n解决方案需要四个步骤：(1) 构建矩阵 $K$ 的邻接图，(2) 确定消去过程产生的填充图，(3) 推导消去树的结构，(4) 计算其高度。\n\n**2.1. 构建邻接图 $G(K)$**\n\n图的顶点集是节点集 $V = \\{1, 2, 3, 4, 5\\}$。图中存在一条边 $(i, j)$ 当且仅当节点 $i$ 和 $j$ 属于同一个四面体。\n\n- **四面体 $T_1 = \\{1, 2, 3, 4\\}$**：该单元内的节点形成一个团。这贡献了边 $(1,2)$、$(1,3)$、$(1,4)$、$(2,3)$、$(2,4)$ 和 $(3,4)$。\n- **四面体 $T_2 = \\{1, 2, 3, 5\\}$**：该单元内的节点也形成一个团。这贡献了边 $(1,2)$、$(1,3)$、$(1,5)$、$(2,3)$、$(2,5)$ 和 $(3,5)$。\n\n邻接图 $G(K)$ 由所有单元的所有边的并集构成。\n每个节点的邻接表如下：\n- 节点 $1$ 的邻接点：在 $T_1$ 中的邻居是 $\\{2,3,4\\}$。在 $T_2$ 中的邻居是 $\\{2,3,5\\}$。并集是 $\\text{Adj}(1) = \\{2,3,4,5\\}$。\n- 节点 $2$ 的邻接点：在 $T_1$ 中的邻居是 $\\{1,3,4\\}$。在 $T_2$ 中的邻居是 $\\{1,3,5\\}$。并集是 $\\text{Adj}(2) = \\{1,3,4,5\\}$。\n- 节点 $3$ 的邻接点：在 $T_1$ 中的邻居是 $\\{1,2,4\\}$。在 $T_2$ 中的邻居是 $\\{1,2,5\\}$。并集是 $\\text{Adj}(3) = \\{1,2,4,5\\}$。\n- 节点 $4$ 的邻接点：该节点仅在 $T_1$ 中。其邻居是 $\\text{Adj}(4) = \\{1,2,3\\}$。\n- 节点 $5$ 的邻接点：该节点仅在 $T_2$ 中。其邻居是 $\\text{Adj}(5) = \\{1,2,3\\}$。\n\n关键的是，节点 $4$ 和 $5$ 不共享一个四面体，因此边 $(4,5)$ 不存在于原始图 $G(K)$ 中。\n\n**2.2. 确定填充图 $G^+$**\n\n填充图 $G^+$ 是在符号高斯消去过程中通过添加“填充”边得到的。如果 $K_{ij}=0$ 但 Cholesky 因子 $L_{ij}$ 中的对应项非零，则边 $(i,j)$ 是一个填充边。该过程通过按指定顺序 $k = 1, 2, 3, 4$ 消去节点来模拟。当一个节点 $k$ 被消去时，它在当前图中的邻居会形成一个团。\n\n- **消去节点 $k=1$**：在 $G(K)$ 中，节点 $1$ 的邻居是 $\\{2,3,4,5\\}$。为了使这些节点形成一个团，每对节点之间都必须有一条边连接。这些节点对是 $(2,3), (2,4), (2,5), (3,4), (3,5), (4,5)$。我们检查这些边中有哪些在 $G(K)$ 中缺失。\n  - $(2,3)$: 存在（在 $T_1, T_2$ 中）。\n  - $(2,4)$: 存在（在 $T_1$ 中）。\n  - $(2,5)$: 存在（在 $T_2$ 中）。\n  - $(3,4)$: 存在（在 $T_1$ 中）。\n  - $(3,5)$: 存在（在 $T_2$ 中）。\n  - $(4,5)$: **不存在**。\n  因此，消去节点 $1$ 会产生一条填充边：$(4,5)$。剩余节点 $\\{2,3,4,5\\}$ 上的图变成一个完全图（一个团 $K_4$）。\n\n- **消去节点 $k=2$**：在修改后的图中，节点 $2$ 的索引更高的邻居是 $\\{3,4,5\\}$。这三个节点已经形成一个团，因为 $\\{2,3,4,5\\}$ 上的子图现在是完全的。因此，消去节点 $2$ 不会产生新的填充。\n\n- **消去节点 $k=3$ 和 $k=4$**：类似地，消去节点 $3$（邻居为 $\\{4,5\\}$）和节点 $4$（邻居为 $\\{5\\}$）不会产生任何进一步的填充。\n\n填充图 $G^+$ 是原始图 $G(K)$ 加上单条填充边 $(4,5)$。$E(G^+) = E(G(K)) \\cup \\{(4,5)\\}$。这意味着在填充图中，每对节点都是相连的。$G^+$ 是顶点集 $V=\\{1,2,3,4,5\\}$ 上的完全图 $K_5$。\n\n**2.3. 推导消去树 $T$**\n\n消去树由父子关系定义，其中节点 $j$ 的父节点由以下公式给出：\n$$ \\text{parent}(j) = \\min \\{i \\mid i > j \\text{ and } (i,j) \\text{ is an edge in } G^+\\} $$\n我们对 $j = 1, 2, 3, 4$ 应用此规则。节点 $5$ 是编号最大的节点，将成为树的根。\n\n- **`parent(1)`**：在 $G^+$ 中，节点 $1$ 的邻居是 $\\{2,3,4,5\\}$。所有这些索引都大于 $1$。它们中的最小值是 $2$。\n  $\\text{parent}(1) = \\min\\{2,3,4,5\\} = 2$。\n\n- **`parent(2)`**：在 $G^+$ 中，节点 $2$ 的邻居是 $\\{1,3,4,5\\}$。索引大于 $2$ 的邻居是 $\\{3,4,5\\}$。它们中的最小值是 $3$。\n  $\\text{parent}(2) = \\min\\{3,4,5\\} = 3$。\n\n- **`parent(3)`**：在 $G^+$ 中，节点 $3$ 的邻居是 $\\{1,2,4,5\\}$。索引大于 $3$ 的邻居是 $\\{4,5\\}$。它们中的最小值是 $4$。\n  $\\text{parent}(3) = \\min\\{4,5\\} = 4$。\n\n- **`parent(4)`**：在 $G^+$ 中，节点 $4$ 的邻居是 $\\{1,2,3,5\\}$。唯一索引大于 $4$ 的邻居是 $\\{5\\}$。最小值是 $5$。\n  $\\text{parent}(4) = \\min\\{5\\} = 5$。\n\n最终的消去树结构是一条简单路径：$1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5$，其中 $5$ 是根。\n\n**2.4. 计算消去树的高度**\n\n问题将高度定义为“最长根到叶路径上的节点数”。\n在推导出的树中，只有一条根到叶路径。\n- 根：节点 $5$。\n- 叶：节点 $1$。\n- 路径：$5 \\rightsquigarrow 4 \\rightsquigarrow 3 \\rightsquigarrow 2 \\rightsquigarrow 1$。\n此路径上的节点为 $\\{5, 4, 3, 2, 1\\}$。\n此路径上的节点数为 $5$。\n\n因此，消去树的高度为 $5$。",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "在大型计算电磁学问题中，纯粹的直接求解器或纯粹的迭代求解器都不是万能的；最有效的策略往往是混合方法。这项高级练习将您置于算法设计者的角色，要求您优化一种结合了直接求解器（用于内部区域）和迭代求解器（用于界面）的区域分解方法。通过建立并最小化一个切合实际的性能模型，您将探索分解成本与迭代收敛之间的基本权衡，这是开发前沿仿真工具的一项关键技能。",
            "id": "3299924",
            "problem": "给定一种混合方法，用于求解计算电磁学中由时谐麦克斯韦方程组产生的有限元法系统：直接消去内部自由度，并在界面系统上使用广义最小残差（GMRES）方法进行迭代。目标是选择内部自由度与界面自由度之间的划分，以最小化总计算时间。请构建一个程序，对于每个提供的测试用例，确定最优的界面自由度数量 $m$（一个整数），该数量可以最小化一个基于原理的总时间模型。\n\n出发点是时谐麦克斯韦旋度-旋度方程，对于电场 $E$ 可写作：\n$$\n\\nabla \\times \\left( \\mu^{-1} \\nabla \\times E \\right) - \\omega^2 \\epsilon E = J,\n$$\n其中 $\\mu$ 是磁导率，$\\epsilon$ 是电容率，$\\omega$ 是角频率（以弧度/秒表示），$J$ 是给定的电流密度。使用边（Nédelec）元进行离散化后，得到的线性系统具有以下分块形式：\n$$\n\\begin{bmatrix}\nA_{ii}  A_{ib} \\\\\nA_{bi}  A_{bb}\n\\end{bmatrix}\n\\begin{bmatrix}\nx_i \\\\\nx_b\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nb_i \\\\\nb_b\n\\end{bmatrix},\n$$\n其中 $x_i \\in \\mathbb{R}^{n}$ 是内部未知数，$x_b \\in \\mathbb{R}^{m}$ 是界面/边界未知数，且 $n + m = N$，其中 $N$ 是总自由度数。该混合求解器首先通过直接分解 $A_{ii}$ 来消去 $x_i$，然后构造舒尔补界面系统：\n$$\nS x_b = b_b - A_{bi} A_{ii}^{-1} b_i, \\quad S = A_{bb} - A_{bi} A_{ii}^{-1} A_{ib},\n$$\n该系统使用广义最小残差（GMRES）方法进行迭代求解，GMRES 是首次提及时给出的简称。\n\n为确保科学上的真实性和自洽性，总时间必须根据经过充分测试的稀疏直接求解器和Krylov方法的标度律进行建模，并由空间维度 $d \\in \\{2,3\\}$ 参数化。请使用以下原则：\n\n- 在 $d$ 维空间中，用于稀疏直接分解的嵌套剖分法具有超线性的填充/操作增长；将分解时间建模为关于 $n = N - m$ 的幂律。在 $d = 2$ 时，经验指数约为 $p_2 = 1.5$；在 $d = 3$ 时，约为 $p_3 = 2.0$。使用给定的系数 $\\alpha_d$ 来以秒为单位缩放分解时间。\n- 分解后，每个右端项的三角求解时间随 $n$ 按幂律变化。在 $d = 2$ 时，使用指数 $q_2 = 1.2$；在 $d = 3$ 时，使用指数 $q_3 = 1.33$。使用给定的系数 $\\beta_d$ 来以秒为单位缩放时间。应用舒尔补每次迭代需要两次三角求解。\n- 在应用舒尔补时，界面矩阵向量积与 $m$ 呈线性关系；使用系数 $c_M$，单位为秒/（界面自由度·迭代）。\n- GMRES的Arnoldi正交化开销与界面自由度数量和迭代次数均呈线性关系；使用系数 $c_O$，单位为秒/（界面自由度·迭代）。\n- 未预处理的GMRES迭代次数随界面算子条件数的一个代理量增长；使用参数 $c_k$、$\\kappa_0$、$\\kappa_1$ 和 $\\eta$ 以及收敛容差 $\\varepsilon$，通过一个与维度相关的增长定律来对此进行建模：\n  $$\n  k(m) = \\left\\lceil c_k \\, \\left( \\kappa_0 + \\kappa_1 \\, m^{\\beta(d)} \\right)^{\\eta} \\, \\log\\!\\left( \\frac{1}{\\varepsilon} \\right) \\right\\rceil,\n  $$\n  其中 $\\beta(2) = 0.5$ 且 $\\beta(3) = \\frac{1}{3}$。\n  \n您的程序必须通过组合分解时间、每次迭代时间乘以迭代次数，以及GMRES的开销时间，来计算给定 $m$ 的总模型时间（以秒为单位）。您必须在指定的整数网格 $m \\in \\{ m_{\\min}, m_{\\min} + \\Delta m, \\dots, m_{\\max} \\}$（其中 $m_{\\max}  N$ 且 $m_{\\min} \\ge 1$）上搜索 $m$，并返回使总模型时间最小化的 $m$。如果存在多个使时间最小化的 $m$，则返回其中最小的 $m$。\n\n对于每个测试用例，您将获得以下参数：\n- $N$: 总自由度（整数），\n- $d$: 空间维度（整数，2或3），\n- $\\varepsilon$: GMRES容差（浮点数，无单位），\n- $\\alpha_d$: 分解系数（浮点数，单位为秒），\n- $\\beta_d$: 三角求解系数（浮点数，单位为秒），\n- $c_M$: 舒尔补应用系数（浮点数，单位为秒/（界面自由度·迭代）），\n- $c_O$: GMRES正交化开销（浮点数，单位为秒/（界面自由度·迭代）），\n- $c_k$: 迭代次数缩放系数（浮点数，无单位），\n- $\\kappa_0$: 基本条件数参数（浮点数，无单位），\n- $\\kappa_1$: 条件数增长参数（浮点数，无单位），\n- $\\eta$: 迭代增长指数（浮点数，无单位），\n- $m_{\\min}$: 最小界面自由度（整数），\n- $m_{\\max}$: 最大界面自由度（整数），\n- $\\Delta m$: $m$的步长（整数）。\n\n您的程序将使用的测试套件是：\n- 测试用例 $1$：$N = 8000$，$d = 2$，$\\varepsilon = 10^{-8}$，$\\alpha_2 = 3 \\times 10^{-9}$ 秒，$\\beta_2 = 1.2 \\times 10^{-9}$ 秒，$c_M = 7 \\times 10^{-10}$ 秒，$c_O = 4 \\times 10^{-10}$ 秒，$c_k = 0.9$，$\\kappa_0 = 8$，$\\kappa_1 = 1.5 \\times 10^{-2}$，$\\eta = 0.5$，$m_{\\min} = 200$，$m_{\\max} = 4000$，$\\Delta m = 100$。\n- 测试用例 $2$：$N = 3000$，$d = 2$，$\\varepsilon = 10^{-6}$，$\\alpha_2 = 8 \\times 10^{-9}$ 秒，$\\beta_2 = 2 \\times 10^{-9}$ 秒，$c_M = 10^{-9}$ 秒，$c_O = 6 \\times 10^{-10}$ 秒，$c_k = 1.1$，$\\kappa_0 = 5$，$\\kappa_1 = 3 \\times 10^{-2}$，$\\eta = 0.5$，$m_{\\min} = 50$，$m_{\\max} = 2900$，$\\Delta m = 50$。\n- 测试用例 $3$：$N = 12000$，$d = 3$，$\\varepsilon = 10^{-7}$，$\\alpha_3 = 3 \\times 10^{-9}$ 秒，$\\beta_3 = 9 \\times 10^{-10}$ 秒，$c_M = 2 \\times 10^{-9}$ 秒，$c_O = 10^{-9}$ 秒，$c_k = 0.8$，$\\kappa_0 = 12$，$\\kappa_1 = 10^{-2}$，$\\eta = 0.6$，$m_{\\min} = 300$，$m_{\\max} = 8000$，$\\Delta m = 200$。\n- 测试用例 $4$：$N = 500$，$d = 2$，$\\varepsilon = 10^{-5}$，$\\alpha_2 = 10^{-8}$ 秒，$\\beta_2 = 5 \\times 10^{-9}$ 秒，$c_M = 10^{-8}$ 秒，$c_O = 10^{-8}$ 秒，$c_k = 0.5$，$\\kappa_0 = 1$，$\\kappa_1 = 0$，$\\eta = 0.5$，$m_{\\min} = 50$，$m_{\\max} = 450$，$\\Delta m = 50$。\n\n您的程序应生成单行输出，其中包含上述测试套件的最优界面大小，格式为用方括号括起来的逗号分隔列表，例如：\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]\n$$\n其中每个 $\\text{result}_i$ 是测试用例 $i$ 所选的整数 $m$。唯一具有物理单位的量是时间，必须以秒为单位处理；不要报告时间，只报告最优的 $m$ 值。角度（如有）必须以弧度为单位，但本问题中没有出现角度。将每个最终结果表示为无单位的整数。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于计算电磁学和数值线性代数的既定原则，提供了一个包含所有必要参数和客观、正式结构的良态优化问题。其中没有矛盾、歧义或事实性错误。\n\n解决此问题需要为所述的混合直接-迭代求解器构建一个计算成本模型，然后找到使该成本最小化的参数。目标是从一个指定的离散集合中确定最优的界面自由度数量 $m$，以最小化总计算时间 $T_{total}(m)$。\n\n总时间被建模为两个主要部分之和：内部问题直接分解的一次性成本，以及界面问题迭代求解的总成本。\n$$\nT_{total}(m) = T_{fact}(m) + T_{iterative}(m)\n$$\n\n设 $N$ 为总自由度数。内部自由度的数量为 $n = N - m$。成本由空间维度 $d$ 参数化，其中 $d$ 可以是 $d=2$ 或 $d=3$。\n\n第一个组成部分是分解时间 $T_{fact}(m)$，它模拟了对 $n \\times n$ 矩阵 $A_{ii}$ 进行稀疏直接分解的成本。该成本由一个幂律给出：\n$$\nT_{fact}(m) = \\alpha_d (N-m)^{p_d}\n$$\n这里，$\\alpha_d$ 是一个给定的以秒为单位的缩放系数。指数 $p_d$ 取决于维度 $d$：对于 $d=2$，$p_2=1.5$，对于 $d=3$，$p_3=2.0$。这捕捉了使用像嵌套剖分这类方法进行稀疏矩阵分解的超线性复杂度。\n\n第二个组成部分是迭代求解器的总时间 $T_{iterative}(m)$。它等于迭代次数 $k(m)$ 与每次迭代的计算成本 $T_{per\\_iter}(m)$ 的乘积。\n$$\nT_{iterative}(m) = k(m) \\cdot T_{per\\_iter}(m)\n$$\n\nGMRES的迭代次数 $k(m)$ 通过一个经验公式建模，该公式考虑了舒尔补矩阵 $S$ 的条件。该公式为：\n$$\nk(m) = \\left\\lceil c_k \\left( \\kappa_0 + \\kappa_1 m^{\\beta(d)} \\right)^{\\eta} \\log\\left( \\frac{1}{\\varepsilon} \\right) \\right\\rceil\n$$\n其中：\n- $\\varepsilon$ 是GMRES的收敛容差。$\\log(1/\\varepsilon)$ 项是Krylov子空间方法的特征。\n- $c_k$、$\\kappa_0$、$\\kappa_1$ 和 $\\eta$ 是经验建模参数。\n- $(\\kappa_0 + \\kappa_1 m^{\\beta(d)})$ 项作为界面系统条件数的一个代理，该条件数随界面未知数 $m$ 的数量增长而增长。\n- 指数 $\\beta(d)$ 取决于维度：对于 $d=2$，$\\beta(2) = 0.5$；对于 $d=3$，$\\beta(3) = 1/3$。\n- 上取整函数 $\\lceil \\cdot \\rceil$ 确保迭代次数为整数。\n\n每次GMRES迭代的成本 $T_{per\\_iter}(m)$ 包括三个主要操作：\n1.  应用舒尔补算子 $S = A_{bb} - A_{bi} A_{ii}^{-1} A_{ib}$。这需要两个主要步骤：\n    - 将 $A_{ii}^{-1}$ 应用于一个向量。由于 $A_{ii}$ 已被分解，这通过两次三角求解（前向和后向代换）完成。此操作的时间建模为 $2 \\cdot \\beta_d (N-m)^{q_d}$，其中 $\\beta_d$ 是一个缩放系数，指数 $q_d$ 在 $d=2$ 时为 $q_2=1.2$，在 $d=3$ 时为 $q_3=1.33$。\n    - 涉及界面未知数的其余矩阵向量积被建模为与 $m$ 呈线性关系，成本为 $c_M \\cdot m$。\n2.  GMRES中的Arnoldi过程，该过程涉及向量正交化。此成本也建模为与向量大小 $m$ 呈线性关系，相关成本为 $c_O \\cdot m$。\n\n将这些贡献相加，每次迭代的成本为：\n$$\nT_{per\\_iter}(m) = 2 \\beta_d (N-m)^{q_d} + (c_M + c_O) m\n$$\n\n综合所有这些部分，得到总时间作为 $m$ 的函数的最终表达式：\n$$\nT_{total}(m) = \\alpha_d (N-m)^{p_d} + \\left\\lceil c_k \\left( \\kappa_0 + \\kappa_1 m^{\\beta(d)} \\right)^{\\eta} \\log\\left(\\frac{1}{\\varepsilon}\\right) \\right\\rceil \\left( 2 \\beta_d (N-m)^{q_d} + (c_M + c_O) m \\right)\n$$\n\n为了找到最优的 $m$，我们必须对指定的整数网格 $m \\in \\{m_{\\min}, m_{\\min} + \\Delta m, \\dots, m_{\\max}\\}$ 中的每个值计算 $T_{total}(m)$。然后我们确定产生最小 $T_{total}(m)$ 的 $m$ 值。如果出现平局，问题规定应选择最小化者中最小的 $m$。我们的算法将按 $m$ 的递增顺序进行迭代，因此第一次找到最小值时就会被记录下来。只有当后续的 $m$ 值导致严格更小的总时间时，才会替换当前的最佳值。此过程自然满足了平局决胜规则。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimal number of interface degrees of freedom 'm'\n    that minimizes a total computational time model for a hybrid\n    direct-iterative solver in computational electromagnetics.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"N\": 8000, \"d\": 2, \"epsilon\": 1e-8, \"alpha_d\": 3e-9, \"beta_d\": 1.2e-9,\n            \"c_M\": 7e-10, \"c_O\": 4e-10, \"c_k\": 0.9, \"kappa_0\": 8, \"kappa_1\": 1.5e-2,\n            \"eta\": 0.5, \"m_min\": 200, \"m_max\": 4000, \"delta_m\": 100\n        },\n        {\n            \"N\": 3000, \"d\": 2, \"epsilon\": 1e-6, \"alpha_d\": 8e-9, \"beta_d\": 2e-9,\n            \"c_M\": 1e-9, \"c_O\": 6e-10, \"c_k\": 1.1, \"kappa_0\": 5, \"kappa_1\": 3e-2,\n            \"eta\": 0.5, \"m_min\": 50, \"m_max\": 2900, \"delta_m\": 50\n        },\n        {\n            \"N\": 12000, \"d\": 3, \"epsilon\": 1e-7, \"alpha_d\": 3e-9, \"beta_d\": 9e-10,\n            \"c_M\": 2e-9, \"c_O\": 1e-9, \"c_k\": 0.8, \"kappa_0\": 12, \"kappa_1\": 1e-2,\n            \"eta\": 0.6, \"m_min\": 300, \"m_max\": 8000, \"delta_m\": 200\n        },\n        {\n            \"N\": 500, \"d\": 2, \"epsilon\": 1e-5, \"alpha_d\": 1e-8, \"beta_d\": 5e-9,\n            \"c_M\": 1e-8, \"c_O\": 1e-8, \"c_k\": 0.5, \"kappa_0\": 1, \"kappa_1\": 0,\n            \"eta\": 0.5, \"m_min\": 50, \"m_max\": 450, \"delta_m\": 50\n        }\n    ]\n\n    results = []\n    \n    dim_params = {\n        2: {\"p_d\": 1.5, \"q_d\": 1.2, \"beta_d_exp\": 0.5},\n        3: {\"p_d\": 2.0, \"q_d\": 1.33, \"beta_d_exp\": 1.0/3.0}\n    }\n\n    for case in test_cases:\n        N = case[\"N\"]\n        d = case[\"d\"]\n        epsilon = case[\"epsilon\"]\n        alpha_d = case[\"alpha_d\"]\n        beta_d = case[\"beta_d\"]\n        c_M = case[\"c_M\"]\n        c_O = case[\"c_O\"]\n        c_k = case[\"c_k\"]\n        kappa_0 = case[\"kappa_0\"]\n        kappa_1 = case[\"kappa_1\"]\n        eta = case[\"eta\"]\n        m_min = case[\"m_min\"]\n        m_max = case[\"m_max\"]\n        delta_m = case[\"delta_m\"]\n\n        p_d = dim_params[d][\"p_d\"]\n        q_d = dim_params[d][\"q_d\"]\n        beta_d_exp = dim_params[d][\"beta_d_exp\"]\n        \n        min_total_time = float('inf')\n        optimal_m = -1\n\n        for m in range(m_min, m_max + 1, delta_m):\n            if m >= N:\n                continue\n            \n            n = N - m\n\n            # 1. Factorization Time\n            T_fact = alpha_d * np.power(n, p_d)\n            \n            # 2. Iteration Count\n            log_eps_inv = np.log(1.0 / epsilon)\n            cond_proxy = kappa_0 + kappa_1 * np.power(m, beta_d_exp)\n            k_m = np.ceil(c_k * np.power(cond_proxy, eta) * log_eps_inv)\n\n            # 3. Per-Iteration Time\n            T_solves = 2.0 * beta_d * np.power(n, q_d)\n            T_interface_ops = (c_M + c_O) * m\n            T_per_iter = T_solves + T_interface_ops\n            \n            # 4. Total Iterative Time\n            T_iterative = k_m * T_per_iter\n            \n            # 5. Total Time\n            T_total = T_fact + T_iterative\n\n            if T_total  min_total_time:\n                min_total_time = T_total\n                optimal_m = m\n\n        results.append(optimal_m)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}