{
    "hands_on_practices": [
        {
            "introduction": "计算科学的第一步是将物理模型转化为可解的代数系统，而这一过程对于理解求解器的行为至关重要。本练习旨在弥合麦克斯韦方程组与稀疏直接求解器必须处理的矩阵之间的鸿沟。通过对一个二维腔体进行离散化，并分析其生成的矩阵结构和带宽 ，您将深刻理解网格拓扑、单元选择和边界条件如何决定线性系统的最终特性。",
            "id": "3299951",
            "problem": "考虑一个二维横电 (TE) 模式的腔体，其壁为理想电导体 (PEC)，占据单位正方形域 $\\Omega = [0,1] \\times [0,1]$。在频域中，控制方程由麦克斯韦方程组导出，用于描述电场 $\\mathbf{E}$ 和磁通量密度 $\\mathbf{B}$。假设场是时谐的，角频率为 $\\omega$，磁导率 $\\mu$ 和介电常数 $\\varepsilon$ 均匀。该腔体使用一阶 Nédélec 边元（第一类）在协调的三角形剖分上进行离散化。该剖分通过将 $\\Omega$ 细分为 $m=2, n=2$ 的结构化正方形网格，并用一条从左下顶点到右上顶点的直线分割每个正方形而获得。有限元法 (FEM) 的未知量与剖分中的有向边相关联，对应于电场 $\\mathbf{E}$ 沿每条边的切向分量。PEC 边界条件强制要求 $\\mathbf{E}$ 在所有边界边上的切向分量为零。\n\n执行以下任务：\n\n- 从麦克斯韦方程组和 PEC 边界条件出发，推导适用于二维 TE 腔体问题的弱形式，并确定双线性形式。这些双线性形式的离散对应形式，根据参考三角形上的 Nédélec 基函数和到物理坐标的单元映射，逐单元地定义了旋度-旋度（刚度）矩阵和质量矩阵。\n\n- 使用推导出的弱形式，说明三角形上一阶 Nédélec 边元的局部单元矩阵的结构，用基函数旋度的积分和基函数乘积的积分表示。不要调用任何预先推导的有限元模板；相反，直接根据弱形式和边基函数的定义给出表达式。\n\n- 在施加 PEC 边界约束之前，预测组装后系统矩阵的全局稀疏模式，解释哪些自由度 (DOF) 对是耦合的以及为什么，并讨论在通过强加约束（狄利克雷消除法）消除边界自由度后，该模式如何变化。\n\n- 将给定排序下对称稀疏矩阵的半带宽 $b$ 定义为 $b = \\max\\{ j - i \\,:\\, a_{ij} \\neq 0,\\, j \\geq i\\}$，并使用此定义计算在施加边界约束前后全局矩阵的精确半带宽。采用以下明确的自由度排序规则：所有边自由度按边中点的 $y$ 坐标升序排序；若中点 $y$ 坐标相等，则按中点 $x$ 坐标升序排序；若 $(x,y)$ 坐标相等，则先排水平方向的边，再排垂直方向的边，最后排对角线方向的边。施加边界约束后，舍弃边界边，并仅对剩余的内部边应用相同的排序规则重新编号。\n\n该三角形剖分包含以下由其中点描述的边：位于 $y=0$ 处的水平边，中点为 $(0.25,0)$ 和 $(0.75,0)$；位于 $y=0.5$ 处的水平边，中点为 $(0.25,0.5)$ 和 $(0.75,0.5)$；位于 $y=1$ 处的水平边，中点为 $(0.25,1)$ 和 $(0.75,1)$；位于 $x=0$ 处的垂直边，中点为 $(0,0.25)$ 和 $(0,0.75)$；位于 $x=0.5$ 处的垂直边，中点为 $(0.5,0.25)$ 和 $(0.5,0.75)$；位于 $x=1$ 处的垂直边，中点为 $(1,0.25)$ 和 $(1,0.75)$；每个正方形内的对角线边，中点为 $(0.25,0.25)$, $(0.75,0.25)$, $(0.25,0.75)$ 和 $(0.75,0.75)$。每个正方形内的对角线方向为从左下到右上。边界边是位于 $x=0$, $x=1$, $y=0$ 或 $y=1$ 上的边；所有对角线边都是内部边。假设材料系数是均匀的，且网格是协调的。\n\n在施加边界约束并根据所述排序规则对内部边进行重新编号后，精确计算半带宽。将最终答案表示为一个整数。无需四舍五入。",
            "solution": "该问题提出了一个关于二维电磁腔体有限元法 (FEM) 分析的综合性问题。它要求推导控制方程的弱形式，分析所得矩阵系统的结构，并在特定自由度排序下精确计算矩阵的半带宽。我们将通过依次完成每个指定任务来解决这个问题。\n\n### 问题验证\n\n问题陈述已经过评估并被确定为**有效**。它在科学上基于麦克斯韦方程组和计算电磁学，问题提法良好，目标明确且可实现，并且包含了计算所需的所有必要数据。网格、单元类型、边界条件和自由度排序都得到了明确的规定，确保半带宽的唯一解存在。没有发现逻辑矛盾、事实错误或不科学的前提。因此，我们可以着手提供完整解答。\n\n### 第1部分：弱形式的推导\n\n分析始于无源、均匀介质中的时谐麦克斯韦方程组，其磁导率为 $\\mu$，介电常数为 $\\varepsilon$：\n$$ \\nabla \\times \\mathbf{E} = -j\\omega \\mathbf{B} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega \\mathbf{D} $$\n利用本构关系 $\\mathbf{B} = \\mu\\mathbf{H}$ 和 $\\mathbf{D} = \\varepsilon\\mathbf{E}$，我们可以消去磁场 $\\mathbf{H}$。由第一个方程可得 $\\mathbf{H} = \\frac{1}{-j\\omega\\mu}\\nabla \\times \\mathbf{E}$。将其代入第二个方程得到：\n$$ \\nabla \\times \\left( \\frac{1}{-j\\omega\\mu} \\nabla \\times \\mathbf{E} \\right) = j\\omega\\varepsilon\\mathbf{E} $$\n整理各项，我们得到电场 $\\mathbf{E}$ 的矢量波动方程：\n$$ \\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) - \\omega^2\\varepsilon\\mathbf{E} = \\mathbf{0} $$\n这是控制方程的强形式。问题指定了一个二维域 $\\Omega$，其边界条件为理想电导体 (PEC)。使用 Nédélec 边元对 $\\mathbf{E}$ 进行离散化，意味着电场矢量位于域平面内，即 $\\mathbf{E} = E_x(x,y)\\hat{\\mathbf{x}} + E_y(x,y)\\hat{\\mathbf{y}}$。PEC 边界条件要求电场的切向分量在边界 $\\partial\\Omega$ 上为零：\n$$ \\mathbf{E} \\times \\hat{\\mathbf{n}} = \\mathbf{0} \\quad \\text{on } \\partial\\Omega $$\n这里，$\\hat{\\mathbf{n}}$ 是边界的外向单位法向量。\n\n为推导弱形式，我们采用加权余量法。我们将矢量波动方程乘以一个矢量测试函数 $\\mathbf{F}$，并在域 $\\Omega$ 上积分：\n$$ \\int_{\\Omega} \\mathbf{F} \\cdot \\left( \\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) - \\omega^2\\varepsilon\\mathbf{E} \\right) dA = 0 $$\n适用于 $\\mathbf{E}$ 和 $\\mathbf{F}$ 的函数空间是 $H(\\mathbf{curl}, \\Omega) = \\{ \\mathbf{u} \\in (L^2(\\Omega))^2 : \\nabla \\times \\mathbf{u} \\in L^2(\\Omega) \\}$。测试函数 $\\mathbf{F}$ 从空间 $H_0(\\mathbf{curl}, \\Omega)$ 中选取，该空间包含了齐次边界条件 $\\mathbf{F} \\times \\hat{\\mathbf{n}} = \\mathbf{0}$ on $\\partial\\Omega$。\n\n我们对第一项应用矢量微积分恒等式（分部积分）：\n$$ \\int_{\\Omega} \\mathbf{F} \\cdot (\\nabla \\times \\mathbf{G}) \\, dA = \\int_{\\Omega} (\\nabla \\times \\mathbf{F}) \\cdot \\mathbf{G} \\, dA - \\oint_{\\partial\\Omega} (\\mathbf{F} \\times \\mathbf{G}) \\cdot \\hat{\\mathbf{n}} \\, dL $$\n令 $\\mathbf{G} = \\mu^{-1}\\nabla \\times \\mathbf{E}$，积分变为：\n$$ \\int_{\\Omega} (\\nabla \\times \\mathbf{F}) \\cdot (\\mu^{-1} \\nabla \\times \\mathbf{E}) \\, dA - \\int_{\\Omega} \\omega^2\\varepsilon \\mathbf{F} \\cdot \\mathbf{E} \\, dA - \\oint_{\\partial\\Omega} (\\mathbf{F} \\times (\\mu^{-1}\\nabla \\times \\mathbf{E})) \\cdot \\hat{\\mathbf{n}} \\, dL = 0 $$\n由于测试函数 $\\mathbf{F}$ 属于 $H_0(\\mathbf{curl}, \\Omega)$，其沿边界的切向分量为零，即在 $\\partial\\Omega$ 上有 $\\mathbf{F} \\times \\hat{\\mathbf{n}} = \\mathbf{0}$。边界积分项因涉及 $\\mathbf{F}$ 的切向分量而消失。\n\n得到的弱形式为：求 $(\\omega, \\mathbf{E}) \\in \\mathbb{R} \\times H_0(\\mathbf{curl}, \\Omega)$，其中 $\\mathbf{E} \\ne \\mathbf{0}$，使得对于所有 $\\mathbf{F} \\in H_0(\\mathbf{curl}, \\Omega)$：\n$$ \\int_{\\Omega} \\mu^{-1} (\\nabla \\times \\mathbf{F}) \\cdot (\\nabla \\times \\mathbf{E}) \\, dA - \\omega^2\\varepsilon \\int_{\\Omega} \\mathbf{F} \\cdot \\mathbf{E} \\, dA = 0 $$\n这是一个广义特征值问题。两个双线性形式是：\n1.  **旋度-旋度（刚度）形式**：$a(\\mathbf{E}, \\mathbf{F}) = \\int_{\\Omega} \\mu^{-1} (\\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{F}) \\, dA$\n2.  **质量形式**：$m(\\mathbf{E}, \\mathbf{F}) = \\int_{\\Omega} \\varepsilon \\mathbf{E} \\cdot \\mathbf{F} \\, dA$\n\n### 第2部分：局部单元矩阵的结构\n\n在有限元法框架中，电场被近似为基函数的线性组合，$\\mathbf{E}_h = \\sum_{j} E_j \\mathbf{N}_j$，其中 $\\mathbf{N}_j$ 是与网格边相关联的一阶 Nédélec 矢量基函数。将此展开式代入弱形式，并对每个基函数 $i$ 选择 $\\mathbf{F} = \\mathbf{N}_i$，得到矩阵特征值问题 $S \\mathbf{e} = \\omega^2 M \\mathbf{e}$。矩阵 $S$ 和 $M$ 是由三角形剖分中每个单元 $K$ 的贡献组装而成的。\n\n对于单个三角形单元 $K$，局部刚度矩阵 $S^K$ 和局部质量矩阵 $M^K$ 的元素由该单元上的双线性形式积分给出，其中使用了与该三角形三条边相关联的局部基函数 $\\mathbf{N}_i^K$ 和 $\\mathbf{N}_j^K$。$3 \\times 3$ 局部矩阵的元素为：\n-   **局部刚度矩阵元素 ($S^K_{ij}$)**：这由旋度-旋度形式导出。对于二维情况，平面内矢量场的旋度是一个沿 $z$ 方向的标量场。\n    $$ S^K_{ij} = \\int_K \\mu^{-1} (\\nabla \\times \\mathbf{N}_i^K) (\\nabla \\times \\mathbf{N}_j^K) \\, dA $$\n-   **局部质量矩阵元素 ($M^K_{ij}$)**：这由质量形式导出。\n    $$ M^K_{ij} = \\int_K \\varepsilon (\\mathbf{N}_i^K \\cdot \\mathbf{N}_j^K) \\, dA $$\n这些表达式按要求直接根据物理单元 $K$ 上的基函数定义了局部矩阵。\n\n### 第3部分：全局稀疏模式\n\n全局刚度矩阵 $S$ 和质量矩阵 $M$ 是通过对所有单元矩阵 $S^K$ 和 $M^K$ 的贡献求和来组装的。全局系统矩阵（$S$ 或 $M$）的元素 $A_{ij}$ 非零，当且仅当自由度 (DOF) $i$ 和 $j$ 耦合。在此背景下，自由度与网格边相关联。\n\n-   **施加边界约束前**：两个分别对应于边 $e_i$ 和 $e_j$ 的自由度是耦合的，当且仅当存在至少一个同时包含 $e_i$ 和 $e_j$ 作为其边的三角形单元 $K$。矩阵大小为 $N_{dof} \\times N_{dof}$，其中 $N_{dof}$ 是网格中的总边数。对于给定的网格，有 16 条边，因此矩阵为 $16 \\times 16$。其稀疏模式是对称的，反映了网格的连通性。\n\n-   **施加边界约束后**：PEC 边界条件 $\\mathbf{E} \\times \\hat{\\mathbf{n}} = \\mathbf{0}$ 被强加。这意味着与边界 $\\partial\\Omega$ 上所有边对应的自由度被设为零。这等效于从全局系统矩阵中移除与这些边界边相关联的行和列。得到的线性系统仅涉及内部自由度。约简后矩阵的大小为 $N_{int} \\times N_{int}$，其中 $N_{int}$ 是内部边的数量。这个较小矩阵的稀疏模式由内部边的连通性决定。如果内部边 $e_i$ 和 $e_j$ 属于同一个三角形，则存在一个非零元素 $(i,j)$。\n\n### 第4部分：半带宽计算\n\n最后的任务是在特定自由度排序下，计算约简后系统矩阵（施加边界条件后）的半带宽 $b = \\max\\{ j - i \\,:\\, a_{ij} \\neq 0,\\, j \\geq i\\}$。\n\n**步骤1：识别并排序内部自由度**\n首先，我们列出 8 条内部边及其中心点：\n-   水平 (H)：$(0.25, 0.5)$, $(0.75, 0.5)$\n-   垂直 (V)：$(0.5, 0.25)$, $(0.5, 0.75)$\n-   对角线 (D)：$(0.25, 0.25)$, $(0.75, 0.25)$, $(0.25, 0.75)$, $(0.75, 0.75)$\n\n接下来，我们应用指定的排序规则：按中点 $y$ 坐标（升序），然后按中点 $x$ 坐标（升序），再按类型（H, V, D）排序。这得出了重新编号的内部自由度：\n\n| 新索引 ($i'$) | 中点 $(x,y)$ | 类型 | 边描述 |\n|:---:|:---:|:---:|:---|\n| 1 | $(0.25, 0.25)$ | D | 正方形 $[0,0.5]\\times[0,0.5]$ 内的对角线 |\n| 2 | $(0.5, 0.25)$ | V | 直线 $x=0.5$ 上的垂直边，下半部分 |\n| 3 | $(0.75, 0.25)$ | D | 正方形 $[0.5,1]\\times[0,0.5]$ 内的对角线 |\n| 4 | $(0.25, 0.5)$ | H | 直线 $y=0.5$ 上的水平边，左半部分 |\n| 5 | $(0.75, 0.5)$ | H | 直线 $y=0.5$ 上的水平边，右半部分 |\n| 6 | $(0.25, 0.75)$ | D | 正方形 $[0,0.5]\\times[0.5,1]$ 内的对角线 |\n| 7 | $(0.5, 0.75)$ | V | 直线 $x=0.5$ 上的垂直边，上半部分 |\n| 8 | $(0.75, 0.75)$ | D | 正方形 $[0.5,1]\\times[0.5,1]$ 内的对角线 |\n\n**步骤2：确定内部自由度之间的耦合**\n我们确定哪些内部边对属于同一个三角形。该网格由 8 个三角形组成。我们分析每个三角形的边。一条边用其新索引表示。\n\n-   **T1**：顶点为 $(0,0), (0.5,0), (0.5,0.5)$。其内部边是左下角正方形的对角线（索引 1）和位于 $x=0.5$ 上的下部垂直边（索引 2）。耦合：$\\{1, 2\\}$。\n-   **T2**：顶点为 $(0,0), (0,0.5), (0.5,0.5)$。其内部边是对角线（索引 1）和位于 $y=0.5$ 上的左侧水平边（索引 4）。耦合：$\\{1, 4\\}$。\n-   **T3**：顶点为 $(0.5,0), (1,0), (1,0.5)$。其唯一的内部边是右下角正方形的对角线（索引 3）。没有内部边对。\n-   **T4**：顶点为 $(0.5,0), (0.5,0.5), (1,0.5)$。其内部边是位于 $x=0.5$ 上的下部垂直边（索引 2）、对角线（索引 3）和位于 $y=0.5$ 上的右侧水平边（索引 5）。耦合：$\\{2, 3, 5\\}$。\n-   **T5**：顶点为 $(0,0.5), (0.5,0.5), (0.5,1)$。其内部边是位于 $y=0.5$ 上的左侧水平边（索引 4）、左上角正方形的对角线（索引 6）和位于 $x=0.5$ 上的上部垂直边（索引 7）。耦合：$\\{4, 6, 7\\}$。\n-   **T6**：顶点为 $(0,0.5), (0,1), (0.5,1)$。其唯一的内部边是对角线（索引 6）。没有内部边对。\n-   **T7**：顶点为 $(0.5,0.5), (1,0.5), (1,1)$。其内部边是位于 $y=0.5$ 上的右侧水平边（索引 5）和右上角正方形的对角线（索引 8）。耦合：$\\{5, 8\\}$。\n-   **T8**：顶点为 $(0.5,0.5), (0.5,1), (1,1)$。其内部边是位于 $x=0.5$ 上的上部垂直边（索引 7）和对角线（索引 8）。耦合：$\\{7, 8\\}$。\n\n**步骤3：计算半带宽**\n半带宽是所有耦合对 $(i', j')$（其中 $j'>i'$）的差值 $j' - i'$ 的最大值。我们检查每个耦合组产生的最大差值：\n-   来自 T1，耦合 $\\{1, 2\\}$：$2 - 1 = 1$。\n-   来自 T2，耦合 $\\{1, 4\\}$：$4 - 1 = 3$。\n-   来自 T4，耦合 $\\{2, 3, 5\\}$：$\\max(3-2, 5-2, 5-3) = \\max(1, 3, 2) = 3$。\n-   来自 T5，耦合 $\\{4, 6, 7\\}$：$\\max(6-4, 7-4, 7-6) = \\max(2, 3, 1) = 3$。\n-   来自 T7，耦合 $\\{5, 8\\}$：$8 - 5 = 3$。\n-   来自 T8，耦合 $\\{7, 8\\}$：$8 - 7 = 1$。\n\n所有差值 $j'-i'$ 的集合是 $\\{1, 3\\}$。在所有耦合中观察到的最大差值为 $3$。\n\n因此，在施加边界约束并重新编号后，全局矩阵的半带宽为 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在获得稀疏矩阵后，直接求解器的性能关键取决于“符号分解”阶段，该阶段能预测计算过程中的内存消耗和计算成本。本练习将深入探讨这一核心概念，要求您为一个简单的三维网格构建邻接图，并推导出相应的消去树 。理解这种图論表示方法是掌握重排序算法如何最小化“填充”（即分解过程中产生的新非零元）的关键。",
            "id": "3299957",
            "problem": "在频域计算电磁学中，考虑一个均匀各向同性导体，其标量势公式由作用于电标量势 $u$ 的椭圆算子描述，并使用基于四面体网格的一阶拉格朗日有限元法 (FEM) 进行离散化。全局刚度矩阵 $K$ 的矩阵元为\n$$\nK_{ij} \\;=\\; \\sum_{e} \\int_{\\Omega_e} \\sigma \\,\\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dV \\;+\\; \\alpha \\int_{\\Omega} \\phi_i \\phi_j \\, dV,\n$$\n其中 $\\sigma>0$ 是电导率，$\\alpha>0$ 是确保对称正定性的正则化参数，$\\phi_i$ 是节点基函数，求和遍及所有四面体单元 $\\Omega_e$。两个节点 $i$ 和 $j$ 耦合当且仅当它们的支撑域在至少一个公共四面体上重叠。因此，稀疏矩阵 $K$ 的邻接图完全由网格的连接关系确定。\n\n考虑一个网格，其节点坐标如下\n- 节点 $1$：$(0,0,0)$，\n- 节点 $2$：$(1,0,0)$，\n- 节点 $3$：$(0,1,0)$，\n- 节点 $4$：$(0,0,1)$，\n- 节点 $5$：$(1,1,1)$，\n以及两个四面体\n- $T_1 = (1,2,3,4)$，\n- $T_2 = (1,2,3,5)$，\n它们共享面 $(1,2,3)$。\n\n假设所有 $5$ 个节点都是自由度（未施加本质边界条件），并使用未知量的自然排序 $1 \\prec 2 \\prec 3 \\prec 4 \\prec 5$。构造 $K$ 的无向邻接图（节点代表未知量，边代表非零的非对角耦合），然后考虑通过 Cholesky 分解进行对称分解，并推导由此自然排序导出的相应消去树。消去树的定义如下：节点 $j$ 的父节点是 Cholesky 因子第 $j$ 列对角线下方第一个非零元的索引，等价地，是在此排序下高斯消去法产生的填充图中，与 $j$ 相邻的最小索引 $i>j$。\n\n计算消去树的高度，其定义为最长根到叶路径上的节点数。请将您的最终答案表示为一个不带单位的整数。",
            "solution": "用户要求我求解一个由有限元法 (FEM) 离散化产生的稀疏矩阵的消去树的高度。\n\n### 第1步：问题验证\n\n问题经过了严格的验证过程。\n\n**1.1. 提取已知条件**\n- **公式**：作用于均匀各向同性导体中电势 $u$ 的标量势椭圆算子。\n- **离散化**：基于四面体网格的一阶拉格朗日有限元法。\n- **刚度矩阵 ($K$) 矩阵元**：$K_{ij} = \\sum_{e} \\int_{\\Omega_e} \\sigma \\,\\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dV \\;+\\; \\alpha \\int_{\\Omega} \\phi_i \\phi_j \\, dV$，其中电导率 $\\sigma>0$ 且正则化参数 $\\alpha>0$。\n- **稀疏性规则**：两个节点 $i$ 和 $j$ 耦合（即，当 $i \\neq j$ 时，$K_{ij} \\neq 0$）当且仅当它们属于一个公共四面体。$K$ 的邻接图由网格连接关系确定。\n- **网格节点**：\n    - 节点 $1$：$(0,0,0)$\n    - 节点 $2$：$(1,0,0)$\n    - 节点 $3$：$(0,1,0)$\n    - 节点 $4$：$(0,0,1)$\n    - 节点 $5$：$(1,1,1)$\n- **网格单元（四面体）**：\n    - $T_1 = (1,2,3,4)$\n    - $T_2 = (1,2,3,5)$\n- **自由度**：所有5个节点都是自由度。\n- **排序**：自然排序 $1 \\prec 2 \\prec 3 \\prec 4 \\prec 5$。\n- **任务**：构造 $K$ 的邻接图，推导给定排序下 Cholesky 分解的消去树，并计算该树的高度。\n- **消去树定义**：节点 $j$ 的父节点是 `parent(j)` $= \\min\\{i > j \\text{ | } (i,j) \\text{ 是填充图中的一条边}\\}$。\n- **高度定义**：树的高度是最长根到叶路径上的节点数。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据**：该问题在计算电磁学和数值线性代数领域具有扎实的科学基础。它描述了一个标准的有限元法公式以及使用 Cholesky 分解、填充图和消去树等概念进行的相关稀疏矩阵分析。这些都是该领域的基础课题。\n- **适定性**：该问题是适定的。对网格、矩阵稀疏性规则、节点排序以及消去树及其高度的定义都是精确且自洽的，可以导出一个唯一的解。\n- **客观性**：该问题以客观、形式化的语言陈述，不含任何主观或模糊的术语。\n\n**1.3. 结论与行动**\n该问题在科学上是合理的、适定的和客观的。它不包含任何使其无效的缺陷。因此，它被判定为**有效**。我将继续构建解决方案。\n\n### 第2步：求解\n\n解决方案需要四个步骤：(1) 构造矩阵 $K$ 的邻接图，(2) 确定消去过程产生的填充图，(3) 推导消去树的结构，以及 (4) 计算其高度。\n\n**2.1. 构造邻接图 $G(K)$**\n\n图的顶点集是节点集 $V = \\{1, 2, 3, 4, 5\\}$。图中存在一条边 $(i, j)$ 当且仅当节点 $i$ 和 $j$ 属于一个公共的四面体。\n\n- **四面体 $T_1 = \\{1, 2, 3, 4\\}$**：此单元内的节点形成一个团（clique）。这贡献了边 $(1,2)$、$(1,3)$、$(1,4)$、$(2,3)$、$(2,4)$ 和 $(3,4)$。\n- **四面体 $T_2 = \\{1, 2, 3, 5\\}$**：此单元内的节点也形成一个团。这贡献了边 $(1,2)$、$(1,3)$、$(1,5)$、$(2,3)$、$(2,5)$ 和 $(3,5)$。\n\n邻接图 $G(K)$ 由所有单元的所有边的并集形成。每个节点的邻接表如下：\n- 节点 $1$ 的邻接点：在 $T_1$ 中的邻居是 $\\{2,3,4\\}$。在 $T_2$ 中的邻居是 $\\{2,3,5\\}$。并集是 $\\text{Adj}(1) = \\{2,3,4,5\\}$。\n- 节点 $2$ 的邻接点：在 $T_1$ 中的邻居是 $\\{1,3,4\\}$。在 $T_2$ 中的邻居是 $\\{1,3,5\\}$。并集是 $\\text{Adj}(2) = \\{1,3,4,5\\}$。\n- 节点 $3$ 的邻接点：在 $T_1$ 中的邻居是 $\\{1,2,4\\}$。在 $T_2$ 中的邻居是 $\\{1,2,5\\}$。并集是 $\\text{Adj}(3) = \\{1,2,4,5\\}$。\n- 节点 $4$ 的邻接点：该节点只在 $T_1$ 中。其邻居是 $\\text{Adj}(4) = \\{1,2,3\\}$。\n- 节点 $5$ 的邻接点：该节点只在 $T_2$ 中。其邻居是 $\\text{Adj}(5) = \\{1,2,3\\}$。\n\n关键的是，节点 $4$ 和 $5$ 不共享同一个四面体，所以边 $(4,5)$ 在原始图 $G(K)$ 中不存在。\n\n**2.2. 确定填充图 $G^+$**\n\n填充图 $G^+$ 是在符号高斯消去过程中通过添加“填充”边得到的。如果 $K_{ij}=0$ 但 Cholesky 因子 $L$ 中对应的项 $L_{ij}$ 非零，则边 $(i,j)$ 是一个填充。该过程通过按指定顺序 $k = 1, 2, 3, 4$ 消去节点来模拟。当一个节点 $k$ 被消去时，它在当前图中的邻居会形成一个团。\n\n- **消去节点 $k=1$**：在 $G(K)$ 中，节点 $1$ 的邻居是 $\\{2,3,4,5\\}$。为了使这些节点形成一个团，每对节点之间都必须有一条边连接。这些节点对是 $(2,3), (2,4), (2,5), (3,4), (3,5), (4,5)$。我们检查这些边中有哪些在 $G(K)$ 中是缺失的。\n  - $(2,3)$: 存在（在 $T_1, T_2$ 中）。\n  - $(2,4)$: 存在（在 $T_1$ 中）。\n  - $(2,5)$: 存在（在 $T_2$ 中）。\n  - $(3,4)$: 存在（在 $T_1$ 中）。\n  - $(3,5)$: 存在（在 $T_2$ 中）。\n  - $(4,5)$: **不存在**。\n  因此，消去节点 $1$ 会产生一条填充边：$(4,5)$。剩余节点 $\\{2,3,4,5\\}$ 上的图变成一个完全图（一个 $K_4$ 团）。\n\n- **消去节点 $k=2$**：在修改后的图中，节点 $2$ 的具有更大索引的邻居是 $\\{3,4,5\\}$。这三个节点已经形成一个团，因为 $\\{2,3,4,5\\}$ 上的子图现在是完全的。因此，消去节点 $2$ 不会产生新的填充。\n\n- **消去节点 $k=3$ 和 $k=4$**：类似地，消去节点 $3$（邻居为 $\\{4,5\\}$）和节点 $4$（邻居为 $\\{5\\}$）将不会产生任何进一步的填充。\n\n填充图 $G^+$ 是原始图 $G(K)$ 加上单条填充边 $(4,5)$。$E(G^+) = E(G(K)) \\cup \\{(4,5)\\}$。这意味着在填充图中，每对节点都相连。$G^+$ 是顶点集 $V=\\{1,2,3,4,5\\}$ 上的完全图 $K_5$。\n\n**2.3. 推导消去树 $T$**\n\n消去树由父子关系定义，其中节点 $j$ 的父节点由以下公式给出：\n$$ \\text{parent}(j) = \\min \\{i \\mid i > j \\text{ and } (i,j) \\text{ is an edge in } G^+\\} $$\n我们对 $j = 1, 2, 3, 4$ 应用此规则。节点 $5$ 是编号最大的节点，将成为树的根。\n\n- **`parent(1)`**：在 $G^+$ 中，节点 $1$ 的邻居是 $\\{2,3,4,5\\}$。所有这些索引都大于 $1$。其中最小的是 $2$。\n  $\\text{parent}(1) = \\min\\{2,3,4,5\\} = 2$。\n\n- **`parent(2)`**：在 $G^+$ 中，节点 $2$ 的邻居是 $\\{1,3,4,5\\}$。索引大于 $2$ 的邻居是 $\\{3,4,5\\}$。其中最小的是 $3$。\n  $\\text{parent}(2) = \\min\\{3,4,5\\} = 3$。\n\n- **`parent(3)`**：在 $G^+$ 中，节点 $3$ 的邻居是 $\\{1,2,4,5\\}$。索引大于 $3$ 的邻居是 $\\{4,5\\}$。其中最小的是 $4$。\n  $\\text{parent}(3) = \\min\\{4,5\\} = 4$。\n\n- **`parent(4)`**：在 $G^+$ 中，节点 $4$ 的邻居是 $\\{1,2,3,5\\}$。唯一索引大于 $4$ 的邻居是 $\\{5\\}$。最小值是 $5$。\n  $\\text{parent}(4) = \\min\\{5\\} = 5$。\n\n最终得到的消去树结构是一条简单路径：$1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5$，其中 $5$ 是根节点。\n\n**2.4. 计算消去树的高度**\n\n问题将高度定义为“最长根到叶路径上的节点数”。\n在推导出的树中，只有一条根到叶的路径。\n- 根：节点 $5$。\n- 叶：节点 $1$。\n- 路径：$5 \\rightsquigarrow 4 \\rightsquigarrow 3 \\rightsquigarrow 2 \\rightsquigarrow 1$。\n此路径上的节点是 $\\{5, 4, 3, 2, 1\\}$。\n此路径上的节点数是 $5$。\n\n因此，消去树的高度是 $5$。",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "现代科学计算对速度和精度提出了双重挑战，催生了各种先进的求解器算法。本练习将介绍混合精度计算，这是一种强大的加速技术，它通过在较低精度下执行计算最密集的部分，同时利用迭代精化的方法来恢复高精度解 。通过实现一个带有迭代精化的 $L D L^T$ 分解算法并推导其理论精度极限，您将探索在性能、内存和数值稳定性之间的权衡，这些正是前沿直接求解器设计的核心。",
            "id": "3299965",
            "problem": "考虑电场的频域形式麦克斯韦方程组，在包含导电填充物的理想电导体腔体中，使用一阶 Nédélec 边元的弱形式可导出一个线性系统 $A x = b$，其中 $A$ 是一个复数、稀疏、对称矩阵。在材料参数的标准假设下，离散算子具有以下结构\n$$\nA = K - \\omega^2 M + i \\,\\omega\\, \\sigma\\, M,\n$$\n其中 $K$ 是旋度-旋度（类刚度）矩阵，$M$ 是质量矩阵，$\\omega$ 是角频率，$\\sigma$ 是电导率。在一维空间中使用线性元（这是一个在数学上简化但保留了对称性和带状稀疏性的模拟），$K$ 是一个三对角矩阵，其对角线元素为 $2/h$，紧邻的次对角线元素为 $-1/h$；$M$ 是 $h I$；$h=1/(n+1)$ 是对应 $n$ 个内部节点的均匀元尺寸。\n\n您的任务是基于对称不定 $L D L^T$ 分解（单位下三角矩阵 $L$ 和对角矩阵 $D$）为复数矩阵 $A$ 实现一个混合精度稀疏直接求解器，并遵循以下要求：\n\n- 以较低精度（单精度，单位舍入为 $u_{\\ell}$）计算 $A$ 的 $L D L^T$ 分解。\n- 以较高精度（双精度，单位舍入为 $u_{h}$）执行迭代细化：以双精度计算残差 $r = b - A x$，使用单精度分解求解修正量 $\\delta x$，并以双精度更新 $x \\leftarrow x + \\delta x$。将此过程迭代固定次数。\n- 从浮点模型的首要原则和直接分解的扰动分析出发，推导迭代细化可达到的相对残差界，该界是单位舍入和矩阵 $A$ 条件数的函数：\n$$\n\\frac{\\|r\\|_2}{\\|b\\|_2} \\quad \\text{as a function of} \\quad u_{\\ell},\\; u_{h},\\; \\kappa_2(A).\n$$\n您的推导必须从浮点运算法则模型开始，并使用范数形式的分解和求解扰动界。不要预先假设误差公式；应进行逻辑推导。\n\n求解器的实现细节：\n\n- 为上述构建的复对称矩阵 $A$ 实现无主元选择的 $L D L^T$ 分解（单精度）。使用单位对角阵 $L$ 和对角阵 $D$。\n- 实现为 $L D L^T$ 定制的前向和后向代入：求解 $L y = \\text{rhs}$，然后是 $D z = y$，最后是 $L^T x = z$。\n- 迭代细化必须：\n  1. 以单精度计算初始解 $x_0$。\n  2. 以双精度计算 $r_k = b - A x_k$。\n  3. 通过单精度 $L D L^T$ 分解求解 $A \\delta x_k = r_k$。\n  4. 以双精度更新 $x_{k+1} = x_k + \\delta x_k$。\n  5. 重复固定次数的迭代（例如，10次）。\n\n使用简化的有限元矩阵和以下参数集定义测试套件，这些参数集用于探测不同的状态区间：\n\n- 正常路径（中等条件数）：$(n,\\omega,\\sigma) = (12,\\,5.0,\\,0.05)$。\n- 接近不稳定的边界状态（大条件数）：$(n,\\omega,\\sigma) = (12,\\,18.5,\\,0.0001)$。\n- 强阻尼（良态）：$(n,\\omega,\\sigma) = (20,\\,0.1,\\,2.0)$。\n\n对于每个测试用例：\n\n- 如上所述构建 $A$，其中 $h = 1/(n+1)$，$K$ 为三对角矩阵，对角线元素为 $2/h$，次对角线元素为 $-1/h$，$M = h I$。\n- 使用右端项 $b$，其元素为 $1 + 0 i$。\n- 执行混合精度迭代细化，迭代10次。\n- 计算最终的相对残差 $\\|r\\|_2 / \\|b\\|_2$（浮点数形式）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如 $[r_1,r_2,r_3]$），其中每个 $r_j$ 是对应测试用例的最终相对残差 $\\|r\\|_2 / \\|b\\|_2$。答案中不要求使用物理单位。所有角度（如果出现）必须以弧度为单位。所有分数量都必须以小数形式表示，不得使用百分号。",
            "solution": "此问题被评估为 **有效**。它在计算电磁学和数值线性代数领域有坚实的科学基础，问题陈述清晰完整、定义明确，并以客观、正式的语言表达。其任务涉及理论推导和数值实现，在这些领域内是标准且可验证的。\n\n### 1. 可达残差界的理论推导\n\n目标是推导混合精度迭代细化可达到的相对残差界 $\\frac{\\|r\\|_2}{\\|b\\|_2}$，该界是低精度单位舍入 $u_{\\ell}$、高精度单位舍入 $u_{h}$ 以及系统矩阵条件数 $\\kappa_2(A)$ 的函数。推导过程从标准浮点运算法则模型开始。\n\n设线性系统为 $A x = b$。迭代细化的目标是通过计算修正量 $\\delta x_k$ 并设置 $x_{k+1} = x_k + \\delta x_k$ 来改进近似解 $x_k$。修正量通过求解 $A \\delta x_k = r_k$ 得到，其中 $r_k = b - A x_k$ 是残差。在我们的混合精度方案中：\n- 分解 $A \\approx \\hat{L}\\hat{D}\\hat{L}^T$ 在较低精度（单位舍入 $u_{\\ell}$）下计算和存储。\n- 残差 $r_k$ 和解的更新 $x_{k+1}$ 在较高精度（单位舍入 $u_{h}$）下计算。\n\n让我们从一个近似解 $x_k$ 开始，分析迭代的一个步骤。\n\n**步骤 1：残差计算**\n残差 $r_k = b - A x_k$ 在较高精度 $u_h$ 下计算。计算得到的残差 $\\hat{r}_k$ 为 $\\hat{r}_k = \\text{fl}_h(b - A x_k)$。针对矩阵向量乘法和向量减法的标准误差分析表明：\n$$\n\\hat{r}_k = (b - A x_k) + f_k = r_k + f_k\n$$\n其中 $f_k$ 是浮点误差。该误差的范数界由下式给出：\n$$\n\\|f_k\\|_2 \\le c_1 u_h (\\|b\\|_2 + \\|A\\|_2 \\|x_k\\|_2)\n$$\n其中 $c_1$ 是一个与矩阵维度 $n$ 相关的小常数。随着迭代收敛， $x_k$ 趋近于真解 $x = A^{-1}b$。因此，对于一个稳定的过程，$\\|x_k\\|_2 \\approx \\|x\\|_2 \\le \\|A^{-1}\\|_2 \\|b\\|_2$。代入此式可得：\n$$\n\\|f_k\\|_2 \\le c_1 u_h (\\|b\\|_2 + \\|A\\|_2 \\|A^{-1}\\|_2 \\|b\\|_2) = c_1 u_h (1 + \\kappa_2(A)) \\|b\\|_2\n$$\n\n**步骤 2：修正量求解**\n修正量 $\\delta x_k$ 通过求解 $A \\delta x_k = r_k$ 来计算。我们使用 $A$ 的低精度分解来求解修正量 $d_k$，其中使用计算出的残差 $\\hat{r}_k$。在精度 $u_{\\ell}$ 下进行分解和代入的过程等价于精确求解一个受扰动的系统。计算得到的修正量 $\\hat{d}_k$ 满足：\n$$\n(A + E) \\hat{d}_k = \\hat{r}_k\n$$\n其中 $E$ 是代表分解和代入中不精确性的后向误差。该误差的范数有界：\n$$\n\\|E\\|_2 \\le c_2 u_{\\ell} \\|A\\|_2\n$$\n其中 $c_2$ 是一个取决于 $n$ 和分解稳定性的常数（我们假设其足够稳定）。\n\n**步骤 3：解的更新**\n解在较高精度下更新：$x_{k+1} = \\text{fl}_h(x_k + \\hat{d}_k)$。此加法中的误差很小，因此我们可以近似为 $x_{k+1} \\approx x_k + \\hat{d}_k$。\n\n**步骤 4：收敛性分析**\n新的残差为 $r_{k+1} = b - A x_{k+1} \\approx b - A(x_k + \\hat{d}_k) = r_k - A \\hat{d}_k$。\n从步骤2可知，$A \\hat{d}_k = \\hat{r}_k - E \\hat{d}_k$。代入此式可得：\n$$\nr_{k+1} \\approx r_k - (\\hat{r}_k - E \\hat{d}_k) = (r_k - \\hat{r}_k) + E \\hat{d}_k = -f_k + E \\hat{d}_k\n$$\n取范数：\n$$\n\\|r_{k+1}\\|_2 \\le \\|f_k\\|_2 + \\|E\\|_2 \\|\\hat{d}_k\\|_2\n$$\n我们有 $\\hat{d}_k = (A+E)^{-1} \\hat{r}_k \\approx A^{-1} r_k$。所以，$\\|\\hat{d}_k\\|_2 \\approx \\|A^{-1} r_k\\|_2 \\le \\|A^{-1}\\|_2 \\|r_k\\|_2$。\n代入 $\\|f_k\\|_2$ 和 $\\|E\\|_2$ 的界：\n$$\n\\|r_{k+1}\\|_2 \\le c_1 u_h (1 + \\kappa_2(A)) \\|b\\|_2 + (c_2 u_{\\ell} \\|A\\|_2) (\\|A^{-1}\\|_2 \\|r_k\\|_2)\n$$\n$$\n\\|r_{k+1}\\|_2 \\le c_1 u_h (1 + \\kappa_2(A)) \\|b\\|_2 + c_2 u_{\\ell} \\kappa_2(A) \\|r_k\\|_2\n$$\n这是一个关于残差范数的线性递推关系。如果收缩因子小于1，即 $c_2 u_{\\ell} \\kappa_2(A)  1$，则迭代收敛。\n\n**步骤 5：可达残差**\n假设收敛条件成立，迭代将进行到残差更新停滞为止。极限残差 $r_\\infty$ 由不随 $\\|r_k\\|_2$ 缩小的误差分量决定。这个分量就是来自高精度残差计算的误差。当真实残差 $r_k$ 与计算它的误差 $f_k$ 处于同一数量级时，迭代实际上会停滞。因此，可达残差 $\\|r_\\infty\\|_2$ 从根本上受限于 $\\|f_k\\|_2$。\n$$\n\\|r_\\infty\\|_2 \\approx \\|f_k\\|_2 \\le c_1 u_h (1 + \\kappa_2(A)) \\|b\\|_2\n$$\n两边同除以 $\\|b\\|_2$ 得到可达相对残差界：\n$$\n\\frac{\\|r_\\infty\\|_2}{\\|b\\|_2} \\le c_1 u_h (1 + \\kappa_2(A))\n$$\n对于条件数很大的矩阵，其中 $\\kappa_2(A) \\gg 1$，这个界通常简化为：\n$$\n\\frac{\\|r_\\infty\\|_2}{\\|b\\|_2} \\approx C u_h \\kappa_2(A)\n$$\n其中 $C$ 是一个不大的常数。这个结果表明，如果系统的病态程度没有严重到让低精度分解失效（即 $u_{\\ell} \\kappa_2(A)  1$），那么混合精度迭代细化可以达到一个最终残差，其量级接近于工作精度的机器ε与条件数的乘积。\n\n### 2. 实现策略\n\n问题指定了一个简化的1D模拟，其中矩阵 $A = K - \\omega^2 M + i \\omega \\sigma M$ 是三对角且复对称的。可以利用这一结构进行高效实现。\n\n- **矩阵结构**：刚度矩阵 $K$ 是三对角的，质量矩阵 $M$ 是对角的（$M=hI$）。因此，系统矩阵 $A$ 也是三对角的。我们使用三个向量来存储它：一个用于主对角线，一个用于次对角线/上对角线（由于对称性而相等）。\n\n- **分解**：我们为对称三对角矩阵实现了一个专门的 $L D L^T$ 分解。对于一个三对角矩阵 $A$，其 $L D L^T$ 因子也是稀疏的：$L$ 是一个单位下双对角矩阵，$D$ 是一个对角矩阵。该分解可以在 $O(n)$ 次运算内完成，且不产生任何填充元。此过程在单精度（`complex64`）下执行。\n\n- **求解**：前向代入（$L y = b$）、对角求解（$D z = y$）和后向代入（$L^T x = z$）步骤的实现也利用了因子的双对角/对角结构，每一步都需要 $O(n)$ 次运算。\n\n- **迭代细化**：主循环按照问题描述进行，固定迭代 $10$ 次：\n    1. 残差 $r_k = b - A x_k$ 在双精度（`complex128`）下计算，使用高效的三对角矩阵向量积。\n    2. 残差被转换为单精度（`complex64`），并使用三对角 $L D L^T$ 求解器来找到修正量 $\\delta x_k$。\n    3. 修正量被转换回双精度，并加到解向量 $x_k$ 上。\n\n这种方法计算效率高，并直接实现了问题陈述中指定的算法，且针对稀疏矩阵结构进行了优化。",
            "answer": "```python\nimport numpy as np\n\ndef ldlt_factorize_tridiag_complex(diag, offdiag):\n    \"\"\"\n    Computes the LDL^T factorization of a complex-symmetric tridiagonal matrix.\n    \n    Args:\n        diag (np.ndarray): Main diagonal of the matrix (length n).\n        offdiag (np.ndarray): Sub-diagonal of the matrix (length n-1).\n    \n    Returns:\n        tuple: (l_vec, d_vec) where l_vec is the sub-diagonal of L and\n               d_vec is the diagonal of D.\n    \"\"\"\n    n = len(diag)\n    dtype = diag.dtype\n    d_vec = np.zeros(n, dtype=dtype)\n    l_vec = np.zeros(n - 1, dtype=dtype)\n\n    if n > 0:\n        d_vec[0] = diag[0]\n        for i in range(n - 1):\n            if d_vec[i] == 0:\n                # This should not happen with the given problem parameters\n                # but is good practice for a general-purpose solver.\n                raise np.linalg.LinAlgError(\"Zero pivot encountered in LDLT factorization.\")\n            l_vec[i] = offdiag[i] / d_vec[i]\n            d_vec[i+1] = diag[i+1] - l_vec[i] * offdiag[i]\n\n    return l_vec, d_vec\n\ndef ldlt_solve_tridiag_complex(l_vec, d_vec, rhs):\n    \"\"\"\n    Solves A x = rhs using the LDL^T factorization of a tridiagonal matrix.\n    \n    Args:\n        l_vec (np.ndarray): Sub-diagonal of L (length n-1).\n        d_vec (np.ndarray): Diagonal of D (length n).\n        rhs (np.ndarray): Right-hand side vector (length n).\n\n    Returns:\n        np.ndarray: The solution vector x.\n    \"\"\"\n    n = len(rhs)\n    if n == 0:\n        return np.array([], dtype=rhs.dtype)\n    \n    # 1. Forward substitution: Solve Ly = rhs\n    y = np.zeros_like(rhs)\n    y[0] = rhs[0]\n    for i in range(n - 1):\n        y[i+1] = rhs[i+1] - l_vec[i] * y[i]\n\n    # 2. Diagonal solve: Solve Dz = y\n    z = y / d_vec\n\n    # 3. Backward substitution: Solve L^T x = z\n    x = np.zeros_like(z)\n    x[n-1] = z[n-1]\n    for i in range(n - 2, -1, -1):\n        x[i] = z[i] - l_vec[i] * x[i+1]\n        \n    return x\n\ndef matvec_tridiag_complex(diag, offdiag, x):\n    \"\"\"\n    Computes the matrix-vector product A @ x for a symmetric tridiagonal matrix.\n    \"\"\"\n    n = len(x)\n    y = np.zeros_like(x, dtype=np.complex128)\n    if n == 0:\n        return y\n    \n    # Vectorized computation for clarity and efficiency\n    y = diag * x\n    if n > 1:\n        y[:-1] += offdiag * x[1:]\n        y[1:] += offdiag * x[:-1]\n        \n    return y\n\ndef run_case(n, omega, sigma):\n    \"\"\"\n    Runs one test case of the mixed-precision iterative refinement solver.\n    \"\"\"\n    h = 1.0 / (n + 1.0)\n    num_iters = 10\n    \n    # --- Construct A in double precision ---\n    diag_K = np.full(n, 2.0 / h, dtype=np.complex128)\n    offdiag_K = np.full(n - 1, -1.0 / h, dtype=np.complex128)\n    \n    # Mass matrix M is h*I\n    M_diag_contribution = h\n    \n    diag_A_double = diag_K - omega**2 * M_diag_contribution + 1j * omega * sigma * M_diag_contribution\n    offdiag_A_double = offdiag_K.copy()  # M is diagonal, so off-diagonals are from K only\n    \n    # --- RHS Vector ---\n    b = np.ones(n, dtype=np.complex128)\n\n    # --- Prepare for single precision factorization ---\n    diag_A_single = diag_A_double.astype(np.complex64)\n    offdiag_A_single = offdiag_A_double.astype(np.complex64)\n\n    # --- Factorize in single precision ---\n    l_sgl, d_sgl = ldlt_factorize_tridiag_complex(diag_A_single, offdiag_A_single)\n\n    # --- Initial solve in single precision ---\n    b_sgl = b.astype(np.complex64)\n    x0_sgl = ldlt_solve_tridiag_complex(l_sgl, d_sgl, b_sgl)\n    x = x0_sgl.astype(np.complex128)\n\n    # --- Iterative Refinement loop ---\n    for _ in range(num_iters):\n        # 1. Compute residual in double precision\n        r = b - matvec_tridiag_complex(diag_A_double, offdiag_A_double, x)\n        \n        # 2. Solve for correction using single precision factors\n        r_sgl = r.astype(np.complex64)\n        delta_x_sgl = ldlt_solve_tridiag_complex(l_sgl, d_sgl, r_sgl)\n        \n        # 3. Update solution in double precision\n        delta_x = delta_x_sgl.astype(np.complex128)\n        x = x + delta_x\n\n    # --- Final residual calculation ---\n    final_r = b - matvec_tridiag_complex(diag_A_double, offdiag_A_double, x)\n    rel_res = np.linalg.norm(final_r) / np.linalg.norm(b)\n    \n    return rel_res\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (n, omega, sigma)\n        (12, 5.0, 0.05),     # Happy path (moderate conditioning)\n        (12, 18.5, 0.0001),  # Boundary regime near instability (large condition number)\n        (20, 0.1, 2.0),      # Strong damping (well-conditioned)\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = run_case(*case_params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}