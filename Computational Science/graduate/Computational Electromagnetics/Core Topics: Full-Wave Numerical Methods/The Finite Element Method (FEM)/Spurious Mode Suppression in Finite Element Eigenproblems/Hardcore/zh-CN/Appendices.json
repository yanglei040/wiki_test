{
    "hands_on_practices": [
        {
            "introduction": "深入理解复杂现象的最佳方式之一是研究一个简化的模型。本练习通过构建一个一维“玩具模型”，揭示了在有限元特征值问题中使用不恰当的节点基函数时，伪模式是如何产生的根源。通过这个实践，您将亲手推导出数值伪影的产生机制，并将其与高维空间中更普适的理论联系起来。",
            "id": "3350389",
            "problem": "考虑在理想电导体 (PEC) 腔体中的时谐无源麦克斯韦特征问题，其变分形式写作：寻找电场 $\\mathbf{E} \\in H(\\mathrm{curl},\\Omega)$ 和波数 $\\kappa^2 \\in \\mathbb{R}$，使得\n$$\n\\int_{\\Omega} \\mu^{-1} \\, (\\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{v}) \\, \\mathrm{d}\\mathbf{x} \\;=\\; \\kappa^2 \\int_{\\Omega} \\epsilon \\, \\mathbf{E}\\cdot \\mathbf{v} \\, \\mathrm{d}\\mathbf{x}\n\\quad \\text{对所有 } \\mathbf{v} \\in H(\\mathrm{curl},\\Omega),\n$$\n并满足 PEC 边界条件 $\\,\\mathbf{n}\\times \\mathbf{E} = \\mathbf{0}$ on $\\partial \\Omega$。一个基本事实是，旋度算子的核空间包含所有梯度场 $\\,\\nabla \\phi\\,$，其中 $\\phi \\in H^{1}_{0}(\\Omega)$，因为 $\\,\\nabla \\times \\nabla \\phi = \\mathbf{0}$。当使用不恰当的有限元空间时，这个零空间是产生伪模式的根本原因。\n\n为了在最简单的设定下揭示这一机制，我们在区间 $(0,L)$ 上构建一个一维 (1D) 玩具模型，用以模仿横电 (TE) 模和横磁 (TM) 模族的分离。我们用一个标量场 $u \\in H^{1}_{0}(0,L)$ 和以下特征问题来模拟 TE 模\n$$\n\\int_{0}^{L} u'(x) \\, v'(x) \\, \\mathrm{d}x \\;=\\; \\lambda \\int_{0}^{L} u(x) \\, v(x) \\, \\mathrm{d}x \\quad \\text{对所有 } v \\in H^{1}_{0}(0,L),\n$$\n并用一个代理标量场 $w \\in H^{1}(0,L)$ 来模拟 TM 梯度子空间，该场旨在表示对 $H(\\mathrm{curl},\\Omega)$ 中某个场进行的（不合规的）节点近似，同时配以双线性形式\n$$\na(w,v) \\;=\\; \\int_{0}^{L} \\big(\\mathrm{curl}\\, w\\big)\\,\\big(\\mathrm{curl}\\, v\\big)\\,\\mathrm{d}x,\n$$\n在 1D 情况中，我们设定 $\\mathrm{curl}\\, w \\equiv 0$ 来模仿在更高维度中标量势 $\\phi$ 的梯度旋度 $\\nabla \\times \\nabla \\phi$ 精确为零的特性。令 $V_{h}$ 为在区间 $(0,L)$ 的一个均匀剖分（划分为 $n$ 个子区间）上定义的连续分段线性（线性拉格朗日）函数空间，且不施加本质边界条件，因此 $\\dim V_{h} = n+1$。\n\n您需要：\n- 从上述变分基础和麦克斯韦方程出发，推导为何离散 TM 代理双线性形式在 $V_{h}$ 上恒为零，从而使广义特征问题退化为一个纯质量矩阵束。\n- 证明添加单个零均值规范约束 $\\int_{0}^{L} w_{h}(x)\\,\\mathrm{d}x = 0$ 会从 $V_{h}$ 中精确地移除一个维度，但并不会改变所有剩余离散特征对都满足 $\\lambda = 0$ 这一事实，从而明确地刻画出伪特征空间。\n- 在概念层面解释，在更高维度中，使用边元（例如，第一类 Nédélec 元）如何满足一个离散紧致性性质，从而防止梯度场污染正谱，而节点元则不满足此性质。\n- 提出至少两种简单且科学合理的测试方案，供从业者在采用有限元法 (FEM) 的计算电磁学中实现，用以检测和量化伪模式。您的提议应与上述推导保持一致，并应能分离出伪模式的产生或抑制机制。\n\n最后，取 $n = 5$，计算在施加单个零均值规范约束后，由错误的离散化 TM 代理在 $V_{h}$ 上产生的伪零特征值模式的确切数量。以单个整数形式给出您的最终答案。无需四舍五入，也无需物理单位。",
            "solution": "该问题陈述是计算电磁学领域的一个有效练习，特别关注有限元特征值分析中的伪模式数值病态问题。该问题具有科学依据，论述清晰，客观且内部一致。它使用一个标准的一维 (1D) 教学模型来说明在更高维度中发生的复杂现象。所有术语都得到了充分定义，足以完成任务。因此，我们可以进行完整求解。\n\n分析按要求分为四个部分，最后进行数值计算。\n\n### 第一部分：双线性形式的消失及相应的特征问题\n\n该问题使用一个标量场 $w$ 和一个双线性形式 $a(w,v)$ 为横磁 (TM) 模定义了一个代理模型。该模型的有限元空间是 $V_h$，即在区间 $(0,L)$ 的一个 $n$ 个子区间的剖分上定义的连续分段线性拉格朗日函数空间，且不施加本质边界条件。该空间的维度，对应于节点数，为 $\\dim V_{h} = n+1$。\n\n这个 1D 玩具模型的关键定义是 `curl` 算子作用于标量场 $w$ 的方式，即：\n$$\n\\mathrm{curl}\\, w \\equiv 0\n$$\n这个定义是矢量微积分恒等式 $\\nabla \\times (\\nabla \\phi) = \\mathbf{0}$ 的直接类比，其中 1D 模型中的标量场 $w$ 扮演了三维中标量势 $\\phi$ 的角色。$V_h$ 中的节点基函数旨在模仿为 $H(\\mathrm{curl},\\Omega)$ 中的矢量场选择节点元的无效做法，这种做法会无意中包含此梯度子空间。\n\nTM 代理的双线性形式为：\n$$\na(w,v) = \\int_{0}^{L} \\big(\\mathrm{curl}\\, w\\big)\\,\\big(\\mathrm{curl}\\, v\\big)\\,\\mathrm{d}x\n$$\n对于任意两个函数 $w_h, v_h \\in V_h$，根据给定的定义，我们有 $\\mathrm{curl}\\, w_h = 0$ 和 $\\mathrm{curl}\\, v_h = 0$。因此，被积函数恒为零：\n$$\n\\big(\\mathrm{curl}\\, w_h(x)\\big)\\,\\big(\\mathrm{curl}\\, v_h(x)\\big) = 0 \\cdot 0 = 0 \\quad \\text{对所有 } x \\in (0,L)\n$$\n所以，对于所选离散空间中的所有函数，该双线性形式均为零：\n$$\na(w_h, v_h) = \\int_{0}^{L} 0 \\,\\mathrm{d}x = 0 \\quad \\text{对所有 } w_h, v_h \\in V_h\n$$\n相应的广义特征问题是寻找 $(\\lambda, w_h) \\in (\\mathbb{R}, V_h)$，使得对所有 $v_h \\in V_h$：\n$$\na(w_h, v_h) = \\lambda \\int_{0}^{L} w_h(x) v_h(x) \\,\\mathrm{d}x\n$$\n代入 $a(w_h, v_h)=0$ 的结果，方程变为：\n$$\n0 = \\lambda \\int_{0}^{L} w_h(x) v_h(x) \\,\\mathrm{d}x\n$$\n在有限元背景下，这可以写成矩阵特征问题 $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$。刚度矩阵 $\\mathbf{K}$ 的元素为 $K_{ij} = a(\\phi_i, \\phi_j)$，其中 $\\{\\phi_i\\}$ 是 $V_h$ 的基。根据我们的推导，$\\mathbf{K}$ 是零矩阵。质量矩阵 $\\mathbf{M}$ 的元素为 $M_{ij} = \\int_{0}^{L} \\phi_i \\phi_j \\,\\mathrm{d}x$。由于基函数 $\\{\\phi_i\\}$ 是线性无关的，质量矩阵 $\\mathbf{M}$ 是对称正定的。\n\n特征问题 $0 = \\lambda \\mathbf{M}\\mathbf{c}$ 意味着对于任何非零特征向量 $\\mathbf{c}$，我们必须有 $\\lambda = 0$。由于这对 $(n+1)$ 维空间中的任何向量都成立，整个空间 $V_h$ 都是对应于特征值 $\\lambda=0$ 的特征空间。这意味着离散化产生了 $\\dim(V_h) = n+1$ 个伪模式，其特征值均为零。\n\n### 第二部分：零均值规范约束的效果\n\n引入一个规范约束：\n$$\n\\int_{0}^{L} w_{h}(x)\\,\\mathrm{d}x = 0\n$$\n我们定义一个新空间 $V_h^0 = \\{w_h \\in V_h \\mid \\int_{0}^{L} w_{h}(x)\\,\\mathrm{d}x = 0\\}$。$V_h$ 中的任何函数 $w_h$ 都可以表示为基函数 $\\phi_i$ 的线性组合（$i=0, 1, \\dots, n$）：$w_h(x) = \\sum_{i=0}^{n} c_i \\phi_i(x)$。该约束在系数 $c_i$ 上变成一个单一的线性方程：\n$$\n\\sum_{i=0}^{n} c_i \\left( \\int_{0}^{L} \\phi_i(x)\\,\\mathrm{d}x \\right) = 0\n$$\n由于标准的拉格朗日“帽子”基函数是非负且不恒为零的，它们的积分是正的。这是一个施加在 $(n+1)$ 维系数空间上的非平凡线性约束。一个线性约束会将向量空间的维度精确地减少一。因此，约束后空间的维度是：\n$$\n\\dim(V_h^0) = \\dim(V_h) - 1 = (n+1) - 1 = n\n$$\n现在特征问题是在这个较小的空间上提出的：寻找 $(\\lambda, w_h) \\in (\\mathbb{R}, V_h^0)$ 使得对所有 $v_h \\in V_h^0$ 都有 $a(w_h, v_h) = \\lambda \\int_0^L w_h v_h \\,dx$。\n$a(w_h, v_h) = 0$ 的基本性质不受函数积分约束的影响。它对 $V_h^0 \\subset V_h$ 中的所有函数仍然成立。因此，在约束空间上的特征问题仍然是\n$$\n0 = \\lambda \\int_{0}^{L} w_h(x) v_h(x) \\,\\mathrm{d}x\n$$\n对所有 $v_h \\in V_h^0$ 成立。对于任何非零特征函数 $w_h \\in V_h^0$，特征值 $\\lambda$ 必须为零。整个 $n$ 维空间 $V_h^0$ 都是 $\\lambda=0$ 的特征空间。该约束移除了一个伪模式，但仍剩下 $n$ 个伪模式。这明确地将伪特征空间刻画为零均值、连续、分段线性的函数空间，其维度为 $n$。\n\n### 第三部分：通过边元抑制伪模式\n\n在更高维度（2D 和 3D）中，问题的根源在于某些有限元空间无法正确表示旋度算子的零空间。平方可积且旋度也平方可积的矢量场空间记为 $H(\\mathrm{curl},\\Omega)$。在连续设定下，旋度算子的零空间恰好是梯度场集合：$\\{\\mathbf{u} \\in L^2(\\Omega) \\mid \\nabla \\times \\mathbf{u} = \\mathbf{0}\\} = \\{\\nabla \\phi \\mid \\phi \\in H^1(\\Omega)\\}$。\n\n当使用**节点元**离散化矢量场 $\\mathbf{E}$ 时，通常会将矢量值的自由度分配给网格的节点。得到的有限元空间，我们称之为 $\\mathbf{V}_h^{\\text{nodal}}$，包含一个庞大的离散梯度子空间，即形如 $\\nabla \\phi_h$ 的场，其中 $\\phi_h$ 是一个标准的标量（如拉格朗日）有限元函数。然而，对于一个一般的 $\\mathbf{v}_h \\in \\mathbf{V}_h^{\\text{nodal}}$，性质 $\\nabla \\times (\\nabla \\phi_h) = \\mathbf{0}$ 在离散层面不被保持，意味着离散梯度的离散旋度不一定为零。元素为 $K_{ij} = \\int_{\\Omega} (\\nabla \\times \\mathbf{v}_i) \\cdot (\\nabla \\times \\mathbf{v}_j) \\,d\\mathbf{x}$ 的刚度矩阵 $\\mathbf{K}$ 会获得一个庞大的、数值近似的零空间，该零空间与真实的解析零空间不能精确对应。这种不匹配会用非物理的伪模式污染计算出的谱。\n\n**边元**（例如，第一类 Nédélec 元）是为避免此问题而专门设计的。其自由度不是节点值，而是矢量场沿网格单元边缘的切向分量。这种构造确保了场的切向分量在单元界面上是连续的，这正是 $H(\\mathrm{curl},\\Omega)$ 中场需要满足的连续性要求。得到的有限元空间，我们称之为 $\\mathbf{V}_h^{\\text{edge}}$，拥有一个关键性质，通常用一个通勤图来表示。这个性质是有限元外微分 (FEEC) 的基础，它确保了离散梯度的离散旋度精确为零。也就是说，如果取一个标量拉格朗日空间 $S_h$ 和 Nédélec 边元空间 $\\mathbf{V}_h^{\\text{edge}}$，则：\n$$\n\\nabla \\times (\\nabla \\phi_h) = \\mathbf{0} \\quad \\text{对所有 } \\phi_h \\in S_h\n$$\n这意味着 $\\mathbf{V}_h^{\\text{edge}}$ 内的离散旋度零空间恰好是离散梯度空间 $\\{\\nabla\\phi_h \\mid \\phi_h \\in S_h\\}$。这个性质，通常被称为构造一个稳定且适定的余链复形，确保了离散刚度算子的核空间与算子谱的其余部分被清晰地分离开来。与这些单元相关的“离散紧致性性质”保证了对谱的非零部分的近似是收敛的，并且没有伪模式。与梯度场对应的零特征值模式被正确地捕捉，并且不会污染具有物理意义的正特征值。\n\n### 第四部分：建议的测试方案\n\n以下是两种科学合理的测试方案，用于在计算电磁学的有限元代码中检测和量化伪模式。\n\n**1. 规范腔谐振测试**\n- **原理**：此测试将数值结果与已知的解析解进行比较。带有理想电导体 (PEC) 壁的矩形（或长方体）腔是一个理想的候选对象，因为其谐振频率和模式结构（TE 和 TM）都是精确已知的。\n- **实施**：\n    1.  对一个尺寸为 $a \\times b$ 的二维矩形腔或尺寸为 $a \\times b \\times c$ 的三维长方体腔进行建模。在所有壁上施加 PEC 边界条件（$\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$）。\n    2.  使用有限元代码计算最低的，例如 20-50 个特征对 $(\\kappa_i^2, \\mathbf{E}_i)$。\n    3.  解析上，特征值由 $\\kappa^2_{mnp} = (\\frac{m\\pi}{a})^2 + (\\frac{n\\pi}{b})^2 + (\\frac{p\\pi}{c})^2$ 给出，其中 $m,n,p$ 是定义模式阶数的整数（对 TE/TM 族有适当的限制）。\n- **检测与量化**：伪模式可以通过两种方式识别：\n    a.  **谱污染**：计算出的特征值列表中将包含与任何解析 $\\kappa^2_{mnp}$ 值都不匹配的值。这些就是伪模式。\n    b.  **零空间维度**：一个行为良好的离散化方法（如使用边元）将产生一簇对应于梯度场的零特征值，与正的物理特征值清晰分离。不当的离散化方法（如使用节点元）将产生数量大得多的零或近零特征值。可以计算这些模式的数量，并与离散梯度空间的理论维度进行比较，对于节点元，该维度约等于内部网格节点的数量。\n\n**2. 散度检查测试**\n- **原理**：此测试利用了特征模式的一个物理性质。在无源区域（$\\rho=0$）中，麦克斯韦方程要求物理电场模式是无散的：$\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0$。由不正确处理梯度零空间而产生的伪模式通常会显著违反这一条件。\n- **实施**：\n    1.  对任何合理的腔体几何形状（测试 1 中的规范腔就适用）求解特征问题。\n    2.  对每个计算出的特征模式 $\\mathbf{E}_i$，计算其散度的 $L^2$-范数：$D_i = ||\\nabla \\cdot \\mathbf{E}_i||_{L^2} = (\\int_{\\Omega} |\\nabla \\cdot \\mathbf{E}_i|^2 \\,d\\mathbf{x})^{1/2}$。注意，散度应在单元内部计算，因为 $H(\\mathrm{curl})$ 中的场不一定具有全局定义的平方可积散度。\n    3.  绘制计算出的特征值 $\\kappa_i^2$ 与其对应的散度范数 $D_i$ 的关系图。\n- **检测与量化**：得到的散点图通常会显示两个不同的群体：\n    a.  **物理模式**：这些点将表现为具有正特征值 $(\\kappa_i^2 > 0)$ 和非常小的散度范数 $(D_i \\approx 0)$。\n    b.  **伪模式**：这些点将表现为具有大散度范数 $(D_i \\gg 0)$。它们对应的特征值可能是零或非零，从而污染整个谱。\n    从业者可以设定一个散度阈值，以编程方式识别和计数伪模式，从而量化求解器和离散化选择的质量。\n\n### 最终计算\n\n问题要求在施加单个零均值规范约束后，由错误离散化的 TM 代理在空间 $V_h$ 上产生的伪零特征值模式的数量，具体情况为网格包含 $n=5$ 个子区间。\n\n如第二部分所证：\n1.  在包含 $n$ 个单元的网格上，无边界条件的连续分段线性函数初始空间 $V_h$ 的维度为 $n+1$。\n2.  双线性形式 $a(w_h, v_h)$ 在此空间中对所有函数恒为零，意味着每个非零函数都是特征值为 $\\lambda=0$ 的特征向量。伪模式的初始数量为 $n+1$。\n3.  单个规范约束 $\\int_0^L w_h(x) dx = 0$ 是一个非平凡的线性约束，它将空间的维度减少了 1。\n4.  剩余伪模式的数量是约束后空间的维度，即 $(n+1) - 1 = n$。\n\n给定参数 $n = 5$：\n伪零特征值模式的数量为 $n=5$。",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "在理解了伪模式的来源后，一个关键问题是如何在数值上消除它们。本练习将引导您探索一种精确且优雅的解决方法：构造一个离散螺线管投影算子，它能将任意离散电场分解并滤除其无物理意义的梯度分量。掌握此方法对于确保计算结果的物理真实性和开发高保真度的电磁仿真工具至关重要。",
            "id": "3350420",
            "problem": "考虑在一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$ 中，关于电场的无源时谐 Maxwell 特征值问题，其边界条件为理想电导体 (PEC)，即在 $\\partial \\Omega$ 上 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$。材料张量假定为各向同性且分片光滑，具有标量介电常数 $\\epsilon(\\mathbf{x}) > 0$ 和标量磁导率 $\\mu(\\mathbf{x}) > 0$。\n\n连续特征值问题旨在寻找非平凡解 $\\mathbf{E} \\in \\mathbf{H}_0(\\mathrm{curl}, \\Omega)$ 和 $\\omega^2 \\in \\mathbb{R}_+$，使得\n$$\n\\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) = \\omega^2 \\epsilon \\mathbf{E},\n$$\n并且，在无源情况下，模式满足 Gauss 定理\n$$\n\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0 \\quad \\text{in } \\Omega.\n$$\n在对 $\\mathbf{E}$ 使用 Nédélec (边) 单元的实际有限元计算中，由于对任何标量 $\\phi$ 都有 $\\nabla \\times (\\nabla \\phi) = \\mathbf{0}$，伪梯度模式会污染谱。一个常见的补救方法是构造一个离散螺线投影算子 $P_s$，它从给定的离散场 $\\mathbf{E}_h \\in \\mathbf{W}_h \\subset \\mathbf{H}_0(\\mathrm{curl}, \\Omega)$ 中移除梯度分量，并生成 $P_s \\mathbf{E}_h$，使其在适当的内积下与所有离散梯度正交，并与边界条件兼容。\n\n设 $\\mathbf{W}_h$ 是一个强制施加 PEC 切向条件的协调的第一类 Nédélec 空间，设 $V_h \\subset H^1_0(\\Omega)$ 是一个具有齐次 Dirichlet 边界条件的协调的 Lagrange 节点空间。目标是通过一个适定的变分问题定义 $\\phi_h \\in V_h$，使得投影算子 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$ 生成一个在物理上有意义的内积下与离散梯度子空间正交的场，并保持 PEC 切向边界条件。\n\n对于非均匀的 $\\epsilon(\\mathbf{x})$，哪个选项正确地指定了计算离散螺线投影算子 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$ 所需的 $\\phi_h$ 的变分问题和边界条件，该算子强制施加无源约束 $\\nabla \\cdot (\\epsilon \\, P_s \\mathbf{E}_h) = 0$ 并维持在 $\\partial \\Omega$ 上的 $\\mathbf{n} \\times P_s \\mathbf{E}_h = \\mathbf{0}$？\n\nA. 求解加权 Poisson 问题：寻找 $\\phi_h \\in V_h$，在 $\\partial \\Omega$ 上 $\\phi_h = 0$，使得对于所有 $v_h \\in V_h$，\n$$\n\\int_{\\Omega} \\epsilon \\, \\nabla \\phi_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\epsilon \\, \\mathbf{E}_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x},\n$$\n并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。\n\nB. 对 $\\phi_h$ 施加齐次 Neumann 边界条件以避免改变边界处的法向分量：寻找 $\\phi_h \\in H^1(\\Omega)$，在 $\\partial \\Omega$ 上 $\\partial \\phi_h / \\partial n = 0$，使得对于所有 $v_h \\in H^1(\\Omega)$，\n$$\n\\int_{\\Omega} \\nabla \\phi_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\mathbf{E}_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x},\n$$\n并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。\n\nC. 不论 $\\epsilon$ 如何，求解非加权 Poisson 问题：寻找 $\\phi_h \\in V_h$，在 $\\partial \\Omega$ 上 $\\phi_h = 0$，使得对于所有 $v_h \\in V_h$，\n$$\n\\int_{\\Omega} \\nabla \\phi_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\mathbf{E}_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x},\n$$\n并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。\n\nD. 使用旋度-旋度加权投影以消除无旋分量：寻找 $\\phi_h \\in V_h$，使得对于所有 $v_h \\in V_h$，\n$$\n\\int_{\\Omega} \\mu^{-1} \\, \\left(\\nabla \\times \\nabla \\phi_h\\right) \\cdot \\left(\\nabla \\times \\nabla v_h\\right) \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\mu^{-1} \\, \\left(\\nabla \\times \\mathbf{E}_h\\right) \\cdot \\left(\\nabla \\times \\nabla v_h\\right) \\, \\mathrm{d}\\mathbf{x},\n$$\n并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。\n\nE. 投影电荷密度并求解标量质量方程：寻找 $\\phi_h \\in V_h$，在 $\\partial \\Omega$ 上 $\\phi_h = 0$，使得对于所有 $v_h \\in V_h$，\n$$\n\\int_{\\Omega} \\epsilon \\, \\phi_h \\, v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\nabla \\cdot (\\epsilon \\mathbf{E}_h) \\, v_h \\, \\mathrm{d}\\mathbf{x},\n$$\n并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。\n\n选择唯一的最佳选项。",
            "solution": "### 步骤1：提取已知条件\n-   **问题域**：一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$ 中的无源时谐 Maxwell 特征值问题。\n-   **边界条件**：理想电导体 (PEC)，在 $\\partial \\Omega$ 上 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$。\n-   **材料属性**：各向同性、分片光滑的标量介电常数 $\\epsilon(\\mathbf{x}) > 0$ 和磁导率 $\\mu(\\mathbf{x}) > 0$。\n-   **连续特征值问题**：寻找非平凡解 $\\mathbf{E} \\in \\mathbf{H}_0(\\mathrm{curl}, \\Omega)$ 和 $\\omega^2 \\in \\mathbb{R}_+$ 使得 $\\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) = \\omega^2 \\epsilon \\mathbf{E}$。\n-   **连续约束**：对于无源模式，在 $\\Omega$ 中 $\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0$。\n-   **离散化**：对电场 $\\mathbf{E}$ 使用 Nédélec (边) 单元的有限元方法。\n-   **离散空间**：\n    -   $\\mathbf{W}_h \\subset \\mathbf{H}_0(\\mathrm{curl}, \\Omega)$：用于电场 $\\mathbf{E}_h$ 的协调的第一类 Nédélec 空间。包含在 $\\mathbf{H}_0(\\mathrm{curl}, \\Omega)$ 中意味着在 $\\partial \\Omega$ 上强制施加了 $\\mathbf{n} \\times \\mathbf{E}_h = \\mathbf{0}$。\n    -   $V_h \\subset H^1_0(\\Omega)$：用于标量势 $\\phi_h$ 的协调的 Lagrange 节点空间。包含在 $H^1_0(\\Omega)$ 中意味着在 $\\partial \\Omega$ 上 $\\phi_h = 0$。\n-   **目标**：通过 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$ 定义一个离散螺线投影算子 $P_s$。\n-   **投影场的所需性质**：\n    1.  $P_s \\mathbf{E}_h$ 在一个物理上有意义的内积下与离散梯度子空间正交。\n    2.  $\\nabla \\cdot (\\epsilon \\, P_s \\mathbf{E}_h) = 0$（在离散/弱形式意义下）。\n    3.  在 $\\partial \\Omega$ 上 $\\mathbf{n} \\times P_s \\mathbf{E}_h = \\mathbf{0}$。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述描述了 Maxwell 特征值问题有限元分析中的一个标准且众所周知的问题：伪的、非物理模式的出现。这些模式对应于旋度算子的无穷维核，该核由梯度场构成。提出的补救方法——将离散解投影到离散无散子空间上——是一种常用且严谨的技术，称为散度清理或规范固定。\n\n-   **科学依据**：该公式基于 Maxwell 方程组，并使用了泛函分析中的标准函数空间（$\\mathbf{H}(\\mathrm{curl}, \\Omega)$, $H^1(\\Omega)$）和离散化方案（Nédélec 和 Lagrange 单元），这些都是计算电磁学的基础。该问题牢固地建立在公认的科学和数学原理之上。\n-   **适定性**：该问题是适定的。它要求在一个离散设置下 Helmholtz-Hodge 型分解的具体变分形式。所有必要信息（函数空间、所需性质、物理背景）都已提供，以推导出唯一、正确的公式。\n-   **客观性**：语言精确、技术性强，没有歧义或主观论断。\n\n问题陈述是有效的。这是高等计算电磁学中的一个标准问题。\n\n### 步骤3：求解推导\n目标是为标量势 $\\phi_h \\in V_h$ 找到一个变分问题，使得投影场 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$ 满足所需性质。\n\n**1. 边界条件的保持**\n我们必须确保 PEC 边界条件在投影后得以保持。\n初始场 $\\mathbf{E}_h$ 属于 $\\mathbf{W}_h \\subset \\mathbf{H}_0(\\mathrm{curl}, \\Omega)$，因此它已经在 $\\partial \\Omega$ 上满足 $\\mathbf{n} \\times \\mathbf{E}_h = \\mathbf{0}$。\n投影场也必须满足此条件：\n$$ \\mathbf{n} \\times P_s \\mathbf{E}_h = \\mathbf{n} \\times (\\mathbf{E}_h - \\nabla \\phi_h) = \\mathbf{n} \\times \\mathbf{E}_h - \\mathbf{n} \\times \\nabla \\phi_h = \\mathbf{0} $$\n由于 $\\mathbf{n} \\times \\mathbf{E}_h = \\mathbf{0}$，此条件简化为：\n$$ \\mathbf{n} \\times \\nabla \\phi_h = \\mathbf{0} \\quad \\text{on } \\partial \\Omega $$\n$\\mathbf{n} \\times \\nabla \\phi_h$ 项表示 $\\phi_h$ 在边界 $\\partial \\Omega$ 上的曲面梯度。条件 $\\mathbf{n} \\times \\nabla \\phi_h = \\mathbf{0}$ 意味着 $\\phi_h$ 在边界 $\\partial \\Omega$ 的每个连通分量上必须是常数。\n问题指定势的空间为 $V_h \\subset H^1_0(\\Omega)$。$H^1_0(\\Omega)$ 中的函数在边界上的迹为零，即在 $\\partial \\Omega$ 上 $\\phi_h = 0$。一个在边界上为零的函数必然在边界上是常数（常数值为 0）。因此，选择空间 $V_h$ 能正确地强制保持 PEC 边界条件。\n\n**2. 无源约束的施加**\n物理上的无源条件是电场 Gauss 定理：$\\nabla \\cdot \\mathbf{D} = 0$，其中 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 是电位移场。因此，我们必须强制施加 $\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0$。\n对于投影场，这转化为条件 $\\nabla \\cdot (\\epsilon \\, P_s \\mathbf{E}_h) = 0$。\n代入投影算子的定义，我们得到：\n$$ \\nabla \\cdot (\\epsilon (\\mathbf{E}_h - \\nabla \\phi_h)) = 0 $$\n为了得到变分（或弱）形式，我们乘以一个检验函数 $v_h \\in V_h$ 并在域 $\\Omega$ 上积分：\n$$ \\int_{\\Omega} v_h \\left[ \\nabla \\cdot (\\epsilon (\\mathbf{E}_h - \\nabla \\phi_h)) \\right] \\, \\mathrm{d}\\mathbf{x} = 0 \\quad \\forall v_h \\in V_h $$\n我们应用分部积分（Green 第一恒等式），即 $\\int_\\Omega u (\\nabla \\cdot \\mathbf{F}) \\, \\mathrm{d}\\mathbf{x} = \\int_{\\partial\\Omega} u (\\mathbf{F} \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_\\Omega \\nabla u \\cdot \\mathbf{F} \\, \\mathrm{d}\\mathbf{x}$。\n令 $u = v_h$ 且 $\\mathbf{F} = \\epsilon (\\mathbf{E}_h - \\nabla \\phi_h)$。边界积分项 $\\int_{\\partial\\Omega} v_h (\\dots) \\, \\mathrm{d}S$ 为零，因为 $v_h \\in V_h \\subset H^1_0(\\Omega)$，这意味着在 $\\partial \\Omega$ 上 $v_h = 0$。\n因此，弱形式变为：\n$$ - \\int_{\\Omega} \\nabla v_h \\cdot \\left[ \\epsilon (\\mathbf{E}_h - \\nabla \\phi_h) \\right] \\, \\mathrm{d}\\mathbf{x} = 0 $$\n去掉负号并展开点积：\n$$ \\int_{\\Omega} \\epsilon \\, \\nabla v_h \\cdot \\mathbf{E}_h \\ - \\ \\epsilon \\, \\nabla v_h \\cdot \\nabla \\phi_h \\, \\mathrm{d}\\mathbf{x} = 0 $$\n将未知量 $\\phi_h$ 移到左侧，我们得到最终的变分问题：寻找 $\\phi_h \\in V_h$ 使得对于所有 $v_h \\in V_h$：\n$$ \\int_{\\Omega} \\epsilon \\, \\nabla \\phi_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\epsilon \\, \\mathbf{E}_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x} $$\n这是一个关于 $\\phi_h$ 的标准加权 Poisson 问题，其齐次 Dirichlet 边界条件继承自空间 $V_h$。由于 $\\epsilon(\\mathbf{x}) > 0$，左侧的双线性形式在 $H^1_0(\\Omega)$ 上是矫顽的，根据 Lax-Milgram 定理保证了唯一解的存在。此过程构成了关于梯度 $\\epsilon$-加权内积的正交投影。\n\n### 选项评估\n\n**A. 求解加权 Poisson 问题：寻找 $\\phi_h \\in V_h$，在 $\\partial \\Omega$ 上 $\\phi_h = 0$，使得对于所有 $v_h \\in V_h$，$\\int_{\\Omega} \\epsilon \\, \\nabla \\phi_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\epsilon \\, \\mathbf{E}_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x}$，并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。**\n此公式与我们的推导完全匹配。它使用了正确的函数空间 $V_h \\subset H^1_0(\\Omega)$，该空间保持了 PEC 边界条件。它使用了 $\\epsilon$-加权内积，正确地强制施加了 $\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0$ 的弱形式。\n**结论：正确。**\n\n**B. 对 $\\phi_h$ 施加齐次 Neumann 边界条件以避免改变边界处的法向分量：寻找 $\\phi_h \\in H^1(\\Omega)$，在 $\\partial \\Omega$ 上 $\\partial \\phi_h / \\partial n = 0$，使得对于所有 $v_h \\in H^1(\\Omega)$，$\\int_{\\Omega} \\nabla \\phi_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\mathbf{E}_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x}$，并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。**\n此选项不正确，原因有二。首先，齐次 Neumann 条件 $\\partial \\phi_h / \\partial n = 0$ 不能保证 $\\mathbf{n} \\times \\nabla \\phi_h = \\mathbf{0}$，因此未能保持 PEC 边界条件。其次，它使用了非加权内积（缺少 $\\epsilon$），这将强制施加 $\\nabla \\cdot \\mathbf{E} = 0$，而不是对于非均匀介质物理上正确的 $\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0$。\n**结论：不正确。**\n\n**C. 不论 $\\epsilon$ 如何，求解非加权 Poisson 问题：寻找 $\\phi_h \\in V_h$，在 $\\partial \\Omega$ 上 $\\phi_h = 0$，使得对于所有 $v_h \\in V_h$，$\\int_{\\Omega} \\nabla \\phi_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\mathbf{E}_h \\cdot \\nabla v_h \\, \\mathrm{d}\\mathbf{x}$，并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。**\n此选项为 $\\phi_h$ 使用了正确的函数空间 $V_h$，因此边界条件得以保持。但是，与选项 B 一样，它使用了非加权内积。这对应于弱形式强制施加 $\\nabla \\cdot (\\mathbf{E}_h - \\nabla \\phi_h) = 0$，而不是 $\\nabla \\cdot (\\epsilon (\\mathbf{E}_h - \\nabla \\phi_h)) = 0$。这仅在 $\\epsilon$ 是常数时才有效，但问题处理的是非均匀的 $\\epsilon(\\mathbf{x})$。\n**结论：不正确。**\n\n**D. 使用旋度-旋度加权投影以消除无旋分量：寻找 $\\phi_h \\in V_h$，使得对于所有 $v_h \\in V_h$，$\\int_{\\Omega} \\mu^{-1} \\, \\left(\\nabla \\times \\nabla \\phi_h\\right) \\cdot \\left(\\nabla \\times \\nabla v_h\\right) \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\mu^{-1} \\, \\left(\\nabla \\times \\mathbf{E}_h\\right) \\cdot \\left(\\nabla \\times \\nabla v_h\\right) \\, \\mathrm{d}\\mathbf{x}$，并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。**\n此公式是无意义的。根据向量微积分恒等式 $\\nabla \\times (\\nabla \\phi) = \\mathbf{0}$（对于任何足够正则的标量场 $\\phi$），方程左右两边的被积函数都恒等于零。该方程简化为 $0 = 0$，并未定义任何关于 $\\phi_h$ 的问题。\n**结论：不正确。**\n\n**E. 投影电荷密度并求解标量质量方程：寻找 $\\phi_h \\in V_h$，在 $\\partial \\Omega$ 上 $\\phi_h = 0$，使得对于所有 $v_h \\in V_h$，$\\int_{\\Omega} \\epsilon \\, \\phi_h \\, v_h \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\nabla \\cdot (\\epsilon \\mathbf{E}_h) \\, v_h \\, \\mathrm{d}\\mathbf{x}$，并设置 $P_s \\mathbf{E}_h = \\mathbf{E}_h - \\nabla \\phi_h$。**\n此选项提出了代数方程 $\\epsilon \\phi_h = \\nabla \\cdot (\\epsilon \\mathbf{E}_h)$ 的弱形式。正确的步骤源于 Poisson 型方程 $\\nabla \\cdot (\\epsilon \\nabla \\phi_h) = \\nabla \\cdot (\\epsilon \\mathbf{E}_h)$。如推导所示，正确的 Poisson 方程的弱形式涉及刚度矩阵（梯度的乘积的积分），而不是质量矩阵（函数的乘积的积分）。此公式不正确。此外，直接计算 $\\nabla \\cdot (\\epsilon \\mathbf{E}_h)$ 是不可取的；选项 A 中的公式通过使用分部积分避免了这一点。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然投影法在理论上是完美的，但在实践中，惩罚法提供了一种更灵活、更容易实施的替代方案来抑制伪模式。本练习通过一个简化的代数模型，让您能够量化研究惩罚参数 $\\alpha$ 的选择所带来的影响——即在有效抑制伪模式和不可避免地干扰真实物理模式之间取得平衡。通过这个计算实践，您将深入理解在实际工程应用中进行参数调优的权衡与策略。",
            "id": "3350403",
            "problem": "考虑在一个具有理想导电边界条件的有界域中的无源频域麦克斯韦特征值问题，用电场表述如下：求非平凡场 $\\mathbf{E}$ 和频率 $\\omega$，使得\n$$\n\\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) = \\omega^2 \\, \\epsilon \\, \\mathbf{E}, \\quad \\text{其中} \\quad \\nabla \\cdot (\\epsilon \\mathbf{E}) = 0,\n$$\n其中 $\\epsilon$ 是介电常数，$\\mu$ 是磁导率。在那些不精确施加无散约束 $\\nabla \\cdot (\\epsilon \\mathbf{E})=0$ 的有限元离散化中，伪模会污染谱，除非该约束被精确施加（例如，通过拉格朗日乘子或投影到无散子空间）或通过在双线性形式中添加罚项来弱施加：\n$$\na_{\\alpha}(\\mathbf{E}_h, \\mathbf{v}_h) = \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\mathbf{E}_h\\right)\\cdot\\left(\\nabla \\times \\mathbf{v}_h\\right) \\, d\\Omega + \\alpha \\int_{\\Omega} \\left(\\nabla \\cdot (\\epsilon \\mathbf{E}_h)\\right)\\left(\\nabla \\cdot (\\epsilon \\mathbf{v}_h)\\right) \\, d\\Omega,\n$$\n其中 $\\alpha>0$ 是罚因子，$\\mathbf{E}_h, \\mathbf{v}_h$ 是有限元试探场和检验场。罚项修改了离散算子并扰动了真实特征值。一个核心的前沿问题是，量化真实特征值的扰动作为 $\\alpha$、网格尺寸 $h$ 和多项式次数 $p$ 的函数，并提出和检验一个关于 $\\alpha$ 的 $h$–$p$ 标度律，该标度律能在渐近抑制伪模的同时，最小化对物理特征值的扰动。\n\n为使此问题在计算上具体且普适可实现，考虑以下有基本原理的块结构离散模型，该模型捕捉了物理（无散）子空间和伪（梯度）子空间之间的相互作用。设离散场空间分解为维数为 $n_{\\mathrm{phys}}$ 的物理子空间和维数为 $n_{\\mathrm{grad}}$ 的梯度子空间的直和。定义对称块算子\n$$\n\\mathbf{A}_{\\alpha}(h,p) = \n\\begin{bmatrix}\n\\mathbf{\\Lambda}  \\beta(h,p)\\,\\mathbf{C} \\\\\n\\beta(h,p)\\,\\mathbf{C}^{\\top}  \\alpha \\mathbf{I}_{n_{\\mathrm{grad}}}\n\\end{bmatrix},\n$$\n其中：\n- $\\mathbf{\\Lambda} \\in \\mathbb{R}^{n_{\\mathrm{phys}} \\times n_{\\mathrm{phys}}}$ 是对角矩阵，其对角线元素为真实的物理特征值 $\\lambda_1, \\ldots, \\lambda_{n_{\\mathrm{phys}}}$，\n- $\\mathbf{C} \\in \\mathbb{R}^{n_{\\mathrm{phys}} \\times n_{\\mathrm{grad}}}$ 模拟了由离散化引起的物理分量和伪分量之间的耦合，\n- $\\beta(h,p)$ 表征了物理-伪耦合的大小，是网格尺寸 $h$ 和多项式次数 $p$ 的函数，\n- $\\alpha>0$ 是罚因子，$\\mathbf{I}_{n_{\\mathrm{grad}}}$ 是梯度子空间中的单位矩阵。\n\n在精确施加约束的情况下，算子简化为对物理子空间的限制，\n$$\n\\mathbf{A}_{\\mathrm{exact}} = \\mathbf{\\Lambda},\n$$\n其特征值恰好是 $\\lambda_1,\\ldots,\\lambda_{n_{\\mathrm{phys}}}$。在采用有限 $\\alpha$ 的罚方法下，物理特征值受到非对角耦合 $\\beta(h,p)\\,\\mathbf{C}$ 的扰动。\n\n为本问题之目的，取：\n- $n_{\\mathrm{phys}}=6$ 和 $n_{\\mathrm{grad}}=4$，\n- $\\mathbf{\\Lambda} = \\mathrm{diag}\\left(\\lambda_1,\\ldots,\\lambda_6\\right)$，其中 $\\lambda_k = \\pi^2 \\cdot s_k$ 且 $(s_1,\\ldots,s_6) = (2,5,8,10,13,17)$，\n- $\\mathbf{C}$ 为一个 $6\\times 4$ 矩阵，其前四个对角元素为1，其余元素为0（即，对于 $i=1,2,3,4$，$C_{ii}=1$，否则为0），\n- $\\beta(h,p) = \\dfrac{h^p}{p}$。\n\n令 $\\lambda_k^{\\alpha}(h,p)$ 表示 $\\mathbf{A}_{\\alpha}(h,p)$ 的前 $n_{\\mathrm{phys}}$ 个按非递减顺序排序的特征值，并定义由罚方法施加引起的真实物理特征值的相对扰动为\n$$\n\\delta(h,p,\\alpha) = \\max_{1\\le k\\le n_{\\mathrm{phys}}} \\left| \\frac{\\lambda_k^{\\alpha}(h,p) - \\lambda_k}{\\lambda_k} \\right|.\n$$\n\n任务：\n1. 实现上述块结构模型算子，并为给定的 $(h,p,\\alpha)$ 计算受扰动的特征值。\n2. 对以下测试套件中的每个案例，量化其最大相对扰动 $\\delta(h,p,\\alpha)$。\n3. 提出一个最优标度律 $\\alpha_{\\mathrm{opt}}(h,p)$，它能在抑制伪耦合的同时控制特征值的扰动。使用涉及近似性质和逆不等式的第一性原理推导来证明你的提议。将你提出的定律实现为 $\\alpha_{\\mathrm{opt}}(h,p) = c \\, \\dfrac{p^2}{h^2}$（其中 $c=1$），并对每个测试案例，也计算 $\\delta\\big(h,p,\\alpha_{\\mathrm{opt}}(h,p)\\big)$。\n\n使用以下参数值测试套件，它涵盖了代表性、边界和边缘场景：\n- 案例1（理想情况，中等网格，低阶，弱罚项）：$(h,p,\\alpha) = (0.5,\\,1,\\,0.1)$，\n- 案例2（中等加密网格，中等阶，未遵循建议标度律的中等罚项）：$(h,p,\\alpha) = (0.25,\\,2,\\,1.0)$，\n- 案例3（加密网格，高阶，强罚项）：$(h,p,\\alpha) = (0.125,\\,3,\\,100.0)$。\n\n你的程序应为每个案例计算两个浮点数：\n- 给定 $\\alpha$ 时的最大相对扰动 $\\delta(h,p,\\alpha)$，\n- 采用建议标度律时的最大相对扰动 $\\delta\\big(h,p,\\alpha_{\\mathrm{opt}}(h,p)\\big)$，\n\n并生成一行输出，其中包含按顺序\n$$\n\\big[\\delta(h_1,p_1,\\alpha_1), \\delta(h_1,p_1,\\alpha_{\\mathrm{opt},1}), \\delta(h_2,p_2,\\alpha_2), \\delta(h_2,p_2,\\alpha_{\\mathrm{opt},2}), \\delta(h_3,p_3,\\alpha_3), \\delta(h_3,p_3,\\alpha_{\\mathrm{opt},3})\\big],\n$$\n汇集在一个用方括号括起来的逗号分隔列表中的这六个结果，其中 $\\alpha_{\\mathrm{opt},i} = \\alpha_{\\mathrm{opt}}(h_i,p_i)$。最终的数值输出是无量纲浮点数。不需要物理单位，也不涉及角度或百分比。程序必须是完整且可直接运行的，无需任何外部输入或文件，并且必须严格遵循指定的输出格式。",
            "solution": "所提出的问题是对计算电磁学中用于有限元分析的一项基本技术的适定且科学上合理的探究。该问题关注的是，当电场的无散约束未被严格施加时，对麦克斯韦特征值问题离散化所产生的非物理（或称“伪”）解的抑制。所提出的罚方法，即增加一个与场的散度平方成正比的项，是缓解此问题的标准方法。该问题提供了一个简化但概念上正确的块矩阵模型 $\\mathbf{A}_{\\alpha}(h,p)$，它捕捉了物理（无散）子空间和伪（梯度）子空间之间的本质相互作用。该模型允许对罚参数 $\\alpha$ 对计算出的特征值的影响进行集中分析。唯一数值解所需的所有参数和定义均已提供，问题没有矛盾或歧义。这是一个有效且富有洞察力的计算练习。\n\n问题的核心是理解在选择罚参数 $\\alpha$ 时的权衡。如果 $\\alpha$ 太小，伪模没有得到充分的惩罚，其对应的特征值可能出现在物理谱的范围内，从而破坏解。如果 $\\alpha$ 太大，罚项会过度扰动物理模式，导致物理特征值不准确。目标是找到一个关于离散化参数——网格尺寸 $h$ 和多项式次数 $p$——的 $\\alpha$ 的标度关系，以最优地平衡这些相互竞争的效应。\n\n问题要求提出一个关于 $\\alpha$ 的标度律并给出其理由。一个有原则的选择可以从有限元离散化的性质中推导出来。带罚项的弱形式是：\n$$\na_{\\alpha}(\\mathbf{E}_h, \\mathbf{v}_h) = \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\mathbf{E}_h\\right)\\cdot\\left(\\nabla \\times \\mathbf{v}_h\\right) \\, d\\Omega + \\alpha \\int_{\\Omega} \\left(\\nabla \\cdot (\\epsilon \\mathbf{E}_h)\\right)\\left(\\nabla \\cdot (\\epsilon \\mathbf{v}_h)\\right) \\, d\\Omega\n$$\n第一项，即旋度-旋度项，对应一个二阶微分算子。在离散设置中，相应矩阵的特征值大致按 $(p/h)^2$ 标度。罚项 $\\alpha \\int_{\\Omega} (\\nabla\\cdot\\mathbf{E}_h)^2 \\, d\\Omega$ 旨在施加 $\\nabla\\cdot\\mathbf{E}_h \\approx 0$。设置罚参数的一种常见启发式方法是平衡算子范数。来自有限元理论的“逆不等式”指出，对于离散空间中的函数 $\\mathbf{v}_h$，其导数的范数由函数自身的范数乘以一个依赖于 $h$ 和 $p$ 的因子所界定，例如 $\\|\\nabla \\cdot \\mathbf{v}_h\\|_{L^2} \\le C \\frac{p}{h} \\|\\mathbf{v}_h\\|_{L^2}$。罚项对刚度矩阵的贡献涉及此导数，为确保其相对于质量矩阵（来自特征值问题的右端）是有效的，需要一个强的罚项。选择 $\\alpha$ 按 $(p/h)^2$ 标度是一种特别激进的标度策略。这种选择 $\\alpha_{\\mathrm{opt}}(h,p) = c \\, (p/h)^2$ 旨在使罚项的离散算子范数与旋度-旋度算子的范数相当。这确保了对于 $h$ 和 $p$ 的任何组合，罚项都足够强，能将伪特征值推向远大于我们感兴趣的物理特征值的值。一个物理特征值 $\\lambda_k$ 受到一个特征值为 $\\lambda_s \\approx \\alpha$ 的伪模的扰动，其大小近似正比于 $\\beta^2 / |\\lambda_k - \\alpha|$。通过所提出的标度律使 $\\alpha$ 非常大，分母随之增大，从而最小化了扰动。待测试的具体定律是 $\\alpha_{\\mathrm{opt}}(h,p) = p^2/h^2$ （即 $c=1$）。\n\n计算过程如下。对于由元组 $(h, p, \\alpha)$ 定义的每个测试案例，我们执行两次计算。\n\n首先，使用给定的 $\\alpha$：\n1. 设置模型参数：$n_{\\mathrm{phys}}=6$，$n_{\\mathrm{grad}}=4$。真实的物理特征值为 $\\lambda_k = \\pi^2 s_k$，其中 $k=1,\\ldots,6$，$\\mathbf{s}=(2,5,8,10,13,17)$。\n2. 构建 $10 \\times 10$ 的对称块矩阵 $\\mathbf{A}_{\\alpha}(h,p)$。各块为：\n    - 左上块（$6 \\times 6$）：$\\mathbf{\\Lambda} = \\mathrm{diag}(\\lambda_1, \\ldots, \\lambda_6)$。\n    - 右上块（$6 \\times 4$）和左下块（$4 \\times 6$）：耦合由 $\\beta(h,p)\\mathbf{C}$ 及其转置给出，其中 $\\beta(h,p) = h^p/p$ 且 $\\mathbf{C}$ 是一个矩阵，其 $C_{ii}=1$（对于 $i=1,2,3,4$），其余元素为零。\n    - 右下块（$4 \\times 4$）：罚项为 $\\alpha \\mathbf{I}_{4}$。\n3. 计算 $\\mathbf{A}_{\\alpha}$ 的特征值。由于矩阵是实对称的，所有特征值都是实数。将它们按非递减顺序排序。\n4. 这些排序后的特征值中的前 $n_{\\mathrm{phys}}=6$ 个，即 $\\lambda_k^{\\alpha}$，是受扰动的物理特征值。\n5. 最大相对扰动计算为 $\\delta(h,p,\\alpha) = \\max_{1\\le k\\le 6} |\\lambda_k^{\\alpha} - \\lambda_k|/\\lambda_k$。\n\n其次，使用建议的最优罚参数 $\\alpha_{\\mathrm{opt}}(h,p) = p^2/h^2$ 重复整个过程，以计算 $\\delta(h,p,\\alpha_{\\mathrm{opt}})$。\n\n将此过程应用于所有三个测试案例，并将得到的六个 $\\delta$ 值收集起来作为最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the eigenvalue perturbation problem for the given test cases.\n    \n    This function implements the block-structured model for a penalized finite\n    element eigenproblem, computes the perturbed eigenvalues for different\n    parameter sets, and quantifies the maximum relative perturbation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (h, p, alpha_given)\n        (0.5, 1, 0.1),\n        (0.25, 2, 1.0),\n        (0.125, 3, 100.0),\n    ]\n\n    # --- Fixed parameters of the model ---\n    n_phys = 6\n    n_grad = 4\n    \n    # True physical eigenvalues\n    s_k = np.array([2.0, 5.0, 8.0, 10.0, 13.0, 17.0])\n    lambda_true = np.pi**2 * s_k\n    \n    # Coupling matrix C\n    # C is a 6x4 matrix with C_ii=1 for i=1,2,3,4, and 0 otherwise.\n    C = np.zeros((n_phys, n_grad))\n    np.fill_diagonal(C, 1.0)\n    \n    # Diagonal block Lambda\n    Lambda = np.diag(lambda_true)\n\n    results = []\n\n    for h, p, alpha_given in test_cases:\n        # --- Common calculation for both alpha values ---\n        # Coupling magnitude beta\n        beta = (h**p) / p\n        \n        # Off-diagonal blocks\n        coupling_block = beta * C\n        \n        # Upper part of the matrix A is the same for both calculations\n        A_upper = np.hstack([Lambda, coupling_block])\n\n        # --- 1. Calculation for the given alpha ---\n        \n        # Assemble the full matrix A_alpha\n        A_lower_given = np.hstack([coupling_block.T, alpha_given * np.identity(n_grad)])\n        A_alpha_given = np.vstack([A_upper, A_lower_given])\n        \n        # Compute eigenvalues. eigvalsh is for symmetric matrices and is efficient.\n        # The eigenvalues are not guaranteed to be sorted.\n        eigenvalues_given = np.sort(np.linalg.eigvalsh(A_alpha_given))\n        \n        # The first n_phys eigenvalues are the perturbed physical ones.\n        lambda_perturbed_given = eigenvalues_given[:n_phys]\n        \n        # Calculate maximum relative perturbation\n        delta_given = np.max(np.abs((lambda_perturbed_given - lambda_true) / lambda_true))\n        results.append(delta_given)\n\n        # --- 2. Calculation for the proposed optimal alpha ---\n        \n        # Proposed optimal penalty strength\n        alpha_opt = (p**2) / (h**2)\n        \n        # Assemble the full matrix A_alpha_opt\n        A_lower_opt = np.hstack([coupling_block.T, alpha_opt * np.identity(n_grad)])\n        A_alpha_opt = np.vstack([A_upper, A_lower_opt])\n        \n        # Compute eigenvalues\n        eigenvalues_opt = np.sort(np.linalg.eigvalsh(A_alpha_opt))\n        \n        # The first n_phys eigenvalues are the perturbed physical ones.\n        lambda_perturbed_opt = eigenvalues_opt[:n_phys]\n        \n        # Calculate maximum relative perturbation\n        delta_opt = np.max(np.abs((lambda_perturbed_opt - lambda_true) / lambda_true))\n        results.append(delta_opt)\n\n    # Final print statement in the exact required format.\n    # The use of map(str, ...) allows for default float formatting.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}