{
    "hands_on_practices": [
        {
            "introduction": "本章的实践练习旨在深化您对麦克斯韦方程弱形式的理解和应用。我们将从一个电磁学中的经典问题——腔体本征问题——开始。这个练习不仅要求您推导出旋度-旋度方程的弱形式，更重要的是，它将引导您直面在用有限元法求解麦克斯韦方程时的一个核心挑战：非物理“伪模式”的存在。通过理解如何构建一个数学上严谨的投影来消除这些梯度场，您将为建立稳健的电磁求解器打下坚实的基础。",
            "id": "3297829",
            "problem": "一个有界的、单连通的腔体域 $\\Omega \\subset \\mathbb{R}^3$ 具有 Lipschitz 边界 $\\partial \\Omega$，其内部填充有非均匀但一致有界、对称正定的电容率张量场 $\\varepsilon(\\mathbf{x})$ 和磁导率张量场 $\\mu(\\mathbf{x})$。边界为理想电导体 (PEC)，因此电场的切向迹为零。在无源、时谐的情况下，根据高斯定律，电场是无散的，物理谐振频率可从一个旋度-旋度特征问题中获得。仅从无源、时谐形式的麦克斯韦方程组、PEC 边界条件和标准的矢量微积分恒等式出发，为电场腔体特征问题推导一个变分（弱）形式，该形式能够在一个合适的 Sobolev 空间中产生一个对称的特征值问题，并清楚地确定正确的本质边界条件。然后，解释一个数学上精确的过程，以移除位于旋度算子核空间中的梯度子空间，从而在协调离散化中避免伪零特征值。\n\n哪个（些）选项正确地陈述了弱形式和移除梯度场的正确方法？\n\nA. 设 $V = H_0(\\mathrm{curl};\\Omega) \\equiv \\{\\mathbf{v}\\in H(\\mathrm{curl};\\Omega): \\mathbf{n}\\times \\mathbf{v} = \\mathbf{0}\\text{ on }\\partial \\Omega\\}$。特征问题是：寻找非零的 $(\\mathbf{E},\\lambda)\\in V\\times \\mathbb{R}_+$ 使得\n$$\na(\\mathbf{E},\\mathbf{v}) = \\lambda\\, m(\\mathbf{E},\\mathbf{v}) \\quad \\forall \\mathbf{v}\\in V,\n$$\n其中\n$$\na(\\mathbf{E},\\mathbf{v}) \\equiv \\int_{\\Omega} \\mu^{-1}(\\mathbf{x})\\, (\\nabla \\times \\mathbf{E})\\cdot (\\nabla \\times \\mathbf{v})\\, \\mathrm{d}\\Omega, \n\\qquad\nm(\\mathbf{E},\\mathbf{v}) \\equiv \\int_{\\Omega} \\varepsilon(\\mathbf{x})\\, \\mathbf{E}\\cdot \\mathbf{v}\\, \\mathrm{d}\\Omega.\n$$\n为移除梯度场 $\\nabla \\phi$，使用到 $\\varepsilon$-无散子空间上的 $\\varepsilon$ 加权亥姆霍兹投影 $P$：对于任意 $\\mathbf{w}\\in L^2(\\Omega)^3$，寻找 $\\phi\\in H_0^1(\\Omega)$ 使得\n$$\n\\int_{\\Omega} \\varepsilon\\, \\nabla \\phi \\cdot \\nabla q\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\varepsilon\\, \\mathbf{w} \\cdot \\nabla q\\, \\mathrm{d}\\Omega \\quad \\forall q\\in H_0^1(\\Omega),\n$$\n并设 $P\\mathbf{w} = \\mathbf{w} - \\nabla \\phi$。在 $P V$ 中求解该特征问题（等价地，对所有 $q\\in H_0^1(\\Omega)$ 强制 $(\\varepsilon \\mathbf{E}, \\nabla q)=0$）。\n\nB. 设 $V = H(\\mathrm{curl};\\Omega)$，不带本质边界条件。对二阶方程进行分部积分以获得一个边界项，并在 $\\partial \\Omega$ 上施加自然边界条件 $\\mathbf{n}\\times (\\mu^{-1}\\nabla \\times \\mathbf{E})=\\mathbf{0}$。通过从以下方程求解 $\\phi\\in H_0^1(\\Omega)$ 来投影梯度\n$$\n\\int_{\\Omega} \\mu^{-1}\\, \\nabla \\phi \\cdot \\nabla q\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\mu^{-1}\\, \\mathbf{w} \\cdot \\nabla q\\, \\mathrm{d}\\Omega \\quad \\forall q\\in H_0^1(\\Omega),\n$$\n并定义 $\\mathbf{w}\\mapsto \\mathbf{w}-\\nabla \\phi$。\n\nC. 设 $V = H_0(\\mathrm{curl};\\Omega)$ 并引入一个标量场 $p\\in H_0^1(\\Omega)$ 作为拉格朗日乘子，以在 $\\varepsilon$-内积下强制与梯度的正交性。混合特征问题是：寻找非零的 $(\\mathbf{E},p,\\lambda)\\in V\\times H_0^1(\\Omega)\\times \\mathbb{R}_+$ 使得\n$$\n\\int_{\\Omega} \\mu^{-1}\\, (\\nabla \\times \\mathbf{E})\\cdot (\\nabla \\times \\mathbf{v})\\, \\mathrm{d}\\Omega + \\int_{\\Omega} \\varepsilon\\, (\\nabla p)\\cdot \\mathbf{v}\\, \\mathrm{d}\\Omega = \\lambda \\int_{\\Omega} \\varepsilon\\, \\mathbf{E}\\cdot \\mathbf{v}\\, \\mathrm{d}\\Omega \\quad \\forall \\mathbf{v}\\in V,\n$$\n$$\n\\int_{\\Omega} \\varepsilon\\, \\mathbf{E}\\cdot \\nabla q\\, \\mathrm{d}\\Omega = 0 \\quad \\forall q\\in H_0^1(\\Omega).\n$$\n这强制了对所有 $q$ 都有 $(\\varepsilon \\mathbf{E}, \\nabla q)=0$，从而移除了梯度场。\n\nD. 设 $V = H_0^1(\\Omega)^3$ 并在 $\\partial \\Omega$ 上施加本质边界条件 $\\mathbf{E}=\\mathbf{0}$。使用对称双线性形式\n$$\na(\\mathbf{E},\\mathbf{v}) = \\int_{\\Omega} \\mu^{-1}\\, (\\nabla \\times \\mathbf{E})\\cdot (\\nabla \\times \\mathbf{v})\\, \\mathrm{d}\\Omega, \n\\qquad \nm(\\mathbf{E},\\mathbf{v}) = \\int_{\\Omega} \\varepsilon\\, \\mathbf{E}\\cdot \\mathbf{v}\\, \\mathrm{d}\\Omega,\n$$\n并注意不需要进行投影，因为梯度已被空间 $V$ 排除。\n\nE. 设 $V = H_0(\\mathrm{curl};\\Omega)$ 并添加一个弱形式强制 $\\nabla \\cdot (\\varepsilon \\mathbf{E})=0$ 的罚项：对于固定的 $\\alpha>0$，对所有 $\\mathbf{v}\\in V$ 求解\n$$\n\\int_{\\Omega} \\mu^{-1}\\, (\\nabla \\times \\mathbf{E})\\cdot (\\nabla \\times \\mathbf{v})\\, \\mathrm{d}\\Omega + \\alpha \\int_{\\Omega} \\big(\\nabla \\cdot (\\varepsilon \\mathbf{E})\\big)\\, \\big(\\nabla \\cdot (\\varepsilon \\mathbf{v})\\big)\\, \\mathrm{d}\\Omega\n= \\lambda \\int_{\\Omega} \\varepsilon\\, \\mathbf{E}\\cdot \\mathbf{v}\\, \\mathrm{d}\\Omega\n$$\n。这对于任何有限的 $\\alpha$ 都能精确地投影掉梯度场，并产生没有伪零特征值的正确谱。",
            "solution": "问题陈述是计算电磁学中一个有效且适定的问题。它描述了在一个带有理想电导体 (PEC) 壁的无源腔体中确定谐振频率，这是一个经典的特征值问题。材料属性、域和边界条件都是标准的。任务是推导弱形式，并解释如何处理旋度算子在数值上存在问题的核空间。\n\n让我们从第一性原理出发进行推导。\n\n电场 $\\mathbf{E}$ 和磁场 $\\mathbf{H}$ 的无源、时谐麦克斯韦方程组为：\n$$\n\\nabla \\times \\mathbf{E} = -i\\omega \\mu(\\mathbf{x}) \\mathbf{H} \\quad (1)\n$$\n$$\n\\nabla \\times \\mathbf{H} = i\\omega \\varepsilon(\\mathbf{x}) \\mathbf{E} \\quad (2)\n$$\n其中 $\\omega$ 是角频率，$\\varepsilon(\\mathbf{x})$ 和 $\\mu(\\mathbf{x})$ 分别是电容率和磁导率张量，它们被设定为对称和正定的。\n\n从方程 (1) 出发，假设存在非平凡时谐场（即 $\\omega \\neq 0$），我们可以用 $\\mathbf{E}$ 来表示 $\\mathbf{H}$：\n$$\n\\mathbf{H} = \\frac{i}{\\omega} \\mu^{-1}(\\mathbf{x}) (\\nabla \\times \\mathbf{E})\n$$\n此处，$\\mu^{-1}$ 表示磁导率张量的逆。将这个 $\\mathbf{H}$ 的表达式代入方程 (2)，得到电场 $\\mathbf{E}$ 的旋度-旋度方程：\n$$\n\\nabla \\times \\left( \\frac{i}{\\omega} \\mu^{-1} (\\nabla \\times \\mathbf{E}) \\right) = i\\omega \\varepsilon \\mathbf{E}\n$$\n两边乘以 $\\omega/i$ 并重新整理，得到特征值问题的强形式：\n$$\n\\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) = \\omega^2 \\varepsilon \\mathbf{E}\n$$\n我们定义特征值为 $\\lambda = \\omega^2$。\n\n为了推导变分（弱）形式，我们用一个矢量测试函数 $\\mathbf{v}$ 乘以方程，并在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} \\mathbf{v} \\cdot \\left( \\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) \\right) \\mathrm{d}\\Omega = \\lambda \\int_{\\Omega} \\mathbf{v} \\cdot (\\varepsilon \\mathbf{E}) \\mathrm{d}\\Omega\n$$\n我们将矢量微积分恒等式 $\\mathbf{A} \\cdot (\\nabla \\times \\mathbf{B}) = (\\nabla \\times \\mathbf{A}) \\cdot \\mathbf{B} - \\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B})$ 应用于左手边，其中 $\\mathbf{A} = \\mathbf{v}$ 且 $\\mathbf{B} = \\mu^{-1} \\nabla \\times \\mathbf{E}$。这得到：\n$$\n\\int_{\\Omega} (\\nabla \\times \\mathbf{v}) \\cdot (\\mu^{-1} \\nabla \\times \\mathbf{E}) \\mathrm{d}\\Omega - \\int_{\\Omega} \\nabla \\cdot (\\mathbf{v} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E})) \\mathrm{d}\\Omega = \\lambda \\int_{\\Omega} (\\varepsilon \\mathbf{E}) \\cdot \\mathbf{v} \\mathrm{d}\\Omega\n$$\n对左边的第二项使用散度定理，并利用矢量恒等式 $\\mathbf{a} \\cdot (\\mathbf{b} \\times \\mathbf{c}) = (\\mathbf{a} \\times \\mathbf{b}) \\cdot \\mathbf{c}$，我们将体积分转换为边界 $\\partial \\Omega$ 上的面积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\mathbf{v} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E})) \\mathrm{d}\\Omega = \\oint_{\\partial \\Omega} (\\mathbf{v} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E})) \\cdot \\mathbf{n} \\mathrm{d}S = \\oint_{\\partial \\Omega} (\\mathbf{n} \\times \\mathbf{v}) \\cdot (\\mu^{-1} \\nabla \\times \\mathbf{E}) \\mathrm{d}S\n$$\n对于旋度平方可积的场，合适的函数空间是 Sobolev 空间 $H(\\mathrm{curl};\\Omega) = \\{\\mathbf{u} \\in (L^2(\\Omega))^3 : \\nabla \\times \\mathbf{u} \\in (L^2(\\Omega))^3\\}$。理想电导体 (PEC) 上的物理边界条件是电场切向迹的消失：$\\mathbf{n} \\times \\mathbf{E}|_{\\partial \\Omega} = \\mathbf{0}$。这是一个本质边界条件，所以它必须被构建到试探函数 $\\mathbf{E}$ 的函数空间中，并且为了对称性，也应构建到测试函数 $\\mathbf{v}$ 的空间中。因此，正确的空间是 $V = H_0(\\mathrm{curl};\\Omega) = \\{\\mathbf{v} \\in H(\\mathrm{curl};\\Omega) : \\mathbf{n} \\times \\mathbf{v} = \\mathbf{0} \\text{ on } \\partial \\Omega\\}$。由于 $\\mathbf{v} \\in V$，其切向迹 $\\mathbf{n} \\times \\mathbf{v}$ 在 $\\partial \\Omega$ 上为零，导致边界积分为零。\n\n最终得到的弱形式是：寻找非零的 $(\\mathbf{E}, \\lambda) \\in V \\times \\mathbb{R}_+$ 使得\n$$\n\\int_{\\Omega} (\\mu^{-1} \\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{v}) \\mathrm{d}\\Omega = \\lambda \\int_{\\Omega} (\\varepsilon \\mathbf{E}) \\cdot \\mathbf{v} \\mathrm{d}\\Omega \\quad \\forall \\mathbf{v} \\in V\n$$\n这可以写成 $a(\\mathbf{E}, \\mathbf{v}) = \\lambda m(\\mathbf{E}, \\mathbf{v})$，其中对称双线性形式为：\n$$\na(\\mathbf{u}, \\mathbf{v}) = \\int_{\\Omega} (\\mu^{-1} \\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v}) \\mathrm{d}\\Omega\n$$\n$$\nm(\\mathbf{u}, \\mathbf{v}) = \\int_{\\Omega} (\\varepsilon \\mathbf{u}) \\cdot \\mathbf{v} \\mathrm{d}\\Omega\n$$\n旋度算子的核是所有梯度场的集合 $\\{\\nabla \\phi\\}$。任何形如 $\\mathbf{E} = \\nabla \\phi$（其中 $\\phi \\in H_0^1(\\Omega)$，因此在 $\\partial\\Omega$ 上有 $\\mathbf{n}\\times\\nabla\\phi = \\mathbf{0}$）的试探函数都属于 $V$ 并且有 $\\nabla \\times \\mathbf{E} = \\mathbf{0}$。这对任何 $\\mathbf{v}$ 都使得左手边 $a(\\nabla \\phi, \\mathbf{v})$ 等于 $0$。特征值方程变为 $0 = \\lambda m(\\nabla \\phi, \\mathbf{v})$。对于 $\\lambda \\ne 0$，这意味着对所有 $\\mathbf{v}$ 都有 $m(\\nabla \\phi, \\mathbf{v})=0$，这意味着 $\\nabla \\phi = \\mathbf{0}$。然而，如果 $\\lambda = 0$，方程 $0=0$ 对任何 $\\nabla\\phi$ 都成立。这意味着整个无穷维空间 $\\nabla H_0^1(\\Omega)$ 都是 $\\lambda=0$ 的特征空间，这会在数值离散化中导致伪零特征值。\n\n物理上有意义的解还必须满足电介质中的高斯定律 $\\nabla \\cdot (\\varepsilon \\mathbf{E}) = 0$。其弱形式为，对所有光滑函数 $q$，有 $\\int_{\\Omega} q \\nabla \\cdot (\\varepsilon \\mathbf{E}) \\mathrm{d}\\Omega = 0$。通过分部积分，这等价于要求解 $\\mathbf{E}$ 在 $\\varepsilon$ 加权内积下与梯度场正交：\n$$\n\\int_{\\Omega} (\\varepsilon \\mathbf{E}) \\cdot \\nabla q \\mathrm{d}\\Omega = 0 \\quad \\forall q \\in H_0^1(\\Omega)\n$$\n这个约束正确地滤除了非物理的梯度场。有两种标准方法来施加这个约束。\n1.  **正交投影：** 将空间 $V$ 分解为无散部分和梯度部分，$V = V_S \\oplus \\nabla H_0^1(\\Omega)$，其中该和在 $m(\\cdot,\\cdot)$ 内积下是正交的。可以通过寻找 $\\phi \\in H_0^1(\\Omega)$ 使得 $\\mathbf{w} - \\nabla \\phi$ 与 $\\nabla H_0^1(\\Omega)$ 正交，来将任意函数 $\\mathbf{w} \\in V$ 显式地投影到 $V_S$ 上。这导致需要为每个要投影的函数求解一个关于 $\\phi$ 的泊松型方程。\n2.  **拉格朗日乘子：** 引入一个拉格朗日乘子 $p \\in H_0^1(\\Omega)$，在混合形式中强制约束 $\\int_{\\Omega} (\\varepsilon \\mathbf{E}) \\cdot \\nabla q \\mathrm{d}\\Omega = 0$。\n\n现在我们来评估给定的选项。\n\n**A.** 该选项正确地陈述了函数空间 $V = H_0(\\mathrm{curl};\\Omega)$ 以及双线性形式 $a(\\cdot,\\cdot)$ 和 $m(\\cdot,\\cdot)$，这与我们的推导相符。然后它描述了用正交投影法来移除梯度场。该过程涉及通过求解一个泊松方程的弱形式 $\\int_{\\Omega} \\varepsilon\\, \\nabla \\phi \\cdot \\nabla q\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\varepsilon\\, \\mathbf{w} \\cdot \\nabla q\\, \\mathrm{d}\\Omega$ 来寻找 $\\phi \\in H_0^1(\\Omega)$。该方程正确地说明了 $\\mathbf{w}$ 在梯度空间上的投影 $\\nabla\\phi$ 是这样的：残差 $\\mathbf{w}-\\nabla\\phi$ 在 $\\varepsilon$ 加权内积下与梯度空间正交。这是进行 $\\varepsilon$ 加权亥姆霍兹-霍奇投影的正确过程。然后，在正确定义的无散子空间中求解得到的特征问题。结论：**正确**。\n\n**B.** 此选项错误地建议使用不带本质边界条件的 $V = H(\\mathrm{curl};\\Omega)$，而是施加一个自然边界条件 $\\mathbf{n}\\times (\\mu^{-1}\\nabla \\times \\mathbf{E})=\\mathbf{0}$。这对应的是理想磁导体，而不是理想电导体。PEC 条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ 对此问题提法是本质的。此外，它建议使用基于 $\\mu^{-1}$ 加权内积的投影来移除梯度。约束 $\\nabla \\cdot (\\varepsilon \\mathbf{E}) = 0$ 要求在由 $m(\\cdot, \\cdot)$ 形式定义的 $\\varepsilon$ 加权内积下正交。使用错误的权重无法强制施加物理约束。结论：**不正确**。\n\n**C.** 此选项正确地确定了空间 $V=H_0(\\mathrm{curl};\\Omega)$，并提出了一个使用拉格朗日乘子 $p \\in H_0^1(\\Omega)$ 的混合形式。第二个方程 $\\int_{\\Omega} \\varepsilon\\, \\mathbf{E}\\cdot \\nabla q\\, \\mathrm{d}\\Omega = 0$ 直接对 $\\mathbf{E}$ 施加了所要求的弱无散约束。第一个方程用 $\\int_{\\Omega} \\varepsilon\\, (\\nabla p)\\cdot \\mathbf{v}\\, \\mathrm{d}\\Omega$ 项扩充了原始问题。对于一个非零特征值 $\\lambda$，该形式正确地蕴含了 $p=0$，并在受约束的（物理）子空间中产生了特征对 $(\\mathbf{E}, \\lambda)$。这是一个施加无散约束并移除伪模式的标准有效方法。结论：**正确**。\n\n**D.** 此选项提议使用函数空间 $V = H_0^1(\\Omega)^3$。这在 $\\partial \\Omega$ 上施加了边界条件 $\\mathbf{E} = \\mathbf{0}$，这在物理上是不正确的，并且限制性过强。在 PEC 表面上，$\\mathbf{E}$ 的法向分量通常不为零。因此，该形式没有模拟正确的物理问题。声称梯度被该空间排除也不是在旋度-旋度问题背景下避免伪模式的合理理由。结论：**不正确**。\n\n**E.** 此选项提出了一种罚方法。该形式添加了一个项 $\\alpha \\int_{\\Omega} \\big(\\nabla \\cdot (\\varepsilon \\mathbf{E})\\big)\\, \\big(\\nabla \\cdot (\\varepsilon \\mathbf{v})\\big)\\, \\mathrm{d}\\Omega$。此项没有良定，因为对于一个一般的函数 $\\mathbf{v} \\in H(\\mathrm{curl};\\Omega)$，其散度不保证在 $L^2(\\Omega)$ 中，因此积分可能不存在。此外，对于有限的罚参数 $\\alpha$，罚方法仅能近似地施加约束，只有在 $\\alpha \\to \\infty$ 的极限情况下才能精确施加。声称该方法对于*任何有限的* $\\alpha$ 都能*精确*投影掉梯度场是错误的。罚方法通常是将伪特征值移动到大的非零值，而不是消除它们。结论：**不正确**。\n\n选项 A 和 C 都为解决所述问题提供了数学上合理且标准的方法。",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "在上一个练习的基础上，我们现在将深入分析所导出弱形式的数学性质。本练习的重点是与旋度-旋度算子相关的半双线性形式，以及它的性质（如不定性、奇异性）如何随物理条件（如介质损耗和驱动频率）而改变。这项实践练习是连接理论与计算的桥梁。通过识别算子何时变得不定或奇异（例如，在无损腔体的谐振频率处），您将深刻理解为何数值解可能失效，并学会如何为不同的物理场景选择合适的迭代求解器（例如，为何使用 GMRES 而非 CG）。",
            "id": "3297806",
            "problem": "考虑一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$，该域被一种介电常数为 $\\varepsilon$、磁导率为 $\\mu$、电导率为 $\\sigma$ 的线性、均匀、各向同性介质所占据。设时谐约定为 $e^{i \\omega t}$，角频率为 $\\omega > 0$。源是一个给定的外加电流密度 $\\mathbf{J} \\in L^2(\\Omega)^3$。电场 $\\mathbf{E}$ 和磁场 $\\mathbf{H}$ 满足宏观麦克斯韦方程组\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\sigma \\mathbf{E} + i \\omega \\varepsilon \\mathbf{E}, \\qquad\n\\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H}\n$$\n在 $\\Omega$ 中成立，同时在 $\\partial \\Omega$ 上满足理想电导体 (PEC) 边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$，其中 $\\mathbf{n}$ 是 $\\partial \\Omega$ 上的外单位法向量。利用这些定律和定义，通过消去 $\\mathbf{H}$ 并使用满足 PEC 边界条件的、来自适当的 $H(\\mathrm{curl})$ 协调空间中的测试函数 $\\mathbf{v}$，推导出关于 $\\mathbf{E}$ 的弱形式。然后，从得到的弱形式出发，推断相关的半双线性形式在何种情况下是不定的或奇异的，并解释其对适定性（唯一性和稳定性）以及对有限元法 (FEM) 中数值求解器选择的影响。\n\n下列哪个陈述是正确的？\n\nA. 在一个有界的、单连通的腔体中，当 $\\sigma = 0$，$\\varepsilon > 0$ 和 $\\mu > 0$ 为实数，且边界为 PEC 时，弱旋度-旋度形式在 $H_0(\\mathrm{curl}; \\Omega)$ 上是矫顽的；因此离散系统是对称正定的，并且共轭梯度 (CG) 法无条件收敛。\n\nB. 在无损耗腔体中（即 $\\sigma = 0$，$\\varepsilon, \\mu$ 为实数），当 $\\omega$ 与腔体的一个本征频率重合时，与弱形式相关的算子是奇异的；引入一个小的电导率 $\\sigma > 0$（等效于介电常数有一个正的虚部）会产生一个复值半双线性形式，该形式在适当的相位旋转后是矫顽的，从而恢复唯一性并稳定数值解。\n\nC. 对于 $\\mathrm{Im}(\\varepsilon) > 0$ 或 $\\sigma > 0$ 的有损耗介质，离散系统通常是非厄米的；为非厄米矩阵设计的 Krylov 方法，如广义最小残差 (GMRES) 法是合适的，而共轭梯度 (CG) 法不适用。\n\nD. $H_0(\\mathrm{curl}; \\Omega)$ 中作为旋度算子非平凡核的梯度场的存在，意味着弱形式是正定的；即使在共振附近也不需要稳定化或预处理。\n\nE. 使用 Nédélec 边元来保证 $H(\\mathrm{curl})$ 协调性，并通过增加散度约束或规范稳定化来增强该形式，可以抑制伪模式；在共振附近，近似麦克斯韦算子并强制执行 inf-sup 条件的分块预处理器能提高鲁棒性。\n\n选择所有适用项。",
            "solution": "出发点是在 $e^{i\\omega t}$ 约定下频域中的基本宏观麦克斯韦方程组：\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\sigma \\mathbf{E} + i \\omega \\varepsilon \\mathbf{E}, \\qquad\n\\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H}.\n$$\n我们考虑理想电导体 (PEC) 边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ 在 $\\partial \\Omega$ 上成立，并在空间 $H_0(\\mathrm{curl}; \\Omega) := \\{ \\mathbf{u} \\in H(\\mathrm{curl}; \\Omega) : \\mathbf{n} \\times \\mathbf{u} = \\mathbf{0} \\text{ on } \\partial \\Omega \\}$ 中求解 $\\mathbf{E}$。\n\n通过将第二个方程中的 $\\mathbf{H}$ 代入第一个方程来消去 $\\mathbf{H}$。由 $\\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H}$，我们得到\n$$\n\\mathbf{H} = \\frac{i}{\\omega \\mu} \\nabla \\times \\mathbf{E}.\n$$\n代入到 $\\nabla \\times \\mathbf{H}$ 中：\n$$\n\\nabla \\times \\mathbf{H} = \\nabla \\times \\left( \\frac{i}{\\omega \\mu} \\nabla \\times \\mathbf{E} \\right) = \\frac{i}{\\omega} \\nabla \\times \\left( \\mu^{-1} \\nabla \\times \\mathbf{E} \\right).\n$$\n因此，关于 $\\mathbf{E}$ 的强形式是\n$$\n\\frac{i}{\\omega} \\nabla \\times \\left( \\mu^{-1} \\nabla \\times \\mathbf{E} \\right) = \\mathbf{J} + \\sigma \\mathbf{E} + i \\omega \\varepsilon \\mathbf{E}.\n$$\n两边同乘以 $-i \\omega$ 得到标准的旋度-旋度方程：\n$$\n\\nabla \\times \\left( \\mu^{-1} \\nabla \\times \\mathbf{E} \\right) - \\omega^2 \\varepsilon \\mathbf{E} - i \\omega \\sigma \\mathbf{E} = i \\omega \\mathbf{J}.\n$$\n为了推导弱形式，取一个测试函数 $\\mathbf{v} \\in H_0(\\mathrm{curl}; \\Omega)$，乘以其复共轭 $\\overline{\\mathbf{v}}$，并在 $\\Omega$ 上积分。利用矢量微积分恒等式以及 $\\mathbf{E}$ 和 $\\mathbf{v}$ 在 $\\partial \\Omega$ 上的切向迹为零（这使得分部积分后的边界项消失），我们得到半双线性形式 $a(\\cdot,\\cdot)$ 和线性形式 $f(\\cdot)$：\n$$\na(\\mathbf{E}, \\mathbf{v}) := \\int_{\\Omega} \\mu^{-1} \\left( \\nabla \\times \\mathbf{E} \\right) \\cdot \\overline{ \\left( \\nabla \\times \\mathbf{v} \\right)} \\, \\mathrm{d}\\Omega - \\omega^2 \\int_{\\Omega} \\varepsilon \\, \\mathbf{E} \\cdot \\overline{\\mathbf{v}} \\, \\mathrm{d}\\Omega - i \\omega \\int_{\\Omega} \\sigma \\, \\mathbf{E} \\cdot \\overline{\\mathbf{v}} \\, \\mathrm{d}\\Omega,\n$$\n$$\nf(\\mathbf{v}) := i \\omega \\int_{\\Omega} \\mathbf{J} \\cdot \\overline{\\mathbf{v}} \\, \\mathrm{d}\\Omega.\n$$\n弱问题是：求 $\\mathbf{E} \\in H_0(\\mathrm{curl}; \\Omega)$ 使得\n$$\na(\\mathbf{E}, \\mathbf{v}) = f(\\mathbf{v}) \\quad \\text{对所有 } \\mathbf{v} \\in H_0(\\mathrm{curl}; \\Omega).\n$$\n\n无损耗情况下的不定性（$\\sigma = 0$，$\\varepsilon > 0$ 和 $\\mu > 0$ 为实数）。半双线性形式简化为\n$$\na_0(\\mathbf{E}, \\mathbf{v}) := \\int_{\\Omega} \\mu^{-1} \\left( \\nabla \\times \\mathbf{E} \\right) \\cdot \\overline{ \\left( \\nabla \\times \\mathbf{v} \\right)} \\, \\mathrm{d}\\Omega - \\omega^2 \\int_{\\Omega} \\varepsilon \\, \\mathbf{E} \\cdot \\overline{\\mathbf{v}} \\, \\mathrm{d}\\Omega.\n$$\n考虑 $\\mathbf{v} \\in H_0(\\mathrm{curl}; \\Omega)$ 的二次型 $a_0(\\mathbf{v}, \\mathbf{v})$：\n$$\na_0(\\mathbf{v}, \\mathbf{v}) = \\int_{\\Omega} \\mu^{-1} \\left| \\nabla \\times \\mathbf{v} \\right|^2 \\, \\mathrm{d}\\Omega - \\omega^2 \\int_{\\Omega} \\varepsilon \\, \\left| \\mathbf{v} \\right|^2 \\, \\mathrm{d}\\Omega.\n$$\n两个结构特性导致了不定性：\n- $H_0(\\mathrm{curl}; \\Omega)$ 上旋度算子的核包含梯度场。具体来说，对于任何 $\\phi \\in H_0^1(\\Omega)$，$\\mathbf{v} = \\nabla \\phi$ 满足 $\\mathbf{v} \\in H_0(\\mathrm{curl}; \\Omega)$ 且 $\\nabla \\times \\mathbf{v} = \\mathbf{0}$。于是\n$$\na_0(\\nabla \\phi, \\nabla \\phi) = - \\omega^2 \\int_{\\Omega} \\varepsilon \\, \\left| \\nabla \\phi \\right|^2 \\, \\mathrm{d}\\Omega  0 \\quad \\text{对 } \\nabla \\phi \\neq \\mathbf{0}.\n$$\n因此，$a_0$ 在梯度子空间上是负的。\n- 在具有非零旋度的无散子空间上，对于足够小的 $\\omega$ 或者对于旋度相对于其 $L^2$ 范数较大的函数，第一项可以主导第二项，从而得到 $a_0(\\mathbf{v}, \\mathbf{v})  0$。\n\n因此，$a_0$ 是厄米的且强不定的，并且在 $H_0(\\mathrm{curl}; \\Omega)$ 上矫顽性失效，因为无法用 $a_0(\\mathbf{v}, \\mathbf{v})$ 对 $\\left\\| \\mathbf{v} \\right\\|_{H(\\mathrm{curl})}^2$ 进行一致的下界约束。特别地，当存在梯度场时，没有 Poincaré 型不等式能仅通过旋度来控制 $\\mathbf{v}$ 的 $L^2$ 范数。\n\n共振和奇异性。齐次无损耗问题（$\\mathbf{J} = \\mathbf{0}$，$\\sigma = 0$）简化为特征值方程\n$$\n\\nabla \\times \\left( \\mu^{-1} \\nabla \\times \\mathbf{E} \\right) = \\omega^2 \\varepsilon \\mathbf{E}\n$$\n及其 PEC 边界条件。非平凡解 $\\mathbf{E} \\neq \\mathbf{0}$ 恰好在腔体本征频率处存在；在这样的 $\\omega$ 处，算子是奇异的，非齐次问题可能没有唯一解，或者在离散化后变得病态。\n\n损耗的影响（$\\sigma  0$ 或 $\\mathrm{Im}(\\varepsilon)  0$）。当 $\\sigma  0$ 时，半双线性形式有一个额外的严格耗散部分：\n$$\n\\mathrm{Im}\\, a(\\mathbf{v}, \\mathbf{v}) = \\omega \\int_{\\Omega} \\sigma \\, \\left| \\mathbf{v} \\right|^2 \\, \\mathrm{d}\\Omega \\ge \\omega \\sigma_{\\min} \\left\\| \\mathbf{v} \\right\\|_{L^2(\\Omega)}^2,\n$$\n其中 $\\sigma_{\\min}$ 是 $\\sigma$ 在 $\\Omega$ 上的一个正常数下界。通过将方程乘以一个相位因子 $e^{i \\theta}$（一种处理复半双线性形式的标准技巧），可以将不定的实部旋转到虚轴，并利用正的虚部来建立一个矫顽性（或 inf–sup）不等式，形式为\n$$\n\\left| a(\\mathbf{v}, \\mathbf{v}) \\right| \\ge c \\, \\left\\| \\mathbf{v} \\right\\|_{H(\\mathrm{curl}; \\Omega)}^2 \\quad \\text{对于某个 } c  0,\n$$\n这与 $a(\\cdot,\\cdot)$ 的有界性一起，通过 Babuška–Nečas 定理，意味着唯一性和稳定性。在离散形式中，由于耗散项，矩阵通常会变成复数且非厄米的。\n\n对数值方法的影响。在具有实系数的无损耗情况下，使用 $H(\\mathrm{curl})$ 协调的 Nédélec 单元离散化后的算子是厄米不定的；适用于对称不定系统的 Krylov 求解器，如最小残差法 (MINRES) 是合适的，而共轭梯度 (CG) 法要求正定性，因此不适用。在有损耗或有吸收边界条件（例如，也会引入非厄米性的完美匹配层）的情况下，矩阵变为非厄米的，广义最小残差法 (GMRES) 或相关方法是合适的。鲁棒性和效率进一步要求预处理器尊重 $H(\\mathrm{curl})$ 结构和离散的亥姆霍兹分解（例如，分块预处理器和基于 Hiptmair–Xu 算子的 $H(\\mathrm{curl})$ 求解器）。稳定化策略，例如添加散度惩罚项或使用拉格朗日乘子强制执行 $\\nabla \\cdot (\\varepsilon \\mathbf{E}) = 0$ 的混合形式，有助于抑制伪梯度模式。\n\n逐项分析：\n\nA. 此项声称无损耗弱形式在 $H_0(\\mathrm{curl}; \\Omega)$ 上是矫顽的，并且适用 CG 法。如上所示，$a_0(\\cdot,\\cdot)$ 是厄米且强不定的：梯度场导致 $a_0(\\nabla \\phi,\\nabla \\phi)  0$，矫顽性失效。离散矩阵不是对称正定的；CG 法不适用。结论：错误。\n\nB. 在无损耗腔体中，在某个本征频率处，算子是奇异的（存在非平凡核）。引入 $\\sigma  0$ 会增加一个严格耗散项 $- i \\omega \\sigma \\int \\mathbf{E} \\cdot \\overline{\\mathbf{v}}$，从而得到一个对角线上有正虚部的复半双线性形式，这使得在相位旋转后可以建立矫顽性（或 inf–sup）不等式，恢复唯一性并改善条件数。结论：正确。\n\nC. 对于 $\\mathrm{Im}(\\varepsilon)  0$ 或 $\\sigma  0$ 的情况，离散矩阵通常是复数且非厄米的。适用于非厄米系统的 Krylov 方法，如广义最小残差法 (GMRES) 是合适的；共轭梯度 (CG) 法仅限于厄米正定矩阵，在此不适用。结论：正确。\n\nD. 旋度算子核中梯度场的存在并不意味着正定性；它贡献了使 $a_0(\\mathbf{v}, \\mathbf{v})$ 在无损耗情况下为负的方向，从而加剧了不定性，并突出了稳定化或适当预处理的必要性，尤其是在共振附近。结论：错误。\n\nE. Nédélec 边元确保了 $H(\\mathrm{curl})$ 协调性，并保持了精确序列结构，这对于避免伪模式至关重要。通过增加散度约束或规范稳定化来增强该形式，可以抑制无旋伪分量。在共振附近，近似麦克斯韦算子并尊重 inf-sup 结构的分块预处理器能提高鲁棒性和收敛性。结论：正确。",
            "answer": "$$\\boxed{BCE}$$"
        },
        {
            "introduction": "现在，我们转向一个更前沿且极具实用性的应用：使用完美匹配层 (PML) 模拟开放区域中的波传播问题。这个练习要求您将弱形式的推导扩展到包含复杂各向异性材料张量的情况，这是PML技术的数学基础。这项实践综合了前面的概念，并将其应用于最先进的计算技术中，旨在挑战您如何为这些复杂材料正确地组装半双线性形式，并引入稳定化项，以确保在一个复杂的非厄米系统中同时实现计算精度和对伪模式的抑制。",
            "id": "3297838",
            "problem": "考虑在有界利普希茨域 $\\Omega \\subset \\mathbb{R}^3$ 中的时谐麦克斯韦方程组，采用 $e^{i \\omega t}$ 约定，该域分解为一个物理子域 $\\Omega_{\\mathrm{phys}}$ 和一个完美匹配层 (PML) 子域 $\\Omega_{\\mathrm{PML}}$，其中 $\\overline{\\Omega} = \\overline{\\Omega_{\\mathrm{phys}}} \\cup \\overline{\\Omega_{\\mathrm{PML}}}$ 且 $\\Omega_{\\mathrm{phys}} \\cap \\Omega_{\\mathrm{PML}} = \\emptyset$。令 $\\mathbf{E} : \\Omega \\to \\mathbb{C}^3$ 表示电场，令 $\\mathbf{J} : \\Omega \\to \\mathbb{C}^3$ 为给定的外加电流密度，且在 $\\Omega_{\\mathrm{phys}}$ 中满足 $\\nabla \\cdot \\mathbf{J} = 0$。在外边界 $\\partial \\Omega$ 上，假设为理想电导体 (PEC) 边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$，其中 $\\mathbf{n}$ 是单位外法向量。\n\n在频域中，$\\Omega$ 内的控制强形式为\n$$\n\\nabla \\times \\big( \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{E}(\\mathbf{x}) \\big) \\;-\\; \\omega^2 \\, \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E}(\\mathbf{x})\n\\;=\\; i \\omega \\, \\mathbf{J}(\\mathbf{x}) \\quad \\text{in } \\Omega,\n$$\n其本构张量 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}(\\mathbf{x})$ 是有界且分段光滑的。在 $\\Omega_{\\mathrm{phys}}$ 中，假设 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}(\\mathbf{x})$ 是实对称且一致正定的。在 $\\Omega_{\\mathrm{PML}}$ 中，它们是由复坐标伸展导出的复值各向异性张量，并满足强椭圆性，即存在常数 $c_\\varepsilon, c_\\mu  0$，使得对于所有 $\\mathbf{u}, \\boldsymbol{\\xi} \\in \\mathbb{C}^3$ 和几乎所有的 $\\mathbf{x} \\in \\Omega_{\\mathrm{PML}}$，\n$$\n\\mathrm{Re}\\!\\left( \\mathbf{u} \\cdot \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\overline{\\mathbf{u}} \\right) \\;\\ge\\; c_\\varepsilon \\, \\lVert \\mathbf{u} \\rVert^2, \n\\qquad\n\\mathrm{Re}\\!\\left( \\boldsymbol{\\xi} \\cdot \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\overline{\\boldsymbol{\\xi}} \\right) \\;\\ge\\; c_\\mu \\, \\lVert \\boldsymbol{\\xi} \\rVert^2.\n$$\n\n仅使用基本定律和核心定义，推导适用于在 $\\Omega$ 的四面体网格上使用 $p \\ge 1$ 次多项式的第一类 Nédélec 边元的弱形式，仔细说明函数空间设置、边界项处理以及来自 PML 的复各向异性系数如何进入半双线性形式。然后，选择下方的组装策略，该策略在使用第一类 Nédélec 边元和标准高斯求积时，能够保持稳定性（无伪梯度模式且在所述假设下离散问题良态）和精度（在存在空间变化的复各向异性系数时具有高阶相容性）。\n\n哪个选项是正确的？\n\nA. 使用边元空间 $\\mathbf{V}_h \\subset \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，该空间由 $p$ 次第一类 Nédélec 函数构成，在 $\\partial \\Omega$ 上的切向迹为零。组装在第一个参数上线性、在第二个参数上反线性的半双线性形式：\n$$\na(\\mathbf{E}, \\mathbf{v}) \\;=\\; \\int_{\\Omega} \\big( \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{E} \\big) \\cdot \\overline{\\nabla \\times \\mathbf{v}} \\, d\\Omega\n\\;-\\; \\omega^2 \\int_{\\Omega} \\big( \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E} \\big) \\cdot \\overline{\\mathbf{v}} \\, d\\Omega\n\\;+\\; \\eta \\int_{\\Omega} \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E} ) \\big) \\, \\overline{ \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{v} ) \\big) } \\, d\\Omega,\n$$\n其中稳定化参数 $\\eta  0$ 与 $h$ 无关，且选择得足够小以免污染精度。使用线性泛函\n$$\n\\ell(\\mathbf{v}) \\;=\\; i \\omega \\int_{\\Omega} \\mathbf{J} \\cdot \\overline{\\mathbf{v}} \\, d\\Omega.\n$$\n通过 $\\mathbf{V}_h \\subset \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$ 强施加 PEC 边界条件，因此没有边界项出现。在求积点处计算复各向异性张量 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}^{-1}(\\mathbf{x})$ 且不对它们进行共轭；采用足够精确的求积（例如，阶数至少为 $2p$）来捕捉它们的空间变化和多项式乘积。\n\nB. 使用不含本质边界条件的边元空间 $\\mathbf{V}_h \\subset \\mathbf{H}(\\mathrm{curl}; \\Omega)$，并通过添加分部积分产生的边界项来弱施加 PEC 边界。组装一个在两个参数上都是线性的双线性形式，并通过对 PML 系数进行共轭使其“埃尔米特化”：\n$$\n\\tilde{a}(\\mathbf{E}, \\mathbf{v}) \\;=\\; \\int_{\\Omega} \\big( \\overline{\\boldsymbol{\\mu}^{-1}}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{E} \\big) \\cdot \\nabla \\times \\mathbf{v} \\, d\\Omega\n\\;-\\; \\omega^2 \\int_{\\Omega} \\big( \\overline{\\boldsymbol{\\varepsilon}}(\\mathbf{x}) \\, \\mathbf{E} \\big) \\cdot \\mathbf{v} \\, d\\Omega,\n$$\n没有稳定化项，也不对测试函数进行复共轭。因为 $\\nabla \\cdot \\mathbf{J} = 0$，所以忽略散度约束。\n\nC. 用 $p$ 次的连续拉格朗日节点元 $\\mathbf{W}_h \\subset \\mathbf{H}^1(\\Omega)$ 替换边元，并通过对旋度施加罚项来强制切向连续性：\n$$\n\\hat{a}(\\mathbf{E}, \\mathbf{v}) \\;=\\; \\alpha \\int_{\\Omega} (\\nabla \\times \\mathbf{E}) \\cdot \\overline{\\nabla \\times \\mathbf{v}} \\, d\\Omega\n\\;-\\; \\omega^2 \\int_{\\Omega} \\big( \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E} \\big) \\cdot \\overline{\\mathbf{v}} \\, d\\Omega,\n$$\n其中 $\\alpha  0$ 选择得较大，并将各向异性 PML 近似为其各向同性平均值以简化求积。不使用散度稳定化。\n\nD. 使用第一类 Nédélec 元 $\\mathbf{V}_h \\subset \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，但组装形式\n$$\na_D(\\mathbf{E}, \\mathbf{v}) \\;=\\; \\int_{\\Omega} \\big( \\nabla \\times \\mathbf{E} \\big) \\cdot \\overline{ \\boldsymbol{\\mu}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{v} } \\, d\\Omega\n\\;-\\; \\omega^2 \\int_{\\Omega} \\big( \\mathrm{Re}\\,\\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E} \\big) \\cdot \\overline{\\mathbf{v}} \\, d\\Omega,\n$$\n舍弃 PML 张量的虚部以改善条件数，并省略任何与散度相关的稳定化。通过函数空间施加 PEC，使边界项消失。\n\n选择能够正确反映使用边元时对具有复各向异性 PML 系数的弱形式进行稳定且精确组装的选项。",
            "solution": "该问题要求为使用第一类 Nédélec 边元求解包含完美匹配层 (PML) 的区域中的时谐麦克斯韦方程组，给出正确的弱形式和组装策略。\n\n### 问题验证\n\n**第一步：提取已知条件**\n*   **控制方程（强形式）：**\n    $$ \\nabla \\times \\big( \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{E}(\\mathbf{x}) \\big) \\;-\\; \\omega^2 \\, \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E}(\\mathbf{x}) \\;=\\; i \\omega \\, \\mathbf{J}(\\mathbf{x}) \\quad \\text{in } \\Omega $$\n*   **区域：** 一个有界利普希茨域 $\\Omega \\subset \\mathbb{R}^3$，其中 $\\Omega$ 是一个物理子域 $\\Omega_{\\mathrm{phys}}$ 和一个 PML 子域 $\\Omega_{\\mathrm{PML}}$ 的并集。\n*   **边界条件：** 在外边界 $\\partial \\Omega$ 上的理想电导体 (PEC)，由 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ 给出。\n*   **源：** 一个外加电流密度 $\\mathbf{J}$，在 $\\Omega_{\\mathrm{phys}}$ 中具有性质 $\\nabla \\cdot \\mathbf{J} = 0$。\n*   **本构张量：** $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}(\\mathbf{x})$ 是有界且分段光滑的。\n    *   在 $\\Omega_{\\mathrm{phys}}$ 中，它们是实对称且一致正定的。\n    *   在 $\\Omega_{\\mathrm{PML}}$ 中，它们是复值各向异性张量，满足强椭圆性条件：\n      $$ \\mathrm{Re}\\!\\left( \\mathbf{u} \\cdot \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\overline{\\mathbf{u}} \\right) \\;\\ge\\; c_\\varepsilon \\, \\lVert \\mathbf{u} \\rVert^2, \\quad \\mathrm{Re}\\!\\left( \\boldsymbol{\\xi} \\cdot \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\overline{\\boldsymbol{\\xi}} \\right) \\;\\ge\\; c_\\mu \\, \\lVert \\boldsymbol{\\xi} \\rVert^2 $$\n*   **离散化：** 在四面体网格上使用次数为 $p \\ge 1$ 的第一类 Nédélec 边元。\n\n**第二步：使用提取的已知条件进行验证**\n问题陈述描述了计算电磁学中一个标准的设置，用于使用 PML 截断来模拟开放区域问题。控制方程是频域中正确的电场波动方程。本构张量的性质对于物理介质和功能性 PML 都是正确指定的。PEC 边界条件是标准的。所述任务是为一种特定的、成熟的有限元类型（Nédélec 元）推导合适的弱形式。问题是定义良好且科学上合理的。\n\n**第三步：结论与行动**\n问题是有效的。我们继续进行求解。\n\n### 弱形式的推导\n\n目标是找到一个适合用 Nédélec 边元进行近似的问题的弱形式。对于电场 $\\mathbf{E}$，能够容纳旋度算子和切向边界条件的自然函数空间是 $\\mathbf{H}_0(\\mathrm{curl}; \\Omega) = \\{ \\mathbf{u} \\in \\mathbf{L}^2(\\Omega)^3 : \\nabla \\times \\mathbf{u} \\in \\mathbf{L}^2(\\Omega)^3, \\mathbf{n} \\times \\mathbf{u}|_{\\partial\\Omega} = \\mathbf{0} \\}$。\n\n我们采用伽辽金法。我们寻求一个解 $\\mathbf{E} \\in \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，使得对于所有测试函数 $\\mathbf{v} \\in \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，以下等式成立：\n$$\n\\int_{\\Omega} \\left( \\nabla \\times \\big( \\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E} \\big) - \\omega^2 \\boldsymbol{\\varepsilon} \\mathbf{E} \\right) \\cdot \\overline{\\mathbf{v}} \\, d\\Omega = \\int_{\\Omega} (i \\omega \\mathbf{J}) \\cdot \\overline{\\mathbf{v}} \\, d\\Omega\n$$\n对测试函数 $\\mathbf{v}$ 取复共轭，用于定义复向量场的标准 $L^2$ 内积，这会导出一个半双线性形式（对第一个参数是线性的，对第二个参数是反线性的）。\n\n我们对第一项应用分部积分，使用向量恒等式 $\\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B}) = (\\nabla \\times \\mathbf{A}) \\cdot \\mathbf{B} - \\mathbf{A} \\cdot (\\nabla \\times \\mathbf{B})$。令 $\\mathbf{A} = \\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}$ 和 $\\mathbf{B} = \\overline{\\mathbf{v}}$。\n$$\n\\int_{\\Omega} \\left( \\nabla \\times (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\right) \\cdot \\overline{\\mathbf{v}} \\, d\\Omega = \\int_{\\Omega} (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\overline{\\mathbf{v}}) \\, d\\Omega + \\int_{\\partial\\Omega} \\left( (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\times \\overline{\\mathbf{v}} \\right) \\cdot \\mathbf{n} \\, dS.\n$$\n边界积分可以使用标量三重积的性质重写为 $\\int_{\\partial\\Omega} (\\mathbf{n} \\times \\overline{\\mathbf{v}}) \\cdot (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\, dS$。由于解和测试函数都在 $\\mathbf{H}_0(\\mathrm{curl}; \\Omega)$ 中，它们的切向迹 $\\mathbf{n} \\times \\mathbf{v}$ 在 $\\partial\\Omega$ 上为零。因此，边界积分消失。\n\n得到的弱形式为：求 $\\mathbf{E} \\in \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，使得对于所有 $\\mathbf{v} \\in \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$：\n$$\n\\int_{\\Omega} (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\cdot \\overline{\\nabla \\times \\mathbf{v}} \\, d\\Omega - \\omega^2 \\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\cdot \\overline{\\mathbf{v}} \\, d\\Omega = i \\omega \\int_{\\Omega} \\mathbf{J} \\cdot \\overline{\\mathbf{v}} \\, d\\Omega.\n$$\n\n**稳定性：** 半双线性形式 $a(\\mathbf{E}, \\mathbf{v}) = \\int_{\\Omega} (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\cdot \\overline{\\nabla \\times \\mathbf{v}} \\, d\\Omega - \\omega^2 \\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\cdot \\overline{\\mathbf{v}} \\, d\\Omega$ 的离散版本已知有一个大的核，对应于梯度场（伪模式），这些场位于旋度算子的零空间中。这会导致有限元矩阵的病态。\n\n为确保稳定性，必须增强该形式以控制这些非物理模式。这可以通过强制执行散度条件 $\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E}) = -\\frac{1}{i\\omega}\\nabla \\cdot \\mathbf{J}$ 来实现。由于 $\\mathbf{J}$ 是无散度的，这简化为 $\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E}) = 0$。一种标准技术是向弱形式中添加一个惩罚项，该项惩罚对该条件的违反。一个合适的稳定化半双线性形式是：\n$$\na_{\\text{stab}}(\\mathbf{E}, \\mathbf{v}) = a(\\mathbf{E}, \\mathbf{v}) + \\eta \\int_{\\Omega} \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon} \\mathbf{E} ) \\big) \\overline{ \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon} \\mathbf{v} ) \\big) } \\, d\\Omega,\n$$\n其中 $\\eta  0$ 是一个稳定化参数，通常是一个阶数为 $1$ 的常数。该项在梯度场的问题子空间上增加了矫顽性，确保了离散系统的良态性。\n\n**组装：** 对于使用 $p$ 次 Nédélec 基函数的有限元实现，积分通过数值求积进行计算。被积函数涉及高达 $2p$ 次的多项式乘积以及空间变化的、复的、各向异性的系数 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}^{-1}(\\mathbf{x})$。为保持精度，需要一个足够高阶的求积法则（例如，阶数为 $2p$ 或更高）。来自算子的复系数 $\\boldsymbol{\\varepsilon}$ 和 $\\boldsymbol{\\mu}^{-1}$ 必须按原样计算，无需共轭，因为它们是正在被离散化的线性算子的一部分。\n\n### 逐项分析\n\n**A. 正确。** 此选项提出了一种与推导出的稳定、精确的方法相一致的公式。\n- **函数空间：** 它正确地将离散空间 $\\mathbf{V}_h$ 识别为由第一类 Nédélec 函数构成的 $\\mathbf{H}_0(\\mathrm{curl}; \\Omega)$ 的子空间，这强行施加了 PEC 边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$。\n- **半双线性形式：** 该形式被正确地定义为半双线性（在第一个参数上线性，在第二个参数上反线性），并与标准弱形式相匹配。\n- **稳定化：** 它包含了必要的散度稳定化项 $\\eta \\int_{\\Omega} \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon} \\mathbf{E} ) \\big) \\overline{ \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon} \\mathbf{v} ) \\big) } \\, d\\Omega$，这对稳定性至关重要。\n- **线性泛函：** 右侧的线性泛函 $\\ell(\\mathbf{v})$ 是正确的。\n- **组装：** 它正确地指出复系数不被共轭，并且需要高阶求积。整个过程对应于一种最先进的方法。\n\n**B. 错误。** 此选项包含几个基本错误。\n- **形式：** 它提出了一个双线性形式而不是半双线性形式，并错误地共轭了材料系数（$\\overline{\\boldsymbol{\\mu}^{-1}}$, $\\overline{\\boldsymbol{\\varepsilon}}$），这不符合伽辽金法的推导。它还省略了对测试函数的共轭，这与标准的复内积不一致。\n- **边界条件：** 它建议弱施加边界条件，但没有在变分形式中包含必要的边界项。\n- **稳定化：** 它明确省略了稳定化项，这将导致一个病态、不稳定的离散系统，并受到伪梯度模式的困扰。其给出的理由（`因为 $\\nabla \\cdot \\mathbf{J} = 0$，所以忽略散度约束`）是错误的。\n\n**C. 错误。** 此选项提出了一种完全不同且有缺陷的方法。\n- **函数空间：** 它建议使用连续拉格朗日节点元（$\\mathbf{H}^1(\\Omega)$），这对于电场公式是错误的选择。该空间对向量场的所有分量施加连续性，这过于严格，并且已知会引入伪解。\n- **弱形式：** 它通过用一个标量参数 $\\alpha$ 替换磁导率张量 $\\boldsymbol{\\mu}^{-1}(\\mathbf{x})$ 来改变问题的物理性质。\n- **PML 模型：** 它建议用各向同性平均值来近似各向异性 PML，这将破坏“完美匹配”的特性并引起伪反射，从而违背了 PML 的初衷。\n\n**D. 错误。** 此选项也包含几个关键缺陷。\n- **弱形式：** 第一项 $\\int_{\\Omega} \\big( \\nabla \\times \\mathbf{E} \\big) \\cdot \\overline{ \\boldsymbol{\\mu}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{v} } \\, d\\Omega$ 是不正确的。它使用了 $\\boldsymbol{\\mu}$ 而不是控制方程中要求的 $\\boldsymbol{\\mu}^{-1}$。这从根本上改变了算子。\n- **PML 物理：** 它建议舍弃 PML 张量的虚部。虚部是产生吸收/阻尼的部分。去掉它们将使 PML 作为吸收层变得毫无用处。\n- **稳定化：** 它省略了必要的散度稳定化，导致方法不稳定。\n\n基于此分析，选项 A 是唯一描述了针对给定问题的正确、稳定且精确的数值方法的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}