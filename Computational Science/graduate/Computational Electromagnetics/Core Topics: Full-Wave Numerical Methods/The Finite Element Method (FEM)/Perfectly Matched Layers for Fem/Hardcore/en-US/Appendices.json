{
    "hands_on_practices": [
        {
            "introduction": "The \"perfectly matched\" property of a PML is its most crucial feature, ensuring that waves enter it without reflecting. This property arises from ensuring the wave impedance inside the PML is identical to that of the physical domain it truncates, which requires a specific transformation of both permittivity $\\epsilon$ and permeability $\\mu$. This exercise demonstrates the importance of this principle by having you analyze a flawed design where this condition is violated; by calculating the non-zero reflection, you will gain a concrete understanding of why the complete coordinate-stretching transformation is essential .",
            "id": "3339585",
            "problem": "Consider a two-dimensional transverse-electric configuration used in the Finite Element Method (FEM) for Computational Electromagnetics (CEM), where a Perfectly Matched Layer (PML) is intended to truncate an unbounded domain. The physical space is split into two homogeneous half-spaces separated by the planar interface at $x=0$. Region $x0$ is free space with permittivity $\\epsilon_{0}$ and permeability $\\mu_{0}$. Region $x0$ is constructed via a one-dimensional coordinate stretch in the $x$-direction by a constant complex stretch factor $s$ in order to form a material that should ideally be perfectly matched. According to the invariance of Maxwell’s equations under coordinate transformations, the proper construction would transform both the permittivity and the permeability. In this problem, however, you will provide a specific counterexample where only the permittivity is transformed but not the permeability.\n\nSpecifically, take a constant stretch $s=2$ and define the material in $x0$ to have constitutive parameters $\\epsilon_{2}=\\epsilon_{0}/s$ and $\\mu_{2}=\\mu_{0}$ (that is, only $\\epsilon$ is transformed, but $\\mu$ is left unaltered). A time-harmonic plane wave of angular frequency $\\omega$ is normally incident from $x0$ onto the interface at $x=0$, with the electric field polarized along $\\hat{\\mathbf{y}}$ and the magnetic field along $\\hat{\\mathbf{z}}$.\n\nUsing Maxwell’s equations, boundary conditions at the planar interface, and the definition of plane-wave impedance in a homogeneous isotropic medium, derive the reflection coefficient for the tangential electric field amplitude at $x=0$. Then, evaluate it for the specified counterexample ($s=2$, $\\epsilon_{2}=\\epsilon_{0}/s$, $\\mu_{2}=\\mu_{0}$).\n\nExpress the final answer as a dimensionless number. Round your answer to four significant figures.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in Maxwell's theory of electromagnetism, well-posed with sufficient information to determine a unique solution, and is stated objectively. The problem presents a standard boundary-value problem in wave propagation, and the premise of analyzing a material with incorrectly transformed constitutive relations is a valid and instructive exercise in computational electromagnetics.\n\nThe problem considers a time-harmonic plane wave, for which the fields have a time-dependency of $\\exp(j\\omega t)$ that is suppressed. The wave is normally incident on the interface at $x=0$. The electric field is polarized in the $\\hat{\\mathbf{y}}$ direction, and the magnetic field is in the $\\hat{\\mathbf{z}}$ direction. Thus, the fields can be written as $\\mathbf{E} = E_y(x) \\hat{\\mathbf{y}}$ and $\\mathbf{H} = H_z(x) \\hat{\\mathbf{z}}$.\n\nIn a source-free, homogeneous, and isotropic medium, Maxwell's curl equations in phasor-form are:\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega\\epsilon \\mathbf{E} $$\nFor the given field configuration, these equations simplify. The curl of $\\mathbf{E}$ is $\\nabla \\times \\mathbf{E} = \\frac{\\partial E_y}{\\partial x} \\hat{\\mathbf{z}}$, and the curl of $\\mathbf{H}$ is $\\nabla \\times \\mathbf{H} = -\\frac{\\partial H_z}{\\partial x} \\hat{\\mathbf{y}}$. The Maxwell's equations reduce to a system of coupled ordinary differential equations:\n$$ \\frac{dE_y}{dx} = -j\\omega\\mu H_z $$\n$$ \\frac{dH_z}{dx} = -j\\omega\\epsilon E_y $$\nDifferentiating the first equation with respect to $x$ and substituting the second gives the one-dimensional Helmholtz equation for $E_y$:\n$$ \\frac{d^2E_y}{dx^2} = -j\\omega\\mu \\frac{dH_z}{dx} = -j\\omega\\mu(-j\\omega\\epsilon E_y) = -\\omega^2\\mu\\epsilon E_y $$\n$$ \\frac{d^2E_y}{dx^2} + k^2 E_y = 0 $$\nwhere $k = \\omega\\sqrt{\\mu\\epsilon}$ is the wavenumber.\n\nIn Region $1$ ($x0$), the medium is free space with parameters $\\epsilon_1 = \\epsilon_0$ and $\\mu_1 = \\mu_0$. The wavenumber is $k_1 = \\omega\\sqrt{\\mu_0\\epsilon_0}$. The electric field is a superposition of an incident wave traveling in the $+x$ direction and a reflected wave traveling in the $-x$ direction:\n$$ E_{y1}(x) = E_I \\exp(-jk_1 x) + E_R \\exp(jk_1 x) $$\nwhere $E_I$ is the incident amplitude and $E_R$ is the reflected amplitude. The corresponding magnetic field is:\n$$ H_{z1}(x) = \\frac{j}{\\omega\\mu_1} \\frac{dE_{y1}}{dx} = \\frac{j}{\\omega\\mu_1} [-jk_1 E_I \\exp(-jk_1 x) + jk_1 E_R \\exp(jk_1 x)] = \\frac{k_1}{\\omega\\mu_1} [E_I \\exp(-jk_1 x) - E_R \\exp(jk_1 x)] $$\nThe intrinsic impedance of Region $1$ is $\\eta_1 = \\frac{\\omega\\mu_1}{k_1} = \\frac{\\omega\\mu_0}{\\omega\\sqrt{\\mu_0\\epsilon_0}} = \\sqrt{\\frac{\\mu_0}{\\epsilon_0}}$, which is the impedance of free space, $\\eta_0$. Thus,\n$$ H_{z1}(x) = \\frac{1}{\\eta_1} [E_I \\exp(-jk_1 x) - E_R \\exp(jk_1 x)] $$\n\nIn Region $2$ ($x0$), the material is defined by $\\epsilon_2 = \\epsilon_0/s$ and $\\mu_2 = \\mu_0$. The wavenumber is $k_2 = \\omega\\sqrt{\\mu_2\\epsilon_2} = \\omega\\sqrt{\\mu_0(\\epsilon_0/s)} = \\frac{\\omega\\sqrt{\\mu_0\\epsilon_0}}{\\sqrt{s}} = \\frac{k_1}{\\sqrt{s}}$. The field in this region is a transmitted wave traveling in the $+x$ direction:\n$$ E_{y2}(x) = E_T \\exp(-jk_2 x) $$\nwhere $E_T$ is the transmitted amplitude. The corresponding magnetic field is:\n$$ H_{z2}(x) = \\frac{k_2}{\\omega\\mu_2} E_T \\exp(-jk_2 x) = \\frac{1}{\\eta_2} E_T \\exp(-jk_2 x) $$\nThe intrinsic impedance of Region $2$ is $\\eta_2 = \\sqrt{\\frac{\\mu_2}{\\epsilon_2}} = \\sqrt{\\frac{\\mu_0}{\\epsilon_0/s}} = \\sqrt{s\\frac{\\mu_0}{\\epsilon_0}} = \\eta_1\\sqrt{s}$.\n\nAt the interface $x=0$, the tangential components of the electric and magnetic fields must be continuous.\nContinuity of $E_y$: $E_{y1}(0) = E_{y2}(0)$\n$$ E_I + E_R = E_T $$\nContinuity of $H_z$: $H_{z1}(0) = H_{z2}(0)$\n$$ \\frac{1}{\\eta_1} [E_I - E_R] = \\frac{1}{\\eta_2} E_T $$\nWe now have a system of two equations with three unknown amplitudes. The reflection coefficient, $\\Gamma$, is defined as the ratio of the reflected to the incident electric field amplitudes, $\\Gamma = E_R/E_I$. To find $\\Gamma$, we eliminate $E_T$. From the first equation, $E_T = E_I + E_R$. Substituting this into the second equation:\n$$ \\frac{1}{\\eta_1} [E_I - E_R] = \\frac{1}{\\eta_2} [E_I + E_R] $$\nRearranging the terms to solve for the ratio $E_R/E_I$:\n$$ \\eta_2 [E_I - E_R] = \\eta_1 [E_I + E_R] $$\n$$ E_I(\\eta_2 - \\eta_1) = E_R(\\eta_1 + \\eta_2) $$\n$$ \\Gamma = \\frac{E_R}{E_I} = \\frac{\\eta_2 - \\eta_1}{\\eta_2 + \\eta_1} $$\nThis is the general expression for the reflection coefficient at normal incidence.\n\nNow, we substitute the specific impedances for this problem: $\\eta_1 = \\eta_0$ and $\\eta_2 = \\eta_0\\sqrt{s}$.\n$$ \\Gamma = \\frac{\\eta_0\\sqrt{s} - \\eta_0}{\\eta_0\\sqrt{s} + \\eta_0} = \\frac{\\eta_0(\\sqrt{s} - 1)}{\\eta_0(\\sqrt{s} + 1)} = \\frac{\\sqrt{s} - 1}{\\sqrt{s} + 1} $$\nThe problem specifies the value of the stretch factor $s=2$. Substituting this value into the expression for $\\Gamma$:\n$$ \\Gamma = \\frac{\\sqrt{2} - 1}{\\sqrt{2} + 1} $$\nTo obtain a numerical value, we can first rationalize the expression:\n$$ \\Gamma = \\left(\\frac{\\sqrt{2} - 1}{\\sqrt{2} + 1}\\right) \\left(\\frac{\\sqrt{2} - 1}{\\sqrt{2} - 1}\\right) = \\frac{(\\sqrt{2} - 1)^2}{(\\sqrt{2})^2 - 1^2} = \\frac{2 - 2\\sqrt{2} + 1}{2 - 1} = 3 - 2\\sqrt{2} $$\nUsing the approximation $\\sqrt{2} \\approx 1.41421356$:\n$$ \\Gamma \\approx 3 - 2(1.41421356) = 3 - 2.82842712 = 0.17157288 $$\nRounding the result to four significant figures, we get $0.1716$. The non-zero reflection coefficient confirms that this material construction, where the permeability is not transformed, is not perfectly matched to free space, as expected.",
            "answer": "$$\\boxed{0.1716}$$"
        },
        {
            "introduction": "Once a wave enters the PML without reflection, it must be efficiently attenuated to prevent it from reaching the outer boundary and reflecting back. The rate of this attenuation is governed by the PML's conductivity profile $\\sigma(x)$ and its thickness $L$. This practice guides you through the derivation of a fundamental design formula that connects the maximum conductivity $\\sigma_{\\max}$ to a desired reflection coefficient $R$, equipping you with a cornerstone analytical tool for designing PMLs to meet specific performance requirements .",
            "id": "3339737",
            "problem": "Consider a one-dimensional truncation of a homogeneous, isotropic electromagnetic domain in the Finite Element Method (FEM) using a Perfectly Matched Layer (PML). The physical domain occupies $x  0$ with material parameters permittivity $\\epsilon$ and permeability $\\mu$, and it is truncated for $x \\geq 0$ by a uniaxial PML of thickness $L$. Assume time-harmonic fields with the $\\exp(j \\omega t)$ convention, and normal incidence of a plane wave from $x  0$ into the PML. Let the characteristic impedance of the physical domain be $\\eta_{0} = \\sqrt{\\mu / \\epsilon}$ and its wavenumber be $k_{0} = \\omega \\sqrt{\\mu \\epsilon}$.\n\nThe PML is implemented via complex coordinate stretching in the $x$-direction with $s_{x}(x) = 1 + \\frac{\\sigma(x)}{j \\omega \\epsilon}$, where the scalar conductivity is graded as a polynomial of order $m \\in \\mathbb{N}$ over its thickness:\n$$\n\\sigma(x) = \\sigma_{\\max} \\left( \\frac{x}{L} \\right)^{m}, \\quad x \\in [0, L].\n$$\nAssume $s_{x}$ is the only nontrivial stretch (i.e., $\\kappa_{x} = 1$ and no auxiliary loss terms), and that the PML is terminated at $x = L$ by a perfect electric conductor. Under these assumptions, the entrance interface at $x = 0$ is perfectly matched, and any reflection measured back in the physical domain arises solely from the finite thickness of the attenuating PML and the termination at $x = L$.\n\nStarting from the frequency-domain Maxwell curl equations in the physical domain,\n$$\n\\nabla \\times \\mathbf{H} = j \\omega \\epsilon \\mathbf{E}, \\qquad \\nabla \\times \\mathbf{E} = - j \\omega \\mu \\mathbf{H},\n$$\nand the effect of the complex coordinate stretch on the one-dimensional plane-wave solution, derive a closed-form analytic expression for $\\sigma_{\\max}$ that achieves a specified target amplitude reflection factor $R$ with $0  R  1$ at $x = 0$. Your result must be expressed solely in terms of $m$, $R$, $\\eta_{0}$, and $L$. Do not introduce any additional parameters. Provide the final expression for $\\sigma_{\\max}$ as your answer. No numerical evaluation is required, and no units should be included in the final expression.",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and objective, representing a standard theoretical problem in computational electromagnetics. We proceed with the derivation of the expression for $\\sigma_{\\max}$.\n\nThe problem considers a time-harmonic plane wave with time dependence $\\exp(j \\omega t)$ normally incident from the physical domain ($x0$) onto a Perfectly Matched Layer (PML) occupying the region $0 \\le x \\le L$.\n\nIn the physical domain ($x0$), the medium is homogeneous and isotropic with permittivity $\\epsilon$ and permeability $\\mu$. The electric field, assumed to be polarized in the $y$-direction, is a superposition of an incident and a reflected wave:\n$$\nE_y(x) = E_{inc} \\exp(-j k_0 x) + E_{ref} \\exp(j k_0 x)\n$$\nwhere $k_0 = \\omega \\sqrt{\\mu \\epsilon}$ is the wavenumber. The corresponding magnetic field is:\n$$\nH_z(x) = \\frac{1}{\\eta_0} \\left( E_{inc} \\exp(-j k_0 x) - E_{ref} \\exp(j k_0 x) \\right)\n$$\nwhere $\\eta_0 = \\sqrt{\\mu / \\epsilon}$ is the characteristic impedance of the medium. The reflection coefficient at the interface $x=0$ is defined as $\\Gamma = E_{ref} / E_{inc}$.\n\nInside the PML ($0 \\le x \\le L$), we employ the uniaxial PML formulation based on complex coordinate stretching. The stretch function is $s_x(x) = 1 + \\frac{\\sigma(x)}{j \\omega \\epsilon}$. This modifies the Maxwell's equations for a plane wave propagating in the $x$-direction. The relevant curl equations become:\n$$\n\\frac{\\partial E_y}{\\partial x} = -j \\omega \\mu s_x(x) H_z\n$$\n$$\n\\frac{\\partial H_z}{\\partial x} = -j \\omega \\epsilon s_x(x) E_y\n$$\nCombining these two first-order equations yields a second-order wave equation for $E_y(x)$:\n$$\n\\frac{\\partial^2 E_y}{\\partial x^2} - \\frac{1}{s_x(x)} \\frac{\\partial s_x(x)}{\\partial x} \\frac{\\partial E_y}{\\partial x} + k_0^2 [s_x(x)]^2 E_y = 0\n$$\nThe exact general solution to this equation is given by a superposition of forward and backward propagating waves:\n$$\nE_y(x) = A \\exp(-j k_0 \\phi(x)) + B \\exp(j k_0 \\phi(x))\n$$\nwhere $\\phi(x)$ is the complex phase integral:\n$$\n\\phi(x) = \\int_0^x s_x(u) \\, du\n$$\nThe corresponding magnetic field inside the PML is found from $H_z = \\frac{j}{\\omega \\mu s_x} \\frac{\\partial E_y}{\\partial x}$:\n$$\nH_z(x) = \\frac{1}{\\eta_0} \\left( A \\exp(-j k_0 \\phi(x)) - B \\exp(j k_0 \\phi(x)) \\right)\n$$\nThis result shows that the local wave impedance remains $\\eta_0$ throughout the PML, which is the \"perfectly matched\" property.\n\nWe first evaluate the phase integral $\\phi(x)$ using the given conductivity profile $\\sigma(x) = \\sigma_{\\max} (x/L)^m$:\n$$\ns_x(u) = 1 + \\frac{\\sigma_{\\max} (u/L)^m}{j \\omega \\epsilon} = 1 - j \\frac{\\sigma_{\\max}}{\\omega \\epsilon L^m} u^m\n$$\nIntegrating from $0$ to $x$:\n$$\n\\phi(x) = \\int_0^x \\left( 1 - j \\frac{\\sigma_{\\max}}{\\omega \\epsilon L^m} u^m \\right) du = x - j \\frac{\\sigma_{\\max}}{\\omega \\epsilon L^m} \\frac{x^{m+1}}{m+1}\n$$\nNext, we apply the boundary conditions.\nAt the back of the PML, $x=L$, there is a perfect electric conductor (PEC), so the total tangential electric field must be zero:\n$$\nE_y(L) = A \\exp(-j k_0 \\phi(L)) + B \\exp(j k_0 \\phi(L)) = 0\n$$\nThis gives a relationship between the coefficients $A$ and $B$:\n$$\nB = -A \\exp(-2 j k_0 \\phi(L))\n$$\nAt the interface, $x=0$, the tangential electric and magnetic fields must be continuous. By normalizing the incident wave amplitude to $E_{inc}=1$, we have $E_{ref} = \\Gamma$.\nContinuity of $E_y$ at $x=0$:\n$$\nE_y(0^-) = 1 + \\Gamma \\quad \\text{and} \\quad E_y(0^+) = A \\exp(0) + B \\exp(0) = A+B\n$$\n$$\n1 + \\Gamma = A + B\n$$\nContinuity of $H_z$ at $x=0$:\n$$\nH_z(0^-) = \\frac{1}{\\eta_0}(1 - \\Gamma) \\quad \\text{and} \\quad H_z(0^+) = \\frac{1}{\\eta_0}(A - B)\n$$\n$$\n1 - \\Gamma = A - B\n$$\nSolving these two interface equations for $A$ and $B$ gives $A=1$ and $B=\\Gamma$. Substituting these into the relation from the PEC boundary condition yields the reflection coefficient $\\Gamma$:\n$$\n\\Gamma = -(1) \\exp(-2 j k_0 \\phi(L)) = -\\exp(-2 j k_0 \\phi(L))\n$$\nThe problem specifies a target amplitude reflection factor $R = |\\Gamma|$. Thus, we take the magnitude:\n$$\nR = |-\\exp(-2 j k_0 \\phi(L))| = |\\exp(\\text{Re}\\{-2 j k_0 \\phi(L)\\}) \\exp(j \\cdot \\text{Im}\\{-2 j k_0 \\phi(L)\\})|\n$$\n$R = \\exp(\\text{Re}\\{-2 j k_0 \\phi(L)\\})$.\nLet's evaluate the argument of the exponential. First, we find $\\phi(L)$:\n$$\n\\phi(L) = L - j \\frac{\\sigma_{\\max}}{\\omega \\epsilon L^m} \\frac{L^{m+1}}{m+1} = L - j \\frac{\\sigma_{\\max} L}{\\omega \\epsilon (m+1)}\n$$\nNow, we compute the exponent $-2 j k_0 \\phi(L)$:\n$$\n-2 j k_0 \\phi(L) = -2 j k_0 \\left( L - j \\frac{\\sigma_{\\max} L}{\\omega \\epsilon (m+1)} \\right) = -2 j k_0 L - \\frac{2 k_0 \\sigma_{\\max} L}{\\omega \\epsilon (m+1)}\n$$\nWe use the relations $k_0 = \\omega\\sqrt{\\mu\\epsilon}$ and $\\eta_0 = \\sqrt{\\mu/\\epsilon}$ to simplify the second term:\n$$\n\\frac{k_0}{\\omega \\epsilon} = \\frac{\\omega\\sqrt{\\mu\\epsilon}}{\\omega\\epsilon} = \\sqrt{\\frac{\\mu}{\\epsilon}} = \\eta_0\n$$\nThe exponent becomes:\n$$\n-2 j k_0 \\phi(L) = -2 j k_0 L - \\frac{2 \\eta_0 \\sigma_{\\max} L}{m+1}\n$$\nThe real part of this exponent determines the amplitude decay:\n$$\n\\text{Re}\\{-2 j k_0 \\phi(L)\\} = -\\frac{2 \\eta_0 \\sigma_{\\max} L}{m+1}\n$$\nTherefore, the amplitude reflection factor $R$ is:\n$$\nR = \\exp\\left(-\\frac{2 \\eta_0 \\sigma_{\\max} L}{m+1}\\right)\n$$\nFinally, we solve this equation for $\\sigma_{\\max}$. Taking the natural logarithm of both sides:\n$$\n\\ln(R) = -\\frac{2 \\eta_0 \\sigma_{\\max} L}{m+1}\n$$\nSince the problem states $0  R  1$, $\\ln(R)$ is negative, ensuring that $\\sigma_{\\max}$ is positive. Rearranging for $\\sigma_{\\max}$:\n$$\n\\sigma_{\\max} = -\\frac{(m+1) \\ln(R)}{2 \\eta_0 L}\n$$\nThis expression gives the required maximum conductivity $\\sigma_{\\max}$ in terms of the polynomial order $m$, the target reflection $R$, the characteristic impedance $\\eta_0$, and the PML thickness $L$, as requested.",
            "answer": "$$\n\\boxed{-\\frac{(m+1) \\ln(R)}{2 \\eta_{0} L}}\n$$"
        },
        {
            "introduction": "Analytical design formulas provide a vital starting point, but in practice, a PML is implemented on a discrete Finite Element Method (FEM) mesh. The performance of this numerical PML depends critically on the mesh's ability to resolve both the wave's phase and its exponential decay, a challenge that becomes acute for waves at grazing incidence. This coding exercise bridges theory and practice by tasking you with designing a PML for this difficult scenario while respecting numerical resolution constraints, forcing you to adapt the design based on FEM parameters like element size $h$ and polynomial order $p$ .",
            "id": "3339573",
            "problem": "Consider a time-harmonic electromagnetic plane wave in a homogeneous, isotropic, source-free medium with angular frequency $\\,\\omega\\,$ and free-space wavenumber $\\,k = 2\\pi/\\lambda\\,$, where $\\,\\lambda\\,$ is the wavelength expressed in meters. The wave propagates towards a truncation boundary to be terminated by a Perfectly Matched Layer (PML), which is implemented using the Finite Element Method (FEM). The wave impinges on the PML at a grazing incidence angle $\\,\\theta = 89.9^\\circ\\,$ measured with respect to the boundary normal (use degrees as the angle unit). The PML is applied along the boundary-normal coordinate $\\,x\\,$ and is modeled by a complex coordinate stretching of the form $\\,s_x(x) = 1 + i\\,a(x)\\,$, where $\\,a(x)\\,$ is a nonnegative attenuation profile. Assume a standard polynomial graded attenuation profile $\\,a(x) = a_{\\max}\\,(x/L)^m\\,$, with PML thickness $\\,L\\,$ in meters, maximum attenuation parameter $\\,a_{\\max}  0\\,$, and polynomial grade $\\,m \\in \\mathbb{N}\\,$. The PML thickness $\\,L\\,$ should be chosen so that the round-trip reflection amplitude at the entrance plane is less than a target level $\\,R_{\\text{target}} = 10^{-6}\\,$.\n\nBase your derivation on the following fundamental principles:\n- Maxwell’s equations in a source-free homogeneous medium, leading to plane-wave solutions with dispersion relation $\\,|\\mathbf{k}| = k\\,$, and the definition of the boundary-normal wavenumber component $\\,k_n = k\\cos\\theta\\,$.\n- The conceptual definition of a Perfectly Matched Layer (PML) as a complex coordinate stretch in the boundary-normal direction, and the resulting exponential attenuation dictated by the imaginary part of the stretched wavenumber experienced by the boundary-normal wave component.\n- The Finite Element Method (FEM) discretization, with polynomial order $\\,p\\,$ and element size $\\,h\\,$ in meters for the PML region, implying resolution constraints on both phase variation and amplitude decay per degree-of-freedom.\n\nIn addition to the continuous attenuation requirement, impose the following FEM-resolution constraints for numerical realism:\n- Phase resolution constraint: the boundary-normal phase advance per effective degree-of-freedom must satisfy $\\,k_n \\,\\Delta x \\le \\varphi_{\\max}\\,$, where $\\,\\Delta x = h/p\\,$ and $\\,\\varphi_{\\max} = 0.5\\,$ radians.\n- Attenuation resolution constraint: the boundary-normal amplitude decay per effective degree-of-freedom must satisfy $\\,\\operatorname{Im}(k_n s_x)\\,\\Delta x \\le \\delta_{\\max}\\,$, where $\\,\\delta_{\\max} = 0.3\\,$ (dimensionless), and $\\,\\operatorname{Im}(k_n s_x) = k_n a(x)\\,$.\n\nAssume a nominal design choice $\\,a_{\\max} = 1.0\\,$ unless the attenuation resolution constraint enforces a stricter upper bound. You must determine:\n1. The minimal continuous-thickness estimate $\\,L_{\\text{cont}}(\\theta)\\,$ that achieves $\\,R_{\\text{target}}\\,$ when ignoring discretization limits but using the specified $\\,a(x)\\,$ profile.\n2. The minimal FEM-constrained thickness $\\,L_{\\text{fem}}(\\theta)\\,$ that achieves $\\,R_{\\text{target}}\\,$ while respecting the phase and attenuation resolution constraints, treating the latter as an upper bound on $\\,a_{\\max}\\,$. If the resulting $\\,L_{\\text{fem}}\\,$ is less than a single PML element thickness $\\,h\\,$, set $\\,L_{\\text{fem}} = h\\,$ to maintain at least one PML element.\n\nYour program must compute $\\,L_{\\text{fem}}\\,$ and $\\,L_{\\text{cont}}\\,$ for the following test suite of cases (all lengths in meters, angles in degrees, and output thicknesses in meters):\n- Case 1 (happy path): $\\,\\lambda = 0.01\\,$, $\\,p = 4\\,$, $\\,h = 0.001\\,$, $\\,m = 3\\,$, $\\,\\theta = 89.9^\\circ\\,$.\n- Case 2 (attenuation-limited edge): $\\,\\lambda = 0.001\\,$, $\\,p = 3\\,$, $\\,h = 0.002\\,$, $\\,m = 3\\,$, $\\,\\theta = 89.9^\\circ\\,$.\n- Case 3 (intermediate regime): $\\,\\lambda = 0.002\\,$, $\\,p = 10\\,$, $\\,h = 0.005\\,$, $\\,m = 3\\,$, $\\,\\theta = 89.9^\\circ\\,$.\n- Case 4 (fine mesh boundary): $\\,\\lambda = 0.01\\,$, $\\,p = 8\\,$, $\\,h = 0.0002\\,$, $\\,m = 3\\,$, $\\,\\theta = 89.9^\\circ\\,$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[L_{\\text{fem},1},L_{\\text{cont},1},L_{\\text{fem},2},L_{\\text{cont},2},L_{\\text{fem},3},L_{\\text{cont},3},L_{\\text{fem},4},L_{\\text{cont},4}]$, where each thickness is expressed in meters. Angles must be interpreted in degrees when computing $\\,\\cos\\theta\\,$. Use $\\,R_{\\text{target}} = 10^{-6}\\,$ and $\\,a_{\\max} = 1.0\\,$ unless reduced by the attenuation resolution constraint.",
            "solution": "We begin with Maxwell’s equations in a source-free, homogeneous, isotropic medium, which for time-harmonic fields with angular frequency $\\,\\omega\\,$ yield plane-wave solutions. Let $\\,\\mathbf{k}\\,$ denote the wavevector, with magnitude $\\,k = 2\\pi/\\lambda\\,$ where $\\,\\lambda\\,$ is the wavelength. Consider a planar truncation boundary with outward normal along the $\\,x\\,$-axis. A plane wave impinging at an angle $\\,\\theta\\,$ with respect to the boundary normal has boundary-normal wavenumber component $\\,k_n = k\\cos\\theta\\,$. At grazing incidence $\\,\\theta = 89.9^\\circ\\,$, $\\,\\cos\\theta\\,$ is small, so $\\,k_n\\,$ is small.\n\nA Perfectly Matched Layer (PML) can be viewed as a complex coordinate stretching in the boundary-normal direction, $\\,x \\mapsto \\bar{x}\\,$ with stretch $\\,s_x(x) = 1 + i\\,a(x)\\,$ where $\\,a(x) \\ge 0\\,$. Under this transformation, the boundary-normal component of the wavenumber becomes $\\,k_n s_x(x) = k_n \\left(1 + i\\,a(x)\\right)\\,$, whose imaginary part $\\,\\operatorname{Im}\\left(k_n s_x(x)\\right) = k_n a(x)\\,$ produces exponential amplitude attenuation along $\\,x\\,$. For a ray traversing the PML from $\\,x=0\\,$ to $\\,x=L\\,$ and reflecting off a termination, a leading-order estimate of the round-trip amplitude reflection at the entrance plane is governed by the accumulated attenuation $\\,A\\,$, where\n$$\nA \\equiv \\int_0^L \\operatorname{Im}\\left(k_n s_x(x)\\right)\\,\\mathrm{d}x \\;=\\; \\int_0^L k_n\\,a(x)\\,\\mathrm{d}x \\;=\\; k_n \\int_0^L a(x)\\,\\mathrm{d}x.\n$$\nAssuming negligible mismatch at the entrance due to perfect matching, the round-trip reflection amplitude scales like\n$$\nR \\approx \\exp\\!\\left(-2A\\right).\n$$\nTo enforce $\\,R \\le R_{\\text{target}}\\,$, we require\n$$\n2A \\;\\ge\\; \\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right).\n$$\n\nWe choose a standard polynomial attenuation profile $\\,a(x) = a_{\\max} (x/L)^m\\,$ for $\\,x \\in [0,L]\\,$ with $\\,m \\in \\mathbb{N}\\,$ and $\\,a_{\\max}  0\\,$. The integral of $\\,a(x)\\,$ over the thickness is\n$$\n\\int_0^L a(x)\\,\\mathrm{d}x \\;=\\; a_{\\max} \\int_0^L \\left(\\frac{x}{L}\\right)^m \\mathrm{d}x \\;=\\; a_{\\max} \\,L \\int_0^1 t^m \\,\\mathrm{d}t \\;=\\; a_{\\max} \\,L \\,\\frac{1}{m+1}.\n$$\nHence the accumulated attenuation becomes\n$$\nA \\;=\\; k_n\\, a_{\\max}\\, \\frac{L}{m+1}.\n$$\nImposing $\\,\\exp(-2A) \\le R_{\\text{target}}\\,$ yields\n$$\n2\\,k_n\\, a_{\\max}\\, \\frac{L}{m+1} \\;\\ge\\; \\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right),\n$$\nand the minimal continuous-thickness estimate (ignoring discretization limits) is therefore\n$$\nL_{\\text{cont}}(\\theta) \\;=\\; \\frac{\\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right)}{2\\,k_n} \\cdot \\frac{m+1}{a_{\\max}} \\;=\\; \\frac{\\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right)}{2\\,k\\cos\\theta} \\cdot \\frac{m+1}{a_{\\max}}.\n$$\n\nIn a Finite Element Method (FEM) discretization with polynomial order $\\,p\\,$ and element size $\\,h\\,$ in the PML region, let the effective degree-of-freedom spacing be $\\,\\Delta x = h/p\\,$. Numerical accuracy imposes resolution constraints on both phase advance and attenuation per effective degree-of-freedom. We enforce:\n- Phase resolution constraint:\n$$\nk_n \\,\\Delta x \\;\\le\\; \\varphi_{\\max},\n$$\nwith $\\,\\varphi_{\\max} = 0.5\\,$ radians. This constraint requires the mesh to sufficiently resolve the boundary-normal oscillation. In the present benchmark, the chosen test cases satisfy this bound, so no adjustment to $\\,L\\,$ is performed based on phase alone.\n- Attenuation resolution constraint:\n$$\n\\operatorname{Im}\\!\\left(k_n s_x\\right)\\,\\Delta x \\;=\\; k_n\\,a(x)\\,\\Delta x \\;\\le\\; \\delta_{\\max},\n$$\nwith $\\,\\delta_{\\max} = 0.3\\,$. Because $\\,a(x)\\,$ is monotone increasing with maximum $\\,a_{\\max}\\,$, satisfying the constraint at $\\,x=L\\,$ guarantees it everywhere. This yields an upper bound on $\\,a_{\\max}\\,$:\n$$\nk_n\\,a_{\\max}\\,\\Delta x \\;\\le\\; \\delta_{\\max}\n\\;\\;\\Rightarrow\\;\\;\na_{\\max} \\;\\le\\; \\frac{\\delta_{\\max}}{k_n\\,\\Delta x}\n\\;=\\; \\frac{\\delta_{\\max}\\,p}{k_n\\,h}.\n$$\nWe adopt a nominal design $\\,a_{\\max}^{\\text{nom}} = 1.0\\,$ and enforce the attenuation resolution constraint by defining\n$$\na_{\\max}^{\\text{eff}} \\;=\\; \\min\\!\\left(a_{\\max}^{\\text{nom}}, \\frac{\\delta_{\\max}\\,p}{k_n\\,h}\\right).\n$$\nSubstituting $\\,a_{\\max}^{\\text{eff}}\\,$ into the continuous-thickness formula gives the FEM-constrained minimal thickness\n$$\nL_{\\text{fem}}(\\theta) \\;=\\; \\frac{\\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right)}{2\\,k\\cos\\theta} \\cdot \\frac{m+1}{a_{\\max}^{\\text{eff}}}.\n$$\nFinally, to ensure at least one PML element is present, we enforce\n$$\nL_{\\text{fem}} \\;\\leftarrow\\; \\max\\!\\left(L_{\\text{fem}},\\,h\\right).\n$$\n\nAlgorithmic procedure for each test case:\n1. Compute $\\,k = 2\\pi/\\lambda\\,$ and $\\,k_n = k \\cos\\theta\\,$ with $\\,\\theta\\,$ in degrees.\n2. Set $\\,a_{\\max}^{\\text{nom}} = 1.0\\,$, $\\,\\varphi_{\\max} = 0.5\\,$ radians, and $\\,\\delta_{\\max} = 0.3\\,$.\n3. Compute $\\,\\Delta x = h/p\\,$. Verify $\\,k_n \\Delta x \\le \\varphi_{\\max}\\,$ (the provided test suite satisfies this).\n4. Compute $\\,a_{\\max}^{\\text{eff}} = \\min\\!\\left(1.0, \\delta_{\\max} p/(k_n h)\\right)\\,$.\n5. Compute $\\,L_{\\text{cont}} = \\ln(1/R_{\\text{target}})\\big/\\left(2 k_n\\right) \\cdot (m+1)/a_{\\max}^{\\text{nom}}\\,$.\n6. Compute $\\,L_{\\text{fem}} = \\ln(1/R_{\\text{target}})\\big/\\left(2 k_n\\right) \\cdot (m+1)/a_{\\max}^{\\text{eff}}\\,$ and then set $\\,L_{\\text{fem}} \\leftarrow \\max(L_{\\text{fem}}, h)\\,$.\n\nValidation against analytic estimates is achieved by reporting both $\\,L_{\\text{fem}}\\,$ and $\\,L_{\\text{cont}}\\,$ for each test case. Equality holds when $\\,a_{\\max}^{\\text{eff}} = a_{\\max}^{\\text{nom}}\\,$; otherwise, $\\,L_{\\text{fem}} \\ge L_{\\text{cont}}\\,$ due to the attenuation-resolution cap on $\\,a_{\\max}\\,$. With grazing incidence $\\,\\theta = 89.9^\\circ\\,$, the factor $\\,\\cos\\theta\\,$ is small, so both continuous and constrained estimates can be large, highlighting the known difficulty of standard PMLs under grazing incidence without additional techniques such as complex frequency shifting.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_Ls(lambda_m, p, h, m, theta_deg, R_target=1e-6,\n               a_max_nom=1.0, delta_max=0.3, phi_max=0.5):\n    # Compute wavenumber and boundary-normal component\n    k = 2.0 * np.pi / lambda_m\n    theta_rad = np.deg2rad(theta_deg)\n    cos_theta = np.cos(theta_rad)\n    k_n = k * cos_theta\n\n    # Effective DOF spacing\n    dx = h / p\n\n    # Phase resolution check (not altering L, just for completeness)\n    # Ensure k_n * dx = phi_max; test cases are chosen to satisfy this.\n    # If violated, the FEM setup is under-resolved in phase.\n    # We proceed regardless but could flag or adjust in a more elaborate tool.\n\n    # Attenuation resolution constraint: k_n * a_max_eff * dx = delta_max\n    # = a_max_eff = delta_max / (k_n * dx) = delta_max * p / (k_n * h)\n    # Use nominal a_max unless limited by attenuation resolution.\n    # Handle extremely small k_n to avoid division by zero.\n    if k_n = 0.0:\n        # In pathological case (exact grazing or beyond), set huge L_fem and L_cont.\n        return float('inf'), float('inf')\n\n    a_lim = delta_max * p / (k_n * h)\n    a_max_eff = min(a_max_nom, a_lim)\n\n    # Continuous estimate with nominal a_max\n    L_cont = (np.log(1.0 / R_target) / (2.0 * k_n)) * ((m + 1) / a_max_nom)\n\n    # FEM-constrained estimate\n    L_fem = (np.log(1.0 / R_target) / (2.0 * k_n)) * ((m + 1) / a_max_eff)\n\n    # Ensure at least one PML element is present\n    L_fem = max(L_fem, h)\n\n    return L_fem, L_cont\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (lambda_m, p, h, m, theta_deg)\n    test_cases = [\n        (0.01, 4, 0.001, 3, 89.9),   # Case 1: happy path\n        (0.001, 3, 0.002, 3, 89.9),  # Case 2: attenuation-limited edge\n        (0.002, 10, 0.005, 3, 89.9), # Case 3: intermediate regime\n        (0.01, 8, 0.0002, 3, 89.9),  # Case 4: fine mesh boundary\n    ]\n\n    results = []\n    for lam, p, h, m, theta in test_cases:\n        L_fem, L_cont = compute_Ls(lam, p, h, m, theta)\n        results.append(L_fem)\n        results.append(L_cont)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}