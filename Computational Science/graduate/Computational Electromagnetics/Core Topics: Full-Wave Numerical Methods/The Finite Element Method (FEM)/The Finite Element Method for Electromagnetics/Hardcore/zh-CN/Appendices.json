{
    "hands_on_practices": [
        {
            "introduction": "掌握电磁学有限元方法的关键在于深刻理解其基本构件——矢量基函数。本练习将引导你亲手在一个标准的四面体单元上构建一阶Nédélec矢量基函数，并验证它们的基本性质。通过这个过程，你不仅能将抽象的数学定义转化为具体的矢量场表达式，还能学会如何利用这些基函数来插值一个给定的电磁场，这是进行任何有限元分析的起点。",
            "id": "3329964",
            "problem": "考虑一个用于计算电磁学（CEM）中有限元法（FEM）的单个四面体单元。设参考四面体的顶点为 $v_{1} = (0,0,0)$, $v_{2} = (1,0,0)$, $v_{3} = (0,1,0)$ 和 $v_{4} = (0,0,1)$，其六条有向边取为 $(1,2)$, $(1,3)$, $(1,4)$, $(2,3)$, $(2,4)$ 和 $(3,4)$，每条边的方向从下标较小的顶点指向下标较大的顶点。设重心坐标为 $\\lambda_{1} = 1 - x - y - z$, $\\lambda_{2} = x$, $\\lambda_{3} = y$ 和 $\\lambda_{4} = z$，其对应的常数梯度为 $\\nabla \\lambda_{1}$, $\\nabla \\lambda_{2}$, $\\nabla \\lambda_{3}$ 和 $\\nabla \\lambda_{4}$。\n\n四面体上的一阶第一类 Nédélec 基于边的 $H(\\mathrm{curl})$-协调基，其特征是与边相关联的矢量形函数，每个形函数在其关联的有向边上的切向线积分为1，而在所有其他边上的切向线积分为0。仅使用这些定义属性和重心坐标提供的结构，执行以下操作：\n\n1. 为参考四面体的六条有向边构造显式的局部基于边的矢量形函数。您的构造必须基于重心坐标及其梯度的第一性原理推导得出，并且必须满足第一类 Nédélec 函数的切向积分定义属性。\n\n2. 对每个构造的形函数，计算其在每条有向边上的切向迹，并证明其切向分量的线积分在所有六条边上满足克罗内克（Kronecker）$\\delta$ 性质。\n\n3. 设线性矢量场为\n$$\n\\mathbf{E}(x,y,z) = \\begin{pmatrix}\nx + 2y + 3z + 1 \\\\\n2x + 3y + z + 2 \\\\\n3x + y + 2z + 3\n\\end{pmatrix}.\n$$\n通过计算六个边的自由度（DoF），即在边 $(i,j) \\in \\{(1,2),(1,3),(1,4),(2,3),(2,4),(3,4)\\}$ 上的有向切向线积分 $\\int_{e_{ij}} \\mathbf{E} \\cdot \\hat{\\mathbf{t}}_{ij} \\, \\mathrm{d}s$，来计算其在参考四面体上的第一类 Nédélec 插值。其中 $\\hat{\\mathbf{t}}_{ij}$ 表示从顶点 $v_{i}$ 到 $v_{j}$ 的单位切向量。然后将插值表示为您构造的六个边形函数与这些系数的线性组合。\n\n将六个插值系数 $(c_{12}, c_{13}, c_{14}, c_{23}, c_{24}, c_{34})$ 的有序行矩阵作为您的最终答案报告，要求使用精确值，不要四舍五入。此问题不涉及物理单位。",
            "solution": "用户提供了一个来自计算电磁学领域的有效且适定的问题。该问题要求在参考四面体上构造和验证第一类 Nédélec 基函数，并随后对给定的矢量场进行插值。将按要求分三部分进行求解。\n\n参考四面体的顶点为 $v_{1} = (0,0,0)$, $v_{2} = (1,0,0)$, $v_{3} = (0,1,0)$ 和 $v_{4} = (0,0,1)$。重心坐标为 $\\lambda_{1} = 1 - x - y - z$, $\\lambda_{2} = x$, $\\lambda_{3} = y$ 和 $\\lambda_{4} = z$。四面体内的位置矢量为 $\\mathbf{r} = (x,y,z)$。\n\n### 第1部分：基于边的矢量形函数的构造\n\n连接顶点 $v_i$ 和 $v_j$ 的边 $e_{ij}$ 的一阶第一类 Nédélec 矢量基函数是使用重心坐标 $\\lambda_i, \\lambda_j$ 及其梯度构造的。其一般形式为：\n$$\n\\mathbf{N}_{ij}(\\mathbf{r}) = \\lambda_i(\\mathbf{r}) \\nabla \\lambda_j(\\mathbf{r}) - \\lambda_j(\\mathbf{r}) \\nabla \\lambda_i(\\mathbf{r})\n$$\n这种形式确保了 $\\mathbf{N}_{ij}$ 的切向分量在单元面之间是连续的，并且 $\\mathrm{curl}(\\mathbf{N}_{ij})$ 是一个常数矢量，这些是 $H(\\mathrm{curl})$ 协调单元的关键属性。\n\n首先，我们计算重心坐标的梯度：\n$$\n\\nabla\\lambda_{1} = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix}, \\quad \\nabla\\lambda_{2} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad \\nabla\\lambda_{3} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad \\nabla\\lambda_{4} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n现在，我们为满足 $i  j$ 的六条边构造基函数：\n$$ \\mathbf{N}_{12} = \\lambda_1\\nabla\\lambda_2 - \\lambda_2\\nabla\\lambda_1 = (1-x-y-z)\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix} - x\\begin{pmatrix}-1\\\\-1\\\\-1\\end{pmatrix} = \\begin{pmatrix}1-y-z \\\\ x \\\\ x \\end{pmatrix} $$\n$$ \\mathbf{N}_{13} = \\lambda_1\\nabla\\lambda_3 - \\lambda_3\\nabla\\lambda_1 = (1-x-y-z)\\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix} - y\\begin{pmatrix}-1\\\\-1\\\\-1\\end{pmatrix} = \\begin{pmatrix}y \\\\ 1-x-z \\\\ y \\end{pmatrix} $$\n$$ \\mathbf{N}_{14} = \\lambda_1\\nabla\\lambda_4 - \\lambda_4\\nabla\\lambda_1 = (1-x-y-z)\\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix} - z\\begin{pmatrix}-1\\\\-1\\\\-1\\end{pmatrix} = \\begin{pmatrix}z \\\\ z \\\\ 1-x-y \\end{pmatrix} $$\n$$ \\mathbf{N}_{23} = \\lambda_2\\nabla\\lambda_3 - \\lambda_3\\nabla\\lambda_2 = x\\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix} - y\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix} = \\begin{pmatrix}-y \\\\ x \\\\ 0 \\end{pmatrix} $$\n$$ \\mathbf{N}_{24} = \\lambda_2\\nabla\\lambda_4 - \\lambda_4\\nabla\\lambda_2 = x\\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix} - z\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix} = \\begin{pmatrix}-z \\\\ 0 \\\\ x \\end{pmatrix} $$\n$$ \\mathbf{N}_{34} = \\lambda_3\\nabla\\lambda_4 - \\lambda_4\\nabla\\lambda_3 = y\\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix} - z\\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ -z \\\\ y \\end{pmatrix} $$\n\n### 第2部分：验证克罗内克-$\\delta$性质\n\n我们需要证明 $\\int_{e_{kl}} \\mathbf{N}_{ij} \\cdot d\\mathbf{l} = \\delta_{ik}\\delta_{jl}$（其中边的方向已预定义）。以 $\\mathbf{N}_{12}$ 为例：\n- 边 $e_{12}$：参数化为 $\\mathbf{r}(t) = (t,0,0)$ for $t \\in [0,1]$。$d\\mathbf{l} = (1,0,0)dt$。在 $e_{12}$ 上，$x=t, y=0, z=0$。\n  $$ \\int_{e_{12}} \\mathbf{N}_{12} \\cdot d\\mathbf{l} = \\int_0^1 \\begin{pmatrix}1-0-0 \\\\ t \\\\ t \\end{pmatrix} \\cdot \\begin{pmatrix}1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\, dt = \\int_0^1 1 \\, dt = 1 $$\n- 边 $e_{13}$：参数化为 $\\mathbf{r}(t) = (0,t,0)$ for $t \\in [0,1]$。$d\\mathbf{l} = (0,1,0)dt$。在 $e_{13}$ 上，$x=0, y=t, z=0$。\n  $$ \\int_{e_{13}} \\mathbf{N}_{12} \\cdot d\\mathbf{l} = \\int_0^1 \\begin{pmatrix}1-t-0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\cdot \\begin{pmatrix}0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\, dt = \\int_0^1 0 \\, dt = 0 $$\n通过类似的方法，可以验证所有六个基函数在所有六条边上的线积分都满足克罗内克-$\\delta$性质。\n\n### 第3部分：矢量场的Nédélec插值\n\n给定矢量场 $\\mathbf{E}(x,y,z) = (x+2y+3z+1, 2x+3y+z+2, 3x+y+2z+3)^T$。\n插值系数（自由度）$c_{ij}$ 是 $\\mathbf{E}$ 沿有向边 $e_{ij}$ 的切向线积分。我们将对每条边进行计算：\n$$ c_{ij} = \\int_{e_{ij}} \\mathbf{E} \\cdot d\\mathbf{l} = \\int_0^1 \\mathbf{E}(\\mathbf{r}(t)) \\cdot \\frac{d\\mathbf{r}}{dt} dt $$\n- $c_{12}$ (边 $v_1 \\to v_2$): $\\mathbf{r}(t)=(t,0,0)$, $\\frac{d\\mathbf{r}}{dt}=(1,0,0)$. $\\mathbf{E}|_{e_{12}} = (t+1, 2t+2, 3t+3)^T$.\n  $$c_{12} = \\int_0^1 (t+1) dt = \\left[\\frac{t^2}{2}+t\\right]_0^1 = \\frac{1}{2}+1 = \\frac{3}{2}$$\n- $c_{13}$ (边 $v_1 \\to v_3$): $\\mathbf{r}(t)=(0,t,0)$, $\\frac{d\\mathbf{r}}{dt}=(0,1,0)$. $\\mathbf{E}|_{e_{13}} = (2t+1, 3t+2, t+3)^T$.\n  $$c_{13} = \\int_0^1 (3t+2) dt = \\left[\\frac{3t^2}{2}+2t\\right]_0^1 = \\frac{3}{2}+2 = \\frac{7}{2}$$\n- $c_{14}$ (边 $v_1 \\to v_4$): $\\mathbf{r}(t)=(0,0,t)$, $\\frac{d\\mathbf{r}}{dt}=(0,0,1)$. $\\mathbf{E}|_{e_{14}} = (3t+1, t+2, 2t+3)^T$.\n  $$c_{14} = \\int_0^1 (2t+3) dt = \\left[t^2+3t\\right]_0^1 = 1+3 = 4$$\n- $c_{23}$ (边 $v_2 \\to v_3$): $\\mathbf{r}(t)=(1-t,t,0)$, $\\frac{d\\mathbf{r}}{dt}=(-1,1,0)$. $\\mathbf{E}|_{e_{23}} = (t+2, t+4, -2t+6)^T$.\n  $$c_{23} = \\int_0^1 \\big(-(t+2)+(t+4)\\big) dt = \\int_0^1 2 dt = 2$$\n- $c_{24}$ (边 $v_2 \\to v_4$): $\\mathbf{r}(t)=(1-t,0,t)$, $\\frac{d\\mathbf{r}}{dt}=(-1,0,1)$. $\\mathbf{E}|_{e_{24}} = (2t+2, -t+4, -t+6)^T$.\n  $$c_{24} = \\int_0^1 \\big(-(2t+2)+(-t+6)\\big) dt = \\int_0^1 (-3t+4) dt = \\left[-\\frac{3t^2}{2}+4t\\right]_0^1 = -\\frac{3}{2}+4 = \\frac{5}{2}$$\n- $c_{34}$ (边 $v_3 \\to v_4$): $\\mathbf{r}(t)=(0,1-t,t)$, $\\frac{d\\mathbf{r}}{dt}=(0,-1,1)$. $\\mathbf{E}|_{e_{34}} = (t+3, -2t+5, t+4)^T$.\n  $$c_{34} = \\int_0^1 \\big(-(-2t+5)+(t+4)\\big) dt = \\int_0^1 (3t-1) dt = \\left[\\frac{3t^2}{2}-t\\right]_0^1 = \\frac{3}{2}-1 = \\frac{1}{2}$$\n\n插值系数的有序行矩阵为 $(c_{12}, c_{13}, c_{14}, c_{23}, c_{24}, c_{34})$。\n$$\n\\begin{pmatrix}\n\\frac{3}{2}  \\frac{7}{2}  4  2  \\frac{5}{2}  \\frac{1}{2}\n\\end{pmatrix}\n$$\nNédélec 插值 $\\mathbf{E}_h$ 因此为：\n$$\n\\mathbf{E}_h = \\frac{3}{2}\\mathbf{N}_{12} + \\frac{7}{2}\\mathbf{N}_{13} + 4\\mathbf{N}_{14} + 2\\mathbf{N}_{23} + \\frac{5}{2}\\mathbf{N}_{24} + \\frac{1}{2}\\mathbf{N}_{34}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{2}  \\frac{7}{2}  4  2  \\frac{5}{2}  \\frac{1}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在定义了基函数之后，下一步是将连续的弱形式方程转化为离散的矩阵系统（例如质量矩阵和刚度矩阵），这一步依赖于数值积分。本练习将探讨一个核心的实现细节：为确保精确计算Nédélec单元的质量矩阵，我们需要使用多高阶的求积法则？通过分析被积函数的多项式阶数，你将学会如何为有限元程序选择高效且准确的积分方案，这是保证计算结果可靠性的关键一步。",
            "id": "3308311",
            "problem": "在用于计算电磁学的有限元法 (FEM) 中，考虑三角形单元 $K \\subset \\mathbb{R}^2$ 上的第一类一阶 Nedelec 边元空间。局部基矢量场 $\\mathbf{N}_i$ 是 $K$ 上重心坐标的仿射函数。对于一个在 $K$ 上是分片多项式的标量介电常数场 $\\epsilon(\\mathbf{x})$，单元质量矩阵项定义为\n$$\nM_{ij} \\;=\\; \\int_{K} \\epsilon(\\mathbf{x}) \\, \\mathbf{N}_i(\\mathbf{x}) \\cdot \\mathbf{N}_j(\\mathbf{x}) \\, \\mathrm{d}A.\n$$\n如果一个 $K$ 上的求积法则能够精确积分 $K$ 上所有总次数至多为 $p$ 的标量多项式，则称该求积法则具有多项式精度阶 $p$。\n\n关于在 $K$ 上精确计算 $M_{ij}$ 所需的最小求积精度阶，以下哪个或哪些陈述是正确的？假设在指明的情况下，$\\epsilon$ 是 $K$ 上的一个指定次数的多项式。\n\nA. 如果 $\\epsilon$ 在 $K$ 上是常数，使用精度阶为 2 的求积法则就足够了。\n\nB. 如果 $\\epsilon$ 在 $K$ 上是常数，任何精度阶为 1 的求积法则都已经可以精确积分 $M_{ij}$。\n\nC. 如果 $\\epsilon$ 在 $K$ 上是仿射的（即，总次数为 1 的多项式），精度阶为 2 的求积法则足以精确积分 $M_{ij}$。\n\nD. 如果 $\\epsilon$ 是 $K$ 上总次数为 $r$ 的多项式，精确积分 $M_{ij}$ 所需的最小精度阶为 $r+2$。",
            "solution": "首先验证问题陈述，以确保其科学上合理、适定且客观。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- **区域**：一个三角形单元 $K \\subset \\mathbb{R}^2$。\n- **有限元空间**：$K$ 上的第一类一阶 Nedelec 边元空间。\n- **基函数**：局部基矢量场，记为 $\\mathbf{N}_i(\\mathbf{x})$，是 $K$ 上重心坐标的仿射函数。\n- **材料属性**：标量介电常数场 $\\epsilon(\\mathbf{x})$ 是 $K$ 上的分片多项式。\n- **积分**：单元质量矩阵项为 $M_{ij} = \\int_{K} \\epsilon(\\mathbf{x}) \\, \\mathbf{N}_i(\\mathbf{x}) \\cdot \\mathbf{N}_j(\\mathbf{x}) \\, \\mathrm{d}A$。\n- **求积法则**：如果一个 $K$ 上的求积法则能够精确积分 $K$ 上所有总次数至多为 $p$ 的标量多项式，则称该求积法则具有多项式精度阶 $p$。\n- **问题**：对于不同多项式次数的 $\\epsilon(\\mathbf{x})$，确定关于精确计算 $M_{ij}$ 所需的最小求积精度阶的陈述的正确性。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础**：该问题牢固地建立在应用于计算电磁学的有限元法 (FEM) 的标准理论之内。第一类 Nedelec 单元、质量矩阵和求积法则是该领域中基本且定义明确的概念。该问题在科学和数学上是合理的。\n- **适定性**：该问题是适定的。它要求计算特定积分所需的最小求积阶。这需要确定被积函数的多项式次数，这是一个基于所提供信息的明确定义的数学任务。该次数存在唯一答案。\n- **客观性**：该问题以精确、客观且无歧义的技术语言陈述。没有主观或基于价值的元素。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。这是有限元法数值积分分析中的一个标准问题。可以继续求解过程。\n\n**解题推导**\n\n目标是使用数值求积法则精确计算积分 $M_{ij} = \\int_{K} \\epsilon(\\mathbf{x}) \\, \\mathbf{N}_i(\\mathbf{x}) \\cdot \\mathbf{N}_j(\\mathbf{x}) \\, \\mathrm{d}A$。足以完成此任务的求积法则的最小阶数由被积函数的总多项式次数决定，我们将其记为 $I(\\mathbf{x}) = \\epsilon(\\mathbf{x}) \\, \\mathbf{N}_i(\\mathbf{x}) \\cdot \\mathbf{N}_j(\\mathbf{x})$。\n\n多项式乘积的次数是它们次数的总和。因此，我们有：\n$$\n\\text{deg}(I) = \\text{deg}(\\epsilon) + \\text{deg}(\\mathbf{N}_i \\cdot \\mathbf{N}_j)\n$$\n\n我们必须确定每一项的多项式次数。\n\n1.  **Nedelec 基函数 $\\mathbf{N}_i$ 的次数**：\n    问题陈述，第一类一阶 Nedelec 基函数 $\\mathbf{N}_i$ 是“$K$ 上重心坐标的仿射函数”。设重心坐标为 $\\lambda_1, \\lambda_2, \\lambda_3$。这些是笛卡尔坐标 $\\mathbf{x} = (x, y)$ 的线性函数。一个在重心坐标中是仿射的函数，在笛卡尔坐标中是一个线性多项式。因此，矢量场 $\\mathbf{N}_i(\\mathbf{x})$ 的每个分量都是 $x$ 和 $y$ 的总次数至多为 1 的多项式。我们可以将其写作 $\\mathbf{N}_i(\\mathbf{x}) \\in [\\mathcal{P}_1(K)]^2$，其中 $\\mathcal{P}_1(K)$ 是三角形 $K$ 上总次数至多为 1 的多项式空间。\n\n2.  **点积 $\\mathbf{N}_i(\\mathbf{x}) \\cdot \\mathbf{N}_j(\\mathbf{x})$ 的次数**：\n    设基函数的分量为 $\\mathbf{N}_i = (P_{i1}, P_{i2})$ 和 $\\mathbf{N}_j = (P_{j1}, P_{j2})$，其中每个 $P_{ik}$ 和 $P_{jk}$ 都是次数至多为 1 的多项式。\n    点积为：\n    $$\n    \\mathbf{N}_i(\\mathbf{x}) \\cdot \\mathbf{N}_j(\\mathbf{x}) = P_{i1}(\\mathbf{x}) P_{j1}(\\mathbf{x}) + P_{i2}(\\mathbf{x}) P_{j2}(\\mathbf{x})\n    $$\n    两个次数至多为 1 的多项式的乘积是次数至多为 2 的多项式。因此，两个此类乘积的和也是次数至多为 2 的多项式。\n    对于 Nedelec 单元，基函数不是平凡的，通常情况下，该点积的结果是一个次数恰好为 2 的多项式。例如，对于一个参考三角形，一个基函数可以具有 $\\mathbf{N}_1(x, y) = (1-y, x)$ 的形式。其自身点积 $\\mathbf{N}_1 \\cdot \\mathbf{N}_1 = (1-y)^2 + x^2 = x^2 + y^2 - 2y + 1$ 是一个次数为 2 的多项式。\n    因此，我们得出结论 $\\text{deg}(\\mathbf{N}_i \\cdot \\mathbf{N}_j) = 2$。\n\n3.  **被积函数 $I(\\mathbf{x})$ 的次数**：\n    设 $K$ 上多项式介电常数 $\\epsilon(\\mathbf{x})$ 的次数为 $r$，即 $\\text{deg}(\\epsilon) = r$。\n    被积函数的总次数为：\n    $$\n    \\text{deg}(I) = \\text{deg}(\\epsilon) + \\text{deg}(\\mathbf{N}_i \\cdot \\mathbf{N}_j) = r + 2\n    $$\n\n4.  **最小求积精度阶**：\n    精度阶为 $p$ 的求积法则可以精确积分任何次数不超过 $p$ 的多项式。为确保 $M_{ij}$ 的精确积分，求积法则的精度阶必须至少与被积函数 $I(\\mathbf{x})$ 的次数一样高。因此，最小的此类阶数为 $p_{\\text{min}} = \\text{deg}(I)$。\n    $$\n    p_{\\text{min}} = r + 2\n    $$\n\n有了这个一般性结果，我们可以评估每个陈述。\n\n**逐项分析**\n\n**A. 如果 $\\epsilon$ 在 $K$ 上是常数，使用精度阶为 2 的求积法则就足够了。**\n\n如果 $\\epsilon$ 是常数，它是一个次数 $r=0$ 的多项式。\n使用我们的公式，所需的最小精度阶为 $p_{\\text{min}} = 0 + 2 = 2$。\n精度阶为 2 的求积法则可以精确积分所有次数不超过 2 的多项式。由于被积函数的次数为 2，这样的法则确实是足够的。\n结论：**正确**。\n\n**B. 如果 $\\epsilon$ 在 $K$ 上是常数，任何精度阶为 1 的求积法则都已经可以精确积分 $M_{ij}$。**\n\n如果 $\\epsilon$ 是常数（$r=0$），被积函数是一个次数为 2 的多项式。精度阶为 1 的求积法则仅保证对次数至多为 1 的多项式进行精确积分。通常情况下，它不能精确积分二次多项式。\n结论：**不正确**。\n\n**C. 如果 $\\epsilon$ 在 $K$ 上是仿射的（即，总次数为 1 的多项式），精度阶为 2 的求积法则足以精确积分 $M_{ij}$。**\n\n如果 $\\epsilon$ 是仿射的，它是一个次数 $r=1$ 的多项式。\n所需的最小精度阶为 $p_{\\text{min}} = 1 + 2 = 3$。\n该陈述声称精度阶为 2 的求积法则就足够了。这是错误的，因为 2 阶的法则不能保证精确积分次数为 3 的多项式。需要至少 3 阶的精度。\n结论：**不正确**。\n\n**D. 如果 $\\epsilon$ 是 $K$ 上总次数为 $r$ 的多项式，精确积分 $M_{ij}$ 所需的最小精度阶为 $r+2$。**\n\n这个陈述与我们推导的一般公式 $p_{\\text{min}} = r + 2$ 相符。所需的最小精度阶恰好是被积多项式的次数，我们发现该次数为 $r+2$。\n结论：**正确**。",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "为什么在电磁场模拟中必须使用像Nédélec单元这样的“边元”，而不是更直观的“节点元”？本练习通过构建一个巧妙的一维简化模型来揭示这个问题的答案。你将亲眼看到，不恰当的有限元空间选择会导致灾难性的“伪模式”——即数值上存在但物理上无意义的解，从而污染整个计算结果。通过这个练习，你将深刻理解保证计算电磁学模拟可靠性的一个核心理论支柱。",
            "id": "3350389",
            "problem": "考虑一个理想电导体 (PEC) 腔中的时谐、无源麦克斯韦特征问题，其变分形式写作：求电场 $\\mathbf{E} \\in H(\\mathrm{curl},\\Omega)$ 和波数 $\\kappa^{2} \\in \\mathbb{R}$，使得\n$$\n\\int_{\\Omega} \\mu^{-1} \\, (\\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{v}) \\, \\mathrm{d}\\mathbf{x} \\;=\\; \\kappa^{2} \\int_{\\Omega} \\epsilon \\, \\mathbf{E}\\cdot \\mathbf{v} \\, \\mathrm{d}\\mathbf{x}\n\\quad \\text{for all } \\mathbf{v} \\in H(\\mathrm{curl},\\Omega),\n$$\n在 $\\partial \\Omega$ 上满足 PEC 边界条件 $\\mathbf{n}\\times \\mathbf{E} = \\mathbf{0}$。一个基本事实是，旋度算子的核包含所有梯度场 $\\nabla \\phi$，其中 $\\phi \\in H^{1}_{0}(\\Omega)$，因为 $\\nabla \\times \\nabla \\phi = \\mathbf{0}$。当使用不合适的有限元空间时，这个零空间是产生伪模的根本原因。\n\n为了在最简单的设定下揭示这一机制，我们在区间 $(0,L)$ 上构建一个一维 (1D) 玩具模型，该模型模仿了横电 (TE) 和横磁 (TM) 模式族之间的分离。我们用一个标量场 $u \\in H^{1}_{0}(0,L)$ 和以下特征问题来模拟 TE 模式：\n$$\n\\int_{0}^{L} u'(x) \\, v'(x) \\, \\mathrm{d}x \\;=\\; \\lambda \\int_{0}^{L} u(x) \\, v(x) \\, \\mathrm{d}x \\quad \\text{for all } v \\in H^{1}_{0}(0,L),\n$$\n并用一个代理标量场 $w \\in H^{1}(0,L)$ 来模拟 TM 梯度子空间，该场旨在表示 $H(\\mathrm{curl},\\Omega)$ 中某个场的不合规的节点近似，与之相关的双线性形式为\n$$\na(w,v) \\;=\\; \\int_{0}^{L} \\big(\\mathrm{curl}\\, w\\big)\\,\\big(\\mathrm{curl}\\, v\\big)\\,\\mathrm{d}x,\n$$\n其中在一维情况下，我们设定 $\\mathrm{curl}\\, w \\equiv 0$，以模仿在更高维度中标量势 $\\phi$ 的 $\\nabla \\times \\nabla \\phi$ 精确为零的情况。设 $V_{h}$ 是在 $(0,L)$ 的一个均匀剖分成 $n$ 个子区间的划分上，由连续分段线性 (线性拉格朗日) 函数构成的空间，且不施加本质边界条件，因此 $\\dim V_{h} = n+1$。\n\n你将需要：\n- 基于上述变分形式和麦克斯韦方程组，推导为何离散的 TM 代理双线性形式在 $V_{h}$ 上恒为零，从而将广义特征问题转化为一个纯质量矩阵束问题。\n-证明增加一个零均值规范约束 $\\int_{0}^{L} w_{h}(x)\\,\\mathrm{d}x = 0$ 会从 $V_{h}$ 中精确地移除一个维度，但并不会改变所有剩余的离散特征对都满足 $\\lambda = 0$ 这一事实，从而明确地刻画伪特征空间。\n- 在概念层面上解释，在更高维度中，为何使用边元（例如，第一类 Nédélec 元）能满足一个离散紧性性质，从而防止梯度场污染正谱，而节点元则不能。\n- 提出至少两种简单且科学上合理的测试方案，供从业者在采用有限元法 (FEM) 的计算电磁学中检测和量化伪模。你的提议应与上述推导一致，并能分离出伪模产生或抑制的机制。\n\n最后，取 $n = 5$，计算在施加单个零均值规范约束后，由离散化不当的 TM 代理在 $V_{h}$ 上产生的零特征值伪模的确切数量。请将你的最终答案以单个整数形式给出。无需四舍五入，也无需物理单位。",
            "solution": "该问题陈述是计算电磁学领域一个有效的练习，具体涉及有限元特征值分析中伪模的数值病态问题。它在科学上是合理的、良定的、客观的且内部一致。它使用了一个标准的教学性一维 (1D) 模型来说明一个在更高维度中出现的复杂现象。所有术语都得到了充分定义，足以成功完成任务。因此，我们可以着手给出完整解答。\n\n根据要求，分析分为四个部分，最后进行数值计算。\n\n### 第一部分：双线性形式的消失及随之而来的特征问题\n\n问题使用一个标量场 $w$ 和一个双线性形式 $a(w,v)$ 为横磁 (TM) 模式定义了一个代理模型。该模型的有限元空间是 $V_h$，即在区间 $(0,L)$ 的一个含 $n$ 个子区间的剖分上的连续分段线性拉格朗日函数空间，且不施加本质边界条件。该空间的维度，即节点数，为 $\\dim V_{h} = n+1$。\n\n这个一维玩具模型的关键定义是 `curl` 算子作用于标量场 $w$ 的方式，其定义为：\n$$\n\\mathrm{curl}\\, w \\equiv 0\n$$\n这个定义是向量微积分恒等式 $\\nabla \\times (\\nabla \\phi) = \\mathbf{0}$ 的直接类比，其中一维模型中的标量场 $w$ 扮演了三维中标量势 $\\phi$ 的角色。$V_h$ 中的节点基函数旨在模仿为 $H(\\mathrm{curl},\\Omega)$ 中的向量场选择了无效的节点元，这种选择会无意中包含此梯度子空间。\n\nTM 代理的双线性形式为：\n$$\na(w,v) = \\int_{0}^{L} \\big(\\mathrm{curl}\\, w\\big)\\,\\big(\\mathrm{curl}\\, v\\big)\\,\\mathrm{d}x\n$$\n对于任意两个函数 $w_h, v_h \\in V_h$，根据给定的定义，我们有 $\\mathrm{curl}\\, w_h = 0$ 和 $\\mathrm{curl}\\, v_h = 0$。因此，被积函数恒为零：\n$$\n\\big(\\mathrm{curl}\\, w_h(x)\\big)\\,\\big(\\mathrm{curl}\\, v_h(x)\\big) = 0 \\cdot 0 = 0 \\quad \\text{for all } x \\in (0,L)\n$$\n因此，对于所选离散空间中的所有函数，该双线性形式均为零：\n$$\na(w_h, v_h) = \\int_{0}^{L} 0 \\,\\mathrm{d}x = 0 \\quad \\text{for all } w_h, v_h \\in V_h\n$$\n相应的广义特征问题是求 $(\\lambda, w_h) \\in (\\mathbb{R}, V_h)$，使得对所有 $v_h \\in V_h$：\n$$\na(w_h, v_h) = \\lambda \\int_{0}^{L} w_h(x) v_h(x) \\,\\mathrm{d}x\n$$\n代入 $a(w_h, v_h)=0$ 的结果，方程变为：\n$$\n0 = \\lambda \\int_{0}^{L} w_h(x) v_h(x) \\,\\mathrm{d}x\n$$\n在有限元背景下，这被写成矩阵特征问题 $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$。刚度矩阵 $\\mathbf{K}$ 的元素为 $K_{ij} = a(\\phi_i, \\phi_j)$，其中 $\\{\\phi_i\\}$ 是 $V_h$ 的基。根据我们的推导，$\\mathbf{K}$ 是零矩阵。质量矩阵 $\\mathbf{M}$ 的元素为 $M_{ij} = \\int_{0}^{L} \\phi_i \\phi_j \\,\\mathrm{d}x$。由于基函数 $\\{\\phi_i\\}$ 是线性无关的，质量矩阵 $\\mathbf{M}$ 是对称正定的。\n\n特征问题 $0 = \\lambda \\mathbf{M}\\mathbf{c}$ 意味着对于任何非零特征向量 $\\mathbf{c}$，我们必须有 $\\lambda = 0$。因为这对 $(n+1)$ 维空间中的任何向量都成立，所以整个空间 $V_h$ 都是对应于特征值 $\\lambda=0$ 的特征空间。这意味着离散化产生了 $\\dim(V_h) = n+1$ 个伪模，它们的特征值都为零。\n\n### 第二部分：零均值规范约束的影响\n\n引入了一个规范约束：\n$$\n\\int_{0}^{L} w_{h}(x)\\,\\mathrm{d}x = 0\n$$\n我们定义一个新空间 $V_h^0 = \\{w_h \\in V_h \\mid \\int_{0}^{L} w_{h}(x)\\,\\mathrm{d}x = 0\\}$。$V_h$ 中的任何函数 $w_h$ 都可以表示为基函数 $\\phi_i$（其中 $i=0, 1, \\dots, n$）的线性组合：$w_h(x) = \\sum_{i=0}^{n} c_i \\phi_i(x)$。该约束变为对系数 $c_i$ 的一个线性方程：\n$$\n\\sum_{i=0}^{n} c_i \\left( \\int_{0}^{L} \\phi_i(x)\\,\\mathrm{d}x \\right) = 0\n$$\n由于标准的拉格朗日“帽状”基函数是非负且不恒为零的，它们的积分是正的。这是一个作用于 $(n+1)$ 维系数空间的非平凡线性约束。单个线性约束会使向量空间的维数精确地减少一。因此，约束空间的维数为：\n$$\n\\dim(V_h^0) = \\dim(V_h) - 1 = (n+1) - 1 = n\n$$\n现在特征问题是在这个较小的空间上提出的：求 $(\\lambda, w_h) \\in (\\mathbb{R}, V_h^0)$，使得对所有 $v_h \\in V_h^0$ 都有 $a(w_h, v_h) = \\lambda \\int_0^L w_h v_h \\,dx$。\n$a(w_h, v_h) = 0$ 这个基本性质不受函数上的积分约束影响。它对 $V_h^0 \\subset V_h$ 中的所有函数仍然成立。因此，约束空间上的特征问题仍然是\n$$\n0 = \\lambda \\int_{0}^{L} w_h(x) v_h(x) \\,\\mathrm{d}x\n$$\n对所有 $v_h \\in V_h^0$ 成立。对于任何非零特征函数 $w_h \\in V_h^0$，特征值 $\\lambda$ 必须为零。整个 $n$ 维空间 $V_h^0$ 是对应于 $\\lambda=0$ 的特征空间。该约束移除了一个伪模，但仍剩下 $n$ 个伪模。这明确地将伪特征空间刻画为零均值的、连续的分段线性函数空间，其维数为 $n$。\n\n### 第三部分：边元对伪模的抑制\n\n在更高维度（二维和三维）中，问题的根源在于某些有限元空间无法正确表示旋度算子的零空间。具有平方可积旋度的平方可积向量场的空间记为 $H(\\mathrm{curl},\\Omega)$。在连续设定下，旋度算子的零空间恰好是梯度场集合：$\\{\\mathbf{u} \\in L^2(\\Omega)^d \\mid \\nabla \\times \\mathbf{u} = \\mathbf{0}\\} = \\{\\nabla \\phi \\mid \\phi \\in H^1(\\Omega)\\}$。\n\n当使用**节点元**离散化向量场 $\\mathbf{E}$ 时，通常将向量值的自由度赋给网格的节点。得到的有限元空间，我们称之为 $\\mathbf{V}_h^{\\text{nodal}}$，包含一个很大的离散梯度子空间，即形如 $\\nabla \\phi_h$ 的场，其中 $\\phi_h$ 是一个标准的标量（例如，拉格朗日）有限元函数。然而，对于一个一般的 $\\mathbf{v}_h \\in \\mathbf{V}_h^{\\text{nodal}}$，性质 $\\nabla \\times (\\nabla \\phi_h) = \\mathbf{0}$ 在离散层面上不被保持，意味着离散梯度的离散旋度不一定为零。刚度矩阵 $\\mathbf{K}$ 的元素为 $K_{ij} = \\int_{\\Omega} (\\nabla \\times \\mathbf{v}_i) \\cdot (\\nabla \\times \\mathbf{v}_j) \\,d\\mathbf{x}$，它会获得一个大的、数值近似的零空间，这个零空间并不精确对应于真实的解析零空间。这种不匹配用非物理的伪模污染了计算出的谱。\n\n**边元**（例如，第一类 Nédélec 元）是专门设计来避免这个问题的。它们的自由度不是节点值，而是向量场沿网格单元边的切向分量。这种构造确保了场在单元交界面上的切向分量是连续的，这正是 $H(\\mathrm{curl},\\Omega)$ 中场需要满足的连续性要求。由此产生的有限元空间，我们称之为 $\\mathbf{V}_h^{\\text{edge}}$，拥有一个关键性质，通常用一个交换图来表示。这个性质是有限元外微分 (FEEC) 的基础，它确保了离散梯度的离散旋度精确为零。也就是说，如果取一个标量拉格朗日空间 $S_h$ 和 Nédélec 边元空间 $\\mathbf{V}_h^{\\text{edge}}$，那么：\n$$\n\\nabla \\times (\\nabla_h \\phi_h) = \\mathbf{0} \\quad \\text{for all } \\phi_h \\in S_h\n$$\n其中 $\\nabla_h$ 是从标量节点元到矢量边元的离散梯度算子。这意味着 $\\mathbf{V}_h^{\\text{edge}}$ 内的离散旋度零空间恰好是离散梯度空间 $\\{\\nabla_h\\phi_h \\mid \\phi_h \\in S_h\\}$。这个性质，通常被称为构造了一个稳定且协调的上链复形，确保了离散刚度算子的核能与算子谱的其余部分清晰地分离。与这些单元相关的“离散紧性性质”保证了对谱的非零部分的逼近是收敛的且没有伪模。对应于梯度场的零特征值模被正确地捕捉，并且不会污染具有物理意义的正特征值。\n\n### 第四部分：建议的测试方案\n\n这里有两种科学上合理的测试方案，用于检测和量化计算电磁学有限元代码中的伪模。\n\n**1. 典范腔谐振测试**\n- **原理**：此测试将数值结果与已知的解析解进行比较。具有理想电导体 (PEC) 壁的矩形（或长方体）腔是理想的选择，因为其谐振频率和模式结构（TE 和 TM）是精确已知的。\n- **实施**：\n    1.  对一个尺寸为 $a \\times b$ 的二维矩形腔或尺寸为 $a \\times b \\times c$ 的三维长方体腔进行建模。在所有壁上施加 PEC 边界条件 ($\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$)。\n    2.  使用 FEM 代码计算最低的，例如 20-50 个特征对 $(\\kappa_i^2, \\mathbf{E}_i)$。\n    3.  解析地，特征值由 $\\kappa^2_{mnp} = (\\frac{m\\pi}{a})^2 + (\\frac{n\\pi}{b})^2 + (\\frac{p\\pi}{c})^2$ 给出，其中 $m, n, p$ 是定义模式阶数的整数（对 TE/TM 族有适当的限制）。\n- **检测与量化**：伪模可以通过两种方式识别：\n    a.  **谱污染**：计算出的特征值列表中将包含与任何解析 $\\kappa^2_{mnp}$ 值都不匹配的值。这些就是伪模。\n    b.  **零空间维度**：一个行为良好的离散化（如使用边元）将产生一簇对应于梯度场的零特征值，与正的物理特征值清晰分离。而不恰当的离散化（如使用节点元）将产生数量大得多的零或近零特征值。可以计算这类模式的数量，并与离散梯度空间的理论维度进行比较，对于节点元，该维度约等于内部网格节点的数量。\n\n**2. 散度检查测试**\n- **原理**：此测试利用了特征模的一个物理性质。在无源区域 ($\\rho=0$)，麦克斯韦方程要求物理电场模式是无散的：$\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0$。由不正确处理梯度零空间而产生的伪模通常会显著违反此条件。\n- **实施**：\n    1.  对任何合理的腔体几何（测试1中的典范腔是合适的）求解特征问题。\n    2.  对于每个计算出的特征模 $\\mathbf{E}_i$，计算其散度的 $L^2$-范数：$D_i = ||\\nabla \\cdot \\mathbf{E}_i||_{L^2} = (\\int_{\\Omega} |\\nabla \\cdot \\mathbf{E}_i|^2 \\,d\\mathbf{x})^{1/2}$。请注意，散度应逐单元计算，因为 $H(\\mathrm{curl})$ 中的场不一定具有全局定义的、平方可积的散度。\n    3.  绘制计算出的特征值 $\\kappa_i^2$ 与其对应的散度范数 $D_i$ 的关系图。\n- **检测与量化**：得到的散点图通常会显示两个不同的群体：\n    a.  **物理模式**：这些点将表现为具有正特征值 $(\\kappa_i^2  0)$ 和非常小的散度范数 $(D_i \\approx 0)$。\n    b.  **伪模**：这些点将表现为具有大散度范数 $(D_i \\gg 0)$。它们对应的特征值可能是零或非零，从而污染整个谱。\n    从业者可以设置一个散度阈值来以编程方式识别和计数伪模，从而量化求解器和离散化选择的质量。\n\n### 最终计算\n\n问题要求计算在 $n=5$ 个子区间的网格上，对离散化不当的 TM 代理在空间 $V_h$ 上施加单个零均值规范约束后，产生的伪零特征值模的数量。\n\n正如在第二部分中所确立的：\n1.  在包含 $n$ 个单元的网格上，无边界条件的连续分段线性函数构成的初始空间 $V_h$ 的维数为 $n+1$。\n2.  双线性形式 $a(w_h, v_h)$ 在此空间中对所有函数恒为零，这意味着每个非零函数都是一个特征值为 $\\lambda=0$ 的特征向量。伪模的初始数量为 $n+1$。\n3.  单个规范约束 $\\int_0^L w_h(x) dx = 0$ 是一个非平凡的线性约束，它将空间的维数减少 1。\n4.  剩余伪模的数量是约束空间的维数，即 $(n+1) - 1 = n$。\n\n给定参数 $n = 5$：\n伪零特征值模的数量是 $n=5$。",
            "answer": "$$\\boxed{5}$$"
        }
    ]
}