{
    "hands_on_practices": [
        {
            "introduction": "在理解了一阶ABC的角度依赖性之后，我们现在探讨另一个关键的误差来源：几何曲率。这项练习  挑战您量化将“平面”ABC应用于更真实的曲面（球面）截断边界时所引入的误差，这在三维模拟中很常见。通过将误差推导为边界半径 $R$ 和波数 $k$ 的函数，您将了解几何因素如何影响模拟的准确性。",
            "id": "3287140",
            "problem": "考虑一个均匀、各向同性、无源外部域中的时谐电磁散射问题，其角频率为 $\\omega$，波数为 $k = \\omega \\sqrt{\\mu \\epsilon}$，其中 $\\mu$ 是磁导率，$\\epsilon$ 是介电常数。一个基于有限元法 (FEM) 的数值求解器使用一个以原点为中心、半径为 $R$ 的球形人工边界来截断该无界域。为了消除在该截断边界上的反射，一个对于局部平面出射波合理的一阶平面吸收边界条件 (ABC) 被施加在 $r = R$ 的球形边界上。\n\n假设在所有散射体外部，电场或磁场的任意笛卡尔分量的主要远场行为都由标量亥姆霍兹方程控制，并且可以很好地用一个球对称出射解来近似。令 $u(r)$ 表示这样一个代表场分量的标量场，它在外部域满足标量亥姆霍兹方程 $(\\nabla^{2} + k^{2}) u = 0$ 并且是渐近出射的。\n\n将在球形边界上施加一阶平面 ABC 所引起的 $r = R$ 处的无量纲边界算子失配定义为\n$$\n\\varepsilon(kR) \\equiv \\left|\\frac{\\left.\\frac{\\partial u}{\\partial r} - i k\\, u\\right|_{r=R}}{i k\\, u(R)}\\right|.\n$$\n从控制方程和出射球面波的远场形式出发，推导当 $kR \\to \\infty$ 时 $\\varepsilon(kR)$ 的领头阶表达式，并用 $1/(kR)$ 表示你的最终结果。最终答案必须是单一的闭式解析表达式。误差度量 $\\varepsilon(kR)$ 是无量纲的；不需要物理单位。",
            "solution": "该问题要求推导将一阶平面吸收边界条件 (ABC) 应用于球对称出射波时所产生的误差。\n\n一个在无源、均匀、各向同性介质中的球对称出射标量波 $u(r)$，满足亥姆霍兹方程 $(\\nabla^{2} + k^{2}) u = 0$。在球坐标系下，对于仅依赖于半径 $r$ 的函数，亥姆霍兹方程变为：\n$$\n\\frac{d^{2} u}{d r^{2}} + \\frac{2}{r} \\frac{d u}{d r} + k^{2} u = 0\n$$\n该常微分方程的出射解形式为：\n$$\nu(r) = C \\frac{e^{ikr}}{r}\n$$\n其中 $C$ 是一个常数。该解描述了一个从原点向外传播的球面波。\n\n我们需要计算该精确解在施加一阶平面ABC时的算子失配。首先，计算 $u(r)$ 的径向导数：\n$$\n\\frac{du}{dr} = C \\left( \\frac{ik e^{ikr}}{r} - \\frac{e^{ikr}}{r^2} \\right) = \\left(ik - \\frac{1}{r}\\right) C \\frac{e^{ikr}}{r} = \\left(ik - \\frac{1}{r}\\right) u(r)\n$$\n现在，将此表达式代入问题中定义的误差度量 $\\varepsilon(kR)$，并在边界 $r=R$ 处进行计算：\n$$\n\\varepsilon(kR) \\equiv \\left|\\frac{\\left.\\frac{\\partial u}{\\partial r} - i k u\\right|_{r=R}}{i k u(R)}\\right|\n$$\n$$\n\\varepsilon(kR) = \\left|\\frac{\\left(ik - \\frac{1}{R}\\right) u(R) - i k u(R)}{i k u(R)}\\right| = \\left|\\frac{-\\frac{1}{R} u(R)}{i k u(R)}\\right| = \\left|\\frac{-1}{ikR}\\right|\n$$\n由于 $|i|=1$，我们得到：\n$$\n\\varepsilon(kR) = \\frac{1}{kR}\n$$\n这个结果表明，将平面ABC应用于曲面边界所引入的误差与曲率半径 $R$ 和波数 $k$ 的乘积成反比。当边界离源很远（$R \\to \\infty$）或频率很低时，误差减小。",
            "answer": "$$\n\\boxed{\\frac{1}{kR}}\n$$"
        },
        {
            "introduction": "在分析了简单局部ABC的局限性后，我们现在转向一种更先进、更强大的解决方案：完美匹配层（PML）。此实践  提出了一个实际的工程设计问题，您必须确定PML所需的最小厚度，以将出射波衰减到指定的低水平。这项任务展示了PML的理论原理如何应用于在现代计算软件中创建高效的无反射边界。",
            "id": "3339676",
            "problem": "一个介电常数为 $\\epsilon_{0}$、磁导率为 $\\mu_{0}$ 的均匀自由空间区域，在其右侧被一个一维笛卡尔坐标完美匹配层 (PML) 截断。该 PML 是在一个有限元法 (FEM) 模型中通过复坐标伸展实现的。一个角频率为 $\\omega$、自由空间波数为 $k_{0} = \\omega \\sqrt{\\mu_{0}\\epsilon_{0}}$ 的时谐平面波，以振幅 $A_{0}$ 在 $x=0$ 处进入 PML，并垂直朝向位于 $x=L$ 处的外部理想电导体 (PEC) 边界传播。PML 伸展由 $s_{x}(x) = 1 + j \\,\\sigma(x)/(\\omega \\epsilon_{0})$ 定义，其中 $\\sigma(x)$ 是电导率分布。对于 $0 \\le x \\le L$，电导率根据归一化多项式分布 $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^{m}$ 进行分级，其中 $\\sigma_{\\max} = 1.0 \\times 10^{2}\\ \\mathrm{S/m}$ 且 $m = 3$。设计要求是在外部 PEC 边界处的波振幅被衰减到 $A_{0}\\,\\epsilon$ 以下，其中 $\\epsilon = 1.0 \\times 10^{-6}$。\n\n从麦克斯韦方程组和上述坐标伸展定义出发，推导衰减条件，并计算能保证 $x=L$ 处振幅 $A(L)$ 满足 $A(L) \\le A_{0}\\,\\epsilon$ 的最小 PML 厚度 $L$（以米为单位）。将 $L$ 的最终答案以米表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算一个完美匹配层 (PML) 所需的最小厚度 $L$，以将垂直入射的平面波衰减到指定的水平。\n\n首先，我们分析波在 PML 中的传播。一个沿 $+x$ 方向传播的时谐平面波，在复坐标伸展 $s_x(x)$ 定义的 PML 介质中，其有效波数变为 $k_{\\text{eff}}(x) = k_0 s_x(x)$。这里 $k_0$ 是自由空间波数。采用 WKB (Wentzel-Kramers-Brillouin) 近似，波场 $E(x)$ 可以表示为：\n$$\nE(x) = A_0 \\exp\\left(j \\int_0^x k_{\\text{eff}}(x') dx'\\right)\n$$\n这里的符号约定与 $\\exp(-j\\omega t)$ 的时间谐波形式一致，这确保了当 $s_x(x)$ 的虚部为正时，波场会衰减，这与物理上的损耗相符。\n\n代入给定的伸展因子 $s_{x}(x) = 1 + j \\frac{\\sigma(x)}{\\omega \\epsilon_{0}}$：\n$$\nk_{\\text{eff}}(x) = k_0 \\left(1 + j \\frac{\\sigma(x)}{\\omega\\epsilon_0}\\right)\n$$\n波场表达式的指数部分变为：\n$$\nj \\int_0^x k_0 \\left(1 + j \\frac{\\sigma(x')}{\\omega\\epsilon_0}\\right) dx' = j k_0 x - \\frac{k_0}{\\omega\\epsilon_0} \\int_0^x \\sigma(x') dx'\n$$\n因此，波的振幅 $A(x) = |E(x)|$ 由衰减项决定：\n$$\nA(x) = A_0 \\exp\\left(-\\frac{k_0}{\\omega\\epsilon_0} \\int_0^x \\sigma(x') dx'\\right)\n$$\n我们可以利用 $k_0 = \\omega\\sqrt{\\mu_0\\epsilon_0}$ 和自由空间阻抗 $Z_0 = \\sqrt{\\mu_0/\\epsilon_0}$ 来简化指数中的系数：\n$$\n\\frac{k_0}{\\omega\\epsilon_0} = \\frac{\\omega\\sqrt{\\mu_0\\epsilon_0}}{\\omega\\epsilon_0} = \\sqrt{\\frac{\\mu_0}{\\epsilon_0}} = Z_0\n$$\n设计要求是在 $x=L$ 处，振幅满足 $A(L) \\le A_0 \\epsilon$。代入振幅表达式，我们得到衰减条件：\n$$\nA_0 \\exp\\left(-Z_0 \\int_0^L \\sigma(x) dx\\right) \\le A_0 \\epsilon\n$$\n对两边取自然对数，得到：\n$$\nZ_0 \\int_0^L \\sigma(x) dx \\ge -\\ln(\\epsilon) = \\ln(1/\\epsilon)\n$$\n接下来，计算电导率剖面 $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m$ 的积分：\n$$\n\\int_0^L \\sigma(x) dx = \\int_0^L \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m dx = \\frac{\\sigma_{\\max}}{L^m} \\left[\\frac{x^{m+1}}{m+1}\\right]_0^L = \\frac{\\sigma_{\\max} L}{m+1}\n$$\n将积分结果代回衰减条件：\n$$\nZ_0 \\left(\\frac{\\sigma_{\\max} L}{m+1}\\right) \\ge \\ln(1/\\epsilon)\n$$\n从中解出最小厚度 $L_{\\text{min}}$：\n$$\nL_{\\text{min}} = \\frac{(m+1) \\ln(1/\\epsilon)}{Z_0 \\sigma_{\\max}}\n$$\n最后，代入给定的数值：\n- $m = 3$\n- $\\epsilon = 1.0 \\times 10^{-6} \\implies \\ln(1/\\epsilon) = \\ln(10^6) = 6\\ln(10)$\n- $\\sigma_{\\max} = 1.0 \\times 10^2 \\ \\mathrm{S/m}$\n- $Z_0 = \\sqrt{\\mu_0/\\epsilon_0} \\approx 376.73 \\ \\Omega$\n\n计算可得：\n$$\nL_{\\text{min}} = \\frac{(3+1) \\times 6\\ln(10)}{376.73 \\times 100} \\approx \\frac{24 \\times 2.302585}{37673} \\approx 0.00146688 \\ \\mathrm{m}\n$$\n将结果四舍五入到四位有效数字，得到 $L_{\\text{min}} = 1.467 \\times 10^{-3}$ m。",
            "answer": "$$\\boxed{1.467 \\times 10^{-3}}$$"
        }
    ]
}