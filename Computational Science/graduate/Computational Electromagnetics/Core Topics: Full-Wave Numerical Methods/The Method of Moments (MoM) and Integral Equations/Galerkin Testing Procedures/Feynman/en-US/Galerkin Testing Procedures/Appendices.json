{
    "hands_on_practices": [
        {
            "introduction": "The journey from a continuous partial differential equation to a solvable algebraic system is the essence of the Finite Element Method. This first exercise guides you through this fundamental process for Maxwell's equations, starting with the derivation of the weak form via the Galerkin testing procedure. By calculating a specific matrix entry for a Nédélec edge element, you will gain concrete experience with the mechanics of discretizing vector wave equations, a cornerstone of computational electromagnetics. ",
            "id": "3309726",
            "problem": "Consider the time-harmonic source-free Maxwell curl-curl equation in a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{3}$,\n$$\\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) - \\omega^{2} \\epsilon \\mathbf{E} = \\mathbf{0} \\quad \\text{in } \\Omega,$$\nwhere $\\mu$ is the magnetic permeability, $\\epsilon$ is the electric permittivity, and $\\omega$ is the angular frequency. Let the trial and test space be the Sobolev space of square-integrable vector fields with square-integrable curl, denoted $H(\\nabla \\times;\\Omega)$, and consider a Galerkin discretization using the Finite Element Method (FEM) with $H(\\nabla \\times)$-conforming first-kind Nédélec edge elements on tetrahedra.\n\n1. Derive, from first principles using the weak (variational) formulation obtained by testing with $\\boldsymbol{\\phi} \\in H(\\nabla \\times;\\Omega)$ and applying integration by parts appropriate to the curl operator, the exact expression for the Galerkin bilinear form entry corresponding to basis functions $\\boldsymbol{\\phi}_{m}$ and $\\boldsymbol{\\phi}_{n}$:\n$$a_{mn} = \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_{m}\\right)\\cdot\\left(\\nabla \\times \\boldsymbol{\\phi}_{n}\\right)\\, d\\Omega \\;-\\; \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}_{m}\\cdot \\boldsymbol{\\phi}_{n}\\, d\\Omega.$$\n\n2. Compute this entry explicitly on a single tetrahedral element $T \\subset \\Omega$ whose vertices are $\\mathbf{x}_{1}=(0,0,0)$, $\\mathbf{x}_{2}=(h,0,0)$, $\\mathbf{x}_{3}=(0,h,0)$, and $\\mathbf{x}_{4}=(0,0,h)$, assuming $\\mu$ and $\\epsilon$ are constant over $T$. Use the lowest-order first-kind Nédélec edge basis function associated with the oriented edge $(\\mathbf{x}_{1},\\mathbf{x}_{2})$, defined via barycentric coordinates $\\{\\lambda_{i}\\}_{i=1}^{4}$ on $T$ by\n$$\\boldsymbol{\\phi}_{12} = \\lambda_{1}\\nabla \\lambda_{2} - \\lambda_{2}\\nabla \\lambda_{1}.$$\nEvaluate the diagonal matrix entry $a_{12,12}$ for this single element $T$ in closed form.\n\nProvide your final answer as a single closed-form analytic expression in terms of $h$, $\\mu$, $\\epsilon$, and $\\omega$. No numerical evaluation is required. Do not include units in the final answer, but assume $\\mu$ and $\\epsilon$ are physically meaningful constants. If you perform any intermediate numerical simplifications, retain exact rational factors. No rounding is required.",
            "solution": "The problem asks for two tasks. First, to derive the Galerkin bilinear form for the time-harmonic Maxwell curl-curl equation. Second, to compute a specific diagonal entry of the resulting finite element matrix on a given tetrahedral element using a specific basis function.\n\n### Part 1: Derivation of the Bilinear Form\n\nThe governing partial differential equation (PDE) is the time-harmonic source-free Maxwell curl-curl equation in a domain $\\Omega$:\n$$ \\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) - \\omega^{2} \\epsilon \\mathbf{E} = \\mathbf{0} $$\nHere, $\\mathbf{E}$ is the electric field phasor, $\\mu$ is the magnetic permeability, $\\epsilon$ is the electric permittivity, and $\\omega$ is the angular frequency.\n\nTo obtain the weak (or variational) formulation, we follow the standard Galerkin procedure. We multiply the PDE by a vector test function $\\boldsymbol{\\phi}$ from the appropriate function space, which is given as $H(\\nabla \\times;\\Omega)$, and integrate over the domain $\\Omega$:\n$$ \\int_{\\Omega} \\boldsymbol{\\phi} \\cdot \\left[ \\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) - \\omega^{2} \\epsilon \\mathbf{E} \\right] d\\Omega = 0 $$\nThis can be split into two terms:\n$$ \\int_{\\Omega} \\boldsymbol{\\phi} \\cdot \\left( \\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) \\right) d\\Omega - \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi} \\cdot \\mathbf{E} \\, d\\Omega = 0 $$\nTo reduce the order of differentiation on the trial function $\\mathbf{E}$, we apply integration by parts to the first term. The relevant vector calculus identity is:\n$$ \\int_{\\Omega} \\mathbf{F} \\cdot (\\nabla \\times \\mathbf{G}) \\, d\\Omega = \\int_{\\Omega} (\\nabla \\times \\mathbf{F}) \\cdot \\mathbf{G} \\, d\\Omega - \\oint_{\\partial\\Omega} (\\mathbf{F} \\times \\mathbf{G}) \\cdot \\mathbf{\\hat{n}} \\, dS $$\nLet $\\mathbf{F} = \\boldsymbol{\\phi}$ and $\\mathbf{G} = \\mu^{-1} \\nabla \\times \\mathbf{E}$. Applying this identity, the first term becomes:\n$$ \\int_{\\Omega} \\left(\\nabla \\times \\boldsymbol{\\phi}\\right) \\cdot \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) d\\Omega - \\oint_{\\partial\\Omega} \\left(\\boldsymbol{\\phi} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E})\\right) \\cdot \\mathbf{\\hat{n}} \\, dS $$\nThe boundary integral term $\\oint_{\\partial\\Omega} \\left(\\boldsymbol{\\phi} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E})\\right) \\cdot \\mathbf{\\hat{n}} \\, dS$ vanishes under appropriate boundary conditions. For instance, for a Perfect Electric Conductor (PEC) boundary, $\\mathbf{\\hat{n}} \\times \\mathbf{E} = \\mathbf{0}$, we enforce this condition on the trial space, which also implies $\\mathbf{\\hat{n}} \\times \\boldsymbol{\\phi} = \\mathbf{0}$, making the integrand zero. For a Perfect Magnetic Conductor (PMC) boundary, $\\mathbf{\\hat{n}} \\times \\mathbf{H} = \\mathbf{0}$, which translates to $\\mathbf{\\hat{n}} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) = \\mathbf{0}$ on $\\partial\\Omega$, this is a natural boundary condition and also makes the boundary integral vanish. Since the target expression in the problem statement lacks a boundary term, we presume such a condition is in place.\n\nWith the boundary term eliminated, the weak formulation is: find $\\mathbf{E} \\in H(\\nabla \\times;\\Omega)$ (subject to essential BCs) such that for all test functions $\\boldsymbol{\\phi} \\in H(\\nabla \\times;\\Omega)$ (subject to homogeneous essential BCs):\n$$ \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}\\right)\\cdot\\left(\\nabla \\times \\mathbf{E}\\right) d\\Omega \\,-\\, \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}\\cdot\\mathbf{E} \\, d\\Omega = 0 $$\nIn the Finite Element Method (FEM), we seek an approximate solution $\\mathbf{E}_h$ in a finite-dimensional subspace spanned by basis functions $\\{\\boldsymbol{\\phi}_n\\}_{n=1}^N$. We express $\\mathbf{E}_h$ as a linear combination of these basis functions:\n$$ \\mathbf{E}_h = \\sum_{n=1}^{N} e_n \\boldsymbol{\\phi}_n $$\nwhere $e_n$ are the unknown complex coefficients. The Galerkin method uses the same set of functions for both trial and test spaces. We substitute $\\mathbf{E}_h$ for $\\mathbf{E}$ and choose the test function $\\boldsymbol{\\phi}$ to be each basis function $\\boldsymbol{\\phi}_m$ in turn ($m=1, \\dots, N$):\n$$ \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_m\\right)\\cdot\\left(\\nabla \\times \\sum_{n=1}^{N} e_n \\boldsymbol{\\phi}_n\\right) d\\Omega \\,-\\, \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}_m \\cdot \\left(\\sum_{n=1}^{N} e_n \\boldsymbol{\\phi}_n \\right) d\\Omega = 0 $$\nBy linearity of the integral, we can write this as a matrix system:\n$$ \\sum_{n=1}^{N} e_n \\left[ \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_m\\right)\\cdot\\left(\\nabla \\times \\boldsymbol{\\phi}_n\\right) d\\Omega \\,-\\, \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}_m \\cdot \\boldsymbol{\\phi}_n \\, d\\Omega \\right] = 0 $$\nThis is a linear system of equations $\\mathbf{A}\\mathbf{e} = \\mathbf{0}$. The entry $a_{mn}$ of the system matrix $\\mathbf{A}$ is the expression inside the brackets:\n$$ a_{mn} = \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_{m}\\right)\\cdot\\left(\\nabla \\times \\boldsymbol{\\phi}_{n}\\right) d\\Omega \\;-\\; \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}_{m}\\cdot \\boldsymbol{\\phi}_{n}\\, d\\Omega $$\nThis concludes the derivation.\n\n### Part 2: Explicit Calculation of $a_{12,12}$\n\nWe need to compute the diagonal entry $a_{12,12}$ for the basis function $\\boldsymbol{\\phi}_{12}$ over a single tetrahedral element $T$. As $\\mu$ and $\\epsilon$ are constant on $T$, we have:\n$$ a_{12,12} = \\mu^{-1} \\int_{T} |\\nabla \\times \\boldsymbol{\\phi}_{12}|^2 dV - \\omega^{2} \\epsilon \\int_{T} |\\boldsymbol{\\phi}_{12}|^2 dV $$\nThe vertices of the tetrahedron $T$ are $\\mathbf{x}_{1}=(0,0,0)$, $\\mathbf{x}_{2}=(h,0,0)$, $\\mathbf{x}_{3}=(0,h,0)$, and $\\mathbf{x}_{4}=(0,0,h)$. The volume of this tetrahedron is $|T| = \\frac{1}{6}h^3$.\n\nThe basis function is $\\boldsymbol{\\phi}_{12} = \\lambda_{1}\\nabla \\lambda_{2} - \\lambda_{2}\\nabla \\lambda_{1}$, where $\\lambda_i$ are the barycentric coordinates. For a point $\\mathbf{x}=(x,y,z) \\in T$, the barycentric coordinates are:\n$\\lambda_1 = 1 - \\frac{x+y+z}{h}$, $\\lambda_2 = \\frac{x}{h}$, $\\lambda_3 = \\frac{y}{h}$, $\\lambda_4 = \\frac{z}{h}$.\nTheir gradients are constant vectors:\n$\\nabla \\lambda_1 = \\left(-\\frac{1}{h}, -\\frac{1}{h}, -\\frac{1}{h}\\right)$, $\\nabla \\lambda_2 = \\left(\\frac{1}{h}, 0, 0\\right)$.\n\nFirst, we compute the curl of $\\boldsymbol{\\phi}_{12}$. Using the identity $\\nabla \\times (f\\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + \\nabla f \\times \\mathbf{A}$ and noting that $\\nabla \\times (\\nabla \\lambda) = \\mathbf{0}$ for any scalar field $\\lambda$:\n$$ \\nabla \\times \\boldsymbol{\\phi}_{12} = \\nabla \\times (\\lambda_1 \\nabla \\lambda_2) - \\nabla \\times (\\lambda_2 \\nabla \\lambda_1) = (\\nabla \\lambda_1 \\times \\nabla \\lambda_2) - (\\nabla \\lambda_2 \\times \\nabla \\lambda_1) = 2(\\nabla \\lambda_1 \\times \\nabla \\lambda_2) $$\nThe curl is a constant vector over the element $T$:\n$$ \\nabla \\lambda_1 \\times \\nabla \\lambda_2 = \\frac{1}{h^2} \\det \\begin{pmatrix} \\mathbf{\\hat{i}} & \\mathbf{\\hat{j}} & \\mathbf{\\hat{k}} \\\\ -1 & -1 & -1 \\\\ 1 & 0 & 0 \\end{pmatrix} = \\frac{1}{h^2} \\left(0, -1, 1\\right) $$\n$$ \\nabla \\times \\boldsymbol{\\phi}_{12} = \\frac{2}{h^2} \\left(0, -1, 1\\right) $$\nThe squared magnitude of the curl is:\n$$ |\\nabla \\times \\boldsymbol{\\phi}_{12}|^2 = \\left(\\frac{2}{h^2}\\right)^2 (0^2 + (-1)^2 + 1^2) = \\frac{4}{h^4} \\cdot 2 = \\frac{8}{h^4} $$\nThe first integral (stiffness matrix contribution) is:\n$$ \\int_{T} |\\nabla \\times \\boldsymbol{\\phi}_{12}|^2 dV = \\frac{8}{h^4} \\int_{T} dV = \\frac{8}{h^4} |T| = \\frac{8}{h^4} \\left(\\frac{h^3}{6}\\right) = \\frac{4}{3h} $$\nNext, we compute the second integral (mass matrix contribution). We evaluate $|\\boldsymbol{\\phi}_{12}|^2$:\n$$ |\\boldsymbol{\\phi}_{12}|^2 = |\\lambda_1 \\nabla \\lambda_2 - \\lambda_2 \\nabla \\lambda_1|^2 = \\lambda_1^2 |\\nabla \\lambda_2|^2 - 2\\lambda_1\\lambda_2(\\nabla\\lambda_1 \\cdot \\nabla\\lambda_2) + \\lambda_2^2|\\nabla\\lambda_1|^2 $$\nWe calculate the dot and cross products of the gradients:\n$|\\nabla \\lambda_1|^2 = \\frac{1}{h^2}((-1)^2 + (-1)^2 + (-1)^2) = \\frac{3}{h^2}$\n$|\\nabla \\lambda_2|^2 = \\frac{1}{h^2}(1^2 + 0^2 + 0^2) = \\frac{1}{h^2}$\n$\\nabla \\lambda_1 \\cdot \\nabla \\lambda_2 = \\frac{1}{h^2}((-1)(1) + (-1)(0) + (-1)(0)) = -\\frac{1}{h^2}$\nSubstituting these into the expression for $|\\boldsymbol{\\phi}_{12}|^2$:\n$$ |\\boldsymbol{\\phi}_{12}|^2 = \\lambda_1^2 \\left(\\frac{1}{h^2}\\right) - 2\\lambda_1\\lambda_2\\left(-\\frac{1}{h^2}\\right) + \\lambda_2^2\\left(\\frac{3}{h^2}\\right) = \\frac{1}{h^2} \\left(\\lambda_1^2 + 2\\lambda_1\\lambda_2 + 3\\lambda_2^2\\right) $$\nTo integrate this over $T$, we use the standard formula for integrating powers of barycentric coordinates over a $d$-dimensional simplex: $\\int_T \\prod_{i=0}^d \\lambda_i^{p_i} dV = \\frac{d! \\prod p_i!}{(\\sum p_i + d)!}|T|$. For our $3D$ tetrahedron ($d=3$):\n$$ \\int_T \\lambda_1^{p_1} \\lambda_2^{p_2} \\lambda_3^{p_3} \\lambda_4^{p_4} dV = \\frac{3! p_1! p_2! p_3! p_4!}{(p_1+p_2+p_3+p_4+3)!} |T| $$\nWe need to compute $\\int_T \\lambda_1^2 dV$, $\\int_T \\lambda_1\\lambda_2 dV$, and $\\int_T \\lambda_2^2 dV$:\n$$ \\int_T \\lambda_1^2 dV = \\frac{3! \\cdot 2!}{5!} |T| = \\frac{6 \\cdot 2}{120} |T| = \\frac{1}{10}|T| $$\n$$ \\int_T \\lambda_1\\lambda_2 dV = \\frac{3! \\cdot 1! \\cdot 1!}{5!} |T| = \\frac{6}{120} |T| = \\frac{1}{20}|T| $$\n$$ \\int_T \\lambda_2^2 dV = \\frac{3! \\cdot 2!}{5!} |T| = \\frac{1}{10}|T| $$\nSo, the second integral is:\n$$ \\int_{T} |\\boldsymbol{\\phi}_{12}|^2 dV = \\frac{1}{h^2} \\int_T (\\lambda_1^2 + 2\\lambda_1\\lambda_2 + 3\\lambda_2^2) dV $$\n$$ = \\frac{|T|}{h^2} \\left( \\frac{1}{10} + 2\\left(\\frac{1}{20}\\right) + 3\\left(\\frac{1}{10}\\right) \\right) = \\frac{|T|}{h^2} \\left(\\frac{1}{10} + \\frac{1}{10} + \\frac{3}{10}\\right) = \\frac{|T|}{h^2} \\left(\\frac{5}{10}\\right) = \\frac{|T|}{2h^2} $$\nSubstituting $|T| = h^3/6$:\n$$ \\int_{T} |\\boldsymbol{\\phi}_{12}|^2 dV = \\frac{h^3/6}{2h^2} = \\frac{h}{12} $$\nFinally, we combine the terms to find $a_{12,12}$:\n$$ a_{12,12} = \\mu^{-1} \\left(\\frac{4}{3h}\\right) - \\omega^{2} \\epsilon \\left(\\frac{h}{12}\\right) = \\frac{4}{3\\mu h} - \\frac{\\omega^2 \\epsilon h}{12} $$",
            "answer": "$$\\boxed{\\frac{4}{3\\mu h} - \\frac{\\omega^{2} \\epsilon h}{12}}$$"
        },
        {
            "introduction": "Once the weak form is established, its integrals must be computed, typically through numerical quadrature. This exercise addresses the critical question of how accurately these integrals must be evaluated to preserve the integrity of the numerical method. By analyzing the polynomial degree of the integrands, you will determine the minimum required quadrature order, a key step in developing an efficient and accurate FEM code and avoiding so-called \"variational crimes.\" ",
            "id": "3309737",
            "problem": "Consider the time-harmonic Maxwell equations posed on a single tetrahedral element $K \\subset \\mathbb{R}^{3}$ with piecewise-constant material properties: magnetic permeability $\\mu$ and electric permittivity $\\epsilon$. Using the Galerkin method, the element-level bilinear form for trial and test fields $\\mathbf{u}$ and $\\mathbf{v}$ belonging to the first-order Nédélec finite element space is\n$$\na(\\mathbf{u},\\mathbf{v}) \\;=\\; \\int_{K} \\mu^{-1} \\left(\\nabla \\times \\mathbf{u}\\right) \\cdot \\left(\\nabla \\times \\mathbf{v}\\right) \\,\\mathrm{d}V \\;+\\; \\int_{K} \\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v} \\,\\mathrm{d}V,\n$$\nwhere $\\omega$ is the angular frequency, and the trial and test functions are taken from the same space as required by the Galerkin testing procedure. Assume the tetrahedron $K$ is obtained by an affine mapping from the reference tetrahedron, so the Jacobian is constant over $K$. The finite element basis functions are the lowest-order ($r = 1$) Nédélec first-family edge functions on tetrahedra.\n\nYou are to determine the minimum polynomial exactness degree $p$ that a tetrahedral volume quadrature rule must have in order to evaluate $a(\\mathbf{u},\\mathbf{v})$ exactly for all pairs of basis functions on $K$. Argue your choice solely from polynomial degree properties of the first-order Nédélec basis functions and their curls, together with the affine mapping and constant coefficients assumptions. Provide your final answer as the integer value of $p$. No rounding is required, and no units are needed in your answer.",
            "solution": "The problem requires determining the minimum polynomial exactness degree $p$ that a tetrahedral volume quadrature rule must possess to exactly evaluate the bilinear form\n$$\na(\\mathbf{u},\\mathbf{v}) \\;=\\; \\int_{K} \\mu^{-1} \\left(\\nabla \\times \\mathbf{u}\\right) \\cdot \\left(\\nabla \\times \\mathbf{v}\\right) \\,\\mathrm{d}V \\;+\\; \\int_{K} \\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v} \\,\\mathrm{d}V\n$$\nfor all pairs of basis functions $\\mathbf{u}$ and $\\mathbf{v}$ from the lowest-order Nédélec finite element space on a tetrahedron $K$.\n\nA quadrature rule with polynomial exactness degree $p$ can exactly integrate any polynomial of degree less than or equal to $p$. To find the minimum required $p$, we must determine the maximum polynomial degree of the integrand of $a(\\mathbf{u},\\mathbf{v})$ when $\\mathbf{u}$ and $\\mathbf{v}$ are basis functions.\n\nThe integrand is a sum of two terms: $\\mu^{-1} (\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$ and $\\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v}$. The overall polynomial degree will be the maximum of the degrees of these two terms. The problem states that the material properties $\\mu$ and $\\epsilon$, as well as the angular frequency $\\omega$, are constants over the element $K$. Thus, the factors $\\mu^{-1}$ and $\\omega^2\\epsilon$ are constants and do not affect the polynomial degree of the integrands.\n\nThe analysis is based on the properties of the basis functions. The problem specifies the use of the lowest-order ($r=1$) Nédélec first-family edge basis functions on a tetrahedron. A key property of these basis functions, whether on the reference element or on an affine-mapped physical element, is that they are vector-valued polynomials where each component is a polynomial of degree at most $1$. Let's denote the space of polynomials of degree at most $k$ as $\\mathcal{P}_k$. Then, a basis function $\\mathbf{u}$ (or $\\mathbf{v}$) is an element of $[\\mathcal{P}_1(K)]^3$. Specifically, these functions are of the form $\\mathbf{a} + \\mathbf{b} \\times \\mathbf{x}$, where $\\mathbf{a}$ and $\\mathbf{b}$ are constant vectors and $\\mathbf{x}$ is the position vector.\n\nLet's analyze the polynomial degree of each term in the integrand.\n\n1.  **Analysis of the second term: $\\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v}$**\n    Let $\\mathbf{u}$ and $\\mathbf{v}$ be two such basis functions. Both are vector-valued polynomials of degree $1$. Their dot product is given by:\n    $$\n    \\mathbf{u} \\cdot \\mathbf{v} = u_x v_x + u_y v_y + u_z v_z\n    $$\n    Since each component ($u_x, u_y, u_z, v_x, v_y, v_z$) is a polynomial of degree at most $1$ in the spatial coordinates $(x,y,z)$, each product term like $u_x v_x$ is a polynomial of degree at most $1+1=2$. The sum of such terms, $\\mathbf{u} \\cdot \\mathbf{v}$, is therefore a scalar polynomial of degree at most $2$. As $\\omega^2\\epsilon$ is constant, the integrand of the second integral, $\\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v}$, is a polynomial of degree $2$.\n\n2.  **Analysis of the first term: $\\mu^{-1} (\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$**\n    We need to determine the polynomial degree of the curl of a basis function, $\\nabla \\times \\mathbf{u}$. A basis function $\\mathbf{u}$ has components that are polynomials of degree $1$. Let's write a generic component of $\\mathbf{u}$ as $u_i(\\mathbf{x}) = c_{i0} + c_{i1}x + c_{i2}y + c_{i3}z$. The curl operation involves taking spatial derivatives. For example, the $x$-component of the curl is $(\\nabla \\times \\mathbf{u})_x = \\frac{\\partial u_z}{\\partial y} - \\frac{\\partial u_y}{\\partial z}$.\n    When we take a partial derivative of a polynomial of degree $1$ with respect to a spatial variable, the result is a constant (a polynomial of degree $0$). For instance, $\\frac{\\partial u_z}{\\partial y} = c_{z2}$, which is a constant. Consequently, each component of $\\nabla \\times \\mathbf{u}$ is a constant. This means that $\\nabla \\times \\mathbf{u}$ is a constant vector field, which is a vector-valued polynomial of degree $0$.\n    This is a fundamental property of lowest-order Nédélec elements: their curls are constant vectors.\n    Since both $\\nabla \\times \\mathbf{u}$ and $\\nabla \\times \\mathbf{v}$ are constant vectors (polynomials of degree $0$), their dot product, $(\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$, is a scalar constant (a polynomial of degree $0$). As $\\mu^{-1}$ is constant, the integrand of the first integral, $\\mu^{-1} (\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$, is a polynomial of degree $0$.\n\nThe assumption of an affine mapping from a reference tetrahedron ensures that this analysis holds. Under an affine map, polynomials of a certain degree are mapped to polynomials of the same degree, and the Jacobian of the transformation is a constant. This means the polynomial degrees of the integrands are the same whether analyzed on the physical element $K$ or the reference element.\n\nTo summarize the findings for the integrands:\n- The term $\\mu^{-1} (\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$ is a polynomial of degree $0$.\n- The term $\\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v}$ is a polynomial of degree $2$.\n\nThe total integrand for the bilinear form $a(\\mathbf{u},\\mathbf{v})$ is the sum of these two terms. The degree of a sum of polynomials is the maximum of their individual degrees. Therefore, the integrand of $a(\\mathbf{u},\\mathbf{v})$ is a polynomial of degree $\\max(0, 2) = 2$.\n\nFor a quadrature rule to evaluate the integral of this polynomial exactly, it must be exact for all polynomials up to degree $2$. Therefore, the minimum required polynomial exactness degree $p$ for the quadrature rule is $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "The theoretical requirement for accurate integration has profound practical consequences, and failing to meet it constitutes a \"variational crime\" that can render a simulation useless. This hands-on coding problem allows you to investigate this phenomenon directly by observing how under-integration breaks the discrete symmetry of the curl operators, leading to non-physical energy growth in a dissipative system. This practice provides a compelling demonstration of why maintaining consistency in the Galerkin framework is crucial for numerical stability. ",
            "id": "3309793",
            "problem": "Consider the two-dimensional Transverse Electric (TE) form of Maxwell’s equations on the unit square domain $[0,1]\\times[0,1]$ with a uniform, dimensionless conductivity $\\sigma>0$ in a simply connected domain with perfectly insulating boundaries so that boundary integrals vanish in the energy balance. The electric field has one nonzero scalar component $E_z(x,y,t)$, while the magnetic field is the in-plane vector $H(x,y,t)=(H_x(x,y,t),H_y(x,y,t))$. The dimensionless strong-form TE system is\n$$\n\\partial_t H_x = -\\partial_y E_z,\\quad\n\\partial_t H_y = \\phantom{-}\\partial_x E_z,\\quad\n\\partial_t E_z = -\\partial_x H_y + \\partial_y H_x - \\sigma E_z.\n$$\nFrom Maxwell’s equations and standard manipulations (integration by parts and using boundary conditions that eliminate boundary terms), the continuous energy functional\n$$\n\\mathcal{E}(t)=\\tfrac{1}{2}\\int_{[0,1]^2}\\left(\\lvert H\\rvert^2+\\lvert E_z\\rvert^2\\right)\\,dx\\,dy\n$$\nsatisfies the energy identity\n$$\n\\frac{d}{dt}\\mathcal{E}(t)=-\\sigma\\int_{[0,1]^2}\\lvert E_z\\rvert^2\\,dx\\,dy\\le 0,\n$$\nso energy is non-increasing for $\\sigma>0$.\n\nIn a Galerkin testing procedure, let the scalar field $E_z$ be approximated as $E_z(x,y,t)\\approx\\sum_{i=1}^{N_e}e_i(t)\\,\\phi_i(x,y)$ and the vector field $H$ as $H(x,y,t)\\approx\\sum_{j=1}^{N_h}h_j(t)\\,\\psi_j(x,y)$, where $\\{\\phi_i\\}_{i=1}^{N_e}$ are scalar basis functions and $\\{\\psi_j\\}_{j=1}^{N_h}$ are vector basis functions. Define the symmetric, positive definite mass matrices for electric and magnetic fields\n$$\nM_e[i,k]=\\int_{[0,1]^2}\\phi_i\\,\\phi_k\\,dx\\,dy,\\qquad\nM_h[j,\\ell]=\\int_{[0,1]^2}\\psi_j\\cdot\\psi_\\ell\\,dx\\,dy.\n$$\nDefine the coupling matrices arising from the curl interactions\n$$\nA[i,j]=\\int_{[0,1]^2}\\phi_i\\left(\\partial_x \\psi_j^{(y)}-\\partial_y \\psi_j^{(x)}\\right)\\,dx\\,dy,\\qquad\nB[j,i]=\\int_{[0,1]^2}\\psi_j\\cdot\\left(-\\partial_y\\phi_i,\\ \\partial_x\\phi_i\\right)\\,dx\\,dy,\n$$\nwhere $\\psi_j^{(x)}$ and $\\psi_j^{(y)}$ denote the components of $\\psi_j$. For sufficiently smooth $\\phi_i$ and $\\psi_j$ and exact evaluation of the integrals, integration by parts implies $B=-A^\\top$, which yields a discrete energy identity mirroring the continuous one. However, if the curl-curl inner products are under-integrated (a variational crime), the discrete integration-by-parts consistency can be broken so that $B\\ne -A^\\top$, which may introduce non-physical energy growth even when $\\sigma>0$.\n\nIn this problem, fix $N_e=2$ and $N_h=2$, and use the following polynomial basis functions that vanish on the boundary to eliminate boundary terms:\n- For the electric field,\n$$\n\\phi_1(x,y)=x(1-x)\\,y(1-y),\\qquad\n\\phi_2(x,y)=\\bigl(x(1-x)\\bigr)^2\\,y(1-y).\n$$\n- For the magnetic field,\n$$\n\\psi_1(x,y)=\\bigl(\\phi_1(x,y),\\ 0\\bigr),\\qquad\n\\psi_2(x,y)=\\bigl(0,\\ \\phi_2(x,y)\\bigr).\n$$\nWith these choices, the matrices $M_e$, $M_h$, $A$, and $B$ are $2\\times 2$. Let $A$ be assembled with a quadrature rule $Q_A$ and $B$ with a (possibly different) quadrature rule $Q_B$. The electric and magnetic mass matrices $M_e$ and $M_h$ must be assembled with a high-accuracy quadrature rule. Consider two quadrature rules:\n- A high-accuracy Gauss–Legendre tensor-product rule of order $5$ in each dimension (denote as $Q_\\mathrm{G5}$).\n- A severely under-integrated midpoint rule with a single point at the domain center $(x,y)=\\left(\\tfrac{1}{2},\\tfrac{1}{2}\\right)$ (denote as $Q_\\mathrm{MP}$).\n\nDefine the discrete energy\n$$\n\\mathcal{E}_h(e,h)=\\tfrac{1}{2}\\left(e^\\top M_e\\,e+h^\\top M_h\\,h\\right),\n$$\nwhere $e\\in\\mathbb{R}^{2}$ and $h\\in\\mathbb{R}^{2}$ are the coefficient vectors. The semi-discrete Galerkin system has an instantaneous discrete energy rate at state $(e,h)$ given by\n$$\n\\frac{d}{dt}\\mathcal{E}_h(e,h)=-\\sigma\\,e^\\top M_e\\,e+e^\\top A\\,h+h^\\top B\\,e.\n$$\nFor fixed $M_e$, $M_h$, $A$, and $B$, define the worst-case instantaneous energy growth over unit-energy states by optimizing over $e$ and $h$ subject to the constraints $e^\\top M_e\\,e=1$ and $h^\\top M_h\\,h=1$. Show that this worst-case rate equals\n$$\n\\max_{\\substack{e^\\top M_e e=1\\\\ h^\\top M_h h=1}}\\left[-\\sigma\\,e^\\top M_e e+e^\\top(A+B^\\top)h\\right]=-\\sigma+\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2,\n$$\nwhere $\\|\\cdot\\|_2$ denotes the spectral norm and $M_e^{-1/2}$, $M_h^{-1/2}$ are the symmetric inverse square roots. Therefore, non-physical energy growth is indicated if and only if\n$$\n\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2 > \\sigma.\n$$\n\nYour task is to write a complete, runnable program that:\n- Assembles $M_e$ and $M_h$ with $Q_\\mathrm{G5}$.\n- Assembles $A$ with a chosen rule $Q_A\\in\\{Q_\\mathrm{G5},Q_\\mathrm{MP}\\}$ and $B$ with $Q_B\\in\\{Q_\\mathrm{G5},Q_\\mathrm{MP}\\}$.\n- Computes the spectral norm $\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2$ and compares it to the given $\\sigma$.\n- Outputs a boolean indicating whether the inequality $\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2 > \\sigma$ holds, which signifies non-physical instantaneous energy growth in a lossy medium due to quadrature-induced variational crime.\n\nAll quantities are dimensionless. Angles are not used. The final outputs are booleans.\n\nUse the following test suite of parameter values to exercise different cases:\n- Case $1$ (happy path, exact energy decay): $Q_A=Q_\\mathrm{G5}$, $Q_B=Q_\\mathrm{G5}$, $\\sigma=0.1$.\n- Case $2$ (variational crime, under-integrated curl-curl on $A$ only): $Q_A=Q_\\mathrm{MP}$, $Q_B=Q_\\mathrm{G5}$, $\\sigma=0.001$.\n- Case $3$ (variational crime mitigated by strong loss): $Q_A=Q_\\mathrm{MP}$, $Q_B=Q_\\mathrm{G5}$, $\\sigma=10.0$.\n- Case $4$ (symmetric under-integration on both couplings): $Q_A=Q_\\mathrm{MP}$, $Q_B=Q_\\mathrm{MP}$, $\\sigma=0.001$.\n\nYour program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$. The results must be the four booleans, in the order of the cases listed above.",
            "solution": "The problem statement has been critically validated and is determined to be valid. It is scientifically grounded in the principles of computational electromagnetics, specifically the Galerkin finite element method applied to Maxwell's equations. The problem is well-posed, with all necessary data, functions, and conditions clearly defined. It presents a computationally verifiable task without internal contradictions, ambiguities, or reliance on pseudoscience.\n\nThe task is to determine if a semi-discrete approximation of the 2D Transverse Electric (TE) Maxwell's equations exhibits non-physical energy growth due to a \"variational crime\"—the use of inconsistent numerical quadrature for different terms in the weak formulation. The criterion for this growth is given by the inequality $\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\|_2 > \\sigma$, where $\\sigma$ is the physical conductivity. A positive outcome indicates that the numerical error can overcome the physical dissipation, leading to an unstable simulation.\n\nThe solution proceeds by implementing the computational steps necessary to evaluate the left-hand side of this inequality for four given test cases.\n\n**1. Basis Functions and Derivatives**\nThe problem specifies polynomial basis functions on the unit square $[0,1] \\times [0,1]$.\nFor the scalar electric field $E_z$, with $N_e=2$:\n$$\n\\phi_1(x,y) = x(1-x)y(1-y) = (x-x^2)(y-y^2) \\\\\n\\phi_2(x,y) = (x(1-x))^2 y(1-y) = (x^2-2x^3+x^4)(y-y^2)\n$$\nFor the vector magnetic field $H$, with $N_h=2$:\n$$\n\\psi_1(x,y) = (\\phi_1(x,y), 0) \\\\\n\\psi_2(x,y) = (0, \\phi_2(x,y))\n$$\nThe construction of the coupling matrices $A$ and $B$ requires the partial derivatives of these basis functions:\n$$\n\\partial_x \\phi_1(x,y) = (1-2x)y(1-y) \\\\\n\\partial_y \\phi_1(x,y) = x(1-x)(1-2y) \\\\\n\\partial_x \\phi_2(x,y) = (2(x-x^2)(1-2x))y(1-y) = (2x-6x^2+4x^3)(y-y^2) \\\\\n\\partial_y \\phi_2(x,y) = (x(1-x))^2(1-2y)\n$$\n\n**2. Numerical Quadrature**\nThe matrix entries are defined by integrals over the unit square. These integrals are approximated using two specified quadrature rules:\n- $Q_\\mathrm{G5}$: A tensor-product rule using $5$-point Gauss-Legendre quadrature in each dimension. This rule is of high order, sufficient to integrate all polynomial integrands in this problem exactly. A 2D integral is computed as $\\int_0^1 \\int_0^1 f(x,y) \\,dx\\,dy \\approx \\sum_{k=1}^5 \\sum_{l=1}^5 w'_k w'_l f(x'_k, x'_l)$, where $(x'_k, w'_k)$ are the quadrature points and weights mapped from the standard interval $[-1,1]$ to $[0,1]$.\n- $Q_\\mathrm{MP}$: A single-point midpoint rule. This rule approximates the integral as $\\int_0^1 \\int_0^1 f(x,y) \\,dx\\,dy \\approx f(0.5, 0.5)$, using a single evaluation at the domain center with a weight of $1$. This is a very low-order rule that significantly under-integrates the polynomial integrands.\n\n**3. Matrix Assembly**\nThe matrices $M_e, M_h, A, B$ are $2 \\times 2$. Their entries are computed by applying a specified quadrature rule to their integral definitions.\n\n- **Mass Matrices ($M_e$, $M_h$):** Both are assembled using the high-accuracy rule $Q_\\mathrm{G5}$.\n  $$\n  M_e[i,k] = \\int_0^1\\int_0^1 \\phi_i \\phi_k \\,dx\\,dy, \\quad i,k \\in \\{1,2\\} \\\\\n  M_h[j,\\ell] = \\int_0^1\\int_0^1 \\psi_j \\cdot \\psi_\\ell \\,dx\\,dy, \\quad j,\\ell \\in \\{1,2\\}\n  $$\n  Given the definitions of $\\psi_j$, $M_h$ is a diagonal matrix with entries $M_h[1,1]=\\int \\phi_1^2$, $M_h[2,2]=\\int \\phi_2^2$, and $M_h[1,2]=M_h[2,1]=0$.\n\n- **Coupling Matrices ($A$, $B$):** Assembled using either $Q_\\mathrm{G5}$ or $Q_\\mathrm{MP}$ as specified by the test case.\n  The definition of $A$ is $A[i,j] = \\int_0^1\\int_0^1 \\phi_i (\\partial_x \\psi_j^{(y)} - \\partial_y \\psi_j^{(x)}) \\,dx\\,dy$.\n  The individual entries' integrands are:\n  $A[1,1]: -\\phi_1 \\partial_y \\phi_1$, $A[1,2]: \\phi_1 \\partial_x \\phi_2$,\n  $A[2,1]: -\\phi_2 \\partial_y \\phi_1$, $A[2,2]: \\phi_2 \\partial_x \\phi_2$.\n  The definition of $B$ is $B[j,i] = \\int_0^1\\int_0^1 \\psi_j \\cdot (-\\partial_y\\phi_i, \\partial_x\\phi_i) \\,dx\\,dy$.\n  The individual entries' integrands are:\n  $B[1,1]: -\\phi_1 \\partial_y \\phi_1$, $B[1,2]: -\\phi_1 \\partial_y \\phi_2$,\n  $B[2,1]: \\phi_2 \\partial_x \\phi_1$, $B[2,2]: \\phi_2 \\partial_x \\phi_2$.\n  \n  When $Q_\\mathrm{G5}$ is used for both $A$ and $B$, the exact integration by parts property $B=-A^\\top$ holds due to the basis functions vanishing on the boundary. This leads to $A+B^\\top=0$. When $Q_\\mathrm{MP}$ is used, we note that all first-order partial derivatives of $\\phi_1$ and $\\phi_2$ are zero at the midpoint $(0.5, 0.5)$. Consequently, any matrix ($A$ or $B$) assembled with $Q_\\mathrm{MP}$ will be the zero matrix.\n\n**4. Computation of the Energy Growth Criterion**\nFor each test case, the following steps are performed:\n1.  Assemble $M_e$ and $M_h$ using $Q_\\mathrm{G5}$.\n2.  Assemble $A$ using the rule $Q_A$ and $B$ using $Q_B$ for that case.\n3.  Compute the matrix $C = A+B^\\top$.\n4.  Compute the symmetric inverse square roots of the mass matrices, $M_e^{-1/2}$ and $M_h^{-1/2}$. This is achieved by first finding the principal square root $M^{1/2}$ using `scipy.linalg.sqrtm` and then inverting the result.\n5.  Form the matrix $K = M_e^{-1/2} C M_h^{-1/2}$.\n6.  Calculate the spectral norm $\\|K\\|_2$, which is the largest singular value of $K$.\n7.  Compare the computed norm with the given conductivity $\\sigma$ to evaluate the boolean condition $\\|K\\|_2 > \\sigma$.\n\nThe process is repeated for all four cases to generate the final list of boolean results.\n- **Case 1 ($Q_A=Q_\\mathrm{G5}, Q_B=Q_\\mathrm{G5}$):** $A+B^\\top = 0$, so the norm is $0$. The inequality $0 > \\sigma$ is false.\n- **Case 2 ($Q_A=Q_\\mathrm{MP}, Q_B=Q_\\mathrm{G5}$):** $A=0$, so $C=B^\\top$. $B$ is non-zero, leading to a positive norm. For small $\\sigma=0.001$, the inequality is expected to be true.\n- **Case 3 ($Q_A=Q_\\mathrm{MP}, Q_B=Q_\\mathrm{G5}$):** Same as Case 2, but with large $\\sigma=10.0$. The norm is likely smaller than $\\sigma$, so the inequality is expected to be false.\n- **Case 4 ($Q_A=Q_\\mathrm{MP}, Q_B=Q_\\mathrm{MP}$):** $A=0$ and $B=0$, so $C=0$. The norm is $0$. The inequality $0 > \\sigma$ is false.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import sqrtm\n\ndef solve():\n    \"\"\"\n    Solves the problem of detecting non-physical energy growth in a\n    Galerkin discretization of Maxwell's equations due to quadrature-induced\n    variational crimes.\n    \"\"\"\n\n    # Define basis functions and their partial derivatives\n    def phi1(x, y):\n        return (x - x**2) * (y - y**2)\n\n    def dphi1_dx(x, y):\n        return (1 - 2*x) * (y - y**2)\n\n    def dphi1_dy(x, y):\n        return (x - x**2) * (1 - 2*y)\n\n    def phi2(x, y):\n        return (x - x**2)**2 * (y - y**2)\n\n    def dphi2_dx(x, y):\n        return (2 * (x - x**2) * (1 - 2*x)) * (y - y**2)\n\n    def dphi2_dy(x, y):\n        return (x - x**2)**2 * (1 - 2*y)\n    \n    # Store functions in lists for easier iteration\n    # Indices 0 and 1 correspond to basis functions 1 and 2\n    phis = [phi1, phi2]\n    dphis_dx = [dphi1_dx, dphi2_dx]\n    dphis_dy = [dphi1_dy, dphi2_dy]\n    \n    # Define numerical quadrature function\n    # Cache Gauss-Legendre points and weights for efficiency\n    g5_points, g5_weights = np.polynomial.legendre.leggauss(5)\n    g5_points_01 = 0.5 * (g5_points + 1.0)\n    g5_weights_01 = 0.5 * g5_weights\n\n    def integrate(integrand_func, rule='G5'):\n        if rule == 'MP':\n            return integrand_func(0.5, 0.5)\n        elif rule == 'G5':\n            integral_val = 0.0\n            for i in range(5):\n                for j in range(5):\n                    integral_val += g5_weights_01[i] * g5_weights_01[j] * integrand_func(g5_points_01[i], g5_points_01[j])\n            return integral_val\n        else:\n            raise ValueError(f\"Unknown quadrature rule: {rule}\")\n\n    # --- Matrix Assembly Functions ---\n    def assemble_Me(quad_rule):\n        Me = np.zeros((2, 2))\n        for i in range(2):\n            for k in range(2):\n                integrand = lambda x, y: phis[i](x, y) * phis[k](x, y)\n                Me[i, k] = integrate(integrand, quad_rule)\n        return Me\n\n    def assemble_Mh(quad_rule):\n        Mh = np.zeros((2, 2))\n        # M_h[0,0] = integral(phi1^2)\n        Mh[0, 0] = integrate(lambda x, y: phis[0](x, y)**2, quad_rule)\n        # M_h[1,1] = integral(phi2^2)\n        Mh[1, 1] = integrate(lambda x, y: phis[1](x, y)**2, quad_rule)\n        # Off-diagonal terms are zero\n        return Mh\n\n    def assemble_A(quad_rule):\n        A = np.zeros((2, 2))\n        for i in range(2): # Row index for phi_i\n            # j=0 (column 1) corresponds to psi_1 = (phi1, 0)\n            integrand_A_i0 = lambda x, y, i=i: -phis[i](x,y) * dphis_dy[0](x,y)\n            A[i, 0] = integrate(integrand_A_i0, quad_rule)\n            \n            # j=1 (column 2) corresponds to psi_2 = (0, phi2)\n            integrand_A_i1 = lambda x, y, i=i: phis[i](x,y) * dphis_dx[1](x,y)\n            A[i, 1] = integrate(integrand_A_i1, quad_rule)\n        return A\n        \n    def assemble_B(quad_rule):\n        B = np.zeros((2, 2))\n        # j=0 (row 1) corresponds to psi_1\n        for i in range(2): # Column index for phi_i\n            integrand_B_0i = lambda x, y, i=i: -phis[0](x,y) * dphis_dy[i](x,y)\n            B[0, i] = integrate(integrand_B_0i, quad_rule)\n\n        # j=1 (row 2) corresponds to psi_2\n        for i in range(2): # Column index for phi_i\n            integrand_B_1i = lambda x, y, i=i: phis[1](x,y) * dphis_dx[i](x,y)\n            B[1, i] = integrate(integrand_B_1i, quad_rule)\n        return B\n        \n    # Define test cases from the problem statement\n    test_cases = [\n        # (Q_A, Q_B, sigma)\n        ('G5', 'G5', 0.1),      # Case 1\n        ('MP', 'G5', 0.001),    # Case 2\n        ('MP', 'G5', 10.0),     # Case 3\n        ('MP', 'MP', 0.001),    # Case 4\n    ]\n\n    results = []\n\n    # Assemble mass matrices once using high-accuracy quadrature\n    Me = assemble_Me('G5')\n    Mh = assemble_Mh('G5')\n\n    # Compute inverse square roots of mass matrices\n    # These are symmetric positive definite, so sqrtm is well-defined\n    # and returns the principal (unique SPD) square root.\n    Me_sqrt = sqrtm(Me)\n    Mh_sqrt = sqrtm(Mh)\n    Me_inv_sqrt = np.linalg.inv(Me_sqrt)\n    Mh_inv_sqrt = np.linalg.inv(Mh_sqrt)\n\n    # Process each test case\n    for q_a_rule, q_b_rule, sigma in test_cases:\n        A = assemble_A(q_a_rule)\n        B = assemble_B(q_b_rule)\n        \n        # Form the \"error\" matrix C = A + B^T\n        C = A + B.T\n        \n        # If C is numerically zero, the norm is zero, no need for matrix math\n        if np.allclose(C, 0):\n            norm_val = 0.0\n        else:\n            # Form the matrix K for the norm calculation\n            K = Me_inv_sqrt @ C @ Mh_inv_sqrt\n            \n            # Compute the spectral norm (largest singular value)\n            norm_val = np.linalg.norm(K, 2)\n        \n        # Check for non-physical energy growth\n        growth_detected = norm_val > sigma\n        results.append(growth_detected)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}