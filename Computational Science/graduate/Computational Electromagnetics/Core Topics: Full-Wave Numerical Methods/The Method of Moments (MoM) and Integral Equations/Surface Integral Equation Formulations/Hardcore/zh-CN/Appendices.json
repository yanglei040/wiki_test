{
    "hands_on_practices": [
        {
            "introduction": "在矩量法 (Method of Moments) 的实现中，一个基础但关键的挑战是如何处理源点和场点重合或邻近时出现的奇异积分。这些“自作用”项的精确计算对于数值解的稳定性和准确性至关重要。本实践将引导你通过一个经典的解析推导，运用坐标变换技术来正则化并求解一个弱奇异积分 ，这是构建任何表面积分方程 (SIE) 求解器都必须掌握的核心技能。",
            "id": "3352477",
            "problem": "在对完美电导体（PEC）散射体的电场积分方程（EFIE）进行矩量法离散化时，自由空间格林函数核的奇异部分，在低频极限下，简化为与 $1/R$ 成正比的拉普拉斯核，其中 $R$ 是观察点与源点之间的欧几里得距离。对于重合的测试和源单元，在平坦面板上的相关几何积分是弱奇异但有限的，并且必须进行解析处理，以保持表面积分方程公式的准确性和稳定性。\n\n考虑一个位于 $z=0$ 平面上的平坦参考三角形面板，其顶点位于 $(0,0,0)$、$(1,0,0)$ 和 $(0,1,0)$。将观察点置于原点 $(0,0,0)$，因此对于三角形上的任何源点 $(x,y,0)$，核距离为 $R=\\sqrt{x^{2}+y^{2}}$。从第一性原理（核的定义和有效的变量变换）出发，执行一次坐标变换以消除弱奇异性，并计算该积分\n$$\nI \\equiv \\iint_{T} \\frac{1}{\\sqrt{x^{2}+y^{2}}} \\, dx \\, dy,\n$$\n其中 $T=\\{(x,y)\\,:\\, x\\ge 0,\\; y\\ge 0,\\; x+y\\le 1\\}$ 是参考三角形。在您的推导中，请明确指出任何对数贡献的来源，以及在表面积分方程公式的数值积分中必须小心处理的特定对数项。将您的最终结果表示为封闭形式的解析表达式。最终答案不需要数值近似。",
            "solution": "所述问题具有科学依据，是适定的、客观的，并包含了唯一解所需的所有必要信息。它代表了计算电磁学中表面积分方程矩量法的一个标准和基础的计算。因此，我们可以进行推导。\n\n问题要求计算积分\n$$\nI \\equiv \\iint_{T} \\frac{1}{\\sqrt{x^{2}+y^{2}}} \\, dx \\, dy\n$$\n其中积分域 $T$ 是 $z=0$ 平面内顶点为 $(0,0,0)$、$(1,0,0)$ 和 $(0,1,0)$ 的三角形。该域由不等式 $x \\ge 0$、$y \\ge 0$ 和 $x+y \\le 1$ 描述。被积函数在原点 $(0,0,0)$ 处有一个弱奇异性，该点是三角形的一个顶点。\n\n为了计算这个积分，我们执行从笛卡尔坐标 $(x,y)$ 到极坐标 $(r,\\theta)$ 的坐标变换。这是处理形如 $1/R$ 的奇异性的标准程序，其中 $R=\\sqrt{x^2+y^2}$ 是距奇异点的径向距离。该变换定义为：\n$$\nx = r \\cos\\theta\n$$\n$$\ny = r \\sin\\theta\n$$\n微分面积元 $dx \\, dy$ 根据变换的雅可比行列式进行变换：\n$$\ndx \\, dy = |J| \\, dr \\, d\\theta = r \\, dr \\, d\\theta\n$$\n被积函数，即积分的核，变为：\n$$\n\\frac{1}{\\sqrt{x^{2}+y^{2}}} = \\frac{1}{\\sqrt{(r\\cos\\theta)^{2} + (r\\sin\\theta)^{2}}} = \\frac{1}{\\sqrt{r^{2}(\\cos^{2}\\theta + \\sin^{2}\\theta)}} = \\frac{1}{r}\n$$\n将这些代入积分中，我们观察到一个关键的抵消：\n$$\n\\frac{1}{\\sqrt{x^{2}+y^{2}}} dx \\, dy = \\frac{1}{r} (r \\, dr \\, d\\theta) = dr \\, d\\theta\n$$\n这次变换通过用雅可比行列式中的因子 $r$ 抵消 $1/r$ 奇异性，有效地使积分正则化。问题现在简化为在变换后的域上对常数函数 $1$ 进行积分。\n\n接下来，我们必须确定与三角形域 $T$ 相对应的 $r$ 和 $\\theta$ 的积分限。\n条件 $x \\ge 0$ 和 $y \\ge 0$ 将角度 $\\theta$ 限制在第一象限，因为 $r \\ge 0$。因此，$\\theta$ 的积分限为：\n$$\n0 \\le \\theta \\le \\frac{\\pi}{2}\n$$\n第三个条件 $x+y \\le 1$ 定义了径向坐标 $r$ 的上界。代入极坐标表达式：\n$$\nr \\cos\\theta + r \\sin\\theta \\le 1\n$$\n$$\nr(\\cos\\theta + \\sin\\theta) \\le 1\n$$\n因为对于 $\\theta \\in [0, \\pi/2]$，$\\cos\\theta + \\sin\\theta > 0$，我们可以将 $r$ 的上界写为：\n$$\nr \\le \\frac{1}{\\cos\\theta + \\sin\\theta}\n$$\n$r$ 的下界是 $0$。因此，极坐标下的积分为：\n$$\nI = \\int_{0}^{\\frac{\\pi}{2}} \\int_{0}^{\\frac{1}{\\cos\\theta + \\sin\\theta}} 1 \\, dr \\, d\\theta\n$$\n我们首先计算关于 $r$ 的内层积分：\n$$\n\\int_{0}^{\\frac{1}{\\cos\\theta + \\sin\\theta}} 1 \\, dr = [r]_{0}^{\\frac{1}{\\cos\\theta + \\sin\\theta}} = \\frac{1}{\\cos\\theta + \\sin\\theta}\n$$\n现在，我们剩下关于 $\\theta$ 的外层积分：\n$$\nI = \\int_{0}^{\\frac{\\pi}{2}} \\frac{1}{\\cos\\theta + \\sin\\theta} \\, d\\theta\n$$\n为了计算这个积分，我们将分母表示为 $A\\cos(\\theta-\\alpha)$ 的形式。我们令 $\\cos\\theta + \\sin\\theta = A(\\cos\\theta\\cos\\alpha + \\sin\\theta\\sin\\alpha)$。通过比较 $\\cos\\theta$ 和 $\\sin\\theta$ 的系数，我们得到 $A\\cos\\alpha = 1$ 和 $A\\sin\\alpha = 1$。将这两个方程平方并相加，得到 $A^2(\\cos^2\\alpha + \\sin^2\\alpha) = 1^2 + 1^2$，即 $A^2 = 2$，所以 $A=\\sqrt{2}$。两方程相除得到 $\\tan\\alpha=1$，所以 $\\alpha = \\pi/4$。\n因此，分母为 $\\cos\\theta + \\sin\\theta = \\sqrt{2}\\cos(\\theta - \\pi/4)$。积分变为：\n$$\nI = \\int_{0}^{\\frac{\\pi}{2}} \\frac{1}{\\sqrt{2}\\cos(\\theta - \\pi/4)} \\, d\\theta = \\frac{1}{\\sqrt{2}} \\int_{0}^{\\frac{\\pi}{2}} \\sec\\left(\\theta - \\frac{\\pi}{4}\\right) \\, d\\theta\n$$\n我们进行换元，$u = \\theta - \\pi/4$。那么 $du = d\\theta$。$u$ 的积分限为：\n当 $\\theta=0$ 时，$u = -\\pi/4$。\n当 $\\theta=\\pi/2$ 时，$u = \\pi/2 - \\pi/4 = \\pi/4$。\n积分变换为：\n$$\nI = \\frac{1}{\\sqrt{2}} \\int_{-\\pi/4}^{\\pi/4} \\sec(u) \\, du\n$$\n$\\sec(u)$ 的标准反导数是 $\\ln|\\sec(u) + \\tan(u)|$。在积分限上求值：\n$$\nI = \\frac{1}{\\sqrt{2}} \\left[ \\ln|\\sec(u) + \\tan(u)| \\right]_{-\\pi/4}^{\\pi/4}\n$$\n$$\nI = \\frac{1}{\\sqrt{2}} \\left( \\ln\\left|\\sec\\left(\\frac{\\pi}{4}\\right) + \\tan\\left(\\frac{\\pi}{4}\\right)\\right| - \\ln\\left|\\sec\\left(-\\frac{\\pi}{4}\\right) + \\tan\\left(-\\frac{\\pi}{4}\\right)\\right| \\right)\n$$\n代入值 $\\sec(\\pi/4) = \\sqrt{2}$、$\\tan(\\pi/4) = 1$、$\\sec(-\\pi/4) = \\sqrt{2}$ 和 $\\tan(-\\pi/4) = -1$：\n$$\nI = \\frac{1}{\\sqrt{2}} \\left( \\ln|\\sqrt{2} + 1| - \\ln|\\sqrt{2} - 1| \\right)\n$$\n因为 $\\sqrt{2}+1 > 0$ 且 $\\sqrt{2}-1 > 0$，所以可以去掉绝对值符号。使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\nI = \\frac{1}{\\sqrt{2}} \\ln\\left(\\frac{\\sqrt{2}+1}{\\sqrt{2}-1}\\right)\n$$\n为了简化对数的参数，我们将分子和分母乘以分母的共轭：\n$$\n\\frac{\\sqrt{2}+1}{\\sqrt{2}-1} = \\frac{(\\sqrt{2}+1)(\\sqrt{2}+1)}{(\\sqrt{2}-1)(\\sqrt{2}+1)} = \\frac{(\\sqrt{2}+1)^{2}}{2-1} = (\\sqrt{2}+1)^{2}\n$$\n将此代回 $I$ 的表达式中：\n$$\nI = \\frac{1}{\\sqrt{2}} \\ln\\left( (\\sqrt{2}+1)^{2} \\right) = \\frac{2}{\\sqrt{2}} \\ln(\\sqrt{2}+1) = \\sqrt{2}\\ln(1+\\sqrt{2})\n$$\n问题还要求明确对数贡献的来源。对数项来源于问题中角度积分的部分，具体来说是来自于对正割函数 $\\sec(u)$ 的积分。这个积分自然地计算出一个对数函数。虽然极坐标变换消除了原始的代数奇异性 $1/r$，但当积分域的几何形状在极坐标中表示时，会导致一个被积函数 $f(\\theta)$，其反导数包含一个对数。\n\n在表面积分方程的数值积分背景下，进行这种解析计算正是为了避免数值积分一个奇异函数的困难。然而，如果有人使用仅基于正则化（例如，Duffy变换）的更通用的数值方案，坐标变换会将积分转换为形如 $\\int_0^1 \\int_0^1 f(u,v) \\, du \\, dv$ 的形式，其中新的被积函数 $f(u,v)$ 不再是代数奇异的，但可能包含形如 $\\ln(u)$ 的项。这个可积的对数奇异性 $\\ln(u)$ 就是必须小心处理的项，通常通过采用专门的求积法则，如高斯-对数求积法，来实现精确的数值结果。",
            "answer": "$$\n\\boxed{\\sqrt{2}\\ln(1+\\sqrt{2})}\n$$"
        },
        {
            "introduction": "表面积分方程虽然强大，但某些特定形式（如磁场积分方程）在处理闭合问题时会受到“内部谐振”现象的困扰，导致其在特定频率下无唯一解。本练习旨在揭示这一理论缺陷的根源 。通过将积分方程的失效与亥姆霍兹方程内部边值问题的特征值联系起来，你将亲手推导出这些临界频率，从而深刻理解为何需要发展如组合场积分方程 (CFIE) 等更稳健的公式。",
            "id": "611168",
            "problem": "考虑一个定义在以原点为中心的单位圆盘域 $\\Omega$ 内的二维亥姆霍兹方程 $(\\Delta + k^2)u = 0$ 的内部狄利克雷问题。解 $u$ 在边界 $\\partial\\Omega$ 上被指定为 $u|_{\\partial\\Omega} = f$。\n\n解决此问题的一个常用方法是将其重构为一个边界积分方程。对于域 $\\Omega$ 内的任意一点 $\\mathbf{y}$，解 $u(\\mathbf{y})$ 可以通过一个双层势来表示，该双层势使用一个定义在边界 $\\mathbf{x} \\in \\partial\\Omega$ 上的未知密度函数 $\\mu(\\mathbf{x})$：\n$$u(\\mathbf{y}) = \\int_{\\partial\\Omega} \\mu(\\mathbf{x}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n_{\\mathbf{x}}} \\, ds_{\\mathbf{x}}$$\n此处，$G(\\mathbf{x}, \\mathbf{y})$ 是二维亥姆霍兹方程的基本解（或自由空间格林函数），由 $G(\\mathbf{x}, \\mathbf{y}) = \\frac{i}{4} H_0^{(1)}(k|\\mathbf{x}-\\mathbf{y}|)$ 给出，其中 $H_0^{(1)}$ 是零阶第一类汉克尔函数，$\\partial/\\partial n_{\\mathbf{x}}$ 表示在边界点 $\\mathbf{x}$ 处指向域 $\\Omega$ 外部的法向导数。\n\n通过施加狄利克雷边界条件 $u|_{\\partial\\Omega}=f$，可以推导出关于未知密度 $\\mu$ 的第二类弗雷德霍姆积分方程。对于大多数波数 $k$ 的值，此公式为 $\\mu$（并因此为 $u$）提供了唯一解。然而，在某些临界波数下，相应的齐次积分方程存在非平凡解，导致唯一性的失效。这种失效恰好发生在波数 $k$ 对应于一个相关的齐次偏微分方程问题的特征值时。\n\n您的任务是推导第一个（即最小的正数）临界波数 $k$ 的值，在该值下，此边界积分方程公式对于单位圆盘不是唯一可解的。请用贝塞尔函数根的标准记法表示您的答案。",
            "solution": "我们寻找使得齐次内部狄利克雷问题\n$$\n(\\Delta + k^2)u=0\\quad\\text{in }\\Omega,\\qquad u|_{\\partial\\Omega}=0\n$$\n在单位圆盘 $r\\le1$ 中有非平凡解的 $k$ 值。通过在极坐标下使用分离变量法 $u(r,\\theta)=R(r)\\Theta(\\theta)$，对于每个整数 $m\\ge0$，可以得到径向方程\n$$\nr^2R''(r)+rR'(r)+\\bigl(k^2r^2-m^2\\bigr)R(r)=0,\n$$\n其在 $r=0$ 处的正则解是 $R(r)=J_m(kr)$，即 $m$ 阶第一类贝塞尔函数。狄利克雷条件 $R(1)=0$ 给出\n$$\nJ_m(k)=0\\quad\\Longrightarrow\\quad k=j_{m,n},\n$$\n其中 $j_{m,n}$ 是 $J_m$ 的第 $n$ 个正根。最小的正根出现在 $m=0, n=1$ 时，即\n$$\nk=j_{0,1}.\n$$",
            "answer": "$$\\boxed{j_{0,1}}$$"
        },
        {
            "introduction": "在电磁散射问题中，导体表面的尖锐几何特征（如棱边和顶角）会导致表面电流和电荷密度呈现奇异性。SIE 解在这些区域的准确性严重依赖于离散网格的质量。本编码实践将指导你实现一种分级网格策略 ，以有效捕捉解的奇异行为，并通过计算收敛阶来定量地衡量相比于均匀网格，这种策略所带来的显著精度提升。",
            "id": "3352485",
            "problem": "考虑一个静电散射代理模型，该模型能够捕捉表面积分方程 (SIE) 在尖锐几何特征附近的基本奇异性行为。从 Maxwell 方程组出发，在忽略时间依赖性的静态极限下，电场满足 $\\nabla \\times \\mathbf{E} = \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon$。通过 $\\mathbf{E} = -\\nabla u$ 引入电势 $u$，在完美导电夹杂物外部的无源区域中，可以得到 $\\Delta u = 0$，并在导体边界上施加狄利克雷 (Dirichlet) 边界条件 $u = u_0$。在二维情况下，设 $S$ 表示一个薄的完美导电屏，其模型为 x 轴上的线段 $[-1,1]$。可以使用单层势来表示 $u$，其核函数为二维拉普拉斯格林函数 $G(x,y) = -\\frac{1}{2\\pi}\\log|x - y|$。将此表示限制在边界上，可得到关于未知表面电荷密度 $\\sigma$ 的第一类 SIE，\n$$\n\\int_{-1}^{1} G(x,y)\\,\\sigma(y)\\,\\mathrm{d}y = g(x), \\quad x \\in (-1,1),\n$$\n其中 $g(x)$ 是给定的边界数据。\n\n在尖锐边缘和尖端附近，表面积分方程的解通常表现出奇异性行为。对于此屏段，在某些恒定边界数据下，精确的表面电荷密度在端点 $x=\\pm1$ 附近的行为类似于 $C/\\sqrt{1 - x^{2}}$，这模拟了典型的楔形尖端奇点。您的任务是实现并分析一种能够捕捉这种奇异性的离散化策略和网格加密方案，并量化数值 SIE 解相对于加密指数的收敛率，并与均匀细化进行比较。\n\n您必须实现以下步骤和设计选择：\n\n1. 公式化与离散化：\n   - 使用核函数为 $G(x,y) = -\\frac{1}{2\\pi}\\log|x - y|$ 的单层算子，构建在区间 $[-1,1]$ 上的 SIE $\\int_{-1}^{1} G(x,y)\\,\\sigma(y)\\,\\mathrm{d}y = g(x)$。\n   - 将狄利克雷边界数据设置为常数 $g(x) = \\frac{\\log 2}{2}$，这会在 $\\sigma$ 中引发楔形尖端特有的端点奇异性。\n   - 通过基于单元的配置法和分片常数基函数来离散化该积分方程。将 $[-1,1]$ 划分为 $N$ 个端点为 $\\{a_j,b_j\\}_{j=1}^{N}$ 的单元，并使用配置点 $x_i = \\frac{a_i + b_i}{2}$。\n   - 组装稠密系统矩阵 $A \\in \\mathbb{R}^{N \\times N}$，其元素为\n     $$\n     A_{ij} = \\int_{a_j}^{b_j} G(x_i,y)\\,\\mathrm{d}y = -\\frac{1}{2\\pi}\\int_{a_j}^{b_j} \\log|x_i - y|\\,\\mathrm{d}y,\n     $$\n     对于每个单元上的常数基函数，该积分可通过微积分精确求值。求解 $A \\boldsymbol{\\sigma} = \\boldsymbol{g}$ 以得到单元上的常数未知量 $\\{\\sigma_j\\}_{j=1}^{N}$，其中 $\\boldsymbol{g}$ 是一个常数向量，其元素为 $g(x_i)$。\n\n2. 网格设计：\n   - 实现一个均匀网格 ($p = 1$)，其单元端点为 $x_k = -1 + 2s_k$，其中 $s_k = \\frac{k}{N}$，$k = 0,1,\\dots,N$。\n   - 通过映射\n     $$\n     \\beta_p(s) = \\frac{s^{p}}{s^{p} + (1 - s)^{p}}, \\quad x_k = -1 + 2\\,\\beta_p\\!\\left(\\frac{k}{N}\\right), \\quad k = 0,1,\\dots,N,\n     $$\n     为通用加密指数 $p \\geq 1$ 实现一个对称加密网格，该网格将单元聚集在 $x=\\pm1$ 附近，以更好地解析端点奇异性。使用节点 $\\{x_k\\}$ 作为单元端点 $\\{a_j,b_j\\}$，其中 $a_j = x_{j-1}$，$b_j = x_j$。\n\n3. 误差度量与收敛率：\n   - 对于每个离散化方案，定义配置点 $x_i = \\frac{a_i + b_i}{2}$，并将数值密度 $\\sigma_i$ 与在 $x_i$ 处求值的精确奇异分布 $\\sigma^{\\star}(x) = \\frac{1}{\\sqrt{1 - x^{2}}}$进行比较。\n   - 计算离散 $L^{2}$ 误差\n     $$\n     E(N,p) = \\left(\\sum_{i=1}^{N} \\left(\\sigma_i - \\sigma^{\\star}(x_i)\\right)^{2} \\,(b_i - a_i)\\right)^{1/2}.\n     $$\n   - 对于在相同加密指数 $p$ 下具有单元数 $N_1$ 和 $N_2$ 的两个离散化方案，估计关于 $N$ 的实验收敛阶 (EOC) 为\n     $$\n     \\mathrm{EOC}(N_1,N_2,p) = \\frac{\\log\\left(\\frac{E(N_1,p)}{E(N_2,p)}\\right)}{\\log\\left(\\frac{N_2}{N_1}\\right)}.\n     $$\n\n4. 测试套件：\n   - 实现以下由 $(N_1,N_2,p)$ 定义的测试用例：\n     - $(N_1,N_2,p) = (32,64,1)$，\n     - $(N_1,N_2,p) = (32,64,2)$，\n     - $(N_1,N_2,p) = (32,64,4)$，\n     - $(N_1,N_2,p) = (16,32,8)$，\n     - $(N_1,N_2,p) = (8,16,1)$。\n   - 选择这些用例是为了覆盖均匀基线、中度加密、强度加密以及一个低 $N$ 值的边缘情况。\n\n5. 最终输出格式：\n   - 您的程序必须输出一行，其中包含上述测试用例的估计收敛率，顺序完全一致，格式为逗号分隔的 Python 风格列表。每个数字必须四舍五入到六位小数。例如，输出行应如下所示\n     $$\n     [r_1,r_2,r_3,r_4,r_5]\n     $$\n     其中 $r_i$ 是对应于五个测试用例的、经过四舍五入的 $\\mathrm{EOC}$ 值。\n\n所有数学运算都应以数值方式实现，程序必须是自包含的，无需任何外部输入即可生成单行输出。此问题不涉及物理单位或角度；所有量都是无量纲的。您的实现必须仅依赖于所描述的积分方程、离散化和网格策略，以量化加密在楔形和尖端附近对 SIE 解收敛率的影响。",
            "solution": "该问题要求实现并分析一种数值方法，以求解一个源于静电学的特定一维表面积分方程 (SIE)。目标是量化网格加密对解的收敛率的影响，尤其是在捕捉尖锐边缘附近的电荷密度奇异性行为方面。\n\n控制方程是一个关于在区间 $[-1,1]$ 上的未知表面电荷密度 $\\sigma(y)$ 的第一类弗雷德霍姆 (Fredholm) 积分方程：\n$$\n\\int_{-1}^{1} G(x,y)\\,\\sigma(y)\\,\\mathrm{d}y = g(x), \\quad x \\in (-1,1)\n$$\n在此， $G(x,y) = -\\frac{1}{2\\pi}\\log|x - y|$ 是拉普拉斯算子的二维格林函数，右侧给定为恒定电势 $g(x) = \\frac{\\log 2}{2}$。对于此特定电势，已知精确电荷密度为 $\\sigma^{\\star}(x) = \\frac{1}{\\sqrt{1 - x^{2}}}$，该函数在端点 $x = \\pm 1$ 处表现出奇异性。\n\n我们的方法是使用基于单元的配置法（也称为边界元法 (BEM) 或矩量法 (MoM)）来求解此积分方程。\n\n**1. 离散化与矩阵构建**\n\n我们将域 $[-1,1]$ 划分为 $N$ 个连续的单元或元素。设第 $j$ 个单元为区间 $[a_j, b_j]$。我们将未知电荷密度 $\\sigma(y)$ 近似为分片常数函数：\n$$\n\\sigma(y) \\approx \\sum_{j=1}^{N} \\sigma_j \\phi_j(y)\n$$\n其中 $\\sigma_j$ 是第 $j$ 个单元上电荷密度的未知常数值，$\\phi_j(y)$ 是一个基函数，当 $y \\in [a_j, b_j]$ 时为 $1$，否则为 $0$。\n\n将此近似代入积分方程中，得到：\n$$\n\\sum_{j=1}^{N} \\sigma_j \\int_{a_j}^{b_j} G(x,y)\\,\\mathrm{d}y = g(x)\n$$\n为了确定 $N$ 个未知系数 $\\{\\sigma_j\\}$，我们在 $N$ 个不同的配置点上强制执行此方程。对于分片常数基函数，一个标准的选择是使用每个单元的中点作为配置点，即 $x_i = \\frac{a_i + b_i}{2}$，$i=1, \\dots, N$。这会导出一个线性方程组 $A\\boldsymbol{\\sigma} = \\boldsymbol{g}$，其中 $\\boldsymbol{\\sigma} = [\\sigma_1, \\dots, \\sigma_N]^T$ 是未知系数向量，$\\boldsymbol{g}$ 是在配置点上求值的右侧值向量，$g_i = g(x_i) = \\frac{\\log 2}{2}$，$A$ 是 $N \\times N$ 的系统矩阵。\n\n矩阵 $A$ 的元素由格林函数在每个单元上的积分给出：\n$$\nA_{ij} = \\int_{a_j}^{b_j} G(x_i,y)\\,\\mathrm{d}y = -\\frac{1}{2\\pi}\\int_{a_j}^{b_j} \\log|x_i - y|\\,\\mathrm{d}y\n$$\n该积分可以解析求解。$\\log|c-y|$ 关于 $y$ 的不定积分是 $(y-c)\\log|y-c| - y$。在单元端点 $a_j$ 和 $b_j$ 处求值，得到：\n$$\n\\int_{a_j}^{b_j} \\log|x_i - y|\\,\\mathrm{d}y = \\left[ (y-x_i)\\log|y-x_i| - y \\right]_{y=a_j}^{y=b_j}\n$$\n$$\n= \\left( (b_j-x_i)\\log|b_j-x_i| - b_j \\right) - \\left( (a_j-x_i)\\log|a_j-x_i| - a_j \\right)\n$$\n$$\n= (b_j-x_i)\\log|b_j-x_i| - (a_j-x_i)\\log|a_j-x_i| - (b_j-a_j)\n$$\n此公式对非对角（$i \\neq j$）和对角（$i=j$）元素均有效，因为对数奇点是可积的。矩阵元素的最终表达式为：\n$$\nA_{ij} = -\\frac{1}{2\\pi} \\left( (b_j-x_i)\\log|b_j-x_i| - (a_j-x_i)\\log|a_j-x_i| - (b_j-a_j) \\right)\n$$\n\n**2. 网格生成**\n\n数值解的精度高度依赖于单元的布置。为了解析 $x = \\pm 1$ 处的奇异性，单元必须在端点附近变得更小。这通过使用加密网格来实现。\n\n我们生成一组 $N+1$ 个节点 $\\{x_k\\}_{k=0}^N$ 来定义单元的边界。第 $j$ 个单元是 $[a_j, b_j] = [x_{j-1}, x_j]$。这些节点通过从区间 $[0,1]$ 中的均匀网格 $s_k = k/N$（$k=0, \\dots, N$）到物理域 $[-1,1]$ 的一个映射来定义。加密由一个参数 $p \\geq 1$ 控制。\n加密函数为：\n$$\n\\beta_p(s) = \\frac{s^{p}}{s^{p} + (1 - s)^{p}}\n$$\n物理节点位置则为：\n$$\nx_k = -1 + 2\\,\\beta_p\\!\\left(\\frac{k}{N}\\right)\n$$\n当 $p=1$ 时，$\\beta_1(s) = s$，这会产生一个节点间距相等的均匀网格。当 $p > 1$ 时，函数 $\\beta_p(s)$ 在 $s=0$ 和 $s=1$ 附近有陡峭的斜率，这会使节点 $x_k$ 向端点 $-1$ 和 $1$ 聚集。已知选择 $p=2$ 对于 $\\frac{1}{\\sqrt{1-x^2}}$ 类型的奇异性特别有效。\n\n**3. 误差计算与收敛性分析**\n\n在组装矩阵 $A$ 和向量 $\\boldsymbol{g}$ 之后，我们求解稠密线性系统 $A\\boldsymbol{\\sigma} = \\boldsymbol{g}$ 以获得数值解系数 $\\sigma_i$。为了量化精度，我们通过将该数值解与在配置点 $x_i$ 处求值的已知精确解 $\\sigma^{\\star}(x) = \\frac{1}{\\sqrt{1-x^2}}$ 进行比较来计算误差。\n\n离散 $L^2$ 误差定义为在所有单元上的加权和：\n$$\nE(N,p) = \\left(\\sum_{i=1}^{N} \\left(\\sigma_i - \\sigma^{\\star}(x_i)\\right)^{2} \\,(b_i - a_i)\\right)^{1/2}\n$$\n其中 $(b_i-a_i)$ 是第 $i$ 个单元的长度。\n\n为了分析收敛行为，我们计算实验收敛阶 (EOC)。EOC 衡量的是随着单元数 $N$ 的增加，误差减小的速率。对于具有单元数 $N_1$ 和 $N_2$（通常 $N_2 > N_1$）的两个离散化方案，EOC 估计为：\n$$\n\\mathrm{EOC}(N_1,N_2,p) = \\frac{\\log\\left(\\frac{E(N_1,p)}{E(N_2,p)}\\right)}{\\log\\left(\\frac{N_2}{N_1}\\right)}\n$$\n更高的 EOC 表示更快的收敛速度。对于均匀网格 ($p=1$)，由于未解析的奇异性，EOC 预计会很低（理论上为 $0.5$）。适当选择的加密 ($p=2$) 应能显著提高 EOC（理论上可达 $1.5$）。过度加密 ($p>2$) 可能会降低性能，因为误差将由域中心处较大的单元主导。\n\n实现将包括用于生成网格、组装矩阵、求解系统以及为指定的测试用例计算 EOC 的函数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve as sp_solve\n\ndef create_mesh(N, p):\n    \"\"\"\n    Generates a graded mesh on [-1, 1] with N panels and grading exponent p.\n\n    Args:\n        N (int): Number of panels.\n        p (float): Grading exponent. p=1 corresponds to a uniform mesh.\n\n    Returns:\n        tuple: A tuple containing:\n            - collocation_pts (np.ndarray): Midpoints of the panels.\n            - panel_endpoints_a (np.ndarray): Start points of the panels.\n            - panel_endpoints_b (np.ndarray): End points of the panels.\n            - panel_lengths (np.ndarray): Lengths of the panels.\n    \"\"\"\n    s = np.linspace(0, 1, N + 1)\n    \n    # Grading function beta_p(s)\n    if p == 1.0:\n        beta_s = s\n    else:\n        s_p = s**p\n        one_minus_s_p = (1 - s)**p\n        # Add a small epsilon for numerical stability at s=0 and s=1, though numpy handles it.\n        # This becomes relevant if s_p and one_minus_s_p are both zero, which isn't the case here.\n        denominator = s_p + one_minus_s_p\n        beta_s = s_p / denominator\n        \n    endpoints = -1 + 2 * beta_s\n    \n    panel_endpoints_a = endpoints[:-1]\n    panel_endpoints_b = endpoints[1:]\n    \n    collocation_pts = (panel_endpoints_a + panel_endpoints_b) / 2\n    panel_lengths = panel_endpoints_b - panel_endpoints_a\n    \n    return collocation_pts, panel_endpoints_a, panel_endpoints_b, panel_lengths\n\ndef compute_error(N, p):\n    \"\"\"\n    Computes the discrete L2 error for a given discretization (N, p).\n    \"\"\"\n    collocation_pts, aj, bj, panel_lengths = create_mesh(N, p)\n    \n    # Assemble the matrix A using vectorized operations\n    xi = collocation_pts[:, np.newaxis] # Shape (N, 1)\n    aj_row = aj[np.newaxis, :]         # Shape (1, N)\n    bj_row = bj[np.newaxis, :]         # Shape (1, N)\n\n    # Use a helper for x*log|x| to handle x=0 case, though not strictly needed here\n    # as collocation points are never at panel boundaries.\n    def x_log_abs_x(x):\n        # np.log(0) is -inf, 0 * -inf is nan. We want it to be 0.\n        res = np.zeros_like(x, dtype=float)\n        mask = x != 0\n        res[mask] = x[mask] * np.log(np.abs(x[mask]))\n        return res\n        \n    term1 = x_log_abs_x(bj_row - xi)\n    term2 = x_log_abs_x(aj_row - xi)\n    \n    integral_val = term1 - term2 - (bj_row - aj_row)\n    A = -1 / (2 * np.pi) * integral_val\n\n    # Assemble the right-hand side vector g\n    g_val = np.log(2) / 2\n    g_vector = np.full(N, g_val)\n    \n    # Solve the linear system A * sigma = g\n    sigma = sp_solve(A, g_vector)\n    \n    # Compute the exact solution at collocation points\n    # 1 - x^2 can be calculated stably as (1-x)(1+x)\n    one_minus_x2 = 1 - collocation_pts**2\n    # Ensure no division by zero for points very close to +/- 1\n    one_minus_x2[one_minus_x2 = 0] = np.finfo(float).eps\n    exact_sigma = 1 / np.sqrt(one_minus_x2)\n    \n    # Compute the discrete L2 error\n    error_sq_sum = np.sum((sigma - exact_sigma)**2 * panel_lengths)\n    error = np.sqrt(error_sq_sum)\n    \n    return error\n\ndef calculate_eoc(N1, N2, p):\n    \"\"\"\n    Calculates the Experimental Order of Convergence (EOC).\n    \"\"\"\n    error1 = compute_error(N1, p)\n    error2 = compute_error(N2, p)\n    \n    eoc = np.log(error1 / error2) / np.log(N2 / N1)\n    \n    return eoc\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # test_cases are (N1, N2, p)\n    test_cases = [\n        (32, 64, 1),\n        (32, 64, 2),\n        (32, 64, 4),\n        (16, 32, 8),\n        (8, 16, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        N1, N2, p = case\n        eoc = calculate_eoc(N1, N2, p)\n        # Round to six decimal places as required.\n        results.append(round(eoc, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}