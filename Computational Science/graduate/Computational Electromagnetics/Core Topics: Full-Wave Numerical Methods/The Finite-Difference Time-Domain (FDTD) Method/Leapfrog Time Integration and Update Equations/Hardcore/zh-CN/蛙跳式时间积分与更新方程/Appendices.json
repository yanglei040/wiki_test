{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握时域有限差分（FDTD）方法，最有效的方式莫过于亲手推导其核心算法。本练习将引导你从最基本的一维横电（TE）波情形出发，在交错网格上对麦克斯韦方程组进行离散化，从而推导出著名的蛙跳格式更新方程。通过分析该数值格式的性质，我们将深入探讨其精度和数值色散现象，为理解FDTD方法的行为奠定坚实的理论基础 。",
            "id": "3323528",
            "problem": "考虑一个无源、均匀、无损的介质，其介电常数 $\\varepsilon$ 和磁导率 $\\mu$ 均为常数。在一维（1D）结构中，假设仅有的非零电磁场分量为 $E_{z}(x,t)$ 和 $H_{y}(x,t)$，它们仅随空间坐标 $x$ 和时间 $t$ 变化。从适用于此场景的麦克斯韦方程组的微分形式旋度方程出发。在交错的Yee网格（时域有限差分（FDTD）法）上，使用均匀空间步长 $\\Delta x$ 和均匀时间步长 $\\Delta t$ 对空间和时间进行离散化：在空间节点 $x_{i} = i\\,\\Delta x$ 和半时间步 $t^{n+\\frac{1}{2}} = \\left(n+\\frac{1}{2}\\right)\\Delta t$ 处对 $E_{z}$ 进行采样，在交错的空间节点 $x_{i+\\frac{1}{2}} = \\left(i+\\frac{1}{2}\\right)\\Delta x$ 和整数时间步 $t^{n} = n\\,\\Delta t$ 处对 $H_{y}$ 进行采样，其中 $i\\in\\mathbb{Z}$ 且 $n\\in\\mathbb{Z}$。\n\n任务：\n1) 基于第一性原理，使用空间和时间的中心差分以及所述的Yee网格配置，推导出 $E_{z}$ 和 $H_{y}$ 的两个标量蛙跳更新方程，并明确其精确的指数交错形式。\n\n2) 分别对 $E_{z}$ 在 $(x_{i},t^{n+\\frac{1}{2}})$ 点以及对 $H_{y}$ 在 $(x_{i+\\frac{1}{2}},t^{n}})$ 点进行关于 $\\Delta x$ 和 $\\Delta t$ 的泰勒展开，以证明你得到的离散更新方程与连续方程的形式一致性。指出主阶截断误差项及其关于 $\\Delta x$ 和 $\\Delta t$ 的阶数。\n\n3) 假设离散平面波解具有以下形式\n$$\nE_{z}(i,n+\\tfrac{1}{2}) = E_{0}\\,\\exp\\!\\Big(j\\big(i\\,k\\,\\Delta x - (n+\\tfrac{1}{2})\\,\\omega\\,\\Delta t\\big)\\Big),\\qquad\nH_{y}(i+\\tfrac{1}{2},n) = H_{0}\\,\\exp\\!\\Big(j\\big((i+\\tfrac{1}{2})\\,k\\,\\Delta x - n\\,\\omega\\,\\Delta t\\big)\\Big),\n$$\n其中波数 $k$ 和角频率 $\\omega$ 均为实数。使用你的离散更新方程推导出相应的离散色散关系，然后将其显式求解，得到角频率 $\\omega$ 作为 $k$, $\\Delta x$, $\\Delta t$, $\\varepsilon$ 和 $\\mu$ 的闭式解析函数。角度使用弧度制。\n\n提供单一的闭式表达式 $\\omega(k,\\Delta x,\\Delta t,\\varepsilon,\\mu)$ 作为你的最终答案。",
            "solution": "分析始于无源（$\\vec{J} = \\vec{0}$）、均匀、无损且具有恒定介电常数 $\\varepsilon$ 和磁导率 $\\mu$ 的介质中的麦克斯韦旋度方程：\n$$\n\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t} = -\\mu \\frac{\\partial \\vec{H}}{\\partial t} \\\\\n\\nabla \\times \\vec{H} = \\frac{\\partial \\vec{D}}{\\partial t} = \\varepsilon \\frac{\\partial \\vec{E}}{\\partial t}\n$$\n在一维（1D）结构中，场仅随空间坐标 $x$ 和时间 $t$ 变化，且唯一的非零分量是 $E_{z}(x,t)$ 和 $H_{y}(x,t)$，则矢量场为 $\\vec{E} = E_{z}(x,t)\\hat{z}$ 和 $\\vec{H} = H_{y}(x,t)\\hat{y}$。在笛卡尔坐标系中展开旋度算子可得：\n$$\n\\nabla \\times \\vec{E} = \\left(\\frac{\\partial E_z}{\\partial y} - \\frac{\\partial E_y}{\\partial z}\\right)\\hat{x} + \\left(\\frac{\\partial E_x}{\\partial z} - \\frac{\\partial E_z}{\\partial x}\\right)\\hat{y} + \\left(\\frac{\\partial E_y}{\\partial x} - \\frac{\\partial E_x}{\\partial y}\\right)\\hat{z} = -\\frac{\\partial E_{z}}{\\partial x}\\hat{y}\n$$\n$$\n\\nabla \\times \\vec{H} = \\left(\\frac{\\partial H_z}{\\partial y} - \\frac{\\partial H_y}{\\partial z}\\right)\\hat{x} + \\left(\\frac{\\partial H_x}{\\partial z} - \\frac{\\partial H_z}{\\partial x}\\right)\\hat{y} + \\left(\\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\\right)\\hat{z} = \\frac{\\partial H_{y}}{\\partial x}\\hat{z}\n$$\n将这些结果代入麦克斯韦方程组，并令各矢量分量相等，即可得到控制该系统的两个标量偏微分方程（PDE）：\n$$\n\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x} \\\\\n\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}\n$$\n\n**1) 蛙跳更新方程的推导**\n\n我们在指定的交错Yee网格上，使用中心差分法对这些偏微分方程进行离散化。电场 $E_{z}$ 在整数空间索引 $i$ 和半整数时间索引 $n+\\frac{1}{2}$ 处采样，记为 $E_{z}|_{i}^{n+\\frac{1}{2}}$。磁场 $H_{y}$ 在半整数空间索引 $i+\\frac{1}{2}$ 和整数时间索引 $n$ 处采样，记为 $H_{y}|_{i+\\frac{1}{2}}^{n}$。\n\n对于第一个偏微分方程 $\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x}$，我们在时空位置 $(x_i, t^n) = (i\\Delta x, n\\Delta t)$ 处应用中心差分。$E_z$ 的时间导数以 $t^n$ 为中心，$H_y$ 的空间导数以 $x_i$ 为中心：\n$$\n\\varepsilon \\frac{E_{z}|_{i}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n-\\frac{1}{2}}}{\\Delta t} = \\frac{H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i-\\frac{1}{2}}^{n}}{\\Delta x}\n$$\n对 $E_{z}|_{i}^{n+\\frac{1}{2}}$ 求解，得到第一个更新方程：\n$$\nE_{z}|_{i}^{n+\\frac{1}{2}} = E_{z}|_{i}^{n-\\frac{1}{2}} + \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i-\\frac{1}{2}}^{n} \\right)\n$$\n对于第二个偏微分方程 $\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}$，我们在时空位置 $(x_{i+\\frac{1}{2}}, t^{n+\\frac{1}{2}}) = ((i+\\frac{1}{2})\\Delta x, (n+\\frac{1}{2})\\Delta t)$ 处应用中心差分。$H_y$ 的时间导数以 $t^{n+\\frac{1}{2}}$ 为中心，$E_z$ 的空间导数以 $x_{i+\\frac{1}{2}}$ 为中心：\n$$\n\\mu \\frac{H_{y}|_{i+\\frac{1}{2}}^{n+1} - H_{y}|_{i+\\frac{1}{2}}^{n}}{\\Delta t} = \\frac{E_{z}|_{i+1}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n+\\frac{1}{2}}}{\\Delta x}\n$$\n对 $H_{y}|_{i+\\frac{1}{2}}^{n+1}$ 求解，得到第二个更新方程：\n$$\nH_{y}|_{i+\\frac{1}{2}}^{n+1} = H_{y}|_{i+\\frac{1}{2}}^{n} + \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_{z}|_{i+1}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n+\\frac{1}{2}} \\right)\n$$\n这两个方程构成了蛙跳时间积分格式。\n\n**2) 一致性与截断误差**\n\n为了证明形式一致性，我们对离散方程中的各项进行泰勒级数展开，并证明当 $\\Delta x \\rightarrow 0$ 和 $\\Delta t \\rightarrow 0$ 时，它们收敛到连续的偏微分方程。未被抵消的主阶项构成了截断误差。问题中关于展开点的表述，可理解为是指每个更新方程的有限差分模板的自然中心点。\n\n对于 $E_z$ 的更新方程，我们将所有项在中心点 $(x_i, t^n)$ 周围展开：\n$$\n\\varepsilon \\frac{E_{z}|_{i}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n-\\frac{1}{2}}}{\\Delta t} = \\varepsilon \\left( \\frac{\\partial E_z}{\\partial t} + \\frac{\\Delta t^2}{24} \\frac{\\partial^3 E_z}{\\partial t^3} + O(\\Delta t^4) \\right)\n$$\n$$\n\\frac{H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i-\\frac{1}{2}}^{n}}{\\Delta x} = \\left( \\frac{\\partial H_y}{\\partial x} + \\frac{\\Delta x^2}{24} \\frac{\\partial^3 H_y}{\\partial x^3} + O(\\Delta x^4) \\right)\n$$\n其中所有导数均在 $(x_i, t^n)$ 处取值。令展开式相等，可得：\n$$\n\\varepsilon \\frac{\\partial E_z}{\\partial t} - \\frac{\\partial H_y}{\\partial x} = \\frac{1}{\\varepsilon} \\left( \\frac{\\Delta x^2}{24} \\frac{\\partial^3 H_y}{\\partial x^3} \\right) - \\left( \\frac{\\varepsilon \\Delta t^2}{24} \\frac{\\partial^3 E_z}{\\partial t^3} \\right) + \\dots\n$$\n该离散方程与偏微分方程 $\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x}$ 是一致的。主阶截断误差在空间和时间上都是二阶的，即 $O(\\Delta x^2, \\Delta t^2)$。\n\n对于 $H_y$ 的更新方程，我们将其所有项在其模板中心 $(x_{i+\\frac{1}{2}}, t^{n+\\frac{1}{2}})$ 周围展开：\n$$\n\\mu \\frac{H_{y}|_{i+\\frac{1}{2}}^{n+1} - H_{y}|_{i+\\frac{1}{2}}^{n}}{\\Delta t} = \\mu \\left( \\frac{\\partial H_y}{\\partial t} + \\frac{\\Delta t^2}{24} \\frac{\\partial^3 H_y}{\\partial t^3} + O(\\Delta t^4) \\right)\n$$\n$$\n\\frac{E_{z}|_{i+1}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n+\\frac{1}{2}}}{\\Delta x} = \\left( \\frac{\\partial E_z}{\\partial x} + \\frac{\\Delta x^2}{24} \\frac{\\partial^3 E_z}{\\partial x^3} + O(\\Delta x^4) \\right)\n$$\n其中所有导数均在 $(x_{i+\\frac{1}{2}}, t^{n+\\frac{1}{2}})$ 处取值。令等式两边相等可得：\n$$\n\\mu \\frac{\\partial H_y}{\\partial t} - \\frac{\\partial E_z}{\\partial x} = \\frac{\\Delta x^2}{24} \\frac{\\partial^3 E_z}{\\partial x^3} - \\frac{\\mu \\Delta t^2}{24} \\frac{\\partial^3 H_y}{\\partial t^3} + \\dots\n$$\n这与偏微分方程 $\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}$ 是一致的。主阶截断误差同样是二阶的，即 $O(\\Delta x^2, \\Delta t^2)$。\n\n**3) 离散色散关系**\n\n我们将给定的离散平面波解代入两个更新方程。为了简化推导，我们使用 $E_z$ 的第一个更新方程和一个时间平移版本的 $H_y$ 更新方程，以对齐时间索引。\n$E_z$ 更新方程：\n$E_{z}|_{i}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n-\\frac{1}{2}} = \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i-\\frac{1}{2}}^{n} \\right)$\n代入试探解：\n$E_0 e^{j(ik\\Delta x - (n+\\frac{1}{2})\\omega\\Delta t)} - E_0 e^{j(ik\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)} = \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_0 e^{j((i+\\frac{1}{2})k\\Delta x - n\\omega\\Delta t)} - H_0 e^{j((i-\\frac{1}{2})k\\Delta x - n\\omega\\Delta t)} \\right)$\n除以公因式 $e^{j(ik\\Delta x - n\\omega\\Delta t)}$：\n$E_0(e^{-j\\omega\\Delta t/2} - e^{j\\omega\\Delta t/2}) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0 (e^{jk\\Delta x/2} - e^{-jk\\Delta x/2})$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{e^{j\\theta}-e^{-j\\theta}}{2j}$：\n$E_0(-2j\\sin(\\frac{\\omega\\Delta t}{2})) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0(2j\\sin(\\frac{k\\Delta x}{2}))$\n$-E_0 \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0 \\sin\\left(\\frac{k\\Delta x}{2}\\right)$ （式1）\n\n$H_y$ 更新方程：\n$H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i+\\frac{1}{2}}^{n-1} = \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_{z}|_{i+1}^{n-\\frac{1}{2}} - E_{z}|_{i}^{n-\\frac{1}{2}} \\right)$\n代入试探解：\n$H_0 e^{j((i+\\frac{1}{2})k\\Delta x - n\\omega\\Delta t)} - H_0 e^{j((i+\\frac{1}{2})k\\Delta x - (n-1)\\omega\\Delta t)} = \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_0 e^{j((i+1)k\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)} - E_0 e^{j(ik\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)} \\right)$\n除以公因式 $e^{j((i+\\frac{1}{2})k\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)}$：\n$H_0(e^{-j\\omega\\Delta t/2} - e^{j\\omega\\Delta t/2}) = \\frac{\\Delta t}{\\mu\\Delta x} E_0 (e^{jk\\Delta x/2} - e^{-jk\\Delta x/2})$\n$-H_0(2j\\sin(\\frac{\\omega\\Delta t}{2})) = \\frac{\\Delta t}{\\mu\\Delta x} E_0 (2j\\sin(\\frac{k\\Delta x}{2}))$\n$-H_0 \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\mu\\Delta x} E_0 \\sin\\left(\\frac{k\\Delta x}{2}\\right)$ （式2）\n\n我们得到一个关于 $E_0$ 和 $H_0$ 的齐次线性方程组：\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) E_0 + \\frac{\\Delta t}{\\varepsilon\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) H_0 = 0\n$$\n$$\n\\frac{\\Delta t}{\\mu\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) E_0 + \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) H_0 = 0\n$$\n为使方程组有非平凡解，其系数矩阵的行列式必须为零：\n$$\n\\begin{vmatrix} \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) & \\frac{\\Delta t}{\\varepsilon\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\\\ \\frac{\\Delta t}{\\mu\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) & \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\end{vmatrix} = 0\n$$\n这就得到了离散色散关系：\n$$\n\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) - \\frac{\\Delta t^2}{\\mu\\varepsilon\\Delta x^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) = 0\n$$\n我们对 $\\omega$ 求解。取正根（对应于前向传播）：\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\n$$\n分离出 $\\omega$ 即可得到最终表达式：\n$$\n\\frac{\\omega\\Delta t}{2} = \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)\n$$\n$$\n\\omega = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)}\n$$"
        },
        {
            "introduction": "一个稳定的模拟不一定是一个精确的模拟。本练习旨在解决设置任何时域模拟时的一个关键问题：如何选择一个能够精确捕捉物理现象的时间步长 $\\Delta t$。我们将探讨激励源的频谱成分与奈奎斯特采样定理之间的联系，以避免时间混叠这一数值建模中的常见陷阱，从而确保模拟的保真度 。",
            "id": "3323457",
            "problem": "在一个使用蛙跳格式（时间上的二阶中心差分）对麦克斯韦方程组进行的一维显式时域仿真中，一个点源电流密度由时间波形 $s(t)=\\exp\\!\\big[-(t-t_{0})^{2}/\\tau^{2}\\big]\\sin(\\omega_{0} t)$ 驱动，其中 $t_{0}$、$\\tau$ 和 $\\omega_{0}$ 是给定常数，且空间离散化满足 Courant–Friedrichs–Lewy 条件，与时间步长无关。您的任务是确定一个时间步长，以防止源频谱的时间混叠并解析其有效带宽。\n\n请仅从真空中的法拉第定律和安培-麦克斯韦定律以及蛙跳中心差分时间更新的定义出发，推导由中心差分算子所隐含的连续时间角频率与其离散时间表示之间的映射关系，并由此推导出对于给定的时间步长 $\\Delta t$，可以无混叠地表示的角频率上限。然后，对于给定的源 $s(t)$，将必须表示的最高角频率 $\\omega_{\\max}$ 定义为正频率高斯谱瓣的幅值下降到其在 $+\\omega_{0}$ 处峰值的预定比例 $\\varepsilon \\in (0,1)$ 时的频率。使用此定义来获得最大允许时间步长 $\\Delta t_{\\max}$ 的闭合形式表达式，该表达式在捕捉带宽直至 $\\varepsilon$ 水平的同时，避免了 $s(t)$ 的时间混叠。\n\n将您的最终结果表示为 $\\Delta t_{\\max}$ 关于 $\\omega_{0}$、$\\tau$ 和 $\\varepsilon$ 的单个符号表达式。以秒为单位表示答案。不要代入数值。",
            "solution": "该问题要求基于给定源波形的频谱特性，系统地推导蛙跳时域仿真的最大时间步长 $\\Delta t_{\\max}$。此推导过程分为几个逻辑步骤。\n\n**1. 蛙跳时间导数算子的频率映射**\n\n麦克斯韦方程组的蛙跳时间积分格式的特点是在交错的时间点上计算电场和磁场。场分量 $F(t)$ 在时间 $t=n\\Delta t$ 的时间导数，使用基于半整数时间步长值的二阶中心差分进行近似：\n$$ \\frac{\\partial F}{\\partial t}\\bigg|_{t=n\\Delta t} \\approx \\frac{F^{n+1/2} - F^{n-1/2}}{\\Delta t} $$\n其中 $F^{k} = F(k\\Delta t)$。\n\n为了理解此离散算子的频谱特性，我们考察它对单个谐波分量 $F(t) = F_{0}\\exp(i\\omega t)$ 的作用，其中 $\\omega$ 是连续时间角频率。\n在连续域中，时间导数为 $\\frac{\\partial F}{\\partial t} = i\\omega F(t)$。\n在离散域中，该算子产生：\n$$ \\frac{F_{0}\\exp\\big(i\\omega(n+1/2)\\Delta t\\big) - F_{0}\\exp\\big(i\\omega(n-1/2)\\Delta t\\big)}{\\Delta t} $$\n提出公因子 $F_{0}\\exp(i\\omega n\\Delta t) = F(n\\Delta t)$，我们得到：\n$$ F(n\\Delta t) \\frac{\\exp(i\\omega\\Delta t/2) - \\exp(-i\\omega\\Delta t/2)}{\\Delta t} = F(n\\Delta t) \\frac{2i\\sin(\\omega\\Delta t/2)}{\\Delta t} $$\n通过比较离散算子的作用（乘以 $\\frac{2i}{\\Delta t}\\sin(\\frac{\\omega\\Delta t}{2})$）与连续算子的作用（乘以 $i\\omega$），我们可以定义一个有效的离散时间角频率 $\\tilde{\\omega}$，这是离散系统中的观察者会感知到的频率：\n$$ i\\tilde{\\omega}F = i\\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right)F $$\n这就建立了从连续频率 $\\omega$ 到其离散表示 $\\tilde{\\omega}$ 的映射关系：\n$$ \\tilde{\\omega}(\\omega) = \\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n此表达式是蛙跳时间步进格式的数值色散关系。\n\n**2. 奈奎斯特准则与时间混叠**\n\n函数 $\\tilde{\\omega}(\\omega)$ 并非对所有 $\\omega$ 都唯一可逆。正弦函数在其主值范围 $[-\\pi/2, \\pi/2]$ 之外是周期性且非单调的。为避免混叠（即不同的连续频率映射到相同的离散频率），正弦函数的自变量必须被限制在该区间内。\n$$ \\left|\\frac{\\omega \\Delta t}{2}\\right| \\le \\frac{\\pi}{2} \\implies |\\omega| \\le \\frac{\\pi}{\\Delta t} $$\n可以被无歧义地表示的最高角频率是奈奎斯特频率，$\\omega_{\\text{Nyquist}} = \\pi/\\Delta t$。源信号中任何高于此值的频率成分都会发生混叠（被错误地表示为较低的频率），从而导致仿真错误。因此，为了进行精确的仿真，必须选择时间步长 $\\Delta t$，使得源频谱中的所有重要频率 $\\omega$ 都满足 $\\omega \\le \\pi/\\Delta t$。\n\n**3. 源信号的频谱**\n\n源的时间波形为 $s(t)=\\exp\\!\\big[-(t-t_{0})^{2}/\\tau^{2}\\big]\\sin(\\omega_{0} t)$。我们必须求出其频谱 $S(\\omega) = \\mathcal{F}\\{s(t)\\}$，以确定其带宽。使用欧拉公式 $\\sin(\\omega_{0}t) = (e^{i\\omega_{0}t} - e^{-i\\omega_{0}t})/(2i)$，我们可以写出：\n$$ s(t) = \\frac{1}{2i} \\left( \\exp\\left(-\\frac{(t-t_0)^2}{\\tau^2}\\right)e^{i\\omega_0 t} - \\exp\\left(-\\frac{(t-t_0)^2}{\\tau^2}\\right)e^{-i\\omega_0 t} \\right) $$\n时移高斯函数 $g(t-t_0)=\\exp(-(t-t_0)^2/\\tau^2)$ 的傅里叶变换是 $G(\\omega) = \\tau\\sqrt{\\pi} \\exp(-i\\omega t_0) \\exp(-\\tau^2\\omega^2/4)$。利用傅里叶变换的频移特性 $\\mathcal{F}\\{f(t)e^{i\\omega_0 t}\\} = F(\\omega-\\omega_0)$，$s(t)$ 的变换为：\n$$ S(\\omega) = \\frac{1}{2i} \\left[ G(\\omega-\\omega_0) - G(\\omega+\\omega_0) \\right] $$\n该频谱由两个谱瓣组成，它们是 $G(\\omega)$ 的缩放版本，中心分别位于 $\\omega = +\\omega_0$ 和 $\\omega = -\\omega_0$。正频率谱瓣的幅值由 $G(\\omega-\\omega_0)$ 的幅值决定：\n$$ |G(\\omega-\\omega_0)| = \\tau\\sqrt{\\pi} \\exp\\left(-\\frac{\\tau^2(\\omega-\\omega_0)^2}{4}\\right) $$\n该谱瓣呈高斯形状，中心在 $\\omega=\\omega_0$。\n\n**4. 确定有效最高频率 $\\omega_{\\max}$**\n\n问题将 $\\omega_{\\max}$ 定义为正频率谱瓣的幅值下降到其峰值的一小部分 $\\varepsilon$ 时的频率。该谱瓣的峰值出现在 $\\omega = \\omega_0$ 处，此时指数项为 $\\exp(0)=1$。因此，峰值幅值为 $M_{\\text{peak}} = |G(0)| = \\tau\\sqrt{\\pi}$。\n我们必须找到 $\\omega_{\\max}$，使得 $|G(\\omega_{\\max}-\\omega_0)| = \\varepsilon M_{\\text{peak}}$。\n$$ \\tau\\sqrt{\\pi} \\exp\\left(-\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4}\\right) = \\varepsilon \\left(\\tau\\sqrt{\\pi}\\right) $$\n$$ \\exp\\left(-\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4}\\right) = \\varepsilon $$\n对两边取自然对数：\n$$ -\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4} = \\ln(\\varepsilon) $$\n由于 $\\varepsilon \\in (0,1)$，$\\ln(\\varepsilon)$ 为负。我们可以写作 $\\ln(\\varepsilon) = -\\ln(1/\\varepsilon)$。\n$$ \\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4} = \\ln\\left(\\frac{1}{\\varepsilon}\\right) $$\n求解 $(\\omega_{\\max}-\\omega_0)$：\n$$ (\\omega_{\\max}-\\omega_0)^2 = \\frac{4}{\\tau^2}\\ln\\left(\\frac{1}{\\varepsilon}\\right) $$\n$$ \\omega_{\\max}-\\omega_0 = \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} $$\n我们取正根，因为我们关心的是定义带宽上边缘的频率 $\\omega_{\\max} > \\omega_0$。\n$$ \\omega_{\\max} = \\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} $$\n\n**5. 推导最大允许时间步长 $\\Delta t_{\\max}$**\n\n为防止源频谱混叠，其有效最高频率 $\\omega_{\\max}$ 必须小于或等于奈奎斯特频率 $\\omega_{\\text{Nyquist}}$。最大允许时间步长 $\\Delta t_{\\max}$ 对应于此条件变为等式的情况：\n$$ \\omega_{\\max} = \\frac{\\pi}{\\Delta t_{\\max}} $$\n代入我们关于 $\\omega_{\\max}$ 的表达式：\n$$ \\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} = \\frac{\\pi}{\\Delta t_{\\max}} $$\n最后，求解 $\\Delta t_{\\max}$ 得到所需的闭合形式表达式：\n$$ \\Delta t_{\\max} = \\frac{\\pi}{\\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)}} $$\n这是确保源的频谱内容直到 $\\varepsilon$-带宽点能被蛙跳格式无混叠地表示的最大时间步长。如果右侧所有参数都以国际单位制基本单位给出（$\\omega_0$ 的单位为 rad/s，$\\tau$ 的单位为 s），得到的 $\\Delta t_{\\max}$ 单位将是秒。",
            "answer": "$$\n\\boxed{\\frac{\\pi}{\\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)}}}\n$$"
        }
    ]
}