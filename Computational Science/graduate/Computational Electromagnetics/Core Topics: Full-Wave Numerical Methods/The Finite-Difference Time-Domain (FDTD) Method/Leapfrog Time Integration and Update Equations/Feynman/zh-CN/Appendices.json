{
    "hands_on_practices": [
        {
            "introduction": "理论学习的最佳方式莫过于亲手实践。我们从一个基础但至关重要的一维横电（TE）波问题开始，它将引导我们从麦克斯韦方程组的第一性原理出发，推导出时域有限差分（FDTD）方法的核心——蛙跳（leapfrog）更新方程。通过这个练习，你不仅将掌握在交错网格上进行空间和时间离散化的技巧，还将通过分析其数值色散关系，深刻理解离散化如何引入数值误差，从而影响波在计算网格中的传播速度。这是理解和评估任何FDTD仿真精度的基石。",
            "id": "3323528",
            "problem": "考虑一个无源、均匀、无损耗的介质，其介电常数 $\\varepsilon$ 和磁导率 $\\mu$ 为常数。在一维 ($1$D) 配置中，假设唯一的非零电磁场分量是 $E_{z}(x,t)$ 和 $H_{y}(x,t)$，它们仅沿 $x$ 方向有空间变化，并随时间 $t$ 变化。从适用于此情形的麦克斯韦方程组的微分形式旋度方程出发。在交错的 Yee 网格（时域有限差分 (FDTD) 方案）上，使用均匀空间步长 $\\Delta x$ 和均匀时间步长 $\\Delta t$ 对空间和时间进行离散化：在空间节点 $x_{i} = i\\,\\Delta x$ 和半时间步 $t^{n+\\frac{1}{2}} = \\left(n+\\frac{1}{2}\\right)\\Delta t$ 处采样 $E_z$，在交错的空间节点 $x_{i+\\frac{1}{2}} = \\left(i+\\frac{1}{2}\\right)\\Delta x$ 和整数时间步 $t^{n} = n\\,\\Delta t$ 处采样 $H_y$，其中 $i\\in\\mathbb{Z}$ 且 $n\\in\\mathbb{Z}$。\n\n任务：\n1) 使用空间和时间上的中心差分以及所述的 Yee 网格配置，从第一性原理出发，推导出 $E_z$ 和 $H_y$ 的两个标量蛙跳式更新方程，并明确其精确的索引交错。\n\n2) 分别对 $E_z$ 在 $(x_{i},t^{n+\\frac{1}{2}})$ 处和对 $H_y$ 在 $(x_{i+\\frac{1}{2}},t^{n}})$ 处进行关于 $\\Delta x$ 和 $\\Delta t$ 的泰勒展开，以证明你的离散更新方程与连续方程的形式一致性。确定主阶截断误差项及其关于 $\\Delta x$ 和 $\\Delta t$ 的阶数。\n\n3) 假设离散平面波解的形式为\n$$\nE_{z}(i,n+\\tfrac{1}{2}) = E_{0}\\,\\exp\\!\\Big(j\\big(i\\,k\\,\\Delta x - (n+\\tfrac{1}{2})\\,\\omega\\,\\Delta t\\big)\\Big),\\qquad\nH_{y}(i+\\tfrac{1}{2},n) = H_{0}\\,\\exp\\!\\Big(j\\big((i+\\tfrac{1}{2})\\,k\\,\\Delta x - n\\,\\omega\\,\\Delta t\\big)\\Big),\n$$\n其中波数 $k$ 和角频率 $\\omega$ 为实数。使用你的离散更新方程推导相应的离散色散关系，然后将其显式求解，得到角频率 $\\omega$ 作为 $k$、$\\Delta x$、$\\Delta t$、$\\varepsilon$ 和 $\\mu$ 的闭式解析函数。角度使用弧度单位。\n\n作为最终答案，提供单个闭式表达式 $\\omega(k,\\Delta x,\\Delta t,\\varepsilon,\\mu)$。",
            "solution": "分析始于无源（$\\vec{J} = \\vec{0}$）、均匀、无损耗且具有恒定介电常数 $\\varepsilon$ 和磁导率 $\\mu$ 的介质中的麦克斯韦旋度方程：\n$$\n\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t} = -\\mu \\frac{\\partial \\vec{H}}{\\partial t} \\\\\n\\nabla \\times \\vec{H} = \\frac{\\partial \\vec{D}}{\\partial t} = \\varepsilon \\frac{\\partial \\vec{E}}{\\partial t}\n$$\n在一维 ($1$D) 配置中，场仅随空间坐标 $x$ 和时间 $t$ 变化，且唯一的非零分量是 $E_{z}(x,t)$ 和 $H_{y}(x,t)$，矢量场为 $\\vec{E} = E_{z}(x,t)\\hat{z}$ 和 $\\vec{H} = H_{y}(x,t)\\hat{y}$。在笛卡尔坐标系中展开旋度算子得到：\n$$\n\\nabla \\times \\vec{E} = \\left(\\frac{\\partial E_z}{\\partial y} - \\frac{\\partial E_y}{\\partial z}\\right)\\hat{x} + \\left(\\frac{\\partial E_x}{\\partial z} - \\frac{\\partial E_z}{\\partial x}\\right)\\hat{y} + \\left(\\frac{\\partial E_y}{\\partial x} - \\frac{\\partial E_x}{\\partial y}\\right)\\hat{z} = -\\frac{\\partial E_{z}}{\\partial x}\\hat{y}\n$$\n$$\n\\nabla \\times \\vec{H} = \\left(\\frac{\\partial H_z}{\\partial y} - \\frac{\\partial H_y}{\\partial z}\\right)\\hat{x} + \\left(\\frac{\\partial H_x}{\\partial z} - \\frac{\\partial H_z}{\\partial x}\\right)\\hat{y} + \\left(\\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\\right)\\hat{z} = \\frac{\\partial H_{y}}{\\partial x}\\hat{z}\n$$\n将这些结果代入麦克斯韦方程组，并令矢量分量相等，得到控制该系统的两个标量偏微分方程 (PDE)：\n$$\n\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x} \\\\\n\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}\n$$\n\n**1) 蛙跳式更新方程的推导**\n\n我们在指定的交错 Yee 网格上使用中心差分法来离散化这些偏微分方程。电场 $E_{z}$ 在整数空间索引 $i$ 和半整数时间索引 $n+\\frac{1}{2}$ 处采样，记为 $E_{z}|_{i}^{n+\\frac{1}{2}}$。磁场 $H_{y}$ 在半整数空间索引 $i+\\frac{1}{2}$ 和整数时间索引 $n$ 处采样，记为 $H_{y}|_{i+\\frac{1}{2}}^{n}$。\n\n对于第一个 PDE，$\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x}$，我们在时空位置 $(x_i, t^n) = (i\\Delta x, n\\Delta t)$ 处应用中心有限差分。$E_z$ 的时间导数以 $t^n$ 为中心，$H_y$ 的空间导数以 $x_i$ 为中心：\n$$\n\\varepsilon \\frac{E_{z}|_{i}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n-\\frac{1}{2}}}{\\Delta t} = \\frac{H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i-\\frac{1}{2}}^{n}}{\\Delta x}\n$$\n求解 $E_{z}|_{i}^{n+\\frac{1}{2}}$ 得到第一个更新方程：\n$$\nE_{z}|_{i}^{n+\\frac{1}{2}} = E_{z}|_{i}^{n-\\frac{1}{2}} + \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i-\\frac{1}{2}}^{n} \\right)\n$$\n对于第二个 PDE，$\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}$，我们在时空位置 $(x_{i+\\frac{1}{2}}, t^{n+\\frac{1}{2}}) = ((i+\\frac{1}{2})\\Delta x, (n+\\frac{1}{2})\\Delta t)$ 处应用中心有限差分。$H_y$ 的时间导数以 $t^{n+\\frac{1}{2}}$ 为中心，$E_z$ 的空间导数以 $x_{i+\\frac{1}{2}}$ 为中心：\n$$\n\\mu \\frac{H_{y}|_{i+\\frac{1}{2}}^{n+1} - H_{y}|_{i+\\frac{1}{2}}^{n}}{\\Delta t} = \\frac{E_{z}|_{i+1}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n+\\frac{1}{2}}}{\\Delta x}\n$$\n求解 $H_{y}|_{i+\\frac{1}{2}}^{n+1}$ 得到第二个更新方程：\n$$\nH_{y}|_{i+\\frac{1}{2}}^{n+1} = H_{y}|_{i+\\frac{1}{2}}^{n} + \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_{z}|_{i+1}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n+\\frac{1}{2}} \\right)\n$$\n这两个方程构成了蛙跳式时间积分方案。\n\n**2) 一致性与截断误差**\n\n为了证明形式一致性，我们对离散方程中的各项进行泰勒级数展开，并证明当 $\\Delta x \\rightarrow 0$ 和 $\\Delta t \\rightarrow 0$ 时，它们收敛于连续的偏微分方程。未被抵消的主阶项构成了截断误差。问题中关于展开点的措辞被解释为指代每个更新方程的有限差分模板的自然中心。\n\n对于 $E_z$ 更新方程，我们在中心点 $(x_i, t^n)$ 周围展开所有项：\n$$\n\\varepsilon \\frac{E_{z}|_{i}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n-\\frac{1}{2}}}{\\Delta t} = \\varepsilon \\left( \\frac{\\partial E_z}{\\partial t} + \\frac{\\Delta t^2}{24} \\frac{\\partial^3 E_z}{\\partial t^3} + O(\\Delta t^4) \\right)\n$$\n$$\n\\frac{H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i-\\frac{1}{2}}^{n}}{\\Delta x} = \\left( \\frac{\\partial H_y}{\\partial x} + \\frac{\\Delta x^2}{24} \\frac{\\partial^3 H_y}{\\partial x^3} + O(\\Delta x^4) \\right)\n$$\n其中所有导数均在 $(x_i, t^n)$ 处求值。令展开式相等得到：\n$$\n\\varepsilon \\frac{\\partial E_z}{\\partial t} - \\frac{\\partial H_y}{\\partial x} = \\frac{1}{\\varepsilon} \\left( \\frac{\\Delta x^2}{24} \\frac{\\partial^3 H_y}{\\partial x^3} \\right) - \\left( \\frac{\\varepsilon \\Delta t^2}{24} \\frac{\\partial^3 E_z}{\\partial t^3} \\right) + \\dots\n$$\n该离散方程与 PDE $\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x}$ 是一致的。主阶截断误差在空间和时间上均为二阶，即 $O(\\Delta x^2, \\Delta t^2)$。\n\n对于 $H_y$ 更新方程，我们在其模板中心 $(x_{i+\\frac{1}{2}}, t^{n+\\frac{1}{2}})$ 周围展开所有项：\n$$\n\\mu \\frac{H_{y}|_{i+\\frac{1}{2}}^{n+1} - H_{y}|_{i+\\frac{1}{2}}^{n}}{\\Delta t} = \\mu \\left( \\frac{\\partial H_y}{\\partial t} + \\frac{\\Delta t^2}{24} \\frac{\\partial^3 H_y}{\\partial t^3} + O(\\Delta t^4) \\right)\n$$\n$$\n\\frac{E_{z}|_{i+1}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n+\\frac{1}{2}}}{\\Delta x} = \\left( \\frac{\\partial E_z}{\\partial x} + \\frac{\\Delta x^2}{24} \\frac{\\partial^3 E_z}{\\partial x^3} + O(\\Delta x^4) \\right)\n$$\n其中所有导数均在 $(x_{i+\\frac{1}{2}}, t^{n+\\frac{1}{2}})$ 处求值。令其相等得到：\n$$\n\\mu \\frac{\\partial H_y}{\\partial t} - \\frac{\\partial E_z}{\\partial x} = \\frac{\\Delta x^2}{24} \\frac{\\partial^3 E_z}{\\partial x^3} - \\frac{\\mu \\Delta t^2}{24} \\frac{\\partial^3 H_y}{\\partial t^3} + \\dots\n$$\n这与 PDE $\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}$ 是一致的。主阶截断误差也是二阶的，即 $O(\\Delta x^2, \\Delta t^2)$。\n\n**3) 离散色散关系**\n\n我们将给定的离散平面波解代入两个更新方程。为了简化推导，我们使用 $E_z$ 的第一个更新方程和 $H_y$ 更新方程的时间平移版本来对齐时间索引。\n$E_z$ 更新方程：\n$E_{z}|_{i}^{n+\\frac{1}{2}} - E_{z}|_{i}^{n-\\frac{1}{2}} = \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i-\\frac{1}{2}}^{n} \\right)$\n代入试探解：\n$E_0 e^{j(ik\\Delta x - (n+\\frac{1}{2})\\omega\\Delta t)} - E_0 e^{j(ik\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)} = \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_0 e^{j((i+\\frac{1}{2})k\\Delta x - n\\omega\\Delta t)} - H_0 e^{j((i-\\frac{1}{2})k\\Delta x - n\\omega\\Delta t)} \\right)$\n除以公共因子 $e^{j(ik\\Delta x - n\\omega\\Delta t)}$：\n$E_0(e^{-j\\omega\\Delta t/2} - e^{j\\omega\\Delta t/2}) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0 (e^{jk\\Delta x/2} - e^{-jk\\Delta x/2})$\n使用欧拉公式 $\\sin(\\theta) = \\frac{e^{j\\theta}-e^{-j\\theta}}{2j}$：\n$E_0(-2j\\sin(\\frac{\\omega\\Delta t}{2})) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0(2j\\sin(\\frac{k\\Delta x}{2}))$\n$-E_0 \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0 \\sin\\left(\\frac{k\\Delta x}{2}\\right)$ (方程 1)\n\n$H_y$ 更新方程：\n$H_{y}|_{i+\\frac{1}{2}}^{n} - H_{y}|_{i+\\frac{1}{2}}^{n-1} = \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_{z}|_{i+1}^{n-\\frac{1}{2}} - E_{z}|_{i}^{n-\\frac{1}{2}} \\right)$\n代入试探解：\n$H_0 e^{j((i+\\frac{1}{2})k\\Delta x - n\\omega\\Delta t)} - H_0 e^{j((i+\\frac{1}{2})k\\Delta x - (n-1)\\omega\\Delta t)} = \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_0 e^{j((i+1)k\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)} - E_0 e^{j(ik\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)} \\right)$\n除以公共因子 $e^{j((i+\\frac{1}{2})k\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)}$：\n$H_0(e^{-j\\omega\\Delta t/2} - e^{j\\omega\\Delta t/2}) = \\frac{\\Delta t}{\\mu\\Delta x} E_0 (e^{jk\\Delta x/2} - e^{-jk\\Delta x/2})$\n$-H_0(2j\\sin(\\frac{\\omega\\Delta t}{2})) = \\frac{\\Delta t}{\\mu\\Delta x} E_0 (2j\\sin(\\frac{k\\Delta x}{2}))$\n$-H_0 \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\mu\\Delta x} E_0 \\sin\\left(\\frac{k\\Delta x}{2}\\right)$ (方程 2)\n\n我们得到了一个关于 $E_0$ 和 $H_0$ 的齐次线性方程组：\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) E_0 + \\frac{\\Delta t}{\\varepsilon\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) H_0 = 0\n$$\n$$\n\\frac{\\Delta t}{\\mu\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) E_0 + \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) H_0 = 0\n$$\n为了得到非平凡解，系数矩阵的行列式必须为零：\n$$\n\\begin{vmatrix} \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) & \\frac{\\Delta t}{\\varepsilon\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\\\ \\frac{\\Delta t}{\\mu\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) & \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\end{vmatrix} = 0\n$$\n这就给出了离散色散关系：\n$$\n\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) - \\frac{\\Delta t^2}{\\mu\\varepsilon\\Delta x^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) = 0\n$$\n我们求解 $\\omega$。取正根（对应于前向传播）：\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\n$$\n分离出 $\\omega$ 得到最终表达式：\n$$\n\\frac{\\omega\\Delta t}{2} = \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)\n$$\n$$\n\\omega = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)}\n$$"
        },
        {
            "introduction": "真实世界中的电磁环境很少是无损的，因此，将材料损耗纳入我们的模型至关重要。这个实践练习探讨了如何在蛙跳FDTD格式中考虑欧姆传导（Ohmic conduction），即由电导率 $\\sigma$ 引起的损耗。你将学习使用一种半隐式方法（Crank-Nicolson格式）来处理传导电流项，这种方法在处理高导电率材料时能够保持数值稳定性。完成这个推导，你将能够修改标准的FDTD更新方程，使其适用于更广泛、更现实的有损媒质仿真。",
            "id": "3323462",
            "problem": "考虑一个介电常数为 $\\epsilon$、电导率为 $\\sigma$ 的均匀、各向同性、线性、时不变介质，并假设没有外加源。令 $\\mathbf{E}(\\mathbf{r},t)$ 和 $\\mathbf{H}(\\mathbf{r},t)$ 分别表示电场和磁场。从安培-麦克斯韦定律开始，\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t},\n$$\n其中 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 且欧姆传导为 $\\mathbf{J} = \\sigma \\mathbf{E}$。考虑在时域有限差分（FDTD; Finite-Difference Time-Domain）方法中使用的标准时间交错蛙跳格式离散化，其中 $\\mathbf{E}$ 定义在整数时间索引 $t^{n} = n \\Delta t$ 处，而 $\\mathbf{H}$ 定义在半时间索引 $t^{n+\\tfrac{1}{2}} = \\left(n+\\tfrac{1}{2}\\right)\\Delta t$ 处。令 $\\nabla_{h} \\times$ 表示在相应的交错 Yee 网格上计算的空间有限差分旋度算子。\n\n你需要通过以下方式，构建从 $t^{n}$ 到 $t^{n+1}$ 一个时间步内的离散电场更新：\n- 使用在 $t^{n+\\tfrac{1}{2}}$ 处的中点（蛙跳）求值来近似旋度项的时间积分，即假设 $\\int_{t^{n}}^{t^{n+1}} \\nabla \\times \\mathbf{H}\\, dt \\approx \\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)$。\n- 在区间 $[t^{n}, t^{n+1}]$ 上使用梯形（Crank–Nicolson）法则处理传导电流 $\\mathbf{J} = \\sigma \\mathbf{E}$，即近似为 $\\int_{t^{n}}^{t^{n+1}} \\mathbf{J}\\, dt \\approx \\tfrac{\\Delta t}{2}\\sigma\\left(\\mathbf{E}^{n+1} + \\mathbf{E}^{n}\\right)$。\n- 使用基本关系 $\\int_{t^{n}}^{t^{n+1}} \\frac{\\partial \\mathbf{D}}{\\partial t}\\, dt = \\mathbf{D}^{n+1} - \\mathbf{D}^{n} = \\epsilon\\left(\\mathbf{E}^{n+1} - \\mathbf{E}^{n}\\right)$。\n\n根据第一性原理和这些离散化方法，推导有效的蛙跳电场更新，其形式为\n$$\n\\mathbf{E}^{n+1} = \\alpha\\, \\mathbf{E}^{n} + \\beta\\, \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right),\n$$\n并提供标量 $\\alpha$ 和 $\\beta$ 的闭式解析表达式，这些表达式仅用 $\\sigma$、$\\epsilon$ 和 $\\Delta t$ 表示。你的最终答案必须是使用 LaTeX 的 $pmatrix$ 环境写成的单行矩阵形式的 $\\alpha$ 和 $\\beta$ 的表达式。不需要进行数值计算。如果你选择简化表达式，请进行精确简化；不允许进行任何取整。",
            "solution": "电场更新方程的推导始于无源区的安培-麦克斯韦定律的点形式：\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\n在均匀、各向同性、线性、时不变介质中，本构关系由 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 给出，欧姆定律为 $\\mathbf{J} = \\sigma \\mathbf{E}$，其中 $\\epsilon$ 是介电常数，$\\sigma$ 是电导率。将这些关系代入安培-麦克斯韦定律，得到：\n$$\n\\nabla \\times \\mathbf{H} = \\sigma \\mathbf{E} + \\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}\n$$\n目标是根据先前时间步的场，找到在时间 $t^{n+1} = (n+1)\\Delta t$ 的电场 $\\mathbf{E}^{n+1}$ 的更新方程。这是通过将方程在一个时间步从 $t^{n} = n\\Delta t$ 到 $t^{n+1}$ 上积分来实现的：\n$$\n\\int_{t^{n}}^{t^{n+1}} (\\nabla \\times \\mathbf{H}) \\, dt = \\int_{t^{n}}^{t^{n+1}} (\\sigma \\mathbf{E}) \\, dt + \\int_{t^{n}}^{t^{n+1}} \\left(\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}\\right) \\, dt\n$$\n我们现在将问题陈述中指定的离散近似应用于这个积分方程的每一项。\n\n对于第一项，即磁场旋度的积分，我们使用中点法则。磁场 $\\mathbf{H}$ 在半时间步 $t^{n+\\tfrac{1}{2}}$ 处求值，空间旋度算子 $\\nabla \\times$ 被其离散对应项 $\\nabla_{h} \\times$ 替换：\n$$\n\\int_{t^{n}}^{t^{n+1}} (\\nabla \\times \\mathbf{H}) \\, dt \\approx \\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)\n$$\n\n对于第二项，即传导电流密度 $\\mathbf{J} = \\sigma \\mathbf{E}$ 的积分，我们应用梯形（Crank–Nicolson）法则。该法则通过对区间 $[t^{n}, t^{n+1}]$ 起点和终点的被积函数取平均值来近似积分：\n$$\n\\int_{t^{n}}^{t^{n+1}} (\\sigma \\mathbf{E}) \\, dt \\approx \\sigma \\frac{\\Delta t}{2} \\left(\\mathbf{E}^{n+1} + \\mathbf{E}^{n}\\right)\n$$\n\n对于第三项，即位移电流密度的积分，我们使用微积分基本定理，这是精确的：\n$$\n\\int_{t^{n}}^{t^{n+1}} \\left(\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}\\right) \\, dt = \\epsilon \\int_{t^{n}}^{t^{n+1}} \\frac{\\partial \\mathbf{E}}{\\partial t} \\, dt = \\epsilon \\left(\\mathbf{E}^{n+1} - \\mathbf{E}^{n}\\right)\n$$\n将这三个离散近似代回到积分后的安培-麦克斯韦方程中，得到完全离散化的形式：\n$$\n\\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right) = \\sigma \\frac{\\Delta t}{2} \\left(\\mathbf{E}^{n+1} + \\mathbf{E}^{n}\\right) + \\epsilon \\left(\\mathbf{E}^{n+1} - \\mathbf{E}^{n}\\right)\n$$\n我们的目标是求解该方程以得到 $\\mathbf{E}^{n+1}$。我们首先展开右侧的各项：\n$$\n\\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right) = \\frac{\\sigma\\Delta t}{2} \\mathbf{E}^{n+1} + \\frac{\\sigma\\Delta t}{2} \\mathbf{E}^{n} + \\epsilon \\mathbf{E}^{n+1} - \\epsilon \\mathbf{E}^{n}\n$$\n接下来，我们将包含 $\\mathbf{E}^{n+1}$ 的项归到方程的一侧，所有其他项归到另一侧。\n$$\n\\left(\\epsilon + \\frac{\\sigma\\Delta t}{2}\\right) \\mathbf{E}^{n+1} = \\left(\\epsilon - \\frac{\\sigma\\Delta t}{2}\\right) \\mathbf{E}^{n} + \\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)\n$$\n最后，我们通过除以系数 $\\left(\\epsilon + \\frac{\\sigma\\Delta t}{2}\\right)$ 来求解 $\\mathbf{E}^{n+1}$：\n$$\n\\mathbf{E}^{n+1} = \\frac{\\epsilon - \\frac{\\sigma\\Delta t}{2}}{\\epsilon + \\frac{\\sigma\\Delta t}{2}} \\mathbf{E}^{n} + \\frac{\\Delta t}{\\epsilon + \\frac{\\sigma\\Delta t}{2}} \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)\n$$\n为了简化系数并消除分子和分母中的分数，我们可以将每个系数的分子和分母都乘以 $2$：\n$$\n\\mathbf{E}^{n+1} = \\frac{2\\epsilon - \\sigma\\Delta t}{2\\epsilon + \\sigma\\Delta t} \\mathbf{E}^{n} + \\frac{2\\Delta t}{2\\epsilon + \\sigma\\Delta t} \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)\n$$\n将此结果与目标形式 $\\mathbf{E}^{n+1} = \\alpha\\, \\mathbf{E}^{n} + \\beta\\, \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)$ 进行比较，我们可以确定标量系数 $\\alpha$ 和 $\\beta$ 的表达式：\n$$\n\\alpha = \\frac{2\\epsilon - \\sigma\\Delta t}{2\\epsilon + \\sigma\\Delta t}\n$$\n$$\n\\beta = \\frac{2\\Delta t}{2\\epsilon + \\sigma\\Delta t}\n$$\n这些表达式完全由给定的物理常数 $\\epsilon$、$\\sigma$ 和时间步长 $\\Delta t$ 表示，符合要求。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\epsilon - \\sigma\\Delta t}{2\\epsilon + \\sigma\\Delta t} & \\frac{2\\Delta t}{2\\epsilon + \\sigma\\Delta t} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在进行时域仿真时，时间步长的选择不仅关系到算法的稳定性（由CFL条件决定），还直接影响到仿真的精度。这个练习将数值方法与数字信号处理理论联系起来，要求你为一个高斯调制的正弦源信号确定合适的采样时间步长。通过对源信号进行频谱分析并应用奈奎斯特采样定理，你将学会如何根据信号的带宽来设定时间步长，以避免时间混叠并确保仿真结果能够精确地再现源信号的动态特性。这项技能对于设置任何实际的、高保真度的时域电磁仿真是不可或缺的。",
            "id": "3323457",
            "problem": "在使用蛙跳格式（时间上的二阶中心差分）对麦克斯韦方程组进行一维显式时域模拟时，一个点源电流密度由时间波形 $s(t)=\\exp\\!\\big[-(t-t_{0})^{2}/\\tau^{2}\\big]\\sin(\\omega_{0} t)$ 驱动，其中 $t_{0}$、$\\tau$ 和 $\\omega_{0}$ 是给定的常数，且空间离散化满足 Courant–Friedrichs–Lewy 条件，与时间步长无关。您的任务是确定一个时间步长，以防止源频谱的时间混叠，并能解析其有效带宽。\n\n仅从真空中的法拉第定律和安培-麦克斯韦定律以及蛙跳中心差分时间更新的定义出发，推导由中心差分算子所蕴含的连续时间角频率与其离散时间表示之间的映射关系，并由此推断出在给定时间步长 $\\Delta t$ 下可以无混叠地表示的角频率上限。然后，对于给定的源 $s(t)$，将必须表示的最高角频率 $\\omega_{\\max}$ 定义为正频率高斯谱瓣的幅度下降到其在 $+\\omega_0$ 处峰值的预定分数 $\\varepsilon \\in (0,1)$ 时的频率。利用此定义，获得最大允许时间步长 $\\Delta t_{\\max}$ 的闭式表达式，该表达式在避免 $s(t)$ 时间混叠的同时，能够捕捉其带宽直至 $\\varepsilon$ 水平。\n\n将您的最终结果表示为 $\\Delta t_{\\max}$ 关于 $\\omega_0$、$\\tau$ 和 $\\varepsilon$ 的单个符号表达式。答案以秒为单位表示。不要代入数值。",
            "solution": "该问题的解答需要分步进行：首先分析蛙跳格式的频率特性，然后计算源信号的频谱带宽，最后结合奈奎斯特采样定理确定最大时间步长。\n\n**1. 蛙跳时间导数算子的频率映射**\n\n麦克斯韦方程组的蛙跳时间积分格式的特点是在交错的时间点上计算电场和磁场。场分量 $F(t)$ 在时间 $t=n\\Delta t$ 的时间导数，使用基于半整数时间步长值的二阶中心差分进行近似：\n$$ \\frac{\\partial F}{\\partial t}\\bigg|_{t=n\\Delta t} \\approx \\frac{F^{n+1/2} - F^{n-1/2}}{\\Delta t} $$\n其中 $F^{k} = F(k\\Delta t)$。\n\n为了理解这个离散算子的谱特性，我们研究它对单个谐波分量 $F(t) = F_{0}\\exp(i\\omega t)$ 的作用，其中 $\\omega$ 是连续时间角频率。\n在连续域中，时间导数为 $\\frac{\\partial F}{\\partial t} = i\\omega F(t)$。\n在离散域中，该算子产生：\n$$ \\frac{F_{0}\\exp\\big(i\\omega(n+1/2)\\Delta t\\big) - F_{0}\\exp\\big(i\\omega(n-1/2)\\Delta t\\big)}{\\Delta t} $$\n提出因子 $F_{0}\\exp(i\\omega n\\Delta t) = F(n\\Delta t)$，我们得到：\n$$ F(n\\Delta t) \\frac{\\exp(i\\omega\\Delta t/2) - \\exp(-i\\omega\\Delta t/2)}{\\Delta t} = F(n\\Delta t) \\frac{2i\\sin(\\omega\\Delta t/2)}{\\Delta t} $$\n通过比较离散算子的作用（乘以 $\\frac{2i}{\\Delta t}\\sin(\\frac{\\omega\\Delta t}{2})$）与连续算子的作用（乘以 $i\\omega$），我们可以定义一个离散系统中的观察者会感知到的等效离散时间角频率 $\\tilde{\\omega}$：\n$$ i\\tilde{\\omega}F = i\\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right)F $$\n这建立了从连续频率 $\\omega$ 到其离散表示 $\\tilde{\\omega}$ 的映射：\n$$ \\tilde{\\omega}(\\omega) = \\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n此表达式是蛙跳时间步进格式的数值色散关系的一部分。\n\n**2. 奈奎斯特准则与时间混叠**\n\n函数 $\\tilde{\\omega}(\\omega)$ 并非对所有 $\\omega$ 都唯一可逆。正弦函数在其主值范围之外是周期性的且非单调的。为避免混叠（即不同的连续频率映射到相同的离散频率），正弦函数的参数必须限制在区间 $[-\\pi/2, \\pi/2]$ 内。\n$$ \\left|\\frac{\\omega \\Delta t}{2}\\right| \\le \\frac{\\pi}{2} \\implies |\\omega| \\le \\frac{\\pi}{\\Delta t} $$\n可以被无歧义地表示的最高角频率是奈奎斯特频率，$\\omega_{\\text{Nyquist}} = \\pi/\\Delta t$。源信号中任何高于此值的频率内容都将被混叠（被错误地表示为较低的频率），导致模拟错误。因此，为进行精确模拟，必须选择时间步长 $\\Delta t$，使得源频谱中的所有重要频率 $\\omega$ 都满足 $\\omega \\le \\pi/\\Delta t$。\n\n**3. 源信号的频谱**\n\n源的时间波形由 $s(t)=\\exp\\!\\big[-(t-t_{0})^{2}/\\tau^{2}\\big]\\sin(\\omega_{0} t)$ 给出。我们必须找到它的频谱 $S(\\omega) = \\mathcal{F}\\{s(t)\\}$，以确定其带宽。使用欧拉公式 $\\sin(\\omega_{0}t) = (e^{i\\omega_{0}t} - e^{-i\\omega_{0}t})/(2i)$，我们可以写出：\n$$ s(t) = \\frac{1}{2i} \\left( \\exp\\left(-\\frac{(t-t_0)^2}{\\tau^2}\\right)e^{i\\omega_0 t} - \\exp\\left(-\\frac{(t-t_0)^2}{\\tau^2}\\right)e^{-i\\omega_0 t} \\right) $$\n时移高斯函数 $g(t-t_0)=\\exp(-(t-t_0)^2/\\tau^2)$ 的傅里叶变换是 $G(\\omega) = \\tau\\sqrt{\\pi} \\exp(-i\\omega t_0) \\exp(-\\tau^2\\omega^2/4)$。利用傅里叶变换的频移特性 $\\mathcal{F}\\{f(t)e^{i\\omega_0 t}\\} = F(\\omega-\\omega_0)$，$s(t)$ 的变换为：\n$$ S(\\omega) = \\frac{1}{2i} \\left[ G(\\omega-\\omega_0) - G(\\omega+\\omega_0) \\right] $$\n该频谱由两个谱瓣组成，它们是 $G(\\omega)$ 的缩放版本，分别以 $\\omega = +\\omega_0$ 和 $\\omega = -\\omega_0$ 为中心。正频率谱瓣的幅度由 $G(\\omega-\\omega_0)$ 的幅度决定：\n$$ |G(\\omega-\\omega_0)| = \\tau\\sqrt{\\pi} \\exp\\left(-\\frac{\\tau^2(\\omega-\\omega_0)^2}{4}\\right) $$\n此谱瓣呈高斯形状，中心在 $\\omega=\\omega_0$。\n\n**4. 确定有效最高频率 $\\omega_{\\max}$**\n\n问题将 $\\omega_{\\max}$ 定义为正频率谱瓣的幅度下降到其峰值的一个分数 $\\varepsilon$ 时的频率。此谱瓣的峰值出现在 $\\omega = \\omega_0$ 处，此时指数项为 $\\exp(0)=1$。因此，峰值幅度为 $M_{\\text{peak}} = |G(0)| = \\tau\\sqrt{\\pi}$。\n我们必须找到 $\\omega_{\\max}$，使得 $|G(\\omega_{\\max}-\\omega_0)| = \\varepsilon M_{\\text{peak}}$。\n$$ \\tau\\sqrt{\\pi} \\exp\\left(-\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4}\\right) = \\varepsilon \\left(\\tau\\sqrt{\\pi}\\right) $$\n$$ \\exp\\left(-\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4}\\right) = \\varepsilon $$\n对两边取自然对数：\n$$ -\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4} = \\ln(\\varepsilon) $$\n由于 $\\varepsilon \\in (0,1)$，$\\ln(\\varepsilon)$ 是负数。我们可以写成 $\\ln(\\varepsilon) = -\\ln(1/\\varepsilon)$。\n$$ \\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4} = \\ln\\left(\\frac{1}{\\varepsilon}\\right) $$\n解出 $(\\omega_{\\max}-\\omega_0)$:\n$$ (\\omega_{\\max}-\\omega_0)^2 = \\frac{4}{\\tau^2}\\ln\\left(\\frac{1}{\\varepsilon}\\right) $$\n$$ \\omega_{\\max}-\\omega_0 = \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} $$\n我们取正根，因为我们关心的是定义带宽上边缘的频率 $\\omega_{\\max} > \\omega_0$。\n$$ \\omega_{\\max} = \\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} $$\n\n**5. 推导最大允许时间步长 $\\Delta t_{\\max}$**\n\n为防止源频谱发生混叠，其有效最高频率 $\\omega_{\\max}$ 必须小于或等于奈奎斯特频率 $\\omega_{\\text{Nyquist}}$。最大允许时间步长 $\\Delta t_{\\max}$ 对应于该条件变为等式的情况：\n$$ \\omega_{\\max} = \\frac{\\pi}{\\Delta t_{\\max}} $$\n代入我们为 $\\omega_{\\max}$ 推导的表达式：\n$$ \\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} = \\frac{\\pi}{\\Delta t_{\\max}} $$\n最后，解出 $\\Delta t_{\\max}$ 得到所需的闭式表达式：\n$$ \\Delta t_{\\max} = \\frac{\\pi}{\\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)}} $$\n这是确保蛙跳格式能够无混叠地表示源的谱内容直至 $\\varepsilon$-带宽点的最大时间步长。",
            "answer": "$$\n\\boxed{\\frac{\\pi}{\\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)}}}\n$$"
        }
    ]
}