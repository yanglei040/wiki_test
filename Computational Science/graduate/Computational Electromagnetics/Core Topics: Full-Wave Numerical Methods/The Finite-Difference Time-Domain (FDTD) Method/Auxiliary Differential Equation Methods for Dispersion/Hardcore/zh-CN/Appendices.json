{
    "hands_on_practices": [
        {
            "introduction": "在任何时域仿真中，选择一个稳定的时间步长 $\\Delta t$ 都是成功的基石。本练习将指导您推导由多极点洛伦兹模型中材料的辅助微分方程（ADE）所施加的稳定性约束。通过本练习，您将学习如何平衡这种与材料相关的约束和著名的 Courant-Friedrichs-Lewy (CFL) 条件，从而为实际仿真确定整体的最大稳定时间步长。",
            "id": "3289828",
            "problem": "要求您形式化并计算当多个 Lorentz 振子模型的极点在目标频带附近密集分布时，该色散材料的离散时间稳定性约束。背景是时域有限差分（FDTD, Finite-Difference Time-Domain）计算电磁学与用于处理色散的辅助微分方程（ADE, Auxiliary Differential Equation）方法相结合。核心目标是从第一性原理出发，推导 ADE 材料子系统的稳定性约束及其与电磁 Courant–Friedrichs–Lewy (CFL) 约束的相互作用，然后进行数值实现。\n\n从以下基本原理出发，推导离散时间稳定性约束：\n- 由 Lorentz 极化建模的线性色散介质中的麦克斯韦方程组：\n$$\n\\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}, \\quad \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t},\n$$\n其中\n$$\n\\mathbf{D}(t) = \\epsilon_0 \\epsilon_{\\infty} \\mathbf{E}(t) + \\mathbf{P}(t), \\quad \\mathbf{P}(t) = \\sum_{j=1}^{N_p} \\mathbf{P}_j(t),\n$$\n对于每个 Lorentz 极点 $j$，\n$$\n\\frac{d^2 \\mathbf{P}_j}{dt^2} + \\gamma_j \\frac{d \\mathbf{P}_j}{dt} + \\omega_j^2 \\mathbf{P}_j = \\epsilon_0 \\Delta \\epsilon_j \\omega_j^2 \\mathbf{E}(t),\n$$\n其中 $\\epsilon_0$ 是真空介电常数，$\\mu_0$ 是真空磁导率，$\\epsilon_{\\infty}$ 是高频介电常数，$\\Delta \\epsilon_j$ 是极点 $j$ 的强度，$\\gamma_j$ 是其阻尼系数（单位为 $\\mathrm{s}^{-1}$），$\\omega_j$ 是其角共振频率（单位为 $\\mathrm{rad/s}$）。\n\n您必须使用与标准蛙跳 FDTD 时间步进一致的显式二阶中心差分格式，对 Lorentz 极点常微分方程进行离散化，并确定离散时间步长 $\\Delta t$ 在何种条件下能使离散 ADE 更新的齐次部分保持稳定。稳定性必须通过线性离散时间根位置来评估（例如，针对二阶实系数多项式的 Jury 稳定性判据）。然后，对于多个极点的情况，确定目标角频带附近的极点聚集如何影响 $\\Delta t$ 的选择，并解释其与三维 Yee 格式的电磁 CFL 约束的相互作用。\n\n对于三维 Yee 网格，CFL 约束基于真空中的光速 $c$，其中 $c = \\frac{1}{\\sqrt{\\mu_0 \\epsilon_0}} = 299792458\\,\\mathrm{m/s}$。在三维空间中，对于空间步长 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$，时间步长的 CFL 界限为\n$$\n\\Delta t_{\\mathrm{EM}} \\le \\frac{1}{c \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}.\n$$\n综合要求是实际时间步长 $\\Delta t$ 必须同时满足 ADE 材料稳定性约束和电磁 CFL 约束。您必须计算最大稳定 $\\Delta t$ 为\n$$\n\\Delta t_{\\max} = \\min\\left(\\Delta t_{\\mathrm{material}}, \\Delta t_{\\mathrm{EM}}\\right),\n$$\n其中 $\\Delta t_{\\mathrm{material}}$ 是使所有极点 $j$ 的离散 ADE 子系统保持稳定的最大时间步长。\n\n您的程序必须实现所推导的约束，并为以下每个测试用例计算 $\\Delta t_{\\max}$。所有物理量必须使用国际单位制处理，结果必须以秒表示。角频率的角度单位是弧度。您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，如 $[\\Delta t_1, \\Delta t_2, \\Delta t_3]$。每个结果必须是浮点数，单位为秒。\n\n测试套件：\n- 情况 $1$（太赫兹频带附近的密集极点簇，电磁 CFL 非限制性）：\n  - 极点：三个 Lorentz 极点，角频率为 $\\omega_j = 2\\pi f_j$，其中 $f_1 = 1.00\\times 10^{12}\\,\\mathrm{Hz}$，$f_2 = 1.02\\times 10^{12}\\,\\mathrm{Hz}$，$f_3 = 0.98\\times 10^{12}\\,\\mathrm{Hz}$；阻尼系数为 $\\gamma_1 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$，$\\gamma_2 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$，$\\gamma_3 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$。\n  - 网格：$\\Delta x = 10^{-3}\\,\\mathrm{m}$，$\\Delta y = 10^{-3}\\,\\mathrm{m}$，$\\Delta z = 10^{-3}\\,\\mathrm{m}$。\n- 情况 $2$（吉赫兹频带附近的极点簇，由于网格精细，电磁 CFL 强限制性）：\n  - 极点：三个 Lorentz 极点，角频率为 $\\omega_j = 2\\pi f_j$，其中 $f_1 = 1.00\\times 10^{9}\\,\\mathrm{Hz}$，$f_2 = 1.05\\times 10^{9}\\,\\mathrm{Hz}$，$f_3 = 0.95\\times 10^{9}\\,\\mathrm{Hz}$；阻尼系数为 $\\gamma_1 = 1.0\\times 10^{8}\\,\\mathrm{s}^{-1}$，$\\gamma_2 = 5.0\\times 10^{8}\\,\\mathrm{s}^{-1}$，$\\gamma_3 = 2.0\\times 10^{8}\\,\\mathrm{s}^{-1}$。\n  - 网格：$\\Delta x = 10^{-6}\\,\\mathrm{m}$，$\\Delta y = 10^{-6}\\,\\mathrm{m}$，$\\Delta z = 10^{-6}\\,\\mathrm{m}$。\n- 情况 $3$（多太赫兹频带附近具有高阻尼的密集极点簇，由于网格粗糙，电磁 CFL 非限制性）：\n  - 极点：三个 Lorentz 极点，角频率为 $\\omega_j = 2\\pi f_j$，其中 $f_1 = 3.00\\times 10^{12}\\,\\mathrm{Hz}$，$f_2 = 3.10\\times 10^{12}\\,\\mathrm{Hz}$，$f_3 = 2.90\\times 10^{12}\\,\\mathrm{Hz}$；阻尼系数为 $\\gamma_1 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$，$\\gamma_2 = 1.0\\times 10^{12}\\,\\mathrm{s}^{-1}$，$\\gamma_3 = 5.0\\times 10^{12}\\,\\mathrm{s}^{-1}$。\n  - 网格：$\\Delta x = 10^{-2}\\,\\mathrm{m}$，$\\Delta y = 10^{-2}\\,\\mathrm{m}$，$\\Delta z = 10^{-2}\\,\\mathrm{m}$。\n\n您的程序应输出一行，其中包含三个计算出的最大稳定时间步长（单位为秒），以逗号分隔的列表形式并用方括号括起来，顺序与上述情况一致，例如 $[v_1,v_2,v_3]$。不应打印任何其他文本。输出必须是浮点数。",
            "solution": "该问题是有效的，因为它在科学上基于经典电磁学和数值分析，问题陈述清晰，并且提供了推导和计算所需的所有参数。分析的重点是辅助微分方程（ADE）齐次部分的稳定性，为此，所提供的参数 $\\omega_j$ 和 $\\gamma_j$ 是足够的。\n\n目标是为在时域有限差分（FDTD）方法中使用的多极点 Lorentz 色散材料模型推导离散时间稳定性约束。这需要分析材料极化控制常微分方程（ODE）的离散化。\n\n我们考虑 Lorentz 模型单个极化分量 $\\mathbf{P}_j(t)$ 的齐次部分，为清晰起见，我们可以将其作为标量方程进行分析，暂时省略矢量和极点索引符号：\n$$\n\\frac{d^2 P}{dt^2} + \\gamma \\frac{d P}{dt} + \\omega^2 P = 0\n$$\n这是一个二阶线性齐次 ODE。问题指定使用显式二阶中心差分格式进行离散化。我们将时间离散化为 $t = n\\Delta t$，并让 $P^n$ 表示 $P(n\\Delta t)$。在时间 $t=n\\Delta t$ 处，导数的中心差分近似为：\n$$\n\\frac{d^2 P}{dt^2} \\bigg|_{n\\Delta t} \\approx \\frac{P^{n+1} - 2P^n + P^{n-1}}{(\\Delta t)^2}\n$$\n$$\n\\frac{d P}{dt} \\bigg|_{n\\Delta t} \\approx \\frac{P^{n+1} - P^{n-1}}{2\\Delta t}\n$$\n将这些表达式代入齐次 ODE，得到离散时间方程：\n$$\n\\frac{P^{n+1} - 2P^n + P^{n-1}}{(\\Delta t)^2} + \\gamma \\left( \\frac{P^{n+1} - P^{n-1}}{2\\Delta t} \\right) + \\omega^2 P^n = 0\n$$\n为了分析这个线性递推关系的稳定性，我们按时间步索引（$n+1$, $n$, $n-1$）重新排列各项：\n$$\nP^{n+1} \\left( \\frac{1}{(\\Delta t)^2} + \\frac{\\gamma}{2\\Delta t} \\right) + P^n \\left( \\omega^2 - \\frac{2}{(\\Delta t)^2} \\right) + P^{n-1} \\left( \\frac{1}{(\\Delta t)^2} - \\frac{\\gamma}{2\\Delta t} \\right) = 0\n$$\n两边同乘以 $(\\Delta t)^2$，我们得到一个更方便的形式：\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) P^{n+1} + \\left( (\\omega \\Delta t)^2 - 2 \\right) P^n + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) P^{n-1} = 0\n$$\n这是一个线性齐次差分方程。其稳定性由其特征多项式的根决定。假设解的形式为 $P^n = z^n$（其中 $z$ 为某个复数），我们将其代入方程：\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) z^2 + \\left( (\\omega \\Delta t)^2 - 2 \\right) z + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) = 0\n$$\n这是一个 $az^2 + bz + c = 0$ 形式的二次多项式，其中：\n$a = 1 + \\frac{\\gamma \\Delta t}{2}$\n$b = (\\omega \\Delta t)^2 - 2$\n$c = 1 - \\frac{\\gamma \\Delta t}{2}$\n\n为使离散系统稳定，根 $z$ 的模不得超过 1，即 $|z| \\le 1$。我们应用针对二阶实系数多项式的 Jury 稳定性判据。由于阻尼系数 $\\gamma \\ge 0$ 且时间步长 $\\Delta t > 0$，系数 $a$ 总是正的（$a > 1$）。临界稳定性（$|z| \\le 1$）的判据是：\n1. $a+b+c \\ge 0$\n2. $a-b+c \\ge 0$\n3. $|c| \\le a$\n\n我们来评估每个条件。\n条件 1：\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) + \\left( (\\omega \\Delta t)^2 - 2 \\right) + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) = (\\omega \\Delta t)^2 \\ge 0\n$$\n该条件总是满足。\n\n条件 3：\n$$\n|c| \\le a \\implies \\left| 1 - \\frac{\\gamma \\Delta t}{2} \\right| \\le 1 + \\frac{\\gamma \\Delta t}{2}\n$$\n这个不等式等价于 $- (1 + \\frac{\\gamma \\Delta t}{2}) \\le 1 - \\frac{\\gamma \\Delta t}{2} \\le 1 + \\frac{\\gamma \\Delta t}{2}$。右侧不等式简化为 $0 \\le \\gamma \\Delta t$，对于 $\\gamma \\ge 0$ 为真。左侧不等式简化为 $-1 \\le 1$，总是为真。因此，对于任何物理阻尼，该条件无条件满足。\n\n条件 2：\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) - \\left( (\\omega \\Delta t)^2 - 2 \\right) + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) \\ge 0\n$$\n$$\n1 + \\frac{\\gamma \\Delta t}{2} - (\\omega \\Delta t)^2 + 2 + 1 - \\frac{\\gamma \\Delta t}{2} \\ge 0\n$$\n$$\n4 - (\\omega \\Delta t)^2 \\ge 0 \\implies (\\omega \\Delta t)^2 \\le 4\n$$\n由于 $\\omega$ 和 $\\Delta t$ 均为正，取正平方根，得到稳定性约束：\n$$\n\\omega \\Delta t \\le 2 \\implies \\Delta t \\le \\frac{2}{\\omega}\n$$\n这是单个 Lorentz 极点的稳定性约束。对于由多个极点（$j = 1, \\dots, N_p$）描述的材料，极化是和 $\\mathbf{P} = \\sum_j \\mathbf{P}_j$。每个 $\\mathbf{P}_j$ 的齐次方程是解耦的。因此，整个模拟使用的单个时间步长 $\\Delta t$ 必须同时满足每个极点的稳定性条件。这要求：\n$$\n\\Delta t \\le \\min_{j} \\left( \\frac{2}{\\omega_j} \\right)\n$$\n这个最小值由具有最大共振频率的极点决定，即 $\\omega_{\\max} = \\max_j(\\omega_j)$。因此，材料子系统的稳定性约束为：\n$$\n\\Delta t_{\\mathrm{material}} = \\frac{2}{\\max_j(\\omega_j)}\n$$\n极点的聚集之所以重要，仅仅是因为簇中频率最高的极点决定了此限制。对于此特定的中心差分格式，阻尼系数 $\\gamma_j$ 不影响稳定性边界。\n\n这个材料稳定性约束必须与电磁场传播的 Courant–Friedrichs–Lewy (CFL) 约束同时满足。对于三维 Yee 网格，其空间步长为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$，CFL 约束为：\n$$\n\\Delta t_{\\mathrm{EM}} = \\frac{1}{c \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}\n$$\n其中 $c$ 是真空中的光速。FDTD 模拟的总的最大稳定时间步长是这两个条件中更严格的一个：\n$$\n\\Delta t_{\\max} = \\min\\left( \\Delta t_{\\mathrm{material}}, \\Delta t_{\\mathrm{EM}} \\right)\n$$\n现在将这个通用公式应用于具体的测试用例。在 $\\Delta x = \\Delta y = \\Delta z = \\Delta_s$ 的特殊情况下，CFL 极限简化为 $\\Delta t_{\\mathrm{EM}} = \\frac{\\Delta_s}{c\\sqrt{3}}$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum stable time step for FDTD simulations with\n    multi-pole Lorentz dispersive materials.\n    \"\"\"\n    \n    # Speed of light in vacuum (m/s)\n    c = 299792458.0\n\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (list of frequencies in Hz, list of damping coefficients in s^-1, grid spacing in m).\n    # The damping coefficients (gamma) are not used in the stability calculation\n    # derived for the central-difference scheme, but are retained for data integrity.\n    test_cases = [\n        # Case 1: Closely spaced cluster near a THz band, CFL non-limiting.\n        (\n            [1.00e12, 1.02e12, 0.98e12],     # frequencies f_j\n            [5.0e10, 5.0e10, 5.0e10],        # damping coefficients gamma_j\n            1.0e-3                           # grid spacing delta_s\n        ),\n        # Case 2: Cluster near a GHz band, CFL highly limiting.\n        (\n            [1.00e9, 1.05e9, 0.95e9],       # frequencies f_j\n            [1.0e8, 5.0e8, 2.0e8],          # damping coefficients gamma_j\n            1.0e-6                           # grid spacing delta_s\n        ),\n        # Case 3: Cluster near a multi-THz band, CFL non-limiting.\n        (\n            [3.00e12, 3.10e12, 2.90e12],     # frequencies f_j\n            [1.0e13, 1.0e12, 5.0e12],        # damping coefficients gamma_j\n            1.0e-2                           # grid spacing delta_s\n        )\n    ]\n\n    results = []\n\n    for case in test_cases:\n        frequencies_hz, _, delta_s = case\n\n        # 1. Calculate the material stability constraint (dt_material)\n        \n        # The stability constraint is dictated by the highest resonance frequency.\n        # First, find the maximum frequency f_max in Hz.\n        f_max = max(frequencies_hz)\n        \n        # Convert it to the maximum angular frequency omega_max in rad/s.\n        omega_max = 2 * np.pi * f_max\n        \n        # The ADE stability constraint derived from the central-difference scheme is:\n        # dt_material = 2 / omega_max\n        dt_material = 2.0 / omega_max\n\n        # 2. Calculate the electromagnetic CFL constraint (dt_em)\n        \n        # For a 3D Yee grid with dx = dy = dz = delta_s, the CFL constraint is:\n        # dt_em = delta_s / (c * sqrt(3))\n        dt_em = delta_s / (c * np.sqrt(3.0))\n\n        # 3. Determine the overall maximum stable time step\n        \n        # The actual time step must satisfy both constraints.\n        dt_max = min(dt_material, dt_em)\n        results.append(dt_max)\n\n    # Print the results in the specified single-line format.\n    # Using scientific notation to represent the small float values precisely.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在稳定的基础上，下一个挑战是计算效率，尤其是在模拟具有众多洛伦兹极点的材料时。本练习引入强大的状态空间表示法来组织辅助微分方程组。通过推导紧凑的向量-矩阵递推关系，您将发现更新过程固有的块对角结构，并理解这一数学特性为何能在现代计算机硬件上实现单指令多数据（SIMD）技术的大规模并行化。",
            "id": "3289886",
            "problem": "考虑一种线性、均匀、各向同性的色散电介质，其在频域中的极化率由$N$个洛伦兹振子极点之和来表征。在时域中，该模型可以由电通量密度$\\mathbf{D}$、电场$\\mathbf{E}$和$N$个辅助极化密度$\\{P_{m}\\}_{m=1}^{N}$之间的一组$N$个耦合本构关系表示，其中对于每个极点$m$，\n$$\n\\mathbf{D}(t) = \\epsilon_{0}\\epsilon_{\\infty}\\mathbf{E}(t) + \\sum_{m=1}^{N} P_{m}(t),\n$$\n且每个$P_{m}$服从二阶常微分方程\n$$\n\\ddot{P}_{m}(t) + \\gamma_{m}\\dot{P}_{m}(t) + \\omega_{0,m}^{2} P_{m}(t) = \\omega_{p,m}^{2} \\mathbf{E}(t),\n$$\n其中$\\epsilon_{0}$是真空介电常数，$\\epsilon_{\\infty}$是高频相对介电常数，对于每个极点$m$，$\\gamma_{m}$是阻尼率，$\\omega_{0,m}$是谐振频率，$\\omega_{p,m}$是等离子体频率。麦克斯韦旋度方程照常将$\\mathbf{E}$和磁通量密度$\\mathbf{B}$联系起来。\n\n定义辅助电流$J_{m}(t) \\equiv \\dot{P}_{m}(t)$并引入单极点状态向量$x_{m}(t) \\equiv \\begin{pmatrix} P_{m}(t) \\\\ J_{m}(t) \\end{pmatrix}$。使用该状态，单极点本构动力学可以写成一阶形式，\n$$\n\\dot{x}_{m}(t) = F_{m}\\,x_{m}(t) + G_{m}\\,\\mathbf{E}(t),\n$$\n其中$F_{m}$和$G_{m}$是仅依赖于$\\gamma_{m}$、$\\omega_{0,m}$和$\\omega_{p,m}$的常数矩阵。考虑一个均匀的时间步长$\\Delta t$，并使用梯形法则（也称为Crank–Nicolson方法）对上述一阶单极点系统进行离散化，以获得$x_{m}^{n} \\equiv x_{m}(n\\Delta t)$关于$x_{m}^{n+1}$、$x_{m}^{n}$、$\\mathbf{E}^{n+1}$和$\\mathbf{E}^{n}$的线性隐式时间更新。组装全局状态$X^{n} \\equiv \\begin{pmatrix} x_{1}^{n} \\\\ \\vdots \\\\ x_{N}^{n} \\end{pmatrix}$，并将得到的$N$极点辅助微分方程（ADE）更新写成块对角状态空间形式的紧凑向量-矩阵递归。然后，基于推导出的结构，从第一性原理出发解释为什么块对角形式能够实现跨极点的单指令多数据（SIMD）更新而没有数据冒险。\n\n回答以下问题：\n\n- 从麦克斯韦方程和给定的洛伦兹极点本构律出发，推导基于梯形法则的时间离散单极点更新，并以紧凑的块对角状态空间形式$X^{n+1} = \\mathcal{A}\\,X^{n} + \\mathcal{B}\\,\\mathbf{E}^{n+1} + \\mathcal{B}\\,\\mathbf{E}^{n}$表示全局$N$极点递归，其中$\\mathcal{A}$和$\\mathcal{B}$不依赖于时间。\n- 以闭合形式给出块对角更新矩阵$\\mathcal{A}$，用$\\Delta t$、$\\{\\gamma_{m}\\}$和$\\{\\omega_{0,m}\\}$明确表示。\n- 解释块对角结构和单极点独立性如何实现跨$N$个极点的单指令多数据（SIMD）更新。\n\n你的最终答案必须是矩阵$\\mathcal{A}$的单一闭合形式解析表达式，仅用$\\Delta t$、$\\{\\gamma_{m}\\}$和$\\{\\omega_{0,m}\\}$表示。最终答案中不要包含任何等号或额外的评注。不需要进行数值计算。",
            "solution": "该问题要求使用辅助微分方程（ADE）方法，推导基于梯形法则的多极点洛伦兹色散模型的时域更新方程，并分析所得结构以进行并行计算。\n\n首先，我们必须将状态空间表示形式化。每个极化密度极点$m$的控制二阶常微分方程（ODE）如下所示：\n$$\n\\ddot{P}_{m}(t) + \\gamma_{m}\\dot{P}_{m}(t) + \\omega_{0,m}^{2} P_{m}(t) = \\omega_{p,m}^{2} \\mathbf{E}(t)\n$$\n问题陈述中存在一个符号不一致的问题：$P_m$是非粗体，意味着是标量，而$\\mathbf{E}(t)$是粗体，意味着是矢量。对于线性各向同性介质，极化矢量的分量仅依赖于电场的相应矢量分量。例如，$x$分量的ODE将是$\\ddot{P}_{m,x}(t) + \\gamma_{m}\\dot{P}_{m,x}(t) + \\omega_{0,m}^{2} P_{m,x}(t) = \\omega_{p,m}^{2} E_x(t)$。$y$和$z$分量的方程形式相同。因此，我们可以对单个标量分量进行推导，得到的更新系数对于所有三个空间分量都将是相同的。让标量变量$P_m(t)$、$J_m(t)$和$E(t)$代表这样一个分量。\n\n每个极点$m$的状态向量定义为$x_{m}(t) = \\begin{pmatrix} P_{m}(t) \\\\ J_{m}(t) \\end{pmatrix}$，其中$J_{m}(t) = \\dot{P}_{m}(t)$。状态向量的一阶导数是$\\dot{x}_{m}(t) = \\begin{pmatrix} \\dot{P}_{m}(t) \\\\ \\ddot{P}_{m}(t) \\end{pmatrix}$。利用定义和控制ODE，我们可以写出：\n$$\n\\dot{x}_{m}(t) = \\begin{pmatrix} J_{m}(t) \\\\ -\\omega_{0,m}^{2} P_{m}(t) - \\gamma_{m} J_{m}(t) + \\omega_{p,m}^{2} E(t) \\end{pmatrix}\n$$\n通过识别常数矩阵$F_m$和$G_m$，这可以表示为一阶矩阵形式$\\dot{x}_{m}(t) = F_{m}x_{m}(t) + G_{m}E(t)$：\n$$\nF_{m} = \\begin{pmatrix} 0  1 \\\\ -\\omega_{0,m}^{2}  -\\gamma_{m} \\end{pmatrix}, \\quad G_{m} = \\begin{pmatrix} 0 \\\\ \\omega_{p,m}^{2} \\end{pmatrix}\n$$\n接下来，我们使用梯形法则（Crank-Nicolson方法）在一个时间步长$\\Delta t$上对该系统进行离散化。对于一个一般的一阶ODE $\\dot{y} = f(y,t)$，该法则是$y^{n+1} - y^{n} = \\frac{\\Delta t}{2} \\left[ f(y^{n+1}, t^{n+1}) + f(y^{n}, t^{n}) \\right]$。将此应用于我们的线性系统：\n$$\nx_{m}^{n+1} - x_{m}^{n} = \\frac{\\Delta t}{2} \\left[ (F_{m}x_{m}^{n+1} + G_{m}E^{n+1}) + (F_{m}x_{m}^{n} + G_{m}E^{n}) \\right]\n$$\n为了找到$x_{m}^{n+1}$的显式更新规则，我们重新整理方程，将包含$x_{m}^{n+1}$的项分组到左侧，所有其他项分组到右侧：\n$$\n\\left(I - \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n+1} = \\left(I + \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n} + \\frac{\\Delta t}{2}G_{m} \\left(E^{n+1} + E^{n}\\right)\n$$\n其中$I$是$2 \\times 2$的单位矩阵。解出$x_{m}^{n+1}$得到：\n$$\nx_{m}^{n+1} = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n} + \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\frac{\\Delta t}{2}G_{m} \\left(E^{n+1} + E^{n}\\right)\n$$\n这是单极点更新方程。我们现在可以识别出单极点更新矩阵。令$A_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right)$和$B_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\frac{\\Delta t}{2}G_{m}$。更新方程为$x_m^{n+1} = A_m x_m^n + B_m(E^{n+1} + E^n)$，这可以组装成规定的全局状态空间形式。\n\n全局状态向量是$X^n = \\begin{pmatrix} x_1^n \\\\ \\vdots \\\\ x_N^n \\end{pmatrix}$。由于每个极点$m$的动力学仅依赖于其自身的状态$x_m$和共同的场$E$，因此各极点之间的更新是解耦的。全局递归为：\n$$\nX^{n+1} = \\mathcal{A} X^n + \\mathcal{B} (E^{n+1} + E^n)\n$$\n其中问题要求的形式是$X^{n+1} = \\mathcal{A}X^{n} + \\mathcal{B}E^{n+1} + \\mathcal{B}E^{n}$。矩阵$\\mathcal{A}$和$\\mathcal{B}$具有以下块结构：\n$$\n\\mathcal{A} = \\begin{pmatrix} A_1  0  \\cdots  0 \\\\ 0  A_2  \\cdots  0 \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ 0  0  \\cdots  A_N \\end{pmatrix}, \\quad \\mathcal{B} = \\begin{pmatrix} B_1 \\\\ B_2 \\\\ \\vdots \\\\ B_N \\end{pmatrix}\n$$\n问题要求$\\mathcal{A}$的闭合形式表达式。为了找到它，我们必须计算矩阵$A_m$。首先，我们找出要相乘和求逆的矩阵：\n$$\nI - \\frac{\\Delta t}{2}F_{m} = \\begin{pmatrix} 1  -\\frac{\\Delta t}{2} \\\\ \\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 + \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\n$$\nI + \\frac{\\Delta t}{2}F_{m} = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 - \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\n$\\left(I - \\frac{\\Delta t}{2}F_{m}\\right)$的行列式为：\n$$\n\\det\\left(I - \\frac{\\Delta t}{2}F_{m}\\right) = (1)\\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right) - \\left(-\\frac{\\Delta t}{2}\\right)\\left(\\frac{\\Delta t}{2}\\omega_{0,m}^{2}\\right) = 1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2}\n$$\n让我们将此行列式表示为$D_m$。其逆矩阵是：\n$$\n\\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} = \\frac{1}{D_m} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m}  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 \\end{pmatrix}\n$$\n现在我们计算$A_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right)$：\n$$\nA_m = \\frac{1}{D_m} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m}  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 - \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\n执行矩阵乘法得到分子矩阵的各分量：\n$$\n(A_m)_{11} = \\frac{1}{D_m} \\left[ \\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right) - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right] = \\frac{1}{D_m} \\left[ 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right]\n$$\n$$\n(A_m)_{12} = \\frac{1}{D_m} \\left[ \\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right)\\frac{\\Delta t}{2} + \\frac{\\Delta t}{2}\\left(1 - \\frac{\\Delta t}{2}\\gamma_{m}\\right) \\right] = \\frac{1}{D_m} \\left[ \\Delta t \\right]\n$$\n$$\n(A_m)_{21} = \\frac{1}{D_m} \\left[ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} - \\frac{\\Delta t}{2}\\omega_{0,m}^{2} \\right] = \\frac{1}{D_m} \\left[ -\\Delta t \\, \\omega_{0,m}^{2} \\right]\n$$\n$$\n(A_m)_{22} = \\frac{1}{D_m} \\left[ -\\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} + \\left(1 - \\frac{\\Delta t}{2}\\gamma_{m}\\right) \\right] = \\frac{1}{D_m} \\left[ 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right]\n$$\n所以块矩阵$A_m$是：\n$$\nA_m = \\frac{1}{1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}  \\Delta t \\\\ -\\Delta t \\, \\omega_{0,m}^{2}  1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} \\end{pmatrix}\n$$\n全局矩阵$\\mathcal{A}$是由这些$A_m$块构成的块对角矩阵。\n\n最后，我们解释为什么这种结构能够实现SIMD更新。SIMD代表单指令，多数据（Single Instruction, Multiple Data），这是一种并行处理范式，其中相同的操作同时作用于多个数据点。\n推导出的全局更新方程是$X^{n+1} = \\mathcal{A}X^{n} + \\mathcal{B}(E^{n+1} + E^{n})$。关键特征是矩阵$\\mathcal{A}$是块对角的。这种结构在数学上表示了洛伦兹极点的物理独立性。单个极点状态的更新，$x_m^{n+1} = A_m x_m^n + B_m(E^{n+1} + E^n)$，仅依赖于其自身的先前状态$x_m^n$和共同的驱动场$E$。它不依赖于任何其他极点的状态，$x_k^n$ for $k \\neq m$。\n这种独立性是SIMD并行化的关键。\n1.  **单指令（Single Instruction）**: 计算$A_m x_m^n$并加上场项所需的算术运算序列对于每个极点$m$都是相同的。这个序列构成了“单指令”。尽管$A_m$中的系数（由$\\gamma_m$、$\\omega_{0,m}$导出）对每个极点都不同，但计算的结构是相同的。\n2.  **多数据（Multiple Data）**: $N$个不同极点的状态向量$\\{x_1^n, x_2^n, ..., x_N^n\\}$构成了“多数据”。\n在SIMD架构中（例如，在CPU上使用AVX指令或在GPU上），可以把多个极点的状态向量分量加载到宽向量寄存器中。例如，一个寄存器可以存放一组不同极点$m$的$P_m$值，另一个寄存器可以存放$J_m$值。然后，由更新算法定义的相同的浮点乘法和加法将并行地应用于寄存器中的所有数据通道。\n因为极点$m$的更新不需要来自极点$k$的任何信息，所以在极点更新之间没有**数据冒险**。所有$N$个极点都可以并发更新，而无需等待彼此的结果。这种缺乏极点间数据依赖性的特点，使得具有块对角更新矩阵的ADE-FDTD算法在现代并行硬件上异常高效。\n最终答案是矩阵$\\mathcal{A}$的闭合形式表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} A_1 & \\mathbf{0} & \\cdots & \\mathbf{0} \\\\ \\mathbf{0} & A_2 & \\cdots & \\mathbf{0} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ \\mathbf{0} & \\mathbf{0} & \\cdots & A_N \\end{pmatrix} \\text{, 其中 } A_m = \\frac{1}{1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} & \\Delta t \\\\ -\\Delta t \\, \\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "我们最后的练习将探讨一个更微妙但至关重要的数值实现问题：鲁棒性与精度。即使是数学上稳定且高效的算法，也可能因浮点运算的限制而产生错误结果，这在高Q值（低损耗）系统中尤其值得关注。这个高级练习要求您量化ADE更新中“灾难性相消”的风险，并设计一种状态空间重缩放策略来改善问题的数值条件，从而确保即使在具有挑战性的情况下也能获得精确的结果。",
            "id": "3289846",
            "problem": "一个通过辅助微分方程（ADE）形式主义建模的单极洛伦兹电介质，其电极化强度 $P(t)$ 满足二阶常微分方程\n$$\n\\frac{d^{2}P}{dt^{2}}+\\gamma\\,\\frac{dP}{dt}+\\omega_{0}^{2}\\,P=\\alpha\\,E(t),\n$$\n其中 $\\gamma>0$ 是阻尼率，$\\omega_{0}>0$ 是无阻尼共振频率，$\\alpha$ 是一个与振子强度成正比的常数。考虑一个在时间步长 $\\Delta t$ 上的时步实现，该实现使用连续时间系统的精确齐次传播子来更新极化状态，并使用一致的求积法来处理驱动项。在实践中，当 $\\gamma\\Delta t\\ll 1$ 且品质因数 $Q=\\omega_{0}/\\gamma$ 很大（高-$Q$）时，在计算标量更新系数时可能会发生灾难性抵消，这些系数涉及几乎相等的量之间的微小差异（例如，包含 $\\exp(-\\gamma\\Delta t)$ 与阻尼频率的三角函数之乘积的差值）。\n\n你的任务是：\n\n- 从基本运算的浮点误差模型出发，其中每个运算 $\\circ\\in\\{+,-,\\times,\\div\\}$ 满足 $\\mathrm{fl}(a\\circ b)=(a\\circ b)(1+\\delta)$，且对于机器单位舍入误差 $u$，有 $|\\delta|\\leq u$。仅使用连续时间ADE以及 $\\exp(\\cdot)$ 和三角函数的标准性质作为基础，推导在 $\\epsilon\\ll 1$ 和 $\\tau\\ll 1$ 的情况下，当形式为 $K(\\epsilon,\\tau)=1-\\exp(-\\epsilon)\\cos(\\tau)$ 的系数通过相继求值 $\\exp(-\\epsilon)$、$\\cos(\\tau)$、它们的乘积，然后从 $1$ 中减去的朴素方法计算时，相对舍入误差的最坏情况乘法放大的主阶渐近表达式。其中 $\\epsilon=\\gamma\\Delta t$ 且 $\\tau=\\Omega\\Delta t$，$\\Omega=\\sqrt{\\omega_{0}^{2}-(\\gamma/2)^{2}}$。\n\n- 为减轻齐次更新中的这种抵消，考虑无驱动部分的一阶状态空间形式 $\\dot{z}(t)=A\\,z(t)$，其中 $z=[P\\;\\; \\dot{P}]^{T}$ 且\n$$\nA=\\begin{pmatrix}\n0  1\\\\\n-\\omega_{0}^{2}  -\\gamma\n\\end{pmatrix}.\n$$\n提出一个状态 $y=T\\,z$ 的相似性缩放，其中 $T=\\mathrm{diag}(1,s)$，$s>0$ 具有时间单位。使用无阻尼算子 $A_{0}=\\begin{pmatrix}0  1\\\\ -\\omega_{0}^{2}  0\\end{pmatrix}$ 作为基本基准进行论证，说明存在一个 $s$ 的选择，使得缩放后的无阻尼算子 $A_{0,s}=T A_{0} T^{-1}$ 成为一个在所有此类对角缩放中具有最小二范数条件数的正规矩阵。计算实现此最小化的值 $s^{\\star}$，仅用 $\\omega_{0}$ 表示。\n\n将你的最终答案 $s^{\\star}$ 以秒（s）为单位表示。在最终的方框答案中不要包含任何单位。",
            "solution": "该问题包含两个独立的任务。第一个任务是分析一个系数的朴素计算中的浮点误差传播。第二个任务是确定状态空间表示的最优缩放参数。我们将依次解决它们。\n\n首先，我们分析在 $\\epsilon \\ll 1$ 和 $\\tau \\ll 1$ 的情况下，系数 $K(\\epsilon,\\tau)=1-\\exp(-\\epsilon)\\cos(\\tau)$ 的相对舍入误差的最坏情况乘法放大。朴素的计算过程分为四步：\n$1$. $c_1 = \\exp(-\\epsilon)$\n$2$. $c_2 = \\cos(\\tau)$\n$3$. $c_3 = c_1 \\times c_2$\n$4$. $K = 1 - c_3$\n\n我们使用浮点运算的标准模型，其中对精确输入 $a$ 和 $b$ 进行运算 $\\circ$ 的计算结果为 $\\mathrm{fl}(a \\circ b) = (a \\circ b)(1+\\delta)$，其中 $|\\delta| \\leq u$，$u$ 是机器单位舍入误差。我们假设基本函数的求值也引入一个量级相似的相对误差。\n\n令 $\\hat{c}_1$, $\\hat{c}_2$, $\\hat{c}_3$ 和 $\\hat{K}$ 为计算出的浮点值。\n$c_1$ 和 $c_2$ 的计算产生：\n$\\hat{c}_1 = \\mathrm{fl}(\\exp(-\\epsilon)) = \\exp(-\\epsilon)(1+\\delta_1)$\n$\\hat{c}_2 = \\mathrm{fl}(\\cos(\\tau)) = \\cos(\\tau)(1+\\delta_2)$\n其中 $|\\delta_1| \\leq u$ 且 $|\\delta_2| \\leq u$。\n\n这些计算值的乘积给出：\n$\\hat{c}_3 = \\mathrm{fl}(\\hat{c}_1 \\times \\hat{c}_2) = (\\hat{c}_1 \\hat{c}_2)(1+\\delta_3)$，其中 $|\\delta_3| \\leq u$。\n代入 $\\hat{c}_1$ 和 $\\hat{c}_2$ 的表达式：\n$\\hat{c}_3 = (\\exp(-\\epsilon)(1+\\delta_1))(\\cos(\\tau)(1+\\delta_2))(1+\\delta_3) = \\exp(-\\epsilon)\\cos(\\tau)(1+\\delta_1)(1+\\delta_2)(1+\\delta_3)$\n令 $c_3 = \\exp(-\\epsilon)\\cos(\\tau)$。计算 $c_3$ 的相对误差是 $\\delta_{c_3} = \\frac{\\hat{c}_3 - c_3}{c_3} = (1+\\delta_1)(1+\\delta_2)(1+\\delta_3) - 1$。对于误差 $\\delta_i$ 的一阶近似，这是 $\\delta_{c_3} \\approx \\delta_1 + \\delta_2 + \\delta_3$。因此，$\\hat{c}_3 \\approx c_3(1+\\delta_{c_3})$。\n\n最后一步是从 $1$ 中减去。假设数字 $1$ 是精确表示的。\n$\\hat{K} = \\mathrm{fl}(1 - \\hat{c}_3) = (1 - \\hat{c}_3)(1+\\delta_4)$，其中 $|\\delta_4| \\leq u$。\n令 $K = 1 - c_3$ 为精确值。最终结果的绝对误差是 $E_{abs} = \\hat{K} - K$。\n$E_{abs} = (1 - \\hat{c}_3)(1+\\delta_4) - (1-c_3) = (1 - c_3(1+\\delta_{c_3}))(1+\\delta_4) - (1-c_3)$\n展开此表达式：\n$E_{abs} = (1 - c_3 - c_3\\delta_{c_3})(1+\\delta_4) - (1-c_3) = (K - c_3\\delta_{c_3})(1+\\delta_4) - K$\n$E_{abs} = K + K\\delta_4 - c_3\\delta_{c_3} - c_3\\delta_{c_3}\\delta_4 - K = K\\delta_4 - c_3\\delta_{c_3} - c_3\\delta_{c_3}\\delta_4$\n相对误差是 $E_{rel} = \\frac{E_{abs}}{K}$。对误差取一阶近似：\n$E_{rel} \\approx \\frac{K\\delta_4 - c_3\\delta_{c_3}}{K} = \\delta_4 - \\frac{c_3}{K} \\delta_{c_3}$\n\n当 $c_3 \\approx 1$ 时，会发生灾难性抵消，这使得 $K=1-c_3$ 很小。项 $\\frac{c_3}{K}$ 变得非常大，并放大了减法输入的相对误差 $\\delta_{c_3}$。“相对舍入误差的乘法放大”指的就是这个因子。\n放大因子 $= \\left|\\frac{c_3}{K}\\right| = \\left|\\frac{\\exp(-\\epsilon)\\cos(\\tau)}{1 - \\exp(-\\epsilon)\\cos(\\tau)}\\right|$。\n\n我们需要这个因子在 $\\epsilon \\ll 1$ 和 $\\tau \\ll 1$ 范围内的领先阶渐近表达式。我们使用泰勒级数展开：\n$\\exp(-\\epsilon) \\approx 1 - \\epsilon + \\frac{\\epsilon^2}{2} - O(\\epsilon^3)$\n$\\cos(\\tau) \\approx 1 - \\frac{\\tau^2}{2} + \\frac{\\tau^4}{24} - O(\\tau^6)$\n当 $\\epsilon, \\tau \\to 0$ 时，分子项 $c_3 = \\exp(-\\epsilon)\\cos(\\tau)$ 趋近于 $1$。\n分母是 $K(\\epsilon, \\tau) = 1 - \\exp(-\\epsilon)\\cos(\\tau)$。我们将其展开到二阶：\n$K(\\epsilon,\\tau) = 1 - \\left(1 - \\epsilon + \\frac{\\epsilon^2}{2} + \\dots\\right)\\left(1 - \\frac{\\tau^2}{2} + \\dots\\right)$\n$K(\\epsilon,\\tau) = 1 - \\left(1 - \\epsilon - \\frac{\\tau^2}{2} + \\frac{\\epsilon^2}{2} + \\frac{\\epsilon\\tau^2}{2} + \\dots\\right)$\n$K(\\epsilon,\\tau) = \\epsilon + \\frac{\\tau^2}{2} - \\frac{\\epsilon^2}{2} - \\dots$\n分母的主阶项是 $\\epsilon + \\frac{1}{2}\\tau^2$。\n因此，放大因子的渐近表达式为：\n$$\n\\frac{\\exp(-\\epsilon)\\cos(\\tau)}{1 - \\exp(-\\epsilon)\\cos(\\tau)} \\approx \\frac{1}{\\epsilon + \\frac{1}{2}\\tau^2}\n$$\n这就是问题第一部分所要求的表达式。\n\n其次，我们解决为状态空间表示寻找最优缩放因子 $s^{\\star}$ 的任务。目标是选择 $s>0$ 使得缩放后的无阻尼算子 $A_{0,s}$ 成为一个正规矩阵。无阻尼算子由下式给出：\n$$\nA_{0} = \\begin{pmatrix} 0  1 \\\\ -\\omega_{0}^{2}  0 \\end{pmatrix}\n$$\n状态通过相似变换矩阵 $T = \\mathrm{diag}(1,s)$ 进行缩放：\n$$\nT = \\begin{pmatrix} 1  0 \\\\ 0  s \\end{pmatrix}\n$$\n$T$ 的逆矩阵是：\n$$\nT^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  s^{-1} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{s} \\end{pmatrix}\n$$\n缩放后的算子 $A_{0,s}$ 由相似变换 $A_{0,s} = T A_{0} T^{-1}$ 给出：\n$$\nA_{0,s} = \\begin{pmatrix} 1  0 \\\\ 0  s \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -\\omega_{0}^{2}  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{s} \\end{pmatrix}\n$$\n$$\nA_{0,s} = \\begin{pmatrix} 1  0 \\\\ 0  s \\end{pmatrix} \\begin{pmatrix} 0  \\frac{1}{s} \\\\ -\\omega_{0}^{2}  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{1}{s} \\\\ -s\\omega_{0}^{2}  0 \\end{pmatrix}\n$$\n一个矩阵 $N$ 是正规的，如果它与其共轭转置交换，即 $N N^{\\dagger} = N^{\\dagger} N$。由于 $A_{0,s}$ 是一个实矩阵，其共轭转置 $A_{0,s}^{\\dagger}$ 就是其转置 $A_{0,s}^{T}$。\n$$\nA_{0,s}^{T} = \\begin{pmatrix} 0  -s\\omega_{0}^{2} \\\\ \\frac{1}{s}  0 \\end{pmatrix}\n$$\n我们计算乘积 $A_{0,s} A_{0,s}^{T}$ 和 $A_{0,s}^{T} A_{0,s}$：\n$$\nA_{0,s} A_{0,s}^{T} = \\begin{pmatrix} 0  \\frac{1}{s} \\\\ -s\\omega_{0}^{2}  0 \\end{pmatrix} \\begin{pmatrix} 0  -s\\omega_{0}^{2} \\\\ \\frac{1}{s}  0 \\end{pmatrix} = \\begin{pmatrix} (\\frac{1}{s})^2  0 \\\\ 0  (-s\\omega_{0}^{2})^2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{s^2}  0 \\\\ 0  s^2\\omega_{0}^{4} \\end{pmatrix}\n$$\n$$\nA_{0,s}^{T} A_{0,s} = \\begin{pmatrix} 0  -s\\omega_{0}^{2} \\\\ \\frac{1}{s}  0 \\end{pmatrix} \\begin{pmatrix} 0  \\frac{1}{s} \\\\ -s\\omega_{0}^{2}  0 \\end{pmatrix} = \\begin{pmatrix} (-s\\omega_{0}^{2})^2  0 \\\\ 0  (\\frac{1}{s})^2 \\end{pmatrix} = \\begin{pmatrix} s^2\\omega_{0}^{4}  0 \\\\ 0  \\frac{1}{s^2} \\end{pmatrix}\n$$\n要使 $A_{0,s}$ 为正规矩阵，我们必须有 $A_{0,s} A_{0,s}^{T} = A_{0,s}^{T} A_{0,s}$。令两个矩阵相等，得到对角元素的条件：\n$$\n\\frac{1}{s^2} = s^2\\omega_{0}^{4}\n$$\n整理各项，我们得到：\n$$\n1 = s^4 \\omega_{0}^{4} \\implies s^4 = \\frac{1}{\\omega_{0}^{4}}\n$$\n因为 $s > 0$ 且 $\\omega_0 > 0$，我们可以取两边的正实四次方根：\n$$\ns = \\sqrt[4]{\\frac{1}{\\omega_{0}^{4}}} = \\frac{1}{\\omega_0}\n$$\n这个 $s$ 值，记为 $s^{\\star}$，使矩阵成为正规矩阵。对于这个选择，$A_{0,s^{\\star}} = \\begin{pmatrix} 0  \\omega_0 \\\\ -\\omega_0  0 \\end{pmatrix}$，它是一个斜对称矩阵，因此是正规的。$A_{0,s}$ 的奇异值为 $\\sigma_1=s\\omega_0^2$ 和 $\\sigma_2=1/s$。条件数 $\\kappa_2(A_{0,s}) = \\max(\\sigma_1, \\sigma_2)/\\min(\\sigma_1, \\sigma_2)$ 在 $\\sigma_1=\\sigma_2$ 时最小化，这得出 $s\\omega_0^2=1/s$，或 $s=1/\\omega_0$。在这个值下，$\\kappa_2(A_{0,s^\\star}) = 1$，是可能的最小值。这证实了 $s^{\\star}=1/\\omega_0$ 是最优选择。$\\omega_0$ 的单位是时间的倒数（例如，rad/s），所以 $s^{\\star}$ 的单位是时间（例如，s），符合要求。",
            "answer": "$$\n\\boxed{\\frac{1}{\\omega_0}}\n$$"
        }
    ]
}