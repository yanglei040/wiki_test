{
    "hands_on_practices": [
        {
            "introduction": "To incorporate material dispersion into time-domain methods like the Finite-Difference Time-Domain (FDTD) method, we must translate the continuous differential equations governing polarization into discrete update equations. This first practice provides a foundational exercise in this process, guiding you through the derivation of an Auxiliary Differential Equation (ADE) update for the Debye model using a robust, second-order accurate centered-difference scheme . Mastering this technique is the first step toward accurately simulating wave propagation in realistic, lossy dielectrics.",
            "id": "3301054",
            "problem": "Consider a nonmagnetic, isotropic Debye dielectric described by the constitutive relation $\\,\\mathbf{D}(t)=\\epsilon_{0}\\,\\epsilon_{\\infty}\\,\\mathbf{E}(t)+\\mathbf{P}(t)\\,$, where the Debye polarization $\\,\\mathbf{P}(t)\\,$ obeys the first-order ordinary differential equation $\\,\\tau\\,\\dot{\\mathbf{P}}(t)+\\mathbf{P}(t)=\\epsilon_{0}\\,\\Delta\\epsilon\\,\\mathbf{E}(t)\\,$, with $\\,\\tau0\\,$ the relaxation time, $\\,\\epsilon_{0}\\,$ the vacuum permittivity, $\\,\\epsilon_{\\infty}\\,$ the high-frequency relative permittivity, and $\\,\\Delta\\epsilon=\\epsilon_{s}-\\epsilon_{\\infty}0\\,$ the static increment. In an Auxiliary Differential Equation (ADE) formulation embedded in the Finite-Difference Time-Domain (FDTD) method, one seeks a one-step update of the form $\\,\\mathbf{P}^{n+1}=\\alpha\\,\\mathbf{P}^{n}+\\beta\\,\\mathbf{E}^{n+1}+\\gamma\\,\\mathbf{E}^{n}\\,$ over a time step $\\,\\Delta t\\,$, where superscripts denote discrete time levels. Starting from Maxwell’s equations and the Debye constitutive law, derive the ADE-based FDTD polarization update by discretizing $\\,\\tau\\,\\dot{\\mathbf{P}}+\\mathbf{P}=\\epsilon_{0}\\,\\Delta\\epsilon\\,\\mathbf{E}\\,$ on the interval $[t^{n},t^{n+1}]$ using a second-order centered time-discretization: replace $\\,\\dot{\\mathbf{P}}\\,$ by the symmetric difference over the step and approximate non-derivative terms by their arithmetic average on $[t^{n},t^{n+1}]$. Express the resulting update explicitly in terms of $\\,\\mathbf{P}^{n},\\mathbf{E}^{n},\\mathbf{E}^{n+1}\\,$ and parameters $\\,\\tau,\\Delta t,\\epsilon_{0},\\Delta\\epsilon\\,$.\n\nThen, analyze the homogeneous part of this update (set the electric field forcing to zero) to extract the one-step amplification factor $\\,z_{\\text{Debye}}\\,$ that is the discrete-time pole corresponding to the continuous Debye pole $\\,s=-\\frac{1}{\\tau}\\,$. Using first principles of the centered discretization you applied, give a sufficient condition on the ratio $\\,\\Delta t/\\tau\\,$ such that the mapped discrete Debye pole lies strictly inside the unit circle in the complex plane.\n\nYour final reported quantity must be the closed-form analytic expression for the discrete Debye pole $\\,z_{\\text{Debye}}\\,$ as a function of $\\,\\Delta t\\,$ and $\\,\\tau\\,$. Do not include units in your final reported quantity. No rounding is required.",
            "solution": "The problem is subjected to validation before proceeding.\n\n### Step 1: Extract Givens\n- **Constitutive Relation**: $\\mathbf{D}(t)=\\epsilon_{0}\\,\\epsilon_{\\infty}\\,\\mathbf{E}(t)+\\mathbf{P}(t)$ for a nonmagnetic, isotropic Debye dielectric.\n- **Polarization ODE**: $\\tau\\,\\dot{\\mathbf{P}}(t)+\\mathbf{P}(t)=\\epsilon_{0}\\,\\Delta\\epsilon\\,\\mathbf{E}(t)$.\n- **Parameters**: $\\tau0$ (relaxation time), $\\epsilon_{0}$ (vacuum permittivity), $\\epsilon_{\\infty}$ (high-frequency relative permittivity), and $\\Delta\\epsilon=\\epsilon_{s}-\\epsilon_{\\infty}0$ (static increment).\n- **Target Update Form**: $\\mathbf{P}^{n+1}=\\alpha\\,\\mathbf{P}^{n}+\\beta\\,\\mathbf{E}^{n+1}+\\gamma\\,\\mathbf{E}^{n}$ over a time step $\\Delta t$.\n- **Discretization Method**: Second-order centered time-discretization on $[t^{n},t^{n+1}]$. $\\dot{\\mathbf{P}}$ is replaced by the symmetric difference, and non-derivative terms are approximated by their arithmetic average.\n- **Requested Analysis**: Derive the update equation for $\\mathbf{P}^{n+1}$, analyze its homogeneous part to find the discrete Debye pole $z_{\\text{Debye}}$, and provide a sufficient condition on $\\Delta t/\\tau$ for stability ($|z_{\\text{Debye}}|  1$).\n- **Final Reported Quantity**: The closed-form expression for $z_{\\text{Debye}}$ as a function of $\\Delta t$ and $\\tau$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is scientifically sound. The Debye model is a standard physical model for dielectric relaxation, and the Auxiliary Differential Equation (ADE) approach within the Finite-Difference Time-Domain (FDTD) method is a canonical topic in computational electromagnetics.\n- **Well-Posed**: The problem is well-posed. The instructions for discretization are specific and unambiguous, leading to a unique update equation. The subsequent stability analysis is a standard mathematical procedure.\n- **Objective**: The problem is stated in precise, objective language without any subjective or speculative elements.\n- **Conclusion**: All validation criteria are met. The problem is free of scientific flaws, ambiguities, or contradictions.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\nThe governing ordinary differential equation for the Debye polarization $\\mathbf{P}(t)$ is given as:\n$$\n\\tau\\,\\frac{d\\mathbf{P}(t)}{dt}+\\mathbf{P}(t)=\\epsilon_{0}\\,\\Delta\\epsilon\\,\\mathbf{E}(t)\n$$\nThe problem requires discretizing this equation using a second-order centered scheme on the time interval $[t^n, t^{n+1}]$. This is achieved by evaluating the equation at the midpoint in time, $t^{n+1/2} = t^n + \\frac{\\Delta t}{2}$.\n\nThe time derivative term $\\dot{\\mathbf{P}}(t)$ is approximated using a second-order accurate centered finite difference:\n$$\n\\frac{d\\mathbf{P}}{dt}\\bigg|_{t^{n+1/2}} \\approx \\frac{\\mathbf{P}^{n+1} - \\mathbf{P}^{n}}{\\Delta t}\n$$\nwhere $\\mathbf{P}^{k} \\equiv \\mathbf{P}(t^k)$ and $\\Delta t = t^{n+1} - t^n$.\n\nThe non-derivative terms $\\mathbf{P}(t)$ and $\\mathbf{E}(t)$ are approximated by their arithmetic average over the interval, which is also second-order accurate:\n$$\n\\mathbf{P}(t^{n+1/2}) \\approx \\frac{\\mathbf{P}^{n+1} + \\mathbf{P}^{n}}{2}\n$$\n$$\n\\mathbf{E}(t^{n+1/2}) \\approx \\frac{\\mathbf{E}^{n+1} + \\mathbf{E}^{n}}{2}\n$$\n\nSubstituting these discrete approximations into the continuous polarization ODE yields:\n$$\n\\tau \\left( \\frac{\\mathbf{P}^{n+1} - \\mathbf{P}^{n}}{\\Delta t} \\right) + \\frac{\\mathbf{P}^{n+1} + \\mathbf{P}^{n}}{2} = \\epsilon_{0}\\,\\Delta\\epsilon \\left( \\frac{\\mathbf{E}^{n+1} + \\mathbf{E}^{n}}{2} \\right)\n$$\nTo obtain the explicit update for $\\mathbf{P}^{n+1}$, we rearrange the equation by gathering terms with $\\mathbf{P}^{n+1}$ on the left-hand side and all other terms on the right-hand side:\n$$\n\\mathbf{P}^{n+1} \\left( \\frac{\\tau}{\\Delta t} + \\frac{1}{2} \\right) = \\mathbf{P}^{n} \\left( \\frac{\\tau}{\\Delta t} - \\frac{1}{2} \\right) + \\frac{\\epsilon_{0}\\,\\Delta\\epsilon}{2} \\left( \\mathbf{E}^{n+1} + \\mathbf{E}^{n} \\right)\n$$\nNow, we solve for $\\mathbf{P}^{n+1}$ by multiplying the entire equation by the inverse of the factor multiplying $\\mathbf{P}^{n+1}$:\n$$\n\\mathbf{P}^{n+1} = \\frac{\\frac{\\tau}{\\Delta t} - \\frac{1}{2}}{\\frac{\\tau}{\\Delta t} + \\frac{1}{2}} \\mathbf{P}^{n} + \\frac{\\frac{\\epsilon_{0}\\,\\Delta\\epsilon}{2}}{\\frac{\\tau}{\\Delta t} + \\frac{1}{2}} \\left( \\mathbf{E}^{n+1} + \\mathbf{E}^{n} \\right)\n$$\nSimplifying the coefficients by multiplying the numerator and denominator by $2\\Delta t$:\nThe coefficient of $\\mathbf{P}^n$ is:\n$$\n\\alpha = \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t}\n$$\nThe coefficient of the electric field term is:\n$$\n\\frac{\\epsilon_{0}\\,\\Delta\\epsilon\\,\\Delta t}{2\\tau + \\Delta t}\n$$\nThis gives the explicit update equation in the requested form $\\mathbf{P}^{n+1}=\\alpha\\,\\mathbf{P}^{n}+\\beta\\,\\mathbf{E}^{n+1}+\\gamma\\,\\mathbf{E}^{n}$:\n$$\n\\mathbf{P}^{n+1} = \\left( \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t} \\right) \\mathbf{P}^{n} + \\left( \\frac{\\epsilon_{0}\\,\\Delta\\epsilon\\,\\Delta t}{2\\tau + \\Delta t} \\right) \\mathbf{E}^{n+1} + \\left( \\frac{\\epsilon_{0}\\,\\Delta\\epsilon\\,\\Delta t}{2\\tau + \\Delta t} \\right) \\mathbf{E}^{n}\n$$\n\nNext, we analyze the homogeneous part of this update equation by setting the forcing term to zero, i.e., $\\mathbf{E}^{n} = \\mathbf{E}^{n+1} = \\mathbf{0}$. The homogeneous recurrence relation is:\n$$\n\\mathbf{P}^{n+1} = \\left( \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t} \\right) \\mathbf{P}^{n}\n$$\nThis is a first-order linear recurrence. The solution takes the form $\\mathbf{P}^n = (\\text{constant}) \\cdot z^n$. The one-step amplification factor $z$ is the ratio $\\mathbf{P}^{n+1}/\\mathbf{P}^{n}$. This factor is the discrete-time pole $z_{\\text{Debye}}$ corresponding to the continuous-time pole $s = -1/\\tau$. From the homogeneous equation, we can directly identify this pole:\n$$\nz_{\\text{Debye}} = \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t}\n$$\nThis is the required expression for the discrete Debye pole.\n\nFinally, we determine a sufficient condition on the ratio $\\Delta t/\\tau$ such that the pole lies strictly inside the unit circle, $|z_{\\text{Debye}}|  1$. This condition ensures the numerical stability of the polarization update.\n$$\n\\left| \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t} \\right|  1\n$$\nGiven that $\\tau  0$ and the time step $\\Delta t  0$, the denominator $2\\tau + \\Delta t$ is always positive. Therefore, the inequality simplifies to:\n$$\n|2\\tau - \\Delta t|  2\\tau + \\Delta t\n$$\nThis absolute value inequality is equivalent to the pair of inequalities:\n$$\n-(2\\tau + \\Delta t)  2\\tau - \\Delta t  2\\tau + \\Delta t\n$$\nWe analyze each inequality separately.\n1. Right-hand side: $2\\tau - \\Delta t  2\\tau + \\Delta t \\implies -\\Delta t  \\Delta t \\implies 0  2\\Delta t$. This is true for any non-zero time step $\\Delta t  0$.\n2. Left-hand side: $-(2\\tau + \\Delta t)  2\\tau - \\Delta t \\implies -2\\tau - \\Delta t  2\\tau - \\Delta t \\implies -2\\tau  2\\tau \\implies 0  4\\tau$. This is true because the problem statement specifies $\\tau  0$.\n\nBoth inequalities hold for any valid physical parameters $\\tau  0$ and any time step $\\Delta t  0$. This means that the centered-difference scheme (equivalent to the Crank-Nicolson or trapezoidal rule) is unconditionally stable for the Debye model. The magnitude of the discrete pole $|z_{\\text{Debye}}|$ is always strictly less than $1$. Therefore, any condition stipulating that $\\Delta t/\\tau$ is positive and finite is a sufficient condition for stability. For example, any $\\Delta t/\\tau  0$ is a sufficient condition.\n\nThe problem asks for the closed-form analytic expression for the discrete Debye pole, which has been derived.",
            "answer": "$$\n\\boxed{\\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t}}\n$$"
        },
        {
            "introduction": "While the centered-difference scheme is common, it is not the only way to discretize a dispersion model. This exercise advances your analytical skills by exploring the more complex Lorentz model, which describes resonant materials . You will derive and compare two distinct discretization methods—the bilinear transform and a forward-Euler ADE scheme—focusing on their crucial numerical properties: unconditional versus conditional stability and the accuracy of their phase response. This comparative analysis is essential for making informed choices when developing or using advanced simulation codes.",
            "id": "3301062",
            "problem": "Consider a single-resonance Lorentz dispersive polarization model in the time domain, where the material polarization $P(t)$ driven by an electric field $E(t)$ obeys the second-order ordinary differential equation\n$$\\ddot{P}(t) + \\gamma \\dot{P}(t) + \\omega_0^2 P(t) = \\alpha E(t),$$\nwith damping rate $\\gamma0$, resonance frequency $\\omega_00$, and coupling constant $\\alpha0$. In the Laplace domain with complex frequency $s$, the homogeneous (unforced) dynamics are governed by the characteristic polynomial $s^2 + \\gamma s + \\omega_0^2$, whose roots (continuous-time poles) are $s_{\\pm} = -\\gamma/2 \\pm j \\sqrt{\\omega_0^2 - \\gamma^2/4}$ for the underdamped case $0\\gamma2\\omega_0$.\n\nYou are asked to construct and analyze two discrete-time formulations used in computational electromagnetics:\n\n1) A bilinear-transform (also known as Tustin) discretization obtained by substituting the mapping\n$$s \\mapsto \\frac{2}{\\Delta t}\\,\\frac{1 - z^{-1}}{1 + z^{-1}}$$\ninto the characteristic polynomial and then clearing denominators to produce a causal $z$-domain denominator polynomial in powers of $z^{-1}$. Derive this polynomial explicitly, and express the discrete-time poles $z_{\\pm}$ in terms of the continuous-time poles $s_{\\pm}$ and the timestep $\\Delta t0$. Using only first principles and well-tested facts about Möbius mappings, establish the stability property of the bilinear-transform discretization for any $\\Delta t0$ when the continuous-time system is stable (that is, when $\\gamma0$ and $\\omega_00$).\n\n2) A forward-Euler auxiliary differential equation (ADE) scheme that first reduces the second-order model to a first-order system by introducing the auxiliary variable $J(t) = \\dot{P}(t)$:\n$$\\dot{P}(t) = J(t), \\qquad \\dot{J}(t) = -\\gamma J(t) - \\omega_0^2 P(t) + \\alpha E(t).$$\nDiscretize this system with the forward-Euler method at timestep $\\Delta t$ to obtain the homogeneous update in state-space form\n$$\\begin{pmatrix}P^{n+1} \\\\ J^{n+1}\\end{pmatrix} = \\mathbf{A}(\\Delta t)\\,\\begin{pmatrix}P^{n} \\\\ J^{n}\\end{pmatrix},$$\nidentify the $2\\times 2$ update matrix $\\mathbf{A}(\\Delta t)$ explicitly, and determine the spectral radius condition for stability in the underdamped regime $0\\gamma2\\omega_0$. From this, derive a closed-form upper bound on $\\Delta t$ that guarantees $|\\lambda|1$ for both eigenvalues of $\\mathbf{A}(\\Delta t)$.\n\nFinally, compare the small-timestep phase accuracy of the two schemes for the undamped case $\\gamma=0$ by examining a purely oscillatory response at angular frequency $\\omega=\\omega_0$:\n- For the bilinear-transform mapping, show that a purely imaginary continuous-time frequency $s=j\\omega$ maps to a unit-circle discrete-time frequency with per-step angle $\\Omega_{\\text{BLT}}(\\omega,\\Delta t)$, then expand $\\Omega_{\\text{BLT}}(\\omega,\\Delta t)$ in a Taylor series in the dimensionless parameter $\\omega \\Delta t$ up to and including the cubic term.\n- For the forward-Euler ADE scheme applied to the undamped oscillator, determine the discrete per-step angle $\\Omega_{\\text{FE}}(\\omega,\\Delta t)$ for the eigenvalue with positive imaginary part, and expand it similarly up to and including the cubic term.\n\nDefine the cubic phase error coefficient $c$ by writing $\\Omega(\\omega,\\Delta t) = \\omega \\Delta t - c\\,(\\omega \\Delta t)^3 + \\mathcal{O}((\\omega \\Delta t)^5)$ for each scheme. Compute the ratio $c_{\\text{BLT}}/c_{\\text{FE}}$.\n\nAnswer specification:\n- Provide as your final answer the row matrix containing two entries: the forward-Euler ADE maximum stable timestep in the underdamped regime and the ratio of cubic phase error coefficients,\n$$\\begin{pmatrix}\\Delta t_{\\max,\\text{FE}}  \\dfrac{c_{\\text{BLT}}}{c_{\\text{FE}}}\\end{pmatrix}.$$\n- No numerical substitution or rounding is required; keep the expressions in symbolic closed form. Express any angle quantities in radians.",
            "solution": "The problem statement is a valid, well-posed, and scientifically grounded exercise in the analysis of numerical methods for dispersive media in computational electromagnetics. It is self-contained and free of contradictions. I will proceed with a full solution.\n\nThe problem requires the analysis of two discretization schemes for the single-resonance Lorentz model, described by the second-order ordinary differential equation:\n$$\n\\ddot{P}(t) + \\gamma \\dot{P}(t) + \\omega_0^2 P(t) = \\alpha E(t)\n$$\nThe homogeneous dynamics are determined by the characteristic polynomial $s^2 + \\gamma s + \\omega_0^2 = 0$, where $s$ is the complex frequency. For a stable continuous-time system, the parameters must satisfy $\\gamma  0$ and $\\omega_0  0$, ensuring the roots (poles) $s_{\\pm}$ lie in the open left half of the complex plane, $\\text{Re}(s_{\\pm})  0$.\n\n**1. Bilinear-Transform (BLT) Discretization**\n\nFirst, we analyze the discretization based on the bilinear transform, which is defined by the mapping from the continuous-time complex frequency $s$ to the discrete-time complex variable $z$:\n$$\ns \\mapsto \\frac{2}{\\Delta t}\\,\\frac{1 - z^{-1}}{1 + z^{-1}}\n$$\n\nTo find the $z$-domain denominator polynomial, we substitute this mapping into the characteristic polynomial of the continuous-time system:\n$$\n\\left(\\frac{2}{\\Delta t}\\,\\frac{1 - z^{-1}}{1 + z^{-1}}\\right)^2 + \\gamma \\left(\\frac{2}{\\Delta t}\\,\\frac{1 - z^{-1}}{1 + z^{-1}}\\right) + \\omega_0^2 = 0\n$$\nTo clear the denominators, we multiply the entire equation by $(\\Delta t)^2 (1 + z^{-1})^2$:\n$$\n4(1 - z^{-1})^2 + 2\\gamma\\Delta t(1 - z^{-1})(1 + z^{-1}) + \\omega_0^2(\\Delta t)^2(1 + z^{-1})^2 = 0\n$$\nExpanding the squared and product terms yields:\n$$\n4(1 - 2z^{-1} + z^{-2}) + 2\\gamma\\Delta t(1 - z^{-2}) + \\omega_0^2(\\Delta t)^2(1 + 2z^{-1} + z^{-2}) = 0\n$$\nWe collect terms based on powers of $z^{-1}$:\n$$\n(4 + 2\\gamma\\Delta t + \\omega_0^2(\\Delta t)^2) + (-8 + 2\\omega_0^2(\\Delta t)^2)z^{-1} + (4 - 2\\gamma\\Delta t + \\omega_0^2(\\Delta t)^2)z^{-2} = 0\n$$\nThis is the causal $z$-domain denominator polynomial. The roots of this polynomial in $z^{-1}$ (or its reciprocal in $z$) are the discrete-time poles.\n\nTo express the discrete-time poles $z_{\\pm}$ in terms of the continuous-time poles $s_{\\pm}$, we must invert the bilinear transform mapping to solve for $z$ in terms of $s$:\n$$\ns = \\frac{2}{\\Delta t}\\,\\frac{z - 1}{z + 1} \\implies s\\Delta t(z+1) = 2(z-1) \\implies z(s\\Delta t - 2) = -s\\Delta t - 2\n$$\n$$\nz = \\frac{-s\\Delta t - 2}{s\\Delta t - 2} = \\frac{s\\Delta t/2 + 1}{-s\\Delta t/2 + 1} = \\frac{1 + s\\Delta t/2}{1 - s\\Delta t/2}\n$$\nThis is the Cayley transform. The discrete-time poles $z_{\\pm}$ are thus directly related to the continuous-time poles $s_{\\pm}$ by this mapping:\n$$\nz_{\\pm} = \\frac{1 + s_{\\pm} \\Delta t/2}{1 - s_{\\pm} \\Delta t/2}\n$$\n\nFor stability, we must show that if the continuous-time system is stable, the discrete-time system is also stable for any timestep $\\Delta t  0$. A stable continuous-time system has poles $s$ with $\\text{Re}(s)  0$. A stable discrete-time system has poles $z$ with $|z|  1$. We must prove that the mapping $z(s) = (1 + s\\Delta t/2)/(1 - s\\Delta t/2)$ maps the open left half-plane of $s$ to the open unit disk of $z$.\nLet $s = x + jy$ with $x  0$. We evaluate the magnitude squared of $z$:\n$$\n|z|^2 = \\left| \\frac{1 + (x+jy)\\Delta t/2}{1 - (x+jy)\\Delta t/2} \\right|^2 = \\frac{|(1 + x\\Delta t/2) + j(y\\Delta t/2)|^2}{|(1 - x\\Delta t/2) - j(y\\Delta t/2)|^2} = \\frac{(1 + x\\Delta t/2)^2 + (y\\Delta t/2)^2}{(1 - x\\Delta t/2)^2 + (y\\Delta t/2)^2}\n$$\nLet the numerator be $N$ and the denominator be $D$.\n$N = 1 + x\\Delta t + (x\\Delta t/2)^2 + (y\\Delta t/2)^2$\n$D = 1 - x\\Delta t + (x\\Delta t/2)^2 + (y\\Delta t/2)^2$\nThe difference is $N - D = 2x\\Delta t$. Since the continuous system is stable, its poles have a negative real part, $x = \\text{Re}(s)  0$. The timestep is positive, $\\Delta t  0$. Therefore, $N - D  0$, which implies $N  D$. As $D$ is a sum of squares and thus positive, we can conclude that $|z|^2 = N/D  1$. This implies $|z|1$.\nThis holds true regardless of the specific values of $s_{\\pm}$ as long as $\\text{Re}(s_{\\pm})  0$, and for any $\\Delta t  0$. Thus, the bilinear-transform discretization of a stable continuous-time Lorentz model is unconditionally stable.\n\n**2. Forward-Euler Auxiliary Differential Equation (ADE) Scheme**\n\nThe second-order model is reduced to a first-order system with variables $P(t)$ and $J(t) = \\dot{P}(t)$:\n$$\n\\dot{P}(t) = J(t)\n$$\n$$\n\\dot{J}(t) = -\\omega_0^2 P(t) - \\gamma J(t) + \\alpha E(t)\n$$\nWe discretize the homogeneous part ($\\alpha=0$) using the forward-Euler method, $y^{n+1} = y^n + \\Delta t \\dot{y}(t_n)$, where $y(t_n) = y^n$:\n$$\nP^{n+1} = P^n + \\Delta t J^n\n$$\n$$\nJ^{n+1} = J^n + \\Delta t (-\\omega_0^2 P^n - \\gamma J^n) = -\\omega_0^2 \\Delta t P^n + (1 - \\gamma \\Delta t) J^n\n$$\nIn matrix form, this update is $\\begin{pmatrix}P^{n+1} \\\\ J^{n+1}\\end{pmatrix} = \\mathbf{A}(\\Delta t)\\,\\begin{pmatrix}P^{n} \\\\ J^{n}\\end{pmatrix}$, where the update matrix $\\mathbf{A}(\\Delta t)$ is:\n$$\n\\mathbf{A}(\\Delta t) = \\begin{pmatrix} 1  \\Delta t \\\\ -\\omega_0^2 \\Delta t  1 - \\gamma \\Delta t \\end{pmatrix}\n$$\nFor the discrete system to be stable, the spectral radius of $\\mathbf{A}(\\Delta t)$ must be less than $1$, i.e., $\\rho(\\mathbf{A}) = \\max(|\\lambda_i|)  1$ for all eigenvalues $\\lambda_i$ of $\\mathbf{A}$. The eigenvalues are the roots of the characteristic equation $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$:\n$$\n(1-\\lambda)(1 - \\gamma\\Delta t - \\lambda) - (\\Delta t)(-\\omega_0^2 \\Delta t) = 0\n$$\n$$\n\\lambda^2 - (2 - \\gamma\\Delta t)\\lambda + (1 - \\gamma\\Delta t + \\omega_0^2(\\Delta t)^2) = 0\n$$\nIn the underdamped regime, $0  \\gamma  2\\omega_0$, the discriminant of this quadratic is negative, and the eigenvalues form a complex conjugate pair $\\lambda_{\\pm}$. For a complex conjugate pair of eigenvalues, $|\\lambda_+| = |\\lambda_-|$. The magnitude squared is the product of the roots, which is the constant term in the characteristic polynomial: $|\\lambda|^2 = \\lambda_+\\lambda_- = 1 - \\gamma\\Delta t + \\omega_0^2(\\Delta t)^2$.\nThe stability condition $|\\lambda|^2  1$ becomes:\n$$\n1 - \\gamma\\Delta t + \\omega_0^2(\\Delta t)^2  1\n$$\n$$\n\\omega_0^2(\\Delta t)^2 - \\gamma\\Delta t  0\n$$\nSince $\\Delta t  0$, we can divide by it:\n$$\n\\omega_0^2\\Delta t - \\gamma  0 \\implies \\omega_0^2\\Delta t  \\gamma\n$$\nThis gives the closed-form upper bound on the timestep for stability:\n$$\n\\Delta t  \\frac{\\gamma}{\\omega_0^2}\n$$\nThe maximum stable timestep is thus $\\Delta t_{\\max,\\text{FE}} = \\gamma/\\omega_0^2$.\n\n**3. Phase Accuracy Comparison**\n\nWe now compare the phase accuracy of the two schemes for the undamped case ($\\gamma=0$) at the resonance frequency $\\omega = \\omega_0$. The numerical phase per step is $\\Omega(\\omega, \\Delta t)$, and we seek the cubic error coefficient $c$ from the expansion $\\Omega(\\omega_0, \\Delta t) = \\omega_0 \\Delta t - c(\\omega_0 \\Delta t)^3 + \\mathcal{O}((\\omega_0 \\Delta t)^5)$.\n\nFor the bilinear transform, a continuous-time frequency $s=j\\omega$ is mapped to $z = \\exp(j\\Omega_{\\text{BLT}})$. The numerical angle is:\n$$\n\\Omega_{\\text{BLT}}(\\omega, \\Delta t) = \\arg\\left(\\frac{1 + j\\omega \\Delta t/2}{1 - j\\omega \\Delta t/2}\\right) = 2\\arctan\\left(\\frac{\\omega \\Delta t}{2}\\right)\n$$\nWe expand this for small $x = \\omega \\Delta t$. Using the Taylor series for $\\arctan(u) = u - u^3/3 + \\mathcal{O}(u^5)$:\n$$\n\\Omega_{\\text{BLT}}(\\omega, \\Delta t) = 2\\left[ \\frac{\\omega \\Delta t}{2} - \\frac{1}{3}\\left(\\frac{\\omega \\Delta t}{2}\\right)^3 + \\mathcal{O}((\\omega \\Delta t)^5) \\right] = \\omega \\Delta t - \\frac{1}{12}(\\omega \\Delta t)^3 + \\mathcal{O}((\\omega \\Delta t)^5)\n$$\nComparing with the prescribed form, we find the BLT cubic phase error coefficient to be $c_{\\text{BLT}} = 1/12$.\n\nFor the forward-Euler ADE scheme with $\\gamma=0$, the update matrix has eigenvalues $\\lambda_{\\pm} = 1 \\pm j\\omega_0 \\Delta t$. These are the discrete modes of the system. We select the eigenvalue with a positive imaginary part, $z_+ = 1 + j\\omega_0 \\Delta t$, and find its angle, which represents the numerical frequency per step, $\\Omega_{\\text{FE}}$.\n$$\n\\Omega_{\\text{FE}}(\\omega_0, \\Delta t) = \\arg(1 + j\\omega_0 \\Delta t) = \\arctan(\\omega_0 \\Delta t)\n$$\nWe expand this for small $x = \\omega_0 \\Delta t$:\n$$\n\\Omega_{\\text{FE}}(\\omega_0, \\Delta t) = \\omega_0 \\Delta t - \\frac{1}{3}(\\omega_0 \\Delta t)^3 + \\mathcal{O}((\\omega_0 \\Delta t)^5)\n$$\nThe FE-ADE cubic phase error coefficient is thus $c_{\\text{FE}} = 1/3$.\n\nFinally, we compute the ratio of these coefficients:\n$$\n\\frac{c_{\\text{BLT}}}{c_{\\text{FE}}} = \\frac{1/12}{1/3} = \\frac{1}{12} \\times 3 = \\frac{3}{12} = \\frac{1}{4}\n$$\n\nThe two quantities requested for the final answer are the maximum stable timestep for the forward-Euler ADE scheme in the underdamped regime, $\\Delta t_{\\max,\\text{FE}} = \\gamma/\\omega_0^2$, and the ratio of the cubic phase error coefficients, $c_{\\text{BLT}}/c_{\\text{FE}} = 1/4$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\gamma}{\\omega_0^2}  \\frac{1}{4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A correct algorithm is not enough; a physically meaningful simulation must also obey fundamental laws like energy conservation. Numerical discretizations, however, can sometimes introduce non-physical artifacts, such as artificial energy generation. This final practice bridges theory and implementation by tasking you with creating an energy-based passivity test for the Lorentz model . By deriving the model's energy balance and writing code to check for violations, you will develop a critical skill in computational physics: verifying that your numerical solution respects the underlying physics of the system.",
            "id": "3301071",
            "problem": "Consider a linear, homogeneous, isotropic dispersive medium whose electric displacement field satisfies $ \\mathbf{D}(t) = \\varepsilon_0 \\mathbf{E}(t) + \\mathbf{P}(t) $, where $ \\varepsilon_0 $ is the vacuum permittivity and $ \\mathbf{P}(t) $ is the polarization. In the single-resonance Lorentz model, the polarization obeys the ordinary differential equation\n$$\n\\frac{\\mathrm{d}^2 \\mathbf{P}}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} \\mathbf{P}}{\\mathrm{d} t} + \\omega_0^2 \\mathbf{P} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}(t),\n$$\nwhere $ \\gamma \\ge 0 $ is the damping rate (in $ \\mathrm{s}^{-1} $), $ \\omega_0  0 $ is the resonance angular frequency (in $ \\mathrm{rad/s} $), and $ \\omega_p  0 $ is the plasma angular frequency (in $ \\mathrm{rad/s} $). Assume $ \\mathbf{E}(t) $ and $ \\mathbf{P}(t) $ are colinear so that the dot products reduce to scalar products of magnitudes; denote the scalar electric field as $ E(t) $ and polarization as $ P(t) $.\n\nStarting from the Lorentz polarization equation and the constitutive relation, derive an energy balance that expresses the rate of work done by the electric field on the polarization,\n$$\nW(t) = E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t},\n$$\nin terms of a stored internal energy density $ U(t) $ and a nonnegative dissipative term. Use only fundamental laws and core definitions to construct this energy relation; do not invoke any pre-derived shortcut formulas. Based on this energy relation, define an energy-based test that verifies, for any numerically computed polarization $ P(t) $ driven by a specified $ E(t) $ over a finite interval $ [0, T] $ with zero initial polarization and velocity, that the total dissipated energy density\n$$\nP_{\\text{loss}} = \\int_{0}^{T} E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\,\\mathrm{d}t\n$$\nis never negative when the model parameters satisfy passivity ($ \\gamma \\ge 0 $, $ \\omega_0  0 $, $ \\omega_p  0 $) and the numerical scheme is energy-consistent. Your test must explicitly compute $ P_{\\text{loss} } $ in joules per cubic meter (J/m$^3$) and flag any discretization-induced violation where $ P_{\\text{loss}}  0 $ up to a clearly defined numerical tolerance.\n\nConstruct a complete algorithm as a runnable program to:\n- Simulate the Lorentz polarization dynamics using two different time-stepping schemes for the first-order state-space form $ \\dot{x}_1 = x_2 $, $ \\dot{x}_2 = -\\gamma x_2 - \\omega_0^2 x_1 + \\varepsilon_0 \\omega_p^2 E(t) $, with $ x_1 = P $, $ x_2 = \\dot{P} $:\n    1. The Crank–Nicolson (CN) method, which is second-order accurate and trapezoidal in time.\n    2. The Forward Euler method, which is first-order explicit.\n- Compute $ P_{\\text{loss}} $ using the trapezoidal rule for the integral $ \\int_0^T E(t)\\,\\dot{P}(t)\\,\\mathrm{d}t $.\n- Detect and report discretization-induced violations whenever the numerically computed $ P_{\\text{loss}} $ is negative below a tolerance. Define the violation criterion as follows: compute a scale $ S = \\varepsilon_0 E_0^2 T $ with $ E_0 $ the peak magnitude of $ E(t) $ and $ T $ the simulation duration, and set the tolerance to $ \\tau = 10^{-6} S $, with $ \\tau = 10^{-12} $ when $ E_0 = 0 $. Declare a violation if $ P_{\\text{loss}}  -\\tau $.\n\nUse the following test suite, which exercises a typical case, a coarse-time-step case prone to discretization issues, a zero-field edge case, and a no-damping boundary case. All quantities must be treated in International System of Units (SI), and the computed $ P_{\\text{loss}} $ must be in joules per cubic meter (J/m$^3$).\n\nLet $ \\varepsilon_0 = 8.854187817\\times 10^{-12} \\ \\mathrm{F/m} $, $ \\omega_0 = 2\\pi\\times 100\\times 10^9 \\ \\mathrm{rad/s} $, $ \\omega_p = 2\\pi\\times 200\\times 10^9 \\ \\mathrm{rad/s} $. For each case, use the specified $ \\gamma $, the scalar driving field\n$$\nE(t) = E_0 \\sin(\\omega_c t)\\,\\exp\\!\\left(-\\left(\\frac{t - T/2}{\\sigma}\\right)^2\\right),\n$$\nexcept for the zero-field case where $ E(t) \\equiv 0 $. The angle unit is radians for $ \\omega_c t $.\n\nTest suite:\n- Case A (energy-consistent baseline): CN method, $ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $, $ \\Delta t = 2.0\\times 10^{-12} \\ \\mathrm{s} $, $ \\gamma = 0.05\\,\\omega_0 $, $ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $, $ \\omega_c = 0.9\\,\\omega_0 $, $ \\sigma = T/6 $.\n- Case B (coarse step, explicit scheme): Forward Euler method, $ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $, $ \\Delta t = 1.0\\times 10^{-10} \\ \\mathrm{s} $, $ \\gamma = 0.001\\,\\omega_0 $, $ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $, $ \\omega_c = \\omega_0 $, $ \\sigma = T/6 $.\n- Case C (zero field edge case): CN method, $ T = 1.0\\times 10^{-9} \\ \\mathrm{s} $, $ \\Delta t = 5.0\\times 10^{-12} \\ \\mathrm{s} $, $ \\gamma = 0.05\\,\\omega_0 $, $ E_0 = 0 $, $ \\omega_c $ unused, $ \\sigma $ unused.\n- Case D (no damping boundary case): CN method, $ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $, $ \\Delta t = 2.0\\times 10^{-12} \\ \\mathrm{s} $, $ \\gamma = 0 $, $ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $, $ \\omega_c = \\omega_0 $, $ \\sigma = T/4 $.\n\nYour program must:\n1. Numerically integrate the Lorentz equations for each case with initial conditions $ P(0) = 0 $, $ \\dot{P}(0) = 0 $.\n2. Compute $ P_{\\text{loss}} $ in J/m$^3$ using the trapezoidal rule applied to $ E(t)\\,\\dot{P}(t) $ over $ [0, T] $.\n3. Determine whether a violation occurs using the specified tolerance rule.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a two-element list $ [P_{\\text{loss}}, \\text{violation}] $, where $ P_{\\text{loss} } $ is a float in J/m$^3$ and $ \\text{violation} $ is a boolean. For example, the final line must look like\n$$\n[ [P_{\\text{loss,A}},\\mathrm{True/False}], [P_{\\text{loss,B}},\\mathrm{True/False}], [P_{\\text{loss,C}},\\mathrm{True/False}], [P_{\\text{loss,D}},\\mathrm{True/False}] ]\n$$\nwith no spaces in the actual program output.",
            "solution": "The problem requires the derivation of an energy balance for the single-resonance Lorentz model of dielectric polarization and the implementation of a numerical test to verify the energy-consistency of two different time-stepping schemes.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- **Constitutive Relation:** $ \\mathbf{D}(t) = \\varepsilon_0 \\mathbf{E}(t) + \\mathbf{P}(t) $\n- **Lorentz Polarization ODE:** $ \\frac{\\mathrm{d}^2 \\mathbf{P}}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} \\mathbf{P}}{\\mathrm{d} t} + \\omega_0^2 \\mathbf{P} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}(t) $\n- **Scalar Assumption:** $ E(t) $ and $ P(t) $ are scalar magnitudes.\n- **Parameters:** Damping rate $ \\gamma \\ge 0 $, resonance angular frequency $ \\omega_0  0 $, plasma angular frequency $ \\omega_p  0 $.\n- **Work Rate Definition:** $ W(t) = E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t} $\n- **Total Dissipated Energy:** $ P_{\\text{loss}} = \\int_{0}^{T} E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\,\\mathrm{d}t $\n- **Initial Conditions:** $ P(0) = 0 $, $ \\dot{P}(0) = 0 $.\n- **State-Space Form:** $ \\dot{x}_1 = x_2 $, $ \\dot{x}_2 = -\\gamma x_2 - \\omega_0^2 x_1 + \\varepsilon_0 \\omega_p^2 E(t) $ with $ x_1 = P, x_2 = \\dot{P} $.\n- **Numerical Schemes:** Crank–Nicolson (CN) and Forward Euler (FE).\n- **Integration Method for $P_{\\text{loss}}$:** Trapezoidal rule.\n- **Violation Criterion:** Violation if $ P_{\\text{loss}}  -\\tau $, where the tolerance $ \\tau $ is defined by $ \\tau = 10^{-6} S $ with $ S = \\varepsilon_0 E_0^2 T $, and $ \\tau = 10^{-12} $ if $ E_0 = 0 $.\n- **Constants:** $ \\varepsilon_0 = 8.854187817\\times 10^{-12} \\ \\mathrm{F/m} $, $ \\omega_0 = 2\\pi\\times 100\\times 10^9 \\ \\mathrm{rad/s} $, $ \\omega_p = 2\\pi\\times 200\\times 10^9 \\ \\mathrm{rad/s} $.\n- **Driving Field:** $ E(t) = E_0 \\sin(\\omega_c t)\\,\\exp(-\\left(\\frac{t - T/2}{\\sigma}\\right)^2) $, except when $ E_0 = 0 $.\n- **Test Suite:**\n    - Case A: CN, $ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $, $ \\Delta t = 2.0\\times 10^{-12} \\ \\mathrm{s} $, $ \\gamma = 0.05\\,\\omega_0 $, $ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $, $ \\omega_c = 0.9\\,\\omega_0 $, $ \\sigma = T/6 $.\n    - Case B: FE, $ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $, $ \\Delta t = 1.0\\times 10^{-10} \\ \\mathrm{s} $, $ \\gamma = 0.001\\,\\omega_0 $, $ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $, $ \\omega_c = \\omega_0 $, $ \\sigma = T/6 $.\n    - Case C: CN, $ T = 1.0\\times 10^{-9} \\ \\mathrm{s} $, $ \\Delta t = 5.0\\times 10^{-12} \\ \\mathrm{s} $, $ \\gamma = 0.05\\,\\omega_0 $, $ E_0 = 0 $.\n    - Case D: CN, $ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $, $ \\Delta t = 2.0\\times 10^{-12} \\ \\mathrm{s} $, $ \\gamma = 0 $, $ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $, $ \\omega_c = \\omega_0 $, $ \\sigma = T/4 $.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing the standard single-resonance Lorentz model for dielectric dispersion, a cornerstone of classical optics and electromagnetism. The governing equation is a well-understood second-order linear ordinary differential equation (ODE). The concepts of work, stored energy, and dissipation are fundamental in physics. The task involves deriving an energy balance from first principles, which is a standard procedure. The numerical methods specified, Forward Euler and Crank-Nicolson, are canonical schemes for solving ODEs. The problem is well-posed: it provides a well-defined initial value problem with all necessary parameters, initial conditions, constants, and a specific functional form for the driving term. The language is objective and precise. The violation criterion is clearly and unambiguously defined. The problem is self-contained and internally consistent. It is a non-trivial exercise in computational physics that tests the understanding of both the physical model and the properties of the numerical methods used to simulate it.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\n### Derivation of the Energy Balance\n\nThe analysis begins with the scalar form of the Lorentz polarization equation:\n$$\n\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} P}{\\mathrm{d} t} + \\omega_0^2 P(t) = \\varepsilon_0 \\omega_p^2 E(t)\n$$\nThe rate of work done by the electric field on the polarization medium, per unit volume, is given by $ W(t) = E(t) \\frac{\\mathrm{d}P}{\\mathrm{d}t} $. To derive the energy balance, we first solve the Lorentz equation for $ E(t) $:\n$$\nE(t) = \\frac{1}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} P}{\\mathrm{d} t} + \\omega_0^2 P(t)\\right)\n$$\nSubstituting this expression into the work-rate equation yields:\n$$\nW(t) = \\frac{1}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} P}{\\mathrm{d} t} + \\omega_0^2 P(t)\\right) \\frac{\\mathrm{d} P}{\\mathrm{d} t}\n$$\nDistributing the term $ \\frac{\\mathrm{d}P}{\\mathrm{d}t} $:\n$$\nW(t) = \\frac{1}{\\varepsilon_0 \\omega_p^2} \\left[ \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right) \\left(\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2}\\right) + \\omega_0^2 P(t) \\frac{\\mathrm{d} P}{\\mathrm{d} t} \\right] + \\frac{\\gamma}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right)^2\n$$\nWe recognize that the terms in the square brackets are derivatives of quadratic forms:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d} t} \\left( \\frac{1}{2} \\left(\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right)^2 \\right) = \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right) \\left(\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2}\\right) \\quad \\text{and} \\quad \\frac{\\mathrm{d}}{\\mathrm{d} t} \\left( \\frac{1}{2}\\omega_0^2 P(t)^2 \\right) = \\omega_0^2 P(t) \\frac{\\mathrm{d} P}{\\mathrm{d} t}\n$$\nThis allows us to write the work-rate equation as:\n$$\nE(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t} = \\frac{\\mathrm{d}}{\\mathrm{d} t} \\left[ \\frac{1}{2\\varepsilon_0 \\omega_p^2} \\left( \\left(\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right)^2 + \\omega_0^2 P(t)^2 \\right) \\right] + \\frac{\\gamma}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right)^2\n$$\nThis equation is the desired energy balance. It states that the rate of work done by the field, $ W(t) $, is equal to the rate of change of the stored internal energy density, $ \\frac{\\mathrm{d}U}{\\mathrm{d}t} $, plus the rate of energy dissipation, $ Q_{\\text{diss}}(t) $. The terms are identified as:\n- Stored internal energy density: $ U(t) = \\frac{1}{2\\varepsilon_0 \\omega_p^2} \\left( \\left(\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right)^2 + \\omega_0^2 P(t)^2 \\right) $. This comprises a kinetic energy term (proportional to $ (\\dot{P})^2 $) and a potential energy term (proportional to $ P^2 $) associated with the bound charge oscillators.\n- Power dissipation density: $ Q_{\\text{diss}}(t) = \\frac{\\gamma}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right)^2 $. As the parameters $ \\gamma $ and $ \\varepsilon_0 \\omega_p^2 $ are non-negative, and $ (\\dot{P})^2 \\geq 0 $, the dissipation rate is always non-negative, consistent with the second law of thermodynamics.\n\n### Energy-Based Passivity Test\n\nTo find the total energy transferred from the field to the medium over the interval $ [0, T] $, we integrate the energy balance equation:\n$$\n\\int_{0}^{T} E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\,\\mathrm{d}t = \\int_{0}^{T} \\frac{\\mathrm{d}U}{\\mathrm{d}t}\\,\\mathrm{d}t + \\int_{0}^{T} \\frac{\\gamma}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right)^2 \\,\\mathrm{d}t\n$$\nThe left-hand side is the quantity $ P_{\\text{loss}} $. The first term on the right is $ U(T) - U(0) $. Thus,\n$$\nP_{\\text{loss}} = U(T) - U(0) + \\int_{0}^{T} Q_{\\text{diss}}(t) \\,\\mathrm{d}t\n$$\nGiven the initial conditions $ P(0) = 0 $ and $ \\dot{P}(0) = 0 $, the initial stored energy $ U(0) $ is zero. The equation simplifies to:\n$$\nP_{\\text{loss}} = U(T) + \\int_{0}^{T} Q_{\\text{diss}}(t) \\,\\mathrm{d}t\n$$\nSince both $ U(t) $ and $ Q_{\\text{diss}}(t) $ are non-negative for all $ t $, the total transferred energy $ P_{\\text{loss}} $ must be non-negative. A numerical scheme is energy-consistent if it preserves this property. Any computed $ P_{\\text{loss}}  0 $ (beyond a small numerical tolerance) indicates an unphysical, artificial generation of energy by the discretization scheme, thus a violation of passivity.\n\n### Numerical Algorithm Design\n\nThe second-order ODE is converted into a system of two first-order ODEs. Let the state vector be $ \\mathbf{x}(t) = [x_1(t), x_2(t)]^T = [P(t), \\dot{P}(t)]^T $. The system is:\n$$\n\\dot{\\mathbf{x}}(t) = \\mathbf{A} \\mathbf{x}(t) + \\mathbf{b} E(t), \\quad \\text{where} \\quad \\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ -\\omega_0^2  -\\gamma \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 0 \\\\ \\varepsilon_0 \\omega_p^2 \\end{pmatrix}\n$$\n\n**1. Forward Euler (FE) Method:** This is an explicit, first-order method. Given $ \\mathbf{x}^n \\approx \\mathbf{x}(n\\Delta t) $, the next state is:\n$$\n\\mathbf{x}^{n+1} = \\mathbf{x}^n + \\Delta t (\\mathbf{A} \\mathbf{x}^n + \\mathbf{b} E(t_n)) = (\\mathbf{I} + \\Delta t \\mathbf{A}) \\mathbf{x}^n + \\Delta t \\mathbf{b} E(t_n)\n$$\nwhere $ \\mathbf{I} $ is the $ 2 \\times 2 $ identity matrix. This scheme is only conditionally stable. For oscillatory systems, stability typically requires $ \\omega_0 \\Delta t \\ll 1 $. In Case B, $ \\omega_0 \\Delta t \\approx 6.28 \\times 10^{11} \\times 10^{-10} \\approx 62.8 $, grossly violating the stability condition. This is expected to cause numerical instability and a failure of the passivity test.\n\n**2. Crank-Nicolson (CN) Method:** This is an implicit, second-order method based on the trapezoidal rule:\n$$\n\\frac{\\mathbf{x}^{n+1} - \\mathbf{x}^n}{\\Delta t} = \\frac{1}{2} \\left[ (\\mathbf{A} \\mathbf{x}^n + \\mathbf{b} E(t_n)) + (\\mathbf{A} \\mathbf{x}^{n+1} + \\mathbf{b} E(t_{n+1})) \\right]\n$$\nRearranging to solve for $ \\mathbf{x}^{n+1} $ yields a linear system:\n$$\n\\left(\\mathbf{I} - \\frac{\\Delta t}{2} \\mathbf{A}\\right) \\mathbf{x}^{n+1} = \\left(\\mathbf{I} + \\frac{\\Delta t}{2} \\mathbf{A}\\right) \\mathbf{x}^n + \\frac{\\Delta t}{2} \\mathbf{b} (E(t_n) + E(t_{n+1}))\n$$\nThe CN method is unconditionally stable for this linear system and is known to be energy-preserving for conservative systems (i.e., when $ \\gamma=0 $). It is expected to pass the passivity test under the specified conditions.\n\n**Computation of $P_{\\text{loss}}$:** After numerically computing the time series for $ P(t_n) $ and $ \\dot{P}(t_n) $ from $ n=0 $ to $ N=T/\\Delta t $, we evaluate the integrand $ W_n = E(t_n)\\dot{P}(t_n) $. The integral is then approximated using the trapezoidal rule:\n$$\nP_{\\text{loss}} = \\int_0^T W(t)\\,\\mathrm{d}t \\approx \\sum_{n=0}^{N-1} \\frac{\\Delta t}{2}(W_n + W_{n+1})\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the simulation and analysis\n    for the specified test cases.\n    \"\"\"\n    # Define physical constants\n    EPS0 = 8.854187817e-12  # Vacuum permittivity in F/m\n    W0 = 2 * np.pi * 100e9   # Resonance angular frequency in rad/s\n    WP = 2 * np.pi * 200e9   # Plasma angular frequency in rad/s\n\n    # Define the test suite\n    test_cases = [\n        # Case A: CN, well-resolved, should pass\n        {\n            \"name\": \"A\", \"method\": \"CN\", \"T\": 2.0e-9, \"dt\": 2.0e-12,\n            \"gamma_factor\": 0.05, \"E0\": 1.0e5, \"wc_factor\": 0.9, \"sigma_factor\": 1/6\n        },\n        # Case B: FE, coarse step, should fail (unstable)\n        {\n            \"name\": \"B\", \"method\": \"FE\", \"T\": 2.0e-9, \"dt\": 1.0e-10,\n            \"gamma_factor\": 0.001, \"E0\": 1.0e5, \"wc_factor\": 1.0, \"sigma_factor\": 1/6\n        },\n        # Case C: CN, zero field, should yield zero loss\n        {\n            \"name\": \"C\", \"method\": \"CN\", \"T\": 1.0e-9, \"dt\": 5.0e-12,\n            \"gamma_factor\": 0.05, \"E0\": 0.0, \"wc_factor\": 1.0, \"sigma_factor\": 1/6\n        },\n        # Case D: CN, no damping, should pass (energy-conserving)\n        {\n            \"name\": \"D\", \"method\": \"CN\", \"T\": 2.0e-9, \"dt\": 2.0e-12,\n            \"gamma_factor\": 0.0, \"E0\": 1.0e5, \"wc_factor\": 1.0, \"sigma_factor\": 1/4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters\n        method = case[\"method\"]\n        T, dt = case[\"T\"], case[\"dt\"]\n        E0 = case[\"E0\"]\n        gamma = case[\"gamma_factor\"] * W0\n        wc = case[\"wc_factor\"] * W0\n        sigma = case[\"sigma_factor\"] * T\n\n        # Time grid\n        num_steps = int(round(T / dt))\n        t = np.linspace(0, T, num_steps + 1)\n\n        # Driving electric field\n        if E0 == 0:\n            E = np.zeros_like(t)\n        else:\n            E = E0 * np.sin(wc * t) * np.exp(-((t - T / 2) / sigma)**2)\n\n        # System matrices\n        A = np.array([[0, 1], [-W0**2, -gamma]])\n        b = np.array([0, EPS0 * WP**2])\n\n        # State vector initialization (X[0,:]=P, X[1,:]=P_dot)\n        X = np.zeros((2, num_steps + 1))\n        X[:, 0] = [0, 0] # Initial conditions P(0)=0, P_dot(0)=0\n\n        # Time stepping loop\n        if method == 'CN':\n            I = np.identity(2)\n            ML = I - 0.5 * dt * A\n            MR = I + 0.5 * dt * A\n            inv_ML = np.linalg.inv(ML)\n            update_mat_X = inv_ML @ MR\n            \n            for n in range(num_steps):\n                # The forcing term is also averaged\n                force_vec = 0.5 * dt * b * (E[n] + E[n+1])\n                X[:, n + 1] = update_mat_X @ X[:, n] + inv_ML @ force_vec\n\n        elif method == 'FE':\n            I = np.identity(2)\n            M_FE = I + dt * A\n            b_FE = dt * b\n\n            for n in range(num_steps):\n                X[:, n + 1] = M_FE @ X[:, n] + b_FE * E[n]\n        \n        # Extract derivative of polarization\n        P_dot = X[1, :]\n\n        # Calculate total absorbed/dissipated energy density\n        integrand = E * P_dot\n        P_loss = np.trapz(integrand, t)\n\n        # Violation check\n        if E0 == 0:\n            tolerance = 1e-12\n        else:\n            S = EPS0 * E0**2 * T\n            tolerance = 1e-6 * S\n        \n        violation = P_loss  -tolerance\n\n        results.append([P_loss, violation])\n\n    # Format the final output string\n    output_parts = [f\"[{r[0]},{'True' if r[1] else 'False'}]\" for r in results]\n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}