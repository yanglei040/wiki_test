{
    "hands_on_practices": [
        {
            "introduction": "在FDTD中模拟色散介质的基础，在于将连续的物理定律精确地转化为离散的更新方程。本练习将挑战你从第一性原理出发，为一种常见的介电弛豫模型——Debye介质，推导出这些更新方程。通过对极化电流和传导电流采用不同的数值近似方法，你将更深刻地理解简洁的更新系数是如何从底层的麦克斯韦-安培定律中产生的。",
            "id": "3331618",
            "problem": "考虑一个由单极点 Debye 弛豫建模的非磁性线性各向同性电介质，该电介质在交错 Yee 时间网格上使用时域有限差分 (FDTD) 方法进行模拟。设电场在整数时间 $t^{n} = n \\,\\Delta t$ 更新，磁场在半整数时间 $t^{n+\\frac{1}{2}} = \\left(n+\\tfrac{1}{2}\\right)\\Delta t$ 更新。本构关系为 $ \\mathbf{D}(t) = \\epsilon_{\\infty} \\mathbf{E}(t) + \\mathbf{P}(t) $，其中 $\\epsilon_{\\infty}$ 是高频介电常数，$\\mathbf{P}(t)$ 是极化密度，遵循 Debye 常微分方程\n$$\n\\frac{d \\mathbf{P}}{dt} = \\frac{\\Delta \\epsilon}{\\tau} \\,\\mathbf{E}(t) - \\frac{1}{\\tau}\\,\\mathbf{P}(t),\n$$\n其中 $\\Delta \\epsilon = \\epsilon_{s} - \\epsilon_{\\infty} \\ge 0$ 是介电常数的静态增量，$\\tau > 0$ 是弛豫时间。该介质可能是有损的，具有均匀电导率 $\\sigma \\ge 0$，产生传导电流密度 $\\mathbf{J}_{\\mathrm{c}}(t) = \\sigma \\mathbf{E}(t)$。忽略任何外加源。\n\n从时域中的 Maxwell–Ampère 定律出发，\n$$\n\\frac{\\partial \\mathbf{D}}{\\partial t} = \\nabla \\times \\mathbf{H} - \\mathbf{J}_{\\mathrm{c}},\n$$\n在以下建模和离散化假设下，推导在时间 $t^{n+1}$ 的电场 $\\mathbf{E}^{n+1}$ 的全显式更新方程，该方程用时间层 $t^{n}$ 和 $t^{n+\\frac{1}{2}}$ 的已知量表示。在您的推导中必须使用并论证所有这些假设：\n\n- 假设电场在此区间 $[t^{n}, t^{n+1}]$ 内于其交错更新层 $t^{n}$ 的值上是时间分段常数，通过对该区间进行精确时间积分来处理极化动力学。\n- 在时间 $[t^{n}, t^{n+1}]$ 上以与 Yee 网格交错一致的形式离散 Maxwell–Ampère 定律，使得 $\\mathbf{H}$ 的离散旋度在 $t^{n+\\frac{1}{2}}$ 计算，其余项在整数时间表示。\n- 为在存在传导的情况下保持二阶精度，使用时间上的梯形法则来近似该区间上的传导电流，即使用 $\\mathbf{E}^{n}$ 和 $\\mathbf{E}^{n+1}$ 的平均值。\n\n您的最终更新必须具有仿射形式\n$$\n\\mathbf{E}^{n+1} = C_{E}\\,\\mathbf{E}^{n} + C_{H}\\,\\left(\\nabla \\times \\mathbf{H}\\right)^{n+\\frac{1}{2}} + C_{P}\\,\\mathbf{P}^{n},\n$$\n其中标量系数 $C_{E}$、$C_{H}$ 和 $C_{P}$ 以 $\\epsilon_{\\infty}$、$\\Delta \\epsilon$、$\\tau$、$\\sigma$ 和 $\\Delta t$ 的闭式函数形式表示。将这三个系数报告为单个行向量。不代入任何数值；仅提供精确的解析表达式。答案必须无量纲，且必须精确表示，不得四舍五入。在您的推导中，从上述定律和定义出发，不要引用任何非从这些第一性原理推导出的预先推导的更新捷径。",
            "solution": "问题要求在一个由单极点 Debye 弛豫表征的有损、色散电介质中，推导电场 $\\mathbf{E}$ 的显式时域有限差分 (FDTD) 更新方程。推导必须从 Maxwell 方程组开始，并遵循特定的离散化假设。\n\n验证步骤确认了该问题具有科学依据、是适定的、客观的和完整的。它提出了一个计算电磁学中的标准、非平凡的任务。因此，我们开始求解。\n\n推导从 Maxwell–Ampère 定律开始，该定律给出为：\n$$\n\\frac{\\partial \\mathbf{D}}{\\partial t} = \\nabla \\times \\mathbf{H} - \\mathbf{J}_{\\mathrm{c}}\n$$\n此处，$\\mathbf{D}$ 是电位移场，$\\mathbf{H}$ 是磁场，$\\mathbf{J}_{\\mathrm{c}}$ 是传导电流密度。为在时间上离散此方程，我们在时间区间 $[t^{n}, t^{n+1}]$ 上对其进行积分，其中 $t^n = n \\Delta t$。\n$$\n\\int_{t^{n}}^{t^{n+1}} \\frac{\\partial \\mathbf{D}}{\\partial t} dt = \\int_{t^{n}}^{t^{n+1}} (\\nabla \\times \\mathbf{H}) dt - \\int_{t^{n}}^{t^{n+1}} \\mathbf{J}_{\\mathrm{c}} dt\n$$\n左侧由微积分基本定理精确计算：\n$$\n\\mathbf{D}(t^{n+1}) - \\mathbf{D}(t^{n}) = \\mathbf{D}^{n+1} - \\mathbf{D}^{n}\n$$\n对于右侧的项，我们应用指定的离散化规则。\n首先，磁场项与 Yee 网格一致地离散化，其中 $\\mathbf{H}$ 在半整数时间步长处计算。该积分通过假设被积函数在其区间中点 $t^{n+\\frac{1}{2}}$ 的值上是常数，使用中点法则进行近似，该法则是关于 $\\Delta t$ 二阶精确的：\n$$\n\\int_{t^{n}}^{t^{n+1}} (\\nabla \\times \\mathbf{H}) dt \\approx (\\nabla \\times \\mathbf{H})^{n+\\frac{1}{2}} \\, \\Delta t\n$$\n其次，如问题陈述中所指定，传导电流项积分使用梯形法则进行近似。这也是二阶精确的。给定 $\\mathbf{J}_{\\mathrm{c}}(t) = \\sigma \\mathbf{E}(t)$，我们有：\n$$\n\\int_{t^{n}}^{t^{n+1}} \\mathbf{J}_{\\mathrm{c}}(t) dt \\approx \\frac{\\Delta t}{2} \\left(\\mathbf{J}_{\\mathrm{c}}^{n} + \\mathbf{J}_{\\mathrm{c}}^{n+1}\\right) = \\frac{\\sigma \\Delta t}{2} \\left(\\mathbf{E}^{n} + \\mathbf{E}^{n+1}\\right)\n$$\n将这些近似代入积分后的 Maxwell-Ampère 定律，得到：\n$$\n\\mathbf{D}^{n+1} - \\mathbf{D}^{n} = (\\nabla \\times \\mathbf{H})^{n+\\frac{1}{2}} \\, \\Delta t - \\frac{\\sigma \\Delta t}{2} \\left(\\mathbf{E}^{n} + \\mathbf{E}^{n+1}\\right)\n$$\n接下来，我们引入 Debye 介质的本构关系：$\\mathbf{D}(t) = \\epsilon_{\\infty} \\mathbf{E}(t) + \\mathbf{P}(t)$。在时间步 $n$ 和 $n+1$ 应用此关系：\n$$\n\\mathbf{D}^n = \\epsilon_{\\infty} \\mathbf{E}^n + \\mathbf{P}^n\n$$\n$$\n\\mathbf{D}^{n+1} = \\epsilon_{\\infty} \\mathbf{E}^{n+1} + \\mathbf{P}^{n+1}\n$$\n将这些代入离散化的 Maxwell 方程，得到：\n$$\n(\\epsilon_{\\infty} \\mathbf{E}^{n+1} + \\mathbf{P}^{n+1}) - (\\epsilon_{\\infty} \\mathbf{E}^{n} + \\mathbf{P}^{n}) = (\\nabla \\times \\mathbf{H})^{n+\\frac{1}{2}} \\, \\Delta t - \\frac{\\sigma \\Delta t}{2} (\\mathbf{E}^{n} + \\mathbf{E}^{n+1})\n$$\n这个方程包含未知的极化 $\\mathbf{P}^{n+1}$。为找到其表达式，我们必须求解极化密度 $\\mathbf{P}(t)$ 的 Debye 常微分方程：\n$$\n\\frac{d \\mathbf{P}}{dt} = \\frac{\\Delta \\epsilon}{\\tau} \\mathbf{E}(t) - \\frac{1}{\\tau}\\mathbf{P}(t) \\implies \\frac{d \\mathbf{P}}{dt} + \\frac{1}{\\tau}\\mathbf{P}(t) = \\frac{\\Delta \\epsilon}{\\tau} \\mathbf{E}(t)\n$$\n问题要求在此区间 $[t^n, t^{n+1}]$ 上对该常微分方程进行精确积分，假设电场 $\\mathbf{E}(t)$ 在此区间内是分段常数，取其在区间开始时的值，即对于 $t \\in [t^n, t^{n+1}]$ 有 $\\mathbf{E}(t) = \\mathbf{E}^n$。在此假设下，该常微分方程成为一个带常数强迫项的一阶线性微分方程：\n$$\n\\frac{d \\mathbf{P}}{dt} + \\frac{1}{\\tau}\\mathbf{P}(t) = \\frac{\\Delta \\epsilon}{\\tau} \\mathbf{E}^n\n$$\n形如 $y'(t) + a y(t) = C$ 且初始条件为 $y(t_0) = y_0$ 的常微分方程的通解为 $y(t) = (y_0 - C/a) \\exp(-a(t-t_0)) + C/a$。这里，$y(t) = \\mathbf{P}(t)$，$a = 1/\\tau$，$C = (\\Delta \\epsilon / \\tau) \\mathbf{E}^n$，初始条件是 $\\mathbf{P}(t^n) = \\mathbf{P}^n$。项 $C/a$ 是 $\\Delta \\epsilon \\mathbf{E}^n$。\n该区间内 $\\mathbf{P}(t)$ 的解是：\n$$\n\\mathbf{P}(t) = \\left(\\mathbf{P}^n - \\Delta \\epsilon \\mathbf{E}^n\\right) \\exp\\left(-\\frac{t-t^n}{\\tau}\\right) + \\Delta \\epsilon \\mathbf{E}^n\n$$\n我们需要 $\\mathbf{P}^{n+1} = \\mathbf{P}(t^{n+1})$，通过令 $t = t^{n+1} = t^n + \\Delta t$ 得到：\n$$\n\\mathbf{P}^{n+1} = \\left(\\mathbf{P}^n - \\Delta \\epsilon \\mathbf{E}^n\\right) \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) + \\Delta \\epsilon \\mathbf{E}^n\n$$\n重新整理此式，得到极化的更新方程：\n$$\n\\mathbf{P}^{n+1} = \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) \\mathbf{P}^n + \\Delta \\epsilon \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\mathbf{E}^n\n$$\n现在我们将 $\\mathbf{P}^{n+1}$ 的这个表达式代回主离散化方程。首先，我们重新整理主方程以分离出包含 $\\mathbf{E}^{n+1}$ 的项：\n$$\n\\epsilon_{\\infty} \\mathbf{E}^{n+1} + \\frac{\\sigma \\Delta t}{2} \\mathbf{E}^{n+1} = \\epsilon_{\\infty} \\mathbf{E}^{n} - \\frac{\\sigma \\Delta t}{2} \\mathbf{E}^{n} + (\\nabla \\times \\mathbf{H})^{n+\\frac{1}{2}} \\, \\Delta t + \\mathbf{P}^n - \\mathbf{P}^{n+1}\n$$\n让我们计算 $\\mathbf{P}^n - \\mathbf{P}^{n+1}$ 这一项：\n$$\n\\mathbf{P}^n - \\mathbf{P}^{n+1} = \\mathbf{P}^n - \\left[ \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) \\mathbf{P}^n + \\Delta \\epsilon \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\mathbf{E}^n \\right]\n$$\n$$\n\\mathbf{P}^n - \\mathbf{P}^{n+1} = \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\mathbf{P}^n - \\Delta \\epsilon \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\mathbf{E}^n\n$$\n将此代入 $\\mathbf{E}^{n+1}$ 的方程中：\n$$\n\\left(\\epsilon_{\\infty} + \\frac{\\sigma \\Delta t}{2}\\right) \\mathbf{E}^{n+1} = \\left(\\epsilon_{\\infty} - \\frac{\\sigma \\Delta t}{2}\\right) \\mathbf{E}^{n} + (\\nabla \\times \\mathbf{H})^{n+\\frac{1}{2}} \\, \\Delta t + \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\mathbf{P}^n - \\Delta \\epsilon \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\mathbf{E}^n\n$$\n现在，我们将右侧 $\\mathbf{E}^n$ 的系数组合在一起：\n$$\n\\left(\\epsilon_{\\infty} + \\frac{\\sigma \\Delta t}{2}\\right) \\mathbf{E}^{n+1} = \\left[ \\left(\\epsilon_{\\infty} - \\frac{\\sigma \\Delta t}{2}\\right) - \\Delta \\epsilon \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\right] \\mathbf{E}^{n} + \\Delta t (\\nabla \\times \\mathbf{H})^{n+\\frac{1}{2}} + \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\mathbf{P}^n\n$$\n最后，我们通过除以左侧的因子来解出 $\\mathbf{E}^{n+1}$，以获得所需的仿射形式 $\\mathbf{E}^{n+1} = C_{E}\\,\\mathbf{E}^{n} + C_{H}\\,\\left(\\nabla \\times \\mathbf{H}\\right)^{n+\\frac{1}{2}} + C_{P}\\,\\mathbf{P}^{n}$。\n系数被确定为：\n$$\nC_{E} = \\frac{\\left(\\epsilon_{\\infty} - \\frac{\\sigma \\Delta t}{2}\\right) - \\Delta \\epsilon \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right)}{\\epsilon_{\\infty} + \\frac{\\sigma \\Delta t}{2}}\n$$\n$$\nC_{H} = \\frac{\\Delta t}{\\epsilon_{\\infty} + \\frac{\\sigma \\Delta t}{2}}\n$$\n$$\nC_{P} = \\frac{1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)}{\\epsilon_{\\infty} + \\frac{\\sigma \\Delta t}{2}}\n$$\n这些是 $\\mathbf{E}^{n+1}$ 显式更新方程的三个标量系数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\epsilon_{\\infty} - \\frac{\\sigma \\Delta t}{2} - \\Delta \\epsilon \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right)}{\\epsilon_{\\infty} + \\frac{\\sigma \\Delta t}{2}}  \\frac{\\Delta t}{\\epsilon_{\\infty} + \\frac{\\sigma \\Delta t}{2}}  \\frac{1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)}{\\epsilon_{\\infty} + \\frac{\\sigma \\Delta t}{2}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了辅助微分方程（ADE）方法，递归卷积（RC）为模拟频率色散提供了另一种强大的途径。本练习聚焦于分段线性递归卷积（PLRC）方法，要求你推导其更新权重，并分析一个关键的实际问题：截断卷积历史所引入的数值误差。这将让你对计算内存和仿真精度之间的权衡有一个实践性的认识。",
            "id": "3331560",
            "problem": "考虑一个在时域有限差分 (FDTD) 方法中建模的、无静态电导率的单极点 Debye 电介质。其位移场的本构关系为\n$$\n\\mathbf{D}(t) = \\epsilon_0 \\epsilon_{\\infty} \\mathbf{E}(t) + \\epsilon_0 \\Delta \\epsilon \\int_{0}^{t} \\frac{1}{\\tau} \\exp\\!\\left(-\\frac{t-t'}{\\tau}\\right) \\mathbf{E}(t')\\, dt',\n$$\n其中 $\\epsilon_0$ 是自由空间介电常数，$\\epsilon_{\\infty}$ 是光学极限相对介电常数，$\\Delta \\epsilon = \\epsilon_s - \\epsilon_{\\infty}$ 是 Debye 强度，$\\tau$ 是弛豫时间。定义归一化的 Debye 卷积积分为\n$$\nI(t) = \\int_{0}^{t} \\frac{1}{\\tau} \\exp\\!\\left(-\\frac{t-t'}{\\tau}\\right) E(t')\\, dt',\n$$\n使得 $\\mathbf{D}(t) = \\epsilon_0 \\epsilon_{\\infty} \\mathbf{E}(t) + \\epsilon_0 \\Delta \\epsilon\\, I(t)\\, \\hat{\\mathbf{e}}$，其中 $E(t)$ 是电场的单个笛卡尔分量，$\\hat{\\mathbf{e}}$ 是相应的单位向量。\n\n设 $t_n = n \\Delta t$，其中时间步长 $\\Delta t$ 为常数。在分段线性递归卷积 (PLRC) 方法中，$E(t)$ 在每个区间 $[t_{n-1}, t_n]$ 上被近似为线性函数。仅使用此线性近似和上述指数型 Debye 核，从第一性原理出发，为离散样本 $I^n \\equiv I(t_n)$ 推导出一个形如\n$$\nI^n = \\kappa\\, I^{n-1} + w_0 E^n + w_1 E^{n-1},\n$$\n的一步递归关系，其中权重 $w_0$ 和 $w_1$ 仅依赖于 $\\Delta t$ 和 $\\tau$，而 $\\kappa$ 是指数衰减因子。然后：\n\n1) 对于 $\\tau = 0.5\\ \\mathrm{ns}$ 和 $\\Delta t = 10\\ \\mathrm{ps}$，计算 PLRC 权重 $w_0$ 和 $w_1$ 的数值。将 $w_0$ 和 $w_1$ 作为无量纲数报告，并将每个值四舍五入至六位有效数字。\n\n2) 假设完整的 PLRC 历史在仅保留递归的最近 $M$ 项后被截断，即，比 $M$ 步更早的贡献被丢弃。假设离散电场样本对所有 $n$ 满足 $|E^n| \\le E_{\\max}$，其中 $E_{\\max}$ 是一个已知边界，单位为伏特/米。推导 $I^n$ 中截断误差大小的一个解析上界，该上界是 $M$、$\\Delta t$、$\\tau$ 和 $E_{\\max}$ 的函数。将您的边界表示为封闭形式的表达式，并且在最终边界中不包含单位。\n\n在您的推导中使用简写 $\\alpha \\equiv \\Delta t/\\tau$ 和 $\\kappa \\equiv \\exp(-\\alpha)$。您的最终答案必须包含一个单行矩阵，按顺序包含 $w_0$ 和 $w_1$ 的四舍五入数值，然后是您用 $M$、$\\Delta t$、$\\tau$ 和 $E_{\\max}$ 表示的封闭形式解析上界。",
            "solution": "该问题要求关于在 FDTD 中实现单极点 Debye 电介质模型的分段线性递归卷积 (PLRC) 的两个主要结果。首先，是递归更新系数的推导和数值计算。其次，是递归卷积截断误差的一个解析上界。\n\n第1部分：PLRC 递归关系和系数的推导\n\n归一化的 Debye 卷积积分由下式给出\n$$ I(t) = \\int_{0}^{t} \\frac{1}{\\tau} \\exp\\left(-\\frac{t-t'}{\\tau}\\right) E(t')\\, dt' $$\n我们希望为离散样本 $I^n \\equiv I(t_n)$ 找到一个递归关系，其中 $t_n = n\\Delta t$。\n我们可以通过在 $t' = t_{n-1}$ 处分割积分来写出 $I(t_n)$：\n$$ I^n = \\int_{0}^{t_{n-1}} \\frac{1}{\\tau} \\exp\\left(-\\frac{t_n-t'}{\\tau}\\right) E(t')\\, dt' + \\int_{t_{n-1}}^{t_n} \\frac{1}{\\tau} \\exp\\left(-\\frac{t_n-t'}{\\tau}\\right) E(t')\\, dt' $$\n让我们分析第一个积分项。通过提出对应一个时间步长的项，我们得到：\n$$ \\int_{0}^{t_{n-1}} \\frac{1}{\\tau} \\exp\\left(-\\frac{t_n-t_{n-1}}{\\tau}\\right) \\exp\\left(-\\frac{t_{n-1}-t'}{\\tau}\\right) E(t')\\, dt' $$\n$$ = \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) \\int_{0}^{t_{n-1}} \\frac{1}{\\tau} \\exp\\left(-\\frac{t_{n-1}-t'}{\\tau}\\right) E(t')\\, dt' $$\n这个表达式正好是 $\\exp(-\\Delta t/\\tau) I(t_{n-1})$。使用提供的简写 $\\kappa \\equiv \\exp(-\\Delta t/\\tau)$，该项为 $\\kappa I^{n-1}$。\n因此，递归关系开始为：\n$$ I^n = \\kappa I^{n-1} + \\int_{t_{n-1}}^{t_n} \\frac{1}{\\tau} \\exp\\left(-\\frac{t_n-t'}{\\tau}\\right) E(t')\\, dt' $$\n剩下的任务是计算最近时间区间 $[t_{n-1}, t_n]$ 上的积分。PLRC 方法将电场 $E(t')$ 在此区间上近似为一个线性函数：\n$$ E(t') \\approx E^{n-1} + \\frac{E^n - E^{n-1}}{\\Delta t} (t' - t_{n-1}) \\quad \\text{for } t_{n-1} \\le t' \\le t_n $$\n让我们将此代入积分。为方便起见，我们进行变量替换 $s = t_n - t'$，这意味着 $t' = t_n - s$ 且 $dt' = -ds$。积分限从 $t' \\in [t_{n-1}, t_n]$ 变为 $s \\in [\\Delta t, 0]$。\n积分变为：\n$$ \\Delta I^n = \\frac{1}{\\tau} \\int_{\\Delta t}^{0} \\exp\\left(-\\frac{s}{\\tau}\\right) \\left[ E^{n-1} + \\frac{E^n - E^{n-1}}{\\Delta t} (t_n - s - t_{n-1}) \\right] (-ds) $$\n$$ \\Delta I^n = \\frac{1}{\\tau} \\int_{0}^{\\Delta t} \\exp\\left(-\\frac{s}{\\tau}\\right) \\left[ E^{n-1} + \\frac{E^n - E^{n-1}}{\\Delta t} (\\Delta t - s) \\right] ds $$\n重新排列方括号中的项，按 $E^n$ 和 $E^{n-1}$ 分组：\n$$ E^{n-1} + (E^n - E^{n-1}) - \\frac{E^n - E^{n-1}}{\\Delta t}s = E^n - \\frac{E^n - E^{n-1}}{\\Delta t}s $$\n所以积分为：\n$$ \\Delta I^n = \\frac{1}{\\tau} \\int_{0}^{\\Delta t} \\exp\\left(-\\frac{s}{\\tau}\\right) \\left[ E^n - \\frac{E^n - E^{n-1}}{\\Delta t}s \\right] ds $$\n$$ \\Delta I^n = \\frac{E^n}{\\tau} \\int_{0}^{\\Delta t} \\exp\\left(-\\frac{s}{\\tau}\\right) ds - \\frac{E^n - E^{n-1}}{\\tau \\Delta t} \\int_{0}^{\\Delta t} s \\exp\\left(-\\frac{s}{\\tau}\\right) ds $$\n我们计算这两个定积分。\n第一个积分是：\n$$ \\int_{0}^{\\Delta t} \\exp\\left(-\\frac{s}{\\tau}\\right) ds = \\left[-\\tau \\exp\\left(-\\frac{s}{\\tau}\\right)\\right]_{0}^{\\Delta t} = \\tau\\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) $$\n第二个积分使用分部积分法计算，$\\int u dv = uv - \\int v du$，其中 $u=s$ 且 $dv = \\exp(-s/\\tau)ds$：\n$$ \\int_{0}^{\\Delta t} s \\exp\\left(-\\frac{s}{\\tau}\\right) ds = \\left[-s\\tau \\exp\\left(-\\frac{s}{\\tau}\\right)\\right]_{0}^{\\Delta t} + \\int_{0}^{\\Delta t} \\tau \\exp\\left(-\\frac{s}{\\tau}\\right)ds $$\n$$ = -\\Delta t \\tau \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) + \\tau \\left[ \\tau\\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) \\right] $$\n$$ = \\tau^2 \\left(1 - \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right) - \\Delta t \\tau \\exp\\left(-\\frac{\\Delta t}{\\tau}\\right) $$\n将这些结果代入 $\\Delta I^n$ 的表达式中：\n$$ \\Delta I^n = \\frac{E^n}{\\tau} \\left[\\tau(1-\\kappa)\\right] - \\frac{E^n - E^{n-1}}{\\tau \\Delta t} \\left[ \\tau^2(1-\\kappa) - \\Delta t \\tau \\kappa \\right] $$\n$$ \\Delta I^n = E^n (1-\\kappa) - \\left(E^n - E^{n-1}\\right) \\left[ \\frac{\\tau}{\\Delta t}(1-\\kappa) - \\kappa \\right] $$\n使用 $\\alpha \\equiv \\Delta t/\\tau$，这简化为：\n$$ \\Delta I^n = E^n (1-\\kappa) - \\left(E^n - E^{n-1}\\right) \\left[ \\frac{1-\\kappa}{\\alpha} - \\kappa \\right] $$\n我们现在可以识别 $E^n$ 和 $E^{n-1}$ 的系数来找到 $w_0$ 和 $w_1$：\n$$ \\Delta I^n = E^n \\left( (1-\\kappa) - \\left(\\frac{1-\\kappa}{\\alpha} - \\kappa\\right) \\right) + E^{n-1} \\left( \\frac{1-\\kappa}{\\alpha} - \\kappa \\right) $$\n系数为：\n$$ w_0 = 1 - \\kappa - \\frac{1-\\kappa}{\\alpha} + \\kappa = 1 - \\frac{1-\\kappa}{\\alpha} = 1 - \\frac{1-\\exp(-\\Delta t/\\tau)}{\\Delta t/\\tau} $$\n$$ w_1 = \\frac{1-\\kappa}{\\alpha} - \\kappa = \\frac{1-\\exp(-\\Delta t/\\tau)}{\\Delta t/\\tau} - \\exp(-\\Delta t/\\tau) $$\n完整的递归关系是 $I^n = \\kappa I^{n-1} + w_0 E^n + w_1 E^{n-1}$。\n\n对于数值计算，我们有 $\\tau = 0.5\\ \\mathrm{ns} = 0.5 \\times 10^{-9}\\ \\mathrm{s}$ 和 $\\Delta t = 10\\ \\mathrm{ps} = 10 \\times 10^{-12}\\ \\mathrm{s}$。\n无量纲参数 $\\alpha$ 是：\n$$ \\alpha = \\frac{\\Delta t}{\\tau} = \\frac{10 \\times 10^{-12}\\ \\mathrm{s}}{0.5 \\times 10^{-9}\\ \\mathrm{s}} = \\frac{10}{500} = 0.02 $$\n指数衰减因子 $\\kappa$ 是：\n$$ \\kappa = \\exp(-\\alpha) = \\exp(-0.02) \\approx 0.98019867 $$\n现在我们计算权重 $w_0$ 和 $w_1$：\n$$ w_0 = 1 - \\frac{1 - \\exp(-0.02)}{0.02} \\approx 1 - \\frac{1 - 0.98019867}{0.02} \\approx 1 - 0.99006634 = 0.00993366 $$\n$$ w_1 = \\frac{1 - \\exp(-0.02)}{0.02} - \\exp(-0.02) \\approx 0.99006634 - 0.98019867 = 0.00986767 $$\n使用更高精度并四舍五入至六位有效数字：\n$w_0 \\approx 0.00993367$\n$w_1 \\approx 0.00986766$\n\n第2部分：截断误差界\n\n完整的递归关系是 $I^n = \\kappa I^{n-1} + \\Delta I^n$，其中 $\\Delta I^n = w_0 E^n + w_1 E^{n-1}$。\n通过重复应用递归关系，我们可以用 $I^{n-M}$ 来表示 $I^n$：\n$$ I^n = \\kappa^M I^{n-M} + \\sum_{j=0}^{M-1} \\kappa^j \\Delta I^{n-j} $$\n在 $M$ 项后截断递归意味着我们忽略了早于 $t_{n-M}$ 的时间的贡献。这等同于在上述公式中设置 $I^{n-M}=0$，从而得到截断值 $I^n_{\\text{trunc}}$。\n$$ I^n_{\\text{trunc}} = \\sum_{j=0}^{M-1} \\kappa^j \\Delta I^{n-j} $$\n截断误差 $\\mathcal{E}^n$ 是精确值与截断值之间的差：\n$$ \\mathcal{E}^n = I^n - I^n_{\\text{trunc}} = \\kappa^M I^{n-M} $$\n为了找到该误差大小的上界，即 $|\\mathcal{E}^n| = \\kappa^M |I^{n-M}|$，我们需要 $|I^{n-M}|$ 的一个上界。\n根据卷积积分的定义：\n$$ I^{n-M} = I(t_{n-M}) = \\int_{0}^{t_{n-M}} \\frac{1}{\\tau} \\exp\\left(-\\frac{t_{n-M}-t'}{\\tau}\\right) E(t')\\, dt' $$\n给定电场大小有界，即对所有 $k$ 有 $|E^k| \\le E_{\\max}$。由于在 PLRC 方案中 $E(t')$ 是离散值之间的线性插值，其大小也受 $E_{\\max}$ 的限制：对所有 $t' \\ge 0$ 有 $|E(t')| \\le E_{\\max}$。\n取积分的绝对值：\n$$ |I^{n-M}| \\le \\int_{0}^{t_{n-M}} \\frac{1}{\\tau} \\left|\\exp\\left(-\\frac{t_{n-M}-t'}{\\tau}\\right) E(t')\\right|\\, dt' \\le \\frac{E_{\\max}}{\\tau} \\int_{0}^{t_{n-M}} \\exp\\left(-\\frac{t_{n-M}-t'}{\\tau}\\right) dt' $$\n该积分计算结果为：\n$$ \\int_{0}^{t_{n-M}} \\exp\\left(-\\frac{t_{n-M}-t'}{\\tau}\\right) dt' = \\left[\\tau \\exp\\left(-\\frac{t_{n-M}-t'}{\\tau}\\right)\\right]_{0}^{t_{n-M}} = \\tau (1 - \\exp(-t_{n-M}/\\tau)) $$\n因此，我们得到边界：\n$$ |I^{n-M}| \\le E_{\\max} \\left(1 - \\exp(-t_{n-M}/\\tau)\\right) $$\n对于长时间运行的仿真，$t_{n-M} \\to \\infty$，指数项消失。$I^{n-M}$ 的最坏情况大小在稳态直流极限 ($E(t)=E_{\\text{const}}$) 下达到，此时 $I(t) \\to E_{\\text{const}}$。因此上界是 $|I^{n-M}| \\le E_{\\max}$。\n将此代入误差表达式中：\n$$ |\\mathcal{E}^n| \\le \\kappa^M E_{\\max} = \\exp(-M \\Delta t/\\tau) E_{\\max} $$\n这就是所求的截断误差大小的解析上界。它是一个依赖于 $M$、$\\Delta t$、$\\tau$ 和 $E_{\\max}$ 的封闭形式表达式。\n最终答案需要这两个数值权重和这个误差界表达式。\n\n四舍五入至六位有效数字的数值：\n$w_0 = 1 - (1 - \\exp(-0.02))/0.02 \\approx 0.00993367$\n$w_1 = (1 - \\exp(-0.02))/0.02 - \\exp(-0.02) \\approx 0.00986766$\n\n解析误差界：$E_{\\max} \\exp(-M \\Delta t / \\tau)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.00993367  0.00986766  E_{\\max} \\exp\\left(-\\frac{M \\Delta t}{\\tau}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "精确的FDTD建模不仅在于时间上的更新，还在于如何正确处理空间上的复杂性，尤其是在那些横穿网格的材料交界面处。本练习将探讨一项关键任务：如何为一个包含电介质分界面的“混合”单元分配合理的等效材料参数。通过比较简单的体积加权平均与更精细的边加权方案，你将量化这些选择如何影响在交界面处物理边界条件的执行精度。",
            "id": "3331577",
            "problem": "考虑一个用于时域有限差分 (FDTD) 方法的二维 Yee 元胞，FDTD 是一种用于求解时域麦克斯韦方程组的交错网格算法。该正方形元胞边长为 $\\Delta$，在 $(x,y)$ 平面内的顶点坐标为 $(\\pm \\Delta/2, \\pm \\Delta/2)$。一个平面材料界面沿直线 $\\hat{\\mathbf{n}}\\cdot \\mathbf{r} = 0$ 切割该元胞，该直线穿过元胞中心。其中，单位法向量为 $\\hat{\\mathbf{n}} = (\\cos \\theta, \\sin \\theta)$，$\\theta$ 是法向量相对于 $x$ 轴的夹角（以弧度为单位）。在 $\\hat{\\mathbf{n}}\\cdot \\mathbf{r}  0$ 一侧的介质，其介电常数为 $\\epsilon_1$，电导率为 $\\sigma_1$；在 $\\hat{\\mathbf{n}}\\cdot \\mathbf{r}  0$ 一侧的介质，其介电常数为 $\\epsilon_2$，电导率为 $\\sigma_2$。假设存在一个角频率为 $\\omega = 2\\pi f$（频率 $f$ 的单位为 $\\mathrm{Hz}$）的时谐场，并定义复介电常数 $\\epsilon_c = \\epsilon - i \\sigma/\\omega$ 以统一处理无损和有损材料。\n\n在用于二维横磁 (TM) 配置（磁场垂直于平面）的 Yee 元胞中，平面内电场由位于正方形四条边中心的分量表示：上边位于 $y = \\Delta/2$，下边位于 $y = -\\Delta/2$，左边位于 $x = -\\Delta/2$，右边位于 $x = \\Delta/2$。当界面切割元胞时，为以边为中心的电场更新分配材料属性需要一种插值策略。考虑两种策略：\n\n1. 体积加权插值：通过根据元胞内两种介质的面积分数对 $\\epsilon_{c,1}$ 和 $\\epsilon_{c,2}$进行加权，为所有边分配一个单一的有效复介电常数。对于穿过正方形中心的直线界面，每种介质的面积分数均为 $1/2$，因此有效复介电常数为 $\\epsilon_{c,\\mathrm{vol}} = \\frac{1}{2}\\epsilon_{c,1} + \\frac{1}{2}\\epsilon_{c,2}$。\n\n2. 边加权插值：通过根据每条边在两种介质中所占的边长分数对 $\\epsilon_{c,1}$ 和 $\\epsilon_{c,2}$ 进行加权，为每条边分配一个有效复介电常数。对于给定的一条边 $e$，其端点为 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$，定义有符号值 $s_1 = \\hat{\\mathbf{n}}\\cdot \\mathbf{r}_1$ 和 $s_2 = \\hat{\\mathbf{n}}\\cdot \\mathbf{r}_2$。位于 $\\hat{\\mathbf{n}}\\cdot \\mathbf{r}  0$ 介质中的边长分数（记为 $f_e$）定义如下：如果 $s_1  0$ 且 $s_2  0$，则 $f_e = 1$；如果 $s_1  0$ 且 $s_2  0$，则 $f_e = 0$；如果 $s_1$ 和 $s_2$ 符号相反，则 $f_e$ 等于 $\\hat{\\mathbf{n}}\\cdot \\mathbf{r}  0$ 的线段部分所占的分数，即如果 $s_2  0$ 则 $f_e = s_2/(s_2 - s_1)$，如果 $s_1  0$ 则 $f_e = -s_1/(s_2 - s_1)$。如果 $s_1 = s_2 = 0$，则设 $f_e = 1/2$。那么，边 $e$ 的边加权有效复介电常数为 $\\epsilon_{c,\\mathrm{edge}}(e) = (1 - f_e)\\epsilon_{c,1} + f_e \\epsilon_{c,2}$。\n\n在斜角处边界条件的执行情况通过无自由表面电荷时的法向通量连续性条件来量化，即广义法向通量 $\\epsilon_c E_n$ 跨界面的连续性，其中 $E_n$ 是电场相对于 $\\hat{\\mathbf{n}}$ 的法向分量。如果两种介质中的真实场为 $\\mathbf{E}_1 = E_t \\hat{\\mathbf{t}} + E_{n,1} \\hat{\\mathbf{n}}$ 和 $\\mathbf{E}_2 = E_t \\hat{\\mathbf{t}} + E_{n,2} \\hat{\\mathbf{n}}$，其中 $\\hat{\\mathbf{t}} = (-\\sin \\theta, \\cos \\theta)$ 是单位切向量，那么精确的连续性条件得出 $E_{n,2} = (\\epsilon_{c,1}/\\epsilon_{c,2}) E_{n,1}$，而切向分量 $E_t$ 是连续的。跨越两种介质的边 $e$ 上的离散 Yee 边变量无法表示法向分量的跳变；相反，单个边值隐含地表示了沿该边的加权平均值：$E_{n,\\mathrm{edge}}(e) = (1 - f_e) E_{n,1} + f_e E_{n,2}$。定义参考法向通量 $D_{n,0} = \\epsilon_{c,1} E_{n,1}$，根据连续性条件，它也等于 $\\epsilon_{c,2} E_{n,2}$。在选定的为边分配 $\\epsilon_{c,\\mathrm{eff}}$ 的插值策略下，边 $e$ 上的离散化法向通量为 $\\epsilon_{c,\\mathrm{eff}}(e) E_{n,\\mathrm{edge}}(e)$。边 $e$ 上的归一化残差为\n$$\nr_e = \\left| \\frac{\\epsilon_{c,\\mathrm{eff}}(e) E_{n,\\mathrm{edge}}(e)}{D_{n,0}} - 1 \\right|,\n$$\n其中 $|\\cdot|$ 表示复数的模。通过计算均方根值来汇总所有四条边的执行误差\n$$\nR = \\sqrt{ \\frac{1}{4} \\sum_{e \\in \\{\\mathrm{top}, \\mathrm{bottom}, \\mathrm{left}, \\mathrm{right}\\}} r_e^2 }.\n$$\n计算体积加权策略的 $R_{\\mathrm{vol}}$ 和边加权策略的 $R_{\\mathrm{edge}}$，前者对所有边使用 $\\epsilon_{c,\\mathrm{eff}}(e) = \\epsilon_{c,\\mathrm{vol}}$，后者对每条边使用各自的 $\\epsilon_{c,\\mathrm{edge}}(e)$。使用 $E_{n,1} = 1$（单位为 $\\mathrm{V/m}$），因此 $D_{n,0} = \\epsilon_{c,1}$。\n\n设计一个程序，对于给定的一组参数 $(\\Delta,\\theta,\\epsilon_1,\\sigma_1,\\epsilon_2,\\sigma_2,f)$，计算 $R_{\\mathrm{vol}}$ 和 $R_{\\mathrm{edge}}$ 作为无量纲浮点数。角度必须以弧度为单位，介电常数以 $\\mathrm{F}/\\mathrm{m}$ 为单位，电导率以 $\\mathrm{S}/\\mathrm{m}$ 为单位，频率以 $\\mathrm{Hz}$ 为单位，$\\Delta$ 以 $\\mathrm{m}$ 为单位。\n\n测试套件：\n使用真空介电常数 $\\epsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F}/\\mathrm{m}$。在所有情况下，令 $\\Delta = 1\\,\\mathrm{m}$。评估以下四个测试用例：\n\n1. 斜角、中等对比度、弱损耗：$\\theta = \\pi/4$, $\\epsilon_1 = 2.5 \\epsilon_0$, $\\sigma_1 = 0$, $\\epsilon_2 = 6 \\epsilon_0$, $\\sigma_2 = 0.01$, $f = 1\\times 10^{9}$。\n\n2. 界面法线沿 x 轴、无损耗：$\\theta = 0$, $\\epsilon_1 = 1 \\epsilon_0$, $\\sigma_1 = 0$, $\\epsilon_2 = 4 \\epsilon_0$, $\\sigma_2 = 0$, $f = 5\\times 10^{9}$。\n\n3. 界面法线沿 y 轴、非对称损耗：$\\theta = \\pi/2$, $\\epsilon_1 = 2 \\epsilon_0$, $\\sigma_1 = 0.1$, $\\epsilon_2 = 10 \\epsilon_0$, $\\sigma_2 = 0$, $f = 1\\times 10^{8}$。\n\n4. 高斜角 ($80^\\circ$)、高对比度和高损耗：$\\theta = 80\\pi/180$, $\\epsilon_1 = 1.5 \\epsilon_0$, $\\sigma_1 = 0$, $\\epsilon_2 = 12 \\epsilon_0$, $\\sigma_2 = 0.5$, $f = 2\\times 10^{9}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个含四个元素的列表，每个元素对应一个测试用例，并且每个元素都是一个双元素列表 $[R_{\\mathrm{vol}}, R_{\\mathrm{edge}}]$（按此顺序）。例如，打印输出的格式必须为 $[[r_{1,\\mathrm{vol}},r_{1,\\mathrm{edge}}],[r_{2,\\mathrm{vol}},r_{2,\\mathrm{edge}}],[r_{3,\\mathrm{vol}},r_{3,\\mathrm{edge}}],[r_{4,\\mathrm{vol}},r_{4,\\mathrm{edge}}]]$，所有值均为无量纲浮点数。",
            "solution": "该问题要求分析和比较在计算电磁学中，时域有限差分 (FDTD) 方法所使用的两种不同的材料参数插值方案。该比较基于一个度量标准，该标准量化了在穿过单个 Yee 元胞的平面介质界面上，电场法向分量的电磁边界条件的违背程度。\n\n### 基本原理：边界条件\n\n在没有自由表面电荷的两种介质之间的平面界面上，麦克斯韦方程组对电场 $\\mathbf{E}$ 和电位移场 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 施加了连续性条件。电场的切向分量 $E_t$ 是连续的。电位移场的法向分量 $D_n$ 也是连续的。对于角频率为 $\\omega$ 的时谐场，在介电常数为 $\\epsilon$、电导率为 $\\sigma$ 的有损介质中，这些性质可以方便地使用复介电常数 $\\epsilon_c = \\epsilon - i \\sigma/\\omega$ 来描述。电位移场变为 $\\mathbf{D} = \\epsilon_c \\mathbf{E}$。\n\n$\\mathbf{D}$ 的法向分量跨越介质1和介质2之间界面的连续性表示为 $D_{n,1} = D_{n,2}$，这意味着：\n$$\n\\epsilon_{c,1} E_{n,1} = \\epsilon_{c,2} E_{n,2}\n$$\n此处，$E_{n,1}$ 和 $E_{n,2}$ 是界面两侧电场的法向分量。此关系表明，电场法向分量 $E_n$ 通常是不连续的。法向位移通量的参考值取为 $D_{n,0} = \\epsilon_{c,1} E_{n,1}$。问题设定 $E_{n,1} = 1\\,\\mathrm{V/m}$，因此 $D_{n,0} = \\epsilon_{c,1}$。\n\n### 数值离散化与平均\n\nFDTD 方法在交错网格（Yee 网格）上对空间进行离散化。在二维横磁 (TM) 仿真中，电场分量 ($E_x$, $E_y$) 位于元胞边的中心。当一个界面穿过一个元胞时，边上的单个离散场值必须代表两种不同介质中的场行为。这就需要在该位置为 FDTD 更新方程设置一个有效的材料参数。\n\n问题定义了两种策略来确定边长为 $\\Delta$ 的正方形 Yee 元胞四条边上电场分量的有效复介电常数 $\\epsilon_{c,\\mathrm{eff}}$。该界面穿过元胞中心 $(0,0)$，并由 $\\hat{\\mathbf n} \\cdot \\mathbf r = 0$ 定义，其中 $\\hat{\\mathbf n} = (\\cos\\theta, \\sin\\theta)$。\n\n### 插值策略\n\n1.  **体积加权平均：** 根据元胞内两种介质的面积分数计算出单一的有效介电常数。由于界面穿过中心，两种介质的面积相等。\n    $$\n    \\epsilon_{c,\\mathrm{vol}} = \\frac{1}{2}\\epsilon_{c,1} + \\frac{1}{2}\\epsilon_{c,2}\n    $$\n    此值用于所有四条边，无论它们如何被界面切割。\n\n2.  **边加权平均：** 根据每条边在各介质中的长度分数，为每条边单独计算有效介电常数。对于边 $e$，令 $f_e$ 为其在介质 2（$\\hat{\\mathbf{n}}\\cdot \\mathbf{r}  0$ 的区域）中的长度分数。该边的有效介电常数为：\n    $$\n    \\epsilon_{c,\\mathrm{edge}}(e) = (1 - f_e)\\epsilon_{c,1} + f_e \\epsilon_{c,2}\n    $$\n    分数 $f_e$ 是通过计算边端点 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$ 处的 $s = \\hat{\\mathbf{n}}\\cdot\\mathbf{r}$ 来确定的。令 $s_1 = \\hat{\\mathbf{n}}\\cdot\\mathbf{r}_1$ 和 $s_2 = \\hat{\\mathbf{n}}\\cdot\\mathbf{r}_2$。如果边被切割，交点会将其分成两段。分数 $f_e$ 是位于介质 2 中的线段长度与总边长的比值。这可以通过线性插值计算得出。\n\n### 误差度量公式\n\n跨越界面的边上的离散场变量无法表示法向场分量 $E_n$ 的不连续跳变。该问题将边上的有效法向场建模为加权平均值：\n$$\nE_{n,\\mathrm{edge}}(e) = (1 - f_e) E_{n,1} + f_e E_{n,2}\n$$\n使用连续性条件 $E_{n,2} = (\\epsilon_{c,1}/\\epsilon_{c,2}) E_{n,1}$ 并设定 $E_{n,1}=1$，上式变为：\n$$\nE_{n,\\mathrm{edge}}(e) = (1 - f_e) + f_e \\frac{\\epsilon_{c,1}}{\\epsilon_{c,2}}\n$$\n边上的离散化法向通量则为 $D_{n,\\mathrm{discr}}(e) = \\epsilon_{c,\\mathrm{eff}}(e) E_{n,\\mathrm{edge}}(e)$。插值方案的质量通过此离散通量逼近真实连续通量 $D_{n,0} = \\epsilon_{c,1}$ 的程度来衡量。边 $e$ 的归一化残差定义为：\n$$\nr_e = \\left| \\frac{D_{n,\\mathrm{discr}}(e)}{D_{n,0}} - 1 \\right| = \\left| \\frac{\\epsilon_{c,\\mathrm{eff}}(e) E_{n,\\mathrm{edge}}(e)}{\\epsilon_{c,1}} - 1 \\right|\n$$\n代入 $E_{n,\\mathrm{edge}}(e)$ 的表达式：\n$$\nr_e = \\left| \\frac{\\epsilon_{c,\\mathrm{eff}}(e)}{\\epsilon_{c,1}} \\left( (1 - f_e) + f_e \\frac{\\epsilon_{c,1}}{\\epsilon_{c,2}} \\right) - 1 \\right|\n$$\n\n对于**体积加权**方案，所有边的 $\\epsilon_{c,\\mathrm{eff}}(e) = \\epsilon_{c,\\mathrm{vol}}$，并且使用相应的 $f_e$ 计算每条边的残差 $r_{e,\\mathrm{vol}}$。\n\n对于**边加权**方案，$\\epsilon_{c,\\mathrm{eff}}(e) = \\epsilon_{c,\\mathrm{edge}}(e)$。残差项变为：\n$$\nr_{e,\\mathrm{edge}} = \\left| \\frac{(1 - f_e)\\epsilon_{c,1} + f_e \\epsilon_{c,2}}{\\epsilon_{c,1}} \\left( (1 - f_e) + f_e \\frac{\\epsilon_{c,1}}{\\epsilon_{c,2}} \\right) - 1 \\right|\n$$\n令 $\\eta = \\epsilon_{c,2}/\\epsilon_{c,1}$，表达式简化为：\n$$\n\\frac{D_{n,\\mathrm{discr}}(e)}{D_{n,0}} = \\left( (1 - f_e) + f_e \\eta \\right) \\left( (1 - f_e) + f_e \\frac{1}{\\eta} \\right)\n$$\n展开此乘积得到：\n$$\n(1 - f_e)^2 + f_e(1 - f_e)\\frac{1}{\\eta} + f_e(1 - f_e)\\eta + f_e^2 = 1 - 2f_e + 2f_e^2 + f_e(1 - f_e)\\left(\\eta + \\frac{1}{\\eta}\\right)\n$$\n残差是与 1 之差的模：\n$$\nr_{e,\\mathrm{edge}} = \\left| -2f_e + 2f_e^2 + f_e(1 - f_e)\\left(\\eta + \\frac{1}{\\eta}\\right) \\right| = \\left| f_e(1 - f_e) \\left( -2 + \\eta + \\frac{1}{\\eta} \\right) \\right|\n$$\n这导出了一个更有洞察力的形式：\n$$\nr_{e,\\mathrm{edge}} = \\left| f_e(1 - f_e) \\frac{(\\eta - 1)^2}{\\eta} \\right|\n$$\n这表明，如果边未被切割（$f_e=0$ 或 $f_e=1$）或没有材料对比度（$\\eta=1$），则边加权方案的误差为零；而当界面平分边时（$f_e=0.5$），误差最大。\n\n### 计算算法\n\n每种方案的总误差是元胞四条边上残差的均方根 (RMS)：\n$$\nR = \\sqrt{ \\frac{1}{4} \\sum_{e \\in \\{\\mathrm{top}, \\mathrm{bottom}, \\mathrm{left}, \\mathrm{right}\\}} r_e^2 }\n$$\n\n对于每个测试用例，算法按以下步骤进行：\n1.  计算角频率 $\\omega = 2\\pi f$ 和复介电常数 $\\epsilon_{c,1}$ 和 $\\epsilon_{c,2}$。\n2.  定义几何形状：法向量 $\\hat{\\mathbf n}$ 和元胞四条边的端点。\n3.  对每条边 $e$：\n    a. 计算端点到界面的有符号距离 $s_1$ 和 $s_2$。\n    b. 根据 $s_1$ 和 $s_2$ 的符号和值计算分数 $f_e$。\n    c. 使用 $\\epsilon_{c,\\mathrm{vol}} = (\\epsilon_{c,1}+\\epsilon_{c,2})/2$ 计算残差 $r_{e,\\mathrm{vol}}$。\n    d. 使用基于 $\\eta = \\epsilon_{c,2}/\\epsilon_{c,1}$ 和 $f_e$ 的导出公式计算残差 $r_{e,\\mathrm{edge}}$。\n4.  通过对残差平方的平均值取平方根，计算 RMS 误差 $R_{\\mathrm{vol}}$ 和 $R_{\\mathrm{edge}}$。\n5.  返回数对 $[R_{\\mathrm{vol}}, R_{\\mathrm{edge}}]$。\n\n对每个提供的测试用例实施此程序。",
            "answer": "$$\n\\boxed{\n\\text{[[0.2307521743603417, 0.15570779836932402], [0.375, 0.1875], [0.5517904944983944, 0.3541170753063546], [0.44985223395995476, 0.1462002302315609]]}\n}\n$$"
        }
    ]
}