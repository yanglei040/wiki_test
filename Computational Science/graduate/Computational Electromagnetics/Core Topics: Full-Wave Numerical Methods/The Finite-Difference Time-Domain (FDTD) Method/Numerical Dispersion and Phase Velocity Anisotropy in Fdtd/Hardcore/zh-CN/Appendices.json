{
    "hands_on_practices": [
        {
            "introduction": "深入理解数值色散各向异性的第一步是能够量化它。本练习将引导您从麦克斯韦方程组出发，推导FDTD方法的数值色散关系，并用它来计算波在网格主轴等高对称方向上传播时的数值相速度（或其倒数，慢度）。通过这个过程，您将亲手揭示由离散化网格引起的各向异性的基本性质。 ",
            "id": "3335203",
            "problem": "一个光速为 $c$ 的无损耗、均匀、各向同性介质，使用 Yee 格式的三维时域有限差分 (FDTD) 方法进行离散化，其空间步长相等 $\\Delta x=\\Delta y=\\Delta z=\\Delta$，时间步长均匀为 $\\Delta t$。考虑由麦克斯韦旋度方程控制的无源传播，该方程在交错网格上进行离散化，并分析限制在离散时空格点上的形如 $E,H \\propto \\exp\\!\\big(i(k_x x + k_y y + k_z z - \\omega t)\\big)$ 的平面波解。设无量纲频率固定为 $\\Omega \\equiv \\omega \\Delta t = \\frac{3\\pi}{5}$ (弧度)，并定义 Courant 数 $S \\equiv \\frac{c\\,\\Delta t}{\\Delta}$。设传播方向由单位向量 $\\hat{\\boldsymbol{n}}=(n_x,n_y,n_z)$ 指定，其中 $n_x^2+n_y^2+n_z^2=1$。定义无量纲慢度 (归一化到 $1/c$) 为 $\\sigma(\\hat{\\boldsymbol{n}})\\equiv \\frac{c}{v_p(\\hat{\\boldsymbol{n}})}=\\frac{c\\,k_{\\text{num}}(\\hat{\\boldsymbol{n}})}{\\omega}$，其中 $k_{\\text{num}}(\\hat{\\boldsymbol{n}})$ 是与沿方向 $\\hat{\\boldsymbol{n}}$ 的离散色散关系一致的数值波数大小。\n\n仅从无源麦克斯韦旋度方程和均匀网格上的 Yee 格式离散更新方程出发，推导全离散的平面波色散关系。利用该关系式，求出在以下每个对称方向上传播时，$\\sigma(\\hat{\\boldsymbol{n}})$ 关于 $\\Omega$ 和 $S$ 的闭式表达式：\n- $\\langle 100\\rangle$：$\\hat{\\boldsymbol{n}}=(1,0,0)$，\n- $\\langle 110\\rangle$：$\\hat{\\boldsymbol{n}}=\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}},0\\right)$，\n- $\\langle 111\\rangle$：$\\hat{\\boldsymbol{n}}=\\left(\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}}\\right)$。\n\n你的结果必须以单行矩阵 $\\big[\\sigma_{\\langle 100\\rangle}\\;\\;\\sigma_{\\langle 110\\rangle}\\;\\;\\sigma_{\\langle 111\\rangle}\\big]$ 的闭式形式表示，仅使用 $\\Omega=\\frac{3\\pi}{5}$、$S$ 以及标准常数和函数。不要引入任何数值四舍五入。所有角度均以弧度表示，慢度表示为无量纲量（无单位）。",
            "solution": "首先验证该问题，以确保其科学上合理、适定且客观。给定条件为一个光速为 $c$ 的无损耗、均匀、各向同性介质，使用空间步长为 $\\Delta$、时间步长为 $\\Delta t$ 的均匀 Yee 网格，通过三维时域有限差分 (FDTD) 方法进行离散化。我们需要分析无源平面波的传播。关键定义包括无量纲频率 $\\Omega \\equiv \\omega \\Delta t = \\frac{3\\pi}{5}$，Courant 数 $S \\equiv \\frac{c\\,\\Delta t}{\\Delta}$，传播方向单位向量 $\\hat{\\boldsymbol{n}}$，以及无量纲慢度 $\\sigma(\\hat{\\boldsymbol{n}})\\equiv \\frac{c}{v_p(\\hat{\\boldsymbol{n}})}=\\frac{c\\,k_{\\text{num}}(\\hat{\\boldsymbol{n}})}{\\omega}$。问题要求推导全离散色散关系，并用它来求出在 $\\langle 100\\rangle$、$\\langle 110\\rangle$ 和 $\\langle 111\\rangle$ 方向上的 $\\sigma$。\n\n该问题是有效的。这是计算电磁学中一个标准且基础的练习，基于麦克斯韦方程组和有限差分法的原理。所有术语都得到了精确定义，所需信息是自洽的。该问题是客观且可形式化的。我们可以开始求解。\n\n推导始于无损耗、均匀、各向同性介质中的无源麦克斯韦旋度方程，该介质的特性由介电常数 $\\epsilon$ 和磁导率 $\\mu$ 描述：\n$$ \\nabla \\times \\boldsymbol{E} = -\\mu \\frac{\\partial \\boldsymbol{H}}{\\partial t} $$\n$$ \\nabla \\times \\boldsymbol{H} = \\epsilon \\frac{\\partial \\boldsymbol{E}}{\\partial t} $$\n在此介质中，光速为 $c = \\frac{1}{\\sqrt{\\epsilon\\mu}}$。\n\nYee FDTD 格式在交错网格上使用中心差分近似对这些方程中的空间和时间导数进行离散化。对于形如 $\\boldsymbol{F}(\\boldsymbol{r}, t) = \\boldsymbol{F}_0 \\exp(i(\\boldsymbol{k}_{\\text{num}}\\cdot\\boldsymbol{r} - \\omega t))$ 的平面波解，其中 $\\boldsymbol{F}$ 是任一场分量（$\\boldsymbol{E}$ 或 $\\boldsymbol{H}$），$\\boldsymbol{k}_{\\text{num}} = (k_x, k_y, k_z)$ 是数值波矢量，可以求出离散算子的作用。\n\n对场分量 $F$ 进行时间上的中心差分，交错量为 $\\Delta t/2$，得到：\n$$ \\frac{F^{n+1/2} - F^{n-1/2}}{\\Delta t} \\rightarrow \\frac{\\exp(-i\\omega(t_n+\\Delta t/2)) - \\exp(-i\\omega(t_n-\\Delta t/2))}{\\Delta t} F_0 \\exp(i\\boldsymbol{k}_{\\text{num}}\\cdot\\boldsymbol{r}) = \\frac{-2i}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) F $$\n因此，在傅里叶域中，算子 $\\frac{\\partial}{\\partial t}$ 被替换为一个乘法因子：\n$$ \\frac{\\partial}{\\partial t} \\rightarrow \\frac{-2i}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n类似地，在空间维度（例如 $x$ 维）上的中心差分，交错量为 $\\Delta/2$：\n$$ \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta} \\rightarrow \\frac{\\exp(ik_x(x_i+\\Delta/2)) - \\exp(ik_x(x_i-\\Delta/2))}{\\Delta} F_0 \\exp(i(k_y y+k_z z - \\omega t)) = \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x\\Delta}{2}\\right) F $$\n因此，空间导数算子被替换为：\n$$ \\frac{\\partial}{\\partial x_j} \\rightarrow \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\n将这些代入麦克斯韦方程组，得到傅里叶域中的离散化方程：\n$$ i\\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{E} = - \\mu \\left( \\frac{-i\\omega_{\\text{num}}}{\\mu} \\boldsymbol{H} \\right) \\implies \\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{E} = \\omega_{\\text{num}} \\boldsymbol{H} $$\n$$ i\\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{H} = \\epsilon \\left( \\frac{-i\\omega_{\\text{num}}}{\\epsilon} \\boldsymbol{E} \\right) \\implies \\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{H} = -\\omega_{\\text{num}} \\boldsymbol{E} $$\n为清晰起见，我们定义了有效波数矢量分量 $K_j$ 和有效频率 $\\omega_{\\text{eff}}$，但直接代入完整表达式更简单。我们将作用于波的离散算子定义为：\n$$ \\omega_d \\equiv \\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n$$ K_j \\equiv \\frac{2}{\\Delta}\\sin\\left(\\frac{k_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\n方程组变为：\n$$ \\boldsymbol{K} \\times \\boldsymbol{E} = \\mu \\omega_d \\boldsymbol{H} $$\n$$ \\boldsymbol{K} \\times \\boldsymbol{H} = -\\epsilon \\omega_d \\boldsymbol{E} $$\n其中 $\\boldsymbol{K} = (K_x, K_y, K_z)$。对第一个方程取旋度，并代入第二个方程：\n$$ \\boldsymbol{K} \\times (\\boldsymbol{K} \\times \\boldsymbol{E}) = \\mu \\omega_d (\\boldsymbol{K} \\times \\boldsymbol{H}) = \\mu \\omega_d (-\\epsilon \\omega_d \\boldsymbol{E}) = -\\mu\\epsilon \\omega_d^2 \\boldsymbol{E} $$\n使用矢量恒等式 $\\boldsymbol{A} \\times (\\boldsymbol{B} \\times \\boldsymbol{C}) = \\boldsymbol{B}(\\boldsymbol{A} \\cdot \\boldsymbol{C}) - \\boldsymbol{C}(\\boldsymbol{A} \\cdot \\boldsymbol{B})$ 并假设为横波（即 $\\boldsymbol{K} \\cdot \\boldsymbol{E} = 0$）：\n$$ -\\boldsymbol{E}(\\boldsymbol{K} \\cdot \\boldsymbol{K}) = -\\mu\\epsilon \\omega_d^2 \\boldsymbol{E} $$\n这给出了代数关系 $|\\boldsymbol{K}|^2 = \\mu\\epsilon \\omega_d^2$。代入 $\\omega_d$ 和 $K_j$ 的定义，以及 $\\mu\\epsilon = 1/c^2$：\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left[ \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right] = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n除以 $4$ 并整理各项进行简化，我们得到 FDTD 数值色散关系：\n$$ \\frac{1}{(c\\Delta t)^2} \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{1}{\\Delta^2} \\left[ \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right] $$\n使用无量纲 Courant 数 $S = \\frac{c\\Delta t}{\\Delta}$ 和无量纲频率 $\\Omega = \\omega \\Delta t$：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) $$\n现在，我们引入无量纲慢度 $\\sigma = \\frac{ck_{\\text{num}}}{\\omega}$。数值波矢量的分量是 $k_j = k_{\\text{num}}n_j$，其中 $\\hat{\\boldsymbol{n}}=(n_x,n_y,n_z)$ 是传播方向。右侧正弦函数的自变量可以重新用 $\\sigma$、$S$ 和 $\\Omega$ 表示：\n$$ \\frac{k_j\\Delta}{2} = \\frac{(k_{\\text{num}}n_j)\\Delta}{2} = \\frac{(\\omega\\sigma/c)n_j\\Delta}{2} = \\frac{\\omega\\Delta t}{2} \\frac{\\sigma n_j}{c\\Delta t/\\Delta} = \\frac{(\\Omega/2)\\sigma n_j}{S} = \\frac{n_j\\Omega\\sigma}{2S} $$\n将此代入色散关系，得到关于 $\\sigma(\\hat{\\boldsymbol{n}})$ 的一般方程：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sum_{j \\in \\{x,y,z\\}} \\sin^2\\left(\\frac{n_j\\Omega\\sigma}{2S}\\right) $$\n给定 $\\Omega = \\frac{3\\pi}{5}$，因此 $\\frac{\\Omega}{2} = \\frac{3\\pi}{10}$。我们现在求解沿三个指定对称方向的 $\\sigma$。\n\n情况 1：轴向传播，$\\langle 100\\rangle$ 方向。\n此处，$\\hat{\\boldsymbol{n}} = (1, 0, 0)$。关于 $\\sigma_{\\langle 100\\rangle}$ 的方程变为：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 100\\rangle}}{2S}\\right) + 0 + 0 $$\n取正平方根：\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sin\\left(\\frac{\\Omega\\sigma_{\\langle 100\\rangle}}{2S}\\right) $$\n求解 $\\sigma_{\\langle 100\\rangle}$：\n$$ \\sigma_{\\langle 100\\rangle} = \\frac{2S}{\\Omega} \\arcsin\\left(\\frac{1}{S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{2S}{3\\pi/5} \\arcsin\\left(\\frac{1}{S}\\sin\\left(\\frac{3\\pi}{10}\\right)\\right) = \\frac{10S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{S}\\right) $$\n\n情况 2：平面对角线传播，$\\langle 110\\rangle$ 方向。\n此处，$\\hat{\\boldsymbol{n}} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0\\right)$。关于 $\\sigma_{\\langle 110\\rangle}$ 的方程变为：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) + \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) + 0 = 2\\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) $$\n取正平方根：\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sqrt{2}\\sin\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) $$\n$$ \\sigma_{\\langle 110\\rangle} = \\frac{2\\sqrt{2}S}{\\Omega} \\arcsin\\left(\\frac{1}{\\sqrt{2}S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{10\\sqrt{2}S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{\\sqrt{2}S}\\right) $$\n\n情况 3：空间对角线传播，$\\langle 111\\rangle$ 方向。\n此处，$\\hat{\\boldsymbol{n}} = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$。关于 $\\sigma_{\\langle 111\\rangle}$ 的方程变为：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = 3\\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 111\\rangle}}{2\\sqrt{3}S}\\right) $$\n取正平方根：\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sqrt{3}\\sin\\left(\\frac{\\Omega\\sigma_{\\langle 111\\rangle}}{2\\sqrt{3}S}\\right) $$\n$$ \\sigma_{\\langle 111\\rangle} = \\frac{2\\sqrt{3}S}{\\Omega} \\arcsin\\left(\\frac{1}{\\sqrt{3}S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{10\\sqrt{3}S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{\\sqrt{3}S}\\right) $$\n\n这三个闭式表达式构成了最终答案。按要求将它们组合成一个单行矩阵。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{10S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{S}\\right) & \\frac{10\\sqrt{2}S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{\\sqrt{2}S}\\right) & \\frac{10\\sqrt{3}S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{\\sqrt{3}S}\\right) \\end{pmatrix} } $$"
        },
        {
            "introduction": "知道各向异性的存在是一回事，如何控制它则是另一回事，这直接关系到仿真设计的成败。本练习将带您从理论分析走向工程设计，通过对色散关系进行渐近展开，推导出一个简洁而实用的设计准则。该准则将您期望的仿真精度（各向异性容差）与网格分辨率（$\\Delta/\\lambda$）直接联系起来，这是设置精确FDTD仿真的关键技能。 ",
            "id": "3335173",
            "problem": "对三维时域有限差分 (FDTD) 方法进行平面波数值色散分析，其中时域有限差分 (FDTD) 指的是真空中的标准 Yee 交错网格格式。考虑一个在所有三个方向上间距均为 $\\Delta$ 的均匀立方空间网格和一个时间步长 $\\Delta t$。定义 Courant 数为 $S = c\\,\\Delta t/\\Delta$，其中 $c$ 是真空中的光速。设连续波频率为 $f$，波长为 $\\lambda = c/f$，波数大小为 $k = 2\\pi/\\lambda$。对于一个传播方向为 $\\hat{\\mathbf{k}} = (\\mu_x,\\mu_y,\\mu_z)$（满足 $\\mu_x^2+\\mu_y^2+\\mu_z^2=1$）的平面波，用 $v_p(\\hat{\\mathbf{k}})$ 表示在固定 $k$ 值下，离散格式所支持的数值相速度。\n\n从真空中的麦克斯韦方程组和 Yee 有限差分离散化出发，推导离散色散关系，并使用关于 $k\\Delta$ 的小参数渐近展开（保留足以解析角度依赖性的项），以获得 $v_p(\\hat{\\mathbf{k}})$ 的主阶角度依赖性。将固定 $k$ 值的角度各向异性定义为\n$$\n\\mathcal{A} \\equiv \\frac{\\max_{\\hat{\\mathbf{k}}} v_p(\\hat{\\mathbf{k}}) - \\min_{\\hat{\\mathbf{k}}} v_p(\\hat{\\mathbf{k}})}{c}.\n$$\n在给定频率 $f$ 下，施加一个目标容差 $\\mathcal{A} \\le \\epsilon$，其中 $\\epsilon = 0.01$。通过界定 $v_p(\\hat{\\mathbf{k}})$ 在所有方向上的变化范围，推导出一个关于$\\Delta/\\lambda$和 $S$ 的约束条件，以保证在 $k\\Delta$ 的主阶上 $\\mathcal{A} \\le \\epsilon$。使用您的结果，确定最大的允许比率 $\\Delta/\\lambda$，使得对于某个三维空间中容许的 Courant 数 $S$，该目标得以满足。将您最终的数值答案，即最大的 $\\Delta/\\lambda$，四舍五入到四位有效数字。将最终数字表示为无单位的无量纲量。",
            "solution": "分析的起点是无源真空中的麦克斯韦旋度方程：\n$$ \\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{H}$ 是磁场，$\\mu_0$ 和 $\\epsilon_0$ 分别是真空的磁导率和介电常数，满足 $\\mu_0\\epsilon_0 = 1/c^2$，其中 $c$ 是光速。\n\n对于均匀立方网格（间距为 $\\Delta$）上的标准 Yee FDTD 格式，空间和时间导数使用中心差分近似。我们假设场的离散平面波解（拟设），在网格点 $(i\\Delta, j\\Delta, k\\Delta)$ 和时间步 $n\\Delta t$ 处采样：\n$$ \\mathbf{F}(i\\Delta, j\\Delta, k\\Delta, n\\Delta t) = \\mathbf{F}_0 \\exp\\left[i\\left(\\tilde{k}_x i\\Delta + \\tilde{k}_y j\\Delta + \\tilde{k}_z k\\Delta - \\tilde{\\omega} n\\Delta t\\right)\\right] $$\n其中 $\\mathbf{F}$ 代表 $\\mathbf{E}$ 或 $\\mathbf{H}$，$\\tilde{\\mathbf{k}}=(\\tilde{k}_x, \\tilde{k}_y, \\tilde{k}_z)$ 是数值波矢量，$\\tilde{\\omega}$ 是数值角频率。\n\n将此拟设代入 Yee 离散化的麦克斯韦方程组，将微分算子转换为代数因子。一个空间差分，例如 $\\frac{f(x+\\Delta/2) - f(x-\\Delta/2)}{\\Delta}$，作用于 $\\exp(i\\tilde{k}_x x)$ 后变为 $\\frac{2i}{\\Delta}\\sin(\\frac{\\tilde{k}_x\\Delta}{2})\\exp(i\\tilde{k}_x x)$。类似地，时间差分算子变为 $\\frac{-2i}{\\Delta t}\\sin(\\frac{\\tilde{\\omega}\\Delta t}{2})\\exp(-i\\tilde{\\omega}t)$。\n\n这个过程导出一个代数方程组，通过将连续算子 $(\\nabla, \\frac{\\partial}{\\partial t})$ 替换为其等效的数值对应物，可以将其紧凑地写出。该系统等价于进行以下替换后的连续波方程：\n$$ k_j \\rightarrow \\tilde{k}'_j = \\frac{2}{\\Delta} \\sin\\left(\\frac{\\tilde{k}_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\n$$ \\omega \\rightarrow \\tilde{\\omega}' = \\frac{2}{\\Delta t} \\sin\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\n真空中的连续波色散关系为 $|\\mathbf{k}|^2 = (\\omega/c)^2$。因此，其数值对应物是：\n$$ (\\tilde{k}'_x)^2 + (\\tilde{k}'_y)^2 + (\\tilde{k}'_z)^2 = \\left(\\frac{\\tilde{\\omega}'}{c}\\right)^2 $$\n代入 $\\tilde{k}'_j$ 和 $\\tilde{\\omega}'$ 的表达式：\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_z\\Delta}{2}\\right) \\right] = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\n乘以 $\\frac{c^2(\\Delta t)^2}{4}$ 并使用 Courant 数的定义 $S = c\\Delta t/\\Delta$：\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_z\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\n这就是三维 Yee FDTD 格式的数值色散关系。\n\n我们正在分析一个固定频率为 $f$ 的连续波，因此我们将数值频率设置为连续频率：$\\tilde{\\omega} = \\omega = 2\\pi f = ck$。数值波矢量为 $\\tilde{\\mathbf{k}} = \\tilde{k}\\hat{\\mathbf{k}} = \\tilde{k}(\\mu_x, \\mu_y, \\mu_z)$。色散关系变为：\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}\\mu_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}\\mu_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}\\mu_z\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n为了求出相速度 $v_p = \\tilde{\\omega}/\\tilde{k} = \\omega/\\tilde{k}$，我们对小的 $k\\Delta$ 进行渐近展开。这意味着 $\\lambda \\gg \\Delta$，因此正弦函数的自变量很小。我们使用泰勒级数 $\\sin(x) = x - x^3/6 + O(x^5)$，得到 $\\sin^2(x) = x^2 - x^4/3 + O(x^6)$。\n\n色散关系的右侧 (RHS) 变为：\n$$ \\text{RHS} = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\sin^2\\left(\\frac{ck\\Delta t}{2}\\right) = \\sin^2\\left(\\frac{k\\Delta S}{2}\\right) \\approx \\left(\\frac{k\\Delta S}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{k\\Delta S}{2}\\right)^4 = \\frac{S^2(k\\Delta)^2}{4} - \\frac{S^4(k\\Delta)^4}{48} $$\n左侧 (LHS) 变为：\n$$ \\text{LHS} = S^2 \\sum_{j \\in \\{x,y,z\\}} \\sin^2\\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right) \\approx S^2 \\sum_j \\left[ \\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right)^4 \\right] $$\n$$ \\text{LHS} \\approx S^2 \\left[ \\frac{(\\tilde{k}\\Delta)^2}{4}\\sum_j\\mu_j^2 - \\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 \\right] $$\n由于 $\\sum_j\\mu_j^2 = 1$：\n$$ \\text{LHS} \\approx S^2\\frac{(\\tilde{k}\\Delta)^2}{4} - S^2\\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 $$\n令展开后的 LHS 和 RHS 相等：\n$$ S^2\\frac{(\\tilde{k}\\Delta)^2}{4} - S^2\\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 \\approx \\frac{S^2(k\\Delta)^2}{4} - \\frac{S^4(k\\Delta)^4}{48} $$\n两边同除以 $S^2(\\Delta^2/4)$：\n$$ \\tilde{k}^2 - \\frac{\\tilde{k}^4\\Delta^2}{12}\\sum_j\\mu_j^4 \\approx k^2 - \\frac{S^2k^4\\Delta^2}{12} $$\n为了求解 $\\tilde{k}$，我们使用微扰方法。在主阶上，$\\tilde{k} \\approx k$。我们将此代入高阶项中：\n$$ \\tilde{k}^2 \\approx k^2 - \\frac{S^2k^4\\Delta^2}{12} + \\frac{k^4\\Delta^2}{12}\\sum_j\\mu_j^4 = k^2\\left[1 - \\frac{(k\\Delta)^2}{12}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right] $$\n$$ \\tilde{k} \\approx k\\left[1 - \\frac{(k\\Delta)^2}{12}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right]^{1/2} \\approx k\\left[1 - \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right] $$\n归一化数值相速度为 $v_p/c = (\\omega/\\tilde{k})/c = k/\\tilde{k}$：\n$$ \\frac{v_p(\\hat{\\mathbf{k}})}{c} = \\frac{k}{\\tilde{k}} \\approx \\left[1 - \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right]^{-1} \\approx 1 + \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right) $$\n各向异性 $\\mathcal{A}$ 取决于 $v_p$ 随方向 $\\hat{\\mathbf{k}}$ 的变化。这种变化由项 $F(\\hat{\\mathbf{k}}) = \\sum_j\\mu_j^4 = \\mu_x^4+\\mu_y^4+\\mu_z^4$ 决定。我们需要在约束条件 $\\mu_x^2+\\mu_y^2+\\mu_z^2=1$ 下求 $F$ 的最小值和最大值。\n令 $x=\\mu_x^2, y=\\mu_y^2, z=\\mu_z^2$。我们需要在约束条件 $x+y+z=1$ 和 $x,y,z \\ge 0$ 下求 $x^2+y^2+z^2$ 的极值。\n最大值出现在约束域的顶点处，例如 $(x,y,z)=(1,0,0)$。这对应于沿着网格轴的传播，例如 $\\hat{\\mathbf{k}} = (1,0,0)$。\n$$ F_{\\max} = 1^4+0^4+0^4 = 1 $$\n最小值在 $x=y=z=1/3$ 时出现。这对应于沿着空间对角线的传播，例如 $\\hat{\\mathbf{k}} = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$。\n$$ F_{\\min} = 3 \\times (1/\\sqrt{3})^4 = 3 \\times (1/9) = 1/3 $$\n由于其公式中的负号，当 $\\sum_j \\mu_j^4$ 最小时，相速度最大；当其最大时，相速度最小：\n$$ \\frac{v_{p,\\max}}{c} \\approx 1 + \\frac{(k\\Delta)^2}{24}(S^2 - F_{\\min}) = 1 + \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\frac{1}{3}\\right) $$\n$$ \\frac{v_{p,\\min}}{c} \\approx 1 + \\frac{(k\\Delta)^2}{24}(S^2 - F_{\\max}) = 1 + \\frac{(k\\Delta)^2}{24}(S^2 - 1) $$\n各向异性定义为 $\\mathcal{A} \\equiv (\\max v_p - \\min v_p)/c$：\n$$ \\mathcal{A} = \\frac{v_{p,\\max}}{c} - \\frac{v_{p,\\min}}{c} \\approx \\frac{(k\\Delta)^2}{24}\\left[\\left(S^2 - \\frac{1}{3}\\right) - (S^2 - 1)\\right] = \\frac{(k\\Delta)^2}{24}\\left(1 - \\frac{1}{3}\\right) = \\frac{(k\\Delta)^2}{24}\\left(\\frac{2}{3}\\right) $$\n$$ \\mathcal{A} \\approx \\frac{(k\\Delta)^2}{36} $$\n这个关于各向异性的主阶结果与 Courant 数 $S$ 无关。问题要求对于*某个*容许的 $S$ 满足此条件。对于三维 Yee 格式，稳定性条件是 $S \\le 1/\\sqrt{3}$。由于我们得到的 $\\mathcal{A}$ 的结果与 $S$ 无关，因此可以选择任何稳定的 $S$ 值，而不会影响各向异性约束。\n\n给定容差 $\\mathcal{A} \\le \\epsilon$，其中 $\\epsilon=0.01$。代入 $k = 2\\pi/\\lambda$：\n$$ \\frac{((2\\pi/\\lambda)\\Delta)^2}{36} \\le \\epsilon $$\n$$ \\frac{4\\pi^2(\\Delta/\\lambda)^2}{36} \\le \\epsilon $$\n$$ \\frac{\\pi^2}{9}\\left(\\frac{\\Delta}{\\lambda}\\right)^2 \\le \\epsilon $$\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)^2 \\le \\frac{9\\epsilon}{\\pi^2} $$\n因此，最大允许比率 $\\Delta/\\lambda$ 为：\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} = \\sqrt{\\frac{9\\epsilon}{\\pi^2}} = \\frac{3\\sqrt{\\epsilon}}{\\pi} $$\n代入 $\\epsilon = 0.01$：\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} = \\frac{3\\sqrt{0.01}}{\\pi} = \\frac{3 \\times 0.1}{\\pi} = \\frac{0.3}{\\pi} $$\n现在，我们计算其数值并四舍五入到四位有效数字：\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} \\approx \\frac{0.3}{3.14159265...} \\approx 0.0954929658... $$\n四舍五入到四位有效数字得到 $0.09549$。",
            "answer": "$$\\boxed{0.09549}$$"
        },
        {
            "introduction": "虽然解析形式的准则很强大，但要获得数值色散误差的全貌，则需要系统地探索由 Courant 数和网格分辨率构成的整个参数空间。本练习要求您编写一个程序来绘制各向异性误差的分布图。通过这种计算实验，您将能够为特定的仿真需求找到误差最小化的“最佳工作点”，这是高级FDTD仿真设计中的核心方法。 ",
            "id": "3335136",
            "problem": "考虑一个在真空中的二维电磁波，该电磁波通过时域有限差分 (FDTD) 方法在具有相等空间步长 $\\Delta x = \\Delta y = \\Delta$ 和时间步长 $\\Delta t$ 的均匀正交 Yee 网格上进行离散化。定义无量纲 Courant 数 $S = c \\, \\Delta t / \\Delta$，其中 $c$ 是真空光速。假设一个平面波解，其传播波数矢量为 $\\mathbf{k} = (k_x, k_y)$，大小为 $k = \\|\\mathbf{k}\\|$，方向单位矢量为 $\\hat{\\mathbf{k}} = (\\cos \\theta, \\sin \\theta)$，角频率为 $\\omega$。定义无量纲空间采样参数 $\\alpha = k \\Delta$。所有角度必须以弧度为单位指定和使用。\n\n从真空中的宏观麦克斯韦方程组和 Yee 交错网格离散化出发，推导在相等空间步长下二维传播的数值色散关系。基于此结果，推导数值相速度 $v_p(\\theta; S, \\alpha)$ 的公式以及方向相对相速度误差\n$$\nE(\\theta; S, \\alpha) = \\left| \\frac{v_p(\\theta; S, \\alpha) - c}{c} \\right|.\n$$\n定义各向异性度量为在所有传播方向上的最坏情况角度误差\n$$\nA(S,\\alpha) = \\max_{\\theta \\in [0,\\pi/2]} E(\\theta; S, \\alpha),\n$$\n由于对称性，将 $\\theta$ 限制在 $[0,\\pi/2]$ 范围内是充分的。对于二维等步长 Yee 网格，数值稳定性条件要求 $S \\le 1/\\sqrt{2}$；将 $S$ 限制在闭区间 $[0.1, 0.705]$ 内。\n\n编写一个完整的程序，该程序：\n- 仅使用基本常数和无量纲参数 $S$ 和 $\\alpha$ 实现推导出的 $v_p(\\theta; S, \\alpha)$ 表达式，并计算 $E(\\theta; S, \\alpha)$。\n- 通过在 $\\theta \\in [0,\\pi/2]$ 上均匀采样 $N_\\theta = 1441$ 个点进行数值最大化，从而计算 $A(S,\\alpha)$。\n- 在 $S \\in \\{ 0.100, 0.101, \\ldots, 0.705 \\}$ 上执行参数扫描，以在网格上评估 $A(S,\\alpha)$。\n- 对于指定的误差水平 $\\varepsilon > 0$，将在给定 $\\alpha$ 下的等各向异性等值线点定义为在扫描范围内使 $\\left|A(S,\\alpha) - \\varepsilon\\right|$ 最小化的任意 $S$。报告找到的 $S$ 值以及在该 $S$ 值下实现的各向异性水平。\n- 将在给定 $\\alpha$ 下的最小角度误差工作点定义为在扫描范围内使 $A(S,\\alpha)$ 最小化的任意 $S$。报告找到的 $S$ 值以及最小各向异性水平。\n\n所有量均为无量纲，所有角度必须以弧度处理。您的程序必须使用上述定义，并按规定通过均匀采样来执行数值最大化。\n\n测试套件和答案规范：\n- 使用以下四个测试用例，每个用例按下述顺序列出，为所要求的值返回一对浮点数。对于返回的每一对值，报告四舍五入到六位小数的值。\n  1. 对于 $\\alpha_1 = 1.0$，返回最小角度误差工作点 $[S_{\\text{opt}}(\\alpha_1), A_{\\min}(\\alpha_1)]$，其中 $S_{\\text{opt}}(\\alpha_1) = \\arg\\min_{S \\in [0.1,0.705]} A(S,\\alpha_1)$ 且 $A_{\\min}(\\alpha_1) = \\min_{S \\in [0.1,0.705]} A(S,\\alpha_1)$。\n  2. 对于 $\\alpha_2 = 1.5$ 和等值水平 $\\varepsilon_2 = 0.02$，返回等各向异性等值线点 $[S_{\\varepsilon_2}(\\alpha_2), A(S_{\\varepsilon_2}(\\alpha_2), \\alpha_2)]$，其中 $S_{\\varepsilon_2}(\\alpha_2) = \\arg\\min_{S \\in [0.1,0.705]} |A(S,\\alpha_2)-\\varepsilon_2|$。\n  3. 对于 $\\alpha_3 = 0.5$ 和等值水平 $\\varepsilon_3 = 0.005$，根据相同定义返回等各向异性等值线点 $[S_{\\varepsilon_3}(\\alpha_3), A(S_{\\varepsilon_3}(\\alpha_3), \\alpha_3)]$。\n  4. 为了在更高空间频率下进行边界测试，对于 $\\alpha_4 = 2.5$，返回最小角度误差工作点 $[S_{\\text{opt}}(\\alpha_4), A_{\\min}(\\alpha_4)]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目本身是对应一个测试用例的双元素列表。顺序必须与上述四个测试用例匹配。例如，打印的行必须如下所示：\n$[\\,[S_1,A_1],[S_2,A_2],[S_3,A_3],[S_4,A_4]\\,]$\n所有浮点数均四舍五入到六位小数。",
            "solution": "用户提供的问题经评估是有效的，因为它在科学上基于计算电磁学原理，是适定的、客观的，并包含一套完整且一致的定义和约束。这些任务在数值方法分析中是标准的，并且并非无足轻重。因此，有必要提供一个完整的解答。\n\n### 数值色散关系的推导\n\n我们从无源真空中的麦克斯韦旋度方程组开始，考虑横磁 ($TM_z$) 波，其场分量为 $E_z$、$H_x$ 和 $H_y$：\n$$ \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon_0} \\left( \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y} \\right) $$\n$$ \\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu_0} \\frac{\\partial E_z}{\\partial y} $$\n$$ \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu_0} \\frac{\\partial E_z}{\\partial x} $$\n\nFDTD 方法在 Yee 网格上离散化这些方程。对于均匀空间步长 $\\Delta x = \\Delta y = \\Delta$ 和时间步长 $\\Delta t$，偏导数由二阶精确的中心有限差分来近似。对于形式为 $F(x,y,t) = F_0 e^{i(k_x x + k_y y - \\omega t)}$ 的谐波平面波解（其中 $F$ 是任意场分量），连续微分算子 $(\\frac{\\partial}{\\partial t}, \\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$ 在谱域中被变换为乘法因子。对于标准 Yee 格式，此变换为：\n$$ \\frac{\\partial}{\\partial t} \\rightarrow -\\frac{2i}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n$$ \\frac{\\partial}{\\partial x} \\rightarrow \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) $$\n$$ \\frac{\\partial}{\\partial y} \\rightarrow \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) $$\n在这里，$\\omega$ 是数值角频率，$k_x, k_y$ 是数值波数，我们假设它们与入射波的连续对应量相同。\n\n将这些代入麦克斯韦方程组（在相量域中，$\\partial/\\partial t \\rightarrow -i\\omega$）得到一个关于场振幅 $E_{z0}, H_{x0}, H_{y0}$ 的代数方程组。注意时间导数 $\\partial/\\partial t$ 在蛙跳格式中变为 $-i \\omega_d = -\\frac{2i}{\\Delta t}\\sin(\\frac{\\omega\\Delta t}{2})$。\n$$ -\\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) E_{z0} = \\frac{1}{\\varepsilon_0} \\left( \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x \\Delta}{2}\\right) H_{y0} - \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_y \\Delta}{2}\\right) H_{x0} \\right) $$\n$$ -\\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) H_{x0} = -\\frac{1}{\\mu_0} \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_y \\Delta}{2}\\right) E_{z0} $$\n$$ -\\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) H_{y0} = \\frac{1}{\\mu_0} \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x \\Delta}{2}\\right) E_{z0} $$\n\n从后两个方程中，我们将 $H_{x0}$ 和 $H_{y0}$ 用 $E_{z0}$ 表示：\n$$ H_{x0} = -\\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(k_y \\Delta / 2)}{\\sin(\\omega \\Delta t / 2)} E_{z0} $$\n$$ H_{y0} = \\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(k_x \\Delta / 2)}{\\sin(\\omega \\Delta t / 2)} E_{z0} $$\n\n将这些表达式代入关于 $E_{z0}$ 的方程并化简，可以消去场振幅，从而得到数值色散关系：\n$$ \\left( \\frac{1}{c\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right)^2 = \\left( \\frac{1}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) \\right)^2 + \\left( \\frac{1}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) \\right)^2 $$\n其中 $c = 1/\\sqrt{\\varepsilon_0\\mu_0}$ 是真空光速。\n\n### 数值相速度与各向异性\n\n为分析此关系，我们引入指定的无量纲参数：Courant 数 $S = c\\Delta t/\\Delta$、空间采样参数 $\\alpha = k\\Delta$ 以及传播角 $\\theta$（其中 $k_x = k\\cos\\theta$ 和 $k_y = k\\sin\\theta$）。数值色散关系变为：\n$$ \\left( \\frac{1}{S} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right)^2 = \\sin^2\\left(\\frac{k\\Delta\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{k\\Delta\\sin\\theta}{2}\\right) $$\n$$ \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} $$\n\n数值相速度定义为 $v_p = \\omega/k$。我们可以从上述关系中解出 $\\omega$：\n$$ \\omega = \\frac{2}{\\Delta t} \\arcsin\\left( S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} \\right) $$\n然后，我们求出以 $c$ 归一化的相速度：\n$$ \\frac{v_p(\\theta; S, \\alpha)}{c} = \\frac{\\omega}{ck} = \\frac{\\omega \\Delta}{ck\\Delta} = \\frac{\\omega \\Delta}{c\\alpha} = \\frac{\\Delta}{c\\alpha} \\frac{2}{\\Delta t} \\arcsin(\\dots) = \\frac{2}{\\alpha S} \\arcsin(\\dots) $$\n这就给出了归一化数值相速度的最终公式：\n$$ \\frac{v_p(\\theta; S, \\alpha)}{c} = \\frac{2}{\\alpha S} \\arcsin\\left( S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} \\right) $$\n\n于是，方向相对相速度误差 $E$ 为：\n$$ E(\\theta; S, \\alpha) = \\left| \\frac{v_p(\\theta; S, \\alpha)}{c} - 1 \\right| $$\n各向异性度量 $A(S, \\alpha)$ 是该误差在传播角 $\\theta \\in [0, \\pi/2]$ 上的最大值：\n$$ A(S,\\alpha) = \\max_{\\theta \\in [0,\\pi/2]} E(\\theta; S, \\alpha) $$\n\n### 数值实现\n程序将实现推导出的 $E(\\theta; S, \\alpha)$ 公式，并执行指定的数值任务。\n1. 基于推导出的表达式实现一个计算 $E(\\theta; S, \\alpha)$ 的函数。\n2. 通过在 $\\theta \\in [0, \\pi/2]$ 的均匀网格（包含 $N_\\theta = 1441$ 个点）上数值计算 $E$ 并找到其最大值，来计算各向异性 $A(S,\\alpha)$。\n3. 对 $S \\in [0.100, 0.705]$（步长为 0.001）进行参数扫描。对于测试用例中给定的 $\\alpha$，计算扫描中每个 $S$ 对应的 $A(S,\\alpha)$。\n4. 为了找到最小角度误差的工作点，程序找到计算出的 $A(S,\\alpha)$ 数组的最小值以及对应的 $S$。\n5. 为了找到给定 $\\varepsilon$ 的等各向异性等值线点，程序找到使绝对差 $|A(S,\\alpha) - \\varepsilon|$ 最小化的 $S$ 值。\n6. 计算四个指定测试用例的结果，并将其格式化为所需的输出字符串。\n\n该实现使用 `numpy` 对 $S$ 和 $\\theta$ 值网格上的 $E$ 进行高效的矢量化计算，从而确保正确性和性能。",
            "answer": "$$ \\boxed{[[0.705000,0.003180],[0.551000,0.020047],[0.100000,0.004245],[0.565000,0.046538]]} $$"
        }
    ]
}