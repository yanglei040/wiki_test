{
    "hands_on_practices": [
        {
            "introduction": "The core idea of a Stretched-Coordinate Perfectly Matched Layer (SC-PML) is to create a non-physical absorbing medium that is perfectly impedance-matched to the simulation domain. This is achieved by stretching the spatial coordinate into the complex plane, which introduces a spatially varying, frequency-dependent conductivity. This first practice problem, , bridges the gap between this continuous theory and a discrete numerical implementation, allowing you to see how the PML gradually absorbs incident waves without causing reflections by calculating the attenuation per cell for a graded conductivity profile.",
            "id": "3339137",
            "problem": "Consider a one-dimensional absorbing boundary in free space implemented by the Stretched-Coordinate Perfectly Matched Layer (SC-PML). A plane wave at normal incidence propagates along the $x$-axis into the SC-PML region occupying $0 \\le x \\le L$. The coordinate stretching along $x$ is defined by $s_x(x)$ with $\\kappa_x=1$ and no low-frequency damping parameter, so that the only free profile is the conductivity $\\sigma(x)$. The SC-PML profile to be implemented is graded as $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m$ for $x \\in [0,L]$ and integer grade $m \\ge 0$. The free-space parameters are $\\mu_0$ and $\\varepsilon_0$.\n\nStarting from Maxwell’s equations in the frequency domain and the SC-PML complex coordinate stretching, derive the expression for the attenuation factor magnitude experienced by a normally incident homogeneous plane wave as it traverses one discrete cell of thickness $\\Delta x$ within the SC-PML. Then, using that expression, implement the graded profile in a discrete scheme of $N$ uniform cells of width $\\Delta x = L/N$ where the $i$-th cell spans $\\left[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}\\right] = \\left[\\left(i-1\\right)\\Delta x, i\\,\\Delta x\\right]$ for $i=1,2,\\dots,N$. Your program must compute, for each cell, the attenuation factor magnitude (a dimensionless number between $0$ and $1$) experienced by the wave amplitude when traversing that cell, expressed as a float. Assume normal incidence and free space everywhere.\n\nFundamental base you must use in your derivation:\n- Maxwell’s equations in the frequency domain in source-free, linear, homogeneous media, and the definition of the SC-PML complex coordinate stretching.\n- The plane-wave solution in homogeneous media and its modification under complex coordinate stretching.\n\nPhysical constants and units to be used and reported:\n- Use $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$ and $\\varepsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$.\n- Frequency $f$ is in $\\mathrm{Hz}$; the angular frequency is $\\omega = 2\\pi f$.\n- Lengths $L$ and $\\Delta x$ are in $\\mathrm{m}$.\n- Conductivity $\\sigma_{\\max}$ is in $\\mathrm{S/m}$.\n- The attenuation factor magnitudes are unitless floats.\n\nImplement the discrete graded profile $\\sigma(x)=\\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m$ and compute the attenuation factor magnitude per cell for the following test suite. For each test case, compute a list of length $N$ that contains the attenuation factor magnitudes for cells $i=1,2,\\dots,N$ in order.\n\nTest suite parameter sets $(f, L, N, \\sigma_{\\max}, m)$:\n1. $(f = 2\\times 10^9, L = 2.0\\times 10^{-2}, N = 8, \\sigma_{\\max} = 9.781, m = 3)$\n2. $(f = 1.0\\times 10^9, L = 5.0\\times 10^{-3}, N = 1, \\sigma_{\\max} = 100.0, m = 1)$\n3. $(f = 5.0\\times 10^9, L = 1.0\\times 10^{-2}, N = 5, \\sigma_{\\max} = 50.0, m = 2)$\n4. $(f = 5.0\\times 10^8, L = 1.0\\times 10^{-2}, N = 5, \\sigma_{\\max} = 50.0, m = 2)$\n5. $(f = 3.0\\times 10^9, L = 1.0\\times 10^{-2}, N = 4, \\sigma_{\\max} = 25.0, m = 0)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of floats corresponding to one test case, for example, something like $[[a_{1},a_{2},\\dots,a_{N_1}],[b_{1},\\dots],[\\dots]]$ with no spaces required. The final output must be a single line containing only this bracketed representation. Angle units do not apply. Percentages are not to be used anywhere; all reported quantities are floats or lists of floats.",
            "solution": "The problem requires the derivation and implementation of the attenuation factor for a plane wave traversing a discrete cell within a Stretched-Coordinate Perfectly Matched Layer (SC-PML). The derivation begins with Maxwell’s equations in the frequency domain for a source-free, linear, and homogeneous medium, assuming a time-harmonic convention of $e^{j\\omega t}$:\n$$ \\nabla \\times \\vec{E} = -j\\omega\\mu_0 \\vec{H} $$\n$$ \\nabla \\times \\vec{H} = j\\omega\\varepsilon_0 \\vec{E} $$\n\nFor a plane wave polarized with $\\vec{E} = E_y(x)\\hat{y}$ and $\\vec{H} = H_z(x)\\hat{z}$ propagating along the $x$-axis, these equations reduce to:\n$$ \\frac{\\partial E_y}{\\partial x} = -j\\omega\\mu_0 H_z $$\n$$ \\frac{\\partial H_z}{\\partial x} = -j\\omega\\varepsilon_0 E_y $$\n\nThe SC-PML is introduced through a complex coordinate stretching in the direction of propagation. In the frequency domain, the operator $\\frac{\\partial}{\\partial x}$ is replaced by $\\frac{1}{s_x(x)}\\frac{\\partial}{\\partial x}$. The stretching factor $s_x(x)$ is defined based on the problem statement as:\n$$ s_x(x) = \\kappa_x + \\frac{\\sigma(x)}{j\\omega\\varepsilon_0} $$\nWith the given parameters $\\kappa_x=1$ and the conductivity profile $\\sigma(x)$, this becomes:\n$$ s_x(x) = 1 + \\frac{\\sigma(x)}{j\\omega\\varepsilon_0} $$\n\nApplying this transformation to Maxwell's equations yields the modified equations within the PML:\n$$ \\frac{1}{s_x(x)} \\frac{\\partial E_y}{\\partial x} = -j\\omega\\mu_0 H_z \\implies \\frac{\\partial E_y}{\\partial x} = -j\\omega\\mu_0 s_x(x) H_z $$\n$$ \\frac{1}{s_x(x)} \\frac{\\partial H_z}{\\partial x} = -j\\omega\\varepsilon_0 E_y \\implies \\frac{\\partial H_z}{\\partial x} = -j\\omega\\varepsilon_0 s_x(x) E_y $$\nThese equations are equivalent to wave propagation in a medium with effective permittivity $\\varepsilon_{\\text{eff}}(x) = \\varepsilon_0 s_x(x)$ and effective permeability $\\mu_{\\text{eff}}(x) = \\mu_0 s_x(x)$. The local wave impedance is $Z(x) = \\sqrt{\\frac{\\mu_{\\text{eff}}(x)}{\\varepsilon_{\\text{eff}}(x)}} = \\sqrt{\\frac{\\mu_0 s_x(x)}{\\varepsilon_0 s_x(x)}} = \\sqrt{\\frac{\\mu_0}{\\varepsilon_0}} = \\eta_0$, the intrinsic impedance of free space. This impedance matching ensures no reflection at the PML interface for a continuous profile where $\\sigma(0)=0$.\n\nThe local wave number in the PML medium is given by:\n$$ k_{\\text{pml}}(x) = \\omega \\sqrt{\\mu_{\\text{eff}}(x) \\varepsilon_{\\text{eff}}(x)} = \\omega \\sqrt{(\\mu_0 s_x(x))(\\varepsilon_0 s_x(x))} = \\omega\\sqrt{\\mu_0\\varepsilon_0} s_x(x) = k_0 s_x(x) $$\nwhere $k_0 = \\omega\\sqrt{\\mu_0\\varepsilon_0}$ is the free-space wave number.\n\nA plane wave propagating from $x_1$ to $x_2$ accumulates a phase factor given by $\\exp\\left(-j \\int_{x_1}^{x_2} k_{\\text{pml}}(x') dx'\\right)$. The argument of the exponential is:\n$$ -j \\int_{x_1}^{x_2} k_0 s_x(x') dx' = -j \\int_{x_1}^{x_2} k_0 \\left(1 + \\frac{\\sigma(x')}{j\\omega\\varepsilon_0}\\right) dx' $$\n$$ = -j k_0 \\int_{x_1}^{x_2} dx' - \\frac{k_0}{\\omega\\varepsilon_0} \\int_{x_1}^{x_2} \\sigma(x') dx' $$\nThe first term, $-j k_0 (x_2-x_1)$, is purely imaginary and represents phase rotation. The second term is purely real and represents attenuation. The magnitude of the propagation factor is determined by this real term. Let us evaluate the constant factor:\n$$ \\frac{k_0}{\\omega\\varepsilon_0} = \\frac{\\omega\\sqrt{\\mu_0\\varepsilon_0}}{\\omega\\varepsilon_0} = \\sqrt{\\frac{\\mu_0}{\\varepsilon_0}} = \\eta_0 $$\nThus, the attenuation factor magnitude, $A$, for a wave traversing the region from $x_1$ to $x_2$ is:\n$$ A = \\exp\\left(-\\eta_0 \\int_{x_1}^{x_2} \\sigma(x') dx'\\right) $$\nNotably, this expression is independent of the wave frequency $f$.\n\nThe problem requires this factor for each discrete cell $i$, which spans the interval $[(i-1)\\Delta x, i\\Delta x]$, where $\\Delta x = L/N$. The attenuation factor for cell $i$, denoted $A_i$, is:\n$$ A_i = \\exp\\left(-\\eta_0 \\int_{(i-1)\\Delta x}^{i\\Delta x} \\sigma(x') dx'\\right) $$\nThe conductivity profile is given as $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m$. We must now evaluate the integral for the $i$-th cell.\n$$ \\int_{(i-1)\\Delta x}^{i\\Delta x} \\sigma_{\\max}\\left(\\frac{x'}{L}\\right)^m dx' = \\frac{\\sigma_{\\max}}{L^m} \\int_{(i-1)\\Delta x}^{i\\Delta x} (x')^m dx' $$\nFor $m \\ge 0$, the integral is:\n$$ \\frac{\\sigma_{\\max}}{L^m} \\left[\\frac{(x')^{m+1}}{m+1}\\right]_{(i-1)\\Delta x}^{i\\Delta x} = \\frac{\\sigma_{\\max}}{L^m(m+1)} \\left[ (i\\Delta x)^{m+1} - ((i-1)\\Delta x)^{m+1} \\right] $$\nSubstituting $\\Delta x = L/N$, we get:\n$$ \\frac{\\sigma_{\\max}}{L^m(m+1)} \\frac{L^{m+1}}{N^{m+1}} \\left[ i^{m+1} - (i-1)^{m+1} \\right] = \\frac{\\sigma_{\\max} L}{(m+1)N^{m+1}} \\left[ i^{m+1} - (i-1)^{m+1} \\right] $$\nThis expression represents the integrated conductivity over cell $i$. Let's call this integral $I_i$.\nThe final expression for the attenuation factor magnitude for cell $i$ is:\n$$ A_i = \\exp\\left(-\\eta_0 I_i\\right) = \\exp\\left(-\\eta_0 \\frac{\\sigma_{\\max} L}{(m+1)N^{m+1}} \\left( i^{m+1} - (i-1)^{m+1} \\right)\\right) $$\nThis is the formula to be implemented for each cell $i=1, 2, \\dots, N$. For the special case $m=0$, the profile is constant, $\\sigma(x) = \\sigma_{\\max}$, and the integral simplifies to $I_i = \\sigma_{\\max}\\Delta x = \\sigma_{\\max}L/N$. Our general formula yields for $m=0$: $I_i = \\frac{\\sigma_{\\max}L}{(1)N^1}(i^1 - (i-1)^1) = \\frac{\\sigma_{\\max}L}{N}$, which is consistent.\nThe implementation will calculate this value $A_i$ for each cell in each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the per-cell attenuation factor magnitude for a plane wave in an SC-PML.\n    \"\"\"\n    # Define physical constants\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space (H/m)\n    EPSILON_0 = 8.854187817e-12  # Permittivity of free space (F/m)\n    ETA_0 = np.sqrt(MU_0 / EPSILON_0)  # Intrinsic impedance of free space (Ohms)\n\n    # Test suite parameter sets: (f, L, N, sigma_max, m)\n    test_cases = [\n        (2e9, 2.0e-2, 8, 9.781, 3),\n        (1.0e9, 5.0e-3, 1, 100.0, 1),\n        (5.0e9, 1.0e-2, 5, 50.0, 2),\n        (5.0e8, 1.0e-2, 5, 50.0, 2),\n        (3.0e9, 1.0e-2, 4, 25.0, 0),\n    ]\n\n    all_results = []\n    \n    for _, L, N, sigma_max, m in test_cases:\n        case_results = []\n        m_plus_1 = m + 1\n        \n        # Pre-compute the constant factor for the conductivity integral.\n        # The integral over cell i is: factor * (i^(m+1) - (i-1)^(m+1))\n        # Note: per the problem, m >= 0, so m+1 is always >= 1.\n        integral_const_factor = (sigma_max * L) / (m_plus_1 * (N ** m_plus_1))\n\n        for i in range(1, N + 1):\n            # Calculate the integrated conductivity over the i-th cell\n            integral_sigma = integral_const_factor * (i**m_plus_1 - (i - 1)**m_plus_1)\n            \n            # Calculate the attenuation factor magnitude\n            # A_i = exp(-eta_0 * integral_sigma)\n            attenuation_factor = np.exp(-ETA_0 * integral_sigma)\n            case_results.append(attenuation_factor)\n            \n        all_results.append(case_results)\n\n    # Format the output string to be a dense list of lists of floats.\n    # e.g., [[0.1,0.2],[0.3,0.4]]\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "While PMLs are designed to absorb outgoing waves, their implementation on a discrete grid, such as the Finite-Difference Time-Domain (FDTD) Yee scheme, introduces numerical errors. This exercise, , explores the numerical dispersion that arises from this discretization within a PML region. By deriving the discrete dispersion relation and quantifying the resulting phase and group velocity errors, you will gain a deeper understanding of how the grid itself affects wave propagation accuracy inside the PML, a critical consideration for high-fidelity modeling.",
            "id": "3339168",
            "problem": "An infinite, homogeneous Perfectly Matched Layer (PML) region is modeled using the stretched-coordinate formulation, where the coordinate stretching factors are constant and real, denoted by $s_x$, $s_y$, and $s_z$, with $s_x > 0$, $s_y > 0$, and $s_z > 0$. The background material is vacuum with permittivity $\\epsilon_0$ and permeability $\\mu_0$, and speed of light $c = 1/\\sqrt{\\mu_0 \\epsilon_0}$. A three-dimensional Finite-Difference Time-Domain (FDTD) discretization uses the standard Yee scheme on a uniform Cartesian grid with spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$, and time step $\\Delta t$. The stretched-coordinate PML (SC-PML) is implemented by replacing spatial derivatives according to the rule $\\partial/\\partial x \\mapsto (1/s_x)\\,\\partial/\\partial x$, $\\partial/\\partial y \\mapsto (1/s_y)\\,\\partial/\\partial y$, and $\\partial/\\partial z \\mapsto (1/s_z)\\,\\partial/\\partial z$ in Maxwell’s curl equations, while keeping $\\epsilon_0$ and $\\mu_0$ unchanged.\n\nStarting from Maxwell’s curl equations and the Yee discretization, derive the discrete plane-wave dispersion relation that holds in this homogeneous SC-PML region for fields of the form $\\exp\\!\\big(i (k_x x + k_y y + k_z z - \\omega t)\\big)$, where $k_x$, $k_y$, $k_z$, and $\\omega$ are constants. Then specialize to a two-dimensional oblique-incidence case in the $x$–$y$ plane with transverse-electric-to-$z$ (TE$_z$) polarization, where $s_z = 1$, $\\Delta x = \\Delta y = \\Delta$, and the Courant number is $S = c\\,\\Delta t/\\Delta$ with $0  S  1/\\sqrt{2}$. In this two-dimensional specialization, let the wave vector be $k_x = k \\cos\\theta$ and $k_y = k \\sin\\theta$ with fixed angle $\\theta \\in (0,\\pi/2)$ and fixed magnitude $k > 0$.\n\nUsing a long-wavelength expansion valid for $k \\Delta \\ll 1$, compute the leading-order relative phase velocity error and the leading-order relative group velocity error introduced by the Yee discretization inside the SC-PML, both defined at fixed $(k,\\theta)$:\n- The relative phase velocity error is the ratio $(\\omega_{\\mathrm{d}}/\\omega) - 1$ to leading nontrivial order, where $\\omega_{\\mathrm{d}}$ is the discrete angular frequency predicted by the FDTD dispersion and $\\omega$ is the exact continuous SC-PML angular frequency for the same $(k_x,k_y)$.\n- The relative group velocity error is the ratio $(v_{g,\\mathrm{d}}/v_g) - 1$ to leading nontrivial order, where $v_{g,\\mathrm{d}} = \\partial \\omega_{\\mathrm{d}}/\\partial k$ at fixed $\\theta$ and $v_g = \\partial \\omega/\\partial k$ at fixed $\\theta$.\n\nExpress your final answers as closed-form analytic expressions in terms of $k$, $\\Delta$, $S$, $s_x$, $s_y$, and $\\theta$. Provide the two errors as a two-entry row matrix in the order $\\big[(\\omega_{\\mathrm{d}}/\\omega) - 1,\\; (v_{g,\\mathrm{d}}/v_g) - 1\\big]$. No numerical evaluation is required. The final answer must be an exact symbolic expression.",
            "solution": "The problem requires the derivation of the leading-order relative phase and group velocity errors for a plane wave in a 2D TE$_z$ system, discretized using the Finite-Difference Time-Domain (FDTD) method with a stretched-coordinate perfectly matched layer (SC-PML). The stretching factors $s_x$ and $s_y$ are real and constant.\n\nThe starting point is Maxwell's curl equations in a source-free, non-conductive medium:\n$$ \\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\n\nIn the stretched-coordinate formulation, the spatial derivatives are scaled: $\\frac{\\partial}{\\partial u} \\to \\frac{1}{s_u} \\frac{\\partial}{\\partial u}$ for $u \\in \\{x,y,z\\}$. This leads to the modified curl operator $\\nabla_s = \\left(\\hat{x}\\frac{1}{s_x}\\frac{\\partial}{\\partial x}, \\hat{y}\\frac{1}{s_y}\\frac{\\partial}{\\partial y}, \\hat{z}\\frac{1}{s_z}\\frac{\\partial}{\\partial z}\\right)$.\n\nFor a TE$_z$ wave propagating in the $x$-$y$ plane, the field components are $E_z$, $H_x$, and $H_y$, and there is no variation along $z$ (i.e., $\\partial/\\partial z = 0$). The problem specifies $s_z=1$, which is consistent. The relevant equations become:\n$$ \\frac{1}{s_y}\\frac{\\partial E_z}{\\partial y} = -\\mu_0 \\frac{\\partial H_x}{\\partial t} $$\n$$ -\\frac{1}{s_x}\\frac{\\partial E_z}{\\partial x} = -\\mu_0 \\frac{\\partial H_y}{\\partial t} $$\n$$ \\frac{1}{s_x}\\frac{\\partial H_y}{\\partial x} - \\frac{1}{s_y}\\frac{\\partial H_x}{\\partial y} = \\epsilon_0 \\frac{\\partial E_z}{\\partial t} $$\n\nFirst, we derive the exact continuous dispersion relation by substituting a plane-wave solution of the form $F = F_0 \\exp(i(k_x x + k_y y - \\omega t))$ into these equations. The operators transform as $\\partial/\\partial x \\to i k_x$, $\\partial/\\partial y \\to i k_y$, and $\\partial/\\partial t \\to -i \\omega$.\n$$ \\frac{i k_y}{s_y} E_z = i \\omega \\mu_0 H_x $$\n$$ -\\frac{i k_x}{s_x} E_z = i \\omega \\mu_0 H_y $$\n$$ \\frac{i k_x}{s_x} H_y - \\frac{i k_y}{s_y} H_x = -i \\omega \\epsilon_0 E_z $$\nSolving the first two equations for $H_x$ and $H_y$ and substituting into the third yields:\n$$ \\frac{k_x}{s_x} \\left( -\\frac{k_x}{\\omega \\mu_0 s_x} E_z \\right) - \\frac{k_y}{s_y} \\left( \\frac{k_y}{\\omega \\mu_0 s_y} E_z \\right) = -\\omega \\epsilon_0 E_z $$\n$$ -\\frac{1}{\\omega \\mu_0} \\left( \\frac{k_x^2}{s_x^2} + \\frac{k_y^2}{s_y^2} \\right) = -\\omega \\epsilon_0 $$\nUsing $c = 1/\\sqrt{\\mu_0 \\epsilon_0}$, the exact continuous dispersion relation is:\n$$ \\frac{\\omega^2}{c^2} = \\frac{k_x^2}{s_x^2} + \\frac{k_y^2}{s_y^2} $$\n\nNext, we derive the discrete dispersion relation from the Yee-discretized FDTD equations with grid spacing $\\Delta x = \\Delta y = \\Delta$ and time step $\\Delta t$. In the Yee scheme, centered finite-difference operators are used. For a plane wave, these operators transform as:\n$$ \\delta_t F \\to \\frac{-2i}{\\Delta t} \\sin\\left(\\frac{\\omega_d \\Delta t}{2}\\right) F $$\n$$ \\delta_x F \\to \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) F $$\n$$ \\delta_y F \\to \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) F $$\nApplying these to the discretized Maxwell's equations (with care for the staggering of field components, which is implicitly handled by this plane-wave analysis) yields:\n$$ \\frac{1}{s_y} \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) E_z = - \\mu_0 \\frac{-2i}{\\Delta t} \\sin\\left(\\frac{\\omega_d \\Delta t}{2}\\right) H_x $$\n$$ -\\frac{1}{s_x} \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) E_z = - \\mu_0 \\frac{-2i}{\\Delta t} \\sin\\left(\\frac{\\omega_d \\Delta t}{2}\\right) H_y $$\n$$ \\frac{1}{s_x} \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) H_y - \\frac{1}{s_y} \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) H_x = \\epsilon_0 \\frac{-2i}{\\Delta t} \\sin\\left(\\frac{\\omega_d \\Delta t}{2}\\right) E_z $$\nSolving for $H_x$ and $H_y$ and substituting into the third equation, similar to the continuous case, leads to the discrete dispersion relation:\n$$ \\frac{1}{s_x^2} \\left(\\frac{\\sin(k_x\\Delta/2)}{\\Delta/2}\\right)^2 + \\frac{1}{s_y^2} \\left(\\frac{\\sin(k_y\\Delta/2)}{\\Delta/2}\\right)^2 = \\frac{1}{c^2} \\left(\\frac{\\sin(\\omega_d\\Delta t/2)}{\\Delta t/2}\\right)^2 $$\nUsing the Courant number $S = c \\Delta t / \\Delta$, we can write this as:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\omega_d \\Delta t}{2}\\right) = \\frac{1}{s_x^2} \\sin^2\\left(\\frac{k_x \\Delta}{2}\\right) + \\frac{1}{s_y^2} \\sin^2\\left(\\frac{k_y \\Delta}{2}\\right) $$\nThis is the discrete dispersion relation for the angular frequency $\\omega_d$.\n\nFor the long-wavelength expansion ($k \\Delta \\ll 1$), we use the Taylor series $\\sin(u) \\approx u - u^3/6$.\n$$ \\frac{1}{S^2} \\left(\\frac{\\omega_d \\Delta t}{2} - \\frac{(\\omega_d \\Delta t)^3}{48}\\right)^2 \\approx \\frac{1}{s_x^2} \\left(\\frac{k_x \\Delta}{2} - \\frac{(k_x \\Delta)^3}{48}\\right)^2 + \\frac{1}{s_y^2} \\left(\\frac{k_y \\Delta}{2} - \\frac{(k_y \\Delta)^3}{48}\\right)^2 $$\nExpanding the squares and keeping terms up to fourth order in the small quantities:\n$$ \\frac{(\\omega_d \\Delta t)^2}{4S^2} \\left(1 - \\frac{(\\omega_d \\Delta t)^2}{12}\\right) \\approx \\frac{(k_x \\Delta)^2}{4s_x^2} \\left(1 - \\frac{(k_x \\Delta)^2}{12}\\right) + \\frac{(k_y \\Delta)^2}{4s_y^2} \\left(1 - \\frac{(k_y \\Delta)^2}{12}\\right) $$\nSubstitute $\\Delta t = S \\Delta/c$:\n$$ \\frac{\\omega_d^2 \\Delta^2}{4c^2} \\left(1 - \\frac{\\omega_d^2 S^2 \\Delta^2}{12c^2}\\right) \\approx \\frac{\\Delta^2}{4} \\left( \\frac{k_x^2}{s_x^2} - \\frac{k_x^4 \\Delta^2}{12s_x^2} + \\frac{k_y^2}{s_y^2} - \\frac{k_y^4 \\Delta^2}{12s_y^2} \\right) $$\n$$ \\frac{\\omega_d^2}{c^2} \\approx \\left( \\frac{k_x^2}{s_x^2} + \\frac{k_y^2}{s_y^2} \\right) - \\frac{\\Delta^2}{12} \\left( \\frac{k_x^4}{s_x^2} + \\frac{k_y^4}{s_y^2} \\right) + \\frac{\\omega_d^4 S^2\\Delta^2}{12c^4} $$\nIn the error terms, we can approximate $\\omega_d$ with the continuous frequency $\\omega$, where $\\omega^2/c^2 = k_x^2/s_x^2 + k_y^2/s_y^2$.\n$$ \\frac{\\omega_d^2}{c^2} \\approx \\frac{\\omega^2}{c^2} - \\frac{\\Delta^2}{12} \\left(\\frac{k_x^4}{s_x^2} + \\frac{k_y^4}{s_y^2}\\right) + \\frac{\\omega^4 S^2 \\Delta^2}{12 c^4} $$\nDividing by $\\omega^2/c^2 = k_x^2/s_x^2 + k_y^2/s_y^2$:\n$$ \\frac{\\omega_d^2}{\\omega^2} \\approx 1 - \\frac{c^2 \\Delta^2}{12 \\omega^2} \\left(\\frac{k_x^4}{s_x^2} + \\frac{k_y^4}{s_y^2}\\right) + \\frac{\\omega^2 S^2 \\Delta^2}{12 c^2} $$\n$$ \\frac{\\omega_d^2}{\\omega^2} \\approx 1 + \\frac{\\Delta^2}{12} \\left( S^2 \\frac{\\omega^2}{c^2} - \\frac{k_x^4/s_x^2 + k_y^4/s_y^2}{\\omega^2/c^2} \\right) $$\n$$ \\frac{\\omega_d^2}{\\omega^2} \\approx 1 + \\frac{\\Delta^2}{12} \\left( S^2 \\left(\\frac{k_x^2}{s_x^2} + \\frac{k_y^2}{s_y^2}\\right) - \\frac{k_x^4/s_x^2 + k_y^4/s_y^2}{k_x^2/s_x^2 + k_y^2/s_y^2} \\right) $$\nThe relative phase velocity error is $(\\omega_d/\\omega) - 1$. For a small error term $X$, $\\sqrt{1+X} \\approx 1+X/2$.\n$$ \\frac{\\omega_d}{\\omega} - 1 \\approx \\frac{\\Delta^2}{24} \\left( S^2 \\left(\\frac{k_x^2}{s_x^2} + \\frac{k_y^2}{s_y^2}\\right) - \\frac{k_x^4/s_x^2 + k_y^4/s_y^2}{k_x^2/s_x^2 + k_y^2/s_y^2} \\right) $$\nSubstituting $k_x = k \\cos\\theta$ and $k_y = k \\sin\\theta$:\n$$ \\frac{\\omega_d}{\\omega} - 1 \\approx \\frac{(k\\Delta)^2}{24} \\left( S^2 \\left(\\frac{\\cos^2\\theta}{s_x^2} + \\frac{\\sin^2\\theta}{s_y^2}\\right) - \\frac{\\cos^4\\theta/s_x^2 + \\sin^4\\theta/s_y^2}{\\cos^2\\theta/s_x^2 + \\sin^2\\theta/s_y^2} \\right) $$\nThis expression gives the leading-order relative phase velocity error.\n\nFor the group velocity, $v_g = \\partial \\omega / \\partial k$. From the continuous relation, $\\omega = c k \\sqrt{\\frac{\\cos^2\\theta}{s_x^2} + \\frac{\\sin^2\\theta}{s_y^2}}$.\nSince $\\omega$ is linear in $k$ for fixed $\\theta$, the group velocity is $v_g = \\partial\\omega/\\partial k = \\omega/k$.\nLet the phase velocity error be $(\\omega_d/\\omega) - 1 = C (k\\Delta)^2$, where $C$ is the term derived above, independent of $k$.\nThen $\\omega_d \\approx \\omega (1 + C k^2 \\Delta^2) = (k v_g)(1 + C k^2 \\Delta^2) = v_g k + C v_g \\Delta^2 k^3$.\nThe discrete group velocity is $v_{g,d} = \\partial \\omega_d / \\partial k$:\n$$ v_{g,d} = \\frac{\\partial}{\\partial k} (v_g k + C v_g \\Delta^2 k^3) = v_g + 3 C v_g \\Delta^2 k^2 = v_g(1 + 3 C k^2 \\Delta^2) $$\nThe relative group velocity error is:\n$$ \\frac{v_{g,d}}{v_g} - 1 \\approx 3 C (k\\Delta)^2 = 3 \\left(\\frac{\\omega_d}{\\omega} - 1\\right) $$\n$$ \\frac{v_{g,d}}{v_g} - 1 \\approx \\frac{(k\\Delta)^2}{8} \\left( S^2 \\left(\\frac{\\cos^2\\theta}{s_x^2} + \\frac{\\sin^2\\theta}{s_y^2}\\right) - \\frac{\\cos^4\\theta/s_x^2 + \\sin^4\\theta/s_y^2}{\\cos^2\\theta/s_x^2 + \\sin^2\\theta/s_y^2} \\right) $$\n\nThe two requested errors are thus identified.\nThe first error is the relative phase velocity error, $(\\omega_d/\\omega)-1$.\nThe second error is the relative group velocity error, $(v_{g,d}/v_g)-1$.\nWe present them as a two-entry row matrix.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{(k\\Delta)^{2}}{24} \\left[ S^{2} \\left( \\frac{\\cos^{2}\\theta}{s_x^{2}} + \\frac{\\sin^{2}\\theta}{s_y^{2}} \\right) - \\frac{\\frac{\\cos^{4}\\theta}{s_x^{2}} + \\frac{\\sin^{4}\\theta}{s_y^{2}}}{\\frac{\\cos^{2}\\theta}{s_x^{2}} + \\frac{\\sin^{2}\\theta}{s_y^{2}}} \\right]  \\frac{(k\\Delta)^{2}}{8} \\left[ S^{2} \\left( \\frac{\\cos^{2}\\theta}{s_x^{2}} + \\frac{\\sin^{2}\\theta}{s_y^{2}} \\right) - \\frac{\\frac{\\cos^{4}\\theta}{s_x^{2}} + \\frac{\\sin^{4}\\theta}{s_y^{2}}}{\\frac{\\cos^{2}\\theta}{s_x^{2}} + \\frac{\\sin^{2}\\theta}{s_y^{2}}} \\right] \\end{pmatrix} } $$"
        },
        {
            "introduction": "In time-domain simulations, the frequency-dependent nature of the SC-PML translates into a convolution operation in time, leading to what is known as a Convolutional PML (CPML). Storing past field values to compute this convolution can be prohibitively expensive in terms of memory. This advanced problem, , explores a common and powerful optimization strategy: approximating the exact convolution kernel with a simpler, computationally efficient recursive filter. This highlights the practical engineering trade-offs between physical accuracy and computational resources, demonstrating how signal processing techniques can be used to design efficient numerical absorbers.",
            "id": "3339157",
            "problem": "A one-dimensional transverse electromagnetic plane wave is simulated with a Finite-Difference Time-Domain (FDTD) scheme in a homogeneous, isotropic medium with electric permittivity $\\varepsilon$ and magnetic permeability $\\mu$. A Perfectly Matched Layer (PML) is implemented on the $x$ boundary using stretched-coordinate PML, where the constitutive derivative along $x$ is modified via the complex coordinate stretch $s_x(\\omega) = \\kappa_x + \\frac{\\sigma_x}{\\alpha_x + j \\omega \\varepsilon}$, with $\\kappa_x > 0$, $\\sigma_x \\ge 0$, and $\\alpha_x \\ge 0$ constant. In the time domain, this yields a Convolutional Perfectly Matched Layer (CPML) correction that can be written as a convolution of a causal impulse response $h(t)$ with the relevant field derivative.\n\nTo reduce memory, the CPML convolution is approximated by a single-pole Recursive Convolution (RC) filter of the form $h_{\\text{RC}}(t) = c \\exp(-b t)$, $t \\ge 0$, with parameters $b > 0$ and $c > 0$. In this configuration, the frequency-domain target response arising from the stretched coordinate and its discretization is represented by a two-pole real-rational function whose time-domain impulse response is\n$$\nh(t) = A \\exp(-\\alpha t) + B \\exp(-\\beta t),\n$$\nwith $A > 0$, $B > 0$, $\\alpha > 0$, and $\\beta > 0$ determined by the PML profile and digital discretization. The approximation quality is quantified by the squared $L_2$ norm of the impulse-response error on $[0,\\infty)$,\n$$\nJ(c,b) = \\int_{0}^{\\infty} \\left( c \\exp(-b t) - h(t) \\right)^{2} \\, dt,\n$$\nand the design objective is to choose $b$ (with associated optimal $c$) to minimize $J$.\n\nStarting from Maxwell’s equations and the stretched-coordinate formulation, justify the convolutional form and the rational approximation of $h(t)$ as above. Then, using first principles of least-squares approximation in $L_2([0,\\infty))$, derive the stationarity condition for the optimal decay rate $b^{\\star}$ when $c$ is chosen to minimize $J$ for a given $b$. Finally, for the specific PML parameters\n$$\nA = 1.5, \\quad B = 0.5, \\quad \\alpha = 1.0 \\;\\text{s}^{-1}, \\quad \\beta = 4.0 \\;\\text{s}^{-1},\n$$\ncompute the optimal decay rate $b^{\\star}$ that minimizes $J$ and present its value. Express your final answer in $\\text{s}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem asks for three main tasks: first, to justify the convolutional form of the Perfectly Matched Layer (PML) and the rational approximation of its impulse response; second, to derive the stationarity condition for the optimal decay rate $b^{\\star}$ of a single-pole recursive filter used to approximate the PML kernel; and third, to compute the value of $b^{\\star}$ for a specific set of parameters.\n\n**Part 1: Justification of the Convolutional Form and Rational Approximation**\n\nLet's begin with Maxwell's equations in a source-free, homogeneous, isotropic medium. For a one-dimensional transverse electromagnetic (TEM) wave propagating along the $x$-axis with electric field in the $z$-direction ($E_z$) and magnetic field in the $y$-direction ($H_y$), the relevant equations are:\n$$\n\\varepsilon \\frac{\\partial E_z}{\\partial t} = \\frac{\\partial H_y}{\\partial x}\n$$\n$$\n\\mu \\frac{\\partial H_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\nIn the frequency domain, with the time-harmonic convention $e^{j \\omega t}$, these become:\n$$\nj \\omega \\varepsilon E_z(\\omega) = \\frac{d H_y(\\omega)}{d x}\n$$\n$$\nj \\omega \\mu H_y(\\omega) = \\frac{d E_z(\\omega)}{d x}\n$$\nThe stretched-coordinate PML formulation modifies the spatial derivative operator $\\frac{\\partial}{\\partial x}$ in the PML region. The operator is replaced by $\\frac{1}{s_x(\\omega)} \\frac{\\partial}{\\partial x}$, where $s_x(\\omega)$ is the complex stretching factor. The problem specifies this factor as:\n$$\ns_x(\\omega) = \\kappa_x + \\frac{\\sigma_x}{\\alpha_x + j \\omega \\varepsilon}\n$$\nHere, $\\kappa_x \\ge 1$ is a real stretching factor, $\\sigma_x \\ge 0$ provides the loss, and $\\alpha_x \\ge 0$ is a parameter controlling the frequency dependence of the loss. Applying this transformation to the first Maxwell's equation gives:\n$$\nj \\omega \\varepsilon E_z(\\omega) = \\frac{1}{s_x(\\omega)} \\frac{d H_y(\\omega)}{d x}\n$$\nThis equation establishes the convolutional relationship. In the time domain, multiplication in the frequency domain becomes a convolution. Let $f(t) = \\frac{\\partial H_y(t)}{\\partial x}$ and $S(\\omega) = \\frac{1}{s_x(\\omega)}$. Then the time-domain equation is:\n$$\n\\varepsilon \\frac{\\partial E_z(t)}{\\partial t} = \\mathcal{F}^{-1}\\{S(\\omega)\\} * f(t) = s(t) * f(t)\n$$\nwhere $*$ denotes convolution and $s(t)$ is the inverse Fourier transform of $S(\\omega)$. This justifies the convolutional form.\n\nOften, to facilitate a recursive implementation in the time domain (known as Recursive Convolution or RC), the term is split. We can write $S(\\omega) = \\frac{1}{s_x(\\omega)}$ as:\n$$\nS(\\omega) = \\frac{1}{\\kappa_x + \\frac{\\sigma_x}{\\alpha_x + j \\omega \\varepsilon}} = \\frac{1}{\\kappa_x} \\left( \\frac{1}{1 + \\frac{\\sigma_x/\\kappa_x}{\\alpha_x+j\\omega \\varepsilon}} \\right)\n$$\nFor implementation, it is common to use the auxiliary differential equation (ADE) method that arises from this structure. However, the problem statement indicates that the target impulse response $h(t)$ for the \"CPML correction\" arises from both the continuous-time stretched coordinate and its discretization in the FDTD scheme. The discretization process, particularly how the time derivatives and integrals are approximated (e.g., using semi-implicit schemes for the ADEs), transforms the single-pole continuous-time response into a more complex discrete-time response. When this discrete-time response is mapped back to a continuous-time equivalent for analysis and design, it can be accurately represented by a multi-pole rational function. The problem states this effective kernel is well-approximated by a two-pole system whose impulse response is a sum of two real exponentials:\n$$\nh(t) = A \\exp(-\\alpha t) + B \\exp(-\\beta t)\n$$\nThis form is a standard and justifiable premise in the advanced analysis of FDTD-based CPML implementations.\n\n**Part 2: Derivation of the Stationarity Condition for $b^{\\star}$**\n\nThe objective is to find parameters $c > 0$ and $b > 0$ for the approximating function $h_{\\text{RC}}(t) = c \\exp(-b t)$ that minimize the squared $L_2$ error norm:\n$$\nJ(c,b) = \\int_{0}^{\\infty} \\left( c \\exp(-b t) - h(t) \\right)^{2} \\, dt\n$$\nFirst, for a fixed value of $b$, we find the optimal $c$ by setting the partial derivative of $J$ with respect to $c$ to zero:\n$$\n\\frac{\\partial J}{\\partial c} = \\int_{0}^{\\infty} 2 \\left( c \\exp(-b t) - h(t) \\right) \\exp(-b t) \\, dt = 0\n$$\n$$\nc \\int_{0}^{\\infty} \\exp(-2b t) \\, dt = \\int_{0}^{\\infty} h(t) \\exp(-b t) \\, dt\n$$\nThe integral on the left is $\\int_{0}^{\\infty} \\exp(-2b t) \\, dt = \\left[ -\\frac{1}{2b} \\exp(-2bt) \\right]_0^\\infty = \\frac{1}{2b}$ for $b>0$. The integral on the right is the Laplace transform of $h(t)$ evaluated at $s=b$, which we denote as $\\hat{h}(b)$.\n$$\nc \\left( \\frac{1}{2b} \\right) = \\hat{h}(b) \\implies c(b) = 2b \\, \\hat{h}(b)\n$$\nThis gives the optimal $c$ as a function of $b$. We substitute this back into the expression for $J$ to obtain a function of $b$ alone:\n$$\nJ(b) = \\int_{0}^{\\infty} \\left( (2b \\, \\hat{h}(b)) \\exp(-b t) - h(t) \\right)^{2} \\, dt\n$$\nExpanding the square:\n$$\nJ(b) = (2b \\, \\hat{h}(b))^2 \\int_{0}^{\\infty} \\exp(-2bt) dt - 2(2b \\, \\hat{h}(b)) \\int_{0}^{\\infty} h(t) \\exp(-bt) dt + \\int_{0}^{\\infty} h(t)^2 dt\n$$\n$$\nJ(b) = (4b^2 \\hat{h}(b)^2) \\left(\\frac{1}{2b}\\right) - 4b \\, \\hat{h}(b) (\\hat{h}(b)) + \\int_{0}^{\\infty} h(t)^2 dt\n$$\n$$\nJ(b) = 2b \\, \\hat{h}(b)^2 - 4b \\, \\hat{h}(b)^2 + \\int_{0}^{\\infty} h(t)^2 dt = -2b \\, \\hat{h}(b)^2 + \\int_{0}^{\\infty} h(t)^2 dt\n$$\nTo minimize $J(b)$, we need to maximize the term $b \\, \\hat{h}(b)^2$ (since the second term is a constant with respect to $b$). We find the stationary points by setting the derivative with respect to $b$ to zero:\n$$\n\\frac{dJ}{db} = -2\\frac{d}{db} \\left[ b \\, (\\hat{h}(b))^2 \\right] = 0\n$$\nUsing the product rule:\n$$\n\\frac{d}{db} \\left[ b \\, (\\hat{h}(b))^2 \\right] = 1 \\cdot (\\hat{h}(b))^2 + b \\cdot \\left[ 2 \\hat{h}(b) \\frac{d\\hat{h}(b)}{db} \\right] = 0\n$$\nAssuming a non-trivial approximation where $\\hat{h}(b) \\neq 0$, we can divide by $\\hat{h}(b)$:\n$$\n\\hat{h}(b) + 2b \\, \\frac{d\\hat{h}(b)}{db} = 0\n$$\nLetting $\\hat{h}'(b) = \\frac{d\\hat{h}(b)}{db}$, the stationarity condition for the optimal decay rate $b^{\\star}$ is:\n$$\n\\hat{h}(b^{\\star}) + 2b^{\\star} \\hat{h}'(b^{\\star}) = 0\n$$\n\n**Part 3: Computation of the Optimal Decay Rate $b^{\\star}$**\n\nWe are given the target impulse response:\n$$\nh(t) = A \\exp(-\\alpha t) + B \\exp(-\\beta t)\n$$\nwith parameters $A = 1.5$, $B = 0.5$, $\\alpha = 1.0 \\;\\text{s}^{-1}$, and $\\beta = 4.0 \\;\\text{s}^{-1}$. First, we compute its Laplace transform $\\hat{h}(b)$:\n$$\n\\hat{h}(b) = \\int_0^\\infty (A e^{-\\alpha t} + B e^{-\\beta t}) e^{-bt} dt = A \\int_0^\\infty e^{-(\\alpha+b)t} dt + B \\int_0^\\infty e^{-(\\beta+b)t} dt \n$$\n$$\n\\hat{h}(b) = \\frac{A}{\\alpha+b} + \\frac{B}{\\beta+b}\n$$\nNext, we compute its derivative with respect to $b$:\n$$\n\\hat{h}'(b) = -\\frac{A}{(\\alpha+b)^2} - \\frac{B}{(\\beta+b)^2}\n$$\nSubstituting these into the stationarity condition:\n$$\n\\left( \\frac{A}{\\alpha+b} + \\frac{B}{\\beta+b} \\right) + 2b \\left( -\\frac{A}{(\\alpha+b)^2} - \\frac{B}{(\\beta+b)^2} \\right) = 0\n$$\nGrouping terms by $A$ and $B$:\n$$\nA \\left( \\frac{1}{\\alpha+b} - \\frac{2b}{(\\alpha+b)^2} \\right) + B \\left( \\frac{1}{\\beta+b} - \\frac{2b}{(\\beta+b)^2} \\right) = 0\n$$\n$$\nA \\left( \\frac{(\\alpha+b)-2b}{(\\alpha+b)^2} \\right) + B \\left( \\frac{(\\beta+b)-2b}{(\\beta+b)^2} \\right) = 0\n$$\n$$\nA \\frac{\\alpha-b}{(\\alpha+b)^2} + B \\frac{\\beta-b}{(\\beta+b)^2} = 0\n$$\nNow, we substitute the given numerical values:\n$$\n1.5 \\frac{1.0-b}{(1.0+b)^2} + 0.5 \\frac{4.0-b}{(4.0+b)^2} = 0\n$$\nTo simplify, we multiply the equation by $2$:\n$$\n3 \\frac{1-b}{(1+b)^2} + \\frac{4-b}{(4+b)^2} = 0\n$$\nTo solve for $b$, we clear the denominators:\n$$\n3(1-b)(4+b)^2 + (4-b)(1+b)^2 = 0\n$$\nExpanding the squared terms: $(4+b)^2 = 16+8b+b^2$ and $(1+b)^2 = 1+2b+b^2$.\n$$\n3(1-b)(16+8b+b^2) + (4-b)(1+2b+b^2) = 0\n$$\n$$\n3(16+8b+b^2-16b-8b^2-b^3) + (4+8b+4b^2-b-2b^2-b^3) = 0\n$$\n$$\n3(16-8b-7b^2-b^3) + (4+7b+2b^2-b^3) = 0\n$$\n$$\n48 - 24b - 21b^2 - 3b^3 + 4 + 7b + 2b^2 - b^3 = 0\n$$\nCombining like terms yields a cubic equation for $b$:\n$$\n-4b^3 - 19b^2 - 17b + 52 = 0\n$$\nOr, multiplying by $-1$:\n$$\n4b^3 + 19b^2 + 17b - 52 = 0\n$$\nWe seek the positive real root of this polynomial. Let $F(b) = 4b^3 + 19b^2 + 17b - 52$.\n$F(1) = 4 + 19 + 17 - 52 = -12$.\n$F(2) = 4(8) + 19(4) + 17(2) - 52 = 32 + 76 + 34 - 52 = 90$.\nSince $F(1)  0$ and $F(2) > 0$, a root $b^{\\star}$ exists in the interval $(1, 2)$. Using a numerical solver (e.g., Newton's method or a calculator), we find the root to be approximately $b^{\\star} \\approx 1.16607$.\nRounding to four significant figures gives $b^{\\star} = 1.166$. The units are inherited from $\\alpha$ and $\\beta$, which are $\\text{s}^{-1}$.",
            "answer": "$$\\boxed{1.166}$$"
        }
    ]
}