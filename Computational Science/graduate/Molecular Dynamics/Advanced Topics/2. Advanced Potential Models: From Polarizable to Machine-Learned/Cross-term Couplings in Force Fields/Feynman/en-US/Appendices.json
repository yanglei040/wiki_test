{
    "hands_on_practices": [
        {
            "introduction": "Before implementing any energy term in a force field, we must first ensure its physical and mathematical consistency. This foundational exercise focuses on the dimensional analysis of a stretch-bend cross-term constant, $k_{r\\theta}$. By ensuring that the units on both sides of the potential energy equation match, you will practice a critical first step in force field validation and explore the often-overlooked subtleties of handling angular units, which is a common source of error in custom implementations .",
            "id": "3406760",
            "problem": "Consider a molecular mechanics force field in which the potential energy includes a cross-term coupling between a bond length and a bond angle of a triatomic fragment. Let the bond length be denoted by $r$ and the bond angle by $\\theta$, with their respective equilibrium values $r_{0}$ and $\\theta_{0}$. The cross-term contribution to the potential energy is modeled as\n$$\nE_{r\\theta} = k_{r\\theta}\\,(r - r_{0})\\,(\\theta - \\theta_{0}) \\, ,\n$$\nwhere $k_{r\\theta}$ is a coupling parameter to be determined for unit consistency. You may assume that $E_{r\\theta}$ is part of a physical potential energy, so it must carry the physical dimension of energy. Treat angles in radians and take the radian as a distinct dimension for plane angle during dimensional bookkeeping to ensure consistency of unit conversions between degrees and radians. Starting from the fundamental definitions that energy has the same dimension as work and that work equals force times displacement, and that force equals mass times acceleration, perform a dimensional analysis to determine the dimension of $k_{r\\theta}$ in terms of the base dimensions mass, length, time, and plane angle.\n\nAdditionally, verify that if $\\theta$ were numerically expressed in degrees instead of radians, the numerical value of $k_{r\\theta}$ must change by the appropriate conversion factor to keep $E_{r\\theta}$ invariant, and interpret this invariance in terms of the angle dimension you introduce.\n\nExpress your final answer as a closed-form analytic expression using the dimension symbols for energy $E$, length $L$, and plane angle $\\Theta$ (radian). Do not include any physical units in your final answer.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard problem in dimensional analysis applied to a common functional form used in molecular mechanics force fields. All necessary information is provided, and the problem is free of contradictions or ambiguities. Therefore, a solution can be derived.\n\nThe problem asks for the dimension of the coupling parameter $k_{r\\theta}$ in the potential energy expression for a bond-angle cross-term:\n$$\nE_{r\\theta} = k_{r\\theta}\\,(r - r_{0})\\,(\\theta - \\theta_{0})\n$$\nThe dimension of any physical quantity $X$ will be denoted by $[X]$. The problem specifies that the dimensions for energy, length, and plane angle should be represented by the symbols $E$, $L$, and $\\Theta$ respectively.\n\nThe term $E_{r\\theta}$ represents energy, so its dimension is $[E_{r\\theta}] = E$.\nThe term $(r - r_{0})$ represents a difference in bond lengths. Since both $r$ and $r_0$ have the dimension of length, their difference also has the dimension of length. Thus, $[r - r_0] = L$.\nThe term $(\\theta - \\theta_{0})$ represents a difference in bond angles. The problem explicitly states that the plane angle is to be treated as a distinct dimension, $\\Theta$. Therefore, $[\\theta - \\theta_0] = \\Theta$.\n\nThe dimensional homogeneity principle requires that the dimensions on both sides of the equation must be equal. We can write the dimensional equation as:\n$$\n[E_{r\\theta}] = [k_{r\\theta}] [r - r_0] [\\theta - \\theta_0]\n$$\nSubstituting the known dimensions:\n$$\nE = [k_{r\\theta}] \\cdot L \\cdot \\Theta\n$$\nSolving for the dimension of the coupling parameter, $[k_{r\\theta}]$, we get:\n$$\n[k_{r\\theta}] = \\frac{E}{L \\cdot \\Theta} = E L^{-1} \\Theta^{-1}\n$$\nThis is the dimension of $k_{r\\theta}$ expressed in terms of the dimensions of energy, length, and plane angle, as requested for the final answer.\n\nFor completeness, we can express this result in terms of the base dimensions of mass ($M$), length ($L$), time ($T$), and plane angle ($\\Theta$). Energy has the same dimension as work, which is force multiplied by displacement. Force is mass multiplied by acceleration.\nThe dimension of acceleration is $[a] = L T^{-2}$.\nThe dimension of force is $[F] = [m][a] = M L T^{-2}$.\nThe dimension of energy is $[E] = [F][\\text{displacement}] = (M L T^{-2}) L = M L^2 T^{-2}$.\nSubstituting this expression for $E$ into our result for $[k_{r\\theta}]$:\n$$\n[k_{r\\theta}] = (M L^2 T^{-2}) L^{-1} \\Theta^{-1} = M L T^{-2} \\Theta^{-1}\n$$\n\nNext, we verify the effect of changing the unit of angle from radians to degrees. The physical quantity, energy $E_{r\\theta}$, must be invariant to the choice of units. Let $\\{X\\}$ denote the numerical value of a quantity $X$. The potential energy formula is implemented using numerical values:\n$$\n\\{E_{r\\theta}\\} = \\{k_{r\\theta}\\} \\{r - r_0\\} \\{\\theta - \\theta_0\\}\n$$\nLet's consider the case where angles are expressed in radians (rad) and degrees (deg). The energy $\\{E_{r\\theta}\\}$ and the length difference $\\{r-r_0\\}$ are unaffected by the choice of angular unit. Therefore, the product $\\{k_{r\\theta}\\} \\{\\theta - \\theta_0\\}$ must be invariant.\n$$\n\\{k_{r\\theta}\\}_{\\text{rad}} \\{\\theta - \\theta_0\\}_{\\text{rad}} = \\{k_{r\\theta}\\}_{\\text{deg}} \\{\\theta - \\theta_0\\}_{\\text{deg}}\n$$\nThe conversion between the numerical value of an angle in degrees and radians is:\n$$\n\\{\\theta\\}_{\\text{deg}} = \\{\\theta\\}_{\\text{rad}} \\cdot \\frac{180}{\\pi}\n$$\nThis relationship also holds for the difference $(\\theta - \\theta_0)$. Substituting this into the invariance equation:\n$$\n\\{k_{r\\theta}\\}_{\\text{rad}} \\{\\theta - \\theta_0\\}_{\\text{rad}} = \\{k_{r\\theta}\\}_{\\text{deg}} \\left( \\{\\theta - \\theta_0\\}_{\\text{rad}} \\cdot \\frac{180}{\\pi} \\right)\n$$\nAssuming $\\{\\theta - \\theta_0\\}_{\\text{rad}} \\neq 0$, we can cancel this term from both sides, yielding the relationship between the numerical values of the coupling parameter:\n$$\n\\{k_{r\\theta}\\}_{\\text{rad}} = \\{k_{r\\theta}\\}_{\\text{deg}} \\cdot \\frac{180}{\\pi}\n$$\nor, equivalently,\n$$\n\\{k_{r\\theta}\\}_{\\text{deg}} = \\{k_{r\\theta}\\}_{\\text{rad}} \\cdot \\frac{\\pi}{180}\n$$\nThis demonstrates that if the angle is provided in degrees instead of radians, the numerical value of the coupling constant $k_{r\\theta}$ must be scaled by a factor of $\\frac{\\pi}{180}$ to ensure the calculated energy remains the same.\n\nThis behavior is a direct consequence of the dimension of $k_{r\\theta}$ being $E L^{-1} \\Theta^{-1}$. The inverse dependence on the angle dimension, $\\Theta^{-1}$, means that the units of $k_{r\\theta}$ are of the form (Energy) / (Length $\\times$ Angle). For the physical quantity $k_{r\\theta}$ to be constant, its numerical value must change in inverse proportion to any change in the size of the angle unit. Since $1$ radian is a larger unit of angle than $1$ degree ($1 \\text{ rad} \\approx 57.3 \\text{ deg}$), the numerical value of $k_{r\\theta}$ must be smaller when its units are per-degree compared to per-radian, by exactly the conversion factor $\\frac{\\pi}{180}$. The treatment of angle as a fundamental dimension provides a formal basis for this unit-handling procedure.",
            "answer": "$$\n\\boxed{E L^{-1} \\Theta^{-1}}\n$$"
        },
        {
            "introduction": "Molecular dynamics simulations are driven by forces, which are calculated as the negative gradient of the potential energy. This exercise delves into the Urey-Bradley (UB) potential, a physically intuitive cross-term that couples bond stretching and angle bending by modeling a non-bonded interaction between atoms separated by two bonds (1,3-atoms). By deriving the forces that arise from the UB term, you will practice a fundamental skill in MD programming and gain a deeper appreciation for how this simple harmonic term generates complex, directed forces that implicitly modulate angular stiffness .",
            "id": "3406812",
            "problem": "Consider a triatomic fragment in a molecular mechanics force field where atoms labeled $1$, $2$, and $3$ are connected sequentially by bonds $1\\text{-}2$ and $2\\text{-}3$ and form an angle at atom $2$. Let the bond lengths be $r_{12} = |\\mathbf{r}_{2} - \\mathbf{r}_{1}|$ and $r_{23} = |\\mathbf{r}_{3} - \\mathbf{r}_{2}|$, and let the angle at atom $2$ be $\\theta_{123}$, defined by the bond vectors $\\mathbf{b}_{12} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$ and $\\mathbf{b}_{23} = \\mathbf{r}_{3} - \\mathbf{r}_{2}$ via $\\cos\\theta_{123} = \\dfrac{\\mathbf{b}_{12} \\cdot \\mathbf{b}_{23}}{r_{12}\\,r_{23}}$. Define the $1\\text{-}3$ separation $R_{13} = |\\mathbf{r}_{1} - \\mathbf{r}_{3}|$ and the corresponding unit vector $\\hat{\\mathbf{e}}_{13} = \\dfrac{\\mathbf{r}_{1} - \\mathbf{r}_{3}}{R_{13}}$, which points from atom $3$ to atom $1$. The Urey–Bradley (UB) cross-term energy is included to couple bond stretching and angle bending through the $1\\text{-}3$ separation:\n$$\nE_{\\mathrm{UB}} = \\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2},\n$$\nwhere $k_{\\mathrm{UB}}$ is the UB stiffness and $R_{13,0}$ is the UB reference $1\\text{-}3$ distance.\n\nStarting only from the definition of mechanical force as the negative gradient of potential energy and from geometric relations for $R_{13}$ in terms of $r_{12}$, $r_{23}$, and $\\theta_{123}$, derive the forces $\\mathbf{F}_{1}$ and $\\mathbf{F}_{3}$ on atoms $1$ and $3$ due solely to $E_{\\mathrm{UB}}$, expressed entirely in terms of $k_{\\mathrm{UB}}$, $r_{12}$, $r_{23}$, $\\theta_{123}$, $R_{13,0}$, and $\\hat{\\mathbf{e}}_{13}$ (no coordinates should appear). Use the law of cosines to eliminate $R_{13}$ in favor of $r_{12}$, $r_{23}$, and $\\theta_{123}$ wherever appropriate, and take the angle $\\theta_{123}$ in radians.\n\nThen, explain how these UB forces complement the conventional angle-bending forces by analyzing the small-angle variation of $E_{\\mathrm{UB}}$ at fixed $r_{12}$ and $r_{23}$, and identify the effective additional angular stiffness contributed by the UB term near equilibrium.\n\nProvide your final answer as the pair $\\left(\\mathbf{F}_{1},\\,\\mathbf{F}_{3}\\right)$ in a single closed-form expression. No numerical evaluation is required. Angles must be expressed in radians. Do not include units in the final boxed answer.",
            "solution": "The problem is subjected to validation before proceeding with a solution.\n\n### Step 1: Extract Givens\n-   **System**: A triatomic fragment with atoms $1$, $2$, and $3$ connected as $1\\text{-}2\\text{-}3$.\n-   **Coordinates and Vectors**:\n    -   Bond lengths: $r_{12} = |\\mathbf{r}_{2} - \\mathbf{r}_{1}|$ and $r_{23} = |\\mathbf{r}_{3} - \\mathbf{r}_{2}|$.\n    -   Bond vectors for angle definition: $\\mathbf{b}_{12} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$ and $\\mathbf{b}_{23} = \\mathbf{r}_{3} - \\mathbf{r}_{2}$.\n    -   Angle: $\\cos\\theta_{123} = \\dfrac{\\mathbf{b}_{12} \\cdot \\mathbf{b}_{23}}{r_{12}\\,r_{23}}$.\n    -   $1\\text{-}3$ distance: $R_{13} = |\\mathbf{r}_{1} - \\mathbf{r}_{3}|$.\n    -   $1\\text{-}3$ unit vector: $\\hat{\\mathbf{e}}_{13} = \\dfrac{\\mathbf{r}_{1} - \\mathbf{r}_{3}}{R_{13}}$.\n-   **Potential Energy**:\n    -   Urey–Bradley (UB) term: $E_{\\mathrm{UB}} = \\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2}$.\n    -   Constants: $k_{\\mathrm{UB}}$ (stiffness) and $R_{13,0}$ (reference distance).\n-   **Tasks**:\n    1.  Derive the forces $\\mathbf{F}_{1}$ and $\\mathbf{F}_{3}$ due to $E_{\\mathrm{UB}}$, expressed in terms of $k_{\\mathrm{UB}}$, $r_{12}$, $r_{23}$, $\\theta_{123}$, $R_{13,0}$, and $\\hat{\\mathbf{e}}_{13}$.\n    2.  Use the law of cosines to substitute for $R_{13}$.\n    3.  Explain how UB forces complement angle-bending forces by analyzing small-angle variations of $E_{\\mathrm{UB}}$.\n    4.  Identify the effective additional angular stiffness.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes the Urey–Bradley potential, a well-established cross-term in classical molecular mechanics force fields (e.g., CHARMM, CFF). The definition of force as the negative gradient of potential energy ($\\mathbf{F} = -\\nabla E$) is a fundamental principle of classical mechanics. All geometric definitions are standard. The problem is scientifically sound.\n-   **Well-Posed**: The problem asks for a specific derivation based on given definitions and principles. The required output is clearly defined, and a unique solution is expected from the application of vector calculus.\n-   **Objective**: The problem is stated using precise, formal, and unbiased scientific language.\n-   **Complete and Consistent**: All necessary information (potential energy function, geometric definitions, the principle relating force to energy) is provided. There are no contradictions in the setup.\n-   **Realistic and Feasible**: The model is a standard representation in computational chemistry, and the requested derivation is a standard, albeit non-trivial, exercise in the field.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Derivation of Forces $\\mathbf{F}_{1}$ and $\\mathbf{F}_{3}$\n\nThe force $\\mathbf{F}_i$ on atom $i$ is given by the negative gradient of the potential energy with respect to the coordinates of that atom, $\\mathbf{r}_i$.\n$$\n\\mathbf{F}_i = -\\nabla_i E_{\\mathrm{UB}} = -\\nabla_i \\left[\\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2}\\right]\n$$\nWe apply the chain rule for differentiation. The energy $E_{\\mathrm{UB}}$ depends on the atomic coordinates only through the distance $R_{13}$.\n$$\n\\mathbf{F}_i = -\\frac{\\partial E_{\\mathrm{UB}}}{\\partial R_{13}} \\nabla_i R_{13}\n$$\nFirst, we compute the derivative of $E_{\\mathrm{UB}}$ with respect to $R_{13}$:\n$$\n\\frac{\\partial E_{\\mathrm{UB}}}{\\partial R_{13}} = k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right)\n$$\nNext, we compute the gradients of $R_{13}$ with respect to the positions $\\mathbf{r}_1$ and $\\mathbf{r}_3$. The distance $R_{13}$ is defined as $R_{13} = |\\mathbf{r}_1 - \\mathbf{r}_3| = \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbf{r}_3)}$.\n\nFor atom $1$, the gradient is:\n$$\n\\nabla_1 R_{13} = \\nabla_1 \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3)^2} = \\frac{1}{2 R_{13}} \\nabla_1 \\left((\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbf{r}_3)\\right) = \\frac{2(\\mathbf{r}_1 - \\mathbf{r}_3)}{2 R_{13}} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_3}{R_{13}}\n$$\nBy definition, this is the unit vector $\\hat{\\mathbf{e}}_{13}$.\n$$\n\\nabla_1 R_{13} = \\hat{\\mathbf{e}}_{13}\n$$\nSubstituting these results into the force equation for atom $1$:\n$$\n\\mathbf{F}_1 = -k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) \\hat{\\mathbf{e}}_{13}\n$$\nFor atom $3$, the gradient is:\n$$\n\\nabla_3 R_{13} = \\nabla_3 \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3)^2} = \\frac{1}{2 R_{13}} \\nabla_3 \\left((\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbfr}_3)\\right) = \\frac{2(\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (-1)}{2 R_{13}} = -\\frac{\\mathbf{r}_1 - \\mathbf{r}_3}{R_{13}}\n$$\n$$\n\\nabla_3 R_{13} = -\\hat{\\mathbf{e}}_{13}\n$$\nSubstituting these results into the force equation for atom $3$:\n$$\n\\mathbf{F}_3 = -k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) (-\\hat{\\mathbf{e}}_{13}) = k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) \\hat{\\mathbf{e}}_{13}\n$$\nAs expected, $\\mathbf{F}_1 = -\\mathbf{F}_3$, satisfying Newton's third law for this interaction pair. The force on atom $2$ from this potential is zero, since $E_{\\mathrm{UB}}$ does not depend on $\\mathbf{r}_2$.\n\nThe final step is to express $R_{13}$ in terms of the internal coordinates $r_{12}$, $r_{23}$, and $\\theta_{123}$. The atoms $1$, $2$, and $3$ form a triangle with sides of length $r_{12}$, $r_{23}$, and $R_{13}$. The angle at vertex $2$ is $\\theta_{123}$. Using the law of cosines:\n$$\nR_{13}^2 = r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}\n$$\nTherefore, the distance $R_{13}$ is:\n$$\nR_{13} = \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}}\n$$\nSubstituting this expression for $R_{13}$ into the force equations yields the final expressions:\n$$\n\\mathbf{F}_1 = -k_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}} - R_{13,0} \\right) \\hat{\\mathbf{e}}_{13}\n$$\n$$\n\\mathbf{F}_3 = k_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}} - R_{13,0} \\right) \\hat{\\mathbf{e}}_{13}\n$$\nThese expressions give the forces entirely in terms of the specified variables.\n\n### Complementarity with Angle-Bending Forces\n\nTo understand how the Urey-Bradley term complements conventional angle-bending potentials, we analyze its behavior for small variations in the angle $\\theta_{123}$, holding the bond lengths $r_{12}$ and $r_{23}$ constant. A typical harmonic angle-bending potential has the form $E_{\\text{angle}} = \\frac{1}{2} k_{\\text{angle}}(\\theta_{123} - \\theta_{\\text{eq}})^2$. We will show that the UB term, to a good approximation, also provides a harmonic restoring potential for the angle.\n\nLet us perform a Taylor series expansion of $E_{\\mathrm{UB}}$ as a function of $\\theta \\equiv \\theta_{123}$ around an equilibrium angle $\\theta_0$. We define $\\theta_0$ as the angle for which the $1\\text{-}3$ distance equals the reference distance, i.e., $R_{13}(\\theta_0) = R_{13,0}$.\n$$\nE_{\\mathrm{UB}}(\\theta) \\approx E_{\\mathrm{UB}}(\\theta_0) + \\left. \\frac{dE_{\\mathrm{UB}}}{d\\theta} \\right|_{\\theta_0} (\\theta - \\theta_0) + \\frac{1}{2} \\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} (\\theta - \\theta_0)^2\n$$\nThe first derivative of $E_{\\mathrm{UB}}$ with respect to $\\theta$ is found using the chain rule:\n$$\n\\frac{dE_{\\mathrm{UB}}}{d\\theta} = \\frac{dE_{\\mathrm{UB}}}{dR_{13}} \\frac{dR_{13}}{d\\theta} = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\frac{d}{d\\theta}\\left(r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta\\right)^{1/2}\n$$\n$$\n\\frac{dE_{\\mathrm{UB}}}{d\\theta} = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\left[\\frac{1}{2 R_{13}}(2r_{12}r_{23}\\sin\\theta)\\right] = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\frac{r_{12}r_{23}\\sin\\theta}{R_{13}}\n$$\nAt the equilibrium angle $\\theta_0$, we have $R_{13}(\\theta_0) = R_{13,0}$, so the term $(R_{13} - R_{13,0})$ is zero. Consequently, the first derivative vanishes:\n$$\n\\left. \\frac{dE_{\\mathrm{UB}}}{d\\theta} \\right|_{\\theta_0} = 0\n$$\nThis confirms that $\\theta_0$ corresponds to a minimum in the potential energy landscape (assuming the second derivative is positive). Also, $E_{\\mathrm{UB}}(\\theta_0) = 0$.\n\nNext, we compute the second derivative at $\\theta_0$:\n$$\n\\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} = k_{\\mathrm{UB}} \\frac{d}{d\\theta} \\left[ \\left(1 - \\frac{R_{13,0}}{R_{13}}\\right) r_{12}r_{23}\\sin\\theta \\right]\n$$\n$$\n= k_{\\mathrm{UB}} \\left[ \\left(\\frac{R_{13,0}}{R_{13}^2}\\frac{dR_{13}}{d\\theta}\\right) r_{12}r_{23}\\sin\\theta + \\left(1 - \\frac{R_{13,0}}{R_{13}}\\right) r_{12}r_{23}\\cos\\theta \\right]\n$$\nEvaluating at $\\theta=\\theta_0$, where $R_{13}=R_{13,0}$:\n$$\n\\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} = k_{\\mathrm{UB}} \\left[ \\left(\\frac{R_{13,0}}{R_{13,0}^2} \\left. \\frac{dR_{13}}{d\\theta}\\right|_{\\theta_0} \\right) r_{12}r_{23}\\sin\\theta_0 + 0 \\right]\n$$\nWe need the derivative of $R_{13}$ at $\\theta_0$: $\\left. \\frac{dR_{13}}{d\\theta}\\right|_{\\theta_0} = \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}}$.\n$$\n\\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} = k_{\\mathrm{UB}} \\left[ \\frac{1}{R_{13,0}} \\left(\\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}}\\right) r_{12}r_{23}\\sin\\theta_0 \\right] = k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2\n$$\nThe Taylor expansion of $E_{\\mathrm{UB}}$ around $\\theta_0$ is therefore:\n$$\nE_{\\mathrm{UB}}(\\theta) \\approx \\frac{1}{2} \\left[ k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2 \\right] (\\theta - \\theta_0)^2\n$$\nThis demonstrates that for small angular displacements, the Urey-Bradley potential is equivalent to a harmonic angle-bending potential. The effective angular stiffness contributed by the UB term is:\n$$\nk_{\\text{eff, UB}} = k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2\n$$\nIn a complete force field, the total potential for angle bending would be the sum of a traditional harmonic angle term and the UB term. The total effective stiffness for angle bending is thus the sum of the explicit angle stiffness and $k_{\\text{eff, UB}}$. This coupling between bond stretching and angle bending via the $1\\text{-}3$ distance provides a more physically realistic potential energy surface, particularly for accurately modeling vibrational frequencies and structures of strained rings or sterically crowded molecules.",
            "answer": "$$\n\\boxed{\nk_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2 r_{12} r_{23} \\cos\\theta_{123}} - R_{13,0} \\right) \\left(-\\hat{\\mathbf{e}}_{13}, \\hat{\\mathbf{e}}_{13}\\right)\n}\n$$"
        },
        {
            "introduction": "The ultimate test of a force field model is its behavior within a dynamic simulation, where coupling terms can have profound effects on numerical stability and accuracy. This practice utilizes a simplified two-dimensional Hamiltonian model to explore how cross-term couplings influence the performance of numerical integrators. By comparing a symplectic integrator (Velocity Verlet), standard in MD, with a general-purpose non-symplectic one (RK4), you will investigate the crucial concepts of symplecticity and long-term energy conservation, revealing why the choice of integrator is not independent of the complexity of the potential energy surface .",
            "id": "3406794",
            "problem": "You are asked to design and analyze a two-dimensional Hamiltonian toy model that captures cross-term couplings analogous to those appearing in cross-terms of molecular mechanics force fields, and to use it to evaluate numerical integrators commonly used in Molecular Dynamics (MD, defined as Molecular Dynamics on first use). The model uses canonical generalized coordinates corresponding to small internal coordinate deviations around a reference molecular geometry. Your task is to implement a complete, runnable program that simulates trajectories under a coupled quadratic potential, computes a numerical symplecticity error of the one-step update map, and measures long-time energy drift for two distinct integrators as functions of the cross-coupling strength and the time step. All quantities are nondimensionalized; angles are measured in radians.\n\nModel definition:\n- Let the generalized coordinates be $q = (q_1, q_2)$ and canonical momenta be $p = (p_1, p_2)$, with unit mass $m = 1$ for both degrees of freedom. Interpret $q_1$ as the radial deviation $q_1 = r - r_0$ and $q_2$ as the arc-length scaled angular deviation $q_2 = r_0(\\theta - \\theta_0)$, where $r_0$ is a fixed reference radius and $\\theta_0$ is a fixed reference angle. This scaling makes $q_1$ and $q_2$ commensurate in units, ensuring that the kinetic energy is isotropic at the reference configuration. Angles $\\theta$ and $\\theta_0$ must be in radians.\n- The potential energy is $V(q_1,q_2) = \\tfrac{1}{2}\\left(q_1^2 + q_2^2\\right) + c\\, q_1 q_2$, where $c$ is a real scalar cross-coupling parameter that satisfies $\\lvert c \\rvert  1$ so that the quadratic form is positive definite. The total Hamiltonian is $H(q,p) = \\tfrac{1}{2}\\left(p_1^2 + p_2^2\\right) + V(q_1,q_2)$.\n- The equations of motion are Hamilton’s equations: $\\dot{q}_i = \\partial H/\\partial p_i$ and $\\dot{p}_i = -\\partial H/\\partial q_i$, for $i \\in \\{1,2\\}$.\n\nIntegrator definitions to be implemented:\n- Velocity Verlet (a canonical symplectic splitting integrator) with time step $\\Delta t$.\n- Classical fourth-order explicit Runge–Kutta (RK4), which is not symplectic in general, with time step $\\Delta t$.\n\nDiagnostics to compute:\n- One-step symplecticity error. For a one-step update map $M: z \\mapsto z'$ with state $z = (q_1, q_2, p_1, p_2) \\in \\mathbb{R}^4$, define the canonical symplectic form matrix\n$$\n\\Omega = \\begin{pmatrix}\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-1  0  0  0 \\\\\n0  -1  0  0\n\\end{pmatrix}.\n$$\nAn exact symplectic map satisfies $J^{\\top} \\Omega J = \\Omega$, where $J = \\partial M/\\partial z$ is the Jacobian of the map. Approximate the Jacobian numerically using centered finite differences at the initial state $z_0$, and report the Frobenius norm of the deviation $\\varepsilon_S = \\lVert J^{\\top} \\Omega J - \\Omega \\rVert_F$ for each integrator and each test case.\n- Long-time relative energy drift. For a total simulation time $T$, define the relative drift $\\delta_E = \\left(H(z(T)) - H(z(0))\\right)/H(z(0))$ after integrating with $N = \\lfloor T/\\Delta t \\rfloor$ steps. Report $\\delta_E$ for each integrator and each test case.\n\nFundamental base to use:\n- Newtonian and Hamiltonian mechanics: $H = T + V$ with $T = \\tfrac{1}{2}(p_1^2 + p_2^2)$ and $V(q_1,q_2) = \\tfrac{1}{2}(q_1^2 + q_2^2) + c q_1 q_2$.\n- Canonical equations: $\\dot{q}_i = p_i$ and $\\dot{p}_i = -\\partial V/\\partial q_i$ for $i \\in \\{1,2\\}$.\n- Finite-difference approximation for Jacobians: centered differences with a small perturbation $h$.\n\nAlgorithmic requirements:\n- Implement both integrators faithfully from Hamilton’s equations without using any external libraries beyond those permitted.\n- Compute the one-step map Jacobian $J$ numerically by applying the one-step update map to $z_0 \\pm h e_j$ for each canonical basis vector $e_j$ in $\\mathbb{R}^4$ and using centered differences with a small scalar $h$.\n- Use the same initial state and total simulation time for all test cases.\n\nInitial conditions and constants:\n- Use $r_0 = 1.0$ and $\\theta_0 = 0.0$ (angles in radians).\n- Initial generalized coordinates and momenta: $q(0) = (q_1(0), q_2(0)) = (0.1, -0.08)$ and $p(0) = (p_1(0), p_2(0)) = (0.0, 0.2)$.\n- Total time $T = 50.0$.\n- Jacobian finite-difference step size $h = 10^{-7}$.\n\nTest suite:\n- Use the following pairs $(c,\\Delta t)$:\n    1. $(0.0, 0.05)$\n    2. $(0.5, 0.05)$\n    3. $(0.9, 0.05)$\n    4. $(0.5, 0.2)$\n    5. $(0.9, 0.4)$\n    6. $(-0.9, 0.2)$\nThese cover decoupled, moderately coupled, and strongly coupled regimes, both small and relatively large time steps, and both positive and negative cross-coupling within the stability region $\\lvert c \\rvert  1$.\n\nOutputs to compute per test case:\n- For each $(c,\\Delta t)$, compute four floats:\n    1. The one-step symplecticity error $\\varepsilon_S$ for Velocity Verlet evaluated at $z_0$.\n    2. The relative energy drift $\\delta_E$ for Velocity Verlet over total time $T$.\n    3. The one-step symplecticity error $\\varepsilon_S$ for RK4 evaluated at $z_0$.\n    4. The relative energy drift $\\delta_E$ for RK4 over total time $T$.\n\nRequired final output format:\n- Your program must produce a single line containing a list of lists. Each inner list corresponds to one test case in the order listed above and contains four floating-point numbers in the order specified immediately above. Each float must be rounded to $6$ decimal places. For example, a line of the form\n$[\\,[\\varepsilon_{S,\\mathrm{VV}}, \\delta_{E,\\mathrm{VV}}, \\varepsilon_{S,\\mathrm{RK4}}, \\delta_{E,\\mathrm{RK4}}], \\ldots\\,]$\nwith numerical values inserted and formatted as a single-line string representation like\n$[[0.000000,0.000001,0.002345,-0.000120],\\ldots]$.\n\nAll quantities are nondimensional, and angles must be in radians. No physical unit conversion is required. Ensure the program is self-contained, uses the specified libraries only, and prints exactly one line in the specified format. No additional text or formatting is permitted in the output.",
            "solution": "The problem requires an analysis of a two-dimensional coupled Hamiltonian system, serving as a toy model for cross-term couplings in molecular force fields. The analysis involves comparing the performance of two numerical integrators—Velocity Verlet and classical fourth-order Runge-Kutta (RK4)—by measuring their symplecticity preservation and long-term energy conservation.\n\nThe system is defined by generalized coordinates $q = (q_1, q_2)$ and canonical momenta $p = (p_1, p_2)$. With unit masses ($m_1 = m_2 = 1$), the Hamiltonian $H(q,p)$ is the sum of kinetic energy $T(p)$ and potential energy $V(q)$.\n\nThe kinetic energy is $T(p) = \\frac{1}{2}(p_1^2 + p_2^2)$.\nThe potential energy is a quadratic form with a cross-term: $V(q_1, q_2) = \\frac{1}{2}(q_1^2 + q_2^2) + c q_1 q_2$. The parameter $c$ controls the coupling strength, and the condition $|c|  1$ ensures that the potential is positive definite, leading to bounded motion.\n\nThe total Hamiltonian is:\n$$\nH(q, p) = T(p) + V(q) = \\frac{1}{2}(p_1^2 + p_2^2) + \\frac{1}{2}(q_1^2 + q_2^2) + c q_1 q_2\n$$\n\nThe dynamics of the system are governed by Hamilton's equations of motion:\n$$\n\\dot{q}_i = \\frac{\\partial H}{\\partial p_i} \\quad , \\quad \\dot{p}_i = -\\frac{\\partial H}{\\partial q_i} \\quad \\text{for } i \\in \\{1, 2\\}\n$$\nFor this specific Hamiltonian, these equations are:\n$$\n\\dot{q}_1 = p_1\n$$\n$$\n\\dot{q}_2 = p_2\n$$\n$$\n\\dot{p}_1 = -\\frac{\\partial V}{\\partial q_1} = -(q_1 + c q_2)\n$$\n$$\n\\dot{p}_2 = -\\frac{\\partial V}{\\partial q_2} = -(q_2 + c q_1)\n$$\nWe can define a force vector $F(q) = (F_1, F_2)^T = (-\\frac{\\partial V}{\\partial q_1}, -\\frac{\\partial V}{\\partial q_2})^T$. The equations of motion can be written in a compact vector form as $\\dot{q} = p$ and $\\dot{p} = F(q)$.\n\nWe will integrate these equations using two different numerical schemes over a time step $\\Delta t$.\n\n**1. Velocity Verlet Integrator**\nThe Velocity Verlet algorithm is a second-order, time-reversible, and symplectic integrator for separable Hamiltonians of the form $H(q,p) = T(p) + V(q)$, as is the case here. One step of the algorithm proceeds as follows:\n1. Update momenta by a half-step using the force at the current position: $p(t + \\frac{\\Delta t}{2}) = p(t) + F(q(t)) \\frac{\\Delta t}{2}$.\n2. Update positions by a full step using the half-step momenta: $q(t + \\Delta t) = q(t) + p(t + \\frac{\\Delta t}{2}) \\Delta t$. Note that since mass is unity, momentum is numerically equal to velocity.\n3. Update momenta by the remaining half-step using the force at the new position: $p(t + \\Delta t) = p(t + \\frac{\\Delta t}{2}) + F(q(t + \\Delta t)) \\frac{\\Delta t}{2}$.\n\n**2. Fourth-Order Runge-Kutta (RK4) Integrator**\nThe classical RK4 method is a general-purpose, fourth-order explicit integrator for systems of first-order ordinary differential equations (ODEs), $\\dot{z} = f(t, z)$. For our autonomous system, $f$ does not depend explicitly on time $t$. We define the state vector $z = (q_1, q_2, p_1, p_2)^T$. The ODE function is:\n$$\nf(z) = \\dot{z} = \\begin{pmatrix} \\dot{q}_1 \\\\ \\dot{q}_2 \\\\ \\dot{p}_1 \\\\ \\dot{p}_2 \\end{pmatrix} = \\begin{pmatrix} p_1 \\\\ p_2 \\\\ -(q_1 + c q_2) \\\\ -(q_2 + c q_1) \\end{pmatrix}\n$$\nOne step of the RK4 algorithm from $z_n$ to $z_{n+1}$ is given by:\n$$\n\\begin{align*}\nk_1 = f(z_n) \\\\\nk_2 = f(z_n + \\frac{\\Delta t}{2} k_1) \\\\\nk_3 = f(z_n + \\frac{\\Delta t}{2} k_2) \\\\\nk_4 = f(z_n + \\Delta t k_3) \\\\\nz_{n+1} = z_n + \\frac{\\Delta t}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n\\end{align*}\nRK4 is not, in general, a symplectic integrator.\n\n**Performance Diagnostics**\n\n**a) One-Step Symplecticity Error ($\\varepsilon_S$)**\nA numerical map $M: z(t) \\mapsto z(t+\\Delta t)$ is symplectic if its Jacobian matrix $J = \\frac{\\partial M}{\\partial z}$ satisfies the condition $J^T \\Omega J = \\Omega$, where $\\Omega$ is the canonical symplectic form matrix. For the state vector ordering $z=(q_1, q_2, p_1, p_2)$, this matrix is:\n$$\n\\Omega = \\begin{pmatrix} 0  0  1  0 \\\\ 0  0  0  1 \\\\ -1  0  0  0 \\\\ 0  -1  0  0 \\end{pmatrix}\n$$\nWe quantify the deviation from symplecticity by computing the Frobenius norm of the residual matrix:\n$$\n\\varepsilon_S = \\| J^T \\Omega J - \\Omega \\|_F\n$$\nThe Jacobian $J$ is computed numerically at the initial state $z_0$ using centered finite differences with a small step size $h$. The $j$-th column of $J$ is given by:\n$$\nJ_{\\cdot j} = \\frac{M(z_0 + h e_j) - M(z_0 - h e_j)}{2h}\n$$\nwhere $e_j$ is the $j$-th standard basis vector in $\\mathbb{R}^4$.\n\n**b) Long-Term Relative Energy Drift ($\\delta_E$)**\nFor a Hamiltonian system, the total energy $H$ is a conserved quantity. Numerical integrators may fail to conserve this energy over long simulations. We measure the relative energy drift after a total time $T$ as:\n$$\n\\delta_E = \\frac{H(z(T)) - H(z(0))}{H(z(0))}\n$$\nwhere $z(T)$ is the state after $N = \\lfloor T/\\Delta t \\rfloor$ integration steps starting from $z(0)$. For symplectic integrators like Velocity Verlet, the energy error is expected to remain bounded, while for non-symplectic integrators like RK4, the energy can exhibit secular drift.\n\n**Algorithm**\nThe solution is implemented by following these steps:\n1. Define constants ($T = 50.0$, $h = 10^{-7}$), initial conditions ($q(0)=(0.1, -0.08)$, $p(0)=(0.0, 0.2)$), and the list of test cases $(c, \\Delta t)$.\n2. For each test case:\n    a. For both the Velocity Verlet and RK4 integrators, compute the one-step map Jacobian $J$ at $z_0$ using the numerical differentiation scheme.\n    b. Calculate the symplecticity error $\\varepsilon_S$ from each Jacobian.\n    c. For both integrators, simulate the system for a total time $T$.\n    d. Calculate the relative energy drift $\\delta_E$ for each simulation.\n3. Collect the four resulting floating-point numbers ($\\varepsilon_{S,\\mathrm{VV}}, \\delta_{E,\\mathrm{VV}}, \\varepsilon_{S,\\mathrm{RK4}}, \\delta_{E,\\mathrm{RK4}}$) for each test case.\n4. Format the final results as a single string according to the specified output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a 2D coupled harmonic oscillator to compare Velocity Verlet and RK4 integrators.\n    Computes one-step symplecticity error and long-term energy drift for several test cases.\n    \"\"\"\n\n    # --- Problem Definition ---\n    # Initial conditions and constants\n    q0 = np.array([0.1, -0.08])\n    p0 = np.array([0.0, 0.2])\n    z0 = np.concatenate([q0, p0])\n    T_TOTAL = 50.0\n    H_FD = 1e-7  # Finite difference step for Jacobian\n\n    # Symplectic form matrix for z = (q1, q2, p1, p2)\n    OMEGA = np.array([\n        [0, 0, 1, 0],\n        [0, 0, 0, 1],\n        [-1, 0, 0, 0],\n        [0, -1, 0, 0]\n    ])\n\n    test_cases = [\n        (0.0, 0.05),\n        (0.5, 0.05),\n        (0.9, 0.05),\n        (0.5, 0.2),\n        (0.9, 0.4),\n        (-0.9, 0.2)\n    ]\n\n    # --- Core Physics and Numerics Functions ---\n\n    def forces(q, c):\n        \"\"\"Computes the force F = -grad(V) for a given position vector q.\"\"\"\n        return -np.array([q[0] + c * q[1], q[1] + c * q[0]])\n\n    def hamiltonian(z, c):\n        \"\"\"Computes the total energy H(q,p) for a given state vector z.\"\"\"\n        q, p = z[:2], z[2:]\n        V = 0.5 * (q[0]**2 + q[1]**2) + c * q[0] * q[1]\n        K = 0.5 * (p[0]**2 + p[1]**2)\n        return K + V\n\n    def f_ode(z, c):\n        \"\"\"Computes the time derivative of the state vector, dz/dt = f(z).\"\"\"\n        q, p = z[:2], z[2:]\n        F = forces(q, c)\n        return np.concatenate([p, F])\n\n    # --- Integrator Implementations ---\n\n    def velocity_verlet_step(z, dt, c):\n        \"\"\"Performs one step of the Velocity Verlet algorithm.\"\"\"\n        q, p = z[:2].copy(), z[2:].copy()\n        \n        F_current = forces(q, c)\n        p_mid = p + F_current * dt / 2.0\n        q_new = q + p_mid * dt\n        F_new = forces(q_new, c)\n        p_new = p_mid + F_new * dt / 2.0\n        \n        return np.concatenate([q_new, p_new])\n\n    def rk4_step(z, dt, c):\n        \"\"\"Performs one step of the classical RK4 algorithm.\"\"\"\n        k1 = f_ode(z, c)\n        k2 = f_ode(z + dt / 2.0 * k1, c)\n        k3 = f_ode(z + dt / 2.0 * k2, c)\n        k4 = f_ode(z + dt * k3, c)\n        z_new = z + (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n        return z_new\n\n    # --- Diagnostic Calculation Functions ---\n\n    def compute_jacobian(one_step_map, z0, dt, c, h):\n        \"\"\"Numerically computes the Jacobian of the one-step map using centered differences.\"\"\"\n        n_dims = len(z0)\n        J = np.zeros((n_dims, n_dims))\n        for j in range(n_dims):\n            z_plus = z0.copy()\n            z_minus = z0.copy()\n            z_plus[j] += h\n            z_minus[j] -= h\n            \n            z_prime_plus = one_step_map(z_plus, dt, c)\n            z_prime_minus = one_step_map(z_minus, dt, c)\n            \n            J[:, j] = (z_prime_plus - z_prime_minus) / (2.0 * h)\n        return J\n\n    def compute_symplecticity_error(J, omega):\n        \"\"\"Computes the Frobenius norm of the deviation from the symplectic condition.\"\"\"\n        deviation = J.T @ omega @ J - omega\n        return np.linalg.norm(deviation, 'fro')\n\n    def run_simulation_and_get_drift(integrator_step, z0, dt, c, T):\n        \"\"\"Runs a simulation and computes the relative energy drift.\"\"\"\n        h0 = hamiltonian(z0, c)\n        if h0 == 0:\n            return 0.0 # Avoid division by zero, though unlikely for given z0\n\n        num_steps = int(np.floor(T / dt))\n        z_current = z0.copy()\n        for _ in range(num_steps):\n            z_current = integrator_step(z_current, dt, c)\n        \n        hf = hamiltonian(z_current, c)\n        return (hf - h0) / h0\n\n    # --- Main Loop ---\n\n    results = []\n    for c, dt in test_cases:\n        case_results = []\n        \n        # Velocity Verlet\n        J_vv = compute_jacobian(velocity_verlet_step, z0, dt, c, H_FD)\n        eps_s_vv = compute_symplecticity_error(J_vv, OMEGA)\n        delta_e_vv = run_simulation_and_get_drift(velocity_verlet_step, z0, dt, c, T_TOTAL)\n        case_results.extend([eps_s_vv, delta_e_vv])\n        \n        # RK4\n        J_rk4 = compute_jacobian(rk4_step, z0, dt, c, H_FD)\n        eps_s_rk4 = compute_symplecticity_error(J_rk4, OMEGA)\n        delta_e_rk4 = run_simulation_and_get_drift(rk4_step, z0, dt, c, T_TOTAL)\n        case_results.extend([eps_s_rk4, delta_e_rk4])\n        \n        results.append(case_results)\n\n    # --- Final Output Formatting ---\n    \n    inner_lists_str = []\n    for sublist in results:\n        formatted_sublist = [f\"{val:.6f}\" for val in sublist]\n        inner_lists_str.append(f\"[{','.join(formatted_sublist)}]\")\n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}