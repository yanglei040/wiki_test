{
    "hands_on_practices": [
        {
            "introduction": "QM/MM计算的核心在于如何将高精度的量子化学（QM）计算与高效的分子力学（MM）计算结合起来，以得到整个体系的总能量。减法方案是一种直观且广泛使用的能量组合方法。通过本练习 ()，您将亲手实践如何应用减法公式来避免对QM区域能量的双重计算，从而深入理解QM/MM模型中能量的划分与组合方式。",
            "id": "3439662",
            "problem": "一个三原子分子体系被划分为两个区域以进行量子力学/分子力学（QM/MM）处理：一个量子力学（QM）区域和一个分子力学（MM）环境。目标是获得一个一致的总能量，该总能量用QM描述取代QM区域的MM描述，同时保留整个系统的MM描述，并避免对QM区域的双重计算。考虑以下能量，每种能量都是在不同的模型下计算的：\n\n- $E_{\\mathrm{QM}}(\\mathrm{QM})=-100.0\\,\\mathrm{kcal/mol}$，在量子力学水平上计算的QM区域的能量。\n- $E_{\\mathrm{MM}}(\\mathrm{QM}+\\mathrm{MM})=-250.0\\,\\mathrm{kcal/mol}$，在分子力学水平上计算的整个系统的能量。\n- $E_{\\mathrm{MM}}(\\mathrm{QM})=-120.0\\,\\mathrm{kcal/mol}$，在分子力学水平上计算的QM区域的能量。\n\n从期望的复合能量应反映整个系统的MM描述，并将QM区域的MM能量替换为其QM能量这一概念性原理出发，推导一个合适的用于复合能量 $E_{\\mathrm{sub}}$ 的减法机械嵌入表达式，并进行数值计算。然后，解释在减法QM/MM嵌入的背景下 $E_{\\mathrm{sub}}$ 的物理意义，以及其数值对于QM与MM描述下QM区域的相对稳定性意味着什么。以 $\\mathrm{kcal/mol}$ 为单位表示最终能量。无需四舍五入。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 步骤1：提取给定信息\n提供了以下数据和定义：\n- 在QM理论水平上计算的量子力学（QM）区域的能量：$E_{\\mathrm{QM}}(\\mathrm{QM}) = -100.0\\,\\mathrm{kcal/mol}$。\n- 在MM理论水平上计算的整个系统（QM区域 + 分子力学（MM）区域）的能量：$E_{\\mathrm{MM}}(\\mathrm{QM}+\\mathrm{MM}) = -250.0\\,\\mathrm{kcal/mol}$。\n- 在MM理论水平上计算的QM区域的能量：$E_{\\mathrm{MM}}(\\mathrm{QM}) = -120.0\\,\\mathrm{kcal/mol}$。\n- 任务是推导复合能量 $E_{\\mathrm{sub}}$ 的减法机械嵌入表达式，进行计算，并解释其物理意义。\n\n### 步骤2：使用提取的给定信息进行验证\n根据所需标准对问题陈述进行评估。\n- **科学依据**：该问题描述了QM/MM计算的减法方案，这是计算化学中多尺度建模的基石。其公式和避免双重计算的概念是标准的、科学合理的。\n- **适定性**：该问题提供了构建和评估标准双层减法QM/MM能量所需的所有能量项。目标是计算一个唯一的、明确定义的值 $E_{\\mathrm{sub}}$，并提供标准的物理解释。存在一个唯一的、稳定的、有意义的解。\n- **客观性**：该问题使用计算化学领域的精确、标准术语（$E_{\\mathrm{QM}}$、$E_{\\mathrm{MM}}$、QM/MM等）表述，没有主观或含糊不清的语言。\n\n### 步骤3：结论与行动\n该问题科学合理、适定且客观。被判定为**有效**。因此，将提供完整解答。\n\n### 求解推导\nQM/MM计算的目标是用高水平的量子力学理论描述化学活性区域（QM区域），同时用计算成本较低的分子力学力场处理系统的其余部分（MM环境）。减法方案是组合这些描述的最简单、最常用的方法之一。\n\n如问题所述，核心原理是从在低水平（MM）上计算的整个系统的能量开始，然后应用一个修正。这个修正用其精确的高水平描述取代了QM区域不精确的低水平描述。\n\n设整个系统表示为 $\\mathrm{S} = \\mathrm{QM} + \\mathrm{MM}$。\n由MM力场计算的完整系统的能量记为 $E_{\\mathrm{MM}}(\\mathrm{S})$，它等同于 $E_{\\mathrm{MM}}(\\mathrm{QM}+\\mathrm{MM})$。该项不正确地描述了QM区域。\n\n为了修正这一点，我们必须首先减去在MM水平上计算的QM区域的贡献。这个贡献记为 $E_{\\mathrm{MM}}(\\mathrm{QM})$。从总MM能量中移除这一项，就消除了对QM部分的不正确描述。\n\n接下来，我们必须加上在QM理论水平上正确计算的QM区域的能量。这一项记为 $E_{\\mathrm{QM}}(\\mathrm{QM})$。\n\n综合这些步骤，得到减法QM/MM能量 $E_{\\mathrm{sub}}$ 的通用表达式：\n$$E_{\\mathrm{sub}} = E_{\\mathrm{MM}}(\\mathrm{QM}+\\mathrm{MM}) - E_{\\mathrm{MM}}(\\mathrm{QM}) + E_{\\mathrm{QM}}(\\mathrm{QM})$$\n这个表达式避免了对QM区域能量的双重计算。它代表了一个模型，其中QM区域的内能由量子力学决定，而它与MM环境的相互作用以及MM环境自身的内能则由经典力学决定。这种特定的表述方式对应于机械嵌入方案，因为QM和MM区域之间的耦合完全包含在 $E_{\\mathrm{MM}}(\\mathrm{QM}+\\mathrm{MM})$ 项中，因此仅在MM水平上进行描述。\n\n现在，我们将给定的数值代入此表达式：\n- $E_{\\mathrm{QM}}(\\mathrm{QM}) = -100.0\\,\\mathrm{kcal/mol}$\n- $E_{\\mathrm{MM}}(\\mathrm{QM}+\\mathrm{MM}) = -250.0\\,\\mathrm{kcal/mol}$\n- $E_{\\mathrm{MM}}(\\mathrm{QM}) = -120.0\\,\\mathrm{kcal/mol}$\n\n$$E_{\\mathrm{sub}} = (-250.0\\,\\mathrm{kcal/mol}) - (-120.0\\,\\mathrm{kcal/mol}) + (-100.0\\,\\mathrm{kcal/mol})$$\n$$E_{\\mathrm{sub}} = -250.0 + 120.0 - 100.0\\,\\mathrm{kcal/mol}$$\n$$E_{\\mathrm{sub}} = -130.0 - 100.0\\,\\mathrm{kcal/mol}$$\n$$E_{\\mathrm{sub}} = -230.0\\,\\mathrm{kcal/mol}$$\n\n### 物理解释\n计算得到的能量 $E_{\\mathrm{sub}} = -230.0\\,\\mathrm{kcal/mol}$ 是减法QM/MM框架内系统的估算总能量。它代表了系统能量的一个近似值，其中QM区域用量子力学描述，而MM区域以及QM-MM相互作用则用经典力场描述。\n\n$E_{\\mathrm{sub}}$ 的公式可以重新排列以突出修正项：\n$$E_{\\mathrm{sub}} = E_{\\mathrm{MM}}(\\mathrm{QM}+\\mathrm{MM}) + \\left[ E_{\\mathrm{QM}}(\\mathrm{QM}) - E_{\\mathrm{MM}}(\\mathrm{QM}) \\right]$$\n方括号中的项，$E_{\\mathrm{QM}}(\\mathrm{QM}) - E_{\\mathrm{MM}}(\\mathrm{QM})$，代表了从QM区域的MM描述切换到QM描述所产生的能量修正。\n在本例中，修正是：\n$$\\Delta E_{\\mathrm{correction}} = (-100.0\\,\\mathrm{kcal/mol}) - (-120.0\\,\\mathrm{kcal/mol}) = +20.0\\,\\mathrm{kcal/mol}$$\n这个正值意味着，与更精确的QM计算相比，MM力场对孤立QM区域的稳定性高估了 $20.0\\,\\mathrm{kcal/mol}$。QM水平的计算发现QM区域的内在稳定性比MM力场预测的要低（能量更高）。减法QM/MM能量 $E_{\\mathrm{sub}}$ 包含了这个修正，得到的总能量（$ -230.0\\,\\mathrm{kcal/mol}$）比整个系统的纯经典计算（$E_{\\mathrm{MM}}(\\mathrm{QM}+\\mathrm{MM}) = -250.0\\,\\mathrm{kcal/mol}$）要高（更不稳定）。这种调整对于获得复合体系更符合物理现实的能量至关重要。",
            "answer": "$$\n\\boxed{-230.0}\n$$"
        },
        {
            "introduction": "在定义了总能量之后，QM/MM方法的一个关键问题是如何处理QM区域与MM环境之间的相互作用，这由所谓的“嵌入方案”决定。本练习 () 将对比两种最基本的嵌入方案：机械嵌入和静电嵌入。通过一个简化的离子-分子偶极体系，您将定量地计算并理解这两种方案在描述QM/MM界面相互作用能时的本质区别，特别是静电嵌入如何将MM环境的电场效应纳入QM计算中。",
            "id": "3439712",
            "problem": "考虑一个量子力学/分子力学 (QM/MM) 耦合情景，其中一个量子力学 (QM) 水分子被近似为一个大小为 $\\mu = 1.85\\,\\mathrm{D}$ 的固定点偶极子，位于质心位置，与一个携带点电荷 $q = +1\\,e$ 的分子力学 (MM) 钠离子相距 $r = 3.0\\,\\mathrm{\\AA}$。考察了两种 QM/MM 嵌入方案：\n\n- 机械嵌入：QM/MM 相互作用仅包含 Lennard–Jones 势，其参数为 $\\epsilon = 0.1\\,\\mathrm{kcal/mol}$ 和 $\\sigma = 3.4\\,\\mathrm{\\AA}$。\n- 静电嵌入：除了相同的 Lennard–Jones 势之外，MM 点电荷产生一个电场，该电场与 QM 偶极子相互作用，此作用由经典的点电荷–偶极子能量近似。\n\n假设偶极矩矢量与离子–偶极子轴平行排列，其负端朝向阳离子，因此偶极子与正电荷的局部电场对齐，且在经典表达式 $-\\boldsymbol{\\mu}\\cdot\\mathbf{E}$ 中的取向因子为 $\\cos\\theta = 1$。忽略偶极子大小的极化和更高阶的多极矩贡献。在经典静电学和标准单位换算中隐式使用真空介电常数。取 $1\\,\\mathrm{D} = 3.33564\\times 10^{-30}\\,\\mathrm{C\\cdot m}$ 和 $1\\,e\\cdot\\mathrm{\\AA} = 1.602176634\\times 10^{-29}\\,\\mathrm{C\\cdot m}$。将能量差定义为\n$$\n\\Delta E \\equiv E_{\\mathrm{elec\\;embed}} - E_{\\mathrm{mech\\;embed}}\n$$\n计算 $\\Delta E$ 并以 $\\mathrm{kcal/mol}$ 为单位表示您的最终数值答案。将您的答案四舍五入到四位有效数字。角度 $\\theta$ 以弧度为单位，但由指定的排列方式固定，因此 $\\cos\\theta = 1$。",
            "solution": "该问题陈述已经过验证，被认为是科学上合理的、定义明确且客观的。它展示了计算化学领域的一个标准计算，特别是关于量子力学/分子力学 (QM/MM) 方法。所有必要的数据和定义均已提供。\n\n该问题要求计算两种不同 QM/MM 嵌入方案（静电嵌入和机械嵌入）之间的能量差 $\\Delta E$。该系统由一个 QM 水分子（处理为点偶极子）和一个 MM 钠离子（处理为点电荷）组成。\n\n首先，让我们根据问题中的描述定义每种方案的相互作用能。\n在机械嵌入方案中，相互作用能 $E_{\\mathrm{mech\\;embed}}$ 仅包含非键合的 Lennard-Jones (LJ) 势：\n$$\nE_{\\mathrm{mech\\;embed}} = E_{\\mathrm{LJ}}\n$$\nLennard-Jones 势是分离距离 $r$ 的函数。虽然提供了其参数（$\\epsilon$ 和 $\\sigma$），但对于本问题而言，其显式形式并非必需。\n\n在静电嵌入方案中，相互作用能 $E_{\\mathrm{elec\\;embed}}$ 包括 Lennard-Jones 势和 MM 点电荷与 QM 电子密度（此处近似为点偶极子）之间的静电相互作用能 $E_{\\mathrm{elec}}$。\n$$\nE_{\\mathrm{elec\\;embed}} = E_{\\mathrm{LJ}} + E_{\\mathrm{elec}}\n$$\n问题要求计算能量差 $\\Delta E$：\n$$\n\\Delta E = E_{\\mathrm{elec\\;embed}} - E_{\\mathrm{mech\\;embed}}\n$$\n将两种方案的能量表达式代入，我们发现 Lennard-Jones 项被消掉了：\n$$\n\\Delta E = (E_{\\mathrm{LJ}} + E_{\\mathrm{elec}}) - E_{\\mathrm{LJ}} = E_{\\mathrm{elec}}\n$$\n因此，任务简化为计算钠离子的点电荷与水分子的点偶极子之间的静电相互作用能。\n\n点电荷 $q$ 和点偶极子 $\\boldsymbol{\\mu}$ 之间的经典静电相互作用能由以下公式给出：\n$$\nE_{\\mathrm{elec}} = - \\boldsymbol{\\mu} \\cdot \\mathbf{E}\n$$\n其中 $\\mathbf{E}$ 是由点电荷 $q$ 在偶极子位置产生的电场。电场的大小为 $E = \\frac{1}{4\\pi\\epsilon_0} \\frac{|q|}{r^2}$，其中 $r$ 是电荷与偶极子之间的距离，$\\epsilon_0$ 是真空介电常数。能量表达式可以写为：\n$$\nE_{\\mathrm{elec}} = - \\frac{1}{4\\pi\\epsilon_0} \\frac{q \\mu \\cos\\theta}{r^2}\n$$\n其中 $\\mu = |\\boldsymbol{\\mu}|$，$\\theta$ 是偶极矩矢量与电场矢量之间的夹角。问题陈述指明偶极子与局部电场对齐，使得取向因子为 $\\cos\\theta = 1$。钠离子的电荷为正，$q = +1\\,e$。偶极矩矢量从负极指向正极。为了使相互作用最有利 ($\\cos\\theta=1$)，偶极矩矢量必须与电场矢量平行，而电场矢量指向远离正电荷的方向。这意味着偶极子的负端更靠近阳离子，正如问题所述。\n\n当 $\\cos\\theta = 1$ 时，能量表达式简化为：\n$$\n\\Delta E = E_{\\mathrm{elec}} = - \\frac{1}{4\\pi\\epsilon_0} \\frac{q \\mu}{r^2}\n$$\n为了方便计算，我们将使用计算化学中常用的单位制，其中能量单位为 $\\mathrm{kcal/mol}$，距离单位为埃 ($\\mathrm{\\AA}$)，电荷单位为基本电荷 ($e$)。库仑常数 $\\frac{1}{4\\pi\\epsilon_0}$ 被替换为一个转换因子 $C = 332.0637\\,\\mathrm{kcal\\cdot\\AA\\cdot mol^{-1}\\cdot e^{-2}}$。这个因子将势能 $q_1 q_2 / r$（其中 $q_i$ 以 $e$ 为单位， $r$ 以 $\\mathrm{\\AA}$ 为单位）直接转换为 $\\mathrm{kcal/mol}$。\n\n对于电荷-偶极子相互作用，使用这些单位的能量公式变为：\n$$\n\\Delta E (\\mathrm{kcal/mol}) = -C \\frac{q[e] \\cdot \\mu'[e\\cdot\\mathrm{\\AA}]}{(r[\\mathrm{\\AA}])^2}\n$$\n其中 $\\mu'$ 是以 $e\\cdot\\mathrm{\\AA}$ 为单位的偶极矩。\n\n我们已知的偶极矩为 $\\mu = 1.85\\,\\mathrm{D}$。我们必须使用提供的常数将其转换为 $e\\cdot\\mathrm{\\AA}$ 单位：\n$1\\,\\mathrm{D} = 3.33564\\times 10^{-30}\\,\\mathrm{C\\cdot m}$\n$1\\,e\\cdot\\mathrm{\\AA} = 1.602176634\\times 10^{-29}\\,\\mathrm{C\\cdot m}$\n\n转换因子为：\n$$\n\\frac{1\\,\\mathrm{D}}{1\\,e\\cdot\\mathrm{\\AA}} = \\frac{3.33564\\times 10^{-30}\\,\\mathrm{C\\cdot m}}{1.602176634\\times 10^{-29}\\,\\mathrm{C\\cdot m}} \\approx 0.208194\n$$\n所以，$1\\,\\mathrm{D} \\approx 0.208194\\,e\\cdot\\mathrm{\\AA}$。\n现在，我们转换给定的偶极矩：\n$$\n\\mu' = 1.85\\,\\mathrm{D} \\times 0.208194\\,\\frac{e\\cdot\\mathrm{\\AA}}{\\mathrm{D}} \\approx 0.385159\\,e\\cdot\\mathrm{\\AA}\n$$\n我们已知以下数值：\n$q_s = +1\\,e$\n$\\mu' \\approx 0.385159\\,e\\cdot\\mathrm{\\AA}$\n$r = 3.0\\,\\mathrm{\\AA}$\n\n现在我们可以计算 $\\Delta E$：\n$$\n\\Delta E = -(332.0637\\,\\mathrm{kcal\\cdot\\AA\\cdot mol^{-1}\\cdot e^{-2}}) \\frac{(1\\,e) \\cdot (0.385159\\,e\\cdot\\mathrm{\\AA})}{(3.0\\,\\mathrm{\\AA})^2}\n$$\n$$\n\\Delta E = -332.0637 \\times \\frac{0.385159}{9.0} \\, \\mathrm{kcal/mol}\n$$\n$$\n\\Delta E = -332.0637 \\times 0.0427954_4 \\, \\mathrm{kcal/mol}\n$$\n$$\n\\Delta E \\approx -14.2059\\,\\mathrm{kcal/mol}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\Delta E \\approx -14.21\\,\\mathrm{kcal/mol}\n$$",
            "answer": "$$\n\\boxed{-14.21}\n$$"
        },
        {
            "introduction": "尽管静电嵌入方案功能强大，但它也可能引入一些人为的效应，其中最著名的是当MM点电荷与QM区域的电子云距离过近时产生的“过度极化”问题。一个有效的解决方法是用弥散的电荷分布（如高斯函数）来替代点电荷。本高级练习 () 要求您不仅进行理论推导，还要编写代码来实现一个包含电荷弥散的QM/MM模型，从而深入探究这一技术如何有效地缓解过度极化现象，为您处理实际模拟中的复杂问题提供宝贵经验。",
            "id": "3439684",
            "problem": "你需要实现并分析一个最小的量子力学/分子力学 (QM/MM) 嵌入模型，其中量子力学 (QM) 子系统由一个位于原点的各向同性、线性可极化点表示，其极化率为 $\\,\\alpha\\,$ (以原子单位计)，而分子力学 (MM) 环境由一个位于位置矢量 $\\,\\mathbf{R}\\,$ 处的单个电荷 $\\,q\\,$ 组成。为减小短程范围内的过度极化，MM 电荷可选择性地被一个以 $\\,\\mathbf{R}\\,$ 为中心、宽度为 $\\,\\sigma\\,$ 的归一化、球对称高斯电荷密度所替代。在原子单位制下进行计算，因此 $\\,4\\pi\\varepsilon_0 = 1\\,$ 且 $\\,e=1\\,$，并将所有距离以玻尔 (bohr) 为单位，能量以哈特里 (hartree) 为单位。\n\n使用的基本原理：\n- 总电荷为 $\\,q\\,$、宽度为 $\\,\\sigma\\,$ 的归一化球形高斯的静电势为\n$$\n\\phi(\\mathbf{r}) \\;=\\; \\frac{q}{|\\mathbf{r}-\\mathbf{R}|}\\,\\mathrm{erf}\\!\\Big(\\frac{|\\mathbf{r}-\\mathbf{R}|}{\\sqrt{2}\\,\\sigma}\\Big).\n$$\n- 电场为 $\\,\\mathbf{E}(\\mathbf{r}) = -\\nabla \\phi(\\mathbf{r})\\,$。\n- 可极化 QM 中心的感应偶极为 $\\,\\boldsymbol{\\mu} = \\alpha\\,\\mathbf{E}(\\mathbf{0})\\,$。\n- 线性响应中的 QM 极化能为 $\\,E_{\\mathrm{QM}} = -\\tfrac{1}{2}\\,\\boldsymbol{\\mu}\\cdot\\mathbf{E}(\\mathbf{0}) = -\\tfrac{1}{2}\\,\\alpha\\,\\|\\mathbf{E}(\\mathbf{0})\\|^2\\,$。\n- 由 QM 极化引起的对 MM 电荷的作用力为 $\\,\\mathbf{F}_{\\mathrm{MM}} = -\\nabla_{\\mathbf{R}} E_{\\mathrm{QM}}\\,$。\n\n任务：\n1. 从上面给出的势 $\\,\\phi(\\mathbf{r})\\,$ 出发，推导在 QM 中心 $\\,\\mathbf{r}=\\mathbf{0}\\,$ 处由高斯弥散的 MM 电荷产生的电场的闭合形式表达式。将其表示为一个与 $\\,\\mathbf{R}\\,$ 对齐的矢量，并确定一个标量函数 $\\,f(R,\\sigma)\\,$，其中 $\\,R=\\|\\mathbf{R}\\|\\,$，使得\n$$\n\\mathbf{E}(\\mathbf{0}) \\;=\\; q\\,f(R,\\sigma)\\,(-\\hat{\\mathbf{R}}),\n$$\n其中 $\\,\\hat{\\mathbf{R}}=\\mathbf{R}/R\\,$。\n2. 使用线性响应能量的定义，推导作用在 MM 电荷上的 QM/MM 力的径向分量 $\\,F_R\\,$ 的精确解析公式，该分量定义为 $\\,\\mathbf{F}_{\\mathrm{MM}}\\,$ 沿 $\\,\\hat{\\mathbf{R}}\\,$ 的投影。你的推导必须明确地用 $\\,f(R,\\sigma)\\,$ 和 $\\,\\partial f/\\partial R\\,$ 表示，并且当 $\\,\\sigma\\to 0\\,$ 时，它必须能正确地简化为点电荷极限情况。\n3. 实现一个程序，该程序能够：\n   - 对于给定的 $\\,q\\,$, $\\,\\alpha\\,$, $\\,R\\,$ 和 $\\,\\sigma\\,$，计算 $\\,\\mathbf{E}(\\mathbf{0})\\,$、感应偶极矩大小 $\\,\\mu(\\sigma)=\\|\\boldsymbol{\\mu}\\|\\,$ 和解析径向力 $\\,F_R\\,$。\n   - 通过评估归一化的感应偶极矩大小来量化过度极化的缓解程度\n   $$\n   \\rho(R,\\sigma) \\;=\\; \\frac{\\mu(\\sigma)}{\\mu(0)} \\;=\\; \\frac{\\|\\alpha\\,\\mathbf{E}(\\mathbf{0};\\sigma)\\|}{\\|\\alpha\\,\\mathbf{E}(\\mathbf{0};0)\\|},\n   $$\n   其中 $\\,\\mu(0)\\,$ 对应于点电荷极限。将 $\\,\\rho\\,$ 作为无量纲浮点数报告。\n   - 通过将 $\\,F_R\\,$ 与步长为 $\\,h = 10^{-6}\\,$ bohr 的 $-\\partial E_{\\mathrm{QM}}/\\partial R\\,$ 的对称有限差分估计值进行比较，来验证解析力。报告相对误差\n   $$\n   \\varepsilon \\;=\\; \\frac{|F_R^{\\mathrm{analytic}} - F_R^{\\mathrm{FD}}|}{\\max(|F_R^{\\mathrm{FD}}|,\\,10^{-12})}\n   $$\n   是否小于 $\\,10^{-8}\\,$，结果为一个布尔值。\n4. 使用以下测试套件，固定 $\\,\\alpha = 10.0\\,$ (原子单位)，并使用列出的元组 $\\,\\big(R,\\,\\sigma,\\,q\\big)\\,$ (均以原子单位计)：\n   - 案例 $\\,1\\,$: $\\,\\big(2.0,\\,0.0,\\, +1.0\\big)\\,$。\n   - 案例 $\\,2\\,$: $\\,\\big(0.5,\\,0.2,\\, +1.0\\big)\\,$。\n   - 案例 $\\,3\\,$: $\\,\\big(0.5,\\,1.0,\\, +1.0\\big)\\,$。\n   - 案例 $\\,4\\,$: $\\,\\big(5.0,\\,1.0,\\, +1.0\\big)\\,$。\n   - 案例 $\\,5\\,$: $\\,\\big(1.0,\\,0.5,\\, -1.0\\big)\\,$。\n   对于每种情况，你的程序必须计算并返回一个包含两个元素的列表：\n   - 上面定义的浮点数 $\\,\\rho\\,$。\n   - 一个布尔值，指示解析力是否在规定容差内通过有限差分检验。\n5. 最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是对应一个测试用例的双元素列表，顺序为案例 $\\,1\\,$ 到 $\\,5\\,$。例如，一个语法上有效的形状是\n   $$\n   \\big[\\,[\\rho_1,\\mathrm{ok}_1],\\,[\\rho_2,\\mathrm{ok}_2],\\,[\\rho_3,\\mathrm{ok}_3],\\,[\\rho_4,\\mathrm{ok}_4],\\,[\\rho_5,\\mathrm{ok}_5]\\,\\big].\n   $$\n所有量都以原子单位进行计算和报告；$\\,\\rho\\,$ 是无量纲的。不涉及角度。不使用百分比。答案必须是最终答案部分指定的完整、可运行的程序。",
            "solution": "该问题陈述已经过仔细验证，并被确定为具有科学依据、问题明确、客观且自洽。它提出了一个 QM/MM 框架中静电嵌入的标准简化模型，所有定义和参数都已明确指定。任务逻辑结构清晰，涉及矢量微积分中的标准解析推导和后续的数值实现。因此，下面提供了完整的解决方案。\n\n### 第一部分：QM 中心电场的推导\n\nQM 中心位于原点 $\\mathbf{r}=\\mathbf{0}$。MM 电荷 $q$ 由以 $\\mathbf{R}$ 为中心的高斯电荷密度描述，产生静电势：\n$$\n\\phi(\\mathbf{r}) = \\frac{q}{|\\mathbf{r}-\\mathbf{R}|}\\,\\mathrm{erf}\\!\\Big(\\frac{|\\mathbf{r}-\\mathbf{R}|}{\\sqrt{2}\\,\\sigma}\\Big)\n$$\n电场由 $\\mathbf{E}(\\mathbf{r}) = -\\nabla \\phi(\\mathbf{r})$ 给出。我们定义 $\\mathbf{u} = \\mathbf{r}-\\mathbf{R}$ 及其大小 $u = |\\mathbf{u}|$。势可以仅写为 $u$ 的函数：$\\phi(u) = \\frac{q}{u}\\mathrm{erf}\\big(\\frac{u}{\\sqrt{2}\\,\\sigma}\\big)$。\n使用链式法则，梯度为 $\\nabla_{\\mathbf{r}} \\phi(\\mathbf{r}) = \\nabla_{\\mathbf{u}} \\phi(u) = \\frac{d\\phi}{du}\\frac{\\mathbf{u}}{u} = \\frac{d\\phi}{du}\\hat{\\mathbf{u}}$。\n\n首先，我们计算 $\\phi$ 对 $u$ 的导数：\n$$\n\\frac{d\\phi}{du} = q \\frac{d}{du}\\left[ \\frac{1}{u}\\,\\mathrm{erf}\\!\\Big(\\frac{u}{\\sqrt{2}\\,\\sigma}\\Big) \\right]\n$$\n使用乘法法则和误差函数的导数 $\\frac{d}{dx}\\mathrm{erf}(x) = \\frac{2}{\\sqrt{\\pi}}e^{-x^2}$：\n$$\n\\begin{align*}\n\\frac{d\\phi}{du} = q \\left[ -\\frac{1}{u^2}\\,\\mathrm{erf}\\!\\Big(\\frac{u}{\\sqrt{2}\\,\\sigma}\\Big) + \\frac{1}{u} \\cdot \\frac{2}{\\sqrt{\\pi}} e^{-\\left(\\frac{u}{\\sqrt{2}\\,\\sigma}\\right)^2} \\cdot \\frac{1}{\\sqrt{2}\\,\\sigma} \\right] \\\\\n= q \\left[ -\\frac{1}{u^2}\\,\\mathrm{erf}\\!\\Big(\\frac{u}{\\sqrt{2}\\,\\sigma}\\Big) + \\frac{\\sqrt{2}}{u\\sqrt{\\pi}\\,\\sigma} e^{-u^2/(2\\sigma^2)} \\right]\n\\end{align*}\n$$\n我们需要在 $\\mathbf{r}=\\mathbf{0}$ 处计算场。此时，$\\mathbf{u} = -\\mathbf{R}$，因此 $u=|\\mathbf{R}|=R$ 且 $\\hat{\\mathbf{u}} = -\\hat{\\mathbf{R}}$。\n原点处的梯度为：\n$$\n\\nabla_{\\mathbf{r}} \\phi(\\mathbf{r}) \\Big|_{\\mathbf{r}=\\mathbf{0}} = \\left. \\frac{d\\phi}{du} \\right|_{u=R} \\hat{\\mathbf{u}} = q \\left[ -\\frac{1}{R^2}\\,\\mathrm{erf}\\!\\Big(\\frac{R}{\\sqrt{2}\\,\\sigma}\\Big) + \\frac{\\sqrt{2}}{R\\sqrt{\\pi}\\,\\sigma} e^{-R^2/(2\\sigma^2)} \\right] (-\\hat{\\mathbf{R}})\n$$\n电场为 $\\mathbf{E}(\\mathbf{0}) = -\\nabla_{\\mathbf{r}} \\phi(\\mathbf{r})|_{\\mathbf{r}=\\mathbf{0}}$：\n$$\n\\mathbf{E}(\\mathbf{0}) = q \\left[ \\frac{1}{R^2}\\,\\mathrm{erf}\\!\\Big(\\frac{R}{\\sqrt{2}\\,\\sigma}\\Big) - \\frac{\\sqrt{2}}{R\\sqrt{\\pi}\\,\\sigma} e^{-R^2/(2\\sigma^2)} \\right] (-\\hat{\\mathbf{R}})\n$$\n将其与要求的形式 $\\mathbf{E}(\\mathbf{0}) = q\\,f(R,\\sigma)\\,(-\\hat{\\mathbf{R}})$ 进行比较，我们可以确定标量函数 $f(R,\\sigma)$ 为：\n$$\nf(R,\\sigma) = \\frac{1}{R^2}\\,\\mathrm{erf}\\!\\Big(\\frac{R}{\\sqrt{2}\\,\\sigma}\\Big) - \\frac{\\sqrt{2}}{R\\sqrt{\\pi}\\,\\sigma} e^{-R^2/(2\\sigma^2)}\n$$\n对于点电荷情况（$\\sigma \\to 0$），我们分析其极限。令 $x = R/(\\sqrt{2}\\,\\sigma)$。当 $\\sigma \\to 0$ 时，$x \\to \\infty$。在此极限下，$\\mathrm{erf}(x) \\to 1$ 且与 $x e^{-x^2}$ 成正比的项消失。因此：\n$$\n\\lim_{\\sigma \\to 0} f(R,\\sigma) = \\frac{1}{R^2} (1) - 0 = \\frac{1}{R^2}\n$$\n这正确地再现了点电荷的场强因子。\n\n### 第二部分：径向力 $F_R$ 的推导\n\nQM 中心的极化能为 $E_{\\mathrm{QM}} = -\\frac{1}{2}\\alpha\\|\\mathbf{E}(\\mathbf{0})\\|^2$。电场的大小为 $\\|\\mathbf{E}(\\mathbf{0})\\| = |q|f(R,\\sigma)$，因为可以证明 $f(R,\\sigma)$ 是非负的。\n因此，能量为：\n$$\nE_{\\mathrm{QM}} = -\\frac{1}{2}\\alpha \\left( |q|f(R,\\sigma) \\right)^2 = -\\frac{1}{2}\\alpha q^2 f(R,\\sigma)^2\n$$\n作用在 MM 电荷上的力由 $\\mathbf{F}_{\\mathrm{MM}} = -\\nabla_{\\mathbf{R}}E_{\\mathrm{QM}}$ 给出。由于 $E_{\\mathrm{QM}}$ 仅依赖于大小 $R = \\|\\mathbf{R}\\|$，其梯度为：\n$$\n\\mathbf{F}_{\\mathrm{MM}} = -\\frac{\\partial E_{\\mathrm{QM}}}{\\partial R}\\hat{\\mathbf{R}} = -\\frac{\\partial}{\\partial R}\\left(-\\frac{1}{2}\\alpha q^2 f(R, \\sigma)^2\\right)\\hat{\\mathbf{R}}\n$$\n使用链式法则：\n$$\n\\mathbf{F}_{\\mathrm{MM}} = \\frac{1}{2}\\alpha q^2 \\left( 2 f(R,\\sigma) \\frac{\\partial f(R,\\sigma)}{\\partial R} \\right) \\hat{\\mathbf{R}} = \\alpha q^2 f(R,\\sigma)\\frac{\\partial f(R,\\sigma)}{\\partial R} \\hat{\\mathbf{R}}\n$$\n力的径向分量 $F_R$ 是 $\\mathbf{F}_{\\mathrm{MM}}$ 沿 $\\hat{\\mathbf{R}}$ 的投影：\n$$\nF_R = \\mathbf{F}_{\\mathrm{MM}} \\cdot \\hat{\\mathbf{R}} = \\alpha q^2 f(R,\\sigma)\\frac{\\partial f(R,\\sigma)}{\\partial R}\n$$\n为了计算这个值，我们需要 $f(R,\\sigma)$ 对 $R$ 的偏导数：\n$$\n\\frac{\\partial f}{\\partial R} = \\frac{\\partial}{\\partial R}\\left[ \\frac{1}{R^2}\\,\\mathrm{erf}\\!\\Big(\\frac{R}{\\sqrt{2}\\,\\sigma}\\Big) - \\frac{\\sqrt{2}}{R\\sqrt{\\pi}\\,\\sigma} e^{-R^2/(2\\sigma^2)} \\right]\n$$\n对两项应用乘法法则并化简后，我们得到：\n$$\n\\frac{\\partial f}{\\partial R} = -\\frac{2}{R^3}\\mathrm{erf}\\!\\Big(\\frac{R}{\\sqrt{2}\\,\\sigma}\\Big) + \\frac{2\\sqrt{2}}{R^2\\sqrt{\\pi}\\,\\sigma}e^{-R^2/(2\\sigma^2)} + \\frac{\\sqrt{2}}{\\sqrt{\\pi}\\,\\sigma^3}e^{-R^2/(2\\sigma^2)}\n$$\n在点电荷极限下（$\\sigma \\to 0$）：\n$$\nf(R,0) = \\frac{1}{R^2} \\quad \\text{and} \\quad \\frac{\\partial f}{\\partial R}(R,0) = \\frac{\\partial}{\\partial R}(R^{-2}) = -2R^{-3}\n$$\n在此极限下，力变为：\n$$\nF_R(R,0) = \\alpha q^2 \\left(\\frac{1}{R^2}\\right)(-2R^{-3}) = -\\frac{2\\alpha q^2}{R^5}\n$$\n这个结果正确地匹配了电荷 $q$ 与其在原点感应出的偶极子（$\\boldsymbol{\\mu} = -\\alpha q \\hat{\\mathbf{R}}/R^2$）之间的力。\n\n### 第三部分：用于实现的量\n\n程序必须基于这些推导计算几个量。\n\n**归一化感应偶极矩大小 $\\rho$**：\n感应偶极矩大小为 $\\mu(\\sigma) = \\|\\boldsymbol{\\mu}\\| = \\alpha \\|\\mathbf{E}(\\mathbf{0};\\sigma)\\| = \\alpha |q| f(R,\\sigma)$。\n归一化因子是点电荷极限下的偶极矩大小，$\\mu(0) = \\alpha|q|f(R,0) = \\alpha|q|/R^2$。\n归一化比率为：\n$$\n\\rho(R,\\sigma) = \\frac{\\mu(\\sigma)}{\\mu(0)} = \\frac{\\alpha|q|f(R,\\sigma)}{\\alpha|q|/R^2} = R^2 f(R,\\sigma)\n$$\n代入 $f(R,\\sigma)$ 的表达式：\n$$\n\\rho(R,\\sigma) = \\mathrm{erf}\\!\\Big(\\frac{R}{\\sqrt{2}\\,\\sigma}\\Big) - \\frac{\\sqrt{2}\\,R}{\\sqrt{\\pi}\\,\\sigma}e^{-R^2/(2\\sigma^2)}\n$$\n对于点电荷情况 $\\sigma=0$，我们有 $\\rho(R,0) = 1$。\n\n**解析力与有限差分力**：\n解析力 $F_R^{\\mathrm{analytic}}$ 使用推导出的公式 $F_R = \\alpha q^2 f \\frac{\\partial f}{\\partial R}$ 计算。有限差分力 $F_R^{\\mathrm{FD}}$ 是导数 $F_R = -\\partial E_{\\mathrm{QM}}/\\partial R$ 的数值近似，使用中心差分公式：\n$$\nF_R^{\\mathrm{FD}} = -\\frac{E_{\\mathrm{QM}}(R+h) - E_{\\mathrm{QM}}(R-h)}{2h}\n$$\n其中 $E_{\\mathrm{QM}}(r) = -\\frac{1}{2}\\alpha q^2 [f(r,\\sigma)]^2$ 且 $h=10^{-6}$~bohr。实现将计算两者并验证其一致性。\n\n程序将实现 $f(R,\\sigma)$ 和 $\\frac{\\partial f}{\\partial R}(R,\\sigma)$ 的函数，使用上面推导的表达式，分别处理特殊情况 $\\sigma=0$ 和一般情况 $\\sigma>0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Implements and analyzes a minimal QM/MM embedding model.\n\n    This function calculates properties for a system comprising a polarizable QM center\n    and a Gaussian-smeared MM charge. It derives the normalized induced dipole and\n    verifies an analytical force expression against a numerical finite-difference\n    approximation for a suite of test cases.\n    \"\"\"\n\n    # --- Fixed parameters for the simulation ---\n    alpha = 10.0  # Polarizability of the QM center (a.u.)\n    h = 1.0e-6    # Finite-difference step size (bohr)\n    error_tol = 1.0e-8 # Relative error tolerance for force verification\n\n    # --- Test suite cases: (R, sigma, q) in atomic units ---\n    test_cases = [\n        (2.0, 0.0, +1.0),  # Case 1: Point-charge limit\n        (0.5, 0.2, +1.0),  # Case 2: Short-range, small smearing\n        (0.5, 1.0, +1.0),  # Case 3: Short-range, large smearing\n        (5.0, 1.0, +1.0),  # Case 4: Long-range\n        (1.0, 0.5, -1.0)   # Case 5: Negative charge\n    ]\n\n    results = []\n    \n    # --- Helper functions for physical quantities ---\n    def get_f(R, sigma):\n        \"\"\"\n        Computes the scalar function f(R, sigma) that determines the E-field magnitude.\n        Handles the point-charge limit (sigma = 0) separately.\n        \"\"\"\n        if R == 0:\n            return np.inf\n        if sigma == 0.0:\n            return 1.0 / R**2\n        \n        term1 = erf(R / (np.sqrt(2.0) * sigma)) / R**2\n        term2 = (np.sqrt(2.0) / (R * np.sqrt(np.pi) * sigma)) * np.exp(-R**2 / (2.0 * sigma**2))\n        return term1 - term2\n\n    def get_df_dR(R, sigma):\n        \"\"\"\n        Computes the analytical derivative of f(R, sigma) with respect to R.\n        Handles the point-charge limit (sigma = 0) separately.\n        \"\"\"\n        if R == 0:\n            return np.inf\n        if sigma == 0.0:\n            return -2.0 / R**3\n\n        erf_term_val = erf(R / (np.sqrt(2.0) * sigma))\n        exp_term_val = np.exp(-R**2 / (2.0 * sigma**2))\n        \n        term1 = -2.0 * erf_term_val / R**3\n        term2 = (2.0 * np.sqrt(2.0) / (R**2 * np.sqrt(np.pi) * sigma)) * exp_term_val\n        term3 = (np.sqrt(2.0) / (np.sqrt(np.pi) * sigma**3)) * exp_term_val\n        \n        return term1 + term2 + term3\n\n    def get_polarization_energy(R, sigma, q, alpha_val):\n        \"\"\"Computes the QM polarization energy E_QM.\"\"\"\n        f_val = get_f(R, sigma)\n        return -0.5 * alpha_val * q**2 * f_val**2\n\n    # --- Main loop over test cases ---\n    for case in test_cases:\n        R, sigma, q = case\n        \n        # 1. Compute the normalized induced dipole magnitude, rho\n        if sigma == 0.0:\n            rho = 1.0\n        else:\n            # rho = R^2 * f(R, sigma)\n            x = R / (np.sqrt(2.0) * sigma)\n            rho = erf(x) - (np.sqrt(2.0) * R / (np.sqrt(np.pi) * sigma)) * np.exp(-x**2)\n\n        # 2. Compute the analytic radial force\n        f_val = get_f(R, sigma)\n        df_dR_val = get_df_dR(R, sigma)\n        F_R_analytic = alpha * q**2 * f_val * df_dR_val\n\n        # 3. Compute the finite-difference force for verification\n        E_plus = get_polarization_energy(R + h, sigma, q, alpha)\n        E_minus = get_polarization_energy(R - h, sigma, q, alpha)\n        F_R_FD = -(E_plus - E_minus) / (2.0 * h)\n        \n        # 4. Calculate the relative error and check against tolerance\n        denominator = max(abs(F_R_FD), 1.0e-12)\n        relative_error = abs(F_R_analytic - F_R_FD) / denominator\n        force_check_ok = relative_error  error_tol\n\n        # 5. Store the results for this case\n        results.append([rho, force_check_ok])\n\n    # Final print statement in the exact required format.\n    # The string conversion of booleans to 'True'/'False' matches the problem's example format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}