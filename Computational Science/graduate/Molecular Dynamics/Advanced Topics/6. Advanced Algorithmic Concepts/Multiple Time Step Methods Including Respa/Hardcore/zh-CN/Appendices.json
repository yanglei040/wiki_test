{
    "hands_on_practices": [
        {
            "introduction": "任何稳定的多时间步长（MTS）模拟的基础是选择能够解析其所负责的运动模式的时间步长。此练习将指导您使用简谐振子模型，将系统的物理频率与最大允许的内、外时间步长联系起来。这是设置参考系传播算法（RESPA）模拟时最关键的第一步，它确保了数值积分的稳定性。",
            "id": "3427664",
            "problem": "您正在设计一个基于可逆参考系统传播算法 (RESPA) 的可逆多时间步长积分器，用于一个经典分子动力学哈密顿量，该哈密顿量被分解为 $H = T(\\mathbf{p}) + V_{\\mathrm{fast}}(\\mathbf{q}) + V_{\\mathrm{slow}}(\\mathbf{q})$，其中 $V_{\\mathrm{fast}}$ 包含由最快振动主导的键合和短程项，而 $V_{\\mathrm{slow}}$ 包含缓慢变化的长程项。内部子循环以时间步长 $\\Delta t_{\\mathrm{inner}}$ 积分快作用力，外部循环每隔 $\\Delta t_{\\mathrm{outer}} = L \\, \\Delta t_{\\mathrm{inner}}$ 更新慢作用力，其中 $L \\in \\mathbb{N}$。\n\n假设为 $V_{\\mathrm{fast}}$ 测得的最快简正模频率为 $\\omega_{\\max} = 3.0 \\times 10^{14} \\ \\mathrm{s}^{-1}$，$V_{\\mathrm{slow}}$ 中的主导慢涨落频率为 $\\Omega = 6.0 \\times 10^{13} \\ \\mathrm{s}^{-1}$。您对内部快更新采用保守的安全因子 $c = 0.2$，对外部慢更新采用 $C = 0.5$，这些安全因子分别量化了在每个层级上解析的最快和最慢模式每步允许的最大无量纲相移。\n\n从牛顿方程和每个简正模的谐振子模型出发，论证对 $\\Delta t_{\\mathrm{inner}}$ 和 $\\Delta t_{\\mathrm{outer}}$ 的约束是如何通过限制相应角频率的每步相移而得出的，然后确定当 $\\Delta t_{\\mathrm{inner}}$ 取与其约束一致的最大值时，能确保内部快模式和外部慢模式的约束同时得到满足的最大整数外部-内部子循环因子 $L$。\n\n只需报告整数 $L$。最终答案无需单位。",
            "solution": "该问题要求确定 RESPA 多时间步长积分方案的最大整数子循环因子 $L$，给定系统最快和最慢模式相移的约束条件。分析始于谐振子模型，该模型是分子动力学中振荡运动的原型。\n\n具有频率 $\\omega_i$ 的单个简正模坐标 $q_i$ 的牛顿运动方程是简谐振子的方程：\n$$ \\ddot{q}_i(t) = -\\omega_i^2 q_i(t) $$\n该方程的解是正弦形式的，$q_i(t) = A_i \\cos(\\omega_i t + \\phi_i)$，其中项 $\\omega_i t + \\phi_i$ 是相位。在时间步长为 $\\Delta t$ 的数值积分方案中，每一步相位前进量为 $\\omega_i \\Delta t$。为了使积分稳定并准确捕捉振荡行为，此相移必须保持较小。问题通过安全因子 $c$ 和 $C$ 定义了此稳定性判据。\n\n首先，我们考虑用于积分快作用力 $V_{\\mathrm{fast}}$ 的内部时间步长 $\\Delta t_{\\mathrm{inner}}$。此积分的稳定性受限于系统中的最快频率 $\\omega_{\\max}$。此模式在单个内部步骤中的无量纲相移为 $\\omega_{\\max} \\Delta t_{\\mathrm{inner}}$。问题规定此值必须小于或等于安全因子 $c$：\n$$ \\omega_{\\max} \\Delta t_{\\mathrm{inner}} \\le c $$\n问题指明 $\\Delta t_{\\mathrm{inner}}$ 应取为与此约束一致的最大值。这意味着我们将不等式设为等式：\n$$ \\omega_{\\max} \\Delta t_{\\mathrm{inner}} = c $$\n这使我们能够将内部时间步长表示为：\n$$ \\Delta t_{\\mathrm{inner}} = \\frac{c}{\\omega_{\\max}} $$\n\n其次，我们考虑用于更新慢作用力 $V_{\\mathrm{slow}}$ 的外部时间步长 $\\Delta t_{\\mathrm{outer}}$。此步骤的稳定性判据由主导的慢涨落频率 $\\Omega$ 决定。此模式每个外部步骤的相移为 $\\Omega \\Delta t_{\\mathrm{outer}}$。这受安全因子 $C$ 的约束：\n$$ \\Omega \\Delta t_{\\mathrm{outer}} \\le C $$\n\n外部和内部时间步长通过整数子循环因子 $L$ 相关联，即 $\\Delta t_{\\mathrm{outer}} = L \\Delta t_{\\mathrm{inner}}$。我们可以将此关系代入外部步骤的约束中：\n$$ \\Omega (L \\Delta t_{\\mathrm{inner}}) \\le C $$\n\n现在我们有一个包含两个条件的系统。我们将第一个约束中 $\\Delta t_{\\mathrm{inner}}$ 的最大值表达式代入第二个约束中：\n$$ \\Omega L \\left(\\frac{c}{\\omega_{\\max}}\\right) \\le C $$\n\n我们被要求找到满足此不等式的最大整数 $L$。我们可以重新排列不等式以求解 $L$：\n$$ L \\le \\frac{C}{c} \\frac{\\omega_{\\max}}{\\Omega} $$\n\n现在，我们将给定的数值代入此表达式：\n- 快模式安全因子，$c = 0.2$\n- 慢模式安全因子，$C = 0.5$\n- 最快频率，$\\omega_{\\max} = 3.0 \\times 10^{14} \\ \\mathrm{s}^{-1}$\n- 主导慢频率，$\\Omega = 6.0 \\times 10^{13} \\ \\mathrm{s}^{-1}$\n\n$$ L \\le \\frac{0.5}{0.2} \\frac{3.0 \\times 10^{14}}{6.0 \\times 10^{13}} $$\n$$ L \\le 2.5 \\times \\frac{3.0}{0.6} $$\n$$ L \\le 2.5 \\times 5 $$\n$$ L \\le 12.5 $$\n\n由于 $L$ 必须是整数（$L \\in \\mathbb{N}$），满足此条件的最大整数 $L$ 值为 $12.5$ 的向下取整。\n$$ L_{\\max} = \\lfloor 12.5 \\rfloor = 12 $$\n因此，最大的整数外部-内部子循环因子是 $12$。",
            "answer": "$$\n\\boxed{12}\n$$"
        },
        {
            "introduction": "在建立了稳定的时间步长之后，下一步是理解多时间步长方法带来的性能增益。本练习提供了一个在生物分子模拟中非常常见且计算成本高昂的场景：使用粒子网格埃瓦尔德（PME）方法处理长程静电相互作用。通过计算快速傅里叶变换（FFT）调用次数的减少，学生可以亲手量化RESPA子循环方案所带来的效率提升。",
            "id": "3427660",
            "problem": "考虑一个分子动力学 (MD) 模拟，其中总力被分解为一个快速的短程分量和一个慢速的长程分量。慢速分量使用粒子网格埃瓦尔德 (Particle Mesh Ewald, PME) 方法进行计算，该方法采用三维快速傅里叶变换 (3D FFTs)。MD 积分器是通过参考系统传播算法 (Reference System Propagator Algorithm, RESPA) 进行时间尺度分离来构建的，它具有一个内部（快速）时间步长 $\\delta t$ 和一个外部（慢速）时间步长 $\\Delta t$，它们遵循关系 $\\Delta t = M \\, \\delta t$，其中 $M \\in \\mathbb{N}$ 是子循环比率。慢速 PME 分量在每个外部步长计算一次。假设每次 PME 计算都执行正好两次 3D FFT。取一个典型的约束 MD 内部时间步长为 $\\delta t = 2 \\,\\mathrm{fs}$，并定义 $\\delta t_{\\mathrm{fs}}$ 为 $\\delta t$ 以飞秒为单位表示的数值，因此 $\\delta t_{\\mathrm{fs}} = 2$。\n\n从时间离散动力学的第一性原理和 RESPA 子循环的定义出发，推导在 RESPA 方案下每纳秒执行的 3D FFT 次数，将其表示为子循环比率 $M$ 和给定典型时间步长的函数。作为参考基准，考虑一个单时间步长积分器，其中 PME 在每个内部步长 $\\delta t$ 都进行计算。使用 $1 \\,\\mathrm{ns} = 10^{6} \\,\\mathrm{fs}$ 这个事实。\n\n你的最终答案必须是一个单一的闭式解析表达式，给出在 RESPA 方案下每纳秒的 3D FFT 次数，且仅以 $M$ 为函数（其中给定的典型时间步长被隐式使用）。请将答案表示为一个无单位的无量纲计数。不需要进行四舍五入。",
            "solution": "该问题要求推导在使用参考系统传播算法 (RESPA) 的分子动力学 (MD) 模拟中，每纳秒执行的三维快速傅里叶变换 (3D FFTs) 的次数。推导必须从第一性原理出发。\n\n让我们定义问题陈述中提供的相关量。\n施加在粒子上的总力被划分为一个快变分量 $F_{\\text{fast}}$ 和一个慢变分量 $F_{\\text{slow}}$。\n该模拟采用两个时间步长：一个内部的快速时间步长 $\\delta t$ 和一个外部的慢速时间步长 $\\Delta t$。\n这些时间步长通过子循环比率 $M \\in \\mathbb{N}$ 相关联，由以下方程给出：\n$$\n\\Delta t = M \\delta t\n$$\n使用粒子网格埃瓦尔德 (PME) 方法计算的慢力分量，在每个外部时间步长 $\\Delta t$ 内被评估一次。\n每次 PME 评估需要执行正好两次 3D FFT。\n内部时间步长的值给定为 $\\delta t = 2 \\, \\mathrm{fs}$。问题还定义 $\\delta t_{\\mathrm{fs}}$ 为 $\\delta t$ 以飞秒为单位的数值，所以 $\\delta t_{\\mathrm{fs}} = 2$。\n我们需要求出每纳秒执行的 3D FFT 次数，在此记为 $\\mathcal{N}_{\\text{FFT/ns}}$。纳秒和飞秒之间的转换因子是 $1 \\, \\mathrm{ns} = 10^6 \\, \\mathrm{fs}$。\n\n一个事件发生的频率是连续事件之间时间周期的倒数。PME 计算在每个外部时间步长 $\\Delta t$ 执行一次。因此，PME 评估的频率 $f_{\\text{PME}}$ 为：\n$$\nf_{\\text{PME}} = \\frac{1}{\\Delta t}\n$$\n问题指出每次 PME 评估执行 $n_{\\text{FFT}} = 2$ 次 FFT。因此，FFT 的执行速率 $R_{\\text{FFT}}$ 是 PME 评估频率的两倍：\n$$\nR_{\\text{FFT}} = n_{\\text{FFT}} \\times f_{\\text{PME}} = \\frac{2}{\\Delta t}\n$$\n该速率的单位是“事件数/单位时间”，其中时间单位由 $\\Delta t$ 的单位决定。由于 $\\delta t$ 是以飞秒为单位给出的，我们也将以飞秒来表示 $\\Delta t$。\n使用关系式 $\\Delta t = M \\delta t$，我们可以将速率写为：\n$$\nR_{\\text{FFT}} = \\frac{2}{M \\delta t}\n$$\n为了以“FFT 次数/纳秒”这一特定单位来表示此速率，我们必须在速率的时间单位（飞秒）和期望的时间单位（纳秒）之间建立关系。\n每纳秒的事件数等于事件的速率（以“事件数/飞秒”为单位）乘以一纳秒内的飞秒数。\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = R_{\\text{FFT}} \\times \\left( \\frac{10^6 \\, \\mathrm{fs}}{1 \\, \\mathrm{ns}} \\right)\n$$\n代入 $R_{\\text{FFT}}$ 的表达式，我们得到：\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\left( \\frac{2}{M \\delta t} \\right) \\times 10^6 \\, \\mathrm{ns}^{-1}\n$$\n这里，为了保持量纲一致性，$\\delta t$ 必须以飞秒为单位表示。设 $\\delta t = \\delta t_{\\mathrm{fs}} \\, \\mathrm{fs}$，其中 $\\delta t_{\\mathrm{fs}}$ 是数值。表达式变为：\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\frac{2}{M (\\delta t_{\\mathrm{fs}} \\, \\mathrm{fs})} \\times 10^6 \\, \\mathrm{fs}\n$$\n飞秒（$\\mathrm{fs}$）单位相互抵消，留下一个无量纲的计数，正如预期的那样。\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\frac{2 \\times 10^6}{M \\delta t_{\\mathrm{fs}}}\n$$\n问题指明了内部时间步长的典型值为 $\\delta t = 2 \\, \\mathrm{fs}$。这对应于 $\\delta t_{\\mathrm{fs}} = 2$。将此值代入方程，得到以 $M$ 为函数的最终表达式：\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\frac{2 \\times 10^6}{M \\times 2}\n$$\n通过消去因子 2 来简化表达式：\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\frac{10^6}{M}\n$$\n这就是在 RESPA 方案下，每纳秒模拟时间执行的 3D FFT 次数，是子循环比率 $M$ 的函数。\n\n作为一致性检查，我们可以考虑问题中提到的参考基准情况，即在每个内部步长 $\\delta t$ 都评估 PME。这对应于慢力没有子循环的 RESPA 方案，即 $M=1$。对于 $M=1$，我们推导的公式给出 $\\mathcal{N}_{\\text{FFT/ns}} = \\frac{10^6}{1} = 10^6$。\n让我们从第一性原理来验证这个基准情况。每纳秒的内部步数为 $\\frac{1 \\, \\mathrm{ns}}{\\delta t} = \\frac{10^6 \\, \\mathrm{fs}}{2 \\, \\mathrm{fs}} = 5 \\times 10^5$。由于每一步都调用 PME，因此每纳秒有 $5 \\times 10^5$ 次 PME 调用。每次 PME 调用有 2 次 FFT，所以每纳秒的 FFT 总次数为 $(5 \\times 10^5) \\times 2 = 10^6$。这与我们公式在 $M=1$ 时的结果相符，从而证实了推导的正确性。",
            "answer": "$$\\boxed{\\frac{10^6}{M}}$$"
        },
        {
            "introduction": "对于高质量的模拟而言，仅有稳定性是不够的；精度（例如，能量守恒）至关重要。本练习将介绍一个更高级的、现实的框架，用于在严格的能量漂移容差下，通过最小化计算成本来选择最优的子循环比率$M$。这使得我们从基本的参数设置，转向了进行高水平科学研究所需的高级调优方法。",
            "id": "3427621",
            "problem": "一位分子动力学实践者希望通过使用一种可逆多时间步方案，即参考系统传播子算法（RESPA）类型，来加速溶剂化蛋白质的模拟。总作用力被分解为一个快的、短程部分和一个慢的、长程部分，前者的特征频率远高于后者。快的部分使用内层时间步长 $\\Delta t$ 进行积分，而慢的部分每隔一个外层步长 $H = M \\,\\Delta t$ 更新一次，其中 $M$ 是一个正整数子循环比率。快和慢的力分量每次评估的计算成本分别为 $c_{f}$ 和 $c_{s}$。已知该代码在线性上是稳定的，只要满足 $\\Delta t \\le \\Delta t_{\\max}^{(f)}$ 和 $H \\le H_{\\max}^{(s)}$；这些限制分别源于最高的快振动频率，以及在外层更新中避免与快谱发生共振。\n\n该科学家将运行长时间的平衡轨迹，不对完整自由度施加约束，并通过验证性研究估算出每纳秒可接受的均方根 (RMS) 能量漂移率，记为 $\\mathcal{E}_{\\mathrm{rms}}^{\\max}$。对于可逆、辛、二阶算子分裂积分器而言，一个经过充分检验的事实是：在稳定域内，对于足够小的步长，主要的 RMS 能量漂移率与相关步长成二次方关系。当使用力分解时，主要贡献来自于内层的快更新和慢-快分裂误差。对于给定的分子系统和力场，相应的比例系数可以通过短时间的校准运行获得；将它们记为 $\\alpha$ 和 $\\beta$，因此 RMS 漂移率表现出如下的小步长标度关系：\n$$\n\\mathcal{E}_{\\mathrm{rms}} \\;\\lesssim\\; \\alpha \\, \\Delta t^{2} \\;+\\; \\beta \\, H^{2}\n\\quad\\text{for}\\quad \\Delta t \\le \\Delta t_{\\max}^{(f)},\\; H \\le H_{\\max}^{(s)}.\n$$\n假设这个界限足够紧，可以用作设计约束。\n\n对于固定的 1 纳秒模拟时间间隔，预期的计算成本正比于内层步数乘以 $c_{f}$ 加上外层慢力评估次数乘以 $c_{s}$。\n\n在 RMS 能量漂移界限 $\\mathcal{E}_{\\mathrm{rms}} \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$ 和稳定性约束下，以下哪个标准是选择子循环比率 $M$ 以最小化每纳秒计算成本的正确且有原则的方法？\n\nA. 选择 $M$ 以最小化\n$$\n\\mathcal{C}(M) \\;=\\; \\frac{c_{f} + c_{s}/M}{\\Delta t_{\\mathrm{eff}}(M)} \\,,\n\\quad\n\\Delta t_{\\mathrm{eff}}(M) \\;=\\; \\min\\!\\left\\{ \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^{2}}}\\,,\\; \\Delta t_{\\max}^{(f)}\\,,\\; \\frac{H_{\\max}^{(s)}}{M} \\right\\},\n$$\n并且在漂移约束起作用的区域（即 $\\Delta t_{\\mathrm{eff}}(M) = \\sqrt{\\mathcal{E}_{\\mathrm{rms}}^{\\max}/(\\alpha + \\beta M^{2})}$），选择最接近\n$$\nM^{\\star} \\;=\\; \\left(\\frac{c_{s}\\,\\alpha}{\\beta\\,c_{f}}\\right)^{\\!1/3},\n$$\n的整数 $M$，同时需要满足稳定性约束。\n\nB. 通过选择 $M$ 使得 $c_{s}/M = c_{f}$（即 $M^{\\star} = c_{s}/c_{f}$）来平衡每个内层步长中快力和慢力的计算成本，然后将 $\\Delta t$ 设置为稳定性允许的最大值。\n\nC. 通过设置 $M^{\\star} = \\left\\lfloor H_{\\max}^{(s)}/\\Delta t_{\\max}^{(f)} \\right\\rfloor$ 在慢力稳定性限制内最大化 $M$，从而使得慢力的评估尽可能不频繁。\n\nD. 通过选择 $M$ 使得 $\\alpha \\Delta t^{2} = \\beta H^{2}$（即 $M^{\\star} = \\sqrt{\\alpha/\\beta}$）来使 RMS 漂移界限的快分量和慢分量相等，然后选择 $\\Delta t$ 以使漂移约束饱和。",
            "solution": "用户要求对一个关于多时间步分子动力学模拟优化的问题进行审慎评估。该过程始于对问题陈述的严格验证。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n\n*   **积分方案**：可逆多时间步参考系统传播子算法（RESPA）。\n*   **力分解**：总作用力被分解为快的部分和慢的部分。\n*   **时间步长**：\n    *   内层时间步长（快力）：$\\Delta t$。\n    *   外层时间步长（慢力）：$H = M \\Delta t$，其中 $M$ 是一个正整数子循环比率。\n*   **计算成本**：\n    *   快力的单次评估成本：$c_{f}$。\n    *   慢力的单次评估成本：$c_{s}$。\n*   **稳定性约束**：\n    *   $\\Delta t \\le \\Delta t_{\\max}^{(f)}$。\n    *   $H \\le H_{\\max}^{(s)}$。\n*   **精度约束（能量守恒）**：\n    *   每纳秒最大可接受均方根 (RMS) 能量漂移率：$\\mathcal{E}_{\\mathrm{rms}}^{\\max}$。\n    *   RMS 漂移率的标度关系：$\\mathcal{E}_{\\mathrm{rms}} \\approx \\alpha \\, \\Delta t^{2} + \\beta \\, H^{2}$。\n    *   需执行的约束：$\\alpha \\, \\Delta t^{2} + \\beta \\, H^{2} \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$。\n*   **优化目标**：最小化每纳秒的计算成本。\n*   **成本函数定义**：对于固定的模拟时间间隔 $T = 1$ ns，成本正比于快力评估总次数加上慢力评估总次数。\n    *   快力评估次数：$N_f = T / \\Delta t$。\n    *   慢力评估次数：$N_s = T / H = T / (M \\Delta t)$。\n    *   总成本正比于 $N_f c_f + N_s c_s = \\frac{T}{\\Delta t} c_f + \\frac{T}{M \\Delta t} c_s$。为最小化单位时间的成本，我们最小化函数 $\\mathcal{C}(\\Delta t, M) = \\frac{1}{\\Delta t} \\left(c_f + \\frac{c_s}{M}\\right)$。\n\n#### 步骤2：使用提取的已知条件进行验证\n\n*   **科学上合理**：该问题牢固地植根于分子动力学数值积分的既定理论和实践。RESPA 的使用、基于特征时间尺度的力分解、数值积分器（例如 Verlet 类型）的稳定性极限概念，以及作为精度度量的能量漂移分析，都是计算统计力学中的标准概念。对于二阶辛积分器，能量漂移误差与时间步长的二次方标度关系是一个众所周知的结果。该问题在科学上是合理的。\n*   **适定性**：该问题是一个约束优化问题。它要求在关于变量 $\\Delta t$ 和 $M$ 的一组不等式约束下，最小化一个明确定义的成本函数 $\\mathcal{C}(\\Delta t, M)$。此类问题在数学上是适定的，并且有有意义的解。\n*   **客观性**：该问题使用精确的数学语言和客观的物理量（$c_f$、$c_s$、$\\alpha$、$\\beta$ 等）来表述。没有主观或含糊的陈述。\n*   **完整性和一致性**：该问题提供了所有必要的信息：目标函数、待优化的变量（$\\Delta t$ 和 $M$）以及所有相关约束（稳定性和精度）。定义是自洽的。\n\n#### 步骤3：结论与行动\n\n问题陈述有效。它在科学上合理、适定、客观且自成体系。因此，我将继续推导解决方案。\n\n### 求解推导\n\n目标是在一组约束条件下，最小化由函数 $\\mathcal{C}(\\Delta t, M) = \\frac{1}{\\Delta t} \\left(c_f + \\frac{c_s}{M}\\right)$ 给出的每纳秒计算成本。\n\n对积分参数 $\\Delta t$ 和 $M$ 的约束是：\n1.  **快力稳定性**：$\\Delta t \\le \\Delta t_{\\max}^{(f)}$。\n2.  **慢力稳定性**：$H \\le H_{\\max}^{(s)}$，这等价于 $M \\Delta t \\le H_{\\max}^{(s)}$，或 $\\Delta t \\le \\frac{H_{\\max}^{(s)}}{M}$。\n3.  **精度（能量漂移）**：$\\mathcal{E}_{\\mathrm{rms}} \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$。使用给定的标度关系，即 $\\alpha \\Delta t^2 + \\beta H^2 \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$。代入 $H = M \\Delta t$，我们得到 $\\alpha \\Delta t^2 + \\beta (M \\Delta t)^2 \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$，简化为 $(\\alpha + \\beta M^2) \\Delta t^2 \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$。这给出了关于 $\\Delta t$ 的第三个上界：$\\Delta t \\le \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^2}}$。\n\n为了最小化成本函数 $\\mathcal{C}(\\Delta t, M)$（它与 $\\Delta t$ 成反比），对于任何给定的子循环比率 $M$，必须选择 $\\Delta t$ 的最大可能值。允许的最大 $\\Delta t$ 是从约束中推导出的三个上界的最小值：\n$$\n\\Delta t_{\\text{opt}}(M) = \\min\\left\\{ \\Delta t_{\\max}^{(f)}, \\; \\frac{H_{\\max}^{(s)}}{M}, \\; \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^2}} \\right\\}\n$$\n这个表达式与选项 A 中定义的 $\\Delta t_{\\mathrm{eff}}(M)$ 相同。\n\n问题现在简化为一个一维优化问题：找到正整数 $M$，使得当 $\\Delta t$ 被设置为对应 $M$ 的最优值时，成本函数最小化：\n$$\n\\mathcal{C}(M) = \\frac{c_f + c_s/M}{\\Delta t_{\\text{opt}}(M)}\n$$\n\n这是一个通用的公式。在许多实际场景中，模拟运行在精度而非线性稳定性是限制因素的区域。这对应于 `min` 函数中第三项最小的情况，即漂移约束是“活动的”。让我们按照选项 A 的建议，分析这个具体但常见的区域。\n\n假设漂移约束是活动的，我们有：\n$$\n\\Delta t = \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^2}}\n$$\n将此代入成本函数，得到：\n$$\n\\mathcal{C}(M) = \\frac{c_f + c_s/M}{\\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^2}}} = \\frac{1}{\\sqrt{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}} \\left(c_f + \\frac{c_s}{M}\\right) \\sqrt{\\alpha + \\beta M^2}\n$$\n为了找到最小化 $\\mathcal{C}(M)$ 的最优 $M$，我们可以将 $M$ 视为一个连续变量，通过微分找到极值，然后选择最接近这个最优实数值的整数。我们可以忽略常数前因子 $1/\\sqrt{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}$，转而最小化函数 $f(M) = (c_f + c_s/M) \\sqrt{\\alpha + \\beta M^2}$。最小化该函数的平方 $f(M)^2$ 通常更简单，因为这可以去掉平方根，并且对于正函数，其极值点不变。\n令 $g(M) = f(M)^2 = (c_f + c_s/M)^2 (\\alpha + \\beta M^2)$。为了找到最小值，我们将其对 M 的导数设为零。\n$$\n\\frac{dg}{dM} = \\frac{d}{dM} \\left[ \\left(c_f + \\frac{c_s}{M}\\right)^2 (\\alpha + \\beta M^2) \\right] = 0\n$$\n使用乘法法则：\n$$\n2\\left(c_f + \\frac{c_s}{M}\\right)\\left(-\\frac{c_s}{M^2}\\right)(\\alpha + \\beta M^2) + \\left(c_f + \\frac{c_s}{M}\\right)^2(2\\beta M) = 0\n$$\n由于 $c_f + c_s/M  0$，我们可以除以因子 $2(c_f + c_s/M)$：\n$$\n-\\frac{c_s}{M^2}(\\alpha + \\beta M^2) + \\left(c_f + \\frac{c_s}{M}\\right)(\\beta M) = 0\n$$\n$$\n-\\frac{c_s \\alpha}{M^2} - c_s \\beta + c_f \\beta M + c_s \\beta = 0\n$$\n$$\nc_f \\beta M = \\frac{c_s \\alpha}{M^2}\n$$\n$$\nM^3 = \\frac{c_s \\alpha}{c_f \\beta}\n$$\n$$\nM^{\\star} = \\left(\\frac{c_s \\alpha}{\\beta c_f}\\right)^{1/3}\n$$\n这个结果给出了当精度约束占主导时最优的子循环比率 $M$。完整且有原则的程序包括：首先定义在所有可能区域（稳定性限制或精度限制）上的成本函数 $\\mathcal{C}(M)$，然后找到使其最小化的整数 $M$。$M^{\\star}$ 的表达式是针对精度限制区域的特定解。\n\n### 逐项分析选项\n\n**A. 选择 $M$ 以最小化 $\\mathcal{C}(M) = \\frac{c_{f} + c_{s}/M}{\\Delta t_{\\mathrm{eff}}(M)}$，其中 $\\Delta t_{\\mathrm{eff}}(M) = \\min\\!\\left\\{ \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^{2}}}\\,,\\; \\Delta t_{\\max}^{(f)}\\,,\\; \\frac{H_{\\max}^{(s)}}{M} \\right\\}$，并且在漂移约束起作用的区域，选择最接近 $M^{\\star} = \\left(\\frac{c_{s}\\,\\alpha}{\\beta\\,c_{f}}\\right)^{\\!1/3}$ 的整数 $M$，同时需要满足稳定性约束。**\n\n该选项首先通过将成本定义为 $M$ 的函数，正确地表述了完整的优化问题，其中 $\\Delta t$ 根据所有约束被最大化。然后，它为在性能受所需精度（能量漂移）而非数值稳定性限制的常见且重要的区域内，为最优 $M$ 提供了正确的解析解。选择接近此解析最优值的整数 $M$，同时检查该选择是否与初始假设一致（即不违反稳定性约束）的程序是正确的方法。\n**结论：正确。**\n\n**B. 通过选择 $M$ 使得 $c_{s}/M = c_{f}$（即 $M^{\\star} = c_{s}/c_{f}$）来平衡每个内层步长中快力和慢力的计算成本，然后将 $\\Delta t$ 设置为稳定性允许的最大值。**\n\n这是一种特设的启发式方法，试图平衡计算工作量。慢力成本在单个内层步长上的平均值为 $c_s/M$。将其等同于一次快力评估成本 $c_f$ 会得到 $M=c_s/c_f$。这种方法完全忽略了由参数 $\\alpha$ 和 $\\beta$ 代表的误差累积物理学。如推导所示，成本和精度之间的最优权衡必须涉及这些参数。这种启发式方法不保证是最优的。\n**结论：不正确。**\n\n**C. 通过设置 $M^{\\star} = \\left\\lfloor H_{\\max}^{(s)}/\\Delta t_{\\max}^{(f)} \\right\\rfloor$ 在慢力稳定性限制内最大化 $M$，从而使得慢力的评估尽可能不频繁。**\n\n该策略对应于将内层和外层时间步长同时推至各自的稳定性极限：$\\Delta t = \\Delta t_{\\max}^{(f)}$ 和 $H = M \\Delta t = H_{\\max}^{(s)}$。虽然这相对于稳定性最大化了时间步长，但它完全忽略了精度约束 $\\mathcal{E}_{\\mathrm{rms}}^{\\max}$。如果由此产生的能量漂移高得无法接受，那么这种参数选择是无效的。即使漂移可以接受，这种选择通常也不是最优的，因为 $M$ 和 $\\Delta t$ 的不同组合可能会以更低的计算成本产生相同的精度。\n**结论：不正确。**\n\n**D. 通过选择 $M$ 使得 $\\alpha \\Delta t^{2} = \\beta H^{2}$（即 $M^{\\star} = \\sqrt{\\alpha/\\beta}$）来使 RMS 漂移界限的快分量和慢分量相等，然后选择 $\\Delta t$ 以使漂移约束饱和。**\n\n这种被称为“误差均分”的启发式方法建议平衡两个主要的误差来源。从 $\\alpha \\Delta t^2 = \\beta (M\\Delta t)^2$ 可得 $M^2 = \\alpha/\\beta$，即 $M = \\sqrt{\\alpha/\\beta}$。这种方法忽略了与控制每个误差分量相关的计算成本 $c_f$ 和 $c_s$。真正的最优解必须平衡降低每个来源误差的边际成本。推导出的最优条件 $M^3 = (c_s \\alpha)/(c_f \\beta)$ 清楚地表明成本 $c_f$ 和 $c_s$ 起着关键作用。只有在管理每个误差源的有效成本相等的特定情况下，误差均分才是最优的，但这在一般情况下是不成立的。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}