{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex calculations, it is essential to ensure that the foundational equations are physically consistent. This first practice involves a dimensional analysis of the Green–Kubo formula for shear viscosity, $\\eta$. By breaking down the expression into its fundamental units of mass ($M$), length ($L$), and time ($T$), you will verify that the combination of microscopic quantities—stress fluctuations, volume, and thermal energy—correctly yields the expected macroscopic units of viscosity.",
            "id": "3445650",
            "problem": "Consider a homogeneous equilibrium fluid in three spatial dimensions, simulated by Molecular Dynamics (MD). Let $P_{xy}(t)$ denote the $xy$-component of the microscopic stress tensor (also called the microscopic pressure tensor) at time $t$, and let $\\langle \\cdot \\rangle$ denote an equilibrium ensemble average. The Green–Kubo expression for the shear viscosity relates the shear viscosity $\\eta$ to an equilibrium time-correlation function of $P_{xy}(t)$ via an expression of the form\n$$\n\\eta \\;=\\; \\frac{V}{k_{B} T} \\int_{0}^{\\infty} \\langle P_{xy}(0)\\,P_{xy}(t)\\rangle \\, dt,\n$$\nwhere $V$ is the system volume, $T$ is the absolute temperature, and $k_{B}$ is the Boltzmann constant. Assume that $P_{xy}$ has the dimensions of pressure, and that the autocorrelation function $\\langle P_{xy}(0)\\,P_{xy}(t)\\rangle$ inherits the product dimensions of its factors. Using only the following fundamental bases and definitions:\n- Newton’s second law implies force has dimensions $M L T^{-2}$.\n- Pressure is force per area.\n- Energy is force times length.\n- The product $k_{B}T$ has the dimensions of energy.\n- Volume has dimensions $L^{3}$.\n- Time integration contributes a factor with the dimensions of time.\nverify by dimensional analysis that $\\eta$ indeed has the dimensions of a shear viscosity. Express your final result as a product of base dimensions $M$, $L$, and $T$, using powers to indicate exponents. Do not use named units. Provide your final answer as a single analytic expression in terms of $M$, $L$, and $T$ only.",
            "solution": "The problem requires a dimensional analysis of the Green–Kubo expression for shear viscosity, $\\eta$, to verify its dimensional correctness. The given expression is:\n$$\n\\eta = \\frac{V}{k_{B} T} \\int_{0}^{\\infty} \\langle P_{xy}(0)\\,P_{xy}(t)\\rangle \\, dt\n$$\nLet $[Q]$ denote the dimensions of a physical quantity $Q$. Our goal is to determine $[\\eta]$ in terms of the base dimensions of mass ($M$), length ($L$), and time ($T$). The dimensional equation corresponding to the given formula is:\n$$\n[\\eta] = \\frac{[V]}{[k_{B} T]} \\left[ \\int_{0}^{\\infty} \\langle P_{xy}(0)\\,P_{xy}(t)\\rangle \\, dt \\right]\n$$\nWe will determine the dimensions of each term on the right-hand side based on the provided definitions.\n\n1.  **Dimensions of Volume, $[V]$**:\n    The problem states that volume has dimensions $L^3$.\n    $$\n    [V] = L^{3}\n    $$\n\n2.  **Dimensions of Thermal Energy, $[k_{B}T]$**:\n    The problem states that the product $k_{B}T$ has the dimensions of energy. It also states that energy is force times length, and force has dimensions $M L T^{-2}$.\n    $$\n    [\\text{Force}] = M L T^{-2}\n    $$\n    $$\n    [\\text{Energy}] = [\\text{Force}] \\times [\\text{Length}] = (M L T^{-2}) \\times L = M L^{2} T^{-2}\n    $$\n    Therefore, the dimensions of $k_{B}T$ are:\n    $$\n    [k_{B}T] = M L^{2} T^{-2}\n    $$\n\n3.  **Dimensions of the Time Integral**:\n    The dimensions of the integral term are the product of the dimensions of the integrand, $\\langle P_{xy}(0)\\,P_{xy}(t)\\rangle$, and the dimensions of the differential element, $dt$, which is time.\n    $$\n    \\left[ \\int_{0}^{\\infty} \\langle P_{xy}(0)\\,P_{xy}(t)\\rangle \\, dt \\right] = [\\langle P_{xy}(0)\\,P_{xy}(t)\\rangle] \\times [t]\n    $$\n    First, we need the dimensions of the stress tensor component, $P_{xy}$. The problem states that $P_{xy}$ has the dimensions of pressure, and pressure is defined as force per area. Area has dimensions $L^2$.\n    $$\n    [\\text{Pressure}] = \\frac{[\\text{Force}]}{[\\text{Area}]} = \\frac{M L T^{-2}}{L^{2}} = M L^{-1} T^{-2}\n    $$\n    Thus, $[P_{xy}] = M L^{-1} T^{-2}$. The problem specifies that the autocorrelation function $\\langle P_{xy}(0)\\,P_{xy}(t)\\rangle$ inherits the product dimensions of its factors.\n    $$\n    [\\langle P_{xy}(0)\\,P_{xy}(t)\\rangle] = [P_{xy}(0)] \\times [P_{xy}(t)] = [P_{xy}]^2 = (M L^{-1} T^{-2})^{2} = M^{2} L^{-2} T^{-4}\n    $$\n    The integration over time contributes a factor with the dimensions of time, $T$.\n    $$\n    \\left[ \\int_{0}^{\\infty} \\langle P_{xy}(0)\\,P_{xy}(t)\\rangle \\, dt \\right] = (M^{2} L^{-2} T^{-4}) \\times T = M^{2} L^{-2} T^{-3}\n    $$\n\n4.  **Assembling the Dimensions of $\\eta$**:\n    Now we substitute the dimensions of each component back into the dimensional equation for $\\eta$.\n    $$\n    [\\eta] = \\frac{[V]}{[k_{B} T]} \\left[ \\int_{0}^{\\infty} \\langle P_{xy}(0)\\,P_{xy}(t)\\rangle \\, dt \\right] = \\frac{L^{3}}{M L^{2} T^{-2}} \\times (M^{2} L^{-2} T^{-3})\n    $$\n    We simplify this expression by combining the powers of $M$, $L$, and $T$. First, let's simplify the fraction.\n    $$\n    \\frac{L^{3}}{M L^{2} T^{-2}} = M^{-1} L^{3-2} T^{2} = M^{-1} L^{1} T^{2}\n    $$\n    Now, multiply this by the dimensions of the integral part.\n    $$\n    [\\eta] = (M^{-1} L^{1} T^{2}) \\times (M^{2} L^{-2} T^{-3})\n    $$\n    Combining the exponents for each base dimension:\n    -   For mass, $M$: $M^{-1+2} = M^{1}$\n    -   For length, $L$: $L^{1-2} = L^{-1}$\n    -   For time, $T$: $T^{2-3} = T^{-1}$\n    So, the resulting dimensions for $\\eta$ are:\n    $$\n    [\\eta] = M L^{-1} T^{-1}\n    $$\n\nTo verify that these are indeed the dimensions of shear viscosity, we can recall the defining constitutive relation for a Newtonian fluid, where shear stress $\\tau_{xy}$ is proportional to the shear rate $\\partial v_{x} / \\partial y$.\n$$\n\\tau_{xy} = \\eta \\frac{\\partial v_{x}}{\\partial y}\n$$\nThe shear stress $\\tau_{xy}$ has dimensions of pressure, so $[\\tau_{xy}] = M L^{-1} T^{-2}$. The shear rate has dimensions of velocity ($L T^{-1}$) divided by length ($L$), so $[\\partial v_{x} / \\partial y] = (L T^{-1}) / L = T^{-1}$. From this definition, the dimensions of viscosity are:\n$$\n[\\eta] = \\frac{[\\tau_{xy}]}{[\\partial v_{x}/\\partial y]} = \\frac{M L^{-1} T^{-2}}{T^{-1}} = M L^{-1} T^{-1}\n$$\nThis result matches the one derived from the Green–Kubo formula, thus verifying the dimensional consistency of the expression. The final result expressed as a product of base dimensions is $M L^{-1} T^{-1}$.",
            "answer": "$$ \\boxed{M L^{-1} T^{-1}} $$"
        },
        {
            "introduction": "Molecular dynamics simulations provide microscopic data that must be correctly mapped to macroscopic theoretical constructs. This exercise first bridges the gap between the per-atom stress tensor common in simulation outputs and the formal Cauchy stress tensor, demonstrating their relationship and unit consistency . You will then apply the Green-Kubo formula to a clean, idealized stress autocorrelation function to perform a straightforward viscosity calculation, solidifying your understanding of the integral relationship in a controlled scenario.",
            "id": "3445590",
            "problem": "A classical atomistic fluid of $N$ particles is simulated with Molecular Dynamics (MD) in a cubic periodic box of side length $L=6.0 \\,\\mathrm{nm}$ at temperature $T=300 \\,\\mathrm{K}$. The MD code reports a per-atom symmetric stress contribution $s_i^{\\alpha\\beta}(t)$ defined so that the extensive summed quantity $S^{\\alpha\\beta}(t) \\equiv \\sum_{i=1}^{N} s_i^{\\alpha\\beta}(t)$ satisfies $S^{\\alpha\\beta}(t) = - V \\,\\sigma^{\\alpha\\beta}(t)$, where $V=L^3$ and $\\sigma^{\\alpha\\beta}(t)$ is the instantaneous Cauchy stress tensor component. The per-atom quantity $s_i^{\\alpha\\beta}(t)$ includes both kinetic and virial (force-position) contributions and is reported in Joules. You may assume the Irving–Kirkwood microscopic momentum-flux operator and standard classical mechanics.\n\n1. Starting from the microscopic momentum-flux representation of stress and the Irving–Kirkwood decomposition into kinetic $m_i v_i^{\\alpha} v_i^{\\beta}$ and configurational $r_{ij}^{\\alpha} f_{ij}^{\\beta}$ contributions, justify the code’s convention $S^{\\alpha\\beta}(t) = - V \\,\\sigma^{\\alpha\\beta}(t)$ by demonstrating that (i) the summed per-atom quantity $S^{\\alpha\\beta}(t)$ has units of energy and (ii) dividing $-S^{\\alpha\\beta}(t)$ by the volume $V$ recovers a stress with units of pressure and the correct magnitude.\n\n2. In equilibrium, the Green–Kubo (GK) fluctuation–dissipation relation connects the shear viscosity $\\eta$ to the time integral of an equilibrium shear stress autocorrelation function. Let $C_{S}(t) \\equiv \\langle S^{xy}(t)\\,S^{xy}(0)\\rangle$ denote the autocorrelation of the summed per-atom quantity for the $xy$ component, measured by the MD code, and suppose that $C_{S}(t)$ is well fit by a single-exponential form\n$$\nC_{S}(t) = C_{0}\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n$$\nwith $C_{0} = 4.80 \\times 10^{-37}\\,\\mathrm{J}^2$ and $\\tau = 2.10\\,\\mathrm{ps}$. Using the fluctuation–dissipation connection and your reconciliation from part 1, derive an expression for $\\eta$ in terms of $C_{0}$, $\\tau$, $k_{B}$, $T$, and $V$, and then evaluate it numerically for the parameters above. Round your final numerical result to three significant figures and express the viscosity in millipascal–second ($\\mathrm{mPa}·\\mathrm{s}$).",
            "solution": "This problem is divided into two parts. The first part requires a justification of a convention used in a Molecular Dynamics (MD) code for the stress tensor. The second part asks for the calculation of the shear viscosity using the Green-Kubo relation and data from the simulation.\n\nPart 1: Justification of the Stress Tensor Convention\n\nThe instantaneous microscopic stress tensor, $\\sigma^{\\alpha\\beta}(t)$, in a volume $V$ containing $N$ particles is given by the Irving–Kirkwood formula, which is derived from the conservation of momentum on a microscopic level. For a system of particles interacting via pairwise forces, the expression is:\n$$\n\\sigma^{\\alpha\\beta}(t) = -\\frac{1}{V} \\left( \\sum_{i=1}^{N} m_i v_i^{\\alpha}(t) v_i^{\\beta}(t) + \\frac{1}{2} \\sum_{i \\neq j} r_{ij}^{\\alpha}(t) f_{ij}^{\\beta}(t) \\right)\n$$\nHere, $m_i$ is the mass of particle $i$, $v_i^{\\alpha}$ is the $\\alpha$-component of its velocity, $r_{ij}^{\\alpha}$ is the $\\alpha$-component of the separation vector $\\mathbf{r}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i$, and $f_{ij}^{\\beta}$ is the $\\beta$-component of the force exerted on particle $i$ by particle $j$. The first sum is the kinetic contribution, and the second sum is the virial or configurational contribution. We assume the system has zero average (stream) velocity, so particle velocities $\\mathbf{v}_i$ can be used directly.\n\nThe problem states that the MD code uses a convention $S^{\\alpha\\beta}(t) = -V \\sigma^{\\alpha\\beta}(t)$, where $S^{\\alpha\\beta}(t)$ is an extensive quantity. Let's substitute the expression for $\\sigma^{\\alpha\\beta}(t)$ into this convention:\n$$\nS^{\\alpha\\beta}(t) = -V \\left[ -\\frac{1}{V} \\left( \\sum_{i=1}^{N} m_i v_i^{\\alpha}(t) v_i^{\\beta}(t) + \\frac{1}{2} \\sum_{i \\neq j} r_{ij}^{\\alpha}(t) f_{ij}^{\\beta}(t) \\right) \\right]\n$$\nThis simplifies to:\n$$\nS^{\\alpha\\beta}(t) = \\sum_{i=1}^{N} m_i v_i^{\\alpha}(t) v_i^{\\beta}(t) + \\frac{1}{2} \\sum_{i \\neq j} r_{ij}^{\\alpha}(t) f_{ij}^{\\beta}(t)\n$$\nThis quantity $S^{\\alpha\\beta}(t)$ is what many MD codes compute. It is also stated that $S^{\\alpha\\beta}(t)$ is a sum of per-atom contributions, $S^{\\alpha\\beta}(t) = \\sum_{i=1}^{N} s_i^{\\alpha\\beta}(t)$. This is achieved by partitioning the pair-wise virial term among the individual atoms. A standard way to do this is to define the per-atom quantity $s_i^{\\alpha\\beta}(t)$ as:\n$$\ns_i^{\\alpha\\beta}(t) = m_i v_i^{\\alpha}(t) v_i^{\\beta}(t) + \\frac{1}{2} \\sum_{j \\neq i} r_{ij}^{\\alpha}(t) f_{ij}^{\\beta}(t)\n$$\n\nNow we address the two points required for the justification.\n\n(i) The units of $S^{\\alpha\\beta}(t)$.\nThe quantity $S^{\\alpha\\beta}(t)$ is a sum of a kinetic term and a virial term. Let's analyze the physical dimensions (units) of each.\nThe kinetic term has units of mass $\\times$ (velocity)$^{2}$:\n$$\n[\\text{Kinetic Term}] = \\mathrm{M} \\cdot \\left(\\frac{\\mathrm{L}}{\\mathrm{T}}\\right)^2 = \\frac{\\mathrm{ML}^2}{\\mathrm{T}^2}\n$$\nIn SI units, this is $\\mathrm{kg} \\cdot (\\mathrm{m}/\\mathrm{s})^2 = \\mathrm{kg} \\cdot \\mathrm{m}^2/\\mathrm{s}^2$, which are Joules ($\\mathrm{J}$), the unit of energy.\n\nThe virial term has units of distance $\\times$ force:\n$$\n[\\text{Virial Term}] = \\mathrm{L} \\cdot \\mathrm{F} = \\mathrm{L} \\cdot \\left(\\frac{\\mathrm{ML}}{\\mathrm{T}^2}\\right) = \\frac{\\mathrm{ML}^2}{\\mathrm{T}^2}\n$$\nIn SI units, this is $\\mathrm{m} \\cdot \\mathrm{N} = \\mathrm{m} \\cdot (\\mathrm{kg} \\cdot \\mathrm{m}/\\mathrm{s}^2) = \\mathrm{kg} \\cdot \\mathrm{m}^2/\\mathrm{s}^2$, which are also Joules ($\\mathrm{J}$).\n\nSince both contributions to $S^{\\alpha\\beta}(t)$ have units of energy, the total quantity $S^{\\alpha\\beta}(t)$ has units of energy. This is consistent with the problem statement that the per-atom contribution $s_i^{\\alpha\\beta}(t)$ is reported in Joules.\n\n(ii) Recovering stress from $-S^{\\alpha\\beta}(t)/V$.\nAccording to the given convention, the Cauchy stress tensor is obtained by $\\sigma^{\\alpha\\beta}(t) = -S^{\\alpha\\beta}(t)/V$. To show that this recovers a stress, we check the units.\n$$\n[\\sigma^{\\alpha\\beta}] = \\frac{[S^{\\alpha\\beta}]}{[V]} = \\frac{[\\text{Energy}]}{[\\text{Volume}]} = \\frac{\\mathrm{ML}^2/\\mathrm{T}^2}{\\mathrm{L}^3} = \\frac{\\mathrm{M}}{\\mathrm{LT}^2}\n$$\nIn SI units, this is $\\mathrm{J}/\\mathrm{m}^3 = (\\mathrm{N} \\cdot \\mathrm{m})/\\mathrm{m}^3 = \\mathrm{N}/\\mathrm{m}^2$, which are Pascals ($\\mathrm{Pa}$), the unit of pressure and stress.\nThe \"correct magnitude\" is guaranteed by the fact that the Irving–Kirkwood formula is the correct microscopic expression for the macroscopic Cauchy stress tensor, derived from the fundamental principle of momentum conservation. The quantity $S^{\\alpha\\beta}(t)$ is precisely the extensive part of the momentum flux expression, so dividing it by volume (and including the conventional negative sign) yields the stress tensor. The convention $S^{\\alpha\\beta}(t) = -V\\sigma^{\\alpha\\beta}(t)$ is therefore physically sound and commonly used in molecular simulations.\n\nPart 2: Calculation of Shear Viscosity $\\eta$\n\nThe shear viscosity $\\eta$ is a transport coefficient that can be calculated from equilibrium fluctuations of the stress tensor using the Green–Kubo formula. The formula connects $\\eta$ to the time integral of the autocorrelation function of an off-diagonal component of the stress tensor. There are several equivalent forms of this relation. A common one is:\n$$\n\\eta = \\frac{1}{V k_B T} \\int_0^{\\infty} \\langle S^{xy}(t) S^{xy}(0) \\rangle \\, dt\n$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. The angled brackets $\\langle \\dots \\rangle$ denote an ensemble average, which in an ergodic system is equal to a time average. The quantity $\\langle S^{xy}(t) S^{xy}(0) \\rangle$ is the stress autocorrelation function for the $xy$-component, which the problem denotes as $C_S(t)$.\n\nThe problem provides a single-exponential fit for this correlation function:\n$$\nC_S(t) = \\langle S^{xy}(t) S^{xy}(0) \\rangle = C_0 \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\nSubstituting this into the Green-Kubo formula, we get:\n$$\n\\eta = \\frac{1}{V k_B T} \\int_0^{\\infty} C_0 \\exp\\left(-\\frac{t}{\\tau}\\right) \\, dt\n$$\nThe integral can be evaluated analytically:\n$$\n\\int_0^{\\infty} C_0 \\exp\\left(-\\frac{t}{\\tau}\\right) \\, dt = C_0 \\left[ -\\tau \\exp\\left(-\\frac{t}{\\tau}\\right) \\right]_0^{\\infty} = C_0 \\left( -\\tau \\cdot 0 - (-\\tau \\cdot 1) \\right) = C_0 \\tau\n$$\nSubstituting this result back, we obtain the expression for $\\eta$ in terms of the given parameters:\n$$\n\\eta = \\frac{C_0 \\tau}{V k_B T}\n$$\nNow we can evaluate this expression numerically. The given parameters are:\n$C_0 = 4.80 \\times 10^{-37}\\,\\mathrm{J}^2$\n$\\tau = 2.10\\,\\mathrm{ps} = 2.10 \\times 10^{-12}\\,\\mathrm{s}$\n$T = 300\\,\\mathrm{K}$\n$L = 6.0\\,\\mathrm{nm} = 6.0 \\times 10^{-9}\\,\\mathrm{m}$\nThe volume of the simulation box is $V = L^3 = (6.0 \\times 10^{-9}\\,\\mathrm{m})^3 = 216 \\times 10^{-27}\\,\\mathrm{m}^3 = 2.16 \\times 10^{-25}\\,\\mathrm{m}^3$.\nThe Boltzmann constant is $k_B \\approx 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$.\n\nFirst, let's calculate the numerator, $C_0 \\tau$:\n$$\nC_0 \\tau = (4.80 \\times 10^{-37}\\,\\mathrm{J}^2) \\times (2.10 \\times 10^{-12}\\,\\mathrm{s}) = 1.008 \\times 10^{-48}\\,\\mathrm{J}^2 \\cdot \\mathrm{s}\n$$\nNext, we calculate the denominator, $V k_B T$:\n$$\nk_B T = (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (300\\,\\mathrm{K}) \\approx 4.141947 \\times 10^{-21}\\,\\mathrm{J}\n$$\n$$\nV k_B T = (2.16 \\times 10^{-25}\\,\\mathrm{m}^3) \\times (4.141947 \\times 10^{-21}\\,\\mathrm{J}) \\approx 8.9466055 \\times 10^{-46}\\,\\mathrm{J} \\cdot \\mathrm{m}^3\n$$\nNow, we compute the viscosity $\\eta$:\n$$\n\\eta = \\frac{1.008 \\times 10^{-48}\\,\\mathrm{J}^2 \\cdot \\mathrm{s}}{8.9466055 \\times 10^{-46}\\,\\mathrm{J} \\cdot \\mathrm{m}^3} \\approx 1.12669 \\times 10^{-3}\\,\\frac{\\mathrm{J} \\cdot \\mathrm{s}}{\\mathrm{m}^3}\n$$\nThe units are $\\mathrm{J} \\cdot \\mathrm{s} / \\mathrm{m}^3 = (\\mathrm{N} \\cdot \\mathrm{m} \\cdot \\mathrm{s}) / \\mathrm{m}^3 = \\mathrm{N} \\cdot \\mathrm{s} / \\mathrm{m}^2 = \\mathrm{Pa} \\cdot \\mathrm{s}$, which are the correct SI units for dynamic viscosity.\n\nThe problem asks for the result in millipascal-seconds ($\\mathrm{mPa}·\\mathrm{s}$). The conversion is $1\\,\\mathrm{Pa} \\cdot \\mathrm{s} = 1000\\,\\mathrm{mPa}·\\mathrm{s}$.\n$$\n\\eta \\approx (1.12669 \\times 10^{-3}\\,\\mathrm{Pa} \\cdot \\mathrm{s}) \\times \\left(\\frac{1000\\,\\mathrm{mPa}·\\mathrm{s}}{1\\,\\mathrm{Pa} \\cdot \\mathrm{s}}\\right) \\approx 1.12669\\,\\mathrm{mPa}·\\mathrm{s}\n$$\nFinally, we round the result to three significant figures:\n$$\n\\eta \\approx 1.13\\,\\mathrm{mPa}·\\mathrm{s}\n$$\nThis value is physically reasonable, for example, it is close to the viscosity of water at room temperature (approximately $0.89\\,\\mathrm{mPa}·\\mathrm{s}$).",
            "answer": "$$\n\\boxed{1.13}\n$$"
        },
        {
            "introduction": "A calculated result from a simulation is incomplete without a measure of its statistical reliability. This practice guides you through the complete workflow of processing a realistic stress time series, including the calculation of the autocorrelation function and its integral, the integrated autocorrelation time $\\tau_{\\mathrm{int}}$ . Critically, this exercise introduces the block averaging method, a powerful technique to estimate the statistical error in transport coefficients derived from time-correlated data, an indispensable skill for any serious simulation study.",
            "id": "3445615",
            "problem": "You will implement a complete program to analyze equilibrium molecular dynamics time series of the off-diagonal microscopic stress component $P_{xy}(t)$ sampled at uniform time step $\\Delta t$ and estimate key quantities relevant to computing shear viscosity from equilibrium correlations. Your program must derive and compute the integrated autocorrelation time $\\tau_{\\mathrm{int}}$ of the normalized stress autocorrelation function, and quantify the statistical uncertainty in the viscosity estimator using block averaging. The program must be self-contained and produce a single line of output as specified.\n\nUse the following fundamental base: Newtonian dynamics for particle motion, definitions of microscopic stress tensor components, ensemble averages for equilibrium correlation functions, and the equilibrium linear response paradigm connecting transport coefficients to time integrals of equilibrium autocorrelation functions. You must not assume or use any shortcut formulas that jump directly to the target without principled derivation.\n\nDefinitions and tasks to implement:\n\n- Let $P_{xy}(t_i)$ denote a sampled time series of the microscopic off-diagonal stress at times $t_i = i \\Delta t$ with $i \\in \\{0,1,\\dots,N-1\\}$ and $\\Delta t > 0$. The sample mean $\\bar{P}$ should be subtracted to form a mean-zero series $X_i = P_{xy}(t_i) - \\bar{P}$.\n- Define the unbiased time-origin-averaged discrete autocorrelation function for lag index $k$ as\n$$\nC(k) = \\frac{1}{N-k}\\sum_{n=0}^{N-k-1} X_n X_{n+k},\n$$\nwith $k \\in \\{0,1,\\dots,N-1\\}$. Define the normalized autocorrelation function as\n$$\n\\phi(k) = \\frac{C(k)}{C(0)}.\n$$\n- Define the integrated autocorrelation time (in seconds) as the discrete-time integral with a physically motivated cutoff:\n$$\n\\tau_{\\mathrm{int}} = \\sum_{k=0}^{K_{\\mathrm{cut}}} \\phi(k) \\,\\Delta t,\n$$\nwhere $K_{\\mathrm{cut}}$ is chosen using the following window rule: find the smallest lag $j \\ge 1$ such that $\\phi(j) \\le 0$; if such $j$ exists, set $K_{\\mathrm{cut}} = j-1$. If there is no sign change up to the maximum available lag, set $K_{\\mathrm{cut}}$ to the largest lag not exceeding a provided upper bound $t_{\\max}$, i.e., $K_{\\mathrm{cut}} = \\min\\{N-1, \\lfloor t_{\\max}/\\Delta t \\rfloor\\}$.\n- The viscosity estimator $\\hat{\\eta}$ arises from the time integral of the unnormalized autocorrelation function, scaled by the correct thermodynamic prefactor implied by equilibrium linear response. You must compute $\\hat{\\eta}$ in Pascal-seconds using the same cutoff $K_{\\mathrm{cut}}$ as above. Use the provided physical parameters: system volume $V$ in $\\mathrm{m^3}$, absolute temperature $T$ in $\\mathrm{K}$, and the Boltzmann constant $k_{\\mathrm{B}}$ in $\\mathrm{J/K}$. All outputs involving viscosity must be expressed in $\\mathrm{Pa}·\\mathrm{s}$.\n- Quantify the statistical uncertainty of $\\hat{\\eta}$ using block averaging: partition the time series into $B$ non-overlapping contiguous blocks of equal length $L_{\\mathrm{block}}$ (discard any remainder). For each block $b$, compute a block-level viscosity estimate $\\hat{\\eta}_b$ using the same procedure as above. Compute the sample standard deviation $s_{\\hat{\\eta}}$ across the $B$ block estimates with denominator $B-1$, and estimate the standard error of $\\hat{\\eta}$ as\n$$\n\\mathrm{SE}(\\hat{\\eta}) = \\frac{s_{\\hat{\\eta}}}{\\sqrt{B}}.\n$$\n- Estimate the effective number of statistically independent samples based on $\\tau_{\\mathrm{int}}$:\n$$\nN_{\\mathrm{eff}} = \\frac{N\\,\\Delta t}{2 \\,\\tau_{\\mathrm{int}}}.\n$$\n\nYour program must implement the unbiased autocorrelation efficiently and reproducibly for all lags using a numerically stable method. The numerical integration should be performed exactly as specified above using the discrete sum with the cutoff rule, and the block averaging uncertainty must follow the definitions given here.\n\nPhysical units and output requirements:\n\n- All time quantities must be in seconds.\n- Stress $P_{xy}$ must be in Pascals.\n- Volume $V$ must be in $\\mathrm{m^3}$.\n- Temperature $T$ must be in Kelvin.\n- The Boltzmann constant $k_{\\mathrm{B}}$ is $1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$.\n- Viscosity must be reported in $\\mathrm{Pa}·\\mathrm{s}$.\n- Your program must round each reported float to six significant digits.\n\nTest suite:\n\nImplement your program for the following three deterministic synthetic test cases. In each case, the time series $P_{xy}(t_i)$ is defined as a sum of physically plausible, mean-zero components that mimic equilibrium stress fluctuations: an exponentially decaying term, an oscillatory decaying term, and a bounded deterministic chaotic term from the logistic map. Let the logistic sequence $\\{s_n\\}$ be defined by $s_{n+1} = r s_n (1 - s_n)$ with initial $s_0$ and parameter $r$, and let $s_n'$ denote its mean-centered version $s_n' = s_n - \\frac{1}{N}\\sum_{m=0}^{N-1} s_m$. For each case, define\n$$\nP_{xy}(t_i) = A \\,\\mathrm{e}^{-\\alpha t_i} + B \\cos(\\omega t_i)\\,\\mathrm{e}^{-\\beta t_i} + C \\, s_i',\n$$\nwith constants $A$, $B$, $C$ in Pascals, $\\alpha$, $\\beta$ in $\\mathrm{s^{-1}}$, and $\\omega$ in $\\mathrm{rad/s}$.\n\n- Case $1$ (general decay with weak oscillations):\n    - $N = 4096$, $\\Delta t = 5.0 \\times 10^{-15}$ $\\mathrm{s}$, $V = 1.0 \\times 10^{-27}$ $\\mathrm{m^3}$, $T = 300$ $\\mathrm{K}$, $t_{\\max} = 5.0 \\times 10^{-12}$ $\\mathrm{s}$, $L_{\\mathrm{block}} = 512$.\n    - Parameters: $A = 5.0 \\times 10^{6}$ $\\mathrm{Pa}$, $\\alpha = 7.0 \\times 10^{11}$ $\\mathrm{s^{-1}}$, $B = 2.0 \\times 10^{6}$ $\\mathrm{Pa}$, $\\beta = 2.0 \\times 10^{12}$ $\\mathrm{s^{-1}}$, $\\omega = 2.0 \\times 10^{12}$ $\\mathrm{rad/s}$, $C = 1.0 \\times 10^{6}$ $\\mathrm{Pa}$.\n    - Logistic map: $r = 3.9$, $s_0 = 0.123$.\n\n- Case $2$ (long-tailed decay with chirped oscillations):\n    - $N = 6000$, $\\Delta t = 2.0 \\times 10^{-15}$ $\\mathrm{s}$, $V = 5.0 \\times 10^{-28}$ $\\mathrm{m^3}$, $T = 350$ $\\mathrm{K}$, $t_{\\max} = 8.0 \\times 10^{-12}$ $\\mathrm{s}$, $L_{\\mathrm{block}} = 500$.\n    - Parameters: $A = 4.0 \\times 10^{6}$ $\\mathrm{Pa}$, replace $\\mathrm{e}^{-\\alpha t}$ with stretched decay $\\mathrm{e}^{-(\\gamma t)^{1/2}}$ with $\\gamma = 5.0 \\times 10^{11}$ $\\mathrm{s^{-1}}$, $B = 5.0 \\times 10^{5}$ $\\mathrm{Pa}$, $\\beta = 1.0 \\times 10^{12}$ $\\mathrm{s^{-1}}$, $\\omega_0 = 5.0 \\times 10^{12}$ $\\mathrm{rad/s}$, $\\alpha_2 = 1.0 \\times 10^{12}$ $\\mathrm{s^{-2}}$, and use $\\cos(\\omega_0 t + \\tfrac{1}{2}\\alpha_2 t^2)$ for the oscillatory term, $C = 5.0 \\times 10^{5}$ $\\mathrm{Pa}$.\n    - Logistic map: $r = 3.9$, $s_0 = 0.231$.\n\n- Case $3$ (strong oscillations crossing zero):\n    - $N = 3000$, $\\Delta t = 1.0 \\times 10^{-15}$ $\\mathrm{s}$, $V = 2.0 \\times 10^{-27}$ $\\mathrm{m^3}$, $T = 250$ $\\mathrm{K}$, $t_{\\max} = 4.0 \\times 10^{-12}$ $\\mathrm{s}$, $L_{\\mathrm{block}} = 300$.\n    - Parameters: $A = 1.0 \\times 10^{6}$ $\\mathrm{Pa}$, $\\alpha = 4.0 \\times 10^{12}$ $\\mathrm{s^{-1}}$, $B = 6.0 \\times 10^{6}$ $\\mathrm{Pa}$, $\\beta = 1.0 \\times 10^{12}$ $\\mathrm{s^{-1}}$, $\\omega = 8.0 \\times 10^{12}$ $\\mathrm{rad/s}$, $C = 3.0 \\times 10^{5}$ $\\mathrm{Pa}$.\n    - Logistic map: $r = 3.9$, $s_0 = 0.345$.\n\nFor Case $2$, interpret the first term as $A \\,\\mathrm{e}^{-(\\gamma t)^{1/2}}$ instead of $A \\,\\mathrm{e}^{-\\alpha t}$, and interpret the oscillatory term as $B \\cos\\!\\big(\\omega_0 t + \\tfrac{1}{2}\\alpha_2 t^2\\big)\\,\\mathrm{e}^{-\\beta t}$.\n\nFinal output format:\n\n- For each test case, compute and report the triple $\\big[\\tau_{\\mathrm{int}}, \\mathrm{SE}(\\hat{\\eta}), N_{\\mathrm{eff}}\\big]$, with $\\tau_{\\mathrm{int}}$ in seconds, $\\mathrm{SE}(\\hat{\\eta})$ in $\\mathrm{Pa}·\\mathrm{s}$, and $N_{\\mathrm{eff}}$ as a unitless float.\n- Your program should produce a single line of output containing the results for the three test cases as a comma-separated list of lists enclosed in square brackets, for example: \"[[tau1,se1,neff1],[tau2,se2,neff2],[tau3,se3,neff3]]\".\n- Each float must be rounded to six significant digits.",
            "solution": "The problem has been validated and is deemed sound. It is scientifically grounded in the principles of equilibrium statistical mechanics, specifically the Green-Kubo formalism for transport coefficients. The problem is well-posed, providing all necessary definitions, data, and a clear, deterministic procedure for calculation, ensuring that a unique solution exists. The language is objective and the parameters are physically plausible for a molecular dynamics simulation context. No contradictions, ambiguities, or unsound premises were found.\n\nThe solution presented herein systematically implements the required calculations. The core of the problem is to estimate the shear viscosity, $\\eta$, from a time series of the microscopic stress tensor component $P_{xy}(t)$. This is achieved by leveraging the Green-Kubo relation, which connects a macroscopic transport coefficient to the time integral of an equilibrium time correlation function.\n\nThe fundamental relation for shear viscosity is:\n$$\n\\eta = \\frac{V}{k_{\\mathrm{B}}T} \\int_0^\\infty \\langle P_{xy}(0) P_{xy}(t) \\rangle \\, dt\n$$\nwhere $V$ is the system volume, $T$ is the temperature, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $\\langle \\cdot \\rangle$ denotes an ensemble average. In a computational setting, we use a discrete time series $P_{xy}(t_i)$ of length $N$ with time step $\\Delta t$, and the ensemble average is replaced by a time average.\n\nThe algorithmic procedure is as follows:\n\nFirst, the input time series $P_{xy}(t_i)$ is made mean-zero by subtracting the sample mean $\\bar{P}$. This yields the fluctuation series $X_i = P_{xy}(t_i) - \\bar{P}$. For an equilibrium system, the average of an off-diagonal stress component is zero, so $\\bar{P}$ is expected to be close to zero, and this step corrects for any finite-sample deviation.\n\nSecond, the unbiased, time-origin-averaged discrete autocorrelation function (ACF) is computed. For a time lag of $k$ steps, the ACF is given by:\n$$\nC(k) = \\frac{1}{N-k}\\sum_{n=0}^{N-k-1} X_n X_{n+k}\n$$\nThis function measures the correlation of the stress fluctuations with themselves at a later time. The factor $\\frac{1}{N-k}$ provides an unbiased estimate for each lag $k$. This calculation is performed for all lags $k \\in \\{0, 1, \\dots, N-1\\}$. For a more intuitive understanding, the normalized ACF, $\\phi(k) = C(k)/C(0)$, is also computed. By definition, $\\phi(0)=1$.\n\nThird, the integral of the ACF is approximated by a discrete sum. A crucial step is determining the upper limit of this summation, $K_{\\mathrm{cut}}$. Noise in the tail of the ACF at long times can degrade the quality of the integral estimate. A common heuristic, as specified in the problem, is to terminate the integration when the ACF first loses its positive correlation. The cutoff $K_{\\mathrm{cut}}$ is defined as $j-1$, where $j$ is the smallest lag index ($j \\ge 1$) for which $\\phi(j) \\le 0$. If the ACF remains positive, a maximum integration time $t_{\\max}$ is used to define the cutoff, $K_{\\mathrm{cut}} = \\min\\{N-1, \\lfloor t_{\\max}/\\Delta t \\rfloor\\}$.\n\nFourth, using this cutoff, two key quantities are calculated. The integrated autocorrelation time, $\\tau_{\\mathrm{int}}$, is the integral of the *normalized* ACF:\n$$\n\\tau_{\\mathrm{int}} = \\sum_{k=0}^{K_{\\mathrm{cut}}} \\phi(k) \\,\\Delta t\n$$\n$\\tau_{\\mathrm{int}}$ represents the characteristic time scale of the stress fluctuations. The viscosity estimator, $\\hat{\\eta}$, is computed from the integral of the *unnormalized* ACF, scaled by the thermodynamic prefactor from the Green-Kubo relation:\n$$\n\\hat{\\eta} = \\frac{V}{k_{\\mathrm{B}} T} \\sum_{k=0}^{K_{\\mathrm{cut}}} C(k) \\,\\Delta t\n$$\nThis estimator must be reported in units of Pascal-seconds ($\\mathrm{Pa}·\\mathrm{s}$).\n\nFifth, the statistical uncertainty in $\\hat{\\eta}$ is estimated using the block averaging method. The full time series of length $N$ is partitioned into $B$ non-overlapping blocks, each of length $L_{\\mathrm{block}}$. For each block, a block-specific viscosity estimate, $\\hat{\\eta}_b$, is computed using the exact same procedure as for the full series (i.e., mean-centering within the block, computing the block's ACF, and integrating). The standard error of the mean of these block estimates is then calculated as:\n$$\n\\mathrm{SE}(\\hat{\\eta}) = \\frac{s_{\\hat{\\eta}}}{\\sqrt{B}}\n$$\nwhere $s_{\\hat{\\eta}}$ is the sample standard deviation of the set $\\{\\hat{\\eta}_1, \\hat{\\eta}_2, \\dots, \\hat{\\eta}_B\\}$, computed with the denominator $B-1$ to be an unbiased estimator of the variance.\n\nFinally, the effective number of statistically independent samples in the original time series is estimated. This quantity, $N_{\\mathrm{eff}}$, accounts for the correlation time of the data and is given by:\n$$\nN_{\\mathrm{eff}} = \\frac{T_{\\mathrm{total}}}{2 \\,\\tau_{\\mathrm{int}}} = \\frac{N\\,\\Delta t}{2 \\,\\tau_{\\mathrm{int}}}\n$$\nThe factor of 2 accounts for the fact that the variance of the mean of a correlated series is approximately $2\\tau_{\\mathrm{int}} / T_{\\mathrm{total}}$ times the variance of an uncorrelated series of the same length.\n\nThe provided program implements this full procedure. It first generates the synthetic time series for each test case according to the specified functional forms, which include exponential and oscillatory decays, as well as a deterministic chaotic component from the logistic map. A central helper function is designed to compute $\\tau_{\\mathrm{int}}$ and $\\hat{\\eta}$ for any given time series, which is then applied to the full dataset and to each individual block. The final results, $[\\tau_{\\mathrm{int}}, \\mathrm{SE}(\\hat{\\eta}), N_{\\mathrm{eff}}]$, for each test case are collected, rounded to six significant digits, and formatted into the specified single-line output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It generates synthetic time series, computes viscosity-related quantities,\n    and formats the output as specified.\n    \"\"\"\n    \n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    test_cases = [\n        {\n            \"name\": \"Case 1\",\n            \"N\": 4096, \"delta_t\": 5.0e-15, \"V\": 1.0e-27, \"T\": 300, \n            \"t_max\": 5.0e-12, \"L_block\": 512,\n            \"func_type\": 1,\n            \"params\": {\n                \"A\": 5.0e6, \"alpha\": 7.0e11, \"B\": 2.0e6, \"beta\": 2.0e12,\n                \"omega\": 2.0e12, \"C\": 1.0e6, \"r\": 3.9, \"s0\": 0.123\n            }\n        },\n        {\n            \"name\": \"Case 2\",\n            \"N\": 6000, \"delta_t\": 2.0e-15, \"V\": 5.0e-28, \"T\": 350,\n            \"t_max\": 8.0e-12, \"L_block\": 500,\n            \"func_type\": 2,\n            \"params\": {\n                \"A\": 4.0e6, \"gamma\": 5.0e11, \"B\": 5.0e5, \"beta\": 1.0e12,\n                \"omega0\": 5.0e12, \"alpha2\": 1.0e12, \"C\": 5.0e5, \"r\": 3.9, \"s0\": 0.231\n            }\n        },\n        {\n            \"name\": \"Case 3\",\n            \"N\": 3000, \"delta_t\": 1.0e-15, \"V\": 2.0e-27, \"T\": 250,\n            \"t_max\": 4.0e-12, \"L_block\": 300,\n            \"func_type\": 1, \n            \"params\": {\n                \"A\": 1.0e6, \"alpha\": 4.0e12, \"B\": 6.0e6, \"beta\": 1.0e12,\n                \"omega\": 8.0e12, \"C\": 3.0e5, \"r\": 3.9, \"s0\": 0.345\n            }\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        N, delta_t = case[\"N\"], case[\"delta_t\"]\n        params = case[\"params\"]\n        \n        t = np.arange(N) * delta_t\n\n        # Generate logistic map sequence\n        s = np.zeros(N)\n        s[0] = params[\"s0\"]\n        for n in range(N - 1):\n            s[n+1] = params[\"r\"] * s[n] * (1 - s[n])\n        s_prime = s - np.mean(s)\n\n        # Generate P_xy time series\n        if case[\"func_type\"] == 1:\n            P_xy = (params[\"A\"] * np.exp(-params[\"alpha\"] * t) +\n                    params[\"B\"] * np.cos(params[\"omega\"] * t) * np.exp(-params[\"beta\"] * t) +\n                    params[\"C\"] * s_prime)\n        else: # Case 2\n            P_xy = (params[\"A\"] * np.exp(-(params[\"gamma\"] * t)**0.5) +\n                    params[\"B\"] * np.cos(params[\"omega0\"] * t + 0.5 * params[\"alpha2\"] * t**2) * np.exp(-params[\"beta\"] * t) +\n                    params[\"C\"] * s_prime)\n\n        # Full series analysis for tau_int and N_eff\n        tau_int_full, _ = _calculate_viscosity_bundle(\n            P_xy, delta_t, case[\"V\"], case[\"T\"], case[\"t_max\"], k_B\n        )\n        \n        if tau_int_full > 0:\n            N_eff = (N * delta_t) / (2 * tau_int_full)\n        else:\n            N_eff = float('inf')\n\n        # Block averaging for uncertainty\n        L_block = case[\"L_block\"]\n        num_blocks = N // L_block\n        block_viscosities = []\n        \n        for i in range(num_blocks):\n            start_idx = i * L_block\n            end_idx = start_idx + L_block\n            block_Pxy = P_xy[start_idx:end_idx]\n            \n            _, eta_b = _calculate_viscosity_bundle(\n                block_Pxy, delta_t, case[\"V\"], case[\"T\"], case[\"t_max\"], k_B\n            )\n            block_viscosities.append(eta_b)\n        \n        if num_blocks > 1:\n            s_eta = np.std(block_viscosities, ddof=1)\n            SE_eta = s_eta / np.sqrt(num_blocks)\n        else:\n            SE_eta = float('nan')\n\n        all_results.append([tau_int_full, SE_eta, N_eff])\n\n    # Format output\n    formatted_results = [\n        [format(val, '.6g') for val in res]\n        for res in all_results\n    ]\n    case_strings = [f\"[{','.join(sublist)}]\" for sublist in formatted_results]\n    final_string = f\"[{','.join(case_strings)}]\"\n    print(final_string)\n\ndef _calculate_viscosity_bundle(series_Pxy, delta_t, V, T, t_max, k_B):\n    \"\"\"\n    Calculates tau_int and eta_hat for a given time series.\n    \n    Args:\n        series_Pxy (np.array): The time series data for P_xy.\n        delta_t (float): Time step in seconds.\n        V (float): System volume in m^3.\n        T (float): Temperature in Kelvin.\n        t_max (float): Max integration time for cutoff rule.\n        k_B (float): Boltzmann constant.\n        \n    Returns:\n        (float, float): A tuple containing (tau_int, eta_hat).\n    \"\"\"\n    M = len(series_Pxy)\n    if M == 0:\n        return 0.0, 0.0\n        \n    X = series_Pxy - np.mean(series_Pxy)\n\n    # Unbiased autocorrelation function C(k)\n    C = np.zeros(M)\n    for k in range(M):\n        # The formula in the problem is C(k) = 1/(N-k) * sum(X_n * X_{n+k})\n        # This is well-defined for k=0...N-1. At k=N-1, N-k=1.\n        C[k] = np.dot(X[0:M-k], X[k:M]) / (M-k)\n\n    if C[0] == 0:\n        return 0.0, 0.0\n    \n    phi = C / C[0]\n\n    # Determine integration cutoff K_cut\n    # Find smallest j >= 1 where phi(j) = 0\n    # Search in phi starting from index 1.\n    neg_indices = np.where(phi[1:] = 0)[0] \n    if len(neg_indices) > 0:\n        j = neg_indices[0] + 1\n        K_cut = j - 1\n    else:\n        K_cut = int(min(M - 1, np.floor(t_max / delta_t)))\n\n    # Perform discrete integration up to K_cut\n    k_range = np.arange(K_cut + 1)\n    \n    tau_int = np.sum(phi[k_range]) * delta_t\n    \n    eta_hat = (V / (k_B * T)) * np.sum(C[k_range]) * delta_t\n    \n    return tau_int, eta_hat\n\nsolve()\n```"
        }
    ]
}