{
    "hands_on_practices": [
        {
            "introduction": "The Green-Kubo relations provide a profound link between microscopic fluctuations and macroscopic transport phenomena. This exercise solidifies this connection by starting with a simple, analytical model for the velocity autocorrelation function (VACF). By deriving the self-diffusion coefficient $D$ from this model VACF, you will build a direct bridge between the microscopic 'memory' of a particle's motion and its long-range diffusive behavior, illustrating the equivalence of the Green-Kubo and Einstein formulations of diffusion .",
            "id": "3414705",
            "problem": "Consider a single tagged particle of mass $m$ moving in a homogeneous, isotropic, three-dimensional equilibrium fluid at temperature $T$. Let its velocity be $\\mathbf{v}(t)$ and its position be $\\mathbf{r}(t)$. Assume stationarity and time-translational invariance of equilibrium correlation functions. The velocity autocorrelation function (VACF) is defined as $C_{vv}(t) \\equiv \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle$. Suppose that, for $t \\ge 0$, the VACF is known analytically to be\n$$\nC_{vv}(t) = v_0^2 \\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n$$\nwhere $v_0^2 \\equiv \\langle |\\mathbf{v}(0)|^2 \\rangle$ and $\\tau  0$ is a characteristic correlation time. You may assume that $v_0$ is finite and that all required integrals converge.\n\nStarting only from the fundamental kinematic relation $\\dot{\\mathbf{r}}(t) = \\mathbf{v}(t)$, the definition of the mean-squared displacement $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\equiv \\langle |\\mathbf{r}(t)-\\mathbf{r}(0)|^2 \\rangle$, and the Einstein definition of the self-diffusion coefficient,\n$$\nD \\equiv \\lim_{t \\to \\infty} \\frac{\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle}{6 t},\n$$\nderive a closed-form expression for $D$ in terms of $v_0$ and $\\tau$ for the given $C_{vv}(t)$. Your derivation should explicitly express the mean-squared displacement as a time integral over the VACF before taking the long-time limit.\n\nThen, using your result for $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle$, extract the leading time dependence of $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle$ for $t \\ll \\tau$ and for $t \\gg \\tau$, and briefly comment on how the exponential form of $C_{vv}(t)$ encodes the crossover between short-time ballistic motion and long-time diffusive motion.\n\nAnswer specification:\n- Provide the final result for $D$ as a single closed-form analytic expression in terms of $v_0$ and $\\tau$.\n- No numerical values or rounding are required.\n- Express $D$ in the unit $\\mathrm{m^2\\,s^{-1}}$.",
            "solution": "The problem asks for the derivation of the self-diffusion coefficient $D$ for a tagged particle in a fluid, given a specific analytical form for the velocity autocorrelation function (VACF). The derivation must start from the kinematic relation and the Einstein definition of $D$.\n\nFirst, we express the mean-squared displacement (MSD), $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle$, in terms of the VACF, $C_{vv}(t)$. The displacement of the particle at time $t$ relative to its position at time $t=0$ is given by the integral of its velocity:\n$$\n\\Delta \\mathbf{r}(t) = \\mathbf{r}(t) - \\mathbf{r}(0) = \\int_0^t \\mathbf{v}(t') dt'\n$$\nThe MSD is defined as $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\langle (\\mathbf{r}(t) - \\mathbf{r}(0)) \\cdot (\\mathbf{r}(t) - \\mathbf{r}(0)) \\rangle$. Substituting the integral expression for the displacement, we get:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\left\\langle \\left( \\int_0^t \\mathbf{v}(t') dt' \\right) \\cdot \\left( \\int_0^t \\mathbf{v}(t'') dt'' \\right) \\right\\rangle\n$$\nWe can rewrite the dot product of integrals as a double integral of a dot product:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\left\\langle \\int_0^t dt' \\int_0^t dt'' \\; (\\mathbf{v}(t') \\cdot \\mathbf{v}(t'')) \\right\\rangle\n$$\nSince the expectation value operator $\\langle \\dots \\rangle$ is linear and commutes with integration, we can bring it inside the integrals:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\int_0^t dt' \\int_0^t dt'' \\; \\langle \\mathbf{v}(t') \\cdot \\mathbf{v}(t'') \\rangle\n$$\nThe term inside the integral is a time-correlation function. For a stationary process, this function depends only on the time difference, i.e., $\\langle \\mathbf{v}(t') \\cdot \\mathbf{v}(t'') \\rangle = \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t''-t') \\rangle = C_{vv}(t''-t')$. The VACF is an even function of its argument, $C_{vv}(\\Delta t) = C_{vv}(-\\Delta t)$, because $\\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle = \\langle \\mathbf{v}(-t) \\cdot \\mathbf{v}(0) \\rangle$, which by stationarity is $\\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle$. Thus, we can write $C_{vv}(t''-t') = C_{vv}(|t''-t'|)$. The integral becomes:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\int_0^t dt' \\int_0^t dt'' \\; C_{vv}(|t' - t''|)\n$$\nTo evaluate this double integral over the square domain $[0, t] \\times [0, t]$ in the $(t', t'')$-plane, we can exploit the symmetry of the integrand. The integral is twice the value of the integral over the triangular region where $t' \\ge t''$:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 \\int_0^t dt' \\int_0^{t'} dt'' \\; C_{vv}(t' - t'')\n$$\nLet's change the order of integration. The integration domain is defined by $0 \\le t'' \\le t'$ and $0 \\le t' \\le t$. This is equivalent to the domain defined by $0 \\le t'' \\le t$ and $t'' \\le t' \\le t$. By swapping the integration order and renaming the integration variables ($t' \\leftrightarrow s, t'' \\leftrightarrow s'$ to avoid confusion, then renaming back), we get:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 \\int_0^t ds \\int_s^t dt' \\; C_{vv}(s)\n$$\nThe inner integral over $t'$ is straightforward: $\\int_s^t dt' = t-s$. Thus, we arrive at the desired expression for the MSD in terms of the VACF:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 \\int_0^t (t-s) C_{vv}(s) ds\n$$\nNow, we substitute the given form of the VACF, $C_{vv}(t) = v_0^2 \\exp(-t/\\tau)$ for $t \\ge 0$:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 \\int_0^t (t-s) v_0^2 \\exp\\left(-\\frac{s}{\\tau}\\right) ds = 2 v_0^2 \\left[ t \\int_0^t \\exp\\left(-\\frac{s}{\\tau}\\right) ds - \\int_0^t s \\exp\\left(-\\frac{s}{\\tau}\\right) ds \\right]\n$$\nWe evaluate the two integrals separately. The first integral is:\n$$\n\\int_0^t \\exp\\left(-\\frac{s}{\\tau}\\right) ds = \\left[ -\\tau \\exp\\left(-\\frac{s}{\\tau}\\right) \\right]_0^t = -\\tau \\left( \\exp\\left(-\\frac{t}{\\tau}\\right) - 1 \\right) = \\tau \\left( 1 - \\exp\\left(-\\frac{t}{\\tau}\\right) \\right)\n$$\nThe second integral is evaluated using integration by parts, with $u=s$ and $dv = \\exp(-s/\\tau) ds$:\n\\begin{align*}\n\\int_0^t s \\exp\\left(-\\frac{s}{\\tau}\\right) ds = \\left[ s \\left(-\\tau \\exp\\left(-\\frac{s}{\\tau}\\right)\\right) \\right]_0^t - \\int_0^t \\left(-\\tau \\exp\\left(-\\frac{s}{\\tau}\\right)\\right) ds \\\\\n= -t\\tau \\exp\\left(-\\frac{t}{\\tau}\\right) + \\tau \\int_0^t \\exp\\left(-\\frac{s}{\\tau}\\right) ds \\\\\n= -t\\tau \\exp\\left(-\\frac{t}{\\tau}\\right) + \\tau^2 \\left( 1 - \\exp\\left(-\\frac{t}{\\tau}\\right) \\right)\n\\end{align*}\nSubstituting these results back into the expression for the MSD:\n\\begin{align*}\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 v_0^2 \\left[ t \\left( \\tau \\left( 1 - \\exp\\left(-\\frac{t}{\\tau}\\right) \\right) \\right) - \\left( -t\\tau \\exp\\left(-\\frac{t}{\\tau}\\right) + \\tau^2 \\left( 1 - \\exp\\left(-\\frac{t}{\\tau}\\right) \\right) \\right) \\right] \\\\\n= 2 v_0^2 \\left[ t\\tau - t\\tau\\exp\\left(-\\frac{t}{\\tau}\\right) + t\\tau\\exp\\left(-\\frac{t}{\\tau}\\right) - \\tau^2 + \\tau^2 \\exp\\left(-\\frac{t}{\\tau}\\right) \\right] \\\\\n= 2 v_0^2 \\left[ t\\tau - \\tau^2 + \\tau^2 \\exp\\left(-\\frac{t}{\\tau}\\right) \\right] \\\\\n= 2 v_0^2 \\tau^2 \\left( \\frac{t}{\\tau} - 1 + \\exp\\left(-\\frac{t}{\\tau}\\right) \\right)\n\\end{align*}\nThis is the closed-form expression for the mean-squared displacement. Now, we use the Einstein definition of the diffusion coefficient:\n$$\nD \\equiv \\lim_{t \\to \\infty} \\frac{\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle}{6t}\n$$\nSubstituting our expression for the MSD:\n$$\nD = \\lim_{t \\to \\infty} \\frac{2 v_0^2 \\tau^2 \\left( \\frac{t}{\\tau} - 1 + \\exp\\left(-\\frac{t}{\\tau}\\right) \\right)}{6t}\n$$\n$$\nD = \\frac{v_0^2 \\tau^2}{3} \\lim_{t \\to \\infty} \\left( \\frac{1}{t} \\left( \\frac{t}{\\tau} - 1 + \\exp\\left(-\\frac{t}{\\tau}\\right) \\right) \\right) = \\frac{v_0^2 \\tau^2}{3} \\lim_{t \\to \\infty} \\left( \\frac{1}{\\tau} - \\frac{1}{t} + \\frac{1}{t}\\exp\\left(-\\frac{t}{\\tau}\\right) \\right)\n$$\nAs $t \\to \\infty$, the terms $1/t$ and $(1/t)\\exp(-t/\\tau)$ both go to $0$. We are left with:\n$$\nD = \\frac{v_0^2 \\tau^2}{3} \\left( \\frac{1}{\\tau} \\right) = \\frac{v_0^2 \\tau}{3}\n$$\nThis is the closed-form expression for the diffusion coefficient. Note that this is consistent with the Green-Kubo relation $D = \\frac{1}{3}\\int_0^\\infty C_{vv}(t) dt = \\frac{1}{3}\\int_0^\\infty v_0^2 \\exp(-t/\\tau) dt = \\frac{v_0^2\\tau}{3}$.\n\nNext, we analyze the limiting behaviors of the MSD.\nFor short times, $t \\ll \\tau$, we can Taylor expand the exponential term for small $x = t/\\tau$: $\\exp(-x) \\approx 1 - x + x^2/2 - \\dots$\n\\begin{align*}\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 v_0^2 \\tau^2 \\left( \\frac{t}{\\tau} - 1 + \\exp\\left(-\\frac{t}{\\tau}\\right) \\right) \\\\\n\\approx 2 v_0^2 \\tau^2 \\left( \\frac{t}{\\tau} - 1 + \\left(1 - \\frac{t}{\\tau} + \\frac{1}{2}\\left(\\frac{t}{\\tau}\\right)^2\\right) \\right) \\\\\n= 2 v_0^2 \\tau^2 \\left( \\frac{1}{2} \\frac{t^2}{\\tau^2} \\right) = v_0^2 t^2\n\\end{align*}\nThe leading time dependence for $t \\ll \\tau$ is $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\propto t^2$. This quadratic dependence is characteristic of ballistic motion, where displacement is proportional to time.\n\nFor long times, $t \\gg \\tau$, the term $\\exp(-t/\\tau)$ becomes negligible.\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\approx 2 v_0^2 \\tau^2 \\left( \\frac{t}{\\tau} - 1 \\right) = 2 v_0^2 \\tau t - 2 v_0^2 \\tau^2\n$$\nThe leading time dependence for $t \\gg \\tau$ is $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\propto t$. This linear dependence is characteristic of diffusive (or random walk) motion. The coefficient of the linear term is $2v_0^2\\tau$, which is equal to $6D$.\n\nThe exponential form of the VACF, $C_{vv}(t) = v_0^2 \\exp(-t/\\tau)$, provides a simple yet powerful model for the crossover between these two regimes. The parameter $\\tau$ is the velocity correlation time. For times $t \\ll \\tau$, the particle's velocity is highly correlated with its initial velocity, $\\mathbf{v}(t) \\approx \\mathbf{v}(0)$. The particle moves as if unimpeded, resulting in ballistic motion where $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\approx \\langle|\\mathbf{v}(0)t|^2\\rangle = \\langle |\\mathbf{v}(0)|^2 \\rangle t^2 = v_0^2 t^2$. For times $t \\gg \\tau$, the particle has undergone many collisions with the surrounding fluid molecules, and its velocity has lost all memory of its initial state. Its trajectory becomes a random walk, leading to diffusive motion where the MSD grows linearly with time, $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\approx 6Dt$. The crossover between these behaviors occurs at the timescale $t \\approx \\tau$.",
            "answer": "$$\n\\boxed{\\frac{v_0^2 \\tau}{3}}\n$$"
        },
        {
            "introduction": "Translating the elegant continuous formulas of Green-Kubo theory into a working computational algorithm is a critical skill in molecular simulation. This practice focuses on the essential data processing step: calculating the time-correlation function and its integral from a discrete time series of a microscopic flux, such as the data you would generate in an MD simulation. You will construct the unbiased estimator for the autocorrelation function and use it to develop the numerical recipe for evaluating the Green-Kubo integral, moving from theoretical concept to practical code .",
            "id": "3414695",
            "problem": "An equilibrium Molecular Dynamics (MD) simulation of a homogeneous, stationary system provides a uniformly sampled scalar current time series $\\{J[n]\\}_{n=0}^{N-1}$ at sampling interval $\\Delta t$, with $N \\geq 2$. Assume that the equilibrium ensemble mean of the current is zero, i.e., $\\langle J(t) \\rangle = 0$, and that the process is wide-sense stationary so that its autocorrelation function $C_{JJ}(t) = \\langle J(0) J(t) \\rangle$ depends only on the time difference. Let $t_{\\max} = M \\Delta t$ with an integer $M$ satisfying $1 \\leq M \\leq N-1$.\n\nStarting from the definitions of stationarity, the ensemble autocorrelation function, and the Riemann approximation of an integral by a weighted sum over uniformly spaced samples, construct an estimator of the discrete autocorrelation values $C_{JJ}[k] \\equiv C_{JJ}(k \\Delta t)$ for lags $k \\in \\{0,1,\\dots,M\\}$ that is unbiased under the stated assumptions. Then derive the trapezoidal-rule approximation to the time integral $\\int_{0}^{t_{\\max}} C_{JJ}(t)\\,dt$ in terms of only the observed samples $\\{J[n]\\}$, the parameters $N$, $M$, and the timestep $\\Delta t$. Express the final result as a single closed-form analytic expression that uses only $\\{J[n]\\}$, $N$, $M$, and $\\Delta t$, and standard mathematical symbols (you may use the Kronecker delta $\\delta_{i,j}$ if needed). The final answer must be a single symbolic expression. Do not include any numerical evaluation, and do not report any units.",
            "solution": "The problem is well-posed and scientifically grounded. It requires the derivation of a standard formula for estimating the time integral of a current autocorrelation function, a central quantity in Green-Kubo theory. We proceed with the derivation.\n\nThe objective is to find an expression for the trapezoidal-rule approximation of the integral $I = \\int_{0}^{t_{\\max}} C_{JJ}(t)\\,dt$ based on a finite time series $\\{J[n]\\}_{n=0}^{N-1}$. The derivation involves two main steps: first, constructing an unbiased estimator for the autocorrelation function values $C_{JJ}[k]$, and second, applying the trapezoidal rule to the integral using these estimated values.\n\n**Step 1: Constructing an Unbiased Estimator for the Autocorrelation Function**\n\nThe autocorrelation function (ACF) of the stationary current $J(t)$ is defined as $C_{JJ}(\\tau) = \\langle J(t) J(t+\\tau) \\rangle$, where $\\langle \\dots \\rangle$ denotes an ensemble average. Due to the wide-sense stationarity of the process, the ACF depends only on the time lag $\\tau$ and not on the absolute time $t$. The problem states that the ensemble mean is zero, $\\langle J(t) \\rangle = 0$, which is consistent with this definition of the ACF.\n\nWe are given a discrete time series $\\{J[n]\\}_{n=0}^{N-1}$, where $J[n] \\equiv J(n \\Delta t)$. We need to estimate the discrete ACF values, $C_{JJ}[k] \\equiv C_{JJ}(k \\Delta t) = \\langle J[n] J[n+k] \\rangle$, for integer lags $k$.\n\nUnder the assumption of ergodicity, which is standard in equilibrium MD simulations, the ensemble average can be replaced by a time average over a single sufficiently long trajectory. An estimator, denoted by $\\hat{C}_{JJ}[k]$, is constructed by averaging the products of time-series values separated by a lag of $k$ time steps.\n\nFor a given lag $k$, the pairs of data points $(J[n], J[n+k])$ that can be formed from the time series $\\{J[n]\\}_{n=0}^{N-1}$ are those for which both indices $n$ and $n+k$ fall within the range $[0, N-1]$. This requires $0 \\leq n \\leq N-1-k$. The number of such pairs is $N-k$.\n\nTo ensure the estimator is unbiased, its expected value must equal the true value, i.e., $\\mathbb{E}[\\hat{C}_{JJ}[k]] = C_{JJ}[k]$. Let us define the estimator as the arithmetic mean of all available products:\n$$\n\\hat{C}_{JJ}[k] = \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} J[n] J[n+k]\n$$\nThis estimator is valid for lags $k \\in \\{0, 1, \\dots, N-1\\}$. The problem considers lags up to $M$, where $M \\leq N-1$, so the denominator $N-k$ is always non-zero.\n\nLet's verify that this estimator is indeed unbiased. The expectation operator $\\mathbb{E}[\\cdot]$ corresponds to the ensemble average $\\langle \\cdot \\rangle$.\n$$\n\\mathbb{E}[\\hat{C}_{JJ}[k]] = \\mathbb{E}\\left[ \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} J[n] J[n+k] \\right]\n$$\nBy the linearity of expectation, we can move the operator inside the sum:\n$$\n\\mathbb{E}[\\hat{C}_{JJ}[k]] = \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} \\mathbb{E}[J[n] J[n+k]]\n$$\nThe expectation $\\mathbb{E}[J[n] J[n+k]]$ is the true ensemble-averaged ACF at lag $k$, which is $C_{JJ}[k]$. Because of stationarity, this value is independent of the time index $n$. Therefore:\n$$\n\\mathbb{E}[\\hat{C}_{JJ}[k]] = \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} C_{JJ}[k] = \\frac{1}{N-k} (N-k) C_{JJ}[k] = C_{JJ}[k]\n$$\nThis confirms that our chosen estimator $\\hat{C}_{JJ}[k]$ is unbiased for any lag $k$ from $0$ to $N-1$.\n\n**Step 2: Applying the Trapezoidal Rule**\n\nThe next step is to approximate the integral $I = \\int_{0}^{t_{\\max}} C_{JJ}(t)\\,dt$ using the trapezoidal rule. The integration interval is $[0, t_{\\max}]$, where $t_{\\max} = M \\Delta t$. The function $C_{JJ}(t)$ is sampled at discrete points $t_k = k \\Delta t$ for $k=0, 1, \\dots, M$.\n\nThe trapezoidal rule approximates the integral as the sum of the areas of trapezoids formed by consecutive points. For a uniform step size $\\Delta t$, the formula is:\n$$\nI \\approx \\Delta t \\left[ \\frac{1}{2} C_{JJ}(t_0) + \\sum_{k=1}^{M-1} C_{JJ}(t_k) + \\frac{1}{2} C_{JJ}(t_M) \\right]\n$$\nIn our discrete notation, $C_{JJ}(t_k) = C_{JJ}[k]$. Thus, the approximation is:\n$$\nI \\approx \\Delta t \\left[ \\frac{1}{2} C_{JJ}[0] + \\sum_{k=1}^{M-1} C_{JJ}[k] + \\frac{1}{2} C_{JJ}[M] \\right]\n$$\nThis can be written more compactly as a weighted sum:\n$$\nI \\approx \\Delta t \\sum_{k=0}^{M} w_k C_{JJ}[k]\n$$\nwhere the weights $w_k$ for the trapezoidal rule are $w_0 = 1/2$, $w_M = 1/2$, and $w_k = 1$ for $1 \\leq k \\leq M-1$. Using the Kronecker delta, $\\delta_{i,j}$, which is $1$ if $i=j$ and $0$ otherwise, we can express the weights as a single formula for $k \\in \\{0, \\dots, M\\}$:\n$$\nw_k = 1 - \\frac{1}{2}\\delta_{k,0} - \\frac{1}{2}\\delta_{k,M}\n$$\nNote that for the case $M=1$, the sum $\\sum_{k=1}^{M-1}$ is empty and the formula correctly reduces to $I \\approx \\Delta t (\\frac{1}{2}C_{JJ}[0] + \\frac{1}{2}C_{JJ}[1])$, which is also covered by the general weight definition.\n\n**Step 3: Combining the Estimator and the Integration Rule**\n\nFinally, to obtain a practical formula based on the observed data $\\{J[n]\\}$, we substitute the true (but unknown) ACF values $C_{JJ}[k]$ in the trapezoidal rule with their unbiased estimates $\\hat{C}_{JJ}[k]$ derived in Step 1.\n\nThe estimated integral, let's call it $\\hat{I}$, is:\n$$\n\\hat{I} = \\Delta t \\sum_{k=0}^{M} w_k \\hat{C}_{JJ}[k]\n$$\nSubstituting the expressions for $w_k$ and $\\hat{C}_{JJ}[k]$:\n$$\n\\hat{I} = \\Delta t \\sum_{k=0}^{M} \\left(1 - \\frac{1}{2}\\delta_{k,0} - \\frac{1}{2}\\delta_{k,M}\\right) \\left( \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} J[n] J[n+k] \\right)\n$$\nThis is the final closed-form analytic expression for the trapezoidal-rule approximation of the integral in terms of the time series data $\\{J[n]\\}$ and the parameters $N$, $M$, and $\\Delta t$. It explicitly shows the contributions from different lags, weighted according to the trapezoidal rule and normalized correctly to ensure an unbiased estimation of the underlying ACF values.\nThe expanded form of this expression is:\n$$\n\\hat{I} = \\Delta t \\left[ \\frac{1}{2(N-0)} \\sum_{n=0}^{N-1} J[n] J[n+0] + \\sum_{k=1}^{M-1} \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} J[n] J[n+k] + \\frac{1}{2(N-M)} \\sum_{n=0}^{N-1-M} J[n] J[n+M] \\right]\n$$\nThe compact summation form using the Kronecker delta is more elegant and represents the single expression requested.",
            "answer": "$$\n\\boxed{\\Delta t \\sum_{k=0}^{M} \\frac{1 - \\frac{1}{2}\\delta_{k,0} - \\frac{1}{2}\\delta_{k,M}}{N-k} \\sum_{n=0}^{N-1-k} J[n] J[n+k]}\n$$"
        },
        {
            "introduction": "Idealized theories often assume an infinitely large system, but real-world simulations are performed in finite periodic boxes, a constraint that introduces subtle but significant systematic errors. This advanced exercise delves into the phenomenon of hydrodynamic long-time tails, which cause the Green-Kubo integrals to depend on the simulation's system size. By analyzing how these tails are affected by the finite box size, you will learn to predict and correct for these finite-size effects, a crucial step for achieving high-accuracy results for transport coefficients .",
            "id": "3456158",
            "problem": "Consider an equilibrium molecular dynamics simulation of a simple fluid in a periodic hypercubic box of linear size $L$ in $d$ dimensions, volume $V=L^{d}$. Let $J(t)$ denote the spatially integrated microscopic flux associated with a conserved quantity (for example, total momentum flux for shear viscosity, energy flux for thermal conductivity, or particle flux for mutual diffusion). The Green-Kubo (GK) expression for the corresponding transport coefficient $K$ has the form\n$K = \\mathcal{C}\\,\\frac{1}{V}\\int_{0}^{\\infty}\\langle J(0)J(t)\\rangle\\,\\mathrm{d}t,$\nwhere $\\mathcal{C}$ is a positive constant that depends on the specific transport process and thermodynamic parameters, and $\\langle \\cdot \\rangle$ denotes an equilibrium ensemble average. In an infinite system, nonlinear hydrodynamics predicts that long-wavelength mode coupling generates a long-time tail in the flux autocorrelation of the form\n$\\langle J(0)J(t)\\rangle \\simeq A\\,V\\,t^{-d/2}$\nfor $t$ in an intermediate asymptotic regime $t_{*}\\ll t\\ll t_{L}$, where $A0$ is an amplitude set by equilibrium susceptibilities and the relevant kinematic coefficients. In a finite periodic box, the hydrodynamic spectrum is discretized with a smallest nonzero wave number $k_{\\min}=2\\pi/L$. The slowest relaxing diffusive hydrodynamic mode has a decay rate $\\Gamma_{\\min}\\sim D_{\\mathrm{eff}}\\,k_{\\min}^{2}$, where $D_{\\mathrm{eff}}$ is the appropriate kinematic transport coefficient (for example, kinematic viscosity for shear, thermal diffusivity for heat), which implies a finite-size cutoff time $t_{L}\\sim 1/\\Gamma_{\\min}\\propto L^{2}$ beyond which the tail is suppressed.\n\nAssume the short-time part of the integrand is $L$-independent and that the only $L$-dependence arises from the long-time tail being cut off at $t\\sim t_{L}$. Using only the definitions and asymptotic forms stated above, determine the leading $L$-dependence of the finite-size Green-Kubo estimate $K(L)$ for $d=3$ and for $d=2$. Which option correctly gives the asymptotic finite-size scaling forms?\n\nA. For $d=3$: $K(L)=K(\\infty)-c\\,L^{-1}+o(L^{-1})$ with $c0$; for $d=2$: $K(L)=K_{0}+c\\,\\ln L+o(\\ln L)$ with $c0$ and $K_{0}$ an $L$-independent constant.\n\nB. For $d=3$: $K(L)=K(\\infty)-c\\,L^{-3/2}$ with $c0$; for $d=2$: $K(L)=K_{0}+c\\,L$ with $c0$.\n\nC. For $d=3$: $K(L)=K(\\infty)-c\\,L^{-2}$ with $c0$; for $d=2$: $K(L)=K(\\infty)-c/\\ln L$ with $c0$.\n\nD. For $d=3$: $K(L)$ is exactly independent of $L$; for $d=2$: $K(L)=K(\\infty)+c/L$ with $c0$.\n\nAll constants $c$, $K_{0}$, $K(\\infty)$ are $L$-independent and positive where indicated, and $o(\\cdot)$ denotes terms asymptotically smaller than their arguments as $L\\to\\infty$.",
            "solution": "We begin from the Green-Kubo definition,\n$K = \\mathcal{C}\\,\\frac{1}{V}\\int_{0}^{\\infty}\\langle J(0)J(t)\\rangle\\,\\mathrm{d}t,$\nand the hydrodynamic prediction for the long-time tail,\n$\\langle J(0)J(t)\\rangle \\simeq A\\,V\\,t^{-d/2}$\nfor $t_{*}\\ll t\\ll t_{L}$, with $A0$. In a finite periodic system, the slowest hydrodynamic diffusive mode has wave number $k_{\\min}=2\\pi/L$ and decay rate $\\Gamma_{\\min}\\sim D_{\\mathrm{eff}}\\,k_{\\min}^{2}$. Therefore, the tail is effectively cut off for $t\\gtrsim t_{L}$ with\n$t_{L}\\sim \\Gamma_{\\min}^{-1}\\sim \\frac{1}{D_{\\mathrm{eff}}\\,k_{\\min}^{2}} \\sim \\frac{L^{2}}{4\\pi^{2}D_{\\mathrm{eff}}}.$\nThis provides the $L$-dependence that feeds into the Green-Kubo time integral.\n\nTo extract $L$-scaling, split the time integral into a short-time contribution (independent of $L$ by assumption) and the long-time tail. Let $K_{\\mathrm{short}}$ denote the short-time contribution to $K$, which is $L$-independent. The $L$-dependent part arises from integrating the tail either up to $t_{L}$ (if the integral would diverge) or from $t_{L}$ to $\\infty$ (if the infinite-system integral is convergent and the finite system is missing the long-time portion).\n\nCase $d2$ (in particular $d=3$):\nFor $d2$, the integral $\\int^{\\infty} t^{-d/2}\\,\\mathrm{d}t$ converges. Therefore, the infinite-system value $K(\\infty)$ exists, and the finite-size error $\\Delta K(L)\\equiv K(\\infty)-K(L)$ is controlled by the tail that is missing beyond $t_{L}$:\n$\\Delta K(L)\\simeq \\mathcal{C}\\,\\frac{1}{V}\\int_{t_{L}}^{\\infty}\\langle J(0)J(t)\\rangle\\,\\mathrm{d}t \\simeq \\mathcal{C}\\,\\frac{1}{V}\\int_{t_{L}}^{\\infty} A\\,V\\,t^{-d/2}\\,\\mathrm{d}t = \\mathcal{C}\\,A\\int_{t_{L}}^{\\infty} t^{-d/2}\\,\\mathrm{d}t.$\nThis integral is elementary:\n$\\int_{t_{L}}^{\\infty} t^{-d/2}\\,\\mathrm{d}t = \\left[\\frac{2}{d-2}\\,t^{1-d/2}\\right]_{t_{L}}^{\\infty} = \\frac{2}{d-2}\\,t_{L}^{\\,1-d/2}.$\nFor $d=3$, this yields\n$\\Delta K(L) \\simeq \\mathcal{C}\\,A\\,\\frac{2}{3-2}\\,t_{L}^{-1/2} = 2\\mathcal{C}A\\,t_{L}^{-1/2}\\propto L^{-1},$\nsince $t_{L}\\propto L^{2}$. Thus,\n$K(L)=K(\\infty)-c\\,L^{-1}+o(L^{-1}),\\quad c0.$\n\nCase $d=2$:\nFor $d=2$, the tail exponent gives a marginally divergent integral, because\n$\\int^{t_{L}} t^{-1}\\,\\mathrm{d}t \\sim \\ln t_{L}.$\nThe finite system therefore yields a Green-Kubo estimate that grows logarithmically with the cutoff time:\n$K(L)\\simeq K_{\\mathrm{short}} + \\mathcal{C}\\,\\frac{1}{V}\\int_{t_{*}}^{t_{L}} \\langle J(0)J(t)\\rangle\\,\\mathrm{d}t \\simeq K_{\\mathrm{short}} + \\mathcal{C}\\,\\frac{1}{V}\\int_{t_{*}}^{t_{L}} A\\,V\\,t^{-1}\\,\\mathrm{d}t.$\nEvaluating the integral gives\n$K(L)\\simeq K_{\\mathrm{short}} + \\mathcal{C}\\,A\\,\\ln\\!\\left(\\frac{t_{L}}{t_{*}}\\right) = \\left[K_{\\mathrm{short}} - \\mathcal{C}\\,A\\,\\ln t_{*}\\right] + \\mathcal{C}\\,A\\,\\ln t_{L}.$\nSince $t_{L}\\propto L^{2}$, we have $\\ln t_{L} = \\ln(\\mathrm{const}\\times L^{2}) = \\mathrm{const} + 2\\ln L$, and therefore\n$K(L)=K_{0} + c\\,\\ln L + o(\\ln L)$\nwith positive constants $K_{0}$ and $c$.\n\nThus, the correct leading finite-size scalings are:\n- For $d=3$: $K(L)=K(\\infty)-c\\,L^{-1}+o(L^{-1})$ with $c0$.\n- For $d=2$: $K(L)=K_{0}+c\\,\\ln L+o(\\ln L)$ with $c0$.\n\nOption-by-option analysis:\n- Option A states precisely the forms derived above. Verdict: Correct.\n- Option B claims a $d=3$ correction $\\propto L^{-3/2}$, which contradicts the derived $L^{-1}$ from $t_{L}^{-1/2}\\propto L^{-1}$. It also claims a linear-in-$L$ growth in $d=2$, whereas the marginal divergence yields $\\ln L$, not $L$. Verdict: Incorrect.\n- Option C proposes $d=3$ corrections $\\propto L^{-2}$, which would correspond to $t_{L}^{-1}$ and is not consistent with the $t^{-3/2}$ tail; it further suggests a $d=2$ finite-size decrease as $1/\\ln L$, the opposite of the logarithmic growth. Verdict: Incorrect.\n- Option D asserts no $L$-dependence in $d=3$, which is false because the missing tail beyond $t_{L}$ produces a nonzero $L^{-1}$ correction; it also gives a $d=2$ correction $\\propto 1/L$, whereas the correct growth is logarithmic. Verdict: Incorrect.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}