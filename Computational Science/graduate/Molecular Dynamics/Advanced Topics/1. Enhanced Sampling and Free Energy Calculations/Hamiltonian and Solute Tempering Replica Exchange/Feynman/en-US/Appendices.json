{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any Hamiltonian Replica Exchange method, including Replica Exchange with Solute Tempering (REST), lies in the precise construction of the modified potential energy function for each replica. This practice challenges you to verify the standard REST2 scaling scheme, which is designed to effectively \"heat\" a solute subsystem while keeping the surrounding solvent \"cold.\" Mastering this concept is the first and most critical step toward correctly implementing or interpreting a REST simulation, as it ensures that the tempering is applied as intended and that exchanges between replicas satisfy detailed balance. ",
            "id": "3414963",
            "problem": "Consider Hamiltonian Replica Exchange with Solute Tempering (REST), where a molecular system is partitioned into a solute subset $s$ and a solvent subset $v$. The classical potential energy of a configuration $\\mathbf{x}$ is decomposed as $U(\\mathbf{x}) = U_{ss}(\\mathbf{x}) + U_{sv}(\\mathbf{x}) + U_{vv}(\\mathbf{x})$, where $U_{ss}$ collects interactions internal to the solute, $U_{sv}$ collects interactions between solute and solvent, and $U_{vv}$ collects interactions internal to the solvent. In REST, each replica $i$ uses a modified Hamiltonian $U_i(\\mathbf{x})$ parameterized by a scaling parameter $\\lambda_i \\in (0,1]$ designed so that the solvent remains at a physical temperature $T$ while only the solute experiences effective tempering. The ensemble weight of replica $i$ for configuration $\\mathbf{x}$ in the canonical ensemble is proportional to $\\exp(-\\beta U_i(\\mathbf{x}))$ with inverse temperature $\\beta = 1/(k_{\\mathrm{B}} T)$, where $k_{\\mathrm{B}}$ is Boltzmann’s constant. Replica exchange moves between replicas $i$ and $j$ must satisfy detailed balance under the canonical measure.\n\nYou are tasked with specifying practical implementation checks to verify that a REST code correctly stratifies energies across replicas. The checks must be based on evaluating, for a single fixed configuration $\\mathbf{x}$ held common across replicas, the components of $U_i(\\mathbf{x})$ attributable to $U_{ss}(\\mathbf{x})$, $U_{sv}(\\mathbf{x})$, and $U_{vv}(\\mathbf{x})$ as functions of $\\lambda_i$. The goal is to confirm that the solvent remains untempered while the solute-only and solute–solvent interactions are scaled in a manner consistent with solute tempering and with detailed balance of Metropolis exchanges.\n\nWhich of the following sets of implementation checks is correct for REST solute tempering?\n\nA. For every replica $i$ and any fixed $\\mathbf{x}$, verify $U_{vv}^{(i)}(\\mathbf{x}) = U_{vv}(\\mathbf{x})$ (independent of $i$), $U_{ss}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{ss}(\\mathbf{x})$, and $U_{sv}^{(i)}(\\mathbf{x}) = \\sqrt{\\lambda_i}\\, U_{sv}(\\mathbf{x})$. Additionally verify that the energy difference between replicas $i$ and $j$ at the same $\\mathbf{x}$ satisfies $U_j(\\mathbf{x}) - U_i(\\mathbf{x}) = (\\lambda_j - \\lambda_i)\\, U_{ss}(\\mathbf{x}) + \\big(\\sqrt{\\lambda_j} - \\sqrt{\\lambda_i}\\big)\\, U_{sv}(\\mathbf{x})$, and that the solvent–solvent term cancels in any replica-exchange Metropolis exponent constructed from these components.\n\nB. For every replica $i$ and any fixed $\\mathbf{x}$, verify $U_{ss}^{(i)}(\\mathbf{x}) = U_{ss}(\\mathbf{x})$ (independent of $i$), $U_{vv}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{vv}(\\mathbf{x})$, and $U_{sv}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{sv}(\\mathbf{x})$, reflecting the idea that heating the solvent drives exchanges while leaving the solute unchanged.\n\nC. For every replica $i$ and any fixed $\\mathbf{x}$, verify uniform scaling $U_i(\\mathbf{x}) = \\lambda_i\\, U(\\mathbf{x})$ so that the entire Hamiltonian is tempered consistently and the Metropolis exchange exponent depends only on $(\\lambda_j - \\lambda_i)\\, U(\\mathbf{x})$ for replicas $i$ and $j$.\n\nD. For every replica $i$ and any fixed $\\mathbf{x}$, verify $U_{vv}^{(i)}(\\mathbf{x}) = U_{vv}(\\mathbf{x})$, $U_{ss}^{(i)}(\\mathbf{x}) = \\lambda_i^2\\, U_{ss}(\\mathbf{x})$, and $U_{sv}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{sv}(\\mathbf{x})$, arguing that the solute–solute term should pick up two factors of the solute scaling and the solute–solvent term one factor.\n\nE. For every replica $i$ and any fixed $\\mathbf{x}$, verify that all potential energy components are invariant, $U_i(\\mathbf{x}) = U(\\mathbf{x})$, and instead implement tempering solely by scaling kinetic energies of solute atoms so that only the solute is effectively heated, leaving the solvent kinetic energy at temperature $T$.",
            "solution": "### Problem Validation\n\nThe first step is to rigorously validate the problem statement.\n\n#### Step 1: Extract Givens\n\nThe problem provides the following information and definitions:\n-   **Method**: Hamiltonian Replica Exchange with Solute Tempering (REST).\n-   **System Partition**: A molecular system is divided into a solute subset $s$ and a solvent subset $v$.\n-   **Potential Energy Decomposition**: The total potential energy for a configuration $\\mathbf{x}$ is $U(\\mathbf{x}) = U_{ss}(\\mathbf{x}) + U_{sv}(\\mathbf{x}) + U_{vv}(\\mathbf{x})$.\n    -   $U_{ss}$: Interactions internal to the solute.\n    -   $U_{sv}$: Interactions between solute and solvent.\n    -   $U_{vv}$: Interactions internal to the solvent.\n-   **Replica Hamiltonian**: Each replica $i$ uses a modified Hamiltonian $U_i(\\mathbf{x})$ parameterized by a scaling factor $\\lambda_i \\in (0,1]$.\n-   **Tempering Goal**: The solvent remains at a physical temperature $T$, while only the solute experiences effective tempering.\n-   **Ensemble Weight**: The weight for replica $i$ is proportional to $\\exp(-\\beta U_i(\\mathbf{x}))$, with inverse temperature $\\beta = 1/(k_{\\mathrm{B}} T)$.\n-   **Detailed Balance**: Replica exchange moves between replicas $i$ and $j$ must satisfy detailed balance.\n-   **Task**: Specify implementation checks for the components of $U_i(\\mathbf{x})$ based on a single fixed configuration $\\mathbf{x}$, as a function of $\\lambda_i$. These checks must confirm that the scaling is consistent with the principles of solute tempering and detailed balance for replica exchanges.\n\n#### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is firmly grounded in the principles of statistical mechanics and computational chemistry. Hamiltonian Replica Exchange with Solute Tempering (REST) is a well-established and widely used enhanced sampling technique in molecular dynamics simulations. The decomposition of the potential energy and the use of a modified Hamiltonian are central to this method.\n-   **Well-Posed**: The problem is well-posed. It asks for the correct functional form of the modified potential energy $U_i(\\mathbf{x})$ that achieves the stated physical goal (solute tempering). Given the principles of Hamiltonian replica exchange, a specific, derivable form for $U_i(\\mathbf{x})$ exists, which can be used to evaluate the provided options.\n-   **Objective**: The problem is stated using precise, objective, and standard terminology from the field of molecular simulation. It is free from ambiguity or subjective claims.\n-   **Completeness and Consistency**: The problem provides all necessary information to deduce the correct form of the REST Hamiltonian. The constraints—that the solvent remains at temperature $T$ while the solute is tempered and that exchanges obey detailed balance—are sufficient to derive the required energy scaling relationships.\n\n#### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is a correct and well-formulated question about a standard method in advanced molecular simulation. I will therefore proceed to derive the solution and evaluate the options.\n\n### Solution Derivation\n\nThe objective of Hamiltonian Replica Exchange with Solute Tempering (REST) is to accelerate the sampling of a solute's conformational space by effectively \"heating\" it up, without heating the solvent. In the context of Hamiltonian replica exchange, this is achieved not by changing the kinetic temperature, but by modifying the potential energy function, $U(\\mathbf{x})$, for each replica $i$.\n\nThe canonical probability distribution for a configuration $\\mathbf{x}$ at inverse temperature $\\beta = 1/(k_{\\mathrm{B}}T)$ is $P(\\mathbf{x}) \\propto \\exp(-\\beta U(\\mathbf{x}))$. In H-REMD, each replica $i$ samples from a distribution $P_i(\\mathbf{x}) \\propto \\exp(-\\beta U_i(\\mathbf{x}))$, where $U_i(\\mathbf{x})$ is the modified potential.\n\nLet's define an effective temperature for the solute in replica $i$ as $T_i = T/\\lambda_i$, where $\\lambda_i \\in (0,1]$ is the scaling parameter. The reference replica has $\\lambda=1$, corresponding to the physical system at temperature $T$. A smaller $\\lambda_i$ corresponds to a higher effective solute temperature. The effective inverse temperature for the solute is $\\beta_i = 1/(k_{\\mathrm{B}}T_i) = \\lambda_i / (k_{\\mathrm{B}}T) = \\lambda_i \\beta$.\n\nTo achieve this effective tempering, the terms in the potential energy involving the solute must be scaled accordingly. Let's analyze the components of the modified potential $U_i(\\mathbf{x}) = U_{ss}^{(i)}(\\mathbf{x}) + U_{sv}^{(i)}(\\mathbf{x}) + U_{vv}^{(i)}(\\mathbf{x})$:\n\n1.  **Solvent-Solvent Term ($U_{vv}$)**: The problem states that the solvent remains at the physical temperature $T$. This means its contribution to the Boltzmann weight should be $\\exp(-\\beta U_{vv}(\\mathbf{x}))$. To achieve this within the framework of $\\exp(-\\beta U_i(\\mathbf{x}))$, the solvent-solvent potential energy component in the modified Hamiltonian must be unscaled.\n    $$U_{vv}^{(i)}(\\mathbf{x}) = U_{vv}(\\mathbf{x})$$\n\n2.  **Solute-Solute Term ($U_{ss}$)**: The solute is to be tempered at an effective inverse temperature $\\beta_i = \\lambda_i \\beta$. Its contribution to the Boltzmann weight should be $\\exp(-\\beta_i U_{ss}(\\mathbf{x})) = \\exp(-\\lambda_i \\beta U_{ss}(\\mathbf{x}))$. This requires the solute-solute term in the modified Hamiltonian to be scaled by $\\lambda_i$.\n    $$U_{ss}^{(i)}(\\mathbf{x}) = \\lambda_i U_{ss}(\\mathbf{x})$$\n\n3.  **Solute-Solvent Term ($U_{sv}$)**: This term involves interactions between the \"hot\" solute and the \"cold\" solvent. A physically and computationally motivated scaling arises from considering the underlying force-field parameters. Many interaction potentials (e.g., Coulomb, Lennard-Jones) are built from pairwise terms where the interaction strength depends on parameters of both particles. If one imagines scaling the \"charge-like\" parameters of all solute atoms by a factor of $\\sqrt{\\lambda_i}$, then:\n    -   An interaction between two solute atoms ($ss$) would be scaled by $(\\sqrt{\\lambda_i}) \\times (\\sqrt{\\lambda_i}) = \\lambda_i$. This is consistent with our finding for $U_{ss}$.\n    -   An interaction between a solute atom and a solvent atom ($sv$) would be scaled by $(\\sqrt{\\lambda_i}) \\times \\sqrt{1} = \\sqrt{\\lambda_i}$.\n    -   An interaction between two solvent atoms ($vv$) would be scaled by $\\sqrt{1} \\times \\sqrt{1} = 1$. This is consistent with our finding for $U_{vv}$.\n    This leads to the following scaling for the solute-solvent term:\n    $$U_{sv}^{(i)}(\\mathbf{x}) = \\sqrt{\\lambda_i} U_{sv}(\\mathbf{x})$$\n\nThis formulation is known as REST2 and is a standard, robust implementation of the solute tempering concept.\n\nCombining these components, the total modified potential for replica $i$ is:\n$$U_i(\\mathbf{x}) = \\lambda_i U_{ss}(\\mathbf{x}) + \\sqrt{\\lambda_i} U_{sv}(\\mathbf{x}) + U_{vv}(\\mathbf{x})$$\n\nNow, consider the detailed balance condition for an exchange attempt between replica $i$ and replica $j$. The Metropolis acceptance criterion involves the energy difference term $\\Delta = \\beta [ U_i(\\mathbf{x}_j) - U_i(\\mathbf{x}_i) + U_j(\\mathbf{x}_i) - U_j(\\mathbf{x}_j) ]$. A key part of this is the difference in potential energy functions for a single configuration $\\mathbf{x}$, which is what the problem asks to check. Let's compute this difference:\n$$ \\Delta U(\\mathbf{x}) = U_j(\\mathbf{x}) - U_i(\\mathbf{x}) $$\n$$ \\Delta U(\\mathbf{x}) = \\left( \\lambda_j U_{ss}(\\mathbf{x}) + \\sqrt{\\lambda_j} U_{sv}(\\mathbf{x}) + U_{vv}(\\mathbf{x}) \\right) - \\left( \\lambda_i U_{ss}(\\mathbf{x}) + \\sqrt{\\lambda_i} U_{sv}(\\mathbf{x}) + U_{vv}(\\mathbf{x}) \\right) $$\n$$ \\Delta U(\\mathbf{x}) = (\\lambda_j - \\lambda_i) U_{ss}(\\mathbf{x}) + (\\sqrt{\\lambda_j} - \\sqrt{\\lambda_i}) U_{sv}(\\mathbf{x}) $$\nAs required, the $U_{vv}(\\mathbf{x})$ term, which is often the largest and most computationally expensive part of the potential energy, cancels out of the difference. This cancellation is a crucial feature for the efficiency of replica exchange calculations.\n\n### Option-by-Option Analysis\n\nBased on the derivation above, we can evaluate each option.\n\n**A. For every replica $i$ and any fixed $\\mathbf{x}$, verify $U_{vv}^{(i)}(\\mathbf{x}) = U_{vv}(\\mathbf{x})$ (independent of $i$), $U_{ss}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{ss}(\\mathbf{x})$, and $U_{sv}^{(i)}(\\mathbf{x}) = \\sqrt{\\lambda_i}\\, U_{sv}(\\mathbf{x})$. Additionally verify that the energy difference between replicas $i$ and $j$ at the same $\\mathbf{x}$ satisfies $U_j(\\mathbf{x}) - U_i(\\mathbf{x}) = (\\lambda_j - \\lambda_i)\\, U_{ss}(\\mathbf{x}) + \\big(\\sqrt{\\lambda_j} - \\sqrt{\\lambda_i}\\big)\\, U_{sv}(\\mathbf{x})$, and that the solvent–solvent term cancels in any replica-exchange Metropolis exponent constructed from these components.**\n\nThis option precisely matches the derived REST2 formulation.\n-   $U_{vv}$ is unscaled, keeping the solvent \"cold\".\n-   $U_{ss}$ is scaled by $\\lambda_i$, correctly tempering the solute.\n-   $U_{sv}$ is scaled by $\\sqrt{\\lambda_i}$, consistent with scaling fundamental force-field parameters.\n-   The expression for the energy difference $U_j(\\mathbf{x}) - U_i(\\mathbf{x})$ is a direct and correct algebraic consequence of the component scalings.\n-   The cancellation of the $U_{vv}$ term is correctly identified.\nThis set of checks is a complete and correct verification of a standard REST implementation.\n**Verdict: Correct.**\n\n**B. For every replica $i$ and any fixed $\\mathbf{x}$, verify $U_{ss}^{(i)}(\\mathbf{x}) = U_{ss}(\\mathbf{x})$ (independent of $i$), $U_{vv}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{vv}(\\mathbf{x})$, and $U_{sv}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{sv}(\\mathbf{x})$, reflecting the idea that heating the solvent drives exchanges while leaving the solute unchanged.**\n\nThis option describes the tempering of the solvent, not the solute. $U_{ss}$ is unscaled, while $U_{vv}$ is scaled by $\\lambda_i$. This is the opposite of the stated goal of REST (solute tempering).\n**Verdict: Incorrect.**\n\n**C. For every replica $i$ and any fixed $\\mathbf{x}$, verify uniform scaling $U_i(\\mathbf{x}) = \\lambda_i\\, U(\\mathbf{x})$ so that the entire Hamiltonian is tempered consistently and the Metropolis exchange exponent depends only on $(\\lambda_j - \\lambda_i)\\, U(\\mathbf{x})$ for replicas $i$ and $j$.**\n\nThis describes standard temperature replica exchange (T-REMD or parallel tempering), not Hamiltonian Replica Exchange for a subsystem. In T-REMD, the entire system is simulated at different temperatures. Expressing this in a Hamiltonian exchange framework (at constant temperature $T$) is equivalent to scaling the entire potential energy $U(\\mathbf{x})$ by $\\lambda_i = T/T_i$. This does not achieve selective solute tempering.\n**Verdict: Incorrect.**\n\n**D. For every replica $i$ and any fixed $\\mathbf{x}$, verify $U_{vv}^{(i)}(\\mathbf{x}) = U_{vv}(\\mathbf{x})$, $U_{ss}^{(i)}(\\mathbf{x}) = \\lambda_i^2\\, U_{ss}(\\mathbf{x})$, and $U_{sv}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{sv}(\\mathbf{x})$, arguing that the solute–solute term should pick up two factors of the solute scaling and the solute–solvent term one factor.**\n\nThis option uses incorrect scaling exponents. The scaling of the potential energy term must be linear in $\\lambda_i$ to correspond to an effective inverse temperature of $\\lambda_i \\beta$. A scaling of $\\lambda_i^2$ for $U_{ss}$ has no direct physical correspondence to the desired effective temperature and is not standard practice.\n**Verdict: Incorrect.**\n\n**E. For every replica $i$ and any fixed $\\mathbf{x}$, verify that all potential energy components are invariant, $U_i(\\mathbf{x}) = U(\\mathbf{x})$, and instead implement tempering solely by scaling kinetic energies of solute atoms so that only the solute is effectively heated, leaving the solvent kinetic energy at temperature $T$.**\n\nThis option fundamentally misunderstands the mechanism of Hamiltonian Replica Exchange. H-REMD works by modifying the *potential energy* part of the Hamiltonian. The entire system is coupled to a single thermostat at a single kinetic temperature $T$. The \"effective temperature\" of the solute is a result of the modified potential energy landscape it explores, which facilitates barrier crossing, not a change in its actual kinetic energy distribution. The described method is a completely different (and difficult to implement) non-equilibrium approach, not REST.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Translating the theoretical REST Hamiltonian into a practical molecular dynamics simulation requires deciding how to handle all components of a modern force field. Beyond the non-bonded interactions that are the primary target of scaling, biomolecular systems feature a complex network of bonded terms and often employ holonomic constraints (e.g., SHAKE) to improve computational efficiency. This exercise asks you to consider the correct treatment of these terms, bridging the gap between an abstract scaling principle and its concrete application, which is crucial for preserving the physical integrity of the simulated system. ",
            "id": "3415019",
            "problem": "Consider a solvated biomolecular system simulated by Molecular Dynamics (MD) at a fixed base temperature $T_0$ with inverse thermal energy $\\beta_0 = 1/(k_\\mathrm{B} T_0)$, where $k_\\mathrm{B}$ is the Boltzmann constant. The coordinates are partitioned into solute coordinates $q_\\mathrm{s}$ and solvent coordinates $q_\\mathrm{v}$. Holonomic constraints (e.g., fixed bond lengths) are imposed on a subset of solute internal coordinates via a constraint manifold $\\{q: g_k(q_\\mathrms) = 0\\}$ enforced by a Lagrange-multiplier algorithm such as SHAKE. The system’s potential energy is additively decomposed as\n$$\nU(q) = U_{\\mathrm{SS}}(q_\\mathrm{s}) + U_{\\mathrm{S\\text{-}S}}(q_\\mathrm{s}, q_\\mathrm{v}) + U_{\\mathrm{VV}}(q_\\mathrm{v}) + U_{\\mathrm{bond}}(q_\\mathrm{s})\n$$\nwhere $U_{\\mathrm{SS}}$ collects solute–solute nonbonded terms (including intramolecular $1\\text{-}4$ Lennard-Jones and Coulomb interactions), $U_{\\mathrm{S\\text{-}S}}$ collects solute–solvent nonbonded terms, $U_{\\mathrm{VV}}$ is solvent–solvent nonbonded, and $U_{\\mathrm{bond}}$ collects solute bonded terms (bond stretches, angles, and torsions) corresponding to flexible degrees of freedom not eliminated by constraints.\n\nIn Hamiltonian Replica Exchange (HREX), one constructs a ladder of replicas with modified Hamiltonians $\\{H_m\\}$, all coupled to the same thermostat at $T_0$, and exchanges configurations between replicas using a Metropolis criterion that enforces detailed balance with respect to the product of their canonical distributions. In Replica Exchange with Solute Tempering (REST$2$), the goal is to raise the effective temperature of the solute while leaving the solvent at $T_0$, by scaling interaction terms in the Hamiltonian rather than changing the physical temperature per replica. The scaling must be designed so that:\n- The solvent–solvent ensemble remains at $T_0$.\n- The solute–solute and solute–solvent energetic weights mimic an increased solute effective temperature while preserving correct statistics when projected back to the $T_0$ ensemble.\n- Holonomic constraints and the distributions of any constrained bond lengths are not altered by scaling.\n- Bonded terms associated with internal geometry do not acquire spurious temperature dependence that would distort equilibrium distributions at $T_0$.\n\nAssume that nonbonded pairwise interactions (Coulomb and Lennard-Jones) are bilinear in “solute parameters” (e.g., partial charges, Lennard-Jones well depths), so that scaling solute parameters by a factor $s_m$ induces a quadratic scaling of $U_{\\mathrm{SS}}$ and a linear scaling of $U_{\\mathrm{S\\text{-}S}}$, while leaving $U_{\\mathrm{VV}}$ unchanged. Let $\\lambda_m \\in (0, 1]$ denote a dimensionless scaling parameter per replica $m$ that encodes the desired effective weakening of solute interactions relative to $\\beta_0$.\n\nWhich option below correctly specifies a REST$2$ scaling scheme and the associated Metropolis exchange acceptance factor for swapping configurations between replicas $m$ and $n$, while keeping constraint forces unscaled and avoiding alteration of bond length distributions? Choose the single best answer.\n\nA. Define the scaled potential as\n$$\nU_m(q) = \\lambda_m\\big[U_{\\mathrm{SS}}(q_\\mathrm{s}) + U_{\\mathrm{S\\text{-}S}}(q_\\mathrm{s}, q_\\mathrm{v}) + U_{\\mathrm{VV}}(q_\\mathrm{v}) + U_{\\mathrm{bond}}(q_\\mathrm{s})\\big]\n$$\nand scale all constraint Lagrange multipliers by $\\lambda_m$. Use the acceptance factor\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right)\n$$\n\nB. Define the scaled potential as\n$$\nU_m(q) = \\lambda_m\\,U_{\\mathrm{SS}}(q_\\mathrm{s}) + \\sqrt{\\lambda_m}\\,U_{\\mathrm{S\\text{-}S}}(q_\\mathrm{s}, q_\\mathrm{v}) + U_{\\mathrm{VV}}(q_\\mathrm{v}) + U_{\\mathrm{bond}}(q_\\mathrm{s})\n$$\nwhere $U_{\\mathrm{SS}}$ includes intramolecular $1\\text{-}4$ nonbonded terms, and keep SHAKE constraint forces and all bonded terms unscaled. Use the acceptance factor\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right)\n$$\n\nC. Define the scaled potential as\n$$\nU_m(q) = U_{\\mathrm{SS}}(q_\\mathrm{s}) + \\lambda_m\\,U_{\\mathrm{S\\text{-}S}}(q_\\mathrm{s}, q_\\mathrm{v}) + U_{\\mathrm{VV}}(q_\\mathrm{v}) + U_{\\mathrm{bond}}(q_\\mathrm{s})\n$$\nkeeping constraints and bonded terms unscaled. Use the acceptance factor\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right)\n$$\n\nD. Define the scaled potential as\n$$\nU_m(q) = U_{\\mathrm{SS}}(q_\\mathrm{s}) + U_{\\mathrm{S\\text{-}S}}(q_\\mathrm{s}, q_\\mathrm{v}) + U_{\\mathrm{VV}}(q_\\mathrm{v}) + \\lambda_m\\,U_{\\mathrm{bond}}(q_\\mathrm{s})\n$$\nand scale SHAKE constraint forces by $\\sqrt{\\lambda_m}$ to “match” bonded scaling. Use the acceptance factor\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right)\n$$",
            "solution": "We begin from the canonical ensemble and the construction of Hamiltonian Replica Exchange (HREX). For a replica $m$ at the common thermostat temperature $T_0$ (inverse thermal energy $\\beta_0$), the stationary distribution over coordinates $q$ is\n$$\n\\pi_m(q) \\propto \\exp\\big[-\\beta_0 U_m(q)\\big]\n$$\nwhere $U_m(q)$ is the replica-specific scaled potential. Exchanging configurations $q^{(m)}$ and $q^{(n)}$ between replicas $m$ and $n$ must satisfy detailed balance with respect to the product distribution $\\pi_m(q^{(m)})\\,\\pi_n(q^{(n)})$, leading to the Metropolis acceptance factor\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right)\n$$\nThis expression depends only on the scaled potential energies because all replicas share the same $T_0$.\n\nNext, we require a physically motivated REST$2$ scaling that elevates the effective temperature of solute interactions while leaving solvent interactions at $T_0$. A principled route is to consider how nonbonded energies depend on solute “interaction parameters.” For Coulomb interactions, the energy between atoms $i$ and $j$ is\n$$\nU_{ij}^{\\mathrm{Coul}} = \\frac{q_i q_j}{4\\pi\\varepsilon_0 r_{ij}}\n$$\nwhere $q_i$ and $q_j$ are partial charges and $r_{ij}$ the separation. If we scale all solute charges by a factor $s_m$, then solute–solute terms scale as $s_m^2$ (both charges are solute), and solute–solvent terms scale as $s_m$ (only one charge is solute). A similar bilinear structure holds for Lennard-Jones interactions if we scale solute well depths by $s_m$ (because the cross well depth is proportional to the geometric mean and thus linear in the solute factor). Therefore, by choosing the solute parameter scaling $s_m = \\sqrt{\\lambda_m}$, we obtain the desired potential scaling\n$$\nU_m(q) = \\lambda_m\\,U_{\\mathrm{SS}}(q_\\mathrm{s}) + \\sqrt{\\lambda_m}\\,U_{\\mathrm{S\\text{-}S}}(q_\\mathrm{s}, q_\\mathrm{v}) + U_{\\mathrm{VV}}(q_\\mathrm{v}) + \\text{(terms left unscaled)}\n$$\n\nHolonomic constraints are enforced via Lagrange multipliers $\\{\\zeta_k\\}$ satisfying $g_k(q_\\mathrm{s}) = 0$ and do not contribute an explicit potential term to $U(q)$. Consequently, constraint forces modify the equations of motion but not the Boltzmann weight $\\exp[-\\beta_0 U_m(q)]$. Scaling the constraint forces or their multipliers would not be consistent with the ensemble measure and could spuriously distort the constrained geometry or acceptance statistics. The correct treatment is to keep constraints unchanged across replicas. Similarly, bonded terms $U_{\\mathrm{bond}}(q_\\mathrm{s})$ (bond stretches, angles, torsions) encode local geometry and should not be given an artificial temperature dependence via scaling; otherwise, one would distort equilibrium distributions of internal coordinates at $T_0$. The aim of REST$2$ is to diminish barriers dominated by nonbonded packing and electrostatics, not to soften covalent interactions. Intramolecular $1\\text{-}4$ nonbonded interactions are part of nonbonded solute–solute energetics and should be included within $U_{\\mathrm{SS}}$ and thus scaled according to $\\lambda_m$.\n\nPutting these pieces together yields the scheme:\n- Keep SHAKE (constraint) forces unscaled, i.e., the constraint manifold $\\{q: g_k(q_\\mathrm{s}) = 0\\}$ is identical in all replicas.\n- Leave all bonded terms $U_{\\mathrm{bond}}(q_\\mathrm{s})$ unscaled.\n- Scale solute–solute nonbonded terms by $\\lambda_m$.\n- Scale solute–solvent nonbonded terms by $\\sqrt{\\lambda_m}$.\n- Leave solvent–solvent terms unscaled.\n- Use the HREX Metropolis acceptance factor at the common $\\beta_0$.\n\nWe now evaluate each option:\n\nA. This option scales every term, including $U_{\\mathrm{VV}}$ and $U_{\\mathrm{bond}}$, by $\\lambda_m$ and further proposes scaling the constraint forces. Scaling $U_{\\mathrm{VV}}$ contradicts the goal of isolating the solute effective temperature, and scaling $U_{\\mathrm{bond}}$ distorts covalent geometry statistics. Scaling constraints is conceptually improper because constraints do not enter $U(q)$ and should not be modified across replicas. The acceptance factor formula itself is structurally correct, but the scaled potential is inappropriate. Verdict: Incorrect.\n\nB. This option defines $U_m(q) = \\lambda_m U_{\\mathrm{SS}} + \\sqrt{\\lambda_m} U_{\\mathrm{S\\text{-}S}} + U_{\\mathrm{VV}} + U_{\\mathrm{bond}}$, keeps SHAKE and bonded terms unscaled, and explicitly includes intramolecular $1\\text{-}4$ nonbonded interactions in $U_{\\mathrm{SS}}$. This matches the bilinear scaling rationale ($s_m=\\sqrt{\\lambda_m}$), preserves solvent at $T_0$, avoids altering bond length distributions, and correctly treats constraints as non-energetic. The acceptance factor is the correct HREX Metropolis form at $\\beta_0$. Verdict: Correct.\n\nC. This option scales only $U_{\\mathrm{S\\text{-}S}}$ linearly by $\\lambda_m$ and leaves $U_{\\mathrm{SS}}$ unscaled. That fails to reflect the quadratic dependence of solute–solute energies on the solute parameter scaling and contradicts the intended effective elevation of solute temperature (it leaves $U_{\\mathrm{SS}}$ at full strength). Even though constraints and bonded terms are left unscaled, the scaling pattern is not the REST$2$ construction. Verdict: Incorrect.\n\nD. This option scales bonded terms by $\\lambda_m$ and additionally scales SHAKE constraint forces by $\\sqrt{\\lambda_m}$. This directly violates the requirement to avoid altering bond length distributions and is inconsistent with constraints’ non-energetic role. It also leaves nonbonded terms unscaled, missing the central REST$2$ idea. The acceptance formula form is standard but applied to an unsuitable $U_m$. Verdict: Incorrect.\n\nTherefore, the only option that meets all criteria is B.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "A successful replica exchange simulation produces a wealth of data across multiple thermodynamic states, but our ultimate interest is in the physical ensemble (where the scaling parameter $\\lambda=1$). This practice guides you through the essential task of reweighting, deriving the self-normalized importance sampling (SNIS) estimator used to combine data from all replicas to calculate observables in the target state. Furthermore, it delves into the crucial analysis of statistical efficiency, showing how the \"overlap\" between replica ensembles dictates the quality of your final results, a key skill for designing and diagnosing any advanced sampling simulation. ",
            "id": "3415003",
            "problem": "Consider a classical molecular system simulated in the canonical ensemble at inverse temperature $\\beta$, with a family of Hamiltonians $U_{\\lambda}(\\mathbf{x})$ parameterized by a coupling parameter $\\lambda \\in [0,1]$. You are given $N_i$ independent configurations $\\{\\mathbf{x}^{(n)}\\}_{n=1}^{N_i}$ drawn from the canonical distribution corresponding to $\\lambda_i$, namely with probability density $p_i(\\mathbf{x}) \\propto \\exp\\!\\left[-\\beta U_{\\lambda_i}(\\mathbf{x})\\right]$. You wish to estimate the canonical average of a bounded observable $A(\\mathbf{x})$ at $\\lambda=1$, denoted $\\langle A \\rangle_{1}$, using only these samples at $\\lambda_i$.\n\nTasks:\n1. Starting from the canonical-ensemble definition $\\langle A \\rangle_{1} = Z_1^{-1} \\int \\mathrm{d}\\mathbf{x}\\, A(\\mathbf{x}) \\exp\\!\\left[-\\beta U_{1}(\\mathbf{x})\\right]$, where $Z_1$ is the partition function at $\\lambda=1$, derive a self-normalized importance-sampling estimator that expresses $\\langle A \\rangle_{1}$ as a ratio of weighted averages over the $\\{\\mathbf{x}^{(n)}\\}_{n=1}^{N_i}$ sampled from $p_i(\\mathbf{x})$. Your derivation must proceed from the definitions of the canonical distributions and importance sampling and must not assume any specific form of the weights until the final expression is obtained from first principles.\n\n2. To analyze how statistical uncertainty grows when the Hamiltonians differ, model the energy difference $\\Delta U(\\mathbf{x}) \\equiv U_{1}(\\mathbf{x}) - U_{\\lambda_i}(\\mathbf{x})$ under the sampling distribution $p_i(\\mathbf{x})$ as a Gaussian random variable with mean zero and variance $(\\Delta U)^2$, where $\\Delta U$ denotes the root-mean-square energy difference under $p_i(\\mathbf{x})$. Using only properties of the Gaussian moment-generating function and standard importance-sampling variance analysis, show how the dispersion of the weights controls the effective sample size. Then, express the asymptotic variance inflation factor $g(\\beta,\\Delta U)$, defined as the ratio of the asymptotic variance of the self-normalized importance-sampling estimator of $\\langle A \\rangle_{1}$ based on $N_i$ samples at $\\lambda_i$ to the asymptotic variance of the naive sample mean computed from $N_i$ independent samples drawn directly at $\\lambda=1$, as a closed-form analytic function of $\\beta$ and $\\Delta U$.\n\nGive your final answer as a single closed-form expression for $g(\\beta,\\Delta U)$. No numerical evaluation is required. If you introduce any acronyms, write out their full names on first use. The final answer is dimensionless; do not include units.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n- A classical molecular system is simulated in the canonical ensemble at inverse temperature $\\beta$.\n- A family of Hamiltonians $U_{\\lambda}(\\mathbf{x})$ is parameterized by $\\lambda \\in [0,1]$.\n- A set of $N_i$ independent configurations $\\{\\mathbf{x}^{(n)}\\}_{n=1}^{N_i}$ is given.\n- These configurations are drawn from the canonical distribution corresponding to $\\lambda_i$, with probability density $p_i(\\mathbf{x}) \\propto \\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]$.\n- The goal is to estimate the canonical average of a bounded observable $A(\\mathbf{x})$ at $\\lambda=1$, denoted $\\langle A \\rangle_{1}$.\n- The definition of the canonical average is $\\langle A \\rangle_{1} = Z_1^{-1} \\int \\mathrm{d}\\mathbf{x}\\, A(\\mathbf{x}) \\exp[-\\beta U_{1}(\\mathbf{x})]$, where $Z_1 = \\int \\mathrm{d}\\mathbf{x}\\, \\exp[-\\beta U_{1}(\\mathbf{x})]$.\n- A model for the energy difference is given: $\\Delta U(\\mathbf{x}) \\equiv U_{1}(\\mathbf{x}) - U_{\\lambda_i}(\\mathbf{x})$, when sampled from $p_i(\\mathbf{x})$, is a Gaussian random variable with mean zero and variance $(\\Delta U)^2$. $\\Delta U$ is the root-mean-square energy difference under $p_i(\\mathbf{x})$.\n- The asymptotic variance inflation factor is defined as $g(\\beta,\\Delta U) = \\frac{\\text{Var}[\\hat{A}_{1, \\text{SNIS}}]}{\\text{Var}[\\hat{A}_{1, \\text{naive}}]}$, where $\\hat{A}_{1, \\text{SNIS}}$ is the self-normalized importance-sampling estimator and $\\hat{A}_{1, \\text{naive}}$ is the naive sample mean from $N_i$ samples drawn directly at $\\lambda=1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria:\n- **Scientifically Grounded**: The problem is firmly rooted in the principles of statistical mechanics and computational science, specifically concerning enhanced sampling methods like importance sampling. The concepts of canonical ensembles, Hamiltonians, and partition functions are fundamental. The use of a Gaussian model for energy fluctuations is a widely used and valid approximation (central limit theorem motivation) for analyzing the efficiency of such methods.\n- **Well-Posed**: The problem is clearly structured with two distinct tasks. All necessary definitions, variables, and conditions are provided to derive the required expressions. The objective is unambiguous.\n- **Objective**: The language is precise and free of subjective or ambiguous terminology.\nThe problem is found to be self-contained, consistent, and scientifically sound. It does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n## Solution\n\n### Part 1: Derivation of the Self-Normalized Importance-Sampling Estimator\n\nThe canonical average of an observable $A(\\mathbf{x})$ at parameter $\\lambda=1$ is defined as the ratio of two integrals:\n$$\n\\langle A \\rangle_{1} = \\frac{\\int \\mathrm{d}\\mathbf{x}\\, A(\\mathbf{x}) \\exp[-\\beta U_{1}(\\mathbf{x})]}{\\int \\mathrm{d}\\mathbf{x}\\, \\exp[-\\beta U_{1}(\\mathbf{x})]} = \\frac{N}{D}\n$$\nThe samples are drawn from the distribution corresponding to parameter $\\lambda_i$, which has the probability density function:\n$$\np_i(\\mathbf{x}) = \\frac{\\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]}{Z_i}\n$$\nwhere $Z_i = \\int \\mathrm{d}\\mathbf{x}\\, \\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]$ is the partition function at $\\lambda_i$.\n\nTo re-express the integrals in terms of an expectation value with respect to $p_i(\\mathbf{x})$, we use the identity $\\mathrm{d}\\mathbf{x} = \\frac{Z_i}{\\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]} p_i(\\mathbf{x}) \\mathrm{d}\\mathbf{x}$. We apply this to the numerator $N$:\n$$\nN = \\int \\mathrm{d}\\mathbf{x}\\, A(\\mathbf{x}) \\exp[-\\beta U_{1}(\\mathbf{x})] \\frac{\\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]}{\\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]}\n$$\n$$\nN = \\int \\mathrm{d}\\mathbf{x}\\, A(\\mathbf{x}) \\exp[-\\beta (U_{1}(\\mathbf{x}) - U_{\\lambda_i}(\\mathbf{x}))] \\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]\n$$\nLet us define the unnormalized importance weight function as $w_u(\\mathbf{x}) = \\exp[-\\beta (U_{1}(\\mathbf{x}) - U_{\\lambda_i}(\\mathbf{x}))]$. The expression for $N$ becomes:\n$$\nN = \\int \\mathrm{d}\\mathbf{x}\\, A(\\mathbf{x}) w_u(\\mathbf{x}) \\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]\n$$\nMultiplying and dividing by $Z_i$, we can write this as an expectation value over $p_i(\\mathbf{x})$:\n$$\nN = Z_i \\int \\mathrm{d}\\mathbf{x}\\, A(\\mathbf{x}) w_u(\\mathbf{x}) \\left(\\frac{\\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]}{Z_i}\\right) = Z_i \\int \\mathrm{d}\\mathbf{x}\\, A(\\mathbf{x}) w_u(\\mathbf{x}) p_i(\\mathbf{x}) = Z_i \\langle A w_u \\rangle_i\n$$\nSimilarly, for the denominator $D = Z_1$:\n$$\nD = \\int \\mathrm{d}\\mathbf{x}\\, \\exp[-\\beta U_{1}(\\mathbf{x})] = \\int \\mathrm{d}\\mathbf{x}\\, w_u(\\mathbf{x}) \\exp[-\\beta U_{\\lambda_i}(\\mathbf{x})]\n$$\n$$\nD = Z_i \\int \\mathrm{d}\\mathbf{x}\\, w_u(\\mathbf{x}) p_i(\\mathbf{x}) = Z_i \\langle w_u \\rangle_i\n$$\nCombining the expressions for $N$ and $D$, we find the exact relation:\n$$\n\\langle A \\rangle_{1} = \\frac{Z_i \\langle A w_u \\rangle_i}{Z_i \\langle w_u \\rangle_i} = \\frac{\\langle A w_u \\rangle_i}{\\langle w_u \\rangle_i}\n$$\nTo obtain an estimator from a finite sample of $N_i$ configurations $\\{\\mathbf{x}^{(n)}\\}_{n=1}^{N_i}$ drawn from $p_i(\\mathbf{x})$, we replace the ensemble averages $\\langle \\cdot \\rangle_i$ with their corresponding sample averages. Let $A^{(n)} = A(\\mathbf{x}^{(n)})$ and $w_u^{(n)} = w_u(\\mathbf{x}^{(n)})$. The sample average of a quantity $f(\\mathbf{x})$ is $\\frac{1}{N_i}\\sum_{n=1}^{N_i} f(\\mathbf{x}^{(n)})$.\nThe estimator for $\\langle A \\rangle_1$, denoted $\\hat{A}_1$, is:\n$$\n\\hat{A}_1 = \\frac{\\frac{1}{N_i}\\sum_{n=1}^{N_i} A^{(n)} w_u^{(n)}}{\\frac{1}{N_i}\\sum_{n=1}^{N_i} w_u^{(n)}} = \\frac{\\sum_{n=1}^{N_i} A^{(n)} w_u^{(n)}}{\\sum_{n=1}^{N_i} w_u^{(n)}}\n$$\nThis is the required self-normalized importance-sampling (SNIS) estimator.\n\n### Part 2: Derivation of the Variance Inflation Factor\n\nThe SNIS estimator is a ratio of two random variables, $\\hat{A}_1 = \\bar{Y}/\\bar{X}$, where $Y_n = A^{(n)} w_u^{(n)}$ and $X_n = w_u^{(n)}$ are sampled from the distribution $p_i(\\mathbf{x})$. Using the delta method, the asymptotic variance of this ratio estimator for large $N_i$ is given by:\n$$\n\\text{Var}[\\hat{A}_1] \\approx \\frac{1}{N_i} \\frac{\\text{Var}_i[(A - \\langle A \\rangle_1)w_u]}{\\langle w_u \\rangle_i^2} = \\frac{1}{N_i} \\frac{\\langle (A - \\langle A \\rangle_1)^2 w_u^2 \\rangle_i}{\\langle w_u \\rangle_i^2}\n$$\nThe problem's focus on how the \"dispersion of the weights controls the effective sample size\" implies a standard simplifying assumption: the fluctuations of the observable $A$ are uncorrelated with the fluctuations of the importance weights $w_u$ in the sampling ensemble. This leads to the approximation:\n$$\n\\langle (A - \\langle A \\rangle_1)^2 w_u^2 \\rangle_i \\approx \\langle (A - \\langle A \\rangle_1)^2 \\rangle_i \\langle w_u^2 \\rangle_i\n$$\nFurthermore, for states $\\lambda_i$ and $\\lambda=1$ that are not pathologically different, the variance of the observable is approximately constant: $\\langle (A - \\langle A \\rangle_1)^2 \\rangle_i \\approx \\langle (A - \\langle A \\rangle_1)^2 \\rangle_1 = \\text{Var}_1[A]$. With these assumptions, the variance of the SNIS estimator becomes:\n$$\n\\text{Var}[\\hat{A}_{1, \\text{SNIS}}] \\approx \\frac{1}{N_i} \\text{Var}_1[A] \\frac{\\langle w_u^2 \\rangle_i}{\\langle w_u \\rangle_i^2}\n$$\nThe naive sample mean estimator, calculated from $N_i$ samples drawn directly from $p_1(\\mathbf{x})$, has an asymptotic variance of:\n$$\n\\text{Var}[\\hat{A}_{1, \\text{naive}}] = \\frac{1}{N_i} \\text{Var}_1[A]\n$$\nThe asymptotic variance inflation factor $g(\\beta, \\Delta U)$ is the ratio of these two variances:\n$$\ng(\\beta, \\Delta U) = \\frac{\\text{Var}[\\hat{A}_{1, \\text{SNIS}}]}{\\text{Var}[\\hat{A}_{1, \\text{naive}}]} = \\frac{\\frac{1}{N_i} \\text{Var}_1[A] \\frac{\\langle w_u^2 \\rangle_i}{\\langle w_u \\rangle_i^2}}{\\frac{1}{N_i} \\text{Var}_1[A]} = \\frac{\\langle w_u^2 \\rangle_i}{\\langle w_u \\rangle_i^2}\n$$\nWe now evaluate the terms $\\langle w_u \\rangle_i$ and $\\langle w_u^2 \\rangle_i$ using the given model. The energy difference $\\delta U(\\mathbf{x}) \\equiv U_1(\\mathbf{x}) - U_{\\lambda_i}(\\mathbf{x})$ is a Gaussian random variable under the sampling distribution $p_i(\\mathbf{x})$ with mean $\\langle \\delta U \\rangle_i = 0$ and variance $\\text{Var}_i[\\delta U] = (\\Delta U)^2$. The unnormalized weight is $w_u(\\mathbf{x}) = \\exp[-\\beta \\delta U(\\mathbf{x})]$.\n\nThe required averages are moments of $\\exp(-\\beta \\delta U)$. These can be calculated using the moment-generating function (MGF) of a Gaussian distribution. For a Gaussian random variable $X$ with mean $\\mu$ and variance $\\sigma^2$, its MGF is $M_X(t) = \\langle \\exp(tX) \\rangle = \\exp(\\mu t + \\frac{1}{2}\\sigma^2 t^2)$.\nIn our case, the random variable is $\\delta U$, with $\\mu = 0$ and $\\sigma^2 = (\\Delta U)^2$. Its MGF is $M_{\\delta U}(t) = \\exp(\\frac{1}{2}(\\Delta U)^2 t^2)$.\n\nTo find $\\langle w_u \\rangle_i$, we evaluate the MGF at $t = -\\beta$:\n$$\n\\langle w_u \\rangle_i = \\langle \\exp(-\\beta \\delta U) \\rangle_i = M_{\\delta U}(-\\beta) = \\exp\\left(\\frac{1}{2}(\\Delta U)^2 (-\\beta)^2\\right) = \\exp\\left(\\frac{1}{2}\\beta^2 (\\Delta U)^2\\right)\n$$\nTo find $\\langle w_u^2 \\rangle_i$, we calculate the expectation of $(\\exp(-\\beta \\delta U))^2 = \\exp(-2\\beta \\delta U)$, which corresponds to evaluating the MGF at $t = -2\\beta$:\n$$\n\\langle w_u^2 \\rangle_i = \\langle \\exp(-2\\beta \\delta U) \\rangle_i = M_{\\delta U}(-2\\beta) = \\exp\\left(\\frac{1}{2}(\\Delta U)^2 (-2\\beta)^2\\right) = \\exp\\left(\\frac{1}{2}(\\Delta U)^2 (4\\beta^2)\\right) = \\exp\\left(2\\beta^2 (\\Delta U)^2\\right)\n$$\nFinally, we substitute these results into the expression for the variance inflation factor $g$:\n$$\ng(\\beta, \\Delta U) = \\frac{\\exp\\left(2\\beta^2 (\\Delta U)^2\\right)}{\\left(\\exp\\left(\\frac{1}{2}\\beta^2 (\\Delta U)^2\\right)\\right)^2} = \\frac{\\exp\\left(2\\beta^2 (\\Delta U)^2\\right)}{\\exp\\left(\\beta^2 (\\Delta U)^2\\right)}\n$$\n$$\ng(\\beta, \\Delta U) = \\exp\\left(2\\beta^2 (\\Delta U)^2 - \\beta^2 (\\Delta U)^2\\right) = \\exp\\left(\\beta^2 (\\Delta U)^2\\right)\n$$\nThis is the closed-form analytic function for the asymptotic variance inflation factor.",
            "answer": "$$\\boxed{\\exp\\left(\\beta^2 (\\Delta U)^2\\right)}$$"
        }
    ]
}