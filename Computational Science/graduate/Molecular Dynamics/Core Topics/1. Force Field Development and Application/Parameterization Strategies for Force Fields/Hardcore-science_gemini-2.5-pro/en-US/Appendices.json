{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of force field development is the parameterization of bonded terms, which model the covalent structure of molecules. These parameters are typically derived by fitting simple analytical functions to a more accurate quantum mechanical (QM) potential energy surface. This exercise provides a foundational look into this process by simulating a QM scan around the equilibrium geometry of a molecule and using the resulting energy data to derive harmonic force constants for bond stretching and angle bending . By working through this, you will gain direct insight into the harmonic approximation and its role in translating first-principles information into a classical model.",
            "id": "3432394",
            "problem": "Consider a triatomic molecule with one bond length $r$ and one bond angle $\\theta$ as the relevant internal coordinates for a simple valence force field in Molecular Dynamics (MD). At the equilibrium geometry $(r_0,\\theta_0)$, a constrained electronic-structure scan is performed in which only one internal coordinate is displaced at a time while the other is held at its equilibrium value. The resulting potential energy differences relative to the minimum, $\\Delta E \\equiv E(r,\\theta)-E(r_0,\\theta_0)$, are reported below.\n\nBond-length scan (with $\\theta=\\theta_0$ fixed):\n- $\\Delta r = r-r_0 = \\pm 0.010$ nm gives $\\Delta E = 0.0750$ kJ mol$^{-1}$,\n- $\\Delta r = \\pm 0.020$ nm gives $\\Delta E = 0.3000$ kJ mol$^{-1}$,\n- $\\Delta r = \\pm 0.030$ nm gives $\\Delta E = 0.6750$ kJ mol$^{-1}$.\n\nAngle scan (with $r=r_0$ fixed):\n- $\\Delta \\theta = \\theta-\\theta_0 = \\pm 0.05$ rad gives $\\Delta E = 0.4375$ kJ mol$^{-1}$,\n- $\\Delta \\theta = \\pm 0.08$ rad gives $\\Delta E = 1.1200$ kJ mol$^{-1}$,\n- $\\Delta \\theta = \\pm 0.10$ rad gives $\\Delta E = 1.7500$ kJ mol$^{-1}$.\n\nStarting from the definition of a Taylor expansion of the potential energy $E(r,\\theta)$ about the minimum in internal coordinates and the condition that the gradient vanishes at the minimum, derive how the curvature along $r$ and the curvature along $\\theta$ define the harmonic valence force constants in the internal-coordinate representation used in a valence force field. Under the usual small-displacement assumptions, estimate the bond-stretch force constant $k_b$ and the angle-bend force constant $k_{\\theta}$ from the data above.\n\nDiscuss the physical approximations involved in making these estimates, including any assumptions about coupling between internal coordinates and the truncation of the Taylor series.\n\nRound your numerical estimates to four significant figures. Report $k_b$ in kJ mol$^{-1}$ nm$^{-2}$ and $k_{\\theta}$ in kJ mol$^{-1}$ rad$^{-2}$. Provide both values in your final answer as a row matrix in the order $(k_b, k_{\\theta})$, using the LaTeX `pmatrix` environment.",
            "solution": "The potential energy surface $E(r, \\theta)$ of the triatomic molecule can be approximated by a Taylor series expansion around the equilibrium geometry $(r_0, \\theta_0)$. Let $\\Delta r = r-r_0$ and $\\Delta \\theta = \\theta-\\theta_0$. The expansion is:\n$$\nE(r, \\theta) = E(r_0, \\theta_0) + \\left(\\frac{\\partial E}{\\partial r}\\right)_0 \\Delta r + \\left(\\frac{\\partial E}{\\partial \\theta}\\right)_0 \\Delta \\theta + \\frac{1}{2}\\left(\\frac{\\partial^2 E}{\\partial r^2}\\right)_0 (\\Delta r)^2 + \\frac{1}{2}\\left(\\frac{\\partial^2 E}{\\partial \\theta^2}\\right)_0 (\\Delta \\theta)^2 + \\left(\\frac{\\partial^2 E}{\\partial r \\partial \\theta}\\right)_0 \\Delta r \\Delta \\theta + \\mathcal{O}(3)\n$$\nwhere the subscript $0$ denotes evaluation at the equilibrium point $(r_0, \\theta_0)$, and $\\mathcal{O}(3)$ represents terms of third order and higher in the displacements.\n\nBy definition, the equilibrium geometry corresponds to a minimum on the potential energy surface. At a minimum, the gradient of the potential energy vanishes. Therefore, the first-order derivative terms are zero:\n$$\n\\left(\\frac{\\partial E}{\\partial r}\\right)_0 = 0 \\quad \\text{and} \\quad \\left(\\frac{\\partial E}{\\partial \\theta}\\right)_0 = 0\n$$\nRearranging the Taylor series to express the energy difference $\\Delta E = E(r, \\theta) - E(r_0, \\theta_0)$ and truncating at the second-order terms (the harmonic approximation), we get:\n$$\n\\Delta E \\approx \\frac{1}{2}\\left(\\frac{\\partial^2 E}{\\partial r^2}\\right)_0 (\\Delta r)^2 + \\frac{1}{2}\\left(\\frac{\\partial^2 E}{\\partial \\theta^2}\\right)_0 (\\Delta \\theta)^2 + \\left(\\frac{\\partial^2 E}{\\partial r \\partial \\theta}\\right)_0 \\Delta r \\Delta \\theta\n$$\nA simple valence force field models the potential energy associated with bond stretching and angle bending using harmonic functions:\n$$\nE_{VFF} = E_0 + \\frac{1}{2} k_b (r-r_0)^2 + \\frac{1}{2} k_{\\theta} (\\theta-\\theta_0)^2\n$$\nor in terms of displacements, $\\Delta E_{VFF} = \\frac{1}{2} k_b (\\Delta r)^2 + \\frac{1}{2} k_{\\theta} (\\Delta \\theta)^2$.\n\nBy comparing the truncated Taylor expansion with the valence force field energy expression, we can identify the force constants as the second derivatives (curvatures) of the potential energy surface at the equilibrium geometry:\n$$\nk_b = \\left(\\frac{\\partial^2 E}{\\partial r^2}\\right)_0 \\quad \\text{and} \\quad k_{\\theta} = \\left(\\frac{\\partial^2 E}{\\partial \\theta^2}\\right)_0\n$$\nThis derivation explicitly assumes that the coupling term, characterized by the mixed partial derivative $\\left(\\frac{\\partial^2 E}{\\partial r \\partial \\theta}\\right)_0$, is negligible.\n\nWe now estimate these force constants using the provided data.\n\n**Estimation of the Bond-Stretch Force Constant, $k_b$**\n\nThe bond-length scan is performed with $\\theta = \\theta_0$, which means $\\Delta \\theta = 0$. Under this condition, the energy expression simplifies to:\n$$\n\\Delta E = \\frac{1}{2} k_b (\\Delta r)^2\n$$\nThis can be rearranged to solve for $k_b$:\n$$\nk_b = \\frac{2 \\Delta E}{(\\Delta r)^2}\n$$\nWe can use any of the provided data points to calculate $k_b$. Let's use the first data point: $\\Delta r = 0.010$ nm and $\\Delta E = 0.0750$ kJ mol$^{-1}$.\n$$\nk_b = \\frac{2 \\times (0.0750 \\text{ kJ mol}^{-1})}{(0.010 \\text{ nm})^2} = \\frac{0.1500 \\text{ kJ mol}^{-1}}{0.0001 \\text{ nm}^2} = 1500 \\text{ kJ mol}^{-1} \\text{nm}^{-2}\n$$\nChecking the other data points confirms this value:\nFor $\\Delta r = 0.020$ nm: $k_b = \\frac{2 \\times 0.3000}{0.0004} = 1500$ kJ mol$^{-1}$ nm$^{-2}$.\nFor $\\Delta r = 0.030$ nm: $k_b = \\frac{2 \\times 0.6750}{0.0009} = 1500$ kJ mol$^{-1}$ nm$^{-2}$.\nThe data perfectly fits a quadratic potential, so our estimate for $k_b$ is $1500$ kJ mol$^{-1}$ nm$^{-2}$. Expressed to four significant figures, this is $1.500 \\times 10^3$ kJ mol$^{-1}$ nm$^{-2}$.\n\n**Estimation of the Angle-Bend Force Constant, $k_{\\theta}$**\n\nThe angle scan is performed with $r = r_0$, which means $\\Delta r = 0$. The energy expression simplifies to:\n$$\n\\Delta E = \\frac{1}{2} k_{\\theta} (\\Delta \\theta)^2\n$$\nRearranging for $k_{\\theta}$:\n$$\nk_{\\theta} = \\frac{2 \\Delta E}{(\\Delta \\theta)^2}\n$$\nUsing the first data point: $\\Delta \\theta = 0.05$ rad and $\\Delta E = 0.4375$ kJ mol$^{-1}$.\n$$\nk_{\\theta} = \\frac{2 \\times (0.4375 \\text{ kJ mol}^{-1})}{(0.05 \\text{ rad})^2} = \\frac{0.875 \\text{ kJ mol}^{-1}}{0.0025 \\text{ rad}^2} = 350 \\text{ kJ mol}^{-1} \\text{rad}^{-2}\n$$\nChecking the other data points:\nFor $\\Delta \\theta = 0.08$ rad: $k_{\\theta} = \\frac{2 \\times 1.1200}{0.0064} = 350$ kJ mol$^{-1}$ rad$^{-2}$.\nFor $\\Delta \\theta = 0.10$ rad: $k_{\\theta} = \\frac{2 \\times 1.7500}{0.01} = 350$ kJ mol$^{-1}$ rad$^{-2}$.\nAgain, the data perfectly represents a harmonic potential. Our estimate for $k_{\\theta}$ is $350$ kJ mol$^{-1}$ rad$^{-2}$. To four significant figures, this is $350.0$ kJ mol$^{-1}$ rad$^{-2}$.\n\n**Discussion of Physical Approximations**\n\n1.  **Harmonic Approximation**: The primary approximation is the truncation of the Taylor series at the quadratic term. Real molecular potentials are anharmonic. For example, the bond-stretching potential is better described by functions like the Morse potential, which accounts for bond dissociation at large separations. The harmonic potential is only accurate for very small displacements from equilibrium. The fact that the provided data shows a perfect quadratic relationship ($\\Delta E \\propto (\\text{displacement})^2$) is an idealization; real electronic structure data would show deviations from this behavior, indicating the presence of higher-order (cubic, quartic, etc.) terms.\n\n2.  **Neglect of Coupling**: The simple valence force field and the calculation method assume that the bond stretch and angle bend motions are independent. This corresponds to setting the mixed-derivative term $\\left(\\frac{\\partial^2 E}{\\partial r \\partial \\theta}\\right)_0$, also known as the stretch-bend coupling constant $k_{r\\theta}$, to zero. In reality, these motions are coupled. For example, as a bond angle in a triatomic molecule decreases, the repulsion between the two terminal atoms increases, which can in turn affect the equilibrium lengths of the bonds connected to the central atom. The experimental design of scanning one coordinate while keeping the other fixed at its equilibrium value is specifically designed to probe the diagonal elements of the Hessian matrix (the matrix of second derivatives), and provides no information about the off-diagonal (coupling) terms.\n\n3.  **Idealized Data**: The problem provides data where the energy is identical for positive and negative displacements (e.g., $\\Delta r = \\pm 0.010$ nm). This implies the potential is perfectly symmetric about the minimum, which is only true if all odd-powered terms in the Taylor expansion are zero. While the first derivative is zero at the minimum, the third derivative is generally non-zero, leading to an asymmetric potential well. The provided data is thus artificially symmetric and perfectly quadratic, a convenience for this exercise that does not reflect the complexity of a true potential energy surface.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.500 \\times 10^3 & 350.0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While bonded parameters define intramolecular geometry, non-bonded interactions govern how molecules interact with each other. For systems with multiple atom types, it is impractical to parameterize every unique pairwise interaction explicitly. Instead, force fields employ mixing rules to generate parameters for unlike-atom interactions (e.g., A-B) from the known parameters of like-atom interactions (A-A and B-B) . This practice explores the formulation and consistency of several common mixing rules for the Lennard-Jones potential, revealing the physical and mathematical assumptions that enable the creation of transferable and computationally efficient non-bonded models.",
            "id": "3432322",
            "problem": "Consider two species $i$ and $j$ interacting via the Lennard-Jones (LJ) 12-6 potential, defined for any pair $(i,j)$ by $V_{ij}(r) = 4 \\epsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r} \\right)^{6} \\right]$, where $\\epsilon_{ij}$ is the well depth and $\\sigma_{ij}$ is the characteristic distance parameter. For a single species $k$, the attractive and repulsive coefficients associated with this LJ form are $C_{6,k} = 4 \\epsilon_{k} \\sigma_{k}^{6}$ and $C_{12,k} = 4 \\epsilon_{k} \\sigma_{k}^{12}$.\n\nIn parameterization strategies for force fields, the unlike interaction parameters $(\\epsilon_{ij}, \\sigma_{ij})$ are often obtained from the like parameters $(\\epsilon_{i}, \\sigma_{i})$ and $(\\epsilon_{j}, \\sigma_{j})$ via mixing rules. Three widely used options are the Lorentz-Berthelot (LB), Waldman-Hagler (WH), and Kong mixing rules. Starting from the definitions above and the physically motivated relationships between the coefficients $C_{6}$ and $C_{12}$ and the LJ parameters, impose the following two consistency conditions on any mixing rule:\n1. Symmetry under exchange: the unlike parameters must satisfy $f(\\epsilon_{i}, \\sigma_{i}; \\epsilon_{j}, \\sigma_{j}) = f(\\epsilon_{j}, \\sigma_{j}; \\epsilon_{i}, \\sigma_{i})$ for both $\\epsilon_{ij}$ and $\\sigma_{ij}$.\n2. Recovery of identical-species limits: when $i=j$, the unlike parameters must reduce to the like parameters, that is, $\\epsilon_{ii} = \\epsilon_{i}$ and $\\sigma_{ii} = \\sigma_{i}$.\n\nUsing these conditions and the fundamental relations for the LJ potential and its coefficients:\n- First, formulate and contrast the LB, WH, and Kong strategies in terms of the combinations they enforce for $C_{6,ij}$, $C_{12,ij}$, and/or moments of $\\sigma$.\n- Second, demonstrate for each strategy that both symmetry and identical-species limits are satisfied.\n- Finally, for the Waldman-Hagler (WH) case, assume the mixed coefficients satisfy $C_{6,ij} = \\sqrt{C_{6,i} C_{6,j}}$ and $C_{12,ij} = \\frac{1}{2}\\left(C_{12,i} + C_{12,j}\\right)$. Derive a single closed-form analytic expression for $\\sigma_{ij}$ in terms of $\\epsilon_{i}$, $\\sigma_{i}$, $\\epsilon_{j}$, and $\\sigma_{j}$.\n\nYour final answer must be a single closed-form analytic expression. No numerical calculation is required, and no rounding is needed. Do not include units in your final boxed answer.",
            "solution": "The Lennard-Jones (LJ) potential for an interaction between species $i$ and $j$ is given by\n$$V_{ij}(r) = 4 \\epsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r} \\right)^{6} \\right]$$\nThis can also be written in terms of repulsive and attractive coefficients, $C_{12,ij}$ and $C_{6,ij}$, as\n$$V_{ij}(r) = \\frac{C_{12,ij}}{r^{12}} - \\frac{C_{6,ij}}{r^{6}}$$\nBy comparing these two forms, we establish the fundamental relationships between the LJ parameters $(\\epsilon_{ij}, \\sigma_{ij})$ and the coefficients for any pair $(i,j)$:\n$C_{12,ij} = 4 \\epsilon_{ij} \\sigma_{ij}^{12}$\n$C_{6,ij} = 4 \\epsilon_{ij} \\sigma_{ij}^{6}$\n\nFrom these relations, we can express $\\epsilon_{ij}$ and $\\sigma_{ij}$ in terms of the coefficients:\nDividing the two coefficient expressions gives $\\frac{C_{12,ij}}{C_{6,ij}} = \\sigma_{ij}^{6}$, which leads to\n$$\\sigma_{ij} = \\left( \\frac{C_{12,ij}}{C_{6,ij}} \\right)^{\\frac{1}{6}}$$\nSubstituting this back into the expression for $C_{6,ij}$ yields $C_{6,ij} = 4 \\epsilon_{ij} \\left(\\frac{C_{12,ij}}{C_{6,ij}}\\right)$, which can be rearranged to find $\\epsilon_{ij}$:\n$$\\epsilon_{ij} = \\frac{C_{6,ij}^{2}}{4 C_{12,ij}}$$\nFor a single species $k$, these relations are $C_{12,k} = 4 \\epsilon_{k} \\sigma_{k}^{12}$ and $C_{6,k} = 4 \\epsilon_{k} \\sigma_{k}^{6}$.\n\nThe problem requires a three-part analysis of mixing rules.\n\n**Part 1: Formulation and Contrast of Mixing Rules**\n\nMixing rules are prescriptions for determining the unlike-pair interaction parameters $(\\epsilon_{ij}, \\sigma_{ij})$ from the like-pair parameters $(\\epsilon_i, \\sigma_i)$ and $(\\epsilon_j, \\sigma_j)$.\n\n1.  **Lorentz-Berthelot (LB) Rules:** This is the most common approach. It combines the size parameters ($\\sigma$) using an arithmetic mean and the energy parameters ($\\epsilon$) using a geometric mean.\n    -   $\\sigma_{ij} = \\frac{\\sigma_{i} + \\sigma_{j}}{2}$ (Lorentz rule)\n    -   $\\epsilon_{ij} = \\sqrt{\\epsilon_{i} \\epsilon_{j}}$ (Berthelot rule)\n\n2.  **Waldman-Hagler (WH) Rules:** As specified in the problem for the final derivation, this strategy combines the interaction coefficients $C_6$ and $C_{12}$ directly, rather than the primary LJ parameters. It applies a geometric mean to the attractive coefficient $C_6$ and an arithmetic mean to the repulsive coefficient $C_{12}$.\n    -   $C_{6,ij} = \\sqrt{C_{6,i} C_{6,j}}$\n    -   $C_{12,ij} = \\frac{1}{2}(C_{12,i} + C_{12,j})$\n    The parameters $\\epsilon_{ij}$ and $\\sigma_{ij}$ are then derived from these mixed coefficients.\n\n3.  **Kong Rules:** This set of rules is based on physical arguments involving the attractive term and the location of the potential minimum, $r_{m,k} = 2^{1/6}\\sigma_k$. It combines the $C_6$ coefficients geometrically and the potential minimum locations arithmetically.\n    -   $C_{6,ij} = \\sqrt{C_{6,i} C_{6,j}}$\n    -   $r_{m,ij} = \\frac{r_{m,i} + r_{m,j}}{2}$\n    Since $r_{m,k} \\propto \\sigma_k$, the rule for $r_{m,ij}$ is equivalent to an arithmetic mean for $\\sigma_{ij}$, i.e., $\\sigma_{ij} = \\frac{\\sigma_{i} + \\sigma_{j}}{2}$, identical to the Lorentz rule.\n\nThe contrast lies in the quantities being combined. LB rules combine $\\sigma$ and $\\epsilon$ directly. WH rules combine the potential coefficients $C_6$ and $C_{12}$. Kong rules combine $C_6$ and the potential minimum distance $r_m$.\n\n**Part 2: Demonstration of Symmetry and Identical-Species Limits**\n\nWe now verify that each set of rules satisfies the two consistency conditions.\n\n**Lorentz-Berthelot (LB):**\n-   **Symmetry:** $\\sigma_{ij} = \\frac{\\sigma_{i} + \\sigma_{j}}{2} = \\frac{\\sigma_{j} + \\sigma_{i}}{2} = \\sigma_{ji}$. $\\epsilon_{ij} = \\sqrt{\\epsilon_{i} \\epsilon_{j}} = \\sqrt{\\epsilon_{j} \\epsilon_{i}} = \\epsilon_{ji}$. The rules are symmetric by inspection.\n-   **Identical-species limit ($j=i$):** $\\sigma_{ii} = \\frac{\\sigma_{i} + \\sigma_{i}}{2} = \\sigma_{i}$. $\\epsilon_{ii} = \\sqrt{\\epsilon_{i} \\epsilon_{i}} = \\epsilon_{i}$. The condition is satisfied.\n\n**Waldman-Hagler (WH):**\n-   **Symmetry:** The coefficients are symmetric: $C_{6,ij} = \\sqrt{C_{6,i} C_{6,j}} = \\sqrt{C_{6,j} C_{6,i}} = C_{6,ji}$ and $C_{12,ij} = \\frac{1}{2}(C_{12,i} + C_{12,j}) = \\frac{1}{2}(C_{12,j} + C_{12,i}) = C_{12,ji}$. Since $\\epsilon_{ij}$ and $\\sigma_{ij}$ are functions of $C_{6,ij}$ and $C_{12,ij}$, they must also be symmetric under the exchange of $i$ and $j$.\n-   **Identical-species limit ($j=i$):** First, we check the coefficients: $C_{6,ii} = \\sqrt{C_{6,i} C_{6,i}} = C_{6,i}$ and $C_{12,ii} = \\frac{1}{2}(C_{12,i} + C_{12,i}) = C_{12,i}$. Now we use the general expressions for $\\sigma_{ij}$ and $\\epsilon_{ij}$:\n    -   $\\sigma_{ii} = \\left( \\frac{C_{12,ii}}{C_{6,ii}} \\right)^{\\frac{1}{6}} = \\left( \\frac{C_{12,i}}{C_{6,i}} \\right)^{\\frac{1}{6}} = \\sigma_{i}$.\n    -   $\\epsilon_{ii} = \\frac{C_{6,ii}^{2}}{4 C_{12,ii}} = \\frac{C_{6,i}^{2}}{4 C_{12,i}} = \\epsilon_{i}$.\n    The condition is satisfied.\n\n**Kong Rules:**\n-   **Symmetry:** As shown, the rule for $\\sigma_{ij}$ is identical to the Lorentz rule, which is symmetric. The rule for $C_{6,ij}$ is a geometric mean, which is also symmetric. To demonstrate symmetry for $\\epsilon_{ij}$, we must first derive its expression. We have $C_{6,ij} = 4 \\epsilon_{ij}\\sigma_{ij}^6$ and $C_{6,ij} = \\sqrt{C_{6,i}C_{6,j}}$.\n    $\\epsilon_{ij} = \\frac{C_{6,ij}}{4 \\sigma_{ij}^6} = \\frac{\\sqrt{C_{6,i}C_{6,j}}}{4 \\sigma_{ij}^6} = \\frac{\\sqrt{(4\\epsilon_i\\sigma_i^6)(4\\epsilon_j\\sigma_j^6)}}{4 (\\frac{\\sigma_i+\\sigma_j}{2})^6} = \\frac{4\\sqrt{\\epsilon_i\\epsilon_j}(\\sigma_i\\sigma_j)^3}{4 (\\frac{\\sigma_i+\\sigma_j}{2})^6} = \\sqrt{\\epsilon_i\\epsilon_j} \\frac{(\\sigma_i\\sigma_j)^3}{(\\frac{\\sigma_i+\\sigma_j}{2})^6}$.\n    This expression for $\\epsilon_{ij}$ is clearly symmetric under the exchange of indices $i$ and $j$.\n-   **Identical-species limit ($j=i$):** We have $\\sigma_{ii} = \\frac{\\sigma_i+\\sigma_i}{2} = \\sigma_i$. For $\\epsilon_{ii}$, we use the expression derived above:\n    $\\epsilon_{ii} = \\sqrt{\\epsilon_i\\epsilon_i} \\frac{(\\sigma_i\\sigma_i)^3}{(\\frac{\\sigma_i+\\sigma_i}{2})^6} = \\epsilon_i \\frac{\\sigma_i^6}{(\\sigma_i)^6} = \\epsilon_i$.\n    The condition is satisfied.\n\n**Part 3: Derivation of $\\sigma_{ij}$ for the Waldman-Hagler Case**\n\nThe goal is to find a closed-form expression for $\\sigma_{ij}$ in terms of the like-species parameters $(\\epsilon_i, \\sigma_i, \\epsilon_j, \\sigma_j)$. We start from the fundamental relation:\n$$\\sigma_{ij} = \\left( \\frac{C_{12,ij}}{C_{6,ij}} \\right)^{\\frac{1}{6}}$$\nWe are given the WH mixing rules for the coefficients:\n$C_{6,ij} = \\sqrt{C_{6,i} C_{6,j}}$\n$C_{12,ij} = \\frac{1}{2}(C_{12,i} + C_{12,j})$\n\nWe substitute these rules into the expression for $\\sigma_{ij}$:\n$$\\sigma_{ij} = \\left( \\frac{\\frac{1}{2}(C_{12,i} + C_{12,j})}{\\sqrt{C_{6,i} C_{6,j}}} \\right)^{\\frac{1}{6}}$$\nNext, we replace the like-species coefficients $C_{k}$ with their definitions in terms of $\\epsilon_k$ and $\\sigma_k$:\n$C_{6,k} = 4 \\epsilon_{k} \\sigma_{k}^{6}$\n$C_{12,k} = 4 \\epsilon_{k} \\sigma_{k}^{12}$\n\nLet's evaluate the numerator and denominator separately.\nThe numerator is:\n$$ \\frac{1}{2}(C_{12,i} + C_{12,j}) = \\frac{1}{2}(4 \\epsilon_{i} \\sigma_{i}^{12} + 4 \\epsilon_{j} \\sigma_{j}^{12}) = 2(\\epsilon_{i} \\sigma_{i}^{12} + \\epsilon_{j} \\sigma_{j}^{12}) $$\nThe denominator is:\n$$ \\sqrt{C_{6,i} C_{6,j}} = \\sqrt{(4 \\epsilon_{i} \\sigma_{i}^{6})(4 \\epsilon_{j} \\sigma_{j}^{6})} = \\sqrt{16 \\epsilon_{i} \\epsilon_{j} \\sigma_{i}^{6} \\sigma_{j}^{6}} = 4 \\sqrt{\\epsilon_{i} \\epsilon_{j}} (\\sigma_{i} \\sigma_{j})^{3} $$\nNow, we substitute these back into the expression for $\\sigma_{ij}$:\n$$ \\sigma_{ij} = \\left( \\frac{2(\\epsilon_{i} \\sigma_{i}^{12} + \\epsilon_{j} \\sigma_{j}^{12})}{4 \\sqrt{\\epsilon_{i} \\epsilon_{j}} \\sigma_{i}^{3} \\sigma_{j}^{3}} \\right)^{\\frac{1}{6}} $$\nSimplifying the constant factor gives the final analytical expression:\n$$ \\sigma_{ij} = \\left( \\frac{\\epsilon_{i} \\sigma_{i}^{12} + \\epsilon_{j} \\sigma_{j}^{12}}{2 \\sqrt{\\epsilon_{i} \\epsilon_{j}} \\sigma_{i}^{3} \\sigma_{j}^{3}} \\right)^{\\frac{1}{6}} $$",
            "answer": "$$\n\\boxed{\n\\left( \\frac{\\epsilon_{i} \\sigma_{i}^{12} + \\epsilon_{j} \\sigma_{j}^{12}}{2 \\sqrt{\\epsilon_{i} \\epsilon_{j}} \\sigma_{i}^{3} \\sigma_{j}^{3}} \\right)^{\\frac{1}{6}}\n}\n$$"
        },
        {
            "introduction": "The ultimate test of a force field is its ability to reproduce experimental observables. Parameters derived from gas-phase QM calculations, especially electrostatic charges, often require refinement to accurately model the complex environment of a condensed phase, where effects like electronic polarization are significant. This practice demonstrates a powerful validation and refinement technique: adjusting atomic partial charges to match an experimentally measured bulk property, the static dielectric constant . By connecting the microscopic dipole moment fluctuations to a macroscopic property, you will learn how empirical data is used to improve force field accuracy for condensed-phase simulations.",
            "id": "3432376",
            "problem": "You are given the fluctuation expression for the static dielectric constant of a polar liquid under conducting boundary conditions derived from linear response theory, which reads in Gaussian centimeter-gram-second (cgs) units as $\\varepsilon=1+\\frac{4\\pi}{3 V k_B T}\\left(\\langle \\mathbf{M}^2\\rangle-\\langle \\mathbf{M}\\rangle^2\\right)$, where $\\mathbf{M}$ is the instantaneous total dipole moment of the simulation cell, $V$ is the cell volume, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. In parameterization strategies for empirical force fields, it is common to scale gas-phase Restrained Electrostatic Potential (RESP) charges by a uniform factor $s$ to mimic condensed-phase polarization effects. Assume the following physically justified linearity: for a fixed set of nuclear positions sampled from an equilibrium trajectory at charge scaling factor $s=1$, scaling all partial charges by $s$ scales each instantaneous total dipole vector as $\\mathbf{M}\\mapsto s\\mathbf{M}$ and hence $\\langle \\mathbf{M}\\rangle\\mapsto s\\langle \\mathbf{M}\\rangle$ and $\\langle \\mathbf{M}^2\\rangle\\mapsto s^2\\langle \\mathbf{M}^2\\rangle$. Under this linear-response approximation, you must quantify how $\\varepsilon$ depends on $s$ and determine the charge scaling factor $s$ that would match a given experimental dielectric constant.\n\nYour task is to write a program that, for each test case, performs the following steps using Gaussian centimeter-gram-second (cgs) units consistent with the provided fluctuation expression:\n- Convert all input quantities to cgs units as needed. Use $1\\,\\mathrm{D}=10^{-18}\\,\\mathrm{statC}\\cdot\\mathrm{cm}$, $1\\,\\mathrm{nm}=10^{-7}\\,\\mathrm{cm}$, and $k_B=1.380649\\times 10^{-16}\\,\\mathrm{erg/K}$.\n- Compute the variance $\\mathrm{Var}(\\mathbf{M})=\\langle \\mathbf{M}^2\\rangle-|\\langle \\mathbf{M}\\rangle|^2$ from the provided $\\langle \\mathbf{M}^2\\rangle$ (in $\\mathrm{D}^2$) and the provided Cartesian components of $\\langle \\mathbf{M}\\rangle$ (in $\\mathrm{D}$), then convert $\\mathrm{Var}(\\mathbf{M})$ to cgs units.\n- Evaluate the baseline dielectric constant at $s=1$ as $\\varepsilon(1)=1+\\frac{4\\pi}{3 V k_B T}\\,\\mathrm{Var}(\\mathbf{M})$.\n- Using the linear scaling assumption, derive and evaluate $\\varepsilon(s)$ for general $s$.\n- Given a target experimental dielectric constant $\\varepsilon_{\\mathrm{exp}}$ (dimensionless), compute the scaling factor $s^\\star$ that matches $\\varepsilon(s^\\star)=\\varepsilon_{\\mathrm{exp}}$.\n\nYour program must process the following test suite. Each test case is specified as a tuple $(V_{\\mathrm{nm}^3}, T_{\\mathrm{K}}, \\langle \\mathbf{M}\\rangle_{\\mathrm{D}}, \\langle \\mathbf{M}^2\\rangle_{\\mathrm{D}^2}, \\varepsilon_{\\mathrm{exp}})$, where $V_{\\mathrm{nm}^3}$ is the cell volume in $\\mathrm{nm}^3$, $T_{\\mathrm{K}}$ is the temperature in $\\mathrm{K}$, $\\langle \\mathbf{M}\\rangle_{\\mathrm{D}}$ is a 3-component list of the Cartesian components of the average total dipole in $\\mathrm{D}$, $\\langle \\mathbf{M}^2\\rangle_{\\mathrm{D}^2}$ is the average squared magnitude of the total dipole in $\\mathrm{D}^2$, and $\\varepsilon_{\\mathrm{exp}}$ is the target experimental dielectric constant (dimensionless):\n- Case 1 (happy path): $(30.0, 300.0, [5.0, 6.0, 3.0], 6000.0, 35.0)$.\n- Case 2 (reduction needed): $(27.0, 298.0, [10.0, 5.0, 5.0], 13150.0, 20.0)$.\n- Case 3 (weakly polar baseline): $(100.0, 298.0, [1.0, 2.0, 2.0], 500.0, 2.0)$.\n- Case 4 (near match): $(50.0, 350.0, [5.0, 6.0, 3.0], 5840.0, 11.003351)$.\n\nAll physical quantities must be handled consistently in cgs as defined above. Angles are not involved. The program must output, for each test case in the given order, the proposed scaling factor $s^\\star$ as a floating-point number rounded to 6 decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example `[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]`.",
            "solution": "The primary objective is to determine a uniform charge scaling factor, $s$, that adjusts the partial charges of a molecular model to make its computed static dielectric constant, $\\varepsilon(s)$, match a target experimental value, $\\varepsilon_{\\mathrm{exp}}$. The starting point is the fluctuation formula for the dielectric constant, $\\varepsilon$, in Gaussian cgs units for a simulation under conducting boundary conditions:\n$$\n\\varepsilon = 1 + \\frac{4\\pi}{3 V k_B T} \\left( \\langle \\mathbf{M}^2 \\rangle - |\\langle \\mathbf{M} \\rangle|^2 \\right)\n$$\nHere, $V$ is the simulation cell volume, $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, $\\mathbf{M}$ is the instantaneous total dipole moment of the cell, $\\langle \\mathbf{M}^2 \\rangle$ is the mean squared magnitude of the total dipole moment, and $|\\langle \\mathbf{M} \\rangle|^2$ is the squared magnitude of the mean total dipole moment. The term $\\langle \\mathbf{M}^2 \\rangle - |\\langle \\mathbf{M} \\rangle|^2$ represents the variance of the total dipole moment vector, $\\mathrm{Var}(\\mathbf{M})$.\n\nThe problem posits a linear response approximation: scaling all atomic partial charges by a factor $s$ results in a corresponding scaling of the instantaneous total dipole moment, $\\mathbf{M} \\mapsto s\\mathbf{M}$. We denote the quantities at the baseline scaling of $s=1$ with a subscript $1$, so $\\mathbf{M}_1$ is the instantaneous dipole moment from the unscaled simulation trajectory. For a general scaling factor $s$, the instantaneous dipole is $\\mathbf{M}_s = s\\mathbf{M}_1$.\n\nWe can express the expectation values for the scaled system in terms of the baseline system:\nThe mean total dipole scales as $\\langle \\mathbf{M}_s \\rangle = \\langle s\\mathbf{M}_1 \\rangle = s\\langle \\mathbf{M}_1 \\rangle$.\nThe mean squared total dipole scales as $\\langle \\mathbf{M}_s^2 \\rangle = \\langle (s\\mathbf{M}_1) \\cdot (s\\mathbf{M}_1) \\rangle = \\langle s^2 (\\mathbf{M}_1 \\cdot \\mathbf{M}_1) \\rangle = s^2 \\langle \\mathbf{M}_1^2 \\rangle$.\n\nSubstituting these into the fluctuation formula gives the dielectric constant as a function of $s$:\n$$\n\\varepsilon(s) = 1 + \\frac{4\\pi}{3 V k_B T} \\left( \\langle \\mathbf{M}_s^2 \\rangle - |\\langle \\mathbf{M}_s \\rangle|^2 \\right)\n$$\n$$\n\\varepsilon(s) = 1 + \\frac{4\\pi}{3 V k_B T} \\left( s^2 \\langle \\mathbf{M}_1^2 \\rangle - |s\\langle \\mathbf{M}_1 \\rangle|^2 \\right)\n$$\n$$\n\\varepsilon(s) = 1 + \\frac{4\\pi}{3 V k_B T} \\left( s^2 \\langle \\mathbf{M}_1^2 \\rangle - s^2 |\\langle \\mathbf{M}_1 \\rangle|^2 \\right)\n$$\n$$\n\\varepsilon(s) = 1 + s^2 \\left[ \\frac{4\\pi}{3 V k_B T} \\left( \\langle \\mathbf{M}_1^2 \\rangle - |\\langle \\mathbf{M}_1 \\rangle|^2 \\right) \\right]\n$$\nThe term in the square brackets is simply the fluctuating part of the dielectric constant at the baseline scaling, i.e., $\\varepsilon(1) - 1$. Therefore, we arrive at the simple quadratic relationship:\n$$\n\\varepsilon(s) = 1 + s^2 (\\varepsilon(1) - 1)\n$$\nOur goal is to find the scaling factor, which we will call $s^\\star$, such that $\\varepsilon(s^\\star) = \\varepsilon_{\\mathrm{exp}}$. Setting up this equality and solving for $s^\\star$:\n$$\n\\varepsilon_{\\mathrm{exp}} = 1 + (s^\\star)^2 (\\varepsilon(1) - 1)\n$$\n$$\n\\varepsilon_{\\mathrm{exp}} - 1 = (s^\\star)^2 (\\varepsilon(1) - 1)\n$$\n$$\n(s^\\star)^2 = \\frac{\\varepsilon_{\\mathrm{exp}} - 1}{\\varepsilon(1) - 1}\n$$\nAssuming the physically reasonable scenario where a real, positive scaling factor $s^\\star$ is sought, we take the positive square root:\n$$\ns^\\star = \\sqrt{\\frac{\\varepsilon_{\\mathrm{exp}} - 1}{\\varepsilon(1) - 1}}\n$$\nThis is the central equation for our calculation. A scaling factor $s^\\star > 1$ is required if the model underestimates the dielectric constant ($\\varepsilon(1) < \\varepsilon_{\\mathrm{exp}}$), and $s^\\star < 1$ is required if it overestimates ($\\varepsilon(1) > \\varepsilon_{\\mathrm{exp}}$).\n\nThe computational procedure for each test case is as follows, adhering strictly to cgs units:\n1.  Define the necessary physical constants and conversion factors:\n    - Boltzmann constant: $k_B = 1.380649 \\times 10^{-16}\\,\\mathrm{erg/K}$.\n    - Debye to cgs: $1\\,\\mathrm{D} = 10^{-18}\\,\\mathrm{statC}\\cdot\\mathrm{cm}$.\n    - Nanometer to cm: $1\\,\\mathrm{nm} = 10^{-7}\\,\\mathrm{cm}$.\n2.  Convert the input volume $V_{\\mathrm{nm}^3}$ to cgs units ($\\mathrm{cm}^3$): $V_{\\mathrm{cgs}} = V_{\\mathrm{nm}^3} \\times (10^{-7})^3 = V_{\\mathrm{nm}^3} \\times 10^{-21}\\,\\mathrm{cm}^3$. The temperature $T_{\\mathrm{K}}$ is already in a base cgs unit (Kelvin).\n3.  Calculate the variance of the baseline dipole moment, $\\mathrm{Var}(\\mathbf{M}_1)$, in units of $\\mathrm{D}^2$. The input provides $\\langle \\mathbf{M}_1^2 \\rangle$ in $\\mathrm{D}^2$ and the Cartesian components of $\\langle \\mathbf{M}_1 \\rangle$ in $\\mathrm{D}$. First, compute the squared magnitude of the average dipole: $|\\langle \\mathbf{M}_1 \\rangle|^2 = \\langle M_{1,x} \\rangle^2 + \\langle M_{1,y} \\rangle^2 + \\langle M_{1,z} \\rangle^2$. Then, the variance is $\\mathrm{Var}(\\mathbf{M}_1)_{\\mathrm{D}^2} = \\langle \\mathbf{M}_1^2 \\rangle - |\\langle \\mathbf{M}_1 \\rangle|^2$.\n4.  Convert the variance to cgs units. The cgs unit of dipole moment is $\\mathrm{statC}\\cdot\\mathrm{cm}$. The square of this unit is $(\\mathrm{statC}\\cdot\\mathrm{cm})^2$. Since $\\mathrm{erg} = \\mathrm{statC}^2/\\mathrm{cm}$, it follows that $\\mathrm{statC}^2 = \\mathrm{erg}\\cdot\\mathrm{cm}$, and thus $(\\mathrm{statC}\\cdot\\mathrm{cm})^2 = \\mathrm{erg}\\cdot\\mathrm{cm}^3$. The conversion is:\n    $$\n    \\mathrm{Var}(\\mathbf{M}_1)_{\\mathrm{cgs}} = \\mathrm{Var}(\\mathbf{M}_1)_{\\mathrm{D}^2} \\times (10^{-18})^2 = \\mathrm{Var}(\\mathbf{M}_1)_{\\mathrm{D}^2} \\times 10^{-36} \\, \\mathrm{erg}\\cdot\\mathrm{cm}^3\n    $$\n5.  Calculate the baseline term $\\varepsilon(1) - 1$:\n    $$\n    \\varepsilon(1) - 1 = \\frac{4\\pi}{3 V_{\\mathrm{cgs}} k_B T_{\\mathrm{K}}} \\mathrm{Var}(\\mathbf{M}_1)_{\\mathrm{cgs}}\n    $$\n6.  Finally, compute the required scaling factor $s^\\star$ using the derived formula:\n    $$\n    s^\\star = \\sqrt{\\frac{\\varepsilon_{\\mathrm{exp}} - 1}{\\varepsilon(1) - 1}}\n    $$\nThe result is then rounded to $6$ decimal places as specified. This procedure is applied systematically to each provided test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the charge scaling factor s* required to match an experimental\n    dielectric constant based on a linear response approximation. All calculations\n    are performed in cgs units.\n    \"\"\"\n    \n    # Define physical constants in cgs units.\n    # Boltzmann constant in erg/K.\n    KB_CGS = 1.380649e-16\n    \n    # Define unit conversion factors.\n    # 1 Debye = 1e-18 statC*cm.\n    D_TO_CGS_DIPOLE = 1e-18\n    # 1 nm = 1e-7 cm.\n    NM_TO_CM = 1e-7\n\n    # Define the test cases from the problem statement.\n    # (V_nm^3, T_K, <M>_D, <M^2>_D^2, eps_exp)\n    test_cases = [\n        (30.0, 300.0, [5.0, 6.0, 3.0], 6000.0, 35.0),\n        (27.0, 298.0, [10.0, 5.0, 5.0], 13150.0, 20.0),\n        (100.0, 298.0, [1.0, 2.0, 2.0], 500.0, 2.0),\n        (50.0, 350.0, [5.0, 6.0, 3.0], 5840.0, 11.003351),\n    ]\n\n    results = []\n    for case in test_cases:\n        V_nm3, T_K, M_avg_components_D, M2_avg_D2, eps_exp = case\n        \n        # 1. Convert input quantities to cgs units.\n        # Volume from nm^3 to cm^3.\n        V_cgs = V_nm3 * (NM_TO_CM ** 3)\n        \n        # 2. Compute the dipole variance in D^2.\n        # Convert list of components to a numpy array.\n        M_avg_D = np.array(M_avg_components_D)\n        # Calculate the squared magnitude of the average dipole vector.\n        M_avg_sq_D2 = np.dot(M_avg_D, M_avg_D)\n        # Calculate the variance of the dipole moment in D^2.\n        # Var(M) = <M^2> - |<M>|^2\n        var_M_D2 = M2_avg_D2 - M_avg_sq_D2\n        \n        # Convert variance from D^2 to cgs units (erg*cm^3).\n        # (statC*cm)^2 = statC^2 * cm^2. Since erg = statC^2/cm, statC^2 = erg*cm.\n        # So, (statC*cm)^2 = erg*cm*cm^2 = erg*cm^3.\n        var_M_cgs = var_M_D2 * (D_TO_CGS_DIPOLE ** 2)\n        \n        # 3. Evaluate the baseline dielectric constant at s=1.\n        # Specifically, calculate the term (eps(1) - 1).\n        # eps(s) = 1 + (4*pi / (3*V*kB*T)) * Var(M_s)\n        # The prefactor (4*pi / (3*V*kB*T))\n        prefactor = (4 * np.pi) / (3 * V_cgs * KB_CGS * T_K)\n        \n        # The term (eps(1) - 1) is prefactor * Var(M_1)\n        eps1_minus_1 = prefactor * var_M_cgs\n        \n        # 4. Derive and evaluate the scaling factor s*\n        # (s*)^2 = (eps_exp - 1) / (eps(1) - 1)\n        s_star_squared = (eps_exp - 1) / eps1_minus_1\n        s_star = np.sqrt(s_star_squared)\n        \n        # 5. Format and store the result.\n        # The result must be rounded to 6 decimal places.\n        results.append(f\"{s_star:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}