{
    "hands_on_practices": [
        {
            "introduction": "A classical molecular mechanics force field approximates the potential energy of a system as a sum of simple, physically-motivated functions. Understanding these individual components—bond stretching, angle bending, dihedral torsions, and nonbonded interactions—is the first step toward mastering parameterization. This exercise provides a foundational, hands-on calculation of these terms for a simple dipeptide, solidifying your understanding of the mathematical structure of a force field and how each part contributes to the total energy .",
            "id": "3438948",
            "problem": "A classical molecular mechanics parameterization protocol models the total potential energy $U$ of a biomolecular system as the sum of bonded and nonbonded contributions. In this framework, bond stretching and angle bending are represented by harmonic functions derived from a Taylor expansion around equilibrium values, torsional rotations are represented by periodic functions capturing rotational isomerism, and nonbonded interactions are accounted for by van der Waals forces (modeled with a Lennard–Jones potential) and electrostatics (modeled with Coulomb’s law). Consider the capped dipeptide acetyl–alanine–N-methylamide (Ace–Ala–Nme), and restrict attention to the following single interactions: one bond, one angle, one dihedral, and one nonbonded atom pair. Use the potential energy definition\n$$\nU \\;=\\; \\frac{1}{2} k_{r} (r - r_{0})^{2} \\;+\\; \\frac{1}{2} k_{\\theta} (\\theta - \\theta_{0})^{2} \\;+\\; k_{\\phi}\\left[1 + \\cos(n \\phi - \\delta)\\right] \\;+\\; 4 \\epsilon_{ij} \\left[\\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6}\\right] \\;+\\; k_{e} \\frac{q_{i} q_{j}}{r_{ij}} \\, ,\n$$\nwhere all angles are in radians, $\\cos(\\cdot)$ uses radians, and $U$ is to be expressed in kilojoules per mole. The single interactions and parameters are:\n\n- Bond stretching for the peptide bond between the carbonyl carbon $C$ and peptide nitrogen $N$: $r = 0.136\\,\\text{nm}$, $r_{0} = 0.133\\,\\text{nm}$, and $k_{r} = 3.10 \\times 10^{5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}^{-2}$.\n\n- Angle bending for the $C$–$N$–$C_{\\alpha}$ angle: $\\theta = 2.10\\,\\text{rad}$, $\\theta_{0} = 2.05\\,\\text{rad}$, and $k_{\\theta} = 5.20 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{rad}^{-2}$.\n\n- Dihedral torsion for the Ramachandran $\\phi$ angle defined by $C$–$N$–$C_{\\alpha}$–$C$: $\\phi = -\\frac{\\pi}{3}\\,\\text{rad}$, $k_{\\phi} = 3.00\\,\\text{kJ}\\,\\text{mol}^{-1}$, multiplicity $n = 1$, and phase $\\delta = \\pi$.\n\n- Nonbonded pair between the acetyl methyl carbon $i$ and the N-methyl hydrogen $j$: $r_{ij} = 0.38\\,\\text{nm}$, $\\epsilon_{ij} = 0.20\\,\\text{kJ}\\,\\text{mol}^{-1}$, $\\sigma_{ij} = 0.34\\,\\text{nm}$, partial charges $q_{i} = -0.02\\,e$ and $q_{j} = +0.02\\,e$, and the electrostatic conversion constant $k_{e} = 1.38935456 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}\\,e^{-2}$.\n\nCompute the total potential energy $U$ for these four interactions using the definition above. Express your final energy in $\\text{kJ}\\,\\text{mol}^{-1}$ and round your answer to four significant figures. Additionally, explain qualitatively how changing $k_{\\phi}$ affects the conformational preference associated with $\\phi$ under this periodic torsion model.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and complete. It represents a standard calculation in the field of computational chemistry using a molecular mechanics force field. All necessary parameters are provided, and the task is clearly defined.\n\nThe total potential energy, $U$, is the sum of five component terms as defined in the provided equation:\n$$\nU \\;=\\; \\underbrace{\\frac{1}{2} k_{r} (r - r_{0})^{2}}_{U_{bond}} \\;+\\; \\underbrace{\\frac{1}{2} k_{\\theta} (\\theta - \\theta_{0})^{2}}_{U_{angle}} \\;+\\; \\underbrace{k_{\\phi}\\left[1 + \\cos(n \\phi - \\delta)\\right]}_{U_{dihedral}} \\;+\\; \\underbrace{4 \\epsilon_{ij} \\left[\\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6}\\right]}_{U_{LJ}} \\;+\\; \\underbrace{k_{e} \\frac{q_{i} q_{j}}{r_{ij}}}_{U_{elec}}\n$$\nWe will compute each of these five terms individually and then sum them to find the total potential energy $U$.\n\n1.  **Bond stretching potential energy ($U_{bond}$)**\n    The parameters for the peptide bond stretching are given as $k_{r} = 3.10 \\times 10^{5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}^{-2}$, $r = 0.136\\,\\text{nm}$, and $r_{0} = 0.133\\,\\text{nm}$. The displacement from equilibrium is $(r - r_{0}) = 0.136\\,\\text{nm} - 0.133\\,\\text{nm} = 0.003\\,\\text{nm}$.\n    $$\n    U_{bond} = \\frac{1}{2} (3.10 \\times 10^{5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}^{-2}) (0.003\\,\\text{nm})^{2} = \\frac{1}{2} (3.10 \\times 10^{5}) (9.0 \\times 10^{-6})\\,\\text{kJ}\\,\\text{mol}^{-1} = 1.395\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n2.  **Angle bending potential energy ($U_{angle}$)**\n    The parameters for the $C$–$N$–$C_{\\alpha}$ angle bending are $k_{\\theta} = 5.20 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{rad}^{-2}$, $\\theta = 2.10\\,\\text{rad}$, and $\\theta_{0} = 2.05\\,\\text{rad}$. The displacement from equilibrium is $(\\theta - \\theta_{0}) = 2.10\\,\\text{rad} - 2.05\\,\\text{rad} = 0.05\\,\\text{rad}$.\n    $$\n    U_{angle} = \\frac{1}{2} (5.20 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{rad}^{-2}) (0.05\\,\\text{rad})^{2} = \\frac{1}{2} (520) (0.0025)\\,\\text{kJ}\\,\\text{mol}^{-1} = 0.65\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n3.  **Dihedral torsion potential energy ($U_{dihedral}$)**\n    The parameters for the Ramachandran $\\phi$ angle torsion are $k_{\\phi} = 3.00\\,\\text{kJ}\\,\\text{mol}^{-1}$, multiplicity $n = 1$, phase $\\delta = \\pi$, and the angle itself is $\\phi = -\\frac{\\pi}{3}\\,\\text{rad}$.\n    The argument of the cosine term is $n\\phi - \\delta = (1)(-\\frac{\\pi}{3}) - \\pi = -\\frac{4\\pi}{3}\\,\\text{rad}$. The cosine is $\\cos(-\\frac{4\\pi}{3}) = \\cos(\\frac{4\\pi}{3}) = -\\frac{1}{2}$.\n    $$\n    U_{dihedral} = (3.00\\,\\text{kJ}\\,\\text{mol}^{-1}) \\left[1 + \\cos\\left(-\\frac{4\\pi}{3}\\right)\\right] = (3.00) \\left[1 - \\frac{1}{2}\\right]\\,\\text{kJ}\\,\\text{mol}^{-1} = 1.50\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n4.  **Nonbonded Lennard-Jones potential energy ($U_{LJ}$)**\n    The parameters for the nonbonded pair are $\\epsilon_{ij} = 0.20\\,\\text{kJ}\\,\\text{mol}^{-1}$, $\\sigma_{ij} = 0.34\\,\\text{nm}$, and the interatomic distance is $r_{ij} = 0.38\\,\\text{nm}$.\n    The ratio $\\frac{\\sigma_{ij}}{r_{ij}} = \\frac{0.34\\,\\text{nm}}{0.38\\,\\text{nm}} = \\frac{17}{19}$.\n    Let's compute the necessary powers of this ratio:\n    $(\\frac{17}{19})^{6} \\approx 0.496541$\n    $(\\frac{17}{19})^{12} = \\left((\\frac{17}{19})^{6}\\right)^{2} \\approx (0.496541)^{2} \\approx 0.246553$\n    $$\n    U_{LJ} = 4 (0.20\\,\\text{kJ}\\,\\text{mol}^{-1}) (0.246553 - 0.496541) = (0.80)(-0.249988)\\,\\text{kJ}\\,\\text{mol}^{-1} \\approx -0.19999\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n5.  **Nonbonded electrostatic potential energy ($U_{elec}$)**\n    The parameters are partial charges $q_{i} = -0.02\\,e$ and $q_{j} = +0.02\\,e$, distance $r_{ij} = 0.38\\,\\text{nm}$, and the electrostatic constant $k_{e} = 1.38935456 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}\\,e^{-2}$.\n    The product of the charges is $q_{i}q_{j} = (-0.02\\,e)(+0.02\\,e) = -0.0004\\,e^{2} = -4 \\times 10^{-4}\\,e^{2}$.\n    $$\n    U_{elec} = (1.38935456 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}\\,e^{-2}) \\frac{-4 \\times 10^{-4}\\,e^{2}}{0.38\\,\\text{nm}} \\approx -0.146248\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\nThe total potential energy $U$ is the sum of these components:\n$$\nU = U_{bond} + U_{angle} + U_{dihedral} + U_{LJ} + U_{elec}\n$$\n$$\nU \\approx (1.395 + 0.65 + 1.50 - 0.19999 - 0.146248)\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\nU \\approx (3.545 - 0.346238)\\,\\text{kJ}\\,\\text{mol}^{-1} = 3.198762\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\nRounding the final result to four significant figures, we get $U = 3.199\\,\\text{kJ}\\,\\text{mol}^{-1}$.\n\nRegarding the qualitative effect of changing $k_{\\phi}$, this parameter is the force constant of the dihedral term and defines the amplitude of the periodic potential. The energy barrier for rotation around the bond associated with the angle $\\phi$ is directly proportional to $k_{\\phi}$. Specifically, the energy difference between the highest-energy conformation (potential maximum) and the lowest-energy conformation (potential minimum) for this term is $\\Delta U_{dihedral} = U_{max} - U_{min} = k_{\\phi}[1+1] - k_{\\phi}[1-1] = 2k_{\\phi}$.\nAn increase in the value of $k_{\\phi}$ leads to a higher energy barrier for rotation. This restricts the conformational flexibility of the molecule, making it energetically more difficult for the dihedral angle to deviate from its minimum-energy values. Consequently, the conformational preference for specific rotamers is strengthened. Conversely, a decrease in $k_{\\phi}$ lowers the rotational barrier, which allows for greater conformational freedom and makes a wider range of dihedral angles thermally accessible. Thus, $k_{\\phi}$ effectively controls the \"stiffness\" of the torsional angle and modulates the strength of conformational preferences.",
            "answer": "$$\n\\boxed{3.199}\n$$"
        },
        {
            "introduction": "While bonded terms are specific to atom triplets or quartets, nonbonded parameters must describe interactions between all possible pairs of unlike atoms. Force fields handle this using combining rules, a protocol choice that determines the cross-interaction parameters from the parameters of individual atoms. This practice focuses on the ubiquitous Lennard-Jones potential, challenging you to explore how different combining rules quantitatively affect interaction energies and to analyze the role of 1-4 scaling factors, which are critical for accurately modeling short-range nonbonded contacts .",
            "id": "3438972",
            "problem": "In molecular mechanics parameterization for molecular dynamics (MD), the nonbonded van der Waals interaction between two atoms is modeled by the Lennard-Jones (LJ) potential, which emerges from short-range Pauli repulsion and long-range London dispersion and is characterized by atom-type parameters $\\sigma$ (distance scale) and $\\epsilon$ (well depth). Cross interaction parameters $(\\sigma_{ij}, \\epsilon_{ij})$ for unlike atoms are obtained from combining rules, whose choice is a protocol decision in force-field development. Consider an intramolecular one-four (1–4) contact between a carbonyl oxygen and a methyl hydrogen separated by $r=2.5\\,\\mathrm{\\AA}$. The carbonyl oxygen has LJ parameters $\\sigma_{\\mathrm{O}}=3.00\\,\\mathrm{\\AA}$ and $\\epsilon_{\\mathrm{O}}=0.120\\,\\mathrm{kcal\\,mol^{-1}}$, and the methyl hydrogen has LJ parameters $\\sigma_{\\mathrm{H}}=2.50\\,\\mathrm{\\AA}$ and $\\epsilon_{\\mathrm{H}}=0.020\\,\\mathrm{kcal\\,mol^{-1}}$. Two distinct combining rules are to be applied:\n- The Lorentz–Berthelot (LB) combining rule: $\\sigma_{ij}=(\\sigma_{i}+\\sigma_{j})/2$ and $\\epsilon_{ij}=\\sqrt{\\epsilon_{i}\\epsilon_{j}}$.\n- The purely geometric combining rule: $\\sigma_{ij}=\\sqrt{\\sigma_{i}\\sigma_{j}}$ and $\\epsilon_{ij}=\\sqrt{\\epsilon_{i}\\epsilon_{j}}$.\n\nStarting from the physical rationale for repulsive and dispersive contributions leading to the LJ $12$–$6$ form, derive the LJ interaction energy $U_{ij}(r)$ for each combining rule at the specified separation, evaluate both energies in $\\mathrm{kJ\\,mol^{-1}}$, and then analyze the sensitivity of the 1–4 contact energy to the 1–4 scaling factor $S_{14}$ when LJ 1–4 interactions are linearly scaled as $U_{ij}^{(1\\text{–}4)}(r)=S_{14}\\,U_{ij}(r)$. Determine the unique value of $S_{14}$ that makes the LB-scaled 1–4 energy equal to the unscaled energy computed with the geometric combining rule. Express this $S_{14}$ as a dimensionless number and round your final answer to three significant figures. For any energy values you compute along the way, express them in $\\mathrm{kJ\\,mol^{-1}}$ using $1\\,\\mathrm{kcal\\,mol^{-1}}=4.184\\,\\mathrm{kJ\\,mol^{-1}}$.",
            "solution": "### Step 1: Extract Givens\n- Interaction type: Nonbonded van der Waals interaction between a carbonyl oxygen and a methyl hydrogen, specifically an intramolecular one-four (1-4) contact.\n- Potential form: Lennard-Jones (LJ) $12$–$6$ potential, $U_{ij}(r)$.\n- Separation distance: $r=2.5\\,\\mathrm{\\AA}$.\n- Carbonyl oxygen parameters: $\\sigma_{\\mathrm{O}}=3.00\\,\\mathrm{\\AA}$, $\\epsilon_{\\mathrm{O}}=0.120\\,\\mathrm{kcal\\,mol^{-1}}$.\n- Methyl hydrogen parameters: $\\sigma_{\\mathrm{H}}=2.50\\,\\mathrm{\\AA}$, $\\epsilon_{\\mathrm{H}}=0.020\\,\\mathrm{kcal\\,mol^{-1}}$.\n- Lorentz–Berthelot (LB) combining rule: $\\sigma_{ij}=(\\sigma_{i}+\\sigma_{j})/2$ and $\\epsilon_{ij}=\\sqrt{\\epsilon_{i}\\epsilon_{j}}$.\n- Geometric combining rule: $\\sigma_{ij}=\\sqrt{\\sigma_{i}\\sigma_{j}}$ and $\\epsilon_{ij}=\\sqrt{\\epsilon_{i}\\epsilon_{j}}$.\n- 1–4 scaling relation: $U_{ij}^{(1\\text{–}4)}(r)=S_{14}\\,U_{ij}(r)$.\n- Condition for $S_{14}$: The LB-scaled 1–4 energy is equal to the unscaled energy computed with the geometric combining rule.\n- Conversion factor: $1\\,\\mathrm{kcal\\,mol^{-1}}=4.184\\,\\mathrm{kJ\\,mol^{-1}}$.\n- Required precision: The final answer for $S_{14}$ must be rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria:\n- **Scientifically Grounded**: The problem is firmly rooted in the principles of molecular mechanics and force field parameterization, a standard topic in computational chemistry and physics. The Lennard-Jones potential, combining rules, and 1-4 scaling are all established concepts.\n- **Well-Posed**: The problem provides all necessary parameters, equations, and a clear objective. The question leads to a unique, determinable numerical answer.\n- **Objective**: The language is precise and quantitative. There are no subjective or ambiguous statements.\n- The problem is self-contained and internally consistent. It does not violate any physical laws or mathematical principles. All data are dimensionally consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\nThe Lennard-Jones (LJ) $12$–$6$ potential models the van der Waals interaction energy between two non-bonded atoms $i$ and $j$ as a function of their separation distance $r$. The general form is:\n$$U_{ij}(r) = 4\\epsilon_{ij}\\left[ \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6} \\right]$$\nThis functional form is physically motivated. The repulsive term, proportional to $r^{-12}$, models the strong, short-range repulsion arising from the Pauli exclusion principle when electron clouds overlap. The attractive term, proportional to $r^{-6}$, models the weaker, long-range attraction due to London dispersion forces (induced dipole-induced dipole interactions). The parameters $\\epsilon_{ij}$ and $\\sigma_{ij}$ represent the depth of the potential well and the finite distance at which the inter-particle potential is zero, respectively.\n\nFor interactions between unlike atoms (heteroatomic interactions), the parameters $\\epsilon_{ij}$ and $\\sigma_{ij}$ are typically derived from the homoatomic parameters ($\\epsilon_i, \\sigma_i$ and $\\epsilon_j, \\sigma_j$) using combining rules. We will now apply the two specified rules.\n\nThe interacting atoms are a carbonyl oxygen ($\\mathrm{O}$) and a methyl hydrogen ($\\mathrm{H}$). The given parameters are:\n$\\sigma_{\\mathrm{O}}=3.00\\,\\mathrm{\\AA}$, $\\epsilon_{\\mathrm{O}}=0.120\\,\\mathrm{kcal\\,mol^{-1}}$\n$\\sigma_{\\mathrm{H}}=2.50\\,\\mathrm{\\AA}$, $\\epsilon_{\\mathrm{H}}=0.020\\,\\mathrm{kcal\\,mol^{-1}}$\n\nFirst, we calculate the cross-interaction parameters ($\\sigma_{\\mathrm{OH}}$, $\\epsilon_{\\mathrm{OH}}$) for each combining rule.\n\n**1. Lorentz–Berthelot (LB) Combining Rule**\nThe arithmetic mean is used for $\\sigma$ and the geometric mean for $\\epsilon$.\n$$\\sigma_{\\mathrm{OH, LB}} = \\frac{\\sigma_{\\mathrm{O}} + \\sigma_{\\mathrm{H}}}{2} = \\frac{3.00\\,\\mathrm{\\AA} + 2.50\\,\\mathrm{\\AA}}{2} = 2.75\\,\\mathrm{\\AA}$$\n$$\\epsilon_{\\mathrm{OH, LB}} = \\sqrt{\\epsilon_{\\mathrm{O}}\\epsilon_{\\mathrm{H}}} = \\sqrt{(0.120\\,\\mathrm{kcal\\,mol^{-1}})(0.020\\,\\mathrm{kcal\\,mol^{-1}})} = \\sqrt{0.0024}\\,\\mathrm{kcal\\,mol^{-1}}$$\n\n**2. Geometric Combining Rule**\nThe geometric mean is used for both $\\sigma$ and $\\epsilon$.\n$$\\sigma_{\\mathrm{OH, G}} = \\sqrt{\\sigma_{\\mathrm{O}}\\sigma_{\\mathrm{H}}} = \\sqrt{(3.00\\,\\mathrm{\\AA})(2.50\\,\\mathrm{\\AA})} = \\sqrt{7.5}\\,\\mathrm{\\AA}$$\n$$\\epsilon_{\\mathrm{OH, G}} = \\sqrt{\\epsilon_{\\mathrm{O}}\\epsilon_{\\mathrm{H}}} = \\sqrt{(0.120\\,\\mathrm{kcal\\,mol^{-1}})(0.020\\,\\mathrm{kcal\\,mol^{-1}})} = \\sqrt{0.0024}\\,\\mathrm{kcal\\,mol^{-1}}$$\nNote that the value of $\\epsilon_{\\mathrm{OH}}$ is the same for both protocols, which simplifies the subsequent comparison. Let's denote $\\epsilon_{\\mathrm{OH}} = \\sqrt{0.0024}\\,\\mathrm{kcal\\,mol^{-1}}$.\n\nNext, we calculate the LJ interaction energy for each set of parameters at the specified separation $r=2.5\\,\\mathrm{\\AA}$.\n\n**Energy with Lorentz–Berthelot parameters ($U_{\\mathrm{LB}}$):**\n$$U_{\\mathrm{LB}}(r) = 4\\epsilon_{\\mathrm{OH}}\\left[ \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{6} \\right]$$\nThe ratio $\\frac{\\sigma_{\\mathrm{OH, LB}}}{r} = \\frac{2.75\\,\\mathrm{\\AA}}{2.5\\,\\mathrm{\\AA}} = 1.1$.\n$$U_{\\mathrm{LB}} = 4\\sqrt{0.0024}\\left[ (1.1)^{12} - (1.1)^{6} \\right]\\,\\mathrm{kcal\\,mol^{-1}}$$\n$$U_{\\mathrm{LB}} \\approx 4(0.048990)\\left[ 3.1384 - 1.7716 \\right]\\,\\mathrm{kcal\\,mol^{-1}} \\approx 0.2679\\,\\mathrm{kcal\\,mol^{-1}}$$\nConverting to $\\mathrm{kJ\\,mol^{-1}}$:\n$$U_{\\mathrm{LB}} \\approx 0.2679\\,\\mathrm{kcal\\,mol^{-1}} \\times 4.184\\,\\mathrm{kJ\\,(kcal\\,mol^{-1})^{-1}} \\approx 1.121\\,\\mathrm{kJ\\,mol^{-1}}$$\n\n**Energy with Geometric parameters ($U_{\\mathrm{G}}$):**\n$$U_{\\mathrm{G}}(r) = 4\\epsilon_{\\mathrm{OH}}\\left[ \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{6} \\right]$$\nThe ratio $\\frac{\\sigma_{\\mathrm{OH, G}}}{r} = \\frac{\\sqrt{7.5}\\,\\mathrm{\\AA}}{2.5\\,\\mathrm{\\AA}} = \\frac{\\sqrt{7.5}}{\\sqrt{6.25}} = \\sqrt{\\frac{7.5}{6.25}} = \\sqrt{1.2}$.\n$$U_{\\mathrm{G}} = 4\\sqrt{0.0024}\\left[ (\\sqrt{1.2})^{12} - (\\sqrt{1.2})^{6} \\right]\\,\\mathrm{kcal\\,mol^{-1}} = 4\\sqrt{0.0024}\\left[ (1.2)^{6} - (1.2)^{3} \\right]\\,\\mathrm{kcal\\,mol^{-1}}$$\n$$U_{\\mathrm{G}} \\approx 4(0.048990)\\left[ 2.9860 - 1.728 \\right]\\,\\mathrm{kcal\\,mol^{-1}} \\approx 0.2465\\,\\mathrm{kcal\\,mol^{-1}}$$\nConverting to $\\mathrm{kJ\\,mol^{-1}}$:\n$$U_{\\mathrm{G}} \\approx 0.2465\\,\\mathrm{kcal\\,mol^{-1}} \\times 4.184\\,\\mathrm{kJ\\,(kcal\\,mol^{-1})^{-1}} \\approx 1.031\\,\\mathrm{kJ\\,mol^{-1}}$$\nBoth energies are positive, indicating a net repulsive interaction, as expected since the distance $r=2.5\\,\\mathrm{\\AA}$ is in the repulsive region of the potential for both parameter sets.\n\nThe final task is to find the 1–4 scaling factor $S_{14}$ such that the scaled LB energy equals the unscaled geometric energy. The condition is:\n$$U_{\\mathrm{LB}}^{(1\\text{–}4)}(r) = U_{\\mathrm{G}}(r)$$\nUsing the definition of the scaled interaction, $U_{\\mathrm{LB}}^{(1\\text{–}4)}(r) = S_{14} \\, U_{\\mathrm{LB}}(r)$, we have:\n$$S_{14} \\, U_{\\mathrm{LB}}(r) = U_{\\mathrm{G}}(r)$$\nSolving for $S_{14}$:\n$$S_{14} = \\frac{U_{\\mathrm{G}}(r)}{U_{\\mathrm{LB}}(r)}$$\nWe can substitute the expressions for the energies:\n$$S_{14} = \\frac{4\\epsilon_{\\mathrm{OH}}\\left[ \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{6} \\right]}{4\\epsilon_{\\mathrm{OH}}\\left[ \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{6} \\right]}$$\nThe term $4\\epsilon_{\\mathrm{OH}}$ cancels, highlighting that $S_{14}$ in this case depends only on the $\\sigma$ parameters and the distance $r$.\n$$S_{14} = \\frac{\\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{6}}{\\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{6}}$$\nSubstituting the previously calculated ratios:\n$$S_{14} = \\frac{(\\sqrt{1.2})^{12} - (\\sqrt{1.2})^{6}}{(1.1)^{12} - (1.1)^{6}} = \\frac{(1.2)^{6} - (1.2)^{3}}{(1.1)^{12} - (1.1)^{6}}$$\nNow, we compute the numerical value:\n$(1.2)^{3} = 1.728$\n$(1.2)^{6} = (1.2^3)^2 = (1.728)^2 = 2.985984$\n$(1.1)^{6} \\approx 1.771561$\n$(1.1)^{12} = ((1.1)^6)^2 \\approx (1.771561)^2 \\approx 3.138428$\n$$S_{14} = \\frac{2.985984 - 1.728}{3.138428 - 1.771561} = \\frac{1.257984}{1.366867} \\approx 0.92034$$\nThis analysis demonstrates the sensitivity of the interaction energy to the choice of combining rule for $\\sigma$. Since $\\sigma_{\\mathrm{OH,LB}} > \\sigma_{\\mathrm{OH,G}}$, the Lorentz-Berthelot rule predicts a \"larger\" interaction diameter, leading to a more repulsive interaction at this short distance. The scaling factor $S_{14} < 1$ is required to reduce the more repulsive LB energy to match the less repulsive energy from the geometric rule.\n\nRounding the result to three significant figures gives $0.920$.",
            "answer": "$$\\boxed{0.920}$$"
        },
        {
            "introduction": "Modern force field parameterization is not about finding a single \"perfect\" parameter set, but rather about navigating the trade-offs between fitting to different types of reference data, such as quantum mechanical energies and experimental ensemble properties. This advanced practice introduces the framework of multiobjective optimization, a paradigm central to contemporary parameter development. By defining a composite loss function and identifying Pareto-optimal parameter sets, you will simulate the real-world challenge of balancing competing objectives to develop a robust and accurate force field .",
            "id": "3439000",
            "problem": "You are tasked with formalizing and computing a multiobjective loss for Molecular Mechanics (MM) parameterization of peptide dihedral potentials against a synthetic Quantum Mechanics (QM) reference, and exploring Pareto-optimality across a fixed set of candidate parameter vectors. The context is protein and peptide parameterization in molecular dynamics, where one aims to simultaneously minimize the discrepancy between MM and QM energies and minimize the discrepancy between MM and QM ensemble observables at a specified thermodynamic state. You must produce a single, runnable program that carries out the required computations and outputs the results in the specified format.\n\nBegin from fundamental bases: Newton’s second law and the definition of potential energy underpin forces and equilibrium structure, while the Boltzmann distribution from statistical mechanics governs equilibrium ensemble weights at temperature. In the canonical ensemble under temperature $T$, the probability of a discrete microstate $i$ with energy $E_i$ is $p_i = \\exp(-\\beta E_i)/Z$ with inverse thermal energy $\\beta$ and partition function $Z = \\sum_i \\exp(-\\beta E_i)$.\n\nAssume a coarse-grained two-dihedral model for a peptide backbone with dihedrals $\\phi$ and $\\psi$. Let the Microstates be defined by the grid of angles in radians\n$$\n\\phi \\in \\{-\\pi, -\\pi/2, 0, \\pi/2\\}, \\quad \\psi \\in \\{-\\pi, -\\pi/2, 0, \\pi/2\\},\n$$\nforming $16$ discrete microstates. All angles are in radians.\n\nDefine the synthetic Quantum Mechanics (QM) reference energy in kilojoules per mole as\n$$\nE_{\\text{QM}}(\\phi,\\psi) = a_\\phi \\left(1 - \\cos(3\\phi)\\right) + a_\\psi \\left(1 - \\cos(3\\psi)\\right) + a_c \\left(1 - \\cos(\\phi - \\psi)\\right),\n$$\nwhere the coefficients are fixed constants $a_\\phi = 1.25\\,\\mathrm{kJ/mol}$, $a_\\psi = 0.95\\,\\mathrm{kJ/mol}$, and $a_c = 0.35\\,\\mathrm{kJ/mol}$.\n\nAssume the Molecular Mechanics (MM) energy functional parameterized by $\\boldsymbol{\\theta} = (k_\\phi, \\delta_\\phi, k_\\psi, \\delta_\\psi, c)$ is\n$$\nE_{\\text{MM}}(\\phi,\\psi; \\boldsymbol{\\theta}) = k_\\phi \\left(1 - \\cos(3\\phi - \\delta_\\phi)\\right) + k_\\psi \\left(1 - \\cos(3\\psi - \\delta_\\psi)\\right) + c \\left(1 - \\cos(\\phi - \\psi)\\right),\n$$\nwith all parameters having physically meaningful units: $k_\\phi$ and $k_\\psi$ and $c$ in $\\mathrm{kJ/mol}$, and phase shifts $\\delta_\\phi$ and $\\delta_\\psi$ in radians. Consider the following six candidate parameter vectors $\\boldsymbol{\\theta}^{(m)}$ for $m=1,\\dots,6$:\n$$\n\\boldsymbol{\\theta}^{(1)} = (1.00,\\, 0.00,\\, 1.00,\\, 0.00,\\, 0.30),\n$$\n$$\n\\boldsymbol{\\theta}^{(2)} = (0.80,\\, 0.30,\\, 1.20,\\, -0.20,\\, 0.25),\n$$\n$$\n\\boldsymbol{\\theta}^{(3)} = (1.40,\\, 0.50,\\, 0.90,\\, 0.40,\\, 0.40),\n$$\n$$\n\\boldsymbol{\\theta}^{(4)} = (0.60,\\, 1.00,\\, 1.50,\\, -0.50,\\, 0.20),\n$$\n$$\n\\boldsymbol{\\theta}^{(5)} = (1.10,\\, -0.30,\\, 1.10,\\, 0.30,\\, 0.35),\n$$\n$$\n\\boldsymbol{\\theta}^{(6)} = (0.90,\\, -0.70,\\, 0.70,\\, 0.70,\\, 0.50).\n$$\n\nDefine the ensemble observable as the \"alpha-helix occupancy fraction\" $O_{\\alpha}$, computed from the Boltzmann distribution at temperature $T$ using the set of microstates whose dihedrals lie in a typical alpha region:\n$$\n\\mathcal{A} = \\{(\\phi, \\psi) \\mid \\phi \\in [-1.6, -0.6], \\ \\psi \\in [-1.2, 0.0]\\}.\n$$\nLet $p_i^{\\text{MM}}(\\boldsymbol{\\theta}; T)$ and $p_i^{\\text{QM}}(T)$ denote the Boltzmann probabilities over the $16$ microstates using $E_{\\text{MM}}$ and $E_{\\text{QM}}$, respectively. Use the gas constant $R = 0.008314462618\\,\\mathrm{kJ/(mol\\cdot K)}$ to ensure unit consistency, so the inverse thermal energy is $\\beta = 1/(R T)$. The observable is\n$$\nO_{\\alpha}^{\\text{MM}}(\\boldsymbol{\\theta}; T) = \\sum_{i \\in \\mathcal{A}} p_i^{\\text{MM}}(\\boldsymbol{\\theta}; T), \\quad\nO_{\\alpha}^{\\text{QM}}(T) = \\sum_{i \\in \\mathcal{A}} p_i^{\\text{QM}}(T).\n$$\n\nLet the two objective components for each $\\boldsymbol{\\theta}$ be\n$$\nf_1(\\boldsymbol{\\theta}) = \\left(\\frac{1}{N}\\sum_{i=1}^{N} \\left[E_{\\text{MM},i}(\\boldsymbol{\\theta}) - E_{\\text{QM},i}\\right]^2\\right)^{1/2}\n$$\nwhere $N = 16$ is the number of microstates and $E_{\\text{MM},i}, E_{\\text{QM},i}$ denote energies in $\\mathrm{kJ/mol}$ at microstate $i$, and\n$$\nf_2(\\boldsymbol{\\theta}; T) = \\left|O_{\\alpha}^{\\text{MM}}(\\boldsymbol{\\theta}; T) - O_{\\alpha}^{\\text{QM}}(T)\\right|.\n$$\n\nDefine the multiobjective scalarized loss\n$$\nL(\\boldsymbol{\\theta}; \\lambda_1, \\lambda_2, T) = \\lambda_1 \\, f_1(\\boldsymbol{\\theta}) + \\lambda_2 \\, f_2(\\boldsymbol{\\theta}; T),\n$$\nand define Pareto dominance as follows: a parameter vector $\\boldsymbol{\\theta}^{(a)}$ dominates $\\boldsymbol{\\theta}^{(b)}$ if $f_1(\\boldsymbol{\\theta}^{(a)}) \\le f_1(\\boldsymbol{\\theta}^{(b)})$ and $f_2(\\boldsymbol{\\theta}^{(a)}; T) \\le f_2(\\boldsymbol{\\theta}^{(b)}; T)$ with at least one strict inequality; a parameter vector is Pareto-optimal if it is not dominated by any other candidate.\n\nAngle unit specification: all angles must be in radians. Physical unit specification: energies are in $\\mathrm{kJ/mol}$ and temperature in $\\mathrm{K}$.\n\nYour program must compute, for each of the following test cases, both the index (using one-based indexing) of the parameter vector that minimizes $L(\\boldsymbol{\\theta}; \\lambda_1, \\lambda_2, T)$ and the sorted list of one-based indices of Pareto-optimal parameter vectors under the objectives $\\left(f_1, f_2\\right)$ at the given $T$:\n\n- Test case $1$: $T = 300\\,\\mathrm{K}$, $\\lambda_1 = 1.0$, $\\lambda_2 = 1.0$.\n- Test case $2$: $T = 100\\,\\mathrm{K}$, $\\lambda_1 = 1.0$, $\\lambda_2 = 0.5$.\n- Test case $3$: $T = 600\\,\\mathrm{K}$, $\\lambda_1 = 0.5$, $\\lambda_2 = 2.0$.\n- Test case $4$: $T = 300\\,\\mathrm{K}$, $\\lambda_1 = 0.0$, $\\lambda_2 = 1.0$.\n- Test case $5$: $T = 1000\\,\\mathrm{K}$, $\\lambda_1 = 1.0$, $\\lambda_2 = 0.1$.\n\nThe required final output format is a single line containing a comma-separated list of the results for all test cases, enclosed in square brackets, where each test case’s result is a two-element list consisting of the best index and the list of Pareto-optimal indices. For example, the format must be\n$$\n\\left[ [i_1, [p_{1,1}, p_{1,2}, \\dots]], [i_2, [p_{2,1}, \\dots]], \\dots \\right]\n$$\nwith no additional text. The index sets must be integers; no other units, symbols, or text are permitted in the final program output line. Ensure that all calculations strictly follow the definitions above and that angles are in radians, energies in $\\mathrm{kJ/mol}$, and temperature in $\\mathrm{K}$ throughout. The test suite covers a balanced case, cold and hot limits, and cases emphasizing either the energy-matching or the ensemble-matching objective via the weights $\\lambda_1$ and $\\lambda_2$.",
            "solution": "The task is to formalize and compute a multiobjective loss for the parameterization of a simplified peptide model. This involves comparing a Molecular Mechanics (MM) energy function against a synthetic Quantum Mechanics (QM) reference. The evaluation considers both the direct energy differences and the differences in an ensemble-averaged observable at a given temperature. The problem requires identifying the optimal parameter set from a given discrete list of candidates, based on a scalarized loss function, and determining the set of non-dominated, or Pareto-optimal, parameter sets.\n\n### 1. Theoretical Framework\n\n#### 1.1. Physical Model and Energy Functions\nThe system is a simplified model of a peptide backbone, described by two dihedral angles, $\\phi$ and $\\psi$. The conformational space is discretized into $N=16$ microstates, defined by a grid of angles:\n$$\n\\phi \\in \\{-\\pi, -\\pi/2, 0, \\pi/2\\} \\quad \\text{and} \\quad \\psi \\in \\{-\\pi, -\\pi/2, 0, \\pi/2\\}\n$$\nAll angles are in radians.\n\nThe reference Quantum Mechanics (QM) energy for a given conformation $(\\phi, \\psi)$ is given by:\n$$\nE_{\\text{QM}}(\\phi,\\psi) = a_\\phi (1 - \\cos(3\\phi)) + a_\\psi (1 - \\cos(3\\psi)) + a_c (1 - \\cos(\\phi - \\psi))\n$$\nwith fixed coefficients $a_\\phi = 1.25\\,\\mathrm{kJ/mol}$, $a_\\psi = 0.95\\,\\mathrm{kJ/mol}$, and $a_c = 0.35\\,\\mathrm{kJ/mol}$.\n\nThe corresponding Molecular Mechanics (MM) energy function is parameterized by the vector $\\boldsymbol{\\theta} = (k_\\phi, \\delta_\\phi, k_\\psi, \\delta_\\psi, c)$:\n$$\nE_{\\text{MM}}(\\phi,\\psi; \\boldsymbol{\\theta}) = k_\\phi (1 - \\cos(3\\phi - \\delta_\\phi)) + k_\\psi (1 - \\cos(3\\psi - \\delta_\\psi)) + c (1 - \\cos(\\phi - \\psi))\n$$\nThe parameters $k_\\phi, k_\\psi, c$ are force constants in $\\mathrm{kJ/mol}$, and $\\delta_\\phi, \\delta_\\psi$ are phase shifts in radians. We are provided with six candidate parameter vectors, $\\boldsymbol{\\theta}^{(1)}, \\dots, \\boldsymbol{\\theta}^{(6)}$.\n\n#### 1.2. Statistical Mechanics and Ensemble Observables\nAccording to statistical mechanics, in the canonical ensemble at a given temperature $T$, the probability $p_i$ of the system occupying a microstate $i$ with energy $E_i$ is given by the Boltzmann distribution:\n$$\np_i = \\frac{\\exp(-\\beta E_i)}{Z}\n$$\nwhere $\\beta = 1/(RT)$ is the inverse thermal energy, $R = 0.008314462618\\,\\mathrm{kJ/(mol\\cdot K)}$ is the gas constant, and $Z = \\sum_j \\exp(-\\beta E_j)$ is the partition function, which normalizes the probabilities. To prevent numerical overflow issues when exponents are large, it is computationally prudent to calculate probabilities by subtracting the minimum energy $E_{\\min}$:\n$$\np_i = \\frac{\\exp(-\\beta (E_i - E_{\\min}))}{\\sum_j \\exp(-\\beta (E_j - E_{\\min}))}\n$$\nThe problem defines a specific ensemble observable, the \"alpha-helix occupancy fraction\" $O_{\\alpha}$, which is the sum of probabilities of all microstates $(\\phi_i, \\psi_i)$ that fall within the alpha-helical region $\\mathcal{A}$:\n$$\n\\mathcal{A} = \\{(\\phi, \\psi) \\mid \\phi \\in [-1.6, -0.6], \\ \\psi \\in [-1.2, 0.0]\\}\n$$\n$$\nO_{\\alpha} = \\sum_{i \\mid (\\phi_i, \\psi_i) \\in \\mathcal{A}} p_i\n$$\nFrom the discrete grid of angles, the only microstate satisfying these conditions is $(\\phi, \\psi) = (-\\pi/2, 0)$, since $-\\pi/2 \\approx -1.5708 \\in [-1.6, -0.6]$ and $0 \\in [-1.2, 0.0]$. Thus, for this problem, $O_{\\alpha}$ is simply the Boltzmann probability of this single microstate.\n\n### 2. Multiobjective Optimization\nThe goal is to find MM parameters $\\boldsymbol{\\theta}$ that simultaneously satisfy two objectives:\n1.  **Energy Matching**: The MM energies should be close to the QM energies across all microstates. This is quantified by the root-mean-square error (RMSE) of the energies, denoted $f_1(\\boldsymbol{\\theta})$:\n    $$\n    f_1(\\boldsymbol{\\theta}) = \\left(\\frac{1}{N}\\sum_{i=1}^{N} \\left[E_{\\text{MM},i}(\\boldsymbol{\\theta}) - E_{\\text{QM},i}\\right]^2\\right)^{1/2}\n    $$\n2.  **Observable Matching**: The MM-derived ensemble observable should match the QM-derived one. This is quantified by the absolute difference in the alpha-helix occupancy fraction, $f_2(\\boldsymbol{\\theta}; T)$:\n    $$\n    f_2(\\boldsymbol{\\theta}; T) = \\left|O_{\\alpha}^{\\text{MM}}(\\boldsymbol{\\theta}; T) - O_{\\alpha}^{\\text{QM}}(T)\\right|\n    $$\nNote that $f_1$ is independent of temperature, while $f_2$ is temperature-dependent through the Boltzmann probabilities.\n\nA common approach to solving multiobjective problems is scalarization, where the multiple objectives are combined into a single scalar loss function $L$. Here, a weighted sum is used:\n$$\nL(\\boldsymbol{\\theta}; \\lambda_1, \\lambda_2, T) = \\lambda_1 \\, f_1(\\boldsymbol{\\theta}) + \\lambda_2 \\, f_2(\\boldsymbol{\\theta}; T)\n$$\nThe parameter set that minimizes $L$ is considered optimal for the given weights $\\lambda_1, \\lambda_2$ and temperature $T$.\n\nAnother important concept is Pareto optimality. A parameter vector $\\boldsymbol{\\theta}^{(a)}$ **dominates** another vector $\\boldsymbol{\\theta}^{(b)}$ if it is better or equal in all objectives and strictly better in at least one. Formally:\n$$\nf_1(\\boldsymbol{\\theta}^{(a)}) \\le f_1(\\boldsymbol{\\theta}^{(b)}) \\quad \\text{and} \\quad f_2(\\boldsymbol{\\theta}^{(a)}; T) \\le f_2(\\boldsymbol{\\theta}^{(b)}; T)\n$$\nwith at least one of the inequalities being strict.\nA parameter vector is **Pareto-optimal** if no other candidate vector in the set dominates it. The set of all such vectors forms the Pareto front, representing the best possible trade-offs between the competing objectives.\n\n### 3. Computational Procedure\nThe problem is solved by systematically evaluating each of the six candidate parameter vectors $\\boldsymbol{\\theta}^{(m)}$ for each test case.\n\n1.  **Initialization**: Define the constants ($a_\\phi, a_\\psi, a_c, R$), the grid of $16$ microstates $(\\phi_i, \\psi_i)$, and the six candidate parameter vectors $\\boldsymbol{\\theta}^{(m)}$.\n2.  **Reference Calculation**: Compute the QM energies $E_{\\text{QM},i}$ for all $16$ microstates. These are constant for all test cases. Identify the index/indices corresponding to the alpha-helix region $\\mathcal{A}$.\n3.  **Iterate Over Test Cases**: For each specified test case $(T, \\lambda_1, \\lambda_2)$:\n    a. Calculate the inverse thermal energy $\\beta = 1/(RT)$.\n    b. Compute the QM Boltzmann probabilities $p_i^{\\text{QM}}(T)$ and the reference observable $O_{\\alpha}^{\\text{QM}}(T)$.\n    c. **Iterate Over Candidate Parameters**: For each $\\boldsymbol{\\theta}^{(m)}$ ($m=1, \\dots, 6$):\n        i.  Calculate the MM energies $E_{\\text{MM},i}(\\boldsymbol{\\theta}^{(m)})$ for all microstates.\n        ii. Calculate the energy objective $f_1(\\boldsymbol{\\theta}^{(m)})$. This value is temperature-independent and can be pre-calculated for each $\\boldsymbol{\\theta}^{(m)}$.\n        iii. Compute the MM Boltzmann probabilities $p_i^{\\text{MM}}(\\boldsymbol{\\theta}^{(m)}; T)$ and the observable $O_{\\alpha}^{\\text{MM}}(\\boldsymbol{\\theta}^{(m)}; T)$.\n        iv. Calculate the observable objective $f_2(\\boldsymbol{\\theta}^{(m)}; T)$.\n        v.  Calculate the scalarized loss $L(\\boldsymbol{\\theta}^{(m)}; \\lambda_1, \\lambda_2, T)$.\n    d. **Analysis for the Current Test Case**:\n        i.  From the array of computed $L$ values, find the index $m$ corresponding to the minimum value. This is the index of the best parameter set under scalarization.\n        ii. From the array of objective pairs $(f_1^{(m)}, f_2^{(m)})$, identify the set of Pareto-optimal indices by performing pairwise dominance checks. An index $m$ is Pareto-optimal if no other index $j$ exists such that $\\boldsymbol{\\theta}^{(j)}$ dominates $\\boldsymbol{\\theta}^{(m)}$.\n    e. **Store Results**: Store the best index for $L$ and the sorted list of Pareto-optimal indices.\n4.  **Final Output**: Format the collected results from all test cases into the specified single-line string format. One-based indexing is used for all reported indices.\n\nThis procedure is implemented in the following program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes multiobjective loss and Pareto-optimal sets for peptide parameterization.\n    \"\"\"\n    # Define physical constants and model parameters\n    R = 0.008314462618  # Gas constant in kJ/(mol*K)\n    A_PHI, A_PSI, A_C = 1.25, 0.95, 0.35  # QM energy coefficients\n\n    # Define the discrete microstate grid\n    phi_vals = np.array([-np.pi, -np.pi / 2.0, 0.0, np.pi / 2.0])\n    psi_vals = np.array([-np.pi, -np.pi / 2.0, 0.0, np.pi / 2.0])\n    phi_grid, psi_grid = np.meshgrid(phi_vals, psi_vals)\n    phi_flat = phi_grid.flatten()\n    psi_flat = psi_grid.flatten()\n\n    # Define the six candidate MM parameter vectors theta\n    thetas = [\n        (1.00, 0.00, 1.00, 0.00, 0.30),\n        (0.80, 0.30, 1.20, -0.20, 0.25),\n        (1.40, 0.50, 0.90, 0.40, 0.40),\n        (0.60, 1.00, 1.50, -0.50, 0.20),\n        (1.10, -0.30, 1.10, 0.30, 0.35),\n        (0.90, -0.70, 0.70, 0.70, 0.50),\n    ]\n\n    # Define the test cases\n    test_cases = [\n        (300.0, 1.0, 1.0),\n        (100.0, 1.0, 0.5),\n        (600.0, 0.5, 2.0),\n        (300.0, 0.0, 1.0),\n        (1000.0, 1.0, 0.1),\n    ]\n\n    # Helper functions for energy calculation\n    def e_qm_func(phi, psi):\n        return A_PHI * (1.0 - np.cos(3.0 * phi)) + \\\n               A_PSI * (1.0 - np.cos(3.0 * psi)) + \\\n               A_C * (1.0 - np.cos(phi - psi))\n\n    def e_mm_func(phi, psi, theta):\n        k_phi, d_phi, k_psi, d_psi, c = theta\n        return k_phi * (1.0 - np.cos(3.0 * phi - d_phi)) + \\\n               k_psi * (1.0 - np.cos(3.0 * psi - d_psi)) + \\\n               c * (1.0 - np.cos(phi - psi))\n\n    def calculate_boltzmann_probs(energies, beta):\n        # Numerically stable calculation of Boltzmann probabilities\n        min_e = np.min(energies)\n        rel_e = energies - min_e\n        exp_e = np.exp(-beta * rel_e)\n        z = np.sum(exp_e)\n        return exp_e / z\n\n    # Pre-compute QM energies (temperature-independent)\n    e_qm_values = e_qm_func(phi_flat, psi_flat)\n\n    # Pre-identify microstates in the alpha-helix region\n    alpha_indices = np.where(\n        (phi_flat >= -1.6)  (phi_flat = -0.6) \n        (psi_flat >= -1.2)  (psi_flat = 0.0)\n    )[0]\n\n    # Pre-compute f1 objective values (temperature-independent)\n    f1_all_thetas = []\n    e_mm_all_thetas = []\n    for theta in thetas:\n        e_mm_values = e_mm_func(phi_flat, psi_flat, theta)\n        e_mm_all_thetas.append(e_mm_values)\n        f1 = np.sqrt(np.mean((e_mm_values - e_qm_values)**2))\n        f1_all_thetas.append(f1)\n    \n    e_mm_all_thetas = np.array(e_mm_all_thetas)\n\n    # --- Main computation loop ---\n    all_results = []\n    for T, lambda1, lambda2 in test_cases:\n        beta = 1.0 / (R * T)\n\n        # Calculate QM properties for the given temperature\n        p_qm = calculate_boltzmann_probs(e_qm_values, beta)\n        o_alpha_qm = np.sum(p_qm[alpha_indices])\n\n        f2_vals, L_vals = [], []\n\n        # Calculate MM properties for each theta at the given temperature\n        for i, theta in enumerate(thetas):\n            e_mm_values = e_mm_all_thetas[i]\n            \n            # f2 calculation\n            p_mm = calculate_boltzmann_probs(e_mm_values, beta)\n            o_alpha_mm = np.sum(p_mm[alpha_indices])\n            f2 = np.abs(o_alpha_mm - o_alpha_qm)\n            f2_vals.append(f2)\n\n            # L (scalarized loss) calculation\n            L = lambda1 * f1_all_thetas[i] + lambda2 * f2\n            L_vals.append(L)\n\n        # Find the index of the parameter vector that minimizes L\n        best_L_index = np.argmin(L_vals) + 1  # 1-based indexing\n\n        # Find the set of Pareto-optimal parameter vectors\n        objectives = np.array([f1_all_thetas, f2_vals]).T\n        pareto_indices = []\n        for i in range(len(thetas)):\n            is_dominated = False\n            for j in range(len(thetas)):\n                if i == j:\n                    continue\n                # Check if theta_j dominates theta_i\n                if (objectives[j, 0] = objectives[i, 0] and\n                    objectives[j, 1] = objectives[i, 1] and\n                    (objectives[j, 0]  objectives[i, 0] or\n                     objectives[j, 1]  objectives[i, 1])):\n                    is_dominated = True\n                    break\n            if not is_dominated:\n                pareto_indices.append(i + 1)  # 1-based indexing\n        \n        pareto_indices.sort()\n\n        all_results.append([best_L_index, pareto_indices])\n\n    # Format the final output string exactly as required\n    result_str = str(all_results).replace(\" \", \"\")\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}