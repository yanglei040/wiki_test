{
    "hands_on_practices": [
        {
            "introduction": "Applying theoretical concepts to practical simulations begins with mastering the foundational mathematics. This first exercise  guides you through the explicit derivation of the long-range corrections for both potential energy and pressure for the ubiquitous Lennard-Jones potential. By performing this calculation, you will solidify your understanding of how the continuum approximation, where the radial distribution function $g(r) \\approx 1$, allows us to analytically account for the truncated part of the potential, a crucial step in obtaining accurate thermodynamic properties.",
            "id": "3451011",
            "problem": "Consider a macroscopically homogeneous and isotropic monatomic fluid studied by Molecular Dynamics (MD), interacting via a pairwise additive Lennard–Jones potential $u(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^6\\right]$. In a finite-range simulation, the potential is truncated at a cutoff distance $r_c0$, which omits the contribution from separations $r\\ge r_c$. The tail corrections restore the missing contributions by integrating the full potential beyond $r_c$ under the standard approximation that the radial distribution function (RDF) $g(r)$ satisfies $g(r)\\approx 1$ for $r\\ge r_c$.\n\nStarting only from the following well-tested expressions for a uniform fluid with pairwise interactions:\n- the configurational potential energy per particle, $U/N=2\\pi\\rho\\int_{0}^{\\infty}r^2u(r)g(r)\\,dr$, and\n- the virial equation of state for the pressure, $P=\\rho k_B T-\\frac{2\\pi}{3}\\rho^2\\int_{0}^{\\infty}r^3 u'(r)g(r)\\,dr$,\n\nwhere $u'(r)=\\frac{du}{dr}$, derive the tail corrections to the energy per particle and to the pressure that arise from truncating the Lennard–Jones potential at $r_c$. Specifically, obtain closed-form analytic expressions for\n- the energy tail correction per particle $U_{\\text{tail}}/N=2\\pi\\rho\\int_{r_c}^{\\infty}r^2u(r)\\,dr$, and\n- the pressure tail correction $P_{\\text{tail}}=-\\frac{2\\pi}{3}\\rho^2\\int_{r_c}^{\\infty}r^3u'(r)\\,dr$.\n\nCarry out all steps symbolically in terms of $\\epsilon$, $\\sigma$, $\\rho$, and $r_c$. Then analyze the scaling of both $U_{\\text{tail}}/N$ and $P_{\\text{tail}}$ with the number density $\\rho$ and with the cutoff $r_c$ in the limit $r_c\\gg\\sigma$, identifying the leading-order dependence on $r_c$ and the sign of each correction. Express your final answer for the two tail-correction expressions symbolically in terms of $\\epsilon$, $\\sigma$, $\\rho$, and $r_c$. Do not substitute numerical values, and do not include units in the final expressions.",
            "solution": "The user has requested a derivation of the tail corrections for potential energy and pressure in a molecular dynamics simulation of a Lennard-Jones fluid, followed by an analysis of their scaling properties.\n\n**Derivation of Tail Corrections**\n\nThe task is to compute the long-range corrections to the configurational energy and pressure that are neglected when the pair potential is truncated at $r_c$. These corrections are calculated by integrating the potential and its related virial term from $r_c$ to infinity, assuming a uniform particle distribution ($g(r)=1$) beyond the cutoff.\n\n**1. Energy Tail Correction per Particle ($U_{\\text{tail}}/N$)**\n\nThe expression for the energy tail correction per particle is given as:\n$$\n\\frac{U_{\\text{tail}}}{N} = 2\\pi\\rho\\int_{r_c}^{\\infty}r^2 u(r) \\,dr\n$$\nThe Lennard-Jones potential is $u(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$. Substituting this into the integral:\n$$\n\\frac{U_{\\text{tail}}}{N} = 2\\pi\\rho\\int_{r_c}^{\\infty} r^2 \\left( 4\\epsilon\\left[ \\sigma^{12}r^{-12} - \\sigma^6r^{-6} \\right] \\right) \\,dr\n$$\nFactoring out the constants:\n$$\n\\frac{U_{\\text{tail}}}{N} = 8\\pi\\rho\\epsilon \\int_{r_c}^{\\infty} \\left( \\sigma^{12}r^{-10} - \\sigma^6r^{-4} \\right) \\,dr\n$$\nWe now perform the integration term-by-term:\n$$\n\\int \\left( \\sigma^{12}r^{-10} - \\sigma^6r^{-4} \\right) \\,dr = \\sigma^{12}\\frac{r^{-9}}{-9} - \\sigma^6\\frac{r^{-3}}{-3} = -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3}\n$$\nEvaluating the definite integral from $r_c$ to $\\infty$:\n$$\n\\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^{\\infty} = \\lim_{r\\to\\infty}\\left(-\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3}\\right) - \\left(-\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3}\\right)\n$$\nThe limit as $r \\to \\infty$ is $0$. Thus, the integral evaluates to:\n$$\n0 - \\left(-\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3}\\right) = \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\n$$\nSubstituting this result back into the expression for the energy correction:\n$$\n\\frac{U_{\\text{tail}}}{N} = 8\\pi\\rho\\epsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\n\n**2. Pressure Tail Correction ($P_{\\text{tail}}$)**\n\nThe expression for the pressure tail correction is given as:\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 \\int_{r_c}^{\\infty} r^3 u'(r) \\,dr\n$$\nFirst, we must find the derivative of the Lennard-Jones potential, $u'(r) = \\frac{du}{dr}$:\n$$\nu'(r) = \\frac{d}{dr}\\left[4\\epsilon\\left(\\sigma^{12}r^{-12} - \\sigma^6r^{-6}\\right)\\right] = 4\\epsilon\\left(-12\\sigma^{12}r^{-13} + 6\\sigma^6r^{-7}\\right)\n$$\n$$\nu'(r) = 24\\epsilon\\left(-\\frac{2\\sigma^{12}}{r^{13}} + \\frac{\\sigma^6}{r^7}\\right)\n$$\nNow, substitute $u'(r)$ into the integral for $P_{\\text{tail}}$:\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 \\int_{r_c}^{\\infty} r^3 \\left(24\\epsilon\\left(-2\\sigma^{12}r^{-13} + \\sigma^6r^{-7}\\right)\\right) \\,dr\n$$\nFactoring out the constants:\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 (24\\epsilon) \\int_{r_c}^{\\infty} \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr = -16\\pi\\rho^2\\epsilon \\int_{r_c}^{\\infty} \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr\n$$\nWe perform the integration:\n$$\n\\int \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr = -2\\sigma^{12}\\frac{r^{-9}}{-9} + \\sigma^6\\frac{r^{-3}}{-3} = \\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3}\n$$\nEvaluating the definite integral from $r_c$ to $\\infty$:\n$$\n\\left[ \\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^{\\infty} = \\lim_{r\\to\\infty}\\left(\\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3}\\right) - \\left(\\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\\right)\n$$\nThe limit as $r \\to \\infty$ is $0$. The integral evaluates to:\n$$\n0 - \\left(\\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\\right) = \\frac{\\sigma^6}{3r_c^3} - \\frac{2\\sigma^{12}}{9r_c^9}\n$$\nSubstituting this back into the expression for the pressure correction:\n$$\nP_{\\text{tail}} = -16\\pi\\rho^2\\epsilon \\left( \\frac{\\sigma^6}{3r_c^3} - \\frac{2\\sigma^{12}}{9r_c^9} \\right) = 16\\pi\\rho^2\\epsilon \\left( \\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\n\n**3. Scaling Analysis in the Limit $r_c \\gg \\sigma$**\n\nFor large cutoff distances, the ratio $\\frac{\\sigma}{r_c}$ is small. We analyze the leading-order behavior of the correction terms.\n\n**Energy Correction Scaling:**\nThe expression is $\\frac{U_{\\text{tail}}}{N} = 8\\pi\\rho\\epsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)$.\n- **Dependence on $\\rho$**: The energy correction per particle is directly proportional to the number density, $\\frac{U_{\\text{tail}}}{N} \\propto \\rho$.\n- **Dependence on $r_c$**: In the limit $r_c \\gg \\sigma$, the term $(\\sigma/r_c)^9$ is much smaller than $(\\sigma/r_c)^3$. The expression is dominated by the $r_c^{-3}$ term. The leading-order dependence is:\n$$\n\\frac{U_{\\text{tail}}}{N} \\approx -\\frac{8\\pi\\rho\\epsilon\\sigma^6}{3r_c^3}\n$$\nThe energy correction scales as $r_c^{-3}$.\n- **Sign**: Since the negative $r_c^{-3}$ term dominates, the energy correction $\\frac{U_{\\text{tail}}}{N}$ is **negative**. This is physically correct, as truncating the potential neglects the long-range attractive tail, which artificially increases the system's potential energy. The correction lowers the energy.\n\n**Pressure Correction Scaling:**\nThe expression is $P_{\\text{tail}} = 16\\pi\\rho^2\\epsilon \\left( \\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)$.\n- **Dependence on $\\rho$**: The pressure correction is proportional to the square of the number density, $P_{\\text{tail}} \\propto \\rho^2$.\n- **Dependence on $r_c$**: In the limit $r_c \\gg \\sigma$, the term $(\\sigma/r_c)^9$ is much smaller than $(\\sigma/r_c)^3$. The expression is dominated by the $r_c^{-3}$ term. The leading-order dependence is:\n$$\nP_{\\text{tail}} \\approx -\\frac{16\\pi\\rho^2\\epsilon\\sigma^6}{3r_c^3}\n$$\nThe pressure correction scales as $r_c^{-3}$.\n- **Sign**: Since the negative $r_c^{-3}$ term dominates, the pressure correction $P_{\\text{tail}}$ is **negative**. This is also physically correct. The true pressure is given by $P = P_{\\text{truncated}} + P_{\\text{tail}}$. A negative $P_{\\text{tail}}$ means the true pressure is lower than the pressure calculated from the truncated potential. The neglected long-range forces are attractive, which provides a cohesive effect that reduces the outward pressure exerted by the fluid.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{8\\pi\\rho\\epsilon\\sigma^6}{3r_c^3} \\left( \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right)  \\frac{16\\pi\\rho^2\\epsilon\\sigma^6}{3r_c^3} \\left( \\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right) \\end{pmatrix} } $$"
        },
        {
            "introduction": "Once we have expressions for the tail corrections, a critical practical question arises: how sensitive are these corrections to our choice of the cutoff radius, $r_c$? This practice  explores this sensitivity by having you calculate the derivatives of the energy and pressure corrections with respect to $r_c$. This analysis not only offers a powerful application of the fundamental theorem of calculus but also provides direct insight into the error introduced by the truncation itself, informing more robust simulation design.",
            "id": "3451013",
            "problem": "Consider a homogeneous, isotropic fluid of number density $\\rho$ interacting via a pairwise-additive Lennard-Jones (LJ) potential, defined as $u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$, where $\\varepsilon$ and $\\sigma$ are energy and length scales, respectively. In a simulation using a truncated (but not shifted) potential at cutoff $r_{c}$, the missing contributions from the region $r  r_{c}$ are often approximated by “tail” integrals under the standard assumption that the radial distribution function satisfies $g(r) \\approx 1$ for $r  r_{c}$. Starting from the fundamental expressions for the potential energy per particle and the pressure of a homogeneous fluid with pair interactions,\n- $U/N = 2 \\pi \\rho \\int_{0}^{\\infty} g(r)\\, u(r)\\, r^{2} \\, dr$,\n- $P = \\rho k_{B} T - \\frac{2 \\pi}{3} \\rho^{2} \\int_{0}^{\\infty} g(r)\\, r^{3}\\, u'(r)\\, dr$,\ndefine the per-particle tail energy $u_{\\text{tail}}$ and the tail pressure $P_{\\text{tail}}$ as the contributions from the interval $[r_{c}, \\infty)$ under $g(r) \\approx 1$ and fixed $\\rho$, $\\varepsilon$, and $\\sigma$. Then, analyze the sensitivity of these tail corrections to small changes in $r_{c}$ by computing the derivatives $\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}}$ and $\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}}$ for the Lennard-Jones potential given above.\n\nGive your final result as a single closed-form analytic expression in terms of $\\rho$, $\\varepsilon$, $\\sigma$, and $r_{c}$. Provide both derivatives as a single row matrix $\\left( \\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}} \\;\\; \\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} \\right)$. No numerical evaluation or rounding is required.",
            "solution": "The problem will first be validated for scientific correctness, consistency, and completeness.\n\n### Step 1: Extract Givens\n- **Fluid Properties**: A homogeneous, isotropic fluid of number density $\\rho$.\n- **Interaction Potential**: A pairwise-additive Lennard-Jones (LJ) potential, $u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$.\n- **Simulation Conditions**: The potential is truncated at a cutoff radius $r_{c}$.\n- **Approximation**: The radial distribution function $g(r) \\approx 1$ for $r  r_{c}$.\n- **Fundamental Expressions**:\n  - Potential energy per particle: $U/N = 2 \\pi \\rho \\int_{0}^{\\infty} g(r)\\, u(r)\\, r^{2} \\, dr$.\n  - Pressure: $P = \\rho k_{B} T - \\frac{2 \\pi}{3} \\rho^{2} \\int_{0}^{\\infty} g(r)\\, r^{3}\\, u'(r)\\, dr$.\n- **Definitions**:\n  - Per-particle tail energy: $u_{\\text{tail}}$ is the contribution to $U/N$ from the interval $[r_{c}, \\infty)$ under the approximation $g(r) \\approx 1$.\n  - Tail pressure: $P_{\\text{tail}}$ is the contribution to the second term of $P$ from the interval $[r_{c}, \\infty)$ under the approximation $g(r) \\approx 1$.\n- **Task**: Compute the derivatives $\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}}$ and $\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}}$ in terms of $\\rho$, $\\varepsilon$, $\\sigma$, and $r_{c}$, and present them as a single row matrix.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a critical review based on the extracted information.\n\n- **Scientifically Grounded**: The problem is firmly rooted in the principles of statistical mechanics and molecular simulation. The Lennard-Jones potential, the expressions for internal energy and pressure (via the virial theorem), and the concept of tail corrections for truncated potentials are all standard and fundamental topics in physical chemistry and computational physics. The approximation $g(r) \\approx 1$ for large $r$ is a standard and physically justified simplification for fluids, where long-range correlations decay.\n- **Well-Posed**: The problem is mathematically well-defined. It asks for the derivatives of quantities defined by integrals. The integrands are well-behaved functions, and the use of the fundamental theorem of calculus provides a direct path to a unique solution.\n- **Objective**: The language is precise and devoid of any subjectivity or ambiguity. All terms are standard in the field.\n- **Completeness and Consistency**: The problem provides all necessary definitions and equations to proceed. The Lennard-Jones potential is explicitly given, as are the integral forms for energy and pressure from which the tail corrections are to be derived. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard derivation in the field of molecular simulation and statistical mechanics, satisfying all criteria for a well-posed, scientifically grounded problem. We may proceed with the solution.\n\n###\n### Derivation of Tail Correction Derivatives\n\nThe task is to find the derivatives of the tail corrections for energy and pressure with respect to the cutoff radius $r_{c}$.\n\n**1. Derivative of the Tail Energy Correction ($u_{\\text{tail}}$)**\n\nBased on the provided expression for the potential energy per particle $U/N$, the tail correction $u_{\\text{tail}}$ is defined as the contribution from distances greater than $r_{c}$, under the assumption that $g(r) \\approx 1$.\n$$u_{\\text{tail}} = 2 \\pi \\rho \\int_{r_{c}}^{\\infty} (1) \\cdot u(r) \\cdot r^{2} \\, dr$$\nTo find the sensitivity of $u_{\\text{tail}}$ to changes in $r_{c}$, we compute the derivative $\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}}$. According to the Leibniz integral rule (a generalization of the fundamental theorem of calculus), for an integral of the form $I(x) = \\int_{x}^{a} f(t) dt$, the derivative is $I'(x) = -f(x)$. Applying this rule to the expression for $u_{\\text{tail}}$:\n$$\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}} = \\frac{\\partial}{\\partial r_{c}} \\left( 2 \\pi \\rho \\int_{r_{c}}^{\\infty} u(r) r^{2} \\, dr \\right) = -2 \\pi \\rho \\, u(r_{c}) \\, r_{c}^{2}$$\nNow, we substitute the given Lennard-Jones potential $u(r_{c}) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r_{c}} \\right)^{12} - \\left( \\frac{\\sigma}{r_{c}} \\right)^{6} \\right]$:\n$$\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}} = -2 \\pi \\rho \\, r_{c}^{2} \\left( 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r_{c}} \\right)^{12} - \\left( \\frac{\\sigma}{r_{c}} \\right)^{6} \\right] \\right)$$\nSimplifying the expression:\n$$\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}} = -8 \\pi \\rho \\varepsilon \\, r_{c}^{2} \\left( \\frac{\\sigma^{12}}{r_{c}^{12}} - \\frac{\\sigma^{6}}{r_{c}^{6}} \\right)$$\n$$\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}} = -8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{r_{c}^{10}} - \\frac{\\sigma^{6}}{r_{c}^{4}} \\right)$$\nRearranging for a more conventional form:\n$$\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}} = 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{6}}{r_{c}^{4}} - \\frac{\\sigma^{12}}{r_{c}^{10}} \\right)$$\n\n**2. Derivative of the Tail Pressure Correction ($P_{\\text{tail}}$)**\n\nThe pressure expression contains an ideal gas term, $\\rho k_{B} T$, and a configuration-dependent term related to intermolecular forces. The tail correction $P_{\\text{tail}}$ applies only to the latter term.\n$$P_{\\text{tail}} = - \\frac{2 \\pi}{3} \\rho^{2} \\int_{r_{c}}^{\\infty} g(r) \\, r^{3} \\, u'(r) \\, dr$$\nApplying the approximation $g(r) \\approx 1$:\n$$P_{\\text{tail}} = - \\frac{2 \\pi}{3} \\rho^{2} \\int_{r_{c}}^{\\infty} r^{3} \\, u'(r) \\, dr$$\nAgain, using the fundamental theorem of calculus to find the derivative with respect to the lower integration limit $r_{c}$:\n$$\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} = \\frac{\\partial}{\\partial r_{c}} \\left( - \\frac{2 \\pi}{3} \\rho^{2} \\int_{r_{c}}^{\\infty} r^{3} \\, u'(r) \\, dr \\right) = - \\left( - \\frac{2 \\pi}{3} \\rho^{2} \\right) r_{c}^{3} \\, u'(r_{c})$$\n$$\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} = \\frac{2 \\pi}{3} \\rho^{2} r_{c}^{3} \\, u'(r_{c})$$\nNext, we must find the derivative of the Lennard-Jones potential, $u'(r) = \\frac{du}{dr}$.\n$$u(r) = 4 \\varepsilon \\left( \\sigma^{12}r^{-12} - \\sigma^{6}r^{-6} \\right)$$\n$$u'(r) = \\frac{du}{dr} = 4 \\varepsilon \\left( \\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7} \\right)$$\n$$u'(r) = 4 \\varepsilon \\left( -12\\sigma^{12}r^{-13} + 6\\sigma^{6}r^{-7} \\right)$$\n$$u'(r) = 24 \\varepsilon \\left( \\sigma^{6}r^{-7} - 2\\sigma^{12}r^{-13} \\right)$$\nNow, substitute $u'(r_{c})$ into the expression for $\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}}$:\n$$\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} = \\frac{2 \\pi}{3} \\rho^{2} r_{c}^{3} \\left[ 24 \\varepsilon \\left( \\sigma^{6}r_{c}^{-7} - 2\\sigma^{12}r_{c}^{-13} \\right) \\right]$$\nSimplifying the expression:\n$$\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} = \\frac{2 \\pi \\cdot 24}{3} \\rho^{2} \\varepsilon \\, r_{c}^{3} \\left( \\frac{\\sigma^{6}}{r_{c}^{7}} - \\frac{2\\sigma^{12}}{r_{c}^{13}} \\right)$$\n$$\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} = 16 \\pi \\rho^{2} \\varepsilon \\, r_{c}^{3} \\left( \\frac{\\sigma^{6}}{r_{c}^{7}} - \\frac{2\\sigma^{12}}{r_{c}^{13}} \\right)$$\n$$\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} = 16 \\pi \\rho^{2} \\varepsilon \\left( \\frac{\\sigma^{6}}{r_{c}^{4}} - \\frac{2\\sigma^{12}}{r_{c}^{10}} \\right)$$\n\n**3. Final Result**\n\nThe two derivatives are:\n$$\\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}} = 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{6}}{r_{c}^{4}} - \\frac{\\sigma^{12}}{r_{c}^{10}} \\right)$$\n$$\\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} = 16 \\pi \\rho^{2} \\varepsilon \\left( \\frac{\\sigma^{6}}{r_{c}^{4}} - \\frac{2\\sigma^{12}}{r_{c}^{10}} \\right)$$\nThe problem requires these to be presented as a single row matrix.\n$$ \\left( \\frac{\\partial u_{\\text{tail}}}{\\partial r_{c}} \\quad \\frac{\\partial P_{\\text{tail}}}{\\partial r_{c}} \\right) = \\begin{pmatrix} 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{6}}{r_{c}^{4}} - \\frac{\\sigma^{12}}{r_{c}^{10}} \\right)  16 \\pi \\rho^{2} \\varepsilon \\left( \\frac{\\sigma^{6}}{r_{c}^{4}} - \\frac{2\\sigma^{12}}{r_{c}^{10}} \\right) \\end{pmatrix} $$\nThis expression provides the complete analytical result as requested.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{6}}{r_{c}^{4}} - \\frac{\\sigma^{12}}{r_{c}^{10}} \\right)  16 \\pi \\rho^{2} \\varepsilon \\left( \\frac{\\sigma^{6}}{r_{c}^{4}} - \\frac{2\\sigma^{12}}{r_{c}^{10}} \\right) \\end{pmatrix} } $$"
        },
        {
            "introduction": "The analytical derivations for tail corrections hinge on the key approximation that the fluid is unstructured beyond the cutoff, i.e., $g(r) \\approx 1$. This final hands-on practice  moves from pure theory to computational verification, challenging you to test the validity of this very assumption. By designing a benchmark that compares the theoretical scaling of the energy correction with results from a system with model structural correlations, you will gain a deeper appreciation for the limits of the theory and the sources of error in real-world simulations.",
            "id": "3450980",
            "problem": "Consider a homogeneous, isotropic fluid at number density $\\rho$ interacting via a spherically symmetric, pairwise-additive potential $u(r)$ that decays as $u(r)\\sim -C_6 r^{-6}$ at large separation $r$. In Molecular Dynamics (MD), it is common to truncate $u(r)$ at a finite cutoff $r_c$ to reduce computational cost. Truncation omits contributions from pairs with $rr_c$, which produces a missing potential energy. The potential energy per unit volume for a homogeneous fluid can be expressed using the pair distribution function $g(r)$ as an integral over separations. When truncation is applied, the missing energy density is captured by an integral over $r\\ge r_c$.\n\nStarting from the fundamental definition of the potential energy of a uniform isotropic fluid and the relation to the Radial Distribution Function (RDF) $g(r)$, derive the leading-order dependence of the missing potential energy per unit volume on the cutoff $r_c$ under the approximation $g(r)=1$ for $rr_c$ and $u(r)\\sim -C_6 r^{-6}$ at large $r$. Your derivation must begin from the standard expression for the configurational energy density of a uniform fluid in terms of $g(r)$ and $u(r)$ and proceed by mathematically justified steps, without invoking any pre-derived tail-correction formulas.\n\nThen, design and implement a computational benchmark that varies $r_c$ over a set of values and quantifies deviations from the derived scaling when $g(r)\\neq 1$. Model deviations beyond the cutoff by setting $g(r)=1+h(r)$ for $r\\ge r_c$, where $h(r)$ is a controlled, decaying, oscillatory function,\n$$\nh(r) = A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big),\\quad r\\ge r_c,\n$$\nwith amplitude $A$, correlation length $\\xi$, and wavenumber $k$. Use this $h(r)$ strictly for $r\\ge r_c$ and $h(r)=0$ for $rr_c$.\n\nYour program must:\n- For each test case, compute the actual missing energy density $\\Delta U/V$ by splitting the integral into a leading term assuming $g(r)=1$ and a corrective term involving $h(r)$, and evaluating the corrective term numerically. You must express all quantities in dimensionless reduced units, and the final outputs must be dimensionless decimal floats.\n- For each test case, fit a proportionality $s_{\\text{fit}}$ in the relation $\\Delta U/V \\approx s\\, r_c^{-3}$ using least squares with zero intercept across the provided set of cutoff values $r_c$, where $s_{\\text{fit}}$ is the fitted slope and $s_{\\text{th}}$ is the theoretical slope implied by your derivation.\n- Report, for each test case, the absolute relative deviation $|s_{\\text{fit}}-s_{\\text{th}}|/|s_{\\text{th}}|$ as a single decimal float.\n\nPhysical and numerical unit instructions:\n- Use reduced, dimensionless units throughout; no physical units are required.\n- Angles in the cosine function must be in radians, and the parameter $k$ is a wavenumber in radians per unit length.\n- The final answers must be decimal floats.\n\nTest suite:\n- Test case 1 (baseline, no structural correlations beyond the cutoff): $\\rho=0.85$, $C_6=1.0$, $A=0.0$, $\\xi=1.0$, $k=1.0$, $r_c\\in\\{1.2,1.5,2.0,3.0\\}$.\n- Test case 2 (moderate correlations): $\\rho=0.85$, $C_6=1.0$, $A=0.1$, $\\xi=1.2$, $k=4.0$, $r_c\\in\\{1.2,1.5,2.0,3.0\\}$.\n- Test case 3 (stronger correlations and different fluid parameters): $\\rho=1.2$, $C_6=0.75$, $A=0.25$, $\\xi=0.8$, $k=3.0$, $r_c\\in\\{1.0,1.3,1.8,2.5\\}$.\n- Test case 4 (large cutoffs, weak correlations): $\\rho=0.30$, $C_6=2.0$, $A=0.05$, $\\xi=2.5$, $k=1.0$, $r_c\\in\\{5.0,7.0,10.0,15.0\\}$.\n\nFinal output format:\nYour program should produce a single line of output containing the absolute relative deviations for the four test cases as a comma-separated list enclosed in square brackets (e.g., \"[d1,d2,d3,d4]\"), where each $d_i$ is a decimal float.",
            "solution": "The problem requires a two-part response: first, a formal derivation of the leading-order tail correction for potential energy in a truncated pairwise potential, and second, the design and implementation of a computational benchmark to quantify deviations from this leading-order theory when structural correlations are present.\n\n### Part 1: Derivation of the Leading-Order Tail Correction\n\nThe configurational potential energy $U$ of a homogeneous, isotropic fluid of $N$ particles in a volume $V$ can be expressed in terms of the pairwise interaction potential $u(r)$ and the radial distribution function $g(r)$. The number of particles in a spherical shell of thickness $dr$ at a distance $r$ from a central particle is $\\rho g(r) 4\\pi r^2 dr$, where $\\rho = N/V$ is the number density. Each of these pairs contributes $u(r)$ to the potential energy. Summing over all pairs and dividing by $2$ to correct for double counting, the total potential energy is given by:\n$$\nU = \\frac{1}{2} N \\int_0^\\infty u(r) \\rho g(r) 4\\pi r^2 dr\n$$\nThe potential energy per unit volume, or energy density, is obtained by dividing by $V$:\n$$\n\\frac{U}{V} = \\frac{1}{2} \\frac{N}{V} \\rho \\int_0^\\infty u(r) g(r) 4\\pi r^2 dr = 2\\pi\\rho^2 \\int_0^\\infty u(r) g(r) r^2 dr\n$$\nIn molecular simulations, the potential is often truncated at a cutoff distance $r_c$. This means the contribution to the energy from pairs with separation $r  r_c$ is neglected. This missing potential energy density, which we denote as $\\Delta U/V$, is given by the integral from $r_c$ to infinity:\n$$\n\\frac{\\Delta U}{V} = 2\\pi\\rho^2 \\int_{r_c}^\\infty u(r) g(r) r^2 dr\n$$\nTo derive the leading-order dependence on $r_c$, we introduce two standard approximations valid for large separations $r$, which includes the domain of integration $r \\ge r_c$ (assuming $r_c$ is sufficiently large):\n1. The interaction potential decays as the leading term of the dispersion interaction: $u(r) \\approx -C_6 r^{-6}$.\n2. At large separations, correlations between particles vanish, so the radial distribution function approaches unity: $g(r) \\approx 1$.\n\nSubstituting these approximations into the expression for the missing energy density yields:\n$$\n\\frac{\\Delta U}{V} \\approx 2\\pi\\rho^2 \\int_{r_c}^\\infty (-C_6 r^{-6}) (1) r^2 dr\n$$\nWe can factor out the constants and evaluate the elementary integral:\n$$\n\\frac{\\Delta U}{V} \\approx -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} dr\n$$\nThe integral is:\n$$\n\\int_{r_c}^\\infty r^{-4} dr = \\left[ \\frac{r^{-3}}{-3} \\right]_{r_c}^{\\infty} = \\lim_{b \\to \\infty} \\left( -\\frac{1}{3b^3} \\right) - \\left( -\\frac{1}{3r_c^3} \\right) = 0 + \\frac{1}{3r_c^3} = \\frac{1}{3}r_c^{-3}\n$$\nSubstituting this result back, we obtain the final expression for the leading-order tail correction:\n$$\n\\frac{\\Delta U}{V} \\approx -2\\pi\\rho^2 C_6 \\left( \\frac{1}{3}r_c^{-3} \\right) = -\\frac{2\\pi}{3}\\rho^2 C_6 r_c^{-3}\n$$\nThis derivation establishes that the missing energy density scales as $r_c^{-3}$ for large $r_c$. The problem asks to consider the relationship $\\Delta U/V \\approx s\\, r_c^{-3}$. By comparison, we identify the theoretical proportionality constant (slope) as:\n$$\ns_{\\text{th}} = -\\frac{2\\pi}{3}\\rho^2 C_6\n$$\n\n### Part 2: Computational Analysis of Structural Correlation Effects\n\nThe derivation above relies on the approximation $g(r)=1$ for $r  r_c$. In reality, structural correlations persist, meaning $g(r)$ may deviate from $1$. We are given a model for this deviation:\n$$\ng(r) = 1 + h(r), \\quad \\text{for } r \\ge r_c\n$$\nwhere\n$$\nh(r) = A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big)\n$$\nThe actual missing energy density is then:\n$$\n\\frac{\\Delta U}{V} = 2\\pi\\rho^2 \\int_{r_c}^\\infty u(r) (1+h(r)) r^2 dr\n$$\nUsing $u(r) = -C_6 r^{-6}$, we can split the integral into two parts:\n$$\n\\frac{\\Delta U}{V} = -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} dr - 2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4}h(r) dr\n$$\nThe first term is the leading-order contribution, which we have already evaluated analytically:\n$$\n\\left(\\frac{\\Delta U}{V}\\right)_{g=1} = -\\frac{2\\pi}{3}\\rho^2 C_6 r_c^{-3} = s_{\\text{th}} r_c^{-3}\n$$\nThe second term is the correction due to structural correlations, which we denote as $(\\Delta U/V)_h$:\n$$\n\\left(\\frac{\\Delta U}{V}\\right)_{h} = -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big) dr\n$$\nThis integral does not have a simple closed-form solution and must be evaluated numerically. The total missing energy density for a given $r_c$ is the sum of these two terms.\n\nThe computational algorithm proceeds as follows for each test case:\n1.  Calculate the theoretical slope $s_{\\text{th}} = -\\frac{2\\pi}{3}\\rho^2 C_6$.\n2.  For each cutoff radius $r_{c,i}$ in the provided set, compute the total missing energy density $y_i = \\Delta U/V(r_{c,i})$.\n    - The leading term is $I_{1,i} = s_{\\text{th}} r_{c,i}^{-3}$.\n    - The corrective term $I_{2,i} = (\\Delta U/V)_h$ is computed by numerically integrating its defining expression from $r_{c,i}$ to $\\infty$. The integrand is well-behaved, decaying exponentially, making numerical quadrature efficient and accurate.\n    - The total energy is $y_i = I_{1,i} + I_{2,i}$.\n3.  We now have a set of data points $(x_i, y_i)$, where $x_i = r_{c,i}^{-3}$. We wish to fit these data to the model $y = s_{\\text{fit}} x$. For a linear regression with a zero intercept, the least squares estimate for the slope $s_{\\text{fit}}$ is given by:\n    $$\n    s_{\\text{fit}} = \\frac{\\sum_i x_i y_i}{\\sum_i x_i^2}\n    $$\n4.  Finally, the absolute relative deviation between the fitted slope and the theoretical slope is computed. This value quantifies the systematic error introduced by the $g(r)=1$ approximation when fitting the $r_c^{-3}$ scaling across a range of cutoffs.\n    $$\n    \\text{Deviation} = \\frac{|s_{\\text{fit}} - s_{\\text{th}}|}{|s_{\\text{th}}|}\n    $$\nThe provided Python code implements this algorithm to determine the deviation for each of the four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the deviation from theoretical scaling for tail corrections\n    in truncated potentials due to structural correlations.\n    \"\"\"\n    # Test cases: (rho, C6, A, xi, k, list_of_rc)\n    test_cases = [\n        (0.85, 1.0, 0.0, 1.0, 1.0, [1.2, 1.5, 2.0, 3.0]),\n        (0.85, 1.0, 0.1, 1.2, 4.0, [1.2, 1.5, 2.0, 3.0]),\n        (1.2, 0.75, 0.25, 0.8, 3.0, [1.0, 1.3, 1.8, 2.5]),\n        (0.30, 2.0, 0.05, 2.5, 1.0, [5.0, 7.0, 10.0, 15.0]),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho, C6, A, xi, k, rcs = case\n\n        # 1. Calculate the theoretical slope s_th based on the g(r)=1 approximation.\n        # s_th corresponds to the proportionality constant in Delta_U/V = s * r_c^(-3).\n        s_th = -(2.0 / 3.0) * np.pi * rho**2 * C6\n\n        # Lists to store values for the least squares fit\n        y_values = []  # Total missing energy density, Delta_U/V\n        x_values = []  # r_c^(-3)\n\n        for rc in rcs:\n            # The independent variable for the fit is x = r_c^(-3)\n            x = np.power(rc, -3.0)\n            x_values.append(x)\n\n            # 2. Calculate the total missing energy density y = Delta_U/V(rc).\n            # This is split into a leading term (I1) and a corrective term (I2).\n\n            # The leading term (I1) is the analytical result assuming g(r)=1.\n            I1 = s_th * x\n\n            # The corrective term (I2) arises from the deviation h(r) = g(r) - 1.\n            # It is computed via numerical integration.\n            I2 = 0.0\n            if A != 0.0:\n                # Integrand for the corrective term (excluding constant prefactors).\n                # h(r) = A * exp(-(r-rc)/xi) * cos(k*(r-rc))\n                # Full integrand is r^(-4) * h(r)\n                integrand = lambda r: np.power(r, -4.0) * A * np.exp(-(r - rc) / xi) * np.cos(k * (r - rc))\n                \n                # Perform numerical integration from rc to infinity.\n                integral_val, _ = quad(integrand, rc, np.inf)\n                \n                # Multiply by the constant prefactor.\n                prefactor = -2.0 * np.pi * rho**2 * C6\n                I2 = prefactor * integral_val\n            \n            # The total missing energy density is the sum of the two terms.\n            y = I1 + I2\n            y_values.append(y)\n\n        # 3. Perform a least squares fit with zero intercept for y = s_fit * x.\n        x_arr = np.array(x_values)\n        y_arr = np.array(y_values)\n        \n        # The formula for the slope (s_fit) is dot(x,y) / dot(x,x).\n        s_fit = np.dot(x_arr, y_arr) / np.dot(x_arr, x_arr)\n        \n        # 4. Calculate the absolute relative deviation.\n        if s_th == 0:\n            # This case is not expected with the given test data, but is good practice.\n            # If s_th is 0, the deviation is infinite if s_fit is not 0.\n            deviation = np.inf if s_fit != 0 else 0.0\n        else:\n            deviation = np.abs(s_fit - s_th) / np.abs(s_th)\n        \n        results.append(deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}