{
    "hands_on_practices": [
        {
            "introduction": "We begin by exploring the fundamental mechanism of a weak-coupling thermostat. This exercise models the algorithm's first-order kinetics as a discrete-time process, challenging you to derive the exact trajectory of the system's temperature as it relaxes toward a target value . By calculating the number of steps required to cool a system, you will gain a practical intuition for how the coupling strength $\\tau_T$ and timestep $\\Delta t$ interact to control thermal equilibration.",
            "id": "3459750",
            "problem": "In a constant-temperature Molecular Dynamics (MD) simulation using a weak coupling (Berendsen) thermostat, the instantaneous kinetic temperature is defined by the equipartition theorem as proportional to the total kinetic energy, so that scaling all velocities by a factor $\\lambda$ scales the temperature by $\\lambda^{2}$. The weak coupling thermostat is designed to impose a first-order relaxation of the kinetic temperature toward a target temperature $T_{0}$ with relaxation time $\\tau_{T}$. Consider a time discretization with time step $\\Delta t$, and let $T_{n}$ denote the kinetic temperature after $n$ thermostat applications, with initial value $T_{0\\text{,init}}=T(0)=T_{i}$.\n\nStarting from the fundamental laws of Newtonian mechanics together with the equipartition theorem and the principle of first-order relaxation toward the target temperature implemented by a velocity-rescaling step at each discrete time, derive the discrete-time update relation for $T_{n}$ and solve it in closed form to obtain $T_{n}$ as a function of $n$, $T_{i}$, $T_{0}$, $\\Delta t$, and $\\tau_{T}$. Then determine the minimal integer number of steps $n$ required to ensure $\\lvert T_{n}-T_{0}\\rvert\\le \\varepsilon$.\n\nUse the following physically realistic parameters: $T_{0}=300\\,\\mathrm{K}$, $T_{i}=800\\,\\mathrm{K}$, $\\Delta t=2\\,\\mathrm{fs}$, $\\tau_{T}=0.2\\,\\mathrm{ps}$, and $\\varepsilon=2\\,\\mathrm{K}$. Report only the minimal integer $n$ as your final answer. No rounding by significant figures is required beyond the determination of this minimal integer. Express any intermediate temperatures in $\\mathrm{K}$ and times in $\\mathrm{fs}$ or $\\mathrm{ps}$ as appropriate.",
            "solution": "The Berendsen thermostat is designed to enforce a first-order kinetic relaxation of the system's temperature $T$ towards a target temperature $T_{0}$ with a characteristic relaxation time $\\tau_{T}$. The underlying continuous dynamics are described by the differential equation:\n$$\n\\frac{dT}{dt} = \\frac{T_{0} - T}{\\tau_{T}}\n$$\nIn a Molecular Dynamics simulation with a discrete time step $\\Delta t$, a simple forward Euler discretization of this equation provides the update rule for the temperature at step $n+1$, denoted $T_{n+1}$, based on the temperature at step $n$, denoted $T_{n}$:\n$$\n\\frac{T_{n+1} - T_{n}}{\\Delta t} = \\frac{T_{0} - T_{n}}{\\tau_{T}}\n$$\nThis can be rearranged to express $T_{n+1}$ directly:\n$$\nT_{n+1} = T_{n} + \\frac{\\Delta t}{\\tau_{T}} (T_{0} - T_{n})\n$$\nThis update is physically implemented by scaling all particle velocities by a factor $\\lambda$ at each step. The kinetic temperature $T$ is proportional to the total kinetic energy, which is a quadratic function of the velocities. Therefore, scaling velocities by $\\lambda$ scales the temperature by $\\lambda^{2}$: $T_{n+1} = \\lambda_{n}^{2} T_{n}$. The scaling factor $\\lambda_{n}$ is chosen to satisfy the discretized relaxation equation.\n\nLet's define the constant ratio $r = \\frac{\\Delta t}{\\tau_{T}}$. The recurrence relation becomes:\n$$\nT_{n+1} = (1-r)T_{n} + rT_{0}\n$$\nThis is a first-order linear non-homogeneous recurrence relation. To solve it, we can find the fixed point by setting $T_{n+1} = T_{n} = T_{eq}$, which gives $T_{eq} = (1-r)T_{eq} + rT_{0}$, leading to $rT_{eq} = rT_{0}$, so the equilibrium temperature is $T_{eq} = T_{0}$ as expected.\n\nLet's define a new variable $\\delta_{n} = T_{n} - T_{0}$, representing the deviation from the target temperature. Substituting $T_{n} = \\delta_{n} + T_{0}$ into the recurrence relation:\n$$\n(\\delta_{n+1} + T_{0}) = (1-r)(\\delta_{n} + T_{0}) + rT_{0}\n$$\n$$\n\\delta_{n+1} + T_{0} = (1-r)\\delta_{n} + (1-r)T_{0} + rT_{0}\n$$\n$$\n\\delta_{n+1} + T_{0} = (1-r)\\delta_{n} + T_{0}\n$$\n$$\n\\delta_{n+1} = (1-r)\\delta_{n}\n$$\nThis is a simple geometric progression. The solution is $\\delta_{n} = (1-r)^{n} \\delta_{0}$.\nThe initial deviation is $\\delta_{0} = T(0) - T_{0} = T_{i} - T_{0}$, where $T_{i}$ is the initial temperature.\nSubstituting back, we get the expression for the deviation at step $n$:\n$$\nT_{n} - T_{0} = (T_{i} - T_{0})(1-r)^{n}\n$$\nThe closed-form solution for $T_{n}$ is therefore:\n$$\nT_{n} = T_{0} + (T_{i} - T_{0}) \\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)^{n}\n$$\nThe problem requires finding the minimal integer number of steps $n$ to ensure that the absolute difference between the system temperature and the target temperature is less than or equal to a tolerance $\\varepsilon$:\n$$\n|T_{n} - T_{0}| \\le \\varepsilon\n$$\nUsing the derived expression for $T_{n} - T_{0}$:\n$$\n\\left| (T_{i} - T_{0}) \\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)^{n} \\right| \\le \\varepsilon\n$$\nThe given parameters are:\n- Initial temperature $T_{i}=800\\,\\mathrm{K}$\n- Target temperature $T_{0}=300\\,\\mathrm{K}$\n- Time step $\\Delta t=2\\,\\mathrm{fs}$\n- Relaxation time $\\tau_{T}=0.2\\,\\mathrm{ps} = 200\\,\\mathrm{fs}$\n- Temperature tolerance $\\varepsilon=2\\,\\mathrm{K}$\n\nFirst, let's evaluate the terms. The initial temperature difference is $T_{i} - T_{0} = 800\\,\\mathrm{K} - 300\\,\\mathrm{K} = 500\\,\\mathrm{K}$. This is positive.\nThe ratio of time scales is $r = \\frac{\\Delta t}{\\tau_{T}} = \\frac{2\\,\\mathrm{fs}}{200\\,\\mathrm{fs}} = 0.01$.\nThe term $(1 - \\frac{\\Delta t}{\\tau_{T}}) = 1 - 0.01 = 0.99$. This term is positive and less than $1$.\nSo, the inequality can be written without the absolute value signs:\n$$\n(T_{i} - T_{0}) \\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)^{n} \\le \\varepsilon\n$$\nWe need to solve for $n$:\n$$\n\\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)^{n} \\le \\frac{\\varepsilon}{T_{i} - T_{0}}\n$$\nTaking the natural logarithm of both sides:\n$$\nn \\ln\\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right) \\le \\ln\\left( \\frac{\\varepsilon}{T_{i} - T_{0}} \\right)\n$$\nSince $1 - \\frac{\\Delta t}{\\tau_{T}} < 1$, its logarithm is negative. Therefore, when we divide by $\\ln(1 - \\frac{\\Delta t}{\\tau_{T}})$, we must reverse the inequality sign:\n$$\nn \\ge \\frac{\\ln\\left( \\frac{\\varepsilon}{T_{i} - T_{0}} \\right)}{\\ln\\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)}\n$$\nNow, we substitute the numerical values:\n$$\nn \\ge \\frac{\\ln\\left( \\frac{2}{800 - 300} \\right)}{\\ln\\left( 1 - \\frac{2}{200} \\right)}\n$$\n$$\nn \\ge \\frac{\\ln\\left( \\frac{2}{500} \\right)}{\\ln\\left( 1 - 0.01 \\right)}\n$$\n$$\nn \\ge \\frac{\\ln(0.004)}{\\ln(0.99)}\n$$\nUsing a calculator for the values of the logarithms:\n$$\n\\ln(0.004) \\approx -5.52146\n$$\n$$\n\\ln(0.99) \\approx -0.01005\n$$\nSo, the inequality for $n$ is:\n$$\nn \\ge \\frac{-5.52146}{-0.01005} \\approx 549.399\n$$\nSince $n$ must be an integer representing the number of simulation steps, we must take the smallest integer that satisfies this condition. This is the ceiling of the calculated value.\n$$\nn_{min} = \\lceil 549.399 \\rceil = 550\n$$\nThus, a minimum of $550$ thermostat applications (steps) are required to bring the temperature deviation within the specified tolerance.",
            "answer": "$$\n\\boxed{550}\n$$"
        },
        {
            "introduction": "The temperature $T$ in a thermostat's governing equation is not an abstract parameter but a quantity calculated directly from the particles' motion. This practice takes you inside the simulation to compute the instantaneous kinetic temperature for a system of complex molecules, applying the equipartition principle . Success requires a careful accounting of all translational and rotational degrees of freedom, including the removal of degrees of freedom corresponding to conserved quantities, a critical skill in statistical mechanics.",
            "id": "3459751",
            "problem": "Consider a Molecular Dynamics (MD) simulation of an ensemble of $N_{m}$ identical rigid linear molecules in a periodic cubic box. The MD integrator removes the global center-of-mass drift at every timestep, which is equivalent to constraining the total linear momentum of the system to zero. The instantaneous kinetic temperature $T_{\\mathrm{kin}}$ used by a velocity-scaling weak-coupling thermostat is defined by equating the instantaneous total kinetic energy of all thermostatted quadratic degrees of freedom to the thermal energy.\n\nFor a rigid linear molecule, the kinetic energy consists of translational and rotational parts. The rotational energy includes rotation about two perpendicular axes through the center of mass; rotation about the molecular axis does not contribute because the moment of inertia about that axis is negligible at the classical level.\n\nFrom a single instantaneous configuration, you recorded the following quantities:\n- The translational sum $S_{v} \\equiv \\sum_{i=1}^{N_{m}} m_{i}\\,|\\mathbf{v}_{i}|^{2} = 6.60 \\times 10^{-18}$ J.\n- The rotational sum $S_{\\omega} \\equiv \\sum_{i=1}^{N_{m}} \\boldsymbol{\\omega}_{i}^{\\top}\\mathbf{I}_{i}\\,\\boldsymbol{\\omega}_{i} = 4.17 \\times 10^{-18}$ J.\n\nAssume $N_{m} = 512$, and that only the global center-of-mass constraint is applied (no other global constraints). The Boltzmann constant is $k_{B} = 1.380649 \\times 10^{-23}$ J K$^{-1}$.\n\nStarting from first principles and appropriate degree-of-freedom counting for rigid linear molecules, compute the instantaneous kinetic temperature $T_{\\mathrm{kin}}$ consistent with a velocity-scaling weak-coupling thermostat. Round your answer to four significant figures and express the temperature in Kelvin.",
            "solution": "The instantaneous kinetic temperature, $T_{\\mathrm{kin}}$, is defined by relating the total instantaneous kinetic energy of the system, $K_{\\mathrm{total}}$, to the number of available (thermostatted) quadratic degrees of freedom, $N_{\\mathrm{dof}}$. This relationship is an instantaneous application of the equipartition theorem:\n$$K_{\\mathrm{total}} = \\frac{1}{2} N_{\\mathrm{dof}} k_{B} T_{\\mathrm{kin}}$$\nTo find $T_{\\mathrm{kin}}$, we must first determine $K_{\\mathrm{total}}$ and $N_{\\mathrm{dof}}$ from the provided information.\n\n**1. Calculation of the Total Instantaneous Kinetic Energy ($K_{\\mathrm{total}}$)**\n\nThe total kinetic energy is the sum of the translational and rotational kinetic energies of all molecules:\n$$K_{\\mathrm{total}} = K_{\\mathrm{trans}} + K_{\\mathrm{rot}}$$\nThe translational kinetic energy, $K_{\\mathrm{trans}}$, is given by $K_{\\mathrm{trans}} = \\sum_{i=1}^{N_{m}} \\frac{1}{2} m_{i} |\\mathbf{v}_{i}|^{2}$. Using the provided translational sum $S_{v} = \\sum_{i=1}^{N_{m}} m_{i} |\\mathbf{v}_{i}|^{2}$, we have:\n$$K_{\\mathrm{trans}} = \\frac{1}{2} S_{v}$$\nThe rotational kinetic energy, $K_{\\mathrm{rot}}$, for a system of rigid bodies is given by $K_{\\mathrm{rot}} = \\sum_{i=1}^{N_{m}} \\frac{1}{2} \\boldsymbol{\\omega}_{i}^{\\top}\\mathbf{I}_{i}\\,\\boldsymbol{\\omega}_{i}$. Using the provided rotational sum $S_{\\omega} = \\sum_{i=1}^{N_{m}} \\boldsymbol{\\omega}_{i}^{\\top}\\mathbf{I}_{i}\\,\\boldsymbol{\\omega}_{i}$, we have:\n$$K_{\\mathrm{rot}} = \\frac{1}{2} S_{\\omega}$$\nTherefore, the total instantaneous kinetic energy is:\n$$K_{\\mathrm{total}} = \\frac{1}{2} S_{v} + \\frac{1}{2} S_{\\omega} = \\frac{1}{2} (S_{v} + S_{\\omega})$$\nSubstituting the given values:\n$$S_{v} = 6.60 \\times 10^{-18} \\, \\mathrm{J}$$\n$$S_{\\omega} = 4.17 \\times 10^{-18} \\, \\mathrm{J}$$\n$$K_{\\mathrm{total}} = \\frac{1}{2} (6.60 \\times 10^{-18} \\, \\mathrm{J} + 4.17 \\times 10^{-18} \\, \\mathrm{J}) = \\frac{1}{2} (10.77 \\times 10^{-18} \\, \\mathrm{J}) = 5.385 \\times 10^{-18} \\, \\mathrm{J}$$\n\n**2. Calculation of the Number of Degrees of Freedom ($N_{\\mathrm{dof}}$)**\n\nThe number of thermostatted degrees of freedom is the total number of quadratic terms in the kinetic energy expression, minus the number of constraints applied to the system.\n\nFor a system of $N_{m}$ identical rigid linear molecules:\n- Each molecule has $3$ translational degrees of freedom, associated with motion of its center of mass in three-dimensional space.\n- Each molecule has $2$ rotational degrees of freedom, as rotation about the principal axis aligned with the molecule is classically negligible.\nThus, the total number of degrees of freedom for an unconstrained system would be $(3 + 2)N_m = 5 N_m$.\n\nThe problem states that a constraint is applied: the global center-of-mass drift is removed. This is equivalent to setting the total linear momentum of the system to zero:\n$$\\sum_{i=1}^{N_{m}} m_{i} \\mathbf{v}_{i} = \\mathbf{0}$$\nThis is a vector equation, which imposes $3$ independent scalar constraints on the system's velocities (one for each Cartesian component $x, y, z$). These constraints reduce the number of translational degrees of freedom by $3$. The rotational degrees of freedom are unaffected by this constraint.\n\nTherefore, the number of thermostatted degrees of freedom is:\n$$N_{\\mathrm{dof}} = (\\text{Total DoF}) - (\\text{Number of Constraints})$$\n$$N_{\\mathrm{dof}} = (3 N_{m} + 2 N_{m}) - 3 = 5 N_{m} - 3$$\nSubstituting the given value $N_{m} = 512$:\n$$N_{\\mathrm{dof}} = 5(512) - 3 = 2560 - 3 = 2557$$\n\n**3. Calculation of the Instantaneous Kinetic Temperature ($T_{\\mathrm{kin}}$)**\n\nWe now rearrange the defining equation for $T_{\\mathrm{kin}}$:\n$$T_{\\mathrm{kin}} = \\frac{2 K_{\\mathrm{total}}}{N_{\\mathrm{dof}} k_{B}}$$\nSubstituting the calculated values for $K_{\\mathrm{total}}$, $N_{\\mathrm{dof}}$, and the given value for $k_{B}$:\n$$K_{\\mathrm{total}} = 5.385 \\times 10^{-18} \\, \\mathrm{J}$$\n$$N_{\\mathrm{dof}} = 2557$$\n$$k_{B} = 1.380649 \\times 10^{-23} \\, \\mathrm{J}\\,\\mathrm{K}^{-1}$$\n$$T_{\\mathrm{kin}} = \\frac{2 \\times (5.385 \\times 10^{-18})}{2557 \\times (1.380649 \\times 10^{-23})} = \\frac{1.077 \\times 10^{-17}}{3.530347 \\times 10^{-19}} \\, \\mathrm{K}$$\n$$T_{\\mathrm{kin}} \\approx 305.068... \\, \\mathrm{K}$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$T_{\\mathrm{kin}} \\approx 305.1 \\, \\mathrm{K}$$\nThis is the instantaneous kinetic temperature of the system consistent with the definitions used by a weak-coupling thermostat.",
            "answer": "$$\n\\boxed{305.1}\n$$"
        },
        {
            "introduction": "While simple and effective for bringing a system to a target temperature, weak-coupling thermostats are known to introduce significant artifacts that corrupt the system's natural dynamics. This advanced exercise uses the idealized model of a harmonic crystal to reveal the root cause of this issue, which can lead to the infamous \"flying ice cube\" effect . By analyzing how periodic velocity scaling disproportionately affects different vibrational modes, you will uncover why this method fails to generate a true canonical ensemble and can suppress important dynamical fluctuations.",
            "id": "3459746",
            "problem": "Consider a one-dimensional harmonic crystal modeled in Molecular Dynamics (MD), composed of $N$ identical particles of mass $m$ coupled by harmonic nearest-neighbor interactions. Under the normal mode transformation, each mode indexed by $j$ evolves independently as a harmonic oscillator with coordinate $q_j(t)$, velocity $v_j(t)$, and angular frequency $\\omega_j$, obeying Newtonâ€™s second law $m\\,\\mathrm{d}^2 q_j/\\mathrm{d}t^2 = -\\partial U/\\partial q_j$ with harmonic potential energy $U = \\frac{1}{2} m \\omega_j^2 q_j^2$. \n\nA global velocity scaling thermostat of the weak coupling (WC) type is applied periodically with period $\\tau_s$: at times $t_k = k \\tau_s$ for integer $k \\ge 1$, all particle velocities are instantaneously multiplied by the same constant scaling factor $\\lambda$, with $0 < \\lambda \\neq 1$ fixed. This implies that each normal mode velocity transforms as $v_j(t_k^{+}) = \\lambda\\, v_j(t_k^{-})$, while positions $q_j(t)$ remain continuous across scaling events.\n\nAssume a single normal mode $j$ is in harmonic motion between scaling events, with solution $q_j(t) = A_j \\cos(\\omega_j t + \\phi_j)$ and $v_j(t) = -A_j \\omega_j \\sin(\\omega_j t + \\phi_j)$, where $A_j$ and $\\phi_j$ are constants determined by initial conditions. Define the mode energy immediately before a scaling event as $E_j(t_k^{-}) = \\frac{1}{2} m \\left[\\omega_j^2 q_j(t_k^{-})^2 + v_j(t_k^{-})^2\\right]$ and immediately after as $E_j(t_k^{+}) = \\frac{1}{2} m \\left[\\omega_j^2 q_j(t_k^{+})^2 + v_j(t_k^{+})^2\\right]$.\n\nYou are to analyze how the periodic global velocity scaling perturbs the relaxation of the normal mode energy. In particular:\n\n- Starting from the fundamental harmonic oscillator solution and energy definition, derive the per-event energy multiplication factor $r_j(\\theta_k) \\equiv E_j(t_k^{+})/E_j(t_k^{-})$ in terms of the phase $\\theta_k \\equiv \\omega_j t_k + \\phi_j$ and the scaling factor $\\lambda$.\n- For modes whose phases at scaling times sample uniformly on $[0,2\\pi)$ due to incommensurate $\\omega_j \\tau_s$, compute the geometric mean per-event energy multiplication factor $r_{\\mathrm{avg}}$ by averaging $\\ln r_j(\\theta_k)$ over $\\theta_k$.\n- Briefly identify, in terms of commensurability between $\\omega_j$ and $\\tau_s$, which frequency modes are most strongly affected by the periodic scaling in the sense of producing the largest coherent per-event energy change.\n\nProvide your final answer as a single closed-form analytic expression for the geometric mean per-event energy multiplication factor $r_{\\mathrm{avg}}$ as a function of $\\lambda$, with no numerical evaluation required. No units are required because the requested quantity is dimensionless. Do not provide any intermediate results in the final answer box.",
            "solution": "First, we derive the per-event energy multiplication factor $r_j(\\theta_k)$. For a single normal mode $j$, we will omit the index $j$ for notational clarity during the derivation. At a scaling time $t_k$, the phase is $\\theta_k = \\omega t_k + \\phi$.\n\nThe position and velocity immediately before the scaling event at $t=t_k$ are:\n$$q(t_k^{-}) = A \\cos(\\omega t_k + \\phi) = A \\cos(\\theta_k)$$\n$$v(t_k^{-}) = -A \\omega \\sin(\\omega t_k + \\phi) = -A \\omega \\sin(\\theta_k)$$\n\nThe energy of the mode just before the scaling is $E(t_k^{-})$. Since the harmonic oscillator energy is conserved between scaling events, this is also the total energy of the mode during the interval $(t_{k-1}, t_k)$.\n$$E(t_k^{-}) = \\frac{1}{2} m \\left[\\omega^2 q(t_k^{-})^2 + v(t_k^{-})^2\\right]$$\n$$E(t_k^{-}) = \\frac{1}{2} m \\left[\\omega^2 \\left(A \\cos(\\theta_k)\\right)^2 + \\left(-A \\omega \\sin(\\theta_k)\\right)^2\\right]$$\n$$E(t_k^{-}) = \\frac{1}{2} m A^2 \\omega^2 \\left[\\cos^2(\\theta_k) + \\sin^2(\\theta_k)\\right] = \\frac{1}{2} m A^2 \\omega^2$$\n\nImmediately after the scaling event, the position is continuous, while the velocity is multiplied by the factor $\\lambda$:\n$$q(t_k^{+}) = q(t_k^{-}) = A \\cos(\\theta_k)$$\n$$v(t_k^{+}) = \\lambda v(t_k^{-}) = -\\lambda A \\omega \\sin(\\theta_k)$$\n\nThe energy of the mode just after the scaling is $E(t_k^{+})$:\n$$E(t_k^{+}) = \\frac{1}{2} m \\left[\\omega^2 q(t_k^{+})^2 + v(t_k^{+})^2\\right]$$\n$$E(t_k^{+}) = \\frac{1}{2} m \\left[\\omega^2 \\left(A \\cos(\\theta_k)\\right)^2 + \\left(-\\lambda A \\omega \\sin(\\theta_k)\\right)^2\\right]$$\n$$E(t_k^{+}) = \\frac{1}{2} m A^2 \\omega^2 \\left[\\cos^2(\\theta_k) + \\lambda^2 \\sin^2(\\theta_k)\\right]$$\n\nThe per-event energy multiplication factor $r_j(\\theta_k)$ is the ratio of these energies:\n$$r_j(\\theta_k) = \\frac{E_j(t_k^{+})}{E_j(t_k^{-})} = \\frac{\\frac{1}{2} m A_j^2 \\omega_j^2 \\left[\\cos^2(\\theta_k) + \\lambda^2 \\sin^2(\\theta_k)\\right]}{\\frac{1}{2} m A_j^2 \\omega_j^2} = \\cos^2(\\theta_k) + \\lambda^2 \\sin^2(\\theta_k)$$\nThis completes the first part of the task.\n\nNext, we compute the geometric mean per-event energy multiplication factor, $r_{\\mathrm{avg}}$. This is defined via the average of the logarithm of $r_j(\\theta_k)$ over a uniform distribution of phases $\\theta_k \\in [0, 2\\pi)$.\n$$\\ln(r_{\\mathrm{avg}}) = \\langle \\ln(r_j(\\theta_k)) \\rangle_{\\theta_k}$$\nLet $\\theta$ represent the phase variable. The average is computed by the integral:\n$$\\ln(r_{\\mathrm{avg}}) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\ln\\left(\\cos^2(\\theta) + \\lambda^2 \\sin^2(\\theta)\\right) d\\theta$$\n\nThis integral, let's call it $I$, is a standard definite integral.\n$$I = \\int_0^{2\\pi} \\ln\\left(\\cos^2(\\theta) + \\lambda^2 \\sin^2(\\theta)\\right) d\\theta$$\nThe integrand is periodic with period $\\pi$ and symmetric about $\\theta=\\pi/2$, so we can write:\n$$I = 4 \\int_0^{\\pi/2} \\ln\\left(\\cos^2(\\theta) + \\lambda^2 \\sin^2(\\theta)\\right) d\\theta$$\nWe use the known identity for this type of integral:\n$$\\int_0^{\\pi/2} \\ln\\left(a^2 \\cos^2(x) + b^2 \\sin^2(x)\\right) dx = \\pi \\ln\\left(\\frac{a+b}{2}\\right) \\quad \\text{for } a > 0, b > 0$$\nIn our case, $a^2=1$ so $a=1$, and $b^2=\\lambda^2$ so $b=\\lambda$ (since we are given $0 < \\lambda$).\nApplying this identity:\n$$\\int_0^{\\pi/2} \\ln\\left(\\cos^2(\\theta) + \\lambda^2 \\sin^2(\\theta)\\right) d\\theta = \\pi \\ln\\left(\\frac{1+\\lambda}{2}\\right)$$\nSubstituting this back into the expression for $I$:\n$$I = 4 \\left[ \\pi \\ln\\left(\\frac{1+\\lambda}{2}\\right) \\right] = 4\\pi \\ln\\left(\\frac{1+\\lambda}{2}\\right)$$\nNow we can find $\\ln(r_{\\mathrm{avg}})$:\n$$\\ln(r_{\\mathrm{avg}}) = \\frac{1}{2\\pi} I = \\frac{4\\pi}{2\\pi} \\ln\\left(\\frac{1+\\lambda}{2}\\right) = 2 \\ln\\left(\\frac{1+\\lambda}{2}\\right)$$\nTo find $r_{\\mathrm{avg}}$, we exponentiate both sides:\n$$r_{\\mathrm{avg}} = \\exp\\left(2 \\ln\\left(\\frac{1+\\lambda}{2}\\right)\\right) = \\exp\\left(\\ln\\left(\\left(\\frac{1+\\lambda}{2}\\right)^2\\right)\\right)$$\n$$r_{\\mathrm{avg}} = \\left(\\frac{1+\\lambda}{2}\\right)^2$$\nThis provides the closed-form analytic expression for the geometric mean factor.\n\nFinally, we briefly identify the modes most strongly affected by the periodic scaling. The preceding calculation assumed that the phases $\\theta_k = \\omega_j t_k + \\phi_j$ are uniformly distributed, which occurs when the mode frequency $\\omega_j$ and the scaling period $\\tau_s$ are incommensurate.\n\nA coherent, non-random effect occurs for commensurate modes, where the phase evolution $\\theta_{k+1} = \\theta_k + \\omega_j \\tau_s \\pmod{2\\pi}$ is periodic with a short period. This happens when $\\omega_j \\tau_s$ is a rational multiple of $\\pi$. The strongest coherence, where the phase is identical at every scaling event, occurs when $\\omega_j \\tau_s = 2\\pi n$ for some integer $n$. A similarly strong coherent effect occurs if $\\omega_j \\tau_s = n\\pi$, which causes the energy factor $r_j(\\theta_k)$ to be identical at every step.\n\nThe magnitude of the per-event energy change is determined by how far $r_j(\\theta_k) = \\cos^2(\\theta_k) + \\lambda^2 \\sin^2(\\theta_k)$ is from $1$. The extrema of this function occur at:\n- $\\theta_k = n\\pi$ (turning points): $r_j = \\cos^2(n\\pi) + \\lambda^2 \\sin^2(n\\pi) = 1$. This corresponds to zero velocity, so scaling has no effect. This is the minimum energy change.\n- $\\theta_k = (n+\\frac{1}{2})\\pi$ (equilibrium crossings): $r_j = \\cos^2((n+\\frac{1}{2})\\pi) + \\lambda^2 \\sin^2((n+\\frac{1}{2})\\pi) = \\lambda^2$. As $\\lambda \\neq 1$, this gives the maximum deviation from $1$.\n\nTherefore, the modes most strongly affected are the commensurate ones (where $\\omega_j\\tau_s$ is a rational multiple of $\\pi$, most simply $\\omega_j \\tau_s = n\\pi$) whose initial phase $\\phi_j$ is such that the scaling events $t_k$ consistently coincide with the oscillator's maximum velocity (i.e., its passage through the equilibrium position, $q_j = 0$).",
            "answer": "$$\\boxed{\\left(\\frac{1+\\lambda}{2}\\right)^{2}}$$"
        }
    ]
}