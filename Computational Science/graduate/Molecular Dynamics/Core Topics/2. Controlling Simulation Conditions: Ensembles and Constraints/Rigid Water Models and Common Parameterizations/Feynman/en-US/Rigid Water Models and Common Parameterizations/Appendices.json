{
    "hands_on_practices": [
        {
            "introduction": "The concept of a 'rigid' molecule is a cornerstone of many classical force fields, offering significant computational advantages. Before delving into the dynamics, it is crucial to understand the static, mechanical definition of such a system. This first practice () grounds your understanding by asking you to return to first principles and determine the number of mechanical degrees of freedom and constraints for a collection of rigid water molecules, establishing the foundational accounting for molecular motion.",
            "id": "3443178",
            "problem": "Consider a classical molecular dynamics model in three-dimensional Euclidean space for a system composed of $N$ identical water molecules. Each water molecule is modeled explicitly by its three atoms (one oxygen and two hydrogens) with Cartesian coordinates, and the intramolecular geometry is to be treated as perfectly rigid. Assume there are no external holonomic constraints applied to the system as a whole (for example, do not fix the system center of mass or the total angular momentum), and ignore any boundary conditions that would reduce global motion.\n\nStarting from first principles for the counting of mechanical degrees of freedom and the definition of holonomic constraints, and using only the fact that a water monomer is a non-linear triatomic object, determine:\n\n- The total number of mechanical degrees of freedom of the constrained system as a function of $N$.\n- The minimal number of independent holonomic constraints that must be enforced per molecule to maintain fixed intramolecular geometry.\n\nYour final answer should be given as a pair of expressions depending on $N$ where appropriate, formatted as a single row matrix with the first entry equal to the total number of mechanical degrees of freedom of the system and the second entry equal to the number of independent holonomic constraints per molecule. No numerical rounding is required, and no units are needed in the final answer.",
            "solution": "The problem requires the determination of two quantities for a system of $N$ rigid water molecules in $3$-dimensional space: the total number of mechanical degrees of freedom and the number of holonomic constraints per molecule. We shall derive these from first principles.\n\nA degree of freedom in a mechanical system is an independent parameter that defines its configuration. For a system of point masses, each mass in $3$-dimensional space has $3$ translational degrees of freedom, corresponding to its coordinates along three mutually orthogonal axes.\n\nFirst, consider the system without any rigidity constraints. The system consists of $N$ water molecules. Each water molecule is composed of $3$ atoms ($1$ oxygen and $2$ hydrogens). Therefore, the total number of atoms in the system is $3N$. In the absence of any constraints, each of these $3N$ atoms can be treated as an independent point mass. The total number of degrees of freedom, $D_{unconstrained}$, for this unconstrained system is the total number of atoms multiplied by the degrees of freedom per atom:\n$$\nD_{unconstrained} = (3N) \\times 3 = 9N\n$$\n\nThe problem states that the intramolecular geometry of each water molecule is to be treated as perfectly rigid. A rigid body in $3$-dimensional space is an object where the distance between any two of its constituent particles remains constant. The motion of a rigid body can be completely described by the translation of its center of mass and the rotation about its center of mass.\n\nA general rigid body in $3$-dimensional space has $6$ degrees of freedom. These are:\n1.  $3$ translational degrees of freedom, which describe the position of the body's center of mass.\n2.  $3$ rotational degrees of freedom, which describe the orientation of the body in space.\n\nThis holds true for any non-linear object. The problem explicitly states that a water molecule is a non-linear triatomic object. Therefore, each rigid water molecule possesses $6$ mechanical degrees of freedom.\n\nThe system is composed of $N$ such identical, rigid water molecules. The problem specifies that there are no external holonomic constraints applied to the system as a whole. This implies that each molecule is free to translate and rotate independently of the others. Consequently, the total number of degrees of freedom for the entire system, $D_{system}$, is the sum of the degrees of freedom for each of the $N$ molecules:\n$$\nD_{system} = N \\times (\\text{degrees of freedom per rigid molecule}) = N \\times 6 = 6N\n$$\nThis is the first part of the required answer.\n\nNext, we must determine the minimal number of independent holonomic constraints that must be enforced per molecule to maintain this fixed intramolecular geometry. Let this number be $C_{molecule}$. A holonomic constraint is a relation between the coordinates of the particles, which can be expressed as an equation $f(q_1, q_2, \\dots, t) = 0$. Each independent holonomic constraint removes one degree of freedom from the system.\n\nFor a single water molecule, the unconstrained system of $3$ atoms has $3 \\times 3 = 9$ degrees of freedom. After applying the rigidity constraints, the molecule behaves as a single rigid body with $6$ degrees of freedom. The number of constraints is therefore the difference between the initial (unconstrained) and final (constrained) number of degrees of freedom:\n$$\nC_{molecule} = D_{unconstrained, 1 molecule} - D_{constrained, 1 molecule} = 9 - 6 = 3\n$$\nThus, $3$ independent holonomic constraints are required per molecule.\n\nWe can verify this by explicitly considering the geometry. To make a collection of $n_a = 3$ atoms rigid, we must fix their relative positions. This is achieved by fixing the distances between pairs of atoms. For $3$ atoms with positions $\\vec{r}_1, \\vec{r}_2, \\vec{r}_3$, we can define three interatomic distances: $d_{12} = |\\vec{r}_1 - \\vec{r}_2|$, $d_{23} = |\\vec{r}_2 - \\vec{r}_3|$, and $d_{13} = |\\vec{r}_1 - \\vec{r}_3|$. Imposing these three distances as constants fixes the shape of the triangle formed by the three atoms. These constraints can be written as:\n1.  $|\\vec{r}_1 - \\vec{r}_2|^2 - d_{12}^2 = 0$\n2.  $|\\vec{r}_2 - \\vec{r}_3|^2 - d_{23}^2 = 0$\n3.  $|\\vec{r}_3 - \\vec{r}_1|^2 - d_{31}^2 = 0$\n\nThese represent $3$ independent scalar equations. Therefore, a minimum of $3$ holonomic constraints are required to render a triatomic molecule rigid. This confirms our previous deduction.\n\nThe total number of constraints for the system of $N$ molecules is $C_{system} = N \\times C_{molecule} = 3N$. We can use this to provide a consistency check for the total degrees of freedom of the system:\n$$\nD_{system} = D_{unconstrained} - C_{system} = 9N - 3N = 6N\n$$\nThis result is consistent with our direct calculation based on rigid-body mechanics.\n\nIn summary:\n- The total number of mechanical degrees of freedom for the system of $N$ rigid water molecules is $6N$.\n- The minimal number of independent holonomic constraints per molecule required to enforce rigidity is $3$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6N & 3\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Every modeling choice has consequences for the physical properties predicted by a simulation. Making a molecule rigid, as opposed to flexible, directly impacts its thermodynamic behavior by removing the intramolecular vibrational modes that can store energy. This exercise () uses the classical equipartition theorem to quantify this effect, allowing you to derive the change in the constant-volume heat capacity, a fundamental measure of a system's response to heat.",
            "id": "3443194",
            "problem": "In classical Molecular Dynamics (MD) of liquid water at temperature $T$, consider two widely used modeling approaches for a single water molecule: a flexible nonlinear triatomic model, where the two O–H bond stretches and the H–O–H bend are modeled by harmonic potentials, and a rigid nonlinear triatomic model (as in common parameterizations such as Transferable Intermolecular Potential with 3 Points (TIP3P), Simple Point Charge Extended (SPC/E), or Transferable Intermolecular Potential with 4 Points/2005 (TIP4P/2005)), where both O–H bond lengths and the H–O–H angle are constrained. Using only the classical equipartition theorem as the fundamental starting point, and standard counting of mechanical degrees of freedom (DOF) for nonlinear molecules, derive the change in the classical molar constant-volume heat capacity when replacing the flexible water model by the rigid water model at the same temperature. Define the change as $\\Delta C_{V,m} \\equiv C_{V,m}^{\\mathrm{rigid}} - C_{V,m}^{\\mathrm{flex}}$. Express your final answer as a multiple of the molar gas constant $R$ (i.e., in units of $R$ without numerical substitution). No numerical rounding is required. State any assumptions you make.",
            "solution": "The problem requires the derivation of the change in the classical molar constant-volume heat capacity, $\\Delta C_{V,m} \\equiv C_{V,m}^{\\mathrm{rigid}} - C_{V,m}^{\\mathrm{flex}}$, when a flexible model of water is replaced by a rigid one. The derivation must be based solely on the classical equipartition theorem and the counting of mechanical degrees of freedom.\n\nFirst, we must validate the problem statement.\n\n**Step 1: Extract Givens**\n- **System**: Liquid water at temperature $T$.\n- **Model 1 (Flexible)**: A flexible nonlinear triatomic model where the two O–H bond stretches and the H–O–H bend are modeled by harmonic potentials.\n- **Model 2 (Rigid)**: A rigid nonlinear triatomic model where O–H bond lengths and the H–O–H angle are constrained.\n- **Theoretical Framework**: The classical equipartition theorem.\n- **Method**: Standard counting of mechanical degrees of freedom (DOF) for a nonlinear molecule.\n- **Target Quantity**: $\\Delta C_{V,m} = C_{V,m}^{\\mathrm{rigid}} - C_{V,m}^{\\mathrm{flex}}$.\n- **Output Format**: The answer must be expressed as a multiple of the molar gas constant, $R$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it deals with standard models (flexible vs. rigid water) in classical molecular dynamics and a fundamental principle of classical statistical mechanics (the equipartition theorem). The problem is well-posed, providing a clear objective and sufficient information to apply the specified theorem. The language is objective and unambiguous. The problem does not violate any scientific principles, is not based on false premises, and contains a complete and consistent setup.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. We may proceed with the solution.\n\nThe constant-volume molar heat capacity, $C_{V,m}$, is defined as the partial derivative of the molar internal energy, $U_m$, with respect to temperature at constant volume:\n$$C_{V,m} = \\left(\\frac{\\partial U_m}{\\partial T}\\right)_V$$\nThe molar internal energy $U_m$ is related to the average energy per molecule, $\\langle E \\rangle$, by $U_m = N_A \\langle E \\rangle$, where $N_A$ is Avogadro's constant.\n\nThe classical equipartition theorem states that, in thermal equilibrium, each quadratic degree of freedom contributes $\\frac{1}{2} k_B T$ to the average energy of a particle, where $k_B$ is the Boltzmann constant. Therefore, if a molecule has $d$ quadratic degrees of freedom, its average energy is $\\langle E \\rangle = \\frac{d}{2} k_B T$.\n\nThe molar internal energy is then $U_m = N_A \\frac{d}{2} k_B T = \\frac{d}{2} R T$, where we have used the identity $R = N_A k_B$.\n\nThe molar heat capacity is consequently:\n$$C_{V,m} = \\frac{\\partial}{\\partial T} \\left(\\frac{d}{2} R T\\right) = \\frac{d}{2} R$$\n\nThe problem thus reduces to determining the number of quadratic degrees of freedom, $d$, for a single water molecule in each of the two models. A water molecule ($H_2O$) is a nonlinear molecule composed of $N_{atoms} = 3$ atoms. The total number of mechanical degrees of freedom is $3 N_{atoms} = 3 \\times 3 = 9$. These are partitioned into translational, rotational, and vibrational degrees of freedom.\n\n**Case 1: Flexible Water Model**\nFor a nonlinear molecule, there are:\n- $3$ translational degrees of freedom, corresponding to motion of the center of mass. Each contributes a quadratic kinetic energy term (e.g., $\\frac{1}{2} m v_x^2$). This gives $3$ quadratic DOF.\n- $3$ rotational degrees of freedom, corresponding to rotation about the three principal axes. Each contributes a quadratic kinetic energy term (e.g., $\\frac{1}{2} I_x \\omega_x^2$). This gives $3$ quadratic DOF.\n- The remaining degrees of freedom are vibrational: $3 N_{atoms} - 3 - 3 = 9 - 6 = 3$ vibrational modes.\nThe problem states that these modes are modeled by harmonic potentials. A one-dimensional harmonic oscillator has an energy of the form $E_{vib} = \\frac{1}{2} \\mu \\dot{q}^2 + \\frac{1}{2} k q^2$, where $q$ is the displacement from equilibrium. This energy contains two quadratic terms: one kinetic and one potential. Therefore, each of the $3$ vibrational modes contributes $2$ quadratic degrees of freedom. This gives $3 \\times 2 = 6$ quadratic DOF from vibrations.\n\nThe total number of quadratic degrees of freedom for the flexible model, $d_{\\mathrm{flex}}$, is the sum of these contributions:\n$$d_{\\mathrm{flex}} = 3_{\\mathrm{trans, kin}} + 3_{\\mathrm{rot, kin}} + (3 \\times 2)_{\\mathrm{vib, kin+pot}} = 3 + 3 + 6 = 12$$\nThe corresponding molar constant-volume heat capacity is:\n$$C_{V,m}^{\\mathrm{flex}} = \\frac{d_{\\mathrm{flex}}}{2} R = \\frac{12}{2} R = 6R$$\n\n**Case 2: Rigid Water Model**\nIn a rigid model, all internal coordinates (bond lengths and angles) are fixed by constraints. This means the vibrational degrees of freedom are frozen and do not contribute to the internal energy. The molecule can only translate and rotate as a rigid body.\n- $3$ translational degrees of freedom (kinetic energy only): $3$ quadratic DOF.\n- $3$ rotational degrees of freedom (kinetic energy only): $3$ quadratic DOF.\nThe total number of quadratic degrees of freedom for the rigid model, $d_{\\mathrm{rigid}}$, is:\n$$d_{\\mathrm{rigid}} = 3_{\\mathrm{trans, kin}} + 3_{\\mathrm{rot, kin}} = 3 + 3 = 6$$\nThe corresponding molar constant-volume heat capacity is:\n$$C_{V,m}^{\\mathrm{rigid}} = \\frac{d_{\\mathrm{rigid}}}{2} R = \\frac{6}{2} R = 3R$$\n\n**Calculation of the Change**\nThe change in the molar constant-volume heat capacity is defined as $\\Delta C_{V,m} = C_{V,m}^{\\mathrm{rigid}} - C_{V,m}^{\\mathrm{flex}}$.\n$$\\Delta C_{V,m} = 3R - 6R = -3R$$\n\n**Assumptions**\nThis derivation relies on the following assumption, which is implied by the problem's strict instruction to use only the equipartition theorem and DOF counting: The change in the total heat capacity of the liquid is assumed to be determined entirely by the change in the intramolecular degrees of freedom. The contributions from the intermolecular potential energy to the heat capacity, while non-zero for a liquid, are assumed to either be the same for both models or are explicitly excluded from this analysis, such that their difference is zero. This simplifies the problem to considering only the kinetic and intramolecular potential energy terms accessible via the equipartition theorem. The result represents the change in the ideal-gas-like contribution to the heat capacity.",
            "answer": "$$\n\\boxed{-3R}\n$$"
        },
        {
            "introduction": "A correct physical model must be paired with a stable and accurate numerical algorithm to produce meaningful results. For rigid molecules, this involves specialized constraint algorithms that have their own subtle effects on energy conservation, a critical diagnostic in microcanonical simulations. This advanced practice () guides you through an analysis of how a simulation's timestep and constraint tolerance give rise to both short-term energy oscillations and long-term energy drift, equipping you with the tools to evaluate the quality of a rigid-body simulation.",
            "id": "3443225",
            "problem": "You are to model energy conservation properties for a single rigid water molecule integrated in the microcanonical ensemble (NVE) using a constrained, time-reversible, symplectic scheme (for example, velocity Verlet with a SHAKE-style position projection). Starting from Newton’s second law with holonomic constraints, treat the rigid water as a non-linear rigid triatomic with holonomic constraints that reduce its quadratic degrees of freedom to translational and rotational motions.\n\nUse the following foundational bases without shortcut formulas:\n- Newton’s second law with holonomic constraints and Lagrange multipliers.\n- The concept of a shadow Hamiltonian for symplectic integrators: the discrete-time trajectory exactly conserves a modified Hamiltonian whose deviation from the true Hamiltonian is of higher order in the time step.\n- The equipartition theorem for classical quadratic degrees of freedom at temperature $T$.\n- Dimensional consistency and order-of-magnitude reasoning for the effect of an inexact constraint projection tolerance on energy drift.\n\nWorking assumptions for quantitative estimates in this problem:\n- Consider one rigid water molecule (non-linear rigid triatomic), so the number of quadratic degrees of freedom is $6$, corresponding to $3$ translational and $3$ rotational modes. Hence, a characteristic energy scale is $E_{\\mathrm{char}} = 3 k_{\\mathrm{B}} T$, where $k_{\\mathrm{B}}$ is the Boltzmann constant.\n- Use $k_{\\mathrm{B}} = 0.008314462618$ kJ/(mol·K). Every final energy quantity must be expressed in kJ/mol.\n- Assume a characteristic angular frequency for the smooth intermolecular forces of rigid water of $\\omega_{\\mathrm{char}} = 2\\pi \\times 10^{12}$ s$^{-1}$ (that is, $1$ terahertz angular frequency scaled by $2\\pi$). This is used only to non-dimensionalize the time step when estimating bounded oscillations in the total energy.\n- The number of holonomic constraints enforcing rigidity is $m = 3$ for water (two bond-length constraints and one angle or equivalent).\n- The constraint solver stops when a dimensionless tolerance $\\varepsilon$ is reached; a nonzero $\\varepsilon$ breaks exact symplecticity and can induce a slow linear energy drift. Assume the per-step energy defect scales as $m \\varepsilon^2 E_{\\mathrm{char}}$.\n\nFrom these bases, you must derive two quantitative predictions for a given time step $\\Delta t$ (expressed in femtoseconds), constraint tolerance $\\varepsilon$ (dimensionless), and temperature $T$ (Kelvin):\n1) A bound on the oscillatory amplitude of the total energy about a constant mean due to the shadow Hamiltonian, in kJ/mol. Denote this amplitude by $A$. Your derivation must use the characteristic timescale provided to form a dimensionless small parameter and must be consistent with symplectic backward error analysis.\n2) A linear energy drift rate per nanosecond due to finite constraint tolerance, in kJ/(mol·ns). Denote this rate by $R$. Your derivation must be consistent with the per-step defect scaling and appropriate conversion of time units.\n\nAcceptability criterion over nanosecond timescales:\n- Define a non-dimensional threshold $\\theta = 0.01$. The drift rate $R$ is acceptable if $R \\le \\theta k_{\\mathrm{B}} T$. Interpret this as “no more than a fraction $\\theta$ of $k_{\\mathrm{B}} T$ of total energy drift per nanosecond.”\n\nAngle units are not required. All energies must be reported in kJ/mol and energy drift rates in kJ/(mol·ns). The time step must be interpreted in femtoseconds, and nanoseconds must be used for drift-rate reporting.\n\nTest suite:\nFor each parameter set $(T, \\Delta t, \\varepsilon, \\tau)$, where $\\tau$ is the total simulated time in nanoseconds, compute:\n- $A$ in kJ/mol,\n- $R$ in kJ/(mol·ns),\n- a boolean indicating whether the acceptability criterion holds.\n\nUse the following four cases, each corresponding to a common rigid water parameterization label, which you will treat identically in your derivation (labels are for identification only):\n- Case $1$: model label “TIP3P”, temperature $T = 300$ K, time step $\\Delta t = 2$ fs, tolerance $\\varepsilon = 10^{-4}$, total time $\\tau = 1$ ns.\n- Case $2$: model label “SPC/E”, temperature $T = 300$ K, time step $\\Delta t = 1$ fs, tolerance $\\varepsilon = 10^{-6}$, total time $\\tau = 1$ ns.\n- Case $3$: model label “TIP4P/2005”, temperature $T = 300$ K, time step $\\Delta t = 2$ fs, tolerance $\\varepsilon = 10^{-5}$, total time $\\tau = 10$ ns.\n- Case $4$: model label “TIP3P”, temperature $T = 600$ K, time step $\\Delta t = 2$ fs, tolerance $\\varepsilon = 5\\times 10^{-5}$, total time $\\tau = 1$ ns.\n\nYour program must:\n- Implement your derived expressions consistently for all cases.\n- Use $\\omega_{\\mathrm{char}}$ as given to non-dimensionalize $\\Delta t$ when estimating $A$.\n- Convert units carefully: femtoseconds to seconds and nanoseconds to seconds where appropriate.\n\nFinal output format:\nYour program should produce a single line of output containing a Python-style list of results, one per test case, in order, with each result being a three-element list $[A, R, \\text{boolean}]$. For example, the output must look like\n\"[[A1,R1,True],[A2,R2,False],[A3,R3,True],[A4,R4,False]]\"\nwith the actual floating-point values in place of $A1$, $R1$, etc. No other characters or lines should be printed.",
            "solution": "The problem requires the derivation of two quantities related to energy conservation in a molecular dynamics simulation of a single rigid water molecule: the amplitude of energy oscillations, $A$, arising from the use of a symplectic integrator, and the rate of linear energy drift, $R$, due to an inexact constraint-solving algorithm. The problem is scientifically well-posed and contains all necessary information for a complete derivation from first principles.\n\n**1. Derivation of the Energy Oscillation Amplitude ($A$)**\n\nA symplectic numerical integrator, such as the velocity Verlet algorithm, applied to a Hamiltonian system, does not conserve the true Hamiltonian, $H$. Instead, it exactly conserves a modified \"shadow\" Hamiltonian, $H_{\\text{shadow}}$. From the theory of backward error analysis, for a time step $\\Delta t$, the shadow Hamiltonian is an asymptotic series in even powers of $\\Delta t$:\n$$H_{\\text{shadow}} = H + \\mathcal{O}((\\Delta t)^2)$$\nThe true energy $H(t)$, when evaluated along a trajectory generated using $H_{\\text{shadow}}$, is therefore not constant but exhibits bounded oscillations around a mean value. The amplitude of these oscillations, which we denote as $A$, is proportional to the leading-order error term.\n\nThe problem specifies that the derivation should use the provided characteristic angular frequency $\\omega_{\\mathrm{char}} = 2\\pi \\times 10^{12}$ s$^{-1}$ to non-dimensionalize the time step, forming the dimensionless parameter $\\omega_{\\mathrm{char}} \\Delta t$. The magnitude of the energy fluctuations is also proportional to a characteristic energy of the system. The problem defines this as $E_{\\mathrm{char}} = 3 k_{\\mathrm{B}} T$. This is consistent with the equipartition theorem for a non-linear rigid molecule with $6$ degrees of freedom ($3$ translational and $3$ rotational), where the average energy is $\\langle E \\rangle = \\frac{6}{2} k_{\\mathrm{B}} T = 3 k_{\\mathrm{B}} T$.\n\nCombining these elements, we can construct an order-of-magnitude estimate for the amplitude $A$ by assuming a proportionality constant of unity:\n$$A \\approx (\\omega_{\\mathrm{char}} \\Delta t)^2 E_{\\mathrm{char}}$$\nTo ensure dimensional consistency, we must convert the time step $\\Delta t$, given in femtoseconds (fs), to seconds (s) using the relation $1 \\text{ fs} = 10^{-15} \\text{ s}$. Substituting $E_{\\mathrm{char}} = 3 k_{\\mathrm{B}} T$, the final expression for $A$ in kJ/mol is:\n$$A(T, \\Delta t) = \\left( \\omega_{\\mathrm{char}} \\cdot (\\Delta t \\times 10^{-15}) \\right)^2 \\cdot (3 k_{\\mathrm{B}} T)$$\n\n**2. Derivation of the Linear Energy Drift Rate ($R$)**\n\nThe enforcement of holonomic constraints for molecular rigidity is typically achieved with an iterative algorithm (like SHAKE) that stops when a certain numerical tolerance, $\\varepsilon$, is met. This finite tolerance breaks the perfect time-reversibility and symplecticity of the underlying integrator, introducing a small, systematic energy error in each step. This error accumulates over time, resulting in a linear energy drift.\n\nThe problem provides the scaling for the energy defect per time step, $\\Delta E_{\\mathrm{step}}$, as:\n$$\\Delta E_{\\mathrm{step}} \\propto m \\varepsilon^2 E_{\\mathrm{char}}$$\nHere, $m$ is the number of holonomic constraints. For a rigid water molecule, there are three constraints (two bond lengths and one angle), so $m=3$. Again assuming a proportionality constant of unity and substituting $E_{\\mathrm{char}} = 3 k_{\\mathrm{B}} T$:\n$$\\Delta E_{\\mathrm{step}} \\approx 3 \\cdot \\varepsilon^2 \\cdot (3 k_{\\mathrm{B}} T) = 9 \\varepsilon^2 k_{\\mathrm{B}} T$$\nThe energy drift rate, $R$, is the energy defect per unit time. The problem requires $R$ in units of kJ/(mol·ns). We obtain this by dividing the per-step energy defect (in kJ/mol) by the duration of the time step, $\\Delta t$, expressed in nanoseconds (ns). Given $\\Delta t$ in femtoseconds, we use the conversion $1 \\text{ ns} = 10^6 \\text{ fs}$, so $\\Delta t_{\\text{ns}} = \\Delta t_{\\text{fs}} \\times 10^{-6}$.\n$$R = \\frac{\\Delta E_{\\mathrm{step}}}{\\Delta t_{\\text{ns}}}$$\nThe final expression for the drift rate is:\n$$R(T, \\Delta t, \\varepsilon) = \\frac{9 \\varepsilon^2 k_{\\mathrm{B}} T}{\\Delta t \\times 10^{-6}}$$\n\n**3. Acceptability Criterion**\n\nThe problem defines an acceptability criterion for the drift rate: $R \\le \\theta k_{\\mathrm{B}} T$, with $\\theta = 0.01$. The interpretation is that the energy drift per nanosecond should not exceed a fraction $\\theta$ of the thermal energy scale $k_{\\mathrm{B}} T$. This implies that the threshold value, $R_{\\text{crit}} = \\theta k_{\\mathrm{B}} T$, has units of kJ/(mol·ns) for the comparison. Thus, for each case, we will check if the calculated value of $R$ satisfies $R \\le 0.01 \\cdot k_{\\mathrm{B}} \\cdot T$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the energy oscillation amplitude (A) and linear energy drift rate (R)\n    for a simulated rigid water molecule based on derived physical scaling laws.\n    \"\"\"\n\n    # Define physical constants and problem parameters\n    # The problem provides k_B in kJ/(mol·K), which is numerically R/1000.\n    # This is a common convention in molecular simulation for molar energies.\n    k_B = 0.008314462618  # kJ/(mol·K)\n    \n    # Characteristic angular frequency in s^-1\n    omega_char = 2.0 * np.pi * 1.0e12\n    \n    # Acceptability threshold fraction\n    theta = 0.01\n    \n    # Number of holonomic constraints for a rigid water molecule\n    m_constraints = 3.0\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (model_label, T [K], dt [fs], epsilon, tau [ns])\n    test_cases = [\n        (\"TIP3P\", 300, 2, 1e-4, 1),\n        (\"SPC/E\", 300, 1, 1e-6, 1),\n        (\"TIP4P/2005\", 300, 2, 1e-5, 10),\n        (\"TIP3P\", 600, 2, 5e-5, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        _label, T_K, dt_fs, epsilon, _tau_ns = case\n        \n        # Characteristic energy scale in kJ/mol\n        E_char = 3.0 * k_B * T_K\n        \n        # --- 1. Calculate the energy oscillation amplitude (A) ---\n        # Convert time step from fs to s for this calculation\n        dt_s = dt_fs * 1.0e-15\n        \n        # Dimensionless time step parameter\n        w_dt = omega_char * dt_s\n        \n        # Amplitude A in kJ/mol\n        A = (w_dt**2) * E_char\n        \n        # --- 2. Calculate the linear energy drift rate (R) ---\n        # Per-step energy defect due to finite constraint tolerance\n        # The scaling is given as m * epsilon^2 * E_char\n        delta_E_step = m_constraints * (epsilon**2) * (3.0 * k_B * T_K)\n        \n        # Convert time step from fs to ns for the rate calculation\n        dt_ns = dt_fs * 1.0e-6\n        \n        # Drift rate R in kJ/(mol·ns)\n        R = delta_E_step / dt_ns\n        \n        # --- 3. Check the acceptability criterion ---\n        # Threshold for drift rate in kJ/(mol·ns)\n        R_crit = theta * k_B * T_K\n        \n        is_acceptable = (R <= R_crit)\n        \n        results.append([A, R, is_acceptable])\n\n    # Final print statement in the exact required format.\n    # The desired format is a string representation of a Python list of lists.\n    # We construct this string manually to ensure exactness.\n    result_str = \"[\" + \",\".join([f\"[{a},{r},{str(b)}]\" for a, r, b in results]) + \"]\"\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}