{
    "hands_on_practices": [
        {
            "introduction": "第一个练习是一个概念性检验，旨在确保您理解 Nosé-Hoover 链方程的核心组成部分。该练习聚焦于恒温器的驱动力，以及自由度数目 $g$ 的关键作用，尤其是在存在约束的情况下 ()。正确理解这些基础是有效实现和调试恒温器的第一步。",
            "id": "3429682",
            "problem": "考虑一个由 $d$ 维空间中的 $N$ 个质量为 $\\{m_i\\}_{i=1}^N$ 的点粒子组成的经典分子系统，该系统受到被精确施加的完整约束 $C_a(\\mathbf{q})=0$（其中 $a=1,\\dots,n_c$）。总质心（COM）线动量被约束在任何时候都为零。该系统使用 Nosé-Hoover 链（NHC）在温度为 $T$ 的正则系综中进行恒温，其中物理动量 $\\{\\mathbf{p}_i\\}$ 仅与速度为 $\\xi_1$、质量参数为 $Q_1$ 的第一个恒温器变量耦合，而第一个恒温器本身又与速度为 $\\xi_2$ 的第二个恒温器耦合（链长至少为 $2$）。物理运动方程的形式如下\n- $d\\mathbf{q}_i/dt=\\mathbf{p}_i/m_i$，\n- $d\\mathbf{p}_i/dt=\\mathbf{F}_i(\\mathbf{q})-\\xi_1\\,\\mathbf{p}_i+\\text{约束力}$，\n且链变量根据某个待确定的常微分方程（ODE）演化。令 $K$ 表示施加所有约束后，剩余的被恒温的独立动量的瞬时动能。在温度 $T$ 的平衡状态下，能量均分定理意味着 $\\langle K\\rangle=(g/2)\\,k_{B}T$，其中 $k_{B}$ 是玻尔兹曼常数，$g$ 是实际被恒温器采样的独立二次动量自由度的数量。\n\n仅使用牛顿定律、关于独立动量的动能定义 $K=\\sum (\\mathbf{p}_i^2/2m_i)$、类摩擦项 $-\\xi_1\\mathbf{p}_i$ 对动能变化率的影响，以及能量均分关系 $\\langle K\\rangle=(g/2)\\,k_{B}T$，推断 (i) 第一个恒温器 ODE 的形式，该 ODE 能持续地将 $K$ 驱动至其正则目标值，同时允许在链中与第二个恒温器耦合，以及 (ii) 当存在 $n_c$ 个完整约束且 COM 动量被约束为零时，$g$ 的正确值。选择与这些要求一致的唯一选项。\n\nA. $d\\xi_1/dt=(2K-g\\,k_{B}T)/Q_1-\\xi_2\\,\\xi_1$，其中 $g=dN-n_c-d$，当质心动量被约束为零时，并且 $K$ 仅对独立动量计算。\n\nB. $d\\xi_1/dt=(K-(g/2)\\,k_{B}T)/Q_1-\\xi_2\\,\\xi_1$，其中 $g=dN$，与约束或动量移除无关。\n\nC. $d\\xi_1/dt=(2K-g\\,k_{B}T)/Q_1$，不与 $\\xi_2$ 耦合，且 $g=dN-n_c$，无论是否有任何质心动量约束。\n\nD. $d\\xi_1/dt=(2K-g\\,k_{B}T)/Q_1-\\xi_1^2$，其中 $g=dN-n_c-2d$，当质心动量被约束为零时。",
            "solution": "用户希望我验证并解决一个关于经典分子动力学模拟中 Nosé-Hoover 链恒温器的问题。\n\n### 问题验证\n\n首先，我将提取已知条件并验证问题陈述。\n\n**第一步：提取已知条件**\n-   系统：一个由 $d$ 维空间中的 $N$ 个质量为 $\\{m_i\\}_{i=1}^N$ 的点粒子组成的经典系统。\n-   完整约束：$n_c$ 个形式为 $C_a(\\mathbf{q})=0$ 的约束被精确施加。\n-   质心（COM）动量约束：总质心线动量被约束在任何时候都为零。\n-   恒温：系统处于温度为 $T$ 的正则系综中，使用长度至少为 $2$ 的 Nosé-Hoover 链（NHC）进行恒温。\n-   耦合方案：物理动量 $\\{\\mathbf{p}_i\\}$ 仅与第一个恒温器变量耦合，该变量的速度为 $\\xi_1$，质量参数为 $Q_1$。第一个恒温器与速度为 $\\xi_2$ 的第二个恒温器耦合。\n-   粒子运动方程（EOMs）：\n    -   $d\\mathbf{q}_i/dt = \\mathbf{p}_i/m_i$\n    -   $d\\mathbf{p}_i/dt = \\mathbf{F}_i(\\mathbf{q}) - \\xi_1\\,\\mathbf{p}_i + \\text{约束力}$\n-   动能 $K$：$K$ 是施加所有约束后剩余的独立动量的瞬时动能。\n-   能量均分定理：在平衡状态下，$\\langle K \\rangle = (g/2)\\,k_{B}T$，其中 $g$ 是恒温器采样的独立二次动量自由度的数量，$k_{B}$ 是玻尔兹曼常数。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学基础：** 该问题牢固地建立在统计力学和计算物理的成熟理论之上，特别是关于分子动力学模拟和恒温系综。Nosé-Hoover 链是一种标准的、广泛使用的算法。完整约束和 COM 动量移除的概念也是标准做法。该问题在科学上是合理的。\n-   **适定性：** 该问题要求第一个恒温器变量的运动方程和自由度数 $g$。这些量由 NHC 恒温器和约束动力学的理论框架唯一确定。所给的设置足以推导出唯一的正确答案。\n-   **客观性：** 该问题以精确、客观和技术性的语言陈述，没有歧义或主观性陈述。\n\n**第三步：结论与行动**\n问题陈述在科学上是合理的、适定的、客观的且自洽的。这是一个有效的问题。我将继续推导解答。\n\n### 推导\n\n该问题有两部分：(i) 确定第一个恒温器变量 $\\xi_1$ 的运动方程，以及 (ii) 确定自由度数 $g$ 的正确值。\n\n**(i) $\\xi_1$ 的运动方程**\n\nNosé-Hoover 链恒温器旨在生成正则相空间分布。这是通过引入一系列虚构的恒温器变量来实现的。第一个变量 $\\xi_1$ 直接耦合到物理系统的动能 $K$。链中的每个后续变量 $\\xi_j$ 对前一个变量 $\\xi_{j-1}$ 进行恒温。\n\nNHC 运动方程的一般结构如下。恒温器变量 $\\xi_j$ 的运动方程由其所恒温的变量的动能驱动，并由链中的下一个恒温器变量 $\\xi_{j+1}$ 阻尼。\n\n对于第一个恒温器变量 $\\xi_1$，它控制的“动能”是物理粒子的动能 $K$。恒温器被设计为将 $K$ 驱动至其正则系综平均值 $\\langle K \\rangle = (g/2)k_{B}T$。Nosé-Hoover 型恒温器的运动方程中的驱动项与瞬时“动能温度”与目标温度的偏差成正比。对于量 $2K$，其目标值是 $g k_{B}T$。因此，驱动项是 $(2K - g k_{B}T)$。\n\n问题陈述中提到链长至少为 $2$，这意味着 $\\xi_1$ 与第二个恒温器变量 $\\xi_2$ 耦合。在 NHC 形式中，这种耦合采取类摩擦项的形式。从扩展哈密顿量进行的标准推导表明，第一个恒温器动量 $p_1 = Q_1 \\xi_1$ 的 $\\dot{p_1}$ 的阻尼项是 $-\\xi_2 p_1$。$p_1$ 的完整方程是：\n$$ \\frac{dp_1}{dt} = 2K - g k_{B}T - \\xi_2 p_1 $$\n代入 $p_1 = Q_1 \\xi_1$ 和 $dp_1/dt = Q_1 (d\\xi_1/dt)$，我们得到：\n$$ Q_1 \\frac{d\\xi_1}{dt} = 2K - g k_{B}T - \\xi_2 (Q_1 \\xi_1) $$\n除以恒温器质量参数 $Q_1$ 得到恒温器速度 $\\xi_1$ 的运动方程：\n$$ \\frac{d\\xi_1}{dt} = \\frac{2K - g k_{B}T}{Q_1} - \\xi_2 \\xi_1 $$\n这个方程表明，如果动能 $K$ 太高，$\\xi_1$ 倾向于增加，从而增强对粒子的摩擦力（因为 $\\dot{\\mathbf{p}}_i \\propto -\\xi_1 \\mathbf{p}_i$）并冷却系统。如果 $K$ 太低，$\\xi_1$ 倾向于减小，导致加热。项 $-\\xi_2 \\xi_1$ 代表对第一个恒温器本身的恒温作用，这对于确保遍历性和正确的正则采样至关重要。\n\n**(ii) 自由度数 $g$**\n\n参数 $g$ 代表被恒温的独立二次动量自由度的数量。这是系统的总动能自由度数。\n\n1.  系统有 $N$ 个粒子在 $d$ 维空间中。没有任何约束时，每个粒子有 $d$ 个动量分量，总共有 $dN$ 个动量自由度。\n\n2.  存在 $n_c$ 个完整约束 $C_a(\\mathbf{q})=0$。为了使这些约束在任何时候都成立，它们的时间导数必须为零：\n    $$ \\frac{dC_a}{dt} = \\sum_{i=1}^N \\frac{\\partial C_a}{\\partial \\mathbf{q}_i} \\cdot \\frac{d\\mathbf{q}_i}{dt} = \\sum_{i=1}^N \\frac{\\partial C_a}{\\partial \\mathbf{q}_i} \\cdot \\frac{\\mathbf{p}_i}{m_i} = 0 $$\n    这 $n_c$ 个方程中的每一个都对动量分量 $\\{\\mathbf{p}_i\\}$ 施加了一个独立的线性约束。因此，完整约束移除了 $n_c$ 个自由度。剩余的自由度数为 $dN - n_c$。\n\n3.  总质心（COM）动量被约束为零。COM 动量是向量 $\\mathbf{P}_{\\text{COM}} = \\sum_{i=1}^N \\mathbf{p}_i$。约束 $\\mathbf{P}_{\\text{COM}} = \\mathbf{0}$ 是一个向量方程，可分解为 $d$ 个独立的标量方程，每个空间维度一个：\n    $$ \\sum_{i=1}^N p_{i,x} = 0, \\quad \\sum_{i=1}^N p_{i,y} = 0, \\quad \\dots \\quad (d \\text{ 个分量})$$\n    这 $d$ 个约束通常独立于完整约束。例如，固定分子中的键长并不能固定其总动量。因此，这些约束额外移除了 $d$ 个自由度。\n\n综上，被恒温的独立动量自由度的总数为：\n$$ g = dN - n_c - d $$\n进入恒温器方程的动能 $K$ 必须精确地对这 $g$ 个独立自由度进行计算。\n\n### 逐项分析\n\n**A. $d\\xi_1/dt=(2K-g\\,k_{B}T)/Q_1-\\xi_2\\,\\xi_1$，其中 $g=dN-n_c-d$，当质心动量被约束为零时，并且 $K$ 仅对独立动量计算。**\n-   **ODE 形式：** 方程 $d\\xi_1/dt = (2K-g\\,k_{B}T)/Q_1 - \\xi_2\\,\\xi_1$ 正确地表示了 Nosé-Hoover 链中第一个变量的动力学。\n-   **$g$ 的值：** 值 $g=dN-n_c-d$ 通过减去由 $n_c$ 个完整约束和 $d$ 个 COM 动量约束移除的自由度，正确地计算了独立动量自由度的数量。\n-   **结论：** 此选项与推导结果完全一致。**正确**。\n\n**B. $d\\xi_1/dt=(K-(g/2)\\,k_{B}T)/Q_1-\\xi_2\\,\\xi_1$，其中 $g=dN$，与约束或动量移除无关。**\n-   **ODE 形式：** 形式 $d\\xi_1/dt = (K-(g/2)\\,k_{B}T)/Q_1 - \\xi_2\\,\\xi_1$ 在代数上等价于 $(2K-g\\,k_{B}T)/(2Q_1) - \\xi_2\\,\\xi_1$。虽然形式在结构上是合理的（这只是一个如何定义 $Q_1$ 的问题），但 $g$ 的值是错误的。\n-   **$g$ 的值：** 值 $g=dN$ 未能考虑任何约束。这会导致实际动态自由度的目标温度不正确。\n-   **结论：** $g$ 的值是错误的。**错误**。\n\n**C. $d\\xi_1/dt=(2K-g\\,k_{B}T)/Q_1$，不与 $\\xi_2$ 耦合，且 $g=dN-n_c$，无论是否有任何质心动量约束。**\n-   **ODE 形式：** 该方程缺少 $-\\xi_2\\,\\xi_1$ 耦合项。这描述的是一个简单的 Nosé-Hoover 恒温器，而不是问题中指定的 Nosé-Hoover *链*。\n-   **$g$ 的值：** 值 $g=dN-n_c$ 错误地忽略了因固定 COM 动量为零而施加的 $d$ 个约束。\n-   **结论：** ODE 形式和 $g$ 的值都错误。**错误**。\n\n**D. $d\\xi_1/dt=(2K-g\\,k_{B}T)/Q_1-\\xi_1^2$，其中 $g=dN-n_c-2d$，当质心动量被约束为零时。**\n-   **ODE 形式：** 阻尼项是 $-\\xi_1^2$，这意味着自阻尼。在 NHC 中，恒温器 $\\xi_1$ 由 $\\xi_2$ 阻尼，而不是由其自身阻尼。这种形式对于 NHC 是不正确的。\n-   **$g$ 的值：** 值 $g=dN-n_c-2d$ 是错误的。它为 COM 约束减去了 $2d$ 个自由度，但将 COM 动量向量设为零只施加了 $d$ 个约束。\n-   **结论：** ODE 形式和 $g$ 的值都错误。**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了方程的静态形式之后，本练习将探讨恒温器的动态行为。通过在平衡点附近对耦合方程进行线性化，您将发现恒温器的响应类似于一个谐振子 ()。您将推导出其特征频率，该频率决定了系统温度涨落的时间尺度。",
            "id": "3429699",
            "problem": "考虑一个具有 $g$ 个力学自由度和瞬时动能 $K(t)$ 的经典系统，该系统通过确定性分子动力学在 Nosé–Hoover 温控器下进行积分。动力学温度定义为 $T(t) = \\dfrac{2 K(t)}{g k_B}$，其中 $k_B$ 是玻尔兹曼常数，$T_0$ 是目标温度。Nosé–Hoover 温控器通过一个标量温控器变量 $\\xi(t)$ 施加一个类似摩擦的耦合，该变量通过 $\\dfrac{d p_i}{d t} = F_i - \\xi p_i$ 来修正动量 $\\{p_i\\}$，并根据以下方程演化\n$$\n\\frac{d \\xi}{d t} = \\frac{2 K(t) - g k_B T_0}{Q(t)} \\, ,\n$$\n其中 $Q(t)$ 是温控器质量参数。在近平衡、粗粒化极限下，动能和势能之间的快速交换被平均掉，动力学温度遵循以下规律\n$$\n\\frac{d T}{d t} \\approx - 2 \\, \\xi \\, T \\, .\n$$\n您的任务是设计一个自适应温控器质量控制器，该控制器通过以下方式依赖于瞬时温度误差 $e(t) = T(t) - T_0$：\n$$\nQ(t) = \\frac{Q_0}{1 + \\gamma \\, e(t)^2} \\, ,\n$$\n其中常数 $Q_0 > 0$ 且 $\\gamma \\ge 0$。将分子系统视为在温控器时间尺度上是遍历的，从而上述粗粒化温度方程是有效的。在由 $T(t)$ 和 $\\xi(t)$ 的动力学定义的闭环中进行分析。\n\n仅从本问题陈述中给出的定义和方程出发，对由 $T = T_0$ 和 $\\xi = 0$ 定义的平衡点进行线性化。确定 $e(t)$ 的线性化闭环误差动力学，并从特征方程推断线性稳定区域以及是否存在振荡超调（根据 $Q_0$ 的符号判断）。然后提取温度误差模式的线性化固有频率 $\\omega_0$。\n\n答案要求：仅报告线性化固有频率 $\\omega_0$，形式为包含 $g$、$k_B$、$T_0$ 和 $Q_0$ 的单个、闭式符号表达式。不要进行数值计算。在最终报告的表达式中不要包含单位。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n- 系统：一个具有 $g$ 个力学自由度的经典系统。\n- 瞬时动能：$K(t)$。\n- 积分方法：在 Nosé–Hoover 温控器下的确定性分子动力学。\n- 动力学温度定义：$T(t) = \\dfrac{2 K(t)}{g k_B}$。\n- 目标温度：$T_0$。\n- 玻尔兹曼常数：$k_B$。\n- 温控器变量：$\\xi(t)$。\n- 动量 $\\{p_i\\}$ 的运动方程：$\\dfrac{d p_i}{d t} = F_i - \\xi p_i$。\n- 温控器变量的运动方程：$\\dfrac{d \\xi}{d t} = \\dfrac{2 K(t) - g k_B T_0}{Q(t)}$。\n- 温控器质量参数：$Q(t)$。\n- 温度演化的粗粒化近似：$\\dfrac{d T}{d t} \\approx - 2 \\, \\xi \\, T$。\n- 自适应温控器质量控制器：$Q(t) = \\dfrac{Q_0}{1 + \\gamma \\, e(t)^2}$，其中 $Q_0 > 0$ 且 $\\gamma \\ge 0$。\n- 瞬时温度误差：$e(t) = T(t) - T_0$。\n- 假设：分子系统在温控器时间尺度上是遍历的，这验证了粗粒化温度方程的有效性。\n- 分析点：由 $T = T_0$ 和 $\\xi = 0$ 定义的平衡点。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题牢固地建立在分子动力学模拟的标准理论框架内。Nosé-Hoover 温控器、动力学温度的定义以及温控器“质量”的概念都是统计力学和计算物理学中已确立的概念。所提出的自适应质量控制器是对应用于此背景的类 Rienstra 控制方案的合理扩展。该问题在科学上是合理的。\n2.  **适定性：** 该问题提供了一个封闭的微分方程组，并要求进行特定的分析（线性化）和得出特定的结果（固有频率）。所提供的信息足以进行分析并获得唯一答案。\n3.  **客观性：** 该问题使用精确的数学和物理术语陈述，没有主观性语言。\n4.  **完整性与一致性：** 提供了所有必要的方程和定义。没有矛盾之处。例如，动力学温度的定义 $2K(t) = g k_B T(t)$ 与其在 $d\\xi/dt$ 方程中的使用是一致的。\n5.  **现实性与可行性：** 参数和方程描述了计算物理学中一个有效的理论模型。没有规定任何物理上不可能的条件。\n\n### 步骤 3：结论与行动\n问题有效。这是一个定义明确的、关于与分子动力学相关的动力学系统线性稳定性分析的练习。现在可以开始求解。\n\n## 解法\n\n问题要求对温度误差 $e(t)$ 和温控器变量 $\\xi(t)$ 在指定平衡点附近的闭环动力学进行线性化。该系统由两个耦合的一阶非线性常微分方程描述。\n\n首先，我们用误差变量 $e(t) = T(t) - T_0$ 来表示给定的动力学方程。根据定义，这意味着 $T(t) = T_0 + e(t)$ 且 $\\dfrac{d T}{d t} = \\dfrac{d e}{d t}$。\n\n温度的粗粒化方程为：\n$$\n\\frac{d T}{d t} = -2 \\, \\xi \\, T\n$$\n代入 $T(t) = T_0 + e(t)$，我们得到误差 $e(t)$ 的演化方程：\n$$\n\\frac{d e}{d t} = -2 \\, \\xi \\, (T_0 + e(t))\n$$\n\n接下来，我们考虑温控器变量 $\\xi(t)$ 的演化方程：\n$$\n\\frac{d \\xi}{d t} = \\frac{2 K(t) - g k_B T_0}{Q(t)}\n$$\n使用动力学温度的定义 $T(t) = \\dfrac{2 K(t)}{g k_B}$，我们可以写出 $2 K(t) = g k_B T(t)$。将此代入 $\\dfrac{d \\xi}{d t}$ 的方程中：\n$$\n\\frac{d \\xi}{d t} = \\frac{g k_B T(t) - g k_B T_0}{Q(t)} = \\frac{g k_B (T(t) - T_0)}{Q(t)}\n$$\n现在，代入 $e(t) = T(t) - T_0$ 和自适应质量的给定形式 $Q(t) = \\dfrac{Q_0}{1 + \\gamma \\, e(t)^2}$：\n$$\n\\frac{d \\xi}{d t} = \\frac{g k_B e(t)}{\\frac{Q_0}{1 + \\gamma \\, e(t)^2}} = \\frac{g k_B e(t) (1 + \\gamma \\, e(t)^2)}{Q_0}\n$$\n\n因此，状态变量 $(e, \\xi)$ 的非线性微分方程组为：\n$$\n\\begin{cases}\n\\dfrac{d e}{d t} = -2 \\, T_0 \\, \\xi - 2 \\, e \\, \\xi \\\\\n\\dfrac{d \\xi}{d t} = \\dfrac{g k_B}{Q_0} e + \\dfrac{g k_B \\gamma}{Q_0} e^3\n\\end{cases}\n$$\n问题指定平衡点为 $T = T_0$（对应于 $e = 0$）和 $\\xi = 0$。我们通过在该点 $(e, \\xi) = (0, 0)$ 附近展开方程右侧，并仅保留 $e$ 和 $\\xi$ 的线性项来对系统进行线性化。\n对于第一个方程，项 $-2 \\, e \\, \\xi$ 是状态变量的二次项，在线性化中被舍去。\n对于第二个方程，项 $\\dfrac{g k_B \\gamma}{Q_0} e^3$ 是三次项，被舍去。\n\n得到的线性化方程组为：\n$$\n\\begin{cases}\n\\dfrac{d e}{d t} = -2 \\, T_0 \\, \\xi \\\\\n\\dfrac{d \\xi}{d t} = \\dfrac{g k_B}{Q_0} e\n\\end{cases}\n$$\n这可以写成矩阵形式：\n$$\n\\frac{d}{dt} \\begin{pmatrix} e \\\\ \\xi \\end{pmatrix} = \\begin{pmatrix} 0 & -2 T_0 \\\\ \\frac{g k_B}{Q_0} & 0 \\end{pmatrix} \\begin{pmatrix} e \\\\ \\xi \\end{pmatrix}\n$$\n为了求出 $e(t)$ 的闭环误差动力学，我们可以对第一个线性化方程关于时间求导：\n$$\n\\frac{d^2 e}{d t^2} = -2 \\, T_0 \\, \\frac{d \\xi}{d t}\n$$\n现在，将第二个线性化方程代入此表达式：\n$$\n\\frac{d^2 e}{d t^2} = -2 \\, T_0 \\left( \\frac{g k_B}{Q_0} e \\right)\n$$\n整理后得到一个关于误差 $e(t)$ 的二阶线性齐次常微分方程：\n$$\n\\frac{d^2 e}{d t^2} + \\left( \\frac{2 g k_B T_0}{Q_0} \\right) e = 0\n$$\n该方程是无阻尼简谐振子的标准形式 $\\dfrac{d^2 x}{dt^2} + \\omega_0^2 x = 0$，其中 $\\omega_0$ 是固有角频率。\n\n该系统的特征方程可以通过假设一个形式为 $e(t) \\propto \\exp(\\lambda t)$ 的解来找到，这会得到：\n$$\n\\lambda^2 + \\frac{2 g k_B T_0}{Q_0} = 0\n$$\n特征值为 $\\lambda = \\pm \\sqrt{-\\dfrac{2 g k_B T_0}{Q_0}}$。\n考虑到问题的约束条件 $g > 0$、$k_B > 0$、$T_0 > 0$ 以及重要的 $Q_0 > 0$，平方根内的项为负。特征值是纯虚数：\n$$\n\\lambda = \\pm i \\sqrt{\\frac{2 g k_B T_0}{Q_0}}\n$$\n这表明线性化系统是临界稳定的，并在平衡点附近表现出无阻尼振荡。振荡的存在证实了温度响应中将出现振荡超调。如果 $Q_0$ 为负，特征值将是实数（一个正，一个负），导致指数不稳定性而没有振荡。\n\n通过将我们推导出的 $e(t)$ 方程与谐振子的标准形式进行直接比较，我们可以确定线性化固有频率的平方 $\\omega_0^2$ 为：\n$$\n\\omega_0^2 = \\frac{2 g k_B T_0}{Q_0}\n$$\n线性化固有频率 $\\omega_0$ 是该量的正平方根：\n$$\n\\omega_0 = \\sqrt{\\frac{2 g k_B T_0}{Q_0}}\n$$\n这就是问题所要求的最终表达式。",
            "answer": "$$\\boxed{\\sqrt{\\frac{2 g k_B T_0}{Q_0}}}$$"
        },
        {
            "introduction": "最后的练习将恒温器动力学的概念应用于一个更真实、更复杂的场景：谐振晶体。您将学习如何对单个振动模式进行控温，并设计依赖于模式的恒温器质量参数 $Q_k$ ()。此练习的目标是实现跨越系统整个频谱的均匀温度控制。",
            "id": "3429718",
            "problem": "考虑一个一维周期性谐振子链，它由 $N$ 个质量为 $m$、晶格间距为 $a$ 的相同粒子组成，最近邻弹簧常数为 $K$。其哈密顿量为\n$$\nH = \\sum_{j=1}^{N} \\left( \\frac{p_j^2}{2m} + \\frac{K}{2} \\left( x_{j+1} - x_j \\right)^2 \\right),\n$$\n满足周期性边界条件 $x_{N+1} \\equiv x_1$。\n\n1. 使用离散傅里叶变换到简正坐标，将此链对角化为由波数 $k$ 索引的独立简正模，并证明其动力学可简化为一组解耦的谐振子，其坐标为 $q_k$，共轭动量为 $p_k$，角频率为 $\\omega_k$。\n\n2. 为每个简正模附加一个独立的 Nosé-Hoover 恒温器 (NHT)，其定义为：对每个模式 $k$，引入一个恒温器摩擦变量 $\\xi_k$，其恒温器质量参数为 $Q_k$，温度为 $T$。该模式层级的运动方程为\n$$\n\\dot{q}_k = \\frac{p_k}{m},\\quad \\dot{p}_k = - m \\omega_k^2 q_k - \\xi_k p_k,\\quad \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right),\n$$\n其中 $k_B$ 是玻尔兹曼常数。\n\n3. 将瞬时模式能量定义为 $E_k = \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2$。从牛顿方程和上述 Nosé-Hoover 方程出发，在不作除谐波性以外任何特殊形式假设的情况下，通过对谐波运动的快相进行平均，推导模式能量 $E_k$ 和恒温器变量 $\\xi_k$ 的平均慢动力学。围绕热力学不动点 $E_k = k_B T$, $\\xi_k = 0$ 将这些平均方程线性化，以获得一个二维线性系统。从这个线性化系统中，提取表征模式能量与恒温器之间反馈交换率的小信号角频率 $\\Omega_k$。\n\n4. 你的任务是设计一个特定于模式的恒温器质量函数 $Q_k(\\omega_k)$，使得反馈带宽在所有模式频率上是平坦的，其精确意义如下：对于所有模式，小信号反馈率与模式角频率之比为一个给定的常数 $c>0$，即对每个 $k$ 都有 $\\Omega_k / \\omega_k = c$。仅使用你的线性化结果和 $\\Omega_k$ 的定义，确定 $Q_k(\\omega_k)$ 作为 $\\omega_k$、$k_B$、$T$ 和 $c$ 的函数的闭式表达式。\n\n请以 $\\omega$、$k_B$、$T$ 和 $c$ 表示的单个闭式解析表达式的形式给出你的最终答案。最终答案中不要包含单位。",
            "solution": "所述问题在科学上是合理的、自洽的且良定的。它概述了分子动力学模拟领域一个标准的、尽管详细的理论练习，特别是关于将 Nosé-Hoover 恒温器应用于谐波系统的简正模。因此我们可以开始推导。\n\n第一步，通过离散傅里叶变换对谐振子链的哈密顿量进行对角化，这是固态物理学中的一个标准结果。它将 $N$ 个粒子的集体运动分解为 $N$ 个独立的简正模，每个简正模的行为都像一个具有特定角频率 $\\omega_k$ 的谐振子。问题要求我们考虑这样一个具有坐标 $q_k$、动量 $p_k$ 和频率 $\\omega_k$ 的通用模式 $k$。\n\n第二步给出了该模式与 Nosé-Hoover 恒温器 (NHT) 耦合时的运动方程。这些方程定义了我们必须分析的动力学：\n$$ \\dot{q}_k = \\frac{p_k}{m} $$\n$$ \\dot{p}_k = - m \\omega_k^2 q_k - \\xi_k p_k $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right) $$\n在这里，$\\xi_k$ 是恒温器动力学摩擦系数，$Q_k$ 是设定其响应时间尺度的恒温器质量参数，$T$ 是目标温度，$k_B$ 是玻尔兹曼常数。\n\n第三步要求我们通过对谐波模式的快振荡进行平均来找到慢动力学。我们首先定义模式的瞬时能量 $E_k$：\n$$ E_k = \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2 $$\n我们使用链式法则并代入 $\\dot{q}_k$ 和 $\\dot{p}_k$ 的运动方程来计算其时间导数 $\\dot{E}_k$：\n$$ \\dot{E}_k = \\frac{d}{dt} \\left( \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2 \\right) = \\frac{p_k \\dot{p}_k}{m} + m \\omega_k^2 q_k \\dot{q}_k $$\n$$ \\dot{E}_k = \\frac{p_k}{m} \\left( - m \\omega_k^2 q_k - \\xi_k p_k \\right) + m \\omega_k^2 q_k \\left( \\frac{p_k}{m} \\right) $$\n$$ \\dot{E}_k = - \\omega_k^2 p_k q_k - \\frac{\\xi_k p_k^2}{m} + \\omega_k^2 q_k p_k $$\n包含 $p_k q_k$ 的项相互抵消，剩下：\n$$ \\dot{E}_k = - \\frac{\\xi_k p_k^2}{m} $$\n因此，变量 $(E_k, \\xi_k)$ 的完整系统是：\n$$ \\dot{E}_k = - \\xi_k \\frac{p_k^2}{m} $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right) $$\n慢动力学近似的核心思想是，与频率为 $\\omega_k$ 的谐波振荡相比，变量 $E_k$ 和 $\\xi_k$ 的变化是缓慢的。因此，我们可以将这些方程的右侧在一个快运动周期内进行平均。对于能量为 $E_k$ 的谐振子，维里定理指出平均动能等于平均势能，因此 $\\left\\langle \\frac{p_k^2}{2m} \\right\\rangle_{fast} = \\frac{E_k}{2}$。这意味着方程中出现的项的平均值为 $\\left\\langle \\frac{p_k^2}{m} \\right\\rangle_{fast} = E_k$。在这个平均过程中将 $E_k$ 和 $\\xi_k$ 视作常数，我们得到慢变量的平均运动方程：\n$$ \\dot{E}_k = - \\xi_k E_k $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( E_k - k_B T \\right) $$\n这个二维系统的不动点可以通过设置 $\\dot{E}_k = 0$ 和 $\\dot{\\xi}_k = 0$ 来找到。第二个方程给出 $E_k^* = k_B T$。将此代入第一个方程得到 $-\\xi_k^* (k_B T) = 0$，因为 $k_B T > 0$，这意味着 $\\xi_k^* = 0$。因此，不动点是 $(E_k^*, \\xi_k^*) = (k_B T, 0)$。\n\n接下来，我们围绕该不动点将此系统线性化。令 $E_k(t) = k_B T + \\delta E_k(t)$ 和 $\\xi_k(t) = 0 + \\delta \\xi_k(t)$，其中 $\\delta E_k$ 和 $\\delta \\xi_k$ 是小偏差。将这些代入平均方程并只保留一阶项，得到：\n$$ \\delta \\dot{E}_k = -(0 + \\delta \\xi_k)(k_B T + \\delta E_k) \\approx -(k_B T) \\delta \\xi_k $$\n$$ \\delta \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( (k_B T + \\delta E_k) - k_B T \\right) = \\frac{1}{Q_k} \\delta E_k $$\n这是一个可以写成矩阵形式的线性系统：\n$$ \\frac{d}{dt} \\begin{pmatrix} \\delta E_k \\\\ \\delta \\xi_k \\end{pmatrix} = \\begin{pmatrix} 0 & -k_B T \\\\ 1/Q_k & 0 \\end{pmatrix} \\begin{pmatrix} \\delta E_k \\\\ \\delta \\xi_k \\end{pmatrix} $$\n动力学由雅可比矩阵 $J = \\begin{pmatrix} 0 & -k_B T \\\\ 1/Q_k & 0 \\end{pmatrix}$ 的特征值 $\\lambda$ 决定。特征方程为 $\\det(J - \\lambda I) = 0$：\n$$ \\det \\begin{pmatrix} -\\lambda & -k_B T \\\\ 1/Q_k & -\\lambda \\end{pmatrix} = \\lambda^2 + \\frac{k_B T}{Q_k} = 0 $$\n特征值为 $\\lambda = \\pm i \\sqrt{\\frac{k_B T}{Q_k}}$。这些纯虚特征值描述了围绕不动点的振荡。这些振荡的角频率就是反馈交换率 $\\Omega_k$：\n$$ \\Omega_k = \\sqrt{\\frac{k_B T}{Q_k}} $$\n\n最后，在第四步中，我们必须确定函数 $Q_k(\\omega_k)$ 以满足设计标准，即反馈带宽在所有模式上是平坦的，由条件 $\\Omega_k / \\omega_k = c$ 指定，其中 $c$ 是一个正常数。\n$$ \\frac{\\Omega_k}{\\omega_k} = c \\implies \\Omega_k = c \\omega_k $$\n我们将其与我们推导出的 $\\Omega_k$ 表达式相等：\n$$ c \\omega_k = \\sqrt{\\frac{k_B T}{Q_k}} $$\n为了解出 $Q_k$，我们对两边进行平方：\n$$ (c \\omega_k)^2 = \\frac{k_B T}{Q_k} \\implies c^2 \\omega_k^2 = \\frac{k_B T}{Q_k} $$\n重新整理以分离出 $Q_k$，得到所需的函数：\n$$ Q_k = \\frac{k_B T}{c^2 \\omega_k^2} $$\n按照要求，我们将其作为模式频率 $\\omega$ 的一般函数提供。",
            "answer": "$$\n\\boxed{\\frac{k_B T}{c^2 \\omega^2}}\n$$"
        }
    ]
}