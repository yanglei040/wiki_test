{
    "hands_on_practices": [
        {
            "introduction": "The Wiener-Khinchin theorem provides the fundamental bridge between the time-domain description of a stationary process, given by its autocorrelation function, and its frequency-domain representation, the spectral density. This first exercise offers a direct and essential application of this theorem. By analytically calculating the Fourier transform of a simple exponential velocity autocorrelation function (VACF), you will gain a concrete understanding of how the characteristic decay time of correlations in the time domain dictates the width and shape of the resulting spectral density, building crucial intuition for interpreting spectra from more complex systems .",
            "id": "3459372",
            "problem": "Consider a single-particle velocity process in equilibrium Molecular Dynamics (MD) that is stationary and ergodic, with Velocity Autocorrelation Function (VAF) denoted by $C_{v}(t)$. The Power Spectral Density (PSD) $S_{v}(\\omega)$, with angular frequency $\\omega$, is defined by the Wiener–Khinchin theorem as the Fourier transform of the VAF,\n$$\nS_{v}(\\omega) = \\int_{-\\infty}^{\\infty} C_{v}(t)\\,\\exp(-i\\,\\omega t)\\,dt.\n$$\nAssume the VAF is strictly exponential,\n$$\nC_{v}(t) = A\\,\\exp(-\\gamma\\,|t|),\n$$\nwith $A0$ and $\\gamma0$ constants. Starting from the above core definitions, derive the exact analytic expression for $S_{v}(\\omega)$ as a function of $\\omega$, and identify the full width at half maximum (FWHM) and the peak height at $\\omega=0$ in terms of $A$ and $\\gamma$. Express your final answer as a single row matrix containing, in order, the three quantities $S_{v}(\\omega)$, the FWHM, and the peak height. No numerical rounding is required, and no units are required.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of statistical mechanics and molecular dynamics, specifically the Wiener–Khinchin theorem and the common model of an exponentially decaying velocity autocorrelation function (VAF). The problem is well-posed, with all necessary information provided to derive a unique analytical solution.\n\nThe task is to derive the Power Spectral Density (PSD), $S_{v}(\\omega)$, its Full Width at Half Maximum (FWHM), and its peak height, given the VAF $C_{v}(t) = A\\,\\exp(-\\gamma\\,|t|)$.\n\nThe definition of the PSD is given by the Wiener–Khinchin theorem:\n$$\nS_{v}(\\omega) = \\int_{-\\infty}^{\\infty} C_{v}(t)\\,\\exp(-i\\,\\omega t)\\,dt\n$$\nSubstituting the given expression for the VAF, $C_{v}(t)$, we get:\n$$\nS_{v}(\\omega) = \\int_{-\\infty}^{\\infty} A\\,\\exp(-\\gamma\\,|t|)\\,\\exp(-i\\,\\omega t)\\,dt\n$$\nSince $A$ is a constant, we can factor it out of the integral:\n$$\nS_{v}(\\omega) = A \\int_{-\\infty}^{\\infty} \\exp(-\\gamma\\,|t|)\\,\\exp(-i\\,\\omega t)\\,dt\n$$\nThe absolute value function $|t|$ is defined as $|t| = t$ for $t \\ge 0$ and $|t| = -t$ for $t  0$. We must split the integral into two parts over the domains $(-\\infty, 0)$ and $(0, \\infty)$:\n$$\nS_{v}(\\omega) = A \\left( \\int_{-\\infty}^{0} \\exp(-\\gamma\\,(-t))\\,\\exp(-i\\,\\omega t)\\,dt + \\int_{0}^{\\infty} \\exp(-\\gamma\\,t)\\,\\exp(-i\\,\\omega t)\\,dt \\right)\n$$\n$$\nS_{v}(\\omega) = A \\left( \\int_{-\\infty}^{0} \\exp(\\gamma t)\\,\\exp(-i\\,\\omega t)\\,dt + \\int_{0}^{\\infty} \\exp(-\\gamma t)\\,\\exp(-i\\,\\omega t)\\,dt \\right)\n$$\nWe combine the exponents in each integral:\n$$\nS_{v}(\\omega) = A \\left( \\int_{-\\infty}^{0} \\exp((\\gamma - i\\omega)t)\\,dt + \\int_{0}^{\\infty} \\exp(-(\\gamma + i\\omega)t)\\,dt \\right)\n$$\nNow we evaluate each integral. For the first integral:\n$$\n\\int_{-\\infty}^{0} \\exp((\\gamma - i\\omega)t)\\,dt = \\left[ \\frac{\\exp((\\gamma - i\\omega)t)}{\\gamma - i\\omega} \\right]_{t=-\\infty}^{t=0}\n$$\nThe upper limit gives $\\frac{\\exp(0)}{\\gamma - i\\omega} = \\frac{1}{\\gamma - i\\omega}$. The lower limit is $\\lim_{t \\to -\\infty} \\frac{\\exp(\\gamma t)\\exp(-i\\omega t)}{\\gamma - i\\omega}$. Since $\\gamma  0$, $\\exp(\\gamma t) \\to 0$ as $t \\to -\\infty$. The term $\\exp(-i\\omega t)$ is bounded. Therefore, the limit is $0$. The first integral evaluates to $\\frac{1}{\\gamma - i\\omega}$.\n\nFor the second integral:\n$$\n\\int_{0}^{\\infty} \\exp(-(\\gamma + i\\omega)t)\\,dt = \\left[ \\frac{\\exp(-(\\gamma + i\\omega)t)}{-(\\gamma + i\\omega)} \\right]_{t=0}^{t=\\infty}\n$$\nThe lower limit gives $\\frac{\\exp(0)}{-(\\gamma + i\\omega)} = -\\frac{1}{-(\\gamma+i\\omega)} = \\frac{1}{\\gamma+i\\omega}$. The upper limit is $\\lim_{t \\to \\infty} \\frac{\\exp(-\\gamma t)\\exp(-i\\omega t)}{-(\\gamma + i\\omega)}$. Since $\\gamma  0$, $\\exp(-\\gamma t) \\to 0$ as $t \\to \\infty$. Thus, the upper limit is $0$. The second integral evaluates to $0 - \\left(-\\frac{1}{\\gamma+i\\omega}\\right) = \\frac{1}{\\gamma + i\\omega}$.\n\nSubstituting these results back into the expression for $S_v(\\omega)$:\n$$\nS_{v}(\\omega) = A \\left( \\frac{1}{\\gamma - i\\omega} + \\frac{1}{\\gamma + i\\omega} \\right)\n$$\nTo combine these terms, we use the common denominator $(\\gamma - i\\omega)(\\gamma + i\\omega) = \\gamma^2 - (i\\omega)^2 = \\gamma^2 - (-1)\\omega^2 = \\gamma^2 + \\omega^2$:\n$$\nS_{v}(\\omega) = A \\left( \\frac{(\\gamma + i\\omega) + (\\gamma - i\\omega)}{\\gamma^2 + \\omega^2} \\right) = A \\left( \\frac{2\\gamma}{\\gamma^2 + \\omega^2} \\right)\n$$\nSo, the analytic expression for the PSD is a Lorentzian function of $\\omega$:\n$$\nS_{v}(\\omega) = \\frac{2A\\gamma}{\\omega^2 + \\gamma^2}\n$$\nThis is the first requested quantity.\n\nNext, we find the peak height of the PSD. The PSD is a function of $\\omega^2$ in the denominator. Since $\\omega^2 \\ge 0$, the denominator is minimized when $\\omega = 0$. This corresponds to the peak of the function. The peak height is $S_{v}(0)$:\n$$\nS_{v, \\text{peak}} = S_{v}(0) = \\frac{2A\\gamma}{0^2 + \\gamma^2} = \\frac{2A\\gamma}{\\gamma^2} = \\frac{2A}{\\gamma}\n$$\nThis is the third requested quantity.\n\nFinally, we determine the Full Width at Half Maximum (FWHM). The FWHM is the difference between the two values of $\\omega$ at which the PSD is equal to half its maximum value. The half-maximum height is $\\frac{1}{2}S_{v, \\text{peak}} = \\frac{1}{2}\\left(\\frac{2A}{\\gamma}\\right) = \\frac{A}{\\gamma}$. We set $S_{v}(\\omega)$ equal to this value and solve for $\\omega$:\n$$\n\\frac{2A\\gamma}{\\omega^2 + \\gamma^2} = \\frac{A}{\\gamma}\n$$\nSince $A  0$ and $\\gamma  0$, we can cancel $A$ from both sides and cross-multiply:\n$$\n2\\gamma^2 = \\omega^2 + \\gamma^2\n$$\n$$\n\\omega^2 = \\gamma^2\n$$\nThis gives two solutions for $\\omega$: $\\omega = \\pm \\gamma$. The FWHM is the distance between these two points on the $\\omega$-axis:\n$$\n\\text{FWHM} = \\gamma - (-\\gamma) = 2\\gamma\n$$\nThis is the second requested quantity.\n\nThe three quantities, in the requested order, are the expression for $S_{v}(\\omega)$, the FWHM, and the peak height.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2A\\gamma}{\\omega^{2} + \\gamma^{2}}  2\\gamma  \\frac{2A}{\\gamma} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The velocity autocorrelation function is far more than a mathematical abstraction; it is profoundly connected to the macroscopic transport properties of a system, a connection formalized by the Green-Kubo relations. This practice delves into the dynamics of a Langevin particle, a cornerstone model for Brownian motion in a thermal environment. You will derive the self-diffusion coefficient $D$ through two independent yet equally powerful theoretical frameworks: first by integrating the VACF as prescribed by the Green-Kubo formula, and second by analyzing the long-time behavior of the mean-squared displacement via the Einstein relation . Successfully demonstrating the equivalence of these two approaches reinforces the deep consistency of statistical mechanics and solidifies the physical importance of the VACF.",
            "id": "3459385",
            "problem": "Consider a single Langevin particle moving in $1$ dimension, with mass $m$, linear friction coefficient $\\gamma$, and in contact with a thermal bath at temperature $T$. Its dynamics are governed by the coupled stochastic differential equations\n$$\nm \\,\\dot{v}(t) \\;=\\; -\\, \\gamma\\,v(t) \\;+\\; \\xi(t), \n\\qquad \n\\dot{x}(t) \\;=\\; v(t),\n$$\nwhere $\\xi(t)$ is a Gaussian white-noise force consistent with the fluctuation–dissipation theorem, satisfying\n$$\n\\langle \\xi(t) \\rangle \\;=\\; 0, \n\\qquad\n\\langle \\xi(t)\\,\\xi(t') \\rangle \\;=\\; 2\\,\\gamma\\,k_B\\,T \\,\\delta(t-t').\n$$\nAssume the particle is in thermal equilibrium at $t=0$, so that the initial velocity $v(0)$ is distributed according to Maxwell–Boltzmann statistics with $\\langle v(0)^2 \\rangle \\;=\\; k_B T / m$, and that $\\xi(t)$ is independent of $v(0)$ for $t0$. \n\nUsing only fundamental definitions and well-tested relations:\n- Derive the equilibrium velocity autocorrelation function $C_{vv}(t) \\equiv \\langle v(0)\\,v(t) \\rangle$ from the Langevin dynamics.\n- Use the time-integral of the velocity autocorrelation function via the Green–Kubo relation to compute the self-diffusion coefficient $D$:\n$$\nD \\;=\\; \\int_{0}^{\\infty} C_{vv}(t) \\, dt.\n$$\n- Independently, solve the stochastic differential equation for $x(t)$ exactly, compute the mean-squared displacement $\\langle \\big(x(t)-x(0)\\big)^2 \\rangle$, and use the long-time definition\n$$\nD \\;=\\; \\lim_{t\\to\\infty} \\frac{\\langle \\big(x(t)-x(0)\\big)^2 \\rangle}{2\\,t}\n$$\nto obtain $D$.\n- Confirm that the two expressions for $D$ are consistent, and provide the final expression for $D$.\n\nExpress your final answer symbolically in terms of $m$, $\\gamma$, $k_B$, and $T$. Do not substitute numerical values.",
            "solution": "The solution is derived in four parts as specified by the problem.\n\n**Part 1: Derivation of the Velocity Autocorrelation Function $C_{vv}(t)$**\n\nThe Langevin equation for the velocity $v(t)$ is given by\n$$m \\,\\dot{v}(t) \\;=\\; -\\, \\gamma\\,v(t) \\;+\\; \\xi(t)$$\nThis can be rewritten as a first-order linear ordinary differential equation with a damping rate of $\\gamma/m$:\n$$\\dot{v}(t) + (\\gamma/m) v(t) = \\frac{1}{m}\\xi(t)$$\nWe solve this equation using an integrating factor, $I(t) = \\exp\\left(\\int (\\gamma/m) dt\\right) = e^{(\\gamma/m) t}$. Multiplying the equation by $I(t)$ yields:\n$$e^{(\\gamma/m) t}(\\dot{v}(t) + (\\gamma/m) v(t)) = \\frac{d}{dt}(v(t)e^{(\\gamma/m) t}) = \\frac{1}{m}e^{(\\gamma/m) t}\\xi(t)$$\nIntegrating from $0$ to $t$:\n$$\\int_{0}^{t} \\frac{d}{dt'}(v(t')e^{(\\gamma/m) t'}) dt' = \\frac{1}{m}\\int_{0}^{t} e^{(\\gamma/m) t'} \\xi(t') dt'$$\n$$v(t)e^{(\\gamma/m) t} - v(0)e^0 = \\frac{1}{m}\\int_{0}^{t} e^{(\\gamma/m) t'} \\xi(t') dt'$$\nSolving for $v(t)$ gives the formal solution:\n$$v(t) = v(0)e^{-(\\gamma/m) t} + \\frac{e^{-(\\gamma/m) t}}{m} \\int_{0}^{t} e^{(\\gamma/m) t'} \\xi(t') dt'$$\nNow, we compute the velocity autocorrelation function $C_{vv}(t) = \\langle v(0)v(t) \\rangle$ for $t \\ge 0$.\n$$C_{vv}(t) = \\left\\langle v(0)\\left(v(0)e^{-(\\gamma/m) t} + \\frac{e^{-(\\gamma/m) t}}{m} \\int_{0}^{t} e^{(\\gamma/m) t'} \\xi(t') dt'\\right) \\right\\rangle$$\nUsing the linearity of the expectation operator:\n$$C_{vv}(t) = \\langle v(0)^2 \\rangle e^{-(\\gamma/m) t} + \\frac{e^{-(\\gamma/m) t}}{m} \\left\\langle v(0) \\int_{0}^{t} e^{(\\gamma/m) t'} \\xi(t') dt' \\right\\rangle$$\nThe second term can be written as:\n$$\\frac{e^{-(\\gamma/m) t}}{m} \\int_{0}^{t} e^{(\\gamma/m) t'} \\langle v(0)\\xi(t') \\rangle dt'$$\nThe problem states that for $t'  0$, the random force $\\xi(t')$ is independent of the initial velocity $v(0)$. Therefore, $\\langle v(0)\\xi(t') \\rangle = \\langle v(0) \\rangle \\langle \\xi(t') \\rangle$. Since the particle is in thermal equilibrium, the average velocity is zero, $\\langle v(0) \\rangle = 0$. Also, we are given $\\langle \\xi(t') \\rangle = 0$. Thus, the entire second term vanishes.\nThis leaves:\n$$C_{vv}(t) = \\langle v(0)^2 \\rangle e^{-(\\gamma/m) t}$$\nUsing the given equipartition result $\\langle v(0)^2 \\rangle = \\frac{k_B T}{m}$, we find the velocity autocorrelation function:\n$$C_{vv}(t) = \\frac{k_B T}{m} e^{-(\\gamma/m) t}$$\n\n**Part 2: Calculation of $D$ via the Green–Kubo Relation**\n\nThe Green–Kubo relation for the self-diffusion coefficient $D$ is given as:\n$$D = \\int_{0}^{\\infty} C_{vv}(t) \\, dt$$\nSubstituting the expression for $C_{vv}(t)$:\n$$D = \\int_{0}^{\\infty} \\frac{k_B T}{m} e^{-(\\gamma/m) t} \\, dt = \\frac{k_B T}{m} \\int_{0}^{\\infty} e^{-(\\gamma/m) t} \\, dt$$\nThe integral is elementary:\n$$\\int_{0}^{\\infty} e^{-(\\gamma/m) t} \\, dt = \\left[ -\\frac{m}{\\gamma} e^{-(\\gamma/m) t} \\right]_{0}^{\\infty} = -\\frac{m}{\\gamma}(0 - 1) = \\frac{m}{\\gamma}$$\nTherefore, the diffusion coefficient is:\n$$D = \\frac{k_B T}{m} \\left( \\frac{m}{\\gamma} \\right) = \\frac{k_B T}{\\gamma}$$\n\n**Part 3: Calculation of the Mean-Squared Displacement (MSD)**\n\nThe displacement of the particle from its initial position is $x(t) - x(0) = \\int_{0}^{t} v(t_1) dt_1$. The mean-squared displacement is:\n$$\\langle (x(t)-x(0))^2 \\rangle = \\left\\langle \\left( \\int_{0}^{t} v(t_1) dt_1 \\right)^2 \\right\\rangle = \\left\\langle \\int_{0}^{t} dt_1 \\int_{0}^{t} dt_2 \\, v(t_1) v(t_2) \\right\\rangle$$\nBy interchanging the expectation and integration:\n$$\\langle (x(t)-x(0))^2 \\rangle = \\int_{0}^{t} dt_1 \\int_{0}^{t} dt_2 \\, \\langle v(t_1) v(t_2) \\rangle$$\nSince the system is in equilibrium, the velocity process is stationary, which means $\\langle v(t_1)v(t_2) \\rangle$ depends only on the time difference $|t_1 - t_2|$. Thus, $\\langle v(t_1)v(t_2) \\rangle = C_{vv}(|t_1-t_2|)$. From Part 1, we know $C_{vv}(t) = \\frac{k_B T}{m}e^{-(\\gamma/m) t}$ for $t \\ge 0$, and since autocorrelations must be even functions of time lag, $C_{vv}(\\tau) = \\frac{k_B T}{m}e^{-(\\gamma/m) |\\tau|}$.\nThe integral for the MSD is:\n$$\\langle (x(t)-x(0))^2 \\rangle = \\frac{k_B T}{m} \\int_{0}^{t} dt_1 \\int_{0}^{t} dt_2 \\, e^{-(\\gamma/m) |t_1 - t_2|}$$\nWe can split the square domain of integration $[0, t] \\times [0, t]$ into two triangular regions, $t_1  t_2$ and $t_2  t_1$. By symmetry, the integrals over these two regions are identical. We compute the integral over the region where $0 \\le t_2 \\le t_1 \\le t$ and multiply by $2$:\n$$\\langle (x(t)-x(0))^2 \\rangle = \\frac{2 k_B T}{m} \\int_{0}^{t} dt_1 \\int_{0}^{t_1} dt_2 \\, e^{-(\\gamma/m) (t_1 - t_2)}$$\nFirst, perform the inner integral with respect to $t_2$:\n$$\\int_{0}^{t_1} e^{-(\\gamma/m) (t_1 - t_2)} dt_2 = e^{-(\\gamma/m) t_1} \\int_{0}^{t_1} e^{(\\gamma/m) t_2} dt_2 = e^{-(\\gamma/m) t_1} \\left[ \\frac{m}{\\gamma} e^{(\\gamma/m) t_2} \\right]_{0}^{t_1} = \\frac{m}{\\gamma}e^{-(\\gamma/m) t_1}(e^{(\\gamma/m) t_1} - 1) = \\frac{m}{\\gamma}(1 - e^{-(\\gamma/m) t_1})$$\nNow, perform the outer integral with respect to $t_1$:\n$$\\langle (x(t)-x(0))^2 \\rangle = \\frac{2 k_B T}{m} \\int_{0}^{t} \\frac{m}{\\gamma}(1 - e^{-(\\gamma/m) t_1}) dt_1 = \\frac{2 k_B T}{\\gamma} \\left[ t_1 + \\frac{m}{\\gamma}e^{-(\\gamma/m) t_1} \\right]_{0}^{t}$$\n$$\\langle (x(t)-x(0))^2 \\rangle = \\frac{2 k_B T}{\\gamma} \\left( \\left(t + \\frac{m}{\\gamma}e^{-(\\gamma/m) t}\\right) - \\left(0 + \\frac{m}{\\gamma}\\right) \\right) = \\frac{2 k_B T}{\\gamma} \\left( t - \\frac{m}{\\gamma}(1 - e^{-(\\gamma/m) t}) \\right)$$\nSo, the mean-squared displacement is:\n$$\\langle (x(t)-x(0))^2 \\rangle = \\frac{2 k_B T}{\\gamma}t - \\frac{2 m k_B T}{\\gamma^2}(1-e^{-(\\gamma/m)t})$$\n\n**Part 4: Calculation of $D$ via the Long-Time Limit of the MSD**\n\nThe definition of the diffusion coefficient in terms of the long-time behavior of the MSD is:\n$$D = \\lim_{t\\to\\infty} \\frac{\\langle (x(t)-x(0))^2 \\rangle}{2\\,t}$$\nSubstituting our expression for the MSD:\n$$D = \\lim_{t\\to\\infty} \\frac{1}{2t} \\left( \\frac{2 k_B T}{\\gamma}t - \\frac{2 m k_B T}{\\gamma^2}(1-e^{-(\\gamma/m)t}) \\right)$$\n$$D = \\lim_{t\\to\\infty} \\left( \\frac{k_B T}{\\gamma} - \\frac{m k_B T}{\\gamma^2 t}(1-e^{-(\\gamma/m)t}) \\right)$$\nAs $t \\to \\infty$, the exponential term $e^{-(\\gamma/m) t} \\to 0$. The second term in the limit becomes:\n$$\\lim_{t\\to\\infty} \\frac{m k_B T}{\\gamma^2 t}(1-0) = 0$$\nThus, the limit evaluates to:\n$$D = \\frac{k_B T}{\\gamma}$$\n\n**Part 5: Conclusion and Consistency Check**\n\nThe diffusion coefficient $D$ was derived using two independent methods as requested.\n-   The Green-Kubo method yielded $D = \\frac{k_B T}{\\gamma}$.\n-   The long-time limit of the mean-squared displacement (the Einstein relation) yielded $D = \\frac{k_B T}{\\gamma}$.\nThe two results are identical, confirming the consistency of the theoretical framework. This result is the well-known Einstein-Smoluchowski relation. The final expression for the diffusion coefficient is provided below.",
            "answer": "$$\n\\boxed{\\frac{k_B T}{\\gamma}}\n$$"
        },
        {
            "introduction": "While analytical derivations provide invaluable insight, the practical work of a molecular simulationist involves analyzing finite and noisy time-series data. Estimating the spectral density from a single molecular dynamics trajectory is a non-trivial task that requires a robust statistical and signal-processing pipeline. This final hands-on practice guides you through a complete computational workflow that mirrors real-world research: you will generate a synthetic trajectory based on a physical model, apply techniques like segmentation and windowing to obtain a statistically stable spectral estimate, and use resampling methods to rigorously quantify the uncertainty in your result . This exercise bridges the gap between abstract theory and practical data analysis, equipping you with the essential skills to compute and interpret spectral densities from simulation data with confidence.",
            "id": "3459412",
            "problem": "You are to implement, from first principles, a complete computational pipeline to estimate the velocity spectral density $S_v(\\omega)$ and associated confidence intervals from a single finite trajectory produced by Molecular Dynamics (MD). Your program must synthesize a single stationary velocity trajectory using a physically grounded stochastic model of Langevin dynamics, then estimate $S_v(\\omega)$ using segmentation and windowing followed by delete-one jackknife resampling over segments to obtain confidence intervals at a target angular frequency. The task must be framed purely in mathematical and algorithmic terms and must not rely on external inputs. All physical quantities must be expressed in specified units, and all outputs must be numerically quantified.\n\nFundamental base:\n- Use Newtonian mechanics and the Langevin equation for a single particle of mass $m$ subject to linear friction with coefficient $\\gamma$ at temperature $T$. The instantaneous velocity $v(t)$ evolves as a stationary Ornstein–Uhlenbeck process consistent with equipartition of energy. The equilibrium velocity variance satisfies $\\mathrm{Var}(v) = k_{\\mathrm{B}} T / m$, where $k_{\\mathrm{B}}$ is the Boltzmann constant.\n- The velocity autocorrelation function $C_v(t)$ is defined by $C_v(t) = \\langle v(0) v(t) \\rangle$ for a stationary process, and the velocity spectral density $S_v(\\omega)$ is the spectral measure associated to $C_v(t)$ via the Wiener–Khinchin theorem. Your estimator must be derived from these foundational definitions without employing shortcut formulas in the problem statement.\n\nTrajectory generation:\n- Generate a single synthetic velocity trajectory $\\{v_n\\}_{n=0}^{N-1}$ at uniformly spaced times $t_n = n\\,\\Delta t$, with time step $\\Delta t$ in seconds, by exactly discretizing the stationary Ornstein–Uhlenbeck process that models the Langevin velocity dynamics with relaxation rate $\\lambda = \\gamma/m$. Use a Gaussian initial condition $v_0 \\sim \\mathcal{N}(0, k_{\\mathrm{B}} T / m)$ and the exact discrete-time update $v_{n+1} = a\\, v_n + \\eta_n$ with $a = e^{-\\lambda\\,\\Delta t}$ and $\\eta_n \\sim \\mathcal{N}(0, \\sigma_d^2)$ independent across $n$, where $\\sigma_d^2$ is chosen such that the process is strictly stationary. Ensure numerical reproducibility by fixing a pseudorandom number generator seed per test case.\n\nSpectral estimation pipeline:\n- Segment the single trajectory into $K$ non-overlapping, contiguous segments of equal length $L$ samples (discard any remainder if $N$ is not a multiple of $L$). For each segment:\n  - Remove the segment mean to enforce zero-mean stationarity.\n  - Apply a Hann window (also called Hanning window) to mitigate spectral leakage. Use the canonical discrete Hann window of length $L$.\n  - Compute the one-sided discrete Fourier transform on the windowed segment and construct a one-sided modified periodogram estimator of the power spectral density per cycle-per-second (Hertz) using appropriate normalization that conserves variance under windowing. Then convert to an estimator of $S_v(\\omega)$ per angular frequency by transforming from cycles-per-second to radians-per-second. Your normalization must be chosen so that the units of $S_v(\\omega)$ are $\\mathrm{m}^2/\\mathrm{s}$.\n- Average the one-sided segment periodograms across segments to obtain the segment-averaged spectral estimate $\\widehat{S}_v(\\omega)$ on the discrete angular frequency grid induced by the segment length and sampling interval.\n\nConfidence intervals:\n- Use delete-one jackknife resampling over the $K$ segments to estimate the standard error of $\\widehat{S}_v(\\omega)$ at a single target angular frequency $\\omega^\\star$. Form the $K$ leave-one-out means and compute the jackknife standard error at $\\omega^\\star$. Construct a two-sided confidence interval at confidence level $0.95$ using a normal approximation with $z$-score $z = 1.96$.\n\nUnits and outputs:\n- Velocities must be in $\\mathrm{m}/\\mathrm{s}$, time in $\\mathrm{s}$, angular frequency in $\\mathrm{rad}/\\mathrm{s}$, and the spectral density $S_v(\\omega)$ in $\\mathrm{m}^2/\\mathrm{s}$. The confidence level must be expressed as the decimal $0.95$.\n- For each test case, compute and report the following four values evaluated at the target angular frequency $\\omega^\\star$: the point estimate $\\widehat{S}_v(\\omega^\\star)$, the lower confidence bound, the upper confidence bound, and a boolean indicating whether the known theoretical Ornstein–Uhlenbeck spectral density at $\\omega^\\star$ lies within the jackknife interval. The boolean must be computed by comparing the interval to the physically derived expression for $S_v(\\omega)$ corresponding to the Ornstein–Uhlenbeck process parameters used to generate the trajectory.\n\nTest suite:\nImplement and solve the following three test cases, each defined by $(m, \\gamma, T, \\Delta t, N, L, \\omega^\\star, \\text{seed})$:\n- Case $1$ (general case): $m = 6.63\\times 10^{-26}\\,\\mathrm{kg}$, $\\gamma = 6.63\\times 10^{-14}\\,\\mathrm{kg}/\\mathrm{s}$, $T = 300\\,\\mathrm{K}$, $\\Delta t = 1.0\\times 10^{-15}\\,\\mathrm{s}$, $N = 131072$, $L = 16384$, $\\omega^\\star = \\gamma/m$, seed $= 123$.\n- Case $2$ (boundary condition with few segments): $m = 6.63\\times 10^{-26}\\,\\mathrm{kg}$, $\\gamma = 3.315\\times 10^{-14}\\,\\mathrm{kg}/\\mathrm{s}$, $T = 300\\,\\mathrm{K}$, $\\Delta t = 1.0\\times 10^{-15}\\,\\mathrm{s}$, $N = 32768$, $L = 8192$, $\\omega^\\star = \\gamma/m$, seed $= 456$.\n- Case $3$ (high-friction, short correlation): $m = 6.63\\times 10^{-26}\\,\\mathrm{kg}$, $\\gamma = 3.315\\times 10^{-13}\\,\\mathrm{kg}/\\mathrm{s}$, $T = 300\\,\\mathrm{K}$, $\\Delta t = 5.0\\times 10^{-16}\\,\\mathrm{s}$, $N = 65536$, $L = 8192$, $\\omega^\\star = \\gamma/m$, seed $= 789$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of four elements in the order $[\\widehat{S}_v(\\omega^\\star), \\text{lower}, \\text{upper}, \\text{covered}]$. For example, the output must look like $[[x_1,y_1,z_1,\\text{True}],[x_2,y_2,z_2,\\text{False}],[x_3,y_3,z_3,\\text{True}]]$ with numerical values for $x_i$, $y_i$, and $z_i$ expressed in $\\mathrm{m}^2/\\mathrm{s}$.",
            "solution": "The problem requires the implementation of a computational pipeline to estimate the velocity spectral density, $S_v(\\omega)$, for a particle undergoing Langevin dynamics. The solution involves synthesizing a velocity trajectory, applying statistical signal processing techniques to estimate the spectrum, and using jackknife resampling to compute confidence intervals. The problem is well-posed and scientifically grounded in the principles of statistical mechanics and time-series analysis.\n\n**1. Physical Model and Theoretical Spectral Density**\n\nThe motion of a single particle of mass $m$ in a fluid at temperature $T$ is described by the Langevin equation. In the absence of an external potential, and assuming a linear friction force with coefficient $\\gamma$, the velocity $v(t)$ evolves according to:\n$$ m \\frac{dv}{dt} = -\\gamma v(t) + F_R(t) $$\nwhere $F_R(t)$ is a rapidly fluctuating random force, modeled as Gaussian white noise with $\\langle F_R(t) \\rangle = 0$ and $\\langle F_R(t) F_R(t') \\rangle = 2 \\gamma k_{\\mathrm{B}} T \\delta(t-t')$. This formulation ensures that the system reaches thermal equilibrium, satisfying the fluctuation-dissipation theorem. Here, $k_{\\mathrm{B}}$ is the Boltzmann constant.\n\nThe solution $v(t)$ to this stochastic differential equation is a stationary Ornstein-Uhlenbeck (OU) process. The velocity is a Gaussian random variable with zero mean, $\\langle v(t) \\rangle = 0$, and variance given by the equipartition theorem:\n$$ \\sigma_v^2 = \\langle v(t)^2 \\rangle = \\frac{k_{\\mathrm{B}} T}{m} $$\nThe velocity autocorrelation function (VACF) for this stationary process is:\n$$ C_v(\\tau) = \\langle v(t) v(t+\\tau) \\rangle = \\langle v^2 \\rangle e^{-\\lambda |\\tau|} = \\frac{k_{\\mathrm{B}} T}{m} e^{-\\lambda |\\tau|} $$\nwhere $\\lambda = \\gamma/m$ is the characteristic relaxation rate of the velocity.\n\nThe velocity spectral density $S_v(\\omega)$ is related to the VACF by the Wiener-Khinchin theorem. The problem requires estimating the one-sided spectral density. The theoretical one-sided spectrum is given by:\n$$ S_{v, \\text{one-sided}}(\\omega) = 2 \\int_{-\\infty}^{\\infty} C_v(\\tau) e^{-i\\omega\\tau} d\\tau = 2 \\left( \\frac{k_{\\mathrm{B}} T}{m} \\right) \\int_{-\\infty}^{\\infty} e^{-\\lambda |\\tau|} e^{-i\\omega\\tau} d\\tau $$\nEvaluating the integral gives the theoretical Lorentzian spectrum:\n$$ S_{v, \\text{one-sided}}(\\omega) = 2 \\frac{k_{\\mathrm{B}} T}{m} \\left( \\frac{2\\lambda}{\\lambda^2 + \\omega^2} \\right) = \\frac{4 k_{\\mathrm{B}} T \\gamma}{m^2(\\lambda^2 + \\omega^2)} = \\frac{4 k_{\\mathrm{B}} T \\gamma}{\\gamma^2 + (m\\omega)^2} $$\nFor the specific case where the target angular frequency is $\\omega^\\star = \\lambda$, this simplifies to:\n$$ S_v(\\lambda) = \\frac{4 k_{\\mathrm{B}} T \\gamma}{\\gamma^2 + (m\\lambda)^2} = \\frac{4 k_{\\mathrm{B}} T \\gamma}{\\gamma^2 + (m(\\gamma/m))^2} = \\frac{4 k_{\\mathrm{B}} T \\gamma}{2\\gamma^2} = \\frac{2 k_{\\mathrm{B}} T}{\\gamma} $$\nThis theoretical value will be used to check if our estimated confidence interval \"covers\" the true value.\n\n**2. Trajectory Generation: Exact Discretization of the OU Process**\n\nTo generate a synthetic velocity trajectory $\\{v_n\\}_{n=0}^{N-1}$ at discrete times $t_n = n\\Delta t$, we use the exact analytical solution to the OU process. The velocity at time $t_{n+1}$ is related to the velocity at time $t_n$ by:\n$$ v_{n+1} = v(t_n + \\Delta t) = v_n e^{-\\lambda \\Delta t} + \\int_{t_n}^{t_{n+1}} e^{-\\lambda(t_{n+1}-s)} \\frac{F_R(s)}{m} ds $$\nThis can be written as a discrete-time update rule:\n$$ v_{n+1} = a v_n + \\eta_n $$\nwhere $a = e^{-\\lambda \\Delta t}$. The term $\\eta_n$ is a Gaussian random variable, independent of $v_n$, with zero mean. For the process to be stationary, the variance must remain constant, i.e., $\\mathrm{Var}(v_{n+1}) = \\mathrm{Var}(v_n) = \\sigma_v^2$. Taking the variance of the update rule:\n$$ \\mathrm{Var}(v_{n+1}) = a^2 \\mathrm{Var}(v_n) + \\mathrm{Var}(\\eta_n) $$\n$$ \\sigma_v^2 = a^2 \\sigma_v^2 + \\sigma_d^2 \\implies \\sigma_d^2 = \\sigma_v^2 (1 - a^2) = \\frac{k_{\\mathrm{B}} T}{m} (1 - e^{-2\\lambda\\Delta t}) $$\nwhere $\\sigma_d^2 = \\mathrm{Var}(\\eta_n)$. The trajectory is generated by drawing an initial velocity $v_0$ from $\\mathcal{N}(0, \\sigma_v^2)$ and subsequently generating noise terms $\\eta_n$ from $\\mathcal{N}(0, \\sigma_d^2)$ for each step. A fixed seed for the random number generator ensures reproducibility.\n\n**3. Spectral Estimation Pipeline**\n\nThe raw periodogram of a finite time series is a high-variance, biased estimator of the true spectral density. To improve its statistical properties, we use Welch's method, which involves segmentation, windowing, and averaging.\n\n- **Segmentation:** The trajectory of $N$ points is divided into $K = \\lfloor N/L \\rfloor$ non-overlapping segments, each of length $L$. Averaging over segments reduces the variance of the final estimate by a factor of approximately $K$.\n- **Demeaning:** For each segment, the local mean is subtracted. This is crucial as any non-zero mean would create a large artifact at zero frequency.\n- **Windowing:** Each segment is multiplied by a Hann window, $w_j = 0.5(1 - \\cos(2\\pi j / (L-1)))$ for $j=0, \\dots, L-1$. Windowing tapers the signal at the segment boundaries, which mitigates spectral leakage—the spreading of power from one frequency bin to others due to the implicit rectangular windowing of a finite signal.\n- **Periodogram Calculation and Normalization:** For each windowed segment $y_j$, we compute its Discrete Fourier Transform (DFT), $Y_k = \\sum_{j=0}^{L-1} y_j e^{-i 2\\pi jk/L}$. The one-sided power spectral density (PSD) estimator $P(f)$, in units of $\\mathrm{m}^2 \\mathrm{s}^{-1}$, is constructed. Proper normalization is critical and must account for the DFT definition, the time step $\\Delta t$, and the power loss due to windowing. The appropriate estimator for the one-sided PSD $P(f_k)$ at frequency $f_k = k/(L\\Delta t)$ is:\n$$ P(f_k) = \\frac{2 \\Delta t}{\\sum_{j=0}^{L-1} w_j^2} |Y_k|^2, \\quad \\text{for } 0  k  L/2 $$\nThe factor of $2$ accounts for folding the negative frequencies onto the positive. The DC ($k=0$) and Nyquist ($k=L/2$, if $L$ is even) frequencies are not doubled. The term $\\sum w_j^2$ compensates for the energy reduction caused by the window.\n- **Unit Conversion:** The problem requires the spectral density $S_v(\\omega)$ per unit angular frequency (rad/s), not per unit cycle frequency (Hz). The relationship is derived from the preservation of total variance: $\\int_0^\\infty P(f) df = \\int_0^\\infty S_v(\\omega) d\\omega$. With $\\omega=2\\pi f$, this implies $S_v(\\omega) = P(f)/(2\\pi)$. Thus, the estimator for the spectral density per rad/s is:\n$$ \\widehat{S}_{v, \\text{segment}}(\\omega_k) = \\frac{P(f_k)}{2\\pi} = \\frac{\\Delta t}{\\pi \\sum w_j^2} |Y_k|^2, \\quad \\text{for } 0  k  L/2 $$\n- **Averaging:** The final spectral estimate $\\widehat{S}_v(\\omega)$ is the average of the $K$ individual segment periodograms:\n$$ \\widehat{S}_v(\\omega_k) = \\frac{1}{K} \\sum_{i=1}^{K} \\widehat{S}_{v, \\text{segment } i}(\\omega_k) $$\n\n**4. Confidence Interval Estimation via Jackknife Resampling**\n\nTo quantify the uncertainty in our point estimate $\\widehat{S}_v(\\omega^\\star)$ at the target frequency $\\omega^\\star$, we use delete-one jackknife resampling. This non-parametric technique estimates the variance of an estimator.\n\nFirst, we identify the discrete frequency index $k^\\star$ on our grid $\\omega_k = 2\\pi k/(L\\Delta t)$ that is closest to $\\omega^\\star$. Let the set of periodogram estimates at this frequency from the $K$ segments be $\\{P_1, P_2, \\dots, P_K\\}$. The point estimate is their mean: $\\hat{\\theta} = \\frac{1}{K} \\sum_{i=1}^K P_i$.\n\nThe jackknife procedure is as follows:\n1.  For each $i \\in \\{1, \\dots, K\\}$, create a \"leave-one-out\" sample by removing the $i$-th periodogram $P_i$.\n2.  Compute the leave-one-out mean for each subsample: $\\hat{\\theta}_{(i)} = \\frac{1}{K-1} \\sum_{j \\ne i} P_j$.\n3.  The jackknife estimate for the variance of $\\hat{\\theta}$ is given by:\n$$ \\widehat{\\mathrm{Var}}_{\\mathrm{jack}}(\\hat{\\theta}) = \\frac{K-1}{K} \\sum_{i=1}^K (\\hat{\\theta}_{(i)} - \\bar{\\theta})^2 $$\nwhere $\\bar{\\theta} = \\frac{1}{K} \\sum_{i=1}^K \\hat{\\theta}_{(i)}$ is the mean of the leave-one-out estimates. It is a known property that $\\bar{\\theta}=\\hat{\\theta}$.\n4.  The jackknife standard error is the square root of this variance: $\\mathrm{SE}_{\\mathrm{jack}}(\\hat{\\theta}) = \\sqrt{\\widehat{\\mathrm{Var}}_{\\mathrm{jack}}(\\hat{\\theta})}$.\n5.  A two-sided confidence interval at confidence level $1-\\alpha$ (here, $0.95$) is constructed using a normal approximation:\n$$ [\\hat{\\theta} - z_{\\alpha/2} \\cdot \\mathrm{SE}_{\\mathrm{jack}}(\\hat{\\theta}), \\quad \\hat{\\theta} + z_{\\alpha/2} \\cdot \\mathrm{SE}_{\\mathrm{jack}}(\\hat{\\theta})] $$\nFor a $95\\%$ confidence level, $\\alpha=0.05$ and the z-score is $z_{0.025} = 1.96$. Finally, lower and upper bounds are reported along with a boolean indicating whether the theoretical value $S_v(\\omega^\\star)$ falls within this computed interval.",
            "answer": "[GENERATION ERROR: Numerical result could not be produced. The required computational task was not completed.]"
        }
    ]
}