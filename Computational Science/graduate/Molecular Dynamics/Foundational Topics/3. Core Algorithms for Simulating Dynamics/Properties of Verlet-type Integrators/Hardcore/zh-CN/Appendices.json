{
    "hands_on_practices": [
        {
            "introduction": "要掌握任何数值积分方案的精髓，最好的起点是将其应用于一个可以精确求解的简单模型。谐振子为我们提供了这样一个理想的测试平台。通过推导速度-Verlet算法应用于谐振子时的精确线性更新映射，我们可以分析其稳定性边界和对动力学频率的离散化效应，这是在更复杂的模拟中选择合适时间步长的基础。",
            "id": "3438597",
            "problem": "考虑一个一维谐振子，其哈密顿量为 $H=\\tfrac{p^{2}}{2 m}+\\tfrac{1}{2} k q^{2}$，角频率为 $\\omega=\\sqrt{k/m}$。在分子动力学 (MD) 中，速度-Verlet 积分器根据牛顿定律 $m \\ddot{q}=-k q$，使用时间步长 $h$ 和加速度 $a=-\\omega^{2} q$ 来推进位置 $q$ 和速度 $v$。严格地从这些基础出发，推导谐振子的速度-Verlet 精确线性更新映射，分析其特征值，并获得以 $\\omega$ 和 $h$ 表示的精确稳定性边界。从该线性映射出发，将离散频率 $\\omega_{h}$ 定义为每步的旋转角除以时间步长，并将其表示为 $\\omega$ 和 $h$ 的闭式函数。最后，令 $\\delta \\phi$ 表示在一个精确的连续时间周期 $T=2 \\pi / \\omega$ 内累积的相位误差，定义为时间 $T$ 后的数值相位推进减去 $2 \\pi$。推导 $\\delta \\phi$（以弧度为单位）关于 $\\omega$ 和 $h$ 的闭式表达式。\n\n你的推导必须从牛顿第二定律和速度-Verlet 更新规则出发，并且除了这些定义之外，不得假定积分器的任何预先陈述的性质。请将你的最终答案以行矩阵 $\\left(h_{\\max}, \\omega_{h}, \\delta \\phi\\right)$ 的形式给出，其中 $h_{\\max}$ 是表示为 $\\omega$ 的函数的最大稳定时间步长，$\\omega_{h}$ 是离散频率，$\\delta \\phi$ 是每个周期的相位误差（以弧度为单位）。不需要进行数值计算或四舍五入，最终表达式必须是精确的闭式形式。",
            "solution": "该问题要求分析应用于一维谐振子的速度-Verlet 积分器。分析内容包括推导线性更新映射、确定稳定性边界、求出数值频率以及计算相位误差。整个推导过程必须按照问题中的定义，从第一性原理出发。\n\n首先，我们陈述标准的速度-Verlet 算法。对于一个位置为 $q(t)$、速度为 $v(t)$、加速度为 $a(t)$ 的粒子，其在时间 $t+h$ 的状态由时间 $t$ 的状态计算如下：\n1. 更新位置：$q(t+h) = q(t) + h v(t) + \\frac{h^2}{2} a(t)$\n2. 计算未来加速度：$a(t+h)$ 由 $q(t+h)$ 计算得出。\n3. 更新速度：$v(t+h) = v(t) + \\frac{h}{2} [a(t) + a(t+h)]$\n\n对于一维谐振子，哈密顿量为 $H=\\frac{p^{2}}{2 m}+\\frac{1}{2} k q^{2}$，其中 $p=mv$ 是动量。运动方程由牛顿第二定律给出，$m\\ddot{q} = -kq$。加速度为 $a(t) = \\ddot{q}(t) = -\\frac{k}{m} q(t)$。使用角频率的给定定义 $\\omega = \\sqrt{k/m}$，加速度为 $a(t) = -\\omega^2 q(t)$。\n\n令 $q_n = q(nh)$ 和 $v_n = v(nh)$ 分别表示在第 $n$ 个时间步的位置和速度。相应的加速度为 $a_n = -\\omega^2 q_n$。谐振子的速度-Verlet 更新规则变为：\n$q_{n+1} = q_n + h v_n + \\frac{h^2}{2} a_n = q_n + h v_n - \\frac{h^2 \\omega^2}{2} q_n$\n$v_{n+1} = v_n + \\frac{h}{2} [a_n + a_{n+1}]$\n\n为了求出 $v_{n+1}$，我们首先需要 $a_{n+1} = -\\omega^2 q_{n+1}$。代入 $q_{n+1}$ 的表达式：\n$a_{n+1} = -\\omega^2 \\left( q_n + h v_n - \\frac{h^2 \\omega^2}{2} q_n \\right)$\n\n现在，我们将 $a_n$ 和 $a_{n+1}$ 代入速度更新方程：\n$v_{n+1} = v_n + \\frac{h}{2} \\left[ -\\omega^2 q_n - \\omega^2 \\left( q_n + h v_n - \\frac{h^2 \\omega^2}{2} q_n \\right) \\right]$\n$v_{n+1} = v_n - \\frac{h \\omega^2}{2} \\left[ q_n + q_n + h v_n - \\frac{h^2 \\omega^2}{2} q_n \\right]$\n$v_{n+1} = v_n - \\frac{h \\omega^2}{2} \\left[ (2 - \\frac{h^2 \\omega^2}{2}) q_n + h v_n \\right]$\n$v_{n+1} = v_n - \\omega^2 h (1 - \\frac{h^2 \\omega^2}{4}) q_n - \\frac{h^2 \\omega^2}{2} v_n$\n\n我们现在可以写出完整的线性更新映射，它将状态向量 $(q_{n+1}, v_{n+1})^T$ 表示为 $(q_n, v_n)^T$ 的线性变换。\n$q_{n+1} = \\left(1 - \\frac{\\omega^2 h^2}{2}\\right) q_n + h v_n$\n$v_{n+1} = -\\omega^2 h \\left(1 - \\frac{\\omega^2 h^2}{4}\\right) q_n + \\left(1 - \\frac{\\omega^2 h^2}{2}\\right) v_n$\n\n这可以写成矩阵形式：\n$$\n\\begin{pmatrix} q_{n+1} \\\\ v_{n+1} \\end{pmatrix} = M \\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}\n$$\n其中更新矩阵 $M$，也称为转移矩阵，是：\n$$\nM = \\begin{pmatrix} 1 - \\frac{\\omega^2 h^2}{2}  h \\\\ -\\omega^2 h \\left(1 - \\frac{\\omega^2 h^2}{4}\\right)  1 - \\frac{\\omega^2 h^2}{2} \\end{pmatrix}\n$$\n\n积分器的稳定性由矩阵 $M$ 的特征值 $\\lambda$ 决定。特征值是特征方程 $\\det(M - \\lambda I) = 0$ 的解，其中 $I$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} 1 - \\frac{\\omega^2 h^2}{2} - \\lambda  h \\\\ -\\omega^2 h \\left(1 - \\frac{\\omega^2 h^2}{4}\\right)  1 - \\frac{\\omega^2 h^2}{2} - \\lambda \\end{pmatrix} = 0\n$$\n$$\n\\left(1 - \\frac{\\omega^2 h^2}{2} - \\lambda\\right)^2 + h^2 \\omega^2 \\left(1 - \\frac{\\omega^2 h^2}{4}\\right) = 0\n$$\n$$\n\\left(\\lambda - \\left(1 - \\frac{\\omega^2 h^2}{2}\\right)\\right)^2 = -h^2 \\omega^2 \\left(1 - \\frac{\\omega^2 h^2}{4}\\right)\n$$\n$$\n\\lambda - \\left(1 - \\frac{\\omega^2 h^2}{2}\\right) = \\pm i \\omega h \\sqrt{1 - \\frac{\\omega^2 h^2}{4}}\n$$\n$$\n\\lambda = 1 - \\frac{\\omega^2 h^2}{2} \\pm i \\omega h \\sqrt{1 - \\frac{\\omega^2 h^2}{4}}\n$$\n如果特征值的模小于或等于 $1$，则数值积分是稳定的。我们来计算 $|\\lambda|^2$：\n$$\n|\\lambda|^2 = \\left(1 - \\frac{\\omega^2 h^2}{2}\\right)^2 + \\left(\\omega h \\sqrt{1 - \\frac{\\omega^2 h^2}{4}}\\right)^2\n$$\n$$\n|\\lambda|^2 = \\left(1 - \\omega^2 h^2 + \\frac{\\omega^4 h^4}{4}\\right) + \\omega^2 h^2 \\left(1 - \\frac{\\omega^2 h^2}{4}\\right)\n$$\n$$\n|\\lambda|^2 = 1 - \\omega^2 h^2 + \\frac{\\omega^4 h^4}{4} + \\omega^2 h^2 - \\frac{\\omega^4 h^4}{4} = 1\n$$\n这个结果 $|\\lambda|^2=1$ 成立的条件是，当且仅当平方根内的参数为非负，这确保了特征值是单位圆上的共轭复数。如果该参数为负，特征值将变为实数，其中一个的模将大于 $1$，导致指数增长和不稳定性。因此，稳定性条件是：\n$1 - \\frac{\\omega^2 h^2}{4} \\geq 0 \\implies \\omega^2 h^2 \\leq 4$\n由于 $\\omega$ 和 $h$ 均为正数，这给出 $\\omega h \\leq 2$。最大稳定时间步长 $h_{\\max}$ 对应于等式 $\\omega h_{\\max} = 2$，即 $h_{\\max} = \\frac{2}{\\omega}$。\n\n接下来，我们推导离散频率 $\\omega_h$。在稳定区域内，特征值的形式为 $\\lambda = e^{\\pm i \\theta_h}$，其中 $\\theta_h$ 是每步的数值相位推进。我们可以写出 $\\lambda = \\cos(\\theta_h) + i \\sin(\\theta_h)$。通过将其与 $\\lambda$ 的表达式进行比较，我们确定：\n$\\cos(\\theta_h) = \\text{Re}(\\lambda) = 1 - \\frac{\\omega^2 h^2}{2}$\n数值频率 $\\omega_h$ 定义为单位时间的相位推进，因此 $\\omega_h = \\theta_h / h$。\n$\\theta_h = \\omega_h h = \\arccos\\left(1 - \\frac{\\omega^2 h^2}{2}\\right)$\n因此，离散频率为：\n$\\omega_h = \\frac{1}{h} \\arccos\\left(1 - \\frac{\\omega^2 h^2}{2}\\right)$\n\n最后，我们推导在一个精确的连续时间周期 $T = 2\\pi / \\omega$ 内的相位误差 $\\delta \\phi$。一个周期内的时间步数为 $N = T/h = \\frac{2\\pi}{\\omega h}$。\n在时间 $T$ 内的总数值相位推进为 $N \\theta_h = N (\\omega_h h)$。\n在同一周期内的总精确相位推进为 $\\omega T = \\omega(\\frac{2\\pi}{\\omega}) = 2\\pi$。\n相位误差 $\\delta \\phi$ 是数值相位推进与精确相位推进之差：\n$\\delta \\phi = N \\omega_h h - 2\\pi$\n$\\delta \\phi = \\left(\\frac{2\\pi}{\\omega h}\\right) \\omega_h h - 2\\pi = \\frac{2\\pi \\omega_h}{\\omega} - 2\\pi = 2\\pi \\left(\\frac{\\omega_h}{\\omega} - 1\\right)$\n代入 $\\omega_h$ 的表达式：\n$\\delta \\phi = 2\\pi \\left(\\frac{1}{\\omega h} \\arccos\\left(1 - \\frac{\\omega^2 h^2}{2}\\right) - 1\\right)$\n\n所需的三个量是 $h_{\\max} = \\frac{2}{\\omega}$，$\\omega_h = \\frac{1}{h} \\arccos\\left(1 - \\frac{\\omega^2 h^2}{2}\\right)$，以及 $\\delta \\phi = 2\\pi \\left(\\frac{1}{\\omega h} \\arccos\\left(1 - \\frac{\\omega^2 h^2}{2}\\right) - 1\\right)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{\\omega}  \\frac{1}{h} \\arccos\\left(1 - \\frac{\\omega^2 h^2}{2}\\right)  2\\pi \\left( \\frac{1}{\\omega h} \\arccos\\left(1 - \\frac{\\omega^2 h^2}{2}\\right) - 1 \\right) \\end{pmatrix}}$$"
        },
        {
            "introduction": "Verlet类型积分器的一个关键特性是其交错时间网格，其中位置和速度在不同的时间点上定义。虽然这种结构是其优良性质（如辛性）的根源，但它也给计算时间相关函数带来了挑战。本练习将探讨如何从交错速度（半步速度）和中心化速度（整步速度）估计速度自相关函数，并揭示两者之间的系统性差异，从而强调了在后处理MD轨迹数据时精确定义可观测量的重要性。",
            "id": "3438653",
            "problem": "考虑一个质量为 $m$、角频率为 $\\omega$ 的一维谐振子，其运动由牛顿方程 $\\ddot{x}(t) = -\\omega^{2} x(t)$ 描述。该系统通过一个辛、时间可逆的蛙跳格式在时间上推进，该格式具有半踢/漂移排序和均匀时间步长 $h$：\n$$\nv^{n+\\frac{1}{2}} = v^{n-\\frac{1}{2}} - h\\,\\omega^{2} x^{n}, \\quad x^{n+1} = x^{n} + h\\,v^{n+\\frac{1}{2}},\n$$\n其中 $x^{n} \\equiv x(nh)$ 且 $v^{n+\\frac{1}{2}} \\equiv v\\!\\left((n+\\tfrac{1}{2})h\\right)$。在温度为 $T$ 的平衡态下，速度过程是平稳的，且连续时间速度自相关函数 $\\langle v(0)\\,v(t) \\rangle$ 仅取决于时间延迟。\n\n速度自相关函数的两种常用离散估计量是：\n- 半步估计量 $C_{\\mathrm{half}}(nh) = \\langle v^{\\frac{1}{2}}(0)\\,v^{n+\\frac{1}{2}} \\rangle$，它关联了相隔 $nh$ 的半步时刻的速度；\n- 整步估计量 $C_{\\mathrm{on}}(nh)$，它是通过中心平均 $\\tilde{v}^{n} = \\frac{1}{2}\\!\\left(v^{n+\\frac{1}{2}} + v^{n-\\frac{1}{2}}\\right)$ 先定义整步速度，然后进行关联 $C_{\\mathrm{on}}(nh) = \\langle \\tilde{v}^{0}\\,\\tilde{v}^{n} \\rangle$ 而形成的。\n\n从上述基本方程出发，推导离散谐波解，并用它来评估这两种估计量有何不同。具体来说，确定一个闭合形式的乘法修正因子 $F(\\omega h)$，使得对所有整数 $n$ 都有 $C_{\\mathrm{half}}(nh) = F(\\omega h)\\,C_{\\mathrm{on}}(nh)$。将 $F(\\omega h)$ 表示为仅含 $\\omega$ 和 $h$ 的单个解析表达式。不要假设 $m$、$ \\omega$、$h$ 或 $T$ 的任何具体数值，也不要使用任何未从所述动力学推导出的简化公式。最终答案必须是那个单个的解析表达式 $F(\\omega h)$，不带单位。",
            "solution": "所述问题在科学上是合理的、自洽的且提法得当。我们可以从提供的基本方程出发，进行直接的解析推导。目标是确定对于用蛙跳算法积分的谐振子，其速度自相关函数的两种不同离散估计量之间的关系。\n\n蛙跳积分格式由以下耦合方程给出：\n$$\nv^{n+\\frac{1}{2}} = v^{n-\\frac{1}{2}} - h\\,\\omega^{2} x^{n}\n$$\n$$\nx^{n+1} = x^{n} + h\\,v^{n+\\frac{1}{2}}\n$$\n其中 $x^n = x(nh)$ 且 $v^{n \\pm \\frac{1}{2}} = v((n \\pm \\frac{1}{2})h)$。我们可以消去速度项，以找到一个关于位置 $x^n$ 的单一递推关系。从第二个方程，我们有：\n$$\nv^{n+\\frac{1}{2}} = \\frac{x^{n+1} - x^{n}}{h}\n$$\n将索引 $n$ 移至 $n-1$，我们也有：\n$$\nv^{n-\\frac{1}{2}} = \\frac{x^{n} - x^{n-1}}{h}\n$$\n将这两个速度表达式代入第一个蛙跳方程，得到：\n$$\n\\frac{x^{n+1} - x^{n}}{h} = \\frac{x^{n} - x^{n-1}}{h} - h\\,\\omega^{2} x^{n}\n$$\n乘以 $h$ 并重新整理各项，得到关于位置的二阶线性齐次差分方程，这是原始微分方程的离散模拟：\n$$\nx^{n+1} - (2 - (\\omega h)^{2})x^{n} + x^{n-1} = 0\n$$\n这是一个标准的递推关系。我们寻求形式为 $x^n = A e^{i(n\\theta+\\phi')}$ 的解。特征方程为 $z^2 - (2 - (\\omega h)^2)z + 1 = 0$。对于一个稳定的振荡解，根 $z$ 必须是单位圆上的复共轭对，这要求稳定性条件 $(\\omega h)^2 \\le 4$。设根为 $z = e^{\\pm i\\Omega h}$，其中 $\\Omega$ 是离散振荡器的数值频率。根的和为 $2\\cos(\\Omega h)$，它必须等于中间项的系数。因此：\n$$\n2\\cos(\\Omega h) = 2 - (\\omega h)^2 \\implies \\cos(\\Omega h) = 1 - \\frac{(\\omega h)^2}{2}\n$$\n使用半角恒等式 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$，我们找到了蛙跳积分器的精确色散关系：\n$$\n1 - 2\\sin^2\\left(\\frac{\\Omega h}{2}\\right) = 1 - \\frac{(\\omega h)^2}{2} \\implies \\sin\\left(\\frac{\\Omega h}{2}\\right) = \\frac{\\omega h}{2}\n$$\n位置的通实解可以写为 $x^n = A\\cos(n\\Omega h + \\phi)$，其中 $A$ 和 $\\phi$ 是由初始条件决定的常数。\n\n接下来，我们基于 $x^n$ 的这个解来推导速度的表达式。半步速度是：\n$$\nv^{n+\\frac{1}{2}} = \\frac{x^{n+1} - x^{n}}{h} = \\frac{A}{h}[\\cos((n+1)\\Omega h + \\phi) - \\cos(n\\Omega h + \\phi)]\n$$\n使用三角恒等式 $\\cos(a) - \\cos(b) = -2\\sin(\\frac{a+b}{2})\\sin(\\frac{a-b}{2})$，我们得到：\n$$\nv^{n+\\frac{1}{2}} = \\frac{A}{h}\\left[-2\\sin\\left(\\frac{(n+1+n)\\Omega h + 2\\phi}{2}\\right)\\sin\\left(\\frac{(n+1-n)\\Omega h}{2}\\right)\\right] = -\\frac{2A}{h}\\sin\\left(\\left(n+\\frac{1}{2}\\right)\\Omega h + \\phi\\right)\\sin\\left(\\frac{\\Omega h}{2}\\right)\n$$\n代入色散关系 $\\sin(\\frac{\\Omega h}{2}) = \\frac{\\omega h}{2}$：\n$$\nv^{n+\\frac{1}{2}} = -\\frac{2A}{h}\\sin\\left(\\left(n+\\frac{1}{2}\\right)\\Omega h + \\phi\\right)\\left(\\frac{\\omega h}{2}\\right) = -A\\omega\\sin\\left(\\left(n+\\frac{1}{2}\\right)\\Omega h + \\phi\\right)\n$$\n现在，我们求整步速度 $\\tilde{v}^n = \\frac{1}{2}(v^{n+\\frac{1}{2}} + v^{n-\\frac{1}{2}})$：\n$$\n\\tilde{v}^n = -\\frac{A\\omega}{2}\\left[\\sin\\left(\\left(n+\\frac{1}{2}\\right)\\Omega h + \\phi\\right) + \\sin\\left(\\left(n-\\frac{1}{2}\\right)\\Omega h + \\phi\\right)\\right]\n$$\n使用恒等式 $\\sin(a) + \\sin(b) = 2\\sin(\\frac{a+b}{2})\\cos(\\frac{a-b}{2})$：\n$$\n\\tilde{v}^n = -\\frac{A\\omega}{2}\\left[2\\sin(n\\Omega h + \\phi)\\cos\\left(\\frac{\\Omega h}{2}\\right)\\right] = -A\\omega\\cos\\left(\\frac{\\Omega h}{2}\\right)\\sin(n\\Omega h + \\phi)\n$$\n有了这些表达式，我们就可以计算这两个相关函数了。期望值 $\\langle\\cdot\\rangle$ 是对平稳系综的平均，这意味着对相位 $\\phi$（在 $[0, 2\\pi)$ 上均匀分布）和振幅 $A$ 进行平均。我们使用恒等式 $\\langle\\sin(X+\\phi)\\sin(Y+\\phi)\\rangle_{\\phi} = \\frac{1}{2}\\cos(X-Y)$。\n\n半步相关函数是 $C_{\\mathrm{half}}(nh) = \\langle v^{\\frac{1}{2}} v^{n+\\frac{1}{2}} \\rangle$，这里我们利用了平稳性将初始时间索引设为 $0$。\n$$\nC_{\\mathrm{half}}(nh) = \\langle (-A\\omega\\sin(\\frac{1}{2}\\Omega h + \\phi))(-A\\omega\\sin((n+\\frac{1}{2})\\Omega h + \\phi)) \\rangle\n$$\n$$\nC_{\\mathrm{half}}(nh) = \\langle A^2 \\rangle \\omega^2 \\langle \\sin(\\frac{1}{2}\\Omega h + \\phi)\\sin((n+\\frac{1}{2})\\Omega h + \\phi) \\rangle_{\\phi}\n$$\n$$\nC_{\\mathrm{half}}(nh) = \\langle A^2 \\rangle \\omega^2 \\left[\\frac{1}{2}\\cos\\left(\\frac{1}{2}\\Omega h - (n+\\frac{1}{2})\\Omega h\\right)\\right] = \\frac{1}{2}\\langle A^2 \\rangle \\omega^2 \\cos(-n\\Omega h) = \\frac{1}{2}\\langle A^2 \\rangle \\omega^2 \\cos(n\\Omega h)\n$$\n整步相关函数是 $C_{\\mathrm{on}}(nh) = \\langle \\tilde{v}^{0} \\tilde{v}^{n} \\rangle$：\n$$\nC_{\\mathrm{on}}(nh) = \\langle (-A\\omega\\cos(\\frac{\\Omega h}{2})\\sin(\\phi))(-A\\omega\\cos(\\frac{\\Omega h}{2})\\sin(n\\Omega h + \\phi)) \\rangle\n$$\n$$\nC_{\\mathrm{on}}(nh) = \\langle A^2 \\rangle \\omega^2 \\cos^2\\left(\\frac{\\Omega h}{2}\\right) \\langle \\sin(\\phi)\\sin(n\\Omega h + \\phi) \\rangle_{\\phi}\n$$\n$$\nC_{\\mathrm{on}}(nh) = \\langle A^2 \\rangle \\omega^2 \\cos^2\\left(\\frac{\\Omega h}{2}\\right) \\left[\\frac{1}{2}\\cos(-n\\Omega h)\\right] = \\frac{1}{2}\\langle A^2 \\rangle \\omega^2 \\cos^2\\left(\\frac{\\Omega h}{2}\\right)\\cos(n\\Omega h)\n$$\n我们需要找到因子 $F(\\omega h)$，使得 $C_{\\mathrm{half}}(nh) = F(\\omega h) C_{\\mathrm{on}}(nh)$。比较这两个表达式：\n$$\n\\frac{1}{2}\\langle A^2 \\rangle \\omega^2 \\cos(n\\Omega h) = F(\\omega h) \\left( \\frac{1}{2}\\langle A^2 \\rangle \\omega^2 \\cos^2\\left(\\frac{\\Omega h}{2}\\right)\\cos(n\\Omega h) \\right)\n$$\n对于相关性不为零的 $n$ 值，我们可以消去公因子：\n$$\n1 = F(\\omega h) \\cos^2\\left(\\frac{\\Omega h}{2}\\right) \\implies F(\\omega h) = \\frac{1}{\\cos^2\\left(\\frac{\\Omega h}{2}\\right)}\n$$\n最后，我们使用色散关系将这个因子表示为 $\\omega$ 和 $h$ 的函数。利用 $\\cos^2(\\theta) = 1-\\sin^2(\\theta)$ 和 $\\sin(\\frac{\\Omega h}{2}) = \\frac{\\omega h}{2}$：\n$$\n\\cos^2\\left(\\frac{\\Omega h}{2}\\right) = 1 - \\sin^2\\left(\\frac{\\Omega h}{2}\\right) = 1 - \\left(\\frac{\\omega h}{2}\\right)^2 = 1 - \\frac{(\\omega h)^2}{4}\n$$\n代入这个结果，得到修正因子的最终表达式：\n$$\nF(\\omega h) = \\frac{1}{1 - \\frac{(\\omega h)^2}{4}}\n$$\n这个表达式对所有整数 $n$ 都有效，并且只依赖于乘积 $\\omega h$。",
            "answer": "$$\n\\boxed{\\frac{1}{1 - \\frac{(\\omega h)^{2}}{4}}}\n$$"
        },
        {
            "introduction": "虽然单个振荡模式的线性稳定性分析是选择时间步长的第一步，但对于具有多个相互作用自由度的系统，这还远远不够。当不同模式的离散频率满足特定整数关系时，可能会出现一种称为参数共振的数值伪影，导致能量在模式间发生大幅度、非物理性的传递。通过分析一个弱耦合双振子系统，本练习将揭示这种数值共振的条件，并计算出导致最低阶共振的时间步长，这有助于学生深刻理解在多尺度系统中选择时间步长（即便满足 $h\\omega_{\\max}  2$ 条件）所面临的复杂挑战。",
            "id": "3438643",
            "problem": "考虑一个分子动力学 (MD) 模型，该模型具有两个单位质量的自由度，其坐标为 $q_{1}$ 和 $q_{2}$，共轭动量为 $p_{1}$ 和 $p_{2}$，由哈密顿量所支配\n$$\nH(q,p) \\;=\\; \\frac{1}{2}\\big(p_{1}^{2} + p_{2}^{2}\\big) \\;+\\; \\frac{1}{2}\\omega_{1}^{2} q_{1}^{2} \\;+\\; \\frac{1}{2}\\omega_{2}^{2} q_{2}^{2} \\;+\\; \\epsilon\\, q_{1}^{2} q_{2}^{2},\n$$\n其中 $\\epsilon$ 是一个小的无量纲耦合参数，$\\omega_{1},\\omega_{2}0$ 是不同的特征频率。该系统使用速度-Verlet格式以固定时间步长 $h0$ 进行积分。\n\n从牛顿第二定律 $m\\,\\ddot{q} = -\\partial V/\\partial q$（其中 $m=1$）以及速度-Verlet更新方程的定义出发\n$$\nq^{n+1} \\;=\\; q^{n} \\;+\\; h\\,v^{n} \\;+\\; \\frac{h^{2}}{2}\\,a(q^{n}), \\qquad\nv^{n+1} \\;=\\; v^{n} \\;+\\; \\frac{h}{2}\\big(a(q^{n}) + a(q^{n+1})\\big),\n$$\n其中 $a(q) = -\\nabla V(q)$，进行以下分析：\n\n- 对于势为 $V(q) = \\tfrac{1}{2}\\omega^{2} q^{2}$ 的单个非耦合谐振模式，推导由速度-Verlet方法引起的线性位置递推关系，并证明在 $(q^{n},q^{n-1})$ 上的一步映射是以离散相角 $\\phi(\\omega h)$ 进行的旋转，即当 $h\\omega  2$ 时，其特征乘子为 $\\exp(\\pm i\\phi)$，其中 $\\phi \\in (0,\\pi)$。\n\n- 在上述弱耦合双频系统中（$|q_{1}|,|q_{2}|$ 和 $\\epsilon$ 很小），使用针对辛积分器的前导阶后向误差分析，论证为何当整数组合 $k_{1},k_{2},m$ 很小且满足 $k_{1}\\phi_{1} \\pm k_{2}\\phi_{2} \\approx m\\pi$ 时，离散相角 $\\phi_{1} = \\phi(\\omega_{1} h)$ 和 $\\phi_{2} = \\phi(\\omega_{2} h)$ 的近公度性会在修正哈密顿量中产生小分母，从而即便在单模线性稳定性条件 $h\\omega_1  2$ 和 $h\\omega_2  2$ 成立的情况下，也会产生参数共振和大的长时间能量误差。\n\n在 $\\omega_1 = 1\\,\\text{rad}\\,\\text{ps}^{-1}$ 和 $\\omega_2 = \\sqrt{2}\\,\\text{rad}\\,\\text{ps}^{-1}$ 的条件下，关注 $k_{1} = k_{2} = m = 1$ 的最低阶共振，确定求解共振条件 $\\phi_{1} + \\phi_{2} = \\pi$ 的最小正时间步长 $h$（单位为皮秒 ps），并满足 $h\\omega_{\\max}  2$ 的约束，其中 $\\omega_{\\max} = \\max\\{\\omega_{1},\\omega_{2}\\}$。用 $\\text{ps}$ 表示最终的 $h$ 值，并将答案四舍五入到4位有效数字。",
            "solution": "该问题被评估为有效。它在科学上植根于经典力学和数值分析领域，具体涉及哈密顿系统辛积分器的性质。该问题是适定的、自洽的，并提供了所有必要的参数和定义。它不包含任何矛盾或歧义。\n\n我们将按要求分三部分解决该问题。\n\n首先，我们分析一个具有势 $V(q) = \\frac{1}{2}\\omega^{2} q^{2}$ 和单位质量 $m=1$ 的单个非耦合谐振模式。运动方程为 $\\ddot{q} = -\\frac{\\partial V}{\\partial q} = -\\omega^{2}q$。加速度为 $a(q) = -\\omega^{2}q$。速度-Verlet更新方程为：\n$$\nq^{n+1} = q^{n} + h\\,v^{n} + \\frac{h^{2}}{2}\\,a(q^{n}) = q^{n} + h\\,v^{n} - \\frac{h^{2}\\omega^{2}}{2}\\,q^{n}\n$$\n$$\nv^{n+1} = v^{n} + \\frac{h}{2}\\big(a(q^{n}) + a(q^{n+1})\\big) = v^{n} - \\frac{h\\omega^{2}}{2}\\big(q^{n} + q^{n+1}\\big)\n$$\n为了获得位置 $q$ 的递推关系，我们消去速度 $v$。从第一个方程，我们表示出 $h\\,v^{n}$：\n$$\nh\\,v^{n} = q^{n+1} - q^{n} + \\frac{h^{2}\\omega^{2}}{2}\\,q^{n}\n$$\n我们同样需要 $h\\,v^{n-1}$ 的表达式，这可以通过将索引 $n \\to n-1$ 移位得到：\n$$\nh\\,v^{n-1} = q^{n} - q^{n-1} + \\frac{h^{2}\\omega^{2}}{2}\\,q^{n-1}\n$$\n现在，我们用 $v^{n-1}$ 来重写 $v^{n}$ 的速度更新方程：\n$$\nv^{n} = v^{n-1} - \\frac{h\\omega^{2}}{2}\\big(q^{n-1} + q^{n}\\big)\n$$\n乘以 $h$ 得到：\n$$\nh\\,v^{n} = h\\,v^{n-1} - \\frac{h^{2}\\omega^{2}}{2}\\big(q^{n-1} + q^{n}\\big)\n$$\n代入 $h\\,v^{n}$ 和 $h\\,v^{n-1}$ 的表达式：\n$$\nq^{n+1} - q^{n} + \\frac{h^{2}\\omega^{2}}{2}\\,q^{n} = \\left(q^{n} - q^{n-1} + \\frac{h^{2}\\omega^{2}}{2}\\,q^{n-1}\\right) - \\frac{h^{2}\\omega^{2}}{2}\\big(q^{n-1} + q^{n}\\big)\n$$\n简化此方程：\n$$\nq^{n+1} - q^{n} + \\frac{h^{2}\\omega^{2}}{2}\\,q^{n} = q^{n} - q^{n-1} - \\frac{h^{2}\\omega^{2}}{2}\\,q^{n}\n$$\n$$\nq^{n+1} - \\left(2 - h^{2}\\omega^{2}\\right) q^{n} + q^{n-1} = 0\n$$\n这就是线性位置递推关系。为了分析其性质，我们通过代入 $q^{n} = \\lambda^{n}$ 来考虑其特征方程：\n$$\n\\lambda^{2} - \\left(2 - h^{2}\\omega^{2}\\right)\\lambda + 1 = 0\n$$\n其根（特征乘子）由二次求根公式给出：\n$$\n\\lambda = \\frac{(2 - h^{2}\\omega^{2}) \\pm \\sqrt{(2 - h^{2}\\omega^{2})^{2} - 4}}{2}\n$$\n如果乘子是单位圆上的一对复共轭，该映射就对应于一个旋转，这要求判别式为负：\n$$\n(2 - h^{2}\\omega^{2})^{2} - 4  0 \\implies (2 - h^{2}\\omega^{2})^{2}  4 \\implies |2 - h^{2}\\omega^{2}|  2\n$$\n这等价于 $-2  2 - h^{2}\\omega^{2}  2$。右侧的不等式 $2 - h^{2}\\omega^{2}  2$ 意味着 $-h^{2}\\omega^{2}  0$，对于 $h, \\omega  0$ 这总是成立的。左侧的不等式 $-2  2 - h^{2}\\omega^{2}$ 意味着 $h^{2}\\omega^{2}  4$，即 $h\\omega  2$。这是速度-Verlet方法的线性稳定性条件。当此条件成立时，我们可以定义一个离散相角 $\\phi \\in (0,\\pi)$ 使得：\n$$\n\\cos(\\phi) = \\frac{2 - h^{2}\\omega^{2}}{2} = 1 - \\frac{h^{2}\\omega^{2}}{2}\n$$\n条件 $h\\omega  2$ 确保了 $-1  \\cos(\\phi)  1$。特征方程变为 $\\lambda^{2} - 2\\cos(\\phi)\\lambda + 1 = 0$，其根为 $\\lambda = \\cos(\\phi) \\pm i\\sin(\\phi) = \\exp(\\pm i\\phi)$。这证实了状态空间上的一步映射是一个角度为 $\\phi = \\arccos\\left(1 - \\frac{h^{2}\\omega^{2}}{2}\\right)$ 的旋转。\n\n其次，我们使用后向误差分析来解释数值共振。速度-Verlet方法是辛的。对于任何哈密顿系统 $H$ 和任何辛积分器，都存在一个修正哈密顿量 $H_{\\text{mod}}$，它是时间步长 $h$ 的一个渐近级数，并被数值算法精确守恒。对于像速度-Verlet这样的对称方法，该级数只包含 $h$ 的偶数次幂：\n$$\nH_{\\text{mod}} = H + h^{2}H_{(2)} + h^{4}H_{(4)} + \\mathcal{O}(h^{6})\n$$\n数值轨迹 $(q^{n}, p^{n})$是由 $H_{\\text{mod}}$ 定义的哈密顿系统的精确解。修正项 $H_{(k)}$ 的构建涉及求解同调方程，这些方程平均掉了方法的误差。这种平均化过程，通常使用正则变换（例如，Lie级数）执行，涉及到与未扰动系统频率相关的分母。\n在我们的弱耦合系统中，原始哈密顿量为 $H = H_{0} + V_{\\text{pert}}$，其中 $H_{0}$ 是两个非耦合谐振子的哈密顿量，而 $V_{\\text{pert}} = \\epsilon\\, q_{1}^{2} q_{2}^{2}$ 是微扰。在 $H_{0}$ 下的真实动力学涉及频率 $\\omega_{1}$ 和 $\\omega_{2}$。然而，数值映射每一步将每个模式的相位推进 $\\phi_{1} = \\phi(\\omega_{1}h)$ 和 $\\phi_{2} = \\phi(\\omega_{2}h)$。\n微扰项 $V_{\\text{pert}}$ 可以在未扰动振子的角变量中展开为傅里叶级数。项 $q_{1}^{2}q_{2}^{2}$ 包含形式为 $k_{1}\\theta_{1} \\pm k_{2}\\theta_{2}$ 的相位组合的振荡分量，其中 $k_{1}, k_{2}$ 是小整数。对于给定的四次势，前导项对应于 $k_{1}=2, k_{2}=2$。\n在构建修正哈密顿量 $H_{\\text{mod}}$ 时，微扰中的项被变换掉。这个变换级数包含的分母对应于这些振荡分量在积分器一步下的相位变化。当一个相位组合在映射下近似静止时，就会发生共振，这意味着其总相位推进接近 $2\\pi$ 的整数倍。对于相位为 $k_{1}\\theta_{1} \\pm k_{2}\\theta_{2}$ 的项，共振条件是 $k_{1}\\phi_{1} \\pm k_{2}\\phi_{2} \\approx 2m\\pi$。问题陈述使用了 $m\\pi$，这是由于具有特定对称性的势的正规形变换的特定结构而产生的。对于四次耦合 $q_1^2 q_2^2$，最低阶共振是 $2\\phi_1 \\pm 2\\phi_2 \\approx 2m\\pi$，可简化为 $\\phi_1 \\pm \\phi_2 \\approx m\\pi$。这与给定 $k_1=k_2=1$ 的条件相符。\n当 $k_{1}\\phi_{1} \\pm k_{2}\\phi_{2} \\approx m\\pi$ 时，$H_{\\text{mod}}$ 级数中的分母变得非常小。这导致 $h$ 的高阶项系数很大。修正哈密顿量 $H_{\\text{mod}}$ 在结构上变得与原始哈密顿量 $H$ 非常不同。虽然数值轨迹高精度地守恒 $H_{\\text{mod}}$，但原始能量 $H$ 并不守恒，并且可能在长时间内表现出大的、系统性的漂移。这是一种数值参数共振，其中能量在模式之间交换，由离散化驱动。即使当各个线性稳定性条件 $h\\omega_1  2$ 和 $h\\omega_2  2$ 得到满足时，这种情况也可能发生。\n\n第三，我们确定求解 $k_{1}=k_{2}=m=1$ 的最低阶共振条件 $\\phi_{1} + \\phi_{2} = \\pi$ 的最小正时间步长 $h$。我们有 $\\omega_{1} = 1\\,\\text{rad}\\,\\text{ps}^{-1}$ 和 $\\omega_{2} = \\sqrt{2}\\,\\text{rad}\\,\\text{ps}^{-1}$。该条件变为：\n$$\n\\arccos\\left(1 - \\frac{\\omega_{1}^{2}h^{2}}{2}\\right) + \\arccos\\left(1 - \\frac{\\omega_{2}^{2}h^{2}}{2}\\right) = \\pi\n$$\n设 $x = 1 - \\frac{\\omega_{1}^{2}h^{2}}{2}$ 和 $y = 1 - \\frac{\\omega_{2}^{2}h^{2}}{2}$。方程为 $\\arccos(x) + \\arccos(y) = \\pi$。对于 $x, y \\in [-1,1]$，该恒等式成立当且仅当 $x+y=0$。所以我们需要：\n$$\n\\left(1 - \\frac{\\omega_{1}^{2}h^{2}}{2}\\right) + \\left(1 - \\frac{\\omega_{2}^{2}h^{2}}{2}\\right) = 0\n$$\n$$\n2 - \\frac{h^{2}}{2}(\\omega_{1}^{2} + \\omega_{2}^{2}) = 0\n$$\n$$\nh^{2} = \\frac{4}{\\omega_{1}^{2} + \\omega_{2}^{2}}\n$$\n我们寻求最小的正时间步长，所以我们取正根：\n$$\nh = \\sqrt{\\frac{4}{\\omega_{1}^{2} + \\omega_{2}^{2}}} = \\frac{2}{\\sqrt{\\omega_{1}^{2} + \\omega_{2}^{2}}}\n$$\n代入给定的频率：\n$$\nh = \\frac{2}{\\sqrt{(1)^{2} + (\\sqrt{2})^{2}}} = \\frac{2}{\\sqrt{1+2}} = \\frac{2}{\\sqrt{3}}\\,\\text{ps}\n$$\n我们必须验证这个时间步长满足稳定性条件 $h\\omega_{\\max}  2$，其中 $\\omega_{\\max} = \\max\\{1, \\sqrt{2}\\} = \\sqrt{2}\\,\\text{rad}\\,\\text{ps}^{-1}$。\n$$\nh\\omega_{\\max} = \\frac{2}{\\sqrt{3}}\\sqrt{2} = \\frac{2\\sqrt{2}}{\\sqrt{3}} = 2\\sqrt{\\frac{2}{3}}\n$$\n由于 $\\frac{2}{3}  1$，我们有 $\\sqrt{\\frac{2}{3}}  1$，因此 $2\\sqrt{\\frac{2}{3}}  2$。稳定性条件得到满足。\n时间步长的数值为：\n$$\nh = \\frac{2}{\\sqrt{3}} \\approx 1.154700538... \\,\\text{ps}\n$$\n四舍五入到4位有效数字，我们得到 $h \\approx 1.155\\,\\text{ps}$。",
            "answer": "$$\n\\boxed{1.155}\n$$"
        }
    ]
}