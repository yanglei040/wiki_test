{
    "hands_on_practices": [
        {
            "introduction": "我们如何从微观粒子的运动规律推导出宏观的热力学定律？这个核心问题是统计力学的出发点。本练习  将引导你亲手实践这一过程，从微正则系综的基本假设（$S=k_B \\ln \\Omega$）出发，为理想气体推导其物态方程。这个推导不仅能加深你对熵、温度和压力统计定义的理解，更能让你体会到高维相空间几何在物理学中的强大威力。",
            "id": "3448854",
            "problem": "一个由$N$个质量为$m$的全同粒子组成的经典单原子理想气体，被限制在体积为$V$、具有周期性边界条件的容器中。该系统是孤立的，总能量固定为$E$，并通过微正则系综进行描述。哈密顿量为 $H(\\{\\mathbf{p}_i\\},\\{\\mathbf{r}_i\\}) = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^{2}}{2m}$，根据统计力学的基本假设，所有与能量$E$相符的微观状态都被认为是等概率的。\n\n将微正则熵定义为 $S(E,V,N) = k_{B} \\ln \\Omega(E,V,N)$，其中 $k_{B}$ 是玻尔兹曼常数，$\\Omega(E,V,N)$ 是能量壳下的经典相空间体积，\n$$\n\\Omega(E,V,N) = \\frac{1}{N! \\, h^{3N}} \\int_{H(\\mathbf{p},\\mathbf{r}) \\le E} d^{3N}\\mathbf{r}\\, d^{3N}\\mathbf{p},\n$$\n其中 $h$ 是普朗克常数。仅使用这些定义和关于高维球体积的基本事实，推导出 $S(E,V,N)$（可相差一个不依赖于 $E$ 和 $V$ 的加性常数），并根据下式计算压强\n$$\np \\;=\\; \\frac{\\left(\\frac{\\partial S}{\\partial V}\\right)_{E,N}}{\\left(\\frac{\\partial S}{\\partial E}\\right)_{V,N}}.\n$$\n将最终的 $p$ 表示为关于 $E$、$V$ 和 $N$ 的单个闭合形式解析表达式。然后，使用温度的微正则定义 $1/T = \\left(\\frac{\\partial S}{\\partial E}\\right)_{V,N}$，解释为什么在热力学极限 $N \\to \\infty$ 下，该结果与 $p = \\frac{N k_{B} T}{V}$ 一致。不需要进行数值计算；仅提供 $p$ 的解析表达式。不要假设任何无法从给定设置和标准几何事实中推导出的结果。所有步骤都必须从第一性原理和核心定义出发进行论证。最终答案必须是单个解析表达式。",
            "solution": "问题经过验证。\n\n### 第一步：提取已知条件\n- 系统：一个由$N$个全同粒子组成的经典单原子理想气体。\n- 粒子质量：$m$。\n- 容器：体积为$V$，具有周期性边界条件。\n- 系综：微正则系综，孤立系统，总能量固定为$E$。\n- 哈密顿量：$H(\\{\\mathbf{p}_i\\},\\{\\mathbf{r}_i\\}) = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^{2}}{2m}$。\n- 基本假设：所有可及的微观状态都是等概率的。\n- 微正则熵：$S(E,V,N) = k_{B} \\ln \\Omega(E,V,N)$，其中 $k_{B}$ 是玻尔兹曼常数。\n- 相空间体积：$\\Omega(E,V,N) = \\frac{1}{N! \\, h^{3N}} \\int_{H(\\mathbf{p},\\mathbf{r}) \\le E} d^{3N}\\mathbf{r}\\, d^{3N}\\mathbf{p}$，其中 $h$ 是普朗克常数。\n- 压强定义：$p = \\frac{(\\partial S/\\partial V)_{E,N}}{(\\partial S/\\partial E)_{V,N}}$。\n- 温度定义：$1/T = (\\partial S/\\partial E)_{V,N}$。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据：** 该问题是经典统计力学中一个标准的、基础的练习。所有定义和物理原理（理想气体的哈密顿量、微正则系综、熵和压强的定义）都是正确且公认的。\n- **适定性：** 问题是适定的。它提供了一套清晰的定义和一组具体的任务，可以导出一个唯一的、可推导的结果。使用累积相空间体积 $\\int_{H \\le E}$ 是一种标准约定，在热力学极限下，由于体积随能量的快速增长，这种方法与使用无限薄能量壳层的体积所得到的热力学性质是相同的。\n- **客观性：** 问题以精确、客观、形式化的科学语言陈述。\n- **不完整性/矛盾：** 问题是自洽的，没有矛盾。它提供了进行推导所需的所有必要信息。\n- **不切实际/不可行：** 该系统模型是一个理论上的理想化（理想气体），这是热力学和统计力学的基石。在此背景下，它并非物理上不切实际。\n- **其他缺陷：** 该问题并非微不足道，需要对统计力学和高维微积分有扎实的理解。它不是伪深刻、同义反复或无法验证的。\n\n### 第三步：结论与行动\n问题有效。将提供一个完整的、有理据的解答。\n\n### 推导过程\n\n分析从微正则相空间体积 $\\Omega(E,V,N)$ 的定义开始。\n$$\n\\Omega(E,V,N) = \\frac{1}{N! \\, h^{3N}} \\int_{H(\\mathbf{p},\\mathbf{r}) \\le E} d^{3N}\\mathbf{r}\\, d^{3N}\\mathbf{p}\n$$\n哈密顿量 $H = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2m}$ 仅是动量 $\\{\\mathbf{p}_i\\}$ 的函数，不依赖于位置 $\\{\\mathbf{r}_i\\}$。这使得对 $6N$ 维相空间的积分可以分离为一个对 $3N$ 维位置坐标的积分和一个对 $3N$ 维动量坐标的积分。\n$$\n\\Omega(E,V,N) = \\frac{1}{N! \\, h^{3N}} \\left( \\int d^{3N}\\mathbf{r} \\right) \\left( \\int_{\\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2m} \\le E} d^{3N}\\mathbf{p} \\right)\n$$\n位置积分是对每个粒子在体积 $V$ 内进行的。由于粒子之间无相互作用，且每个粒子都被限制在体积 $V$ 内，该积分为：\n$$\n\\int d^{3N}\\mathbf{r} = \\prod_{i=1}^{N} \\int_V d^3\\mathbf{r}_i = V^N\n$$\n动量积分是在由能量约束定义的 $3N$ 维动量空间区域上进行的：\n$$\n\\sum_{i=1}^{N} |\\mathbf{p}_i|^2 \\le 2mE\n$$\n这个不等式描述了一个 $3N$ 维超球体的内部。设动量的分量由单个索引 $j = 1, \\dots, 3N$ 标记。那么条件是 $\\sum_{j=1}^{3N} (p_j)^2 \\le (\\sqrt{2mE})^2$。因此，动量积分就是半径为 $R_p = \\sqrt{2mE}$ 的一个 $3N$ 维超球体的体积。\n\n一个半径为 $R$ 的 $n$ 维超球体的体积由以下公式给出：\n$$\nV_n(R) = \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2} + 1)} R^n\n$$\n在我们的情况中，维度是 $n = 3N$，半径是 $R_p = \\sqrt{2mE}$。可及的动量空间体积为：\n$$\n\\int d^{3N}\\mathbf{p} = V_{3N}(R_p) = \\frac{\\pi^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} (2mE)^{3N/2}\n$$\n将位置和动量积分的结果代回到 $\\Omega(E,V,N)$ 的表达式中：\n$$\n\\Omega(E,V,N) = \\frac{1}{N! \\, h^{3N}} V^N \\frac{\\pi^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} (2mE)^{3N/2}\n$$\n现在，我们计算微正则熵 $S(E,V,N) = k_B \\ln \\Omega(E,V,N)$：\n$$\nS(E,V,N) = k_B \\ln \\left[ \\frac{V^N}{N! \\, h^{3N}} \\frac{(2\\pi m E)^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} \\right]\n$$\n利用对数的性质，我们展开这个表达式：\n$$\nS(E,V,N) = k_B \\left[ N \\ln V + \\frac{3N}{2} \\ln E + \\ln \\left( \\frac{(2\\pi m)^{3N/2}}{N! \\, h^{3N} \\Gamma(\\frac{3N}{2} + 1)} \\right) \\right]\n$$\n问题要求熵的表达式可以相差一个不依赖于 $E$ 和 $V$ 的加性常数。最后的对数项仅依赖于 $N$ 和常数，因此我们可以写成：\n$$\nS(E,V,N) = N k_B \\ln V + \\frac{3N}{2} k_B \\ln E + C(N)\n$$\n其中 $C(N)$ 是一个仅与 $N$ 有关的函数。\n\n接下来，我们计算压强计算所需的 $S$ 的偏导数。\n$$\n\\left(\\frac{\\partial S}{\\partial V}\\right)_{E,N} = \\frac{\\partial}{\\partial V} \\left( N k_B \\ln V + \\frac{3N}{2} k_B \\ln E + C(N) \\right) = \\frac{N k_B}{V}\n$$\n$$\n\\left(\\frac{\\partial S}{\\partial E}\\right)_{V,N} = \\frac{\\partial}{\\partial E} \\left( N k_B \\ln V + \\frac{3N}{2} k_B \\ln E + C(N) \\right) = \\frac{3N k_B}{2E}\n$$\n现在我们使用给定的压强 $p$ 的公式：\n$$\np = \\frac{\\left(\\frac{\\partial S}{\\partial V}\\right)_{E,N}}{\\left(\\frac{\\partial S}{\\partial E}\\right)_{V,N}} = \\frac{\\frac{N k_B}{V}}{\\frac{3N k_B}{2E}}\n$$\n简化这个表达式，我们得到压强：\n$$\np = \\frac{N k_B}{V} \\cdot \\frac{2E}{3N k_B} = \\frac{2E}{3V}\n$$\n这就是微正则系综中经典单原子理想气体的压强。\n\n最后，我们需要解释为什么在热力学极限下，这个结果与理想气体定律 $p = \\frac{N k_B T}{V}$ 是一致的。温度 $T$ 的微正则定义由下式给出：\n$$\n\\frac{1}{T} = \\left(\\frac{\\partial S}{\\partial E}\\right)_{V,N}\n$$\n我们已经计算过这个导数：\n$$\n\\frac{1}{T} = \\frac{3N k_B}{2E}\n$$\n这个关系可以反过来，用来表示总能量 $E$ 与温度 $T$ 的关系：\n$$\nE = \\frac{3}{2} N k_B T\n$$\n这是著名的单原子理想气体的热状态方程，它断言每个粒子的平均能量为 $E/N = \\frac{3}{2} k_B T$，与能量均分定理一致。\n\n现在，我们将这个 $E$ 的表达式代入我们推导出的压强方程 $p = \\frac{2E}{3V}$ 中：\n$$\np = \\frac{2}{3V} \\left( \\frac{3}{2} N k_B T \\right) = \\frac{N k_B T}{V}\n$$\n这正是理想气体定律。因此，推导过程是完全一致的。热力学极限（$N \\to \\infty$，$V \\to \\infty$ 且 $N/V$ 保持不变）的概念确保了像温度和压强这样的热力学量是良定义的，并且不同的统计系综（微正则、正则等）对宏观可观测量会得出等价的结果。从微正则表述成功地恢复理想气体定律，证实了这种等价性。",
            "answer": "$$\n\\boxed{\\frac{2E}{3V}}\n$$"
        },
        {
            "introduction": "在许多分子动力学模拟中，系统与一个恒温热浴相耦合，这对应于正则系综 ($NVT$)。本练习  揭示了正则系综中一个深刻的原理：系统的宏观响应函数（如热容）与微观量的涨落之间存在精确的关系。你将首先推导连接能量涨落与定容热容 $C_V$ 的著名公式，然后利用模拟数据亲自计算热容，这是一个将理论与计算实践相结合的核心技能。",
            "id": "3448850",
            "problem": "一个哈密顿量为 $H(\\boldsymbol{p},\\boldsymbol{q})$ 的经典系统与一个温度为 $T$ 的大热浴弱耦合，因此该系统可以用正则系综来描述。从正则假设、正则配分函数 $Z(\\beta)$（其中 $\\beta = 1/(k_B T)$）以及系综平均和响应函数的定义出发，推导连接总能量的平衡方差 $\\langle (\\Delta E)^2 \\rangle$ 与系统定容热容 $C_V$ 的精确关系。您的推导必须从 $Z(\\beta)$ 和正则概率的基本定义开始，并通过逻辑步骤进行，不假设任何涨落公式。\n\n然后，考虑一个包含 $N=1000$ 个相同粒子的单原子流体在固定体积下进行的平衡态恒温分子动力学（MD）模拟。已知该MD恒温器能产生正确的正则分布，并且在采样时间尺度上动力学是各态历经的。在移除初始瞬态并使用统计独立的块平均来解释时间相关性后，得到总能量时间序列方差的无偏估计为 $\\mathrm{Var}(E)=2.402\\times 10^{-38}$，单位为 $\\mathrm{J}^2$，温度为 $T=300\\,\\mathrm{K}$。仅使用这些数据和基本常数，计算无量纲单位粒子热容\n$$\nc_V \\equiv \\frac{C_V}{N k_B}.\n$$\n将您的答案四舍五入到四位有效数字。将最终结果表示为纯数（无量纲）。\n\n最后，用文字论证为什么 $NVT$ 模拟中总能量的时间平均涨落为 $C_V$ 提供了一个一致的估计量，并陈述在MD中为了获得无偏且统计有效的估计必须解决的至少两个实际考虑因素。",
            "solution": "该问题分为三个部分：一个推导、一个计算和一个概念论证。我们依次解决。\n\n首先，我们推导总能量的平衡方差 $\\langle (\\Delta E)^2 \\rangle$ 与定容热容 $C_V$ 之间的精确关系。推导从正则系综的基本假设开始。\n\n对于哈密顿量为 $H(\\boldsymbol{p}, \\boldsymbol{q})$ 的经典系统，其正则配分函数由下式给出：\n$$\nZ(\\beta) = C \\int \\exp(-\\beta H(\\boldsymbol{p}, \\boldsymbol{q})) d\\boldsymbol{p} d\\boldsymbol{q}\n$$\n其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，积分遍及整个相空间。前置因子 $C$（包含诸如 $1/h^{3N}$ 和 $1/N!$ 的因子）是一个相对于温度和相空间坐标的常数，因此它不会影响我们接下来要进行的热力学求导。系统处于坐标为 $(\\boldsymbol{p}, \\boldsymbol{q})$ 的微观状态的概率密度为\n$$\n\\rho(\\boldsymbol{p}, \\boldsymbol{q}) = \\frac{\\exp(-\\beta H(\\boldsymbol{p}, \\boldsymbol{q}))}{Z(\\beta)/C}\n$$\n任何可观测量 $A(\\boldsymbol{p}, \\boldsymbol{q})$ 的系综平均由下式给出\n$$\n\\langle A \\rangle = \\int A(\\boldsymbol{p}, \\boldsymbol{q}) \\rho(\\boldsymbol{p}, \\boldsymbol{q}) d\\boldsymbol{p} d\\boldsymbol{q} = \\frac{\\int A \\exp(-\\beta H) d\\boldsymbol{p} d\\boldsymbol{q}}{\\int \\exp(-\\beta H) d\\boldsymbol{p} d\\boldsymbol{q}}\n$$\n我们将系统的平均总能量 $\\langle E \\rangle$ 等同于哈密顿量的系综平均 $\\langle H \\rangle$：\n$$\n\\langle E \\rangle = \\frac{\\int H \\exp(-\\beta H) d\\boldsymbol{p} d\\boldsymbol{q}}{\\int \\exp(-\\beta H) d\\boldsymbol{p} d\\boldsymbol{q}}\n$$\n我们可以将 $\\langle E \\rangle$ 表示为配分函数 $Z(\\beta)$ 的导数。考虑 $Z(\\beta)$ 对 $\\beta$ 的导数：\n$$\n\\frac{\\partial Z(\\beta)}{\\partial \\beta} = C \\int (-H) \\exp(-\\beta H) d\\boldsymbol{p} d\\boldsymbol{q}\n$$\n除以 $Z(\\beta)$ 得到：\n$$\n\\frac{1}{Z(\\beta)}\\frac{\\partial Z(\\beta)}{\\partial \\beta} = \\frac{\\partial \\ln Z(\\beta)}{\\partial \\beta} = \\frac{\\int (-H) \\exp(-\\beta H) d\\boldsymbol{p} d\\boldsymbol{q}}{\\int \\exp(-\\beta H) d\\boldsymbol{p} d\\boldsymbol{q}} = -\\langle H \\rangle = -\\langle E \\rangle\n$$\n因此，平均能量为 $\\langle E \\rangle = -\\frac{\\partial \\ln Z(\\beta)}{\\partial \\beta}$。\n\n定容热容 $C_V$ 定义为平均能量在恒定体积下对温度的偏导数：\n$$\nC_V = \\left(\\frac{\\partial \\langle E \\rangle}{\\partial T}\\right)_V\n$$\n使用链式法则将变量从 $T$ 转换为 $\\beta$：\n$$\n\\frac{\\partial}{\\partial T} = \\frac{d\\beta}{dT} \\frac{\\partial}{\\partial \\beta} = \\left(-\\frac{1}{k_B T^2}\\right) \\frac{\\partial}{\\partial \\beta}\n$$\n因此，热容变为：\n$$\nC_V = \\left(-\\frac{1}{k_B T^2}\\right) \\frac{\\partial \\langle E \\rangle}{\\partial \\beta}\n$$\n现在我们必须计算 $\\langle E \\rangle$ 对 $\\beta$ 的导数：\n$$\n\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left(-\\frac{\\partial \\ln Z(\\beta)}{\\partial \\beta}\\right) = -\\frac{\\partial^2 \\ln Z(\\beta)}{\\partial \\beta^2}\n$$\n或者，更基本地，我们可以直接使用商法则对 $\\langle E \\rangle$ 的表达式求导：\n$$\n\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left( \\frac{\\int H \\exp(-\\beta H) d\\Gamma}{\\int \\exp(-\\beta H) d\\Gamma} \\right) \\quad (\\text{其中 } d\\Gamma = d\\boldsymbol{p}d\\boldsymbol{q})\n$$\n$$\n\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = \\frac{\\left( \\int (-H^2) \\exp(-\\beta H) d\\Gamma \\right) \\left( \\int \\exp(-\\beta H) d\\Gamma \\right) - \\left( \\int H \\exp(-\\beta H) d\\Gamma \\right) \\left( \\int (-H) \\exp(-\\beta H) d\\Gamma \\right)}{\\left( \\int \\exp(-\\beta H) d\\Gamma \\right)^2}\n$$\n将分子和分母同除以 $(Z/C)^2 = (\\int \\exp(-\\beta H) d\\Gamma)^2$：\n$$\n\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = -\\frac{\\int H^2 \\exp(-\\beta H) d\\Gamma}{\\int \\exp(-\\beta H) d\\Gamma} + \\left( \\frac{\\int H \\exp(-\\beta H) d\\Gamma}{\\int \\exp(-\\beta H) d\\Gamma} \\right)^2\n$$\n将这些项识别为系综平均，我们有：\n$$\n\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = -\\langle H^2 \\rangle + \\langle H \\rangle^2 = -\\langle E^2 \\rangle + \\langle E \\rangle^2 = -(\\langle E^2 \\rangle - \\langle E \\rangle^2)\n$$\n项 $\\langle E^2 \\rangle - \\langle E \\rangle^2$ 是能量方差的定义，即 $\\langle (\\Delta E)^2 \\rangle$。所以，我们发现\n$$\n\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = -\\langle (\\Delta E)^2 \\rangle\n$$\n最后，将此结果代入 $C_V$ 的表达式中：\n$$\nC_V = \\left(-\\frac{1}{k_B T^2}\\right) (-\\langle (\\Delta E)^2 \\rangle) = \\frac{\\langle (\\Delta E)^2 \\rangle}{k_B T^2}\n$$\n这就得到了所求的关系式：\n$$\n\\langle (\\Delta E)^2 \\rangle = k_B T^2 C_V\n$$\n\n第二，我们使用分子动力学（MD）模拟的数据计算无量纲单位粒子热容 $c_V$。问题提供：\n粒子数，$N = 1000$。\n温度，$T = 300\\,\\mathrm{K}$。\n总能量的方差，$\\mathrm{Var}(E) = 2.402 \\times 10^{-38}\\,\\mathrm{J}^2$。\nMD模拟产生正则分布，因此根据各态历经假说，时间平均方差是系综平均方差的有效估计量，即 $\\langle (\\Delta E)^2 \\rangle = \\mathrm{Var}(E)$。\n我们使用玻尔兹曼常数的值，$k_B \\approx 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n\n我们需要计算 $c_V \\equiv \\frac{C_V}{N k_B}$。我们首先使用推导出的公式，用给定物理量来表示 $c_V$：\n$$\nC_V = \\frac{\\langle (\\Delta E)^2 \\rangle}{k_B T^2}\n$$\n$$\nc_V = \\frac{C_V}{N k_B} = \\frac{1}{N k_B} \\left( \\frac{\\langle (\\Delta E)^2 \\rangle}{k_B T^2} \\right) = \\frac{\\langle (\\Delta E)^2 \\rangle}{N (k_B T)^2}\n$$\n现在，我们代入数值：\n$$\nk_B T = (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (300\\,\\mathrm{K}) = 4.141947 \\times 10^{-21}\\,\\mathrm{J}\n$$\n$$\n(k_B T)^2 = (4.141947 \\times 10^{-21}\\,\\mathrm{J})^2 \\approx 1.715570 \\times 10^{-41}\\,\\mathrm{J}^2\n$$\n$$\nN (k_B T)^2 = 1000 \\times (1.715570 \\times 10^{-41}\\,\\mathrm{J}^2) = 1.715570 \\times 10^{-38}\\,\\mathrm{J}^2\n$$\n最后，我们计算 $c_V$：\n$$\nc_V = \\frac{2.402 \\times 10^{-38}\\,\\mathrm{J}^2}{1.715570 \\times 10^{-38}\\,\\mathrm{J}^2} = \\frac{2.402}{1.715570} \\approx 1.400133\n$$\n四舍五入到四位有效数字，结果是 $1.400$。\n\n第三，我们论证为什么 $NVT$ 模拟中总能量的时间平均涨落为 $C_V$ 提供了一个一致的估计量，并陈述两个实际的考虑因素。\n连接模拟时间平均和热力学系综平均的基本原理是**各态历经假说**。该假说指出，对于一个处于平衡态的各态历经系统，一个可观测量沿单一、足够长的轨迹的时间平均等于该可观测量在相应统计系综中的系综平均。问题指明MD恒温器能产生正确的正则（$NVT$）分布，且动力学是各态历经的。因此，随着模拟时间的增长，从时间序列计算出的总能量方差 $\\mathrm{Var}(E)$ 会收敛于正则系综方差 $\\langle (\\Delta E)^2 \\rangle$。由于我们已经证明了 $\\langle (\\Delta E)^2 \\rangle$ 与 $C_V$ 成正比，所以来自模拟的时间序列方差是热容的有效估计量。\n\n为了从实际的MD模拟中获得无偏且统计有效的估计，必须解决几个因素。两个关键的考虑因素是：\n\n1.  **平衡化**（Equilibration）：任何MD模拟都从一个初始构型开始，该构型通常不是平衡系综的代表性状态。系统需要一段时间的模拟时间，称为平衡阶段，以从这个初始状态弛豫到目标热力学平衡。在此初始瞬态阶段收集的数据不属于平衡分布，如果包含在性质计算中会引入系统误差（偏差）。因此，必须丢弃轨迹的初始部分，只有在系统达到宏观性质（如能量和压力）不再显示系统性漂移的稳态后，才开始为求平均而收集数据。\n\n2.  **时间关联和统计不确定性**（Time Correlations and Statistical Uncertainty）：MD时间序列中的数据点（例如能量值）不是统计独立的；对于小的时间步长 $\\Delta t$，时刻 $t$ 的构型与时刻 $t + \\Delta t$ 的构型是强相关的。如果从相关数据中草率地计算统计性质（如方差）及其误差，会导致对真实统计不确定性的低估，并可能导致效率低下或有偏的估计。为了解决这个问题，必须使用方法来解释这些关联。问题中提到的**分块平均法**（block averaging method）是一种标准技术。将完整的数据序列分成若干个块，每个块的长度都长于可观测量的特征关联时间。对每个块计算可观测量的平均值。这些块平均值之间的相关性远低于原始数据点之间的相关性。性质的最终估计是这些块平均值的平均值，而统计误差则由块平均值的标准差计算得出。这个过程为性质及其统计不确定性提供了更稳健和可靠的估计。",
            "answer": "$$\n\\boxed{1.400}\n$$"
        },
        {
            "introduction": "热力学的宏伟大厦建立在各个热力学势和状态变量之间严谨的数学关系之上，其中麦克斯韦关系是其一致性的基石。我们如何验证一个理论模型或模拟数据是否忠实地遵循了这些基本的热力学定律？本练习  提供了一个绝佳的实践机会。你将通过热力学积分计算亥姆霍兹自由能，并使用数值微分方法来检验一个关键的麦克斯韦关系，这个过程完美融合了理论推导、解析计算和数值验证，是计算物理学中的一项高级综合技能。",
            "id": "3448856",
            "problem": "考虑一个由$N$个相同粒子组成的经典流体，该流体处于平衡状态，其宏观状态由温度$T$、体积$V$和粒子数$N$描述。令亥姆霍兹自由能为 $F(T,V,N)$，并通过亥姆霍兹自由能的基本微分形式定义熵 $S(T,V,N)$、压力 $p(T,V,N)$ 和化学势 $\\mu(T,V,N)$。使用平衡态的统计力学假设和热力学势的广延性从第一性原理进行推导。\n\n假设我们有一个基于范德华型状态方程的简单、物理上合理的模型流体的分子动力学 (MD) 模拟数据。该 MD 模拟器提供以下函数：\n- 压力 $p(T,V,N)$ 由 $p(T,V,N) = \\frac{N k_\\mathrm{B} T}{V - N b} - a \\frac{N^2}{V^2}$ 给出。\n- 内能 $U(T,V,N)$ 由 $U(T,V,N) = c_V N k_\\mathrm{B} T - a \\frac{N^2}{V}$ 给出。\n\n此处，$k_\\mathrm{B}$ 是玻尔兹曼常数，$b$ 是每个粒子的排除体积，$a$ 量化了平均场吸引力，$c_V$ 是单原子流体中每个粒子的定容热容。这些是经过充分检验的物理形式，与统计力学和热力学一致。所有量均采用国际单位制 (SI)：$T$ 的单位是 $\\mathrm{K}$，$V$ 的单位是 $\\mathrm{m}^3$，$p$ 的单位是 $\\mathrm{Pa}$，$U$ 的单位是 $\\mathrm{J}$，$k_\\mathrm{B}$ 的单位是 $\\mathrm{J}/\\mathrm{K}$。\n\n你的任务是：\n- 从 $F(T,V,N)$ 的基本微分形式和混合偏导数的相等性出发，推导出连接 $F(T,V,N)$ 的熵和压力的相关麦克斯韦关系。\n- 在固定 $T$ 的条件下，通过对 $V$ 进行热力学积分，计算自由能 $F(T,V,N)$（可相差一个仅与 $T$ 有关的加性函数，该函数与 $V$ 无关）。积分从一个共同的固定参考体积 $V_\\mathrm{ref}$ 开始，该参考体积应足够大以避免排除体积奇点。\n- 使用计算出的 $F(T,V,N)$，通过在 $T$ 方向上使用小的对称温度增量 $\\Delta T$ 的中心有限差分法，数值计算 $S(T,V,N) = -\\left(\\dfrac{\\partial F}{\\partial T}\\right)_{V,N}$。然后，通过在 $V$ 方向上使用小的对称体积增量 $\\Delta V$ 的中心有限差分法，计算 $\\left(\\dfrac{\\partial S}{\\partial V}\\right)_{T,N}$。\n- 独立地，通过在 $T$ 方向上的中心有限差分法，计算 $\\left(\\dfrac{\\partial p}{\\partial T}\\right)_{V,N}$。\n- 通过在指定容差范围内检查 $\\left(\\dfrac{\\partial S}{\\partial V}\\right)_{T,N}$ 和 $\\left(\\dfrac{\\partial p}{\\partial T}\\right)_{V,N}$ 的数值相等性来验证麦克斯韦关系。\n\n使用以下常数和参数：\n- $k_\\mathrm{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$，\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$ （仅在需要定义参考理想气体自由能时使用；此处不需要），\n- 粒子质量 $m = 6.6335209 \\times 10^{-26}\\,\\mathrm{kg}$ （类氩），\n- $a = 1.0 \\times 10^{-48}\\,\\mathrm{Pa\\,m}^6$，\n- $b = 2.0 \\times 10^{-29}\\,\\mathrm{m}^3$，\n- $c_V = 3/2$。\n\n热力学积分要求：\n- 对于固定的 $T$ 和 $N$，通过积分 $F(T,V,N) = A(T,N) - \\int_{V_\\mathrm{ref}}^{V} p(T,V',N) \\,\\mathrm{d}V'$ 计算 $F(T,V,N)$（可相差一个与 $V$ 无关、仅与 $T$ 有关的加性函数）。其中 $A(T,N)$ 不依赖于 $V$，$V_\\mathrm{ref}$ 是一个固定的参考体积 $V$，对所有测试用例通用，且对所有情况满足 $V_\\mathrm{ref}  N b$。在每个测试用例中，您必须保持 $N$ 恒定。\n- 使用增量为 $\\Delta T$ 和 $\\Delta V$ 的中心有限差分法计算所需的导数。选择 $\\Delta T = 1\\,\\mathrm{K}$ 和 $\\Delta V = 0.01\\,V$。\n\n数值验证：\n- 如果 $\\left(\\dfrac{\\partial S}{\\partial V}\\right)_{T,N}$ 和 $\\left(\\dfrac{\\partial p}{\\partial T}\\right)_{V,N}$ 之间的绝对差小于或等于 $\\varepsilon \\times \\max\\{1, |\\left(\\dfrac{\\partial S}{\\partial V}\\right)_{T,N}|, |\\left(\\dfrac{\\partial p}{\\partial T}\\right)_{V,N}|\\}$（其中 $\\varepsilon = 10^{-8}$），则宣布该测试用例满足麦克斯韦关系。\n\n测试套件：\n- 用例 1：$(N,T,V) = (1000, 300\\,\\mathrm{K}, 10^{-24}\\,\\mathrm{m}^3)$。\n- 用例 2：$(N,T,V) = (2000, 700\\,\\mathrm{K}, 2\\times 10^{-24}\\,\\mathrm{m}^3)$。\n- 用例 3：$(N,T,V) = (500, 100\\,\\mathrm{K}, 1.5\\times 10^{-24}\\,\\mathrm{m}^3)$。\n- 用例 4（接近排除体积边界但可接受）：$(N,T,V) = (800, 400\\,\\mathrm{K}, 1.2\\,N\\,b)$。\n\n角度单位不适用。不涉及百分比。所有物理量必须按规定使用国际单位制 (SI) 处理。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如 $[result_1,result_2,\\dots]$），其中每个 $result_i$ 是一个布尔值，表示相应测试用例是否通过了麦克斯韦关系的验证。",
            "solution": "在尝试给出解答之前，需对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **系统**：一个由 $N$ 个相同粒子组成的处于平衡态的经典流体。\n- **状态变量**：温度 $T$、体积 $V$、粒子数 $N$。\n- **热力学势**：亥姆霍兹自由能 $F(T,V,N)$、熵 $S(T,V,N)$、压力 $p(T,V,N)$、内能 $U(T,V,N)$。\n- **基本关系**：隐含了亥姆霍兹自由能的微分形式 $dF = -SdT - pdV + \\mu dN$，由此确定 $S = -(\\partial F/\\partial T)_{V,N}$ 和 $p = -(\\partial F/\\partial V)_{T,N}$。\n- **模拟模型函数**：\n    - 压力：$p(T,V,N) = \\frac{N k_\\mathrm{B} T}{V - N b} - a \\frac{N^2}{V^2}$。\n    - 内能：$U(T,V,N) = c_V N k_\\mathrm{B} T - a \\frac{N^2}{V}$。\n- **常数和参数**：\n    - $k_\\mathrm{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n    - $a = 1.0 \\times 10^{-48}\\,\\mathrm{Pa\\,m}^6$。\n    - $b = 2.0 \\times 10^{-29}\\,\\mathrm{m}^3$。\n    - $c_V = 3/2$。\n- **任务**：\n    1. 推导麦克斯韦关系：$\\left(\\dfrac{\\partial S}{\\partial V}\\right)_{T,N} = \\left(\\dfrac{\\partial p}{\\partial T}\\right)_{V,N}$。\n    2. 通过热力学积分计算 $F(T,V,N)$（可相差一个仅与 $T$ 有关的加性函数）：$F(T,V,N) = A(T,N) - \\int_{V_\\mathrm{ref}}^{V} p(T,V',N) \\,\\mathrm{d}V'$。\n    3. 使用中心有限差分法对 $F$ 进行数值计算得到 $S(T,V,N)$。\n    4. 使用中心有限差分法对 $S$ 进行数值计算得到 $\\left(\\dfrac{\\partial S}{\\partial V}\\right)_{T,N}$。\n    5. 使用中心有限差分法对 $p$ 进行数值计算得到 $\\left(\\dfrac{\\partial p}{\\partial T}\\right)_{V,N}$。\n    6. 验证两个导数的数值相等性。\n- **数值参数**：\n    - 有限差分增量：$\\Delta T = 1\\,\\mathrm{K}$，$\\Delta V = 0.01\\,V$。\n    - 参考体积 $V_\\mathrm{ref}$ 应选择为一个大的通用值。\n    - 验证容差：绝对差必须 $\\le \\varepsilon \\times \\max\\{1, |\\text{val}_1|, |\\text{val}_2|\\}$，其中 $\\varepsilon = 10^{-8}$。\n- **测试用例**：\n    - 用例 1：$(N,T,V) = (1000, 300\\,\\mathrm{K}, 10^{-24}\\,\\mathrm{m}^3)$。\n    - 用例 2：$(N,T,V) = (2000, 700\\,\\mathrm{K}, 2\\times 10^{-24}\\,\\mathrm{m}^3)$。\n    - 用例 3：$(N,T,V) = (500, 100\\,\\mathrm{K}, 1.5\\times 10^{-24}\\,\\mathrm{m}^3)$。\n    - 用例 4：$(N,T,V) = (800, 400\\,\\mathrm{K}, 1.2\\,N\\,b)$。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学性或事实性不健全**：该问题基于热力学的基石——范德华模型。所提供的压力 $p(T,V,N)$ 和内能 $U(T,V,N)$ 的形式在热力学上是一致的。我们可以通过热力学状态方程 $(\\partial U/\\partial V)_{T,N} = T(\\partial p/\\partial T)_{V,N} - p$ 来验证这一点。\n    - 从 $p(T,V,N)$，我们得到 $(\\partial p/\\partial T)_{V,N} = \\frac{N k_\\mathrm{B}}{V-Nb}$。\n    - 因此，$T(\\partial p/\\partial T)_{V,N} - p = T\\left(\\frac{N k_\\mathrm{B}}{V-Nb}\\right) - \\left(\\frac{N k_\\mathrm{B} T}{V-Nb} - a\\frac{N^2}{V^2}\\right) = a\\frac{N^2}{V^2}$。\n    - 从 $U(T,V,N)$，我们得到 $(\\partial U/\\partial V)_{T,N} = a\\frac{N^2}{V^2}$。\n    - 由于两条路径得到相同的结果，该模型是热力学自洽的。该问题在科学上是合理的。\n2.  **不完整或矛盾的设置**：问题定义明确。需要选择一个共同的参考体积 $V_\\mathrm{ref}$ 是此类计算的标准部分，而非缺陷。为指定任务提供了所有必要的数据和参数。约束条件没有矛盾。\n3.  **其他缺陷**：该问题是一个形式化、客观且可验证的数值练习。它没有表现出任何其他列出的缺陷（非形式化、不切实际、不适定、琐碎等）。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整的解答。\n\n### 解答\n任务是为一个类范德华流体数值验证一个麦克斯韦关系。解答涉及几个步骤：推导相关关系，通过积分计算热力学势，以及进行数值微分。\n\n**1. 麦克斯韦关系推导**\n\n亥姆霍兹自由能 $F$ 是状态变量 $T$、$V$ 和 $N$ 的函数。其全微分为：\n$$dF(T,V,N) = \\left(\\frac{\\partial F}{\\partial T}\\right)_{V,N} dT + \\left(\\frac{\\partial F}{\\partial V}\\right)_{T,N} dV + \\left(\\frac{\\partial F}{\\partial N}\\right)_{T,V} dN$$\n根据热力学的基本原理，这可以等同于：\n$$dF = -SdT - pdV + \\mu dN$$\n其中 $S$ 是熵，$p$ 是压力，$\\mu$ 是化学势。通过比较各项，我们确定偏导数为：\n$$S = -\\left(\\frac{\\partial F}{\\partial T}\\right)_{V,N} \\quad \\text{和} \\quad p = -\\left(\\frac{\\partial F}{\\partial V}\\right)_{T,N}$$\n对于一个具有连续二阶偏导数的状态函数，微分的顺序无关紧要（克莱罗-施瓦茨定理）。因此：\n$$\\frac{\\partial^2 F}{\\partial V \\partial T} = \\frac{\\partial^2 F}{\\partial T \\partial V}$$\n代入 $S$ 和 $p$ 的表达式：\n$$\\frac{\\partial}{\\partial V}\\left(\\frac{\\partial F}{\\partial T}\\right)_{V,N} = \\frac{\\partial}{\\partial V}(-S) = -\\left(\\frac{\\partial S}{\\partial V}\\right)_{T,N}$$\n$$\\frac{\\partial}{\\partial T}\\left(\\frac{\\partial F}{\\partial V}\\right)_{T,N} = \\frac{\\partial}{\\partial T}(-p) = -\\left(\\frac{\\partial p}{\\partial T}\\right)_{V,N}$$\n将这两个表达式相等得到 $-\\left(\\frac{\\partial S}{\\partial V}\\right)_{T,N} = -\\left(\\frac{\\partial p}{\\partial T}\\right)_{V,N}$，简化后即为所需的麦克斯韦关系：\n$$\\left(\\frac{\\partial S}{\\partial V}\\right)_{T,N} = \\left(\\frac{\\partial p}{\\partial T}\\right)_{V,N}$$\n\n**2. 数值验证策略**\n\n任务的核心是数值计算该方程的两边，并检查它们是否相等。\n\n**步骤 A：自由能计算**\n亥姆霍兹自由能 $F(T,V,N)$ 通过对压力积分得到：\n$$F(T,V,N) - F(T,V_\\mathrm{ref},N) = -\\int_{V_\\mathrm{ref}}^{V} p(T,V',N) \\,dV'$$\n问题说明我们可以忽略与体积无关的参考项 $F(T,V_\\mathrm{ref},N) = A(T,N)$。令 $\\Delta F(T,V,N) = F(T,V,N) - A(T,N)$。我们将使用这个自由能差。压力函数的积分可以解析地进行：\n$$\\int p(T,V',N) \\,dV' = \\int \\left( \\frac{N k_\\mathrm{B} T}{V'-Nb} - a \\frac{N^2}{(V')^2} \\right) dV' = N k_\\mathrm{B} T \\ln(V'-Nb) + a \\frac{N^2}{V'}$$\n计算定积分得到：\n$$\\Delta F(T,V,N) = -\\left[ \\left(N k_\\mathrm{B} T \\ln(V-Nb) + a \\frac{N^2}{V}\\right) - \\left(N k_\\mathrm{B} T \\ln(V_\\mathrm{ref}-Nb) + a \\frac{N^2}{V_\\mathrm{ref}}\\right) \\right]$$\n选择一个共同的大参考体积 $V_\\mathrm{ref} = 10^{-22}\\,\\mathrm{m}^3$，它满足 $V_\\mathrm{ref}  N b$ 并且显著大于所有测试用例中的体积。\n\n**步骤 B：计算 $\\left(\\frac{\\partial S}{\\partial V}\\right)_{T,N}$**\n这是一个两步的数值微分过程。\n首先，我们找到相对于参考状态的熵差，$\\Delta S(T,V,N) = S(T,V,N) - S(T,V_\\mathrm{ref},N)$。由于 $S = -(\\partial F/\\partial T)_{V,N}$，我们有 $\\Delta S = -(\\partial (\\Delta F)/\\partial T)_{V,N}$。该导数使用步长为 $\\Delta T$ 的中心有限差分法计算：\n$$\\Delta S(T,V,N) \\approx -\\frac{\\Delta F(T+\\Delta T, V, N) - \\Delta F(T-\\Delta T, V, N)}{2\\Delta T}$$\n接下来，我们计算熵对体积的导数。由于 $S(T,V_\\mathrm{ref},N)$ 与 $V$ 无关，所以 $(\\partial S/\\partial V)_{T,N} = (\\partial (\\Delta S)/\\partial V)_{T,N}$。这使用步长为 $\\Delta V$ 的中心有限差分法计算：\n$$\\left(\\frac{\\partial S}{\\partial V}\\right)_{T,N} \\approx \\frac{\\Delta S(T, V+\\Delta V, N) - \\Delta S(T, V-\\Delta V, N)}{2\\Delta V}$$\n\n**步骤 C：计算 $\\left(\\frac{\\partial p}{\\partial T}\\right)_{V,N}$**\n该导数直接从给定的压力函数使用步长为 $\\Delta T$ 的中心有限差分法计算：\n$$\\left(\\frac{\\partial p}{\\partial T}\\right)_{V,N} \\approx \\frac{p(T+\\Delta T, V, N) - p(T-\\Delta T, V, N)}{2\\Delta T}$$\n\n**步骤 D：验证**\n对于每个测试用例，使用指定的容差标准比较 $\\left(\\frac{\\partial S}{\\partial V}\\right)_{T,N}$ 和 $\\left(\\frac{\\partial p}{\\partial T}\\right)_{V,N}$ 的数值计算结果。如果满足以下条件，则认为麦克斯韦关系成立：\n$$ \\left| \\left(\\frac{\\partial S}{\\partial V}\\right)_{T,N} - \\left(\\frac{\\partial p}{\\partial T}\\right)_{V,N} \\right| \\le \\varepsilon \\times \\max\\left\\{1, \\left|\\left(\\frac{\\partial S}{\\partial V}\\right)_{T,N}\\right|, \\left|\\left(\\frac{\\partial p}{\\partial T}\\right)_{V,N}\\right|\\right\\} $$\n其中 $\\varepsilon = 10^{-8}$。将对给定的测试用例实施此程序。",
            "answer": "[true,true,true,true]"
        }
    ]
}