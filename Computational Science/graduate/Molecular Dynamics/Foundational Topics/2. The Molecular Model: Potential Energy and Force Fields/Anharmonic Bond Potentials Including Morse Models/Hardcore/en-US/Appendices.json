{
    "hands_on_practices": [
        {
            "introduction": "A potential function is only as good as its parameters. Before a Morse potential can be used in a simulation, its characteristic parameters—the dissociation energy $D_e$, the equilibrium distance $r_e$, and the potential width parameter $a$—must be determined from reliable data. This exercise guides you through the process of designing a robust protocol for fitting these parameters using data typically obtained from accurate quantum mechanical calculations . By strategically using information about the potential well's curvature at its minimum, its dissociation limit, and its value at a significantly stretched geometry, you will learn how to create a physically meaningful model that is accurate over a wide range of bond lengths.",
            "id": "3395888",
            "problem": "A diatomic bond in a Molecular Dynamics (MD) force field is to be represented by a Morse anharmonic potential, taken in the convention where the energy is zero at the minimum and the dissociation energy is the asymptotic limit, so that the potential energy function is $$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2,$$ with $$V(r_e)=0$$ and $$V(\\infty)=D_e.$$ You have three high-quality quantities from electronic-structure calculations: (i) the curvature at the minimum, defined as $$k_e=V''(r_e),$$ obtained by a normal-mode analysis around the equilibrium structure; (ii) one energy point labeled as a large stretch, namely $$E_s=V(r_s)$$ for a geometry $$r_sr_e$$ with substantial elongation; and (iii) the dissociation energy $$D_e,$$ defined as the energy difference between the minimum and the dissociation limit. Assume the electronic-structure energies are on the same absolute reference such that the minimum is consistently zeroed at $$r=r_e.$$ Which protocol below correctly uses these three inputs to determine $$\\left(D_e,a,r_e\\right)$$ uniquely and provides a sound justification of numerical robustness?\n\nA. Use the curvature to determine the range parameter by $$a=\\sqrt{\\dfrac{k_e}{2D_e}};$$ then recover the equilibrium distance by enforcing the stretched-point energy via $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)^2,$$ solved as $$r_e=r_s+\\dfrac{1}{a}\\ln\\!\\left(1-\\sqrt{\\dfrac{E_s}{D_e}}\\right),$$ choosing the monotonically attractive branch with $$0\\sqrt{E_s/D_e}1.$$ Keep $$D_e$$ equal to the supplied dissociation energy. Robustness justification: the curvature near the minimum constrains $$a$$ independently of $$r_e,$$ the far stretched point breaks the strong correlation between $$a$$ and $$r_e$$ that plagues purely near-equilibrium fits, and fixing the asymptote with $$D_e$$ enforces physical behavior; choosing $$E_s$$ not too close to either $$0$$ or $$D_e$$ avoids logarithmic ill-conditioning.\n\nB. Determine the range parameter from the curvature using the linear relation $$a=\\dfrac{k_e}{D_e};$$ then use the stretched-point energy by writing $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$ and solve for the equilibrium distance as $$r_e=r_s-\\dfrac{1}{a}\\ln\\!\\left(1-\\dfrac{E_s}{D_e}\\right).$$ Keep $$D_e$$ equal to the supplied dissociation energy. Robustness justification: using a linear mapping for $$a$$ avoids squaring errors and the single logarithm keeps sensitivity low.\n\nC. Fit $$a$$ and $$D_e$$ by nonlinear least squares to two stretched points $$\\left(r_{s1},E_{s1}\\right)$$ and $$\\left(r_{s2},E_{s2}\\right)$$ while fixing $$r_e$$ at the geometry that minimizes the computed energy. Use the curvature $$k_e$$ only as a posterior consistency check and adjust if necessary. Robustness justification: two far points anchor the asymptote and the tail shape, and the minimum geometry is available directly from the electronic-structure scan.\n\nD. Set $$D_e=E_s$$ and assume $$r_e=r_s$$ because the minimum defines the zero of energy at the computed geometry. Then estimate $$a$$ by finite-difference curvature around $$r_s$$ using $$k_e\\approx V''(r_s)$$ and enforcing $$a=\\sqrt{k_e/(2D_e)}.$$ Robustness justification: co-locating the minimum and the stretched point reduces parameter correlation and the dissociation energy equals the observed far-stretch energy by construction.",
            "solution": "The user has requested a critical validation of a problem statement regarding the parameterization of a Morse potential, followed by a full solution and evaluation of the provided options.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n\nThe problem statement provides the following explicit information:\n1.  **Potential Energy Function**: A Morse potential, $$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2$$.\n2.  **Energy Convention**: The potential is zero at the minimum, $$V(r_e)=0$$, and the dissociation energy is the asymptotic limit, $$V(\\infty)=D_e$$.\n3.  **Input Data from Electronic-Structure Calculations**:\n    (i) The curvature at the minimum, $$k_e=V''(r_e)$$.\n    (ii) An energy point at a large stretch, $$E_s=V(r_s)$$ for a geometry $$r_sr_e$$.\n    (iii) The dissociation energy, $$D_e$$.\n4.  **Energy Reference**: The energy minimum is consistently zero, $$V(r_e)=0$$.\n5.  **Objective**: To find a protocol that correctly uses the three inputs to uniquely determine the parameters $$\\left(D_e,a,r_e\\right)$$ and provides a sound justification for numerical robustness.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is assessed against the required criteria:\n-   **Scientifically Grounded**: The Morse potential is a standard and physically meaningful model for the potential energy of a diatomic molecule, widely used in spectroscopy and molecular dynamics. The quantities $$D_e$$ (dissociation energy), $$r_e$$ (equilibrium bond length), and $$k_e$$ (harmonic force constant at the minimum) are fundamental properties of a chemical bond. The problem is firmly grounded in established principles of physical chemistry and computational physics.\n-   **Well-Posed**: The problem asks for a protocol to determine three parameters: $$D_e$$, $$a$$, and $$r_e$$. It provides three distinct pieces of information: a value for $$D_e$$, a value for $$k_e$$, and an energy-distance pair $$(r_s, E_s)$$. The problem implies that the input value of $$D_e$$ is to be used directly for the parameter $$D_e$$, leaving two unknowns, $$a$$ and $$r_e$$, to be determined from the remaining two constraints, $$k_e=V''(r_e)$$ and $$E_s=V(r_s)$$. With two equations and two unknowns, the system is, in principle, solvable. The question of uniqueness and numerical robustness is a standard consideration in parameter fitting, making the problem well-structured.\n-   **Objective**: The problem is stated using precise, unambiguous scientific language. All terms like \"curvature at the minimum\" and \"dissociation energy\" have clear, universally accepted definitions within the field.\n\nThe problem exhibits no scientific or factual unsoundness, is not metaphorical, is not incomplete or contradictory, does not posit unrealistic conditions, is not ill-posed, and is not trivial.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The task is a standard parameterization exercise in chemical physics that requires both correct mathematical derivation and an understanding of numerical stability. I will now proceed with the solution.\n\n**Derivation of the Correct Protocol**\n\nThe objective is to determine the parameters $$a$$ and $$r_e$$ of the Morse potential $$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2$$, given the values of $$D_e$$, $$k_e=V''(r_e)$$, and a point $$(r_s, E_s)$$ where $$r_s  r_e$$.\n\nFirst, we establish the relationship between the curvature $$k_e$$ and the potential parameters. This requires calculating the second derivative of $$V(r)$$ with respect to $$r$$.\n\nThe first derivative is:\n$$ V'(r) = \\frac{d}{dr} \\left[ D_e\\left(1-e^{-a(r-r_e)}\\right)^2 \\right] $$\n$$ V'(r) = D_e \\cdot 2\\left(1-e^{-a(r-r_e)}\\right) \\cdot \\frac{d}{dr}\\left(1-e^{-a(r-r_e)}\\right) $$\n$$ V'(r) = 2D_e\\left(1-e^{-a(r-r_e)}\\right) \\left(-e^{-a(r-r_e)} \\cdot (-a)\\right) $$\n$$ V'(r) = 2aD_e \\left(1-e^{-a(r-r_e)}\\right)e^{-a(r-r_e)} = 2aD_e \\left(e^{-a(r-r_e)} - e^{-2a(r-r_e)}\\right) $$\nAt the minimum $$r=r_e$$, we have $$V'(r_e)=2aD_e(e^0 - e^0) = 0$$, which is consistent with an equilibrium point.\n\nThe second derivative is:\n$$ V''(r) = \\frac{d}{dr} \\left[ 2aD_e \\left(e^{-a(r-r_e)} - e^{-2a(r-r_e)}\\right) \\right] $$\n$$ V''(r) = 2aD_e \\left(-a e^{-a(r-r_e)} - (-2a) e^{-2a(r-r_e)}\\right) $$\n$$ V''(r) = 2a^2D_e \\left(2e^{-2a(r-r_e)} - e^{-a(r-r_e)}\\right) $$\n\nThe curvature at the minimum, $$k_e$$, is $$V''(r_e)$$:\n$$ k_e = V''(r_e) = 2a^2D_e \\left(2e^0 - e^0\\right) = 2a^2D_e(2-1) = 2a^2D_e $$\nFrom this exact relationship, we can solve for the parameter $$a$$:\n$$ a^2 = \\frac{k_e}{2D_e} $$\nSince $$a$$ is a physical parameter representing the width of the potential well, it must be positive. Thus, we take the principal root:\n$$ a = \\sqrt{\\frac{k_e}{2D_e}} $$\nThis equation determines the parameter $$a$$ using two of the provided high-quality inputs, $$k_e$$ and $$D_e$$.\n\nNext, we use the third input, the energy point $$(r_s, E_s)$$, to determine the remaining parameter, $$r_e$$. The defining equation is:\n$$ E_s = V(r_s) = D_e\\left(1-e^{-a(r_s-r_e)}\\right)^2 $$\nWe solve for $$r_e$$. The parameter $$a$$ is now considered known from the previous step.\n$$ \\frac{E_s}{D_e} = \\left(1-e^{-a(r_s-r_e)}\\right)^2 $$\nTaking the square root of both sides gives:\n$$ \\pm\\sqrt{\\frac{E_s}{D_e}} = 1-e^{-a(r_s-r_e)} $$\nWe must choose the correct sign. The problem states that $$r_sr_e$$, which means the bond is stretched. For a positive parameter $$a$$, the exponent $$-a(r_s-r_e)$$ is negative. Therefore, $$0  e^{-a(r_s-r_e)}  1$$. This implies that the term $$1-e^{-a(r_s-r_e)}$$ is positive. Consequently, we must take the positive root:\n$$ \\sqrt{\\frac{E_s}{D_e}} = 1-e^{-a(r_s-r_e)} $$\nFurthermore, since $$r_s$$ is a point on the bound potential, $$0  E_s  D_e$$, which ensures that $$0  \\sqrt{E_s/D_e}  1$$, and the subsequent logarithm will be of a positive number.\n\nRearranging to solve for the exponential term:\n$$ e^{-a(r_s-r_e)} = 1 - \\sqrt{\\frac{E_s}{D_e}} $$\nTaking the natural logarithm of both sides:\n$$ -a(r_s-r_e) = \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\nFinally, solving for $$r_e$$:\n$$ r_s - r_e = -\\frac{1}{a} \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\n$$ r_e = r_s + \\frac{1}{a} \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\nThis result provides a unique formula for $$r_e$$ based on the inputs. The protocol is thus analytically determined.\n\n**Evaluation of Options**\n\n**Option A:**\nThe protocol described is:\n1.  $$a=\\sqrt{\\dfrac{k_e}{2D_e}}$$\n2.  $$r_e=r_s+\\dfrac{1}{a}\\ln\\!\\left(1-\\sqrt{\\dfrac{E_s}{D_e}}\\right)$$ with the condition $$0\\sqrt{E_s/D_e}1$$.\n3.  $$D_e$$ is taken from the input.\n\nThis protocol exactly matches the derivation above. The justification provided in the option is also sound. The relationship $$k_e=2a^2D_e$$ does indeed constrain $$a$$ without reference to $$r_e$$. Using a data point $$(r_s, E_s)$$ far from the minimum ($$r_e$$) is a standard technique to avoid parameter correlation that arises when fitting only near-equilibrium data. Finally, the analysis of numerical robustness is correct: the logarithmic function is ill-conditioned if its argument approaches zero, which occurs when $$E_s \\to D_e$$. If $$E_s \\to 0$$, the data point provides information redundant with that from $$k_e$$, a less severe but still relevant issue.\n- **Verdict**: Correct.\n\n**Option B:**\nThe protocol described is:\n1.  $$a=\\dfrac{k_e}{D_e}$$\n2.  $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$\n3.  $$r_e=r_s-\\dfrac{1}{a}\\ln\\!\\left(1-\\dfrac{E_s}{D_e}\\right)$$\n\nThis option is fundamentally flawed. The relationship between $$a$$, $$k_e$$, and $$D_e$$ is $$k_e = 2a^2D_e$$, not $$k_e = aD_e$$. The proposed formula for $$a$$ is mathematically incorrect. Additionally, the potential energy is stated as $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$, which lacks the square on the parenthetical term, contradicting the definition of the Morse potential provided in the problem statement. The expression for $$r_e$$ is derived from this incorrect potential form. The entire protocol is based on incorrect mathematical relationships.\n- **Verdict**: Incorrect.\n\n**Option C:**\nThe protocol described is:\n1.  Fit $$a$$ and $$D_e$$ using nonlinear least squares to **two** stretched points.\n2.  Fix $$r_e$$ at the computationally determined minimum.\n3.  Use $$k_e$$ only for a posterior check.\n\nThis protocol is inconsistent with the problem statement. The problem provides one stretched point $$(r_s, E_s)$$, not two. It also provides $$D_e$$ and $$k_e$$ as high-quality inputs to be used for the parameterization, not as a check or a value to be fitted. This option describes an entirely different parameterization procedure that disregards the specified inputs.\n- **Verdict**: Incorrect.\n\n**Option D:**\nThe protocol described is:\n1.  Set $$D_e=E_s$$ and $$r_e=r_s$$.\n2.  Estimate $$k_e \\approx V''(r_s)$$.\n3.  Use $$a=\\sqrt{k_e/(2D_e)}$$.\n\nThis protocol is based on physically and mathematically absurd premises.\n-   $$D_e=E_s$$: The dissociation energy $$D_e$$ is the energy at infinite separation, which is the maximum possible potential energy for the bound state. $$E_s$$ is the energy at a finite separation $$r_s$$. For any finite stretch, $$E_s  D_e$$. Setting them equal is a fundamental error.\n-   $$r_e=r_s$$: $$r_e$$ is the equilibrium bond length where energy is minimum ($$V(r_e)=0$$). $$r_s$$ is a point of \"substantial elongation\" where the energy $$E_s  0$$. Equating these is a direct contradiction of the problem's setup and physical reality.\n-   $$k_e\\approx V''(r_s)$$: $$k_e$$ is defined as the curvature *at the minimum* ($$r_e$$), not at a stretched position $$r_s$$. The curvature of the Morse potential is not constant.\n\nThe justification provided is nonsensical as it is predicated on these falsehoods.\n- **Verdict**: Incorrect.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "One of the most important physical consequences of anharmonicity is thermal expansion, a phenomenon that a simple harmonic potential cannot describe. This computational practice explores how the intrinsic asymmetry of the Morse potential naturally gives rise to this effect . By applying the fundamental principles of statistical mechanics, you will numerically compute the canonical average bond length $\\langle r \\rangle$ at a finite temperature, providing a direct, quantitative link between the shape of a microscopic potential and a macroscopic thermodynamic property.",
            "id": "3395887",
            "problem": "Consider a classical diatomic bond coordinate governed by an anharmonic Morse potential used in Molecular Dynamics (MD). The potential energy as a function of bond length is given by the function $U_{M}(r)$, where $r$ is the internuclear separation. A canonical ensemble at temperature $T$ assigns to each configuration a probability density proportional to $\\exp(-\\beta U_{M}(r))$, where $\\beta = 1/(k_{B} T)$ and $k_{B}$ is the Boltzmann constant. The canonical average bond length is defined by the ratio of two integrals over the bond length domain. Your task is to compute this canonical average numerically for several specified parameter sets, and then to quantify the anharmonic shift away from the equilibrium bond length.\n\nStart from foundational statistical mechanics principles: the canonical probability density proportional to $\\exp(-\\beta U(r))$ and the definition of an ensemble average as a normalized integral over configuration space. Use only these principles and the stated potential as a base for your derivation and algorithm design.\n\nThe Morse potential is\n$$\nU_{M}(r) = D_{e} \\left(1 - e^{-a\\,(r - r_{e})}\\right)^{2},\n$$\nwhere $D_{e}$ is the well depth, $a$ sets the inverse length scale of the well, and $r_{e}$ is the equilibrium bond length. The canonical average bond length is\n$$\n\\langle r \\rangle = \\frac{\\int r \\, e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}.\n$$\n\nImportant physical and numerical considerations:\n- In the absence of additional constraints, the integral over $r$ to $+\\infty$ is not normalizable for a Morse potential because $U_{M}(r) \\to D_{e}$ as $r \\to \\infty$, which yields a non-vanishing Boltzmann factor. In realistic Molecular Dynamics, dissociation or finite molecular environments limit accessible $r$. To obtain a well-defined, physically meaningful bound-state average at temperature $T$ well below the dissociation scale, restrict the integrals to a finite interval $[r_{\\min}, r_{\\max}]$ chosen adaptively by a Boltzmann-weight tolerance and a cap:\n  - Define a tolerance $\\tau$ with $\\tau = 10^{-12}$ and a right-hand cap $L_{\\text{cap}} = 10\\,\\text{\\AA}$.\n  - Compute the energy threshold $U_{\\text{th}} = -k_{B} T \\ln \\tau$.\n  - Find $r_{\\text{L}} \\in (0, r_{e})$ such that $U_{M}(r_{\\text{L}}) = U_{\\text{th}}$ and set $r_{\\min} = \\max(0, r_{\\text{L}})$.\n  - Attempt to find $r_{\\text{R}} \\in (r_{e}, r_{e} + L_{\\text{cap}})$ such that $U_{M}(r_{\\text{R}}) = U_{\\text{th}}$. If such $r_{\\text{R}}$ exists, set $r_{\\max} = r_{\\text{R}}$; otherwise, set $r_{\\max} = r_{e} + L_{\\text{cap}}$.\n  - This constructs a restricted canonical average appropriate to temperatures $T$ where bound states dominate. Your numerical method should robustly handle both regimes where $U_{\\text{th}}  D_{e}$ and $U_{\\text{th}} \\ge D_{e}$.\n\nProgram requirements:\n- Use $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$.\n- Units:\n  - Energies $D_{e}$ must be in Joules.\n  - Temperature $T$ must be in Kelvin.\n  - Lengths $r$ and $r_{e}$ must be in Angstroms ($\\text{\\AA}$).\n  - The inverse length parameter $a$ must be in $\\text{\\AA}^{-1}$.\n- Compute the restricted canonical average $\\langle r \\rangle$ on $[r_{\\min}, r_{\\max}]$ and the anharmonic shift $\\Delta = \\langle r \\rangle - r_{e}$. Express both $\\langle r \\rangle$ and $\\Delta$ in Angstroms.\n- The numerical integration must be accurate enough for advanced graduate-level analysis; use an adaptive quadrature with stringent tolerances.\n\nTest suite:\nFor each of the following parameter sets $(D_{e}, a, r_{e}, T)$, compute $\\langle r \\rangle$ and $\\Delta$:\n1. $D_{e} = 8.000 \\times 10^{-19}\\,\\mathrm{J}$, $a = 2.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.0\\,\\text{\\AA}$, $T = 300\\,\\mathrm{K}$.\n2. $D_{e} = 8.000 \\times 10^{-20}\\,\\mathrm{J}$, $a = 1.5\\,\\text{\\AA}^{-1}$, $r_{e} = 1.5\\,\\text{\\AA}$, $T = 600\\,\\mathrm{K}$.\n3. $D_{e} = 1.1215 \\times 10^{-18}\\,\\mathrm{J}$, $a = 4.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.0\\,\\text{\\AA}$, $T = 50\\,\\mathrm{K}$.\n4. $D_{e} = 4.8065 \\times 10^{-20}\\,\\mathrm{J}$, $a = 2.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.2\\,\\text{\\AA}$, $T = 1000\\,\\mathrm{K}$.\n\nAlgorithmic output:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The list should contain, in order, for each test case, first the canonical average $\\langle r \\rangle$ in Angstroms, then the shift $\\Delta$ in Angstroms. For the four test cases, the output must thus have eight floating-point numbers:\n$$\n[\\langle r \\rangle_{1}, \\Delta_{1}, \\langle r \\rangle_{2}, \\Delta_{2}, \\langle r \\rangle_{3}, \\Delta_{3}, \\langle r \\rangle_{4}, \\Delta_{4}]\n$$\nwith all lengths in Angstroms.",
            "solution": "The problem statement has been critically validated and is deemed to be a valid scientific problem. It is scientifically grounded in the principles of classical statistical mechanics, is mathematically well-posed with a clear and complete set of givens, and is expressed in objective, formal language. There are no contradictions, ambiguities, or factual unsoundness. The task is a standard, albeit non-trivial, exercise in computational physics. We may therefore proceed with the solution.\n\nThe problem requires a computation of the canonical average bond length $\\langle r \\rangle$ for a diatomic molecule whose potential energy $U_{M}(r)$ is described by the Morse potential. The anharmonicity of this potential, meaning its deviation from a simple quadratic (harmonic) form, causes a temperature-dependent shift in the average bond length away from the potential minimum $r_{e}$. Our objective is to calculate this average length and the corresponding shift $\\Delta = \\langle r \\rangle - r_{e}$.\n\nThe foundational principle is that in a canonical ensemble at temperature $T$, the probability density $p(r)$ of finding the system at a bond length $r$ is proportional to the Boltzmann factor, $e^{-\\beta U(r)}$, where $\\beta = 1/(k_{B}T)$ and $k_{B}$ is the Boltzmann constant.\n$$\np(r) = \\frac{e^{-\\beta U_{M}(r)}}{Z}\n$$\nThe normalization constant $Z$, known as the partition function for this one-dimensional configuration space, is given by the integral of the Boltzmann factor over all possible bond lengths:\n$$\nZ = \\int e^{-\\beta U_{M}(r)} \\, dr\n$$\nThe canonical average of any observable quantity $A(r)$ is then computed as its probability-weighted integral:\n$$\n\\langle A \\rangle = \\int A(r) p(r) \\, dr = \\frac{\\int A(r) e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}\n$$\nFor this problem, the observable is the bond length itself, $A(r) = r$. Thus, we must compute:\n$$\n\\langle r \\rangle = \\frac{\\int r \\, e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}\n$$\nThe Morse potential is given by:\n$$\nU_{M}(r) = D_{e} \\left(1 - e^{-a(r - r_{e})}\\right)^{2}\n$$\nwhere $D_{e}$ is the dissociation energy (well depth), $a$ is a parameter controlling the width of the potential well, and $r_{e}$ is the equilibrium bond length corresponding to the minimum energy $U_{M}(r_e) = 0$.\n\nA critical issue arises from the integral's domain. As $r \\to \\infty$, the term $e^{-a(r-r_e)} \\to 0$, and thus $U_{M}(r) \\to D_{e}$. The integrand $e^{-\\beta U_{M}(r)}$ approaches a non-zero constant $e^{-\\beta D_{e}}$. An integral of a function that approaches a positive constant over an infinite domain diverges. This reflects the physical reality that, in the absence of other constraints, there is a finite probability of dissociation. The problem circumvents this by defining a restricted canonical average for a bound state. This is physically justified at temperatures $T$ where $k_{B}T \\ll D_{e}$, as states with energy near or above $D_{e}$ are highly improbable. The integration domain is truncated to an interval $[r_{\\min}, r_{\\max}]$ where the Boltzmann factors at the boundaries are exceedingly small, as specified by a tolerance $\\tau = 10^{-12}$.\n\nThe algorithm to determine the integration bounds $[r_{\\min}, r_{\\max}]$ is as follows:\n1.  Calculate the energy threshold $U_{\\text{th}} = -k_{B} T \\ln \\tau$. This is the energy at which the Boltzmann weight $e^{-\\beta U}$ drops to the tolerance $\\tau$. Note that $U_{\\text{th}} = -\\frac{1}{\\beta} \\ln \\tau$.\n2.  To find the integration limits, we solve the equation $U_{M}(r) = U_{\\text{th}}$ for $r$:\n    $$\n    D_{e} \\left(1 - e^{-a(r - r_{e})}\\right)^{2} = U_{\\text{th}}\n    $$\n    $$\n    1 - e^{-a(r - r_{e})} = \\pm \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\n    $$\n    $$\n    e^{-a(r - r_{e})} = 1 \\mp \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\n    $$\n    $$\n    r = r_{e} - \\frac{1}{a} \\ln \\left(1 \\mp \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\\right)\n    $$\n3.  This yields two potential solutions. The '+' sign corresponds to the inner wall of the potential ($r  r_{e}$), and the '-' sign corresponds to the outer wall ($r  r_{e}$).\n    -   The left boundary, $r_{\\text{L}}$, is found using the '+' sign: $r_{\\text{L}} = r_{e} - \\frac{1}{a} \\ln \\left(1 + \\sqrt{U_{\\text{th}}/D_{e}}\\right)$. This solution is always real and less than $r_e$. We set $r_{\\min} = \\max(0, r_{\\text{L}})$, as bond length cannot be negative.\n    -   The right boundary, $r_{\\text{R}}$, is associated with the '-' sign: $r_{\\text{R}} = r_{e} - \\frac{1}{a} \\ln \\left(1 - \\sqrt{U_{\\text{th}}/D_{e}}\\right)$.\n4.  The determination of $r_{\\max}$ depends on whether $U_{\\text{th}}$ is less than $D_{e}$:\n    -   **Case 1: $U_{\\text{th}}  D_{e}$**. The term $\\sqrt{U_{\\text{th}}/D_{e}}  1$, so the argument of the logarithm is positive and a real solution $r_{\\text{R}}  r_{e}$ exists. As per the problem's constraints, we must cap this value at $r_{e} + L_{\\text{cap}}$, where $L_{\\text{cap}} = 10\\,\\text{\\AA}$. Therefore, $r_{\\max} = \\min(r_{\\text{R}}, r_{e} + L_{\\text{cap}})$.\n    -   **Case 2: $U_{\\text{th}} \\ge D_{e}$**. The term $\\sqrt{U_{\\text{th}}/D_{e}} \\ge 1$, making the argument of the logarithm non-positive. No real solution for $r_{\\text{R}}$ exists. In this regime (high temperature or shallow well), the Boltzmann weight never drops below the tolerance $\\tau$ on the outer wall. Following the problem's explicit instructions, we use the hard cap: $r_{\\max} = r_{e} + L_{\\text{cap}}$.\n\nWith the integration limits $[r_{\\min}, r_{\\max}]$ established, we can define the two definite integrals to be computed numerically:\n$$\nN = \\int_{r_{\\min}}^{r_{\\max}} r \\, e^{-\\beta U_{M}(r)} \\, dr\n$$\n$$\nZ = \\int_{r_{\\min}}^{r_{\\max}} e^{-\\beta U_{M}(r)} \\, dr\n$$\nThe average bond length is then $\\langle r \\rangle = N/Z$, and the anharmonic shift is $\\Delta = \\langle r \\rangle - r_{e}$. Due to the asymmetric shape of the Morse potential (it is less steep for $r  r_{e}$ than for $r  r_{e}$), we expect $\\langle r \\rangle$ to be greater than $r_{e}$ for any $T  0$, resulting in a positive shift $\\Delta$.\n\nThe calculation will be implemented using adaptive quadrature, as provided by the `scipy.integrate.quad` function, to ensure high accuracy for the numerical integration of these well-behaved but potentially sharply peaked functions. The logic defined above will be applied to each parameter set from the test suite. All units must be consistent; we will use Joules for energy, Kelvin for temperature, and Angstroms for length, as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the canonical average bond length and anharmonic shift for a diatomic\n    molecule described by a Morse potential for several test cases.\n    \"\"\"\n\n    # Physical constant and numerical parameters\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    TAU = 1.0e-12       # Boltzmann weight tolerance\n    L_CAP = 10.0        # Right-hand integration cap in Angstroms\n\n    # Test suite: (D_e [J], a [A^-1], r_e [A], T [K])\n    test_cases = [\n        (8.000e-19, 2.0, 1.0, 300.0),\n        (8.000e-20, 1.5, 1.5, 600.0),\n        (1.1215e-18, 4.0, 1.0, 50.0),\n        (4.8065e-20, 2.0, 1.2, 1000.0),\n    ]\n\n    results = []\n\n    def compute_metrics(De, a, re, T):\n        \"\"\"\n        Calculates r and Delta for a single set of parameters.\n        \"\"\"\n        # Calculate beta and the energy threshold\n        beta = 1.0 / (K_B * T)\n        U_th = -K_B * T * np.log(TAU)\n\n        # Define the Morse potential function\n        def morse_potential(r):\n            return De * (1 - np.exp(-a * (r - re)))**2\n\n        # --- Determine integration bounds [r_min, r_max] ---\n\n        # Calculate the left bound, r_L\n        # This is always well-defined for De  0, U_th = 0\n        sqrt_term = np.sqrt(U_th / De)\n        rL = re - (1.0 / a) * np.log(1.0 + sqrt_term)\n        r_min = max(0.0, rL)\n\n        # Calculate the right bound, r_max\n        if U_th  De:\n            # Solution for r  re exists.\n            rR = re - (1.0 / a) * np.log(1.0 - sqrt_term)\n            # Apply the cap as per problem statement logic.\n            # The problem says if r_R exists, set r_max = r_R, but capped at re + L_cap.\n            # This is subtly different from min(rR, re + L_cap). The problem states:\n            # \"Attempt to find r_R in (re, re+L_cap)... If such r_R exists, set r_max = r_R\"\n            # This implies if rR > re + L_cap, we should use re + L_cap.\n            # My min(rR, re+L_cap) logic was correct.\n            r_max = min(rR, re + L_CAP)\n        else:\n            # No real solution for r  re. Use the hard cap.\n            r_max = re + L_CAP\n\n        # --- Perform numerical integration ---\n\n        # Define the integrands\n        # Numerator integrand: r * exp(-beta * U(r))\n        def integrand_numerator(r):\n            return r * np.exp(-beta * morse_potential(r))\n\n        # Denominator (partition function) integrand: exp(-beta * U(r))\n        def integrand_denominator(r):\n            return np.exp(-beta * morse_potential(r))\n        \n        # Use adaptive quadrature to compute the integrals\n        # quad returns a tuple (result, estimated_error)\n        numerator_integral, _ = quad(integrand_numerator, r_min, r_max, epsabs=1e-12, epsrel=1e-12)\n        denominator_integral, _ = quad(integrand_denominator, r_min, r_max, epsabs=1e-12, epsrel=1e-12)\n        \n        # --- Calculate final results ---\n        \n        if denominator_integral == 0:\n            # Should not happen with valid parameters, but as a safeguard.\n            avg_r = re\n        else:\n            avg_r = numerator_integral / denominator_integral\n        \n        anharmonic_shift = avg_r - re\n\n        return avg_r, anharmonic_shift\n\n    # Process each test case\n    for case in test_cases:\n        De, a, re, T = case\n        avg_r, delta = compute_metrics(De, a, re, T)\n        results.extend([avg_r, delta])\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{x:.8f}' for x in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Accurately simulating the dynamics of an anharmonic oscillator presents a core numerical challenge, as the system's \"stiffness\" can change dramatically during its motion. This hands-on practice guides you through implementing a velocity Verlet integrator to explore how to manage this challenge for a Morse potential . By comparing a standard fixed-timestep integration with an adaptive scheme that adjusts the timestep based on the potential's local curvature, you will gain practical insight into the trade-offs between computational cost and the long-term conservation of energy, a crucial aspect of any reliable molecular dynamics simulation.",
            "id": "3395874",
            "problem": "Consider a single-degree-of-freedom model of a diatomic bond along a scalar bond coordinate $r(t)$ governed by Newton's second law $m \\, d^{2}r/dt^{2} = - \\, dU(r)/dr$, where $m$ is the reduced mass and $U(r)$ is the Morse potential $U(r) = D_{e} \\left(1 - e^{-a \\, (r - r_{e})}\\right)^{2}$. Work in reduced (dimensionless) units so that $r$, $t$, $m$, $D_{e}$, $a$, and $r_{e}$ are all dimensionless scalars, and the total energy $E(t) = \\tfrac{1}{2} m \\, v^{2}(t) + U(r(t))$ is dimensionless. Design an adaptive timestep scheme for explicit time integration that uses the instantaneous curvature through the local frequency proxy $\\omega(t) = \\sqrt{\\max\\{U''(r(t)), \\, 0\\}/m}$ to bound the step size, together with explicit lower and upper step limits. The aim is to compare the impact of this curvature-based adaptive timestep against a fixed timestep on energy conservation.\n\nYour program must do all of the following, starting only from the definitions above and standard laws:\n- Derive $dU(r)/dr$ and $d^{2}U(r)/dr^{2}$ analytically from the given $U(r)$.\n- Implement a velocity Verlet integrator to evolve $r(t)$ and $v(t)$:\n  - For the fixed-step scheme, use a constant timestep $\\Delta t_{\\mathrm{fix}}$.\n  - For the adaptive-step scheme, at each step compute $\\omega(t)$ from $U''(r(t))$ and $m$, and pick the largest $\\Delta t(t)$ that satisfies the constraint $\\omega(t) \\, \\Delta t(t) \\le \\eta$ while enforcing $\\Delta t_{\\min} \\le \\Delta t(t) \\le \\Delta t_{\\max}$. If $U''(r(t)) \\le 0$, treat $\\omega(t)$ as $0$ when enforcing the constraint. Ensure that the final step lands exactly at the prescribed final time $T$ by shortening the last step if necessary.\n- For each trajectory, compute the maximum relative energy deviation over the simulated time interval $[0, T]$ defined by\n$$\\varepsilon_{\\max} \\equiv \\max_{i} \\frac{\\left|E(t_{i}) - E(0)\\right|}{\\max\\left\\{\\left|E(0)\\right|, \\, 10^{-12}\\right\\}},$$\nwhere $t_{i}$ are the discrete integrator times at which energy is evaluated.\n- For each test case, report two values: the fixed-step $\\varepsilon_{\\max}$ and the adaptive-step $\\varepsilon_{\\max}$.\n\nTest suite. Use the following parameter sets, all in reduced units:\n- Case $1$: $D_{e} = 20.0$, $a = 1.5$, $r_{e} = 1.0$, $m = 1.0$, $r(0) = 1.1$, $v(0) = 0.0$, $T = 150.0$, $\\Delta t_{\\mathrm{fix}} = 0.02$, $\\eta = 0.2$, $\\Delta t_{\\min} = 0.002$, $\\Delta t_{\\max} = 0.02$.\n- Case $2$: $D_{e} = 20.0$, $a = 1.5$, $r_{e} = 1.0$, $m = 1.0$, $r(0) = 1.8$, $v(0) = 0.0$, $T = 150.0$, $\\Delta t_{\\mathrm{fix}} = 0.02$, $\\eta = 0.2$, $\\Delta t_{\\min} = 0.002$, $\\Delta t_{\\max} = 0.02$.\n- Case $3$: $D_{e} = 5.0$, $a = 3.0$, $r_{e} = 1.0$, $m = 0.5$, $r(0) = 0.95$, $v(0) = 0.0$, $T = 100.0$, $\\Delta t_{\\mathrm{fix}} = 0.005$, $\\eta = 0.15$, $\\Delta t_{\\min} = 0.0005$, $\\Delta t_{\\max} = 0.005$.\n\nRequired output format. Your program should produce a single line of output containing a list of lists, one sublist per test case in the same order as above, where each sublist contains the two floating-point values $[\\varepsilon_{\\max}^{\\mathrm{fix}}, \\varepsilon_{\\max}^{\\mathrm{adapt}}]$. Round each floating-point value to exactly $8$ decimal places and print the nested list in a Python-like literal form (for example, $[[0.12345678,0.23456789],[\\dots],\\dots]$).",
            "solution": "The problem requires a comparison of fixed-timestep and adaptive-timestep numerical integration for a one-dimensional system governed by the Morse potential. The core of the task is to implement the velocity Verlet algorithm for both scenarios and evaluate their performance based on energy conservation. All calculations are performed in a dimensionless unit system.\n\nFirst, we must derive the analytical expressions for the force and the second derivative of the potential, which are essential for the integrator and the adaptive timestep scheme, respectively. The Morse potential is given by:\n$$U(r) = D_{e} \\left(1 - e^{-a \\, (r - r_{e})}\\right)^{2}$$\nwhere $D_{e}$ is the dissociation energy, $r_{e}$ is the equilibrium bond distance, and $a$ controls the width of the potential well.\n\nThe force, $F(r)$, is the negative gradient of the potential: $F(r) = - \\frac{dU(r)}{dr}$. We compute the first derivative using the chain rule:\n$$ \\frac{dU}{dr} = D_{e} \\cdot 2 \\left(1 - e^{-a \\, (r - r_{e})}\\right) \\cdot \\frac{d}{dr}\\left(- e^{-a \\, (r - r_{e})}\\right) $$\n$$ \\frac{dU}{dr} = 2 D_{e} \\left(1 - e^{-a \\, (r - r_{e})}\\right) \\cdot \\left(-e^{-a \\, (r - r_{e})} \\cdot (-a)\\right) $$\n$$ \\frac{dU}{dr} = 2 a D_{e} \\left(1 - e^{-a \\, (r - r_{e})}\\right) e^{-a \\, (r - r_{e})} $$\n$$ \\frac{dU}{dr} = 2 a D_{e} \\left(e^{-a \\, (r - r_{e})} - e^{-2a \\, (r - r_{e})}\\right) $$\nTherefore, the force is:\n$$ F(r) = -2 a D_{e} \\left(e^{-a \\, (r - r_{e})} - e^{-2a \\, (r - r_{e})}\\right) $$\n\nNext, we compute the second derivative of the potential, $U''(r) = \\frac{d^{2}U(r)}{dr^{2}}$, which is a measure of the local curvature of the potential energy surface. This is required for the adaptive timestep calculation.\n$$ \\frac{d^{2}U}{dr^{2}} = \\frac{d}{dr} \\left[ 2 a D_{e} \\left(e^{-a \\, (r - r_{e})} - e^{-2a \\, (r - r_{e})}\\right) \\right] $$\n$$ \\frac{d^{2}U}{dr^{2}} = 2 a D_{e} \\left[ -a e^{-a \\, (r - r_{e})} - (-2a) e^{-2a \\, (r - r_{e})} \\right] $$\n$$ \\frac{d^{2}U}{dr^{2}} = 2 a^{2} D_{e} \\left[ 2e^{-2a \\, (r - r_{e})} - e^{-a \\, (r - r_{e})} \\right] $$\n\nThe dynamics of the system are simulated using the velocity Verlet algorithm, a time-reversible and symplectic integrator widely used in molecular dynamics. For a given timestep $\\Delta t$, the positions $r(t)$, velocities $v(t)$, and accelerations $a(t) = F(r(t))/m$ are updated as follows:\n1. Update position: $r(t + \\Delta t) = r(t) + v(t)\\Delta t + \\frac{1}{2} a(t) (\\Delta t)^{2}$\n2. Calculate the new force $F(r(t+\\Delta t))$ and acceleration $a(t + \\Delta t) = F(r(t+\\Delta t))/m$.\n3. Update velocity: $v(t + \\Delta t) = v(t) + \\frac{1}{2} [a(t) + a(t + \\Delta t)] \\Delta t$\n\nTwo timestepping schemes are implemented:\n1.  **Fixed Timestep**: A constant step size $\\Delta t = \\Delta t_{\\mathrm{fix}}$ is used throughout the simulation.\n2.  **Adaptive Timestep**: The step size $\\Delta t(t)$ is adjusted at each step based on the local dynamics. The local frequency proxy, $\\omega(t) = \\sqrt{\\max\\{U''(r(t)), 0\\}/m}$, characterizes the fastest timescale of motion. The timestep $\\Delta t(t)$ is chosen to satisfy the stability condition $\\omega(t) \\Delta t(t) \\le \\eta$, where $\\eta$ is a dimensionless parameter controlling the number of steps per oscillation period. If $U''(r(t)) \\le 0$, the potential is convex or linear, indicating no local oscillatory behavior, so $\\omega(t)$ is set to $0$. In this case, the constraint provides no upper bound. The final step size is determined by finding the largest value that satisfies the stability constraint while being clamped within the range $[\\Delta t_{\\min}, \\Delta t_{\\max}]$. Specifically, the timestep $\\Delta t_{s}$ from the stability constraint is $\\Delta t_{s} = \\eta/\\omega(t)$ if $\\omega(t)  0$, and effectively infinite otherwise. The chosen timestep is then $\\Delta t(t) = \\max\\{\\Delta t_{\\min}, \\min\\{\\Delta t_{s}, \\Delta t_{\\max}\\}\\}$. For both schemes, the final integration step is shortened if necessary to ensure the simulation terminates precisely at time $T$.\n\nTo quantify the performance of each scheme, we calculate the maximum relative energy deviation $\\varepsilon_{\\max}$ over the trajectory. The total energy is $E(t) = \\frac{1}{2} m v^{2}(t) + U(r(t))$. The deviation is defined as:\n$$ \\varepsilon_{\\max} = \\max_{i} \\frac{\\left|E(t_{i}) - E(0)\\right|}{\\max\\left\\{\\left|E(0)\\right|, \\, 10^{-12}\\right\\}} $$\nwhere $t_i$ are the discrete time points of the simulation. The denominator includes a small floor value of $10^{-12}$ to prevent division by zero if the initial energy happens to be zero. A smaller $\\varepsilon_{\\max}$ indicates better energy conservation and thus a more accurate numerical integration.\n\nThe program implements these principles by defining functions for the potential $U(r)$, force $F(r)$, and second derivative $U''(r)$. A generic simulation function encapsulates the velocity Verlet loop, which can operate in either fixed or adaptive mode. This function is called for each test case to compute $\\varepsilon_{\\max}^{\\mathrm{fix}}$ and $\\varepsilon_{\\max}^{\\mathrm{adapt}}$, which are then formatted and printed as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation test suite and print results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"De\": 20.0, \"a\": 1.5, \"re\": 1.0, \"m\": 1.0,\n            \"r0\": 1.1, \"v0\": 0.0, \"T\": 150.0,\n            \"dt_fix\": 0.02, \"eta\": 0.2, \"dt_min\": 0.002, \"dt_max\": 0.02\n        },\n        # Case 2\n        {\n            \"De\": 20.0, \"a\": 1.5, \"re\": 1.0, \"m\": 1.0,\n            \"r0\": 1.8, \"v0\": 0.0, \"T\": 150.0,\n            \"dt_fix\": 0.02, \"eta\": 0.2, \"dt_min\": 0.002, \"dt_max\": 0.02\n        },\n        # Case 3\n        {\n            \"De\": 5.0, \"a\": 3.0, \"re\": 1.0, \"m\": 0.5,\n            \"r0\": 0.95, \"v0\": 0.0, \"T\": 100.0,\n            \"dt_fix\": 0.005, \"eta\": 0.15, \"dt_min\": 0.0005, \"dt_max\": 0.005\n        },\n    ]\n\n    all_results = []\n    for params in test_cases:\n        \n        # --- Potential, Force, and Second Derivative Functions ---\n        De, a, re = params[\"De\"], params[\"a\"], params[\"re\"]\n\n        def potential(r):\n            term = 1.0 - np.exp(-a * (r - re))\n            return De * term**2\n\n        def force(r):\n            exp1 = np.exp(-a * (r - re))\n            exp2 = np.exp(-2 * a * (r - re))\n            return -2 * a * De * (exp1 - exp2)\n\n        def potential_pp(r): # Second derivative\n            exp1 = np.exp(-a * (r - re))\n            exp2 = np.exp(-2 * a * (r - re))\n            return 2 * a**2 * De * (2 * exp2 - exp1)\n        \n        funcs = {\n            \"U\": potential,\n            \"F\": force,\n            \"U_pp\": potential_pp\n        }\n\n        # --- Run fixed and adaptive simulations ---\n        eps_fix = run_simulation(params, funcs, adaptive=False)\n        eps_adapt = run_simulation(params, funcs, adaptive=True)\n        all_results.append([eps_fix, eps_adapt])\n\n    # --- Format and print final output ---\n    sublists_str = [f\"[{res[0]:.8f},{res[1]:.8f}]\" for res in all_results]\n    final_output = \"[\" + \",\".join(sublists_str) + \"]\"\n    print(final_output)\n\ndef run_simulation(params, funcs, adaptive):\n    \"\"\"\n    Runs a single simulation using the velocity Verlet integrator.\n\n    Args:\n        params (dict): Dictionary of simulation parameters.\n        funcs (dict): Dictionary of physics functions (U, F, U_pp).\n        adaptive (bool): If True, use adaptive timestepping. Otherwise, use fixed.\n\n    Returns:\n        float: The maximum relative energy deviation (epsilon_max).\n    \"\"\"\n    # Unpack parameters\n    m, r0, v0, T = params[\"m\"], params[\"r0\"], params[\"v0\"], params[\"T\"]\n    dt_fix, eta, dt_min, dt_max = (\n        params.get(\"dt_fix\"), params.get(\"eta\"),\n        params.get(\"dt_min\"), params.get(\"dt_max\")\n    )\n    \n    # Physics functions\n    U, F, U_pp = funcs[\"U\"], funcs[\"F\"], funcs[\"U_pp\"]\n\n    # Initial conditions\n    t = 0.0\n    r = r0\n    v = v0\n    acc = F(r) / m\n\n    # Energy calculation setup\n    E0 = 0.5 * m * v**2 + U(r)\n    E_denom = max(abs(E0), 1e-12)\n    max_rel_error = 0.0\n\n    while t  T:\n        # Determine timestep dt\n        if adaptive:\n            U_double_prime = U_pp(r)\n            if U_double_prime > 0:\n                omega = np.sqrt(U_double_prime / m)\n                dt_stable = eta / omega if omega > 1e-12 else float('inf')\n            else:\n                dt_stable = float('inf')\n            \n            dt = min(dt_stable, dt_max)\n            dt = max(dt, dt_min)\n        else: # Fixed timestep\n            dt = dt_fix\n\n        # Ensure final step lands exactly at T\n        if t + dt > T:\n            dt = T - t\n\n        # Exit condition if dt becomes too small (prevents infinite loops)\n        if dt  1e-15:\n            break\n            \n        # Velocity Verlet integrator step\n        r = r + v * dt + 0.5 * acc * dt**2\n        acc_new = F(r) / m\n        v = v + 0.5 * (acc + acc_new) * dt\n        \n        # Update state for next iteration\n        acc = acc_new\n        t += dt\n\n        # Calculate and track energy deviation\n        E_current = 0.5 * m * v**2 + U(r)\n        rel_error = abs(E_current - E0) / E_denom\n        if rel_error > max_rel_error:\n            max_rel_error = rel_error\n            \n    return max_rel_error\n\nsolve()\n```"
        }
    ]
}