{
    "hands_on_practices": [
        {
            "introduction": "键伸缩是最简单的键合相互作用，通常被建模为一个谐振子弹簧。这个练习将提供一个具体的、基于第一性原理的实践，指导你如何从给定的势能函数计算单个原子上的作用力，并验证牛顿第三定律，这是对任何二体相互作用的基本检验。",
            "id": "3399229",
            "problem": "考虑在分子动力学 (MD) 模拟中由一个键连接的两个原子。这两个原子在三维空间中的位置向量分别为 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$，其中 $\\mathbf{r}_1 = (0.000,\\,0.000,\\,0.000)\\,\\mathrm{nm}$ 且 $\\mathbf{r}_2 = (0.140,\\,0.060,\\,-0.020)\\,\\mathrm{nm}$。设键长为 $r = |\\mathbf{r}_2 - \\mathbf{r}_1|$，平衡键长为 $r_0 = 0.154\\,\\mathrm{nm}$。在围绕 $r_0$ 的谐振近似中，势能最小值点的曲率（键力常数）为 $k_b$，键合相互作用势能按键伸长量 $r - r_0$ 展开至二阶，曲率 $k_b = 1200\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$。\n\n从第一性原理出发，特别是牛顿第二定律和保守力定义为势能的负梯度，推导出每个原子上所受的力矢量，该力矢量是 $k_b$、$r_0$ 和原子位置的函数。然后使用所提供的数值，计算在给定键伸长情况下每个原子所受力的大小和方向。通过证明两个原子上的力大小相等、方向相反，明确地展示牛顿第三定律。\n\n请以有序六元组 $(F_{1x},\\,F_{1y},\\,F_{1z},\\,F_{2x},\\,F_{2y},\\,F_{2z})$ 的形式提供最终数值答案，对应于原子1和原子2上的力分量，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}$。将每个分量四舍五入到四位有效数字。答案必须是单个解析或数值表达式。",
            "solution": "此问题经评估具有科学依据，提法恰当且完整。所有必要的参数均已提供，所要求的推导和计算基于经典力学的基本原理。数值对于共价键是物理上真实的。因此，该问题有效，下面提供了解决方案。\n\n原子 $i$ 上所受的力 $\\mathbf{F}_i$ 是从势能 $U$ 通过保守力定义推导出来的，该定义指出，力是势能相对于该原子位置坐标 $\\mathbf{r}_i$ 的负梯度：\n$$\n\\mathbf{F}_i = -\\nabla_{\\mathbf{r}_i} U\n$$\n键合相互作用势由谐振近似给出，在平衡键长 $r_0$ 附近展开至二阶：\n$$\nU(r) = \\frac{1}{2} k_b (r - r_0)^2\n$$\n其中 $k_b$ 是键力常数，$r$ 是瞬时键长。键长 $r$ 是原子间距离向量 $\\mathbf{r}_{12} = \\mathbf{r}_2 - \\mathbf{r}_1$ 的大小：\n$$\nr = |\\mathbf{r}_{12}| = |\\mathbf{r}_2 - \\mathbf{r}_1| = \\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2 + (z_2-z_1)^2}\n$$\n势能 $U$ 是标量距离 $r$ 的函数，而 $r$ 又是向量坐标 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$ 的函数。为了求出原子1上的力，我们应用链式法则进行微分：\n$$\n\\mathbf{F}_1 = -\\nabla_{\\mathbf{r}_1} U(r(\\mathbf{r}_1, \\mathbf{r}_2)) = -\\frac{dU}{dr} \\nabla_{\\mathbf{r}_1} r\n$$\n首先，我们计算势能对键长 $r$ 的导数：\n$$\n\\frac{dU}{dr} = \\frac{d}{dr} \\left[ \\frac{1}{2} k_b (r - r_0)^2 \\right] = k_b (r - r_0)\n$$\n接下来，我们计算键长 $r$ 相对于原子1的位置 $\\mathbf{r}_1 = (x_1, y_1, z_1)$ 的梯度：\n$$\n\\nabla_{\\mathbf{r}_1} r = \\left( \\frac{\\partial r}{\\partial x_1}, \\frac{\\partial r}{\\partial y_1}, \\frac{\\partial r}{\\partial z_1} \\right)\n$$\n偏导数是：\n$$\n\\frac{\\partial r}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2 + (z_2-z_1)^2} = \\frac{1}{2r} \\cdot 2(x_2-x_1)(-1) = -\\frac{x_2-x_1}{r}\n$$\n同理，$\\frac{\\partial r}{\\partial y_1} = -\\frac{y_2-y_1}{r}$ 且 $\\frac{\\partial r}{\\partial z_1} = -\\frac{z_2-z_1}{r}$。将这些分量组合起来得到梯度向量：\n$$\n\\nabla_{\\mathbf{r}_1} r = -\\frac{\\mathbf{r}_2 - \\mathbf{r}_1}{r} = -\\frac{\\mathbf{r}_{12}}{r} = -\\hat{\\mathbf{r}}_{12}\n$$\n其中 $\\hat{\\mathbf{r}}_{12}$ 是从原子1指向原子2的单位向量。\n\n将这些结果代回 $\\mathbf{F}_1$ 的表达式中：\n$$\n\\mathbf{F}_1 = - \\left( k_b(r-r_0) \\right) \\left( -\\frac{\\mathbf{r}_{12}}{r} \\right) = k_b(r-r_0) \\frac{\\mathbf{r}_{12}}{r} = k_b(r-r_0)\\hat{\\mathbf{r}}_{12}\n$$\n同理，对于原子2上的力 $\\mathbf{F}_2$：\n$$\n\\mathbf{F}_2 = -\\nabla_{\\mathbf{r}_2} U(r(\\mathbf{r}_1, \\mathbf{r}_2)) = -\\frac{dU}{dr} \\nabla_{\\mathbf{r}_2} r\n$$\n$r$ 相对于 $\\mathbf{r}_2$ 的梯度是：\n$$\n\\frac{\\partial r}{\\partial x_2} = \\frac{1}{2r} \\cdot 2(x_2-x_1)(1) = \\frac{x_2-x_1}{r}\n$$\n这导致：\n$$\n\\nabla_{\\mathbf{r}_2} r = \\frac{\\mathbf{r}_2 - \\mathbf{r}_1}{r} = \\frac{\\mathbf{r}_{12}}{r} = \\hat{\\mathbf{r}}_{12}\n$$\n代入 $\\mathbf{F}_2$ 的表达式中：\n$$\n\\mathbf{F}_2 = - \\left( k_b(r-r_0) \\right) \\left( \\frac{\\mathbf{r}_{12}}{r} \\right) = -k_b(r-r_0)\\hat{\\mathbf{r}}_{12}\n$$\n比较 $\\mathbf{F}_1$ 和 $\\mathbf{F}_2$ 的表达式，我们看到 $\\mathbf{F}_1 = -\\mathbf{F}_2$。这明确地展示了牛顿第三定律：两个原子上的力大小相等，方向相反。\n\n现在，我们使用所提供的值进行数值计算：\n$\\mathbf{r}_1 = (0.000, 0.000, 0.000)\\,\\mathrm{nm}$，$\\mathbf{r}_2 = (0.140, 0.060, -0.020)\\,\\mathrm{nm}$，$r_0 = 0.154\\,\\mathrm{nm}$，以及 $k_b = 1200\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$。\n\n首先，我们计算键向量 $\\mathbf{r}_{12}$：\n$$\n\\mathbf{r}_{12} = \\mathbf{r}_2 - \\mathbf{r}_1 = (0.140 - 0.000, 0.060 - 0.000, -0.020 - 0.000)\\,\\mathrm{nm} = (0.140, 0.060, -0.020)\\,\\mathrm{nm}\n$$\n接下来，我们计算当前键长 $r$：\n$$\nr = |\\mathbf{r}_{12}| = \\sqrt{(0.140)^2 + (0.060)^2 + (-0.020)^2}\\,\\mathrm{nm} = \\sqrt{0.0196 + 0.0036 + 0.0004}\\,\\mathrm{nm}\n$$\n$$\nr = \\sqrt{0.0236}\\,\\mathrm{nm} \\approx 0.1536229\\,\\mathrm{nm}\n$$\n由于 $r  r_0$，键被压缩。这意味着存在一个将原子推开的排斥力。\n\n我们现在计算标量力大小项 $k_b(r-r_0)$：\n$$\nk_b(r - r_0) = 1200\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2} \\times (0.1536229\\,\\mathrm{nm} - 0.154\\,\\mathrm{nm})\n$$\n$$\nk_b(r - r_0) = 1200 \\times (-0.0003771)\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1} \\approx -0.45252\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}\n$$\n现在我们计算力向量。单位向量 $\\hat{\\mathbf{r}}_{12}$ 是：\n$$\n\\hat{\\mathbf{r}}_{12} = \\frac{\\mathbf{r}_{12}}{r} = \\frac{(0.140, 0.060, -0.020)}{0.1536229}\n$$\n原子1上的力是：\n$$\n\\mathbf{F}_1 = k_b(r-r_0)\\hat{\\mathbf{r}}_{12} \\approx -0.45252 \\times \\frac{(0.140, 0.060, -0.020)}{0.1536229} \\approx (-0.41237, -0.17673, 0.05891)\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}\n$$\n这个力的方向与 $\\mathbf{r}_{12}$ 相反，将原子1推离原子2。\n\n原子2上的力是：\n$$\n\\mathbf{F}_2 = -\\mathbf{F}_1 \\approx (0.41237, 0.17673, -0.05891)\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}\n$$\n这个力的方向与 $\\mathbf{r}_{12}$ 相同，将原子2推离原子1。\n\n每个原子上所受力的大小为：\n$$\n|\\mathbf{F}_1| = |\\mathbf{F}_2| = |k_b(r-r_0)| \\approx |-0.45252|\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1} \\approx 0.4525\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}.\n$$\n$\\mathbf{F}_1$ 的方向沿着 $-\\hat{\\mathbf{r}}_{12}$，而 $\\mathbf{F}_2$ 的方向沿着 $\\hat{\\mathbf{r}}_{12}$。\n\n按照要求将力分量四舍五入到四位有效数字：\n$F_{1x} = -0.4124\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}$\n$F_{1y} = -0.1767\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}$\n$F_{1z} = 0.05891\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}$\n$F_{2x} = 0.4124\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}$\n$F_{2y} = 0.1767\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}$\n$F_{2z} = -0.05891\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-1}$\n\n最终答案是有序六元组 $(F_{1x}, F_{1y}, F_{1z}, F_{2x}, F_{2y}, F_{2z})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.4124  -0.1767  0.05891  0.4124  0.1767  -0.05891\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在从势能推导作用力的概念基础上，本练习将转向更复杂的三体角相互作用。你将探索与角坐标相关的广义力（扭矩）的推导，以及关键的一步：如何将这个扭矩转化为作用于三个相关原子的特定笛卡尔坐标力。这个推导过程是在任何分子动力学模拟中实现角势的核心。",
            "id": "3399268",
            "problem": "考虑经典分子动力学 (MD) 中的一个三原子键角相互作用，该作用由标记为 $A$、$B$ 和 $C$ 的原子定义，它们在三维空间中的笛卡尔坐标分别为 $\\mathbf{r}_{A}$、$\\mathbf{r}_{B}$ 和 $\\mathbf{r}_{C}$。键矢量为 $\\mathbf{r}_{AB} = \\mathbf{r}_{A} - \\mathbf{r}_{B}$ 和 $\\mathbf{r}_{CB} = \\mathbf{r}_{C} - \\mathbf{r}_{B}$，它们相应的单位矢量为 $\\mathbf{u} = \\mathbf{r}_{AB} / \\|\\mathbf{r}_{AB}\\|$ 和 $\\mathbf{v} = \\mathbf{r}_{CB} / \\|\\mathbf{r}_{CB}\\|$。中心原子 $B$ 处的键角定义为 $\\theta = \\arccos(\\mathbf{u} \\cdot \\mathbf{v})$。键合角相互作用势由 $U(\\theta) = \\frac{1}{2} k_{\\theta} (\\theta - \\theta_{0})^{2}$ 给出，其中 $k_{\\theta}$ 是一个刚度参数，单位是能量每平方弧度，$\\theta_{0}$ 是以弧度为单位的平衡角。假设存在一个小偏差 $\\delta\\theta$，使得 $\\theta = \\theta_{0} + \\delta\\theta$ 且 $|\\delta\\theta| \\ll 1$。\n\n从牛顿第二定律以及与广义坐标共轭的广义力的定义出发，从第一性原理推导由偏差 $\\delta\\theta$ 引起的、与角坐标 $\\theta$ 共轭的力矩，并展示该力矩如何体现为作用于三个原子上的一组笛卡尔力。您的推导必须从应用于 $\\theta(\\mathbf{r}_{A}, \\mathbf{r}_{B}, \\mathbf{r}_{C})$ 的链式法则出发，并必须确定决定垂直于化学键的力的方向的投影算符。明确写出笛卡尔力表达式 $\\mathbf{F}_{A}$、$\\mathbf{F}_{B}$ 和 $\\mathbf{F}_{C}$，用 $\\mathbf{u}$、$\\mathbf{v}$、$\\|\\mathbf{r}_{AB}\\|$、$\\|\\mathbf{r}_{CB}\\|$ 和 $\\theta$ 表示，并确保动量守恒。\n\n答案规格：\n- 最终答案必须是关于角坐标上力矩大小的单一解析表达式，用 $k_{\\theta}$ 和 $\\delta\\theta$ 表示。\n- 角度必须以弧度处理。\n- 使用与 $k_{\\theta}$ 相同的能量单位（例如，千焦每摩尔）表示力矩。\n- 无需四舍五入。",
            "solution": "该问题要求推导对于一个三原子体系 $A-B-C$，由谐波角势 $U(\\theta) = \\frac{1}{2} k_{\\theta} (\\theta - \\theta_{0})^{2}$ 产生的力矩和笛卡尔力。推导必须从第一性原理出发，即以从势能函数推导力的形式表述的牛顿第二定律：$\\mathbf{F} = -\\nabla U$。\n\n作用在特定原子 $i$（其中 $i \\in \\{A, B, C\\}$）上的力由势能对其笛卡尔坐标 $\\mathbf{r}_{i}$ 的负梯度给出：\n$$ \\mathbf{F}_{i} = -\\nabla_{\\mathbf{r}_{i}} U(\\theta(\\mathbf{r}_{A}, \\mathbf{r}_{B}, \\mathbf{r}_{C})) $$\n使用微分的链式法则，由于势能 $U$ 是角度 $\\theta$ 的函数，而角度 $\\theta$ 又是原子位置的函数，我们得到：\n$$ \\mathbf{F}_{i} = -\\frac{dU}{d\\theta} \\nabla_{\\mathbf{r}_{i}}\\theta $$\n项 $-\\frac{dU}{d\\theta}$ 是与角坐标 $\\theta$ 共轭的广义力，也就是力矩，下文记为 $\\mathcal{T}$。我们首先计算这一项。\n给定势能 $U(\\theta) = \\frac{1}{2} k_{\\theta} (\\theta - \\theta_{0})^{2}$，其对 $\\theta$ 的导数为：\n$$ \\frac{dU}{d\\theta} = k_{\\theta} (\\theta - \\theta_{0}) $$\n因此，力矩为：\n$$ \\mathcal{T} = -\\frac{dU}{d\\theta} = -k_{\\theta} (\\theta - \\theta_{0}) $$\n问题将平衡角的偏差定义为 $\\delta\\theta = \\theta - \\theta_{0}$，所以力矩可以表示为 $\\mathcal{T} = -k_{\\theta} \\delta\\theta$。这是一个恢复力矩：如果 $\\theta > \\theta_0$ ($\\delta\\theta>0$)，力矩为负，趋向于减小 $\\theta$；如果 $\\theta  \\theta_0$ ($\\delta\\theta0$)，力矩为正，趋向于增大 $\\theta$。\n\n接下来，我们必须确定角度的梯度 $\\nabla_{\\mathbf{r}_{i}}\\theta$。角度 $\\theta$ 定义为 $\\theta = \\arccos(\\mathbf{u} \\cdot \\mathbf{v})$，其中 $\\mathbf{u} = \\frac{\\mathbf{r}_{AB}}{r_{AB}}$ 和 $\\mathbf{v} = \\frac{\\mathbf{r}_{CB}}{r_{CB}}$ 是沿键的单位矢量，且 $r_{AB} = \\|\\mathbf{r}_{A} - \\mathbf{r}_{B}\\|$ 和 $r_{CB} = \\|\\mathbf{r}_{C} - \\mathbf{r}_{B}\\|$。令 $c = \\cos\\theta = \\mathbf{u} \\cdot \\mathbf{v}$。则 $\\theta = \\arccos(c)$。\n$\\theta$ 的梯度可以再次使用链式法则求得：\n$$ \\nabla_{\\mathbf{r}_{i}}\\theta = \\frac{d\\theta}{dc} \\nabla_{\\mathbf{r}_{i}}c = -\\frac{1}{\\sqrt{1-c^2}} \\nabla_{\\mathbf{r}_{i}}(\\mathbf{u} \\cdot \\mathbf{v}) $$\n由于 $\\sin\\theta = \\sqrt{1-\\cos^2\\theta}$，且分子体系中的角度通常在 $[0, \\pi]$ 范围内，我们有 $\\sin\\theta \\ge 0$。因此，我们可以写成：\n$$ \\nabla_{\\mathbf{r}_{i}}\\theta = -\\frac{1}{\\sin\\theta} \\nabla_{\\mathbf{r}_{i}}(\\mathbf{u} \\cdot \\mathbf{v}) $$\n此表达式在 $\\theta \\neq 0$ 和 $\\theta \\neq \\pi$ 时有效。现在我们对每个原子计算点积的梯度。\n\n对于原子 A：\n$\\nabla_{\\mathbf{r}_{A}}(\\mathbf{u} \\cdot \\mathbf{v}) = (\\nabla_{\\mathbf{r}_{A}}\\mathbf{u}) \\cdot \\mathbf{v} + \\mathbf{u} \\cdot (\\nabla_{\\mathbf{r}_{A}}\\mathbf{v})$。由于 $\\mathbf{v}$ 不依赖于 $\\mathbf{r}_{A}$，第二项为零。我们需要求单位矢量 $\\mathbf{u} = (\\mathbf{r}_{A} - \\mathbf{r}_{B}) / r_{AB}$ 的导数。单位矢量 $\\hat{\\mathbf{r}} = \\mathbf{r}/\\|\\mathbf{r}\\|$ 对其位置矢量 $\\mathbf{r}$ 的梯度由张量 $\\frac{1}{\\|\\mathbf{r}\\|} (\\mathbf{I} - \\hat{\\mathbf{r}}\\otimes\\hat{\\mathbf{r}})$ 给出。由于 $\\nabla_{\\mathbf{r}_A} \\mathbf{r}_{AB} = \\mathbf{I}$，我们有：\n$$ \\nabla_{\\mathbf{r}_{A}}\\mathbf{u} = \\frac{1}{r_{AB}}(\\mathbf{I} - \\mathbf{u} \\otimes \\mathbf{u}) $$\n其中 $\\mathbf{I}$ 是单位张量，$\\otimes$ 表示外积。项 $\\mathbf{P}_{\\mathbf{u}} = (\\mathbf{I} - \\mathbf{u} \\otimes \\mathbf{u})$ 是投影算符，它将一个矢量投影到与 $\\mathbf{u}$ 正交的平面上。\n点积的梯度则为：\n$$ \\nabla_{\\mathbf{r}_{A}}(\\mathbf{u} \\cdot \\mathbf{v}) = \\left(\\frac{1}{r_{AB}}(\\mathbf{I} - \\mathbf{u} \\otimes \\mathbf{u})\\right) \\mathbf{v} = \\frac{1}{r_{AB}}(\\mathbf{v} - \\mathbf{u}(\\mathbf{u} \\cdot \\mathbf{v})) = \\frac{\\mathbf{v} - \\mathbf{u}\\cos\\theta}{r_{AB}} $$\n综合结果，角度相对于 $\\mathbf{r}_{A}$ 的梯度为：\n$$ \\nabla_{\\mathbf{r}_{A}}\\theta = -\\frac{1}{\\sin\\theta} \\frac{\\mathbf{v} - \\mathbf{u}\\cos\\theta}{r_{AB}} $$\n\n对于原子 C：\n根据对称性，交换 $A$ 和 $C$ 以及 $\\mathbf{u}$ 和 $\\mathbf{v}$ 的角色：\n$$ \\nabla_{\\mathbf{r}_{C}}\\mathbf{v} = \\frac{1}{r_{CB}}(\\mathbf{I} - \\mathbf{v} \\otimes \\mathbf{v}) $$\n这里的投影算符是 $\\mathbf{P}_{\\mathbf{v}} = (\\mathbf{I} - \\mathbf{v} \\otimes \\mathbf{v})$。\n$$ \\nabla_{\\mathbf{r}_{C}}(\\mathbf{u} \\cdot \\mathbf{v}) = \\mathbf{u} \\cdot (\\nabla_{\\mathbf{r}_{C}}\\mathbf{v}) = \\mathbf{u} \\cdot \\left(\\frac{1}{r_{CB}}(\\mathbf{I} - \\mathbf{v} \\otimes \\mathbf{v})\\right) = \\frac{1}{r_{CB}}(\\mathbf{u} - \\mathbf{v}(\\mathbf{u} \\cdot \\mathbf{v})) = \\frac{\\mathbf{u} - \\mathbf{v}\\cos\\theta}{r_{CB}} $$\n角度相对于 $\\mathbf{r}_{C}$ 的梯度为：\n$$ \\nabla_{\\mathbf{r}_{C}}\\theta = -\\frac{1}{\\sin\\theta} \\frac{\\mathbf{u} - \\mathbf{v}\\cos\\theta}{r_{CB}} $$\n\n对于原子 B：\n位置 $\\mathbf{r}_{B}$ 同时出现在 $\\mathbf{r}_{AB}$ 和 $\\mathbf{r}_{CB}$ 中。由于 $\\mathbf{r}_{AB} = \\mathbf{r}_{A}-\\mathbf{r}_{B}$ 和 $\\mathbf{r}_{CB} = \\mathbf{r}_{C}-\\mathbf{r}_{B}$，当作用于仅 $\\mathbf{r}_{AB}$ 的函数时，我们有 $\\nabla_{\\mathbf{r}_{B}} = -\\nabla_{\\mathbf{r}_{A}}$；当作用于仅 $\\mathbf{r}_{CB}$ 的函数时，我们有 $\\nabla_{\\mathbf{r}_{B}} = -\\nabla_{\\mathbf{r}_{C}}$。\n$$ \\nabla_{\\mathbf{r}_{B}}(\\mathbf{u} \\cdot \\mathbf{v}) = (\\nabla_{\\mathbf{r}_{B}}\\mathbf{u}) \\cdot \\mathbf{v} + \\mathbf{u} \\cdot (\\nabla_{\\mathbf{r}_{B}}\\mathbf{v}) = (-\\nabla_{\\mathbf{r}_{A}}\\mathbf{u}) \\cdot \\mathbf{v} + \\mathbf{u} \\cdot (-\\nabla_{\\mathbf{r}_{C}}\\mathbf{v}) = -(\\nabla_{\\mathbf{r}_{A}}(\\mathbf{u} \\cdot \\mathbf{v}) + \\nabla_{\\mathbf{r}_{C}}(\\mathbf{u} \\cdot \\mathbf{v})) $$\n这意味着 $\\nabla_{\\mathbf{r}_{B}}\\theta = -(\\nabla_{\\mathbf{r}_{A}}\\theta + \\nabla_{\\mathbf{r}_{C}}\\theta)$。\n\n现在我们使用 $\\mathbf{F}_{i} = \\mathcal{T} \\nabla_{\\mathbf{r}_{i}}\\theta = -k_{\\theta}(\\theta - \\theta_{0}) \\nabla_{\\mathbf{r}_{i}}\\theta$ 来组合每个原子上的笛卡尔力。\n\n作用于原子 A 上的力：\n$$ \\mathbf{F}_{A} = -k_{\\theta}(\\theta - \\theta_{0}) \\left(-\\frac{1}{r_{AB}\\sin\\theta}(\\mathbf{v} - \\mathbf{u}\\cos\\theta)\\right) = \\frac{k_{\\theta}(\\theta - \\theta_{0})}{r_{AB}\\sin\\theta}(\\mathbf{v} - \\mathbf{u}\\cos\\theta) $$\n这个力的方向与 $(\\mathbf{v} - \\mathbf{u}\\cos\\theta)$ 成正比，这是 $\\mathbf{v}$ 在与 $\\mathbf{u}$ 正交方向上的分量。这一点可以通过 $\\mathbf{u} \\cdot (\\mathbf{v} - \\mathbf{u}\\cos\\theta) = \\mathbf{u}\\cdot\\mathbf{v} - \\cos\\theta = \\cos\\theta - \\cos\\theta = 0$ 得到证实。因此，该力垂直于键 $A-B$。\n\n作用于原子 C 上的力：\n$$ \\mathbf{F}_{C} = -k_{\\theta}(\\theta - \\theta_{0}) \\left(-\\frac{1}{r_{CB}\\sin\\theta}(\\mathbf{u} - \\mathbf{v}\\cos\\theta)\\right) = \\frac{k_{\\theta}(\\theta - \\theta_{0})}{r_{CB}\\sin\\theta}(\\mathbf{u} - \\mathbf{v}\\cos\\theta) $$\n类似地，这个力垂直于键 $C-B$，因为 $\\mathbf{v} \\cdot (\\mathbf{u} - \\mathbf{v}\\cos\\theta) = 0$。\n\n作用于原子 B 上的力：\n$$ \\mathbf{F}_{B} = \\mathcal{T} \\nabla_{\\mathbf{r}_{B}}\\theta = \\mathcal{T} (-\\nabla_{\\mathbf{r}_{A}}\\theta - \\nabla_{\\mathbf{r}_{C}}\\theta) = -(\\mathbf{F}_{A} + \\mathbf{F}_{C}) $$\n这个结果确保了三原子体系上的净力为零，即 $\\mathbf{F}_{A} + \\mathbf{F}_{B} + \\mathbf{F}_{C} = \\mathbf{0}$，满足线性动量守恒。\n\n推导表明，与角坐标共轭的力矩 $\\mathcal{T}$ 体现为一组三个笛卡尔力 $\\mathbf{F}_A$、$\\mathbf{F}_B$ 和 $\\mathbf{F}_C$。这些力的方向垂直于各自的键矢量，由作用于相邻键单位矢量的投影算符 $\\mathbf{P}_{\\mathbf{u}}$ 和 $\\mathbf{P}_{\\mathbf{v}}$ 所决定。\n\n最后的要求是由偏差 $\\delta\\theta$ 引起的力矩的表达式。如前所述，力矩是广义力 $\\mathcal{T} = -\\frac{dU}{d\\theta}$。\n$$ \\mathcal{T} = -k_{\\theta}(\\theta - \\theta_{0}) = -k_{\\theta}\\delta\\theta $$\n问题陈述中的“力矩大小”一词被解释为广义力的带符号标量值，这是一维广义坐标的标准做法，这保留了恢复力矩的关键方向信息。",
            "answer": "$$ \\boxed{-k_{\\theta}\\delta\\theta} $$"
        },
        {
            "introduction": "理论公式在代码中实现时必须具有鲁棒性。本练习旨在解决标准谐振角势的一个关键数值问题，即在近线性分子构型下变得不稳定。通过实现并比较两种不同的势函数形式——一种基于角度 $\\theta$ 本身，另一种基于 $\\cos\\theta$——你将获得关于力场公式为何对模拟稳定性至关重要的实践性见解。",
            "id": "3399282",
            "problem": "你需要构建一个三原子测试体系，并使用两种不同的势能公式计算键合角作用力，然后比较它们在线性几何构型附近的数值行为。该体系包含三个点状粒子，其位置分别为 $\\mathbf{r}_i$、$\\mathbf{r}_j$ 和 $\\mathbf{r}_k$，它们通过向量 $\\mathbf{a} = \\mathbf{r}_i - \\mathbf{r}_j$ 和 $\\mathbf{b} = \\mathbf{r}_k - \\mathbf{r}_j$ 在原子 $j$ 处形成一个角。角度 $\\theta$ 由点积定义，其中 $\\cos\\theta = \\dfrac{\\mathbf{a}\\cdot\\mathbf{b}}{\\lVert \\mathbf{a}\\rVert \\lVert \\mathbf{b}\\rVert}$。你应该使用的基本原理是 Newton 第二定律以及保守力定义为势能的梯度：对于势能 $U$，坐标 $\\mathbf{r}$ 上受到的力为 $\\mathbf{F} = -\\nabla_{\\mathbf{r}} U$。使用链式法则，通过 $\\theta$ 或 $\\cos\\theta$ 对笛卡尔坐标的导数来表示力。\n\n考虑两种角势能公式：\n1. 以角变量 $\\theta$ 表示的谐振角势能：$U_\\theta(\\theta) = \\dfrac{k}{2}\\left(\\theta - \\theta_0\\right)^2$。\n2. 以角余弦表示的谐振势能：$U_c\\!\\left(\\cos\\theta\\right) = \\dfrac{k_c}{2}\\left(\\cos\\theta - \\cos\\theta_0\\right)^2$。\n\n你的推导应从 $\\theta$、$\\cos\\theta$ 的定义以及梯度法则 $\\mathbf{F} = -\\nabla U$ 出发，并利用链式法则为每种势能推导出作用于三个原子上的力的表达式。算法实现应避免不符合物理原理的捷径，并且必须直接反映数学推导过程。\n\n为每个测试用例构建以下测试分子几何构型：将原子 $j$ 置于原点 $\\mathbf{r}_j = (0,0,0)$，将原子 $i$ 置于 $\\mathbf{r}_i = (-1,0,0)$，并将原子 $k$ 置于 $\\mathbf{r}_k = (1,\\varepsilon,0)$，其中 $\\varepsilon$ 由各测试用例指定。当 $\\varepsilon$ 很小时，这会在原子 $j$ 处产生一个近线性的角度。位置和力使用无量纲单位，角度以弧度为单位。取 $k = 1$ 和 $k_c = 1$，$\\theta_0 = \\pi$ 且 $\\cos\\theta_0 = -1$。\n\n对于每个测试用例，计算基于 $\\theta$ 的势能和基于 $\\cos\\theta$ 的势能下，三个原子所受作用力的最大模长。具体来说，计算\n$$\nF_{\\max}^{(\\theta)} = \\max\\left(\\lVert \\mathbf{F}_i^{(\\theta)}\\rVert, \\lVert \\mathbf{F}_j^{(\\theta)}\\rVert, \\lVert \\mathbf{F}_k^{(\\theta)}\\rVert\\right),\\quad\nF_{\\max}^{(c)} = \\max\\left(\\lVert \\mathbf{F}_i^{(c)}\\rVert, \\lVert \\mathbf{F}_j^{(c)}\\rVert, \\lVert \\mathbf{F}_k^{(c)}\\rVert\\right),\n$$\n其中上标 $(\\theta)$ 和 $(c)$ 分别表示由 $U_\\theta(\\theta)$ 和 $U_c(\\cos\\theta)$ 计算出的力。\n\n测试组（无量纲 $\\varepsilon$ 值）：\n- 用例 1（完全线性）：$\\varepsilon = 0.0$。\n- 用例 2（极度接近线性）：$\\varepsilon = 10^{-9}$。\n- 用例 3（非常接近线性）：$\\varepsilon = 10^{-6}$。\n- 用例 4（接近线性）：$\\varepsilon = 10^{-3}$。\n- 用例 5（中等弯曲）：$\\varepsilon = 2\\times 10^{-1}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[F_{\\max}^{(\\theta)}\\text{(用例 1)},F_{\\max}^{(c)}\\text{(用例 1)},F_{\\max}^{(\\theta)}\\text{(用例 2)},F_{\\max}^{(c)}\\text{(用例 2)},\\dots,F_{\\max}^{(\\theta)}\\text{(用例 5)},F_{\\max}^{(c)}\\text{(用例 5)}]$。所有输出均为无量纲单位的实数（浮点数）。整个计算过程中角度必须以弧度处理。",
            "solution": "该问题要求计算并比较源自两种不同键合角势能函数的原子作用力，尤其是在近线性角度区域内的行为。此计算的基础是保守力 $\\mathbf{F}$ 与其对应势能 $U$ 之间的关系，即 $\\mathbf{F} = -\\nabla U$。该体系由三个原子组成，其位置分别为 $\\mathbf{r}_i$、$\\mathbf{r}_j$ 和 $\\mathbf{r}_k$，并在中心原子 $j$ 处形成一个角度。\n\n我们定义从中心原子 $j$ 出发的键向量为 $\\mathbf{a} = \\mathbf{r}_i - \\mathbf{r}_j$ 和 $\\mathbf{b} = \\mathbf{r}_k - \\mathbf{r}_j$。这些向量的模长为 $a = \\lVert \\mathbf{a} \\rVert$ 和 $b = \\lVert \\mathbf{b} \\rVert$，其对应的单位向量为 $\\hat{\\mathbf{a}} = \\mathbf{a}/a$ 和 $\\hat{\\mathbf{b}} = \\mathbf{b}/b$。这些向量之间的夹角 $\\theta$ 由其 cosines 值定义，即 $\\cos\\theta = \\hat{\\mathbf{a}} \\cdot \\hat{\\mathbf{b}}$。\n\n作用于某个特定原子（例如原子 $i$）的力是势能对其笛卡尔坐标的负梯度：$\\mathbf{F}_i = -\\nabla_{\\mathbf{r}_i} U$。由于两种势能函数都用角度 $\\theta$ 表示，我们必须使用链式法则。\n\n对于一个势能 $U(\\xi)$，其中 $\\xi$ 是角度的函数（$\\theta$ 或 $\\cos\\theta$），作用于原子 $i$ 的力为：\n$$\n\\mathbf{F}_i = -\\frac{dU}{d\\xi} \\nabla_{\\mathbf{r}_i} \\xi\n$$\n类似的表达式也适用于原子 $j$ 和 $k$。由于平移不变性，体系的总受力为零，因此 $\\mathbf{F}_j = -(\\mathbf{F}_i + \\mathbf{F}_k)$。这意味着我们只需要推导原子 $i$ 和 $k$ 的梯度。\n\n首先，我们推导 $\\cos\\theta$ 对原子坐标的梯度。对于原子 $i$：\n$$\n\\nabla_{\\mathbf{r}_i} \\cos\\theta = \\nabla_{\\mathbf{r}_i} \\left( \\frac{\\mathbf{a} \\cdot \\mathbf{b}}{ab} \\right)\n$$\n利用向量微积分的乘法法则以及恒等式 $\\nabla_{\\mathbf{r}_i} \\mathbf{a} = I$（单位矩阵）、$\\nabla_{\\mathbf{r}_i} \\mathbf{b} = 0$、$\\nabla_{\\mathbf{r}_i} a = \\hat{\\mathbf{a}}$ 和 $\\nabla_{\\mathbf{r}_i} b = \\mathbf{0}$，我们得到：\n$$\n\\nabla_{\\mathbf{r}_i} \\cos\\theta = \\frac{1}{ab} (\\nabla_{\\mathbf{r}_i}(\\mathbf{a} \\cdot \\mathbf{b})) + (\\mathbf{a} \\cdot \\mathbf{b}) \\nabla_{\\mathbf{r}_i}((ab)^{-1}) = \\frac{\\mathbf{b}}{ab} - \\frac{\\mathbf{a} \\cdot \\mathbf{b}}{a^3b} \\mathbf{a} = \\frac{1}{a} \\left(\\frac{\\mathbf{b}}{b} - \\frac{\\mathbf{a} \\cdot \\mathbf{b}}{ab} \\frac{\\mathbf{a}}{a}\\right) = \\frac{\\hat{\\mathbf{b}} - (\\cos\\theta)\\hat{\\mathbf{a}}}{a}\n$$\n根据对称性，交换 $i \\leftrightarrow k$ 和 $\\mathbf{a} \\leftrightarrow \\mathbf{b}$：\n$$\n\\nabla_{\\mathbf{r}_k} \\cos\\theta = \\frac{\\hat{\\mathbf{a}} - (\\cos\\theta)\\hat{\\mathbf{b}}}{b}\n$$\n对于所有非共线和非重合的构型，这些表达式都是良定义的。\n\n现在我们可以写出两种势能形式下的力。\n\n1.  **谐振余弦势能**：$U_c = \\dfrac{k_c}{2}(\\cos\\theta - \\cos\\theta_0)^2$。\n    这里，$\\xi = \\cos\\theta$。其对 $\\xi$ 的导数为 $\\frac{dU_c}{d(\\cos\\theta)} = k_c(\\cos\\theta - \\cos\\theta_0)$。\n    作用于原子 $i$ 和 $k$ 的力为：\n    $$\n    \\mathbf{F}_i^{(c)} = -k_c(\\cos\\theta - \\cos\\theta_0) \\nabla_{\\mathbf{r}_i} \\cos\\theta = -k_c(\\cos\\theta - \\cos\\theta_0) \\frac{\\hat{\\mathbf{b}} - (\\cos\\theta)\\hat{\\mathbf{a}}}{a}\n    $$\n    $$\n    \\mathbf{F}_k^{(c)} = -k_c(\\cos\\theta - \\cos\\theta_0) \\nabla_{\\mathbf{r}_k} \\cos\\theta = -k_c(\\cos\\theta - \\cos\\theta_0) \\frac{\\hat{\\mathbf{a}} - (\\cos\\theta)\\hat{\\mathbf{b}}}{b}\n    $$\n    这些力的表达式在计算上是稳定的，包括在 $\\theta = 0$ 或 $\\theta = \\pi$ 的线性几何构型下。在平衡角 $\\theta_0=\\pi$ 处，项 $(\\cos\\theta - \\cos\\theta_0)$ 变为零，所有力都消失，这在物理上是正确的。\n\n2.  **谐振角势能**：$U_\\theta = \\dfrac{k}{2}(\\theta - \\theta_0)^2$。\n    这里，$\\xi = \\theta$。其导数为 $\\frac{dU_\\theta}{d\\theta} = k(\\theta - \\theta_0)$。$\\theta$ 的梯度可以通过再次应用链式法则找到：$\\nabla \\theta = \\frac{d\\theta}{d(\\cos\\theta)} \\nabla\\cos\\theta = \\frac{-1}{\\sin\\theta} \\nabla\\cos\\theta$。\n    作用于原子 $i$ 和 $k$ 的力为：\n    $$\n    \\mathbf{F}_i^{(\\theta)} = -k(\\theta - \\theta_0) \\nabla_{\\mathbf{r}_i} \\theta = -k(\\theta - \\theta_0) \\left( \\frac{-1}{\\sin\\theta} \\nabla_{\\mathbf{r}_i} \\cos\\theta \\right) = \\frac{k(\\theta - \\theta_0)}{\\sin\\theta} \\nabla_{\\mathbf{r}_i} \\cos\\theta\n    $$\n    $$\n    \\mathbf{F}_k^{(\\theta)} = \\frac{k(\\theta - \\theta_0)}{\\sin\\theta} \\nabla_{\\mathbf{r}_k} \\cos\\theta\n    $$\n    项 $1/\\sin\\theta$ 在 $\\sin\\theta=0$ 的线性几何构型（$\\theta=0$ 或 $\\theta=\\pi$）处引入了一个奇点。对于指定的平衡角 $\\theta_0 = \\pi$，当 $\\theta \\to \\pi$ 时，分子 $k(\\theta - \\theta_0)$ 也趋于零。这会产生一个 $0/0$ 的不定式。虽然其解析极限存在，但通过 `(arccos(c) - pi) / sqrt(1 - c*c)` 进行数值计算可能会导致灾难性抵消和浮点误差，使得该公式在数值上不稳定。\n\n对于几何构型完全线性（$\\varepsilon=0$）的特殊情况，我们有 $\\theta=\\pi=\\theta_0$。对于 $U_c$ 和 $U_\\theta$ 两种势能，体系都处于其势能最小值。能量为零，能量的梯度（因此所有原子上的力）也必须为零。实现在这种情况下会显式地将力设置为零。对于 $\\varepsilon > 0$ 的情况，直接应用推导出的公式来计算力和它们的最大模长。在线性几何构型附近（$\\varepsilon \\to 0$）的标度行为显示 $|\\mathbf{F}^{(\\theta)}| \\sim \\varepsilon$ 而 $|\\mathbf{F}^{(c)}| \\sim \\varepsilon^3$，这突显了基于 $\\theta$ 的势能在偏离线性构型很小时所施加的不符合物理原理的扭矩。\n\n对于每个 $\\varepsilon$ 值，算法按以下步骤进行：\n1.  定义原子位置 $\\mathbf{r}_i, \\mathbf{r}_j, \\mathbf{r}_k$。\n2.  如果 $\\varepsilon=0$，则力为零。返回 $F_{\\max}^{(\\theta)}=0$ 和 $F_{\\max}^{(c)}=0$。\n3.  如果 $\\varepsilon>0$，计算键向量 $\\mathbf{a}, \\mathbf{b}$、它们的模长 $a, b$ 和单位向量 $\\hat{\\mathbf{a}}, \\hat{\\mathbf{b}}$。\n4.  计算 $\\cos\\theta = \\hat{\\mathbf{a}} \\cdot \\hat{\\mathbf{b}}$，然后计算 $\\theta = \\arccos(\\cos\\theta)$ 和 $\\sin\\theta = \\sqrt{1 - \\cos^2\\theta}$。\n5.  计算 $\\cos\\theta$ 相对于 $\\mathbf{r}_i$ 和 $\\mathbf{r}_k$ 的梯度。\n6.  对于 $U_c$ 势能，计算力 $\\mathbf{F}_i^{(c)}$、$\\mathbf{F}_k^{(c)}$ 和 $\\mathbf{F}_j^{(c)} = -(\\mathbf{F}_i^{(c)} + \\mathbf{F}_k^{(c)})$。\n7.  对于 $U_\\theta$ 势能，计算力 $\\mathbf{F}_i^{(\\theta)}$、$\\mathbf{F}_k^{(\\theta)}$ 和 $\\mathbf{F}_j^{(\\theta)} = -(\\mathbf{F}_i^{(\\theta)} + \\mathbf{F}_k^{(\\theta)})$。\n8.  计算所有力向量的欧几里得范数，并找出每种势能类型的最大模长 $F_{\\max}^{(c)}$ 和 $F_{\\max}^{(\\theta)}$。\n然后收集并格式化所有测试用例的结果。",
            "answer": "```\n[0.0,0.0,9.999999995026955e-10,5e-28,9.999999995026955e-07,4.999999999999999e-19,0.0009999995026955034,4.999999999999999e-10,0.1986916327310933,0.0196078431372549]\n```"
        }
    ]
}