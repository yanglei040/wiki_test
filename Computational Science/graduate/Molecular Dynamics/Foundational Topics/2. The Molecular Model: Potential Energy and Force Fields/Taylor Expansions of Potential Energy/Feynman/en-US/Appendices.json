{
    "hands_on_practices": [
        {
            "introduction": "The Taylor expansion provides the essential mathematical bridge from a complex potential energy function to the intuitive physical model of atoms connected by springs. This foundational exercise provides direct, hands-on experience in deriving the parameters of this model—such as the harmonic spring constant and the leading anharmonic corrections—from the widely-used Lennard-Jones potential. By computing these terms directly, you will build a concrete understanding of how macroscopic properties and vibrational behavior emerge from the microscopic details of interatomic interactions .",
            "id": "3451240",
            "problem": "In Molecular Dynamics (MD), small-amplitude vibrations around equilibrium separations are often analyzed by expanding the pair potential in a Taylor series about its minimum. Consider the Lennard–Jones pair potential $u(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^6\\right]$, which has its minimum at $r_0=2^{1/6}\\sigma$. Define the Taylor expansion of $u(r)$ about $r_0$ in powers of $\\Delta r = r - r_0$ by\n$$\nu(r) \\approx \\sum_{n=0}^{4} a_n \\, (\\Delta r)^{n},\n$$\nwhere $a_n = u^{(n)}(r_0)/n!$ and $u^{(n)}$ denotes the $n$-th derivative with respect to $r$. Starting from the fundamental definition of the Taylor series and the given Lennard–Jones potential, compute the coefficients $a_0$, $a_1$, $a_2$, $a_3$, and $a_4$ in closed form, simplifying your expressions using $\\epsilon$ and $r_0$.\n\nThen, from first principles, interpret the physical meaning of the quadratic term (associated with $a_2$) and the quartic term (associated with $a_4$) within the context of small-amplitude vibrations and the harmonic versus anharmonic approximations in MD.\n\nProvide the final numerical-symbolic coefficients $(a_0, a_1, a_2, a_3, a_4)$ as a single row matrix in your final answer. No units are required for the final answer.",
            "solution": "The problem requires the computation of the first five coefficients of the Taylor series expansion of the Lennard-Jones (LJ) potential, $u(r)$, around its minimum, $r_0$, and a physical interpretation of the quadratic and quartic terms.\n\nThe LJ potential is given by:\n$$\nu(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]\n$$\nThe minimum of this potential occurs at $r_0 = 2^{1/6}\\sigma$. This relation allows us to express the parameter $\\sigma$ in terms of the equilibrium separation $r_0$:\n$$\n\\sigma^6 = \\frac{r_0^6}{2} \\quad \\text{and} \\quad \\sigma^{12} = \\frac{r_0^{12}}{4}\n$$\nSubstituting these into the potential expression provides a form more convenient for differentiation with respect to $r$ and evaluation at $r_0$:\n$$\nu(r) = 4\\epsilon\\left[\\frac{r_0^{12}}{4r^{12}} - \\frac{r_0^6}{2r^6}\\right] = \\epsilon\\left[\\left(\\frac{r_0}{r}\\right)^{12} - 2\\left(\\frac{r_0}{r}\\right)^6\\right]\n$$\nThe Taylor expansion coefficients $a_n$ are defined by $a_n = \\frac{u^{(n)}(r_0)}{n!}$, where $u^{(n)}(r_0)$ is the $n$-th derivative of $u(r)$ evaluated at $r=r_0$. We will now compute these derivatives up to $n=4$.\n\nFor $n=0$: The coefficient $a_0$ is the value of the potential at the minimum.\n$$\nu^{(0)}(r) = u(r) = \\epsilon\\left[r_0^{12}r^{-12} - 2r_0^6r^{-6}\\right]\n$$\n$$\nu(r_0) = \\epsilon\\left[r_0^{12}r_0^{-12} - 2r_0^6r_0^{-6}\\right] = \\epsilon(1-2) = -\\epsilon\n$$\n$$\na_0 = \\frac{u(r_0)}{0!} = -\\epsilon\n$$\nThis represents the depth of the potential well, or the dissociation energy of the pair.\n\nFor $n=1$: The coefficient $a_1$ is determined by the first derivative.\n$$\nu^{(1)}(r) = \\frac{du}{dr} = \\epsilon\\left[r_0^{12}(-12r^{-13}) - 2r_0^6(-6r^{-7})\\right] = \\epsilon\\left[-12r_0^{12}r^{-13} + 12r_0^6r^{-7}\\right]\n$$\n$$\nu^{(1)}(r_0) = \\epsilon\\left[-12r_0^{12}r_0^{-13} + 12r_0^6r_0^{-7}\\right] = \\frac{12\\epsilon}{r_0}(-1+1) = 0\n$$\n$$\na_1 = \\frac{u^{(1)}(r_0)}{1!} = 0\n$$\nThis result is expected, as the first derivative of any function at a minimum (or any extremum) is zero. This signifies that there is no net force at the equilibrium separation.\n\nFor $n=2$: The coefficient $a_2$ is determined by the second derivative.\n$$\nu^{(2)}(r) = \\frac{d^2u}{dr^2} = \\epsilon\\left[-12r_0^{12}(-13r^{-14}) + 12r_0^6(-7r^{-8})\\right] = \\epsilon\\left[156r_0^{12}r^{-14} - 84r_0^6r^{-8}\\right]\n$$\n$$\nu^{(2)}(r_0) = \\epsilon\\left[156r_0^{12}r_0^{-14} - 84r_0^6r_0^{-8}\\right] = \\frac{\\epsilon}{r_0^2}(156 - 84) = \\frac{72\\epsilon}{r_0^2}\n$$\n$$\na_2 = \\frac{u^{(2)}(r_0)}{2!} = \\frac{1}{2}\\frac{72\\epsilon}{r_0^2} = \\frac{36\\epsilon}{r_0^2}\n$$\n\nFor $n=3$: The coefficient $a_3$ is determined by the third derivative.\n$$\nu^{(3)}(r) = \\frac{d^3u}{dr^3} = \\epsilon\\left[156r_0^{12}(-14r^{-15}) - 84r_0^6(-8r^{-9})\\right] = \\epsilon\\left[-2184r_0^{12}r^{-15} + 672r_0^6r^{-9}\\right]\n$$\n$$\nu^{(3)}(r_0) = \\epsilon\\left[-2184r_0^{12}r_0^{-15} + 672r_0^6r_0^{-9}\\right] = \\frac{\\epsilon}{r_0^3}(-2184 + 672) = -\\frac{1512\\epsilon}{r_0^3}\n$$\n$$\na_3 = \\frac{u^{(3)}(r_0)}{3!} = \\frac{1}{6}\\left(-\\frac{1512\\epsilon}{r_0^3}\\right) = -\\frac{252\\epsilon}{r_0^3}\n$$\n\nFor $n=4$: The coefficient $a_4$ is determined by the fourth derivative.\n$$\nu^{(4)}(r) = \\frac{d^4u}{dr^4} = \\epsilon\\left[-2184r_0^{12}(-15r^{-16}) + 672r_0^6(-9r^{-10})\\right] = \\epsilon\\left[32760r_0^{12}r^{-16} - 6048r_0^6r^{-10}\\right]\n$$\n$$\nu^{(4)}(r_0) = \\epsilon\\left[32760r_0^{12}r_0^{-16} - 6048r_0^6r_0^{-10}\\right] = \\frac{\\epsilon}{r_0^4}(32760 - 6048) = \\frac{26712\\epsilon}{r_0^4}\n$$\n$$\na_4 = \\frac{u^{(4)}(r_0)}{4!} = \\frac{1}{24}\\left(\\frac{26712\\epsilon}{r_0^4}\\right) = \\frac{1113\\epsilon}{r_0^4}\n$$\n\nThe Taylor expansion of the potential up to the fourth order is thus:\n$$\nu(r) \\approx -\\epsilon + \\frac{36\\epsilon}{r_0^2}(\\Delta r)^2 - \\frac{252\\epsilon}{r_0^3}(\\Delta r)^3 + \\frac{1113\\epsilon}{r_0^4}(\\Delta r)^4\n$$\n\nPhysical Interpretation of the Quadratic ($a_2$) and Quartic ($a_4$) Terms:\n\nThe expansion of the potential energy $u(r)$ around its minimum is fundamental to understanding molecular vibrations.\nThe force on a particle is given by $F(r) = -u'(r)$. Expanding this force in a Taylor series around $r_0$ for a small displacement $\\Delta r = r - r_0$ gives:\n$$\nF(r) = -u'(r_0) - u''(r_0)\\Delta r - \\frac{u'''(r_0)}{2}(\\Delta r)^2 - \\dots\n$$\nSince $u'(r_0) = 0$, the leading term in the force is:\n$$\nF(r) \\approx -u''(r_0)\\Delta r = -2a_2\\Delta r\n$$\nThis is the mathematical form of Hooke's Law, $F = -k_s x$, where $k_s = u''(r_0) = 2a_2 = 72\\epsilon/r_0^2$ is the force constant or \"spring stiffness\" of the effective bond. The potential energy associated with this force is $u(r) - u(r_0) \\approx a_2(\\Delta r)^2 = \\frac{1}{2}k_s(\\Delta r)^2$, which is the potential for a simple harmonic oscillator (SHO). Therefore, the quadratic term, governed by $a_2$, represents the **harmonic approximation** of the interatomic potential. This approximation models the bond as an ideal spring and is accurate for infinitesimally small vibrations around the equilibrium position. It describes oscillations with a frequency independent of the amplitude.\n\nThe cubic ($a_3$) and quartic ($a_4$) terms represent the lowest-order **anharmonic corrections** to the potential. Real molecular bonds are not ideal springs, and their behavior deviates from the SHO model, especially at larger vibrational amplitudes. This deviation is known as anharmonicity.\nThe cubic term, $a_3(\\Delta r)^3$, introduces an asymmetry into the potential well. Since $a_3$ is negative for the LJ potential, the potential rises more steeply for compression ($\\Delta r  0$) than for expansion ($\\Delta r  0$). This asymmetry is the microscopic origin of thermal expansion, a phenomenon that cannot be explained by the symmetric harmonic model.\nThe quartic term, $a_4(\\Delta r)^4$, is the next even-powered correction after the harmonic term. It modifies the curvature of the potential well away from the minimum. Since $a_4$ is positive, it makes the potential well steeper and \"narrower\" at larger displacements than the pure harmonic parabola would suggest. This term, along with the cubic term, affects the vibrational frequency, causing it to depend on the amplitude of oscillation. The quartic term is a crucial component in describing the true shape of the potential for non-infinitesimal displacements and is essential for accurately modeling properties that depend on the details of the potential shape, such as heat capacity at high temperatures and phononic interactions. In summary, the quartic term provides the leading symmetric correction for the anharmonicity of the bond, refining the spring constant for larger-amplitude vibrations.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\epsilon  0  \\frac{36\\epsilon}{r_0^2}  -\\frac{252\\epsilon}{r_0^3}  \\frac{1113\\epsilon}{r_0^4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While the harmonic approximation is a cornerstone of molecular modeling, a rigorous scientist must understand its limits of validity. This practice moves beyond simple approximation to formal quantification, challenging you to derive the worst-case error bounds for both the potential energy and the forces when a Taylor expansion is truncated at second order. Completing this derivation will equip you with the formal mathematical tools to reason about the accuracy of simplified models, a crucial skill for developing and validating new theories in molecular science .",
            "id": "3451222",
            "problem": "Consider a system of $N$ particles in Molecular Dynamics (MD), whose configuration is represented by a vector $\\mathbf{r} \\in \\mathbb{R}^{3N}$. Let the potential energy be a scalar field $U: \\mathbb{R}^{3N} \\to \\mathbb{R}$ that is three times continuously differentiable in an open neighborhood of a reference configuration $\\mathbf{r}_{0}$. Denote the displacement by $\\mathbf{h} = \\mathbf{r} - \\mathbf{r}_{0}$ and assume typical displacements satisfy $\\|\\mathbf{h}\\| \\le \\epsilon$, where $\\|\\cdot\\|$ is the Euclidean norm on $\\mathbb{R}^{3N}$. Define the force by $\\mathbf{F}(\\mathbf{r}) = -\\nabla U(\\mathbf{r})$. The second-order Taylor truncation of the potential about $\\mathbf{r}_{0}$ is\n$$\nU^{(2)}(\\mathbf{r}) = U(\\mathbf{r}_{0}) + \\nabla U(\\mathbf{r}_{0}) \\cdot \\mathbf{h} + \\frac{1}{2}\\,\\mathbf{h}^{\\top} \\nabla^{2} U(\\mathbf{r}_{0}) \\mathbf{h},\n$$\nand the corresponding truncated force is $\\mathbf{F}^{(2)}(\\mathbf{r}) = -\\nabla U^{(2)}(\\mathbf{r}) = -\\nabla U(\\mathbf{r}_{0}) - \\nabla^{2} U(\\mathbf{r}_{0})\\,\\mathbf{h}$.\n\nAssume there exists a finite bound $M_{3}$ such that for all $\\mathbf{x}$ with $\\|\\mathbf{x} - \\mathbf{r}_{0}\\| \\le \\epsilon$, the third derivative tensor $D^{3}U(\\mathbf{x})$ satisfies\n$$\n\\|D^{3}U(\\mathbf{x})\\| \\le M_{3},\n$$\nwhere $\\|D^{3}U(\\mathbf{x})\\|$ denotes the operator norm of the trilinear form induced by the Euclidean norm,\n$$\n\\|D^{3}U(\\mathbf{x})\\| \\equiv \\sup_{\\|\\mathbf{u}\\|=\\|\\mathbf{v}\\|=\\|\\mathbf{w}\\|=1} \\left| D^{3}U(\\mathbf{x})[\\mathbf{u},\\mathbf{v},\\mathbf{w}] \\right|.\n$$\n\nStarting from the definitions of gradient, Hessian, and the multivariate Taylor theorem with integral remainder, and using only these as foundational tools, derive worst-case upper bounds on:\n- the absolute truncation error in the potential energy, $\\left|U(\\mathbf{r}) - U^{(2)}(\\mathbf{r})\\right|$,\n- the magnitude of the truncation error in the force, $\\|\\mathbf{F}(\\mathbf{r}) - \\mathbf{F}^{(2)}(\\mathbf{r})\\|$,\nvalid for all $\\mathbf{r}$ with $\\|\\mathbf{r} - \\mathbf{r}_{0}\\| \\le \\epsilon$, expressed in terms of $\\epsilon$ and $M_{3}$.\n\nUse the Euclidean norm throughout and the operator norms induced by it. Clearly state any intermediate steps used to connect the Taylor remainder to the stated bounds. Provide the final answer as a row matrix whose first entry is the bound on the worst-case absolute energy error and whose second entry is the bound on the worst-case force error magnitude, each as a closed-form analytic expression in terms of $\\epsilon$ and $M_{3}$. Express energy in Joules and force in Newtons. Do not substitute numerical values and do not include any units in your final boxed expressions. No rounding is required.",
            "solution": "The problem statement is parsed and validated. It is found to be scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. The problem is a standard application of multivariate Taylor's theorem in the context of classical mechanics. No flaws are identified. We may proceed with the derivation.\n\nThe core of the problem is to bound the remainder terms of Taylor expansions for the potential energy $U(\\mathbf{r})$ and the force $\\mathbf{F}(\\mathbf{r})$. Let $\\mathbf{h} = \\mathbf{r} - \\mathbf{r}_0$. We are given that $\\|\\mathbf{h}\\| \\le \\epsilon$.\n\n**Part 1: Worst-Case Upper Bound on the Potential Energy Error**\n\nThe potential energy $U(\\mathbf{r})$ is a scalar field $U: \\mathbb{R}^{3N} \\to \\mathbb{R}$ that is three times continuously differentiable ($C^3$) in a neighborhood of $\\mathbf{r}_0$. According to a version of Taylor's theorem, we can express $U(\\mathbf{r})$ as its second-order Taylor polynomial about $\\mathbf{r}_0$ plus a remainder term. The specified truncated potential, $U^{(2)}(\\mathbf{r})$, is precisely this second-order Taylor polynomial:\n$$\nU^{(2)}(\\mathbf{r}) = U(\\mathbf{r}_{0}) + \\nabla U(\\mathbf{r}_{0}) \\cdot \\mathbf{h} + \\frac{1}{2}\\,\\mathbf{h}^{\\top} (\\nabla^{2} U(\\mathbf{r}_{0})) \\mathbf{h}\n$$\nThe full Taylor expansion is $U(\\mathbf{r}) = U^{(2)}(\\mathbf{r}) + R_2(\\mathbf{r})$, where $R_2(\\mathbf{r})$ is the remainder term. The truncation error in the potential energy is therefore $|U(\\mathbf{r}) - U^{(2)}(\\mathbf{r})| = |R_2(\\mathbf{r})|$.\n\nThe problem requires using the integral form of the remainder. For a $C^3$ function, the second-order remainder $R_2$ is given by:\n$$\nR_2(\\mathbf{r}) = \\int_0^1 \\frac{(1-t)^2}{2!} D^3 U(\\mathbf{r}_0 + t\\mathbf{h})[\\mathbf{h},\\mathbf{h},\\mathbf{h}] \\,dt\n$$\nwhere $D^3 U(\\mathbf{x})[\\mathbf{u},\\mathbf{v},\\mathbf{w}]$ is the third-order directional derivative, representing the action of the third derivative tensor (a trilinear form) on the vectors $\\mathbf{u}$, $\\mathbf{v}$, and $\\mathbf{w}$.\n\nTo find an upper bound for the absolute error, we take the absolute value of $R_2(\\mathbf{r})$ and use the triangle inequality for integrals:\n$$\n|R_2(\\mathbf{r})| = \\left| \\int_0^1 \\frac{(1-t)^2}{2} D^3 U(\\mathbf{r}_0 + t\\mathbf{h})[\\mathbf{h},\\mathbf{h},\\mathbf{h}] \\,dt \\right| \\le \\int_0^1 \\left| \\frac{(1-t)^2}{2} D^3 U(\\mathbf{r}_0 + t\\mathbf{h})[\\mathbf{h},\\mathbf{h},\\mathbf{h}] \\right| \\,dt\n$$\nSince $t \\in [0,1]$, the term $\\frac{(1-t)^2}{2}$ is non-negative.\n$$\n|R_2(\\mathbf{r})| \\le \\int_0^1 \\frac{(1-t)^2}{2} |D^3 U(\\mathbf{r}_0 + t\\mathbf{h})[\\mathbf{h},\\mathbf{h},\\mathbf{h}]| \\,dt\n$$\nThe definition of the operator norm for a trilinear form $A$ is $\\|A\\| = \\sup_{\\|\\mathbf{u}\\|=\\|\\mathbf{v}\\|=\\|\\mathbf{w}\\|=1} |A[\\mathbf{u},\\mathbf{v},\\mathbf{w}]|$. This implies the general inequality $|A[\\mathbf{u},\\mathbf{v},\\mathbf{w}]| \\le \\|A\\| \\|\\mathbf{u}\\| \\|\\mathbf{v}\\| \\|\\mathbf{w}\\|$. Applying this to $D^3 U$, we get:\n$$\n|D^3 U(\\mathbf{x})[\\mathbf{h},\\mathbf{h},\\mathbf{h}]| \\le \\|D^3 U(\\mathbf{x})\\| \\|\\mathbf{h}\\| \\|\\mathbf{h}\\| \\|\\mathbf{h}\\| = \\|D^3 U(\\mathbf{x})\\| \\|\\mathbf{h}\\|^3\n$$\nThe problem states that for all $\\mathbf{x}$ such that $\\|\\mathbf{x} - \\mathbf{r}_0\\| \\le \\epsilon$, we have an upper bound $\\|D^3 U(\\mathbf{x})\\| \\le M_3$. For any $t \\in [0,1]$, the point $\\mathbf{x}(t) = \\mathbf{r}_0 + t\\mathbf{h}$ lies on the line segment between $\\mathbf{r}_0$ and $\\mathbf{r}$. Its distance from $\\mathbf{r}_0$ is $\\|\\mathbf{x}(t) - \\mathbf{r}_0\\| = \\|t\\mathbf{h}\\| = t\\|\\mathbf{h}\\|$. Since $t \\le 1$ and we are considering $\\|\\mathbf{h}\\| \\le \\epsilon$, it follows that $t\\|\\mathbf{h}\\| \\le \\epsilon$. Thus, the bound $M_3$ applies to the third derivative tensor at every point along the integration path.\n$$\n\\|D^3 U(\\mathbf{r}_0 + t\\mathbf{h})\\| \\le M_3 \\quad \\text{for } t \\in [0,1]\n$$\nSubstituting this into the integral inequality:\n$$\n|R_2(\\mathbf{r})| \\le \\int_0^1 \\frac{(1-t)^2}{2} M_3 \\|\\mathbf{h}\\|^3 \\,dt\n$$\nThe terms $M_3$ and $\\|\\mathbf{h}\\|^3$ are constant with respect to the integration variable $t$, so we can move them outside the integral:\n$$\n|R_2(\\mathbf{r})| \\le \\frac{M_3 \\|\\mathbf{h}\\|^3}{2} \\int_0^1 (1-t)^2 \\,dt\n$$\nThe integral evaluates to:\n$$\n\\int_0^1 (1-t)^2 \\,dt = \\left[ -\\frac{(1-t)^3}{3} \\right]_0^1 = \\left( -\\frac{(1-1)^3}{3} \\right) - \\left( -\\frac{(1-0)^3}{3} \\right) = 0 - \\left(-\\frac{1}{3}\\right) = \\frac{1}{3}\n$$\nSubstituting this result back, we obtain the bound for a given displacement $\\mathbf{h}$:\n$$\n|U(\\mathbf{r}) - U^{(2)}(\\mathbf{r})| \\le \\frac{M_3 \\|\\mathbf{h}\\|^3}{6}\n$$\nThe problem asks for the worst-case upper bound for all $\\mathbf{r}$ such that $\\|\\mathbf{r} - \\mathbf{r}_0\\| \\le \\epsilon$, which is equivalent to $\\|\\mathbf{h}\\| \\le \\epsilon$. The expression $\\frac{M_3 \\|\\mathbf{h}\\|^3}{6}$ is a monotonically increasing function of $\\|\\mathbf{h}\\|$. Therefore, the maximum value is attained when $\\|\\mathbf{h}\\|$ is at its maximum, i.e., $\\|\\mathbf{h}\\| = \\epsilon$.\nThe worst-case upper bound on the absolute energy error is $\\frac{M_3 \\epsilon^3}{6}$.\n\n**Part 2: Worst-Case Upper Bound on the Force Error Magnitude**\n\nThe force is the negative gradient of the potential, $\\mathbf{F}(\\mathbf{r}) = -\\nabla U(\\mathbf{r})$. The truncated force is $\\mathbf{F}^{(2)}(\\mathbf{r}) = -\\nabla U^{(2)}(\\mathbf{r})$.\n$$\n\\mathbf{F}^{(2)}(\\mathbf{r}) = -\\nabla_{\\mathbf{r}} \\left( U(\\mathbf{r}_{0}) + \\nabla U(\\mathbf{r}_{0}) \\cdot (\\mathbf{r}-\\mathbf{r}_0) + \\frac{1}{2}\\,(\\mathbf{r}-\\mathbf{r}_0)^{\\top} (\\nabla^{2} U(\\mathbf{r}_{0})) (\\mathbf{r}-\\mathbf{r}_0) \\right)\n$$\nUsing $\\nabla_\\mathbf{r} (\\mathbf{r}-\\mathbf{r}_0) = \\mathbf{I}$ (the identity matrix) and $\\nabla_\\mathbf{r} ((\\mathbf{r}-\\mathbf-r_0)^T A (\\mathbf{r}-\\mathbf{r}_0)) = 2 A (\\mathbf{r}-\\mathbf{r}_0)$ for a symmetric matrix $A$, we get:\n$$\n\\mathbf{F}^{(2)}(\\mathbf{r}) = -\\left( \\mathbf{0} + \\nabla U(\\mathbf{r}_{0}) + \\nabla^{2} U(\\mathbf{r}_{0}) (\\mathbf{r}-\\mathbf{r}_0) \\right) = -\\nabla U(\\mathbf{r}_{0}) - (\\nabla^{2} U(\\mathbf{r}_{0})) \\mathbf{h}\n$$\nThis expression is the first-order Taylor expansion of the vector field $\\mathbf{F}(\\mathbf{r})$ around $\\mathbf{r}_0$, because $\\mathbf{F}(\\mathbf{r}_0) = -\\nabla U(\\mathbf{r}_0)$ and the Jacobian of $\\mathbf{F}$ is $D\\mathbf{F}(\\mathbf{r}) = -\\nabla^2 U(\\mathbf{r})$.\nThe truncation error in the force is $\\mathbf{F}(\\mathbf{r}) - \\mathbf{F}^{(2)}(\\mathbf{r})$, which is the remainder term $R_1^{\\mathbf{F}}(\\mathbf{r})$ of the first-order Taylor expansion of $\\mathbf{F}(\\mathbf{r})$.\nUsing the integral form of the remainder for a vector-valued function:\n$$\nR_1^{\\mathbf{F}}(\\mathbf{r}) = \\int_0^1 (1-t) D^2\\mathbf{F}(\\mathbf{r}_0 + t\\mathbf{h})[\\mathbf{h},\\mathbf{h}] \\,dt\n$$\nHere, $D^2\\mathbf{F}(\\mathbf{x})[\\mathbf{h},\\mathbf{h}]$ is a vector resulting from the application of the second derivative tensor of $\\mathbf{F}$ to $(\\mathbf{h},\\mathbf{h})$. The $i$-th component of this vector is given by $\\mathbf{h}^\\top (D^2 F_i(\\mathbf{x})) \\mathbf{h}$, where $D^2 F_i$ is the Hessian of the $i$-th component of $\\mathbf{F}$.\nWe need to find an upper bound on the Euclidean norm $\\|\\mathbf{F}(\\mathbf{r}) - \\mathbf{F}^{(2)}(\\mathbf{r})\\| = \\|R_1^{\\mathbf{F}}(\\mathbf{r})\\|$. Using the triangle inequality for vector-valued integrals:\n$$\n\\|R_1^{\\mathbf{F}}(\\mathbf{r})\\| \\le \\int_0^1 \\| (1-t) D^2\\mathbf{F}(\\mathbf{r}_0 + t\\mathbf{h})[\\mathbf{h},\\mathbf{h}] \\| \\,dt = \\int_0^1 (1-t) \\| D^2\\mathbf{F}(\\mathbf{r}_0 + t\\mathbf{h})[\\mathbf{h},\\mathbf{h}] \\| \\,dt\n$$\nTo bound the norm of the vector $\\mathbf{v}(\\mathbf{x}) = D^2\\mathbf{F}(\\mathbf{x})[\\mathbf{h},\\mathbf{h}]$, we relate it to the third derivative of $U$. We have $F_i = -\\partial_i U$. The Hessian of $F_i$ has components $(D^2 F_i)_{jk} = \\partial_j \\partial_k F_i = -\\partial_j \\partial_k \\partial_i U$.\nThe dot product of $\\mathbf{v}(\\mathbf{x})$ with an arbitrary unit vector $\\mathbf{w}$ is:\n$$\n\\mathbf{v}(\\mathbf{x}) \\cdot \\mathbf{w} = \\sum_{i=1}^{3N} (\\mathbf{h}^\\top (D^2 F_i(\\mathbf{x})) \\mathbf{h}) w_i = \\sum_{i,j,k} (-\\partial_j \\partial_k \\partial_i U(\\mathbf{x})) h_j h_k w_i = -D^3 U(\\mathbf{x})[\\mathbf{w},\\mathbf{h},\\mathbf{h}]\n$$\nwhere the symmetry of the third partial derivatives for a $C^3$ function is used. By the definition of the operator norm of $D^3U$:\n$$\n|\\mathbf{v}(\\mathbf{x}) \\cdot \\mathbf{w}| = |D^3 U(\\mathbf{x})[\\mathbf{w},\\mathbf{h},\\mathbf{h}]| \\le \\|D^3 U(\\mathbf{x})\\| \\|\\mathbf{w}\\| \\|\\mathbf{h}\\| \\|\\mathbf{h}\\|\n$$\nSince $\\|\\mathbf{w}\\|=1$, we have $|\\mathbf{v}(\\mathbf{x}) \\cdot \\mathbf{w}| \\le \\|D^3 U(\\mathbf{x})\\| \\|\\mathbf{h}\\|^2$. The norm of a vector is the supremum of its dot products with all unit vectors, so:\n$$\n\\|\\mathbf{v}(\\mathbf{x})\\| = \\sup_{\\|\\mathbf{w}\\|=1} |\\mathbf{v}(\\mathbf{x}) \\cdot \\mathbf{w}| \\le \\|D^3 U(\\mathbf{x})\\| \\|\\mathbf{h}\\|^2\n$$\nAs before, $\\|D^3 U(\\mathbf{r}_0+t\\mathbf{h})\\| \\le M_3$. Substituting this into the bound for $\\|R_1^{\\mathbf{F}}(\\mathbf{r})\\|$:\n$$\n\\|R_1^{\\mathbf{F}}(\\mathbf{r})\\| \\le \\int_0^1 (1-t) (M_3 \\|\\mathbf{h}\\|^2) \\,dt = M_3 \\|\\mathbf{h}\\|^2 \\int_0^1 (1-t) \\,dt\n$$\nThe integral evaluates to:\n$$\n\\int_0^1 (1-t) \\,dt = \\left[ t - \\frac{t^2}{2} \\right]_0^1 = 1 - \\frac{1}{2} = \\frac{1}{2}\n$$\nThus, the bound on the force error magnitude for a given $\\mathbf{h}$ is:\n$$\n\\|\\mathbf{F}(\\mathbf{r}) - \\mathbf{F}^{(2)}(\\mathbf{r})\\| \\le \\frac{M_3 \\|\\mathbf{h}\\|^2}{2}\n$$\nThe worst-case bound for $\\|\\mathbf{h}\\| \\le \\epsilon$ is found by maximizing the right-hand side, which occurs at $\\|\\mathbf{h}\\| = \\epsilon$.\nThe worst-case upper bound on the force error magnitude is $\\frac{M_3 \\epsilon^2}{2}$.\n\nThe final answer is presented as a row matrix containing the energy error bound and the force error bound.\n- Energy error bound: $\\frac{M_3 \\epsilon^3}{6}$\n- Force error bound: $\\frac{M_3 \\epsilon^2}{2}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{M_3 \\epsilon^3}{6}  \\frac{M_3 \\epsilon^2}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The potential energy surface is a rich landscape of minima, maxima, and saddle points, each with distinct physical consequences. This computational practice explores the dynamics away from a stable minimum, demonstrating the predictive power of the second-order Taylor expansion at a saddle point. By simulating the linearized motion, you will see how the local curvature, encoded in the Hessian matrix, dictates the system's stability and gives rise to unstable modes that are fundamental to understanding chemical reactions and conformational changes .",
            "id": "3451224",
            "problem": "Consider a system in Molecular Dynamics (MD) described by a potential energy function $U(\\mathbf{R})$ of $N$ Cartesian coordinates collected in the vector $\\mathbf{R} \\in \\mathbb{R}^{N}$. Let $\\mathbf{R}^{\\ddagger}$ denote a stationary configuration where the gradient of the potential vanishes, that is $\\nabla U(\\mathbf{R}^{\\ddagger}) = \\mathbf{0}$, and assume that the Hessian matrix $H$ of second derivatives of $U$ evaluated at $\\mathbf{R}^{\\ddagger}$ has exactly one negative eigenvalue and the remaining eigenvalues are nonnegative. Near $\\mathbf{R}^{\\ddagger}$, the Taylor expansion of $U$ up to second order yields an approximation of the form $U(\\mathbf{R}^{\\ddagger} + \\mathbf{x}) \\approx U(\\mathbf{R}^{\\ddagger}) + \\dfrac{1}{2} \\mathbf{x}^{\\top} H \\mathbf{x}$, where $\\mathbf{x} = \\mathbf{R} - \\mathbf{R}^{\\ddagger}$ is the displacement vector. Newton's second law with a diagonal mass matrix $M = \\mathrm{diag}(m_{1}, \\dots, m_{N})$ states $M \\ddot{\\mathbf{R}} = -\\nabla U(\\mathbf{R})$. In the linearized regime around $\\mathbf{R}^{\\ddagger}$, this reduces to $M \\ddot{\\mathbf{x}} = - H \\mathbf{x}$ for sufficiently small $\\mathbf{x}$. This linear system can be recast as a first-order system in the augmented state $\\mathbf{y} = \\begin{pmatrix}\\mathbf{x} \\\\ \\mathbf{v}\\end{pmatrix} \\in \\mathbb{R}^{2N}$, where $\\mathbf{v} = \\dot{\\mathbf{x}}$, via $\\dot{\\mathbf{y}} = A \\mathbf{y}$ with the block matrix $A = \\begin{pmatrix} 0  I \\\\ -M^{-1} H  0 \\end{pmatrix}$. The short-time growth or decay of $\\mathbf{x}(t)$ is governed by the eigenstructure of $H$ and the masses $m_{i}$, with indefinite curvature producing an unstable mode.\n\nYour task is to implement a program that, for each given test case, computes the amplification factor defined as the ratio $a = \\dfrac{\\lVert \\mathbf{x}(T) \\rVert_{2}}{\\lVert \\mathbf{x}(0) \\rVert_{2}}$, where $\\lVert \\cdot \\rVert_{2}$ denotes the Euclidean norm, $T$ is a specified short time, and $\\mathbf{x}(t)$ evolves under the linearized dynamics $M \\ddot{\\mathbf{x}} = - H \\mathbf{x}$ with initial conditions $\\mathbf{x}(0) = \\mathbf{x}_{0}$ and $\\mathbf{v}(0) = \\mathbf{0}$. The matrix $H$ is symmetric and provided in units of newton per meter ($\\mathrm{N}/\\mathrm{m}$), the masses $m_{i}$ are provided in kilograms ($\\mathrm{kg}$), the displacements $\\mathbf{x}_{0}$ are provided in meters ($\\mathrm{m}$), velocities are provided in meters per second ($\\mathrm{m}/\\mathrm{s}$), and time $T$ is provided in seconds ($\\mathrm{s}$). The amplification factor $a$ is dimensionless.\n\nUse the following test suite, each specified by $N$, $M$, $H$, $\\mathbf{x}_{0}$, $\\mathbf{v}_{0}$, and $T$. In all cases, $N = 2$, $\\mathbf{v}_{0} = \\mathbf{0}$, and $T = 1.0 \\times 10^{-13}\\ \\mathrm{s}$.\n\n- Test case $1$ (indefinite curvature, diagonal Hessian, initial displacement aligned with the unstable mode):\n  - Masses: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$.\n  - Hessian: $H = \\begin{pmatrix} -0.5  0.0 \\\\ 0.0  0.8 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$.\n  - Initial displacement: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$.\n\n- Test case $2$ (positive definite curvature, diagonal Hessian, initial displacement aligned with a stable mode):\n  - Masses: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$.\n  - Hessian: $H = \\begin{pmatrix} 0.7  0.0 \\\\ 0.0  1.1 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$.\n  - Initial displacement: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$.\n\n- Test case $3$ (semidefinite curvature with a flat direction):\n  - Masses: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$.\n  - Hessian: $H = \\begin{pmatrix} 0.0  0.0 \\\\ 0.0  0.6 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$.\n  - Initial displacement: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$.\n\n- Test case $4$ (indefinite curvature with mode coupling):\n  - Masses: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$.\n  - Hessian: $H = \\begin{pmatrix} -0.2  0.15 \\\\ 0.15  0.3 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$.\n  - Initial displacement: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 1.0 \\times 10^{-12} \\end{pmatrix}\\ \\mathrm{m}$.\n\nAlgorithmic requirements:\n- Formulate the linearized dynamics as the first-order system $\\dot{\\mathbf{y}} = A \\mathbf{y}$ with $A = \\begin{pmatrix} 0  I \\\\ -M^{-1} H  0 \\end{pmatrix}$, where $I$ is the $N \\times N$ identity matrix and $M^{-1}$ is the inverse of the diagonal mass matrix.\n- Propagate the initial state $\\mathbf{y}(0) = \\begin{pmatrix}\\mathbf{x}_{0} \\\\ \\mathbf{0}\\end{pmatrix}$ to time $T$ using the matrix exponential solution $\\mathbf{y}(T)$, and extract $\\mathbf{x}(T)$ from the first $N$ components of $\\mathbf{y}(T)$.\n- Compute the amplification factor $a = \\dfrac{\\lVert \\mathbf{x}(T) \\rVert_{2}}{\\lVert \\mathbf{x}(0) \\rVert_{2}}$ for each test case.\n\nYour program should produce a single line of output containing the amplification factors for the $4$ test cases as a comma-separated list enclosed in square brackets, for example $[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}]$, where each $\\text{result}_{i}$ is a floating-point number. The amplification factors are dimensionless quantities and must be computed exactly as specified above. No additional output beyond this single line is permitted.",
            "solution": "The problem statement is valid. It is scientifically grounded in the principles of classical mechanics and linear stability analysis as applied to molecular dynamics. It is well-posed, providing all necessary matrices, vectors, and scalar parameters for each test case, and specifies a clear, unambiguous computational task. The provided physical values are realistic for molecular systems, and the units are consistent. The problem is objective and requires a formal, algorithmic solution.\n\nThe core of the problem lies in solving the linearized equation of motion for a molecular system near a stationary point on its potential energy surface. The provided equation is Newton's second law in matrix form for small displacements $\\mathbf{x}$ from a stationary configuration $\\mathbf{R}^{\\ddagger}$:\n$$\nM \\ddot{\\mathbf{x}} = -H \\mathbf{x}\n$$\nwhere $M$ is the diagonal mass matrix, $\\ddot{\\mathbf{x}}$ is the acceleration vector, and $H$ is the Hessian matrix of the potential energy function $U(\\mathbf{R})$ evaluated at $\\mathbf{R}^{\\ddagger}$.\n\nTo solve this second-order linear system, we reformulate it as a first-order system. We define a state vector $\\mathbf{y} \\in \\mathbb{R}^{2N}$ that concatenates the position displacements $\\mathbf{x} \\in \\mathbb{R}^N$ and the velocities $\\mathbf{v} = \\dot{\\mathbf{x}} \\in \\mathbb{R}^N$:\n$$\n\\mathbf{y}(t) = \\begin{pmatrix} \\mathbf{x}(t) \\\\ \\mathbf{v}(t) \\end{pmatrix}\n$$\nThe time derivative of this state vector, $\\dot{\\mathbf{y}}(t)$, is then:\n$$\n\\dot{\\mathbf{y}}(t) = \\begin{pmatrix} \\dot{\\mathbf{x}}(t) \\\\ \\dot{\\mathbf{v}}(t) \\end{pmatrix} = \\begin{pmatrix} \\mathbf{v}(t) \\\\ \\ddot{\\mathbf{x}}(t) \\end{pmatrix}\n$$\nFrom the equation of motion, we can express the acceleration as $\\ddot{\\mathbf{x}} = -M^{-1}H\\mathbf{x}$. Substituting this and $\\mathbf{v} = \\dot{\\mathbf{x}}$ into the expression for $\\dot{\\mathbf{y}}$ yields:\n$$\n\\dot{\\mathbf{y}}(t) = \\begin{pmatrix} \\mathbf{v}(t) \\\\ -M^{-1}H\\mathbf{x}(t) \\end{pmatrix} = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix} \\begin{pmatrix} \\mathbf{x}(t) \\\\ \\mathbf{v}(t) \\end{pmatrix}\n$$\nwhere $I$ is the $N \\times N$ identity matrix and $0$ is the $N \\times N$ zero matrix. This is a linear homogeneous system of first-order ordinary differential equations of the form $\\dot{\\mathbf{y}} = A \\mathbf{y}$, with the dynamics matrix $A$ given by:\n$$\nA = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix}\n$$\nThe solution to this system with an initial condition $\\mathbf{y}(0) = \\mathbf{y}_0$ is given by the matrix exponential:\n$$\n\\mathbf{y}(t) = e^{At} \\mathbf{y}_0\n$$\nFor this problem, the initial conditions are specified as an initial displacement $\\mathbf{x}(0) = \\mathbf{x}_0$ and zero initial velocity $\\mathbf{v}(0) = \\mathbf{0}$. Therefore, the initial state vector is:\n$$\n\\mathbf{y}(0) = \\begin{pmatrix} \\mathbf{x}_0 \\\\ \\mathbf{0} \\end{pmatrix}\n$$\nWe need to find the state at a specific time $T$. The solution is:\n$$\n\\mathbf{y}(T) = e^{AT} \\mathbf{y}(0) = \\begin{pmatrix} \\mathbf{x}(T) \\\\ \\mathbf{v}(T) \\end{pmatrix}\n$$\nThe displacement vector at time $T$, $\\mathbf{x}(T)$, consists of the first $N$ components of the resulting vector $\\mathbf{y}(T)$.\n\nThe final step is to compute the amplification factor $a$, which is defined as the ratio of the Euclidean norm of the displacement vector at time $T$ to its norm at time $t=0$:\n$$\na = \\frac{\\lVert \\mathbf{x}(T) \\rVert_2}{\\lVert \\mathbf{x}(0) \\rVert_2}\n$$\nwhere $\\lVert \\mathbf{z} \\rVert_2 = \\sqrt{\\sum_{i=1}^{N} z_i^2}$ for any vector $\\mathbf{z} \\in \\mathbb{R}^N$.\n\nThe algorithm for each test case is as follows:\n$1$. Construct the diagonal mass matrix $M$ and the Hessian matrix $H$ from the given values. For all test cases, $N=2$.\n$2$. Calculate the inverse mass matrix $M^{-1}$, which is a diagonal matrix whose elements are the reciprocals of the masses $m_i$.\n$3$. Construct the $4 \\times 4$ dynamics matrix $A = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix}$.\n$4$. Construct the $4 \\times 1$ initial state vector $\\mathbf{y}(0)$ by concatenating the given $\\mathbf{x}_0$ and the zero vector $\\mathbf{v}_0 = \\mathbf{0}$.\n$5$. Compute the matrix exponential of $A \\times T$, where $T = 1.0 \\times 10^{-13}\\ \\mathrm{s}$. Numerically, this is done using a robust algorithm like the one provided by `scipy.linalg.expm`.\n$6$. Calculate the state vector at time $T$ via the matrix-vector product $\\mathbf{y}(T) = (e^{AT}) \\mathbf{y}(0)$.\n$7$. Extract the displacement vector $\\mathbf{x}(T)$ from the first $N=2$ components of $\\mathbf{y}(T)$.\n$8$. Compute the Euclidean norms of $\\mathbf{x}(T)$ and $\\mathbf{x}(0)$ using `numpy.linalg.norm`.\n$9$. Calculate the amplification factor $a$ as their ratio.\n\nThis procedure will be repeated for each of the four test cases provided, yielding four distinct amplification factors. The nature of the Hessian matrix in each case (indefinite, positive definite, semi-definite) determines the stability of the dynamics. An indefinite Hessian implies at least one negative eigenvalue, corresponding to an unstable direction (a saddle point) where small displacements can grow exponentially, leading to $a  1$. A positive definite Hessian corresponds to a stable minimum where displacements lead to oscillations, typically resulting in $a \\le 1$. A semi-definite Hessian with a zero eigenvalue corresponds to a flat direction, where a particle with no initial velocity will not accelerate, leading to $a = 1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Computes the amplification factor for linearized dynamics near a stationary point\n    for several test cases in molecular dynamics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[-0.5, 0.0], [0.0, 0.8]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 2\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[0.7, 0.0], [0.0, 1.1]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 3\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[0.0, 0.0], [0.0, 0.6]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 4\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[-0.2, 0.15], [0.15, 0.3]]),\n            \"x0\": np.array([1.0e-12, 1.0e-12]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case[\"N\"]\n        M_diag = case[\"M_diag\"]\n        H = case[\"H\"]\n        x0 = case[\"x0\"]\n        v0 = case[\"v0\"]\n        T = case[\"T\"]\n\n        # 1. Construct matrices\n        M_inv = np.diag([1.0/m for m in M_diag])\n        I = np.identity(N)\n        Z = np.zeros((N, N))\n\n        # 2. Construct the dynamics matrix A\n        A = np.block([\n            [Z, I],\n            [-M_inv @ H, Z]\n        ])\n\n        # 3. Construct the initial state vector y0\n        y0 = np.concatenate([x0, v0])\n\n        # 4. Propagate using the matrix exponential\n        # y(T) = exp(A*T) @ y(0)\n        exp_AT = expm(A * T)\n        yT = exp_AT @ y0\n\n        # 5. Extract x(T)\n        xT = yT[:N]\n\n        # 6. Compute norms\n        norm_x0 = np.linalg.norm(x0)\n        norm_xT = np.linalg.norm(xT)\n        \n        # 7. Compute amplification factor a\n        # Avoid division by zero if x0 is the zero vector, although not the case here.\n        if norm_x0 > 0:\n            amplification_factor = norm_xT / norm_x0\n        else:\n            amplification_factor = 1.0 # Or undefined, but 1 seems reasonable.\n\n        results.append(amplification_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}