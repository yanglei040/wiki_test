{
    "hands_on_practices": [
        {
            "introduction": "经典力场的核心任务是精确再现由量子力学决定的分子势能面。本练习将指导您设计一个严谨的计算方案，用于确定一个平面外弯曲振动的谐波力常数 $k_{\\chi}$ 和平衡角 $\\chi_0$。通过思考和选择最佳的参数化流程 ，您将掌握“弛豫扫描”这一基石技术，它是将第一性原理计算结果转化为可用于分子动力学模拟的力场参数的关键步骤。",
            "id": "3431323",
            "problem": "在经典分子动力学参数化中，与非正常扭转角相关的平面外弯曲通常在平面构象能量最低点附近通过一个谐振项来建模，该项的参数必须从玻恩–奥本海默势能面获得。考虑一个如乙酰胺的模型体系，设平面外角 $\\chi$ 是由四个原子 $(i,j,k,l)$ 构建的非正常扭转角，其中原子 $j$ 是那个其偏离参考平面会受到能量惩罚的原子。你的目标是选择一个方案，该方案基于“能量最低点附近的小位移由势能对位移坐标的二阶泰勒展开所决定”这一基本事实，为平面性项生成曲率参数 $k_{\\chi}$ 和参考角 $\\chi_{0}$ 的具有物理意义的估计值。该方案必须在科学上是现实可行的：它应该描绘出平面构象能量最低点附近的电子势能面，通过适当的约束孤立出坐标 $\\chi$，处理单位一致性问题，并选择一个能将形变保持在谐振范围内、同时为稳定拟合提供足够数据的采样范围和步长。\n\n对于乙酰胺，以下哪个方案最恰当地实现了这些目标？\n\nA. 约束平面酰胺基团的非正常平面外角 $\\chi$，并以 $2.5\\mathrm{^{\\circ}}$ 为增量进行 $\\chi \\in [-25\\mathrm{^{\\circ}}, +25\\mathrm{^{\\circ}}]$ 的对称扫描。在每个 $\\chi$ 值下，在玻恩–奥本海默势能面上（例如，使用 $0\\ \\mathrm{K}$ 下的密度泛函理论(DFT)）对所有其他内坐标在固定 $\\chi$ 的约束下进行完全几何优化，记录相对能量，将 $\\chi$ 转换为弧度，并通过最小二乘法将得到的能量曲线拟合为 $\\chi$ 的二次函数，以获得 $k_{\\chi}$（单位为能量/$\\mathrm{rad}^{2}$）和 $\\chi_{0}$。通过检查增加三次项是否能在所选范围内显著改善拟合效果来验证谐振性。\n\nB. 在 $300\\ \\mathrm{K}$ 下对乙酰胺进行 $1\\ \\mathrm{ns}$ 的无约束分子动力学轨迹模拟，计算轨迹上 $\\chi$ 的直方图，并使用能量均分定理从 $\\chi$ 的方差估计 $k_{\\chi}$，其中 $\\chi$ 以度为单位处理。取分布的平均值作为 $\\chi_{0}$。不需要约束或几何优化。\n\nC. 定义围绕酰胺键的扭转二面角 $\\omega$，并以 $10\\mathrm{^{\\circ}}$ 为增量扫描 $\\omega \\in [-90\\mathrm{^{\\circ}}, +90\\mathrm{^{\\circ}}]$。在每个 $\\omega$ 值下，计算单点能（不进行几何优化），并拟合一个正弦函数来确定 $k_{\\chi}$ 和 $\\chi_{0}$。\n\nD. 仅在 $\\chi = 0\\mathrm{^{\\circ}}, 60\\mathrm{^{\\circ}}, 120\\mathrm{^{\\circ}}, 180\\mathrm{^{\\circ}}$ 处约束 $\\chi$，进行完全几何优化，并以度为单位拟合一个三次多项式来提取 $k_{\\chi}$ 和 $\\chi_{0}$。\n\nE. 以 $0.5\\mathrm{^{\\circ}}$ 为增量约束 $\\chi \\in [-10\\mathrm{^{\\circ}}, +10\\mathrm{^{\\circ}}]$，计算单点能（不弛豫其他坐标），并以度为单位进行二次拟合以获得 $k_{\\chi}$ 和 $\\chi_{0}$。\n\n选择最佳方案。",
            "solution": "目标是确定谐振势能项 $V(\\chi) = \\frac{1}{2}k_{\\chi}(\\chi - \\chi_0)^2$ 的参数，该项在经典力场中模拟平面外弯曲运动。对于从平衡几何构型的小位移，该项必须准确地表示由玻恩-奥本海默势能面（PES）所描述的“真实”势能形貌。\n\n$1$. **平衡结构和势能面**：参考势能来源于量子力学（QM）计算，例如密度泛函理论（DFT）或更高级别的从头算方法。对于乙酰胺，其平衡几何构型是平面的，这意味着能量最低点对应于平面外角 $\\chi_0 = 0^\\circ$。\n\n$2$. **孤立自由度**：分子的势能是其所有内坐标的函数。为了确定*仅*与畸变 $\\chi$ 相关的势能，我们必须孤立其效应。对此，标准且正确的方法是“弛豫势能面扫描”或“约束优化”。在此过程中，将感兴趣的坐标 $\\chi$ 固定在一个特定值，然后相对于所有其他内坐标（键长、键角等）最小化分子的能量。对一系列 $\\chi$ 值重复此过程。得到的能量 $E(\\chi)$ 代表了在给定 $\\chi$ 约束下体系的最低能量，从而定义了该特定形变的势能曲线。而“刚性扫描”，即只改变 $\\chi$ 而冻结所有其他坐标，会产生一个人为陡峭的势能曲线，因为分子的其余部分不允许响应应变而弛豫，因此对于参数化一个柔性模型是不正确的。\n\n$3$. **谐振近似与采样**：问题指出模型是一个谐振项，在能量最低点附近的小位移范围内有效。这是能量 $E(\\chi)$ 在最低点 $\\chi_0$ 附近泰勒展开的应用：\n$$ E(\\chi) \\approx E(\\chi_0) + \\left. \\frac{dE}{d\\chi} \\right|_{\\chi_0}(\\chi - \\chi_0) + \\frac{1}{2} \\left. \\frac{d^2E}{d\\chi^2} \\right|_{\\chi_0}(\\chi - \\chi_0)^2 + \\dots $$\n由于 $\\chi_0$ 是最低点，一阶导数项为零。将此与模型势能 $V(\\chi)$ 比较，我们看到力常数 $k_{\\chi}$ 对应于势能在最低点的二阶导数：$k_{\\chi} = \\left. \\frac{d^2E}{d\\chi^2} \\right|_{\\chi_0}$。为了通过拟合确定 $k_{\\chi}$ 和 $\\chi_0$，我们必须在一个二次近似有效的范围内采样点。这个范围应围绕预期的最低点（$\\chi_0=0^\\circ$）对称，以确保稳健的拟合。对于这类非正常扭转，$\\pm 20^\\circ$ 到 $\\pm 30^\\circ$ 的范围通常是合适的，因为它探测了热力学可及的能量范围，而又不会进入太远的非谐区域。数据点数量应足以进行稳定的最小二乘拟合（例如，10到20个点）。\n\n$4$. **单位一致性**：在量子力学计算中，能量通常以哈特里（Hartrees）为单位，而在经典力场中，则以 $\\mathrm{kcal/mol}$ 或 $\\mathrm{kJ/mol}$ 为单位。为了方便，角度通常以度为单位定义，但谐振势能的数学形式要求位移 $(\\chi - \\chi_0)$ 以弧度为单位，这样力常数 $k_{\\chi}$ 才能具有标准的单位，即能量/弧度$^2$。因此，在进行拟合之前，必须将以度为单位的角度值转换为弧度，或者必须对得到的力常数进行单位换算。\n\n$5$. **拟合与验证**：将收集到的数据点 $(\\chi_i, E_i)$ 拟合到二次函数 $E = E_{min} + \\frac{1}{2}k_{\\chi}(\\chi-\\chi_0)^2$。非线性最小二乘拟合将得出参数 $k_{\\chi}$ 和 $\\chi_0$。一个合理的方案会包含一个验证谐振假设的步骤，例如，通过检查在所选范围内包含三次或四次项在统计上是否显著来完成。\n\n### 逐项分析\n\n**A. 约束平面酰胺基团的非正常平面外角 $\\chi$，并以 $2.5\\mathrm{^{\\circ}}$ 为增量进行 $\\chi \\in [-25\\mathrm{^{\\circ}}, +25\\mathrm{^{\\circ}}]$ 的对称扫描。在每个 $\\chi$ 值下，在玻恩–奥本海默势能面上（例如，使用 $0\\ \\mathrm{K}$ 下的密度泛函理论(DFT)）对所有其他内坐标在固定 $\\chi$ 的约束下进行完全几何优化，记录相对能量，将 $\\chi$ 转换为弧度，并通过最小二乘法将得到的能量曲线拟合为 $\\chi$ 的二次函数，以获得 $k_{\\chi}$（单位为能量/$\\mathrm{rad}^{2}$）和 $\\chi_{0}$。通过检查增加三次项是否能在所选范围内显著改善拟合效果来验证谐振性。**\n\n该方案科学严谨，与上述推导的原则完全一致。\n- 它使用约束扫描正确地孤立了坐标 $\\chi$。\n- 它在每一步都正确地使用了完全几何优化（弛豫扫描）。\n- 扫描范围（$-25^\\circ$ 到 $+25^\\circ$）和步长（$2.5^\\circ$）对于此类参数化是物理上合理的，为可能处于谐振的区域提供了足够的数据（21个点）。\n- 它通过将角度转换为弧度，明确地解决了单位一致性的关键问题，确保得到的 $k_{\\chi}$ 具有能量/rad$^2$ 的标准单位。\n- 最后的验证步骤展示了方法的严谨性。\n**结论：正确。**\n\n**B. 在 $300\\ \\mathrm{K}$ 下对乙酰胺进行 $1\\ \\mathrm{ns}$ 的无约束分子动力学轨迹模拟，计算轨迹上 $\\chi$ 的直方图，并使用能量均分定理从 $\\chi$ 的方差估计 $k_{\\chi}$，其中 $\\chi$ 以度为单位处理。取分布的平均值作为 $\\chi_{0}$。不需要约束或几何优化。**\n\n这个方案有根本性的缺陷。其基础是能量均分定理，该定理指出对于谐振势 $V(\\chi) = \\frac{1}{2}k_{\\chi}(\\chi-\\chi_0)^2$，坐标的方差 $\\sigma_\\chi^2$ 与力常数的关系为 $\\sigma_\\chi^2 = k_B T / k_{\\chi}$。然而，这种方法是用来分析模拟结果的，而不是用来生成模拟参数的。要首先运行分子动力学轨迹，就需要一个力场，其中就包括了 $k_{\\chi}$ 的参数。从一个使用 $k_{\\chi}$ 的模拟中推导 $k_{\\chi}$ 是循环论证。如果使用*从头算*分子动力学模拟，该方法仍然有问题，因为它是一种间接测量，会受到与所有其他运动耦合的影响，并且它预设了势能是完全谐振的。此外，它错误地建议以度为单位处理 $\\chi$，这将导致 $k_{\\chi}$ 的值不正确，因为关系式 $\\sigma_\\chi^2 = k_B T / k_{\\chi}$ 仅在 $\\chi$ 以弧度为单位时才成立。\n**结论：不正确。**\n\n**C. 定义围绕酰胺键的扭转二面角 $\\omega$，并以 $10\\mathrm{^{\\circ}}$ 为增量扫描 $\\omega \\in [-90\\mathrm{^{\\circ}}, +90\\mathrm{^{\\circ}}]$。在每个 $\\omega$ 值下，计算单点能（不进行几何优化），并拟合一个正弦函数来确定 $k_{\\chi}$ 和 $\\chi_{0}$。**\n\n这个方案有多个严重错误。\n- 它扫描了错误的坐标。问题是关于平面外弯曲 $\\chi$（一个非正常扭转），而不是围绕酰胺C-N键的旋转 $\\omega$（一个正常扭转）。\n- 它使用单点能（“刚性扫描”），这种方法没有让其他几何参数弛豫，因此未能正确地孤立出被扫描坐标的势能曲线。\n- 它建议拟合正弦函数，这对于像 $\\omega$ 这样的正常扭转是合适的，但对于问题中指定的谐振平面外势能则不适用。\n**结论：不正确。**\n\n**D. 仅在 $\\chi = 0\\mathrm{^{\\circ}}, 60\\mathrm{^{\\circ}}, 120\\mathrm{^{\\circ}}, 180\\mathrm{^{\\circ}}$ 处约束 $\\chi$，进行完全几何优化，并以度为单位拟合一个三次多项式来提取 $k_{\\chi}$ 和 $\\chi_{0}$。**\n\n这个方案在物理上是不合理的。\n- 采样点过于极端。$60^\\circ$ 的平面外角，更不用说 $120^\\circ$ 或 $180^\\circ$，代表了一个巨大的、高能量的形变，远远超出了谐振区域。这些点与参数化平面构象最低点周围的小幅涨落无关。\n- 数据点数量（4个）稀疏，且对于确定最低点处的曲率而言选择得很差。这些点甚至不围绕最低点对称。\n- 拟合三次多项式不是目标函数形式，目标函数形式是谐振的（二次）。一个对称的势能应该没有三次项。\n**结论：不正确。**\n\n**E. 以 $0.5\\mathrm{^{\\circ}}$ 为增量约束 $\\chi \\in [-10\\mathrm{^{\\circ}}, +10\\mathrm{^{\\circ}}]$，计算单点能（不弛豫其他坐标），并以度为单位进行二次拟合以获得 $k_{\\chi}$ 和 $\\chi_{0}$。**\n\n这个方案有一个关键的方法论缺陷。虽然扫描范围（$-10^\\circ$ 到 $+10^\\circ$）和步长（$0.5^\\circ$）非常适合探测谐振区域，但该方案指定使用单点能（“刚性扫描”）。正如对选项C的解释，这种方法不允许分子的其余部分响应畸变而弛豫。这会导致人为的高能量惩罚，从而显著高估力常数 $k_{\\chi}$。为了获得适用于柔性分子模型的参数，需要进行弛豫扫描（在每一步都进行几何优化）。此外，虽然可以用度为单位进行拟合，之后再转换单位，但这种方法不如在拟合前就转换为弧度来得直接，且更容易出错。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一个精确的势能模型不仅能描述分子的几何结构，更能揭示其热力学性质。本练习将引导您从势能面本身转向其热力学推论。通过构建一个描述平面构型与锥形构型之间竞争的简化模型 ，您将运用统计力学的基本原理来推导和计算自由能差 $\\Delta G$，从而深入理解势垒高度（焓）和势阱刚度（熵）是如何共同决定分子的宏观稳定性的。",
            "id": "3431280",
            "problem": "考虑一个用于描述酰胺氮平面外弯曲坐标的简化一维模型，该坐标由带符号的非正常角 $\\chi$（单位为弧度）表示。其中，平面构型以 $\\chi=0$ 为中心，两个与对称性相关的锥形构型分别以 $\\chi=+\\chi_{0}$ 和 $\\chi=-\\chi_{0}$ 为中心。假设每个势阱中的势能可近似为一个谐振子势阱，并且两个锥形势阱具有相同的刚度和相对于平面构型最低点的相同能量偏移。具体而言，设平面势阱的势能为 $U_{\\text{pl}}(\\chi)=\\frac{1}{2}k_{\\text{impr}}\\chi^{2}$，其能量最低点作为零参考能量；每个锥形势阱的势能为 $U_{\\text{py}}^{\\pm}(\\chi)=V_{b}+\\frac{1}{2}k_{\\text{py}}(\\chi\\mp\\chi_{0})^{2}$，其中 $V_{b}$ 是对锥形化施加惩罚的能量偏移，$k_{\\text{py}}$ 是锥形构型能量最低点周围的局部曲率（刚度）。假设 $\\chi_{0}$ 足够大，使得谐振子邻域不重叠，并且当势阱被独立处理时，势阱之间的势垒区域对平衡热力学的贡献可以忽略不计。\n\n在温度 $T$ 下，使用正则系综，从连续坐标的配分函数和 Boltzmann 分布的定义出发。将每个势阱视为独立的谐振子贡献，并考虑锥形势阱的二重简并性。推导锥形构型与平面构型之间的自由能差 $\\Delta G$（定义为 $\\Delta G=G_{\\text{py}}-G_{\\text{pl}}$）的解析表达式，并使用下列参数在温度 $T$ 下进行数值计算：$k_{\\text{impr}}=400\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$，$k_{\\text{py}}=120\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$，$V_{b}=25\\,\\mathrm{kJ\\,mol^{-1}}$，以及 $T=298\\,\\mathrm{K}$。你的最终答案需以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位，并四舍五入到四位有效数字。通过你推导的表达式，清楚地说明结果如何依赖于非正常刚度 $k_{\\text{impr}}$ 和势垒高度 $V_{b}$。角度必须以弧度为单位处理。",
            "solution": "题目要求计算酰胺氮的锥形构型与平面构型之间的自由能差 $\\Delta G = G_{\\text{py}} - G_{\\text{pl}}$，该体系被建模为一维系统。推导将在正则系综的框架内进行。\n\n在温度 $T$ 下，一个状态的吉布斯自由能 $G$ 与其正则配分函数 $Z$ 之间的基本关系由 $G = -k_B T \\ln Z$ 给出，其中 $k_B$ 是 Boltzmann 常数。由于参数是以摩尔单位（例如 $\\mathrm{kJ\\,mol^{-1}}$）给出的，我们必须使用摩尔气体常数 $R$ 而不是 $k_B$。因此，表达式变为 $G = -RT \\ln Z$。对于具有势能 $U(\\chi)$ 的一维连续坐标 $\\chi$，其配分函数 $Z$ 由对 $\\chi$ 所有可能值的积分给出：\n$$Z = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{U(\\chi)}{RT}\\right) d\\chi$$\n这里，为方便起见，我们定义 $\\beta = \\frac{1}{RT}$。\n\n首先，我们计算平面构型的配分函数 $Z_{\\text{pl}}$。其势能为 $U_{\\text{pl}}(\\chi) = \\frac{1}{2}k_{\\text{impr}}\\chi^2$。\n$$Z_{\\text{pl}} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\frac{1}{2}k_{\\text{impr}}\\chi^2\\right) d\\chi$$\n这是一个形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\frac{\\pi}{a}}$ 的标准高斯积分。在我们的例子中，常数 $a$ 是 $\\frac{\\beta k_{\\text{impr}}}{2}$。因此，平面势阱的配分函数为：\n$$Z_{\\text{pl}} = \\sqrt{\\frac{\\pi}{\\frac{\\beta k_{\\text{impr}}}{2}}} = \\sqrt{\\frac{2\\pi}{\\beta k_{\\text{impr}}}}$$\n\n接下来，我们计算锥形构型的配分函数 $Z_{\\text{py}}$。该构型由两个简并势阱组成，一个以 $\\chi=+\\chi_0$ 为中心，另一个以 $\\chi=-\\chi_0$ 为中心。总配分函数是每个势阱贡献的总和，$Z_{\\text{py}} = Z_{\\text{py}}^{+} + Z_{\\text{py}}^{-}$。\n\n在 $\\chi=+\\chi_0$ 处的势阱的势能为 $U_{\\text{py}}^{+}(\\chi) = V_b + \\frac{1}{2}k_{\\text{py}}(\\chi - \\chi_0)^2$。其配分函数为：\n$$Z_{\\text{py}}^{+} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left[V_b + \\frac{1}{2}k_{\\text{py}}(\\chi - \\chi_0)^2\\right]\\right) d\\chi$$\n我们可以将恒定能量项 $V_b$ 提出：\n$$Z_{\\text{py}}^{+} = \\exp(-\\beta V_b) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\frac{1}{2}k_{\\text{py}}(\\chi - \\chi_0)^2\\right) d\\chi$$\n这是另一个高斯积分。通过进行变量替换 $y = \\chi - \\chi_0$，该积分在形式上与 $Z_{\\text{pl}}$ 的积分相同，只是用 $k_{\\text{py}}$ 代替了 $k_{\\text{impr}}$。该积分的计算结果为 $\\sqrt{\\frac{2\\pi}{\\beta k_{\\text{py}}}}$。\n$$Z_{\\text{py}}^{+} = \\exp(-\\beta V_b) \\sqrt{\\frac{2\\pi}{\\beta k_{\\text{py}}}}$$\n由于对称性，在 $\\chi=-\\chi_0$ 处的势阱的配分函数 $Z_{\\text{py}}^{-}$ 与 $Z_{\\text{py}}^{+}$ 相同。因此，考虑到其二重简并性，锥形态的总配分函数为：\n$$Z_{\\text{py}} = Z_{\\text{py}}^{+} + Z_{\\text{py}}^{-} = 2 \\exp(-\\beta V_b) \\sqrt{\\frac{2\\pi}{\\beta k_{\\text{py}}}}$$\n\n现在我们可以推导自由能差 $\\Delta G = G_{\\text{py}} - G_{\\text{pl}}$ 的表达式：\n$$\\Delta G = (-RT \\ln Z_{\\text{py}}) - (-RT \\ln Z_{\\text{pl}}) = -RT \\ln\\left(\\frac{Z_{\\text{py}}}{Z_{\\text{pl}}}\\right)$$\n让我们计算配分函数的比值：\n$$\\frac{Z_{\\text{py}}}{Z_{\\text{pl}}} = \\frac{2 \\exp(-\\beta V_b) \\sqrt{\\frac{2\\pi}{\\beta k_{\\text{py}}}}}{\\sqrt{\\frac{2\\pi}{\\beta k_{\\text{impr}}}}} = 2 \\exp(-\\beta V_b) \\sqrt{\\frac{k_{\\text{impr}}}{k_{\\text{py}}}}$$\n将此比值代入 $\\Delta G$ 的表达式中：\n$$\\Delta G = -RT \\ln\\left(2 \\exp(-\\beta V_b) \\sqrt{\\frac{k_{\\text{impr}}}{k_{\\text{py}}}}\\right)$$\n使用对数的性质 $\\ln(abc) = \\ln(a) + \\ln(b) + \\ln(c)$：\n$$\\Delta G = -RT \\left[ \\ln(2) + \\ln(\\exp(-\\beta V_b)) + \\ln\\left(\\left(\\frac{k_{\\text{impr}}}{k_{\\text{py}}}\\right)^{1/2}\\right) \\right]$$\n$$\\Delta G = -RT \\left[ \\ln(2) - \\beta V_b + \\frac{1}{2}\\ln\\left(\\frac{k_{\\text{impr}}}{k_{\\text{py}}}\\right) \\right]$$\n代入 $\\beta = \\frac{1}{RT}$，我们得到最终的解析表达式：\n$$\\Delta G = -RT \\ln(2) + V_b - \\frac{RT}{2}\\ln\\left(\\frac{k_{\\text{impr}}}{k_{\\text{py}}}\\right)$$\n这可以重排为：\n$$\\Delta G = V_b - RT\\left(\\ln(2) + \\frac{1}{2}\\ln\\left(\\frac{k_{\\text{impr}}}{k_{\\text{py}}}\\right)\\right)$$\n\n从这个表达式中，我们可以说明 $\\Delta G$ 对 $V_b$ 和 $k_{\\text{impr}}$ 的依赖关系。\n1.  **对 $V_b$ 的依赖性**：$\\Delta G$ 随 $V_b$ 线性增加。$V_b$ 是锥形构型能量最低点相对于平面构型能量最低点的势能偏移。它作为一个直接的焓惩罚，随着 $V_b$ 的增加，使得锥形态变得更不利。\n2.  **对 $k_{\\text{impr}}$ 的依赖性**：$\\Delta G$ 通过 $-\\frac{RT}{2}\\ln(k_{\\text{impr}})$ 项对 $k_{\\text{impr}}$ 呈对数依赖。随着 $k_{\\text{impr}}$ 的增加，平面势阱变得更窄（更陡峭），这会降低其熵。从熵的角度来看，这使得平面态相对不利，从而减小了自由能差 $\\Delta G$，并使锥形构型相对更稳定。\n\n最后，我们使用给定参数对 $\\Delta G$ 进行数值计算：\n$k_{\\text{impr}} = 400\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$\n$k_{\\text{py}} = 120\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$\n$V_b = 25\\,\\mathrm{kJ\\,mol^{-1}}$\n$T = 298\\,\\mathrm{K}$\n$R \\approx 8.31446 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$\n\n首先，我们计算热能项 $RT$：\n$$RT = (8.31446 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}) \\times (298\\,\\mathrm{K}) \\approx 2.47771\\,\\mathrm{kJ\\,mol^{-1}}$$\n接下来，我们计算刚度常数的比值：\n$$\\frac{k_{\\text{impr}}}{k_{\\text{py}}} = \\frac{400}{120} = \\frac{10}{3}$$\n现在，将数值代入推导出的 $\\Delta G$ 公式中：\n$$\\Delta G = 25\\,\\mathrm{kJ\\,mol^{-1}} - (2.47771\\,\\mathrm{kJ\\,mol^{-1}})\\left(\\ln(2) + \\frac{1}{2}\\ln\\left(\\frac{10}{3}\\right)\\right)$$\n使用 $\\ln(2) \\approx 0.69315$ 和 $\\ln(\\frac{10}{3}) \\approx 1.20397$ 的值：\n$$\\Delta G \\approx 25 - 2.47771 \\left(0.69315 + \\frac{1}{2}(1.20397)\\right)$$\n$$\\Delta G \\approx 25 - 2.47771 (0.69315 + 0.601985)$$\n$$\\Delta G \\approx 25 - 2.47771 (1.295135)$$\n$$\\Delta G \\approx 25 - 3.20897$$\n$$\\Delta G \\approx 21.79103\\,\\mathrm{kJ\\,mol^{-1}}$$\n按要求四舍五入到四位有效数字，我们得到 $21.79\\,\\mathrm{kJ\\,mol^{-1}}$。",
            "answer": "$$\\boxed{21.79}$$"
        },
        {
            "introduction": "在真实的力场开发中，依赖单一数据源往往不足以获得稳健可靠的参数。这项高级计算练习将之前学习的概念融合成一个接近实际研究工作流程的综合任务。您将通过编写一个多目标优化算法 ，学习如何寻找能够同时拟合量子化学能量、实验振动频率和偶极矩等多源数据的最优参数。这个过程将让您亲身体验在复杂模型拟合中如何利用帕累托前沿 (Pareto front) 的概念来权衡和处理不同目标之间的内在冲突。",
            "id": "3431310",
            "problem": "你的任务是为一个含有$sp^2$硫的硫代酰胺官能团中的平面外弯曲坐标，校准用于恢复平面性的非正常二面角参数。校准过程需采用一种与分子动力学（MD）一致的、基于原则的多目标方法。对于平面外弯曲，非正常二面角坐标$\\chi$用于度量偏离平面性的程度。在接近平面性的小畸变下，势能可以通过围绕平衡构型进行泰勒展开得到的谐振子模型来近似。你的目标是确定一个力常数$k$（单位为$kJ\\cdot mol^{-1}\\cdot rad^{-2}$）和一个平衡角$\\chi_0$（单位为弧度），使得模型预测与三组数据来源（量子力学（QM）能量、振动波数和实验偶极矩）之间的差异共同最小化。你必须对问题进行数学建模，在有界参数网格上实现一个多目标优化器，并报告指定硫代酰胺测试用例的帕累托权衡。\n\n推导和算法应基于以下基本定律和定义：\n- 单一坐标的谐振子近似意味着势能$U(\\chi) \\approx \\frac{1}{2} k (\\chi - \\chi_0)^2$，该公式源自围绕一阶导数为零的平衡构型所作的二阶泰勒级数展开。\n- 在单一广义坐标的微振动极限下，拉格朗日量的动能为$T = \\frac{1}{2} I_\\chi \\dot{\\chi}^2$，其中$I_\\chi$是坐标$\\chi$的有效转动惯量。简正模式角频率为$\\omega = \\sqrt{k/I_\\chi}$，相应的振动波数为$\\tilde{\\nu} = \\omega/(2\\pi c)$，其中$c$是光速。\n- 对于小畸变，线性化的偶极响应可以建模为$\\mu(\\chi) \\approx \\mu_{\\mathrm{ref}} + \\alpha\\,\\chi$，其中$\\mu_{\\mathrm{ref}}$和$\\alpha$是分子特异性常数。在谐振子模型下，能量最低构型位于$\\chi_{\\mathrm{eq}} = \\chi_0$，因此预测的平衡偶极矩为$\\mu_{\\mathrm{pred}} = \\mu_{\\mathrm{ref}} + \\alpha\\,\\chi_0$。\n\n你的程序必须使用明确的单位和角度约定来解决以下问题：\n- 角度$\\chi$必须以弧度表示。\n- 能量必须以$kJ/mol$为单位。\n- 振动波数必须以$cm^{-1}$为单位。\n- 偶极矩必须以德拜（Debye）为单位。\n- 光速为$c = 2.99792458\\times 10^{10}\\ \\mathrm{cm/s}$。\n- 有效转动惯量$I_\\chi$以$kJ\\cdot mol^{-1}\\cdot s^{2}\\cdot rad^{-2}$为单位给出，确保量纲一致性，从而使$\\omega = \\sqrt{k/I_\\chi}$的单位为$s^{-1}$。\n\n对于下面的每个分子，我们为你提供了特定平面外弯曲角度的QM参考能量、一个实验振动波数，以及一个带有实验偶极矩的参考偶极矩模型。你必须：\n- 使用$U_{\\mathrm{model}}(\\chi; k,\\chi_0) = \\frac{1}{2}k(\\chi-\\chi_0)^2$预测能量。\n- 使用$\\tilde{\\nu}_{\\mathrm{model}}(k) = \\sqrt{k/I_\\chi}/(2\\pi c)$预测振动波数。\n- 使用$\\mu_{\\mathrm{pred}}(\\chi_0) = \\mu_{\\mathrm{ref}} + \\alpha\\,\\chi_0$预测平衡偶极矩。\n\n定义三个待最小化的目标函数：\n- 能量目标：在给定角度上的均方根（RMS）误差，$\\mathrm{RMS}_E = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left(U_{\\mathrm{model}}(\\chi_i;k,\\chi_0)-E_{\\mathrm{QM}}(\\chi_i)\\right)^2}$，单位为$kJ/mol$。\n- 频率目标：绝对波数误差，$\\Delta \\tilde{\\nu} = \\left|\\tilde{\\nu}_{\\mathrm{model}}(k) - \\tilde{\\nu}_{\\mathrm{exp}}\\right|$，单位为$cm^{-1}$。\n- 偶极矩目标：绝对偶极矩误差，$\\Delta \\mu = \\left|\\mu_{\\mathrm{pred}}(\\chi_0) - \\mu_{\\mathrm{exp}}\\right|$，单位为德拜。\n\n对每个分子，在参数空间$\\{(k,\\chi_0)\\}$中执行有界网格搜索，参数范围如下：\n- $k \\in [10.0, 40.0]$，单位为$kJ\\cdot mol^{-1}\\cdot rad^{-2}$，以整数步长采样：$10.0, 11.0, \\ldots, 40.0$。\n- $\\chi_0 \\in [-0.10, 0.10]$，单位为弧度，以$0.01$的步长采样：$-0.10, -0.09, \\ldots, 0.10$。\n\n计算每个分子的帕累托最优集。如果对于参数对$(k_1,\\chi_{0,1})$，其所有三个目标函数值均小于或等于参数对$(k_2,\\chi_{0,2})$的对应值，并且至少有一个目标函数值严格更小，则称$(k_1,\\chi_{0,1})$支配$(k_2,\\chi_{0,2})$。同时，通过将网格上每个目标函数值除以其最大值进行归一化到$[0,1]$区间，并选择使归一化目标向量的欧几里得范数最小化的$(k,\\chi_0)$来计算单个“拐点”解；如果在数值容差范围内出现平局，则优先选择具有较小$\\mathrm{RMS}_E$的参数对。\n\n测试组数据（三个具有科学上一致参数的分子）：\n- 分子1（“Thioacetamide-like”）：\n  - 角度（弧度）：$[-0.2,-0.1,0.0,0.1,0.2]$\n  - QM能量（kJ/mol）：$[0.484,0.144,0.004,0.064,0.324]$\n  - 有效转动惯量$I_\\chi$（$kJ\\cdot mol^{-1}\\cdot s^{2}\\cdot rad^{-2}$）：$3.196\\times 10^{-27}$\n  - 实验波数（cm$^{-1}$）：$420.0$\n  - 偶极矩模型：$\\mu_{\\mathrm{ref}}=3.20$ 德拜，$\\alpha=1.00$ 德拜/弧度\n  - 实验偶极矩（德拜）：$3.22$\n- 分子2（“N,N-dimethyl thioformamide-like”）：\n  - 角度（弧度）：$[-0.25,-0.125,0.0,0.125,0.25]$\n  - QM能量（kJ/mol）：$[1.09375,0.2734375,0.0,0.2734375,1.09375]$\n  - 有效转动惯量$I_\\chi$（$kJ\\cdot mol^{-1}\\cdot s^{2}\\cdot rad^{-2}$）：$3.145\\times 10^{-27}$\n  - 实验波数（cm$^{-1}$）：$560.0$\n  - 偶极矩模型：$\\mu_{\\mathrm{ref}}=2.95$ 德拜，$\\alpha=0.50$ 德拜/弧度\n  - 实验偶极矩（德拜）：$2.95$\n- 分子3（“Bulky thioamide-like”）：\n  - 角度（弧度）：$[-0.3,-0.15,0.0,0.15,0.3]$\n  - QM能量（kJ/mol）：$[1.2996,0.4761,0.0576,0.0441,0.4356]$\n  - 有效转动惯量$I_\\chi$（$kJ\\cdot mol^{-1}\\cdot s^{2}\\cdot rad^{-2}$）：$4.660\\times 10^{-27}$\n  - 实验波数（cm$^{-1}$）：$330.0$\n  - 偶极矩模型：$\\mu_{\\mathrm{ref}}=3.50$ 德拜，$\\alpha=1.50$ 德拜/弧度\n  - 实验偶极矩（德拜）：$3.62$\n\n对于每个分子，你的程序必须计算：\n- 帕累托最优集的大小（一个整数）。\n- 按上述方法选择的“拐点”解参数对$(k^\\star,\\chi_0^\\star)$（浮点数）。\n\n最终输出规格：\n- 你的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表，顺序为$[p_1,k_1,\\chi_{0,1},p_2,k_2,\\chi_{0,2},p_3,k_3,\\chi_{0,3}]$，其中$p_i$是分子$i$的帕累托集大小，$(k_i,\\chi_{0,i})$是分子$i$的“拐点”解。\n- 输出中的所有浮点数值必须四舍五入到六位小数。\n- 不得打印任何额外文本。\n\n计算全程必须使用弧度处理角度，使用$kJ/mol$处理能量，使用$cm^{-1}$处理波数，使用德拜处理偶极矩。请严格遵守这些单位。输出必须遵循上述确切格式。",
            "solution": "该问题要求为一个硫代酰胺官能团中的平面外弯曲坐标确定最佳的谐波势参数，即力常数$k$和平衡角$\\chi_0$。该优化被构建为一个多目标问题，旨在同时最小化一个分子力学（MM）模型与三个不同数据来源之间的差异：量子力学（QM）势能扫描、实验振动波数和实验偶极矩。这是在为分子动力学（MD）模拟开发力场时一种标准的、有原则的方法。\n\n问题陈述已经过验证，并被认为是科学上合理、适定且完整的。所有提供的数据、物理定律和定义都与经典力学、光谱学和计算化学的既定原则相符。单位在量纲上是一致的。优化的算法流程也已明确定义。\n\n解决方案首先将数学模型和目标函数公式化，然后详细说明为三个测试分子中的每一个寻找帕累托最优集和单个“拐点”解的计算算法。\n\n**1. 数学公式化**\n\n参数化基于三个从基本原理推导出的预测模型：\n\n- **势能模型：** 与平面外畸变角$\\chi$相关的势能$U$由一个谐波函数近似，该函数是真实势能围绕平衡角$\\chi_0$的二阶泰勒展开：\n$$ U_{\\mathrm{model}}(\\chi; k, \\chi_0) = \\frac{1}{2} k (\\chi - \\chi_0)^2 $$\n此处，$k$是力常数，单位为$kJ\\cdot mol^{-1}\\cdot rad^{-2}$，$\\chi_0$是平衡角，单位为弧度。\n\n- **振动频率模型：** 在微振动（谐波）近似下，振动角频率$\\omega$与力常数$k$以及坐标$\\chi$的有效转动惯量$I_\\chi$相关：\n$$ \\omega(k) = \\sqrt{\\frac{k}{I_\\chi}} $$\n这个角频率（单位为$s^{-1}$）使用光速$c$转换为振动波数$\\tilde{\\nu}$（单位为$cm^{-1}$）：\n$$ \\tilde{\\nu}_{\\mathrm{model}}(k) = \\frac{\\omega(k)}{2\\pi c} = \\frac{1}{2\\pi c} \\sqrt{\\frac{k}{I_\\chi}} $$\n所提供的$k$（$kJ\\cdot mol^{-1}\\cdot rad^{-2}$）、$I_\\chi$（$kJ\\cdot mol^{-1}\\cdot s^2\\cdot rad^{-2}$）和$c$（$cm\\cdot s^{-1}$）的单位在量纲上是一致的，可以得到单位为$cm^{-1}$的$\\tilde{\\nu}$。\n\n- **偶极矩模型：** 分子总偶极矩$\\mu$被建模为围绕参考构型的小畸变$\\chi$的线性函数：\n$$ \\mu(\\chi) = \\mu_{\\mathrm{ref}} + \\alpha \\chi $$\n因此，模型在其自身平衡构型（$\\chi = \\chi_0$）下预测的偶极矩为：\n$$ \\mu_{\\mathrm{pred}}(\\chi_0) = \\mu_{\\mathrm{ref}} + \\alpha \\chi_0 $$\n\n基于这些模型，构建了三个目标函数来量化与参考数据之间的误差。这些函数将在参数空间$(k, \\chi_0)$上被最小化：\n\n- **能量目标（RMS误差）：**\n$$ \\mathrm{RMS}_E(k, \\chi_0) = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left( U_{\\mathrm{model}}(\\chi_i; k, \\chi_0) - E_{\\mathrm{QM}}(\\chi_i) \\right)^2 } $$\n其中$(\\chi_i, E_{\\mathrm{QM}}(\\chi_i))$是$N$对QM计算的角度和能量。\n\n- **频率目标（绝对误差）：**\n$$ \\Delta\\tilde{\\nu}(k) = \\left| \\tilde{\\nu}_{\\mathrm{model}}(k) - \\tilde{\\nu}_{\\mathrm{exp}} \\right| $$\n其中$\\tilde{\\nu}_{\\mathrm{exp}}$是实验振动波数。\n\n- **偶极矩目标（绝对误差）：**\n$$ \\Delta\\mu(\\chi_0) = \\left| \\mu_{\\mathrm{pred}}(\\chi_0) - \\mu_{\\mathrm{exp}} \\right| $$\n其中$\\mu_{\\mathrm{exp}}$是实验分子偶极矩。\n\n**2. 算法流程**\n\n优化通过在参数空间$(k, \\chi_0)$上进行有界网格搜索来执行。\n\n- 力常数$k$从$10.0$到$40.0$ $kJ\\cdot mol^{-1}\\cdot rad^{-2}$以整数步长进行采样。\n- 平衡角$\\chi_0$从$-0.10$到$0.10$弧度以$0.01$的步长进行采样。\n\n这定义了一个包含$31 \\times 21 = 651$个参数对的离散网格。对于每个参数对，评估三个目标函数，从而为参数网格中的每个点生成一个目标向量$(\\mathrm{RMS}_E, \\Delta\\tilde{\\nu}, \\Delta\\mu)$。\n\n**2.1. 帕累托最优性**\n\n一个参数对$P_1 = (k_1, \\chi_{0,1})$及其目标向量$\\vec{O}_1$ **支配** 另一个参数对$P_2 = (k_2, \\chi_{0,2})$及其目标向量$\\vec{O}_2$，当且仅当$\\vec{O}_1$的每个分量都小于或等于$\\vec{O}_2$的相应分量，并且至少有一个分量严格更小。**帕累托最优集**由网格上所有不被任何其他参数对支配的参数对组成。通过遍历所有网格点对并识别非支配点来计算该集合的大小。\n\n**2.2. 拐点解**\n\n确定一个单一的折衷解，即帕累托前沿的“拐点”。这通过首先对目标值进行归一化来完成。对于每个目标函数，找到其在整个网格上的最大值（$f_{\\mathrm{max}}$）。然后通过计算$f_{i, \\mathrm{norm}} = f_i / f_{\\mathrm{max}}$将每个评估的目标值$f_i$归一化到$[0, 1]$范围。这为每个参数对创建了一个归一化的目标向量。然后计算该归一化向量的欧几里得范数（$L_2$范数）：\n$$ L_2 = \\sqrt{ \\left(\\frac{\\mathrm{RMS}_E}{\\mathrm{RMS}_{E, \\mathrm{max}}}\\right)^2 + \\left(\\frac{\\Delta \\tilde{\\nu}}{\\Delta \\tilde{\\nu}_{\\mathrm{max}}}\\right)^2 + \\left(\\frac{\\Delta \\mu}{\\Delta \\mu_{\\mathrm{max}}}\\right)^2 } $$\n选择使该$L_2$范数最小化的参数对$(k^\\star, \\chi_0^\\star)$作为拐点解。如果在最小$L_2$范数上出现平局（在数值容差范围内），则选择具有较小$\\mathrm{RMS}_E$的参数对。此过程提供了一个在所有三个冲突目标上表现都相对较好的平衡解。\n\n实现将根据此定义的算法处理三个分子测试用例中的每一个。",
            "answer": "[14,20.000000,0.020000,8,35.000000,0.000000,8,22.000000,0.080000]"
        }
    ]
}