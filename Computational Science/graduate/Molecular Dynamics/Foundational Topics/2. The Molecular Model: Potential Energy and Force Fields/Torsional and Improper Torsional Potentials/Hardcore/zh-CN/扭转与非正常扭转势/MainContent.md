## 引言
在[分子动力学](@entry_id:147283)的广阔世界中，精确描述分子的三维结构及其动态变化是模拟成功的基石。与限制原子间距离和角度的[键长](@entry_id:144592)与键角势不同，[扭转势](@entry_id:756059)与异常[扭转势](@entry_id:756059)是赋予[分子柔性](@entry_id:752121)、决定其复杂构象（从简单有机物到蛋白质折叠）的关键力量。然而，这些势能的数学形式、物理来源以及它们在[力场](@entry_id:147325)中的正确参数化和应用，对许多研究者而言仍是一个复杂的领域。本文旨在系统性地揭开[扭转势](@entry_id:756059)的神秘面纱，弥合理论概念与实际应用之间的鸿沟。

在接下来的内容中，我们将分三步深入探索这一主题。首先，在“原理与机制”一章中，我们将从[二面角](@entry_id:185221)的几何定义出发，详细阐述正常与异常[扭转势](@entry_id:756059)的数学形式、物理意义及其在数值计算中的挑战。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示这些原理如何应用于[力场参数化](@entry_id:174757)、维持[分子几何构型](@entry_id:137852)，以及如何通过CMAP等高级模型处理蛋白质等复杂生物系统，并探讨其与[量子化学](@entry_id:140193)和[统计力](@entry_id:194984)学的深刻联系。最后，在“动手实践”部分，您将有机会通过具体的计算问题，将理论知识转化为解决实际问题的能力。让我们从[扭转势](@entry_id:756059)最基本的原理开始，踏上这段探索[分子柔性](@entry_id:752121)奥秘的旅程。

## 原理与机制

在本章中，我们将深入探讨[分子动力学模拟](@entry_id:160737)中用于描述[分子柔性](@entry_id:752121)的关键组成部分——[扭转势](@entry_id:756059)和异常[扭转势](@entry_id:756059)。与[键长](@entry_id:144592)和键角势相比，[扭转势](@entry_id:756059)描述了围绕化学键旋转的能量变化，这是决定[大分子](@entry_id:150543)（如蛋白质和聚合物）三维构象的核心。我们将从其几何定义出发，阐明其数学表达形式、物理来源，并讨论在[力场参数化](@entry_id:174757)和数值计算中遇到的高级问题。

### 扭转角的几何定义

扭转相互作用描述了由四个连续[共价键](@entry_id:141465)合的原子（$i-j-k-l$）构成的体系的能量如何随中心键（$j-k$）的旋转而变化。这种旋转的度量是通过一个称为**二面角**（dihedral angle）或**扭转角**（torsion angle）的几何量 $\phi$ 来量化的。

#### 正常二面角的定义

一个正常的[二面角](@entry_id:185221)，或称**正常扭转角**（proper dihedral angle），定义了原子链 $i-j-k-l$ 中，由前三个原子构成的平面（$i-j-k$）与由后三个原子构成的平面（$j-k-l$）之间的夹角 。旋转轴是中心的 $j-k$ 键。

为了精确地、无歧义地计算这个角度，我们需要一个包含符号（正或负）的定义，以区分顺时针和逆时针旋转。这通常通过[矢量代数](@entry_id:152340)和双参数反正切函数 `atan2` 来实现。设原子 $i, j, k, l$ 的位置矢量分别为 $\mathbf{r}_i, \mathbf{r}_j, \mathbf{r}_k, \mathbf{r}_l$。

1.  定义构成两个平面的矢量。平面 $i-j-k$ 由矢量 $\mathbf{r}_{ij} = \mathbf{r}_i - \mathbf{r}_j$ 和 $\mathbf{r}_{kj} = \mathbf{r}_k - \mathbf{r}_j$ 张成。平面 $j-k-l$ 由矢量 $\mathbf{r}_{jk} = \mathbf{r}_j - \mathbf{r}_k$ 和 $\mathbf{r}_{lk} = \mathbf{r}_l - \mathbf{r}_k$ 张成。

2.  计算两个平面的法向量。根据右手定则，我们可以通过叉乘得到两个平面的[法向量](@entry_id:264185) $\mathbf{n}_1$ 和 $\mathbf{n}_2$：
    $$
    \mathbf{n}_1 = (\mathbf{r}_i - \mathbf{r}_j) \times (\mathbf{r}_k - \mathbf{r}_j)
    $$
    $$
    \mathbf{n}_2 = (\mathbf{r}_j - \mathbf{r}_k) \times (\mathbf{r}_l - \mathbf{r}_k) = (\mathbf{r}_k - \mathbf{r}_j) \times (\mathbf{r}_l - \mathbf{r}_k)
    $$

3.  计算有符号角度。无符号的角度可以通过计算[单位法向量](@entry_id:178851)的[点积](@entry_id:149019)后取反余弦得到，即 $\arccos(\hat{\mathbf{n}}_1 \cdot \hat{\mathbf{n}}_2)$。然而，这会丢失角度的符号信息，无法区分手性结构。为了得到有符号的角度 $\phi \in (-\pi, \pi]$，我们使用 `atan2(y, x)` 函数。该函数的参数 `x` 和 `y` 分别与 $\cos\phi$ 和 $\sin\phi$ 成正比。
    -   `x` 分量（与 $\cos\phi$ 相关）由两个法向量的[点积](@entry_id:149019)给出：$x = \mathbf{n}_1 \cdot \mathbf{n}_2$。
    -   `y` 分量（与 $\sin\phi$ 相关）的符号定义了旋转方向。按照惯例，我们以中心键 $j-k$ 的方向（即矢量 $\hat{\mathbf{b}}_2 = (\mathbf{r}_k - \mathbf{r}_j) / \|\mathbf{r}_k - \mathbf{r}_j\|$）为参考轴。$\sin\phi$ 的符号由 $\mathbf{n}_1, \mathbf{n}_2, \hat{\mathbf{b}}_2$ 构成的[三重积](@entry_id:162942)的符号决定。因此，$y = (\mathbf{n}_1 \times \mathbf{n}_2) \cdot \hat{\mathbf{b}}_2$。

    综合起来，有符号的[二面角](@entry_id:185221) $\phi$ 的标准计算公式为 ：
    $$
    \phi = \operatorname{atan2}\big( (\mathbf{n}_1 \times \mathbf{n}_2) \cdot \hat{\mathbf{b}}_2, \; \mathbf{n}_1 \cdot \mathbf{n}_2 \big)
    $$
    或者使用单位化的法向量 $\hat{\mathbf{n}}_1$ 和 $\hat{\mathbf{n}}_2$：
    $$
    \phi = \operatorname{atan2}\big( (\hat{\mathbf{n}}_1 \times \hat{\mathbf{n}}_2) \cdot \hat{\mathbf{b}}_2, \; \hat{\mathbf{n}}_1 \cdot \hat{\mathbf{n}}_2 \big)
    $$
    这个定义是[尺度不变的](@entry_id:178566)，因为它仅依赖于矢量的方向。[二面角](@entry_id:185221) $\phi$ 的 $2\pi$ 周期性源于其物理本质：它描述了一个完整的物理旋转，旋转 $2\pi$ 会使系统回到与初始状态无法区分的几何构型。因此，任何依赖于 $\phi$ 的[势能函数](@entry_id:200753)也必须是 $2\pi$ 周期的。

#### 数值计算中的病态情况

在实际的[分子动力学模拟](@entry_id:160737)中，上述定义存在一个数值上的“病态”（pathological）情况。当构成平面的三个原子（如 $i,j,k$）接近**共线**（collinear）时，定义该平面的两个矢量（如 $\mathbf{r}_{ij}$ 和 $\mathbf{r}_{kj}$）几乎平行，导致它们的叉乘结果 $\mathbf{n}_1$ 的模长趋近于零。在这种情况下，对[法向量](@entry_id:264185)进行归一化的操作（即除以其模长）会导致数值不稳定，计算出的力和能量可能会出现“爆炸” 。

这种情况在键角接近 $0^\circ$ 或 $180^\circ$ 时发生，例如在含有炔基的[线性分子](@entry_id:166760)片段中。为了保证模拟的稳定性，必须采取稳健的数值处理策略。常见的**防护措施**（safeguards）包括：
1.  **检测**：通过设置一个阈值 $\epsilon$，检测法向量的模长是否过小。
2.  **切换算法**：一旦检测到近共线情况，就切换到一种不依赖于法[向量归一化](@entry_id:149602)的备用算法。例如，一种方法是直接将原子1和4的位置矢量投影到垂直于中心键 $j-k$ 的平面上，然后计算这两个投影矢量之间的角度。
3.  **力的封顶**：作为最后的保障，可以对计算出的扭转力或梯度设置一个上限，防止极端数值破坏积分器的稳定性。

### 异常扭转角与分子几何维持

除了描述沿键旋转的正常扭转角外，[力场](@entry_id:147325)中还包含**异常扭转角**（improper torsional angle）。它的目的不是描述动态旋转，而是作为一种**约束势**（restraint potential），用以维持特定的局部几何构型，如分子的**[平面性](@entry_id:274781)**（planarity）或**手性**（chirality）。

异常扭转角的定义涉及一个中心原子（如 $j$）以及与之键合的另外三个原子（如 $i, k, l$），形成一个“星形”或“金字塔形”的拓扑结构 。尽管原子不是顺序连接的，但其角度的计算在几何上可以类比于正常二面角。

一个常见的定义方式是，将异常扭转角 $\phi_{\text{imp}}$ 定义为平面 $(i,j,k)$ 和平面 $(i,j,l)$ 之间的夹角，旋转轴为 $j-i$ 键 。这个角度衡量了原子 $k$ 和 $l$ 相对于 $i-j$ 键的位置关系，有效地描述了中心原子 $j$ 的“锥化”程度。

-   对于一个理想的 $sp^2$ 杂化中心（如甲醛中的碳原子），其所连接的四个原子应处于同一平面。这时，异常扭转角的[平衡位置](@entry_id:272392)为 $0^\circ$ 或 $180^\circ$。任何偏离该角度的构象都会受到能量惩罚，从而维持其平面结构。
-   对于一个 $sp^3$ [手性中心](@entry_id:194773)，异常扭转角可以用来定义和维持其特定的[立体化学](@entry_id:166094)构型（R或S构型）。

与正常扭转角一样，异常扭转角的有符号计算也采用 `atan2` 函数，并遵循明确的[右手定则](@entry_id:156766)来定义符号。

### [扭转势](@entry_id:756059)能的函数形式

扭转[势能函数](@entry_id:200753)的设计必须反映其物理目的。正常[扭转势](@entry_id:756059)和异常[扭转势](@entry_id:756059)因此采用截然不同的数学形式。

#### 正常[扭转势](@entry_id:756059)：周期性函数

由于正常[二面角](@entry_id:185221) $\phi$ 描述的是旋转，并且具有 $2\pi$ 周期性，其[势能函数](@entry_id:200753) $V(\phi)$ 也必须是 $\phi$ 的周期函数。根据[傅里叶定理](@entry_id:195121)，任何表现良好的[周期函数](@entry_id:139337)都可以展开为三角级数。因此，[扭转势](@entry_id:756059)通常被建模为一个有限的**[傅里叶级数](@entry_id:139455)**。一种广泛使用的形式是 ：
$$
V(\phi) = \sum_{n} K_n \big[1 + \cos(n\phi - \delta_n)\big]
$$
这个表达式中的每个参数都有明确的物理意义：
-   **周期数（Multiplicity, $n$）**：整数 $n$ 决定了该项[势能](@entry_id:748988)在 $2\pi$ 区间内重复的次数，即势垒出现的频率。$n$ 的取值通常由中心键两端的对称性决定。例如，对于乙烷（$\text{CH}_3\text{-CH}_3$）分子，由于每个甲基具有 $C_3$ 旋转对称性，其绕 C-C 键旋转的[势能函数](@entry_id:200753)也表现出三重对称性。这意味着[势能函数](@entry_id:200753)在旋转 $120^\circ$（$2\pi/3$）后不变，即 $V(\phi) = V(\phi + 2\pi/3)$。这一对称性要求傅里叶级数中只包含 $n$ 为3的倍数的项（如 $n=3, 6, 9, \dots$）。
-   **振幅（Amplitude, $K_n$）**：参数 $K_n$ 控制了第 $n$ 项[势能](@entry_id:748988)贡献的能量幅度，直接关系到旋转能垒的高度。总的能垒由所有项叠加而成。
-   **相位移（Phase, $\delta_n$）**：参数 $\delta_n$ 决定了[势能曲线](@entry_id:178979)在 $\phi$ 轴上的位置，即能量最低点（稳定构象）和最高点（不稳定构象）所对应的二面角。例如，在乙烷中，实验和[量子化学](@entry_id:140193)计算表明，能量最低的是**交错式构象**（staggered, $\phi=60^\circ, 180^\circ, \dots$），能量最高的是**重叠式构象**（eclipsed, $\phi=0^\circ, 120^\circ, \dots$）。为了使势能函数在重叠式处取极大值，在交错式处取极小值，主导项 $\cos(3\phi)$ 的系数必须为正值。乙烷的旋转能垒主要源于**空间位阻**（steric repulsion，重叠式构象中氢原子电子云的排斥）和**[超共轭效应](@entry_id:263927)**（hyperconjugation，交错式构象中 C-H $\sigma$ [轨道](@entry_id:137151)与相邻 C-H $\sigma^*$ [反键轨道](@entry_id:178754)的稳定化相互作用）的综合结果 。

除了[傅里叶级数](@entry_id:139455)，还有其他等价的函数形式，如 **Ryckaert-Bellemans 势**，它将[扭转势](@entry_id:756059)表示为 $\cos\phi$ 的多项式 ：
$$
V(\phi) = \sum_{n=0}^{5} C_n (\cos\phi)^n
$$
由于 $\cos^n\phi$ 可以通过[三角恒等式](@entry_id:165065)（如切比雪夫多项式）展开为 $\cos(k\phi)$ ($k \le n$) 的线性组合，这种形式在数学上等价于一个截断的[傅里叶余弦级数](@entry_id:178044)，同样能够描述具有多个能垒的周期性[势能面](@entry_id:147441)。

#### 异常[扭转势](@entry_id:756059)：谐振子约束

异常[扭转势](@entry_id:756059)的目的是约束分子偏离其理想的平衡几何构型。因此，它通常被建模为一个简单的**谐振子势**（harmonic potential） ：
$$
V_{\text{imp}}(\phi) = \frac{1}{2} k_{\text{imp}} (\phi - \phi_0)^2
$$
这个形式的合理性可以从[势能面](@entry_id:147441)在[平衡点](@entry_id:272705)附近的泰勒展开得到。对于一个稳定的平衡构型 $\phi_0$，[势能](@entry_id:748988) $V(\phi)$ 在其附近可以展开为：
$$
V(\phi) = V(\phi_0) + V'(\phi_0)(\phi - \phi_0) + \frac{1}{2}V''(\phi_0)(\phi - \phi_0)^2 + \dots
$$
在[平衡点](@entry_id:272705)，[一阶导数](@entry_id:749425)（力）为零，即 $V'(\phi_0)=0$。对于小幅度的偏离，忽略三阶及以上的高阶项，势能变化就近似为一个二次函数。这就是谐振子势的来源。

-   **力常数 ($k_{\text{imp}}$)**：决定了约束的“硬度”。$k_{\text{imp}}$ 越大，偏离平衡构型所需的能量就越高。
-   **平衡角 ($\phi_0$)**：定义了能量最低的理想几何构型。对于平面基团，$\phi_0$ 通常为 $0^\circ$ 或 $180^\circ$。

谐振子势在维持[手性中心](@entry_id:194773)方面也至关重要。例如，一个四面体手性中心可以通过设定一个非零的平衡角（如 $\phi_0 > 0$ 对应R构型）来稳定。分子的**[外消旋化](@entry_id:191414)**（racemization）过程需要通过一个平面过渡态（$\phi \approx 0$）。从能量最低的构象（$V_{\text{imp}}(\phi_0)=0$）到平面过渡态（$V_{\text{imp}}(0) = \frac{1}{2}k_{\text{imp}}\phi_0^2$）所需的能量，即构成了一个反转能垒，从而在模拟中保持了分子的手性 。

然而，谐振子模型是一个近似，其局限性也很明显。对于可以发生**构象反转**（inversion）的体系，如氨分子（$\text{NH}_3$），其[势能面](@entry_id:147441)是双阱势，在平面构型处有一个能垒。单一的谐振子势无法描述这种双稳态体系和翻转过程。此外，对于大幅度的偏离，高阶的[非谐性](@entry_id:137191)项以及与其他内部坐标（[键长](@entry_id:144592)、键角）的耦合效应也会变得重要，这些都是简单[谐振子模型](@entry_id:178080)所忽略的 。

### 参数化中的高级议题：避免双重计数

[力场参数化](@entry_id:174757)的一个核心挑战是避免不同势能项之间的**双重计数**（double counting）。对于[扭转势](@entry_id:756059)而言，这个问题尤其突出，因为它与**1-4[非键相互作用](@entry_id:189647)**（即原子 $i$ 和 $l$ 之间的范德华和[静电相互作用](@entry_id:166363)）密切相关。这两种相互作用都随[二面角](@entry_id:185221) $\phi$ 的变化而变化，因此在拟合参数时，它们的效果很容易被混淆。

例如，在从头算（ab initio）或[量子化学](@entry_id:140193)（QM）计算得到的旋转能垒曲线中，包含了所有物理效应。如果我们在拟合[扭转势](@entry_id:756059)参数时，不对1-4[非键相互作用](@entry_id:189647)加以处理，那么拟合出的[扭转势](@entry_id:756059) $V(\phi)$ 就会将一部分本应由1-4非键项描述的能量也“吸收”进去。

为了解决这个问题，现代[力场](@entry_id:147325)开发采用了一些高级的参数化策略。一种严谨的方法是确保拟合出的扭转[势能函数](@entry_id:200753)与1-4[非键相互作用](@entry_id:189647)能在数学上“[解耦](@entry_id:637294)”。具体来说，可以将在[二面角扫描](@entry_id:166741)路径[上采样](@entry_id:275608)得到的1-4[非键相互作用](@entry_id:189647)能看作一个向量 $v$，将[扭转势](@entry_id:756059)的[基函数](@entry_id:170178)（如 $\cos(n\phi)$）看作另一组[基向量](@entry_id:199546)。目标是找到一组[扭转势](@entry_id:756059)系数，使得最终拟合出的[扭转势](@entry_id:756059)向量 $t$ 与 $v$ **正交**（orthogonal），即它们的[加权内积](@entry_id:163877)为零 $\langle t, v \rangle_W = 0$ 。

这可以通过两种方式实现：
1.  **[基函数](@entry_id:170178)[正交化](@entry_id:149208)**：在拟合之前，通过Gram-Schmidt等方法，将原始的[扭转势](@entry_id:756059)[基函数](@entry_id:170178)（如 $\cos(n\phi)$）针对[1-4相互作用](@entry_id:746136)向量 $v$ 进行[正交化](@entry_id:149208)，得到一组新的[基函数](@entry_id:170178)，这些新[基函数](@entry_id:170178)本身就与 $v$ 正交。然后用这组新[基函数](@entry_id:170178)进行无约束的[最小二乘拟合](@entry_id:751226)。
2.  **[约束最小二乘法](@entry_id:747759)**：在拟合过程中，直接将[正交性条件](@entry_id:168905) $\langle t, v \rangle_W = 0$ 作为一个[线性等式约束](@entry_id:637994)，求解一个约束最小二乘问题。

这种基于[正交投影](@entry_id:144168)思想的严谨方法，可以确保[扭转势](@entry_id:756059)项只负责描述那些不能被1-4[非键相互作用](@entry_id:189647)所解释的剩[余能](@entry_id:192009)量，从而在原理上避免了双重计数问题。这一思想同样适用于处理异常[扭转势](@entry_id:756059)与其他[非键相互作用](@entry_id:189647)（如1-3相互作用）之间的重叠。