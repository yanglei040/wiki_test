{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will connect the microscopic energy function of a single dihedral angle directly to a macroscopic, ensemble-averaged property. This exercise is a fundamental application of statistical mechanics to molecular modeling, illustrating how thermodynamic observables are derived from a potential energy function. By analytically calculating the expectation value $\\langle \\cos(n \\phi) \\rangle$ for a cosine-based torsional potential, you will reinforce your understanding of partition functions and Boltzmann weighting, and gain deep intuition for how temperature modulates conformational preferences in flexible molecules. ",
            "id": "3457058",
            "problem": "Consider an isolated proper dihedral angle $\\phi$ in a molecule, modeled in Molecular Dynamics (MD) by a single-term cosine torsional potential. Let the torsional energy be $V(\\phi) = V_{0} - C \\cos(n \\phi - \\delta)$, where $C>0$ is the torsional amplitude, $n \\in \\mathbb{N}$ is the periodicity (number of minima per $2\\pi$), and $\\delta \\in [0,2\\pi)$ is a phase offset. The angle $\\phi$ is measured in radians. In the canonical ensemble at temperature $T$, the angular probability density is given by $P(\\phi) \\propto \\exp(-\\beta V(\\phi))$ with $\\beta = 1/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant.\n\nStarting from the canonical ensemble definition of an expectation value and the above probability density, compute the canonical average $\\langle \\cos(n \\phi) \\rangle$ analytically in closed form for this single-term cosine potential. Your derivation must begin from first principles of statistical mechanics and may use well-established special functions if necessary, but must not assume the target formula. Briefly, in words, discuss the qualitative dependence of $\\langle \\cos(n \\phi) \\rangle$ on temperature $T$ (high-temperature and low-temperature limits). Express your final answer for $\\langle \\cos(n \\phi) \\rangle$ as a single closed-form analytic expression. No numerical evaluation is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of statistical mechanics and molecular modeling, is well-posed with a clear objective and sufficient information, and uses precise, objective language.\n\nThe canonical average (or expectation value) of an observable $A(\\phi)$ for a system described by the continuous variable $\\phi$ at thermal equilibrium is given by the fundamental principle of statistical mechanics:\n$$\n\\langle A(\\phi) \\rangle = \\frac{\\int A(\\phi) \\exp(-\\beta V(\\phi)) d\\phi}{\\int \\exp(-\\beta V(\\phi)) d\\phi}\n$$\nwhere the integration is performed over all possible states of the system. For a dihedral angle $\\phi$, the range of integration is $[0, 2\\pi)$. The probability density is $P(\\phi) = N \\exp(-\\beta V(\\phi))$, where $N$ is the normalization constant, which is the reciprocal of the denominator integral (the partition function $Z$).\n\nWe are asked to compute $\\langle \\cos(n \\phi) \\rangle$. The potential energy is given as $V(\\phi) = V_{0} - C \\cos(n \\phi - \\delta)$.\nSubstituting $A(\\phi) = \\cos(n \\phi)$ and the potential $V(\\phi)$ into the expectation value formula gives:\n$$\n\\langle \\cos(n \\phi) \\rangle = \\frac{\\int_0^{2\\pi} \\cos(n \\phi) \\exp(-\\beta [V_{0} - C \\cos(n \\phi - \\delta)]) d\\phi}{\\int_0^{2\\pi} \\exp(-\\beta [V_{0} - C \\cos(n \\phi - \\delta)]) d\\phi}\n$$\nThe term $\\exp(-\\beta V_0)$ is a constant that can be factored out from both the numerator and the denominator, and thus it cancels.\n$$\n\\langle \\cos(n \\phi) \\rangle = \\frac{\\int_0^{2\\pi} \\cos(n \\phi) \\exp(\\beta C \\cos(n \\phi - \\delta)) d\\phi}{\\int_0^{2\\pi} \\exp(\\beta C \\cos(n \\phi - \\delta)) d\\phi}\n$$\nTo simplify the integrals, we perform a change of variables. Let $u = n\\phi - \\delta$. This implies $\\phi = (u + \\delta)/n$ and $d\\phi = du/n$. The integration limits for $\\phi$ from $0$ to $2\\pi$ correspond to limits for $u$ from $-\\delta$ to $2\\pi n - \\delta$. The length of this integration interval is $2\\pi n$.\nThe integrand, which is a function of $u$, is periodic with period $2\\pi$. For any function $f(u)$ with period $2\\pi$, the integral over an interval of length $2\\pi n$ is $n$ times the integral over an interval of length $2\\pi$:\n$$\n\\int_{-\\delta}^{2\\pi n - \\delta} f(u) du = n \\int_0^{2\\pi} f(u) du\n$$\nLet us first evaluate the denominator, which is the partition function $Z$ (up to a factor of $\\exp(-\\beta V_0)$).\n$$\nZ = \\int_0^{2\\pi} \\exp(\\beta C \\cos(n \\phi - \\delta)) d\\phi = \\int_{-\\delta}^{2\\pi n - \\delta} \\exp(\\beta C \\cos(u)) \\frac{du}{n}\n$$\nUsing the periodicity argument:\n$$\nZ = \\frac{1}{n} \\left( n \\int_0^{2\\pi} \\exp(\\beta C \\cos(u)) du \\right) = \\int_0^{2\\pi} \\exp(\\beta C \\cos(u)) du\n$$\nThis integral is related to the modified Bessel function of the first kind of order zero, $I_0(x)$, which has the integral representation:\n$$\nI_0(x) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\exp(x \\cos\\theta) d\\theta\n$$\nThus, with $x = \\beta C$, we have $Z = 2\\pi I_0(\\beta C)$.\n\nNow, we evaluate the numerator integral, which we denote as $I_{num}$:\n$$\nI_{num} = \\int_0^{2\\pi} \\cos(n \\phi) \\exp(\\beta C \\cos(n \\phi - \\delta)) d\\phi\n$$\nApplying the same change of variables $u = n\\phi - \\delta$, we also need to express $\\cos(n\\phi)$ in terms of $u$. From $n\\phi=u+\\delta$, we have $\\cos(n\\phi)=\\cos(u+\\delta) = \\cos(u)\\cos(\\delta) - \\sin(u)\\sin(\\delta)$.\n$$\nI_{num} = \\int_{-\\delta}^{2\\pi n - \\delta} [\\cos(u)\\cos(\\delta) - \\sin(u)\\sin(\\delta)] \\exp(\\beta C \\cos(u)) \\frac{du}{n}\n$$\nAgain, using the periodicity argument:\n$$\nI_{num} = \\int_{0}^{2\\pi} [\\cos(u)\\cos(\\delta) - \\sin(u)\\sin(\\delta)] \\exp(\\beta C \\cos(u)) du\n$$\nWe can split this into two integrals:\n$$\nI_{num} = \\cos(\\delta) \\int_{0}^{2\\pi} \\cos(u) \\exp(\\beta C \\cos(u)) du - \\sin(\\delta) \\int_{0}^{2\\pi} \\sin(u) \\exp(\\beta C \\cos(u)) du\n$$\nThe second integral is zero. The integrand $f(u) = \\sin(u) \\exp(\\beta C \\cos(u))$ is an odd function with respect to $u=\\pi$ over the interval $[0, 2\\pi]$ (i.e., $f(2\\pi - u) = -f(u)$), so its integral over this symmetric interval vanishes.\nThe first integral is related to the modified Bessel function of the first kind of order one, $I_1(x)$, which has the integral representation:\n$$\nI_1(x) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\cos(\\theta) \\exp(x \\cos\\theta) d\\theta\n$$\nThus, with $x = \\beta C$, the integral is $\\int_{0}^{2\\pi} \\cos(u) \\exp(\\beta C \\cos(u)) du = 2\\pi I_1(\\beta C)$.\nThis leaves us with:\n$$\nI_{num} = \\cos(\\delta) [2\\pi I_1(\\beta C)] - \\sin(\\delta) [0] = 2\\pi \\cos(\\delta) I_1(\\beta C)\n$$\nFinally, we compute the expectation value by taking the ratio of the numerator to the denominator:\n$$\n\\langle \\cos(n \\phi) \\rangle = \\frac{I_{num}}{Z} = \\frac{2\\pi \\cos(\\delta) I_1(\\beta C)}{2\\pi I_0(\\beta C)} = \\cos(\\delta) \\frac{I_1(\\beta C)}{I_0(\\beta C)}\n$$\nSubstituting $\\beta = 1/(k_B T)$, where $k_B$ is the Boltzmann constant and $T$ is the temperature, we obtain the final expression.\n\nQualitative dependence on temperature $T$:\nThe temperature dependence is contained within the argument of the Bessel functions, $x = \\beta C = C/(k_B T)$.\n\n1.  **High-temperature limit ($T \\to \\infty$):**\n    As $T \\to \\infty$, $\\beta \\to 0$, and thus $x \\to 0$. For small $x$, the series expansions of the Bessel functions are $I_0(x) \\approx 1$ and $I_1(x) \\approx x/2$.\n    The ratio becomes $\\frac{I_1(x)}{I_0(x)} \\approx \\frac{x/2}{1} = \\frac{x}{2}$.\n    As $T \\to \\infty$, $x \\to 0$, so the ratio approaches $0$. Therefore, $\\langle \\cos(n \\phi) \\rangle \\to 0$.\n    Physically, at high temperatures, the thermal energy $k_B T$ is much larger than the potential barrier height (proportional to $C$), so the dihedral angle undergoes nearly free rotation. All angles $\\phi$ become almost equally probable, and the average value of $\\cos(n\\phi)$ over a uniform distribution is zero.\n\n2.  **Low-temperature limit ($T \\to 0$):**\n    As $T \\to 0$, $\\beta \\to \\infty$, and thus $x \\to \\infty$. For large $x$, the asymptotic expansion of the ratio is $\\frac{I_1(x)}{I_0(x)} \\sim 1 - \\frac{1}{2x} + O(x^{-2})$.\n    As $T \\to 0$, $x \\to \\infty$, so the ratio approaches $1$. Therefore, $\\langle \\cos(n \\phi) \\rangle \\to \\cos(\\delta)$.\n    Physically, at low temperatures, the system has very little thermal energy and freezes into its lowest energy state. The potential $V(\\phi) = V_0 - C\\cos(n\\phi-\\delta)$ is minimized when $\\cos(n\\phi-\\delta)$ is maximized, i.e., $\\cos(n\\phi-\\delta)=1$. This occurs at angles $\\phi$ where $n\\phi - \\delta = 2k\\pi$ for some integer $k$, which implies $n\\phi = \\delta + 2k\\pi$. For any of these minimum-energy angles, $\\cos(n\\phi) = \\cos(\\delta+2k\\pi) = \\cos(\\delta)$. At $T=0$, the system is found exclusively at these minima, so the average is precisely the value at the minimum.",
            "answer": "$$\n\\boxed{\\cos(\\delta) \\frac{I_1\\left(\\frac{C}{k_B T}\\right)}{I_0\\left(\\frac{C}{k_B T}\\right)}}\n$$"
        },
        {
            "introduction": "Improper torsional potentials are essential tools in molecular force fields for maintaining the correct three-dimensional geometry, particularly the stereochemistry at chiral centers and the planarity of groups like aromatic rings or amides. This practice problem provides a concrete example of how a simple harmonic improper potential creates an energy barrier against chiral inversion, a critical function in any realistic molecular simulation. Working through this calculation will clarify how a non-zero equilibrium angle in the potential function translates directly into the energetic cost of breaking a molecule's defined chirality. ",
            "id": "3457050",
            "problem": "Consider a molecule with a single chiral center defined by four atoms arranged such that the out-of-plane improper torsion angle, denoted by the dihedral-like coordinate $\\phi$, is measured from three atoms forming a reference plane to the fourth atom. In Molecular Dynamics (MD), the potential energy associated with small deviations of a generalized coordinate from its preferred value is often modeled by the quadratic term from a Taylor expansion about the minimum. Assume that, near equilibrium, the improper degree of freedom is governed by a harmonic restoring potential characterized by a stiffness $\\kappa$ and a preferred angle $\\phi_{0}$, where the minimum is attained at $\\phi = \\phi_{0}$ and the curvature is set by $\\kappa$.\n\nA particular configuration has $\\phi = +0.25$ radians, with parameters $\\kappa = 50.0$ kJ mol$^{-1}$ rad$^{-2}$ and $\\phi_{0} = 0.35$ radians. An inversion at the chiral center is performed that flips the sign of $\\phi$ by reflecting the fourth atom across the reference plane while keeping all other coordinates unchanged, resulting in $\\phi \\to -\\phi$.\n\nUsing only the harmonic approximation of the potential near the minimum, compute the energy change $\\Delta E$ due solely to this improper coordinate, defined as the energy of the inverted configuration minus the energy of the original configuration, and express your final value in kilojoules per mole. State your final numerical result rounded to four significant figures. Angles must be treated in radians.\n\nAdditionally, explain qualitatively whether the inversion is energetically favored or disfavored in this case, and comment on the implications for the stability of the chiral center during equilibrium MD sampling at finite temperature.",
            "solution": "The potential energy of a molecule can be described as a scalar function $U$ of its coordinates. Near a stable equilibrium point, a standard approach is to use a Taylor expansion of $U$ around the minimum with respect to a generalized coordinate. For a single coordinate $\\phi$ whose minimum occurs at $\\phi = \\phi_{0}$ and whose local curvature is $\\kappa$, the lowest nontrivial order in the expansion yields the harmonic approximation\n$$\nU(\\phi) \\approx U(\\phi_{0}) + \\frac{1}{2}\\kappa(\\phi - \\phi_{0})^{2}\n$$\nwhere $U(\\phi_{0})$ is the minimal energy at $\\phi_{0}$. This form arises from the second-order term in the Taylor expansion, with $\\kappa$ equal to the second derivative $\\left.\\frac{d^{2}U}{d\\phi^{2}}\\right|_{\\phi_{0}}$.\n\nWe are asked to compute the energy change $\\Delta E$ due to inverting the improper torsion angle by $\\phi \\to -\\phi$. Defining\n$$\n\\Delta E \\equiv U(-\\phi) - U(\\phi)\n$$\nand using the harmonic approximation, we obtain\n$$\n\\Delta E = \\frac{1}{2}\\kappa\\big[(-\\phi - \\phi_{0})^{2} - (\\phi - \\phi_{0})^{2}\\big]\n$$\nWe simplify this difference algebraically. Note that\n$$\n(-\\phi - \\phi_{0})^{2} = (\\phi + \\phi_{0})^{2}\n$$\nso\n$$\n\\Delta E = \\frac{1}{2}\\kappa\\big[(\\phi + \\phi_{0})^{2} - (\\phi - \\phi_{0})^{2}\\big]\n$$\nUsing the identity $(a+b)^{2} - (a-b)^{2} = 4ab$ with $a = \\phi$ and $b = \\phi_{0}$, we obtain\n$$\n\\Delta E = \\frac{1}{2}\\kappa(4\\phi\\phi_{0}) = 2\\kappa\\phi\\phi_{0}\n$$\nThis expression shows that the energy change upon inversion is linear in both $\\phi$ and $\\phi_{0}$ and is nonzero when $\\phi_{0} \\neq 0$. When $\\phi$ and $\\phi_{0}$ have the same sign, $\\Delta E > 0$ and the inversion increases the energy; when they have opposite signs, $\\Delta E < 0$ and the inversion decreases the energy.\n\nSubstituting the given numerical values $\\kappa = 50.0$ kJ mol$^{-1}$ rad$^{-2}$, $\\phi = 0.25$ radians, and $\\phi_{0} = 0.35$ radians, we compute\n$$\n\\Delta E = 2 \\times 50.0 \\times 0.25 \\times 0.35 \\ \\text{kJ mol}^{-1}.\n$$\nFirst, $2 \\times 50.0 = 100.0$, and $0.25 \\times 0.35 = 0.0875$. Therefore,\n$$\n\\Delta E = 100.0 \\times 0.0875 \\ \\text{kJ mol}^{-1} = 8.75 \\ \\text{kJ mol}^{-1}.\n$$\nRounded to four significant figures, the result is $8.750$ kJ mol$^{-1}$.\n\nFor the qualitative implications, note that $\\phi$ and $\\phi_{0}$ are both positive in the original configuration, so $\\Delta E > 0$ and the inversion is energetically disfavored under the improper torsion. This asymmetry arises because the preferred out-of-plane geometry is offset from zero by a nonzero $\\phi_{0}$, reflecting the chirality constraint. In equilibrium Molecular Dynamics (MD) at a finite temperature, transitions to the inverted state are suppressed relative to the original state by a Boltzmann factor proportional to $\\exp\\!\\big(-\\Delta E/(k_{B}T)\\big)$, where $k_{B}$ is the Boltzmann constant and $T$ is the absolute temperature. A positive $\\Delta E$ therefore stabilizes the chiral center against inversion, lowering the probability of sampling the inverted configuration and increasing the effective barrier to racemization within the harmonic regime. Consequently, the chiral configuration remains dynamically stable on timescales where thermal fluctuations are insufficient to overcome the energy penalty associated with inversion.",
            "answer": "$$\\boxed{8.750}$$"
        },
        {
            "introduction": "Building upon our understanding of static energy barriers, we now explore their dynamic consequences. The strength of an improper torsion potential, parameterized by its force constant, directly controls the dynamic stability of a planar molecular group and the timescale of transitions away from planarity. This advanced exercise combines analytical theory with computational practice to model the rate of out-of-plane puckering, linking the static potential energy barrier to the kinetics of conformational transitions through the lens of Kramers' rate theory in the high-friction limit. ",
            "id": "3457049",
            "problem": "You are tasked with constructing and analyzing a reduced one-dimensional model for out-of-plane distortions in a planar group subject to an improper torsion. The reduced coordinate is an out-of-plane angle, denoted by $\\phi$, measured in radians. The total potential energy $U(\\phi)$ is defined as the sum of a symmetric double-well term $U_{\\mathrm{base}}(\\phi)$ that models intrinsic puckering tendencies, and a harmonic improper torsion term $U_{\\mathrm{imp}}(\\phi)$ that penalizes deviations from planarity:\n$$\nU(\\phi) \\equiv U_{\\mathrm{base}}(\\phi) + U_{\\mathrm{imp}}(\\phi), \\quad\nU_{\\mathrm{base}}(\\phi) = a \\,\\phi^{4} - b \\,\\phi^{2}, \\quad\nU_{\\mathrm{imp}}(\\phi) = \\tfrac{1}{2} k_{\\mathrm{imp}} \\,\\phi^{2}.\n$$\nHere $a$ and $b$ are fixed parameters that characterize the baseline out-of-plane energetics, and $k_{\\mathrm{imp}}$ is an adjustable improper torsional force constant that enforces planarity. Assume the following constants and units:\n- Energy in kilocalories per mole (kcal/mol).\n- Time in picoseconds (ps).\n- Angle in radians.\n- Temperature in kelvin (K).\n- Parameters: $a = 5.0$ kcal/mol/rad$^{4}$, $b = 2.0$ kcal/mol/rad$^{2}$.\n- Rotational friction coefficient (high-friction regime) $\\zeta = 5.0$ kcal/mol·ps per rad$^{2}$.\n- Boltzmann constant $k_{\\mathrm{B}} = 0.001987204258$ kcal/mol/K.\n\nStarting from fundamental principles in statistical mechanics and dynamics, including Newton’s laws applied to a one-dimensional coordinate subject to strong dissipation (overdamped regime), and the standard well-tested results for thermally activated barrier crossing in the high-friction limit, do the following:\n1. For $k_{\\mathrm{imp}}$ such that the system remains a symmetric double well, determine the stationary points (minima and the saddle) of $U(\\phi)$, the barrier height $\\Delta U$ for inversion between the wells, and the curvatures $U''$ at the minimum and at the saddle.\n2. Using a physically justified high-friction (overdamped) thermal activation theory, derive an expression for the rate $k(T)$ (in ps$^{-1}$) of spurious out-of-plane puckering and chirality inversion as a function of absolute temperature $T$, barrier height, curvatures, and friction $\\zeta$. Conclude the Arrhenius form $k(T) = A \\exp(-E_{\\mathrm{a}}/(k_{\\mathrm{B}} T))$ and identify the activation energy $E_{\\mathrm{a}}$ (in kcal/mol) and the pre-exponential factor $A$ (in ps$^{-1}$) explicitly in terms of $a$, $b$, $k_{\\mathrm{imp}}$, and $\\zeta$.\n3. Implement a program that, for each specified $k_{\\mathrm{imp}}$, evaluates $k(T)$ at several temperatures, fits the Arrhenius form by linear regression of $\\ln k$ versus $1/T$ to extract $(E_{\\mathrm{a}}, A)$ numerically, and reports these extracted parameters.\n\nImportant constraints:\n- Work in the overdamped, high-friction regime and assume that $k_{\\mathrm{imp}}$ is chosen so that $U(\\phi)$ remains a symmetric double well with two minima and a single intervening saddle. In terms of the given parameters, this imposes a strict upper bound on $k_{\\mathrm{imp}}$ that you must identify in your derivation. Do not consider values outside this regime.\n- Express all energies in kcal/mol, all times in ps, angles in radians, and temperatures in K. The extracted activation energies must be in kcal/mol and pre-exponential factors in ps$^{-1}$.\n- Your program must calculate rates using your derived analytic expression for $k(T)$, then perform a linear regression to extract the Arrhenius parameters $(E_{\\mathrm{a}}, A)$ for each $k_{\\mathrm{imp}}$.\n\nTest suite:\n- Use the following improper torsion constants (kcal/mol/rad$^{2}$): $k_{\\mathrm{imp}} \\in \\{0.5,\\, 2.0,\\, 3.5,\\, 3.9\\}$.\n- Use the following temperatures (K): $T \\in \\{300,\\, 400,\\, 500,\\, 600\\}$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one inner list per $k_{\\mathrm{imp}}$, in the same order as given above. Each inner list must be of the form $[E_{\\mathrm{a}}, A]$, where $E_{\\mathrm{a}}$ is the fitted activation energy in kcal/mol and $A$ is the fitted pre-exponential factor in ps$^{-1}$. Round both $E_{\\mathrm{a}}$ and $A$ to six decimal places.\n- Example format (illustrative only): [[Ea_for_k0,A_for_k0],[Ea_for_k1,A_for_k1],...].",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of statistical mechanics and reaction rate theory, specifically Kramers' theory for barrier crossing in the high-friction limit. The potential energy function is a standard form for modeling double-well systems. All parameters and constants are provided with consistent units, and the tasks are well-posed, leading to a unique and meaningful solution. The problem is objective and free of any scientific or logical flaws. We may therefore proceed with a formal derivation and solution.\n\nThe total potential energy $U(\\phi)$ is given by the sum of a baseline double-well potential and a harmonic improper torsion term:\n$$U(\\phi) = a \\phi^4 - b \\phi^2 + \\frac{1}{2} k_{\\mathrm{imp}} \\phi^2$$\nThis can be simplified by combining the quadratic terms:\n$$U(\\phi) = a \\phi^4 - \\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right) \\phi^2$$\nLet us define an effective parameter $b' = b - \\frac{1}{2} k_{\\mathrm{imp}}$. The potential energy is then expressed in the canonical form of a symmetric double-well potential:\n$$U(\\phi) = a \\phi^4 - b' \\phi^2$$\nFor this potential to describe a double well with two minima separated by a barrier at $\\phi=0$, the coefficient of the quadratic term, $b'$, must be positive. This imposes a constraint on the improper torsional force constant $k_{\\mathrm{imp}}$:\n$$b' > 0 \\implies b - \\frac{1}{2} k_{\\mathrm{imp}} > 0 \\implies k_{\\mathrm{imp}} < 2b$$\nGiven the parameter $b = 2.0$ kcal/mol/rad$^2$, the upper bound on the force constant is $k_{\\mathrm{imp}} < 4.0$ kcal/mol/rad$^2$. The provided test values, $k_{\\mathrm{imp}} \\in \\{0.5, 2.0, 3.5, 3.9\\}$, all satisfy this condition, ensuring the system remains a double well.\n\n**1. Stationary Points, Barrier Height, and Curvatures**\n\nThe stationary points of the potential are found by setting the first derivative of $U(\\phi)$ with respect to $\\phi$ to zero:\n$$U'(\\phi) = \\frac{dU}{d\\phi} = 4a \\phi^3 - 2b' \\phi = 2\\phi(2a\\phi^2 - b') = 0$$\nThis equation yields three solutions for the stationary points:\n$$ \\phi = 0, \\quad \\text{and} \\quad \\phi = \\pm\\sqrt{\\frac{b'}{2a}} $$\nTo classify these points, we evaluate the second derivative, $U''(\\phi)$:\n$$U''(\\phi) = \\frac{d^2U}{d\\phi^2} = 12a \\phi^2 - 2b'$$\n- At $\\phi = 0$, the curvature is $U''(0) = -2b'$. Since $b' > 0$, the curvature is negative, indicating a local maximum. This is the saddle point of the potential, located at $\\phi_{\\mathrm{sad}} = 0$. The curvature at the saddle is $U''(\\phi_{\\mathrm{sad}}) = -2b'$.\n- At $\\phi = \\pm\\sqrt{b'/(2a)}$, the curvature is $U''(\\pm\\sqrt{b'/(2a)}) = 12a(b'/(2a)) - 2b' = 6b' - 2b' = 4b'$. Since $b' > 0$, the curvature is positive, indicating local minima. These are the locations of the two potential wells, $\\phi_{\\mathrm{min}} = \\pm\\sqrt{b'/(2a)}$. The curvature at the minima is $U''(\\phi_{\\mathrm{min}}) = 4b'$.\n\nThe barrier height, $\\Delta U$, is the difference in potential energy between the saddle point and one of the minima:\n$$\\Delta U = U(\\phi_{\\mathrm{sad}}) - U(\\phi_{\\mathrm{min}})$$\n$$U(\\phi_{\\mathrm{sad}}) = U(0) = a(0)^4 - b'(0)^2 = 0$$\n$$U(\\phi_{\\mathrm{min}}) = a\\left(\\frac{b'}{2a}\\right)^2 - b'\\left(\\frac{b'}{2a}\\right) = \\frac{(b')^2}{4a} - \\frac{(b')^2}{2a} = -\\frac{(b')^2}{4a}$$\nThus, the barrier height is:\n$$\\Delta U = 0 - \\left(-\\frac{(b')^2}{4a}\\right) = \\frac{(b')^2}{4a}$$\n\n**2. Rate Expression and Arrhenius Parameters**\n\nThe problem specifies dynamics in the high-friction (overdamped) regime. The rate of thermally activated barrier crossing is described by Kramers' theory. For a one-dimensional potential in the high-friction limit (also known as the Smoluchowski limit), the rate constant $k(T)$ for escape from a well is given by:\n$$k(T) = \\frac{\\sqrt{U''(\\phi_{\\mathrm{min}}) \\cdot |U''(\\phi_{\\mathrm{sad}})|}}{2\\pi \\zeta} \\exp\\left(-\\frac{\\Delta U}{k_{\\mathrm{B}} T}\\right)$$\nwhere $\\zeta$ is the friction coefficient, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $T$ is the absolute temperature. The term $|U''(\\phi_{\\mathrm{sad}})|$ is the magnitude of the (negative) curvature at the saddle point.\n\nWe substitute the expressions derived in the previous section:\n- $\\Delta U = \\frac{(b')^2}{4a}$\n- $U''(\\phi_{\\mathrm{min}}) = 4b'$\n- $|U''(\\phi_{\\mathrm{sad}})| = |-2b'| = 2b'$\n\nThe product of the curvatures is $U''(\\phi_{\\mathrm{min}}) \\cdot |U''(\\phi_{\\mathrm{sad}})| = (4b')(2b') = 8(b')^2$. Its square root is $\\sqrt{8(b')^2} = 2\\sqrt{2} b'$ (since $b' > 0$).\nSubstituting these into the rate formula gives:\n$$k(T) = \\frac{2\\sqrt{2} b'}{2\\pi \\zeta} \\exp\\left(-\\frac{(b')^2}{4a k_{\\mathrm{B}} T}\\right)$$\nSimplifying and replacing $b'$ with its definition in terms of $b$ and $k_{\\mathrm{imp}}$:\n$$k(T) = \\frac{\\sqrt{2} \\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right)}{\\pi \\zeta} \\exp\\left(-\\frac{\\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right)^2}{4a k_{\\mathrm{B}} T}\\right)$$\nThis expression for the rate is to be compared with the empirical Arrhenius equation, $k(T) = A \\exp(-E_{\\mathrm{a}}/(k_{\\mathrm{B}} T))$. By direct comparison, we identify the activation energy $E_{\\mathrm{a}}$ and the pre-exponential factor $A$:\n- Activation Energy: $E_{\\mathrm{a}} = \\Delta U = \\frac{\\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right)^2}{4a}$\n- Pre-exponential Factor: $A = \\frac{\\sqrt{2} \\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right)}{\\pi \\zeta}$\nThese are the theoretical Arrhenius parameters. Note that the pre-exponential factor $A$ is independent of temperature, consistent with the high-friction model.\n\n**3. Numerical Implementation**\n\nThe program will implement the derived expressions. For each given value of $k_{\\mathrm{imp}}$, it will first calculate the theoretical parameters $E_{\\mathrm{a}}$ and $A$. Then, it will compute the rate $k(T_i)$ for each temperature $T_i$ in the test suite. To extract the Arrhenius parameters via regression as requested, we transform the Arrhenius equation by taking the natural logarithm:\n$$\\ln k(T) = \\ln A - \\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}}} \\left(\\frac{1}{T}\\right)$$\nThis is a linear equation of the form $y = c + mx$, where $y = \\ln k$, $x = 1/T$, the intercept is $c = \\ln A$, and the slope is $m = -E_{\\mathrm{a}}/k_{\\mathrm{B}}$.\nThe program will perform a linear regression on the calculated data points $(\\frac{1}{T_i}, \\ln k(T_i))$ to find the slope $m$ and intercept $c$. The fitted Arrhenius parameters are then recovered as:\n- $E_{\\mathrm{a}}^{\\text{fit}} = -m \\cdot k_{\\mathrm{B}}$\n- $A^{\\text{fit}} = \\exp(c)$\nSince the data are generated from a perfect Arrhenius form, the fitted parameters will match the theoretical values to machine precision. The final output will be a list containing the pairs $[E_{\\mathrm{a}}^{\\text{fit}}, A^{\\text{fit}}]$ for each $k_{\\mathrm{imp}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates and fits Arrhenius parameters for an out-of-plane puckering model.\n    \"\"\"\n    # Define the constants from the problem statement.\n    # Energy in kcal/mol, time in ps, angle in radians, temperature in K.\n    a = 5.0  # kcal/mol/rad^4\n    b = 2.0  # kcal/mol/rad^2\n    zeta = 5.0  # kcal/mol*ps/rad^2\n    k_B = 0.001987204258  # kcal/mol/K\n\n    # Define the test cases from the problem statement.\n    k_imp_values = [0.5, 2.0, 3.5, 3.9]  # kcal/mol/rad^2\n    temperatures = [300, 400, 500, 600] # K\n\n    # List to store the final results for all k_imp values\n    all_results = []\n\n    for k_imp in k_imp_values:\n        # Effective quadratic coefficient b_prime\n        b_prime = b - 0.5 * k_imp\n\n        # The problem constraints ensure b_prime > 0, so no check is strictly needed.\n\n        # 1. Calculate theoretical Arrhenius parameters (E_a, A) based on the derivation.\n        # Activation energy E_a = (b_prime^2) / (4*a)\n        E_a_theo = (b_prime**2) / (4 * a)\n        # Pre-exponential factor A = (sqrt(2) * b_prime) / (pi * zeta)\n        A_theo = (np.sqrt(2) * b_prime) / (np.pi * zeta)\n\n        # 2. Generate data points for regression. The problem specifies fitting the\n        #    calculated rates to an Arrhenius form.\n        T_inv = 1.0 / np.array(temperatures)\n\n        # Calculate rates k(T) using the derived theoretical expression.\n        rates = A_theo * np.exp(-E_a_theo / (k_B * np.array(temperatures)))\n        ln_k = np.log(rates)\n\n        # 3. Perform a linear regression of ln(k) vs 1/T.\n        # np.polyfit(x, y, 1) returns [slope, intercept] for the best-fit line y = slope*x + intercept.\n        slope, intercept = np.polyfit(T_inv, ln_k, 1)\n\n        # 4. Extract E_a and A from the regression parameters.\n        # From ln(k) = ln(A) - (E_a / k_B) * (1/T):\n        # slope = -E_a / k_B  =>  E_a = -slope * k_B\n        # intercept = ln(A)   =>  A = exp(intercept)\n        E_a_fit = -slope * k_B\n        A_fit = np.exp(intercept)\n\n        # 5. Append the rounded results for the current k_imp to the main list.\n        # The problem asks for rounding to six decimal places.\n        all_results.append([round(E_a_fit, 6), round(A_fit, 6)])\n\n    # 6. Format the final output string exactly as specified.\n    # The required format is [[E_a1,A_1],[E_a2,A_2],...] with no spaces.\n    inner_strings = []\n    for res_pair in all_results:\n        inner_strings.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    final_output_str = f\"[{','.join(inner_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}