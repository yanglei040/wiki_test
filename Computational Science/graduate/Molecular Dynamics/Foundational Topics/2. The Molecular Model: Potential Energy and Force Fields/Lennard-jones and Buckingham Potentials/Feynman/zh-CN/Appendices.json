{
    "hands_on_practices": [
        {
            "introduction": "在分子动力学模拟中，驱动原子运动的力是根据势能函数计算得出的。这个基础练习将引导你为两种广泛使用的模型势（Lennard-Jones势和Buckingham势）推导力表达式，并分析在模拟中为提高计算效率而引入的截断方案所带来的影响。通过这个练习，你将深入理解势与力之间的基本关系，并学会评估不同截断方法对模拟结果连续性的影响，这是进行可靠模拟的关键一步。",
            "id": "3420802",
            "problem": "考虑在三维空间中通过中心对势相互作用的两个原子。在分子动力学 (MD) 中，沿着中心连线的成对作用力大小由 $F(r)=-\\frac{dU(r)}{dr}$ 定义，其中 $r$ 是原子间的标量距离，$U(r)$ 是对势能。两种广泛使用的模型对势是 Lennard–Jones (LJ) 势和 Buckingham (也称为指数–$6$) 势，其形式如下\n$$U_{\\mathrm{LJ}}(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\\quad U_{\\mathrm{B}}(r)=A\\,\\exp\\!\\left(-\\frac{r}{\\rho}\\right)-\\frac{C}{r^{6}},$$\n其中 $\\epsilon$、$\\sigma$、$A$、$\\rho$ 和 $C$ 是正常数，且 $r>0$。\n\n在有限范围的模拟中，相互作用在超出截断距离 $r_{c}>0$ 后被削减。一种常见的做法是引入修正后的势 $U_{\\text{mod}}(r)$，使其在 $r_c$ 处或之外为零。三种典型的截断方案是：\n- **直接截断 (Simple Truncation, ST):** 对于 $r \\le r_c$, $U_{\\text{mod}}(r) = U(r)$；对于 $r > r_c$, $U_{\\text{mod}}(r) = 0$。\n- **势移 (Shifted Potential, SP):** 对于 $r \\le r_c$, $U_{\\text{mod}}(r) = U(r) - U(r_c)$；对于 $r > r_c$, $U_{\\text{mod}}(r) = 0$。\n- **力移 (Shifted Force, SF):** 对于 $r \\le r_c$, $U_{\\text{mod}}(r) = U(r) - U(r_c) - (r-r_c)U'(r_c)$；对于 $r > r_c$, $U_{\\text{mod}}(r) = 0$。\n\n请完成以下任务：\n1. 为 $U_{\\mathrm{LJ}}(r)$ 和 $U_{\\mathrm{B}}(r)$ 推导力 $F(r)$ 的解析表达式。\n2. 对于每种截断方案，分析在 $r_c$ 处的修正后的势 $U_{\\text{mod}}(r)$、力 $F_{\\text{mod}}(r) = -U'_{\\text{mod}}(r)$ 和力的导数 $F'_{\\text{mod}}(r)$ 的连续性。",
            "solution": "问题陈述已经过评估，并被认定为有效。它具有科学依据、问题明确、客观，并包含了完整解答所需的所有信息。Lennard-Jones 势和 Buckingham 势以及截断方案的定义在分子动力学领域是标准的。这些任务是明确的，可以使用微积分的基本原理解答。\n\n解答按任务要求分为两部分进行。\n\n第一部分：对力的推导\n\n力 $F(r)$ 是根据关系式 $F(r) = -\\frac{dU(r)}{dr}$ 从势能 $U(r)$ 推导出来的。\n\nLennard-Jones 力 $F_{\\mathrm{LJ}}(r)$ 的推导：\nLennard-Jones 势由以下公式给出：\n$$U_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n为了方便求导，我们将势能重写为：\n$$U_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}\\right]$$\n我们现在对 $U_{\\mathrm{LJ}}(r)$ 关于 $r$ 求导：\n$$\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = 4\\epsilon\\left[\\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7}\\right]$$\n$$\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = 4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\n力是该导数的负值：\n$$F_{\\mathrm{LJ}}(r) = -\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = -4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right] = 4\\epsilon\\left[12\\frac{\\sigma^{12}}{r^{13}} - 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\n为清晰起见，此表达式可以进行因式分解：\n$$F_{\\mathrm{LJ}}(r) = \\frac{24\\epsilon}{r}\\left[2\\frac{\\sigma^{12}}{r^{12}} - \\frac{\\sigma^{6}}{r^{6}}\\right] = \\frac{24\\epsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n\nBuckingham 力 $F_{\\mathrm{B}}(r)$ 的推导：\nBuckingham 势由以下公式给出：\n$$U_{\\mathrm{B}}(r) = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{C}{r^{6}}$$\n将第二项用负指数重写：\n$$U_{\\mathrm{B}}(r) = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right) - C r^{-6}$$\n对 $U_{\\mathrm{B}}(r)$ 关于 $r$ 求导：\n$$\\frac{dU_{\\mathrm{B}}(r)}{dr} = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right)\\left(-\\frac{1}{\\rho}\\right) - C(-6)r^{-7}$$\n$$\\frac{dU_{\\mathrm{B}}(r)}{dr} = -\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}$$\n力是该导数的负值：\n$$F_{\\mathrm{B}}(r) = -\\frac{dU_{\\mathrm{B}}(r)}{dr} = -\\left[-\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}\\right] = \\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{6C}{r^{7}}$$\n\n第二部分：截断方案分析\n\n我们分析在截断距离 $r_c$ 处，势 $U(r)$、力 $F(r) = -U'(r)$ 以及力的导数 $F'(r) = -U''(r)$ 的连续性。对于所有方案，当 $r > r_c$ 时，修正后的势及其导数均为零。因此，从上方趋近的极限为 $U(r_c^+) = 0$、$F(r_c^+) = 0$ 和 $F'(r_c^+) = 0$。分析的重点是从下方趋近的极限，即 $r \\to r_c^-$。在 $r_c$ 处某量 $f(r)$ 的不匹配定义为 $\\Delta f = f(r_c^+) - f(r_c^-)$。\n\n对于 $r  \\le r_c$，我们使用原始势 $U(r)$ 在 $r_c$ 附近的泰勒级数展开。设 $r=r_c-\\delta$，其中 $\\delta > 0$ 且 $\\delta \\to 0$。\n$$U(r_c-\\delta) = U(r_c) - \\delta U'(r_c) + \\frac{\\delta^2}{2}U''(r_c) - O(\\delta^3)$$\n$$U'(r_c-\\delta) = U'(r_c) - \\delta U''(r_c) + \\frac{\\delta^2}{2}U'''(r_c) - O(\\delta^3)$$\n$$U''(r_c-\\delta) = U''(r_c) - \\delta U'''(r_c) + O(\\delta^2)$$\n\n直接截断 (ST)\n当 $r \\le r_c$ 时，$U_{\\mathrm{ST}}(r) = U(r)$。\n- 势：$U_{\\mathrm{ST}}(r_c^-) = \\lim_{r \\to r_c^-} U(r) = U(r_c)$。势是不连续的，跳跃值为 $\\Delta U = 0 - U(r_c) = -U(r_c)$。\n- 力：$F_{\\mathrm{ST}}(r) = -U'(r)$。因此，$F_{\\mathrm{ST}}(r_c^-) = -U'(r_c)$。力是不连续的，跳跃值为 $\\Delta F = 0 - (-U'(r_c)) = U'(r_c)$。\n- 力的导数：$F'_{\\mathrm{ST}}(r) = -U''(r)$。因此，$F'_{\\mathrm{ST}}(r_c^-) = -U''(r_c)$。力的导数是不连续的，跳跃值为 $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$。\n\n势移 (SP)\n当 $r \\le r_c$ 时，$U_{\\mathrm{SP}}(r) = U(r) - U(r_c)$。\n- 势：$U_{\\mathrm{SP}}(r_c^-) = \\lim_{r \\to r_c^-} [U(r) - U(r_c)] = U(r_c) - U(r_c) = 0$。势是连续的，$\\Delta U = 0$。\n- 力：$F_{\\mathrm{SP}}(r) = -\\frac{d}{dr}[U(r) - U(r_c)] = -U'(r)$。因此，$F_{\\mathrm{SP}}(r_c^-) = -U'(r_c)$。力是不连续的，跳跃值为 $\\Delta F = 0 - (-U'(r_c)) = U'(r_c)$。\n- 力的导数：$F'_{\\mathrm{SP}}(r) = -U''(r)$。因此，$F'_{\\mathrm{SP}}(r_c^-) = -U''(r_c)$。力的导数是不连续的，跳跃值为 $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$。\n\n力移 (SF)\n当 $r \\le r_c$ 时，$U_{\\mathrm{SF}}(r) = U(r) - U(r_c) - (r-r_c)U'(r_c)$。这是 $U(r)$ 与其在 $r_c$ 处的一阶泰勒近似之间的差值。\n- 势：使用 $U(r)$ 在 $r=r_c-\\delta$ 处的泰勒展开：\n$U_{\\mathrm{SF}}(r_c-\\delta) = U(r_c-\\delta) - U(r_c) - (-\\delta)U'(r_c) \\approx [U(r_c) - \\delta U'(r_c) + \\frac{\\delta^2}{2}U''(r_c)] - U(r_c) + \\delta U'(r_c) = \\frac{\\delta^2}{2}U''(r_c)$。\n当 $\\delta \\to 0$ 时，$U_{\\mathrm{SF}}(r_c^-) \\to 0$。势是连续的，$\\Delta U = 0$。\n- 力：$F_{\\mathrm{SF}}(r) = -\\frac{d}{dr}[U(r) - U(r_c) - (r-r_c)U'(r_c)] = -[U'(r) - U'(r_c)]$。\n$F_{\\mathrm{SF}}(r_c^-) = \\lim_{r \\to r_c^-} -[U'(r) - U'(r_c)] = -[U'(r_c) - U'(r_c)] = 0$。力是连续的，$\\Delta F = 0$。\n- 力的导数：$F'_{\\mathrm{SF}}(r) = -\\frac{d}{dr}[U'(r) - U'(r_c)] = -U''(r)$。\n$F'_{\\mathrm{SF}}(r_c^-) = -U''(r_c)$。力的导数是不连续的，跳跃值为 $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$。\n\n在 $r_c$ 处不匹配的总结：\n| 方案 | 连续的量 | 不匹配 $\\Delta F$ | 不匹配 $\\Delta F'$ |\n| :---: | :---: | :---: | :---: |\n| ST | 无（通常） | $U'(r_c)$ | $U''(r_c)$ |\n| SP | $U(r)$ | $U'(r_c)$ | $U''(r_c)$ |\n| SF | $U(r)$, $F(r)$ | $0$ | $U''(r_c)$ |\n\n与 $U_{\\mathrm{LJ}}(r)$ 和 $U_{\\mathrm{B}}(r)$ 的联系：\n不匹配取决于势在截断点的一阶和二阶导数的值，即 $U'(r_c)$ 和 $U''(r_c)$。对于 Lennard-Jones 势和 Buckingham 势，这些导数是：\n对于 $U_{\\mathrm{LJ}}(r)$:\n$$U'_{\\mathrm{LJ}}(r) = -F_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\n$$U''_{\\mathrm{LJ}}(r) = \\frac{d}{dr}U'_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[156\\frac{\\sigma^{12}}{r^{14}} - 42\\frac{\\sigma^{6}}{r^{8}}\\right]$$\n对于 $U_{\\mathrm{B}}(r)$:\n$$U'_{\\mathrm{B}}(r) = -F_{\\mathrm{B}}(r) = -\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}$$\n$$U''_{\\mathrm{B}}(r) = \\frac{d}{dr}U'_{\\mathrm{B}}(r) = \\frac{A}{\\rho^2}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{42C}{r^{8}}$$\n对于任何给定的 $r_c > 0$，可以计算这些表达式以找出每种势在每种截断方案下的具体不连续性。例如，在 ST 和 SP 方案中，LJ 势的力有一个大小为 $U'_{\\mathrm{LJ}}(r_c)$ 的跳跃，而对于所有方案，力的导数都有一个大小为 $U''_{\\mathrm{LJ}}(r_c)$ 的跳跃。对于 Buckingham 势，也有类似的结论。物理模拟要求力是连续的以确保能量守恒，这使得 SF 方案在这方面优于 ST 和 SP。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{24\\epsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right] \\\\ \\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{6C}{r^{7}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "势能函数的数学形式蕴含着丰富的物理信息，例如，其在平衡点附近的曲率决定了分子键的振动特性。本练习通过谐振子近似，将Lennard-Jones势的微观参数（$ \\epsilon $ 和 $ \\sigma $）与一个可测量的宏观物理量——双原子分子的振动频率——直接联系起来。完成这个练习有助于你理解如何从理论模型中提取物理可观测量，这是连接理论、模拟与实验的重要技能。",
            "id": "3420796",
            "problem": "考虑一个双原子分子，其相互作用由Lennard-Jones (LJ) 势建模，定义为 $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$，其中 $\\epsilon$ 是一个特征能量标度，$\\sigma$ 是一个特征长度标度。平衡间距 $r_{e}$ 是使 $U_{\\mathrm{LJ}}(r)$ 最小化的 $r$ 值。从相对坐标的牛顿第二定律和势在最小值附近的泰勒展开出发，确定LJ势在最小值处的曲率 $U''(r_{e})$，并用它来求出该双原子分子的谐振动角频率 $\\omega$（用约化质量 $\\mu$、$\\epsilon$ 和 $\\sigma$ 表示）。明确说明将曲率与振动频率联系起来所需的任何近似。最终答案应为仅含 $\\epsilon$、$\\sigma$ 和 $\\mu$ 的单个闭式解析表达式；不要计算任何数值。最终表达式无需报告单位，也无需进行舍入。",
            "solution": "首先将根据所需标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- **势能函数**：Lennard-Jones (LJ) 势，$U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$。\n- **参数**：$\\epsilon$ 是特征能量标度；$\\sigma$ 是特征长度标度。\n- **定义**：平衡间距 $r_{e}$ 是使 $U_{\\mathrm{LJ}}(r)$ 最小化的 $r$ 值。\n- **目标1**：确定LJ势在最小值处的曲率 $U''(r_{e})$。\n- **目标2**：利用曲率求出双原子分子的谐振动角频率 $\\omega$。\n- **所需变量**：$\\omega$ 的最终表达式必须用约化质量 $\\mu$、$\\epsilon$ 和 $\\sigma$ 表示。\n- **方法提示**：从相对坐标的牛顿第二定律和势在最小值附近的泰勒展开出发。\n- **近似**：明确说明所需的任何近似。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于Lennard-Jones势，这是分子物理学和凝聚态物理学中的一个标准基础模型。势能极小点、谐波近似和振动频率等概念是经典力学和量子力学的核心原理。该问题在科学上是合理的。\n- **适定性**：该问题提供了一个定义明确的势函数，并要求求解可推导的物理量。求解步骤逻辑结构清晰，并预期有唯一答案。\n- **客观性**：该问题使用精确、标准的科学术语和数学表达式陈述，没有任何主观性或模糊性。\n- **缺陷分析**：该问题不违反任何无效标准。它不是科学上不合理的，是可形式化的，是完整的，在其建模背景下是物理上现实的，是适定的，是一个非平凡的标准问题，并且是可科学验证的。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解题推导\n解题过程分为三个主要步骤：1. 求平衡间距 $r_e$；2. 计算势在该间距处的曲率 $U''(r_e)$；3. 使用谐波近似将此曲率与振动角频率 $\\omega$ 联系起来。\n\n**1. 平衡间距 ($r_e$)**\n平衡间距 $r_e$ 对应于势能函数 $U_{\\mathrm{LJ}}(r)$ 的最小值。为求此最小值，我们计算 $U_{\\mathrm{LJ}}(r)$ 对 $r$ 的一阶导数，并令其为零。\n\n势函数由下式给出：\n$$U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] = 4\\epsilon ( \\sigma^{12}r^{-12} - \\sigma^6 r^{-6} )$$\n\n一阶导数为：\n$$\\frac{d U_{\\mathrm{LJ}}}{dr} = 4\\epsilon ( -12\\sigma^{12}r^{-13} - (-6)\\sigma^6 r^{-7} ) = 4\\epsilon ( -12\\sigma^{12}r^{-13} + 6\\sigma^6 r^{-7} )$$\n\n在 $r=r_e$ 处令导数为零：\n$$4\\epsilon ( -12\\sigma^{12}r_e^{-13} + 6\\sigma^6 r_e^{-7} ) = 0$$\n由于 $\\epsilon \\neq 0$，我们有：\n$$12\\sigma^{12}r_e^{-13} = 6\\sigma^6 r_e^{-7}$$\n两边同除以 $6\\sigma^6 r_e^{-13}$ (因为 $r_e \\neq 0$)：\n$$2\\sigma^6 = r_e^6$$\n解出 $r_e$：\n$$r_e = 2^{1/6}\\sigma$$\n\n**2. 平衡位置的曲率 ($U''(r_e)$)**\n势的曲率是其二阶导数 $U''(r)$。我们首先通过对 $\\frac{dU_{\\mathrm{LJ}}}{dr}$ 求导来找到 $U''(r)$ 的一般表达式：\n$$U''(r) = \\frac{d^2 U_{\\mathrm{LJ}}}{dr^2} = \\frac{d}{dr} \\left[ 4\\epsilon ( -12\\sigma^{12}r^{-13} + 6\\sigma^6 r^{-7} ) \\right]$$\n$$U''(r) = 4\\epsilon [ (-12)(-13)\\sigma^{12}r^{-14} + (6)(-7)\\sigma^6 r^{-8} ]$$\n$$U''(r) = 4\\epsilon [ 156\\sigma^{12}r^{-14} - 42\\sigma^6 r^{-8} ]$$\n\n现在，我们在平衡间距 $r = r_e = 2^{1/6}\\sigma$ 处计算此表达式的值。首先使用关系式 $r_e^6 = 2\\sigma^6$ 会使代数计算更简单。\n根据此关系式，我们可以写出 $\\sigma^6 = \\frac{r_e^6}{2}$。将其代入 $U''(r_e)$ 的表达式中：\n$$U''(r_e) = 4\\epsilon \\left[ 156\\sigma^{12}r_e^{-14} - 42\\left(\\frac{r_e^6}{2}\\right) r_e^{-8} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156(\\sigma^6)^2 r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156\\left(\\frac{r_e^6}{2}\\right)^2 r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156\\frac{r_e^{12}}{4} r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 39 r_e^{-2} - 21 r_e^{-2} \\right] = 4\\epsilon (18 r_e^{-2}) = \\frac{72\\epsilon}{r_e^2}$$\n代入 $r_e^2 = (2^{1/6}\\sigma)^2 = 2^{1/3}\\sigma^2$：\n$$U''(r_e) = \\frac{72\\epsilon}{2^{1/3}\\sigma^2}$$\n这就是势在平衡点处的曲率。\n\n**3. 振动角频率 ($\\omega$)**\n问题要求使用势的泰勒展开。对于偏离平衡位置的小位移 $x = r - r_e$，势 $U(r)$ 可用其在 $r_e$ 附近的泰勒级数近似：\n$$U(r) \\approx U(r_e) + U'(r_e)(r-r_e) + \\frac{1}{2}U''(r_e)(r-r_e)^2 + \\mathcal{O}((r-r_e)^3)$$\n根据平衡的定义，$U'(r_e) = 0$。忽略恒定的能量偏移 $U(r_e)$ 和高阶项，小振动的势能为：\n$$U(x) \\approx \\frac{1}{2}U''(r_e)x^2$$\n这就是**谐波近似**。势能具有简谐振子 $U(x) = \\frac{1}{2}kx^2$ 的形式，其中等效劲度系数 $k$ 是势在最小值处的曲率：\n$$k = U''(r_e) = \\frac{72\\epsilon}{2^{1/3}\\sigma^2}$$\n\n对于约化质量为 $\\mu$ 的双原子分子的相对坐标，其运动方程由牛顿第二定律给出：\n$$\\mu \\ddot{x} = F = -\\frac{dU}{dx} = -kx$$\n这就得到了简谐运动的标准方程：\n$$\\ddot{x} + \\frac{k}{\\mu}x = 0$$\n该运动的角频率由下式给出：\n$$\\omega = \\sqrt{\\frac{k}{\\mu}}$$\n代入 $k$ 的表达式：\n$$\\omega = \\sqrt{\\frac{1}{\\mu} \\left( \\frac{72\\epsilon}{2^{1/3}\\sigma^2} \\right)} = \\sqrt{\\frac{72\\epsilon}{2^{1/3}\\mu\\sigma^2}}$$\n为简化数值因子：\n$$\\frac{72}{2^{1/3}} = \\frac{36 \\times 2}{2^{1/3}} = 36 \\times 2^{1-1/3} = 36 \\times 2^{2/3}$$\n所以 $\\omega^2$ 的表达式变为：\n$$\\omega^2 = \\frac{36 \\cdot 2^{2/3} \\epsilon}{\\mu\\sigma^2}$$\n取平方根得到角频率的最终表达式：\n$$\\omega = \\sqrt{\\frac{36 \\cdot 2^{2/3} \\epsilon}{\\mu\\sigma^2}} = \\frac{6 \\cdot (2^{2/3})^{1/2}}{\\sigma} \\sqrt{\\frac{\\epsilon}{\\mu}} = \\frac{6 \\cdot 2^{1/3}}{\\sigma} \\sqrt{\\frac{\\epsilon}{\\mu}}$$\n这可以写成一个单一的表达式：\n$$\\omega = 6 \\cdot 2^{1/3} \\sqrt{\\frac{\\epsilon}{\\mu\\sigma^2}}$$\n这就是该双原子分子的谐振动角频率。",
            "answer": "$$\\boxed{6 \\cdot 2^{1/3} \\sqrt{\\frac{\\epsilon}{\\mu \\sigma^2}}}$$"
        },
        {
            "introduction": "将微观的对势应用到宏观或介观尺度的系统中，是分子模拟中的常见挑战，尤其是在研究界面现象时。这个高级练习要求你计算单个粒子与一个半无限大连续固体墙之间的相互作用势。你需要将描述单个原子对的Buckingham势在整个墙体上进行积分，这不仅需要扎实的解析推导能力，还需要你设计并实现一个数值稳定且高效的积分方案，是理论计算与计算物理实践的完美结合。",
            "id": "3420768",
            "problem": "要求您计算一个点状粒子在占据半空间 $z' \\le 0$ 的半无限平面壁上方高度 $z > 0$ 处的连续介质积分壁势。该壁具有均匀的数密度 $n_{\\mathrm{w}}$，并对粒子施加一种对偶 Buckingham 型相互作用，其模型为 $v(r) = A \\exp(-r/\\lambda) - C_6 r^{-6}$，其中 $A$ 和 $C_6$ 是相互作用系数，$\\lambda$ 是排斥长度标度。在高度 $z$ 处的连续介质壁势定义为\n$$\n\\Phi(z) = n_{\\mathrm{w}} \\int_{z' \\le 0} v\\!\\left(\\lvert \\mathbf{r} - \\mathbf{r}' \\rvert\\right) \\, d^3 \\mathbf{r}' \\, ,\n$$\n其中粒子位置为 $\\mathbf{r} = (0,0,z)$。您的任务是实现一个数值稳定且高效的求积方案，用于计算给定参数集下的 $\\Phi(z)$，确保在 $z$ 较小和排斥范围较刚性（$\\lambda$ 较小）时具有鲁棒性。\n\n设计约束和要求：\n- 从基本原理出发：势能的定义，即对势在壁体积上的空间积分，以及标准坐标变换。不得预先假设任何目标公式。\n- 利用柱对称性，在可能的情况下解析地消除角坐标和径向坐标，将三维积分简化为一维积分。确保所得到的一维积分在 $z \\to 0^+$ 时是良态的。\n- 对于指数排斥项，设计一种在 $[0,\\infty)$ 上以及对于小 $\\lambda$ 均稳定的求积法。对于此部分，您必须采用适用于 $[0,\\infty)$ 上具有指数衰减的积分的变换，并通过使用与指数权重匹配的节点和权重的广义高斯求积法则来对其进行求值。\n- 对于长程吸引的 $r^{-6}$ 贡献，避免会遭受近场刚性影响的朴素数值积分。使用一种有数学依据的简化方法，该方法可以消除任何可积奇点，并对所有 $z > 0$ 都精确。\n- 所有物理参数必须使用一致的单位处理：距离单位为纳米 (nm)，数密度单位为 nm$^{-3}$，能量单位为千焦/摩尔 (kJ/mol)。您的最终答案必须以 kJ/mol 为单位，并以浮点数形式报告。\n- 数值角度单位不适用；不报告任何角度。\n- 百分比不适用，不得使用。\n\n测试套件：\n评估以下五个参数集的 $\\Phi(z)$，每个参数集以元组 $(z, n_{\\mathrm{w}}, A, \\lambda, C_6)$ 的形式给出，单位分别为 $(\\mathrm{nm}, \\mathrm{nm}^{-3}, \\mathrm{kJ/mol}, \\mathrm{nm}, \\mathrm{kJ\\cdot nm}^6/\\mathrm{mol})$：\n1. $(0.020,\\; 33.3,\\; 1.0\\times 10^6,\\; 0.020,\\; 0.00614)$\n2. $(0.050,\\; 33.3,\\; 1.0\\times 10^6,\\; 0.020,\\; 0.00614)$\n3. $(0.500,\\; 33.3,\\; 1.0\\times 10^6,\\; 0.020,\\; 0.00614)$\n4. $(0.200,\\; 33.3,\\; 5.0\\times 10^5,\\; 0.030,\\; 0.00614)$\n5. $(1.000,\\; 33.3,\\; 1.0\\times 10^6,\\; 0.020,\\; 0.03000)$\n\n实现与输出规范：\n- 将上述算法实现在一个单一、独立完整的程序中。\n- 对于指数排斥贡献，使用基于变量替换的数值稳定求积法，该变量替换将半无限域映射到权重为 $\\exp(-x)$ 的加权积分上，并使用为此权重设计的高斯求积法对其进行求值。\n- 对于吸引的 $r^{-6}$ 贡献，解析地消除径向坐标，以获得一个对所有 $z > 0$ 都良态的一维简化积分，并在可能的情况下以闭合形式精确求值，以避免相消误差或刚性。\n- 您的程序应计算每个测试用例的 $\\Phi(z)$，并将结果以逗号分隔的列表形式单行输出，并用方括号括起来，例如：“[val1,val2,val3,val4,val5]”。\n- 以 kJ/mol 为单位报告每个浮点结果，四舍五入到六位小数。\n- 您的程序必须以指定格式生成恰好一行的输出，其中包含五个浮点数的列表。输出中不允许包含任何额外文本。",
            "solution": "问题要求计算一个点状粒子在高度 $z > 0$ 处，位于一个占据半空间 $z' \\le 0$ 的半无限平面壁上方的连续介质积分壁势 $\\Phi(z)$。该壁具有均匀的数密度 $n_{\\mathrm{w}}$。粒子与壁的无穷小体积元之间的相互作用由 Buckingham 对势 $v(r) = A \\exp(-r/\\lambda) - C_6 r^{-6}$ 描述。\n\n总势 $\\Phi(z)$ 定义为对势在整个壁体积上的积分：\n$$\n\\Phi(z) = n_{\\mathrm{w}} \\int_{z' \\le 0} v\\!\\left(\\lvert \\mathbf{r} - \\mathbf{r}' \\rvert\\right) \\, d^3 \\mathbf{r}'\n$$\n其中粒子位于位置 $\\mathbf{r} = (0, 0, z)$，积分遍及壁中的所有点 $\\mathbf{r}'$。\n\n为了计算这个三维积分，我们利用系统的柱对称性。我们将位置矢量 $\\mathbf{r}'$ 用柱坐标 $(\\rho, \\phi, z')$ 表示，使得 $x' = \\rho \\cos\\phi$，$y' = \\rho \\sin\\phi$，体积元为 $d^3 \\mathbf{r}' = \\rho \\, d\\rho \\, d\\phi \\, dz'$。粒子与体积元之间的距离为 $r = \\lvert \\mathbf{r} - \\mathbf{r}' \\rvert = \\sqrt{(x')^2 + (y')^2 + (z-z')^2} = \\sqrt{\\rho^2 + (z-z')^2}$。\n\n$\\Phi(z)$ 的积分可以写为：\n$$\n\\Phi(z) = n_{\\mathrm{w}} \\int_{-\\infty}^{0} dz' \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\infty} d\\rho \\, \\rho \\, v\\left(\\sqrt{\\rho^2 + (z-z')^2}\\right)\n$$\n由于被积函数与方位角 $\\phi$ 无关，对 $\\phi$ 的积分得到一个因子 $2\\pi$：\n$$\n\\Phi(z) = 2\\pi n_{\\mathrm{w}} \\int_{-\\infty}^{0} dz' \\int_{0}^{\\infty} d\\rho \\, \\rho \\, v\\left(\\sqrt{\\rho^2 + (z-z')^2}\\right)\n$$\n为进一步简化，我们对关于 $\\rho$ 的内层积分进行变量替换。令 $s^2 = \\rho^2 + (z-z')^2$。则 $2s \\, ds = 2\\rho \\, d\\rho$，所以 $\\rho \\, d\\rho = s \\, ds$。当 $\\rho=0$ 时，$s$ 的积分下限为 $s = |z-z'|$。由于 $z > 0$ 且 $z' \\le 0$，我们有 $z-z' > 0$，因此 $s = z-z'$。积分上限为 $s \\to \\infty$。积分变为：\n$$\n\\Phi(z) = 2\\pi n_{\\mathrm{w}} \\int_{-\\infty}^{0} \\left( \\int_{z-z'}^{\\infty} v(s) s \\, ds \\right) dz'\n$$\n现在我们定义一个新变量 $u = z-z'$。则 $du = -dz'$。$u$ 的积分限从 $z - (-\\infty) = \\infty$ 到 $z - 0 = z$。反转积分限会引入一个负号，该负号与 $du$ 中的负号相抵消：\n$$\n\\Phi(z) = 2\\pi n_{\\mathrm{w}} \\int_{z}^{\\infty} \\left( \\int_{u}^{\\infty} v(s) s \\, ds \\right) du\n$$\n现在我们可以通过将 $v(r)$ 分解为其排斥和吸引分量来计算势能，即 $\\Phi(z) = \\Phi_{\\text{rep}}(z) + \\Phi_{\\text{att}}(z)$。\n\n**吸引贡献 ($\\Phi_{\\text{att}}(z)$)**\n\n对势的吸引部分为 $v_{\\text{att}}(s) = -C_6 s^{-6}$。内层积分为：\n$$\n\\int_{u}^{\\infty} (-C_6 s^{-6}) s \\, ds = -C_6 \\int_{u}^{\\infty} s^{-5} \\, ds = -C_6 \\left[ \\frac{s^{-4}}{-4} \\right]_{u}^{\\infty} = -C_6 \\left( 0 - \\frac{u^{-4}}{-4} \\right) = -\\frac{C_6}{4u^4}\n$$\n将此代入势的表达式中，吸引贡献为：\n$$\n\\Phi_{\\text{att}}(z) = 2\\pi n_{\\mathrm{w}} \\int_{z}^{\\infty} \\left( -\\frac{C_6}{4u^4} \\right) du = -\\frac{\\pi n_{\\mathrm{w}} C_6}{2} \\int_{z}^{\\infty} u^{-4} \\, du\n$$\n$$\n\\Phi_{\\text{att}}(z) = -\\frac{\\pi n_{\\mathrm{w}} C_6}{2} \\left[ \\frac{u^{-3}}{-3} \\right]_{z}^{\\infty} = -\\frac{\\pi n_{\\mathrm{w}} C_6}{2} \\left( 0 - \\frac{z^{-3}}{-3} \\right) = -\\frac{\\pi n_{\\mathrm{w}} C_6}{6z^3}\n$$\n这个解析结果是精确的，并且对所有 $z > 0$ 都是良态的，满足了问题对吸引部分的要求。它将被直接实现。\n\n**排斥贡献 ($\\Phi_{\\text{rep}}(z)$)**\n\n排斥部分为 $v_{\\text{rep}}(s) = A \\exp(-s/\\lambda)$。内层积分为：\n$$\n\\int_{u}^{\\infty} A e^{-s/\\lambda} s \\, ds = A \\int_{u}^{\\infty} s e^{-s/\\lambda} \\, ds\n$$\n使用分部积分法，$\\int s e^{ks} ds = \\frac{s}{k}e^{ks} - \\frac{1}{k^2}e^{ks}$，其中 $k = -1/\\lambda$：\n$$\nA \\left[ -\\lambda s e^{-s/\\lambda} - \\lambda^2 e^{-s/\\lambda} \\right]_{u}^{\\infty} = A \\left[ -\\lambda(\\lambda+s)e^{-s/\\lambda} \\right]_{u}^{\\infty} = A \\left( 0 - (-\\lambda(\\lambda+u)e^{-u/\\lambda}) \\right) = A\\lambda(\\lambda+u)e^{-u/\\lambda}\n$$\n于是，势的排斥贡献为：\n$$\n\\Phi_{\\text{rep}}(z) = 2\\pi n_{\\mathrm{w}} \\int_{z}^{\\infty} A\\lambda(\\lambda+u)e^{-u/\\lambda} \\, du\n$$\n根据问题的约束，我们必须使用一个特定的求积方案来计算这个积分。我们首先通过令 $x = u-z$，从而 $u = x+z$ 且 $du=dx$，将积分域从 $[z, \\infty)$ 变换到 $[0, \\infty)$：\n$$\n\\Phi_{\\text{rep}}(z) = 2\\pi n_{\\mathrm{w}} A\\lambda \\int_{0}^{\\infty} (\\lambda+x+z)e^{-(x+z)/\\lambda} \\, dx = 2\\pi n_{\\mathrm{w}} A\\lambda e^{-z/\\lambda} \\int_{0}^{\\infty} (\\lambda+z+x)e^{-x/\\lambda} \\, dx\n$$\n接下来，为了匹配目标权重函数 $e^{-t}$，我们进行替换 $t=x/\\lambda$，因此 $x=\\lambda t$ 且 $dx=\\lambda dt$：\n$$\n\\Phi_{\\text{rep}}(z) = 2\\pi n_{\\mathrm{w}} A\\lambda e^{-z/\\lambda} \\int_{0}^{\\infty} (\\lambda+z+\\lambda t)e^{-t} (\\lambda dt) = 2\\pi n_{\\mathrm{w}} A\\lambda^2 e^{-z/\\lambda} \\int_{0}^{\\infty} (\\lambda+z+\\lambda t)e^{-t} \\, dt\n$$\n这个积分的形式为 $\\int_0^\\infty g(t)e^{-t}dt$，其中 $g(t) = \\lambda+z+\\lambda t$。我们使用 Gauss-Laguerre 求积法来计算它，该方法将积分近似为一个加权和：\n$$\n\\int_0^\\infty g(t)e^{-t}dt \\approx \\sum_{i=1}^{N} w_i g(t_i)\n$$\n其中 $t_i$ 和 $w_i$ 是 N 阶 Gauss-Laguerre 求积法的节点和权重。由于 $g(t)$ 是一个一次多项式，对于任何 $N \\ge 1$，该求积法都是精确的。实现将按照规定，使用一组预先计算好的节点和权重来执行此数值求和。\n\n和为 $\\sum_{i=1}^{N} w_i (\\lambda+z+\\lambda t_i) = (\\lambda+z)\\sum w_i + \\lambda \\sum w_i t_i$。对于 Gauss-Laguerre 求积法，$\\sum w_i = 1$ 且 $\\sum w_i t_i = 1$，因此积分的值为 $(\\lambda+z) \\cdot 1 + \\lambda \\cdot 1 = z+2\\lambda$。排斥部分的最终表达式为：\n$$\n\\Phi_{\\text{rep}}(z) = 2\\pi n_{\\mathrm{w}} A \\lambda^2 (z+2\\lambda) e^{-z/\\lambda}\n$$\n代码将显式地实现求和，以遵守问题的约束。\n\n**总势**\n总势是两个贡献之和：\n$$\n\\Phi(z) = \\Phi_{\\text{rep}}(z) + \\Phi_{\\text{att}}(z) = 2\\pi n_{\\mathrm{w}} A \\lambda^2 (z+2\\lambda) e^{-z/\\lambda} - \\frac{\\pi n_{\\mathrm{w}} C_6}{6 z^3}\n$$\n这个完整的公式将用于计算给定测试用例的势能。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_laguerre\n\ndef solve():\n    \"\"\"\n    Computes the continuum-integrated wall potential for a Buckingham-type fluid\n    at a given height z above a semi-infinite planar wall.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # (z, n_w, A, lambda, C6) with units\n    # (nm, nm^-3, kJ/mol, nm, kJ*nm^6/mol)\n    test_cases = [\n        (0.020, 33.3, 1.0e6, 0.020, 0.00614),\n        (0.050, 33.3, 1.0e6, 0.020, 0.00614),\n        (0.500, 33.3, 1.0e6, 0.020, 0.00614),\n        (0.200, 33.3, 5.0e5, 0.030, 0.00614),\n        (1.000, 33.3, 1.0e6, 0.020, 0.03000),\n    ]\n\n    results = []\n    \n    # Set the order for Gauss-Laguerre quadrature.\n    # Since the integrand is linear, N=1 is sufficient for exactness.\n    # A higher number is used for robustness and to demonstrate the method.\n    N_QUADRATURE = 32\n    nodes, weights = roots_laguerre(N_QUADRATURE)\n\n    for case in test_cases:\n        z, nw, A, lam, C6 = case\n\n        # 1. Attractive contribution (analytically solved)\n        # Phi_att(z) = - (pi * n_w * C6) / (6 * z^3)\n        phi_att = - (np.pi * nw * C6) / (6 * z**3)\n\n        # 2. Repulsive contribution (numerical quadrature as required)\n        # The integral to be evaluated is of the form:\n        # integral from 0 to inf of g(t) * exp(-t) dt\n        # where g(t) = lam + z + lam * t\n        \n        # Define the function g(t) for the quadrature\n        g = lambda t: lam + z + lam * t\n        \n        # Evaluate the integral using Gauss-Laguerre quadrature sum\n        # integral_val = sum(w_i * g(t_i)) for i=1 to N\n        integral_val = np.sum(weights * g(nodes))\n        \n        # The full repulsive potential is:\n        # Phi_rep(z) = 2 * pi * n_w * A * lam^2 * exp(-z/lam) * integral_val\n        prefactor_rep = 2 * np.pi * nw * A * lam**2 * np.exp(-z / lam)\n        phi_rep = prefactor_rep * integral_val\n\n        # 3. Total potential\n        total_phi = phi_rep + phi_att\n        \n        # Round to six decimal places as specified\n        results.append(round(total_phi, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}