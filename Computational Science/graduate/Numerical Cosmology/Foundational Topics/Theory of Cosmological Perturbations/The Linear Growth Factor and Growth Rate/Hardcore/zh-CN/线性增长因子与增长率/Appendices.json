{
    "hands_on_practices": [
        {
            "introduction": "对宇宙结构演化的理解始于最简单的宇宙学模型：爱因斯坦-德西特（Einstein-de Sitter）宇宙。本练习将引导你完成一项基础性计算，以推导线性微扰的两个基本解——增长模式和衰减模式。通过从第一性原理出发求解控制性微分方程 ，你将深刻理解为何其中一种模式主导了结构的增长，而另一种模式则迅速变得无关紧要。",
            "id": "3496911",
            "problem": "考虑一个空间平坦、无压强物质主导的 Einstein–de Sitter 宇宙，它嵌入在 Friedmann–Lemaître–Robertson–Walker (FLRW) 度规中，其标度因子为 $a(t)$。在此背景中，线性视界内密度微扰 $\\delta(\\boldsymbol{x}, t)$ 遵循牛顿线性演化方程\n$$\\ddot{\\delta} + 2 H \\dot{\\delta} - 4 \\pi G \\rho \\,\\delta = 0,$$\n其中 $H(t) = \\dot{a}/a$ 是哈勃参数，$\\rho(t)$ 是背景物质密度，$G$ 是 Newton 的引力常数。仅使用平坦纯物质宇宙的 Friedmann 方程，\n$$H^{2}(t) = \\frac{8 \\pi G}{3}\\,\\rho(t),$$\n以及无压强物质的连续性方程，推导上述微扰方程的两个独立解随时间变化的一般行为。然后将衰减模式解重新表达为标度因子 $a$ 的函数，并确定其随 $a$ 的幂律标度关系。最后，通过计算乘性抑制因子来量化当 $a$ 从 $10^{-3}$ 变化到 $a=1$ 时，衰减模式相对于增长模式的振幅如何变化\n$$\\frac{\\left[\\delta_{\\text{dec}}(a)/\\delta_{\\text{grow}}(a)\\right]_{a=1}}{\\left[\\delta_{\\text{dec}}(a)/\\delta_{\\text{grow}}(a)\\right]_{a=10^{-3}}}.$$\n将抑制因子表示为一个单一的、精确的、未经舍入且无单位的解析表达式。",
            "solution": "核心任务是求解 Einstein–de Sitter 宇宙中视界内密度微扰 $\\delta$ 的线性常微分方程：\n$$\n\\ddot{\\delta} + 2 H \\dot{\\delta} - 4 \\pi G \\rho \\,\\delta = 0\n$$\n系数 $H(t)$ 和 $\\rho(t)$ 由背景宇宙学确定。对于一个空间平坦、无压强物质主导的宇宙，Friedmann 方程为：\n$$\nH^{2} = \\left(\\frac{\\dot{a}}{a}\\right)^{2} = \\frac{8 \\pi G}{3}\\,\\rho\n$$\n无压强物质 ($P=0$) 的连续性方程为 $\\dot{\\rho} + 3 H \\rho = 0$。这可以重写为 $\\frac{d\\rho}{\\rho} = -3 \\frac{da}{a}$，积分后得到背景物质密度的演化：\n$$\n\\rho(t) \\propto a(t)^{-3}\n$$\n将此代入 Friedmann 方程：\n$$\n\\left(\\frac{\\dot{a}}{a}\\right)^{2} \\propto a^{-3} \\implies \\dot{a}^{2} \\propto a^{-1} \\implies \\dot{a} \\propto a^{-1/2}\n$$\n这个关于标度因子 $a(t)$ 的微分方程可以通过分离变量法求解：\n$$\na^{1/2} da \\propto dt \\implies \\int a^{1/2} da \\propto \\int dt \\implies \\frac{2}{3} a^{3/2} \\propto t\n$$\n选择初始时间使得积分常数为零，我们得到 Einstein–de Sitter 宇宙中标度因子的特征时间演化：\n$$\na(t) \\propto t^{2/3}\n$$\n由此，我们可以将哈勃参数 $H(t)$ 和密度项 $4 \\pi G \\rho$ 明确地表示为时间 $t$ 的函数。设 $a(t) = C t^{2/3}$，其中 $C$ 为某个常数。\n哈勃参数为：\n$$\nH(t) = \\frac{\\dot{a}}{a} = \\frac{\\frac{2}{3} C t^{-1/3}}{C t^{2/3}} = \\frac{2}{3t}\n$$\n使用 Friedmann 方程，我们可以将密度项表示为：\n$$\n4 \\pi G \\rho = \\frac{3}{2} H^{2} = \\frac{3}{2} \\left(\\frac{2}{3t}\\right)^{2} = \\frac{3}{2} \\left(\\frac{4}{9t^2}\\right) = \\frac{2}{3t^2}\n$$\n现在，我们将这些随时间变化的系数代入微扰演化方程：\n$$\n\\ddot{\\delta} + 2 \\left(\\frac{2}{3t}\\right) \\dot{\\delta} - \\left(\\frac{2}{3t^2}\\right) \\delta = 0\n$$\n$$\n\\ddot{\\delta} + \\frac{4}{3t} \\dot{\\delta} - \\frac{2}{3t^2} \\delta = 0\n$$\n这是一个二阶线性齐次微分方程，属于欧拉-柯西型。我们寻求 $\\delta(t) \\propto t^{n}$ 形式的幂律解。将此假设及其导数 $\\dot{\\delta} \\propto n t^{n-1}$ 和 $\\ddot{\\delta} \\propto n(n-1) t^{n-2}$ 代入方程得到：\n$$\nn(n-1)t^{n-2} + \\frac{4}{3t} (n t^{n-1}) - \\frac{2}{3t^2} (t^n) = 0\n$$\n两边同除以 $t^{n-2}$ 得到指数 $n$ 的特征方程：\n$$\nn(n-1) + \\frac{4}{3}n - \\frac{2}{3} = 0\n$$\n$$\nn^2 - n + \\frac{4}{3}n - \\frac{2}{3} = 0\n$$\n$$\nn^2 + \\frac{1}{3}n - \\frac{2}{3} = 0\n$$\n乘以 $3$ 以消去分母，我们得到一个简单的二次方程：\n$$\n3n^2 + n - 2 = 0\n$$\n这可以因式分解为 $(3n - 2)(n + 1) = 0$。两个根是：\n$$\nn_1 = \\frac{2}{3} \\quad \\text{和} \\quad n_2 = -1\n$$\n这些指数对应于密度微扰时间演化的两个独立解：\n1.  增长模式：$\\delta_{\\text{grow}}(t) \\propto t^{2/3}$\n2.  衰减模式：$\\delta_{\\text{dec}}(t) \\propto t^{-1}$\n\n通解是这两种模式的线性组合：$\\delta(t) = C_1 t^{2/3} + C_2 t^{-1}$。\n\n接下来，我们将这些解重新表达为标度因子 $a$ 的函数。我们有关系式 $a(t) \\propto t^{2/3}$，这意味着 $t \\propto a^{3/2}$。\n增长模式变为：\n$$\n\\delta_{\\text{grow}}(a) \\propto (a^{3/2})^{2/3} = a^1\n$$\n衰减模式变为：\n$$\n\\delta_{\\text{dec}}(a) \\propto (a^{3/2})^{-1} = a^{-3/2}\n$$\n因此，衰减模式随标度因子 $a$ 的幂律标度关系为 $a^{-3/2}$。\n\n最后，我们必须量化当宇宙从 $a=10^{-3}$ 膨胀到 $a=1$ 时，衰减模式相对于增长模式的抑制程度。我们将衰减模式与增长模式的振幅之比定义为 $R(a)$：\n$$\nR(a) = \\frac{\\delta_{\\text{dec}}(a)}{\\delta_{\\text{grow}}(a)}\n$$\n设 $\\delta_{\\text{dec}}(a) = K_2 a^{-3/2}$ 且 $\\delta_{\\text{grow}}(a) = K_1 a^1$，其中 $K_1$ 和 $K_2$ 是由初始条件决定的常数。该比率为：\n$$\nR(a) = \\frac{K_2 a^{-3/2}}{K_1 a^1} = \\frac{K_2}{K_1} a^{-3/2 - 1} = \\frac{K_2}{K_1} a^{-5/2}\n$$\n题目要求的是乘性抑制因子，即该量在 $a=1$ 时的值与在 $a=10^{-3}$ 时的值之比：\n$$\n\\text{抑制因子} = \\frac{R(a=1)}{R(a=10^{-3})} = \\frac{\\left(\\frac{K_2}{K_1}\\right) (1)^{-5/2}}{\\left(\\frac{K_2}{K_1}\\right) (10^{-3})^{-5/2}}\n$$\n常数项相消，剩下：\n$$\n\\text{抑制因子} = \\frac{1}{(10^{-3})^{-5/2}} = \\frac{1}{10^{(-3) \\times (-5/2)}} = \\frac{1}{10^{15/2}} = 10^{-15/2}\n$$\n这就是抑制因子的精确解析表达式。",
            "answer": "$$\\boxed{10^{-15/2}}$$"
        },
        {
            "introduction": "虽然爱因斯坦-德西特模型提供了精确解，但像 $\\Lambda$CDM 这样的实际宇宙学模型需要更复杂的方法。物理学中一个强大的技术是寻找精确的近似关系，本练习将重点推导关于增长率的著名关系式 $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$。通过在物质主导时期附近进行渐近分析 ，你将揭示增长指数 $\\gamma$ 的理论来源，并体会到解析近似如何能够抓住复杂系统的本质物理。",
            "id": "3496886",
            "problem": "考虑在一个空间平坦的Λ冷暗物质 (ΛCDM) 宇宙学模型中，物质密度扰动的线性增长。设线性增长因子用 $D(a)$ 表示，线性增长率定义为 $f(a) \\equiv \\frac{d \\ln D}{d \\ln a}$。在线性理论中，对数增长率 $f(a)$ 服从以下微分方程\n$$\nf' + f^{2} + \\left(2 + \\frac{d \\ln H}{d \\ln a}\\right) f = \\frac{3}{2} \\Omega_{\\rm m}(a),\n$$\n其中撇号表示对 $\\ln a$ 的微分，$H(a)$ 是作为标度因子 $a$ 的函数的哈勃参数，而 $\\Omega_{\\rm m}(a)$ 是作为 $a$ 的函数的物质密度参数。\n\n在一个具有当今参数 $\\Omega_{{\\rm m},0}$ 和 $\\Omega_{\\Lambda,0}$（满足 $\\Omega_{{\\rm m},0} + \\Omega_{\\Lambda,0} = 1$）的平坦ΛCDM背景中，背景膨胀由下式给出\n$$\nE(a) \\equiv \\frac{H(a)}{H_{0}} = \\left[\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0}\\right]^{1/2}, \\quad \\Omega_{\\rm m}(a) = \\frac{\\Omega_{{\\rm m},0} a^{-3}}{E(a)^{2}}.\n$$\n从这些定义和上述增长率方程出发，围绕物质主导时期 $\\Omega_{\\rm m}(a) \\to 1$ 进行渐近分析，以获得近似关系 $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$，其中指数 $\\gamma$ 为常数（与 $a$ 无关）。通过在小参数 $\\epsilon \\equiv 1 - \\Omega_{\\rm m}(a)$ 中一致地展开到一阶，并逐阶强制满足增长率方程，来确定 $\\gamma$ 的值。\n\n请将您最终的 $\\gamma$ 答案表示为一个精确的有理数。无需四舍五入，也无需报告单位。",
            "solution": "目标是通过在物质主导极限 $\\Omega_{\\rm m}(a) \\to 1$ 附近展开控制性微分方程，来确定近似式 $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$ 中指数 $\\gamma$ 的值。我们定义小参数 $\\epsilon \\equiv 1 - \\Omega_{\\rm m}(a)$。分析将通过把微分方程的每一项对 $\\epsilon$ 展开到一阶来进行。\n\n控制方程为：\n$$\nf' + f^{2} + \\left(2 + \\frac{d \\ln H}{d \\ln a}\\right) f = \\frac{3}{2} \\Omega_{\\rm m}(a)\n$$\n其中 $f' \\equiv \\frac{df}{d\\ln a}$。\n\n首先，我们将涉及 $f(a)$ 的项展开为 $\\epsilon$ 的幂级数：\n对 $f$ 的近似为 $f(a) = \\Omega_{\\rm m}(a)^{\\gamma} = (1-\\epsilon)^{\\gamma}$。对小 $\\epsilon$ 使用泰勒展开：\n$$\nf(a) \\approx 1 - \\gamma\\epsilon + O(\\epsilon^2)\n$$\n将其平方得到：\n$$\nf(a)^2 \\approx (1 - \\gamma\\epsilon)^2 = 1 - 2\\gamma\\epsilon + \\gamma^2\\epsilon^2 \\approx 1 - 2\\gamma\\epsilon + O(\\epsilon^2)\n$$\n接下来，我们确定 $f'$ 项。根据链式法则，$f' = \\frac{df}{d\\ln a} = \\frac{df}{d\\Omega_{\\rm m}} \\frac{d\\Omega_{\\rm m}}{d\\ln a}$。\n由 $f = \\Omega_{\\rm m}^{\\gamma}$，我们有 $\\frac{df}{d\\Omega_{\\rm m}} = \\gamma \\Omega_{\\rm m}^{\\gamma-1}$。\n我们必须找到 $\\frac{d\\Omega_{\\rm m}}{d\\ln a}$ 的表达式。可以证明，对于平坦的 $\\Lambda$CDM 模型，$\\frac{d\\Omega_{\\rm m}}{d\\ln a} = -3\\Omega_{\\rm m}(a)(1 - \\Omega_{\\rm m}(a))$。\n现在我们可以写出 $f'$：\n$$\nf' = (\\gamma \\Omega_{\\rm m}^{\\gamma-1})(-3\\Omega_{\\rm m}(1-\\Omega_{\\rm m})) = -3\\gamma \\Omega_{\\rm m}^{\\gamma} (1-\\Omega_{\\rm m})\n$$\n用 $\\epsilon$ 表示：\n$$\nf' = -3\\gamma (1-\\epsilon)^{\\gamma} \\epsilon \\approx -3\\gamma (1) \\epsilon = -3\\gamma\\epsilon + O(\\epsilon^2)\n$$\n接下来，我们计算依赖于哈勃参数的项 $\\frac{d \\ln H}{d \\ln a}$。对于平坦的 $\\Lambda$CDM 模型，可以推导出：\n$$\n\\frac{d \\ln H}{d \\ln a} = -\\frac{3}{2}\\Omega_{\\rm m}(a) = -\\frac{3}{2}(1-\\epsilon)\n$$\n因此，主方程中 $f$ 的系数为：\n$$\n2 + \\frac{d \\ln H}{d \\ln a} = 2 - \\frac{3}{2}(1-\\epsilon) = 2 - \\frac{3}{2} + \\frac{3}{2}\\epsilon = \\frac{1}{2} + \\frac{3}{2}\\epsilon\n$$\n现在我们将所有展开的项代回微分方程：\n$$\nf' + f^{2} + \\left(2 + \\frac{d \\ln H}{d \\ln a}\\right) f = \\frac{3}{2} \\Omega_{\\rm m}(a)\n$$\n$$\n(-3\\gamma\\epsilon) + (1 - 2\\gamma\\epsilon) + \\left(\\frac{1}{2} + \\frac{3}{2}\\epsilon\\right) (1 - \\gamma\\epsilon) = \\frac{3}{2}(1-\\epsilon)\n$$\n我们展开乘积，保留到 $\\epsilon$ 的一阶项：\n$$\n\\left(\\frac{1}{2} + \\frac{3}{2}\\epsilon\\right) (1 - \\gamma\\epsilon) = \\frac{1}{2} - \\frac{\\gamma}{2}\\epsilon + \\frac{3}{2}\\epsilon - \\frac{3\\gamma}{2}\\epsilon^2 \\approx \\frac{1}{2} + \\left(\\frac{3}{2} - \\frac{\\gamma}{2}\\right)\\epsilon\n$$\n将此代入方程：\n$$\n-3\\gamma\\epsilon + 1 - 2\\gamma\\epsilon + \\frac{1}{2} + \\left(\\frac{3}{2} - \\frac{\\gamma}{2}\\right)\\epsilon = \\frac{3}{2} - \\frac{3}{2}\\epsilon\n$$\n现在，我们收集 $\\epsilon$ 的同阶项。\n零阶 ($O(\\epsilon^0)$):\n$$\n1 + \\frac{1}{2} = \\frac{3}{2}\n$$\n这是一个恒等式 $\\frac{3}{2} = \\frac{3}{2}$，这证实了零阶近似（当 $\\Omega_{\\rm m}=1$ 时 $f=1$）的一致性。\n一阶 ($O(\\epsilon^1)$):\n我们收集所有 $\\epsilon$ 的系数：\n$$\n-3\\gamma - 2\\gamma + \\frac{3}{2} - \\frac{\\gamma}{2} = -\\frac{3}{2}\n$$\n现在，我们求解这个关于 $\\gamma$ 的线性方程：\n$$\n-5\\gamma - \\frac{\\gamma}{2} = -\\frac{3}{2} - \\frac{3}{2}\n$$\n$$\n-\\frac{10\\gamma}{2} - \\frac{\\gamma}{2} = -3\n$$\n$$\n-\\frac{11\\gamma}{2} = -3\n$$\n$$\n11\\gamma = 6\n$$\n$$\n\\gamma = \\frac{6}{11}\n$$\n指数的值是 $\\frac{6}{11}$。这是ΛCDM宇宙学中增长指数的一个著名结果。",
            "answer": "$$\n\\boxed{\\frac{6}{11}}\n$$"
        },
        {
            "introduction": "解析近似非常强大，但其有效性和准确性必须始终经过检验。这项计算练习为你架起理论与实践之间的桥梁，要求你在 $\\Lambda$CDM 宇宙中数值求解增长率 $f(a)$ 的完整微分方程。通过将你的高精度数值结果与 $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$ 近似进行比较 ，你将能够量化其误差范围，并掌握检验和验证宇宙学代码的基本技能。",
            "id": "3496854",
            "problem": "考虑一个空间平坦的冷暗物质加宇宙学常数模型中的线性微扰理论，其中宇宙尺度因子用 $a$ 表示，哈勃参数用 $H(a)$ 表示，当今物质密度参数用 $\\Omega_{\\rm m0}$ 表示。线性增长因子 $D(a)$ 的演化遵循一个二阶常微分方程，该方程源于广义相对论 (GR) 在弗里德曼-勒梅特-罗伯逊-沃克背景下的牛顿极限，并以变量 $x=\\ln a$ 表示为\n$$\n\\frac{d^2 D}{dx^2} + \\left[2 + \\frac{d \\ln H}{d \\ln a}\\right] \\frac{d D}{dx} - \\frac{3}{2}\\,\\Omega_{\\rm m}(a)\\, D = 0,\n$$\n其中物质组分 $\\Omega_{\\rm m}(a)$ 定义为\n$$\n\\Omega_{\\rm m}(a) = \\frac{\\Omega_{\\rm m0}\\, a^{-3}}{\\Omega_{\\rm m0}\\, a^{-3} + \\Omega_{\\Lambda 0}},\n$$\n对于空间平坦的情况，$\\Omega_{\\Lambda 0} = 1 - \\Omega_{\\rm m0}$，并且\n$$\n\\frac{d \\ln H}{d \\ln a} = -\\frac{3}{2}\\,\\Omega_{\\rm m}(a)\n$$\n此式由平坦的宇宙学常数 (Lambda) 背景下的 $H^2(a) \\propto \\Omega_{\\rm m0}\\, a^{-3} + \\Omega_{\\Lambda 0}$ 推导得出。\n\n定义线性增长率 $f(a)$ 为\n$$\nf(a) = \\frac{d \\ln D}{d \\ln a}.\n$$\n一个常用的近似是 $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$，其中 $\\gamma$ 是一个常数指数。您的任务是，对于 $\\Omega_{\\rm m0} = 0.3$，在红移区间 $0 \\le z \\le 2$ 内，通过与上述微分方程的数值积分解得到的 $f(a)$ 进行比较，来量化当 $\\gamma = 0.55$ 时该近似的分数误差。\n\n在您的推导和实现中，请使用以下基本出发点：\n- 空间平坦的宇宙学常数加物质宇宙的背景膨胀定律，$H^2(a) \\propto \\Omega_{\\rm m0}\\, a^{-3} + \\Omega_{\\Lambda 0}$ 且 $\\Omega_{\\Lambda 0} = 1 - \\Omega_{\\rm m0}$。\n- 上述给出的关于 $x=\\ln a$ 的线性增长因子方程 $D(a)$。\n- 定义 $f(a) = \\left(d \\ln D / d \\ln a\\right)$。\n\n不要引入任何绕过这些基本出发点的捷径公式。通过对 $D(a)$ 的二阶常微分方程进行数值积分，并从数值解中计算 $f(a) = \\left(\\frac{d D}{dx}\\right)/D$ 来明确地获得 $f(a)$。\n\n初始条件设定：\n- 选择 $a_{\\rm ini} = 10^{-3}$，并通过设置 $D(a_{\\rm ini}) = a_{\\rm ini}$ 和 $\\left.\\frac{d D}{dx}\\right|_{a_{\\rm ini}} = D(a_{\\rm ini})$ 来施加早期物质主导的渐近标度关系 $D(a) \\propto a$。这确保了在 $a \\ll 1$ 时 $f(a_{\\rm ini}) \\to 1$，与 $D \\propto a$ 一致。\n\n定义在给定 $a$ 处的分数误差为\n$$\n\\varepsilon(a) = \\frac{f_{\\rm approx}(a) - f_{\\rm true}(a)}{f_{\\rm true}(a)},\n$$\n其中 $f_{\\rm approx}(a) = \\Omega_{\\rm m}(a)^{\\gamma}$，$f_{\\rm true}(a)$ 从数值解中获得。\n\n在红移范围 $z \\in [0,2]$（其中 $a = 1/(1+z)$）上数值评估误差。构建两个在 $z$ 上的均匀网格：\n- 一个包含端点 $z=0$ 和 $z=2$ 的 $N_{\\rm fine} = 401$ 个点的精细网格。\n- 一个包含端点 $z=0$ 和 $z=2$ 的 $N_{\\rm coarse} = 41$ 个点的粗糙网格。\n\n测试套件和要求的度量指标：\n- 测试 1 (正常路径): 在精细网格上计算最大绝对分数误差 $\\max_{0z2}|\\varepsilon(z)|$。\n- 测试 2 (正常路径): 在粗糙网格上计算最大绝对分数误差 $\\max_{0z2}|\\varepsilon(z)|$。\n- 测试 3 (边界值): 在 $z=0$ 处计算有符号分数误差 $\\varepsilon(z=0)$。\n- 测试 4 (边界值): 在 $z=2$ 处计算有符号分数误差 $\\varepsilon(z=2)$。\n\n将这四个度量指标（按顺序）作为浮点数列表返回，例如 `[0.0152,-0.01,0.005,-0.002]`。",
            "solution": "本问题的解决方案涉及以下几个步骤，这些步骤在提供的 Python 代码中得以实现：\n1.  **定义宇宙学模型**: 根据问题设定，我们使用平坦 $\\Lambda$CDM 模型，并指定 $\\Omega_{\\rm m0} = 0.3$ 和 $\\Omega_{\\Lambda 0} = 0.7$。增长指数近似中的 $\\gamma$ 设为 $0.55$。\n2.  **建立微分方程系统**: 原始的二阶常微分方程通过定义状态向量 $\\mathbf{Y} = [D, dD/dx]$ 被转换为一个一阶常微分方程组：\n    $$\n    \\frac{d}{dx} \\begin{pmatrix} D \\\\ dD/dx \\end{pmatrix} = \\begin{pmatrix} dD/dx \\\\ -\\left[2 - \\frac{3}{2}\\Omega_{\\rm m}(a)\\right]\\frac{dD}{dx} + \\frac{3}{2}\\Omega_{\\rm m}(a)D \\end{pmatrix}\n    $$\n    其中 $x = \\ln a$，并且我们使用了关系式 $\\frac{d \\ln H}{d \\ln a} = -\\frac{3}{2}\\Omega_{\\rm m}(a)$。\n3.  **设定初始条件**: 我们在早期的物质主导时期（$a_{\\rm ini} = 10^{-3}$）设定初始条件。根据 $D(a) \\propto a$ 的渐近行为，我们设定 $D(a_{\\rm ini}) = a_{\\rm ini}$ 和 $(dD/dx)|_{a_{\\rm ini}} = D(a_{\\rm ini})$，这确保了初始增长率 $f(a_{\\rm ini})=1$。\n4.  **数值积分**: 使用高精度的数值积分器（如 `scipy.integrate.solve_ivp` 中的 Runge-Kutta 方法）从 $x_{\\rm ini} = \\ln(a_{\\rm ini})$ 积分到 $x=0$ (对应 $z=0$)。积分在包含所有评估点的网格上进行，以确保精度。\n5.  **计算增长率和误差**: 从数值解中，我们得到“真实”的增长率 $f_{\\rm true}(a) = \\frac{dD/dx}{D}$。同时，我们计算近似增长率 $f_{\\rm approx}(a) = \\Omega_{\\rm m}(a)^{\\gamma}$。然后，根据定义计算分数误差 $\\varepsilon(a)$。\n6.  **提取度量指标**: 最后，从计算出的误差函数 $\\varepsilon(z)$ 中提取并报告问题中指定的四个度量指标：精细网格和粗糙网格上的最大绝对误差，以及在 $z=0$ 和 $z=2$ 处的有符号误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the linear growth factor ODE, computes the growth rate, and evaluates\n    the fractional error of the f ~ Omega_m^gamma approximation.\n    \"\"\"\n    \n    # 1. Define cosmological and problem parameters\n    Omega_m0 = 0.3\n    Omega_L0 = 1.0 - Omega_m0\n    gamma = 0.55\n    a_ini = 1e-3\n\n    # 2. Define the grids for evaluation\n    N_fine = 401\n    N_coarse = 41\n    z_fine = np.linspace(0.0, 2.0, N_fine)\n    z_coarse = np.linspace(0.0, 2.0, N_coarse)\n    \n    # Create a single, sorted, unique grid of all z-points for one master integration\n    z_combined = np.union1d(z_fine, z_coarse)\n\n    # Convert z grids to x = ln(a) grids for the ODE solver\n    # Note: a = 1 / (1 + z)\n    x_ini = np.log(a_ini)\n    x_combined = np.log(1.0 / (1.0 + z_combined))\n    \n    # The solver requires a sorted array of evaluation times (t_eval)\n    x_eval = np.unique(np.concatenate(([x_ini], x_combined)))\n\n    # 3. Define the system of first-order ODEs\n    # Y = [D, dD/dx]\n    def ode_system(x, Y, Om0, OL0):\n        \"\"\"\n        Defines the ODE system dY/dx for the linear growth factor.\n        x: independent variable, ln(a)\n        Y: state vector [D, dD/dx]\n        Om0, OL0: cosmological parameters\n        \"\"\"\n        D, dDdx = Y\n        \n        # Calculate Omega_m(a) at the given x = ln(a)\n        # Omega_m(a) = (Om0 * a^-3) / (Om0 * a^-3 + OL0)\n        # Use a = exp(x) -> a^-3 = exp(-3x) for numerical stability\n        num = Om0 * np.exp(-3.0 * x)\n        den = num + OL0\n        Omega_m_a = num / den\n        \n        # Second derivative from the rearranged growth equation:\n        # d^2D/dx^2 = -[2 - 1.5*Omega_m(a)]*(dD/dx) + 1.5*Omega_m(a)*D\n        d2Ddx2 = -(2.0 - 1.5 * Omega_m_a) * dDdx + 1.5 * Omega_m_a * D\n        \n        return [dDdx, d2Ddx2]\n\n    # 4. Set initial conditions and solve the ODE\n    # Initial conditions for matter-dominated growing mode: D=a, dD/dx=D\n    y_ini = np.array([a_ini, a_ini])\n    x_span = [x_ini, 0.0] # Integrate from x_ini up to today (x=0)\n    \n    sol = solve_ivp(\n        ode_system,\n        x_span,\n        y_ini,\n        method='RK45',\n        t_eval=x_eval,\n        args=(Omega_m0, Omega_L0),\n        rtol=1e-9,  # High precision for accurate error calculation\n        atol=1e-12\n    )\n\n    # 5. Calculate true and approximate growth rates and the fractional error\n    # The solution is returned at x_eval points, which is sol.t\n    x_solution = sol.t\n    D_solution = sol.y[0]\n    dDdx_solution = sol.y[1]\n    \n    # True growth rate: f_true = (dD/dx) / D\n    f_true = dDdx_solution / D_solution\n    \n    # Approximate growth rate: f_approx = Omega_m(a)^gamma\n    a_solution = np.exp(x_solution)\n    Omega_m_solution = (Omega_m0 * a_solution**-3) / (Omega_m0 * a_solution**-3 + Omega_L0)\n    f_approx = Omega_m_solution**gamma\n    \n    # Fractional error\n    errors = (f_approx - f_true) / f_true\n\n    # 6. Extract metrics for test cases by mapping solution back to z-grids\n    # Use np.interp as a robust lookup, since x_eval contains all our points.\n    # np.interp requires xp to be increasing, which sol.t is.\n    # The x-grids corresponding to z-grids are decreasing, so we flip them.\n    \n    x_fine = np.log(1.0 / (1.0 + z_fine))\n    errors_fine = np.interp(np.flip(x_fine), x_solution, errors)\n    errors_fine = np.flip(errors_fine) # Flip back to match z_fine ordering\n    \n    x_coarse = np.log(1.0 / (1.0 + z_coarse))\n    errors_coarse = np.interp(np.flip(x_coarse), x_solution, errors)\n    errors_coarse = np.flip(errors_coarse) # Flip back to match z_coarse ordering\n\n    # Test 1: Max absolute error on fine grid interior (0  z  2)\n    max_err_fine = np.max(np.abs(errors_fine[1:-1]))\n    \n    # Test 2: Max absolute error on coarse grid interior (0  z  2)\n    max_err_coarse = np.max(np.abs(errors_coarse[1:-1]))\n\n    # Test 3: Signed error at z=0\n    # This corresponds to the first element of z_fine and errors_fine\n    err_z0 = errors_fine[0]\n\n    # Test 4: Signed error at z=2\n    # This corresponds to the last element of z_fine and errors_fine\n    err_z2 = errors_fine[-1]\n\n    results = [max_err_fine, max_err_coarse, err_z0, err_z2]\n\n    # 7. Print the final results in the required format\n    # Example format: [0.0152,-0.01,0.005,-0.002]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}