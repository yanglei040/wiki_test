{
    "hands_on_practices": [
        {
            "introduction": "Beyond simply measuring the size of numerical errors, a deeper understanding comes from analyzing their character. This exercise uses backward error analysis to reveal the systematic bias introduced by the classical RK4 method in a long-term cosmological integration . By deriving the \"modified equation\"—the differential equation that the numerical method effectively solves exactly—you will quantify how the integrator's imperfections lead to a predictable drift in a key physical quantity, the number of e-folds, providing crucial insight into the long-term fidelity of numerical simulations.",
            "id": "3484645",
            "problem": "Consider a spatially flat Lambda Cold Dark Matter (ΛCDM) cosmology with scale factor $a(t)$ obeying the Friedmann equation in the form $\\dot{a}(t)=H(a)\\,a(t)$, where $H(a)=H_{0}\\sqrt{\\Omega_{m}a^{-3}+\\Omega_{\\Lambda}}$, $H_{0}>0$ is the present Hubble parameter, $\\Omega_{m}\\ge 0$ is the matter density parameter, and $\\Omega_{\\Lambda}\\ge 0$ is the cosmological constant density parameter. Let the e-fold variable be $N(t)=\\ln a(t)$, so that $\\dot{N}(t)=H(a(t))$. Consider advancing $a(t)$ in cosmic time $t$ using the classical fourth-order Runge-Kutta (RK4) method with a uniform step size $h>0$.\n\nFocus on a late-time interval of duration sufficient to accumulate $\\Delta N=10$ e-folds during which the cosmological constant dominates, in the sense that $\\Omega_{m}\\exp(-3N)\\ll \\Omega_{\\Lambda}$ throughout the interval. In this regime, take $H(a)\\approx H_{\\Lambda}$ with $H_{\\Lambda}=H_{0}\\sqrt{\\Omega_{\\Lambda}}$ constant, so the evolution is effectively $\\dot{a}=H_{\\Lambda}\\,a$.\n\nStarting from first principles, carry out a backward error analysis for the RK4 method applied to the scalar linear ordinary differential equation $\\dot{y}=\\lambda\\,y$ with constant $\\lambda$, and determine the leading nonvanishing correction term in the modified equation (the autonomous differential equation whose exact flow matches one RK4 step) up to order $h^{4}$. Specialize your result to $\\lambda=H_{\\Lambda}$, translate the modified equation into the drift in $N(t)=\\ln a(t)$, and use it to obtain the leading-order long-time bias in the accumulated e-folds over the interval where the true solution undergoes exactly $\\Delta N=10$ e-folds. Conclude with a closed-form expression for the leading-order bias $\\Delta N_{\\mathrm{bias}}=N_{\\mathrm{RK4}}-10$ as a function of $h$, $H_{0}$, and $\\Omega_{\\Lambda}$.\n\nExpress your final result as a single closed-form analytical expression in terms of $h$, $H_{0}$, and $\\Omega_{\\Lambda}$. Do not include units. No numerical rounding is required.",
            "solution": "The user wants to find the leading-order bias in the accumulated e-folds when numerically integrating the Friedmann equation in a cosmological constant-dominated regime using the RK4 method. This requires a backward error analysis.\n\n### Step 1: Problem Validation\n\nI will first extract the givens and validate the problem statement.\n\n**Givens:**\n1.  **Cosmology**: Spatially flat Lambda Cold Dark Matter (ΛCDM) model.\n2.  **Equation of Motion**: The scale factor $a(t)$ evolves according to the Friedmann equation $\\dot{a}(t)=H(a)\\,a(t)$.\n3.  **Hubble Parameter**: $H(a)=H_{0}\\sqrt{\\Omega_{m}a^{-3}+\\Omega_{\\Lambda}}$, with parameters $H_{0}>0$, $\\Omega_{m}\\ge 0$, and $\\Omega_{\\Lambda}\\ge 0$. Since the cosmology is flat, $\\Omega_m + \\Omega_\\Lambda = 1$.\n4.  **E-fold Variable**: $N(t)=\\ln a(t)$, which implies $\\dot{N}(t)=H(a(t))$.\n5.  **Numerical Method**: Classical fourth-order Runge-Kutta (RK4) with uniform step size $h>0$.\n6.  **Physical Regime**: Late-time evolution where the cosmological constant dominates, i.e., $\\Omega_{m}\\exp(-3N)\\ll \\Omega_{\\Lambda}$.\n7.  **Approximation**: In this regime, the Hubble parameter is approximated as constant, $H(a)\\approx H_{\\Lambda}$, where $H_{\\Lambda}=H_{0}\\sqrt{\\Omega_{\\Lambda}}$.\n8.  **Effective ODE**: The evolution of the scale factor is described by the linear ordinary differential equation (ODE) $\\dot{a}=H_{\\Lambda}\\,a$.\n9.  **Task 1**: Perform a backward error analysis for the generic scalar linear ODE $\\dot{y}=\\lambda\\,y$ with constant $\\lambda$.\n10. **Task 2**: Determine the leading nonvanishing correction term in the modified equation up to order $h^{4}$.\n11. **Task 3**: Specialize the result to the cosmological case by setting $\\lambda=H_{\\Lambda}$.\n12. **Task 4**: Translate the modified equation for $a(t)$ into a modified evolution equation for $N(t)$.\n13. **Task 5**: Calculate the leading-order long-time bias $\\Delta N_{\\mathrm{bias}}=N_{\\mathrm{RK4}}-10$ over an interval where the true solution accumulates exactly $\\Delta N=10$ e-folds.\n14. **Final Result**: The bias should be a closed-form expression in terms of $h$, $H_{0}$, and $\\Omega_{\\Lambda}$.\n\n**Validation Verdict:**\nThe problem is scientifically grounded, being based on the standard ΛCDM model and standard numerical analysis techniques (backward error analysis of RK4). The approximation of a constant Hubble parameter in the late, $\\Omega_\\Lambda$-dominated universe is a standard and valid simplification. The problem is well-posed, with a clear objective and a structured path to the solution. The language is precise and objective. All necessary information is provided, and there are no internal contradictions. The problem is a valid theoretical exercise in numerical cosmology. Therefore, I will proceed with the solution.\n\n### Step 2: Backward Error Analysis of RK4 for $\\dot{y} = \\lambda y$\n\nThe problem requires a backward error analysis starting from first principles for the ODE $\\dot{y}=\\lambda y$. A single step of the classical RK4 method from $y_n = y(t_n)$ to $y_{n+1} = y(t_n+h)$ is given by\n$$y_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$\nwhere the stages $k_i$ for the function $f(y)=\\lambda y$ are:\n$$k_1 = f(y_n) = \\lambda y_n$$\n$$k_2 = f(y_n + \\frac{h}{2}k_1) = \\lambda(y_n + \\frac{h}{2}\\lambda y_n) = \\lambda y_n (1 + \\frac{h\\lambda}{2})$$\n$$k_3 = f(y_n + \\frac{h}{2}k_2) = \\lambda(y_n + \\frac{h}{2}\\lambda y_n(1 + \\frac{h\\lambda}{2})) = \\lambda y_n (1 + \\frac{h\\lambda}{2} + \\frac{h^2\\lambda^2}{4})$$\n$$k_4 = f(y_n + hk_3) = \\lambda(y_n + h\\lambda y_n(1 + \\frac{h\\lambda}{2} + \\frac{h^2\\lambda^2}{4})) = \\lambda y_n (1 + h\\lambda + \\frac{h^2\\lambda^2}{2} + \\frac{h^3\\lambda^3}{4})$$\nSubstituting these into the RK4 formula:\n$$y_{n+1} = y_n + \\frac{h\\lambda y_n}{6} \\left[ 1 + 2(1+\\frac{h\\lambda}{2}) + 2(1+\\frac{h\\lambda}{2}+\\frac{h^2\\lambda^2}{4}) + (1+h\\lambda+\\frac{h^2\\lambda^2}{2}+\\frac{h^3\\lambda^3}{4}) \\right]$$\nCombining terms by powers of $h\\lambda$:\n$$y_{n+1} = y_n + \\frac{h\\lambda y_n}{6} \\left[ (1+2+2+1) + (1+1+1)h\\lambda + (\\frac{1}{2}+\\frac{1}{2})h^2\\lambda^2 + \\frac{1}{4}h^3\\lambda^3 \\right]$$\n$$y_{n+1} = y_n + \\frac{h\\lambda y_n}{6} \\left[ 6 + 3h\\lambda + h^2\\lambda^2 + \\frac{1}{4}h^3\\lambda^3 \\right]$$\n$$y_{n+1} = y_n + \\left( h\\lambda + \\frac{(h\\lambda)^2}{2} + \\frac{(h\\lambda)^3}{6} + \\frac{(h\\lambda)^4}{24} \\right) y_n$$\nSo, the one-step update is $y_{n+1} = R(h\\lambda) y_n$, where $R(z)$ is the stability function of the RK4 method:\n$$R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}$$\nThis expression is the Taylor series of $\\exp(z)$ truncated at the $z^4$ term.\n\nBackward error analysis seeks a modified differential equation, $\\dot{\\tilde{y}} = \\tilde{f}(\\tilde{y})$, whose exact solution after one step $h$ coincides with the numerical solution. For our linear problem, we assume a modified equation of the form $\\dot{\\tilde{y}} = \\tilde{\\lambda}\\tilde{y}$. The exact solution to this equation is $\\tilde{y}(t+h) = \\exp(h\\tilde{\\lambda})\\tilde{y}(t)$.\nEquating the exact flow of the modified equation with the numerical one-step map, we get:\n$$\\exp(h\\tilde{\\lambda}) = R(h\\lambda) = 1 + h\\lambda + \\frac{(h\\lambda)^2}{2} + \\frac{(h\\lambda)^3}{6} + \\frac{(h\\lambda)^4}{24}$$\nTo find $\\tilde{\\lambda}$, we take the natural logarithm of both sides:\n$$h\\tilde{\\lambda} = \\ln\\left(1 + h\\lambda + \\frac{(h\\lambda)^2}{2} + \\frac{(h\\lambda)^3}{6} + \\frac{(h\\lambda)^4}{24}\\right)$$\nThe expression inside the logarithm can be related to $\\exp(h\\lambda)$:\n$$\\exp(h\\lambda) = 1 + h\\lambda + \\frac{(h\\lambda)^2}{2} + \\frac{(h\\lambda)^3}{6} + \\frac{(h\\lambda)^4}{24} + \\frac{(h\\lambda)^5}{120} + \\mathcal{O}(h^6)$$\nSo, $R(h\\lambda) = \\exp(h\\lambda) - \\frac{(h\\lambda)^5}{120} + \\mathcal{O}(h^6)$.\nSubstituting this into the equation for $h\\tilde{\\lambda}$:\n$$h\\tilde{\\lambda} = \\ln\\left(\\exp(h\\lambda) - \\frac{(h\\lambda)^5}{120} + \\mathcal{O}(h^6)\\right) = \\ln\\left(\\exp(h\\lambda)\\left[1 - \\exp(-h\\lambda)\\frac{(h\\lambda)^5}{120} + \\mathcal{O}(h^6)\\right]\\right)$$\n$$h\\tilde{\\lambda} = h\\lambda + \\ln\\left(1 - \\exp(-h\\lambda)\\frac{(h\\lambda)^5}{120} + \\mathcal{O}(h^6)\\right)$$\nUsing the Taylor series $\\ln(1-u) = -u - \\frac{u^2}{2} - \\dots$, and keeping only the leading term in $h$:\n$$h\\tilde{\\lambda} \\approx h\\lambda - \\exp(-h\\lambda)\\frac{(h\\lambda)^5}{120}$$\nFor the leading order correction, we can approximate $\\exp(-h\\lambda) \\approx 1$.\n$$h\\tilde{\\lambda} \\approx h\\lambda - \\frac{(h\\lambda)^5}{120}$$\nDividing by $h$, we find the modified rate $\\tilde{\\lambda}$:\n$$\\tilde{\\lambda} = \\lambda - \\frac{\\lambda^5 h^4}{120} + \\mathcal{O}(h^5)$$\nThe modified equation is therefore:\n$$\\dot{\\tilde{y}} = \\left(\\lambda - \\frac{\\lambda^5 h^4}{120}\\right)\\tilde{y}$$\nThe leading nonvanishing correction term in the modified equation is $-\\frac{\\lambda^5 h^4}{120}\\tilde{y}$. This is of order $h^4$, as expected for a fourth-order method.\n\n### Step 3: Application to the Cosmological Problem\n\nIn the $\\Omega_\\Lambda$-dominated regime, the equation for the scale factor is $\\dot{a} = H_\\Lambda a$. This matches the form $\\dot{y} = \\lambda y$ with the identifications $y \\to a$ and $\\lambda \\to H_\\Lambda = H_0\\sqrt{\\Omega_\\Lambda}$.\nThe modified equation for the scale factor, denoted $a_{\\text{mod}}$, is:\n$$\\dot{a}_{\\text{mod}} = \\left(H_\\Lambda - \\frac{H_\\Lambda^5 h^4}{120}\\right)a_{\\text{mod}}$$\nThe numerical solution $a_{\\text{RK4}}$ is shadowed by $a_{\\text{mod}}$.\n\n### Step 4: bias in Accumulated E-folds\n\nThe number of e-folds is $N(t) = \\ln a(t)$. The rate of change of e-folds is $\\dot{N}(t) = \\dot{a}(t)/a(t)$.\nFor the true solution, the rate is constant:\n$$\\dot{N}_{\\text{true}} = \\frac{\\dot{a}}{a} = H_\\Lambda$$\nFor the numerical solution, as described by the modified equation, the effective rate is also constant:\n$$\\dot{N}_{\\text{RK4}} = \\frac{\\dot{a}_{\\text{mod}}}{a_{\\text{mod}}} = H_\\Lambda - \\frac{H_\\Lambda^5 h^4}{120}$$\nThe problem considers an interval of cosmic time, $T=t_f-t_i$, over which the true solution accumulates exactly $\\Delta N = 10$ e-folds. This defines the duration of the integration:\n$$\\Delta N_{\\text{true}} = \\int_{t_i}^{t_f} \\dot{N}_{\\text{true}} dt = H_\\Lambda T = 10$$\n$$T = \\frac{10}{H_\\Lambda}$$\nOver this same time interval $T$, the accumulated e-folds for the numerical solution are:\n$$\\Delta N_{\\text{RK4}} = \\int_{t_i}^{t_f} \\dot{N}_{\\text{RK4}} dt = \\left(H_\\Lambda - \\frac{H_\\Lambda^5 h^4}{120}\\right)T$$\nSubstituting $T = 10/H_\\Lambda$:\n$$\\Delta N_{\\text{RK4}} = \\left(H_\\Lambda - \\frac{H_\\Lambda^5 h^4}{120}\\right)\\frac{10}{H_\\Lambda} = 10\\left(1 - \\frac{H_\\Lambda^4 h^4}{120}\\right) = 10 - \\frac{10 H_\\Lambda^4 h^4}{120} = 10 - \\frac{H_\\Lambda^4 h^4}{12}$$\nThe leading-order bias is defined as $\\Delta N_{\\text{bias}} = \\Delta N_{\\text{RK4}} - 10$.\n$$\\Delta N_{\\text{bias}} = \\left(10 - \\frac{H_\\Lambda^4 h^4}{12}\\right) - 10 = -\\frac{H_\\Lambda^4 h^4}{12}$$\n\n### Step 5: Final Expression\n\nThe final step is to express the bias in terms of the given parameters $h$, $H_0$, and $\\Omega_\\Lambda$. We substitute $H_\\Lambda = H_0 \\sqrt{\\Omega_\\Lambda}$:\n$$H_\\Lambda^4 = \\left(H_0 \\sqrt{\\Omega_\\Lambda}\\right)^4 = H_0^4 (\\Omega_\\Lambda^{1/2})^4 = H_0^4 \\Omega_\\Lambda^2$$\nSubstituting this into the expression for the bias:\n$$\\Delta N_{\\text{bias}} = -\\frac{(H_0^4 \\Omega_\\Lambda^2) h^4}{12} = -\\frac{H_0^4 \\Omega_\\Lambda^2 h^4}{12}$$\nThis is the final closed-form expression for the leading-order bias. The negative sign indicates that the RK4 method, in this application, tends to systematically underestimate the number of e-folds over a fixed time interval compared to the true solution's rate of expansion.\nThe analysis confirms that the RK4 method exhibits a leading-order bias of order $h^4$, consistent with its status as a fourth-order accurate integrator.",
            "answer": "$$\\boxed{-\\frac{H_0^4 \\Omega_\\Lambda^2 h^4}{12}}$$"
        },
        {
            "introduction": "Modern numerical integrators do more than just jump from one time step to the next; they provide a continuous, high-fidelity approximation of the solution within each step. This \"dense output\" capability is critical for accurately capturing events or evaluating solutions at arbitrary points without shrinking the step size prohibitively. This practice challenges you to construct the cubic Hermite polynomial that forms the basis of such dense output, applying it to the practical cosmological problem of calculating the comoving distance .",
            "id": "3484658",
            "problem": "Consider the spatially flat Lambda Cold Dark Matter ($\\Lambda$CDM) cosmological model with matter density parameter $\\Omega_{m}=0.3$, cosmological-constant density parameter $\\Omega_{\\Lambda}=0.7$, Hubble constant $H_{0}=70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, and speed of light $c=299\\,792.458\\,\\mathrm{km\\,s^{-1}}$. The line-of-sight comoving radial distance $\\chi(a)$ as a function of scale factor $a$ satisfies the first-order ordinary differential equation\n$$\n\\frac{d\\chi}{da} \\equiv f(a,\\chi) = -\\frac{c}{a^{2} H(a)}, \\quad H(a)=H_{0}\\sqrt{\\Omega_{m}a^{-3}+\\Omega_{\\Lambda}},\n$$\nwith terminal condition $\\chi(1)=0$. Suppose you have advanced one explicit Runge–Kutta time step in the independent variable $a$ from $a_{n}=1$ to $a_{n+1}=0.8$ using a sufficiently high-order scheme so that the step endpoint value is numerically indistinguishable from the exact solution at $a_{n+1}$ for the purposes of this problem. Denote $h=a_{n+1}-a_{n}=-0.2$, $y_{n}=\\chi(a_{n})=0$, $y_{n+1}=\\chi(a_{n+1})=1008.139935\\,\\mathrm{Mpc}$. \n\nDense output within the step is to be constructed by the unique cubic polynomial $p(\\theta)$, with $\\theta=(a-a_{n})/h$, that interpolates the solution and its derivative at both ends of the step: $p(0)=y_{n}$, $p(1)=y_{n+1}$, $p'(0)=h\\,f(a_{n},y_{n})$, $p'(1)=h\\,f(a_{n+1},y_{n+1})$, where $f(a,y)$ is the right-hand side of the ordinary differential equation given above and depends only on $a$. \n\nStarting from the definitions above and without invoking any pre-tabulated dense-output formulas, derive $p(\\theta)$ and evaluate it at the midpoint $a_{\\star}=0.9$ (so that $\\theta_{\\star}=(a_{\\star}-a_{n})/h$). Express the result as a single real number equal to the comoving distance $\\chi(a_{\\star})$ in $\\mathrm{Mpc}$. Round your answer to four significant figures and report it in $\\mathrm{Mpc}$.",
            "solution": "The user wants me to solve a problem that involves finding the value of a cubic Hermite interpolant at the midpoint of an interval. The interpolant approximates the comoving distance in a $\\Lambda$CDM cosmological model.\n\n### Problem Validation\n\nFirst, I will validate the problem statement according to the specified criteria.\n\n**Step 1: Extract Givens**\n-   **Cosmological Model**: Spatially flat Lambda Cold Dark Matter ($\\Lambda$CDM).\n-   **Density Parameters**: $\\Omega_{m}=0.3$, $\\Omega_{\\Lambda}=0.7$.\n-   **Hubble Constant**: $H_{0}=70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$.\n-   **Speed of Light**: $c=299\\,792.458\\,\\mathrm{km\\,s^{-1}}$.\n-   **Governing ODE**: $\\frac{d\\chi}{da} = -\\frac{c}{a^{2} H(a)}$, where $H(a)=H_{0}\\sqrt{\\Omega_{m}a^{-3}+\\Omega_{\\Lambda}}$. This defines the function $f(a, \\chi) \\equiv f(a) = -\\frac{c}{a^{2} H(a)}$.\n-   **Terminal Condition**: $\\chi(1)=0$.\n-   **Step Interval**: The independent variable $a$ goes from $a_{n}=1$ to $a_{n+1}=0.8$.\n-   **Step Size**: $h=a_{n+1}-a_{n} = 0.8 - 1 = -0.2$.\n-   **Solution at Endpoints**:\n    -   $y_{n}=\\chi(a_{n})=\\chi(1)=0\\,\\mathrm{Mpc}$.\n    -   $y_{n+1}=\\chi(a_{n+1})=\\chi(0.8)=1008.139935\\,\\mathrm{Mpc}$.\n-   **Interpolation Polynomial**: A unique cubic polynomial $p(\\theta)$ with $\\theta=(a-a_{n})/h$ satisfying:\n    -   $p(0)=y_{n}$\n    -   $p(1)=y_{n+1}$\n    -   $p'(0)=h\\,f(a_{n},y_{n})$\n    -   $p'(1)=h\\,f(a_{n+1},y_{n+1})$\n-   **Evaluation Point**: $a_{\\star}=0.9$, which corresponds to $\\theta_{\\star}=(a_{\\star}-a_{n})/h = (0.9 - 1)/(-0.2) = 0.5$.\n-   **Required Output**: The value of $p(\\theta_{\\star})$ in $\\mathrm{Mpc}$, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is set within the standard framework of physical cosmology ($\\Lambda$CDM model). The equation for comoving distance is a fundamental concept, and its numerical solution is a common task in the field. The given cosmological parameters are standard textbook values. The underlying physics and mathematics are sound.\n-   **Well-Posedness**: The problem defines a cubic Hermite interpolation problem. Four conditions (the function values and first derivative values at two points) are specified, which is exactly the number of constraints needed to uniquely determine the four coefficients of a cubic polynomial. A unique solution therefore exists.\n-   **Objectivity**: The problem is stated using precise, objective mathematical and physical language. There are no subjective or opinion-based elements.\n-   **Consistency and Completeness**: The problem is self-contained. All necessary equations, constants, and boundary values are provided. The condition of spatial flatness, $\\Omega_m + \\Omega_\\Lambda = 1$, is satisfied by the given parameters ($0.3 + 0.7 = 1$). The problem statement is free from contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically grounded, well-posed, objective, and self-consistent. Therefore, the problem is **valid**. I will proceed with the solution.\n\n### Solution\n\nThe task is to derive and evaluate a cubic polynomial $p(\\theta)$ that provides a dense output for a numerical integration step. The polynomial is defined by four conditions on its value and derivative at the endpoints of the normalized interval $\\theta \\in [0, 1]$.\n\nLet the cubic polynomial be of the form:\n$$p(\\theta) = A\\theta^3 + B\\theta^2 + C\\theta + D$$\nIts derivative with respect to $\\theta$ is:\n$$p'(\\theta) = 3A\\theta^2 + 2B\\theta + C$$\n\nThe four coefficients $A, B, C, D$ are determined by the given interpolation conditions:\n1.  $p(0) = y_n$\n2.  $p(1) = y_{n+1}$\n3.  $p'(0) = h f(a_n, y_n) \\equiv h k_n$\n4.  $p'(1) = h f(a_{n+1}, y_{n+1}) \\equiv h k_{n+1}$\n\nFrom condition 1, evaluating $p(\\theta)$ at $\\theta=0$:\n$$p(0) = A(0)^3 + B(0)^2 + C(0) + D = D$$\nThus, $D = y_n$.\n\nFrom condition 3, evaluating $p'(\\theta)$ at $\\theta=0$:\n$$p'(0) = 3A(0)^2 + 2B(0) + C = C$$\nThus, $C = h k_n$.\n\nNow we use the remaining two conditions at $\\theta=1$:\nFrom condition 2:\n$$p(1) = A(1)^3 + B(1)^2 + C(1) + D = A + B + C + D = y_{n+1}$$\nSubstituting the known $C$ and $D$:\n$$A + B + h k_n + y_n = y_{n+1} \\implies A + B = y_{n+1} - y_n - h k_n$$\n\nFrom condition 4:\n$$p'(1) = 3A(1)^2 + 2B(1) + C = 3A + 2B + C = h k_{n+1}$$\nSubstituting the known $C$:\n$$3A + 2B + h k_n = h k_{n+1} \\implies 3A + 2B = h k_{n+1} - h k_n$$\n\nWe now have a system of two linear equations for $A$ and $B$:\n(i) $A + B = y_{n+1} - y_n - h k_n$\n(ii) $3A + 2B = h(k_{n+1} - k_n)$\n\nMultiply equation (i) by $2$:\n(iii) $2A + 2B = 2(y_{n+1} - y_n - h k_n)$\n\nSubtract equation (iii) from (ii):\n$$(3A + 2B) - (2A + 2B) = h(k_{n+1} - k_n) - 2(y_{n+1} - y_n - h k_n)$$\n$$A = h k_{n+1} - h k_n - 2y_{n+1} + 2y_n + 2h k_n$$\n$$A = 2(y_n - y_{n+1}) + h(k_n + k_{n+1})$$\n\nSubstitute $A$ back into equation (i) to find $B$:\n$$B = (y_{n+1} - y_n - h k_n) - A$$\n$$B = (y_{n+1} - y_n - h k_n) - [2(y_n - y_{n+1}) + h(k_n + k_{n+1})]$$\n$$B = y_{n+1} - y_n - h k_n - 2y_n + 2y_{n+1} - h k_n - h k_{n+1}$$\n$$B = 3(y_{n+1} - y_n) - 2h k_n - h k_{n+1} = 3(y_{n+1} - y_n) - h(2k_n + k_{n+1})$$\n\nNow we proceed with the numerical evaluation. First, we compute the derivatives $k_n$ and $k_{n+1}$.\nThe function $f(a,y)$ is given by $f(a) = -\\frac{c}{a^{2} H(a)}$, with $H(a)=H_{0}\\sqrt{\\Omega_{m}a^{-3}+\\Omega_{\\Lambda}}$.\nThe given values are:\n$c = 299792.458\\,\\mathrm{km\\,s^{-1}}$\n$H_0 = 70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$\n$\\Omega_m = 0.3$\n$\\Omega_\\Lambda = 0.7$\n$a_n = 1$ and $a_{n+1} = 0.8$.\n$y_n = 0\\,\\mathrm{Mpc}$ and $y_{n+1} = 1008.139935\\,\\mathrm{Mpc}$.\n$h = -0.2$.\n\nCalculate $k_n = f(a_n) = f(1)$:\n$H(1) = H_{0}\\sqrt{\\Omega_{m}(1)^{-3}+\\Omega_{\\Lambda}} = H_{0}\\sqrt{\\Omega_{m}+\\Omega_{\\Lambda}} = H_0\\sqrt{0.3+0.7} = H_0 = 70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$.\n$$k_n = -\\frac{c}{a_n^2 H(a_n)} = -\\frac{c}{1^2 H_0} = -\\frac{299792.458}{70} \\approx -4282.7494\\,\\mathrm{Mpc}$$\n\nCalculate $k_{n+1} = f(a_{n+1}) = f(0.8)$:\n$H(0.8) = H_0 \\sqrt{\\Omega_m (0.8)^{-3} + \\Omega_\\Lambda} = 70 \\sqrt{0.3 \\times (0.8)^{-3} + 0.7} = 70 \\sqrt{\\frac{0.3}{0.512} + 0.7}$.\n$H(0.8) = 70 \\sqrt{0.5859375 + 0.7} = 70 \\sqrt{1.2859375} \\approx 70 \\times 1.133991843 \\approx 79.379429\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$.\n$$k_{n+1} = -\\frac{c}{a_{n+1}^2 H(a_{n+1})} = -\\frac{299792.458}{(0.8)^2 \\times 79.379429} = -\\frac{299792.458}{0.64 \\times 79.379429} \\approx -\\frac{299792.458}{50.80283456} \\approx -5901.0716\\,\\mathrm{Mpc}$$\n\nNow calculate the coefficients $A, B, C, D$:\n$D = y_n = 0\\,\\mathrm{Mpc}$.\n$C = h k_n = (-0.2)(-4282.7494) = 856.54988\\,\\mathrm{Mpc}$.\n$A = 2(y_n - y_{n+1}) + h(k_n + k_{n+1})$\n$A = 2(0 - 1008.139935) + (-0.2)(-4282.7494 - 5901.0716)$\n$A = -2016.27987 + (-0.2)(-10183.821)$\n$A = -2016.27987 + 2036.7642 = 20.48433\\,\\mathrm{Mpc}$.\n\n$B = 3(y_{n+1} - y_n) - h(2k_n + k_{n+1})$\n$B = 3(1008.139935 - 0) - (-0.2)(2(-4282.7494) - 5901.0716)$\n$B = 3024.419805 - (-0.2)(-8565.4988 - 5901.0716)$\n$B = 3024.419805 - (-0.2)(-14466.5704)$\n$B = 3024.419805 - 2893.31408 = 131.105725\\,\\mathrm{Mpc}$.\n\nThe polynomial is $p(\\theta) = (20.48433)\\theta^3 + (131.105725)\\theta^2 + (856.54988)\\theta$.\n\nWe need to evaluate this at $\\theta_{\\star} = 0.5$:\n$p(0.5) = (20.48433)(0.5)^3 + (131.105725)(0.5)^2 + (856.54988)(0.5)$\n$p(0.5) = (20.48433)(0.125) + (131.105725)(0.25) + (856.54988)(0.5)$\n$p(0.5) = 2.56054125 + 32.77643125 + 428.27494$\n$p(0.5) = 463.6119125\\,\\mathrm{Mpc}$.\n\nThe problem requests the answer rounded to four significant figures.\n$463.6119125 \\approx 463.6$.\nThe interpolated comoving distance at $a_{\\star}=0.9$ is $463.6\\,\\mathrm{Mpc}$.",
            "answer": "$$\\boxed{463.6}$$"
        },
        {
            "introduction": "While general-purpose Runge-Kutta methods are powerful, the highest accuracy can often be achieved by designing an integrator tailored to the specific structure of the problem at hand. This practice guides you through the design of a structure-preserving scheme for integrating a particle's trajectory in de Sitter spacetime, a cornerstone of inflationary cosmology . By comparing your specialized integrator to standard RK methods, you will witness firsthand how exploiting the analytical properties of the equations of motion can lead to a method that preserves the exact solution to within machine precision, demonstrating a key principle of geometric integration.",
            "id": "3484668",
            "problem": "Consider a spatially flat Friedmann–Lemaître–Robertson–Walker spacetime written in conformal coordinates with line element $ds^2 = a(\\eta)^2 \\left(-d\\eta^2 + d\\mathbf{x}^2\\right)$, where $\\eta$ is the conformal time and $a(\\eta)$ is the scale factor. In de Sitter spacetime, the scale factor in conformal time is $a(\\eta) = -\\dfrac{1}{H \\eta}$ with constant Hubble parameter $H&gt;0$ and $\\eta &lt; 0$. Work in geometrized units with the speed of light set to $c=1$ so that all quantities are dimensionless in the code; do not print any units.\n\nA freely propagating relativistic particle of rest mass $m \\ge 0$ moving in one spatial dimension with comoving position $x(\\eta)$ has a conserved comoving momentum $q$ satisfying $q = a(\\eta) p_{\\mathrm{phys}}(\\eta)$, where $p_{\\mathrm{phys}}(\\eta)$ is the physical momentum. Using the relativistic energy–momentum relation, the equations of motion in conformal time can be cast as the first-order ordinary differential equation system\n$$\n\\frac{dx}{d\\eta} = \\frac{q}{\\sqrt{m^2 a(\\eta)^2 + q^2}}, \\qquad \\frac{dq}{d\\eta} = 0,\n$$\nwith initial data $x(\\eta_0) = x_0$ and $q(\\eta_0) = q_0 \\ne 0$, where $\\eta_0 &lt; 0$.\n\nYour task is to construct three Runge–Kutta integration schemes for this system and rigorously test exact-solution-preservation properties that arise specifically for $a(\\eta) = -\\dfrac{1}{H\\eta}$ via appropriate stage design:\n\n- Scheme A (Explicit Midpoint, second order): Apply the classical explicit midpoint Runge–Kutta method (also known as second-order Runge–Kutta) with step size $h > 0$ to the system for $(x,q)$, treating $q$ as a dynamic variable governed by $\\dfrac{dq}{d\\eta} = 0$.\n\n- Scheme B (Classical Explicit Runge–Kutta of order four): Apply the standard four-stage method with Butcher weights $b = [\\tfrac{1}{6}, \\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{6}]$ and abscissae $c = [0, \\tfrac{1}{2}, \\tfrac{1}{2}, 1]$ to the system for $(x,q)$, with step size $h$.\n\n- Scheme C (Stage-designed exact-preserving Runge–Kutta via auxiliary variable): Introduce the auxiliary variable $y(\\eta) := q^2 \\eta^2 + \\mu^2$, where $\\mu := \\dfrac{m}{H}$. Observe that $y(\\eta)$ satisfies a scalar first-order ordinary differential equation that depends only on time, namely $\\dfrac{dy}{d\\eta} = 2 q^2 \\eta$. Construct a three-stage explicit Runge–Kutta method whose weights coincide with Simpson’s quadrature rule, that is, stage abscissae $c = [0, \\tfrac{1}{2}, 1]$ and weights $b = [\\tfrac{1}{6}, \\tfrac{2}{3}, \\tfrac{1}{6}]$, and apply it to $\\dfrac{dy}{d\\eta} = 2 q^2 \\eta$ so that the update of $y$ over one step is an exact quadrature for $y'$ because $y'$ is a polynomial of degree $1$ in $\\eta$. Then couple this with the exact algebraic relation\n$$\nx(\\eta) = x(\\eta_n) - \\frac{1}{q}\\left(\\sqrt{y(\\eta)} - \\sqrt{y(\\eta_n)}\\right)\n$$\nover each step from $\\eta_n$ to $\\eta_{n+1} = \\eta_n + h$, so that the method advances $x$ by\n$$\nx_{n+1} = x_n - \\frac{1}{q}\\left(\\sqrt{y_{n+1}} - \\sqrt{y_n}\\right),\n$$\nwith $q$ constant under all three schemes by virtue of $\\dfrac{dq}{d\\eta}=0$. This stage design should preserve the exact solution for $x(\\eta)$ for any step size $h$ (up to floating-point roundoff), specific to the de Sitter scale factor $a(\\eta)=-\\dfrac{1}{H\\eta}$.\n\nFrom the fundamental base consisting of the metric definition and conservation of comoving momentum in a homogeneous isotropic background, one can derive a closed-form exact solution $x(\\eta)$ for de Sitter spacetime. Use that exact solution to compute the absolute error at the final time for each scheme.\n\nImplement a single program that, for the following test suite, advances the solution from $\\eta=\\eta_0$ to $\\eta=\\eta_1$ (with $\\eta_0 &lt; \\eta_1 &lt; 0$; use positive $h$ and adapt the last step to land exactly on $\\eta_1$), and reports, for each test case, a list of three floating-point numbers equal to the absolute errors in $x(\\eta_1)$ produced by Scheme A, Scheme B, and Scheme C, respectively. The comoving momentum $q(\\eta)$ must be updated as a dynamic variable via $\\dfrac{dq}{d\\eta}=0$ inside each Runge–Kutta method (which should preserve it exactly). All computations are to be carried out in the dimensionless geometrized unit system; do not print any units.\n\nTest suite parameters, to be used verbatim:\n\n- Case 1 (happy path relativistic): $H = 1.0$, $m = 1.0$, $q_0 = 2.0$, $x_0 = 0.3$, $\\eta_0 = -1.0$, $\\eta_1 = -0.1$, $h = 0.05$.\n\n- Case 2 (ultra-relativistic and near $\\eta \\to 0^-$): $H = 1.0$, $m = 10^{-4}$, $q_0 = 1.0$, $x_0 = -0.2$, $\\eta_0 = -1.0$, $\\eta_1 = -10^{-2}$, $h = 0.01$.\n\n- Case 3 (non-relativistic heavy particle): $H = 0.5$, $m = 10.0$, $q_0 = 0.2$, $x_0 = 1.0$, $\\eta_0 = -2.0$, $\\eta_1 = -0.5$, $h = 0.1$.\n\n- Case 4 (massless with negative momentum): $H = 1.0$, $m = 0.0$, $q_0 = -3.0$, $x_0 = 0.0$, $\\eta_0 = -1.5$, $\\eta_1 = -0.5$, $h = 0.1$.\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list holding the three errors for one test case, all enclosed in square brackets, for example, $[[e_{1A},e_{1B},e_{1C}],[e_{2A},e_{2B},e_{2C}],\\dots]$. Each $e_{ij}$ must be a floating-point number.",
            "solution": "The problem requires the construction and validation of three distinct Runge-Kutta integration schemes for solving the equations of motion of a relativistic particle in a de Sitter universe. The core of the task is to analyze their accuracy by comparing their results to a known exact analytical solution, with a particular focus on a custom-designed scheme (Scheme C) that is expected to be exact up to machine precision.\n\nFirst, the physical and mathematical validity of the model must be established. The spacetime is a spatially flat Friedmann–Lemaître–Robertson–Walker (FLRW) model with the line element $ds^2 = a(\\eta)^2(-d\\eta^2 + d\\mathbf{x}^2)$. For a de Sitter universe, the scale factor is specified as $a(\\eta) = -1/(H\\eta)$, where $H > 0$ is the constant Hubble parameter and $\\eta < 0$ is the conformal time. The equations of motion for a particle of rest mass $m$ are given as a first-order system for its comoving position $x(\\eta)$ and conserved comoving momentum $q(\\eta)$:\n$$\n\\frac{dx}{d\\eta} = \\frac{q}{\\sqrt{m^2 a(\\eta)^2 + q^2}}, \\qquad \\frac{dq}{d\\eta} = 0\n$$\nThese equations are standard in cosmology. The first arises from the relation between comoving velocity $d\\mathbf{x}/d\\eta$ and the ratio of physical momentum to physical energy, $\\mathbf{p}_{\\text{phys}}/E_{\\text{phys}}$, combined with the relativistic energy-momentum relation $E_{\\text{phys}}^2 = p_{\\text{phys}}^2 + m^2$ (with $c=1$) and the redshift of momentum $p_{\\text{phys}} = q/a$. The second equation, $dq/d\\eta=0$, expresses the conservation of comoving momentum for a free particle in a homogeneous and isotropic background. The system is a well-posed initial value problem.\n\nTo quantify the error of the numerical schemes, we must first derive the exact analytical solution for $x(\\eta)$. Since $q$ is constant, we can directly integrate the equation for $x$. Substituting the de Sitter scale factor $a(\\eta) = -1/(H\\eta)$ into the ODE for $x$ yields:\n$$\n\\frac{dx}{d\\eta} = \\frac{q}{\\sqrt{q^2 + m^2 / (H^2 \\eta^2)}} = \\frac{q}{\\sqrt{(q^2 \\eta^2 + m^2/H^2)/\\eta^2}}\n$$\nGiven that $\\eta < 0$, we have $\\sqrt{\\eta^2} = -\\eta$. The expression simplifies to:\n$$\n\\frac{dx}{d\\eta} = \\frac{-q\\eta}{\\sqrt{q^2 \\eta^2 + (m/H)^2}}\n$$\nIntegrating this equation from an initial time $\\eta_0$ with position $x_0 = x(\\eta_0)$ to a later time $\\eta$ gives the change in position:\n$$\nx(\\eta) - x(\\eta_0) = \\int_{\\eta_0}^{\\eta} \\frac{-q\\eta'}{\\sqrt{q^2 (\\eta')^2 + (m/H)^2}} d\\eta'\n$$\nThis integral can be solved exactly, for instance, with the substitution $u = q^2 (\\eta')^2 + (m/H)^2$, which leads to $du = 2q^2 \\eta' d\\eta'$. The result of the definite integral is:\n$$\nx(\\eta) - x(\\eta_0) = \\left[ -\\frac{1}{q} \\sqrt{q^2 (\\eta')^2 + (m/H)^2} \\right]_{\\eta_0}^{\\eta}\n$$\nThis provides the exact solution for the comoving position at any time $\\eta$:\n$$\nx(\\eta) = x(\\eta_0) - \\frac{1}{q} \\left( \\sqrt{q^2 \\eta^2 + (m/H)^2} - \\sqrt{q^2 \\eta_0^2 + (m/H)^2} \\right)\n$$\nThis formula will be used as the ground truth to compute the absolute error $|x_{\\text{numerical}}(\\eta_1) - x_{\\text{exact}}(\\eta_1)|$ for each scheme at the final time $\\eta_1$.\n\nThe numerical integration proceeds from $\\eta_0$ to $\\eta_1 > \\eta_0$ with a base step size $h > 0$. To land precisely on $\\eta_1$, the final step size is adapted to $h_{\\text{final}} = \\eta_1 - \\eta_{\\text{current}}$. We define the state vector as $\\mathbf{S} = [x, q]^T$ and the right-hand side of the ODE system as $\\mathbf{F}(\\mathbf{S}, \\eta)$. Since $dq/d\\eta = 0$, the $q$ component of $\\mathbf{S}$ will remain constant for any valid numerical integrator.\n\nScheme A is the explicit midpoint method, a second-order Runge-Kutta scheme. A single step from $\\eta_n$ to $\\eta_{n+1} = \\eta_n + h$ is computed as:\n$$\n\\mathbf{k}_1 = \\mathbf{F}(\\mathbf{S}_n, \\eta_n) \\\\\n\\mathbf{k}_2 = \\mathbf{F}(\\mathbf{S}_n + \\frac{h}{2}\\mathbf{k}_1, \\eta_n + \\frac{h}{2}) \\\\\n\\mathbf{S}_{n+1} = \\mathbf{S}_n + h \\mathbf{k}_2\n$$\n\nScheme B is the classical fourth-order explicit Runge-Kutta method. Its update rule for a single step is:\n$$\n\\mathbf{k}_1 = \\mathbf{F}(\\mathbf{S}_n, \\eta_n) \\\\\n\\mathbf{k}_2 = \\mathbf{F}(\\mathbf{S}_n + \\frac{h}{2}\\mathbf{k}_1, \\eta_n + \\frac{h}{2}) \\\\\n\\mathbf{k}_3 = \\mathbf{F}(\\mathbf{S}_n + \\frac{h}{2}\\mathbf{k}_2, \\eta_n + \\frac{h}{2}) \\\\\n\\mathbf{k}_4 = \\mathbf{F}(\\mathbf{S}_n + h\\mathbf{k}_3, \\eta_n + h) \\\\\n\\mathbf{S}_{n+1} = \\mathbf{S}_n + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n\nScheme C is a specialized method designed to leverage the problem's structure. It introduces an auxiliary variable $y(\\eta) := q^2 \\eta^2 + \\mu^2$, where $\\mu := m/H$. Differentiating $y(\\eta)$ with respect to $\\eta$ yields a much simpler ODE that depends only on time:\n$$\n\\frac{dy}{d\\eta} = 2q^2\\eta\n$$\nThe scheme integrates this equation using a $3$-stage explicit Runge-Kutta method whose Butcher weights $b = [1/6, 2/3, 1/6]$ and abscissae $c = [0, 1/2, 1]$ correspond to Simpson's quadrature rule. For an ODE of the form $y' = f(\\eta)$, an RK step is equivalent to a quadrature evaluation: $y_{n+1} = y_n + h \\sum_i b_i f(\\eta_n + c_i h)$. Simpson's rule is known to be exact for polynomials of degree up to $3$. Since the right-hand side $2q^2\\eta$ is a polynomial of degree $1$ in $\\eta$, this numerical quadrature is exact. Consequently, the value $y_{n+1}$ computed by the scheme is precisely $y(\\eta_{n+1})$, up to floating-point error. The update for $x$ is then performed using an exact algebraic relation derived from the analytical solution:\n$$\nx_{n+1} = x_n - \\frac{1}{q}\\left(\\sqrt{y_{n+1}} - \\sqrt{y_n}\\right)\n$$\nSince both the update for $y(\\eta)$ and the subsequent calculation of $x(\\eta)$ are exact, Scheme C is expected to preserve the exact solution for any step size $h$, with errors only arising from floating-point arithmetic.\n\nThe final implementation calculates the absolute error for each scheme across the provided test suite and formats the output as a list of lists.",
            "answer": "```python\nimport numpy as np\n\ndef get_ode_rhs_func(H, m):\n    \"\"\"\n    Returns the function F(state, eta) for the ODE system d(x,q)/d(eta).\n    \"\"\"\n    def F(state, eta):\n        _x, q = state\n        # The problem statement ensures eta < 0, so eta != 0.\n        a_sq = 1.0 / (H**2 * eta**2)\n        denominator = np.sqrt(m**2 * a_sq + q**2)\n        \n        # Handle the case where the denominator might be zero if q=0 and m=0.\n        # Problem statement says q0 != 0, so q is never 0.\n        dxdeta = q / denominator\n        dqdeta = 0.0\n        \n        return np.array([dxdeta, dqdeta])\n    return F\n\ndef solve_scheme_A(params):\n    \"\"\"\n    Solves the ODE system using Scheme A (Explicit Midpoint / RK2).\n    \"\"\"\n    H, m, q0, x0, eta0, eta1, h = params\n    \n    F = get_ode_rhs_func(H, m)\n    \n    state = np.array([x0, q0], dtype=np.float64)\n    eta = eta0\n    \n    while not np.isclose(eta, eta1):\n        h_step = min(h, eta1 - eta)\n        if h_step < 1e-15:  # Avoid negligible steps due to floating point arithmetic\n            break\n\n        k1 = F(state, eta)\n        mid_state = state + 0.5 * h_step * k1\n        mid_eta = eta + 0.5 * h_step\n        \n        k2 = F(mid_state, mid_eta)\n        \n        state = state + h_step * k2\n        eta += h_step\n        \n    return state[0]\n\ndef solve_scheme_B(params):\n    \"\"\"\n    Solves the ODE system using Scheme B (Classical RK4).\n    \"\"\"\n    H, m, q0, x0, eta0, eta1, h = params\n\n    F = get_ode_rhs_func(H, m)\n    \n    state = np.array([x0, q0], dtype=np.float64)\n    eta = eta0\n    \n    while not np.isclose(eta, eta1):\n        h_step = min(h, eta1 - eta)\n        if h_step < 1e-15:\n            break\n            \n        k1 = F(state, eta)\n        k2 = F(state + 0.5 * h_step * k1, eta + 0.5 * h_step)\n        k3 = F(state + 0.5 * h_step * k2, eta + 0.5 * h_step)\n        k4 = F(state + h_step * k3, eta + h_step)\n        \n        state = state + (h_step / 6.0) * (k1 + 2.0*k2 + 2.0*k3 + k4)\n        eta += h_step\n        \n    return state[0]\n\ndef solve_scheme_C(params):\n    \"\"\"\n    Solves the ODE system using Scheme C (Exact-preserving method).\n    \"\"\"\n    H, m, q0, x0, eta0, eta1, h = params\n    \n    q = q0\n    mu_sq = (m / H)**2\n    \n    # State is (x, y) where y = q^2*eta^2 + mu^2\n    y = mu_sq + q**2 * eta0**2\n    x = x0\n    eta = eta0\n\n    def F_y(eta_val, q_val):\n        return 2.0 * q_val**2 * eta_val\n\n    while not np.isclose(eta, eta1):\n        h_step = min(h, eta1 - eta)\n        if h_step < 1e-15:\n            break\n        \n        # Simpson's rule RK method for y(eta)\n        k1_y = F_y(eta, q)\n        k2_y = F_y(eta + 0.5 * h_step, q)\n        k3_y = F_y(eta + h_step, q)\n        \n        # Weights are b = [1/6, 2/3, 1/6]. Note 2/3 = 4/6.\n        y_next = y + (h_step / 6.0) * (k1_y + 4.0 * k2_y + k3_y)\n        \n        # Exact algebraic update for x\n        x_next = x - (1.0 / q) * (np.sqrt(y_next) - np.sqrt(y))\n        \n        x = x_next\n        y = y_next\n        eta += h_step\n        \n    return x\n\ndef get_exact_x(params, final_eta):\n    \"\"\"\n    Calculates the exact solution for x at a given final time.\n    \"\"\"\n    H, m, q0, x0, eta0, _, _ = params\n    \n    mu_sq = (m / H)**2\n    \n    y_final = mu_sq + q0**2 * final_eta**2\n    y_initial = mu_sq + q0**2 * eta0**2\n    \n    delta_x = - (1.0 / q0) * (np.sqrt(y_final) - np.sqrt(y_initial))\n    \n    return x0 + delta_x\n\ndef solve():\n    test_cases = [\n        # (H,     m,    q0,   x0,   eta0,  eta1,     h)\n        (1.0,   1.0,   2.0,  0.3, -1.0, -0.1,    0.05),\n        (1.0, 1e-4,  1.0, -0.2, -1.0, -1e-2,   0.01),\n        (0.5,  10.0,  0.2,  1.0, -2.0, -0.5,    0.1),\n        (1.0,   0.0,  -3.0,  0.0, -1.5, -0.5,    0.1),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        _, _, _, _, _, eta1, _ = case\n        \n        x_exact_final = get_exact_x(case, eta1)\n        \n        x_final_A = solve_scheme_A(case)\n        x_final_B = solve_scheme_B(case)\n        x_final_C = solve_scheme_C(case)\n        \n        error_A = abs(x_final_A - x_exact_final)\n        error_B = abs(x_final_B - x_exact_final)\n        error_C = abs(x_final_C - x_exact_final)\n        \n        all_results.append([error_A, error_B, error_C])\n        \n    inner_formatted_results = []\n    for res_list in all_results:\n        inner_str = f\"[{','.join(str(err) for err in res_list)}]\"\n        inner_formatted_results.append(inner_str)\n    \n    final_output_string = f\"[{','.join(inner_formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}