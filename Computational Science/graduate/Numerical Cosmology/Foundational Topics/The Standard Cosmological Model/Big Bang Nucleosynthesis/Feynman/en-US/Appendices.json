{
    "hands_on_practices": [
        {
            "introduction": "The final abundance of $^4\\text{He}$ is almost entirely fixed by the neutron-to-proton ratio at the start of nucleosynthesis. This exercise  guides you through the crucial calculation of this ratio by linking the cosmic expansion history to the decay of free neutrons after weak interactions \"freeze out\". Mastering this practice is fundamental to understanding the predictive power of the standard BBN model.",
            "id": "3466425",
            "problem": "Consider a spatially flat Friedmann–Lemaître–Robertson–Walker (FLRW) Universe that is radiation-dominated during the epoch of Big Bang Nucleosynthesis (BBN). The objective is to compute the neutron-to-proton ratio at the onset of light element formation by evolving free neutron decay from weak-interaction freeze-out down to a target photon temperature.\n\nFundamental base:\n- The neutron abundance $n(t)$ satisfies the decay equation $dn/dt=-n/\\tau_n$ with constant neutron lifetime $\\tau_n$. Protons are taken to be stable on the time scales of interest.\n- At weak freeze-out (temperature $T_f$), the neutron-to-proton ratio is in thermal equilibrium, so $(n/p)_{\\mathrm{freeze}}=\\exp(-\\Delta m/T_f)$, where $\\Delta m$ is the neutron–proton mass difference and $T_f$ is measured in the same energy units as $\\Delta m$.\n- The cosmic expansion rate is set by the Friedmann equation $H^2=(8\\pi G/3)\\,\\rho$, where $\\rho$ is the total energy density. In natural units where $\\hbar=c=k_B=1$, one may write $H^2=\\rho/(3\\,M_{\\mathrm{Pl,red}}^2)$ with reduced Planck mass $M_{\\mathrm{Pl,red}}=1/\\sqrt{8\\pi G}$.\n- For relativistic species, the energy density is $\\rho=(\\pi^2/30)\\,g_\\rho(T)\\,T^4$, where $g_\\rho(T)$ is the effective number of relativistic energy degrees of freedom and $T$ is the relevant temperature in energy units.\n- The background is assumed to be composed of photons, electron–positron pairs, and $N_\\nu$ flavors of neutrinos and antineutrinos. Assume instantaneous $e^\\pm$ annihilation and neutrino decoupling in the following simplified way:\n  - For photon temperature $T_\\gamma>T_{\\mathrm{ann}}$, take photons, $e^\\pm$, and neutrinos to be relativistic with a common temperature $T_\\gamma$, and include all of them in $\\rho$.\n  - For photon temperature $T_\\gamma\\le T_{\\mathrm{ann}}$, assume $e^\\pm$ are absent from $\\rho$, and neutrinos remain relativistic with a temperature $T_\\nu=\\xi\\,T_\\gamma$, where $\\xi=(4/11)^{1/3}$ arises from entropy conservation in the electromagnetic sector after neutrino decoupling.\n- Between epochs when the effective entropy degrees of freedom are constant, the photon temperature redshifts as $dT_\\gamma/dt=-H\\,T_\\gamma$. Under the instantaneous-annihilation approximation above, the elapsed cosmic time between $T_f$ and a lower target temperature $T_{\\mathrm{target}}$ can be computed from\n  $$\\Delta t=\\int_{T_{\\mathrm{target}}}^{T_f}\\frac{dT_\\gamma}{H(T_\\gamma)\\,T_\\gamma},$$\n  with $H(T_\\gamma)$ obtained from the Friedmann equation using the piecewise composition rules above.\n\nUsing only the principles stated above, write a program that:\n1. Computes the elapsed time $\\Delta t$ (in seconds) between $T_f$ and $T_{\\mathrm{target}}$, using the integral above and the following modeling of the energy density:\n   - Photons always contribute $\\rho_\\gamma=(\\pi^2/15)\\,T_\\gamma^4$.\n   - Electron–positron pairs contribute $\\rho_{e^\\pm}=(7/8)\\times 4\\times (\\pi^2/30)\\,T_\\gamma^4$ when $T_\\gamma>T_{\\mathrm{ann}}$, and contribute zero when $T_\\gamma\\le T_{\\mathrm{ann}}$.\n   - Neutrinos contribute $\\rho_\\nu=(7/8)\\times (2N_\\nu)\\times (\\pi^2/30)\\,T_\\nu^4$, with $T_\\nu=T_\\gamma$ for $T_\\gamma>T_{\\mathrm{ann}}$ and $T_\\nu=\\xi\\,T_\\gamma$ for $T_\\gamma\\le T_{\\mathrm{ann}}$.\n   - Use $M_{\\mathrm{Pl,red}}=2.435\\times 10^{21}\\ \\mathrm{MeV}$, $\\hbar=6.582119569\\times 10^{-22}\\ \\mathrm{MeV\\cdot s}$, and take $c=1$, $k_B=1$ so that temperatures are directly in $\\mathrm{MeV}$.\n2. Evolves the neutron-to-proton ratio from freeze-out to $T_{\\mathrm{target}}$ via\n   $$(n/p)_{\\mathrm{final}}=(n/p)_{\\mathrm{freeze}}\\times \\exp\\!\\left(-\\frac{\\Delta t}{\\tau_n}\\right),\\quad (n/p)_{\\mathrm{freeze}}=\\exp\\!\\left(-\\frac{\\Delta m}{T_f}\\right).$$\n\nConstants and parameters to use:\n- Neutron lifetime $\\tau_n=879.4\\ \\mathrm{s}$.\n- Neutron–proton mass difference $\\Delta m=1.29333236\\ \\mathrm{MeV}$.\n- Instantaneous $e^\\pm$ annihilation threshold $T_{\\mathrm{ann}}=0.2\\ \\mathrm{MeV}$.\n- Neutrino temperature ratio below annihilation $\\xi=(4/11)^{1/3}$.\n\nNumerical and unit requirements:\n- All temperatures must be in $\\mathrm{MeV}$.\n- Times must be in $\\mathrm{s}$.\n- The final answers are dimensionless ratios.\n- For numerical integration, use a method with sufficient accuracy to resolve the piecewise change at $T_{\\mathrm{ann}}$. If $T_f\\le T_{\\mathrm{target}}$, take $\\Delta t=0$.\n- Output each final $(n/p)_{\\mathrm{final}}$ as a float rounded to six decimal places.\n\nTest suite:\nYour program must evaluate the following five cases and output all five results in a single line as specified below.\n- Case 1 (typical): $T_f=0.8\\ \\mathrm{MeV}$, $T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$, $N_\\nu=3$.\n- Case 2 (earlier freeze-out): $T_f=1.5\\ \\mathrm{MeV}$, $T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$, $N_\\nu=3$.\n- Case 3 (later freeze-out): $T_f=0.6\\ \\mathrm{MeV}$, $T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$, $N_\\nu=3$.\n- Case 4 (boundary): $T_f=0.07\\ \\mathrm{MeV}$, $T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$, $N_\\nu=3$.\n- Case 5 (extra radiation): $T_f=0.8\\ \\mathrm{MeV}$, $T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$, $N_\\nu=4$.\n\nFinal output format:\n- Your program should produce a single line of output containing the five results as a comma-separated list enclosed in square brackets, in the order of Cases $1$ through $5$, with each float rounded to six decimal places (e.g., $\"[0.157000,0.333000,0.092000,0.203000,0.160000]\"$).",
            "solution": "The primary objective is to calculate the final neutron-to-proton ratio, $(n/p)_{\\mathrm{final}}$, at a specified photon temperature $T_{\\mathrm{target}}$. This ratio is determined by its initial value at the weak-interaction freeze-out temperature, $T_f$, and the subsequent decay of free neutrons over the elapsed cosmic time, $\\Delta t$, as the Universe cools from $T_f$ to $T_{\\mathrm{target}}$. The calculation involves three main steps:\n1.  Determining the elapsed time $\\Delta t$ by integrating the Friedmann equation.\n2.  Calculating the initial neutron-to-proton ratio at freeze-out, $(n/p)_{\\mathrm{freeze}}$.\n3.  Evolving this ratio forward in time to find $(n/p)_{\\mathrm{final}}$.\n\n**1. Calculation of Elapsed Time $\\Delta t$**\n\nThe relationship between cosmic time $t$ and photon temperature $T_\\gamma$ is given by the differential equation $dT_\\gamma/dt = -H(T_\\gamma) T_\\gamma$, where $H(T_\\gamma)$ is the Hubble parameter. The elapsed time $\\Delta t$ between the epoch at temperature $T_f$ and the epoch at $T_{\\mathrm{target}}$ is found by integrating this relation:\n$$\n\\Delta t = \\int_{t(T_f)}^{t(T_{\\mathrm{target}})} dt = \\int_{T_f}^{T_{\\mathrm{target}}} \\frac{dt}{dT_\\gamma} dT_\\gamma = \\int_{T_f}^{T_{\\mathrm{target}}} \\frac{-1}{H(T_\\gamma)T_\\gamma} dT_\\gamma = \\int_{T_{\\mathrm{target}}}^{T_f} \\frac{dT_\\gamma}{H(T_\\gamma)T_\\gamma}\n$$\nThe Hubble parameter $H$ is determined by the Friedmann equation for a flat, radiation-dominated universe:\n$$\nH(T_\\gamma)^2 = \\frac{\\rho(T_\\gamma)}{3 M_{\\mathrm{Pl,red}}^2}\n$$\nwhere $M_{\\mathrm{Pl,red}}$ is the reduced Planck mass and $\\rho(T_\\gamma)$ is the total energy density. The energy density of the relativistic species is given by:\n$$\n\\rho(T_\\gamma) = g_\\rho(T_\\gamma) \\frac{\\pi^2}{30} T_\\gamma^4\n$$\nHere, $g_\\rho(T_\\gamma)$ is the effective number of relativistic energy degrees of freedom, which changes as particle species become non-relativistic. The problem specifies a simplified two-stage model based on an instantaneous electron-positron ($e^\\pm$) annihilation temperature $T_{\\mathrm{ann}}=0.2\\ \\mathrm{MeV}$.\n\n**Stage 1: High Temperature ($T_\\gamma > T_{\\mathrm{ann}}$)**\nIn this regime, photons ($\\gamma$), electrons and positrons ($e^\\pm$), and $N_\\nu$ flavors of neutrinos and antineutrinos are all relativistic and share the same temperature $T_\\gamma$. The energy density contributions are:\n-   Photons (2 polarizations, bosons): $g_\\gamma = 2$.\n-   Electrons/positrons (2 particles, 2 spins each, fermions): $g_{e^\\pm} = 4 \\times \\frac{7}{8} = 3.5$.\n-   Neutrinos/antineutrinos ($N_\\nu$ flavors, 2 helicities each, fermions): $g_\\nu = 2N_\\nu \\times \\frac{7}{8} = 1.75 N_\\nu$.\nThe total effective degrees of freedom, denoted $g_H$, is constant:\n$$\ng_H = g_\\gamma + g_{e^\\pm} + g_\\nu = 2 + 3.5 + 1.75 N_\\nu = 5.5 + 1.75 N_\\nu\n$$\n\n**Stage 2: Low Temperature ($T_\\gamma \\le T_{\\mathrm{ann}}$)**\nBelow $T_{\\mathrm{ann}}$, $e^\\pm$ pairs have annihilated. The photons are reheated, but the decoupled neutrinos are not. The neutrino temperature $T_\\nu$ is related to the photon temperature $T_\\gamma$ by $T_\\nu = \\xi T_\\gamma$, with $\\xi = (4/11)^{1/3}$. The effective degrees of freedom for energy density, denoted $g_L$, is:\n$$\ng_L = g_\\gamma + g_\\nu \\left(\\frac{T_\\nu}{T_\\gamma}\\right)^4 = 2 + 1.75 N_\\nu \\xi^4 = 2 + 1.75 N_\\nu \\left(\\frac{4}{11}\\right)^{4/3}\n$$\n\nSubstituting the expressions for $\\rho(T_\\gamma)$ and $H(T_\\gamma)$ into the integral for $\\Delta t$, we have:\n$$\nH(T_\\gamma) = \\sqrt{\\frac{g_\\rho(T_\\gamma) \\pi^2 T_\\gamma^4}{90 M_{\\mathrm{Pl,red}}^2}} = \\frac{\\pi T_\\gamma^2}{M_{\\mathrm{Pl,red}}} \\sqrt{\\frac{g_\\rho(T_\\gamma)}{90}}\n$$\nThe integrand is $\\frac{1}{H(T_\\gamma)T_\\gamma} = \\frac{M_{\\mathrm{Pl,red}}}{\\pi T_\\gamma^3} \\sqrt{\\frac{90}{g_\\rho(T_\\gamma)}}$. The integral is performed over an interval where $g_\\rho(T_\\gamma)$ is constant (either $g_H$ or $g_L$):\n$$\n\\Delta t [\\mathrm{MeV}^{-1}] = \\int_{T_a}^{T_b} \\frac{M_{\\mathrm{Pl,red}}}{\\pi} \\sqrt{\\frac{90}{g_\\rho}} \\frac{dT_\\gamma}{T_\\gamma^3} = \\frac{M_{\\mathrm{Pl,red}}}{\\pi} \\sqrt{\\frac{90}{g_\\rho}} \\left[-\\frac{1}{2T_\\gamma^2}\\right]_{T_a}^{T_b} = \\frac{M_{\\mathrm{Pl,red}}}{2\\pi} \\sqrt{\\frac{90}{g_\\rho}} \\left(\\frac{1}{T_a^2} - \\frac{1}{T_b^2}\\right)\n$$\nwhere $T_b > T_a$. The integral yields a time in natural units of $\\mathrm{MeV}^{-1}$. To convert this to seconds, we multiply by the value of the reduced Planck constant, $\\hbar$, in $\\mathrm{MeV \\cdot s}$.\n\nThe total time $\\Delta t$ from $T_f$ to $T_{\\mathrm{target}}$ is calculated by summing the contributions from the two temperature regimes, splitting the integral at $T_{\\mathrm{ann}}$ if $T_f > T_{\\mathrm{ann}} > T_{\\mathrm{target}}$. If $T_f \\le T_{\\mathrm{target}}$, the elapsed time is $\\Delta t = 0$.\n\n**2. Calculation of Neutron-to-Proton Ratio**\n\nThe initial ratio at freeze-out is set by thermal equilibrium, determined by the Boltzmann factor:\n$$\n\\left(\\frac{n}{p}\\right)_{\\mathrm{freeze}} = \\exp\\left(-\\frac{\\Delta m}{T_f}\\right)\n$$\nwhere $\\Delta m$ is the neutron-proton mass difference.\n\nAfter freeze-out, free neutrons decay with a mean lifetime $\\tau_n$. Protons are stable. The number of neutrons $n(t)$ decreases as $n(t) = n(t_f) \\exp(-(t-t_f)/\\tau_n)$. The number of protons is effectively constant (ignoring the small changes from neutron decay relative to the total number of baryons). Thus, the ratio evolves as:\n$$\n\\left(\\frac{n}{p}\\right)_{\\mathrm{final}} = \\left(\\frac{n}{p}\\right)_{\\mathrm{freeze}} \\exp\\left(-\\frac{\\Delta t}{\\tau_n}\\right)\n$$\nwhere $\\Delta t$ is the elapsed time in seconds calculated in the previous step.\n\nThe algorithm for each test case is as follows:\n1.  Given $T_f$, $T_{\\mathrm{target}}$, and $N_\\nu$, first check if $T_f \\le T_{\\mathrm{target}}$. If so, $\\Delta t = 0$.\n2.  Otherwise, calculate the constants $g_H$ and $g_L$.\n3.  Calculate the time elapsed $\\Delta t$ in $\\mathrm{MeV}^{-1}$ by summing the results of the analytic integral over the high-temperature range (from $T_f$ down to $T_{\\mathrm{ann}}$, if applicable) and the low-temperature range (from $T_{\\mathrm{ann}}$ down to $T_{\\mathrm{target}}$, if applicable).\n4.  Convert $\\Delta t$ from $\\mathrm{MeV}^{-1}$ to seconds using $\\hbar$.\n5.  Calculate $(n/p)_{\\mathrm{freeze}} = \\exp(-\\Delta m/T_f)$.\n6.  Calculate $(n/p)_{\\mathrm{final}} = (n/p)_{\\mathrm{freeze}} \\exp(-\\Delta t/\\tau_n)$.\n7.  The final result is rounded to six decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the neutron-to-proton ratio at the onset of light element formation\n    for a set of cosmological parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T_f [MeV], T_target [MeV], N_nu)\n        (0.8, 0.07, 3),\n        (1.5, 0.07, 3),\n        (0.6, 0.07, 3),\n        (0.07, 0.07, 3),\n        (0.8, 0.07, 4),\n    ]\n    \n    # Constants and parameters\n    TAU_N = 879.4  # s (neutron lifetime)\n    DELTA_M = 1.29333236  # MeV (neutron-proton mass difference)\n    T_ANN = 0.2  # MeV (e+- annihilation temperature)\n    M_PL_RED = 2.435e21  # MeV (reduced Planck mass)\n    HBAR = 6.582119569e-22  # MeV*s (reduced Planck constant)\n\n    results = []\n    for case in test_cases:\n        Tf, T_target, N_nu = case\n\n        # Step 1: Compute elapsed time delta_t\n        if Tf = T_target:\n            delta_t_s = 0.0\n        else:\n            # Effective number of relativistic degrees of freedom for energy density\n            # For T > T_ann (photons, e+-, neutrinos)\n            g_H = 5.5 + 1.75 * N_nu\n            # For T = T_ann (photons, neutrinos with T_nu  T_gamma)\n            xi_4 = (4.0 / 11.0)**(4.0 / 3.0)\n            g_L = 2.0 + 1.75 * N_nu * xi_4\n            \n            # The time integral evaluates to:\n            # dt [MeV^-1] = (M_pl_red / (2*pi)) * sqrt(90/g) * (1/T_low^2 - 1/T_high^2)\n            # Pre-compute the shared constant factor for efficiency.\n            const_factor = (M_PL_RED / (2.0 * np.pi)) * np.sqrt(90.0)\n\n            delta_t_inv_MeV = 0.0\n            \n            # Integrate from Tf down to T_ann (high-temperature regime)\n            if Tf > T_ANN:\n                const_H = const_factor / np.sqrt(g_H)\n                delta_t_inv_MeV += const_H * (1.0 / T_ANN**2 - 1.0 / Tf**2)\n                current_T_upper = T_ANN\n            else:\n                current_T_upper = Tf\n            \n            # Integrate from current_T_upper down to T_target (low-temperature regime)\n            if current_T_upper > T_target:\n                const_L = const_factor / np.sqrt(g_L)\n                delta_t_inv_MeV += const_L * (1.0 / T_target**2 - 1.0 / current_T_upper**2)\n            \n            # Convert time from natural units (MeV^-1) to seconds\n            delta_t_s = delta_t_inv_MeV * HBAR\n\n        # Step 2: Calculate initial (n/p) ratio at freeze-out\n        # In the extreme case of Tf -> 0, this would diverge, but parameters are physical.\n        np_freeze = np.exp(-DELTA_M / Tf)\n\n        # Step 3: Evolve the ratio considering neutron decay\n        decay_factor = np.exp(-delta_t_s / TAU_N)\n        np_final = np_freeze * decay_factor\n        \n        results.append(\"{:.6f}\".format(np_final))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After freeze-out, a complex web of nuclear reactions begins to build the light elements. To demystify this network, this exercise  isolates a critical two-step pathway responsible for producing mass-7 nuclides. By deriving an exact analytical solution for the final $^7\\text{Li}$ abundance under simplifying assumptions, you will gain tangible insight into the competitive dynamics of production and destruction that govern nucleosynthesis.",
            "id": "3466404",
            "problem": "In a spatially flat, radiation-dominated Friedmann–Lemaître–Robertson–Walker universe, consider the narrow time window from $t_{1} = 200\\,\\mathrm{s}$ to $t_{2} = 500\\,\\mathrm{s}$ during Big Bang Nucleosynthesis, in which the only active pathways contributing to mass-$7$ are the flows\n$$\n{}^{3}\\mathrm{He}(\\alpha,\\gamma){}^{7}\\mathrm{Be}\n\\quad\\text{and}\\quad\n{}^{7}\\mathrm{Be}(n,p){}^{7}\\mathrm{Li}.\n$$\nLet $Y_{i} \\equiv n_{i}/n_{b}$ denote the abundance of nuclide $i$ per baryon, where $n_{i}$ is the number density of $i$ and $n_{b}$ is the total baryon number density. Assume:\n- The abundances $Y_{3\\mathrm{He}}$, $Y_{\\alpha}$, and $Y_{n}$ remain constant over $[t_{1},t_{2}]$ and that $Y_{7\\mathrm{Be}}(t_{1}) = 0$ and $Y_{7\\mathrm{Li}}(t_{1}) = 0$.\n- All channels other than the two listed are negligible in this interval, including any destruction of ${}^{7}\\mathrm{Li}$.\n- The production of ${}^{7}\\mathrm{Be}$ from ${}^{3}\\mathrm{He}$ is well approximated by a constant effective source coefficient $\\Lambda_{34}$ that already incorporates the alpha-particle abundance and the thermodynamic factors in this interval, so that the source term for ${}^{7}\\mathrm{Be}$ is $\\Lambda_{34} \\, Y_{3\\mathrm{He}}$.\n- The conversion of ${}^{7}\\mathrm{Be}$ to ${}^{7}\\mathrm{Li}$ by neutron-induced reaction is characterized by a rate coefficient proportional to the neutron abundance, $\\Lambda_{7} = \\Lambda_{7}^{(0)} \\left(Y_{n}/Y_{n}^{(0)}\\right)$, acting per ${}^{7}\\mathrm{Be}$ nucleus.\n\nUse the reaction-network formalism from kinetic theory to derive the coupled abundance equations, reduce them under the above assumptions to a solvable linear system, solve analytically for $Y_{7\\mathrm{Li}}(t_{2})$, and then evaluate numerically using the following constants:\n$$\nY_{3\\mathrm{He}} = 1.00 \\times 10^{-5},\\quad\nY_{\\alpha} = 6.250 \\times 10^{-2},\\quad\nY_{n} = 1.00 \\times 10^{-6},\n$$\n$$\n\\Lambda_{34} = 1.00 \\times 10^{-6}\\,\\mathrm{s}^{-1},\\quad\n\\Lambda_{7}^{(0)} = 2.00 \\times 10^{-2}\\,\\mathrm{s}^{-1},\\quad\nY_{n}^{(0)} = 1.00 \\times 10^{-6},\\quad\nt_{2}-t_{1} = 300\\,\\mathrm{s}.\n$$\nCompute the final ${}^{7}\\mathrm{Li}$ abundance per baryon $Y_{7\\mathrm{Li}}(t_{2})$ as a single real number. Round your answer to four significant figures. Express the result as a dimensionless baryon-number fraction (no units).",
            "solution": "The fundamental base for this calculation is the kinetic theory of thermonuclear reaction networks in an expanding universe. Denote by $Y_{i} \\equiv n_{i}/n_{b}$ the abundance per baryon of nuclide $i$. For a two-step pathway where ${}^{7}\\mathrm{Be}$ is produced from ${}^{3}\\mathrm{He}$ and subsequently converted to ${}^{7}\\mathrm{Li}$ by neutrons, the general form of the abundance evolution equations is\n$$\n\\frac{dY_{7\\mathrm{Be}}}{dt} = \\text{(source from ${}^{3}\\mathrm{He}$)} - \\text{(sink to ${}^{7}\\mathrm{Li}$ by $n$)},\n$$\n$$\n\\frac{dY_{7\\mathrm{Li}}}{dt} = \\text{(source from ${}^{7}\\mathrm{Be}$ by $n$)} - \\text{(sinks; neglected here)}.\n$$\nFrom reaction kinetics, the source due to ${}^{3}\\mathrm{He}(\\alpha,\\gamma){}^{7}\\mathrm{Be}$ is proportional to $Y_{3\\mathrm{He}} Y_{\\alpha} \\rho N_{A} \\langle \\sigma v \\rangle_{34}$. Under the stated assumption, these thermodynamic and compositional factors are folded into a constant effective coefficient $\\Lambda_{34}$ over the interval, so the production term is $\\Lambda_{34} \\, Y_{3\\mathrm{He}}$. The conversion ${}^{7}\\mathrm{Be}(n,p){}^{7}\\mathrm{Li}$ is a first-order sink for ${}^{7}\\mathrm{Be}$ with a rate per ${}^{7}\\mathrm{Be}$ nucleus proportional to the neutron abundance, which we parameterize as\n$$\n\\Lambda_{7} \\equiv \\Lambda_{7}^{(0)} \\left(\\frac{Y_{n}}{Y_{n}^{(0)}}\\right).\n$$\nWith these definitions and neglecting other channels, the coupled system becomes\n$$\n\\frac{dY_{7\\mathrm{Be}}}{dt} = \\Lambda_{34} \\, Y_{3\\mathrm{He}} - \\Lambda_{7} \\, Y_{7\\mathrm{Be}},\n\\qquad\n\\frac{dY_{7\\mathrm{Li}}}{dt} = \\Lambda_{7} \\, Y_{7\\mathrm{Be}}.\n$$\nThe initial conditions at $t=t_{1}$ are $Y_{7\\mathrm{Be}}(t_{1}) = 0$ and $Y_{7\\mathrm{Li}}(t_{1}) = 0$, and $Y_{3\\mathrm{He}}$, $\\Lambda_{34}$, and $\\Lambda_{7}$ are constants in $[t_{1},t_{2}]$.\n\nFirst, solve for $Y_{7\\mathrm{Be}}(t)$. This is a linear, first-order inhomogeneous ordinary differential equation with constant coefficients:\n$$\n\\frac{dY_{7\\mathrm{Be}}}{dt} + \\Lambda_{7} \\, Y_{7\\mathrm{Be}} = \\Lambda_{34} \\, Y_{3\\mathrm{He}}.\n$$\nUsing an integrating factor $\\mu(t) = \\exp(\\Lambda_{7} t)$, we obtain\n$$\n\\frac{d}{dt}\\left( \\exp(\\Lambda_{7} t) \\, Y_{7\\mathrm{Be}} \\right) = \\Lambda_{34} \\, Y_{3\\mathrm{He}} \\, \\exp(\\Lambda_{7} t).\n$$\nIntegrating from $t_{1}$ to $t$ and applying $Y_{7\\mathrm{Be}}(t_{1}) = 0$,\n$$\n\\exp(\\Lambda_{7} t) \\, Y_{7\\mathrm{Be}}(t) - \\exp(\\Lambda_{7} t_{1}) \\, Y_{7\\mathrm{Be}}(t_{1}) = \\Lambda_{34} \\, Y_{3\\mathrm{He}} \\int_{t_{1}}^{t} \\exp(\\Lambda_{7} t') \\, dt',\n$$\n$$\nY_{7\\mathrm{Be}}(t) = \\frac{\\Lambda_{34} \\, Y_{3\\mathrm{He}}}{\\Lambda_{7}} \\left( 1 - \\exp\\!\\big(-\\Lambda_{7} (t - t_{1})\\big) \\right).\n$$\nNext, insert this into the ${}^{7}\\mathrm{Li}$ equation:\n$$\n\\frac{dY_{7\\mathrm{Li}}}{dt} = \\Lambda_{7} \\, Y_{7\\mathrm{Be}}(t) = \\Lambda_{7} \\cdot \\frac{\\Lambda_{34} \\, Y_{3\\mathrm{He}}}{\\Lambda_{7}} \\left( 1 - \\exp\\!\\big(-\\Lambda_{7} (t - t_{1})\\big) \\right) = \\Lambda_{34} \\, Y_{3\\mathrm{He}} \\left( 1 - \\exp\\!\\big(-\\Lambda_{7} (t - t_{1})\\big) \\right).\n$$\nIntegrate from $t_{1}$ to $t_{2}$ and use $Y_{7\\mathrm{Li}}(t_{1}) = 0$:\n$$\nY_{7\\mathrm{Li}}(t_{2}) = \\Lambda_{34} \\, Y_{3\\mathrm{He}} \\int_{t_{1}}^{t_{2}} \\left( 1 - \\exp\\!\\big(-\\Lambda_{7} (t - t_{1})\\big) \\right) dt.\n$$\nLet $\\tau \\equiv t - t_{1}$ and $\\Delta t \\equiv t_{2} - t_{1}$; then\n$$\nY_{7\\mathrm{Li}}(t_{2}) = \\Lambda_{34} \\, Y_{3\\mathrm{He}} \\int_{0}^{\\Delta t} \\left( 1 - \\exp(-\\Lambda_{7} \\tau) \\right) d\\tau\n= \\Lambda_{34} \\, Y_{3\\mathrm{He}} \\left[ \\Delta t - \\frac{1 - \\exp(-\\Lambda_{7} \\Delta t)}{\\Lambda_{7}} \\right].\n$$\nThis is the closed-form analytic expression under the stated assumptions.\n\nNow evaluate numerically. First compute $\\Lambda_{7}$ from the normalization:\n$$\n\\Lambda_{7} = \\Lambda_{7}^{(0)} \\left( \\frac{Y_{n}}{Y_{n}^{(0)}} \\right)\n= \\left(2.00 \\times 10^{-2}\\,\\mathrm{s}^{-1}\\right) \\left( \\frac{1.00 \\times 10^{-6}}{1.00 \\times 10^{-6}} \\right)\n= 2.00 \\times 10^{-2}\\,\\mathrm{s}^{-1}.\n$$\nCompute $\\Lambda_{7} \\Delta t$:\n$$\n\\Lambda_{7} \\Delta t = \\left(2.00 \\times 10^{-2}\\,\\mathrm{s}^{-1}\\right) \\left(300\\,\\mathrm{s}\\right) = 6.00.\n$$\nEvaluate the bracket:\n$$\n1 - \\exp(-\\Lambda_{7} \\Delta t) = 1 - \\exp(-6.00) \\approx 1 - 0.00247875217666 \\approx 0.99752124782334,\n$$\n$$\n\\frac{1 - \\exp(-\\Lambda_{7} \\Delta t)}{\\Lambda_{7}} \\approx \\frac{0.99752124782334}{2.00 \\times 10^{-2}} \\approx 49.876062391167.\n$$\nThus,\n$$\n\\left[ \\Delta t - \\frac{1 - \\exp(-\\Lambda_{7} \\Delta t)}{\\Lambda_{7}} \\right] \\approx 300 - 49.876062391167 \\approx 250.123937608833.\n$$\nFinally,\n$$\nY_{7\\mathrm{Li}}(t_{2}) = \\left(1.00 \\times 10^{-6}\\,\\mathrm{s}^{-1}\\right) \\left(1.00 \\times 10^{-5}\\right) \\left(250.123937608833\\,\\mathrm{s}\\right)\n\\approx 2.50123937608833 \\times 10^{-9}.\n$$\nRounded to four significant figures as required,\n$$\nY_{7\\mathrm{Li}}(t_{2}) \\approx 2.501 \\times 10^{-9}.\n$$\nThis is the dimensionless abundance per baryon at $t_{2}$ under the stated assumptions.",
            "answer": "$$\\boxed{2.501\\times 10^{-9}}$$"
        },
        {
            "introduction": "Solving a full BBN reaction network numerically presents a significant challenge due to its \"stiffness\"—the coexistence of reactions with vastly different timescales. This advanced practice  takes you to the heart of this numerical problem by having you construct the network's Jacobian matrix. By analyzing its eigenvalues, you will directly diagnose the system's stiffness, a critical skill for developing or interpreting modern BBN codes.",
            "id": "3466440",
            "problem": "Consider a simplified Big Bang Nucleosynthesis reaction network for the species neutron, proton, deuteron, helium-$3$, and helium-$4$, denoted by the abundance vector $\\mathbf{Y} = \\left(Y_{n}, Y_{p}, Y_{d}, Y_{3}, Y_{4}\\right)$, where $Y_{i}$ is the number fraction per baryon. The time derivatives $\\dot{Y}_{i}$ arise from a set of reactions modeled by mass-action kinetics under homogeneous conditions. Assume the following reactions and effective rate forms, with temperature $T$ expressed in megaelectronvolts (MeV) and time in seconds (s):\n\n- Weak interconversion:\n  - $n \\to p$ with rate per particle $\\lambda_{np}(T) = a_{w} T^{5}$,\n  - $p \\to n$ with rate per particle $\\lambda_{pn}(T) = a_{w} T^{5} \\exp\\!\\left(-\\Delta/T\\right)$,\n  where $a_{w} = 1.0\\,\\mathrm{s}^{-1}\\,\\mathrm{MeV}^{-5}$ and $\\Delta = 1.293\\,\\mathrm{MeV}$.\n\n- Nuclear reactions (forward, with photodisintegration only for deuterium):\n  - $n + p \\rightleftharpoons d + \\gamma$ with forward binary rate coefficient $k_{np\\to d\\gamma}(T) = 4.5\\times 10^{-27}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}\\,\\sqrt{T/0.1}$ and deuteron photodisintegration rate $\\lambda_{\\gamma d}(T) = 1.0\\times 10^{5}\\,\\mathrm{s}^{-1}\\,T^{3}\\,\\exp\\!\\left(-B_{d}/T\\right)$, with $B_{d} = 2.224\\,\\mathrm{MeV}$.\n  - $d + p \\to {}^{3}\\mathrm{He} + \\gamma$ with $k_{dp\\to 3\\gamma}(T) = 1.0\\times 10^{-26}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}\\,\\sqrt{T/0.1}$.\n  - $d + d \\to {}^{3}\\mathrm{He} + n$ with $k_{dd\\to 3n}(T) = 5.0\\times 10^{-27}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}\\,\\sqrt{T/0.1}$.\n  - ${}^{3}\\mathrm{He} + d \\to {}^{4}\\mathrm{He} + p$ with $k_{3d\\to 4p}(T) = 1.0\\times 10^{-26}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}\\,\\sqrt{T/0.1}$.\n\nLet the baryon number density be $n_{b}(T) = \\eta\\,n_{\\gamma}(T)$, with the baryon-to-photon ratio $\\eta = 6.1\\times 10^{-10}$ and photon number density\n$$\nn_{\\gamma}(T) = \\frac{2\\,\\zeta(3)}{\\pi^{2}} \\frac{\\left(k_{B} T\\right)^{3}}{\\left(\\hbar c\\right)^{3}},\n$$\nwhere $\\zeta(3) \\approx 1.202056903159594$, $k_{B}$ is Boltzmann’s constant, $\\hbar$ is the reduced Planck constant, and $c$ is the speed of light. Here $T$ is used as an energy in the factors $k_{B}T$ when inserted in the above expression, with $1\\,\\mathrm{MeV} = 1.602176634\\times 10^{-13}\\,\\mathrm{J}$.\n\nAssume the ordinary differential equations for $\\dot{\\mathbf{Y}}$ follow from mass-action kinetics using the above rates and $n_{b}(T)$, treating per-baryon binary forward reaction rates as $r = n_{b}(T)\\,k(T)\\,Y_{A}Y_{B}$ and one-body photodisintegration as $r = \\lambda(T)\\,Y$. For the reaction $d + d \\to {}^{3}\\mathrm{He} + n$, include the standard factor of $1/2$ for identical reactants in the forward rate such that $r_{dd\\to 3n} = \\tfrac{1}{2} n_{b}(T) k_{dd\\to 3n}(T) Y_{d}^{2}$.\n\nTask:\n- Starting from mass-action kinetics and baryon number conservation, write down the system $\\dot{\\mathbf{Y}} = \\mathbf{F}(\\mathbf{Y}; T)$ implied by the above reactions.\n- Construct the analytic Jacobian matrix $J(\\mathbf{Y}; T) = \\left[\\partial \\dot{Y}_{i}/\\partial Y_{j}\\right]$.\n- For each of the test cases below, evaluate $J$ at the given $T$ and $\\mathbf{Y}$, compute the eigenvalues of $J$, and identify the fastest decay mode by taking the maximum over the negative real parts, that is,\n$$\n\\Gamma_{\\mathrm{fast}}(T,\\mathbf{Y}) = \\max\\left\\{-\\operatorname{Re}\\lambda : \\lambda \\in \\operatorname{eig}\\left(J(\\mathbf{Y};T)\\right),\\ \\operatorname{Re}\\lambda  0\\right\\},\n$$\nwith the convention that if no eigenvalue has negative real part, then $\\Gamma_{\\mathrm{fast}} = 0$.\n\nAll outputs must be expressed in $\\mathrm{s}^{-1}$ as floating-point numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite, with each value rounded to $6$ significant figures.\n\nTest suite (each case is a pair $(T,\\mathbf{Y})$; $T$ in MeV; $\\mathbf{Y}$ ordered as $(Y_{n}, Y_{p}, Y_{d}, Y_{3}, Y_{4})$ and satisfying baryon-number consistency $\\sum_{i} A_{i} Y_{i} = 1$ with mass numbers $A_{n}=1$, $A_{p}=1$, $A_{d}=2$, $A_{3}=3$, $A_{4}=4$):\n- Case $1$: $T = 0.2$, $\\mathbf{Y} = (0.12,\\,0.88,\\,0,\\,0,\\,0)$.\n- Case $2$: $T = 0.1$, $\\mathbf{Y} = (0.12,\\,0.84,\\,0.02,\\,0,\\,0)$.\n- Case $3$: $T = 0.07$, $\\mathbf{Y} = (0.08,\\,0.53,\\,0.02,\\,0.01,\\,0.08)$.\n- Case $4$ (edge case with all baryons in deuterium): $T = 0.1$, $\\mathbf{Y} = (0,\\,0,\\,0.5,\\,0,\\,0)$.\n\nYour program must implement the rate model exactly as specified above, construct $J$, compute $\\Gamma_{\\mathrm{fast}}$ for each case, and print a single line in the exact format: for example, $[x_{1},x_{2},x_{3},x_{4}]$ where each $x_{i}$ is the rounded value of $\\Gamma_{\\mathrm{fast}}$ in $\\mathrm{s}^{-1}$ for the corresponding test case.",
            "solution": "We model a reduced Big Bang Nucleosynthesis network with the abundance vector $\\mathbf{Y} = \\left(Y_{n}, Y_{p}, Y_{d}, Y_{3}, Y_{4}\\right)$, where $Y_{i}$ is the number of nuclei of species $i$ per baryon. The fundamental base is mass-action kinetics and the expression for the photon number density in a thermal radiation field. The baryon number density is $n_{b}(T) = \\eta n_{\\gamma}(T)$ with\n$$\nn_{\\gamma}(T) = \\frac{2\\,\\zeta(3)}{\\pi^{2}} \\frac{\\left(k_{B} T\\right)^{3}}{\\left(\\hbar c\\right)^{3}},\n$$\nand $T$ is to be treated as an energy when inserted into $k_{B} T$ using $1\\,\\mathrm{MeV} = 1.602176634\\times 10^{-13}\\,\\mathrm{J}$. The baryon-to-photon ratio $\\eta$ is taken as a constant in the early Universe.\n\nThe reaction set and rates are:\n- Weak interconversion with rates per particle $\\lambda_{np}(T) = a_{w} T^{5}$ and $\\lambda_{pn}(T) = a_{w} T^{5} \\exp\\!\\left(-\\Delta/T\\right)$, where $a_{w} = 1.0\\,\\mathrm{s}^{-1}\\,\\mathrm{MeV}^{-5}$ and $\\Delta = 1.293\\,\\mathrm{MeV}$. These couple $Y_{n}$ and $Y_{p}$ without changing baryon number.\n\n- Binary nuclear reactions produce per-baryon rates $r = n_{b}(T) k(T) Y_{A} Y_{B}$, where $k(T)$ is the thermally averaged rate coefficient in $\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$. For identical reactants $d + d$, the standard symmetry factor $\\tfrac{1}{2}$ enters. One-body photodisintegration of deuterium has rate $r = \\lambda_{\\gamma d}(T) Y_{d}$ with $\\lambda_{\\gamma d}(T) = 1.0\\times 10^{5}\\,\\mathrm{s}^{-1}\\,T^{3}\\,\\exp\\!\\left(-B_{d}/T\\right)$ and $B_{d} = 2.224\\,\\mathrm{MeV}$.\n\nWe define the following shorthand rates at fixed $T$:\n- $r_{1f} = n_{b} k_{np\\to d\\gamma}(T) Y_{n} Y_{p}$ and $r_{1r} = \\lambda_{\\gamma d}(T) Y_{d}$ for $n + p \\rightleftharpoons d + \\gamma$,\n- $r_{2f} = n_{b} k_{dp\\to 3\\gamma}(T) Y_{d} Y_{p}$ for $d + p \\to {}^{3}\\mathrm{He} + \\gamma$,\n- $r_{3f} = \\tfrac{1}{2} n_{b} k_{dd\\to 3n}(T) Y_{d}^{2}$ for $d + d \\to {}^{3}\\mathrm{He} + n$,\n- $r_{4f} = n_{b} k_{3d\\to 4p}(T) Y_{3} Y_{d}$ for ${}^{3}\\mathrm{He} + d \\to {}^{4}\\mathrm{He} + p$.\n\nApplying mass-action kinetics and stoichiometry, the abundance equations are:\n- For neutrons $n$:\n$$\n\\dot{Y}_{n} = -\\lambda_{np} Y_{n} + \\lambda_{pn} Y_{p} - r_{1f} + r_{1r} + r_{3f}.\n$$\nThe terms reflect $n \\to p$ loss, $p \\to n$ gain, $n+p \\to d$ loss, $d \\to n+p$ gain, and $d+d \\to {}^{3}\\mathrm{He} + n$ gain.\n\n- For protons $p$:\n$$\n\\dot{Y}_{p} = +\\lambda_{np} Y_{n} - \\lambda_{pn} Y_{p} - r_{1f} + r_{1r} - r_{2f} + r_{4f}.\n$$\nHere $d+p \\to {}^{3}\\mathrm{He} + \\gamma$ removes protons and ${}^{3}\\mathrm{He} + d \\to {}^{4}\\mathrm{He} + p$ produces protons.\n\n- For deuterons $d$:\n$$\n\\dot{Y}_{d} = + r_{1f} - r_{1r} - r_{2f} - 2 r_{3f} - r_{4f}.\n$$\nDeuterium is made by $n+p$ capture and destroyed by photodisintegration, by capture with $p$ to ${}^{3}\\mathrm{He}$, by fusing with another $d$ (consuming two $d$ per event), and by capture with ${}^{3}\\mathrm{He}$.\n\n- For helium-$3$:\n$$\n\\dot{Y}_{3} = + r_{2f} + r_{3f} - r_{4f}.\n$$\n\n- For helium-$4$:\n$$\n\\dot{Y}_{4} = + r_{4f}.\n$$\n\nThe analytic Jacobian matrix $J = \\left[\\partial \\dot{Y}_{i}/\\partial Y_{j}\\right]$ follows by differentiating each right-hand side with respect to $Y_{j}$, holding $T$ fixed. The rate coefficients depend only on $T$ and thus have zero derivatives with respect to the abundances. The nonzero partial derivatives of the shorthand rates are:\n- $\\partial r_{1f}/\\partial Y_{n} = n_{b} k_{np\\to d\\gamma} Y_{p}$, $\\partial r_{1f}/\\partial Y_{p} = n_{b} k_{np\\to d\\gamma} Y_{n}$,\n- $\\partial r_{1r}/\\partial Y_{d} = \\lambda_{\\gamma d}$,\n- $\\partial r_{2f}/\\partial Y_{d} = n_{b} k_{dp\\to 3\\gamma} Y_{p}$, $\\partial r_{2f}/\\partial Y_{p} = n_{b} k_{dp\\to 3\\gamma} Y_{d}$,\n- $\\partial r_{3f}/\\partial Y_{d} = n_{b} k_{dd\\to 3n} Y_{d}$,\n- $\\partial r_{4f}/\\partial Y_{d} = n_{b} k_{3d\\to 4p} Y_{3}$, $\\partial r_{4f}/\\partial Y_{3} = n_{b} k_{3d\\to 4p} Y_{d}$.\n\nThus the Jacobian entries are:\n\nFor the neutron row:\n$$\n\\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{n}} = -\\lambda_{np} - \\frac{\\partial r_{1f}}{\\partial Y_{n}} + 0 + 0 = -\\lambda_{np} - n_{b} k_{np\\to d\\gamma} Y_{p},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{p}} = \\lambda_{pn} - \\frac{\\partial r_{1f}}{\\partial Y_{p}} = \\lambda_{pn} - n_{b} k_{np\\to d\\gamma} Y_{n},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{d}} = \\frac{\\partial r_{1r}}{\\partial Y_{d}} + \\frac{\\partial r_{3f}}{\\partial Y_{d}} = \\lambda_{\\gamma d} + n_{b} k_{dd\\to 3n} Y_{d},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{3}} = 0,\\quad \\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{4}} = 0.\n$$\n\nFor the proton row:\n$$\n\\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{n}} = \\lambda_{np} - \\frac{\\partial r_{1f}}{\\partial Y_{n}} = \\lambda_{np} - n_{b} k_{np\\to d\\gamma} Y_{p},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{p}} = -\\lambda_{pn} - \\frac{\\partial r_{1f}}{\\partial Y_{p}} - \\frac{\\partial r_{2f}}{\\partial Y_{p}} = -\\lambda_{pn} - n_{b} k_{np\\to d\\gamma} Y_{n} - n_{b} k_{dp\\to 3\\gamma} Y_{d},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{d}} = \\frac{\\partial r_{1r}}{\\partial Y_{d}} - \\frac{\\partial r_{2f}}{\\partial Y_{d}} + \\frac{\\partial r_{4f}}{\\partial Y_{d}} = \\lambda_{\\gamma d} - n_{b} k_{dp\\to 3\\gamma} Y_{p} + n_{b} k_{3d\\to 4p} Y_{3},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{3}} = \\frac{\\partial r_{4f}}{\\partial Y_{3}} = n_{b} k_{3d\\to 4p} Y_{d},\\quad \\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{4}} = 0.\n$$\n\nFor the deuteron row:\n$$\n\\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{n}} = \\frac{\\partial r_{1f}}{\\partial Y_{n}} = n_{b} k_{np\\to d\\gamma} Y_{p},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{p}} = \\frac{\\partial r_{1f}}{\\partial Y_{p}} - \\frac{\\partial r_{2f}}{\\partial Y_{p}} = n_{b} k_{np\\to d\\gamma} Y_{n} - n_{b} k_{dp\\to 3\\gamma} Y_{d},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{d}} = - \\frac{\\partial r_{1r}}{\\partial Y_{d}} - \\frac{\\partial r_{2f}}{\\partial Y_{d}} - 2 \\frac{\\partial r_{3f}}{\\partial Y_{d}} - \\frac{\\partial r_{4f}}{\\partial Y_{d}} = -\\lambda_{\\gamma d} - n_{b} k_{dp\\to 3\\gamma} Y_{p} - 2 n_{b} k_{dd\\to 3n} Y_{d} - n_{b} k_{3d\\to 4p} Y_{3},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{3}} = - \\frac{\\partial r_{4f}}{\\partial Y_{3}} = - n_{b} k_{3d\\to 4p} Y_{d},\\quad \\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{4}} = 0.\n$$\n\nFor the helium-$3$ row:\n$$\n\\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{n}} = 0,\\quad \\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{p}} = \\frac{\\partial r_{2f}}{\\partial Y_{p}} = n_{b} k_{dp\\to 3\\gamma} Y_{d},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{d}} = \\frac{\\partial r_{2f}}{\\partial Y_{d}} + \\frac{\\partial r_{3f}}{\\partial Y_{d}} - \\frac{\\partial r_{4f}}{\\partial Y_{d}} = n_{b} k_{dp\\to 3\\gamma} Y_{p} + n_{b} k_{dd\\to 3n} Y_{d} - n_{b} k_{3d\\to 4p} Y_{3},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{3}} = - \\frac{\\partial r_{4f}}{\\partial Y_{3}} = - n_{b} k_{3d\\to 4p} Y_{d},\\quad \\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{4}} = 0.\n$$\n\nFor the helium-$4$ row:\n$$\n\\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{n}} = 0,\\quad \\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{p}} = 0,\\quad \\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{d}} = \\frac{\\partial r_{4f}}{\\partial Y_{d}} = n_{b} k_{3d\\to 4p} Y_{3},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{3}} = \\frac{\\partial r_{4f}}{\\partial Y_{3}} = n_{b} k_{3d\\to 4p} Y_{d},\\quad \\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{4}} = 0.\n$$\n\nThe algorithm proceeds as follows for each test case:\n- Convert $T$ in MeV to $k_{B} T$ in joules via $k_{B} T = (T/\\mathrm{MeV}) \\times 1.602176634\\times 10^{-13}\\,\\mathrm{J}$, insert into $n_{\\gamma}(T)$, and compute $n_{b}(T) = \\eta n_{\\gamma}(T)$.\n- Evaluate all temperature-dependent rates at that $T$.\n- Assemble $J(\\mathbf{Y};T)$ using the above partial derivatives.\n- Compute the eigenvalues of $J$ and obtain $\\Gamma_{\\mathrm{fast}}(T,\\mathbf{Y}) = \\max\\left\\{-\\operatorname{Re}\\lambda : \\operatorname{Re}\\lambda  0\\right\\}$, or $0$ if no negative real parts exist.\n- Round $\\Gamma_{\\mathrm{fast}}$ to $6$ significant figures and output in a single list for the ordered test suite.\n\nThis construction derives from mass-action kinetics, baryon number conservation through stoichiometric consistency, and the use of the photon number density in a thermal bath to determine the baryon number density from $\\eta$. The Jacobian’s eigenvalues characterize the linearized modes of the network near the specified state: large negative real parts correspond to fast decaying (stiff) modes. The reported $\\Gamma_{\\mathrm{fast}}$ identifies the fastest such decay rate in $\\mathrm{s}^{-1}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nHBAR = 1.054571817e-34       # J*s\nC = 299792458.0              # m/s\nPI = np.pi\nMEV_TO_J = 1.602176634e-13   # 1 MeV in Joules\nZETA3 = 1.202056903159594    # Apery's constant zeta(3)\n\n# Cosmological parameter\nETA = 6.1e-10  # baryon-to-photon ratio\n\ndef n_gamma(T_MeV: float) -> float:\n    \"\"\"\n    Photon number density n_gamma(T) in m^-3.\n    T_MeV is temperature in MeV interpreted as energy scale: k_B T = T_MeV * MEV_TO_J.\n    \"\"\"\n    kT = T_MeV * MEV_TO_J  # J\n    pref = 2.0 * ZETA3 / (PI**2)\n    return pref * (kT**3) / ((HBAR * C)**3)\n\ndef n_baryon(T_MeV: float) -> float:\n    return ETA * n_gamma(T_MeV)\n\ndef rates(T_MeV: float):\n    \"\"\"\n    Compute temperature-dependent rates at T (MeV).\n    Returns a dictionary of scalar rates and rate coefficients.\n    \"\"\"\n    # Weak rates\n    a_w = 1.0  # s^-1 MeV^-5\n    Delta = 1.293  # MeV\n    lam_np = a_w * (T_MeV**5)\n    lam_pn = a_w * (T_MeV**5) * np.exp(-Delta / max(T_MeV, 1e-12))\n\n    # Nuclear rate coefficients (m^3/s), mild T scaling\n    scale = np.sqrt(max(T_MeV, 0.0) / 0.1)\n    k_np_d = 4.5e-27 * scale\n    k_dp_3 = 1.0e-26 * scale\n    k_dd_3n = 5.0e-27 * scale\n    k_3d_4p = 1.0e-26 * scale\n\n    # Photodisintegration of deuteron (s^-1)\n    Bd = 2.224  # MeV\n    lam_gd = 1.0e5 * (T_MeV**3) * np.exp(-Bd / max(T_MeV, 1e-12))\n\n    return {\n        \"lam_np\": lam_np,\n        \"lam_pn\": lam_pn,\n        \"k_np_d\": k_np_d,\n        \"k_dp_3\": k_dp_3,\n        \"k_dd_3n\": k_dd_3n,\n        \"k_3d_4p\": k_3d_4p,\n        \"lam_gd\": lam_gd,\n    }\n\ndef jacobian(Y, T_MeV):\n    \"\"\"\n    Construct the 5x5 Jacobian matrix d(dY/dt)/dY at given abundances Y and temperature T_MeV.\n    Y order: [Y_n, Y_p, Y_d, Y_3, Y_4]\n    \"\"\"\n    Yn, Yp, Yd, Y3, Y4 = Y\n    nb = n_baryon(T_MeV)\n    r = rates(T_MeV)\n\n    lam_np = r[\"lam_np\"]\n    lam_pn = r[\"lam_pn\"]\n    k_np_d = r[\"k_np_d\"]\n    k_dp_3 = r[\"k_dp_3\"]\n    k_dd_3n = r[\"k_dd_3n\"]\n    k_3d_4p = r[\"k_3d_4p\"]\n    lam_gd = r[\"lam_gd\"]\n\n    # Precompute useful combinations for derivatives\n    d_r1f_dYn = nb * k_np_d * Yp\n    d_r1f_dYp = nb * k_np_d * Yn\n    d_r1r_dYd = lam_gd\n    d_r2f_dYd = nb * k_dp_3 * Yp\n    d_r2f_dYp = nb * k_dp_3 * Yd\n    d_r3f_dYd = nb * k_dd_3n * Yd\n    d_r4f_dYd = nb * k_3d_4p * Y3\n    d_r4f_dY3 = nb * k_3d_4p * Yd\n\n    J = np.zeros((5,5), dtype=np.float64)\n\n    # Row for dY_n/dt\n    J[0,0] = -lam_np - d_r1f_dYn\n    J[0,1] = lam_pn - d_r1f_dYp\n    J[0,2] = d_r1r_dYd + d_r3f_dYd\n    J[0,3] = 0.0\n    J[0,4] = 0.0\n\n    # Row for dY_p/dt\n    J[1,0] = lam_np - d_r1f_dYn\n    J[1,1] = -lam_pn - d_r1f_dYp - d_r2f_dYp\n    J[1,2] = d_r1r_dYd - d_r2f_dYd + d_r4f_dYd\n    J[1,3] = d_r4f_dY3\n    J[1,4] = 0.0\n\n    # Row for dY_d/dt\n    J[2,0] = d_r1f_dYn\n    J[2,1] = d_r1f_dYp - d_r2f_dYp\n    J[2,2] = -d_r1r_dYd - d_r2f_dYd - 2.0 * d_r3f_dYd - d_r4f_dYd\n    J[2,3] = -d_r4f_dY3\n    J[2,4] = 0.0\n\n    # Row for dY_3/dt\n    J[3,0] = 0.0\n    J[3,1] = d_r2f_dYp\n    J[3,2] = d_r2f_dYd + d_r3f_dYd - d_r4f_dYd\n    J[3,3] = -d_r4f_dY3\n    J[3,4] = 0.0\n\n    # Row for dY_4/dt\n    J[4,0] = 0.0\n    J[4,1] = 0.0\n    J[4,2] = d_r4f_dYd\n    J[4,3] = d_r4f_dY3\n    J[4,4] = 0.0\n\n    return J\n\ndef fastest_decay_rate(Y, T_MeV):\n    J = jacobian(Y, T_MeV)\n    eigs = np.linalg.eigvals(J)\n    real_parts = np.real(eigs)\n    neg_reals = real_parts[real_parts  0.0]\n    if neg_reals.size == 0:\n        return 0.0\n    return float(np.max(-neg_reals))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T_MeV, [Yn, Yp, Yd, Y3, Y4])\n        (0.2,  [0.12, 0.88, 0.0,  0.0,  0.0]),\n        (0.1,  [0.12, 0.84, 0.02, 0.0,  0.0]),\n        (0.07, [0.08, 0.53, 0.02, 0.01, 0.08]),\n        (0.1,  [0.0,  0.0,  0.5,  0.0,  0.0]),\n    ]\n\n    results = []\n    for T, Y in test_cases:\n        gamma_fast = fastest_decay_rate(Y, T)\n        # Round to 6 significant figures\n        results.append(f\"{gamma_fast:.6g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}