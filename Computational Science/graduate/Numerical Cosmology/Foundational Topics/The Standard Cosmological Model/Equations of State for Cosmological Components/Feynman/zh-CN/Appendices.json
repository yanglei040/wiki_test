{
    "hands_on_practices": [
        {
            "introduction": "宇宙学中的一个基本问题是，随着宇宙的膨胀，不同能量组分的密度如何演化。这个过程由连续性方程和状态方程参数 $w$ 共同决定。这项练习将引导你掌握一项基础的解析推导技能：从守恒定律出发，为一种广泛使用的唯象暗能量模型（CPL模型）推导出其能量密度 $\\rho(a)$ 的解析表达式 。这项技能是构建和分析自定义宇宙学模型的基础。",
            "id": "3470586",
            "problem": "在一个空间均匀且各向同性的弗里德曼-勒梅特-罗伯逊-沃尔克 (FLRW) 宇宙中，理想流体组分的能量动量守恒意味着连续性方程 $\\,\\dot{\\rho} + 3 H (\\rho + p) = 0\\,$，其中 $\\rho$ 是能量密度，$p$ 是压强，$H$ 是哈勃参数，且 $H = \\dot{a}/a$，$a$ 是标度因子。考虑一个类暗能量组分，其压强满足 $p = w(a)\\,\\rho$，状态方程参数由 Chevallier–Polarski–Linder (CPL) 参数化给出：$\\,w(a) = w_0 + w_a(1 - a)\\,$，其中 $w_0$ 和 $w_a$ 是常数。假设当今的归一化值为 $a_0 = 1$，且边界条件为 $\\,\\rho(a=1) = \\rho_0\\,$，其中 $\\rho_0$ 是一个常数。\n\n仅从能量动量守恒定律和上述定义出发，推导此 CPL 参数化下能量密度 $\\,\\rho(a)\\,$ 作为 $a$ 的函数的闭式解析表达式。将你的最终结果表示为包含 $a$、$w_0$、$w_a$ 和 $\\rho_0$ 的单个解析表达式。",
            "solution": "本题要求在弗里德曼-勒梅特-罗伯逊-沃尔克 (FLRW) 宇宙中，从能量动量守恒定律出发，推导由 Chevallier–Polarski–Linder (CPL) 状态方程参数化描述的宇宙学组分的能量密度 $\\rho(a)$。\n\n题目陈述的验证过程如下：\n1.  **提取已知条件**：\n    -   连续性方程：$\\dot{\\rho} + 3 H (\\rho + p) = 0$\n    -   哈勃参数：$H = \\frac{\\dot{a}}{a}$\n    -   状态方程：$p = w(a)\\rho$\n    -   CPL 参数化：$w(a) = w_0 + w_a(1 - a)$\n    -   归一化：$a_0 = 1$\n    -   边界条件：$\\rho(a=1) = \\rho_0$\n\n2.  **验证**：\n    -   **科学依据**：该问题建立在物理宇宙学的标准基本方程（FLRW 度规、连续性方程）和一个广泛使用的唯象模型（CPL 参数化）之上。它在科学上是合理的。\n    -   **适定性**：该问题是一个带给定边界条件的一阶常微分方程。这构成了一个适定的初值问题，预期会有一个唯一且稳定的解。所有术语都得到了清晰明确的定义。\n    -   **客观性**：该问题使用形式化的数学和物理语言陈述，没有主观性或歧义。\n\n3.  **结论**：\n    -   该问题被认为是有效的，因为它是自洽的、科学合理的且适定的。我们可以着手求解。\n\n推导始于 FLRW 宇宙中理想流体的连续性方程：\n$$\n\\dot{\\rho} + 3 H (\\rho + p) = 0\n$$\n其中点号表示对宇宙时 $t$ 的微分。我们已知关系式 $p = w(a)\\rho$。将其代入连续性方程得到：\n$$\n\\dot{\\rho} + 3 H (\\rho + w(a)\\rho) = 0\n$$\n$$\n\\dot{\\rho} + 3 H \\rho (1 + w(a)) = 0\n$$\n哈勃参数定义为 $H = \\frac{\\dot{a}}{a}$。代入此定义得到：\n$$\n\\dot{\\rho} + 3 \\frac{\\dot{a}}{a} \\rho (1 + w(a)) = 0\n$$\n我们的目标是找到 $\\rho$ 作为标度因子 $a$ 的函数，因此必须将自变量从时间 $t$ 更改为标度因子 $a$。使用链式法则，$\\rho$ 的时间导数可以表示为：\n$$\n\\dot{\\rho} = \\frac{d\\rho}{dt} = \\frac{d\\rho}{da} \\frac{da}{dt} = \\frac{d\\rho}{da} \\dot{a}\n$$\n将此代入我们的方程：\n$$\n\\frac{d\\rho}{da} \\dot{a} + 3 \\frac{\\dot{a}}{a} \\rho (1 + w(a)) = 0\n$$\n对于一个非静态宇宙，$\\dot{a} \\neq 0$，所以我们可以将整个方程除以 $\\dot{a}$：\n$$\n\\frac{d\\rho}{da} + \\frac{3}{a} \\rho (1 + w(a)) = 0\n$$\n这是一个一阶线性常微分方程，同时也是可分离变量的。我们重新整理各项以分离变量 $\\rho$ 和 $a$：\n$$\n\\frac{d\\rho}{\\rho} = -3 \\frac{1 + w(a)}{a} da\n$$\n为了求出 $\\rho(a)$ 的特解，我们对该方程进行积分。积分限由给定的边界条件确定：当 $a=1$ 时，密度为 $\\rho_0$。我们从状态 $(a=1, \\rho=\\rho_0)$ 积分到一个一般状态 $(a, \\rho(a))$：\n$$\n\\int_{\\rho_0}^{\\rho(a)} \\frac{d\\rho'}{\\rho'} = -3 \\int_{1}^{a} \\frac{1 + w(a')}{a'} da'\n$$\n左边的积分是：\n$$\n\\left[ \\ln(\\rho') \\right]_{\\rho_0}^{\\rho(a)} = \\ln(\\rho(a)) - \\ln(\\rho_0) = \\ln\\left(\\frac{\\rho(a)}{\\rho_0}\\right)\n$$\n对于右边的积分，我们代入 CPL 参数化 $w(a) = w_0 + w_a(1-a)$：\n$$\n-3 \\int_{1}^{a} \\frac{1 + [w_0 + w_a(1-a')]}{a'} da' = -3 \\int_{1}^{a} \\frac{1 + w_0 + w_a - w_a a'}{a'} da'\n$$\n我们可以将被积函数分成两部分：\n$$\n-3 \\int_{1}^{a} \\left( \\frac{1 + w_0 + w_a}{a'} - w_a \\right) da'\n$$\n进行积分得到：\n$$\n-3 \\left[ (1 + w_0 + w_a) \\ln(a') - w_a a' \\right]_{1}^{a}\n$$\n在积分限（$a'=a$ 和 $a'=1$）处计算该表达式：\n$$\n-3 \\left( \\left((1 + w_0 + w_a) \\ln(a) - w_a a\\right) - \\left((1 + w_0 + w_a) \\ln(1) - w_a(1)\\right) \\right)\n$$\n因为 $\\ln(1) = 0$，上式简化为：\n$$\n-3 \\left( (1 + w_0 + w_a) \\ln(a) - w_a a + w_a \\right) = -3 \\left( (1 + w_0 + w_a) \\ln(a) - w_a(a-1) \\right)\n$$\n现在，令左右两边的积分结果相等：\n$$\n\\ln\\left(\\frac{\\rho(a)}{\\rho_0}\\right) = -3 (1 + w_0 + w_a) \\ln(a) - 3(-w_a(a-1))\n$$\n$$\n\\ln\\left(\\frac{\\rho(a)}{\\rho_0}\\right) = -3(1 + w_0 + w_a) \\ln(a) + 3 w_a(a-1)\n$$\n为了解出 $\\rho(a)$，我们对两边取指数：\n$$\n\\frac{\\rho(a)}{\\rho_0} = \\exp\\left( -3(1 + w_0 + w_a) \\ln(a) + 3 w_a(a-1) \\right)\n$$\n利用对数和指数的性质，$\\exp(x+y) = \\exp(x)\\exp(y)$ 和 $\\exp(c \\ln(x)) = x^c$：\n$$\n\\frac{\\rho(a)}{\\rho_0} = \\exp(\\ln(a^{-3(1 + w_0 + w_a)})) \\cdot \\exp(3 w_a(a-1))\n$$\n$$\n\\frac{\\rho(a)}{\\rho_0} = a^{-3(1 + w_0 + w_a)} \\exp(3 w_a(a-1))\n$$\n最后，乘以 $\\rho_0$ 就得到了能量密度 $\\rho(a)$ 的表达式。为了使形式与 $w(a)$ 定义中的项 $(1-a)$ 对齐，我们可以将 $3w_a(a-1)$ 写为 $-3w_a(1-a)$：\n$$\n\\rho(a) = \\rho_0 a^{-3(1 + w_0 + w_a)} \\exp(-3w_a(1-a))\n$$\n这就是 CPL 参数化下能量密度作为标度因子 $a$ 的函数的闭式解析表达式。",
            "answer": "$$\\boxed{\\rho_0 a^{-3(1 + w_0 + w_a)} \\exp(-3w_a(1-a))}$$"
        },
        {
            "introduction": "与唯象的暗能量模型不同，某些物理组分（如大质量中微子）的状态方程并非简单的参数化函数，而是源于其底层的统计力学性质。此练习要求我们从第一性原理出发，通过对其费米-狄拉克相空间分布进行积分来计算中微子的能量密度和压强 。这项实践不仅介绍了从微观物理计算宏观宇宙学量的核心数值方法，而且通过与已知的超相对论和非相对论极限进行比较，强调了验证数值代码准确性的关键步骤。",
            "id": "3470587",
            "problem": "实现一个完整的程序，通过对平衡费米–狄拉克相空间分布进行数值积分，计算在空间平坦的 Friedmann–Robertson–Walker (FRW) 宇宙中单个有质量中微子物种的能量密度 $ \\rho(a) $ 和压强 $ p(a) $，并根据超相对论和非相对论极限情况验证数值结果。\n\n您必须从以下基本原理出发：\n- 根据定义，具有各向同性相空间分布 $ f $ 的退耦物种的物理能量密度和压强为：\n$$\n\\rho = g \\int \\frac{d^3 k}{(2\\pi)^3}\\, E(k)\\, f,\\qquad\np = g \\int \\frac{d^3 k}{(2\\pi)^3}\\, \\frac{k^2}{3 E(k)}\\, f,\n$$\n其中 $ g $ 是内禀自由度，$ k $ 是物理动量大小，$ E(k) = \\sqrt{k^2 + m^2} $，$ m $ 是粒子质量。\n- 对于化学势为零、处于动力学平衡状态的退耦中微子，其平衡费米–狄拉克分布用共动动量 $ q $ 表示为 $ f_0(q) = 1/(\\exp(q)+1) $，其中 $ q \\equiv a k / T_{\\nu 0} $，$ T_{\\nu 0} $ 是当今的中微子温度。当今中微子温度为 $ T_{\\nu 0} = \\left(\\frac{4}{11}\\right)^{1/3} T_{\\gamma 0} $，其中光子温度为 $ T_{\\gamma 0} $。您必须取 $ T_{\\gamma 0} = 2.7255\\,\\mathrm{K} $，并使用玻尔兹曼常数 $ k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K} $ 将温度表示为电子伏特。在自然单位制（$ c = \\hbar = k_{\\mathrm{B}} = 1 $）下工作，因此 $ \\rho $ 和 $ p $ 的单位为 $ \\mathrm{eV}^4 $。\n- 考虑单个 Majorana 中微子物种，包括粒子和反粒子，因此取 $ g = 2 $。\n\n基于这些定义，使用 $ f_0(q) $ 以及从物理动量到共动动量的变量替换，推导以标度因子 $ a $ 和质量 $ m $ 为函数的、适用于数值积分的表达式。实现一个数值积分方法，以高相对精度计算在各种 $ a $ 和 $ m $ 取值范围内的 $ \\rho(a) $ 和 $ p(a) $。\n\n定义状态方程参数 $ w(a) \\equiv p(a)/\\rho(a) $。通过与以下从相同基础推导出的解析已知极限进行比较，来验证您的代码：\n- 超相对论 (UR) 极限 $ a m / T_{\\nu 0} \\to 0 $：$ w \\to 1/3 $ 且 $ \\rho / T^4 \\to g \\times \\frac{7}{8}\\times \\frac{\\pi^2}{30} $，其中 $ T(a) \\equiv T_{\\nu 0}/a $。\n- 非相对论 (NR) 极限 $ a m / T_{\\nu 0} \\to \\infty $：$ w \\to 0 $，其主导行为为 $ w \\approx \\frac{1}{3} \\frac{\\int_0^\\infty dq\\, q^4 f_0(q)}{\\int_0^\\infty dq\\, q^2 f_0(q)} \\left(\\frac{T_{\\nu 0}}{a m}\\right)^2 $，且 $ \\rho(a) \\approx \\frac{g\\, m\\, T_{\\nu 0}^3}{2\\pi^2 a^3} \\int_0^\\infty dq\\, q^2 f_0(q) $。\n\n您的程序必须：\n- 使用数值积分从第一性原理计算 $ \\rho(a) $ 和 $ p(a) $。\n- 如下文所述，计算 $ w(a) $ 以及极限情况下的相应验证误差。\n- 将所有中间能量和温度以 $ \\mathrm{eV} $ 表示，$ \\rho $ 和 $ p $ 以 $ \\mathrm{eV}^4 $ 表示。最终报告的 $ w $ 和误差度量是无量纲的。\n\n实现并运行以下参数值的测试套件：\n- 测试 $ 1 $ (UR)：$ a = 10^{-8} $，$ m = 0.1\\,\\mathrm{eV} $。报告：\n  - $ w_1 $，\n  - $ w $ 与 $ 1/3 $ 的相对误差，即 $ \\left| w_1 - \\frac{1}{3} \\right| / \\left(\\frac{1}{3}\\right) $，\n  - $ \\rho / T^4 $ 与 $ g \\times \\frac{7}{8}\\times \\frac{\\pi^2}{30} $ 的相对误差。\n- 测试 $ 2 $ (NR)：$ a = 1 $，$ m = 0.1\\,\\mathrm{eV} $。报告：\n  - $ w_2 $，\n  - $ w $ 与非相对论主导阶渐近值 $ w_{\\mathrm{NR,LO}} = \\frac{1}{3} \\frac{\\int dq\\, q^4 f_0}{\\int dq\\, q^2 f_0}\\left(\\frac{T_{\\nu 0}}{a m}\\right)^2 $ 的相对误差，\n  - $ \\rho $ 与非相对论主导阶渐近值 $ \\rho_{\\mathrm{NR,LO}} = \\frac{g\\, m\\, T_{\\nu 0}^3}{2\\pi^2 a^3} \\int dq\\, q^2 f_0 $ 的相对误差。\n- 测试 $ 3 $ (无质量边界)：$ a = 1 $，$ m = 0\\,\\mathrm{eV} $。报告：\n  - $ w_3 $，\n  - $ w $ 与 $ 1/3 $ 的相对误差，\n  - $ \\rho / T^4 $ 与 $ g \\times \\frac{7}{8}\\times \\frac{\\pi^2}{30} $ 的相对误差。\n- 测试 $ 4 $ (中间情况)：$ a = T_{\\nu 0}/m $，其中 $ m = 0.1\\,\\mathrm{eV} $。报告：\n  - 仅 $ w_4 $。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$ [\\text{result}_1,\\text{result}_2,\\text{result}_3] $），结果严格按照以下顺序排列：\n$ [w_1,\\ \\mathrm{relErr}(w_1,\\tfrac{1}{3}),\\ \\mathrm{relErr}(\\rho_1/T^4, g\\times \\tfrac{7}{8}\\times \\tfrac{\\pi^2}{30}),\\ w_2,\\ \\mathrm{relErr}(w_2, w_{\\mathrm{NR,LO}}),\\ \\mathrm{relErr}(\\rho_2,\\rho_{\\mathrm{NR,LO}}),\\ w_3,\\ \\mathrm{relErr}(w_3,\\tfrac{1}{3}),\\ \\mathrm{relErr}(\\rho_3/T^4, g\\times \\tfrac{7}{8}\\times \\tfrac{\\pi^2}{30}),\\ w_4] $。\n\n所有角度（如果出现）必须以弧度为单位。所有分数在最终输出中必须表示为小数，而不是百分号。确保数值积分的容差足够严格，以便报告的所有相对误差都有意义（不被数值噪声主导）。",
            "solution": "目标是计算在 Friedmann–Robertson–Walker (FRW) 宇宙中单个有质量中微子物种的能量密度 $\\rho(a)$ 和压强 $p(a)$。我们将从所提供的第一性原理出发，推导适用于数值积分的表达式，然后实现一个程序来计算这些量，并根据已知的解析极限对其进行验证。\n\n首先，我们遵循自然单位制约定（$c=\\hbar=k_{\\mathrm{B}}=1$），以电子伏特（$\\mathrm{eV}$）为单位确定必要的物理常数。\n当今光子温度为 $T_{\\gamma 0} = 2.7255\\,\\mathrm{K}$。使用所提供的玻尔兹曼常数值 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$，我们将其转换为电子伏特：\n$$\nT_{\\gamma 0, \\mathrm{eV}} = k_{\\mathrm{B}} T_{\\gamma 0} = (8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}) \\times (2.7255\\,\\mathrm{K}) \\approx 2.34865 \\times 10^{-4}\\,\\mathrm{eV}\n$$\n当今中微子温度 $T_{\\nu 0}$ 与光子温度的关系为 $T_{\\nu 0} = (4/11)^{1/3} T_{\\gamma 0}$。以电子伏特表示，即：\n$$\nT_{\\nu 0} = \\left(\\frac{4}{11}\\right)^{1/3} T_{\\gamma 0, \\mathrm{eV}} \\approx 0.713766 \\times (2.34865 \\times 10^{-4}\\,\\mathrm{eV}) \\approx 1.94537 \\times 10^{-4}\\,\\mathrm{eV}\n$$\n单个 Majorana 中微子物种（包括其反粒子）的内禀自由度数为 $g=2$。\n\n对于具有各向同性相空间分布 $f$ 的物种，能量密度 $\\rho$ 和压强 $p$ 的基本定义是：\n$$\n\\rho = g \\int \\frac{d^3 k}{(2\\pi)^3}\\, E(k)\\, f, \\qquad\np = g \\int \\frac{d^3 k}{(2\\pi)^3}\\, \\frac{k^2}{3 E(k)}\\, f\n$$\n其中 $k$ 是物理动量大小，$E(k) = \\sqrt{k^2 + m^2}$ 是能量。对于各向同性分布，动量空间体积元为 $d^3 k = 4\\pi k^2 dk$。\n\n问题指出，中微子已退耦并遵循平衡费米–狄拉克分布 $f_0(q) = 1/(\\exp(q)+1)$，其中 $q$ 是无量纲的共动动量，定义为 $q = ak/T_{\\nu 0}$。这里，$a$ 是宇宙学标度因子。为了计算这些积分，我们必须从物理动量 $k$ 进行变量替换到共动动量 $q$：\n$$\nk = q \\frac{T_{\\nu 0}}{a} \\implies dk = \\frac{T_{\\nu 0}}{a} dq\n$$\n动量空间体积元变为：\n$$\nd^3 k = 4\\pi k^2 dk = 4\\pi \\left(q \\frac{T_{\\nu 0}}{a}\\right)^2 \\left(\\frac{T_{\\nu 0}}{a} dq\\right) = 4\\pi \\left(\\frac{T_{\\nu 0}}{a}\\right)^3 q^2 dq\n$$\n能量 $E(k)$ 也可以用 $q$、$a$ 和 $m$ 表示：\n$$\nE(k) = \\sqrt{k^2 + m^2} = \\sqrt{\\left(q \\frac{T_{\\nu 0}}{a}\\right)^2 + m^2} = \\frac{T_{\\nu 0}}{a} \\sqrt{q^2 + \\left(\\frac{am}{T_{\\nu 0}}\\right)^2}\n$$\n让我们定义无量纲参数 $x \\equiv am/T_{\\nu 0}$，它表征了从超相对论（$x \\ll 1$）到非相对论（$x \\gg 1$）状态的转变。能量则为 $E(q) = (T_{\\nu 0}/a)\\sqrt{q^2 + x^2}$。\n\n将这些表达式代入 $\\rho$ 和 $p$ 的积分中：\n$$\n\\rho(a, m) = g \\int_0^\\infty \\frac{4\\pi q^2 dq}{(2\\pi)^3} \\left(\\frac{T_{\\nu 0}}{a}\\right)^3 \\left(\\frac{T_{\\nu 0}}{a} \\sqrt{q^2 + x^2}\\right) \\frac{1}{e^q+1}\n$$\n$$\np(a, m) = g \\int_0^\\infty \\frac{4\\pi q^2 dq}{(2\\pi)^3} \\left(\\frac{T_{\\nu 0}}{a}\\right)^3 \\frac{(q T_{\\nu 0}/a)^2}{3 (T_{\\nu 0}/a) \\sqrt{q^2 + x^2}} \\frac{1}{e^q+1}\n$$\n简化前置因子，得到适用于数值积分的最终表达式：\n$$\n\\rho(a, m) = \\frac{g}{2\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty dq\\, q^2 \\sqrt{q^2 + x^2} \\frac{1}{e^q+1}\n$$\n$$\np(a, m) = \\frac{g}{6\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty dq\\, \\frac{q^4}{\\sqrt{q^2 + x^2}} \\frac{1}{e^q+1}\n$$\n这些方程构成了我们数值计算的基础。状态方程参数为 $w(a, m) = p(a, m)/\\rho(a, m)$。\n\n为了验证，我们考虑解析极限。\n在超相对论 (UR) 极限下，$x = am/T_{\\nu 0} \\to 0$。表达式简化为：\n$$\n\\rho_{\\mathrm{UR}}(a) = \\frac{g}{2\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty \\frac{q^3}{e^q+1} dq\n$$\n$$\np_{\\mathrm{UR}}(a) = \\frac{g}{6\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty \\frac{q^3}{e^q+1} dq = \\frac{1}{3}\\rho_{\\mathrm{UR}}(a)\n$$\n这立即得出 $w_{\\mathrm{UR}} = 1/3$。该积分为一个标准的费米–狄拉克积分：$\\int_0^\\infty \\frac{q^3}{e^q+1}dq = \\frac{7\\pi^4}{120}$。将标度因子为 $a$ 时的中微子温度定义为 $T(a) = T_{\\nu 0}/a$，我们得到：\n$$\n\\rho_{\\mathrm{UR}}(a) = \\frac{g T(a)^4}{2\\pi^2} \\frac{7\\pi^4}{120} = g T(a)^4 \\frac{7\\pi^2}{240} = g T(a)^4 \\left(\\frac{7}{8}\\frac{\\pi^2}{30}\\right)\n$$\n这与所提供的验证公式相符。\n\n在非相对论 (NR) 极限下，$x = am/T_{\\nu 0} \\to \\infty$。我们对能量项使用泰勒展开：$\\sqrt{q^2+x^2} = x\\sqrt{1+q^2/x^2} \\approx x(1 + q^2/(2x^2))$。\n$\\rho$ 的主导阶项为：\n$$\n\\rho(a, m) \\approx \\frac{g}{2\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty dq\\, q^2 (x) \\frac{1}{e^q+1} = \\frac{g m T_{\\nu 0}^3}{2\\pi^2 a^3} \\int_0^\\infty \\frac{q^2}{e^q+1} dq\n$$\n此表达式记为 $\\rho_{\\mathrm{NR,LO}}$，与问题的定义相符。\n对于压强，$1/\\sqrt{q^2+x^2} \\approx 1/x$。\n$$\np(a, m) \\approx \\frac{g}{6\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty dq\\, \\frac{q^4}{x} \\frac{1}{e^q+1} = \\frac{g T_{\\nu 0}^5}{6\\pi^2 a^5 m} \\int_0^\\infty \\frac{q^4}{e^q+1} dq\n$$\n状态方程参数 $w=p/\\rho$ 则由这些表达式的比值近似得出：\n$$\nw_{\\mathrm{NR,LO}} = \\frac{\\frac{g T_{\\nu 0}^5}{6\\pi^2 a^5 m} \\int \\frac{q^4}{e^q+1} dq}{\\frac{g m T_{\\nu 0}^3}{2\\pi^2 a^3} \\int \\frac{q^2}{e^q+1} dq} = \\frac{1}{3} \\left(\\frac{T_{\\nu 0}}{am}\\right)^2 \\frac{\\int_0^\\infty \\frac{q^4}{e^q+1}dq}{\\int_0^\\infty \\frac{q^2}{e^q+1}dq}\n$$\n这也与所提供的 $w_{\\mathrm{NR,LO}}$ 公式相符。涉及 $q^2$ 和 $q^4$ 的定积分将通过数值方法以高精度计算。\n\n程序的算法如下：\n1. 定义所有物理和数学常数。\n2. 实现 $\\rho$ 和 $p$ 的被积函数。\n3. 对于每个测试用例 $(a, m)$：\n   a. 计算参数 $x = am/T_{\\nu 0}$。\n   b. 使用数值积分程序（`scipy.integrate.quad`）计算 $\\rho$ 和 $p$ 的积分。\n   c. 组合出 $\\rho(a,m)$ 和 $p(a,m)$ 的完整值。\n   d. 计算状态方程参数 $w = p/\\rho$。\n   e. 对于验证用例，计算解析近似值及相应的相对误差。\n4. 收集并按指定格式打印结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes neutrino energy density, pressure, and equation of state,\n    and validates against analytical limits.\n    \"\"\"\n    # Physical constants\n    K_B = 8.617333262145e-5  # eV/K\n    T_GAMMA0_K = 2.7255  # K\n    G_NU = 2.0  # Degrees of freedom for one Majorana neutrino species\n\n    # Derived constants in eV\n    T_GAMMA0_EV = K_B * T_GAMMA0_K\n    T_NU0_EV = (4.0 / 11.0)**(1.0 / 3.0) * T_GAMMA0_EV\n\n    # Test cases from the problem statement\n    # Format: (a, m_eV, test_type)\n    test_cases_params = [\n        (1e-8, 0.1, 'UR'),\n        (1.0, 0.1, 'NR'),\n        (1.0, 0.0, 'Massless'),\n        (T_NU0_EV / 0.1, 0.1, 'Intermediate'),\n    ]\n\n    results = []\n\n    # Pre-calculate integrals for analytical limits with high precision\n    # Use lambda functions for the Fermi-Dirac distribution integrands\n    f0 = lambda q: 1.0 / (np.exp(q) + 1.0)\n    try:\n        integral_q2f0, _ = quad(lambda q: q**2 * f0(q), 0, np.inf)\n        integral_q3f0, _ = quad(lambda q: q**3 * f0(q), 0, np.inf)\n        integral_q4f0, _ = quad(lambda q: q**4 * f0(q), 0, np.inf)\n    except Exception as e:\n        print(f\"Error during pre-calculation of integrals: {e}\")\n        return\n\n    # UR limit constant for rho/T^4\n    # rho_ur / T^4 = g * (7/8) * (pi^2/30)\n    rho_over_T4_ur_analytic = G_NU * (7.0 / 8.0) * (np.pi**2 / 30.0)\n    \n    # Loop through test cases\n    for i, (a, m_ev, test_type) in enumerate(test_cases_params):\n        x = a * m_ev / T_NU0_EV\n        \n        # Integrands for rho and p. Handle m=0 case separately for numerical stability.\n        if m_ev == 0.0:\n            rho_integrand = lambda q: q**3 * f0(q)\n            p_integrand = lambda q: q**3 * f0(q) / 3.0\n            prefactor = G_NU / (2.0 * np.pi**2) * (T_NU0_EV / a)**4\n        else:\n            sqrt_term = lambda q: np.sqrt(q**2 + x**2)\n            rho_integrand = lambda q: q**2 * sqrt_term(q) * f0(q)\n            p_integrand = lambda q: q**4 / (3.0 * sqrt_term(q)) * f0(q)\n            prefactor = G_NU / (2.0 * np.pi**2) * (T_NU0_EV / a)**4\n\n        # Perform numerical quadrature\n        try:\n            rel_tol = 1e-13\n            abs_tol = 0\n            integral_rho, _ = quad(rho_integrand, 0, np.inf, epsabs=abs_tol, epsrel=rel_tol)\n            integral_p, _ = quad(p_integrand, 0, np.inf, epsabs=abs_tol, epsrel=rel_tol)\n        except Exception as e:\n            print(f\"Error during quadrature for test case {i+1}: {e}\")\n            continue\n\n        # Calculate rho, p, and w\n        rho = prefactor * integral_rho\n        p = prefactor * integral_p\n        w = p / rho if rho != 0 else 0\n\n        if test_type == 'UR':\n            # Report w, relErr(w, 1/3), relErr(rho/T^4, ...)\n            w_val = w\n            \n            w_analytic = 1.0/3.0\n            rel_err_w = np.abs(w_val - w_analytic) / w_analytic\n            \n            T_nu_a = T_NU0_EV / a\n            rho_over_T4_numeric = rho / T_nu_a**4\n            rel_err_rho = np.abs(rho_over_T4_numeric - rho_over_T4_ur_analytic) / rho_over_T4_ur_analytic\n            \n            results.extend([w_val, rel_err_w, rel_err_rho])\n\n        elif test_type == 'NR':\n            # Report w, relErr(w, w_nr_lo), relErr(rho, rho_nr_lo)\n            w_val = w\n            \n            # NR leading order approximations\n            w_nr_lo = (1.0 / 3.0) * (integral_q4f0 / integral_q2f0) * (T_NU0_EV / (a * m_ev))**2\n            rho_nr_lo = (G_NU * m_ev * T_NU0_EV**3) / (2.0 * np.pi**2 * a**3) * integral_q2f0\n\n            rel_err_w = np.abs(w_val - w_nr_lo) / w_nr_lo\n            rel_err_rho = np.abs(rho - rho_nr_lo) / rho_nr_lo\n            \n            results.extend([w_val, rel_err_w, rel_err_rho])\n\n        elif test_type == 'Massless':\n            # Report w, relErr(w, 1/3), relErr(rho/T^4, ...)\n            w_val = w\n            \n            w_analytic = 1.0/3.0\n            # For m=0, w should be exactly 1/3, error is due to numerical precision.\n            rel_err_w = np.abs(w_val - w_analytic) / w_analytic\n            \n            # This is also an exact UR case.\n            T_nu_a = T_NU0_EV / a\n            rho_over_T4_numeric = rho / T_nu_a**4\n            rel_err_rho = np.abs(rho_over_T4_numeric - rho_over_T4_ur_analytic) / rho_over_T4_ur_analytic\n            \n            results.extend([w_val, rel_err_w, rel_err_rho])\n\n        elif test_type == 'Intermediate':\n            # Report w only\n            w_val = w\n            results.append(w_val)\n    \n    # Print final results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "在掌握了如何描述单个组分的演化之后，下一步是将所有组分结合起来，模拟整个宇宙的膨胀历史以及其中物质结构的增长。本练习将弗里德曼方程和物质扰动的线性增长方程结合起来，展示了特定的暗能量模型（如CPL模型）如何同时影响宇宙的膨胀速率 $H(z)$ 和结构增长因子 $D(a)$ 。这是一个综合性实践，它模拟了数值宇宙学家的核心任务之一：为一个给定的宇宙学模型构建一个小型“求解器”，预测可观测的量，并将其与基准的 $\\Lambda$CDM 模型进行比较。",
            "id": "3470597",
            "problem": "您的任务是设计并实现一个数值程序，用于在一个空间平坦的宇宙中演化背景宇宙学以及物质密度扰动的线性增长。该宇宙包含一个由 Chevallier–Polarski–Linder (CPL) 状态方程描述的暗能量成分。该模型通过 $w(a)=w_0+w_a(1-a)$ 指定了一个随时间变化的状态方程参数 $w(a)$。您的任务必须从基本关系出发，并逐步进行推导，除这些基本依据外不得使用任何捷径公式。\n\n您必须使用的基本依据：\n- 空间平坦宇宙的弗里德曼方程：$H^2(a)=\\dfrac{8\\pi G}{3}\\left(\\rho_r(a)+\\rho_m(a)+\\rho_{\\mathrm{de}}(a)\\right)$，其中当前的密度参数为 $H_0$、$\\Omega_{r0}$、$\\Omega_{m0}$ 和 $\\Omega_{\\mathrm{de}0}=1-\\Omega_{m0}-\\Omega_{r0}$。\n- 暗能量的守恒方程：$\\dfrac{d\\rho_{\\mathrm{de}}}{da}=-3\\dfrac{1+w(a)}{a}\\rho_{\\mathrm{de}}(a)$。\n- 宇宙时 $t$ 中亚视界冷暗物质扰动的线性增长方程：$\\ddot{D}+2H\\dot{D}-4\\pi G\\rho_m D=0$，其中 $D(a)$ 是增长模线性增长因子。\n\n基于这些依据：\n1. 通过积分守恒方程，推导 CPL 形式 $w(a)=w_0+w_a(1-a)$ 下的 $\\rho_{\\mathrm{de}}(a)/\\rho_{\\mathrm{de}0}$。\n2. 使用弗里德曼方程，并结合 $\\rho_r(a)=\\rho_{r0}a^{-4}$、$\\rho_m(a)=\\rho_{m0}a^{-3}$ 以及您对 $\\rho_{\\mathrm{de}}(a)$ 的结果，来表达 $H(a)$。定义无量纲膨胀率 $E(a)=H(a)/H_0$。\n3. 使用变量替换 $x=\\ln a$，将线性增长方程改写为关于 $x$ 的常微分方程，并提供适用于物质主导时期的初始条件。请明确陈述这些初始条件，并根据增长模的渐近行为给出理由。\n4. 实现一个数值积分器，对于给定的参数 $(w_0,w_a)$，计算：\n   - 哈勃参数 $H(z)$，在指定的红移 $z$ 处，使用您推导的 $H(a)$ 进行计算，其中 $a=1/(1+z)$。哈勃参数的单位应为 $\\mathrm{km\\ s^{-1}\\ Mpc^{-1}}$，但您的程序只需报告如下指定的无量纲比率。\n   - 线性增长因子 $D(a)$，通过求解以 $x=\\ln a$ 表示的增长方程，从物质主导时代的初始尺度因子 $a_{\\mathrm{ini}}$ 积分到 $a=1$；以及在 $a=1$ 处计算的对数增长率 $f(a)=\\dfrac{d\\ln D}{d\\ln a}$。\n\n与基准模型的比较：\n- 采用一个基准模型，对应于宇宙学常数情况，其中 $w_0=-1$ 和 $w_a=0$（即基准 $\\Lambda$ 冷暗物质模型）。对于每个测试案例，计算在目标红移处哈勃膨胀率相对于此基准模型的分数差异，以及当前的对数增长率 $f(a=1)$ 相对于基准模型的差异。\n\n要使用的宇宙学参数（在您的计算中精确使用这些值）：\n- $H_0=67.66\\ \\mathrm{km\\ s^{-1}\\ Mpc^{-1}}$，\n- $\\Omega_{m0}=0.315$，\n- $\\Omega_{r0}=9.2\\times 10^{-5}$，\n- 空间平坦性 $\\Omega_{k0}=0$，因此 $\\Omega_{\\mathrm{de}0}=1-\\Omega_{m0}-\\Omega_{r0}$。\n\n数值规格和初始条件：\n- 使用变量 $x=\\ln a$ 来积分增长方程。选择物质主导时代的一个初始尺度因子，具体为 $a_{\\mathrm{ini}}=10^{-3}$，设置 $D(a_{\\mathrm{ini}})=a_{\\mathrm{ini}}$ 和 $\\dfrac{dD}{dx}(a_{\\mathrm{ini}})=D(a_{\\mathrm{ini}})$，这与物质主导时期增长模解 $D\\propto a$ 一致。\n- 使用红移集合 $\\{z=1,\\ z=2\\}$ 作为 $H(z)$ 的比较点。\n\n测试套件：\n- 要评估的三个 $(w_0,w_a)$ 对：\n  1. $w_0=-1$，$w_a=0$（基准），\n  2. $w_0=-0.9$，$w_a=0.2$（温和演化的状态方程），\n  3. $w_0=-1.1$，$w_a=0.3$（当前为魅影（phantom）且正向演化）。\n- 对于每对参数，计算一个包含三个输出的列表：\n  - $\\left[\\dfrac{H_{\\mathrm{model}}(z=1)-H_{\\Lambda\\mathrm{CDM}}(z=1)}{H_{\\Lambda\\mathrm{CDM}}(z=1)},\\ \\dfrac{H_{\\mathrm{model}}(z=2)-H_{\\Lambda\\mathrm{CDM}}(z=2)}{H_{\\Lambda\\mathrm{CDM}}(z=2)},\\ f_{\\mathrm{model}}(a=1)-f_{\\Lambda\\mathrm{CDM}}(a=1)\\right]$。\n- 列表中的三个数字均需报告为四舍五入到六位小数的十进制数。这些输出是无量纲的。输出中不应包含任何单位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的列表，该列表由三个子列表组成，并用一对单独的方括号括起来，不含空格。例如：“[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33]]”，其中每个 $x_{ij}$ 是一个如上所述具有六位小数的十进制数。\n\n不涉及角度单位。不要报告百分比；所有输出均为如上所述的纯十进制数。",
            "solution": "该问题是有效的，因为它在科学上基于标准宇宙学模型，是适定的（提供了足够的信息以获得唯一解），并且陈述客观。它代表了物理宇宙学中的一个标准数值任务。以下步骤详细说明了推导和实现计划。\n\n### 第1步：暗能量密度演化的推导\n暗能量密度 $\\rho_{\\mathrm{de}}$ 的演化由守恒方程决定：\n$$\n\\frac{d\\rho_{\\mathrm{de}}}{da} = -3\\frac{1+w(a)}{a}\\rho_{\\mathrm{de}}(a)\n$$\n这是一个一阶线性常微分方程（ODE），可以通过分离变量法求解。我们从今天（$a=1$，此时 $\\rho_{\\mathrm{de}} = \\rho_{\\mathrm{de}0}$）积分到一个任意的尺度因子 $a$：\n$$\n\\int_{\\rho_{\\mathrm{de}0}}^{\\rho_{\\mathrm{de}}(a)} \\frac{d\\rho'_{\\mathrm{de}}}{\\rho'_{\\mathrm{de}}} = -3 \\int_1^a \\frac{1+w(a')}{a'} da'\n$$\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3 \\int_1^a \\frac{1+w(a')}{a'} da'\n$$\n代入 Chevallier–Polarski–Linder (CPL) 参数化 $w(a) = w_0 + w_a(1-a)$：\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3 \\int_1^a \\frac{1+w_0+w_a(1-a')}{a'} da' = -3 \\int_1^a \\left(\\frac{1+w_0+w_a}{a'} - w_a\\right) da'\n$$\n执行积分：\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3 \\left[ (1+w_0+w_a)\\ln(a') - w_a a' \\right]_1^a\n$$\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3 \\left\\{ \\left((1+w_0+w_a)\\ln(a) - w_a a\\right) - \\left((1+w_0+w_a)\\ln(1) - w_a(1)\\right) \\right\\}\n$$\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3(1+w_0+w_a)\\ln(a) + 3w_a(a-1)\n$$\n对两边取指数，得到所需的暗能量密度比表达式：\n$$\n\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}} = e^{-3(1+w_0+w_a)\\ln(a) + 3w_a(a-1)} = a^{-3(1+w_0+w_a)} e^{3w_a(a-1)}\n$$\n\n### 第2步：哈勃参数 $H(a)$ 的推导\n空间平坦宇宙的弗里德曼方程为：\n$$\nH^2(a) = \\frac{8\\pi G}{3} \\left(\\rho_r(a) + \\rho_m(a) + \\rho_{\\mathrm{de}}(a)\\right)\n$$\n在今天（$a=1$），它变为 $H_0^2 = \\frac{8\\pi G}{3} \\rho_{c,0}$，其中 $\\rho_{c,0}$ 是今天的临界密度。密度参数定义为 $\\Omega_{i0} = \\rho_{i0} / \\rho_{c,0}$。我们可以将各组分密度的演化表示为相对于今天临界密度的关系：\n- 辐射：$\\rho_r(a) = \\rho_{r0} a^{-4} = \\Omega_{r0} \\rho_{c,0} a^{-4}$\n- 物质：$\\rho_m(a) = \\rho_{m0} a^{-3} = \\Omega_{m0} \\rho_{c,0} a^{-3}$\n- 暗能量：$\\rho_{\\mathrm{de}}(a) = \\rho_{\\mathrm{de}0} \\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = \\Omega_{\\mathrm{de}0} \\rho_{c,0} a^{-3(1+w_0+w_a)} e^{3w_a(a-1)}$\n\n将这些代入弗里德曼方程：\n$$\nH^2(a) = \\frac{8\\pi G}{3} \\rho_{c,0} \\left( \\Omega_{r0} a^{-4} + \\Omega_{m0} a^{-3} + \\Omega_{\\mathrm{de}0} a^{-3(1+w_0+w_a)} e^{3w_a(a-1)} \\right)\n$$\n除以 $H_0^2$ 得到无量纲膨胀率 $E(a) = H(a)/H_0$ 的平方：\n$$\nE^2(a) = \\Omega_{r0} a^{-4} + \\Omega_{m0} a^{-3} + \\Omega_{\\mathrm{de}0} a^{-3(1+w_0+w_a)} e^{3w_a(a-1)}\n$$\n其中 $\\Omega_{\\mathrm{de}0} = 1 - \\Omega_{m0} - \\Omega_{r0}$，由于空间平坦的假设（$\\Omega_{k0}=0$）。\n\n### 第3步：改写线性增长方程\n物质扰动 $D$ 的线性增长方程在宇宙时 $t$ 中给出：\n$$\n\\ddot{D} + 2H\\dot{D} - 4\\pi G\\rho_m D = 0\n$$\n其中点表示对 $t$ 的导数。我们将自变量更改为 $x = \\ln a$。时间导数的链式法则是 $\\frac{d}{dt} = \\frac{dx}{dt}\\frac{d}{dx} = \\frac{\\dot{a}}{a}\\frac{d}{dx} = H\\frac{d}{dx}$。\n令 $D' = dD/dx$ 和 $D'' = d^2D/dx^2$：\n- $\\dot{D} = H D'$\n- $\\ddot{D} = \\frac{d}{dt}(HD') = \\dot{H}D' + H\\dot{D'} = (H\\frac{dH}{dx})D' + H(HD'') = H\\frac{dH}{dx}D' + H^2D''$\n\n将这些代入增长方程：\n$$\n\\left(H\\frac{dH}{dx}D' + H^2D''\\right) + 2H(HD') - 4\\pi G\\rho_m D = 0\n$$\n除以 $H^2$：\n$$\nD'' + \\left(\\frac{1}{H}\\frac{dH}{dx} + 2\\right)D' - \\frac{4\\pi G\\rho_m}{H^2} D = 0\n$$\n我们简化系数。$D'$ 的系数是：\n$$\n\\frac{1}{H}\\frac{dH}{dx} + 2 = \\frac{d\\ln H}{dx} + 2 = \\frac{1}{2}\\frac{d\\ln(H^2)}{dx} + 2 = \\frac{1}{2}\\frac{d\\ln(E^2)}{dx} + 2\n$$\n$D$ 的系数是：\n$$\n-\\frac{4\\pi G\\rho_m}{H^2} = -\\frac{4\\pi G\\rho_m}{\\frac{8\\pi G}{3}(\\rho_r+\\rho_m+\\rho_{de})} = -\\frac{3}{2} \\frac{\\rho_m(a)}{\\rho_{tot}(a)} = -\\frac{3}{2}\\Omega_m(a)\n$$\n其中 $\\Omega_m(a) = \\frac{\\Omega_{m0}a^{-3}}{E^2(a)}$。最终关于 $x = \\ln a$ 的常微分方程是：\n$$\nD''(x) + \\left(2 + \\frac{1}{2E^2(x)}\\frac{dE^2(x)}{dx}\\right) D'(x) - \\frac{3}{2}\\frac{\\Omega_{m0}e^{-3x}}{E^2(x)} D(x) = 0\n$$\n\n**初始条件：** 在早期的物质主导时代（$a \\ll 1$），增长方程的增长模解为 $D(a) \\propto a$。我们选择一个归一化使得 $D(a) = a$。初始条件设置在 $a_{\\mathrm{ini}}=10^{-3}$，对应于 $x_{\\mathrm{ini}} = \\ln(10^{-3})$。\n1. $D(x_{\\mathrm{ini}}) = a_{\\mathrm{ini}} = 10^{-3}$。\n2. 导数是 $D'(x) = \\frac{dD}{d\\ln a} = a\\frac{dD}{da} = a\\frac{d(a)}{da} = a$。因此，$D'(x_{\\mathrm{ini}}) = a_{\\mathrm{ini}} = 10^{-3}$。\n这些初始条件，$D(a_{\\mathrm{ini}}) = a_{\\mathrm{ini}}$ 和 $D'(a_{\\mathrm{ini}}) = a_{\\mathrm{ini}}$，适用于物质主导时代深处的增长模解。\n\n### 第4步：数值实现计划\n该解法需要为上述推导的二阶常微分方程实现一个数值积分器。我们将它转换为一个由两个一阶常微分方程组成的系统。令 $Y(x) = [D(x), D'(x)]^T$。该系统为：\n$$\n\\frac{dY}{dx} = \\begin{pmatrix} D'(x) \\\\ D''(x) \\end{pmatrix} = \\begin{pmatrix} Y_2(x) \\\\ -\\left(2 + \\frac{1}{2E^2}\\frac{dE^2}{dx}\\right) Y_2(x) + \\frac{3}{2}\\frac{\\Omega_{m0}e^{-3x}}{E^2} Y_1(x) \\end{pmatrix}\n$$\n$\\frac{dE^2}{dx}$ 项是解析计算的：\n$$\n\\frac{dE^2}{dx} = a\\frac{dE^2}{da} = a\\frac{d}{da}\\left( \\Omega_{r0} a^{-4} + \\Omega_{m0} a^{-3} + \\Omega_{\\mathrm{de}0} f_{\\mathrm{de}}(a) \\right)\n$$\n$$\n\\frac{dE^2}{dx} = -4\\Omega_{r0}a^{-4} - 3\\Omega_{m0}a^{-3} + \\Omega_{\\mathrm{de}0} a \\frac{df_{\\mathrm{de}}}{da}\n$$\n根据守恒方程，$a \\frac{df_{\\mathrm{de}}}{da} = -3(1+w(a))f_{\\mathrm{de}}(a)$。因此：\n$$\n\\frac{dE^2}{dx} = -4\\Omega_{r0}a^{-4} - 3\\Omega_{m0}a^{-3} - 3(1+w(a))\\Omega_{\\mathrm{de}0}f_{\\mathrm{de}}(a)\n$$\n该系统将使用 `scipy.integrate.solve_ivp` 从 $x_{\\mathrm{ini}} = \\ln(10^{-3})$ 积分到 $x_{\\mathrm{f}} = \\ln(1) = 0$。在最后一步，我们计算对数增长率 $f(a=1) = \\frac{d\\ln D}{d\\ln a}\\bigg|_{a=1} = \\frac{D'(x=0)}{D(x=0)}$。\n对于三个测试案例 $(w_0, w_a)$ 中的每一个，我们将：\n1.  在 $z=1$ 和 $z=2$ 处使用 $H(z) = H_0 E(a=1/(1+z))$ 计算 $H(z)$。注意，对于分数差异， $H_0$ 项会抵消，所以我们只需要 $E(z)$。\n2.  求解增长常微分方程以找到 $f(a=1)$。\n3.  然后将结果与基准 $\\Lambda$CDM 模型 $(w_0=-1, w_a=0)$ 进行比较，以计算指定的分数差异和绝对差异。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for cosmological observables for different dark energy models.\n    \"\"\"\n    \n    # Cosmological parameters\n    OMEGA_M0 = 0.315\n    OMEGA_R0 = 9.2e-5\n    OMEGA_DE0 = 1.0 - OMEGA_M0 - OMEGA_R0\n    \n    # Numerical specifications\n    A_INI = 1e-3\n    REDSHIFTS = np.array([1.0, 2.0])\n    \n    # Test suite: (w0, wa) pairs\n    test_cases = [\n        (-1.0, 0.0),      # Case 1: Baseline LambdaCDM\n        (-0.9, 0.2),      # Case 2: Mildly evolving\n        (-1.1, 0.3),      # Case 3: Phantom\n    ]\n\n    def E_squared(a, w0, wa):\n        \"\"\"\n        Computes the squared dimensionless Hubble parameter E^2(a).\n        \"\"\"\n        de_term = OMEGA_DE0 * (a ** (-3.0 * (1.0 + w0 + wa))) * np.exp(3.0 * wa * (a - 1.0))\n        return OMEGA_R0 * a**-4.0 + OMEGA_M0 * a**-3.0 + de_term\n\n    def get_observables(w0, wa):\n        \"\"\"\n        Calculates H(z) ratios and f(a=1) for a given CPL model.\n        \"\"\"\n        # Calculate E(z) = H(z)/H0\n        a_vals_z = 1.0 / (1.0 + REDSHIFTS)\n        E_vals = np.sqrt([E_squared(a, w0, wa) for a in a_vals_z])\n\n        # Define the ODE system for the growth factor D(x), where x = ln(a)\n        # Y = [D, D']\n        def growth_ode(x, y, w0_param, wa_param):\n            a = np.exp(x)\n            D_val, D_prime = y\n            \n            # Equation of state at scale factor a\n            w_a = w0_param + wa_param * (1.0 - a)\n            \n            # Dark energy density contribution to E^2\n            de_term_in_e2 = OMEGA_DE0 * (a ** (-3.0 * (1.0 + w0_param + wa_param))) * np.exp(3.0 * wa_param * (a - 1.0))\n            \n            # E^2(a)\n            e2_val = OMEGA_R0 * a**-4.0 + OMEGA_M0 * a**-3.0 + de_term_in_e2\n            \n            # Derivative of E^2 with respect to x=ln(a)\n            # d(E^2)/dx = a * d(E^2)/da\n            de2_dx = -4.0 * OMEGA_R0 * a**-4.0 \\\n                     -3.0 * OMEGA_M0 * a**-3.0 \\\n                     -3.0 * (1.0 + w_a) * de_term_in_e2\n\n            # The second-order ODE for D(x)\n            # D'' + (2 + 1/(2*E^2) * d(E^2)/dx) * D' - (3/2 * Omega_m(a)) * D = 0\n            # Omega_m(a) = Omega_m0 * a^-3 / E^2\n            D_double_prime = - (2.0 + 0.5 * de2_dx / e2_val) * D_prime \\\n                             + 1.5 * (OMEGA_M0 * a**-3.0) / e2_val * D_val\n                             \n            return [D_prime, D_double_prime]\n\n        # Initial conditions at a_ini in the matter-dominated era\n        x_ini = np.log(A_INI)\n        D_ini = A_INI\n        D_prime_ini = A_INI\n        y0 = [D_ini, D_prime_ini]\n\n        # Integration range from x_ini to x_final = ln(1) = 0\n        x_span = [x_ini, 0.0]\n        \n        # We only need the solution at the final point a=1 (x=0)\n        sol = solve_ivp(growth_ode, x_span, y0, args=(w0, wa), t_eval=[0.0], method='RK45', rtol=1e-8, atol=1e-8)\n        \n        # Final state Y(x=0) = [D(a=1), D'(a=1)]\n        D_final, D_prime_final = sol.y[:, -1]\n        \n        # Logarithmic growth rate f(a) = d(ln D) / d(ln a) = D' / D\n        f_a1 = D_prime_final / D_final\n        \n        return E_vals[0], E_vals[1], f_a1\n\n    # Calculate baseline LCDM results\n    E_lcdm_z1, E_lcdm_z2, f_lcdm_a1 = get_observables(w0=-1.0, wa=0.0)\n\n    # Store results for all test cases\n    final_results = []\n    \n    for w0_model, wa_model in test_cases:\n        E_model_z1, E_model_z2, f_model_a1 = get_observables(w0_model, wa_model)\n        \n        # Fractional difference in H(z) (which is same as fractional diff in E(z))\n        h_frac_z1 = (E_model_z1 - E_lcdm_z1) / E_lcdm_z1\n        h_frac_z2 = (E_model_z2 - E_lcdm_z2) / E_lcdm_z2\n        \n        # Absolute difference in f(a=1)\n        f_diff_a1 = f_model_a1 - f_lcdm_a1\n        \n        case_results = [\n            f\"{h_frac_z1:.6f}\",\n            f\"{h_frac_z2:.6f}\",\n            f\"{f_diff_a1:.6f}\"\n        ]\n        final_results.append(f\"[{','.join(case_results)}]\")\n\n    # Print the final output in the specified format\n    print(f\"[[{final_results[0]}],[{final_results[1]}],[{final_results[2]}]]\")\n\nsolve()\n```"
        }
    ]
}