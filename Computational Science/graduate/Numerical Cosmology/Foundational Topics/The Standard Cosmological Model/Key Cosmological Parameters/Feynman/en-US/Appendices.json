{
    "hands_on_practices": [
        {
            "introduction": "Navigating the various units and conventions in cosmology is a fundamental skill. This first exercise focuses on the Hubble constant $H_0$ and its dimensionless counterpart, $h$, which parameterizes our uncertainty in its value. By converting $H_0$ into its natural SI units and exploring how $h$ is used to rescale distances and wavenumbers, you will gain a practical understanding of how cosmologists manage and present results in a scalable way .",
            "id": "3476726",
            "problem": "Consider a homogeneous and isotropic universe described by the Friedmann–Lemaître–Robertson–Walker (FLRW) metric, where the Hubble parameter is defined by $H(t) \\equiv \\dot{a}(t)/a(t)$ with $a(t)$ the cosmological scale factor. Astronomers commonly quote the present-day Hubble parameter $H_0$ in mixed units $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ even though, by dimensional analysis of $H(t)$, its natural dimension is inverse time. The reduced Hubble parameter $h$ is conventionally defined so that the comoving smoothing radius in the definition of the root-mean-square (RMS) fluctuation amplitude $\\sigma_8$ is $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$, and wavenumbers in the linear matter power spectrum are often reported in $\\mathrm{h\\,Mpc^{-1}}$.\n\nGiven $H_0 = 67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, and the exact geometric conversion $1\\,\\mathrm{Mpc} = 3.085677581\\times 10^{22}\\,\\mathrm{m}$, carry out the following:\n\n1. Using the definition $H(t) = \\dot{a}/a$ and dimensional reasoning, justify why $H_0$ has units of inverse time and convert $H_0$ to the International System of Units (SI) as a numerical value in $\\mathrm{s^{-1}}$.\n2. Define the reduced Hubble parameter $h$ in terms of $H_0$ and compute its numerical value.\n3. Explain how the adoption of $h$ rescales comoving distances and wavenumbers, specifically clarifying the meanings of $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$ and of reporting $k$ in $\\mathrm{h\\,Mpc^{-1}}$.\n4. Report the numerical value of $h$ as your final answer. Round your final answer to three significant figures. Express the final answer as a pure number with no units. For part 1, express the converted $H_0$ in $\\mathrm{s^{-1}}$ within SI units.",
            "solution": "The problem requires a dimensional analysis of the Hubble parameter $H_0$, its conversion to SI units, the definition and calculation of the reduced Hubble parameter $h$, and an explanation of the use of $h$ in cosmological scaling.\n\n**Part 1: Dimensional Analysis and Conversion of $H_0$ to SI units**\n\nThe Hubble parameter is defined as $H(t) \\equiv \\dot{a}(t)/a(t)$, where $a(t)$ is the dimensionless cosmological scale factor and $\\dot{a}(t)$ is its time derivative, $da/dt$. The dimensions of these quantities are $[a] = 1$ (dimensionless) and $[\\dot{a}] = [T^{-1}]$, where $[T]$ represents the dimension of time.\n\nTherefore, the dimension of the Hubble parameter is:\n$$ [H] = \\frac{[\\dot{a}]}{[a]} = \\frac{[T^{-1}]}{1} = [T^{-1}] $$\nThis confirms that the Hubble parameter $H_0$ has the fundamental dimension of inverse time. Its conventional astronomical units, $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, obscure this fact but are dimensionally consistent. Let's demonstrate this by converting the given value of $H_0$ to its base SI unit, $\\mathrm{s^{-1}}$.\n\nWe are given:\n$H_0 = 67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$\n$1\\,\\mathrm{Mpc} = 3.085677581\\times 10^{22}\\,\\mathrm{m}$\n\nFirst, we convert Megaparsecs ($\\mathrm{Mpc}$) to kilometers ($\\mathrm{km}$) to create a dimensionless ratio of length units.\n$1\\,\\mathrm{km} = 10^3\\,\\mathrm{m}$.\nTherefore, $1\\,\\mathrm{Mpc}$ in kilometers is:\n$$ 1\\,\\mathrm{Mpc} = \\frac{3.085677581\\times 10^{22}\\,\\mathrm{m}}{10^3\\,\\mathrm{m/km}} = 3.085677581\\times 10^{19}\\,\\mathrm{km} $$\n\nNow, we can substitute this conversion into the expression for $H_0$:\n$$ H_0 = 67.4\\,\\frac{\\mathrm{km}}{\\mathrm{s} \\cdot \\mathrm{Mpc}} = 67.4\\,\\frac{\\mathrm{km}}{\\mathrm{s}} \\cdot \\frac{1}{1\\,\\mathrm{Mpc}} = 67.4\\,\\frac{\\mathrm{km}}{\\mathrm{s}} \\cdot \\frac{1}{3.085677581\\times 10^{19}\\,\\mathrm{km}} $$\nThe units of $\\mathrm{km}$ cancel, leaving units of $\\mathrm{s^{-1}}$:\n$$ H_0 = \\frac{67.4}{3.085677581\\times 10^{19}}\\,\\mathrm{s^{-1}} \\approx 2.1842 \\times 10^{-18}\\,\\mathrm{s^{-1}} $$\nAs required by the dimensional analysis, the value of $H_0$ in SI units is indeed an inverse time, specifically $H_0 \\approx 2.184 \\times 10^{-18}\\,\\mathrm{s^{-1}}$.\n\n**Part 2: Definition and Calculation of the Reduced Hubble Parameter $h$**\n\nThe reduced Hubble parameter, denoted by the dimensionless variable $h$, is a convention in cosmology used to parameterize the Hubble constant $H_0$. It is defined by the relation:\n$$ H_0 \\equiv 100\\,h\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}} $$\nThis definition factors the value of $H_0$ into a convenient benchmark value, $100\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, and the dimensionless parameter $h$ which quantifies the deviation from this benchmark.\n\nGiven $H_0 = 67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, we can solve for $h$:\n$$ h = \\frac{H_0}{100\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}} = \\frac{67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}}{100\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}} = 0.674 $$\nThe numerical value of $h$ is $0.674$.\n\n**Part 3: Explanation of Rescaling with $h$**\n\nThe use of the reduced Hubble parameter $h$ is a powerful tool for managing the historical and ongoing uncertainty in the measured value of $H_0$. Many cosmological quantities, such as distances, luminosities, and the power spectrum of density fluctuations, depend on $H_0$. By expressing these quantities in terms of $h$, theoretical predictions and observational data can be presented in a form that is easily scalable to any preferred value of $H_0$.\n\n- **Rescaling of Comoving Distances:** Distances in cosmology are often inferred from redshift measurements and depend inversely on $H_0$. To make this dependence explicit, distances are frequently quoted in units of $h^{-1}\\,\\mathrm{Mpc}$. A distance $D$ written as $D = X\\,h^{-1}\\,\\mathrm{Mpc}$ has an actual value of $D = X \\cdot (100\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}} / H_0) \\, \\mathrm{Mpc}$. If an observer uses a different value for $H_0$, they can easily rescale the result by simply inserting their corresponding value of $h$.\n\n  For the specific case of the smoothing radius $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$ used in the definition of $\\sigma_8$, the notation signifies that the actual comoving scale is not a fixed $8\\,\\mathrm{Mpc}$, but rather a scale that is defined relative to the Hubble constant. With our value of $h = 0.674$, this physical scale is:\n  $$ R = \\frac{8}{0.674}\\,\\mathrm{Mpc} \\approx 11.87\\,\\mathrm{Mpc} $$\n  This convention allows the theoretical framework defining $\\sigma_8$ to remain consistent while the precise physical scale it corresponds to is updated with improved measurements of $H_0$.\n\n- **Rescaling of Wavenumbers:** The wavenumber, $k$, is defined in Fourier space and has dimensions of inverse length (e.g., $\\mathrm{Mpc^{-1}}$). As such, its scaling with $H_0$ is inverse to that of distance. If distances scale as $h^{-1}$, then wavenumbers must scale as $h$.\n\n  Therefore, wavenumbers are often reported in units of $h\\,\\mathrm{Mpc^{-1}}$. A wavenumber reported as $k_{report} = q\\,h\\,\\mathrm{Mpc^{-1}}$ corresponds to a physical wavenumber of $k_{phys} = q \\cdot h\\,\\mathrm{Mpc^{-1}}$. For example, a feature in the matter power spectrum at $k = 0.1\\,h\\,\\mathrm{Mpc^{-1}}$ corresponds to a physical wavenumber of:\n  $$ k_{phys} = 0.1 \\times 0.674\\,\\mathrm{Mpc^{-1}} = 0.0674\\,\\mathrm{Mpc^{-1}} $$\n  Plotting quantities like the matter power spectrum $P(k)$ against $k$ in units of $h\\,\\mathrm{Mpc^{-1}}$ allows for a direct, $H_0$-independent comparison between different theoretical models and observational data compilations. The specific value of $H_0$ is only factored in when converting to absolute physical scales.\n\n**Part 4: Final Answer Computation**\n\nThe problem asks for the numerical value of $h$, rounded to three significant figures. As computed in Part 2, using the given value of $H_0 = 67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$:\n$$ h = \\frac{67.4}{100} = 0.674 $$\nThe input value $67.4$ has three significant figures, and the result $0.674$ also has three significant figures. No further rounding is necessary.",
            "answer": "$$\n\\boxed{0.674}\n$$"
        },
        {
            "introduction": "This practice delves into the practicalities of running cosmological N-body simulations, a cornerstone of modern cosmology. You will explore how to adjust the initial conditions of a simulation to match a desired normalization parameter, $\\sigma_8$, which quantifies the amplitude of matter fluctuations. This exercise beautifully illustrates the power of linear perturbation theory, which allows for the efficient rescaling of simulation amplitudes without the need for generating entirely new initial random fields .",
            "id": "3476772",
            "problem": "Consider a flat Lambda Cold Dark Matter (ΛCDM) cosmology with fixed Hubble constant $H_{0}$, matter density parameter $\\Omega_{m}$, and dark energy density parameter $\\Omega_{\\Lambda}$. Initial conditions for an $N$-body simulation are constructed at a fixed initial redshift $z_{\\mathrm{ini}}$ using First-Order Lagrangian Perturbation Theory (1LPT), also known as the Zel'dovich approximation (ZA). The initial displacement field $\\boldsymbol{\\psi}(\\boldsymbol{q}, z_{\\mathrm{ini}})$ is generated from a Gaussian random linear density field with linear matter power spectrum $P_{\\mathrm{lin}}(k, z)$ whose shape is held fixed, and whose time evolution is governed by the linear growth factor $D(z)$ through $P_{\\mathrm{lin}}(k, z) = \\left(\\frac{D(z)}{D(0)}\\right)^{2} P_{\\mathrm{lin}}(k, 0)$.\n\nThe variance of the linearly evolved density field smoothed on comoving scale $R$, denoted $\\sigma_{R}(z)$, is defined by the standard top-hat smoothing integral\n$$\n\\sigma_{R}^{2}(z) = \\int \\frac{d^{3}k}{(2\\pi)^{3}}\\, P_{\\mathrm{lin}}(k, z)\\, W^{2}(kR),\n$$\nwhere $W(kR)$ is the Fourier transform of the real-space spherical top-hat window of radius $R$. The normalization parameter $\\sigma_{8}$ is the special case $\\sigma_{R}$ evaluated at $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$ at $z=0$.\n\nYou are asked to retarget the normalization of the simulation from an original $\\sigma_{8}^{\\mathrm{old}}(z=0) = 0.8$ to a new $\\sigma_{8}^{\\mathrm{new}}(z=0) = 0.9$, while keeping the cosmology $\\{H_{0}, \\Omega_{m}, \\Omega_{\\Lambda}\\}$ and the initial redshift $z_{\\mathrm{ini}}$ fixed, and without regenerating phases or changing the shape of $P_{\\mathrm{lin}}(k, 0)$. Derive from first principles the multiplicative amplitude rescaling factor $s$ that must be applied to the initial ZA displacement field $\\boldsymbol{\\psi}(\\boldsymbol{q}, z_{\\mathrm{ini}})$ to achieve this change in normalization at $z=0$.\n\nFor verification, a particular realization generated with $\\sigma_{8}^{\\mathrm{old}}(z=0)$ yields a measured linearly extrapolated value $\\sigma_{8}^{\\mathrm{meas}}(z=0) = 0.802$. Using your derived $s$, compute the predicted post-rescaling measurement $\\sigma_{8}^{\\mathrm{meas,new}}(z=0)$ for this realization and comment on whether it is consistent with the target normalization given finite-volume fluctuations.\n\nExpress the final required rescaling factor $s$ as a dimensionless number. Round your final answer to four significant figures.",
            "solution": "The problem asks for a multiplicative scaling factor, $s$, to be applied to the initial displacement field $\\boldsymbol{\\psi}(\\boldsymbol{q}, z_{\\mathrm{ini}})$ of an N-body simulation to change its linear theory normalization from an old value, $\\sigma_{8}^{\\mathrm{old}}(z=0) = 0.8$, to a new target value, $\\sigma_{8}^{\\mathrm{new}}(z=0) = 0.9$. The derivation relies on the linear relationships between the different fields in cosmological perturbation theory.\n\n1.  **From Displacement Field to Density Field:** In First-Order Lagrangian Perturbation Theory (1LPT), the displacement field $\\boldsymbol{\\psi}$ is linearly related to the linear density contrast $\\delta_{\\mathrm{lin}}$ via the continuity equation, which in Fourier space is $\\delta_{\\mathrm{lin}}(\\boldsymbol{k}) \\propto i \\boldsymbol{k} \\cdot \\boldsymbol{\\psi}(\\boldsymbol{k})$. This means that if the displacement field is rescaled by a factor $s$, the linear density field is also rescaled by the same factor:\n    $$ \\delta_{\\mathrm{lin}}^{\\mathrm{new}}(\\boldsymbol{k}, z_{\\mathrm{ini}}) = s \\cdot \\delta_{\\mathrm{lin}}^{\\mathrm{old}}(\\boldsymbol{k}, z_{\\mathrm{ini}}) $$\n\n2.  **Linear Growth:** The evolution of linear perturbations is governed by the linear growth factor $D(z)$, which is independent of the perturbation amplitude. The density field at any redshift $z$ is $\\delta_{\\mathrm{lin}}(\\boldsymbol{k}, z) = \\delta_{\\mathrm{lin}}(\\boldsymbol{k}, z_{\\mathrm{ini}}) \\frac{D(z)}{D(z_{\\mathrm{ini}})}$. Therefore, a scaling applied at $z_{\\mathrm{ini}}$ propagates linearly to all other redshifts:\n    $$ \\delta_{\\mathrm{lin}}^{\\mathrm{new}}(\\boldsymbol{k}, z=0) = s \\cdot \\delta_{\\mathrm{lin}}^{\\mathrm{old}}(\\boldsymbol{k}, z=0) $$\n\n3.  **From Density Field to Power Spectrum:** The matter power spectrum $P_{\\mathrm{lin}}(k)$ is defined by the variance of the Fourier modes of the density field: $\\langle \\delta_{\\mathrm{lin}}(\\boldsymbol{k}) \\delta_{\\mathrm{lin}}^*(\\boldsymbol{k}') \\rangle \\propto P_{\\mathrm{lin}}(k) \\delta_D(\\boldsymbol{k}-\\boldsymbol{k}')$. Because it is a two-point statistic, the power spectrum scales with the square of the amplitude of the density field:\n    $$ P_{\\mathrm{lin}}^{\\mathrm{new}}(k, z) = s^2 \\cdot P_{\\mathrm{lin}}^{\\mathrm{old}}(k, z) $$\n\n4.  **From Power Spectrum to $\\sigma_8$:** The variance of the smoothed density field, $\\sigma_R^2$, is a linear integral over the power spectrum. Thus, it also scales quadratically with $s$:\n    $$ (\\sigma_R^{\\mathrm{new}})^2 = \\int \\frac{d^3k}{(2\\pi)^3} P_{\\mathrm{lin}}^{\\mathrm{new}}(k) W^2(kR) = s^2 \\int \\frac{d^3k}{(2\\pi)^3} P_{\\mathrm{lin}}^{\\mathrm{old}}(k) W^2(kR) = s^2 (\\sigma_R^{\\mathrm{old}})^2 $$\n    Taking the square root, the root-mean-square (RMS) fluctuation amplitude $\\sigma_R$ scales linearly with $s$:\n    $$ \\sigma_R^{\\mathrm{new}} = s \\cdot \\sigma_R^{\\mathrm{old}} $$\n\n5.  **Deriving the Scaling Factor $s$:** We apply this linear relationship to the specific case of $\\sigma_8$ at $z=0$:\n    $$ \\sigma_{8}^{\\mathrm{new}}(z=0) = s \\cdot \\sigma_{8}^{\\mathrm{old}}(z=0) $$\n    Solving for $s$ with the given values:\n    $$ s = \\frac{\\sigma_{8}^{\\mathrm{new}}(z=0)}{\\sigma_{8}^{\\mathrm{old}}(z=0)} = \\frac{0.9}{0.8} = 1.125 $$\n    The required multiplicative rescaling factor is 1.125.\n\n**Verification and Consistency Check:**\nFor a specific realization with a measured amplitude $\\sigma_{8}^{\\mathrm{meas}}(z=0) = 0.802$, the new measured amplitude after applying the scaling factor $s$ will be:\n$$ \\sigma_{8}^{\\mathrm{meas,new}}(z=0) = s \\cdot \\sigma_{8}^{\\mathrm{meas}}(z=0) = 1.125 \\times 0.802 = 0.90225 $$\nThis result is consistent. The original realization had a fluctuation amplitude that was $\\frac{0.802}{0.8} = 1.0025$ times its ensemble mean due to cosmic variance. After rescaling, the new amplitude is $\\frac{0.90225}{0.9} = 1.0025$ times the new ensemble mean. The relative fluctuation due to the specific random seed is preserved, as expected.\n\nThe final answer is the numerical value of the scaling factor $s$. Since 1.125 has four significant figures, no further rounding is needed.",
            "answer": "$$\n\\boxed{1.125}\n$$"
        },
        {
            "introduction": "This final exercise serves as a capstone, guiding you through the process of computing the key parameter $\\sigma_8$ from first principles. You will implement a numerical routine that integrates multiple physical components: the primordial power spectrum, the matter transfer function, and the linear growth factor. This hands-on coding task illuminates how the present-day amplitude of matter clustering is a direct consequence of initial quantum fluctuations processed through the cosmic history of a specific cosmological model .",
            "id": "3476764",
            "problem": "You are asked to design and implement a numerical computation that evaluates the root-mean-square matter fluctuation in spheres of comoving radius $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$, denoted by $\\sigma_8$, for a Cold Dark Matter (CDM) cosmology characterized by the parameter set $(\\Omega_m, \\Omega_b, h, n_s, A_s)$. Assume a spatially flat Universe so that $\\Omega_\\Lambda = 1 - \\Omega_m$. The computation must start from fundamental definitions of the linear matter power spectrum and apply a physically motivated, no-baryon-wiggle transfer function.\n\nDefinitions to use:\n- The primordial dimensionless curvature power spectrum is given by $\\Delta_{\\mathcal{R}}^2(k) = A_s \\left(\\frac{k}{k_p}\\right)^{n_s - 1}$, where $A_s$ is the scalar amplitude, $n_s$ is the spectral index, and $k_p = 0.05\\,\\mathrm{Mpc}^{-1}$ is the pivot wavenumber.\n- The linear mapping from primordial curvature perturbations to matter density contrast is $\\delta_m(\\mathbf{k}, z) = \\mathcal{M}(k, z)\\,\\mathcal{R}(\\mathbf{k})$, with\n$$\n\\mathcal{M}(k, z) = \\frac{2}{5}\\,\\frac{k^2\\,T(k)\\,D(z)}{\\Omega_m\\,\\left(H_0/c\\right)^2},\n$$\nwhere $T(k)$ is the transfer function, $D(z)$ is the linear growth factor normalized to the Einstein–de Sitter case (see below), $H_0 = 100\\,h\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ is the Hubble constant today, and $c = 299{,}792.458\\,\\mathrm{km\\,s^{-1}}$ is the speed of light.\n- The dimensionless matter power spectrum is $\\Delta_m^2(k, z) = \\mathcal{M}(k, z)^2\\,\\Delta_{\\mathcal{R}}^2(k)$.\n- The top-hat window function in Fourier space is $W(x) = 3\\left[\\sin(x) - x\\cos(x)\\right]/x^3$, where $x = kR$.\n- The variance of the matter density field smoothed on scale $R$ is\n$$\n\\sigma_R^2 = \\int_{0}^{\\infty} \\Delta_m^2(k, z=0)\\,W^2(kR)\\,d\\ln k,\n$$\nand $\\sigma_8$ is $\\sigma_R$ evaluated at $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$.\n\nTransfer function to use:\n- Use the Bardeen–Bond–Kaiser–Szalay (BBKS) no-wiggle form for the transfer function with the Sugiyama effective shape parameter to account for baryon suppression without oscillatory features:\n$$\nT(k) = \\frac{\\ln\\left(1+2.34\\,q\\right)}{2.34\\,q}\\left[1 + 3.89\\,q + (16.1\\,q)^2 + (5.46\\,q)^3 + (6.71\\,q)^4\\right]^{-1/4},\n$$\nwith\n$$\nq = \\frac{k}{\\Gamma_{\\mathrm{eff}}},\\quad \\Gamma_{\\mathrm{eff}} = \\Omega_m\\,h\\,\\exp\\left[-\\Omega_b - \\sqrt{2h}\\,\\frac{\\Omega_b}{\\Omega_m}\\right],\n$$\nwhere $k$ is in units of $\\mathrm{Mpc}^{-1}$.\n\nGrowth factor to use:\n- At redshift $z=0$, use the Carroll–Press–Turner approximation for the growth suppression factor normalized to matter domination,\n$$\nD(0) = g(\\Omega_m, \\Omega_\\Lambda) = \\frac{5\\,\\Omega_m}{2}\\left[\\Omega_m^{4/7} - \\Omega_\\Lambda + \\left(1 + \\frac{\\Omega_m}{2}\\right)\\left(1 + \\frac{\\Omega_\\Lambda}{70}\\right)\\right]^{-1}.\n$$\n\nUnit conventions and numerical requirements:\n- Treat $k$ in $\\mathrm{Mpc}^{-1}$.\n- Use $H_0/c$ in $\\mathrm{Mpc}^{-1}$; compute it from $H_0 = 100\\,h\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ and $c = 299{,}792.458\\,\\mathrm{km\\,s^{-1}}$.\n- The final quantity $\\sigma_8$ is dimensionless; report each $\\sigma_8$ rounded to four decimals.\n- Perform the integral for $\\sigma_R^2$ over $k \\in [10^{-4}, 10^{2}]\\,\\mathrm{Mpc}^{-1}$ by transforming to the $\\ln k$ variable and using a numerically stable quadrature.\n\nTest suite:\nCompute $\\sigma_8$ for each of the following five parameter sets $(\\Omega_m, \\Omega_b, h, n_s, A_s)$, assuming $\\Omega_\\Lambda = 1 - \\Omega_m$ in all cases:\n1. $(0.315, 0.049, 0.674, 0.965, 2.105\\times10^{-9})$ — a typical contemporary baseline.\n2. $(0.315, 0.020, 0.674, 0.965, 2.105\\times10^{-9})$ — reduced baryon density to test shape sensitivity.\n3. $(0.315, 0.049, 0.674, 1.000, 2.105\\times10^{-9})$ — increased tilt to test small-scale enhancement.\n4. $(0.315, 0.049, 0.674, 0.965, 1.500\\times10^{-9})$ — reduced scalar amplitude to test normalization sensitivity.\n5. $(0.200, 0.049, 0.700, 0.965, 2.105\\times10^{-9})$ — lower matter density (and higher $\\Omega_\\Lambda$) to test growth suppression.\n\nFinal output format:\nYour program should produce a single line of output containing the five $\\sigma_8$ results as a comma-separated list enclosed in square brackets, with each value rounded to four decimals (e.g., \"[0.8021,0.7890, ...]\"). No other text should be printed.",
            "solution": "The problem asks for the computation of the root-mean-square mass fluctuation amplitude on a scale of $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$, denoted as $\\sigma_8$, for several sets of cosmological parameters. The calculation must be performed from first principles as defined in the problem statement, assuming a spatially flat $\\Lambda$CDM cosmology. The process can be broken down into a sequence of well-defined steps.\n\nFirst, we define the fundamental physical and numerical constants provided.\nThe speed of light is $c = 299{,}792.458\\,\\mathrm{km\\,s^{-1}}$.\nThe pivot wavenumber for the primordial power spectrum is $k_p = 0.05\\,\\mathrm{Mpc}^{-1}$.\nThe smoothing scale for $\\sigma_8$ is $R_8 = 8\\,h^{-1}\\,\\mathrm{Mpc}$.\n\nFor each given parameter set $(\\Omega_m, \\Omega_b, h, n_s, A_s)$, we proceed as follows:\n\n1.  **Derived Cosmological Parameters**\n    The problem specifies a spatially flat universe, so the dark energy density parameter $\\Omega_\\Lambda$ is determined by the matter density parameter $\\Omega_m$:\n    $$ \\Omega_\\Lambda = 1 - \\Omega_m $$\n    The Hubble constant is $H_0 = 100\\,h\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$. For use in cosmological equations, it is convenient to express it in units of $\\mathrm{Mpc}^{-1}$ by dividing by the speed of light:\n    $$ \\frac{H_0}{c} = \\frac{100\\,h}{299{,}792.458} \\, \\mathrm{Mpc}^{-1} $$\n\n2.  **Linear Growth Factor at $z=0$**\n    The growth of structure is suppressed in the presence of dark energy. The problem provides the Carroll–Press–Turner (CPT) approximation for the linear growth factor at redshift $z=0$, normalized to an Einstein-de Sitter universe. It is a function of $\\Omega_m$ and $\\Omega_\\Lambda$:\n    $$ D(0) = g(\\Omega_m, \\Omega_\\Lambda) = \\frac{5\\,\\Omega_m}{2}\\left[\\Omega_m^{4/7} - \\Omega_\\Lambda + \\left(1 + \\frac{\\Omega_m}{2}\\right)\\left(1 + \\frac{\\Omega_\\Lambda}{70}\\right)\\right]^{-1} $$\n    This factor quantifies the total growth of linear perturbations from the early universe to today.\n\n3.  **Transfer Function Shape Parameter**\n    The shape of the matter transfer function is primarily determined by the scale of the matter-radiation equality horizon. The effective shape parameter, $\\Gamma_{\\mathrm{eff}}$, which incorporates the suppressing effect of baryons, is given by the Sugiyama formula:\n    $$ \\Gamma_{\\mathrm{eff}} = \\Omega_m\\,h\\,\\exp\\left[-\\Omega_b - \\sqrt{2h}\\,\\frac{\\Omega_b}{\\Omega_m}\\right] $$\n    This parameter has units of wavenumber, $\\mathrm{Mpc}^{-1}$, and sets the characteristic scale where the transfer function transitions from $T(k) \\approx 1$ for large scales ($k \\to 0$) to its power-law decay for small scales ($k \\to \\infty$).\n\n4.  **Integrand for the Variance Calculation**\n    The variance of the smoothed matter density field, $\\sigma_R^2$, is the integral of the dimensionless matter power spectrum $\\Delta_m^2(k)$ weighted by the square of the top-hat window function in Fourier space, $W^2(kR)$. The integral is over the logarithm of the wavenumber, $d\\ln k$. For $\\sigma_8$, we evaluate this at $z=0$ and $R = R_8 = 8\\,h^{-1}\\,\\mathrm{Mpc}$.\n    $$ \\sigma_8^2 = \\int_{0}^{\\infty} \\Delta_m^2(k, z=0)\\,W^2(kR_8)\\,d\\ln k $$\n    The integrand is $\\mathcal{I}(k) = \\Delta_m^2(k, 0)\\,W^2(kR_8)$, which we now construct step-by-step.\n\n    a.  **Primordial Curvature Power Spectrum, $\\Delta_{\\mathcal{R}}^2(k)$**: Assumed to be a simple power law:\n        $$ \\Delta_{\\mathcal{R}}^2(k) = A_s \\left(\\frac{k}{k_p}\\right)^{n_s - 1} $$\n        where $A_s$ is the primordial amplitude and $n_s$ is the scalar spectral index.\n\n    b.  **Matter Transfer Function, $T(k)$**: The BBKS formula modified with the Sugiyama shape parameter is used. It describes how primordial density fluctuations are processed into the late-time matter distribution.\n        $$ T(k) = \\frac{\\ln\\left(1+2.34\\,q\\right)}{2.34\\,q}\\left[1 + 3.89\\,q + (16.1\\,q)^2 + (5.46\\,q)^3 + (6.71\\,q)^4\\right]^{-1/4} $$\n        where $q = k / \\Gamma_{\\mathrm{eff}}$.\n\n    c.  **Matter-Curvature Link, $\\mathcal{M}(k, 0)$**: This function links the primordial curvature perturbation $\\mathcal{R}$ to the matter density contrast $\\delta_m$ at $z=0$.\n        $$ \\mathcal{M}(k, z=0) = \\frac{2}{5}\\,\\frac{k^2\\,T(k)\\,D(0)}{\\Omega_m\\,\\left(H_0/c\\right)^2} $$\n\n    d.  **Dimensionless Matter Power Spectrum, $\\Delta_m^2(k, 0)$**: This is the power spectrum of the matter density field today.\n        $$ \\Delta_m^2(k, 0) = \\mathcal{M}(k, 0)^2 \\, \\Delta_{\\mathcal{R}}^2(k) $$\n        Substituting the expressions for $\\mathcal{M}(k,0)$ and $\\Delta_{\\mathcal{R}}^2(k)$:\n        $$ \\Delta_m^2(k, 0) = \\left( \\frac{2}{5}\\,\\frac{D(0)}{\\Omega_m\\,\\left(H_0/c\\right)^2} \\right)^2 A_s \\left(\\frac{k}{k_p}\\right)^{n_s - 1} k^4\\,T^2(k) $$\n\n    e.  **Top-Hat Window Function, $W(kR_8)$**: This function filters out fluctuations on scales smaller than $R_8$.\n        $$ W(x) = \\frac{3}{x^3}[\\sin(x) - x\\cos(x)], \\quad \\text{with } x = kR_8 $$\n        For small values of $x$, to maintain numerical stability, a Taylor expansion can be used: $W(x) \\approx 1 - x^2/10$.\n\n5.  **Numerical Integration**\n    The integral for $\\sigma_8^2$ is performed numerically. The problem specifies an integration range of $k \\in [10^{-4}, 10^{2}]\\,\\mathrm{Mpc}^{-1}$. We perform a change of variables to $u = \\ln k$, so $dk/k = du$. The integral becomes:\n    $$ \\sigma_8^2 = \\int_{\\ln(10^{-4})}^{\\ln(10^2)} \\Delta_m^2(e^u, 0) \\, W^2(e^u R_8) \\, du $$\n    This definite integral can be solved using a standard numerical quadrature routine, such as `scipy.integrate.quad`.\n\n6.  **Final Result**\n    After computing the variance $\\sigma_8^2$, the final result is its square root:\n    $$ \\sigma_8 = \\sqrt{\\sigma_8^2} $$\n    The calculation is repeated for each of the five parameter sets provided in the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes sigma_8 for a suite of cosmological parameter sets.\n    \"\"\"\n    # Test suite: (Omega_m, Omega_b, h, n_s, A_s)\n    test_cases = [\n        # 1. Typical contemporary baseline\n        (0.315, 0.049, 0.674, 0.965, 2.105e-9),\n        # 2. Reduced baryon density\n        (0.315, 0.020, 0.674, 0.965, 2.105e-9),\n        # 3. Increased tilt (n_s = 1)\n        (0.315, 0.049, 0.674, 1.000, 2.105e-9),\n        # 4. Reduced scalar amplitude\n        (0.315, 0.049, 0.674, 0.965, 1.500e-9),\n        # 5. Lower matter density\n        (0.200, 0.049, 0.700, 0.965, 2.105e-9),\n    ]\n\n    results = []\n    for params in test_cases:\n        sigma8 = calculate_sigma8(params)\n        results.append(f\"{sigma8:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n\ndef calculate_sigma8(params):\n    \"\"\"\n    Calculates sigma_8 for a single set of cosmological parameters.\n    \"\"\"\n    Omega_m, Omega_b, h, n_s, A_s = params\n\n    # Constants\n    c_kms = 299792.458  # Speed of light in km/s\n    k_pivot = 0.05  # Pivot scale in Mpc^-1\n    R8 = 8.0  # Smoothing scale in h^-1 Mpc\n    \n    # Integration limits for k in Mpc^-1\n    k_min = 1.0e-4\n    k_max = 1.0e2\n\n    # Derived cosmological parameters\n    Omega_Lambda = 1.0 - Omega_m\n    H0_over_c_Mpc_inv = (100.0 * h) / c_kms\n\n    # Growth factor at z=0 (Carroll-Press-Turner approximation)\n    term1 = Omega_m**(4.0/7.0)\n    term2 = Omega_Lambda\n    term3 = (1.0 + Omega_m/2.0) * (1.0 + Omega_Lambda/70.0)\n    D0 = (2.5 * Omega_m) / (term1 - term2 + term3)\n\n    # Effective shape parameter (Sugiyama formula)\n    Gamma_eff = Omega_m * h * np.exp(-Omega_b - np.sqrt(2.0*h) * Omega_b / Omega_m)\n\n    # Pre-factor for the matter power spectrum\n    prefactor_M_sq = ( (2.0/5.0) * D0 / (Omega_m * H0_over_c_Mpc_inv**2) )**2\n\n    def T_bbks(k):\n        \"\"\"BBKS transfer function with Sugiyama shape parameter.\"\"\"\n        q = k / Gamma_eff\n        # Use log1p for numerical stability at small q\n        log_term = np.log1p(2.34 * q) / (2.34 * q)\n        \n        poly_term_inv = 1.0 + 3.89*q + (16.1*q)**2 + (5.46*q)**3 + (6.71*q)**4\n        return log_term * poly_term_inv**(-0.25)\n\n    def W_tophat(x):\n        \"\"\"Top-hat window function in Fourier space.\"\"\"\n        # Use Taylor expansion for small x to avoid numerical precision issues\n        if abs(x)  1e-6:\n            return 1.0 - x**2 / 10.0\n        return 3.0 * (np.sin(x) - x*np.cos(x)) / x**3\n\n    def integrand(log_k):\n        \"\"\"\n        Integrand for sigma_R^2 as a function of log(k).\n        The change of variables from dk to d(log k) means we don't need the extra k.\n        sigma_R^2 = integral(Delta_m^2(k) * W^2(kR) * d(log k))\n        \"\"\"\n        k = np.exp(log_k)\n        \n        # Primordial power spectrum\n        delta_R_sq = A_s * (k / k_pivot)**(n_s - 1.0)\n        \n        # Transfer function squared\n        T_k_sq = T_bbks(k)**2\n        \n        # Matter power spectrum\n        # Delta_m^2 = M^2 * Delta_R^2\n        # M ~ k^2 * T(k), so M^2 ~ k^4 * T(k)^2\n        delta_m_sq = prefactor_M_sq * A_s * (k / k_pivot)**(n_s - 1.0) * k**4 * T_k_sq\n        \n        # Window function squared\n        W_sq = W_tophat(k * R8 / h)**2\n        \n        return delta_m_sq * W_sq\n\n    # Numerical integration over log(k)\n    log_k_min = np.log(k_min)\n    log_k_max = np.log(k_max)\n    \n    sigma8_sq, _ = integrate.quad(integrand, log_k_min, log_k_max, epsabs=1e-7, epsrel=1e-7)\n\n    return np.sqrt(sigma8_sq)\n\nsolve()\n```"
        }
    ]
}