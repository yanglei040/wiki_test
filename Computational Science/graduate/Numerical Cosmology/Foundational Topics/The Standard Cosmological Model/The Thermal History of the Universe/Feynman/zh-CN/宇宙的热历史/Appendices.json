{
    "hands_on_practices": [
        {
            "introduction": "这项首个实践任务旨在通过计算宇宙时间与温度之间的基本关系，为理解宇宙的热历史奠定基础。你将对弗里德曼方程进行数值积分，同时考虑相对论性粒子自由度 $g_*(T)$ 的变化，从而亲身体验QCD相变和电子-正负电子湮灭等事件如何扭曲简单的幂律膨胀模型。这项练习将让你对宇宙的“时钟”以及调控它的物理过程有一个切实的感受 。",
            "id": "3499024",
            "problem": "您的任务是编写一个完整的、可运行的程序，该程序能数值计算早期宇宙中，跨越量子色动力学 (QCD) 相变和电子-正电子湮灭 ($e^\\pm$) 过渡时的宇宙时间作为温度的函数，记作 $t(T)$。您必须将数值计算出的 $t(T)$ 与一个朴素的幂律估计进行比较，并量化由有效自由度的温度依赖性所引入的畸变。\n\n基本出发点是辐射主导的弗里德曼-勒梅特-罗伯逊-沃尔克 (FLRW) 宇宙学，其具有以下基本定律和核心定义：\n\n- 对于空间平坦宇宙的弗里德曼方程，$H^2 = \\frac{8\\pi G_N}{3}\\rho$，其中 $H$ 是哈勃膨胀率，$G_N$ 是牛顿常数，$\\rho$ 是能量密度。\n- 对于相对论性等离子体，能量密度为 $\\rho(T) = \\frac{\\pi^2}{30} g_*(T) T^4$，其中 $g_*(T)$ 是相对论性能量自由度的有效数，$T$ 是光子温度。\n- 共动熵密度守恒，$s(T) a^3 = \\text{constant}$，其中 $s(T) = \\frac{2\\pi^2}{45} g_s(T) T^3$ 是熵密度，$g_s(T)$ 是相对论性熵自由度的有效数，$a$ 是标度因子。\n\n使用这些定义，程序必须通过结合弗里德曼方程与熵守恒，从第一性原理推导出温度-时间关系。具体来说，您必须从上述基本原理出发，推导出用 $H(T)$、$T$、$g_s(T)$ 和 $dg_s/dT$ 表示的 $dt/dT$，而不依赖于预先提供的目标公式。\n\n$g_*(T)$ 和 $g_s(T)$ 的温度依赖性必须通过平滑且科学上合理的跨界函数来建模，这些函数通过双曲正切阶跃捕捉QCD和 $e^\\pm$ 过渡（以及μ子湮灭）。定义过渡整形函数\n$$\nS(T; T_0, \\Delta T) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right],\n$$\n该函数在 $T \\gg T_0$ 时从 $0$ 平滑变化到在 $T \\ll T_0$ 时的 $1$。使用以下参数值和参考自由度：\n\n- QCD相变：$T_0^{\\mathrm{qcd}} = 155\\,\\mathrm{MeV}$，$\\Delta T^{\\mathrm{qcd}} = 50\\,\\mathrm{MeV}$。\n- μ子湮灭：$T_0^{\\mu} = 105\\,\\mathrm{MeV}$，$\\Delta T^{\\mu} = 20\\,\\mathrm{MeV}$。\n- 电子-正电子湮灭：$T_0^{e} = 0.5\\,\\mathrm{MeV}$，$\\Delta T^{e} = 0.2\\,\\mathrm{MeV}$。\n- 高温基线：$g_{\\mathrm{high}} = 61.75$。\n- QCD后基线：$g_{\\mathrm{qcd}} = 17.25$。\n- μ子后基线：$g_{\\mu} = 10.75$。\n- $e^\\pm$后基线：能量自由度为 $g_{*,e} = 3.36$，熵自由度为 $g_{s,e} = 3.909$。\n\n按如下方式构建能量和熵自由度函数\n$$\ng_*(T) = g_{\\mathrm{high}} - \\left(g_{\\mathrm{high}} - g_{\\mathrm{qcd}}\\right) S(T; T_0^{\\mathrm{qcd}}, \\Delta T^{\\mathrm{qcd}})\n- \\left(g_{\\mathrm{qcd}} - g_{\\mu}\\right) S(T; T_0^{\\mu}, \\Delta T^{\\mu})\n- \\left(g_{\\mu} - g_{*,e}\\right) S(T; T_0^{e}, \\Delta T^{e}),\n$$\n$$\ng_s(T) = g_{\\mathrm{high}} - \\left(g_{\\mathrm{high}} - g_{\\mathrm{qcd}}\\right) S(T; T_0^{\\mathrm{qcd}}, \\Delta T^{\\mathrm{qcd}})\n- \\left(g_{\\mathrm{qcd}} - g_{\\mu}\\right) S(T; T_0^{\\mu}, \\Delta T^{\\mu})\n- \\left(g_{\\mu} - g_{s,e}\\right) S(T; T_0^{e}, \\Delta T^{e}).\n$$\n推导并使用与上述 $S(T)$ 一致的 $dg_s/dT$。\n\n在 $t(T)$ 的推导和计算中使用自然单位制（$\\hbar = c = k_B = 1$），并在最后使用转换因子 $1\\,\\mathrm{MeV}^{-1} = 6.582119569\\times 10^{-22}\\,\\mathrm{s}$ 将结果转换为国际单位制（SI）秒。使用 $G_N = 1/M_\\mathrm{Pl}^2$，其中（非约化）普朗克质量 $M_\\mathrm{Pl} = 1.2209\\times 10^{22}\\,\\mathrm{MeV}$。\n\n定义朴素幂律估计 $t_{\\mathrm{naive}}(T)$，假设 $g_s(T)$ 为常数且 $g_*(T)$ 沿热力学轨迹不变；对于每个测试用例，将 $g_*$ 固定为最终温度 $T$ 时的值，并执行从高温参考 $T_{\\mathrm{ref}}$ 到 $T$ 的相应温度积分。\n\n您的程序必须计算无量纲畸变\n$$\nD(T) = \\frac{t_{\\mathrm{true}}(T)}{t_{\\mathrm{naive}}(T)} - 1,\n$$\n其中 $t_{\\mathrm{true}}(T)$ 是通过将推导出的 $dt/dT$（包括 $g_s(T)$ 和 $g_*(T)$ 的变化）从 $T_{\\mathrm{ref}}$ 到 $T$（单位为 $\\mathrm{MeV}$）进行数值积分得到的，而 $t_{\\mathrm{naive}}(T)$ 是在上述朴素假设下计算的。所有时间必须以秒表示。\n\n使用兆电子伏特（MeV）为单位的温度实现以下测试套件：\n- 参考温度：$T_{\\mathrm{ref}} = 5000\\,\\mathrm{MeV}$。\n- 目标温度：$T \\in \\{150\\,\\mathrm{MeV}, 100\\,\\mathrm{MeV}, 20\\,\\mathrm{MeV}, 1\\,\\mathrm{MeV}, 0.1\\,\\mathrm{MeV}\\}$。\n\n为覆盖范围设计：\n- $T = 150\\,\\mathrm{MeV}$ 探测QCD相变区域。\n- $T = 100\\,\\mathrm{MeV}$ 探测QCD后、μ子湮灭前区域。\n- $T = 20\\,\\mathrm{MeV}$ 探测μ子和$e^\\pm$过渡之间。\n- $T = 1\\,\\mathrm{MeV}$ 探测$e^\\pm$湮灭前夕。\n- $T = 0.1\\,\\mathrm{MeV}$ 探测$e^\\pm$湮灭后很久。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4,result5]\"）。每个结果都必须是畸变 $D(T)$ 并四舍五入到六位小数。不允许有其他输出。",
            "solution": "该问题要求在辐射主导时期数值计算宇宙的时间-温度关系 $t(T)$，同时考虑与温度相关的有效自由度 $g_*(T)$ 和 $g_s(T)$。计算结果将与一个朴素估计进行比较，以量化其畸变。解决方案分为两个主要阶段：首先，从第一性原理推导出 $t(T)$ 的控制微分方程；其次，设计一个数值算法来求解该方程。\n\n### 时间-温度关系的推导\n\n宇宙的演化由弗里德曼方程控制。对于一个空间平坦、辐射主导的宇宙，该方程为：\n$$\nH^2 = \\left(\\frac{1}{a}\\frac{da}{dt}\\right)^2 = \\frac{8\\pi G_N}{3}\\rho(T)\n$$\n其中 $H$ 是哈勃参数，$a$ 是标度因子，$G_N$ 是牛顿引力常数，$\\rho(T)$ 是相对论性等离子体的能量密度。能量密度由下式给出：\n$$\n\\rho(T) = \\frac{\\pi^2}{30} g_*(T) T^4\n$$\n其中 $g_*(T)$ 是相对论性能量自由度的有效数，$T$ 是光子温度。所有计算都在自然单位制（$\\hbar = c = k_B = 1$）下进行。使用给定的关系 $G_N = 1/M_\\mathrm{Pl}^2$，其中 $M_\\mathrm{Pl} = 1.2209\\times 10^{22}\\,\\mathrm{MeV}$ 是非约化普朗克质量，哈勃参数变为：\n$$\nH(T) = \\sqrt{\\frac{8\\pi}{3 M_\\mathrm{Pl}^2} \\frac{\\pi^2}{30} g_*(T) T^4} = \\frac{T^2}{M_\\mathrm{Pl}} \\sqrt{\\frac{4\\pi^3 g_*(T)}{45}}\n$$\n\n第二个基本原理是共动熵守恒。在一个共动体积内的总熵 $S = s(T)a^3$ 是恒定的。这意味着其时间导数为零：\n$$\n\\frac{d}{dt}(s a^3) = \\frac{ds}{dt}a^3 + s \\left(3a^2 \\frac{da}{dt}\\right) = 0\n$$\n使用链式法则 $\\frac{ds}{dt} = \\frac{ds}{dT}\\frac{dT}{dt}$ 以及哈勃参数的定义 $H = \\frac{1}{a}\\frac{da}{dt}$，我们发现：\n$$\n\\frac{ds}{dT}\\frac{dT}{dt} a^3 + 3Hsa^3 = 0 \\implies \\frac{dT}{dt} = -3H \\frac{s}{ds/dT}\n$$\n熵密度 $s(T)$ 由 $s(T) = \\frac{2\\pi^2}{45} g_s(T) T^3$ 给出。其对温度的导数为：\n$$\n\\frac{ds}{dT} = \\frac{2\\pi^2}{45} \\left( \\frac{dg_s}{dT}T^3 + g_s(T) \\cdot 3T^2 \\right) = s(T) \\left( \\frac{1}{g_s(T)}\\frac{dg_s}{dT} + \\frac{3}{T} \\right)\n$$\n将此代入 $\\frac{dT}{dt}$ 的表达式中：\n$$\n\\frac{dT}{dt} = -3H \\frac{s(T)}{s(T) \\left( \\frac{1}{g_s(T)}\\frac{dg_s}{dT} + \\frac{3}{T} \\right)} = -3H \\left( \\frac{T g_s(T)}{T \\frac{dg_s}{dT} + 3g_s(T)} \\right) = -HT \\left( \\frac{1}{1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT}} \\right)\n$$\n我们寻求时间对温度的变化率 $\\frac{dt}{dT}$，即 $\\frac{dT}{dt}$ 的倒数：\n$$\n\\frac{dt}{dT} = -\\frac{1}{HT} \\left( 1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT} \\right)\n$$\n代入推导出的 $H(T)$ 表达式，我们得到真实时间演化 $t_{\\mathrm{true}}(T)$ 的最终微分方程：\n$$\n\\frac{dt}{dT}\\bigg|_{\\mathrm{true}} = - \\frac{M_\\mathrm{Pl}}{T^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T)}} \\left( 1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT} \\right)\n$$\n从参考温度 $T_{\\mathrm{ref}}$ 到最终温度 $T$ 所经过的时间可以通过对此表达式积分得到：\n$$\nt_{\\mathrm{true}}(T) = \\int_{T_{\\mathrm{ref}}}^{T} \\frac{dt}{dT'}\\bigg|_{\\mathrm{true}} dT'\n$$\n\n### 朴素幂律估计\n朴素估计 $t_{\\mathrm{naive}}(T)$ 假设 $g_s$ 是常数（因此 $\\frac{dg_s}{dT} = 0$）且 $g_*$ 是常数，固定在其最终温度 $g_*(T_{\\text{final}})$ 时的值。在这些假设下，微分方程大大简化：\n$$\n\\frac{dt}{dT}\\bigg|_{\\mathrm{naive}} = - \\frac{M_\\mathrm{Pl}}{T^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}}\n$$\n这个常微分方程（ODE）可以从 $T_{\\mathrm{ref}}$ 到 $T_{\\text{final}}$ 解析积分：\n$$\nt_{\\mathrm{naive}}(T_{\\text{final}}) = \\int_{T_{\\mathrm{ref}}}^{T_{\\text{final}}} \\left( - \\frac{M_\\mathrm{Pl}}{T'^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}} \\right) dT' = \\frac{M_\\mathrm{Pl}}{2} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}} \\left( \\frac{1}{T_{\\text{final}}^2} - \\frac{1}{T_{\\text{ref}}^2} \\right)\n$$\n\n### 自由度及其导数\n$g_*(T)$ 和 $g_s(T)$ 函数是使用所提供的整形函数 $S(T; T_0, \\Delta T) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right]$ 构建的。为了计算 $t_{\\mathrm{true}}$ 的被积函数，我们需要 $g_s(T)$ 的解析导数。整形函数的导数是：\n$$\n\\frac{dS}{dT}(T; T_0, \\Delta T) = \\frac{d}{dT}\\left[\\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right)\\right] = -\\frac{1}{2\\Delta T} \\mathrm{sech}^2\\left(\\frac{T_0 - T}{\\Delta T}\\right)\n$$\n由于 $g_s(T)$ 是各种过渡（QCD、μ子、电子）的 $S$ 函数的线性组合，其导数 $\\frac{dg_s}{dT}$ 是 $\\frac{dS}{dT}$ 项的相应线性组合。\n\n### 数值实现\n求解算法如下：\n1.  定义所有物理常数（$M_\\mathrm{Pl}$、MeV到秒的转换因子）和模型参数（每个过渡的 $T_0$、$\\Delta T$ 和基线 $g$ 值）。\n2.  根据提供的公式，实现 $g_*(T)$、$g_s(T)$ 及其解析导数 $\\frac{dg_s}{dT}(T)$ 的函数。\n3.  对于测试套件中的每个目标温度 $T_f$：\n    a. 通过将 $\\frac{dt}{dT}|_{\\mathrm{true}}$ 从 $T_{\\mathrm{ref}}$ 积分到 $T_f$ 来数值计算 $t_{\\mathrm{true}}(T_f)$。由于像 `scipy.integrate.quad` 这样的数值积分器通常要求下限小于上限，我们计算 $t_{\\mathrm{true}}(T_f) = -\\int_{T_f}^{T_{\\mathrm{ref}}} \\frac{dt}{dT'}|_{\\mathrm{true}} dT' = \\int_{T_f}^{T_{\\mathrm{ref}}} \\left(-\\frac{dt}{dT'}|_{\\mathrm{true}}\\right) dT'$。结果以 $\\mathrm{MeV}^{-1}$ 为单位获得，并转换为秒。\n    b. 使用其推导公式解析计算 $t_{\\mathrm{naive}}(T_f)$，其中 $g_*(T_{\\text{final}})$ 在 $T_f$ 处求值。结果也以 $\\mathrm{MeV}^{-1}$ 为单位获得，并转换为秒。\n    c. 计算无量纲畸变 $D(T_f) = \\frac{t_{\\mathrm{true}}(T_f)}{t_{\\mathrm{naive}}(T_f)} - 1$。\n4.  收集畸变值，将它们四舍五入到六位小数，并以方括号内的逗号分隔列表格式化输出。\n此过程确保了精确模型与简化的朴素估计之间的严格比较，揭示了熵释放过程对宇宙热历史的影响。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the distortion D(T) in the cosmic time-temperature relation\n    for a set of target temperatures in the early universe.\n    \"\"\"\n    # Define constants and parameters as per the problem statement\n    # Natural units: h_bar = c = k_B = 1\n    \n    # Physical constants\n    M_PL = 1.2209e22  # Non-reduced Planck mass in MeV\n    MEV_TO_S = 6.582119569e-22  # Conversion factor from MeV^-1 to s\n\n    # Transition parameters (T0 in MeV, dT in MeV)\n    T0_QCD, DT_QCD = 155.0, 50.0\n    T0_MU, DT_MU = 105.0, 20.0\n    T0_E, DT_E = 0.5, 0.2\n\n    # Degrees of freedom (g) baselines\n    G_HIGH = 61.75\n    G_QCD = 17.25\n    G_MU = 10.75\n    G_STAR_E = 3.36\n    G_S_E = 3.909\n\n    # Pre-calculate differences for g* and gs calculations\n    DG_QCD = G_HIGH - G_QCD\n    DG_MU = G_QCD - G_MU\n    DG_STAR_E = G_MU - G_STAR_E\n    DG_S_E = G_MU - G_S_E\n    \n    # Test suite parameters\n    T_REF = 5000.0  # Reference temperature in MeV\n    TARGET_TEMPS = [150.0, 100.0, 20.0, 1.0, 0.1] # Target temperatures in MeV\n\n    # --- Helper functions ---\n\n    def S(T, T0, dT):\n        \"\"\"Transition shaping function S(T; T0, dT).\"\"\"\n        return 0.5 * (1.0 + np.tanh((T0 - T) / dT))\n\n    def g_star(T):\n        \"\"\"Effective number of relativistic energy degrees of freedom g_*(T).\"\"\"\n        s_qcd = S(T, T0_QCD, DT_QCD)\n        s_mu = S(T, T0_MU, DT_MU)\n        s_e = S(T, T0_E, DT_E)\n        return G_HIGH - DG_QCD * s_qcd - DG_MU * s_mu - DG_STAR_E * s_e\n\n    def g_s(T):\n        \"\"\"Effective number of relativistic entropy degrees of freedom g_s(T).\"\"\"\n        s_qcd = S(T, T0_QCD, DT_QCD)\n        s_mu = S(T, T0_MU, DT_MU)\n        s_e = S(T, T0_E, DT_E)\n        return G_HIGH - DG_QCD * s_qcd - DG_MU * s_mu - DG_S_E * s_e\n\n    def dS_dT(T, T0, dT):\n        \"\"\"Derivative of the shaping function S with respect to T.\"\"\"\n        # sech(x)^2 = 1/cosh(x)^2\n        arg = (T0 - T) / dT\n        return -1.0 / (2.0 * dT * np.cosh(arg)**2)\n\n    def dg_s_dT(T):\n        \"\"\"Derivative of g_s(T) with respect to T.\"\"\"\n        dsdt_qcd = dS_dT(T, T0_QCD, DT_QCD)\n        dsdt_mu = dS_dT(T, T0_MU, DT_MU)\n        dsdt_e = dS_dT(T, T0_E, DT_E)\n        return -DG_QCD * dsdt_qcd - DG_MU * dsdt_mu - DG_S_E * dsdt_e\n    \n    # --- Integrand for dt/dT_true ---\n    # We compute -dt/dT, which is positive, and integrate from T_final to T_ref\n    # to get t_true = t(T_final) - t(T_ref).\n    \n    # Constant part of the expression for dt/dT: M_Pl * sqrt(45 / (4*pi^3))\n    const_integrand_part = M_PL * np.sqrt(45.0 / (4.0 * np.pi**3))\n\n    def true_integrand(T):\n        \"\"\"The function -dt/dT to be integrated for t_true.\"\"\"\n        g_star_val = g_star(T)\n        g_s_val = g_s(T)\n        dg_s_dT_val = dg_s_dT(T)\n        \n        term1 = const_integrand_part / (T**3 * np.sqrt(g_star_val))\n        term2 = 1.0 + (T / (3.0 * g_s_val)) * dg_s_dT_val\n        \n        return term1 * term2\n\n    results = []\n    for T_final in TARGET_TEMPS:\n        # --- 1. Calculate t_true ---\n        # Integrate from T_final (lower limit) to T_ref (upper limit).\n        integral_result, _ = integrate.quad(true_integrand, T_final, T_REF)\n        t_true_mev_inv = integral_result\n        t_true_s = t_true_mev_inv * MEV_TO_S\n\n        # --- 2. Calculate t_naive ---\n        g_star_final = g_star(T_final)\n        \n        # Coefficient for the naive calculation\n        c_naive = (M_PL / 2.0) * np.sqrt(45.0 / (4.0 * np.pi**3 * g_star_final))\n        \n        t_naive_mev_inv = c_naive * (1.0 / T_final**2 - 1.0 / T_REF**2)\n        t_naive_s = t_naive_mev_inv * MEV_TO_S\n\n        # --- 3. Calculate the distortion D(T) ---\n        distortion = t_true_s / t_naive_s - 1.0\n        results.append(f\"{distortion:.6f}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在宏观热历史的基础上，这项练习深入探讨了一个关键的微观事件：电子-正负电子湮灭。你将超越简单的近似，对最终的中微子与光子的温度比以及有效中微子物种数 $N_{\\rm eff}$ 进行一次精确计算。这项实践要求你从第一性原理出发，实现热力学积分并引入领头阶的QED修正，让你深入了解微妙的等离子体物理如何影响关键的宇宙学可观测量 。",
            "id": "3499106",
            "problem": "构建一个完整、可运行的程序，该程序通过将经 Quantum Electrodynamics (QED) 修正的热力学纳入相互作用等离子体中，为一组测试用例数值计算电子-正电子湮灭后最终的中微子与光子温度之比以及有效中微子物种数。物理情景是早期宇宙中电子-正电子湮灭前后，中微子在指定的退耦温度下瞬时退耦。结果必须是无量纲的，并以实数形式报告。\n\n您必须使用的基本依据是：任何保持在局域热平衡的部分中的协移熵守恒、理想 Fermi-Dirac 和 Bose-Einstein 气体的相对论动理学理论，以及有效中微子物种数的定义。仅从这些基础出发。不要使用预先制表的关于最终中微子-光子温度比或最终有效中微子物种数的拟合公式。您必须从第一性原理推导并实现必要的热力学积分。\n\n需要实现的假设和定义：\n- 使用自然单位制，其中玻尔兹曼常数、光速和约化普朗克常数设为1，因此温度即能量。温度以兆电子伏特 (MeV) 表示。所有输出都是不带单位的纯数。\n- 假设电子和正电子在指定的退耦温度 $T_{\\mathrm{dec}}$ 之前与光子处于局域热平衡状态，此后中微子自由流，而光子及电子-正电子对在对湮灭为光子的过程中保持平衡。\n- 假设在 $T_{\\mathrm{dec}}$ 发生瞬时退耦，意味着中微子在 $T_{\\mathrm{dec}}$ 时与等离子体具有共同温度，随后随尺度因子绝热冷却。\n- 对于理想热力学（无 QED 修正），一个物种在温度 $T$ 时的熵密度 $s$、能量密度 $\\rho$ 和压强 $P$ 满足 $s = (\\rho + P)/T$。对于光子，其 $g_{\\gamma} = 2$，则 $s_{\\gamma}(T) = \\frac{2 \\pi^2}{45} g_{\\gamma} T^3$。对于总内禀自由度为 $g_{e^\\pm} = 4$、质量为 $m_e$ 的理想 Fermi-Dirac 电子和正电子气体，在温度 $T$ 时的能量密度和压强需通过以下积分计算\n$$\n\\rho_{e^\\pm}(T) = \\frac{g_{e^\\pm}}{2 \\pi^2} T^4 \\int_{0}^{\\infty} \\mathrm{d}y \\, \\frac{y^2 \\sqrt{y^2 + z^2}}{\\exp\\!\\left(\\sqrt{y^2 + z^2}\\right) + 1},\n\\quad\nP_{e^\\pm}(T) = \\frac{g_{e^\\pm}}{6 \\pi^2} T^4 \\int_{0}^{\\infty} \\mathrm{d}y \\, \\frac{y^4/\\sqrt{y^2 + z^2}}{\\exp\\!\\left(\\sqrt{y^2 + z^2}\\right) + 1},\n$$\n其中 $z = m_e/T$，$y = p/T$ 是无量纲动量。则 $s_{e^\\pm}(T) = \\left(\\rho_{e^\\pm}(T) + P_{e^\\pm}(T)\\right)/T$。\n- 相互作用等离子体部分的有效熵自由度 $g_{s,\\gamma e}(T)$ 由 $s_{\\gamma e}(T) \\equiv s_{\\gamma}(T) + s_{e^\\pm}(T) = \\frac{2 \\pi^2}{45} g_{s,\\gamma e}(T) T^3$ 定义。\n- QED 修正的热力学必须作为对相互作用部分熵密度的微扰、领头阶修正被包含进来。实现以下最小、保守且有物理动机的拟设：\n    1. 将超相对论性电子-正电子熵密度（理想，无质量）定义为 $s_{e^\\pm}^{\\mathrm{UR}}(T) = \\frac{2 \\pi^2}{45} \\left(\\frac{7}{8}\\right) g_{e^\\pm} T^3$。\n    2. 将电子-正电子超相对论性权重定义为 $w(T) = s_{e^\\pm}(T) / s_{e^\\pm}^{\\mathrm{UR}}(T)$。\n    3. 经 QED 修正的相互作用部分的熵为 $s_{\\gamma e}^{\\mathrm{QED}}(T) = s_{\\gamma e}^{\\mathrm{ideal}}(T) \\left[ 1 + \\left( \\frac{\\alpha}{\\pi} \\right) c_0 \\, w(T) \\right]$，其中 $\\alpha$ 是电磁精细结构常数，$c_0 = -\\frac{5}{4}$。这捕捉了高温下热力学势的领头阶减少，并通过 $w(T)$ 在对湮灭后使该效应消失。\n    4. 从 $s_{\\gamma e}^{\\mathrm{QED}}(T)$，通过 $s_{\\gamma e}^{\\mathrm{QED}}(T) = \\frac{2 \\pi^2}{45} g_{s,\\gamma e}^{\\mathrm{QED}}(T) T^3$ 定义 $g_{s,\\gamma e}^{\\mathrm{QED}}(T)$。\n- 根据中微子退耦后相互作用部分的协移熵守恒以及中微子的独立绝热冷却，仅用 $g_{s,\\gamma e}(T_{\\mathrm{dec}})$ 和仅光子的 $g_{s,\\gamma}(T) = 2$ 来推导最终的中微子-光子温度之比。您必须得到一个通用表达式，然后进行数值计算。\n- 有效中微子物种数 $N_{\\mathrm{eff}}$ 由标准关系式定义\n$$\n\\rho_{\\nu} \\equiv N_{\\mathrm{eff}} \\left(\\frac{7}{8}\\right) \\left( \\frac{4}{11} \\right)^{4/3} \\rho_{\\gamma},\n$$\n并为您计算的 $T_{\\nu}/T_{\\gamma}$ 和给定的类标准模型中微子物种数 $N_{\\nu}$ 计算出相应的 $N_{\\mathrm{eff}}$。您的定义必须在 $T_{\\nu}/T_{\\gamma} = \\left(\\frac{4}{11}\\right)^{1/3}$ 时简化为 $N_{\\mathrm{eff}} = N_{\\nu}$。\n\n需使用的常数：\n- 电子质量 $m_e = 0.51099895\\,\\mathrm{MeV}$。\n- 精细结构常数 $\\alpha = 1/137.035999084$。\n- 内禀自由度 $g_{\\gamma} = 2$ 和 $g_{e^\\pm} = 4$。\n\n要求的数值实现细节：\n- 您必须以足够的精度数值计算所需的热力学积分，以分辨在 $T \\sim \\mathcal{O}(\\mathrm{MeV})$ 附近百分比以下的修正。您可以自由选择在指定环境中可用的任何稳定且收敛的数值积分方法。\n- 所有量都是纯数；输出中不应出现单位。\n- 为保证可复现性，在有 QED 修正的情况下，请严格实现上述指定的拟设；不要替换为任何替代的修正模型。\n\n测试套件：\n您的程序必须为以下五个用例计算结果，每个用例指定为一个元组 $(T_{\\mathrm{dec}}, \\mathrm{include\\_QED}, N_{\\nu})$：\n- 用例 1：$(2.0, \\mathrm{True}, 3.0)$。\n- 用例 2：$(2.0, \\mathrm{False}, 3.0)$。\n- 用例 3：$(20.0, \\mathrm{True}, 3.0)$。\n- 用例 4：$(0.3, \\mathrm{True}, 3.0)$。\n- 用例 5：$(2.0, \\mathrm{True}, 2.5)$。\n\n输出规范：\n- 对于每个用例，使用您推导的表达式和数值积分计算数值对 $\\left[T_{\\nu}/T_{\\gamma}, N_{\\mathrm{eff}}\\right]$。\n- 将每个实数四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，包含一个无空格、逗号分隔的列表之列表形式的结果，格式严格如下\n$[\\,[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4],[x_5,y_5]\\,]$,\n其中 $x_i$ 和 $y_i$ 是用例 $i$ 的四舍五入值。例如，一个语法正确的行看起来像 $[[0.713766,3.000000],[\\dots]]$。\n\n科学真实性和约束：\n- 确保您的实现严格遵循上述定义，并遵守协移熵守恒。\n- 不要在您的代码或推导中包含任何未经前述基本依据推导而直接给出 $T_{\\nu}/T_{\\gamma}$ 或 $N_{\\mathrm{eff}}$ 最终结果的公式。\n- 在整个测试套件中保持所有计算的数值稳定性，特别是在边界情况 $T_{\\mathrm{dec}} = 0.3$（此时电子-正电子对已处于非相对论状态）时。\n\n您的最终交付成果必须是一个独立的、可运行的程序，执行这些计算并打印所需的单行输出。",
            "solution": "该问题要求从第一性原理出发，计算早期宇宙中电子-正电子湮灭后最终的中微子与光子温度之比 $T_{\\nu}/T_{\\gamma}$ 和有效中微子物种数 $N_{\\mathrm{eff}}$，并包含一个可选的领头阶 QED 修正。解题过程分为三个主要步骤：\n1. 从协移熵守恒推导温度比 $T_{\\nu}/T_{\\gamma}$。\n2. 计算相互作用的光子-电子-正电子等离子体的有效熵自由度数 $g_{s,\\gamma e}$，并包含指定的 QED 修正。\n3. 从 $N_{\\mathrm{eff}}$ 的标准定义和已计算的温度比推导 $N_{\\mathrm{eff}}$。\n\n我们在自然单位制中进行计算，其中 $\\hbar=c=k_B=1$。\n\n**1. 最终温度比 $T_{\\nu}/T_{\\gamma}$ 的推导**\n\n核心原理是，对于任何处于局域热平衡的系统，其协移体积内的熵是守恒的。我们假设在中微子退耦温度 $T_{\\mathrm{dec}}$ 时，中微子从由光子、电子和正电子组成的原始等离子体中退耦。退耦后，中微子部分和光子-电子-正电子 ($\\gamma e^\\pm$) 部分各自独立演化，且各自的协移熵守恒。\n\n设 $S=sa^3$ 为协移熵，其中 $s$ 是熵密度，$a$ 是宇宙的尺度因子。\n对于 $\\gamma e^\\pm$ 等离子体，其协移熵从中微子退耦时刻（$T=T_{\\mathrm{dec}}$）到远在电子-正电子湮灭之后（$T_{\\gamma} \\ll m_e$）是守恒的。\n$$ S_{\\gamma e}(T_{\\mathrm{dec}}) = S_{\\gamma e, \\mathrm{final}} $$\n$$ s_{\\gamma e}(T_{\\mathrm{dec}}) a(T_{\\mathrm{dec}})^3 = s_{\\gamma}(T_{\\gamma}) a(T_{\\gamma})^3 $$\n此处，$s_{\\gamma e}(T)$ 是 $\\gamma e^\\pm$ 等离子体在温度 $T$ 时的熵密度，$s_{\\gamma}(T_{\\gamma})$ 是剩余的光子气体在其最终温度 $T_{\\gamma}$ 时的熵密度。最终的等离子体仅由光子组成，因为所有电子-正电子对都已湮灭。\n\n在温度 $T$ 处于热平衡的一组物种的熵密度，可以用有效熵自由度数 $g_s(T)$ 表示为：\n$$ s(T) = \\frac{2\\pi^2}{45} g_s(T) T^3 $$\n将此应用于我们的熵守恒方程：\n$$ \\frac{2\\pi^2}{45} g_{s,\\gamma e}(T_{\\mathrm{dec}}) T_{\\mathrm{dec}}^3 a(T_{\\mathrm{dec}})^3 = \\frac{2\\pi^2}{45} g_{s,\\gamma}(T_{\\gamma}) T_{\\gamma}^3 a(T_{\\gamma})^3 $$\n其中 $g_{s,\\gamma e}(T_{\\mathrm{dec}})$ 是 $\\gamma e^\\pm$ 等离子体在 $T_{\\mathrm{dec}}$ 时的有效熵自由度数，$g_{s,\\gamma}(T_{\\gamma})$ 是光子气体的有效熵自由度数。对于纯光子气体，$g_{s,\\gamma}(T_{\\gamma}) = g_{\\gamma} = 2$。方程简化为：\n$$ g_{s,\\gamma e}(T_{\\mathrm{dec}}) (T_{\\mathrm{dec}} a(T_{\\mathrm{dec}}))^3 = g_{\\gamma} (T_{\\gamma} a(T_{\\gamma}))^3 $$\n已退耦的中微子被假定为自由流且是相对论性的。它们的熵也守恒，这意味着它们的温度与尺度因子成反比，即 $T_{\\nu} \\propto 1/a$。因此，量 $T_{\\nu} a$ 是一个常数。在退耦时，$T_{\\nu}(T_{\\mathrm{dec}}) = T_{\\mathrm{dec}}$。因此，对于之后的任何时刻，当尺度因子为 $a(T_{\\gamma})$、中微子温度为 $T_{\\nu}$ 时，我们有：\n$$ T_{\\mathrm{dec}} a(T_{\\mathrm{dec}}) = T_{\\nu} a(T_{\\gamma}) $$\n将中微子冷却关系式中的 $T_{\\mathrm{dec}} a(T_{\\mathrm{dec}})$ 代入 $\\gamma e^\\pm$ 的熵守恒方程：\n$$ g_{s,\\gamma e}(T_{\\mathrm{dec}}) (T_{\\nu} a(T_{\\gamma}))^3 = g_{\\gamma} (T_{\\gamma} a(T_{\\gamma}))^3 $$\n$$ g_{s,\\gamma e}(T_{\\mathrm{dec}}) T_{\\nu}^3 a(T_{\\gamma})^3 = g_{\\gamma} T_{\\gamma}^3 a(T_{\\gamma})^3 $$\n解出最终温度比 $T_{\\nu}/T_{\\gamma}$：\n$$ \\frac{T_{\\nu}}{T_{\\gamma}} = \\left( \\frac{g_{\\gamma}}{g_{s,\\gamma e}(T_{\\mathrm{dec}})} \\right)^{1/3} $$\n已知 $g_{\\gamma}=2$，待计算的最终表达式为：\n$$ \\frac{T_{\\nu}}{T_{\\gamma}} = \\left( \\frac{2}{g_{s,\\gamma e}(T_{\\mathrm{dec}})} \\right)^{1/3} $$\n\n**2. $g_{s,\\gamma e}(T_{\\mathrm{dec}})$ 的计算**\n\n关键任务是计算 $g_{s,\\gamma e}(T_{\\mathrm{dec}})$，该值取决于是否包含 QED 修正。\n\n**理想气体情况 (无 QED 修正):**\n理想 $\\gamma e^\\pm$ 等离子体的总熵密度为 $s_{\\gamma e}^{\\mathrm{ideal}}(T) = s_{\\gamma}(T) + s_{e^\\pm}(T)$。根据定义，$s_{\\gamma e}^{\\mathrm{ideal}}(T) = \\frac{2\\pi^2}{45} g_{s,\\gamma e}^{\\mathrm{ideal}}(T) T^3$。\n这给出：\n$$ g_{s,\\gamma e}^{\\mathrm{ideal}}(T) = \\frac{45}{2\\pi^2 T^3} \\left( s_{\\gamma}(T) + s_{e^\\pm}(T) \\right) $$\n已知 $s_{\\gamma}(T) = \\frac{2\\pi^2}{45} g_{\\gamma} T^3$，代入后变为：\n$$ g_{s,\\gamma e}^{\\mathrm{ideal}}(T) = g_{\\gamma} + \\frac{45}{2\\pi^2 T^3} s_{e^\\pm}(T) $$\n电子和正电子 ($e^\\pm$) 的熵密度由 $s_{e^\\pm}(T) = (\\rho_{e^\\pm}(T) + P_{e^\\pm}(T))/T$ 给出。能量密度 $\\rho_{e^\\pm}$ 和压强 $P_{e^\\pm}$ 由以下积分给出：\n$$ \\rho_{e^\\pm}(T) = \\frac{g_{e^\\pm}}{2 \\pi^2} T^4 I_{\\rho}(z), \\quad P_{e^\\pm}(T) = \\frac{g_{e^\\pm}}{6 \\pi^2} T^4 I_{P}(z) $$\n其中 $z=m_e/T$，无量纲积分为：\n$$ I_{\\rho}(z) = \\int_{0}^{\\infty} \\mathrm{d}y \\, \\frac{y^2 \\sqrt{y^2 + z^2}}{\\exp\\left(\\sqrt{y^2 + z^2}\\right) + 1}, \\quad I_{P}(z) = \\int_{0}^{\\infty} \\mathrm{d}y \\, \\frac{y^4/\\sqrt{y^2 + z^2}}{\\exp\\left(\\sqrt{y^2 + z^2}\\right) + 1} $$\n因此，$s_{e^\\pm}(T) = \\frac{g_{e^\\pm} T^3}{6\\pi^2} (3 I_{\\rho}(z) + I_P(z))$。将此代入 $g_{s,\\gamma e}^{\\mathrm{ideal}}$ 的表达式：\n$$ g_{s,\\gamma e}^{\\mathrm{ideal}}(T) = g_{\\gamma} + \\frac{45}{2\\pi^2 T^3} \\left( \\frac{g_{e^\\pm} T^3}{6\\pi^2} [3 I_{\\rho}(z) + I_P(z)] \\right) = g_{\\gamma} + \\frac{15 g_{e^\\pm}}{4\\pi^4} [3 I_{\\rho}(z) + I_P(z)] $$\n使用给定的值 $g_{\\gamma}=2$ 和 $g_{e^\\pm}=4$：\n$$ g_{s,\\gamma e}^{\\mathrm{ideal}}(T) = 2 + \\frac{15}{\\pi^4} [3 I_{\\rho}(m_e/T) + I_P(m_e/T)] $$\n\n**QED 修正情况:**\n问题指定了一个特定的 QED 修正拟设。修正后的熵密度为：\n$$ s_{\\gamma e}^{\\mathrm{QED}}(T) = s_{\\gamma e}^{\\mathrm{ideal}}(T) \\left[ 1 + \\left( \\frac{\\alpha}{\\pi} \\right) c_0 \\, w(T) \\right] $$\n其中 $\\alpha$ 是精细结构常数，$c_0 = -5/4$，$w(T)$ 是一个权重因子，定义为实际 $e^\\pm$ 熵密度与其超相对论形式之比：\n$$ w(T) = \\frac{s_{e^\\pm}(T)}{s_{e^\\pm}^{\\mathrm{UR}}(T)} $$\n超相对论性熵密度为 $s_{e^\\pm}^{\\mathrm{UR}}(T) = \\frac{2\\pi^2}{45} \\left(\\frac{7}{8}\\right) g_{e^\\pm} T^3$。代入熵密度的表达式：\n$$ w(T) = \\frac{\\frac{g_{e^\\pm} T^3}{6\\pi^2} [3 I_{\\rho}(z) + I_P(z)]}{\\frac{2\\pi^2}{45} \\frac{7}{8} g_{e^\\pm} T^3} = \\frac{1}{6\\pi^2} \\frac{45 \\cdot 8}{14\\pi^2} [3 I_{\\rho}(z) + I_P(z)] = \\frac{30}{7\\pi^4} [3 I_{\\rho}(z) + I_P(z)] $$\n经 QED 修正的有效自由度 $g_{s,\\gamma e}^{\\mathrm{QED}}(T)$ 由 $s_{\\gamma e}^{\\mathrm{QED}}(T) = \\frac{2\\pi^2}{45} g_{s,\\gamma e}^{\\mathrm{QED}}(T) T^3$ 定义。这直接导出：\n$$ g_{s,\\gamma e}^{\\mathrm{QED}}(T) = g_{s,\\gamma e}^{\\mathrm{ideal}}(T) \\left[ 1 + \\left( \\frac{\\alpha}{\\pi} \\right) c_0 \\, w(T) \\right] $$\n当启用 QED 修正时，这就是在 $T_{\\nu}/T_{\\gamma}$ 表达式的分母中使用的值。\n\n**3. $N_{\\mathrm{eff}}$ 的推导**\n\n有效中微子物种数 $N_{\\mathrm{eff}}$ 由以下关系式定义：\n$$ \\rho_{\\nu, \\mathrm{total}} \\equiv N_{\\mathrm{eff}} \\left(\\frac{7}{8}\\right) \\left( \\frac{4}{11} \\right)^{4/3} \\rho_{\\gamma} $$\n此处，$\\rho_{\\nu, \\mathrm{total}}$ 是所有中微子物种的总能量密度，$\\rho_{\\gamma}$ 是光子的能量密度。我们在最终状态（$T \\ll m_e$）下计算这些量。假设有 $N_{\\nu}$ 种类似标准模型的中微子（和反中微子），每种都是一个具有 $g=2$ 自由度（粒子+反粒子）的相对论性费米子气体，它们的总能量密度是：\n$$ \\rho_{\\nu, \\mathrm{total}} = N_{\\nu} \\times \\left( \\frac{7}{8} \\frac{\\pi^2}{15} T_{\\nu}^4 \\right) $$\n光子能量密度是具有 $g_{\\gamma}=2$ 的相对论性玻色子气体的能量密度：\n$$ \\rho_{\\gamma} = \\frac{\\pi^2}{15} T_{\\gamma}^4 $$\n将这些代入 $N_{\\mathrm{eff}}$ 的定义中：\n$$ N_{\\nu} \\frac{7}{8} \\frac{\\pi^2}{15} T_{\\nu}^4 = N_{\\mathrm{eff}} \\frac{7}{8} \\left( \\frac{4}{11} \\right)^{4/3} \\frac{\\pi^2}{15} T_{\\gamma}^4 $$\n解出 $N_{\\mathrm{eff}}$：\n$$ N_{\\mathrm{eff}} = N_{\\nu} \\left( \\frac{T_{\\nu}}{T_{\\gamma}} \\right)^4 \\left( \\frac{11}{4} \\right)^{4/3} $$\n该表达式使我们能够根据中微子物种数 $N_{\\nu}$ 和我们先前推导的温度比 $T_{\\nu}/T_{\\gamma}$ 来计算 $N_{\\mathrm{eff}}$。\n\n**数值计算步骤:**\n对于每个测试用例 $(T_{\\mathrm{dec}}, \\mathrm{include\\_QED}, N_{\\nu})$：\n1. 计算 $z=m_e/T_{\\mathrm{dec}}$。\n2. 使用数值积分方法数值计算积分 $I_{\\rho}(z)$ 和 $I_P(z)$。\n3. 使用其推导公式计算 $g_{s,\\gamma e}^{\\mathrm{ideal}}(T_{\\mathrm{dec}})$。\n4. 如果 `include_QED` 为真，则计算 $w(T_{\\mathrm{dec}})$，然后计算 $g_{s,\\gamma e}^{\\mathrm{QED}}(T_{\\mathrm{dec}})$。设置 $g_s = g_{s,\\gamma e}^{\\mathrm{QED}}(T_{\\mathrm{dec}})$。否则，设置 $g_s = g_{s,\\gamma e}^{\\mathrm{ideal}}(T_{\\mathrm{dec}})$。\n5. 计算温度比 $T_{\\nu}/T_{\\gamma} = (2/g_s)^{1/3}$。\n6. 使用其推导公式计算 $N_{\\mathrm{eff}}$。\n7. 四舍五入并存储结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the final neutrino-to-photon temperature ratio and the effective\n    number of neutrino species after e+- annihilation, based on entropy conservation\n    and a specified QED correction model.\n    \"\"\"\n    \n    # Constants in specified units (MeV for mass and temperature)\n    m_e = 0.51099895  # electron mass in MeV\n    alpha = 1.0 / 137.035999084  # fine-structure constant\n    g_gamma = 2.0  # photon degrees of freedom\n    g_e = 4.0  # electron+positron degrees of freedom\n    c0 = -5.0 / 4.0  # coefficient for QED correction ansatz\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (2.0, True, 3.0),\n        (2.0, False, 3.0),\n        (20.0, True, 3.0),\n        (0.3, True, 3.0),\n        (2.0, True, 2.5),\n    ]\n\n    # Memoization cache for integrals to avoid re-computation\n    integral_cache = {}\n\n    def get_thermo_integrals(z):\n        \"\"\"\n        Numerically computes and returns the thermodynamic integrals I_rho and I_p\n        for a given z = m_e/T. Uses memoization for efficiency.\n        \"\"\"\n        if z in integral_cache:\n            return integral_cache[z]\n\n        # Integrand for energy density rho\n        def integrand_rho(y, z_val):\n            # The integrand can be zero for y=0, which is fine\n            if y == 0:\n                return 0.0\n            energy_term = np.sqrt(y**2 + z_val**2)\n            # Use log-exp trick for numerical stability if energy_term is large\n            if energy_term > 700: # np.exp(709) is around max float\n                return 0.0\n            return y**2 * energy_term / (np.exp(energy_term) + 1.0)\n\n        # Integrand for pressure P\n        def integrand_p(y, z_val):\n            # Integrand is zero at y=0, avoiding division by zero\n            if y == 0:\n                return 0.0\n            energy_term = np.sqrt(y**2 + z_val**2)\n            if energy_term > 700:\n                return 0.0\n            return (y**4 / energy_term) / (np.exp(energy_term) + 1.0)\n            \n        # Perform numerical integration using scipy.integrate.quad\n        I_rho, _ = integrate.quad(integrand_rho, 0, np.inf, args=(z,))\n        I_p, _ = integrate.quad(integrand_p, 0, np.inf, args=(z,))\n        \n        integral_cache[z] = (I_rho, I_p)\n        return I_rho, I_p\n\n    results = []\n    for case in test_cases:\n        T_dec, include_QED, N_nu = case\n        \n        z = m_e / T_dec\n        \n        # 1. Compute thermodynamic integrals\n        I_rho_val, I_p_val = get_thermo_integrals(z)\n        \n        # Common term in g_s and w\n        integral_combo = 3.0 * I_rho_val + I_p_val\n\n        # 2. Compute g_s_ideal\n        # g_s_ideal = g_gamma + (15 * g_e) / (4 * pi^4) * (3*I_rho + I_p)\n        g_s_contrib_e = (15.0 * g_e) / (4.0 * np.pi**4) * integral_combo\n        g_s_ideal = g_gamma + g_s_contrib_e\n        \n        g_s_final = g_s_ideal\n        \n        # 3. Apply QED correction if requested\n        if include_QED:\n            # w(T) = (30 / (7 * pi^4)) * (3*I_rho + I_p)\n            w = (30.0 / (7.0 * np.pi**4)) * integral_combo\n            \n            # g_s_QED = g_s_ideal * [1 + (alpha/pi) * c0 * w]\n            correction_factor = 1.0 + (alpha / np.pi) * c0 * w\n            g_s_qed = g_s_ideal * correction_factor\n            g_s_final = g_s_qed\n\n        # 4. Compute final temperature ratio\n        # T_nu / T_gamma = (g_gamma / g_s_final)^(1/3)\n        T_ratio = (g_gamma / g_s_final)**(1.0 / 3.0)\n        \n        # 5. Compute effective number of neutrino species\n        # N_eff = N_nu * (T_nu/T_gamma)^4 * (11/4)^(4/3)\n        N_eff = N_nu * (T_ratio**4) * (11.0 / 4.0)**(4.0 / 3.0)\n        \n        # Append rounded results for this case\n        results.append([round(T_ratio, 6), round(N_eff, 6)])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Ex: [[0.713766,3.000000],[...]] without spaces\n    result_str = \",\".join([f\"[{res[0]},{res[1]}]\" for res in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后一项实践将重点从数值积分转向解析推导，旨在探索宇宙热状态与其基本参数之间的联系。你将使用描述复合时期电离平衡的萨哈方程，推导出自由电子分数如何响应重子密度和氦丰度的变化。这项线性响应理论的练习展示了一种强大的技术，它被用于预测宇宙学数据的约束能力，并帮助我们理解可观测量如何依赖于宇宙模型的参数 。",
            "id": "3499136",
            "problem": "考虑早期宇宙中氢复合时期，在一个固定的红移 $z_{\\star}$ 处。在该体系中，物质与辐射之间保持热力学平衡，并且氢的电离状态可以很好地由萨哈方程描述。假设在 $z_{\\star}$ 时氦已经变为中性，因此不贡献自由电子，并且光子温度随红移绝热标度，即 $T(z)=T_{0}(1+z)$，其中 $T_{0}$ 保持固定。定义相对于氢核的自由电子分数 $x_{e}(z)\\equiv n_{e}(z)/n_{H}(z)$，其中 $n_{H}(z)$ 是氢核的数密度。设原初氦质量分数为 $Y_{p}$，当今物理重子密度参数为 $\\Omega_{b}h^{2}$，相对论性中微子物种的有效数量为 $N_{\\rm eff}$。\n\n在氢的萨哈平衡体系中，电离平衡由以下形式的方程隐式给出\n$$\nF\\!\\left(x_{e};\\,n_{H},T\\right)\\equiv \\frac{x_{e}^{2}}{1-x_{e}}-\\frac{A(T)}{n_{H}}=0,\n$$\n其中 $A(T)$ 是一个已知的关于 $T$ 的函数，包含了自然常数和氢的电离能。你可以认为 $A(T)$ 除了通过其对 $T$ 的显式依赖外，不依赖于宇宙学参数，并且可以假设在所述条件下，在固定的 $z_{\\star}$ 处，$T$ 不依赖于 $\\Omega_{b}h^{2}$、$Y_{p}$ 和 $N_{\\rm eff}$。氢的数密度可以写为 $n_{H}(z)=(1-Y_{p})\\,\\bar{n}_{b}(z)$，其中重子数密度 $\\bar{n}_{b}(z)$ 正比于 $\\Omega_{b}h^{2}(1+z)^{3}$。\n\n在固定的红移 $z_{\\star}$ 处，围绕一个具有参数 $\\left\\{(\\Omega_{b}h^{2})^{\\star},\\,Y_{p}^{\\star},\\,N_{\\rm eff}^{\\star}\\right\\}$ 的基准宇宙学模型，使用线性响应（隐函数微分法），推导参数导数 $\\partial x_{e}/\\partial(\\Omega_{b}h^{2})$、$\\partial x_{e}/\\partial Y_{p}$ 和 $\\partial x_{e}/\\partial N_{\\rm eff}$ 在该基准模型下求值的闭合形式解析表达式。用基准量 $x_{e}^{\\star}\\equiv x_{e}(z_{\\star})$、$(\\Omega_{b}h^{2})^{\\star}$ 和 $Y_{p}^{\\star}$ 来表示你的最终结果，形式为一个包含这三个导数的单行矩阵。无需进行数值计算。以闭合形式的解析表达式给出最终答案。最终答案中不要包含单位。",
            "solution": "该问题陈述已经过验证，被认为是科学上合理的、问题定义良好的和自洽的。它提出了一个物理宇宙学中的标准问题，可以用既定的数学方法解决。因此，我们可以进行推导。\n\n问题的核心在于，在一个固定的红移 $z_{\\star}$ 处，自由电子分数 $x_e$ 是通过萨哈方程隐式定义的：\n$$\nF\\!\\left(x_{e};\\,n_{H},T\\right)\\equiv \\frac{x_{e}^{2}}{1-x_{e}}-\\frac{A(T)}{n_{H}}=0\n$$\n在这里，$x_e$ 通过氢的数密度 $n_H$ 成为宇宙学参数 $\\boldsymbol{\\lambda} = \\{\\Omega_b h^2, Y_p, N_{\\rm eff}\\}$ 的隐函数。在固定红移 $z_{\\star}$ 处的温度由 $T(z_{\\star}) = T_0(1+z_{\\star})$ 给出，并被假定为不依赖于这些宇宙学参数。因此，函数 $A(T)$ 也不依赖于这些参数。\n\n为了找到对于每个参数 $\\lambda_i \\in \\boldsymbol{\\lambda}$ 的导数 $\\partial x_e / \\partial \\lambda_i$，我们使用隐函数微分法。$F$ 的全微分必须为零：\n$$\ndF = \\frac{\\partial F}{\\partial x_e} dx_e + \\sum_i \\frac{\\partial F}{\\partial \\lambda_i} d\\lambda_i = 0\n$$\n由此， $x_e$ 对单个参数 $\\lambda$ 的偏导数由下式给出：\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = -\\left(\\frac{\\partial F}{\\partial x_e}\\right)^{-1} \\frac{\\partial F}{\\partial \\lambda}\n$$\n首先，我们计算 $F$ 对 $x_e$ 的偏导数：\n$$\n\\frac{\\partial F}{\\partial x_e} = \\frac{\\partial}{\\partial x_e} \\left( \\frac{x_e^2}{1-x_e} \\right) = \\frac{2x_e(1-x_e) - x_e^2(-1)}{(1-x_e)^2} = \\frac{2x_e - 2x_e^2 + x_e^2}{(1-x_e)^2} = \\frac{x_e(2-x_e)}{(1-x_e)^2}\n$$\n接下来，我们计算 $F$ 对一个泛型参数 $\\lambda$ 的偏导数。由于在固定的 $z_{\\star}$ 处，$A(T)$ 相对于这些参数是常数，所以导数只作用于 $n_H$ 项：\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( -\\frac{A(T)}{n_H} \\right) = -A(T) \\left( -\\frac{1}{n_H^2} \\right) \\frac{\\partial n_H}{\\partial \\lambda} = \\frac{A(T)}{n_H^2} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\n我们可以通过使用原始的萨哈方程 $A(T) = n_H \\frac{x_e^2}{1-x_e}$ 代入 $A(T)$ 来简化这个表达式：\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{1}{n_H^2} \\left( n_H \\frac{x_e^2}{1-x_e} \\right) \\frac{\\partial n_H}{\\partial \\lambda} = \\frac{x_e^2}{(1-x_e) n_H} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\n结合这些结果，我们得到了所需导数的通用表达式：\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = -\\left( \\frac{x_e(2-x_e)}{(1-x_e)^2} \\right)^{-1} \\left( \\frac{x_e^2}{(1-x_e) n_H} \\frac{\\partial n_H}{\\partial \\lambda} \\right) = -\\frac{(1-x_e)^2}{x_e(2-x_e)} \\frac{x_e^2}{(1-x_e)} \\frac{1}{n_H} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\n这可以简化为：\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( \\frac{1}{n_H} \\frac{\\partial n_H}{\\partial \\lambda} \\right)\n$$\n现在，我们必须确定 $n_H$ 对每个参数的依赖关系。在红移 $z$ 处的氢数密度为 $n_H(z) = (1-Y_p)\\bar{n}_b(z)$，其中总重子数密度 $\\bar{n}_b(z)$ 正比于 $\\Omega_b h^2 (1+z)^3$。设比例常数为 $C_{\\rho}$，则有 $\\bar{n}_b(z) = C_{\\rho} (\\Omega_b h^2) (1+z)^3$。在我们的固定红移 $z_{\\star}$ 处，我们可以写出：\n$$\nn_H = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) (\\Omega_b h^2)\n$$\n现在我们可以计算 $n_H$ 对每个参数的对数导数。\n\n1.  **对 $\\Omega_b h^2$ 的导数：**\n    $n_H$ 对 $\\Omega_b h^2$ 的偏导数是：\n    $$\n    \\frac{\\partial n_H}{\\partial (\\Omega_b h^2)} = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) = \\frac{n_H}{\\Omega_b h^2}\n    $$\n    因此，对数导数为 $\\frac{1}{n_H} \\frac{\\partial n_H}{\\partial (\\Omega_b h^2)} = \\frac{1}{\\Omega_b h^2}$。\n    将此代入我们关于 $\\partial x_e/\\partial\\lambda$ 的通用表达式：\n    $$\n    \\frac{\\partial x_e}{\\partial (\\Omega_b h^2)} = - \\frac{x_e(1-x_e)}{2-x_e} \\frac{1}{\\Omega_b h^2}\n    $$\n\n2.  **对 $Y_p$ 的导数：**\n    $n_H$ 对 $Y_p$ 的偏导数是：\n    $$\n    \\frac{\\partial n_H}{\\partial Y_p} = C_{\\rho} (1+z_{\\star})^3 (\\Omega_b h^2) (-1) = -\\frac{n_H}{1-Y_p}\n    $$\n    因此，对数导数为 $\\frac{1}{n_H} \\frac{\\partial n_H}{\\partial Y_p} = -\\frac{1}{1-Y_p}$。\n    将此代入我们的通用表达式：\n    $$\n    \\frac{\\partial x_e}{\\partial Y_p} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( -\\frac{1}{1-Y_p} \\right) = \\frac{x_e(1-x_e)}{(2-x_e)(1-Y_p)}\n    $$\n\n3.  **对 $N_{\\rm eff}$ 的导数：**\n    根据问题陈述，$n_H = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) (\\Omega_b h^2)$ 的表达式不依赖于 $N_{\\rm eff}$。问题还指出，在固定红移 $z_{\\star}$ 处的温度 $T$ 也不依赖于 $N_{\\rm eff}$。因此，在指定的模型内，在固定红移 $z_{\\star}$ 处的 $x_e$ 不依赖于 $N_{\\rm eff}$。\n    形式上，\n    $$\n    \\frac{\\partial n_H}{\\partial N_{\\rm eff}} = 0\n    $$\n    这意味着：\n    $$\n    \\frac{\\partial x_e}{\\partial N_{\\rm eff}} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( \\frac{1}{n_H} \\cdot 0 \\right) = 0\n    $$\n\n最后，我们在基准宇宙学模型下对这些表达式求值，将参数替换为其基准值（用上标 $\\star$ 表示）：\n$$\n\\left. \\frac{\\partial x_e}{\\partial (\\Omega_b h^2)} \\right|_{\\star} = - \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(\\Omega_b h^2)^{\\star}}\n$$\n$$\n\\left. \\frac{\\partial x_e}{\\partial Y_p} \\right|_{\\star} = \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(1-Y_p^{\\star})}\n$$\n$$\n\\left. \\frac{\\partial x_e}{\\partial N_{\\rm eff}} \\right|_{\\star} = 0\n$$\n问题要求最终结果为一个包含这三个导数的单行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} - \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(\\Omega_b h^2)^{\\star}}  \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(1-Y_p^{\\star})}  0 \\end{pmatrix}}\n$$"
        }
    ]
}