## 应用与跨学科连接

在前面的章节中，我们已经深入探讨了树形码中[多极展开](@entry_id:144850)和单元开启判据的基本原理与机制。这些工具为在宇宙学尺度上高效计算[引力](@entry_id:175476)相互作用提供了坚实的基础。然而，这些概念的真正威力在于它们在不同应用场景下的灵活性、[可扩展性](@entry_id:636611)以及与其他物理和计算领域的深刻联系。本章旨在揭示这些核心原理在多样化、跨学科背景下的实际应用，从而展示它们作为一种强大理论框架的普适性。

我们的讨论将超越理想化的静态牛顿引力，探索如何在膨胀宇宙、高性能[并行计算](@entry_id:139241)、[多物理场耦合](@entry_id:171389)仿真以及[引力](@entry_id:175476)理论的替代理论中应用和推广这些方法。通过分析一系列具体问题，我们将阐明多极方法不仅是一种计算捷径，更是一种能够连接理论、观测和[数值模拟](@entry_id:137087)的深刻见解。

### 核心应用：[宇宙学N体模拟](@entry_id:747920)

多极展开和单元开启判据在宇宙学中的最直接和基础的应用，是在一个膨胀的宇宙背景下模拟物质的[引力](@entry_id:175476)凝聚。为了正确处理[宇宙膨胀](@entry_id:161474)带来的影响，[数值模拟](@entry_id:137087)通常在[共动坐标系](@entry_id:266800)（comoving coordinates）$\boldsymbol{x}$中进行，物理坐标$\boldsymbol{r}$通过尺度因子$a(t)$与[共动坐标](@entry_id:271238)关联，即$\boldsymbol{r} = a(t)\boldsymbol{x}$。

在这种[坐标系](@entry_id:156346)下，质点的运动方程、[引力势](@entry_id:160378)所满足的[泊松方程](@entry_id:143763)以及[引力](@entry_id:175476)加速的计算都必须进行相应的变换。一个粒子的运动方程包含一个由哈勃阻力（Hubble drag）引起的项$2(\dot{a}/a)\dot{\boldsymbol{x}}$，而来自[密度涨落](@entry_id:143540)的特殊[引力](@entry_id:175476)（peculiar gravity）则受到[尺度因子](@entry_id:266678)的调节。具体来说，特殊引力势$\phi$在[共动坐标](@entry_id:271238)下的[泊松方程](@entry_id:143763)变为$\boldsymbol{\nabla}_x^2 \phi = 4\pi G a^2 (\rho - \bar{\rho})$，其中$\rho$和$\bar{\rho}$分别是局部和平均物理密度。最终，施加在共[动粒](@entry_id:146562)子上的加速度项变为$-\frac{1}{a^2}\boldsymbol{\nabla}_x \phi$。

在树形码中应用[多极展开](@entry_id:144850)时，这些尺度因子的依赖性必须被精确地整合。例如，一个远场单元对目标[粒子产生](@entry_id:158755)的多极引力势，其计算需要在共动单位下进行，并包含一个$1/a$的缩放因子。这意味着，当计算最终的加速度时，力的梯度项会附带一个$G/a^3$的整体缩放。同样，[多极矩](@entry_id:191120)（如[四极矩张量](@entry_id:269661)$Q_{\alpha\beta}$）也应在[共动坐标](@entry_id:271238)下定义。单元开启判据（MAC），如$s/R  \theta$（其中$s$是单元的共动尺寸，$R$是[共动距离](@entry_id:158059)），其形式在[共动坐标](@entry_id:271238)下保持不变，因为它是一个无量纲的比率。

此外，为了避免在小距离上出现[引力](@entry_id:175476)奇异性，几乎所有[N体模拟](@entry_id:157492)都引入了[引力软化](@entry_id:146273)（gravitational softening）。常用的Plummer软化将[牛顿引力](@entry_id:159796)势核$1/r$替换为$-G m/\sqrt{r^2 + \epsilon^2}$，其中$\epsilon$是[软化长度](@entry_id:755011)。这种修改深刻影响了多极展开的收敛性。对于软化[引力](@entry_id:175476)，展开的自然无量纲参数变为$r/\sqrt{R^2+\epsilon^2}$，其中$R$是目标点与单元中心的距离，$r$是单元内源点到单元中心的距离。收敛的条件因此放宽为$r^2  R^2+\epsilon^2$。这意味着，对于一个大小为$s$的单元，保证收敛所需的最小距离从[牛顿引力](@entry_id:159796)的$R > s$减小为$R > \sqrt{s^2-\epsilon^2}$（当$s > \epsilon$时）。相应地，基于截断误差的MAC也必须针对软化势进行重新推导，这使得在给定的精度要求下，代码可以接受更近的单元，从而提高[计算效率](@entry_id:270255)。

### 天体物理探测与诊断

一旦[引力场](@entry_id:169425)可以通过多极方法高效计算，我们便能利用它来研究丰富的天体物理现象。一个重要的应用是分析作用在延展天体（如矮星系或星团）上的[潮汐力](@entry_id:159188)（tidal forces），这对于理解星系[并合](@entry_id:147963)、卫星星系剥离和[暗物质子结构](@entry_id:748170)演化至关重要。

多极展开不仅提供了质心[引力](@entry_id:175476)加速度，还允许我们直接计算[引力场](@entry_id:169425)的[二阶导数](@entry_id:144508)，即[潮汐张量](@entry_id:755970)$T_{ij} = -\partial_i \partial_j \Phi$。[潮汐张量](@entry_id:755970)的[本征值](@entry_id:154894)和[本征向量](@entry_id:151813)描述了局部[引力场](@entry_id:169425)的拉伸和压缩特性。例如，考虑一个子结构经过一个由树形码单元近似的大质量天体附近，我们可以通过对多极势（包括单极和四极项）求[二阶偏导数](@entry_id:635213)来估计该子结构所感受到的[潮汐张量](@entry_id:755970)。其[本征值](@entry_id:154894)将依赖于子结构与单元中心的距离$r$以及单元的质量$M$和[四极矩](@entry_id:157717)$Q_{ij}$。例如，沿着主轴方向的[潮汐力](@entry_id:159188)会同时受到$GM/r^3$的单极项和$GQ_{ii}/r^5$的四极项的贡献。通过分析这些[本征值](@entry_id:154894)，我们可以评估[潮汐力](@entry_id:159188)是否强大到足以将子结构撕裂，即所谓的[潮汐剥离](@entry_id:160026)（tidal stripping）。

### 先进算法设计与优化

为了在现代超级计算机上进行亿万乃至万亿粒子规模的模拟，算法的效率和[可扩展性](@entry_id:636611)至关重要。多极方法和MAC的设计直接关系到这些性能指标。

**[并行计算](@entry_id:139241)与通信**

在[分布式内存](@entry_id:163082)的并行计算环境中，模拟区域被分解为多个[子域](@entry_id:155812)，每个处理器负责一个子域。这种分解给MAC的正确实施带来了挑战。当一个处理器上的目标粒子靠近另一个处理器所管辖的区域边界时，它无法仅凭邻近处理器的质心信息来安全地应用MAC，因为真实的最短距离可能远小于到质心的距离。为保证计算的正确性，必须采用保守的策略。两种标准方法是：
1.  **分层树交换**：每个处理器将其整个区域视为一个顶层节点，并计算一个能完全包围其所有粒子的边界体积（如边界球）。这些顶层节点的信息（质量、多极矩、边界体积）通过全体通信（all-to-all communication）广播给所有处理器。这样，每个处理器都拥有一个描述全局粗粒度[质量分布](@entry_id:158451)的“顶层树”。在计算远程相互作用时，首先根据这个保守的顶层树进行MAC测试。如果测试失败，则向该节点的所属处理器请求更深层次的子节点信息，从而实现远程树遍历。
2.  **基于[空间填充曲线](@entry_id:161184)的全局树**：一种更精巧的方法是利用[空间填充曲线](@entry_id:161184)（如Morton或Hilbert曲线）对粒子进行排序和分区。这自然地定义了一个全局共享的树结构。处理器可以构建并广播一个固定深度的顶层树，每个顶层单元都带有保守的边界信息。

这两种方法都确保了在跨处理器边界进行MAC决策时，单元尺寸$s$不会被低估，距离$d$不会被高估，从而保证了[误差控制](@entry_id:169753)的严谨性。

并行计算的性能瓶颈往往在于通信而非计算。MAC的设计会影响[通信开销](@entry_id:636355)。例如，一个纯粹基于几何的Barnes-Hut (BH) MAC ($s/d  \theta$)，在请求远程计算时，只需发送目标粒子的位置信息。然而，更复杂的“力基”MAC可能需要根据目标粒子当前受到的总加速度$|a_i|$来调整开启判据，以实现更均匀的相对力误差。这就要求在通信时额外发送$|a_i|$这个标量。虽然这增加了每个消息的数据量，但如果更智能的MAC能够减少需要打开的单元总数（即减少交互次数），总体性能可能会更高。量化这种[通信开销](@entry_id:636355)的增加——例如，比较两种MAC下每次交互所需传输的字节数——是评估算法性能的关键一步。

**性能权衡与自适应方法**

包含更高阶多极矩（如四极矩）可以提高近似的精度，从而允许使用更大的开启角$\theta$来满足给定的误差容限$\varepsilon$。更大的$\theta$意味着更少的单元需要被打开，即直接的粒子-粒子相互作用次数减少。然而，计算[高阶矩](@entry_id:266936)本身以及它们产生的力都需要更多的浮点运算。这引出了一个经典的成本效益分析：对于给定的目标精度$\varepsilon$，是使用廉价但需要小$\theta$的单极近似更优，还是使用昂贵但允许大$\theta$的四极近似更优？

通过分析误差与$\theta$的[标度关系](@entry_id:273705)（单极误差$\sim \theta^2$，四极误差$\sim \theta^3$）以及相互作用次数与$\theta$的关系（$\sim \theta^{-3}$），可以推导出两种方法总计算成本随目标精度$\varepsilon$的变化关系。存在一个临界精度$\varepsilon_c$，当目标精度高于此值时，使用高阶展开更高效；反之，则低阶展开更优。这个$\varepsilon_c$的值取决于单极和四极计算的相对运算成本。

在所谓的“变焦模拟”（zoom simulations）中，研究者只对宇宙中的一小块区域（如一个[星系团](@entry_id:160919)的形成区域）感兴趣，并希望在该区域达到极高的分辨率，而外部区域则可以用较低的分辨率模拟。这启发了自适应MAC的设计。程序可以根据目标粒子是否位于预定义的“变焦区域”内，来动态调整MAC的参数。对于区域内的粒子，采用更严格的开启角$\theta_{\text{in}}$和更高阶的[多极展开](@entry_id:144850)（如$\ell=2$四极项），以确保高精度；对于区域外的粒子，则使用更宽松的$\theta_{\text{out}}$和更低阶的展开（如$\ell=0$单极项）。这种自适应策略可以将计算资源精确地投放到最关键的区域，有效研究子结构的精细[轨道](@entry_id:137151)和潮汐特征的演化。

**时间步长与MAC的协同设计**

数值模拟的精度不仅取决于空间上的力计算误差，还取决于时间积分误差。理想情况下，这两种误差应该处于同一量级。一个不恰当的MAC可能导致力计算误差远大于[时间积分](@entry_id:267413)误差，使得减小时间步长的努力变得徒劳。因此，MAC和时间步长判据需要协同设计。

一种常见的时间步长判据是$\Delta t  \eta \sqrt{\epsilon/|\boldsymbol{a}|}$，其中$\eta$是无量纲常数，$\epsilon$是[引力软化](@entry_id:146273)长度，$|\boldsymbol{a}|$是[粒子加速](@entry_id:158202)度。这个判据保证了时间步长能解析高加速度区域的动力学。我们可以要求，由[多极展开](@entry_id:144850)截断误差$\delta\boldsymbol{a}_{\text{MP}}$在一个时间步内引起的位移误差$\delta x_{\text{MP}} \approx \frac{1}{2}|\delta\boldsymbol{a}_{\text{MP}}|(\Delta t)^2$，不应超过由总加速度$\boldsymbol{a}$在同一时间步内引起的[特征位移](@entry_id:140262)$\delta x_{\text{int}} = \frac{1}{2}|\boldsymbol{a}|(\Delta t)^2$的某个小分数$\beta$。通过建立这个不等式，并将多极误差的[标度关系](@entry_id:273705)$|\delta\boldsymbol{a}_{\text{MP}}| \le C f \theta^q |\boldsymbol{a}|$代入（其中$C, f, q$为相关参数），可以导出一个关于最大允许开启角$\theta_{\max}$的表达式。这个$\theta_{\max}$将依赖于精度参数$\beta$，而不依赖于粒子局部的加速度或时间步长。这提供了一个鲁棒的、与[时间积分](@entry_id:267413)方案相协调的MAC设计原则。

### 耦合[引力](@entry_id:175476)与其他物理过程

现代宇宙学模拟越来越多地包含除[引力](@entry_id:175476)之外的复杂物理过程，如气体动力学和[恒星反馈](@entry_id:755431)。多极方法和MAC可以被巧妙地扩展，以适应这些多物理场环境。

**气体[动力学与[热力](@entry_id:138039)学耦合](@entry_id:170539)**

在包含气体的模拟中，力的精度对[气体动力学](@entry_id:147692)的影响尤为重要，特别是在冷而稠密的区域。在这些区域，声速$c_s$很低，因此当地的声学过顶时间$t_s = h/c_s$（其中$h$是分辨率尺度）相对较长。这意味着即使很小的力误差也有足够的时间来显著影响气体流动，可能导致非物理的破碎或加热。

为了应对这一挑战，可以将MAC与局部的[气体热力学](@entry_id:151144)状态耦合起来。其核心思想是，在声速较低（即温度$T$较低）的区域，对[引力](@entry_id:175476)精度的要求应该更高。我们可以要求，由多极[截断误差](@entry_id:140949)在一个[声学](@entry_id:265335)过顶时间内造成的位移误差，必须小于分辨率尺度$h$的一个小分数$\epsilon$。这个物理要求最终可以转化为一个依赖于温度的有效开启角$\theta_{\text{eff}}(T)$。推导表明，$\theta_{\text{eff}}(T) \propto T^{1/3}$。这意味着在$100\,\text{K}$的冷气体中，开启判据会比在$10^6\,\text{K}$的热气体中严格得多，从而自动在物理上最敏感的区域加强[引力](@entry_id:175476)计算的精度。

**预测性MAC与重子反馈**

[恒星形成](@entry_id:159940)、超[新星爆发](@entry_id:160050)或[活动星系核](@entry_id:158029)（AGN）等重子反馈过程，会在极短的时间内向周围[气体注入](@entry_id:749726)大量能量，导致剧烈的气体外流（blowout）。这种快速的质量重新[分布](@entry_id:182848)会瞬间改变树形码单元的[多极矩](@entry_id:191120)。一个静态的MAC，如果其参数是在反馈事件之前确定的，可能无法捕捉到这种剧变，导致在接下来的时间步中出现巨大的力计算误差。

为了解决这个问题，可以设计一种“预测性”MAC。该判据不仅考虑当前的几何构型（$s/r$），还估算即将发生的反馈事件可能对[多极矩](@entry_id:191120)造成多大的改变。例如，通过一个简化的能量模型，可以估算有多少气体质量$M_{\text{gas}}$将被吹出单元。然后，可以估算这一质量损失将导致四极矩发生多大的变化，进而估算它将产生多大的额外力误差。如果这个“预测误差”超过了某个阈值$\varepsilon_{\text{pred}}$，即使当前的几何和静态[误差指标](@entry_id:173250)都满足条件，也应强制打开该单元。这种预测性方法使得树形码能够主动适应由剧烈重子物理驱动的快速演化，提高了模拟的鲁棒性。

### 连接到更广阔的宇宙学理论与观测

多极方法不仅是数值工具，它还可以与宇宙学的解析理论和观测现象建立深刻的联系。

**大尺度结构与各向异性MAC**

宇宙中的物质并非[均匀分布](@entry_id:194597)，而是在[引力](@entry_id:175476)作用下形成了由星系团、纤维状结构（filaments）和巨洞（voids）构成的“宇宙网”。这种大尺度结构的形成在早期阶段可以通过[泽尔多维奇近似](@entry_id:139227)（Zel'dovich approximation）很好地描述。在该近似下，初始的微小[密度扰动](@entry_id:159546)会演化，其局部变形由大尺度[潮汐张量](@entry_id:755970)$T_{ij}$的[本征值](@entry_id:154894)$\lambda_i$决定。物质会优先沿着[潮汐张量](@entry_id:755970)最小压缩（或最大拉伸）的本征方向塌缩，形成薄饼和纤维。

这意味着，一个初始为立方体的物质单元，在演化后会变成一个沿宇宙网方向被拉长的[椭球体](@entry_id:165811)。一个标准的、各向同性的MAC（如$s/r  \theta$）没有考虑这种结构的各向异性，可能会在沿着纤维方向产生较大的误差。一种更先进的方法是利用[潮汐张量](@entry_id:755970)的信息来构建一个各向异性的开启判据$\Theta(\hat{\mathbf{n}})$。这个判据通过将演化后的[椭球体](@entry_id:165811)单元投影到观测方向$\hat{\mathbf{n}}$上来计算其[视大小](@entry_id:195896)，然后与距离$r$比较。由于[椭球体](@entry_id:165811)在长轴方向的投影最大，该判据自然地会在沿着纤维的方向变得更严格，从而有针对性地抑制这些方向上的力误差，使数值方法与[大尺度结构](@entry_id:158990)理论更加协调一致。

**[引力透镜](@entry_id:159000)**

宇宙中的[质量分布](@entry_id:158451)不仅通过[引力](@entry_id:175476)吸[引物](@entry_id:192496)质，还会使穿过其附近的光线发生偏折，这种现象称为引力透镜。对于[弱引力透镜](@entry_id:158468)，其偏折角$\boldsymbol{\alpha}$可以通过对一个二维投影引力势$\Psi$求梯度得到，即$\boldsymbol{\alpha} = \nabla_{\perp}\Psi$。计算偏折角的积分核与二维[引力](@entry_id:175476)问题类似，形式为$(\boldsymbol{x} - \boldsymbol{x}')/|\boldsymbol{x} - \boldsymbol{x}'|^2$。

这意味着，我们可以将在[三维引力](@entry_id:138585)计算中发展的树形码和多极展开技术，经过修改后应用于计算引力透镜效应。此时，我们需要构建一个二维的[四叉树](@entry_id:753916)（quadtree），并针对二维的偏折角积分核推导多极展开和误差估计。MAC的设计目标不再是控制三维力的误差，而是直接控制二维偏折角$\boldsymbol{\alpha}$的误差。通过这种方式，树形码成为连接理论物质[分布](@entry_id:182848)与可观测透镜效应的强大工具，能够快速地为大规模巡天调查数据生成模拟透镜图。

### 其他物理领域的延伸与类比

[多极展开](@entry_id:144850)方法的普适性体现在它可以被应用于求解任何由$1/r$类型格林函数描述的[场论](@entry_id:155241)问题，这使其在物理学的许多其他分支中都有用武之地。

**替代[引力](@entry_id:175476)理论**

[标准宇宙学模型](@entry_id:159833)基于牛顿/爱因斯坦[引力](@entry_id:175476)。然而，为了解释暗能量等现象，物理学家提出了多种[修正引力理论](@entry_id:161607)。其中一类理论引入了带有质量的[引力](@entry_id:175476)子，导致[引力势](@entry_id:160378)在短距离上变为[汤川势](@entry_id:139645)（Yukawa potential）的形式：$\phi(r) = -G m \exp(-kr)/r$，其中$k$是与[引力子质量](@entry_id:265263)相关的筛选尺度。

[多极展开](@entry_id:144850)的整个数学框架可以为这种新的[引力](@entry_id:175476)核重新推导。展开的各阶项（单极、偶极、四极）将包含依赖于$k$的指数衰减因子。相应地，[截断误差](@entry_id:140949)的估计和MAC的设计也必须进行修改。例如，一个[误差控制](@entry_id:169753)的MAC $s/d \le \theta_{\text{eff}}$，其有效开启角$\theta_{\text{eff}}$将不仅依赖于精度要求$\varepsilon$，还将是$kd$的函数。当$kd \gg 1$时，[引力](@entry_id:175476)被强烈筛选，远场的贡献迅速减小，MAC会变得非常宽松。这种推广展示了多极方法作为一种数学工具的强大适应性，使其能够用于检验和约束[超越标准模型](@entry_id:161067)的新物理。

**[静磁学](@entry_id:140120)类比**

[静磁学](@entry_id:140120)提供了另一个深刻的类比。在[库仑规范](@entry_id:273044)（Coulomb gauge）下，[磁矢量势](@entry_id:141246)$\boldsymbol{A}$由电流密度$\boldsymbol{J}$通过一个与[引力](@entry_id:175476)完全相同的$1/r$积分核产生：$\boldsymbol{A}(\boldsymbol{r}) \propto \int \boldsymbol{J}(\boldsymbol{r}')/|\boldsymbol{r}-\boldsymbol{r}'| d^3\boldsymbol{r}'$。这表明，树形码可以被用来高效计算复杂电流[分布](@entry_id:182848)产生的[磁场](@entry_id:153296)。

然而，这个类比也揭示了深刻的差异，这些差异反过来又加深了我们对[引力](@entry_id:175476)情况的理解。
1.  **源的性质**：[引力](@entry_id:175476)的源是标量（质量密度$\rho$），而[磁场](@entry_id:153296)的源是矢量（电流密度$\boldsymbol{J}$）。
2.  **主导多极矩**：对于局域化的、满足电荷守恒的电流[分布](@entry_id:182848)，其磁[单极矩](@entry_id:267768)$\int \boldsymbol{J} d^3\boldsymbol{r}'$恒为零。因此，[磁场](@entry_id:153296)的远场行为由磁偶极矩$\boldsymbol{m} = \frac{1}{2}\int \boldsymbol{r}' \times \boldsymbol{J} d^3\boldsymbol{r}'$主导，其[势场](@entry_id:143025)$|\boldsymbol{A}|$以$1/r^2$的速度衰减。这与[引力场](@entry_id:169425)由$1/r$的单极项主导形成鲜明对比。
3.  **MAC设计**：由于[主导项](@entry_id:167418)是偶极子，MAC的设计必须考虑更高阶的[四极矩](@entry_id:157717)与偶极矩的比值，而非与[单极矩](@entry_id:267768)的比值。这使得纯几何的MAC（如$s/r  \theta$）效果更差，因为力矩的比值与电流的具体构型密切相关。
4.  **规范自由度**：矢量势$\boldsymbol{A}$是依赖于规范选择的，而[物理可观测量](@entry_id:154692)是[磁感应强度](@entry_id:144179)$\boldsymbol{B}=\nabla \times \boldsymbol{A}$。因此，一个更鲁棒的MAC应该致力于控制物理量$\boldsymbol{B}$的误差（即$|\nabla \times \Delta\boldsymbol{A}|$），而非规范依赖量$\boldsymbol{A}$的误差（$|\Delta\boldsymbol{A}|$）。

### 在层级方法中的定位：BH 与 FMM

本章主要讨论的树形码方法通常指的是Barnes-Hut (BH)算法。BH算法使用简单、启发式的几何MAC（$s/r  \theta$），易于实现且在[宇宙学模拟](@entry_id:747928)中非常有效。然而，从数学上讲，它不是一个具有严格[误差控制](@entry_id:169753)的算法。

[快速多极子方法](@entry_id:140932)（Fast Multipole Method, FMM）是另一种基于树形结构的层级算法，它提供了严格的、可分析的[误差界](@entry_id:139888)。与BH直接计算粒子与[远场](@entry_id:269288)单元的相互作用不同，FMM引入了更复杂的“算子翻译”步骤。它首先将一个大单元的[多极展开](@entry_id:144850)（M-expansion）“翻译”成围绕另一个[远场](@entry_id:269288)单元中心的局域展开（L-expansion），然后再将多个源的局域展开叠加，最后通过局域展开计算对目标粒[子群](@entry_id:146164)的作用。

FMM的“接受”判据不是一个简单的几何比率，而是基于[多极展开](@entry_id:144850)截断误差的解析表达式。例如，对于一个$p$阶展开，其[相对误差](@entry_id:147538)大致以$(s/r)^{p+1}$的速度衰减。FMM通过要求这个[估计误差](@entry_id:263890)小于用户设定的精度$\epsilon$来决定是否接受一个相互作用，从而实现了对计算精度的严格控制。在某些参数下，FMM的判据可能比BH更严格，而在另一些情况下则可能更宽松，这取决于用户对$\theta$（BH）和$p, \epsilon$（FMM）的选择。

总而言之，BH算法可以被看作是FMM思想的一个简化和实用化的版本，它牺牲了严格的[误差控制](@entry_id:169753)，换取了实现的简洁性和在许多应用中的出色性能。理解BH方法的原理和应用，是通向更高级层级方法（如FMM）的重要阶梯。