{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of any gravitational simulation is the calculation of forces from a given mass distribution. This practice provides a foundational exercise in solving the Poisson equation for a simple, yet cosmologically relevant, single-mode density perturbation within a periodic domain. Mastering this analytical calculation is the first step toward understanding the \"Poisson\" part of the Vlasov-Poisson system and how numerical codes compute gravitational fields on a mesh .",
            "id": "3500379",
            "problem": "Consider a collisionless matter distribution evolving under the Vlasov-Poisson system in a three-dimensional cubic periodic domain of comoving side length $L$, with periodic boundary conditions on all faces. Let the comoving spatial coordinate be $\\boldsymbol{x}=(x,y,z)$ and the comoving wave number $k$ be an allowed Fourier mode in the box, i.e., $k=2\\pi n/L$ for some integer $n\\neq 0$. The total mass density is $\\rho(\\boldsymbol{x})=\\bar{\\rho}\\,[1+\\delta(\\boldsymbol{x})]$, where $\\bar{\\rho}$ is the homogeneous background density and $\\delta(\\boldsymbol{x})$ is the density contrast. Suppose the density contrast is a single-mode perturbation given by $\\delta(\\boldsymbol{x})=\\sin(kx)$, which depends only on $x$ and is independent of $y$ and $z$.\n\nIn comoving coordinates, the peculiar gravitational potential $\\phi(\\boldsymbol{x})$ is defined to satisfy the Newtonian Poisson equation for the density perturbation,\n$$\n\\nabla^{2}\\phi(\\boldsymbol{x})=4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\delta(\\boldsymbol{x}),\n$$\nwhere $G$ is the gravitational constant and $a$ is the cosmological scale factor at the time of interest. The peculiar gravitational acceleration field that enters the collisionless Vlasov (phase-space) dynamics is\n$$\n\\boldsymbol{a}(\\boldsymbol{x})=-\\frac{1}{a}\\,\\nabla\\phi(\\boldsymbol{x}).\n$$\nImpose periodic boundary conditions on $\\phi(\\boldsymbol{x})$ consistent with the box, and fix the residual gauge freedom by requiring the spatial mean of $\\phi$ over the box to vanish. Starting only from the above definitions and laws, determine the closed-form expressions for the peculiar gravitational potential $\\phi(\\boldsymbol{x})$ and the peculiar gravitational acceleration components $a_{x}(\\boldsymbol{x})$, $a_{y}(\\boldsymbol{x})$, and $a_{z}(\\boldsymbol{x})$, expressed in terms of $G$, $\\bar{\\rho}$, $a$, $k$, and $x$.\n\nYour final answer must be a single closed-form analytic expression. If you present multiple components, write them as entries of a single row matrix using the $\\mathrm{pmatrix}$ environment. No numerical approximation or rounding is required.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of Newtonian cosmology, is well-posed with a complete set of equations and boundary conditions, and is expressed in objective, formal language. We proceed with the solution.\n\nThe peculiar gravitational potential $\\phi(\\boldsymbol{x})$ is determined by the Poisson equation in comoving coordinates:\n$$\n\\nabla^{2}\\phi(\\boldsymbol{x}) = 4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\delta(\\boldsymbol{x})\n$$\nThe density contrast $\\delta(\\boldsymbol{x})$ is given as a single-mode perturbation depending only on the coordinate $x$:\n$$\n\\delta(\\boldsymbol{x}) = \\sin(kx)\n$$\nSubstituting this into the Poisson equation gives:\n$$\n\\nabla^{2}\\phi(\\boldsymbol{x}) = 4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\sin(kx)\n$$\nThe Laplacian operator is $\\nabla^{2} = \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}} + \\frac{\\partial^{2}}{\\partial z^{2}}$. Since the source term on the right-hand side is a function of $x$ only, we can seek a solution that also depends only on $x$, i.e., $\\phi(\\boldsymbol{x}) = \\phi(x)$. Under this ansatz, the partial derivatives with respect to $y$ and $z$ vanish, $\\frac{\\partial^{2}\\phi}{\\partial y^{2}} = 0$ and $\\frac{\\partial^{2}\\phi}{\\partial z^{2}} = 0$. The Poisson equation simplifies to an ordinary differential equation (ODE):\n$$\n\\frac{d^{2}\\phi}{dx^{2}} = 4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\sin(kx)\n$$\nWe can solve this ODE by integrating twice with respect to $x$. The first integration yields:\n$$\n\\frac{d\\phi}{dx} = \\int 4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\sin(kx)\\,dx = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx) + C_{1}\n$$\nwhere $C_{1}$ is the first constant of integration. Integrating a second time gives the general solution for $\\phi(x)$:\n$$\n\\phi(x) = \\int \\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx) + C_{1}\\right)dx = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{1}x + C_{2}\n$$\nwhere $C_{2}$ is the second constant of integration.\n\nWe must now use the boundary and normalization conditions to determine the constants $C_{1}$ and $C_{2}$.\nFirst, we apply the periodic boundary condition, which requires $\\phi(\\boldsymbol{x})$ to be periodic over the cubic box of side length $L$. Since our solution depends only on $x$, this means $\\phi(x+L) = \\phi(x)$.\n$$\n-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(k(x+L)) + C_{1}(x+L) + C_{2} = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{1}x + C_{2}\n$$\nThe wave number $k$ is an allowed Fourier mode, given by $k = \\frac{2\\pi n}{L}$ for some non-zero integer $n$. Thus, $kL = 2\\pi n$. The sine term is periodic: $\\sin(k(x+L)) = \\sin(kx + kL) = \\sin(kx + 2\\pi n) = \\sin(kx)$. The equation simplifies to:\n$$\n-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{1}x + C_{1}L + C_{2} = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{1}x + C_{2}\n$$\nThis reduces to $C_{1}L = 0$. Since the box size $L$ is non-zero, we must have $C_{1}=0$. The solution for the potential is now of the form:\n$$\n\\phi(x) = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{2}\n$$\nNext, we apply the condition that the spatial mean of the potential over the volume of the box $V=L^{3}$ is zero: $\\langle \\phi \\rangle = 0$.\n$$\n\\langle \\phi \\rangle = \\frac{1}{L^{3}}\\int_{0}^{L}\\int_{0}^{L}\\int_{0}^{L} \\phi(x) \\,dx\\,dy\\,dz = 0\n$$\nSince $\\phi(x)$ does not depend on $y$ or $z$, the integration over these coordinates is trivial:\n$$\n\\frac{1}{L^{3}} \\left( \\int_{0}^{L} dy \\right) \\left( \\int_{0}^{L} dz \\right) \\left( \\int_{0}^{L} \\phi(x) \\,dx \\right) = \\frac{L^{2}}{L^{3}} \\int_{0}^{L} \\phi(x) \\,dx = \\frac{1}{L} \\int_{0}^{L} \\phi(x) \\,dx = 0\n$$\nSubstituting the expression for $\\phi(x)$:\n$$\n\\frac{1}{L} \\int_{0}^{L} \\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{2}\\right) dx = 0\n$$\n$$\n-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}L} \\int_{0}^{L} \\sin(kx)\\,dx + \\frac{1}{L} \\int_{0}^{L} C_{2}\\,dx = 0\n$$\nThe first integral is zero because $k = 2\\pi n/L$ and $n \\neq 0$:\n$$\n\\int_{0}^{L}\\sin\\left(\\frac{2\\pi n}{L}x\\right)dx = \\left[-\\frac{L}{2\\pi n}\\cos\\left(\\frac{2\\pi n}{L}x\\right)\\right]_{0}^{L} = -\\frac{L}{2\\pi n}(\\cos(2\\pi n) - \\cos(0)) = -\\frac{L}{2\\pi n}(1-1) = 0\n$$\nThe second integral is $\\int_{0}^{L} C_{2}\\,dx = C_{2}L$. The mean-value equation thus becomes:\n$$\n0 + \\frac{1}{L}(C_{2}L) = C_{2} = 0\n$$\nTherefore, both integration constants are zero, and the unique solution for the peculiar gravitational potential is:\n$$\n\\phi(\\boldsymbol{x}) = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx)\n$$\nNow, we determine the peculiar gravitational acceleration field $\\boldsymbol{a}(\\boldsymbol{x})$:\n$$\n\\boldsymbol{a}(\\boldsymbol{x}) = -\\frac{1}{a}\\nabla\\phi(\\boldsymbol{x})\n$$\nWe need to compute the gradient of $\\phi(\\boldsymbol{x})$. Since $\\phi$ only depends on $x$, its gradient is:\n$$\n\\nabla\\phi(\\boldsymbol{x}) = \\left( \\frac{\\partial\\phi}{\\partial x}, \\frac{\\partial\\phi}{\\partial y}, \\frac{\\partial\\phi}{\\partial z} \\right) = \\left( \\frac{d\\phi}{dx}, 0, 0 \\right)\n$$\nThe derivative with respect to $x$ is:\n$$\n\\frac{d\\phi}{dx} = \\frac{d}{dx}\\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx)\\right) = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}} \\cdot k\\cos(kx) = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx)\n$$\nSo, $\\nabla\\phi(\\boldsymbol{x}) = \\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx), 0, 0\\right)$.\nSubstituting this into the expression for the acceleration:\n$$\n\\boldsymbol{a}(\\boldsymbol{x}) = -\\frac{1}{a} \\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx), 0, 0\\right) = \\left(\\frac{4\\pi G\\,a\\,\\bar{\\rho}}{k}\\cos(kx), 0, 0\\right)\n$$\nThe components of the peculiar gravitational acceleration are:\n$$\na_{x}(\\boldsymbol{x}) = \\frac{4\\pi G\\,a\\,\\bar{\\rho}}{k}\\cos(kx)\n$$\n$$\na_{y}(\\boldsymbol{x}) = 0\n$$\n$$\na_{z}(\\boldsymbol{x}) = 0\n$$\nWe have now found the closed-form expressions for the potential and the three components of the acceleration.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{4\\pi G a^{2} \\bar{\\rho}}{k^{2}} \\sin(kx) & \\frac{4\\pi G a \\bar{\\rho}}{k} \\cos(kx) & 0 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the connection between density and force established, we can investigate how initial perturbations evolve. This exercise contrasts the dynamics of gravitational collapse in a pressureless \"dust\" model with that of a \"warm\" kinetic model possessing a finite velocity dispersion. By analytically calculating the time to \"shell crossing,\" you will quantify the crucial role of kinetic pressure in resisting collapse and delaying caustic formation, a key physical phenomenon that the full Vlasov equation is designed to describe .",
            "id": "3500416",
            "problem": "Consider a One-Dimensional (1D) collisionless self-gravitating medium in a static Newtonian background with uniform mean mass density $\\,\\rho_{0}\\,$. The phase-space dynamics are governed by the Vlasov-Poisson (VP) system, with distribution function $\\,f(x,v,t)\\,$ satisfying $\\,\\partial_{t} f + v\\,\\partial_{x} f - \\partial_{x} \\phi\\,\\partial_{v} f = 0\\,$ and gravitational potential $\\,\\phi(x,t)\\,$ determined by $\\,\\partial_{x}^{2}\\phi = 4\\pi G\\left(\\int f\\,\\mathrm{d}v - \\rho_{0}\\right)\\,$, where $\\,G\\,$ is Newton’s gravitational constant. Assume the system is prepared at $\\,t=0\\,$ in a nearly cold state with a narrow Maxwellian velocity dispersion of standard deviation $\\,\\sigma_{v}\\,$, and a single-mode sinusoidal Lagrangian displacement\n$$\ns(q) \\equiv -\\frac{A}{k}\\,\\sin(k q),\n$$\nfor Lagrangian coordinate $\\,q\\,$, with amplitude $\\,A \\in (0,1)\\,$ and wavenumber $\\,k>0\\,$. The Eulerian position mapping is $\\,x(q,t) = q + D(t)\\,s(q)\\,$, where $\\,D(t)\\,$ is the mode’s displacement growth factor. The earliest “shell crossing” is defined as the first time $\\,t\\,$ at which the Lagrangian-to-Eulerian Jacobian\n$$\nJ(q,t) \\equiv \\frac{\\partial x}{\\partial q} = 1 + D(t)\\,s'(q)\n$$\nvanishes somewhere in $\\,q\\,$.\n\nYou will model and compare two dynamics:\n\n- The dust model (vanishing velocity dispersion), obtained by taking a monokinetic distribution $\\,f(x,v,t) = \\rho(x,t)\\,\\delta\\!\\left(v-u(x,t)\\right)\\,$, which yields the pressureless fluid moment system. Linearize its dynamics about $\\,\\rho=\\rho_{0}\\,$ and $\\,u=0\\,$, and work at the level of the displacement growth factor $\\,D(t)\\,$ for the single Fourier mode of wavenumber $\\,k\\,$. Impose the physically seeded initial conditions $\\,D(0)=0\\,$ and $\\,\\dot{D}(0)=1\\,$.\n\n- A finite-dispersion Vlasov estimate obtained by closing the fluid moments at second order with an effective isotropic pressure $\\,P=\\rho\\,\\sigma_{v}^{2}\\,$ (constant $\\,\\sigma_{v}\\,$), and linearizing about $\\,\\rho=\\rho_{0}\\,$ and $\\,u=0\\,$. Again work with the single-mode displacement growth factor $\\,D_{\\sigma}(t)\\,$ under the same initial conditions $\\,D_{\\sigma}(0)=0\\,$ and $\\,\\dot{D}_{\\sigma}(0)=1\\,$. Assume the sub-Jeans regime $\\,\\sigma_{v}^{2} k^{2} < 4\\pi G \\rho_{0}\\,$ so that growth occurs.\n\nStarting only from the VP system, the Poisson equation, and the fluid moment definitions, derive the linear evolution equations for $\\,D(t)\\,$ and $\\,D_{\\sigma}(t)\\,$. Use them to obtain the shell crossing times $\\,t_{\\mathrm{sc}}^{\\mathrm{dust}}\\,$ and $\\,t_{\\mathrm{sc}}^{\\sigma}\\,$ defined by the earliest $\\,t>0\\,$ at which $\\,\\min_{q} J(q,t)=0\\,$. Then, provide the exact closed-form analytic expression for the ratio\n$$\nR \\equiv \\frac{t_{\\mathrm{sc}}^{\\sigma}}{t_{\\mathrm{sc}}^{\\mathrm{dust}}}\n$$\nin terms of $\\,G\\,$, $\\,\\rho_{0}\\,$, $\\,\\sigma_{v}\\,$, $\\,k\\,$, and $\\,A\\,$. No numerical values are to be substituted. Express your final answer as a single analytic expression; no units are required because $\\,R\\,$ is dimensionless.",
            "solution": "The problem is first validated and found to be well-posed and scientifically sound, permitting a full solution. The derivation proceeds by first establishing the fluid-moment equations from the Vlasov-Poisson system, then specializing and linearizing them for the two requested models (dust and finite-dispersion). The respective growth factor evolution equations are derived and solved, leading to the shell crossing times, and finally their ratio.\n\nThe phase-space dynamics are governed by the Vlasov-Poisson system:\n$$\n\\partial_{t} f + v\\,\\partial_{x} f - (\\partial_{x} \\phi)\\,\\partial_{v} f = 0\n$$\n$$\n\\partial_{x}^{2}\\phi = 4\\pi G\\left(\\int f\\,\\mathrm{d}v - \\rho_{0}\\right)\n$$\nWe define the fluid moments: mass density $\\rho(x,t) = \\int f(x,v,t)\\,\\mathrm{d}v$ and bulk velocity $u(x,t) = \\frac{1}{\\rho}\\int v f(x,v,t)\\,\\mathrm{d}v$.\n\nIntegrating the Vlasov equation over all velocities $v$ yields the continuity equation, assuming $f \\to 0$ as $|v| \\to \\infty$:\n$$\n\\partial_{t} \\rho + \\partial_{x}(\\rho u) = 0\n$$\nMultiplying the Vlasov equation by $v$ and integrating yields the momentum (Euler-Jeans) equation:\n$$\n\\partial_t (\\rho u) + \\partial_x (\\rho \\langle v^2 \\rangle) + \\rho \\partial_x \\phi = 0\n$$\nwhere $\\langle v^2 \\rangle = \\frac{1}{\\rho}\\int v^2 f\\,\\mathrm{d}v$. We define the velocity dispersion squared as $\\sigma_v^2 = \\langle(v-u)^2\\rangle = \\langle v^2 \\rangle - u^2$. The pressure is defined as $P = \\rho \\sigma_v^2$. The momentum equation can be written as:\n$$\n\\rho(\\partial_t u + u \\partial_x u) = -\\partial_x P - \\rho \\partial_x \\phi\n$$\n\nThe analysis of shell crossing begins with the Jacobian of the Lagrangian-to-Eulerian map, $J(q,t) = \\frac{\\partial x}{\\partial q}$. Given $x(q,t) = q + D(t)s(q)$ and $s(q) = -\\frac{A}{k}\\sin(kq)$, the Jacobian is:\n$$\nJ(q,t) = 1 + D(t)s'(q) = 1 - A D(t) \\cos(kq)\n$$\nShell crossing occurs at the first time $t > 0$ when $J(q,t)=0$ for some $q$. This condition is met first when the second term is maximally negative, i.e., at a location $q$ where $\\cos(kq) = 1$. The condition for shell crossing is therefore:\n$$\n1 - A D(t_{\\mathrm{sc}}) = 0 \\implies D(t_{\\mathrm{sc}}) = \\frac{1}{A}\n$$\nThis condition is identical for both models; only the functional form of $D(t)$ will differ.\n\n**1. Dust Model ($\\sigma_v = 0$)**\nIn the dust model, the velocity dispersion is zero, so the pressure $P=0$. The linearized fluid equations for perturbations $\\delta\\rho = \\rho - \\rho_0$, $u_1=u$, and $\\phi_1=\\phi$ about the static background ($\\rho_0, u=0$) are:\n1. Continuity: $\\partial_t \\delta\\rho + \\rho_0 \\partial_x u_1 = 0$\n2. Euler: $\\rho_0 \\partial_t u_1 = -\\rho_0 \\partial_x \\phi_1$\n3. Poisson: $\\partial_x^2 \\phi_1 = 4\\pi G \\delta\\rho$\n\nCombining these equations, we take the time derivative of (1) and the spatial derivative of (2):\n$$\n\\partial_t^2 \\delta\\rho + \\rho_0 \\partial_x \\partial_t u_1 = 0\n$$\n$$\n\\partial_x \\partial_t u_1 = -\\partial_x^2 \\phi_1\n$$\nSubstituting (3) into the second equation gives $\\partial_x \\partial_t u_1 = -4\\pi G \\delta\\rho$. Substituting this back into the first equation yields:\n$$\n\\partial_t^2 \\delta\\rho_1 - 4\\pi G \\rho_0 \\delta\\rho_1 = 0\n$$\nThe density perturbation is related to the displacement growth factor $D(t)$. From mass conservation, $\\rho_0 \\mathrm{d}q = \\rho(x,t) \\mathrm{d}x$, so $\\rho = \\rho_0 J^{-1} = \\rho_0 (1 - A D(t) \\cos(kq))^{-1}$. To linear order, $\\delta\\rho = \\rho-\\rho_0 \\approx \\rho_0 A D(t) \\cos(kq)$. Since $\\delta\\rho$ is proportional to $D(t)$, a single mode of $D(t)$ must also satisfy the same differential equation.\nLet $\\omega_J^2 = 4\\pi G \\rho_0$. The evolution equation for the growth factor $D(t)$ is:\n$$\n\\ddot{D}(t) - \\omega_J^2 D(t) = 0\n$$\nThe general solution is $D(t) = c_1 \\cosh(\\omega_J t) + c_2 \\sinh(\\omega_J t)$. Applying the initial conditions $D(0)=0$ and $\\dot D(0)=1$:\n$D(0) = c_1 = 0$.\n$\\dot D(t) = c_2 \\omega_J \\cosh(\\omega_J t) \\implies \\dot D(0) = c_2 \\omega_J = 1 \\implies c_2 = 1/\\omega_J$.\nThus, for the dust model, the growth factor is:\n$$\nD(t) = \\frac{1}{\\omega_J} \\sinh(\\omega_J t)\n$$\nThe shell crossing time $t_{\\mathrm{sc}}^{\\mathrm{dust}}$ is found by solving $D(t_{\\mathrm{sc}}^{\\mathrm{dust}}) = 1/A$:\n$$\n\\frac{1}{\\omega_J} \\sinh(\\omega_J t_{\\mathrm{sc}}^{\\mathrm{dust}}) = \\frac{1}{A} \\implies t_{\\mathrm{sc}}^{\\mathrm{dust}} = \\frac{1}{\\omega_J} \\text{arcsinh}\\left(\\frac{\\omega_J}{A}\\right)\n$$\n\n**2. Finite-Dispersion Model ($P = \\rho \\sigma_v^2$)**\nFor this model, the pressure term is non-zero. The linearized pressure perturbation is $P_1 = \\delta\\rho \\sigma_v^2$. The linearized Euler equation becomes:\n$$\n\\rho_0 \\partial_t u_1 = -\\partial_x P_1 - \\rho_0\\partial_x \\phi_1 = -\\sigma_v^2 \\partial_x \\delta\\rho - \\rho_0 \\partial_x \\phi_1\n$$\nFollowing the same procedure as before, we combine this with the linearized continuity and Poisson equations:\n$$\n\\partial_t^2 \\delta\\rho + \\rho_0 \\partial_x \\partial_t u_1 = \\partial_t^2 \\delta\\rho + \\partial_x ( -\\sigma_v^2 \\partial_x \\delta\\rho - \\rho_0 \\partial_x \\phi_1) = 0\n$$\n$$\n\\partial_t^2 \\delta\\rho - \\sigma_v^2 \\partial_x^2 \\delta\\rho - \\rho_0 \\partial_x^2 \\phi_1 = 0\n$$\nUsing the Poisson equation $\\partial_x^2 \\phi_1 = 4\\pi G \\delta\\rho$, we get:\n$$\n\\partial_t^2 \\delta\\rho - \\sigma_v^2 \\partial_x^2 \\delta\\rho - 4\\pi G \\rho_0 \\delta\\rho = 0\n$$\nWe consider a single Fourier mode with wavenumber $k$, so $\\delta\\rho \\propto \\cos(kx)$ or $\\exp(ikx)$, for which $\\partial_x^2 \\delta\\rho_k = -k^2 \\delta\\rho_k$. The equation for the mode amplitude becomes:\n$$\n\\ddot{\\delta\\rho_k} - \\sigma_v^2 (-k^2) \\delta\\rho_k - 4\\pi G \\rho_0 \\delta\\rho_k = 0 \\implies \\ddot{\\delta\\rho_k} - (4\\pi G \\rho_0 - \\sigma_v^2 k^2) \\delta\\rho_k = 0\n$$\nSince $\\delta\\rho_k$ is proportional to $D_\\sigma(t)$, the growth factor $D_\\sigma(t)$ obeys the same equation. Let's define $\\omega_{\\sigma}^2 = 4\\pi G \\rho_0 - \\sigma_v^2 k^2 = \\omega_J^2 - \\sigma_v^2 k^2$. The problem assumes the sub-Jeans regime, $\\sigma_v^2 k^2 < 4\\pi G \\rho_0$, which ensures $\\omega_{\\sigma}^2 > 0$ and thus gravitational instability. The evolution equation is:\n$$\n\\ddot{D}_{\\sigma}(t) - \\omega_{\\sigma}^2 D_{\\sigma}(t) = 0\n$$\nThis equation has the same form as the dust model, with $\\omega_J$ replaced by $\\omega_{\\sigma}$. Using the same initial conditions, $D_{\\sigma}(0)=0$ and $\\dot{D}_{\\sigma}(0)=1$, the solution is:\n$$\nD_{\\sigma}(t) = \\frac{1}{\\omega_{\\sigma}} \\sinh(\\omega_{\\sigma} t)\n$$\nThe shell crossing time $t_{\\mathrm{sc}}^{\\sigma}$ is found by solving $D_{\\sigma}(t_{\\mathrm{sc}}^{\\sigma}) = 1/A$:\n$$\n\\frac{1}{\\omega_{\\sigma}} \\sinh(\\omega_{\\sigma} t_{\\mathrm{sc}}^{\\sigma}) = \\frac{1}{A} \\implies t_{\\mathrm{sc}}^{\\sigma} = \\frac{1}{\\omega_{\\sigma}} \\text{arcsinh}\\left(\\frac{\\omega_{\\sigma}}{A}\\right)\n$$\n\n**3. Ratio of Shell Crossing Times**\nThe ratio $R$ is defined as $R \\equiv t_{\\mathrm{sc}}^{\\sigma} / t_{\\mathrm{sc}}^{\\mathrm{dust}}$. Substituting our derived expressions:\n$$\nR = \\frac{\\frac{1}{\\omega_{\\sigma}} \\text{arcsinh}\\left(\\frac{\\omega_{\\sigma}}{A}\\right)}{\\frac{1}{\\omega_J} \\text{arcsinh}\\left(\\frac{\\omega_J}{A}\\right)} = \\frac{\\omega_J}{\\omega_{\\sigma}} \\frac{\\text{arcsinh}\\left(\\frac{\\omega_{\\sigma}}{A}\\right)}{\\text{arcsinh}\\left(\\frac{\\omega_J}{A}\\right)}\n$$\nSubstituting the definitions $\\omega_J = \\sqrt{4\\pi G \\rho_0}$ and $\\omega_{\\sigma} = \\sqrt{4\\pi G \\rho_0 - \\sigma_v^2 k^2}$:\n$$\nR = \\frac{\\sqrt{4\\pi G \\rho_0}}{\\sqrt{4\\pi G \\rho_0 - \\sigma_v^2 k^2}} \\frac{\\text{arcsinh}\\left(\\frac{\\sqrt{4\\pi G \\rho_0 - \\sigma_v^2 k^2}}{A}\\right)}{\\text{arcsinh}\\left(\\frac{\\sqrt{4\\pi G \\rho_0}}{A}\\right)}\n$$\nThis is the final closed-form expression for the ratio in terms of the given parameters. The velocity dispersion acts as a pressure, slowing the gravitational collapse, which leads to a longer shell-crossing time ($R>1$).",
            "answer": "$$\\boxed{\\frac{\\sqrt{4\\pi G \\rho_{0}}}{\\sqrt{4\\pi G \\rho_{0} - \\sigma_{v}^{2} k^{2}}} \\frac{\\operatorname{arcsinh}\\left(\\frac{\\sqrt{4\\pi G \\rho_{0} - \\sigma_{v}^{2} k^{2}}}{A}\\right)}{\\operatorname{arcsinh}\\left(\\frac{\\sqrt{4\\pi G \\rho_{0}}}{A}\\right)}}$$"
        },
        {
            "introduction": "Moving from analytical solutions to numerical implementation, this exercise guides you through coding a basic solver for the Vlasov equation. You will simulate the evolution of a phase-space distribution in a fixed harmonic oscillator potential, a classic problem known as the \"phase-space rotation test.\" By comparing your numerical results against a known exact solution, this practice introduces the core concepts of semi-Lagrangian advection and provides a vital lesson in code verification, an essential skill for any computational scientist .",
            "id": "3500344",
            "problem": "Consider the one-dimensional Vlasov equation for collisionless matter under a fixed, externally imposed gravitational potential in the context of numerical cosmology. The distribution function $f(x,v,t)$ evolves according to the Vlasov equation\n$$\n\\partial_t f + v\\,\\partial_x f - \\left(\\partial_x \\phi(x)\\right)\\,\\partial_v f = 0,\n$$\nwhere $x$ is position, $v$ is velocity, and $t$ is time. For this problem, use a harmonic external potential\n$$\n\\phi(x) = \\tfrac{1}{2}\\,\\omega^2\\,x^2,\n$$\nwith constant frequency $\\omega$. The domain is the rectangular phase-space box $x \\in [-L,L]$ and $v \\in [-V,V]$, where $L = V = 6.0$ are dimensionless, and all angles must be treated and reported in radians. The initial condition is a centered, factorized Gaussian\n$$\nf_0(x,v) = A \\exp\\!\\left(-\\frac{x^2}{2\\sigma_x^2} - \\frac{v^2}{2\\sigma_v^2}\\right),\n$$\nwith $A = 1$, $\\sigma_x = 0.5$, and $\\sigma_v = 0.5$.\n\nTasks:\n- From the Vlasov equation and the specified potential, derive the characteristic system for $(x(t),v(t))$, and deduce the exact parametric evolution of $(x(t),v(t))$ in terms of $(x(0),v(0))$ and $\\omega$. Then, from first principles, derive how the exact solution $f(x,v,t)$ at time $t$ can be obtained from $f_0$.\n- Implement a semi-Lagrangian advection scheme on a uniform Cartesian mesh in $(x,v)$ with bilinear interpolation. On each time step, use exact backward characteristics over one time increment to map the arrival point $(x,v)$ to the departure point $(x_0,v_0)$ and obtain the advected value by bilinear interpolation of the previous time level. Treat values outside the box $[-L,L]\\times[-V,V]$ as zero. All quantities are dimensionless.\n- At a specified final time $t_{\\mathrm{final}}$, compute the numerical solution $f_{\\mathrm{num}}(x_i,v_j,t_{\\mathrm{final}})$ and the exact solution $f_{\\mathrm{exact}}(x_i,v_j,t_{\\mathrm{final}})$ on the same grid, and evaluate the following discrete error norms:\n$$\n\\|e\\|_{1} \\equiv \\sum_{i,j} \\left| f_{\\mathrm{num}}(x_i,v_j,t_{\\mathrm{final}}) - f_{\\mathrm{exact}}(x_i,v_j,t_{\\mathrm{final}}) \\right|\\,\\Delta x\\,\\Delta v,\\quad\n\\|e\\|_{2} \\equiv \\left(\\sum_{i,j} \\left| f_{\\mathrm{num}}(x_i,v_j,t_{\\mathrm{final}}) - f_{\\mathrm{exact}}(x_i,v_j,t_{\\mathrm{final}}) \\right|^2\\,\\Delta x\\,\\Delta v\\right)^{1/2},\n$$\nwhere $\\Delta x$ and $\\Delta v$ are the uniform grid spacings. Report these errors to assess the observed order of accuracy under mesh refinement.\n\nUse the following fixed parameters for all tests:\n- $\\omega = 1.0$,\n- $L = 6.0$, $V = 6.0$,\n- $t_{\\mathrm{final}} = 1.234$ (in radians),\n- $A = 1.0$, $\\sigma_x = 0.5$, $\\sigma_v = 0.5$.\n\nTest suite:\n- Case $1$: $N_x = 32$, $N_v = 32$, $N_t = 32$.\n- Case $2$: $N_x = 64$, $N_v = 64$, $N_t = 64$.\n- Case $3$: $N_x = 128$, $N_v = 128$, $N_t = 128$.\n- Case $4$ (edge case with larger time step): $N_x = 64$, $N_v = 64$, $N_t = 8$.\n\nIn each case, advance from $t=0$ to $t=t_{\\mathrm{final}}$ using $N_t$ uniform steps of size $\\Delta t = t_{\\mathrm{final}}/N_t$. For each case, compute $\\|e\\|_{1}$ and $\\|e\\|_{2}$ as defined above.\n\nYour program should produce a single line of output containing the results for all four cases as a comma-separated list of pairs enclosed in square brackets, where each pair contains the two error norms $\\left[\\|e\\|_{1},\\|e\\|_{2}\\right]$ for a case, and each floating-point number must be printed in scientific notation with six significant digits. For example, the output must look like\n$$\n\\left[\\left[1.234000\\mathrm{e}{-3},5.678000\\mathrm{e}{-4}\\right],\\left[\\dots,\\dots\\right],\\left[\\dots,\\dots\\right],\\left[\\dots,\\dots\\right]\\right].\n$$",
            "solution": "The problem requires a numerical solution of the one-dimensional Vlasov equation for a collisionless system under a fixed external harmonic potential, and a comparison of this numerical solution to the exact analytical solution.\n\n### Part 1: Problem Validation\nThe problem is well-defined, scientifically grounded, and self-contained. It presents a standard test case for numerical Vlasov solvers.\n- **Givens**: The Vlasov equation $\\partial_t f + v\\,\\partial_x f - \\left(\\partial_x \\phi(x)\\right)\\,\\partial_v f = 0$, the potential $\\phi(x) = \\tfrac{1}{2}\\,\\omega^2\\,x^2$, the initial condition $f_0(x,v) = A \\exp\\!\\left(-\\frac{x^2}{2\\sigma_x^2} - \\frac{v^2}{2\\sigma_v^2}\\right)$, and all necessary parameters ($L=6.0$, $V=6.0$, $\\omega=1.0$, $t_{\\mathrm{final}}=1.234$, $A=1.0$, $\\sigma_x=0.5$, $\\sigma_v=0.5$) are specified. The numerical method (semi-Lagrangian with bilinear interpolation) and error metrics ($\\|e\\|_1$, $\\|e\\|_2$) are explicitly defined. The test cases are clearly listed.\n- **Verdict**: The problem is valid. No flaws related to scientific soundness, completeness, or clarity are detected.\n\n### Part 2: Theoretical Derivation\n\n#### Characteristic Equations\nThe Vlasov equation states that the distribution function $f(x,v,t)$ is constant along the trajectories of particles in phase space. These trajectories, called characteristics, are governed by the Hamiltonian equations of motion:\n$$\n\\frac{dx}{dt} = \\frac{\\partial H}{\\partial p} \\quad \\text{and} \\quad \\frac{dp}{dt} = -\\frac{\\partial H}{\\partial x}\n$$\nFor non-relativistic matter, the momentum is $p=mv$ and the Hamiltonian is $H(x,p) = \\frac{p^2}{2m} + m\\phi(x)$. In our dimensionless units, we can set mass $m=1$, so $p=v$ and $H(x,v) = \\frac{1}{2}v^2 + \\phi(x)$. The characteristic equations are:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -\\frac{\\partial \\phi}{\\partial x}\n$$\nGiven the external potential $\\phi(x) = \\frac{1}{2}\\omega^2 x^2$, the force term is $-\\frac{\\partial \\phi}{\\partial x} = -\\omega^2 x$. The system of ordinary differential equations (ODEs) for the characteristics becomes:\n$$\n\\frac{dx}{dt} = v, \\quad \\frac{dv}{dt} = -\\omega^2 x\n$$\nThis is the familiar system for a simple harmonic oscillator.\n\n#### Exact Evolution of Characteristics\nTo solve this system, we can differentiate the first equation with respect to time $t$ and substitute the second equation:\n$$\n\\frac{d^2x}{dt^2} = \\frac{dv}{dt} = -\\omega^2 x \\implies \\frac{d^2x}{dt^2} + \\omega^2 x = 0\n$$\nThe general solution for $x(t)$ is $x(t) = C_1 \\cos(\\omega t) + C_2 \\sin(\\omega t)$. The velocity is then $v(t) = \\frac{dx}{dt} = -\\omega C_1 \\sin(\\omega t) + \\omega C_2 \\cos(\\omega t)$. We determine the constants $C_1$ and $C_2$ using the initial conditions at $t=0$, $(x(0), v(0)) = (x_0, v_0)$.\n- $x(0) = C_1 \\cos(0) + C_2 \\sin(0) = C_1 \\implies C_1=x_0$.\n- $v(0) = -\\omega C_1 \\sin(0) + \\omega C_2 \\cos(0) = \\omega C_2 \\implies C_2=v_0/\\omega$.\n\nSubstituting these constants back gives the parametric evolution of a phase-space point (the forward characteristics):\n$$\nx(t) = x_0 \\cos(\\omega t) + \\frac{v_0}{\\omega} \\sin(\\omega t)\n$$\n$$\nv(t) = -\\omega x_0 \\sin(\\omega t) + v_0 \\cos(\\omega t)\n$$\n\n#### Exact Solution $f(x,v,t)$\nLiouville's theorem, as embodied by the Vlasov equation, states that $f$ is conserved along characteristics: $f(x(t), v(t), t) = f(x_0, v_0, 0) = f_0(x_0, v_0)$. To find the solution $f(x,v,t)$ at an arbitrary point $(x,v)$ and time $t$, we must find the initial phase-space coordinates $(x_0, v_0)$ that evolve to $(x,v)$ in time $t$. This requires inverting the evolution equations, which is equivalent to evolving backward in time by $t$. We replace $t$ with $-t$ in the forward evolution equations:\n$$\nx_0(x,v,t) = x \\cos(-\\omega t) + \\frac{v}{\\omega} \\sin(-\\omega t) = x \\cos(\\omega t) - \\frac{v}{\\omega} \\sin(\\omega t)\n$$\n$$\nv_0(x,v,t) = -\\omega x \\sin(-\\omega t) + v \\cos(-\\omega t) = \\omega x \\sin(\\omega t) + v \\cos(\\omega t)\n$$\nThe exact solution at time $t$ is then obtained by substituting these expressions for $(x_0, v_0)$ into the initial distribution $f_0$:\n$$\nf_{\\mathrm{exact}}(x, v, t) = f_0(x_0(x,v,t), v_0(x,v,t)) = A \\exp\\left(-\\frac{\\left(x \\cos(\\omega t) - \\frac{v}{\\omega} \\sin(\\omega t)\\right)^2}{2\\sigma_x^2} - \\frac{\\left(\\omega x \\sin(\\omega t) + v \\cos(\\omega t)\\right)^2}{2\\sigma_v^2}\\right)\n$$\nThis formula allows for the direct computation of the exact solution at any point $(x,v)$ and time $t_{\\mathrm{final}}$.\n\n### Part 3: Numerical Implementation\n\nThe core of the numerical method is a semi-Lagrangian advection scheme. The goal is to compute the value of the distribution function $f^{n+1}$ on a uniform grid at time $t_{n+1} = t_n + \\Delta t$, given the values $f^n$ at time $t_n$.\n\n1.  **Grid Setup**: A uniform Cartesian grid is defined on the phase-space domain $[-L,L]\\times[-V,V]$. The grid consists of $N_x \\times N_v$ points. The grid coordinates are $(x_i, v_j)$, where $x_i = -L + i \\cdot \\Delta x$ for $i \\in \\{0, \\dots, N_x-1\\}$ and $v_j = -V + j \\cdot \\Delta v$ for $j \\in \\{0, \\dots, N_v-1\\}$. The grid spacings are $\\Delta x = \\frac{2L}{N_x-1}$ and $\\Delta v = \\frac{2V}{N_v-1}$.\n\n2.  **Semi-Lagrangian Advection**: Since $f$ is constant along characteristics, the value at a grid point $(x_i, v_j)$ (an \"arrival point\") at time $t_{n+1}$ is equal to the value of $f$ at the \"departure point\" $(x_d, v_d)$ at time $t_n$. The departure point is found by tracing the characteristic backward in time by one step $\\Delta t$ from $(x_i, v_j)$. The mapping is given by the backward characteristic equations derived earlier, with $t$ replaced by $\\Delta t$:\n    $$\n    x_d = x_i \\cos(\\omega \\Delta t) - \\frac{v_j}{\\omega} \\sin(\\omega \\Delta t)\n    $$\n    $$\n    v_d = \\omega x_i \\sin(\\omega \\Delta t) + v_j \\cos(\\omega \\Delta t)\n    $$\n\n3.  **Bilinear Interpolation**: The departure point $(x_d, v_d)$ generally does not coincide with a grid point from time level $t_n$. Therefore, its value must be interpolated from the surrounding grid points. We use bilinear interpolation. For a point $(x_d, v_d)$ located in the grid cell defined by corners $(x_{i'}, v_{j'})$, $(x_{i'+1}, v_{j'})$, $(x_{i'}, v_{j'+1})$, and $(x_{i'+1}, v_{j'+1})$, the interpolated value $f^n(x_d, v_d)$ is a weighted average of the four corner values $f^n(x_{i'}, v_{j'})$, etc. The weights are determined by the fractional distances of $(x_d, v_d)$ from the cell boundaries. If $(x_d, v_d)$ falls outside the domain $[-L,L]\\times[-V,V]$, its value is taken to be $0$, as per the problem statement. This is handled by configuring the interpolator to return $0$ for out-of-bounds queries.\n\n4.  **Time Integration**: The simulation starts with the initial condition $f^0(x_i,v_j) = f_0(x_i, v_j)$ evaluated on the grid. The solution is then advanced for $N_t$ steps, each of size $\\Delta t = t_{\\mathrm{final}}/N_t$, by repeatedly applying the semi-Lagrangian advection step to obtain $f^1, f^2, \\ldots, f^{N_t}$. The final numerical result is $f_{\\mathrm{num}}(x_i, v_j, t_{\\mathrm{final}}) = f^{N_t}(x_i, v_j)$.\n\n5.  **Error Calculation**: At the final time $t_{\\mathrm{final}}$, the numerical solution $f_{\\mathrm{num}}$ is compared to the exact solution $f_{\\mathrm{exact}}$ evaluated on the same grid. The discrete $L_1$ and $L_2$ error norms are computed as specified:\n    $$\n    \\|e\\|_{1} = \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_v-1} \\left| f_{\\mathrm{num}}(x_i,v_j) - f_{\\mathrm{exact}}(x_i,v_j) \\right|\\,\\Delta x\\,\\Delta v\n    $$\n    $$\n    \\|e\\|_{2} = \\left(\\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_v-1} \\left| f_{\\mathrm{num}}(x_i,v_j) - f_{\\mathrm{exact}}(x_i,v_j) \\right|^2\\,\\Delta x\\,\\Delta v\\right)^{1/2}\n    $$\n    The integrations are approximated by a simple Riemann sum over the grid cells, with each cell having an area of $\\Delta x \\Delta v$. This procedure is repeated for each test case to assess the accuracy of the scheme.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import RegularGridInterpolator\n\ndef solve():\n    \"\"\"\n    Solves the 1D Vlasov equation for a harmonic potential using a semi-Lagrangian\n    scheme and compares the numerical result to the exact solution.\n    \"\"\"\n    \n    # Fixed parameters\n    omega = 1.0\n    L = 6.0\n    V = 6.0\n    t_final = 1.234\n    A = 1.0\n    sigma_x = 0.5\n    sigma_v = 0.5\n\n    # Test suite\n    test_cases = [\n        (32, 32, 32),   # Case 1\n        (64, 64, 64),   # Case 2\n        (128, 128, 128),# Case 3\n        (64, 64, 8),    # Case 4\n    ]\n\n    def f0(x, v):\n        \"\"\"Initial Gaussian distribution function.\"\"\"\n        return A * np.exp(-x**2 / (2 * sigma_x**2) - v**2 / (2 * sigma_v**2))\n\n    def run_simulation(Nx, Nv, Nt):\n        \"\"\"\n        Runs a single simulation for a given grid resolution and number of time steps.\n        \n        Args:\n            Nx (int): Number of grid points in the x dimension.\n            Nv (int): Number of grid points in the v dimension.\n            Nt (int): Number of time steps.\n            \n        Returns:\n            list: A list containing the L1 and L2 error norms, [e1, e2].\n        \"\"\"\n        # 1. Grid Setup\n        x_coords = np.linspace(-L, L, Nx)\n        v_coords = np.linspace(-V, V, Nv)\n        delta_x = 2 * L / (Nx - 1)\n        delta_v = 2 * V / (Nv - 1)\n        \n        # Use 'ij' indexing for intuitive alignment with array shapes\n        X, V_grid = np.meshgrid(x_coords, v_coords, indexing='ij')\n\n        # 2. Initial Condition\n        f_current = f0(X, V_grid)\n        \n        # 3. Time Integration\n        delta_t = t_final / Nt\n        cos_dt = np.cos(omega * delta_t)\n        sin_dt = np.sin(omega * delta_t)\n\n        for _ in range(Nt):\n            # Create an interpolator for the current distribution function f_current\n            # f_current has shape (Nx, Nv) corresponding to (x_coords, v_coords)\n            interpolator = RegularGridInterpolator(\n                (x_coords, v_coords), \n                f_current, \n                method='linear', \n                bounds_error=False, \n                fill_value=0.0\n            )\n            \n            # Calculate departure points for all grid points\n            # These are the positions at t_n that will arrive at (X, V_grid) at t_{n+1}\n            Xd = X * cos_dt - (V_grid / omega) * sin_dt\n            Vd = omega * X * sin_dt + V_grid * cos_dt\n\n            # Prepare departure points for interpolation\n            # The interpolator expects an array of shape (n_points, n_dims)\n            departure_points = np.stack((Xd, Vd), axis=-1)\n            \n            # Interpolate to find f at the next time step\n            f_current = interpolator(departure_points)\n\n        f_numerical = f_current\n\n        # 4. Calculate Exact Solution at t_final\n        cos_final = np.cos(omega * t_final)\n        sin_final = np.sin(omega * t_final)\n        \n        X0 = X * cos_final - (V_grid / omega) * sin_final\n        V0 = omega * X * sin_final + V_grid * cos_final\n        \n        f_exact = f0(X0, V0)\n        \n        # 5. Calculate Error Norms\n        error_abs = np.abs(f_numerical - f_exact)\n        \n        # Integrate using a simple Riemann sum as specified\n        norm1 = np.sum(error_abs) * delta_x * delta_v\n        norm2 = np.sqrt(np.sum(error_abs**2) * delta_x * delta_v)\n        \n        return [norm1, norm2]\n\n    results = []\n    for case in test_cases:\n        Nx, Nv, Nt = case\n        errors = run_simulation(Nx, Nv, Nt)\n        results.append(errors)\n\n    # Format the output string as per the problem specification\n    results_str = [f\"[{e1:.6e},{e2:.6e}]\" for e1, e2 in results]\n    final_output = f\"[{','.join(results_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}