{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of redshift-space distortion (RSD) analysis is the Kaiser formula, which elegantly describes how large-scale coherent flows generate a characteristic angular anisotropy in the galaxy power spectrum. This foundational exercise guides you through a first-principles derivation of this result, starting from the basic physics of mass conservation and gravitational evolution. By completing this derivation, you will not only understand the origin of the $(b+f\\mu^2)^2$ enhancement but also see how this anisotropy is naturally decomposed into Legendre multipoles—the primary observables used to probe cosmology. ",
            "id": "3483944",
            "problem": "Consider linear Redshift-Space Distortions (RSD) for a biased tracer of the matter density field in the plane-parallel (distant-observer) approximation. Let the real-to-redshift-space mapping be given by $\\,\\mathbf{s}=\\mathbf{x}+\\frac{v_{\\parallel}(\\mathbf{x})}{aH}\\,\\hat{\\mathbf{n}}\\,$, where $\\,\\hat{\\mathbf{n}}\\,$ is the fixed line-of-sight direction, $\\,v_{\\parallel}=\\mathbf{v}\\cdot\\hat{\\mathbf{n}}\\,$ is the line-of-sight peculiar velocity, $\\,a\\,$ is the scale factor, and $\\,H\\,$ is the Hubble parameter. Assume linear galaxy bias $\\,\\delta_{g}(\\mathbf{x})=b\\,\\delta_{m}(\\mathbf{x})\\,$, where $\\,\\delta_{m}\\,$ is the matter density contrast and $\\,b\\,$ is a scale-independent constant. Use mass conservation between the two coordinate systems to linear order and the linearized continuity equation for the matter velocity divergence, $\\,\\nabla\\cdot\\mathbf{v}(\\mathbf{x})=-aH\\,f\\,\\delta_{m}(\\mathbf{x})\\,$, where $\\,f\\equiv\\frac{d\\ln D}{d\\ln a}\\,$ is the linear growth rate and $\\,D\\,$ is the linear growth factor.\n\nStarting from these definitions and relations (and no others), work in Fourier space under the plane-parallel approximation with wavevector $\\,\\mathbf{k}\\,$ making a cosine angle $\\,\\mu\\equiv\\hat{\\mathbf{k}}\\cdot\\hat{\\mathbf{n}}\\,$ with the line of sight. Derive the anisotropic redshift-space power spectrum $\\,P_{s}(k,\\mu)\\,$ of the tracer in terms of the real-space matter power spectrum $\\,P_{m}(k)\\,$, the bias $\\,b\\,$, and the growth rate $\\,f\\,$. Then express $\\,P_{s}(k,\\mu)\\,$ as multipoles\n$$\nP_{\\ell}(k)=\\frac{2\\ell+1}{2}\\int_{-1}^{1}d\\mu\\,P_{s}(k,\\mu)\\,\\mathcal{L}_{\\ell}(\\mu),\n$$\nwhere $\\,\\mathcal{L}_{\\ell}(\\mu)\\,$ is the Legendre polynomial of order $\\,\\ell\\,$. Compute the first three even multipoles $\\,P_{0}(k)\\,$, $\\,P_{2}(k)\\,$, and $\\,P_{4}(k)\\,$ in closed form, fully simplified, and express your final answer in terms of $\\,P_{m}(k)\\,$, $\\,b\\,$, and $\\,f\\,$ only. Your final answer must be a single analytic expression. No numerical evaluation is required. If you use any angles, they must be treated symbolically; no angle units are required in the final expression.",
            "solution": "The problem requires the derivation of the redshift-space power spectrum multipoles for a biased tracer, starting from first principles in linear perturbation theory under the plane-parallel approximation. The derivation proceeds in three main stages: first, finding the expression for the tracer density contrast in redshift space; second, using this to find the anisotropic power spectrum; and third, decomposing this spectrum into its Legendre multipoles.\n\n**1. Derivation of the Redshift-Space Density Contrast**\n\nThe relationship between real-space coordinates $\\mathbf{x}$ and redshift-space coordinates $\\mathbf{s}$ is given by\n$$\n\\mathbf{s}=\\mathbf{x}+\\frac{v_{\\parallel}(\\mathbf{x})}{aH}\\,\\hat{\\mathbf{n}}\n$$\nwhere $v_{\\parallel} = \\mathbf{v}\\cdot\\hat{\\mathbf{n}}$ is the peculiar velocity component along the line of sight $\\hat{\\mathbf{n}}$, $a$ is the scale factor, and $H$ is the Hubble parameter. The plane-parallel approximation assumes a fixed line-of-sight direction $\\hat{\\mathbf{n}}$.\n\nThe number of tracers is conserved under the mapping from real to redshift space. If $n_g(\\mathbf{x})$ and $n_s(\\mathbf{s})$ are the number densities of the tracer (galaxies) in real and redshift space, respectively, then\n$$\nn_s(\\mathbf{s})d^3s = n_g(\\mathbf{x})d^3x\n$$\nExpressing the densities in terms of the mean density $\\bar{n}_g$ and the density contrast $\\delta_g = (n_g-\\bar{n}_g)/\\bar{n}_g$, we have $n_g = \\bar{n}_g (1+\\delta_g)$ and $n_s = \\bar{n}_g (1+\\delta_s)$. The conservation law becomes\n$$\n(1+\\delta_s(\\mathbf{s})) d^3s = (1+\\delta_g(\\mathbf{x})) d^3x\n$$\nThis gives the relation between the density contrasts:\n$$\n1+\\delta_s(\\mathbf{s}) = (1+\\delta_g(\\mathbf{x})) \\left| \\det\\left(\\frac{\\partial s_i}{\\partial x_j}\\right) \\right|^{-1}\n$$\nThe Jacobian matrix of the transformation is $J_{ij} = \\frac{\\partial s_i}{\\partial x_j}$. Let us align the coordinate system such that $\\hat{\\mathbf{n}}$ points along the $z$-axis. Then $v_\\parallel = v_z$ and $s_i = x_i + \\delta_{iz} \\frac{v_z(\\mathbf{x})}{aH}$. The Jacobian elements are:\n$$\nJ_{ij} = \\frac{\\partial}{\\partial x_j} \\left(x_i + \\delta_{iz} \\frac{v_z(\\mathbf{x})}{aH}\\right) = \\delta_{ij} + \\frac{\\delta_{iz}}{aH} \\frac{\\partial v_z}{\\partial x_j}\n$$\nThe determinant of this matrix is $\\det(J) = 1 + \\frac{1}{aH}\\frac{\\partial v_z}{\\partial x_z}$. In a coordinate-independent form, this is $1 + \\frac{1}{aH} \\nabla_{\\parallel}v_{\\parallel}$, where $\\nabla_{\\parallel} \\equiv \\hat{\\mathbf{n}}\\cdot\\nabla$.\nSubstituting this into the density contrast relation and linearizing (keeping only first-order terms in $\\delta_g$ and $v_\\parallel$):\n$$\n1+\\delta_s(\\mathbf{s}) \\approx (1+\\delta_g(\\mathbf{x})) \\left(1 + \\frac{1}{aH}\\nabla_{\\parallel}v_{\\parallel}\\right)^{-1} \\approx (1+\\delta_g(\\mathbf{x})) \\left(1 - \\frac{1}{aH}\\nabla_{\\parallel}v_{\\parallel}\\right)\n$$\n$$\n\\delta_s(\\mathbf{s}) \\approx \\delta_g(\\mathbf{x}) - \\frac{1}{aH}\\nabla_{\\parallel}v_{\\parallel}\n$$\nTo a first-order approximation, we can evaluate $\\delta_s$ at position $\\mathbf{x}$ instead of $\\mathbf{s}$, so $\\delta_s(\\mathbf{x}) \\approx \\delta_g(\\mathbf{x}) - \\frac{1}{aH}\\nabla_{\\parallel}v_{\\parallel}(\\mathbf{x})$.\n\nWe now move to Fourier space. Let $\\tilde{f}(\\mathbf{k}) = \\int d^3x \\, f(\\mathbf{x}) e^{-i\\mathbf{k}\\cdot\\mathbf{x}}$ be the Fourier transform. The gradient operator becomes multiplication by $i\\mathbf{k}$. The Fourier transform of our equation is:\n$$\n\\tilde{\\delta}_s(\\mathbf{k}) = \\tilde{\\delta}_g(\\mathbf{k}) - \\frac{1}{aH} \\mathcal{F}[\\hat{\\mathbf{n}}\\cdot\\nabla(\\mathbf{v}\\cdot\\hat{\\mathbf{n}})](\\mathbf{k})\n$$\nThe second term becomes $\\frac{1}{aH} (i\\mathbf{k}\\cdot\\hat{\\mathbf{n}})(\\tilde{\\mathbf{v}}(\\mathbf{k})\\cdot\\hat{\\mathbf{n}})$. Let $\\mu = \\hat{\\mathbf{k}}\\cdot\\hat{\\mathbf{n}}$ be the cosine of the angle between the wavevector $\\mathbf{k}$ and the line of sight $\\hat{\\mathbf{n}}$.\n$$\n\\tilde{\\delta}_s(\\mathbf{k}) = \\tilde{\\delta}_g(\\mathbf{k}) - \\frac{ik\\mu}{aH}(\\tilde{\\mathbf{v}}(\\mathbf{k})\\cdot\\hat{\\mathbf{n}})\n$$\nThe linearized continuity equation is given as $\\nabla\\cdot\\mathbf{v} = -aHf\\delta_m$, where $f$ is the growth rate and $\\delta_m$ is the matter density contrast. In Fourier space, this is $i\\mathbf{k}\\cdot\\tilde{\\mathbf{v}}(\\mathbf{k}) = -aHf\\tilde{\\delta}_m(\\mathbf{k})$. In the linear regime, velocity perturbations are sourced by density perturbations, and the flow is irrotational. This implies that the velocity vector in Fourier space is aligned with the wavevector: $\\tilde{\\mathbf{v}}(\\mathbf{k}) \\propto \\mathbf{k}$. We can write $\\tilde{\\mathbf{v}}(\\mathbf{k}) = \\frac{\\mathbf{k}}{k^2} (\\mathbf{k}\\cdot\\tilde{\\mathbf{v}}(\\mathbf{k}))$. Using the continuity equation, we get:\n$$\n\\tilde{\\mathbf{v}}(\\mathbf{k}) = \\frac{i\\mathbf{k}}{k^2} (-aHf\\tilde{\\delta}_m(\\mathbf{k})) = i a H f \\tilde{\\delta}_m(\\mathbf{k}) \\frac{\\mathbf{k}}{k^2}\n$$\nNow we compute the line-of-sight component of the velocity:\n$$\n\\tilde{\\mathbf{v}}(\\mathbf{k})\\cdot\\hat{\\mathbf{n}} = i a H f \\tilde{\\delta}_m(\\mathbf{k}) \\frac{\\mathbf{k}\\cdot\\hat{\\mathbf{n}}}{k^2} = i a H f \\tilde{\\delta}_m(\\mathbf{k}) \\frac{k\\mu}{k^2}\n$$\nSubstituting this back into the expression for $\\tilde{\\delta}_s(\\mathbf{k})$:\n$$\n\\tilde{\\delta}_s(\\mathbf{k}) = \\tilde{\\delta}_g(\\mathbf{k}) - \\frac{ik\\mu}{aH} \\left( i a H f \\tilde{\\delta}_m(\\mathbf{k}) \\frac{k\\mu}{k^2} \\right) = \\tilde{\\delta}_g(\\mathbf{k}) - i^2 f \\mu^2 \\tilde{\\delta}_m(\\mathbf{k}) = \\tilde{\\delta}_g(\\mathbf{k}) + f\\mu^2 \\tilde{\\delta}_m(\\mathbf{k})\n$$\nFinally, using the linear bias relation $\\delta_g = b\\delta_m$, which in Fourier space is $\\tilde{\\delta}_g(\\mathbf{k})=b\\tilde{\\delta}_m(\\mathbf{k})$, we obtain the redshift-space tracer density contrast in Fourier space:\n$$\n\\tilde{\\delta}_s(\\mathbf{k}) = b\\tilde{\\delta}_m(\\mathbf{k}) + f\\mu^2\\tilde{\\delta}_m(\\mathbf{k}) = (b+f\\mu^2)\\tilde{\\delta}_m(\\mathbf{k})\n$$\n\n**2. Anisotropic Redshift-Space Power Spectrum**\n\nThe power spectrum $P_s(\\mathbf{k})$ is defined by the two-point correlation function of the Fourier modes: $\\langle\\tilde{\\delta}_s(\\mathbf{k})\\tilde{\\delta}_s^*(\\mathbf{k}')\\rangle \\equiv (2\\pi)^3 \\delta_D(\\mathbf{k}-\\mathbf{k}') P_s(\\mathbf{k})$, where $\\delta_D$ is the Dirac delta function. Using the expression for $\\tilde{\\delta}_s(\\mathbf{k})$:\n$$\n\\langle\\tilde{\\delta}_s(\\mathbf{k})\\tilde{\\delta}_s^*(\\mathbf{k}')\\rangle = \\langle (b+f\\mu^2)\\tilde{\\delta}_m(\\mathbf{k}) (b+f\\mu'^2)\\tilde{\\delta}_m^*(\\mathbf{k}') \\rangle = (b+f\\mu^2)(b+f\\mu'^2) \\langle \\tilde{\\delta}_m(\\mathbf{k})\\tilde{\\delta}_m^*(\\mathbf{k}') \\rangle\n$$\nThe real-space matter power spectrum $P_m(k)$ is defined by $\\langle \\tilde{\\delta}_m(\\mathbf{k})\\tilde{\\delta}_m^*(\\mathbf{k}')\\rangle = (2\\pi)^3 \\delta_D(\\mathbf{k}-\\mathbf{k}') P_m(k)$, where we assume statistical isotropy for the matter field, so $P_m$ depends only on the magnitude $k=|\\mathbf{k}|$.\nIn the limit $\\mathbf{k}' \\to \\mathbf{k}$, we have $\\mu' \\to \\mu$. Comparing the definitions, we find the anisotropic redshift-space power spectrum:\n$$\nP_s(k,\\mu) = (b+f\\mu^2)^2 P_m(k)\n$$\nThis is the famous Kaiser formula.\n\n**3. Power Spectrum Multipoles**\n\nThe power spectrum multipoles $P_\\ell(k)$ are the coefficients in the expansion of $P_s(k,\\mu)$ in Legendre polynomials $\\mathcal{L}_\\ell(\\mu)$:\n$$\nP_\\ell(k) = \\frac{2\\ell+1}{2} \\int_{-1}^{1} d\\mu \\, P_s(k,\\mu) \\, \\mathcal{L}_\\ell(\\mu)\n$$\nWe first expand the term $(b+f\\mu^2)^2$ in powers of $\\mu$:\n$$\n(b+f\\mu^2)^2 = b^2 + 2bf\\mu^2 + f^2\\mu^4\n$$\nTo compute the integrals, we can express the powers of $\\mu$ in terms of Legendre polynomials:\n$\\mathcal{L}_0(\\mu) = 1$\n$\\mathcal{L}_2(\\mu) = \\frac{1}{2}(3\\mu^2-1) \\implies \\mu^2 = \\frac{2}{3}\\mathcal{L}_2(\\mu) + \\frac{1}{3}\\mathcal{L}_0(\\mu)$\n$\\mathcal{L}_4(\\mu) = \\frac{1}{8}(35\\mu^4 - 30\\mu^2 + 3) \\implies \\mu^4 = \\frac{8}{35}\\mathcal{L}_4(\\mu) + \\frac{4}{7}\\mathcal{L}_2(\\mu) + \\frac{1}{5}\\mathcal{L}_0(\\mu)$\nSubstituting these into the expansion gives:\n$$\n(b+f\\mu^2)^2 = b^2\\mathcal{L}_0 + 2bf\\left(\\frac{2}{3}\\mathcal{L}_2 + \\frac{1}{3}\\mathcal{L}_0\\right) + f^2\\left(\\frac{8}{35}\\mathcal{L}_4 + \\frac{4}{7}\\mathcal{L}_2 + \\frac{1}{5}\\mathcal{L}_0\\right)\n$$\nCollecting terms for each $\\mathcal{L}_\\ell$:\n$$\n(b+f\\mu^2)^2 = \\left(b^2 + \\frac{2}{3}bf + \\frac{1}{5}f^2\\right)\\mathcal{L}_0(\\mu) + \\left(\\frac{4}{3}bf + \\frac{4}{7}f^2\\right)\\mathcal{L}_2(\\mu) + \\left(\\frac{8}{35}f^2\\right)\\mathcal{L}_4(\\mu)\n$$\nBy the orthogonality of Legendre polynomials, $\\int_{-1}^1 d\\mu \\, \\mathcal{L}_\\ell(\\mu)\\mathcal{L}_n(\\mu) = \\frac{2}{2\\ell+1}\\delta_{\\ell n}$, the integral for $P_\\ell(k)$ picks out the coefficient of $\\mathcal{L}_\\ell(\\mu)$ in the expansion of $P_s(k,\\mu)$.\nThus, $P_s(k,\\mu) = P_0(k)\\mathcal{L}_0(\\mu) + P_2(k)\\mathcal{L}_2(\\mu) + P_4(k)\\mathcal{L}_4(\\mu) + \\dots$.\nWe can directly read off the results for the first three even multipoles:\n\nThe monopole ($\\ell=0$):\n$$\nP_0(k) = \\left(b^2 + \\frac{2}{3}bf + \\frac{1}{5}f^2\\right) P_m(k)\n$$\n\nThe quadrupole ($\\ell=2$):\n$$\nP_2(k) = \\left(\\frac{4}{3}bf + \\frac{4}{7}f^2\\right) P_m(k)\n$$\n\nThe hexadecapole ($\\ell=4$):\n$$\nP_4(k) = \\left(\\frac{8}{35}f^2\\right) P_m(k)\n$$\nAll odd multipoles are zero because $P_s(k,\\mu)$ is an even function of $\\mu$. All even multipoles with $\\ell > 4$ are zero because the polynomial in $\\mu^2$ is of degree $2$, so its expansion in Legendre polynomials truncates at $\\ell=4$.\nThe three requested multipoles are now in their final, simplified form.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left(b^2 + \\frac{2}{3}bf + \\frac{1}{5}f^2\\right)P_m(k) & \\left(\\frac{4}{3}bf + \\frac{4}{7}f^2\\right)P_m(k) & \\frac{8}{35}f^2 P_m(k)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While the Kaiser effect captures large-scale dynamics, the observed power spectrum is also shaped by non-linear phenomena. This practice explores the \"Fingers-of-God\" effect, where small-scale random motions within virialized structures like galaxy clusters suppress power along the line of sight. You will compare two common phenomenological models for this damping—a Gaussian and a Lorentzian—and learn how to use Taylor expansions to find their distinct, leading-order imprints on the quadrupole-to-monopole ratio, a crucial skill for building more realistic RSD models. ",
            "id": "3483965",
            "problem": "In the plane-parallel (distant-observer) limit of redshift-space distortions in large-scale structure, assume a linearly biased tracer with linear bias parameter $b$ and logarithmic growth rate $f$. Let $\\mu$ denote the cosine of the angle between the wavevector $\\mathbf{k}$ and the line of sight, and let $\\sigma_{v}$ denote a one-dimensional velocity dispersion that controls small-scale random motions. Model the redshift-space galaxy power spectrum as the product of a linear Kaiser angular dependence and a small-scale Fingers-of-God (FoG) damping,\n$$\nP_{s}(k,\\mu)=P_{r}(k)\\,\\left(b+f\\,\\mu^{2}\\right)^{2}\\,D_{\\mathrm{FoG}}(k,\\mu),\n$$\nwhere $P_{r}(k)$ is the real-space power spectrum and the FoG damping is taken to be one of the following two forms:\n- Gaussian: $D_{\\mathrm{FoG}}(k,\\mu)=\\exp\\!\\left[-\\left(k\\,\\mu\\,\\sigma_{v}\\right)^{2}\\right]$,\n- Lorentzian: $D_{\\mathrm{FoG}}(k,\\mu)=\\left[1+\\left(k\\,\\mu\\,\\sigma_{v}\\right)^{2}\\right]^{-1}$.\n\nDefine the multipole moments of the redshift-space power spectrum by\n$$\nP_{\\ell}(k)=\\frac{2\\ell+1}{2}\\int_{-1}^{1}\\mathrm{d}\\mu\\;P_{s}(k,\\mu)\\,L_{\\ell}(\\mu),\n$$\nwhere $L_{\\ell}(\\mu)$ is the Legendre polynomial of order $\\ell$. Work in the small-$k$ regime where $k\\,\\sigma_{v}\\ll 1$ and compute the quadrupole-to-monopole ratio $P_{2}(k)/P_{0}(k)$ up to and including terms of order $\\left(k\\,\\sigma_{v}\\right)^{4}$ for each damping model.\n\nLet $\\Delta(k)$ denote the leading non-vanishing difference between the two models’ quadrupole-to-monopole ratios as $k\\to 0$,\n$$\n\\Delta(k)\\equiv \\left[\\frac{P_{2}(k)}{P_{0}(k)}\\right]_{\\mathrm{Lorentzian}}-\\left[\\frac{P_{2}(k)}{P_{0}(k)}\\right]_{\\mathrm{Gaussian}}.\n$$\n\nDerive $\\Delta(k)$ to order $\\left(k\\,\\sigma_{v}\\right)^{4}$ and present it as a closed-form analytic expression in terms of $b$, $f$, $k$, and $\\sigma_{v}$. Your final answer must be a single analytic expression. Do not assume numerical values for $b$ or $f$. You may set $Q\\equiv\\left(k\\,\\sigma_{v}\\right)^{2}$ during intermediate steps if it is helpful, but the final answer must be expressed in terms of $k$ and $\\sigma_{v}$ explicitly rather than $Q$.",
            "solution": "This problem requires us to calculate the leading-order difference in the quadrupole-to-monopole ratio, $P_2(k)/P_0(k)$, between two models for the Fingers-of-God (FoG) effect in the small-$k$ limit (i.e., $k\\sigma_v \\ll 1$).\n\n**1. Taylor Expansion of Damping Terms**\n\nFirst, we Taylor expand the two FoG damping models in the small parameter $(k\\mu\\sigma_v)^2$. We need to expand up to the term where they first differ.\n\n*   **Gaussian Model:** $D_G(k,\\mu) = \\exp[-(k\\mu\\sigma_v)^2] = 1 - (k\\mu\\sigma_v)^2 + \\frac{1}{2}(k\\mu\\sigma_v)^4 - O((k\\sigma_v)^6)$\n*   **Lorentzian Model:** $D_L(k,\\mu) = [1+(k\\mu\\sigma_v)^2]^{-1} = 1 - (k\\mu\\sigma_v)^2 + (k\\mu\\sigma_v)^4 - O((k\\sigma_v)^6)$\n\nThe two models are identical up to order $(k\\sigma_v)^2$. The leading-order difference is:\n$$\n\\Delta D(k,\\mu) = D_L(k,\\mu) - D_G(k,\\mu) = \\frac{1}{2}(k\\mu\\sigma_v)^4 + O((k\\sigma_v)^6)\n$$\n\n**2. Perturbative Expansion of the Ratio Difference**\n\nThe difference in the ratio is $\\Delta(k) = \\frac{P_{2,L}}{P_{0,L}} - \\frac{P_{2,G}}{P_{0,G}}$. Let $P_{\\ell, L} = P_{\\ell, G} + \\delta P_\\ell$, where $\\delta P_\\ell$ is the change in the multipole due to $\\Delta D(k,\\mu)$. Since $\\Delta D$ is of order $(k\\sigma_v)^4$, $\\delta P_\\ell$ is also of this order. We can perform a first-order expansion:\n$$\n\\Delta(k) \\approx \\frac{\\delta P_2}{P_{0,G}} - \\frac{P_{2,G} \\delta P_0}{P_{0,G}^2} = \\frac{P_{0,G} \\delta P_2 - P_{2,G} \\delta P_0}{P_{0,G}^2}\n$$\nIn this expression, we only need the zeroth-order terms for $P_{0,G}$ and $P_{2,G}$, which are the standard Kaiser multipoles (without FoG damping). Let's call them $P_0^{(0)}$ and $P_2^{(0)}$.\n\n**3. Calculating Multipole Changes**\n\nThe change in the multipoles, $\\delta P_\\ell$, is found by integrating the change in the power spectrum:\n$$\n\\delta P_\\ell(k) = \\frac{2\\ell+1}{2} \\int_{-1}^1 d\\mu \\, P_r(k)(b+f\\mu^2)^2 \\left(\\frac{1}{2}(k\\mu\\sigma_v)^4\\right) L_\\ell(\\mu)\n$$\n$$\n\\delta P_\\ell(k) = \\frac{(k\\sigma_v)^4}{2} P_r(k) \\left( \\frac{2\\ell+1}{2} \\int_{-1}^1 d\\mu \\, (b+f\\mu^2)^2 \\mu^4 L_\\ell(\\mu) \\right)\n$$\nLet's calculate the required integrals. We need the zeroth-order multipoles $P_0^{(0)}$ and $P_2^{(0)}$, and the integrals for $\\delta P_0$ and $\\delta P_2$. We define $\\langle g(\\mu) \\rangle \\equiv \\frac{1}{2}\\int_{-1}^1 g(\\mu) d\\mu$.\n*   $P_0^{(0)}(k)/P_r(k) = \\langle (b+f\\mu^2)^2 \\rangle = b^2 + \\frac{2}{3}bf + \\frac{1}{5}f^2$\n*   $P_2^{(0)}(k)/P_r(k) = 5\\langle (b+f\\mu^2)^2 L_2(\\mu) \\rangle = \\frac{4}{3}bf + \\frac{4}{7}f^2$\n*   $\\delta P_0(k) / \\left(\\frac{1}{2}(k\\sigma_v)^4 P_r(k)\\right) = \\langle (b+f\\mu^2)^2 \\mu^4 \\rangle = \\frac{b^2}{5} + \\frac{2bf}{7} + \\frac{f^2}{9}$\n*   $\\delta P_2(k) / \\left(\\frac{1}{2}(k\\sigma_v)^4 P_r(k)\\right) = 5\\langle (b+f\\mu^2)^2 \\mu^4 L_2(\\mu) \\rangle = \\frac{4b^2}{7} + \\frac{20bf}{21} + \\frac{40f^2}{99}$\n\n**4. Assembling the Final Expression**\n\nNow we substitute these pieces back into the expression for $\\Delta(k)$. After a lengthy but straightforward algebraic simplification, we combine the polynomial terms. Let $A_0 = P_0^{(0)}/P_r(k)$, $B_0=P_2^{(0)}/P_r(k)$, $A_1 = \\delta P_0 / (\\frac{1}{2}(k\\sigma_v)^4 P_r(k))$, and $B_1 = \\delta P_2 / (\\frac{1}{2}(k\\sigma_v)^4 P_r(k))$.\n$$\n\\Delta(k) = \\frac{\\frac{1}{2}(k\\sigma_v)^4 P_r(k)^2 (A_0 B_1 - B_0 A_1)}{(P_r(k) A_0)^2} = \\frac{(k\\sigma_v)^4}{2} \\frac{A_0 B_1 - B_0 A_1}{A_0^2}\n$$\nPlugging in the expressions for the coefficients and combining them over a common denominator yields the final result.\nThe numerator term $A_0 B_1 - B_0 A_1$ simplifies to:\n$$ \\frac{4}{8085} \\left(1155b^4 + 2156b^3f + 1330b^2f^2 + 300bf^3 + 35f^4 \\right) $$\nThe denominator term $A_0^2$ is:\n$$ \\left(b^2 + \\frac{2}{3}bf + \\frac{1}{5}f^2\\right)^2 = \\frac{1}{225} \\left(15b^2 + 10bf + 3f^2\\right)^2 $$\nCombining all pre-factors: $\\frac{(k\\sigma_v)^4}{2} \\cdot \\frac{4/8085}{1/225} = (k\\sigma_v)^4 \\frac{2 \\cdot 225}{8085} = (k\\sigma_v)^4 \\frac{450}{8085} = (k\\sigma_v)^4 \\frac{30}{539}$.\nThis gives the final expression for the difference:\n$$\n\\Delta(k) = \\frac{30\\left(k\\sigma_{v}\\right)^{4}}{539}\\frac{1155b^{4} + 2156b^{3}f + 1330b^{2}f^{2} + 300bf^{3} + 35f^{4}}{\\left(15b^{2} + 10bf + 3f^{2}\\right)^{2}}\n$$",
            "answer": "$$\\boxed{\\frac{30\\left(k\\sigma_{v}\\right)^{4}}{539}\\frac{1155b^{4} + 2156b^{3}f + 1330b^{2}f^{2} + 300bf^{3} + 35f^{4}}{\\left(15b^{2} + 10bf + 3f^{2}\\right)^{2}}}$$"
        },
        {
            "introduction": "Measuring the power spectrum multipoles from a discrete set of tracers, either in a simulation or a real survey, introduces a host of numerical challenges that can bias results if not handled correctly. This exercise moves from pure theory to the practicalities of estimation, testing your understanding of how to mitigate key systematics like mass-assignment window effects, aliasing, and shot noise. Mastering these techniques is the critical final step in reliably connecting theoretical predictions to cosmological data. ",
            "id": "3483985",
            "problem": "You are modeling redshift-space distortions in a periodic cubic volume of side length $L$ with plane-parallel line-of-sight $\\hat{\\boldsymbol{z}}$. The redshift-space position $\\boldsymbol{s}$ of a tracer with real-space position $\\boldsymbol{r}$ and peculiar velocity $\\boldsymbol{v}$ obeys the mapping $\\boldsymbol{s} = \\boldsymbol{r} + \\left(v_{\\parallel}/aH\\right)\\hat{\\boldsymbol{z}}$, where $v_{\\parallel} \\equiv \\boldsymbol{v}\\cdot\\hat{\\boldsymbol{z}}$, $a$ is the scale factor, and $H$ is the Hubble rate. Let $\\delta(\\boldsymbol{r})$ be the overdensity field of tracers and $\\delta_s(\\boldsymbol{k})$ its Fourier transform in redshift space. In linear theory, the Kaiser effect relates the anisotropic redshift-space overdensity and the real-space overdensity via $\\delta_s(\\boldsymbol{k})$ whose statistical properties are encoded in the anisotropic power spectrum $P_s(k,\\mu)$, where $k \\equiv |\\boldsymbol{k}|$ and $\\mu \\equiv \\hat{\\boldsymbol{k}}\\cdot\\hat{\\boldsymbol{z}}$. The multipoles $P_{\\ell}(k)$ of $P_s(k,\\mu)$ are defined by projecting onto the Legendre polynomials $\\mathcal{L}_{\\ell}(\\mu)$ and averaging over directions.\n\nYou want to implement a Fast Fourier Transform (FFT)-based estimator for $P_{\\ell}(k)$ on a uniform grid with $N^3$ cells using a standard mass assignment scheme (e.g., Cloud-in-Cell), and you are concerned about both mass-assignment window effects and aliasing due to discrete sampling. You can mitigate aliasing by interlacing, i.e., combining the Fourier transforms of two density grids: one on the original grid and one shifted by half a cell along each Cartesian axis.\n\nWhich of the following procedures correctly describes an FFT-based estimation of $P_{\\ell}(k)$ using $\\mathcal{L}_{\\ell}(\\hat{\\boldsymbol{k}}\\cdot\\hat{\\boldsymbol{z}})$ weights, with proper treatment of mass assignment, shot noise, and interlacing to mitigate aliasing, under the plane-parallel approximation?\n\nA. Construct $\\delta(\\boldsymbol{r})$ on the grid, apply Fast Fourier Transform (FFT) to obtain $\\delta_s(\\boldsymbol{k})$, and estimate $P_{\\ell}(k)$ by averaging $\\delta_s(\\boldsymbol{k})\\,\\delta_s(-\\boldsymbol{k})$ weighted by $\\mathcal{L}_{\\ell}(\\hat{\\boldsymbol{k}}\\cdot\\hat{\\boldsymbol{z}})$ over thin shells in $k$. Correct for the mass assignment by dividing the power by $|W(\\boldsymbol{k})|^2$, where $W(\\boldsymbol{k})$ is the assignment window, subtract isotropic Poisson shot noise from $\\ell=0$ only, and mitigate aliasing by averaging the Fourier amplitudes from two interlaced grids: one on the original grid and one shifted by half a cell along all three axes, before forming the power spectrum.\n\nB. Multiply $\\delta(\\boldsymbol{r})$ in configuration space by $\\mathcal{L}_{\\ell}(\\hat{\\boldsymbol{r}}\\cdot\\hat{\\boldsymbol{z}})$ prior to FFT so that the anisotropy is imprinted in real space, then compute $P_{\\ell}(k)$ by averaging the squared Fourier amplitudes over $k$-shells without any further angular weights; since the Legendre weighting was applied in real space, no mass assignment deconvolution or shot-noise subtraction is needed, and aliasing is negligible.\n\nC. Estimate $P_{\\ell}(k)$ by binning $\\delta_s(\\boldsymbol{k})\\,\\delta_s(-\\boldsymbol{k})$ over $k$-shells and weighting each mode by $\\mathcal{L}_{\\ell}(\\hat{\\boldsymbol{k}}\\cdot\\hat{\\boldsymbol{z}})$, subtract Poisson shot noise from all multipoles $\\ell\\geq 0$, and reduce aliasing by subtracting (not averaging) the Fourier amplitudes of a grid shifted by half a cell from those of the original grid; window-function deconvolution is unnecessary because it cancels in the auto-power.\n\nD. Compute $P_{\\ell}(k)$ by averaging $\\delta_s(\\boldsymbol{k})\\,\\delta_s(-\\boldsymbol{k})$ with $\\mathcal{L}_{\\ell}(\\hat{\\boldsymbol{k}}\\cdot\\hat{\\boldsymbol{z}})$ weights over $k$-shells, but instead of interlacing across all three axes, shift the second grid by half a cell along only the $\\hat{\\boldsymbol{z}}$ direction to target line-of-sight aliasing, and subtract shot noise from $\\ell>0$ multipoles because the anisotropy makes the noise directional; the mass-assignment window can be ignored at low $k$.\n\nChoose the single best option that is scientifically correct and complete in the stated sense. Justify your choice by appealing to first-principles definitions of Fourier estimation, multipole projection, mass-assignment convolution, and the mechanism by which interlacing suppresses aliasing images.",
            "solution": "The goal is to identify the correct procedure to estimate the power spectrum multipoles, $P_{\\ell}(k)$, from a discrete set of tracers using a Fast Fourier Transform (FFT)-based method, while properly accounting for several key numerical systematics. Let's break down the requirements and evaluate the options based on first principles.\n\n**1. Power Spectrum Multipole Estimation**\nThe anisotropic power spectrum $P_s(k, \\mu)$ is expanded in Legendre polynomials $\\mathcal{L}_{\\ell}(\\mu)$ with coefficients $P_{\\ell}(k)$. A numerical estimator for $P_{\\ell}(k)$ is formed by averaging the power of individual Fourier modes $\\boldsymbol{k}$ within a spherical shell of radius $k$. The power of each mode, $|\\delta_s(\\boldsymbol{k})|^2$, must be weighted by the corresponding Legendre polynomial $\\mathcal{L}_{\\ell}(\\mu_{\\boldsymbol{k}})$ before averaging, where $\\mu_{\\boldsymbol{k}} = \\hat{\\boldsymbol{k}}\\cdot\\hat{\\boldsymbol{z}}$. The term $\\delta_s(\\boldsymbol{k})\\,\\delta_s(-\\boldsymbol{k})$ is equivalent to $|\\delta_s(\\boldsymbol{k})|^2$ for a real-valued density field.\n\n**2. Mass Assignment Window Function**\nThe process of assigning discrete particles to a grid (mass assignment) is equivalent to convolving the true continuous density field with the window function of the assignment scheme (e.g., Cloud-in-Cell). In Fourier space, this convolution becomes a multiplication: the Fourier transform of the gridded density is suppressed by the Fourier transform of the window, $W(\\boldsymbol{k})$. Therefore, the measured power spectrum is suppressed by $|W(\\boldsymbol{k})|^2$. To obtain the correct power, the estimated power spectrum must be divided by $|W(\\boldsymbol{k})|^2$ on a mode-by-mode basis. This is a crucial deconvolution step.\n\n**3. Poisson Shot Noise**\nA density field sampled with a finite number of discrete tracers ($N_p$) in a volume ($V$) contains Poisson shot noise. For unweighted tracers, this adds a constant, isotropic (direction-independent) term to the power spectrum, $P_{\\text{shot}} = 1/\\bar{n}$, where $\\bar{n}=N_p/V$. Because this noise is isotropic, it only contributes to the isotropic part of the power spectrum, which is the monopole ($\\ell=0$). The contribution to higher-order multipoles ($\\ell > 0$) is zero by the orthogonality of Legendre polynomials. Thus, the shot noise estimate must be subtracted from the monopole, $P_0(k)$, only.\n\n**4. Aliasing and Interlacing**\nSampling a continuous field on a discrete grid causes power from frequencies above the Nyquist frequency to be aliased (or \"folded\") into the measured frequency range, creating a systematic error. The interlacing technique is designed to suppress this. It involves creating two density grids, one original and one shifted by half a cell in each direction. The Fourier transforms of these two grids, $\\delta_1(\\boldsymbol{k})$ and $\\delta_2(\\boldsymbol{k})$, are then averaged in complex space: $\\delta_{\\text{eff}}(\\boldsymbol{k}) = (\\delta_1(\\boldsymbol{k}) + \\delta_2(\\boldsymbol{k}))/2$. The leading-order aliasing contributions have opposite phases in the two grids and cancel out in this average. The power spectrum is then computed from this cleaned field, i.e., $|\\delta_{\\text{eff}}(\\boldsymbol{k})|^2$. Simply averaging the two power spectra, $|\\delta_1(\\boldsymbol{k})|^2$ and $|\\delta_2(\\boldsymbol{k})|^2$, does not cancel the aliasing terms.\n\n**Evaluating the Options:**\n\n*   **Option A:** This option correctly describes all four steps: (1) it weights the power by $\\mathcal{L}_{\\ell}(\\mu_{\\boldsymbol{k}})$, (2) it divides by the window function squared, (3) it subtracts shot noise from the monopole ($\\ell=0$) only, and (4) it correctly describes interlacing as averaging the complex Fourier amplitudes *before* computing the power.\n*   **Option B:** This option is fundamentally flawed. Multiplying by $\\mathcal{L}_{\\ell}(\\hat{\\boldsymbol{r}}\\cdot\\hat{\\boldsymbol{z}})$ in configuration space is incorrect; the Legendre decomposition is defined in Fourier space with respect to the wavevector angle $\\mu = \\hat{\\boldsymbol{k}}\\cdot\\hat{\\boldsymbol{z}}$. It also incorrectly claims window deconvolution and shot noise subtraction are unnecessary.\n*   **Option C:** This option is incorrect on multiple counts. It wrongly states that shot noise should be subtracted from all multipoles. It describes an incorrect method for aliasing reduction (subtracting amplitudes). It also falsely claims window deconvolution is unnecessary.\n*   **Option D:** This option is also incorrect. It suggests an incomplete 1D shift for interlacing, which would not suppress aliasing from all directions. It also misunderstands shot noise, claiming it is anisotropic and should be subtracted from $\\ell > 0$ multipoles, which is the opposite of the correct procedure.\n\n**Conclusion:**\nOption A provides the only scientifically correct and complete description of the procedure. It accurately captures the standard methodology for FFT-based power spectrum multipole estimation, including the proper handling of all specified numerical effects.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}