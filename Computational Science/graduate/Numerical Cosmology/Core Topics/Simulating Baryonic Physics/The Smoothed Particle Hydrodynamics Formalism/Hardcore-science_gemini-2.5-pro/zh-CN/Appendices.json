{
    "hands_on_practices": [
        {
            "introduction": "平滑核是平滑粒子流体动力学（SPH）方法的基石，它定义了物理量如何从离散的粒子中进行插值。为了使SPH方法能够正确地表示密度等量并保证质量守恒，平滑核在整个空间上的积分必须为一。这个基础的归一化练习  将引导您在任意维度下，为一个普适的、球对称的平滑核推导其归一化常数，从而巩固该方法的一个至关重要的第一性原理。",
            "id": "3534761",
            "problem": "在光滑粒子流体动力学（Smoothed Particle Hydrodynamics, SPH）中，光滑核函数必须被归一化，以确保其在 $ \\nu $ 维欧几里得空间中质量守恒。考虑一个形式为 $ W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h) $ 的球对称核函数，其具有紧支撑 $ 0 \\le r  \\kappa h $，其中 $ \\kappa > 0 $ 是一个有限的支撑参数，$ h > 0 $ 是光滑长度，$ f:[0,\\kappa) \\to \\mathbb{R}_{\\ge 0} $ 是一个无量纲的形状函数，满足当 $ q \\ge \\kappa $ 时 $ f(q) = 0 $。根据归一化要求 $ \\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1 $，推导归一化常数 $ \\sigma_{\\nu} $ 关于 $ \\nu $、$ \\kappa $ 和 $ f $ 的闭式解析表达式。你可以使用一个标准事实，即 $ \\nu $ 维空间中单位球面的表面积为 $ S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)} $。请将你的最终答案表示为 $ \\sigma_{\\nu} $ 的单一解析表达式。最终答案中不需要进行数值近似，也不需要单位。",
            "solution": "该问题要求推导在 $\\nu$ 维欧几里得空间中，球对称光滑核函数 $W(r,h)$ 的归一化常数 $\\sigma_{\\nu}$ 的闭式解析表达式。\n\n首先，我们对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 光滑核函数由 $W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$ 给出。\n- 空间是 $\\nu$ 维欧几里得空间，$\\mathbb{R}^{\\nu}$。\n- $r = |\\boldsymbol{x}|$ 是径向距离。\n- $h > 0$ 是光滑长度。\n- $\\sigma_{\\nu}$ 是待求的归一化常数。\n- $f(q)$ 是一个无量纲的形状函数，其中 $q = r/h$。\n- 核函数在 $0 \\le r  \\kappa h$ 上具有紧支撑，其中 $\\kappa > 0$ 是一个有限的支撑参数。这意味着当 $q \\ge \\kappa$ 时，$f(q) = 0$。\n- 归一化要求是 $\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1$。\n- $\\nu$ 维空间中单位球面的表面积由 $S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$ 给出。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是光滑粒子流体动力学（SPH）理论中的一个标准且基础的推导，SPH 是计算物理学中一种成熟的方法。核函数归一化、紧支撑以及超球坐标的使用等概念都是标准且可靠的。\n- **适定性：** 该问题提供了一个明确的目标（求 $\\sigma_{\\nu}$），并附带了所有必要的约束和定义。预期会有一个唯一的、有意义的解。\n- **客观性：** 该问题以精确的数学语言陈述，没有歧义或主观性。\n- **结论：** 该问题是有效的，因为它科学可靠、适定、客观，并且不违反任何无效标准。\n\n我们现在开始求解。\n\n出发点是归一化条件：\n$$\n\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1\n$$\n我们将给定的核函数形式 $W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$ 代入，其中 $r = |\\boldsymbol{x}|$：\n$$\n\\int_{\\mathbb{R}^{\\nu}} \\sigma_{\\nu}\\, h^{-\\nu}\\, f(|\\boldsymbol{x}|/h)\\, \\mathrm{d}^{\\nu} x = 1\n$$\n由于被积函数是球对称的（它只依赖于模长 $r=|\\boldsymbol{x}|$），因此从笛卡尔坐标切换到 $\\nu$ 维超球坐标是有利的。在超球坐标中，体积元 $\\mathrm{d}^{\\nu} x$ 由 $\\mathrm{d}^{\\nu} x = r^{\\nu-1} \\mathrm{d}r\\, \\mathrm{d}\\Omega_{\\nu-1}$ 给出，其中 $\\mathrm{d}\\Omega_{\\nu-1}$ 是 $(\\nu-1)$ 维单位球面上的无穷小立体角元。\n\n积分可以重写为：\n$$\n\\int_0^\\infty \\int_{S_{\\nu-1}} \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)\\, r^{\\nu-1} \\mathrm{d}\\Omega_{\\nu-1} \\mathrm{d}r = 1\n$$\n被积函数不依赖于角度变量。因此，对立体角 $\\mathrm{d}\\Omega_{\\nu-1}$ 的积分得到 $(\\nu-1)$ 维单位球面的总表面积，即 $S_{\\nu-1}$。\n$$\nS_{\\nu-1} \\int_0^\\infty \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\n常数 $\\sigma_{\\nu}$ 和 $h^{-\\nu}$ 可以移到积分符号外面：\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\int_0^\\infty f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\n核函数具有紧支撑，意味着当 $r \\ge \\kappa h$ 时 $f(r/h) = 0$。这将径向积分的上限从 $\\infty$ 修改为 $\\kappa h$。\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\int_0^{\\kappa h} f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\n为了计算剩余的积分，我们进行变量替换。令 $q = r/h$。则 $r = qh$ 且 $\\mathrm{d}r = h\\, \\mathrm{d}q$。新变量 $q$ 的积分限从 $r=0 \\implies q=0$ 到 $r=\\kappa h \\implies q=\\kappa$。将这些代入积分中：\n$$\n\\int_0^{\\kappa h} f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = \\int_0^{\\kappa} f(q)\\, (qh)^{\\nu-1} (h\\, \\mathrm{d}q)\n$$\n$$\n= \\int_0^{\\kappa} f(q)\\, q^{\\nu-1}\\, h^{\\nu-1}\\, h\\, \\mathrm{d}q = h^{\\nu} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q\n$$\n现在我们将这个结果代回到归一化方程中：\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\left( h^{\\nu} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q \\right) = 1\n$$\n$h^{-\\nu}$ 和 $h^{\\nu}$ 项相互抵消，这证实了归一化常数 $\\sigma_{\\nu}$ 与光滑长度 $h$ 的具体选择无关。\n$$\n\\sigma_{\\nu}\\, S_{\\nu-1} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q = 1\n$$\n我们现在可以解出 $\\sigma_{\\nu}$：\n$$\n\\sigma_{\\nu} = \\frac{1}{S_{\\nu-1} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\n最后，我们代入给定的 $(\\nu-1)$ 维球面的表面积表达式 $S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$：\n$$\n\\sigma_{\\nu} = \\frac{1}{\\left( \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)} \\right) \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\n这可以简化为归一化常数 $\\sigma_{\\nu}$ 的最终闭式解析表达式：\n$$\n\\sigma_{\\nu} = \\frac{\\Gamma(\\nu/2)}{2 \\pi^{\\nu/2} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\n如题所求，$\\sigma_{\\nu}$ 的这个表达式依赖于维度 $\\nu$、支撑参数 $\\kappa$（作为积分的上限）以及形状函数 $f$ 的形式。",
            "answer": "$$\\boxed{\\frac{\\Gamma(\\frac{\\nu}{2})}{2 \\pi^{\\frac{\\nu}{2}} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}}$$"
        },
        {
            "introduction": "尽管欧拉方程是唯一的，但其SPH离散化方案并非如此。不同的SPH“格式”，例如密度-能量格式和压力-熵格式，可能具有截然不同的数值行为，尤其是在流体界面处。本练习  使用开尔文-亥姆霍兹不稳定性的物理基准问题来诊断和量化一个常见的数值伪影——虚假表面张力，从而展示了压力-熵格式在处理接触间断时的优越性。",
            "id": "3498213",
            "problem": "要求您构建、分析并实现一个简化的线性理论诊断工具，用于在开尔文-亥姆霍兹不稳定性（KHI）的背景下，评估光滑粒子流体动力学（SPH）方法中不同格式选择对接触间断处伪表面张力的影响。从两种无粘、不互溶、可压缩流体在亚音速、小扰动极限下的欧拉方程出发，将其特化为经典的不可压缩、无旋线性分析模型。该模型描述了一个平面剪切层，该剪切层分隔了两种半无限流体，它们的密度分别为 $\\rho_{1}$ 和 $\\rho_{2}$，均匀水平速度为 $U_{1}$ 和 $U_{2}$，平衡压力均为 $P_{0}$，并存在一个波数为 $k$、振幅为无穷小的单模界面扰动。在界面上施加运动学边界条件，以及包含一个由集中在接触间断处的有效表面张力 $S$ 引起的类毛细恢复力的动力学边界条件。\n\n在这些假设下，推导与 $\\exp\\!\\left[i k x - \\omega t\\right]$ 成正比的简正模扰动的色散关系，并获得线性增长率 $\\gamma \\equiv \\operatorname{Im}\\,\\omega \\ge 0$ 作为 $\\rho_{1}$、$\\rho_{2}$、$\\Delta U \\equiv U_{1}-U_{2}$、$k$ 和 $S$ 的函数的显式表达式。然后，给定时间 $t$，定义振幅增益因子 $G \\equiv \\exp\\!\\left(\\gamma t\\right)$。\n\n将 SPH 中的伪表面张力效应建模为有效界面张力\n$$\nS_{\\mathrm{eff}} = C\\, P_{0}\\, h,\n$$\n其中 $C$ 是一个无量纲且依赖于格式的系数，$P_{0}$ 是界面处的平衡压力，$h$ 是光滑长度。使用此模型表示在相同初始条件下的两种 SPH 格式（不同计算运行之间的场是匹配的，而非不同相之间的场）：密度-能量格式（设置 $C = C_{\\mathrm{DE}}$）和压力-熵格式（设置 $C = C_{\\mathrm{PE}}$）。假设理想气体状态方程，因此在接触间断处，$\\rho_{1} \\ne \\rho_{2}$ 且 $P_{0}$ 相等意味着界面两侧的熵函数不同，这是密度-能量格式中产生伪张力效应的根源；而压力-熵格式通过其构造抑制了这种效应。\n\n实现一个程序，对于下方的每个测试用例，在时间 $t$ 计算三个无量纲振幅增益因子：$S=0$ 时的解析无表面张力增益 $G_{\\mathrm{an}}$，使用 $S=S_{\\mathrm{eff}}$ 和 $C=C_{\\mathrm{DE}}$ 的密度-能量 SPH 模型增益 $G_{\\mathrm{DE}}$，以及使用 $S=S_{\\mathrm{eff}}$ 和 $C=C_{\\mathrm{PE}}$ 的压力-熵 SPH 模型增益 $G_{\\mathrm{PE}}$。如果推导出的色散关系预测给定参数下系统是线性稳定的（即，非增长模），则将增长率 $\\gamma$ 设为 $0$，从而使得 $G=1$。所有量都应视为无量纲代码单位；所有输出均报告为无单位的无量纲数。\n\n测试套件参数（每个元组为 $(\\rho_{1}, \\rho_{2}, U_{1}, U_{2}, k, P_{0}, h, C_{\\mathrm{DE}}, C_{\\mathrm{PE}}, t)$）：\n- 情况 A（理想路径，中等对比度，所有模型中均不稳定）：$(1.0, 2.0, +0.5, -0.5, 2\\pi, 1.0, 0.02, 0.25, 0.0, 2.0)$。\n- 情况 B（边界情况，密度-能量模型因伪张力而稳定，而解析模型和压力-熵模型中则增长）：$(1.0, 2.0, +0.25, -0.25, 4\\pi, 1.0, 0.2, 0.25, 0.0, 2.0)$。\n- 情况 C（密度相等，检查对称性）：$(1.0, 1.0, +0.5, -0.5, 2\\pi, 1.0, 0.05, 0.25, 0.0, 2.0)$。\n- 情况 D（密度-能量模型的近阈值行为）：$(1.0, 2.0, +0.15, -0.15, 3\\pi, 1.0, 0.02, 0.25, 0.0, 3.0)$。\n\n您的程序必须：\n- 推导并使用您从第一性原理得到的线性增长率 $\\gamma$ 以及上述有效 $S_{\\mathrm{eff}}$ 模型。\n- 对每种情况，按顺序计算并收集三元组 $\\left(G_{\\mathrm{an}}, G_{\\mathrm{DE}}, G_{\\mathrm{PE}}\\right)$。\n- 生成单行输出，其中包含所有结果，按情况顺序排列，形式为一个用方括号括起来的逗号分隔列表。该列表必须按 $\\left[G_{\\mathrm{an}}^{(A)}, G_{\\mathrm{DE}}^{(A)}, G_{\\mathrm{PE}}^{(A)}, G_{\\mathrm{an}}^{(B)}, G_{\\mathrm{DE}}^{(B)}, G_{\\mathrm{PE}}^{(B)}, G_{\\mathrm{an}}^{(C)}, G_{\\mathrm{DE}}^{(C)}, G_{\\mathrm{PE}}^{(C)}, G_{\\mathrm{an}}^{(D)}, G_{\\mathrm{DE}}^{(D)}, G_{\\mathrm{PE}}^{(D)}\\right]$ 的顺序展平。每个浮点数最多表示为 6 位小数。\n\n设计覆盖范围：\n- 情况 A 检验具有适度伪张力抑制的一般不稳定区域。\n- 情况 B 探测由密度-能量格式中的伪张力引起的稳定边界。\n- 情况 C 测试增长率简化的等密度极限。\n- 情况 D 探测对参数的近阈值敏感性，确保正确处理小的正增长率。\n\n最终答案必须是如下文指定的完整、可运行的程序。",
            "solution": "该问题要求推导并应用开尔文-亥姆霍兹不稳定性（KHI）的线性增长率，该理论适用于两种无粘、无旋、不可压缩流体之间的平面界面，并考虑了表面张力的影响。这为理解光滑粒子流体动力学（SPH）模拟中的伪数值伪影提供了一个诊断工具。\n\n出发点是两种半无限流体界面上形式为 $\\exp[i(kx - \\omega t)]$ 的简正模扰动的色散关系。流体1（密度 $\\rho_1$，速度 $U_1$）占据上半空间（$y>0$），流体2（密度 $\\rho_2$，速度 $U_2$）占据下半空间（$y0$）。这是流体动力学中的一个经典结果，通常通过对欧拉方程进行线性化，并在受扰动的界面上应用运动学和动力学边界条件来推导。该问题忽略了重力。包含界面表面张力 $S$ 的最终色散关系为：\n$$\n\\rho_1 (\\omega - k U_1)^2 + \\rho_2 (\\omega - k U_2)^2 = S k^3\n$$\n此处，$k$ 是扰动的波数，$\\omega$ 是其复频率。$\\omega$ 的实部对应相速度，虚部 $\\gamma \\equiv \\operatorname{Im}(\\omega)$ 对应不稳定性的增长率。\n\n这个方程是关于 $\\omega$ 的一个二次方程：\n$$\n(\\rho_1 + \\rho_2)\\omega^2 - 2k(\\rho_1 U_1 + \\rho_2 U_2)\\omega + [k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - S k^3] = 0\n$$\n我们使用二次公式 $\\omega = (-b \\pm \\sqrt{b^2-4ac})/(2a)$ 求解 $\\omega$，其中：\n$a = \\rho_1 + \\rho_2$\n$b = -2k(\\rho_1 U_1 + \\rho_2 U_2)$\n$c = k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - S k^3$\n\n$\\omega$ 的解为：\n$$\n\\omega = \\frac{2k(\\rho_1 U_1 + \\rho_2 U_2) \\pm \\sqrt{4k^2(\\rho_1 U_1 + \\rho_2 U_2)^2 - 4(\\rho_1+\\rho_2)(k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - Sk^3)}}{2(\\rho_1+\\rho_2)}\n$$\n当判别式为负时，存在不稳定性，此时 $\\omega$ 的解为共轭复根。增长率 $\\gamma$ 是 $\\omega$ 的虚部。\n我们来分析判别式 $\\Delta = b^2 - 4ac$：\n$$\n\\Delta = 4k^2(\\rho_1 U_1 + \\rho_2 U_2)^2 - 4(\\rho_1+\\rho_2)(k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - Sk^3)\n$$\n平方根内与速度相关的项可简化为：\n$$\n(\\rho_1 U_1 + \\rho_2 U_2)^2 - (\\rho_1+\\rho_2)(\\rho_1 U_1^2 + \\rho_2 U_2^2) \\\\\n= (\\rho_1^2 U_1^2 + \\rho_2^2 U_2^2 + 2\\rho_1\\rho_2 U_1 U_2) - (\\rho_1^2 U_1^2 + \\rho_1\\rho_2 U_2^2 + \\rho_2\\rho_1 U_1^2 + \\rho_2^2 U_2^2) \\\\\n= -\\rho_1\\rho_2(U_1^2 - 2U_1U_2 + U_2^2) = -\\rho_1\\rho_2(U_1 - U_2)^2 = -\\rho_1\\rho_2 (\\Delta U)^2\n$$\n其中 $\\Delta U \\equiv U_1 - U_2$。\n将此代回 $\\Delta$ 的表达式中：\n$$\n\\Delta = 4k^2 [-\\rho_1\\rho_2 (\\Delta U)^2] + 4k^3 S (\\rho_1+\\rho_2) = 4k^2 [kS(\\rho_1+\\rho_2) - \\rho_1\\rho_2(\\Delta U)^2]\n$$\n当 $\\Delta  0$ 时发生不稳定性，这要求方括号中的项为负。此时 $\\omega$ 的解变为：\n$$\n\\omega = k\\frac{\\rho_1 U_1 + \\rho_2 U_2}{\\rho_1+\\rho_2} \\pm i \\frac{\\sqrt{-\\Delta}}{2(\\rho_1+\\rho_2)}\n$$\n增长率 $\\gamma = \\operatorname{Im}(\\omega)$ 是正的虚部：\n$$\n\\gamma = \\frac{\\sqrt{-\\Delta}}{2(\\rho_1+\\rho_2)} = \\frac{\\sqrt{4k^2[\\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)]}}{2(\\rho_1+\\rho_2)}\n$$\n$$\n\\gamma = \\frac{k}{\\rho_1+\\rho_2} \\sqrt{\\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)}\n$$\n此表达式仅在平方根下的项为非负时有效，这也是不稳定的条件：$\\rho_1\\rho_2(\\Delta U)^2 > kS(\\rho_1+\\rho_2)$。如果不满足此条件，则模态是稳定或中性稳定的，增长率为零。因此，我们将 $\\gamma$ 定义为：\n$$\n\\gamma = \\frac{k}{\\rho_1+\\rho_2} \\sqrt{\\max\\left(0, \\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)\\right)}\n$$\n该问题将 SPH 模拟中的伪表面张力建模为有效表面张力 $S_{\\mathrm{eff}} = C P_0 h$。我们计算三种情况下的增长率：\n1.  解析情况（$S=0$）：用 $S=0$ 计算 $\\gamma_{\\mathrm{an}}$。\n2.  密度-能量 SPH（$S=S_{\\mathrm{DE}}$）：用 $S = S_{\\mathrm{DE}} = C_{\\mathrm{DE}} P_0 h$ 计算 $\\gamma_{\\mathrm{DE}}$。\n3.  压力-熵 SPH（$S=S_{\\mathrm{PE}}$）：用 $S = S_{\\mathrm{PE}} = C_{\\mathrm{PE}} P_0 h$ 计算 $\\gamma_{\\mathrm{PE}}$。\n\n最后，在给定时间 $t$ 的振幅增益因子定义为 $G = \\exp(\\gamma t)$。\n\n每个测试用例的算法如下：\n1.  提取参数：$(\\rho_1, \\rho_2, U_1, U_2, k, P_0, h, C_{\\mathrm{DE}}, C_{\\mathrm{PE}}, t)$。\n2.  计算 $\\Delta U = U_1 - U_2$。\n3.  计算 $S_{\\mathrm{DE}} = C_{\\mathrm{DE}} P_0 h$ 和 $S_{\\mathrm{PE}} = C_{\\mathrm{PE}} P_0 h$。\n4.  分别使用 $S=0$、$S=S_{\\mathrm{DE}}$ 和 $S=S_{\\mathrm{PE}}$，利用推导出的 $\\gamma$ 公式计算 $\\gamma_{\\mathrm{an}}$、$\\gamma_{\\mathrm{DE}}$ 和 $\\gamma_{\\mathrm{PE}}$。\n5.  计算相应的增益因子 $G_{\\mathrm{an}} = \\exp(\\gamma_{\\mathrm{an}} t)$、$G_{\\mathrm{DE}} = \\exp(\\gamma_{\\mathrm{DE}} t)$ 和 $G_{\\mathrm{PE}} = \\exp(\\gamma_{\\mathrm{PE}} t)$。\n6.  收集三元组 $(G_{\\mathrm{an}}, G_{\\mathrm{DE}}, G_{\\mathrm{PE}})$。\n最终输出是所有测试用例的这些三元组的展平列表。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the amplitude gain factors for Kelvin-Helmholtz instability\n    under different SPH formulation models.\n    \"\"\"\n    \n    # Test suite parameters:\n    # (rho1, rho2, U1, U2, k, P0, h, C_DE, C_PE, t)\n    test_cases = [\n        (1.0, 2.0, 0.5, -0.5, 2 * np.pi, 1.0, 0.02, 0.25, 0.0, 2.0),\n        (1.0, 2.0, 0.25, -0.25, 4 * np.pi, 1.0, 0.2, 0.25, 0.0, 2.0),\n        (1.0, 1.0, 0.5, -0.5, 2 * np.pi, 1.0, 0.05, 0.25, 0.0, 2.0),\n        (1.0, 2.0, 0.15, -0.15, 3 * np.pi, 1.0, 0.02, 0.25, 0.0, 3.0),\n    ]\n\n    results = []\n\n    def calculate_growth_rate(rho1, rho2, delta_U, k, S):\n        \"\"\"\n        Calculates the KHI linear growth rate gamma.\n        \n        Args:\n            rho1 (float): Density of fluid 1.\n            rho2 (float): Density of fluid 2.\n            delta_U (float): Velocity difference U1 - U2.\n            k (float): Wavenumber.\n            S (float): Surface tension.\n            \n        Returns:\n            float: The growth rate gamma.\n        \"\"\"\n        shear_term = rho1 * rho2 * delta_U**2\n        tension_term = k * S * (rho1 + rho2)\n        \n        # Argument of the square root\n        instability_criterion = shear_term - tension_term\n        \n        if instability_criterion = 0:\n            return 0.0\n        \n        gamma = (k / (rho1 + rho2)) * np.sqrt(instability_criterion)\n        return gamma\n\n    for case in test_cases:\n        rho1, rho2, U1, U2, k, P0, h, C_DE, C_PE, t = case\n        \n        delta_U = U1 - U2\n        \n        # Case 1: Analytic (no surface tension)\n        S_an = 0.0\n        gamma_an = calculate_growth_rate(rho1, rho2, delta_U, k, S_an)\n        G_an = np.exp(gamma_an * t)\n        \n        # Case 2: Density-Energy SPH model\n        S_DE = C_DE * P0 * h\n        gamma_DE = calculate_growth_rate(rho1, rho2, delta_U, k, S_DE)\n        G_DE = np.exp(gamma_DE * t)\n        \n        # Case 3: Pressure-Entropy SPH model\n        S_PE = C_PE * P0 * h\n        gamma_PE = calculate_growth_rate(rho1, rho2, delta_U, k, S_PE)\n        G_PE = np.exp(gamma_PE * t)\n        \n        results.extend([G_an, G_DE, G_PE])\n\n    # Format the output as specified: a comma-separated list of floats\n    # with up to 6 decimal places, enclosed in square brackets.\n    formatted_results = []\n    for r in results:\n        if r == 1.0:\n            formatted_results.append(\"1.0\")\n        else:\n            # {:f} gives 6 decimal places by default\n            formatted_results.append(f\"{r:.6f}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一次成功的模拟不仅需要一个可靠的数值方案，还需要足够的分辨率来捕捉感兴趣的物理现象。本实践  深入探讨了为瑞利-泰勒不稳定性确定模拟设置要求的实际任务。通过将该不稳定性的线性增长率与SPH的平滑长度和时间步长标准联系起来，您将学习如何确定所需的最小粒子分辨率和最大时间步长，以确保您的模拟既准确又稳定。",
            "id": "3498260",
            "problem": "您的任务是，在引力场中，使用平滑粒子流体动力学 (SPH) 形式体系，推导、实现并应用一个分辨率判据，以捕捉 Rayleigh–Taylor 不稳定性的早期增长。考虑两种无粘、不可压缩的正压流体，其密度分别为 $\\rho_{\\mathrm{h}}$ 和 $\\rho_{\\mathrm{l}}$ (其中 $\\rho_{\\mathrm{h}} > \\rho_{\\mathrm{l}}$)。它们初始时在一个大小为 $g$、方向沿 $-y$ 轴的均匀引力场下处于流体静力学平衡状态。两种流体在 $y = 0$ 处分界，较重的流体在上方 ($y > 0$)，较轻的流体在下方 ($y  0$)。在界面上施加一个波长为 $\\lambda$ 的单模小振幅正弦扰动。假设没有表面张力并忽略粘性。Atwood 数定义为 $A = (\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}})/(\\rho_{\\mathrm{h}} + \\rho_{\\mathrm{l}})$，扰动波数为 $k = 2\\pi/\\lambda$。\n\n从包含引力的 Euler 方程出发，围绕流体静力学平衡进行线性化，以构建 Rayleigh–Taylor 不稳定性的早期正规模增长模型。使用平滑长度为 $h$ 的高斯核对 SPH 平滑进行建模，以表示基于离散粒子的平滑如何修正连续场，并假设 SPH 中的有效增长率因核函数在扰动波数处的傅里叶变换所引入的因子而乘性减小。通过将增长率的相对误差限制在预设容差 $\\epsilon_{\\mathrm{s}}$ 内来定义空间分辨率要求，即 SPH 修正后的增长率与连续线性增长率的相对差异不超过 $\\epsilon_{\\mathrm{s}}$。此外，强制要求一个时间步长要求，即指数增长的显式积分在每步的近似相对容差在 $\\epsilon_{\\mathrm{t}}$ 以内，并且还需遵守声速为 $c_{\\mathrm{s}}$、Courant 因子为 $C$ 的 Courant–Friedrichs–Lewy (CFL) 条件。\n\n使用以下物理和数值基本假设：\n- 连续介质的早期增长率仅由引力作用下的线性化 Euler 方程确定，并取决于 Atwood 数和波数。\n- 平滑粒子流体动力学 (SPH) 通过与核函数的卷积来表示场。对于高斯核，傅里叶空间中的平滑会使波数为 $k$ 的模式衰减一个取决于 $kh$ 的因子。\n- SPH 平滑长度 $h$ 通过 $h = \\eta \\Delta x$ 与平均粒子间距 $\\Delta x$ 相关，其中 $\\eta$ 是为达到目标邻居数而选择的一个正常数。\n- 对于线性常微分方程的显式一阶时间积分，通过离散更新来近似指数放大，并限制每步的局部相对误差。\n- 使用 $c_{\\mathrm{s}}$ 和 $C$ 施加一个 Courant 型约束，使得时间步长 $\\,\\Delta t\\,$ 满足线性 CFL 约束。\n\n您的任务：\n1. 从包含引力的线性化 Euler 方程出发，求出 Rayleigh–Taylor 不稳定性的早期连续增长率，作为 $A$、$g$ 和 $k$ 的函数。所有推导必须从基本定律和核心定义开始；不得假设或引用给定的目标公式。从物理和数学上解释其依赖关系。\n2. 对于 SPH 中的高斯核平滑，解释卷积如何修改单个傅里叶模式，并根据平滑长度 $h$ 推导波数 $k$ 的衰减因子。利用此结果，定义 SPH 修正的增长率，并施加要求：SPH 修正的增长率与连续增长率之间的相对差异不大于 $\\epsilon_{\\mathrm{s}}$。推导满足此要求的 $h$ 的闭式上界。\n3. 使用 $h = \\eta \\Delta x$，推导为满足空间容差所需的每波长最小粒子数，即 $N_{\\lambda} = \\lambda/\\Delta x$。将其表示为 $\\lambda$、$\\eta$ 和 $h$ 的上界的函数。\n4. 对于时间积分，考虑一个应用于控制振幅指数增长的线性常微分方程的一阶显式格式。推导时间步长 $\\Delta t$ 的一个界限，以使每步的相对误差至多为 $\\epsilon_{\\mathrm{t}}$。将此界限与 Courant 型条件 $\\Delta t \\le C h / c_{\\mathrm{s}}$ 相结合，得到一个关于 $\\Delta t$ 的单一保守界限。\n5. 实现一个程序，为每个测试案例计算并返回以下量：\n   - 连续线性增长率 $\\gamma$，单位为 $\\mathrm{s}^{-1}$。\n   - 满足空间容差 $\\epsilon_{\\mathrm{s}}$ 的最大平滑长度 $h_{\\max}$，单位为 $\\mathrm{m}$。\n   - 由 $h_{\\max}$ 和 $\\eta$ 隐含的每波长最小粒子数 $N_{\\lambda,\\min}$ (无量纲)。\n   - 同时满足时间离散化容差 $\\epsilon_{\\mathrm{t}}$ 和 CFL 约束的最大允许时间步长 $\\Delta t_{\\max}$，单位为 $\\mathrm{s}$。\n6. 所有浮点数答案均以国际单位制 (SI) 表示，不含单位字符串，并四舍五入到六位小数。\n\n测试套件：\n为以下参数集提供结果，每个参数集以元组 $(\\rho_{\\mathrm{h}}, \\rho_{\\mathrm{l}}, g, \\lambda, \\epsilon_{\\mathrm{s}}, \\epsilon_{\\mathrm{t}}, \\eta, c_{\\mathrm{s}}, C)$ 的形式给出，适用时使用国际单位制单位：\n- 案例 1 (一般情况): $(2.0, 1.0, 9.81, 0.10, 0.10, 0.10, 1.2, 100.0, 0.30)$\n- 案例 2 (更短波长，更严容差): $(2.0, 1.0, 9.81, 0.05, 0.02, 0.02, 1.2, 50.0, 0.30)$\n- 案例 3 (低对比度，更长波长，宽松 CFL): $(1.05, 1.00, 9.81, 0.20, 0.10, 0.10, 1.2, 100.0, 0.50)$\n- 案例 4 (高对比度，中等波长，严格时间容差): $(10.0, 1.0, 9.81, 0.10, 0.05, 0.01, 1.2, 150.0, 0.25)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试案例贡献一个形如 $[\\gamma, h_{\\max}, N_{\\lambda,\\min}, \\Delta t_{\\max}]$ 的子列表。例如，输出必须类似于 \n$[[\\gamma_1, h_{\\max,1}, N_{\\lambda,\\min,1}, \\Delta t_{\\max,1}], [\\gamma_2, h_{\\max,2}, N_{\\lambda,\\min,2}, \\Delta t_{\\max,2}], \\ldots]$ \n其中每个浮点数四舍五入到六位小数。",
            "solution": "该问题在科学上是适定的、内部一致的，并包含了根据流体动力学和数值分析的既定原则推导唯一解所需的所有信息。因此，我们可以进行推导。\n\n用于平滑粒子流体动力学 (SPH) 模拟 Rayleigh–Taylor 不稳定性的分辨率判据，是通过以下四个连续步骤从基本原理推导出来的：获取连续线性增长率，根据 SPH 平滑效应确定空间分辨率，建立每波长粒子数要求，以及最后推导时间步长约束。\n\n**1. Rayleigh–Taylor 不稳定性的连续线性增长率**\n\n我们从无粘、不可压缩流体在均匀引力场 $\\mathbf{g} = (0, -g, 0)$ 下的 Euler 方程开始：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0\n$$\n$$\n\\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla)\\mathbf{v} = -\\frac{1}{\\rho}\\nabla P + \\mathbf{g}\n$$\n不可压缩条件为 $\\nabla \\cdot \\mathbf{v} = 0$。我们考虑一个密度为 $\\rho_0(y)$、压力为 $P_0(y)$ 的流体静力学平衡基态 ($\\mathbf{v}_0 = 0$)。动量方程简化为流体静力学平衡条件：$\\frac{dP_0}{dy} = -\\rho_0 g$。\n\n我们对这个平衡引入小扰动：$\\rho = \\rho_0 + \\rho'$，$P = P_0 + P'$，以及 $\\mathbf{v} = \\mathbf{v}'$。对这些扰动的控制方程进行线性化，得到：\n$$\n\\frac{D\\rho}{Dt} = \\frac{\\partial \\rho'}{\\partial t} + v'_y \\frac{d\\rho_0}{dy} = 0 \\quad (\\text{对于一个不可压缩的流体微元})\n$$\n$$\n\\rho_0 \\frac{\\partial \\mathbf{v}'}{\\partial t} = -\\nabla P' - \\rho' g \\hat{\\mathbf{y}}\n$$\n$$\n\\nabla \\cdot \\mathbf{v}' = 0\n$$\n由于引力项和压力梯度项（假设为正压流体）的旋度为零，如果流动初始是无旋的，它将保持无旋。因此，我们可以引入一个速度势 $\\phi$，使得 $\\mathbf{v}' = \\nabla \\phi$。不可压缩条件 $\\nabla \\cdot \\mathbf{v}' = 0$ 意味着该速度势满足 Laplace 方程：$\\nabla^2 \\phi = 0$。\n\n我们考虑两个独立的区域：一个密度为 $\\rho_{\\mathrm{h}}$ 的重流体 ($y > 0$) 和一个密度为 $\\rho_{\\mathrm{l}}$ 的轻流体 ($y  0$)。我们寻求界面 $y = \\zeta(x, t)$ 处形式为 $\\zeta(x, t) = \\zeta_0 e^{\\gamma t + i k x}$ 的单模扰动解，其中 $k=2\\pi/\\lambda$ 是波数，$\\gamma$ 是增长率。相应的速度势形式为 $\\phi(x, y, t) = \\hat{\\phi}(y) e^{\\gamma t + i k x}$。\n\n将此形式代入 Laplace 方程 $\\nabla^2 \\phi = 0$，得到关于 $\\hat{\\phi}(y)$ 的常微分方程：\n$$\n\\frac{d^2\\hat{\\phi}}{dy^2} - k^2 \\hat{\\phi} = 0\n$$\n解必须在远离界面处衰减。因此，对于重流体 ($y>0$) 和轻流体 ($y0$)，速度势分别为：\n$$\n\\phi_{\\mathrm{h}}(x, y, t) = C_{\\mathrm{h}} e^{-ky} e^{\\gamma t + i k x} \\quad (y>0)\n$$\n$$\n\\phi_{\\mathrm{l}}(x, y, t) = C_{\\mathrm{l}} e^{ky} e^{\\gamma t + i k x} \\quad (y0)\n$$\n其中 $C_{\\mathrm{h}}$ 和 $C_{\\mathrm{l}}$ 是常数。\n\n我们在界面 $y = \\zeta$ 处应用两个边界条件：\ni) **运动学边界条件**：垂直于界面的流体速度等于界面速度。一阶近似下，这在 $y=0$ 处为 $v'_y = \\frac{\\partial \\zeta}{\\partial t}$。\n$$\n\\frac{\\partial \\phi_{\\mathrm{h}}}{\\partial y}\\bigg|_{y=0} = \\frac{\\partial \\zeta}{\\partial t} \\implies -k C_{\\mathrm{h}} = \\gamma \\zeta_0\n$$\n$$\n\\frac{\\partial \\phi_{\\mathrm{l}}}{\\partial y}\\bigg|_{y=0} = \\frac{\\partial \\zeta}{\\partial t} \\implies k C_{\\mathrm{l}} = \\gamma \\zeta_0\n$$\n这些关系意味着 $C_{\\mathrm{l}} = -C_{\\mathrm{h}}$。\n\nii) **动力学边界条件**：由于忽略了表面张力，压力在界面上是连续的：$P_{\\mathrm{h}}(x, \\zeta, t) = P_{\\mathrm{l}}(x, \\zeta, t)$。我们对压力进行线性化：$P(x, \\zeta, t) \\approx P_0(\\zeta) + P'(x, 0, t) \\approx P_0(0) + \\frac{dP_0}{dy}|_{y=0} \\zeta + P'(x, 0, t)$。压力扰动 $P'$ 通过对线性化动量方程积分得到：$P' = -\\rho_0 \\frac{\\partial \\phi}{\\partial t} = -\\rho_0 \\gamma \\phi$。\n连续性条件变为：\n$$\nP_{0, \\mathrm{h}}(0) - \\rho_{\\mathrm{h}}g\\zeta + P'_{\\mathrm{h}}(0) = P_{0, \\mathrm{l}}(0) - \\rho_{\\mathrm{l}}g\\zeta + P'_{\\mathrm{l}}(0)\n$$\n由于 $P_{0, \\mathrm{h}}(0)=P_{0, \\mathrm{l}}(0)$，我们代入 $P'$ 和 $\\zeta$：\n$$\n-\\rho_{\\mathrm{h}}g\\zeta_0 - \\rho_{\\mathrm{h}}\\gamma C_{\\mathrm{h}} = -\\rho_{\\mathrm{l}}g\\zeta_0 - \\rho_{\\mathrm{l}}\\gamma C_{\\mathrm{l}}\n$$\n$$\ng\\zeta_0(\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}}) = \\gamma (\\rho_{\\mathrm{l}} C_{\\mathrm{l}} - \\rho_{\\mathrm{h}} C_{\\mathrm{h}})\n$$\n使用运动学条件得到的 $C_{\\mathrm{l}} = \\gamma \\zeta_0 / k$ 和 $C_{\\mathrm{h}} = -\\gamma \\zeta_0 / k$：\n$$\ng\\zeta_0(\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}}) = \\gamma \\left(\\rho_{\\mathrm{l}} \\frac{\\gamma\\zeta_0}{k} - \\rho_{\\mathrm{h}} \\frac{-\\gamma\\zeta_0}{k}\\right)\n$$\n除以 $\\zeta_0$（对于非平凡解，它不为零）：\n$$\ng(\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}}) = \\frac{\\gamma^2}{k}(\\rho_{\\mathrm{l}} + \\rho_{\\mathrm{h}})\n$$\n解出 $\\gamma^2$：\n$$\n\\gamma^2 = gk \\frac{\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}}}{\\rho_{\\mathrm{h}} + \\rho_{\\mathrm{l}}} = gk A\n$$\n其中 $A = (\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}})/(\\rho_{\\mathrm{h}} + \\rho_{\\mathrm{l}})$ 是 Atwood 数。当 $\\rho_{\\mathrm{h}} > \\rho_{\\mathrm{l}}$ 时，不稳定性呈指数增长，因此 $A > 0$。线性增长率是正实根：\n$$\n\\gamma = \\sqrt{A g k}\n$$\n对于更大的引力 $g$、更大的密度对比度 $A$ 和更小的波长 $\\lambda$ (更大的 $k$)，该增长率更高。\n\n**2. SPH 空间分辨率要求**\n\n在 SPH 中，一个场 $f(\\mathbf{r})$ 通过与一个平滑核 $W(\\mathbf{r}, h)$ 的卷积来近似，其中 $h$ 是平滑长度：$\\langle f(\\mathbf{r}) \\rangle = (f * W_h)(\\mathbf{r})$。根据卷积定理，平滑后的场的傅里叶变换为 $\\mathcal{F}\\{\\langle f \\rangle\\} = \\hat{f}(\\mathbf{k}) \\hat{W}(\\mathbf{k}, h)$。\n对于一维高斯核 $W(x, h) = (2\\pi h^2)^{-1/2} e^{-x^2/(2h^2)}$，其傅里叶变换为 $\\hat{W}(k, h) = e^{-k^2 h^2 / 2}$。\n因此，单个傅里叶模式 $e^{ikx}$ 会被此因子衰减。问题陈述，SPH 增长率 $\\gamma_{\\mathrm{SPH}}$ 会乘性地被此因子减小：\n$$\n\\gamma_{\\mathrm{SPH}} = \\gamma \\hat{W}(k, h) = \\gamma e^{-k^2 h^2 / 2}\n$$\n空间分辨率要求是增长率的相对误差受限于 $\\epsilon_{\\mathrm{s}}$：\n$$\n\\left| \\frac{\\gamma_{\\mathrm{SPH}} - \\gamma}{\\gamma} \\right| = 1 - \\frac{\\gamma_{\\mathrm{SPH}}}{\\gamma} = 1 - e^{-k^2 h^2 / 2} \\le \\epsilon_{\\mathrm{s}}\n$$\n解出 $h$：\n$$\ne^{-k^2 h^2 / 2} \\ge 1 - \\epsilon_{\\mathrm{s}}\n$$\n$$\n-k^2 h^2 / 2 \\ge \\ln(1 - \\epsilon_{\\mathrm{s}})\n$$\n$$\nh^2 \\le -\\frac{2}{k^2} \\ln(1 - \\epsilon_{\\mathrm{s}}) = \\frac{2}{k^2} \\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)\n$$\n这给出了平滑长度的上界 $h_{\\max}$：\n$$\nh_{\\max} = \\frac{\\sqrt{2}}{k} \\sqrt{\\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)}\n$$\n\n**3. 每波长最小粒子数**\n\nSPH 平滑长度 $h$ 通过一个无量纲因子 $\\eta$ 与平均粒子间距 $\\Delta x$ 相关：$h = \\eta \\Delta x$。为满足空间分辨率判据，我们必须有 $h \\le h_{\\max}$，这意味着 $\\eta \\Delta x \\le h_{\\max}$，或 $\\Delta x \\le h_{\\max}/\\eta$。\n解析一个波长 $\\lambda$ 所需的粒子数为 $N_{\\lambda} = \\lambda / \\Delta x$。为了找到所需的最小粒子数，我们考虑最大允许的粒子间距 $\\Delta x_{\\max} = h_{\\max}/\\eta$。\n$$\nN_{\\lambda, \\min} = \\frac{\\lambda}{\\Delta x_{\\max}} = \\frac{\\lambda}{h_{\\max}/\\eta} = \\frac{\\eta \\lambda}{h_{\\max}}\n$$\n代入 $h_{\\max}$ 的表达式：\n$$\nN_{\\lambda, \\min} = \\frac{\\eta \\lambda}{\\frac{\\sqrt{2}}{k} \\sqrt{\\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)}} = \\frac{\\eta \\lambda k}{\\sqrt{2\\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)}} = \\frac{2\\pi\\eta}{\\sqrt{2\\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)}}\n$$\n\n**4. 最大允许时间步长**\n\n时间步长 $\\Delta t$ 受两个条件约束：时间精度和数值稳定性 (CFL 条件)。\n\ni) **时间精度**：不稳定性振幅 $a(t)$ 遵循 $\\dot{a} = \\gamma a$。一个一阶显式积分格式（例如，前向 Euler 法）给出数值更新 $a_{n+1} = a_n(1 + \\gamma \\Delta t)$。精确解为 $a(t_n+\\Delta t) = a_n e^{\\gamma \\Delta t}$。每步的局部相对误差为：\n$$\n\\text{Err}_{\\mathrm{rel}} = \\left| \\frac{a_n(1 + \\gamma \\Delta t) - a_n e^{\\gamma \\Delta t}}{a_n e^{\\gamma \\Delta t}} \\right| = \\left| (1 + \\gamma \\Delta t)e^{-\\gamma \\Delta t} - 1 \\right|\n$$\n对于小的 $\\gamma \\Delta t$，Taylor 展开给出 $e^{\\gamma \\Delta t} \\approx 1 + \\gamma \\Delta t + \\frac{1}{2}(\\gamma \\Delta t)^2$。相对误差约为 $\\frac{1}{2}(\\gamma \\Delta t)^2$。我们要求其小于容差 $\\epsilon_{\\mathrm{t}}$：\n$$\n\\frac{1}{2}(\\gamma \\Delta t)^2 \\le \\epsilon_{\\mathrm{t}} \\implies \\Delta t \\le \\frac{\\sqrt{2\\epsilon_{\\mathrm{t}}}}{\\gamma}\n$$\n设此界限为 $\\Delta t_{\\mathrm{acc}}$。\n\nii) **CFL 条件**：问题指定了一个 Courant-Friedrichs-Lewy (CFL) 条件，形式为 $\\Delta t \\le C h / c_{\\mathrm{s}}$，其中 $C$ 是 Courant 因子，$c_{\\mathrm{s}}$ 是声速。对于更小的 $h$，此条件变得更具限制性。为了确保对于任何有效的空间分辨率 ($h \\le h_{\\max}$) 都具有稳定性，该条件必须对所选的 $h$ 成立。为了找到在所有空间解析场景下仍然有效的最宽松时间步长，我们在允许的最大平滑长度 $h_{\\max}$ 处评估此约束。\n$$\n\\Delta t \\le \\frac{C h_{\\max}}{c_{\\mathrm{s}}}\n$$\n设此界限为 $\\Delta t_{\\mathrm{CFL}}$。\n\n最终的最大允许时间步长必须同时满足两个条件：\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\mathrm{acc}}, \\Delta t_{\\mathrm{CFL}}) = \\min\\left(\\frac{\\sqrt{2\\epsilon_{\\mathrm{t}}}}{\\gamma}, \\frac{C h_{\\max}}{c_{\\mathrm{s}}}\\right)\n$$\n\n这些推导出的公式被实现以计算给定测试案例所需的值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes resolution criteria for SPH simulation of Rayleigh-Taylor instability\n    for a suite of test cases.\n    \"\"\"\n    # Test cases: (rho_h, rho_l, g, lambda, eps_s, eps_t, eta, c_s, C)\n    test_cases = [\n        (2.0, 1.0, 9.81, 0.10, 0.10, 0.10, 1.2, 100.0, 0.30),\n        (2.0, 1.0, 9.81, 0.05, 0.02, 0.02, 1.2, 50.0, 0.30),\n        (1.05, 1.00, 9.81, 0.20, 0.10, 0.10, 1.2, 100.0, 0.50),\n        (10.0, 1.0, 9.81, 0.10, 0.05, 0.01, 1.2, 150.0, 0.25),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho_h, rho_l, g, lam, eps_s, eps_t, eta, c_s, C = case\n\n        # 1. Compute continuum linear growth rate (gamma)\n        atwood_number = (rho_h - rho_l) / (rho_h + rho_l)\n        wavenumber = 2.0 * np.pi / lam\n        \n        # gamma = sqrt(A * g * k)\n        gamma_sq = atwood_number * g * wavenumber\n        if gamma_sq = 0: # Physically stable case, not expected here\n             gamma = 0.0\n        else:\n             gamma = np.sqrt(gamma_sq)\n\n        # 2. Compute maximum smoothing length (h_max)\n        # h_max = (sqrt(2)/k) * sqrt(ln(1/(1-eps_s)))\n        if eps_s >= 1.0:\n            # Avoid ln of non-positive number; h_max would be undefined or infinite\n            h_max = np.inf \n        else:\n            log_term = np.log(1.0 / (1.0 - eps_s))\n            h_max = (np.sqrt(2.0) / wavenumber) * np.sqrt(log_term)\n\n        # 3. Compute minimum particles per wavelength (N_lambda_min)\n        # N_lambda_min = eta * lambda / h_max\n        if h_max == 0 or np.isinf(h_max):\n            N_lambda_min = np.inf if h_max == 0 else 0\n        else:\n            N_lambda_min = eta * lam / h_max\n\n        # 4. Compute maximum allowable time step (dt_max)\n        # Constraint from temporal accuracy\n        if gamma == 0:\n            dt_acc = np.inf\n        else:\n            dt_acc = np.sqrt(2.0 * eps_t) / gamma\n        \n        # Constraint from CFL condition\n        if c_s == 0:\n            dt_cfl = np.inf\n        else:\n            dt_cfl = C * h_max / c_s\n        \n        dt_max = min(dt_acc, dt_cfl)\n\n        # Store results for this case\n        results.append([gamma, h_max, N_lambda_min, dt_max])\n\n    # Format the final output string as specified\n    # e.g., [[gamma1,h_max1,N_min1,dt_max1],[gamma2,h_max2,N_min2,dt_max2],...]\n    # with each float rounded to 6 decimal places.\n    result_str_list = []\n    for r in results:\n        # Format each number in the sublist\n        formatted_r = [f\"{val:.6f}\" for val in r]\n        # Join into a string sublist like '[val1,val2,val3,val4]'\n        result_str_list.append(f\"[{','.join(formatted_r)}]\")\n\n    # Join all sublist strings into the final output string\n    final_output = f\"[{','.join(result_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}