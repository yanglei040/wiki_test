{
    "hands_on_practices": [
        {
            "introduction": "At the heart of many weak-field gravitational simulations lies the Poisson equation, which determines the gravitational potential from the matter distribution. While numerical solvers can provide an approximate solution, a deeper understanding requires analyzing the source of their inaccuracies. This practice  guides you through a theoretical derivation of the error inherent in a standard finite-difference method, providing crucial insight into how numerical discretization affects the solution's accuracy as a function of the wave mode and grid resolution.",
            "id": "3502863",
            "problem": "Consider a periodic cubic cosmological box of side length $L$ in comoving coordinates, discretized by a uniform Cartesian grid of $N$ points in each direction with spacing $\\Delta x = L/N$. In the weak-field approximation of General Relativity, the scalar potential $ \\Phi $ in the conformal Newtonian gauge obeys a Poisson-type equation in comoving coordinates, \n$$\n\\nabla^{2} \\Phi(\\mathbf{x}) = S(\\mathbf{x}),\n$$\nwhere $S(\\mathbf{x})$ is proportional to $4 \\pi G a^{2} \\bar{\\rho}\\,\\delta(\\mathbf{x})$ but may be treated here as a generic source with zero spatial mean. Assume periodic boundary conditions on $[0,L]^{3}$. \n\nFocus on a single, resolved, separable plane-wave source directed along the $x$-axis,\n$$\nS(\\mathbf{x}) = S_{0} \\cos(k x),\n$$\nwith $k = 2 \\pi m / L$ and integer mode number $m$ satisfying $1 \\leq m \\leq \\frac{N}{2} - 1$ to avoid Nyquist aliasing. \n\nTwo numerical methods are considered for solving the discrete version of the equation:\n\n- A spectral method using the Discrete Fourier Transform (DFT), which inverts the Laplacian mode-by-mode in Fourier space for nonzero wavevectors and sets the zero wavenumber mode $ \\Phi_{\\mathbf{k}=\\mathbf{0}} $ to zero to fix the gauge (constant offset) of the potential.\n\n- A second-order central-difference finite-difference method on the grid with periodic boundary conditions, using the discrete Laplacian stencil in the $x$-direction,\n$$\n(\\nabla^{2} \\Phi)_{j} \\equiv \\frac{\\Phi_{j+1} - 2 \\Phi_{j} + \\Phi_{j-1}}{\\Delta x^{2}},\n$$\nand analogous stencils in $y$ and $z$, where indices are taken modulo $N$.\n\nStarting from fundamental definitions of the continuous Laplacian and its discrete second-order central-difference approximation, and using only the stated properties of the DFT and periodicity, derive the discrete eigenvalue of the finite-difference Laplacian acting on the sampled plane wave in one dimension. Then use this to obtain the closed-form expression for the relative amplitude error of the finite-difference solution for the single-mode source compared to the exact continuous solution,\n$$\nE_{\\mathrm{fd}}(k,N,L) \\equiv \\frac{\\Phi^{\\mathrm{fd}}_{k} - \\Phi^{\\mathrm{exact}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}},\n$$\nunder the convention that the zero-wavenumber mode of the potential is set to zero in both methods. Your final answer must be the single closed-form analytic expression for $E_{\\mathrm{fd}}(k,N,L)$ in terms of $k$, $N$, and $L$. Do not provide any intermediate steps, and do not include any units in your final answer. Additionally, state in your derivation how the spectral method treats the zero mode and how this affects its error for this source.\n\nNo rounding is required. Express the final relative error as a dimensionless analytic expression.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Governing Equation:** Poisson-type equation $\\nabla^{2} \\Phi(\\mathbf{x}) = S(\\mathbf{x})$.\n- **Domain:** Periodic cubic box of side length $L$ in comoving coordinates, $[0,L]^{3}$.\n- **Discretization:** Uniform Cartesian grid with $N$ points per direction, grid spacing $\\Delta x = L/N$.\n- **Source Term:** A single plane-wave $S(\\mathbf{x}) = S_{0} \\cos(k x)$.\n- **Wavenumber:** $k = 2 \\pi m / L$, with integer $m$ satisfying $1 \\leq m \\leq \\frac{N}{2} - 1$.\n- **Source Property:** Zero spatial mean.\n- **Boundary Conditions:** Periodic.\n- **Spectral Method:** Inverts the Laplacian mode-by-mode in Fourier space. Sets the zero-wavenumber mode of the potential $\\Phi_{\\mathbf{k}=\\mathbf{0}}$ to zero.\n- **Finite-Difference (FD) Method:** Uses a second-order central-difference stencil for the Laplacian, e.g., $(\\nabla^{2} \\Phi)_{j} \\equiv \\frac{\\Phi_{j+1} - 2 \\Phi_{j} + \\Phi_{j-1}}{\\Delta x^{2}}$ for the $x$-direction, with indices modulo $N$.\n- **Error Definition:** The relative amplitude error is $E_{\\mathrm{fd}}(k,N,L) \\equiv \\frac{\\Phi^{\\mathrm{fd}}_{k} - \\Phi^{\\mathrm{exact}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}}$.\n- **Gauge Convention:** The zero-wavenumber mode of the potential is set to zero for all solutions.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard numerical analysis problem in the context of computational physics. The governing equation is fundamental, the source term is well-defined and satisfies the stated 'zero spatial mean' property for $m \\ge 1$. The boundary conditions and gauge fixing ($\\Phi_{\\mathbf{k}=\\mathbf{0}}=0$) ensure a unique solution. The constraint on the mode number $m$ ensures the wave is resolved and not at the Nyquist frequency, which is a standard consideration in discrete methods. The problem is self-contained, and its terms are defined unambiguously. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to find the relative error of the finite-difference solution's amplitude compared to the exact continuous solution's amplitude for a single Fourier mode.\n\n**1. Exact Continuous Solution**\nThe given equation is $\\nabla^{2} \\Phi(\\mathbf{x}) = S(\\mathbf{x})$. Since the source term $S(\\mathbf{x}) = S_{0} \\cos(k x)$ depends only on the coordinate $x$, the potential $\\Phi$ will also depend only on $x$, so that $\\nabla^{2} \\Phi = \\frac{d^{2}\\Phi}{dx^{2}}$. The equation simplifies to:\n$$\n\\frac{d^{2}\\Phi}{dx^{2}} = S_{0} \\cos(k x)\n$$\nWe seek a solution of the form $\\Phi(x) = \\Phi^{\\mathrm{exact}}_{k} \\cos(k x)$, where $\\Phi^{\\mathrm{exact}}_{k}$ is the amplitude of the mode. Differentiating this ansatz twice with respect to $x$ yields:\n$$\n\\frac{d\\Phi}{dx} = -\\Phi^{\\mathrm{exact}}_{k} k \\sin(k x)\n$$\n$$\n\\frac{d^{2}\\Phi}{dx^{2}} = -\\Phi^{\\mathrm{exact}}_{k} k^{2} \\cos(k x)\n$$\nSubstituting this back into the differential equation gives:\n$$\n-\\Phi^{\\mathrm{exact}}_{k} k^{2} \\cos(k x) = S_{0} \\cos(k x)\n$$\nFor this equality to hold for all $x$, the coefficients must be equal. This gives the amplitude of the exact solution:\n$$\n\\Phi^{\\mathrm{exact}}_{k} = -\\frac{S_{0}}{k^{2}}\n$$\nThe problem specifies that the zero-wavenumber mode of the potential is zero. For $k = 2\\pi m/L$ with $m \\ge 1$, the integral of $\\cos(kx)$ over one period $L$ is zero. Thus, the exact solution $\\Phi(x) = -\\frac{S_{0}}{k^{2}} \\cos(k x)$ has zero mean and satisfies this condition.\n\n**2. Note on the Spectral Method**\nThe problem mentions a spectral method. This method solves the equation in Fourier space, where the Laplacian operator $\\nabla^2$ becomes an algebraic multiplication by $-|\\mathbf{k}|^2$. For discrete data, the Discrete Fourier Transform (DFT) is used. On the grid, the source is sampled as $S_j = S_{0} \\cos(k x_j)$. The DFT of this sampled function has non-zero components only at the discrete wavenumbers corresponding to $\\pm k$. The spectral method calculates the Fourier coefficients $\\hat{\\Phi}_{\\mathbf{k}}$ from the source's coefficients $\\hat{S}_{\\mathbf{k}}$ via $\\hat{\\Phi}_{\\mathbf{k}} = - \\hat{S}_{\\mathbf{k}} / |\\mathbf{k}|^2$ for non-zero wavenumbers. Since the source is a single plane wave that is periodic on the grid (as guaranteed by $k = 2\\pi m/L$), the DFT and the action of the discrete Laplacian in Fourier space are exact. Therefore, the spectral method yields the exact solution for this particular source, and its error is zero. The condition to set $\\Phi_{\\mathbf{k}=\\mathbf{0}}=0$ is a gauge-fixing choice. The source's mean is zero, so its $\\mathbf{k}=\\mathbf{0}$ Fourier component is also zero, $\\hat{S}_{\\mathbf{k}=\\mathbf{0}}=0$. The equation for the zero mode, $0 \\cdot \\hat{\\Phi}_{\\mathbf{k}=\\mathbf{0}} = \\hat{S}_{\\mathbf{k}=\\mathbf{0}} = 0$, is indeterminate. Setting $\\hat{\\Phi}_{\\mathbf{k}=\\mathbf{0}}=0$ makes the solution unique and matches the exact continuous solution.\n\n**3. Finite-Difference Solution**\nThe discrete form of the Poisson equation is $(\\nabla^{2}_{\\mathrm{fd}} \\Phi)_{j} = S_j$, where $(\\nabla^{2}_{\\mathrm{fd}} \\Phi)_{j}$ is the second-order central difference approximation of the Laplacian and $S_j = S_0 \\cos(k x_j)$ is the source sampled at grid points $x_j = j \\Delta x$ for $j \\in \\{0, 1, ..., N-1\\}$. We look for a solution of the form $\\Phi^{\\mathrm{fd}}_{j} = \\Phi^{\\mathrm{fd}}_{k} \\cos(k x_j)$. To find the amplitude $\\Phi^{\\mathrm{fd}}_{k}$, we first determine the discrete eigenvalue of the finite-difference Laplacian acting on the mode $\\cos(k x_j)$.\n$$\n(\\nabla^{2}_{\\mathrm{fd}} \\cos(k x_j)) = \\frac{\\cos(k x_{j+1}) - 2 \\cos(k x_j) + \\cos(k x_{j-1})}{(\\Delta x)^{2}}\n$$\nUsing $x_{j \\pm 1} = x_j \\pm \\Delta x$ and the trigonometric identity $\\cos(A+B) + \\cos(A-B) = 2\\cos(A)\\cos(B)$, we have:\n$$\n\\cos(k(x_j + \\Delta x)) + \\cos(k(x_j - \\Delta x)) = 2 \\cos(k x_j) \\cos(k \\Delta x)\n$$\nSubstituting this into the finite-difference expression:\n$$\n(\\nabla^{2}_{\\mathrm{fd}} \\cos(k x_j)) = \\frac{2 \\cos(k x_j) \\cos(k \\Delta x) - 2 \\cos(k x_j)}{(\\Delta x)^{2}} = \\left[ \\frac{2(\\cos(k \\Delta x) - 1)}{(\\Delta x)^{2}} \\right] \\cos(k x_j)\n$$\nThe term in brackets is the eigenvalue of the discrete Laplacian operator for the mode with wavenumber $k$. The discrete equation becomes:\n$$\n\\Phi^{\\mathrm{fd}}_{k} \\left[ \\frac{2(\\cos(k \\Delta x) - 1)}{(\\Delta x)^{2}} \\right] \\cos(k x_j) = S_{0} \\cos(k x_j)\n$$\nSolving for the finite-difference amplitude $\\Phi^{\\mathrm{fd}}_{k}$:\n$$\n\\Phi^{\\mathrm{fd}}_{k} = \\frac{S_{0}}{ \\frac{2(\\cos(k \\Delta x) - 1)}{(\\Delta x)^{2}} } = \\frac{S_{0} (\\Delta x)^{2}}{2(\\cos(k \\Delta x) - 1)}\n$$\n\n**4. Relative Amplitude Error**\nThe relative error is defined as $E_{\\mathrm{fd}} = \\frac{\\Phi^{\\mathrm{fd}}_{k} - \\Phi^{\\mathrm{exact}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}} = \\frac{\\Phi^{\\mathrm{fd}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}} - 1$. We compute the ratio of the amplitudes:\n$$\n\\frac{\\Phi^{\\mathrm{fd}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}} = \\frac{ \\frac{S_{0} (\\Delta x)^{2}}{2(\\cos(k \\Delta x) - 1)} }{ -\\frac{S_{0}}{k^{2}} } = -\\frac{k^{2} (\\Delta x)^{2}}{2(\\cos(k \\Delta x) - 1)}\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2 \\sin^{2}(\\theta/2)$, we can write $\\cos(k \\Delta x) - 1 = -2 \\sin^{2}(k \\Delta x / 2)$.\n$$\n\\frac{\\Phi^{\\mathrm{fd}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}} = -\\frac{k^{2} (\\Delta x)^{2}}{2(-2 \\sin^{2}(k \\Delta x / 2))} = \\frac{k^{2} (\\Delta x)^{2}}{4 \\sin^{2}(k \\Delta x / 2)}\n$$\nThe relative error is therefore:\n$$\nE_{\\mathrm{fd}} = \\frac{k^{2} (\\Delta x)^{2}}{4 \\sin^{2}(k \\Delta x / 2)} - 1\n$$\nFinally, we substitute $\\Delta x = L/N$ to express the error in terms of the given parameters $k$, $N$, and $L$.\n$$\nE_{\\mathrm{fd}}(k,N,L) = \\frac{k^{2} (L/N)^{2}}{4 \\sin^{2}(k L / (2N))} - 1 = \\frac{k^{2} L^{2}}{4 N^{2} \\sin^{2}\\left(\\frac{k L}{2 N}\\right)} - 1\n$$\nThis is the closed-form expression for the relative amplitude error of the finite-difference solution.",
            "answer": "$$\n\\boxed{\\frac{k^{2} L^{2}}{4 N^{2} \\sin^{2}\\left(\\frac{k L}{2 N}\\right)} - 1}\n$$"
        },
        {
            "introduction": "Having analyzed the spatial discretization of the Poisson equation, we now turn to the dynamics of weak-field gravity: the propagation of gravitational waves. This hands-on coding exercise  tasks you with simulating a simple plane wave using a finite-difference time-domain method. By comparing your numerical result against the exact analytic solution, you will learn to quantify the principal errors in time-dependent simulations—numerical dispersion (phase error) and dissipation (amplitude error)—which are critical for assessing the faithfulness of any wave-propagating code.",
            "id": "3502846",
            "problem": "Consider linearized General Relativity in vacuum on a flat background spacetime. Let the spacetime metric be written as $g_{\\mu\\nu} = \\eta_{\\mu\\nu} + h_{\\mu\\nu}$, where $\\eta_{\\mu\\nu}$ is the Minkowski metric and $h_{\\mu\\nu}$ is a small perturbation with $\\lvert h_{\\mu\\nu} \\rvert \\ll 1$. In the Lorenz gauge and vacuum, the trace-reversed perturbation obeys the homogeneous wave equation. In the Transverse-Traceless (TT) gauge, each independent metric-perturbation component $h_{ij}^{\\mathrm{TT}}$ obeys the scalar wave equation\n$$\n\\frac{\\partial^2 h}{\\partial t^2} = c^2 \\frac{\\partial^2 h}{\\partial x^2},\n$$\nin one spatial dimension $x$ for a representative component, where $c$ is the speed of light. In geometric units often used in numerical relativity, set $c=1$.\n\nYou are asked to validate a numerical time-evolution code by evolving an exact analytic weak-field plane-wave solution and quantifying phase and amplitude errors as functions of the timestep $\\Delta t$ and the grid spacing $\\Delta x$. The analytic solution to be used is\n$$\nh(x,t) = A \\cos(k x - \\omega t),\n$$\nwith $A=10^{-6}$, $k = 2\\pi m$, $m=4$, $\\omega = c k$, and periodic boundary conditions on $x \\in [0,L)$ with $L=1$. The initial conditions at $t=0$ are\n$$\nh(x,0) = A \\cos(k x), \\quad \\left.\\frac{\\partial h}{\\partial t}\\right|_{t=0} = \\omega A \\sin(k x).\n$$\n\nUse a second-order accurate explicit finite-difference scheme in both space and time on a uniform grid with $N_x$ points and spacing $\\Delta x = L/N_x$. Impose periodic boundary conditions. Define the Courant number $C = c \\Delta t / \\Delta x$. The time-update for $n \\ge 1$ must be implemented as\n$$\nh_j^{n+1} = 2 h_j^n - h_j^{n-1} + C^2 \\left(h_{j+1}^n - 2 h_j^n + h_{j-1}^n\\right),\n$$\nwhere $j$ indexes grid points and $n$ indexes time levels. The first step $h_j^{1}$ must be obtained from a Taylor expansion consistent with the wave equation using the discrete Laplacian:\n$$\nh_j^{1} = h_j^{0} + \\Delta t \\left(\\left.\\frac{\\partial h}{\\partial t}\\right|_{t=0}\\right)_j + \\frac{1}{2} \\Delta t^2 \\, c^2 \\, \\left(\\frac{\\partial^2 h}{\\partial x^2}\\right)_j^{0,\\mathrm{disc}},\n$$\nwhere the discrete Laplacian is\n$$\n\\left(\\frac{\\partial^2 h}{\\partial x^2}\\right)_j^{0,\\mathrm{disc}} = \\frac{h_{j+1}^0 - 2 h_{j}^0 + h_{j-1}^0}{\\Delta x^2}.\n$$\n\nEvolve the solution to a target time $t_{\\mathrm{target}} = \\alpha T$, where $T = 2\\pi / \\omega$ is the analytic period and $\\alpha = 0.37$. Use an integer number of timesteps $N_t = \\mathrm{round}(t_{\\mathrm{target}}/\\Delta t)$ and set $t_{\\mathrm{final}} = N_t \\Delta t$.\n\nAt $t_{\\mathrm{final}}$, compute the numerical amplitude $A_{\\mathrm{num}}$ and phase $\\phi_{\\mathrm{num}}$ of the plane-wave mode with index $m$ by projecting the numerical solution onto the basis functions $\\cos(k x)$ and $\\sin(k x)$:\n$$\nC = \\sum_{j=0}^{N_x-1} h_j^{N_t} \\cos(k x_j), \\quad S = \\sum_{j=0}^{N_x-1} h_j^{N_t} \\sin(k x_j),\n$$\n$$\nA_{\\mathrm{num}} = \\frac{2}{N_x} \\sqrt{C^2 + S^2}, \\quad \\phi_{\\mathrm{num}} = \\mathrm{atan2}(S, C).\n$$\nThe analytic phase at $t_{\\mathrm{final}}$ is $\\phi_{\\mathrm{true}} = \\omega t_{\\mathrm{final}}$. Quantify:\n- The amplitude error as the absolute difference $E_A = \\lvert A_{\\mathrm{num}} - A \\rvert$ (dimensionless, the same units as $h$).\n- The phase error as the absolute principal-value difference $E_\\phi = \\left\\lvert \\mathrm{Arg}\\left(e^{i(\\phi_{\\mathrm{num}} - \\phi_{\\mathrm{true}})}\\right) \\right\\rvert$ in radians, where $\\mathrm{Arg}(\\cdot)$ maps angles to $(-\\pi,\\pi]$.\n\nUse the following test suite of parameter values to explore error behavior across stable Courant numbers and resolutions:\n- Case $1$: $N_x = 128$, $\\Delta x = L/N_x$, $\\Delta t = 0.5 \\Delta x$.\n- Case $2$: $N_x = 64$, $\\Delta x = L/N_x$, $\\Delta t = 0.8 \\Delta x$.\n- Case $3$: $N_x = 32$, $\\Delta x = L/N_x$, $\\Delta t = 0.99 \\Delta x$.\n- Case $4$: $N_x = 16$, $\\Delta x = L/N_x$, $\\Delta t = 0.5 \\Delta x$.\n\nAll quantities are dimensionless, except the phase error $E_\\phi$, which must be expressed in radians. Your program must compute $(E_A, E_\\phi)$ for each test case and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the format\n$$\n\\left[ [E_{A,1},E_{\\phi,1}], [E_{A,2},E_{\\phi,2}], [E_{A,3},E_{\\phi,3}], [E_{A,4},E_{\\phi,4}] \\right],\n$$\nwith each entry being a floating-point number. Angles must be handled in radians. No user input is required; all parameters are specified above and must be hard-coded in your solution.",
            "solution": "The problem requires the validation of a numerical scheme for the one-dimensional scalar wave equation, which serves as a model for weak-field gravitational waves in the Transverse-Traceless (TT) gauge. The validation is performed by evolving an exact analytic plane-wave solution and quantifying the numerical amplitude and phase errors.\n\nThe governing equation is the scalar wave equation in one spatial dimension $x$ and time $t$:\n$$\n\\frac{\\partial^2 h}{\\partial t^2} = c^2 \\frac{\\partial^2 h}{\\partial x^2}\n$$\nIn accordance with the problem statement, we adopt geometric units where the speed of light is $c=1$. The problem is solved on a periodic spatial domain $x \\in [0,L)$ with $L=1$.\n\nThe exact analytic solution used as a benchmark is a plane wave:\n$$\nh(x,t) = A \\cos(k x - \\omega t)\n$$\nThe parameters are given as amplitude $A=10^{-6}$, mode number $m=4$, wavenumber $k=2\\pi m$, and angular frequency $\\omega=ck=k$. The initial conditions at $t=0$ are derived from this analytic solution:\n$$\nh(x,0) = A \\cos(k x)\n$$\n$$\n\\left.\\frac{\\partial h}{\\partial t}\\right|_{t=0} = \\omega A \\sin(k x)\n$$\n\nThe numerical solution is computed on a uniform grid with $N_x$ spatial points $x_j = j \\Delta x$ for $j=0, 1, \\dots, N_x-1$, where the grid spacing is $\\Delta x = L/N_x$. The time is discretized with a constant timestep $\\Delta t$. The Courant number is defined as $C = c \\Delta t / \\Delta x = \\Delta t / \\Delta x$.\n\nThe numerical scheme is a second-order accurate finite-difference method. The spatial second derivative is approximated by the standard three-point central difference stencil:\n$$\n\\left.\\frac{\\partial^2 h}{\\partial x^2}\\right|_{x_j, t^n} \\approx \\frac{h_{j+1}^n - 2 h_j^n + h_{j-1}^n}{\\Delta x^2}\n$$\nwhere $h_j^n$ denotes the numerical approximation of $h(x_j, t^n = n\\Delta t)$. Substituting this into the wave equation gives the explicit leapfrog time-stepping scheme, which is rearranged to solve for the solution at the next time level, $h_j^{n+1}$:\n$$\nh_j^{n+1} = 2 h_j^n - h_j^{n-1} + \\left(\\frac{\\Delta t}{\\Delta x}\\right)^2 \\left(h_{j+1}^n - 2 h_j^n + h_{j-1}^n\\right) = 2 h_j^n - h_j^{n-1} + C^2 \\left(h_{j+1}^n - 2 h_j^n + h_{j-1}^n\\right)\n$$\nThis formula is valid for time levels $n \\ge 1$. Periodic boundary conditions are enforced by identifying grid point $j=N_x$ with $j=0$ and $j=-1$ with $j=N_x-1$.\n\nTo begin the simulation, a special procedure is required for the first timestep, as the leapfrog scheme is a three-level method. The solution at $t^1 = \\Delta t$ is computed from a second-order Taylor series expansion in time, consistent with the governing equation:\n$$\nh(x, \\Delta t) \\approx h(x,0) + \\Delta t \\left.\\frac{\\partial h}{\\partial t}\\right|_{t=0} + \\frac{\\Delta t^2}{2} \\left.\\frac{\\partial^2 h}{\\partial t^2}\\right|_{t=0}\n$$\nUsing the wave equation $\\frac{\\partial^2 h}{\\partial t^2} = c^2 \\frac{\\partial^2 h}{\\partial x^2}$ and the discrete approximation for the spatial derivative, the formula for $h_j^1$ becomes:\n$$\nh_j^1 = h_j^0 + \\Delta t \\left(\\left.\\frac{\\partial h}{\\partial t}\\right|_{t=0}\\right)_j + \\frac{c^2 \\Delta t^2}{2} \\left(\\frac{h_{j+1}^0 - 2 h_j^0 + h_{j-1}^0}{\\Delta x^2}\\right)\n$$\nwhere $h_j^0 = h(x_j,0)$ and its time derivative are given by the initial conditions.\n\nThe simulation for each test case proceeds as follows:\n1.  Initialize parameters: $A, m, L, \\alpha, c, N_x, \\Delta t/\\Delta x$.\n2.  Calculate derived quantities: $\\Delta x = L/N_x$, $\\Delta t$, $k=2\\pi m$, $\\omega=k$, $T=2\\pi/\\omega$, $t_{\\mathrm{target}}=\\alpha T$, $N_t = \\mathrm{round}(t_{\\mathrm{target}}/\\Delta t)$, and $t_{\\mathrm{final}} = N_t \\Delta t$.\n3.  Set up the grid $x_j$ and initial data arrays for $h_j^0$ and $\\left(\\partial_t h\\right)_j^0$.\n4.  Compute $h_j^1$ using the first-step formula.\n5.  Iterate the main leapfrog update rule for $N_t-1$ steps to reach $t_{\\mathrm{final}}$, evolving the solution to $h_j^{N_t}$.\n\nAt the final time $t_{\\mathrm{final}}$, the numerical solution $h_j^{N_t}$ is analyzed to extract its amplitude and phase. Since the initial condition is a pure cosine mode, the numerical solution is expected to be dominated by the same mode. We project the numerical solution onto cosine and sine basis functions corresponding to mode $m$:\n$$\nC = \\sum_{j=0}^{N_x-1} h_j^{N_t} \\cos(k x_j), \\quad S = \\sum_{j=0}^{N_x-1} h_j^{N_t} \\sin(k x_j)\n$$\nThe numerical amplitude $A_{\\mathrm{num}}$ and phase $\\phi_{\\mathrm{num}}$ are then calculated as:\n$$\nA_{\\mathrm{num}} = \\frac{2}{N_x} \\sqrt{C^2 + S^2}, \\quad \\phi_{\\mathrm{num}} = \\mathrm{atan2}(S, C)\n$$\nThe factor $2/N_x$ is the standard normalization for a discrete Fourier transform of a real-valued signal. The phase $\\phi_{\\mathrm{num}}$ represents the measured value of the temporal phase $\\omega t$ at $t=t_{\\mathrm{final}}$.\n\nThe errors are computed by comparing these numerical results to the analytic values. The true amplitude is $A = 10^{-6}$, and the true phase is $\\phi_{\\mathrm{true}} = \\omega t_{\\mathrm{final}}$.\nThe amplitude error is the absolute difference:\n$$\nE_A = \\lvert A_{\\mathrm{num}} - A \\rvert\n$$\nThe phase error $E_\\phi$ is the absolute difference between the numerical and true phases, wrapped to the interval $[0, \\pi]$ to find the shortest angle. This is robustly computed as:\n$$\nE_\\phi = \\left\\lvert \\mathrm{Arg}\\left(e^{i(\\phi_{\\mathrm{num}} - \\phi_{\\mathrm{true}})}\\right) \\right\\rvert\n$$\nwhere $\\mathrm{Arg}(z)$ is the principal value of the argument of a complex number $z$, mapping to $(-\\pi, \\pi]$. This procedure is implemented for each of the four specified test cases to produce the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(Nx, dt_dx_ratio):\n    \"\"\"\n    Runs a single simulation case for the 1D wave equation and computes errors.\n\n    Args:\n        Nx (int): Number of spatial grid points.\n        dt_dx_ratio (float): Ratio of timestep to grid spacing, Delta_t / Delta_x.\n\n    Returns:\n        tuple[float, float]: A tuple containing the amplitude error (E_A) and\n                             the phase error (E_phi) in radians.\n    \"\"\"\n    # 1. Define constants and parameters\n    A = 1.0e-6\n    m = 4.0\n    L = 1.0\n    alpha = 0.37\n    c_light = 1.0\n\n    # 2. Calculate derived quantities\n    dx = L / Nx\n    dt = dt_dx_ratio * dx\n    courant_num = c_light * dt / dx\n\n    k = 2.0 * np.pi * m / L\n    omega = c_light * k\n    period = 2.0 * np.pi / omega\n    t_target = alpha * period\n    \n    # Ensure Nt is an integer, as specified\n    Nt = int(np.round(t_target / dt))\n    t_final = Nt * dt\n\n    # 3. Set up the grid and initial conditions\n    x = np.linspace(0.0, L, Nx, endpoint=False)\n    h0 = A * np.cos(k * x)\n    h_dot_0 = omega * A * np.sin(k * x)\n\n    # 4. Perform the first timestep using a second-order Taylor expansion\n    # h_prev corresponds to h^0, h_curr will be h^1\n    h_prev = h0\n    \n    # Discrete Laplacian of h^0 with periodic boundaries\n    laplacian_h0 = (np.roll(h0, -1) - 2.0 * h0 + np.roll(h0, 1)) / (dx**2)\n    \n    h_curr = h0 + dt * h_dot_0 + 0.5 * dt**2 * c_light**2 * laplacian_h0\n\n    # 5. Main time-stepping loop (Leapfrog)\n    # The loop runs from n=1 to Nt-1, calculating h^(n+1)\n    for _ in range(1, Nt):\n        # Laplacian of h_curr (h^n)\n        laplacian_h_curr = np.roll(h_curr, -1) - 2.0 * h_curr + np.roll(h_curr, 1)\n        \n        # Calculate h_next (h^(n+1))\n        # Note: courant_num**2 = (c*dt/dx)**2\n        h_next = 2.0 * h_curr - h_prev + courant_num**2 * laplacian_h_curr\n        \n        # Update time levels\n        h_prev = h_curr\n        h_curr = h_next\n\n    # h_curr now holds the solution at t_final, i.e., h^{N_t}\n    h_final = h_curr\n\n    # 6. Error analysis at t_final\n    # Project numerical solution onto basis functions\n    cos_kx = np.cos(k * x)\n    sin_kx = np.sin(k * x)\n\n    C_proj = np.sum(h_final * cos_kx)\n    S_proj = np.sum(h_final * sin_kx)\n\n    # Calculate numerical amplitude and phase\n    A_num = (2.0 / Nx) * np.sqrt(C_proj**2 + S_proj**2)\n    phi_num = np.arctan2(S_proj, C_proj)\n\n    # Calculate true phase\n    phi_true = omega * t_final\n\n    # Calculate errors\n    E_A = np.abs(A_num - A)\n    \n    # Phase error calculation, wrapping the difference to (-pi, pi]\n    delta_phi = phi_num - phi_true\n    # Arg(exp(i*delta_phi)) is equivalent to wrapping delta_phi to (-pi, pi]\n    E_phi = np.abs(np.arctan2(np.sin(delta_phi), np.cos(delta_phi)))\n\n    return E_A, E_phi\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nx, dt/dx)\n        (128, 0.5),\n        (64, 0.8),\n        (32, 0.99),\n        (16, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, dt_dx_ratio = case\n        errors = run_case(Nx, dt_dx_ratio)\n        results.append(errors)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{e_a},{e_phi}]\" for e_a, e_phi in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "General Relativity is more than just a set of evolution equations; it also includes constraint equations that the metric and matter fields must satisfy at all times. In numerical simulations, discretization errors can lead to violations of these constraints, which can grow and render the solution unphysical. This final practice  introduces the crucial topic of constraint-damping, a vital technique in robust numerical relativity codes. Through theoretical analysis, you will design a diagnostic to monitor constraint violations and prove that a simple damping term can effectively control their growth, ensuring the physical consistency of the simulation.",
            "id": "3502832",
            "problem": "Consider weak-field perturbations of a spatially flat Friedmann–Lemaître–Robertson–Walker (FLRW) spacetime with scale factor $a(\\eta)$ in conformal time $\\eta$. Let $\\mathbf{C}(\\eta,\\mathbf{x}) \\in \\mathbb{R}^{4}$ denote the vector of linearized General Relativity constraint violations, comprising the Hamiltonian constraint violation $\\mathcal{H}$ and the three components of the momentum constraint violation $\\mathcal{M}_{i}$. In a first-order symmetric-hyperbolic formulation, the contracted Bianchi identities imply that, to leading order in the weak-field approximation and when written in conformal coordinates, $\\mathbf{C}$ satisfies a homogeneous, constant-coefficient, symmetric-hyperbolic subsidiary system with principal part\n$$\n\\partial_{\\eta} \\mathbf{C} \\;=\\; \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,,\n$$\nwhere each $\\mathbf{A}^{j} \\in \\mathbb{R}^{4\\times 4}$ is constant and symmetric. Assume periodic boundary conditions on a cubic three-torus with coordinate volume $V$, so that spatial boundary integrals of total divergences vanish. You are asked to design a diagnostic to monitor the linearized Hamiltonian and momentum constraints during numerical evolution and to develop a simple damping term that provably reduces constraint violations without spoiling the formal order of accuracy.\n\n1) Define the one-parameter family of diagnostic energies\n$$\nE_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} a(\\eta)^{p}\\,\\mathbf{C}(\\eta,\\mathbf{x})^{\\mathsf{T}} \\mathbf{C}(\\eta,\\mathbf{x})\\,\\mathrm{d}^{3}x \\,,\n$$\nfor real parameter $p$. Using only the principal-part system above and periodic boundary conditions, derive $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)$ and determine the unique value of $p$ for which $E_{p}(\\eta)$ is conserved in the undamped case, i.e., $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)=0$ for all solutions $\\mathbf{C}$ of the principal-part system.\n\n2) Modify the subsidiary system by adding a linear damping term, $\\partial_{\\eta}\\mathbf{C} \\mapsto \\partial_{\\eta}\\mathbf{C} - \\kappa\\,\\mathbf{C}$, with constant $\\kappa > 0$. For the value of $p$ selected in part (1), prove that the corresponding diagnostic energy obeys a strict decay law $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) = -2\\kappa\\,E_{p}(\\eta)$ under the same assumptions.\n\n3) Let the scale factor be $a(\\eta) = a_{0}(\\eta/\\eta_{0})^{q}$ with constant $a_{0}>0$, $\\eta_{0}>0$, and $q\\in\\mathbb{R}$, and consider any interval $[\\eta_{i},\\eta_{f}]$ with $\\eta_{f}>\\eta_{i}>0$. Using the decay law from part (2), determine a closed-form analytic expression for the damping coefficient $\\kappa$ (in units of inverse conformal time) required to achieve a prescribed reduction factor $r \\in (0,1)$ in the diagnostic energy over $[\\eta_{i},\\eta_{f}]$, that is,\n$$\n\\frac{E_{p}(\\eta_{f})}{E_{p}(\\eta_{i})} \\;=\\; r \\,.\n$$\nExpress your final answer for $\\kappa$ symbolically in terms of $r$ and $\\Delta \\eta \\equiv \\eta_{f}-\\eta_{i}$.\n\n4) Briefly justify why the addition of $-\\kappa\\,\\mathbf{C}$ does not spoil the formal second-order accuracy in time and space of a standard second-order accurate discretization of the undamped principal-part system, provided that $\\kappa$ is independent of the grid spacing and time step. No numerical estimate is required here.\n\nYour final answer must be the single analytic expression for $\\kappa$ obtained in part (3). Express $\\kappa$ in units of inverse conformal time. No units are to be included in the boxed final answer. If you choose to evaluate $\\kappa$ numerically for any particular $r$ and $\\Delta\\eta$, round to four significant figures; otherwise, leave the answer in exact analytic form.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, internally consistent, and objective. It presents a standard theoretical exercise in the analysis of partial differential equations relevant to numerical relativity, specifically concerning the propagation and damping of constraint violations. All necessary information is provided.\n\nWe will now proceed with the solution, addressing each of the four parts in sequence.\n\n1) Derivation of $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)$ and determination of $p$.\n\nThe one-parameter family of diagnostic energies is defined as:\n$$\nE_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} a(\\eta)^{p}\\,\\mathbf{C}(\\eta,\\mathbf{x})^{\\mathsf{T}} \\mathbf{C}(\\eta,\\mathbf{x})\\,\\mathrm{d}^{3}x\n$$\nTo find its time derivative with respect to conformal time $\\eta$, we apply the Leibniz integral rule. Since the integration volume $V$ is fixed in the comoving coordinates $\\mathbf{x}$, the derivative can be moved inside the integral.\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} \\frac{\\partial}{\\partial\\eta} \\left( a(\\eta)^{p}\\,\\mathbf{C}^{\\mathsf{T}}\\mathbf{C} \\right) \\mathrm{d}^{3}x\n$$\nUsing the product rule for differentiation, we get:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} \\left( p\\,a(\\eta)^{p-1} \\frac{\\mathrm{d}a}{\\mathrm{d}\\eta} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C} + a(\\eta)^{p} \\frac{\\partial}{\\partial\\eta}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{C}) \\right) \\mathrm{d}^{3}x\n$$\nThe derivative of the quadratic form $\\mathbf{C}^{\\mathsf{T}}\\mathbf{C} = \\sum_{k=1}^{4} C_{k}^{2}$ is $\\frac{\\partial}{\\partial\\eta}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{C}) = 2\\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C})$. Substituting this and the notation $a' = \\frac{\\mathrm{d}a}{\\mathrm{d}\\eta}$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} \\left( p\\,a(\\eta)^{p-1} a' \\mathbf{C}^{\\mathsf{T}}\\mathbf{C} + 2 a(\\eta)^{p} \\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C}) \\right) \\mathrm{d}^{3}x\n$$\nNow, we substitute the given undamped evolution system for the constraints, $\\partial_{\\eta} \\mathbf{C} = \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C}$, into the second term of the integrand:\n$$\n\\int_{V} a(\\eta)^{p} \\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C}) \\,\\mathrm{d}^{3}x \\;=\\; \\int_{V} a(\\eta)^{p} \\mathbf{C}^{\\mathsf{T}} \\left( \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\right) \\mathrm{d}^{3}x \\;=\\; a(\\eta)^{p} \\sum_{j=1}^{3} \\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,\\mathrm{d}^{3}x\n$$\nLet's analyze the integral $\\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,\\mathrm{d}^{3}x$. We can rewrite the integrand by noting that for any constant matrix $\\mathbf{M}$, we have $\\partial_{j}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{M}\\mathbf{C}) = (\\partial_{j}\\mathbf{C}^{\\mathsf{T}})\\mathbf{M}\\mathbf{C} + \\mathbf{C}^{\\mathsf{T}}\\mathbf{M}(\\partial_{j}\\mathbf{C})$. If $\\mathbf{M}$ is symmetric, $\\mathbf{M}=\\mathbf{M}^{\\mathsf{T}}$, then $(\\partial_{j}\\mathbf{C}^{\\mathsf{T}})\\mathbf{M}\\mathbf{C} = ((\\partial_{j}\\mathbf{C}^{\\mathsf{T}})\\mathbf{M}\\mathbf{C})^{\\mathsf{T}} = \\mathbf{C}^{\\mathsf{T}}\\mathbf{M}^{\\mathsf{T}}(\\partial_{j}\\mathbf{C}) = \\mathbf{C}^{\\mathsf{T}}\\mathbf{M}(\\partial_{j}\\mathbf{C})$. Therefore, for symmetric $\\mathbf{M}$, we have $\\mathbf{C}^{\\mathsf{T}}\\mathbf{M}(\\partial_{j}\\mathbf{C}) = \\frac{1}{2}\\partial_{j}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{M}\\mathbf{C})$.\nSince each matrix $\\mathbf{A}^{j}$ is given to be symmetric, we can write:\n$$\n\\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\;=\\; \\frac{1}{2}\\partial_{j}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{A}^{j}\\mathbf{C})\n$$\nThe integral becomes:\n$$\n\\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,\\mathrm{d}^{3}x \\;=\\; \\frac{1}{2} \\int_{V} \\partial_{j}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{A}^{j}\\mathbf{C}) \\,\\mathrm{d}^{3}x\n$$\nBy the divergence theorem, this volume integral of a partial derivative with respect to $x_j$ can be converted into a surface integral over the boundary of $V$. Due to the specified periodic boundary conditions on the three-torus, these boundary integrals vanish. Thus, for each $j \\in \\{1,2,3\\}$:\n$$\n\\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,\\mathrm{d}^{3}x \\;=\\; 0\n$$\nConsequently, the entire second term in the expression for $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)$ vanishes. We are left with:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} p\\,a(\\eta)^{p-1} a' \\mathbf{C}^{\\mathsf{T}}\\mathbf{C}\\,\\mathrm{d}^{3}x \\;=\\; \\frac{p\\,a'}{2 a^{1-p}} \\int_{V} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C}\\,\\mathrm{d}^{3}x\n$$\nFor $E_{p}(\\eta)$ to be conserved, i.e., $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)=0$, for all possible solutions $\\mathbf{C}$ and for a general evolution of the scale factor where we can assume $a' \\neq 0$ and $\\int_{V} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C}\\,\\mathrm{d}^{3}x > 0$ for non-trivial violations, the coefficient multiplying the integral must be zero. This requires $p=0$. This is the unique value for which the energy is conserved.\n\n2) Proof of decay for the damped system.\n\nThe modified system includes a damping term:\n$$\n\\partial_{\\eta}\\mathbf{C} \\;=\\; \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} - \\kappa\\,\\mathbf{C}\n$$\nwhere $\\kappa$ is a positive constant. We analyze the diagnostic energy $E_p(\\eta)$ for the value $p=0$ found in part (1):\n$$\nE_{0}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{C}\\,\\mathrm{d}^{3}x\n$$\nIts time derivative is:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{0}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} 2\\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C})\\,\\mathrm{d}^{3}x \\;=\\; \\int_{V} \\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C})\\,\\mathrm{d}^{3}x\n$$\nSubstituting the damped evolution equation:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{0}(\\eta) \\;=\\; \\int_{V} \\mathbf{C}^{\\mathsf{T}} \\left( \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} - \\kappa\\,\\mathbf{C} \\right) \\mathrm{d}^{3}x\n$$\nWe can split the integral into two parts:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{0}(\\eta) \\;=\\; \\int_{V} \\mathbf{C}^{\\mathsf{T}} \\left( \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\right) \\mathrm{d}^{3}x - \\int_{V} \\mathbf{C}^{\\mathsf{T}} (\\kappa\\,\\mathbf{C}) \\,\\mathrm{d}^{3}x\n$$\nAs established in part (1), the first integral is zero due to the symmetry of the $\\mathbf{A}^{j}$ matrices and periodic boundary conditions. The second integral simplifies to:\n$$\n- \\int_{V} \\kappa\\,\\mathbf{C}^{\\mathsf{T}}\\mathbf{C} \\,\\mathrm{d}^{3}x \\;=\\; - \\kappa \\int_{V} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C} \\,\\mathrm{d}^{3}x\n$$\nBy the definition of $E_0(\\eta)$, we have $\\int_{V} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C} \\,\\mathrm{d}^{3}x = 2 E_0(\\eta)$. Therefore:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{0}(\\eta) \\;=\\; - \\kappa (2 E_0(\\eta)) \\;=\\; -2\\kappa\\,E_{0}(\\eta)\n$$\nThis proves the strict decay law for the diagnostic energy $E_0(\\eta)$.\n\n3) Determination of the damping coefficient $\\kappa$.\n\nWe have the ordinary differential equation for $E_0(\\eta)$:\n$$\n\\frac{\\mathrm{d}E_{0}}{\\mathrm{d}\\eta} \\;=\\; -2\\kappa\\,E_{0}\n$$\nFor a constant $\\kappa$, this equation has the solution:\n$$\nE_{0}(\\eta) \\;=\\; E_{0}(\\eta_{i}) \\exp\\left( -2\\kappa (\\eta - \\eta_{i}) \\right)\n$$\nwhere $\\eta_i$ is the initial conformal time. We are given the condition that the energy is reduced by a factor $r$ over the interval $[\\eta_{i}, \\eta_{f}]$:\n$$\n\\frac{E_{0}(\\eta_{f})}{E_{0}(\\eta_{i})} \\;=\\; r\n$$\nSubstituting the solution for $E_0(\\eta)$ at $\\eta = \\eta_f$:\n$$\n\\frac{E_{0}(\\eta_{i}) \\exp\\left( -2\\kappa (\\eta_{f} - \\eta_{i}) \\right)}{E_{0}(\\eta_{i})} \\;=\\; r\n$$\n$$\n\\exp\\left( -2\\kappa (\\eta_{f} - \\eta_{i}) \\right) \\;=\\; r\n$$\nDefining $\\Delta\\eta \\equiv \\eta_{f}-\\eta_{i}$, we have:\n$$\n\\exp(-2\\kappa \\Delta\\eta) \\;=\\; r\n$$\nTo solve for $\\kappa$, we take the natural logarithm of both sides:\n$$\n-2\\kappa \\Delta\\eta \\;=\\; \\ln(r)\n$$\n$$\n\\kappa \\;=\\; -\\frac{\\ln(r)}{2 \\Delta\\eta}\n$$\nSince $r \\in (0,1)$, we have $\\ln(r) < 0$, which ensures that $\\kappa > 0$ as required. The information about the specific form of the scale factor, $a(\\eta) = a_0(\\eta/\\eta_0)^q$, was necessary to establish the uniqueness of $p=0$ for a non-static universe, but it is not needed to find $\\kappa$ once the decay law for $E_0$ is known.\n\n4) Justification for preservation of accuracy.\n\nThe formal order of accuracy of a numerical scheme for a partial differential equation is determined by the local truncation error, which measures how well the exact solution satisfies the discretized equations. This error is typically dominated by the discretization of the highest-order derivative terms.\n\nThe original undamped system is $\\partial_{\\eta} \\mathbf{C} = \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C}$. A second-order accurate scheme for this system would have a local truncation error of $O(\\Delta\\eta^2, \\Delta x^2)$, where the error terms arise from the finite-difference approximations to the time derivative $\\partial_{\\eta}$ and the spatial derivatives $\\partial_{j}$.\n\nThe modified system is $\\partial_{\\eta} \\mathbf{C} = \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} - \\kappa\\,\\mathbf{C}$. The added term, $-\\kappa\\,\\mathbf{C}$, is a zeroth-order term, as it involves no derivatives. In a numerical discretization, this term can be evaluated exactly at each grid point without introducing any new discretization error. When analyzing the total truncation error of a scheme applied to the damped equation (e.g., using Taylor series expansions), the error contributions from the discretization of $\\partial_{\\eta}$ and $\\partial_{j}$ remain unchanged. The new term $-\\kappa\\,\\mathbf{C}$ is simply added to the equation. If treated with a method that is at least second-order accurate in time (such as Crank-Nicolson), it will not degrade the overall second-order accuracy of the scheme. Provided that $\\kappa$ is a constant independent of the grid spacing $(\\Delta x, \\Delta\\eta)$, the addition of this lower-order term does not affect the leading-order terms in the truncation error, which continue to be $O(\\Delta\\eta^2, \\Delta x^2)$. Therefore, the formal second-order accuracy is preserved.",
            "answer": "$$\\boxed{-\\frac{\\ln(r)}{2 \\Delta \\eta}}$$"
        }
    ]
}