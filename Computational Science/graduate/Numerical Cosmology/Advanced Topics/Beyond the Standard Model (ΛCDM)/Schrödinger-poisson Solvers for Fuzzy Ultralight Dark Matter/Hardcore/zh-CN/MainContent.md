## 引言
暗物质是现代宇宙学的核心谜题之一。尽管[冷暗物质](@entry_id:158219)（CDM）模型在解释宇宙大尺度结构方面取得了巨大成功，但它在星系等小尺度上却面临着“核心-尖峰问题”和“卫星星系失踪问题”等挑战。超轻[模糊暗物质](@entry_id:161829)（Fuzzy Dark Matter, FDM）模型作为一种引人注目的替代方案应运而生。该模型假设暗物质由质量极轻（约 $10^{-22}$ eV）的标量粒子构成，其德布罗意波长可达千秒差距尺度，从而在星系尺度上展现出显著的波动性。

描述这种[自引力](@entry_id:271015)量子流体行为的数学框架是薛定谔-泊松（Schrödinger-Poisson, SP）[方程组](@entry_id:193238)。然而，要将 FDM 模型的理论预测与天文观测进行精确比较，我们必须解决一个关键的知识鸿沟：如何开发和应用能够准确捕捉其独特波动动力学的数值模拟工具。这不仅是一个天体物理学问题，更是一个复杂的计算科学挑战。

本文旨在系统性地介绍用于模拟 FDM 的[薛定谔-泊松求解器](@entry_id:754567)的理论、应用与实践。在“原理与机制”一章中，我们将深入探讨 SP [方程组](@entry_id:193238)的物理基础，阐释其与[流体力学](@entry_id:136788)的联系，并分析量子压力、干涉和孤子等关键现象。接下来，在“应用与交叉学科联系”一章中，我们将展示如何利用这些求解器来研究 FDM 暗物质晕的形成与演化，探讨其在天体物理学中的可观测效应，并剖析自适应网格加密等高级数值技术。最后，通过“动手实践”部分，读者将有机会通过具体的编程练习来巩固所学知识，亲手构建和验证一个基础的 SP 求解器。通过这三个层次的递进，本文将为您全面揭示连接 FDM 理论与宇宙观测的关键桥梁——[数值模拟](@entry_id:137087)。

## 原理与机制

在深入研究数值求解器之前，我们必须首先建立描述超轻[模糊暗物质](@entry_id:161829)（Fuzzy Dark Matter, FDM）动力学的核心物理原理和数学框架。本章将系统地阐述作为 FDM 标准模型的薛定谔-泊松（Schrödinger-Poisson, SP）[方程组](@entry_id:193238)，探讨其[流体动力学](@entry_id:136788)类比，分析其关键的波动现象，并讨论其适用范围和与经典理论的联系。

### 控制方程：薛定谔-泊松系统

FDM 模型将暗物质视为一种非相对论性的标量场，其行为由一个[宏观波函数](@entry_id:143853) $\psi(\mathbf{x}, t)$ 描述。这个[波函数](@entry_id:147440)所代表的[量子流体](@entry_id:140332)在自身的[引力](@entry_id:175476)作用下演化。该系统的动力学由两个耦合的[偏微分方程](@entry_id:141332)——薛定谔方程和[泊松方程](@entry_id:143763)——共同决定。

最基础的 FDM 模型是无相互作用的，其控制[方程组](@entry_id:193238)被称为**薛定谔-泊松（Schrödinger-Poisson, SP）系统**。该系统包括：

1.  **薛定谔方程**：描述了[波函数](@entry_id:147440) $\psi$ 在[引力势](@entry_id:160378) $\Phi$ 中的时间演化。对于单个质量为 $m$ 的粒子，其[哈密顿算符](@entry_id:144286) $\hat{H}$ 包含[动能算符](@entry_id:265633) $\hat{T} = -(\hbar^2/2m)\nabla^2$ 和势能算符 $\hat{V} = m\Phi$。由此，时变薛定谔方程 $i\hbar \partial_t \psi = \hat{H}\psi$ 具体写作：
    $$
    i\hbar \frac{\partial \psi}{\partial t} = -\frac{\hbar^2}{2m}\nabla^2 \psi + m\Phi \psi
    $$

2.  **[泊松方程](@entry_id:143763)**：描述了[引力势](@entry_id:160378) $\Phi$ 如何由物质密度[分布](@entry_id:182848) $\rho$ 产生。根据量子力学的诠释，[波函数的模方](@entry_id:175496) $|\psi|^2$ 代表了粒子的[数密度](@entry_id:268986)。因此，质量密度 $\rho$ 与[波函数](@entry_id:147440)的关系为 $\rho = m|\psi|^2$。泊松方程写作：
    $$
    \nabla^2 \Phi = 4\pi G \rho = 4\pi G m |\psi|^2
    $$

在[宇宙学模拟](@entry_id:747928)中，通常在一个周期性盒子中求解此系统，以代表宇宙的一个局部区域。在这种情况下，[引力源](@entry_id:271552)通常采用**[密度扰动](@entry_id:159546)** $\rho - \bar{\rho}$，其中 $\bar{\rho}$ 是盒子内的平均密度。这种处理方式（有时被称为“Jeans 佯谬”或“Jeans swindle”）可以正确处理宇宙背景膨胀下的局部引力坍缩问题。因此，在宇宙学背景下，[泊松方程](@entry_id:143763)修正为：
$$
\nabla^2 \Phi = 4\pi G (\rho - \bar{\rho})
$$

综合起来，标准的宇宙学薛定谔-泊松系统由以下三个方程构成 ：
$$
\begin{cases}
i\hbar \frac{\partial \psi}{\partial t} = -\frac{\hbar^2}{2m}\nabla^2 \psi + m\Phi \psi \\
\nabla^2 \Phi = 4\pi G (\rho - \bar{\rho}) \\
\rho = m|\psi|^2
\end{cases}
$$

某些[粒子物理模型](@entry_id:156760)还引入了暗物[质粒](@entry_id:263777)子之间的**[自相互作用](@entry_id:201333)**。在平均场近似下，一个局域的、排斥性的[接触相互作用](@entry_id:150822)可以在[哈密顿量](@entry_id:172864)中增加一个正比于 $|\psi|^4$ 的能量密度项。这导致薛定谔方程中增加一个[非线性](@entry_id:637147)项 $g|\psi|^2\psi$，其中 $g > 0$ 是[耦合常数](@entry_id:747980)。这个扩展的系统被称为**格罗斯-皮塔耶夫斯基-泊松（Gross-Pitaevskii-Poisson, GPP）系统**  ：
$$
i\hbar \frac{\partial \psi}{\partial t} = -\frac{\hbar^2}{2m}\nabla^2 \psi + m\Phi \psi + g|\psi|^2\psi
$$
GPP 系统描述了一种自引力的玻色-爱因斯坦凝聚体，其动力学行为会因[自相互作用](@entry_id:201333)的存在而与 SP 系统产生显著差异。

### [流体动力学](@entry_id:136788)类比：马德隆变换

薛定谔-泊松系统的波动性描述虽然基础，但有时不够直观。通过 **Madelung 变换**，我们可以将其改写为一组更具[流体动力学](@entry_id:136788)直观性的方程 。该变换将复数[波函数](@entry_id:147440) $\psi$ 分解为实数振幅和相位：
$$
\psi(\mathbf{x}, t) = \sqrt{\frac{\rho(\mathbf{x}, t)}{m}} \exp\left(\frac{iS(\mathbf{x}, t)}{\hbar}\right)
$$
这里，$\rho$ 是质量密度，而 $S$ 是一个实值相[位场](@entry_id:143025)。流体的[速度场](@entry_id:271461) $\mathbf{v}$ 被定义为相[位梯度](@entry_id:261486)的函数：
$$
\mathbf{v}(\mathbf{x}, t) \equiv \frac{\nabla S}{m}
$$
由于速度场是标量场 $S$ 的梯度，这意味着该流体是**无旋**的，即 $\nabla \times \mathbf{v} = 0$。

将此变换代入薛定谔方程并分离实部和虚部，我们得到两组方程。虚部给出了**[连续性方程](@entry_id:195013)**：
$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v}) = 0
$$
这个方程形式上与经典[流体力学](@entry_id:136788)中的[质量守恒定律](@entry_id:147377)完全相同。

实部则给出了一个修正的[哈密顿-雅可比方程](@entry_id:145701)。对其取梯度，我们得到一个类似于[欧拉方程](@entry_id:177914)的**动量方程**：
$$
\frac{\partial \mathbf{v}}{\partial t} + (\mathbf{v} \cdot \nabla)\mathbf{v} = -\nabla\Phi - \nabla V_Q
$$
这个方程描述了流体微元的加速度。右侧的力包括[引力](@entry_id:175476) $-\nabla\Phi$ 和一个额外的项 $-\nabla V_Q$。这个额外的项源于[波函数](@entry_id:147440)的动能项，被称为**量子压力（quantum pressure）**，其对应的[势能](@entry_id:748988) $V_Q$ 为：
$$
V_Q = -\frac{\hbar^2}{2m^2} \frac{\nabla^2\sqrt{\rho}}{\sqrt{\rho}}
$$
量子压力是 FDM 区别于经典[冷暗物质](@entry_id:158219)（Cold Dark Matter, CDM）的关键。它是一种内在的排斥效应，源于[海森堡不确定性原理](@entry_id:171099)：将波包限制在越来越小的空间区域内需要越来越大的动能，这表现为一种抵抗[引力坍缩](@entry_id:161275)的压力。正是这种压力阻止了 FDM 形成任意小的结构，并使其在小尺度上区别于 CDM。

### 基本波动现象

FDM 的波动性赋予了它一系列独特的、在经典粒子模型中不存在的现象。

#### 干涉、节点和[量子涡旋](@entry_id:147375)

作为一种波，$\psi$ 场能够发生干涉。在[相消干涉](@entry_id:170966)发生的区域，[波函数](@entry_id:147440)振幅趋于零，导致密度 $\rho = m|\psi|^2$ 也趋于零。这些密度为零的区域可以是点、线或面，被称为**节点（nodes）**。

在这些节点附近，相位场 $S$ 可以具有非平庸的拓扑结构。例如，一个一维的节点线（二维平面上的一个点）通常对应于一个**[量子涡旋](@entry_id:147375)**。在涡旋核心，密度为零，而速度场 $\mathbf{v} = \nabla S/m$ 则围绕核心形成环流。这种环流是量子化的，其[环路积分](@entry_id:164828) $\oint \mathbf{v} \cdot d\mathbf{l}$ 的值是普朗克常数 $h=2\pi\hbar$ 除以[粒子质量](@entry_id:156313) $m$ 的整数倍。

我们可以通过一个具体的例子来理解这一点 。考虑一个位于原点的[二维涡旋](@entry_id:158722)，其局域[波函数](@entry_id:147440)形式为 $\psi(r, \theta) = A r \exp(i\theta) \exp(-r^2/2\sigma^2)$。这里的相位因子是 $e^{i\theta}$，因此相[位场](@entry_id:143025)为 $S = \hbar\theta$。对应的速度场为 $\mathbf{v} = (\nabla S)/m = (\hbar/mr)\hat{\boldsymbol{\theta}}$，这是一个纯[方位角](@entry_id:164011)方向的速度场，其大小与到中心的距离 $r$ 成反比。围绕该涡旋核心的[环绕数](@entry_id:138707)（winding number）$n = \frac{1}{2\pi} \oint \nabla(S/\hbar) \cdot d\mathbf{l}$ 恰好为 1，代表了一个单位的[量子化环流](@entry_id:160210)。这种涡旋和干涉条纹是 FDM 晕中普遍存在的“颗粒”或子结构，它们是波动动力学的直接证据。

#### [德布罗意波长](@entry_id:139033)与量子尺度

所有波动现象的特征尺度都与**德布罗意波长** $\lambda_{\rm dB} = h/p = h/(mv)$ 有关。我们可以通过一个简单的标度分析来估计量子效应在何种尺度上变得重要 。

考虑一个质量为 $M$、半径为 $R$ 的[自引力](@entry_id:271015) virialized [暗物质晕](@entry_id:147523)。根据[维里定理](@entry_id:146441)，晕中粒子的[特征速度](@entry_id:165394) $v$ 约为 $v \sim \sqrt{GM/R}$。代入[德布罗意波长公式](@entry_id:144976)，我们得到：
$$
\lambda_{\rm dB} \sim \frac{h}{m\sqrt{GM/R}}
$$
当德布罗意波长与暗物质晕的尺寸相当时，即 $\lambda_{\rm dB} \sim R$，量子效应（如干涉和量子压力）将在整个晕的尺度上变得显著。这个条件定义了一个临界的 FDM 粒子质量 $m_{\rm crit}$：
$$
m_{\rm crit} = \frac{h}{\sqrt{GMR}}
$$
对于给定的星系晕（例如，一个矮星系），如果 FDM [粒子质量](@entry_id:156313) $m$ 小于 $m_{\rm crit}$，那么该晕的结构将由波动效应主导。反之，如果 $m \gg m_{\rm crit}$，则 $\lambda_{\rm dB} \ll R$，量子效应仅在远小于晕尺寸的尺度上重要，而在大尺度上，该晕的行为将接近经典 CDM。这个简单的关系为通过观测星系结构来限制 FDM 粒子质量提供了理论基础。

### [引力不稳定性](@entry_id:160721)与[结构形成](@entry_id:158241)

在宇宙学中，结构是通过[引力不稳定性](@entry_id:160721)从微小的初始密度涨落中生长出来的。对于 FDM，这个过程受到量子压力的显著影响。我们可以通过[线性微扰理论](@entry_id:159071)来研究这一过程 。

考虑一个均匀的 FDM 背景密度 $\bar{\rho}$，并引入一个小的平面波密度微扰 $\delta\rho \propto \exp[i(\mathbf{k}\cdot\mathbf{x} - \omega t)]$。通过线性化[流体力学](@entry_id:136788)[方程组](@entry_id:193238)，我们可以推导出微扰的[色散关系](@entry_id:140395) $\omega(k)$，它描述了频率 $\omega$ 与[波数](@entry_id:172452) $k=|\mathbf{k}|$ 之间的关系：
$$
\omega^2(k) = \frac{\hbar^2 k^4}{4m^2} - 4\pi G \bar{\rho}
$$
这个色散关系包含两项：
-   第一项 $\frac{\hbar^2 k^4}{4m^2}$ 来自量子压力。它随[波数](@entry_id:172452) $k$ 的四次方增长，意味着在小尺度（大 $k$）上，量子压力提供了一个强大的恢复力，使微扰以波的形式传播。
-   第二项 $-4\pi G \bar{\rho}$ 来[自引力](@entry_id:271015)。它是一个负的常数项，反映了[引力](@entry_id:175476)的不稳定性本质——它总是试图使密度过密区域进一步坍缩。

当 $\omega^2 > 0$ 时，微扰是稳定的[振荡](@entry_id:267781)波。当 $\omega^2  0$ 时，$\omega$ 是虚数，微扰会呈[指数增长](@entry_id:141869)（或衰减），这标志着**[引力不稳定性](@entry_id:160721)**。区分这两种行为的临界[波数](@entry_id:172452)被称为**[金斯波数](@entry_id:276079)（Jeans wavenumber）** $k_J$，它由 $\omega^2(k_J)=0$ 定义：
$$
k_J = \left(\frac{16\pi G \bar{\rho} m^2}{\hbar^2}\right)^{1/4}
$$
对应的物理尺度，**[金斯长度](@entry_id:157888)** $\lambda_J = 2\pi/k_J$，代表了能够发生[引力坍缩](@entry_id:161275)的最小尺度。在大于 $\lambda_J$ 的尺度上（$k  k_J$），[引力](@entry_id:175476)占主导，微扰会增长并形成结构。在小于 $\lambda_J$ 的尺度上（$k > k_J$），量子压力能够抵抗[引力](@entry_id:175476)，抑制结构的形成。这直接导致 FDM 宇宙中的[物质功率谱](@entry_id:161407)在小尺度上被截断，从而预测了比 CDM 模型更少的矮星系和更平滑的暗物质晕核心。

### 平衡结构：[孤子](@entry_id:145656)

引力坍缩的最终产物是什么？在 FDM 模型中，由于量子压力的支撑，坍缩不会形成密度[奇异点](@entry_id:199525)，而是形成一种稳定、致密的平衡结构，称为**[孤子](@entry_id:145656)（soliton）**或**孤立子波**。这些[孤子](@entry_id:145656)被认为是 FDM 暗物质晕的中心核心。

一个孤子是一个时间平稳、空间局域的薛定谔-泊松方程解。我们可以通过分离变量的[拟设](@entry_id:184384) $\psi(r,t) = e^{-i\mu t/\hbar}u(r)$ 来寻找球对称的[基态](@entry_id:150928)[孤子](@entry_id:145656)解，其中 $\mu$ 是化学势（一个负的[本征值](@entry_id:154894)），$u(r)$ 是一个实的[径向波函数](@entry_id:266233) 。将此代入 SP 系统，我们得到一组常微分方程：
$$
\begin{cases}
-\frac{\hbar^2}{2m}\left(\frac{d^2u}{dr^2} + \frac{2}{r}\frac{du}{dr}\right) + m\Phi(r)u(r) = \mu u(r) \\
\frac{1}{r^2}\frac{d}{dr}\left(r^2\frac{d\Phi}{dr}\right) = 4\pi G m u(r)^2
\end{cases}
$$
这是一个[非线性](@entry_id:637147)的[本征值问题](@entry_id:142153)。为了得到物理上合理的解，我们需要施加边界条件：在原点 $r=0$，解必须是光滑的，即 $u'(0)=0$ 和 $\Phi'(0)=0$；在无穷远处 $r\to\infty$，为了保证束缚态和总质量有限，我们要求 $u(r)\to 0$ 和 $\Phi(r)\to 0$。

这个问题没有解析解，但可以通过数值方法，如**打靶法（shooting method）**来求解。通过选择一个中心振幅 $u(0)$ 和一个试探的化学势 $\mu$，从原点向外积分方程。正确的[本征值](@entry_id:154894) $\mu$ 将使得 $u(r)$ 在无穷远处恰好衰减到零。通过迭代调整 $\mu$，可以找到满足所有边界条件的解。

数值求解得到的[孤子](@entry_id:145656)具有一个特征性的密度[分布](@entry_id:182848)：一个致密的核心，其密度向外迅速下降。这个核心密度与核心半径之间存在一个反比关系：更重的孤子更致密、更小。这种核心-晕质量关系是 FDM 的一个关键预测。

### 扩展与适用范围

#### 自相互作用的影响

当考虑 FDM 粒子间的自相互作用时（GPP 系统），动力学和平衡结构都会发生改变 。一个排斥性的[接触相互作用](@entry_id:150822) $g|\psi|^2\psi$ 在流体图像中引入了一个正比于 $\rho^2$ 的附加压力项。这导致了修正的[色散关系](@entry_id:140395)和[金斯波数](@entry_id:276079) $k_J(g)$：
$$
\omega^2(k) = \frac{\hbar^2 k^4}{4m^2} + \frac{g\bar{\rho}}{m^2}k^2 - 4\pi G\bar{\rho}
$$
$$
k_J^2(g) = \frac{2}{\hbar^2}\left( \sqrt{g^2\bar{\rho}^2 + 4\pi G m^2 \hbar^2\bar{\rho}} - g\bar{\rho} \right)
$$
自相互作用在所有尺度上都提供了额外的压力支持，因此会进一步抑制[引力不稳定性](@entry_id:160721)，导致金斯尺度变大。

在孤子结构方面，如果[自相互作用](@entry_id:201333)足够强，以至于可以忽略量子压力（这被称为 **[Thomas-Fermi 近似](@entry_id:143139)**），则系统的平衡由[引力](@entry_id:175476)和[自相互作用](@entry_id:201333)压力决定。在这种情况下，[状态方程](@entry_id:274378)是 $P \propto \rho^2$，这对应于一个[多方指数](@entry_id:137268) $n=1$ 的[多方球](@entry_id:157892)。这种孤子的半径仅由基本常数决定，而与[孤子](@entry_id:145656)的总质量或中心密度无关。

#### 与[经典动力学](@entry_id:177360)的联系

SP 系统的波动行为在何时以及如何过渡到经典 CDM 的粒子行为？这个问题的答案在于**粗粒化**和**[对应原理](@entry_id:155778)** 。

经典无碰撞暗物质由**弗拉索夫-泊松（Vlasov-Poisson）方程**描述，其变量是[相空间分布](@entry_id:151304)函数 $f(\mathbf{x}, \mathbf{v}, t)$。与 SP 系统的单值[速度场](@entry_id:271461) $\mathbf{v}(\mathbf{x})$ 不同，[相空间分布](@entry_id:151304)函数允许在同一空间点 $\mathbf{x}$ 存在多个速度流（即多流区）。这是宇宙结构形成后期，物质发生[壳层穿越](@entry_id:754769)（shell-crossing）后的普遍情况。

在 SP 系统中，多流区通过[波函数](@entry_id:147440)的干涉来表现。例如，两个相向而行的物质流可以被建模为两个平面波的叠加。这会在密度场中产生[驻波](@entry_id:148648)状的干涉条纹。然而，如果我们用一个尺度为 $L$ 的窗口对 SP 系统的密度和动量场进行[空间平均](@entry_id:203499)（粗粒化），只要 $L$ 远大于[干涉条纹](@entry_id:176719)的波长（即[德布罗意波长](@entry_id:139033)），这些微观的[量子振荡](@entry_id:142355)就会被平均掉。经过粗粒化后，量子压力项的贡献也趋于零。最终，粗粒化后的 SP [流体方程](@entry_id:195729)在形式上就退化为了描述冷、无压流体的[欧拉方程](@entry_id:177914)，这正是[弗拉索夫-泊松方程](@entry_id:756543)的零阶和一阶[矩方程](@entry_id:149666)在冷极限下的形式。因此，在远大于[德布罗意波长](@entry_id:139033)的尺度上，FDM 的行为与 CDM 无法区分。

#### 适用范围：非相对论极限

薛定谔-泊松系统本身是一个非相对论近似，它是在更基本的相对论性场论——**克莱因-戈登（Klein-Gordon）方程**——的基础上，通过滤掉粒子静止质量能量 $mc^2$ 对应的高频[振荡](@entry_id:267781)得到的 。这个近似的有效性依赖于几个条件：
1.  **弱[引力场](@entry_id:169425)**：$|\Phi|/c^2 \ll 1$。
2.  **非相对论性速度**：$v^2/c^2 \ll 1$。
3.  **缓慢演化**：场的动能远小于其静止质量能，即 $E_{\text{kin}} \ll mc^2$。

对于一个特征[波数](@entry_id:172452)为 $k$ 的[波包](@entry_id:154698)，第三个条件可以写成 $\hbar^2 k^2 / (2m) \ll mc^2$。这为 SP 系统的有效性设定了一个[波数](@entry_id:172452)上限，或者说是一个长度下限 $L_{\text{crit}}$。当研究的物理尺度小于 $L_{\text{crit}}$ 时，相对论效应变得不可忽略，必须使用[克莱因-戈登方程](@entry_id:153831)来代替薛定谔方程。对于一个典型的 FDM [粒子质量](@entry_id:156313) $m \sim 10^{-22} \text{ eV}/c^2$，这个临界尺度约为几个毫秒差距（milliparsec），远小于大多数天体物理结构的尺寸。因此，在绝大多数宇宙学应用中，薛定谔-泊松系统都是一个极好的近似。

#### 无量纲化

在进行[数值模拟](@entry_id:137087)时，将控制方程**无量纲化**是一种标准且强大的技术 。通过引入[特征长度](@entry_id:265857)、时间和[波函数](@entry_id:147440)振幅尺度 $L, T, \Psi_0$，我们可以将 SP 系统改写为一组不含物理单位的方程。这个过程揭示了控制系统行为的真正独立的无量纲参数组合。例如，通过恰当的标度选择，SP 系统可以被一个单一的无量纲参数 $\Lambda = 4\pi G m^2 \Psi_0^2 L^2 T / \hbar$ 所控制。这个参数 $\Lambda$ 衡量了引力势能与动能（或时间演化）尺度的相对重要性。理解这些无量纲参数有助于设计数值实验、分析结果以及将模拟结果推广到不同的物理场景。