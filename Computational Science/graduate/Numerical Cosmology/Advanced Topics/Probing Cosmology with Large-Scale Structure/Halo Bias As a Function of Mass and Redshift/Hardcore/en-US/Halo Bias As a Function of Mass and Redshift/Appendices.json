{
    "hands_on_practices": [
        {
            "introduction": "Our exploration begins with the foundational Press-Schechter (PS) model, a cornerstone in the theory of structure formation. This first exercise will guide you through the derivation of the linear halo bias using the peak-background split argument applied to the PS mass function . Mastering this calculation is essential as it reveals the core mathematical and physical principles connecting halo abundance to the large-scale environment.",
            "id": "3474467",
            "problem": "Consider the Press–Schechter halo multiplicity function in Cold Dark Matter (CDM) cosmology, defined for scaled peak height $ \\nu $ by $ f(\\nu) = \\sqrt{2/\\pi}\\,\\nu\\,\\exp(-\\nu^{2}/2) $. In the peak-background split (PBS) picture, a long-wavelength background overdensity $ \\delta_{b} $ shifts the spherical collapse barrier $ \\delta_{c} $ to $ \\delta_{c} - \\delta_{b} $, so that the peak height parameter depends on mass $ M $ and redshift $ z $ as $ \\nu(M,z,\\delta_{b}) = (\\delta_{c} - \\delta_{b})/\\sigma(M,z) $, where $ \\sigma(M,z) $ is the linear theory root-mean-square of the density field smoothed on scale $ M $ at redshift $ z $ and $ \\delta_{c} $ is the critical collapse threshold.\n\nStarting from these definitions and treating $ \\nu $ as a function of $ \\delta_{b} $ at fixed $ M $ and $ z $, derive the Lagrangian linear bias $ b_{1}^{L}(M,z) $, defined by the PBS response\n$$\nb_{1}^{L}(M,z) = \\left.\\frac{\\partial \\ln f\\big(\\nu(M,z,\\delta_{b})\\big)}{\\partial \\delta_{b}}\\right|_{\\delta_{b}=0},\n$$\nand express your final answer as a closed-form analytic expression $ b_{1}^{L}(\\nu) $ in terms of $ \\nu $ and $ \\delta_{c} $ only. Do not insert a numerical value for $ \\delta_{c} $. The final answer should be a single analytical expression. No rounding is required, and no units are to be provided.",
            "solution": "The Lagrangian linear bias, $b_1^L$, is defined by the first-order response of the halo abundance to a long-wavelength background perturbation $\\delta_b$. The problem gives the specific definition:\n$$\nb_{1}^{L} = \\left.\\frac{\\partial \\ln f\\big(\\nu(M,z,\\delta_{b})\\big)}{\\partial \\delta_{b}}\\right|_{\\delta_{b}=0}\n$$\nWe use the chain rule to evaluate this derivative:\n$$\nb_{1}^{L} = \\left( \\frac{d \\ln f(\\nu)}{d\\nu} \\cdot \\frac{\\partial \\nu}{\\partial \\delta_{b}} \\right)_{\\delta_b=0}\n$$\nFirst, we compute the derivative of $\\ln f(\\nu)$ for the Press-Schechter function $f(\\nu) = \\sqrt{2/\\pi}\\,\\nu\\,\\exp(-\\nu^{2}/2)$. The logarithm is:\n$$\n\\ln f(\\nu) = \\ln\\left(\\sqrt{\\frac{2}{\\pi}}\\right) + \\ln(\\nu) - \\frac{\\nu^{2}}{2}\n$$\nDifferentiating with respect to $\\nu$ gives:\n$$\n\\frac{d \\ln f(\\nu)}{d\\nu} = \\frac{1}{\\nu} - \\nu\n$$\nNext, we compute the derivative of $\\nu$ with respect to $\\delta_b$. The peak height is given as $\\nu(M,z,\\delta_{b}) = (\\delta_{c} - \\delta_{b})/\\sigma(M,z)$. Differentiating with respect to $\\delta_b$ (holding $\\delta_c$ and $\\sigma$ constant) yields:\n$$\n\\frac{\\partial \\nu}{\\partial \\delta_{b}} = -\\frac{1}{\\sigma(M,z)}\n$$\nCombining these results using the chain rule:\n$$\nb_{1}^{L} = \\left(\\frac{1}{\\nu} - \\nu\\right) \\left(-\\frac{1}{\\sigma(M,z)}\\right) = \\frac{\\nu^2 - 1}{\\nu \\sigma(M,z)}\n$$\nThis expression is evaluated at $\\delta_b=0$, which means $\\nu$ is the standard peak height, $\\nu = \\delta_c / \\sigma(M,z)$. The problem asks for the answer in terms of $\\nu$ and $\\delta_c$. We can eliminate $\\sigma(M,z)$ using the relation $\\sigma(M,z) = \\delta_c / \\nu$. Substituting this into our expression for bias:\n$$\nb_{1}^{L}(\\nu) = \\frac{\\nu^2 - 1}{\\nu (\\delta_c/\\nu)} = \\frac{\\nu^2 - 1}{\\delta_c}\n$$\nThis is the final expression for the Lagrangian bias in the Press-Schechter model.",
            "answer": "$$\\boxed{\\frac{\\nu^2 - 1}{\\delta_{c}}}$$"
        },
        {
            "introduction": "While the Press-Schechter model provides crucial insights, it is known to have discrepancies with results from N-body simulations. The Sheth-Tormen (ST) mass function offers a more accurate description by incorporating parameters that account for complexities like ellipsoidal collapse. This practice challenges you to apply the same peak-background split formalism to the ST function, demonstrating how the bias formula adapts to a more sophisticated model .",
            "id": "3474440",
            "problem": "In a Cold Dark Matter cosmology, consider the halo multiplicity function proposed by Sheth–Tormen, which can be written as\n$$\nf(\\nu)=A\\,\\sqrt{\\frac{2a}{\\pi}}\\,\\nu\\,\\left[1+\\left(a\\nu^{2}\\right)^{-p}\\right]\\,\\exp\\!\\left(-\\frac{a\\nu^{2}}{2}\\right),\n$$\nwhere $A$ is a normalization constant, $a$ and $p$ are positive parameters, and $\\nu \\equiv \\delta_{c}/\\sigma(M,z)$ is the peak height with $\\delta_{c}$ the spherical-collapse threshold and $\\sigma(M,z)$ the variance of the linear density field smoothed on mass scale $M$ at redshift $z$. Assume $\\delta_{c}$ is a constant independent of $z$ and $M$.\n\nUsing the peak–background split at fixed $M$ and $z$, model the response of the multiplicity function $f(\\nu)$ to a long-wavelength background overdensity $\\delta_{b}$ that shifts the collapse threshold as $\\delta_{c} \\rightarrow \\delta_{c}-\\delta_{b}$. Work consistently to linear order in $\\delta_{b}$ and use only the foundational definitions and facts described above. Derive the Lagrangian linear halo bias $b_{1}^{L}(\\nu)$, defined by the fractional response of the abundance at fixed $M$ to $\\delta_{b}$, expressed as a closed-form analytic function of $a$, $p$, $\\nu$, and $\\delta_{c}$. You may assume that any overall normalization factor $A$ in $f(\\nu)$ does not affect $b_{1}^{L}(\\nu)$.\n\nExpress your final answer as a single analytic expression for $b_{1}^{L}(\\nu)$ with no units. No numerical evaluation or rounding is required.",
            "solution": "The Lagrangian linear bias $b_1^L$ is defined as the fractional response of the halo number density $n_h$ to a long-wavelength background density perturbation $\\delta_b$. Using the peak-background split argument, this can be shown to be equivalent to:\n$$\nb_1^L = -\\frac{d \\ln n_h}{d \\delta_c}\n$$\nSince the halo abundance $n_h$ at fixed mass is proportional to the multiplicity function $f(\\nu)$, we can write $b_1^L = -d(\\ln f)/d\\delta_c$. Using the chain rule, and noting that $\\nu = \\delta_c/\\sigma$, we have $d\\nu/d\\delta_c = 1/\\sigma$. This gives:\n$$\nb_1^L = -\\frac{d\\ln f}{d\\nu} \\frac{d\\nu}{d\\delta_c} = -\\frac{1}{\\sigma} \\frac{d\\ln f}{d\\nu}\n$$\nTo express the result in terms of $\\nu$ and $\\delta_c$, we use $\\sigma = \\delta_c/\\nu$:\n$$\nb_1^L(\\nu) = -\\frac{\\nu}{\\delta_c} \\frac{d\\ln f}{d\\nu}\n$$\nNow we compute this for the Sheth-Tormen function. The logarithm of $f(\\nu)$ is:\n$$\n\\ln f(\\nu) = \\text{const} + \\ln(\\nu) + \\ln\\left(1 + (a\\nu^2)^{-p}\\right) - \\frac{a\\nu^2}{2}\n$$\nDifferentiating with respect to $\\nu$:\n$$\n\\frac{d(\\ln f)}{d\\nu} = \\frac{1}{\\nu} + \\frac{1}{1+(a\\nu^2)^{-p}} \\cdot (-p)(a\\nu^2)^{-p-1} \\cdot (2a\\nu) - a\\nu\n$$\nLet's simplify the middle term:\n$$\n\\frac{-2ap\\nu \\cdot (a\\nu^2)^{-p-1}}{1+(a\\nu^2)^{-p}} = \\frac{-2p(a\\nu^2)(a\\nu^2)^{-p-1}}{ \\nu(1+(a\\nu^2)^{-p})} = \\frac{-2p(a\\nu^2)^{-p}}{\\nu(1+(a\\nu^2)^{-p})} = \\frac{-2p}{\\nu((a\\nu^2)^p+1)}\n$$\nSo the full derivative is:\n$$\n\\frac{d(\\ln f)}{d\\nu} = \\frac{1}{\\nu} - a\\nu - \\frac{2p}{\\nu(1+(a\\nu^2)^p)}\n$$\nFinally, we substitute this into the expression for $b_1^L(\\nu)$:\n$$\nb_1^L(\\nu) = -\\frac{\\nu}{\\delta_c} \\left( \\frac{1}{\\nu} - a\\nu - \\frac{2p}{\\nu(1+(a\\nu^2)^p)} \\right) = -\\frac{1}{\\delta_c} \\left( 1 - a\\nu^2 - \\frac{2p}{1+(a\\nu^2)^p} \\right)\n$$\nRearranging gives the final answer:\n$$\nb_1^L(\\nu) = \\frac{1}{\\delta_c} \\left( a\\nu^2 - 1 + \\frac{2p}{1+(a\\nu^2)^p} \\right)\n$$",
            "answer": "$$ \\boxed{ \\frac{1}{\\delta_c} \\left( a\\nu^2 - 1 + \\frac{2p}{1+(a\\nu^2)^p} \\right) } $$"
        },
        {
            "introduction": "Deriving bias formulas is only the first step; true understanding comes from interpreting them physically. This final practice focuses on converting the Lagrangian biases derived for the PS and ST models into the more directly observable Eulerian biases . You will then analyze their behavior in the limits of very high and very low mass halos, providing profound physical intuition for why the rarest, most massive objects are the most powerful tracers of the underlying cosmic web.",
            "id": "3474479",
            "problem": "Consider a statistically homogeneous and isotropic Universe in which dark matter halos form from the collapse of initial Gaussian density fluctuations. Define the peak height variable $\\nu$ by $\\nu \\equiv \\delta_{c}/\\sigma(M,z)$, where $\\delta_{c}$ is the spherical-collapse threshold and $\\sigma(M,z)$ is the linear-theory root-mean-square fluctuation of the matter density field filtered at mass scale $M$ and redshift $z$. Assume the halo mass function is universal and can be written in terms of a multiplicity function $f(\\nu)$ such that the comoving number density is proportional to $f(\\nu)$. \n\nTwo widely used prescriptions for $f(\\nu)$ are the Press–Schechter (PS) and the Sheth–Tormen (ST) forms. Let $f_{\\mathrm{PS}}(\\nu) = \\sqrt{\\frac{2}{\\pi}} \\, \\nu \\, \\exp\\!\\left(-\\frac{\\nu^{2}}{2}\\right)$ and $f_{\\mathrm{ST}}(\\nu) = A \\sqrt{\\frac{2 a}{\\pi}} \\, \\nu \\, \\left[1 + (a \\nu^{2})^{-p}\\right] \\, \\exp\\!\\left(-\\frac{a \\nu^{2}}{2}\\right)$, where $A$ is a normalization constant, and $a > 0$ and $p > 0$ are parameters. Using the peak-background split (PBS) argument and the relation between Eulerian and Lagrangian bias, $b_{1}^{E}(\\nu) = 1 + b_{1}^{L}(\\nu)$, derive the closed-form expressions for the Eulerian linear bias $b_{1}^{E}(\\nu)$ for both PS and ST in terms of $\\nu$, $\\delta_{c}$, $a$, and $p$. Then, discuss the leading-order asymptotic behavior of each $b_{1}^{E}(\\nu)$ for $\\nu \\gg 1$ and for $\\nu \\ll 1$ (you may treat $a$ and $p$ as fixed positive constants). \n\nExpress your final answer as the pair of analytic expressions $\\big(b_{1,\\mathrm{PS}}^{E}(\\nu), \\, b_{1,\\mathrm{ST}}^{E}(\\nu)\\big)$ in a single row matrix. No numerical evaluation or rounding is required, and no units should be reported. Your derivation should start from first principles of the PBS applied to a universal mass function and must justify each step.",
            "solution": "The Lagrangian linear bias, $b_1^L(\\nu)$, is derived from the universal mass function $f(\\nu)$ via the peak-background split argument. The general formula is:\n$$\nb_1^L(\\nu) = -\\frac{d \\ln f(\\nu)}{d \\delta_c} = -\\frac{\\nu}{\\delta_c} \\frac{d \\ln f(\\nu)}{d \\nu}\n$$\nThe Eulerian linear bias, which is the quantity measured in the late-time universe, is related to the Lagrangian bias by $b_1^E(\\nu) = 1 + b_1^L(\\nu)$. We will derive this for both the Press-Schechter (PS) and Sheth-Tormen (ST) models.\n\n**1. Press-Schechter (PS) Bias**\nThe PS multiplicity function is $f_{\\mathrm{PS}}(\\nu) \\propto \\nu \\exp(-\\nu^2/2)$. Its logarithm is $\\ln f_{\\mathrm{PS}}(\\nu) = \\text{const} + \\ln(\\nu) - \\nu^2/2$.\nThe derivative is:\n$$\n\\frac{d \\ln f_{\\mathrm{PS}}(\\nu)}{d \\nu} = \\frac{1}{\\nu} - \\nu\n$$\nThe Lagrangian bias is therefore:\n$$\nb_{1, \\mathrm{PS}}^{L}(\\nu) = -\\frac{\\nu}{\\delta_c} \\left(\\frac{1}{\\nu} - \\nu\\right) = \\frac{\\nu^2 - 1}{\\delta_c}\n$$\nThe Eulerian bias is:\n$$\nb_{1, \\mathrm{PS}}^{E}(\\nu) = 1 + b_{1, \\mathrm{PS}}^{L}(\\nu) = 1 + \\frac{\\nu^2 - 1}{\\delta_c}\n$$\n\n**2. Sheth-Tormen (ST) Bias**\nFrom the previous exercise, the Lagrangian bias for the ST model is:\n$$\nb_{1, \\mathrm{ST}}^{L}(\\nu) = \\frac{1}{\\delta_c} \\left( a\\nu^2 - 1 + \\frac{2p}{1+(a\\nu^2)^p} \\right)\n$$\nThe corresponding Eulerian bias is:\n$$\nb_{1, \\mathrm{ST}}^{E}(\\nu) = 1 + b_{1, \\mathrm{ST}}^{L}(\\nu) = 1 + \\frac{1}{\\delta_c} \\left( a\\nu^2 - 1 + \\frac{2p}{1+(a\\nu^2)^p} \\right)\n$$\n\n**3. Asymptotic Behavior**\n\n*   **High-mass halos ($\\nu \\gg 1$):**\n    *   For PS: $b_{1, \\mathrm{PS}}^{E}(\\nu) \\approx \\frac{\\nu^2}{\\delta_c}$. Bias grows quadratically with peak height.\n    *   For ST: The term $(a\\nu^2)^p \\to \\infty$, so the fraction with $2p$ goes to zero. The bias is $b_{1, \\mathrm{ST}}^{E}(\\nu) \\approx 1 + \\frac{a\\nu^2}{\\delta_c} \\approx \\frac{a\\nu^2}{\\delta_c}$. Bias also grows quadratically, but with a different coefficient ($a \\approx 0.7$). This means highly massive halos are strongly biased, clustering more than the underlying matter.\n\n*   **Low-mass halos ($\\nu \\ll 1$):**\n    *   For PS: $b_{1, \\mathrm{PS}}^{E}(\\nu) \\approx 1 - \\frac{1}{\\delta_c}$. Since $\\delta_c \\approx 1.686$, the bias is less than 1, meaning low-mass halos are anti-biased (less clustered than matter).\n    *   For ST: The term $(a\\nu^2)^p \\to 0$. The bias approaches $b_{1, \\mathrm{ST}}^{E}(\\nu) \\approx 1 + \\frac{-1+2p}{\\delta_c}$. For typical parameters ($p \\approx 0.3$), $2p-1$ is negative, so this also predicts anti-bias for low-mass halos, though the value differs from the PS prediction.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 + \\frac{\\nu^{2} - 1}{\\delta_{c}} & 1 + \\frac{1}{\\delta_{c}}\\left(a\\nu^{2} - 1 + \\frac{2p}{1+(a\\nu^{2})^{p}}\\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}