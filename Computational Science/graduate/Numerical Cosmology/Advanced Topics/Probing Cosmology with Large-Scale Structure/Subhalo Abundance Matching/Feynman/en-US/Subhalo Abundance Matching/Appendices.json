{
    "hands_on_practices": [
        {
            "introduction": "The fundamental principle of Subhalo Abundance Matching (SHAM) is the monotonic link established by equating cumulative number densities. This exercise will test your ability to work with this core principle in a practical scenario. We explore how a systematic uncertainty in an observable, such as galaxy stellar mass, propagates through the SHAM framework to affect inferred halo properties, a crucial step in assessing the robustness of any SHAM-based result .",
            "id": "3492426",
            "problem": "A fundamental starting point of Subhalo Abundance Matching (SHAM) is that a monotonic mapping between galaxy stellar mass and a halo proxy is obtained by equating the cumulative number density of galaxies above a stellar mass threshold to the cumulative number density of (sub)halos above a corresponding halo proxy threshold. Consider a SHAM model at redshift $z \\approx 0$ in which the proxy is the peak pre-infall mass, denoted $M_{\\mathrm{peak}}$. Let $\\log$ denote base-$10$ logarithms. Assume the following local power-law descriptions in a narrow mass range around the current SHAM threshold:\n- The cumulative stellar mass function is locally $n_{\\mathrm{g}}(>M_{\\star}) \\propto M_{\\star}^{-\\beta}$ with $\\beta = 1.6$.\n- The cumulative abundance of distinct host halos is locally $n_{\\mathrm{host}}(>M) \\propto M^{-\\gamma_{\\mathrm{h}}}$ with $\\gamma_{\\mathrm{h}} = 0.9$.\n- The cumulative abundance of subhalos (in the cosmological volume, counted across all hosts) is locally $n_{\\mathrm{sub}}(>M) \\propto M^{-\\gamma_{\\mathrm{s}}}$ with $\\gamma_{\\mathrm{s}} = 1.2$.\n- At the current SHAM threshold, the satellite fraction is $f_{\\mathrm{sat},0} = 0.22$.\n\nAssume that a uniform systematic offset affects all stellar mass estimates such that $\\Delta \\log M_{\\star} = +0.10$ (that is, all stellar masses are overestimated by $0.10$ dex). Under the SHAM requirement of matching cumulative abundances, this induces a shift in the inferred $M_{\\mathrm{peak}}$ threshold. Treat the power-law approximations as valid over the small range of the shift, and work to first order in the shift.\n\nUsing only the principles stated above, and without assuming any further fitting formulas, compute:\n1. The induced shift $\\Delta \\log M_{\\mathrm{peak}}$ required to preserve the abundance matching condition after the systematic stellar mass offset.\n2. The new satellite fraction $f_{\\mathrm{sat}}$ evaluated at the shifted $M_{\\mathrm{peak}}$ threshold.\n\nProvide your final answers as two numbers in the order $\\left(\\Delta \\log M_{\\mathrm{peak}}, f_{\\mathrm{sat}}\\right)$. Round your numerical results to four significant figures. Express $\\Delta \\log M_{\\mathrm{peak}}$ in dex and $f_{\\mathrm{sat}}$ as a dimensionless decimal.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of Subhalo Abundance Matching (SHAM) in cosmology, well-posed with sufficient information for a unique solution, and stated objectively. We can proceed with the solution.\n\nThe core principle of Subhalo Abundance Matching (SHAM) is the equation of cumulative number densities between galaxies and (sub)halos. Let $M_{\\star}$ be the galaxy stellar mass and $M_{\\mathrm{peak}}$ be the halo mass proxy (peak pre-infall mass). The SHAM condition is:\n$$n_{\\text{g}}(>M_{\\star}) = n_{\\text{halo}}(>M_{\\mathrm{peak}})$$\nThe total number density of halos, $n_{\\text{halo}}$, is the sum of the number densities of distinct host halos, $n_{\\text{host}}$, and subhalos, $n_{\\text{sub}}$.\n$$n_{\\text{halo}}(>M_{\\mathrm{peak}}) = n_{\\text{host}}(>M_{\\mathrm{peak}}) + n_{\\text{sub}}(>M_{\\mathrm{peak}})$$\n\nWe are given local power-law descriptions for these cumulative abundances:\n-   Galaxy stellar mass function: $n_{\\text{g}}(>M_{\\star}) = C_{\\text{g}} M_{\\star}^{-\\beta}$, with $\\beta = 1.6$.\n-   Host halo mass function: $n_{\\text{host}}(>M) = C_{\\text{h}} M^{-\\gamma_{\\text{h}}}$, with $\\gamma_{\\text{h}} = 0.9$.\n-   Subhalo mass function: $n_{\\text{sub}}(>M) = C_{\\text{s}} M^{-\\gamma_{\\text{s}}}$, with $\\gamma_{\\text{s}} = 1.2$.\nHere, $C_{\\text{g}}$, $C_{\\text{h}}$, and $C_{\\text{s}}$ are normalization constants.\n\nLet $m_{\\star} = \\log M_{\\star}$ and $m_{\\text{p}} = \\log M_{\\mathrm{peak}}$ denote the base-$10$ logarithms of the masses. The SHAM equation, applied at a specific abundance, establishes a relationship $m_{\\text{p}}(m_{\\star})$. We are given a systematic shift in stellar mass, $\\Delta m_{\\star} = +0.10$, and are asked to find the induced shift in the halo mass threshold, $\\Delta m_{\\text{p}}$, that preserves the abundance matching. We work to first order, which is appropriate for a small shift.\n\nThis implies that the change in $n_{\\text{g}}$ due to $\\Delta m_{\\star}$ must be compensated by the change in $n_{\\text{halo}}$ due to $\\Delta m_{\\text{p}}$, such that the total abundance remains matched. In differential form, $dn_{\\text{g}} = dn_{\\text{halo}}$.\n\nLet's express these differentials.\nFor galaxies:\n$n_{\\text{g}} \\propto (10^{m_{\\star}})^{-\\beta} = 10^{-\\beta m_{\\star}}$.\n$dn_{\\text{g}} = \\frac{dn_{\\text{g}}}{dm_{\\star}} dm_{\\star} = (-\\beta \\ln 10) n_{\\text{g}} dm_{\\star}$.\n\nFor halos:\n$n_{\\text{halo}} = n_{\\text{host}} + n_{\\text{sub}} \\propto 10^{-\\gamma_{\\text{h}} m_{\\text{p}}} + C' 10^{-\\gamma_{\\text{s}} m_{\\text{p}}}$, where $C'$ is a relative normalization.\n$dn_{\\text{halo}} = \\frac{dn_{\\text{halo}}}{dm_{\\text{p}}} dm_{\\text{p}} = \\left( \\frac{dn_{\\text{host}}}{dm_{\\text{p}}} + \\frac{dn_{\\text{sub}}}{dm_{\\text{p}}} \\right) dm_{\\text{p}}$.\n$\\frac{dn_{\\text{host}}}{dm_{\\text{p}}} = (-\\gamma_{\\text{h}} \\ln 10) n_{\\text{host}}$.\n$\\frac{dn_{\\text{sub}}}{dm_{\\text{p}}} = (-\\gamma_{\\text{s}} \\ln 10) n_{\\text{sub}}$.\nSo, $dn_{\\text{halo}} = \\left( (-\\gamma_{\\text{h}} \\ln 10) n_{\\text{host}} + (-\\gamma_{\\text{s}} \\ln 10) n_{\\text{sub}} \\right) dm_{\\text{p}}$.\n\nEquating the differentials $dn_{\\text{g}} = dn_{\\text{halo}}$:\n$(-\\beta \\ln 10) n_{\\text{g}} dm_{\\star} = \\left( (-\\gamma_{\\text{h}} \\ln 10) n_{\\text{host}} + (-\\gamma_{\\text{s}} \\ln 10) n_{\\text{sub}} \\right) dm_{\\text{p}}$.\nAt the matching threshold, $n_{\\text{g}} = n_{\\text{host}} + n_{\\text{sub}}$. Substituting this and canceling $(-\\ln 10)$:\n$\\beta (n_{\\text{host}} + n_{\\text{sub}}) dm_{\\star} = (\\gamma_{\\text{h}} n_{\\text{host}} + \\gamma_{\\text{s}} n_{\\text{sub}}) dm_{\\text{p}}$.\n\nSolving for the ratio of the shifts:\n$\\frac{dm_{\\text{p}}}{dm_{\\star}} = \\frac{\\beta (n_{\\text{host}} + n_{\\text{sub}})}{\\gamma_{\\text{h}} n_{\\text{host}} + \\gamma_{\\text{s}} n_{\\text{sub}}}$.\nTo evaluate the denominator, we use the initial satellite fraction, $f_{\\mathrm{sat},0} = 0.22$. The satellite fraction is the number density of subhalos divided by the total number density of halos:\n$f_{\\mathrm{sat},0} = \\frac{n_{\\text{sub}}}{n_{\\text{host}} + n_{\\text{sub}}}$.\nThis implies $n_{\\text{host}} = (1 - f_{\\mathrm{sat},0})(n_{\\text{host}} + n_{\\text{sub}})$.\nDividing the numerator and denominator of the ratio $\\frac{dm_{\\text{p}}}{dm_{\\star}}$ by $(n_{\\text{host}} + n_{\\text{sub}})$ gives:\n$\\frac{dm_{\\text{p}}}{dm_{\\star}} = \\frac{\\beta}{\\gamma_{\\text{h}} \\frac{n_{\\text{host}}}{n_{\\text{host}} + n_{\\text{sub}}} + \\gamma_{\\text{s}} \\frac{n_{\\text{sub}}}{n_{\\text{host}} + n_{\\text{sub}}}} = \\frac{\\beta}{\\gamma_{\\text{h}}(1-f_{\\mathrm{sat},0}) + \\gamma_{\\text{s}} f_{\\mathrm{sat},0}}$.\n\nNow, we can compute the shift $\\Delta \\log M_{\\mathrm{peak}} = \\Delta m_{\\text{p}}$. For small finite shifts, $\\Delta m_{\\text{p}} \\approx \\frac{dm_{\\text{p}}}{dm_{\\star}} \\Delta m_{\\star}$.\n$\\Delta \\log M_{\\mathrm{peak}} = \\left( \\frac{\\beta}{\\gamma_{\\text{h}}(1-f_{\\mathrm{sat},0}) + \\gamma_{\\text{s}} f_{\\mathrm{sat},0}} \\right) \\Delta \\log M_{\\star}$.\nPlugging in the given values:\n$\\beta = 1.6$, $\\gamma_{\\text{h}} = 0.9$, $\\gamma_{\\text{s}} = 1.2$, $f_{\\mathrm{sat},0} = 0.22$, and $\\Delta \\log M_{\\star} = 0.10$.\nThe denominator is $\\gamma_{\\text{h}}(1-f_{\\mathrm{sat},0}) + \\gamma_{\\text{s}} f_{\\mathrm{sat},0} = 0.9 \\times (1-0.22) + 1.2 \\times 0.22 = 0.9 \\times 0.78 + 0.264 = 0.702 + 0.264 = 0.966$.\n$\\Delta \\log M_{\\mathrm{peak}} = \\frac{1.6}{0.966} \\times 0.10 \\approx 1.6563147 \\times 0.10 \\approx 0.16563$.\nRounding to four significant figures, $\\Delta \\log M_{\\mathrm{peak}} = 0.1656$.\n\nNext, we calculate the new satellite fraction, $f_{\\mathrm{sat}}$, at the shifted mass threshold. The new threshold is $M_{\\mathrm{peak},1} = M_{\\mathrm{peak},0} \\cdot 10^{\\Delta \\log M_{\\mathrm{peak}}}$.\nThe new satellite fraction is $f_{\\mathrm{sat}} = \\frac{n_{\\text{sub}}(>M_{\\mathrm{peak},1})}{n_{\\text{host}}(>M_{\\mathrm{peak},1}) + n_{\\text{sub}}(>M_{\\mathrm{peak},1})}$.\nUsing the power-law forms, we can find the new number densities in terms of the old ones:\n$n_{\\text{host}}(>M_{\\mathrm{peak},1}) = n_{\\text{host}}(>M_{\\mathrm{peak},0}) \\left(\\frac{M_{\\mathrm{peak},1}}{M_{\\mathrm{peak},0}}\\right)^{-\\gamma_{\\text{h}}} = n_{\\text{host},0} \\left(10^{\\Delta \\log M_{\\mathrm{peak}}}\\right)^{-\\gamma_{\\text{h}}} = n_{\\text{host},0} \\cdot 10^{-\\gamma_{\\text{h}}\\Delta \\log M_{\\mathrm{peak}}}$.\n$n_{\\text{sub}}(>M_{\\mathrm{peak},1}) = n_{\\text{sub}}(>M_{\\mathrm{peak},0}) \\left(\\frac{M_{\\mathrm{peak},1}}{M_{\\mathrm{peak},0}}\\right)^{-\\gamma_{\\text{s}}} = n_{\\text{sub},0} \\left(10^{\\Delta \\log M_{\\mathrm{peak}}}\\right)^{-\\gamma_{\\text{s}}} = n_{\\text{sub},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\mathrm{peak}}}$.\n\nThe new satellite fraction is:\n$f_{\\mathrm{sat}} = \\frac{n_{\\text{sub},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\mathrm{peak}}}}{n_{\\text{host},0} \\cdot 10^{-\\gamma_{\\text{h}}\\Delta \\log M_{\\mathrm{peak}}} + n_{\\text{sub},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\mathrm{peak}}}}$.\nWe can express $n_{\\text{host},0}$ and $n_{\\text{sub},0}$ in terms of $f_{\\mathrm{sat},0}$ and the total initial abundance $n_{\\text{tot},0}$:\n$n_{\\text{sub},0} = f_{\\mathrm{sat},0} n_{\\text{tot},0}$ and $n_{\\text{host},0} = (1-f_{\\mathrm{sat},0}) n_{\\text{tot},0}$.\nSubstituting and canceling $n_{\\text{tot},0}$:\n$f_{\\mathrm{sat}} = \\frac{f_{\\mathrm{sat},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\mathrm{peak}}}}{(1-f_{\\mathrm{sat},0}) \\cdot 10^{-\\gamma_{\\text{h}}\\Delta \\log M_{\\mathrm{peak}}} + f_{\\mathrm{sat},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\mathrm{peak}}}}$.\nTo simplify, divide the numerator and denominator by $10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\mathrm{peak}}}$:\n$f_{\\mathrm{sat}} = \\frac{f_{\\mathrm{sat},0}}{(1-f_{\\mathrm{sat},0}) \\cdot 10^{(\\gamma_{\\text{s}}-\\gamma_{\\text{h}})\\Delta \\log M_{\\mathrm{peak}}} + f_{\\mathrm{sat},0}}$.\n\nNow, we plug in the values:\n$f_{\\mathrm{sat},0} = 0.22$, $\\gamma_{\\text{s}} - \\gamma_{\\text{h}} = 1.2 - 0.9 = 0.3$, and $\\Delta \\log M_{\\mathrm{peak}} \\approx 0.16563147$.\nThe exponent is $(\\gamma_{\\text{s}}-\\gamma_{\\text{h}})\\Delta \\log M_{\\mathrm{peak}} = 0.3 \\times 0.16563147 \\approx 0.0496894$.\nThe exponential term is $10^{0.0496894} \\approx 1.12128$.\nThe denominator is $(1-0.22) \\times 1.12128 + 0.22 = 0.78 \\times 1.12128 + 0.22 \\approx 0.874598 + 0.22 = 1.094598$.\n$f_{\\mathrm{sat}} = \\frac{0.22}{1.094598} \\approx 0.20100488$.\nRounding to four significant figures, the new satellite fraction is $f_{\\mathrm{sat}} = 0.2010$.\n\nThe final results are $\\Delta \\log M_{\\mathrm{peak}} \\approx 0.1656$ and $f_{\\mathrm{sat}} \\approx 0.2010$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1656 & 0.2010\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Subhalo Abundance Matching does not operate in a vacuum; it relies on halo catalogs generated from cosmological simulations. This hands-on practice delves into a subtle but critical systematic effect: how the choice of a halo-finder parameter, specifically the Friends-of-Friends linking length, alters the halo population and thus the SHAM mapping. By deriving a renormalization factor, you will learn how to diagnose and correct for such systematics to ensure your scientific conclusions are robust against algorithmic artifacts .",
            "id": "3492474",
            "problem": "A cosmological $N$-body simulation is post-processed with the Friends-of-Friends (FoF) halo finder. In FoF, the dimensionless linking length $b$ (in units of the mean interparticle separation) controls percolation of structures: increasing $b$ tends to merge nearby overdensities into larger hosts, while decreasing $b$ tends to fragment them. In Subhalo Abundance Matching (SHAM), one assigns galaxy stellar masses $M_{\\star}$ to halos or subhalos by equating cumulative number densities: the cumulative galaxy stellar mass function $n_{\\mathrm{gal}}(>M_{\\star})$ is matched to a cumulative halo property function $n_{\\mathrm{halo}}(>X)$, where $X$ is a monotonic halo property (for example, peak circular velocity or peak mass).\n\nConsider a reference catalog built with FoF linking length $b_{0}$, producing a host cumulative distribution $n_{b_{0}}(>X)$ for the property $X$. Let $X_{0}$ be the value of $X$ at which $n_{\\mathrm{gal}}(>M_{\\star,0}) = n_{b_{0}}(>X_{0})$ for some fiducial stellar mass $M_{\\star,0}$. Now reprocess the same simulation with a different linking length $b$, generating a new catalog. Empirically, two robust effects of changing $b$ near $X_{0}$ are observed:\n\n- A percolation-induced reduction in the number of distinct hosts above any local threshold, quantified by a fraction $f_{p}(b)$ of hosts that are merged away at $b$ relative to $b_{0}$ in the neighborhood of $X_{0}$.\n- A multiplicative rescaling of the measured host property in that neighborhood, $X \\mapsto X_{b} = q(b)\\,X$, with $q(b) > 0$.\n\nAssume that in the vicinity of $X_{0}$ the function $n_{b_{0}}(>X)$ is differentiable and monotonic, and that its local logarithmic slope\n$$\n\\gamma(X_{0}) \\equiv -\\left.\\frac{d\\ln n_{b_{0}}(>X)}{d\\ln X}\\right|_{X_{0}}\n$$\nis approximately constant over the small interval of interest. Also assume that $f_{p}(b)$ and $q(b)$ are approximately constant across this interval.\n\nDerive a multiplicative renormalization factor $r(b)$ for the $X$-axis such that replacing $X$ by $X' = r(b)\\,X$ in the $b$-catalog restores, to leading order around $X_{0}$, the equality\n$$\nn_{b}(>X') = n_{b_{0}}(>X)\n$$\nand hence preserves $n_{\\mathrm{gal}}(>M_{\\star})$ under SHAM across different choices of $b$. Express your final answer as a single closed-form analytical expression for $r(b)$ in terms of $q(b)$, $f_{p}(b)$, and $\\gamma(X_{0})$. No numerical evaluation is required, and no units should be included in your final expression.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of numerical cosmology, halo-finding algorithms (Friends-of-Friends), and the subhalo abundance matching (SHAM) technique. The problem is well-posed, with all necessary quantities, assumptions, and relationships defined to allow for a unique, meaningful solution. The language is objective and precise, and the setup is self-contained and consistent. No flaws meeting the invalidity criteria are found. Therefore, a solution will be derived.\n\nOur goal is to find a multiplicative renormalization factor $r(b)$ such that a rescaled halo property $X' = r(b)X$ preserves the abundance matching relation across different choices of the Friends-of-Friends (FoF) linking length, $b$. Specifically, we require that the cumulative number density of halos in the new catalog (generated with linking length $b$), evaluated at $X'$, is equal to the cumulative number density from the reference catalog (generated with linking length $b_0$) evaluated at the original property value $X$. This condition is expressed as:\n$$\nn_{b}(>X') = n_{b_{0}}(>X)\n$$\nTo proceed, we must first establish a relationship between the new cumulative function $n_{b}(>X)$ and the reference one $n_{b_{0}}(>X)$. The problem states two effects of changing the linking length from $b_0$ to $b$:\n\n1.  A fraction $f_{p}(b)$ of hosts are merged and thus removed from the distinct host catalog. This reduces the number counts by a factor of $(1 - f_{p}(b))$.\n2.  The measured property $X$ for the remaining hosts is rescaled to a new value $X_b = q(b)X$.\n\nLet us determine the cumulative number density $n_b(>\\tilde{X})$ for an arbitrary threshold $\\tilde{X}$ in the new catalog. A halo is counted in $n_b(>\\tilde{X})$ if its rescaled property $X_b$ is greater than $\\tilde{X}$. Using the rescaling relation, this condition becomes $q(b)X > \\tilde{X}$, which is equivalent to $X > \\tilde{X}/q(b)$. This means that the halos contributing to $n_b(>\\tilde{X})$ are precisely those that had an original property $X$ greater than $\\tilde{X}/q(b)$ in the reference $b_0$ catalog.\n\nThe number density of such halos in the reference catalog is $n_{b_{0}}(> \\tilde{X}/q(b))$. Taking into account the percolation-induced loss of hosts, the number density in the new catalog is reduced by the fraction $f_p(b)$. Therefore, the relationship between the two cumulative functions is:\n$$\nn_b(>\\tilde{X}) = (1 - f_p(b)) n_{b_{0}}\\left(> \\frac{\\tilde{X}}{q(b)}\\right)\n$$\nNow, we apply the required condition for our renormalized property $X' = r(b)X$. We set $\\tilde{X} = X'$ in the equation above and equate it to $n_{b_{0}}(>X)$:\n$$\n(1 - f_p(b)) n_{b_{0}}\\left(> \\frac{X'}{q(b)}\\right) = n_{b_{0}}(>X)\n$$\nThe problem specifies that the local logarithmic slope of the reference cumulative function, $\\gamma(X_{0}) \\equiv -\\frac{d\\ln n_{b_{0}}(>X)}{d\\ln X}$ at $X_0$, is approximately constant over the interval of interest. This implies that $n_{b_{0}}(>X)$ can be approximated by a power law in this region:\n$$\nn_{b_{0}}(>X) \\propto X^{-\\gamma(X_{0})}\n$$\nLet's denote $\\gamma \\equiv \\gamma(X_0)$ for notational brevity during the derivation. The proportionality constant is irrelevant as it will cancel out. Substituting this power-law form into our equation:\n$$\n(1 - f_p(b)) \\left( \\frac{X'}{q(b)} \\right)^{-\\gamma} = (X)^{-\\gamma}\n$$\nNow, we substitute $X' = r(b)X$ into this expression:\n$$\n(1 - f_p(b)) \\left( \\frac{r(b)X}{q(b)} \\right)^{-\\gamma} = X^{-\\gamma}\n$$\nWe can separate the terms:\n$$\n(1 - f_p(b)) (r(b))^{-\\gamma} (q(b))^{\\gamma} X^{-\\gamma} = X^{-\\gamma}\n$$\nAssuming $X > 0$, we can cancel the $X^{-\\gamma}$ term from both sides:\n$$\n(1 - f_p(b)) (r(b))^{-\\gamma} (q(b))^{\\gamma} = 1\n$$\nOur goal is to solve for $r(b)$. We first isolate the term containing $r(b)$:\n$$\n(r(b))^{-\\gamma} = \\frac{1}{(1 - f_p(b)) (q(b))^{\\gamma}} = (1 - f_p(b))^{-1} (q(b))^{-\\gamma}\n$$\nTo solve for $r(b)$, we raise both sides of the equation to the power of $-1/\\gamma$:\n$$\nr(b) = \\left[ (1 - f_p(b))^{-1} (q(b))^{-\\gamma} \\right]^{-\\frac{1}{\\gamma}}\n$$\nApplying the exponent to each factor inside the brackets:\n$$\nr(b) = \\left((1 - f_p(b))^{-1}\\right)^{-\\frac{1}{\\gamma}} \\left((q(b))^{-\\gamma}\\right)^{-\\frac{1}{\\gamma}}\n$$\n$$\nr(b) = (1 - f_p(b))^{\\frac{1}{\\gamma}} (q(b))^{1}\n$$\nSubstituting back the full definition $\\gamma = \\gamma(X_0)$, we obtain the final expression for the renormalization factor:\n$$\nr(b) = q(b) \\left(1 - f_p(b)\\right)^{\\frac{1}{\\gamma(X_0)}}\n$$\nThis factor $r(b)$, when applied multiplicatively to the halo property $X$ from a catalog generated with FoF linking length $b$, corrects for both the change in property values and the change in halo number counts, thereby ensuring that the SHAM-inferred galaxy properties remain consistent.",
            "answer": "$$\n\\boxed{q(b) \\left(1 - f_p(b)\\right)^{\\frac{1}{\\gamma(X_0)}}}\n$$"
        },
        {
            "introduction": "The standard SHAM prescription assumes a monotonic relationship between a galaxy property and a single halo proxy, but which proxy is the most physically predictive? This practice challenges you to design a numerical experiment to answer that question, a common task in model validation. You will lay out a robust statistical procedure to determine whether a halo's peak mass ($M_{\\rm peak}$) or peak circular velocity ($V_{\\rm peak}$) serves as a better tracer of stellar mass by analyzing which proxy minimizes the scatter in the relationship, using synthetic data that mimics hydrodynamical simulations .",
            "id": "3492417",
            "problem": "You are asked to implement a complete, deterministic program that validates, using synthetic yet scientifically plausible hydrodynamical simulation outputs, whether the subhalo property $M_{\\rm peak}$ or $V_{\\rm peak}$ is the better Subhalo Abundance Matching (SHAM) proxy for estimating galaxy stellar mass $M_\\star$ by comparing the conditional scatter in $\\log_{10}(M_\\star)$ at fixed proxy $X$. The scientific foundation to use includes the following core elements: the definition of conditional variance, the use of logarithms for multiplicative astrophysical relations, the empirical monotonicity of galaxy stellar mass $M_\\star$ with respect to halo properties, and the virial scaling relation $V \\propto M^{1/3}$ motivated by gravitational equilibrium for halos in a cold dark matter cosmology.\n\nYour program must use the following principle-based design. First, treat the galaxy stellar mass $M_\\star$ as a stochastic function of one or both halo proxies $X \\in \\{M_{\\rm peak},V_{\\rm peak}\\}$, with lognormal intrinsic scatter. Second, estimate the conditional scatter $\\sigma_{Y|X}$ where $Y \\equiv \\log_{10}\\left(M_\\star / M_\\odot\\right)$ using binned statistics in $\\log_{10}X$. Third, decide whether $M_{\\rm peak}$ or $V_{\\rm peak}$ is the better SHAM proxy by comparing the weighted average of binwise scatters in $Y$ at fixed $X$. All quantities with physical units must be explicitly handled in their specified units: $M_{\\rm peak}$ and $M_\\star$ in solar masses $M_\\odot$, and $V_{\\rm peak}$ in $\\mathrm{km\\,s^{-1}}$. Computations of scatter must be performed in $\\log_{10}$ space, which is dimensionless.\n\nYou must start from the following fundamental definitions and widely accepted relations without shortcut formulas. The conditional variance of a random variable $Y$ given $X$ is defined by\n$$\n\\sigma_{Y|X}^2 \\equiv \\mathbb{E}\\!\\left[\\left(Y - \\mathbb{E}[Y|X]\\right)^2 \\,\\big|\\, X\\right].\n$$\nFor a finite sample, an unbiased estimator of variance in a bin of fixed $X$ with $n$ samples uses the sample variance with degrees of freedom $n-1$. In $\\Lambda$ Cold Dark Matter cosmology where halos are approximately virialized, the peak circular velocity $V_{\\rm peak}$ scales with halo mass $M$ roughly as $V \\propto M^{1/3}$; in logarithmic units this reads\n$$\n\\log_{10}\\left(\\frac{V}{V_0}\\right) \\approx \\frac{1}{3}\\,\\log_{10}\\left(\\frac{M}{M_0}\\right),\n$$\nwith $V_0$ and $M_0$ serving as normalization constants for convenience. Empirical hydrodynamical simulation outputs and observations support that $M_\\star$ increases monotonically with either $M_{\\rm peak}$ or $V_{\\rm peak}$ with an approximately log-linear relation and a lognormal scatter.\n\nImplementation requirements. Your program must:\n1. Generate synthetic, reproducible samples of $M_{\\rm peak}$ distributed according to a truncated power-law $p(M) \\propto M^{-\\alpha}$ for $M \\in [M_{\\min}, M_{\\max}]$, with exponents and bounds specified per test case. Use inverse transform sampling to ensure scientific realism.\n2. Generate $V_{\\rm peak}$ via the virial scaling relation in logarithmic units with an added Gaussian scatter in $\\log_{10}V$ of width $\\sigma_V$ (dex), i.e.,\n$$\n\\log_{10}\\left(V_{\\rm peak}\\right) = \\log_{10}(V_0) + \\frac{1}{3}\\left[\\log_{10}(M_{\\rm peak}) - \\log_{10}(M_0)\\right] + \\delta_V,\\quad \\delta_V \\sim \\mathcal{N}(0,\\sigma_V^2).\n$$\n3. Generate galaxy stellar mass $M_\\star$ through a physically motivated log-linear relation in logarithms with intrinsic Gaussian scatter in dex. Consider the general mixture model for hydrodynamical realism:\n$$\nY \\equiv \\log_{10}\\left(\\frac{M_\\star}{M_\\odot}\\right) = a + b_M \\log_{10}\\left(\\frac{M_{\\rm peak}}{M_0}\\right) + b_V \\log_{10}\\left(\\frac{V_{\\rm peak}}{V_0}\\right) + \\delta_Y,\\quad \\delta_Y \\sim \\mathcal{N}(0,\\sigma_Y^2).\n$$\nSpecial cases include $b_V = 0$ (pure $M_{\\rm peak}$ dependence) and $b_M = 0$ (pure $V_{\\rm peak}$ dependence).\n4. Estimate the conditional scatter $\\sigma_{Y|X}$ by binning $X$ in $\\log_{10}X$ with fixed bin width and computing the unbiased sample standard deviation of $Y$ in each bin that passes a minimum occupancy threshold. Use a weighted average of binwise standard deviations with weights equal to the bin counts to approximate the expected conditional scatter across the $X$ distribution:\n$$\n\\widehat{\\sigma}_{Y|X}^{\\rm weighted} = \\frac{\\sum_{j} n_j s_j}{\\sum_{j} n_j},\n$$\nwhere $n_j$ is the number of objects in bin $j$, and $s_j$ is the sample standard deviation of $Y$ in bin $j$. Exclude any bin with $n_j < n_{\\min}$ to ensure statistical robustness.\n5. Decide which proxy is better by comparing the weighted conditional scatters. Define a tie tolerance $\\tau$ (dex). If $\\left|\\widehat{\\sigma}_{Y|M_{\\rm peak}} - \\widehat{\\sigma}_{Y|V_{\\rm peak}}\\right| \\le \\tau$, output $-1$; otherwise output $1$ if $M_{\\rm peak}$ yields smaller scatter, and $0$ if $V_{\\rm peak}$ yields smaller scatter.\n\nBinning and thresholds. Use fixed bin widths in logarithmic units: for $X = M_{\\rm peak}$, use width $\\Delta_M = 0.25$ dex; for $X = V_{\\rm peak}$, use width $\\Delta_V = 0.10$ dex. Use a minimum occupancy threshold $n_{\\min} = 15$ objects per bin. Use a tie tolerance $\\tau = 0.03$ dex.\n\nTest suite. Your program must evaluate the following $4$ scientifically plausible test cases, each parameterizing a distinct hydrodynamical regime:\n1. Case A (happy path, $V_{\\rm peak}$ is truth-dominant):\n   - $N = 30000$, $\\alpha = 1.9$, $M_{\\min} = 10^{10}\\,M_\\odot$, $M_{\\max} = 3\\times 10^{13}\\,M_\\odot$.\n   - $M_0 = 10^{12}\\,M_\\odot$, $V_0 = 200\\,\\mathrm{km\\,s^{-1}}$, $\\sigma_V = 0.05$ dex.\n   - $a = 10$, $b_M = 0$, $b_V = 3$, $\\sigma_Y = 0.15$ dex.\n2. Case B (happy path, $M_{\\rm peak}$ is truth-dominant):\n   - $N = 30000$, $\\alpha = 1.9$, $M_{\\min} = 10^{10}\\,M_\\odot$, $M_{\\max} = 3\\times 10^{13}\\,M_\\odot$.\n   - $M_0 = 10^{12}\\,M_\\odot$, $V_0 = 200\\,\\mathrm{km\\,s^{-1}}$, $\\sigma_V = 0.07$ dex.\n   - $a = 10.5$, $b_M = 0.5$, $b_V = 0$, $\\sigma_Y = 0.10$ dex.\n3. Case C (balanced mixture, near tie):\n   - $N = 15000$, $\\alpha = 1.9$, $M_{\\min} = 10^{10}\\,M_\\odot$, $M_{\\max} = 3\\times 10^{13}\\,M_\\odot$.\n   - $M_0 = 10^{12}\\,M_\\odot$, $V_0 = 200\\,\\mathrm{km\\,s^{-1}}$, $\\sigma_V = 0.08$ dex.\n   - $a = 10.2$, $b_M = 0.5$, $b_V = 1.5$, $\\sigma_Y = 0.12$ dex.\n4. Case D (edge case, fewer samples and larger velocity scatter):\n   - $N = 2000$, $\\alpha = 1.9$, $M_{\\min} = 10^{10}\\,M_\\odot$, $M_{\\max} = 3\\times 10^{13}\\,M_\\odot$.\n   - $M_0 = 10^{12}\\,M_\\odot$, $V_0 = 200\\,\\mathrm{km\\,s^{-1}}$, $\\sigma_V = 0.12$ dex.\n   - $a = 10.0$, $b_M = 0$, $b_V = 2.0$, $\\sigma_Y = 0.18$ dex.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain $4$ integers corresponding to the above test cases, in order. For each case, output $1$ if $M_{\\rm peak}$ is better, $0$ if $V_{\\rm peak}$ is better, and $-1$ if the difference in weighted scatter is within the tie tolerance $\\tau$. For example, an output could be of the form $\\left[0,1,-1,0\\right]$. No other text must be printed. Angles are not used. Physical units have already been specified and the final outputs are dimensionless integers.",
            "solution": "The problem requires an implementation to determine whether a subhalo's peak mass, $M_{\\rm peak}$, or its peak circular velocity, $V_{\\rm peak}$, serves as a better proxy for galaxy stellar mass, $M_\\star$. The criterion for \"better\" is a smaller conditional scatter in the logarithm of stellar mass, $Y \\equiv \\log_{10}(M_\\star/M_\\odot)$, at a fixed value of the proxy, $X$. The solution is a deterministic computational analysis of synthetic data, following established principles of Subhalo Abundance Matching (SHAM) validation. The process is broken down into three main stages: synthetic catalog generation, statistical analysis to estimate conditional scatter, and a final decision based on the comparison of these scatters.\n\n**1. Synthetic Data Generation**\n\nA mock catalog of subhalos and their associated galaxies is generated based on a physically motivated model. To ensure the deterministic nature of the program as required, a fixed seed is used for the pseudo-random number generator. Each subhalo is characterized by $M_{\\rm peak}$ and $V_{\\rm peak}$, and each galaxy by $M_\\star$.\n\n**1.1. Generating Subhalo Peak Mass ($M_{\\rm peak}$)**\nThe masses of subhalos are sampled from a truncated power-law distribution, where the probability density function is $p(M) \\propto M^{-\\alpha}$ over the interval $[M_{\\min}, M_{\\max}]$. We generate $N$ samples using the inverse transform sampling method. The cumulative distribution function (CDF) for a variate $M$ is:\n$$F(M) = \\frac{\\int_{M_{\\min}}^M m^{-\\alpha} \\,dm}{\\int_{M_{\\min}}^{M_{\\max}} m^{-\\alpha} \\,dm} = \\frac{M^{1-\\alpha} - M_{\\min}^{1-\\alpha}}{M_{\\max}^{1-\\alpha} - M_{\\min}^{1-\\alpha}}$$\nwhere the problem specifies $\\alpha = 1.9$, so $\\alpha \\neq 1$. By setting $F(M) = u$, where $u$ is a random variable drawn from a uniform distribution $U(0,1)$, and solving for $M$, we obtain the sampling formula:\n$$M_{\\rm peak} = \\left[ M_{\\min}^{1-\\alpha} + u \\left( M_{\\max}^{1-\\alpha} - M_{\\min}^{1-\\alpha} \\right) \\right]^{\\frac{1}{1-\\alpha}}$$\nFor each test case, we generate $N$ values of $M_{\\rm peak}$ in units of solar masses, $M_\\odot$, using the specified parameters $\\alpha$, $N$, $M_{\\min}$, and $M_{\\max}$.\n\n**1.2. Generating Subhalo Peak Velocity ($V_{\\rm peak}$)**\nThe peak velocity, $V_{\\rm peak}$, of a subhalo is assumed to correlate with its mass through the virial scaling relation, which is approximately $V \\propto M^{1/3}$ for gravitationally bound systems in equilibrium. The model incorporates scatter, as observed in cosmological simulations. The value of $V_{\\rm peak}$ for each subhalo is generated using the provided log-linear relation:\n$$\n\\log_{10}\\left(\\frac{V_{\\rm peak}}{\\mathrm{km\\,s^{-1}}}\\right) = \\log_{10}(V_0) + \\frac{1}{3}\\left[\\log_{10}\\left(\\frac{M_{\\rm peak}}{M_\\odot}\\right) - \\log_{10}(M_0)\\right] + \\delta_V\n$$\nHere, $M_{\\rm peak}$ are the values from the previous step. The constants $M_0$ and $V_0$ serve as normalizations. The term $\\delta_V$ represents the scatter in the $M-V$ relation, modeled as a random variate drawn from a Gaussian distribution with mean $0$ and standard deviation $\\sigma_V$, i.e., $\\delta_V \\sim \\mathcal{N}(0, \\sigma_V^2)$.\n\n**1.3. Generating Galaxy Stellar Mass ($M_\\star$)**\nThe stellar mass, $M_\\star$, of the galaxy residing in a subhalo is modeled as a function of both $M_{\\rm peak}$ and $V_{\\rm peak}$ to allow for complex dependencies. The relationship is expressed in logarithmic space, reflecting the multiplicative nature of many astrophysical scalings, and includes intrinsic scatter:\n$$\nY \\equiv \\log_{10}\\left(\\frac{M_\\star}{M_\\odot}\\right) = a + b_M \\log_{10}\\left(\\frac{M_{\\rm peak}}{M_0}\\right) + b_V \\log_{10}\\left(\\frac{V_{\\rm peak}}{V_0}\\right) + \\delta_Y\n$$\nThe parameters $a$, $b_M$, and $b_V$ define the mean underlying relation. The term $\\delta_Y \\sim \\mathcal{N}(0, \\sigma_Y^2)$ represents the intrinsic scatter in stellar mass at fixed halo properties, stemming from the stochasticity of galaxy formation processes. The test cases explore scenarios where $M_\\star$ depends purely on one proxy ($b_M=0$ or $b_V=0$) or on a mixture of both.\n\n**2. Estimation of Conditional Scatter**\n\nAfter generating the synthetic catalog of ($M_{\\rm peak}$, $V_{\\rm peak}$, $M_\\star$) for $N$ objects, we estimate the conditional scatter $\\sigma_{Y|X}$ for each proxy $X \\in \\{M_{\\rm peak}, V_{\\rm peak}\\}$ using a binned statistical approach.\n\n**2.1. Binning Procedure**\nFor each proxy $X$, we work in logarithmic units, $\\log_{10}(X)$. This space is partitioned into a set of bins of a fixed width specified by the problem: $\\Delta_M = 0.25$ dex for $M_{\\rm peak}$ and $\\Delta_V = 0.10$ dex for $V_{\\rm peak}$. The bins are defined to cover the full dynamic range of the generated data for each proxy.\n\n**2.2. Binwise Scatter Calculation**\nThe subhalo population is sorted into these bins. For each bin $j$, we count the number of objects, $n_j$. To ensure statistical robustness, any bin with fewer than $n_{\\min}=15$ objects is discarded. For all valid bins, we calculate the unbiased sample standard deviation, $s_j$, of the corresponding stellar mass logarithms, $Y = \\log_{10}(M_\\star/M_\\odot)$:\n$$\ns_j = \\sqrt{\\frac{1}{n_j - 1} \\sum_{i=1}^{n_j} (y_i - \\bar{y}_j)^2}\n$$\nwhere $\\{y_i\\}$ are the $Y$ values of the objects in bin $j$ and $\\bar{y}_j$ is their arithmetic mean.\n\n**2.3. Weighted Average Scatter**\nA single, representative value for the conditional scatter across the full population is obtained by computing the weighted average of the binwise standard deviations, $s_j$. Each bin's contribution is weighted by the number of objects it contains, $n_j$:\n$$\n\\widehat{\\sigma}_{Y|X}^{\\rm weighted} = \\frac{\\sum_{j} n_j s_j}{\\sum_{j} n_j}\n$$\nThe sum is performed over all valid bins (i.e., where $n_j \\ge n_{\\min}$). This calculation yields two key quantities: $\\widehat{\\sigma}_{Y|M_{\\rm peak}}^{\\rm weighted}$ and $\\widehat{\\sigma}_{Y|V_{\\rm peak}}^{\\rm weighted}$.\n\n**3. Decision Logic**\n\nThe final step is to compare the two estimated scatters and determine which proxy is superior, accounting for potential statistical fluctuations in the estimates.\n\n**3.1. Comparison and Application of Tolerance**\nWe compute the difference between the estimated scatters, $\\Delta\\sigma = \\widehat{\\sigma}_{Y|M_{\\rm peak}}^{\\rm weighted} - \\widehat{\\sigma}_{Y|V_{\\rm peak}}^{\\rm weighted}$. This difference is then compared against a specified tie tolerance, $\\tau = 0.03$ dex.\n\n**3.2. Final Decision**\nThe decision is made according to the following rules:\n- If $|\\Delta\\sigma| \\le \\tau$, the performance of the two proxies is considered statistically indistinguishable. The result for the test case is $-1$.\n- If $\\Delta\\sigma < -\\tau$, it implies $\\widehat{\\sigma}_{Y|M_{\\rm peak}}^{\\rm weighted} < \\widehat{\\sigma}_{Y|V_{\\rm peak}}^{\\rm weighted}$ by a significant margin. $M_{\\rm peak}$ is deemed the better proxy, and the result is $1$.\n- If $\\Delta\\sigma > \\tau$, it implies $\\widehat{\\sigma}_{Y|V_{\\rm peak}}^{\\rm weighted} < \\widehat{\\sigma}_{Y|M_{\\rm peak}}^{\\rm weighted}$ by a significant margin. $V_{\\rm peak}$ is deemed the better proxy, and the result is $0$.\n\nThis complete analysis pipeline is executed for each of the four provided test cases, and the sequence of integer results constitutes the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_weighted_scatter(proxy_values, log_m_star, bin_width, min_count):\n    \"\"\"\n    Estimates the conditional scatter of log_m_star given a proxy variable.\n\n    Args:\n        proxy_values (np.ndarray): Array of proxy values (M_peak or V_peak).\n        log_m_star (np.ndarray): Array of log10(M_star) values.\n        bin_width (float): The width of bins in log10 space.\n        min_count (int): The minimum number of objects required in a bin.\n\n    Returns:\n        float: The weighted average of binwise standard deviations.\n    \"\"\"\n    log_proxy = np.log10(proxy_values)\n    \n    # Define bins to cover the entire range of the proxy\n    min_log_proxy = log_proxy.min()\n    max_log_proxy = log_proxy.max()\n    \n    # Align bins to multiples of bin_width for consistency\n    bin_start = np.floor(min_log_proxy / bin_width) * bin_width\n    bin_end = np.ceil(max_log_proxy / bin_width) * bin_width\n    \n    # np.arange can have floating point issues with the endpoint, so handle carefully\n    bins = np.arange(bin_start, bin_end + bin_width / 2.0, bin_width)\n\n    # `digitize` finds the index of the bin for each value\n    bin_indices = np.digitize(log_proxy, bins)\n    \n    total_weighted_scatter = 0.0\n    total_weight = 0\n\n    # Iterate through each bin (indices from 1 to len(bins))\n    for i in range(1, len(bins) + 1):\n        mask = (bin_indices == i)\n        n_j = np.sum(mask)\n        \n        if n_j >= min_count:\n            log_m_star_in_bin = log_m_star[mask]\n            \n            # Use ddof=1 for unbiased sample standard deviation\n            s_j = np.std(log_m_star_in_bin, ddof=1)\n            \n            total_weighted_scatter += n_j * s_j\n            total_weight += n_j\n            \n    if total_weight == 0:\n        # This case should not be reached with the given test parameters\n        return np.inf\n        \n    return total_weighted_scatter / total_weight\n\ndef run_case(params):\n    \"\"\"\n    Runs a single test case for comparing SHAM proxies.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the test case.\n\n    Returns:\n        int: -1 for a tie, 0 if V_peak is better, 1 if M_peak is better.\n    \"\"\"\n    N = params['N']\n    alpha = params['alpha']\n    m_min = params['M_min']\n    m_max = params['M_max']\n    \n    m0 = params['M_0']\n    v0 = params['V_0']\n    sigma_v = params['sigma_V']\n    \n    a = params['a']\n    b_m = params['b_M']\n    b_v = params['b_V']\n    sigma_y = params['sigma_Y']\n\n    # 1. Generate M_peak from a truncated power-law distribution\n    u = np.random.uniform(0, 1, N)\n    m_min_pow = m_min**(1 - alpha)\n    m_max_pow = m_max**(1 - alpha)\n    m_peak = (m_min_pow + u * (m_max_pow - m_min_pow))**(1 / (1 - alpha))\n\n    log10_m_peak = np.log10(m_peak)\n    log10_m_peak_norm = log10_m_peak - np.log10(m0)\n\n    # 2. Generate V_peak from the virial scaling relation\n    delta_v = np.random.normal(0, sigma_v, N)\n    log10_v_peak = np.log10(v0) + (1/3) * log10_m_peak_norm + delta_v\n    v_peak = 10**log10_v_peak\n    \n    log10_v_peak_norm = log10_v_peak - np.log10(v0)\n\n    # 3. Generate M_star from the mixture model\n    delta_y = np.random.normal(0, sigma_y, N)\n    log_m_star = a + b_m * log10_m_peak_norm + b_v * log10_v_peak_norm + delta_y\n    \n    # 4. Estimate conditional scatters\n    \n    # Binning parameters\n    delta_m = 0.25  # dex for M_peak\n    delta_v = 0.10  # dex for V_peak\n    n_min = 15      # minimum objects per bin\n    tau = 0.03      # tie tolerance in dex\n\n    scatter_m_peak = calculate_weighted_scatter(m_peak, log_m_star, delta_m, n_min)\n    scatter_v_peak = calculate_weighted_scatter(v_peak, log_m_star, delta_v, n_min)\n\n    # 5. Decide which proxy is better\n    diff_scatter = scatter_m_peak - scatter_v_peak\n    \n    if np.abs(diff_scatter) = tau:\n        return -1  # Tie\n    elif diff_scatter  0:\n        return 1   # M_peak is better\n    else:\n        return 0   # V_peak is better\n\ndef solve():\n    # Set a single seed for the entire program to ensure deterministic output\n    np.random.seed(42)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: V_peak dominant\n        {\n            'N': 30000, 'alpha': 1.9, 'M_min': 1e10, 'M_max': 3e13,\n            'M_0': 1e12, 'V_0': 200, 'sigma_V': 0.05,\n            'a': 10, 'b_M': 0, 'b_V': 3, 'sigma_Y': 0.15\n        },\n        # Case B: M_peak dominant\n        {\n            'N': 30000, 'alpha': 1.9, 'M_min': 1e10, 'M_max': 3e13,\n            'M_0': 1e12, 'V_0': 200, 'sigma_V': 0.07,\n            'a': 10.5, 'b_M': 0.5, 'b_V': 0, 'sigma_Y': 0.10\n        },\n        # Case C: Balanced mixture, near tie\n        {\n            'N': 15000, 'alpha': 1.9, 'M_min': 1e10, 'M_max': 3e13,\n            'M_0': 1e12, 'V_0': 200, 'sigma_V': 0.08,\n            'a': 10.2, 'b_M': 0.5, 'b_V': 1.5, 'sigma_Y': 0.12\n        },\n        # Case D: Edge case, fewer samples, V_peak dominant\n        {\n            'N': 2000, 'alpha': 1.9, 'M_min': 1e10, 'M_max': 3e13,\n            'M_0': 1e12, 'V_0': 200, 'sigma_V': 0.12,\n            'a': 10.0, 'b_M': 0, 'b_V': 2.0, 'sigma_Y': 0.18\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = run_case(case_params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}