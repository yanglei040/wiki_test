{
    "hands_on_practices": [
        {
            "introduction": "质量图构建的基石是从可观测的引力剪切（$\\gamma$）场重构收敛（$\\kappa$）场。Kaiser-Squires 关系式是在傅里叶空间中完成这一反演的核心工具。本练习  提供了一个直接的解析性计算，通过一个理想化但极为重要的物理模型——奇异等温球（SIS）——来巩固这一基本概念，帮助您建立对剪切与收敛之间关系的核心直觉。",
            "id": "3468573",
            "problem": "考虑一个由奇异等温球（SIS）产生的统计上各向同性的弱引力透镜场，其中透镜中心位于角坐标平面的原点，角位置矢量为 $\\boldsymbol{\\theta} = (\\theta_{x}, \\theta_{y})$，径向坐标为 $\\theta = |\\boldsymbol{\\theta}| = \\sqrt{\\theta_{x}^{2} + \\theta_{y}^{2}}$。观测到的复剪切由其笛卡尔分量指定，\n$$\n\\gamma_{1}(\\theta_{x}, \\theta_{y}) = -\\frac{\\theta_{E}}{2}\\,\\frac{\\theta_{x}^{2} - \\theta_{y}^{2}}{\\left(\\theta_{x}^{2} + \\theta_{y}^{2}\\right)^{3/2}}, \n\\qquad\n\\gamma_{2}(\\theta_{x}, \\theta_{y}) = -\\frac{\\theta_{E}}{2}\\,\\frac{2\\,\\theta_{x}\\,\\theta_{y}}{\\left(\\theta_{x}^{2} + \\theta_{y}^{2}\\right)^{3/2}},\n$$\n其中 $\\theta_{E} > 0$ 是一个常数角参数（爱因斯坦半径），且剪切在原点周围是纯切向的。假设该场定义在整个平面上，并且没有旋度型（B模）系统误差。利用从引力透镜势导出的剪切和会聚在傅里叶空间中的关系，反演给定的剪切以重构会聚 $\\kappa(\\boldsymbol{\\theta})$，使其成为 $\\theta$ 的闭合形式函数。然后将恢复的 $\\kappa(\\boldsymbol{\\theta})$ 与奇异等温球模型（SIS）所预期的其与 $\\theta^{-1}$ 成比例的缩放关系进行比较，并以最简形式给出 $\\kappa(\\theta)$ 的最终表达式。将你的最终答案表示为仅依赖于 $\\theta$ 和 $\\theta_{E}$ 的单个解析表达式。最终表达式中不应包含任何积分。无需四舍五入，最终表达式中不应包含任何单位。",
            "solution": "该问题要求使用傅里叶空间方法，从给定的奇异等温球（SIS）透镜的剪切分量 $\\gamma_1(\\boldsymbol{\\theta})$ 和 $\\gamma_2(\\boldsymbol{\\theta})$ 重构会聚场 $\\kappa(\\boldsymbol{\\theta})$。\n\n首先，我们对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 透镜模型：以原点为中心的奇异等温球（SIS）。\n- 角位置矢量：$\\boldsymbol{\\theta} = (\\theta_{x}, \\theta_{y})$。\n- 径向坐标：$\\theta = |\\boldsymbol{\\theta}| = \\sqrt{\\theta_{x}^{2} + \\theta_{y}^{2}}$。\n- 剪切分量：\n$$\n\\gamma_{1}(\\theta_{x}, \\theta_{y}) = -\\frac{\\theta_{E}}{2}\\,\\frac{\\theta_{x}^{2} - \\theta_{y}^{2}}{\\left(\\theta_{x}^{2} + \\theta_{y}^{2}\\right)^{3/2}}\n$$\n$$\n\\gamma_{2}(\\theta_{x}, \\theta_{y}) = -\\frac{\\theta_{E}}{2}\\,\\frac{2\\,\\theta_{x}\\,\\theta_{y}}{\\left(\\theta_{x}^{2} + \\theta_{y}^{2}\\right)^{3/2}}\n$$\n- 常数参数：$\\theta_{E} > 0$（爱因斯坦半径）。\n- 条件：剪切是纯切向的。\n- 条件：该场没有旋度型（B模）系统误差。\n- 任务：利用傅里叶空间关系，反演剪切以求出会聚 $\\kappa(\\boldsymbol{\\theta})$，作为 $\\theta$ 的闭合形式函数。将结果与预期的 $\\theta^{-1}$ 缩放关系进行比较。\n\n**第2步：使用提取的已知条件进行验证**\n该问题是适定的且有科学依据的。给定的剪切分量是由奇异等温球（SIS）势 $\\psi(\\boldsymbol{\\theta}) = \\theta_E |\\boldsymbol{\\theta}|$ 产生的弱引力透镜场的正确表达式。关系式 $\\gamma_1 = \\frac{1}{2}(\\psi_{xx} - \\psi_{yy})$ 和 $\\gamma_2 = \\psi_{xy}$ （其中 $\\psi$ 的下标表示对 $\\theta_x$ 和 $\\theta_y$ 的偏导数）正确地导出了所提供的表达式。无B模的条件是从剪切到会聚的唯一反演所必需的，并且与剪切源于标量势的情况相一致。该问题是弱引力透镜理论中的一个标准练习。因此，该问题是有效的。\n\n**第3步：结论与行动**\n问题有效。我们开始求解。\n\n弱引力透镜的基本量，即会聚 $\\kappa$ 和复剪切 $\\gamma = \\gamma_1 + i\\gamma_2$，与引力透镜势 $\\psi(\\boldsymbol{\\theta})$ 的二阶导数相关。这些关系在傅里叶空间中表达最为方便。令 $\\hat{f}(\\boldsymbol{\\ell})$ 表示函数 $f(\\boldsymbol{\\theta})$ 的二维傅里叶变换，其中 $\\boldsymbol{\\ell}$ 是 $\\boldsymbol{\\theta}$ 的傅里叶共轭变量。这些关系是：\n$$\n\\hat{\\kappa}(\\boldsymbol{\\ell}) = \\frac{1}{2}(\\ell_x^2 + \\ell_y^2) \\hat{\\psi}(\\boldsymbol{\\ell}) = \\frac{1}{2}\\ell^2 \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\n$$\n\\hat{\\gamma}_1(\\boldsymbol{\\ell}) = \\frac{1}{2}(\\ell_x^2 - \\ell_y^2) \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\n$$\n\\hat{\\gamma}_2(\\boldsymbol{\\ell}) = \\ell_x \\ell_y \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\n其中 $\\ell = |\\boldsymbol{\\ell}|$。复剪切的傅里叶变换是 $\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\hat{\\gamma}_1(\\boldsymbol{\\ell}) + i\\hat{\\gamma}_2(\\boldsymbol{\\ell})$。结合 $\\hat{\\gamma}_1$ 和 $\\hat{\\gamma}_2$ 的表达式：\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\frac{1}{2}(\\ell_x^2 - \\ell_y^2 + 2i\\ell_x\\ell_y) \\hat{\\psi}(\\boldsymbol{\\ell}) = \\frac{1}{2}(\\ell_x + i\\ell_y)^2 \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\n在极坐标中表示傅里叶空间矢量 $\\boldsymbol{\\ell}$，即 $\\ell_x+i\\ell_y = \\ell e^{i\\phi_\\ell}$，其中 $\\phi_\\ell$ 是 $\\boldsymbol{\\ell}$ 的极角，我们得到：\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\frac{1}{2}\\ell^2 e^{i2\\phi_\\ell} \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\n通过将其与 $\\hat{\\kappa}(\\boldsymbol{\\ell})$ 的表达式进行比较，我们得到了关键的 Kaiser-Squires 关系：\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\hat{\\kappa}(\\boldsymbol{\\ell}) e^{i2\\phi_\\ell}\n$$\n这个关系式允许我们从剪切重构会聚。对 $\\hat{\\kappa}(\\boldsymbol{\\ell})$ 进行反演得到：\n$$\n\\hat{\\kappa}(\\boldsymbol{\\ell}) = \\hat{\\gamma}(\\boldsymbol{\\ell}) e^{-i2\\phi_\\ell}\n$$\n问题现在简化为计算给定剪切场的傅里叶变换，然后应用这个反演公式。\n\n首先，让我们用复数形式表示给定的剪切场。\n$$\n\\gamma(\\boldsymbol{\\theta}) = \\gamma_1 + i\\gamma_2 = -\\frac{\\theta_E}{2} \\frac{(\\theta_x^2 - \\theta_y^2) + i(2\\theta_x\\theta_y)}{(\\theta_x^2+\\theta_y^2)^{3/2}}\n$$\n分子是 $(\\theta_x + i\\theta_y)^2$。在 $\\boldsymbol{\\theta}$ 的极坐标中，我们有 $\\theta_x+i\\theta_y = \\theta e^{i\\phi}$。分母就是 $\\theta^3$。\n$$\n\\gamma(\\boldsymbol{\\theta}) = -\\frac{\\theta_E}{2} \\frac{(\\theta e^{i\\phi})^2}{\\theta^3} = -\\frac{\\theta_E}{2\\theta} e^{i2\\phi}\n$$\n这种形式显示了剪切场的典型四极（$e^{i2\\phi}$）性质及其对于奇异等温球（SIS）的 $\\theta^{-1}$ 依赖性。\n\n接下来，我们计算 $\\gamma(\\boldsymbol{\\theta})$ 的二维傅里叶变换：\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\int d^2\\theta \\, \\gamma(\\boldsymbol{\\theta}) e^{-i\\boldsymbol{\\ell} \\cdot \\boldsymbol{\\theta}} = \\int d^2\\theta \\, \\left( -\\frac{\\theta_E}{2\\theta} e^{i2\\phi} \\right) e^{-i\\boldsymbol{\\ell} \\cdot \\boldsymbol{\\theta}}\n$$\n形式为 $f(\\theta, \\phi) = f_R(\\theta) e^{im\\phi}$ 的函数的傅里叶变换由下式给出：\n$$\n\\hat{f}(\\ell, \\phi_\\ell) = 2\\pi (-i)^m e^{im\\phi_\\ell} \\int_0^\\infty \\theta \\, f_R(\\theta) J_m(\\ell \\theta) d\\theta\n$$\n其中 $J_m$ 是 $m$ 阶第一类贝塞尔函数。对于我们的剪切场，我们有 $m=2$ 和 $f_R(\\theta) = - \\frac{\\theta_E}{2\\theta}$。\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = 2\\pi (-i)^2 e^{i2\\phi_\\ell} \\int_0^\\infty \\theta \\left( -\\frac{\\theta_E}{2\\theta} \\right) J_2(\\ell \\theta) d\\theta\n$$\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = -2\\pi e^{i2\\phi_\\ell} \\left( -\\frac{\\theta_E}{2} \\right) \\int_0^\\infty J_2(\\ell \\theta) d\\theta = \\pi \\theta_E e^{i2\\phi_\\ell} \\int_0^\\infty J_2(\\ell \\theta) d\\theta\n$$\n我们使用标准积分恒等式 $\\int_0^\\infty J_\\nu(ax) dx = \\frac{1}{a}$，该式对于 $\\Re(\\nu) > -1$ 成立。在我们的情况下，$\\nu=2$ 且 $a=\\ell$，所以条件满足。\n$$\n\\int_0^\\infty J_2(\\ell \\theta) d\\theta = \\frac{1}{\\ell}\n$$\n将此结果代入 $\\hat{\\gamma}(\\boldsymbol{\\ell})$ 的表达式中：\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\frac{\\pi \\theta_E}{\\ell} e^{i2\\phi_\\ell}\n$$\n现在我们应用反演公式 $\\hat{\\kappa}(\\boldsymbol{\\ell}) = \\hat{\\gamma}(\\boldsymbol{\\ell}) e^{-i2\\phi_\\ell}$：\n$$\n\\hat{\\kappa}(\\boldsymbol{\\ell}) = \\left(\\frac{\\pi \\theta_E}{\\ell} e^{i2\\phi_\\ell}\\right) e^{-i2\\phi_\\ell} = \\frac{\\pi \\theta_E}{\\ell}\n$$\n这是会聚场的傅里叶变换。它是径向对称的，只依赖于 $\\ell = |\\boldsymbol{\\ell}|$，这对于一个圆对称透镜是符合预期的。\n\n为了求得 $\\kappa(\\boldsymbol{\\theta})$，我们对 $\\hat{\\kappa}(\\boldsymbol{\\ell})$ 进行傅里叶逆变换：\n$$\n\\kappa(\\boldsymbol{\\theta}) = \\int \\frac{d^2\\ell}{(2\\pi)^2} \\hat{\\kappa}(\\ell) e^{i\\boldsymbol{\\ell} \\cdot \\boldsymbol{\\theta}}\n$$\n由于 $\\hat{\\kappa}(\\ell)$ 是径向对称的，得到的 $\\kappa(\\boldsymbol{\\theta})$ 也将是径向对称的，即 $\\kappa(\\boldsymbol{\\theta})=\\kappa(\\theta)$。该积分是一个零阶汉克尔变换。\n$$\n\\kappa(\\theta) = \\frac{1}{(2\\pi)^2} \\int_0^\\infty \\ell d\\ell \\int_0^{2\\pi} d\\phi_\\ell \\left(\\frac{\\pi\\theta_E}{\\ell}\\right) e^{i\\ell\\theta \\cos(\\phi_\\ell)}\n$$\n不失一般性，我们将 $\\boldsymbol{\\theta}$ 与 x 轴对齐。\n$$\n\\kappa(\\theta) = \\frac{\\pi\\theta_E}{4\\pi^2} \\int_0^\\infty d\\ell \\int_0^{2\\pi} d\\phi_\\ell e^{i\\ell\\theta \\cos(\\phi_\\ell)}\n$$\n关于 $\\phi_\\ell$ 的积分是贝塞尔函数 $J_0$ 的一个积分表示：$\\int_0^{2\\pi}e^{ix \\cos\\phi} d\\phi = 2\\pi J_0(x)$。\n$$\n\\kappa(\\theta) = \\frac{\\theta_E}{4\\pi} \\int_0^\\infty 2\\pi J_0(\\ell\\theta) d\\ell = \\frac{\\theta_E}{2} \\int_0^\\infty J_0(\\ell\\theta) d\\ell\n$$\n使用与之前相同的积分恒等式 $\\int_0^\\infty J_0(ax) dx = \\frac{1}{a}$，其中 $a=\\theta$。\n$$\n\\int_0^\\infty J_0(\\ell\\theta) d\\ell = \\frac{1}{\\theta}\n$$\n因此，重构的会聚是：\n$$\n\\kappa(\\theta) = \\frac{\\theta_E}{2} \\cdot \\frac{1}{\\theta} = \\frac{\\theta_E}{2\\theta}\n$$\n这个恢复的会聚剖面 $\\kappa(\\theta) = \\frac{\\theta_E}{2\\theta}$，与 $\\theta^{-1}$ 成比例，这正是奇异等温球模型的预期结果。整个推导过程是自洽的，并证实了奇异等温球（SIS）模型的众所周知的性质。\n\n会聚 $\\kappa(\\theta)$ 的最终表达式以其最简形式给出。",
            "answer": "$$ \\boxed{ \\frac{\\theta_{E}}{2\\theta} } $$"
        },
        {
            "introduction": "在掌握了理想情况下的理论后，我们需要将它应用于实际。真实的巡天观测数据存在空洞和复杂的边界（掩模），这会污染重构的质量图。本动手数值实践  将演示如何在网格上实现反演过程，并处理由掩模引起的 E 模到 B 模泄漏这一关键问题，从而突显诸如“平滑化处理”（apodization）等技术在抑制系统误差中的重要性。",
            "id": "3468591",
            "problem": "考虑一个平坦天区上的弱引力透镜效应，该效应在一个二维周期性方形网格上建模。从引力透镜势 $\\psi(\\boldsymbol{\\theta})$、汇聚度 $\\kappa(\\boldsymbol{\\theta})$ 以及由 $\\psi$ 的线性微分算符定义的剪切分量 $\\gamma_1(\\boldsymbol{\\theta}),\\gamma_2(\\boldsymbol{\\theta})$ 出发。假设一个受控的模拟质量分布，它产生一个纯标量势 $\\psi$，因此产生一个没有旋度式（“磁”）分量的纯梯度式（“电”）剪切场。通过一个任意的二元掩模 $W_0(\\boldsymbol{\\theta})\\in\\{0,1\\}$ 进行观测，该掩模移除选定区域的数据；观测到的剪切为 $\\gamma^{\\mathrm{obs}}(\\boldsymbol{\\theta})=W(\\boldsymbol{\\theta})\\gamma(\\boldsymbol{\\theta})$，其中 $W(\\boldsymbol{\\theta})$ 可以包含一个在掩模边界附近从 $0$ 平滑过渡到 $1$ 的平滑切趾。\n\n你的任务是：\n- 在傅里叶空间中推导线性反演，将观测到的剪切场映射到平坦天区上的“电模”汇聚度 $\\kappa_E(\\boldsymbol{\\theta})$ 和“磁模”汇聚度 $\\kappa_B(\\boldsymbol{\\theta})$。推导应仅从 $\\psi$, $\\kappa$ 和 $\\gamma$ 之间的基本关系开始，不假设任何已知的反演公式。\n- 提出一个仅依赖于到最近掩模边界的距离 $d$ 的切趾函数 $A(d)$，该函数在被掩模区域内产生 $W(\\boldsymbol{\\theta})$ 的平滑过渡，以减少 $E/B$ 混合。基于最小化尖锐边缘效应来论证 $A(d)$ 的选择。\n- 在方形网格上实施一个数值实验来评估泄漏，泄漏定义为无量纲比率\n$$L \\equiv \\sqrt{\\frac{\\sum_{i} W_i \\,\\kappa_B(\\boldsymbol{\\theta}_i)^2}{\\sum_{i} W_i \\,\\kappa_E(\\boldsymbol{\\theta}_i)^2}},$$\n其中求和遍历所有 $W_i>0$ 的像素，并演示与硬（非切趾）掩模相比，切趾如何减少 $L$。\n\n使用以下受控的模拟和网格配置：\n- 线性尺寸为 $N=128$ 像素的方形网格，单位像素间距。对于傅里叶变换，将该域视为周期性的。所有场都是无量纲的；不需要物理单位。\n- 汇聚度 $\\kappa(\\boldsymbol{\\theta})$ 是两个各向同性高斯团块的叠加，中心分别位于位置 $\\boldsymbol{\\theta}_1=(N/4,N/4)$ 和 $\\boldsymbol{\\theta}_2=(3N/4,3N/4)$，振幅分别为 $A_1=1.0$ 和 $A_2=0.8$，标准差分别为 $\\sigma_1=5$ 像素和 $\\sigma_2=8$ 像素。减去 $\\kappa$ 的平均值，以使零模为零。\n- 使用周期性网格上的傅里叶导数，从 $\\kappa(\\boldsymbol{\\theta})$ 计算 $\\psi(\\boldsymbol{\\theta})$、$\\gamma_1(\\boldsymbol{\\theta})$ 和 $\\gamma_2(\\boldsymbol{\\theta})$。\n\n为测试套件定义掩模和切趾宽度如下：\n1. 案例1（基线）：无掩模，即 $W_0(\\boldsymbol{\\theta})=1$ 处处成立；切趾宽度 $w=0$ 像素。\n2. 案例2（硬圆形孔）：在以 $\\boldsymbol{\\theta}=(N/2,N/2)$ 为中心、半径为 $r=12$ 像素的圆内 $W_0(\\boldsymbol{\\theta})=0$，其他地方 $W_0(\\boldsymbol{\\theta})=1$；切趾宽度 $w=0$ 像素。\n3. 案例3（切趾圆形孔）：与案例2相同的 $W_0$，但切趾宽度为 $w=6$ 像素。\n4. 案例4（切趾垂直条带孔）：对于中心垂直条带 $|x-N/2|\\leq s$（其中 $s=6$ 像素）$W_0(\\boldsymbol{\\theta})=0$，其他地方 $W_0(\\boldsymbol{\\theta})=1$；切趾宽度为 $w=6$ 像素。\n\n对于切趾，通过在未掩模区域内，使用对所有掩模几何形状都相同的 $A(d)$，在一个宽度为 $w$ 像素的边界层上从 $0$ 平滑过渡到 $1$，从而从 $W_0(\\boldsymbol{\\theta})$ 构建 $W(\\boldsymbol{\\theta})$。如果 $w=0$，则设 $W(\\boldsymbol{\\theta})=W_0(\\boldsymbol{\\theta})$。\n\n你的程序必须：\n- 实现基于推导的从观测剪切到平坦天区上 $\\kappa_E$ 和 $\\kappa_B$ 的反演。\n- 实现所提出的切趾函数 $A(d)$，并将其应用于每个掩模 $W_0$ 以生成 $W$。\n- 对指定模拟的每种情况计算泄漏度量 $L$，并将每个结果四舍五入到六位小数。\n\n最终输出格式：\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4]\"）。每个条目必须是对应上述顺序案例的浮点数 $L$，四舍五入到六位小数。\n\n因此，测试套件是参数三元组 $(\\text{掩模类型}, \\text{掩模参数}, w)$ 的有序列表：\n- 案例1: $(\\text{无}, 0, 0)$\n- 案例2: $(\\text{圆形}, r=12, 0)$\n- 案例3: $(\\text{圆形}, r=12, 6)$\n- 案例4: $(\\text{条带}, s=6, 6)$",
            "solution": "该问题要求推导用于掩模数据的弱引力透镜E/B模反演，提出一种切趾方案，并进行数值实现以量化E-B模泄漏。该问题定义明确，科学上基于宇宙学和数据分析的原理，并为数值求解提供了所有必要的参数。\n\n### 1. E/B模反演的推导\n\n分析始于连接平坦天区上引力透镜势 $\\psi(\\boldsymbol{\\theta})$、汇聚度 $\\kappa(\\boldsymbol{\\theta})$ 以及剪切场两个分量 $\\gamma_1(\\boldsymbol{\\theta})$ 和 $\\gamma_2(\\boldsymbol{\\theta})$ 的基本关系。这些关系由势的二阶导数给出：\n$$ \\kappa = \\frac{1}{2}(\\partial_1^2 + \\partial_2^2)\\psi = \\frac{1}{2}\\nabla^2\\psi $$\n$$ \\gamma_1 = \\frac{1}{2}(\\partial_1^2 - \\partial_2^2)\\psi $$\n$$ \\gamma_2 = \\partial_1 \\partial_2 \\psi $$\n其中 $\\partial_i$ 表示对角坐标 $\\theta_i$ 的偏导数。\n\n这些关系在傅里叶空间中得以简化。令 $\\hat{f}(\\boldsymbol{k})$ 表示场 $f(\\boldsymbol{\\theta})$ 的傅里叶变换。导数算子 $\\partial_i$ 变换为乘以 $i k_i$，其中 $k_i$ 是波矢量分量。因此，关系式变为：\n$$ \\hat{\\kappa}(\\boldsymbol{k}) = -\\frac{1}{2}(k_1^2 + k_2^2)\\hat{\\psi}(\\boldsymbol{k}) = -\\frac{1}{2}k^2\\hat{\\psi}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = -\\frac{1}{2}(k_1^2 - k_2^2)\\hat{\\psi}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = -(k_1 k_2)\\hat{\\psi}(\\boldsymbol{k}) $$\n此处，$k^2 = k_1^2 + k_2^2$。对于此问题，假定基础质量分布产生纯E模（仅梯度）场，因此 $\\kappa$ 是真实的E模汇聚度。我们可以通过代入 $\\hat{\\psi}(\\boldsymbol{k}) = -2\\hat{\\kappa}(\\boldsymbol{k})/k^2$（对于 $\\boldsymbol{k} \\neq \\boldsymbol{0}$）来用汇聚度表示剪切分量：\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}(\\boldsymbol{k}) $$\n\n一般的剪切场可以分解为一个由势 $\\kappa_E$ 产生的无旋E模部分，以及一个由伪势 $\\kappa_B$ 产生的无散B模部分。一般剪切场的傅里叶空间关系为：\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}_E(\\boldsymbol{k}) + \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}_B(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}_E(\\boldsymbol{k}) - \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}_B(\\boldsymbol{k}) $$\n这代表了在每个波矢量 $\\boldsymbol{k}$ 处关于 $\\hat{\\kappa}_E(\\boldsymbol{k})$ 和 $\\hat{\\kappa}_B(\\boldsymbol{k})$ 的一个线性方程组。求解该方程组可得到反演公式。将第一个方程乘以 $(k_1^2 - k_2^2)/k^2$，第二个方程乘以 $(2k_1 k_2)/k^2$，然后相加，即可分离出 $\\hat{\\kappa}_E$。类似地，将第一个方程乘以 $(2k_1 k_2)/k^2$，第二个方程乘以 $-(k_1^2 - k_2^2)/k^2$，然后相加，即可分离出 $\\hat{\\kappa}_B$。反演公式为：\n$$ \\hat{\\kappa}_E(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\gamma}_1(\\boldsymbol{k}) + \\frac{2k_1 k_2}{k^2}\\hat{\\gamma}_2(\\boldsymbol{k}) $$\n$$ \\hat{\\kappa}_B(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\gamma}_1(\\boldsymbol{k}) - \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\gamma}_2(\\boldsymbol{k}) $$\n这些表达式定义在 $\\boldsymbol{k} \\neq \\boldsymbol{0}$ 的情况下。平均汇聚度 $\\hat{\\kappa}(\\boldsymbol{0})$ 无法从剪切中观测到（质量片退化），我们设置 $\\hat{\\kappa}_E(\\boldsymbol{0}) = \\hat{\\kappa}_B(\\boldsymbol{0}) = 0$。\n\n在观测环境中，真实的剪切场 $\\gamma(\\boldsymbol{\\theta})$ 会乘以一个窗口函数（掩模）$W(\\boldsymbol{\\theta})$，使得观测到的剪切为 $\\gamma^{\\mathrm{obs}}(\\boldsymbol{\\theta}) = W(\\boldsymbol{\\theta})\\gamma(\\boldsymbol{\\theta})$。实空间中的乘法对应于傅里叶空间中的卷积：$\\hat{\\gamma}^{\\mathrm{obs}}(\\boldsymbol{k}) = (\\hat{W} * \\hat{\\gamma})(\\boldsymbol{k})$。如果 $W(\\boldsymbol{\\theta})$ 具有尖锐的边缘，其傅里叶变换 $\\hat{W}(\\boldsymbol{k})$ 会有宽阔且缓慢衰减的翼。这种卷积会混合不同傅里叶模式之间的功率。由于E/B滤波器依赖于 $\\boldsymbol{k}$ 的方向，这种模式混合会破坏分离，导致来自纯E模信号的功率“泄漏”到重建的B模图中。因此，反演过程应用于*观测*场 $\\hat{\\gamma}^{\\mathrm{obs}}_1$ 和 $\\hat{\\gamma}^{\\mathrm{obs}}_2$ 的傅里叶变换，即使原始场是纯E模，这也会导致非零的 $\\kappa_B$。\n\n### 2. 切趾策略\n\n为了减轻由尖锐掩模边界引起的E/B泄漏，必须对窗口函数 $W(\\boldsymbol{\\theta})$ 进行平滑处理。这个过程称为切趾（apodization）。一个好的切趾函数在掩模边缘处，在有限宽度 $w$ 内从 $0$ 平滑过渡到 $1$。问题要求一个依赖于到最近掩模区域距离 $d$ 的函数 $A(d)$。\n\n我们提出一个正弦平方（或余弦钟形）的锥化函数。令 $W_0(\\boldsymbol{\\theta})$ 为二元掩模（在排除区域为 $0$，其他地方为 $1$）。对于未掩模区域（$W_0(\\boldsymbol{\\theta})=1$）中的任何点 $\\boldsymbol{\\theta}$，令 $d(\\boldsymbol{\\theta})$ 为其到最近掩模区域点的欧几里得距离。切趾后的窗口 $W(\\boldsymbol{\\theta})$ 定义为：\n$$\nW(\\boldsymbol{\\theta}) =\n\\begin{cases}\n    0 & \\text{如果 } W_0(\\boldsymbol{\\theta}) = 0 \\\\\n    \\sin^2\\left(\\frac{\\pi d(\\boldsymbol{\\theta})}{2w}\\right) & \\text{如果 } W_0(\\boldsymbol{\\theta}) = 1 \\text{ 且 } d(\\boldsymbol{\\theta}) < w \\\\\n    1 & \\text{如果 } W_0(\\boldsymbol{\\theta}) = 1 \\text{ 且 } d(\\boldsymbol{\\theta}) \\ge w\n\\end{cases}\n$$\n选择此函数的理由是其平滑性。此函数在过渡点 $d=0$（原始掩模的边界）和 $d=w$（切趾区域的内边缘）处是连续的，并且具有连续的一阶导数。具有连续导数的函数 $f(x)$ 的傅里叶变换 $\\hat{f}(k)$ 在大 $k$ 处衰减得更快。通过确保 $W(\\boldsymbol{\\theta})$ 及其一阶导数的连续性，我们抑制了 $\\hat{W}(\\boldsymbol{k})$ 中的高频功率，收窄了其核心，并减少了模式混合的程度，从而最小化了E/B泄漏。\n\n### 3. 数值实验设计\n\n数值实验旨在展示切趾的有效性。程序如下：\n1.  **网格和模拟场：** 定义一个 $128 \\times 128$ 像素的网格。真实的汇聚度场 $\\kappa(\\boldsymbol{\\theta})$ 由两个具有指定参数的高斯团块叠加而成。减去其平均值以确保 $\\hat{\\kappa}(\\boldsymbol{0}) = 0$。\n2.  **真实剪切生成：** 使用上述推导的傅里叶空间关系，从 $\\kappa(\\boldsymbol{\\theta})$ 生成真实的剪切场 $\\gamma_1(\\boldsymbol{\\theta})$ 和 $\\gamma_2(\\boldsymbol{\\theta})$。这包括对 $\\kappa$ 进行FFT，在k空间应用适当的滤波器，然后进行IFFT。\n3.  **掩模应用：** 对于四个测试案例中的每一个，创建相应的二元掩模 $W_0$。然后使用具有指定宽度 $w$ 的正弦平方锥化函数构建切趾掩模 $W$。通过将真实剪切场与 $W$ 相乘，获得观测到的剪切场 $\\gamma_1^{\\mathrm{obs}}$ 和 $\\gamma_2^{\\mathrm{obs}}$。\n4.  **E/B重建：** 对观测到的剪切场进行傅里叶变换。在傅里叶空间中应用E/B反演公式以获得 $\\hat{\\kappa}_E(\\boldsymbol{k})$ 和 $\\hat{\\kappa}_B(\\boldsymbol{k})$。然后对它们进行逆傅里叶变换，得到实空间图 $\\kappa_E(\\boldsymbol{\\theta})$ 和 $\\kappa_B(\\boldsymbol{\\theta})$。\n5.  **泄漏计算：** 使用以下公式为每种情况计算泄漏度量 $L$：\n    $$ L = \\sqrt{\\frac{\\sum_{i} W_i \\,\\kappa_B(\\boldsymbol{\\theta}_i)^2}{\\sum_{i} W_i \\,\\kappa_E(\\boldsymbol{\\theta}_i)^2}} $$\n    该度量量化了重建的B模与E模中的功率比，并由掩模本身加权，以关注观测区域。四个案例的结果将表明，$L$ 在无掩模情况下可以忽略不计，对于硬边缘掩模则很显著，并通过切趾得到大幅降低。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.ndimage import distance_transform_edt\n\ndef create_mock_kappa(N, clumps):\n    \"\"\"Generates the mock convergence map.\"\"\"\n    y, x = np.meshgrid(np.arange(N), np.arange(N), indexing='ij')\n    kappa = np.zeros((N, N))\n    for clump in clumps:\n        A, (x0, y0), sigma = clump\n        dist_sq = (x - x0)**2 + (y - y0)**2\n        kappa += A * np.exp(-dist_sq / (2 * sigma**2))\n    \n    # Subtract the mean to ensure the DC mode is zero.\n    kappa -= np.mean(kappa)\n    return kappa\n\ndef kappa_to_shear(kappa, N):\n    \"\"\"Computes shear fields from a convergence map in Fourier space.\"\"\"\n    kappa_k = np.fft.fft2(kappa)\n    \n    ky = np.fft.fftfreq(N)[:, None]\n    kx = np.fft.fftfreq(N)[None, :]\n    \n    # Square of the wavenumber. Avoid division by zero at k=0.\n    k_sq = kx**2 + ky**2\n    k_sq[0, 0] = 1.0  # Avoid division by zero\n    \n    # Shear-to-convergence filters\n    # gamma1_k = kappa_k * (kx^2 - ky^2) / k^2\n    # gamma2_k = kappa_k * (2*kx*ky) / k^2\n    g1_k_filter = (kx**2 - ky**2) / k_sq\n    g2_k_filter = (2 * kx * ky) / k_sq\n    \n    # The k=0 mode has no shear, set filter to 0\n    g1_k_filter[0, 0] = 0.0\n    g2_k_filter[0, 0] = 0.0\n    \n    gamma1_k = kappa_k * g1_k_filter\n    gamma2_k = kappa_k * g2_k_filter\n        \n    gamma1 = np.fft.ifft2(gamma1_k).real\n    gamma2 = np.fft.ifft2(gamma2_k).real\n    \n    return gamma1, gamma2\n\ndef reconstruct_kEB(gamma1_obs, gamma2_obs, N):\n    \"\"\"Reconstructs E-mode and B-mode convergence from observed shear.\"\"\"\n    gamma1_obs_k = np.fft.fft2(gamma1_obs)\n    gamma2_obs_k = np.fft.fft2(gamma2_obs)\n\n    ky = np.fft.fftfreq(N)[:, None]\n    kx = np.fft.fftfreq(N)[None, :]\n    \n    k_sq = kx**2 + ky**2\n    k_sq[0, 0] = 1.0  # Avoid division by zero\n    \n    # E-mode filter: kE_k = ((kx^2-ky^2)*g1_k + (2*kx*ky)*g2_k)/k^2\n    kE_k = ((kx**2 - ky**2) * gamma1_obs_k + 2 * kx * ky * gamma2_obs_k) / k_sq\n    \n    # B-mode filter: kB_k = ((2*kx*ky)*g1_k - (kx^2-ky^2)*g2_k)/k^2\n    kB_k = (2 * kx * ky * gamma1_obs_k - (kx**2 - ky**2) * gamma2_obs_k) / k_sq\n\n    # Set DC modes to zero (mass sheet degeneracy)\n    kE_k[0, 0] = 0.0\n    kB_k[0, 0] = 0.0\n    \n    kappa_E = np.fft.ifft2(kE_k).real\n    kappa_B = np.fft.ifft2(kB_k).real\n    \n    return kappa_E, kappa_B\n\ndef generate_mask(mask_type, param, N):\n    \"\"\"Generates the binary mask W0.\"\"\"\n    W0 = np.ones((N, N))\n    y, x = np.meshgrid(np.arange(N), np.arange(N), indexing='ij')\n    center_x, center_y = N / 2, N / 2\n\n    if mask_type == \"none\":\n        pass\n    elif mask_type == \"circular\":\n        radius = param\n        dist_sq = (x - center_x)**2 + (y - center_y)**2\n        W0[dist_sq = radius**2] = 0\n    elif mask_type == \"stripe\":\n        half_width = param\n        W0[:, np.abs(np.arange(N) - center_x) = half_width] = 0\n        \n    return W0\n\ndef apply_apodization(W0, w, N):\n    \"\"\"Applies sine-squared apodization to a binary mask.\"\"\"\n    if w == 0:\n        return W0.astype(float)\n\n    # distance_transform_edt computes the distance from each non-zero pixel \n    # to the nearest zero pixel. This is exactly d(theta).\n    dist_map = distance_transform_edt(W0)\n    \n    W = W0.copy().astype(float)\n    \n    # Identify the region to apply tapering\n    taper_zone = (W0 == 1)  (dist_map  w)\n    \n    # Apply the sine-squared apodization function\n    W[taper_zone] = np.sin(np.pi * dist_map[taper_zone] / (2 * w))**2\n    \n    return W\n\ndef calculate_leakage(kappa_E, kappa_B, W):\n    \"\"\"Calculates the E-to-B leakage metric L.\"\"\"\n    \n    # The sum is over all pixels, weighted by W_i.\n    # Pixels where W_i=0 contribute nothing.\n    power_B = np.sum(W * kappa_B**2)\n    power_E = np.sum(W * kappa_E**2)\n    \n    if power_E == 0:\n        return np.inf\n        \n    return np.sqrt(power_B / power_E)\n\ndef solve():\n    N = 128\n    \n    # Define the mock kappa field\n    clumps = [\n        (1.0, (N/4, N/4), 5.0),\n        (0.8, (3*N/4, 3*N/4), 8.0)\n    ]\n    kappa_true = create_mock_kappa(N, clumps)\n    \n    # Generate the true, unmasked shear fields\n    gamma1_true, gamma2_true = kappa_to_shear(kappa_true, N)\n    \n    # Define the test cases\n    test_cases = [\n        {\"mask_type\": \"none\", \"param\": 0, \"w\": 0},\n        {\"mask_type\": \"circular\", \"param\": 12, \"w\": 0},\n        {\"mask_type\": \"circular\", \"param\": 12, \"w\": 6},\n        {\"mask_type\": \"stripe\", \"param\": 6, \"w\": 6},\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        # 1. Generate binary mask\n        W0 = generate_mask(case[\"mask_type\"], case[\"param\"], N)\n        \n        # 2. Apply apodization to get final window function W\n        W = apply_apodization(W0, case[\"w\"], N)\n        \n        # 3. Create observed (masked) shear fields\n        gamma1_obs = gamma1_true * W\n        gamma2_obs = gamma2_true * W\n        \n        # 4. Reconstruct E and B modes from observed shear\n        kappa_E, kappa_B = reconstruct_kEB(gamma1_obs, gamma2_obs, N)\n        \n        # 5. Calculate leakage\n        leakage = calculate_leakage(kappa_E, kappa_B, W)\n        results.append(leakage)\n\n    # Format the final output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "学习了重构过程之后，理解其內在局限性至关重要。“质量面简并”（Mass-Sheet Degeneracy, MSD）是一个根本性的模糊性，即不同的质量分布可能产生完全相同的剪切场。本练习  探讨了如何利用一个独立的观测量——引力放大（magnification）——来打破这种简并性，通过一个定量的计算来评估放大效应对简并参数 $\\lambda$ 的约束能力。",
            "id": "3468642",
            "problem": "给定一个总立体角为 $A_{\\mathrm{tot}}$ 的弱引力透镜巡天数据，你已经由此数值构建了一个约化剪切图 $g(\\boldsymbol{\\theta})$ 和一个独立的放大率图 $\\hat{\\mu}(\\boldsymbol{\\theta})$。在整个计算中，请在弱引力透镜机制下，在一个 $| \\kappa | \\leq 0.1$ 且 $| g | \\leq 0.2$ 的子区域内进行。因此，在领头阶上，你可以将在参考质量面选择下的基准放大率场近似为空间常数，即 $\\mu(\\boldsymbol{\\theta}; \\lambda=1) \\approx \\mu_{0}$，其中 $\\mu_{0} \\approx 1$。假设约化剪切 $g(\\boldsymbol{\\theta})$ 的测量噪声相对于放大率噪声而言可以忽略不计，并且星系位置是随机分布的，因此在所选的像素尺度上，内禀成团性可以被忽略。\n\n采用包含会聚 $\\kappa$ 和复剪切 $\\gamma$ 的引力透镜雅可比矩阵定义，并将放大率 $\\mu$ 定义为雅可比矩阵行列式的倒数。约化剪切定义为 $g \\equiv \\gamma / (1 - \\kappa)$。质量面变换由一个全局参数 $\\lambda$ 参数化，它作用于会聚和剪切，形式为 $\\kappa \\rightarrow \\lambda \\kappa + (1 - \\lambda)$ 和 $\\gamma \\rightarrow \\lambda \\gamma$。你将通过仅使用放大率数据计算 $\\lambda$ 的费雪信息限制的残余不确定度，来量化增加放大率信息如何打破质量面简并，计算过程中不对任何其他参数进行边缘化。\n\n对于放大率的估计，使用在流量极限下的星系数量计数放大偏置，其对数计数斜率为 $s$。在一个立体角为 $A_{\\mathrm{pix}}$ 的像素中，预期的星系数量为 $n_{0} A_{\\mathrm{pix}} \\mu^{2.5 s - 1}$，其中 $n_{0}$ 是未被透镜化的星系平均表面密度。假设每个像素中的星系计数服从泊松统计，并且巡天中的各个像素是相互独立的。你可以根据需要在弱透镜极限附近对任何表达式进行线性化。\n\n巡天参数：\n- 总面积 $A_{\\mathrm{tot}} = 200~\\mathrm{deg}^{2}$。\n- 未透镜化的源密度 $n_{0} = 20~\\mathrm{arcmin}^{-2}$。\n- 数量计数斜率 $s = 0.3$。\n- 在选定的弱透镜子区域内，处理为 $\\mu(\\boldsymbol{\\theta}; \\lambda=1) \\approx \\mu_{0} = 1$。\n- 在真值 $\\lambda = 1$ 处评估不确定度。\n\n仅从上述定义和独立泊松计数的标准概率出发，根据所述的近似条件，推导以 $(A_{\\mathrm{tot}}, n_{0}, s, \\mu_{0})$ 表示的 $\\lambda$ 的费雪信息限制不确定度 $\\sigma_{\\lambda}$ 的闭式表达式，然后对给定的巡天数据进行数值计算。将最终答案表示为单个实数，并将结果四舍五入到三位有效数字。答案是无量纲的；不要在最终答案中包含单位。",
            "solution": "题目要求从仅有的放大率数据中，推导质量面变换参数 $\\lambda$ 的费雪信息限制不确定度 $\\sigma_{\\lambda}$。解题过程首先基于所提供的星系数量计数统计模型推导 $\\lambda$ 的费雪信息，然后计算所得表达式的值。\n\n放大率 $\\mu$ 定义为透镜雅可比矩阵 $A_{ij} = \\frac{\\partial \\theta_S^i}{\\partial \\theta^j}$ 行列式的倒数，其分量与会聚 $\\kappa$ 和复剪切 $\\gamma = \\gamma_1 + i\\gamma_2$ 有关。雅可比矩阵为 $A = \\begin{pmatrix} 1-\\kappa-\\gamma_1  -\\gamma_2 \\\\ -\\gamma_2  1-\\kappa+\\gamma_1 \\end{pmatrix}$。\n放大率为 $\\mu = (\\det A)^{-1} = ((1-\\kappa)^2 - |\\gamma|^2)^{-1}$。\n\n质量面变换 (MST) 给出如下：\n$$ \\kappa \\rightarrow \\kappa' = \\lambda \\kappa + (1 - \\lambda) $$\n$$ \\gamma \\rightarrow \\gamma' = \\lambda \\gamma $$\n在此变换下，放大率 $\\mu$ 的变换形式为：\n$$ \\mu(\\lambda) = \\frac{1}{(1-\\kappa')^2 - |\\gamma'|^2} = \\frac{1}{(1 - (\\lambda\\kappa + 1 - \\lambda))^2 - |\\lambda\\gamma|^2} = \\frac{1}{(\\lambda(1-\\kappa))^2 - \\lambda^2|\\gamma|^2} = \\frac{1}{\\lambda^2 ((1-\\kappa)^2 - |\\gamma|^2)} $$\n这给出了在任意 $\\lambda$ 下的放大率 $\\mu(\\lambda)$ 与真实放大率（在 $\\lambda=1$ 时），记为 $\\mu_{1}$ 之间的精确关系：\n$$ \\mu(\\lambda) = \\frac{\\mu_{1}}{\\lambda^2} $$\n这个关系式显示了放大率如何打破质量面简并，否则约化剪切 $g = \\gamma/(1-\\kappa)$ 在此变换下保持不变。\n\n数据由整个巡天中各像素内的星系计数组成。在一个立体角为 $A_{\\mathrm{pix}}$ 的像素 $i$ 中，预期的星系数量由下式给出：\n$$ \\langle N_i \\rangle = n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} $$\n其中 $n_0$ 是未被透镜化的星系表面密度，$\\alpha = 2.5s-1$，$s$ 是对数计数斜率。假设不同像素中的星系计数是相互独立的，并服从泊松统计。\n\n参数 $\\lambda$ 的总费雪信息是每个独立像素的费雪信息之和：$F_{\\lambda\\lambda} = \\sum_i F_{\\lambda\\lambda}^{(i)}$。对于期望值为 $\\langle N_i(\\lambda) \\rangle$ 的单个泊松观测 $N_i$，其费雪信息为 $F_{\\lambda\\lambda}^{(i)} = \\frac{1}{\\langle N_i \\rangle} \\left( \\frac{\\partial \\langle N_i \\rangle}{\\partial \\lambda} \\right)^2$。或者，这可以写成 $F_{\\lambda\\lambda}^{(i)} = \\langle N_i \\rangle \\left( \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} \\right)^2$。\n\n让我们计算对数期望值的导数：\n$$ \\ln \\langle N_i \\rangle = \\ln(n_0 A_{\\mathrm{pix}}) + \\alpha \\ln(\\mu_i(\\lambda)) $$\n$$ \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} = \\alpha \\frac{1}{\\mu_i(\\lambda)} \\frac{\\partial \\mu_i(\\lambda)}{\\partial \\lambda} $$\n使用关系式 $\\mu_i(\\lambda) = \\mu_{1,i}/\\lambda^2$，我们有：\n$$ \\frac{\\partial \\mu_i(\\lambda)}{\\partial \\lambda} = \\mu_{1,i} (-2\\lambda^{-3}) = -\\frac{2\\mu_i(\\lambda)}{\\lambda} $$\n将此代入对数期望的导数中：\n$$ \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} = \\alpha \\frac{1}{\\mu_i(\\lambda)} \\left( -\\frac{2\\mu_i(\\lambda)}{\\lambda} \\right) = -\\frac{2\\alpha}{\\lambda} $$\n那么单个像素的费雪信息为：\n$$ F_{\\lambda\\lambda}^{(i)} = \\langle N_i(\\lambda) \\rangle \\left( -\\frac{2\\alpha}{\\lambda} \\right)^2 = \\frac{4\\alpha^2}{\\lambda^2} \\langle N_i(\\lambda) \\rangle = \\frac{4\\alpha^2}{\\lambda^2} n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} $$\n总费雪信息是所有像素的总和：\n$$ F_{\\lambda\\lambda}(\\lambda) = \\sum_i \\frac{4\\alpha^2}{\\lambda^2} n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} = \\frac{4\\alpha^2 n_0}{\\lambda^2} \\sum_i A_{\\mathrm{pix}} \\left(\\frac{\\mu_{1,i}}{\\lambda^2}\\right)^{\\alpha} $$\n$$ F_{\\lambda\\lambda}(\\lambda) = \\frac{4\\alpha^2 n_0}{\\lambda^{2+2\\alpha}} \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta $$\n我们需要在真值 $\\lambda=1$ 处对此进行评估：\n$$ F_{\\lambda\\lambda}|_{\\lambda=1} = 4\\alpha^2 n_0 \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta $$\n题目说明将基准放大率视为常数，$\\mu_1(\\boldsymbol{\\theta}) \\approx \\mu_0 = 1$。这个近似简化了积分：\n$$ \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta \\approx \\int_{A_{\\mathrm{tot}}} (1)^{\\alpha} d^2\\theta = A_{\\mathrm{tot}} $$\n这个近似等价于假设放大率场的空间涨落被平均掉了，即，在弱透镜极限下 $\\mu_1 \\approx 1+2\\kappa$，且 $\\int (1+2\\kappa)^\\alpha d^2\\theta \\approx \\int(1+2\\alpha\\kappa)d^2\\theta = A_{\\mathrm{tot}}$，因为整个巡天的平均会聚 $\\bar{\\kappa}$ 为零。\n\n将此代入费雪信息的表达式，得到：\n$$ F_{\\lambda\\lambda} = 4\\alpha^2 n_0 A_{\\mathrm{tot}} $$\n$\\lambda$ 的不确定度由 Cramer-Rao bound 给出，$\\sigma_\\lambda^2 \\ge 1/F_{\\lambda\\lambda}$。费雪信息限制的不确定度为 $\\sigma_\\lambda = 1/\\sqrt{F_{\\lambda\\lambda}}$。\n$$ \\sigma_\\lambda = \\frac{1}{\\sqrt{4\\alpha^2 n_0 A_{\\mathrm{tot}}}} = \\frac{1}{2|\\alpha| \\sqrt{n_0 A_{\\mathrm{tot}}}} $$\n代入 $\\alpha = 2.5s-1$，我们得到最终的闭式表达式：\n$$ \\sigma_\\lambda = \\frac{1}{2|2.5s-1| \\sqrt{n_0 A_{\\mathrm{tot}}}} $$\n\n现在，我们用给定的巡天参数对此表达式进行数值计算：\n$A_{\\mathrm{tot}} = 200~\\mathrm{deg}^2$\n$n_0 = 20~\\mathrm{arcmin}^{-2}$\n$s = 0.3$\n\n首先，我们必须确保单位一致。我们将总面积 $A_{\\mathrm{tot}}$ 转换为平方角分：\n$1~\\mathrm{degree} = 60~\\mathrm{arcminutes}$，所以 $1~\\mathrm{deg}^2 = 3600~\\mathrm{arcmin}^2$。\n$A_{\\mathrm{tot}} = 200 \\times 3600~\\mathrm{arcmin}^2 = 720,000~\\mathrm{arcmin}^2$。\n\n接下来，我们计算未透镜化的总星系数量 $n_0 A_{\\mathrm{tot}}$：\n$n_0 A_{\\mathrm{tot}} = (20~\\mathrm{arcmin}^{-2}) \\times (720,000~\\mathrm{arcmin}^2) = 14,400,000 = 1.44 \\times 10^7$。\n\n然后，我们计算指数因子 $\\alpha$：\n$\\alpha = 2.5s - 1 = 2.5 \\times 0.3 - 1 = 0.75 - 1 = -0.25$。\n$|\\alpha| = 0.25$。\n\n现在我们可以计算 $\\sigma_\\lambda$：\n$$ \\sigma_\\lambda = \\frac{1}{2 \\times 0.25 \\times \\sqrt{1.44 \\times 10^7}} = \\frac{1}{0.5 \\times \\sqrt{1.44 \\times 10^7}} = \\frac{2}{\\sqrt{1.44 \\times 10^7}} $$\n$$ \\sigma_\\lambda = \\frac{2}{1.2 \\times \\sqrt{10^7}} = \\frac{2}{1.2 \\times 10^{3.5}} \\approx \\frac{2}{1.2 \\times 3162.277} \\approx \\frac{2}{3794.733} \\approx 0.000527046 $$\n将结果四舍五入到三位有效数字，得到 $0.000527$ 或 $5.27 \\times 10^{-4}$。",
            "answer": "$$\\boxed{5.27 \\times 10^{-4}}$$"
        }
    ]
}