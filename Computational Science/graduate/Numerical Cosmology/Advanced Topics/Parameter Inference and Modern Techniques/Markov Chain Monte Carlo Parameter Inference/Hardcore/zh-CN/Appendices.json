{
    "hands_on_practices": [
        {
            "introduction": "Metropolis-Hastings 算法是许多 MCMC 实现的核心。它的接受准则巧妙地平衡了对参数空间新区域的探索和对后验概率密度更高区域的偏好。通过这个练习，你将亲手计算在给定后验比率和提议比率下的接受概率，从而深入理解 MCMC 链做出“下一步”决策的根本机制。",
            "id": "3478680",
            "problem": "一个数值宇宙学流程对平直 $\\Lambda$ 冷暗物质模型执行贝叶斯参数推断，该流程使用 Ia 型超新星和宇宙微波背景的摘要统计数据，通过 Metropolis–Hastings 马尔可夫链蒙特卡洛 (MCMC) 转移来抽样 $\\boldsymbol{\\theta} = (\\Omega_{\\mathrm{m}}, \\sigma_{8}, H_{0})$ 的后验。该转移对后验密度 $\\pi(\\boldsymbol{\\theta}) \\propto \\mathcal{L}(\\mathbf{d} \\mid \\boldsymbol{\\theta})\\,p(\\boldsymbol{\\theta})$ 强制执行细致平衡，并使用一个通常非对称的提议密度 $q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta})$。在某次迭代中，从当前状态 $\\boldsymbol{\\theta}$ 到提议状态 $\\boldsymbol{\\theta}'$，代码计算出后验密度比 $\\pi(\\boldsymbol{\\theta}')/\\pi(\\boldsymbol{\\theta}) = 10$ 和提议密度比 $q(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\theta}')/q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta}) = 2$。\n\n从以 $\\pi(\\boldsymbol{\\theta})$ 为目标的马尔可夫链的细致平衡基本要求出发，并根据 Metropolis–Hastings 转移核由提议函数和接受函数定义的规则，确定此步移动的 Metropolis–Hastings 接受概率 $\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}')$。然后，在宇宙学参数抽样的背景下，解释该值对此步骤中链的行为意味着什么。以纯数字形式提供接受概率。无需四舍五入。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 第 1 步：提取已知条件\n问题陈述中明确提供了以下数据和定义：\n- **模型：** 平直 $\\Lambda$ 冷暗物质 ($\\Lambda$CDM) 模型。\n- **待求参数：** $\\boldsymbol{\\theta} = (\\Omega_{\\mathrm{m}}, \\sigma_{8}, H_{0})$。\n- **推断方法：** Metropolis–Hastings 马尔可夫链蒙特卡洛 (MCMC)。\n- **目标概率密度：** 后验密度 $\\pi(\\boldsymbol{\\theta}) \\propto \\mathcal{L}(\\mathbf{d} \\mid \\boldsymbol{\\theta})\\,p(\\boldsymbol{\\theta})$，其中 $\\mathcal{L}$ 是似然， $p$ 是先验。\n- **提议密度：** 一个通常非对称的密度，$q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta})$。\n- **核心原则：** MCMC 转移对 $\\pi(\\boldsymbol{\\theta})$ 强制执行细致平衡。\n- **在从状态 $\\boldsymbol{\\theta}$ 到 $\\boldsymbol{\\theta}'$ 的某次特定迭代中：**\n    - 后验密度比为 $\\frac{\\pi(\\boldsymbol{\\theta}')}{\\pi(\\boldsymbol{\\theta})} = 10$。\n    - 提议密度比为 $\\frac{q(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\theta}')}{q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta})} = 2$。\n- **目标：** 确定 Metropolis–Hastings 接受概率 $\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}')$ 并解释其含义。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据既定标准评估问题的有效性。\n- **科学依据：** 该问题牢固地植根于贝叶斯统计推断和计算物理学的标准理论框架。Metropolis-Hastings 算法是 MCMC 方法的基石，其在宇宙学参数估计（特别是 $\\Lambda$CDM 模型）中的应用是该领域的常规和基本任务。所有概念——后验密度、似然、先验、提议密度、细致平衡以及参数 $\\Omega_{\\mathrm{m}}$, $\\sigma_{8}$, $H_{0}$——都是标准的且定义明确。\n- **适定性：** 问题提供了计算接受概率所需的所有信息。Metropolis-Hastings 接受规则的定义可以从给定的比率中得出一个唯一且稳定的解。\n- **客观性：** 语言技术性强、精确，没有任何主观性、模糊性或观点。\n\n该问题没有表现出任何列出的无效性缺陷。它在科学上是合理的，可以直接形式化，是完整的，描述了一个计算上现实的场景，并且结构良好。\n\n### 第 3 步：结论与行动\n问题被判定为**有效**。将提供完整的解答。\n\n### 解答推导\n马尔可夫链具有平稳分布 $\\pi(\\boldsymbol{\\theta})$ 的基本要求是细致平衡条件。对于任意两个状态 $\\boldsymbol{\\theta}$ 和 $\\boldsymbol{\\theta}'$，细致平衡要求当链处于平稳状态时，从 $\\boldsymbol{\\theta}$ 转移到 $\\boldsymbol{\\theta}'$ 的速率等于从 $\\boldsymbol{\\theta}'$ 转移到 $\\boldsymbol{\\theta}$ 的速率。这在数学上表示为：\n$$\n\\pi(\\boldsymbol{\\theta}) P(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta}) = \\pi(\\boldsymbol{\\theta}') P(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\theta}')\n$$\n其中 $P(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta})$ 是从状态 $\\boldsymbol{\\theta}$ 移动到状态 $\\boldsymbol{\\theta}'$ 的转移概率（或核）。\n\n在 Metropolis–Hastings 算法中，转移是一个两步过程：提议一个新状态，然后接受或拒绝它。从 $\\boldsymbol{\\theta}$ 移动到不同状态 $\\boldsymbol{\\theta}'$ 的转移概率是提议 $\\boldsymbol{\\theta}'$ 的概率与接受它的概率的乘积：\n$$\nP(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta}) = q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta}) \\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}') \\quad \\text{for } \\boldsymbol{\\theta} \\neq \\boldsymbol{\\theta}'\n$$\n其中 $q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta})$ 是提议密度，$\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}')$ 是接受概率。\n\n将这种形式的转移核代入细致平衡方程，得到：\n$$\n\\pi(\\boldsymbol{\\theta}) q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta}) \\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}') = \\pi(\\boldsymbol{\\theta}') q(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\theta}') \\alpha(\\boldsymbol{\\theta}', \\boldsymbol{\\theta})\n$$\n这个方程可以重新排列，以显示接受概率必须满足的关系：\n$$\n\\frac{\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}')}{\\alpha(\\boldsymbol{\\theta}', \\boldsymbol{\\theta})} = \\frac{\\pi(\\boldsymbol{\\theta}')}{\\pi(\\boldsymbol{\\theta})} \\frac{q(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\theta}')}{q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta})}\n$$\nMetropolis–Hastings 算法中接受概率的标准选择是：它既满足此条件，又最大化了接受率。\n$$\n\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}') = \\min \\left( 1, \\frac{\\pi(\\boldsymbol{\\theta}')}{\\pi(\\boldsymbol{\\theta})} \\frac{q(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\theta}')}{q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta})} \\right)\n$$\n问题提供了最小函数内部两个比率的数值。\n后验密度比给定为：\n$$\n\\frac{\\pi(\\boldsymbol{\\theta}')}{\\pi(\\boldsymbol{\\theta})} = 10\n$$\n提议密度比（称为 Hastings 修正因子）给定为：\n$$\n\\frac{q(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\theta}')}{q(\\boldsymbol{\\theta}' \\mid \\boldsymbol{\\theta})} = 2\n$$\n我们将这些值代入接受概率的公式中：\n$$\n\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}') = \\min \\left( 1, (10) \\times (2) \\right)\n$$\n$$\n\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}') = \\min(1, 20)\n$$\n计算最小函数得出：\n$$\n\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}') = 1\n$$\n### 解释\n计算出的接受概率为 $\\alpha(\\boldsymbol{\\theta}, \\boldsymbol{\\theta}') = 1$。这意味着从当前状态 $\\boldsymbol{\\theta}$ 到新状态 $\\boldsymbol{\\theta}'$ 的提议移动被确定性地接受。\n\n在宇宙学参数抽样的背景下，这是此步骤中一个非常理想的结果。该链在参数空间 $\\{ \\Omega_{\\mathrm{m}}, \\sigma_{8}, H_{0} \\}$ 中找到了一个新点 $\\boldsymbol{\\theta}'$，其后验概率密度是当前点 $\\boldsymbol{\\theta}$ 的 $10$ 倍。这表明提议的这组宇宙学参数能更好地拟合组合的 Ia 型超新星和 CMB 数据（由似然 $\\mathcal{L}$ 体现），和/或更受编码在 $p(\\boldsymbol{\\theta})$ 中的先验知识的青睐。\n\n尽管提议分布使得正向移动 ($\\boldsymbol{\\theta} \\to \\boldsymbol{\\theta}'$) 的可能性只有反向移动 ($\\boldsymbol{\\theta}' \\to \\boldsymbol{\\theta}$) 的一半（如 Hastings 因子 $2$ 所示），但后验密度的巨大提升压倒性地支持接受新状态。抽样器正在高效地“攀登”后验概率景观的山丘，积极地向包含宇宙学参数最可能值的高概率区域移动。接受此移动确保了链能够有效地探索并收敛到真实的后验分布。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "生成 MCMC 样本只是第一步，评估这些样本的质量和效率至关重要。此练习将引导你深入研究自相关性的概念，它衡量了链中样本之间的“记忆”或依赖程度。通过推导积分自相关时间 $\\tau_{\\mathrm{int}}$ 和有效样本量 $N_{\\mathrm{eff}}$，你将学会如何量化采样器的效率，这是判断 MCMC 运行是否充分的关键指标。",
            "id": "3478696",
            "problem": "在一个贝叶斯宇宙学参数推断问题中，假设使用基于马尔可夫链蒙特卡洛（MCMC）的算法对一个标量参数 $\\theta$（例如，描述标量扰动的振幅）的后验分布进行抽样。设 $\\{X_t\\}_{t=1}^{N}$ 是一个平稳的 MCMC 时间序列，其均值为 $\\mu$，方差为 $\\sigma^{2}$，自协方差函数为 $\\gamma_k=\\mathrm{cov}(X_t,X_{t+k})$。定义滞后为 $k$ 的自相关序列为 $\\rho_k=\\gamma_k/\\gamma_0$。假设链很长（$N$ 很大），且自相关性按 $\\rho_k=r^{k}$（其中 $|r|1$）几何衰减，如同在一阶自回归（AR(1)）代理模型中一样。\n\n从 $\\gamma_k$ 和样本均值 $\\bar{X}_N=(1/N)\\sum_{t=1}^{N}X_t$ 的方差的定义出发，通过对协方差求和，推导 $\\mathrm{var}(\\bar{X}_N)$ 在大 $N$ 极限下用 $\\sigma^{2}$ 和 $\\rho_k$ 表示的表达式。利用该表达式，将积分自相关时间 $\\tau_{\\mathrm{int}}$ 定义为通过关系式 $\\mathrm{var}(\\bar{X}_N)=\\sigma^{2}\\tau_{\\mathrm{int}}/N$（在大 $N$ 极限下）使 $\\mathrm{var}(\\bar{X}_N)$ 相对于独立抽样而增大的乘法因子。通过 $\\mathrm{var}(\\bar{X}_N)=\\sigma^{2}/N_{\\mathrm{eff}}$ 定义有效样本量 $N_{\\mathrm{eff}}$。\n\n对于玩具自相关序列 $\\rho_k=r^{k}$，计算 $\\tau_{\\mathrm{int}}$ 和 $N_{\\mathrm{eff}}$ 作为 $r$ 和 $N$ 的函数的闭式表达式。然后，定性地解释参数 $r$ 如何控制 $\\bar{X}_N$ 的方差和估计量的收敛速度。\n\n将最终答案以 $\\tau_{\\mathrm{int}}$ 和 $N_{\\mathrm{eff}}$ 对的形式写成一个行矩阵。无需四舍五入。最终表达式没有物理单位。",
            "solution": "该问题要求推导与分析平稳马尔可夫链蒙特卡洛（MCMC）时间序列 $\\{X_t\\}_{t=1}^{N}$ 相关的几个量。我们首先推导样本均值 $\\bar{X}_N$ 的方差。\n\n样本均值定义为 $\\bar{X}_N = \\frac{1}{N}\\sum_{t=1}^{N}X_t$。其方差由下式给出：\n$$\n\\mathrm{var}(\\bar{X}_N) = \\mathrm{var}\\left(\\frac{1}{N}\\sum_{t=1}^{N}X_t\\right) = \\frac{1}{N^2}\\mathrm{var}\\left(\\sum_{t=1}^{N}X_t\\right)\n$$\n随机变量之和的方差是其协方差矩阵中所有元素的总和：\n$$\n\\mathrm{var}\\left(\\sum_{t=1}^{N}X_t\\right) = \\sum_{i=1}^{N}\\sum_{j=1}^{N}\\mathrm{cov}(X_i, X_j)\n$$\n由于 MCMC 链是平稳的，协方差 $\\mathrm{cov}(X_i, X_j)$ 仅取决于时间滞后 $k = |i-j|$。这就是自协方差函数 $\\gamma_k = \\mathrm{cov}(X_t, X_{t+k})$。注意，根据定义，$\\gamma_0 = \\mathrm{var}(X_t) = \\sigma^2$，且由于平稳性，$\\gamma_k = \\gamma_{-k}$。\n将 $\\gamma_{|i-j|}$ 代入样本均值方差的二重求和中：\n$$\n\\mathrm{var}(\\bar{X}_N) = \\frac{1}{N^2}\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\gamma_{|i-j|}\n$$\n我们可以通过将具有相同滞后 $k$ 的项分组来计算这个和。\n对于滞后 $k=0$，有 $N$ 个 $i=j$ 的项，每项贡献 $\\gamma_0$。\n对于任意滞后 $k \\in \\{1, 2, \\dots, N-1\\}$，存在 $2(N-k)$ 对 $(i,j)$ 使得 $|i-j|=k$。这些项中的每一项都贡献 $\\gamma_k$。\n因此，该和可以写为：\n$$\n\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\gamma_{|i-j|} = N\\gamma_0 + \\sum_{k=1}^{N-1} 2(N-k)\\gamma_k\n$$\n将此代回 $\\mathrm{var}(\\bar{X}_N)$ 的表达式中：\n$$\n\\mathrm{var}(\\bar{X}_N) = \\frac{1}{N^2}\\left(N\\gamma_0 + 2\\sum_{k=1}^{N-1}(N-k)\\gamma_k\\right) = \\frac{\\gamma_0}{N} + \\frac{2}{N^2}\\sum_{k=1}^{N-1}(N-k)\\gamma_k\n$$\n提出因子 $\\frac{\\gamma_0}{N}$ 并使用自相关序列的定义 $\\rho_k = \\gamma_k/\\gamma_0$：\n$$\n\\mathrm{var}(\\bar{X}_N) = \\frac{\\sigma^2}{N}\\left(1 + \\frac{2}{\\gamma_0}\\sum_{k=1}^{N-1}\\frac{N-k}{N}\\gamma_k\\right) = \\frac{\\sigma^2}{N}\\left(1 + 2\\sum_{k=1}^{N-1}\\left(1-\\frac{k}{N}\\right)\\rho_k\\right)\n$$\n在大 $N$ 极限下，对于 $\\rho_k$ 不可忽略的滞后 $k \\ll N$，因子 $(1-k/N) \\approx 1$。此外，由于假设 $\\rho_k$ 快速衰减，该和可以扩展到无穷大而误差可忽略不计。这就得到了样本均值方差的大 $N$ 表达式：\n$$\n\\mathrm{var}(\\bar{X}_N) \\approx \\frac{\\sigma^2}{N}\\left(1 + 2\\sum_{k=1}^{\\infty}\\rho_k\\right)\n$$\n问题通过关系式 $\\mathrm{var}(\\bar{X}_N) = \\frac{\\sigma^2 \\tau_{\\mathrm{int}}}{N}$（在大 $N$ 极限下）定义了积分自相关时间 $\\tau_{\\mathrm{int}}$。通过将其与我们推导的表达式进行比较，我们确定 $\\tau_{\\mathrm{int}}$ 为：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2\\sum_{k=1}^{\\infty}\\rho_k\n$$\n有效样本量 $N_{\\mathrm{eff}}$ 由 $\\mathrm{var}(\\bar{X}_N) = \\frac{\\sigma^2}{N_{\\mathrm{eff}}}$ 定义。令方差的两个表达式相等，得到 $\\frac{\\sigma^2 \\tau_{\\mathrm{int}}}{N} = \\frac{\\sigma^2}{N_{\\mathrm{eff}}}$，从而得出：\n$$\nN_{\\mathrm{eff}} = \\frac{N}{\\tau_{\\mathrm{int}}}\n$$\n现在我们为特定的自相关模型 $\\rho_k = r^k$（其中 $|r|1$）计算 $\\tau_{\\mathrm{int}}$ 和 $N_{\\mathrm{eff}}$。我们将其代入 $\\tau_{\\mathrm{int}}$ 的表达式中：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2\\sum_{k=1}^{\\infty}r^k\n$$\n该和是一个无穷几何级数：$\\sum_{k=1}^{\\infty}r^k = \\frac{r}{1-r}$。代入此结果：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2\\left(\\frac{r}{1-r}\\right) = \\frac{1-r+2r}{1-r} = \\frac{1+r}{1-r}\n$$\n这是 $\\tau_{\\mathrm{int}}$ 作为 $r$ 的函数的闭式表达式。\n利用这一点，我们得到 $N_{\\mathrm{eff}}$ 的表达式：\n$$\nN_{\\mathrm{eff}} = \\frac{N}{\\tau_{\\mathrm{int}}} = \\frac{N}{(1+r)/(1-r)} = N \\frac{1-r}{1+r}\n$$\n这是 $N_{\\mathrm{eff}}$ 作为 $r$ 和 $N$ 的函数的闭式表达式。\n\n定性地看，参数 $r$ 控制了 MCMC 估计量的抽样效率和收敛性。在典型的 MCMC 应用中，相关性是正的，因此我们考虑 $r \\in [0, 1)$。\n均值的方差为 $\\mathrm{var}(\\bar{X}_N) = \\frac{\\sigma^2}{N}\\tau_{\\mathrm{int}} = \\frac{\\sigma^2}{N}\\frac{1+r}{1-r}$。\n- 如果 $r \\to 0$，则 $\\tau_{\\mathrm{int}} \\to 1$ 且 $\\mathrm{var}(\\bar{X}_N) \\to \\sigma^2/N$。样本是有效独立的，这是大小为 $N$ 的独立同分布（i.i.d.）样本的方差。\n- 如果 $r \\to 1^-$，则 $\\tau_{\\mathrm{int}} \\to \\infty$。连续样本之间的高度相关性意味着每个新样本提供的新信息非常少。这会显著地增大样本均值的方差。\n\n估计量 $\\bar{X}_N$ 收敛到真实均值 $\\mu$ 的速度取决于其方差随 $N$ 减小的速率。估计的误差与 $1/\\sqrt{N_{\\mathrm{eff}}}$ 成正比。由于 $N_{\\mathrm{eff}} = N(1-r)/(1+r)$，一个接近 1 的 $r$ 值会急剧减少有效样本量，使得 $N_{\\mathrm{eff}} \\ll N$。为了达到期望的精度（即小方差），需要一定的 $N_{\\mathrm{eff}}$。由于 $N = N_{\\mathrm{eff}} \\tau_{\\mathrm{int}}$，较大的 $r$ 意味着较大的 $\\tau_{\\mathrm{int}}$，这反过来又需要大得多的总样本数 $N$。因此，更高的自相关性（更大的 $r$）会导致 MCMC 估计量的收敛速度变慢。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1+r}{1-r}  N \\frac{1-r}{1+r} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在宇宙学参数推断中，后验分布常常呈现多个峰值（即多模态），这会“困住”标准的 MCMC 采样器，使其无法充分探索整个参数空间。并行回火是一种强大的高级技巧，它通过在不同“温度”下运行多个链来解决这个问题，允许采样器“跳出”局部极值。这个练习将带你推导并计算并行回火中的关键步骤——状态交换的接受概率。",
            "id": "3478677",
            "problem": "数值宇宙学的一个普遍特征是参数后验分布的多峰性，例如在拟合宇宙微波背景（CMB）的简并模型时。考虑一个一维宇宙学玩具参数 $\\theta$，其双峰后验势由 $U(\\theta)=a(\\theta^{2}-1)^{2}$ 给出，这定义了未回火的后验分布 $\\pi(\\theta)\\propto \\exp(-U(\\theta))$。为加速跨模态的探索，我们采用一个双副本并行回火马尔可夫链蒙特卡洛（MCMC）方案，其中副本 $i$ 在逆温度 $\\beta_{i}$ 下，以回火后验 $\\pi_{i}(\\theta)\\propto \\exp(-\\beta_{i}U(\\theta))$ 为目标分布。\n\n从联合目标分布 $\\pi_{1}(\\theta_{1})\\pi_{2}(\\theta_{2})$ 的细致平衡第一性原理出发，推导交换两个副本状态的交换提议 $(\\theta_{1},\\theta_{2})\\mapsto (\\theta_{2},\\theta_{1})$ 的Metropolis接受概率。然后，针对以下科学上合理的配置，显式计算该接受概率：\n- 双势阱振幅为 $a=1.7$。\n- 逆温度为 $\\beta_{1}=3.0$（冷链）和 $\\beta_{2}=0.5$（热链）。\n- 当前状态为 $\\theta_{1}=-1.1$（靠近势阱最小值）和 $\\theta_{2}=0.2$（靠近势垒）。\n\n从基本定义和细致平衡出发进行所有推导，不要使用预先记忆的交换公式。将最终的交换接受概率表示为小数，并四舍五入至四位有效数字。概率值无需物理单位。",
            "solution": "该问题提法恰当，具有科学依据，并提供了推导和计算并行回火MCMC方案中交换接受概率所需的所有信息。因此，该问题是有效的。\n\n马尔可夫链蒙特卡洛（MCMC）方法的核心原理是构建一个马尔可夫链，使其稳态分布为目标概率分布 $\\pi(x)$。确保这一点的充分条件是细致平衡原理，该原理指出，对于任意两个状态 $x$ 和 $x'$，在平衡状态下，从 $x$ 到 $x'$ 的跃迁速率必须等于从 $x'$ 到 $x$ 的跃迁速率：\n$$ \\pi(x) P(x \\to x') = \\pi(x') P(x' \\to x) $$\n其中 $P(x \\to x')$ 是跃迁概率。\n\n在Metropolis-Hastings算法中，跃迁概率被分解为一个提议概率 $g(x'|x)$ 和一个接受概率 $\\alpha(x'|x)$，使得对于 $x \\neq x'$，$P(x \\to x') = g(x'|x) \\alpha(x'|x)$。接受概率被定义为满足细致平衡：\n$$ \\alpha(x'|x) = \\min\\left(1, \\frac{\\pi(x') g(x|x')}{\\pi(x) g(x'|x)}\\right) $$\n\n在此问题中，系统的状态是来自两个副本的参数值对，$x = (\\theta_1, \\theta_2)$。这个扩展系综的联合目标分布是各个回火后验的乘积，因为副本是独立的：\n$$ \\pi(x) = \\pi(\\theta_1, \\theta_2) = \\pi_1(\\theta_1) \\pi_2(\\theta_2) $$\n给定 $\\pi_i(\\theta) \\propto \\exp(-\\beta_i U(\\theta))$。令 $Z_i$ 为副本 $i$ 的归一化常数，我们可以写出 $\\pi_i(\\theta) = \\frac{1}{Z_i} \\exp(-\\beta_i U(\\theta))$。因此，联合分布为：\n$$ \\pi(\\theta_1, \\theta_2) = \\frac{1}{Z_1 Z_2} \\exp(-\\beta_1 U(\\theta_1) - \\beta_2 U(\\theta_2)) $$\n\n提议的移动是交换两个副本之间的状态。当前状态为 $x = (\\theta_1, \\theta_2)$，提议的状态为 $x' = (\\theta_2, \\theta_1)$。此交换的提议分布 $g(x'|x) = g((\\theta_2, \\theta_1)|(\\theta_1, \\theta_2))$ 与逆向提议 $g(x|x') = g((\\theta_1, \\theta_2)|(\\theta_2, \\theta_1))$ 是对称的，因为无论方向如何，交换副本1和2的状态都是相同的操作。因此，提议概率之比为 $g(x|x')/g(x'|x) = 1$。接受概率简化为Metropolis形式：\n$$ \\alpha(x'|x) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x)}\\right) = \\min\\left(1, \\frac{\\pi(\\theta_2, \\theta_1)}{\\pi(\\theta_1, \\theta_2)}\\right) $$\n\n现在，我们将联合分布的表达式代入此比率：\n$$ \\frac{\\pi(\\theta_2, \\theta_1)}{\\pi(\\theta_1, \\theta_2)} = \\frac{\\pi_1(\\theta_2) \\pi_2(\\theta_1)}{\\pi_1(\\theta_1) \\pi_2(\\theta_2)} = \\frac{\\frac{1}{Z_1}\\exp(-\\beta_1 U(\\theta_2)) \\cdot \\frac{1}{Z_2}\\exp(-\\beta_2 U(\\theta_1))}{\\frac{1}{Z_1}\\exp(-\\beta_1 U(\\theta_1)) \\cdot \\frac{1}{Z_2}\\exp(-\\beta_2 U(\\theta_2))} $$\n归一化常数 $Z_1$ 和 $Z_2$ 被消去，剩下：\n$$ \\frac{\\pi(\\theta_2, \\theta_1)}{\\pi(\\theta_1, \\theta_2)} = \\frac{\\exp(-\\beta_1 U(\\theta_2) - \\beta_2 U(\\theta_1))}{\\exp(-\\beta_1 U(\\theta_1) - \\beta_2 U(\\theta_2))} $$\n使用性质 $\\exp(A)/\\exp(B) = \\exp(A-B)$，我们得到：\n$$ \\frac{\\pi(\\theta_2, \\theta_1)}{\\pi(\\theta_1, \\theta_2)} = \\exp\\left( (-\\beta_1 U(\\theta_2) - \\beta_2 U(\\theta_1)) - (-\\beta_1 U(\\theta_1) - \\beta_2 U(\\theta_2)) \\right) $$\n$$ = \\exp\\left( -\\beta_1 U(\\theta_2) - \\beta_2 U(\\theta_1) + \\beta_1 U(\\theta_1) + \\beta_2 U(\\theta_2) \\right) $$\n按 $U(\\theta_1)$ 和 $U(\\theta_2)$ 合并项：\n$$ = \\exp\\left( (\\beta_1 - \\beta_2) U(\\theta_1) - (\\beta_1 - \\beta_2) U(\\theta_2) \\right) $$\n提取公因子 $(\\beta_1 - \\beta_2)$：\n$$ = \\exp\\left( (\\beta_1 - \\beta_2)(U(\\theta_1) - U(\\theta_2)) \\right) $$\n这也可以写成 $\\exp((\\beta_2 - \\beta_1)(U(\\theta_2) - U(\\theta_1)))$。我们定义 $\\Delta = (\\beta_1 - \\beta_2)(U(\\theta_1) - U(\\theta_2))$。交换接受概率为：\n$$ \\alpha = \\min(1, \\exp(\\Delta)) $$\n这就完成了从第一性原理出发的推导。\n\n接下来，我们用给定的数值计算这个概率：\n- 势函数：$U(\\theta) = a(\\theta^2-1)^2$，$a=1.7$。\n- 逆温度：$\\beta_1 = 3.0$ 和 $\\beta_2 = 0.5$。\n- 当前状态：$\\theta_1 = -1.1$ 和 $\\theta_2 = 0.2$。\n\n首先，计算每个状态的势能 $U(\\theta)$。\n对于 $\\theta_1 = -1.1$：\n$$ U(\\theta_1) = 1.7 \\times ((-1.1)^2 - 1)^2 = 1.7 \\times (1.21 - 1)^2 = 1.7 \\times (0.21)^2 $$\n$$ U(\\theta_1) = 1.7 \\times 0.0441 = 0.07497 $$\n对于 $\\theta_2 = 0.2$：\n$$ U(\\theta_2) = 1.7 \\times ((0.2)^2 - 1)^2 = 1.7 \\times (0.04 - 1)^2 = 1.7 \\times (-0.96)^2 $$\n$$ U(\\theta_2) = 1.7 \\times 0.9216 = 1.56672 $$\n\n现在，计算指数 $\\Delta$：\n$$ \\Delta = (\\beta_1 - \\beta_2)(U(\\theta_1) - U(\\theta_2)) $$\n$$ \\beta_1 - \\beta_2 = 3.0 - 0.5 = 2.5 $$\n$$ U(\\theta_1) - U(\\theta_2) = 0.07497 - 1.56672 = -1.49175 $$\n$$ \\Delta = (2.5) \\times (-1.49175) = -3.729375 $$\n\n最后，计算接受概率 $\\alpha$：\n$$ \\alpha = \\min(1, \\exp(-3.729375)) $$\n因为指数是负数，所以 $\\exp(-3.729375)$ 小于 $1$。因此：\n$$ \\alpha = \\exp(-3.729375) \\approx 0.024009848 $$\n题目要求答案保留四位有效数字。前四位有效数字是 $2$、$4$、$0$、$0$。第五位有效数字是 $9$，所以我们对第四位进行进位。\n$$ \\alpha \\approx 0.02401 $$\n这是冷链（靠近势能最小值）和热链（靠近势垒）之间状态交换被接受的概率。",
            "answer": "$$\n\\boxed{0.02401}\n$$"
        }
    ]
}