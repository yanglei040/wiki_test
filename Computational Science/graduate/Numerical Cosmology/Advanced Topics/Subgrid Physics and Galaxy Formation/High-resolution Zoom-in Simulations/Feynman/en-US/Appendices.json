{
    "hands_on_practices": [
        {
            "introduction": "The first step in any cosmological simulation is to generate valid initial conditions, typically at a high redshift where density fluctuations are small and well-described by linear theory. This exercise explores the Zel'dovich approximation, a cornerstone of first-order Lagrangian perturbation theory, which connects the initial power spectrum of density fluctuations to the displacements of simulation particles. By calculating the required starting redshift to ensure these displacements remain small, you will practice applying a fundamental constraint that underpins the validity of the entire subsequent simulation .",
            "id": "3475493",
            "problem": "You are constructing initial conditions for a high-resolution zoom-in region in a cosmological simulation using the first-order Lagrangian perturbation theory, also known as the Zel’dovich approximation (ZA). Let the comoving linear matter power spectrum at redshift $z=0$ be modeled over the wavenumber band relevant for the high-resolution region by\n$$\nP(k,0) \\equiv P_{0}(k) = A\\,k^{-3},\n$$\nwith $A = \\pi^{2}$, so that the dimensionless power $\\Delta^{2}(k) \\equiv k^{3}P(k)/(2\\pi^{2})$ is constant and equal to $1/2$ over this band. Assume the high-resolution region is a periodic cube of comoving side length $L_{\\mathrm{hr}} = 10\\,h^{-1}\\,\\mathrm{Mpc}$ populated at an effective particle load of $N_{\\mathrm{eff}} = 512^{3}$, so that the interparticle spacing is $d = \\Delta x_{\\mathrm{hr}} = L_{\\mathrm{hr}}/512$. Use the fundamental mode $k_{\\min} = 2\\pi/L_{\\mathrm{hr}}$ and Nyquist mode $k_{\\max} = \\pi/\\Delta x_{\\mathrm{hr}}$ as sharp integration limits for power contributing to particle displacements in the high-resolution region.\n\nIn the Zel’dovich approximation, the linear Lagrangian displacement field $\\boldsymbol{\\psi}$ satisfies in Fourier space $\\boldsymbol{\\psi}(\\boldsymbol{k},z) = i\\,\\boldsymbol{k}\\,\\delta(\\boldsymbol{k},z)/k^{2}$, where $\\delta$ is the linear overdensity. Define the one-dimensional root-mean-square (RMS) particle displacement $\\sigma_{\\mathrm{disp}}(z)$ as the square root of the variance of a single Cartesian component of $\\boldsymbol{\\psi}$.\n\nAt high redshift, take the growth factor to be that of an Einstein–de Sitter universe, $D(z) = 1/(1+z)$, normalized to $D(0)=1$, so that $P(k,z) = D^{2}(z) P_{0}(k)$. Starting only from these definitions and fundamental relations, derive an expression for $\\sigma_{\\mathrm{disp}}(z)$ in terms of $P(k,z)$, evaluate it for the given $P_{0}(k)$ and band-limits $k_{\\min}$ to $k_{\\max}$, and then determine the minimal start redshift $z_{\\mathrm{start}}$ that ensures the one-dimensional RMS displacement satisfies\n$$\n\\sigma_{\\mathrm{disp}}(z_{\\mathrm{start}}) < 0.3\\,d\n$$\nin the high-resolution region. Express $z_{\\mathrm{start}}$ as a pure number and round your answer to three significant figures.",
            "solution": "The objective is to find the minimal starting redshift $z_{\\mathrm{start}}$ for a cosmological simulation, such that the one-dimensional root-mean-square (RMS) particle displacement, $\\sigma_{\\mathrm{disp}}(z_{\\mathrm{start}})$, is less than $0.3$ times the interparticle spacing, $d$.\n\nFirst, we must derive a general expression for $\\sigma_{\\mathrm{disp}}(z)$. By definition, it is the square root of the variance of a single Cartesian component of the Lagrangian displacement field $\\boldsymbol{\\psi}$. Let's consider the x-component, $\\psi_x$. The variance is the spatial average of the squared component:\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\langle \\psi_x^2(\\boldsymbol{x}, z) \\rangle\n$$\nDue to statistical isotropy of the cosmological random fields, the variance is the same for each component: $\\langle \\psi_x^2 \\rangle = \\langle \\psi_y^2 \\rangle = \\langle \\psi_z^2 \\rangle$. Therefore, the variance of one component is one-third of the total variance of the displacement vector:\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{1}{3} \\langle |\\boldsymbol{\\psi}(\\boldsymbol{x}, z)|^2 \\rangle\n$$\nUsing Parseval's theorem, we can express the real-space variance as an integral over Fourier space. The total variance of the displacement field is related to the power spectrum of the density field, $P(k,z)$. The Zel'dovich approximation relates the displacement field $\\boldsymbol{\\psi}$ to the density overdensity $\\delta$ in Fourier space as $\\boldsymbol{\\psi}(\\boldsymbol{k},z) = i\\,\\boldsymbol{k}\\,\\delta(\\boldsymbol{k},z)/k^{2}$.\nThe power spectrum of the displacement field itself, $P_{\\psi}(k)$, is related to the density power spectrum $P(k)$ via this relation. For a longitudinal field like $\\boldsymbol{\\psi}$, its three-dimensional variance is given by:\n$$\n\\langle |\\boldsymbol{\\psi}(\\boldsymbol{x}, z)|^2 \\rangle = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} P(k,z) dk\n$$\nCombining these results, the one-dimensional displacement variance is:\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{1}{3} \\langle |\\boldsymbol{\\psi}(\\boldsymbol{x}, z)|^2 \\rangle = \\frac{1}{6\\pi^2} \\int_{k_{\\min}}^{k_{\\max}} P(k,z) dk\n$$\nThe problem specifies sharp integration limits from the fundamental mode $k_{\\min}$ to the Nyquist mode $k_{\\max}$.\n\nThe power spectrum's time evolution is given by $P(k,z) = D^2(z) P_0(k)$, where $P_0(k) = A k^{-3}$ with $A = \\pi^2$ and $D(z) = 1/(1+z)$ for an Einstein-de Sitter universe. Substituting these into the expression for $\\sigma_{\\mathrm{disp}}^2(z)$:\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{D^2(z)}{6\\pi^2} \\int_{k_{\\min}}^{k_{\\max}} A k^{-3} dk\n$$\nWe perform the integration:\n$$\n\\int_{k_{\\min}}^{k_{\\max}} A k^{-3} dk = A \\left[ -\\frac{1}{2k^2} \\right]_{k_{\\min}}^{k_{\\max}} = A \\left( -\\frac{1}{2k_{\\max}^2} - \\left(-\\frac{1}{2k_{\\min}^2}\\right) \\right) = \\frac{A}{2} \\left( \\frac{1}{k_{\\min}^2} - \\frac{1}{k_{\\max}^2} \\right)\n$$\nSubstituting this back into the variance expression with $A=\\pi^2$:\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{D^2(z)}{6\\pi^2} \\cdot \\frac{\\pi^2}{2} \\left( \\frac{1}{k_{\\min}^2} - \\frac{1}{k_{\\max}^2} \\right) = \\frac{D^2(z)}{12} \\left( \\frac{1}{k_{\\min}^2} - \\frac{1}{k_{\\max}^2} \\right)\n$$\nNext, we determine the values of the integration limits, $k_{\\min}$ and $k_{\\max}$, and the interparticle spacing $d$.\nGiven the comoving side length $L_{\\mathrm{hr}} = 10\\,h^{-1}\\,\\mathrm{Mpc}$ and effective particle number $N_{\\mathrm{eff}} = 512^3$:\nThe fundamental mode is $k_{\\min} = \\frac{2\\pi}{L_{\\mathrm{hr}}}$.\nThe interparticle spacing is $d = \\Delta x_{\\mathrm{hr}} = \\frac{L_{\\mathrm{hr}}}{512}$.\nThe Nyquist mode is $k_{\\max} = \\frac{\\pi}{\\Delta x_{\\mathrm{hr}}} = \\frac{\\pi}{d} = \\frac{512\\pi}{L_{\\mathrm{hr}}}$.\nThe ratio of the wavenumbers is $\\frac{k_{\\max}}{k_{\\min}} = \\frac{512\\pi/L_{\\mathrm{hr}}}{2\\pi/L_{\\mathrm{hr}}} = \\frac{512}{2} = 256$.\nWe can express $d$ in terms of $k_{\\min}$: $d = \\frac{L_{\\mathrm{hr}}}{512} = \\frac{2\\pi/k_{\\min}}{512} = \\frac{\\pi}{256 k_{\\min}}$.\n\nThe condition to be satisfied is $\\sigma_{\\mathrm{disp}}(z_{\\mathrm{start}}) < 0.3\\,d$. To find the minimal redshift, we solve for the boundary case:\n$$\n\\sigma_{\\mathrm{disp}}(z_{\\mathrm{start}}) = 0.3\\,d\n$$\nSquaring both sides gives:\n$$\n\\sigma_{\\mathrm{disp}}^2(z_{\\mathrm{start}}) = (0.3\\,d)^2 = 0.09\\,d^2\n$$\nNow we equate our two expressions for the variance. First, we rewrite the variance in terms of $k_{\\min}$ and the ratio $k_{\\max}/k_{\\min}$:\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{D^2(z)}{12} \\frac{1}{k_{\\min}^2} \\left( 1 - \\left(\\frac{k_{\\min}}{k_{\\max}}\\right)^2 \\right) = \\frac{D^2(z)}{12 k_{\\min}^2} \\left( 1 - \\frac{1}{256^2} \\right)\n$$\nAnd we express the condition in terms of $k_{\\min}$:\n$$\n0.09\\,d^2 = 0.09 \\left( \\frac{\\pi}{256 k_{\\min}} \\right)^2 = \\frac{0.09\\,\\pi^2}{256^2 k_{\\min}^2}\n$$\nEquating the two expressions at $z=z_{\\mathrm{start}}$:\n$$\n\\frac{D^2(z_{\\mathrm{start}})}{12 k_{\\min}^2} \\left( 1 - \\frac{1}{256^2} \\right) = \\frac{0.09\\,\\pi^2}{256^2 k_{\\min}^2}\n$$\nCancel the $k_{\\min}^2$ term from both sides and simplify:\n$$\n\\frac{D^2(z_{\\mathrm{start}})}{12} \\left( \\frac{256^2 - 1}{256^2} \\right) = \\frac{0.09\\,\\pi^2}{256^2}\n$$\n$$\nD^2(z_{\\mathrm{start}}) \\frac{256^2 - 1}{12} = 0.09\\,\\pi^2\n$$\nNow, we solve for $D^2(z_{\\mathrm{start}})$:\n$$\nD^2(z_{\\mathrm{start}}) = \\frac{12 \\times 0.09 \\times \\pi^2}{256^2 - 1} = \\frac{1.08\\,\\pi^2}{65536 - 1} = \\frac{1.08\\,\\pi^2}{65535}\n$$\nUsing the given growth factor $D(z) = \\frac{1}{1+z}$, we have $D^2(z) = \\frac{1}{(1+z)^2}$.\n$$\n\\frac{1}{(1+z_{\\mathrm{start}})^2} = \\frac{1.08\\,\\pi^2}{65535}\n$$\n$$\n(1+z_{\\mathrm{start}})^2 = \\frac{65535}{1.08\\,\\pi^2}\n$$\nTaking the square root and solving for $z_{\\mathrm{start}}$:\n$$\n1+z_{\\mathrm{start}} = \\sqrt{\\frac{65535}{1.08\\,\\pi^2}}\n$$\n$$\nz_{\\mathrm{start}} = \\sqrt{\\frac{65535}{1.08\\,\\pi^2}} - 1\n$$\nThe inequality $\\sigma_{\\mathrm{disp}}(z) < 0.3\\,d$ implies that $D(z)$ must be smaller than the value at the boundary. Since $D(z)$ is a decreasing function of $z$, this requires $z > z_{\\mathrm{start}}$. Thus, the calculated $z_{\\mathrm{start}}$ represents the minimum required redshift.\n\nFinally, we compute the numerical value:\n$$\nz_{\\mathrm{start}} = \\sqrt{\\frac{65535}{1.08 \\times (3.14159...)^2}} - 1 \\approx \\sqrt{\\frac{65535}{1.08 \\times 9.8696044}} - 1\n$$\n$$\nz_{\\mathrm{start}} \\approx \\sqrt{\\frac{65535}{10.6591728}} - 1 \\approx \\sqrt{6148.240} - 1\n$$\n$$\nz_{\\mathrm{start}} \\approx 78.4107 - 1 = 77.4107\n$$\nRounding to three significant figures, the minimal start redshift is $77.4$.",
            "answer": "$$\n\\boxed{77.4}\n$$"
        },
        {
            "introduction": "Adaptive Mesh Refinement (AMR) is a key technique in zoom-in simulations for concentrating computational effort on dense regions like forming galaxies, but this variable resolution must be carefully controlled to avoid numerical artifacts. This practice is centered on the Jeans instability, a fundamental concept describing the gravitational collapse of a fluid, and the associated \"Jeans criterion\" used to prevent artificial fragmentation by ensuring the simulation's resolution adequately resolves the local Jeans length. By deriving the required cell size for a model galactic disk, you will learn how to translate a physical stability criterion into a practical numerical requirement, a crucial skill for simulating structure formation .",
            "id": "3475513",
            "problem": "You are setting resolution targets for an Adaptive Mesh Refinement (AMR) high-resolution zoom-in simulation of a star-forming gas disk at redshift $z=2$. To prevent artificial fragmentation and to faithfully capture gravitational instability, you will enforce a fixed Jeans number $N_J=8$ everywhere within the inner $10\\,\\mathrm{kpc}$ of the disk. The Jeans number $N_J$ is defined as the ratio of the local characteristic Jeans length to the local numerical cell size. The disk is approximately isothermal with a radially varying effective sound speed and a midplane density that declines with radius. Assume the following radially dependent profiles for radius $R$ in the range $0 \\le R \\le 10\\,\\mathrm{kpc}$:\n- Effective sound speed: $c_s(R) = c_{s,0}\\left(1 + \\frac{R}{R_c}\\right)^{1/4}$,\n- Midplane mass density: $\\rho(R) = \\rho_0 \\exp\\!\\left(-\\frac{R}{R_d}\\right)$,\nwith constants $c_{s,0} = 15\\,\\mathrm{km\\,s^{-1}}$, $R_c = 2\\,\\mathrm{kpc}$, $\\rho_0 = 5 \\times 10^{-23}\\,\\mathrm{g\\,cm^{-3}}$, and $R_d = 3\\,\\mathrm{kpc}$. Use the gravitational constant $G = 6.6743 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$ and the conversion $1\\,\\mathrm{pc} = 3.0857 \\times 10^{18}\\,\\mathrm{cm}$.\n\nStarting from the fundamental linear stability analysis of a self-gravitating isothermal medium and the definition of the Jeans number, derive the resolution requirement and compute the minimum uniform AMR target cell size $\\Delta x_{\\mathrm{target}}$ that guarantees $N_J=8$ at all radii $R \\le 10\\,\\mathrm{kpc}$. Express your final answer in $\\mathrm{pc}$ and round to three significant figures.",
            "solution": "The problem requires the determination of the minimum uniform target cell size, $\\Delta x_{\\mathrm{target}}$, for an Adaptive Mesh Refinement (AMR) simulation. This cell size must ensure that the Jeans number, $N_J$, is maintained at a value of $8$ throughout the inner $10\\,\\mathrm{kpc}$ of a simulated star-forming gas disk. The Jeans number is the ratio of the local Jeans length, $\\lambda_J$, to the local cell size, $\\Delta x$.\n\nFirst, we begin with the fundamental definition of the Jeans length. The Jeans length arises from a linear stability analysis of a self-gravitating, isothermal fluid. The dispersion relation for perturbations in such a medium is given by:\n$$ \\omega^2 = c_s^2 k^2 - 4\\pi G \\rho $$\nwhere $\\omega$ is the angular frequency of the perturbation, $k$ is its wavenumber, $c_s$ is the isothermal sound speed, $G$ is the gravitational constant, and $\\rho$ is the mass density of the fluid. Gravitational instability occurs when $\\omega^2 < 0$, which leads to exponential growth of the perturbation. The critical wavenumber, known as the Jeans wavenumber $k_J$, below which the system is unstable, is found by setting $\\omega^2 = 0$:\n$$ c_s^2 k_J^2 = 4\\pi G \\rho \\implies k_J = \\frac{\\sqrt{4\\pi G \\rho}}{c_s} $$\nThe Jeans length, $\\lambda_J$, is the wavelength corresponding to this critical wavenumber, defined as $\\lambda_J = 2\\pi/k_J$. Substituting the expression for $k_J$, we obtain:\n$$ \\lambda_J = \\frac{2\\pi c_s}{\\sqrt{4\\pi G \\rho}} = c_s \\sqrt{\\frac{\\pi}{G\\rho}} $$\nThis analysis is performed locally at each radius $R$ in the disk, so $\\lambda_J$, $c_s$, and $\\rho$ are functions of $R$.\n$$ \\lambda_J(R) = c_s(R) \\sqrt{\\frac{\\pi}{G\\rho(R)}} $$\nThe problem states that the Jeans number, $N_J = \\lambda_J / \\Delta x$, must be fixed at $N_J=8$ to properly resolve gravitational instabilities and prevent artificial fragmentation. The required local cell size, $\\Delta x(R)$, is therefore:\n$$ \\Delta x(R) = \\frac{\\lambda_J(R)}{N_J} = \\frac{c_s(R)}{N_J} \\sqrt{\\frac{\\pi}{G\\rho(R)}} $$\nThe simulation must be capable of reaching this resolution at any radius $R$ within the specified domain, $0 \\le R \\le 10\\,\\mathrm{kpc}$. The \"minimum uniform AMR target cell size,\" $\\Delta x_{\\mathrm{target}}$, refers to the smallest cell size the simulation must be able to achieve. This is determined by the most stringent requirement, which corresponds to the minimum value of $\\Delta x(R)$ over the domain of interest.\n$$ \\Delta x_{\\mathrm{target}} = \\min_{R \\in [0, 10\\,\\mathrm{kpc}]} \\Delta x(R) $$\nWe are given the radial profiles for the effective sound speed $c_s(R)$ and the midplane mass density $\\rho(R)$:\n$$ c_s(R) = c_{s,0}\\left(1 + \\frac{R}{R_c}\\right)^{1/4} $$\n$$ \\rho(R) = \\rho_0 \\exp\\left(-\\frac{R}{R_d}\\right) $$\nSubstituting these expressions into the equation for $\\Delta x(R)$:\n$$ \\Delta x(R) = \\frac{1}{N_J} \\sqrt{\\frac{\\pi}{G}} \\frac{c_{s,0}\\left(1 + \\frac{R}{R_c}\\right)^{1/4}}{\\sqrt{\\rho_0 \\exp\\left(-\\frac{R}{R_d}\\right)}} $$\n$$ \\Delta x(R) = \\left(\\frac{c_{s,0}}{N_J} \\sqrt{\\frac{\\pi}{G\\rho_0}}\\right) \\left(1 + \\frac{R}{R_c}\\right)^{1/4} \\exp\\left(\\frac{R}{2R_d}\\right) $$\nTo find the minimum of $\\Delta x(R)$, we can analyze the behavior of its radially-dependent part, which is the function $f(R) = \\left(1 + \\frac{R}{R_c}\\right)^{1/4} \\exp\\left(\\frac{R}{2R_d}\\right)$. The constants $R_c$ and $R_d$ are positive, so for the domain $R \\ge 0$, the term $\\left(1 + \\frac{R}{R_c}\\right)^{1/4}$ is a strictly increasing function of $R$. The term $\\exp\\left(\\frac{R}{2R_d}\\right)$ is also a strictly increasing function of $R$. The product of two positive, strictly increasing functions is itself a strictly increasing function. Therefore, $\\Delta x(R)$ is a monotonically increasing function of $R$ for $R \\ge 0$.\n\nThe minimum value of $\\Delta x(R)$ on the interval $[0, 10\\,\\mathrm{kpc}]$ must occur at the lower bound, $R=0$.\n$$ \\Delta x_{\\mathrm{target}} = \\Delta x(0) = \\left(\\frac{c_{s,0}}{N_J} \\sqrt{\\frac{\\pi}{G\\rho_0}}\\right) \\left(1 + 0\\right)^{1/4} \\exp\\left(0\\right) $$\n$$ \\Delta x_{\\mathrm{target}} = \\frac{c_{s,0}}{N_J} \\sqrt{\\frac{\\pi}{G\\rho_0}} $$\nNow, we substitute the given numerical values into this expression. First, we must ensure all values are in a consistent unit system, for which we choose the cgs system ($\\mathrm{cm}$, $\\mathrm{g}$, $\\mathrm{s}$).\n- $c_{s,0} = 15\\,\\mathrm{km\\,s^{-1}} = 15 \\times 10^5\\,\\mathrm{cm\\,s^{-1}} = 1.5 \\times 10^6\\,\\mathrm{cm\\,s^{-1}}$\n- $N_J = 8$\n- $\\rho_0 = 5 \\times 10^{-23}\\,\\mathrm{g\\,cm^{-3}}$\n- $G = 6.6743 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$\n\nSubstituting these values:\n$$ \\Delta x_{\\mathrm{target}} = \\frac{1.5 \\times 10^6}{8} \\sqrt{\\frac{\\pi}{(6.6743 \\times 10^{-8}) (5 \\times 10^{-23})}} $$\n$$ \\Delta x_{\\mathrm{target}} = (1.875 \\times 10^5) \\sqrt{\\frac{\\pi}{3.33715 \\times 10^{-30}}} \\,\\,\\mathrm{cm} $$\n$$ \\Delta x_{\\mathrm{target}} = (1.875 \\times 10^5) \\sqrt{9.41398 \\times 10^{29}} \\,\\,\\mathrm{cm} $$\n$$ \\Delta x_{\\mathrm{target}} = (1.875 \\times 10^5) (9.70257 \\times 10^{14}) \\,\\,\\mathrm{cm} $$\n$$ \\Delta x_{\\mathrm{target}} = 1.81923 \\times 10^{20} \\,\\,\\mathrm{cm} $$\nThe problem asks for the final answer in parsecs ($\\mathrm{pc}$). We use the conversion factor $1\\,\\mathrm{pc} = 3.0857 \\times 10^{18}\\,\\mathrm{cm}$.\n$$ \\Delta x_{\\mathrm{target}}[\\mathrm{pc}] = \\frac{1.81923 \\times 10^{20}\\,\\mathrm{cm}}{3.0857 \\times 10^{18}\\,\\mathrm{cm\\,pc^{-1}}} $$\n$$ \\Delta x_{\\mathrm{target}}[\\mathrm{pc}] = 58.957... \\,\\,\\mathrm{pc} $$\nRounding the result to three significant figures, we get $59.0\\,\\mathrm{pc}$.",
            "answer": "$$\n\\boxed{59.0}\n$$"
        },
        {
            "introduction": "The results of any numerical simulation are inherently approximate, containing discretization errors that depend on the simulation's resolution. A critical task in computational science is to quantify these errors and demonstrate that results converge toward the true solution as resolution increases. This exercise employs Richardson extrapolation, a powerful technique for estimating the continuum limit of a numerical result and its associated error, given a known convergence order for the numerical scheme. By applying this method to mock simulation data, you will practice a key validation technique used to establish the credibility of numerical predictions and to distinguish physical results from numerical artifacts .",
            "id": "3475543",
            "problem": "In a suite of cosmological high-resolution zoom-in simulations of a Milky Way–mass dark matter halo, you measure the inner logarithmic slope $\\gamma \\equiv -d\\ln \\rho/d\\ln r$ of the spherically averaged dark matter density profile at radius $r = 500\\,\\mathrm{pc}$ within the Lagrangian region. Three nested simulations are performed with uniform refinement ratio $r = 2$ between effective spatial resolutions (cell widths) $h$, $h/2$, and $h/4$. The gravity and hydrodynamics solvers are second-order accurate in space, and you may assume that the leading-order discretization error in $\\gamma$ is an analytic series in even powers of $h$ with dominant term proportional to $h^{2}$. The measured values are\n$\\gamma(h) = 0.85$, $\\gamma(h/2) = 0.953125$, and $\\gamma(h/4) = 0.9876953125$.\nStarting from the definition of truncation error and without invoking any pre-packaged formulas, use Richardson extrapolation with $r = 2$ and second-order spatial accuracy to form an estimate of the continuum limit $\\gamma_{0}$ by consistently combining all three resolutions so that the two leading error orders in $h$ are eliminated. Then, using your continuum estimate, quantify the absolute numerical error of the highest-resolution result, $|\\gamma(h/4) - \\gamma_{0}|$. Express both $\\gamma_{0}$ and the absolute error as dimensionless numbers, and round both to $5$ significant figures.",
            "solution": "The problem requires us to determine the continuum limit, $\\gamma_{0}$, of a numerically measured quantity, $\\gamma$, using data from three simulations with successively refined spatial resolution. We must then calculate the absolute error of the highest-resolution measurement. The method to be used is Richardson extrapolation, derived from the provided form of the numerical error.\n\nThe problem states that the measured logarithmic slope, $\\gamma$, at a specific radius, converges to the true continuum value, $\\gamma_{0}$, with a discretization error that is an analytic series in even powers of the resolution, $h$. The solver is second-order accurate, so the leading error term is proportional to $h^2$. We are instructed to eliminate the two leading error orders, which implies the error model can be truncated as:\n$$\n\\gamma(h) = \\gamma_{0} + C_{2}h^{2} + C_{4}h^{4} + O(h^{6})\n$$\nwhere $C_{2}$ and $C_{4}$ are constants independent of $h$.\n\nWe are given three measurements from simulations with resolutions $h$, $h/2$, and $h/4$:\n1.  $\\gamma_A \\equiv \\gamma(h) = 0.85$\n2.  $\\gamma_B \\equiv \\gamma(h/2) = 0.953125$\n3.  $\\gamma_C \\equiv \\gamma(h/4) = 0.9876953125$\n\nUsing the error model, we can write a system of three equations, ignoring terms of order $h^{6}$ and higher as they are beyond the scope of the requested correction:\n$$\n\\gamma_A = \\gamma_{0} + C_{2}h^{2} + C_{4}h^{4} \\quad (1)\n$$\n$$\n\\gamma_B = \\gamma_{0} + C_{2}\\left(\\frac{h}{2}\\right)^{2} + C_{4}\\left(\\frac{h}{2}\\right)^{4} = \\gamma_{0} + \\frac{1}{4}C_{2}h^{2} + \\frac{1}{16}C_{4}h^{4} \\quad (2)\n$$\n$$\n\\gamma_C = \\gamma_{0} + C_{2}\\left(\\frac{h}{4}\\right)^{2} + C_{4}\\left(\\frac{h}{4}\\right)^{4} = \\gamma_{0} + \\frac{1}{16}C_{2}h^{2} + \\frac{1}{256}C_{4}h^{4} \\quad (3)\n$$\n\nThe first step of Richardson extrapolation is to eliminate the leading-order error term, $C_{2}h^{2}$. We can do this by combining two pairs of equations.\n\nFirst, we combine equations $(1)$ and $(2)$. To eliminate the $C_{2}h^{2}$ term, we multiply equation $(2)$ by $4$ and subtract equation $(1)$:\n$$\n4\\gamma_B = 4\\gamma_{0} + C_{2}h^{2} + \\frac{4}{16}C_{4}h^{4}\n$$\n$$\n4\\gamma_B - \\gamma_A = (4\\gamma_{0} - \\gamma_{0}) + (C_{2}h^{2} - C_{2}h^{2}) + \\left(\\frac{1}{4}C_{4}h^{4} - C_{4}h^{4}\\right)\n$$\n$$\n4\\gamma_B - \\gamma_A = 3\\gamma_{0} - \\frac{3}{4}C_{4}h^{4}\n$$\nSolving for $\\gamma_{0}$ gives a new, more accurate estimate, which we will call $\\gamma'_{AB}$:\n$$\n\\gamma'_{AB} \\equiv \\frac{4\\gamma_B - \\gamma_A}{3} = \\gamma_{0} - \\frac{1}{4}C_{4}h^{4}\n$$\nThis combination has eliminated the $O(h^{2})$ error, leaving a leading error of order $O(h^{4})$.\n\nNext, we apply the same procedure to equations $(2)$ and $(3)$. We multiply equation $(3)$ by $4$ and subtract equation $(2)$:\n$$\n4\\gamma_C = 4\\gamma_{0} + \\frac{4}{16}C_{2}h^{2} + \\frac{4}{256}C_{4}h^{4}\n$$\n$$\n4\\gamma_C - \\gamma_B = (4\\gamma_{0} - \\gamma_{0}) + \\left(\\frac{1}{4}C_{2}h^{2} - \\frac{1}{4}C_{2}h^{2}\\right) + \\left(\\frac{1}{64}C_{4}h^{4} - \\frac{1}{16}C_{4}h^{4}\\right)\n$$\n$$\n4\\gamma_C - \\gamma_B = 3\\gamma_{0} - \\frac{3}{64}C_{4}h^{4}\n$$\nThis gives a second improved estimate, $\\gamma'_{BC}$:\n$$\n\\gamma'_{BC} \\equiv \\frac{4\\gamma_C - \\gamma_B}{3} = \\gamma_{0} - \\frac{1}{64}C_{4}h^{4}\n$$\nThis estimate also has a leading error of order $O(h^{4})$. Note that the error term is smaller by a factor of $16 = (2)^{4}$, reflecting the use of higher-resolution data.\n\nNow we have two new estimates with $O(h^4)$ error:\n$$\n\\gamma'_{AB} = \\gamma_{0} - \\frac{1}{4}C_{4}h^{4} \\quad (4)\n$$\n$$\n\\gamma'_{BC} = \\gamma_{0} - \\frac{1}{64}C_{4}h^{4} \\quad (5)\n$$\nThe second step of Richardson extrapolation is to combine these two new estimates to eliminate the $C_{4}h^{4}$ term. We multiply equation $(5)$ by $16$ and subtract equation $(4)$:\n$$\n16\\gamma'_{BC} = 16\\gamma_{0} - \\frac{16}{64}C_{4}h^{4} = 16\\gamma_{0} - \\frac{1}{4}C_{4}h^{4}\n$$\n$$\n16\\gamma'_{BC} - \\gamma'_{AB} = (16\\gamma_{0} - \\gamma_{0}) + \\left(-\\frac{1}{4}C_{4}h^{4} - \\left(-\\frac{1}{4}C_{4}h^{4}\\right)\\right)\n$$\n$$\n16\\gamma'_{BC} - \\gamma'_{AB} = 15\\gamma_{0}\n$$\nThis gives our final estimate for the continuum value $\\gamma_{0}$, which is now free from errors of order $h^2$ and $h^4$:\n$$\n\\gamma_{0} = \\frac{16\\gamma'_{BC} - \\gamma'_{AB}}{15}\n$$\nNow, we substitute the numerical values.\nFirst, calculate the intermediate estimates:\n$$\n\\gamma'_{AB} = \\frac{4(0.953125) - 0.85}{3} = \\frac{3.8125 - 0.85}{3} = \\frac{2.9625}{3} = 0.9875\n$$\n$$\n\\gamma'_{BC} = \\frac{4(0.9876953125) - 0.953125}{3} = \\frac{3.95078125 - 0.953125}{3} = \\frac{2.99765625}{3} = 0.99921875\n$$\nNow, calculate the final estimate for $\\gamma_{0}$:\n$$\n\\gamma_{0} = \\frac{16(0.99921875) - 0.9875}{15} = \\frac{15.9875 - 0.9875}{15} = \\frac{15}{15} = 1\n$$\nThe continuum limit for the inner slope is exactly $\\gamma_{0}=1$. To $5$ significant figures, this is $1.0000$.\n\nThe second task is to quantify the absolute numerical error of the highest-resolution result, $|\\gamma(h/4) - \\gamma_{0}|$.\nThe highest-resolution result is $\\gamma_C = \\gamma(h/4) = 0.9876953125$.\nThe absolute error is:\n$$\n|\\gamma(h/4) - \\gamma_{0}| = |0.9876953125 - 1| = |-0.0123046875| = 0.0123046875\n$$\nRounding this value to $5$ significant figures gives $0.012305$.\n\nThe two requested values are the continuum estimate $\\gamma_{0}$ and the absolute error of the highest-resolution measurement, both rounded to $5$ significant figures.\n$\\gamma_{0} \\approx 1.0000$\n$|\\gamma(h/4) - \\gamma_{0}| \\approx 0.012305$",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.0000 & 0.012305 \\end{pmatrix}}$$"
        }
    ]
}