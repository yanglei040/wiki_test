{
    "hands_on_practices": [
        {
            "introduction": "本练习聚焦于准备任何宇宙学N体模拟中的一个关键步骤：设置初始条件。我们将使用泽尔多维奇近似（Zel'dovich approximation），这是一阶拉格朗日微扰理论的基石，来计算粒子相对于均匀网格的位移。通过计算均方根位移随红移的函数，你将确定一个合适的起始红移（$z_{\\text{start}}$），以确保作为初始设置基础的线性理论的有效性 。这项实践将抽象的线性功率谱与模拟设计中一个具体而关键的选择联系起来。",
            "id": "3475493",
            "problem": "您正在使用一阶拉格朗日微扰理论（也称为 Zel’dovich 近似，ZA）为宇宙学模拟中的高分辨率放大区域构建初始条件。设在红移 $z=0$ 时，与高分辨率区域相关的波数范围内的共动线性物质功率谱由以下公式建模：\n$$\nP(k,0) \\equiv P_{0}(k) = A\\,k^{-3},\n$$\n其中 $A = \\pi^{2}$，因此无量纲功率 $\\Delta^{2}(k) \\equiv k^{3}P(k)/(2\\pi^{2})$ 在此波数范围内为常数，等于 $1/2$。假设高分辨率区域是一个共动边长为 $L_{\\mathrm{hr}} = 10\\,h^{-1}\\,\\mathrm{Mpc}$ 的周期性立方体，其有效粒子数为 $N_{\\mathrm{eff}} = 512^{3}$，因此粒子间距为 $d = \\Delta x_{\\mathrm{hr}} = L_{\\mathrm{hr}}/512$。使用基模 $k_{\\min} = 2\\pi/L_{\\mathrm{hr}}$ 和奈奎斯特模 $k_{\\max} = \\pi/\\Delta x_{\\mathrm{hr}}$ 作为对高分辨率区域中粒子位移有贡献的功率的明确积分限。\n\n在 Zel’dovich 近似中，线性拉格朗日位移场 $\\boldsymbol{\\psi}$ 在傅里叶空间中满足 $\\boldsymbol{\\psi}(\\boldsymbol{k},z) = i\\,\\boldsymbol{k}\\,\\delta(\\boldsymbol{k},z)/k^{2}$，其中 $\\delta$ 是线性超密度。将一维均方根 (RMS) 粒子位移 $\\sigma_{\\mathrm{disp}}(z)$ 定义为 $\\boldsymbol{\\psi}$ 单个笛卡尔分量方差的平方根。\n\n在高红移处，取增长因子为 Einstein–de Sitter 宇宙的增长因子，$D(z) = 1/(1+z)$，归一化为 $D(0)=1$，因此 $P(k,z) = D^{2}(z) P_{0}(k)$。仅从这些定义和基本关系出发，推导用 $P(k,z)$ 表示的 $\\sigma_{\\mathrm{disp}}(z)$ 的表达式，针对给定的 $P_{0}(k)$ 以及从 $k_{\\min}$ 到 $k_{\\max}$ 的波数范围限制计算其值，然后确定最小起始红移 $z_{\\mathrm{start}}$，以确保一维均方根位移满足：\n$$\n\\sigma_{\\mathrm{disp}}(z_{\\mathrm{start}}) \\le 0.3\\,d\n$$\n在高分辨率区域内。将 $z_{\\mathrm{start}}$ 表示为一个纯数，并将您的答案四舍五入到三位有效数字。",
            "solution": "目标是找到宇宙学模拟的最小起始红移 $z_{\\mathrm{start}}$，使得一维均方根 (RMS) 粒子位移 $\\sigma_{\\mathrm{disp}}(z_{\\mathrm{start}})$ 小于粒子间距 $d$ 的 $0.3$ 倍。\n\n首先，我们必须推导 $\\sigma_{\\mathrm{disp}}(z)$ 的通用表达式。根据定义，它是拉格朗日位移场 $\\boldsymbol{\\psi}$ 单个笛卡尔分量方差的平方根。让我们考虑 x 分量 $\\psi_x$。方差是该分量平方的空间平均值：\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\langle \\psi_x^2(\\boldsymbol{x}, z) \\rangle\n$$\n由于宇宙学随机场的统计各向同性，每个分量的方差是相同的：$\\langle \\psi_x^2 \\rangle = \\langle \\psi_y^2 \\rangle = \\langle \\psi_z^2 \\rangle$。因此，一个分量的方差是位移矢量总方差的三分之一：\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{1}{3} \\langle |\\boldsymbol{\\psi}(\\boldsymbol{x}, z)|^2 \\rangle\n$$\n使用帕塞瓦尔定理，我们可以将实空间方差表示为傅里叶空间上的积分。位移场的总方差 $\\langle |\\boldsymbol{\\psi}(\\boldsymbol{x}, z)|^2 \\rangle$ 与密度场的功率谱 $P(k,z)$ 相关。Zel'dovich 近似将傅里叶空间中的位移场 $\\boldsymbol{\\psi}$ 与密度超密度 $\\delta$ 联系起来，即 $\\boldsymbol{\\psi}(\\boldsymbol{k},z) = i\\,\\boldsymbol{k}\\,\\delta(\\boldsymbol{k},z)/k^{2}$。由此可知，位移场的功率谱 $P_\\psi(k)$ 与密度功率谱 $P(k)$ 的关系为 $P_\\psi(k) = P(k)/k^2$。位移场的总方差可以写作：\n$$\n\\langle |\\boldsymbol{\\psi}(\\boldsymbol{x}, z)|^2 \\rangle = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} k^2 P_\\psi(k,z) dk = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} P(k,z) dk\n$$\n综合这些结果，一维位移方差为：\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{1}{3} \\langle |\\boldsymbol{\\psi}(\\boldsymbol{x}, z)|^2 \\rangle = \\frac{1}{6\\pi^2} \\int_{k_{\\min}}^{k_{\\max}} P(k,z) dk\n$$\n题目指定了从基模 $k_{\\min}$ 到奈奎斯特模 $k_{\\max}$ 的明确积分限。\n\n功率谱的时间演化由 $P(k,z) = D^2(z) P_0(k)$ 给出，其中对于 Einstein-de Sitter 宇宙，$P_0(k) = A k^{-3}$ 且 $A = \\pi^2$，$D(z) = 1/(1+z)$。将这些代入 $\\sigma_{\\mathrm{disp}}^2(z)$ 的表达式中：\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{D^2(z)}{6\\pi^2} \\int_{k_{\\min}}^{k_{\\max}} A k^{-3} dk\n$$\n我们进行积分：\n$$\n\\int_{k_{\\min}}^{k_{\\max}} A k^{-3} dk = A \\left[ -\\frac{1}{2k^2} \\right]_{k_{\\min}}^{k_{\\max}} = A \\left( -\\frac{1}{2k_{\\max}^2} - \\left(-\\frac{1}{2k_{\\min}^2}\\right) \\right) = \\frac{A}{2} \\left( \\frac{1}{k_{\\min}^2} - \\frac{1}{k_{\\max}^2} \\right)\n$$\n将此结果代回方差表达式，并设 $A=\\pi^2$：\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{D^2(z)}{6\\pi^2} \\cdot \\frac{\\pi^2}{2} \\left( \\frac{1}{k_{\\min}^2} - \\frac{1}{k_{\\max}^2} \\right) = \\frac{D^2(z)}{12} \\left( \\frac{1}{k_{\\min}^2} - \\frac{1}{k_{\\max}^2} \\right)\n$$\n接下来，我们确定积分限 $k_{\\min}$ 和 $k_{\\max}$ 以及粒子间距 $d$ 的值。\n已知共动边长 $L_{\\mathrm{hr}} = 10\\,h^{-1}\\,\\mathrm{Mpc}$ 和有效粒子数 $N_{\\mathrm{eff}} = 512^3$：\n基模为 $k_{\\min} = \\frac{2\\pi}{L_{\\mathrm{hr}}}$。\n粒子间距为 $d = \\Delta x_{\\mathrm{hr}} = \\frac{L_{\\mathrm{hr}}}{512}$。\n奈奎斯特模为 $k_{\\max} = \\frac{\\pi}{\\Delta x_{\\mathrm{hr}}} = \\frac{\\pi}{d} = \\frac{512\\pi}{L_{\\mathrm{hr}}}$。\n波数之比为 $\\frac{k_{\\max}}{k_{\\min}} = \\frac{512\\pi/L_{\\mathrm{hr}}}{2\\pi/L_{\\mathrm{hr}}} = \\frac{512}{2} = 256$。\n我们可以用 $k_{\\min}$ 表示 $d$：$d = \\frac{L_{\\mathrm{hr}}}{512} = \\frac{2\\pi/k_{\\min}}{512} = \\frac{\\pi}{256 k_{\\min}}$。\n\n需要满足的条件是 $\\sigma_{\\mathrm{disp}}(z_{\\mathrm{start}}) \\le 0.3\\,d$。为了找到最小红移，我们求解边界情况：\n$$\n\\sigma_{\\mathrm{disp}}(z_{\\mathrm{start}}) = 0.3\\,d\n$$\n两边平方得到：\n$$\n\\sigma_{\\mathrm{disp}}^2(z_{\\mathrm{start}}) = (0.3\\,d)^2 = 0.09\\,d^2\n$$\n现在我们令两个方差表达式相等。首先，我们用 $k_{\\min}$ 和比率 $k_{\\max}/k_{\\min}$ 重写方差：\n$$\n\\sigma_{\\mathrm{disp}}^2(z) = \\frac{D^2(z)}{12} \\frac{1}{k_{\\min}^2} \\left( 1 - \\left(\\frac{k_{\\min}}{k_{\\max}}\\right)^2 \\right) = \\frac{D^2(z)}{12 k_{\\min}^2} \\left( 1 - \\frac{1}{256^2} \\right)\n$$\n并且我们用 $k_{\\min}$ 表示该条件：\n$$\n0.09\\,d^2 = 0.09 \\left( \\frac{\\pi}{256 k_{\\min}} \\right)^2 = \\frac{0.09\\,\\pi^2}{256^2 k_{\\min}^2}\n$$\n在 $z=z_{\\mathrm{start}}$ 处令两个表达式相等：\n$$\n\\frac{D^2(z_{\\mathrm{start}})}{12 k_{\\min}^2} \\left( 1 - \\frac{1}{256^2} \\right) = \\frac{0.09\\,\\pi^2}{256^2 k_{\\min}^2}\n$$\n从两边消去 $k_{\\min}^2$ 项并化简：\n$$\n\\frac{D^2(z_{\\mathrm{start}})}{12} \\left( \\frac{256^2 - 1}{256^2} \\right) = \\frac{0.09\\,\\pi^2}{256^2}\n$$\n$$\nD^2(z_{\\mathrm{start}}) \\frac{256^2 - 1}{12} = 0.09\\,\\pi^2\n$$\n现在，我们求解 $D^2(z_{\\mathrm{start}})$：\n$$\nD^2(z_{\\mathrm{start}}) = \\frac{12 \\times 0.09 \\times \\pi^2}{256^2 - 1} = \\frac{1.08\\,\\pi^2}{65536 - 1} = \\frac{1.08\\,\\pi^2}{65535}\n$$\n使用给定的增长因子 $D(z) = \\frac{1}{1+z}$，我们有 $D^2(z) = \\frac{1}{(1+z)^2}$。\n$$\n\\frac{1}{(1+z_{\\mathrm{start}})^2} = \\frac{1.08\\,\\pi^2}{65535}\n$$\n$$\n(1+z_{\\mathrm{start}})^2 = \\frac{65535}{1.08\\,\\pi^2}\n$$\n开平方根并求解 $z_{\\mathrm{start}}$：\n$$\n1+z_{\\mathrm{start}} = \\sqrt{\\frac{65535}{1.08\\,\\pi^2}}\n$$\n$$\nz_{\\mathrm{start}} = \\sqrt{\\frac{65535}{1.08\\,\\pi^2}} - 1\n$$\n不等式 $\\sigma_{\\mathrm{disp}}(z) \\le 0.3\\,d$ 意味着 $D(z)$ 必须小于或等于边界处的值。由于 $D(z)$ 是 $z$ 的递减函数，这要求 $z \\ge z_{\\mathrm{start}}$。因此，计算出的 $z_{\\mathrm{start}}$ 代表了所需的最小红移。\n\n最后，我们计算数值：\n$$\nz_{\\mathrm{start}} = \\sqrt{\\frac{65535}{1.08 \\times (3.14159...)^2}} - 1 \\approx \\sqrt{\\frac{65535}{1.08 \\times 9.8696044}} - 1\n$$\n$$\nz_{\\mathrm{start}} \\approx \\sqrt{\\frac{65535}{10.6591728}} - 1 \\approx \\sqrt{6148.240} - 1\n$$\n$$\nz_{\\mathrm{start}} \\approx 78.4107 - 1 = 77.4107\n$$\n四舍五入到三位有效数字，最小起始红移为 $77.4$。",
            "answer": "$$\n\\boxed{77.4}\n$$"
        },
        {
            "introduction": "当模拟包含气体动力学以模拟星系形成时，我们必须确保物理不稳定性被正确捕捉。本练习探讨了金斯准则（Jeans criterion），这对于防止自引力气体中出现人为的数值碎裂至关重要。你将确定在一个模型化的星系盘中，为正确解析金斯长度所需的空间分辨率，其中密度和温度等物理条件随半径变化 。这项练习旨在磨练将核心物理原理转化为自适应网格加密（AMR）或其他高分辨率流体动力学代码的实际分辨率要求的能力。",
            "id": "3475513",
            "problem": "您正在为一个红移 $z=2$ 的恒星形成气体盘的自适应网格加密 (AMR) 高分辨率局部放大模拟设置分辨率目标。为了防止人为碎裂并精确地捕捉引力不稳定性，您需要在该盘内部 $10\\,\\mathrm{kpc}$ 范围内的所有地方强制要求一个固定的 Jeans 数 $N_J=8$。Jeans 数 $N_J$ 定义为局域特征 Jeans 长度与局域数值网格尺寸的比值。该气体盘近似等温，具有一个随半径变化的有效声速和一个随半径减小的中平面密度。假设在半径 $R$ 处于 $0 \\le R \\le 10\\,\\mathrm{kpc}$ 的范围内，具有以下随半径变化的剖面：\n- 有效声速：$c_s(R) = c_{s,0}\\left(1 + \\frac{R}{R_c}\\right)^{1/4}$，\n- 中平面质量密度：$\\rho(R) = \\rho_0 \\exp\\!\\left(-\\frac{R}{R_d}\\right)$，\n其中常数为 $c_{s,0} = 15\\,\\mathrm{km\\,s^{-1}}$，$R_c = 2\\,\\mathrm{kpc}$，$\\rho_0 = 5 \\times 10^{-23}\\,\\mathrm{g\\,cm^{-3}}$，以及 $R_d = 3\\,\\mathrm{kpc}$。使用引力常数 $G = 6.6743 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$ 和转换关系 $1\\,\\mathrm{pc} = 3.0857 \\times 10^{18}\\,\\mathrm{cm}$。\n\n从自引力等温介质的基本线性稳定性分析和 Jeans 数的定义出发，推导分辨率要求，并计算保证在所有半径 $R \\le 10\\,\\mathrm{kpc}$ 处 $N_J=8$ 的最小均匀 AMR 目标网格尺寸 $\\Delta x_{\\mathrm{target}}$。请用 $\\mathrm{pc}$ 作为单位表达您的最终答案，并四舍五入到三位有效数字。",
            "solution": "该问题要求确定一个自适应网格加密 (AMR) 模拟所需的最小均匀目标网格尺寸 $\\Delta x_{\\mathrm{target}}$。该网格尺寸必须确保在一个模拟的恒星形成气体盘的内部 $10\\,\\mathrm{kpc}$ 范围内，Jeans 数 $N_J$ 始终维持在 8。Jeans 数是局域 Jeans 长度 $\\lambda_J$ 与局域网格尺寸 $\\Delta x$ 的比值。\n\n首先，我们从 Jeans 长度的基本定义开始。Jeans 长度源于对自引力、等温流体的线性稳定性分析。在这种介质中，微扰的色散关系由下式给出：\n$$ \\omega^2 = c_s^2 k^2 - 4\\pi G \\rho $$\n其中 $\\omega$ 是微扰的角频率，$k$ 是其波数，$c_s$ 是等温声速，$G$ 是引力常数，$\\rho$ 是流体的质量密度。当 $\\omega^2  0$ 时，发生引力不稳定性，这会导致微扰的指数增长。通过设 $\\omega^2 = 0$，可以找到临界波数，即 Jeans 波数 $k_J$，当波数低于此值时系统是不稳定的：\n$$ c_s^2 k_J^2 = 4\\pi G \\rho \\implies k_J = \\frac{\\sqrt{4\\pi G \\rho}}{c_s} $$\nJeans 长度 $\\lambda_J$ 是对应于这个临界波数的波长，定义为 $\\lambda_J = 2\\pi/k_J$。代入 $k_J$ 的表达式，我们得到：\n$$ \\lambda_J = \\frac{2\\pi c_s}{\\sqrt{4\\pi G \\rho}} = c_s \\sqrt{\\frac{\\pi}{G\\rho}} $$\n这个分析是在盘中的每个半径 $R$ 处局域进行的，因此 $\\lambda_J$、$c_s$ 和 $\\rho$ 都是 $R$ 的函数。\n$$ \\lambda_J(R) = c_s(R) \\sqrt{\\frac{\\pi}{G\\rho(R)}} $$\n题目要求 Jeans 数 $N_J = \\lambda_J / \\Delta x$ 必须固定为 $N_J=8$，以恰当地解析引力不稳定性并防止人为碎裂。因此，所需的局域网格尺寸 $\\Delta x(R)$ 为：\n$$ \\Delta x(R) = \\frac{\\lambda_J(R)}{N_J} = \\frac{c_s(R)}{N_J} \\sqrt{\\frac{\\pi}{G\\rho(R)}} $$\n在指定的区域 $0 \\le R \\le 10\\,\\mathrm{kpc}$ 内的任何半径 $R$ 处，模拟都必须能够达到这个分辨率。“最小均匀 AMR 目标网格尺寸” $\\Delta x_{\\mathrm{target}}$ 指的是模拟必须能够达到的最小网格尺寸。这由最严格的要求决定，该要求对应于在感兴趣的区域上 $\\Delta x(R)$ 的最小值。\n$$ \\Delta x_{\\mathrm{target}} = \\min_{R \\in [0, 10\\,\\mathrm{kpc}]} \\Delta x(R) $$\n我们已知有效声速 $c_s(R)$ 和中平面质量密度 $\\rho(R)$ 的径向剖面：\n$$ c_s(R) = c_{s,0}\\left(1 + \\frac{R}{R_c}\\right)^{1/4} $$\n$$ \\rho(R) = \\rho_0 \\exp\\left(-\\frac{R}{R_d}\\right) $$\n将这些表达式代入 $\\Delta x(R)$ 的方程中：\n$$ \\Delta x(R) = \\frac{1}{N_J} \\sqrt{\\frac{\\pi}{G}} \\frac{c_{s,0}\\left(1 + \\frac{R}{R_c}\\right)^{1/4}}{\\sqrt{\\rho_0 \\exp\\left(-\\frac{R}{R_d}\\right)}} $$\n$$ \\Delta x(R) = \\left(\\frac{c_{s,0}}{N_J} \\sqrt{\\frac{\\pi}{G\\rho_0}}\\right) \\left(1 + \\frac{R}{R_c}\\right)^{1/4} \\exp\\left(\\frac{R}{2R_d}\\right) $$\n为了找到 $\\Delta x(R)$ 的最小值，我们可以分析其依赖于半径的部分，即函数 $f(R) = \\left(1 + \\frac{R}{R_c}\\right)^{1/4} \\exp\\left(\\frac{R}{2R_d}\\right)$。常数 $R_c$ 和 $R_d$ 都是正的，所以在区域 $R \\ge 0$ 上，项 $\\left(1 + \\frac{R}{R_c}\\right)^{1/4}$ 是 $R$ 的一个严格递增函数。项 $\\exp\\left(\\frac{R}{2R_d}\\right)$ 也是 $R$ 的一个严格递增函数。两个正的、严格递增函数的乘积本身也是一个严格递增函数。因此，对于 $R \\ge 0$，$\\Delta x(R)$ 是 $R$ 的一个单调递增函数。\n\n在区间 $[0, 10\\,\\mathrm{kpc}]$ 上，$\\Delta x(R)$ 的最小值必然出现在其下界，即 $R=0$ 处。\n$$ \\Delta x_{\\mathrm{target}} = \\Delta x(0) = \\left(\\frac{c_{s,0}}{N_J} \\sqrt{\\frac{\\pi}{G\\rho_0}}\\right) \\left(1 + 0\\right)^{1/4} \\exp\\left(0\\right) $$\n$$ \\Delta x_{\\mathrm{target}} = \\frac{c_{s,0}}{N_J} \\sqrt{\\frac{\\pi}{G\\rho_0}} $$\n现在，我们将给定的数值代入这个表达式。首先，我们必须确保所有数值都在一个一致的单位制中，我们选择 cgs 单位制 ($\\mathrm{cm}$, $\\mathrm{g}$, $\\mathrm{s}$)。\n- $c_{s,0} = 15\\,\\mathrm{km\\,s^{-1}} = 15 \\times 10^5\\,\\mathrm{cm\\,s^{-1}} = 1.5 \\times 10^6\\,\\mathrm{cm\\,s^{-1}}$\n- $N_J = 8$\n- $\\rho_0 = 5 \\times 10^{-23}\\,\\mathrm{g\\,cm^{-3}}$\n- $G = 6.6743 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$\n\n代入这些值：\n$$ \\Delta x_{\\mathrm{target}} = \\frac{1.5 \\times 10^6}{8} \\sqrt{\\frac{\\pi}{(6.6743 \\times 10^{-8}) (5 \\times 10^{-23})}} $$\n$$ \\Delta x_{\\mathrm{target}} = (1.875 \\times 10^5) \\sqrt{\\frac{\\pi}{3.33715 \\times 10^{-30}}} \\,\\,\\mathrm{cm} $$\n$$ \\Delta x_{\\mathrm{target}} = (1.875 \\times 10^5) \\sqrt{9.41398 \\times 10^{29}} \\,\\,\\mathrm{cm} $$\n$$ \\Delta x_{\\mathrm{target}} = (1.875 \\times 10^5) (9.70257 \\times 10^{14}) \\,\\,\\mathrm{cm} $$\n$$ \\Delta x_{\\mathrm{target}} = 1.81923 \\times 10^{20} \\,\\,\\mathrm{cm} $$\n问题要求最终答案以秒差距 ($\\mathrm{pc}$) 为单位。我们使用转换因子 $1\\,\\mathrm{pc} = 3.0857 \\times 10^{18}\\,\\mathrm{cm}$。\n$$ \\Delta x_{\\mathrm{target}}[\\mathrm{pc}] = \\frac{1.81923 \\times 10^{20}\\,\\mathrm{cm}}{3.0857 \\times 10^{18}\\,\\mathrm{cm\\,pc^{-1}}} $$\n$$ \\Delta x_{\\mathrm{target}}[\\mathrm{pc}] = 58.957... \\,\\,\\mathrm{pc} $$\n将结果四舍五入到三位有效数字，我们得到 $59.0\\,\\mathrm{pc}$。",
            "answer": "$$\n\\boxed{59.0}\n$$"
        },
        {
            "introduction": "计算科学中的一项核心任务是评估模拟结果的可靠性并量化其数值误差。本练习介绍理查森外推法（Richardson extrapolation），这是一种强大的技术，用于估计连续谱极限——即在无限分辨率下会获得的“真实”值。利用一系列不同分辨率模拟的数据，你将系统地消除主导阶的误差项，从而得出一个更准确的估计，并量化测量结果的收敛性 。这项实践对于培养一种严谨的验证和解释数值预测的方法至关重要。",
            "id": "3475543",
            "problem": "在一套关于一个银河系质量暗物质晕的宇宙学高分辨率局部放大模拟中，您在拉格朗日区域内测量了半径 $r = 500\\,\\mathrm{pc}$ 处球对称平均的暗物质密度剖面的内部对数斜率 $\\gamma \\equiv -d\\ln \\rho/d\\ln r$。执行了三次嵌套模拟，有效空间分辨率（网格宽度）$h$、$h/2$ 和 $h/4$ 之间的均匀加密比为 $r = 2$。引力和流体力学求解器在空间上是二阶精度的，您可以假设 $\\gamma$ 的主阶离散误差是一个以 $h$ 的偶数次幂表示的解析级数，其主导项与 $h^{2}$ 成正比。测量值为\n$\\gamma(h) = 0.85$，$\\gamma(h/2) = 0.953125$ 和 $\\gamma(h/4) = 0.9876953125$。\n从截断误差的定义出发，且不使用任何现成的公式，请使用 $r = 2$ 和二阶空间精度的 Richardson 外推法，通过一致地组合所有三个分辨率来形成对连续极限 $\\gamma_{0}$ 的估计，从而消除 $h$ 的两个主导误差阶。然后，使用您得到的连续极限估计值，量化最高分辨率结果的绝对数值误差 $|\\gamma(h/4) - \\gamma_{0}|$。将 $\\gamma_{0}$ 和绝对误差都表示为无量纲数，并均四舍五入至 $5$ 位有效数字。",
            "solution": "问题要求我们使用来自三个空间分辨率逐步加密的模拟数据，来确定一个数值测量量 $\\gamma$ 的连续极限 $\\gamma_{0}$。然后我们必须计算最高分辨率测量的绝对误差。使用的方法是 Richardson 外推法，该方法从所给定的数值误差形式推导得出。\n\n问题指出，在特定半径处测量的对数斜率 $\\gamma$ 收敛于真实的连续值 $\\gamma_{0}$，其离散误差是一个以分辨率 $h$ 的偶数次幂表示的解析级数。求解器是二阶精度的，因此主导误差项与 $h^2$ 成正比。我们被要求消除两个主导误差阶，这意味着误差模型可以截断为：\n$$\n\\gamma(h) = \\gamma_{0} + C_{2}h^{2} + C_{4}h^{4} + O(h^{6})\n$$\n其中 $C_{2}$ 和 $C_{4}$ 是与 $h$ 无关的常数。\n\n给定三次模拟的测量值，其分辨率分别为 $h$、$h/2$ 和 $h/4$：\n1.  $\\gamma_A \\equiv \\gamma(h) = 0.85$\n2.  $\\gamma_B \\equiv \\gamma(h/2) = 0.953125$\n3.  $\\gamma_C \\equiv \\gamma(h/4) = 0.9876953125$\n\n使用该误差模型，我们可以写出一个包含三个方程的方程组，忽略 $h^{6}$ 阶及更高阶的项，因为它们超出了所要求的修正范围：\n$$\n\\gamma_A = \\gamma_{0} + C_{2}h^{2} + C_{4}h^{4} \\quad (1)\n$$\n$$\n\\gamma_B = \\gamma_{0} + C_{2}\\left(\\frac{h}{2}\\right)^{2} + C_{4}\\left(\\frac{h}{2}\\right)^{4} = \\gamma_{0} + \\frac{1}{4}C_{2}h^{2} + \\frac{1}{16}C_{4}h^{4} \\quad (2)\n$$\n$$\n\\gamma_C = \\gamma_{0} + C_{2}\\left(\\frac{h}{4}\\right)^{2} + C_{4}\\left(\\frac{h}{4}\\right)^{4} = \\gamma_{0} + \\frac{1}{16}C_{2}h^{2} + \\frac{1}{256}C_{4}h^{4} \\quad (3)\n$$\n\nRichardson 外推法的第一步是消除主导阶误差项 $C_{2}h^{2}$。我们可以通过组合两对​​方程来做到这一点。\n\n首先，我们组合方程 $(1)$ 和 $(2)$。为消除 $C_{2}h^{2}$ 项，我们将方程 $(2)$ 乘以 $4$ 并减去方程 $(1)$：\n$$\n4\\gamma_B = 4\\gamma_{0} + C_{2}h^{2} + \\frac{4}{16}C_{4}h^{4}\n$$\n$$\n4\\gamma_B - \\gamma_A = (4\\gamma_{0} - \\gamma_{0}) + (C_{2}h^{2} - C_{2}h^{2}) + \\left(\\frac{1}{4}C_{4}h^{4} - C_{4}h^{4}\\right)\n$$\n$$\n4\\gamma_B - \\gamma_A = 3\\gamma_{0} - \\frac{3}{4}C_{4}h^{4}\n$$\n对 $\\gamma_{0}$ 求解可以得到一个新的、更准确的估计值，我们称之为 $\\gamma'_{AB}$：\n$$\n\\gamma'_{AB} \\equiv \\frac{4\\gamma_B - \\gamma_A}{3} = \\gamma_{0} - \\frac{1}{4}C_{4}h^{4}\n$$\n这个组合消除了 $O(h^{2})$ 误差，留下一个 $O(h^{4})$ 阶的主导误差。\n\n接下来，我们对​​方程 $(2)$ 和 $(3)$ 应用相同的步骤。我们将方程 $(3)$ 乘以 $4$ 并减去方程 $(2)$：\n$$\n4\\gamma_C = 4\\gamma_{0} + \\frac{4}{16}C_{2}h^{2} + \\frac{4}{256}C_{4}h^{4}\n$$\n$$\n4\\gamma_C - \\gamma_B = (4\\gamma_{0} - \\gamma_{0}) + \\left(\\frac{1}{4}C_{2}h^{2} - \\frac{1}{4}C_{2}h^{2}\\right) + \\left(\\frac{1}{64}C_{4}h^{4} - \\frac{1}{16}C_{4}h^{4}\\right)\n$$\n$$\n4\\gamma_C - \\gamma_B = 3\\gamma_{0} - \\frac{3}{64}C_{4}h^{4}\n$$\n这给出了第二个改进的估计值 $\\gamma'_{BC}$：\n$$\n\\gamma'_{BC} \\equiv \\frac{4\\gamma_C - \\gamma_B}{3} = \\gamma_{0} - \\frac{1}{64}C_{4}h^{4}\n$$\n这个估计值也有一个 $O(h^{4})$ 阶的主导误差。注意，误差项减小了 $16 = (2)^{4}$ 倍，这反映了使用了更高分辨率的数据。\n\n现在我们有两个带有 $O(h^4)$ 误差的新估计值：\n$$\n\\gamma'_{AB} = \\gamma_{0} - \\frac{1}{4}C_{4}h^{4} \\quad (4)\n$$\n$$\n\\gamma'_{BC} = \\gamma_{0} - \\frac{1}{64}C_{4}h^{4} \\quad (5)\n$$\nRichardson 外推法的第二步是组合这两个新估计值以消除 $C_{4}h^{4}$ 项。我们将方程 $(5)$ 乘以 $16$ 并减去方程 $(4)$：\n$$\n16\\gamma'_{BC} = 16\\gamma_{0} - \\frac{16}{64}C_{4}h^{4} = 16\\gamma_{0} - \\frac{1}{4}C_{4}h^{4}\n$$\n$$\n16\\gamma'_{BC} - \\gamma'_{AB} = (16\\gamma_{0} - \\gamma_{0}) + \\left(-\\frac{1}{4}C_{4}h^{4} - \\left(-\\frac{1}{4}C_{4}h^{4}\\right)\\right)\n$$\n$$\n16\\gamma'_{BC} - \\gamma'_{AB} = 15\\gamma_{0}\n$$\n这就给出了我们对连续值 $\\gamma_{0}$ 的最终估计，该估计值现在已经没有 $h^2$ 和 $h^4$ 阶的误差了：\n$$\n\\gamma_{0} = \\frac{16\\gamma'_{BC} - \\gamma'_{AB}}{15}\n$$\n现在，我们代入数值。\n首先，计算中间估计值：\n$$\n\\gamma'_{AB} = \\frac{4(0.953125) - 0.85}{3} = \\frac{3.8125 - 0.85}{3} = \\frac{2.9625}{3} = 0.9875\n$$\n$$\n\\gamma'_{BC} = \\frac{4(0.9876953125) - 0.953125}{3} = \\frac{3.95078125 - 0.953125}{3} = \\frac{2.99765625}{3} = 0.99921875\n$$\n现在，计算 $\\gamma_{0}$ 的最终估计值：\n$$\n\\gamma_{0} = \\frac{16(0.99921875) - 0.9875}{15} = \\frac{15.9875 - 0.9875}{15} = \\frac{15}{15} = 1\n$$\n内部斜率的连续极限恰好是 $\\gamma_{0}=1$。保留 $5$ 位有效数字，结果是 $1.0000$。\n\n第二个任务是量化最高分辨率结果的绝对数值误差 $|\\gamma(h/4) - \\gamma_{0}|$。\n最高分辨率的结果是 $\\gamma_C = \\gamma(h/4) = 0.9876953125$。\n绝对误差为：\n$$\n|\\gamma(h/4) - \\gamma_{0}| = |0.9876953125 - 1| = |-0.0123046875| = 0.0123046875\n$$\n将此值四舍五入至 $5$ 位有效数字，得到 $0.012305$。\n\n要求的两个值是连续极限估计值 $\\gamma_{0}$ 和最高分辨率测量的绝对误差，两者都四舍五入到 $5$ 位有效数字。\n$\\gamma_{0} \\approx 1.0000$\n$|\\gamma(h/4) - \\gamma_{0}| \\approx 0.012305$",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.0000  0.012305 \\end{pmatrix}}$$"
        }
    ]
}