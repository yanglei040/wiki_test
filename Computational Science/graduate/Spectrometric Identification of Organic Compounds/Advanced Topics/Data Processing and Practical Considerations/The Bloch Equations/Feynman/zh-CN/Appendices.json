{
    "hands_on_practices": [
        {
            "introduction": "核磁共振实验的核心在于使用射频（RF）脉冲精确地操控核自旋。理解这一过程的关键是转换到“旋转坐标系”中，在该坐标系下，复杂的时变磁场简化为一个静态的“有效磁场”。本练习将引导你通过计算来确定磁化矢量绕其旋转的有效轴和旋转角度，这是设计所有现代核磁共振脉冲序列的基础。",
            "id": "3726671",
            "problem": "在应用于有机化合物鉴别的核磁共振（NMR）波谱法中，射频（RF）脉冲期间宏观磁化强度的动力学由布洛赫方程所描述。从磁场中磁矩的基本进动定律 $\\frac{d\\mathbf{M}}{dt} = \\gamma\\,\\mathbf{M} \\times \\mathbf{B}(t)$ 出发，其中 $\\gamma$ 是旋磁比，$\\mathbf{B}(t)$ 是总磁场，考虑一个质子自旋系统，该系统处于强静磁场 $\\mathbf{B}_0 = B_0\\,\\hat{\\mathbf{z}}$ 和一个圆偏振射频场中。该射频场振幅为 $B_1$，载波角频率为 $\\omega_{\\mathrm{rf}}$，且相位经过校准，使其在旋转坐标系中的有效横向分量沿 $\\hat{\\mathbf{x}}$ 方向。在以 $\\omega_{\\mathrm{rf}}$ 旋转的坐标系中进行分析，并采用旋转波近似（RWA），忽略脉冲期间的弛豫。\n\n定义角频率偏移为 $\\Delta\\omega \\equiv \\omega_0 - \\omega_{\\mathrm{rf}}$，其中 $\\omega_0$ 是拉莫尔角频率。从第一性原理出发，根据旋转坐标系中磁化强度所感受到的有效场，解释共振旋转（$\\Delta\\omega = 0$）和失谐旋转（$\\Delta\\omega \\neq 0$）之间的区别，并推导对于持续时间为 $\\tau$ 的矩形射频脉冲，其有效旋转轴（以单位向量表示）和旋转角的表达式。\n\n然后，在一个与有机化合物波谱鉴别相关的选择性激发场景中，计算一个质子在振幅为 $B_1 = 12\\ \\mu\\text{T}$、频率偏移为 $\\Delta\\omega = 2\\pi \\times 400\\ \\text{s}^{-1}$、持续时间为 $\\tau = 150\\ \\mu\\text{s}$ 的射频脉冲作用下的有效旋转轴和旋转角。该质子的旋磁比为 $\\gamma = 2.675 \\times 10^{8}\\ \\text{rad s}^{-1}\\ \\text{T}^{-1}$。将旋转角以弧度表示。将单位向量的每个分量和旋转角四舍五入到四位有效数字。",
            "solution": "宏观磁化矢量 $\\mathbf{M}(t)$ 在时变磁场 $\\mathbf{B}(t)$ 下的进动动力学由方程 $\\frac{d\\mathbf{M}}{dt} = \\gamma\\,\\mathbf{M} \\times \\mathbf{B}(t)$ 描述，该方程源于磁场中磁偶极子所受的力矩。在核磁共振（NMR）中，我们考虑一个强静磁场 $\\mathbf{B}_0 = B_0\\,\\hat{\\mathbf{z}}$，它设定了拉莫尔角频率 $\\omega_0 = \\gamma B_0$，以及一个在 $\\omega_0$ 附近振荡的横向射频（RF）场。\n\n为了分析脉冲引起的旋转，方便进入一个以射频角频率 $\\omega_{\\mathrm{rf}}$ 绕 $\\hat{\\mathbf{z}}$ 轴旋转的坐标系。在该旋转坐标系中，根据旋转波近似（RWA），射频场的快速振荡的反向旋转分量被忽略，而同向旋转分量表现为一个静态的横向场。如果射频场被视为圆偏振，使其有效横向分量沿 $\\hat{\\mathbf{x}}$ 方向，那么在旋转坐标系中，磁化强度遵循\n$$\n\\frac{d\\mathbf{M}_{\\mathrm{rot}}}{dt} = \\gamma\\,\\mathbf{M}_{\\mathrm{rot}} \\times \\mathbf{B}_{\\mathrm{eff}},\n$$\n其中有效场为\n$$\n\\mathbf{B}_{\\mathrm{eff}} = B_1\\,\\hat{\\mathbf{x}} + \\frac{\\Delta\\omega}{\\gamma}\\,\\hat{\\mathbf{z}},\n$$\n其中 $\\Delta\\omega \\equiv \\omega_0 - \\omega_{\\mathrm{rf}}$ 是角频率偏移。$\\hat{\\mathbf{z}}$ 分量在旋转坐标系中出现，是因为静磁场看起来被旋转频率所削弱，留下一个有效失谐量 $\\Delta\\omega/\\gamma$。\n\n共振旋转对应于 $\\Delta\\omega = 0$ 的情况，此时 $\\mathbf{B}_{\\mathrm{eff}} = B_1\\,\\hat{\\mathbf{x}}$，磁化强度仅以角章动速率 $\\omega_1 = \\gamma B_1$ 绕 $\\hat{\\mathbf{x}}$ 轴章动。失谐旋转对应于 $\\Delta\\omega \\neq 0$ 的情况，此时有效场偏离横向平面，磁化强度绕此倾斜轴进动。旋转轴是 $\\mathbf{B}_{\\mathrm{eff}}$ 的方向，而角章动速率是有效角频率矢量 $\\boldsymbol{\\omega}_{\\mathrm{eff}} = \\gamma \\mathbf{B}_{\\mathrm{eff}} = (\\gamma B_1)\\,\\hat{\\mathbf{x}} + \\Delta\\omega\\,\\hat{\\mathbf{z}}$ 的大小。因此，沿旋转轴的单位向量是\n$$\n\\hat{\\mathbf{n}} = \\frac{\\boldsymbol{\\omega}_{\\mathrm{eff}}}{\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|} = \\frac{(\\gamma B_1)\\,\\hat{\\mathbf{x}} + \\Delta\\omega\\,\\hat{\\mathbf{z}}}{\\sqrt{(\\gamma B_1)^{2} + (\\Delta\\omega)^{2}}},\n$$\n而由持续时间为 $\\tau$ 的矩形脉冲产生的旋转角是\n$$\n\\theta = \\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|\\,\\tau = \\sqrt{(\\gamma B_1)^{2} + (\\Delta\\omega)^{2}}\\;\\tau.\n$$\n\n我们现在根据给定参数计算这些表达式的值。在最后一步之前保留符号，然后代入数值。给定 $\\gamma = 2.675 \\times 10^{8}\\ \\text{rad s}^{-1}\\ \\text{T}^{-1}$，$B_1 = 12 \\times 10^{-6}\\ \\text{T}$，$\\Delta\\omega = 2\\pi \\times 400\\ \\text{s}^{-1}$ 和 $\\tau = 150 \\times 10^{-6}\\ \\text{s}$，我们首先计算\n$$\n\\gamma B_1 = \\left(2.675 \\times 10^{8}\\right)\\left(12 \\times 10^{-6}\\right) = 3.21 \\times 10^{3}\\ \\text{rad s}^{-1},\n$$\n所以\n$$\n\\gamma B_1 = 3210\\ \\text{rad s}^{-1},\n\\qquad\n\\Delta\\omega = 2\\pi \\times 400 = 2513.2741229\\ \\text{rad s}^{-1}.\n$$\n有效角频率的大小是\n$$\n\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\| = \\sqrt{(\\gamma B_1)^{2} + (\\Delta\\omega)^{2}} = \\sqrt{(3210)^{2} + (2513.2741229)^{2}}\\ \\text{rad s}^{-1}.\n$$\n数值上，\n$$\n(3210)^{2} = 10{,}304{,}100,\n\\qquad\n(2513.2741229)^{2} \\approx 6{,}316{,}546.839,\n$$\n所以\n$$\n\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\| \\approx \\sqrt{16{,}620{,}646.839} \\approx 4076.843\\ \\text{rad s}^{-1}.\n$$\n因此，单位旋转轴的分量是\n$$\nn_x = \\frac{\\gamma B_1}{\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|} \\approx \\frac{3210}{4076.843} \\approx 0.7874,\n\\quad\nn_y = 0,\n\\quad\nn_z = \\frac{\\Delta\\omega}{\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|} \\approx \\frac{2513.2741229}{4076.843} \\approx 0.6165.\n$$\n旋转角是\n$$\n\\theta = \\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|\\,\\tau \\approx (4076.843)\\,(150 \\times 10^{-6}) \\approx 0.6115\\ \\text{rad}.\n$$\n四舍五入到四位有效数字，有效旋转轴和旋转角如上所示，其中角度以弧度表示。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.7874  0  0.6165  0.6115\\end{pmatrix}}$$"
        },
        {
            "introduction": "在射频脉冲之后，自旋系统自由进动并弛豫，产生一个称为自由感应衰减（FID）的时域信号。本练习探讨了由布洛赫方程预测的FID与通过傅里叶变换得到的频谱之间的关键联系。你将分析一个在真实实验中普遍存在的问题——相位错误——并学习如何利用布洛赫方程预测的信号行为来系统地校正它，从而将理论知识应用于解决实际的数据处理挑战。",
            "id": "3726611",
            "problem": "在用于鉴定有机化合物的核磁共振（NMR）波谱法中，测量的自由感应衰减（FID）信号是通过相对于射频发射器进行正交检测来采集的。考虑一个自旋为$\\tfrac{1}{2}$的单一核种，在静态磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 中具有平衡磁化强度 $M_0$。一个短的射频脉冲产生横向磁化强度，之后系统在静态磁场和弛豫作用下自由演化。磁化强度 $\\mathbf{M}(t)$ 的演化由布洛赫方程决定：\n$$\\frac{d\\mathbf{M}}{dt} = \\gamma\\, \\mathbf{M} \\times \\mathbf{B} - \\frac{M_x \\hat{\\mathbf{x}} + M_y \\hat{\\mathbf{y}}}{T_2} - \\frac{(M_z - M_0)\\hat{\\mathbf{z}}}{T_1},$$\n其中 $\\gamma$ 是旋磁比，$T_1$ 是纵向弛豫时间，$T_2$ 是横向弛豫时间。假设共振频率相对于发射器频率有角频率偏移 $\\Delta \\omega$，并且正交接收器相对于发射器参考有一个未知但恒定的零阶相位偏移 $\\theta_r$。\n\n仅使用这些基本原理，从布洛赫方程出发，推导出自由进动下横向磁化强度的时域演化，并解释非零的 $\\theta_r$ 如何旋转复数FID，使得经过傅里叶变换后，谱图的实部包含吸收线型和色散线型的混合。然后，选择一个描述了科学上一致的程序的选项，该程序仅根据布洛赫方程预测的FID时域行为来估计和校正零阶相位（而不借助于频域启发式方法）。\n\n哪个选项是正确的？\n\nA. 利用布洛赫方程预测的FID在早期时间的阻尼复指数形式：将测得的复数FID $s_{\\text{meas}}(t)$ 在一个短窗口内拟合到 $C\\, e^{-t/T_2} e^{i(\\Delta \\omega t + \\psi)}$，其中 $C$ 为复振幅，$\\psi$ 为相位。从该时域拟合中估计 $\\psi$，然后对 $s_{\\text{meas}}(t)$ 应用一个全局零阶旋转 $e^{-i\\psi}$，以使实部通道对应于吸收线，虚部通道对应于色散线。这消除了由 $\\theta_r$ 引起的色散混合成分。\n\nB. 应用一阶相位校正，即在频域中应用线性相位斜坡 $\\phi(\\omega) = a + b\\, \\omega$（其中 $b \\neq 0$），并选择 $a$ 和 $b$ 以最大化峰的对称性。这可以解决时间原点误差问题，并将消除由 $\\theta_r$ 引起的色散混合成分。\n\nC. 将FID乘以一个实数切趾窗 $w(t)$，该窗函数旨在抑制早期时间的振荡，然后进行傅里叶变换。该窗函数将抑制由不正确的接收器相位引起的色散混合成分。\n\nD. 在傅里叶变换前丢弃虚部正交分量，只保留FID的实部，这样谱图将是纯吸收型的，并且无论接收器相位如何，都不会有色散混合成分。\n\nE. 对幅度谱使用希尔伯特变换来重建一个纯吸收谱，而无需确定接收器相位，也无需对布洛赫方程预测的FID时域行为做任何假设。",
            "solution": "用户需要一个基于布洛赫方程的解，用于处理核磁共振（NMR）波谱学中单一自旋-$\\frac{1}{2}$核种的问题。解题过程包括验证问题陈述，推导自由感应衰减（FID）的行为，解释接收器相位误差的影响，并评估所提出的校正方法。\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **系统：** 在静态磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 中，具有平衡磁化强度 $M_0$ 的单一自旋-$\\frac{1}{2}$核种。\n*   **初始条件：** 一个短的射频脉冲产生横向磁化强度。\n*   **演化：** 在静态磁场和弛豫作用下自由进动。\n*   **控制方程：** 布洛赫方程：$\\frac{d\\mathbf{M}}{dt} = \\gamma\\, \\mathbf{M} \\times \\mathbf{B} - \\frac{M_x \\hat{\\mathbf{x}} + M_y \\hat{\\mathbf{y}}}{T_2} - \\frac{(M_z - M_0)\\hat{\\mathbf{z}}}{T_1}$。\n*   **参数：** $\\gamma$（旋磁比），$T_1$（纵向弛豫时间），$T_2$（横向弛豫时间）。\n*   **检测：** 相对于射频发射器进行正交检测。\n*   **频率偏移：** 共振频率相对于发射器频率有角频率偏移 $\\Delta \\omega$。\n*   **接收器相位误差：** 正交接收器有一个未知但恒定的零阶相位偏移 $\\theta_r$。\n*   **目标：** 解释 $\\theta_r$ 如何影响谱图，并确定一个科学上一致的程序来校正它，该程序仅基于布洛赫方程预测的FID时域行为。\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **科学基础：** 问题牢固地建立在布洛赫方程之上，这是NMR领域一个基础且完善的模型。FID、正交检测、弛豫和相位校正等概念都是标准的且科学准确的。（通过）\n*   **问题明确：** 问题定义良好。它提供了控制方程和背景（自由进动）。它要求在明确的约束下（仅使用时域模型）进行特定的推导和方法评估。根据这些原则，可以在选项中确定唯一的正确程序。（通过）\n*   **客观性：** 语言技术性强、精确，没有主观或含糊的术语。（通过）\n\n**Step 3: Verdict and Action**\n\n问题陈述在科学上是合理的、明确的、客观的且内部一致的。这是一个有效的问题。可以继续进行求解过程。\n\n### Derivation and Analysis\n\n**1. Time-Domain Evolution of Transverse Magnetization**\n\n在自由进动期间，磁场是静态的，$\\mathbf{B} = \\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。磁化强度横向分量 $M_x$ 和 $M_y$ 的布洛赫方程为：\n$$ \\frac{dM_x}{dt} = \\gamma M_y B_0 - \\frac{M_x}{T_2} $$\n$$ \\frac{dM_y}{dt} = -\\gamma M_x B_0 - \\frac{M_y}{T_2} $$\n我们定义拉莫尔频率为 $\\omega_0 = \\gamma B_0$。通常约定对于像质子这样的原子核，$\\gamma > 0$，所以 $\\omega_0$ 与 $B_0$ 符号相同。我们将这两个分量组合成一个复数横向磁化强度 $M_{xy}(t) = M_x(t) + i M_y(t)$。\n$$ \\frac{dM_{xy}}{dt} = \\frac{dM_x}{dt} + i \\frac{dM_y}{dt} = (\\omega_0 M_y - \\frac{M_x}{T_2}) + i (-\\omega_0 M_x - \\frac{M_y}{T_2}) $$\n$$ \\frac{dM_{xy}}{dt} = -i\\omega_0 (M_x + i M_y) - \\frac{1}{T_2}(M_x + i M_y) = -(i\\omega_0 + \\frac{1}{T_2}) M_{xy} $$\n这个一阶微分方程的解是：\n$$ M_{xy}(t) = M_{xy}(0) e^{-(i\\omega_0 + 1/T_2)t} = M_{xy}(0) e^{-t/T_2} e^{-i\\omega_0 t} $$\n这里，$M_{xy}(0)$ 是由脉冲产生的初始复数横向磁化强度。\n\n信号是在一个以发射器频率 $\\omega_{\\text{rf}}$ 旋转的参考系（旋转坐标系）中检测的。在这个旋转坐标系中的磁化强度 $M_{\\text{rot}}(t)$ 与实验室坐标系中的磁化强度 $M_{xy}(t)$ 的关系是 $M_{\\text{rot}}(t) = M_{xy}(t) e^{i\\omega_{\\text{rf}}t}$。因此：\n$$ M_{\\text{rot}}(t) = (M_{xy}(0) e^{-t/T_2} e^{-i\\omega_0 t}) e^{i\\omega_{\\text{rf}}t} = M_{xy}(0) e^{-t/T_2} e^{-i(\\omega_0 - \\omega_{\\text{rf}})t} $$\n共振偏移量为 $\\Delta\\omega$。根据约定，$\\Delta\\omega = \\omega_0 - \\omega_{\\text{rf}}$ 或 $\\Delta\\omega = \\omega_{\\text{rf}} - \\omega_0$。最终的相位物理现象与此符号约定无关。采用常见的NMR定义，其中相对于发射器的更高拉莫尔频率在谱图中给出正频率，我们可以将检测到的与 $M_{\\text{rot}}(t)$ 成正比的信号 $s(t)$ 表示为：\n$$ s_{\\text{ideal}}(t) = C_0 e^{i\\phi_0} e^{-t/T_2} e^{i\\Delta\\omega t} $$\n其中 $C_0$ 是一个实数振幅，$\\phi_0$ 是由激发脉冲决定的横向磁化强度的初始相位。\n\n**2. Effect of Receiver Phase Offset**\n\n接收器有一个恒定的相位偏移 $\\theta_r$。这意味着测量的信号 $s_{\\text{meas}}(t)$ 在复平面上相对于理想信号旋转了这个角度：\n$$ s_{\\text{meas}}(t) = s_{\\text{ideal}}(t) e^{i\\theta_r} = (C_0 e^{i\\phi_0} e^{-t/T_2} e^{i\\Delta\\omega t}) e^{i\\theta_r} = C_0 e^{-t/T_2} e^{i(\\Delta\\omega t + \\phi_0 + \\theta_r)} $$\n令总零阶相位为 $\\psi = \\phi_0 + \\theta_r$。测量的FID为：\n$$ s_{\\text{meas}}(t) = C_0 e^{-t/T_2} e^{i(\\Delta\\omega t + \\psi)} \\quad (t \\ge 0) $$\n谱图 $S(\\omega)$ 是FID的傅里叶变换：\n$$ S(\\omega) = \\int_0^\\infty s_{\\text{meas}}(t) e^{-i\\omega t} dt = C_0 e^{i\\psi} \\int_0^\\infty e^{-t/T_2} e^{i(\\Delta\\omega - \\omega)t} dt $$\n$$ S(\\omega) = C_0 e^{i\\psi} \\left[ \\frac{1}{1/T_2 - i(\\Delta\\omega - \\omega)} \\right] = C_0 e^{i\\psi} \\left[ \\frac{1/T_2 + i(\\omega - \\Delta\\omega)}{(1/T_2)^2 + (\\omega - \\Delta\\omega)^2} \\right] $$\n令 $\\Omega = \\omega - \\Delta\\omega$。谱图为 $S(\\omega) = C_0 e^{i\\psi} (A(\\Omega) + i D(\\Omega))$，其中 $A(\\Omega)=\\frac{1/T_2}{(1/T_2)^2+\\Omega^2}$ 是吸收洛伦兹线型，$D(\\Omega)=\\frac{\\Omega}{(1/T_2)^2+\\Omega^2}$ 是色散洛伦兹线型。\n使用 $e^{i\\psi} = \\cos\\psi + i\\sin\\psi$ 将其展开：\n$$ S(\\omega) = C_0[\\cos\\psi + i\\sin\\psi][A(\\Omega) + iD(\\Omega)] = C_0 [(\\cos\\psi A(\\Omega) - \\sin\\psi D(\\Omega)) + i(\\sin\\psi A(\\Omega) + \\cos\\psi D(\\Omega))] $$\n谱图的实部是 $\\text{Re}[S(\\omega)] = C_0 (\\cos\\psi A(\\Omega) - \\sin\\psi D(\\Omega))$。如果相位误差 $\\psi$ 非零，则实部是吸收线型和色散线型的混合。要获得纯吸收谱，必须校正数据使 $\\psi=0$。这可以通过将FID乘以 $e^{-i\\psi}$ 或将谱图乘以 $e^{-i\\psi}$ 来实现。挑战在于确定 $\\psi$。\n\n### Option-by-Option Analysis\n\n问题要求找到一个*仅*基于布洛赫方程预测的时域行为（即 $s_{\\text{meas}}(t)$ 具有 $C_0 e^{-t/T_2} e^{i(\\Delta\\omega t + \\psi)}$ 的形式）来寻找和校正 $\\psi$ 的程序。\n\n**A. Exploit the Bloch-predicted damped complex exponential form of the FID at early times: fit the measured complex FID $s_{\\text{meas}}(t)$ over a short window to $C\\, e^{-t/T_2} e^{i(\\Delta \\omega t + \\psi)}$ with complex amplitude $C$ and phase $\\psi$, estimate $\\psi$ from this time-domain fit, and then apply a global zero-order rotation $e^{-i\\psi}$ to $s_{\\text{meas}}(t)$ so that the real channel corresponds to the absorptive line and the imaginary to the dispersive line. This removes the dispersive admixture induced by $\\theta_r$.**\n\n该选项提出将测量数据拟合到从布洛赫方程导出的理论模型。模型函数为 $f(t) = A e^{-t/R_2} e^{i(\\Delta\\omega t + \\psi)}$，其中 $A$, $R_2=1/T_2$, $\\Delta\\omega$ 和 $\\psi$ 是拟合参数。通过对复数FID数据执行该模型的非线性最小二乘拟合，可以获得相位 $\\psi$ 的估计值。然后可以使用这个估计的相位对整个FID应用校正 $e^{-i\\psi}$。这个过程直接基于布洛赫方程预测的时域行为。使用早期时间的数据是为了获得更好的信噪比，这是一个实际的考虑。该描述在科学上是合理的，并直接解决了所提出的问题。\n**Verdict: Correct.**\n\n**B. Apply a first-order phase correction, i.e., a linear phase ramp $\\phi(\\omega) = a + b\\, \\omega$ in the frequency domain with $b \\neq 0$, and choose $a$ and $b$ to maximize peak symmetry. This addresses time-origin errors and will eliminate dispersive admixture due to $\\theta_r$.**\n\n该选项描述了一种频域校正方法。参数 $a$ 对应于零阶相位 $\\psi$。参数 $b$ 对应于一阶相位校正，这是为了校正采集中的时间延迟，而不是恒定的接收器相位偏移。问题陈述没有给出假设存在时间原点误差的理由，因此没有非零 $b$ 的基础。此外，该方法依赖于频域启发式方法（“最大化峰的对称性”），而不是按照提示要求“仅从布洛赫方程预测的FID时域行为”推导出来。\n**Verdict: Incorrect.**\n\n**C. Multiply the FID by a real apodization window $w(t)$ chosen to suppress early-time oscillations, then Fourier transform. The window will suppress dispersive admixture caused by incorrect receiver phase.**\n\n切趾或加窗，涉及将FID乘以一个实值函数 $w(t)$。此操作会缩放复数FID数据点的幅度 $s'_{\\text{meas}}(t) = w(t) s_{\\text{meas}}(t)$，但不会改变它们的相位。由于相位误差 $\\psi$ 是复平面中的一个角度，乘以一个实函数无法校正它。相位信息，包括误差 $\\psi$，被保留下来，得到的谱图的实部仍然会有色散混合成分。\n**Verdict: Incorrect.**\n\n**D. Discard the imaginary quadrature before Fourier transformation and retain only the real part of the FID, so that the spectrum will be purely absorptive and free of dispersive admixture, regardless of receiver phase.**\n\nFID的实部是 $s_x(t) = \\text{Re}[s_{\\text{meas}}(t)] = C_0 e^{-t/T_2} \\cos(\\Delta\\omega t + \\psi)$。这个实数信号的傅里叶变换会产生一个具有两个相位扭曲线峰的谱图，一个在 $\\omega = \\Delta\\omega$，一个镜像在 $\\omega = -\\Delta\\omega$。线型仍然是吸收和色散的混合，由 $\\psi$ 决定。丢弃虚部通道会丢失进行正确相位校正所需的信息，并引入伪影。声称谱图将是纯吸收型的说法是错误的。\n**Verdict: Incorrect.**\n\n**E. Use a Hilbert transform on the magnitude spectrum to reconstruct an absorption-only spectrum without determining the receiver phase and without making any assumptions about the time-domain FID behavior predicted by the Bloch equations.**\n\n这描述了一种基于Kramers-Kronig关系的方法。虽然这对于因果系统是一个有效的物理原理，但该选项明确指出它的工作方式是“无需对布洛赫方程预测的FID时域行为做任何假设”。这直接与问题的主要约束相矛盾，该约束是使用*从*布洛赫预测的行为推导出的程序。\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "布洛赫方程的强大之处不仅在于描述静态分子，更在于它能够扩展以模拟动态化学过程。本计算练习将带你进入布洛赫-麦康奈尔（Bloch-McConnell）方程的世界，这是一个用于模拟化学交换的强大框架。通过编写程序，你将亲眼观察到不同交换速率如何改变核磁共振谱线形状，从谱线展宽到合并，这是测量反应动力学和理解分子构象变化的基石。",
            "id": "3726619",
            "problem": "设计并实现一个程序，用于计算与有机化合物波谱鉴定相关的三组分核磁共振（NMR）系统的时域自由感应衰减（FID）及其频域谱，该计算使用包含化学交换的布洛赫-麦康奈尔（Bloch-McConnell）方程。其中一个组分与另一个组分发生中等速率的化学交换，目标是量化此交换如何改变复合谱线形状。\n\n从以下基本基础开始：\n- 旋转坐标系中横向磁化强度的布洛赫方程，并增加了位点之间的一级化学交换。设位点 $i$ 的复数横向磁化强度为 $m_i(t)$，其中 $i \\in \\{1,2,3\\}$。假设每个位点在静态磁场下的自由进动（包含共振偏移和横向弛豫）以及化学交换均为一级且无记忆过程。\n- 位点 $i$ 在旋转坐标系中的偏移频率为 $\\Delta \\nu_i$（单位 $\\mathrm{Hz}$），其角频率为 $\\omega_i = 2\\pi \\Delta \\nu_i$（单位 $\\mathrm{rad/s}$）。横向弛豫速率为 $R_{2,i}$（单位 $\\mathrm{s^{-1}}$）。从位点 $i$ 到位点 $j$ 的交换速率为 $k_{i\\to j}$（单位 $\\mathrm{s^{-1}}$）。\n- 横向分量的动力学是线性的，可以写成矩阵形式 $\\frac{d}{dt}\\mathbf{m}(t) = \\mathbf{A}\\,\\mathbf{m}(t)$，其中 $\\mathbf{m}(t) = [m_1(t), m_2(t), m_3(t)]^\\top$ 且 $\\mathbf{A}\\in\\mathbb{C}^{3\\times 3}$ 包含了弛豫、进动和交换。观测到的复数 FID 为 $s(t)=\\mathbf{1}^\\top \\mathbf{m}(t)$。\n- 在一个翻转角为 $\\pi/2$ 弧度（九十度）的非选择性硬脉冲之后，立即假设为小倾角、共振、理想激发，使得初始横向磁化强度与位点布居数成正比：$m_i(0)=p_i M_0$，其中 $M_0$ 是一个任意正尺度因子，在不失一般性的前提下可设为 $M_0=1$。所有角度均使用弧度。\n\n从第一性原理显式构造 $\\mathbf{A}$：\n- 对于每个位点 $i$，对角元素为 $A_{ii} = -(R_{2,i} + \\mathrm{i}\\,\\omega_i) - \\sum_{j\\neq i} k_{i\\to j}$，其中 $\\mathrm{i}$ 是虚数单位。\n- 对于 $i\\neq j$，非对角元素为 $A_{ij} = k_{j\\to i}$。\n- 于是 FID 为 $s(t) = \\mathbf{1}^\\top \\exp(\\mathbf{A} t)\\, \\mathbf{m}(0)$，其中 $\\exp$ 表示矩阵指数。\n\n数值规格和计算要求：\n- 采样：\n  - 采集点数 $N = 2048$。\n  - 驻留时间 $\\Delta t = 1/2000$ $\\mathrm{s}$（谱宽 $= 2000$ $\\mathrm{Hz}$）。\n  - 对 $n=0,1,\\dots,N-1$ 采样 $s_n = s(n\\Delta t)$。\n- 频域谱：\n  - 使用快速傅里叶变换（FFT）计算复数 FID 的离散傅里叶变换（DFT），通过标准 FFT 频率约定生成以 $\\mathrm{Hz}$ 为单位的频率轴，并通过平移将其中心对齐，使频率范围大约为 $[-1000,1000)$ $\\mathrm{Hz}$。将此网格上的复数谱表示为 $S(\\nu)$。仅报告并使用实部 $\\mathrm{Re}\\{S(\\nu)\\}$。\n  - 通过将每个谱的实部除以其在整个频率范围内的最大值来进行归一化，使其最大实数值等于 $1$。\n- 交换模型：\n  - 恰好有一对位点，即位点 2 和 3，彼此发生交换：$k_{2\\to 3}>0$ 且 $k_{3\\to 2}>0$；所有其他交换速率均为零。\n  - 位点 1 不与其他位点发生交换。\n- 与无交换情况的比较：\n  - 对于每组参数，计算两个谱：一个使用指定的交换速率，另一个将所有交换速率设为零。两者都如上所述进行归一化。\n  - 通过计算两个归一化实谱在整个频率网格上的均方根（RMS）差异，来量化交换过程如何改变复合谱线形状：\n    $$D = \\sqrt{\\frac{1}{N}\\sum_{n=0}^{N-1} \\left(S_{\\mathrm{ex}}^{\\mathrm{real}}(\\nu_n) - S_{\\mathrm{noex}}^{\\mathrm{real}}(\\nu_n)\\right)^2}.$$\n- 探针强度：\n  - 对于每组参数，还需报告在五个探针频率（单位 $\\mathrm{Hz}$）：$\\{-150,-25,0,25,150\\}$ 处的归一化实谱值。对于每个探针频率，使用计算出的频率网格上最接近的频率点。\n\n测试套件（所有频率单位为 $\\mathrm{Hz}$，所有速率单位为 $\\mathrm{s^{-1}}$，布居数为无量纲且总和为 $1$）：\n- 所有案例的通用采样参数：$N=2048$，$\\Delta t = 1/2000$ $\\mathrm{s}$，翻转角 $\\pi/2$ 弧度。\n- 案例 1（慢交换）：\n  - 布居数：$(p_1,p_2,p_3) = (0.4, 0.3, 0.3)$。\n  - 偏移：$(\\Delta \\nu_1,\\Delta \\nu_2,\\Delta \\nu_3) = (-150,-25,25)$。\n  - 横向弛豫速率：$(R_{2,1},R_{2,2},R_{2,3}) = (3,5,5)$。\n  - 交换：$k_{2\\to 3}=1$, $k_{3\\to 2}=1$。\n- 案例 2（中等交换）：\n  - 布居数：$(0.4,0.3,0.3)$。\n  - 偏移：$(-150,-25,25)$。\n  - 弛豫：$(3,5,5)$。\n  - 交换：$k_{2\\to 3}=40$, $k_{3\\to 2}=40$。\n- 案例 3（快交换）：\n  - 布居数：$(0.4,0.3,0.3)$。\n  - 偏移：$(-150,-25,25)$。\n  - 弛豫：$(3,5,5)$。\n  - 交换：$k_{2\\to 3}=500$, $k_{3\\to 2}=500$。\n- 案例 4（边界情况，无交换）：\n  - 布居数：$(0.4,0.3,0.3)$。\n  - 偏移：$(-150,-25,25)$。\n  - 弛豫：$(3,5,5)$。\n  - 交换：$k_{2\\to 3}=0$, $k_{3\\to 2}=0$。\n\n程序要求：\n- 通过迭代离散时间传播算子 $\\mathbf{P}=\\exp(\\mathbf{A}\\Delta t)$ 来实现 FID 的生成，使得 $\\mathbf{m}_{n+1}=\\mathbf{P}\\,\\mathbf{m}_n$，其中 $\\mathbf{m}_0=\\mathbf{m}(0)$ 且 $s_n=\\mathbf{1}^\\top \\mathbf{m}_n$。\n- 对于每个案例，计算：\n  - 有交换和无交换情况下归一化实谱之间的 RMS 差异 $D$。\n  - 按规定在探针频率 $\\{-150,-25,0,25,150\\}$ 处的五个归一化实谱值。\n- 最终输出格式：\n  - 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个案例，其本身是按 `` `[D, I_{-150}, I_{-25}, I_{0}, I_{25}, I_{150}]` `` 顺序排列的六个浮点数的列表，每个浮点数四舍五入到恰好六位小数。打印行中不得有任何空白字符。例如：\"[[0.012345,0.9,0.8,0.7,0.6,0.5],[...],...]\"（此处显示的值为示例占位符；你的程序必须计算实际值）。\n- 角度单位：\n  - 翻转角为 $\\pi/2$ 弧度。\n- 频率单位：\n  - 所有频率必须以 $\\mathrm{Hz}$ 表示和探测。\n- 百分比：\n  - 如果报告任何分数，请以小数形式呈现。\n\n你的程序必须是自包含的，不接受任何输入，并且只使用指定的库。其单行输出必须按上述方式汇总四个测试案例的结果。",
            "solution": "我们从旋转坐标系中横向磁化强度的布洛赫方程开始，并将其扩展以包含一级化学交换，这被称为布洛赫-麦康奈尔（Bloch–McConnell）方程。令 $\\mathbf{m}(t) = [m_1(t), m_2(t), m_3(t)]^\\top \\in \\mathbb{C}^3$ 表示三个不同位点的复数横向磁化强度。基本贡献项包括：\n- 位点 $i$ 以角偏移 $\\omega_i = 2\\pi \\Delta \\nu_i$ 进行的自由进动增加了一项 $-\\mathrm{i}\\,\\omega_i m_i$。\n- 以速率 $R_{2,i}$ 进行的横向弛豫增加了一项 $-R_{2,i} m_i$。\n- 从位点 $i$ 到 $j$ 的化学交换以速率 $k_{i\\to j}$ 减少 $m_i$（速率为 $k_{i\\to j} m_i$），而从 $j$ 到 $i$ 的交换则以速率 $k_{j\\to i}$ 增加 $m_i$（速率为 $k_{j\\to i} m_j$）。\n\n对每个位点 $i$ 求和这些贡献，得到：\n$$\n\\frac{d}{dt} m_i(t) = -\\left(R_{2,i} + \\mathrm{i}\\,\\omega_i\\right) m_i(t) - \\sum_{j\\neq i} k_{i\\to j} m_i(t) + \\sum_{j\\neq i} k_{j\\to i} m_j(t).\n$$\n以矩阵形式表示，$\\frac{d}{dt}\\mathbf{m}(t) = \\mathbf{A}\\,\\mathbf{m}(t)$，其中 $\\mathbf{A}$ 的元素为\n$$\nA_{ii} = -\\left(R_{2,i} + \\mathrm{i}\\,\\omega_i\\right) - \\sum_{j\\neq i} k_{i\\to j}, \\quad\nA_{ij} = k_{j\\to i}\\quad (i\\neq j).\n$$\n在理想的非选择性 $\\pi/2$ 激发下，观测到的复数自由感应衰减 (FID) 是横向分量的总和：\n$$\ns(t) = \\mathbf{1}^\\top \\mathbf{m}(t) = \\mathbf{1}^\\top \\exp(\\mathbf{A} t)\\,\\mathbf{m}(0),\n$$\n初始条件为 $\\mathbf{m}(0) = M_0 [p_1,p_2,p_3]^\\top$，且在不失一般性的前提下设 $M_0$ 为 1。\n\n为了数值计算 FID，我们在 $N$ 个均匀的时间点上进行采样，驻留时间为 $\\Delta t$。令 $\\mathbf{P}=\\exp(\\mathbf{A}\\Delta t)$，则离散演化满足\n$$\n\\mathbf{m}_{n+1} = \\mathbf{P} \\mathbf{m}_n,\\quad \\mathbf{m}_0 = \\mathbf{m}(0), \\quad s_n = \\mathbf{1}^\\top \\mathbf{m}_n,\\quad n=0,1,\\dots,N-1.\n$$\n对于小矩阵，这种迭代是稳定且高效的，并能提供采样后的 FID $\\{s_n\\}$。\n\n频域谱通过离散傅里叶变换（DFT）计算，并通过快速傅里叶变换（FFT）实现。设复数谱为 $S(\\nu_n)$，其中频率 $\\{\\nu_n\\}$（单位 $\\mathrm{Hz}$）由采样间隔 $\\Delta t$ 的标准 FFT 频率映射生成，然后平移以使零频率居中：\n$$\n\\nu_n = \\mathrm{fftshift}\\left(\\mathrm{fftfreq}(N,\\Delta t)\\right), \\quad S(\\nu) = \\mathrm{fftshift}\\left(\\mathrm{FFT}(\\{s_n\\})\\right).\n$$\n对于从 $t=0$ 开始的理想指数衰减，实部 $\\mathrm{Re}\\{S(\\nu)\\}$ 对应于每个非交换位点的吸收型洛伦兹线型；在交换作用下，Bloch–McConnell 动力学混合了不同位点，并根据交换速率区（慢、中、快）使谱峰分裂或并合。\n\n我们将每个谱的实部归一化，使其最大值为 1：\n$$\n\\tilde{S}_{\\mathrm{real}}(\\nu) = \\frac{\\mathrm{Re}\\{S(\\nu)\\}}{\\max_{\\nu} \\mathrm{Re}\\{S(\\nu)\\}}.\n$$\n为量化交换如何改变复合谱线形状，我们计算有交换的归一化实谱 $\\tilde{S}_{\\mathrm{ex}}(\\nu)$ 和无交换的归一化实谱 $\\tilde{S}_{\\mathrm{noex}}(\\nu)$ 之间的均方根（RMS）差异：\n$$\nD = \\sqrt{\\frac{1}{N} \\sum_{n=0}^{N-1} \\left(\\tilde{S}_{\\mathrm{ex}}(\\nu_n) - \\tilde{S}_{\\mathrm{noex}}(\\nu_n)\\right)^2 }.\n$$\n这个无量纲的度量捕捉了由交换引入的谱线展宽、并合和色散变化。\n\n算法流程如下：\n- 使用给定的 $(R_{2,i})$、转换为 $(\\omega_i = 2\\pi \\Delta \\nu_i)$ 的 $(\\Delta \\nu_i)$ 以及交换速率 $(k_{i\\to j})$ 来构造 $\\mathbf{A}$，其中只有交换对的 $k_{2\\to 3}$ 和 $k_{3\\to 2}$ 非零；位点 1 没有交换。\n- 计算 $\\mathbf{P}=\\exp(\\mathbf{A}\\Delta t)$，例如通过特征分解 $\\mathbf{A}=\\mathbf{V}\\mathbf{\\Lambda}\\mathbf{V}^{-1}$，从而 $\\exp(\\mathbf{A}\\Delta t)=\\mathbf{V}\\exp(\\mathbf{\\Lambda}\\Delta t)\\mathbf{V}^{-1}$，其中指数运算作用于对角矩阵。\n- 迭代 $\\mathbf{m}_{n+1}=\\mathbf{P}\\mathbf{m}_n$ 以生成 $n=0,\\dots,N-1$ 的 FID $\\{s_n\\}$。\n- 计算并中心化 FFT 以获得 $S(\\nu)$ 及其​​实部；如上所述进行归一化。\n- 通过设置 $k_{2\\to 3}=k_{3\\to 2}=0$（所有交换速率为零），并保持所有其他参数不变，对无交换情况重复上述过程。\n- 计算 $D$ 并通过选择最近的频率点来探测在 $\\{-150,-25,0,25,150\\}$ $\\mathrm{Hz}$ 处的归一化实谱值。\n\n测试套件的预期定性行为：\n- 案例 1（慢交换，$k_{2\\to 3}=k_{3\\to 2}=1$）应产生三个可分辨的类洛伦兹峰，分别位于 $-150$ $\\mathrm{Hz}$、$-25$ $\\mathrm{Hz}$ 和 $25$ $\\mathrm{Hz}$ 附近，与无交换情况相比畸变最小，从而得到一个较小的 $D$ 值。\n- 案例 2（中等交换，$k_{2\\to 3}=k_{3\\to 2}=40$）应使两个交换位点的峰展宽并部分并合，导致 $D$ 值显著增加；在 $-25$ $\\mathrm{Hz}$ 和 $25$ $\\mathrm{Hz}$ 附近的探针强度会发生显著变化。\n- 案例 3（快交换，$k_{2\\to 3}=k_{3\\to 2}=500$）应为位点 2 和 3 产生一个平均后的单峰，其位置接近于它们的布居数加权平均偏移（此处约 $0$ $\\mathrm{Hz}$），这会进一步改变复合谱线形状，并与案例 1 相比产生更大的 $D$ 值。\n- 案例 4（无交换）根据构造必须产生 $D=0$，因为有交换和无交换的谱完全重合；这是一个边界检查。\n\n程序数值化地实现这些步骤，使用 $N=2048$ 和 $\\Delta t = 1/2000$ $\\mathrm{s}$，并输出一个单行，其中包含对于每个案例，均方根差异 $D$ 和五个探针强度，顺序为 $[D, I_{-150}, I_{-25}, I_{0}, I_{25}, I_{150}]$，每个值四舍五入到六位小数，连接成一个方括号内的逗号分隔列表，且不含空格。这定量地展示了交换过程如何改变复合NMR谱线形状，这是有机化合物波谱鉴定中的一个关键考虑因素，因为谱线展宽和并合可以编码动态的化学过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_A_matrix(dnu_hz, R2, k23, k32):\n    \"\"\"\n    Construct the 3x3 complex Bloch-McConnell A matrix for transverse magnetization.\n    dnu_hz: list or array of length 3 with offsets in Hz [Δν1, Δν2, Δν3]\n    R2: list or array of length 3 with transverse relaxation rates in s^-1\n    k23, k32: exchange rates between site 2 and 3 in s^-1\n    Site 1 is non-exchanging; only 2->3 exchange is present.\n    \"\"\"\n    omega = 2 * np.pi * np.array(dnu_hz, dtype=float)  # rad/s\n    R2 = np.array(R2, dtype=float)\n    # Initialize A\n    A = np.zeros((3,3), dtype=complex)\n    # Diagonal terms: -(R2_i + i*omega_i) - sum_outgoing_k\n    # Off-diagonal terms: k_{j->i}\n    # Site 1: no exchange\n    A[0,0] = -(R2[0] + 1j*omega[0])\n    # Sites 2 and 3: include exchange\n    # Outgoing from 2 to 3: k23; from 3 to 2: k32\n    A[1,1] = -(R2[1] + 1j*omega[1]) - k23\n    A[2,2] = -(R2[2] + 1j*omega[2]) - k32\n    # Off-diagonals for exchange pair\n    A[1,2] = k32  # from 3 to 2\n    A[2,1] = k23  # from 2 to 3\n    return A\n\ndef propagator_from_A(A, dt):\n    \"\"\"\n    Compute the discrete-time propagator P = expm(A*dt) using eigendecomposition.\n    \"\"\"\n    vals, vecs = np.linalg.eig(A)\n    vecs_inv = np.linalg.inv(vecs)\n    exp_diag = np.exp(vals * dt)\n    P = (vecs @ np.diag(exp_diag) @ vecs_inv).astype(complex)\n    return P\n\ndef simulate_fid(P, m0, N):\n    \"\"\"\n    Iterate m_{n+1} = P m_n to generate s_n = sum(m_n) for n=0..N-1.\n    \"\"\"\n    m = m0.astype(complex)\n    s = np.empty(N, dtype=complex)\n    one = np.array([1.0, 1.0, 1.0], dtype=complex)\n    for n in range(N):\n        s[n] = one @ m\n        m = P @ m\n    return s\n\ndef spectrum_from_fid(s, dt):\n    \"\"\"\n    Compute centered FFT spectrum and frequency axis in Hz.\n    Return (freqs, S_centered).\n    \"\"\"\n    N = s.size\n    S = np.fft.fft(s) * dt  # scale by dt to approximate continuous-time FT units\n    S_shift = np.fft.fftshift(S)\n    freqs = np.fft.fftshift(np.fft.fftfreq(N, d=dt))\n    return freqs, S_shift\n\ndef nearest_bin_indices(freqs, probe_freqs):\n    \"\"\"\n    For each probe frequency, find the index of the nearest frequency bin.\n    \"\"\"\n    idxs = []\n    for f in probe_freqs:\n        idx = int(np.argmin(np.abs(freqs - f)))\n        idxs.append(idx)\n    return idxs\n\ndef normalize_real_spectrum(S_real):\n    \"\"\"\n    Normalize the real part of spectrum to have max value 1.\n    \"\"\"\n    max_val = np.max(S_real)\n    # Avoid division by zero; if all zero (shouldn't happen), return zeros\n    if max_val == 0.0:\n        return S_real\n    return S_real / max_val\n\ndef run_case(pops, dnu_hz, R2, k23, k32, N, dt, probe_freqs):\n    \"\"\"\n    Run a single test case and return (D, [I_probe...]) according to spec.\n    \"\"\"\n    # Initial magnetizations after 90-degree pulse (π/2 radians): m0 = pops (M0=1)\n    m0 = np.array(pops, dtype=float)\n    # With exchange\n    A_ex = build_A_matrix(dnu_hz, R2, k23, k32)\n    P_ex = propagator_from_A(A_ex, dt)\n    s_ex = simulate_fid(P_ex, m0, N)\n    freqs, S_ex = spectrum_from_fid(s_ex, dt)\n    S_ex_real_norm = normalize_real_spectrum(S_ex.real)\n    # Without exchange (all k=0)\n    A_no = build_A_matrix(dnu_hz, R2, 0.0, 0.0)\n    P_no = propagator_from_A(A_no, dt)\n    s_no = simulate_fid(P_no, m0, N)\n    _, S_no = spectrum_from_fid(s_no, dt)\n    S_no_real_norm = normalize_real_spectrum(S_no.real)\n    # RMS difference\n    D = float(np.sqrt(np.mean((S_ex_real_norm - S_no_real_norm) ** 2)))\n    # Probe intensities at specified frequencies\n    idxs = nearest_bin_indices(freqs, probe_freqs)\n    I_probes = [float(S_ex_real_norm[i]) for i in idxs]\n    return D, I_probes\n\ndef solve():\n    # Define sampling parameters\n    N = 2048\n    dt = 1.0 / 2000.0  # seconds\n    probe_freqs = [-150.0, -25.0, 0.0, 25.0, 150.0]  # Hz\n    # Define test cases as specified\n    test_cases = [\n        # (pops, dnu_hz, R2, k23, k32)\n        ((0.4, 0.3, 0.3), (-150.0, -25.0, 25.0), (3.0, 5.0, 5.0), 1.0, 1.0),    # Case 1: slow exchange\n        ((0.4, 0.3, 0.3), (-150.0, -25.0, 25.0), (3.0, 5.0, 5.0), 40.0, 40.0),  # Case 2: intermediate exchange\n        ((0.4, 0.3, 0.3), (-150.0, -25.0, 25.0), (3.0, 5.0, 5.0), 500.0, 500.0),# Case 3: fast exchange\n        ((0.4, 0.3, 0.3), (-150.0, -25.0, 25.0), (3.0, 5.0, 5.0), 0.0, 0.0),    # Case 4: no exchange\n    ]\n    results = []\n    for pops, dnu_hz, R2, k23, k32 in test_cases:\n        D, I_probes = run_case(pops, dnu_hz, R2, k23, k32, N, dt, probe_freqs)\n        # Round to six decimal places as required\n        out = [round(D, 6)] + [round(val, 6) for val in I_probes]\n        results.append(out)\n    # Format output with no spaces, each float with exactly six decimals\n    def format_float(x):\n        return f\"{x:.6f}\"\n    formatted_cases = []\n    for case in results:\n        formatted_cases.append(\"[\" + \",\".join(format_float(x) for x in case) + \"]\")\n    print(\"[\" + \",\".join(formatted_cases) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}