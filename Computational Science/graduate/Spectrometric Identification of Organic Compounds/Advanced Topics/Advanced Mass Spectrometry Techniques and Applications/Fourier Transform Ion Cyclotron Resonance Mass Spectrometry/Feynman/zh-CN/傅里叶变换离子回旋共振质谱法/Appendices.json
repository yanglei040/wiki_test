{
    "hands_on_practices": [
        {
            "introduction": "傅里叶变换离子回旋共振（FT-ICR）质谱的核心在于其卓越的质量测量精度，但它并非直接测量质量，而是通过精确测量离子在磁场中的回旋频率来实现。这个练习将帮助你巩固离子回旋频率与其荷质比（$m/z$）之间的反比关系，这是整个技术的基础。通过一个假设的离子阱内阳离子交换反应，你将计算出质量的微小变化如何导致可预测的频率变化，从而加深对FT-ICR基本工作原理的理解。",
            "id": "1463743",
            "problem": "在傅里叶变换离子回旋共振（FT-ICR）质谱仪中，离子被一个强而均匀的轴向磁场 $B$ 捕获于彭宁阱内。被捕获的离子在垂直于磁场的平面内进行回旋运动。该运动的角频率，即回旋频率（$\\omega_c$），通过测量可用于确定离子的质荷比。\n\n考虑一个实验，其中一个大的中性分子 $M$（其精确单一同位素质量为 $m_M = 1200.500000$ u）被电离并捕获。它最初被观测为一个单电荷钠加合物 $[M+\\text{Na}]^+$。该母离子随后在 ICR 离子阱中被分离出来。随后，将一种含钾的中性试剂引入离子阱中，引发气相阳离子交换反应，使母离子完全转化为单电荷钾加合物 $[M+\\text{K}]^+$。\n\n已知以下中性原子的精确单一同位素质量：\n- 钠原子的质量，$m_{\\text{Na}} = 22.989770$ u\n- 钾原子的质量，$m_{\\text{K}} = 38.963707$ u\n\n为便于计算，假设离子的质量是其组成的中性原子/分子质量的简单加和。计算产物离子的回旋频率与母离子的回旋频率之比，即 $\\omega_{[M+\\text{K}]^+} / \\omega_{[M+\\text{Na}]^+}$。将最终答案四舍五入至六位有效数字。",
            "solution": "在均匀磁场 $B$ 中，一个电荷为 $q$、质量为 $m$ 的离子的回旋角频率为\n$$\n\\omega_{c}=\\frac{qB}{m}.\n$$\n对于在同一磁场中的两个单电荷离子，其回旋频率之比与其质量之比成反比：\n$$\n\\frac{\\omega_{[M+\\text{K}]^{+}}}{\\omega_{[M+\\text{Na}]^{+}}}\n=\\frac{qB/m_{[M+\\text{K}]^{+}}}{qB/m_{[M+\\text{Na}]^{+}}}\n=\\frac{m_{[M+\\text{Na}]^{+}}}{m_{[M+\\text{K}]^{+}}}.\n$$\n根据题目假设，离子质量是其组成的中性原子质量之和，\n$$\nm_{[M+\\text{Na}]^{+}}=m_{M}+m_{\\text{Na}}=1200.500000+22.989770=1223.489770,\n$$\n$$\nm_{[M+\\text{K}]^{+}}=m_{M}+m_{\\text{K}}=1200.500000+38.963707=1239.463707.\n$$\n因此，\n$$\n\\frac{\\omega_{[M+\\text{K}]^{+}}}{\\omega_{[M+\\text{Na}]^{+}}}\n=\\frac{1223.489770}{1239.463707}\n=1-\\frac{1239.463707-1223.489770}{1239.463707}\n=1-\\frac{15.973937}{1239.463707}.\n$$\n数值上，\n$$\n\\frac{15.973937}{1239.463707}=0.0128877811506\\ldots,\n$$\n所以\n$$\n\\frac{\\omega_{[M+\\text{K}]^{+}}}{\\omega_{[M+\\text{Na}]^{+}}}=0.987112218849\\ldots \\approx 0.987112\n$$\n四舍五入至六位有效数字后。",
            "answer": "$$\\boxed{0.987112}$$"
        },
        {
            "introduction": "了解了如何通过频率测量质量后，一个自然而然的问题是：我们能多好地区分两个质量极其相近的离子？本练习将引出并应用“质量分辨率”这一关键性能指标。通过一个鉴定未知化合物的实际场景，你将计算区分两种可能的分子式所需的最低分辨率，并评估包括FT-ICR在内的高分辨质谱仪是否能够胜任这项挑战，从而将抽象的分辨率概念与解决分析化学问题的能力直接联系起来。",
            "id": "3715422",
            "problem": "一个未知化合物经高分辨质谱检测，在 $m/z = 300$ 处产生一个单电荷的单同位素峰。在 $m/z = 300$ 附近，有两个可能的元素式归属，其计算出的精确单同位素质量相差 $3\\ \\text{mDa}$。在有机化合物的质谱鉴定中，标称质量是将分子质量四舍五入到最接近整数的整数质量，而精确质量是根据构成元素的同位素质量计算得出的，单同位素质量则对应于使用最丰富同位素的质量。使用基于半峰全宽（FWHM）的分辨率操作性定义，确定在 $m/z = 300$ 处基线分辨这两个候选分子式所需的最低分辨率。然后，基于此要求，评估在相同的采集条件下，以下仪器是否能够实现基线分辨：一台分辨率为 $R = 40{,}000$（在 $m/z = 300$ 处）的 Quadrupole Time-of-Flight (Q-TOF)，一台分辨率为 $R = 240{,}000$（在 $m/z = 300$ 处）的 Orbitrap high-field analyzer，以及一台分辨率为 $R = 450{,}000$（在 $m/z = 300$ 处）的 Fourier Transform Ion Cyclotron Resonance (FT-ICR) mass spectrometer。将计算出的最低分辨率四舍五入至四位有效数字，并以无量纲的分辨率形式表示您的答案。",
            "solution": "首先对问题进行验证，以确保其科学性和逻辑完整性。\n\n### 步骤 1：提取已知条件\n- 在质荷比 $m/z = 300$ 处观测到一个单电荷单同位素峰。\n- 两个可能的候选分子式的计算精确单同位素质量相差 $\\Delta m = 3\\ \\text{mDa}$。\n- 该质量差出现在 $m/z = 300$ 附近。\n- 分辨率 $R$ 定义在半峰全宽（FWHM）处。\n- 目标是求出基线分辨所需的最低分辨率 $R_{min}$。\n- 提供了三台质谱仪的规格用于可行性评估：\n    1. Q-TOF: 在 $m/z = 300$ 处，$R = 40,000$。\n    2. Orbitrap: 在 $m/z = 300$ 处，$R = 240,000$。\n    3. FT-ICR: 在 $m/z = 300$ 处，$R = 450,000$。\n- 最终计算的分辨率必须四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它利用了质谱学的基本概念，如分辨率、质荷比和质量准确度。所提供的 $m/z$、质量差和仪器分辨率值是现实的，并与现代分析化学实践相符。问题陈述提供了明确的目标和充分的信息，足以得出一个唯一的、有意义的解。术语“基线分辨”需要一个标准的解释。在基于 FWHM 的分辨率定义背景下，分辨两个等高峰相邻峰的最低条件是，它们的峰顶间距（$\\Delta m$）等于单个峰的 FWHM（$\\Delta m_{FWHM}$）。此标准确保了峰之间有明显的谷，是此类问题的标准解释。因此，该问题没有规定不足。\n\n### 步骤 3：结论与行动\n该问题被判定为有效。现提供完整解答。\n\n### 解题推导\n\n质谱仪的分辨率 $R$ 是衡量其区分两个质荷比略有不同的峰的能力的指标。基于单个峰的半峰全宽（FWHM）的操作性定义由下式给出：\n$$\nR = \\frac{m}{\\Delta m_{FWHM}}\n$$\n其中 $m$ 是目标离子的质荷比，$\\Delta m_{FWHM}$ 是峰高为最大高度 $50\\%$ 处的峰宽。\n\n问题要求确定“基线分辨”两个峰所需的最低分辨率。对于两个强度和宽度相等的高斯峰，认为它们被分辨（即在它们之间看到一个谷）的最低条件是，它们的中心间距 $\\Delta m$ 等于其中一个峰的 FWHM。为了达到所需的最低分辨率 $R_{min}$，我们必须使峰宽 $\\Delta m_{FWHM}$ 至多等于我们希望分离的两种物质之间的质量差。\n$$\n\\Delta m_{FWHM} \\le \\Delta m\n$$\n为了求得最低分辨率，我们将峰宽设置为其允许的最大分辨值，即质量差本身：\n$$\n\\Delta m_{FWHM} = \\Delta m\n$$\n将此条件代入分辨率的定义方程，得到所需最低分辨率 $R_{min}$ 的表达式：\n$$\nR_{min} = \\frac{m}{\\Delta m}\n$$\n问题陈述分析的是在 $m/z = 300$ 处的单电荷离子（$z=1$）。因此，离子的质量 $m$ 为 $300\\ \\text{Da}$。两个候选分子式之间的质量差为 $\\Delta m = 3\\ \\text{mDa}$。我们必须将其转换为道尔顿（Da）以保持单位一致：\n$$\n\\Delta m = 3\\ \\text{mDa} = 3 \\times 10^{-3}\\ \\text{Da} = 0.003\\ \\text{Da}\n$$\n现在我们可以计算所需的最低分辨率：\n$$\nR_{min} = \\frac{300\\ \\text{Da}}{0.003\\ \\text{Da}} = \\frac{300}{3 \\times 10^{-3}} = 100 \\times 10^3 = 100000\n$$\n问题要求将此结果四舍五入至四位有效数字。为了用四位有效数字表示 $100000$，我们使用科学记数法：$1.000 \\times 10^5$。\n\n接下来，我们评估所列三台仪器的可行性。如果一台仪器的指定分辨率 $R_{\\text{instrument}}$ 大于或等于所需的最低分辨率 $R_{min}$，则认为该仪器是可行的。\n$$\nR_{\\text{instrument}} \\ge R_{min}\n$$\n在这种情况下，可行性的条件是 $R_{\\text{instrument}} \\ge 100000$。\n\n1.  **Q-TOF Mass Spectrometer**：\n    指定的分辨率为 $R_{Q-TOF} = 40000$。\n    与要求相比：$40000 < 100000$。\n    结论：Q-TOF 仪器**不可行**用于分辨这两个候选物。\n\n2.  **Orbitrap High-Field Analyzer**：\n    指定的分辨率为 $R_{Orbitrap} = 240000$。\n    与要求相比：$240000 > 100000$。\n    结论：Orbitrap 仪器**可行**用于分辨这两个候选物。\n\n3.  **FT-ICR Mass Spectrometer**：\n    指定的分辨率为 $R_{FT-ICR} = 450000$。\n    与要求相比：$450000 > 100000$。\n    结论：FT-ICR 仪器**可行**用于分辨这两个候选物。\n\n因此，所需的最低分辨率为 $1.000 \\times 10^5$，并且 Orbitrap 和 FT-ICR 仪器均满足此要求。",
            "answer": "$$\n\\boxed{1.000 \\times 10^{5}}\n$$"
        },
        {
            "introduction": "最后，让我们深入探讨FT-ICR技术名称中“傅里叶变换”的内涵，这正是该技术强大功能的信号处理核心。这个计算实践将通过编程模拟一个FT-ICR瞬态信号，来揭示一个常见但关键的概念。通过这个练习，你将亲自验证“零填充”操作如何能够提高谱图上峰形的插值精度，同时也会明白为何它不能提高由采集时间决定的“真实”分辨率，从而澄清一个关于数据处理的重要认知。",
            "id": "3702851",
            "problem": "设计并实现一个完整的、可运行的程序，使用模拟的傅里叶变换离子回旋共振（FT-ICR）质谱瞬态信号，演示补零对峰插值的影响以及真实分辨本领的不变性。目标是证明补零增加了离散频谱的采样密度，从而对峰顶进行插值，但并未提高由有限采集时间决定的真实分辨本领。从离散采样和离散傅里叶变换（DFT）的基本原理开始，除了这些基本原理外，不假设或使用任何快捷公式。\n\n使用以下基本原理：\n- 一维时间域上的FT-ICR瞬态信号可以建模为指数衰减余弦函数的和：\n$$ s(t) = \\sum_{i=1}^{M} A_i e^{-t/\\tau} \\cos\\left(2\\pi f_i t + \\phi_i\\right), $$\n其中 $A_i$ 是幅度，$\\tau$ 是衰减常数（为简化起见，假设所有分量共用），$f_i$ 是回旋频率，$\\phi_i$ 是相位。\n- 对以采样频率 $F_s$ 均匀采样的 $N$ 个点进行离散傅里叶变换（DFT），得到的频率箱间距为\n$$ \\Delta f = \\frac{F_s}{N} = \\frac{1}{T}, $$\n其中 $T$ 是非零瞬态信号的总采集时间（秒），$T = N/F_s$。\n- 此处定义的补零是指在进行DFT之前，在瞬态信号的末尾追加零，使得变换长度变为 $M = z N$，其中 $z$ 是一个整数补零因子（$z \\ge 1$）。DFT的频率箱间距变为 $\\Delta f_{\\text{bin}} = F_s/M$，但由有限时长窗函数引起的谱包络保持不变。\n\n您的程序必须：\n1.  在区间 $t \\in [0, T)$ 上，以 $F_s$ 的采样率对瞬态信号 $s(t)$ 进行模拟，用于下述测试用例。实现一个函数，该函数在一个长度为 $M = z N$（其中 $z$ 是补零因子）的补零向量上，使用快速傅里叶变换（FFT）算法计算单边幅谱。对单边幅谱进行归一化，使得位于精确DFT频率箱上、幅度为 $A$ 的余弦波，其谱峰幅度等于 $A$（即，对于实值瞬态信号，对其复数FFT的幅度使用 $2/M$ 的缩放因子）。\n2.  对于每个频谱，通过扫描单边谱来确定最大幅度以及该最大值出现的频率。在单分量测试用例中，为每个补零因子报告这两个量。\n3.  通过评估从有限时长采集导出的可分辨性判据，证明真实分辨本领不受补零影响：两个频率为 $f_1$ 和 $f_2$ 的音调被认为是真正可分辨的，当且仅当 $|f_2 - f_1| > 1/T$。为两个双峰测试用例（一个低于分辨率极限，一个高于分辨率极限），计算并为每个补零因子报告一个布尔值。\n\n物理单位和约定：\n- 频率必须以赫兹（Hz）为单位处理和报告。\n- 时间必须以秒（s）为单位处理和指定。\n- 角度（相位）可设置为零；输出中不要求与角度相关的量。\n- 幅度为任意单位且无量纲。\n- 所有报告的浮点数结果必须四舍五入到六位小数。\n- 布尔值必须打印为 True 或 False。\n\n测试套件规范：\n- 采样频率：$F_s = 65536$ Hz。\n- 采集时间：$T = 0.25$ s。\n- 非零样本数：$N = F_s T = 16384$ 个样本。\n- 公共衰减常数：$\\tau = 10.0$ s。\n- 相位：对所有 $i$，$\\phi_i = 0$。\n- 待评估的补零因子：$z \\in \\{1, 2, 4\\}$。\n\n案例A（单分量，通过补零进行峰插值）：\n- 一个分量，其 $A_1 = 1.0$，$f_1 = 10000.5$ Hz。\n- 对每个 $z \\in \\{1, 2, 4\\}$，计算并报告：\n  - 最大单边幅度 $m_{\\max}(z)$（无量纲，四舍五入到六位小数）。\n  - 最大值出现的频率 $f_{\\max}(z)$（Hz，四舍五入到六位小数）。\n\n案例B（双峰，低于分辨率极限）：\n- 两个分量，其 $A_1 = A_2 = 1.0$，频率为 $f_1 = 10000.5$ Hz 和 $f_2 = f_1 + 0.5 \\Delta f$，其中 $\\Delta f = 1/T$。\n- 对每个 $z \\in \\{1, 2, 4\\}$，计算并报告一个布尔值，指示 $|f_2 - f_1| > 1/T$。这评估了真实分辨本领，且必须与 $z$ 无关。\n\n案例C（双峰，高于分辨率极限）：\n- 两个分量，其 $A_1 = A_2 = 1.0$，频率为 $f_1 = 10000.5$ Hz 和 $f_2 = f_1 + 1.1 \\Delta f$，其中 $\\Delta f = 1/T$。\n- 对每个 $z \\in \\{1, 2, 4\\}$，计算并报告相同的布尔值 $|f_2 - f_1| > 1/T$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个由四个列表组成的逗号分隔列表，顺序如下：\n  - 对于 $z \\in \\{1, 2, 4\\}$ 的 $m_{\\max}(z)$ 列表。\n  - 对于 $z \\in \\{1, 2, 4\\}$ 的 $f_{\\max}(z)$ 列表。\n  - 对于 $z \\in \\{1, 2, 4\\}$ 的案例B的布尔值列表。\n  - 对于 $z \\in \\{1, 2, 4\\}$ 的案例C的布尔值列表。\n例如，打印的行必须如下所示：\n$$ [ [m_{\\max}(1), m_{\\max}(2), m_{\\max}(4)], [f_{\\max}(1), f_{\\max}(2), f_{\\max}(4)], [\\text{B}_1, \\text{B}_2, \\text{B}_4], [\\text{C}_1, \\text{C}_2, \\text{C}_4] ] $$\n所有浮点数四舍五入到六位小数，所有布尔值呈现为 True 或 False。",
            "solution": "该问题是有效的。它在科学上基于傅里叶分析和数字信号处理原理在傅里叶变换离子回旋共振（FT-ICR）质谱中的应用。问题设定良好，为进行唯一且有意义的计算演示提供了所有必要的参数和定义。\n\n其目标是使用模拟的FT-ICR瞬态信号来演示离散傅里叶变换（DFT）的两个基本属性：第一，补零如何提高峰参数估计的准确性（插值）；第二，补零并不能提高真实的分辨本领，后者从根本上受限于信号的采集时间。\n\n**1. 信号模型与离散化**\n\n问题提供了一个FT-ICR瞬态信号 $s(t)$ 的连续时间模型，该模型是 $M$ 个指数衰减正弦波的和：\n$$ s(t) = \\sum_{i=1}^{M} A_i e^{-t/\\tau} \\cos\\left(2\\pi f_i t + \\phi_i\\right) $$\n这里，$A_i$ 是幅度，$\\tau$ 是信号衰减常数，$f_i$ 是离子的回旋频率，$\\phi_i$ 是其初始相位。对于本分析，我们假设所有分量的衰减常数均为 $\\tau = 10.0$ s，初始相位均为 $\\phi_i = 0$。\n\n为了对该信号进行数字处理，我们必须在离散的时间间隔内对其进行采样。我们在总时长 $T = 0.25$ s 内，以 $F_s = 65536$ Hz 的采样频率对信号进行采样。这产生了 $N = F_s T = 16384$ 个离散数据点。第 $k$ 个样本的时间（其中 $k$ 是从 $0$ 到 $N-1$ 的整数）由 $t_k = k/F_s$ 给出。因此，离散时间信号（表示为 $s[k]$）为：\n$$ s[k] = s(t_k) = \\sum_{i=1}^{M} A_i e^{-t_k/\\tau} \\cos\\left(2\\pi f_i t_k\\right) $$\n对于 $k = 0, 1, \\dots, N-1$。\n\n**2. 离散傅里叶变换、补零与频谱计算**\n\nDFT将时域信号 $s[k]$ 转换为频域表示。快速傅里叶变换（FFT）是计算DFT的一种高效算法。\n\n补零是在执行FFT之前，在采集到的信号 $s[k]$ 的末尾追加零的过程。如果我们从 $N$ 个数据点开始，并追加 $(z-1)N$ 个零，则用于变换的信号总长度变为 $M_{len} = zN$，其中 $z \\ge 1$ 是补零因子。\n\n对长度为 $M_{len}$ 的实值信号进行DFT，会得到一组 $M_{len}$ 个复数。这些数对应于从 $0$ Hz 到 $F_s$ 的频率。对于实值输入，得到的频谱是共轭对称的，因此我们只需要分析单边频谱，它包含了从 $0$ Hz 到奈奎斯特频率 $F_s/2$ 的频率信息。单边频谱中的点数为 $M_{len}/2 + 1$。\n\nDFT的频率分辨率，或相邻频率箱之间的间距，由 $\\Delta f_{\\text{bin}} = F_s / M_{len}$ 给出。通过补零增加变换长度 $M_{len}$（即增加 $z$），我们减小了频率箱间距 $\\Delta f_{\\text{bin}$，从而有效地以更高的密度对信号的底层连续傅里叶变换进行采样。\n\n频域信号的幅度由FFT的复数输出计算得出。为了将频谱中的峰值幅度与原始余弦波的幅度 $A_i$ 关联起来，我们必须应用一个归一化因子。对于长度为 $M_{len}$ 的实信号的单边谱，位于非零和非奈奎斯特频率处的分量幅度需要乘以 $2/M_{len}$。直流分量（在 $0$ Hz）和奈奎斯特分量（在 $F_s/2$）则乘以 $1/M_{len}$。\n\n**3. 案例A：通过补零进行峰插值**\n\n该案例使用一个单一的正弦分量，其幅度 $A_1 = 1.0$，频率 $f_1 = 10000.5$ Hz。这个频率被特意选择在不进行补零的DFT的自然频率箱之间。\n\n不补零时（$z=1$），频率箱间距为 $\\Delta f = F_s/N = 65536/16384 = 4$ Hz。频率箱位于 $4$ Hz 的整数倍处（例如 $10000$ Hz, $10004$ Hz 等）。信号频率 $f_1 = 10000.5$ Hz 与任何一个频率箱都不重合。因此，信号能量会分散到多个频率箱中，离散频谱中测得的最大幅度 $m_{\\max}(1)$ 将低于真实幅度 $A_1=1.0$（这种效应称为扇形损失）。与此最大值对应的频率 $f_{\\max}(1)$ 将是最近的频率箱的频率，而不是真实的信号频率。\n\n通过应用补零因子 $z=2$ 和 $z=4$，变换长度分别增加到 $M_{len}=32768$ 和 $M_{len}=65536$。频率箱间距减小到 $\\Delta f_{\\text{bin}} = 2$ Hz 和 $\\Delta f_{\\text{bin}} = 1$ Hz。这种对谱包络的更精细采样意味着DFT的某个频率点将更接近底层连续谱的真实峰值。结果是，测得的最大幅度 $m_{\\max}(z)$ 将增加并趋近于真实幅度 $A_1$，而测得的频率 $f_{\\max}(z)$ 将更好地估计真实频率 $f_1$。这证明了补零作为一种插值方法，改善了从离散频谱中对峰参数的估计。\n\n**4. 案例B和C：真实分辨本领的不变性**\n\n区分两个紧密间隔的峰的能力被称为分辨本领。对于在有限时长 $T$ 内采集的信号，分辨本领的基本极限由不确定性原理决定。与有限时长信号相关的谱峰具有有限的宽度，该宽度与 $T$ 成反比。一个用于分辨两个等强度峰的常用判据，即瑞利判据，指出如果两个峰的频率间隔大于仪器线型主瓣的宽度，则它们是可分辨的。对于持续时间为 $T$ 的矩形时域窗，这转化为条件：两个频率 $f_1$ 和 $f_2$ 是真正可分辨的，当且仅当：\n$$ |f_2 - f_1| > \\frac{1}{T} $$\n值 $\\Delta f_{res} = 1/T$ 是分辨率极限。在本问题中，$T=0.25$ s，因此分辨率极限是 $1/0.25 = 4$ Hz。\n\n补零增加了频谱中的点数，但没有增加关于信号的新信息；它不能减小由 $T$ 固定的谱峰的固有宽度。因此，真实的分辨本领对于补零是不变的。\n\n- **案例B（低于分辨率极限）：** 频率为 $f_1 = 10000.5$ Hz 和 $f_2 = f_1 + 0.5 \\Delta f_{res} = 10000.5 + 0.5 \\times 4 = 10002.5$ Hz。频率间隔为 $|f_2 - f_1| = 2$ Hz。由于 $2 \\text{ Hz} \\ngtr 4 \\text{ Hz}$，可分辨性条件为**假**。无论补零因子 $z$ 为何值，这都成立。这两个信号不是真正可分辨的。\n\n- **案例C（高于分辨率极限）：** 频率为 $f_1 = 10000.5$ Hz 和 $f_2 = f_1 + 1.1 \\Delta f_{res} = 10000.5 + 1.1 \\times 4 = 10004.9$ Hz。频率间隔为 $|f_2 - f_1| = 4.4$ Hz。由于 $4.4 \\text{ Hz} > 4 \\text{ Hz}$，可分辨性条件为**真**。同样，无论补零因子 $z$ 为何值，这也成立。这两个信号是真正可分辨的。\n\n程序将为每个 $z$ 值计算这些布尔值，以明确地证明这种不变性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates FT-ICR transients to demonstrate the effects of zero-filling on\n    peak interpolation and the invariance of true resolving power.\n    \"\"\"\n    \n    # Test suite specification\n    Fs = 65536.0  # Sampling frequency in Hz\n    T = 0.25      # Acquisition time in seconds\n    N = int(Fs * T) # Number of non-zero samples\n    tau = 10.0      # Common decay constant in seconds\n    phi = 0.0       # Common phase in radians\n    z_factors = [1, 2, 4] # Zero-fill factors\n    \n    # Time vector for the non-zero transient\n    t = np.arange(N) / Fs\n\n    def generate_transient(frequencies, amplitudes, t_vec, tau_val, phi_val):\n        \"\"\"\n        Generates a transient signal as a sum of exponentially damped cosines.\n        \"\"\"\n        signal = np.zeros_like(t_vec)\n        for f, A in zip(frequencies, amplitudes):\n            signal += A * np.exp(-t_vec / tau_val) * np.cos(2 * np.pi * f * t_vec + phi_val)\n        return signal\n\n    def compute_spectrum(transient, z, Fs_val):\n        \"\"\"\n        Computes the one-sided magnitude spectrum of a transient using FFT\n        with zero-filling.\n        \"\"\"\n        N_transient = len(transient)\n        M_len = z * N_transient # Total length after zero-filling\n\n        # Create the zero-filled signal\n        padded_signal = np.zeros(M_len)\n        padded_signal[:N_transient] = transient\n\n        # Compute the one-sided FFT\n        # np.fft.rfft is efficient for real inputs\n        fft_complex = np.fft.rfft(padded_signal)\n        \n        # Frequency axis for the one-sided spectrum\n        freq_axis = np.fft.rfftfreq(M_len, d=1.0/Fs_val)\n\n        # Compute magnitude and apply normalization\n        # Scale factor is 2/M for a one-sided spectrum to preserve amplitude\n        magnitude = np.abs(fft_complex) * (2.0 / M_len)\n        \n        # The DC component (at index 0) is not doubled\n        magnitude[0] /= 2.0\n        \n        return freq_axis, magnitude\n\n    # --- Case A: Single component, peak interpolation ---\n    case_A_freqs = [10000.5]\n    case_A_amps = [1.0]\n    transient_A = generate_transient(case_A_freqs, case_A_amps, t, tau, phi)\n    \n    m_max_results = []\n    f_max_results = []\n\n    for z in z_factors:\n        freqs, mags = compute_spectrum(transient_A, z, Fs)\n        max_idx = np.argmax(mags)\n        m_max = mags[max_idx]\n        f_max = freqs[max_idx]\n        \n        m_max_results.append(round(m_max, 6))\n        f_max_results.append(round(f_max, 6))\n\n    # --- Case B: Doublet, below resolution limit ---\n    delta_f_res = 1.0 / T\n    f1_B = 10000.5\n    f2_B = f1_B + 0.5 * delta_f_res\n    \n    bool_B_results = []\n    for z in z_factors:\n        # The resolvability criterion is independent of z\n        is_resolvable = (abs(f2_B - f1_B) > delta_f_res)\n        bool_B_results.append(is_resolvable)\n\n    # --- Case C: Doublet, above resolution limit ---\n    f1_C = 10000.5\n    f2_C = f1_C + 1.1 * delta_f_res\n\n    bool_C_results = []\n    for z in z_factors:\n        # The resolvability criterion is independent of z\n        is_resolvable = (abs(f2_C - f1_C) > delta_f_res)\n        bool_C_results.append(is_resolvable)\n\n    # Compile all results into the final list structure\n    final_results = [\n        m_max_results,\n        f_max_results,\n        bool_B_results,\n        bool_C_results\n    ]\n\n    # Format the output string exactly as required\n    print(str(final_results).replace(\"'\", \"\").replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}