{
    "hands_on_practices": [
        {
            "introduction": "这项实践练习是光解离作用谱学中的一项基本任务：将实验中测得的碎片离子原始计数，转化为分子的绝对吸收截面。这项练习强调了考虑实际实验条件的重要性，例如非均匀的高斯激光束轮廓及其与离子云的空间交叠。通过精确处理这些几何因素，您可以练习如何将第一性原理应用于真实世界的复杂数据，从而获得基础的分子物理化学参数。",
            "id": "3718304",
            "problem": "一个孤立的、经质量选择的有机阳离子被限制在射频离子阱中，并用波长为 $\\lambda = 532~\\mathrm{nm}$ 的受激辐射光放大（激光，LASER）的单纳秒脉冲进行辐照。脉冲能量为 $E_{p} = 0.35~\\mathrm{mJ}$。脉冲的横向能量密度分布可以很好地近似为一个 $1/e^{2}$ 半径为 $w = 0.50~\\mathrm{mm}$ 的圆柱对称高斯分布。离子云以光束轴为中心，并均匀分布在一个半径为 $R = 0.25~\\mathrm{mm}$ 的圆盘内。辐照前，母离子的数量为 $N_{0} = 2.00 \\times 10^{5}$。脉冲过后，在一个诊断通道中探测到的碎片离子数量为 $N_{\\mathrm{frag}} = 3.60 \\times 10^{4}$。碎片探测效率为 $\\eta = 0.85$，进入所监测碎片通道的单分子解离分支比为 $\\beta = 0.80$。假设为单光子吸收，当进入该碎片通道时发生瞬时单分子解离，在脉冲时间尺度上激发态弛豫可忽略不计，离子云内无重吸收或屏蔽效应，并且除单个脉冲的 Beer-Lambert 指数形式所包含的情况外，脉冲期间每个离子的多重吸收事件可忽略不计。\n\n从 Beer-Lambert 定律和光解离作用产额的定义出发，推导并计算该阳离子在 $\\lambda = 532~\\mathrm{nm}$ 处的单光子吸收截面 $\\sigma$。在给定的高斯光束和均匀离子密度假设下，精确处理整个离子盘上光子通量的空间变化。使用由这些假设和基本定义所隐含的、在圆盘上的单脉冲平均吸收概率的精确表达式。使用的物理常数为 Planck 常数 $h = 6.62607015 \\times 10^{-34}~\\mathrm{J\\,s}$ 和光速 $c = 2.99792458 \\times 10^{8}~\\mathrm{m\\,s^{-1}}$。\n\n将 $\\sigma$ 的最终结果以 $\\mathrm{cm}^{2}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "用户要求我解决一个有机化合物光谱鉴定领域的问题，具体聚焦于光解离作用光谱学。我将首先验证问题的陈述，如果有效，则提供详细的解决方案。\n\n### 步骤 1：提取已知条件\n-   来源：受激辐射光放大（激光，LASER）脉冲\n-   波长：$\\lambda = 532~\\mathrm{nm}$\n-   脉冲能量：$E_{p} = 0.35~\\mathrm{mJ}$\n-   脉冲轮廓：圆柱对称高斯分布\n-   $1/e^2$ 半径：$w = 0.50~\\mathrm{mm}$\n-   离子云分布：均匀圆盘\n-   离子云半径：$R = 0.25~\\mathrm{mm}$\n-   初始母离子数：$N_{0} = 2.00 \\times 10^{5}$\n-   探测到的碎片离子数：$N_{\\mathrm{frag}} = 3.60 \\times 10^{4}$\n-   碎片探测效率：$\\eta = 0.85$\n-   单分子解离分支比：$\\beta = 0.80$\n-   假设：单光子吸收，瞬时单分子解离，可忽略的激发态弛豫，无重吸收/屏蔽，多重吸收由 Beer-Lambert 指数形式处理。\n-   所需常数：Planck 常数 $h = 6.62607015 \\times 10^{-34}~\\mathrm{J\\,s}$，光速 $c = 2.99792458 \\times 10^{8}~\\mathrm{m\\,s^{-1}}$。\n-   目标：计算单光子吸收截面 $\\sigma$，以 $\\mathrm{cm}^2$ 为单位，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题描述了一个离子阱中的标准光解离实验，这是质谱学和物理化学中的常用技术。高斯光束、光子通量、吸收截面和 Beer-Lambert 定律等概念是物理学和化学的基本原理。该实验设置是科学上现实的。\n-   **适定性：** 提供了所有必要的参数（$E_{p}$、$\\lambda$、$w$、$R$、$N_{0}$、$N_{\\mathrm{frag}}$、$\\eta$、$\\beta$），以建立一个可以求解未知截面 $\\sigma$ 的定量关系。问题要求对空间平均进行精确处理，从而得到一个唯一定义的积分。\n-   **客观性：** 问题以精确、定量和无偏见的语言陈述。\n\n这个问题需要解一个超越方程。虽然这在数学上比较高深，但并不会使问题无效。使用级数展开来近似求解是解决此类问题的标准而严谨的数学方法。因此，该问题被认定为有效。\n\n### 步骤 3：结论与行动\n问题有效。将提供详细的解决方案。\n\n### 解题推导\n\n目标是确定单光子吸收截面 $\\sigma$。这个量将离子吸收一个光子的概率与局部光子通量联系起来。\n\n首先，我们将探测到的碎片离子数 $N_{\\mathrm{frag}}$ 与发生光吸收的母离子总数 $N_{\\mathrm{abs}}$ 联系起来。在监测通道中产生的碎片离子数是探测到的数量除以探测效率，即 $N_{\\mathrm{frag}}/\\eta$。这个数量是解离的离子总数的一部分，比例为 $\\beta$。假设解离是光子吸收的唯一结果。因此，吸收光子的离子总数为：\n$$\nN_{\\mathrm{abs}} = \\frac{N_{\\mathrm{frag}}}{\\eta \\beta}\n$$\n代入给定值：\n$$\nN_{\\mathrm{abs}} = \\frac{3.60 \\times 10^{4}}{0.85 \\times 0.80} = \\frac{3.60 \\times 10^{4}}{0.68} \\approx 52941.176\n$$\n整个离子云的平均吸收概率是吸收的离子数与初始离子数的比值：\n$$\n\\langle P_{\\mathrm{abs}} \\rangle = \\frac{N_{\\mathrm{abs}}}{N_{0}} = \\frac{52941.176...}{2.00 \\times 10^{5}} \\approx 0.264706\n$$\n单个离子在给定位置的吸收概率取决于局域光子通量 $\\Phi(r)$。问题指出，这种关系遵循 Beer-Lambert 定律，对于光束中的单个粒子，其吸收概率为：\n$$\nP_{\\mathrm{abs}}(r) = 1 - \\exp(-\\sigma \\Phi(r))\n$$\n光子通量 $\\Phi(r)$ 是单位面积的光子数。它由能量密度 $F(r)$ 导出，后者具有高斯分布：\n$$\nF(r) = F_{0} \\exp\\left(-\\frac{2r^2}{w^2}\\right)\n$$\n其中 $F_{0}$ 是光束中心（$r=0$）的峰值能量密度，$w$ 是 $1/e^2$ 半径。总脉冲能量 $E_{p}$ 是能量密度在整个光束面积上的积分：\n$$\nE_{p} = \\int_0^{2\\pi} \\int_0^{\\infty} F(r) r \\, dr \\, d\\theta = 2\\pi F_{0} \\int_0^{\\infty} r \\exp\\left(-\\frac{2r^2}{w^2}\\right) dr = 2\\pi F_{0} \\left(\\frac{w^2}{4}\\right) = \\frac{\\pi w^2}{2} F_{0}\n$$\n由此，峰值能量密度为 $F_{0} = \\frac{2E_{p}}{\\pi w^2}$。单个光子的能量为 $E_{\\mathrm{photon}} = \\frac{hc}{\\lambda}$。光子通量为 $\\Phi(r) = F(r)/E_{\\mathrm{photon}}$，因此峰值光子通量为：\n$$\n\\Phi_{0} = \\frac{F_{0}}{E_{\\mathrm{photon}}} = \\frac{2 E_{p} \\lambda}{\\pi w^2 hc}\n$$\n光子通量分布为 $\\Phi(r) = \\Phi_{0} \\exp(-2r^2/w^2)$。让我们计算一下 $\\Phi_{0}$ 的值：\n$E_{p} = 0.35 \\times 10^{-3}~\\mathrm{J}$\n$\\lambda = 532 \\times 10^{-9}~\\mathrm{m}$\n$w = 0.50 \\times 10^{-3}~\\mathrm{m}$\n$h = 6.62607015 \\times 10^{-34}~\\mathrm{J\\,s}$\n$c = 2.99792458 \\times 10^{8}~\\mathrm{m\\,s^{-1}}$\n$$\n\\Phi_{0} = \\frac{2 (0.35 \\times 10^{-3}) (532 \\times 10^{-9})}{\\pi (0.50 \\times 10^{-3})^2 (6.62607015 \\times 10^{-34}) (2.99792458 \\times 10^{8})} \\approx 2.3873 \\times 10^{21}~\\mathrm{m^{-2}}\n$$\n吸收的离子总数通过在离子盘面积上对吸收概率进行积分得到，并由离子面密度 $n_A(r)$ 加权。离子均匀分布在半径为 $R$ 的圆盘内，因此对于 $r \\le R$，$n_A = N_0 / (\\pi R^2)$。\n$$\nN_{\\mathrm{abs}} = \\int_{\\text{disk}} n_A P_{\\mathrm{abs}}(r) \\, dA = \\frac{N_0}{\\pi R^2} \\int_0^{2\\pi} \\int_0^R \\left(1 - \\exp(-\\sigma \\Phi_0 e^{-2r^2/w^2})\\right) r \\, dr \\, d\\theta\n$$\n平均概率为：\n$$\n\\langle P_{\\mathrm{abs}} \\rangle = \\frac{N_{\\mathrm{abs}}}{N_0} = \\frac{2}{R^2} \\int_0^R \\left(1 - \\exp(-\\sigma \\Phi_0 e^{-2r^2/w^2})\\right) r \\, dr\n$$\n为了解这个积分，我们进行变量替换。令 $u = 2r^2/w^2$。则 $du = (4r/w^2) dr$，这意味着 $r dr = (w^2/4) du$。积分限从 $r=0$ 到 $r=R$ 变为 $u=0$ 到 $u=U=2R^2/w^2$。令 $C = \\sigma \\Phi_{0}$。\n$$\n\\langle P_{\\mathrm{abs}} \\rangle = \\frac{2}{R^2} \\int_0^{U} \\left(1 - \\exp(-C e^{-u})\\right) \\frac{w^2}{4} du = \\frac{w^2}{2R^2} \\int_0^U (1 - \\exp(-C e^{-u})) du = \\frac{1}{U} \\int_0^U (1 - \\exp(-C e^{-u})) du\n$$\n积分 $\\int \\exp(-C e^{-u}) du$ 与指数积分函数 $E_1(z) = \\int_z^\\infty \\frac{e^{-t}}{t} dt$ 相关，因为 $\\frac{d}{du} E_1(C e^{-u}) = \\exp(-C e^{-u})$。\n所以，$\\int_0^U (1 - \\exp(-C e^{-u})) du = [u - E_1(C e^{-u})]_0^U = U - E_1(C e^{-U}) + E_1(C)$。\n这给出了平均吸收概率的精确表达式：\n$$\n\\langle P_{\\mathrm{abs}} \\rangle = \\frac{1}{U} [U + E_1(C) - E_1(C e^{-U})] = 1 + \\frac{1}{U} [E_1(C) - E_1(C e^{-U})]\n$$\n我们已知 $\\langle P_{\\mathrm{abs}} \\rangle$ 和 $U = 2(0.25)^2 / (0.50)^2 = 0.5$ 的值。\n$$\n0.264706 = 1 + \\frac{1}{0.5} [E_1(C) - E_1(C e^{-0.5})]\n$$\n重新整理得到关于 $C$ 的超越方程：\n$$\nE_1(C) - E_1(C e^{-0.5}) = 0.5 (0.264706 - 1) = -0.367647\n$$\n这个方程不能以简单的封闭形式求解。我们对小 $z$ 使用 $E_1(z)$ 的级数展开：$E_1(z) = -\\gamma - \\ln(z) - \\sum_{k=1}^\\infty \\frac{(-z)^k}{k \\cdot k!}$，其中 $\\gamma$ 是欧拉-马斯刻若尼常数。\n令 $a = e^{-0.5}$。差值变为：\n$E_1(C) - E_1(Ca) = (-\\gamma - \\ln C - \\sum \\dots) - (-\\gamma - \\ln(Ca) - \\sum \\dots) = \\ln a - \\sum_{k=1}^\\infty \\frac{(-C)^k(1-a^k)}{k \\cdot k!}$\n$$\n-0.367647 = -0.5 + \\sum_{k=1}^\\infty \\frac{(-1)^{k-1} C^k (1-a^k)}{k \\cdot k!}\n$$\n将级数在第二项后截断，得到一个二次方程：\n$0.132353 \\approx C(1-a) - \\frac{C^2}{4}(1-a^2)$\n$a = e^{-0.5} \\approx 0.606531$，所以 $1-a \\approx 0.393469$。\n$a^2 = e^{-1} \\approx 0.367879$，所以 $1-a^2 \\approx 0.632121$。\n$$\n0.132353 \\approx 0.393469 C - 0.158030 C^2\n$$\n$$\n0.158030 C^2 - 0.393469 C + 0.132353 = 0\n$$\n解这个二次方程得到两个根：$C \\approx 2.089$ 和 $C \\approx 0.4006$。线性近似（仅第一项）给出 $C \\approx 0.132353/0.393469 \\approx 0.3364$，这表明较小的根是物理上正确的根。我们取 $C = 0.4006$。\n现在我们终于可以计算 $\\sigma$ 了：\n$$\n\\sigma = \\frac{C}{\\Phi_0} = \\frac{0.4006}{2.3873 \\times 10^{21}~\\mathrm{m^{-2}}} \\approx 1.6779 \\times 10^{-22}~\\mathrm{m^2}\n$$\n问题要求结果以 $\\mathrm{cm}^2$ 为单位。因为 $1~\\mathrm{m^2} = 10^4~\\mathrm{cm^2}$：\n$$\n\\sigma \\approx 1.6779 \\times 10^{-22} \\times 10^4~\\mathrm{cm^2} = 1.6779 \\times 10^{-18}~\\mathrm{cm^2}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\sigma = 1.678 \\times 10^{-18}~\\mathrm{cm^2}\n$$",
            "answer": "$$\n\\boxed{1.678 \\times 10^{-18}}\n$$"
        },
        {
            "introduction": "在实验中精确测量绝对光子通量往往充满挑战。这项练习展示了一种巧妙的解决方案：通过引入具有已知性质的参照物离子，将困难的绝对测量转化为精确的相对测量。本问题将引导您使用泊松统计模型来描述多次光子吸收事件，并推导如何利用共囚禁的参照物来标定待测物的吸收截面，这是一种在现代光谱学研究中广泛应用的强大实验策略。",
            "id": "3718322",
            "problem": "在一次对四极杆离子阱中质量选择的有机离子进行的光解离作用谱 (PDAS) 实验中，一个参考阳离子（用物种 $\\mathrm{R}$ 表示）和一个分析物阳离子（用物种 $\\mathrm{A}$ 表示）被共同捕获，并同时暴露在对应于固定波长的光子能量的同一串相同的激光脉冲下。暴露条件确保离子在整个脉冲串上积分，经历相同的有效光子通量，记为 $\\Phi_{\\mathrm{eff}}$。脉冲之间的时间间隔远大于振动冷却时间，因此不同脉冲间的吸收事件是独立的。母离子的减少通过母离子存活分数来量化，其定义为在固定捕获时间内，有激光照射时的母离子信号与无激光照射时的母离子信号之比，记为 $S \\equiv I_{\\text{parent,on}}/I_{\\text{parent,off}}$。由于只使用母离子存活分数，因此不需要碎片检测效率。\n\n通过在激发波长下的独立测量，已知参考物种 $\\mathrm{R}$ 在检测时间尺度内具有单光子吸收截面 $\\sigma_{\\mathrm{R}}$ 和解离量子产率 $\\varphi_{\\mathrm{R}}$。分析物 $\\mathrm{A}$ 在相同条件下独立测得的解离量子产率为 $\\varphi_{\\mathrm{A}}$，但其吸收截面 $\\sigma_{\\mathrm{A}}$ 是未知的。在相同的光子能量下获得以下数值：\n- 参考物种吸收截面：$\\sigma_{\\mathrm{R}} = 1.35 \\times 10^{-17}\\,\\mathrm{cm}^{2}$。\n- 参考物种解离量子产率：$\\varphi_{\\mathrm{R}} = 0.80$。\n- 参考物种母离子存活分数：$S_{\\mathrm{R}} = 0.55$。\n- 分析物解离量子产率：$\\varphi_{\\mathrm{A}} = 0.65$。\n- 分析物母离子存活分数：$S_{\\mathrm{A}} = 0.72$。\n\n从光子吸收作为泊松过程的第一性原理以及量子产率的定义出发，确定分析物的绝对单光子吸收截面 $\\sigma_{\\mathrm{A}}$。将最终答案以 $\\mathrm{cm}^{2}$ 为单位表示，并四舍五入到三位有效数字。",
            "solution": "该问题要求在一个光解离作用谱 (PDAS) 实验中，使用一个参考阳离子及其吸收截面 $\\sigma_{\\mathrm{R}}$，来确定一个分析物阳离子的绝对单光子吸收截面 $\\sigma_{\\mathrm{A}}$。该解法要求从光子吸收作为泊松过程的第一性原理出发。\n\n首先，我们对单个离子吸收光子的过程进行建模。问题陈述离子暴露在一系列激光脉冲中，且吸收事件是独立的。在这些条件下，单个离子在暴露时间内吸收的光子数 $k$ 服从泊松分布：\n$$P(k) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$$\n此处，$\\lambda$ 是离子吸收的平均光子数。该平均值与离子的吸收截面 $\\sigma$ 和离子所暴露的有效光子通量 $\\Phi_{\\mathrm{eff}}$（单位面积的光子数）成正比。关系式为：\n$$\\lambda = \\sigma \\Phi_{\\mathrm{eff}}$$\n\n接下来，我们对解离过程进行建模。解离量子产率 $\\varphi$ 是离子吸收单个光子后发生解离的概率。因此，离子吸收单个光子后*存活*的概率是 $(1-\\varphi)$。问题明确指出，激光脉冲之间的时间足够长以进行振动冷却，因此每次光子吸收都可以视为一个独立事件。如果一个离子吸收了 $k$ 个光子，它在所有 $k$ 个独立事件中存活下来的概率是 $(1-\\varphi)^k$。\n\n一个离子在整个激光照射过程中存活下来的总概率，即母离子存活分数 $S$，是对于每种可能的吸收光子数 $k$，其存活概率的总和。我们必须对从 $0$ 到 $\\infty$ 的所有可能值 $k$ 进行求和，并以吸收 $k$ 个光子的泊松概率进行加权：\n$$S = \\sum_{k=0}^{\\infty} P(k) \\times (\\text{survival probability for } k \\text{ absorptions})$$\n$$S = \\sum_{k=0}^{\\infty} \\left(\\frac{\\lambda^k e^{-\\lambda}}{k!}\\right) (1-\\varphi)^k$$\n我们可以通过提出 $e^{-\\lambda}$ 项来重新整理这个表达式：\n$$S = e^{-\\lambda} \\sum_{k=0}^{\\infty} \\frac{(\\lambda(1-\\varphi))^k}{k!}$$\n该求和是指数函数 $\\exp(x) = \\sum_{k=0}^{\\infty} \\frac{x^k}{k!}$ 的泰勒级数展开，其中 $x = \\lambda(1-\\varphi)$。因此，表达式简化为：\n$$S = e^{-\\lambda} \\exp(\\lambda(1-\\varphi)) = \\exp(-\\lambda + \\lambda(1-\\varphi)) = \\exp(-\\lambda + \\lambda - \\lambda\\varphi) = \\exp(-\\lambda\\varphi)$$\n这个方程 $S = \\exp(-\\lambda\\varphi)$ 提供了可观测的存活分数 $S$、解离量子产率 $\\varphi$ 和平均吸收光子数 $\\lambda$ 之间的基本关系。\n\n现在我们可以用实验可观测量来表示 $\\lambda$。对两边取自然对数：\n$$\\ln(S) = -\\lambda\\varphi$$\n解出 $\\lambda$ 得：\n$$\\lambda = -\\frac{\\ln(S)}{\\varphi}$$\n代入 $\\lambda = \\sigma \\Phi_{\\mathrm{eff}}$，我们得到：\n$$\\sigma \\Phi_{\\mathrm{eff}} = -\\frac{\\ln(S)}{\\varphi}$$\n这个方程对参考物种 $\\mathrm{R}$ 和分析物物种 $\\mathrm{A}$ 都成立。对于参考物种：\n$$\\sigma_{\\mathrm{R}} \\Phi_{\\mathrm{eff}} = -\\frac{\\ln(S_{\\mathrm{R}})}{\\varphi_{\\mathrm{R}}}$$\n对于分析物物种：\n$$\\sigma_{\\mathrm{A}} \\Phi_{\\mathrm{eff}} = -\\frac{\\ln(S_{\\mathrm{A}})}{\\varphi_{\\mathrm{A}}}$$\n问题陈述两种物种被共同捕获并暴露在相同的激光脉冲下，经历相同的有效光子通量 $\\Phi_{\\mathrm{eff}}$。这使我们能够通过对两个方程取比值来消去 $\\Phi_{\\mathrm{eff}}$：\n$$\\frac{\\sigma_{\\mathrm{A}} \\Phi_{\\mathrm{eff}}}{\\sigma_{\\mathrm{R}} \\Phi_{\\mathrm{eff}}} = \\frac{- \\ln(S_{\\mathrm{A}})/\\varphi_{\\mathrm{A}}}{- \\ln(S_{\\mathrm{R}})/\\varphi_{\\mathrm{R}}}$$\n$$\\frac{\\sigma_{\\mathrm{A}}}{\\sigma_{\\mathrm{R}}} = \\frac{\\ln(S_{\\mathrm{A}})}{\\ln(S_{\\mathrm{R}})} \\frac{\\varphi_{\\mathrm{R}}}{\\varphi_{\\mathrm{A}}}$$\n最后，我们可以解出未知的分析物吸收截面 $\\sigma_{\\mathrm{A}}$：\n$$\\sigma_{\\mathrm{A}} = \\sigma_{\\mathrm{R}} \\frac{\\varphi_{\\mathrm{R}}}{\\varphi_{\\mathrm{A}}} \\frac{\\ln(S_{\\mathrm{A}})}{\\ln(S_{\\mathrm{R}})}$$\n现在，我们将给定值代入此表达式：\n- $\\sigma_{\\mathrm{R}} = 1.35 \\times 10^{-17}\\,\\mathrm{cm}^2$\n- $\\varphi_{\\mathrm{R}} = 0.80$\n- $S_{\\mathrm{R}} = 0.55$\n- $\\varphi_{\\mathrm{A}} = 0.65$\n- $S_{\\mathrm{A}} = 0.72$\n\n$$\\sigma_{\\mathrm{A}} = (1.35 \\times 10^{-17}\\,\\mathrm{cm}^2) \\times \\frac{0.80}{0.65} \\times \\frac{\\ln(0.72)}{\\ln(0.55)}$$\n首先，我们计算自然对数的值和量子产率的比值：\n$$\\ln(0.72) \\approx -0.328504$$\n$$\\ln(0.55) \\approx -0.597837$$\n$$\\frac{0.80}{0.65} \\approx 1.230769$$\n将这些值代入 $\\sigma_{\\mathrm{A}}$ 的方程中：\n$$\\sigma_{\\mathrm{A}} \\approx (1.35 \\times 10^{-17}\\,\\mathrm{cm}^2) \\times (1.230769) \\times \\frac{-0.328504}{-0.597837}$$\n$$\\sigma_{\\mathrm{A}} \\approx (1.35 \\times 10^{-17}\\,\\mathrm{cm}^2) \\times (1.230769) \\times (0.549530)$$\n$$\\sigma_{\\mathrm{A}} \\approx (1.35 \\times 10^{-17}\\,\\mathrm{cm}^2) \\times (0.676254)$$\n$$\\sigma_{\\mathrm{A}} \\approx 9.1294 \\times 10^{-18}\\,\\mathrm{cm}^2$$\n问题要求将答案四舍五入到三位有效数字。\n$$\\sigma_{\\mathrm{A}} = 9.13 \\times 10^{-18}\\,\\mathrm{cm}^2$$",
            "answer": "$$\\boxed{9.13 \\times 10^{-18}}$$"
        },
        {
            "introduction": "这是本章的综合性压轴练习，我们将从单点测量推进到对整个作用谱的完整分析。真实的实验谱线会因离子的初始内能分布和激光的有限带宽而展宽，本练习要求您构建一个能够精确描述这些效应的物理模型。您将通过编写代码来模拟含有噪声的实验数据，并利用您建立的模型对其进行拟合，最终提取出分子的解离阈能，这是现代物理化学研究中的一项核心计算技能。",
            "id": "3718313",
            "problem": "你需要实现一个完整的、可运行的程序，该程序用于模拟和分析气相有机离子的光解离作用光谱测量。目标是根据在科学真实假设下生成的合成作用产额数据，估算解离阈值能量。\n\n使用的基本和建模假设：\n- 能量守恒：当 $E_{\\text{ph}} + E_{\\text{int}} \\ge E_0$ 时，离子发生解离，其中 $E_{\\text{ph}}$ 是光子能量，$E_{\\text{int}}$ 是离子的内能，$E_0$ 是解离阈值能量。\n- 光子能量分布：激光发射的光子能量分布被建模为均值为 $h\\nu$、标准差为 $\\sigma$ 的高斯分布。光子能量超过值 $x$ 的尾部概率为\n$$\nP(E_{\\text{ph}} \\ge x) = \\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{x - h\\nu}{\\sqrt{2}\\,\\sigma}\\right),\n$$\n其中 $\\operatorname{erfc}(\\cdot)$ 表示互补误差函数。\n- 内能分布：离子的内能由伽马分布建模，其形状参数为 $s$（表示贡献显著能量的有效振动自由度数），尺度参数为 $\\beta = k_{\\mathrm{B}} T$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。概率密度为\n$$\np_T(E_{\\text{int}}) = \\frac{E_{\\text{int}}^{s-1} \\exp(-E_{\\text{int}}/\\beta)}{\\Gamma(s)\\,\\beta^s}, \\quad E_{\\text{int}} \\ge 0.\n$$\n- 光解离作用产额：对于给定的 $h\\nu$，可观测的单光子解离概率（作用产额）是光子能量和内能之和超过 $E_0$ 的概率，该概率在两种分布上进行平均：\n$$\nY(h\\nu; E_0) = \\int_{0}^{\\infty} p_T(E_{\\text{int}})\\,\\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{E_0 - E_{\\text{int}} - h\\nu}{\\sqrt{2}\\,\\sigma}\\right)\\,dE_{\\text{int}}.\n$$\n\n你的程序必须：\n1. 使用 $k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5}$ 电子伏特/开尔文 ($\\text{eV/K}$)。\n2. 对于下面测试套件中的每个测试用例，通过在指定的 $h\\nu$ 值网格上评估 $Y(h\\nu; E_0)$ 来生成合成作用产额数据，并添加标准差为 $1.0\\times 10^{-2}$ 的零均值高斯测量噪声。将含噪声的产额限制在 $[0,1]$ 区间内以保持物理真实性。\n3. 通过最小化合成产额数据与模型 $Y(h\\nu; E_0)$ 之间的残差平方和来估算阈值能量 $E_0$，其中 $E_0 \\in [0.5, 6.0]$ 电子伏特。这需要一个数值实现，能够处理 $Y(h\\nu; E_0)$ 的积分定义，而不依赖任何闭式解。你必须为 $E_{\\text{int}}$ 上的积分设计自己的数值积分方法，并设计一个不需要外部用户输入的有界标量最小化过程。\n4. 生成一行输出，其中包含所有测试用例的估算阈值的逗号分隔列表，四舍五入到三位小数，并用方括号括起来。所有阈值能量必须以电子伏特 (eV) 为单位表示。\n\n数值实现要求：\n- $Y(h\\nu; E_0)$ 中对 $E_{\\text{int}}$ 的积分必须通过在有限网格 $E_{\\text{int}} \\in [0, E_{\\max}]$ 上进行显式数值积分来计算，其中 $E_{\\max}$ 的选择要足够大，以使伽马分布的尾部相对于指定的温度和形状参数可以忽略不计。使用均匀网格和黎曼和或复合梯形法则；在你的解决方案中记录你的选择。\n- 对 $E_0$ 的最小化必须通过你实现的有界、无导数方法（例如，黄金分割搜索）来进行，确保在指定区间内收敛到最小值。\n- 所有光子能量 $h\\nu$、阈值能量 $E_0$ 和带宽 $\\sigma$ 必须以电子伏特 (eV) 为单位处理。温度 $T$ 以开尔文 (K) 为单位。最终估算值必须以电子伏特 (eV) 报告。\n\n测试套件：\n使用以下四个科学上合理的案例，以探测不同情况。\n- 案例 1（典型实验室条件）：\n  - $E_0 = 3.50$ eV, $T = 300$ K, $s = 3$, $\\sigma = 0.05$ eV,\n  - $h\\nu$ 网格：从 $2.5$ eV 到 $5.0$ eV（含）的 $51$ 个等间距值。\n- 案例 2（冷离子，尖锐阈值）：\n  - $E_0 = 2.20$ eV, $T = 30$ K, $s = 3$, $\\sigma = 0.005$ eV,\n  - $h\\nu$ 网格：从 $1.5$ eV 到 $3.0$ eV（含）的 $51$ 个等间距值。\n- 案例 3（宽激光带宽，模糊起始）：\n  - $E_0 = 4.10$ eV, $T = 300$ K, $s = 5$, $\\sigma = 0.20$ eV,\n  - $h\\nu$ 网格：从 $3.0$ eV 到 $5.5$ eV（含）的 $51$ 个等间距值。\n- 案例 4（热离子，热辅助）：\n  - $E_0 = 1.80$ eV, $T = 600$ K, $s = 2$, $\\sigma = 0.02$ eV,\n  - $h\\nu$ 网格：从 $1.0$ eV 到 $3.0$ eV（含）的 $51$ 个等间距值。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含上述案例的四个估算阈值，格式为用方括号括起来的逗号分隔列表，每个值四舍五入到三位小数，单位为电子伏特 (eV)。例如，输出应类似于“[3.487,2.201,4.098,1.804]”。",
            "solution": "我们从单离子层面的能量守恒开始：当且仅当吸收的光子能量 $E_{\\text{ph}}$ 和离子的内能 $E_{\\text{int}}$ 之和达到或超过解离阈值 $E_0$ 时，解离才会发生，即 $E_{\\text{ph}} + E_{\\text{int}} \\ge E_0$。在仅吸收单个光子的光解离作用光谱法条件下，可观测的量是暴露于光下解离的离子分数，这等于当 $E_{\\text{ph}}$ 和 $E_{\\text{int}}$ 都是具有已知分布的随机变量时，上述不等式成立的概率。\n\n激光光子能量由均值为 $h\\nu$、标准差为 $\\sigma$ 的高斯分布建模，因此 $E_{\\text{ph}}$ 超过所需能量 $x$ 的概率由高斯分布的互补累积分布函数给出：\n$$\nP(E_{\\text{ph}} \\ge x) = \\int_{x}^{\\infty} \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\left(-\\frac{(E - h\\nu)^2}{2\\sigma^2}\\right)\\,dE = \\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{x - h\\nu}{\\sqrt{2}\\,\\sigma}\\right).\n$$\n对于离子的内能，我们采用伽马分布来捕捉总的振动能量含量；其形状参数为 $s$，尺度参数为 $\\beta = k_{\\mathrm{B}} T$（玻尔兹曼常数乘以温度），概率密度函数为\n$$\np_T(E_{\\text{int}}) = \\frac{E_{\\text{int}}^{s-1}\\exp(-E_{\\text{int}}/\\beta)}{\\Gamma(s)\\,\\beta^s}, \\quad E_{\\text{int}} \\ge 0.\n$$\n可观测的单光子作用产额 $Y(h\\nu; E_0)$ 是 $E_{\\text{ph}} + E_{\\text{int}} \\ge E_0$ 的概率，在内能分布和光子能量分布上进行平均。以内能 $E_{\\text{int}}$ 为条件然后取平均值，得到\n$$\nY(h\\nu; E_0) = \\int_{0}^{\\infty} p_T(E_{\\text{int}})\\,P\\!\\left(E_{\\text{ph}} \\ge E_0 - E_{\\text{int}}\\right)\\,dE_{\\text{int}}\n= \\int_{0}^{\\infty} p_T(E_{\\text{int}})\\,\\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{E_0 - E_{\\text{int}} - h\\nu}{\\sqrt{2}\\,\\sigma}\\right)\\,dE_{\\text{int}}.\n$$\n该积分在所有参数下没有简单的闭式解，因此我们通过数值积分进行计算。具体来说，我们：\n- 在 $[0, E_{\\max}]$ 上选择一个间距为 $\\Delta E$ 的均匀网格 $E_{\\text{int},j}$，其中 $E_{\\max}$ 的选择要足够大，以使伽马分布在 $E_{\\max}$ 之后的尾部贡献可以忽略不计。一个实际的选择是使用 $E_{\\max} = s\\beta + c\\sqrt{s}\\,\\beta + m$，其中常数 $c$ 和 $m$ 确保覆盖范围远达分布尾部。在我们的实现中，我们选择 $c = 12$ 和 $m = 3.0$ 电子伏特，以保守地捕捉所有给定测试条件下的尾部。\n- 使用黎曼和来近似该积分：\n$$\nY(h\\nu; E_0) \\approx \\sum_{j=0}^{N-1} p_T(E_{\\text{int},j})\\;\\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{E_0 - E_{\\text{int},j} - h\\nu}{\\sqrt{2}\\,\\sigma}\\right)\\;\\Delta E,\n$$\n随着 $N$ 的增加以及 $E_{\\max}$ 充分超过分布的主体部分，该和会收敛。\n\n为了从合成数据中估算 $E_0$，我们使用最小二乘估计。给定在光子能量 $\\{h\\nu_i\\}$ 处测得的（合成的）产额 $\\{y_i\\}$，我们最小化残差平方和\n$$\nS(E_0) = \\sum_{i} \\left[y_i - Y(h\\nu_i; E_0)\\right]^2,\n$$\n其中 $E_0 \\in [0.5, 6.0]$ 电子伏特。由于 $S(E_0)$ 是一个单变量函数且模型是平滑的，因此像黄金分割搜索这样的有界无导数方法是合适且稳健的。黄金分割搜索维持一个包围区间 $[a,b]$，并在两个内部点 $c$ 和 $d$ 处评估函数，其中 $c = b - \\varphi(b-a)$ 和 $d = a + \\varphi(b-a)$，$\\varphi = (\\sqrt{5} - 1)/2$。在每一步，根据哪个内部点的目标值更低来缩小区间。迭代过程持续进行，直到区间长度 $|b-a|$ 小于指定的容差，此时取中点 $(a+b)/2$ 作为估算值。\n\n每个测试用例的算法步骤：\n1. 使用 $k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5}\\ \\text{eV/K}$ 计算 $\\beta$（单位为电子伏特），并在 $[0, E_{\\max}]$ 上构建一个包含 $N$ 个点的均匀网格（我们选择 $N = 3000$ 以平衡精度和效率）。\n2. 使用 $\\Gamma(s)$ 进行归一化，在网格上评估伽马密度 $p_T(E_{\\text{int},j})$。\n3. 对于每个光子能量网格点 $h\\nu_i$，通过黎曼和计算 $Y(h\\nu_i; E_0)$，在尾部概率中使用互补误差函数。\n4. 使用真实的 $E_0$ 生成合成产额，并添加标准差为 $10^{-2}$ 的独立高斯噪声，然后将产额限制在 $[0,1]$ 区间。\n5. 定义最小二乘目标函数 $S(E_0)$，并使用容差为 $10^{-4}$ eV 的黄金分割搜索在 $[0.5, 6.0]$ eV 范围内对其进行最小化。\n6. 将得到的 $E_0$ 估算值四舍五入到三位小数，并以电子伏特为单位报告。\n\n测试套件涵盖的边缘情况考虑：\n- 冷离子（$T$ 小）产生尖锐的近阶跃起始；算法的有界搜索和精细的内能网格确保了稳定性。\n- 宽激光带宽（$\\sigma$ 大）产生模糊的起始；模型通过高斯尾部概率来解释这一点。\n- 热离子（$T$ 大）由于内能辅助，使表观起始移动到较低的 $h\\nu$；卷积正确地捕捉了这种效应。\n\n最终程序为四个指定的案例实现了这些步骤，并以要求的格式打印出一行包含四个阈值估算值的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom math import sqrt, gamma\nfrom scipy.special import erfc\n\n# Constants\nK_B_EV_PER_K = 8.617333262e-5  # Boltzmann constant in eV/K\n\ndef gamma_pdf(e_int, s, beta):\n    \"\"\"\n    Gamma distribution PDF for internal energy.\n    p_T(E) = E^{s-1} exp(-E/beta) / (Gamma(s) * beta^s)\n    \"\"\"\n    # Prevent issues at E=0 when s1; but s>=2 in our tests.\n    coeff = 1.0 / (gamma(s) * (beta ** s))\n    return coeff * (e_int ** (s - 1)) * np.exp(-e_int / beta)\n\ndef choose_eint_grid_params(s, beta):\n    \"\"\"\n    Choose an upper bound for the internal energy grid E_max conservatively such that\n    the Gamma distribution tail beyond E_max is negligible for our model.\n    E_max = s*beta + c*sqrt(s)*beta + m, with c=12, m=3.0 eV.\n    \"\"\"\n    c = 12.0\n    m = 3.0  # eV\n    e_max = s * beta + c * sqrt(s) * beta + m\n    return e_max\n\ndef compute_yield_model(hv_array, E0, s, beta, sigma, e_int_grid, pdf_grid, delta_e):\n    \"\"\"\n    Compute the action yield Y(hv; E0) for each hv in hv_array using\n    numerical quadrature over the internal energy grid.\n    Y(hv; E0) = \\int_0^\\infty p_T(E_int) * 0.5 * erfc((E0 - E_int - hv) / (sqrt(2)*sigma)) dE_int\n    Approximate via Riemann sum on [0, E_max].\n    \"\"\"\n    # Broadcast hv_array against e_int_grid to form a matrix of tail probabilities\n    # tail_prob[i, j] = 0.5 * erfc((E0 - e_int_grid[j] - hv_array[i]) / (sqrt(2)*sigma))\n    # Use numpy broadcasting for efficiency.\n    # Avoid division by zero in sigma; sigma > 0 in all cases.\n    arg = (E0 - e_int_grid[None, :] - hv_array[:, None]) / (sqrt(2.0) * sigma)\n    tail = 0.5 * erfc(arg)\n    # Integrate over e_int_grid: Y_i = sum_j pdf_grid[j] * tail[i,j] * delta_e\n    y = np.dot(tail, pdf_grid) * delta_e\n    # Clamp to [0,1] due to numerical approximations (should already be within)\n    return np.clip(y, 0.0, 1.0)\n\ndef golden_section_search(func, a, b, tol=1e-4, max_iter=200):\n    \"\"\"\n    Bounded golden-section search for univariate minimization.\n    Returns the argmin within [a, b] to within tolerance tol.\n    \"\"\"\n    invphi = (sqrt(5.0) - 1.0) / 2.0  # 1/phi = 0.618...\n    invphi2 = (3.0 - sqrt(5.0)) / 2.0  # 1/phi^2 = 0.382...\n\n    # Required steps to achieve tolerance\n    n = int(np.ceil(np.log(tol / (b - a)) / np.log(invphi)))\n\n    c = a + invphi2 * (b - a)\n    d = a + invphi * (b - a)\n    fc = func(c)\n    fd = func(d)\n\n    for k in range(min(n, max_iter)):\n        if fc  fd:\n            b, d, fd = d, c, fc\n            c = a + invphi2 * (b - a)\n            fc = func(c)\n        else:\n            a, c, fc = c, d, fd\n            d = a + invphi * (b - a)\n            fd = func(d)\n        if abs(b - a)  tol:\n            break\n    return 0.5 * (a + b)\n\ndef simulate_and_estimate(case, rng):\n    \"\"\"\n    For a given test case dict, simulate synthetic yields and estimate E0 by least squares fit.\n    case keys: E0_true, T, s, sigma, hv_min, hv_max, N_hv\n    \"\"\"\n    E0_true = case[\"E0_true\"]\n    T = case[\"T\"]\n    s = case[\"s\"]\n    sigma = case[\"sigma\"]\n    hv_min = case[\"hv_min\"]\n    hv_max = case[\"hv_max\"]\n    N_hv = case[\"N_hv\"]\n\n    beta = K_B_EV_PER_K * T  # eV\n    hv_array = np.linspace(hv_min, hv_max, N_hv)\n\n    # Internal energy grid\n    e_max = choose_eint_grid_params(s, beta)\n    N_grid = 3000\n    e_int_grid = np.linspace(0.0, e_max, N_grid)\n    delta_e = e_int_grid[1] - e_int_grid[0]\n    pdf_grid = gamma_pdf(e_int_grid, s, beta)\n\n    # Generate synthetic data\n    y_true = compute_yield_model(hv_array, E0_true, s, beta, sigma, e_int_grid, pdf_grid, delta_e)\n    noise = rng.normal(loc=0.0, scale=1.0e-2, size=y_true.shape)\n    y_meas = np.clip(y_true + noise, 0.0, 1.0)\n\n    # Define least squares objective function\n    def sse(E0):\n        y_model = compute_yield_model(hv_array, E0, s, beta, sigma, e_int_grid, pdf_grid, delta_e)\n        resid = y_meas - y_model\n        return float(np.dot(resid, resid))\n\n    # Minimize over [0.5, 6.0] eV using golden-section search\n    E0_est = golden_section_search(sse, 0.5, 6.0, tol=1e-4, max_iter=300)\n\n    return E0_est\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: typical laboratory conditions\n        {\"E0_true\": 3.50, \"T\": 300.0, \"s\": 3, \"sigma\": 0.05, \"hv_min\": 2.5, \"hv_max\": 5.0, \"N_hv\": 51},\n        # Case 2: cold ions, sharp threshold\n        {\"E0_true\": 2.20, \"T\": 30.0, \"s\": 3, \"sigma\": 0.005, \"hv_min\": 1.5, \"hv_max\": 3.0, \"N_hv\": 51},\n        # Case 3: broad laser bandwidth, smeared onset\n        {\"E0_true\": 4.10, \"T\": 300.0, \"s\": 5, \"sigma\": 0.20, \"hv_min\": 3.0, \"hv_max\": 5.5, \"N_hv\": 51},\n        # Case 4: hotter ions, thermal assistance\n        {\"E0_true\": 1.80, \"T\": 600.0, \"s\": 2, \"sigma\": 0.02, \"hv_min\": 1.0, \"hv_max\": 3.0, \"N_hv\": 51},\n    ]\n\n    rng = np.random.default_rng(seed=42)\n    results = []\n    for case in test_cases:\n        E0_est = simulate_and_estimate(case, rng)\n        # Round to three decimal places\n        results.append(round(E0_est, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda x: f'{x:.3f}', results))}]\")\n\nsolve()\n```"
        }
    ]
}