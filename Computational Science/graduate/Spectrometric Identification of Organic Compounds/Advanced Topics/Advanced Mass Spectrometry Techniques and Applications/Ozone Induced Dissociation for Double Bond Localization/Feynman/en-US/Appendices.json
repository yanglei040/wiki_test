{
    "hands_on_practices": [
        {
            "introduction": "The foundation of interpreting any mass spectrum is the ability to predict the mass-to-charge ratios of expected product ions. This exercise provides essential practice in this core skill by focusing on the fundamental stoichiometry of ozone-induced dissociation (OzID). By deriving the exact monoisotopic masses of the canonical aldehyde and Criegee ion products from first principles, you will build the bedrock understanding required to assign peaks in an OzID spectrum and begin the process of structural elucidation .",
            "id": "3717469",
            "problem": "A cation derived from an unsaturated organic molecule undergoes ozone-induced dissociation (OzID), formally represented as $R_{1}\\text{-}CH=CH\\text{-}R_{2}^{+} \\xrightarrow{O_{3}} R_{1}\\text{-}CHO + R_{2}\\text{-}CHOO^{+}$. Treat $R_{1}$ and $R_{2}$ as substituent moieties that exclude the two $\\text{sp}^{2}$ double-bond carbon atoms and their hydrogens; that is, the atoms counted in $R_{1}$ and $R_{2}$ do not include the $CH$ units that directly participate in the $C=C$ functionality. Assume elemental compositions limited to carbon, hydrogen, oxygen, and, if present as an adduct cation, sodium.\n\nStarting from the definitions that in mass spectrometry the monoisotopic exact mass is the sum of the monoisotopic atomic masses of the constituent atoms, and that ozonolysis of a $C=C$ bond cleaves the bond to yield an aldehyde ($R_{1}\\text{-}CHO$) and a Criegee-type ion ($R_{2}\\text{-}CHOO^{+}$), derive the elemental compositions of the two product fragments in terms of the atom counts of $R_{1}$ and $R_{2}$, and then express their exact monoisotopic masses symbolically. Let $n_{\\text{C}}(R_{i})$, $n_{\\text{H}}(R_{i})$, and $n_{\\text{O}}(R_{i})$ denote the numbers of carbon, hydrogen, and oxygen atoms in $R_{i}$ for $i \\in \\{1,2\\}$. Let $\\sigma \\in \\{0,1\\}$ be an indicator for sodium adduction on the Criegee fragment ($\\sigma=1$ if one sodium atom is adducted to $R_{2}\\text{-}CHOO^{+}$, $\\sigma=0$ otherwise). Use the following monoisotopic masses: $m(\\text{C})=12.000000$, $m(\\text{H})=1.007825$, $m(\\text{O})=15.994915$, and $m(\\text{Na})=22.989770$.\n\nExpress both fragment masses in unified atomic mass units (u) and give the final result as a pair of closed-form analytical expressions. No numerical rounding is required.",
            "solution": "The problem asks for the derivation of analytical expressions for the monoisotopic exact masses of the two product fragments resulting from the ozone-induced dissociation (OzID) of an unsaturated organic cation. The process is defined by the reaction $R_{1}\\text{-}CH=CH\\text{-}R_{2}^{+} \\xrightarrow{O_{3}} R_{1}\\text{-}CHO + R_{2}\\text{-}CHOO^{+}$. The mass of a chemical species is calculated as the sum of the monoisotopic masses of its constituent atoms. The mass of an electron is considered negligible, so the mass of an ion is equivalent to the mass of its corresponding neutral radical.\n\nFirst, we determine the elemental composition of the aldehyde fragment, $R_{1}\\text{-}CHO$.\nThe problem states that $R_{1}$ is a substituent moiety with an elemental composition defined by the atom counts $n_{\\text{C}}(R_{1})$ for carbon, $n_{\\text{H}}(R_{1})$ for hydrogen, and $n_{\\text{O}}(R_{1})$ for oxygen. The formation of the aldehyde fragment $R_{1}\\text{-}CHO$ from the precursor involves the moiety $R_{1}$ and one of the original vinyl groups, $CH$, which combines with one oxygen atom from the ozone molecule. Therefore, the total number of atoms of each element in this fragment is the sum of the atoms in $R_{1}$ and the atoms in the $-CHO$ group.\nThe $-CHO$ group contributes one carbon atom, one hydrogen atom, and one oxygen atom.\nThus, the elemental composition of the fragment $R_{1}\\text{-}CHO$ is:\nNumber of Carbon atoms: $n_{\\text{C, frag1}} = n_{\\text{C}}(R_{1}) + 1$\nNumber of Hydrogen atoms: $n_{\\text{H, frag1}} = n_{\\text{H}}(R_{1}) + 1$\nNumber of Oxygen atoms: $n_{\\text{O, frag1}} = n_{\\text{O}}(R_{1}) + 1$\n\nThe monoisotopic mass of the aldehyde fragment, denoted as $m(R_{1}\\text{-}CHO)$, is the sum of the masses of its constituent atoms. Using the symbolic masses provided, $m(\\text{C})$, $m(\\text{H})$, and $m(\\text{O})$:\n$m(R_{1}\\text{-}CHO) = (n_{\\text{C}}(R_{1}) + 1) m(\\text{C}) + (n_{\\text{H}}(R_{1}) + 1) m(\\text{H}) + (n_{\\text{O}}(R_{1}) + 1) m(\\text{O})$\nSubstituting the given numerical values for the monoisotopic masses:\n$m(\\text{C}) = 12.000000$ u\n$m(\\text{H}) = 1.007825$ u\n$m(\\text{O}) = 15.994915$ u\nThe expression for the mass of the first fragment is:\n$m(R_{1}\\text{-}CHO) = (n_{\\text{C}}(R_{1}) + 1) \\cdot 12.000000 + (n_{\\text{H}}(R_{1}) + 1) \\cdot 1.007825 + (n_{\\text{O}}(R_{1}) + 1) \\cdot 15.994915$\n\nNext, we determine the elemental composition of the Criegee-type ion fragment, $R_{2}\\text{-}CHOO^{+}$.\nThis fragment is composed of the moiety $R_{2}$, the other vinyl group $CH$, and the remaining two oxygen atoms from the ozone molecule. Its elemental composition is defined by the atom counts $n_{\\text{C}}(R_{2})$, $n_{\\text{H}}(R_{2})$, and $n_{\\text{O}}(R_{2})$ for the $R_{2}$ moiety, plus the atoms from the $-CHOO$ group.\nThe $-CHOO$ group contributes one carbon atom, one hydrogen atom, and two oxygen atoms.\nAdditionally, the problem states that this fragment may be adducted with a sodium atom, indicated by the variable $\\sigma \\in \\{0,1\\}$, where $\\sigma=1$ signifies the presence of one sodium atom and $\\sigma=0$ signifies its absence.\nThus, the elemental composition of the fragment $R_{2}\\text-CHOO^{+}$ (possibly sodiated) is:\nNumber of Carbon atoms: $n_{\\text{C, frag2}} = n_{\\text{C}}(R_{2}) + 1$\nNumber of Hydrogen atoms: $n_{\\text{H, frag2}} = n_{\\text{H}}(R_{2}) + 1$\nNumber of Oxygen atoms: $n_{\\text{O, frag2}} = n_{\\text{O}}(R_{2}) + 2$\nNumber of Sodium atoms: $n_{\\text{Na, frag2}} = \\sigma$\n\nThe monoisotopic mass of this Criegee-type ion, denoted as $m(R_{2}\\text{-}CHOO^{+})$, is the sum of the masses of its constituent atoms, including sodium if present. Using the symbolic masses $m(\\text{C})$, $m(\\text{H})$, $m(\\text{O})$, and $m(\\text{Na})$:\n$m(R_{2}\\text{-}CHOO^{+}) = (n_{\\text{C}}(R_{2}) + 1) m(\\text{C}) + (n_{\\text{H}}(R_{2}) + 1) m(\\text{H}) + (n_{\\text{O}}(R_{2}) + 2) m(\\text{O}) + \\sigma \\cdot m(\\text{Na})$\nSubstituting the given numerical values for the monoisotopic masses, including $m(\\text{Na}) = 22.989770$ u:\nThe expression for the mass of the second fragment is:\n$m(R_{2}\\text{-}CHOO^{+}) = (n_{\\text{C}}(R_{2}) + 1) \\cdot 12.000000 + (n_{\\text{H}}(R_{2}) + 1) \\cdot 1.007825 + (n_{\\text{O}}(R_{2}) + 2) \\cdot 15.994915 + \\sigma \\cdot 22.989770$\n\nThe two derived expressions represent the closed-form analytical formulas for the exact monoisotopic masses of the two product fragments.",
            "answer": "$$\\boxed{\\begin{pmatrix} (n_{\\text{C}}(R_{1}) + 1) \\cdot 12.000000 + (n_{\\text{H}}(R_{1}) + 1) \\cdot 1.007825 + (n_{\\text{O}}(R_{1}) + 1) \\cdot 15.994915 & (n_{\\text{C}}(R_{2}) + 1) \\cdot 12.000000 + (n_{\\text{H}}(R_{2}) + 1) \\cdot 1.007825 + (n_{\\text{O}}(R_{2}) + 2) \\cdot 15.994915 + \\sigma \\cdot 22.989770 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While OzID provides a clean diagnostic for isolated double bonds, many biologically important molecules contain more complex unsaturation patterns, such as conjugated dienes. This practice problem challenges you to move beyond the simplest case and apply principles of physical organic chemistry to a realistic analytical scenario. By using the Arrhenius equation to evaluate competing 1,2- and 1,4-addition pathways, you will learn to quantitatively predict how structural features can influence reaction kinetics and alter the resulting mass spectrum, a critical skill for interpreting data from complex lipids .",
            "id": "3717417",
            "problem": "In ozone-induced dissociation (OzID) mass spectrometry, neutral ozone adds across carbonâ€“carbon double bonds in gas-phase ions to form ozonides that decompose to yield diagnostic product ions for double-bond localization. For an isolated alkene, OzID commonly yields a complementary pair of product ions corresponding to carbonyl and carbonyl oxide (Criegee) fragments that are separated by $16$ Th, and these two ions account for essentially all ozonation-derived product intensity under single-collision, pseudo-first-order conditions.\n\nConsider a singly charged gas-phase ion embedding a conjugated diene moiety, for example a lipid-like fragment with a segment $-\\mathrm{CH}=\\mathrm{CH}-\\mathrm{CH}=\\mathrm{CH}-$. Ozone can add by two competing pathways: $1,2$-addition localized to a single double bond (leading to the usual primary ozonide and subsequent diagnostic cleavage) and $1,4$-addition across the conjugated system (leading to an allylic ozonide or peroxyallylic intermediate whose subsequent decomposition is known to generate non-diagnostic allylic/allyloxyl fragments rather than the canonical $+16$ Th pair).\n\nAssume the following well-tested kinetic framework and parameters:\n- Under a fixed ozone number density (pseudo-first-order regime), branching between parallel channels is governed by the ratio of their rate constants, $k_{1,2}$ and $k_{1,4}$.\n- The temperature dependence of each channel follows the Arrhenius law, $k = A \\exp\\!\\left(-E_{\\mathrm{a}}/(RT)\\right)$, where $R$ is the gas constant.\n- For the conjugated diene ion under study at $T = 300$ K, the effective Arrhenius parameters are:\n  - $1,2$-addition: $A_{1,2} = 1.0 \\times 10^{x}$ (arbitrary but identical units for both channels; only ratios matter), $E_{\\mathrm{a},1,2} = 6.0$ $\\mathrm{kcal\\,mol^{-1}}$.\n  - $1,4$-addition: $A_{1,4} = 2.0 \\times 10^{x}$, $E_{\\mathrm{a},1,4} = 7.5$ $\\mathrm{kcal\\,mol^{-1}}$.\n- Take $R = 1.987$ $\\mathrm{cal\\,mol^{-1}\\,K^{-1}}$.\n\nBased only on these fundamentals and parameters, and the mechanistic distinction that $1,2$-addition produces the canonical pair of OzID fragments separated by $16$ Th whereas $1,4$-addition produces predominantly non-paired, non-diagnostic allylic products, which statement best captures both the kinetic likelihood of $1,4$-addition and its impact on the observed OzID diagnostic pattern?\n\nA. At $T = 300$ K, $1,4$-addition captures a minority but significant fraction (on the order of $15\\%$) of ozone additions due to a modestly higher pre-exponential factor offset by a higher activation barrier, thereby siphoning intensity from the canonical $+16$ Th pair and introducing additional non-paired allylic fragments that partially obscure double-bond localization.\n\nB. Conjugation suppresses $1,2$-addition almost entirely, so at $T = 300$ K essentially all ozone additions proceed via $1,4$-addition, but the resulting fragments still appear as two ions separated by $+16$ Th and thus preserve unambiguous double-bond localization.\n\nC. Because the two double bonds are equivalent by conjugation, $k_{1,2} = k_{1,4}$ at $T = 300$ K, yielding approximately equal contributions from both channels and generating two equally intense $+16$ Th diagnostic pairs per double bond without additional interfering ions.\n\nD. $1,4$-addition is symmetry-forbidden for ozone in the gas phase, so conjugation has a negligible effect; the OzID spectrum at $T = 300$ K is dominated by the canonical $+16$ Th pair with essentially no distortion relative to an isolated alkene.",
            "solution": "This problem requires a quantitative comparison of the rates of two competing reaction pathways ($1,2$-addition and $1,4$-addition) using the Arrhenius equation. The goal is to determine the fraction of the reaction that proceeds through the $1,4$-addition channel and assess its impact on the mass spectrum.\n\n**1. Calculate the Ratio of Rate Constants**\n\nThe ratio of the rate constants for the two pathways, $k_{1,4}$ and $k_{1,2}$, can be calculated from the Arrhenius equation:\n$$ \\frac{k_{1,4}}{k_{1,2}} = \\frac{A_{1,4} \\exp(-E_{\\mathrm{a},1,4} / (RT))}{A_{1,2} \\exp(-E_{\\mathrm{a},1,2} / (RT))} = \\frac{A_{1,4}}{A_{1,2}} \\exp\\left(\\frac{E_{\\mathrm{a},1,2} - E_{\\mathrm{a},1,4}}{RT}\\right) $$\nGiven parameters are:\n- $\\frac{A_{1,4}}{A_{1,2}} = \\frac{2.0 \\times 10^x}{1.0 \\times 10^x} = 2.0$\n- $E_{\\mathrm{a},1,2} = 6.0$ $\\mathrm{kcal\\,mol^{-1}}$\n- $E_{\\mathrm{a},1,4} = 7.5$ $\\mathrm{kcal\\,mol^{-1}}$\n- $\\Delta E_{\\mathrm{a}} = E_{\\mathrm{a},1,2} - E_{\\mathrm{a},1,4} = 6.0 - 7.5 = -1.5$ $\\mathrm{kcal\\,mol^{-1}} = -1500$ $\\mathrm{cal\\,mol^{-1}}$\n- $R = 1.987$ $\\mathrm{cal\\,mol^{-1}\\,K^{-1}}$\n- $T = 300$ K\n\nFirst, calculate the value of $RT$:\n$$ RT = (1.987 \\text{ cal mol}^{-1} \\text{ K}^{-1}) \\times (300 \\text{ K}) = 596.1 \\text{ cal mol}^{-1} $$\n\nNow, plug the values into the rate constant ratio equation:\n$$ \\frac{k_{1,4}}{k_{1,2}} = 2.0 \\times \\exp\\left(\\frac{-1500}{596.1}\\right) \\approx 2.0 \\times \\exp(-2.516) \\approx 2.0 \\times 0.08078 = 0.16156 $$\n\n**2. Calculate the Fraction of 1,4-Addition**\n\nThe fraction of the reaction that proceeds via the $1,4$-addition pathway, $f_{1,4}$, is given by:\n$$ f_{1,4} = \\frac{k_{1,4}}{k_{1,2} + k_{1,4}} = \\frac{k_{1,4}/k_{1,2}}{1 + k_{1,4}/k_{1,2}} $$\n$$ f_{1,4} \\approx \\frac{0.16156}{1 + 0.16156} = \\frac{0.16156}{1.16156} \\approx 0.1391 $$\nThis corresponds to approximately $13.9\\%$ of the total reaction flux.\n\n**3. Evaluate the Options**\n\n*   **A:** This option states that $1,4$-addition captures a \"minority but significant fraction (on the order of $15\\%$)\" due to competition between the higher pre-exponential factor and the higher activation barrier. Our calculation of $\\approx 14\\%$ strongly supports this quantitative claim. The problem states that this pathway creates \"non-paired allylic fragments,\" so its occurrence would indeed siphon intensity from the main diagnostic channel and \"partially obscure double-bond localization.\" This statement is fully consistent with our analysis.\n\n*   **B:** This option claims that $1,4$-addition is the dominant pathway. Our calculation shows the opposite: $1,2$-addition accounts for $\\approx 86\\%$ of the reaction. This option is incorrect.\n\n*   **C:** This option incorrectly assumes that the rate constants are equal. Our calculation shows $k_{1,4}$ is significantly smaller than $k_{1,2}$. This option is incorrect.\n\n*   **D:** This option makes an external claim that $1,4$-addition is \"symmetry-forbidden,\" which contradicts the premise of the problem (which provides kinetic parameters for this very reaction). It also claims the effect is \"negligible.\" A competing pathway that accounts for $\\approx 14\\%$ of the products is not negligible and would cause a noticeable distortion in the spectrum. This option is incorrect.\n\nTherefore, option A provides the most accurate description of the kinetic outcome and its consequences for the OzID spectrum.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "This final practice bridges the gap between theoretical principles and practical data analysis, reflecting the workflow of modern analytical science. Having learned to predict fragment masses and account for kinetic effects, the next step is to automate the process of structural assignment from raw experimental data. This hands-on coding exercise guides you in designing and implementing an algorithm that systematically generates and scores all possible double bond locations against an observed mass spectrum, culminating in a powerful tool for automated structural characterization .",
            "id": "3717389",
            "problem": "You are tasked with designing and implementing a computational routine that, based on the Ozone-Induced Dissociation of a singly protonated monounsaturated hydrocarbon chain, enumerates all possible diagnostic product ion pairs for every candidate double bond position and ranks these positions by plausibility given a set of observed mass-to-charge values. The routine should select the most plausible double bond position for each test case using a well-defined scoring function.\n\nThe fundamental base to use is the following set of definitions and facts, which are widely accepted and well-tested:\n- In high-resolution mass spectrometry, the mass-to-charge ratio is computed as the monoisotopic neutral mass plus the charge carrier mass, divided by the charge. For singly protonated ions, this is effectively the neutral mass plus the mass of a proton.\n- Ozone-Induced Dissociation of an alkene cleaves the double bond to yield complementary fragments that are diagnostic for double bond localization. For a monounsaturated hydrocarbon chain with a double bond between two carbon atoms, each side of the cleavage can yield an aldehyde fragment and a carbonyl oxide fragment (known as the Criegee intermediate). These two ions for the same carbon count on one side form a diagnostic pair that differ by one oxygen atom in mass.\n- The neutral stoichiometry of a saturated aldehyde fragment containing $s$ carbons is $C_s H_{2s} O$, and the neutral stoichiometry of a carbonyl oxide (Criegee) fragment containing $s$ carbons is $C_s H_{2s} O_2$. For singly protonated ions, add the mass of a proton to the neutral mass.\n- Use the following monoisotopic masses (in dalton units): carbon $m_C = 12.000000$, hydrogen $m_H = 1.007825$, oxygen $m_O = 15.994915$, proton $m_{H^+} = 1.007276$.\n- The expected diagnostic pair from one side of the cleavage has a mass difference of one oxygen, i.e., approximately $m_O$.\n\nModel and computation requirements:\n1. Consider a linear monounsaturated hydrocarbon chain with $N$ carbon atoms. Candidate double bond positions are indexed as integers $p \\in \\{1,2,\\dots,N-1\\}$, indicating a cleavage between the $p$-th and $(p+1)$-th carbon atoms. For each $p$, define two side lengths $s_1 = p$ and $s_2 = N-p$.\n2. For a side length $s$, compute the expected mass-to-charge values (in daltons per elementary charge) for the singly protonated aldehyde and Criegee product ions from that side. The aldehyde ion corresponds to a neutral formula $C_s H_{2s} O$ and the Criegee ion corresponds to $C_s H_{2s} O_2$. As singly protonated ions, their $m/z$ values are the respective neutral masses plus $m_{H^+}$.\n3. For a given $p$, the expected set of diagnostic ions is the union of the two pairs from $s_1$ and $s_2$. If $s_1 = s_2$, avoid double counting by using unique masses only.\n4. Scoring and ranking: Given observed peaks $\\{y_i\\}$ and a nonnegative mass tolerance $\\tau$ (in daltons), define for each expected $m/z$ value $x$ the minimal absolute deviation $\\delta = \\min_i |y_i - x|$. The contribution of this expected ion to the score is $w = \\max(0, 1 - \\delta/\\tau)$ if $\\delta \\le \\tau$, and $w = 0$ otherwise. The score for $p$ is the average of $w$ over all expected ions for that $p$ (i.e., the sum of contributions divided by the number of expected ions). Rank all $p$ by descending score, breaking ties by choosing the smallest $p$. If the highest score equals $0$, return $-1$ to indicate that no plausible position is supported by the observed data within the tolerance.\n5. Units: All $m/z$ values and tolerances are in daltons. Angles are not involved. Percentages are not used.\n6. Implementation: Your program must implement this model and scoring to select, for each test case, the most plausible double bond position as a single integer (or $-1$ if undetermined).\n\nTest suite:\nUse the following test cases, each specified by $(N, \\tau, \\text{observed peaks})$, with observed peaks given as a list of $m/z$ values in daltons:\n- Case 1 (central double bond with symmetric pair):\n  - $N = 18$\n  - $\\tau = 0.01$\n  - Observed peaks: $\\left[143.146541,\\;159.133956,\\;100.000000,\\;200.500000\\right]$\n- Case 2 (asymmetric case with one pair strongly present):\n  - $N = 20$\n  - $\\tau = 0.01$\n  - Observed peaks: $\\left[213.227291,\\;229.214206,\\;150.000000\\right]$\n- Case 3 (boundary case near a terminal position):\n  - $N = 16$\n  - $\\tau = 0.02$\n  - Observed peaks: $\\left[31.022841,\\;47.020756,\\;80.000000,\\;200.000000\\right]$\n- Case 4 (edge case with no observed peaks):\n  - $N = 22$\n  - $\\tau = 0.01$\n  - Observed peaks: $\\left[\\;\\right]$ (empty list)\n\nFinal output specification:\nYour program should produce a single line of output containing the selected most plausible positions for all four test cases as a comma-separated list enclosed in square brackets, in the order of the test cases above. For example, if the selected positions were $p_1$, $p_2$, $p_3$, and $p_4$, the program must print exactly $\\left[\\text{p}_1,\\text{p}_2,\\text{p}_3,\\text{p}_4\\right]$.",
            "solution": "The problem requires the development of a computational method to identify the position of a double bond in a monounsaturated linear hydrocarbon chain. This is achieved by simulating the mass spectrometric analysis of fragments produced by ozone-induced dissociation (OzID) and scoring potential double bond locations against a set of observed mass-to-charge ($m/z$) values. The solution must be grounded in the provided chemical principles and adhere to a specific computational model.\n\nThe logical procedure is as follows:\n1.  **Systematic Generation of Hypotheses**: For a linear hydrocarbon chain with $N$ carbon atoms, a double bond can exist between carbon $p$ and carbon $p+1$, where the position $p$ can range from $1$ to $N-1$. Each integer value of $p$ represents a distinct hypothesis for the double bond's location.\n\n2.  **Prediction of Observable Signatures**: According to the principles of ozone-induced dissociation, a double bond at position $p$ cleaves the molecule into two fragments. The fragment containing carbons $1$ through $p$ has a length of $s_1 = p$, and the complementary fragment has a length of $s_2 = N-p$. For each fragment of length $s$, two diagnostic product ions are expected to form: a singly protonated aldehyde and a singly protonated Criegee intermediate (carbonyl oxide).\n    The monoisotopic mass of the neutral aldehyde fragment, with stoichiometry $C_s H_{2s} O$, is calculated as:\n    $$M_{ald}(s) = s \\cdot m_C + 2s \\cdot m_H + 1 \\cdot m_O$$\n    The monoisotopic mass of the neutral Criegee fragment, with stoichiometry $C_s H_{2s} O_2$, is:\n    $$M_{cri}(s) = s \\cdot m_C + 2s \\cdot m_H + 2 \\cdot m_O$$\n    where $m_C = 12.000000$ Da, $m_H = 1.007825$ Da, and $m_O = 15.994915$ Da are the monoisotopic masses of carbon, hydrogen, and oxygen, respectively.\n    Since the problem specifies singly protonated ions ($z=1$), their mass-to-charge ratios are calculated by adding the mass of a proton, $m_{H^+} = 1.007276$ Da, to the neutral mass:\n    $$ m/z_{ald}(s) = M_{ald}(s) + m_{H^+} $$\n    $$ m/z_{cri}(s) = M_{cri}(s) + m_{H^+} $$\n    For a given double bond position $p$, the set of expected diagnostic $m/z$ values, $E_p$, is the union of the ion pairs from both fragments:\n    $$ E_p = \\{m/z_{ald}(s_1), m/z_{cri}(s_1)\\} \\cup \\{m/z_{ald}(s_2), m/z_{cri}(s_2)\\} $$\n    If the cleavage is symmetric ($s_1 = s_2$), this set contains two unique $m/z$ values; otherwise, it contains four.\n\n3.  **Quantitative Evaluation of Hypotheses**: Each hypothesis $p$ is evaluated by comparing its set of expected $m/z$ values, $E_p$, against the list of experimentally observed $m/z$ values, $\\{y_i\\}$. A scoring function is defined to quantify the \"goodness of fit\". For each expected $m/z$ value $x \\in E_p$, we find its minimal absolute deviation from the observed peaks:\n    $$ \\delta(x) = \\min_{i} |y_i - x| $$\n    A weight, $w(x)$, is assigned based on this deviation relative to a given mass tolerance $\\tau$. The weight is calculated using a linear scoring function:\n    $$ w(x) = \\begin{cases} 1 - \\frac{\\delta(x)}{\\tau} & \\text{if } \\delta(x) \\le \\tau \\\\ 0 & \\text{if } \\delta(x) > \\tau \\end{cases} $$\n    This function assigns a weight of $1$ for a perfect match ($\\delta=0$) and decreases the weight linearly to $0$ as the deviation approaches the tolerance $\\tau$. Any expected peak with no observed counterpart within the tolerance window receives a weight of $0$.\n    The overall score for the hypothesis $p$, $S(p)$, is the arithmetic mean of the weights for all expected ions in its set $E_p$:\n    $$ S(p) = \\frac{1}{|E_p|} \\sum_{x \\in E_p} w(x) $$\n\n4.  **Selection of the Most Plausible Hypothesis**: After calculating the score $S(p)$ for all possible positions $p \\in \\{1, \\dots, N-1\\}$, the positions are ranked in descending order of their scores. Any ties in the score are resolved by selecting the position with the smaller value of $p$. The position with the highest rank is chosen as the most plausible location of the double bond.\n    A special condition is mandated: if the highest score obtained amongst all positions is $0$, it implies that no hypothesis is supported by the experimental data within the given tolerance. In this scenario, a value of $-1$ is returned to indicate the absence of a plausible solution.\n\n5.  **Algorithmic Implementation**: The logic is implemented as a Python program. A function `calculate_fragment_mz(s)` computes the two expected $m/z$ values for a fragment of size $s$. A second function, `solve_case`, iterates through all possible positions $p$, calculates the set of expected ions $E_p$, and computes the score $S(p)$ by comparing against the observed peaks using the defined scoring rule. This main function keeps track of the best score found so far and the corresponding position, respecting the tie-breaking rule. Finally, it checks if the best score is zero to return $-1$ if necessary. The program processes each test case provided and formats the final results into a single comma-separated list. Numpy is utilized for efficient numerical computations, particularly for finding the minimum deviation $\\delta$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results according to the problem specification.\n    \"\"\"\n    \n    # Define the monoisotopic masses and proton mass as global constants.\n    M_C = 12.000000  # Daltons\n    M_H = 1.007825  # Daltons\n    M_O = 15.994915  # Daltons\n    M_H_PLUS = 1.007276  # Daltons\n\n    def calculate_fragment_mz(s: int):\n        \"\"\"\n        Calculates the m/z values for the singly protonated aldehyde and \n        Criegee intermediate for a fragment of size s.\n\n        Args:\n            s (int): The number of carbon atoms in the fragment.\n\n        Returns:\n            tuple[float, float]: A tuple containing the m/z of the aldehyde and Criegee ions.\n        \"\"\"\n        # Calculate neutral mass for C_s H_{2s} O (aldehyde)\n        neutral_mass_aldehyde = s * M_C + 2 * s * M_H + M_O\n        # Calculate neutral mass for C_s H_{2s} O_2 (Criegee)\n        neutral_mass_criegee = s * M_C + 2 * s * M_H + 2 * M_O\n        \n        # Add proton mass for singly protonated ions\n        mz_aldehyde = neutral_mass_aldehyde + M_H_PLUS\n        mz_criegee = neutral_mass_criegee + M_H_PLUS\n        \n        return mz_aldehyde, mz_criegee\n\n    def solve_case(N: int, tau: float, observed_peaks: list[float]):\n        \"\"\"\n        Solves for the most plausible double bond position for a single test case.\n\n        Args:\n            N (int): Total number of carbon atoms in the chain.\n            tau (float): Non-negative mass tolerance in Daltons.\n            observed_peaks (list[float]): A list of observed m/z values.\n\n        Returns:\n            int: The most plausible double bond position p, or -1 if no plausible position is found.\n        \"\"\"\n        best_p = -1\n        best_score = -1.0 # Initialize with a value lower than any possible score\n\n        # Convert observed_peaks to a numpy array for efficient computation.\n        # If the list is empty, handle it to avoid errors.\n        if observed_peaks:\n            observed_peaks_np = np.array(observed_peaks)\n        else:\n            observed_peaks_np = np.array([])\n            \n        # Iterate through all possible double bond positions p\n        for p in range(1, N):\n            s1 = p\n            s2 = N - p\n            \n            # Generate the set of expected m/z values to handle symmetric cases automatically.\n            mz_ald1, mz_cri1 = calculate_fragment_mz(s1)\n            mz_ald2, mz_cri2 = calculate_fragment_mz(s2)\n            expected_mzs = sorted(list(set([mz_ald1, mz_cri1, mz_ald2, mz_cri2])))\n            \n            total_weight = 0.0\n            \n            # If no peaks are observed, score is 0.\n            if observed_peaks_np.size > 0:\n                for x in expected_mzs:\n                    # Calculate the minimal absolute deviation delta\n                    delta = np.min(np.abs(observed_peaks_np - x))\n                    \n                    # Calculate weight if deviation is within tolerance\n                    if delta = tau:\n                        weight = 1.0 - delta / tau\n                        total_weight += weight\n            \n            # The score for position p is the average of the weights.\n            current_score = total_weight / len(expected_mzs)\n\n            # Update best score and position.\n            # The tie-breaking rule (smallest p) is handled by iterating p\n            # in ascending order and only updating on strictly greater scores.\n            if current_score > best_score:\n                best_score = current_score\n                best_p = p\n\n        # If the highest score is 0, return -1.\n        # Use np.isclose for robust floating point comparison.\n        if np.isclose(best_score, 0.0):\n            return -1\n        else:\n            return best_p\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (18, 0.01, [143.146541, 159.133956, 100.000000, 200.500000]),\n        (20, 0.01, [213.227291, 229.214206, 150.000000]),\n        (16, 0.02, [31.022841, 47.020756, 80.000000, 200.000000]),\n        (22, 0.01, [])\n    ]\n\n    results = []\n    for N, tau, observed_peaks in test_cases:\n        result = solve_case(N, tau, observed_peaks)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}