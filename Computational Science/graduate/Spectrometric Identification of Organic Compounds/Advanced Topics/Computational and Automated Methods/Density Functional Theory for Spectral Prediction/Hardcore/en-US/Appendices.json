{
    "hands_on_practices": [
        {
            "introduction": "The choice of the exchange-correlation (XC) functional is the most critical decision in a Density Functional Theory calculation, directly impacting the accuracy of the results. This exercise explores how the composition of the XC functional, specifically the fraction of exact exchange, systematically affects predicted vibrational frequencies . By modeling the carbonyl stretching frequency, you will gain a hands-on understanding of why common functionals like PBE, B3LYP, and PBE0 produce different results and how hybrid functionals mitigate the self-interaction error that often leads to overestimated frequencies.",
            "id": "3698588",
            "problem": "You are tasked with designing and implementing a program that models infrared (IR) carbonyl stretching frequency predictions for different Density Functional Theory (DFT) exchange-correlation approximations by starting from physically grounded principles. Use the Born–Oppenheimer approximation and the harmonic approximation near the minimum of the potential energy surface as your fundamental base, and work from the definition of the force constant as the curvature of the potential energy with respect to bond displacement and the relationship between vibrational frequency and reduced mass. Your objective is to construct a quantitative model that captures the systematic overbinding due to self-interaction error and its mitigation by a fraction of exact exchange in hybrid functionals. The program must compute and compare IR wavenumbers (in $\\mathrm{cm}^{-1}$) for a carbonyl group under the following functionals: Perdew–Burke–Ernzerhof (PBE), Becke, $3$-parameter, Lee–Yang–Parr (B3LYP), and PBE0, and additionally report values for two boundary cases to test model behavior.\n\nModeling directives and constants to be used:\n- Assume a single carbonyl bond treated as a diatomic oscillator with carbon mass $12$ atomic mass units (atomic mass unit (amu)) and oxygen mass $16$ atomic mass units.\n- Use the atomic mass unit $1\\,\\mathrm{amu} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$.\n- Use the speed of light $c = 2.99792458\\times 10^{10}\\,\\mathrm{cm/s}$.\n- Take the reference (target, self-interaction-error free) carbonyl wavenumber to be $\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$, representative of a typical organic carbonyl stretch in the absence of systematic overbinding.\n- Define the reduced mass $\\mu$ for carbon and oxygen, and relate the predicted harmonic wavenumber $\\tilde{\\nu}$ to the force constant curvature $k$ and $\\mu$ by appropriate derivation from these bases.\n- Model the effect of the exact exchange fraction $\\alpha$ on the curvature through a monotone-decaying bias term that represents residual overbinding when $\\alpha = 0$ and diminishes as $\\alpha$ increases. Use the following form for the curvature model:\n  - $k(\\alpha) = k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\!\\left(-\\dfrac{\\alpha}{\\alpha_{0}}\\right)\\right]$,\n  where $k_{\\mathrm{ref}}$ is the curvature consistent with $\\tilde{\\nu}_{\\mathrm{ref}}$, $\\delta_{0} = 0.12$ is the zero-exact-exchange fractional overbinding magnitude, and $\\alpha_{0} = 0.10$ characterizes the decay with increasing exact exchange.\n- Compute the predicted IR wavenumbers in $\\mathrm{cm}^{-1}$ for the following test suite of exact exchange fractions $\\alpha$:\n  - PBE: $\\alpha = 0.00$\n  - B3LYP: $\\alpha = 0.20$\n  - PBE0: $\\alpha = 0.25$\n  - Boundary case (higher hybrid content): $\\alpha = 0.50$\n  - Boundary case (Hartree–Fock-like limit): $\\alpha = 1.00$\n- Express all final wavenumber results in $\\mathrm{cm}^{-1}$, rounded to one decimal place.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3},\\dots]$). The list must contain the five wavenumbers computed for the test suite in the exact order specified above. No other text should be printed.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and internally consistent. All necessary physical constants, model parameters, and theoretical frameworks are provided to construct a unique, verifiable solution. The underlying model is a physically motivated, albeit phenomenological, representation of the effect of self-interaction error in density functional theory (DFT) on vibrational frequencies, a standard topic in computational chemistry. Therefore, the problem is valid, and a solution can be formulated.\n\nThe objective is to compute the predicted infrared (IR) stretching wavenumber, $\\tilde{\\nu}$, for a carbonyl group, modeled as a diatomic harmonic oscillator, under different DFT exchange-correlation functionals. The effect of each functional is parameterized by its fraction of exact exchange, $\\alpha$.\n\nThe analysis begins with the fundamental relationship for a harmonic oscillator. The angular frequency, $\\omega$, is related to the force constant, $k$ (the curvature of the potential energy surface), and the reduced mass, $\\mu$, by:\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\nThe vibrational frequency, $\\nu$, is $\\nu = \\omega / (2\\pi)$. In spectroscopy, it is conventional to use wavenumber, $\\tilde{\\nu}$, which is defined as $\\tilde{\\nu} = \\nu/c$, where $c$ is the speed of light. Combining these definitions yields the central equation for vibrational wavenumber:\n$$\n\\tilde{\\nu} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}}\n$$\nThe problem models a carbonyl group, C=O, as a diatomic system. The masses are given as $m_C = 12\\,\\mathrm{amu}$ and $m_O = 16\\,\\mathrm{amu}$. The reduced mass $\\mu$ is calculated as:\n$$\n\\mu = \\frac{m_C m_O}{m_C + m_O} = \\frac{(12\\,\\mathrm{amu})(16\\,\\mathrm{amu})}{12\\,\\mathrm{amu} + 16\\,\\mathrm{amu}} = \\frac{192}{28}\\,\\mathrm{amu} = \\frac{48}{7}\\,\\mathrm{amu}\n$$\nAlthough the constant for converting atomic mass units to kilograms is provided ($1\\,\\mathrm{amu} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$), we can devise a more elegant solution by first determining the reference force constant, $k_{\\mathrm{ref}}$, corresponding to the specified reference wavenumber, $\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$. This reference value represents the ideal, self-interaction-error-free result.\n\nRearranging the wavenumber equation, we can express the force constant $k$ in terms of $\\tilde{\\nu}$, $c$, and $\\mu$:\n$$\nk = (2\\pi c \\tilde{\\nu})^2 \\mu\n$$\nThus, the reference force constant is:\n$$\nk_{\\mathrm{ref}} = (2\\pi c \\tilde{\\nu}_{\\mathrm{ref}})^2 \\mu\n$$\nThe problem posits a model for the predicted force constant, $k(\\alpha)$, as a function of the exact exchange fraction $\\alpha$. This model captures the systematic overbinding (larger force constant) associated with pure generalized gradient approximation (GGA) functionals (where $\\alpha=0$) and its reduction as exact exchange is mixed in:\n$$\nk(\\alpha) = k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\!\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)\\right]\n$$\nHere, $\\delta_{0} = 0.12$ represents the fractional overestimation of the force constant at $\\alpha=0$, and $\\alpha_{0} = 0.10$ is a decay constant characterizing how quickly this overestimation is corrected with increasing $\\alpha$.\n\nThe predicted wavenumber, $\\tilde{\\nu}(\\alpha)$, can now be written by substituting this expression for $k(\\alpha)$ into the fundamental wavenumber equation:\n$$\n\\tilde{\\nu}(\\alpha) = \\frac{1}{2\\pi c}\\sqrt{\\frac{k(\\alpha)}{\\mu}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\!\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)\\right]}{\\mu}}\n$$\nWe can factor this expression as:\n$$\n\\tilde{\\nu}(\\alpha) = \\left(\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\\right) \\sqrt{1 + \\delta_{0}\\exp\\!\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)}\n$$\nThe term in the parenthesis is, by definition, the reference wavenumber $\\tilde{\\nu}_{\\mathrm{ref}}$. This leads to a simplified and computationally direct final expression that elegantly bypasses the need to explicitly calculate $\\mu$ in kilograms or $k_{\\mathrm{ref}}$ in SI units:\n$$\n\\tilde{\\nu}(\\alpha) = \\tilde{\\nu}_{\\mathrm{ref}} \\sqrt{1 + \\delta_{0}\\exp\\!\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)}\n$$\nUsing the provided values $\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$, $\\delta_{0} = 0.12$, and $\\alpha_{0} = 0.10$, we can compute the wavenumbers for the specified test suite of $\\alpha$ values.\n\nThe test suite is:\n1.  PBE: $\\alpha = 0.00$\n    $$\n    \\tilde{\\nu}(0.00) = 1715 \\sqrt{1 + 0.12 \\exp(0)} = 1715 \\sqrt{1.12} \\approx 1815.018\\,\\mathrm{cm}^{-1}\n    $$\n2.  B3LYP: $\\alpha = 0.20$\n    $$\n    \\tilde{\\nu}(0.20) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.20}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-2}} \\approx 1728.828\\,\\mathrm{cm}^{-1}\n    $$\n3.  PBE0: $\\alpha = 0.25$\n    $$\n    \\tilde{\\nu}(0.25) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.25}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-2.5}} \\approx 1723.411\\,\\mathrm{cm}^{-1}\n    $$\n4.  Boundary Case (higher hybrid): $\\alpha = 0.50$\n    $$\n    \\tilde{\\nu}(0.50) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.50}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-5}} \\approx 1715.693\\,\\mathrm{cm}^{-1}\n    $$\n5.  Boundary Case (Hartree-Fock-like limit): $\\alpha = 1.00$\n    $$\n    \\tilde{\\nu}(1.00) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{1.00}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-10}} \\approx 1715.005\\,\\mathrm{cm}^{-1}\n    $$\nThese results must be rounded to one decimal place for the final output. This procedure is implemented in the following program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes predicted IR wavenumbers for a carbonyl group based on a model\n    of DFT self-interaction error as a function of exact exchange fraction.\n    \"\"\"\n    \n    # Define model parameters and the reference value from the problem statement.\n    nu_ref_cm_inv = 1715.0  # Reference wavenumber in cm^-1\n    delta_0 = 0.12          # Zero-exchange fractional overbinding magnitude\n    alpha_0 = 0.10          # Decay constant for exact exchange correction\n\n    # Define the test suite of exact exchange fractions (alpha)\n    # The order corresponds to PBE, B3LYP, PBE0, high-hybrid, HF-limit.\n    alpha_values = [\n        0.00,  # PBE\n        0.20,  # B3LYP\n        0.25,  # PBE0\n        0.50,  # Boundary case 1\n        1.00   # Boundary case 2\n    ]\n\n    results = []\n    \n    # The core model equation relates the predicted wavenumber to the reference\n    # wavenumber and the fraction of exact exchange, alpha.\n    # nu_pred(alpha) = nu_ref * sqrt(1 + delta_0 * exp(-alpha / alpha_0))\n    for alpha in alpha_values:\n        # Calculate the argument of the square root\n        correction_term = delta_0 * np.exp(-alpha / alpha_0)\n        \n        # Calculate the predicted wavenumber\n        nu_pred = nu_ref_cm_inv * np.sqrt(1 + correction_term)\n        \n        # Round the result to one decimal place as required\n        rounded_result = round(nu_pred, 1)\n        results.append(rounded_result)\n\n    # Format the final output as a comma-separated list in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "Alongside the functional, the choice of atomic orbital basis set is fundamental to the accuracy of any DFT prediction. This practice investigates how basis set incompleteness introduces errors into calculated spectroscopic parameters, specifically the vibrational frequency and infrared intensity of carbon monoxide . You will use a model that perturbs the \"exact\" force constant $k$ and dipole moment derivative $\\frac{\\partial \\mu}{\\partial r}$ to simulate the deficiencies of smaller basis sets, revealing the distinct sensitivities of frequencies and intensities to the quality of the electronic structure description.",
            "id": "3698611",
            "problem": "You must write a complete program that, within the harmonic approximation, compares predicted carbon monoxide stretching frequencies and infrared intensities using two different orbital basis sets and quantitatively attributes the dominant sources of basis-set-related error in a density functional theory (DFT) vibrational analysis. The program must implement the model below, compute the requested quantities for a provided test suite, and produce the final results in the specified single-line format.\n\nUse the following fundamental base and core definitions.\n\n1) Born–Oppenheimer separation and the harmonic approximation: Near the equilibrium bond length, the potential energy for a diatomic molecule is approximated as quadratic in the bond displacement coordinate. The Hessian (second derivative of the potential with respect to the bond length) evaluated at the equilibrium geometry is the force constant. Under the harmonic approximation, the vibrational angular frequency is given by\n$$\\omega = \\sqrt{\\frac{k}{\\mu}},$$\nwhere $k$ is the harmonic force constant and $\\mu$ is the reduced mass.\n\n2) Wavenumber conversion: The observable harmonic wavenumber in reciprocal centimeters is\n$$\\tilde{\\nu} = \\frac{\\omega}{2\\pi c} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}},$$\nwhere $c$ is the speed of light in $\\mathrm{cm\\,s^{-1}}$. All wavenumbers must be expressed in $\\mathrm{cm^{-1}}$.\n\n3) Infrared (IR) intensity under the double-harmonic approximation: The integrated intensity of a fundamental vibrational transition is proportional to the square of the derivative of the permanent dipole moment with respect to the normal coordinate. For a diatomic molecule with a single normal mode, the mass-weighted normal coordinate $Q$ is related to the bond length $r$ by $Q=\\sqrt{\\mu}\\,\\Delta r$ (up to an unimportant phase). Thus,\n$$\\left(\\frac{\\partial \\mu}{\\partial Q}\\right) = \\frac{1}{\\sqrt{\\mu}}\\left(\\frac{\\partial \\mu}{\\partial r}\\right),$$\nand therefore, under fixed $\\mu$, any basis-set error in the IR intensity arises from the error in $\\partial\\mu/\\partial r$. To eliminate unit dependencies and ensure a unitless target, define the normalized IR intensity as the ratio\n$$I_{\\mathrm{rel}} = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{pred}}}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2,$$\nwhich is dimensionless.\n\n4) Basis-set error model: Represent basis-set incompleteness errors as relative perturbations to the force constant and to the dipole moment derivative about a fixed, high-level reference:\n$$k_{\\mathrm{pred}} = k_{\\mathrm{ref}}\\left(1 + \\delta_k\\right),\\qquad \\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{pred}} = \\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{ref}}\\left(1 + \\delta_d\\right),$$\nwhere $\\delta_k$ and $\\delta_d$ are dimensionless relative errors associated with the chosen basis set.\n\nConstants and reference values to be used in all computations:\n\n- Atomic mass unit: $u = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$.\n- Atomic masses: $m_{\\mathrm{C}} = 12.000000\\ u$, $m_{\\mathrm{O}} = 15.99491461957\\ u$.\n- Reduced mass: $\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}$ in $\\mathrm{kg}$.\n- Speed of light: $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$.\n- Reference CO harmonic wavenumber: $\\tilde{\\nu}_{\\mathrm{ref}} = 2143.27\\ \\mathrm{cm^{-1}}$.\n- Reference force constant defined implicitly by the wavenumber and reduced mass:\n$$k_{\\mathrm{ref}} = \\mu \\left(2\\pi c \\tilde{\\nu}_{\\mathrm{ref}}\\right)^2\\ \\mathrm{N\\,m^{-1}}.$$\n- Reference dipole derivative (for completeness of the model, cancels out in the normalized intensity): $\\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{ref}} = 0.20$ in consistent arbitrary units; only ratios are used.\n\nFor a given pair $\\left(\\delta_k,\\delta_d\\right)$, compute:\n- The predicted harmonic wavenumber in reciprocal centimeters,\n$$\\tilde{\\nu}_{\\mathrm{pred}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}},$$\nrounded to two decimal places and expressed in $\\mathrm{cm^{-1}}$.\n- The normalized IR intensity $I_{\\mathrm{rel}}=\\left(1+\\delta_d\\right)^2$, rounded to five decimal places (dimensionless).\n- The absolute wavenumber error $|\\tilde{\\nu}_{\\mathrm{pred}} - \\tilde{\\nu}_{\\mathrm{ref}}|$ in $\\mathrm{cm^{-1}}$, rounded to two decimal places.\n- The absolute normalized intensity deviation $|I_{\\mathrm{rel}}-1|$ (dimensionless), rounded to five decimal places.\n\nTo identify the dominant source of basis-set-related error for each observable, decompose the total error into contributions from perturbing each primary quantity separately:\n- Frequency sensitivity: compute the wavenumber with only $k$ perturbed, $\\tilde{\\nu}_{k\\text{-only}}=\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}}$, and with only $\\partial\\mu/\\partial r$ perturbed, $\\tilde{\\nu}_{d\\text{-only}}=\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}=\\tilde{\\nu}_{\\mathrm{ref}}$. Define contributions $\\Delta\\tilde{\\nu}_{k}=|\\tilde{\\nu}_{k\\text{-only}}-\\tilde{\\nu}_{\\mathrm{ref}}|$ and $\\Delta\\tilde{\\nu}_{d}=|\\tilde{\\nu}_{d\\text{-only}}-\\tilde{\\nu}_{\\mathrm{ref}}|$, and set a boolean flag for whether the force-constant contribution is dominant: $\\mathrm{isKdom} = \\Delta\\tilde{\\nu}_{k} \\ge \\Delta\\tilde{\\nu}_{d}$.\n- Intensity sensitivity: compute $I_{\\mathrm{rel},k\\text{-only}}=1$ and $I_{\\mathrm{rel},d\\text{-only}}=\\left(1+\\delta_d\\right)^2$, then define $\\Delta I_k=|I_{\\mathrm{rel},k\\text{-only}}-1|$ and $\\Delta I_d=|I_{\\mathrm{rel},d\\text{-only}}-1|$, and set a boolean flag for whether the dipole-derivative contribution is dominant: $\\mathrm{isDdom} = \\Delta I_d \\ge \\Delta I_k$.\n\nTest suite. Evaluate the following five cases:\n- Case 1 (6-31G(d)): $\\delta_k=-0.05$, $\\delta_d=-0.10$.\n- Case 2 (correlation-consistent polarized valence triple-zeta, cc-pVTZ): $\\delta_k=-0.01$, $\\delta_d=-0.03$.\n- Case 3 (ideal/no error): $\\delta_k=0.00$, $\\delta_d=0.00$.\n- Case 4 (force-constant-only error): $\\delta_k=+0.02$, $\\delta_d=0.00$.\n- Case 5 (dipole-derivative-only error): $\\delta_k=0.00$, $\\delta_d=+0.15$.\n\nAdditionally, report a quantitative comparison between the two basis sets in Cases 1 and 2 by providing the ratios of absolute errors:\n- The ratio of absolute wavenumber errors, $R_{\\nu} = \\frac{|\\tilde{\\nu}_{\\mathrm{pred}}^{(1)} - \\tilde{\\nu}_{\\mathrm{ref}}|}{|\\tilde{\\nu}_{\\mathrm{pred}}^{(2)} - \\tilde{\\nu}_{\\mathrm{ref}}|}$, rounded to five decimal places.\n- The ratio of absolute normalized intensity deviations, $R_{I} = \\frac{|I_{\\mathrm{rel}}^{(1)}-1|}{|I_{\\mathrm{rel}}^{(2)}-1|}$, rounded to five decimal places.\n\nFinal output format. Your program should produce a single line of output containing a list whose elements are, in order, the five per-case results followed by the two-element comparison list. Each per-case result must itself be a list of six entries in the order:\n[$\\tilde{\\nu}_{\\mathrm{pred}}$ in $\\mathrm{cm^{-1}}$ (rounded to two decimals), $I_{\\mathrm{rel}}$ (rounded to five decimals), $|\\tilde{\\nu}_{\\mathrm{pred}}-\\tilde{\\nu}_{\\mathrm{ref}}|$ in $\\mathrm{cm^{-1}}$ (rounded to two decimals), $|I_{\\mathrm{rel}}-1|$ (rounded to five decimals), $\\mathrm{isKdom}$ (boolean), $\\mathrm{isDdom}$ (boolean)].\n\nConcretely, the printed line should look like a valid comma-separated list with nested square brackets, for example:\n[[nu1,I1,dnu1,dI1,True,True],[nu2,I2,dnu2,dI2,True,True],...,[Rnu,RI]]\n\nAll wavenumbers must be in $\\mathrm{cm^{-1}}$ rounded to two decimal places. All normalized intensities and ratios must be dimensionless decimals rounded to five decimal places. Angles are not used. Percentages must be expressed as decimals (e.g., 0.10 for ten percent). No additional text should be printed.",
            "solution": "The user has provided a well-defined computational problem grounded in the principles of theoretical spectroscopy. The problem is scientifically sound, self-contained, and calls for the implementation of a clear physical model. All necessary constants, reference values, and analytical expressions are provided. The objectives are unambiguous, and a unique, verifiable solution can be computed. The problem is therefore deemed valid.\n\nThe solution proceeds by first establishing the necessary physical constants and derived reference values. Subsequently, for each specified case of basis-set error parameters $(\\delta_k, \\delta_d)$, a series of quantities are computed: the predicted vibrational wavenumber, the normalized infrared intensity, their respective deviations from reference values, and flags indicating the dominant source of error for each observable. Finally, a quantitative comparison of errors between two specific basis sets is performed.\n\nFirst, we define the physical constants and reference values.\nThe atomic mass unit is $u = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$.\nThe atomic masses are $m_{\\mathrm{C}} = 12.000000\\ u$ and $m_{\\mathrm{O}} = 15.99491461957\\ u$.\nThe reduced mass $\\mu$ of the carbon monoxide molecule is calculated as:\n$$\n\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}} = \\frac{(12.000000)(15.99491461957)}{12.000000 + 15.99491461957} u \\approx 6.856209\\ u\n$$\nConverting to SI units, $\\mu \\approx 1.138500 \\times 10^{-26}\\ \\mathrm{kg}$.\nThe speed of light is $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$.\nThe reference harmonic wavenumber is $\\tilde{\\nu}_{\\mathrm{ref}} = 2143.27\\ \\mathrm{cm^{-1}}$.\n\nThe reference force constant $k_{\\mathrm{ref}}$ is implicitly defined by the harmonic oscillator model:\n$$\n\\tilde{\\nu}_{\\mathrm{ref}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\n$$\nSolving for $k_{\\mathrm{ref}}$ yields $k_{\\mathrm{ref}} = \\mu (2\\pi c \\tilde{\\nu}_{\\mathrm{ref}})^2$. While this value could be computed numerically, it is more elegant and precise to work with ratios, as will be shown.\n\nThe core of the problem lies in evaluating the effect of relative errors, $\\delta_k$ and $\\delta_d$, on the predicted observables. The predicted force constant is $k_{\\mathrm{pred}} = k_{\\mathrm{ref}}(1 + \\delta_k)$.\n\nThe predicted harmonic wavenumber, $\\tilde{\\nu}_{\\mathrm{pred}}$, is given by:\n$$\n\\tilde{\\nu}_{\\mathrm{pred}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{pred}}}{\\mu}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}}\n$$\nBy substituting the expression for $\\tilde{\\nu}_{\\mathrm{ref}}$, this simplifies to:\n$$\n\\tilde{\\nu}_{\\mathrm{pred}} = \\left(\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\\right) \\sqrt{1+\\delta_k} = \\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k}\n$$\nThis simplified form avoids explicit calculation of $k_{\\mathrm{ref}}$ and $\\mu$, reducing the risk of floating-point precision loss.\n\nThe predicted normalized IR intensity, $I_{\\mathrm{rel}}$, depends on the relative error in the dipole moment derivative, $\\delta_d$:\n$$\nI_{\\mathrm{rel}} = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{pred}}}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2 = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}(1+\\delta_d)}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2 = (1+\\delta_d)^2\n$$\n\nFor each case, we must compute four primary quantities:\n$1$. The predicted wavenumber $\\tilde{\\nu}_{\\mathrm{pred}}$, rounded to two decimal places.\n$2$. The normalized IR intensity $I_{\\mathrm{rel}}$, rounded to five decimal places.\n$3$. The absolute wavenumber error $|\\tilde{\\nu}_{\\mathrm{pred}} - \\tilde{\\nu}_{\\mathrm{ref}}|$, rounded to two decimal places.\n$4$. The absolute normalized intensity deviation $|I_{\\mathrm{rel}}-1|$, rounded to five decimal places.\n\nNext, we address the sensitivity analysis. The goal is to determine whether the error in the force constant ($k$) or the dipole derivative ($d$) is the dominant source of error for each observable.\n\nFor the wavenumber, the error contributions are defined as:\n$\\Delta\\tilde{\\nu}_{k} = |\\tilde{\\nu}_{k\\text{-only}} - \\tilde{\\nu}_{\\mathrm{ref}}|$, where $\\tilde{\\nu}_{k\\text{-only}} = \\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k}$.\n$\\Delta\\tilde{\\nu}_{d} = |\\tilde{\\nu}_{d\\text{-only}} - \\tilde{\\nu}_{\\mathrm{ref}}|$, where $\\tilde{\\nu}_{d\\text{-only}} = \\tilde{\\nu}_{\\mathrm{ref}}$.\nThus, $\\Delta\\tilde{\\nu}_{k} = |\\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k} - \\tilde{\\nu}_{\\mathrm{ref}}|$ and $\\Delta\\tilde{\\nu}_{d} = 0$.\nThe boolean flag is $\\mathrm{isKdom} = (\\Delta\\tilde{\\nu}_{k} \\ge \\Delta\\tilde{\\nu}_{d})$. Since $\\Delta\\tilde{\\nu}_{k}$ is an absolute value and thus always non-negative, and $\\Delta\\tilde{\\nu}_{d}$ is always $0$, this condition is always true. This correctly reflects that, in this decoupled model, only the force constant affects the frequency.\n\nFor the normalized intensity, the error contributions are:\n$\\Delta I_k = |I_{\\mathrm{rel},k\\text{-only}}-1|$, where $I_{\\mathrm{rel},k\\text{-only}} = (1+0)^2=1$.\n$\\Delta I_d = |I_{\\mathrm{rel},d\\text{-only}}-1|$, where $I_{\\mathrm{rel},d\\text{-only}} = (1+\\delta_d)^2$.\nThus, $\\Delta I_k = 0$ and $\\Delta I_d = |(1+\\delta_d)^2 - 1|$.\nThe boolean flag is $\\mathrm{isDdom} = (\\Delta I_d \\ge \\Delta I_k)$. Since $\\Delta I_d$ is an absolute value and thus always non-negative, and $\\Delta I_k$ is always $0$, this condition is also always true. This correctly reflects that only the dipole derivative affects the IR intensity in this model.\n\nFinally, we compute the ratios of absolute errors for Case $1$ $(\\delta_k^{(1)}, \\delta_d^{(1)})$ versus Case $2$ $(\\delta_k^{(2)}, \\delta_d^{(2)})$.\nThe ratio of absolute wavenumber errors is:\n$$\nR_{\\nu} = \\frac{|\\tilde{\\nu}_{\\mathrm{pred}}^{(1)} - \\tilde{\\nu}_{\\mathrm{ref}}|}{|\\tilde{\\nu}_{\\mathrm{pred}}^{(2)} - \\tilde{\\nu}_{\\mathrm{ref}}|} = \\frac{\\tilde{\\nu}_{\\mathrm{ref}}|\\sqrt{1+\\delta_k^{(1)}} - 1|}{\\tilde{\\nu}_{\\mathrm{ref}}|\\sqrt{1+\\delta_k^{(2)}} - 1|} = \\frac{|\\sqrt{1+\\delta_k^{(1)}} - 1|}{|\\sqrt{1+\\delta_k^{(2)}} - 1|}\n$$\nThe ratio of absolute normalized intensity deviations is:\n$$\nR_{I} = \\frac{|I_{\\mathrm{rel}}^{(1)}-1|}{|I_{\\mathrm{rel}}^{(2)}-1|} = \\frac{|(1+\\delta_d^{(1)})^2-1|}{|(1+\\delta_d^{(2)})^2-1|}\n$$\nThese ratios are to be rounded to five decimal places.\n\nThe program will execute these calculations for the five test cases, collect the six specified results for each case, calculate the two final ratio metrics, and format all results into a single output line as per the problem specification.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes predicted spectroscopic properties and error contributions for CO\n    based on a DFT error model.\n    \"\"\"\n    \n    # Define constants and reference values from the problem statement.\n    NU_REF_CM = 2143.27  # Reference wavenumber in cm^-1\n\n    # Define the test suite. Each tuple is (delta_k, delta_d).\n    test_cases = [\n        (-0.05, -0.10),   # Case 1: 6-31G(d)\n        (-0.01, -0.03),   # Case 2: cc-pVTZ\n        (0.00, 0.00),     # Case 3: Ideal/no error\n        (0.02, 0.00),     # Case 4: Force-constant-only error\n        (0.00, 0.15),     # Case 5: Dipole-derivative-only error\n    ]\n\n    all_case_results = []\n    case_abs_errors = []\n\n    for delta_k, delta_d in test_cases:\n        # --- Core Calculations ---\n        # The predicted wavenumber simplifies to nu_ref * sqrt(1 + delta_k).\n        nu_pred = NU_REF_CM * np.sqrt(1 + delta_k)\n        \n        # The normalized IR intensity.\n        i_rel = (1 + delta_d)**2\n        \n        # --- Error and Deviation Calculations ---\n        # Absolute wavenumber error.\n        d_nu = abs(nu_pred - NU_REF_CM)\n        \n        # Absolute normalized intensity deviation.\n        d_i = abs(i_rel - 1)\n        \n        # Store unrounded absolute errors for Cases 1 and 2 for the final ratio calculation.\n        case_abs_errors.append((d_nu, d_i))\n\n        # --- Sensitivity Analysis ---\n        # Wavenumber sensitivity.\n        # As derived, a change in dipole derivative (d) does not affect the wavenumber.\n        delta_nu_k = abs(NU_REF_CM * np.sqrt(1 + delta_k) - NU_REF_CM)\n        delta_nu_d = 0.0\n        is_k_dom = delta_nu_k >= delta_nu_d # Will always be True\n\n        # Intensity sensitivity.\n        # As derived, a change in force constant (k) does not affect the normalized intensity.\n        delta_i_k = 0.0\n        delta_i_d = abs((1 + delta_d)**2 - 1)\n        is_d_dom = delta_i_d >= delta_i_k # Will always be True\n\n        # --- Rounding for Output ---\n        nu_pred_rounded = round(nu_pred, 2)\n        i_rel_rounded = round(i_rel, 5)\n        d_nu_rounded = round(d_nu, 2)\n        d_i_rounded = round(d_i, 5)\n\n        # Collect results for the current case.\n        case_result = [\n            nu_pred_rounded, \n            i_rel_rounded, \n            d_nu_rounded, \n            d_i_rounded, \n            is_k_dom, \n            is_d_dom\n        ]\n        all_case_results.append(case_result)\n        \n    # --- Quantitative Comparison (Case 1 vs Case 2) ---\n    # Retrieve the unrounded absolute errors for Case 1 and Case 2.\n    d_nu1, d_i1 = case_abs_errors[0]\n    d_nu2, d_i2 = case_abs_errors[1]\n    \n    # Calculate ratios. Denominators are non-zero for Case 2.\n    r_nu = d_nu1 / d_nu2\n    r_i = d_i1 / d_i2\n    \n    # Round ratios and form the comparison list.\n    comparison_results = [round(r_nu, 5), round(r_i, 5)]\n\n    # --- Final Output Formatting ---\n    # Construct the final list containing all case results and the comparison.\n    final_list = all_case_results + [comparison_results]\n\n    # Convert each sublist to a string and remove spaces for compactness.\n    list_strs = [str(item).replace(\" \", \"\") for item in final_list]\n    \n    # Join the string representations of the lists with commas and enclose in brackets.\n    # The final element (comparison list) must be added after the case results.\n    # The f-string joins the first 5 elements and then appends the 6th.\n    case_strs = ','.join(list_strs[:-1])\n    comp_str = list_strs[-1]\n    final_output_string = f\"[{case_strs},{comp_str}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "A robust computational result depends not only on the chosen physical model but also on the numerical precision of the calculation itself. This practice addresses the numerical convergence of DFT predictions, focusing on two critical parameters: the density of the spatial integration grid ($M$) and the tightness of the Self-Consistent Field (SCF) convergence threshold ($\\tau$) . Through a quantitative error model, you will explore how these settings impact the accuracy of calculated IR intensities and NMR shieldings, underscoring the necessity of ensuring numerical convergence for reliable spectral prediction.",
            "id": "3698610",
            "problem": "You are to implement a complete, runnable program that models the numerical sensitivity of spectral properties predicted by Density Functional Theory (DFT) with respect to the integration grid density and Self-Consistent Field (SCF) convergence threshold. The program must perform a grid convergence study for a representative organic molecule and report the sensitivity of Infrared (IR) intensities and Nuclear Magnetic Resonance (NMR) shieldings to these numerical settings. The program must use a purely mathematical model derived from first principles of Kohn–Sham DFT and numerical analysis of quadrature and iterative methods, and it must produce quantitative results suitable for automated testing.\n\nStart from the following foundational base:\n\n- Kohn–Sham Density Functional Theory (DFT) defines an energy functional of the electron density, and response properties (e.g., IR intensities and NMR shieldings) are computed as ground-state or linear-response derivatives of this energy with respect to external perturbations. For IR, the intensity of mode $k$, denoted $I_k$, is proportional to the square of the derivative of the dipole moment $\\mu$ with respect to the normal mode coordinate $Q_k$, i.e., $I_k \\propto \\left(\\partial \\mu / \\partial Q_k\\right)^2$. For NMR, the absolute shielding $\\sigma_j$ of nucleus $j$ arises from the induced electronic current density response to an applied magnetic field, and can be expressed via second derivatives of the energy with respect to magnetic field components.\n- Numerical evaluation of exchange–correlation contributions and related property integrals in DFT employs atom-centered quadrature grids; the leading integration error for a sufficiently smooth integrand scales as a negative power of the total number of grid points $M$, i.e., an error term proportional to $M^{-\\alpha}$ for some exponent $\\alpha > 0$ determined by the quadrature’s convergence order.\n- The Self-Consistent Field (SCF) procedure solves the Kohn–Sham equations iteratively. A finite SCF convergence threshold $\\tau$ implies a residual electron density error $\\delta \\rho$ whose norm scales proportionally to $\\tau$ for fixed preconditioning and damping, and induces linear error propagation in computed properties, leading to error terms proportional to $\\tau^{\\beta}$ with $\\beta \\approx 1$ under typical conditions.\n\nUsing the above base, construct the following mathematical property-error model for a single representative organic molecule with three IR-active normal modes and three NMR-active nuclei:\n- Let the “true” (asymptotically converged) IR intensities be the vector $\\mathbf{I}^{\\mathrm{true}} = [220.0, 480.0, 35.0]$ in $\\mathrm{km/mol}$, corresponding to three distinct vibrational modes.\n- Let the “true” NMR shieldings be the vector $\\boldsymbol{\\sigma}^{\\mathrm{true}} = [31.5, 180.0, 85.0]$ in $\\mathrm{ppm}$, corresponding to three distinct nuclear sites.\n- For a given total grid point count $M$ and SCF threshold $\\tau$, define the predicted IR intensities\n$$\nI_k(M,\\tau) = I_k^{\\mathrm{true}} + a_{I,k} \\, M^{-\\alpha_I} + b_{I,k} \\, \\tau^{\\beta_I},\n$$\nand the predicted NMR shieldings\n$$\n\\sigma_j(M,\\tau) = \\sigma_j^{\\mathrm{true}} + a_{\\sigma,j} \\, M^{-\\alpha_\\sigma} + b_{\\sigma,j} \\, \\tau^{\\beta_\\sigma}.\n$$\nUse the following fixed, mode/site-dependent constants for the representative molecule:\n- IR error amplitudes $\\mathbf{a}_I = [5.0 \\times 10^6, 6.0 \\times 10^6, 1.5 \\times 10^6]$ (units consistent with $\\mathrm{km/mol}$),\n- IR SCF sensitivity coefficients $\\mathbf{b}_I = [5000.0, 8000.0, 2000.0]$ (units consistent with $\\mathrm{km/mol}$),\n- IR exponents $\\alpha_I = 1.6$ and $\\beta_I = 1.0$,\n- NMR error amplitudes $\\mathbf{a}_\\sigma = [5.0 \\times 10^6, 7.0 \\times 10^6, 4.0 \\times 10^6]$ (units consistent with $\\mathrm{ppm}$),\n- NMR SCF sensitivity coefficients $\\mathbf{b}_\\sigma = [300.0, 500.0, 400.0]$ (units consistent with $\\mathrm{ppm}$),\n- NMR exponents $\\alpha_\\sigma = 1.8$ and $\\beta_\\sigma = 1.0$.\n\nDefine a high-accuracy reference at $M_{\\mathrm{ref}} = 1{,}000{,}000$ and $\\tau_{\\mathrm{ref}} = 1.0 \\times 10^{-12}$, and compute the corresponding reference IR intensities $\\mathbf{I}^{\\mathrm{ref}} = \\mathbf{I}(M_{\\mathrm{ref}},\\tau_{\\mathrm{ref}})$ and reference NMR shieldings $\\boldsymbol{\\sigma}^{\\mathrm{ref}} = \\boldsymbol{\\sigma}(M_{\\mathrm{ref}},\\tau_{\\mathrm{ref}})$.\n\nFor each tested pair $(M,\\tau)$, compute two sensitivity metrics:\n1. The maximum relative IR intensity deviation (unitless, expressed as a decimal fraction), defined as\n$$\nS_{\\mathrm{IR}}(M,\\tau) = \\max_k \\left( \\frac{ \\left| I_k(M,\\tau) - I_k^{\\mathrm{ref}} \\right| }{ \\left| I_k^{\\mathrm{ref}} \\right| } \\right).\n$$\n2. The maximum absolute NMR shielding deviation (in $\\mathrm{ppm}$), defined as\n$$\nS_{\\mathrm{NMR}}(M,\\tau) = \\max_j \\left( \\left| \\sigma_j(M,\\tau) - \\sigma_j^{\\mathrm{ref}} \\right| \\right).\n$$\n\nPhysical units:\n- Report IR intensities in $\\mathrm{km/mol}$ where relevant; sensitivity $S_{\\mathrm{IR}}$ is unitless and must be expressed as a decimal.\n- Report NMR shieldings in $\\mathrm{ppm}$; sensitivity $S_{\\mathrm{NMR}}$ must be expressed in $\\mathrm{ppm}$.\n\nAngle units are not applicable here. Percentages are not permitted; $S_{\\mathrm{IR}}$ must be expressed as a decimal fraction.\n\nImplement your program to evaluate the following test suite of $(M,\\tau)$ values that cover a happy path, coarse-grid/loose-SCF, fine-grid/tight-SCF, ultra-tight-SCF, and very-coarse-grid cases:\n- Test case $1$: $M = 50000$, $\\tau = 1.0 \\times 10^{-6}$.\n- Test case $2$: $M = 5000$, $\\tau = 1.0 \\times 10^{-4}$.\n- Test case $3$: $M = 200000$, $\\tau = 1.0 \\times 10^{-8}$.\n- Test case $4$: $M = 30000$, $\\tau = 1.0 \\times 10^{-10}$.\n- Test case $5$: $M = 2000$, $\\tau = 1.0 \\times 10^{-8}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[S_{\\mathrm{IR}}, S_{\\mathrm{NMR}}]$. For example,\n$[[s_1^{\\mathrm{IR}},s_1^{\\mathrm{NMR}}],[s_2^{\\mathrm{IR}},s_2^{\\mathrm{NMR}}],\\dots]$.",
            "solution": "The problem is scientifically well-posed and provides a complete mathematical model to assess the numerical sensitivity of DFT calculations. All required constants and equations are given, allowing for a unique and verifiable solution. The model is a valid, though simplified, representation of how integration grid errors (scaling with grid size $M$) and SCF convergence errors (scaling with threshold $\\tau$) propagate into final computed properties. The problem is therefore valid, and a solution can be implemented as follows.\n\nThe core of the problem is to evaluate two sensitivity metrics, $S_{\\mathrm{IR}}$ and $S_{\\mathrm{NMR}}$, for a series of test calculations defined by a grid point count $M$ and an SCF threshold $\\tau$. These metrics quantify the deviation of a given calculation from a high-accuracy reference calculation.\n\nThe solution process involves three main steps:\n\n1.  **Calculate Reference Properties**: First, we compute the reference IR intensities ($\\mathbf{I}^{\\mathrm{ref}}$) and NMR shieldings ($\\boldsymbol{\\sigma}^{\\mathrm{ref}}$) using the provided high-accuracy parameters: $M_{\\mathrm{ref}} = 1{,}000{,}000$ and $\\tau_{\\mathrm{ref}} = 1.0 \\times 10^{-12}$. This is done by applying the given error model formulas:\n    $$\n    I_k^{\\mathrm{ref}} = I_k^{\\mathrm{true}} + a_{I,k} \\, M_{\\mathrm{ref}}^{-\\alpha_I} + b_{I,k} \\, \\tau_{\\mathrm{ref}}^{\\beta_I}\n    $$\n    $$\n    \\sigma_j^{\\mathrm{ref}} = \\sigma_j^{\\mathrm{true}} + a_{\\sigma,j} \\, M_{\\mathrm{ref}}^{-\\alpha_\\sigma} + b_{\\sigma,j} \\, \\tau_{\\mathrm{ref}}^{\\beta_\\sigma}\n    $$\n    These calculations are performed for each of the three IR modes and three NMR nuclei using the corresponding vector constants ($\\mathbf{I}^{\\mathrm{true}}$, $\\mathbf{a}_I$, $\\mathbf{b}_I$, etc.).\n\n2.  **Calculate Predicted Properties for Each Test Case**: For each pair of $(M, \\tau)$ in the test suite, we calculate the predicted properties, $\\mathbf{I}(M, \\tau)$ and $\\boldsymbol{\\sigma}(M, \\tau)$, using the same error model equations as in Step 1, but with the test case's $M$ and $\\tau$ values.\n\n3.  **Compute Sensitivity Metrics**: With the reference and predicted properties in hand, we can compute the sensitivity metrics for each test case.\n    *   The maximum relative IR intensity deviation, $S_{\\mathrm{IR}}$, is found by first calculating the element-wise relative deviation for all three modes, $\\left| I_k(M,\\tau) - I_k^{\\mathrm{ref}} \\right| / \\left| I_k^{\\mathrm{ref}} \\right|$, and then taking the maximum value among the three.\n    $$\n    S_{\\mathrm{IR}}(M,\\tau) = \\max_k \\left( \\frac{ \\left| I_k(M,\\tau) - I_k^{\\mathrm{ref}} \\right| }{ \\left| I_k^{\\mathrm{ref}} \\right| } \\right)\n    $$\n    *   The maximum absolute NMR shielding deviation, $S_{\\mathrm{NMR}}$, is found by calculating the element-wise absolute deviation for all three nuclei, $\\left| \\sigma_j(M,\\tau) - \\sigma_j^{\\mathrm{ref}} \\right|$, and then taking the maximum value among the three.\n    $$\n    S_{\\mathrm{NMR}}(M,\\tau) = \\max_j \\left( \\left| \\sigma_j(M,\\tau) - \\sigma_j^{\\mathrm{ref}} \\right| \\right)\n    $$\nThis procedure is repeated for all five test cases. The `numpy` library is ideally suited for these vectorized calculations, simplifying the implementation. The final output is an aggregation of the $[S_{\\mathrm{IR}}, S_{\\mathrm{NMR}}]$ pairs for each test case, formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Models the numerical sensitivity of DFT-predicted spectral properties\n    with respect to integration grid density and SCF convergence threshold.\n    \"\"\"\n\n    # Define the model parameters and constants from the problem statement.\n    # \"True\" (asymptotically converged) property values\n    I_true = np.array([220.0, 480.0, 35.0])\n    sigma_true = np.array([31.5, 180.0, 85.0])\n\n    # IR error model constants\n    a_I = np.array([5.0e6, 6.0e6, 1.5e6])\n    b_I = np.array([5000.0, 8000.0, 2000.0])\n    alpha_I = 1.6\n    beta_I = 1.0\n\n    # NMR error model constants\n    a_sigma = np.array([5.0e6, 7.0e6, 4.0e6])\n    b_sigma = np.array([300.0, 500.0, 400.0])\n    alpha_sigma = 1.8\n    beta_sigma = 1.0\n\n    # High-accuracy reference parameters\n    M_ref = 1_000_000\n    tau_ref = 1.0e-12\n\n    # Test suite of (M, tau) values\n    test_cases = [\n        (50000, 1.0e-6),  # Test case 1\n        (5000, 1.0e-4),   # Test case 2\n        (200000, 1.0e-8),  # Test case 3\n        (30000, 1.0e-10), # Test case 4\n        (2000, 1.0e-8),   # Test case 5\n    ]\n\n    def calculate_properties(M, tau):\n        \"\"\"\n        Calculates predicted IR intensities and NMR shieldings based on the error model.\n        \n        Args:\n            M (int): Total number of grid points.\n            tau (float): SCF convergence threshold.\n            \n        Returns:\n            tuple: A tuple containing the predicted IR intensities and NMR shieldings as numpy arrays.\n        \"\"\"\n        # Calculate grid and SCF error contributions\n        grid_error_I = a_I * (M ** (-alpha_I))\n        scf_error_I = b_I * (tau ** beta_I)\n        \n        grid_error_sigma = a_sigma * (M ** (-alpha_sigma))\n        scf_error_sigma = b_sigma * (tau ** beta_sigma)\n        \n        # Calculate predicted properties\n        I_predicted = I_true + grid_error_I + scf_error_I\n        sigma_predicted = sigma_true + grid_error_sigma + scf_error_sigma\n        \n        return I_predicted, sigma_predicted\n\n    # Step 1: Compute the reference properties\n    I_ref, sigma_ref = calculate_properties(M_ref, tau_ref)\n\n    # List to store the results for all test cases\n    results = []\n    \n    # Step 2: Loop through each test case\n    for M_test, tau_test in test_cases:\n        # Calculate predicted properties for the current test case\n        I_pred, sigma_pred = calculate_properties(M_test, tau_test)\n        \n        # Step 3: Calculate sensitivity metrics\n        \n        # S_IR: Maximum relative IR intensity deviation\n        # Absolute difference between predicted and reference IR intensities\n        abs_diff_I = np.abs(I_pred - I_ref)\n        # Relative difference, avoiding division by zero if I_ref_k is zero (not the case here)\n        rel_diff_I = abs_diff_I / np.abs(I_ref)\n        S_IR = np.max(rel_diff_I)\n        \n        # S_NMR: Maximum absolute NMR shielding deviation\n        # Absolute difference between predicted and reference NMR shieldings\n        abs_diff_sigma = np.abs(sigma_pred - sigma_ref)\n        S_NMR = np.max(abs_diff_sigma)\n        \n        results.append([S_IR, S_NMR])\n\n    # Step 4: Format the output string as specified\n    # Creates a list of strings like \"['[val1,val2]', '[val3,val4]']\"\n    result_strings = [f\"[{res[0]},{res[1]}]\" for res in results]\n    # Joins them with a comma and encloses in brackets for the final format \"[[val1,val2],[val3,val4]]\"\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}