{
    "hands_on_practices": [
        {
            "introduction": "This first practice connects the fundamental outputs of a Density Functional Theory (DFT) calculation to observable spectroscopic properties. You will use the harmonic oscillator model to convert a computed force constant, $k$, and dipole moment derivative, $\\frac{\\mathrm{d}\\mu}{\\mathrm{d}r}$, into a predicted infrared (IR) wavenumber and intensity. This exercise  reinforces the physical basis of vibrational spectroscopy and introduces the practical step of applying empirical scaling factors to improve agreement with experimental data.",
            "id": "3698598",
            "problem": "You are to implement a program that formalizes the Density Functional Theory (DFT) workflow for predicting the carbonyl stretching band of an aldehyde by combining the harmonic approximation and the double-harmonic infrared (IR) intensity model, and then comparing to experiment using a frequency scaling factor appropriate to a hybrid functional with a polarized basis set. Work entirely within a local-mode picture for the carbonyl group and assume the Born–Oppenheimer approximation and the harmonic approximation for nuclear motion. Use the diatomic reduced-mass model for the C=O local mode and treat the IR intensity via the derivative of the molecular dipole moment with respect to the mass-weighted normal coordinate along the C=O stretching direction. The scaling factor reflects the well-known systematic overestimation of harmonic frequencies by hybrid functionals with polarized basis sets. You must produce results in explicitly specified units and with specified rounding.\n\nInput parameters for each test case are:\n- A harmonic force constant $k$ along the C=O stretching coordinate in $\\mathrm{N\\ m^{-1}}$.\n- Atomic masses for carbon and oxygen, $m_{\\mathrm{C}}$ and $m_{\\mathrm{O}}$, each in atomic mass units (amu).\n- The derivative of the dipole moment with respect to the C=O bond length, $\\mathrm{d}\\mu/\\mathrm{d}r$, in Debye per Angstrom $\\left(\\mathrm{D\\ \\AA^{-1}}\\right)$.\n- A dimensionless frequency scaling factor $s$ appropriate to a hybrid functional and polarized basis.\n- An experimental C=O stretching wavenumber $\\tilde{\\nu}_{\\mathrm{exp}}$ in $\\mathrm{cm^{-1}}$.\n\nConstants you must use:\n- Atomic mass unit to kilogram: $1\\ \\mathrm{amu} = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$.\n- Speed of light: $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\ s^{-1}}$.\n- IR intensity conversion in the double-harmonic approximation: when $\\partial \\mu/\\partial Q$ is expressed in $\\mathrm{D\\ \\AA^{-1}\\ amu^{-1/2}}$, the integrated intensity in $\\mathrm{km\\ mol^{-1}}$ is $I = 42.255 \\left(\\partial \\mu/\\partial Q\\right)^{2}$.\n\nTasks for each test case:\n1. Using the harmonic oscillator relationship between the force constant and the reduced mass, compute the unscaled harmonic C=O stretching wavenumber in $\\mathrm{cm^{-1}}$. Then apply the scaling factor $s$ to obtain the scaled predicted wavenumber $\\tilde{\\nu}_{\\mathrm{scaled}}$ in $\\mathrm{cm^{-1}}$. Express the final wavenumber in $\\mathrm{cm^{-1}}$ rounded to three decimal places.\n2. Compute the absolute deviation $|\\tilde{\\nu}_{\\mathrm{scaled}} - \\tilde{\\nu}_{\\mathrm{exp}}|$ in $\\mathrm{cm^{-1}}$, rounded to three decimal places.\n3. Treating the local C=O stretching normal coordinate $Q$ as mass-weighted by the diatomic reduced mass in amu, compute $\\partial \\mu/\\partial Q$ from $\\mathrm{d}\\mu/\\mathrm{d}r$ and the reduced mass and then compute the IR intensity $I$ in $\\mathrm{km\\ mol^{-1}}$, rounded to three decimal places.\n\nAngle units are not applicable. All answers involving physical quantities must be expressed in the specified units. Your program must compute results for the following test suite (each tuple lists $(k,\\ m_{\\mathrm{C}},\\ m_{\\mathrm{O}},\\ \\mathrm{d}\\mu/\\mathrm{d}r,\\ s,\\ \\tilde{\\nu}_{\\mathrm{exp}})$):\n\n- Case A (formaldehyde, hybrid functional with polarized basis): $(1300.0, 12.000000, 15.999000, 7.0000, 0.9613, 1746.0)$\n- Case B ($^{13}$C-formaldehyde isotopologue, same electronic structure level): $(1300.0, 13.003355, 15.999000, 7.0000, 0.9613, 1710.0)$\n- Case C (acetaldehyde): $(1250.0, 12.000000, 15.999000, 7.5000, 0.9613, 1720.0)$\n- Case D (benzaldehyde): $(1200.0, 12.000000, 15.999000, 8.5000, 0.9613, 1700.0)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of three floats in the order $[\\tilde{\\nu}_{\\mathrm{scaled}},\\ |\\tilde{\\nu}_{\\mathrm{scaled}}-\\tilde{\\nu}_{\\mathrm{exp}}|,\\ I]$, each rounded to three decimal places. For example: \"[[x1,y1,z1],[x2,y2,z2],...]\".",
            "solution": "We frame the computation using the Born–Oppenheimer approximation, which permits separation of electronic and nuclear motions, and the harmonic approximation for nuclear motion near equilibrium. In the local-mode picture for the carbonyl group, we model the C=O stretching as a diatomic oscillator characterized by a force constant and a reduced mass. Infrared (IR) intensities in the double-harmonic approximation are determined by the derivative of the dipole moment with respect to the mass-weighted normal coordinate.\n\n1. Harmonic wavenumber from force constant and reduced mass.\nUnder the harmonic approximation, the classical equation of motion for a diatomic-like mode yields the angular frequency\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}},\n$$\nwhere $k$ is the force constant in $\\mathrm{N\\ m^{-1}}$ and $\\mu$ is the reduced mass in $\\mathrm{kg}$. The reduced mass for atoms of masses $m_{\\mathrm{C}}$ and $m_{\\mathrm{O}}$ is\n$$\n\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}.\n$$\nBecause the input masses are given in atomic mass units (amu), we first compute the reduced mass in amu:\n$$\n\\mu_{\\mathrm{amu}} = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}},\n$$\nand then convert to $\\mathrm{kg}$ via $1\\ \\mathrm{amu} = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$:\n$$\n\\mu = \\mu_{\\mathrm{amu}} \\times \\left(1.66053906660\\times 10^{-27}\\right)\\ \\mathrm{kg}.\n$$\nThe harmonic wavenumber in $\\mathrm{cm^{-1}}$ is obtained by dividing the linear frequency by the speed of light in $\\mathrm{cm\\ s^{-1}}$:\n$$\n\\tilde{\\nu}_{\\mathrm{harm}} = \\frac{\\omega}{2\\pi c} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}},\n$$\nwith $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\ s^{-1}}$. To correct for systematic overestimation by hybrid functionals with polarized basis sets (for example, B3LYP with a split-valence plus polarization basis), we apply the empirical scaling factor $s$ to obtain the predicted scaled wavenumber\n$$\n\\tilde{\\nu}_{\\mathrm{scaled}} = s\\ \\tilde{\\nu}_{\\mathrm{harm}}.\n$$\n\n2. Absolute deviation from experiment.\nGiven the experimental wavenumber $\\tilde{\\nu}_{\\mathrm{exp}}$ in $\\mathrm{cm^{-1}}$, the absolute deviation is\n$$\n\\Delta = \\left|\\tilde{\\nu}_{\\mathrm{scaled}} - \\tilde{\\nu}_{\\mathrm{exp}}\\right|.\n$$\n\n3. Infrared intensity in the double-harmonic approximation.\nIn the double-harmonic approximation, the integrated IR intensity for a normal mode is proportional to the square of the derivative of the dipole moment with respect to the mass-weighted normal coordinate $Q$. For a local diatomic mode, we can express the mass-weighted coordinate as\n$$\nQ = \\sqrt{\\mu_{\\mathrm{amu}}}\\ \\Delta r,\n$$\nwhere $\\Delta r$ is the bond-length displacement in $\\mathrm{\\AA}$ and $\\mu_{\\mathrm{amu}}$ is the reduced mass in amu (dimensionless in this context). Given the derivative of the dipole moment with respect to the bond length, $\\mathrm{d}\\mu/\\mathrm{d}r$ in $\\mathrm{D\\ \\AA^{-1}}$, we obtain\n$$\n\\frac{\\partial \\mu}{\\partial Q} = \\frac{1}{\\sqrt{\\mu_{\\mathrm{amu}}}}\\ \\frac{\\mathrm{d}\\mu}{\\mathrm{d}r},\n$$\nwith units $\\mathrm{D\\ \\AA^{-1}\\ amu^{-1/2}}$. The integrated molar absorption coefficient (intensity) in $\\mathrm{km\\ mol^{-1}}$ is then\n$$\nI = 42.255 \\left(\\frac{\\partial \\mu}{\\partial Q}\\right)^2,\n$$\nwhere the factor $42.255$ gathers the appropriate fundamental constants, unit conversions, and the factor from orientational averaging in the harmonic limit, consistent with expressing $\\partial \\mu/\\partial Q$ in $\\mathrm{D\\ \\AA^{-1}\\ amu^{-1/2}}$.\n\n4. Algorithmic steps.\nFor each test case:\n- Compute $\\mu_{\\mathrm{amu}} = \\dfrac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}$.\n- Convert to $\\mu$ in $\\mathrm{kg}$ by multiplying $\\mu_{\\mathrm{amu}}$ by $1.66053906660\\times 10^{-27}$.\n- Compute $\\tilde{\\nu}_{\\mathrm{harm}} = \\dfrac{1}{2\\pi c}\\sqrt{\\dfrac{k}{\\mu}}$ with $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\ s^{-1}}$.\n- Compute $\\tilde{\\nu}_{\\mathrm{scaled}} = s\\ \\tilde{\\nu}_{\\mathrm{harm}}$ and the absolute deviation $\\Delta = \\left|\\tilde{\\nu}_{\\mathrm{scaled}} - \\tilde{\\nu}_{\\mathrm{exp}}\\right|$.\n- Compute $\\partial \\mu/\\partial Q = \\left(\\mathrm{d}\\mu/\\mathrm{d}r\\right)/\\sqrt{\\mu_{\\mathrm{amu}}}$ and $I = 42.255\\left(\\partial \\mu/\\partial Q\\right)^2$.\n- Round $\\tilde{\\nu}_{\\mathrm{scaled}}$, $\\Delta$, and $I$ to three decimal places.\n\n5. Units and rounding.\n- Report $\\tilde{\\nu}_{\\mathrm{scaled}}$ and $\\Delta$ in $\\mathrm{cm^{-1}}$, each rounded to three decimal places.\n- Report $I$ in $\\mathrm{km\\ mol^{-1}}$, rounded to three decimal places.\n- Output format is a single line string encoding a list of lists: each inner list is $[\\tilde{\\nu}_{\\mathrm{scaled}},\\ \\Delta,\\ I]$ for a test case, in the same order as the provided test suite.\n\nThese steps connect the fundamental mechanical model (force, mass, and harmonic motion) to spectroscopic observables and incorporate the empirical correction typical for hybrid DFT with polarized basis sets.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_scaled_wavenumber_and_intensity(k_N_per_m, mC_amu, mO_amu, dmu_dr_D_per_A, scale_factor, nu_exp_cm1):\n    # Physical constants\n    amu_to_kg = 1.66053906660e-27  # kg per amu\n    c_cm_per_s = 2.99792458e10     # speed of light in cm/s\n    two_pi = 2.0 * np.pi\n\n    # Reduced mass in amu and kg\n    mu_amu = (mC_amu * mO_amu) / (mC_amu + mO_amu)\n    mu_kg = mu_amu * amu_to_kg\n\n    # Harmonic angular frequency (rad/s) and wavenumber (cm^-1)\n    omega = np.sqrt(k_N_per_m / mu_kg)\n    nu_harm_cm1 = omega / (two_pi * c_cm_per_s)\n\n    # Apply scaling factor\n    nu_scaled_cm1 = scale_factor * nu_harm_cm1\n\n    # Absolute deviation from experiment\n    deviation_cm1 = abs(nu_scaled_cm1 - nu_exp_cm1)\n\n    # IR intensity in km/mol using double-harmonic approximation\n    # Convert derivative to mass-weighted coordinate derivative\n    dmu_dQ = dmu_dr_D_per_A / np.sqrt(mu_amu)  # D / (A * sqrt(amu))\n    intensity_km_per_mol = 42.255 * (dmu_dQ ** 2)\n\n    return nu_scaled_cm1, deviation_cm1, intensity_km_per_mol\n\ndef format_results(results, decimals=3):\n    # Format nested list with fixed decimals\n    formatted_cases = []\n    fmt = f\"{{:.{decimals}f}}\"\n    for triple in results:\n        a, b, c = triple\n        formatted_cases.append(f\"[{fmt.format(a)},{fmt.format(b)},{fmt.format(c)}]\")\n    return \"[\" + \",\".join(formatted_cases) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (k [N/m], mC [amu], mO [amu], dmu/dr [D/Å], s [dimensionless], nu_exp [cm^-1])\n    test_cases = [\n        (1300.0, 12.000000, 15.999000, 7.0000, 0.9613, 1746.0),     # Case A: formaldehyde\n        (1300.0, 13.003355, 15.999000, 7.0000, 0.9613, 1710.0),     # Case B: 13C-formaldehyde\n        (1250.0, 12.000000, 15.999000, 7.5000, 0.9613, 1720.0),     # Case C: acetaldehyde\n        (1200.0, 12.000000, 15.999000, 8.5000, 0.9613, 1700.0),     # Case D: benzaldehyde\n    ]\n\n    results = []\n    for case in test_cases:\n        k, mC, mO, dmu_dr, s, nu_exp = case\n        nu_scaled, deviation, intensity = compute_scaled_wavenumber_and_intensity(\n            k, mC, mO, dmu_dr, s, nu_exp\n        )\n        results.append((nu_scaled, deviation, intensity))\n\n    # Final print statement in the exact required format.\n    print(format_results(results, decimals=3))\n\nsolve()\n```"
        },
        {
            "introduction": "After seeing the need for scaling factors, we now investigate a primary source of systematic error: the choice of the exchange-correlation functional. This exercise  employs a mathematical model to illustrate how incorporating a fraction of exact exchange, $\\alpha$, into hybrid functionals mitigates the overbinding tendency of simpler generalized gradient approximation (GGA) functionals. By calculating frequencies for functionals like PBE ($\\alpha=0.00$), B3LYP ($\\alpha=0.20$), and PBE0 ($\\alpha=0.25$), you will gain a quantitative understanding of why hybrid functionals often provide more accurate vibrational predictions.",
            "id": "3698588",
            "problem": "You are tasked with designing and implementing a program that models infrared (IR) carbonyl stretching frequency predictions for different Density Functional Theory (DFT) exchange-correlation approximations by starting from physically grounded principles. Use the Born–Oppenheimer approximation and the harmonic approximation near the minimum of the potential energy surface as your fundamental base, and work from the definition of the force constant as the curvature of the potential energy with respect to bond displacement and the relationship between vibrational frequency and reduced mass. Your objective is to construct a quantitative model that captures the systematic overbinding due to self-interaction error and its mitigation by a fraction of exact exchange in hybrid functionals. The program must compute and compare IR wavenumbers (in $\\mathrm{cm}^{-1}$) for a carbonyl group under the following functionals: Perdew–Burke–Ernzerhof (PBE), Becke, $3$-parameter, Lee–Yang–Parr (B3LYP), and PBE0, and additionally report values for two boundary cases to test model behavior.\n\nModeling directives and constants to be used:\n- Assume a single carbonyl bond treated as a diatomic oscillator with carbon mass $12$ atomic mass units (atomic mass unit (amu)) and oxygen mass $16$ atomic mass units.\n- Use the atomic mass unit $1\\,\\mathrm{amu} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$.\n- Use the speed of light $c = 2.99792458\\times 10^{10}\\,\\mathrm{cm/s}$.\n- Take the reference (target, self-interaction-error free) carbonyl wavenumber to be $\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$, representative of a typical organic carbonyl stretch in the absence of systematic overbinding.\n- Define the reduced mass $\\mu$ for carbon and oxygen, and relate the predicted harmonic wavenumber $\\tilde{\\nu}$ to the force constant curvature $k$ and $\\mu$ by appropriate derivation from these bases.\n- Model the effect of the exact exchange fraction $\\alpha$ on the curvature through a monotone-decaying bias term that represents residual overbinding when $\\alpha = 0$ and diminishes as $\\alpha$ increases. Use the following form for the curvature model:\n  - $k(\\alpha) = k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)\\right]$,\n  where $k_{\\mathrm{ref}}$ is the curvature consistent with $\\tilde{\\nu}_{\\mathrm{ref}}$, $\\delta_{0} = 0.12$ is the zero-exact-exchange fractional overbinding magnitude, and $\\alpha_{0} = 0.10$ characterizes the decay with increasing exact exchange.\n- Compute the predicted IR wavenumbers in $\\mathrm{cm}^{-1}$ for the following test suite of exact exchange fractions $\\alpha$:\n  - PBE: $\\alpha = 0.00$\n  - B3LYP: $\\alpha = 0.20$\n  - PBE0: $\\alpha = 0.25$\n  - Boundary case (higher hybrid content): $\\alpha = 0.50$\n  - Boundary case (Hartree–Fock-like limit): $\\alpha = 1.00$\n- Express all final wavenumber results in $\\mathrm{cm}^{-1}$, rounded to one decimal place.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3},\\dots]$). The list must contain the five wavenumbers computed for the test suite in the exact order specified above. No other text should be printed.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and internally consistent. All necessary physical constants, model parameters, and theoretical frameworks are provided to construct a unique, verifiable solution. The underlying model is a physically motivated, albeit phenomenological, representation of the effect of self-interaction error in density functional theory (DFT) on vibrational frequencies, a standard topic in computational chemistry. Therefore, the problem is valid, and a solution can be formulated.\n\nThe objective is to compute the predicted infrared (IR) stretching wavenumber, $\\tilde{\\nu}$, for a carbonyl group, modeled as a diatomic harmonic oscillator, under different DFT exchange-correlation functionals. The effect of each functional is parameterized by its fraction of exact exchange, $\\alpha$.\n\nThe analysis begins with the fundamental relationship for a harmonic oscillator. The angular frequency, $\\omega$, is related to the force constant, $k$ (the curvature of the potential energy surface), and the reduced mass, $\\mu$, by:\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\nThe vibrational frequency, $\\nu$, is $\\nu = \\omega / (2\\pi)$. In spectroscopy, it is conventional to use wavenumber, $\\tilde{\\nu}$, which is defined as $\\tilde{\\nu} = \\nu/c$, where $c$ is the speed of light. Combining these definitions yields the central equation for vibrational wavenumber:\n$$\n\\tilde{\\nu} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}}\n$$\nThe problem models a carbonyl group, C=O, as a diatomic system. The masses are given as $m_C = 12\\,\\mathrm{amu}$ and $m_O = 16\\,\\mathrm{amu}$. The reduced mass $\\mu$ is calculated as:\n$$\n\\mu = \\frac{m_C m_O}{m_C + m_O} = \\frac{(12\\,\\mathrm{amu})(16\\,\\mathrm{amu})}{12\\,\\mathrm{amu} + 16\\,\\mathrm{amu}} = \\frac{192}{28}\\,\\mathrm{amu} = \\frac{48}{7}\\,\\mathrm{amu}\n$$\nAlthough the constant for converting atomic mass units to kilograms is provided ($1\\,\\mathrm{amu} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$), we can devise a more elegant solution by first determining the reference force constant, $k_{\\mathrm{ref}}$, corresponding to the specified reference wavenumber, $\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$. This reference value represents the ideal, self-interaction-error-free result.\n\nRearranging the wavenumber equation, we can express the force constant $k$ in terms of $\\tilde{\\nu}$, $c$, and $\\mu$:\n$$\nk = (2\\pi c \\tilde{\\nu})^2 \\mu\n$$\nThus, the reference force constant is:\n$$\nk_{\\mathrm{ref}} = (2\\pi c \\tilde{\\nu}_{\\mathrm{ref}})^2 \\mu\n$$\nThe problem posits a model for the predicted force constant, $k(\\alpha)$, as a function of the exact exchange fraction $\\alpha$. This model captures the systematic overbinding (larger force constant) associated with pure generalized gradient approximation (GGA) functionals (where $\\alpha=0$) and its reduction as exact exchange is mixed in:\n$$\nk(\\alpha) = k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)\\right]\n$$\nHere, $\\delta_{0} = 0.12$ represents the fractional overestimation of the force constant at $\\alpha=0$, and $\\alpha_{0} = 0.10$ is a decay constant characterizing how quickly this overestimation is corrected with increasing $\\alpha$.\n\nThe predicted wavenumber, $\\tilde{\\nu}(\\alpha)$, can now be written by substituting this expression for $k(\\alpha)$ into the fundamental wavenumber equation:\n$$\n\\tilde{\\nu}(\\alpha) = \\frac{1}{2\\pi c}\\sqrt{\\frac{k(\\alpha)}{\\mu}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)\\right]}{\\mu}}\n$$\nWe can factor this expression as:\n$$\n\\tilde{\\nu}(\\alpha) = \\left(\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\\right) \\sqrt{1 + \\delta_{0}\\exp\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)}\n$$\nThe term in the parenthesis is, by definition, the reference wavenumber $\\tilde{\\nu}_{\\mathrm{ref}}$. This leads to a simplified and computationally direct final expression that elegantly bypasses the need to explicitly calculate $\\mu$ in kilograms or $k_{\\mathrm{ref}}$ in SI units:\n$$\n\\tilde{\\nu}(\\alpha) = \\tilde{\\nu}_{\\mathrm{ref}} \\sqrt{1 + \\delta_{0}\\exp\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)}\n$$\nUsing the provided values $\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$, $\\delta_{0} = 0.12$, and $\\alpha_{0} = 0.10$, we can compute the wavenumbers for the specified test suite of $\\alpha$ values.\n\nThe test suite is:\n1.  PBE: $\\alpha = 0.00$\n    $$\n    \\tilde{\\nu}(0.00) = 1715 \\sqrt{1 + 0.12 \\exp(0)} = 1715 \\sqrt{1.12} \\approx 1815.018\\,\\mathrm{cm}^{-1}\n    $$\n2.  B3LYP: $\\alpha = 0.20$\n    $$\n    \\tilde{\\nu}(0.20) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.20}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-2}} \\approx 1728.828\\,\\mathrm{cm}^{-1}\n    $$\n3.  PBE0: $\\alpha = 0.25$\n    $$\n    \\tilde{\\nu}(0.25) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.25}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-2.5}} \\approx 1723.411\\,\\mathrm{cm}^{-1}\n    $$\n4.  Boundary Case (higher hybrid): $\\alpha = 0.50$\n    $$\n    \\tilde{\\nu}(0.50) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.50}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-5}} \\approx 1715.693\\,\\mathrm{cm}^{-1}\n    $$\n5.  Boundary Case (Hartree-Fock-like limit): $\\alpha = 1.00$\n    $$\n    \\tilde{\\nu}(1.00) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{1.00}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-10}} \\approx 1715.005\\,\\mathrm{cm}^{-1}\n    $$\nThese results must be rounded to one decimal place for the final output. This procedure is implemented in the following program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes predicted IR wavenumbers for a carbonyl group based on a model\n    of DFT self-interaction error as a function of exact exchange fraction.\n    \"\"\"\n    \n    # Define model parameters and the reference value from the problem statement.\n    nu_ref_cm_inv = 1715.0  # Reference wavenumber in cm^-1\n    delta_0 = 0.12          # Zero-exchange fractional overbinding magnitude\n    alpha_0 = 0.10          # Decay constant for exact exchange correction\n\n    # Define the test suite of exact exchange fractions (alpha)\n    # The order corresponds to PBE, B3LYP, PBE0, high-hybrid, HF-limit.\n    alpha_values = [\n        0.00,  # PBE\n        0.20,  # B3LYP\n        0.25,  # PBE0\n        0.50,  # Boundary case 1\n        1.00   # Boundary case 2\n    ]\n\n    results = []\n    \n    # The core model equation relates the predicted wavenumber to the reference\n    # wavenumber and the fraction of exact exchange, alpha.\n    # nu_pred(alpha) = nu_ref * sqrt(1 + delta_0 * exp(-alpha / alpha_0))\n    for alpha in alpha_values:\n        # Calculate the argument of the square root\n        correction_term = delta_0 * np.exp(-alpha / alpha_0)\n        \n        # Calculate the predicted wavenumber\n        nu_pred = nu_ref_cm_inv * np.sqrt(1 + correction_term)\n        \n        # Round the result to one decimal place as required\n        rounded_result = round(nu_pred, 1)\n        results.append(rounded_result)\n\n    # Format the final output as a comma-separated list in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "Alongside the functional, the basis set is the second critical choice that determines the accuracy of a DFT prediction. This practice  uses a perturbation model to explore how basis set incompleteness affects both vibrational frequencies and IR intensities. You will discover how errors in the force constant, modeled by a perturbation $\\delta_k$, primarily impact the frequency, while errors in the dipole derivative, modeled by $\\delta_d$, govern the intensity, providing a clearer picture of error sources in spectral calculations.",
            "id": "3698611",
            "problem": "You must write a complete program that, within the harmonic approximation, compares predicted carbon monoxide stretching frequencies and infrared intensities using two different orbital basis sets and quantitatively attributes the dominant sources of basis-set-related error in a density functional theory (DFT) vibrational analysis. The program must implement the model below, compute the requested quantities for a provided test suite, and produce the final results in the specified single-line format.\n\nUse the following fundamental base and core definitions.\n\n1) Born–Oppenheimer separation and the harmonic approximation: Near the equilibrium bond length, the potential energy for a diatomic molecule is approximated as quadratic in the bond displacement coordinate. The Hessian (second derivative of the potential with respect to the bond length) evaluated at the equilibrium geometry is the force constant. Under the harmonic approximation, the vibrational angular frequency is given by\n$$\\omega = \\sqrt{\\frac{k}{\\mu}},$$\nwhere $k$ is the harmonic force constant and $\\mu$ is the reduced mass.\n\n2) Wavenumber conversion: The observable harmonic wavenumber in reciprocal centimeters is\n$$\\tilde{\\nu} = \\frac{\\omega}{2\\pi c} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}},$$\nwhere $c$ is the speed of light in $\\mathrm{cm\\,s^{-1}}$. All wavenumbers must be expressed in $\\mathrm{cm^{-1}}$.\n\n3) Infrared (IR) intensity under the double-harmonic approximation: The integrated intensity of a fundamental vibrational transition is proportional to the square of the derivative of the permanent dipole moment with respect to the normal coordinate. For a diatomic molecule with a single normal mode, the mass-weighted normal coordinate $Q$ is related to the bond length $r$ by $Q=\\sqrt{\\mu}\\,\\Delta r$ (up to an unimportant phase). Thus,\n$$\\left(\\frac{\\partial \\mu}{\\partial Q}\\right) = \\frac{1}{\\sqrt{\\mu}}\\left(\\frac{\\partial \\mu}{\\partial r}\\right),$$\nand therefore, under fixed $\\mu$, any basis-set error in the IR intensity arises from the error in $\\partial\\mu/\\partial r$. To eliminate unit dependencies and ensure a unitless target, define the normalized IR intensity as the ratio\n$$I_{\\mathrm{rel}} = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{pred}}}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2,$$\nwhich is dimensionless.\n\n4) Basis-set error model: Represent basis-set incompleteness errors as relative perturbations to the force constant and to the dipole moment derivative about a fixed, high-level reference:\n$$k_{\\mathrm{pred}} = k_{\\mathrm{ref}}\\left(1 + \\delta_k\\right),\\qquad \\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{pred}} = \\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{ref}}\\left(1 + \\delta_d\\right),$$\nwhere $\\delta_k$ and $\\delta_d$ are dimensionless relative errors associated with the chosen basis set.\n\nConstants and reference values to be used in all computations:\n\n- Atomic mass unit: $u = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$.\n- Atomic masses: $m_{\\mathrm{C}} = 12.000000\\ u$, $m_{\\mathrm{O}} = 15.99491461957\\ u$.\n- Reduced mass: $\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}$ in $\\mathrm{kg}$.\n- Speed of light: $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$.\n- Reference CO harmonic wavenumber: $\\tilde{\\nu}_{\\mathrm{ref}} = 2143.27\\ \\mathrm{cm^{-1}}$.\n- Reference force constant defined implicitly by the wavenumber and reduced mass:\n$$k_{\\mathrm{ref}} = \\mu \\left(2\\pi c \\tilde{\\nu}_{\\mathrm{ref}}\\right)^2\\ \\mathrm{N\\,m^{-1}}.$$\n- Reference dipole derivative (for completeness of the model, cancels out in the normalized intensity): $\\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{ref}} = 0.20$ in consistent arbitrary units; only ratios are used.\n\nFor a given pair $\\left(\\delta_k,\\delta_d\\right)$, compute:\n- The predicted harmonic wavenumber in reciprocal centimeters,\n$$\\tilde{\\nu}_{\\mathrm{pred}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}},$$\nrounded to two decimal places and expressed in $\\mathrm{cm^{-1}}$.\n- The normalized IR intensity $I_{\\mathrm{rel}}=\\left(1+\\delta_d\\right)^2$, rounded to five decimal places (dimensionless).\n- The absolute wavenumber error $|\\tilde{\\nu}_{\\mathrm{pred}} - \\tilde{\\nu}_{\\mathrm{ref}}|$ in $\\mathrm{cm^{-1}}$, rounded to two decimal places.\n- The absolute normalized intensity deviation $|I_{\\mathrm{rel}}-1|$ (dimensionless), rounded to five decimal places.\n\nTo identify the dominant source of basis-set-related error for each observable, decompose the total error into contributions from perturbing each primary quantity separately:\n- Frequency sensitivity: compute the wavenumber with only $k$ perturbed, $\\tilde{\\nu}_{k\\text{-only}}=\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}}$, and with only $\\partial\\mu/\\partial r$ perturbed, $\\tilde{\\nu}_{d\\text{-only}}=\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}=\\tilde{\\nu}_{\\mathrm{ref}}$. Define contributions $\\Delta\\tilde{\\nu}_{k}=|\\tilde{\\nu}_{k\\text{-only}}-\\tilde{\\nu}_{\\mathrm{ref}}|$ and $\\Delta\\tilde{\\nu}_{d}=|\\tilde{\\nu}_{d\\text{-only}}-\\tilde{\\nu}_{\\mathrm{ref}}|$, and set a boolean flag for whether the force-constant contribution is dominant: $\\mathrm{isKdom} = \\Delta\\tilde{\\nu}_{k} \\ge \\Delta\\tilde{\\nu}_{d}$.\n- Intensity sensitivity: compute $I_{\\mathrm{rel},k\\text{-only}}=1$ and $I_{\\mathrm{rel},d\\text{-only}}=\\left(1+\\delta_d\\right)^2$, then define $\\Delta I_k=|I_{\\mathrm{rel},k\\text{-only}}-1|$ and $\\Delta I_d=|I_{\\mathrm{rel},d\\text{-only}}-1|$, and set a boolean flag for whether the dipole-derivative contribution is dominant: $\\mathrm{isDdom} = \\Delta I_d \\ge \\Delta I_k$.\n\nTest suite. Evaluate the following five cases:\n- Case 1 (6-31G(d)): $\\delta_k=-0.05$, $\\delta_d=-0.10$.\n- Case 2 (correlation-consistent polarized valence triple-zeta, cc-pVTZ): $\\delta_k=-0.01$, $\\delta_d=-0.03$.\n- Case 3 (ideal/no error): $\\delta_k=0.00$, $\\delta_d=0.00$.\n- Case 4 (force-constant-only error): $\\delta_k=+0.02$, $\\delta_d=0.00$.\n- Case 5 (dipole-derivative-only error): $\\delta_k=0.00$, $\\delta_d=+0.15$.\n\nAdditionally, report a quantitative comparison between the two basis sets in Cases 1 and 2 by providing the ratios of absolute errors:\n- The ratio of absolute wavenumber errors, $R_{\\nu} = \\frac{|\\tilde{\\nu}_{\\mathrm{pred}}^{(1)} - \\tilde{\\nu}_{\\mathrm{ref}}|}{|\\tilde{\\nu}_{\\mathrm{pred}}^{(2)} - \\tilde{\\nu}_{\\mathrm{ref}}|}$, rounded to five decimal places.\n- The ratio of absolute normalized intensity deviations, $R_{I} = \\frac{|I_{\\mathrm{rel}}^{(1)}-1|}{|I_{\\mathrm{rel}}^{(2)}-1|}$, rounded to five decimal places.\n\nFinal output format. Your program should produce a single line of output containing a list whose elements are, in order, the five per-case results followed by the two-element comparison list. Each per-case result must itself be a list of six entries in the order:\n[$\\tilde{\\nu}_{\\mathrm{pred}}$ in $\\mathrm{cm^{-1}}$ (rounded to two decimals), $I_{\\mathrm{rel}}$ (rounded to five decimals), $|\\tilde{\\nu}_{\\mathrm{pred}}-\\tilde{\\nu}_{\\mathrm{ref}}|$ in $\\mathrm{cm^{-1}}$ (rounded to two decimals), $|I_{\\mathrm{rel}}-1|$ (rounded to five decimals), $\\mathrm{isKdom}$ (boolean), $\\mathrm{isDdom}$ (boolean)].\n\nConcretely, the printed line should look like a valid comma-separated list with nested square brackets, for example:\n[[nu1,I1,dnu1,dI1,True,True],[nu2,I2,dnu2,dI2,True,True],...,[Rnu,RI]]\n\nAll wavenumbers must be in $\\mathrm{cm^{-1}}$ rounded to two decimal places. All normalized intensities and ratios must be dimensionless decimals rounded to five decimal places. Angles are not used. Percentages must be expressed as decimals (e.g., 0.10 for ten percent). No additional text should be printed.",
            "solution": "The user has provided a well-defined computational problem grounded in the principles of theoretical spectroscopy. The problem is scientifically sound, self-contained, and calls for the implementation of a clear physical model. All necessary constants, reference values, and analytical expressions are provided. The objectives are unambiguous, and a unique, verifiable solution can be computed. The problem is therefore deemed valid.\n\nThe solution proceeds by first establishing the necessary physical constants and derived reference values. Subsequently, for each specified case of basis-set error parameters $(\\delta_k, \\delta_d)$, a series of quantities are computed: the predicted vibrational wavenumber, the normalized infrared intensity, their respective deviations from reference values, and flags indicating the dominant source of error for each observable. Finally, a quantitative comparison of errors between two specific basis sets is performed.\n\nFirst, we define the physical constants and reference values.\nThe atomic mass unit is $u = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$.\nThe atomic masses are $m_{\\mathrm{C}} = 12.000000\\ u$ and $m_{\\mathrm{O}} = 15.99491461957\\ u$.\nThe reduced mass $\\mu$ of the carbon monoxide molecule is calculated as:\n$$\n\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}} = \\frac{(12.000000)(15.99491461957)}{12.000000 + 15.99491461957} u \\approx 6.856209\\ u\n$$\nConverting to SI units, $\\mu \\approx 1.138500 \\times 10^{-26}\\ \\mathrm{kg}$.\nThe speed of light is $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$.\nThe reference harmonic wavenumber is $\\tilde{\\nu}_{\\mathrm{ref}} = 2143.27\\ \\mathrm{cm^{-1}}$.\n\nThe reference force constant $k_{\\mathrm{ref}}$ is implicitly defined by the harmonic oscillator model:\n$$\n\\tilde{\\nu}_{\\mathrm{ref}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\n$$\nSolving for $k_{\\mathrm{ref}}$ yields $k_{\\mathrm{ref}} = \\mu (2\\pi c \\tilde{\\nu}_{\\mathrm{ref}})^2$. While this value could be computed numerically, it is more elegant and precise to work with ratios, as will be shown.\n\nThe core of the problem lies in evaluating the effect of relative errors, $\\delta_k$ and $\\delta_d$, on the predicted observables. The predicted force constant is $k_{\\mathrm{pred}} = k_{\\mathrm{ref}}(1 + \\delta_k)$.\n\nThe predicted harmonic wavenumber, $\\tilde{\\nu}_{\\mathrm{pred}}$, is given by:\n$$\n\\tilde{\\nu}_{\\mathrm{pred}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{pred}}}{\\mu}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}}\n$$\nBy substituting the expression for $\\tilde{\\nu}_{\\mathrm{ref}}$, this simplifies to:\n$$\n\\tilde{\\nu}_{\\mathrm{pred}} = \\left(\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\\right) \\sqrt{1+\\delta_k} = \\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k}\n$$\nThis simplified form avoids explicit calculation of $k_{\\mathrm{ref}}$ and $\\mu$, reducing the risk of floating-point precision loss.\n\nThe predicted normalized IR intensity, $I_{\\mathrm{rel}}$, depends on the relative error in the dipole moment derivative, $\\delta_d$:\n$$\nI_{\\mathrm{rel}} = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{pred}}}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2 = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}(1+\\delta_d)}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2 = (1+\\delta_d)^2\n$$\n\nFor each case, we must compute four primary quantities:\n$1$. The predicted wavenumber $\\tilde{\\nu}_{\\mathrm{pred}}$, rounded to two decimal places.\n$2$. The normalized IR intensity $I_{\\mathrm{rel}}$, rounded to five decimal places.\n$3$. The absolute wavenumber error $|\\tilde{\\nu}_{\\mathrm{pred}} - \\tilde{\\nu}_{\\mathrm{ref}}|$, rounded to two decimal places.\n$4$. The absolute normalized intensity deviation $|I_{\\mathrm{rel}}-1|$, rounded to five decimal places.\n\nNext, we address the sensitivity analysis. The goal is to determine whether the error in the force constant ($k$) or the dipole derivative ($d$) is the dominant source of error for each observable.\n\nFor the wavenumber, the error contributions are defined as:\n$\\Delta\\tilde{\\nu}_{k} = |\\tilde{\\nu}_{k\\text{-only}} - \\tilde{\\nu}_{\\mathrm{ref}}|$, where $\\tilde{\\nu}_{k\\text{-only}} = \\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k}$.\n$\\Delta\\tilde{\\nu}_{d} = |\\tilde{\\nu}_{d\\text{-only}} - \\tilde{\\nu}_{\\mathrm{ref}}|$, where $\\tilde{\\nu}_{d\\text{-only}} = \\tilde{\\nu}_{\\mathrm{ref}}$.\nThus, $\\Delta\\tilde{\\nu}_{k} = |\\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k} - \\tilde{\\nu}_{\\mathrm{ref}}|$ and $\\Delta\\tilde{\\nu}_{d} = 0$.\nThe boolean flag is $\\mathrm{isKdom} = (\\Delta\\tilde{\\nu}_{k} \\ge \\Delta\\tilde{\\nu}_{d})$. Since $\\Delta\\tilde{\\nu}_{k}$ is an absolute value and thus always non-negative, and $\\Delta\\tilde{\\nu}_{d}$ is always $0$, this condition is always true. This correctly reflects that, in this decoupled model, only the force constant affects the frequency.\n\nFor the normalized intensity, the error contributions are:\n$\\Delta I_k = |I_{\\mathrm{rel},k\\text{-only}}-1|$, where $I_{\\mathrm{rel},k\\text{-only}} = (1+0)^2=1$.\n$\\Delta I_d = |I_{\\mathrm{rel},d\\text{-only}}-1|$, where $I_{\\mathrm{rel},d\\text{-only}} = (1+\\delta_d)^2$.\nThus, $\\Delta I_k = 0$ and $\\Delta I_d = |(1+\\delta_d)^2 - 1|$.\nThe boolean flag is $\\mathrm{isDdom} = (\\Delta I_d \\ge \\Delta I_k)$. Since $\\Delta I_d$ is an absolute value and thus always non-negative, and $\\Delta I_k$ is always $0$, this condition is also always true. This correctly reflects that only the dipole derivative affects the IR intensity in this model.\n\nFinally, we compute the ratios of absolute errors for Case $1$ $(\\delta_k^{(1)}, \\delta_d^{(1)})$ versus Case $2$ $(\\delta_k^{(2)}, \\delta_d^{(2)})$.\nThe ratio of absolute wavenumber errors is:\n$$\nR_{\\nu} = \\frac{|\\tilde{\\nu}_{\\mathrm{pred}}^{(1)} - \\tilde{\\nu}_{\\mathrm{ref}}|}{|\\tilde{\\nu}_{\\mathrm{pred}}^{(2)} - \\tilde{\\nu}_{\\mathrm{ref}}|} = \\frac{\\tilde{\\nu}_{\\mathrm{ref}}|\\sqrt{1+\\delta_k^{(1)}} - 1|}{\\tilde{\\nu}_{\\mathrm{ref}}|\\sqrt{1+\\delta_k^{(2)}} - 1|} = \\frac{|\\sqrt{1+\\delta_k^{(1)}} - 1|}{|\\sqrt{1+\\delta_k^{(2)}} - 1|}\n$$\nThe ratio of absolute normalized intensity deviations is:\n$$\nR_{I} = \\frac{|I_{\\mathrm{rel}}^{(1)}-1|}{|I_{\\mathrm{rel}}^{(2)}-1|} = \\frac{|(1+\\delta_d^{(1)})^2-1|}{|(1+\\delta_d^{(2)})^2-1|}\n$$\nThese ratios are to be rounded to five decimal places.\n\nThe program will execute these calculations for the five test cases, collect the six specified results for each case, calculate the two final ratio metrics, and format all results into a single output line as per the problem specification.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes predicted spectroscopic properties and error contributions for CO\n    based on a DFT error model.\n    \"\"\"\n    \n    # Define constants and reference values from the problem statement.\n    NU_REF_CM = 2143.27  # Reference wavenumber in cm^-1\n\n    # Define the test suite. Each tuple is (delta_k, delta_d).\n    test_cases = [\n        (-0.05, -0.10),   # Case 1: 6-31G(d)\n        (-0.01, -0.03),   # Case 2: cc-pVTZ\n        (0.00, 0.00),     # Case 3: Ideal/no error\n        (0.02, 0.00),     # Case 4: Force-constant-only error\n        (0.00, 0.15),     # Case 5: Dipole-derivative-only error\n    ]\n\n    all_case_results = []\n    case_abs_errors = []\n\n    for delta_k, delta_d in test_cases:\n        # --- Core Calculations ---\n        # The predicted wavenumber simplifies to nu_ref * sqrt(1 + delta_k).\n        nu_pred = NU_REF_CM * np.sqrt(1 + delta_k)\n        \n        # The normalized IR intensity.\n        i_rel = (1 + delta_d)**2\n        \n        # --- Error and Deviation Calculations ---\n        # Absolute wavenumber error.\n        d_nu = abs(nu_pred - NU_REF_CM)\n        \n        # Absolute normalized intensity deviation.\n        d_i = abs(i_rel - 1)\n        \n        # Store unrounded absolute errors for Cases 1 and 2 for the final ratio calculation.\n        case_abs_errors.append((d_nu, d_i))\n\n        # --- Sensitivity Analysis ---\n        # Wavenumber sensitivity.\n        # As derived, a change in dipole derivative (d) does not affect the wavenumber.\n        delta_nu_k = abs(NU_REF_CM * np.sqrt(1 + delta_k) - NU_REF_CM)\n        delta_nu_d = 0.0\n        is_k_dom = delta_nu_k >= delta_nu_d # Will always be True\n\n        # Intensity sensitivity.\n        # As derived, a change in force constant (k) does not affect the normalized intensity.\n        delta_i_k = 0.0\n        delta_i_d = abs((1 + delta_d)**2 - 1)\n        is_d_dom = delta_i_d >= delta_i_k # Will always be True\n\n        # --- Rounding for Output ---\n        nu_pred_rounded = round(nu_pred, 2)\n        i_rel_rounded = round(i_rel, 5)\n        d_nu_rounded = round(d_nu, 2)\n        d_i_rounded = round(d_i, 5)\n\n        # Collect results for the current case.\n        case_result = [\n            nu_pred_rounded, \n            i_rel_rounded, \n            d_nu_rounded, \n            d_i_rounded, \n            is_k_dom, \n            is_d_dom\n        ]\n        all_case_results.append(case_result)\n        \n    # --- Quantitative Comparison (Case 1 vs Case 2) ---\n    # Retrieve the unrounded absolute errors for Case 1 and Case 2.\n    d_nu1, d_i1 = case_abs_errors[0]\n    d_nu2, d_i2 = case_abs_errors[1]\n    \n    # Calculate ratios. Denominators are non-zero for Case 2.\n    r_nu = d_nu1 / d_nu2\n    r_i = d_i1 / d_i2\n    \n    # Round ratios and form the comparison list.\n    comparison_results = [round(r_nu, 5), round(r_i, 5)]\n\n    # --- Final Output Formatting ---\n    # Construct the final list containing all case results and the comparison.\n    final_list = all_case_results + [comparison_results]\n\n    # Convert each sublist to a string and remove spaces for compactness.\n    list_strs = [str(item).replace(\" \", \"\") for item in final_list]\n    \n    # Join the string representations of the lists with commas and enclose in brackets.\n    # The final element (comparison list) must be added after the case results.\n    # The f-string joins the first 5 elements and then appends the 6th.\n    case_strs = ','.join(list_strs[:-1])\n    comp_str = list_strs[-1]\n    final_output_string = f\"[{case_strs},{comp_str}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}