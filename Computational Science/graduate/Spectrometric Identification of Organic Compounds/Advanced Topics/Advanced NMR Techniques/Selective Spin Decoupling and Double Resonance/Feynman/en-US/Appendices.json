{
    "hands_on_practices": [
        {
            "introduction": "To master spin decoupling, we must first understand the spin-spin coupling we aim to remove. This foundational exercise guides you through a first-principles derivation of the energy levels in a simple two-spin system. By solving the spin Hamiltonian, you will see exactly why a single resonance is split into a doublet by a coupled partner, revealing the underlying quantum mechanical structure that decoupling techniques are designed to manipulate .",
            "id": "3723362",
            "problem": "Consider an isolated two-spin, spin-$\\frac{1}{2}$ AX system in Nuclear Magnetic Resonance (NMR), with spins labeled $I$ and $S$ corresponding to two distinct nuclei in an organic molecule under a static magnetic field $B_0$ along the $z$-axis. Assume weak coupling, meaning $|\\omega_{I} - \\omega_{S}| \\gg 2\\pi J$, where $\\omega_{I}$ and $\\omega_{S}$ are the unperturbed Larmor angular frequencies of spins $I$ and $S$, respectively, and $J$ is the isotropic scalar coupling constant reported in Hertz (s$^{-1}$). The isotropic spin-spin coupling is present and the secular approximation is valid at high field.\n\nStarting from first principles and using the appropriate spin Hamiltonian for this system, derive the energy levels of the four product states $|m_{I}, m_{S}\\rangle$ with $m_{I}, m_{S} \\in \\{+\\frac{1}{2}, -\\frac{1}{2}\\}$, then determine the two allowed transition angular frequencies for spin $I$ subject to the magnetic dipole selection rules and the weak coupling assumption. Express your final result for these two angular frequencies symbolically in terms of $\\omega_{I}$ and $J$.\n\nYour answer must be a single analytic expression containing the two angular frequencies as a row matrix. Express the angular frequencies in radians per second. Do not substitute numerical values. No rounding is required.",
            "solution": "We begin by establishing the spin Hamiltonian for the isolated two-spin, spin-$\\frac{1}{2}$ AX system. The system consists of two spins, labeled $I$ and $S$, in a static magnetic field $\\vec{B_0} = B_0 \\hat{k}$ along the $z$-axis. The total Hamiltonian $\\hat{H}$ is the sum of the Zeeman interaction term $\\hat{H}_Z$ and the scalar coupling term $\\hat{H}_J$.\n\nThe Zeeman Hamiltonian describes the interaction of the spins with the external magnetic field. The Larmor angular frequency is fundamentally defined as $\\omega = -\\gamma B_0$. However, in NMR it is conventional to work with positive frequencies. We therefore define the Larmor frequency magnitude as the positive quantity $\\omega_k = |\\gamma_k B_0|$. Using this convention, the Zeeman Hamiltonian, which describes the energy of the spins in the magnetic field, is written as:\n$$\n\\hat{H}_Z = -\\omega_I \\hbar \\hat{I}_z - \\omega_S \\hbar \\hat{S}_z\n$$\nHere, $\\hbar$ is the reduced Planck constant, and $\\hat{I}_z$ and $\\hat{S}_z$ are the operators for the $z$-component of the spin angular momentum for spins $I$ and $S$, respectively. This form ensures that for a positive gyromagnetic ratio ($\\gamma > 0$), the spin-up state ($m=+\\frac{1}{2}$) has lower energy, consistent with physical observation.\n\nThe scalar coupling Hamiltonian describes the interaction between the two spins, mediated by electrons:\n$$\n\\hat{H}_J = h J (\\hat{\\vec{I}} \\cdot \\hat{\\vec{S}}) = h J (\\hat{I}_x\\hat{S}_x + \\hat{I}_y\\hat{S}_y + \\hat{I}_z\\hat{S}_z)\n$$\nwhere $J$ is the scalar coupling constant in Hertz (Hz) and $h=2\\pi\\hbar$ is the Planck constant.\n\nThe total Hamiltonian is $\\hat{H} = \\hat{H}_Z + \\hat{H}_J$.\n$$\n\\hat{H} = -\\omega_I \\hbar \\hat{I}_z - \\omega_S \\hbar \\hat{S}_z + h J (\\hat{I}_x\\hat{S}_x + \\hat{I}_y\\hat{S}_y + \\hat{I}_z\\hat{S}_z)\n$$\nThe problem states that the secular approximation is valid. This approximation is justified under high-field conditions where the Zeeman interaction is dominant, $|\\omega_{I} - \\omega_{S}|$ is large compared to $2\\pi J$. In this limit, non-secular terms that do not commute with $\\hat{H}_Z$, specifically the \"flip-flop\" terms $\\hat{I}_x\\hat{S}_x + \\hat{I}_y\\hat{S}_y = \\frac{1}{2}(\\hat{I}_+\\hat{S}_- + \\hat{I}_-\\hat{S}_+)$, are neglected. The secular Hamiltonian, which provides a first-order correction to the energy levels, retains only the $z$-component of the coupling interaction:\n$$\n\\hat{H}_{\\text{secular}} = -\\omega_I \\hbar \\hat{I}_z - \\omega_S \\hbar \\hat{S}_z + h J \\hat{I}_z \\hat{S}_z\n$$\nTo find the energy levels, we must find the eigenvalues of this Hamiltonian. It is convenient to work in units of angular frequency (radians per second) by considering the operator $\\hat{\\mathcal{H}} = \\hat{H}_{\\text{secular}}/\\hbar$:\n$$\n\\hat{\\mathcal{H}} = -\\omega_I \\hat{I}_z - \\omega_S \\hat{S}_z + 2\\pi J \\hat{I}_z \\hat{S}_z\n$$\nThe basis for the $2$-spin system is the set of $4$ product states $|m_I, m_S\\rangle$, where $m_I, m_S \\in \\{+\\frac{1}{2}, -\\frac{1}{2}\\}$. These states are often denoted using $\\alpha$ for spin up ($m=+\\frac{1}{2}$) and $\\beta$ for spin down ($m=-\\frac{1}{2}$). The $4$ states are:\n$|1\\rangle = |\\alpha\\alpha\\rangle = |+\\frac{1}{2}, +\\frac{1}{2}\\rangle$\n$|2\\rangle = |\\alpha\\beta\\rangle = |+\\frac{1}{2}, -\\frac{1}{2}\\rangle$\n$|3\\rangle = |\\beta\\alpha\\rangle = |-\\frac{1}{2}, +\\frac{1}{2}\\rangle$\n$|4\\rangle = |\\beta\\beta\\rangle = |-\\frac{1}{2}, -\\frac{1}{2}\\rangle$\n\nBecause the secular Hamiltonian only contains $\\hat{I}_z$ and $\\hat{S}_z$ operators, the product states are the exact eigenstates of $\\hat{\\mathcal{H}}$. The energy eigenvalues (in rad/s) $E/\\hbar$ are found by applying $\\hat{\\mathcal{H}}$ to each state:\n$$\n\\frac{E(m_I, m_S)}{\\hbar} = \\langle m_I, m_S | \\hat{\\mathcal{H}} | m_I, m_S \\rangle = -\\omega_I m_I - \\omega_S m_S + 2\\pi J m_I m_S\n$$\nCalculating the energy for each of the $4$ states:\n1.  $E_1/\\hbar$ for $|\\alpha\\alpha\\rangle$: $m_I=+\\frac{1}{2}, m_S=+\\frac{1}{2}$\n    $$ \\frac{E_1}{\\hbar} = -\\omega_I(\\frac{1}{2}) - \\omega_S(\\frac{1}{2}) + 2\\pi J(\\frac{1}{2})(\\frac{1}{2}) = -\\frac{1}{2}\\omega_I - \\frac{1}{2}\\omega_S + \\frac{1}{2}\\pi J $$\n2.  $E_2/\\hbar$ for $|\\alpha\\beta\\rangle$: $m_I=+\\frac{1}{2}, m_S=-\\frac{1}{2}$\n    $$ \\frac{E_2}{\\hbar} = -\\omega_I(\\frac{1}{2}) - \\omega_S(-\\frac{1}{2}) + 2\\pi J(\\frac{1}{2})(-\\frac{1}{2}) = -\\frac{1}{2}\\omega_I + \\frac{1}{2}\\omega_S - \\frac{1}{2}\\pi J $$\n3.  $E_3/\\hbar$ for $|\\beta\\alpha\\rangle$: $m_I=-\\frac{1}{2}, m_S=+\\frac{1}{2}$\n    $$ \\frac{E_3}{\\hbar} = -\\omega_I(-\\frac{1}{2}) - \\omega_S(\\frac{1}{2}) + 2\\pi J(-\\frac{1}{2})(\\frac{1}{2}) = +\\frac{1}{2}\\omega_I - \\frac{1}{2}\\omega_S - \\frac{1}{2}\\pi J $$\n4.  $E_4/\\hbar$ for $|\\beta\\beta\\rangle$: $m_I=-\\frac{1}{2}, m_S=-\\frac{1}{2}$\n    $$ \\frac{E_4}{\\hbar} = -\\omega_I(-\\frac{1}{2}) - \\omega_S(-\\frac{1}{2}) + 2\\pi J(-\\frac{1}{2})(-\\frac{1}{2}) = +\\frac{1}{2}\\omega_I + \\frac{1}{2}\\omega_S + \\frac{1}{2}\\pi J $$\n\nNext, we determine the allowed transition angular frequencies for spin $I$. NMR transitions are induced by an oscillating magnetic field perpendicular to $\\vec{B_0}$. The magnetic dipole selection rules for observing transitions of a specific spin, say $I$, are $\\Delta m_I = \\pm 1$ and $\\Delta m_S = 0$. This means spin $S$ is a spectator; its spin state does not change during the transition of spin $I$. We consider absorptive transitions where the system goes from a lower energy state to a higher one. As established by our Hamiltonian, this corresponds to transitions where $m_I$ changes from $+1/2$ to $-1/2$.\n\nThere are two such transitions possible for spin $I$:\n1.  Transition when spin $S$ is in the $\\alpha$ state ($m_S = +\\frac{1}{2}$). This is a transition from state $|\\alpha\\alpha\\rangle$ (state $1$) to state $|\\beta\\alpha\\rangle$ (state $3$). The transition angular frequency $\\omega_{I,1}$ is given by the energy difference:\n    $$ \\omega_{I,1} = \\frac{E_3 - E_1}{\\hbar} = \\left(\\frac{1}{2}\\omega_I - \\frac{1}{2}\\omega_S - \\frac{1}{2}\\pi J\\right) - \\left(-\\frac{1}{2}\\omega_I - \\frac{1}{2}\\omega_S + \\frac{1}{2}\\pi J\\right) $$\n    $$ \\omega_{I,1} = \\omega_I - \\pi J $$\n2.  Transition when spin $S$ is in the $\\beta$ state ($m_S = -\\frac{1}{2}$). This is a transition from state $|\\alpha\\beta\\rangle$ (state $2$) to state $|\\beta\\beta\\rangle$ (state $4$). The transition angular frequency $\\omega_{I,2}$ is:\n    $$ \\omega_{I,2} = \\frac{E_4 - E_2}{\\hbar} = \\left(\\frac{1}{2}\\omega_I + \\frac{1}{2}\\omega_S + \\frac{1}{2}\\pi J\\right) - \\left(-\\frac{1}{2}\\omega_I + \\frac{1}{2}\\omega_S - \\frac{1}{2}\\pi J\\right) $$\n    $$ \\omega_{I,2} = \\omega_I + \\pi J $$\n\nThus, the spectrum for spin $I$ consists of a doublet centered at $\\omega_I$ with a splitting of $2\\pi J$ (rad/s), or $J$ (Hz). The two allowed transition angular frequencies for spin $I$ are $\\omega_I - \\pi J$ and $\\omega_I + \\pi J$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\omega_I - \\pi J & \\omega_I + \\pi J\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In practice, the appearance of a coupled spin system depends dramatically on the separation of its resonance frequencies compared to the coupling constant. This exercise provides a crucial diagnostic tool for any NMR spectroscopist: calculating the ratio of the chemical shift difference (in Hz) to the coupling constant, often expressed as $|\\Delta\\nu/J|$. Mastering this calculation allows you to quickly determine if you are in the simple 'weak coupling' regime or the more complex 'strong coupling' regime, which is essential for planning and interpreting decoupling experiments .",
            "id": "3723358",
            "problem": "A two-spin system in a Proton Nuclear Magnetic Resonance (NMR) experiment is probed by double resonance (selective irradiation) in the aromatic region of a substituted benzene. The spectrometer operates at a proton frequency of $500\\,\\text{MHz}$. Two vicinal aromatic protons, labeled $H_a$ and $H_b$, appear at chemical shifts $\\delta_a = 7.262\\,\\text{ppm}$ and $\\delta_b = 7.274\\,\\text{ppm}$, respectively. Their scalar coupling constant is $J_{ab} = 7.8\\,\\text{Hz}$. To evaluate whether strong coupling precludes meaningful selective decoupling, estimate the ratio $|\\Delta \\omega|/|2\\pi J|$ for the $H_a$–$H_b$ pair using only fundamental definitions of the Larmor frequency and the chemical shift, together with the operational frequency of the spectrometer. \n\nAssume that the angular frequency offset between $H_a$ and $H_b$ is determined by the chemical shift difference under a static field $B_0$, and that the coupling constant $J$ is reported in Hertz. Provide the numerical value of $|\\Delta \\omega|/|2\\pi J|$ based on these data. Express your final answer as a dimensionless number and round your answer to three significant figures.",
            "solution": "The objective is to calculate the dimensionless ratio $|\\Delta \\omega|/|2\\pi J|$ for a two-spin system consisting of protons $H_a$ and $H_b$. The quantity $\\Delta \\omega$ represents the difference in the Larmor angular frequencies of the two protons, and $J$ is their scalar coupling constant.\n\nThe Larmor frequency $\\nu$ (in units of Hertz, $\\text{Hz}$) of a nucleus is related to the spectrometer's operating frequency, $\\nu_{spec}$, and the nucleus's chemical shift, $\\delta$ (in units of parts per million, $\\text{ppm}$), by the fundamental definition of chemical shift. The chemical shift measures the resonance frequency of a nucleus relative to a standard reference frequency. The difference in resonance frequency, $\\Delta \\nu$, between two nuclei, $a$ and $b$, can be calculated directly from their chemical shift difference, $\\Delta \\delta = \\delta_a - \\delta_b$, and the spectrometer frequency, $\\nu_{spec}$.\n\nThe frequency of a nucleus $i$ is given by $\\nu_i = (\\text{reference frequency}) + \\delta_i \\nu_{spec} 10^{-6}$. Therefore, the difference in frequency between protons $H_a$ and $H_b$ is:\n$$ \\Delta \\nu = \\nu_a - \\nu_b = (\\delta_a - \\delta_b) \\nu_{spec} \\times 10^{-6} $$\nThis frequency difference $\\Delta \\nu$ is in units of $\\text{Hz}$.\n\nThe problem requires the difference in angular frequency, $\\Delta \\omega$. The relationship between angular frequency $\\omega$ (in radians per second) and frequency $\\nu$ (in Hertz) is $\\omega = 2\\pi\\nu$. Thus, the difference in angular frequency is:\n$$ \\Delta \\omega = 2\\pi \\Delta \\nu = 2\\pi (\\delta_a - \\delta_b) \\nu_{spec} \\times 10^{-6} $$\n\nWe are asked to find the ratio $|\\Delta \\omega|/|2\\pi J|$. Substituting the expression for $\\Delta \\omega$:\n$$ \\frac{|\\Delta \\omega|}{|2\\pi J|} = \\frac{|2\\pi (\\delta_a - \\delta_b) \\nu_{spec} \\times 10^{-6}|}{|2\\pi J_{ab}|} $$\nThe factor of $2\\pi$ in the numerator and denominator cancels, simplifying the expression to:\n$$ \\frac{|\\Delta \\omega|}{|2\\pi J|} = \\frac{|(\\delta_a - \\delta_b) \\nu_{spec} \\times 10^{-6}|}{|J_{ab}|} = \\frac{|\\Delta \\nu|}{|J_{ab}|} $$\nThis simplified ratio, often written as $|\\Delta \\nu / J|$, is a standard measure for determining the degree of coupling (weak vs. strong) between two spins.\n\nThe given values are:\nSpectrometer frequency: $\\nu_{spec} = 500\\,\\text{MHz} = 500 \\times 10^6\\,\\text{Hz}$\nChemical shift of $H_a$: $\\delta_a = 7.262\\,\\text{ppm}$\nChemical shift of $H_b$: $\\delta_b = 7.274\\,\\text{ppm}$\nScalar coupling constant: $J_{ab} = 7.8\\,\\text{Hz}$\n\nFirst, we calculate the difference in chemical shifts, $\\Delta \\delta$:\n$$ \\Delta \\delta = \\delta_a - \\delta_b = 7.262 - 7.274 = -0.012\\,\\text{ppm} $$\nThe absolute value is $|\\Delta \\delta| = 0.012\\,\\text{ppm}$.\n\nNext, we calculate the magnitude of the frequency difference in Hertz, $|\\Delta \\nu|$:\n$$ |\\Delta \\nu| = |\\Delta \\delta| \\times \\nu_{spec} \\times 10^{-6} $$\n$$ |\\Delta \\nu| = (0.012) \\times (500 \\times 10^6\\,\\text{Hz}) \\times 10^{-6} $$\n$$ |\\Delta \\nu| = 0.012 \\times 500\\,\\text{Hz} = 6.0\\,\\text{Hz} $$\n\nFinally, we compute the desired dimensionless ratio using the calculated $|\\Delta \\nu|$ and the given $|J_{ab}|$:\n$$ \\frac{|\\Delta \\omega|}{|2\\pi J|} = \\frac{|\\Delta \\nu|}{|J_{ab}|} = \\frac{6.0\\,\\text{Hz}}{7.8\\,\\text{Hz}} $$\n$$ \\frac{|\\Delta \\nu|}{|J_{ab}|} \\approx 0.7692307... $$\nRounding the result to three significant figures, as requested by the problem, gives $0.769$. This value, being less than approximately $10$, indicates that the $H_a-H_b$ system is strongly coupled, which validates the premise of the problem concerning the evaluation of strong coupling effects on selective decoupling experiments.",
            "answer": "$$\\boxed{0.769}$$"
        },
        {
            "introduction": "This capstone practice moves from static calculations to a dynamic simulation of a complete double resonance experiment. By implementing a numerical solution to the Liouville–von Neumann equation, you will build a virtual spectrometer to visualize the effects of selective irradiation on a coupled spin system . This powerful computational approach allows you to directly observe the collapse of a multiplet into a singlet and explore how the spectrum changes with varying irradiation power, bridging the gap between abstract theory and the observed spectral data.",
            "id": "3723368",
            "problem": "You are asked to implement a numerical simulation of a two-spin $1/2$ system of type $A\\!X$ undergoing selective spin decoupling via double resonance, and to predict the observed spectrum of spin $X$ under continuous-wave irradiation applied selectively to spin $A$. The simulation must be based on first principles by evolving the time-dependent density matrix according to fundamental quantum dynamics, and then computing the observable signal and its Fourier transform to obtain resonance frequencies.\n\nStarting from the Liouville–von Neumann equation $d\\rho/dt = -i[\\hat{H}(t),\\rho(t)]$, assume the high-field, weak-coupling limit where the scalar coupling Hamiltonian retains only the secular term. In a doubly rotating frame (one frame for each spin), with offsets expressed in Hertz relative to each spin’s transmitter reference, construct the time-independent Hamiltonian for continuous-wave irradiation on spin $A$:\n$$\n\\hat{H} \\;=\\; 2\\pi\\,\\Delta\\nu_A\\,\\hat{I}_z^{(A)} \\;+\\; 2\\pi\\,\\Delta\\nu_X\\,\\hat{I}_z^{(X)} \\;+\\; 2\\pi\\,J\\,\\hat{I}_z^{(A)}\\hat{I}_z^{(X)} \\;+\\; 2\\pi\\,\\omega_1\\,\\hat{I}_x^{(A)} \\,,\n$$\nwhere $\\Delta\\nu_A$ and $\\Delta\\nu_X$ are the chemical shift offsets in Hertz, $J$ is the coupling constant in Hertz, and $\\omega_1$ is the radiofrequency (RF) nutation frequency in Hertz applied to spin $A$ along $x$. The spin operators are $\\hat{I}_\\alpha^{(A)} = \\tfrac{1}{2}\\hat{\\sigma}_\\alpha\\otimes \\hat{\\mathbb{1}}$ and $\\hat{I}_\\alpha^{(X)} = \\hat{\\mathbb{1}}\\otimes \\tfrac{1}{2}\\hat{\\sigma}_\\alpha$, for $\\alpha\\in\\{x,y,z\\}$, with $\\hat{\\sigma}_\\alpha$ the Pauli matrices and $\\hat{\\mathbb{1}}$ the identity.\n\nInitialize the system at thermal equilibrium restricted to spin $X$, $\\rho_{\\text{eq}}\\propto \\hat{I}_z^{(X)}$, and apply an instantaneous $90^\\circ$ pulse about $y$ on spin $X$ to generate transverse magnetization. The initial state is\n$$\n\\rho(0) \\;=\\; \\hat{R}_y^{(X)}\\left(\\frac{\\pi}{2}\\right)\\,\\rho_{\\text{eq}}\\,\\hat{R}_y^{(X)}\\left(\\frac{\\pi}{2}\\right)^\\dagger,\\quad \\text{with}\\quad \\hat{R}_y^{(X)}(\\theta) \\;=\\; \\exp\\!\\big(-i\\,\\theta\\,\\hat{I}_y^{(X)}\\big).\n$$\nEvolve $\\rho(t)$ under $\\hat{H}$ using uniform time steps $\\Delta t$ by computing the unitary propagator $\\hat{U}=\\exp(-i\\hat{H}\\Delta t)$ and iterating $\\rho(t+\\Delta t)=\\hat{U}\\rho(t)\\hat{U}^\\dagger$. Compute the complex Free Induction Decay (FID) of spin $X$ as\n$$\ns(t) \\;=\\; \\operatorname{Tr}\\!\\left[\\rho(t)\\left(\\hat{I}_x^{(X)} + i\\,\\hat{I}_y^{(X)}\\right)\\right].\n$$\nTo obtain the spectrum, apply a discrete Fourier transform to $s(t)$ multiplied by an exponential apodization window $\\exp(-t/T_2^{\\text{win}})$ to ensure numerical stability and realistic line shapes. Express resonance frequencies in Hertz by using the standard discrete Fourier transform frequency axis in cycles per second.\n\nYour task is to implement this simulation and, for each specified test case, detect the positive-frequency spectral peaks of spin $X$ above a defined threshold and return the list of peak frequencies (in Hertz) rounded to one decimal place. Angles must be handled in radians; all frequency quantities must be handled internally in radians per second when forming $\\hat{H}$, but the final reported peak positions must be in Hertz. Use scientifically reasonable parameters, and ensure physical consistency.\n\nSimulation parameters (shared across test cases unless otherwise stated):\n- Number of time points $N=8192$.\n- Time step $\\Delta t = 2.0\\times 10^{-4}\\ \\text{s}$ (i.e., sampling rate $f_s=5000\\ \\text{Hz}$).\n- Apodization window constant $T_2^{\\text{win}} = 0.4\\ \\text{s}$.\n\nImplement the following test suite of four distinct parameter sets, each given as $(\\Delta\\nu_A,\\Delta\\nu_X,J,\\omega_1)$, all in Hertz:\n1. $(30.0,\\ 120.0,\\ 14.0,\\ 0.0)$: no irradiation (baseline doublet expected).\n2. $(0.0,\\ 120.0,\\ 14.0,\\ 200.0)$: strong on-resonance irradiation on $A$ (decoupling expected).\n3. $(40.0,\\ 120.0,\\ 14.0,\\ 40.0)$: off-resonance moderate irradiation (partial decoupling).\n4. $(0.0,\\ 120.0,\\ 14.0,\\ 2.0)$: very weak irradiation (near-baseline doublet).\n\nPeak picking requirement:\n- Consider only positive frequencies (i.e., $\\nu \\ge 0$).\n- Use a relative amplitude threshold of $0.25$ times the maximum spectral amplitude to retain peaks.\n- Identify local maxima by comparing each point to its immediate neighbors.\n- Report the sorted list of retained peak frequencies for each case, in Hertz, rounded to one decimal place.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of the detected peak frequencies for the corresponding test case. For example: \"[[f11,f12],[f21],[f31,f32],[f41,f42]]\" where all $f_{ij}$ are floats in Hertz rounded to one decimal place.",
            "solution": "### 1. Theoretical Framework: Quantum Dynamics of a Two-Spin System\n\nThe simulation is based on the time evolution of the system's density matrix, $\\rho(t)$, which is governed by the Liouville–von Neumann equation (with $\\hbar=1$):\n$$\n\\frac{d\\rho(t)}{dt} = -i[\\hat{H}(t), \\rho(t)]\n$$\nFor a time-independent Hamiltonian $\\hat{H}$, the solution is given by the evolution of the density matrix under a unitary transformation:\n$$\n\\rho(t) = \\hat{U}(t) \\rho(0) \\hat{U}(t)^\\dagger , \\quad \\text{where} \\quad \\hat{U}(t) = \\exp(-i\\hat{H}t)\n$$\nThe problem is set in a doubly rotating frame where the Hamiltonian is time-independent, simplifying the numerical integration. We evolve the system in discrete time steps $\\Delta t$, with the propagator for a single step being $\\hat{U} = \\exp(-i\\hat{H}\\Delta t)$.\n\n### 2. Implementation Steps\n\n#### 2.1. Basis and Spin Operators\nThe system consists of two spin-1/2 particles, $A$ and $X$. The Hilbert space is a $4$-dimensional complex vector space, formed by the tensor product of the individual spin spaces, $\\mathcal{H} = \\mathcal{H}_A \\otimes \\mathcal{H}_X$. We use the standard product basis $\\{|\\alpha_A\\alpha_X\\rangle, |\\alpha_A\\beta_X\\rangle, |\\beta_A\\alpha_X\\rangle, |\\beta_A\\beta_X\\rangle\\}$.\n\nThe spin operators are constructed as $4 \\times 4$ matrices. They are defined based on the Pauli matrices $\\hat{\\sigma}_\\alpha$ and the $2 \\times 2$ identity matrix $\\hat{\\mathbb{1}}$:\n$$\n\\hat{\\sigma}_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad \\hat{\\sigma}_y = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}, \\quad \\hat{\\sigma}_z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}, \\quad \\hat{\\mathbb{1}} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe spin angular momentum operators are $\\hat{I}_\\alpha = \\frac{1}{2}\\hat{\\sigma}_\\alpha$. The operators for the two-spin system are then constructed using the Kronecker product ($\\otimes$):\n$$\n\\hat{I}_\\alpha^{(A)} = \\hat{I}_\\alpha \\otimes \\hat{\\mathbb{1}}, \\quad \\hat{I}_\\alpha^{(X)} = \\hat{\\mathbb{1}} \\otimes \\hat{I}_\\alpha\n$$\nFor example, $\\hat{I}_z^{(A)} = \\frac{1}{2}\\hat{\\sigma}_z \\otimes \\hat{\\mathbb{1}}$ and $\\hat{I}_x^{(X)} = \\hat{\\mathbb{1}} \\otimes \\frac{1}{2}\\hat{\\sigma}_x$.\n\n#### 2.2. Hamiltonian Construction\nFor each test case with parameters $(\\Delta\\nu_A, \\Delta\\nu_X, J, \\omega_1)$, the Hamiltonian matrix is constructed. The input parameters are in Hertz (Hz), so they must be converted to angular frequency (radians per second) by multiplying by $2\\pi$. The Hamiltonian is:\n$$\n\\hat{H} = 2\\pi\\Delta\\nu_A \\hat{I}_z^{(A)} + 2\\pi\\Delta\\nu_X \\hat{I}_z^{(X)} + 2\\pi J \\hat{I}_z^{(A)}\\hat{I}_z^{(X)} + 2\\pi\\omega_1 \\hat{I}_x^{(A)}\n$$\nThis matrix will be a $4 \\times 4$ Hermitian matrix.\n\n#### 2.3. Initial State Preparation\nThe system starts at thermal equilibrium, where the density matrix is proportional to the net magnetization along the z-axis. The problem specifies observing spin $X$, so we consider only its contribution: $\\rho_{\\text{eq}} \\propto \\hat{I}_z^{(X)}$. An ideal $90^\\circ$ pulse along the y-axis of the rotating frame for spin $X$ is applied. This pulse rotates the magnetization from the z-axis to the x-axis. The initial state for the evolution, $\\rho(0)$, is obtained by applying the rotation superoperator:\n$$\n\\rho(0) = \\hat{R}_y^{(X)}\\left(\\frac{\\pi}{2}\\right) \\rho_{\\text{eq}} \\left(\\hat{R}_y^{(X)}\\left(\\frac{\\pi}{2}\\right)\\right)^\\dagger\n$$\nwhere $\\hat{R}_y^{(X)}(\\theta) = \\exp(-i\\theta\\hat{I}_y^{(X)})$. The effect of this rotation on the operator $\\hat{I}_z^{(X)}$ is to transform it into $-\\hat{I}_x^{(X)}$. As the overall sign and proportionality constant do not affect the peak positions in the final spectrum, we can simplify the initial state to $\\rho(0) = \\hat{I}_x^{(X)}$.\n\n#### 2.4. Time Evolution and Signal Detection\nThe time evolution is simulated iteratively for $N$ steps of duration $\\Delta t$.\n1.  **Propagator Calculation**: The unitary propagator for a single time step, $\\hat{U} = \\exp(-i\\hat{H}\\Delta t)$, is computed once using a matrix exponential function (e.g., `scipy.linalg.expm`).\n2.  **Iterative Evolution**: Starting with $\\rho_0 = \\rho(0)$, each subsequent state is calculated as $\\rho_{k+1} = \\hat{U}\\rho_k\\hat{U}^\\dagger$.\n3.  **Signal Calculation**: At each time step $t_k = k \\Delta t$, the complex free induction decay (FID) signal $s(t_k)$ is computed. This corresponds to the expectation value of the transverse raising operator for spin $X$, $\\hat{I}_+^{(X)} = \\hat{I}_x^{(X)} + i\\hat{I}_y^{(X)}$:\n    $$\n    s(t_k) = \\operatorname{Tr}\\left[\\rho(t_k)\\left(\\hat{I}_x^{(X)} + i\\hat{I}_y^{(X)}\\right)\\right]\n    $$\nThis process yields a complex-valued time-domain signal $s(t)$ of length $N$.\n\n#### 2.5. Spectral Analysis and Peak Picking\n1.  **Apodization**: The calculated FID, $s(t)$, is multiplied by an exponential window function, $\\exp(-t/T_2^{\\text{win}})$, to reduce truncation artifacts from the finite acquisition time and to simulate realistic Lorentzian line broadening.\n2.  **Fourier Transform**: A discrete Fourier transform (DFT) is applied to the apodized FID to convert the signal from the time domain to the frequency domain, yielding the spectrum. The `fftshift` function is used to center the zero frequency in the resulting array.\n3.  **Frequency Axis**: A corresponding frequency axis is generated. For a signal with $N$ points and a time step $\\Delta t$, the frequencies range from $-f_s/2$ to $f_s/2$, where $f_s=1/\\Delta t$ is the sampling frequency.\n4.  **Peak Detection**:\n    *   The analysis is restricted to the positive frequency portion of the spectrum ($\\nu \\ge 0$).\n    *   The magnitude (absolute value) of the complex spectrum is taken to get the amplitude spectrum.\n    *   A peak is identified at a frequency $\\nu_p$ if its spectral amplitude is a local maximum (i.e., greater than its immediate neighbors) and exceeds a threshold of $0.25$ times the maximum amplitude in the positive-frequency region.\n    *   The frequencies of all such detected peaks are collected, sorted, and rounded to one decimal place as required.\n\nThis complete procedure is applied to each of the four test cases specified in the problem statement to generate the final results.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Simulates a selective spin decoupling experiment for a two-spin 1/2 AX system.\n    \"\"\"\n    \n    # --- Simulation Parameters ---\n    N = 8192  # Number of time points\n    dt = 2.0e-4  # Time step in seconds\n    T2_win = 0.4  # Apodization window constant in seconds\n    \n    # --- Test Cases (d_nu_A, d_nu_X, J, omega_1) in Hz ---\n    test_cases = [\n        (30.0, 120.0, 14.0, 0.0),   # Case 1: No irradiation\n        (0.0, 120.0, 14.0, 200.0),  # Case 2: Strong on-resonance irradiation\n        (40.0, 120.0, 14.0, 40.0),   # Case 3: Off-resonance moderate irradiation\n        (0.0, 120.0, 14.0, 2.0),    # Case 4: Weak on-resonance irradiation\n    ]\n\n    # --- Define Spin Operators ---\n    # Pauli matrices (as I = 1/2 * sigma)\n    I_x = 0.5 * np.array([[0, 1], [1, 0]], dtype=np.complex128)\n    I_y = 0.5 * np.array([[0, -1j], [1j, 0]], dtype=np.complex128)\n    I_z = 0.5 * np.array([[1, 0], [0, -1]], dtype=np.complex128)\n    Id = np.identity(2, dtype=np.complex128)\n\n    # Two-spin operators using Kronecker product\n    I_x_A = np.kron(I_x, Id)\n    I_y_A = np.kron(I_y, Id)\n    I_z_A = np.kron(I_z, Id)\n    \n    I_x_X = np.kron(Id, I_x)\n    I_y_X = np.kron(Id, I_y)\n    I_z_X = np.kron(Id, I_z)\n\n    # Detection operator for spin X\n    I_plus_X = I_x_X + 1j * I_y_X\n\n    # --- Initial State ---\n    # rho(0) is proportional to I_x(X) after a 90-degree-y pulse on I_z(X)\n    rho_0 = I_x_X\n\n    # --- Time axis for apodization ---\n    time_axis = np.arange(N) * dt\n    apodization_window = np.exp(-time_axis / T2_win)\n\n    # --- Frequency axis for spectrum ---\n    freq_axis = np.fft.fftshift(np.fft.fftfreq(N, d=dt))\n    \n    all_results = []\n\n    for case in test_cases:\n        d_nu_A, d_nu_X, J, omega_1 = case\n        \n        # --- Construct Hamiltonian (in rad/s) ---\n        H = (2 * np.pi * d_nu_A * I_z_A +\n             2 * np.pi * d_nu_X * I_z_X +\n             2 * np.pi * J * np.dot(I_z_A, I_z_X) +\n             2 * np.pi * omega_1 * I_x_A)\n\n        # --- Calculate Propagator ---\n        U = expm(-1j * H * dt)\n        U_dagger = U.conj().T\n\n        # --- Time Evolution and FID Calculation ---\n        fid = np.zeros(N, dtype=np.complex128)\n        rho_current = rho_0.copy()\n        \n        for k in range(N):\n            # Calculate observable for current time step\n            fid[k] = np.trace(np.dot(rho_current, I_plus_X))\n            # Evolve density matrix for next time step\n            rho_current = np.dot(U, np.dot(rho_current, U_dagger))\n\n        # --- Signal Processing ---\n        # Apply apodization\n        fid_apodized = fid * apodization_window\n        \n        # Fourier transform\n        spectrum = np.fft.fftshift(np.fft.fft(fid_apodized))\n        amplitudes = np.abs(spectrum)\n\n        # --- Peak Picking ---\n        # Consider only positive frequencies\n        pos_freq_mask = freq_axis >= 0\n        pos_freqs = freq_axis[pos_freq_mask]\n        pos_amps = amplitudes[pos_freq_mask]\n        \n        if pos_amps.size == 0:\n            all_results.append([])\n            continue\n\n        max_amplitude = np.max(pos_amps)\n        threshold = 0.25 * max_amplitude\n        \n        peak_frequencies = []\n        # Find local maxima above threshold\n        for i in range(1, len(pos_amps) - 1):\n            if pos_amps[i] > threshold and pos_amps[i] > pos_amps[i-1] and pos_amps[i] > pos_amps[i+1]:\n                peak_frequencies.append(pos_freqs[i])\n        \n        # Round and sort results for the current case\n        rounded_peaks = sorted([round(f, 1) for f in peak_frequencies])\n        all_results.append(rounded_peaks)\n\n    # --- Final Output Formatting ---\n    # Using str() on a list of lists and removing spaces for exact format\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}