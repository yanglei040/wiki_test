{
    "hands_on_practices": [
        {
            "introduction": "核磁共振中的核奥弗豪泽效应（NOE）是确定分子三维结构最有力的工具之一，常被誉为“分子标尺”。要准确地使用这把标尺，我们必须理解其物理基础，即NOE信号强度与质子间距离的定量关系。这项练习将引导您通过基本原理，推导并应用著名的NOE交叉弛豫速率与距离的六次方反比（$r^{-6}$）关系，这是所有基于NOE的距离估算的理论基石。",
            "id": "3725348",
            "problem": "在一项基于核磁共振（NMR）中核欧沃豪瑟效应（NOE）的立体化学归属研究中，一个刚性有机骨架上存在两个不重叠的质子对，分别记为 A 和 B。质子对 A 的核间距为 $r_{A} = 2.5\\,\\text{Å}$，质子对 B 的核间距为 $r_{B} = 3.5\\,\\text{Å}$。该分子在溶液中以旋转相关时间 $ \\tau_{c} = 0.5$ ns 进行各向同性翻滚，并且质子拉莫尔频率足够高，以至于极限窄化条件 $ \\omega_{0} \\tau_{c} \\ll 1$ 成立。从偶极相互作用是两个质子间 NOE 的主要弛豫机制出发，并基于久期偶极哈密顿量与 $r^{-3}$ 成比例关系，以及在极限窄化极限下，谱密度 $J(\\omega)$ 与 $ \\tau_{c}$ 成正比，请推导交叉弛豫速率常数 $ \\sigma $ 对距离 $ r $ 和相关时间 $ \\tau_{c}$ 的比例依赖关系。然后，计算质子对 A 相对于质子对 B 的初始 NOE 建立速率常数（交叉弛豫速率）的比率 $ \\sigma_{A}/\\sigma_{B} $。报告 $ \\sigma_{A}/\\sigma_{B} $ 的数值，并将您的答案四舍五入到三位有效数字。将最终答案表示为一个纯数（无量纲）。",
            "solution": "该问题要求推导交叉弛豫速率常数 $\\sigma$ 对核间距 $r$ 和旋转相关时间 $\\tau_c$ 的比例依赖关系，然后计算两个不同质子对 A 和 B 的这些速率的比率。\n\n首先，我们验证问题陈述的有效性。问题提供了具体数据（$r_{A} = 2.5\\,\\text{Å}$, $r_{B} = 3.5\\,\\text{Å}$, $\\tau_{c} = 0.5$ ns）和一个理论框架（偶极弛豫、各向同性翻滚、极限窄化条件 $\\omega_{0} \\tau_{c} \\ll 1$）。尽管对于给定的 $\\tau_c$，“拉莫尔频率足够高”这一描述性短语在实际情况中似乎与极限窄化条件相矛盾，但问题明确指出条件 $\\omega_{0} \\tau_{c} \\ll 1$ 成立。这被解释为使用与此极限相关的数学模型的指令，这是一种常见的教学方法。该问题在科学上基于核磁共振（NMR）弛豫的原理，是适定且客观的。因此，它被认为是有效的。\n\n核欧沃豪瑟效应（NOE）是一种源于核自旋之间偶极交叉弛豫的现象。两个自旋之间 NOE 建立的初始速率与交叉弛豫速率常数 $\\sigma$ 成正比。对于一个同核双自旋体系，例如两个质子，所罗门方程给出了 $\\sigma$ 的表达式，即双量子（$W_2$）和零量子（$W_0$）跃迁概率之差：\n$$ \\sigma = W_2 - W_0 $$\n这些跃迁概率是由偶极相互作用产生的涨落磁场引起的。它们的速率取决于在特定频率下取值的谱密度函数 $J(\\omega)$。对于两个拉莫尔频率为 $\\omega_0$ 的相同自旋，其表达式为：\n$$ W_0 = \\frac{1}{10} K^2 J(0) $$\n$$ W_2 = \\frac{3}{5} K^2 J(2\\omega_0) $$\n项 $K^2$ 量化了静态偶极相互作用的强度，其表达式为：\n$$ K^2 = \\left( \\left(\\frac{\\mu_0}{4\\pi}\\right) \\frac{\\gamma^2 \\hbar}{r^3} \\right)^2 $$\n其中 $\\gamma$ 是质子的旋磁比，$\\hbar$ 是约化普朗克常数，$\\mu_0$ 是真空磁导率，而 $r$ 是核间距。从这个表达式中，我们可以看到弛豫参数对距离的关键依赖关系：\n$$ K^2 \\propto \\frac{1}{r^6} $$\n这与问题陈述中偶极哈密顿量与 $r^{-3}$ 成比例关系的说法一致，因为速率常数与相互作用能矩阵元的平方成正比。\n\n将 $W_0$ 和 $W_2$ 的表达式代入 $\\sigma$ 的方程中：\n$$ \\sigma = \\frac{3}{5} K^2 J(2\\omega_0) - \\frac{1}{10} K^2 J(0) = K^2 \\left( \\frac{3}{5} J(2\\omega_0) - \\frac{1}{10} J(0) \\right) $$\n问题陈述该分子进行各向同性翻滚，并且满足极限窄化条件 $\\omega_0 \\tau_c \\ll 1$。对于各向同性运动，谱密度函数的形式为：\n$$ J(\\omega) = \\frac{2}{5} \\frac{\\tau_c}{1 + (\\omega\\tau_c)^2} $$\n在极限窄化极限下，对于所有相关频率（即 $\\omega = 0$ 和 $\\omega = 2\\omega_0$），项 $(\\omega\\tau_c)^2$ 与 $1$ 相比可以忽略不计。因此，分母近似为 $1$，谱密度函数简化为：\n$$ J(\\omega) \\approx \\frac{2}{5} \\tau_c $$\n这个简化形式与频率无关，并与旋转相关时间 $\\tau_c$ 成正比，正如问题陈述中所断言的那样。现在我们将此近似值代回 $\\sigma$ 的表达式中：\n$$ \\sigma \\approx K^2 \\left( \\frac{3}{5} \\left(\\frac{2}{5}\\tau_c\\right) - \\frac{1}{10} \\left(\\frac{2}{5}\\tau_c\\right) \\right) $$\n提取公因式以进行简化：\n$$ \\sigma \\approx K^2 \\tau_c \\left( \\frac{6}{25} - \\frac{2}{50} \\right) = K^2 \\tau_c \\left( \\frac{6}{25} - \\frac{1}{25} \\right) = \\frac{5}{25} K^2 \\tau_c = \\frac{1}{5} K^2 \\tau_c $$\n现在，我们重新引入来自 $K^2 \\propto r^{-6}$ 的距离依赖关系。这就得出了 $\\sigma$ 对 $\\tau_c$ 和 $r$ 的比例依赖关系：\n$$ \\sigma \\propto \\frac{\\tau_c}{r^6} $$\n推导至此完成。交叉弛豫速率与旋转相关时间成正比，与核间距的六次方成反比。\n\n接下来，我们计算两个质子对 A 和 B 的交叉弛豫速率之比 $\\sigma_A / \\sigma_B$。根据推导出的比例关系，我们可以写出：\n$$ \\sigma_A = C \\frac{\\tau_c}{r_A^6} $$\n$$ \\sigma_B = C \\frac{\\tau_c}{r_B^6} $$\n比例常数 $C$ 包含了所有物理常数，并且对于两个质子对是相同的。旋转相关时间 $\\tau_c$ 描述了整个刚性分子的翻滚，因此对于两个质子对也是相同的。取 $\\sigma_A$ 与 $\\sigma_B$ 的比值会消去这些公共因子：\n$$ \\frac{\\sigma_A}{\\sigma_B} = \\frac{C \\frac{\\tau_c}{r_A^6}}{C \\frac{\\tau_c}{r_B^6}} = \\frac{r_B^6}{r_A^6} = \\left(\\frac{r_B}{r_A}\\right)^6 $$\n问题提供了距离 $r_{A} = 2.5\\,\\text{Å}$ 和 $r_{B} = 3.5\\,\\text{Å}$。代入这些值：\n$$ \\frac{\\sigma_A}{\\sigma_B} = \\left(\\frac{3.5}{2.5}\\right)^6 $$\n距离之比是一个无量纲的量：\n$$ \\frac{3.5}{2.5} = \\frac{35}{25} = \\frac{7}{5} = 1.4 $$\n然后我们计算这个比率的六次方：\n$$ \\frac{\\sigma_A}{\\sigma_B} = (1.4)^6 = 7.529536 $$\n问题要求将答案四舍五入到三位有效数字。\n$$ \\frac{\\sigma_A}{\\sigma_B} \\approx 7.53 $$",
            "answer": "$$\\boxed{7.53}$$"
        },
        {
            "introduction": "如果说NOE是测量距离的“分子标尺”，那么三键J-耦合常数（$^{3}J$）就是测量扭转角的“分子量角器”。通过Karplus关系式，我们可以将实验测得的耦合常数值与分子骨架的二面角联系起来，从而揭示其构象信息。本练习将通过分析经典且普遍存在的环己烷椅式构象，帮助您掌握Karplus关系的应用，并理解如何利用耦合常数的差异来指认取代基的立体化学位置。",
            "id": "3725360",
            "problem": "通过核磁共振（NMR）分析一个处于理想化椅式构象的单取代环己烷。为解释邻近三键质子-质子耦合常数，使用质子-质子邻近耦合的 Karplus 关系式：$J(\\theta)=A\\cos^{2}\\theta+B\\cos\\theta+C$，其中 $A$、$B$ 和 $C$ 是经验参数，$J$ 的单位是 $\\mathrm{Hz}$，$\\theta$ 是 H–C–C–H 扭转的二面角（以度为单位）。假设在室温下，环己烷处于理想化的椅式构象，并且对于所考虑的特定邻近质子对，构象平均效应可以忽略不计。对于环上相邻的碳原子，取一个直立-直立（axial–axial）邻近质子对的二面角为 $\\theta_{ax,ax}=180^{\\circ}$，一个直立-平伏（axial–equatorial）邻近质子对的二面角为 $\\theta_{ax,eq}=60^{\\circ}$。使用参数集 $A=9.5$，$B=-0.5$ 和 $C=0.5$。\n\n从第一性原理出发，阐明这些角度是如何从椅式构象的几何形状中产生的，并解释为什么 Karplus 关系式将 $J$ 与 $\\theta$ 联系起来。然后，计算预测的直立-直立和直立-平伏三键耦合常数 $^{3}J_{ax,ax}$ 和 $^{3}J_{ax,eq}$，并计算比值 $R=\\dfrac{{}^{3}J_{ax,ax}}{{}^{3}J_{ax,eq}}$。最后，说明这些耦合常数的相对大小，以及对于直立与平伏取代基预期的核奥弗豪森效应（NOE, Nuclear Overhauser Effect）邻近模式，如何能够用于确定单取代环己烷的立体化学构型。\n\n将您的最终答案表示为 $R$ 的单个数值，并四舍五入到四位有效数字。报告 $R$ 时不带单位，仅为一个纯数字，并在所有三角函数计算中使用度作为单位。",
            "solution": "该问题被评估为有效，因为它科学地基于核磁共振（NMR）波谱学和立体化学的原理，问题提出得当，为获得唯一解提供了所有必要信息，并以客观、正式的语言表述。其中没有矛盾、歧义或违背科学事实之处。\n\n该问题需要进行多步分析，包括概念解释和数值计算。解决方案的结构如下：首先，解释椅式环己烷中特定二面角的来源；其次，阐述 Karplus 关系式的基本原理；第三，计算邻近耦合常数及其比值；最后，解释如何利用耦合常数和核奥弗豪森效应（NOE）进行立体化学构型指定。\n\n**1. 理想化椅式环己烷中二面角的来源**\n\n椅式构象是环己烷环最稳定的排布。在这种构象中，碳原子形成一个折叠的环，相连的氢原子占据两种不同类型的位置：直立（axial, $ax$）和平伏（equatorial, $eq$）。直立键大致垂直于环的平均平面，交替地位于平面的上方和下方，而平伏键则从环的外围向外指向，大致在平均平面内。\n\n为了可视化邻近三键 H–C–C–H 的二面角 $\\theta$，我们沿着环的一个 C–C 键方向观察 Newman 投影图。\n\n- **直立-直立（$ax,ax$）邻近质子**：考虑两个邻近质子，一个在碳原子 $C_1$ 上，一个在 $C_2$ 上，两者都处于直立位置（$H_{1,ax}$ 和 $H_{2,ax}$）。沿着 $C_1–C_2$ 键看下去，可以看到 $C_1–H_{1,ax}$ 键和 $C_2–H_{2,ax}$ 键是反式共平面的（anti-periplanar）。这意味着它们在同一平面内，但指向相反的方向。因此，它们之间的二面角为 $\\theta_{ax,ax} = 180^{\\circ}$。这种反式共平面的排布是椅式构象的一个关键特征。\n\n- **直立-平伏（$ax,eq$）邻近质子**：考虑一个在 $C_1$ 上的直立质子（$H_{1,ax}$）和一个在 $C_2$ 上的平伏质子（$H_{2,eq}$）。在沿 $C_1–C_2$ 键的 Newman 投影图中，$C_1–H_{1,ax}$ 键和 $C_2–H_{2,eq}$ 键处于邻位（gauche）关系。在一个理想化的、完全交错的椅式构象中，这个二面角是 $\\theta_{ax,eq} = 60^{\\circ}$。根据对称性，同样的 $60^{\\circ}$ 角度也适用于平伏-直立（$H_{1,eq}$, $H_{2,ax}$）质子对和平伏-平伏（$H_{1,eq}$, $H_{2,eq}$）质子对。\n\n**2. Karplus 关系式的原理**\n\n三键质子-质子耦合，$^{3}J_{HH}$，也称为邻近耦合，是一种通过化学键的标量相互作用。一个质子核的磁性影响通过 H–C–C–H 路径上中间的成键电子传递给邻近的另一个质子核。这种耦合的大小，$J$，关键取决于构成该路径的分子轨道之间的重叠程度。\n\n轨道重叠的程度又是两个 C–H 键之间二面角 $\\theta$ 的函数。由 Martin Karplus 首次进行的量子力学计算表明，当 C–H 键共面时，耦合达到最大值，这对应于顺式共平面（syn-periplanar，$\\theta = 0^{\\circ}$）和反式共平面（anti-periplanar，$\\theta = 180^{\\circ}$）的排布，此时轨道重叠最有效。当 C–H 键正交（$\\theta = 90^{\\circ}$）时，耦合达到最小值，因为沿耦合路径的轨道重叠几乎为零。\n\nKarplus 关系式 $J(\\theta)=A\\cos^{2}\\theta+B\\cos\\theta+C$ 是一个模拟这种行为的经验公式。\n- 主要项 $A\\cos^{2}\\theta$ 捕捉了主要的依赖关系。由于 $\\cos^{2}(0^{\\circ}) = 1$ 和 $\\cos^{2}(180^{\\circ}) = 1$，该项正确预测了共面质子的大耦合。由于 $\\cos^{2}(90^{\\circ}) = 0$，它预测了正交质子的最小耦合。\n- $B\\cos\\theta$ 和 $C$ 这两项是经验校正项，用于解释诸如取代基的电负性、C–C 键长和 H–C–C 键角等因素，这些因素会导致偏离简单的 $\\cos^{2}\\theta$ 依赖关系。这个精炼的方程为将实验测量的耦合常数与分子几何结构关联起来提供了一个强大的工具。\n\n**3. $^{3}J_{ax,ax}$、$^{3}J_{ax,eq}$ 和比值 $R$ 的计算**\n\n我们已知 Karplus 方程和一组参数：\n- 方程：$J(\\theta)=A\\cos^{2}\\theta+B\\cos\\theta+C$\n- 参数：$A=9.5$，$B=-0.5$，$C=0.5$\n- 角度：$\\theta_{ax,ax}=180^{\\circ}$ 和 $\\theta_{ax,eq}=60^{\\circ}$\n\n首先，我们计算直立-直立耦合常数 $^{3}J_{ax,ax}$：\n$$ ^{3}J_{ax,ax} = J(180^{\\circ}) = A\\cos^{2}(180^{\\circ}) + B\\cos(180^{\\circ}) + C $$\n使用 $\\cos(180^{\\circ}) = -1$，我们得到：\n$$ ^{3}J_{ax,ax} = (9.5)(-1)^{2} + (-0.5)(-1) + 0.5 $$\n$$ ^{3}J_{ax,ax} = 9.5 \\times 1 + 0.5 + 0.5 $$\n$$ ^{3}J_{ax,ax} = 10.5 \\ \\mathrm{Hz} $$\n\n接下来，我们计算直立-平伏耦合常数 $^{3}J_{ax,eq}$：\n$$ ^{3}J_{ax,eq} = J(60^{\\circ}) = A\\cos^{2}(60^{\\circ}) + B\\cos(60^{\\circ}) + C $$\n使用 $\\cos(60^{\\circ}) = 0.5$，我们得到：\n$$ ^{3}J_{ax,eq} = (9.5)(0.5)^{2} + (-0.5)(0.5) + 0.5 $$\n$$ ^{3}J_{ax,eq} = 9.5 \\times 0.25 - 0.25 + 0.5 $$\n$$ ^{3}J_{ax,eq} = 2.375 - 0.25 + 0.5 $$\n$$ ^{3}J_{ax,eq} = 2.625 \\ \\mathrm{Hz} $$\n\n最后，我们计算比值 $R$：\n$$ R = \\frac{{}^{3}J_{ax,ax}}{{}^{3}J_{ax,eq}} = \\frac{10.5}{2.625} $$\n$$ R = 4 $$\n题目要求答案四舍五入到四位有效数字。因此，$R = 4.000$。\n\n**4. 使用 $J$-耦合和 NOE 进行立体化学构型指定**\n\n计算结果表明，$^{3}J_{ax,ax}$（一个“大”耦合，通常为 $8-13 \\ \\mathrm{Hz}$）显著大于 $^{3}J_{ax,eq}$（一个“小”耦合，通常为 $2-5 \\ \\mathrm{Hz}$）。这种差异是确定环己烷环上质子，乃至取代基立体化学构型的有力工具。\n\n- **使用 $J$-耦合**：考虑带有取代基的碳原子上的次甲基质子（$H_X$）。\n    - 如果取代基处于更稳定的**平伏**位置，$H_X$ 必定是**直立**的。这个直立质子有两个邻近的直立邻居（在每个相邻碳上各一个），导致其 NMR 信号中出现两个大的 $^{3}J_{ax,ax}$ 耦合。因此，$H_X$ 的信号将是一个总宽度很大的宽多重峰，其特征是至少有一个大的耦合常数（$ 8 \\ \\mathrm{Hz}$）。\n    - 如果取代基处于较不稳定的**直立**位置，$H_X$ 必定是**平伏**的。这个平伏质子没有邻近的直立-直立关系；其所有的邻近耦合（$^{3}J_{eq,ax}$ 和 $^{3}J_{eq,eq}$）都很小。$H_X$ 的信号将是一个只有小耦合常数的窄多重峰。\n    - 因此，测量 $H_X$ 的耦合常数可以明确地确定其直立或平伏性质，从而定义取代基的立体化学构型。\n\n- **使用核奥弗豪森效应（NOE）**：NOE 是一种通过空间的现象，它能检测到彼此靠近（通常  $5\\,\\text{Å}$）的原子核，而不管它们之间是否有化学键。这为通过化学键的 $J$-耦合提供了补充信息。\n    - 在椅式构象中，位于 $1$、$3$ 和 $5$ 位的直立基团（即“1,3-双直立”关系）在空间上彼此靠近，位于环的同一侧。\n    - 如果一个（带有质子的）取代基是**直立**的，NOE 实验将揭示其质子与 $3$ 位和 $5$ 位直立质子之间的空间邻近性（在二维 NOESY 谱中表现为一个“交叉峰”）。\n    - 如果一个取代基是**平伏**的，它会远离 $3$ 位和 $5$ 位的直立质子。相反，它靠近相邻碳上的邻近质子（包括直立和平伏质子）。NOE 实验会显示与这些相邻质子的相关性，但关键的是，不会显示与 1,3-双直立质子的相关性。\n\n通过结合来自 $J$-耦合（揭示二面角）和 NOE（揭示空间邻近性）的信息，化学家可以明确地指定取代环己烷的立体化学构型。例如，观察到次甲基质子 $H_X$ 的大耦合常数表明它是直立的，从而将取代基置于平伏位置。如果 NOE 实验显示取代基与 1,3-双直立质子之间没有相关性，则可以最终确认此指定。",
            "answer": "$$\n\\boxed{4.000}\n$$"
        },
        {
            "introduction": "在真实的结构解析工作中，科学家们需要整合多种互补的实验数据，以构建一个自洽的分子模型。这项综合练习模拟了结构解析的最终验证步骤，指导您构建一个计算流程，将NOE实验得到的距离限制条件与J-耦合得到的二面角限制条件相结合。通过这种方式，您可以系统地检验一个给定的三维分子模型是否与所有实验数据相符，从而完成对立体化学的最终确证。",
            "id": "3725434",
            "problem": "给定一个小型有机肽模拟物的核磁共振（NMR）波谱数据：特定质子对之间的核奥弗豪瑟效应谱（NOESY）交叉峰强度，以及骨架中扭转角的邻位标量耦合，即三键耦合（$^{3}J$）。利用基本关系，构建数学定义的约束条件，并评估一个提出的立体化学模型（距离和二面角）是否与数据一致。\n\n基本原理：\n- 在核奥弗豪瑟效应（NOE）下，两个自旋 $i$ 和 $j$ 之间的交叉弛豫速率 $\\sigma_{ij}$ 与 $r_{ij}^{-6}$ 成正比，其中 $r_{ij}$ 是质子间距离。对于相同的实验条件和短混合时间，交叉峰强度 $I_{ij}$ 与 $\\sigma_{ij}$ 成正比，从而得出强度比值关系 $I_{ij} / I_{\\text{cal}} \\approx \\sigma_{ij} / \\sigma_{\\text{cal}} \\propto (r_{\\text{cal}}/r_{ij})^{6}$。因此，距离估计值通过以下公式获得：$$r_{ij} = r_{\\text{cal}} \\left(\\frac{I_{\\text{cal}}}{I_{ij}}\\right)^{1/6}.$$ \n- Karplus 关系描述了三键邻位标量耦合对二面角 $\\phi$ 的一种经过充分检验的依赖关系，表达式为 $$^{3}J(\\phi) = A \\cos^{2}\\phi + B \\cos\\phi + C,$$ 其中常数 $(A,B,C)$ 根据相关的耦合路径选择（单位为赫兹）。\n\n按如下方式构建算法：\n1. 使用具有已知距离 $r_{\\text{cal}}$ 和强度 $I_{\\text{cal}}$ 的校准对（calibrant），将每个 NOESY 强度转换为距离约束。对于每个观测到的强度 $I_{ij}$，通过上述比值法则计算 $r_{ij}$，并施加一个对称边界 $[r_{ij} - \\Delta r,\\, r_{ij} + \\Delta r]$，其中 $\\Delta r$ 已给出。对于校准对本身，施加 $[r_{\\text{cal}} - \\Delta r,\\, r_{\\text{cal}} + \\Delta r]$。\n2. 对于缺失的交叉峰（未观测到），仅使用强度检测阈值 $I_{\\min}$ 施加上界：$$r_{ij}^{\\max} = r_{\\text{cal}} \\left(\\frac{I_{\\text{cal}}}{I_{\\min}}\\right)^{1/6},$$ 不设下界。\n3. 对于模型中的每个扭转角 $\\phi_k$，使用 $(A,B,C)$ 通过 Karplus 关系计算耦合 $^{3}J_{\\text{calc},k}$，并要求 $$\\left|\\,^{3}J_{\\text{calc},k} - {}^{3}J_{\\text{meas},k}\\,\\right| \\le \\Delta J_k,$$ 其中 ${}^{3}J_{\\text{meas},k}$ 是测量得到的耦合，$\\Delta J_k$ 是其容差。\n4. 一个候选立体化学模型是一致的，当且仅当所有模型距离都位于它们各自的 NOE 衍生边界内（包括对缺失峰仅施加上界的处理方式），并且所有模型扭转角都满足上述耦合不等式。\n\n单位和角度约定：\n- 距离单位必须是埃（$\\text{\\AA}$）。\n- 耦合单位必须是赫兹（$\\text{Hz}$）。\n- 角度单位必须是度（在内部为三角函数计算转换为弧度）。\n\n您的程序必须评估以下四个测试用例。每个测试用例提供：\n- 一个质子对列表（按索引，隐式排序）。\n- 校准物索引、其已知距离 $r_{\\text{cal}}$（$\\text{\\AA}$）和强度 $I_{\\text{cal}}$。\n- 各质子对的强度列表 $I_{ij}$，其中缺失的强度由空值表示（使用 $I_{\\min}$ 处理）。\n- 距离不确定度 $\\Delta r$（$\\text{\\AA}$）和强度检测阈值 $I_{\\min}$（在适用时）。\n- Karplus 参数 $(A,B,C)$，单位为 $\\text{Hz}$。\n- 测量得到的耦合 ${}^{3}J_{\\text{meas}}$（单位为 $\\text{Hz}$）及其容差 $\\Delta J_k$（单位为 $\\text{Hz}$）。\n- 候选模型的质子对距离（单位为 $\\text{\\AA}$）和扭转角 $\\phi_k$（单位为度）。\n\n测试套件：\n- 案例 1（一般一致性）：\n  - 校准物索引 $0$，$r_{\\text{cal}} = 2.50\\,\\text{\\AA}$，$I_{\\text{cal}} = 1.000$。\n  - 强度 $I = [1.000, 0.125, 0.500]$。\n  - 距离不确定度 $\\Delta r = 0.30\\,\\text{\\AA}$，检测阈值 $I_{\\min} = 0.010$。\n  - Karplus 参数 $(A,B,C) = (7.9, -1.0, 0.6)\\,\\text{Hz}$。\n  - 测量得到的耦合 ${}^{3}J_{\\text{meas}} = [9.4, 2.1]\\,\\text{Hz}$ 及其容差 $\\Delta J = [0.5, 0.4]\\,\\text{Hz}$。\n  - 模型距离 $d_{\\text{model}} = [2.50, 3.50, 2.75]\\,\\text{\\AA}$，模型角度 $\\phi_{\\text{model}} = [175.0, 60.0]$ 度。\n- 案例 2（边界距离和紧凑耦合）：\n  - 校准物索引 $0$，$r_{\\text{cal}} = 2.50\\,\\text{\\AA}$，$I_{\\text{cal}} = 1.000$。\n  - 强度 $I = [1.000, 0.015625, 0.500]$。\n  - 距离不确定度 $\\Delta r = 0.30\\,\\text{\\AA}$，检测阈值 $I_{\\min} = 0.010$。\n  - Karplus 参数 $(A,B,C) = (7.9, -1.0, 0.6)\\,\\text{Hz}$。\n  - 测量得到的耦合 ${}^{3}J_{\\text{meas}} = [8.8, 1.18]\\,\\text{Hz}$ 及其容差 $\\Delta J = [0.3, 0.05]\\,\\text{Hz}$。\n  - 模型距离 $d_{\\text{model}} = [2.50, 5.30, 2.80]\\,\\text{\\AA}$，模型角度 $\\phi_{\\text{model}} = [160.0, 70.0]$ 度。\n- 案例 3（不一致）：\n  - 校准物索引 $0$，$r_{\\text{cal}} = 2.50\\,\\text{\\AA}$，$I_{\\text{cal}} = 1.000$。\n  - 强度 $I = [1.000, 0.500, 0.500]$。\n  - 距离不确定度 $\\Delta r = 0.30\\,\\text{\\AA}$，检测阈值 $I_{\\min} = 0.010$。\n  - Karplus 参数 $(A,B,C) = (7.9, -1.0, 0.6)\\,\\text{Hz}$。\n  - 测量得到的耦合 ${}^{3}J_{\\text{meas}} = [9.5, 2.1]\\,\\text{Hz}$ 及其容差 $\\Delta J = [0.3, 0.4]\\,\\text{Hz}$。\n  - 模型距离 $d_{\\text{model}} = [2.90, 3.40, 3.40]\\,\\text{\\AA}$，模型角度 $\\phi_{\\text{model}} = [90.0, 120.0]$ 度。\n- 案例 4（缺失 NOE，仅有上界）：\n  - 校准物索引 $0$，$r_{\\text{cal}} = 2.50\\,\\text{\\AA}$，$I_{\\text{cal}} = 1.000$。\n  - 强度 $I = [1.000, \\text{null}, 0.040]$ 其中 $I_{\\min} = 0.020$。\n  - 距离不确定度 $\\Delta r = 0.30\\,\\text{\\AA}$。\n  - Karplus 参数 $(A,B,C) = (7.9, -1.0, 0.6)\\,\\text{Hz}$。\n  - 测量得到的耦合 ${}^{3}J_{\\text{meas}} = [9.2, 2.9]\\,\\text{Hz}$ 及其容差 $\\Delta J = [0.5, 0.2]\\,\\text{Hz}$。\n  - 模型距离 $d_{\\text{model}} = [2.55, 4.70, 4.20]\\,\\text{\\AA}$，模型角度 $\\phi_{\\text{model}} = [175.0, 120.0]$ 度。\n\n计算要求：\n- 角度必须解释为度，并在计算 $\\cos(\\cdot)$ 时转换为弧度。\n- 对于距离边界，使用包含性比较：如果 $r_{\\min} \\le d_{\\text{model}} \\le r_{\\max}$，则模型距离 $d_{\\text{model}}$ 是可接受的；对于缺失的 NOE 峰，仅强制 $d_{\\text{model}} \\le r_{\\max}$，没有下界。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\\\"[result1,result2,result3,result4]\\\"），每个结果都是一个布尔值，指示相应测试用例的模型是否与 NOE 衍生的距离约束和 $^{3}J$ 衍生的二面角约束都一致。",
            "solution": "该问题要求对照实验性的核磁共振（NMR）数据，验证一个提出的肽模拟物的立体化学模型。此验证通过将两种类型的实验数据——核奥弗豪瑟效应（NOE）强度和邻位标量（$^{3}J$）耦合常数——转换为几何约束（特别是关于质子间距离和骨架二面角）来执行。当且仅当模型的所有距离和角度都满足这些导出的约束时，该模型才被视为一致。\n\n该验证算法通过按如下方式系统地检查每个约束来实现：\n\n**1. NOE 衍生的距离约束**\n\n核奥弗豪瑟效应是一种现象，其中一个原子核的自旋极化通过空间转移到另一个附近的原子核。这种转移的效率，以及因此在 NOESY 谱中相应交叉峰的强度（$I_{ij}$），强烈依赖于两个原子核（$i$ 和 $j$）之间的距离（$r_{ij}$）。对于短的实验混合时间，此关系近似为与 $r_{ij}^{-6}$ 成正比。\n\n通过使用一对具有已知固定距离（$r_{\\text{cal}}$）和测量的 NOE 强度（$I_{\\text{cal}}$）的校准质子，我们可以使用比率公式估算其他未知距离：\n$$r_{ij} = r_{\\text{cal}} \\left(\\frac{I_{\\text{cal}}}{I_{ij}}\\right)^{1/6}$$\n这个计算出的距离 $r_{ij}$ 是一个估计值，并受实验不确定性的影响。该问题定义了三种从 NOE 数据创建距离约束的不同情景：\n\n*   **观测到的 NOE 峰：** 对于任何具有测量的非零强度 $I_{ij}$ 的质子对（$i,j$），估计距离为 $r_{ij}$。约束是一个由对称容差 $\\Delta r$ 定义的可接受范围。模型的距离 $d_{\\text{model}, ij}$ 必须满足包含性不等式：\n    $$r_{ij} - \\Delta r \\le d_{\\text{model}, ij} \\le r_{ij} + \\Delta r$$\n    此规则也适用于校准对本身。由于对于校准物，$I_{ij} = I_{\\text{cal}}$，该公式正确地得出 $r_{ij} = r_{\\text{cal}}$，其约束变为 $[r_{\\text{cal}} - \\Delta r, r_{\\text{cal}} + \\Delta r]$，与问题陈述中的明确指令一致。\n\n*   **缺失的 NOE 峰：** 如果在一对质子之间未观测到 NOE 交叉峰，这并不意味着距离是无穷大。它意味着强度低于实验检测阈值 $I_{\\min}$。此信息为允许的距离提供了一个上界，但没有下界。最大允许距离 $r_{ij}^{\\max}$ 通过将 $I_{\\min}$ 代入距离公式计算得出：\n    $$r_{ij}^{\\max} = r_{\\text{cal}} \\left(\\frac{I_{\\text{cal}}}{I_{\\min}}\\right)^{1/6}$$\n    模型的距离必须满足：\n    $$d_{\\text{model}, ij} \\le r_{ij}^{\\max}$$\n\n**2. Karplus 衍生的二面角约束**\n\n两个原子核之间的三键标量耦合常数 $^{3}J$ 的大小取决于连接它们的键合路径上的二面角（$\\phi$）。这种关系由经验性的 Karplus 方程描述：\n$$^{3}J(\\phi) = A \\cos^{2}\\phi + B \\cos\\phi + C$$\n参数 $A$、$B$ 和 $C$ 取决于特定类型的化学片段。所有角度输入和计算都必须使用一致的单位；模型的角度以度为单位提供，在使用 Karplus 方程中的三角函数时必须转换为弧度。\n\n对于与特定二面角 $\\phi_k$ 相关聯的每个测量耦合 ${}^{3}J_{\\text{meas},k}$，我们可以检查其一致性。使用模型提出的二面角 $\\phi_{\\text{model},k}$，我们计算预期的耦合常数 $^{3}J_{\\text{calc},k}$。如果计算出的耦合与测量得到的耦合之间的绝对差在指定的容差 $\\Delta J_k$ 之内，则模型与此测量结果一致：\n$$\\left| \\,^{3}J_{\\text{calc},k} - {}^{3}J_{\\text{meas},k} \\, \\right| \\le \\Delta J_k$$\n\n**3. 整体模型一致性**\n\n一个候选立体化学模型仅在每一个从实验数据中导出的距离和二面角约束都同时得到满足时，才被宣布为一致。即使只有一个约束失败也足以使整个模型无效。因此，算法将遍历所有约束，如果任何检查失败，模型将立即被归类为不一致。如果所有检查都通过，则模型是一致的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the stereochemical consistency problem for a series of test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: general consistency\n        {\n            \"calibrant_index\": 0, \"r_cal\": 2.50, \"I_cal\": 1.000,\n            \"intensities\": [1.000, 0.125, 0.500],\n            \"delta_r\": 0.30, \"I_min\": 0.010,\n            \"karplus_params\": (7.9, -1.0, 0.6),\n            \"J_meas\": [9.4, 2.1], \"delta_J\": [0.5, 0.4],\n            \"model_distances\": [2.50, 3.50, 2.75],\n            \"model_angles\": [175.0, 60.0]\n        },\n        # Case 2: boundary distances and tight coupling\n        {\n            \"calibrant_index\": 0, \"r_cal\": 2.50, \"I_cal\": 1.000,\n            \"intensities\": [1.000, 0.015625, 0.500],\n            \"delta_r\": 0.30, \"I_min\": 0.010,\n            \"karplus_params\": (7.9, -1.0, 0.6),\n            \"J_meas\": [8.8, 1.18], \"delta_J\": [0.3, 0.05],\n            \"model_distances\": [2.50, 5.30, 2.80],\n            \"model_angles\": [160.0, 70.0]\n        },\n        # Case 3: inconsistency\n        {\n            \"calibrant_index\": 0, \"r_cal\": 2.50, \"I_cal\": 1.000,\n            \"intensities\": [1.000, 0.500, 0.500],\n            \"delta_r\": 0.30, \"I_min\": 0.010,\n            \"karplus_params\": (7.9, -1.0, 0.6),\n            \"J_meas\": [9.5, 2.1], \"delta_J\": [0.3, 0.4],\n            \"model_distances\": [2.90, 3.40, 3.40],\n            \"model_angles\": [90.0, 120.0]\n        },\n        # Case 4: missing NOE, upper-bound only\n        {\n            \"calibrant_index\": 0, \"r_cal\": 2.50, \"I_cal\": 1.000,\n            \"intensities\": [1.000, None, 0.040],\n            \"delta_r\": 0.30, \"I_min\": 0.020,\n            \"karplus_params\": (7.9, -1.0, 0.6),\n            \"J_meas\": [9.2, 2.9], \"delta_J\": [0.5, 0.2],\n            \"model_distances\": [2.55, 4.70, 4.20],\n            \"model_angles\": [175.0, 120.0]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        is_consistent = check_consistency(case)\n        results.append(is_consistent)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef check_consistency(case_data):\n    \"\"\"\n    Checks if a single model is consistent with the given spectrometric data.\n\n    Args:\n        case_data (dict): A dictionary containing all parameters for a single test case.\n\n    Returns:\n        bool: True if the model is consistent, False otherwise.\n    \"\"\"\n    # Unpack data from the dictionary\n    r_cal = case_data[\"r_cal\"]\n    I_cal = case_data[\"I_cal\"]\n    intensities = case_data[\"intensities\"]\n    delta_r = case_data[\"delta_r\"]\n    I_min = case_data[\"I_min\"]\n    karplus_params = case_data[\"karplus_params\"]\n    J_meas = case_data[\"J_meas\"]\n    delta_J = case_data[\"delta_J\"]\n    model_distances = case_data[\"model_distances\"]\n    model_angles = case_data[\"model_angles\"]\n\n    # 1. Check NOE-derived distance restraints\n    for i, I_ij in enumerate(intensities):\n        d_model = model_distances[i]\n\n        if I_ij is None:  # Missing NOE peak (null intensity)\n            r_max = r_cal * (I_cal / I_min)**(1/6)\n            if d_model  r_max:\n                return False\n        else:  # Observed NOE peak\n            # It's assumed I_ij  0 for observed peaks.\n            r_ij = r_cal * (I_cal / I_ij)**(1/6)\n            lower_bound = r_ij - delta_r\n            upper_bound = r_ij + delta_r\n            if not (lower_bound = d_model = upper_bound):\n                return False\n\n    # 2. Check J-coupling-derived dihedral angle restraints\n    A, B, C = karplus_params\n    for i, phi_model_deg in enumerate(model_angles):\n        J_meas_k = J_meas[i]\n        delta_J_k = delta_J[i]\n\n        phi_rad = np.radians(phi_model_deg)\n        cos_phi = np.cos(phi_rad)\n        J_calc = A * cos_phi**2 + B * cos_phi + C\n\n        if abs(J_calc - J_meas_k)  delta_J_k:\n            return False\n\n    # If all checks passed, the model is consistent.\n    return True\n\nsolve()\n\n```"
        }
    ]
}