{
    "hands_on_practices": [
        {
            "introduction": "Choosing the right tool is the first step in any successful experiment. In the context of NMR-based structure determination, the choice between NOESY and ROESY experiments is critical and depends fundamentally on the physical properties of the molecule under study. This exercise  guides you through the decision-making process, linking molecular size and solvent viscosity to the rotational correlation time ($\\tau_c$) and demonstrating how the product $\\omega_0 \\tau_c$ governs the success or failure of a NOESY experiment.",
            "id": "3726081",
            "problem": "An organic chemist needs to extract reliable Nuclear Overhauser Effect (NOE) distance constraints from proton Nuclear Magnetic Resonance (NMR) data and must decide between Nuclear Overhauser Enhancement Spectroscopy (NOESY) and Rotating-frame Overhauser Effect Spectroscopy (ROESY). The choice depends on the molecular rotational correlation time $\\tau_c$ and its relationship to the proton Larmor angular frequency $\\omega_0$. Consider three samples measured at a proton frequency of $600$ MHz ($\\omega_0 = 2\\pi \\times 600 \\times 10^6$ rad/s) and temperature $T = 298$ K:\n\n- Sample X: a small organic molecule in methanol-$d_4$ with solvent dynamic viscosity $\\eta = 5.9 \\times 10^{-4}$ Pa$\\cdot$s, effective hydrodynamic radius $r = 0.35$ nm.\n- Sample Y: a macrocycle in dimethyl sulfoxide-$d_6$ with $\\eta = 2.0 \\times 10^{-3}$ Pa$\\cdot$s, $r = 0.75$ nm.\n- Sample Z: a peptide in an $80\\%$ glycerol-$d_8$ mixture with $\\eta = 1.0 \\times 10^{-2}$ Pa$\\cdot$s, $r = 1.0$ nm.\n\nAssume spherical hydrodynamics and estimate $\\tau_c$ from the Stokes–Einstein–Debye (SED) relation for rotational diffusion:\n$$\n\\tau_c = \\frac{4\\pi \\eta r^3}{3 k_B T},\n$$\nwhere $k_B$ is Boltzmann’s constant. The goal is to construct a decision tree that uses $\\tau_c$ estimates, and quantities derived from it, to select NOESY or ROESY in a way that yields robust, interpretable cross-peaks for quantitative distance restraint extraction across these samples.\n\nWhich decision tree below is most scientifically justified for this purpose at $600$ MHz, given the three samples and the physics of dipolar cross-relaxation?\n\nA. Compute $\\tau_c$ via the SED relation, then form the dimensionless parameter $\\omega_0 \\tau_c$. Use ROESY when $\\omega_0 \\tau_c$ indicates fast tumbling (e.g., $\\omega_0 \\tau_c \\lesssim 0.3$), avoid NOESY in the crossover regime (e.g., $0.3 \\lesssim \\omega_0 \\tau_c \\lesssim 1.5$) because laboratory-frame cross-relaxation attenuates or changes sign, and use NOESY when slow tumbling is indicated (e.g., $\\omega_0 \\tau_c \\gtrsim 1.5$). Validate chosen mixing times to suppress artifacts and spin diffusion.\n\nB. Choose NOESY whenever solvent viscosity satisfies $\\eta < 2.0 \\times 10^{-3}$ Pa$\\cdot$s and ROESY otherwise; field strength and $\\tau_c$ do not need to be considered because viscosity alone governs NOE behavior.\n\nC. Compute $\\tau_c$ and select ROESY for slow tumbling ($\\omega_0 \\tau_c \\gtrsim 1$) and NOESY for fast tumbling ($\\omega_0 \\tau_c \\lesssim 1$); this guarantees positive cross-peaks in the laboratory frame for small molecules.\n\nD. Estimate $\\tau_c$ using $\\tau_c = \\eta r / (k_B T)$, and pick NOESY when $\\tau_c$ is small and ROESY when $\\tau_c$ is large; the choice does not depend on $\\omega_0$ because rotating-frame effects remove frequency dependence.\n\nSelect the single best option.",
            "solution": "The choice between NOESY and ROESY experiments is fundamentally governed by the molecular tumbling regime, which is quantified by the dimensionless product of the proton Larmor frequency ($\\omega_0$) and the rotational correlation time ($\\tau_c$). The behavior of the NOESY cross-peak intensity depends critically on the value of $\\omega_0 \\tau_c$.\n\n**1. The Physics of NOESY vs. ROESY**\n\nThe laboratory-frame cross-relaxation rate ($\\sigma_{IS}$) responsible for the NOESY effect is proportional to the term $[6J(2\\omega_0) - J(0)]$, where $J(\\omega)$ is the spectral density function.\n-   For small molecules in the **fast tumbling limit** ($\\omega_0 \\tau_c \\ll 1$), this term is positive, yielding a positive NOE.\n-   For large molecules in the **slow tumbling limit** ($\\omega_0 \\tau_c \\gg 1$), this term is negative, yielding a negative NOE.\n-   Crucially, in the **intermediate tumbling regime**, where $\\omega_0 \\tau_c \\approx \\sqrt{5}/2 \\approx 1.12$, the term $[6J(2\\omega_0) - J(0)]$ becomes zero. This is the \"NOE null\" condition, where NOESY cross-peaks vanish, making the experiment useless for structure determination.\n\nThe rotating-frame cross-relaxation rate ($\\sigma_{ROE}$) for the ROESY experiment is proportional to a different combination of spectral density terms, such as $[2J(0) + 3J(\\omega_0)]$. Since all $J(\\omega)$ terms are non-negative, $\\sigma_{ROE}$ is always positive. ROESY does not have a null condition and is therefore the experiment of choice for molecules tumbling in the intermediate regime.\n\n**2. Calculating the Tumbling Regime for Each Sample**\n\nWe first calculate the rotational correlation time, $\\tau_c$, for each sample using the Stokes–Einstein–Debye (SED) relation: $\\tau_c = \\frac{4\\pi \\eta r^3}{3 k_B T}$.\nGiven: $\\omega_0 = 2\\pi \\times 600 \\times 10^6 \\text{ s}^{-1} \\approx 3.77 \\times 10^9 \\text{ s}^{-1}$ and $k_B T \\approx 4.114 \\times 10^{-21} \\text{ J}$ at $T = 298 \\text{ K}$.\n\n-   **Sample X:** $\\tau_c = \\frac{4\\pi (5.9 \\times 10^{-4} \\text{ Pa}\\cdot\\text{s})(0.35 \\times 10^{-9} \\text{ m})^3}{3(4.114 \\times 10^{-21} \\text{ J})} \\approx 2.57 \\times 10^{-11} \\text{ s}$.\n    $\\omega_0 \\tau_c \\approx 0.097$. This is the **fast tumbling regime**. NOESY is suitable.\n\n-   **Sample Y:** $\\tau_c = \\frac{4\\pi (2.0 \\times 10^{-3} \\text{ Pa}\\cdot\\text{s})(0.75 \\times 10^{-9} \\text{ m})^3}{3(4.114 \\times 10^{-21} \\text{ J})} \\approx 8.60 \\times 10^{-10} \\text{ s}$.\n    $\\omega_0 \\tau_c \\approx 3.24$. This is the **slow tumbling regime**. NOESY is suitable.\n\n-   **Sample Z:** $\\tau_c = \\frac{4\\pi (1.0 \\times 10^{-2} \\text{ Pa}\\cdot\\text{s})(1.0 \\times 10^{-9} \\text{ m})^3}{3(4.114 \\times 10^{-21} \\text{ J})} \\approx 1.02 \\times 10^{-8} \\text{ s}$.\n    $\\omega_0 \\tau_c \\approx 38.5$. This is deep in the **slow tumbling regime**. NOESY is suitable.\n\nAlthough the given samples fall into the fast and slow regimes where NOESY works, a general decision tree must account for the critical intermediate regime.\n\n**3. Evaluating the Decision Trees**\n\n*   **A:** This option correctly identifies $\\omega_0 \\tau_c$ as the key parameter and crucially recommends avoiding NOESY in the crossover regime ($0.3 \\lesssim \\omega_0 \\tau_c \\lesssim 1.5$), where it fails. It correctly recommends NOESY for slow tumbling. Its recommendation to use ROESY for fast tumbling is valid, although NOESY is also common. This is the most robust and scientifically sound strategy.\n\n*   **B:** This option is incorrect. It ignores the molecular radius ($r$) and the spectrometer frequency ($\\omega_0$), both of which are critical factors. Viscosity alone does not determine the tumbling regime.\n\n*   **C:** This option is flawed because it fails to identify the NOE null region. Suggesting a sharp switch at $\\omega_0 \\tau_c = 1$ is an oversimplification and would lead to failed experiments for molecules with $\\omega_0 \\tau_c$ near $1.12$.\n\n*   **D:** This option uses an incorrect formula for $\\tau_c$ (it should be proportional to $r^3$, not $r$) and falsely claims the choice is independent of $\\omega_0$. This contradicts the fundamental physics of the NOE.\n\n**Conclusion:**\nThe most scientifically justified decision tree is presented in Option A. It correctly uses the parameter $\\omega_0 \\tau_c$ to diagnose the tumbling regime and, most importantly, provides a strategy to explicitly avoid the NOE null condition where NOESY experiments fail.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Obtaining experimental data is only half the battle; the other half is correct interpretation. NOESY spectra can be complex, containing artifacts like spin diffusion that can be mistaken for genuine through-space contacts, leading to incorrect structural conclusions. This practice  places you in the role of a structural chemist troubleshooting a common and challenging scenario: reconciling experimental NOEs with proposed structural models. By designing a logical sequence of diagnostic experiments, you will learn to systematically disentangle resonance misassignments, spin diffusion artifacts, and incorrect stereochemistry.",
            "id": "3726092",
            "problem": "An organic compound of molecular mass approximately $500$ u is analyzed in deuterated chloroform by Nuclear Overhauser Effect Spectroscopy (NOESY), yielding a set of Nuclear Overhauser Effect (NOE)-derived upper-bound distance constraints used for three-dimensional structure determination. The molecule has two stereocenters, and two diastereomeric candidates, denoted $S_1$ and $S_2$, are under consideration. A restrained distance geometry calculation using the NOE constraints exhibits a consistent subset of violations: several cross-peaks assigned between $H_A$ and $H_B$ and between $H_M$ and $H_N$ are present at mixing time $\\tau_m = 300$ ms but absent at $\\tau_m = 30$ ms, while a cross-peak assigned between $H_X$ and $H_Y$ is robust already at $\\tau_m = 30$ ms and grows monotonically with increasing $\\tau_m$. Model distances from conformational ensembles predict $r_{AB}^{S_1} \\approx 4.5 \\text{ \\AA}$ and $r_{AB}^{S_2} \\approx 4.8 \\text{ \\AA}$; $r_{MN}^{S_1} \\approx 4.2 \\text{ \\AA}$ and $r_{MN}^{S_2} \\approx 4.4 \\text{ \\AA}$; and $r_{XY}^{S_1} \\approx 2.5 \\text{ \\AA}$ while $r_{XY}^{S_2} \\approx 3.6 \\text{ \\AA}$. The violated constraints are persistent across different sample concentrations and temperatures within a small range.\n\nDesign a diagnostic strategy to determine whether these persistent NOE constraint violations arise primarily from resonance misassignments, spin diffusion artifacts, or incorrect stereochemistry. Select the option that most effectively separates these possibilities based on first principles and practical experiment design. Each option proposes a set of ordered steps; choose the set that, if executed, would allow you to attribute the cause(s) with high confidence.\n\nA. Acquire only long-mixing-time NOESY (e.g., $\\tau_m \\ge 300$ ms) to maximize sensitivity to weak contacts; convert peak volumes to distances assuming proportionality to $r^{-3}$; accept any cross-peak that appears only at long $\\tau_m$ as evidence for the corresponding short proton-proton distance and use these distances to discriminate $S_1$ and $S_2$ without further assignment checks.\n\nB. Record NOESY at multiple $\\tau_m$ values spanning the initial buildup regime (e.g., $\\tau_m = 20, 40, 60$ ms) and fit each suspect cross-peak to its initial rate of growth; perform selective one-dimensional NOE experiments to isolate direct transfers for the same pairs; re-verify resonance assignments with $^{13}\\mathrm{C}$-edited Heteronuclear Single Quantum Coherence (HSQC), Heteronuclear Multiple Bond Correlation (HMBC), and Total Correlation Spectroscopy (TOCSY) to resolve chemical shift degeneracies; where appropriate, acquire Rotating-frame Overhauser Effect Spectroscopy (ROESY) to handle the motional regime; then evaluate network consistency of the resulting $r^{-6}$-weighted distances against $S_1$ and $S_2$, and supplement with vicinal scalar coupling (${}^{3}J$) analysis for key dihedrals.\n\nC. Replace NOESY with only long spin-lock Rotating-frame Overhauser Effect Spectroscopy (ROESY) and assign any cross-peak that persists at long spin-lock times as an unequivocal direct NOE; for remaining violations, conclude incorrect stereochemistry without additional assignment verification or mixing-time dependence analysis.\n\nD. Increase the temperature to reduce correlation time and collect Diffusion Ordered Spectroscopy (DOSY) to check for molecular aggregation; if diffusion coefficients are uniform, declare spin diffusion negligible and attribute all violations to misassignments, without performing additional correlation experiments or mixing-time series.\n\nChoose the single best option.",
            "solution": "The problem asks for a diagnostic strategy to resolve persistent NOE constraint violations, which could stem from resonance misassignments, spin diffusion artifacts, or an incorrect stereochemical model. A rigorous analysis of the provided data points towards a primary cause and informs the best experimental path forward.\n\n**1. A Priori Analysis of the Experimental Data**\n\nThe key to diagnosing the problem lies in the mixing time ($\\tau_m$) dependence of the observed NOE cross-peaks.\n\n*   **The $H_X - H_Y$ Cross-Peak:** This peak is \"robust already at $\\tau_m = 30 \\text{ ms}$\". The intensity of a direct NOE in the initial buildup phase is approximately proportional to $\\tau_m / r^6$. A strong, rapidly appearing peak is indicative of a short proton-proton distance. Comparing the candidate models, $r_{XY}^{S_1} \\approx 2.5 \\text{ \\AA}$ is a short distance that would produce a strong, direct NOE, while $r_{XY}^{S_2} \\approx 3.6 \\text{ \\AA}$ is significantly longer. The NOE for the latter would be weaker by a factor of approximately $(3.6/2.5)^6 \\approx 13.6$, making it unlikely to be robust at a short mixing time. This single observation provides strong evidence in favor of diastereomer $S_1$.\n\n*   **The $H_A - H_B$ and $H_M - H_N$ Cross-Peaks:** These peaks are \"absent at $\\tau_m = 30 \\text{ ms}$ but present at $\\tau_m = 300 \\text{ ms}$\". This kinetic profile is the classic signature of **spin diffusion**. Magnetization is not transferred directly from A to B, but via one or more intermediate protons (e.g., A $\\to$ C $\\to$ B). The rate of this two-step process has a quadratic dependence on $\\tau_m$ initially, meaning the intensity is negligible at short mixing times but grows significantly at longer times. The long distances predicted by both models ($r > 4.2 \\text{ \\AA}$) are consistent with the absence of a direct NOE. The \"violations\" likely arise from the erroneous use of these spin diffusion peaks as direct, short-range constraints.\n\n**2. Evaluation of Diagnostic Strategies**\n\nA successful strategy must first confirm resonance assignments, then rigorously distinguish direct NOEs from spin diffusion, and finally use the validated constraints to select the correct stereoisomer.\n\n*   **Option A:** This strategy is fundamentally flawed. It maximizes spin diffusion by using only long mixing times, uses an incorrect distance dependence ($r^{-3}$ instead of $r^{-6}$), and repeats the initial error of treating all peaks as direct NOEs. This approach would only compound the existing problems.\n\n*   **Option B:** This option presents a comprehensive and scientifically sound workflow.\n    1.  **NOE Buildup Curves:** Recording a series of NOESY spectra at short mixing times allows for fitting the initial buildup rates. This is the definitive method for distinguishing linear-buildup direct NOEs from quadratic-buildup spin diffusion peaks.\n    2.  **Assignment Verification:** Using standard 2D experiments like TOCSY, HSQC, and HMBC is a non-negotiable step to rule out resonance misassignments, which can mimic or obscure true structural effects.\n    3.  **ROESY:** A molecule with a mass of ~$500 \\text{ u}$ in chloroform is likely in or near the intermediate tumbling regime where the standard NOE is null ($\\omega_0\\tau_c \\approx 1.12$). ROESY experiments circumvent this issue, providing a reliable source of cross-peaks.\n    4.  **Complementary Data:** Using ${}^{3}J$ couplings provides information on dihedral angles, offering an independent set of geometric constraints that are orthogonal to the distance information from NOEs.\n    This multi-faceted approach systematically eliminates all sources of ambiguity.\n\n*   **Option C:** This strategy is insufficient. While ROESY is useful, it is not immune to artifacts (e.g., TOCSY transfers at long spin-lock times). Relying only on a long mixing time experiment, even ROESY, is problematic. Most importantly, it completely neglects the critical step of verifying resonance assignments.\n\n*   **Option D:** This strategy contains a critical logical error. It incorrectly equates the absence of aggregation (which DOSY can detect) with the absence of spin diffusion. Spin diffusion is an *intramolecular* process that occurs regardless of aggregation state. This option fails to address the actual mechanism of spin diffusion and skips necessary assignment checks.\n\n**Conclusion:**\nOption B is the only strategy that provides a complete, rigorous, and methodologically sound plan to systematically deconvolve the observed discrepancies. It correctly prioritizes confirming resonance assignments and quantifying NOE buildup rates to eliminate artifacts, thereby generating a reliable set of constraints for accurate stereochemical determination.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "To achieve a truly quantitative understanding of NOE dynamics, especially in complex spin systems where spin diffusion is prominent, we must go beyond simple approximations and embrace a full computational model. The evolution of spin magnetizations is most accurately described by the full relaxation matrix, whose exponentiation predicts the intensity of every cross-peak at a given mixing time. This hands-on coding practice  will allow you to implement this powerful simulation, connecting the abstract theory of the Solomon equations to the concrete numerical values you would observe in a spectrum.",
            "id": "3726036",
            "problem": "A proton network observed by Nuclear Magnetic Resonance (NMR) during the Nuclear Overhauser Effect (NOE) mixing period can be modeled using a full relaxation matrix framework. Consider a system of $n$ coupled proton longitudinal magnetizations, collected in a vector $\\mathbf{M}(t) \\in \\mathbb{R}^n$, evolving during the mixing period under a time-invariant linear system. The full relaxation matrix $\\mathbf{R} \\in \\mathbb{R}^{n \\times n}$ encodes auto-relaxation rates on the diagonal and cross-relaxation rates on the off-diagonal, and the mixing time is $t_m$ expressed in seconds. The cross-peak intensity from spin $j$ to spin $i$ at the end of the mixing period is defined here as the element of the time-propagation operator that transfers magnetization from component $j$ to component $i$ when the initial condition is unit magnetization on component $j$ and zero on all others; equivalently, it is the off-diagonal element of the propagator evaluated at time $t_m$.\n\nStarting from the coupled first-order linear ordinary differential equation $\\frac{d\\mathbf{M}}{dt} = -\\mathbf{R}\\,\\mathbf{M}$ and the definition of the matrix exponential as the unique solution operator for such a linear system with time-invariant coefficients, derive an algorithm to compute the propagator at time $t_m$ and then extract the cross-peak intensities as the off-diagonal entries. Implement this algorithm numerically for the following test suite. In each test, compute the matrix exponential of $-\\mathbf{R}\\,t_m$ via orthogonal diagonalization of $\\mathbf{R}$ (the matrices given are symmetric), obtain the propagator $\\mathbf{P}(t_m)$, and extract the specified off-diagonal entries $\\mathbf{P}_{i j}(t_m)$ as ordered below. Express all final numerical results as dimensionless floating-point numbers, rounded to $6$ decimal places. The mixing time $t_m$ must be treated in seconds.\n\nTest Suite:\n- Test $1$ (happy path): $n=3$, with\n  $\\mathbf{R} = \\begin{bmatrix}\n  1.00 & -0.05 & -0.02 \\\\\n  -0.05 & 0.90 & -0.03 \\\\\n  -0.02 & -0.03 & 1.10\n  \\end{bmatrix}$ in $\\mathrm{s}^{-1}$, and $t_m = 0.50$ $\\mathrm{s}$. Extract the off-diagonal entries in this order: $(1,2),(1,3),(2,1),(2,3),(3,1),(3,2)$, meaning extract $\\mathbf{P}_{1,2}$ then $\\mathbf{P}_{1,3}$ then $\\mathbf{P}_{2,1}$, and so on.\n\n- Test $2$ (edge case, zero cross-relaxation): $n=3$, with\n  $\\mathbf{R} = \\begin{bmatrix}\n  1.00 & 0.00 & 0.00 \\\\\n  0.00 & 0.80 & 0.00 \\\\\n  0.00 & 0.00 & 1.20\n  \\end{bmatrix}$ in $\\mathrm{s}^{-1}$, and $t_m = 0.50$ $\\mathrm{s}$. Extract entries in the same order: $(1,2),(1,3),(2,1),(2,3),(3,1),(3,2)$.\n\n- Test $3$ (boundary condition, zero mixing time): $n=3$, with\n  $\\mathbf{R} = \\begin{bmatrix}\n  1.10 & -0.04 & -0.01 \\\\\n  -0.04 & 1.00 & -0.02 \\\\\n  -0.01 & -0.02 & 0.90\n  \\end{bmatrix}$ in $\\mathrm{s}^{-1}$, and $t_m = 0.00$ $\\mathrm{s}$. Extract entries in the same order: $(1,2),(1,3),(2,1),(2,3),(3,1),(3,2)$.\n\n- Test $4$ (stronger coupling, $4$ spins): $n=4$, with\n  $\\mathbf{R} = \\begin{bmatrix}\n  1.20 & -0.12 & -0.08 & 0.00 \\\\\n  -0.12 & 1.00 & -0.10 & -0.06 \\\\\n  -0.08 & -0.10 & 0.90 & -0.09 \\\\\n  0.00 & -0.06 & -0.09 & 1.10\n  \\end{bmatrix}$ in $\\mathrm{s}^{-1}$, and $t_m = 1.00$ $\\mathrm{s}$. Extract the off-diagonal entries in this order: $(1,2),(1,3),(1,4),(2,1),(2,3),(2,4),(3,1),(3,2),(3,4),(4,1),(4,2),(4,3)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3]$). The list must contain the rounded floating-point values for all requested entries across the four tests, concatenated in the exact extraction order specified above for each test. There should be no additional text printed before or after this line.",
            "solution": "The problem requires implementing an algorithm to simulate the evolution of nuclear spin magnetizations during an NOE experiment using the full relaxation matrix formalism. The core of the task is to compute the propagator matrix, $\\mathbf{P}(t_m) = e^{-\\mathbf{R}t_m}$, and extract its off-diagonal elements.\n\n**1. Algorithm Derivation**\n\nThe evolution of the magnetization vector $\\mathbf{M}(t)$ is given by the linear ordinary differential equation $\\frac{d\\mathbf{M}}{dt} = -\\mathbf{R}\\mathbf{M}$. The solution is $\\mathbf{M}(t_m) = e^{-\\mathbf{R}t_m} \\mathbf{M}(0)$. The propagator matrix is thus $\\mathbf{P}(t_m) = e^{-\\mathbf{R}t_m}$.\n\nThe problem specifies computing the matrix exponential via orthogonal diagonalization. Since the relaxation matrix $\\mathbf{R}$ is real and symmetric, it can be diagonalized as:\n$$\n\\mathbf{R} = \\mathbf{V} \\mathbf{\\Lambda} \\mathbf{V}^T\n$$\nwhere $\\mathbf{\\Lambda}$ is the diagonal matrix of eigenvalues ($\\lambda_k$) and $\\mathbf{V}$ is the orthogonal matrix of corresponding eigenvectors.\n\nThe exponential of the matrix $-\\mathbf{R}t_m$ can then be calculated as:\n$$\n\\mathbf{P}(t_m) = e^{-\\mathbf{R}t_m} = e^{-(\\mathbf{V}\\mathbf{\\Lambda}\\mathbf{V}^T)t_m} = \\mathbf{V} e^{-\\mathbf{\\Lambda}t_m} \\mathbf{V}^T\n$$\nThe term $e^{-\\mathbf{\\Lambda}t_m}$ is a diagonal matrix with elements $[e^{-\\mathbf{\\Lambda}t_m}]_{kk} = e^{-\\lambda_k t_m}$.\n\nThe computational steps are:\n1.  For a given matrix $\\mathbf{R}$ and time $t_m$, first compute the eigendecomposition of $\\mathbf{R}$ to find eigenvalues $\\mathbf{\\Lambda}$ and eigenvectors $\\mathbf{V}$.\n2.  Construct a new diagonal matrix, $\\mathbf{D}_{\\text{exp}}$, with diagonal elements $e^{-\\lambda_k t_m}$.\n3.  Calculate the propagator matrix $\\mathbf{P}(t_m)$ via the matrix product $\\mathbf{V} \\mathbf{D}_{\\text{exp}} \\mathbf{V}^T$.\n4.  Extract the required off-diagonal elements from $\\mathbf{P}(t_m)$ and round them to 6 decimal places.\n\n**2. Analytical Checks for Special Cases**\n\n*   **Test 2 (Diagonal R):** When $\\mathbf{R}$ is diagonal, its eigenvectors are the standard basis vectors, so $\\mathbf{V}=\\mathbf{I}$. The propagator is $\\mathbf{P}(t_m) = e^{-\\mathbf{R}t_m}$, which is also a diagonal matrix. All off-diagonal elements must be $0.0$.\n*   **Test 3 (Zero Mixing Time):** When $t_m=0$, the propagator is $\\mathbf{P}(0) = e^{\\mathbf{0}} = \\mathbf{I}$ (the identity matrix). All off-diagonal elements must be $0.0$.\n\nThese theoretical predictions are confirmed by the numerical implementation. The provided Python code correctly implements this algorithm using `numpy.linalg.eigh` for stable eigendecomposition of symmetric matrices and performs the matrix multiplications to yield the final results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the specified off-diagonal elements of the NOE propagator matrix\n    for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"id\": 1,\n            \"R\": np.array([\n                [1.00, -0.05, -0.02],\n                [-0.05, 0.90, -0.03],\n                [-0.02, -0.03, 1.10]\n            ]),\n            \"tm\": 0.50,\n            \"indices\": [(1, 2), (1, 3), (2, 1), (2, 3), (3, 1), (3, 2)]\n        },\n        {\n            \"id\": 2,\n            \"R\": np.array([\n                [1.00, 0.00, 0.00],\n                [0.00, 0.80, 0.00],\n                [0.00, 0.00, 1.20]\n            ]),\n            \"tm\": 0.50,\n            \"indices\": [(1, 2), (1, 3), (2, 1), (2, 3), (3, 1), (3, 2)]\n        },\n        {\n            \"id\": 3,\n            \"R\": np.array([\n                [1.10, -0.04, -0.01],\n                [-0.04, 1.00, -0.02],\n                [-0.01, -0.02, 0.90]\n            ]),\n            \"tm\": 0.00,\n            \"indices\": [(1, 2), (1, 3), (2, 1), (2, 3), (3, 1), (3, 2)]\n        },\n        {\n            \"id\": 4,\n            \"R\": np.array([\n                [1.20, -0.12, -0.08, 0.00],\n                [-0.12, 1.00, -0.10, -0.06],\n                [-0.08, -0.10, 0.90, -0.09],\n                [0.00, -0.06, -0.09, 1.10]\n            ]),\n            \"tm\": 1.00,\n            \"indices\": [(1, 2), (1, 3), (1, 4), (2, 1), (2, 3), (2, 4), (3, 1), (3, 2), (3, 4), (4, 1), (4, 2), (4, 3)]\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        R = case[\"R\"]\n        tm = case[\"tm\"]\n        indices = case[\"indices\"]\n        n = R.shape[0]\n\n        # The propagator P(t_m) is the matrix exponential of -R*t_m.\n        # We compute this via diagonalization of R: P = V * exp(-Lambda*t_m) * V^T\n        \n        # Handle the trivial boundary case t_m = 0, where P(0) = Identity matrix.\n        if tm == 0.0:\n            P = np.identity(n)\n        else:\n            # Step 1: Eigendecomposition of the symmetric matrix R.\n            # np.linalg.eigh is used for Hermitian (or real symmetric) matrices.\n            # It returns eigenvalues in `eigenvalues` and eigenvectors as columns of `V`.\n            eigenvalues, V = np.linalg.eigh(R)\n            \n            # Step 2: Construct the diagonal matrix from the exponentiated eigenvalues.\n            # The diagonal elements are exp(-lambda_k * t_m).\n            exp_lambda_diag = np.exp(-eigenvalues * tm)\n            D_exp = np.diag(exp_lambda_diag)\n            \n            # Step 3: Reconstruct the propagator matrix P(t_m) = V * D_exp * V^T.\n            # V.T is the transpose of V, which is also its inverse since V is orthogonal.\n            P = V @ D_exp @ V.T\n\n        # Step 4: Extract the specified off-diagonal elements.\n        for i, j in indices:\n            # Convert from 1-based to 0-based indexing for numpy arrays\n            val = P[i-1, j-1]\n            # Round to 6 decimal places as required.\n            rounded_val = round(val, 6)\n            all_results.append(rounded_val)\n\n    # Format the final output as a single comma-separated list in brackets.\n    # Using str() is sufficient for converting the rounded floats to the required string format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}