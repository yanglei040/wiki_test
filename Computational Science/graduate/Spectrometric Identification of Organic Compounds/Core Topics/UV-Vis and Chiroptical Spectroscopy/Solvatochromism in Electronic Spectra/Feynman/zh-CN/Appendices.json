{
    "hands_on_practices": [
        {
            "introduction": "理论模型不仅是抽象概念，更是连接实验数据与物理参数的强大工具。本练习将引导你运用Lippert-Mataga方程，从溶剂化红移数据中提取分子激发态偶极矩的变化量 ()。此过程不仅涉及公式推导，还强调了如何进行不确定性传播，这是定量实验科学中的一项核心技能，可以帮助我们评估所提取物理参数的可信度。",
            "id": "3723883",
            "problem": "一种推拉式有机染料在其电子吸收和荧光最大值上表现出强烈的溶剂依赖性位移。在溶剂化显色效应的介电连续谱模型中，将溶质建模为一个嵌入在球形空腔内的电偶极子，该空腔半径为 $a$，位于一个均匀、各向同性的介质中，介质的特征是静态介电常数 $\\varepsilon$ 和折射率 $n$。斯托克斯位移被定义为吸收和发射谱带最大值之间的波数差，在一系列溶剂中，观测到它与溶剂极性函数 $\\Delta f \\equiv \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^{2} - 1}{2n^{2} + 1}$ 呈线性变化。\n\n测得的斯托克斯位移（以波数为单位）对 $\\Delta f$ 的线性回归得出的斜率为 $S$，截距为 $C$；本任务不需要截距。回归得到的斜率为 $S = (2.50 \\pm 0.04) \\times 10^{3}~\\mathrm{cm}^{-1}$，其中不确定度为标准不确定度，$\\Delta f$ 是无量纲的。通过溶质分子建模独立确定的空腔半径为 $a = (6.00 \\pm 0.20)~\\mathrm{\\AA}$，其不确定度为标准不确定度。假设 $S$ 和 $a$ 是统计独立的，并且它们的不确定度足够小，可以应用一阶（高斯）不确定度传播。\n\n从介电连续谱反应场框架（即 Onsager 模型）和将能量位移与波数联系起来的成熟光谱学原理出发，推导一个将斜率 $S$ 与基态和激发电子态之间的永久偶极矩变化 $\\Delta \\mu$ 联系起来的表达式。使用此表达式求得以库仑-米为单位的 $\\Delta \\mu$，并将其转换为 Light–Debye（德拜）单位，给定 $1~\\mathrm{D} = 3.33564 \\times 10^{-30}~\\mathrm{C \\cdot m}$。对于物理常数，请使用国际单位制（SI）的值 $h = 6.62607015 \\times 10^{-34}~\\mathrm{J \\cdot s}$，$c = 2.99792458 \\times 10^{8}~\\mathrm{m \\cdot s^{-1}}$，以及 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}~\\mathrm{F \\cdot m^{-1}}$。\n\n然后，通过对您推导的表达式明确应用不确定度传播，计算 $\\Delta \\mu$ 的合成相对标准不确定度，结果为一个无量纲的小数。将最终答案四舍五入到四位有效数字。最终答案必须表示为一个不带单位的小数。",
            "solution": "根据验证标准评估问题陈述。\n\n### 步骤 1：提取已知条件\n-   **模型**：一个电偶极子溶质位于半径为 $a$ 的球形空腔内，该空腔处于一个均匀、各向同性的介质中，介质的静态介电常数为 $\\varepsilon$，折射率为 $n$。\n-   **斯托克斯位移**：定义为吸收和发射谱带最大值之间的波数差，$\\Delta\\tilde{\\nu}_{SS}$。\n-   **溶剂极性函数**：$\\Delta f \\equiv \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^{2} - 1}{2n^{2} + 1}$。\n-   **实验观察**：$\\Delta\\tilde{\\nu}_{SS}$（单位 $\\mathrm{cm}^{-1}$）对 $\\Delta f$ 的线性回归得到斜率 $S = (2.50 \\pm 0.04) \\times 10^{3}~\\mathrm{cm}^{-1}$ 和截距 $C$（不需要）。\n-   **空腔半径**：$a = (6.00 \\pm 0.20)~\\mathrm{\\AA}$。\n-   **统计假设**：$S$ 和 $a$ 是统计独立的，且适用一阶（高斯）不确定度传播。\n-   **目标 1**：推导一个将斜率 $S$ 与基态和激发电子态之间的永久偶极矩变化 $\\Delta \\mu$ 联系起来的表达式。\n-   **目标 2**：计算 $\\Delta \\mu$ 的合成相对标准不确定度，结果为无量纲小数，四舍五入到四位有效数字。\n-   **常数**：\n    -   $1~\\mathrm{D} = 3.33564 \\times 10^{-30}~\\mathrm{C \\cdot m}$。\n    -   $h = 6.62607015 \\times 10^{-34}~\\mathrm{J \\cdot s}$。\n    -   $c = 2.99792458 \\times 10^{8}~\\mathrm{m \\cdot s^{-1}}$。\n    -   $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}~\\mathrm{F \\cdot m^{-1}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学性**：该问题基于溶剂化显色效应的 Lippert-Mataga 模型，这是物理化学和光物理学中一个公认的理论。所有概念和参数（$\\varepsilon$、$n$、$\\mu$、$a$）都是标准的科学量。该模型是一个有效且广泛使用的近似方法。\n-   **适定性**：问题陈述清晰，提供了推导所需表达式和计算不确定度所需的所有数据、常数和统计假设。目标明确，能得出一个唯一且有意义的答案。\n-   **客观性**：该问题使用精确、明确的科学语言表述，不含主观或基于观点的内容。\n\n该问题没有表现出验证标准中列出的任何缺陷（例如，科学上不健全、不完整、模棱两可）。这是一个物理化学中标准的、可解的问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供完整的解决方案。\n\n斯托克斯位移 $\\Delta\\tilde{\\nu}_{SS}$ 是吸收最大值（$\\tilde{\\nu}_{abs}$）和荧光最大值（$\\tilde{\\nu}_{flu}$）之间的波数差，在介电连续谱模型中由 Lippert-Mataga 方程描述。该方程将斯托克斯位移与溶质和溶剂的性质联系起来。假设溶质在基态的偶极矩 $\\vec{\\mu}_g$ 和在第一激发态的偶极矩 $\\vec{\\mu}_e$ 是平行的，则方程为：\n$$\n\\Delta\\tilde{\\nu}_{SS} = \\tilde{\\nu}_{abs} - \\tilde{\\nu}_{flu} = \\frac{2(\\mu_e - \\mu_g)^2}{hc(4\\pi\\varepsilon_0)a^3} \\left( \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^2 - 1}{2n^2 + 1} \\right)\n$$\n这里，$h$ 是普朗克常数，$c$ 是真空中的光速，$\\varepsilon_0$ 是真空介电常数，$a$ 是包含溶质的 Onsager 空腔的半径。偶极矩大小的变化表示为 $\\Delta\\mu = |\\mu_e - \\mu_g|$。\n\n问题将溶剂极性函数定义为 $\\Delta f \\equiv \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^2 - 1}{2n^2 + 1}$。将此定义和 $\\Delta\\mu$ 代入 Lippert-Mataga 方程，得到：\n$$\n\\Delta\\tilde{\\nu}_{SS} = \\frac{2(\\Delta\\mu)^2}{hc(4\\pi\\varepsilon_0)a^3} \\Delta f\n$$\n问题指出，$\\Delta\\tilde{\\nu}_{SS}$ 对 $\\Delta f$ 的实验作图得到一条斜率为 $S$ 的直线。通过将理论表达式与经验线性关系 $\\Delta\\tilde{\\nu}_{SS} = S \\cdot \\Delta f + C$ 进行比较，我们可以确定斜率 $S$ 为：\n$$\nS = \\frac{2(\\Delta\\mu)^2}{hc(4\\pi\\varepsilon_0)a^3}\n$$\n这是第一个要求的表达式，它将实验斜率 $S$ 与偶极矩变化 $\\Delta\\mu$ 联系起来。\n\n下一个任务是使用这个表达式来求 $\\Delta\\mu$ 并计算其相对不确定度。我们首先重新整理方程以求解 $\\Delta\\mu$：\n$$\n(\\Delta\\mu)^2 = \\frac{S \\cdot h c (4\\pi\\varepsilon_0) a^3}{2}\n$$\n$$\n\\Delta\\mu = \\sqrt{\\frac{S \\cdot h c (4\\pi\\varepsilon_0) a^3}{2}}\n$$\n为了确定 $\\Delta\\mu$ 的合成相对标准不确定度，我们应用一阶不确定度传播规则。量 $h$、$c$、$\\varepsilon_0$、$\\pi$ 和 $2$ 是没有不确定度的常数。因此，$\\Delta\\mu$ 的不确定度来源于测量量 $S$ 和 $a$ 的不确定度。设 $u(x)$ 表示量 $x$ 的标准不确定度，$u_r(x) = u(x)/|x|$ 表示其相对标准不确定度。\n\n$\\Delta\\mu$ 的表达式可以写成 $\\Delta\\mu = K \\cdot S^{1/2} \\cdot a^{3/2}$，其中 $K = \\sqrt{hc(4\\pi\\varepsilon_0)/2}$ 是一个常数。对于形式为 $Y = C \\cdot X_1^{p_1} \\cdot X_2^{p_2}$ 的函数，其中 $X_1$ 和 $X_2$ 是独立变量，$Y$ 的相对不确定度的平方由下式给出：\n$$\n(u_r(Y))^2 = p_1^2 (u_r(X_1))^2 + p_2^2 (u_r(X_2))^2\n$$\n将此应用于我们的 $\\Delta\\mu$ 表达式，变量为 $S$ 和 $a$，指数分别为 $p_1 = 1/2$ 和 $p_2 = 3/2$，我们得到：\n$$\n(u_r(\\Delta\\mu))^2 = \\left(\\frac{1}{2}\\right)^2 (u_r(S))^2 + \\left(\\frac{3}{2}\\right)^2 (u_r(a))^2 = \\frac{1}{4}(u_r(S))^2 + \\frac{9}{4}(u_r(a))^2\n$$\n我们现在根据给定数据计算 $S$ 和 $a$ 的相对不确定度。注意，在计算相对不确定度时，单位会抵消，因此此步骤不需要单位转换。\n\n对于斜率 $S$：\n$S = 2.50 \\times 10^3~\\mathrm{cm}^{-1}$ 且 $u(S) = 0.04 \\times 10^3~\\mathrm{cm}^{-1}$。\n$$\nu_r(S) = \\frac{u(S)}{S} = \\frac{0.04 \\times 10^3}{2.50 \\times 10^3} = \\frac{0.04}{2.50} = 0.016\n$$\n对于空腔半径 $a$：\n$a = 6.00~\\mathrm{\\AA}$ 且 $u(a) = 0.20~\\mathrm{\\AA}$。\n$$\nu_r(a) = \\frac{u(a)}{a} = \\frac{0.20}{6.00} = \\frac{1}{30}\n$$\n现在我们将这些值代入 $\\Delta\\mu$ 的相对不确定度方程：\n$$\n(u_r(\\Delta\\mu))^2 = \\frac{1}{4}(0.016)^2 + \\frac{9}{4}\\left(\\frac{1}{30}\\right)^2\n$$\n$$\n(u_r(\\Delta\\mu))^2 = \\frac{1}{4}(0.000256) + \\frac{9}{4}\\left(\\frac{1}{900}\\right)\n$$\n$$\n(u_r(\\Delta\\mu))^2 = 0.000064 + \\frac{1}{400} = 0.000064 + 0.0025\n$$\n$$\n(u_r(\\Delta\\mu))^2 = 0.002564\n$$\n$\\Delta\\mu$ 的合成相对标准不确定度是该值的平方根：\n$$\nu_r(\\Delta\\mu) = \\sqrt{0.002564} \\approx 0.05063595\n$$\n按要求将此结果四舍五入到四位有效数字，得到 $0.05064$。",
            "answer": "$$\n\\boxed{0.05064}\n$$"
        },
        {
            "introduction": "当物理模型过于简化或复杂时，基于线性自由能关系的经验模型提供了一种实用且强大的替代方案。Kamlet-Taft多参数方法将溶剂效应分解为极性/可极化性 ($\\pi^*$)、氢键给体酸度 ($\\alpha$) 和氢键受体碱度 ($\\beta$)，被广泛应用于化学领域。通过这个练习 ()，你将通过构建多元线性回归模型来实践数据驱动的建模，并利用它来预测未知体系的性质。",
            "id": "3723875",
            "problem": "考虑一种电荷转移有机染料，在多种溶剂中测量其最低能量的电子吸收谱带最大值，以表征其溶剂化显色行为。在 Kamlet–Taft 多参数方法中，溶剂的影响由三个描述符来描述：氢键供体酸度 $\\alpha$、氢键受体碱度 $\\beta$ 以及极性/极化率 $\\pi^\\ast$。假设溶剂通过特异性和非特异性相互作用来改变跃迁能量，这些相互作用可以通过波数对这些描述符的一阶线性响应来捕捉。电子跃迁能量 $E$ 与真空电磁关系满足 $E = h c \\tilde{\\nu}$，其中 $h$ 是普朗克常数，$c$ 是光速，$\\tilde{\\nu}$ 是波数。以纳米为单位的波长 $\\lambda$ 与以反厘米为单位的波数之间的关系为 $\\tilde{\\nu} = 10^7 / \\lambda$。\n\n使用一组具有已知描述符和实测谱带最大值波数 $\\tilde{\\nu}$ 的校准溶剂集，通过最小化模型计算的 $\\tilde{\\nu}$ 值与实测值之间的偏差平方和，来估计一个截距和三个系数。这些参数共同定义了从 $(\\pi^\\ast,\\alpha,\\beta)$ 到 $\\tilde{\\nu}$ 的仿射线性映射。然后，使用拟合好的模型预测新案例，并将预测的波数转换为以纳米为单位的波长。\n\n校准数据（每个条目提供 $(\\pi^\\ast, \\alpha, \\beta)$ 和以反厘米为单位的实测波数 $\\tilde{\\nu}$）：\n- 环己烷：$(0.00, 0.00, 0.00)$，$\\tilde{\\nu} = 20005$\n- 甲苯：$(0.54, 0.00, 0.11)$，$\\tilde{\\nu} = 20860$\n- 丙酮：$(0.71, 0.08, 0.48)$，$\\tilde{\\nu} = 21290$\n- 乙腈：$(0.75, 0.19, 0.31)$，$\\tilde{\\nu} = 21150$\n- 乙醇：$(0.54, 0.86, 0.75)$，$\\tilde{\\nu} = 20500$\n- 甲醇：$(0.60, 0.98, 0.66)$，$\\tilde{\\nu} = 20420$\n- 二甲基亚砜：$(1.00, 0.00, 0.76)$，$\\tilde{\\nu} = 21940$\n- 水：$(1.11, 1.17, 0.18)$，$\\tilde{\\nu} = 20730$\n\n使用普通最小二乘法（OLS）来估计截距和系数。然后，对以下测试溶剂集预测吸收谱带最大值，并返回每个案例的波数 $\\tilde{\\nu}$（以反厘米为单位）和波长 $\\lambda$（以纳米为单位）：\n1. 非极性基线：$(\\pi^\\ast, \\alpha, \\beta) = (0.00, 0.00, 0.00)$\n2. 强氢键供体，中等极性：$(\\pi^\\ast, \\alpha, \\beta) = (1.00, 1.10, 0.20)$\n3. 强碱性，高极性：$(\\pi^\\ast, \\alpha, \\beta) = (0.95, 0.00, 1.00)$\n4. 高极性，特异性相互作用可忽略不计：$(\\pi^\\ast, \\alpha, \\beta) = (1.10, 0.00, 0.00)$\n\n要求：\n- 仅根据提供的校准数据，通过最小化波数空间中的残差平方和来估计仿射线性模型参数。\n- 对于每个测试案例，计算预测的波数 $\\tilde{\\nu}$（以反厘米为单位）以及使用 $\\lambda = 10^7 / \\tilde{\\nu}$ 计算出的相应波长 $\\lambda$（以纳米为单位）。\n- 将所有最终数值输出表示为四舍五入到两位小数的浮点数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个类 JSON 格式的列表的列表。每个内部列表对应一个测试案例，并按顺序包含两个浮点数 $[\\tilde{\\nu}\\text{ (单位 cm}^{-1}\\text{)}, \\lambda\\text{ (单位 nm)}]$。例如，$[[\\tilde{\\nu}_1,\\lambda_1],[\\tilde{\\nu}_2,\\lambda_2],\\dots]$。\n\n这个问题可以通过以下步骤普适地解决：根据描述符构建设计矩阵，求解参数矢量的最小二乘法正规方程，然后将所得模型应用于指定的测试集。所有数值输出必须以指定的单位和格式报告。",
            "solution": "用户提供的问题已经过分析和验证。\n\n### 步骤1：提取已知信息\n- **模型方程**：波数 $\\tilde{\\nu}$ 被建模为溶剂描述符 $(\\pi^\\ast, \\alpha, \\beta)$ 的仿射线性函数：$\\tilde{\\nu} = \\tilde{\\nu}_0 + s\\pi^\\ast + a\\alpha + b\\beta$，其中 $\\tilde{\\nu}_0$ 是截距，$s$、$a$ 和 $b$ 是系数。\n- **目标**：通过最小化模型计算的 $\\tilde{\\nu}$ 值与实测值之间的偏差平方和（普通最小二乘法）来估计参数 $(\\tilde{\\nu}_0, s, a, b)$。\n- **物理关系**：以纳米（nm）为单位的波长 $\\lambda$ 与以反厘米（cm$^{-1}$）为单位的波数 $\\tilde{\\nu}$ 之间的关系为 $\\lambda = 10^7 / \\tilde{\\nu}$。\n- **校准数据**：一组包含8种溶剂的数据，每种溶剂都有已知的 $(\\pi^\\ast, \\alpha, \\beta)$ 描述符和实测的波数 $\\tilde{\\nu}$（单位 cm$^{-1}$）。\n    1.  环己烷：$(0.00, 0.00, 0.00)$，$\\tilde{\\nu} = 20005$\n    2.  甲苯：$(0.54, 0.00, 0.11)$，$\\tilde{\\nu} = 20860$\n    3.  丙酮：$(0.71, 0.08, 0.48)$，$\\tilde{\\nu} = 21290$\n    4.  乙腈：$(0.75, 0.19, 0.31)$，$\\tilde{\\nu} = 21150$\n    5.  乙醇：$(0.54, 0.86, 0.75)$，$\\tilde{\\nu} = 20500$\n    6.  甲醇：$(0.60, 0.98, 0.66)$，$\\tilde{\\nu} = 20420$\n    7.  二甲基亚砜 (DMSO)：$(1.00, 0.00, 0.76)$，$\\tilde{\\nu} = 21940$\n    8.  水：$(1.11, 1.17, 0.18)$，$\\tilde{\\nu} = 20730$\n- **测试案例**：一组包含4个描述符元组的数据，需要对它们预测 $\\tilde{\\nu}$ 和 $\\lambda$。\n    1.  测试案例 1：$(\\pi^\\ast, \\alpha, \\beta) = (0.00, 0.00, 0.00)$\n    2.  测试案例 2：$(\\pi^\\ast, \\alpha, \\beta) = (1.00, 1.10, 0.20)$\n    3.  测试案例 3：$(\\pi^\\ast, \\alpha, \\beta) = (0.95, 0.00, 1.00)$\n    4.  测试案例 4：$(\\pi^\\ast, \\alpha, \\beta) = (1.10, 0.00, 0.00)$\n- **输出规格**：\n    - 为每个测试案例预测 $\\tilde{\\nu}$ (cm$^{-1}$) 和 $\\lambda$ (nm)。\n    - 所有最终数值输出必须是四舍五入到两位小数的浮点数。\n    - 程序的最终输出必须是单行，包含一个列表的列表，格式为 `[[v1,l1],[v2,l2],...]`。\n\n### 步骤2：使用提取的已知信息进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于 Kamlet–Taft 模型，这是物理有机化学中用于量化溶剂化显色效应的一个标准且广泛使用的经验框架。关联能量、波数和波长的物理方程是基础性的。所有方面都具有科学合理性。\n- **适定性**：该问题是多元线性回归（普通最小二乘法）的一个标准应用。有8个观测值和4个待估参数（截距 $\\tilde{\\nu}_0$ 以及系数 $s, a, b$）。由于观测值数量超过参数数量，该系统是超定的。所提供的描述符值足够多样化，可确保设计矩阵是满秩的，从而保证存在唯一解。\n- **客观性**：该问题使用精确的数值数据、已建立的科学模型以及清晰明确的指令进行陈述。它不含主观或基于观点的内容。\n- **其他缺陷**：问题陈述是完整的、一致的、现实的，并且结构严谨。它没有表现出任何列出的无效性缺陷。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供一个完整的、论证充分的解决方案。\n\n### 解决方案\n该问题要求我们执行多元线性回归分析，以模拟染料电子吸收最大值的溶剂化显色位移。吸收最大值的波数 $\\tilde{\\nu}$ 与溶剂性质之间的关系由以下仿射线性模型给出：\n$$\n\\tilde{\\nu}_{\\text{model}} = \\tilde{\\nu}_0 + s\\pi^\\ast + a\\alpha + b\\beta\n$$\n其中 $(\\pi^\\ast, \\alpha, \\beta)$ 是 Kamlet–Taft 溶剂参数，$(\\tilde{\\nu}_0, s, a, b)$ 是我们需要估计的模型参数。参数 $\\tilde{\\nu}_0$ 代表在极性、酸度和碱度均为零的假想溶剂中外推得到的波数，而 $s$、$a$ 和 $b$ 则量化了跃迁能量对每种溶剂性质的敏感度。\n\n这个问题可以用线性代数的语言来表述。设观测波数的向量为 $\\mathbf{y}$，未知模型参数的向量为 $\\boldsymbol{\\theta}$，设计矩阵为 $\\mathbf{X}$。\n$$\n\\mathbf{y} = \\begin{pmatrix} \\tilde{\\nu}_1 \\\\ \\tilde{\\nu}_2 \\\\ \\vdots \\\\ \\tilde{\\nu}_n \\end{pmatrix}, \\quad\n\\boldsymbol{\\theta} = \\begin{pmatrix} \\tilde{\\nu}_0 \\\\ s \\\\ a \\\\ b \\end{pmatrix}, \\quad\n\\mathbf{X} = \\begin{pmatrix}\n1  \\pi^\\ast_1  \\alpha_1  \\beta_1 \\\\\n1  \\pi^\\ast_2  \\alpha_2  \\beta_2 \\\\\n\\vdots  \\vdots  \\vdots  \\vdots \\\\\n1  \\pi^\\ast_n  \\alpha_n  \\beta_n\n\\end{pmatrix}\n$$\n模型可以表示为 $\\mathbf{y} \\approx \\mathbf{X}\\boldsymbol{\\theta}$。观测（溶剂）的数量为 $n=8$。\n\n使用提供的校准数据，响应向量 $\\mathbf{y}$ 为：\n$$\n\\mathbf{y} = \\begin{pmatrix} 20005 \\\\ 20860 \\\\ 21290 \\\\ 21150 \\\\ 20500 \\\\ 20420 \\\\ 21940 \\\\ 20730 \\end{pmatrix}\n$$\n设计矩阵 $\\mathbf{X}$ 为：\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1  0.00  0.00  0.00 \\\\\n1  0.54  0.00  0.11 \\\\\n1  0.71  0.08  0.48 \\\\\n1  0.75  0.19  0.31 \\\\\n1  0.54  0.86  0.75 \\\\\n1  0.60  0.98  0.66 \\\\\n1  1.00  0.00  0.76 \\\\\n1  1.11  1.17  0.18\n\\end{pmatrix}\n$$\n普通最小二乘法（OLS）旨在找到参数矢量 $\\hat{\\boldsymbol{\\theta}}$，以最小化残差平方和 $S(\\boldsymbol{\\theta}) = \\sum_{i=1}^n (y_i - (\\mathbf{X}\\boldsymbol{\\theta})_i)^2 = ||\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}||^2$。该最小化问题的解由正规方程给出：\n$$\n(\\mathbf{X}^T \\mathbf{X}) \\hat{\\boldsymbol{\\theta}} = \\mathbf{X}^T \\mathbf{y}\n$$\n求解 $\\hat{\\boldsymbol{\\theta}}$，我们得到：\n$$\n\\hat{\\boldsymbol{\\theta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}\n$$\n所得向量 $\\hat{\\boldsymbol{\\theta}} = [\\hat{\\tilde{\\nu}}_0, \\hat{s}, \\hat{a}, \\hat{b}]^T$ 的分量即为估计的模型参数。\n\n一旦参数被估计出来，我们就可以为具有描述符 $(\\pi^\\ast_{\\text{new}}, \\alpha_{\\text{new}}, \\beta_{\\text{new}})$ 的新溶剂预测波数 $\\tilde{\\nu}_{\\text{pred}}$。我们定义一个新的输入向量 $\\mathbf{x}_{\\text{new}}$：\n$$\n\\mathbf{x}_{\\text{new}} = \\begin{pmatrix} 1 \\\\ \\pi^\\ast_{\\text{new}} \\\\ \\alpha_{\\text{new}} \\\\ \\beta_{\\text{new}} \\end{pmatrix}\n$$\n预测的波数是该向量的转置与参数向量的点积：\n$$\n\\tilde{\\nu}_{\\text{pred}} = \\mathbf{x}_{\\text{new}}^T \\hat{\\boldsymbol{\\theta}} = \\hat{\\tilde{\\nu}}_0 + \\hat{s}\\pi^\\ast_{\\text{new}} + \\hat{a}\\alpha_{\\text{new}} + \\hat{b}\\beta_{\\text{new}}\n$$\n我们将对四个测试案例中的每一个执行此计算。\n\n最后，对于每个预测的波数 $\\tilde{\\nu}_{\\text{pred}}$（单位 cm$^{-1}$），使用给定公式计算相应的波长 $\\lambda_{\\text{pred}}$（单位 nm）：\n$$\n\\lambda_{\\text{pred}} = \\frac{10^7}{\\tilde{\\nu}_{\\text{pred}}}\n$$\n实现将使用数值库来解决线性最小二乘问题，这比显式计算矩阵的逆在数值上更稳定。$\\tilde{\\nu}_{\\text{pred}}$ 和 $\\lambda_{\\text{pred}}$ 的最终结果将按要求四舍五入到两位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits a Kamlet-Taft linear model to solvatochromic data and predicts\n    absorption maxima for new solvent conditions.\n    \"\"\"\n    \n    # Calibration data from the problem statement.\n    # Each entry is a tuple: (pi_star, alpha, beta, nu_tilde_cm_minus_1)\n    calibration_data = [\n        (0.00, 0.00, 0.00, 20005),  # Cyclohexane\n        (0.54, 0.00, 0.11, 20860),  # Toluene\n        (0.71, 0.08, 0.48, 21290),  # Acetone\n        (0.75, 0.19, 0.31, 21150),  # Acetonitrile\n        (0.54, 0.86, 0.75, 20500),  # Ethanol\n        (0.60, 0.98, 0.66, 20420),  # Methanol\n        (1.00, 0.00, 0.76, 21940),  # Dimethyl sulfoxide\n        (1.11, 1.17, 0.18, 20730),  # Water\n    ]\n\n    # Unpack calibration data into separate lists/arrays\n    pi_star_cal, alpha_cal, beta_cal, nu_tilde_cal = zip(*calibration_data)\n\n    # Convert to NumPy arrays for vectorized operations\n    y = np.array(nu_tilde_cal)\n    \n    # Construct the design matrix X for the linear model:\n    # y = X * [nu0, s, a, b]^T\n    # The first column of ones is for the intercept term (nu0).\n    X = np.column_stack([\n        np.ones(len(pi_star_cal)),\n        np.array(pi_star_cal),\n        np.array(alpha_cal),\n        np.array(beta_cal)\n    ])\n\n    # Solve the ordinary least squares problem y = X*theta\n    # This finds the coefficient vector theta = [nu0, s, a, b]\n    # that minimizes the squared Euclidean norm ||y - X*theta||^2.\n    # np.linalg.lstsq is numerically more stable than calculating the\n    # inverse of (X.T @ X).\n    coefficients, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n    # The returned 'coefficients' vector contains [nu0, s, a, b]\n\n    # Test cases for prediction, as given in the problem statement.\n    # Each entry is a tuple: (pi_star, alpha, beta)\n    test_cases = [\n        (0.00, 0.00, 0.00),  # Nonpolar baseline\n        (1.00, 1.10, 0.20),  # Strong H-bond donor, moderate polarity\n        (0.95, 0.00, 1.00),  # Strongly basic, high polarity\n        (1.10, 0.00, 0.00)   # High polarity, negligible specific interactions\n    ]\n\n    results = []\n    for pi_star_test, alpha_test, beta_test in test_cases:\n        # Create the input vector for prediction (including the 1 for the intercept)\n        x_new = np.array([1, pi_star_test, alpha_test, beta_test])\n        \n        # Predict the wavenumber using the fitted model\n        # nu_pred = nu0 + s*pi_star + a*alpha + b*beta\n        nu_pred = np.dot(x_new, coefficients)\n        \n        # Convert the predicted wavenumber (in cm^-1) to wavelength (in nm)\n        # lambda = 10^7 / nu\n        lambda_pred = 10**7 / nu_pred\n        \n        # Store the pair of results\n        results.append([nu_pred, lambda_pred])\n    \n    # Format the output string as a JSON-like list of lists with two-decimal precision.\n    # e.g., \"[[val1, val2],[val3, val4]]\"\n    inner_lists = [f\"[{res[0]:.2f},{res[1]:.2f}]\" for res in results]\n    final_output = f\"[{','.join(inner_lists)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在科学研究中，我们常常面对多种竞争性假说（即模型）来解释同一组实验数据。简单地拟合数据是不够的，我们必须有原则地选择最合理的模型。本高级练习 () 模拟了一个真实的研究场景，你将需要拟合多种溶剂化显色效应模型，并运用赤池信息量准则 (AIC) 等统计工具来平衡模型的拟合优度与复杂度，从而进行模型选择。最终，通过在“保留”数据上检验模型的预测能力，你将能深刻体会到评估一个模型泛化能力的重要性。",
            "id": "3723867",
            "problem": "给定三种独立的电子吸收最大值数据集，这些数据集是为单一溶剂化显色有机染料在不同溶剂中测量的。目的是进行基于原则的回归，量化不确定性，并在相互竞争的溶剂描述符模型中进行选择，以辅助光谱鉴定。所有光谱最大值均以波数形式提供，所有涉及物理量的输出必须在内部以 $\\mathrm{cm^{-1}}$ 为单位处理；然而，您的程序的最终输出必须仅为无单位的整数和布尔值，具体要求如下。\n\n使用的基本原理：\n- 溶剂化显色效应的产生是因为溶剂对溶质的基态和激发电子态有不同的稳定作用；一个广泛用于描述偶极稳定作用的描述符是 Lippert–Mataga 极性函数，它源于宏观介电和折射性质。基于 Lorentz–Lorenz 和 Onsager 的极性函数为\n$$\n\\Delta f = \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^2 - 1}{2 n^2 + 1},\n$$\n其中 $\\varepsilon$ 是静态相对介电常数（介电常数），$n$ 是折射率（在光学频率下）。\n- $\\mathrm{ET(30)}$ 标度，以 $\\mathrm{kcal \\, mol^{-1}}$ 为单位测量，是一个广泛用于关联电子光谱位移的经验性溶剂极性标度。\n- Kamlet–Taft 多参数方法使用溶剂极性/极化性 $\\pi^\\ast$、氢键供体酸度 $\\alpha$ 和氢键受体碱度 $\\beta$ 作为描述符来关联光谱性质。\n- 假设测量的波数中存在加性、独立、同分布的高斯噪声。在高斯噪声下，对于线性模型，最大似然估计与普通最小二乘法重合，而赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 等信息准则通过平衡拟合度和模型复杂度来比较模型。\n\n待拟合到每个数据集的候选模型：\n- 模型 $\\#1$ (Lippert–Mataga)：波数对 $\\Delta f$ 的线性响应，含一个截距和一个斜率参数。\n- 模型 $\\#2$ ($\\mathrm{ET(30)}$)：波数对 $\\mathrm{ET(30)}$ 的线性响应，含一个截距和一个斜率参数。\n- 模型 $\\#3$ (Kamlet–Taft)：波数对 $\\pi^\\ast$、$\\alpha$ 和 $\\beta$ 的线性响应，含一个截距和三个斜率参数。\n\n您必须使用上述基本原理进行基于原则的回归，量化参数和预测的不确定性，并使用 AIC 作为主要准则、BIC 作为必要时的决胜准则来进行模型选择。然后，对于一个指定的留出溶剂，构建一个 $95\\%$ 的预测区间（使用 $0.95$ 的双侧置信水平），并报告测量的留出波数是否位于该区间内。不涉及角度；无需角度单位。所有光谱值的数值处理必须以 $\\mathrm{cm^{-1}}$ 为单位。\n\n溶剂描述符表（所有三个数据集使用相同的描述符）：\n- 溶剂及其描述符 $\\{\\varepsilon, n, \\mathrm{ET(30)}, \\pi^\\ast, \\alpha, \\beta\\}$：\n    - 己烷：$\\varepsilon = 1.89$, $n = 1.375$, $\\mathrm{ET(30)} = 31.0$, $\\pi^\\ast = 0.00$, $\\alpha = 0.00$, $\\beta = 0.00$。\n    - 甲苯：$\\varepsilon = 2.38$, $n = 1.496$, $\\mathrm{ET(30)} = 33.9$, $\\pi^\\ast = 0.54$, $\\alpha = 0.00$, $\\beta = 0.11$。\n    - 二氯甲烷：$\\varepsilon = 8.93$, $n = 1.424$, $\\mathrm{ET(30)} = 40.7$, $\\pi^\\ast = 0.82$, $\\alpha = 0.00$, $\\beta = 0.10$。\n    - 乙腈：$\\varepsilon = 37.5$, $n = 1.344$, $\\mathrm{ET(30)} = 45.8$, $\\pi^\\ast = 0.75$, $\\alpha = 0.19$, $\\beta = 0.31$。\n    - 乙醇：$\\varepsilon = 24.55$, $n = 1.361$, $\\mathrm{ET(30)} = 51.9$, $\\pi^\\ast = 0.54$, $\\alpha = 0.86$, $\\beta = 0.75$。\n    - 水（留出溶剂）：$\\varepsilon = 78.4$, $n = 1.333$, $\\mathrm{ET(30)} = 63.1$, $\\pi^\\ast = 1.10$, $\\alpha = 1.17$, $\\beta = 0.47$。\n\n数据集和测量的波数（训练集：前五个溶剂；留出测试：水）：\n- 数据集 $\\mathrm{A}$（训练测量值，单位 $\\mathrm{cm^{-1}}$）：己烷 $= 21030$，甲苯 $= 20930$，二氯甲烷 $= 20160$，乙腈 $= 19760$，乙醇 $= 19890$。留出（水）测量的波数：$19700$。\n- 数据集 $\\mathrm{B}$（训练测量值，单位 $\\mathrm{cm^{-1}}$）：己烷 $= 19980$，甲苯 $= 19790$，二氯甲烷 $= 19490$，乙腈 $= 19190$，乙醇 $= 18870$。留出（水）测量的波数：$18360$。\n- 数据集 $\\mathrm{C}$（训练测量值，单位 $\\mathrm{cm^{-1}}$）：己烷 $= 20520$，甲苯 $= 20060$，二氯甲烷 $= 19880$，乙腈 $= 19820$，乙醇 $= 19440$。留出（水）测量的波数：$19000$。\n\n您的程序必须：\n- 对每个数据集，使用指定的描述符和训练溶剂构建所有三个候选线性模型。\n- 在高斯噪声下，使用普通最小二乘法通过最大似然估计来拟合模型参数。\n- 在高斯噪声下计算最大对数似然，然后计算 AIC 和 BIC；在计算信息准则的参数数量时，将噪声方差视为一个估计参数。\n- 对每个数据集，通过最小的 AIC 选择最佳模型；如果 AIC 值在数值容差范围内相等，则使用 BIC 来决胜。\n- 对于留出溶剂（水），使用从训练拟合中得到的适当自由度，为所选模型构建 $95\\%$ 的双侧预测区间。报告提供的测量留出波数是否落在此区间内，结果为布尔值。\n\n测试套件：\n- 案例 $\\#1$：数据集 $\\mathrm{A}$。\n- 案例 $\\#2$：数据集 $\\mathrm{B}$。\n- 案例 $\\#3$：数据集 $\\mathrm{C}$。\n\n最终输出格式：\n- 您的程序应生成一行包含在方括号内的逗号分隔列表，长度为 $6$，其条目为\n`[`m_A`, `m_B`, `m_C`, `c_A`, `c_B`, `c_C`]`,\n其中 `m_A`, `m_B`, `m_C` 是 $\\{1,2,3\\}$ 中的整数，分别表示为数据集 $\\mathrm{A}$、$\\mathrm{B}$ 和 $\\mathrm{C}$ 选择的模型索引，而 `c_A`, `c_B`, `c_C` 是布尔值，表示水的测量留出波数是否位于相应的 $95\\%$ 预测区间内。打印的单行必须与此格式完全匹配，例如 `[1,2,3,True,False,True]`。",
            "solution": "用户提供了一个以有机化合物的光谱鉴定为中心的问题，通过分析溶剂化显色效应来解决。任务是使用三种不同的既定线性自由能关系模型，来模拟染料在各种溶剂中电子吸收最大值（以波数 $\\tilde{\\nu}$ 给出）的变化。问题的核心在于执行线性回归，使用基于原则的统计方法（赤池信息准则和贝叶斯信息准则）为三个独立的数据集选择最合适的模型，然后使用所选模型对一个留出溶剂进行预测，并通过预测区间量化其不确定性。\n\n### 步骤 1：问题验证\n已根据要求标准对问题陈述进行了评估。\n- **给定条件**：所有必要的数据都已提供，包括溶剂物理性质（$\\varepsilon, n$）、经验性溶剂标度值（$\\mathrm{ET(30)}, \\pi^\\ast, \\alpha, \\beta$），以及三个数据集，其中包含五个训练溶剂和一个留出溶剂（水）的测量波数（$\\tilde{\\nu}$）。模型、拟合程序（OLS）、模型选择准则（AIC, BIC）和预测区间置信水平（$95\\%$）都已明确定义。\n- **科学依据**：该问题牢固地植根于物理化学和化学计量学。Lippert–Mataga 方程、$\\mathrm{ET(30)}$ 标度和 Kamlet–Taft 参数是描述溶剂化显色效应的标准描述符。所用的统计方法——普通最小二乘法 (OLS)、最大似然估计 (MLE)、赤池信息准则 (AIC)、贝叶斯信息准则 (BIC) 以及预测区间的构建——都是完成此项任务的标准且合适的方法。\n- **适定性和一致性**：该问题是适定的。对于每个模型，数据点数（$n=5$）大于或等于待估计的均值参数数量（$p \\le 4$），这允许在设计矩阵满秩（它们确实是）的情况下得到唯一的 OLS 解。计算 AIC/BIC 的指令，包括将方差视为一个估计参数的处理方式，都是具体的。模型选择和预测的程序是明确的。没有内部矛盾。对于模型 3，估计的总参数数量（$K=p+1=5$）等于数据点数（$n=5$）。虽然这是一个边界情况，但所有计算在数学上仍然是明确的，并且统计方法能够正确处理由此带来的高不确定性（例如，t 分布的自由度较低）。\n\n该问题被认为是有效且科学合理的。\n\n### 步骤 2：基于原则的解决方案开发\n\n解决方案将通过对提供的三个数据集分别实施指定的统计分析来推进。\n\n#### 1. 候选模型和描述符\n对于每个数据集，我们将观测到的波数 $\\tilde{\\nu}$ 与五个训练溶剂（己烷、甲苯、二氯甲烷、乙腈、乙醇）的描述符进行拟合。设 $y_i$ 为溶剂 $i$ 的观测波数。\n\n三个候选线性模型是：\n- **模型 1 (Lippert–Mataga)**：该模型将波数与溶剂极性函数 $\\Delta f$ 相关联。\n$$ y_i = \\beta_0 + \\beta_1 (\\Delta f)_i + \\epsilon_i $$\n描述符 $\\Delta f$ 根据静态相对介电常数 $\\varepsilon$ 和折射率 $n$ 计算得出：\n$$ \\Delta f = \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^2 - 1}{2 n^2 + 1} $$\n\n- **模型 2 (ET(30))**：该模型使用经验性的 $\\mathrm{ET(30)}$ 溶剂极性标度。\n$$ y_i = \\beta_0 + \\beta_1 (\\mathrm{ET(30)})_i + \\epsilon_i $$\n\n- **模型 3 (Kamlet–Taft)**：这是一个多参数模型，包含溶剂极性/极化性 ($\\pi^\\ast$)、氢键供体酸度 ($\\alpha$) 和氢键受体碱度 ($\\beta$)。\n$$ y_i = \\beta_0 + \\beta_1 (\\pi^\\ast)_i + \\beta_2 (\\alpha)_i + \\beta_3 (\\beta)_i + \\epsilon_i $$\n\n在所有模型中，$\\epsilon_i$ 代表噪声项，假定为独立同分布的高斯噪声，$\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n#### 2. 参数估计\n在独立同分布高斯噪声的假设下，最大化数据的似然性等同于最小化残差平方和。这就是普通最小二乘法 (OLS) 的原理。对于一个通用线性模型 $y = X\\beta + \\epsilon$，系数向量 $\\beta$ 的 OLS 估计为：\n$$ \\hat{\\beta} = (X^T X)^{-1} X^T y $$\n其中 $y$ 是观测波数的向量，$X$ 是设计矩阵，其列由一个常数（$1$，用于截距）和每个模型的溶剂描述符值组成。残差平方和 (RSS) 随后计算为：\n$$ RSS = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2 = \\| y - X\\hat{\\beta} \\|^2 $$\n其中 $\\hat{y}_i = (X\\hat{\\beta})_i$ 是拟合值。\n\n#### 3. 模型选择\n为了比较三个模型的性能，我们使用信息准则来平衡拟合优度与模型复杂度。问题指定主要使用赤池信息准则 (AIC)，并以贝叶斯信息准则 (BIC) 作为决胜标准。\n\n对于具有高斯噪声的线性模型，最大化对数似然由下式给出：\n$$ L_{\\text{max}} = -\\frac{n}{2} \\left( \\ln(2\\pi) + \\ln\\left(\\frac{RSS}{n}\\right) + 1 \\right) $$\n其中 $n$ 是数据点的数量。在我们的案例中，$n=5$。\n\n问题规定噪声方差 $\\sigma^2$ 应计为一个估计参数。因此，对于一个有 $p$ 个系数（包括截距）的模型，估计参数的总数 $K$ 为 $K = p+1$。\n- 模型 1  2：$p=2$ 个系数 ($\\beta_0, \\beta_1$)，所以 $K=3$。\n- 模型 3：$p=4$ 个系数 ($\\beta_0, \\beta_1, \\beta_2, \\beta_3$)，所以 $K=5$。\n\n然后 AIC 和 BIC 的计算公式为：\n$$ \\mathrm{AIC} = -2 L_{\\text{max}} + 2K $$\n$$ \\mathrm{BIC} = -2 L_{\\text{max}} + K \\ln(n) $$\n选择 AIC 最低的模型。如果两个模型的 AIC 值在小的数值容差范围内相等，则选择 BIC 较低的那个。\n\n#### 4. 预测和不确定性量化\n对于每个数据集选择的最佳模型，我们将预测留出溶剂（水）的波数，并构建一个 $95\\%$ 的预测区间。\n\n对于一个新的描述符向量 $x_0$，预测值 $\\hat{y}_0$ 为：\n$$ \\hat{y}_0 = x_0^T \\hat{\\beta} $$\n\n双侧 $(1-\\alpha_{conf})\\%$ 预测区间的计算公式为：\n$$ \\hat{y}_0 \\pm t_{1-\\alpha_{conf}/2, \\, n-p} \\cdot s_e \\cdot \\sqrt{1 + x_0^T(X^T X)^{-1}x_0} $$\n- 对于 $95\\%$ 的区间，$\\alpha_{conf} = 0.05$。\n- $t_{1-\\alpha_{conf}/2, \\, n-p}$ 是自由度为 $n-p$ 的学生 t 分布的临界值。\n- $s_e = \\sqrt{\\frac{RSS}{n-p}}$ 是回归的标准误差，基于方差 $\\sigma^2$ 的无偏估计量。\n- 项 $\\sqrt{1 + x_0^T(X^T X)^{-1}x_0}$ 既考虑了估计均值的不确定性，也考虑了新观测值的内在变异性。\n\n最后，我们将确定实验测量的水的波数是否落在这个计算出的区间内。\n\n#### 5. 计算实现\n程序将对每个数据集执行以下操作：\n1.  使用提供的溶剂数据为三个模型构建设计矩阵 $X_1, X_2, X_3$。$\\Delta f$ 值将预先计算。\n2.  对每个模型，执行 OLS 回归以找到 $\\hat{\\beta}$ 和 $RSS$。\n3.  为每个模型计算 $L_{\\text{max}}$、AIC 和 BIC。\n4.  根据最小的 AIC/BIC 选择最佳模型索引（$1, 2,$ 或 $3$）。\n5.  对于所选模型，计算水的 $95\\%$ 预测区间。\n6.  检查测量的 $\\tilde{\\nu}_{\\text{Water}}$ 是否包含在该区间内。\n7.  将所有三个数据集的结果汇总成指定的输出格式。\n这个过程将使用 Python 实现，借助 `numpy` 库进行数值计算，并使用 `scipy.stats` 获取 t 分布。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Solves the solvatochromism model selection problem for three datasets.\n    \"\"\"\n    \n    # Define solvent properties and datasets as provided in the problem.\n    solvent_data = {\n        'Hexane':          {'e': 1.89,  'n': 1.375, 'et30': 31.0, 'pi': 0.00, 'a': 0.00, 'b': 0.00},\n        'Toluene':         {'e': 2.38,  'n': 1.496, 'et30': 33.9, 'pi': 0.54, 'a': 0.00, 'b': 0.11},\n        'Dichloromethane': {'e': 8.93,  'n': 1.424, 'et30': 40.7, 'pi': 0.82, 'a': 0.00, 'b': 0.10},\n        'Acetonitrile':    {'e': 37.5,  'n': 1.344, 'et30': 45.8, 'pi': 0.75, 'a': 0.19, 'b': 0.31},\n        'Ethanol':         {'e': 24.55, 'n': 1.361, 'et30': 51.9, 'pi': 0.54, 'a': 0.86, 'b': 0.75},\n        'Water':           {'e': 78.4,  'n': 1.333, 'et30': 63.1, 'pi': 1.10, 'a': 1.17, 'b': 0.47}\n    }\n\n    # Calculate the Lippert-Mataga descriptor (Delta f) for all solvents.\n    for name, props in solvent_data.items():\n        e = props['e']\n        n = props['n']\n        term1 = (e - 1) / (2 * e + 1)\n        term2 = (n**2 - 1) / (2 * n**2 + 1)\n        solvent_data[name]['df'] = term1 - term2\n\n    training_solvents = ['Hexane', 'Toluene', 'Dichloromethane', 'Acetonitrile', 'Ethanol']\n    holdout_solvent = 'Water'\n    n_train = len(training_solvents)\n\n    # Define the three datasets\n    test_cases = [\n        # Dataset A\n        {'y_train': np.array([21030, 20930, 20160, 19760, 19890]), 'y_holdout': 19700},\n        # Dataset B\n        {'y_train': np.array([19980, 19790, 19490, 19190, 18870]), 'y_holdout': 18360},\n        # Dataset C\n        {'y_train': np.array([20520, 20060, 19880, 19820, 19440]), 'y_holdout': 19000},\n    ]\n\n    # Prepare design matrices for the three models\n    X1 = np.array([[1, solvent_data[s]['df']] for s in training_solvents])\n    X2 = np.array([[1, solvent_data[s]['et30']] for s in training_solvents])\n    X3 = np.array([[1, solvent_data[s]['pi'], solvent_data[s]['a'], solvent_data[s]['b']] for s in training_solvents])\n\n    model_specs = [\n        {'X': X1, 'p': 2, 'K': 3, 'label': 1},\n        {'X': X2, 'p': 2, 'K': 3, 'label': 2},\n        {'X': X3, 'p': 4, 'K': 5, 'label': 3},\n    ]\n\n    model_indices = []\n    containment_bools = []\n\n    for case in test_cases:\n        y_train = case['y_train']\n        y_holdout = case['y_holdout']\n        \n        model_results = []\n        for spec in model_specs:\n            X, p, K = spec['X'], spec['p'], spec['K']\n            \n            # Perform Ordinary Least Squares regression\n            beta, rss_list, rank, s_vals = np.linalg.lstsq(X, y_train, rcond=None)\n            rss = rss_list[0] if len(rss_list) > 0 else 0.0\n            \n            # Calculate AIC and BIC\n            if rss  1e-12: # Check for a numerically perfect fit, which is problematic for AIC/BIC\n                aic, bic = float('inf'), float('inf')\n            else:\n                log_likelihood = -n_train / 2 * (np.log(2 * np.pi) + np.log(rss / n_train) + 1)\n                aic = -2 * log_likelihood + 2 * K\n                bic = -2 * log_likelihood + K * np.log(n_train)\n            \n            model_results.append({'aic': aic, 'bic': bic, 'beta': beta, 'rss': rss})\n            \n        # Select the best model based on AIC, with BIC as a tie-breaker\n        min_aic = min(res['aic'] for res in model_results)\n        best_model_candidates = [i for i, res in enumerate(model_results) if np.isclose(res['aic'], min_aic, atol=1e-9)]\n        \n        best_model_idx = -1\n        if len(best_model_candidates) == 1:\n            best_model_idx = best_model_candidates[0]\n        else:\n            min_bic_in_tie = float('inf')\n            for i in best_model_candidates:\n                if model_results[i]['bic']  min_bic_in_tie:\n                    min_bic_in_tie = model_results[i]['bic']\n                    best_model_idx = i\n        \n        model_indices.append(model_specs[best_model_idx]['label'])\n\n        # Construct 95% prediction interval for the hold-out solvent using the best model\n        best_model_fit = model_results[best_model_idx]\n        best_model_spec = model_specs[best_model_idx]\n        X_best, p_best = best_model_spec['X'], best_model_spec['p']\n        \n        # Define predictor vector for water\n        if best_model_idx == 0:  # Model 1\n            x0 = np.array([1, solvent_data[holdout_solvent]['df']])\n        elif best_model_idx == 1:  # Model 2\n            x0 = np.array([1, solvent_data[holdout_solvent]['et30']])\n        else:  # Model 3\n            x0 = np.array([1, solvent_data[holdout_solvent]['pi'], solvent_data[holdout_solvent]['a'], solvent_data[holdout_solvent]['b']])\n            \n        y0_pred = x0 @ best_model_fit['beta']\n        \n        df = n_train - p_best\n        containment = False\n        if df > 0 and best_model_fit['rss'] > 1e-12:\n            s_e = np.sqrt(best_model_fit['rss'] / df)\n            t_val = t.ppf(0.975, df)\n            \n            try:\n                # Solve (X^T X)z = x_0 to find z, then compute leverage as sqrt(1 + x_0^T z)\n                z = np.linalg.solve(X_best.T @ X_best, x0)\n                leverage = np.sqrt(1 + x0.T @ z)\n                margin_of_error = t_val * s_e * leverage\n                \n                lower_bound = y0_pred - margin_of_error\n                upper_bound = y0_pred + margin_of_error\n                \n                containment = lower_bound = y_holdout = upper_bound\n            except np.linalg.LinAlgError:\n                # In case of singularity, interval cannot be computed\n                containment = False\n\n        containment_bools.append(containment)\n\n    # Combine results and print in the specified format\n    final_output = model_indices + containment_bools\n    print(f\"[{','.join(map(str, final_output))}]\")\n\nsolve()\n```"
        }
    ]
}