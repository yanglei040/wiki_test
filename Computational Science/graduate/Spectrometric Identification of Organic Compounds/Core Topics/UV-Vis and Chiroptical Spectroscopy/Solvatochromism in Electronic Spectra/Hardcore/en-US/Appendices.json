{
    "hands_on_practices": [
        {
            "introduction": "A primary application of solvatochromism is to probe the change in a molecule's electronic structure upon excitation. This exercise demonstrates how to use the Lippert-Mataga model, a cornerstone of solvatochromism theory, to connect an experimentally observable quantity—the slope of a Stokes shift plot—to a fundamental molecular property: the change in dipole moment, $\\Delta\\mu$. By working through the derivation and performing a rigorous uncertainty propagation, you will gain hands-on experience in translating spectroscopic data into quantitative insights about excited-state behavior. ",
            "id": "3723883",
            "problem": "A push–pull organic dye exhibits strong solvent-dependent shifts in its electronic absorption and fluorescence maxima. Within the dielectric continuum picture of solvatochromism, model the solute as an electric dipole embedded in a spherical cavity of radius $a$ inside a homogeneous, isotropic medium characterized by static dielectric constant $\\varepsilon$ and refractive index $n$. The Stokes shift, defined as the difference between the absorption and emission band maxima in wavenumbers, is observed to vary linearly with the solvent polarity function $\\Delta f \\equiv \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^{2} - 1}{2n^{2} + 1}$ across a series of solvents.\n\nA linear regression of the measured Stokes shifts (in wavenumbers) versus $\\Delta f$ yields a slope $S$ and intercept $C$; the intercept is not needed for this task. The regression result for the slope is $S = (2.50 \\pm 0.04) \\times 10^{3}$ in $\\mathrm{cm}^{-1}$, where the uncertainty is the standard uncertainty and $\\Delta f$ is dimensionless. The cavity radius, determined independently from solute molecular modeling, is $a = (6.00 \\pm 0.20)$ in $\\mathrm{\\AA}$, with a standard uncertainty. Assume $S$ and $a$ are statistically independent and their uncertainties are small enough that first-order (Gaussian) uncertainty propagation applies.\n\nStarting from the dielectric continuum reaction-field framework (i.e., Onsager’s model) and well-tested spectroscopic principles relating energy shifts to wavenumbers, derive an expression that connects the slope $S$ to the change in permanent dipole moment $\\Delta \\mu$ between the ground and the excited electronic states. Use this expression to obtain $\\Delta \\mu$ in coulomb–meter and convert it to the Light–Debye (Debye) unit, given $1~\\mathrm{D} = 3.33564 \\times 10^{-30}~\\mathrm{C \\cdot m}$. For physical constants, use the International System of Units (SI) values $h = 6.62607015 \\times 10^{-34}~\\mathrm{J \\cdot s}$, $c = 2.99792458 \\times 10^{8}~\\mathrm{m \\cdot s^{-1}}$, and $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}~\\mathrm{F \\cdot m^{-1}}$.\n\nThen, by explicit application of uncertainty propagation to your derived expression, compute the combined relative standard uncertainty in $\\Delta \\mu$ as a unitless decimal. Round your final answer to four significant figures. The final answer must be expressed as a decimal number without units.",
            "solution": "The problem statement is evaluated against the validation criteria.\n\n### Step 1: Extract Givens\n-   **Model**: An electric dipole solute in a spherical cavity of radius $a$ within a homogeneous, isotropic medium with static dielectric constant $\\varepsilon$ and refractive index $n$.\n-   **Stokes Shift**: Defined as the difference between absorption and emission band maxima in wavenumbers, $\\Delta\\tilde{\\nu}_{SS}$.\n-   **Solvent Polarity Function**: $\\Delta f \\equiv \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^{2} - 1}{2n^{2} + 1}$.\n-   **Experimental Observation**: A linear regression of $\\Delta\\tilde{\\nu}_{SS}$ (in $\\mathrm{cm}^{-1}$) versus $\\Delta f$ gives a slope $S = (2.50 \\pm 0.04) \\times 10^{3}~\\mathrm{cm}^{-1}$ and an intercept $C$ (not needed).\n-   **Cavity Radius**: $a = (6.00 \\pm 0.20)~\\mathrm{\\AA}$.\n-   **Statistical Assumptions**: $S$ and $a$ are statistically independent, and first-order (Gaussian) uncertainty propagation is applicable.\n-   **Objective 1**: Derive an expression connecting the slope $S$ to the change in permanent dipole moment $\\Delta \\mu$ between the ground and excited electronic states.\n-   **Objective 2**: Compute the combined relative standard uncertainty in $\\Delta \\mu$ as a unitless decimal, rounded to four significant figures.\n-   **Constants**:\n    -   $1~\\mathrm{D} = 3.33564 \\times 10^{-30}~\\mathrm{C \\cdot m}$.\n    -   $h = 6.62607015 \\times 10^{-34}~\\mathrm{J \\cdot s}$.\n    -   $c = 2.99792458 \\times 10^{8}~\\mathrm{m \\cdot s^{-1}}$.\n    -   $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}~\\mathrm{F \\cdot m^{-1}}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the Lippert-Mataga model of solvatochromism, a well-established theory in physical chemistry and photophysics. All concepts and parameters ($\\varepsilon$, $n$, $\\mu$, $a$) are standard scientific quantities. The model is a valid and widely used approximation.\n-   **Well-Posed**: The problem is clearly stated, providing all necessary data, constants, and statistical assumptions to derive the required expression and compute the uncertainty. The objectives are specific and lead to a unique, meaningful answer.\n-   **Objective**: The problem is formulated using precise, unambiguous scientific language, free from subjective or opinion-based content.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria (e.g., scientific unsoundness, incompleteness, ambiguity). It is a standard, solvable problem in physical chemistry.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\nThe Stokes shift, $\\Delta\\tilde{\\nu}_{SS}$, which is the difference in wavenumber between the absorption maximum ($\\tilde{\\nu}_{abs}$) and the fluorescence maximum ($\\tilde{\\nu}_{flu}$), is described within the dielectric continuum model by the Lippert-Mataga equation. This equation relates the Stokes shift to the properties of the solute and the solvent. Assuming the solute dipole moments in the ground state, $\\vec{\\mu}_g$, and the first excited state, $\\vec{\\mu}_e$, are parallel, the equation is:\n$$\n\\Delta\\tilde{\\nu}_{SS} = \\tilde{\\nu}_{abs} - \\tilde{\\nu}_{flu} = \\frac{2(\\mu_e - \\mu_g)^2}{hc(4\\pi\\varepsilon_0)a^3} \\left( \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^2 - 1}{2n^2 + 1} \\right)\n$$\nHere, $h$ is the Planck constant, $c$ is the speed of light in vacuum, $\\varepsilon_0$ is the vacuum permittivity, and $a$ is the radius of the Onsager cavity containing the solute. The change in the magnitude of the dipole moment is denoted as $\\Delta\\mu = |\\mu_e - \\mu_g|$.\n\nThe problem defines the solvent polarity function as $\\Delta f \\equiv \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^2 - 1}{2n^2 + 1}$. Substituting this and $\\Delta\\mu$ into the Lippert-Mataga equation gives:\n$$\n\\Delta\\tilde{\\nu}_{SS} = \\frac{2(\\Delta\\mu)^2}{hc(4\\pi\\varepsilon_0)a^3} \\Delta f\n$$\nThe problem states that an experimental plot of $\\Delta\\tilde{\\nu}_{SS}$ versus $\\Delta f$ yields a straight line with slope $S$. By comparing the theoretical expression with the empirical linear relationship $\\Delta\\tilde{\\nu}_{SS} = S \\cdot \\Delta f + C$, we can identify the slope $S$ as:\n$$\nS = \\frac{2(\\Delta\\mu)^2}{hc(4\\pi\\varepsilon_0)a^3}\n$$\nThis is the first required expression, connecting the experimental slope $S$ to the change in dipole moment $\\Delta\\mu$.\n\nThe next task is to use this expression to find $\\Delta\\mu$ and compute its relative uncertainty. We first rearrange the equation to solve for $\\Delta\\mu$:\n$$\n(\\Delta\\mu)^2 = \\frac{S \\cdot h c (4\\pi\\varepsilon_0) a^3}{2}\n$$\n$$\n\\Delta\\mu = \\sqrt{\\frac{S \\cdot h c (4\\pi\\varepsilon_0) a^3}{2}}\n$$\nTo determine the combined relative standard uncertainty in $\\Delta\\mu$, we apply the rules of first-order uncertainty propagation. The quantities $h$, $c$, $\\varepsilon_0$, $\\pi$, and $2$ are constants without uncertainty. The uncertainty in $\\Delta\\mu$ therefore arises from the uncertainties in the measured quantities $S$ and $a$. Let $u(x)$ denote the standard uncertainty in a quantity $x$, and $u_r(x) = u(x)/|x|$ denote its relative standard uncertainty.\n\nThe expression for $\\Delta\\mu$ can be written as $\\Delta\\mu = K \\cdot S^{1/2} \\cdot a^{3/2}$, where $K = \\sqrt{hc(4\\pi\\varepsilon_0)/2}$ is a constant. For a function of the form $Y = C \\cdot X_1^{p_1} \\cdot X_2^{p_2}$, where $X_1$ and $X_2$ are independent variables, the square of the relative uncertainty in $Y$ is given by:\n$$\n(u_r(Y))^2 = p_1^2 (u_r(X_1))^2 + p_2^2 (u_r(X_2))^2\n$$\nApplying this to our expression for $\\Delta\\mu$, with variables $S$ and $a$, and exponents $p_1 = 1/2$ and $p_2 = 3/2$ respectively, we get:\n$$\n(u_r(\\Delta\\mu))^2 = \\left(\\frac{1}{2}\\right)^2 (u_r(S))^2 + \\left(\\frac{3}{2}\\right)^2 (u_r(a))^2 = \\frac{1}{4}(u_r(S))^2 + \\frac{9}{4}(u_r(a))^2\n$$\nWe now compute the relative uncertainties for $S$ and $a$ from the given data. Note that units cancel in the calculation of relative uncertainty, so no unit conversion is needed for this step.\n\nFor the slope $S$:\n$S = 2.50 \\times 10^3~\\mathrm{cm}^{-1}$ and $u(S) = 0.04 \\times 10^3~\\mathrm{cm}^{-1}$.\n$$\nu_r(S) = \\frac{u(S)}{S} = \\frac{0.04 \\times 10^3}{2.50 \\times 10^3} = \\frac{0.04}{2.50} = 0.016\n$$\nFor the cavity radius $a$:\n$a = 6.00~\\mathrm{\\AA}$ and $u(a) = 0.20~\\mathrm{\\AA}$.\n$$\nu_r(a) = \\frac{u(a)}{a} = \\frac{0.20}{6.00} = \\frac{1}{30}\n$$\nNow we substitute these values into the equation for the relative uncertainty of $\\Delta\\mu$:\n$$\n(u_r(\\Delta\\mu))^2 = \\frac{1}{4}(0.016)^2 + \\frac{9}{4}\\left(\\frac{1}{30}\\right)^2\n$$\n$$\n(u_r(\\Delta\\mu))^2 = \\frac{1}{4}(0.000256) + \\frac{9}{4}\\left(\\frac{1}{900}\\right)\n$$\n$$\n(u_r(\\Delta\\mu))^2 = 0.000064 + \\frac{1}{400} = 0.000064 + 0.0025\n$$\n$$\n(u_r(\\Delta\\mu))^2 = 0.002564\n$$\nThe combined relative standard uncertainty in $\\Delta\\mu$ is the square root of this value:\n$$\nu_r(\\Delta\\mu) = \\sqrt{0.002564} \\approx 0.05063595\n$$\nRounding this result to four significant figures as requested gives $0.05064$.",
            "answer": "$$\n\\boxed{0.05064}\n$$"
        },
        {
            "introduction": "While dielectric continuum models are powerful, their assumptions can break down in the presence of specific solute-solvent interactions like hydrogen bonding. This practice introduces the widely used Kamlet-Taft multiparameter model, an empirical approach that dissects the solvent environment into polarity/polarizability ($\\pi^\\ast$), hydrogen-bond acidity ($\\alpha$), and basicity ($\\beta$). You will implement a multiple linear regression to fit a Kamlet-Taft model to experimental data, a practical skill essential for analyzing complex solvatochromic behavior in modern chemical research. ",
            "id": "3723875",
            "problem": "Consider a charge-transfer organic dye whose lowest-energy electronic absorption band maximum is measured in multiple solvents to characterize solvatochromic behavior. In the Kamlet–Taft multiparameter approach, solvent influences are described by three descriptors: hydrogen bond donating acidity $\\alpha$, hydrogen bond accepting basicity $\\beta$, and polarity/polarizability $\\pi^\\ast$. Assume that the solvent modifies the transition energy through specific and non-specific interactions that can be captured by a first-order linear response of the wavenumber to these descriptors. The electronic transition energy $E$ and the vacuum electromagnetic relations satisfy $E = h c \\tilde{\\nu}$, where $h$ is Planck’s constant, $c$ is the speed of light, and $\\tilde{\\nu}$ is the wavenumber. The wavelength $\\lambda$ in nanometers is related to the wavenumber in inverse centimeters by $\\tilde{\\nu} = 10^7 / \\lambda$.\n\nUsing a calibration set of solvents with known descriptors and measured band maxima wavenumbers $\\tilde{\\nu}$, estimate an intercept and three coefficients that define an affine linear mapping from $(\\pi^\\ast,\\alpha,\\beta)$ to $\\tilde{\\nu}$ by minimizing the sum of squared deviations between modeled and measured $\\tilde{\\nu}$ values. Then, use the fitted model to predict new cases and convert predicted wavenumbers to wavelengths in nanometers.\n\nCalibration data (each entry provides $(\\pi^\\ast, \\alpha, \\beta)$ and the measured wavenumber $\\tilde{\\nu}$ in inverse centimeters):\n- Cyclohexane: $(0.00, 0.00, 0.00)$, $\\tilde{\\nu} = 20005$\n- Toluene: $(0.54, 0.00, 0.11)$, $\\tilde{\\nu} = 20860$\n- Acetone: $(0.71, 0.08, 0.48)$, $\\tilde{\\nu} = 21290$\n- Acetonitrile: $(0.75, 0.19, 0.31)$, $\\tilde{\\nu} = 21150$\n- Ethanol: $(0.54, 0.86, 0.75)$, $\\tilde{\\nu} = 20500$\n- Methanol: $(0.60, 0.98, 0.66)$, $\\tilde{\\nu} = 20420$\n- Dimethyl sulfoxide: $(1.00, 0.00, 0.76)$, $\\tilde{\\nu} = 21940$\n- Water: $(1.11, 1.17, 0.18)$, $\\tilde{\\nu} = 20730$\n\nUse Ordinary Least Squares (OLS) to estimate the intercept and coefficients. Then predict the absorption band maximum for the following test suite of solvents and return both the wavenumber $\\tilde{\\nu}$ (in inverse centimeters) and the wavelength $\\lambda$ (in nanometers) for each case:\n1. Nonpolar baseline: $(\\pi^\\ast, \\alpha, \\beta) = (0.00, 0.00, 0.00)$\n2. Strong hydrogen-bond donor, moderate polarity: $(\\pi^\\ast, \\alpha, \\beta) = (1.00, 1.10, 0.20)$\n3. Strongly basic, high polarity: $(\\pi^\\ast, \\alpha, \\beta) = (0.95, 0.00, 1.00)$\n4. High polarity with negligible specific interactions: $(\\pi^\\ast, \\alpha, \\beta) = (1.10, 0.00, 0.00)$\n\nRequirements:\n- Estimate the affine linear model parameters solely from the provided calibration data by minimizing the sum of squared residuals in wavenumber space.\n- For each test case, compute the predicted wavenumber $\\tilde{\\nu}$ in inverse centimeters and the corresponding wavelength $\\lambda$ in nanometers using $\\lambda = 10^7 / \\tilde{\\nu}$.\n- Express all final numerical outputs as floating-point numbers rounded to two decimal places.\n- Final output format: Your program should produce a single line of output containing a JSON-like list of lists, where each inner list corresponds to a test case and contains two floats in the order $[\\tilde{\\nu}\\text{ (in cm}^{-1}\\text{)}, \\lambda\\text{ (in nm)}]$. For example, $[[\\tilde{\\nu}_1,\\lambda_1],[\\tilde{\\nu}_2,\\lambda_2],\\dots]$.\n\nThis problem is universally solvable by constructing a design matrix from the descriptors, solving the least-squares normal equations for the parameter vector, and applying the resulting model to the specified test suite. All numerical outputs must be reported in the specified units and format.",
            "solution": "The user-provided problem has been analyzed and validated.\n\n### Step 1: Extract Givens\n- **Model Equation**: The wavenumber $\\tilde{\\nu}$ is modeled as an affine linear function of solvent descriptors $(\\pi^\\ast, \\alpha, \\beta)$: $\\tilde{\\nu} = \\tilde{\\nu}_0 + s\\pi^\\ast + a\\alpha + b\\beta$, where $\\tilde{\\nu}_0$ is the intercept, and $s$, $a$, and $b$ are the coefficients.\n- **Objective**: Estimate the parameters $(\\tilde{\\nu}_0, s, a, b)$ by minimizing the sum of squared deviations between modeled and measured $\\tilde{\\nu}$ values (Ordinary Least Squares).\n- **Physical Relation**: The wavelength $\\lambda$ in nanometers (nm) is related to the wavenumber $\\tilde{\\nu}$ in inverse centimeters (cm$^{-1}$) by $\\lambda = 10^7 / \\tilde{\\nu}$.\n- **Calibration Data**: A set of $8$ solvents with known $(\\pi^\\ast, \\alpha, \\beta)$ descriptors and measured wavenumbers $\\tilde{\\nu}$ (in cm$^{-1}$).\n    1.  Cyclohexane: $(0.00, 0.00, 0.00)$, $\\tilde{\\nu} = 20005$\n    2.  Toluene: $(0.54, 0.00, 0.11)$, $\\tilde{\\nu} = 20860$\n    3.  Acetone: $(0.71, 0.08, 0.48)$, $\\tilde{\\nu} = 21290$\n    4.  Acetonitrile: $(0.75, 0.19, 0.31)$, $\\tilde{\\nu} = 21150$\n    5.  Ethanol: $(0.54, 0.86, 0.75)$, $\\tilde{\\nu} = 20500$\n    6.  Methanol: $(0.60, 0.98, 0.66)$, $\\tilde{\\nu} = 20420$\n    7.  Dimethyl sulfoxide (DMSO): $(1.00, 0.00, 0.76)$, $\\tilde{\\nu} = 21940$\n    8.  Water: $(1.11, 1.17, 0.18)$, $\\tilde{\\nu} = 20730$\n- **Test Cases**: A set of $4$ descriptor tuples for which $\\tilde{\\nu}$ and $\\lambda$ must be predicted.\n    1.  Test Case 1: $(\\pi^\\ast, \\alpha, \\beta) = (0.00, 0.00, 0.00)$\n    2.  Test Case 2: $(\\pi^\\ast, \\alpha, \\beta) = (1.00, 1.10, 0.20)$\n    3.  Test Case 3: $(\\pi^\\ast, \\alpha, \\beta) = (0.95, 0.00, 1.00)$\n    4.  Test Case 4: $(\\pi^\\ast, \\alpha, \\beta) = (1.10, 0.00, 0.00)$\n- **Output Specifications**:\n    - Predict $\\tilde{\\nu}$ (cm$^{-1}$) and $\\lambda$ (nm) for each test case.\n    - All final numerical outputs must be floating-point numbers rounded to two decimal places.\n    - The program's final output must be a single line containing a list of lists in the format `[[v1,l1],[v2,l2],...]`.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is based on the Kamlet–Taft model, a standard and widely used empirical framework in physical organic chemistry for quantifying solvatochromism. The physical equations relating energy, wavenumber, and wavelength are fundamental. All aspects are scientifically sound.\n- **Well-Posed**: The problem is a standard application of multiple linear regression (Ordinary Least Squares). There are $8$ observations and $4$ parameters to estimate (intercept $\\tilde{\\nu}_0$, and coefficients $s, a, b$). Since the number of observations exceeds the number of parameters, the system is overdetermined. The provided descriptor values are sufficiently diverse to ensure the design matrix is of full rank, guaranteeing a unique solution.\n- **Objective**: The problem is stated using precise numerical data, established scientific models, and clear, unambiguous instructions. It is free of subjective or opinion-based content.\n- **Other Flaws**: The problem statement is complete, consistent, realistic, and formally structured. It does not exhibit any of the listed invalidity flaws.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution\nThe problem requires us to perform a multiple linear regression analysis to model the solvatochromic shift of a dye's electronic absorption maximum. The relationship between the wavenumber of the absorption maximum, $\\tilde{\\nu}$, and the solvent properties is given by the affine linear model:\n$$\n\\tilde{\\nu}_{\\text{model}} = \\tilde{\\nu}_0 + s\\pi^\\ast + a\\alpha + b\\beta\n$$\nwhere $(\\pi^\\ast, \\alpha, \\beta)$ are the Kamlet–Taft solvent parameters, and $(\\tilde{\\nu}_0, s, a, b)$ are the model parameters we need to estimate. The parameter $\\tilde{\\nu}_0$ represents the extrapolated wavenumber in a hypothetical solvent with zero polarity, acidity, and basicity, while $s$, $a$, and $b$ quantify the sensitivity of the transition energy to each solvent property.\n\nThis problem can be formulated in the language of linear algebra. Let the vector of observed wavenumbers be $\\mathbf{y}$, the vector of unknown model parameters be $\\boldsymbol{\\theta}$, and the design matrix be $\\mathbf{X}$.\n$$\n\\mathbf{y} = \\begin{pmatrix} \\tilde{\\nu}_1 \\\\ \\tilde{\\nu}_2 \\\\ \\vdots \\\\ \\tilde{\\nu}_n \\end{pmatrix}, \\quad\n\\boldsymbol{\\theta} = \\begin{pmatrix} \\tilde{\\nu}_0 \\\\ s \\\\ a \\\\ b \\end{pmatrix}, \\quad\n\\mathbf{X} = \\begin{pmatrix}\n1  \\pi^\\ast_1  \\alpha_1  \\beta_1 \\\\\n1  \\pi^\\ast_2  \\alpha_2  \\beta_2 \\\\\n\\vdots  \\vdots  \\vdots  \\vdots \\\\\n1  \\pi^\\ast_n  \\alpha_n  \\beta_n\n\\end{pmatrix}\n$$\nThe model can then be expressed as $\\mathbf{y} \\approx \\mathbf{X}\\boldsymbol{\\theta}$. The number of observations (solvents) is $n=8$.\n\nUsing the provided calibration data, the response vector $\\mathbf{y}$ is:\n$$\n\\mathbf{y} = \\begin{pmatrix} 20005 \\\\ 20860 \\\\ 21290 \\\\ 21150 \\\\ 20500 \\\\ 20420 \\\\ 21940 \\\\ 20730 \\end{pmatrix}\n$$\nAnd the design matrix $\\mathbf{X}$ is:\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1  0.00  0.00  0.00 \\\\\n1  0.54  0.00  0.11 \\\\\n1  0.71  0.08  0.48 \\\\\n1  0.75  0.19  0.31 \\\\\n1  0.54  0.86  0.75 \\\\\n1  0.60  0.98  0.66 \\\\\n1  1.00  0.00  0.76 \\\\\n1  1.11  1.17  0.18\n\\end{pmatrix}\n$$\nThe Ordinary Least Squares (OLS) method seeks to find the parameter vector $\\hat{\\boldsymbol{\\theta}}$ that minimizes the sum of squared residuals, $S(\\boldsymbol{\\theta}) = \\sum_{i=1}^n (y_i - (\\mathbf{X}\\boldsymbol{\\theta})_i)^2 = ||\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}||^2$. The solution to this minimization problem is given by the normal equations:\n$$\n(\\mathbf{X}^T \\mathbf{X}) \\hat{\\boldsymbol{\\theta}} = \\mathbf{X}^T \\mathbf{y}\n$$\nSolving for $\\hat{\\boldsymbol{\\theta}}$, we get:\n$$\n\\hat{\\boldsymbol{\\theta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}\n$$\nThe components of the resulting vector $\\hat{\\boldsymbol{\\theta}} = [\\hat{\\tilde{\\nu}}_0, \\hat{s}, \\hat{a}, \\hat{b}]^T$ are the estimated model parameters.\n\nOnce the parameters are estimated, we can predict the wavenumber $\\tilde{\\nu}_{\\text{pred}}$ for a new solvent with descriptors $(\\pi^\\ast_{\\text{new}}, \\alpha_{\\text{new}}, \\beta_{\\text{new}})$. We define a new input vector $\\mathbf{x}_{\\text{new}}$:\n$$\n\\mathbf{x}_{\\text{new}} = \\begin{pmatrix} 1 \\\\ \\pi^\\ast_{\\text{new}} \\\\ \\alpha_{\\text{new}} \\\\ \\beta_{\\text{new}} \\end{pmatrix}\n$$\nThe predicted wavenumber is the dot product of the transpose of this vector with the parameter vector:\n$$\n\\tilde{\\nu}_{\\text{pred}} = \\mathbf{x}_{\\text{new}}^T \\hat{\\boldsymbol{\\theta}} = \\hat{\\tilde{\\nu}}_0 + \\hat{s}\\pi^\\ast_{\\text{new}} + \\hat{a}\\alpha_{\\text{new}} + \\hat{b}\\beta_{\\text{new}}\n$$\nWe will perform this calculation for each of the four test cases.\n\nFinally, for each predicted wavenumber $\\tilde{\\nu}_{\\text{pred}}$ (in cm$^{-1}$), the corresponding wavelength $\\lambda_{\\text{pred}}$ (in nm) is calculated using the given formula:\n$$\n\\lambda_{\\text{pred}} = \\frac{10^7}{\\tilde{\\nu}_{\\text{pred}}}\n$$\nThe implementation will use numerical libraries to solve the linear least-squares problem, which is more numerically stable than explicitly computing the matrix inverse. The final results for $\\tilde{\\nu}_{\\text{pred}}$ and $\\lambda_{\\text{pred}}$ will be rounded to two decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits a Kamlet-Taft linear model to solvatochromic data and predicts\n    absorption maxima for new solvent conditions.\n    \"\"\"\n    \n    # Calibration data from the problem statement.\n    # Each entry is a tuple: (pi_star, alpha, beta, nu_tilde_cm_minus_1)\n    calibration_data = [\n        (0.00, 0.00, 0.00, 20005),  # Cyclohexane\n        (0.54, 0.00, 0.11, 20860),  # Toluene\n        (0.71, 0.08, 0.48, 21290),  # Acetone\n        (0.75, 0.19, 0.31, 21150),  # Acetonitrile\n        (0.54, 0.86, 0.75, 20500),  # Ethanol\n        (0.60, 0.98, 0.66, 20420),  # Methanol\n        (1.00, 0.00, 0.76, 21940),  # Dimethyl sulfoxide\n        (1.11, 1.17, 0.18, 20730),  # Water\n    ]\n\n    # Unpack calibration data into separate lists/arrays\n    pi_star_cal, alpha_cal, beta_cal, nu_tilde_cal = zip(*calibration_data)\n\n    # Convert to NumPy arrays for vectorized operations\n    y = np.array(nu_tilde_cal)\n    \n    # Construct the design matrix X for the linear model:\n    # y = X * [nu0, s, a, b]^T\n    # The first column of ones is for the intercept term (nu0).\n    X = np.column_stack([\n        np.ones(len(pi_star_cal)),\n        np.array(pi_star_cal),\n        np.array(alpha_cal),\n        np.array(beta_cal)\n    ])\n\n    # Solve the ordinary least squares problem y = X*theta\n    # This finds the coefficient vector theta = [nu0, s, a, b]\n    # that minimizes the squared Euclidean norm ||y - X*theta||^2.\n    # np.linalg.lstsq is numerically more stable than calculating the\n    # inverse of (X.T @ X).\n    coefficients, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n    # The returned 'coefficients' vector contains [nu0, s, a, b]\n\n    # Test cases for prediction, as given in the problem statement.\n    # Each entry is a tuple: (pi_star, alpha, beta)\n    test_cases = [\n        (0.00, 0.00, 0.00),  # Nonpolar baseline\n        (1.00, 1.10, 0.20),  # Strong H-bond donor, moderate polarity\n        (0.95, 0.00, 1.00),  # Strongly basic, high polarity\n        (1.10, 0.00, 0.00)   # High polarity, negligible specific interactions\n    ]\n\n    results = []\n    for pi_star_test, alpha_test, beta_test in test_cases:\n        # Create the input vector for prediction (including the 1 for the intercept)\n        x_new = np.array([1, pi_star_test, alpha_test, beta_test])\n        \n        # Predict the wavenumber using the fitted model\n        # nu_pred = nu0 + s*pi_star + a*alpha + b*beta\n        nu_pred = np.dot(x_new, coefficients)\n        \n        # Convert the predicted wavenumber (in cm^-1) to wavelength (in nm)\n        # lambda = 10^7 / nu\n        lambda_pred = 10**7 / nu_pred\n        \n        # Store the pair of results\n        results.append([nu_pred, lambda_pred])\n    \n    # Format the output string as a JSON-like list of lists with two-decimal precision.\n    # e.g., \"[[val1, val2],[val3, val4]]\"\n    inner_lists = [f\"[{res[0]:.2f},{res[1]:.2f}]\" for res in results]\n    final_output = f\"[{','.join(inner_lists)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "In scientific practice, multiple theories can often explain the same phenomenon, and choosing the most appropriate model is a critical task. This advanced exercise simulates a real research scenario where you must evaluate several competing solvatochromic models, including the Lippert-Mataga, ET(30), and Kamlet-Taft frameworks. You will use statistical information criteria (AIC/BIC) for principled model selection and then apply the best model to make a prediction for a new solvent, complete with a quantified uncertainty interval, encapsulating a full cycle of data analysis and validation. ",
            "id": "3723867",
            "problem": "You are given three independent datasets of electronic absorption maxima for a single solvatochromic organic dye measured in different solvents. The purpose is to perform principled regression, quantify uncertainty, and select among competing solvent-descriptor models to aid spectrometric identification. All spectral maxima are provided as wavenumbers, and all outputs that involve physical quantities must be internally handled in $\\mathrm{cm^{-1}}$; however, your program’s final output must be unitless integers and booleans only, as specified.\n\nFundamental base to be used:\n- Solvatochromism arises because solvents differentially stabilize the ground and excited electronic states of a solute; a widely used descriptor for dipolar stabilization is the Lippert–Mataga polarity function derived from macroscopic dielectric and refractive properties. The Lorentz–Lorenz and Onsager-based polarity function is\n$$\n\\Delta f = \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^2 - 1}{2 n^2 + 1},\n$$\nwhere $\\varepsilon$ is the static relative permittivity (dielectric constant) and $n$ is the refractive index (at optical frequency).\n- The $\\mathrm{ET(30)}$ scale, measured in $\\mathrm{kcal\\,mol^{-1}}$, is a widely used empirical solvent polarity scale for correlation with electronic spectral shifts.\n- The Kamlet–Taft multiparameter approach uses solvent polarity/polarizability $\\pi^\\ast$, hydrogen-bond donor acidity $\\alpha$, and hydrogen-bond acceptor basicity $\\beta$ as descriptors to correlate spectral properties.\n- Assume additive, independent, identically distributed Gaussian noise in measured wavenumbers. Under Gaussian noise, maximum likelihood estimation coincides with ordinary least squares for linear models, and information criteria such as Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC) compare models by balancing fit and complexity.\n\nCandidate models to be fit to each dataset:\n- Model $\\#1$ (Lippert–Mataga): a linear response of the wavenumber to $\\Delta f$ with an intercept and one slope parameter.\n- Model $\\#2$ ($\\mathrm{ET(30)}$): a linear response of the wavenumber to $\\mathrm{ET(30)}$ with an intercept and one slope parameter.\n- Model $\\#3$ (Kamlet–Taft): a linear response of the wavenumber to $\\pi^\\ast$, $\\alpha$, and $\\beta$ with an intercept and three slope parameters.\n\nYou must use principled regression from the above base, quantify parameter and prediction uncertainties, and perform model selection with AIC as the primary criterion and BIC as the tie-breaker if needed. Then, for a specified hold-out solvent, construct a $95\\%$ prediction interval (using a two-sided confidence level of $0.95$) and report whether the measured hold-out wavenumber lies within that interval. Angles are not involved; no angle unit is required. All numerical processing of spectral values must be in $\\mathrm{cm^{-1}}$.\n\nSolvent descriptor table (use the same descriptors for all three datasets):\n- Solvents and their descriptors $\\{\\varepsilon, n, \\mathrm{ET(30)}, \\pi^\\ast, \\alpha, \\beta\\}$:\n    - Hexane: $\\varepsilon = 1.89$, $n = 1.375$, $\\mathrm{ET(30)} = 31.0$, $\\pi^\\ast = 0.00$, $\\alpha = 0.00$, $\\beta = 0.00$.\n    - Toluene: $\\varepsilon = 2.38$, $n = 1.496$, $\\mathrm{ET(30)} = 33.9$, $\\pi^\\ast = 0.54$, $\\alpha = 0.00$, $\\beta = 0.11$.\n    - Dichloromethane: $\\varepsilon = 8.93$, $n = 1.424$, $\\mathrm{ET(30)} = 40.7$, $\\pi^\\ast = 0.82$, $\\alpha = 0.00$, $\\beta = 0.10$.\n    - Acetonitrile: $\\varepsilon = 37.5$, $n = 1.344$, $\\mathrm{ET(30)} = 45.8$, $\\pi^\\ast = 0.75$, $\\alpha = 0.19$, $\\beta = 0.31$.\n    - Ethanol: $\\varepsilon = 24.55$, $n = 1.361$, $\\mathrm{ET(30)} = 51.9$, $\\pi^\\ast = 0.54$, $\\alpha = 0.86$, $\\beta = 0.75$.\n    - Water (hold-out solvent): $\\varepsilon = 78.4$, $n = 1.333$, $\\mathrm{ET(30)} = 63.1$, $\\pi^\\ast = 1.10$, $\\alpha = 1.17$, $\\beta = 0.47$.\n\nDatasets and measured wavenumbers (training set: the first five solvents; hold-out test: water):\n- Dataset $\\mathrm{A}$ (training measurements in $\\mathrm{cm^{-1}}$): Hexane $= 21030$, Toluene $= 20930$, Dichloromethane $= 20160$, Acetonitrile $= 19760$, Ethanol $= 19890$. Hold-out (Water) measured wavenumber: $19700$.\n- Dataset $\\mathrm{B}$ (training measurements in $\\mathrm{cm^{-1}}$): Hexane $= 19980$, Toluene $= 19790$, Dichloromethane $= 19490$, Acetonitrile $= 19190$, Ethanol $= 18870$. Hold-out (Water) measured wavenumber: $18360$.\n- Dataset $\\mathrm{C}$ (training measurements in $\\mathrm{cm^{-1}}$): Hexane $= 20520$, Toluene $= 20060$, Dichloromethane $= 19880$, Acetonitrile $= 19820$, Ethanol $= 19440$. Hold-out (Water) measured wavenumber: $19000$.\n\nYour program must:\n- For each dataset, construct all three candidate linear models using the specified descriptors and training solvents.\n- Fit model parameters by maximum likelihood under Gaussian noise using ordinary least squares.\n- Compute the maximum likelihood log-likelihood under Gaussian noise, and then compute AIC and BIC; treat the noise variance as an estimated parameter when counting parameters for information criteria.\n- Select the best model for each dataset by the smallest AIC; use BIC to break ties if AIC values are equal within numerical tolerance.\n- For the hold-out solvent (Water), form the $95\\%$ two-sided prediction interval for the selected model using the appropriate degrees of freedom from the training fit. Report whether the provided measured hold-out wavenumber lies inside this interval as a boolean.\n\nTest suite:\n- Case $\\#1$: Dataset $\\mathrm{A}$.\n- Case $\\#2$: Dataset $\\mathrm{B}$.\n- Case $\\#3$: Dataset $\\mathrm{C}$.\n\nFinal output format:\n- Your program should produce a single line containing a comma-separated list enclosed in square brackets, of length $6$, with entries\n$$\n[\\mathrm{m_A}, \\mathrm{m_B}, \\mathrm{m_C}, \\mathrm{c_A}, \\mathrm{c_B}, \\mathrm{c_C}],\n$$\nwhere $\\mathrm{m_A}$, $\\mathrm{m_B}$, $\\mathrm{m_C}$ are integers in $\\{1,2,3\\}$ indicating the selected model index for datasets $\\mathrm{A}$, $\\mathrm{B}$, and $\\mathrm{C}$ respectively, and $\\mathrm{c_A}$, $\\mathrm{c_B}$, $\\mathrm{c_C}$ are booleans indicating whether the measured hold-out wavenumber for Water lies within the corresponding $95\\%$ prediction interval. The single printed line must match this format exactly, for example, $\\,[1,2,3,True,False,True]\\,$.",
            "solution": "The user has provided a problem centered on the spectrometric identification of an organic compound through analysis of solvatochromism. The task is to model the shift in the electronic absorption maximum (given as wavenumber, $\\tilde{\\nu}$) of a dye in various solvents using three different established linear free-energy relationship models. The core of the problem involves performing linear regression, using principled statistical methods (Akaike and Bayesian Information Criteria) to select the most appropriate model for three separate datasets, and then using the selected model to make a prediction for a hold-out solvent and quantify its uncertainty via a prediction interval.\n\n### Step 1: Problem Validation\nThe problem statement has been evaluated against the required criteria.\n- **Givens**: All necessary data are provided, including solvent physical properties ($\\varepsilon, n$), empirical solvent scale values ($\\mathrm{ET(30)}, \\pi^\\ast, \\alpha, \\beta$), and three datasets of measured wavenumbers ($\\tilde{\\nu}$) for a training set of five solvents and a hold-out solvent (Water). The models, fitting procedure (OLS), model selection criteria (AIC, BIC), and prediction interval confidence level ($95\\%$) are explicitly defined.\n- **Scientific Grounding**: The problem is firmly rooted in physical chemistry and chemometrics. The Lippert–Mataga equation, $\\mathrm{ET(30)}$ scale, and Kamlet–Taft parameters are standard descriptors for solvatochromic effects. The statistical methods—Ordinary Least Squares (OLS), Maximum Likelihood Estimation (MLE), Akaike Information Criterion (AIC), Bayesian Information Criterion (BIC), and the construction of prediction intervals—are standard and appropriate for the task.\n- **Well-Posedness and Consistency**: The problem is well-posed. For each model, the number of data points ($n=5$) is greater than or equal to the number of mean parameters to be estimated ($p \\le 4$), allowing for a unique OLS solution provided the design matrices are of full rank, which they are. The instructions for calculating AIC/BIC, including the treatment of variance as an estimated parameter, are specific. The procedure for model selection and prediction is unambiguous. There are no internal contradictions. For model 3, the number of total estimated parameters ($K=p+1=5$) equals the number of data points ($n=5$). While this is an edge case, all calculations remain mathematically defined and the statistical methodology correctly handles the associated high uncertainty (e.g., low degrees of freedom for the t-distribution).\n\nThe problem is deemed valid and scientifically sound.\n\n### Step 2: Principled Solution Development\n\nThe solution will proceed by implementing the specified statistical analysis for each of the three datasets provided.\n\n#### 1. Candidate Models and Descriptors\nFor each dataset, we will fit the observed wavenumbers $\\tilde{\\nu}$ against descriptors for the five training solvents (Hexane, Toluene, Dichloromethane, Acetonitrile, Ethanol). Let $y_i$ be the observed wavenumber for solvent $i$.\n\nThe three candidate linear models are:\n- **Model 1 (Lippert–Mataga)**: This model correlates the wavenumber with the solvent polarity function $\\Delta f$.\n$$ y_i = \\beta_0 + \\beta_1 (\\Delta f)_i + \\epsilon_i $$\nThe descriptor $\\Delta f$ is calculated from the static relative permittivity $\\varepsilon$ and refractive index $n$ as:\n$$ \\Delta f = \\frac{\\varepsilon - 1}{2\\varepsilon + 1} - \\frac{n^2 - 1}{2 n^2 + 1} $$\n\n- **Model 2 (ET(30))**: This model uses the empirical $\\mathrm{ET(30)}$ solvent polarity scale.\n$$ y_i = \\beta_0 + \\beta_1 (\\mathrm{ET(30)})_i + \\epsilon_i $$\n\n- **Model 3 (Kamlet–Taft)**: This is a multiparameter model incorporating solvent polarity/polarizability ($\\pi^\\ast$), hydrogen-bond donor acidity ($\\alpha$), and hydrogen-bond acceptor basicity ($\\beta$).\n$$ y_i = \\beta_0 + \\beta_1 (\\pi^\\ast)_i + \\beta_2 (\\alpha)_i + \\beta_3 (\\beta)_i + \\epsilon_i $$\n\nIn all models, $\\epsilon_i$ represents the noise term, assumed to be independent and identically distributed as a Gaussian, $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$.\n\n#### 2. Parameter Estimation\nUnder the assumption of i.i.d. Gaussian noise, maximizing the likelihood of the data is equivalent to minimizing the sum of squared residuals. This is the principle of Ordinary Least Squares (OLS). For a general linear model $y = X\\beta + \\epsilon$, the OLS estimate for the coefficient vector $\\beta$ is:\n$$ \\hat{\\beta} = (X^T X)^{-1} X^T y $$\nwhere $y$ is the vector of observed wavenumbers and $X$ is the design matrix, whose columns consist of a constant ($1$) for the intercept and the values of the solvent descriptors for each model. The Residual Sum of Squares ($RSS$) is then calculated as:\n$$ RSS = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2 = \\| y - X\\hat{\\beta} \\|^2 $$\nwhere $\\hat{y}_i = (X\\hat{\\beta})_i$ are the fitted values.\n\n#### 3. Model Selection\nTo compare the performance of the three models, we use information criteria that balance goodness-of-fit with model complexity. The problem specifies using the Akaike Information Criterion (AIC) primarily, and the Bayesian Information Criterion (BIC) as a tie-breaker.\n\nThe maximized log-likelihood for a linear model with Gaussian noise is given by:\n$$ L_{\\text{max}} = -\\frac{n}{2} \\left( \\ln(2\\pi) + \\ln\\left(\\frac{RSS}{n}\\right) + 1 \\right) $$\nwhere $n$ is the number of data points. For our case, $n=5$.\n\nThe problem states that the noise variance $\\sigma^2$ should be counted as an estimated parameter. Thus, the total number of estimated parameters, $K$, for a model with $p$ coefficients (including the intercept) is $K = p+1$.\n- Models 1  2: $p=2$ coefficients ($\\beta_0, \\beta_1$), so $K=3$.\n- Model 3: $p=4$ coefficients ($\\beta_0, \\beta_1, \\beta_2, \\beta_3$), so $K=5$.\n\nThe AIC and BIC are then calculated as:\n$$ \\mathrm{AIC} = -2 L_{\\text{max}} + 2K $$\n$$ \\mathrm{BIC} = -2 L_{\\text{max}} + K \\ln(n) $$\nThe model with the lowest AIC is selected. If two models have AIC values that are equal within a small numerical tolerance, the one with the lower BIC is chosen.\n\n#### 4. Prediction and Uncertainty Quantification\nFor the best model selected for each dataset, we will predict the wavenumber for the hold-out solvent (Water) and construct a $95\\%$ prediction interval.\n\nThe predicted value, $\\hat{y}_0$, for a new vector of descriptors $x_0$ is:\n$$ \\hat{y}_0 = x_0^T \\hat{\\beta} $$\n\nThe two-sided $(1-\\alpha_{conf})\\%$ prediction interval is given by:\n$$ \\hat{y}_0 \\pm t_{1-\\alpha_{conf}/2, \\, n-p} \\cdot s_e \\cdot \\sqrt{1 + x_0^T(X^T X)^{-1}x_0} $$\n- $\\alpha_{conf} = 0.05$ for a $95\\%$ interval.\n- $t_{1-\\alpha_{conf}/2, \\, n-p}$ is the critical value from the Student's t-distribution with $n-p$ degrees of freedom.\n- $s_e = \\sqrt{\\frac{RSS}{n-p}}$ is the standard error of the regression, based on the unbiased estimator of the variance $\\sigma^2$.\n- The term $\\sqrt{1 + x_0^T(X^T X)^{-1}x_0}$ accounts for both the uncertainty in the estimated mean and the inherent variability of a new observation.\n\nFinally, we will determine if the experimentally measured wavenumber for Water falls within this calculated interval.\n\n#### 5. Computational Implementation\nThe program will execute the following for each dataset:\n1.  Construct the design matrices $X_1, X_2, X_3$ for the three models using the provided solvent data. The $\\Delta f$ values will be pre-calculated.\n2.  For each model, perform OLS regression to find $\\hat{\\beta}$ and $RSS$.\n3.  Calculate $L_{\\text{max}}$, AIC, and BIC for each model.\n4.  Select the best model index ($1, 2,$ or $3$) based on the minimum AIC/BIC.\n5.  For the selected model, calculate the $95\\%$ prediction interval for Water.\n6.  Check if the measured $\\tilde{\\nu}_{\\text{Water}}$ is contained within the interval.\n7.  Aggregate the results from all three datasets into the specified output format.\nThis procedure will be implemented in Python using the `numpy` library for numerical computations and `scipy.stats` for the t-distribution.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Solves the solvatochromism model selection problem for three datasets.\n    \"\"\"\n    \n    # Define solvent properties and datasets as provided in the problem.\n    solvent_data = {\n        'Hexane':          {'e': 1.89,  'n': 1.375, 'et30': 31.0, 'pi': 0.00, 'a': 0.00, 'b': 0.00},\n        'Toluene':         {'e': 2.38,  'n': 1.496, 'et30': 33.9, 'pi': 0.54, 'a': 0.00, 'b': 0.11},\n        'Dichloromethane': {'e': 8.93,  'n': 1.424, 'et30': 40.7, 'pi': 0.82, 'a': 0.00, 'b': 0.10},\n        'Acetonitrile':    {'e': 37.5,  'n': 1.344, 'et30': 45.8, 'pi': 0.75, 'a': 0.19, 'b': 0.31},\n        'Ethanol':         {'e': 24.55, 'n': 1.361, 'et30': 51.9, 'pi': 0.54, 'a': 0.86, 'b': 0.75},\n        'Water':           {'e': 78.4,  'n': 1.333, 'et30': 63.1, 'pi': 1.10, 'a': 1.17, 'b': 0.47}\n    }\n\n    # Calculate the Lippert-Mataga descriptor (Delta f) for all solvents.\n    for name, props in solvent_data.items():\n        e = props['e']\n        n = props['n']\n        term1 = (e - 1) / (2 * e + 1)\n        term2 = (n**2 - 1) / (2 * n**2 + 1)\n        solvent_data[name]['df'] = term1 - term2\n\n    training_solvents = ['Hexane', 'Toluene', 'Dichloromethane', 'Acetonitrile', 'Ethanol']\n    holdout_solvent = 'Water'\n    n_train = len(training_solvents)\n\n    # Define the three datasets\n    test_cases = [\n        # Dataset A\n        {'y_train': np.array([21030, 20930, 20160, 19760, 19890]), 'y_holdout': 19700},\n        # Dataset B\n        {'y_train': np.array([19980, 19790, 19490, 19190, 18870]), 'y_holdout': 18360},\n        # Dataset C\n        {'y_train': np.array([20520, 20060, 19880, 19820, 19440]), 'y_holdout': 19000},\n    ]\n\n    # Prepare design matrices for the three models\n    X1 = np.array([[1, solvent_data[s]['df']] for s in training_solvents])\n    X2 = np.array([[1, solvent_data[s]['et30']] for s in training_solvents])\n    X3 = np.array([[1, solvent_data[s]['pi'], solvent_data[s]['a'], solvent_data[s]['b']] for s in training_solvents])\n\n    model_specs = [\n        {'X': X1, 'p': 2, 'K': 3, 'label': 1},\n        {'X': X2, 'p': 2, 'K': 3, 'label': 2},\n        {'X': X3, 'p': 4, 'K': 5, 'label': 3},\n    ]\n\n    model_indices = []\n    containment_bools = []\n\n    for case in test_cases:\n        y_train = case['y_train']\n        y_holdout = case['y_holdout']\n        \n        model_results = []\n        for spec in model_specs:\n            X, p, K = spec['X'], spec['p'], spec['K']\n            \n            # Perform Ordinary Least Squares regression\n            beta, rss_list, rank, s_vals = np.linalg.lstsq(X, y_train, rcond=None)\n            rss = rss_list[0] if len(rss_list) > 0 else 0.0\n            \n            # Calculate AIC and BIC\n            if rss  1e-12: # Check for a numerically perfect fit, which is problematic\n                aic, bic = float('inf'), float('inf')\n            else:\n                log_likelihood = -n_train / 2 * (np.log(2 * np.pi) + np.log(rss / n_train) + 1)\n                aic = -2 * log_likelihood + 2 * K\n                bic = -2 * log_likelihood + K * np.log(n_train)\n            \n            model_results.append({'aic': aic, 'bic': bic, 'beta': beta, 'rss': rss})\n            \n        # Select the best model based on AIC, with BIC as a tie-breaker\n        min_aic = min(res['aic'] for res in model_results)\n        best_model_candidates = [i for i, res in enumerate(model_results) if np.isclose(res['aic'], min_aic, atol=1e-9)]\n        \n        best_model_idx = -1\n        if len(best_model_candidates) == 1:\n            best_model_idx = best_model_candidates[0]\n        else:\n            min_bic_in_tie = float('inf')\n            for i in best_model_candidates:\n                if model_results[i]['bic']  min_bic_in_tie:\n                    min_bic_in_tie = model_results[i]['bic']\n                    best_model_idx = i\n        \n        model_indices.append(model_specs[best_model_idx]['label'])\n\n        # Construct 95% prediction interval for the hold-out solvent using the best model\n        best_model_fit = model_results[best_model_idx]\n        best_model_spec = model_specs[best_model_idx]\n        X_best, p_best = best_model_spec['X'], best_model_spec['p']\n        \n        # Define predictor vector for water\n        if best_model_idx == 0:  # Model 1\n            x0 = np.array([1, solvent_data[holdout_solvent]['df']])\n        elif best_model_idx == 1:  # Model 2\n            x0 = np.array([1, solvent_data[holdout_solvent]['et30']])\n        else:  # Model 3\n            x0 = np.array([1, solvent_data[holdout_solvent]['pi'], solvent_data[holdout_solvent]['a'], solvent_data[holdout_solvent]['b']])\n            \n        y0_pred = x0 @ best_model_fit['beta']\n        \n        df = n_train - p_best\n        containment = False\n        if df > 0 and best_model_fit['rss'] > 1e-12:\n            s_e = np.sqrt(best_model_fit['rss'] / df)\n            t_val = t.ppf(0.975, df)\n            \n            try:\n                # Solve (X^T X)z = x_0 to find z, then compute leverage as sqrt(1 + x_0^T z)\n                z = np.linalg.solve(X_best.T @ X_best, x0)\n                leverage = np.sqrt(1 + x0.T @ z)\n                margin_of_error = t_val * s_e * leverage\n                \n                lower_bound = y0_pred - margin_of_error\n                upper_bound = y0_pred + margin_of_error\n                \n                containment = lower_bound = y_holdout = upper_bound\n            except np.linalg.LinAlgError:\n                # In case of singularity, interval cannot be computed\n                containment = False\n\n        containment_bools.append(containment)\n\n    # Combine results and print in the specified format\n    final_output = model_indices + containment_bools\n    print(f\"[{','.join(map(str, final_output))}]\")\n\nsolve()\n```"
        }
    ]
}