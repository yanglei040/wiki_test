{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of quantitative analysis using absorption spectroscopy is the Beer-Lambert law, which establishes a linear relationship between a substance's concentration and its absorbance of light. This first practice invites you to build this fundamental law from the ground up, starting from the differential attenuation of light passing through a medium. By engaging with this derivation , you will solidify your understanding of the physical principles governing light-matter interaction and the conditions required for this linear relationship to hold.",
            "id": "3726853",
            "problem": "An organic analyte with a single dominant $\\pi \\rightarrow \\pi^{*}$ electronic transition in the ultraviolet portion of the electromagnetic spectrum is measured by ultraviolet-visible (UV-Vis) absorption spectrometry at a wavelength of $280\\ \\mathrm{nm}$ in a quartz cell of path length $l = 1.0\\ \\mathrm{cm}$. The spectrometer reports a decadic absorbance of $A = 0.75$ and the analyte’s tabulated molar decadic absorption coefficient at $280\\ \\mathrm{nm}$ is $\\epsilon = 5600\\ \\mathrm{M}^{-1}\\mathrm{cm}^{-1}$. Starting from first principles that govern the attenuation of electromagnetic radiation by a homogeneous absorbing medium and the definition of decadic absorbance, derive the relationship appropriate for determining the analyte concentration $c$ and evaluate $c$ numerically. In your reasoning, articulate the physical conditions under which the linear proportionality between absorbance and concentration holds and assess whether the measured absorbance falls within the commonly reliable linear range for UV-Vis measurements in solution. Express the final concentration in millimolar (mM), and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the Beer-Lambert law from first principles, an assessment of its applicability under the given conditions, and the calculation of an analyte's concentration.\n\nThe fundamental principle governing the attenuation of electromagnetic radiation as it passes through a homogeneous absorbing medium is that the differential decrease in radiant intensity, $dI$, upon passing through a differential path length, $dx$, is proportional to the incident intensity, $I$, and the concentration of the absorbing species, $c$. This can be expressed as a differential equation:\n$$\ndI = -k' I c \\, dx\n$$\nwhere $k'$ is a proportionality constant characteristic of the absorbing substance at a specific wavelength. The negative sign indicates that the intensity decreases as the radiation passes through the medium.\n\nTo find the total attenuation over a finite path length $l$, we must integrate this equation. We rearrange the equation to separate the variables $I$ and $x$:\n$$\n\\frac{dI}{I} = -k' c \\, dx\n$$\nWe integrate the left side from the initial intensity, $I_0$, at the front of the sample cell (where $x=0$) to the transmitted intensity, $I_t$, at the end of the cell (where $x=l$). Assuming the concentration $c$ is uniform throughout the homogeneous solution, we can treat it as a constant during the integration of the right side:\n$$\n\\int_{I_0}^{I_t} \\frac{dI}{I} = \\int_{0}^{l} -k' c \\, dx = -k' c \\int_{0}^{l} dx\n$$\nEvaluating the integrals gives:\n$$\n[\\ln(I)]_{I_0}^{I_t} = -k' c [x]_{0}^{l}\n$$\n$$\n\\ln(I_t) - \\ln(I_0) = -k' c (l - 0)\n$$\n$$\n\\ln\\left(\\frac{I_t}{I_0}\\right) = -k' c l\n$$\nThe ratio $\\frac{I_t}{I_0}$ is defined as the transmittance, $T$. Spectrometric measurements, however, typically use the concept of absorbance. The decadic absorbance, $A$, is defined as the negative base-$10$ logarithm of the transmittance:\n$$\nA = -\\log_{10}(T) = -\\log_{10}\\left(\\frac{I_t}{I_0}\\right) = \\log_{10}\\left(\\frac{I_0}{I_t}\\right)\n$$\nTo relate our derived equation to decadic absorbance, we use the change of base formula for logarithms: $\\ln(x) = \\ln(10) \\log_{10}(x)$. Applying this to our integrated equation:\n$$\n\\ln(10) \\log_{10}\\left(\\frac{I_t}{I_0}\\right) = -k' c l\n$$\nSubstituting the definition of $A = -\\log_{10}\\left(\\frac{I_t}{I_0}\\right)$:\n$$\n\\ln(10) (-A) = -k' c l\n$$\n$$\nA = \\frac{k'}{\\ln(10)} c l\n$$\nThis equation shows a linear relationship between absorbance, $A$, and both concentration, $c$, and path length, $l$. The term $\\frac{k'}{\\ln(10)}$ combines the intrinsic absorption property of the substance and the conversion factor between natural and base-$10$ logarithms into a single constant. This term is defined as the molar decadic absorption coefficient, $\\epsilon$:\n$$\n\\epsilon \\equiv \\frac{k'}{\\ln(10)}\n$$\nSubstituting $\\epsilon$ into the equation yields the well-known Beer-Lambert law:\n$$\nA = \\epsilon c l\n$$\nThis is the required relationship for determining the analyte concentration.\n\nThe linear proportionality expressed by the Beer-Lambert law holds under specific conditions:\n$1$. The incident radiation must be monochromatic, as $\\epsilon$ is a function of wavelength. Deviations can occur if the spectrometer's spectral bandwidth is wide relative to the features of the absorption spectrum.\n$2$. The solution must be dilute (typically, $c < 0.01\\ \\mathrm{M}$). At higher concentrations, intermolecular interactions can alter the analyte's absorptivity, leading to deviations from linearity.\n$3$. The absorbing species must not undergo chemical changes, such as association, dissociation, or reaction with the solvent, as this would change the nature and concentration of the absorbing entity.\n$4$. The sample must be homogeneous, and there should be no scattering of light from suspended particles.\n$5$. The instrumental measurement must be free from significant stray light, which particularly affects accuracy at high absorbance values.\n\nThe problem states a measured absorbance of $A = 0.75$. For quantitative UV-Vis spectrometry, the most reliable measurements are typically obtained in the absorbance range of approximately $0.1$ to $1.0$. Below $A \\approx 0.1$, the signal-to-noise ratio is often poor because the difference between $I_0$ and $I_t$ is small. Above $A \\approx 1.0$ (which corresponds to $10\\%$ transmittance), very little light reaches the detector, and any stray light can become a significant fraction of the detected signal, causing negative deviations from linearity. Therefore, the measured value of $A = 0.75$ falls squarely within the optimal linear range for reliable quantitative analysis.\n\nTo calculate the concentration $c$, we rearrange the Beer-Lambert law:\n$$\nc = \\frac{A}{\\epsilon l}\n$$\nWe are given the following values:\nAbsorbance, $A = 0.75$ (dimensionless).\nMolar decadic absorption coefficient, $\\epsilon = 5600\\ \\mathrm{M}^{-1}\\mathrm{cm}^{-1}$.\nPath length, $l = 1.0\\ \\mathrm{cm}$.\n\nSubstituting these values into the equation:\n$$\nc = \\frac{0.75}{(5600\\ \\mathrm{M}^{-1}\\mathrm{cm}^{-1})(1.0\\ \\mathrm{cm})} = \\frac{0.75}{5600}\\ \\mathrm{M}\n$$\n$$\nc \\approx 0.00013392857\\ \\mathrm{M}\n$$\nThe problem requires the final concentration to be expressed in millimolar (mM). We convert the units using the relationship $1\\ \\mathrm{M} = 1000\\ \\mathrm{mM}$:\n$$\nc \\approx 0.00013392857\\ \\mathrm{mol\\ L^{-1}} \\times \\frac{1000\\ \\mathrm{mmol}}{1\\ \\mathrm{mol}} = 0.13392857\\ \\mathrm{mM}\n$$\nFinally, rounding the answer to four significant figures as instructed:\n$$\nc \\approx 0.1339\\ \\mathrm{mM}\n$$",
            "answer": "$$\\boxed{0.1339}$$"
        },
        {
            "introduction": "Ideal models are powerful, but understanding their limitations is key to expert practice. While the Beer-Lambert law predicts a perfectly linear response, real instruments are subject to non-idealities, such as stray light, which can cause significant deviations, especially at high absorbance values. This exercise  challenges you to mathematically model the effect of stray light, deriving how it distorts the measured absorbance and providing a crucial lesson in assessing the accuracy and reliable range of spectrometric data.",
            "id": "3726921",
            "problem": "An ultraviolet-visible (UV-Vis) absorption spectrometer is used to identify an organic chromophore with a strong $\\pi \\rightarrow \\pi^{\\ast}$ transition near $\\lambda_{0} = 280\\,\\mathrm{nm}$, within the electromagnetic spectrum. The instrument employs a monochromator with finite stray light rejection ratio, defined as the ratio $\\mathcal{R}$ of in-band radiant power to out-of-band stray radiant power reaching the detector when no sample is present. In such an instrument, stray light produces a sample-independent additive intensity at the detector. The chromophore solution follows the Beer–Lambert law, where the true absorbance is given by $A_{\\text{true}} = \\varepsilon(\\lambda_{0})\\,b\\,c$, with $\\varepsilon(\\lambda_{0})$ the molar absorptivity, $b$ the path length, and $c$ the concentration. Absorbance is defined by $A = -\\log_{10}(T)$, where transmittance $T$ is the ratio of transmitted to incident radiant power.\n\nStarting from these definitions and the physical model that the measured detector intensity at $\\lambda_{0}$ is the sum of the sample-attenuated in-band intensity and a stray component proportional to the incident intensity with proportionality $1/\\mathcal{R}$, derive the expression for the apparent (measured) absorbance $A_{\\text{meas}}$ in terms of $A_{\\text{true}}$ and $\\mathcal{R}$.\n\nThen, for a solution with $\\varepsilon(\\lambda_{0}) = 1.2 \\times 10^{4}\\,\\mathrm{L\\,mol^{-1}\\,cm^{-1}}$, $b = 1.00\\,\\mathrm{cm}$, and $c = 2.5 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$, measured on an instrument with $\\mathcal{R} = 5.0 \\times 10^{4}$, compute the numerical value of $A_{\\text{meas}}$ at $\\lambda_{0}$. Round your answer to $4$ significant figures. Express the final absorbance value as a pure number (unitless).",
            "solution": "The problem requires the derivation of an expression for the apparent absorbance, $A_{\\text{meas}}$, measured by a spectrometer with finite stray light, and the calculation of its numerical value for a given sample and instrument configuration.\n\nFirst, we establish the physical model for the measurement. Let $P_{0, \\lambda_0}$ represent the radiant power of the in-band light at the analysis wavelength $\\lambda_0$ that is incident on the sample holder. Let $P_{s,0}$ represent the radiant power of all out-of-band, or stray, light that is also incident on the sample holder.\n\nWhen performing a reference measurement (with a blank), the total radiant power reaching the detector, $P_{\\text{ref}}$, is the sum of the in-band and stray components, assuming the blank is perfectly transparent to all radiation.\n$$P_{\\text{ref}} = P_{0, \\lambda_0} + P_{s,0}$$\n\nWhen the sample is placed in the beam, it absorbs the in-band light according to the Beer-Lambert law. The true transmittance of the sample at $\\lambda_0$ is $T_{\\text{true}} = 10^{-A_{\\text{true}}}$, where $A_{\\text{true}}$ is the true absorbance. The radiant power of the in-band light transmitted through the sample is thus $P_{0, \\lambda_0} \\cdot T_{\\text{true}} = P_{0, \\lambda_0} \\cdot 10^{-A_{\\text{true}}}$.\n\nThe stray light, being at wavelengths where the sample is presumed non-absorbing, passes through unattenuated. Therefore, the stray radiant power reaching the detector is still $P_{s,0}$. The total radiant power measured with the sample, $P_{\\text{meas}}$, is the sum of the transmitted in-band power and the unattenuated stray power:\n$$P_{\\text{meas}} = (P_{0, \\lambda_0} \\cdot 10^{-A_{\\text{true}}}) + P_{s,0}$$\n\nThe apparent transmittance measured by the instrument, $T_{\\text{meas}}$, is the ratio of the total power measured with the sample to the total power measured with the reference:\n$$T_{\\text{meas}} = \\frac{P_{\\text{meas}}}{P_{\\text{ref}}} = \\frac{P_{0, \\lambda_0} \\cdot 10^{-A_{\\text{true}}} + P_{s,0}}{P_{0, \\lambda_0} + P_{s,0}}$$\n\nThe problem provides the definition of the stray light rejection ratio, $\\mathcal{R}$, as the ratio of in-band radiant power to out-of-band stray radiant power:\n$$\\mathcal{R} = \\frac{P_{0, \\lambda_0}}{P_{s,0}}$$\nFrom this relationship, we can express the stray power as $P_{s,0} = \\frac{P_{0, \\lambda_0}}{\\mathcal{R}}$.\n\nSubstituting this expression for $P_{s,0}$ into the equation for $T_{\\text{meas}}$ allows us to eliminate the explicit power terms:\n$$T_{\\text{meas}} = \\frac{P_{0, \\lambda_0} \\cdot 10^{-A_{\\text{true}}} + \\frac{P_{0, \\lambda_0}}{\\mathcal{R}}}{P_{0, \\lambda_0} + \\frac{P_{0, \\lambda_0}}{\\mathcal{R}}}$$\nWe can factor $P_{0, \\lambda_0}$ from both the numerator and the denominator and cancel it:\n$$T_{\\text{meas}} = \\frac{P_{0, \\lambda_0} \\left(10^{-A_{\\text{true}}} + \\frac{1}{\\mathcal{R}}\\right)}{P_{0, \\lambda_0} \\left(1 + \\frac{1}{\\mathcal{R}}\\right)} = \\frac{10^{-A_{\\text{true}}} + \\frac{1}{\\mathcal{R}}}{1 + \\frac{1}{\\mathcal{R}}}$$\nThe apparent absorbance, $A_{\\text{meas}}$, is defined as $A_{\\text{meas}} = -\\log_{10}(T_{\\text{meas}})$. Applying this definition gives the final derived expression:\n$$A_{\\text{meas}} = -\\log_{10}\\left(\\frac{10^{-A_{\\text{true}}} + \\frac{1}{\\mathcal{R}}}{1 + \\frac{1}{\\mathcal{R}}}\\right)$$\nThis completes the first part of the problem.\n\nFor the second part, we must calculate the numerical value of $A_{\\text{meas}}$. First, we calculate the true absorbance, $A_{\\text{true}}$, using the Beer-Lambert law, $A_{\\text{true}} = \\varepsilon(\\lambda_{0})bc$. The given values are $\\varepsilon(\\lambda_{0}) = 1.2 \\times 10^{4}\\,\\mathrm{L\\,mol^{-1}\\,cm^{-1}}$, $b = 1.00\\,\\mathrm{cm}$, and $c = 2.5 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$.\n$$A_{\\text{true}} = (1.2 \\times 10^{4}) \\times (1.00) \\times (2.5 \\times 10^{-4})$$\n$$A_{\\text{true}} = (1.2 \\times 2.5) \\times (10^{4} \\times 10^{-4}) = 3.0$$\nThe true absorbance is $A_{\\text{true}} = 3.0$.\n\nNow, we substitute $A_{\\text{true}} = 3.0$ and the given stray light rejection ratio $\\mathcal{R} = 5.0 \\times 10^{4}$ into the derived expression for $A_{\\text{meas}}$:\n$$A_{\\text{meas}} = -\\log_{10}\\left(\\frac{10^{-3.0} + \\frac{1}{5.0 \\times 10^{4}}}{1 + \\frac{1}{5.0 \\times 10^{4}}}\\right)$$\nWe evaluate the numerical terms:\n$$10^{-3.0} = 0.001$$\n$$\\frac{1}{5.0 \\times 10^{4}} = 2.0 \\times 10^{-5} = 0.00002$$\nSubstituting these values:\n$$A_{\\text{meas}} = -\\log_{10}\\left(\\frac{0.001 + 0.00002}{1 + 0.00002}\\right) = -\\log_{10}\\left(\\frac{0.00102}{1.00002}\\right)$$\nPerforming the calculation:\n$$A_{\\text{meas}} = -\\log_{10}(0.0010199796...)$$\n$$A_{\\text{meas}} = 2.9914401...$$\nRounding the result to $4$ significant figures, as requested by the problem statement:\n$$A_{\\text{meas}} \\approx 2.991$$",
            "answer": "$$\\boxed{2.991}$$"
        },
        {
            "introduction": "Spectroscopy truly excels when used to dissect complex chemical systems, such as solutions containing multiple species in equilibrium. This advanced computational practice  moves beyond single-analyte systems to a scenario where a molecule self-associates into a dimer, resulting in an overlapping spectrum of both monomer and dimer. You will apply the principles of the Beer-Lambert law, chemical equilibrium, and linear algebra to deconvolve the composite spectrum and quantify the extent of aggregation, a technique central to modern biophysical chemistry and materials science.",
            "id": "3726854",
            "problem": "A chromophoric organic solute exhibits concentration-dependent self-association in solution, forming a dimeric aggregate that perturbs its electronic absorption bands within the ultraviolet–visible region of the electromagnetic spectrum. You will model the absorption spectrum at multiple wavelengths as a linear superposition of monomer and aggregate contributions and recover the fraction aggregated by spectral deconvolution, underpinned by first-principles relations.\n\nUse the following fundamental base without shortcut formulas:\n- Beer–Lambert Law: for each wavelength $\\lambda$, the absorbance $A(\\lambda)$ is the path-length–weighted sum of contributions from all absorbing species. Specifically, $A(\\lambda)$ is proportional to the path length and the concentration-weighted molar absorptivity at $\\lambda$.\n- Law of Mass Action and species conservation for a dimerization equilibrium $2\\,\\mathrm{M} \\rightleftharpoons \\mathrm{D}$ with equilibrium association constant $K$ (in $\\mathrm{M}^{-1}$). At total analytical concentration $C_{\\mathrm{t}}$, the monomer concentration $[\\mathrm{M}]$ and dimer concentration $[\\mathrm{D}]$ satisfy the mass action and conservation relations simultaneously.\n\nTask:\n1. Construct a linear spectroscopic model across a set of wavelengths $\\{\\lambda_i\\}_{i=1}^n$ by representing the measured absorbance vector as a linear combination of two fixed basis spectra (monomer and aggregate) scaled by their concentrations and the optical path length.\n2. Given fixed basis molar absorptivities for monomer and aggregate at those wavelengths, and a path length, generate synthetic “measured” absorbance vectors by applying the Beer–Lambert Law to the equilibrium composition implied by the Law of Mass Action at specified total concentrations $C_{\\mathrm{t}}$ and association constant $K$.\n3. Without using the equilibrium relation to infer composition, perform a spectral deconvolution at each total concentration by solving a linear least-squares problem over all wavelengths to estimate $[\\mathrm{M}]$ and $[\\mathrm{D}]$ from each absorbance vector.\n4. From the deconvolved concentrations, compute the aggregated fraction $f_{\\mathrm{agg}}$ defined as $f_{\\mathrm{agg}} = \\dfrac{2\\,[\\mathrm{D}]}{C_{\\mathrm{t}}}$ (unitless). Express $f_{\\mathrm{agg}}$ as a decimal fraction rounded to six decimal places (no percent sign).\n\nPhysical parameters and units:\n- Wavelength grid (nanometers): $[\\;300,\\;310,\\;320,\\;330,\\;340,\\;350,\\;360,\\;370,\\;380,\\;390\\;]$.\n- Path length $l$ (in centimeters): $l = 1.000$.\n- Monomer molar absorptivity vector $\\boldsymbol{\\varepsilon}_{\\mathrm{M}}$ (in $\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{cm}^{-1}$), aligned to the wavelength grid: $[\\;1000,\\;2000,\\;5000,\\;12000,\\;22000,\\;30000,\\;26000,\\;18000,\\;9000,\\;3000\\;]$.\n- Dimer (aggregate) molar absorptivity vector $\\boldsymbol{\\varepsilon}_{\\mathrm{D}}$ (in $\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{cm}^{-1}$), aligned likewise: $[\\;200,\\;500,\\;1500,\\;4000,\\;8000,\\;15000,\\;25000,\\;38000,\\;42000,\\;35000\\;]$.\n- Association constant $K$ (in $\\mathrm{M}^{-1}$): $K = 5000$.\n\nTest suite (covering low, intermediate, and high aggregation regimes):\n- Case $1$: $C_{\\mathrm{t}} = 5\\times 10^{-6}\\ \\mathrm{M}$.\n- Case $2$: $C_{\\mathrm{t}} = 5\\times 10^{-5}\\ \\mathrm{M}$.\n- Case $3$: $C_{\\mathrm{t}} = 2\\times 10^{-4}\\ \\mathrm{M}$.\n- Case $4$: $C_{\\mathrm{t}} = 1\\times 10^{-3}\\ \\mathrm{M}$.\n\nGeneration of synthetic absorbance for each case (to be used as the “measured” input for deconvolution):\n- For each given $C_{\\mathrm{t}}$ and $K$, determine the unique nonnegative equilibrium composition $\\left([\\mathrm{M}], [\\mathrm{D}]\\right)$ that satisfies the Law of Mass Action for dimerization and the species conservation relation at $C_{\\mathrm{t}}$.\n- Form the absorbance vector $\\mathbf{A}$ with entries $A(\\lambda_i)$ by applying the Beer–Lambert Law at each $\\lambda_i$ using the given $\\boldsymbol{\\varepsilon}_{\\mathrm{M}}$, $\\boldsymbol{\\varepsilon}_{\\mathrm{D}}$, the computed $\\left([\\mathrm{M}], [\\mathrm{D}]\\right)$, and path length $l$.\n\nDeconvolution requirement:\n- For each case, estimate $\\left([\\mathrm{M}], [\\mathrm{D}]\\right)$ by solving the overdetermined linear system defined by the basis spectra and path length against the corresponding “measured” absorbance vector via least squares over all wavelengths, without invoking the equilibrium relation.\n- Compute $f_{\\mathrm{agg}} = \\dfrac{2\\,[\\mathrm{D}]}{C_{\\mathrm{t}}}$ from the deconvolved concentrations.\n\nFinal output format:\n- Your program should produce a single line of output containing the four $f_{\\mathrm{agg}}$ values corresponding to the four cases in the order listed above, rounded to six decimal places, as a comma-separated list enclosed in square brackets. For example, the format must be exactly like $[\\;x_1,\\;x_2,\\;x_3,\\;x_4\\;]$ where each $x_i$ is a decimal rounded to six places.\n\nAngle units are not applicable. All concentrations must be treated in $\\mathrm{mol}\\,\\mathrm{L}^{-1}$, path length in $\\mathrm{cm}$, molar absorptivity in $\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{cm}^{-1}$, wavelengths in $\\mathrm{nm}$, and absorbance is dimensionless. The required answers $f_{\\mathrm{agg}}$ are unitless decimal fractions.",
            "solution": "The problem requires a multi-step analysis involving chemical equilibrium, spectrophotometry, and linear algebra to determine the fraction of an aggregated species in solution at various concentrations. The overall process is to first calculate the theoretical equilibrium composition, then use it to generate synthetic spectral data, and finally, deconvolve this data to recover the composition and the desired aggregated fraction.\n\n### Part 1: Determination of Equilibrium Composition\n\nThe system involves a dimerization equilibrium of a monomeric species $\\mathrm{M}$ to a dimeric species $\\mathrm{D}$, represented by the reaction:\n$$ 2\\,\\mathrm{M} \\rightleftharpoons \\mathrm{D} $$\n\nThe Law of Mass Action for this equilibrium is given by the association constant $K$:\n$$ K = \\frac{[\\mathrm{D}]}{[\\mathrm{M}]^2} \\quad (1) $$\nwhere $[\\mathrm{M}]$ and $[\\mathrm{D}]$ are the molar concentrations of the monomer and dimer, respectively.\n\nThe conservation of mass for the total solute, at an analytical concentration $C_{\\mathrm{t}}$, is given by:\n$$ C_{\\mathrm{t}} = [\\mathrm{M}] + 2\\,[\\mathrm{D}] \\quad (2) $$\nThe factor of $2$ for $[\\mathrm{D}]$ accounts for the fact that each dimer contains two monomer units.\n\nTo find the equilibrium concentrations for a given $C_{\\mathrm{t}}$ and $K$, we solve the system of equations $(1)$ and $(2)$. We can express $[\\mathrm{D}]$ from equation $(1)$ as $[\\mathrm{D}] = K\\,[\\mathrm{M}]^2$ and substitute it into equation $(2)$:\n$$ C_{\\mathrm{t}} = [\\mathrm{M}] + 2\\,(K\\,[\\mathrm{M}]^2) $$\nRearranging this into the standard form of a quadratic equation for $[\\mathrm{M}]$ ($ax^2+bx+c=0$):\n$$ (2K)\\,[\\mathrm{M}]^2 + (1)\\,[\\mathrm{M}] - C_{\\mathrm{t}} = 0 $$\nThe solution for $[\\mathrm{M}]$ is found using the quadratic formula, $[\\mathrm{M}] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$. Here, $a = 2K$, $b = 1$, and $c = -C_{\\mathrm{t}}$.\n$$ [\\mathrm{M}] = \\frac{-1 \\pm \\sqrt{1^2 - 4(2K)(-C_{\\mathrm{t}})}}{2(2K)} = \\frac{-1 \\pm \\sqrt{1 + 8KC_{\\mathrm{t}}}}{4K} $$\nSince concentration must be a non-negative physical quantity, we select the positive root:\n$$ [\\mathrm{M}] = \\frac{-1 + \\sqrt{1 + 8KC_{\\mathrm{t}}}}{4K} \\quad (3) $$\nOnce $[\\mathrm{M}]$ is determined, $[\\mathrm{D}]$ can be calculated from the mass conservation equation $(2)$:\n$$ [\\mathrm{D}] = \\frac{C_{\\mathrm{t}} - [\\mathrm{M}]}{2} \\quad (4) $$\nThese equations allow for the calculation of the unique, non-negative equilibrium composition $([\\mathrm{M}], [\\mathrm{D}])$ for any given $C_{\\mathrm{t}}$ and $K$.\n\n### Part 2: Generation of Synthetic Absorbance Data\n\nThe Beer–Lambert Law relates the absorbance of a solution to the concentrations of the absorbing species. For a mixture of monomer and dimer at a given wavelength $\\lambda$, the total absorbance $A(\\lambda)$ is the sum of their individual contributions:\n$$ A(\\lambda) = l \\cdot (\\varepsilon_{\\mathrm{M}}(\\lambda)[\\mathrm{M}] + \\varepsilon_{\\mathrm{D}}(\\lambda)[\\mathrm{D}]) $$\nwhere $l$ is the optical path length, and $\\varepsilon_{\\mathrm{M}}(\\lambda)$ and $\\varepsilon_{\\mathrm{D}}(\\lambda)$ are the molar absorptivities of the monomer and dimer at that wavelength.\n\nThis relationship can be represented in vector form for a set of $n$ wavelengths $\\{\\lambda_i\\}_{i=1}^n$. Let $\\mathbf{A}$ be the $n \\times 1$ absorbance vector, and $\\boldsymbol{\\varepsilon}_{\\mathrm{M}}$ and $\\boldsymbol{\\varepsilon}_{\\mathrm{D}}$ be the $n \\times 1$ vectors of molar absorptivities. The synthetic \"measured\" absorbance vector is then generated by:\n$$ \\mathbf{A} = l \\cdot ([\\mathrm{M}] \\boldsymbol{\\varepsilon}_{\\mathrm{M}} + [\\mathrm{D}] \\boldsymbol{\\varepsilon}_{\\mathrm{D}}) \\quad (5) $$\nFor each test case, we use the equilibrium concentrations $([\\mathrm{M}], [\\mathrm{D}])$ calculated in Part 1 to generate the corresponding absorbance vector $\\mathbf{A}$.\n\n### Part 3: Spectral Deconvolution by Linear Least Squares\n\nThe inverse problem is to determine the concentrations from a measured absorbance spectrum. The spectroscopic model from equation $(5)$ can be rewritten as a linear system:\n$$ \\mathbf{A} = \\begin{bmatrix} l \\cdot \\boldsymbol{\\varepsilon}_{\\mathrm{M}} & l \\cdot \\boldsymbol{\\varepsilon}_{\\mathrm{D}} \\end{bmatrix} \\begin{bmatrix} [\\mathrm{M}]_{\\text{est}} \\\\ [\\mathrm{D}]_{\\text{est}} \\end{bmatrix} $$\nThis is a system of linear equations of the form $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$, where:\n- $\\mathbf{y}$ is the $n \\times 1$ measured absorbance vector $\\mathbf{A}$.\n- $\\mathbf{X}$ is the $n \\times 2$ design matrix, whose columns are the path-length-scaled basis spectra. Let's call it $\\mathbf{E}$: $\\mathbf{E} = l \\cdot \\begin{bmatrix} \\boldsymbol{\\varepsilon}_{\\mathrm{M}} & \\boldsymbol{\\varepsilon}_{\\mathrm{D}} \\end{bmatrix}$.\n- $\\boldsymbol{\\beta}$ is the $2 \\times 1$ vector of unknown concentrations to be estimated, $\\mathbf{C}_{\\text{est}} = \\begin{bmatrix} [\\mathrm{M}]_{\\text{est}} \\\\ [\\mathrm{D}]_{\\text{est}} \\end{bmatrix}$.\n\nSince there are more wavelengths ($n=10$) than unknown concentrations ($2$), the system is overdetermined. The problem specifies solving for $\\mathbf{C}_{\\text{est}}$ by minimizing the sum of the squared residuals, i.e., by linear least squares. This seeks the vector $\\mathbf{C}_{\\text{est}}$ that minimizes $\\| \\mathbf{A} - \\mathbf{E}\\mathbf{C}_{\\text{est}} \\|^2$. The solution to this problem is given by the normal equations:\n$$ (\\mathbf{E}^\\top\\mathbf{E})\\mathbf{C}_{\\text{est}} = \\mathbf{E}^\\top\\mathbf{A} $$\nSolving for $\\mathbf{C}_{\\text{est}}$ yields:\n$$ \\mathbf{C}_{\\text{est}} = (\\mathbf{E}^\\top\\mathbf{E})^{-1}\\mathbf{E}^\\top\\mathbf{A} $$\nThis procedure is performed for each generated absorbance vector to find the estimated concentrations $([\\mathrm{M}]_{\\text{est}}, [\\mathrm{D}]_{\\text{est}})$. Since the synthetic data are generated from the same model and are noise-free, the deconvolution should yield estimated concentrations that are equal to the original equilibrium concentrations to within machine precision.\n\n### Part 4: Calculation of the Aggregated Fraction\n\nThe final step is to compute the aggregated fraction, $f_{\\mathrm{agg}}$, which is defined as the fraction of total monomer units that exist within the dimeric aggregate. Since each mole of dimer contains two moles of monomer units, the concentration of monomer units in the aggregate form is $2\\,[\\mathrm{D}]$. The total concentration of all monomer units in the system is $C_{\\mathrm{t}}$. Therefore, $f_{\\mathrm{agg}}$ is defined as:\n$$ f_{\\mathrm{agg}} = \\frac{2 \\cdot [\\mathrm{D}]_{\\text{est}}}{C_{\\mathrm{t}}} $$\nThis calculation is performed for each of the four test cases using the deconvolved dimer concentration $[\\mathrm{D}]_{\\text{est}}$, and the result is rounded to six decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chromophore aggregation problem by calculating equilibrium compositions,\n    generating synthetic spectra, performing least-squares deconvolution, and\n    computing the aggregated fraction for several total concentrations.\n    \"\"\"\n\n    # --- Physical Parameters and Constants ---\n    # Path length in cm\n    l = 1.000\n    # Association constant in M^-1\n    K = 5000.0\n\n    # Monomer molar absorptivity vector (L mol^-1 cm^-1)\n    eps_M = np.array([\n        1000, 2000, 5000, 12000, 22000, 30000, 26000, 18000, 9000, 3000\n    ], dtype=float)\n\n    # Dimer molar absorptivity vector (L mol^-1 cm^-1)\n    eps_D = np.array([\n        200, 500, 1500, 4000, 8000, 15000, 25000, 38000, 42000, 35000\n    ], dtype=float)\n\n    # Test cases: total analytical concentration Ct in M (mol/L)\n    test_cases_Ct = [\n        5e-6,\n        5e-5,\n        2e-4,\n        1e-3,\n    ]\n\n    # --- Deconvolution Setup ---\n    # The spectroscopic model is A = l * (eps_M*[M] + eps_D*[D]).\n    # This can be written in matrix form A = E * C, where C = [[M], [D]].\n    # The matrix E has columns corresponding to the path-length-scaled basis spectra.\n    # E is an n x 2 matrix, where n is the number of wavelengths.\n    E_matrix = l * np.vstack((eps_M, eps_D)).T\n\n    results_f_agg = []\n\n    for Ct in test_cases_Ct:\n        # --- Step 1: Calculate Equilibrium Concentrations (\"True\" values) ---\n        # The equilibrium composition is determined by solving the quadratic equation:\n        # 2*K*[M]^2 + [M] - Ct = 0\n        # The positive root for [M] is: [M] = (-1 + sqrt(1 + 8*K*Ct)) / (4*K)\n        discriminant = 1.0 + 8.0 * K * Ct\n        true_M = (-1.0 + np.sqrt(discriminant)) / (4.0 * K)\n        \n        # Calculate [D] from the mass balance equation: Ct = [M] + 2*[D]\n        true_D = (Ct - true_M) / 2.0\n\n        # --- Step 2: Generate Synthetic Absorbance Vector ---\n        # The absorbance vector A is generated using the Beer-Lambert law\n        # and the true equilibrium concentrations.\n        A_synthetic = l * (true_M * eps_M + true_D * eps_D)\n\n        # --- Step 3: Perform Spectral Deconvolution ---\n        # Solve the overdetermined linear system A = E * C for the concentration\n        # vector C = [[M_est], [D_est]] using linear least squares.\n        # np.linalg.lstsq returns a tuple; the solution vector is the first element.\n        C_estimated = np.linalg.lstsq(E_matrix, A_synthetic, rcond=None)[0]\n        est_M = C_estimated[0]\n        est_D = C_estimated[1]\n        \n        # --- Step 4: Compute Aggregated Fraction ---\n        # The aggregated fraction is defined as f_agg = 2 * [D] / Ct.\n        # We use the deconvolved (estimated) dimer concentration.\n        f_agg = (2.0 * est_D) / Ct\n        \n        results_f_agg.append(f_agg)\n\n    # Format the final output as specified.\n    # Each value rounded to six decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in results_f_agg]\n    print(f\"[{', '.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}