{
    "hands_on_practices": [
        {
            "introduction": "本练习在位移谐振子模型的理论参数与一个可测量的物理量之间建立了基本联系。通过从无量纲位移（$\\Delta q$）出发，推导并计算特定模式的重组能（$\\lambda$），您将具体理解激发时的几何结构变化如何转化为与光物理相关的能量尺度。这项实践对于量化主导弛豫过程的能量图景至关重要。",
            "id": "3726961",
            "problem": "考虑一个有机分子中的单个振动简正模，该简正模根据弗兰克-康登原理对电子吸收中的振动电子结构有贡献。沿此简正模，用具有相同角频率 $\\omega$ 但极小值点有位移的谐振子势来模拟电子基态和激发态。设坐标用无量纲简正坐标 $q$ 表示，它由质量加权简正坐标 $Q$ 通过变换 $q = \\sqrt{\\omega/\\hbar}\\,Q$ 定义，其中 $\\hbar$ 是约化普朗克常数，$\\omega$ 是角频率。假设基态极小值点在 $q=0$ 处，激发态极小值点在 $q=\\Delta q$ 处，且 $\\Delta q$ 为给定值。\n\n从两个电子态中量子谐振子势的基本形式以及电子跃迁的垂直特性出发，从第一性原理推导特定模式的重组能 $\\lambda$（即当激发态从基态几何构型 $q=0$ 弛豫到其极小值点 $q=\\Delta q$ 时释放的能量）。然后，对于一个光谱波数为 $\\tilde{\\nu} = 1500\\,\\mathrm{cm}^{-1}$、无量纲位移为 $\\Delta q = 1.4$ 的模式，计算 $\\lambda$ 的值，并分别表示为：\n- 以 $\\mathrm{cm}^{-1}$ 为单位的波数，以及\n- 以 $\\mathrm{eV}$ 为单位的能量。\n\n使用能量与波数之间的正则关系 $E = h c\\,\\tilde{\\nu}$（其中 $h$ 是普朗克常数，$c$ 是光速）以及转换关系 $1\\,\\mathrm{eV} = 8065.544\\,\\mathrm{cm}^{-1}$。将两个结果四舍五入到四位有效数字。按先以 $\\mathrm{cm}^{-1}$ 为单位、后以 $\\mathrm{eV}$ 为单位的顺序报告最终数值结果。",
            "solution": "首先评估问题的有效性。所有提供的信息在科学上都是合理的且自洽的。该问题使用标准谐振子模型在弗兰克-康登原理（分子光谱学的基石）的背景下描述振动模式。无量纲简正坐标 $q$ 的定义、重组能 $\\lambda$ 以及物理常数和关系式都是标准且正确的。该问题是适定的，为求得唯一解提供了足够的信息，并以客观、正式的语言表述。因此，它被认为是一个有效的科学问题。\n\n解题过程分为两部分：首先，从第一性原理推导重组能 $\\lambda$；其次，进行数值计算。\n\n**第一部分：重组能 $\\lambda$ 的推导**\n\n一个质量加权简正坐标为 $Q$、角频率为 $\\omega$ 的量子谐振子的势能 $V$ 由 $V(Q) = \\frac{1}{2}\\omega^2 Q^2$ 给出。问题定义了一个无量纲简正坐标 $q = \\sqrt{\\frac{\\omega}{\\hbar}}Q$。我们可以用这个无量纲坐标来表示势能。根据 $q$ 的定义，我们有 $Q = \\sqrt{\\frac{\\hbar}{\\omega}}q$。将此代入势能表达式中，得到：\n$$V(q) = \\frac{1}{2}\\omega^2 \\left( \\sqrt{\\frac{\\hbar}{\\omega}}q \\right)^2 = \\frac{1}{2}\\omega^2 \\left( \\frac{\\hbar}{\\omega} \\right) q^2 = \\frac{1}{2}\\hbar\\omega q^2$$\n这个表达式给出了势能作为无量纲坐标 $q$ 的函数。项 $\\hbar\\omega$ 是该模式单个振动量子的能量。\n\n问题指明了两个电子态，基态 ($g$) 和激发态 ($e$)，它们由具有相同频率 $\\omega$ 但极小值点有位移的谐振子势建模。\n基态势 $V_g$ 的极小值点在 $q=0$ 处。其函数形式为：\n$$V_g(q) = \\frac{1}{2}\\hbar\\omega q^2$$\n激发态势 $V_e$ 的极小值点在 $q=\\Delta q$ 处。其函数形式为：\n$$V_e(q) = \\frac{1}{2}\\hbar\\omega (q - \\Delta q)^2$$\n注意，任何代表电子能隙的恒定能量偏移都与重组能的计算无关，因为 $\\lambda$ 被定义为激发态势能面上的能量差。\n\n重组能 $\\lambda$ 定义为系统在基态平衡几何构型 ($q=0$) 处经历垂直电子跃迁到达激发态后，弛豫到激发态的平衡几何构型 ($q=\\Delta q$) 时所释放的能量。在数学上，这是激发态势能在两点之间的差值：\n$$\\lambda = V_e(q=0) - V_e(q=\\Delta q)$$\n\n我们计算这两项：\n在弛豫初始点（激发态势能面上 $q=0$ 处）的势能为：\n$$V_e(q=0) = \\frac{1}{2}\\hbar\\omega (0 - \\Delta q)^2 = \\frac{1}{2}\\hbar\\omega (\\Delta q)^2$$\n在最终的弛豫点（激发态势能面上 $q=\\Delta q$ 处）的势能为：\n$$V_e(q=\\Delta q) = \\frac{1}{2}\\hbar\\omega (\\Delta q - \\Delta q)^2 = \\frac{1}{2}\\hbar\\omega (0)^2 = 0$$\n\n将这些代入 $\\lambda$ 的表达式，得到推导出的公式：\n$$\\lambda = \\frac{1}{2}\\hbar\\omega (\\Delta q)^2 - 0 = \\frac{1}{2}\\hbar\\omega (\\Delta q)^2$$\n\n**第二部分：$\\lambda$ 的数值计算**\n\n问题给出了必要的数值：\n- 振动模式的光谱波数：$\\tilde{\\nu} = 1500\\,\\mathrm{cm}^{-1}$。\n- 无量纲位移：$\\Delta q = 1.4$。\n\n振动量子的能量 $\\hbar\\omega$ 与其光谱波数 $\\tilde{\\nu}$ 通过关系式 $E = hc\\tilde{\\nu}$ 直接相关。因此，在我们推导的 $\\lambda$ 表达式中，项 $\\hbar\\omega$ 对应于波数 $\\tilde{\\nu}$ 的能量当量。\n\n为了以波数（记作 $\\tilde{\\lambda}$）计算重组能，我们可以调整我们推导的公式。由于 $\\lambda = E$，我们有 $\\lambda = hc\\tilde{\\lambda}$。因此：\n$$hc\\tilde{\\lambda} = \\frac{1}{2}(hc\\tilde{\\nu})(\\Delta q)^2$$\n两边同除以 $hc$，我们得到以波数为单位的重组能：\n$$\\tilde{\\lambda} = \\frac{1}{2}\\tilde{\\nu}(\\Delta q)^2$$\n\n代入给定的数值：\n$$\\tilde{\\lambda} = \\frac{1}{2}(1500\\,\\mathrm{cm}^{-1})(1.4)^2 = (750\\,\\mathrm{cm}^{-1})(1.96) = 1470\\,\\mathrm{cm}^{-1}$$\n问题要求将结果四舍五入到四位有效数字。精确结果是 $1470$。为了明确表示四位有效数字，我们将其写为 $1.470 \\times 10^3\\,\\mathrm{cm}^{-1}$。\n\n接下来，我们以电子伏特（$\\mathrm{eV}$）为单位计算重组能。我们可以使用提供的转换因子：$1\\,\\mathrm{eV} = 8065.544\\,\\mathrm{cm}^{-1}$。\n$$\\lambda_{\\mathrm{eV}} = \\frac{\\tilde{\\lambda}}{\\text{conversion factor}} = \\frac{1470\\,\\mathrm{cm}^{-1}}{8065.544\\,\\mathrm{cm}^{-1}/\\mathrm{eV}}$$\n$$\\lambda_{\\mathrm{eV}} \\approx 0.1822605\\,\\mathrm{eV}$$\n将此结果四舍五入到四位有效数字，得到：\n$$\\lambda_{\\mathrm{eV}} \\approx 0.1823\\,\\mathrm{eV}$$\n\n最终的数值结果，按要求的顺序（先以 $\\mathrm{cm}^{-1}$ 为单位，后以 $\\mathrm{eV}$ 为单位）并四舍五入到四位有效数字，为 $1.470 \\times 10^3\\,\\mathrm{cm}^{-1}$ 和 $0.1823\\,\\mathrm{eV}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.470 \\times 10^3  0.1823 \\end{pmatrix}}$$"
        },
        {
            "introduction": "真实世界的光谱受到温度的显著影响，温度决定了振动能态的初始布居。本练习通过引入玻尔兹曼分布来分析“热谱带”（源于热布居的振动激发态的跃迁），从而超越了 0 K 的假设。计算热谱带与主 0–0 跃迁的强度比，将加深您对温度如何塑造所观测到的光谱特征的理解。",
            "id": "3726966",
            "problem": "一个有机羰基生色团表现出强的允许的单重态-单重态电子吸收，其中电子基态中波数为 $\\omega=1800\\,\\mathrm{cm}^{-1}$ 的全对称振动简正模式在振动电子跃迁级数中是活性的。假设在该模式的两个电子态中均采用曲率相同（频率相等）的谐振子近似，忽略Duschinsky转动（无模式混合），并采用Condon近似（电子跃迁偶极矩与核坐标无关）。势能面沿此简正坐标发生位移，使得黄昆-里斯因子为 $S=0.3$。样品在温度 $T=298\\,\\mathrm{K}$ 下处于热平衡状态。\n\n从振动布居数的正则系综和用于Franck–Condon因子（重叠积分的平方）的位移谐振子模型出发，推导积分吸收强度之比的表达式\n$$\nR \\equiv \\frac{I_{1\\to 0}}{I_{0\\to 0}},\n$$\n其中 $I_{0\\to 0}$ 表示 $0\\to 0$ 振动电子谱带，而 $I_{1\\to 0}$ 表示源于该模式下第一振动激发能级 $1\\to 0$ 的热带。使用给定参数对 $R$ 进行数值计算。根据需要使用基本常数 $h c / k_{B} = 1.438776877\\,\\mathrm{cm\\cdot K}$、普朗克常数乘以光速 $h c$ 以及玻尔兹曼常数 $k_{B}$。将最终数值答案四舍五入至三位有效数字。将最终比值表示为纯数（无单位）。",
            "solution": "该问题要求计算一个有机羰基生色团特定简正模式下，$1 \\to 0$ 热带的积分吸收强度与 $0 \\to 0$ 基本振动电子跃迁的积分吸收强度之比。令电子基态表示为 $g$，电子激发态表示为 $e$。基态和激发态中的振动量子数分别表示为 $v''$ 和 $v'$。跃迁 $I_{0\\to 0}$ 对应于过程 $(g, v''=0) \\to (e, v'=0)$，而热带 $I_{1\\to 0}$ 对应于过程 $(g, v''=1) \\to (e, v'=0)$。\n\n在Condon近似下，振动电子跃迁 $I_{v'' \\to v'}$ 的积分强度与初始振动态的布居数 $N_{v''}$ 和Franck-Condon因子（FCF）的乘积成正比，FCF是振动波函数重叠积分的平方，即 $|\\langle v' | v'' \\rangle|^2$。\n$$\nI_{v'' \\to v'} \\propto N_{v''} |\\langle \\psi_{v'} | \\psi_{v''} \\rangle|^2\n$$\n电子跃迁偶极矩被假定为常数，因此在强度比值中被消去。\n\n因此，所求的比值 $R$ 由下式给出：\n$$\nR = \\frac{I_{1\\to 0}}{I_{0\\to 0}} = \\frac{N_{1} |\\langle \\psi_{v'=0} | \\psi_{v''=1} \\rangle|^2}{N_{0} |\\langle \\psi_{v'=0} | \\psi_{v''=0} \\rangle|^2} = \\left(\\frac{N_1}{N_0}\\right) \\left(\\frac{|\\langle 0 | 1 \\rangle|^2}{|\\langle 0 | 0 \\rangle|^2}\\right)\n$$\n在这里，我们简化了重叠积分的表示法。推导分两部分进行：首先，确定布居数比；其次，确定Franck-Condon因子之比。\n\n首先，我们确定布居数比 $\\frac{N_1}{N_0}$。系统在温度 $T$ 下处于热平衡，因此电子基态中振动能级的布居数遵循玻尔兹曼分布。能量为 $E_{v''}$ 的态的布居数 $N_{v''}$ 与 $\\exp(-E_{v''}/(k_B T))$ 成正比，其中 $k_B$ 是玻尔兹曼常数。\n使用谐振子模型，第 $v''$ 个振动能级的能量为 $E_{v''} = (v'' + 1/2)h c \\omega$，其中 $h$ 是普朗克常数，$c$ 是光速，$\\omega$ 是振动波数。\n基态（$v''=0$）和第一激发态（$v''=1$）振动能级的能量为：\n$$\nE_0 = \\left(0 + \\frac{1}{2}\\right) h c \\omega = \\frac{1}{2} h c \\omega\n$$\n$$\nE_1 = \\left(1 + \\frac{1}{2}\\right) h c \\omega = \\frac{3}{2} h c \\omega\n$$\n布居数比则为：\n$$\n\\frac{N_1}{N_0} = \\frac{\\exp(-E_1 / (k_B T))}{\\exp(-E_0 / (k_B T))} = \\exp\\left(-\\frac{E_1 - E_0}{k_B T}\\right) = \\exp\\left(-\\frac{hc\\omega}{k_B T}\\right)\n$$\n\n其次，我们确定Franck-Condon因子之比。题目指定了一个具有相同频率的位移谐振子模型，其FCF可以用黄昆-里斯因子 $S$ 来表示。在此模型中，Franck-Condon因子 $|\\langle v' | v'' \\rangle|^2$ 的通用公式为：\n$$\n|\\langle v' | v'' \\rangle|^2 = \\exp(-S) \\frac{(v_)!}{(v_>)!} S^{|v'-v''|} \\left[ L_{v_}^{|v'-v''|}(S) \\right]^2\n$$\n其中 $v_ = \\min(v', v'')$，$v_> = \\max(v', v'')$，$L_{n}^{\\alpha}(x)$ 是广义拉盖尔多项式。\n\n对于 $0 \\to 0$ 跃迁，$v''=0$ 且 $v'=0$。因此，$v_=0$，$v_>=0$，$|v'-v''|=0$。FCF为：\n$$\n|\\langle 0 | 0 \\rangle|^2 = \\exp(-S) \\frac{0!}{0!} S^0 \\left[ L_{0}^{0}(S) \\right]^2\n$$\n因为对于任意的 $\\alpha$ 和 $x$，$L_{0}^{\\alpha}(x) = 1$，我们得到：\n$$\n|\\langle 0 | 0 \\rangle|^2 = \\exp(-S)\n$$\n\n对于 $1 \\to 0$ 跃迁，$v''=1$ 且 $v'=0$。因此，$v_=0$，$v_>=1$，$|v'-v''|=1$。FCF为：\n$$\n|\\langle 0 | 1 \\rangle|^2 = \\exp(-S) \\frac{0!}{1!} S^{|0-1|} \\left[ L_{0}^{|0-1|}(S) \\right]^2 = \\exp(-S) \\frac{1}{1} S^1 \\left[ L_{0}^{1}(S) \\right]^2\n$$\n同样，由于 $L_{0}^{1}(S) = 1$，我们得到：\n$$\n|\\langle 0 | 1 \\rangle|^2 = S \\exp(-S)\n$$\nFranck-Condon因子之比为：\n$$\n\\frac{|\\langle 0 | 1 \\rangle|^2}{|\\langle 0 | 0 \\rangle|^2} = \\frac{S \\exp(-S)}{\\exp(-S)} = S\n$$\n\n结合布居数比和FCF比，我们得到 $R$ 的最终解析表达式：\n$$\nR = \\left(\\frac{N_1}{N_0}\\right) \\left(\\frac{|\\langle 0 | 1 \\rangle|^2}{|\\langle 0 | 0 \\rangle|^2}\\right) = \\exp\\left(-\\frac{hc\\omega}{k_B T}\\right) S\n$$\n\n现在，我们使用给定的参数对此表达式进行数值计算：\n$S = 0.3$\n$\\omega = 1800\\,\\mathrm{cm}^{-1}$\n$T = 298\\,\\mathrm{K}$\n$hc/k_B = 1.438776877\\,\\mathrm{cm\\cdot K}$\n\n首先，我们计算无量纲指数：\n$$\n\\frac{hc\\omega}{k_B T} = \\left(\\frac{hc}{k_B}\\right) \\frac{\\omega}{T} = (1.438776877\\,\\mathrm{cm\\cdot K}) \\frac{1800\\,\\mathrm{cm}^{-1}}{298\\,\\mathrm{K}} \\approx 8.69060\n$$\n现在，我们计算比值 $R$：\n$$\nR = S \\exp\\left(-\\frac{hc\\omega}{k_B T}\\right) = 0.3 \\times \\exp(-8.69060)\n$$\n$$\nR \\approx 0.3 \\times 1.68164 \\times 10^{-4} \\approx 5.04492 \\times 10^{-5}\n$$\n按要求将结果四舍五入到三位有效数字：\n$$\nR \\approx 5.04 \\times 10^{-5}\n$$\n该结果表明热带相比于始带非常弱，这对于室温下的高频振动是符合预期的，因为 $v''=1$ 态的布居数非常低。",
            "answer": "$$\\boxed{5.04 \\times 10^{-5}}$$"
        },
        {
            "introduction": "对光谱模型的最终检验在于其再现和预测实验光谱的能力。这项综合性练习要求您将弗兰克-康登原理的核心信条合成为一个计算模拟程序。通过编写一个能够解释多种构象异构体、通过黄昆-里斯因子描述的振动跃迁谱线以及光谱展宽的模型，您将构建一个强大的工具来诠释复杂的荧光发射光谱包络。",
            "id": "3726938",
            "problem": "您需要编写一个完整、可运行的程序，该程序基于第一性原理，在弗兰克-康登原理和移位谐振子近似的框架下，模拟一种具有两种发射构象异构体的有机染料的荧光振动发射包络。该程序必须计算每个测试用例在指定波长处的发射强度，汇总所有测试用例的结果，并按照下面指定的精确格式打印出来。\n\n使用的背景和基本原理：\n- 玻恩-奥本海默近似：电子和原子核的运动是可分离的，电子跃迁发生的时间尺度远小于原子核的运动。\n- 弗兰克-康登原理：在电子跃迁过程中，当原子核几何构型固定时，跃迁强度与振动波函数重叠积分的平方成正比。\n- 移位谐振子模型：基态和激发态的势能面是具有相同曲率的谐振子势能面，但沿单个有效简正模坐标发生了位移。无量纲的黄昆-里斯因子 $S$ 量化了该位移，并控制了沿该模式的振动跃迁强度的分布。\n- 谱线展宽：仪器响应和非均匀展宽可以通过高斯线型函数进行建模，其半峰全宽（FWHM）是指定的，并与标准差 $\\sigma$ 相关。\n- 能量-波长转换：$E \\, (\\mathrm{eV}) = \\dfrac{1239.84197386209 \\, \\mathrm{eV \\cdot nm}}{\\lambda \\, (\\mathrm{nm})}$。\n\n目标体系：\n- 一种有机染料从两种发射构象异构体发出荧光，其黄昆-里斯因子分别为 $S_1 = 0.6$ 和 $S_2 = 1.2$，构象异构体布居数比例为 $70{:}30$。\n- 假设一个主导的有效振动模式决定了发射中的振动结构；除非测试用例中另有规定，否则每个构象异构体都沿同一模式发射。\n- 振动谱线的发射能量形成一个级数，从电子 $0\\text{–}0$ 线开始，按振动能量量子的整数倍发生降移；每条谱线都应用高斯展宽。\n- 强度是无量纲的，应报告为在指定波长采样点处评估的相对值。\n\n您的程序必须：\n1. 对每个构象异构体，构建发射谱线中心的振动级数 $E_v$，该级数从零声子线能量 $E_{00}$ 开始，按振动量子 $\\hbar \\omega$ 的整数倍降移。使用一个有原则的截断标准来确定包含的量子数，该截断应基于移位谐振子模型和 $S$ 的大小而合理。\n2. 根据弗兰克-康登原理和黄昆-里斯因子 $S$，为每条振动谱线分配一个物理上合理的相对强度权重，然后按构象异构体布居数分数进行缩放。\n3. 使用测试用例中指定的 FWHM，通过高斯线型对每条谱线进行展宽，并在指定的波长采样点处评估总强度。使用 FWHM 和高斯标准差 $\\sigma$ 之间的关系。\n4. 使用公式 $E \\, (\\mathrm{eV}) = \\dfrac{1239.84197386209}{\\lambda \\, (\\mathrm{nm})}$ 将指定的波长（单位为 $\\mathrm{nm}$）转换为能量（单位为 $\\mathrm{eV}$），并在这些能量点上评估发射包络。\n5. 将报告的每个强度值四舍五入到六位小数。\n\n物理和数值单位及约定：\n- 波长以 $\\mathrm{nm}$ 为单位指定和处理。\n- 能量在内部必须以 $\\mathrm{eV}$ 为单位处理。\n- 高斯展宽的 FWHM 以 $\\mathrm{eV}$ 为单位给出。\n- 强度是无量纲的相对值；报告为四舍五入到六位小数的浮点数。\n\n测试套件：\n- 在所有测试用例中，使用固定的黄昆-里斯因子 $S_1 = 0.6$ 和 $S_2 = 1.2$ 以及布居数分数 $p_1 = 0.7$ 和 $p_2 = 0.3$。每个测试用例的参数如下：\n  1. 正常情况用例：$E_{00}^{(1)} = 2.30 \\, \\mathrm{eV}$，$E_{00}^{(2)} = 2.28 \\, \\mathrm{eV}$，$\\hbar \\omega = 0.18 \\, \\mathrm{eV}$，$\\mathrm{FWHM} = 0.05 \\, \\mathrm{eV}$，波长 $\\lambda = [520, 540, 560, 580, 600] \\, \\mathrm{nm}$。\n  2. 窄线边界用例：$E_{00}^{(1)} = 2.30 \\, \\mathrm{eV}$，$E_{00}^{(2)} = 2.28 \\, \\mathrm{eV}$，$\\hbar \\omega = 0.18 \\, \\mathrm{eV}$，$\\mathrm{FWHM} = 0.005 \\, \\mathrm{eV}$，波长 $\\lambda = [520, 540, 560, 580, 600] \\, \\mathrm{nm}$。\n  3. 密集级数边缘用例：$E_{00}^{(1)} = 2.31 \\, \\mathrm{eV}$，$E_{00}^{(2)} = 2.29 \\, \\mathrm{eV}$，$\\hbar \\omega = 0.09 \\, \\mathrm{eV}$，$\\mathrm{FWHM} = 0.02 \\, \\mathrm{eV}$，波长 $\\lambda = [520, 540, 560, 580, 600] \\, \\mathrm{nm}$。\n\n算法和数值要求：\n- 基于黄昆-里斯因子所蕴含的谱线权重衰减，为振动量子指数 $v$ 实现一个鲁棒的截断准则，确保忽略的强度可以忽略不计（例如，通过绝对项阈值或累积覆盖率）。\n- 使用一个高斯线型 $G(E; E_v, \\sigma)$，其归一化方式应使每条谱线下的积分面积等于其分配的权重，并合并来自两个构象异构体的贡献。通过一个数学上正确的表达式将 $\\sigma$ 与 FWHM 关联起来。\n- 对于每个测试用例，生成在指定波长处的强度列表，四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内无空格。每个元素对应一个测试用例，并且其本身必须是一个浮点数列表（在指定波长处的强度）。例如，对于本问题，最终行应类似于：[[x1,x2,x3],[y1,y2,y3],[z1,z2,z3]]，但每个内部列表包含五个浮点数。",
            "solution": "问题陈述已经过严格验证，被认为是科学上合理、定义明确、自成一体且算法上可行的。它基于分子光谱学的既定原则，提供了一个清晰且可形式化的任务。所有必要的参数和常数都已提供，要求明确无误。该问题是有效的。\n\n解决方案要求模拟一个包含两种构象异构体体系的荧光发射光谱。这通过在移位谐振子模型中应用弗兰克-康登原理来实现。总光谱是每种构象异构体光谱的布居数加权和，其中每条谱线都通过高斯函数进行展宽，以考虑实验和环境效应。\n\n理论框架如下：\n\n1.  **弗兰克-康登原理与移位谐振子模型**：根据玻恩-奥本海默近似，电子跃迁在原子核运动的时间尺度上是瞬时的。振动跃迁的强度与初始和最终振动波函数之间的重叠积分的平方成正比，这被称为弗兰克-康登因子（FCF）。对于从激发电子态的基振动态（$v'=0$）到基电子态的振动态 $v$ 的发射跃迁，FCF 由 $FCF_v = |\\langle \\psi'_{v'=0} | \\psi''_{v''=v} \\rangle|^2$ 给出。在移位谐振子模型中，基态和激发态的势能面是频率相同但原点位移的谐振抛物线，此时 FCF 由一个依赖于黄-里斯因子 $S$ 的泊松分布给出：\n    $$\n    FCF_v = \\frac{S^v e^{-S}}{v!}\n    $$\n    这里，$S$ 是一个无量纲参数，它量化了势能最小值之间的几何位移，从而量化了电子-声子耦合的强度。所有 FCF 的总和归一化为 1：$\\sum_{v=0}^{\\infty} FCF_v = 1$。\n\n2.  **振动谱线位置**：在 $v'=0 \\to v''=v$ 跃迁中发射的光子能量由零声子线（$0-0$ 跃迁）的电子能隙 $E_{00}$ 和振动能量子 $\\hbar\\omega$ 决定：\n    $$\n    E_v = E_{00} - v \\hbar \\omega\n    $$\n    其中 $v = 0, 1, 2, \\dots$ 是基电子态中的振动量子数。\n\n3.  **谱线展宽**：每个离散的振动跃迁都被展宽成连续的线型。问题指定了一个高斯函数 $G(E; E_v, \\sigma)$，以跃迁能量 $E_v$ 为中心，标准差为 $\\sigma$。高斯函数的半峰全宽（FWHM）与 $\\sigma$ 的关系如下：\n    $$\n    \\mathrm{FWHM} = 2\\sqrt{2\\ln{2}} \\cdot \\sigma\n    $$\n    问题要求每个高斯谱线的积分面积等于其相对强度。因此，我们使用归一化的高斯概率密度函数，并按适当的强度权重进行缩放：\n    $$\n    G(E; E_v, \\sigma) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(E-E_v)^2}{2\\sigma^2}\\right)\n    $$\n\n4.  **总光谱构建**：总发射光谱 $I_{\\text{total}}(E)$ 是来自两种构象异构体（索引为 $i=1, 2$）贡献的非相干总和，并按其各自的布居数分数 $p_i$ 加权。每个构象异构体的光谱是其所有振动跃迁的总和。\n    $$\n    I_{\\text{total}}(E) = \\sum_{i=1}^{2} p_i \\left( \\sum_{v=0}^{\\infty} FCF_v^{(i)} \\cdot G\\left(E; E_v^{(i)}, \\sigma\\right) \\right)\n    $$\n    其中 $FCF_v^{(i)}$ 和 $E_v^{(i)}$ 是使用特定于构象异构体的参数 $S_i$ 和 $E_{00}^{(i)}$ 计算的。\n\n5.  **能量-波长转换**：采样点以波长 $\\lambda$（单位 $\\mathrm{nm}$）给出，计算时必须将其转换为能量 $E$（单位 $\\mathrm{eV}$）：\n    $$\n    E \\, (\\mathrm{eV}) = \\frac{hc}{e\\lambda} = \\frac{1239.84197386209 \\, \\mathrm{eV \\cdot nm}}{\\lambda \\, (\\mathrm{nm})}\n    $$\n\n算法流程如下：\n\n1.  **初始化**：定义用于能量-波长转换的固定物理常数 $hc/e = 1239.84197386209 \\, \\mathrm{eV \\cdot nm}$，以及固定的体系参数：$S_1 = 0.6$，$S_2 = 1.2$，$p_1 = 0.7$ 和 $p_2 = 0.3$。\n\n2.  **振动级数截断**：对 $v$ 的无穷求和在一个足够大的值 $v_{max}$ 处截断。当 $v > S$ 时，$FCF_v$ 项会迅速衰减。对于本问题中最大的黄-里斯因子 $S=1.2$，当 $v > 5$ 时强度级数已显著减小。保守地选择 $v_{max}=15$ 可以确保累积的忽略强度可忽略不计（小于 $10^{-9}$）。\n\n3.  **遍历测试用例**：对于提供的每个测试用例：\n    a. 解包参数：$E_{00}^{(1)}$，$E_{00}^{(2)}$，$\\hbar \\omega$，$\\mathrm{FWHM}$，以及采样波长列表 $\\lambda_{\\text{sample}}$。\n    b. 将 $\\lambda_{\\text{sample}}$ 转换为采样能量数组 $E_{\\text{sample}}$。\n    c. 根据给定的 $\\mathrm{FWHM}$ 计算高斯标准差 $\\sigma$。\n    d. 初始化一个用于存储采样能量点总强度的数组 $I_{\\text{total}}$，并将其元素全部置为零。\n    e. 对每个构象异构体（$i=1,2$）：\n        i. 创建一个从 $0$ 到 $v_{max}$ 的振动量子数 $v$ 数组。\n        ii. 计算振动谱线位置数组 $E_v^{(i)} = E_{00}^{(i)} - v \\hbar \\omega$。\n        iii. 计算弗兰克-康登因子数组 $FCF_v^{(i)} = \\frac{(S_i)^v e^{-S_i}}{v!}$。\n        iv. 为提高效率，使用 NumPy 的广播功能计算每个振动谱线在每个采样能量点的高斯贡献，并乘以相应的缩放强度权重 $p_i \\cdot FCF_v^{(i)}$。\n        v. 对当前构象异构体，将所有振动谱线的贡献求和，并加到 $I_{\\text{total}}$ 数组中。\n    f. 处理完两种构象异构体后，将 $I_{\\text{total}}$ 中的值四舍五入到六位小数。\n\n4.  **输出格式化**：收集每个测试用例的四舍五入后的强度列表。最终输出是一个表示这些列表的列表的单行字符串，无空格，符合指定的格式 `[[...],[...],[...]]`。\n\n这种有原则的方法确保了按照规定对振动发射光谱进行物理上准确且计算上高效的模拟。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import factorial\n\ndef solve():\n    \"\"\"\n    Simulates the fluorescence vibronic emission envelope of an organic dye\n    with two emitting conformers based on the Franck-Condon principle.\n    \"\"\"\n\n    # Physical constants and fixed system parameters\n    HC_EV_NM = 1239.84197386209  # hc/e in eV*nm\n    S1, S2 = 0.6, 1.2             # Huang-Rhys factors for conformers 1 and 2\n    P1, P2 = 0.7, 0.3             # Population fractions for conformers 1 and 2\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"E00_1\": 2.30, \"E00_2\": 2.28, \"hbar_omega\": 0.18, \"fwhm\": 0.05,\n            \"wavelengths_nm\": [520, 540, 560, 580, 600]\n        },\n        {\n            \"E00_1\": 2.30, \"E00_2\": 2.28, \"hbar_omega\": 0.18, \"fwhm\": 0.005,\n            \"wavelengths_nm\": [520, 540, 560, 580, 600]\n        },\n        {\n            \"E00_1\": 2.31, \"E00_2\": 2.29, \"hbar_omega\": 0.09, \"fwhm\": 0.02,\n            \"wavelengths_nm\": [520, 540, 560, 580, 600]\n        }\n    ]\n\n    # A principled truncation limit for the vibrational quantum number v.\n    # For S=1.2, the FCF at v=15 is ~1e-10, thus sum is well-converged.\n    V_MAX = 15\n    v_series = np.arange(0, V_MAX + 1)\n    v_factorials = factorial(v_series)\n\n    # Conformer parameters to iterate over\n    conformer_params = [(S1, P1), (S2, P2)]\n    \n    all_results = []\n\n    for case in test_cases:\n        wavelengths_nm = np.array(case[\"wavelengths_nm\"])\n        E_samples_eV = HC_EV_NM / wavelengths_nm\n        \n        fwhm = case[\"fwhm\"]\n        hbar_omega = case[\"hbar_omega\"]\n        \n        # Calculate Gaussian standard deviation from FWHM\n        sigma = fwhm / (2.0 * np.sqrt(2.0 * np.log(2.0)))\n        \n        total_intensity_spectrum = np.zeros_like(E_samples_eV)\n        \n        case_e00 = [case[\"E00_1\"], case[\"E00_2\"]]\n\n        for i, (S, P) in enumerate(conformer_params):\n            E00 = case_e00[i]\n            \n            # --- Vectorized calculation for one conformer ---\n\n            # 1. Calculate Franck-Condon Factors (FCFs) for the vibronic progression\n            # FCF_v = (S^v * exp(-S)) / v!\n            fcf_v = (S**v_series * np.exp(-S)) / v_factorials\n            \n            # 2. Calculate the energy of each vibronic line\n            # E_v = E00 - v * hbar_omega\n            E_v = E00 - v_series * hbar_omega\n            \n            # 3. Calculate the broadened spectrum using numpy broadcasting\n            # Reshape arrays to (num_samples, 1) and (1, num_v_levels)\n            E_samples_col = E_samples_eV[:, np.newaxis]\n            E_v_row = E_v[np.newaxis, :]\n            \n            # Calculate Gaussian contribution for all (E_sample, E_v) pairs\n            # G(E; E_v, sigma) = 1/(sigma*sqrt(2pi)) * exp(-(E-E_v)^2 / (2*sigma^2))\n            exponent = -0.5 * ((E_samples_col - E_v_row) / sigma)**2\n            gaussian_lineshapes = (1.0 / (sigma * np.sqrt(2.0 * np.pi))) * np.exp(exponent)\n            \n            # 4. Weight each Gaussian by its population-scaled FCF and sum\n            # The total spectrum is the sum of weighted Gaussians\n            # I(E) = P * sum_v [ FCF_v * G(E; E_v, sigma) ]\n            conformer_intensity = np.sum(P * fcf_v[np.newaxis, :] * gaussian_lineshapes, axis=1)\n            \n            # 5. Add this conformer's spectrum to the total\n            total_intensity_spectrum += conformer_intensity\n\n        # Round the final results to six decimal places\n        rounded_results = np.round(total_intensity_spectrum, 6).tolist()\n        all_results.append(rounded_results)\n\n    # Final print statement in the exact required format: [[...],[...],[...]] with no spaces.\n    # Using str().replace() is a robust way to achieve this format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}