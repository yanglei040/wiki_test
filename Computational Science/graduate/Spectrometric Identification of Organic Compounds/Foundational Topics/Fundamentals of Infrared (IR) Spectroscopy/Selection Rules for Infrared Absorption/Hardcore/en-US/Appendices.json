{
    "hands_on_practices": [
        {
            "introduction": "To truly master spectroscopic principles, we must move beyond memorizing rules to understanding their quantum mechanical origins. This first practice challenges you to derive the fundamental selection rule for infrared absorption from first principles . By analyzing the transition dipole moment integral and the Taylor series expansion of the molecular dipole moment, you will uncover precisely why a *change* in dipole moment during a vibration, represented by a non-zero derivative $\\left(\\frac{\\partial \\boldsymbol{\\mu}}{\\partial Q}\\right)_{0}$, is the essential condition for IR activity, and in doing so, you will clarify common misconceptions about the role of a molecule's permanent dipole moment.",
            "id": "3723203",
            "problem": "Consider a single normal coordinate $Q$ describing a small-amplitude vibration of a polyatomic molecule about its equilibrium geometry at $Q=0$. The molecule interacts with a classical, linearly polarized electromagnetic field through the electric-dipole interaction Hamiltonian $H'(t)=-\\boldsymbol{\\mu}(Q)\\cdot \\mathbf{E}_0 \\cos(\\omega t)$, where $\\boldsymbol{\\mu}(Q)$ is the molecular dipole moment as a function of $Q$. Within first-order time-dependent perturbation theory and the Born–Oppenheimer and Franck–Condon approximations, the intensity for the fundamental vibrational transition $v=0 \\to v=1$ along $Q$ is proportional to the square of the vibrational transition dipole moment $M=\\langle 1|\\boldsymbol{\\mu}(Q)\\cdot \\hat{\\mathbf{e}}|0\\rangle$, where $|v\\rangle$ are the harmonic-oscillator eigenstates for motion along $Q$ and $\\hat{\\mathbf{e}}$ is the unit vector along the field polarization. You may assume the following foundational facts: (i) the harmonic-oscillator eigenfunctions have definite parity, with $|0\\rangle$ even and $|1\\rangle$ odd in $Q$; (ii) for sufficiently small displacements, any component of $\\boldsymbol{\\mu}(Q)$ can be expanded in a Taylor series about $Q=0$; (iii) orthogonality of distinct harmonic-oscillator eigenstates; and (iv) group-theoretical selection rules state that a vibrational normal mode is Infrared (IR) active if and only if the normal coordinate transforms as one of the Cartesian components $x$, $y$, or $z$ of the dipole moment.\n\nStarting strictly from these bases, and without assuming a priori any specific “selection rule,” reason out the condition on the first nonvanishing term in the Taylor series of $\\boldsymbol{\\mu}(Q)$ that must be satisfied for the fundamental $v=0 \\to 1$ transition to carry intensity under the electric-dipole approximation. Then use that reasoning to assess the following statements for correctness. Select all statements that are correct.\n\nA. A polar diatomic molecule $\\mathrm{AB}$ with nonzero permanent dipole moment at equilibrium (i.e., $\\boldsymbol{\\mu}(0)\\neq \\mathbf{0}$) necessarily exhibits an IR-active fundamental stretching vibration solely because $\\boldsymbol{\\mu}(0)\\neq \\mathbf{0}$.\n\nB. For a fundamental transition $v=0 \\to 1$ in mode $Q$ treated within the harmonic approximation, the intensity under the electric-dipole approximation is nonzero only if the dipole-moment component along the field has a nonzero first derivative at equilibrium, i.e., $\\left(\\partial \\mu_{\\parallel}/\\partial Q\\right)_{0}\\neq 0$.\n\nC. In linear $\\mathrm{O=C=O}$, the symmetric stretch is IR-inactive for the fundamental despite changes in the individual $\\mathrm{C-O}$ bond lengths because the net dipole moment remains zero to first order in the symmetric-stretch normal coordinate, i.e., $\\left(\\partial \\boldsymbol{\\mu}/\\partial Q_{\\mathrm{sym}}\\right)_{0}=\\mathbf{0}$.\n\nD. A normal mode in any molecule (including those with $\\boldsymbol{\\mu}(0)=\\mathbf{0}$) is IR-active if its normal coordinate transforms as one of $x$, $y$, or $z$; hence, the asymmetric stretch of linear $\\mathrm{O=C=O}$ is IR-active at the fundamental because $\\left(\\partial \\boldsymbol{\\mu}/\\partial Q_{\\mathrm{asym}}\\right)_{0}\\neq \\mathbf{0}$ even though $\\boldsymbol{\\mu}(0)=\\mathbf{0}$.\n\nE. If $\\left(\\partial \\boldsymbol{\\mu}/\\partial Q\\right)_{0}= \\mathbf{0}$ for a given mode, then the $v=0 \\to 1$ fundamental is strictly forbidden under the electric-dipole approximation for that mode, even when higher-order terms in the Taylor series of $\\boldsymbol{\\mu}(Q)$ are included.\n\nYour answer should be the set of all correct options.",
            "solution": "The problem statement is evaluated for validity.\n\n**Step 1: Extract Givens**\n-   **System**: A polyatomic molecule undergoing a small-amplitude vibration along a single normal coordinate $Q$ about its equilibrium geometry at $Q=0$.\n-   **Interaction Hamiltonian**: $H'(t)=-\\boldsymbol{\\mu}(Q)\\cdot \\mathbf{E}_0 \\cos(\\omega t)$, where $\\boldsymbol{\\mu}(Q)$ is the molecular dipole moment as a function of $Q$. This is the electric-dipole interaction.\n-   **Theoretical Framework**: First-order time-dependent perturbation theory, Born–Oppenheimer approximation, and Franck–Condon approximation.\n-   **Transition Intensity**: Proportional to the square of the vibrational transition dipole moment, $|M|^2$, where $M=\\langle 1|\\boldsymbol{\\mu}(Q)\\cdot \\hat{\\mathbf{e}}|0\\rangle$.\n-   **Definitions**: $|v\\rangle$ are the harmonic-oscillator eigenstates for motion along $Q$. $\\hat{\\mathbf{e}}$ is the unit vector along the electric field polarization of the light.\n-   **Foundational Facts**:\n    (i) The harmonic-oscillator eigenfunctions $|0\\rangle$ and $|1\\rangle$ have definite parity in $Q$: $|0\\rangle$ is even, and $|1\\rangle$ is odd.\n    (ii) The molecular dipole moment component along the field, $\\boldsymbol{\\mu}(Q)\\cdot \\hat{\\mathbf{e}}$, can be expanded in a Taylor series about $Q=0$.\n    (iii) Harmonic-oscillator eigenstates are orthogonal: $\\langle v'|v\\rangle = \\delta_{v'v}$.\n    (iv) A group-theoretical selection rule states that a normal mode is Infrared (IR) active if and only if its normal coordinate transforms as one of the Cartesian components $x$, $y$, or $z$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard textbook exercise in molecular spectroscopy.\n-   **Scientifically Grounded**: The problem is based on fundamental principles of quantum mechanics (perturbation theory, harmonic oscillator) and their application to molecular spectroscopy (electric-dipole transitions). All concepts are well-established. It is scientifically sound.\n-   **Well-Posed**: The problem provides a clear theoretical framework and sufficient information to derive the required condition and evaluate the statements. A unique, meaningful analysis is possible.\n-   **Objective**: The language is precise, technical, and free of subjective content.\n\nThe problem statement has no identifiable flaws. It is not unsound, incomplete, contradictory, unrealistic, or ill-posed.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution will proceed.\n\n**Derivation of the Selection Rule Condition**\n\nThe intensity of the fundamental vibrational transition $v=0 \\to v=1$ is proportional to $|M|^2$, where the transition dipole moment $M$ is given by:\n$$ M = \\langle 1|\\boldsymbol{\\mu}(Q)\\cdot \\hat{\\mathbf{e}}|0\\rangle $$\nLet $\\mu_{\\parallel}(Q) = \\boldsymbol{\\mu}(Q)\\cdot \\hat{\\mathbf{e}}$ be the component of the dipole moment parallel to the electric field vector.\n$$ M = \\langle 1|\\mu_{\\parallel}(Q)|0\\rangle $$\nUsing foundational fact (ii), we expand $\\mu_{\\parallel}(Q)$ in a Taylor series about the equilibrium position $Q=0$:\n$$ \\mu_{\\parallel}(Q) = \\mu_{\\parallel}(Q=0) + \\left(\\frac{\\partial \\mu_{\\parallel}}{\\partial Q}\\right)_{Q=0} Q + \\frac{1}{2}\\left(\\frac{\\partial^2 \\mu_{\\parallel}}{\\partial Q^2}\\right)_{Q=0} Q^2 + \\dots $$\nSubstituting this expansion into the expression for $M$:\n$$ M = \\left\\langle 1 \\left| \\mu_{\\parallel}(0) + \\left(\\frac{\\partial \\mu_{\\parallel}}{\\partial Q}\\right)_{0} Q + \\frac{1}{2}\\left(\\frac{\\partial^2 \\mu_{\\parallel}}{\\partial Q^2}\\right)_{0} Q^2 + \\dots \\right| 0 \\right\\rangle $$\nWe can separate this into a sum of matrix elements:\n$$ M = \\mu_{\\parallel}(0) \\langle 1 | 0 \\rangle + \\left(\\frac{\\partial \\mu_{\\parallel}}{\\partial Q}\\right)_{0} \\langle 1 | Q | 0 \\rangle + \\frac{1}{2}\\left(\\frac{\\partial^2 \\mu_{\\parallel}}{\\partial Q^2}\\right)_{0} \\langle 1 | Q^2 | 0 \\rangle + \\dots $$\nNow we evaluate each term using the given foundational facts:\n1.  **Term 1**: $\\mu_{\\parallel}(0) \\langle 1 | 0 \\rangle$. The term $\\mu_{\\parallel}(0)$ is a component of the permanent dipole moment at equilibrium. According to fact (iii), the eigenstates are orthogonal, so $\\langle 1 | 0 \\rangle = 0$. Thus, the first term is zero. This demonstrates that a non-zero permanent dipole moment is not sufficient for a fundamental transition to be active.\n2.  **Term 2**: $\\left(\\frac{\\partial \\mu_{\\parallel}}{\\partial Q}\\right)_{0} \\langle 1 | Q | 0 \\rangle$. The integral is $\\int_{-\\infty}^{\\infty} \\psi_1^*(Q) Q \\psi_0(Q) dQ$. According to fact (i), $\\psi_0(Q)$ is an even function and $\\psi_1(Q)$ is an odd function. The operator $Q$ is an odd function. The parity of the integrand is therefore (odd) $\\times$ (odd) $\\times$ (even) = (even). The integral of a non-trivial even function over a symmetric interval is non-zero. For the quantum harmonic oscillator, this integral is known to be non-zero. Therefore, this entire term is non-zero if and only if the pre-factor $\\left(\\frac{\\partial \\mu_{\\parallel}}{\\partial Q}\\right)_{0}$ is non-zero.\n3.  **Term 3**: $\\frac{1}{2}\\left(\\frac{\\partial^2 \\mu_{\\parallel}}{\\partial Q^2}\\right)_{0} \\langle 1 | Q^2 | 0 \\rangle$. The integral is $\\int_{-\\infty}^{\\infty} \\psi_1^*(Q) Q^2 \\psi_0(Q) dQ$. The operator $Q^2$ is an even function. The parity of the integrand is (odd) $\\times$ (even) $\\times$ (even) = (odd). The integral of any odd function over a symmetric interval ($-\\infty$ to $\\infty$) is exactly zero. Thus, the third term is zero.\n\nThe analysis shows that the leading non-zero contribution to the transition dipole moment $M$ for the $v=0 \\to 1$ transition arises from the term in the Taylor expansion of $\\mu_{\\parallel}(Q)$ that is linear in $Q$. For the transition to carry intensity, $M$ must be non-zero. The primary condition for this is that the first nonvanishing term in the Taylor series expansion of $\\mu_{\\parallel}(Q)$ which results in a non-zero matrix element is present. This corresponds to the linear term. Therefore, the fundamental selection rule for IR absorption is that the dipole moment must change linearly with the normal coordinate displacement, i.e., $\\left(\\frac{\\partial \\boldsymbol{\\mu}}{\\partial Q}\\right)_{0} \\neq \\mathbf{0}$.\n\n**Option-by-Option Analysis**\n\n**A. A polar diatomic molecule $\\mathrm{AB}$ with nonzero permanent dipole moment at equilibrium (i.e., $\\boldsymbol{\\mu}(0)\\neq \\mathbf{0}$) necessarily exhibits an IR-active fundamental stretching vibration solely because $\\boldsymbol{\\mu}(0)\\neq \\mathbf{0}$.**\nAs shown in the derivation, the term in the transition moment integral involving the permanent dipole moment, $\\mu_{\\parallel}(0) \\langle 1 | 0 \\rangle$, is zero due to the orthogonality of the vibrational wavefunctions (fact (iii)). The IR activity of the fundamental transition depends on the *change* in dipole moment during the vibration, i.e., on the derivative $\\left(\\partial \\boldsymbol{\\mu}/\\partial Q\\right)_{0}$, not on the static value $\\boldsymbol{\\mu}(0)$. The statement that the activity is \"solely because $\\boldsymbol{\\mu}(0)\\neq \\mathbf{0}$\" is fundamentally incorrect.\n**Verdict: Incorrect.**\n\n**B. For a fundamental transition $v=0 \\to 1$ in mode $Q$ treated within the harmonic approximation, the intensity under the electric-dipole approximation is nonzero only if the dipole-moment component along the field has a nonzero first derivative at equilibrium, i.e., $\\left(\\partial \\mu_{\\parallel}/\\partial Q\\right)_{0}\\neq 0$.**\nThe phrase \"harmonic approximation\" in spectroscopy, when discussing fundamental intensities, typically refers to the \"double harmonic\" model: a harmonic potential (giving harmonic oscillator wavefunctions, as stated in the problem) and a dipole moment function that is truncated at the linear term, $\\mu_{\\parallel}(Q) \\approx \\mu_{\\parallel}(0) + (\\partial \\mu_{\\parallel}/\\partial Q)_{0} Q$. Within this model, the transition moment becomes $M = \\langle 1 | \\mu_{\\parallel}(0) + (\\partial \\mu_{\\parallel}/\\partial Q)_{0} Q | 0 \\rangle = (\\partial \\mu_{\\parallel}/\\partial Q)_{0} \\langle 1 | Q | 0 \\rangle$. Since $\\langle 1 | Q | 0 \\rangle \\neq 0$, the intensity is non-zero if and only if $(\\partial \\mu_{\\parallel}/\\partial Q)_{0} \\neq 0$. The statement's use of \"only if\" is correct within this standard and contextually appropriate interpretation of \"harmonic approximation\".\n**Verdict: Correct.**\n\n**C. In linear $\\mathrm{O=C=O}$, the symmetric stretch is IR-inactive for the fundamental despite changes in the individual $\\mathrm{C-O}$ bond lengths because the net dipole moment remains zero to first order in the symmetric-stretch normal coordinate, i.e., $\\left(\\partial \\boldsymbol{\\mu}/\\partial Q_{\\mathrm{sym}}\\right)_{0}=\\mathbf{0}$.**\nThe molecule $\\mathrm{O=C=O}$ is linear and centrosymmetric at equilibrium, so its permanent dipole moment $\\boldsymbol{\\mu}(0)$ is zero. The symmetric stretch vibration maintains the center of symmetry at all displacements $Q_{\\mathrm{sym}}$. A molecule with a center of symmetry cannot possess an electric dipole moment. Therefore, $\\boldsymbol{\\mu}(Q_{\\mathrm{sym}}) = \\mathbf{0}$ for all values of $Q_{\\mathrm{sym}}$. If a function is identically zero, all of its derivatives are also zero. This means $\\left(\\partial \\boldsymbol{\\mu}/\\partial Q_{\\mathrm{sym}}\\right)_{0}=\\mathbf{0}$. Based on our derivation, this leads to a zero transition dipole moment and thus zero intensity for the fundamental. The reasoning provided in the statement is perfectly sound. The changes in the individual bond dipoles cancel out due to symmetry.\n**Verdict: Correct.**\n\n**D. A normal mode in any molecule (including those with $\\boldsymbol{\\mu}(0)=\\mathbf{0}$) is IR-active if its normal coordinate transforms as one of $x$, $y$, or $z$; hence, the asymmetric stretch of linear $\\mathrm{O=C=O}$ is IR-active at the fundamental because $\\left(\\partial \\boldsymbol{\\mu}/\\partial Q_{\\mathrm{asym}}\\right)_{0}\\neq \\mathbf{0}$ even though $\\boldsymbol{\\mu}(0)=\\mathbf{0}$.**\nThis statement invokes foundational fact (iv) and connects it to the derived condition. The group-theoretical condition that the normal coordinate $Q$ must transform as one of the Cartesian coordinates ($x, y, z$) is mathematically equivalent to the condition that at least one component of the vector derivative, $\\left(\\partial \\mu_x/\\partial Q\\right)_{0}$, $\\left(\\partial \\mu_y/\\partial Q\\right)_{0}$, or $\\left(\\partial \\mu_z/\\partial Q\\right)_{0}$, is non-zero. For the asymmetric stretch of $\\mathrm{CO}_2$, the motion consists of one C-O bond lengthening while the other shortens. This breaks the center of symmetry and induces a net dipole moment along the molecular axis (let's say the $z$-axis). For small displacements $Q_{\\mathrm{asym}}$, the induced dipole moment is approximately proportional to the displacement, $\\mu_z \\approx c Q_{\\mathrm{asym}}$, where $c \\neq 0$. Thus, $\\left(\\partial \\mu_z/\\partial Q_{\\mathrm{asym}}\\right)_{0} = c \\neq 0$, while $\\boldsymbol{\\mu}(0) = \\mathbf{0}$. The statement correctly applies the derived principle to the asymmetric stretch of $\\mathrm{CO}_2$ and correctly links it to the group theory rule.\n**Verdict: Correct.**\n\n**E. If $\\left(\\partial \\boldsymbol{\\mu}/\\partial Q\\right)_{0}= \\mathbf{0}$ for a given mode, then the $v=0 \\to 1$ fundamental is strictly forbidden under the electric-dipole approximation for that mode, even when higher-order terms in the Taylor series of $\\boldsymbol{\\mu}(Q)$ are included.**\nThis statement claims the transition is \"strictly forbidden\". From our derivation, the transition moment is $M = \\mu'_{\\parallel,0} \\langle 1 | Q | 0 \\rangle + \\frac{1}{2} \\mu''_{\\parallel,0} \\langle 1 | Q^2 | 0 \\rangle + \\frac{1}{6} \\mu'''_{\\parallel,0} \\langle 1 | Q^3 | 0 \\rangle + \\dots$. If $(\\partial \\boldsymbol{\\mu}/\\partial Q)_{0} = \\mathbf{0}$, then its component $\\mu'_{\\parallel,0} = 0$. The first term vanishes. The second term vanishes due to parity ($\\langle 1 | Q^2 | 0 \\rangle=0$). However, the third term involves $\\langle 1 | Q^3 | 0 \\rangle$. The integrand $\\psi_1^* Q^3 \\psi_0$ has (odd) $\\times$ (odd) $\\times$ (even) = even parity, so the integral is not generally zero. Therefore, if $\\mu'_{\\parallel,0}=0$ but the third derivative $\\mu'''_{\\parallel,0}$ is non-zero, the transition moment $M$ can be non-zero. The transition is not strictly forbidden; it is merely forbidden in the harmonic approximation (of the dipole moment). The phenomenon of activity due to higher-order electrical terms is called electrical anharmonicity. These transitions are typically very weak, but not strictly forbidden.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{BCD}$$"
        },
        {
            "introduction": "With the fundamental selection rule established, we can now predict the detailed structure of an infrared absorption band. This exercise applies the rovibrational selection rules to a real diatomic molecule, carbon monoxide, treating it as a rigid rotor and harmonic oscillator . By calculating the specific wavenumbers for transitions in the P-branch ($\\Delta J = -1$) and R-branch ($\\Delta J = +1$), you will gain hands-on experience in constructing a theoretical spectrum and understanding how the coupling of rotational and vibrational motion gives rise to the characteristic patterns observed in high-resolution gas-phase spectroscopy.",
            "id": "3723186",
            "problem": "A heteronuclear diatomic molecule with a permanent electric dipole moment, such as carbon monoxide (CO), exhibits rovibrational absorption in the infrared (IR) spectrum. Consider the following foundational facts: (i) the electric dipole transition moment integral imposes angular momentum selection rules for rigid rotor states characterized by spherical harmonics, yielding the rotational selection rule $\\Delta J=\\pm 1$ for dipole-allowed transitions; (ii) the vibrational fundamental band center is characterized by a band origin wavenumber $\\tilde{\\nu}_{0}$, defined as the energy difference between $v=0$ and $v=1$ in wavenumbers in the absence of rotational structure; (iii) the rigid rotor rotational energy levels in wavenumbers are $\\tilde{E}_{J}=B\\,J(J+1)$, where $B$ is the rotational constant and $J$ is the rotational quantum number, and centrifugal distortion is negligible; and (iv) for a given vibrational transition $v=0\\to 1$, the upper and lower rotational constants may be approximated equal, $B^{\\prime}\\approx B^{\\prime\\prime}=B$, when the change in bond length upon vibrational excitation is small.\n\nStarting from these principles only, derive the expressions for the rovibrational line positions in the $R$-branch and $P$-branch for a diatomic molecule, explicitly showing how the selection rule $\\Delta J=\\pm 1$ and the rigid rotor level spacings determine the line positions relative to the band origin $\\tilde{\\nu}_{0}$. Then, using the values $B=1.9313\\,\\text{cm}^{-1}$ and a fundamental band origin $\\tilde{\\nu}_{0}=2143\\,\\text{cm}^{-1}$ for CO, compute the wavenumber positions (in $\\text{cm}^{-1}$) of the $R(0)$ through $R(3)$ lines and the $P(1)$ through $P(4)$ lines, neglecting centrifugal distortion and assuming $B^{\\prime}=B^{\\prime\\prime}=B$. Express your final numerical answers in $\\text{cm}^{-1}$. No rounding requirement is imposed; report the exact values implied by the given data.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n-   The system is a heteronuclear diatomic molecule with a permanent electric dipole moment.\n-   The spectroscopic process is rovibrational absorption in the Infrared (IR).\n-   $i) Rotational selection rule: $\\Delta J = \\pm 1$.\n-   $ii) Vibrational fundamental band origin wavenumber: $\\tilde{\\nu}_{0}$, corresponding to the energy difference between vibrational levels $v=0$ and $v=1$ in the absence of rotation.\n-   $iii) Rigid rotor rotational energy levels in wavenumbers: $\\tilde{E}_{J} = B\\,J(J+1)$, where $B$ is the rotational constant, $J$ is the rotational quantum number, and centrifugal distortion is negligible.\n-   $iv) Approximation for the rotational constants: $B^{\\prime} \\approx B^{\\prime\\prime} = B$, where $B^{\\prime}$ is the rotational constant for the upper vibrational state ($v=1$) and $B^{\\prime\\prime}$ is for the lower vibrational state ($v=0$).\n-   Value of the rotational constant for CO: $B = 1.9313\\,\\text{cm}^{-1}$.\n-   Value of the fundamental band origin for CO: $\\tilde{\\nu}_{0} = 2143\\,\\text{cm}^{-1}$.\n-   The task is to derive expressions for the line positions in the $R$-branch and $P$-branch.\n-   The task is to compute the numerical wavenumber positions for the $R(0)$ through $R(3)$ lines and the $P(1)$ through $P(4)$ lines for CO.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is based on the well-established rigid rotor-harmonic oscillator model for the rovibrational spectroscopy of diatomic molecules. The selection rules, energy level expressions, and the concept of $P$ and $R$ branches are fundamental principles in molecular spectroscopy. All premises are factually and scientifically sound.\n-   **Well-Posed:** The problem is clearly defined. It provides all necessary equations, constants, and constraints (e.g., neglecting centrifugal distortion, $B^{\\prime}=B^{\\prime\\prime}$) to derive the required expressions and compute the specific line positions. A unique and meaningful solution exists.\n-   **Objective:** The problem statement is expressed in precise, technical language, free of subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is scientifically sound, well-posed, and objective. The solution process may proceed.\n\n### Solution Derivation\nThe total rovibrational energy of a diatomic molecule within the given approximations, expressed in wavenumbers ($\\text{cm}^{-1}$), is the sum of its vibrational and rotational energies. The problem states that the energy difference between the vibrational ground state ($v=0$) and the first excited state ($v=1$) is the band origin, $\\tilde{\\nu}_{0}$. The rotational energy in a given vibrational state $v$ is given by $\\tilde{E}_{J} = B_{v}J(J+1)$, where $B_v$ is the rotational constant for that vibrational state.\n\nA rovibrational transition occurs from an initial state $(v'', J'')$ to a final state $(v', J')$. For the fundamental absorption band, the vibrational quantum number changes from $v''=0$ to $v'=1$. The wavenumber $\\tilde{\\nu}$ of the absorbed photon is given by the difference in energy between the final and initial states:\n$$ \\tilde{\\nu} = E_{v', J'} - E_{v'', J''} = (E_{v=1} - E_{v=0}) + (E_{J'} - E_{J''}) $$\nUsing the notation from the problem statement:\n$$ \\tilde{\\nu}(J', J'') = \\tilde{\\nu}_{0} + \\tilde{E}_{J'} - \\tilde{E}_{J''} $$\nThe rotational energies are $\\tilde{E}_{J'} = B'J'(J'+1)$ and $\\tilde{E}_{J''} = B''J''(J''+1)$. The problem specifies the approximation that the rotational constants are equal in the upper and lower states, so $B' = B'' = B$. The expression for the transition wavenumber becomes:\n$$ \\tilde{\\nu}(J', J'') = \\tilde{\\nu}_{0} + B J'(J'+1) - B J''(J''+1) $$\n\nThe problem is governed by the rotational selection rule $\\Delta J = J' - J'' = \\pm 1$. This selection rule gives rise to two branches in the spectrum.\n\n**1. The R-branch ($\\Delta J = +1$)**\nFor the R-branch, the final rotational quantum number is one greater than the initial one: $J' = J'' + 1$. Conventionally, the lines are denoted by the quantum number of the lower state, $J''$, so we let $J'' = J$, where $J = 0, 1, 2, \\dots$. Consequently, $J' = J+1$. Substituting these into the general expression for $\\tilde{\\nu}$:\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + B(J+1)((J+1)+1) - B J(J+1) $$\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + B(J+1)(J+2) - B J(J+1) $$\nFactoring out the common term $B(J+1)$:\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + B(J+1)[(J+2) - J] $$\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + B(J+1)(2) $$\nThe derived expression for the $R$-branch line positions is:\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + 2B(J+1) \\quad | \\quad J=0, 1, 2, \\dots $$\nThese lines appear at wavenumbers higher than the band origin $\\tilde{\\nu}_{0}$ and are spaced by $2B$.\n\n**2. The P-branch ($\\Delta J = -1$)**\nFor the $P$-branch, the final rotational quantum number is one less than the initial one: $J' = J'' - 1$. The lines are again denoted by the quantum number of the lower state, $J''$, so we let $J'' = J$. Consequently, $J' = J-1$. The lowest possible value for $J''$ is $1$, because if $J''=0$, then $J'=-1$, which is physically impossible. Thus, for the $P$-branch, $J = 1, 2, 3, \\dots$. Substituting these into the general expression for $\\tilde{\\nu}$:\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} + B(J-1)((J-1)+1) - B J(J+1) $$\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} + B(J-1)J - B J(J+1) $$\nFactoring out the common term $BJ$:\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} + BJ[(J-1) - (J+1)] $$\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} + BJ(-2) $$\nThe derived expression for the $P$-branch line positions is:\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} - 2BJ \\quad | \\quad J=1, 2, 3, \\dots $$\nThese lines appear at wavenumbers lower than the band origin $\\tilde{\\nu}_{0}$ and are also spaced by $2B$.\n\n### Numerical Calculation for CO\nThe given values are $\\tilde{\\nu}_{0} = 2143\\,\\text{cm}^{-1}$ and $B = 1.9313\\,\\text{cm}^{-1}$.\n\n**R-branch lines ($R(0)$ to $R(3)$):**\nUsing the formula $\\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + 2B(J+1)$:\n-   For $R(0)$, $J=0$:\n    $\\tilde{\\nu}_{R(0)} = 2143 + 2(1.9313)(0+1) = 2143 + 2(1.9313) = 2143 + 3.8626 = 2146.8626\\,\\text{cm}^{-1}$.\n-   For $R(1)$, $J=1$:\n    $\\tilde{\\nu}_{R(1)} = 2143 + 2(1.9313)(1+1) = 2143 + 4(1.9313) = 2143 + 7.7252 = 2150.7252\\,\\text{cm}^{-1}$.\n-   For $R(2)$, $J=2$:\n    $\\tilde{\\nu}_{R(2)} = 2143 + 2(1.9313)(2+1) = 2143 + 6(1.9313) = 2143 + 11.5878 = 2154.5878\\,\\text{cm}^{-1}$.\n-   For $R(3)$, $J=3$:\n    $\\tilde{\\nu}_{R(3)} = 2143 + 2(1.9313)(3+1) = 2143 + 8(1.9313) = 2143 + 15.4504 = 2158.4504\\,\\text{cm}^{-1}$.\n\n**P-branch lines ($P(1)$ to $P(4)$):**\nUsing the formula $\\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} - 2BJ$:\n-   For $P(1)$, $J=1$:\n    $\\tilde{\\nu}_{P(1)} = 2143 - 2(1.9313)(1) = 2143 - 3.8626 = 2139.1374\\,\\text{cm}^{-1}$.\n-   For $P(2)$, $J=2$:\n    $\\tilde{\\nu}_{P(2)} = 2143 - 2(1.9313)(2) = 2143 - 4(1.9313) = 2143 - 7.7252 = 2135.2748\\,\\text{cm}^{-1}$.\n-   For $P(3)$, $J=3$:\n    $\\tilde{\\nu}_{P(3)} = 2143 - 2(1.9313)(3) = 2143 - 6(1.9313) = 2143 - 11.5878 = 2131.4122\\,\\text{cm}^{-1}$.\n-   For $P(4)$, $J=4$:\n    $\\tilde{\\nu}_{P(4)} = 2143 - 2(1.9313)(4) = 2143 - 8(1.9313) = 2143 - 15.4504 = 2127.5496\\,\\text{cm}^{-1}$.\n\nThe final computed values for the requested line positions are collected.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 2146.8626 & 2150.7252 & 2154.5878 & 2158.4504 & 2139.1374 & 2135.2748 & 2131.4122 & 2127.5496 \\end{pmatrix}} $$"
        },
        {
            "introduction": "While diatomic molecules provide a clear starting point, real-world chemistry involves complex polyatomic molecules where vibrations are coupled. This final practice elevates our analysis by introducing the computational methods at the heart of modern vibrational spectroscopy . You will implement a complete normal mode analysis, using linear algebra to diagonalize a mass-weighted Hessian matrix to find vibrational frequencies and modes. By transforming the dipole moment derivatives into this normal mode basis, you will compute which modes are IR-active and their relative intensities, bridging the gap between abstract theory and powerful, practical simulation.",
            "id": "3723197",
            "problem": "You are given reduced vibrational-space data for formaldehyde (chemical formula $\\mathrm{H_2CO}$, non-linear with $N=4$ atoms), consisting of a $6 \\times 6$ real, symmetric, positive-definite matrix representing a mass-weighted Hessian projected into the vibrational subspace and a $3 \\times 6$ real matrix representing the first derivatives of the molecular dipole moment vector with respect to the same $6$ orthogonal vibrational Cartesian coordinates prior to normal-mode diagonalization. The selection rule for infrared absorption states that a vibrational normal mode is infrared-active if and only if the derivative of the molecular dipole moment with respect to that normal coordinate is non-zero.\n\nYour task is to write a complete program that, for each provided test case, performs the following steps purely from first principles:\n\n1. Start from the classical small-oscillation model near equilibrium. The potential energy is quadratic in displacements and the kinetic energy is quadratic in velocities. The mass-weighted Hessian projected into the vibrational subspace yields a symmetric matrix whose eigenvalues are the squared angular frequencies and whose orthonormal eigenvectors are the normal modes in the chosen $6$-dimensional vibrational coordinate basis.\n\n2. Use this model to obtain the normal modes by orthogonal diagonalization of the given $6 \\times 6$ matrix. Sort the resulting normal modes in ascending order of their angular frequencies (equivalently, ascending eigenvalues).\n\n3. Use the dipole selection rule for infrared absorption derived from the interaction Hamiltonian with the radiation field: a mode $k$ is infrared-active if the derivative of the dipole moment with respect to the corresponding normal coordinate is non-zero. Given the $3 \\times 6$ dipole derivative matrix with respect to the original vibrational coordinates, compute for each normal mode the derivative of the dipole vector with respect to that normal coordinate by linear transformation into the normal-mode basis. The infrared intensity is proportional to the squared magnitude of this derivative vector. Implement a numerical activity threshold $\\varepsilon = 10^{-8}$ for deciding whether a mode is active: if the squared magnitude is greater than $\\varepsilon$, the mode is considered infrared-active; otherwise it is inactive.\n\n4. Report relative intensities by normalizing the non-negative intensities so that their sum over the six modes is $1$. If the sum of intensities is $0$ (all modes inactive), report the normalized intensities as six zeros. Your program should round the normalized intensities to six decimal places for output.\n\nYour program must treat each test case independently and produce a single line of output containing a list of results, one per test case, in the specified format below. For each test case, report a pair of lists: the first is a list of booleans, one for each of the six modes ordered by ascending angular frequency, indicating infrared activity; the second is the corresponding list of six normalized intensities (floats) rounded to six decimal places. The final output format is a single line containing a list of three such pairs, one for each test case, printed exactly as a valid Python literal for nested lists, for example:\n[[[True,False,True,True,False,True],[0.0,0.1,0.2,0.3,0.4,0.0]],[[...],[...]],[[...],[...]]]\n\nFoundational starting point you must employ:\n- Classical small oscillations in a conservative system near equilibrium: the potential energy is quadratic in displacements and the kinetic energy is quadratic in velocities. In mass-weighted coordinates, diagonalization of the symmetric matrix of second derivatives yields normal modes and squared angular frequencies.\n- Electromagnetic interaction where the transition intensity in the electric-dipole approximation is connected to the derivative of the dipole moment with respect to the nuclear normal coordinate, implying the selection rule: infrared activity requires a non-zero dipole derivative along the normal mode.\n\nDo not use any pre-derived shortcut formulas beyond these foundations; derive the needed working relations in your solution from these bases.\n\nTest Suite:\n\nEach test case provides a $6 \\times 6$ symmetric, positive-definite matrix $\\mathbf{F}$ and a $3 \\times 6$ matrix $\\mathbf{D}$.\n\n- Test Case $1$ (diagonal vibrational Hessian; straightforward mode alignment):\n  - $\\mathbf{F}_1 = \\mathrm{diag}([\\,4,\\,9,\\,16,\\,25,\\,36,\\,49\\,])$, i.e.,\n    $$\\mathbf{F}_1 = \\begin{bmatrix}\n    4 & 0 & 0 & 0 & 0 & 0\\\\\n    0 & 9 & 0 & 0 & 0 & 0\\\\\n    0 & 0 & 16 & 0 & 0 & 0\\\\\n    0 & 0 & 0 & 25 & 0 & 0\\\\\n    0 & 0 & 0 & 0 & 36 & 0\\\\\n    0 & 0 & 0 & 0 & 0 & 49\n    \\end{bmatrix}.$$\n  - $\\mathbf{D}_1$ with columns corresponding to the six vibrational coordinates:\n    $$\\mathbf{D}_1 = \\begin{bmatrix}\n    0.0 & 0.2 & 0.1 & 0.0 & 0.05 & -0.2\\\\\n    0.0 & 0.0 & -0.1 & 0.0 & 0.05 & 0.2\\\\\n    0.0 & 0.0 & 0.0 & 0.3 & 0.05 & 0.0\n    \\end{bmatrix}.$$\n\n- Test Case $2$ (weakly coupled vibrational Hessian; all dipole derivatives zero: boundary case):\n  - $$\\mathbf{F}_2 = \\begin{bmatrix}\n    6.0 & 0.2 & 0.0 & 0.0 & 0.0 & 0.0\\\\\n    0.2 & 7.0 & 0.1 & 0.0 & 0.0 & 0.0\\\\\n    0.0 & 0.1 & 8.0 & 0.3 & 0.0 & 0.0\\\\\n    0.0 & 0.0 & 0.3 & 9.0 & 0.2 & 0.0\\\\\n    0.0 & 0.0 & 0.0 & 0.2 & 10.0 & 0.1\\\\\n    0.0 & 0.0 & 0.0 & 0.0 & 0.1 & 11.0\n    \\end{bmatrix},\\quad\n    \\mathbf{D}_2 = \\begin{bmatrix}\n    0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0\\\\\n    0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0\\\\\n    0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0\n    \\end{bmatrix}.$$\n\n- Test Case $3$ (near-degenerate block and moderate couplings; generic dipole derivatives):\n  - $$\\mathbf{F}_3 = \\begin{bmatrix}\n    5.0 & 0.4 & 0.0 & 0.0 & 0.0 & 0.0\\\\\n    0.4 & 5.1 & 0.2 & 0.0 & 0.0 & 0.0\\\\\n    0.0 & 0.2 & 8.2 & 0.3 & 0.0 & 0.0\\\\\n    0.0 & 0.0 & 0.3 & 10.0 & 0.1 & 0.0\\\\\n    0.0 & 0.0 & 0.0 & 0.1 & 12.0 & 0.25\\\\\n    0.0 & 0.0 & 0.0 & 0.0 & 0.25 & 20.0\n    \\end{bmatrix},\\quad\n    \\mathbf{D}_3 = \\begin{bmatrix}\n    0.1 & 0.0 & 0.2 & -0.1 & 0.1 & 0.0\\\\\n    0.0 & 0.15 & 0.0 & 0.05 & -0.05 & 0.2\\\\\n    0.05 & -0.05 & 0.1 & 0.0 & 0.0 & -0.1\n    \\end{bmatrix}.$$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a Python-style list of three elements, one per test case, where each element is itself a two-element list: the first element is the list of six booleans (infrared-active flags) in ascending angular-frequency order, and the second element is the list of six normalized intensities rounded to six decimal places. For example, a syntactically valid output might look like:\n[[[False,True,True,True,True,True],[0.0,0.1,0.2,0.3,0.25,0.15]],[[False,False,False,False,False,False],[0.0,0.0,0.0,0.0,0.0,0.0]],[[True,True,True,True,True,True],[0.05,0.1,0.2,0.25,0.15,0.25]]]\n\nImportant notes:\n- Angles are not involved, so no angle unit is required.\n- No physical units are required for frequencies or intensities; treat intensities as dimensionless and normalize them to sum to $1$, or to all zeros if the sum is $0$.\n- Use the numerical activity threshold $\\varepsilon = 10^{-8}$ as described above.",
            "solution": "The problem requires us to determine the infrared (IR) activity and relative intensities of the vibrational normal modes of formaldehyde, given its mass-weighted Hessian matrix and the dipole moment derivative matrix in a specific vibrational coordinate system. The solution must be derived from the first principles of classical small oscillations and the quantum mechanical selection rule for IR absorption.\n\nLet the $6$-dimensional vector of mass-weighted vibrational coordinates be denoted by $\\mathbf{q}$. The kinetic energy $T$ and potential energy $V$ for small displacements from the equilibrium geometry are given by:\n$$ T = \\frac{1}{2} \\dot{\\mathbf{q}}^T \\dot{\\mathbf{q}} $$\n$$ V = \\frac{1}{2} \\mathbf{q}^T \\mathbf{F} \\mathbf{q} $$\nHere, the vectors are column vectors, $^T$ denotes the transpose, and $\\mathbf{F}$ is the given $6 \\times 6$ real, symmetric, positive-definite mass-weighted Hessian matrix. The equations of motion, derived from the Lagrangian $L = T - V$, are:\n$$ \\ddot{\\mathbf{q}} + \\mathbf{F} \\mathbf{q} = \\mathbf{0} $$\nThis is a system of coupled linear second-order differential equations. To solve it, we decouple the equations by transforming to a basis of normal coordinates, $\\mathbf{Q}$, where the potential energy is diagonal. This transformation is achieved by finding the eigenvectors of $\\mathbf{F}$. The eigenvalue equation for $\\mathbf{F}$ is:\n$$ \\mathbf{F} \\mathbf{L} = \\mathbf{L} \\mathbf{\\Lambda} $$\nwhere $\\mathbf{L}$ is an orthogonal matrix ($ \\mathbf{L}^T \\mathbf{L} = \\mathbf{I} $) whose columns are the orthonormal eigenvectors of $\\mathbf{F}$, and $\\mathbf{\\Lambda}$ is a diagonal matrix of the corresponding eigenvalues $\\lambda_k$.\nThe transformation to normal coordinates $\\mathbf{Q}$ is defined by $\\mathbf{q} = \\mathbf{L} \\mathbf{Q}$. In this new basis, the equations of motion become uncoupled simple harmonic oscillator equations:\n$$ \\ddot{Q}_k + \\lambda_k Q_k = 0, \\quad \\text{for } k=1, \\dots, 6 $$\nThe eigenvalues $\\lambda_k$ are the squared angular frequencies ($\\lambda_k = \\omega_k^2$) of the normal modes. The eigenvectors, columns of $\\mathbf{L}$, represent the normal modes as linear combinations of the original $\\mathbf{q}$ coordinates. The problem requires sorting these modes by ascending angular frequency, which is equivalent to sorting by ascending eigenvalue $\\lambda_k$.\n\nThe selection rule for a vibrational mode to be infrared-active is that the transition dipole moment must be non-zero. In the harmonic approximation, this simplifies to the condition that the derivative of the molecular dipole moment vector, $\\vec{\\mu}$, with respect to the corresponding normal coordinate, $Q_k$, must be a non-zero vector:\n$$ \\frac{\\partial \\vec{\\mu}}{\\partial Q_k} \\neq \\vec{0} $$\nThe intensity of the absorption, $I_k$, is proportional to the squared magnitude of this derivative vector:\n$$ I_k \\propto \\left\\| \\frac{\\partial \\vec{\\mu}}{\\partial Q_k} \\right\\|^2 $$\nWe are provided with the $3 \\times 6$ matrix $\\mathbf{D}$ whose elements are the derivatives of the three Cartesian components of the dipole moment ($\\mu_x, \\mu_y, \\mu_z$) with respect to the original coordinates $q_j$:\n$$ D_{ij} = \\frac{\\partial \\mu_i}{\\partial q_j} \\quad (i \\in \\{x, y, z\\}, j \\in \\{1, \\dots, 6\\}) $$\nUsing the chain rule, we can relate the derivatives in the normal coordinate basis to the derivatives in the original basis. Since $\\mathbf{q} = \\mathbf{L} \\mathbf{Q}$, or $q_j = \\sum_k L_{jk} Q_k$, we have:\n$$ \\frac{\\partial \\mu_i}{\\partial Q_k} = \\sum_{j=1}^{6} \\frac{\\partial \\mu_i}{\\partial q_j} \\frac{\\partial q_j}{\\partial Q_k} = \\sum_{j=1}^{6} D_{ij} L_{jk} $$\nThis is precisely the formula for matrix multiplication. Let $\\mathbf{D}'$ be the $3 \\times 6$ matrix of dipole derivatives with respect to the normal coordinates, where $D'_{ik} = \\frac{\\partial \\mu_i}{\\partial Q_k}$. Then:\n$$ \\mathbf{D}' = \\mathbf{D} \\mathbf{L} $$\nThe $k^{th}$ column of $\\mathbf{D}'$ is the vector $\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}$. The unnormalized intensity for the $k^{th}$ mode is the squared norm of this column vector:\n$$ I_k = \\left\\| \\left(\\mathbf{D}'\\right)_{\\text{col } k} \\right\\|^2 = \\sum_{i=1}^{3} (D'_{ik})^2 $$\nA mode $k$ is considered infrared-active if its intensity $I_k$ is greater than the given numerical threshold $\\varepsilon = 10^{-8}$.\n\nThe final step is to compute the relative intensities. These are obtained by normalizing the calculated intensities so that their sum is $1$. For a set of six intensities $\\{I_1, I_2, \\dots, I_6\\}$, the total intensity is $I_{\\text{total}} = \\sum_{k=1}^6 I_k$. The normalized intensity for mode $k$ is:\n$$ I_{k, \\text{norm}} = \\frac{I_k}{I_{\\text{total}}} $$\nIf $I_{\\text{total}} = 0$, all normalized intensities are reported as $0$.\n\nThe overall algorithm for each test case $(\\mathbf{F}, \\mathbf{D})$ is as follows:\n1.  Compute the eigenvalues $\\lambda_k$ and the corresponding orthonormal eigenvectors (columns of $\\mathbf{L}$) of the symmetric matrix $\\mathbf{F}$. This is done using a numerical eigensolver which, by convention, returns eigenvalues in ascending order and the corresponding eigenvectors.\n2.  Transform the dipole derivative matrix from the initial coordinate basis to the normal mode basis: $\\mathbf{D}' = \\mathbf{D} \\mathbf{L}$.\n3.  Calculate the unnormalized intensity $I_k$ for each mode $k=1, \\dots, 6$ by summing the squares of the elements in the $k^{th}$ column of $\\mathbf{D}'$.\n4.  Determine the activity of each mode: mode $k$ is active if $I_k > 10^{-8}$. This yields a list of six booleans.\n5.  Calculate the total intensity $I_{\\text{total}} = \\sum_k I_k$. If $I_{\\text{total}}$ is effectively zero, the normalized intensities are all $0$. Otherwise, compute $I_{k, \\text{norm}} = I_k / I_{\\text{total}}$ for each mode.\n6.  Round the normalized intensities to six decimal places and assemble the two lists (activity booleans and normalized intensities) into the final required output format.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vibrational analysis problem for the given test cases.\n    \"\"\"\n    \n    # Numerical threshold for infrared activity\n    EPSILON = 1e-8\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            # F1 matrix for Test Case 1\n            np.diag([4.0, 9.0, 16.0, 25.0, 36.0, 49.0]),\n            # D1 matrix for Test Case 1\n            np.array([\n                [0.0, 0.2, 0.1, 0.0, 0.05, -0.2],\n                [0.0, 0.0, -0.1, 0.0, 0.05, 0.2],\n                [0.0, 0.0, 0.0, 0.3, 0.05, 0.0]\n            ])\n        ),\n        (\n            # F2 matrix for Test Case 2\n            np.array([\n                [6.0, 0.2, 0.0, 0.0, 0.0, 0.0],\n                [0.2, 7.0, 0.1, 0.0, 0.0, 0.0],\n                [0.0, 0.1, 8.0, 0.3, 0.0, 0.0],\n                [0.0, 0.0, 0.3, 9.0, 0.2, 0.0],\n                [0.0, 0.0, 0.0, 0.2, 10.0, 0.1],\n                [0.0, 0.0, 0.0, 0.0, 0.1, 11.0]\n            ]),\n            # D2 matrix for Test Case 2\n            np.zeros((3, 6))\n        ),\n        (\n            # F3 matrix for Test Case 3\n            np.array([\n                [5.0, 0.4, 0.0, 0.0, 0.0, 0.0],\n                [0.4, 5.1, 0.2, 0.0, 0.0, 0.0],\n                [0.0, 0.2, 8.2, 0.3, 0.0, 0.0],\n                [0.0, 0.0, 0.3, 10.0, 0.1, 0.0],\n                [0.0, 0.0, 0.0, 0.1, 12.0, 0.25],\n                [0.0, 0.0, 0.0, 0.0, 0.25, 20.0]\n            ]),\n            # D3 matrix for Test Case 3\n            np.array([\n                [0.1, 0.0, 0.2, -0.1, 0.1, 0.0],\n                [0.0, 0.15, 0.0, 0.05, -0.05, 0.2],\n                [0.05, -0.05, 0.1, 0.0, 0.0, -0.1]\n            ])\n        )\n    ]\n\n    results = []\n    \n    for F_matrix, D_matrix in test_cases:\n        # Step 1 & 2: Diagonalize the Hessian F and get normal modes (eigenvectors)\n        # np.linalg.eigh returns eigenvalues in ascending order and corresponding\n        # eigenvectors as columns of the returned matrix L. This automatically\n        # satisfies the sorting requirement.\n        # F L = L Lambda, where Lambda is diagonal with eigenvalues.\n        # The columns of L are the normal modes in the q-basis.\n        eigenvalues, L_matrix = np.linalg.eigh(F_matrix)\n\n        # Step 3: Transform dipole derivatives to the normal mode basis.\n        # D' = D L\n        D_prime_matrix = D_matrix @ L_matrix\n        \n        # Step 4: Calculate unnormalized intensities.\n        # Intensity is proportional to the squared norm of the dipole derivative vector\n        # for each normal mode. This is the sum of squares of each column in D'.\n        intensities = np.sum(np.square(D_prime_matrix), axis=0)\n        \n        # Step 5: Determine infrared activity based on the threshold.\n        is_active = (intensities > EPSILON).tolist()\n        \n        # Step 6: Normalize the intensities.\n        total_intensity = np.sum(intensities)\n        \n        if total_intensity > EPSILON:\n            normalized_intensities = intensities / total_intensity\n        else:\n            # If total intensity is zero, all normalized intensities are zero.\n            normalized_intensities = np.zeros(6)\n            \n        # Round the normalized intensities to six decimal places.\n        rounded_intensities = np.round(normalized_intensities, 6).tolist()\n        \n        # Assemble the result for the current test case.\n        results.append([is_active, rounded_intensities])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists is a valid Python literal.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}