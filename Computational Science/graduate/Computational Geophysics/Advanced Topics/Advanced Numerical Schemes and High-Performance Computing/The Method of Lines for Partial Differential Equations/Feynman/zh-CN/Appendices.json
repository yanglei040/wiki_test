{
    "hands_on_practices": [
        {
            "introduction": "线方法（Method of Lines）的精度在很大程度上取决于其空间离散算子的构建。本练习将带您从泰勒级数这一第一性原理出发，推导一个高阶（四阶紧致）有限差分格式。掌握这一推导过程是设计和理解高级数值方法的基石，它揭示了离散格式的截断误差和精度阶数是如何确定的。",
            "id": "3617030",
            "problem": "在计算地球物理学中，诸如岩石圈中的热扩散等垂直一维输运过程，可以用形如 $\\partial u/\\partial t = \\kappa \\, \\partial^{2} u/\\partial x^{2}$ 的抛物线型偏微分方程来建模，其中 $u(x,t)$ 代表一个热力学场（例如温度），$x$ 是深度，$t$ 是时间，而 $\\kappa$ 是扩散系数。在线法 (MOL) 中，时间保持连续，而空间算子 $\\partial^{2}/\\partial x^{2}$ 被离散化。一种用于二阶导数的紧致格式通过求解一个耦合相邻二阶导数的三对角关系，来计算网格点上的 $\\partial^{2} u/\\partial x^{2}$。\n\n考虑一个间距为 $h$ 的均匀网格 $\\{x_{i}\\}$，并令 $u_{i} = u(x_{i})$ 为在网格点上采样的场。寻求一个 $\\partial^{2} u/\\partial x^{2}$ 的对称三点紧致离散化，其形式为 Pádé 形式\n$$\n\\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1} \\;=\\; \\frac{a}{h^{2}} \\left( u_{i-1} - 2 u_{i} + u_{i+1} \\right),\n$$\n其中 $u''_{i}$ 表示在 $x_{i}$ 处对 $\\partial^{2} u/\\partial x^{2}$ 的离散近似，而 $\\alpha$ 和 $a$ 是待确定的、与网格无关的常数。假设函数 $u(x)$ 在网格上足够光滑，以至于关于 $x_{i}$ 的泰勒展开是有效的。\n\n仅从 $u$ 及其导数在 $x_{i}$ 点的泰勒级数展开出发，通过匹配 $h$ 的同次幂，推导系数 $\\alpha$ 和 $a$ 的精确值，使得该格式对于光滑函数 $u(x)$ 具有四阶精度。然后，使用基于级数匹配的符号误差分析，验证其主截断误差为 $h^{4}$ 阶。\n\n以一个二元行向量 $(\\alpha, a)$ 的形式报告系数的精确值作为你的最终答案。无需四舍五入，这些系数没有单位。",
            "solution": "解决问题的第一步是严格验证问题陈述。\n\n### 第1步：提取已知信息\n问题提供了以下信息：\n1.  一个用于一维输运的抛物线型偏微分方程：$\\frac{\\partial u}{\\partial t} = \\kappa \\frac{\\partial^{2} u}{\\partial x^{2}}$。\n2.  在间距为 $h$ 的均匀网格 $\\{x_i\\}$ 上，用于二阶导数 $\\frac{\\partial^{2} u}{\\partial x^{2}}$ 的对称三点紧致离散格式：\n    $$\n    \\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1} \\;=\\; \\frac{a}{h^{2}} \\left( u_{i-1} - 2 u_{i} + u_{i+1} \\right)\n    $$\n3.  定义：$u_{i} = u(x_{i})$，$u''_{i}$ 是在 $x_{i}$ 处对 $\\frac{\\partial^{2} u}{\\partial x^{2}}$ 的离散近似。\n4.  待定常数：$\\alpha$ 和 $a$。\n5.  假设：函数 $u(x)$ 足够光滑，可以使用泰勒级数展开。\n6.  目标：推导 $\\alpha$ 和 $a$，使得格式达到四阶精度，即其截断误差为 $O(h^{4})$ 阶。此推导必须使用泰勒级数匹配。\n7.  验证：确认主截断误差为 $h^{4}$ 阶。\n\n### 第2步：使用提取的已知信息进行验证\n根据既定标准对问题进行验证。\n\n1.  **科学基础：** 问题陈述涉及扩散方程，这是物理学和地球物理学中的一个基本模型。所提出的方法，即一种紧致有限差分格式（Pádé 格式），是数值分析中求解偏微分方程的一种标准且有据可查的技术。其表述在科学上和数学上都是合理的。\n2.  **适定性：** 任务是通过强制要求特定的精度阶数来推导两个未知系数 $\\alpha$ 和 $a$。匹配泰勒级数系数的方法提供了一个确定性的过程，可以得出一个关于未知数的线性方程组。问题清晰明确，目标明确且可以实现。\n3.  **客观性：** 问题以精确的数学语言表述，没有任何主观或带有偏见的陈述。\n\n该问题未表现出验证协议中列出的任何缺陷（例如，科学上不合理、不完整、矛盾或模糊不清）。这是一个数值方法中的标准、正式问题。\n\n### 第3步：结论与行动\n该问题被判定为 **有效**。将提供一个合理的解答。\n\n### 求解推导\n\n给定的紧致格式将相邻点上的离散二阶导数 $u''_{i}$ 与函数值 $u_{i}$ 联系起来。为了确定系数 $\\alpha$ 和 $a$ 并分析其精度，我们将精确、光滑的函数 $u(x)$ 及其导数代入格式的方程中。代入后得到的残差定义了该关系的局部截断误差。\n\n该格式为：\n$$\n\\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1} = \\frac{a}{h^2} (u_{i-1} - 2u_i + u_{i+1})\n$$\n\n我们在中心点 $x_i$ 周围对所有项进行泰勒级数展开。令 $u^{(n)}_i$ 表示 $u(x)$ 在 $x = x_i$ 处的 $n$ 阶导数。\n\n首先，我们展开左侧（LHS）的各项，其中包含二阶导数 $u''(x)$。\n项 $u''_{i-1} = u''(x_i-h)$ 和 $u''_{i+1} = u''(x_i+h)$ 展开为：\n$$\nu''_{i+1} = u''_i + h u^{(3)}_i + \\frac{h^2}{2!} u^{(4)}_i + \\frac{h^3}{3!} u^{(5)}_i + \\frac{h^4}{4!} u^{(6)}_i + O(h^5)\n$$\n$$\nu''_{i-1} = u''_i - h u^{(3)}_i + \\frac{h^2}{2!} u^{(4)}_i - \\frac{h^3}{3!} u^{(5)}_i + \\frac{h^4}{4!} u^{(6)}_i + O(h^5)\n$$\n将这些代入左侧（LHS）得到：\n$$\n\\text{LHS} = \\alpha \\left( u''_i - h u^{(3)}_i + \\frac{h^2}{2} u^{(4)}_i - \\frac{h^3}{6} u^{(5)}_i + \\frac{h^4}{24} u^{(6)}_i + \\dots \\right) + u''_i + \\alpha \\left( u''_i + h u^{(3)}_i + \\frac{h^2}{2} u^{(4)}_i + \\frac{h^3}{6} u^{(5)}_i + \\frac{h^4}{24} u^{(6)}_i + \\dots \\right)\n$$\n合并各项，由于对称性， $h$ 的奇数次幂项相互抵消：\n$$\n\\text{LHS} = (1 + 2\\alpha) u''_i + \\alpha h^2 u^{(4)}_i + \\frac{\\alpha h^4}{12} u^{(6)}_i + O(h^6)\n$$\n\n接下来，我们展开右侧（RHS）。项 $u_{i-1} = u(x_i-h)$ 和 $u_{i+1} = u(x_i+h)$ 展开为：\n$$\nu_{i+1} = u_i + h u^{(1)}_i + \\frac{h^2}{2!} u^{(2)}_i + \\frac{h^3}{3!} u^{(3)}_i + \\frac{h^4}{4!} u^{(4)}_i + \\frac{h^5}{5!} u^{(5)}_i + \\frac{h^6}{6!} u^{(6)}_i + O(h^7)\n$$\n$$\nu_{i-1} = u_i - h u^{(1)}_i + \\frac{h^2}{2!} u^{(2)}_i - \\frac{h^3}{3!} u^{(3)}_i + \\frac{h^4}{4!} u^{(4)}_i - \\frac{h^5}{5!} u^{(5)}_i + \\frac{h^6}{6!} u^{(6)}_i + O(h^7)\n$$\n组合 $u_{i-1} - 2u_i + u_{i+1}$ 是标准的中心差分表达式 $\\delta_x^2 u_i$：\n$$\nu_{i-1} - 2u_i + u_{i+1} = 2 \\frac{h^2}{2!} u^{(2)}_i + 2 \\frac{h^4}{4!} u^{(4)}_i + 2 \\frac{h^6}{6!} u^{(6)}_i + O(h^8)\n$$\n$$\nu_{i-1} - 2u_i + u_{i+1} = h^2 u''_i + \\frac{h^4}{12} u^{(4)}_i + \\frac{h^6}{360} u^{(6)}_i + O(h^8)\n$$\n将此代入右侧（RHS）：\n$$\n\\text{RHS} = \\frac{a}{h^2} \\left( h^2 u''_i + \\frac{h^4}{12} u^{(4)}_i + \\frac{h^6}{360} u^{(6)}_i + O(h^8) \\right)\n$$\n$$\n\\text{RHS} = a u''_i + \\frac{a h^2}{12} u^{(4)}_i + \\frac{a h^4}{360} u^{(6)}_i + O(h^6)\n$$\n\n为了使格式精确，该关系式必须对精确解成立，直到某个特定的阶数。我们匹配左侧和右侧展开式中导数项的系数。\n$$\n(1 + 2\\alpha) u''_i + \\alpha h^2 u^{(4)}_i + \\frac{\\alpha h^4}{12} u^{(6)}_i + \\dots = a u''_i + \\frac{a h^2}{12} u^{(4)}_i + \\frac{a h^4}{360} u^{(6)}_i + \\dots\n$$\n整理各项得到残差恒等式：\n$$\n\\left( (1 + 2\\alpha) - a \\right) u''_i + h^2 \\left( \\alpha - \\frac{a}{12} \\right) u^{(4)}_i + h^4 \\left( \\frac{\\alpha}{12} - \\frac{a}{360} \\right) u^{(6)}_i + O(h^6) = 0\n$$\n为了使此恒等式对任何足够光滑的函数 $u(x)$ 都成立，不同导数项的系数必须为零。对于一个四阶精度的格式，$u''$ 的近似误差必须是 $O(h^4)$。这要求导致 $O(1)$ 和 $O(h^2)$ 误差的项必须消失。\n\n$u''_i$ 的系数给出了第一个条件。它代表了二阶导数近似本身的一致性。\n$$\n1 + 2\\alpha - a = 0 \\quad (1)\n$$\n$h^2 u^{(4)}_i$ 的系数给出了第二个条件。将其设为零可以消除 $O(h^2)$ 误差项，从而提高格式的精度。\n$$\n\\alpha - \\frac{a}{12} = 0 \\quad (2)\n$$\n我们现在求解这个关于 $\\alpha$ 和 $a$ 的二元线性方程组。从方程（2），我们得到：\n$$\n\\alpha = \\frac{a}{12}\n$$\n将这个 $\\alpha$ 的表达式代入方程（1）：\n$$\n1 + 2 \\left( \\frac{a}{12} \\right) - a = 0\n$$\n$$\n1 + \\frac{a}{6} - a = 0\n$$\n$$\n1 - \\frac{5a}{6} = 0\n$$\n$$\na = \\frac{6}{5}\n$$\n现在，我们使用关系式 $\\alpha = a/12$ 来求 $\\alpha$：\n$$\n\\alpha = \\frac{6/5}{12} = \\frac{6}{5 \\times 12} = \\frac{1}{10}\n$$\n因此，产生四阶精度格式的系数是 $\\alpha = \\frac{1}{10}$ 和 $a = \\frac{6}{5}$。\n\n### 截断误差的验证\n\n问题要求验证主截断误差为 $h^{4}$ 阶。使用推导出的系数，残差恒等式中乘以 $u''_i$ 和 $u^{(4)}_i$ 的项为零。第一个非零项是与 $h^4 u^{(6)}_i$ 相关联的项。残差，即该关系的局部截断误差 $T_i$，由这个主项给出：\n$$\nT_i = h^4 \\left( \\frac{\\alpha}{12} - \\frac{a}{360} \\right) u^{(6)}_i + O(h^6)\n$$\n我们将 $\\alpha = 1/10$ 和 $a = 6/5$ 的值代入系数中：\n$$\n\\frac{\\alpha}{12} - \\frac{a}{360} = \\frac{1/10}{12} - \\frac{6/5}{360} = \\frac{1}{120} - \\frac{6}{1800} = \\frac{1}{120} - \\frac{1}{300}\n$$\n为了减去这两个分数，我们找到一个公分母，即 $600$：\n$$\n\\frac{5}{600} - \\frac{2}{600} = \\frac{3}{600} = \\frac{1}{200}\n$$\n由于该系数非零，残差的主项为：\n$$\nT_i = \\frac{h^4}{200}u^{(6)}_i + O(h^6)\n$$\n这个残差会在计算出的近似值 $u''_{i,\\text{num}}$ 中引入一个误差。误差 $e_i = u''_i - u''_{i,\\text{num}}$ 满足方程 $\\alpha e_{i-1} + e_i + \\alpha e_{i+1} = T_i$。在主阶上，$(1+2\\alpha)e_i \\approx T_i$，这意味着误差 $e_i$ 与 $T_i$ 成正比。由于 $T_i$ 是 $O(h^4)$，二阶导数近似的误差也是 $O(h^4)$。这验证了该格式是四阶精度的。\n最终的系数是 $\\alpha = 1/10$ 和 $a=6/5$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix}\n\\frac{1}{10} & \\frac{6}{5}\n\\end{pmatrix}}\n$$"
        },
        {
            "introduction": "将理论应用于实践是计算科学的核心环节。本练习将指导您为地球物理学中常见的扩散方程构建一个完整的线方法求解器 ()。您将通过“虚拟单元”（ghost cells）这一经典技巧来处理实际问题中常见的诺伊曼（Neumann）边界条件，并通过“人造解”方法（method of manufactured solutions）来系统地验证您代码的正确性和精度。",
            "id": "3617046",
            "problem": "考虑一个定义在闭区间 $x \\in [0,L]$ 和时间 $t \\ge 0$ 上的一维标量场 $u(x,t)$ 的扩散偏微分方程 (PDE)：\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\frac{\\partial^2 u}{\\partial x^2} + s(t),\n$$\n其中 $\\kappa > 0$ 是一个常数扩散系数，$s(t)$ 是一个仅依赖于时间的给定源项。边界条件为诺伊曼 (Neumann) 型（通量给定）：\n$$\n\\frac{\\partial u}{\\partial x}(0,t) = \\alpha, \\quad \\frac{\\partial u}{\\partial x}(L,t) = \\beta,\n$$\n其中 $\\alpha$ 和 $\\beta$ 是给定的实常数。初始条件为 $u(x,0) = u_0(x)$。\n\n本任务要求您使用线方法 (MOL)，在均匀网格上通过二阶精度的中心有限差分格式对空间进行离散化，然后对得到的常微分方程 (ODE) 组进行时间积分。为施加诺伊曼边界条件，请使用虚拟单元，并推导二阶精度的修正边界模板，以替换边界节点上的标准离散拉普拉斯算子。\n\n从核心定义（中心差分和泰勒展开）出发，完成以下步骤：\n\n1. 通过要求空间导数的二阶精度中心有限差分近似在 $x=0$ 和 $x=L$ 处成立，推导由诺伊曼边界条件所蕴含的虚拟单元公式。将虚拟值 $u_{-1}(t)$ 和 $u_{N}(t)$ 表示为内部节点值和给定通量的函数。其中，均匀网格点为 $x_i = i h$，$i=0,1,\\dots,N-1$，间距为 $h = L/(N-1)$，虚拟索引 $-1$ 和 $N$ 分别指代位于域外 $x=-h$ 和 $x=L+h$ 处的虚拟节点。\n\n2. 使用标准的二阶中心离散拉普拉斯算子，\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_i = \\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2},\n$$\n将第1部分得到的虚拟单元公式代入拉普拉斯算子，推导在 $i=0$ 和 $i=N-1$ 处的修正离散边界模板。最终表达式必须仅用网格值 $u_0, u_1, \\dots, u_{N-1}$ 和边界通量 $\\alpha$、$\\beta$ 来表示。\n\n3. 使用第2部分推导的边界修正模板，构建半离散 ODE 系统\n$$\n\\frac{d}{dt}\\, \\mathbf{u}(t) = \\kappa\\, \\mathcal{D}_{xx}\\, \\mathbf{u}(t) + s(t)\\, \\mathbf{1},\n$$\n来实现线方法，其中 $\\mathbf{u}(t) = \\left[u_0(t), u_1(t), \\dots, u_{N-1}(t)\\right]^\\top$，$\\mathbf{1}$ 是全1向量。使用通用 ODE 求解器对此 ODE 系统进行时间积分。\n\n4. 为验证正确性并量化精度，请使用人造解方法。考虑精确解\n$$\nu_{\\text{exact}}(x,t) = C_0 + \\alpha\\, x + \\frac{\\beta - \\alpha}{2L}\\, x^2 + \\sin(\\omega t),\n$$\n其中常数 $C_0 = 0$，给定角频率 $\\omega > 0$。推导源项 $s(t)$，使得 $u_{\\text{exact}}(x,t)$ 满足具有扩散系数 $\\kappa$ 和诺伊曼边界条件 $\\alpha$、$\\beta$ 的 PDE。使用初始条件 $u(x,0) = u_{\\text{exact}}(x,0)$。\n\n5. 实现您的求解器，并计算在最终时间 $T$ 的离散均方根 (RMS) 误差：\n$$\nE_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(u_i(T) - u_{\\text{exact}}(x_i,T)\\right)^2}.\n$$\n\n使用以下参数集测试套件。每个测试用例指定 $(L,\\ \\kappa,\\ \\alpha,\\ \\beta,\\ N,\\ T,\\ \\omega)$：\n\n- 测试 A (通用情况): $(1.0,\\ 0.5,\\ 0.2,\\ -0.1,\\ 41,\\ 0.5,\\ 2.3)$。\n- 测试 B (网格加密，物理参数与 A 相同): $(1.0,\\ 0.5,\\ 0.2,\\ -0.1,\\ 81,\\ 0.5,\\ 2.3)$。\n- 测试 C (零通量对称): $(1.5,\\ 0.25,\\ 0.0,\\ 0.0,\\ 50,\\ 1.2,\\ 1.7)$。\n- 测试 D (短域，强反向通量): $(0.1,\\ 0.1,\\ 5.0,\\ -3.0,\\ 21,\\ 0.05,\\ 10.0)$。\n\n无需物理单位；所有量均为无量纲。若涉及角度，单位为弧度。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，`[result1,result2,result3,result4]`）。此处，每个结果是对应测试用例的浮点均方根误差 $E_{\\text{RMS}}$，顺序为 A、B、C、D。程序必须是一个完整的、可运行的实现，能够利用您推导的诺伊曼边界模板构建半离散算子，进行时间积分，评估人造解，并按指定格式输出四个均方根误差。",
            "solution": "我们从一个具有常数扩散系数 $\\kappa$ 和时变源项 $s(t)$ 的一维扩散偏微分方程 (PDE) 开始：\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\frac{\\partial^2 u}{\\partial x^2} + s(t),\n$$\n对于 $x \\in [0,L]$，$t \\ge 0$，其诺伊曼边界条件为 $\\frac{\\partial u}{\\partial x}(0,t)=\\alpha$ 和 $\\frac{\\partial u}{\\partial x}(L,t)=\\beta$。\n\n我们构建一个包含 $N$ 个点的均匀空间网格：$x_i = i h$，$i=0,1,\\dots,N-1$，其中网格间距为 $h = L/(N-1)$。线方法 (MOL) 要求我们仅在空间上进行离散化，从而得到一个关于时间的常微分方程 (ODE) 组。令 $u_i(t) \\approx u(x_i,t)$。\n\n对于内部点，二阶空间导数的二阶中心差分近似为\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_i = \\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2}, \\quad i=1,2,\\dots,N-2.\n$$\n为在诺伊曼条件下实现边界上的二阶精度，我们引入位于 $x=-h$ 和 $x=L+h$ 的虚拟点 $u_{-1}(t)$ 和 $u_{N}(t)$。然后，我们强制要求边界位置上的一阶导数的中心差分近似与给定的通量相匹配。\n\n具体来说，我们在 $x=0$ 处使用一阶导数的二阶中心近似：\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=0} \\approx \\frac{u_1 - u_{-1}}{2h} = \\alpha.\n$$\n求解可得虚拟值为\n$$\nu_{-1} = u_1 - 2 h \\alpha.\n$$\n类似地，在 $x=L$（位于 $i=N-1$ 处），二阶中心一阶导数为\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=L} \\approx \\frac{u_{N} - u_{N-2}}{2h} = \\beta,\n$$\n可得\n$$\nu_{N} = u_{N-2} + 2 h \\beta.\n$$\n\n现在，我们将这些虚拟值代入边界节点上的标准二阶离散拉普拉斯算子。在左边界（$i=0$），包含一个虚拟点的离散拉普拉斯算子为\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_0 = \\frac{u_{1} - 2 u_{0} + u_{-1}}{h^2}.\n$$\n使用 $u_{-1} = u_1 - 2 h \\alpha$，\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_0 = \\frac{u_{1} - 2 u_{0} + \\left(u_1 - 2 h \\alpha\\right)}{h^2}\n= \\frac{2 u_1 - 2 u_0}{h^2} - \\frac{2 \\alpha}{h}.\n$$\n这就是左边界的修正边界模板。在右边界（$i=N-1$），\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_{N-1} = \\frac{u_{N} - 2 u_{N-1} + u_{N-2}}{h^2}.\n$$\n使用 $u_{N} = u_{N-2} + 2 h \\beta$，\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_{N-1} = \\frac{\\left(u_{N-2} + 2 h \\beta\\right) - 2 u_{N-1} + u_{N-2}}{h^2}\n= \\frac{2 u_{N-2} - 2 u_{N-1}}{h^2} + \\frac{2 \\beta}{h}.\n$$\n这些边界公式与标准的内部模板一起，构成了通过虚拟单元与诺伊曼边界条件相容的二阶精度空间离散化。\n\n整合所有节点，半离散 MOL 系统为\n$$\n\\frac{d}{dt}\\, u_i(t) = \\kappa \\left(\\mathcal{D}_{xx} u\\right)_i + s(t), \\quad i = 0,1,\\dots,N-1,\n$$\n其中\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_i =\n\\begin{cases}\n\\dfrac{2 u_1 - 2 u_0}{h^2} - \\dfrac{2 \\alpha}{h},  i = 0 \\\\\n\\\\\n\\dfrac{u_{i+1} - 2 u_i + u_{i-1}}{h^2},  i = 1,2,\\dots,N-2 \\\\\n\\\\\n\\dfrac{2 u_{N-2} - 2 u_{N-1}}{h^2} + \\dfrac{2 \\beta}{h},  i = N-1\n\\end{cases}\n$$\n\n为了验证实现，我们采用人造解方法。考虑\n$$\nu_{\\text{exact}}(x,t) = C_0 + \\alpha\\, x + \\frac{\\beta - \\alpha}{2L}\\, x^2 + \\sin(\\omega t),\n$$\n其中 $C_0=0$ 且 $\\omega0$。边界导数为\n$$\n\\left.\\frac{\\partial u_{\\text{exact}}}{\\partial x}\\right|_{x=0} = \\alpha, \\quad\n\\left.\\frac{\\partial u_{\\text{exact}}}{\\partial x}\\right|_{x=L} = \\alpha + \\frac{\\beta - \\alpha}{L} L = \\beta,\n$$\n因此，根据构造，诺伊曼边界条件对所有 $t$ 均成立。时间导数和二阶空间导数分别为\n$$\n\\frac{\\partial u_{\\text{exact}}}{\\partial t} = \\omega \\cos(\\omega t), \\quad\n\\frac{\\partial^2 u_{\\text{exact}}}{\\partial x^2} = \\frac{\\beta - \\alpha}{L}.\n$$\n代入 PDE\n$$\n\\frac{\\partial u_{\\text{exact}}}{\\partial t} = \\kappa \\frac{\\partial^2 u_{\\text{exact}}}{\\partial x^2} + s(t)\n$$\n得到所需的源项\n$$\ns(t) = \\omega \\cos(\\omega t) - \\kappa \\frac{\\beta - \\alpha}{L}.\n$$\n初始条件为 $u(x,0) = u_{\\text{exact}}(x,0)$。\n\n对于每个测试用例，我们使用高精度 ODE 求解器将半离散 ODE 系统积分到时间 $T$。离散均方根 (RMS) 误差计算如下\n$$\nE_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(u_i(T) - u_{\\text{exact}}(x_i,T)\\right)^2}.\n$$\n\n测试套件包含以下参数集 $(L,\\ \\kappa,\\ \\alpha,\\ \\beta,\\ N,\\ T,\\ \\omega)$:\n\n- 测试 A: $(1.0,\\ 0.5,\\ 0.2,\\ -0.1,\\ 41,\\ 0.5,\\ 2.3)$,\n- 测试 B: $(1.0,\\ 0.5,\\ 0.2,\\ -0.1,\\ 81,\\ 0.5,\\ 2.3)$,\n- 测试 C: $(1.5,\\ 0.25,\\ 0.0,\\ 0.0,\\ 50,\\ 1.2,\\ 1.7)$,\n- 测试 D: $(0.1,\\ 0.1,\\ 5.0,\\ -3.0,\\ 21,\\ 0.05,\\ 10.0)$.\n\n由于空间离散化是二阶精度的，并且能精确重现二次多项式，而人造解在空间上是二次的，因此这些测试中的主要数值误差来源于时间积分和求解器的容差。通过使用严格的容差，均方根误差应该很小，并随着时间分辨率的提高或容差的收紧而减小。最终程序将组装修正后的边界模板，积分 ODE 系统，评估 $u_{\\text{exact}}$，为每个测试计算 $E_{\\text{RMS}}$，并按 $[e_A,e_B,e_C,e_D]$ 的列表格式打印出包含 A、B、C、D 四个均方根误差的单行结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef manufactured_solution(x, t, L, alpha, beta, omega):\n    # u_exact(x,t) = alpha x + ((beta - alpha)/(2L)) x^2 + sin(omega t)\n    return alpha * x + ((beta - alpha) / (2.0 * L)) * x**2 + np.sin(omega * t)\n\ndef source_term(t, kappa, L, alpha, beta, omega):\n    # s(t) = omega cos(omega t) - kappa * (beta - alpha)/L\n    return omega * np.cos(omega * t) - kappa * (beta - alpha) / L\n\ndef mol_rhs_builder(N, L, kappa, alpha, beta, omega):\n    # Build the RHS function f(t, u) = kappa * Dxx(u) + s(t) * 1\n    h = L / (N - 1)\n\n    def rhs(t, u):\n        du = np.empty_like(u)\n\n        # Interior points\n        # Use vectorized central differences where possible\n        # Boundary at i=0 with modified stencil via ghost cell:\n        # Dxx u_0 = (2 u_1 - 2 u_0)/h^2 - 2 alpha / h\n        du[0] = kappa * ((2.0 * u[1] - 2.0 * u[0]) / (h * h) - 2.0 * alpha / h)\n\n        # Interior nodes\n        if N  2:\n            du[1:-1] = kappa * (u[2:] - 2.0 * u[1:-1] + u[:-2]) / (h * h)\n        # Right boundary i=N-1:\n        # Dxx u_{N-1} = (2 u_{N-2} - 2 u_{N-1})/h^2 + 2 beta / h\n        du[-1] = kappa * ((2.0 * u[-2] - 2.0 * u[-1]) / (h * h) + 2.0 * beta / h)\n\n        # Add source term s(t) uniformly\n        s = source_term(t, kappa, L, alpha, beta, omega)\n        du += s\n\n        return du\n\n    return rhs\n\ndef run_case(L, kappa, alpha, beta, N, T, omega):\n    x = np.linspace(0.0, L, N)\n    u0 = manufactured_solution(x, 0.0, L, alpha, beta, omega)\n\n    rhs = mol_rhs_builder(N, L, kappa, alpha, beta, omega)\n\n    # Integrate in time with strict tolerances\n    sol = solve_ivp(\n        fun=rhs,\n        t_span=(0.0, T),\n        y0=u0,\n        method=\"RK45\",\n        rtol=1e-10,\n        atol=1e-12,\n        dense_output=False\n    )\n\n    uT = sol.y[:, -1]\n    u_exact_T = manufactured_solution(x, T, L, alpha, beta, omega)\n    err = np.sqrt(np.mean((uT - u_exact_T) ** 2))\n    return float(err)\n\ndef solve():\n    # Define the test cases (L, kappa, alpha, beta, N, T, omega)\n    test_cases = [\n        (1.0, 0.5, 0.2, -0.1, 41, 0.5, 2.3),   # Test A\n        (1.0, 0.5, 0.2, -0.1, 81, 0.5, 2.3),   # Test B\n        (1.5, 0.25, 0.0, 0.0, 50, 1.2, 1.7),   # Test C\n        (0.1, 0.1, 5.0, -3.0, 21, 0.05, 10.0), # Test D\n    ]\n\n    results = []\n    for case in test_cases:\n        L, kappa, alpha, beta, N, T, omega = case\n        err = run_case(L, kappa, alpha, beta, N, T, omega)\n        results.append(err)\n\n    # Print as a single line list of comma-separated floats\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "对于波动方程的模拟，数值稳定性和边界条件的处理至关重要。本练习将深入探讨两种不同的狄利克雷（Dirichlet）边界处理方法（强施加法与罚函数法）如何影响半离散系统的谱特性，并最终决定显式时间积分的稳定性（CFL条件）()。通过此练习，您将学会利用谱分析来评估和优化数值格式的性能，这是确保长时间、大规模地球物理模拟可靠性的关键技能。",
            "id": "3617036",
            "problem": "考虑闭区间 $[0,L]$ 上的一维声波方程 $u_{tt} = c^2 u_{xx}$，其边界条件为均匀狄利克雷边界条件 $u(0,t) = 0$ 和 $u(L,t) = 0$。未知量 $u(x,t)$ 的单位是声位移，$c$ 是波速，单位为米/秒，$x$ 的单位是米，$t$ 的单位是秒。在计算地球物理学中，一种常见的半离散方法是线方法：对空间导数进行离散化，以获得一个关于时间的有限维常微分方程组。显式时间积分器的稳定性由半离散空间谱通过 Courant-Friedrichs-Lewy (CFL) 条件来决定。\n\n您将研究空间离散化中的两种边界处理如何改变半离散谱，从而改变 CFL 条件，然后设计一个基于罚函数的边界封闭参数，以最大化空间算子的最小负特征值。\n\n空间网格和内部离散化：\n- 设 $N \\in \\mathbb{N}$ 为内部网格点的数量，并在 $(0,L)$ 上定义一个均匀网格，其间距为 $h = \\frac{L}{N+1}$，内部节点为 $x_i = i h$，其中 $i=1,\\dots,N$。\n- 对于内部点 $i=2,\\dots,N-1$，使用标准的二阶中心差分格式来近似 $u_{xx}(x_i,t)$：\n$$\nu_{xx}(x_i,t) \\approx \\frac{u_{i-1}(t) - 2 u_i(t) + u_{i+1}(t)}{h^2}.\n$$\n\n两种边界封闭：\n1) 鬼点强狄利克雷消除 (GP-SD)：\n- 通过消除边界贡献来强行施加边界条件。这产生了经典的离散拉普拉斯矩阵 $\\mathbf{A}_{\\mathrm{GP}} \\in \\mathbb{R}^{N \\times N}$，其元素为\n$$\n(\\mathbf{A}_{\\mathrm{GP}})_{i,i} = -\\frac{2}{h^2}, \\quad (\\mathbf{A}_{\\mathrm{GP}})_{i,i+1} = (\\mathbf{A}_{\\mathrm{GP}})_{i+1,i} = \\frac{1}{h^2}, \\quad i=1,\\dots,N-1,\n$$\n其他元素为零。这对应于对称三对角二阶差分算子，其中均匀狄利克雷边界条件通过消除边界值（可解释为一种带有强边界强制的“鬼点”方法）被隐式地施加。\n\n2) 同步近似项 (SAT) 罚函数边界封闭：\n- 带有对角范数的分部求和 (SBP) 算子提供了一个离散能量框架。对于均匀狄利克雷条件，一种实用的对称罚函数封闭方法是在半离散算子中加入一个与边界值成比例的罚项。在与上述网格兼容的纯内部公式中，可以得到一个对称的罚函数修正算子 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau) \\in \\mathbb{R}^{N \\times N}$，定义如下\n$$\n\\mathbf{A}_{\\mathrm{SAT}}(\\tau) = \\mathbf{A}_{\\mathrm{GP}} - \\frac{\\tau}{h^2}\\left(\\mathbf{e}_1 \\mathbf{e}_1^\\top + \\mathbf{e}_N \\mathbf{e}_N^\\top\\right),\n$$\n其中 $\\mathbf{e}_1, \\mathbf{e}_N \\in \\mathbb{R}^{N}$ 是第一个和最后一个标准基向量，$\\tau \\ge 0$ 是一个无量纲的罚参数。这个罚项在边界处弱施加 $u=0$，并且当重构成纯内部形式时，与使用对角范数的二阶导数算子的能量稳定 SBP-SAT 框架一致。当 $\\tau = 0$ 时，它退化为 GP-SD 算子。\n\nCFL 和半离散谱：\n- 线方法产生了半离散系统 $\\mathbf{u}''(t) = c^2 \\mathbf{A}\\, \\mathbf{u}(t)$，其中所选空间算子 $\\mathbf{A}$ 的谱包含在 $(-\\infty,0]$ 内。考虑标准的显式二阶中心差分时间积分器：\n$$\n\\mathbf{u}^{n+1} - 2 \\mathbf{u}^n + \\mathbf{u}^{n-1} = (c \\Delta t)^2 \\mathbf{A}\\, \\mathbf{u}^n,\n$$\n其中 $\\Delta t$ 是时间步长。对于 $\\mathbf{A}$ 的每个特征值 $\\lambda \\le 0$，如果 $(c \\Delta t)^2 \\lambda \\in [-4,0]$，则标量递推关系是稳定的。因此，最大允许时间步长为\n$$\n\\Delta t_{\\max} = \\frac{2}{c \\sqrt{-\\lambda_{\\min}}},\n$$\n其中 $\\lambda_{\\min}$ 是 $\\mathbf{A}$ 的最负特征值。无量纲 Courant 数定义为 $r = \\frac{c \\Delta t}{h}$，因此\n$$\nr_{\\max} = \\frac{2}{h \\sqrt{-\\lambda_{\\min}}}.\n$$\n\n设计目标：\n- 对于 SAT 罚函数算子 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$，在指定的 $\\tau$ 范围内进行搜索，以最大化最小负特征值（从下方最接近0的特征值），记为 $\\lambda_{\\mathrm{small}}(\\tau) = \\max\\{\\lambda \\in \\mathrm{spec}(\\mathbf{A}_{\\mathrm{SAT}}(\\tau))\\}$。报告最大化时的值 $\\tau^\\star$，并使用最负特征值 $\\lambda_{\\min}(\\tau^\\star)$ 计算相应的 CFL 限制的 Courant 数 $r_{\\max}$。\n\n任务：\n- 对于下面的每个测试用例，构造 $\\mathbf{A}_{\\mathrm{GP}}$ 和 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$，计算它们的谱，评估 GP-SD 的 $r_{\\max}$，并对 SAT 在 $\\tau$ 上进行设计优化，以最大化 $\\lambda_{\\mathrm{small}}(\\tau)$ 并计算在 $\\tau^\\star$ 时的 $r_{\\max}$。\n- Courant 数 $r_{\\max}$ 是无量纲的，必须以浮点数形式报告。罚参数 $\\tau^\\star$ 是无量纲的，必须以浮点数形式报告。特征值必须以浮点数形式报告。\n- 显式时间积分器的单位是秒；不要直接报告 $\\Delta t$。仅报告 Courant 数 $r_{\\max}$。\n\n测试套件：\n- 使用以下测试用例 $(L, c, N)$，其中 $L$ 的单位是米，$c$ 的单位是米/秒，$N$ 是无量纲的：\n    1. $(1.0, 1.5, 64)$\n    2. $(1.0, 0.8, 8)$\n    3. $(2.0, 2.0, 32)$\n    4. $(1.0, 1.2, 3)$\n- 对于 SAT 优化，在离散集合 $\\{0.0, 0.25, 0.5, 0.75, 1.0, 1.5, 2.0, 3.0, 4.0\\}$ 上搜索 $\\tau$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按以下顺序输出一个包含八个浮点数的嵌套列表：\n$\n\\big[\nr_{\\max}^{\\mathrm{GP}},\\; r_{\\max}^{\\mathrm{SAT}}(\\tau^\\star),\\; \\tau^\\star,\\; \\lambda_{\\min}^{\\mathrm{GP}},\\; \\lambda_{\\min}^{\\mathrm{SAT}}(\\tau^\\star),\\; \\lambda_{\\mathrm{small}}^{\\mathrm{GP}},\\; \\lambda_{\\mathrm{small}}^{\\mathrm{SAT}}(\\tau^\\star),\\; h\n\\big]\n$\n其中 $h$ 是网格间距，单位为米。将四个测试用例的列表聚合到一个外部列表中，例如 $[\\,[\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$。",
            "solution": "用户提供的问题是一个数值分析领域的良态问题练习，具体涉及线方法在一维声波方程中的应用。所有参数、定义和目标都陈述清晰、科学上合理且数学上一致。该问题是有效的，并存在唯一的、可计算的解。因此，我们将着手提供完整解法。\n\n该问题要求分析一维声波方程 $u_{tt} = c^2 u_{xx}$ 在区域 $x \\in [0,L]$ 上（具有均匀狄利克雷边界条件 $u(0,t)=u(L,t)=0$）的两种空间离散化方案。该分析在线方法框架内进行，首先对空间导数进行离散化，从而得到一个关于时间的常微分方程(ODE)组 $\\mathbf{u}''(t) = c^2 \\mathbf{A}\\, \\mathbf{u}(t)$。此处，$\\mathbf{u}(t) \\in \\mathbb{R}^N$ 是 $N$ 个内部网格点上近似解的向量，而 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ 是表示离散化的二阶空间导数 $u_{xx}$ 的矩阵。\n\n显式二阶中心差分时间积分方案的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定，该条件关联了时间步长 $\\Delta t$、波速 $c$、空间网格间距 $h$ 以及算子 $\\mathbf{A}$ 的谱。该条件要求对于 $\\mathbf{A}$ 的所有特征值 $\\lambda$，都有 $(c \\Delta t)^2 \\lambda \\in [-4,0]$。由于所考虑的算子是对称且半负定的，其特征值为非正数，即 $\\lambda \\le 0$。因此，稳定性条件受到最负特征值 $\\lambda_{\\min}$ 的限制，从而得出最大稳定时间步长为 $\\Delta t_{\\max} = \\frac{2}{c \\sqrt{-\\lambda_{\\min}}}$。相应的最大稳定 Courant 数为 $r_{\\max} = \\frac{c \\Delta t_{\\max}}{h} = \\frac{2}{h \\sqrt{-\\lambda_{\\min}}}$。\n\n空间网格是均匀的，有 $N$ 个内部点，定义的网格间距为 $h = \\frac{L}{N+1}$。\n\n我们分析矩阵 $\\mathbf{A}$ 的两种定义。\n\n1.  **鬼点强狄利克雷 (GP-SD) 封闭：** 此方法产生标准的对称三对角矩阵，记为 $\\mathbf{A}_{\\mathrm{GP}}$，它近似于二阶导数。其元素由下式给出：\n    $$\n    (\\mathbf{A}_{\\mathrm{GP}})_{i,j} = \\frac{1}{h^2} \\begin{cases} -2  \\text{if } i=j \\\\ 1  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases}\n    $$\n    该矩阵的特征值有解析解：\n    $$\n    \\lambda_k(\\mathbf{A}_{\\mathrm{GP}}) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{k \\pi}{2(N+1)}\\right), \\quad k=1, 2, \\ldots, N.\n    $$\n    最小（最不负）的特征值是 $\\lambda_{\\mathrm{small}}^{\\mathrm{GP}} = \\lambda_1$，最负的特征值是 $\\lambda_{\\min}^{\\mathrm{GP}} = \\lambda_N$。\n\n2.  **同步近似项 (SAT) 罚函数封闭：** 此方法通过添加弱施加边界条件的罚项来修改 GP-SD 算子。得到的算子 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$ 定义为：\n    $$\n    \\mathbf{A}_{\\mathrm{SAT}}(\\tau) = \\mathbf{A}_{\\mathrm{GP}} - \\frac{\\tau}{h^2}\\left(\\mathbf{e}_1 \\mathbf{e}_1^\\top + \\mathbf{e}_N \\mathbf{e}_N^\\top\\right),\n    $$\n    其中 $\\tau \\ge 0$ 是一个无量纲罚参数，$\\mathbf{e}_1, \\mathbf{e}_N$ 是第一个和最后一个标准基向量。此修改仅改变 $\\mathbf{A}_{\\mathrm{GP}}$ 的第一个和最后一个对角元素，使其变为 $(\\mathbf{A}_{\\mathrm{SAT}})_{1,1} = (\\mathbf{A}_{\\mathrm{SAT}})_{N,N} = -\\frac{2+\\tau}{h^2}$。\n\n主要目标是一项设计任务：对于每个测试用例，我们必须从指定的离散集合中找到 $\\tau$ 的值，记为 $\\tau^\\star$，该值能够最大化 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$ 的最小（最不负）特征值，我们将其记为 $\\lambda_{\\mathrm{small}}(\\tau) = \\max \\mathrm{spec}(\\mathbf{A}_{\\mathrm{SAT}}(\\tau))$。\n\n让我们分析罚项的影响。对于 $\\tau \\ge 0$，矩阵 $\\mathbf{P} = \\frac{\\tau}{h^2}(\\mathbf{e}_1\\mathbf{e}_1^\\top + \\mathbf{e}_N\\mathbf{e}_N^\\top)$ 是半正定的。算子为 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau) = \\mathbf{A}_{\\mathrm{GP}} - \\mathbf{P}$。根据关于对称矩阵和的特征值的 Weyl 不等式，$\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$ 的特征值（记为 $\\lambda_k(\\tau)$）受 $\\mathbf{A}_{\\mathrm{GP}}$ 的特征值（记为 $\\lambda_k(0)$）的界定：\n$$\n\\lambda_k(0) + \\lambda_{\\min}(-\\mathbf{P}) \\le \\lambda_k(\\tau) \\le \\lambda_k(0) + \\lambda_{\\max}(-\\mathbf{P}).\n$$\n$-\\mathbf{P}$ 的特征值为 $-\\frac{\\tau}{h^2}$（重数为2）和 0（重数为 $N-2$）。因此，$\\lambda_{\\min}(-\\mathbf{P}) = -\\frac{\\tau}{h^2}$ 且 $\\lambda_{\\max}(-\\mathbf{P}) = 0$。将此应用于最大特征值 $\\lambda_{\\mathrm{small}}$，我们发现：\n$$\n\\lambda_{\\mathrm{small}}^{\\mathrm{GP}} - \\frac{\\tau}{h^2} \\le \\lambda_{\\mathrm{small}}^{\\mathrm{SAT}}(\\tau) \\le \\lambda_{\\mathrm{small}}^{\\mathrm{GP}}.\n$$\n这个不等式表明，对于任何 $\\tau  0$，SAT 算子的最大特征值将小于或等于 GP-SD 算子的最大特征值。函数 $\\lambda_{\\mathrm{small}}(\\tau)$ 是非增的。因此，它在 $\\tau \\ge 0$ 上的最大值必然出现在 $\\tau=0$ 处。\n\n因此，对于所有测试用例，优化过程预期会得出 $\\tau^\\star = 0$。这意味着在最优的 $\\tau^\\star$ 处，SAT 算子与 GP-SD 算子相同，即 $\\mathbf{A}_{\\mathrm{SAT}}(0) = \\mathbf{A}_{\\mathrm{GP}}$，并且它们所有派生出的量都将相同。算法将执行指定的搜索以通过数值方式确认此结论。\n\n该解法通过迭代每个测试用例 $(L, c, N)$ 来实现。对于每个用例：\n1.  计算网格间距 $h = L/(N+1)$。\n2.  构造 $N \\times N$ 矩阵 $\\mathbf{A}_{\\mathrm{GP}}$。\n3.  使用数值线性代数程序计算其特征值。这些特征值的最小值和最大值分别给出 $\\lambda_{\\min}^{\\mathrm{GP}}$ 和 $\\lambda_{\\mathrm{small}}^{\\mathrm{GP}}$。\n4.  计算 $r_{\\max}^{\\mathrm{GP}} = 2 / (h \\sqrt{-\\lambda_{\\min}^{\\mathrm{GP}}})$。\n5.  迭代指定的 $\\tau$ 值集合。对于每个 $\\tau$：\n    a. 构造矩阵 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$。\n    b. 计算其特征值并找到 $\\lambda_{\\mathrm{small}}(\\tau)$。\n6.  将产生最大 $\\lambda_{\\mathrm{small}}(\\tau)$ 的 $\\tau$ 值确定为 $\\tau^\\star$。\n7.  使用为 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau^\\star)$ 计算的谱，确定 $\\lambda_{\\min}^{\\mathrm{SAT}}(\\tau^\\star)$ 和 $\\lambda_{\\mathrm{small}}^{\\mathrm{SAT}}(\\tau^\\star)$。\n8.  计算 $r_{\\max}^{\\mathrm{SAT}}(\\tau^\\star) = 2 / (h \\sqrt{-\\lambda_{\\min}^{\\mathrm{SAT}}(\\tau^\\star)})$。\n9.  收集并格式化八个所需的浮点数：$r_{\\max}^{\\mathrm{GP}}$、$r_{\\max}^{\\mathrm{SAT}}(\\tau^\\star)$、$\\tau^\\star$、$\\lambda_{\\min}^{\\mathrm{GP}}$、$\\lambda_{\\min}^{\\mathrm{SAT}}(\\tau^\\star)$、$\\lambda_{\\mathrm{small}}^{\\mathrm{GP}}$、$\\lambda_{\\mathrm{small}}^{\\mathrm{SAT}}(\\tau^\\star)$ 和 $h$。\n\n最终输出是所有测试用例结果的聚合，形式为一个列表的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite, analyzing GP-SD and SAT\n    discretizations for the 1D wave equation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (L, c, N)\n    test_cases = [\n        (1.0, 1.5, 64),\n        (1.0, 0.8, 8),\n        (2.0, 2.0, 32),\n        (1.0, 1.2, 3),\n    ]\n\n    # Set of penalty parameters to search over\n    tau_search_set = [0.0, 0.25, 0.5, 0.75, 1.0, 1.5, 2.0, 3.0, 4.0]\n\n    all_results = []\n    \n    for case in test_cases:\n        L, c, N = case\n        h = L / (N + 1)\n        h_sq = h**2\n\n        # 1. GP-SD Analysis\n        # Construct the A_GP matrix\n        main_diag_gp = -2.0 / h_sq * np.ones(N)\n        off_diag_gp = 1.0 / h_sq * np.ones(N - 1)\n        A_gp = np.diag(main_diag_gp) + np.diag(off_diag_gp, k=1) + np.diag(off_diag_gp, k=-1)\n\n        # Compute eigenvalues for the symmetric matrix A_GP\n        eigvals_gp = np.linalg.eigvalsh(A_gp)\n        # All eigenvalues are negative or zero, so min() is most negative\n        lambda_min_gp = np.min(eigvals_gp)\n        # max() is least negative (closest to zero)\n        lambda_small_gp = np.max(eigvals_gp)\n        \n        # Calculate r_max for GP-SD\n        if lambda_min_gp  0:\n            r_max_gp = 2.0 / (h * np.sqrt(-lambda_min_gp))\n        else: # Should not happen for N  0\n            r_max_gp = np.inf\n            \n        # 2. SAT Optimization\n        best_tau = -1.0\n        max_lambda_small = -np.inf\n        \n        # Variables to store the results for the optimal tau_star\n        lambda_min_sat_star = 0.0\n        lambda_small_sat_star = 0.0\n        r_max_sat_star = 0.0\n\n        for tau in tau_search_set:\n            # Construct the A_SAT(tau) matrix\n            A_sat = np.copy(A_gp)\n            penalty = tau / h_sq\n            A_sat[0, 0] -= penalty\n            A_sat[N - 1, N - 1] -= penalty\n            \n            # Compute eigenvalues for the symmetric matrix A_SAT\n            eigvals_sat = np.linalg.eigvalsh(A_sat)\n            current_lambda_small = np.max(eigvals_sat)\n            \n            # Check if this tau maximizes lambda_small\n            if current_lambda_small  max_lambda_small:\n                max_lambda_small = current_lambda_small\n                best_tau = tau\n                \n                # Store the results for this new best tau\n                lambda_min_sat_star = np.min(eigvals_sat)\n                lambda_small_sat_star = max_lambda_small\n                if lambda_min_sat_star  0:\n                    r_max_sat_star = 2.0 / (h * np.sqrt(-lambda_min_sat_star))\n                else: # Should not happen\n                    r_max_sat_star = np.inf\n        \n        # Assemble the 8 required values for this test case\n        case_results = [\n            r_max_gp,\n            r_max_sat_star,\n            best_tau,\n            lambda_min_gp,\n            lambda_min_sat_star,\n            lambda_small_gp,\n            lambda_small_sat_star,\n            h,\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # Construct the output string manually to match the required format\n    # e.g., [[val1,val2,...],[val1,val2,...]] without extra spaces.\n    outer_list_str = ','.join([f\"[{','.join(map(str, inner_list))}]\" for inner_list in all_results])\n    print(f\"[{outer_list_str}]\")\n\nsolve()\n```"
        }
    ]
}