{
    "hands_on_practices": [
        {
            "introduction": "理论分析是理解和控制数值误差的基石。本练习将引导您使用修正方程法，这是一种强大的技术，它能揭示数值格式实际求解的“有效”偏微分方程。通过分析该有效方程中的截断误差项，您将学会如何精确地设计人工粘性项，以抵消由中心差分引起的、导致色散的主导误差项 。",
            "id": "3581918",
            "problem": "考虑带有人工粘性的一维线性常系数平流-扩散模型，\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\nu\\,\\partial_{x}^{2p} u,\n$$\n该模型定义在间距为 $\\,\\Delta x\\,$ 的均匀空间网格上。你将使用前向欧拉时间步进和空间二阶中心差分来构造一个全离散格式。为了直接针对由平流导数的中心差分近似引起的主阶色散误差，将注意力限制在 $\\,p=1\\,$ 的情况，此时人工粘性算子是标准的拉普拉斯算子。离散更新方程为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} \\;+\\; a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x}\n\\;=\\; \\nu\\,\\frac{u_{j+1}^{n} - 2\\,u_{j}^{n} + u_{j-1}^{n}}{\\Delta x^{2}}.\n$$\n使用修正方程法，推导该格式截断误差中出现的主阶奇数阶导数项，并确定人工粘性系数 $\\,\\nu\\,$ 的值（作为 $\\,\\Delta x\\,$ 和 $\\,a\\,$ 的函数），该值可以抵消修正方程中的主阶奇数阶导数项。假设基于平流速度大小的库朗数为常数 $\\,C \\equiv |a|\\,\\Delta t/\\Delta x = 1\\,$，因此 $\\,\\Delta t = \\Delta x/|a|\\,$。陈述进行泰勒展开所需的光滑性假设。用国际单位制 (SI) 单位 $\\text{m}^{2}\\,\\text{s}^{-1}$ 表示 $\\,\\nu\\,$ 的最终结果。不需要进行数值舍入；请提供一个闭式解析表达式。",
            "solution": "题目要求我们使用修正方程法分析一维平流-扩散方程的全离散格式。目标是确定人工粘性系数 $\\nu$ 的值，以抵消主阶色散误差。我们假设解 $u(x,t)$ 足够光滑，即它拥有本分析中泰勒级数展开所需的阶数内的连续偏导数。\n\n给定的全离散格式为：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = \\nu\\,\\frac{u_{j+1}^{n} - 2\\,u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}}\n$$\n为了推导修正方程，我们对每一项在点 $(x_j, t_n)$ 附近进行泰勒级数展开，其中 $u(x_j, t_n)$ 表示为 $u$，其偏导数用下标表示（例如，$u_t = \\partial u / \\partial t$, $u_x = \\partial u / \\partial x$）。\n\n前向欧拉时间步进项展开为：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{1}{\\Delta t} \\left( u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\frac{(\\Delta t)^3}{6} u_{ttt} + \\dots - u \\right) = u_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{(\\Delta t)^2}{6} u_{ttt} + O((\\Delta t)^3)\n$$\n用于平流项的二阶中心差分展开为：\n\\begin{align*}\nu_{j+1}^{n} = u + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} + \\frac{(\\Delta x)^4}{24} u_{xxxx} + \\dots \\\\\nu_{j-1}^{n} = u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\frac{(\\Delta x)^4}{24} u_{xxxx} - \\dots\n\\end{align*}\n两式相减得到：\n$$\n\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = \\frac{1}{2\\,\\Delta x} \\left( 2\\Delta x u_x + \\frac{2(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^5) \\right) = u_x + \\frac{(\\Delta x)^2}{6} u_{xxx} + O((\\Delta x)^4)\n$$\n用于扩散项的二阶中心差分展开为：\n$$\n\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^2} = \\frac{1}{(\\Delta x)^2} \\left( (\\Delta x)^2 u_{xx} + \\frac{2(\\Delta x)^4}{24} u_{xxxx} + O((\\Delta x)^6) \\right) = u_{xx} + \\frac{(\\Delta x)^2}{12} u_{xxxx} + O((\\Delta x)^4)\n$$\n题目指明了“人工粘性”，这意味着该格式近似于纯平流方程 $u_t + a u_x = 0$。截断误差 $\\tau$ 是将目标偏微分方程的精确解代入有限差分方程后得到的残差。\n$$\n\\tau = \\left(u_t + \\frac{\\Delta t}{2}u_{tt} + \\dots\\right) + a\\left(u_x + \\frac{(\\Delta x)^2}{6}u_{xxx} + \\dots\\right) - \\nu\\left(u_{xx} + \\frac{(\\Delta x)^2}{12}u_{xxxx} + \\dots\\right) - (u_t + a u_x)\n$$\n$$\n\\tau = \\frac{\\Delta t}{2}u_{tt} - \\nu u_{xx} + a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\text{higher-order terms}\n$$\n因此，截断误差中出现的主阶奇数阶导数项为 $a \\frac{(\\Delta x)^2}{6} u_{xxx}$。该项导致了数值色散。\n\n修正方程是该数值格式实际上求解的偏微分方程。我们通过将离散方程（也就是其展开式）设为零来得到它：\n$$\n\\left( u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots \\right) + a \\left( u_x + \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots \\right) - \\nu \\left( u_{xx} + \\frac{(\\Delta x)^2}{12} u_{xxxx} + \\dots \\right) = 0\n$$\n整理后得到：\n$$\nu_t + a u_x = \\nu u_{xx} - \\frac{\\Delta t}{2} u_{tt} - a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\text{higher-order terms}\n$$\n为继续推导，我们使用修正方程本身将时间导数用空间导数表示。就主阶项而言，$u_t \\approx -a u_x + \\nu u_{xx}$。对时间求导得到：\n$$\nu_{tt} = \\frac{\\partial}{\\partial t} u_t \\approx \\frac{\\partial}{\\partial t} (-a u_x + \\nu u_{xx}) = -a u_{xt} + \\nu u_{xxt}\n$$\n现在我们求混合导数：\n$$\nu_{xt} = \\frac{\\partial}{\\partial x} u_t \\approx \\frac{\\partial}{\\partial x} (-a u_x + \\nu u_{xx}) = -a u_{xx} + \\nu u_{xxx}\n$$\n因此：\n$$\nu_{tt} \\approx -a (-a u_{xx} + \\nu u_{xxx}) + \\nu \\frac{\\partial}{\\partial x}(-a u_{xx} + \\nu u_{xxx}) = a^2 u_{xx} - 2a\\nu u_{xxx} + O((\\Delta x)^2)\n$$\n将这个 $u_{tt}$ 的表达式代回到修正方程中：\n$$\nu_t + a u_x = \\nu u_{xx} - \\frac{\\Delta t}{2} \\left( a^2 u_{xx} - 2a\\nu u_{xxx} + \\dots \\right) - a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots\n$$\n我们根据空间导数的阶数合并项：\n$$\nu_t + a u_x = \\left(\\nu - \\frac{a^2 \\Delta t}{2}\\right) u_{xx} + \\left(a\\nu \\Delta t - a \\frac{(\\Delta x)^2}{6}\\right) u_{xxx} + \\dots\n$$\n修正方程中的主阶奇数阶导数项是 $\\left(a\\nu \\Delta t - a \\frac{(\\Delta x)^2}{6}\\right) u_{xxx}$。为了抵消这个色散项，我们必须将其系数设为零：\n$$\na\\nu \\Delta t - a \\frac{(\\Delta x)^2}{6} = 0\n$$\n假设 $a \\neq 0$，我们可以两边同除以 $a$：\n$$\n\\nu \\Delta t = \\frac{(\\Delta x)^2}{6} \\implies \\nu = \\frac{(\\Delta x)^2}{6 \\Delta t}\n$$\n题目指明库朗数为常数 $C = |a|\\frac{\\Delta t}{\\Delta x} = 1$。由此，我们得到 $\\Delta t$ 的表达式：\n$$\n\\Delta t = \\frac{\\Delta x}{|a|}\n$$\n将此式代入我们关于 $\\nu$ 的方程中：\n$$\n\\nu = \\frac{(\\Delta x)^2}{6 \\left( \\frac{\\Delta x}{|a|} \\right)} = \\frac{|a| (\\Delta x)^2}{6 \\Delta x} = \\frac{|a| \\Delta x}{6}\n$$\n$a$ 的单位是 $\\text{m}\\,\\text{s}^{-1}$，$\\Delta x$ 的单位是 $\\text{m}$，所以 $\\nu$ 的单位是 $(\\text{m}\\,\\text{s}^{-1})\\cdot\\text{m} = \\text{m}^2\\,\\text{s}^{-1}$，这与扩散系数的单位一致。\n这个 $\\nu$ 值表示当使用前向欧拉时间步进且 $C=1$ 时，为抵消中心差分平流项产生的主阶数值色散所需的人工粘性的大小。",
            "answer": "$$\\boxed{\\frac{|a|\\Delta x}{6}}$$"
        },
        {
            "introduction": "在掌握了修正方程的局部分析后，我们转向傅里叶分析，以便在整个波数谱上评估数值格式的性能。本练习要求您通过计算和绘制相位与振幅误差，来量化比较经典高阶格式与优化的低色散格式 。这种全谱分析对于设计能够精确模拟宽带波场的地球物理计算方法至关重要。",
            "id": "3581900",
            "problem": "考虑一维线性平流方程 $u_t + c\\,u_x = 0$，其中速度 $c  0$ 为常数，定义在间距为 $\\Delta x$ 的均匀网格上，并采用周期性边界条件。令库朗数定义为 $\\nu = c\\,\\Delta t/\\Delta x$。您将比较两种用于一阶导数 $u_x$ 的空间离散化方法，它们均与相同的显式时间积分器耦合。您需要量化它们在无量纲波数区间 $k\\Delta x \\in [0,\\pi]$ 上的数值色散（相位误差）和数值耗散（幅值误差）。所有角度必须以弧度表示。\n\n分析应基于以下原理和经过充分检验的公式：\n\n- 傅里叶模态分析：对于一个傅里叶模 $u_j^n \\propto \\exp(i j \\xi)$（其中 $\\xi = k\\Delta x \\in [0,\\pi]$），任何应用于离散化空间算子的线性时间步进格式都会产生一个每步复数放大因子 $G(\\xi)$，使得 $u^{n+1} = G(\\xi) u^n$。\n- 对于精确偏微分方程，每步精确放大因子为 $\\exp(-i \\nu \\xi)$。\n- 对于采用对称模板对 $u_x$ 进行有限差分近似的半离散线方法，其离散空间傅里叶符号为 $i\\,\\kappa(\\xi)/\\Delta x$，其中 $\\kappa(\\xi)$ 是模板的修正波数。对于一个权重为 $\\{b_m\\}_{m=1}^M$ 的反对称 (2M+1) 点中心模板，其定义为\n$$\n(D u)_j \\approx \\frac{1}{\\Delta x}\\sum_{m=1}^M b_m\\left(u_{j+m} - u_{j-m}\\right),\n$$\n修正波数值为\n$$\n\\kappa(\\xi) = 2\\sum_{m=1}^M b_m \\sin(m\\xi).\n$$\n- 对于显式经典四阶 Runge-Kutta (RK4) 方法，其稳定函数为\n$$\nR(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24},\n$$\n完全离散格式的数值放大因子为 $G(\\xi) = R\\!\\left(-i\\,\\nu\\,\\kappa(\\xi)\\right)$。\n\n您将研究两种七点模板（$M=3$），两者都与相同的 RK4 时间积分器在 $\\nu = 0.5$ 的条件下耦合：\n\n- 经典六阶中心差分（在7点对称模板上）：\n$$\nb_1 = \\frac{45}{60} = 0.75,\\quad b_2 = -\\frac{9}{60} = -0.15,\\quad b_3 = \\frac{1}{60}.\n$$\n- 一种优化的低色散、非紧致、显式7点模板，其系数旨在宽频带上减少色散误差（在色散关系保持格式的文献中是一个著名的选择）：\n$$\nb_1 = 0.770882380518225,\\quad b_2 = -0.166705904414580,\\quad b_3 = 0.020843142770311.\n$$\n\n对于每种模板，将每步相位误差和幅值误差定义为 $\\xi$ 的函数，如下所示\n$$\ne_{\\mathrm{phase}}(\\xi) = \\operatorname{wrap}_{(-\\pi,\\pi]}\\!\\left(\\arg(G(\\xi)) + \\nu\\,\\xi\\right),\n\\qquad\ne_{\\mathrm{amp}}(\\xi) = \\left|\\;|G(\\xi)| - 1\\;\\right|,\n$$\n其中 $\\arg(\\cdot)$ 是主辐角，而 $\\operatorname{wrap}_{(-\\pi,\\pi]}(\\theta)$ 通过加或减 $2\\pi$ 的整数倍将任意实数角度 $\\theta$ 包裹到 $(-\\pi,\\pi]$ 区间内。\n\n定义一个每步组合误差大小\n$$\nE(\\xi) = \\sqrt{e_{\\mathrm{phase}}(\\xi)^2 + e_{\\mathrm{amp}}(\\xi)^2}.\n$$\n\n您的程序必须在 $\\nu = 0.5$ 和 $\\xi \\in [0,\\pi]$（包含端点）上一个包含 $N = 10001$ 个点的均匀网格上，计算以下量：\n\n- 测试用例1（浮点数）：使得优化模板的组合误差严格小于经典模板的最小 $\\xi^\\star \\in (0,\\pi]$，即满足 $E_{\\mathrm{opt}}(\\xi)  E_{\\mathrm{classical}}(\\xi)$ 的最小采样 $\\xi$。如果网格上不存在这样的 $\\xi$，则返回 $\\mathrm{NaN}$。\n- 测试用例2（布尔值）：在 $\\xi = \\pi/2$ 处，优化模板的绝对相位误差是否严格小于经典模板的绝对相位误差？如果 $\\left|e_{\\mathrm{phase,opt}}(\\pi/2)\\right|  \\left|e_{\\mathrm{phase,classic}}(\\pi/2)\\right|$，则返回 $True$，否则返回 $False$。\n- 测试用例3（布尔值）：在 $\\xi = 0$ 处，两种模板的幅值误差是否都低于 $10^{-12}$ 的容差？如果 $\\left|e_{\\mathrm{amp,opt}}(0)\\right| \\le 10^{-12}$ 且 $\\left|e_{\\mathrm{amp,classic}}(0)\\right| \\le 10^{-12}$，则返回 $True$，否则返回 $False$。\n- 测试用例4（浮点数）：经典模板在 $\\xi \\in [0,\\pi]$ 上的最大绝对幅值误差，即 $\\max_{\\xi} \\left|e_{\\mathrm{amp,classic}}(\\xi)\\right|$。\n- 测试用例5（浮点数）：优化模板在 $\\xi \\in [0,\\pi]$ 上的最大绝对幅值误差，即 $\\max_{\\xi} \\left|e_{\\mathrm{amp,opt}}(\\xi)\\right|$。\n\n角度量必须以弧度为单位。所有浮点数输出必须四舍五入到六位小数。\n\n您的程序应生成单行输出，其中包含五个测试用例的结果，结果为逗号分隔的列表，用方括号括起来，并按上述顺序排列：\n$[\\xi^\\star, \\text{bool\\_at\\_}\\pi/2, \\text{bool\\_at\\_}0, \\max e_{\\mathrm{amp,classic}}, \\max e_{\\mathrm{amp,opt}}]$。",
            "solution": "该问题要求对一维线性平流方程的两种数值格式进行比较分析：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x,t)$ 是输运的量，$c  0$ 是恒定的波速。分析在傅里叶域中进行，针对间距为 $\\Delta x$ 的均匀空间网格和恒定的时间步长 $\\Delta t$。关键参数是库朗数，定义为 $\\nu = c\\Delta t / \\Delta x$。\n\n我们分析格式在单个傅里叶模态 $u_j^n = \\hat{u}^n(k) e^{i(k x_j)} = \\hat{u}^n(\\xi) e^{ij\\xi}$ 上的行为，其中 $x_j = j\\Delta x$，$\\xi = k\\Delta x$ 是无量纲波数。精确解在一个时间步长 $\\Delta t$ 内对此模态的演化如下：\n$$\nu(x, t+\\Delta t) = u(x-c\\Delta t, t) \\implies \\hat{u}^{n+1} = \\hat{u}^n e^{-ikc\\Delta t} = \\hat{u}^n e^{-i\\nu\\xi}\n$$\n项 $G_{\\text{exact}}(\\xi) = e^{-i\\nu\\xi}$ 是精确放大因子。其幅值为 $|G_{\\text{exact}}(\\xi)| = 1$，表示没有幅值变化，其相位为 $\\phi_{\\text{exact}}(\\xi) = -\\nu\\xi$。\n\n数值格式通过 $u_j^{n+1} = \\mathcal{L}(u^n)_j$ 来近似此演化，在傅里叶域中变为 $\\hat{u}^{n+1} = G(\\xi) \\hat{u}^n$。复数量 $G(\\xi)$ 是完全离散格式的数值放大因子。\n\n线方法首先离散化空间导数 $\\frac{\\partial u}{\\partial x}$，从而得到一个常微分方程组（ODEs）。对于一个通用的 (2M+1) 点反对称中心差分格式，其形式如下：\n$$\n\\frac{du_j}{dt} = -c (D u)_j = -\\frac{c}{\\Delta x} \\sum_{m=1}^M b_m(u_{j+m} - u_{j-m})\n$$\n將此算子应用于傅里叶模态 $e^{ij\\xi}$，得到：\n$$\nD e^{ij\\xi} = \\frac{1}{\\Delta x} \\sum_{m=1}^M b_m(e^{i(j+m)\\xi} - e^{i(j-m)\\xi}) = \\frac{e^{ij\\xi}}{\\Delta x} \\sum_{m=1}^M b_m(e^{im\\xi} - e^{-im\\xi}) = \\frac{e^{ij\\xi}}{\\Delta x} \\left( 2i \\sum_{m=1}^M b_m \\sin(m\\xi) \\right)\n$$\n这将空间算子的傅里叶符号定义为 $i\\kappa(\\xi)/\\Delta x$，其中 $\\kappa(\\xi)$ 是修正波数：\n$$\n\\kappa(\\xi) = 2\\sum_{m=1}^M b_m \\sin(m\\xi)\n$$\n因此，傅里叶空间中的半离散常微分方程组为 $\\frac{d\\hat{u}}{dt} = -c \\frac{i\\kappa(\\xi)}{\\Delta x} \\hat{u}$。\n\n对于所考虑的两种七点模板（$M=3$）：\n- **经典六阶：** 系数为 $b_1 = 45/60$, $b_2 = -9/60$, $b_3 = 1/60$，其修正波数为：\n$$\n\\kappa_{\\text{classic}}(\\xi) = 2\\left(\\frac{45}{60}\\sin(\\xi) - \\frac{9}{60}\\sin(2\\xi) + \\frac{1}{60}\\sin(3\\xi)\\right)\n$$\n- **优化低色散：** 系数为 $b_1 = 0.770882380518225$, $b_2 = -0.166705904414580$, $b_3 = 0.020843142770311$，其修正波数为：\n$$\n\\kappa_{\\text{opt}}(\\xi) = 2(b_1\\sin(\\xi) + b_2\\sin(2\\xi) + b_3\\sin(3\\xi))\n$$\n\n半离散常微分方程组 $\\frac{d\\hat{u}}{dt} = \\lambda \\hat{u}$（其中 $\\lambda = -ic\\kappa(\\xi)/\\Delta x$）使用显式四阶 Runge-Kutta (RK4) 方法进行时间上的向前积分。对于 $y'=\\lambda y$，单个 RK4 步长的放大因子由其稳定函数 $R(z)$ 给出，其中 $z = \\lambda \\Delta t$。\n$$\nz = \\left(-i\\frac{c\\kappa(\\xi)}{\\Delta x}\\right) \\Delta t = -i \\left(\\frac{c\\Delta t}{\\Delta x}\\right) \\kappa(\\xi) = -i\\nu\\kappa(\\xi)\n$$\n因此，完全离散格式的数值放大因子为 $G(\\xi) = R(-i\\nu\\kappa(\\xi))$，其中 $R(z)$ 是 RK4 多项式：\n$$\nR(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}\n$$\n\n通过将数值放大因子 $G(\\xi)$ 与精确放大因子 $G_{\\text{exact}}(\\xi)$进行比较来量化数值误差。\n- **相位误差** 衡量相速度的差异。数值相位是 $\\phi_{\\text{num}}(\\xi) = \\arg(G(\\xi))$。每步相位误差是数值相位与精确相位之差，并包裹到区间 $(-\\pi, \\pi]$ 内：\n$$\ne_{\\text{phase}}(\\xi) = \\operatorname{wrap}_{(-\\pi,\\pi]}\\!\\left(\\phi_{\\text{num}}(\\xi) - \\phi_{\\text{exact}}(\\xi)\\right) = \\operatorname{wrap}_{(-\\pi,\\pi]}\\!\\left(\\arg(G(\\xi)) + \\nu\\xi\\right)\n$$\n非零相位误差会导致数值色散，即不同波数的波以相对于彼此不正确的速度传播。\n- **幅值误差** 衡量每个步长中模态幅值的变化。数值幅值是 $|G(\\xi)|$。每步幅值误差是：\n$$\ne_{\\text{amp}}(\\xi) = \\left|\\;|G(\\xi)| - 1\\;\\right|\n$$\n非零幅值误差对应于数值耗散（如果 $|G(\\xi)|  1$）或不稳定性（如果 $|G(\\xi)|  1$）。对于稳定格式，此误差表示不希望出现的阻尼。\n- **组合误差** 为总误差大小提供了一个单一的度量标准：\n$$\nE(\\xi) = \\sqrt{e_{\\mathrm{phase}}(\\xi)^2 + e_{\\mathrm{amp}}(\\xi)^2}\n$$\n\n通过执行以下步骤来获得给定库朗数 $\\nu=0.5$ 的解：\n1.  在 $[0, \\pi]$ 上定义一个由 $N=10001$ 个均匀间隔的波数 $\\xi_j$ 组成的离散网格。\n2.  对每种模板（经典和优化），执行以下操作：\n    a.  使用各自的系数计算修正波数向量 $\\kappa(\\xi_j)$。\n    b.  计算复数向量 $z(\\xi_j) = -i\\nu\\kappa(\\xi_j)$。\n    c.  评估 RK4 稳定多项式 $G(\\xi_j) = R(z(\\xi_j))$。\n    d.  计算相位误差向量 $e_{\\text{phase}}(\\xi_j)$，确保角度被正确包裹到 $(-\\pi, \\pi]$ 内。\n    e.  计算幅值误差向量 $e_{\\text{amp}}(\\xi_j)$。\n    f.  计算组合误差向量 $E(\\xi_j)$。\n3.  使用两种模板计算出的误差向量，回答以下五个测试问题：\n    - **测试1**：找到第一个满足 $E_{\\text{opt}}(\\xi_j)  E_{\\text{classic}}(\\xi_j)$ 的索引 $j  0$，并报告相应的 $\\xi_j$。\n    - **测试2**：在最接近 $\\xi=\\pi/2$ 的网格点上，比较相位误差的绝对值。\n    - **测试3**：在 $\\xi_0=0$ 处，检查两种模板的幅值误差是否都低于容差 $10^{-12}$。根据理论这是预期的，因为 $\\kappa(0) = 0 \\implies G(0) = 1 \\implies e_{\\text{amp}}(0) = 0$。\n    - **测试4和5**：找到每种模板在整个定义域 $[0, \\pi]$ 上的幅值误差向量的最大值。\n4.  根据指定的格式规则，将最终结果格式化为逗号分隔的列表。\n\n该过程对两种空间离散格式与 RK4 时间积分器耦合时的色散和耗散特性进行了严谨的定量比较。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes and compares two finite-difference schemes for the 1D linear\n    advection equation by computing their numerical dispersion and dissipation\n    errors.\n    \"\"\"\n    # Define problem parameters and test cases from the problem statement.\n    nu = 0.5\n    N = 10001\n    b_classic = [45.0 / 60.0, -9.0 / 60.0, 1.0 / 60.0]\n    b_opt = [0.770882380518225, -0.166705904414580, 0.020843142770311]\n    \n    # Create the non-dimensional wavenumber grid\n    xi = np.linspace(0, np.pi, N, endpoint=True)\n\n    def get_errors(b_coeffs, nu_val, xi_grid):\n        \"\"\"\n        Calculates error metrics for a given stencil and Courant number.\n        \"\"\"\n        # Calculate the modified wavenumber kappa(xi)\n        # kappa(xi) = 2 * sum_{m=1}^{3} b_m * sin(m*xi)\n        kappa = (2 * b_coeffs[0] * np.sin(1 * xi_grid) +\n                 2 * b_coeffs[1] * np.sin(2 * xi_grid) +\n                 2 * b_coeffs[2] * np.sin(3 * xi_grid))\n        \n        # Argument for the RK4 stability function\n        z = -1j * nu_val * kappa\n        \n        # Numerical amplification factor G(xi) from RK4 stability function R(z)\n        # R(z) = 1 + z + z^2/2 + z^3/6 + z^4/24\n        G = 1 + z + z**2 / 2.0 + z**3 / 6.0 + z**4 / 24.0\n\n        # Calculate phase error, e_phase = wrap(arg(G) + nu*xi)\n        e_phase_raw = np.angle(G) + nu_val * xi_grid\n        \n        # Wrap the phase error to the interval (-pi, pi]\n        # The formula is theta - 2*pi*floor((theta+pi)/(2*pi))\n        e_phase = e_phase_raw - 2 * np.pi * np.floor((e_phase_raw + np.pi) / (2 * np.pi))\n\n        # Calculate amplitude error, e_amp = ||G| - 1|\n        e_amp = np.abs(np.abs(G) - 1.0)\n        \n        # Calculate combined error magnitude E\n        E = np.sqrt(e_phase**2 + e_amp**2)\n\n        return e_phase, e_amp, E\n\n    # Calculate errors for both stencils\n    e_phase_c, e_amp_c, E_c = get_errors(b_classic, nu, xi)\n    e_phase_o, e_amp_o, E_o = get_errors(b_opt, nu, xi)\n\n    # --- Test Cases ---\n\n    # Test case 1: Smallest xi_star in (0, pi] where E_opt  E_classic\n    # We search in the slice [1:] to exclude xi=0\n    indices = np.where(E_o[1:]  E_c[1:])[0]\n    if len(indices)  0:\n        # Add 1 to the index to map it back to the original `xi` array\n        first_index = indices[0] + 1\n        xi_star = xi[first_index]\n    else:\n        xi_star = np.nan\n\n    # Test case 2: At xi = pi/2, is |e_phase_opt|  |e_phase_classic|?\n    idx_pi_2 = np.argmin(np.abs(xi - np.pi / 2.0))\n    is_opt_better_phase = np.abs(e_phase_o[idx_pi_2])  np.abs(e_phase_c[idx_pi_2])\n\n    # Test case 3: At xi = 0, do both stencils have amplitude error = 1e-12?\n    # At xi=0, kappa=0, z=0, G=1, so e_amp should be 0. We check for numerical precision.\n    is_amp_zero_at_origin = (e_amp_c[0] = 1e-12) and (e_amp_o[0] = 1e-12)\n\n    # Test case 4: Maximum absolute amplitude error of the classical stencil\n    max_amp_c = np.max(e_amp_c)\n\n    # Test case 5: Maximum absolute amplitude error of the optimized stencil\n    max_amp_o = np.max(e_amp_o)\n\n    # --- Final Output Formatting ---\n    results = [\n        xi_star,\n        is_opt_better_phase,\n        is_amp_zero_at_origin,\n        max_amp_c,\n        max_amp_o\n    ]\n\n    def format_item(item):\n        \"\"\"Formats a result item according to the problem specification.\"\"\"\n        if isinstance(item, (bool, np.bool_)):\n            return str(item)\n        if isinstance(item, (float, np.floating)):\n            if np.isnan(item):\n                return 'NaN'\n            return f\"{item:.6f}\"\n        return str(item)\n\n    formatted_results = [format_item(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后，我们将分析从简单的平流方程扩展到本身具有物理频散特性的更复杂系统——欧拉-伯努利梁。本练习将通过离散频散分析，教您如何评估数值方法在模拟这类物理系统时的保真度 。您将通过比较数值计算的本征频率与精确解，来检验不同阶数格式的准确性，并理解如何通过滤波器控制高频噪声。",
            "id": "3581957",
            "problem": "你需要使用一维欧拉-伯努利弯曲波模型构建一个用于色散正规模的计算基准。该模型是计算地球物理学中岩石圈弯曲和其他薄板现象的标准代表。目标是通过将离散模式的本征频率与薄弹性梁的精确解析值进行比较，来量化和控制数值色散和耗散。\n\n考虑由线性欧拉-伯努利梁方程控制的初边值问题\n$$\nu_{tt}(x,t) + c_b^2\\,u_{xxxx}(x,t) = 0,\\quad x\\in[0,L],\\ t\\ge 0,\n$$\n边界条件为简支\n$$\nu(0,t) = 0,\\quad u(L,t) = 0,\\quad u_{xx}(0,t) = 0,\\quad u_{xx}(L,t) = 0.\n$$\n其中，$u(x,t)$ 是横向位移，$L$ 是梁的长度，$c_b$ 是弯曲波速参数，单位为 $\\mathrm{m^2/s}$，因此角频率的单位是 $\\mathrm{rad/s}$。正规模解的拟设 $u(x,t) = \\phi_n(x)\\cos(\\omega_n t)$ 产生了以下本征值问题\n$$\n\\phi_n^{(4)}(x) = \\kappa_n^4\\,\\phi_n(x),\\quad \\phi_n(0) = 0,\\ \\phi_n(L)=0,\\ \\phi_n''(0)=0,\\ \\phi_n''(L)=0,\n$$\n其精确本征函数为 $\\phi_n(x) = \\sin\\!\\left(\\frac{n\\pi x}{L}\\right)$，对于整数模式 $n\\ge 1$，其精确波数为 $k_n = \\frac{n\\pi}{L}$。精确的角本征频率为\n$$\n\\omega_n^{\\mathrm{exact}} = c_b\\,k_n^2 = c_b\\,\\left(\\frac{n\\pi}{L}\\right)^2.\n$$\n\n用 $N$ 个内点和均匀间距 $h = \\frac{L}{N+1}$ 离散化空间域，并在端点处强制执行狄利克雷边界值 $u(0,t)=u(L,t)=0$。考虑内部网格上二阶导数算子 $u_{xx}$ 的两种有限差分-离散化方法，两者都表示为作用于内部值向量的对称托普利茨矩阵，并隐式地使用内部格式外的边界值 $u=0$：\n\n- 二阶精度三点格式，系数为 $\\frac{1}{h^2}\\{1,-2,1\\}$，偏移量为 $\\{-1,0,1\\}$。\n- 四阶精度五点格式，系数为 $\\frac{1}{h^2}\\left\\{-\\frac{1}{12},\\frac{4}{3},-\\frac{5}{2},\\frac{4}{3},-\\frac{1}{12}\\right\\}$，偏移量为 $\\{-2,-1,0,1,2\\}$。\n\n设 $\\theta_n = \\frac{n\\pi}{N+1}$。对于离散正弦本征向量 $v^{(n)}_j = \\sin(j\\theta_n)$，$j=1,\\dots,N$，这些托普利茨格式对应的离散二阶导数本征值为\n$$\n\\lambda^{(2)}(\\theta) = \\frac{-2 + 2\\cos\\theta}{h^2} = -\\frac{4\\sin^2(\\theta/2)}{h^2},\n$$\n和\n$$\n\\lambda^{(4)}(\\theta) = \\frac{-\\frac{5}{2} + \\frac{8}{3}\\cos\\theta - \\frac{1}{6}\\cos(2\\theta)}{h^2}.\n$$\n离散四阶导数本征值通过 $\\mu(\\theta) = \\left(\\lambda(\\theta)\\right)^2$ 建模，相应的半离散角频率满足\n$$\n\\omega_n^{\\mathrm{num}} = c_b\\,\\left|\\lambda(\\theta_n)\\right|.\n$$\n\n为了探索对数值色散和耗散的控制，通过一个尺度选择性平滑（滤波器）来增强空间算子，该滤波器减少高波数内容，在模态形式下表示为一种乘法衰减\n$$\n\\lambda_{\\sigma}(\\theta) = \\left(1 - \\sigma\\,\\varphi(\\theta)\\right)\\lambda(\\theta),\\quad \\varphi(\\theta) = \\sin^6\\!\\left(\\frac{\\theta}{2}\\right),\n$$\n滤波器强度 $\\sigma\\in[0,1]$。这模拟了谱消失粘性，主要作用于网格奈奎斯特波数附近。经过滤波的离散频率模型为\n$$\n\\omega_{n,\\sigma}^{\\mathrm{num}} = c_b\\,\\left|\\lambda_{\\sigma}(\\theta_n)\\right|.\n$$\n\n对于每个测试配置和模式索引集 $\\mathcal{M}$，定义模式 $n\\in \\mathcal{M}$ 的相对误差为\n$$\n\\varepsilon_n = \\frac{\\left|\\omega_{n,\\sigma}^{\\mathrm{num}} - \\omega_n^{\\mathrm{exact}}\\right|}{\\omega_n^{\\mathrm{exact}}},\n$$\n如果 $\\max_{n\\in\\mathcal{M}} \\varepsilon_n \\le \\mathrm{tol}$，则声明该配置通过。\n\n您的任务是编写一个完整的程序，该程序：\n- 实现二阶和四阶离散二阶导数本征值 $\\lambda^{(2)}(\\theta)$ 和 $\\lambda^{(4)}(\\theta)$。\n- 使用上述公式，为指定模式 $n$ 计算精确和数值角本征频率，可选滤波器强度 $\\sigma$。\n- 通过比较测试集中所有模式的相对误差，为给定的容差评估通过/失败布尔值。\n\n物理单位要求：将 $L$ 解释为 $\\mathrm{m}$，$c_b$ 解释为 $\\mathrm{m^2/s}$，角频率解释为 $\\mathrm{rad/s}$。然而，程序的最终输出是布尔值，它们是无量纲的。\n\n测试套件：\n为以下参数集提供结果，涵盖精度阶数效应、网格分辨率影响和滤波器影响。对于每种情况，模式集由一个正整数列表给出；列表中的最大相对误差将与容差进行比较。\n\n- 情况 1：$L=1.0$，$c_b=1.0$，$N=63$，方案 = 四阶，$\\sigma=0.0$，模式 $\\mathcal{M}=[1,2,3,10]$，容差 $\\mathrm{tol}=2\\times 10^{-3}$。\n- 情况 2：$L=1.0$，$c_b=1.0$，$N=31$，方案 = 二阶，$\\sigma=0.0$，模式 $\\mathcal{M}=[1,2,3,10]$，容差 $\\mathrm{tol}=1\\times 10^{-2}$。\n- 情况 3：$L=1.0$，$c_b=1.0$，$N=47$，方案 = 四阶，$\\sigma=0.0$，模式 $\\mathcal{M}=[1,2,3,10]$，容差 $\\mathrm{tol}=3\\times 10^{-3}$。\n- 情况 4：$L=1.0$，$c_b=1.0$，$N=31$，方案 = 二阶，$\\sigma=0.2$，模式 $\\mathcal{M}=[10,12,14]$，容差 $\\mathrm{tol}=7\\times 10^{-2}$。\n- 情况 5：$L=1.0$，$c_b=1.0$，$N=127$，方案 = 二阶，$\\sigma=0.0$，模式 $\\mathcal{M}=[1,2,3]$，容差 $\\mathrm{tol}=1\\times 10^{-3}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述顺序排列，例如 $[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5]$，其中每个 $\\mathrm{result}_i$ 是 $\\mathrm{True}$ 或 $\\mathrm{False}$。程序不得读取任何输入，并且必须在内部计算这些结果。",
            "solution": "这个问题的核心在于比较连续物理系统的解析色散关系与其离散近似的数值色散关系。\n\n该物理系统是一维弹性梁，其横向位移 $u(x,t)$ 由欧拉-伯努利方程控制：\n$$\n\\frac{\\partial^2 u}{\\partial t^2} + c_b^2 \\frac{\\partial^4 u}{\\partial x^4} = 0\n$$\n这里，$c_b$ 是弯曲波速参数。对于域 $x \\in [0, L]$ 上的简支边界条件，解可以表示为正规模的叠加。拟设 $u(x,t) = \\phi_n(x) \\cos(\\omega_n t)$ 将问题分离为一个关于模态形状 $\\phi_n(x)$ 及其相应角本征频率 $\\omega_n$ 的空间本征值问题。精确的模态形状由 $\\phi_n(x) = \\sin(k_n x)$ 给出，对于整数模式 $n \\ge 1$，其波数为 $k_n = n\\pi/L$。将此代入控制方程可得到精确的色散关系：\n$$\n\\omega_n^{\\mathrm{exact}} = c_b k_n^2 = c_b \\left(\\frac{n\\pi}{L}\\right)^2\n$$\n该关系是色散的，意味着相速度 $v_p = \\omega_n/k_n = c_b k_n$ 取决于波数，因此不同长度的波以不同的速度传播。\n\n当空间域用 $N$ 个内点和间距 $h = L/(N+1)$ 进行离散化时，连续导数被有限差分算子取代。对于指定的简支边界条件，所得离散算子的本征向量是离散正弦函数，$v_j^{(n)} = \\sin(j \\theta_n)$，其中 $j=1,\\dots,N$ 是网格点索引，$\\theta_n = n\\pi/(N+1) = k_n h$ 是无量纲波数。\n\n此分析中的关键步骤是，将有限差分算子应用于离散正弦本征向量，等效于将该本征向量乘以一个标量本征值。对于二阶导数算子，该标量表示为 $\\lambda(\\theta_n)$，是无量纲波数 $\\theta_n$ 的函数。连续二阶导数算子 $\\frac{\\partial^2}{\\partial x^2}$ 的本征值为 $-k_n^2$。有限差分格式的精度取决于其本征值 $\\lambda(\\theta_n)$ 对 $-k_n^2 = -(\\theta_n/h)^2$ 的近似程度。\n\n该问题为二阶导数指定了两种格式：\n1.  一个二阶精度格式，其本征值为 $\\lambda^{(2)}(\\theta) = \\frac{-2 + 2\\cos\\theta}{h^2}$。\n2.  一个四阶精度格式，其本征值为 $\\lambda^{(4)}(\\theta) = \\frac{1}{h^2}\\left(-\\frac{5}{2} + \\frac{8}{3}\\cos\\theta - \\frac{1}{6}\\cos(2\\theta)\\right)$。\n\n该问题将四阶导数算子建模为二阶导数算子的平方。因此，通过将解析的 $k_n^2$ 替换为其数值对应物（实际上是 $-\\lambda(\\theta_n)$），半离散控制方程导出了一个数值色散关系。因此，数值频率计算如下：\n$$\n\\omega_n^{\\mathrm{num}} = c_b \\left|-\\lambda(\\theta_n)\\right| = c_b \\left|\\lambda(\\theta_n)\\right|\n$$\n使用绝对值是因为所提供的本征值 $\\lambda(\\theta_n)$ 是非正的。$\\omega_n^{\\mathrm{num}}$ 与 $\\omega_n^{\\mathrm{exact}}$ 的偏差称为数值色散。\n\n为了控制高频数值伪影，引入了一个谱滤波器。该滤波器通过乘法修改算子的本征值：\n$$\n\\lambda_{\\sigma}(\\theta) = \\left(1 - \\sigma\\,\\varphi(\\theta)\\right)\\lambda(\\theta)\n$$\n其中 $\\sigma$ 是滤波器强度，$\\varphi(\\theta) = \\sin^6(\\theta/2)$ 是一个选择性地作用于高波数（即 $\\theta$ 接近 $\\pi$）的函数。这个附加项引入了数值耗散，它会衰减高频分量。经过滤波的数值频率则为：\n$$\n\\omega_{n,\\sigma}^{\\mathrm{num}} = c_b \\left|\\lambda_{\\sigma}(\\theta_n)\\right|\n$$\n其步骤是，对每个测试配置，评估指定模式集 $\\mathcal{M}$ 上的最大相对误差：\n$$\n\\varepsilon_{\\mathrm{max}} = \\max_{n\\in\\mathcal{M}} \\left( \\frac{\\left|\\omega_{n,\\sigma}^{\\mathrm{num}} - \\omega_n^{\\mathrm{exact}}\\right|}{\\omega_n^{\\mathrm{exact}}} \\right)\n$$\n如果此最大误差不超过给定的容差 $\\mathrm{tol}$，则该配置被声明为“通过”（$\\mathrm{True}$），否则为“失败”（$\\mathrm{False}$）。实现将系统地将这些公式应用于每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational benchmark problem for dispersive normal modes.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"L\": 1.0, \"cb\": 1.0, \"N\": 63, \"scheme\": \"fourth-order\", \"sigma\": 0.0,\n            \"modes\": [1, 2, 3, 10], \"tol\": 2e-3, \"case_id\": 1\n        },\n        {\n            \"L\": 1.0, \"cb\": 1.0, \"N\": 31, \"scheme\": \"second-order\", \"sigma\": 0.0,\n            \"modes\": [1, 2, 3, 10], \"tol\": 1e-2, \"case_id\": 2\n        },\n        {\n            \"L\": 1.0, \"cb\": 1.0, \"N\": 47, \"scheme\": \"fourth-order\", \"sigma\": 0.0,\n            \"modes\": [1, 2, 3, 10], \"tol\": 3e-3, \"case_id\": 3\n        },\n        {\n            \"L\": 1.0, \"cb\": 1.0, \"N\": 31, \"scheme\": \"second-order\", \"sigma\": 0.2,\n            \"modes\": [10, 12, 14], \"tol\": 7e-2, \"case_id\": 4\n        },\n        {\n            \"L\": 1.0, \"cb\": 1.0, \"N\": 127, \"scheme\": \"second-order\", \"sigma\": 0.0,\n            \"modes\": [1, 2, 3], \"tol\": 1e-3, \"case_id\": 5\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        L = case[\"L\"]\n        cb = case[\"cb\"]\n        N = case[\"N\"]\n        scheme = case[\"scheme\"]\n        sigma = case[\"sigma\"]\n        modes = case[\"modes\"]\n        tol = case[\"tol\"]\n\n        h = L / (N + 1)\n        \n        max_relative_error = 0.0\n\n        for n in modes:\n            # Calculate the exact angular eigenfrequency\n            kn = n * np.pi / L\n            omega_exact = cb * kn**2\n\n            # Calculate the dimensionless wavenumber\n            theta_n = n * np.pi / (N + 1)\n\n            # Calculate the unfiltered discrete second-derivative eigenvalue\n            if scheme == \"second-order\":\n                lambda_theta = (-2.0 + 2.0 * np.cos(theta_n)) / h**2\n            elif scheme == \"fourth-order\":\n                lambda_theta = (\n                    -2.5 + (8.0/3.0) * np.cos(theta_n) - (1.0/6.0) * np.cos(2.0 * theta_n)\n                ) / h**2\n            else:\n                raise ValueError(f\"Unknown scheme: {scheme}\")\n\n            # Apply the filter if sigma is non-zero\n            if sigma  0:\n                phi_theta = np.sin(theta_n / 2.0)**6\n                lambda_sigma_theta = (1.0 - sigma * phi_theta) * lambda_theta\n            else:\n                lambda_sigma_theta = lambda_theta\n            \n            # Calculate the numerical angular eigenfrequency\n            omega_num = cb * np.abs(lambda_sigma_theta)\n\n            # Calculate the relative error for the current mode\n            relative_error = np.abs(omega_num - omega_exact) / omega_exact\n            \n            if relative_error  max_relative_error:\n                max_relative_error = relative_error\n\n        # Check if the configuration passes the tolerance test\n        pass_fail = max_relative_error = tol\n        results.append(pass_fail)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}