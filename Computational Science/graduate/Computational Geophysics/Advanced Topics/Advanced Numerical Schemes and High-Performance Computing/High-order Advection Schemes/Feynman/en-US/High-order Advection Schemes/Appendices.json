{
    "hands_on_practices": [
        {
            "introduction": "The formal accuracy of a numerical scheme is its most fundamental property, distinguishing low-order methods from their high-order counterparts. This practice guides you through a local truncation error analysis, the standard method for quantifying a scheme's accuracy by measuring how well the exact solution of the partial differential equation satisfies the discrete numerical equation. By applying Taylor series expansions to the Lax-Wendroff scheme, you will rigorously prove its second-order accuracy and identify the leading error term, which reveals the scheme's inherently dispersive nature ().",
            "id": "3603413",
            "problem": "In one spatial dimension, consider the constant-coefficient linear advection equation $u_{t} + a\\,u_{x} = 0$ with a constant advection speed $a>0$. Let the spatial grid points be $x_{j} = j\\,\\Delta x$ and time levels be $t_{n} = n\\,\\Delta t$, with the Courant number defined by $\\nu = a\\,\\Delta t / \\Delta x$. The two-step Lax-Wendroff scheme is implemented in its standard single-step conservative form:\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\Big(u_{j+1}^{n} - u_{j-1}^{n}\\Big) \\;+\\; \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\Big(u_{j+1}^{n} - 2\\,u_{j}^{n} + u_{j-1}^{n}\\Big).\n$$\nDefine the local truncation error $\\tau_{j}^{n}$ by\n$$\n\\tau_{j}^{n} \\;=\\; \\frac{1}{\\Delta t}\\,\\Big(u(x_{j},t_{n+1}) \\;-\\; \\Big[u_{j}^{n} \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\big(u_{j+1}^{n} - u_{j-1}^{n}\\big) \\;+\\; \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\big(u_{j+1}^{n} - 2\\,u_{j}^{n} + u_{j-1}^{n}\\big)\\Big]\\Big),\n$$\nwhere $u(x,t)$ is the exact solution of the partial differential equation. Starting from the partial differential equation and Taylor expansions in space and time, and eliminating time derivatives using the partial differential equation, perform a local truncation error analysis. Show that $\\tau_{j}^{n} = O(\\Delta t^{2}, \\Delta x^{2})$ and that, when $\\nu = O(1)$, the leading dispersive contribution is proportional to $\\Delta x^{2}\\,u_{xxx}$. \n\nReport your final answer as the coefficient $C(a,\\nu)$ multiplying $\\Delta x^{2}\\,u_{xxx}$ in the leading-order term of $\\tau_{j}^{n}$, defined by writing\n$$\n\\tau_{j}^{n} \\;=\\; C(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx}(x_{j},t_{n}) \\;+\\; \\text{higher-order terms}.\n$$\nYour final answer must be a single, closed-form analytic expression in terms of $a$ and $\\nu$ only. No numerical evaluation is required, and no units are needed.",
            "solution": "The problem is valid as it is a well-posed, scientifically grounded question in the field of numerical analysis for partial differential equations. All necessary information is provided, and the objective is clearly defined.\n\nThe local truncation error, $\\tau_{j}^{n}$, is defined by applying the finite difference operator to the exact solution $u(x,t)$ of the partial differential equation (PDE). The given definition is\n$$\n\\tau_{j}^{n} = \\frac{1}{\\Delta t} \\left( u(x_{j}, t_{n+1}) - \\left[ u(x_{j},t_{n}) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u(x_{j+1},t_{n}) - u(x_{j-1},t_{n})\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u(x_{j+1},t_{n}) - 2\\,u(x_j, t_n) + u(x_{j-1},t_{n})\\right) \\right] \\right)\n$$\nwhere $u(x,t)$ is the exact solution, and all terms are evaluated at the specified grid points. For simplicity, we denote $u(x_{j}, t_{n})$ as $u$ and will expand all other terms in a Taylor series around the point $(x_{j}, t_{n})$. Partial derivatives with respect to $x$ and $t$ will be denoted by subscripts, e.g., $u_{x} = \\frac{\\partial u}{\\partial x}$ and $u_{t} = \\frac{\\partial u}{\\partial t}$, all evaluated at $(x_j, t_n)$.\n\nFirst, we expand the exact solution term $u(x_{j}, t_{n+1})$ in a Taylor series in time around $t_{n}$:\n$$\nu(x_{j}, t_{n+1}) = u(x_{j}, t_{n} + \\Delta t) = u + \\Delta t \\, u_{t} + \\frac{\\Delta t^{2}}{2} \\, u_{tt} + \\frac{\\Delta t^{3}}{6} \\, u_{ttt} + O(\\Delta t^{4})\n$$\nThe governing PDE is $u_{t} + a\\,u_{x} = 0$, or $u_{t} = -a\\,u_{x}$. We can express higher-order time derivatives in terms of spatial derivatives by repeatedly differentiating the PDE and assuming sufficient smoothness of $u(x,t)$:\n$$\nu_{t} = -a \\, u_{x}\n$$\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(-a\\,u_{x}) = -a\\,u_{xt} = -a\\,\\frac{\\partial}{\\partial x}(u_{t}) = -a\\,\\frac{\\partial}{\\partial x}(-a\\,u_{x}) = a^{2}\\,u_{xx}\n$$\n$$\nu_{ttt} = \\frac{\\partial}{\\partial t}(a^{2}\\,u_{xx}) = a^{2}\\,u_{xxt} = a^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}}(u_{t}) = a^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}}(-a\\,u_{x}) = -a^{3}\\,u_{xxx}\n$$\nSubstituting these back into the expansion for $u(x_{j}, t_{n+1})$ yields:\n$$\nu(x_{j}, t_{n+1}) = u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} + O(\\Delta t^{4})\n$$\n\nNext, we analyze the numerical scheme part of the error expression. We require Taylor series expansions in space for $u(x_{j\\pm 1}, t_{n})$ around $x_{j}$:\n$$\nu(x_{j+1}, t_{n}) = u + \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} + \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} + O(\\Delta x^{5})\n$$\n$$\nu(x_{j-1}, t_{n}) = u - \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} - \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} + O(\\Delta x^{5})\n$$\nThe terms in the numerical scheme can be expressed using these expansions:\nThe central difference for the first derivative:\n$$\nu(x_{j+1},t_{n}) - u(x_{j-1},t_{n}) = 2\\,\\Delta x\\,u_{x} + \\frac{\\Delta x^{3}}{3}\\,u_{xxx} + O(\\Delta x^{5})\n$$\nThe central difference for the second derivative:\n$$\nu(x_{j+1},t_{n}) - 2\\,u(x_{j},t_{n}) + u(x_{j-1},t_{n}) = \\Delta x^{2}\\,u_{xx} + \\frac{\\Delta x^{4}}{12}\\,u_{xxxx} + O(\\Delta x^{6})\n$$\nLet $L_{\\Delta t}(u)$ denote the numerical operator applied to the exact solution:\n$$\nL_{\\Delta t}(u) = u - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u(x_{j+1},t_{n}) - u(x_{j-1},t_{n})\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u(x_{j+1},t_{n}) - 2\\,u(x_j, t_n) + u(x_{j-1},t_{n})\\right)\n$$\nSubstituting the spatial expansions gives:\n$$\nL_{\\Delta t}(u) = u - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(2\\,\\Delta x\\,u_{x} + \\frac{\\Delta x^{3}}{3}\\,u_{xxx} + \\dots\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(\\Delta x^{2}\\,u_{xx} + \\frac{\\Delta x^{4}}{12}\\,u_{xxxx} + \\dots\\right)\n$$\nSimplifying the coefficients:\n$$\nL_{\\Delta t}(u) = u - a\\,\\Delta t\\,u_{x} - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} + \\frac{a^{2}\\,\\Delta t^{2}\\,\\Delta x^{2}}{24}\\,u_{xxxx} + \\text{H.O.T.}\n$$\nwhere H.O.T. represents higher-order terms.\n\nNow we can compute the truncation error. From the definition, $\\Delta t\\,\\tau_{j}^{n} = u(x_{j}, t_{n+1}) - L_{\\Delta t}(u)$.\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} + \\dots \\right) - \\left( u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\dots \\right)\n$$\nThe terms up to second order cancel out, as expected for a second-order scheme:\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} \\right) - \\left( - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} \\right) + \\text{H.O.T.}\n$$\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6} - \\frac{a^{3}\\,\\Delta t^{3}}{6} \\right) u_{xxx} + \\text{H.O.T.}\n$$\nDividing by $\\Delta t$ to find $\\tau_{j}^{n}$:\n$$\n\\tau_{j}^{n} = \\left( \\frac{a\\,\\Delta x^{2}}{6} - \\frac{a^{3}\\,\\Delta t^{2}}{6} \\right) u_{xxx} + \\text{H.O.T.}\n$$\nThis confirms that the scheme is formally second-order accurate, i.e., $\\tau_{j}^{n} = O(\\Delta x^{2}, \\Delta t^{2})$, because if $\\Delta t \\propto \\Delta x$, both terms are $O(\\Delta x^2)$. The leading error term is proportional to $u_{xxx}$, which is a dispersive error term.\n\nTo express the coefficient in terms of $a$ and the Courant number $\\nu = a\\,\\Delta t/\\Delta x$, we factor out $\\frac{a\\,\\Delta x^{2}}{6}$ from the leading term:\n$$\n\\tau_{j}^{n} = \\frac{a\\,\\Delta x^{2}}{6} \\left( 1 - \\frac{a^{2}\\,\\Delta t^{2}}{\\Delta x^{2}} \\right) u_{xxx} + \\text{H.O.T.}\n$$\nRecognizing that $\\nu^{2} = (a\\,\\Delta t/\\Delta x)^{2} = a^{2}\\,\\Delta t^{2}/\\Delta x^{2}$, we have:\n$$\n\\tau_{j}^{n} = \\frac{a\\,\\Delta x^{2}}{6} (1 - \\nu^{2}) u_{xxx} + \\text{H.O.T.}\n$$\nThe problem defines the leading error term as $C(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx}(x_{j},t_{n})$. By comparing this form with our derived expression, we can identify the coefficient $C(a,\\nu)$:\n$$\nC(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx} = \\frac{a}{6} (1 - \\nu^{2}) \\Delta x^{2}\\,u_{xxx}\n$$\nTherefore, the coefficient is:\n$$\nC(a,\\nu) = \\frac{a}{6}(1 - \\nu^{2})\n$$\nThis is the desired closed-form analytic expression in terms of $a$ and $\\nu$. The error vanishes when $\\nu=1$, in which case the Lax-Wendroff scheme is exact for the constant-coefficient linear advection equation.",
            "answer": "$$\\boxed{\\frac{a}{6}(1 - \\nu^{2})}$$"
        },
        {
            "introduction": "Beyond formal accuracy, a scheme's stability and its handling of different wavenumbers are critical for producing physically meaningful results. This exercise employs von Neumann stability analysis to compare the behavior of the dispersive Lax-Wendroff scheme with the diffusive Lax-Friedrichs scheme, focusing on the Nyquist frequency, which represents the most oscillatory mode a grid can resolve. This analysis will clarify why high-order, low-dissipation schemes can be prone to non-physical oscillations and provides crucial insight into their damping properties ().",
            "id": "3603414",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a \\in \\mathbb{R}$ on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$. Define the Courant number $C = a\\,\\Delta t / \\Delta x$. Two classical finite-difference schemes are considered:\n\n- Lax-Friedrichs scheme: $u^{n+1}_{j} = \\tfrac{1}{2}\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) - \\tfrac{C}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right)$.\n- Lax-Wendroff scheme: $u^{n+1}_{j} = u^{n}_{j} - \\tfrac{C}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\tfrac{C^{2}}{2}\\left(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\right)$.\n\nUsing von Neumann analysis with Fourier mode $u^{n}_{j} = \\hat{u}^{n}\\,\\exp\\left(\\mathrm{i}\\,j\\,\\theta\\right)$, focus on the Nyquist wavenumber defined by the nondimensional phase $\\theta = \\pi$. Compare the amplification factors at $\\theta = \\pi$ for both schemes and interpret the implications for damping of the two-grid oscillation (checkerboard mode) that alternates sign between adjacent grid points. Select the option that correctly states the amplification factors at $\\theta = \\pi$ and the corresponding damping behavior for admissible Courant numbers satisfying $0 < C \\leq 1$.\n\nA. For Lax-Friedrichs, $|G(\\pi)| = 1$ for all $C$, whereas for Lax-Wendroff, $G(\\pi) = 1 - 2\\,C^{2}$ so that $|G(\\pi)| < 1$ for $0 < C < 1$; thus Lax-Wendroff damps the Nyquist mode except at $C = 1$, while Lax-Friedrichs does not damp it.\n\nB. Both schemes annihilate the Nyquist mode in one time step, i.e., $|G(\\pi)| = 0$ for all $0 < C \\leq 1$; thus both strongly damp the checkerboard mode.\n\nC. For Lax-Friedrichs, $|G(\\pi)| < 1$ for any $C \\neq 0$, while for Lax-Wendroff, $|G(\\pi)| = 1$ for all $0 < C \\leq 1$; thus Lax-Friedrichs damps the Nyquist mode but Lax-Wendroff does not.\n\nD. For both schemes, $|G(\\pi)| = 1$ for all $0 < C \\leq 1$; thus neither scheme damps the checkerboard mode over the entire admissible range.\n\nE. For Lax-Friedrichs, $|G(\\pi)| = 1$, and for Lax-Wendroff, $G(\\pi) = -2\\,\\mathrm{i}\\,C$; hence both are purely dispersive at the Nyquist wavenumber and non-dissipative.",
            "solution": "The user wants a detailed analysis of two finite-difference schemes for the linear advection equation, focusing on their behavior at the Nyquist wavenumber.\n\n### Problem Validation\nThe problem statement is valid. It presents a standard problem in the numerical analysis of partial differential equations. All terms are well-defined, the physical and mathematical context is sound, and the question is well-posed, leading to a unique, verifiable solution. No flaws were identified.\n\n### Derivation\n\nThe problem asks for an analysis of the amplification factors of the Lax-Friedrichs and Lax-Wendroff schemes for the one-dimensional linear advection equation, $u_t + a u_x = 0$. The analysis is to be performed using the von Neumann method at the Nyquist wavenumber, which corresponds to a nondimensional phase of $\\theta = \\pi$.\n\nIn von Neumann analysis, we consider a single Fourier mode of the solution, $u_j^n = \\hat{u}^n e^{\\mathrm{i}j\\theta}$, where $j$ is the spatial grid index, $n$ is the time level index, $\\mathrm{i} = \\sqrt{-1}$, and $\\theta = k\\Delta x$ is the nondimensional wavenumber ($k$ is the wavenumber, $\\Delta x$ is the grid spacing). The amplification factor, $G(\\theta)$, is defined by the relation $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^n$, which implies $u_j^{n+1} = G(\\theta) u_j^n$. From this, we also have the relations for neighboring points: $u_{j\\pm 1}^n = \\hat{u}^n e^{\\mathrm{i}(j\\pm 1)\\theta} = e^{\\pm\\mathrm{i}\\theta} u_j^n$. We will use these relations to derive the amplification factor for each scheme.\n\nA scheme is dissipative for a given mode $\\theta$ if $|G(\\theta)| < 1$, and non-dissipative if $|G(\\theta)| = 1$. The Nyquist wavenumber $\\theta=\\pi$ corresponds to the highest frequency resolvable on the grid, representing a \"checkerboard\" or \"two-grid\" oscillation of the form $e^{\\mathrm{i}j\\pi} = (-1)^j$. Damping this mode is often desirable to control numerical oscillations.\n\n**1. Lax-Friedrichs Scheme**\n\nThe scheme is given by:\n$$u^{n+1}_{j} = \\frac{1}{2}\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) - \\frac{C}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right)$$\nwhere $C = a\\,\\Delta t / \\Delta x$ is the Courant number.\n\nSubstitute the Fourier mode relationships:\n$$G_{LF}(\\theta)u_j^n = \\frac{1}{2}\\left(e^{\\mathrm{i}\\theta}u_j^n + e^{-\\mathrm{i}\\theta}u_j^n\\right) - \\frac{C}{2}\\left(e^{\\mathrm{i}\\theta}u_j^n - e^{-\\mathrm{i}\\theta}u_j^n\\right)$$\nDividing by $u_j^n$ (which is non-zero) yields the amplification factor $G_{LF}(\\theta)$:\n$$G_{LF}(\\theta) = \\frac{1}{2}\\left(e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta}\\right) - \\frac{C}{2}\\left(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}\\right)$$\nUsing Euler's identities, $\\cos(\\theta) = \\frac{1}{2}(e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta})$ and $\\sin(\\theta) = \\frac{1}{2\\mathrm{i}}(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta})$, we can simplify this expression:\n$$G_{LF}(\\theta) = \\cos(\\theta) - \\mathrm{i}C\\sin(\\theta)$$\nNow, we evaluate this at the Nyquist wavenumber, $\\theta = \\pi$:\n$$G_{LF}(\\pi) = \\cos(\\pi) - \\mathrm{i}C\\sin(\\pi) = -1 - \\mathrm{i}C(0) = -1$$\nThe magnitude of the amplification factor at the Nyquist wavenumber is:\n$$|G_{LF}(\\pi)| = |-1| = 1$$\nThis result is independent of the Courant number $C$. Since the magnitude is exactly $1$, the Lax-Friedrichs scheme does not damp the Nyquist mode. The amplitude of the checkerboard oscillation remains constant, though its sign flips at each time step because $G_{LF}(\\pi) = -1$.\n\n**2. Lax-Wendroff Scheme**\n\nThe scheme is given by:\n$$u^{n+1}_{j} = u^{n}_{j} - \\frac{C}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{C^{2}}{2}\\left(u^{n}_{j+1} - 2u^{n}_{j} + u^{n}_{j-1}\\right)$$\nSubstitute the Fourier mode relationships:\n$$G_{LW}(\\theta)u_j^n = u_j^n - \\frac{C}{2}\\left(e^{\\mathrm{i}\\theta}u_j^n - e^{-\\mathrm{i}\\theta}u_j^n\\right) + \\frac{C^{2}}{2}\\left(e^{\\mathrm{i}\\theta}u_j^n - 2u_j^n + e^{-\\mathrm{i}\\theta}u_j^n\\right)$$\nDividing by $u_j^n$:\n$$G_{LW}(\\theta) = 1 - \\frac{C}{2}\\left(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}\\right) + \\frac{C^{2}}{2}\\left(e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta}\\right)$$\nUsing Euler's identities and the identity $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} - 2 = 2\\cos(\\theta) - 2$:\n$$G_{LW}(\\theta) = 1 - \\frac{C}{2}(2\\mathrm{i}\\sin(\\theta)) + \\frac{C^{2}}{2}(2\\cos(\\theta) - 2)$$\n$$G_{LW}(\\theta) = 1 - \\mathrm{i}C\\sin(\\theta) + C^2(\\cos(\\theta) - 1)$$\nNow, we evaluate this at the Nyquist wavenumber, $\\theta = \\pi$:\n$$G_{LW}(\\pi) = 1 - \\mathrm{i}C\\sin(\\pi) + C^2(\\cos(\\pi) - 1) = 1 - \\mathrm{i}C(0) + C^2(-1 - 1) = 1 - 2C^2$$\nThe amplification factor is real. We need to find its magnitude for the specified range $0 < C \\leq 1$.\n$$|G_{LW}(\\pi)| = |1 - 2C^2|$$\nLet's analyze this magnitude:\n- If $C = 1$, $|G_{LW}(\\pi)| = |1 - 2(1)^2| = |-1| = 1$. The scheme is non-dissipative at the stability limit.\n- If $0 < C < 1$, then $0 < C^2 < 1$ and $0 < 2C^2 < 2$. This gives $-1 < 1 - 2C^2 < 1$.\n  Therefore, for $0 < C < 1$, the magnitude is strictly less than $1$: $|G_{LW}(\\pi)| = |1 - 2C^2| < 1$.\nThis means the Lax-Wendroff scheme is dissipative and damps the Nyquist mode for all admissible Courant numbers in the range $0 < C < 1$. It only fails to damp this mode at the boundary case $C=1$.\n\n### Option-by-Option Analysis\n\n**A. For Lax-Friedrichs, $|G(\\pi)| = 1$ for all $C$, whereas for Lax-Wendroff, $G(\\pi) = 1 - 2\\,C^{2}$ so that $|G(\\pi)| < 1$ for $0 < C < 1$; thus Lax-Wendroff damps the Nyquist mode except at $C = 1$, while Lax-Friedrichs does not damp it.**\n- The statement for Lax-Friedrichs, $|G(\\pi)| = 1$, is correct.\n- The statement for Lax-Wendroff, $G(\\pi) = 1 - 2C^2$, is correct.\n- The implication that $|G(\\pi)| < 1$ for $0 < C < 1$ for Lax-Wendroff is correct.\n- The final conclusion that Lax-Wendroff damps the Nyquist mode (except at $C=1$) while Lax-Friedrichs does not, is entirely consistent with our derivation.\n- **Verdict: Correct.**\n\n**B. Both schemes annihilate the Nyquist mode in one time step, i.e., $|G(\\pi)| = 0$ for all $0 < C \\leq 1$; thus both strongly damp the checkerboard mode.**\n- This is incorrect. For Lax-Friedrichs, $|G(\\pi)| = 1$, not $0$. For Lax-Wendroff, $|G(\\pi)| = 0$ only at the specific value $C = 1/\\sqrt{2}$, not for all $C$ in the range.\n- **Verdict: Incorrect.**\n\n**C. For Lax-Friedrichs, $|G(\\pi)| < 1$ for any $C \\neq 0$, while for Lax-Wendroff, $|G(\\pi)| = 1$ for all $0 < C \\leq 1$; thus Lax-Friedrichs damps the Nyquist mode but Lax-Wendroff does not.**\n- This statement reverses the properties of the two schemes. Our analysis showed $|G_{LF}(\\pi)|=1$ and $|G_{LW}(\\pi)| \\leq 1$ (with equality only at $C=1$).\n- **Verdict: Incorrect.**\n\n**D. For both schemes, $|G(\\pi)| = 1$ for all $0 < C \\leq 1$; thus neither scheme damps the checkerboard mode over the entire admissible range.**\n- This is true for Lax-Friedrichs, but false for Lax-Wendroff, which does damp the mode for $0 < C < 1$.\n- **Verdict: Incorrect.**\n\n**E. For Lax-Friedrichs, $|G(\\pi)| = 1$, and for Lax-Wendroff, $G(\\pi) = -2\\,\\mathrm{i}\\,C$; hence both are purely dispersive at the Nyquist wavenumber and non-dissipative.**\n- The first part for Lax-Friedrichs is correct, $|G(\\pi)|=1$.\n- The second part for Lax-Wendroff is incorrect. We derived $G_{LW}(\\pi) = 1 - 2C^2$, which is real, not the imaginary value $-2\\mathrm{i}C$.\n- **Verdict: Incorrect.**\n\nBased on the detailed analysis, only option A accurately describes the behavior of both schemes at the Nyquist wavenumber.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Theoretical analysis finds its ultimate test in practical implementation, where idealized assumptions meet the complexities of finite-precision arithmetic and discrete grids. This computational exercise challenges you to observe the numerical artifacts predicted by theory—such as aliasing and dispersive ringing—when solving the advection equation with the Lax-Wendroff scheme (). You will then move from diagnosis to mitigation by implementing and evaluating spectral filters, a powerful technique for suppressing spurious oscillations while preserving the scheme's formal second-order accuracy.",
            "id": "3603405",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a u_x = 0$ on the periodic domain $x \\in [0,1]$ with constant advection speed $a$. The goal is to diagnose aliasing of subgrid features under the Lax–Wendroff scheme on coarse grids and to propose and evaluate spectral filters that minimize dispersive ringing while preserving second-order accuracy in space.\n\nFundamental base:\n- The one-dimensional linear advection equation is $u_t + a u_x = 0$ with periodic boundary conditions on $[0,1]$.\n- The Lax–Wendroff finite-difference scheme is derived via Taylor series in time and centered spatial differences.\n- The Discrete Fourier Transform (DFT) and the Fast Fourier Transform (FFT) describe the representation of discrete signals on uniform grids; the Nyquist wavenumber is $k_{\\mathrm{N}} = \\pi/\\Delta x$, where $\\Delta x$ is the grid spacing.\n- Aliasing arises when continuous wavenumbers exceed the Nyquist limit. For a discrete grid of $N$ points on $[0,1]$, modes with integer wavenumber $k^\\star$ alias to the signed integer index $k_{\\mathrm{alias}} = k^\\star - N \\cdot \\mathrm{round}(k^\\star/N)$, which lies in the range $[-N/2, N/2)$.\n\nDefinitions and requirements:\n- Use the uniform grid of $N$ points with spacing $\\Delta x = 1/N$ and periodic boundary conditions.\n- Use a constant Courant number $\\lambda = a \\Delta t / \\Delta x$ for time stepping, with $\\lambda \\in (0,1]$ for stability.\n- Implement the Lax–Wendroff scheme for one time step:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{\\lambda^2}{2}\\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right).\n$$\n- Implement two spectral filters applied after each time step:\n  1. Exponential filter with transfer function\n  $$\n  G_{\\exp}(k) = \\exp\\left(-\\alpha \\left|\\frac{k}{k_{\\max}}\\right|^m\\right),\n  $$\n  where $k$ is the discrete wavenumber, $k_{\\max}$ is the maximum magnitude of $k$, $\\alpha > 0$ is a strength parameter, and $m \\geq 2$ is the order (choose $m > 2$ to enforce negligible distortion at low wavenumbers and preserve second-order accuracy).\n  2. Raised-cosine low-pass filter with cutoff $k_c$:\n  $$\n  G_{\\mathrm{rc}}(k) =\n  \\begin{cases}\n  1, & |k| \\leq k_c, \\\\\n  \\frac{1}{2}\\left[1 + \\cos\\left(\\pi \\frac{|k| - k_c}{k_{\\max} - k_c}\\right)\\right], & k_c < |k| \\leq k_{\\max}, \\\\\n  0, & \\text{otherwise},\n  \\end{cases}\n  $$\n  where $k_c = \\gamma k_{\\max}$ with $0  \\gamma  1$.\n- The filters must preserve $\\mathcal{O}(\\Delta x^2)$ accuracy, which requires that their deviation from $1$ at small $|k|$ be of order $\\mathcal{O}\\left((k \\Delta x)^2\\right)$ or smaller.\n\nDiagnostics and metrics:\n- Aliasing diagnosis: For a signal $u(x) = \\sin(2\\pi k^\\star x)$ sampled on a coarse grid, verify that the dominant DFT peak occurs at the predicted aliased integer wavenumber $k_{\\mathrm{alias}}$; report equality as a boolean ($1.0$ for true, $0.0$ for false).\n- Ringing metric: For a top-hat initial condition $u(x) = 1$ on the interval $[x_0 - w, x_0 + w]$ and $u(x) = 0$ elsewhere (with periodic boundaries), after advecting for time $T$, compute the overshoot amplitude\n$$\n\\delta_{\\mathrm{ring}} = \\max_j u_j^N - 1,\n$$\nwhere $u_j^N$ are the numerical solution values at final time and the exact solution has amplitude $1$ everywhere inside the advected top-hat. Smaller $\\delta_{\\mathrm{ring}}$ indicates less ringing.\n- Accuracy metric: For a smooth, well-resolved initial condition $u(x) = \\sin(2\\pi k_0 x)$ with $k_0$ below Nyquist, advect for one period $T = 1/a$ so the exact solution equals the initial condition. Compute the discrete $\\ell^2$ error\n$$\nE = \\left(\\Delta x \\sum_{j=0}^{N-1} \\left(u_j^{\\mathrm{num}} - u_j^{\\mathrm{exact}}\\right)^2 \\right)^{1/2}\n$$\nand estimate the observed order of accuracy between grid sizes $N_1$ and $N_2$ via\n$$\np_{\\mathrm{est}} = \\frac{\\log\\left(E_{N_1}/E_{N_2}\\right)}{\\log\\left(\\Delta x_{N_1}/\\Delta x_{N_2}\\right)}.\n$$\n\nTest suite:\n- Test $1$ (Aliasing on coarse grid):\n  - Domain length $L = 1$, speed $a = 1$, number of points $N = 32$, initial wavenumber $k^\\star = 20$. Report whether the predicted alias $k_{\\mathrm{alias}}$ equals the dominant DFT peak (boolean $1.0$ or $0.0$).\n- Test $2$ (Ringing suppression):\n  - Domain length $L = 1$, speed $a = 1$, number of points $N = 64$, Courant number $\\lambda = 0.8$, top-hat center $x_0 = 0.25$, half-width $w = 0.05$, final time $T = 0.3$. Report overshoot amplitudes $\\delta_{\\mathrm{ring}}$ for:\n    - No filter.\n    - Exponential filter with $\\alpha = 36$ and $m = 8$.\n    - Raised-cosine filter with $\\gamma = 0.7$.\n- Test $3$ (Accuracy scaling and second-order preservation):\n  - Domain length $L = 1$, speed $a = 1$, Courant number $\\lambda = 0.8$, smooth initial wavenumber $k_0 = 3$, final time $T = 1$. Use $N \\in \\{64, 128, 256\\}$. For each of the three filter settings (none, exponential with $\\alpha = 36$, $m = 8$, and raised-cosine with $\\gamma = 0.7$) compute the errors $E_{64}$, $E_{128}$, and $E_{256}$ and then the observed orders $p_{\\mathrm{est}}$ between $64 \\to 128$ and $128 \\to 256$.\n  - Report the six values: $p_{\\mathrm{est}}^{\\mathrm{none}}(64 \\to 128)$, $p_{\\mathrm{est}}^{\\mathrm{none}}(128 \\to 256)$, $p_{\\mathrm{est}}^{\\exp}(64 \\to 128)$, $p_{\\mathrm{est}}^{\\exp}(128 \\to 256)$, $p_{\\mathrm{est}}^{\\mathrm{rc}}(64 \\to 128)$, $p_{\\mathrm{est}}^{\\mathrm{rc}}(128 \\to 256)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n  - Test $1$: one boolean ($1.0$ or $0.0$).\n  - Test $2$: three floats (overshoot amplitudes for no filter, exponential filter, raised-cosine filter).\n  - Test $3$: six floats (orders of accuracy as specified).\n- Example overall structure: $[r_1,r_2,r_3,r_4,r_5,r_6,r_7,r_8,r_9,r_{10}]$, where $r_1$ is the aliasing boolean from Test $1$, $r_2$–$r_4$ are the ringing metrics from Test $2$, and $r_5$–$r_{10}$ are the accuracy orders from Test $3$.",
            "solution": "We begin from the one-dimensional linear advection equation $u_t + a u_x = 0$ on a periodic domain. For a constant speed $a$, the exact solution translates the initial condition without change in shape: $u(x,t) = u_0(x - a t)$ modulo the domain length. To design and analyze high-order advection schemes, we rely on the relationship between spatial discretization, temporal discretization, and Fourier spectral behavior.\n\nDerivation of the Lax–Wendroff scheme:\nStarting from the Taylor expansion in time,\n$$\nu(x, t+\\Delta t) = u(x,t) + \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\mathcal{O}((\\Delta t)^3).\n$$\nFrom the partial differential equation (PDE) $u_t = -a u_x$. Differentiating once more gives $u_{tt} = -a u_{xt} = -a(-a u_{xx}) = a^2 u_{xx}$, assuming sufficient smoothness. On a uniform grid with spacing $\\Delta x$, approximate $u_x$ and $u_{xx}$ at grid point $x_j$ by centered differences,\n$$\nu_x(x_j, t) \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x}, \\quad\nu_{xx}(x_j, t) \\approx \\frac{u_{j+1}^n - 2 u_j^n + u_{j-1}^n}{(\\Delta x)^2}.\n$$\nSubstituting into the Taylor expansion, defining the Courant number $\\lambda = a \\Delta t / \\Delta x$, yields the two-step Lax–Wendroff scheme:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{\\lambda^2}{2}\\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right).\n$$\nThis scheme is second-order accurate in both space and time and is conditionally stable for $|\\lambda| \\leq 1$.\n\nFourier analysis and aliasing:\nFor a periodic discretization with $N$ points and spacing $\\Delta x = 1/N$, the discrete wavenumbers are given by the set produced by the Discrete Fourier Transform (DFT), with corresponding angular wavenumbers $k = 2\\pi \\cdot \\mathrm{fftfreq}(N, \\Delta x)$. The Nyquist wavenumber is $k_{\\mathrm{N}} = \\pi/\\Delta x$. When sampling a continuous mode $u(x) = \\sin(2\\pi k^\\star x)$ whose integer wavenumber $k^\\star$ exceeds $N/2$, aliasing arises because the discrete spectrum repeats every $N$ modes:\n$$\nk_{\\mathrm{alias}} = k^\\star - N \\cdot \\mathrm{round}\\left(\\frac{k^\\star}{N}\\right),\n$$\nwhich maps $k^\\star$ into the principal interval $[-N/2, N/2)$. The diagnostic is to compute the DFT of the sampled signal and identify the dominant peak; this peak should occur at $k_{\\mathrm{alias}}$.\n\nSpectral filters and second-order preservation:\nWe propose two filters applied in Fourier space after each time step:\n\n1. Exponential filter. Define\n$$\nG_{\\exp}(k) = \\exp\\left(-\\alpha \\left|\\frac{k}{k_{\\max}}\\right|^m\\right),\n$$\nwith $m \\geq 2$ and $\\alpha > 0$. For small wavenumbers, the Taylor series yields\n$$\nG_{\\exp}(k) = 1 - \\alpha \\left|\\frac{k}{k_{\\max}}\\right|^m + \\mathcal{O}\\left(\\left|\\frac{k}{k_{\\max}}\\right|^{2m}\\right).\n$$\nBecause $k_{\\max} = \\pi/\\Delta x$ in magnitude, the deviation from unity at low $|k|$ scales as\n$1 - G_{\\exp}(k) = \\mathcal{O}((k \\Delta x)^m)$.\nIf $m \\geq 2$, the filter perturbs low wavenumbers by at most second order in $\\Delta x$, thereby preserving the second-order accuracy of Lax–Wendroff for smooth solutions.\n\n2. Raised-cosine low-pass filter. Define\n$$\nG_{\\mathrm{rc}}(k) =\n\\begin{cases}\n1,  |k| \\leq k_c, \\\\\n\\frac{1}{2}\\left[1 + \\cos\\left(\\pi \\frac{|k| - k_c}{k_{\\max} - k_c}\\right)\\right],  k_c  |k| \\leq k_{\\max}, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nwith $k_c = \\gamma k_{\\max}$ for $0  \\gamma  1$. This filter leaves all Fourier modes below the cutoff unchanged ($G_{\\mathrm{rc}}(k) = 1$ for $|k| \\leq k_c$), ensuring no distortion at the low wavenumbers. The smooth taper reduces high-wavenumber content near $k_{\\max}$ responsible for Gibbs-type ringing. Because the filter is exact identity in a low-wavenumber band, and the solution’s error for second-order schemes is dominated by truncation error that scales with $(k \\Delta x)^2$, the raised-cosine filter preserves second-order accuracy provided the solution is spectrally well-resolved within the passband.\n\nRinging in Lax–Wendroff:\nThe Lax–Wendroff scheme is dispersive. For a mode $u_j^n = \\hat{u}^n e^{i j \\theta}$ with $\\theta = k \\Delta x$, the amplification factor is\n$$\nA(\\theta) = 1 - i \\lambda \\sin\\theta - \\lambda^2(1 - \\cos\\theta).\n$$\nThe argument of $A(\\theta)$ modifies the phase speed relative to the exact $a$, and the real part introduces weak dissipation for $\\lambda \\neq 0$. Dispersive errors cause oscillatory overshoots near discontinuities (ringing), reminiscent of the Gibbs phenomenon. Spectral filtering that damps high wavenumbers near $k_{\\mathrm{N}}$ reduces these oscillations while leaving resolved scales unchanged.\n\nAlgorithmic design:\n- Implement the Lax–Wendroff time step using periodic array shifts.\n- Implement flexible spectral filtering by computing the FFT of the field, multiplying by the transfer function $G(k)$, and inverse FFT to return to physical space; take the real part to counteract numerical round-off.\n- For aliasing, construct a high-frequency mode with integer wavenumber $k^\\star > N/2$, sample it, and verify that the FFT dominant peak occurs at the predicted aliased index $k_{\\mathrm{alias}}$.\n- For ringing, use a top-hat initial condition with sharp edges and advect for a finite time. Measure overshoot $\\delta_{\\mathrm{ring}} = \\max u - 1$, comparing no filter versus filtered evolutions.\n- For accuracy, use a smooth sinusoidal mode $u(x) = \\sin(2\\pi k_0 x)$ with $k_0$ well below the Nyquist wavenumber, integrate for one period $T = 1/a$, and compute $\\ell^2$ errors across $N = 64, 128, 256$. Estimate observed orders $p_{\\mathrm{est}}$ by log ratios of errors and grid spacings.\n\nDesign choices for the test suite:\n- Test $1$: Choose $N = 32$ and $k^\\star = 20$ to ensure $k^\\star > N/2$ and thus aliasing. The predicted alias is $k_{\\mathrm{alias}} = 20 - 32 = -12$.\n- Test $2$: Choose $\\lambda = 0.8$ and $T = 0.3$ to produce noticeable dispersive ripples; the exponential filter uses $\\alpha = 36$ and $m = 8$ to strongly damp near-Nyquist modes while preserving low-k content to $\\mathcal{O}(\\Delta x^8)$; the raised-cosine uses $\\gamma = 0.7$ to begin tapering at $70\\%$ of $k_{\\max}$.\n- Test $3$: Choose $k_0 = 3$ to keep the mode well resolved at all grid sizes. Compute errors for none, exponential, and raised-cosine filters at $N = 64, 128, 256$, and derive $p_{\\mathrm{est}}$ between successive pairs, validating $\\mathcal{O}(\\Delta x^2)$ for filters tuned to minimally affect low-k behavior.\n\nNumerical units and output:\n- All outputs are dimensionless floats; angles are treated via radians internally by the FFT conventions.\n- The required final output is a single line with a comma-separated list enclosed in square brackets. The entries are ordered as follows: one boolean from Test $1$, three floats from Test $2$, and six floats from Test $3$, making a total of $10$ entries.\n\nThis principle-based design integrates the Fourier description of aliasing, the dispersive behavior of Lax–Wendroff, and filter transfer-function constraints needed to preserve second-order accuracy, yielding a comprehensive computational diagnostic of aliasing and ringing together with quantitative accuracy assessments.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef lax_wendroff_step(u, a, dx, dt):\n    \"\"\"One time step of the Lax–Wendroff scheme on a periodic grid.\"\"\"\n    lam = a * dt / dx\n    u_plus = np.roll(u, -1)\n    u_minus = np.roll(u, 1)\n    return u - 0.5 * lam * (u_plus - u_minus) + 0.5 * (lam ** 2) * (u_plus - 2.0 * u + u_minus)\n\ndef exponential_filter(u, dx, alpha=36.0, m=8):\n    \"\"\"Apply an exponential spectral filter to u.\"\"\"\n    N = u.size\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n    kmax = np.max(np.abs(k))\n    if kmax == 0.0:\n        return u.copy()\n    G = np.exp(-alpha * (np.abs(k) / kmax) ** m)\n    uhat = np.fft.fft(u)\n    uhat_filtered = G * uhat\n    u_filtered = np.fft.ifft(uhat_filtered).real\n    return u_filtered\n\ndef raised_cosine_filter(u, dx, gamma=0.7):\n    \"\"\"Apply a raised-cosine low-pass spectral filter to u.\"\"\"\n    N = u.size\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n    kabs = np.abs(k)\n    kmax = np.max(kabs)\n    if kmax == 0.0:\n        return u.copy()\n    kc = gamma * kmax\n    G = np.ones_like(kabs)\n    mask = (kabs  kc)  (kabs = kmax)\n    # Smooth taper from kc to kmax\n    G[mask] = 0.5 * (1.0 + np.cos(np.pi * (kabs[mask] - kc) / (kmax - kc)))\n    # At exactly kmax, ensure zero to avoid wrap-around noise\n    G[kabs = kmax] = 0.0\n    uhat = np.fft.fft(u)\n    uhat_filtered = G * uhat\n    u_filtered = np.fft.ifft(uhat_filtered).real\n    return u_filtered\n\ndef apply_filter(u, dx, ftype=None, params=None):\n    \"\"\"Dispatch filter application based on type.\"\"\"\n    if ftype is None:\n        return u\n    params = params or {}\n    if ftype == \"exp\":\n        return exponential_filter(u, dx, **params)\n    elif ftype == \"rc\":\n        return raised_cosine_filter(u, dx, **params)\n    else:\n        # Unknown filter type: no-op\n        return u\n\ndef simulate(u0_func, N, a, T, cfl, ftype=None, fparams=None):\n    \"\"\"Simulate advection using Lax–Wendroff with optional spectral filtering.\"\"\"\n    L = 1.0\n    x = np.linspace(0.0, L, N, endpoint=False)\n    dx = L / N\n    dt = cfl * dx / a\n    # Choose integer steps and adjust dt to hit T exactly\n    nsteps = max(1, int(np.ceil(T / dt)))\n    dt = T / nsteps\n    u = u0_func(x)\n    for _ in range(nsteps):\n        u = lax_wendroff_step(u, a, dx, dt)\n        u = apply_filter(u, dx, ftype, fparams)\n    return x, u\n\ndef aliasing_test(N, k_star):\n    \"\"\"Diagnose aliasing: return 1.0 if dominant DFT peak equals predicted alias index, else 0.0.\"\"\"\n    L = 1.0\n    dx = L / N\n    x = np.linspace(0.0, L, N, endpoint=False)\n    u = np.sin(2.0 * np.pi * k_star * x)\n    uhat = np.fft.fft(u)\n    # Dominant peak index (exclude zero mode to avoid trivial cases)\n    amps = np.abs(uhat)\n    # Zero-out DC if present to avoid dominating at k=0 for certain shapes\n    amps[0] = 0.0\n    k_peak_index = int(np.argmax(amps))\n    # Convert FFT index to signed integer wavenumber in [-N/2, N/2)\n    k_signed = k_peak_index if k_peak_index  N // 2 else k_peak_index - N\n    # Predicted alias\n    k_alias = int(round(k_star - N * round(k_star / N)))\n    return 1.0 if k_signed == k_alias else 0.0\n\ndef top_hat(x, center, halfwidth):\n    \"\"\"Top-hat initial condition with amplitude 1.\"\"\"\n    # Periodic interval handling: consider shortest periodic distance to center\n    L = 1.0\n    dx_periodic = np.minimum(np.abs(x - center), L - np.abs(x - center))\n    return (dx_periodic = halfwidth).astype(float)\n\ndef sine_ic(k0):\n    \"\"\"Smooth sinusoidal initial condition u(x) = sin(2*pi*k0*x).\"\"\"\n    def u0(x):\n        return np.sin(2.0 * np.pi * k0 * x)\n    return u0\n\ndef l2_error(u_num, u_exact, dx):\n    \"\"\"Discrete L2 norm of error.\"\"\"\n    return np.sqrt(dx * np.sum((u_num - u_exact) ** 2))\n\ndef exact_shift(u0_func, x, a, T):\n    \"\"\"Exact solution equals u0 shifted by a*T with periodic wraparound.\"\"\"\n    L = 1.0\n    shift = (x - a * T) % L\n    return u0_func(shift)\n\ndef ringing_metric(N, a, cfl, T, x0, w, filter_spec=None):\n    \"\"\"Compute overshoot above amplitude 1 for a top-hat advected for time T.\"\"\"\n    L = 1.0\n    x = np.linspace(0.0, L, N, endpoint=False)\n    u0 = top_hat(x, x0, w)\n    dx = L / N\n    dt = cfl * dx / a\n    nsteps = max(1, int(np.ceil(T / dt)))\n    dt = T / nsteps\n    u = u0.copy()\n    for _ in range(nsteps):\n        u = lax_wendroff_step(u, a, dx, dt)\n        if filter_spec is not None:\n            u = apply_filter(u, dx, filter_spec[\"type\"], filter_spec.get(\"params\", {}))\n    # Overshoot relative to exact amplitude 1 inside the advected top-hat\n    overshoot = float(np.max(u) - 1.0)\n    return overshoot\n\ndef accuracy_orders(a, cfl, T, k0, Ns, filters):\n    \"\"\"Compute observed orders between successive Ns for given filters.\"\"\"\n    orders = []\n    for f in filters:\n        errors = []\n        for N in Ns:\n            u0f = sine_ic(k0)\n            x, u_num = simulate(u0f, N, a, T, cfl, f.get(\"type\", None), f.get(\"params\", None))\n            dx = 1.0 / N\n            u_exact = exact_shift(u0f, x, a, T)\n            E = l2_error(u_num, u_exact, dx)\n            errors.append(E)\n        # Compute orders between successive Ns: (N1-N2), (N2-N3)\n        for i in range(len(Ns) - 1):\n            dx1 = 1.0 / Ns[i]\n            dx2 = 1.0 / Ns[i + 1]\n            E1 = errors[i]\n            E2 = errors[i + 1]\n            # Avoid log of zero: if E2 or E1 is zero, set order to a large number to indicate high convergence\n            if E1  0 and E2  0:\n                p_est = np.log(E1 / E2) / np.log(dx1 / dx2)\n            else:\n                p_est = float('inf')\n            orders.append(float(p_est))\n    return orders\n\ndef solve():\n    results = []\n    # Test 1: Aliasing on coarse grid\n    N_alias = 32\n    k_star = 20\n    alias_ok = aliasing_test(N_alias, k_star)\n    results.append(alias_ok)\n\n    # Test 2: Ringing suppression metrics\n    N_ring = 64\n    a = 1.0\n    cfl = 0.8\n    T_ring = 0.3\n    x0 = 0.25\n    w = 0.05\n    # No filter\n    ring_none = ringing_metric(N_ring, a, cfl, T_ring, x0, w, filter_spec=None)\n    results.append(ring_none)\n    # Exponential filter\n    ring_exp = ringing_metric(\n        N_ring, a, cfl, T_ring, x0, w,\n        filter_spec={\"type\": \"exp\", \"params\": {\"alpha\": 36.0, \"m\": 8}}\n    )\n    results.append(ring_exp)\n    # Raised-cosine filter\n    ring_rc = ringing_metric(\n        N_ring, a, cfl, T_ring, x0, w,\n        filter_spec={\"type\": \"rc\", \"params\": {\"gamma\": 0.7}}\n    )\n    results.append(ring_rc)\n\n    # Test 3: Accuracy scaling orders\n    Ns = [64, 128, 256]\n    T_acc = 1.0\n    k0 = 3\n    filters = [\n        {\"type\": None, \"params\": None},                  # None\n        {\"type\": \"exp\", \"params\": {\"alpha\": 36.0, \"m\": 8}},  # Exponential\n        {\"type\": \"rc\", \"params\": {\"gamma\": 0.7}},           # Raised-cosine\n    ]\n    orders = accuracy_orders(a, cfl, T_acc, k0, Ns, filters)\n    results.extend(orders)\n\n    # Final print statement in the exact required format.\n    # Ensure finite representation for 'inf' if it appears; but specs require floats, so we keep default.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}