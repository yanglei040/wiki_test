{
    "hands_on_practices": [
        {
            "introduction": "The formal order of accuracy is a key metric for any numerical scheme, but understanding the character of its error is just as crucial for predicting its behavior in a real simulation. This exercise guides you through a local truncation error (LTE) analysis for the classic second-order Lax-Wendroff scheme. By meticulously applying Taylor series expansions, you will not only verify its second-order accuracy but also uncover the nature of its leading error term, which reveals the scheme's famously dispersive properties that can lead to oscillatory artifacts. ",
            "id": "3603413",
            "problem": "In one spatial dimension, consider the constant-coefficient linear advection equation $u_{t} + a\\,u_{x} = 0$ with a constant advection speed $a0$. Let the spatial grid points be $x_{j} = j\\,\\Delta x$ and time levels be $t_{n} = n\\,\\Delta t$, with the Courant number defined by $\\nu = a\\,\\Delta t / \\Delta x$. The two-step Lax-Wendroff scheme is implemented in its standard single-step conservative form:\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\Big(u_{j+1}^{n} - u_{j-1}^{n}\\Big) \\;+\\; \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\Big(u_{j+1}^{n} - 2\\,u_{j}^{n} + u_{j-1}^{n}\\Big).\n$$\nDefine the local truncation error $\\tau_{j}^{n}$ by\n$$\n\\tau_{j}^{n} \\;=\\; \\frac{1}{\\Delta t}\\,\\Big(u(x_{j},t_{n+1}) \\;-\\; \\Big[u_{j}^{n} \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\big(u_{j+1}^{n} - u_{j-1}^{n}\\big) \\;+\\; \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\big(u_{j+1}^{n} - 2\\,u_{j}^{n} + u_{j-1}^{n}\\big)\\Big]\\Big),\n$$\nwhere $u(x,t)$ is the exact solution of the partial differential equation. Starting from the partial differential equation and Taylor expansions in space and time, and eliminating time derivatives using the partial differential equation, perform a local truncation error analysis. Show that $\\tau_{j}^{n} = O(\\Delta t^{2}, \\Delta x^{2})$ and that, when $\\nu = O(1)$, the leading dispersive contribution is proportional to $\\Delta x^{2}\\,u_{xxx}$. \n\nReport your final answer as the coefficient $C(a,\\nu)$ multiplying $\\Delta x^{2}\\,u_{xxx}$ in the leading-order term of $\\tau_{j}^{n}$, defined by writing\n$$\n\\tau_{j}^{n} \\;=\\; C(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx}(x_{j},t_{n}) \\;+\\; \\text{higher-order terms}.\n$$\nYour final answer must be a single, closed-form analytic expression in terms of $a$ and $\\nu$ only. No numerical evaluation is required, and no units are needed.",
            "solution": "The problem is valid as it is a well-posed, scientifically grounded question in the field of numerical analysis for partial differential equations. All necessary information is provided, and the objective is clearly defined.\n\nThe local truncation error, $\\tau_{j}^{n}$, is defined by applying the finite difference operator to the exact solution $u(x,t)$ of the partial differential equation (PDE). The given definition is\n$$\n\\tau_{j}^{n} = \\frac{1}{\\Delta t} \\left( u(x_{j}, t_{n+1}) - \\left[ u(x_{j},t_{n}) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u(x_{j+1},t_{n}) - u(x_{j-1},t_{n})\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u(x_{j+1},t_{n}) - 2\\,u(x_j, t_n) + u(x_{j-1},t_{n})\\right) \\right] \\right)\n$$\nwhere $u(x,t)$ is the exact solution, and all terms are evaluated at the specified grid points. For simplicity, we denote $u(x_{j}, t_{n})$ as $u$ and will expand all other terms in a Taylor series around the point $(x_{j}, t_{n})$. Partial derivatives with respect to $x$ and $t$ will be denoted by subscripts, e.g., $u_{x} = \\frac{\\partial u}{\\partial x}$ and $u_{t} = \\frac{\\partial u}{\\partial t}$, all evaluated at $(x_j, t_n)$.\n\nFirst, we expand the exact solution term $u(x_{j}, t_{n+1})$ in a Taylor series in time around $t_{n}$:\n$$\nu(x_{j}, t_{n+1}) = u(x_{j}, t_{n} + \\Delta t) = u + \\Delta t \\, u_{t} + \\frac{\\Delta t^{2}}{2} \\, u_{tt} + \\frac{\\Delta t^{3}}{6} \\, u_{ttt} + O(\\Delta t^{4})\n$$\nThe governing PDE is $u_{t} + a\\,u_{x} = 0$, or $u_{t} = -a\\,u_{x}$. We can express higher-order time derivatives in terms of spatial derivatives by repeatedly differentiating the PDE and assuming sufficient smoothness of $u(x,t)$:\n$$\nu_{t} = -a \\, u_{x}\n$$\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(-a\\,u_{x}) = -a\\,u_{xt} = -a\\,\\frac{\\partial}{\\partial x}(u_{t}) = -a\\,\\frac{\\partial}{\\partial x}(-a\\,u_{x}) = a^{2}\\,u_{xx}\n$$\n$$\nu_{ttt} = \\frac{\\partial}{\\partial t}(a^{2}\\,u_{xx}) = a^{2}\\,u_{xxt} = a^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}}(u_{t}) = a^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}}(-a\\,u_{x}) = -a^{3}\\,u_{xxx}\n$$\nSubstituting these back into the expansion for $u(x_{j}, t_{n+1})$ yields:\n$$\nu(x_{j}, t_{n+1}) = u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} + O(\\Delta t^{4})\n$$\n\nNext, we analyze the numerical scheme part of the error expression. We require Taylor series expansions in space for $u(x_{j\\pm 1}, t_{n})$ around $x_{j}$:\n$$\nu(x_{j+1}, t_{n}) = u + \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} + \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} + O(\\Delta x^{5})\n$$\n$$\nu(x_{j-1}, t_{n}) = u - \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} - \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} + O(\\Delta x^{5})\n$$\nThe terms in the numerical scheme can be expressed using these expansions:\nThe central difference for the first derivative:\n$$\nu(x_{j+1},t_{n}) - u(x_{j-1},t_{n}) = 2\\,\\Delta x\\,u_{x} + \\frac{\\Delta x^{3}}{3}\\,u_{xxx} + O(\\Delta x^{5})\n$$\nThe central difference for the second derivative:\n$$\nu(x_{j+1},t_{n}) - 2\\,u(x_{j},t_{n}) + u(x_{j-1},t_{n}) = \\Delta x^{2}\\,u_{xx} + \\frac{\\Delta x^{4}}{12}\\,u_{xxxx} + O(\\Delta x^{6})\n$$\nLet $L_{\\Delta t}(u)$ denote the numerical operator applied to the exact solution:\n$$\nL_{\\Delta t}(u) = u - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u(x_{j+1},t_{n}) - u(x_{j-1},t_{n})\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u(x_{j+1},t_{n}) - 2\\,u(x_j, t_n) + u(x_{j-1},t_{n})\\right)\n$$\nSubstituting the spatial expansions gives:\n$$\nL_{\\Delta t}(u) = u - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(2\\,\\Delta x\\,u_{x} + \\frac{\\Delta x^{3}}{3}\\,u_{xxx} + \\dots\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(\\Delta x^{2}\\,u_{xx} + \\frac{\\Delta x^{4}}{12}\\,u_{xxxx} + \\dots\\right)\n$$\nSimplifying the coefficients:\n$$\nL_{\\Delta t}(u) = u - a\\,\\Delta t\\,u_{x} - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} + \\frac{a^{2}\\,\\Delta t^{2}\\,\\Delta x^{2}}{24}\\,u_{xxxx} + \\text{H.O.T.}\n$$\nwhere H.O.T. represents higher-order terms.\n\nNow we can compute the truncation error. From the definition, $\\Delta t\\,\\tau_{j}^{n} = u(x_{j}, t_{n+1}) - L_{\\Delta t}(u)$.\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} + \\dots \\right) - \\left( u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\dots \\right)\n$$\nThe terms up to second order cancel out, as expected for a second-order scheme:\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} \\right) - \\left( - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} \\right) + \\text{H.O.T.}\n$$\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6} - \\frac{a^{3}\\,\\Delta t^{3}}{6} \\right) u_{xxx} + \\text{H.O.T.}\n$$\nDividing by $\\Delta t$ to find $\\tau_{j}^{n}$:\n$$\n\\tau_{j}^{n} = \\left( \\frac{a\\,\\Delta x^{2}}{6} - \\frac{a^{3}\\,\\Delta t^{2}}{6} \\right) u_{xxx} + \\text{H.O.T.}\n$$\nThis confirms that the scheme is formally second-order accurate, i.e., $\\tau_{j}^{n} = O(\\Delta x^{2}, \\Delta t^{2})$, because if $\\Delta t \\propto \\Delta x$, both terms are $O(\\Delta x^2)$. The leading error term is proportional to $u_{xxx}$, which is a dispersive error term.\n\nTo express the coefficient in terms of $a$ and the Courant number $\\nu = a\\,\\Delta t/\\Delta x$, we factor out $\\frac{a\\,\\Delta x^{2}}{6}$ from the leading term:\n$$\n\\tau_{j}^{n} = \\frac{a\\,\\Delta x^{2}}{6} \\left( 1 - \\frac{a^{2}\\,\\Delta t^{2}}{\\Delta x^{2}} \\right) u_{xxx} + \\text{H.O.T.}\n$$\nRecognizing that $\\nu^{2} = (a\\,\\Delta t/\\Delta x)^{2} = a^{2}\\,\\Delta t^{2}/\\Delta x^{2}$, we have:\n$$\n\\tau_{j}^{n} = \\frac{a\\,\\Delta x^{2}}{6} (1 - \\nu^{2}) u_{xxx} + \\text{H.O.T.}\n$$\nThe problem defines the leading error term as $C(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx}(x_{j},t_{n})$. By comparing this form with our derived expression, we can identify the coefficient $C(a,\\nu)$:\n$$\nC(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx} = \\frac{a}{6} (1 - \\nu^{2}) \\Delta x^{2}\\,u_{xxx}\n$$\nTherefore, the coefficient is:\n$$\nC(a,\\nu) = \\frac{a}{6}(1 - \\nu^{2})\n$$\nThis is the desired closed-form analytic expression in terms of $a$ and $\\nu$. The error vanishes when $\\nu=1$, in which case the Lax-Wendroff scheme is exact for the constant-coefficient linear advection equation.",
            "answer": "$$\\boxed{\\frac{a}{6}(1 - \\nu^{2})}$$"
        },
        {
            "introduction": "In geophysical modeling, ensuring the conservation of fundamental physical quantities like mass or energy is often a paramount concern for the long-term stability and physical realism of a simulation. This practice highlights the critical distinction between discretizing the conservative (flux) form of a PDE versus its non-conservative (advective) form, a subtlety that becomes vital when coefficients like velocity are spatially variable. You will analytically derive the exact amount of mass conservation error produced by a non-conservative scheme, providing a stark demonstration of why conservative finite volume methods are foundational in computational geophysics. ",
            "id": "3603345",
            "problem": "Consider one-dimensional advection of a passive scalar $q(x,t)$ by a spatially variable velocity $a(x)$ on a periodic interval. The physically correct conservation law is the flux form $ \\partial_t q + \\partial_x(a(x)\\,q) = 0$, which expresses conservation of tracer mass on a periodic domain. In computational geophysics, both conservative and nonconservative high-order advection schemes are used; however, only conservative schemes preserve discrete mass exactly when $a(x)$ varies.\n\nLet the domain be periodic with $x \\in [0,2\\pi]$, discretized by a uniform grid of $N$ points with spacing $\\Delta x$ such that $N\\,\\Delta x = 2\\pi$ and $x_j = j\\,\\Delta x$ for integer $j$. The initial tracer is $q(x,0) = \\sin(x)$, sampled exactly so that $q_j^0 = \\sin(x_j)$, and the velocity field is $a(x) = 1 + \\epsilon \\cos(x)$, sampled so that $a_j = 1 + \\epsilon \\cos(x_j)$, where $\\epsilon$ is a small, dimensionless amplitude.\n\nTwo single-step schemes are to be applied for one time step $\\Delta t$:\n- A conservative local Lax–Friedrichs (also known as Rusanov) flux-form scheme for the conservation law $ \\partial_t q + \\partial_x(a\\,q) = 0$,\n$$\nq_j^{1} = q_j^{0} - \\frac{\\Delta t}{\\Delta x}\\big(F_{j+1/2}^{0} - F_{j-1/2}^{0}\\big), \\quad F_{j+1/2}^{0} = \\frac{1}{2}\\big(a_j q_j^{0} + a_{j+1} q_{j+1}^{0}\\big) - \\frac{1}{2}\\,\\alpha_{j+1/2}\\big(q_{j+1}^{0} - q_j^{0}\\big),\n$$\nwith the local dissipation $\\alpha_{j+1/2} = \\max\\{|a_j|,|a_{j+1}|\\}$.\n- A nonconservative second-order Lax–Wendroff scheme applied to the advective form $ \\partial_t q + a(x)\\,\\partial_x q = 0$ by Taylor expansion in time while neglecting spatial derivatives of $a(x)$,\n$$\nq_j^{1} = q_j^{0} - \\Delta t\\, a_j\\,D_x q_j^{0} + \\frac{(\\Delta t)^2}{2}\\,a_j^{2}\\,D_{xx} q_j^{0},\n$$\nwhere $D_x q_j^{0} = \\frac{q_{j+1}^{0} - q_{j-1}^{0}}{2\\,\\Delta x}$ and $D_{xx} q_j^{0} = \\frac{q_{j+1}^{0} - 2 q_j^{0} + q_{j-1}^{0}}{\\Delta x^{2}}$ are the centered first and second differences, respectively.\n\nDefine the discrete mass at time level $n$ as $M^{n} = \\Delta x \\sum_{j=0}^{N-1} q_j^{n}$. Using only the fundamental conservation law, the periodicity of the domain, and exact discrete algebra on the grid, compare the conservative and nonconservative updates for one time step $\\Delta t$ on the given initial data and velocity. Derive a closed-form analytic expression for the net discrete mass change after one time step produced by the nonconservative Lax–Wendroff update,\n$$\n\\Delta M_{\\text{noncons}} = M^{1} - M^{0},\n$$\nin terms of $\\epsilon$, $\\Delta t$, and $\\Delta x$. You may use trigonometric identities that are valid pointwise on the grid, but do not replace sums by integrals. The domain, tracer, and velocity are dimensionless, so no physical units apply. Report only the single expression for $\\Delta M_{\\text{noncons}}$ as your final answer. No rounding is required.",
            "solution": "The problem asks for an analysis of discrete mass conservation for two numerical schemes applied to the one-dimensional advection equation on a periodic domain. The primary goal is to derive an expression for the change in discrete mass after one time step for the nonconservative Lax-Wendroff scheme.\n\nFirst, let's define the discrete mass at a given time level $n$ as $M^n = \\Delta x \\sum_{j=0}^{N-1} q_j^n$. The change in mass after one time step is $\\Delta M = M^1 - M^0$.\n\nLet's briefly analyze the conservative Lax-Friedrichs scheme. The update is given by $q_j^1 = q_j^0 - \\frac{\\Delta t}{\\Delta x}(F_{j+1/2}^0 - F_{j-1/2}^0)$. The change in total mass is:\n$$\n\\Delta M_{\\text{cons}} = M^1 - M^0 = \\Delta x \\sum_{j=0}^{N-1} (q_j^1 - q_j^0) = \\Delta x \\sum_{j=0}^{N-1} \\left[ -\\frac{\\Delta t}{\\Delta x}(F_{j+1/2}^0 - F_{j-1/2}^0) \\right]\n$$\n$$\n\\Delta M_{\\text{cons}} = -\\Delta t \\sum_{j=0}^{N-1} (F_{j+1/2}^0 - F_{j-1/2}^0)\n$$\nThis is a telescoping sum over a periodic domain. Let's write out the terms:\n$$\n\\sum_{j=0}^{N-1} (F_{j+1/2}^0 - F_{j-1/2}^0) = (F_{1/2}^0 - F_{-1/2}^0) + (F_{3/2}^0 - F_{1/2}^0) + \\dots + (F_{N-1/2}^0 - F_{N-3/2}^0) + (F_{N+1/2}^0 - F_{N-1/2}^0)\n$$\nDue to periodicity, index $j+N$ is equivalent to index $j$. Thus, $F_{N+1/2}^0 = F_{1/2}^0$ and $F_{-1/2}^0 = F_{N-1/2}^0$. The sum telescopes to $F_{N-1+1/2}^0 - F_{-1/2}^0 = F_{N-1/2}^0 - F_ {N-1/2}^0 = 0$.\nThus, $\\Delta M_{\\text{cons}} = 0$. The conservative scheme, by virtue of its flux-difference form, exactly preserves the discrete mass on a periodic domain, regardless of the initial data or velocity field. This is consistent with the physics of the conservation law $\\partial_t q + \\partial_x(aq) = 0$.\n\nNow, we turn to the nonconservative Lax-Wendroff scheme. The update is:\n$$\nq_j^1 = q_j^0 - \\Delta t\\, a_j\\,D_x q_j^0 + \\frac{(\\Delta t)^2}{2}\\,a_j^2\\,D_{xx} q_j^0\n$$\nThe change in discrete mass is:\n$$\n\\Delta M_{\\text{noncons}} = M^1 - M^0 = \\Delta x \\sum_{j=0}^{N-1} (q_j^1 - q_j^0) = \\Delta x \\sum_{j=0}^{N-1} \\left( -\\Delta t\\, a_j\\,D_x q_j^0 + \\frac{(\\Delta t)^2}{2}\\,a_j^2\\,D_{xx} q_j^0 \\right)\n$$\nWe can analyze the two terms in the sum separately. The key is to use the property of summation by parts on a periodic grid. For any two grid functions $u_j$ and $v_j$:\n$$\n\\sum_{j=0}^{N-1} u_j (D_x v_j) = -\\sum_{j=0}^{N-1} (D_x u_j) v_j\n$$\n$$\n\\sum_{j=0}^{N-1} u_j (D_{xx} v_j) = \\sum_{j=0}^{N-1} (D_{xx} u_j) v_j\n$$\nApplying these identities to the expression for $\\Delta M_{\\text{noncons}}$ with $u=a_j$ or $u=a_j^2$ and $v=q_j^0$:\n$$\n\\Delta M_{\\text{noncons}} = \\Delta x \\left( -\\Delta t \\sum_{j=0}^{N-1} a_j D_x q_j^0 + \\frac{(\\Delta t)^2}{2} \\sum_{j=0}^{N-1} a_j^2 D_{xx} q_j^0 \\right)\n$$\n$$\n\\Delta M_{\\text{noncons}} = \\Delta x \\left( -\\Delta t \\left( -\\sum_{j=0}^{N-1} (D_x a_j) q_j^0 \\right) + \\frac{(\\Delta t)^2}{2} \\sum_{j=0}^{N-1} (D_{xx} a_j^2) q_j^0 \\right)\n$$\n$$\n\\Delta M_{\\text{noncons}} = \\Delta t \\Delta x \\sum_{j=0}^{N-1} (D_x a_j) q_j^0 + \\frac{(\\Delta t)^2 \\Delta x}{2} \\sum_{j=0}^{N-1} (D_{xx} a_j^2) q_j^0\n$$\nNow, we must compute the discrete derivatives of $a_j = 1 + \\epsilon \\cos(x_j)$ and $a_j^2$ and then evaluate the sums.\n\nThe first term requires $D_x a_j$:\n$$\nD_x a_j = \\frac{a_{j+1} - a_{j-1}}{2\\Delta x} = \\frac{(1 + \\epsilon \\cos(x_{j+1})) - (1 + \\epsilon \\cos(x_{j-1}))}{2\\Delta x} = \\frac{\\epsilon}{2\\Delta x} (\\cos(x_j+\\Delta x) - \\cos(x_j-\\Delta x))\n$$\nUsing the identity $\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$:\n$$\nD_x a_j = \\frac{\\epsilon}{2\\Delta x}(-2\\sin(x_j)\\sin(\\Delta x)) = -\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x} \\sin(x_j)\n$$\nThe second term requires $D_{xx} a_j^2$:\n$$\na_j^2 = (1 + \\epsilon\\cos(x_j))^2 = 1 + 2\\epsilon\\cos(x_j) + \\epsilon^2 \\cos^2(x_j) = 1 + 2\\epsilon\\cos(x_j) + \\frac{\\epsilon^2}{2}(1 + \\cos(2x_j))\n$$\nWe need to apply the second difference operator $D_{xx} f_j = \\frac{f_{j+1} - 2f_j + f_{j-1}}{(\\Delta x)^2}$. For a function $f_j = \\cos(kx_j)$:\n$$\nD_{xx}\\cos(kx_j) = \\frac{\\cos(k(x_j+\\Delta x)) - 2\\cos(kx_j) + \\cos(k(x_j-\\Delta x))}{(\\Delta x)^2} = \\frac{2\\cos(kx_j)\\cos(k\\Delta x) - 2\\cos(kx_j)}{(\\Delta x)^2} = \\frac{2\\cos(kx_j)(\\cos(k\\Delta x)-1)}{(\\Delta x)^2}\n$$\nUsing the identity $\\cos(\\theta) - 1 = -2\\sin^2(\\theta/2)$:\n$$\nD_{xx}\\cos(kx_j) = \\frac{2\\cos(kx_j)(-2\\sin^2(k\\Delta x/2))}{(\\Delta x)^2} = -\\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2}\\cos(kx_j)\n$$\nApplying this to $a_j^2$:\n$$\nD_{xx} a_j^2 = 2\\epsilon D_{xx}\\cos(x_j) + \\frac{\\epsilon^2}{2}D_{xx}\\cos(2x_j)\n$$\n$$\nD_{xx} a_j^2 = 2\\epsilon\\left(-\\frac{4\\sin^2(\\Delta x/2)}{(\\Delta x)^2}\\cos(x_j)\\right) + \\frac{\\epsilon^2}{2}\\left(-\\frac{4\\sin^2(2\\Delta x/2)}{(\\Delta x)^2}\\cos(2x_j)\\right)\n$$\n$$\nD_{xx} a_j^2 = -\\frac{8\\epsilon \\sin^2(\\Delta x/2)}{(\\Delta x)^2}\\cos(x_j) - \\frac{2\\epsilon^2 \\sin^2(\\Delta x)}{(\\Delta x)^2}\\cos(2x_j)\n$$\nNow substitute these derivatives and $q_j^0 = \\sin(x_j)$ into the expression for $\\Delta M_{\\text{noncons}}$:\n$$\n\\Delta M_{\\text{noncons}} = \\Delta t \\Delta x \\sum_{j=0}^{N-1} \\left(-\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x} \\sin(x_j)\\right) \\sin(x_j) + \\frac{(\\Delta t)^2 \\Delta x}{2} \\sum_{j=0}^{N-1} (D_{xx} a_j^2) \\sin(x_j)\n$$\nLet's analyze the sums.\nThe first summation term is:\n$$\n\\sum_{j=0}^{N-1} \\left(-\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x}\\right) \\sin^2(x_j) = -\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x} \\sum_{j=0}^{N-1} \\sin^2(x_j)\n$$\nThe second summation is:\n$$\n\\sum_{j=0}^{N-1} \\left(-\\frac{8\\epsilon \\sin^2(\\Delta x/2)}{(\\Delta x)^2}\\cos(x_j) - \\frac{2\\epsilon^2 \\sin^2(\\Delta x)}{(\\Delta x)^2}\\cos(2x_j)\\right) \\sin(x_j)\n$$\n$$\n= -\\frac{8\\epsilon \\sin^2(\\Delta x/2)}{(\\Delta x)^2} \\sum_{j=0}^{N-1} \\cos(x_j)\\sin(x_j) - \\frac{2\\epsilon^2 \\sin^2(\\Delta x)}{(\\Delta x)^2} \\sum_{j=0}^{N-1} \\cos(2x_j)\\sin(x_j)\n$$\nWe need to evaluate the discrete sums $\\sum \\sin^2(x_j)$, $\\sum \\cos(x_j)\\sin(x_j)$, and $\\sum \\cos(2x_j)\\sin(x_j)$ over $j=0, \\dots, N-1$. On a uniform periodic grid $x_j=j\\frac{2\\pi}{N}$, for integer $k$ not a multiple of $N/2$ or $N$, the discrete trigonometric functions are orthogonal: $\\sum_{j=0}^{N-1}\\sin(kx_j)\\cos(lx_j) = 0$.\nThe sum $\\sum \\cos(x_j)\\sin(x_j) = \\frac{1}{2}\\sum\\sin(2x_j)$, which is zero for $N2$.\nThe sum $\\sum \\cos(2x_j)\\sin(x_j) = \\frac{1}{2}\\sum(\\sin(3x_j)-\\sin(x_j))$, which is zero for $N3$.\nTherefore, the entire second term involving $(\\Delta t)^2$ is zero.\n\nThe only nonzero contribution comes from the first term involving $\\sum \\sin^2(x_j)$:\n$$\n\\sum_{j=0}^{N-1} \\sin^2(x_j) = \\sum_{j=0}^{N-1} \\frac{1-\\cos(2x_j)}{2} = \\frac{1}{2}\\sum_{j=0}^{N-1} 1 - \\frac{1}{2}\\sum_{j=0}^{N-1}\\cos(2x_j)\n$$\nThe first part is $N/2$. The second sum $\\sum \\cos(2x_j)$ is zero for $N2$. Thus, $\\sum_{j=0}^{N-1} \\sin^2(x_j) = N/2$.\n\nSubstituting this result back into the expression for $\\Delta M_{\\text{noncons}}$:\n$$\n\\Delta M_{\\text{noncons}} = \\Delta t \\Delta x \\left( -\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x} \\cdot \\frac{N}{2} \\right)\n$$\n$$\n\\Delta M_{\\text{noncons}} = -\\frac{\\Delta t \\epsilon \\sin(\\Delta x) N \\Delta x}{2 \\Delta x} = - \\frac{N\\Delta x}{2} \\epsilon \\Delta t \\frac{\\sin(\\Delta x)}{\\Delta x}\n$$\nUsing the given relation $N\\Delta x = 2\\pi$:\n$$\n\\Delta M_{\\text{noncons}} = - \\frac{2\\pi}{2} \\epsilon \\Delta t \\frac{\\sin(\\Delta x)}{\\Delta x} = -\\pi \\epsilon \\Delta t \\frac{\\sin(\\Delta x)}{\\Delta x}\n$$\nThis is the final closed-form expression for the net change in discrete mass. This non-conservation arises because the advective form $\\partial_t q + a \\partial_x q = 0$ is only equivalent to the true conservation law $\\partial_t q + \\partial_x(aq) = 0$ when the source term $-q \\partial_x a$ is included. The Lax-Wendroff scheme, applied to the nonconservative form, does not account for this term, leading to a spurious change in mass proportional to $\\epsilon$ (the magnitude of the velocity variation) and $\\Delta t$.",
            "answer": "$$\\boxed{-\\pi \\epsilon \\Delta t \\frac{\\sin(\\Delta x)}{\\Delta x}}$$"
        },
        {
            "introduction": "While high-order schemes excel at resolving smooth features, their response to the sharpest, grid-scale features can determine whether a simulation is plagued by numerical noise. Von Neumann stability analysis provides a powerful lens to examine this behavior by decomposing the solution into Fourier modes and analyzing how each mode evolves. This exercise focuses on the Nyquist wavenumber—the highest frequency the grid can resolve—to directly contrast the behavior of the diffusive first-order Lax-Friedrichs scheme with the dispersive second-order Lax-Wendroff scheme, explaining why one damps grid-scale noise while the other propagates it. ",
            "id": "3603414",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a \\in \\mathbb{R}$ on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$. Define the Courant number $C = a\\,\\Delta t / \\Delta x$. Two classical finite-difference schemes are considered:\n\n- Lax-Friedrichs scheme: $u^{n+1}_{j} = \\tfrac{1}{2}\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) - \\tfrac{C}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right)$.\n- Lax-Wendroff scheme: $u^{n+1}_{j} = u^{n}_{j} - \\tfrac{C}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\tfrac{C^{2}}{2}\\left(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\right)$.\n\nUsing von Neumann analysis with Fourier mode $u^{n}_{j} = \\hat{u}^{n}\\,\\exp\\left(\\mathrm{i}\\,j\\,\\theta\\right)$, focus on the Nyquist wavenumber defined by the nondimensional phase $\\theta = \\pi$. Compare the amplification factors at $\\theta = \\pi$ for both schemes and interpret the implications for damping of the two-grid oscillation (checkerboard mode) that alternates sign between adjacent grid points. Select the option that correctly states the amplification factors at $\\theta = \\pi$ and the corresponding damping behavior for admissible Courant numbers satisfying $0  C \\leq 1$.\n\nA. For Lax-Friedrichs, $|G(\\pi)| = 1$ for all $C$, whereas for Lax-Wendroff, $G(\\pi) = 1 - 2\\,C^{2}$ so that $|G(\\pi)|  1$ for $0  C  1$; thus Lax-Wendroff damps the Nyquist mode except at $C = 1$, while Lax-Friedrichs does not damp it.\n\nB. Both schemes annihilate the Nyquist mode in one time step, i.e., $|G(\\pi)| = 0$ for all $0  C \\leq 1$; thus both strongly damp the checkerboard mode.\n\nC. For Lax-Friedrichs, $|G(\\pi)|  1$ for any $C \\neq 0$, while for Lax-Wendroff, $|G(\\pi)| = 1$ for all $0  C \\leq 1$; thus Lax-Friedrichs damps the Nyquist mode but Lax-Wendroff does not.\n\nD. For both schemes, $|G(\\pi)| = 1$ for all $0  C \\leq 1$; thus neither scheme damps the checkerboard mode over the entire admissible range.\n\nE. For Lax-Friedrichs, $|G(\\pi)| = 1$, and for Lax-Wendroff, $G(\\pi) = -2\\,\\mathrm{i}\\,C$; hence both are purely dispersive at the Nyquist wavenumber and non-dissipative.",
            "solution": "The user wants a detailed analysis of two finite-difference schemes for the linear advection equation, focusing on their behavior at the Nyquist wavenumber.\n\n### Problem Validation\nThe problem statement is valid. It presents a standard problem in the numerical analysis of partial differential equations. All terms are well-defined, the physical and mathematical context is sound, and the question is well-posed, leading to a unique, verifiable solution. No flaws were identified.\n\n### Derivation\n\nThe problem asks for an analysis of the amplification factors of the Lax-Friedrichs and Lax-Wendroff schemes for the one-dimensional linear advection equation, $u_t + a u_x = 0$. The analysis is to be performed using the von Neumann method at the Nyquist wavenumber, which corresponds to a nondimensional phase of $\\theta = \\pi$.\n\nIn von Neumann analysis, we consider a single Fourier mode of the solution, $u_j^n = \\hat{u}^n e^{\\mathrm{i}j\\theta}$, where $j$ is the spatial grid index, $n$ is the time level index, $\\mathrm{i} = \\sqrt{-1}$, and $\\theta = k\\Delta x$ is the nondimensional wavenumber ($k$ is the wavenumber, $\\Delta x$ is the grid spacing). The amplification factor, $G(\\theta)$, is defined by the relation $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^n$, which implies $u_j^{n+1} = G(\\theta) u_j^n$. From this, we also have the relations for neighboring points: $u_{j\\pm 1}^n = \\hat{u}^n e^{\\mathrm{i}(j\\pm 1)\\theta} = e^{\\pm\\mathrm{i}\\theta} u_j^n$. We will use these relations to derive the amplification factor for each scheme.\n\nA scheme is dissipative for a given mode $\\theta$ if $|G(\\theta)|  1$, and non-dissipative if $|G(\\theta)| = 1$. The Nyquist wavenumber $\\theta=\\pi$ corresponds to the highest frequency resolvable on the grid, representing a \"checkerboard\" or \"two-grid\" oscillation of the form $e^{\\mathrm{i}j\\pi} = (-1)^j$. Damping this mode is often desirable to control numerical oscillations.\n\n**1. Lax-Friedrichs Scheme**\n\nThe scheme is given by:\n$$u^{n+1}_{j} = \\frac{1}{2}\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) - \\frac{C}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right)$$\nwhere $C = a\\,\\Delta t / \\Delta x$ is the Courant number.\n\nSubstitute the Fourier mode relationships:\n$$G_{LF}(\\theta)u_j^n = \\frac{1}{2}\\left(e^{\\mathrm{i}\\theta}u_j^n + e^{-\\mathrm{i}\\theta}u_j^n\\right) - \\frac{C}{2}\\left(e^{\\mathrm{i}\\theta}u_j^n - e^{-\\mathrm{i}\\theta}u_j^n\\right)$$\nDividing by $u_j^n$ (which is non-zero) yields the amplification factor $G_{LF}(\\theta)$:\n$$G_{LF}(\\theta) = \\frac{1}{2}\\left(e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta}\\right) - \\frac{C}{2}\\left(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}\\right)$$\nUsing Euler's identities, $\\cos(\\theta) = \\frac{1}{2}(e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta})$ and $\\sin(\\theta) = \\frac{1}{2\\mathrm{i}}(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta})$, we can simplify this expression:\n$$G_{LF}(\\theta) = \\cos(\\theta) - \\mathrm{i}C\\sin(\\theta)$$\nNow, we evaluate this at the Nyquist wavenumber, $\\theta = \\pi$:\n$$G_{LF}(\\pi) = \\cos(\\pi) - \\mathrm{i}C\\sin(\\pi) = -1 - \\mathrm{i}C(0) = -1$$\nThe magnitude of the amplification factor at the Nyquist wavenumber is:\n$$|G_{LF}(\\pi)| = |-1| = 1$$\nThis result is independent of the Courant number $C$. Since the magnitude is exactly $1$, the Lax-Friedrichs scheme does not damp the Nyquist mode. The amplitude of the checkerboard oscillation remains constant, though its sign flips at each time step because $G_{LF}(\\pi) = -1$.\n\n**2. Lax-Wendroff Scheme**\n\nThe scheme is given by:\n$$u^{n+1}_{j} = u^{n}_{j} - \\frac{C}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{C^{2}}{2}\\left(u^{n}_{j+1} - 2u^{n}_{j} + u^{n}_{j-1}\\right)$$\nSubstitute the Fourier mode relationships:\n$$G_{LW}(\\theta)u_j^n = u_j^n - \\frac{C}{2}\\left(e^{\\mathrm{i}\\theta}u_j^n - e^{-\\mathrm{i}\\theta}u_j^n\\right) + \\frac{C^{2}}{2}\\left(e^{\\mathrm{i}\\theta}u_j^n - 2u_j^n + e^{-\\mathrm{i}\\theta}u_j^n\\right)$$\nDividing by $u_j^n$:\n$$G_{LW}(\\theta) = 1 - \\frac{C}{2}\\left(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}\\right) + \\frac{C^{2}}{2}\\left(e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta}\\right)$$\nUsing Euler's identities and the identity $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} - 2 = 2\\cos(\\theta) - 2$:\n$$G_{LW}(\\theta) = 1 - \\frac{C}{2}(2\\mathrm{i}\\sin(\\theta)) + \\frac{C^{2}}{2}(2\\cos(\\theta) - 2)$$\n$$G_{LW}(\\theta) = 1 - \\mathrm{i}C\\sin(\\theta) + C^2(\\cos(\\theta) - 1)$$\nNow, we evaluate this at the Nyquist wavenumber, $\\theta = \\pi$:\n$$G_{LW}(\\pi) = 1 - \\mathrm{i}C\\sin(\\pi) + C^2(\\cos(\\pi) - 1) = 1 - \\mathrm{i}C(0) + C^2(-1 - 1) = 1 - 2C^2$$\nThe amplification factor is real. We need to find its magnitude for the specified range $0  C \\leq 1$.\n$$|G_{LW}(\\pi)| = |1 - 2C^2|$$\nLet's analyze this magnitude:\n- If $C = 1$, $|G_{LW}(\\pi)| = |1 - 2(1)^2| = |-1| = 1$. The scheme is non-dissipative at the stability limit.\n- If $0  C  1$, then $0  C^2  1$ and $0  2C^2  2$. This gives $-1  1 - 2C^2  1$.\n  Therefore, for $0  C  1$, the magnitude is strictly less than $1$: $|G_{LW}(\\pi)| = |1 - 2C^2|  1$.\nThis means the Lax-Wendroff scheme is dissipative and damps the Nyquist mode for all admissible Courant numbers in the range $0  C  1$. It only fails to damp this mode at the boundary case $C=1$.\n\n### Option-by-Option Analysis\n\n**A. For Lax-Friedrichs, $|G(\\pi)| = 1$ for all $C$, whereas for Lax-Wendroff, $G(\\pi) = 1 - 2\\,C^{2}$ so that $|G(\\pi)|  1$ for $0  C  1$; thus Lax-Wendroff damps the Nyquist mode except at $C = 1$, while Lax-Friedrichs does not damp it.**\n- The statement for Lax-Friedrichs, $|G(\\pi)| = 1$, is correct.\n- The statement for Lax-Wendroff, $G(\\pi) = 1 - 2C^2$, is correct.\n- The implication that $|G(\\pi)|  1$ for $0  C  1$ for Lax-Wendroff is correct.\n- The final conclusion that Lax-Wendroff damps the Nyquist mode (except at $C=1$) while Lax-Friedrichs does not, is entirely consistent with our derivation.\n- **Verdict: Correct.**\n\n**B. Both schemes annihilate the Nyquist mode in one time step, i.e., $|G(\\pi)| = 0$ for all $0  C \\leq 1$; thus both strongly damp the checkerboard mode.**\n- This is incorrect. For Lax-Friedrichs, $|G(\\pi)| = 1$, not $0$. For Lax-Wendroff, $|G(\\pi)| = 0$ only at the specific value $C = 1/\\sqrt{2}$, not for all $C$ in the range.\n- **Verdict: Incorrect.**\n\n**C. For Lax-Friedrichs, $|G(\\pi)|  1$ for any $C \\neq 0$, while for Lax-Wendroff, $|G(\\pi)| = 1$ for all $0  C \\leq 1$; thus Lax-Friedrichs damps the Nyquist mode but Lax-Wendroff does not.**\n- This statement reverses the properties of the two schemes. Our analysis showed $|G_{LF}(\\pi)|=1$ and $|G_{LW}(\\pi)| \\leq 1$ (with equality only at $C=1$).\n- **Verdict: Incorrect.**\n\n**D. For both schemes, $|G(\\pi)| = 1$ for all $0  C \\leq 1$; thus neither scheme damps the checkerboard mode over the entire admissible range.**\n- This is true for Lax-Friedrichs, but false for Lax-Wendroff, which does damp the mode for $0  C  1$.\n- **Verdict: Incorrect.**\n\n**E. For Lax-Friedrichs, $|G(\\pi)| = 1$, and for Lax-Wendroff, $G(\\pi) = -2\\,\\mathrm{i}\\,C$; hence both are purely dispersive at the Nyquist wavenumber and non-dissipative.**\n- The first part for Lax-Friedrichs is correct, $|G(\\pi)|=1$.\n- The second part for Lax-Wendroff is incorrect. We derived $G_{LW}(\\pi) = 1 - 2C^2$, which is real, not the imaginary value $-2\\mathrm{i}C$.\n- **Verdict: Incorrect.**\n\nBased on the detailed analysis, only option A accurately describes the behavior of both schemes at the Nyquist wavenumber.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}