{
    "hands_on_practices": [
        {
            "introduction": "一个稳健的区域分解预条件子的效果取决于一个能够处理全局误差模式的、精心设计的粗糙空间。本练习探讨了地球物理学中的一个关键情景：复杂的地质结构导致子区域内部不连通，这迫使我们必须丰富粗糙空间以保持求解器的性能。理解这一原理  是设计对地质非均质性稳健的预条件子的基础。",
            "id": "3586626",
            "problem": "考虑用于地下稳态流动的非均质标量扩散模型，该模型写作有界域 $\\Omega \\subset \\mathbb{R}^d$ 上的椭圆边值问题 $\\nabla \\cdot (\\kappa \\nabla u) = f$，并附有适当的边界条件。其中，$\\kappa(\\mathbf{x})$ 表示一个正的空间变化传导率，它可能呈现出计算地球物理学中典型的高对比度和复杂的几何形状。通过协调有限元方法进行离散化，得到一个对称正定线性系统 $A u = b$，其双线性形式为 $a(u,v) = \\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, d\\mathbf{x}$。\n\n为了对 $A$ 进行预处理，考虑一种两层区域分解方法。在该方法中，$\\Omega$ 被划分为 $N$ 个非重叠子区域 $\\{D_i\\}_{i=1}^N$，粗空间提供全局耦合，而局部空间与子区域求解器相关联。用 $A_i$ 表示与子区域 $D_i$ 对应的局部算子，该算子在内部界面上具有齐次 Neumann 条件。在处理高对比度地质的实践中，由于存在不可渗透的夹杂物或空腔（例如盐体、空洞），子区域内部 $D_i$ 可能是不连通的，因此 $D_i = \\bigcup_{m=1}^{M_i} D_i^{(m)}$，其中每个 $D_i^{(m)}$ 是一个连通开集，且 $M_i \\ge 2$。\n\n从基本原理可知， $D_i$ 上的局部 Neumann 算子 $A_i$ 是通过将 $a(\\cdot,\\cdot)$ 限制在 $H^1(D_i)$ 上来定义的，并在界面 $\\partial D_i \\cap \\mathrm{int}(\\Omega)$ 上强制法向通量为零。对于每个连通分支 $D_i^{(m)}$，局部能量 $a(\\cdot,\\cdot)$ 在支集于 $D_i^{(m)}$ 上的常值函数上为零；因此，零空间 $\\ker(A_i)$ 包含所有分支常数的张成空间，其维度至少为 $M_i$。\n\n在两层加性 Schwarz 方法和约束平衡区域分解（BDDC）方法中，一个鲁棒的粗空间必须能捕捉全局低能模态，否则这些模态会恶化条件数。对于有限元撕裂与连接 - 对偶-原始（FETI-DP）方法也存在类似的要求。假设当前的粗空间每个子区域只包含一个平均值或只包含基于顶点的约束，而没有考虑到内部连通性的多重性。\n\n哪个选项正确解释了为什么粗空间必须包含耦合不连通部分的模态，并提出了一种简单的增广方法，以确保对上述非均质扩散算子进行适当的粗空间校正？\n\nA. 因为 $D_i$ 上的局部 Neumann 问题拥有一个由在每个连通分支 $D_i^{(m)}$ 上为常数的函数所张成的零空间，任何未能表示所有这些分支常数的粗空间都会在 $\\ker(A_i)$ 中留下未耦合的低能模态，这些模态表现为预处理算子的小特征值。一种简单的增广方法是，为每个子区域 $D_i$ 和每个分支 $D_i^{(m)}$ 添加一个粗空间基函数，该函数在 $D_i^{(m)}$ 上为常数（在其他地方为零），这等效于为每个连通分支施加一个原始约束（分支平均值），从而使 $\\ker(A_i)$ 包含于粗空间的值域中。\n\nB. 因为 Krylov 方法在处理振荡波解时会停滞，所以补救措施是添加一个阻尼 Jacobi 光滑子；只要迭代方法被频繁重启，粗空间增广就是不必要的。\n\nC. 因为重叠不足会阻碍信息传递，将子区域之间的重叠增加一倍可以保证不连通内部的耦合，从而无需修改粗空间。\n\nD. 因为不连通的内部仅在几何顶点处导致秩亏，所以每个子区域添加一个基于顶点的粗空间自由度就足够了；不需要分支约束或基函数。\n\nE. 因为高传导率对比度会引发高频气泡模态，用在所有界面上为零且在每个 $D_i$ 上平均值为零的子区域气泡函数来增广粗空间，足以耦合不连通的分支。",
            "solution": "### 解答推导\n\n两层区域分解预处理器的有效性取决于局部求解器和全局粗糙校正之间的适当交互。预处理器在概念上可以写成一个粗糙校正算子和一组局部校正算子之和。如果预处理算子 $M^{-1}A$ 的谱被良好地聚集，理想情况下其条件数与离散化参数（$h$）和子区域数量（$N$）无关，那么像预处理共轭梯度（PCG）法这样的迭代方法会收敛得很快。\n\n核心原理是将解空间分解为粗糙分量和局部分量。粗糙分量处理低频、全局尺度的误差分量，而局部求解器处理高频、局部尺度的误差分量。函数 $u$ 的“能量”由双线性形式 $a(u,u) = \\int_{\\Omega} \\kappa |\\nabla u|^2 d\\mathbf{x}$ 给出。对于区域分解方法，有问题的误差模态是那些能量较低但在粗空间中没有得到很好表示的模态。\n\n在问题的背景下，局部求解器对应于对局部算子 $A_i$ 进行求逆（或近似求逆）。这些算子定义在子区域 $D_i$ 上，内部边界上具有齐次 Neumann 条件。与 $A_i$ 相关的能量是 $a_i(u_i, u_i) = \\int_{D_i} \\kappa |\\nabla u_i|^2 d\\mathbf{x}$。$A_i$ 的零空间，记为 $\\ker(A_i)$，由 $H^1(D_i)$ 中能量为零的函数 $u_i$ 组成。由于 $\\kappa > 0$，这意味着在整个 $D_i$ 上 $\\nabla u_i = \\mathbf{0}$。\n\n问题指出，一个子区域 $D_i$ 可能由 $M_i$ 个不相交的连通分支组成，$D_i = \\bigcup_{m=1}^{M_i} D_i^{(m)}$。一个函数 $u_i$ 在 $D_i$ 上的梯度为零，当且仅当它在每个连通分支 $D_i^{(m)}$ 上为常数。不同分支上的常数值可以不同。设 $\\chi_i^{(m)}$ 是分支 $D_i^{(m)}$ 上的特征函数。那么，$\\ker(A_i)$ 中的任何函数都具有 $\\sum_{m=1}^{M_i} c_m \\chi_i^{(m)}$ 的形式，其中 $c_m$ 是某些常数。这意味着零空间 $\\ker(A_i)$ 是一个由这些分支常数函数张成的 $M_i$ 维向量空间。这些是子区域的“浮动模态”。\n\n对于一个鲁棒的两层预处理器，特别是像 BDDC 和 FETI-DP 这样的方法，一个基本要求是粗空间必须包含所有属于局部问题零空间的模态。换句话说，任何不能被局部求解器“看到”（即局部能量为零）的函数，都必须被粗糙求解器完全捕捉和约束。如果违反了这个条件，这些零空间模态就不能被预处理器的局部或粗糙部分正确校正。它们表现为被预处理器的局部部分消除但不受粗网格控制的误差分量。这导致预处理算子的特征值非常接近于零，使得条件数变得极大，并严重降低 Krylov 求解器的收敛速度。\n\n问题中提到的“有缺陷的”粗空间（每个子区域一个平均值，或基于顶点的约束）在 $M_i > 1$ 时不满足这个测试。对 $D_i$ 的单个平均值约束只约束了 $M_i$ 个分支常数的一个线性组合，留下了 $M_i - 1$ 个浮动模态未受约束。基于顶点的约束通常也是不充分的，因为一个浮动分支可能不包含任何选定的顶点。\n\n直接而正确的补救措施是增广粗空间，以确保它能表示所有 $i=1, \\dots, N$ 的 $\\ker(A_i)$ 中的任何函数。实现这一目标的最简单方法是为每个子区域 $D_i$ 的每个连通分支 $D_i^{(m)}$ 引入一个粗空间自由度。在像 BDDC 这样的原始方法中，这转化为对每个分支施加一个约束，例如该分支上解的平均值。在像 FETI-DP 这样的对偶方法或加性 Schwarz 的粗空间构造中，这对应于为每个分支添加一个粗空间基函数，其中基函数通常是该分支的特征函数 $\\chi_i^{(m)}$。这种增广确保了条件 $\\ker(A_i) \\subset \\text{Range of Coarse Interpolation}$ 对所有 $i$ 都满足，从而恢复了鲁棒性。\n\n### 逐项分析\n\n**A. 因为 $D_i$ 上的局部 Neumann 问题拥有一个由在每个连通分支 $D_i^{(m)}$ 上为常数的函数所张成的零空间，任何未能表示所有这些分支常数的粗空间都会在 $\\ker(A_i)$ 中留下未耦合的低能模态，这些模态表现为预处理算子的小特征值。一种简单的增广方法是，为每个子区域 $D_i$ 和每个分支 $D_i^{(m)}$ 添加一个粗空间基函数，该函数在 $D_i^{(m)}$ 上为常数（在其他地方为零），这等效于为每个连通分支施加一个原始约束（分支平均值），从而使 $\\ker(A_i)$ 包含于粗空间的值域中。**\n\n*   **分析：** 此选项提供了完整而准确的说明。它正确地识别了局部 Neumann 问题的零空间（$M_i$ 维的分支常数空间）。它正确地诊断了一个有缺陷的粗空间的后果：来自 $\\ker(A_i)$ 的未耦合低能模态，导致预处理算子出现小特征值。最后，它提出了标准且正确的增广方法：每个连通分支一个粗空间自由度，并正确地将粗空间基函数（Schwarz/FETI-DP 视角）和原始约束（BDDC 视角）的概念联系起来。最后的条款正确地陈述了鲁棒性的数学条件。\n*   **结论：** 正确。\n\n**B. 因为 Krylov 方法在处理振荡波解时会停滞，所以补救措施是添加一个阻尼 Jacobi 光滑子；只要迭代方法被频繁重启，粗空间增广就是不必要的。**\n\n*   **分析：** 此选项存在根本性错误。问题是扩散问题，有问题的模态是低能的（非振荡的），这与像 Jacobi 这样的光滑子旨在处理的情况正好相反。粗空间对于处理这些低频模态至关重要。重启 Krylov 方法并不能修复一个导致巨大条件数的劣质预处理器。\n*   **结论：** 错误。\n\n**C. 因为重叠不足会阻碍信息传递，将子区域之间的重叠增加一倍可以保证不连通内部的耦合，从而无需修改粗空间。**\n\n*   **分析：** 此选项具有误导性。问题是针对非重叠子区域陈述的，这是 BDDC 和 FETI-DP 的标准设置。增加重叠与 Schwarz 方法有关，但即使在那里，它也不能解决局部零空间模态的根本问题。粗糙网格提供全局刚度，这个作用不能简单地通过增加局部重叠来替代。重叠有助于跨界面传播信息，但它不能约束完全位于子区域内部的模态。\n*   **结论：** 错误。\n\n**D. 因为不连通的内部仅在几何顶点处导致秩亏，所以每个子区域添加一个基于顶点的粗空间自由度就足够了；不需要分支约束或基函数。**\n\n*   **分析：** 这是不正确的。秩亏是局部算子在整个不连通子区域 $D_i$ 上的一个性质；它并非“局限于几何顶点”。一个不连通的分支（例如，一个内部空洞）可能不接触任何顶点，因此其浮动模态不会受到基于顶点的自由度的约束。问题陈述本身就指出了这种简单的粗空间是不充分的。\n*   **结论：** 错误。\n\n**E. 因为高传导率对比度会引发高频气泡模态，用在所有界面上为零且在每个 $D_i$ 上平均值为零的子区域气泡函数来增广粗空间，足以耦合不连通的分支。**\n\n*   **分析：** 此选项混淆了多个概念。问题是关于拓扑上的不连通性，而不是高对比度（尽管它们经常同时出现）。有问题的模态是低频常数，而不是高频气泡模态。粗空间用于处理低频模态。在边界上为零的气泡函数，根据定义，与构成 Neumann 算子零空间的常数函数正交。这种提议的“增广”对当前的问题没有任何效果。\n*   **结论：** 错误。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在理解了粗糙空间的理论要求之后，我们转向其实现的具体细节。本练习  将引导您进行性能分析，估算并行组装粗糙算子的计算成本。练习还将探讨粗糙求解的精度与预条件迭代方法整体收敛率之间的关键权衡。",
            "id": "3586575",
            "problem": "考虑一个由计算地球物理学中使用的二阶椭圆偏微分方程模型产生的对称正定 (SPD) 线性系统 $A u = f$。使用一个两层加性 Schwarz 预处理器，其中有 $S$ 个不重叠的子域，每个子域有 $n_{s}$ 个内部未知数。在每个子域 $i \\in \\{1,\\dots,S\\}$ 上，局部刚度矩阵为 $A_{i} \\in \\mathbb{R}^{n_{s} \\times n_{s}}$，粗空间由每个子域的 $r$ 个基函数构成。全局粗限制算子为 $R_{0} \\in \\mathbb{R}^{n_{0} \\times n}$，其中 $n_{0} = r S$，$R_{0i} \\in \\mathbb{R}^{r \\times n_{s}}$ 表示 $R_{0}$ 对应于子域 $i$ 的块。\n\n粗算子定义为 $A_{0} = R_{0} A R_{0}^{T}$，并且可以表示为局部贡献 $B_{i} = R_{0i} A_{i} R_{0i}^{T}$ 的和，这使其适合并行组装。假设采用一个浮点运算 (flop) 成本模型，并基于以下经过充分检验的事实：\n- 将稀疏矩阵 $A_{i}$ 应用于长度为 $n_{s}$ 的稠密向量的成本是 $2 \\,\\mathrm{nnz}(A_{i})$ 次浮点运算，其中 $\\mathrm{nnz}(A_{i})$ 是 $A_{i}$ 的非零元数量。\n- 计算两个长度为 $n_{s}$ 的稠密向量的内积的成本是 $2 n_{s}$ 次浮点运算。\n- $A_{i}$ 每行的平均非零元数量是一个常数 $\\gamma > 0$，因此 $\\mathrm{nnz}(A_{i}) \\approx \\gamma n_{s}$。\n- 一次局部子域求解（使用预先计算的稀疏 Cholesky 分解来应用一次 $A_{i}$ 的逆）需要一次前向和一次后向三角求解，其总成本约为 $4\\,\\mathrm{nnz}(L_{i})$ 次浮点运算，其中 $\\mathrm{nnz}(L_{i})$ 是 Cholesky 因子中的非零元数量。假设填充因子 $\\theta > 1$，因此 $\\mathrm{nnz}(L_{i}) \\approx \\theta\\,\\mathrm{nnz}(A_{i})$。\n\n假设每个 $R_{0i}^{T}$ 有 $r$ 个支撑在子域 $i$ 上的稠密列，并且对于每个子域，$B_{i}$ 通过以下方式组装：\n1. 计算 $y_{j} = A_{i} v_{j}$，其中 $j = 1,\\dots,r$，$v_{j}$ 是 $R_{0i}^{T}$ 的第 $j$ 列。\n2. 形成 $r \\times r$ 块 $B_{i}$，其元素为 $(B_{i})_{jk} = v_{j}^{T} y_{k}$。\n\n在这些假设下：\n1. 推导 $A_{0}$ 的并行组装表达式，并用 $n_{s}$、$r$ 和 $\\gamma$ 表示每个子域的总粗空间组装成本 $c_{\\mathrm{asm},i}$。\n2. 使用给定模型，计算总粗空间组装成本与一次局部子域求解（前向加后向代换）成本的比率 $R$，并用 $r$、$\\gamma$ 和 $\\theta$ 来简化 $R$。\n\n现在考虑使用非精确粗空间求解器的影响。设 $\\tilde{A}_{0}^{-1}$ 是 $A_{0}^{-1}$ 的一个近似逆，满足谱等价关系\n$$(1 - \\epsilon)\\, z^{T} A_{0}^{-1} z \\le z^{T} \\tilde{A}_{0}^{-1} z \\le (1 + \\epsilon)\\, z^{T} A_{0}^{-1} z \\quad \\text{for all } z \\in \\mathbb{R}^{n_{0}},$$\n其中 $0  \\epsilon  1$。令 $M^{-1}$ 表示精确的两层加性 Schwarz 预处理器，$M_{\\epsilon}^{-1}$ 表示将 $A_{0}^{-1}$ 替换为 $\\tilde{A}_{0}^{-1}$ 的相同预处理器。假设使用精确粗空间求解时，预处理算子的条件数为 $\\kappa = \\kappa(M^{-1} A)$。根据关于对称正定 (SPD) 问题的预处理共轭梯度法 (PCG) 的成熟结论，在 $A$-范数下每次迭代的渐近收缩因子为 $q = \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}$。\n\n3. 说明非精确粗空间求解如何将条件数界修改为 $\\kappa' \\le \\kappa \\,\\frac{1 + \\epsilon}{1 - \\epsilon}$，并用 $\\kappa$ 和 $\\epsilon$ 表示相应的收缩因子 $q'$。\n\n将品质因数 $\\phi$ 定义为成本比率与退化收缩因子的乘积，即\n$$\\phi = R \\, q'.$$\n以参数 $r$、$\\gamma$、$\\theta$、$\\epsilon$ 和 $\\kappa$ 的形式，提供 $\\phi$ 的单一闭式解析表达式。答案需以无量纲形式表示。无需四舍五入。",
            "solution": "我们考虑一个对称正定 (SPD) 线性系统 $A u = f$ 和一个两层加性 Schwarz 预处理器。全局粗算子定义为 $A_{0} = R_{0} A R_{0}^{T}$。在一个包含 $S$ 个子域的区域分解框架中，我们根据子域对未知数向量进行划分，并将限制算子 $R_{0}$ 分块表示为 $R_{0} = \\begin{pmatrix} R_{0 1}  \\cdots  R_{0 S} \\end{pmatrix}$，其中每个 $R_{0 i} \\in \\mathbb{R}^{r \\times n_{s}}$ 将子域 $i$ 的自由度映射到 $r$ 个粗基系数。局部子域刚度矩阵为 $A_{i} \\in \\mathbb{R}^{n_{s} \\times n_{s}}$。在不重叠分解下，细网格矩阵 $A$ 可被视为由局部贡献分块组装而成，而粗算子可组装为局部贡献之和\n$$\nA_{0} = \\sum_{i=1}^{S} R_{0 i} A_{i} R_{0 i}^{T}.\n$$\n该等式源于线性和 $R_{0}$ 作为块行拼接的定义，这意味着 $R_{0} A R_{0}^{T}$ 收集了限制在每个子域上并投影到粗空间的 $A$ 的贡献。\n\n为了并行组装 $A_{0}$，每个子域 $i$ 独立计算其局部粗块\n$$\nB_{i} = R_{0 i} A_{i} R_{0 i}^{T} \\in \\mathbb{R}^{r \\times r},\n$$\n然后将这些 $r \\times r$ 块对 $i$ 求和以生成 $A_{0}$。在每个子域 $i$ 上的算法实现如下：\n1. 设 $V_{i} = R_{0 i}^{T} \\in \\mathbb{R}^{n_{s} \\times r}$，其列为 $v_{1},\\dots,v_{r}$。计算 $y_{j} = A_{i} v_{j}$，其中 $j = 1,\\dots,r$。\n2. 通过 $(B_{i})_{jk} = v_{j}^{T} y_{k}$ 形成 $B_{i}$ 的元素，其中 $j,k = 1,\\dots,r$。\n\n我们现在根据给定模型计算每个子域上此组装过程的浮点运算次数。\n\n对于步骤 1，每次将 $A_{i}$ 应用于一个稠密向量的成本为 $2\\,\\mathrm{nnz}(A_{i})$ 次浮点运算。由于此操作执行 $r$ 次，因此在子域 $i$ 上步骤 1 的总成本为\n$$\nc_{1,i} = 2 r\\, \\mathrm{nnz}(A_{i}).\n$$\n对于步骤 2，有 $r^{2}$ 个长度为 $n_{s}$ 的内积（在 $v_{j}$ 和 $y_{k}$ 之间）。每个内积的成本为 $2 n_{s}$ 次浮点运算，因此总成本为\n$$\nc_{2,i} = 2 n_{s} r^{2}.\n$$\n因此，每个子域的总粗空间组装成本为\n$$\nc_{\\mathrm{asm},i} = c_{1,i} + c_{2,i} = 2 r\\, \\mathrm{nnz}(A_{i}) + 2 n_{s} r^{2}.\n$$\n使用 $\\mathrm{nnz}(A_{i}) \\approx \\gamma n_{s}$，我们得到\n$$\nc_{\\mathrm{asm},i} \\approx 2 r \\gamma n_{s} + 2 n_{s} r^{2} = 2 n_{s} \\left( r \\gamma + r^{2} \\right).\n$$\n\n我们将其与使用预先计算的分解进行一次局部子域求解的成本进行比较。设 Cholesky 因子 $L_{i}$ 有 $\\mathrm{nnz}(L_{i}) \\approx \\theta\\, \\mathrm{nnz}(A_{i})$ 个非零元，其中 $\\theta  1$ 是一个填充因子。通过前向和后向代换应用一次 $A_{i}^{-1}$ 的成本约为\n$$\nc_{\\mathrm{solve},i} \\approx 4\\,\\mathrm{nnz}(L_{i}) \\approx 4 \\theta\\, \\mathrm{nnz}(A_{i}) \\approx 4 \\theta \\gamma n_{s}.\n$$\n因此，每个子域的粗空间组装成本与一次局部子域求解成本的比率为\n$$\nR_{i} = \\frac{c_{\\mathrm{asm},i}}{c_{\\mathrm{solve},i}} \\approx \\frac{2 n_{s} \\left( r \\gamma + r^{2} \\right)}{4 \\theta \\gamma n_{s}} = \\frac{r \\gamma + r^{2}}{2 \\theta \\gamma} = \\frac{r}{2 \\theta} + \\frac{r^{2}}{2 \\theta \\gamma}.\n$$\n假设子域相同，全局比率 $R$ 等于 $R_{i}$：\n$$\nR = \\frac{r}{2 \\theta} + \\frac{r^{2}}{2 \\theta \\gamma}.\n$$\n\n我们现在量化非精确粗空间求解器的影响。将精确的两层预处理器定义为\n$$\nM^{-1} = \\sum_{i=1}^{S} R_{i}^{T} A_{i}^{-1} R_{i} + R_{0}^{T} A_{0}^{-1} R_{0},\n$$\n其中 $R_{i}$ 是到子域自由度上的局部限制算子。非精确粗空间求解器将 $A_{0}^{-1}$ 替换为满足以下条件的 $\\tilde{A}_{0}^{-1}$\n$$\n(1 - \\epsilon)\\, z^{T} A_{0}^{-1} z \\le z^{T} \\tilde{A}_{0}^{-1} z \\le (1 + \\epsilon)\\, z^{T} A_{0}^{-1} z,\\quad \\forall z \\in \\mathbb{R}^{n_{0}},\n$$\n其中 $0  \\epsilon  1$。这意味着精确和非精确粗空间逆算子在常数 $(1 - \\epsilon)$ 和 $(1 + \\epsilon)$ 下是谱等价的。因此，带有非精确粗空间求解的预处理器，\n$$\nM_{\\epsilon}^{-1} = \\sum_{i=1}^{S} R_{i}^{T} A_{i}^{-1} R_{i} + R_{0}^{T} \\tilde{A}_{0}^{-1} R_{0},\n$$\n与 $M^{-1}$ 谱等价：\n$$\n(1 - \\epsilon)\\, y^{T} M^{-1} y \\le y^{T} M_{\\epsilon}^{-1} y \\le (1 + \\epsilon)\\, y^{T} M^{-1} y,\\quad \\forall y \\in \\mathbb{R}^{n}.\n$$\n要理解这一点，可通过支撑两层方法的稳定分解将任意 $y$ 分解为局部和粗糙分量；唯一被修改的项是粗糙分量，根据对 $\\tilde{A}_{0}^{-1}$ 的假定等价性，该分量被缩放了 $(1 \\pm \\epsilon)$。因此，对于预处理算子，瑞利商界（Rayleigh quotient bounds）意味着\n$$\n\\kappa(M_{\\epsilon}^{-1} A) \\le \\frac{1 + \\epsilon}{1 - \\epsilon}\\, \\kappa(M^{-1} A) = \\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}.\n$$\n令 $\\kappa' = \\kappa(M_{\\epsilon}^{-1} A)$ 表示非精确粗空间条件数界。则\n$$\n\\kappa' \\le \\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}.\n$$\n对于应用于 SPD 系统的预处理共轭梯度法 (PCG)，在 $A$-范数下每次迭代的渐近收缩因子由下式给出\n$$\nq = \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}.\n$$\n将 $\\kappa$ 替换为 $\\kappa'$ 可得\n$$\nq' = \\frac{\\sqrt{\\kappa'} - 1}{\\sqrt{\\kappa'} + 1} \\le \\frac{\\sqrt{\\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}} - 1}{\\sqrt{\\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}} + 1}.\n$$\n\n最后，将品质因数 $\\phi$ 定义为成本比率与退化收缩因子的乘积：\n$$\n\\phi = R \\, q' = \\left( \\frac{r}{2 \\theta} + \\frac{r^{2}}{2 \\theta \\gamma} \\right) \\, \\frac{\\sqrt{\\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}} - 1}{\\sqrt{\\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}} + 1}.\n$$\n此表达式是无量纲的，反映了并行粗空间组装成本与局部子域求解的比较，以及非精确粗空间求解器如何影响每次迭代的渐近收敛性。",
            "answer": "$$\\boxed{\\left( \\frac{r}{2 \\theta} + \\frac{r^{2}}{2 \\theta \\gamma} \\right) \\,\\frac{\\sqrt{\\kappa \\,\\frac{1 + \\epsilon}{1 - \\epsilon}} - 1}{\\sqrt{\\kappa \\,\\frac{1 + \\epsilon}{1 - \\epsilon}} + 1}}$$"
        },
        {
            "introduction": "为每一个复杂问题手动设计粗糙空间是不切实际的，这推动了自适应方法的发展。本练习  介绍了“重叠区域广义特征值问题 (GenEO)”方法，这是一种强大的技术，能自动识别并包含有问题的低能量模式到粗糙空间中。您将实现该方法的核心部分，根据局部谱信息估算所需的粗糙空间大小，以达到预设的性能目标。",
            "id": "3586617",
            "problem": "考虑在地下流体模拟中遇到的标量椭圆算子，其控制方程为非均质扩散问题 $-\\nabla \\cdot (k(\\mathbf{x}) \\nabla u(\\mathbf{x})) = f(\\mathbf{x})$，其中非均质渗透率 $k(\\mathbf{x})$ 取自国际石油工程师协会（SPE）的基准数据。假设 SPE10 第 $85$ 层的数据被映射到矩形区域上的分片线性（$P_1$）有限元（FEM）网格上，并使用重叠区域分解来对产生的线性系统进行预处理。重点关注一种通过自适应谱粗空间增强的两层加性 Schwarz 预条件，该粗空间由重叠区域上的广义特征值问题（GenEO）构建。\n\n从标准弱形式和基于重叠的单位分解出发，GenEO 方法为每个子区域 $\\Omega_i$ 构建一个局部广义特征值问题，其瑞利商衡量了函数被局部求解器加上重叠部分表示得不好的倾向。通过选择特征值低于选定阈值的局部特征向量，并通过单位分解将其扩展，从而构建一个实用的粗空间。自适应阈值在粗空间维数的成本与预条件子的质量之间取得平衡。\n\n您的任务是使用特征值-阈值选择规则，估计为达到目标预处理条件数 $ \\kappa \\le 50 $ 所需的粗空间维数。使用以下原理：如果对于每个子区域 $\\Omega_i$，所有特征值 $ \\lambda \\le \\theta $ 的局部广义特征模态都被包含在粗空间中，那么在剩余子空间上，局部瑞利商满足 $ \\lambda \\ge \\theta $，从而得到全局条件数的界为\n$$\n\\kappa \\le \\frac{C_{\\text{stab}}}{\\theta},\n$$\n其中 $ C_{\\text{stab}} $ 是一个稳定性常数，它依赖于分解的几何形状、重叠大小和单位分解的权重（但在粗空间被扩充后，与系数对比度无关）。为满足目标 $ \\kappa_{\\text{target}} = 50 $，选择阈值\n$$\n\\theta = \\frac{C_{\\text{stab}}}{\\kappa_{\\text{target}}}.\n$$\n然后，估计的粗空间维数计算为所有子区域中小于或等于 $ \\theta $ 的局部特征值数量的总和：\n$$\n\\dim(\\mathcal{V}_{\\text{coarse}}) \\approx \\sum_{i} \\#\\{\\lambda^{(i)}_j \\,|\\, \\lambda^{(i)}_j \\le \\theta\\}.\n$$\n假设特征值是无量纲的（广义特征值问题使用重叠权重和有限元质量形式进行了归一化），且维数估计是如上所示的整数计数。\n\n实现一个程序，对于每个测试用例，输入：\n- 一个局部特征值数组的列表 $[\\{\\lambda^{(1)}_j\\}, \\{\\lambda^{(2)}_j\\}, \\ldots]$，每个子区域一个数组，每个数组都按升序排序，并包含映射到 $P_1$ 有限元网格上的 SPE10 第 $85$ 层渗透率的代表性特征值。\n- 给定重叠配置的稳定性常数 $ C_{\\text{stab}} $。\n\n程序必须：\n- 对所有情况设置 $ \\kappa_{\\text{target}} = 50 $。\n- 计算 $ \\theta = C_{\\text{stab}} / \\kappa_{\\text{target}} $。\n- 对所有子区域，统计并求和小于或等于 $ \\theta $ 的特征值的数量。\n- 返回此总和作为该情况的估计粗空间维数。\n\n为以下旨在探究不同情景的测试套件提供结果：\n\n- 情况 $1$（中等非均质性，理想路径）：$ C_{\\text{stab}} = 25 $。子区域特征值：\n  - 子区域 $1$：$[0.012, 0.08, 0.12, 0.42, 1.1, 3.0]$\n  - 子区域 $2$：$[0.038, 0.09, 0.15, 0.5, 0.8, 2.2]$\n  - 子区域 $3$：$[0.02, 0.07, 0.25, 0.6, 1.5, 2.5]$\n  - 子区域 $4$：$[0.01, 0.05, 0.2, 1.0, 2.0, 6.0]$\n- 情况 $2$（边界情况：阈值低于所有局部特征值，导致不添加粗糙模态）：$ C_{\\text{stab}} = 25 $。子区域特征值：\n  - 子区域 $1$：$[0.6, 0.9, 1.2]$\n  - 子区域 $2$：$[0.7, 1.0, 1.5]$\n  - 子区域 $3$：$[0.55, 0.8, 3.0]$\n- 情况 $3$（极端高对比度，许多非常小的局部特征值）：$ C_{\\text{stab}} = 5 $。子区域特征值：\n  - 子区域 $1$：$[0.0005, 0.001, 0.005, 0.02, 0.3, 0.9]$\n  - 子区域 $2$：$[0.0003, 0.002, 0.007, 0.015, 0.08, 0.4]$\n  - 子区域 $3$：$[0.0008, 0.004, 0.012, 0.09, 0.2, 1.0]$\n  - 子区域 $4$：$[0.0001, 0.003, 0.01, 0.04, 0.06, 0.08]$\n- 情况 $4$（更大的重叠常数，允许更大的阈值）：$ C_{\\text{stab}} = 100 $。子区域特征值：\n  - 子区域 $1$：$[0.02, 0.2, 0.9, 1.8, 2.5, 5.0]$\n  - 子区域 $2$：$[0.03, 0.6, 1.4, 2.1, 4.0]$\n  - 子区域 $3$：$[0.05, 0.4, 0.7, 1.3, 2.7]$\n  - 子区域 $4$：$[0.01, 0.08, 0.3, 0.8, 1.6, 3.6]$\n- 情况 $5$（跨子区域的混合行为）：$ C_{\\text{stab}} = 50 $。子区域特征值：\n  - 子区域 $1$：$[1.2, 1.5, 2.0]$\n  - 子区域 $2$：$[0.09, 0.2, 0.5, 0.9, 1.1]$\n  - 子区域 $3$：$[0.4, 0.7, 1.1, 1.8]$\n\n最终输出格式要求：您的程序应生成单行输出，其中包含案例 $1$ 到 $5$ 的结果，按顺序排列为一个逗号分隔的列表，并用方括号括起来，例如 $[n_1,n_2,n_3,n_4,n_5]$，其中每个 $n_i$ 是估计的粗空间维数（一个整数）。不应打印任何其他文本。本问题中的所有量都是无量纲的，因此不需要物理单位。不涉及角度。不使用百分比。",
            "solution": "所述问题必须首先经过严格验证，以确保其科学上合理、内容自洽且良定。\n\n**问题验证**\n\n**1. 提取的已知条件**\n- **控制方程**：$-\\nabla \\cdot (k(\\mathbf{x}) \\nabla u(\\mathbf{x})) = f(\\mathbf{x})$，其中 $k(\\mathbf{x})$ 为非均质渗透率。\n- **离散化与分解**：分片线性（$P_1$）有限元（FEM）网格，重叠区域分解。\n- **预处理方法**：通过 GenEO（重叠区域上的广义特征值问题）的自适应谱粗空间增强的两层加性 Schwarz 预条件。\n- **条件数界**：$\\kappa \\le \\frac{C_{\\text{stab}}}{\\theta}$，其中 $\\theta$ 是一个特征值阈值，$C_{\\text{stab}}$ 是一个稳定性常数。\n- **目标条件数**：$\\kappa_{\\text{target}} = 50$。\n- **阈值选择规则**：$\\theta = \\frac{C_{\\text{stab}}}{\\kappa_{\\text{target}}}$。\n- **粗空间维数估计**：$\\dim(\\mathcal{V}_{\\text{coarse}}) \\approx \\sum_{i} \\#\\{\\lambda^{(i)}_j \\,|\\, \\lambda^{(i)}_j \\le \\theta\\}$。\n- **测试用例**：\n    - **情况 1**：$C_{\\text{stab}} = 25$。特征值：$\\{\\lambda^{(1)}_j\\} = [0.012, 0.08, 0.12, 0.42, 1.1, 3.0]$，$\\{\\lambda^{(2)}_j\\} = [0.038, 0.09, 0.15, 0.5, 0.8, 2.2]$，$\\{\\lambda^{(3)}_j\\} = [0.02, 0.07, 0.25, 0.6, 1.5, 2.5]$，$\\{\\lambda^{(4)}_j\\} = [0.01, 0.05, 0.2, 1.0, 2.0, 6.0]$。\n    - **情况 2**：$C_{\\text{stab}} = 25$。特征值：$\\{\\lambda^{(1)}_j\\} = [0.6, 0.9, 1.2]$，$\\{\\lambda^{(2)}_j\\} = [0.7, 1.0, 1.5]$，$\\{\\lambda^{(3)}_j\\} = [0.55, 0.8, 3.0]$。\n    - **情况 3**：$C_{\\text{stab}} = 5$。特征值：$\\{\\lambda^{(1)}_j\\} = [0.0005, 0.001, 0.005, 0.02, 0.3, 0.9]$，$\\{\\lambda^{(2)}_j\\} = [0.0003, 0.002, 0.007, 0.015, 0.08, 0.4]$，$\\{\\lambda^{(3)}_j\\} = [0.0008, 0.004, 0.012, 0.09, 0.2, 1.0]$，$\\{\\lambda^{(4)}_j\\} = [0.0001, 0.003, 0.01, 0.04, 0.06, 0.08]$。\n    - **情况 4**：$C_{\\text{stab}} = 100$。特征值：$\\{\\lambda^{(1)}_j\\} = [0.02, 0.2, 0.9, 1.8, 2.5, 5.0]$，$\\{\\lambda^{(2)}_j\\} = [0.03, 0.6, 1.4, 2.1, 4.0]$，$\\{\\lambda^{(3)}_j\\} = [0.05, 0.4, 0.7, 1.3, 2.7]$，$\\{\\lambda^{(4)}_j\\} = [0.01, 0.08, 0.3, 0.8, 1.6, 3.6]$。\n    - **情况 5**：$C_{\\text{stab}} = 50$。特征值：$\\{\\lambda^{(1)}_j\\} = [1.2, 1.5, 2.0]$，$\\{\\lambda^{(2)}_j\\} = [0.09, 0.2, 0.5, 0.9, 1.1]$，$\\{\\lambda^{(3)}_j\\} = [0.4, 0.7, 1.1, 1.8]$。\n\n**2. 分析**\n该问题具有科学依据，其前提源于区域分解预条件子的既定理论，特别是 GenEO 方法，这是偏微分方程数值分析领域的一个重要研究课题。该问题是良定的，因为它提供了一个确定性的程序，包含了计算唯一输出所需的所有输入。它使用精确的数学和计算术语，是客观的。该问题不违反任何科学原理，也不包含不完整或矛盾的信息。它代表了 GenEO 收敛理论的一个简化但基本正确的应用，用于估计一个关键参数——粗空间维数。\n\n**3. 结论**\n问题有效。我们可以继续进行求解。\n\n**解题步骤**\n\n目标是为两层加性 Schwarz 预条件子估计自适应粗空间 $\\dim(\\mathcal{V}_{\\text{coarse}})$ 的维数。粗空间是使用 GenEO 方法构建的，该方法选择与定义在子区域重叠部分上的广义特征值问题的小特征值相对应的局部特征模态。\n\n核心原理是关于预处理后系统条件数 $\\kappa$ 的理论界：\n$$\n\\kappa \\le \\frac{C_{\\text{stab}}}{\\theta}\n$$\n此处，$C_{\\text{stab}}$ 是一个依赖于区域分解几何形状的常数，而 $\\theta$ 是用于为粗空间选择特征模态的阈值。为确保条件数保持在目标值 $\\kappa_{\\text{target}}$ 以下，我们必须选择 $\\theta$ 使得：\n$$\n\\kappa_{\\text{target}} \\ge \\frac{C_{\\text{stab}}}{\\theta} \\implies \\theta \\le \\frac{C_{\\text{stab}}}{\\kappa_{\\text{target}}}\n$$\n为了创建满足此界的最经济的粗空间，我们选择可能的最大阈值 $\\theta$，即：\n$$\n\\theta = \\frac{C_{\\text{stab}}}{\\kappa_{\\text{target}}}\n$$\n问题指定目标条件数为 $\\kappa_{\\text{target}} = 50$。\n\n一旦对于给定的 $C_{\\text{stab}}$ 确定了 $\\theta$，估计的粗空间维数通过对每个子区域 $\\Omega_i$ 中小于或等于此阈值的局部特征值 $\\lambda^{(i)}_j$ 的数量求和得到：\n$$\n\\dim(\\mathcal{V}_{\\text{coarse}}) = \\sum_{i} \\#\\{\\lambda^{(i)}_j \\,|\\, \\lambda^{(i)}_j \\le \\theta\\}\n$$\n我们将此过程应用于所提供的五个测试用例中的每一个。\n\n**情况 1**：\n- 已知：$C_{\\text{stab}} = 25$。\n- 计算阈值：$\\theta = \\frac{25}{50} = 0.5$。\n- 统计特征值 $\\le 0.5$ 的数量：\n    - 子区域 $1$：$\\{\\lambda^{(1)}_j\\} = [0.012, 0.08, 0.12, 0.42, 1.1, 3.0]$。数量为 $4$。\n    - 子区域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.038, 0.09, 0.15, 0.5, 0.8, 2.2]$。数量为 $4$。\n    - 子区域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.02, 0.07, 0.25, 0.6, 1.5, 2.5]$。数量为 $3$。\n    - 子区域 $4$：$\\{\\lambda^{(4)}_j\\} = [0.01, 0.05, 0.2, 1.0, 2.0, 6.0]$。数量为 $3$。\n- 总维数：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 4 + 4 + 3 + 3 = 14$。\n\n**情况 2**：\n- 已知：$C_{\\text{stab}} = 25$。\n- 计算阈值：$\\theta = \\frac{25}{50} = 0.5$。\n- 统计特征值 $\\le 0.5$ 的数量：\n    - 子区域 $1$：$\\{\\lambda^{(1)}_j\\} = [0.6, 0.9, 1.2]$。数量为 $0$。\n    - 子区域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.7, 1.0, 1.5]$。数量为 $0$。\n    - 子区域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.55, 0.8, 3.0]$。数量为 $0$。\n- 总维数：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 0 + 0 + 0 = 0$。\n\n**情况 3**：\n- 已知：$C_{\\text{stab}} = 5$。\n- 计算阈值：$\\theta = \\frac{5}{50} = 0.1$。\n- 统计特征值 $\\le 0.1$ 的数量：\n    - 子区域 $1$：$\\{\\lambda^{(1)}_j\\} = [0.0005, 0.001, 0.005, 0.02, 0.3, 0.9]$。数量为 $4$。\n    - 子区域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.0003, 0.002, 0.007, 0.015, 0.08, 0.4]$。数量为 $5$。\n    - 子区域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.0008, 0.004, 0.012, 0.09, 0.2, 1.0]$。数量为 $4$。\n    - 子区域 $4$：$\\{\\lambda^{(4)}_j\\} = [0.0001, 0.003, 0.01, 0.04, 0.06, 0.08]$。数量为 $6$。\n- 总维数：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 4 + 5 + 4 + 6 = 19$。\n\n**情况 4**：\n- 已知：$C_{\\text{stab}} = 100$。\n- 计算阈值：$\\theta = \\frac{100}{50} = 2.0$。\n- 统计特征值 $\\le 2.0$ 的数量：\n    - 子区域 $1$：$\\{\\lambda^{(1)}_j\\} = [0.02, 0.2, 0.9, 1.8, 2.5, 5.0]$。数量为 $4$。\n    - 子区域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.03, 0.6, 1.4, 2.1, 4.0]$。数量为 $3$。\n    - 子区域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.05, 0.4, 0.7, 1.3, 2.7]$。数量为 $4$。\n    - 子区域 $4$：$\\{\\lambda^{(4)}_j\\} = [0.01, 0.08, 0.3, 0.8, 1.6, 3.6]$。数量为 $5$。\n- 总维数：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 4 + 3 + 4 + 5 = 16$。\n\n**情况 5**：\n- 已知：$C_{\\text{stab}} = 50$。\n- 计算阈值：$\\theta = \\frac{50}{50} = 1.0$。\n- 统计特征值 $\\le 1.0$ 的数量：\n    - 子区域 $1$：$\\{\\lambda^{(1)}_j\\} = [1.2, 1.5, 2.0]$。数量为 $0$。\n    - 子区域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.09, 0.2, 0.5, 0.9, 1.1]$。数量为 $4$。\n    - 子区域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.4, 0.7, 1.1, 1.8]$。数量为 $2$。\n- 总维数：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 0 + 4 + 2 = 6$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Estimates the GenEO coarse space dimension based on local eigenvalue spectra\n    and a target condition number.\n    \"\"\"\n    # Define the target condition number as per the problem statement.\n    kappa_target = 50.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (C_stab, list_of_eigenvalue_arrays)\n    test_cases = [\n        # Case 1\n        (25.0, [\n            np.array([0.012, 0.08, 0.12, 0.42, 1.1, 3.0]),\n            np.array([0.038, 0.09, 0.15, 0.5, 0.8, 2.2]),\n            np.array([0.02, 0.07, 0.25, 0.6, 1.5, 2.5]),\n            np.array([0.01, 0.05, 0.2, 1.0, 2.0, 6.0])\n        ]),\n        # Case 2\n        (25.0, [\n            np.array([0.6, 0.9, 1.2]),\n            np.array([0.7, 1.0, 1.5]),\n            np.array([0.55, 0.8, 3.0])\n        ]),\n        # Case 3\n        (5.0, [\n            np.array([0.0005, 0.001, 0.005, 0.02, 0.3, 0.9]),\n            np.array([0.0003, 0.002, 0.007, 0.015, 0.08, 0.4]),\n            np.array([0.0008, 0.004, 0.012, 0.09, 0.2, 1.0]),\n            np.array([0.0001, 0.003, 0.01, 0.04, 0.06, 0.08])\n        ]),\n        # Case 4\n        (100.0, [\n            np.array([0.02, 0.2, 0.9, 1.8, 2.5, 5.0]),\n            np.array([0.03, 0.6, 1.4, 2.1, 4.0]),\n            np.array([0.05, 0.4, 0.7, 1.3, 2.7]),\n            np.array([0.01, 0.08, 0.3, 0.8, 1.6, 3.6])\n        ]),\n        # Case 5\n        (50.0, [\n            np.array([1.2, 1.5, 2.0]),\n            np.array([0.09, 0.2, 0.5, 0.9, 1.1]),\n            np.array([0.4, 0.7, 1.1, 1.8])\n        ])\n    ]\n\n    results = []\n    for c_stab, subdomain_eigs_list in test_cases:\n        # Calculate the eigenvalue threshold theta.\n        theta = c_stab / kappa_target\n        \n        # Initialize the coarse space dimension for the current case.\n        coarse_space_dim = 0\n        \n        # Iterate over each subdomain's eigenvalue array.\n        for eig_array in subdomain_eigs_list:\n            # Count the number of eigenvalues less than or equal to the threshold.\n            # Since the arrays are sorted, a more efficient search could be used,\n            # but for small arrays, direct comparison is clear and sufficient.\n            count = np.sum(eig_array = theta)\n            coarse_space_dim += count\n            \n        results.append(int(coarse_space_dim))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}