{
    "hands_on_practices": [
        {
            "introduction": "双层Schwarz预条件子通过结合局部求解和全局粗网格校正，在并行计算中表现出色。然而，全局粗网格求解本身既是计算成本的来源，也是一个潜在的瓶颈。这个练习  旨在通过一个成本模型，帮助您量化并行组装粗算子的开销，并分析使用非精确粗求解器对整体收敛性能的影响，从而深入理解其中的权衡。",
            "id": "3586575",
            "problem": "考虑一个由计算地球物理学中使用的二阶椭圆偏微分方程模型产生的对称正定 (SPD) 线性系统 $A u = f$。使用了一个两层加性Schwarz预条件子，该方法包含 $S$ 个不重叠的子区域，每个子区域有 $n_{s}$ 个内部未知数。在每个子区域 $i \\in \\{1,\\dots,S\\}$ 上，局部刚度矩阵为 $A_{i} \\in \\mathbb{R}^{n_{s} \\times n_{s}}$，并且每个子区域使用 $r$ 个基函数来构建粗空间。全局粗空间限制算子为 $R_{0} \\in \\mathbb{R}^{n_{0} \\times n}$，其中 $n_{0} = r S$，$R_{0i} \\in \\mathbb{R}^{r \\times n_{s}}$ 表示 $R_{0}$ 中对应于子区域 $i$ 的分块。\n\n粗算子定义为 $A_{0} = R_{0} A R_{0}^{T}$，并且可以表示为局部贡献 $B_{i} = R_{0i} A_{i} R_{0i}^{T}$ 的和，这使其易于并行组装。假设一个浮点运算 (flop) 成本模型，并基于以下经过充分检验的事实：\n- 将一个稀疏矩阵 $A_{i}$ 应用到一个长度为 $n_{s}$ 的稠密向量上的成本是 $2 \\,\\mathrm{nnz}(A_{i})$ flops，其中 $\\mathrm{nnz}(A_{i})$ 是 $A_{i}$ 的非零元数量。\n- 计算两个长度为 $n_{s}$ 的稠密向量的内积的成本是 $2 n_{s}$ flops。\n- $A_{i}$ 每行的平均非零元数量是一个常数 $\\gamma > 0$，因此 $\\mathrm{nnz}(A_{i}) \\approx \\gamma n_{s}$。\n- 一次局部子区域求解（使用预先计算的稀疏Cholesky分解来应用一次 $A_{i}$ 的逆）需要一次前向和一次后向三角求解，其总成本约为 $4\\,\\mathrm{nnz}(L_{i})$ flops，其中 $\\mathrm{nnz}(L_{i})$ 是Cholesky因子中的非零元数量。假设填充因子 $\\theta > 1$，使得 $\\mathrm{nnz}(L_{i}) \\approx \\theta\\,\\mathrm{nnz}(A_{i})$。\n\n假设每个 $R_{0i}^{T}$ 都有 $r$ 个支撑在子区域 $i$ 上的稠密列，并且对于每个子区域，$B_{i}$ 通过以下步骤组装：\n1. 计算 $y_{j} = A_{i} v_{j}$，其中 $j = 1,\\dots,r$，$v_{j}$ 是 $R_{0i}^{T}$ 的第 $j$ 列。\n2. 形成 $r \\times r$ 的分块 $B_{i}$，其元素为 $(B_{i})_{jk} = v_{j}^{T} y_{k}$。\n\n在这些假设下：\n1. 推导 $A_{0}$ 的并行组装表达式，并用 $n_{s}$、$r$ 和 $\\gamma$ 表示每个子区域的总粗网格组装成本 $c_{\\mathrm{asm},i}$。\n2. 使用给定的模型，计算总粗网格组装成本与一次局部子区域求解（前向加后向代入）成本的比率 $R$，并用 $r$、$\\gamma$ 和 $\\theta$ 来简化 $R$。\n\n现在考虑使用不精确粗网格求解器的影响。令 $\\tilde{A}_{0}^{-1}$ 为 $A_{0}^{-1}$ 的一个近似逆，满足谱等价关系\n$$(1 - \\epsilon)\\, z^{T} A_{0}^{-1} z \\le z^{T} \\tilde{A}_{0}^{-1} z \\le (1 + \\epsilon)\\, z^{T} A_{0}^{-1} z \\quad \\text{for all } z \\in \\mathbb{R}^{n_{0}},$$\n其中 $0  \\epsilon  1$。令 $M^{-1}$ 表示精确的两层加性Schwarz预条件子，$M_{\\epsilon}^{-1}$ 表示将 $A_{0}^{-1}$ 替换为 $\\tilde{A}_{0}^{-1}$ 后的相同预条件子。假设使用精确粗网格求解的预条件算子的条件数为 $\\kappa = \\kappa(M^{-1} A)$。根据关于对称正定(SPD)问题的预条件共轭梯度法(PCG)的经过充分检验的事实，每次迭代在A-范数下的渐近收敛因子为 $q = \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}$。\n\n3. 展示不精确粗网格求解如何将条件数界修改为 $\\kappa' \\le \\kappa \\,\\frac{1 + \\epsilon}{1 - \\epsilon}$，并用 $\\kappa$ 和 $\\epsilon$ 写出相应的收敛因子 $q'$。\n\n将品质因数 $\\phi$ 定义为成本比率与退化后的收敛因子的乘积，即\n$$\\phi = R \\, q'.$$\n以参数 $r$, $\\gamma$, $\\theta$, $\\epsilon$ 和 $\\kappa$ 的形式，给出一个 $\\phi$ 的单一闭式解析表达式。答案需以无量纲形式表示。无需四舍五入。",
            "solution": "我们考虑一个对称正定(SPD)线性系统 $A u = f$ 和一个两层加性Schwarz预条件子。全局粗算子定义为 $A_{0} = R_{0} A R_{0}^{T}$。在一个包含 $S$ 个子区域的区域分解框架中，我们根据子区域划分未知数向量，并将限制算子 $R_{0}$ 分块表示为 $R_{0} = [ R_{0 1}  \\cdots  R_{0 S} ]$，其中每个 $R_{0 i} \\in \\mathbb{R}^{r \\times n_{s}}$ 将子区域 $i$ 的自由度映射到 $r$ 个粗空间基系数。局部子区域刚度矩阵为 $A_{i} \\in \\mathbb{R}^{n_{s} \\times n_{s}}$。在不重叠分解下，细网格层级矩阵 $A$ 可被视为由局部贡献分块组装而成，而粗算子可以组装为局部贡献之和\n$$\nA_{0} = \\sum_{i=1}^{S} R_{0 i} A_{i} R_{0 i}^{T}.\n$$\n此等式源于线性和 $R_{0}$ 作为行分块拼接的定义，这意味着 $R_{0} A R_{0}^{T}$ 收集了 $A$ 限制在每个子区域并投影到粗空间上的贡献。\n\n为了并行组装 $A_{0}$，每个子区域 $i$ 独立计算其局部粗分块\n$$\nB_{i} = R_{0 i} A_{i} R_{0 i}^{T} \\in \\mathbb{R}^{r \\times r},\n$$\n然后将这些 $r \\times r$ 的分块对 $i$ 求和以生成 $A_{0}$。在每个子区域 $i$ 上的算法实现如下：\n1. 令 $V_{i} = R_{0 i}^{T} \\in \\mathbb{R}^{n_{s} \\times r}$，其列为 $v_{1},\\dots,v_{r}$。对 $j = 1,\\dots,r$ 计算 $y_{j} = A_{i} v_{j}$。\n2. 通过 $(B_{i})_{jk} = v_{j}^{T} y_{k}$ (其中 $j,k = 1,\\dots,r$) 形成 $B_{i}$ 的元素。\n\n我们现在根据给定的模型计算每个子区域进行此组装的浮点运算次数。\n\n对于步骤1，每次将 $A_{i}$ 应用于一个稠密向量的成本为 $2\\,\\mathrm{nnz}(A_{i})$ flops。由于此操作执行 $r$ 次，因此在子区域 $i$ 上步骤1的总成本为\n$$\nc_{1,i} = 2 r\\, \\mathrm{nnz}(A_{i}).\n$$\n对于步骤2，需要计算 $r^{2}$ 个长度为 $n_{s}$ 的内积（在 $v_{j}$ 和 $y_{k}$ 之间）。每个内积的成本为 $2 n_{s}$ flops，因此总成本为\n$$\nc_{2,i} = 2 n_{s} r^{2}.\n$$\n因此，每个子区域的总粗网格组装成本为\n$$\nc_{\\mathrm{asm},i} = c_{1,i} + c_{2,i} = 2 r\\, \\mathrm{nnz}(A_{i}) + 2 n_{s} r^{2}.\n$$\n使用 $\\mathrm{nnz}(A_{i}) \\approx \\gamma n_{s}$，我们得到\n$$\nc_{\\mathrm{asm},i} \\approx 2 r \\gamma n_{s} + 2 n_{s} r^{2} = 2 n_{s} \\left( r \\gamma + r^{2} \\right).\n$$\n\n我们将其与使用预计算分解的一次局部子区域求解的成本进行比较。设Cholesky因子 $L_{i}$ 具有 $\\mathrm{nnz}(L_{i}) \\approx \\theta\\, \\mathrm{nnz}(A_{i})$ 个非零元，其中 $\\theta > 1$ 是一个填充因子。通过前向和后向代入应用一次 $A_{i}^{-1}$ 的成本大约为\n$$\nc_{\\mathrm{solve},i} \\approx 4\\,\\mathrm{nnz}(L_{i}) \\approx 4 \\theta\\, \\mathrm{nnz}(A_{i}) \\approx 4 \\theta \\gamma n_{s}.\n$$\n因此，每个子区域的粗网格组装成本与一次局部子区域求解成本的比率为\n$$\nR_{i} = \\frac{c_{\\mathrm{asm},i}}{c_{\\mathrm{solve},i}} \\approx \\frac{2 n_{s} \\left( r \\gamma + r^{2} \\right)}{4 \\theta \\gamma n_{s}} = \\frac{r \\gamma + r^{2}}{2 \\theta \\gamma} = \\frac{r}{2 \\theta} + \\frac{r^{2}}{2 \\theta \\gamma}.\n$$\n假设所有子区域都相同，则全局比率 $R$ 等于 $R_{i}$：\n$$\nR = \\frac{r}{2 \\theta} + \\frac{r^{2}}{2 \\theta \\gamma}.\n$$\n\n我们现在量化不精确粗网格求解器的影响。定义精确的两层预条件子为\n$$\nM^{-1} = \\sum_{i=1}^{S} R_{i}^{T} A_{i}^{-1} R_{i} + R_{0}^{T} A_{0}^{-1} R_{0},\n$$\n其中 $R_{i}$ 是到子区域自由度上的局部限制算子。不精确粗网格求解器将 $A_{0}^{-1}$ 替换为 $\\tilde{A}_{0}^{-1}$，满足\n$$\n(1 - \\epsilon)\\, z^{T} A_{0}^{-1} z \\le z^{T} \\tilde{A}_{0}^{-1} z \\le (1 + \\epsilon)\\, z^{T} A_{0}^{-1} z,\\quad \\forall z \\in \\mathbb{R}^{n_{0}},\n$$\n其中 $0  \\epsilon  1$。这意味着精确和不精确粗逆算子是谱等价的，其常数为 $(1 - \\epsilon)$ 和 $(1 + \\epsilon)$。因此，带有不精确粗网格求解的预条件子，\n$$\nM_{\\epsilon}^{-1} = \\sum_{i=1}^{S} R_{i}^{T} A_{i}^{-1} R_{i} + R_{0}^{T} \\tilde{A}_{0}^{-1} R_{0},\n$$\n与 $M^{-1}$ 谱等价：\n$$\n(1 - \\epsilon)\\, y^{T} M^{-1} y \\le y^{T} M_{\\epsilon}^{-1} y \\le (1 + \\epsilon)\\, y^{T} M^{-1} y,\\quad \\forall y \\in \\mathbb{R}^{n}.\n$$\n要理解这一点，可通过支撑两层方法的稳定分解将任意 $y$ 分解为局部和粗分量；唯一被修改的项是粗分量，根据对 $\\tilde{A}_{0}^{-1}$ 的假设等价关系，该分量被缩放了 $(1 \\pm \\epsilon)$。因此，对于预条件算子，瑞利商界 (Rayleigh quotient bounds) 意味着\n$$\n\\kappa(M_{\\epsilon}^{-1} A) \\le \\frac{1 + \\epsilon}{1 - \\epsilon}\\, \\kappa(M^{-1} A) = \\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}.\n$$\n令 $\\kappa' = \\kappa(M_{\\epsilon}^{-1} A)$ 表示不精确粗网格条件数界。则\n$$\n\\kappa' \\le \\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}.\n$$\n对于应用于SPD系统的预条件共轭梯度法(PCG)，每次迭代在A-范数下的渐近收敛因子由下式给出\n$$\nq = \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}.\n$$\n将 $\\kappa$ 替换为 $\\kappa'$ 得到\n$$\nq' = \\frac{\\sqrt{\\kappa'} - 1}{\\sqrt{\\kappa'} + 1} \\le \\frac{\\sqrt{\\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}} - 1}{\\sqrt{\\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}} + 1}.\n$$\n\n最后，将品质因数 $\\phi$ 定义为成本比率与退化后的收敛因子的乘积：\n$$\n\\phi = R \\, q' = \\left( \\frac{r}{2 \\theta} + \\frac{r^{2}}{2 \\theta \\gamma} \\right) \\, \\frac{\\sqrt{\\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}} - 1}{\\sqrt{\\kappa \\, \\frac{1 + \\epsilon}{1 - \\epsilon}} + 1}.\n$$\n该表达式是无量纲的，反映了并行粗网格组装成本与局部子区域求解的比较，以及不精确粗网格求解器如何影响每次迭代的渐近收敛性。",
            "answer": "$$\\boxed{\\left( \\frac{r}{2 \\theta} + \\frac{r^{2}}{2 \\theta \\gamma} \\right) \\,\\frac{\\sqrt{\\kappa \\,\\frac{1 + \\epsilon}{1 - \\epsilon}} - 1}{\\sqrt{\\kappa \\,\\frac{1 + \\epsilon}{1 - \\epsilon}} + 1}}$$"
        },
        {
            "introduction": "在计算地球物理学中，我们经常遇到具有高对比度介质属性的复杂地质模型，这对标准的区域分解方法构成了严峻挑战。一个设计不当的粗空间可能导致迭代求解器收敛极其缓慢甚至停滞。这个练习  揭示了此问题背后的根本原因——由非连通子区域导致的局部“浮动”模式——并阐明了设计鲁棒粗空间以确保收敛性的核心原则。",
            "id": "3586626",
            "problem": "考虑地下稳态流的非均质标量扩散模型，写为有界域 $\\Omega \\subset \\mathbb{R}^d$ 上的椭圆边值问题 $\\nabla \\cdot (\\kappa \\nabla u) = f$ 并带有适当的边界条件，其中 $\\kappa(\\mathbf{x})$ 表示一个正的空间变化的传导系数，它可能表现出计算地球物理学中典型的高对比度和几何复杂性。通过协调有限元法进行离散化，得到一个对称正定线性系统 $A u = b$，其双线性形式为 $a(u,v) = \\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, d\\mathbf{x}$。\n\n为了对 $A$ 进行预处理，考虑一种两层区域分解法，其中 $\\Omega$ 被划分为 $N$ 个不重叠的子区域 $\\{D_i\\}_{i=1}^N$，粗空间提供全局耦合，而局部空间与子区域求解器相关联。将与子区域 $D_i$ 对应的局部算子记为 $A_i$，该算子在内部界面上配备了齐次 Neumann 条件。在实践中，对于高对比度地质情况，由于存在不可渗透的夹杂物或空腔（例如盐体、空洞），子区域内部 $D_i$ 可能是不连通的，因此 $D_i = \\bigcup_{m=1}^{M_i} D_i^{(m)}$，其中每个 $D_i^{(m)}$ 是一个连通开集，且 $M_i \\ge 2$。\n\n从第一性原理出发，回顾一下 $D_i$ 上的局部 Neumann 算子 $A_i$ 是通过将 $a(\\cdot,\\cdot)$ 限制在 $H^1(D_i)$ 上来起作用的，并在界面 $\\partial D_i \\cap \\mathrm{int}(\\Omega)$ 上施加零法向通量。对于每个连通分量 $D_i^{(m)}$，局部能量 $a(\\cdot,\\cdot)$ 在支集于 $D_i^{(m)}$ 上的常数函数上为零；因此，零空间 $\\ker(A_i)$ 包含逐分量常数的张成空间，其维数至少为 $M_i$。\n\n在两层 Additive Schwarz 和 Balancing Domain Decomposition by Constraints (BDDC) 方法中，一个鲁棒的粗空间必须能捕捉全局低能量模态，否则这些模态会恶化条件数。在 Finite Element Tearing and Interconnecting - Dual-Primal (FETI-DP) 中也存在类似的要求。假设当前的粗空间每个子区域只包含一个平均值或只包含基于顶点的约束，而没有考虑到内部连通性的重数。\n\n哪个选项正确解释了为什么粗空间必须包含耦合不连通部分的模态，并提出了一种简单的扩充方法，以确保对上述非均质扩散算子进行适当的粗校正？\n\nA. 因为 $D_i$ 上的局部 Neumann 问题拥有一个由在每个连通分量 $D_i^{(m)}$ 上为常数的函数所张成的零空间，任何未能表示所有这些逐分量常数的粗空间都会在 $\\ker(A_i)$ 中留下未耦合的低能量模态，这些模态表现为预处理算子的小特征值。一个简单的扩充方法是，为每个子区域 $D_i$ 和每个分量 $D_i^{(m)}$ 添加一个粗基函数，该函数在 $D_i^{(m)}$ 上为常数（在别处为零），这等效于为每个连通分量施加一个原始约束（逐分量平均值），从而使得 $\\ker(A_i) \\subset \\mathrm{Range}$ of the coarse space。\n\nB. 因为 Krylov 方法在处理振荡波解时会停滞，补救措施是添加一个阻尼 Jacobi 光滑子；只要迭代方法频繁重启，粗空间扩充就不是必需的。\n\nC. 因为重叠不足会阻碍信息传递，将子区域之间的重叠增加一倍可以保证不连通内部的耦合，从而无需修改粗空间。\n\nD. 因为不连通的内部仅在几何顶点处导致秩亏，所以每个子区域添加一个基于顶点的粗自由度就足够了；不需要逐分量的约束或基函数。\n\nE. 因为高渗透率对比度会诱发高频气泡模态，用在所有界面上为零且在每个 $D_i$ 上平均值为零的子区域气泡函数来扩充粗空间，就足以耦合不连通的分量。",
            "solution": "用户希望我扮演一名 STEM 教授。我的任务是首先验证问题陈述的有效性，如果有效，则通过从第一性原理推导答案并评估每个选项来提供详细的解答。\n\n### 问题验证\n\n首先，我将根据指定程序验证问题陈述。\n\n**步骤1：提取已知条件**\n\n*   **控制方程：** 非均质标量扩散模型，$\\nabla \\cdot (\\kappa \\nabla u) = f$。\n*   **区域：** 一个有界域 $\\Omega \\subset \\mathbb{R}^d$。\n*   **边界条件：** “适当的边界条件”。\n*   **系数：** $\\kappa(\\mathbf{x})$ 是一个正的空间变化的传导系数，可能具有高对比度和几何复杂性。\n*   **离散化：** 协调有限元法，得到一个对称正定线性系统 $A u = b$。\n*   **双线性形式：** $a(u,v) = \\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, d\\mathbf{x}$。\n*   **预处理器：** 一种两层区域分解法（例如，Additive Schwarz、BDDC、FETI-DP）。\n*   **区域划分：** $\\Omega$ 被划分为 $N$ 个不重叠的子区域 $\\{D_i\\}_{i=1}^N$。\n*   **方法结构：** 用于全局耦合的粗空间和用于子区域求解器的局部空间。\n*   **局部算子：** $A_i$ 是子区域 $D_i$ 的局部算子，在内部界面（$\\partial D_i \\cap \\mathrm{int}(\\Omega)$）上具有齐次 Neumann 条件。它由 $a(\\cdot,\\cdot)$ 在 $H^1(D_i)$ 上的函数限制得到。\n*   **关键情景：** 子区域内部可能是不连通的，$D_i = \\bigcup_{m=1}^{M_i} D_i^{(m)}$，其中有 $M_i \\ge 2$ 个连通分量 $D_i^{(m)}$。\n*   **局部零空间：** 零空间 $\\ker(A_i)$ 包含在每个分量 $D_i^{(m)}$ 上为常数的函数的张成空间，其维数至少为 $M_i$。\n*   **有缺陷的粗空间：** 假设的粗空间不足，每个子区域只包含一个平均值或仅包含基于顶点的约束。\n*   **问题：** 确定哪个选项能正确解释为什么必须扩充粗空间以处理这种情况，以及什么样的简单、适当的扩充方法。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **有科学依据：** 该问题牢固地植根于偏微分方程数值分析和科学计算等成熟领域。扩散方程、有限元法和区域分解预处理器（Additive Schwarz、BDDC、FETI-DP）都是标准的、基础的课题。由复杂几何形状引起的处理不连通子区域的具体问题，在计算地球物理学等应用中是一个已知的实际挑战。局部 Neumann 算子零空间的特征是偏微分方程理论中的标准结果。该问题在科学上和数学上都是健全的。\n*   **适定的：** 问题是适定的。它在一组明确定义的条件下，提出了一个关于设计鲁棒区域分解预处理器的清晰、具体的问题。基于这些方法的既定理论，可以预料存在一个答案。\n*   **客观的：** 问题以精确、客观和技术性的语言陈述。它没有主观论断或含糊不清之处。\n\n**缺陷清单：**\n\n1.  **科学或事实上的不健全：** 无。前提是正确的。在一个具有 $M_i$ 个连通分量的区域上的 Neumann 问题的零空间确实是 $M_i$ 维的。\n2.  **不可形式化或不相关：** 无。该问题高度形式化，与主题直接相关。\n3.  **不完整或矛盾的设置：** 无。虽然 $\\Omega$ 上的全局边界条件未指定，但它们对于分析区域分解预处理器的内部结构（这是问题的重点）不是必需的。该设置是自洽和一致的。\n4.  **不切实际或不可行：** 无。不可渗透夹杂物导致不连通子区域的物理情景在地球物理学和其他领域是现实的。\n5.  **不适定或结构不良：** 无。问题逻辑清晰，没有循环推理，并使用标准的、定义明确的术语。\n6.  **伪深刻、琐碎或同义反复：** 无。这涉及一个确保高级预处理器鲁棒性的关键且不平凡的概念。\n7.  **超出科学可验证性：** 无。所涉及的原理在数学上是可证明的，在数值上是可验证的。\n\n**步骤3：结论与行动**\n\n问题陈述**有效**。我将继续推导解答。\n\n### 解答推导\n\n两层区域分解预处理子的有效性取决于局部求解器和全局粗校正之间的适当相互作用。该预处理器在概念上可以写成一个粗校正算子和一组局部校正算子之和。如果预处理算子 $M^{-1}A$ 的谱被有利地聚集，理想情况下其条件数与离散化参数（$h$）和子区域数量（$N$）无关，那么诸如预处理共轭梯度（PCG）法之类的迭代方法会快速收敛。\n\n核心原理是将解空间分解为粗分量和局部分量。粗分量处理低频、全局尺度的误差分量，而局部求解器处理高频、局部尺度的误差分量。一个函数 $u$ 的“能量”由双线性形式 $a(u,u) = \\int_{\\Omega} \\kappa |\\nabla u|^2 d\\mathbf{x}$ 给出。对于区域分解方法而言，有问题的误差模态是那些能量低但在粗空间中未得到良好表示的模态。\n\n在问题的背景下，局部求解器对应于对局部算子 $A_i$ 进行求逆（或近似求逆）。这些算子定义在子区域 $D_i$ 上，在内部边界上具有齐次 Neumann 条件。与 $A_i$ 相关的能量是 $a_i(u_i, u_i) = \\int_{D_i} \\kappa |\\nabla u_i|^2 d\\mathbf{x}$。$A_i$ 的零空间，记为 $\\ker(A_i)$，由使该能量为零的函数 $u_i \\in H^1(D_i)$ 组成。由于 $\\kappa > 0$，这意味着在整个 $D_i$ 上 $\\nabla u_i = \\mathbf{0}$。\n\n问题陈述指出，一个子区域 $D_i$ 可能由 $M_i$ 个不相交的连通分量组成，$D_i = \\bigcup_{m=1}^{M_i} D_i^{(m)}$。一个函数 $u_i$ 在 $D_i$ 上的梯度为零，当且仅当它在每个连通分量 $D_i^{(m)}$ 上为常数。不同分量上的常数值可以不同。令 $\\chi_i^{(m)}$ 为分量 $D_i^{(m)}$ 上的特征函数。那么，$\\ker(A_i)$ 中的任何函数都具有形式 $\\sum_{m=1}^{M_i} c_m \\chi_i^{(m)}$，其中 $c_m$ 是某些常数。这意味着零空间 $\\ker(A_i)$ 是一个由这些逐分量常数函数张成的 $M_i$ 维向量空间。这些是子区域的“浮动模态”。\n\n对于鲁棒的两层预处理子，特别是像 BDDC 和 FETI-DP 这样的方法，一个基本要求是粗空间必须包含属于局部问题零空间的所有模态。换句话说，任何局部求解器“看不见”的函数（即具有零局部能量）必须被粗求解器完全捕捉和约束。如果违反此条件，这些零空间模态就无法被预处理子的局部或粗糙部分正确校正。它们表现为被预处理子局部部分消除但不受粗网格控制的误差分量。这会导致预处理算子的特征值非常接近于零，从而使条件数变得极大，并严重降低 Krylov 求解器的收敛速度。\n\n问题中提到的“有缺陷的”粗空间（每个子区域一个平均值，或顶点约束）在 $M_i > 1$ 时无法通过此测试。$D_i$ 上的单个平均约束仅约束了 $M_i$ 个逐分量常数的一个线性组合，留下了 $M_i - 1$ 个浮动模态未受约束。顶点约束通常也是不足的，因为一个浮动分量可能不包含任何选定的顶点。\n\n直接且正确的补救措施是扩充粗空间，以确保它可以表示所有 $i=1, \\dots, N$ 的 $\\ker(A_i)$ 中的任何函数。实现这一目标的最简单方法是为每个子区域 $D_i$ 的每个连通分量 $D_i^{(m)}$ 引入一个粗自由度。在像 BDDC 这样的原始方法中，这转化为对每个分量施加一个约束，例如解在该分量上的平均值。在像 FETI-DP 这样的对偶方法或 Additive Schwarz 的粗空间构造中，这对应于为每个分量添加一个粗基函数，其中基函数通常是该分量的特征函数 $\\chi_i^{(m)}$。这种扩充确保了对所有 $i$ 都满足条件 $\\ker(A_i) \\subset \\text{Range of Coarse Interpolation}$（粗插值的值域），从而恢复了鲁棒性。\n\n### 逐项分析\n\n**A. 因为 $D_i$ 上的局部 Neumann 问题拥有一个由在每个连通分量 $D_i^{(m)}$ 上为常数的函数所张成的零空间，任何未能表示所有这些逐分量常数的粗空间都会在 $\\ker(A_i)$ 中留下未耦合的低能量模态，这些模态表现为预处理算子的小特征值。一个简单的扩充方法是，为每个子区域 $D_i$ 和每个分量 $D_i^{(m)}$ 添加一个粗基函数，该函数在 $D_i^{(m)}$ 上为常数（在别处为零），这等效于为每个连通分量施加一个原始约束（逐分量平均值），从而使得 $\\ker(A_i) \\subset \\mathrm{Range}$ of the coarse space。**\n\n*   **分析：** 此选项提供了完整而准确的说明。它正确地识别了局部 Neumann 问题的零空间（由逐分量常数构成的 $M_i$ 维空间）。它正确地诊断了有缺陷的粗空间的后果：来自 $\\ker(A_i)$ 的未耦合低能量模态，这会导致预处理算子出现小特征值。最后，它提出了标准且正确的扩充方法：每个连通分量一个粗自由度，并正确地将粗基函数（Schwarz/FETI-DP 视角）和原始约束（BDDC 视角）的概念联系起来。最后一句正确地陈述了鲁棒性的数学条件。\n*   **结论：** 正确。\n\n**B. 因为 Krylov 方法在处理振荡波解时会停滞，补救措施是添加一个阻尼 Jacobi 光滑子；只要迭代方法频繁重启，粗空间扩充就不是必需的。**\n\n*   **分析：** 这个选项有根本性的缺陷。问题是扩散问题，有问题的模态是低能量（非振荡）的，这与像 Jacobi 这样的光滑子设计用来处理的情况恰恰相反。粗空间对于处理这些低频模态至关重要。重启 Krylov 方法并不能修复一个导致巨大条件数的劣质预处理器。\n*   **结论：** 错误。\n\n**C. 因为重叠不足会阻碍信息传递，将子区域之间的重叠增加一倍可以保证不连通内部的耦合，从而无需修改粗空间。**\n\n*   **分析：** 这个选项具有误导性。问题是针对不重叠子区域陈述的，这是 BDDC 和 FETI-DP 的标准设置。增加重叠与 Schwarz 方法有关，但即使在那里，它也无法解决局部零空间模态的根本问题。粗网格提供全局刚性，这一作用不能简单地通过增加局部重叠来替代。重叠有助于信息跨界面传播，但它无法约束完全位于子区域内部的模态。\n*   **结论：** 错误。\n\n**D. 因为不连通的内部仅在几何顶点处导致秩亏，所以每个子区域添加一个基于顶点的粗自由度就足够了；不需要逐分量的约束或基函数。**\n\n*   **分析：** 这是不正确的。秩亏是局部算子在整个不连通子区域 $D_i$ 上的一个属性；它并非局部化于“几何顶点处”。一个不连通的分量（例如，一个内部空洞）可能不接触任何顶点，因此其浮动模态不会受到基于顶点的自由度的约束。问题陈述本身就表明这种简单的粗空间是不够的。\n*   **结论：** 错误。\n\n**E. 因为高渗透率对比度会诱发高频气泡模态，用在所有界面上为零且在每个 $D_i$ 上平均值为零的子区域气泡函数来扩充粗空间，就足以耦合不连通的分量。**\n\n*   **分析：** 这个选项混淆了多个概念。问题在于拓扑不连通性，而不是高对比度（尽管它们经常一起出现）。有问题的模态是低频常数，而不是高频气泡模态。粗空间用于处理低频模态。在边界上为零的气泡函数，根据定义，与构成 Neumann 算子零空间的常数函数是正交的。这种提议的“扩充”对当前的问题毫无作用。\n*   **结论：** 错误。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "构建一个鲁棒的粗空间至关重要，但在复杂的地质模型中手动识别所有必要的粗基函数是不切实际的。像GenEO这样的自适应方法通过在每个子区域上求解局部特征值问题来自动识别和构建粗空间，从而提供了强大的解决方案。这个练习  将指导您通过一个实际的编程任务，根据局部特征值分布和目标条件数来估算所需的自适应粗空间维度，从而将抽象的理论与实际应用联系起来。",
            "id": "3586617",
            "problem": "考虑在地下流体建模中遇到的标量椭圆算子，其控制方程为非均匀扩散问题 $-\\nabla \\cdot (k(\\mathbf{x}) \\nabla u(\\mathbf{x})) = f(\\mathbf{x})$，其中非均匀渗透率 $k(\\mathbf{x})$ 取自 Society of Petroleum Engineers (SPE) 的基准数据。假设 SPE10 第 $85$ 层的数据被映射到矩形域上的分段线性 ($P_1$) 有限元 (FEM) 网格上，并使用重叠区域分解来预处理得到的线性系统。重点关注由 GenEO (Generalized Eigenproblems in the Overlap) 构建的自适应谱粗空间增强的两层加性 Schwarz 预条件。\n\n从标准弱形式和基于重叠的单位分解出发，GenEO 方法为每个子域 $\\Omega_i$ 构建一个局部广义特征值问题，其瑞利商用于衡量函数被局部求解器加上重叠部分表示不佳的倾向性。通过选择特征值低于选定阈值的局部特征向量，并通过单位分解将其扩展，来组装一个实用的粗空间。自适应阈值在粗空间维度成本与预条件子质量之间进行权衡。\n\n您的任务是使用特征值-阈值选择规则，估算为达到目标预处理条件数 $ \\kappa \\le 50 $ 所需的粗空间维度。使用以下原理：如果对于每个子域 $\\Omega_i$，所有特征值为 $ \\lambda \\le \\theta $ 的局部广义特征模态都包含在粗空间中，那么在剩余子空间上，局部瑞利商满足 $ \\lambda \\ge \\theta $，这将产生一个有界的全局条件数\n$$\n\\kappa \\le \\frac{C_{\\text{stab}}}{\\theta},\n$$\n其中 $ C_{\\text{stab}} $ 是一个稳定性常数，它取决于分解的几何结构、重叠大小和单位分解权重（但在粗空间被扩充后与系数对比度无关）。为达到目标 $ \\kappa_{\\text{target}} = 50 $，选择阈值\n$$\n\\theta = \\frac{C_{\\text{stab}}}{\\kappa_{\\text{target}}}.\n$$\n然后，将每个子域中不大于 $ \\theta $ 的局部特征值的数量相加，计算出估算的粗空间维度：\n$$\n\\dim(\\mathcal{V}_{\\text{coarse}}) \\approx \\sum_{i} \\#\\{\\lambda^{(i)}_j \\,|\\, \\lambda^{(i)}_j \\le \\theta\\}.\n$$\n假设特征值是无量纲的（广义特征值问题使用重叠权重和有限元质量形式进行归一化），维度估算为上述的整数计数。\n\n实现一个程序，对于每个测试用例，其输入为：\n- 一个局部特征值数组的列表 $[\\{\\lambda^{(1)}_j\\}, \\{\\lambda^{(2)}_j\\}, \\ldots]$，每个子域一个数组，每个数组都按升序排序，并包含映射到 $P_1$ 有限元网格上的 SPE10 第 $85$ 层渗透率的代表性特征值。\n- 给定重叠配置的稳定性常数 $ C_{\\text{stab}} $。\n\n程序必须：\n- 对所有情况设置 $ \\kappa_{\\text{target}} = 50 $。\n- 计算 $ \\theta = C_{\\text{stab}} / \\kappa_{\\text{target}} $。\n- 对所有子域，计算并求和特征值 $ \\lambda \\le \\theta $ 的数量。\n- 返回此和作为该情况的估算粗空间维度。\n\n为以下旨在探究不同情景的测试套件提供结果：\n\n- 情况 1（中等非均匀性，理想情况）：$ C_{\\text{stab}} = 25 $。子域特征值：\n  - 子域 $1$：$[0.012, 0.08, 0.12, 0.42, 1.1, 3.0]$\n  - 子域 $2$：$[0.038, 0.09, 0.15, 0.5, 0.8, 2.2]$\n  - 子域 $3$：$[0.02, 0.07, 0.25, 0.6, 1.5, 2.5]$\n  - 子域 $4$：$[0.01, 0.05, 0.2, 1.0, 2.0, 6.0]$\n- 情况 2（边界情况：阈值低于所有局部特征值，导致不添加粗模态）：$ C_{\\text{stab}} = 25 $。子域特征值：\n  - 子域 $1$：$[0.6, 0.9, 1.2]$\n  - 子域 $2$：$[0.7, 1.0, 1.5]$\n  - 子域 $3$：$[0.55, 0.8, 3.0]$\n- 情况 3（极端高对比度，许多非常小的局部特征值）：$ C_{\\text{stab}} = 5 $。子域特征值：\n  - 子域 $1$：$[0.0005, 0.001, 0.005, 0.02, 0.3, 0.9]$\n  - 子域 $2$：$[0.0003, 0.002, 0.007, 0.015, 0.08, 0.4]$\n  - 子域 $3$：$[0.0008, 0.004, 0.012, 0.09, 0.2, 1.0]$\n  - 子域 $4$：$[0.0001, 0.003, 0.01, 0.04, 0.06, 0.08]$\n- 情况 4（更大的重叠常数，允许更大的阈值）：$ C_{\\text{stab}} = 100 $。子域特征值：\n  - 子域 $1$：$[0.02, 0.2, 0.9, 1.8, 2.5, 5.0]$\n  - 子域 $2$：$[0.03, 0.6, 1.4, 2.1, 4.0]$\n  - 子域 $3$：$[0.05, 0.4, 0.7, 1.3, 2.7]$\n  - 子域 $4$：$[0.01, 0.08, 0.3, 0.8, 1.6, 3.6]$\n- 情况 5（跨子域的混合行为）：$ C_{\\text{stab}} = 50 $。子域特征值：\n  - 子域 $1$：$[1.2, 1.5, 2.0]$\n  - 子域 $2$：$[0.09, 0.2, 0.5, 0.9, 1.1]$\n  - 子域 $3$：$[0.4, 0.7, 1.1, 1.8]$\n\n最终输出格式要求：您的程序应生成单行输出，其中包含情况 1 到 5 的结果，按顺序以逗号分隔的列表形式包含在方括号内，例如 $[n_1,n_2,n_3,n_4,n_5]$，其中每个 $n_i$ 是估算的粗空间维度（一个整数）。不应打印任何其他文本。本问题中的所有量都是无量纲的，因此不需要物理单位。不出现角度。不使用百分比。",
            "solution": "所陈述的问题必须首先经过严格的验证，以确保其在科学上是合理的、自洽的且适定的。\n\n**问题验证**\n\n**1. 提取的已知条件**\n- **控制方程**：$-\\nabla \\cdot (k(\\mathbf{x}) \\nabla u(\\mathbf{x})) = f(\\mathbf{x})$，其中包含非均匀渗透率 $k(\\mathbf{x})$。\n- **离散化与分解**：分段线性 ($P_1$) 有限元 (FEM) 网格，重叠区域分解。\n- **预处理方法**：由 GenEO (Generalized Eigenproblems in the Overlap) 构建的自适应谱粗空间增强的两层加性 Schwarz 预条件。\n- **条件数界**：$\\kappa \\le \\frac{C_{\\text{stab}}}{\\theta}$，其中 $\\theta$ 是一个特征值阈值，$C_{\\text{stab}}$ 是一个稳定性常数。\n- **目标条件数**：$\\kappa_{\\text{target}} = 50$。\n- **阈值选择规则**：$\\theta = \\frac{C_{\\text{stab}}}{\\kappa_{\\text{target}}}$。\n- **粗空间维度估算**：$\\dim(\\mathcal{V}_{\\text{coarse}}) \\approx \\sum_{i} \\#\\{\\lambda^{(i)}_j \\,|\\, \\lambda^{(i)}_j \\le \\theta\\}$。\n- **测试用例**：\n    - **情况 1**：$C_{\\text{stab}} = 25$。特征值：$\\{\\lambda^{(1)}_j\\} = [0.012, 0.08, 0.12, 0.42, 1.1, 3.0]$, $\\{\\lambda^{(2)}_j\\} = [0.038, 0.09, 0.15, 0.5, 0.8, 2.2]$, $\\{\\lambda^{(3)}_j\\} = [0.02, 0.07, 0.25, 0.6, 1.5, 2.5]$, $\\{\\lambda^{(4)}_j\\} = [0.01, 0.05, 0.2, 1.0, 2.0, 6.0]$。\n    - **情况 2**：$C_{\\text{stab}} = 25$。特征值：$\\{\\lambda^{(1)}_j\\} = [0.6, 0.9, 1.2]$, $\\{\\lambda^{(2)}_j\\} = [0.7, 1.0, 1.5]$, $\\{\\lambda^{(3)}_j\\} = [0.55, 0.8, 3.0]$。\n    - **情况 3**：$C_{\\text{stab}} = 5$。特征值：$\\{\\lambda^{(1)}_j\\} = [0.0005, 0.001, 0.005, 0.02, 0.3, 0.9]$, $\\{\\lambda^{(2)}_j\\} = [0.0003, 0.002, 0.007, 0.015, 0.08, 0.4]$, $\\{\\lambda^{(3)}_j\\} = [0.0008, 0.004, 0.012, 0.09, 0.2, 1.0]$, $\\{\\lambda^{(4)}_j\\} = [0.0001, 0.003, 0.01, 0.04, 0.06, 0.08]$。\n    - **情况 4**：$C_{\\text{stab}} = 100$。特征值：$\\{\\lambda^{(1)}_j\\} = [0.02, 0.2, 0.9, 1.8, 2.5, 5.0]$, $\\{\\lambda^{(2)}_j\\} = [0.03, 0.6, 1.4, 2.1, 4.0]$, $\\{\\lambda^{(3)}_j\\} = [0.05, 0.4, 0.7, 1.3, 2.7]$, $\\{\\lambda^{(4)}_j\\} = [0.01, 0.08, 0.3, 0.8, 1.6, 3.6]$。\n    - **情况 5**：$C_{\\text{stab}} = 50$。特征值：$\\{\\lambda^{(1)}_j\\} = [1.2, 1.5, 2.0]$, $\\{\\lambda^{(2)}_j\\} = [0.09, 0.2, 0.5, 0.9, 1.1]$, $\\{\\lambda^{(3)}_j\\} = [0.4, 0.7, 1.1, 1.8]$。\n\n**2. 分析**\n该问题具有科学依据，其前提源于区域分解预条件子的既定理论，特别是 GenEO 方法，这是偏微分方程数值分析中的一个重要研究课题。该问题是适定的，因为它提供了一个确定性的程序和所有必要的输入来计算唯一的输出。它使用精确的数学和计算术语，是客观的。它没有违反任何科学原理，也不包含不完整或矛盾的信息。它代表了 GenEO 收敛理论在估算一个关键参数——粗空间维度——方面的一个简化但基本正确的应用。\n\n**3. 结论**\n问题有效。我们可以继续进行求解。\n\n**解答**\n\n目标是为两层加性 Schwarz 预条件子估算自适应粗空间 $\\dim(\\mathcal{V}_{\\text{coarse}})$ 的维度。粗空间是使用 GenEO 方法构建的，该方法选择与定义在子域重叠部分上的广义特征值问题的小特征值相对应的局部特征模态。\n\n核心原理是预处理系统条件数 $\\kappa$ 的理论界限：\n$$\n\\kappa \\le \\frac{C_{\\text{stab}}}{\\theta}\n$$\n此处，$C_{\\text{stab}}$ 是一个取决于区域分解几何结构的常数，而 $\\theta$ 是用于选择粗空间特征模态的阈值。为确保条件数保持在目标值 $\\kappa_{\\text{target}}$ 以下，我们必须选择 $\\theta$ 使得：\n$$\n\\kappa_{\\text{target}} \\ge \\frac{C_{\\text{stab}}}{\\theta} \\implies \\theta \\le \\frac{C_{\\text{stab}}}{\\kappa_{\\text{target}}}\n$$\n为了创建满足此界限的最经济的粗空间，我们选择可能的最大阈值 $\\theta$，即：\n$$\n\\theta = \\frac{C_{\\text{stab}}}{\\kappa_{\\text{target}}}\n$$\n问题指定了目标条件数 $\\kappa_{\\text{target}} = 50$。\n\n一旦对于给定的 $C_{\\text{stab}}$ 确定了 $\\theta$，粗空间的估算维度通过对每个子域 $\\Omega_i$ 中小于或等于此阈值的局部特征值 $\\lambda^{(i)}_j$ 的数量求和得到：\n$$\n\\dim(\\mathcal{V}_{\\text{coarse}}) = \\sum_{i} \\#\\{\\lambda^{(i)}_j \\,|\\, \\lambda^{(i)}_j \\le \\theta\\}\n$$\n我们将此程序应用于所提供的五个测试用例中的每一个。\n\n**情况 1**：\n- 给定：$C_{\\text{stab}} = 25$。\n- 计算阈值：$\\theta = \\frac{25}{50} = 0.5$。\n- 计算特征值 $\\le 0.5$ 的数量：\n    - 子域 $1$：$\\{\\lambda^{(1)}_j\\} = [0.012, 0.08, 0.12, 0.42, 1.1, 3.0]$。数量为 $4$。\n    - 子域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.038, 0.09, 0.15, 0.5, 0.8, 2.2]$。数量为 $4$。\n    - 子域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.02, 0.07, 0.25, 0.6, 1.5, 2.5]$。数量为 $3$。\n    - 子域 $4$：$\\{\\lambda^{(4)}_j\\} = [0.01, 0.05, 0.2, 1.0, 2.0, 6.0]$。数量为 $3$。\n- 总维度：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 4 + 4 + 3 + 3 = 14$。\n\n**情况 2**：\n- 给定：$C_{\\text{stab}} = 25$。\n- 计算阈值：$\\theta = \\frac{25}{50} = 0.5$。\n- 计算特征值 $\\le 0.5$ 的数量：\n    - 子域 $1$：$\\{\\lambda^{(1)}_j\\} = [0.6, 0.9, 1.2]$。数量为 $0$。\n    - 子域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.7, 1.0, 1.5]$。数量为 $0$。\n    - 子域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.55, 0.8, 3.0]$。数量为 $0$。\n- 总维度：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 0 + 0 + 0 = 0$。\n\n**情况 3**：\n- 给定：$C_{\\text{stab}} = 5$。\n- 计算阈值：$\\theta = \\frac{5}{50} = 0.1$。\n- 计算特征值 $\\le 0.1$ 的数量：\n    - 子域 $1$：$\\{\\lambda^{(1)}_j\\} = [0.0005, 0.001, 0.005, 0.02, 0.3, 0.9]$。数量为 $4$。\n    - 子域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.0003, 0.002, 0.007, 0.015, 0.08, 0.4]$。数量为 $5$。\n    - 子域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.0008, 0.004, 0.012, 0.09, 0.2, 1.0]$。数量为 $4$。\n    - 子域 $4$：$\\{\\lambda^{(4)}_j\\} = [0.0001, 0.003, 0.01, 0.04, 0.06, 0.08]$。数量为 $6$。\n- 总维度：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 4 + 5 + 4 + 6 = 19$。\n\n**情况 4**：\n- 给定：$C_{\\text{stab}} = 100$。\n- 计算阈值：$\\theta = \\frac{100}{50} = 2.0$。\n- 计算特征值 $\\le 2.0$ 的数量：\n    - 子域 $1$：$\\{\\lambda^{(1)}_j\\} = [0.02, 0.2, 0.9, 1.8, 2.5, 5.0]$。数量为 $4$。\n    - 子域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.03, 0.6, 1.4, 2.1, 4.0]$。数量为 $3$。\n    - 子域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.05, 0.4, 0.7, 1.3, 2.7]$。数量为 $4$。\n    - 子域 $4$：$\\{\\lambda^{(4)}_j\\} = [0.01, 0.08, 0.3, 0.8, 1.6, 3.6]$。数量为 $5$。\n- 总维度：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 4 + 3 + 4 + 5 = 16$。\n\n**情况 5**：\n- 给定：$C_{\\text{stab}} = 50$。\n- 计算阈值：$\\theta = \\frac{50}{50} = 1.0$。\n- 计算特征值 $\\le 1.0$ 的数量：\n    - 子域 $1$：$\\{\\lambda^{(1)}_j\\} = [1.2, 1.5, 2.0]$。数量为 $0$。\n    - 子域 $2$：$\\{\\lambda^{(2)}_j\\} = [0.09, 0.2, 0.5, 0.9, 1.1]$。数量为 $4$。\n    - 子域 $3$：$\\{\\lambda^{(3)}_j\\} = [0.4, 0.7, 1.1, 1.8]$。数量为 $2$。\n- 总维度：$\\dim(\\mathcal{V}_{\\text{coarse}}) = 0 + 4 + 2 = 6$。",
            "answer": "$$\\boxed{[14,0,19,16,6]}$$"
        }
    ]
}