{
    "hands_on_practices": [
        {
            "introduction": "The numerical difficulty of solving the Helmholtz equation stems from the spectral properties of the resulting discrete operator. This practice provides a direct way to explore these properties by decomposing the complex-shifted operator $A = K - (1 + \\mathrm{i} \\alpha) k^2 I$ into its Hermitian and skew-Hermitian parts. Analyzing the eigenvalues of these components reveals the indefiniteness of the system, which is the root cause of slow convergence for many iterative solvers.",
            "id": "3614268",
            "problem": "You are given a two-dimensional discrete Helmholtz operator arising from a constant-wavenumber model problem on the unit square with homogeneous Dirichlet boundary conditions, a common setup in computational geophysics for simulating time-harmonic wave propagation. Let $N_x$ and $N_y$ be the number of interior grid points in the $x$ and $y$ directions, respectively, with uniform grid spacing $h_x = \\frac{1}{N_x+1}$ and $h_y = \\frac{1}{N_y+1}$. Define the negative discrete Laplacian in one dimension, $T \\in \\mathbb{R}^{N \\times N}$, using the standard second-order central finite-difference stencil with homogeneous Dirichlet boundary conditions:\n$$\nT = \\frac{1}{h^2} \\operatorname{tridiag}(-1,\\,2,\\,-1),\n$$\nwhere $h$ is the grid spacing, and $\\operatorname{tridiag}(-1,\\,2,\\,-1)$ denotes the tridiagonal matrix with $2$ on the main diagonal and $-1$ on the first sub- and super-diagonals. The two-dimensional negative discrete Laplacian is the Kronecker sum\n$$\nK = I_{N_y} \\otimes T_x + T_y \\otimes I_{N_x},\n$$\nwhere $T_x$ and $T_y$ are the one-dimensional operators in the $x$ and $y$ directions, respectively, and $I_{N}$ denotes the $N \\times N$ identity matrix.\n\nLet the wavenumber be $k$ and define $k^2$ as a given nonnegative real scalar. Consider the complex-shifted discrete Helmholtz operator\n$$\nA = K - (1 + \\mathrm{i} \\alpha) k^2 I,\n$$\nwhere $\\alpha \\ge 0$ is the shift parameter used in shifted-Laplace preconditioning, $\\mathrm{i}$ is the imaginary unit, and $I$ is the identity matrix of appropriate dimension. Decompose $A$ into its Hermitian and skew-Hermitian parts,\n$$\nH = \\frac{A + A^*}{2}, \\quad S = \\frac{A - A^*}{2},\n$$\nwhere $A^*$ denotes the conjugate transpose of $A$.\n\nYour tasks are:\n1. Construct $K$ using the above definitions on a uniform rectangular grid with homogeneous Dirichlet boundary conditions.\n2. Form $A$, compute $H$ and $S$, and compute the eigenvalues of $H$ and $S$.\n3. Classify the eigenvalues of $H$ by the sign of their real values into three counts: strictly positive, approximately zero, and strictly negative. For numerical robustness, define a tolerance\n$$\n\\tau_H = 10^{-10} \\max\\left(1, \\max_j \\left| \\lambda_j(H) \\right| \\right),\n$$\nand classify an eigenvalue $\\lambda$ of $H$ as approximately zero if $\\left| \\lambda \\right| \\le \\tau_H$, strictly positive if $\\lambda > \\tau_H$, and strictly negative if $\\lambda  -\\tau_H$.\n4. Classify the eigenvalues of $S$ by the sign of their imaginary parts into three counts: strictly positive imaginary part, approximately zero imaginary part, and strictly negative imaginary part. Define\n$$\n\\tau_S = 10^{-10} \\max\\left(1, \\max_j \\left| \\operatorname{Im}(\\mu_j(S)) \\right| \\right),\n$$\nand classify an eigenvalue $\\mu$ of $S$ as approximately zero imaginary part if $\\left| \\operatorname{Im}(\\mu) \\right| \\le \\tau_S$, strictly positive imaginary part if $\\operatorname{Im}(\\mu) > \\tau_S$, and strictly negative imaginary part if $\\operatorname{Im}(\\mu)  -\\tau_S$.\n\nUse the following test suite of parameter sets $(N_x, N_y, k^2, \\alpha)$:\n- Case 1 (happy path, purely Hermitian Helmholtz): $(8, 8, 0.1, 0.0)$.\n- Case 2 (mixed-sign Hermitian spectrum, no shift): $(16, 16, 400.0, 0.0)$.\n- Case 3 (strongly indefinite Hermitian part, no shift): $(8, 8, 10000.0, 0.0)$.\n- Case 4 (nonzero skew-Hermitian part from complex shift): $(10, 10, 100.0, 0.5)$.\n\nFor each case, output a list of six integers in the order\n$$\n[\\#H_{+},\\, \\#H_{0},\\, \\#H_{-},\\, \\#S_{+i},\\, \\#S_{0i},\\, \\#S_{-i}],\n$$\nwhere $\\#H_{+}$ is the count of strictly positive eigenvalues of $H$, $\\#H_{0}$ is the count of approximately zero eigenvalues of $H$, $\\#H_{-}$ is the count of strictly negative eigenvalues of $H$, and $\\#S_{+i}$, $\\#S_{0i}$, $\\#S_{-i}$ are the corresponding counts for the imaginary parts of eigenvalues of $S$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one list per test case, in the same order as the test suite. For example, the output should look like\n$$\n[[a_1,a_2,a_3,a_4,a_5,a_6],[b_1,b_2,b_3,b_4,b_5,b_6],[c_1,c_2,c_3,c_4,c_5,c_6],[d_1,d_2,d_3,d_4,d_5,d_6]]\n$$\nwhere each symbol represents an integer count as defined above. No physical units are involved; all quantities are dimensionless. Angles are not used.",
            "solution": "The problem is well-posed and scientifically grounded, providing a complete set of definitions and parameters to analyze the spectral properties of a discrete Helmholtz operator. All aspects of the problem are formally defined and computationally tractable.\n\nThe primary task is to categorize the eigenvalues of the Hermitian part $H$ and the skew-Hermitian part $S$ of the complex-shifted discrete Helmholtz operator $A = K - (1 + \\mathrm{i} \\alpha) k^2 I$. The matrix $A$ is defined on a grid of size $N_x \\times N_y$, resulting in a total matrix dimension of $N \\times N$, where $N = N_x N_y$.\n\nFirst, we derive the explicit expressions for $H$ and $S$.\nThe operator $A$ is given by\n$$A = K - (1 + \\mathrm{i} \\alpha) k^2 I = K - k^2 I - \\mathrm{i} \\alpha k^2 I$$\nwhere $K$ is the real symmetric discrete Laplacian, $I$ is the identity matrix, $k^2 \\ge 0$ is the squared wavenumber, and $\\alpha \\ge 0$ is the shift parameter. The conjugate transpose, $A^*$, is:\n$$A^* = (K - k^2 I - \\mathrm{i} \\alpha k^2 I)^* = K^* - (k^2 I)^* - (-\\mathrm{i} \\alpha k^2 I)^*$$\nSince $K$ and $I$ are real and symmetric, $K^*=K$ and $I^*=I$. The constant scalars $k^2$ and $\\alpha$ are real. Thus,\n$$A^* = K - k^2 I + \\mathrm{i} \\alpha k^2 I$$\nThe Hermitian part $H$ and skew-Hermitian part $S$ are defined as:\n$$H = \\frac{A + A^*}{2} = \\frac{(K - k^2 I - \\mathrm{i} \\alpha k^2 I) + (K - k^2 I + \\mathrm{i} \\alpha k^2 I)}{2} = \\frac{2(K - k^2 I)}{2} = K - k^2 I$$\n$$S = \\frac{A - A^*}{2} = \\frac{(K - k^2 I - \\mathrm{i} \\alpha k^2 I) - (K - k^2 I + \\mathrm{i} \\alpha k^2 I)}{2} = \\frac{-2\\mathrm{i} \\alpha k^2 I}{2} = -\\mathrm{i} \\alpha k^2 I$$\n\nThe analysis of the eigenvalues for $H$ and $S$ proceeds as follows:\n\nEigenvalues of $H$:\nThe Hermitian part is $H = K - k^2 I$. Since $H$ is a real symmetric (and thus Hermitian) matrix, its eigenvalues are all real. The eigenvalues of $H$, denoted $\\lambda_j(H)$, are related to the eigenvalues of the discrete Laplacian $K$, denoted $\\lambda_j(K)$, by a simple shift:\n$$\\lambda_j(H) = \\lambda_j(K) - k^2$$\nThe eigenvalues of the $2$D discrete Laplacian $K$ on a grid with $N_x \\times N_y$ interior points and spacings $h_x, h_y$ are known analytically:\n$$\\lambda_{j,l}(K) = \\lambda_j(T_x) + \\lambda_l(T_y) = \\frac{4}{h_x^2} \\sin^2\\left(\\frac{j\\pi}{2(N_x+1)}\\right) + \\frac{4}{h_y^2} \\sin^2\\left(\\frac{l\\pi}{2(N_y+1)}\\right)$$\nfor $j=1, \\dots, N_x$ and $l=1, \\dots, N_y$. All eigenvalues $\\lambda_{j,l}(K)$ are strictly positive. The sign of an eigenvalue of $H$ therefore depends on whether the corresponding eigenvalue of $K$ is greater than, equal to, or less than $k^2$. The problem requires a numerical classification based on a tolerance $\\tau_H$. For each test case, we numerically compute the eigenvalues of $H$, calculate $\\tau_H$, and count the number of eigenvalues in the categories strictly positive ($\\lambda > \\tau_H$), approximately zero ($|\\lambda| \\le \\tau_H$), and strictly negative ($\\lambda  -\\tau_H$).\n\nEigenvalues of $S$:\nThe skew-Hermitian part is $S = -\\mathrm{i} \\alpha k^2 I$. A skew-Hermitian matrix has purely imaginary eigenvalues. For $S$, which is a scalar multiple of the identity matrix $I$, all $N$ eigenvalues are identical:\n$$\\mu = -\\mathrm{i} \\alpha k^2$$\nThe imaginary part of each eigenvalue is $\\operatorname{Im}(\\mu) = -\\alpha k^2$. Since the problem states $\\alpha \\ge 0$ and $k^2 \\ge 0$, the imaginary part must be non-positive, i.e., $\\operatorname{Im}(\\mu) \\le 0$. Consequently, the count of eigenvalues with a strictly positive imaginary part, $\\#S_{+i}$, is always zero.\nThe classification into approximately zero or strictly negative imaginary parts depends on the value of $\\alpha k^2$. If $\\alpha=0$ or $k^2=0$, then $\\operatorname{Im}(\\mu)=0$ and all eigenvalues are classified as having an approximately zero imaginary part. If $\\alpha k^2 > 0$, we compare $|\\operatorname{Im}(\\mu)| = \\alpha k^2$ against the tolerance $\\tau_S$. If $\\alpha k^2 \\le \\tau_S$, the imaginary parts are approximately zero; otherwise, they are strictly negative. Since all eigenvalues of $S$ are identical, they will all fall into the same category. Thus, either $\\#S_{0i}=N$ or $\\#S_{-i}=N$.\n\nThe computational procedure is to implement these steps for each parameter set in the test suite. This involves:\n$1$. Constructing the $1$D discrete Laplacian matrices $T_x$ and $T_y$.\n$2$. Constructing the $2$D discrete Laplacian $K$ using the Kronecker sum.\n$3$. Forming the Hermitian matrix $H = K - k^2 I$.\n$4$. Computing the eigenvalues of $H$ using a numerical eigensolver.\n$5$. Calculating the tolerance $\\tau_H$ and counting the positive, zero, and negative eigenvalues of $H$.\n$6$. Calculating the single imaginary value $-\\alpha k^2$ for the eigenvalues of $S$.\n$7$. Calculating the tolerance $\\tau_S$ and determining if all $N$ eigenvalues of $S$ have approximately zero or strictly negative imaginary parts.\n$8$. Assembling the six integer counts for each case.\nThe following Python code implements this logic.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of classifying eigenvalues for the Hermitian and skew-Hermitian\n    parts of a discrete Helmholtz operator for a suite of test cases.\n    \"\"\"\n    # Test suite of parameter sets (Nx, Ny, k^2, alpha)\n    test_cases = [\n        (8, 8, 0.1, 0.0),\n        (16, 16, 400.0, 0.0),\n        (8, 8, 10000.0, 0.0),\n        (10, 10, 100.0, 0.5),\n    ]\n\n    all_results = []\n    \n    def build_1d_laplacian(dim, h):\n        \"\"\"Constructs the 1D discrete Laplacian matrix T.\"\"\"\n        if dim == 0:\n            return np.array([[]])\n        main_diag = np.full(dim, 2.0 / h**2)\n        off_diag = np.full(dim - 1, -1.0 / h**2)\n        T = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n        return T\n\n    for case in test_cases:\n        Nx, Ny, k_squared, alpha = case\n        \n        # Grid parameters and total matrix size\n        hx = 1.0 / (Nx + 1)\n        hy = 1.0 / (Ny + 1)\n        N = Nx * Ny\n\n        # 1. Construct matrices\n        Tx = build_1d_laplacian(Nx, hx)\n        Ty = build_1d_laplacian(Ny, hy)\n        \n        Ix = np.identity(Nx)\n        Iy = np.identity(Ny)\n        \n        # K is the 2D negative discrete Laplacian\n        K = np.kron(Iy, Tx) + np.kron(Ty, Ix)\n\n        # 2. Form H and analyze its eigenvalues\n        # H = K - k^2 * I\n        I_N = np.identity(N)\n        H = K - k_squared * I_N\n\n        # H is real and symmetric, use eigvalsh for efficiency\n        eigvals_H = np.linalg.eigvalsh(H)\n\n        # 3. Classify eigenvalues of H\n        if N > 0:\n            tau_H = 1e-10 * max(1.0, np.max(np.abs(eigvals_H)))\n        else:\n            tau_H = 1e-10\n\n        H_pos = np.sum(eigvals_H > tau_H)\n        H_neg = np.sum(eigvals_H  -tau_H)\n        H_zero = N - H_pos - H_neg\n\n        # 4. Analyze eigenvalues of S\n        # S = -i * alpha * k^2 * I. All eigenvalues are mu = -i * alpha * k^2.\n        imag_part_S = -alpha * k_squared\n        \n        # 5. Classify eigenvalues of S\n        # Im(mu) is non-positive, so S_pos_i is always 0.\n        S_pos_i = 0\n        \n        abs_imag_part = abs(imag_part_S)\n        \n        # Tolerance for S is based on the max absolute imaginary part, which is uniform.\n        tau_S = 1e-10 * max(1.0, abs_imag_part)\n\n        if abs_imag_part = tau_S:\n            S_zero_i = N\n            S_neg_i = 0\n        else: # This implies imag_part_S  -tau_S\n            S_zero_i = 0\n            S_neg_i = N\n            \n        case_result = [int(H_pos), int(H_zero), int(H_neg), int(S_pos_i), int(S_zero_i), int(S_neg_i)]\n        all_results.append(case_result)\n\n    # Format the final output string to match the required format:\n    # e.g., [[r1_1,...,r1_6],[r2_1,...,r2_6]]\n    list_of_strs = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output_str = f\"[{','.join(list_of_strs)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "After identifying the spectral challenges of the Helmholtz operator, we can analyze the effectiveness of the shifted-Laplace preconditioner. This exercise uses Fourier analysis to derive the symbol of the preconditioned operator $M_{h}^{-1} A_{h}$, which acts as an amplification factor for discrete plane waves. Calculating this factor provides a precise, quantitative measure of how the preconditioner clusters the system's eigenvalues, which is the key to accelerating solver convergence.",
            "id": "3614261",
            "problem": "Consider the constant-density, frequency-domain acoustic Helmholtz operator in two spatial dimensions, discretized on a uniform Cartesian staggered grid with cell-centered pressure unknowns and face-centered fluxes. Let the grid spacing be $h$ in both directions, and assume periodic boundary conditions so that discrete Fourier analysis applies. For constant coefficients, the divergence-of-gradient construction on this staggered grid yields the standard five-point discrete Laplacian at cell centers. Define the discrete Helmholtz operator $A_{h}$ and a shifted-Laplace preconditioner (SLP) $M_{h}$ by\n$$\nA_{h} u_{i,j} \\equiv -\\Delta_{h} u_{i,j} - k^{2} u_{i,j},\n\\qquad\nM_{h} u_{i,j} \\equiv -\\Delta_{h} u_{i,j} - \\left(1 + \\mathrm{i} \\beta\\right) k^{2} u_{i,j},\n$$\nwhere $k$ is the constant wavenumber, $\\beta > 0$ is the real shift parameter, and $\\mathrm{i}$ is the imaginary unit. The discrete Laplacian $\\Delta_{h}$ at cell centers reads\n$$\n\\Delta_{h} u_{i,j} \\equiv \\frac{u_{i+1,j} - 2 u_{i,j} + u_{i-1,j}}{h^{2}} + \\frac{u_{i,j+1} - 2 u_{i,j} + u_{i,j-1}}{h^{2}}.\n$$\n1) Using the Fourier eigenmodes $u_{i,j} = \\exp\\!\\left(i \\left(\\xi_{x} i h + \\xi_{y} j h\\right)\\right)$ with discrete wave vector $\\boldsymbol{\\xi} = (\\xi_{x}, \\xi_{y})$ (all phase angles in radians), derive the discrete symbols $a(\\boldsymbol{\\xi})$ and $m(\\boldsymbol{\\xi})$ of $A_{h}$ and $M_{h}$, respectively, and hence derive the discrete symbol $s(\\boldsymbol{\\xi})$ of the preconditioned operator $M_{h}^{-1} A_{h}$ that satisfies $s(\\boldsymbol{\\xi}) = m(\\boldsymbol{\\xi})^{-1} a(\\boldsymbol{\\xi})$.\n2) Justify rigorously, using the diagonalization of translation-invariant operators by the discrete Fourier basis, why a single application of $M_{h}^{-1} A_{h}$ to the plane wave $u_{i,j} = \\exp\\!\\left(i \\left(\\xi_{x} i h + \\xi_{y} j h\\right)\\right)$ yields an amplification by the factor $s(\\boldsymbol{\\xi})$ and hence that the magnitude $\\left| s(\\boldsymbol{\\xi}) \\right|$ is exactly the amplification factor measured by a numerical plane-wave test under periodic boundary conditions.\n3) For the parameter values $h = 10$ m, wave speed $c = 2000$ m/s, frequency $f = 5$ Hz, hence angular frequency $\\omega = 2 \\pi f$ rad/s and wavenumber $k = \\omega / c$, choose $\\beta = 1$ and the discrete wave vector components $\\xi_{x} = 0.4 \\pi / h$ and $\\xi_{y} = 0.3 \\pi / h$. Compute the predicted amplification factor magnitude $\\left| s(\\boldsymbol{\\xi}) \\right|$ for a single application of $M_{h}^{-1} A_{h}$ to the corresponding plane wave. Round your answer to six significant figures. Express the final amplification factor as a dimensionless number.",
            "solution": "The problem is evaluated as valid. It is scientifically grounded in the numerical analysis of partial differential equations, specifically the Helmholtz equation, a topic central to computational geophysics. The problem is well-posed, objective, and contains all necessary information for a unique solution without contradictions.\n\nThe solution is presented in three parts as requested by the problem statement.\n\n**1) Derivation of Discrete Symbols**\n\nThe discrete symbols of the operators are their eigenvalues when applied to the discrete Fourier eigenmodes $u_{i,j} = \\exp(i (\\xi_x i h + \\xi_y j h))$. We begin by finding the symbol of the discrete Laplacian operator $\\Delta_h$.\n\nApplying $\\Delta_h$ to $u_{i,j}$:\n$$\n\\Delta_h u_{i,j} = \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h^2}\n$$\nWe substitute $u_{i,j}$ and utilize the properties of the exponential function, such as $u_{i+1,j} = \\exp(i (\\xi_x (i+1)h + \\xi_y j h)) = \\exp(i \\xi_x h) u_{i,j}$.\n$$\n\\Delta_h u_{i,j} = \\frac{\\exp(i \\xi_x h)u_{i,j} - 2u_{i,j} + \\exp(-i \\xi_x h)u_{i,j}}{h^2} + \\frac{\\exp(i \\xi_y h)u_{i,j} - 2u_{i,j} + \\exp(-i \\xi_y h)u_{i,j}}{h^2}\n$$\nFactoring out $u_{i,j}$:\n$$\n\\Delta_h u_{i,j} = \\left[ \\frac{\\exp(i \\xi_x h) + \\exp(-i \\xi_x h) - 2}{h^2} + \\frac{\\exp(i \\xi_y h) + \\exp(-i \\xi_y h) - 2}{h^2} \\right] u_{i,j}\n$$\nUsing Euler's formula, $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$, the expression in the brackets, which is the symbol of $\\Delta_h$, becomes:\n$$\n\\delta(\\boldsymbol{\\xi}) = \\frac{2\\cos(\\xi_x h) - 2}{h^2} + \\frac{2\\cos(\\xi_y h) - 2}{h^2}\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$, we get:\n$$\n\\delta(\\boldsymbol{\\xi}) = -\\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right]\n$$\nThe operators $A_h$ and $M_h$ are linear combinations of $-\\Delta_h$ and the identity operator $I$. The symbol of a linear combination of operators is the same linear combination of their symbols. The symbol of the identity operator is $1$.\nThe symbol of $A_h = -\\Delta_h - k^2 I$ is:\n$$\na(\\boldsymbol{\\xi}) = -\\delta(\\boldsymbol{\\xi}) - k^2 = \\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right] - k^2\n$$\nThe symbol of $M_h = -\\Delta_h - (1 + \\mathrm{i}\\beta)k^2 I$ is:\n$$\nm(\\boldsymbol{\\xi}) = -\\delta(\\boldsymbol{\\xi}) - (1 + \\mathrm{i}\\beta)k^2 = \\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right] - (1 + \\mathrm{i}\\beta)k^2\n$$\nThe preconditioned operator is $M_h^{-1}A_h$. For translation-invariant operators, the symbol of the product (or inverse) is the product (or inverse) of the symbols. Thus, the symbol of $M_h^{-1}A_h$ is:\n$$\ns(\\boldsymbol{\\xi}) = \\frac{a(\\boldsymbol{\\xi})}{m(\\boldsymbol{\\xi})} = \\frac{\\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right] - k^2}{\\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right] - (1 + \\mathrm{i}\\beta)k^2}\n$$\nTo simplify, let $K_h(\\boldsymbol{\\xi}) = -\\delta(\\boldsymbol{\\xi}) = \\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right]$. Then:\n$$\ns(\\boldsymbol{\\xi}) = \\frac{K_h(\\boldsymbol{\\xi}) - k^2}{K_h(\\boldsymbol{\\xi}) - (1 + \\mathrm{i}\\beta)k^2} = \\frac{K_h(\\boldsymbol{\\xi}) - k^2}{K_h(\\boldsymbol{\\xi}) - k^2 - \\mathrm{i}\\beta k^2}\n$$\n\n**2) Rigorous Justification**\n\nThe problem assumes a uniform grid with periodic boundary conditions. The operators $A_h$ and $M_h$ are constructed from the discrete Laplacian $\\Delta_h$, which is defined by a five-point stencil with constant coefficients. An operator whose action is independent of the grid point $(i,j)$ is called translation-invariant. Both $A_h$ and $M_h$ are linear, translation-invariant operators.\n\nA fundamental theorem of linear algebra states that linear, translation-invariant operators defined on a periodic grid are diagonalized by the discrete Fourier basis. The vectors of this basis are the discrete plane waves $u^{(\\boldsymbol{\\xi})}_{i,j} = \\exp(i (\\xi_x i h + \\xi_y j h))$, where $\\boldsymbol{\\xi}$ is a discrete wave vector.\n\nThis means that each plane wave $u^{(\\boldsymbol{\\xi})}$ is an eigenvector of both $A_h$ and $M_h$. The corresponding eigenvalues are precisely the symbols $a(\\boldsymbol{\\xi})$ and $m(\\boldsymbol{\\xi})$ derived in Part 1. Thus, we have the eigenvalue equations:\n$$\nA_h u^{(\\boldsymbol{\\xi})} = a(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})}\n$$\n$$\nM_h u^{(\\boldsymbol{\\xi})} = m(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})}\n$$\nThe preconditioner is invertible because the term $-\\mathrm{i}\\beta k^2$ (with $\\beta > 0, k \\neq 0$) adds a non-zero imaginary part, ensuring that $m(\\boldsymbol{\\xi})$ is never zero for real-valued $K_h(\\boldsymbol{\\xi})$ and $k^2$. The action of the inverse operator $M_h^{-1}$ on the eigenvector $u^{(\\boldsymbol{\\xi})}$ is:\n$$\nM_h^{-1} u^{(\\boldsymbol{\\xi})} = \\frac{1}{m(\\boldsymbol{\\xi})} u^{(\\boldsymbol{\\xi})} = m(\\boldsymbol{\\xi})^{-1} u^{(\\boldsymbol{\\xi})}\n$$\nNow, we can analyze the action of the preconditioned operator $M_h^{-1} A_h$ on the plane wave $u^{(\\boldsymbol{\\xi})}$:\n$$\nM_h^{-1} A_h u^{(\\boldsymbol{\\xi})} = M_h^{-1} \\left( A_h u^{(\\boldsymbol{\\xi})} \\right) = M_h^{-1} \\left( a(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})} \\right)\n$$\nSince $a(\\boldsymbol{\\xi})$ is a scalar eigenvalue, it commutes with the operator $M_h^{-1}$:\n$$\nM_h^{-1} A_h u^{(\\boldsymbol{\\xi})} = a(\\boldsymbol{\\xi}) \\left( M_h^{-1} u^{(\\boldsymbol{\\xi})} \\right) = a(\\boldsymbol{\\xi}) \\left( m(\\boldsymbol{\\xi})^{-1} u^{(\\boldsymbol{\\xi})} \\right)\n$$\nRearranging the scalars, we find:\n$$\nM_h^{-1} A_h u^{(\\boldsymbol{\\xi})} = \\left( \\frac{a(\\boldsymbol{\\xi})}{m(\\boldsymbol{\\xi})} \\right) u^{(\\boldsymbol{\\xi})} = s(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})}\n$$\nThis demonstrates that applying the operator $M_h^{-1} A_h$ to the plane wave $u^{(\\boldsymbol{\\xi})}$ results in the same plane wave multiplied by the complex scalar $s(\\boldsymbol{\\xi})$. The magnitude of the resulting vector field is $|s(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})}| = |s(\\boldsymbol{\\xi})| |u^{(\\boldsymbol{\\xi})}|$. For a unit-amplitude plane wave, where $|u^{(\\boldsymbol{\\xi})}|=1$, the output magnitude is $|s(\\boldsymbol{\\xi})|$. Therefore, $|s(\\boldsymbol{\\xi})|$ is exactly the amplification factor measured in a numerical plane-wave test.\n\n**3) Numerical Computation**\n\nWe are given the following parameters:\n- Grid spacing: $h = 10 \\text{ m}$\n- Wave speed: $c = 2000 \\text{ m/s}$\n- Frequency: $f = 5 \\text{ Hz}$\n- Shift parameter: $\\beta = 1$\n- Discrete wave vector components: $\\xi_x = \\frac{0.4 \\pi}{h}$ and $\\xi_y = \\frac{0.3 \\pi}{h}$\n\nFirst, we compute the physical constants:\n- Angular frequency: $\\omega = 2\\pi f = 2\\pi (5) = 10\\pi \\text{ rad/s}$\n- Wavenumber: $k = \\frac{\\omega}{c} = \\frac{10\\pi}{2000} = \\frac{\\pi}{200} \\text{ m}^{-1}$\n- Wavenumber squared: $k^2 = \\left(\\frac{\\pi}{200}\\right)^2 = \\frac{\\pi^2}{40000} \\text{ m}^{-2}$\n\nNext, we evaluate the arguments of the sine functions in $K_h(\\boldsymbol{\\xi})$:\n- $\\frac{\\xi_x h}{2} = \\frac{(0.4\\pi/h) h}{2} = 0.2\\pi \\text{ rad}$\n- $\\frac{\\xi_y h}{2} = \\frac{(0.3\\pi/h) h}{2} = 0.15\\pi \\text{ rad}$\n\nNow we compute the term $K_h(\\boldsymbol{\\xi})$:\n$$\nK_h(\\boldsymbol{\\xi}) = \\frac{4}{h^2} \\left[ \\sin^2\\left(0.2\\pi\\right) + \\sin^2\\left(0.15\\pi\\right) \\right] = \\frac{4}{10^2} \\left[ \\sin^2(0.2\\pi) + \\sin^2(0.15\\pi) \\right]\n$$\nNumerically:\n- $\\sin^2(0.2\\pi) \\approx (0.587785)^2 \\approx 0.345492$\n- $\\sin^2(0.15\\pi) \\approx (0.453990)^2 \\approx 0.206107$\n- $K_h(\\boldsymbol{\\xi}) \\approx 0.04 (0.345492 + 0.206107) = 0.04 (0.551599) \\approx 0.02206396 \\text{ m}^{-2}$\n\nAnd the term $k^2$:\n- $k^2 = \\frac{\\pi^2}{40000} \\approx \\frac{9.8696044}{40000} \\approx 0.00024674 \\text{ m}^{-2}$\n\nThe amplification factor is $|s(\\boldsymbol{\\xi})|$, where $s(\\boldsymbol{\\xi}) = \\frac{R}{R - \\mathrm{i}I}$ with $R = K_h(\\boldsymbol{\\xi}) - k^2$ and $I = \\beta k^2$.\n- $R \\approx 0.02206396 - 0.00024674 = 0.02181722 \\text{ m}^{-2}$\n- $I = (1) k^2 \\approx 0.00024674 \\text{ m}^{-2}$\n\nThe magnitude is:\n$$\n|s(\\boldsymbol{\\xi})| = \\left| \\frac{R}{R - \\mathrm{i}I} \\right| = \\frac{|R|}{\\sqrt{R^2 + (-I)^2}} = \\frac{R}{\\sqrt{R^2 + I^2}}\n$$\nSubstituting the numerical values:\n$$\n|s(\\boldsymbol{\\xi})| \\approx \\frac{0.02181722}{\\sqrt{(0.02181722)^2 + (0.00024674)^2}}\n$$\n$$\n|s(\\boldsymbol{\\xi})| \\approx \\frac{0.02181722}{\\sqrt{0.0004759905 + 0.00000006088}} = \\frac{0.02181722}{\\sqrt{0.00047605138}} \\approx \\frac{0.02181722}{0.02181860}\n$$\n$$\n|s(\\boldsymbol{\\xi})| \\approx 0.99993642\n$$\nRounding to six significant figures, the amplification factor is $0.999936$. This is a dimensionless quantity, as expected.",
            "answer": "$$\n\\boxed{0.999936}\n$$"
        },
        {
            "introduction": "An effective preconditioner is only practical if its inverse can be applied efficiently. This exercise shifts our focus from operator analysis to solver design, challenging you to construct a multigrid V-cycle to approximate the inverse of the shifted-Laplace operator $M$. Properly selecting the multigrid components—smoother, transfer operators, and coarse-grid operator—is essential for building high-performance solvers for large-scale wave propagation problems in geophysics.",
            "id": "3614331",
            "problem": "In computational geophysics, the frequency-domain acoustic wave equation with constant wavenumber $k$ in $3\\mathrm{D}$ can be written in continuous form as the Helmholtz problem $\\left(-\\nabla^2 - k^2\\right) u = f$. A widely used preconditioner for Krylov methods applied to this indefinite system is the shifted-Laplace operator $M = -\\nabla^2 - (1 + \\mathrm{i} \\alpha) k^2$ with real shift $\\alpha > 0$, which renders the discrete operator more elliptic-like while keeping the phase information through the imaginary part. Consider a uniform cubic grid with spacing $h$ and a second-order $7$-point finite-difference discretization of $M$ on $n \\times n \\times n$ points, giving $N = n^3$ degrees of freedom. You plan to approximately invert $M$ with a geometric multigrid V-cycle that employs $\\nu_1 = 1$ pre-smoothing step, $\\nu_2 = 1$ post-smoothing step per level, standard coarsening by a factor of $2$ in each spatial direction, and an exact solve on the coarsest grid.\n\nSelect the option that specifies a scientifically consistent multigrid V-cycle design for approximately inverting $M$ in this $3\\mathrm{D}$ constant-$k$ setting (i.e., an effective smoother, compatible restriction and prolongation, and an appropriate coarse-grid operator) and provides a quantitatively consistent estimate of the computational work per V-cycle, expressed in units of one fine-grid matrix-vector product with the discrete $M$.\n\nA. Smoother: weighted Jacobi with weight $\\omega = 2/3$ applied to the discrete $M$; restriction $R$: $3\\mathrm{D}$ full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c$: Galerkin operator $A_c = R M P$; choose $\\alpha \\approx 0.5$; estimated work per V-cycle: approximately $3.5$ fine-grid matrix-vector products.\n\nB. Smoother: symmetric Gauss–Seidel applied to the unshifted Helmholtz operator $H = -\\nabla^2 - k^2$ (i.e., $\\alpha = 0$); restriction $R$: injection; prolongation $P$: nearest-neighbor; coarse operator $A_c$: rediscretized pure Laplacian $-\\nabla^2$ (dropping the $k^2$ term); estimated work per V-cycle: approximately $2.0$ fine-grid matrix-vector products.\n\nC. Smoother: degree-$2$ Chebyshev polynomial applied directly to $M$ using spectral bounds taken from the real-symmetric discrete Laplacian; restriction $R$: full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c$: Galerkin operator $A_c = R M P$; choose $\\alpha \\approx 0.7$; estimated work per V-cycle: approximately $6.0$ fine-grid matrix-vector products.\n\nD. Smoother: weighted Jacobi with over-relaxation $\\omega = 1.2$ applied to the discrete $M$; restriction $R$: full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c$: Galerkin operator $A_c = R M P$; choose $\\alpha \\approx 0.1$; estimated work per V-cycle: approximately $3.0$ fine-grid matrix-vector products.",
            "solution": "The user wants a critical validation of a problem statement concerning multigrid methods for the Helmholtz equation, followed by a full solution if the problem is deemed valid.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The $3\\mathrm{D}$ Helmholtz problem is $\\left(-\\nabla^2 - k^2\\right) u = f$, where $k$ is a constant wavenumber.\n- **Preconditioner Operator**: The discrete system is preconditioned by approximately inverting the shifted-Laplace operator $M = -\\nabla^2 - (1 + \\mathrm{i} \\alpha) k^2$, with a real shift parameter $\\alpha > 0$.\n- **Discretization**: A second-order $7$-point finite-difference stencil is used on a uniform cubic grid with spacing $h$.\n- **Grid Dimensions**: The grid has $n \\times n \\times n$ points, for a total of $N = n^3$ degrees of freedom.\n- **Multigrid Cycle**: A geometric multigrid V-cycle is used to approximate $M^{-1}$.\n- **Multigrid Parameters**:\n    - Pre-smoothing steps: $\\nu_1 = 1$.\n    - Post-smoothing steps: $\\nu_2 = 1$.\n    - Coarsening: Standard coarsening by a factor of $2$ in each spatial dimension.\n    - Coarsest Grid: An exact solve is performed.\n- **Task**: Identify a scientifically consistent multigrid V-cycle design (smoother, restriction, prolongation, coarse-grid operator) and a quantitatively consistent estimate of the computational work per V-cycle.\n- **Work Unit**: The work is to be expressed in units of one fine-grid matrix-vector product with the discrete operator $M$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated based on the established criteria.\n\n- **Scientifically Grounded**: The problem is rooted in standard, well-established practices in computational science and engineering. The Helmholtz equation is fundamental to wave propagation phenomena. The use of shifted-Laplace preconditioners and geometric multigrid methods are state-of-the-art techniques for solving the resulting large, sparse, indefinite linear systems. All components mentioned (V-cycles, smoothers, inter-grid transfers, Galerkin coarsening) are standard concepts in numerical analysis. The setup is scientifically sound.\n- **Well-Posed**: The problem is clearly stated. It asks for the identification of a consistent and effective multigrid design among a set of options. Given the parameters, the properties of a \"good\" multigrid cycle are well-defined in the literature, allowing for a rigorous evaluation of the options.\n- **Objective**: The language is precise and technical, free of subjectivity or ambiguity.\n- **Completeness**: The problem provides all necessary information to assess the scientific validity and computational cost of the proposed multigrid designs. The operator, discretization, multigrid cycle type, smoothing steps, and coarsening strategy are all specified.\n\n### Step 3: Verdict and Action\nThe problem statement is determined to be **valid**. It is scientifically sound, well-posed, objective, and complete. Therefore, I will proceed with a full solution and analysis of the options.\n\n### Derivation and Analysis\n\nA scientifically consistent multigrid design for the operator $M = -\\nabla^2 - (1 + \\mathrm{i} \\alpha) k^2$ must satisfy several key principles. The operator $M$ is complex-valued and non-Hermitian. The shift term $(1 + \\mathrm{i} \\alpha) k^2$ makes the operator more diagonally dominant and elliptic-like compared to the original indefinite Helmholtz operator, which is beneficial for multigrid convergence.\n\n1.  **Smoother**: The smoother's role is to damp high-frequency error components. For the shifted-Laplace operator, the high-frequency behavior is dominated by the discrete Laplacian $-\\nabla^2$. Therefore, effective smoothers are typically those that work well for the Poisson equation, such as weighted (damped) Jacobi or certain polynomial smoothers. The smoother must be designed for the operator $M$ itself.\n\n2.  **Inter-Grid Transfer Operators**: For a second-order finite-difference discretization, a consistent choice is full-weighting for the restriction operator ($R$) and its transpose, trilinear interpolation, for the prolongation operator ($P$). This pair preserves the accuracy of the scheme and leads to robust multigrid performance.\n\n3.  **Coarse-Grid Operator**: The Galerkin operator, $A_c = R M P$, is the most robust way to define the coarse-grid operator. It ensures that the coarse-grid representation is algebraically consistent with the fine-grid operator and the transfer operators. This is particularly crucial for complex operators like $M$ where simple rediscretization on the coarse grid might fail to capture the correct physics.\n\n4.  **Work Estimation for a V-cycle**: The computational work for a V-cycle can be estimated by summing the work done on each level of the multigrid hierarchy. The work on a single level (excluding the recursive call) is dominated by the smoothing steps and the residual calculation. Let the cost of one matrix-vector product on the fine grid be the unit of work.\n    - Pre-smoothing: $\\nu_1 = 1$ step. Assuming the smoother cost is one mat-vec (as for weighted Jacobi), this is $1$ unit.\n    - Residual calculation ($r_h = f_h - M_h x_h$): $1$ mat-vec, i.e., $1$ unit.\n    - Post-smoothing: $\\nu_2 = 1$ step, costing $1$ unit.\n    The total work on a level is approximately $(\\nu_1 + \\nu_2 + 1) = (1+1+1) = 3$ units.\n    In $3\\mathrm{D}$, coarsening by a factor of $2$ reduces the number of grid points by a factor of $8$. The total work of a V-cycle, $W_V$, is a geometric series:\n    $$ W_V \\approx (\\text{work per level}) \\times \\sum_{l=0}^{\\infty} \\left(\\frac{1}{8}\\right)^l = (\\nu_1+\\nu_2+1) \\times \\frac{1}{1 - 1/8} = 3 \\times \\frac{8}{7} = \\frac{24}{7} \\approx 3.43 $$\n    Therefore, a consistent work estimate for one V-cycle with $\\nu_1=\\nu_2=1$ is approximately $3.4 - 3.5$ fine-grid mat-vecs.\n\n### Option-by-Option Analysis\n\n**A. Smoother: weighted Jacobi with weight $\\omega = 2/3$ applied to the discrete $M$; restriction $R$: $3\\mathrm{D}$ full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c$: Galerkin operator $A_c = R M P$; choose $\\alpha \\approx 0.5$; estimated work per V-cycle: approximately $3.5$ fine-grid matrix-vector products.**\n- **Smoother**: Weighted Jacobi is a standard smoother. For elliptic-like problems, an under-relaxation factor ($\\omega  1$) is used to ensure robust damping of high-frequency modes. $\\omega = 2/3$ is a common and effective choice. This is a scientifically sound smoother.\n- **Transfer Operators**: Full weighting and trilinear interpolation are a high-quality, compatible pair for this discretization. Correct.\n- **Coarse Operator**: The Galerkin operator $A_c = R M P$ is the robust, standard choice. Correct.\n- **Shift Parameter**: $\\alpha \\approx 0.5$ is a typical value used in practice, balancing the improved ellipticity of $M$ with its quality as an approximation to the original Helmholtz operator. Correct.\n- **Work Estimate**: The estimate of $\\approx 3.5$ mat-vecs is in excellent agreement with our derived value of $\\approx 3.43$. Correct.\n- **Verdict**: This option describes a completely standard, scientifically consistent, and quantitatively accurate multigrid design. **Correct**.\n\n**B. Smoother: symmetric Gauss–Seidel applied to the unshifted Helmholtz operator $H = -\\nabla^2 - k^2$ (i.e., $\\alpha = 0$); restriction $R$: injection; prolongation $P$: nearest-neighbor; coarse operator $A_c$: rediscretized pure Laplacian $-\\nabla^2$ (dropping the $k^2$ term); estimated work per V-cycle: approximately $2.0$ fine-grid matrix-vector products.**\n- **Smoother**: This is fundamentally flawed. The multigrid cycle is designed to invert $M$, so the smoother must be based on $M$, not the original operator $H$. Applying a smoother for a different operator is inconsistent and will not work. Additionally, Gauss-Seidel is a poor smoother for the indefinite Helmholtz operator $H$.\n- **Transfer Operators**: Injection and nearest-neighbor is a low-order pair, generally suboptimal for second-order discretizations.\n- **Coarse Operator**: This is another major flaw. Rediscretizing only the Laplacian term and discarding the complex-shifted wavenumber term means the coarse-grid operator does not approximate the low-frequency modes of the fine-grid operator $M$. This leads to a breakdown of multigrid convergence.\n- **Work Estimate**: The estimate of $2.0$ mat-vecs is inconsistent with the standard work calculation for a V(1,1) cycle, which should be around $3.43$ mat-vecs.\n- **Verdict**: This option contains multiple fundamental errors in multigrid design. **Incorrect**.\n\n**C. Smoother: degree-$2$ Chebyshev polynomial applied directly to $M$ using spectral bounds taken from the real-symmetric discrete Laplacian; restriction $R$: full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c$: Galerkin operator $A_c = R M P$; choose $\\alpha \\approx 0.7$; estimated work per V-cycle: approximately $6.0$ fine-grid matrix-vector products.**\n- **Smoother**: A Chebyshev polynomial smoother is a valid and powerful choice. However, its design depends critically on having an ellipse that encloses the eigenvalues of the operator being smoothed. The statement specifies using spectral bounds from the real-symmetric discrete Laplacian. This is a critical error. The operator is $M$, which is complex and non-Hermitian; its spectrum is shifted into the complex plane and is not contained within the spectral bounds of the real Laplacian. Using the wrong spectral bounds results in an unstable or ineffective smoother.\n- **Work Estimate**: A degree-$2$ polynomial smoother requires $2$ mat-vecs per application. For a V(1,1) cycle, the work on one level would be $(\\nu_1 \\times 2 + \\nu_2 \\times 2 + 1) = (1 \\times 2 + 1 \\times 2 + 1) = 5$ mat-vecs. The total work estimate would be $W_V \\approx 5 \\times (8/7) \\approx 5.71$ mat-vecs. The provided estimate of $\\approx 6.0$ is quantitatively consistent with the specified (but flawed) smoother. However, the flaw in the smoother's design makes the entire proposition invalid.\n- **Verdict**: While many components are correct, the design of the smoother is based on a fundamental scientific error, rendering the multigrid cycle non-functional. **Incorrect**.\n\n**D. Smoother: weighted Jacobi with over-relaxation $\\omega = 1.2$ applied to the discrete $M$; restriction $R$: full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c$: Galerkin operator $A_c = R M P$; choose $\\alpha \\approx 0.1$; estimated work per V-cycle: approximately $3.0$ fine-grid matrix-vector products.**\n- **Smoother**: Using over-relaxation ($\\omega > 1$) with the Jacobi method is generally only stable and effective for certain classes of matrices, typically symmetric positive-definite matrices. The operator $M$ is non-Hermitian with eigenvalues in the complex plane. For such operators, over-relaxation is very likely to cause divergence or instability in the smoothing process. The standard, robust approach is under-relaxation ($\\omega  1$). Therefore, $\\omega = 1.2$ is a scientifically unsound choice for a robust smoother.\n- **Work Estimate**: The estimate of $\\approx 3.0$ mat-vecs is somewhat lower than the theoretical estimate of $\\approx 3.43$. While possibly acceptable as a rough approximation, the estimate in option A is more accurate. The primary flaw remains the smoother.\n- **Verdict**: The choice of an over-relaxed Jacobi smoother is inappropriate for this class of non-Hermitian operators and would likely lead to an unstable multigrid method. **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}