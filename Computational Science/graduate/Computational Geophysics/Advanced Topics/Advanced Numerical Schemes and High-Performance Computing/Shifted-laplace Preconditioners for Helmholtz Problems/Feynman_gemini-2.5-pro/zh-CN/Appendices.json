{
    "hands_on_practices": [
        {
            "introduction": "任何数值求解的第一步都是将连续的偏微分方程转化为离散的代数系统。这个练习将引导你完成这一基本过程，针对一维亥姆霍兹方程，使用二阶有限差分法进行离散化。通过从泰勒展开出发，你将亲手构建离散算子，并推导出其傅里叶符号（Fourier symbol），这是分析离散算子对不同频率波模式行为的关键工具。",
            "id": "3614325",
            "problem": "考虑作用于一个足够光滑的场 $u(x)$ 的常系数一维亥姆霍兹算子\n$$\n\\mathcal{L}u \\equiv -\\frac{d^{2}u}{dx^{2}} - k^{2}u,\n$$\n该算子定义在间距为 $h>0$ 的均匀网格 $\\{x_{i}\\}_{i\\in\\mathbb{Z}}$ 上。此算子是计算地球物理学中使用的波传播模型的核心，也是克雷洛夫方法中移位拉普拉斯预条件子构建的基础。从具有二阶精度的基本泰勒展开出发，推导 $\\mathcal{L}$ 的一个二阶有限差分离散，该离散能得到一个作用于网格函数 $\\{u_{i}\\}$ 的三对角矩阵 $A$。用无量纲参数 $kh$ 表示缩放后矩阵 $h^{2}A$ 在次对角线、主对角线和超对角线上的三个非零元素。然后，为与预条件子设计中使用的傅里叶模态分析相联系，假设周期性无限网格延拓，并计算 $h^{2}A$ 在离散傅里叶模 $v_{i}(\\theta)=\\exp(\\mathrm{i}\\,i\\,\\theta)$ 上的作用，其中 $\\theta\\in[0,\\pi]$ 是以弧度为单位的离散角频率。从第一性原理出发，推导由下式定义的离散傅里叶符号 $\\Lambda(\\theta;kh)$\n$$\n(h^{2}A v(\\theta))_{i} \\equiv \\Lambda(\\theta;kh)\\, v_{i}(\\theta).\n$$\n请提供 $\\Lambda(\\theta;kh)$ 关于 $\\theta$ 和 $kh$ 的闭式解析表达式作为最终答案。无需进行数值计算，并且最终答案必须表示为单一的解析表达式。角度必须以弧度表示。",
            "solution": "本问题要求推导一维亥姆霍兹算子 $\\mathcal{L}u \\equiv -\\frac{d^{2}u}{dx^{2}} - k^{2}u$ 的二阶有限差分离散的离散傅里叶符号。推导过程首先从基本原理出发建立离散算子，然后分析其在傅里叶模上的作用。\n\n首先，我们推导二阶导数项 $\\frac{d^{2}u}{dx^{2}}$ 的一个二阶精度有限差分近似。设网格由点 $x_i = i h$ 定义，其中 $i \\in \\mathbb{Z}$，并令 $u_i \\equiv u(x_i)$。假设场 $u(x)$ 足够光滑，我们可以写出 $u(x_{i+1}) = u(x_i+h)$ 和 $u(x_{i-1}) = u(x_i-h)$ 在点 $x_i$ 附近的泰勒级数展开：\n$$u_{i+1} = u_i + h \\left(\\frac{du}{dx}\\right)_{i} + \\frac{h^2}{2!} \\left(\\frac{d^2u}{dx^2}\\right)_{i} + \\frac{h^3}{3!} \\left(\\frac{d^3u}{dx^3}\\right)_{i} + \\mathcal{O}(h^4)$$\n$$u_{i-1} = u_i - h \\left(\\frac{du}{dx}\\right)_{i} + \\frac{h^2}{2!} \\left(\\frac{d^2u}{dx^2}\\right)_{i} - \\frac{h^3}{3!} \\left(\\frac{d^3u}{dx^3}\\right)_{i} + \\mathcal{O}(h^4)$$\n将这两个展开式相加可以消去奇数阶导数项：\n$$u_{i+1} + u_{i-1} = 2u_i + h^2 \\left(\\frac{d^2u}{dx^2}\\right)_{i} + \\mathcal{O}(h^4)$$\n整理此方程以求解在 $x_i$ 处的二阶导数，得到：\n$$\\left(\\frac{d^2u}{dx^2}\\right)_{i} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + \\mathcal{O}(h^2)$$\n这是众所周知的二阶导数的二阶精度中心差分公式。\n\n接下来，我们将此近似代入亥姆霍兹算子 $\\mathcal{L}$，得到由矩阵 $A$ 表示的离散算子。$A$ 在点 $x_i$ 处对网格函数 $u$ 的作用是：\n$$(A u)_i = -\\left(\\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\\right) - k^2 u_i$$\n$$(A u)_i = -\\frac{1}{h^2}u_{i-1} + \\left(\\frac{2}{h^2} - k^2\\right) u_i - \\frac{1}{h^2}u_{i+1}$$\n这对应一个三对角矩阵 $A$。问题要求缩放后矩阵 $h^2 A$ 的元素。将 $u_{i-1}$、$u_i$ 和 $u_{i+1}$ 的系数乘以 $h^2$，我们得到矩阵 $h^2 A$ 任意给定行上的三个非零元素：\n次对角线元素： $-1$\n主对角线元素： $h^2 \\left(\\frac{2}{h^2} - k^2\\right) = 2 - (kh)^2$\n超对角线元素： $-1$\n因此，缩放后的离散算子 $h^2 A$ 在网格函数 $u$ 上的作用可以写为：\n$$(h^2 A u)_i = -u_{i-1} + \\left(2 - (kh)^2\\right)u_i - u_{i+1}$$\n\n最后，我们推导离散傅里叶符号 $\\Lambda(\\theta;kh)$。我们计算 $h^2 A$ 在离散傅里叶模 $v_i(\\theta) = \\exp(\\mathrm{i}\\,i\\,\\theta)$ 上的作用，其中 $\\mathrm{i}$ 是虚数单位。\n$$(h^2 A v(\\theta))_i = -v_{i-1}(\\theta) + \\left(2 - (kh)^2\\right)v_i(\\theta) - v_{i+1}(\\theta)$$\n我们用 $v_i$ 表示 $v_{i-1}$ 和 $v_{i+1}$：\n$$v_{i-1}(\\theta) = \\exp(\\mathrm{i}\\,(i-1)\\,\\theta) = \\exp(\\mathrm{i}\\,i\\,\\theta) \\exp(-\\mathrm{i}\\,\\theta) = v_i(\\theta) \\exp(-\\mathrm{i}\\,\\theta)$$\n$$v_{i+1}(\\theta) = \\exp(\\mathrm{i}\\,(i+1)\\,\\theta) = \\exp(\\mathrm{i}\\,i\\,\\theta) \\exp(\\mathrm{i}\\,\\theta) = v_i(\\theta) \\exp(\\mathrm{i}\\,\\theta)$$\n将这些代回算子作用的表达式中：\n$$(h^2 A v(\\theta))_i = -v_i(\\theta) \\exp(-\\mathrm{i}\\,\\theta) + \\left(2 - (kh)^2\\right)v_i(\\theta) - v_i(\\theta) \\exp(\\mathrm{i}\\,\\theta)$$\n提取公因式 $v_i(\\theta)$：\n$$(h^2 A v(\\theta))_i = \\left[ 2 - (kh)^2 - \\left(\\exp(\\mathrm{i}\\,\\theta) + \\exp(-\\mathrm{i}\\,\\theta)\\right) \\right] v_i(\\theta)$$\n根据问题中给出的定义，$(h^2 A v(\\theta))_i \\equiv \\Lambda(\\theta;kh) v_i(\\theta)$。通过直接比较，我们确定符号 $\\Lambda(\\theta;kh)$ 为：\n$$\\Lambda(\\theta;kh) = 2 - (kh)^2 - \\left(\\exp(\\mathrm{i}\\,\\theta) + \\exp(-\\mathrm{i}\\,\\theta)\\right)$$\n此表达式可以使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i}\\,\\theta) + \\exp(-\\mathrm{i}\\,\\theta)}{2}$ 来简化，得到：\n$$\\Lambda(\\theta;kh) = 2 - (kh)^2 - 2\\cos(\\theta)$$\n为了得到标准形式，我们重新整理并使用三角半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2\\left(\\frac{\\theta}{2}\\right)$：\n$$\\Lambda(\\theta;kh) = 2(1 - \\cos(\\theta)) - (kh)^2$$\n$$\\Lambda(\\theta;kh) = 2\\left(2\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) - (kh)^2$$\n这就得出了离散傅里叶符号的最终闭式解析表达式：\n$$\\Lambda(\\theta;kh) = 4\\sin^2\\left(\\frac{\\theta}{2}\\right) - (kh)^2$$\n这个符号是分析波传播数值格式的关键工具，尤其在诊断离散算子的性质和设计有效的预条件子方面。",
            "answer": "$$\\boxed{4\\sin^2\\left(\\frac{\\theta}{2}\\right) - (kh)^2}$$"
        },
        {
            "introduction": "亥姆霍兹方程的数值挑战源于其离散矩阵的“不定性”（indefiniteness），这使得标准迭代求解器难以收敛。本练习通过一个计算实践，让你直观地理解这一问题。你将把离散亥姆霍兹算子分解为其埃尔米特（Hermitian）和斜埃尔米特（skew-Hermitian）部分，并通过计算它们的特征值来观察波数 $k$ 如何导致不定性，以及预处理子中的复数位移 $\\alpha$ 如何系统地改善算子的谱特性。",
            "id": "3614268",
            "problem": "给定一个二维离散亥姆霍兹算子 (two-dimensional discrete Helmholtz operator)，该算子源于单位正方形上的一个常波数 (constant-wavenumber) 模型问题，并带有齐次狄利克雷边界条件 (homogeneous Dirichlet boundary conditions)，这是计算地球物理学中用于模拟时谐波传播 (time-harmonic wave propagation) 的常见设置。设 $N_x$ 和 $N_y$ 分别为 $x$ 和 $y$ 方向上内部网格点的数量，均匀网格间距为 $h_x = \\frac{1}{N_x+1}$ 和 $h_y = \\frac{1}{N_y+1}$。使用标准的二阶中心有限差分格式 (second-order central finite-difference stencil) 和齐次狄利克雷边界条件，定义一维负离散拉普拉斯算子 (negative discrete Laplacian) $T \\in \\mathbb{R}^{N \\times N}$：\n$$\nT = \\frac{1}{h^2} \\operatorname{tridiag}(-1,\\,2,\\,-1),\n$$\n其中 $h$ 是网格间距，$\\operatorname{tridiag}(-1,\\,2,\\,-1)$ 表示主对角线上为 $2$，第一亚对角线和第一超对角线上为 $-1$ 的三对角矩阵。二维负离散拉普拉斯算子是克罗内克和 (Kronecker sum)\n$$\nK = I_{N_y} \\otimes T_x + T_y \\otimes I_{N_x},\n$$\n其中 $T_x$ 和 $T_y$ 分别是 $x$ 和 $y$ 方向上的一维算子，$I_{N}$ 表示 $N \\times N$ 的单位矩阵。\n\n设波数 (wavenumber) 为 $k$，并将 $k^2$ 定义为一个给定的非负实标量。考虑复数移位的离散亥姆霍兹算子\n$$\nA = K - (1 + i \\alpha) k^2 I,\n$$\n其中 $\\alpha \\ge 0$ 是用于移位拉普拉斯预处理 (shifted-Laplace preconditioning) 的移位参数，$i$ 是虚数单位，$I$ 是适当维度的单位矩阵。将 $A$ 分解为其埃尔米特 (Hermitian) 部分和斜埃尔米特 (skew-Hermitian) 部分，\n$$\nH = \\frac{A + A^*}{2}, \\quad S = \\frac{A - A^*}{2},\n$$\n其中 $A^*$ 表示 $A$ 的共轭转置。\n\n您的任务是：\n1. 根据上述定义，在具有齐次狄利克雷边界条件的均匀矩形网格上构造 $K$。\n2. 构造 $A$，计算 $H$ 和 $S$，并计算 $H$ 和 $S$ 的特征值。\n3. 根据 $H$ 特征值实部的符号将其分为三类计数：严格为正、近似为零和严格为负。为保证数值稳健性 (numerical robustness)，定义一个容差\n$$\n\\tau_H = 10^{-10} \\max\\left(1, \\max_j \\left| \\lambda_j(H) \\right| \\right),\n$$\n如果 $\\left| \\lambda \\right| \\le \\tau_H$，则将 $H$ 的一个特征值 $\\lambda$ 分类为近似为零；如果 $\\lambda > \\tau_H$，则为严格为正；如果 $\\lambda < -\\tau_H$，则为严格为负。\n4. 根据 $S$ 特征值虚部的符号将其分为三类计数：严格正虚部、近似零虚部和严格负虚部。定义\n$$\n\\tau_S = 10^{-10} \\max\\left(1, \\max_j \\left| \\operatorname{Im}(\\mu_j(S)) \\right| \\right),\n$$\n如果 $\\left| \\operatorname{Im}(\\mu) \\right| \\le \\tau_S$，则将 $S$ 的一个特征值 $\\mu$ 分类为近似零虚部；如果 $\\operatorname{Im}(\\mu) > \\tau_S$，则为严格正虚部；如果 $\\operatorname{Im}(\\mu) < -\\tau_S$，则为严格负虚部。\n\n使用以下参数集测试套件 $(N_x, N_y, k^2, \\alpha)$：\n- 案例1（理想情况，纯埃尔米特亥姆霍兹）：$(8, 8, 0.1, 0.0)$。\n- 案例2（混合符号埃尔米特谱，无移位）：$(16, 16, 400.0, 0.0)$。\n- 案例3（强不定埃尔米特部分，无移位）：$(8, 8, 10000.0, 0.0)$。\n- 案例4（来自复数移位的非零斜埃尔米特部分）：$(10, 10, 100.0, 0.5)$。\n\n对于每个案例，按顺序输出一个包含六个整数的列表\n$$\n[\\#H_{+},\\, \\#H_{0},\\, \\#H_{-},\\, \\#S_{+i},\\, \\#S_{0i},\\, \\#S_{-i}],\n$$\n其中 $\\#H_{+}$ 是 $H$ 的严格正特征值的数量，$\\#H_{0}$ 是 $H$ 的近似零特征值的数量，$\\#H_{-}$ 是 $H$ 的严格负特征值的数量，$\\#S_{+i}$、$\\#S_{0i}$、$\\#S_{-i}$ 是 $S$ 特征值虚部的相应计数。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试案例一个列表，并与测试套件的顺序相同。例如，输出应如下所示\n$$\n[[a_1,a_2,a_3,a_4,a_5,a_6],[b_1,b_2,b_3,b_4,b_5,b_6],[c_1,c_2,c_3,c_4,c_5,c_6],[d_1,d_2,d_3,d_4,d_5,d_6]]\n$$\n其中每个符号代表如上定义的整数计数。不涉及物理单位；所有量均为无量纲。未使用角度。",
            "solution": "该问题是适定的 (well-posed) 且具有科学依据，为分析离散亥姆霍茲算子的谱特性提供了一套完整的定义和参数。该问题的所有方面都经过了形式化定义，并且在计算上是可行的。\n\n主要任务是根据复数移位的离散亥姆霍兹算子 $A = K - (1 + i \\alpha) k^2 I$ 的埃尔米特部分 $H$ 和斜埃尔米特部分 $S$ 的特征值进行分类。矩阵 $A$ 定义在尺寸为 $N_x \\times N_y$ 的网格上，得到总矩阵维度为 $N \\times N$，其中 $N = N_x N_y$。\n\n首先，我们推导 $H$ 和 $S$ 的显式表达式。\n算子 $A$ 由下式给出\n$$A = K - (1 + i \\alpha) k^2 I = K - k^2 I - i \\alpha k^2 I$$\n其中 $K$ 是实对称离散拉普拉斯算子，$I$ 是单位矩阵，$k^2 \\ge 0$ 是波数的平方，$\\alpha \\ge 0$ 是移位参数。共轭转置 $A^*$ 为：\n$$A^* = (K - k^2 I - i \\alpha k^2 I)^* = K^* - (k^2 I)^* - (-i \\alpha k^2 I)^*$$\n由于 $K$ 和 $I$ 是实对称矩阵，因此 $K^*=K$ 且 $I^*=I$。标量常数 $k^2$ 和 $\\alpha$ 是实数。因此，\n$$A^* = K - k^2 I + i \\alpha k^2 I$$\n埃尔米特部分 $H$ 和斜埃尔米特部分 $S$ 定义如下：\n$$H = \\frac{A + A^*}{2} = \\frac{(K - k^2 I - i \\alpha k^2 I) + (K - k^2 I + i \\alpha k^2 I)}{2} = \\frac{2(K - k^2 I)}{2} = K - k^2 I$$\n$$S = \\frac{A - A^*}{2} = \\frac{(K - k^2 I - i \\alpha k^2 I) - (K - k^2 I + i \\alpha k^2 I)}{2} = \\frac{-2i \\alpha k^2 I}{2} = -i \\alpha k^2 I$$\n\n$H$ 和 $S$ 的特征值分析如下：\n\n$H$ 的特征值：\n埃尔米特部分是 $H = K - k^2 I$。由于 $H$ 是一个实对称（因此也是埃尔米特）矩阵，其特征值全部为实数。$H$ 的特征值（记为 $\\lambda_j(H)$）与离散拉普拉斯算子 $K$ 的特征值（记为 $\\lambda_j(K)$）通过一个简单的移位相关联：\n$$\\lambda_j(H) = \\lambda_j(K) - k^2$$\n在具有 $N_x \\times N_y$ 个内部点和间距 $h_x, h_y$ 的网格上，二维离散拉普拉斯算子 $K$ 的特征值有解析解：\n$$\\lambda_{j,l}(K) = \\lambda_j(T_x) + \\lambda_l(T_y) = \\frac{4}{h_x^2} \\sin^2\\left(\\frac{j\\pi}{2(N_x+1)}\\right) + \\frac{4}{h_y^2} \\sin^2\\left(\\frac{l\\pi}{2(N_y+1)}\\right)$$\n对于 $j=1, \\dots, N_x$ 和 $l=1, \\dots, N_y$。所有特征值 $\\lambda_{j,l}(K)$ 均为严格正值。因此，$H$ 的特征值的符号取决于对应的 $K$ 的特征值是大于、等于还是小于 $k^2$。问题要求基于容差 $\\tau_H$ 进行数值分类。对于每个测试案例，我们数值计算 $H$ 的特征值，计算 $\\tau_H$，并统计特征值在严格为正 ($\\lambda > \\tau_H$)、近似为零 ($|\\lambda| \\le \\tau_H$) 和严格为负 ($\\lambda  -\\tau_H$) 这几类中的数量。\n\n$S$ 的特征值：\n斜埃尔米特部分是 $S = -i \\alpha k^2 I$。斜埃尔米特矩阵的特征值均为纯虚数。对于 $S$（它是单位矩阵 $I$ 的标量倍数），所有 $N$ 个特征值都是相同的：\n$$\\mu = -i \\alpha k^2$$\n每个特征值的虚部是 $\\operatorname{Im}(\\mu) = -\\alpha k^2$。由于问题规定 $\\alpha \\ge 0$ 且 $k^2 \\ge 0$，虚部必须为非正，即 $\\operatorname{Im}(\\mu) \\le 0$。因此，具有严格正虚部的特征值数量 $\\#S_{+i}$ 始终为零。\n将其分类为近似为零或严格为负虚部取决于 $\\alpha k^2$ 的值。如果 $\\alpha=0$ 或 $k^2=0$，则 $\\operatorname{Im}(\\mu)=0$，所有特征值都被分类为具有近似为零的虚部。如果 $\\alpha k^2  0$，我们将 $|\\operatorname{Im}(\\mu)| = \\alpha k^2$ 与容差 $\\tau_S$ 进行比较。如果 $\\alpha k^2 \\le \\tau_S$，则虚部近似为零；否则，它们是严格为负。由于 $S$ 的所有特征值都相同，它们将全部分到同一类别。因此，要么 $\\#S_{0i}=N$，要么 $\\#S_{-i}=N$。\n\n计算过程是为测试套件中的每个参数集实现这些步骤。这包括：\n1. 构造一维离散拉普拉斯矩阵 $T_x$ 和 $T_y$。\n2. 使用克罗内克和构造二维离散拉普拉斯算子 $K$。\n3. 构造埃尔米特矩阵 $H = K - k^2 I$。\n4. 使用数值特征值求解器计算 $H$ 的特征值。\n5. 计算容差 $\\tau_H$ 并统计 $H$ 的正、零和负特征值的数量。\n6. 计算 $S$ 特征值的单一虚部值 $-\\alpha k^2$。\n7. 计算容差 $\\tau_S$ 并确定 $S$ 的所有 $N$ 个特征值是具有近似为零的虚部还是严格为负的虚部。\n8. 为每个案例组合六个整数计数。\n以下 Python 代码实现了这一逻辑。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of classifying eigenvalues for the Hermitian and skew-Hermitian\n    parts of a discrete Helmholtz operator for a suite of test cases.\n    \"\"\"\n    # Test suite of parameter sets (Nx, Ny, k^2, alpha)\n    test_cases = [\n        (8, 8, 0.1, 0.0),\n        (16, 16, 400.0, 0.0),\n        (8, 8, 10000.0, 0.0),\n        (10, 10, 100.0, 0.5),\n    ]\n\n    all_results = []\n    \n    def build_1d_laplacian(dim, h):\n        \"\"\"Constructs the 1D discrete Laplacian matrix T.\"\"\"\n        if dim == 0:\n            return np.array([[]])\n        main_diag = np.full(dim, 2.0 / h**2)\n        off_diag = np.full(dim - 1, -1.0 / h**2)\n        T = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n        return T\n\n    for case in test_cases:\n        Nx, Ny, k_squared, alpha = case\n        \n        # Grid parameters and total matrix size\n        hx = 1.0 / (Nx + 1)\n        hy = 1.0 / (Ny + 1)\n        N = Nx * Ny\n\n        # 1. Construct matrices\n        Tx = build_1d_laplacian(Nx, hx)\n        Ty = build_1d_laplacian(Ny, hy)\n        \n        Ix = np.identity(Nx)\n        Iy = np.identity(Ny)\n        \n        # K is the 2D negative discrete Laplacian\n        K = np.kron(Iy, Tx) + np.kron(Ty, Ix)\n\n        # 2. Form H and analyze its eigenvalues\n        # H = K - k^2 * I\n        I_N = np.identity(N)\n        H = K - k_squared * I_N\n\n        # H is real and symmetric, use eigvalsh for efficiency\n        eigvals_H = np.linalg.eigvalsh(H)\n\n        # 3. Classify eigenvalues of H\n        if N  0:\n            tau_H = 1e-10 * max(1.0, np.max(np.abs(eigvals_H)))\n        else:\n            tau_H = 1e-10\n\n        H_pos = np.sum(eigvals_H  tau_H)\n        H_neg = np.sum(eigvals_H  -tau_H)\n        H_zero = N - H_pos - H_neg\n\n        # 4. Analyze eigenvalues of S\n        # S = -i * alpha * k^2 * I. All eigenvalues are mu = -i * alpha * k^2.\n        imag_part_S = -alpha * k_squared\n        \n        # 5. Classify eigenvalues of S\n        # Im(mu) is non-positive, so S_pos_i is always 0.\n        S_pos_i = 0\n        \n        abs_imag_part = abs(imag_part_S)\n        \n        # Tolerance for S is based on the max absolute imaginary part, which is uniform.\n        tau_S = 1e-10 * max(1.0, abs_imag_part)\n\n        if abs_imag_part = tau_S:\n            S_zero_i = N\n            S_neg_i = 0\n        else: # This implies imag_part_S  -tau_S\n            S_zero_i = 0\n            S_neg_i = N\n            \n        case_result = [int(H_pos), int(H_zero), int(H_neg), int(S_pos_i), int(S_zero_i), int(S_neg_i)]\n        all_results.append(case_result)\n\n    # Format the final output string to match the required format:\n    # e.g., [[r1_1,...,r1_6],[r2_1,...,r2_6]]\n    list_of_strs = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output_str = f\"[{','.join(list_of_strs)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在设计了预处理子之后，我们需要一种方法来量化其有效性。此练习将傅里叶分析工具应用于整个预处理系统，即 $M^{-1}A$ 。通过推导预处理后算子的符号，你将能够直接计算出其对平面波的“放大因子”（amplification factor），它精确地量化了预处理子将原始算子的特征值“压缩”到理想区域的效果。",
            "id": "3614261",
            "problem": "考虑二维空间中的恒定密度、频域声学亥姆霍兹算子，该算子在均匀笛卡尔交错网格上进行离散化，其中压力未知量位于单元中心，通量位于面中心。设两个方向的网格间距均为 $h$，并假设采用周期性边界条件，以便应用离散傅里叶分析。对于常系数，此交错网格上的散度-梯度结构在单元中心处产生标准的五点离散拉普拉斯算子。定义离散亥姆霍兹算子 $A_{h}$ 和一个偏移拉普拉斯预条件子 (SLP) $M_{h}$ 如下：\n$$\nA_{h} u_{i,j} \\equiv -\\Delta_{h} u_{i,j} - k^{2} u_{i,j},\n\\qquad\nM_{h} u_{i,j} \\equiv -\\Delta_{h} u_{i,j} - \\left(1 + i \\beta\\right) k^{2} u_{i,j},\n$$\n其中 $k$ 是恒定的波数，$\\beta  0$ 是实数偏移参数，$i$ 是虚数单位。在单元中心处的离散拉普拉斯算子 $\\Delta_{h}$ 表达式为\n$$\n\\Delta_{h} u_{i,j} \\equiv \\frac{u_{i+1,j} - 2 u_{i,j} + u_{i-1,j}}{h^{2}} + \\frac{u_{i,j+1} - 2 u_{i,j} + u_{i,j-1}}{h^{2}}.\n$$\n1) 使用傅里叶本征模 $u_{i,j} = \\exp\\!\\left(i \\left(\\xi_{x} i h + \\xi_{y} j h\\right)\\right)$，其中离散波矢量为 $\\boldsymbol{\\xi} = (\\xi_{x}, \\xi_{y})$ (所有相角单位为弧度)，推导 $A_{h}$ 和 $M_{h}$ 的离散符号 $a(\\boldsymbol{\\xi})$ 和 $m(\\boldsymbol{\\xi})$，并由此推导预处理算子 $M_{h}^{-1} A_{h}$ 的离散符号 $s(\\boldsymbol{\\xi})$，满足 $s(\\boldsymbol{\\xi}) = m(\\boldsymbol{\\xi})^{-1} a(\\boldsymbol{\\xi})$。\n2) 利用离散傅里叶基对平移不变算子的对角化，严格证明为何将 $M_{h}^{-1} A_{h}$ 单次应用于平面波 $u_{i,j} = \\exp\\!\\left(i \\left(\\xi_{x} i h + \\xi_{y} j h\\right)\\right)$ 会产生一个因子为 $s(\\boldsymbol{\\xi})$ 的放大，并因此证明其模 $\\left| s(\\boldsymbol{\\xi}) \\right|$ 正是在周期性边界条件下通过数值平面波测试测得的放大因子。\n3) 对于参数值 $h = 10$ 米，波速 $c = 2000$ 米/秒，频率 $f = 5$ 赫兹，因此角频率 $\\omega = 2 \\pi f$ 弧度/秒，波数 $k = \\omega / c$，选择 $\\beta = 1$ 和离散波矢量分量 $\\xi_{x} = 0.4 \\pi / h$ 及 $\\xi_{y} = 0.3 \\pi / h$。计算将 $M_{h}^{-1} A_{h}$ 单次应用于相应平面波时，预测的放大因子模 $\\left| s(\\boldsymbol{\\xi}) \\right|$。将您的答案四舍五入到六位有效数字。将最终的放大因子表示为一个无量纲数。",
            "solution": "该问题被评估为有效。它在科学上植根于偏微分方程的数值分析，特别是作为计算地球物理学核心主题的亥姆霍兹方程。该问题是适定的、客观的，并包含得出唯一解所需的所有必要信息，没有矛盾之处。\n\n解题过程按照题目要求分为三个部分呈现。\n\n**1) 离散符号的推导**\n\n算子的离散符号是当它们作用于离散傅里叶本征模 $u_{i,j} = \\exp(i (\\xi_x i h + \\xi_y j h))$ 时的特征值。我们首先求出离散拉普拉斯算子 $\\Delta_h$ 的符号。\n\n将 $\\Delta_h$ 应用于 $u_{i,j}$：\n$$\n\\Delta_h u_{i,j} = \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h^2}\n$$\n我们代入 $u_{i,j}$ 并利用指数函数的性质，例如 $u_{i+1,j} = \\exp(i (\\xi_x (i+1)h + \\xi_y j h)) = \\exp(i \\xi_x h) u_{i,j}$。\n$$\n\\Delta_h u_{i,j} = \\frac{\\exp(i \\xi_x h)u_{i,j} - 2u_{i,j} + \\exp(-i \\xi_x h)u_{i,j}}{h^2} + \\frac{\\exp(i \\xi_y h)u_{i,j} - 2u_{i,j} + \\exp(-i \\xi_y h)u_{i,j}}{h^2}\n$$\n提出因子 $u_{i,j}$：\n$$\n\\Delta_h u_{i,j} = \\left[ \\frac{\\exp(i \\xi_x h) + \\exp(-i \\xi_x h) - 2}{h^2} + \\frac{\\exp(i \\xi_y h) + \\exp(-i \\xi_y h) - 2}{h^2} \\right] u_{i,j}\n$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$，方括号中的表达式，即 $\\Delta_h$ 的符号，变为：\n$$\n\\delta(\\boldsymbol{\\xi}) = \\frac{2\\cos(\\xi_x h) - 2}{h^2} + \\frac{2\\cos(\\xi_y h) - 2}{h^2}\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$，我们得到：\n$$\n\\delta(\\boldsymbol{\\xi}) = -\\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right]\n$$\n算子 $A_h$ 和 $M_h$ 是 $-\\Delta_h$ 和单位算子 $I$ 的线性组合。算子线性组合的符号是其符号的相同线性组合。单位算子的符号是 $1$。\n$A_h = -\\Delta_h - k^2 I$ 的符号是：\n$$\na(\\boldsymbol{\\xi}) = -\\delta(\\boldsymbol{\\xi}) - k^2 = \\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right] - k^2\n$$\n$M_h = -\\Delta_h - (1 + i\\beta)k^2 I$ 的符号是：\n$$\nm(\\boldsymbol{\\xi}) = -\\delta(\\boldsymbol{\\xi}) - (1 + i\\beta)k^2 = \\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right] - (1 + i\\beta)k^2\n$$\n预处理算子是 $M_h^{-1}A_h$。对于平移不变算子，乘积（或逆）的符号是符号的乘积（或逆）。因此，$M_h^{-1}A_h$ 的符号是：\n$$\ns(\\boldsymbol{\\xi}) = \\frac{a(\\boldsymbol{\\xi})}{m(\\boldsymbol{\\xi})} = \\frac{\\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right] - k^2}{\\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right] - (1 + i\\beta)k^2}\n$$\n为简化起见，令 $K_h(\\boldsymbol{\\xi}) = -\\delta(\\boldsymbol{\\xi}) = \\frac{4}{h^2} \\left[ \\sin^2\\left(\\frac{\\xi_x h}{2}\\right) + \\sin^2\\left(\\frac{\\xi_y h}{2}\\right) \\right]$。那么：\n$$\ns(\\boldsymbol{\\xi}) = \\frac{K_h(\\boldsymbol{\\xi}) - k^2}{K_h(\\boldsymbol{\\xi}) - (1 + i\\beta)k^2} = \\frac{K_h(\\boldsymbol{\\xi}) - k^2}{K_h(\\boldsymbol{\\xi}) - k^2 - i\\beta k^2}\n$$\n\n**2) 严格证明**\n\n该问题假设一个具有周期性边界条件的均匀网格。算子 $A_h$ 和 $M_h$ 由离散拉普拉斯算子 $\\Delta_h$ 构建，而 $\\Delta_h$ 由具有常系数的五点模板定义。其作用与网格点 $(i,j)$ 无关的算子称为平移不变算子。$A_h$ 和 $M_h$ 都是线性的平移不变算子。\n\n线性代数的一个基本定理指出，定义在周期性网格上的线性平移不变算子可由离散傅里叶基对角化。该基的向量是离散平面波 $u^{(\\boldsymbol{\\xi})}_{i,j} = \\exp(i (\\xi_x i h + \\xi_y j h))$，其中 $\\boldsymbol{\\xi}$ 是一个离散波矢量。\n\n这意味着每个平面波 $u^{(\\boldsymbol{\\xi})}$ 都是 $A_h$ 和 $M_h$ 的一个特征向量。相应的特征值正是在第1部分中推导出的符号 $a(\\boldsymbol{\\xi})$ 和 $m(\\boldsymbol{\\xi})$。因此，我们有特征值方程：\n$$\nA_h u^{(\\boldsymbol{\\xi})} = a(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})}\n$$\n$$\nM_h u^{(\\boldsymbol{\\xi})} = m(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})}\n$$\n预条件子是可逆的，因为项 $-i\\beta k^2$（其中 $\\beta > 0, k \\neq 0$）增加了一个非零的虚部，确保对于实值的 $K_h(\\boldsymbol{\\xi})$ 和 $k^2$，$m(\\boldsymbol{\\xi})$ 永远不为零。逆算子 $M_h^{-1}$ 对特征向量 $u^{(\\boldsymbol{\\xi})}$ 的作用是：\n$$\nM_h^{-1} u^{(\\boldsymbol{\\xi})} = \\frac{1}{m(\\boldsymbol{\\xi})} u^{(\\boldsymbol{\\xi})} = m(\\boldsymbol{\\xi})^{-1} u^{(\\boldsymbol{\\xi})}\n$$\n现在，我们可以分析预处理算子 $M_h^{-1} A_h$ 对平面波 $u^{(\\boldsymbol{\\xi})}$ 的作用：\n$$\nM_h^{-1} A_h u^{(\\boldsymbol{\\xi})} = M_h^{-1} \\left( A_h u^{(\\boldsymbol{\\xi})} \\right) = M_h^{-1} \\left( a(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})} \\right)\n$$\n由于 $a(\\boldsymbol{\\xi})$ 是一个标量特征值，它与算子 $M_h^{-1}$ 可交换：\n$$\nM_h^{-1} A_h u^{(\\boldsymbol{\\xi})} = a(\\boldsymbol{\\xi}) \\left( M_h^{-1} u^{(\\boldsymbol{\\xi})} \\right) = a(\\boldsymbol{\\xi}) \\left( m(\\boldsymbol{\\xi})^{-1} u^{(\\boldsymbol{\\xi})} \\right)\n$$\n重新整理这些标量，我们得到：\n$$\nM_h^{-1} A_h u^{(\\boldsymbol{\\xi})} = \\left( \\frac{a(\\boldsymbol{\\xi})}{m(\\boldsymbol{\\xi})} \\right) u^{(\\boldsymbol{\\xi})} = s(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})}\n$$\n这表明，将算子 $M_h^{-1} A_h$ 应用于平面波 $u^{(\\boldsymbol{\\xi})}$ 会得到同一个平面波乘以复标量 $s(\\boldsymbol{\\xi})$。所得矢量场的模为 $|s(\\boldsymbol{\\xi}) u^{(\\boldsymbol{\\xi})}| = |s(\\boldsymbol{\\xi})| |u^{(\\boldsymbol{\\xi})}|$。对于单位振幅的平面波，其中 $|u^{(\\boldsymbol{\\xi})}|=1$，输出的模为 $|s(\\boldsymbol{\\xi})|$。因此，$|s(\\boldsymbol{\\xi})|$ 正是在数值平面波测试中测得的放大因子。\n\n**3) 数值计算**\n\n我们被给予以下参数：\n- 网格间距: $h = 10 \\text{ 米}$\n- 波速: $c = 2000 \\text{ 米/秒}$\n- 频率: $f = 5 \\text{ 赫兹}$\n- 偏移参数: $\\beta = 1$\n- 离散波矢量分量: $\\xi_x = \\frac{0.4 \\pi}{h}$ 和 $\\xi_y = \\frac{0.3 \\pi}{h}$\n\n首先，我们计算物理常数：\n- 角频率: $\\omega = 2\\pi f = 2\\pi (5) = 10\\pi \\text{ 弧度/秒}$\n- 波数: $k = \\frac{\\omega}{c} = \\frac{10\\pi}{2000} = \\frac{\\pi}{200} \\text{ 米}^{-1}$\n- 波数的平方: $k^2 = \\left(\\frac{\\pi}{200}\\right)^2 = \\frac{\\pi^2}{40000} \\text{ 米}^{-2}$\n\n接下来，我们计算 $K_h(\\boldsymbol{\\xi})$ 中正弦函数的参数：\n- $\\frac{\\xi_x h}{2} = \\frac{(0.4\\pi/h) h}{2} = 0.2\\pi \\text{ 弧度}$\n- $\\frac{\\xi_y h}{2} = \\frac{(0.3\\pi/h) h}{2} = 0.15\\pi \\text{ 弧度}$\n\n现在我们计算项 $K_h(\\boldsymbol{\\xi})$：\n$$\nK_h(\\boldsymbol{\\xi}) = \\frac{4}{h^2} \\left[ \\sin^2\\left(0.2\\pi\\right) + \\sin^2\\left(0.15\\pi\\right) \\right] = \\frac{4}{10^2} \\left[ \\sin^2(0.2\\pi) + \\sin^2(0.15\\pi) \\right]\n$$\n数值上：\n- $\\sin^2(0.2\\pi) \\approx (0.587785)^2 \\approx 0.345492$\n- $\\sin^2(0.15\\pi) \\approx (0.453990)^2 \\approx 0.206107$\n- $K_h(\\boldsymbol{\\xi}) \\approx 0.04 (0.345492 + 0.206107) = 0.04 (0.551599) \\approx 0.02206396 \\text{ 米}^{-2}$\n\n以及项 $k^2$：\n- $k^2 = \\frac{\\pi^2}{40000} \\approx \\frac{9.8696044}{40000} \\approx 0.00024674 \\text{ 米}^{-2}$\n\n放大因子是 $|s(\\boldsymbol{\\xi})|$，其中 $s(\\boldsymbol{\\xi}) = \\frac{R}{R - iI}$，且 $R = K_h(\\boldsymbol{\\xi}) - k^2$，$I = \\beta k^2$。\n- $R \\approx 0.02206396 - 0.00024674 = 0.02181722 \\text{ 米}^{-2}$\n- $I = (1) k^2 \\approx 0.00024674 \\text{ 米}^{-2}$\n\n模为：\n$$\n|s(\\boldsymbol{\\xi})| = \\left| \\frac{R}{R - iI} \\right| = \\frac{|R|}{\\sqrt{R^2 + (-I)^2}} = \\frac{R}{\\sqrt{R^2 + I^2}}\n$$\n代入数值：\n$$\n|s(\\boldsymbol{\\xi})| \\approx \\frac{0.02181722}{\\sqrt{(0.02181722)^2 + (0.00024674)^2}}\n$$\n$$\n|s(\\boldsymbol{\\xi})| \\approx \\frac{0.02181722}{\\sqrt{0.0004759905 + 0.00000006088}} = \\frac{0.02181722}{\\sqrt{0.00047605138}} \\approx \\frac{0.02181722}{0.02181860}\n$$\n$$\n|s(\\boldsymbol{\\xi})| \\approx 0.99993642\n$$\n四舍五入到六位有效数字，放大因子为 $0.999936$。这是一个无量纲量，符合预期。",
            "answer": "$$\n\\boxed{0.999936}\n$$"
        }
    ]
}