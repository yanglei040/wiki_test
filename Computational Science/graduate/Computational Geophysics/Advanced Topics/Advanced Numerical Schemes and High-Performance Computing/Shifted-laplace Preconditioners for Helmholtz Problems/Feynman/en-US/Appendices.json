{
    "hands_on_practices": [
        {
            "introduction": "Before we can solve any differential equation on a computer, we must first transform it into a discrete algebraic system. This initial practice focuses on this fundamental step for the one-dimensional Helmholtz equation using the finite-difference method. By deriving the discrete operator and its corresponding Fourier symbol, you will gain direct insight into how the continuous physics of wave propagation is translated into the language of linear algebra, a crucial first step in analyzing numerical schemes and designing effective preconditioners .",
            "id": "3614325",
            "problem": "Consider the constant-coefficient one-dimensional Helmholtz operator acting on a sufficiently smooth field $u(x)$,\n$$\n\\mathcal{L}u \\equiv -\\frac{d^{2}u}{dx^{2}} - k^{2}u,\n$$\non a uniform grid $\\{x_i\\}_{i \\in \\mathbb{Z}}$ with spacing $h>0$. This operator is the core of wave propagation models used in computational geophysics and underlies the construction of shifted-Laplace preconditioners for Krylov methods. Starting from fundamental Taylor expansions consistent with second-order accuracy, derive a second-order finite-difference discretization of $\\mathcal{L}$ that yields a tridiagonal matrix $A$ acting on the grid function $\\{u_{i}\\}$. Express the three nonzero entries of the scaled matrix $h^{2}A$ on the sub-diagonal, main diagonal, and super-diagonal in terms of the nondimensional parameter $kh$. Then, to connect with Fourier-mode analysis used in preconditioner design, assume a periodic infinite-grid extension and evaluate the action of $h^{2}A$ on the discrete Fourier mode $v_{i}(\\theta)=\\exp(\\mathrm{i}\\,i\\,\\theta)$, where $\\theta\\in[0,\\pi]$ is the discrete angular frequency in radians. From first principles, derive the discrete Fourier symbol $\\Lambda(\\theta;kh)$ defined by\n$$\n(h^{2}A v(\\theta))_{i} \\equiv \\Lambda(\\theta;kh)\\, v_{i}(\\theta).\n$$\nProvide, as your final answer, the closed-form analytic expression for $\\Lambda(\\theta;kh)$ in terms of $\\theta$ and $kh$. No numerical evaluation is required, and you must express the final answer as a single analytic expression. Angles must be expressed in radians.",
            "solution": "The problem requires the derivation of the discrete Fourier symbol for the second-order finite-difference discretization of the one-dimensional Helmholtz operator, $\\mathcal{L}u \\equiv -\\frac{d^{2}u}{dx^{2}} - k^{2}u$. The derivation proceeds by first establishing the discrete operator from fundamental principles and then analyzing its action on a Fourier mode.\n\nFirst, we derive a second-order accurate finite-difference approximation for the second derivative term, $\\frac{d^{2}u}{dx^{2}}$. Let the grid be defined by points $x_i = i h$ for $i \\in \\mathbb{Z}$ and let $u_i \\equiv u(x_i)$. Assuming the field $u(x)$ is sufficiently smooth, we can write the Taylor series expansions for $u(x_{i+1}) = u(x_i+h)$ and $u(x_{i-1}) = u(x_i-h)$ around the point $x_i$:\n$$u_{i+1} = u_i + h \\left(\\frac{du}{dx}\\right)_{i} + \\frac{h^2}{2!} \\left(\\frac{d^2u}{dx^2}\\right)_{i} + \\frac{h^3}{3!} \\left(\\frac{d^3u}{dx^3}\\right)_{i} + \\mathcal{O}(h^4)$$\n$$u_{i-1} = u_i - h \\left(\\frac{du}{dx}\\right)_{i} + \\frac{h^2}{2!} \\left(\\frac{d^2u}{dx^2}\\right)_{i} - \\frac{h^3}{3!} \\left(\\frac{d^3u}{dx^3}\\right)_{i} + \\mathcal{O}(h^4)$$\nAdding these two expansions cancels the odd-order derivative terms:\n$$u_{i+1} + u_{i-1} = 2u_i + h^2 \\left(\\frac{d^2u}{dx^2}\\right)_{i} + \\mathcal{O}(h^4)$$\nRearranging this equation to solve for the second derivative at $x_i$ yields:\n$$\\left(\\frac{d^2u}{dx^2}\\right)_{i} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + \\mathcal{O}(h^2)$$\nThis is the well-known second-order accurate central difference formula for the second derivative.\n\nNext, we substitute this approximation into the Helmholtz operator $\\mathcal{L}$ to obtain the discrete operator, represented by a matrix $A$. The action of $A$ on the grid function $u$ at point $x_i$ is:\n$$(A u)_i = -\\left(\\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\\right) - k^2 u_i$$\n$$(A u)_i = -\\frac{1}{h^2}u_{i-1} + \\left(\\frac{2}{h^2} - k^2\\right) u_i - \\frac{1}{h^2}u_{i+1}$$\nThis corresponds to a tridiagonal matrix $A$. The problem asks for the entries of the scaled matrix $h^2 A$. Multiplying the coefficients of $u_{i-1}$, $u_i$, and $u_{i+1}$ by $h^2$, we obtain the three non-zero entries on any given row of the matrix $h^2 A$:\nSub-diagonal entry: $-1$\nMain diagonal entry: $h^2 \\left(\\frac{2}{h^2} - k^2\\right) = 2 - (kh)^2$\nSuper-diagonal entry: $-1$\nThe action of the scaled discrete operator $h^2 A$ on the grid function $u$ can thus be written as:\n$$(h^2 A u)_i = -u_{i-1} + \\left(2 - (kh)^2\\right)u_i - u_{i+1}$$\n\nFinally, we derive the discrete Fourier symbol $\\Lambda(\\theta;kh)$. We evaluate the action of $h^2 A$ on the discrete Fourier mode $v_i(\\theta) = \\exp(\\mathrm{i}\\,i\\,\\theta)$, where $\\mathrm{i}$ is the imaginary unit.\n$$(h^2 A v(\\theta))_i = -v_{i-1}(\\theta) + \\left(2 - (kh)^2\\right)v_i(\\theta) - v_{i+1}(\\theta)$$\nWe express $v_{i-1}$ and $v_{i+1}$ in terms of $v_i$:\n$$v_{i-1}(\\theta) = \\exp(\\mathrm{i}\\,(i-1)\\,\\theta) = \\exp(\\mathrm{i}\\,i\\,\\theta) \\exp(-\\mathrm{i}\\,\\theta) = v_i(\\theta) \\exp(-\\mathrm{i}\\,\\theta)$$\n$$v_{i+1}(\\theta) = \\exp(\\mathrm{i}\\,(i+1)\\,\\theta) = \\exp(\\mathrm{i}\\,i\\,\\theta) \\exp(\\mathrm{i}\\,\\theta) = v_i(\\theta) \\exp(\\mathrm{i}\\,\\theta)$$\nSubstituting these back into the expression for the operator action:\n$$(h^2 A v(\\theta))_i = -v_i(\\theta) \\exp(-\\mathrm{i}\\,\\theta) + \\left(2 - (kh)^2\\right)v_i(\\theta) - v_i(\\theta) \\exp(\\mathrm{i}\\,\\theta)$$\nFactoring out the term $v_i(\\theta)$:\n$$(h^2 A v(\\theta))_i = \\left[ 2 - (kh)^2 - \\left(\\exp(\\mathrm{i}\\,\\theta) + \\exp(-\\mathrm{i}\\,\\theta)\\right) \\right] v_i(\\theta)$$\nBy the definition given in the problem, $(h^2 A v(\\theta))_i \\equiv \\Lambda(\\theta;kh) v_i(\\theta)$. By direct comparison, we identify the symbol $\\Lambda(\\theta;kh)$ as:\n$$\\Lambda(\\theta;kh) = 2 - (kh)^2 - \\left(\\exp(\\mathrm{i}\\,\\theta) + \\exp(-\\mathrm{i}\\,\\theta)\\right)$$\nThis expression can be simplified using Euler's formula, $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i}\\,\\theta) + \\exp(-\\mathrm{i}\\,\\theta)}{2}$, which gives:\n$$\\Lambda(\\theta;kh) = 2 - (kh)^2 - 2\\cos(\\theta)$$\nTo obtain the standard form, we rearrange and use the trigonometric half-angle identity $1 - \\cos(\\theta) = 2\\sin^2\\left(\\frac{\\theta}{2}\\right)$:\n$$\\Lambda(\\theta;kh) = 2(1 - \\cos(\\theta)) - (kh)^2$$\n$$\\Lambda(\\theta;kh) = 2\\left(2\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) - (kh)^2$$\nThis yields the final closed-form analytic expression for the discrete Fourier symbol:\n$$\\Lambda(\\theta;kh) = 4\\sin^2\\left(\\frac{\\theta}{2}\\right) - (kh)^2$$\nThis symbol is a crucial tool for the analysis of numerical schemes for wave propagation, particularly in diagnosing the properties of discrete operators and designing effective preconditioners.",
            "answer": "$$\\boxed{4\\sin^2\\left(\\frac{\\theta}{2}\\right) - (kh)^2}$$"
        },
        {
            "introduction": "The numerical difficulty of the Helmholtz equation stems directly from the spectral properties of its discrete operator. This hands-on coding exercise guides you through a numerical investigation of these properties, decomposing the operator into its Hermitian and skew-Hermitian parts. By computing the eigenvalues for different physical regimes, you will see firsthand why the standard Helmholtz operator is 'indefinite' and how the complex shift of a shifted-Laplace preconditioner systematically improves the spectral structure, making it more amenable to iterative solution methods .",
            "id": "3614268",
            "problem": "You are given a two-dimensional discrete Helmholtz operator arising from a constant-wavenumber model problem on the unit square with homogeneous Dirichlet boundary conditions, a common setup in computational geophysics for simulating time-harmonic wave propagation. Let $N_x$ and $N_y$ be the number of interior grid points in the $x$ and $y$ directions, respectively, with uniform grid spacing $h_x = \\frac{1}{N_x+1}$ and $h_y = \\frac{1}{N_y+1}$. Define the negative discrete Laplacian in one dimension, $T \\in \\mathbb{R}^{N \\times N}$, using the standard second-order central finite-difference stencil with homogeneous Dirichlet boundary conditions:\n$$\nT = \\frac{1}{h^2} \\operatorname{tridiag}(-1,\\,2,\\,-1),\n$$\nwhere $h$ is the grid spacing, and $\\operatorname{tridiag}(-1,\\,2,\\,-1)$ denotes the tridiagonal matrix with $2$ on the main diagonal and $-1$ on the first sub- and super-diagonals. The two-dimensional negative discrete Laplacian is the Kronecker sum\n$$\nK = I_{N_y} \\otimes T_x + T_y \\otimes I_{N_x},\n$$\nwhere $T_x$ and $T_y$ are the one-dimensional operators in the $x$ and $y$ directions, respectively, and $I_{N}$ denotes the $N \\times N$ identity matrix.\n\nLet the wavenumber be $k$ and define $k^2$ as a given nonnegative real scalar. Consider the complex-shifted discrete Helmholtz operator\n$$\nA = K - (1 + i \\alpha) k^2 I,\n$$\nwhere $\\alpha \\ge 0$ is the shift parameter used in shifted-Laplace preconditioning, $i$ is the imaginary unit, and $I$ is the identity matrix of appropriate dimension. Decompose $A$ into its Hermitian and skew-Hermitian parts,\n$$\nH = \\frac{A + A^*}{2}, \\quad S = \\frac{A - A^*}{2},\n$$\nwhere $A^*$ denotes the conjugate transpose of $A$.\n\nYour tasks are:\n1. Construct $K$ using the above definitions on a uniform rectangular grid with homogeneous Dirichlet boundary conditions.\n2. Form $A$, compute $H$ and $S$, and compute the eigenvalues of $H$ and $S$.\n3. Classify the eigenvalues of $H$ by the sign of their real values into three counts: strictly positive, approximately zero, and strictly negative. For numerical robustness, define a tolerance\n$$\n\\tau_H = 10^{-10} \\max\\left(1, \\max_j \\left| \\lambda_j(H) \\right| \\right),\n$$\nand classify an eigenvalue $\\lambda$ of $H$ as approximately zero if $|\\lambda| \\le \\tau_H$, strictly positive if $\\lambda > \\tau_H$, and strictly negative if $\\lambda < -\\tau_H$.\n4. Classify the eigenvalues of $S$ by the sign of their imaginary parts into three counts: strictly positive imaginary part, approximately zero imaginary part, and strictly negative imaginary part. Define\n$$\n\\tau_S = 10^{-10} \\max\\left(1, \\max_j \\left| \\operatorname{Im}(\\mu_j(S)) \\right| \\right),\n$$\nand classify an eigenvalue $\\mu$ of $S$ as approximately zero imaginary part if $|\\operatorname{Im}(\\mu)| \\le \\tau_S$, strictly positive imaginary part if $\\operatorname{Im}(\\mu) > \\tau_S$, and strictly negative imaginary part if $\\operatorname{Im}(\\mu) < -\\tau_S$.\n\nUse the following test suite of parameter sets $(N_x, N_y, k^2, \\alpha)$:\n- Case 1 (happy path, purely Hermitian Helmholtz): $(8, 8, 0.1, 0.0)$.\n- Case 2 (mixed-sign Hermitian spectrum, no shift): $(16, 16, 400.0, 0.0)$.\n- Case 3 (strongly indefinite Hermitian part, no shift): $(8, 8, 10000.0, 0.0)$.\n- Case 4 (nonzero skew-Hermitian part from complex shift): $(10, 10, 100.0, 0.5)$.\n\nFor each case, output a list of six integers in the order\n$$\n[\\#H_{+},\\, \\#H_{0},\\, \\#H_{-},\\, \\#S_{+i},\\, \\#S_{0i},\\, \\#S_{-i}],\n$$\nwhere $\\#H_{+}$ is the count of strictly positive eigenvalues of $H$, $\\#H_{0}$ is the count of approximately zero eigenvalues of $H$, $\\#H_{-}$ is the count of strictly negative eigenvalues of $H$, and $\\#S_{+i}$, $\\#S_{0i}$, $\\#S_{-i}$ are the corresponding counts for the imaginary parts of eigenvalues of $S$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one list per test case, in the same order as the test suite. For example, the output should look like\n$$\n[[a_1,a_2,a_3,a_4,a_5,a_6],[b_1,b_2,b_3,b_4,b_5,b_6],[c_1,c_2,c_3,c_4,c_5,c_6],[d_1,d_2,d_3,d_4,d_5,d_6]]\n$$\nwhere each symbol represents an integer count as defined above. No physical units are involved; all quantities are dimensionless. Angles are not used.",
            "solution": "The problem is well-posed and scientifically grounded, providing a complete set of definitions and parameters to analyze the spectral properties of a discrete Helmholtz operator. All aspects of the problem are formally defined and computationally tractable.\n\nThe primary task is to categorize the eigenvalues of the Hermitian part $H$ and the skew-Hermitian part $S$ of the complex-shifted discrete Helmholtz operator $A = K - (1 + i \\alpha) k^2 I$. The matrix $A$ is defined on a grid of size $N_x \\times N_y$, resulting in a total matrix dimension of $N \\times N$, where $N = N_x N_y$.\n\nFirst, we derive the explicit expressions for $H$ and $S$.\nThe operator $A$ is given by\n$$A = K - (1 + i \\alpha) k^2 I = K - k^2 I - i \\alpha k^2 I$$\nwhere $K$ is the real symmetric discrete Laplacian, $I$ is the identity matrix, $k^2 \\ge 0$ is the squared wavenumber, and $\\alpha \\ge 0$ is the shift parameter. The conjugate transpose, $A^*$, is:\n$$A^* = (K - k^2 I - i \\alpha k^2 I)^* = K^* - (k^2 I)^* - (-i \\alpha k^2 I)^*$$\nSince $K$ and $I$ are real and symmetric, $K^*=K$ and $I^*=I$. The constant scalars $k^2$ and $\\alpha$ are real. Thus,\n$$A^* = K - k^2 I + i \\alpha k^2 I$$\nThe Hermitian part $H$ and skew-Hermitian part $S$ are defined as:\n$$H = \\frac{A + A^*}{2} = \\frac{(K - k^2 I - i \\alpha k^2 I) + (K - k^2 I + i \\alpha k^2 I)}{2} = \\frac{2(K - k^2 I)}{2} = K - k^2 I$$\n$$S = \\frac{A - A^*}{2} = \\frac{(K - k^2 I - i \\alpha k^2 I) - (K - k^2 I + i \\alpha k^2 I)}{2} = \\frac{-2i \\alpha k^2 I}{2} = -i \\alpha k^2 I$$\n\nThe analysis of the eigenvalues for $H$ and $S$ proceeds as follows:\n\nEigenvalues of $H$:\nThe Hermitian part is $H = K - k^2 I$. Since $H$ is a real symmetric (and thus Hermitian) matrix, its eigenvalues are all real. The eigenvalues of $H$, denoted $\\lambda_j(H)$, are related to the eigenvalues of the discrete Laplacian $K$, denoted $\\lambda_j(K)$, by a simple shift:\n$$\\lambda_j(H) = \\lambda_j(K) - k^2$$\nThe eigenvalues of the $2$D discrete Laplacian $K$ on a grid with $N_x \\times N_y$ interior points and spacings $h_x, h_y$ are known analytically:\n$$\\lambda_{j,l}(K) = \\frac{4}{h_x^2} \\sin^2\\left(\\frac{j\\pi}{2(N_x+1)}\\right) + \\frac{4}{h_y^2} \\sin^2\\left(\\frac{l\\pi}{2(N_y+1)}\\right)$$\nfor $j=1, \\dots, N_x$ and $l=1, \\dots, N_y$. All eigenvalues $\\lambda_{j,l}(K)$ are strictly positive. The sign of an eigenvalue of $H$ therefore depends on whether the corresponding eigenvalue of $K$ is greater than, equal to, or less than $k^2$. The problem requires a numerical classification based on a tolerance $\\tau_H$. For each test case, we numerically compute the eigenvalues of $H$, calculate $\\tau_H$, and count the number of eigenvalues in the categories strictly positive ($\\lambda > \\tau_H$), approximately zero ($|\\lambda| \\le \\tau_H$), and strictly negative ($\\lambda < -\\tau_H$).\n\nEigenvalues of $S$:\nThe skew-Hermitian part is $S = -i \\alpha k^2 I$. A skew-Hermitian matrix has purely imaginary eigenvalues. For $S$, which is a scalar multiple of the identity matrix $I$, all $N$ eigenvalues are identical:\n$$\\mu = -i \\alpha k^2$$\nThe imaginary part of each eigenvalue is $\\operatorname{Im}(\\mu) = -\\alpha k^2$. Since the problem states $\\alpha \\ge 0$ and $k^2 \\ge 0$, the imaginary part must be non-positive, i.e., $\\operatorname{Im}(\\mu) \\le 0$. Consequently, the count of eigenvalues with a strictly positive imaginary part, $\\#S_{+i}$, is always zero.\nThe classification into approximately zero or strictly negative imaginary parts depends on the value of $\\alpha k^2$. If $\\alpha=0$ or $k^2=0$, then $\\operatorname{Im}(\\mu)=0$ and all eigenvalues are classified as having an approximately zero imaginary part. If $\\alpha k^2 > 0$, we compare $|\\operatorname{Im}(\\mu)| = \\alpha k^2$ against the tolerance $\\tau_S$. If $\\alpha k^2 \\le \\tau_S$, the imaginary parts are approximately zero; otherwise, they are strictly negative. Since all eigenvalues of $S$ are identical, they will all fall into the same category. Thus, either $\\#S_{0i}=N$ or $\\#S_{-i}=N$.\n\nThe computational procedure is to implement these steps for each parameter set in the test suite. This involves:\n$1$. Constructing the $1$D discrete Laplacian matrices $T_x$ and $T_y$.\n$2$. Constructing the $2$D discrete Laplacian $K$ using the Kronecker sum.\n$3$. Forming the Hermitian matrix $H = K - k^2 I$.\n$4$. Computing the eigenvalues of $H$ using a numerical eigensolver.\n$5$. Calculating the tolerance $\\tau_H$ and counting the positive, zero, and negative eigenvalues of $H$.\n$6$. Calculating the single imaginary value $-\\alpha k^2$ for the eigenvalues of $S$.\n$7$. Calculating the tolerance $\\tau_S$ and determining if all $N$ eigenvalues of $S$ have approximately zero or strictly negative imaginary parts.\n$8$. Assembling the six integer counts for each case.\nThe following Python code implements this logic.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of classifying eigenvalues for the Hermitian and skew-Hermitian\n    parts of a discrete Helmholtz operator for a suite of test cases.\n    \"\"\"\n    # Test suite of parameter sets (Nx, Ny, k^2, alpha)\n    test_cases = [\n        (8, 8, 0.1, 0.0),\n        (16, 16, 400.0, 0.0),\n        (8, 8, 10000.0, 0.0),\n        (10, 10, 100.0, 0.5),\n    ]\n\n    all_results = []\n    \n    def build_1d_laplacian(dim, h):\n        \"\"\"Constructs the 1D discrete Laplacian matrix T.\"\"\"\n        if dim == 0:\n            return np.array([[]])\n        main_diag = np.full(dim, 2.0 / h**2)\n        off_diag = np.full(dim - 1, -1.0 / h**2)\n        T = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n        return T\n\n    for case in test_cases:\n        Nx, Ny, k_squared, alpha = case\n        \n        # Grid parameters and total matrix size\n        hx = 1.0 / (Nx + 1)\n        hy = 1.0 / (Ny + 1)\n        N = Nx * Ny\n\n        # 1. Construct matrices\n        Tx = build_1d_laplacian(Nx, hx)\n        Ty = build_1d_laplacian(Ny, hy)\n        \n        Ix = np.identity(Nx)\n        Iy = np.identity(Ny)\n        \n        # K is the 2D negative discrete Laplacian\n        K = np.kron(Iy, Tx) + np.kron(Ty, Ix)\n\n        # 2. Form H and analyze its eigenvalues\n        # H = K - k^2 * I\n        I_N = np.identity(N)\n        H = K - k_squared * I_N\n\n        # H is real and symmetric, use eigvalsh for efficiency\n        eigvals_H = np.linalg.eigvalsh(H)\n\n        # 3. Classify eigenvalues of H\n        if N > 0:\n            tau_H = 1e-10 * max(1.0, np.max(np.abs(eigvals_H)))\n        else:\n            tau_H = 1e-10\n\n        H_pos = np.sum(eigvals_H > tau_H)\n        H_neg = np.sum(eigvals_H < -tau_H)\n        H_zero = N - H_pos - H_neg\n\n        # 4. Analyze eigenvalues of S\n        # S = -i * alpha * k^2 * I. All eigenvalues are mu = -i * alpha * k^2.\n        imag_part_S = -alpha * k_squared\n        \n        # 5. Classify eigenvalues of S\n        # Im(mu) is non-positive, so S_pos_i is always 0.\n        S_pos_i = 0\n        \n        abs_imag_part = abs(imag_part_S)\n        \n        # Tolerance for S is based on the max absolute imaginary part, which is uniform.\n        tau_S = 1e-10 * max(1.0, abs_imag_part)\n\n        if abs_imag_part <= tau_S:\n            S_zero_i = N\n            S_neg_i = 0\n        else: # This implies imag_part_S < -tau_S\n            S_zero_i = 0\n            S_neg_i = N\n            \n        case_result = [int(H_pos), int(H_zero), int(H_neg), int(S_pos_i), int(S_zero_i), int(S_neg_i)]\n        all_results.append(case_result)\n\n    # Format the final output string to match the required format:\n    # e.g., [[r1_1,...,r1_6],[r2_1,...,r2_6]]\n    list_of_strs = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output_str = f\"[{','.join(list_of_strs)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "An effective preconditioner, like the shifted-Laplace operator $M$, transforms a difficult problem into an easier one, but we still need an efficient algorithm to solve systems with $M$. This final practice moves from analysis to high-level algorithmic design, tasking you with constructing a complete geometric multigrid V-cycle—a state-of-the-art method for this purpose. Successfully navigating this problem requires synthesizing your understanding of the operator's properties to select a consistent set of smoothers, inter-grid transfer operators, and coarse-grid solvers, which is a key skill in computational science .",
            "id": "3614331",
            "problem": "In computational geophysics, the frequency-domain acoustic wave equation with constant wavenumber $k$ in $3\\mathrm{D}$ can be written in continuous form as the Helmholtz problem $\\left(-\\nabla^2 - k^2\\right) u = f$. A widely used preconditioner for Krylov methods applied to this indefinite system is the shifted-Laplace operator $M = -\\nabla^2 - (1 + i \\alpha) k^2$ with real shift $\\alpha > 0$, which renders the discrete operator more elliptic-like while keeping the phase information through the imaginary part. Consider a uniform cubic grid with spacing $h$ and a second-order $7$-point finite-difference discretization of $M$ on $n \\times n \\times n$ points, giving $N = n^3$ degrees of freedom. You plan to approximately invert $M$ with a geometric multigrid V-cycle that employs $\\nu_1 = 1$ pre-smoothing step, $\\nu_2 = 1$ post-smoothing step per level, standard coarsening by a factor of $2$ in each spatial direction, and an exact solve on the coarsest grid.\n\nSelect the option that specifies a scientifically consistent multigrid V-cycle design for approximately inverting $M$ in this $3\\mathrm{D}$ constant-$k$ setting (i.e., an effective smoother, compatible restriction and prolongation, and an appropriate coarse-grid operator) and provides a quantitatively consistent estimate of the computational work per V-cycle, expressed in units of one fine-grid matrix-vector product with the discrete $M$.\n\nA. Smoother: weighted Jacobi with weight $\\omega = 2/3$ applied to the discrete $M$; restriction $R$: $3\\mathrm{D}$ full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c = R M P$; choose $\\alpha \\approx 0.5$; estimated work per V-cycle: approximately $3.5$ fine-grid matrix-vector products.\n\nB. Smoother: symmetric Gauss–Seidel applied to the unshifted Helmholtz operator $H = -\\nabla^2 - k^2$ (i.e., $\\alpha = 0$); restriction $R$: injection; prolongation $P$: nearest-neighbor; coarse operator $A_c$: rediscretized pure Laplacian $-\\nabla^2$ (dropping the $k^2$ term); estimated work per V-cycle: approximately $2.0$ fine-grid matrix-vector products.\n\nC. Smoother: degree-$2$ Chebyshev polynomial applied directly to $M$ using spectral bounds taken from the real-symmetric discrete Laplacian; restriction $R$: full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c = R M P$; choose $\\alpha \\approx 0.7$; estimated work per V-cycle: approximately $6.0$ fine-grid matrix-vector products.\n\nD. Smoother: weighted Jacobi with over-relaxation $\\omega = 1.2$ applied to the discrete $M$; restriction $R$: full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c = R M P$; choose $\\alpha \\approx 0.1$; estimated work per V-cycle: approximately $3.0$ fine-grid matrix-vector products.",
            "solution": "The user wants a critical validation of a problem statement concerning multigrid methods for the Helmholtz equation, followed by a full solution if the problem is deemed valid.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The $3\\mathrm{D}$ Helmholtz problem is $\\left(-\\nabla^2 - k^2\\right) u = f$, where $k$ is a constant wavenumber.\n- **Preconditioner Operator**: The discrete system is preconditioned by approximately inverting the shifted-Laplace operator $M = -\\nabla^2 - (1 + i \\alpha) k^2$, with a real shift parameter $\\alpha > 0$.\n- **Discretization**: A second-order $7$-point finite-difference stencil is used on a uniform cubic grid with spacing $h$.\n- **Grid Dimensions**: The grid has $n \\times n \\times n$ points, for a total of $N = n^3$ degrees of freedom.\n- **Multigrid Cycle**: A geometric multigrid V-cycle is used to approximate $M^{-1}$.\n- **Multigrid Parameters**:\n    - Pre-smoothing steps: $\\nu_1 = 1$.\n    - Post-smoothing steps: $\\nu_2 = 1$.\n    - Coarsening: Standard coarsening by a factor of $2$ in each spatial dimension.\n    - Coarsest Grid: An exact solve is performed.\n- **Task**: Identify a scientifically consistent multigrid V-cycle design (smoother, restriction, prolongation, coarse-grid operator) and a quantitatively consistent estimate of the computational work per V-cycle.\n- **Work Unit**: The work is to be expressed in units of one fine-grid matrix-vector product with the discrete operator $M$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated based on the established criteria.\n\n- **Scientifically Grounded**: The problem is rooted in standard, well-established practices in computational science and engineering. The Helmholtz equation is fundamental to wave propagation phenomena. The use of shifted-Laplace preconditioners and geometric multigrid methods are state-of-the-art techniques for solving the resulting large, sparse, indefinite linear systems. All components mentioned (V-cycles, smoothers, inter-grid transfers, Galerkin coarsening) are standard concepts in numerical analysis. The setup is scientifically sound.\n- **Well-Posed**: The problem is clearly stated. It asks for the identification of a consistent and effective multigrid design among a set of options. Given the parameters, the properties of a \"good\" multigrid cycle are well-defined in the literature, allowing for a rigorous evaluation of the options.\n- **Objective**: The language is precise and technical, free of subjectivity or ambiguity.\n- **Completeness**: The problem provides all necessary information to assess the scientific validity and computational cost of the proposed multigrid designs. The operator, discretization, multigrid cycle type, smoothing steps, and coarsening strategy are all specified.\n\n### Step 3: Verdict and Action\nThe problem statement is determined to be **valid**. It is scientifically sound, well-posed, objective, and complete. Therefore, I will proceed with a full solution and analysis of the options.\n\n### Derivation and Analysis\n\nA scientifically consistent multigrid design for the operator $M = -\\nabla^2 - (1 + i \\alpha) k^2$ must satisfy several key principles. The operator $M$ is complex-valued and non-Hermitian. The shift term $(1 + i \\alpha) k^2$ makes the operator more diagonally dominant and elliptic-like compared to the original indefinite Helmholtz operator, which is beneficial for multigrid convergence.\n\n1.  **Smoother**: The smoother's role is to to damp high-frequency error components. For the shifted-Laplace operator, the high-frequency behavior is dominated by the discrete Laplacian $-\\nabla^2$. Therefore, effective smoothers are typically those that work well for the Poisson equation, such as weighted (damped) Jacobi or certain polynomial smoothers. The smoother must be designed for the operator $M$ itself.\n\n2.  **Inter-Grid Transfer Operators**: For a second-order finite-difference discretization, a consistent choice is full-weighting for the restriction operator ($R$) and its transpose, trilinear interpolation, for the prolongation operator ($P$). This pair preserves the accuracy of the scheme and leads to robust multigrid performance.\n\n3.  **Coarse-Grid Operator**: The Galerkin operator, $A_c = R M P$, is the most robust way to define the coarse-grid operator. It ensures that the coarse-grid representation is algebraically consistent with the fine-grid operator and the transfer operators. This is particularly crucial for complex operators like $M$ where simple rediscretization on the coarse grid might fail to capture the correct physics.\n\n4.  **Work Estimation for a V-cycle**: The computational work for a V-cycle can be estimated by summing the work done on each level of the multigrid hierarchy. The work on a single level (excluding the recursive call) is dominated by the smoothing steps and the residual calculation. Let the cost of one matrix-vector product on the fine grid be the unit of work.\n    - Pre-smoothing: $\\nu_1 = 1$ step. Assuming the smoother cost is one mat-vec (as for weighted Jacobi), this is $1$ unit.\n    - Residual calculation ($r_h = f_h - M_h x_h$): $1$ mat-vec, i.e., $1$ unit.\n    - Post-smoothing: $\\nu_2 = 1$ step, costing $1$ unit.\n    The total work on a level is approximately $(\\nu_1 + \\nu_2 + 1) = (1+1+1) = 3$ units.\n    In $3\\mathrm{D}$, coarsening by a factor of $2$ reduces the number of grid points by a factor of $8$. The total work of a V-cycle, $W_V$, is a geometric series:\n    $$ W_V \\approx (\\text{work per level}) \\times \\sum_{l=0}^{\\infty} \\left(\\frac{1}{8}\\right)^l = (\\nu_1+\\nu_2+1) \\times \\frac{1}{1 - 1/8} = 3 \\times \\frac{8}{7} = \\frac{24}{7} \\approx 3.43 $$\n    Therefore, a consistent work estimate for one V-cycle with $\\nu_1=\\nu_2=1$ is approximately $3.4 - 3.5$ fine-grid mat-vecs.\n\n### Option-by-Option Analysis\n\n**A. Smoother: weighted Jacobi with weight $\\omega = 2/3$ applied to the discrete $M$; restriction $R$: $3\\mathrm{D}$ full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c = R M P$; choose $\\alpha \\approx 0.5$; estimated work per V-cycle: approximately $3.5$ fine-grid matrix-vector products.**\n- **Smoother**: Weighted Jacobi is a standard smoother. For elliptic-like problems, an under-relaxation factor ($\\omega < 1$) is used to ensure robust damping of high-frequency modes. $\\omega = 2/3$ is a common and effective choice. This is a scientifically sound smoother.\n- **Transfer Operators**: Full weighting and trilinear interpolation are a high-quality, compatible pair for this discretization. Correct.\n- **Coarse Operator**: The Galerkin operator $A_c = R M P$ is the robust, standard choice. Correct.\n- **Shift Parameter**: $\\alpha \\approx 0.5$ is a typical value used in practice, balancing the improved ellipticity of $M$ with its quality as an approximation to the original Helmholtz operator. Correct.\n- **Work Estimate**: The estimate of $\\approx 3.5$ mat-vecs is in excellent agreement with our derived value of $\\approx 3.43$. Correct.\n- **Verdict**: This option describes a completely standard, scientifically consistent, and quantitatively accurate multigrid design. **Correct**.\n\n**B. Smoother: symmetric Gauss–Seidel applied to the unshifted Helmholtz operator $H = -\\nabla^2 - k^2$ (i.e., $\\alpha = 0$); restriction $R$: injection; prolongation $P$: nearest-neighbor; coarse operator $A_c$: rediscretized pure Laplacian $-\\nabla^2$ (dropping the $k^2$ term); estimated work per V-cycle: approximately $2.0$ fine-grid matrix-vector products.**\n- **Smoother**: This is fundamentally flawed. The multigrid cycle is designed to invert $M$, so the smoother must be based on $M$, not the original operator $H$. Applying a smoother for a different operator is inconsistent and will not work. Additionally, Gauss-Seidel is a poor smoother for the indefinite Helmholtz operator $H$.\n- **Transfer Operators**: Injection and nearest-neighbor is a low-order pair, generally suboptimal for second-order discretizations.\n- **Coarse Operator**: This is another major flaw. Rediscretizing only the Laplacian term and discarding the complex-shifted wavenumber term means the coarse-grid operator does not approximate the low-frequency modes of the fine-grid operator $M$. This leads to a breakdown of multigrid convergence.\n- **Work Estimate**: The estimate of $2.0$ mat-vecs is inconsistent with the standard work calculation for a V(1,1) cycle, which should be around $3.43$ mat-vecs.\n- **Verdict**: This option contains multiple fundamental errors in multigrid design. **Incorrect**.\n\n**C. Smoother: degree-$2$ Chebyshev polynomial applied directly to $M$ using spectral bounds taken from the real-symmetric discrete Laplacian; restriction $R$: full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c = R M P$; choose $\\alpha \\approx 0.7$; estimated work per V-cycle: approximately $6.0$ fine-grid matrix-vector products.**\n- **Smoother**: A Chebyshev polynomial smoother is a valid and powerful choice. However, its design depends critically on having an ellipse that encloses the eigenvalues of the operator being smoothed. The statement specifies using spectral bounds from the real-symmetric discrete Laplacian. This is a critical error. The operator is $M$, which is complex and non-Hermitian; its spectrum is shifted into the complex plane and is not contained within the spectral bounds of the real Laplacian. Using the wrong spectral bounds results in an unstable or ineffective smoother.\n- **Work Estimate**: A degree-$2$ polynomial smoother requires $2$ mat-vecs per application. For a V(1,1) cycle, the work on one level would be $(\\nu_1 \\times 2 + \\nu_2 \\times 2 + 1) = (1 \\times 2 + 1 \\times 2 + 1) = 5$ mat-vecs. The total work estimate would be $W_V \\approx 5 \\times (8/7) \\approx 5.71$ mat-vecs. The provided estimate of $\\approx 6.0$ is quantitatively consistent with the specified (but flawed) smoother. However, the flaw in the smoother's design makes the entire proposition invalid.\n- **Verdict**: While many components are correct, the design of the smoother is based on a fundamental scientific error, rendering the multigrid cycle non-functional. **Incorrect**.\n\n**D. Smoother: weighted Jacobi with over-relaxation $\\omega = 1.2$ applied to the discrete $M$; restriction $R$: full weighting; prolongation $P$: trilinear interpolation; coarse operator $A_c = R M P$; choose $\\alpha \\approx 0.1$; estimated work per V-cycle: approximately $3.0$ fine-grid matrix-vector products.**\n- **Smoother**: Using over-relaxation ($\\omega > 1$) with the Jacobi method is generally only stable and effective for certain classes of matrices, typically symmetric positive-definite matrices. The operator $M$ is non-Hermitian with eigenvalues in the complex plane. For such operators, over-relaxation is very likely to cause divergence or instability in the smoothing process. The standard, robust approach is under-relaxation ($\\omega < 1$). Therefore, $\\omega = 1.2$ is a scientifically unsound choice for a robust smoother.\n- **Work Estimate**: The estimate of $\\approx 3.0$ mat-vecs is somewhat lower than the theoretical estimate of $\\approx 3.43$. While possibly acceptable as a rough approximation, the estimate in option A is more accurate. The primary flaw remains the smoother.\n- **Verdict**: The choice of an over-relaxed Jacobi smoother is inappropriate for this class of non-Hermitian operators and would likely lead to an unstable multigrid method. **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}