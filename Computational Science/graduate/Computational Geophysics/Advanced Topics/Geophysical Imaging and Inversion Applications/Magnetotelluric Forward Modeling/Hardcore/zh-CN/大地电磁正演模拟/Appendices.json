{
    "hands_on_practices": [
        {
            "introduction": "大地电磁测深法的一个核心原理是电磁波在导电介质中的衰减，这一现象通常用“趋肤深度”($\\delta$)来量化。趋肤深度决定了特定频率的电磁信号能够穿透的有效深度，频率越低，穿透深度越深。这个练习将从麦克斯韦方程组出发，推导均匀半空间中的趋肤深度表达式，并通过计算不同频率下的趋肤深度及其对应的灵敏度窗口，来巩固对大地电磁测深法“频率-深度”关系的直观理解。",
            "id": "3609004",
            "problem": "考虑一个一维平面波大地电磁（MT）正演模型场景：一个均匀的导电半空间占据 $z \\ge 0$ 的区域，时谐源场随 $\\exp(i \\omega t)$ 变化，水平电场和磁场仅依赖于深度 $z$。从传导电流占主导的极限下的麦克斯韦方程组出发，假设 $\\sigma \\gg \\omega \\epsilon_0$，其中 $\\sigma$ 是电导率，$\\epsilon_0$ 是真空介电常数，$\\omega$ 是角频率。磁导率为 $\\mu = \\mu_0$，其中 $\\mu_0 = 4 \\pi \\times 10^{-7} \\,\\mathrm{H/m}$。推导场在导电半空间中随深度变化的衰减规律，并求出电磁趋肤深度 $\\delta$ 关于 $\\sigma$、$\\mu$ 和 $\\omega$ 的表达式。\n\n使用推导出的表达式，计算在电导率 $\\sigma = 0.1 \\,\\mathrm{S/m}$、频率 $\\omega/2\\pi = f = 0.1$、$1$ 和 $10$ Hz 时，趋肤深度 $\\delta$ 的值。然后，采用启发式法则，即对地下电导率的主要灵敏度区间为 $[0.5 \\,\\delta, 2 \\,\\delta]$，在每个频率下估算一个具有物理意义的大地电磁灵敏度窗口。\n\n所有数值结果保留三位有效数字。所有距离以千米（km）为单位表示。最终答案以一个单行矩阵的形式报告，包含九个条目，顺序为 $[\\delta_{0.1}, z_{\\min,0.1}, z_{\\max,0.1}, \\delta_{1}, z_{\\min,1}, z_{\\max,1}, \\delta_{10}, z_{\\min,10}, z_{\\max,10}]$，其中 $\\delta_{f}$ 是频率 $f$ 处的趋肤深度，$z_{\\min,f}$ 和 $z_{\\max,f}$ 是频率 $f$ 处灵敏度窗口的相应下限和上限。",
            "solution": "题目要求在大地电磁（MT）近似下推导导电介质中的电磁趋肤深度，然后针对特定参数进行数值计算。\n\n首先，我们推导导体中电磁场的控制方程。我们从线性、各向同性、均匀且无自由电荷的导电介质中的麦克斯韦方程组开始。对于时谐场，其时间依赖性为 $\\exp(i \\omega t)$，法拉第定律和安培定律的相量形式为：\n$$\n\\nabla \\times \\mathbf{E} = -i \\omega \\mathbf{B}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + i \\omega \\mathbf{D}\n$$\n本构关系为 $\\mathbf{B} = \\mu \\mathbf{H}$，$\\mathbf{D} = \\epsilon \\mathbf{E}$，欧姆定律为 $\\mathbf{J} = \\sigma \\mathbf{E}$。题目指定介质的磁导率为 $\\mu = \\mu_0$。安培定律变为：\n$$\n\\nabla \\times \\mathbf{H} = \\sigma \\mathbf{E} + i \\omega \\epsilon \\mathbf{E} = (\\sigma + i \\omega \\epsilon) \\mathbf{E}\n$$\n题目指出我们处于传导电流占主导的极限下，也称为准静态近似，其中 $\\sigma \\gg \\omega \\epsilon$。这使我们可以忽略位移电流项 $i \\omega \\epsilon \\mathbf{E}$，而只考虑传导电流项 $\\sigma \\mathbf{E}$。安培定律简化为：\n$$\n\\nabla \\times \\mathbf{H} \\approx \\sigma \\mathbf{E}\n$$\n为了得到电场的波动方程，我们对法拉第定律取旋度：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla \\times (-i \\omega \\mathbf{B}) = -i \\omega \\mu_0 (\\nabla \\times \\mathbf{H})\n$$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E}$ 并代入简化后的安培定律，我们得到：\n$$\n\\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E} = -i \\omega \\mu_0 \\sigma \\mathbf{E}\n$$\n在均匀导体中，电导率 $\\sigma$ 没有空间变化，因此假设没有净电荷密度，高斯定律给出 $\\nabla \\cdot \\mathbf{E} = 0$。方程简化为一个类似亥姆霍兹方程的矢量方程，在此背景下通常称为扩散方程：\n$$\n\\nabla^2 \\mathbf{E} = i \\omega \\mu_0 \\sigma \\mathbf{E}\n$$\n题目考虑的是平面波，其中场仅依赖于深度 $z$，导电介质占据 $z \\ge 0$ 的区域。对于一个水平电场分量，例如 $E_x(z)$，拉普拉斯算子 $\\nabla^2$ 简化为对 $z$ 的二阶导数 $\\frac{d^2}{dz^2}$。$E_x$ 的方程为：\n$$\n\\frac{d^2 E_x}{dz^2} = i \\omega \\mu_0 \\sigma E_x\n$$\n这是一个二阶线性常微分方程。我们可以将其写为 $\\frac{d^2 E_x}{dz^2} - k^2 E_x = 0$，其中 $k^2 = i \\omega \\mu_0 \\sigma$。通解为 $E_x(z) = A \\exp(-kz) + B \\exp(kz)$。为了使场具有物理意义，其振幅在 $z \\to \\infty$ 时必须保持有界。这要求系数 $B$ 为 $0$。因此，解是一个向下传播的波：\n$$\nE_x(z) = E_x(0) \\exp(-kz)\n$$\n其中 $E_x(0)$ 是地表 $z=0$ 处的场。复传播常数 $k$ 由下式给出：\n$$\nk = \\sqrt{i \\omega \\mu_0 \\sigma}\n$$\n为了理解衰减，我们将 $k$ 表示为其_实部和虚部_。我们使用恒等式 $\\sqrt{i} = \\frac{1+i}{\\sqrt{2}}$。\n$$\nk = \\sqrt{\\omega \\mu_0 \\sigma} \\cdot \\sqrt{i} = \\sqrt{\\omega \\mu_0 \\sigma} \\left( \\frac{1+i}{\\sqrt{2}} \\right) = \\sqrt{\\frac{\\omega \\mu_0 \\sigma}{2}} + i \\sqrt{\\frac{\\omega \\mu_0 \\sigma}{2}}\n$$\n将此代回 $E_x(z)$ 的解中：\n$$\nE_x(z) = E_x(0) \\exp\\left(-\\left(\\sqrt{\\frac{\\omega \\mu_0 \\sigma}{2}}\\right) z\\right) \\exp\\left(-i \\left(\\sqrt{\\frac{\\omega \\mu_0 \\sigma}{2}}\\right) z\\right)\n$$\n场的振幅为 $|E_x(z)| = |E_x(0)| \\exp\\left(-\\frac{z}{\\delta}\\right)$，其中项 $\\exp\\left(-\\left(\\sqrt{\\frac{\\omega \\mu_0 \\sigma}{2}}\\right) z\\right)$ 描述了场随深度的指数衰减。电磁趋肤深度 $\\delta$ 定义为振幅衰减到其地表值 $1/e$ 时的深度。这发生在实指数的参数为 $-1$ 时，即 $z \\cdot \\sqrt{\\frac{\\omega \\mu_0 \\sigma}{2}} = 1$。因此，趋肤深度的表达式为：\n$$\n\\delta = \\frac{1}{\\sqrt{\\frac{\\omega \\mu_0 \\sigma}{2}}} = \\sqrt{\\frac{2}{\\omega \\mu_0 \\sigma}}\n$$\n已知角频率 $\\omega$ 和频率 $f$ 之间的关系为 $\\omega = 2 \\pi f$，该公式可以表示为：\n$$\n\\delta = \\sqrt{\\frac{2}{2 \\pi f \\mu_0 \\sigma}} = \\sqrt{\\frac{1}{\\pi f \\mu_0 \\sigma}}\n$$\n这就是所求的趋肤深度表达式。\n\n现在，我们计算数值。给定：\n$\\sigma = 0.1 \\,\\mathrm{S/m}$\n$\\mu_0 = 4 \\pi \\times 10^{-7} \\,\\mathrm{H/m}$\n频率 $f$ 分别为 $0.1 \\,\\mathrm{Hz}$，$1 \\,\\mathrm{Hz}$ 和 $10 \\,\\mathrm{Hz}$。\n\n我们以米为单位计算 $\\delta$，然后转换为千米（$1\\,\\mathrm{km} = 1000\\,\\mathrm{m}$）。\n计算公式为 $\\delta = \\sqrt{\\frac{1}{\\pi f \\sigma \\mu_0}}$。\n$\\delta \\approx \\sqrt{\\frac{1}{\\pi f (0.1) (4\\pi \\times 10^{-7})}} = \\sqrt{\\frac{1}{0.4 \\pi^2 f \\times 10^{-7}}} = \\frac{1}{\\sqrt{f}}\\sqrt{\\frac{10^7}{0.4 \\pi^2}} \\approx \\frac{1591.55}{\\sqrt{f}} \\, \\mathrm{m}$。\n\n对于 $f = 0.1 \\,\\mathrm{Hz}$：\n$\\delta_{0.1} \\approx \\frac{1591.55}{\\sqrt{0.1}} \\approx 5032.9 \\,\\mathrm{m} \\approx 5.0329 \\,\\mathrm{km}$。\n保留三位有效数字，$\\delta_{0.1} = 5.03 \\,\\mathrm{km}$。\n灵敏度窗口为 $[0.5 \\delta_{0.1}, 2 \\delta_{0.1}]$：\n$z_{\\min,0.1} = 0.5 \\times 5.0329 \\,\\mathrm{km} \\approx 2.5165 \\,\\mathrm{km}$。保留三位有效数字，$z_{\\min,0.1} = 2.52 \\,\\mathrm{km}$。\n$z_{\\max,0.1} = 2 \\times 5.0329 \\,\\mathrm{km} \\approx 10.0658 \\,\\mathrm{km}$。保留三位有效数字，$z_{\\max,0.1} = 10.1 \\,\\mathrm{km}$。\n\n对于 $f = 1 \\,\\mathrm{Hz}$：\n$\\delta_{1} \\approx \\frac{1591.55}{\\sqrt{1}} \\approx 1591.55 \\,\\mathrm{m} \\approx 1.59155 \\,\\mathrm{km}$。\n保留三位有效数字，$\\delta_{1} = 1.59 \\,\\mathrm{km}$。\n灵敏度窗口为 $[0.5 \\delta_{1}, 2 \\delta_{1}]$：\n$z_{\\min,1} = 0.5 \\times 1.59155 \\,\\mathrm{km} \\approx 0.79578 \\,\\mathrm{km}$。保留三位有效数字，$z_{\\min,1} = 0.796 \\,\\mathrm{km}$。\n$z_{\\max,1} = 2 \\times 1.59155 \\,\\mathrm{km} \\approx 3.1831 \\,\\mathrm{km}$。保留三位有效数字，$z_{\\max,1} = 3.18 \\,\\mathrm{km}$。\n\n对于 $f = 10 \\,\\mathrm{Hz}$：\n$\\delta_{10} \\approx \\frac{1591.55}{\\sqrt{10}} \\approx 503.29 \\,\\mathrm{m} \\approx 0.50329 \\,\\mathrm{km}$。\n保留三位有效数字，$\\delta_{10} = 0.503 \\,\\mathrm{km}$。\n灵敏度窗口为 $[0.5 \\delta_{10}, 2 \\delta_{10}]$：\n$z_{\\min,10} = 0.5 \\times 0.50329 \\,\\mathrm{km} \\approx 0.25165 \\,\\mathrm{km}$。保留三位有效数字，$z_{\\min,10} = 0.252 \\,\\mathrm{km}$。\n$z_{\\max,10} = 2 \\times 0.50329 \\,\\mathrm{km} \\approx 1.00658 \\,\\mathrm{km}$。保留三位有效数字，$z_{\\max,10} = 1.01 \\,\\mathrm{km}$。\n\n最终的九个值，按指定顺序排列为：\n$\\delta_{0.1} = 5.03$, $z_{\\min,0.1} = 2.52$, $z_{\\max,0.1} = 10.1$\n$\\delta_{1} = 1.59$, $z_{\\min,1} = 0.796$, $z_{\\max,1} = 3.18$\n$\\delta_{10} = 0.503$, $z_{\\min,10} = 0.252$, $z_{\\max,10} = 1.01$\n所有数值的单位均为千米。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.03 & 2.52 & 10.1 & 1.59 & 0.796 & 3.18 & 0.503 & 0.252 & 1.01\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在处理真实的大地电磁数据时，我们通常面对的是二维或三维的复杂地质结构，此时水平电场与磁场之间的关系需要通过一个 $2 \\times 2$ 的阻抗张量 $\\mathbf{Z}$ 来描述。为了简化解释，通常需要将测量坐标系旋转到与地质构造走向一致的坐标系中，但在实践中，走向角的确定往往存在误差。这个练习旨在探讨一个微小的旋转角度误差 $\\epsilon$ 如何通过张量变换影响我们对关键阻抗分量的估算，从而加深对数据处理中误差传播机制的理解。",
            "id": "3608944",
            "problem": "在大地电磁（MT）正演模拟中，用于时谐场的频域麦克斯韦方程组表明，水平电场 $\\mathbf{E}$ 和水平磁场 $\\mathbf{H}$ 之间存在线性关系，形式为 $\\mathbf{E} = \\mathbf{Z}\\,\\mathbf{H}$，其中 $\\mathbf{Z}$ 是复数 $2 \\times 2$ 阻抗张量。当水平坐标系旋转一个角度 $\\phi$ 时，场量作为矢量进行变换，即 $\\mathbf{E}' = \\mathbf{R}(\\phi)\\,\\mathbf{E}$ 和 $\\mathbf{H}' = \\mathbf{R}(\\phi)\\,\\mathbf{H}$，其中 $\\mathbf{R}(\\phi)$ 是正交旋转矩阵。因此，阻抗张量通过相似变换进行转换：$\\mathbf{Z}' = \\mathbf{R}(\\phi)\\,\\mathbf{Z}\\,\\mathbf{R}(-\\phi)$。\n\n考虑一个在走向对齐坐标系中近似二维的结构，因此在走向对齐参考系中，真实的阻抗张量为\n$$\n\\mathbf{Z}_{s} = \\begin{pmatrix}\n\\delta_{1} & Z_{1} \\\\\n- Z_{2} & \\delta_{2}\n\\end{pmatrix},\n$$\n其中 $Z_{1}$ 和 $Z_{2}$ 是与两种典型模式相关的非对角阻抗，而 $\\delta_{1}$ 和 $\\delta_{2}$ 是表示弱三维耦合或小尺度电流畸变的小对角元。\n\n假设地理参考系通过一个未知的走向方位角 $\\theta$ 的旋转与走向对齐参考系相关联。在处理过程中，您试图将测量的 $\\mathbf{E}$ 和 $\\mathbf{H}$ 旋转到走向对齐参考系，但犯了一个小角度误差，施加了 $\\theta - \\epsilon$ 的旋转而不是精确的 $\\theta$，其中 $|\\epsilon| \\ll 1$。在存在非零对角项 $\\delta_{1}$ 和 $\\delta_{2}$ 的情况下，这种不完全的旋转会对估计的阻抗张量引入偏差。\n\n仅使用以下事实：（i）对于时谐场，水平电场 $\\mathbf{E}$ 和水平磁场 $\\mathbf{H}$ 通过 $\\mathbf{E} = \\mathbf{Z}\\,\\mathbf{H}$ 线性相关；（ii）矢量和张量如上所述通过正交相似变换进行旋转。请推导至 $\\epsilon$ 的一阶，量化因不完全旋转导致 $Z_{xy}$ 分量估计值变化的修正项。用 $\\epsilon$、$\\delta_{1}$ 和 $\\delta_{2}$ 表示您的结果。然后，根据以下数值评估 $Z_{xy}$ 的一阶修正估计值：\n- $Z_{1} = (2.0 - 0.5\\,\\mathrm{i}) \\times 10^{2}$,\n- $Z_{2} = (3.0 + 0.8\\,\\mathrm{i}) \\times 10^{2}$,\n- $\\delta_{1} = 5 - 2\\,\\mathrm{i}$,\n- $\\delta_{2} = -3 + 1\\,\\mathrm{i}$,\n- $\\epsilon = 2$ 度。\n\n将 $\\epsilon$ 视为小参数，并仅保留 $\\epsilon$ 的线性项。使用约定 $\\mathrm{i}^{2} = -1$。计算前将角度转换为弧度。将最终的复阻抗以欧姆为单位，表示为 $a + \\mathrm{i}\\,b$ 的形式，并四舍五入到四位有效数字。以欧姆为单位说明最终答案。",
            "solution": "首先根据要求标准验证问题陈述。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 水平电场 $\\mathbf{E}$ 和磁场 $\\mathbf{H}$ 之间的关系是 $\\mathbf{E} = \\mathbf{Z}\\,\\mathbf{H}$。\n- $\\mathbf{Z}$ 是一个复数 $2 \\times 2$ 阻抗张量。\n- 当坐标系旋转一个角度 $\\phi$ 时，场量和阻抗张量的变换为：$\\mathbf{E}' = \\mathbf{R}(\\phi)\\,\\mathbf{E}$，$\\mathbf{H}' = \\mathbf{R}(\\phi)\\,\\mathbf{H}$ 和 $\\mathbf{Z}' = \\mathbf{R}(\\phi)\\,\\mathbf{Z}\\,\\mathbf{R}(-\\phi)$，其中 $\\mathbf{R}(\\phi)$ 是一个正交旋转矩阵。\n- 走向对齐坐标系中的阻抗张量 $\\mathbf{Z}_{s}$ 由下式给出：\n$$\n\\mathbf{Z}_{s} = \\begin{pmatrix}\n\\delta_{1} & Z_{1} \\\\\n- Z_{2} & \\delta_{2}\n\\end{pmatrix}\n$$\n- 项 $\\delta_{1}$ 和 $\\delta_{2}$ 很小。\n- 地理参考系通过一个未知的走向方位角 $\\theta$ 的旋转与走向对齐参考系相关联。\n- 在处理中，应用了一个角度为 $\\theta - \\epsilon$ 的旋转，其中 $\\epsilon$ 是一个小角度误差，满足 $|\\epsilon| \\ll 1$。\n- 任务是推导关于 $\\epsilon$、$\\delta_{1}$ 和 $\\delta_{2}$ 的 $Z_{xy}$ 分量估计值的一阶修正。\n- 需要使用以下数值对 $Z_{xy}$ 的一阶修正估计值进行数值评估：\n  - $Z_{1} = (2.0 - 0.5\\,\\mathrm{i}) \\times 10^{2}$\n  - $Z_{2} = (3.0 + 0.8\\,\\mathrm{i}) \\times 10^{2}$\n  - $\\delta_{1} = 5 - 2\\,\\mathrm{i}$\n  - $\\delta_{2} = -3 + 1\\,\\mathrm{i}$\n  - $\\epsilon = 2$ 度。\n- 近似：仅保留 $\\epsilon$ 的线性项，使用 $\\mathrm{i}^{2} = -1$，将角度转换为弧度。\n- 最终数值结果格式：$a + \\mathrm{i}\\,b$，四舍五入到四位有效数字，单位为欧姆。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学性：** 该问题基于大地电磁学的基本原理，这是地球物理学中一个成熟的方法。阻抗张量、其在旋转下的变换性质以及准二维地球的阻抗结构都是标准且正确的概念。\n- **适定性：** 问题提供了所有必要的信息，包括矩阵形式、变换规则以及进行推导和计算所需的具体数值。目标明确。\n- **客观性：** 问题以精确、技术性的语言陈述，没有任何主观性或含糊之处。\n\n**步骤 3：结论与行动**\n该问题在科学上是合理的、自洽的且适定的。因此，它是**有效的**。我将继续进行解答。\n\n### 解答\n\n令 $\\mathbf{Z}_{geo}$ 为地理（测量）坐标系中的阻抗张量，$\\mathbf{Z}_{s}$ 为真实走向对齐坐标系中的阻抗张量。走向对齐参考系是通过将地理参考系旋转走向角 $\\theta$ 得到的。张量的变换规则为 $\\mathbf{Z}' = \\mathbf{R}(\\phi)\\,\\mathbf{Z}\\,\\mathbf{R}(-\\phi)$。因此，$\\mathbf{Z}_{s}$ 和 $\\mathbf{Z}_{geo}$ 之间的关系是：\n$$\n\\mathbf{Z}_{s} = \\mathbf{R}(\\theta)\\,\\mathbf{Z}_{geo}\\,\\mathbf{R}(-\\theta)\n$$\n为了用 $\\mathbf{Z}_{s}$ 表示 $\\mathbf{Z}_{geo}$，我们在左侧乘以 $\\mathbf{R}(-\\theta)$，在右侧乘以 $\\mathbf{R}(\\theta)$，利用旋转矩阵的性质 $\\mathbf{R}(-\\theta) = \\mathbf{R}(\\theta)^{-1}$：\n$$\n\\mathbf{Z}_{geo} = \\mathbf{R}(-\\theta)\\,\\mathbf{Z}_{s}\\,\\mathbf{R}(\\theta)\n$$\n在数据处理步骤中，通过对测量的张量 $\\mathbf{Z}_{geo}$ 应用一个不完美的旋转（角度为 $\\alpha = \\theta - \\epsilon$），计算出一个估计的走向对齐张量，我们将其表示为 $\\hat{\\mathbf{Z}}_{s}$：\n$$\n\\hat{\\mathbf{Z}}_{s} = \\mathbf{R}(\\alpha)\\,\\mathbf{Z}_{geo}\\,\\mathbf{R}(-\\alpha) = \\mathbf{R}(\\theta - \\epsilon)\\,\\mathbf{Z}_{geo}\\,\\mathbf{R}(-(\\theta - \\epsilon))\n$$\n代入 $\\mathbf{Z}_{geo}$ 的表达式：\n$$\n\\hat{\\mathbf{Z}}_{s} = \\mathbf{R}(\\theta - \\epsilon) \\left[ \\mathbf{R}(-\\theta)\\,\\mathbf{Z}_{s}\\,\\mathbf{R}(\\theta) \\right] \\mathbf{R}(-\\theta + \\epsilon)\n$$\n使用旋转矩阵的复合性质 $\\mathbf{R}(\\phi_1)\\mathbf{R}(\\phi_2) = \\mathbf{R}(\\phi_1 + \\phi_2)$：\n$$\n\\hat{\\mathbf{Z}}_{s} = \\mathbf{R}(\\theta - \\epsilon - \\theta)\\,\\mathbf{Z}_{s}\\,\\mathbf{R}(\\theta - \\theta + \\epsilon) = \\mathbf{R}(-\\epsilon)\\,\\mathbf{Z}_{s}\\,\\mathbf{R}(\\epsilon)\n$$\n这个结果表明，估计的张量 $\\hat{\\mathbf{Z}}_{s}$ 仅仅是真实的走向张量 $\\mathbf{Z}_{s}$ 经过一个与误差角 $\\epsilon$ 对应的小角度旋转变换得到的。\n\n标准的二维旋转矩阵由下式给出：\n$$\n\\mathbf{R}(\\phi) = \\begin{pmatrix} \\cos\\phi & \\sin\\phi \\\\ -\\sin\\phi & \\cos\\phi \\end{pmatrix}\n$$\n对于小角度 $\\epsilon \\ll 1$（以弧度为单位），我们使用一阶泰勒近似：$\\cos\\epsilon \\approx 1$ 和 $\\sin\\epsilon \\approx \\epsilon$。旋转矩阵变为：\n$$\n\\mathbf{R}(\\epsilon) \\approx \\begin{pmatrix} 1 & \\epsilon \\\\ -\\epsilon & 1 \\end{pmatrix} \\quad \\text{和} \\quad \\mathbf{R}(-\\epsilon) \\approx \\begin{pmatrix} 1 & -\\epsilon \\\\ \\epsilon & 1 \\end{pmatrix}\n$$\n我们现在使用 $\\mathbf{Z}_{s}$ 的给定形式 $\\mathbf{Z}_{s} = \\begin{pmatrix} \\delta_{1} & Z_{1} \\\\ -Z_{2} & \\delta_{2} \\end{pmatrix}$ 来进行矩阵乘法 $\\hat{\\mathbf{Z}}_{s} = \\mathbf{R}(-\\epsilon)\\,\\mathbf{Z}_{s}\\,\\mathbf{R}(\\epsilon)$：\n$$\n\\hat{\\mathbf{Z}}_{s} \\approx \\begin{pmatrix} 1 & -\\epsilon \\\\ \\epsilon & 1 \\end{pmatrix} \\begin{pmatrix} \\delta_{1} & Z_{1} \\\\ -Z_{2} & \\delta_{2} \\end{pmatrix} \\begin{pmatrix} 1 & \\epsilon \\\\ -\\epsilon & 1 \\end{pmatrix}\n$$\n首先，我们计算前两个矩阵的乘积：\n$$\n\\begin{pmatrix} 1 & -\\epsilon \\\\ \\epsilon & 1 \\end{pmatrix} \\begin{pmatrix} \\delta_{1} & Z_{1} \\\\ -Z_{2} & \\delta_{2} \\end{pmatrix} = \\begin{pmatrix} \\delta_{1} + \\epsilon Z_{2} & Z_{1} - \\epsilon \\delta_{2} \\\\ \\epsilon \\delta_{1} - Z_{2} & \\epsilon Z_{1} + \\delta_{2} \\end{pmatrix}\n$$\n接下来，我们将此结果与第三个矩阵相乘：\n$$\n\\hat{\\mathbf{Z}}_{s} \\approx \\begin{pmatrix} \\delta_{1} + \\epsilon Z_{2} & Z_{1} - \\epsilon \\delta_{2} \\\\ \\epsilon \\delta_{1} - Z_{2} & \\epsilon Z_{1} + \\delta_{2} \\end{pmatrix} \\begin{pmatrix} 1 & \\epsilon \\\\ -\\epsilon & 1 \\end{pmatrix}\n$$\n我们感兴趣的是估计的 $Z_{xy}$ 分量，即 $\\hat{\\mathbf{Z}}_{s}$ 的第一行第二列元素，记为 $\\hat{Z}_{xy}$：\n$$\n\\hat{Z}_{xy} \\approx (\\delta_{1} + \\epsilon Z_{2})(\\epsilon) + (Z_{1} - \\epsilon \\delta_{2})(1)\n$$\n展开此表达式：\n$$\n\\hat{Z}_{xy} \\approx \\epsilon \\delta_{1} + \\epsilon^2 Z_{2} + Z_{1} - \\epsilon \\delta_{2}\n$$\n根据问题要求，我们只保留 $\\epsilon$ 的线性项，因此我们舍弃 $\\epsilon^2$ 项：\n$$\n\\hat{Z}_{xy} \\approx Z_{1} + \\epsilon (\\delta_{1} - \\delta_{2})\n$$\n在走向对齐参考系中，该分量的未扰动值为 $Z_{1}$。因此，由不完全旋转引起的变化或修正项 $\\Delta Z_{xy}$ 为：\n$$\n\\Delta Z_{xy} = \\hat{Z}_{xy} - Z_{1} = \\epsilon (\\delta_{1} - \\delta_{2})\n$$\n这是答案的第一部分。对于第二部分，我们为给定的数值计算修正后的估计值 $\\hat{Z}_{xy}$。\n\n给定值为：\n$Z_{1} = (2.0 - 0.5\\,\\mathrm{i}) \\times 10^{2} = 200 - 50\\,\\mathrm{i}$\n$\\delta_{1} = 5 - 2\\,\\mathrm{i}$\n$\\delta_{2} = -3 + 1\\,\\mathrm{i}$\n$\\epsilon = 2^{\\circ}$\n\n首先，将角度误差 $\\epsilon$ 从度数转换为弧度：\n$$\n\\epsilon = 2^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} = \\frac{\\pi}{90} \\text{ 弧度}\n$$\n接下来，计算项 $(\\delta_{1} - \\delta_{2})$：\n$$\n\\delta_{1} - \\delta_{2} = (5 - 2\\,\\mathrm{i}) - (-3 + 1\\,\\mathrm{i}) = (5 + 3) + (-2 - 1)\\,\\mathrm{i} = 8 - 3\\,\\mathrm{i}\n$$\n现在，将这些值代入估计的阻抗分量 $\\hat{Z}_{xy}$ 的表达式中：\n$$\n\\hat{Z}_{xy} = Z_{1} + \\epsilon (\\delta_{1} - \\delta_{2}) = (200 - 50\\,\\mathrm{i}) + \\frac{\\pi}{90}(8 - 3\\,\\mathrm{i})\n$$\n分配项 $\\frac{\\pi}{90}$：\n$$\n\\hat{Z}_{xy} = (200 - 50\\,\\mathrm{i}) + \\frac{8\\pi}{90} - \\frac{3\\pi}{90}\\,\\mathrm{i} = \\left(200 + \\frac{4\\pi}{45}\\right) - \\left(50 + \\frac{\\pi}{30}\\right)\\,\\mathrm{i}\n$$\n现在，我们计算实部和虚部的数值。使用 $\\pi \\approx 3.14159265$：\n$$\n\\text{实部}: \\quad 200 + \\frac{4\\pi}{45} \\approx 200 + \\frac{4 \\times 3.14159265}{45} \\approx 200 + 0.27925268 = 200.27925268\n$$\n$$\n\\text{虚部}: \\quad -\\left(50 + \\frac{\\pi}{30}\\right) \\approx -\\left(50 + \\frac{3.14159265}{30}\\right) \\approx -(50 + 0.104719755) = -50.104719755\n$$\n所以，$\\hat{Z}_{xy} \\approx 200.27925268 - 50.104719755\\,\\mathrm{i}$。\n问题要求将最终的复阻抗四舍五入到四位有效数字。这分别应用于实部和虚部。\n- 实部 $200.279...$ 四舍五入到四位有效数字是 $200.3$。\n- 虚部 $-50.1047...$ 四舍五入到四位有效数字是 $-50.10$。\n\n$Z_{xy}$ 的最终修正估计值为 $200.3 - 50.10\\,\\mathrm{i}$ 欧姆。",
            "answer": "$$\n\\boxed{200.3 - 50.10\\,\\mathrm{i}}\n$$"
        },
        {
            "introduction": "将物理理论转化为可执行的计算机程序是计算地球物理学的核心任务。对于大地电磁正演模拟，这意味着需要构建一个能够准确模拟电磁波在地下传播的离散计算模型。这个练习将指导你完成三维正演模型设计的两个关键步骤：根据趋肤深度确定合适的网格剖分尺寸，以及设计完美匹配层（PML）来吸收边界反射，模拟无限大的地下空间。通过量化PML吸收不完美所导致的阻抗计算误差，你将深入理解数值模拟中计算精度与模型设计之间的权衡关系。",
            "id": "3608939",
            "problem": "您的任务是从第一性原理出发，为大地电磁正演模拟设计一个三维计算网格和一个完美匹配层 (PML)。大地电磁正演模拟遵循时谐场下的麦克斯韦方程组。假设一个电导率恒定的均匀、各向同性半空间。您必须基于以下基本原理进行设计，并计算吸收边界对大地电磁阻抗的定量影响。\n\n基本原理：\n- 在频域中，各向同性线性介质的麦克斯韦方程组为\n$$\\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H}, \\quad \\nabla \\times \\mathbf{H} = \\left(\\sigma + i \\omega \\epsilon\\right) \\mathbf{E},$$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{H}$ 是磁场，$\\omega$ 是角频率，$\\mu$ 是磁导率，$\\sigma$ 是电导率，$\\epsilon$ 是介电常数。\n- 对于均匀半空间，沿 $z$ 方向传播的平面波解具有一个复传播常数\n$$\\gamma = \\alpha + i \\beta = \\sqrt{i \\omega \\mu \\left(\\sigma + i \\omega \\epsilon\\right)},$$\n其中 $\\alpha$ 是衰减常数，$\\beta$ 是相位常数。振幅按 $e^{-\\alpha z}$ 衰减，相位按 $e^{i \\beta z}$ 前进。\n- 趋肤深度定义为\n$$\\delta = \\frac{1}{\\alpha},$$\n在 $\\sigma \\gg \\omega \\epsilon$ 的传导主导区，近似公式\n$$\\delta \\approx \\sqrt{\\frac{2}{\\mu \\sigma \\omega}}$$\n成立。\n- 对于均匀半空间，大地电磁表面阻抗（切向电场与磁场之比）为\n$$Z_{\\text{exact}} = \\sqrt{\\frac{i \\omega \\mu}{\\sigma + i \\omega \\epsilon}}.$$\n\n吸收边界建模：\n- 为了截断计算域，您将附加一个厚度为 $L_{\\text{pml}}$ 的匹配吸收层（完美匹配层 (PML)）。假设PML与内部介质匹配以消除入口界面的反射，并且其有效电导率按比例因子 $s_{\\text{pml}} \\geq 1$ 进行缩放，即 $\\sigma_{\\text{pml}} = s_{\\text{pml}} \\sigma$，同时保持相同的 $\\mu$ 和 $\\epsilon$。PML中的复传播常数为\n$$\\gamma_{\\text{pml}} = \\alpha_{\\text{pml}} + i \\beta_{\\text{pml}} = \\sqrt{i \\omega \\mu \\left(\\sigma_{\\text{pml}} + i \\omega \\epsilon\\right)}.$$\n- PML的远端由一个硬边界终止，该边界使电场产生 $\\pi$ 弧度的相移反射（对于切向电场表现为理想电导体行为）。波无反射地进入PML，传播到硬终止端，反射，然后传播回来。往返振幅衰减因子为\n$$r = e^{-2 \\alpha_{\\text{pml}} L_{\\text{pml}}}.$$\n- 往返相位累积为\n$$\\theta = 2 \\beta_{\\text{pml}} L_{\\text{pml}} + \\pi.$$\n- 前向和后向平面波在观测点叠加。由于相对于电场，后向传播波的磁场符号反转，由残余反射引起的表面受扰动阻抗为\n$$Z_{\\text{num}} = Z_{\\text{exact}} \\, \\frac{1 + r e^{i \\theta}}{1 - r e^{i \\theta}}.$$\n\n设计要求：\n- 使用给定频率下内部介质中的最小趋肤深度来设计网格间距 $h$，遵循以下规则\n$$h = \\frac{\\delta_{\\text{base}}}{N}, \\quad \\delta_{\\text{base}} = \\frac{1}{\\alpha_{\\text{base}}}, \\quad \\alpha_{\\text{base}} = \\Re\\left(\\sqrt{i \\omega \\mu \\left(\\sigma + i \\omega \\epsilon\\right)}\\right),$$\n其中 $N$ 是指定每个趋肤深度分辨率的正整数。使用 $N = 10$。\n- 选择PML厚度 $L_{\\text{pml}}$ 以确保目标反射幅度严格小于 $1\\%$，即 $r \\leq 0.01$。将 $L_{\\text{pml}}$ 推导为 $\\alpha_{\\text{pml}}$ 和目标 $r$ 的函数。使用自然对数。在每个笛卡尔方向的两侧都放置PML。您必须按如下方式计算每个方向上的单元总数\n$$N_x = \\left\\lceil \\frac{L_x}{h} \\right\\rceil + 2 \\left\\lceil \\frac{L_{\\text{pml}}}{h} \\right\\rceil, \\quad N_y = \\left\\lceil \\frac{L_y}{h} \\right\\rceil + 2 \\left\\lceil \\frac{L_{\\text{pml}}}{h} \\right\\rceil, \\quad N_z = \\left\\lceil \\frac{L_z}{h} \\right\\rceil + 2 \\left\\lceil \\frac{L_{\\text{pml}}}{h} \\right\\rceil.$$\n\n量化影响：\n- 计算 $Z_{\\text{exact}}$ 和 $Z_{\\text{num}}$。报告相对幅度误差\n$$\\varepsilon_{\\text{mag}} = \\frac{\\left|\\,|Z_{\\text{num}}| - |Z_{\\text{exact}}|\\,\\right|}{|Z_{\\text{exact}}|},$$\n以及以弧度为单位的绝对相位误差\n$$\\varepsilon_{\\phi} = \\left| \\arg\\left(Z_{\\text{num}}\\right) - \\arg\\left(Z_{\\text{exact}}\\right) \\right|.$$\n\n单位与数值规格：\n- 所有长度必须以米为单位计算和报告。\n- 频率必须以赫兹为单位。\n- 角度必须以弧度为单位。\n- 使用 $\\mu = \\mu_0 = 4 \\pi \\times 10^{-7}$ 亨利/米 和 $\\epsilon = \\epsilon_0 = 8.854187817 \\times 10^{-12}$ 法拉/米。\n- 将最终数值输出表示为浮点数或指定的整数。\n- 网格间距 $h$ 和PML厚度 $L_{\\text{pml}}$ 必须以米为单位报告。\n\n测试套件：\n- 使用以下三个测试用例，每个用例由 $(f, \\sigma, L_x, L_y, L_z, s_{\\text{pml}}, r_{\\text{target}})$ 定义：\n    1. $(1.0, 0.1, 20000.0, 20000.0, 30000.0, 1.0, 0.01)$\n    2. $(10.0, 1.0, 10000.0, 10000.0, 15000.0, 2.0, 0.01)$\n    3. $(0.001, 0.01, 50000.0, 50000.0, 80000.0, 1.0, 0.01)$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。每个测试用例的结果本身必须是按以下顺序排列的列表：\n$$[h, L_{\\text{pml}}, N_x, N_y, N_z, \\Re(Z_{\\text{exact}}), \\Im(Z_{\\text{exact}}), \\Re(Z_{\\text{num}}), \\Im(Z_{\\text{num}}), \\varepsilon_{\\text{mag}}, \\varepsilon_{\\phi}].$$\n- 例如，最终打印的行必须看起来像一个包含三个带括号列表的单一括号列表，其中包含数值条目，并且打印的列表中不显示单位。",
            "solution": "用户提供了一个科学上合理且定义明确的问题。任务是为大地电磁（MT）正演模拟设计计算网格和完美匹配层（PML），并量化由PML边界条件引入的数值误差。所提供的框架基于基础电磁理论。以下解决方案展示了所需参数的推导过程以及计算指定误差指标的步骤。\n\n问题始于频域中线性、各向同性介质的麦克斯韦方程组，其介电常数为 $\\epsilon$，磁导率为 $\\mu$，电导率为 $\\sigma$：\n$$ \\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = (\\sigma + i \\omega \\epsilon) \\mathbf{E} $$\n此处，$\\mathbf{E}$ 和 $\\mathbf{H}$ 分别是电场和磁场的复相量，$\\omega$ 是角频率。\n\n对于在均匀介质中沿 $z$ 方向传播的平面波，场的变化规律为 $e^{-\\gamma z}$，其中 $\\gamma$ 是由下式给出的复传播常数：\n$$ \\gamma = \\sqrt{i \\omega \\mu (\\sigma + i \\omega \\epsilon)} $$\n传播常数分解为其实部和虚部，$\\gamma = \\alpha + i\\beta$，其中 $\\alpha$ 是衰减常数，$\\beta$ 是相位常数。\n\n计算网格和PML的设计过程以及误差分析，按以下步骤进行。\n\n**1. 网格间距设计**\n\n数值模拟的分辨率必须足以精确表示波现象。在大地电磁法（MT）中，这由趋肤深度 $\\delta$决定，即波振幅衰减到 $1/e$ 所经过的距离。它被定义为衰减常数的倒数。对于内部计算域（“基础”介质），衰减常数为：\n$$ \\alpha_{\\text{base}} = \\Re(\\gamma_{\\text{base}}) = \\Re\\left(\\sqrt{i \\omega \\mu (\\sigma + i \\omega \\epsilon)}\\right) $$\n相应的趋膚深度为：\n$$ \\delta_{\\text{base}} = \\frac{1}{\\alpha_{\\text{base}}} $$\n为确保对场的充分采样，网格间距 $h$ 被设置为该趋肤深度的一部分，由一个整数分辨率因子 $N$ 控制。问题指定 $N=10$，从而得出网格间距为：\n$$ h = \\frac{\\delta_{\\text{base}}}{N} $$\n\n**2. 完美匹配层 (PML) 设计**\n\n为了在有限计算网格上模拟无限半空间，需要吸收边界条件来防止来自域边界的非物理反射。问题指定了一个简化的PML模型，其中该层与内部介质匹配（$\\mu$ 和 $\\epsilon$ 相同），但具有一个按比例缩放的电导率，$\\sigma_{\\text{pml}} = s_{\\text{pml}} \\sigma$，其中 $s_{\\text{pml}} \\geq 1$。这增加了PML内部的衰减。\n\nPML内部的传播常数为：\n$$ \\gamma_{\\text{pml}} = \\sqrt{i \\omega \\mu (\\sigma_{\\text{pml}} + i \\omega \\epsilon)} $$\nPML中的衰减常数 $\\alpha_{\\text{pml}} = \\Re(\\gamma_{\\text{pml}})$ 决定了该层的吸收效率。PML由一个理想电导体（PEC）边界终止，该边界反射入射波。波穿过厚度为 $L_{\\text{pml}}$ 的PML，从PEC反射，然后穿回PML。波振幅的总往返衰减由因子 $r = e^{-2 \\alpha_{\\text{pml}} L_{\\text{pml}}}$ 给出。\n\n为了达到期望的吸收水平，我们要求此反射幅度 $r$ 小于或等于目标值 $r_{\\text{target}}$。为了找到所需的最小PML厚度，我们通过设置 $r = r_{\\text{target}}$ 来求解 $L_{\\text{pml}}$：\n$$ r_{\\text{target}} = e^{-2 \\alpha_{\\text{pml}} L_{\\text{pml}}} $$\n对两边取自然对数，得到：\n$$ \\ln(r_{\\text{target}}) = -2 \\alpha_{\\text{pml}} L_{\\text{pml}} $$\n$$ L_{\\text{pml}} = -\\frac{\\ln(r_{\\text{target}})}{2 \\alpha_{\\text{pml}}} $$\n由于 $r_{\\text{target}} < 1$，$\\ln(r_{\\text{target}})$ 为负，确保 $L_{\\text{pml}}$ 为正。\n\n**3. 总网格尺寸**\n\n计算域由一个尺寸为 $L_x \\times L_y \\times L_z$ 的中心感兴趣区域组成，该区域在每个方向的两侧都被厚度为 $L_{\\text{pml}}$ 的PML包围。每个方向上的单元总数通过将中心区域和两个PML区域的单元相加来计算。使用向上取整函数 $\\lceil \\cdot \\rceil$ 确保整个物理域被整数个单元覆盖：\n$$ N_x = \\left\\lceil \\frac{L_x}{h} \\right\\rceil + 2 \\left\\lceil \\frac{L_{\\text{pml}}}{h} \\right\\rceil $$\n$$ N_y = \\left\\lceil \\frac{L_y}{h} \\right\\rceil + 2 \\left\\lceil \\frac{L_{\\text{pml}}}{h} \\right\\rceil $$\n$$ N_z = \\left\\lceil \\frac{L_z}{h} \\right\\rceil + 2 \\left\\lceil \\frac{L_{\\text{pml}}{h}} \\right\\rceil $$\n注意，问题将PML应用于立方体域的所有六个面，包括顶部（$z=0$ 侧）和底部。\n\n**4. 阻抗与误差计算**\n\n在MT中，感兴趣的主要量是表面阻抗 $Z$，即切向电场与切向磁场之比。对于均匀半空间，精确的解析Cagniard阻抗为：\n$$ Z_{\\text{exact}} = \\sqrt{\\frac{i \\omega \\mu}{\\sigma + i \\omega \\epsilon}} $$\n具有不完美吸收边界的有限计算域会引入数值误差。来自PML硬壁终止端的残余反射波与前向波叠加。在表面的叠加给出了一个受扰动的数值阻抗 $Z_{\\text{num}}$。这种扰动是反射幅度 $r$ 和往返相位累积 $\\theta$ 的函数。相位累积包括传播路径和从PEC边界反射时的 $\\pi$ 弧度相移：\n$$ \\theta = 2 \\beta_{\\text{pml}} L_{\\text{pml}} + \\pi $$\n其中 $\\beta_{\\text{pml}} = \\Im(\\gamma_{\\text{pml}})$ 是PML中的相位常数。数值阻抗则由下式给出：\n$$ Z_{\\text{num}} = Z_{\\text{exact}} \\, \\frac{1 + r e^{i \\theta}}{1 - r e^{i \\theta}} $$\n其中我们使用 $r = r_{\\text{target}}$作为最坏情况下的反射幅度。\n\nPML的影响通过比较 $Z_{\\text{num}}$ 和 $Z_{\\text{exact}}$ 的相对幅度误差 $\\varepsilon_{\\text{mag}}$ 和绝对相位误差 $\\varepsilon_{\\phi}$ 来量化：\n$$ \\varepsilon_{\\text{mag}} = \\frac{\\left|\\,|Z_{\\text{num}}| - |Z_{\\text{exact}}|\\,\\right|}{|Z_{\\text{exact}}|} $$\n$$ \\varepsilon_{\\phi} = \\left| \\arg\\left(Z_{\\text{num}}\\right) - \\arg\\left(Z_{\\text{exact}}\\right) \\right| $$\n其中 $|z|$ 表示复数 $z$ 的幅度，$\\arg(z)$ 表示其相位角。\n\n**计算步骤摘要**\n\n对于每个由 $(f, \\sigma, L_x, L_y, L_z, s_{\\text{pml}}, r_{\\text{target}})$ 定义的测试用例：\n1.  设置常数 $\\mu_0 = 4\\pi \\times 10^{-7}$ 和 $\\epsilon_0 = 8.854187817 \\times 10^{-12}$。\n2.  计算角频率 $\\omega = 2\\pi f$。\n3.  计算基础传播常数 $\\gamma_{\\text{base}}$ 和衰减常数 $\\alpha_{\\text{base}}$。\n4.  计算基础趋肤深度 $\\delta_{\\text{base}} = 1/\\alpha_{\\text{base}}$ 和网格间距 $h = \\delta_{\\text{base}}/10$。\n5.  确定PML电导率 $\\sigma_{\\text{pml}}$、传播常数 $\\gamma_{\\text{pml}}$ 和衰减常数 $\\alpha_{\\text{pml}}$。\n6.  使用 $r_{\\text{target}}$ 计算所需的PML厚度 $L_{\\text{pml}}$。\n7.  计算单元总数 $N_x$、$N_y$ 和 $N_z$。\n8.  计算精确阻抗 $Z_{\\text{exact}}$。\n9.  计算往返相移 $\\theta$，并与 $r_{\\text{target}}$ 一起用于找到数值阻抗 $Z_{\\text{num}}$。\n10. 确定误差 $\\varepsilon_{\\text{mag}}$ 和 $\\varepsilon_{\\phi}$。\n11. 整理所需的11个输出值：$h, L_{\\text{pml}}, N_x, N_y, N_z, \\Re(Z_{\\text{exact}}), \\Im(Z_{\\text{exact}}), \\Re(Z_{\\text{num}}), \\Im(Z_{\\text{num}}), \\varepsilon_{\\text{mag}}, \\varepsilon_{\\phi}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes mesh parameters, PML design, and resulting impedance errors for\n    magnetotelluric forward modeling based on the provided problem statement.\n    \"\"\"\n    # Physical constants\n    MU_0 = 4 * np.pi * 1e-7  # Magnetic permeability of free space (H/m)\n    EPS_0 = 8.854187817e-12 # Electric permittivity of free space (F/m)\n    \n    # Design parameters\n    N_RESOLUTION = 10 # Cells per skin depth\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (f, sigma, Lx, Ly, Lz, s_pml, r_target)\n    test_cases = [\n        (1.0, 0.1, 20000.0, 20000.0, 30000.0, 1.0, 0.01),\n        (10.0, 1.0, 10000.0, 10000.0, 15000.0, 2.0, 0.01),\n        (0.001, 0.01, 50000.0, 50000.0, 80000.0, 1.0, 0.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        f, sigma, Lx, Ly, Lz, s_pml, r_target = case\n\n        # 1. Calculate base medium properties and mesh spacing\n        omega = 2 * np.pi * f\n        \n        # Propagation constant in the base medium\n        gamma_base_sq = 1j * omega * MU_0 * (sigma + 1j * omega * EPS_0)\n        gamma_base = np.sqrt(gamma_base_sq)\n        alpha_base = gamma_base.real\n        \n        # Skin depth and mesh spacing\n        delta_base = 1.0 / alpha_base\n        h = delta_base / N_RESOLUTION\n\n        # 2. Design the Perfectly Matched Layer (PML)\n        sigma_pml = s_pml * sigma\n        \n        # Propagation constant in the PML\n        gamma_pml_sq = 1j * omega * MU_0 * (sigma_pml + 1j * omega * EPS_0)\n        gamma_pml = np.sqrt(gamma_pml_sq)\n        alpha_pml = gamma_pml.real\n        beta_pml = gamma_pml.imag\n        \n        # Required PML thickness\n        L_pml = -np.log(r_target) / (2 * alpha_pml)\n\n        # 3. Calculate total number of cells\n        # The number of cells must be an integer.\n        Nx = int(np.ceil(Lx / h) + 2 * np.ceil(L_pml / h))\n        Ny = int(np.ceil(Ly / h) + 2 * np.ceil(L_pml / h))\n        Nz = int(np.ceil(Lz / h) + 2 * np.ceil(L_pml / h))\n        \n        # 4. Calculate impedances\n        # Exact impedance for the homogeneous half-space\n        Z_exact_sq = (1j * omega * MU_0) / (sigma + 1j * omega * EPS_0)\n        Z_exact = np.sqrt(Z_exact_sq)\n\n        # Numerical impedance considering the reflection from the PML boundary\n        r = r_target\n        theta = 2 * beta_pml * L_pml + np.pi\n        \n        # Correction factor due to reflection\n        correction_factor = (1 + r * np.exp(1j * theta)) / (1 - r * np.exp(1j * theta))\n        Z_num = Z_exact * correction_factor\n\n        # 5. Quantify the errors\n        # Relative magnitude error\n        eps_mag = np.abs(np.abs(Z_num) - np.abs(Z_exact)) / np.abs(Z_exact)\n        \n        # Absolute phase error in radians\n        eps_phi = np.abs(np.angle(Z_num) - np.angle(Z_exact))\n\n        # 6. Collate results in the required order\n        case_results = [\n            h, L_pml, Nx, Ny, Nz,\n            Z_exact.real, Z_exact.imag,\n            Z_num.real, Z_num.imag,\n            eps_mag, eps_phi\n        ]\n        results.append(case_results)\n\n    # Format the final output string exactly as required, creating a list of lists.\n    # e.g., [[...],[...],[...]]\n    outer_list_str = []\n    for res_list in results:\n        # Convert each float/int in the inner list to a string\n        inner_list_str_parts = [f\"{x:.12g}\" for x in res_list]\n        # Join them with commas and enclose in brackets\n        inner_list_str = \"[\" + \",\".join(inner_list_str_parts) + \"]\"\n        outer_list_str.append(inner_list_str)\n    \n    final_output = \"[\" + \",\".join(outer_list_str) + \"]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}