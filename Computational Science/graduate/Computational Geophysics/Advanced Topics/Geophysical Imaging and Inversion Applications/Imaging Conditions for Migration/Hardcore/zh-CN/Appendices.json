{
    "hands_on_practices": [
        {
            "introduction": "零延迟互相关是逆时偏移（RTM）中最基础的成像条件。本练习通过一个简化的单色波场景，剖析了这一核心条件的内在机制，旨在揭示成像振幅与源波场和接收点波场之间相位校准的关键关系。理解这种依赖性是掌握更高级成像技术和解决实际偏移难题的第一步。",
            "id": "3603913",
            "problem": "在逆时偏移（RTM, Reverse Time Migration）中，一个常见的成像条件是通过在每个空间位置对震源波场和接收点波场进行零延迟互相关来形成图像。考虑一个固定空间点上的单频场景，其中震源波场和接收点波场在覆盖许多完整周期的足够长的记录时间内被建模为正弦函数。具体来说，设震源和接收点（波场）由以下公式给出：\n$$\ns(\\mathbf{x},t)=A_{s}(\\mathbf{x})\\cos\\!\\big(\\omega t\\big),\\quad r(\\mathbf{x},t)=A_{r}(\\mathbf{x})\\cos\\!\\big(\\omega t+\\phi\\big),\n$$\n其中 $A_{s}(\\mathbf{x})$ 和 $A_{r}(\\mathbf{x})$ 是相对于振荡周期缓慢变化的实数振幅，$\\omega$ 是一个严格为正的角频率，$\\phi$ 是一个恒定的相位差，它编码了在给定位置外推的震源波场和接收点波场之间的运动学不匹配。假设在包含整数个周期的有限窗口 $[0,T]$ 上进行连续时间采集，或在许多周期上以采样间隔 $\\Delta t$ 进行等效的均匀采样离散时间采集。\n\n将在 $\\mathbf{x}$ 处的零延迟互相关成像条件定义为\n$$\nI(\\mathbf{x})=\\int_{0}^{T}s(\\mathbf{x},t)\\,r(\\mathbf{x},t)\\,\\mathrm{d}t,\n$$\n或者，在离散情况下，为记录区间上相应的黎曼和近似。计算 $I(\\mathbf{x})$，结果可以相差一个可能取决于记录时长和采样的比例常数，并用 $A_{s}(\\mathbf{x})$、$A_{r}(\\mathbf{x})$ 和 $\\phi$ 表示的闭式解析表达式来表达您的最终答案。然后，简要解释 $I(\\mathbf{x})$ 如何依赖于相位 $\\phi$。您的最终答案必须仅为所要求的解析表达式，不带单位，也无额外评注。不要四舍五入；不需要进行数值计算。",
            "solution": "该问题陈述经证实具有科学依据、提法恰当且客观。它提供了一个标准的简化模型，用于分析地震成像中的一个基本概念——逆时偏移（RTM）中的零延迟互相关成像条件。所有必要元素都已提供，以得出一个唯一解。\n\n成像条件 $I(\\mathbf{x})$ 由震源波场 $s(\\mathbf{x},t)$ 和接收点波场 $r(\\mathbf{x},t)$ 在时间区间 $[0,T]$ 上的零延迟互相关定义。在一个固定的空间点 $\\mathbf{x}$，这由以下积分给出：\n$$\nI(\\mathbf{x}) = \\int_{0}^{T} s(\\mathbf{x},t) \\, r(\\mathbf{x},t) \\, \\mathrm{d}t\n$$\n问题给出了波场的单频形式：\n$$\ns(\\mathbf{x},t) = A_{s}(\\mathbf{x})\\cos(\\omega t)\n$$\n$$\nr(\\mathbf{x},t) = A_{r}(\\mathbf{x})\\cos(\\omega t + \\phi)\n$$\n其中 $A_{s}(\\mathbf{x})$ 和 $A_{r}(\\mathbf{x})$ 是振幅，$\\omega$ 是角频率，$\\phi$ 是相位差。将这些表达式代入 $I(\\mathbf{x})$ 的积分中，得到：\n$$\nI(\\mathbf{x}) = \\int_{0}^{T} \\left[ A_{s}(\\mathbf{x})\\cos(\\omega t) \\right] \\left[ A_{r}(\\mathbf{x})\\cos(\\omega t + \\phi) \\right] \\mathrm{d}t\n$$\n振幅 $A_{s}(\\mathbf{x})$ 和 $A_{r}(\\mathbf{x})$ 仅是空间坐标 $\\mathbf{x}$ 的函数。由于积分是关于时间 $t$ 的，这些振幅可以被视为常数并移到积分符号外：\n$$\nI(\\mathbf{x}) = A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x}) \\int_{0}^{T} \\cos(\\omega t) \\cos(\\omega t + \\phi) \\, \\mathrm{d}t\n$$\n为了计算该积分，我们使用积化和差三角恒等式 $\\cos(A)\\cos(B) = \\frac{1}{2}[\\cos(A-B) + \\cos(A+B)]$。令 $A = \\omega t$ 和 $B = \\omega t + \\phi$。那么被积函数变为：\n$$\n\\cos(\\omega t) \\cos(\\omega t + \\phi) = \\frac{1}{2} \\left[ \\cos(\\omega t - (\\omega t + \\phi)) + \\cos(\\omega t + (\\omega t + \\phi)) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ \\cos(-\\phi) + \\cos(2\\omega t + \\phi) \\right]\n$$\n由于余弦函数是偶函数，$\\cos(-\\phi) = \\cos(\\phi)$。被积函数简化为：\n$$\n\\frac{1}{2} \\left[ \\cos(\\phi) + \\cos(2\\omega t + \\phi) \\right]\n$$\n现在，我们将此代回 $I(\\mathbf{x})$ 的表达式中：\n$$\nI(\\mathbf{x}) = A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x}) \\int_{0}^{T} \\frac{1}{2} \\left[ \\cos(\\phi) + \\cos(2\\omega t + \\phi) \\right] \\mathrm{d}t\n$$\n我们可以将其分解为两个独立的积分：\n$$\nI(\\mathbf{x}) = \\frac{A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x})}{2} \\left[ \\int_{0}^{T} \\cos(\\phi) \\, \\mathrm{d}t + \\int_{0}^{T} \\cos(2\\omega t + \\phi) \\, \\mathrm{d}t \\right]\n$$\n第一个积分很简单，因为 $\\cos(\\phi)$ 相对于 $t$ 是一个常数：\n$$\n\\int_{0}^{T} \\cos(\\phi) \\, \\mathrm{d}t = \\cos(\\phi) [t]_{0}^{T} = T\\cos(\\phi)\n$$\n第二个积分是：\n$$\n\\int_{0}^{T} \\cos(2\\omega t + \\phi) \\, \\mathrm{d}t = \\left[ \\frac{\\sin(2\\omega t + \\phi)}{2\\omega} \\right]_{0}^{T} = \\frac{1}{2\\omega} \\left[ \\sin(2\\omega T + \\phi) - \\sin(\\phi) \\right]\n$$\n问题陈述指出积分区间 $T$ 包含整数个周期。波的周期是 $T_{p} = \\frac{2\\pi}{\\omega}$。因此，对于某个整数 $n \\ge 1$，有 $T = n T_{p} = n \\frac{2\\pi}{\\omega}$。我们使用这个条件来简化第二个积分的结果。项 $2\\omega T$ 变为：\n$$\n2\\omega T = 2\\omega \\left( n \\frac{2\\pi}{\\omega} \\right) = 4n\\pi\n$$\n由于正弦函数是 $2\\pi$ 周期的，$\\sin(4n\\pi + \\phi) = \\sin(\\phi)$。第二个积分的计算结果为零：\n$$\n\\frac{1}{2\\omega} \\left[ \\sin(4n\\pi + \\phi) - \\sin(\\phi) \\right] = \\frac{1}{2\\omega} \\left[ \\sin(\\phi) - \\sin(\\phi) \\right] = 0\n$$\n这个结果是在一个正弦函数的整数个周期上对其进行积分的结果。函数 $\\cos(2\\omega t + \\phi)$ 的周期是 $\\frac{2\\pi}{2\\omega} = \\frac{\\pi}{\\omega}$。由于 $T = n \\frac{2\\pi}{\\omega}$，它包含了 $2n$ 个 $\\cos(2\\omega t + \\phi)$ 的完整周期，所以它在 $[0,T]$ 上的积分恰好为零。\n\n结合这些结果，$I(\\mathbf{x})$ 的表达式为：\n$$\nI(\\mathbf{x}) = \\frac{A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x})}{2} [T\\cos(\\phi) + 0] = \\frac{T}{2} A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x}) \\cos(\\phi)\n$$\n问题要求结果可以相差一个可能取决于记录时长 $T$ 的比例常数。项 $\\frac{T}{2}$ 就是这样一个常数。因此，成像条件与振幅的乘积以及相位差的余弦成正比：\n$$\nI(\\mathbf{x}) \\propto A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x}) \\cos(\\phi)\n$$\n表示此关系的解析表达式是 $A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x}) \\cos(\\phi)$。\n\n图像 $I(\\mathbf{x})$ 对相位 $\\phi$ 的依赖性至关重要。项 $\\cos(\\phi)$ 充当相干因子。当对于任意整数 $k$ 有 $\\phi = 2k\\pi$ 时，图像达到最大值且为正，这表明震源波场和接收点波场完全同相。在RTM中，这对应于 $\\mathbf{x}$ 很有可能是一个反射体上的点，在该点上，正向传播的震源场和反向传播的接收场在时间上重合。当 $\\phi = \\frac{\\pi}{2} + k\\pi$ 时，图像为零，这意味着两个场处于正交状态（相位相差90度），它们在时间上的相关性为零。当 $\\phi = \\pi + 2k\\pi$ 时，图像的幅度达到最大但为负值，此时两个场完全反相。因此，成像条件选择性地增强了波场发生相长干涉的位置。",
            "answer": "$$\n\\boxed{A_{s}(\\mathbf{x})A_{r}(\\mathbf{x})\\cos(\\phi)}\n$$"
        },
        {
            "introduction": "正如上一个练习所揭示的，标准互相关成像对相位误差极为敏感，而这些误差（如周波跳跃）在实际偏移中普遍存在，可能导致成像质量严重下降甚至完全失效。本练习引入了一种基于包络的互相关成像条件，它对相位误差具有稳健性，旨在保证反射体位置的准确性。通过这个练习，你将深入探究这种高级方法在保持位置精度和引入振幅畸变之间的权衡。",
            "id": "3603872",
            "problem": "考虑在恒定密度介质中使用零时差的基于相关的成像条件进行声学偏移成像。在一个试验像点 $\\mathbf{x}$ 和时间 $t$ 处，设模拟的震源波场为 $u_{s}(\\mathbf{x},t)$，反向传播的接收点波场为 $u_{r}(\\mathbf{x},t)$。假设在真实位置 $\\mathbf{x}^{\\star}$ 处有一个单一孤立的镜面反射体，以及一个具有缓变包络的带限震源子波。使用以下广泛接受的模拟假设：到时附近的局部波场可以很好地被一个窄带调幅余弦所近似，\n$$\nu_{s}(\\mathbf{x},t) \\approx A_{s}(\\mathbf{x})\\,a\\!\\left(t-\\tau_{s}(\\mathbf{x})\\right)\\cos\\!\\left(\\omega_{0}\\left[t-\\tau_{s}(\\mathbf{x})\\right]\\right),\n$$\n$$\nu_{r}(\\mathbf{x},t) \\approx A_{r}(\\mathbf{x})\\,a\\!\\left(t-\\tau_{r}(\\mathbf{x})\\right)\\cos\\!\\left(\\omega_{0}\\left[t-\\tau_{r}(\\mathbf{x})\\right]+\\delta\\right),\n$$\n其中 $A_{s}(\\mathbf{x})$ 和 $A_{r}(\\mathbf{x})$ 是平滑振幅因子，$a(t)$ 是一个相对于载波 $\\omega_{0}$ 的实、偶、单峰的缓变包络，$\\tau_{s}(\\mathbf{x})$ 和 $\\tau_{r}(\\mathbf{x})$ 是平滑的运动学走时场，而 $\\delta$ 是一个捕捉周波跳跃的恒定子波间相位误差。定义实信号 $u(t)$ 的解析信号为 $z(t)=u(t)+i\\,\\mathcal{H}[u](t)$，其中 $\\mathcal{H}$ 表示希尔伯特变换，并定义其包络为 $e(t)=|z(t)|$。\n\n零时差下的常规互相关成像条件是\n$$\nC(\\mathbf{x})=\\int_{-\\infty}^{\\infty} u_{s}(\\mathbf{x},t)\\,u_{r}(\\mathbf{x},t)\\,dt,\n$$\n而基于包络的成像条件是\n$$\nI(\\mathbf{x})=\\int_{-\\infty}^{\\infty} e_{s}(\\mathbf{x},t)\\,e_{r}(\\mathbf{x},t)\\,dt,\n$$\n其中 $e_{s}$ 和 $e_{r}$ 分别是 $u_{s}$ 和 $u_{r}$ 的包络。\n\n任务：\n1) 从解析信号定义和窄带调幅假设出发，证明在窄带近似的主阶上，$e_{s}(\\mathbf{x},t)\\approx A_{s}(\\mathbf{x})\\,a\\!\\left(t-\\tau_{s}(\\mathbf{x})\\right)$ 和 $e_{r}(\\mathbf{x},t)\\approx A_{r}(\\mathbf{x})\\,a\\!\\left(t-\\tau_{r}(\\mathbf{x})\\right)$，且与相位偏移 $\\delta$ 无关。利用此结果，用 $a(t)$ 的自相关表示 $I(\\mathbf{x})$，并陈述确保 $I(\\mathbf{x})$ 在运动学对齐 $\\tau_{s}(\\mathbf{x})=\\tau_{r}(\\mathbf{x})$ 时达到唯一最大值的关于 $a(t)$ 的充分条件。简要解释为什么这意味着即使在存在相位误差 $\\delta$ 的情况下，反射体位置也能得以保留。\n2) 在真实反射体位置处精确运动学对齐（即 $\\tau_{s}(\\mathbf{x}^{\\star})=\\tau_{r}(\\mathbf{x}^{\\star})$）的条件下，并假设 $A_{s}(\\mathbf{x})$ 和 $A_{r}(\\mathbf{x})$ 在 $a(t)$ 的支集上近似为常数，通过忽略相对于缓变积分的快速振荡积分来渐近地评估 $I(\\mathbf{x}^{\\star})$ 和 $C(\\mathbf{x}^{\\star})$。然后，推导无量纲振幅比 $R(\\delta)=\\frac{I(\\mathbf{x}^{\\star})}{C(\\mathbf{x}^{\\star})}$ 作为恒定相位误差 $\\delta$ 的函数的闭合形式表达式。解释为什么这量化了基于包络的成像的振幅畸变。\n\n将最终答案表示为 $R(\\delta)$ 的一个无单位的闭合形式解析表达式。无需进行数值四舍五入。",
            "solution": "在进行解答之前，对问题陈述进行了严格验证。\n\n### 步骤1：提取已知条件\n- 模拟的震源波场：$u_{s}(\\mathbf{x},t) \\approx A_{s}(\\mathbf{x})\\,a\\!\\left(t-\\tau_{s}(\\mathbf{x})\\right)\\cos\\!\\left(\\omega_{0}\\left[t-\\tau_{s}(\\mathbf{x})\\right]\\right)$\n- 模拟的反向传播接收点波场：$u_{r}(\\mathbf{x},t) \\approx A_{r}(\\mathbf{x})\\,a\\!\\left(t-\\tau_{r}(\\mathbf{x})\\right)\\cos\\!\\left(\\omega_{0}\\left[t-\\tau_{r}(\\mathbf{x})\\right]+\\delta\\right)$\n- $A_{s}(\\mathbf{x})$, $A_{r}(\\mathbf{x})$：平滑振幅因子。\n- $a(t)$：相对于载波频率 $\\omega_{0}$ 的实、偶、单峰的缓变包络。\n- $\\tau_{s}(\\mathbf{x})$, $\\tau_{r}(\\mathbf{x})$：平滑的运动学走时场。\n- $\\delta$：恒定的子波间相位误差。\n- $\\mathbf{x}^{\\star}$：单一孤立镜面反射体的真实位置。\n- 实信号 $u(t)$ 的解析信号：$z(t)=u(t)+i\\,\\mathcal{H}[u](t)$，其中 $\\mathcal{H}$ 是希尔伯特变换。\n- 信号 $u(t)$ 的包络：$e(t)=|z(t)|$。\n- 常规互相关成像条件：$C(\\mathbf{x})=\\int_{-\\infty}^{\\infty} u_{s}(\\mathbf{x},t)\\,u_{r}(\\mathbf{x},t)\\,dt$。\n- 基于包络的成像条件：$I(\\mathbf{x})=\\int_{-\\infty}^{\\infty} e_{s}(\\mathbf{x},t)\\,e_{r}(\\mathbf{x},t)\\,dt$。\n- 真实反射体处的条件：$\\tau_{s}(\\mathbf{x}^{\\star})=\\tau_{r}(\\mathbf{x}^{\\star})$。\n- 任务2的假设：$A_{s}(\\mathbf{x})$ 和 $A_{r}(\\mathbf{x})$ 在 $a(t)$ 的支集上近似为常数。\n- 渐近评估规则：忽略相对于缓变积分的快速振荡积分。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题设置在地震偏移和成像的既定框架内，这是计算地球物理学的一个核心学科。波场模型、解析信号的使用、希尔伯特变换以及基于相关的成像条件都是信号处理和波理论中的标准且有充分依据的概念。\n- **适定性**：问题陈述清晰，提供了所有必要的定义和假设。任务具体，并基于给定的模型导向一个唯一且有意义的解。\n- **客观性**：问题使用精确的数学和物理语言表述，没有任何歧义或主观论断。\n- 该问题是自洽、一致且科学上合理的。未发现任何缺陷。\n\n### 步骤3：结论和行动\n问题有效。将提供详细的解答。\n\n### 解答推导\n\n**任务1：基于包络的成像条件分析**\n\n首先，我们推导包络 $e_{s}(\\mathbf{x},t)$ 和 $e_{r}(\\mathbf{x},t)$ 的近似表达式。实函数 $u(t)$ 的解析信号为 $z(t) = u(t) + i\\mathcal{H}[u](t)$，其中 $\\mathcal{H}$ 是希尔伯特变换。\n\n对于震源波场 $u_{s}(\\mathbf{x},t)$，我们定义一个平移的时间变量 $t' = t-\\tau_{s}(\\mathbf{x})$，为简化记法，我们将缓变振幅部分表示为 $f_{s}(t') = A_{s}(\\mathbf{x})a(t')$。于是波场为 $u_{s}(\\mathbf{x},t) \\approx f_{s}(t') \\cos(\\omega_{0}t')$。其解析信号为 $z_{s}(\\mathbf{x},t) \\approx f_{s}(t')\\cos(\\omega_{0}t') + i\\mathcal{H}[f_{s}(t')\\cos(\\omega_{0}t')]$。\n\n$a(t)$ 是“相对于载波 $\\omega_0$ 的缓变包络”这一假设意味着 $f_{s}(t')$ 的傅里叶谱集中在远低于 $\\omega_0$ 的低频区域。在此条件下（Bedrosian 定理的一个推论），乘积的希尔伯特变换可以近似为 $\\mathcal{H}[f_{s}(t')\\cos(\\omega_{0}t')] \\approx f_{s}(t')\\mathcal{H}[\\cos(\\omega_{0}t')]$。由于 $\\mathcal{H}[\\cos(\\omega t)] = \\sin(\\omega t)$，我们有 $\\mathcal{H}[f_{s}(t')\\cos(\\omega_{0}t')] \\approx f_{s}(t')\\sin(\\omega_{0}t')$。\n\n将此代入解析信号表达式：\n$$\nz_{s}(\\mathbf{x},t) \\approx f_{s}(t')\\cos(\\omega_{0}t') + i f_{s}(t')\\sin(\\omega_{0}t') = f_{s}(t') \\exp(i\\omega_{0}t')\n$$\n包络 $e_{s}(\\mathbf{x},t)$ 是解析信号的模：\n$$\ne_{s}(\\mathbf{x},t) = |z_{s}(\\mathbf{x},t)| \\approx |f_{s}(t') \\exp(i\\omega_{0}t')| = |f_{s}(t')| |\\exp(i\\omega_{0}t')| = |f_{s}(t')|\n$$\n由于 $A_{s}(\\mathbf{x})$ 是一个正振幅且 $a(t)$ 是一个非负包络脉冲，所以 $|f_{s}(t')| = f_{s}(t')$。重新代入原始变量，我们得到：\n$$\ne_{s}(\\mathbf{x},t) \\approx A_{s}(\\mathbf{x}) a(t-\\tau_{s}(\\mathbf{x}))\n$$\n该推导在窄带近似的主阶上成立。\n\n现在我们对接收点波场 $u_{r}(\\mathbf{x},t)$ 重复此过程。设 $t'' = t-\\tau_{r}(\\mathbf{x})$ 且 $f_{r}(t'') = A_{r}(\\mathbf{x})a(t'')$。波场为 $u_{r}(\\mathbf{x},t) \\approx f_{r}(t'') \\cos(\\omega_{0}t''+\\delta)$。\n使用相同的窄带近似：\n$$\n\\mathcal{H}[f_{r}(t'') \\cos(\\omega_{0}t''+\\delta)] \\approx f_{r}(t'') \\mathcal{H}[\\cos(\\omega_{0}t''+\\delta)] = f_{r}(t'') \\sin(\\omega_{0}t''+\\delta)\n$$\n接收点波场的解析信号为：\n$$\nz_{r}(\\mathbf{x},t) \\approx f_{r}(t'')\\cos(\\omega_{0}t''+\\delta) + i f_{r}(t'')\\sin(\\omega_{0}t''+\\delta) = f_{r}(t'') \\exp(i(\\omega_{0}t''+\\delta))\n$$\n包络 $e_{r}(\\mathbf{x},t)$ 是其模：\n$$\ne_{r}(\\mathbf{x},t) = |z_{r}(\\mathbf{x},t)| \\approx |f_{r}(t'') \\exp(i(\\omega_{0}t''+\\delta))| = |f_{r}(t'')| |\\exp(i(\\omega_{0}t''+\\delta))| = |f_{r}(t'')|\n$$\n这一步至关重要，因为相位项 $\\exp(i\\delta)$ 的模为1并消失了。因此，包络与相位误差 $\\delta$ 无关。同理，$|f_{r}(t'')|=f_{r}(t'')$，所以：\n$$\ne_{r}(\\mathbf{x},t) \\approx A_{r}(\\mathbf{x}) a(t-\\tau_{r}(\\mathbf{x}))\n$$\n现在我们可以表示基于包络的成像条件 $I(\\mathbf{x})$：\n$$\nI(\\mathbf{x}) = \\int_{-\\infty}^{\\infty} e_{s}(\\mathbf{x},t) e_{r}(\\mathbf{x},t) dt \\approx \\int_{-\\infty}^{\\infty} \\left[ A_{s}(\\mathbf{x}) a(t - \\tau_{s}(\\mathbf{x})) \\right] \\left[ A_{r}(\\mathbf{x}) a(t - \\tau_{r}(\\mathbf{x})) \\right] dt\n$$\n$$\nI(\\mathbf{x}) \\approx A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x}) \\int_{-\\infty}^{\\infty} a(t - \\tau_{s}(\\mathbf{x})) a(t - \\tau_{r}(\\mathbf{x})) dt\n$$\n该积分表示 $a(t)$ 与自身的互相关。我们将 $a(t)$ 的自相关定义为 $R_{aa}(\\tau) = \\int_{-\\infty}^{\\infty} a(t) a(t+\\tau) dt$。通过变量替换 $t' = t - \\tau_s(\\mathbf{x})$，该积分变为 $\\int_{-\\infty}^{\\infty} a(t') a(t' + \\tau_s(\\mathbf{x}) - \\tau_r(\\mathbf{x})) dt'$，即 $R_{aa}(\\tau_s(\\mathbf{x}) - \\tau_r(\\mathbf{x}))$。所以，\n$$\nI(\\mathbf{x}) \\approx A_{s}(\\mathbf{x}) A_{r}(\\mathbf{x}) R_{aa}(\\tau_s(\\mathbf{x}) - \\tau_r(\\mathbf{x}))\n$$\n为使 $I(\\mathbf{x})$ 在运动学对齐 $\\tau_s(\\mathbf{x}) = \\tau_r(\\mathbf{x})$ 时达到唯一最大值，项 $R_{aa}(\\tau_s(\\mathbf{x}) - \\tau_r(\\mathbf{x}))$ 必须在其参数为零时有唯一最大值。根据柯西-施瓦茨不等式，自相关 $R_{aa}(\\tau)$ 总是在 $\\tau=0$ 处取得全局最大值。确保该最大值唯一的关于 $a(t)$ 的充分条件是 $a(t)$ 是平方可积的，即 $\\int a(t)^2 dt  \\infty$，并且它不是周期性的。给定的 $a(t)$ 是实、偶、单峰脉冲的性质，在实践中通常足以保证其自相关函数也是单峰的，并在零时差处有唯一最大值。\n\n这个结果意味着，通过最大化 $I(\\mathbf{x})$ 确定的反射体位置，即使在存在相位误差 $\\delta$ 的情况下也能得以保留。$I(\\mathbf{x})$ 的最大值位置取决于条件 $\\tau_{s}(\\mathbf{x}) = \\tau_{r}(\\mathbf{x})$，这对应于反射体的运动学定义。由于我们的推导表明 $I(\\mathbf{x})$ 与 $\\delta$ 无关，相位误差不会移动或降低成像反射体的位置，从而确保其位置的准确性。\n\n**任务2：反射体处的振幅比**\n\n我们现在在真实反射体位置 $\\mathbf{x}^{\\star}$ 处评估 $I(\\mathbf{x}^{\\star})$ 和 $C(\\mathbf{x}^{\\star})$，在该位置运动学对齐条件 $\\tau_{s}(\\mathbf{x}^{\\star}) = \\tau_{r}(\\mathbf{x}^{\\star})$ 成立。我们将这个共同的走时记为 $\\tau^{\\star}$。\n\n首先，对于 $I(\\mathbf{x}^{\\star})$，我们使用任务1的结果，其中 $\\tau_s(\\mathbf{x}^{\\star}) - \\tau_r(\\mathbf{x}^{\\star}) = 0$：\n$$\nI(\\mathbf{x}^{\\star}) \\approx A_{s}(\\mathbf{x}^{\\star}) A_{r}(\\mathbf{x}^{\\star}) R_{aa}(0) = A_{s}(\\mathbf{x}^{\\star}) A_{r}(\\mathbf{x}^{\\star}) \\int_{-\\infty}^{\\infty} a(t)^2 dt\n$$\n接下来，我们评估常规互相关 $C(\\mathbf{x}^{\\star})$：\n$$\nC(\\mathbf{x}^{\\star}) = \\int_{-\\infty}^{\\infty} u_{s}(\\mathbf{x}^{\\star},t) u_{r}(\\mathbf{x}^{\\star},t) dt\n$$\n在 $\\mathbf{x}^{\\star}$ 处代入波场近似值：\n$$\nC(\\mathbf{x}^{\\star}) \\approx \\int_{-\\infty}^{\\infty} \\left[ A_{s}(\\mathbf{x}^{\\star})a(t-\\tau^{\\star})\\cos(\\omega_{0}(t-\\tau^{\\star})) \\right] \\left[ A_{r}(\\mathbf{x}^{\\star})a(t-\\tau^{\\star})\\cos(\\omega_{0}(t-\\tau^{\\star})+\\delta) \\right] dt\n$$\n假设 $A_s$ 和 $A_r$ 在由 $a(t)$ 定义的积分窗口内是常数，我们可以将它们提取出来：\n$$\nC(\\mathbf{x}^{\\star}) \\approx A_{s}(\\mathbf{x}^{\\star}) A_{r}(\\mathbf{x}^{\\star}) \\int_{-\\infty}^{\\infty} a(t-\\tau^{\\star})^2 \\cos(\\omega_{0}(t-\\tau^{\\star})) \\cos(\\omega_{0}(t-\\tau^{\\star})+\\delta) dt\n$$\n设一个新的时间变量为 $t' = t-\\tau^{\\star}$。该积分变为：\n$$\n\\int_{-\\infty}^{\\infty} a(t')^2 \\cos(\\omega_{0}t') \\cos(\\omega_{0}t'+\\delta) dt'\n$$\n使用三角恒等式 $\\cos(A)\\cos(B) = \\frac{1}{2}\\left[\\cos(A-B) + \\cos(A+B)\\right]$：\n$$\n\\cos(\\omega_{0}t') \\cos(\\omega_{0}t'+\\delta) = \\frac{1}{2}\\left[\\cos(-\\delta) + \\cos(2\\omega_{0}t'+\\delta)\\right] = \\frac{1}{2}\\left[\\cos(\\delta) + \\cos(2\\omega_{0}t'+\\delta)\\right]\n$$\n该积分分解为两部分：\n$$\n\\frac{1}{2} \\int_{-\\infty}^{\\infty} a(t')^2 \\cos(\\delta) dt' + \\frac{1}{2} \\int_{-\\infty}^{\\infty} a(t')^2 \\cos(2\\omega_{0}t'+\\delta) dt'\n$$\n第一项是 $\\frac{1}{2}\\cos(\\delta)\\int_{-\\infty}^{\\infty} a(t')^2 dt'$。第二个积分涉及缓变函数 $a(t')^2$ 与快速振荡函数 $\\cos(2\\omega_{0}t'+\\delta)$ 的乘积。根据问题的规则和黎曼-勒贝格引理，对于高载波频率 $\\omega_0$，此积分为可忽略不计。\n因此，我们只剩下第一项：\n$$\nC(\\mathbf{x}^{\\star}) \\approx A_{s}(\\mathbf{x}^{\\star}) A_{r}(\\mathbf{x}^{\\star}) \\frac{\\cos(\\delta)}{2} \\int_{-\\infty}^{\\infty} a(t)^2 dt\n$$\n现在我们可以推导无量纲振幅比 $R(\\delta) = I(\\mathbf{x}^{\\star}) / C(\\mathbf{x}^{\\star})$：\n$$\nR(\\delta) \\approx \\frac{A_{s}(\\mathbf{x}^{\\star}) A_{r}(\\mathbf{x}^{\\star}) \\int_{-\\infty}^{\\infty} a(t)^2 dt}{A_{s}(\\mathbf{x}^{\\star}) A_{r}(\\mathbf{x}^{\\star}) \\frac{\\cos(\\delta)}{2} \\int_{-\\infty}^{\\infty} a(t)^2 dt}\n$$\n除了分母中的因子 $\\frac{\\cos(\\delta)}{2}$ 外，所有项都消掉了，从而得到闭合形式表达式：\n$$\nR(\\delta) = \\frac{2}{\\cos(\\delta)}\n$$\n该比率量化了常规互相关成像中由相位误差引起的振幅畸变。常规成像的振幅 $C(\\mathbf{x}^{\\star})$ 与 $\\cos(\\delta)$ 成正比，这意味着它可能被衰减、消失（对于 $\\delta = \\frac{\\pi}{2} + n\\pi, n \\in \\mathbb{Z}$），甚至其极性也可能反转（对于接近 $\\pi$ 的 $\\delta$）。基于包络的成像振幅 $I(\\mathbf{x}^{\\star})$ 是稳定的，且与 $\\delta$ 无关。比率 $R(\\delta)$ 精确地度量了稳定的包络振幅与畸变的常规振幅之间的比例因子，从而量化了这种畸变。例如，当 $\\delta \\to \\frac{\\pi}{2}$ 时，$R(\\delta) \\to \\infty$，这表明常规图像振幅趋于零，而包络图像振幅保持有限。",
            "answer": "$$\n\\boxed{\\frac{2}{\\cos(\\delta)}}\n$$"
        },
        {
            "introduction": "除了相位误差，另一个严峻的挑战是偏移伪影，它们通常由背向散射能量等非反射事件引起。标准互相关条件可能会错误地将这些噪声成像，从而污染最终结果。本练习将探讨一种基于物理原理的成像条件，该条件利用波场的局部传播方向来区分真实反射和伪影，从而实现对成像过程的滤波。你将需要推导并分析这种基于角度的滤波器的行为及其对成像结果的影响。",
            "id": "3603875",
            "problem": "给定一个具有恒定波速 $c$ 的二维常密度声学介质，要求您为逆时偏移设计并评估一个成像条件，该条件使用基于局部波数矢量点积的极性测试来消除反向散射能量。设震源波场表示为 $u_s(\\mathbf{x},t)$，接收点波场表示为 $u_r(\\mathbf{x},t)$。考虑标准零延迟互相关成像条件 $I_0(\\mathbf{x})=\\int u_s(\\mathbf{x},t)\\,u_r(\\mathbf{x},t)\\,dt$ 和极性测试滤波成像条件\n$$\nI(\\mathbf{x})=\\int \\chi\\Big[(\\mathbf{k}_s(\\mathbf{x},t)\\cdot \\mathbf{k}_r(\\mathbf{x},t))>0\\Big]\\;u_s(\\mathbf{x},t)\\,u_r(\\mathbf{x},t)\\,dt,\n$$\n其中 $\\chi[\\cdot]$ 是指示函数，当其参数为真时为 $1$，否则为 $0$；$\\mathbf{k}_s(\\mathbf{x},t)$ 和 $\\mathbf{k}_r(\\mathbf{x},t)$ 分别是震源波场和接收点波场的局部波数矢量，通过局相位梯度定义。\n\n假设一个均匀介质，在 $z=0$ 的自由表面下方深度 $z>0$ 处有一个水平反射体，一个点源位于表面坐标 $x=-H/2$ 处，一个接收点位于表面坐标 $x=+H/2$ 处，其中 $H\\ge 0$ 是炮检距。在这些假设下，设成像点为镜面反射点 $(x=0,z)$。对于每个测试用例，假设在成像点，震源波场和反向传播的接收点波场是窄带单色信号，具有相等的角频率 $\\omega=2\\pi f$ 和相对相位 $\\phi$，即\n$$\nu_s(\\mathbf{x},t)=\\cos(\\omega t),\\qquad u_r(\\mathbf{x},t)=\\cos(\\omega t+\\phi),\n$$\n并且成像积分在 $N$ 个完整周期上进行计算，即 $t\\in[0,NT]$，其中 $T=2\\pi/\\omega$ 且整数 $N\\ge 1$。角度必须以弧度为单位。距离必须以米为单位。频率必须以赫兹为单位。时间必须以秒为单位。\n\n您的任务是：\n- 从声波方程和标准零延迟成像条件的定义出发，通过比较由 $\\mathbf{k}_s(\\mathbf{x},t)$ 和 $\\mathbf{k}_r(\\mathbf{x},t)$ 编码的局部传播方向，论证极性测试滤波成像条件作为一种反向散射压制机制的合理性。\n- 对于所述的均匀、水平分层几何结构，从第一性原理出发，推导出成像点 $(x=0,z)$ 处 $\\mathbf{k}_s$ 和 $\\mathbf{k}_r$ 的单位方向矢量（用 $z$ 和 $H$ 表示），并用 $z$ 和 $H$ 表示它们的点积。\n- 使用以上结果，确定使 $\\chi[(\\mathbf{k}_s\\cdot\\mathbf{k}_r)>0]$ 等于 $1$ 的关于 $z$ 和 $H$ 的条件，并分析其对 $z$ 相对于 $H$ 较小的浅层反射体的影响。\n- 对于指定的单色信号，计算 $I(\\mathbf{x})$ 在 $N$ 个完整周期上的积分，并报告由下式定义的归一化滤波成像振幅：\n$$\nA=\\frac{I(\\mathbf{x})}{(NT)/2},\n$$\n该振幅是极性测试和相位 $\\phi$ 的函数。请注意，在给定假设下，$A$ 是无量纲的，并且仅取决于指示函数的结果和 $\\phi$。\n\n实现一个程序，为以下测试套件计算每个用例的 $A$ 值，结果为单个浮点数：\n- 用例 1（理想情况，深层反射体）：一次反射几何， $z=1000\\,\\text{m}$, $H=1000\\,\\text{m}$, $f=10\\,\\text{Hz}$, $N=10$, $\\phi=0\\,\\text{rad}$。\n- 用例 2（浅层反射体，大炮检距）：一次反射几何， $z=100\\,\\text{m}$, $H=1000\\,\\text{m}$, $f=10\\,\\text{Hz}$, $N=10$, $\\phi=0\\,\\text{rad}$。\n- 用例 3（边界条件）：一次反射几何， $z=250\\,\\text{m}$, $H=500\\,\\text{m}$, $f=10\\,\\text{Hz}$, $N=10$, $\\phi=0\\,\\text{rad}$。\n- 用例 4（零炮检距）：一次反射几何， $z=500\\,\\text{m}$, $H=0\\,\\text{m}$, $f=10\\,\\text{Hz}$, $N=10$, $\\phi=0\\,\\text{rad}$。\n- 用例 5（显式反向散射抑制）：在成像点处的非镜面反射、反向散射对，具有相反的垂直极性（模型化为 $\\mathbf{k}_s$ 垂直向下传播，$\\mathbf{k}_r$ 垂直向上传播），$z=500\\,\\text{m}$, $H=500\\,\\text{m}$, $f=10\\,\\text{Hz}$, $N=10$, $\\phi=0\\,\\text{rad}$。\n- 用例 6（相位敏感性）：与用例 1 相同，但 $\\phi=\\pi\\,\\text{rad}$。\n\n您的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如, $[a_1,a_2,\\dots]$），其中每个条目是按上述顺序列出的相应案例的 $A$ 计算值。$A$ 的值必须报告为浮点数（无量纲）。角度输入和输出必须使用弧度。距离必须以米为单位。频率必须以赫兹为单位。时间必须以秒为单位。不应打印任何其他文本。",
            "solution": "该问题是有效的，因为它科学地基于波传播和地震成像的原理，问题陈述清晰且提供了所有必要信息，并以客观、正式的语言表达。我们可以进行完整的解答。\n\n解答分为四个部分，对应于问题陈述中列出的任务。\n\n### 1. 极性测试滤波器的合理性论证\n\n常密度声波方程控制着震源波场 $u_s(\\mathbf{x},t)$ 和接收点波场 $u_r(\\mathbf{x},t)$ 的传播。在均匀介质中，解可以表示为形如 $\\exp[i(\\mathbf{k}\\cdot\\mathbf{x} - \\omega t)]$ 的平面波的叠加。这种波的相位是 $\\Phi(\\mathbf{x},t) = \\mathbf{k}\\cdot\\mathbf{x} - \\omega t$。局部波数矢量 $\\mathbf{k}$ 定义为相位的空间梯度，即 $\\mathbf{k} = \\nabla\\Phi$，它指向波的传播方向。其大小通过频散关系 $|\\mathbf{k}| = \\omega/c$ 与角频率 $\\omega$ 和介质波速 $c$ 相关联。\n\n地震成像的基本原理，通常称为成像原理，指出在地下某点，当一个下行波转换为一个上行波时，该点存在一个反射体。逆时偏移 (RTM) 通过将正向传播的震源波场 $u_s$ 与时间反转、反向传播的接收点波场 $u_r$ 进行互相关来实现这一原理。\n\n- 震源波场 $u_s(\\mathbf{x},t)$ 从震源正向时间传播。在反射体处，它是一个下行波（在典型的地表观测几何中）。因此，其局部波数矢量 $\\mathbf{k}_s$ 将有一个指向深度增加方向的分量。\n- 接收点波场 $u_r(\\mathbf{x},t)$ 是由向上反射的波在地表记录下来的。在 RTM 中，这个记录的场被用作边界条件并进行时间反向传播。一个物理上的上行波在时间上反向传播会变成一个下行波。因此，在反射体处，反向传播的接收点波场也是一个下行波，其局部波数矢量 $\\mathbf{k}_r$ 也指向深度增加的方向。\n\n对于一次反射，成像点处的 $\\mathbf{k}_s$ 和 $\\mathbf{k}_r$ 都代表下行波场，因此指向相似的方向（即，进入同一个广义半空间）。它们之间的夹角是锐角，这意味着它们的点积为正：$\\mathbf{k}_s \\cdot \\mathbf{k}_r > 0$。\n\n相反，偏移假象可能源于在成像点不对应于一次反射事件的波的互相关。这类假象的一个常见来源是，一个下行波与一个恰好同时穿过同一点的上行波发生相关。在这种情况下，$\\mathbf{k}_s$ 会指向下方，而波场中物理上是上行的部分的传播矢量会指向上方。RTM 算法将 `u_s` 与时间反转的 `u_r` 进行相关，但局部传播方向矢量 $\\mathbf{k}_r$ 通常是根据其自身传播时间线上的时间反转场计算的。如果这对应一个物理上的上行波，其方向矢量将与下行震源波的方向相反。因此，$\\mathbf{k}_s$ 和 $\\mathbf{k}_r$ 将指向相反的方向，从而产生负的点积：$\\mathbf{k}_s \\cdot \\mathbf{k}_r < 0$。\n\n指示函数 $\\chi[(\\mathbf{k}_s \\cdot \\mathbf{k}_r) > 0]$ 充当一个滤波器。它保留了传播方向相似的波场（反射的特征）对图像的贡献，并压制了传播方向相反的波场（偏移假象的特征）的贡献。该方法是实现角度域成像条件的一种方式，能有效消除由伪相关引起的反向散射噪声和其他假象。\n\n### 2. 单位方向矢量及其点积的推导\n\n几何结构包括一个位于 $\\mathbf{x}_s = (-H/2, 0)$ 的震源，一个位于 $\\mathbf{x}_r = (H/2, 0)$ 的接收点，以及一个位于 $\\mathbf{x} = (0, z)$ 的成像点。介质是均匀的。\n\n震源波场从震源 $\\mathbf{x}_s$ 传播到成像点 $\\mathbf{x}$。其传播方向由矢量 $\\vec{v}_s = \\mathbf{x} - \\mathbf{x}_s = (0 - (-H/2), z - 0) = (H/2, z)$ 给出。单位方向矢量 $\\hat{\\mathbf{k}}_s$ 是：\n$$\n\\hat{\\mathbf{k}}_s = \\frac{\\vec{v}_s}{|\\vec{v}_s|} = \\frac{(H/2, z)}{\\sqrt{(H/2)^2 + z^2}}\n$$\n接收点波场从接收点 $\\mathbf{x}_r$ 反向传播到成像点 $\\mathbf{x}$。这个反向传播场的传播方向由矢量 $\\vec{v}_r = \\mathbf{x} - \\mathbf{x}_r = (0 - H/2, z - 0) = (-H/2, z)$ 给出。单位方向矢量 $\\hat{\\mathbf{k}}_r$ 是：\n$$\n\\hat{\\mathbf{k}}_r = \\frac{\\vec{v}_r}{|\\vec{v}_r|} = \\frac{(-H/2, z)}{\\sqrt{(-H/2)^2 + z^2}}\n$$\n这些单位方向矢量的点积是：\n$$\n\\hat{\\mathbf{k}}_s \\cdot \\hat{\\mathbf{k}}_r = \\frac{(H/2, z) \\cdot (-H/2, z)}{(\\sqrt{(H/2)^2 + z^2})^2} = \\frac{(H/2)(-H/2) + z \\cdot z}{(H/2)^2 + z^2} = \\frac{z^2 - H^2/4}{z^2 + H^2/4}\n$$\n局部波数矢量为 $\\mathbf{k}_s = |\\mathbf{k}_s|\\hat{\\mathbf{k}}_s$ 和 $\\mathbf{k}_r = |\\mathbf{k}_r|\\hat{\\mathbf{k}}_r$。由于波场在恒定速度 $c$ 的介质中是具有相同频率 $\\omega$ 的单色波，它们的波数大小相等：$|\\mathbf{k}_s| = |\\mathbf{k}_r| = \\omega/c$。\n因此，它们的点积是：\n$$\n\\mathbf{k}_s \\cdot \\mathbf{k}_r = \\left(\\frac{\\omega}{c}\\right)^2 (\\hat{\\mathbf{k}}_s \\cdot \\hat{\\mathbf{k}}_r) = \\left(\\frac{\\omega}{c}\\right)^2 \\frac{z^2 - H^2/4}{z^2 + H^2/4}\n$$\n\n### 3. 极性测试的条件及其影响\n\n极性测试条件是 $(\\mathbf{k}_s \\cdot \\mathbf{k}_r) > 0$。根据上面推导的表达式，项 $(\\omega/c)^2$ 是严格为正的，并且对于任何物理配置（$z>0$），分母 $(z^2 + H^2/4)$ 也是严格为正的。因此，点积的符号仅由分子决定：\n$$\nz^2 - \\frac{H^2}{4} > 0\n$$\n这个不等式可以重排为 $z^2 > H^2/4$。由于深度 $z$ 和炮检距 $H$ 是非负的，这等价于：\n$$\nz > \\frac{H}{2}\n$$\n指示函数 $\\chi[(\\mathbf{k}_s\\cdot \\mathbf{k}_r)>0]$ 在 $z > H/2$ 时等于 $1$，否则等于 $0$。\n\n这个条件对成像有重要影响，特别是对浅层反射体。成像点处相对于垂直方向的反射角 $\\theta$ 由 $\\tan(\\theta) = (H/2)/z$ 给出。条件 $z > H/2$ 等价于 $(H/2)/z < 1$，这意味着 $\\tan(\\theta) < 1$，即 $\\theta < \\pi/4$ ($45^\\circ$)。\n\n对于相对于炮检距（大 $H$）而言的浅层反射体（小 $z$），有可能出现 $z \\le H/2$ 的情况。在这种情况下，反射角很大（$\\theta \\ge 45^\\circ$），点积变为非正值，指示函数计算结果为 $0$。极性测试充当一个大角度滤波器或“切除”，自动将来自大角度反射的贡献置零。这有助于防止与折返波和假频相关的成像假象（这些假象在大角度时更普遍），但它也可能导致在使用长炮检距数据时浅层剖面图像信息的损失。\n\n### 4. 归一化成像振幅的计算\n\n滤波成像条件由下式给出：\n$$\nI(\\mathbf{x})=\\int_0^{NT} \\chi\\Big[(\\mathbf{k}_s(\\mathbf{x},t)\\cdot \\mathbf{k}_r(\\mathbf{x},t))>0\\Big]\\;u_s(\\mathbf{x},t)\\,u_r(\\mathbf{x},t)\\,dt\n$$\n对于给定的成像点几何结构 $(z, H)$，指示函数 $\\chi$ 的值在整个积分时间内是恒定的。波场由 $u_s(\\mathbf{x},t)=\\cos(\\omega t)$ 和 $u_r(\\mathbf{x},t)=\\cos(\\omega t+\\phi)$ 给出。\n$$\nI(\\mathbf{x}) = \\chi \\int_0^{NT} \\cos(\\omega t) \\cos(\\omega t+\\phi) \\,dt\n$$\n使用积化和差三角恒等式 $\\cos A \\cos B = \\frac{1}{2}[\\cos(A-B) + \\cos(A+B)]$，被积函数变为：\n$$\n\\cos(\\omega t) \\cos(\\omega t+\\phi) = \\frac{1}{2}[\\cos(-\\phi) + \\cos(2\\omega t + \\phi)] = \\frac{1}{2}[\\cos(\\phi) + \\cos(2\\omega t + \\phi)]\n$$\n积分为：\n$$\nI(\\mathbf{x}) = \\frac{\\chi}{2} \\int_0^{NT} [\\cos(\\phi) + \\cos(2\\omega t + \\phi)] \\,dt = \\frac{\\chi}{2} \\left[ t\\cos(\\phi) + \\frac{1}{2\\omega}\\sin(2\\omega t + \\phi) \\right]_0^{NT}\n$$\n计算在积分上下限的值，注意到 $T=2\\pi/\\omega$，所以 $\\omega T = 2\\pi$：\n$$\nI(\\mathbf{x}) = \\frac{\\chi}{2} \\left\\{ \\left( NT\\cos(\\phi) + \\frac{1}{2\\omega}\\sin(2\\omega NT + \\phi) \\right) - \\left( 0 + \\frac{1}{2\\omega}\\sin(\\phi) \\right) \\right\\}\n$$\n项 $2\\omega NT = 2(2\\pi/T) NT = 4\\pi N$。由于 $\\sin$ 函数是 $2\\pi$ 周期的，且 $N$ 是整数，所以 $\\sin(4\\pi N + \\phi) = \\sin(\\phi)$。正弦项相互抵消。\n$$\nI(\\mathbf{x}) = \\frac{\\chi}{2} (NT \\cos(\\phi)) = \\chi \\left( \\frac{NT}{2} \\right) \\cos(\\phi)\n$$\n归一化滤波成像振幅 $A$ 定义为 $A = I(\\mathbf{x}) / (NT/2)$。\n$$\nA = \\frac{\\chi \\left( \\frac{NT}{2} \\right) \\cos(\\phi)}{ \\frac{NT}{2} } = \\chi \\cos(\\phi)\n$$\n其中对于一次反射，如果 $z > H/2$，则 $\\chi = 1$；如果 $z \\le H/2$，则 $\\chi = 0$。对于明确定义的反向散射情况，根据定义，点积为负，所以 $\\chi=0$。$A$ 的计算与 $f$ 和 $N$ 无关。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the normalized imaging amplitude A for a series of test cases\n    based on a polarity-filtered imaging condition in reverse-time migration.\n    \"\"\"\n\n    test_cases = [\n        # (z, H, phi, is_backscatter)\n        # Case 1: happy path, deep reflector\n        (1000.0, 1000.0, 0.0, False),\n        # Case 2: shallow reflector, large offset\n        (100.0, 1000.0, 0.0, False),\n        # Case 3: boundary condition\n        (250.0, 500.0, 0.0, False),\n        # Case 4: zero-offset\n        (500.0, 0.0, 0.0, False),\n        # Case 5: explicit backscatter rejection\n        # z, H values are for context; the backscatter flag dictates the result.\n        (500.0, 500.0, 0.0, True),\n        # Case 6: phase sensitivity\n        (1000.0, 1000.0, np.pi, False),\n    ]\n\n    results = []\n    for case in test_cases:\n        z, H, phi, is_backscatter = case\n        \n        # The indicator function chi determines if the imaging condition contributes.\n        # chi is 1 if (k_s . k_r) > 0, and 0 otherwise.\n        \n        chi = 0.0\n        if is_backscatter:\n            # For the backscatter case, k_s and k_r are defined to be in\n            # opposite directions, so their dot product is negative. \n            # The condition (k_s . k_r) > 0 is false.\n            chi = 0.0\n        else:\n            # For primary reflections, the condition (k_s . k_r) > 0 simplifies\n            # to the geometric condition z > H/2.\n            # The problem statement implies a strict inequality > 0.\n            if z > H / 2.0:\n                chi = 1.0\n            else:\n                chi = 0.0\n        \n        # The normalized amplitude A is given by A = chi * cos(phi).\n        # The parameters f (frequency) and N (number of periods) cancel out\n        # in the normalization.\n        A = chi * np.cos(phi)\n        results.append(A)\n\n    # Format the output as a comma-separated list in square brackets.\n    # Using 'g' format specifier to handle floating point representation neatly.\n    formatted_results = [f\"{r:.1f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}