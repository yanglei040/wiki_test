{
    "hands_on_practices": [
        {
            "introduction": "Modeling the flow of magma within a dike often starts with the lubrication approximation, which simplifies the complex fluid dynamics into a manageable relationship. This practice guides you through the derivation of the famous \"cubic law,\" which links magma flux to the cube of the dike's aperture, a cornerstone of dike propagation models. By analyzing a dike with a varying width, you will discover how geometric heterogeneity significantly enhances the effective flow conductivity, a non-intuitive result with major implications for magma transport efficiency .",
            "id": "3608410",
            "problem": "In a magma-filled dike segment idealized as a long, planar fracture, assume steady, incompressible, isothermal flow of a Newtonian melt of dynamic viscosity $\\mu$ under a constant pressure gradient $\\partial p/\\partial x$ along the strike coordinate $x$. The fracture walls are locally parallel over scales large compared to the local aperture $w(x)$, so that the lubrication approximation is valid and inertia is negligible. The no-slip condition holds at the walls.\n\nThe aperture varies periodically along strike as\n$$\nw(x) \\;=\\; \\bar{w}\\,\\bigl(1 + m \\cos(2\\pi x/\\lambda)\\bigr),\n$$\nwith $0  m  1$, mean aperture scale $\\bar{w}  0$, and wavelength $\\lambda  0$. Define the spatial average over one wavelength by\n$$\n\\langle f \\rangle \\;=\\; \\frac{1}{\\lambda} \\int_{0}^{\\lambda} f(x)\\, dx.\n$$\n\nTasks:\n- Starting from the steady Stokes equations and the lubrication approximation between parallel plates, derive the local flux per unit out-of-plane thickness $q(x)$ in terms of $w(x)$ and $\\partial p/\\partial x$.\n- Compute the spatially averaged aperture $\\langle w \\rangle$.\n- Compute the shape factor\n$$\nS \\;=\\; \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}\n$$\nfor the cosine-shaped aperture specified above, expressing your final result for $S$ as a closed-form analytic expression in terms of $m$ only.\n- Using the flux expression you derived, interpret how $S$ controls the ratio of the spatially averaged flux in the variable-aperture dike to that in a uniform-aperture dike with aperture $\\langle w \\rangle$, and explain physically why this ratio departs from unity.\n\nYour final reported answer must be the closed-form analytic expression for $S$ only. No numerical evaluation is required and no units should be reported in the final answer box.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Flow conditions**: Steady, incompressible, isothermal flow of a Newtonian melt.\n- **Fluid property**: Dynamic viscosity $\\mu$.\n- **Driving force**: Constant pressure gradient $\\partial p/\\partial x$ along the strike coordinate $x$.\n- **Geometry**: A long, planar fracture (dike) with locally parallel walls.\n- **Model**: Lubrication approximation is valid; inertia is negligible.\n- **Boundary conditions**: No-slip condition at the walls.\n- **Aperture function**: $w(x) = \\bar{w}(1 + m \\cos(2\\pi x/\\lambda))$, with constraints $0  m  1$, $\\bar{w}  0$, and $\\lambda  0$.\n- **Definition of spatial average**: $\\langle f \\rangle = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} f(x)\\, dx$.\n- **Tasks**:\n  1.  Derive the local flux per unit out-of-plane thickness, $q(x)$.\n  2.  Compute the spatially averaged aperture, $\\langle w \\rangle$.\n  3.  Compute the shape factor $S = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}$ in terms of $m$.\n  4.  Interpret the physical meaning of $S$ in relation to the average flux.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Stokes equations for slow, viscous flow, simplified by the lubrication approximation. This is a standard and fundamental model in fluid mechanics (Hele-Shaw flow) and is widely applied in geophysics to model magma flow in dikes. The assumptions (Newtonian fluid, incompressibility, no-slip) are standard for a first-order model. The periodic aperture is a valid idealization of natural fracture roughness or segmentation. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-defined. The governing equations, geometry, and boundary conditions are specified, allowing for the derivation of a unique velocity profile and flux. The tasks are specific, and the mathematical operations (integration, averaging) are standard. The constraint $0  m  1$ ensures that the aperture $w(x) = \\bar{w}(1 + m \\cos(\\cdot)) \\ge 1 - m  0$, preventing the fracture from closing, which is physically realistic and mathematically convenient.\n- **Objective**: The problem is stated in precise, objective, mathematical language. It contains no subjective claims or opinions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard exercise in geophysical fluid dynamics that is scientifically sound, well-posed, and objective. A complete solution will be provided.\n\n***\n\nWe address the tasks sequentially.\n\n**Task 1: Derive the local flux $q(x)$**\n\nThe flow is governed by the steady-state Stokes equations for an incompressible fluid with constant viscosity $\\mu$:\n$$\n\\nabla p = \\mu \\nabla^{2}\\mathbf{v}\n$$\nwhere $\\mathbf{v}$ is the velocity vector and $p$ is the pressure. Let $z$ be the coordinate across the aperture, with the walls located at $z = \\pm w(x)/2$. The flow is primarily along the $x$-direction, so $\\mathbf{v} \\approx (u(x,z), 0, 0)$.\n\nThe lubrication approximation assumes that the length scale of variation in the flow direction, $\\lambda$, is much larger than the aperture scale, $\\bar{w}$. This implies that velocity gradients across the aperture are much larger than along it, i.e., $|\\partial u / \\partial z| \\gg |\\partial u / \\partial x|$. The $x$-component of the Stokes equation thus simplifies to:\n$$\n\\frac{\\partial p}{\\partial x} = \\mu \\frac{\\partial^{2} u}{\\partial z^{2}}\n$$\nAt any given location $x$, we can treat $w(x)$ and the constant pressure gradient $\\partial p/\\partial x$ as parameters and integrate with respect to $z$ to find the velocity profile $u(z)$.\n$$\n\\frac{d^{2}u}{dz^{2}} = \\frac{1}{\\mu} \\frac{\\partial p}{\\partial x}\n$$\nIntegrating once with respect to $z$ yields:\n$$\n\\frac{du}{dz} = \\frac{z}{\\mu} \\frac{\\partial p}{\\partial x} + C_{1}\n$$\nIntegrating a second time yields:\n$$\nu(z) = \\frac{z^{2}}{2\\mu} \\frac{\\partial p}{\\partial x} + C_{1}z + C_{2}\n$$\nThe constants of integration, $C_{1}$ and $C_{2}$, are determined by the no-slip boundary conditions at the fracture walls, $u(z = \\pm w(x)/2) = 0$.\n$$\nu\\left(+\\frac{w(x)}{2}\\right) = \\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}\\left(\\frac{w(x)}{2}\\right)^2 + C_{1}\\frac{w(x)}{2} + C_{2} = 0\n$$\n$$\nu\\left(-\\frac{w(x)}{2}\\right) = \\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}\\left(-\\frac{w(x)}{2}\\right)^2 - C_{1}\\frac{w(x)}{2} + C_{2} = 0\n$$\nSubtracting the second equation from the first gives $C_{1}w(x) = 0$. Since $w(x)  0$, we must have $C_{1}=0$. Substituting $C_{1}=0$ into the first equation gives:\n$$\nC_{2} = -\\frac{w(x)^{2}}{8\\mu} \\frac{\\partial p}{\\partial x}\n$$\nThe velocity profile is therefore a parabolic Poiseuille profile:\n$$\nu(z) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left( z^{2} - \\frac{w(x)^{2}}{4} \\right)\n$$\nThe local flux per unit out-of-plane thickness, $q(x)$, is the integral of this velocity profile across the aperture:\n$$\nq(x) = \\int_{-w(x)/2}^{+w(x)/2} u(z) \\,dz = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\int_{-w(x)/2}^{+w(x)/2} \\left( z^{2} - \\frac{w(x)^{2}}{4} \\right) dz\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ \\frac{z^{3}}{3} - \\frac{w(x)^{2}}{4}z \\right]_{-w(x)/2}^{+w(x)/2}\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ \\left( \\frac{w(x)^{3}}{24} - \\frac{w(x)^{3}}{8} \\right) - \\left( -\\frac{w(x)^{3}}{24} + \\frac{w(x)^{3}}{8} \\right) \\right]\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ 2 \\left( \\frac{w(x)^{3}}{24} - \\frac{3w(x)^{3}}{24} \\right) \\right] = \\frac{1}{\\mu} \\frac{\\partial p}{\\partial x} \\left( -\\frac{2w(x)^{3}}{24} \\right)\n$$\n$$\nq(x) = -\\frac{w(x)^{3}}{12\\mu} \\frac{\\partial p}{\\partial x}\n$$\nThis expression relates the local flux to the cube of the local aperture, the fluid viscosity, and the pressure gradient. This is the well-known \"cubic law\" for flow between parallel plates.\n\n**Task 2: Compute the spatially averaged aperture $\\langle w \\rangle$**\n\nThe spatially averaged aperture is given by:\n$$\n\\langle w \\rangle = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} w(x) \\,dx = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} \\bar{w}\\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right) dx\n$$\n$$\n\\langle w \\rangle = \\frac{\\bar{w}}{\\lambda} \\left[ \\int_{0}^{\\lambda} 1 \\,dx + m \\int_{0}^{\\lambda} \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) dx \\right]\n$$\nThe first integral is $\\int_{0}^{\\lambda} 1 \\,dx = \\lambda$. The second integral is over a full period of the cosine function, which evaluates to zero:\n$$\n\\int_{0}^{\\lambda} \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) dx = \\left[ \\frac{\\lambda}{2\\pi} \\sin\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right]_{0}^{\\lambda} = \\frac{\\lambda}{2\\pi}(\\sin(2\\pi) - \\sin(0)) = 0\n$$\nTherefore, the average aperture is:\n$$\n\\langle w \\rangle = \\frac{\\bar{w}}{\\lambda} [ \\lambda + m \\cdot 0 ] = \\bar{w}\n$$\n\n**Task 3: Compute the shape factor $S$**\n\nThe shape factor is defined as $S = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}$. We have already found $\\langle w \\rangle = \\bar{w}$, so $\\langle w \\rangle^{3} = \\bar{w}^{3}$. We now need to compute $\\langle w^{3} \\rangle$.\n$$\nw(x)^{3} = \\left[ \\bar{w}\\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right) \\right]^{3} = \\bar{w}^{3} \\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right)^{3}\n$$\nUsing the binomial expansion $(a+b)^{3} = a^{3} + 3a^{2}b + 3ab^{2} + b^{3}$ with $a=1$ and $b=m \\cos(2\\pi x/\\lambda)$:\n$$\nw(x)^{3} = \\bar{w}^{3} \\left[ 1 + 3m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) + 3m^{2} \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) + m^{3} \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right]\n$$\nNow, we average this expression over one wavelength. By linearity of the averaging operator:\n$$\n\\langle w^{3} \\rangle = \\bar{w}^{3} \\left[ \\langle 1 \\rangle + 3m \\left\\langle \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + 3m^{2} \\left\\langle \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + m^{3} \\left\\langle \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle \\right]\n$$\nWe evaluate the averages of the trigonometric terms:\n- $\\langle 1 \\rangle = 1$.\n- $\\langle \\cos(2\\pi x/\\lambda) \\rangle = 0$, as shown in Task 2.\n- For $\\langle \\cos^{2}(2\\pi x/\\lambda) \\rangle$, we use the identity $\\cos^{2}\\theta = \\frac{1 + \\cos(2\\theta)}{2}$:\n$$\n\\left\\langle \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle = \\left\\langle \\frac{1}{2} + \\frac{1}{2}\\cos\\left(\\frac{4\\pi x}{\\lambda}\\right) \\right\\rangle = \\frac{1}{2} \\langle 1 \\rangle + \\frac{1}{2} \\left\\langle \\cos\\left(\\frac{4\\pi x}{\\lambda}\\right) \\right\\rangle\n$$\nThe average of $\\cos(4\\pi x/\\lambda)$ over the interval $[0, \\lambda]$ is also zero. Thus, $\\langle \\cos^{2}(2\\pi x/\\lambda) \\rangle = 1/2$.\n- For $\\langle \\cos^{3}(2\\pi x/\\lambda) \\rangle$, we use the identity $\\cos^{3}\\theta = \\frac{3\\cos\\theta + \\cos(3\\theta)}{4}$:\n$$\n\\left\\langle \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle = \\left\\langle \\frac{3}{4}\\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) + \\frac{1}{4}\\cos\\left(\\frac{6\\pi x}{\\lambda}\\right) \\right\\rangle = \\frac{3}{4}\\left\\langle \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + \\frac{1}{4}\\left\\langle \\cos\\left(\\frac{6\\pi x}{\\lambda}\\right) \\right\\rangle\n$$\nBoth averages on the right-hand side are zero, so $\\langle \\cos^{3}(2\\pi x/\\lambda) \\rangle = 0$.\n\nSubstituting these results back into the expression for $\\langle w^{3} \\rangle$:\n$$\n\\langle w^{3} \\rangle = \\bar{w}^{3} \\left[ 1 + 3m(0) + 3m^{2}\\left(\\frac{1}{2}\\right) + m^{3}(0) \\right] = \\bar{w}^{3} \\left( 1 + \\frac{3}{2}m^{2} \\right)\n$$\nFinally, we compute the shape factor $S$:\n$$\nS = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}} = \\frac{\\bar{w}^{3} \\left( 1 + \\frac{3}{2}m^{2} \\right)}{\\bar{w}^{3}} = 1 + \\frac{3}{2}m^{2}\n$$\n\n**Task 4: Interpretation of $S$**\n\nLet's define a constant $C = -\\frac{1}{12\\mu} \\frac{\\partial p}{\\partial x}$. The local flux is $q(x) = C w(x)^{3}$. The spatially averaged flux is $\\langle q \\rangle = \\langle C w(x)^{3} \\rangle = C \\langle w^{3} \\rangle$, since $C$ is constant.\n\nNow consider a uniform-aperture dike whose aperture is equal to the average aperture of our variable dike, i.e., $w_{uniform} = \\langle w \\rangle$. The flux in this uniform dike would be $q_{uniform} = C w_{uniform}^{3} = C \\langle w \\rangle^{3}$.\n\nThe ratio of the average flux in the variable-aperture dike to the flux in the equivalent uniform-aperture dike is:\n$$\n\\frac{\\langle q \\rangle}{q_{uniform}} = \\frac{C \\langle w^{3} \\rangle}{C \\langle w \\rangle^{3}} = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}} = S\n$$\nSo, the shape factor $S$ represents the enhancement of the mean flux due to aperture variability, compared to a uniform channel with the same mean aperture. Since we found $S = 1 + \\frac{3}{2}m^{2}$ and the problem states $0  m  1$, it follows that $S  1$.\n\nPhysically, this means that the average flow rate through a channel with a variable aperture is always greater than the flow rate through a uniform channel of the same average aperture. This departure from unity is due to the highly nonlinear \"cubic law\" relationship between flux and aperture, $q(x) \\propto w(x)^{3}$. The function $f(w) = w^{3}$ is a convex function for $w0$. By Jensen's inequality, for any non-constant random variable (or spatially varying function) $w$, the average of the function is greater than the function of the average: $\\langle f(w) \\rangle  f(\\langle w \\rangle)$. In our context, this is $\\langle w^{3} \\rangle  \\langle w \\rangle^{3}$.\n\nThe physical reason is that the wider sections of the dike contribute disproportionately to the total flux. An increase in aperture at a wide spot enhances the flux much more significantly than an equivalent decrease in aperture at a narrow spot reduces it. The flow preferentially exploits the high-conductance pathways offered by the wider segments, leading to an overall higher average flux than would be predicted by simply using the average aperture.",
            "answer": "$$\n\\boxed{1 + \\frac{3}{2}m^{2}}\n$$"
        },
        {
            "introduction": "The opening of a dike is resisted by the elasticity of the surrounding host rock. Fully three-dimensional models are complex, so we often simplify the problem to two dimensions using the assumptions of plane stress or plane strain. This exercise challenges you to derive the effective elastic modulus $E'$ for each case and, critically, to connect these mathematical idealizations to real-world geological scenarios based on a dike's length and depth .",
            "id": "3608471",
            "problem": "A vertical magmatic dike is modeled as a two-dimensional fracture in an isotropic, homogeneous, linear-elastic medium occupying a large domain. Let the in-plane axes be $\\{x,z\\}$ (opening in $x$, vertical depth in $z$) and the out-of-plane axis be $y$ (along strike). The rock has Young’s modulus $E$ and Poisson’s ratio $\\nu$, with Lamé parameters $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$. Consider Mode I loading by uniform internal magmatic pressure that produces opening displacements. The energy release rate $G$ is defined as the decrease in total potential energy per unit new crack area and is equal to the path-independent $J$-integral in Linear Elastic Fracture Mechanics (LEFM).\n\nStarting from the three-dimensional isotropic linear-elastic constitutive law $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\varepsilon} + \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I}$ and the strain energy density $W = \\dfrac{1}{2} \\sigma_{ij} \\varepsilon_{ij}$, enforce each of the following kinematic/traction constraints in turn:\n- Plane stress: $\\sigma_{y} = 0$, $\\tau_{xy} = 0$, $\\tau_{yz} = 0$.\n- Plane strain: $\\varepsilon_{y} = 0$, $\\gamma_{xy} = 0$, $\\gamma_{yz} = 0$.\n\nUsing the definition of $G$ via the $J$-integral and the near-tip asymptotic fields for isotropic cracks, show that $G$ can be written in the form $G = \\dfrac{K_I^2}{E'}$, where $K_I$ is the Mode I stress-intensity factor and $E'$ is an effective modulus that depends on whether the problem is plane stress or plane strain. Derive the expression for $E'$ in each case from the constitutive relations and explain, in terms of geological boundary conditions and dike geometry, the conditions under which each assumption is appropriate for modeling dike elasticity in computational geophysics.\n\nWhich option correctly states both the expressions for $E'$ and their geological applicability?\n\nA. Plane stress: $E' = E$; applies when the dike segment is thin along strike or near traction-free lateral boundaries so that $\\sigma_y \\approx 0$. Plane strain: $E' = \\dfrac{E}{1-\\nu^2}$; applies when the dike is very long along strike with negligible variation and constrained out-of-plane deformation ($\\varepsilon_y \\approx 0$), such as deep, laterally extensive dikes far from ends.\n\nB. Plane stress: $E' = \\dfrac{E}{1-\\nu^2}$; applies to long, laterally extensive dikes with $\\varepsilon_y \\approx 0$. Plane strain: $E' = E$; applies near free surfaces with $\\sigma_y \\approx 0$.\n\nC. Plane stress: $E' = \\dfrac{E}{1+\\nu}$; applies to near-surface dikes under low confining pressure. Plane strain: $E' = E$; applies to deep dikes with high confining pressure.\n\nD. Plane stress: $E' = E(1-\\nu)$; applies when $\\nu$ is small. Plane strain: $E' = \\dfrac{E}{1-2\\nu}$; applies to incompressible rocks with $\\nu \\rightarrow \\dfrac{1}{2}$.",
            "solution": "The problem requires the derivation of the effective Young's modulus, $E'$, for plane stress and plane strain conditions, starting from the three-dimensional linear-elastic constitutive relations. It also asks for an explanation of the geological applicability of each condition to the modeling of magmatic dikes. The relationship between the Mode I energy release rate, $G$, and the Mode I stress intensity factor, $K_I$, is given as $G = \\dfrac{K_I^2}{E'}$. This relation is a cornerstone of Linear Elastic Fracture Mechanics (LEFM), and the parameter $E'$ depends on the two-dimensional simplification used.\n\nThe starting point is the 3D isotropic linear-elastic constitutive law. It is most convenient to use the form that expresses strain as a function of stress:\n$$ \\varepsilon_{ij} = \\frac{1+\\nu}{E} \\sigma_{ij} - \\frac{\\nu}{E} \\sigma_{kk} \\delta_{ij} $$\nwhere $E$ is the Young's modulus, $\\nu$ is the Poisson's ratio, $\\sigma_{ij}$ is the stress tensor, $\\varepsilon_{ij}$ is the strain tensor, $\\sigma_{kk} = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}$ is the trace of the stress tensor, and $\\delta_{ij}$ is the Kronecker delta.\n\nThe in-plane coordinates are $\\{x,z\\}$ and the out-of-plane (strike) direction is $y$.\n\n### Derivation for Plane Stress\n\nThe plane stress condition is defined by the absence of stress components acting on the planes whose normals are in the out-of-plane direction. For the $y$-direction being out-of-plane, this translates to:\n$$ \\sigma_{yy} = 0, \\quad \\sigma_{xy} = 0, \\quad \\sigma_{yz} = 0 $$\nThe problem is now reduced to a 2D problem in the $x,z$ plane. The strain component $\\varepsilon_{xx}$ is given by the general 3D law:\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ \\sigma_{xx} - \\nu (\\sigma_{yy} + \\sigma_{zz}) \\right] $$\nApplying the plane stress condition $\\sigma_{yy} = 0$:\n$$ \\varepsilon_{xx} = \\frac{1}{E} (\\sigma_{xx} - \\nu \\sigma_{zz}) $$\nSimilarly, for $\\varepsilon_{zz}$:\n$$ \\varepsilon_{zz} = \\frac{1}{E} (\\sigma_{zz} - \\nu \\sigma_{xx}) $$\nThe out-of-plane strain, $\\varepsilon_{yy}$, is generally non-zero:\n$$ \\varepsilon_{yy} = \\frac{1}{E} \\left[ \\sigma_{yy} - \\nu (\\sigma_{xx} + \\sigma_{zz}) \\right] = -\\frac{\\nu}{E}(\\sigma_{xx}+\\sigma_{zz}) $$\nThe effective modulus $E'$ relates strain to stress under a uniaxial stress state within the 2D plane. To find it, we consider the case where $\\sigma_{xx} \\neq 0$ and all other stress components, including the in-plane component $\\sigma_{zz}$, are zero.\nUnder these conditions ($\\sigma_{xx} \\neq 0, \\sigma_{zz} = 0, \\sigma_{yy} = 0$), the strain $\\varepsilon_{xx}$ becomes:\n$$ \\varepsilon_{xx} = \\frac{1}{E} (\\sigma_{xx} - \\nu \\cdot 0) = \\frac{\\sigma_{xx}}{E} $$\nThis relationship is in the form $\\sigma_{xx} = E \\varepsilon_{xx}$. By comparison with the target effective 1D law $\\sigma = E' \\varepsilon$, we identify the effective modulus for plane stress as:\n$$ E' = E $$\n\n### Derivation for Plane Strain\n\nThe plane strain condition is defined by the absence of strain components in the out-of-plane direction. For the $y$-direction being out-of-plane, this translates to:\n$$ \\varepsilon_{yy} = 0, \\quad \\gamma_{xy} = 2\\varepsilon_{xy} = 0, \\quad \\gamma_{yz} = 2\\varepsilon_{yz} = 0 $$\nUsing the constitutive law for the out-of-plane normal strain:\n$$ \\varepsilon_{yy} = \\frac{1}{E} \\left[ \\sigma_{yy} - \\nu (\\sigma_{xx} + \\sigma_{zz}) \\right] = 0 $$\nThis implies that a non-zero stress $\\sigma_{yy}$ must exist to prevent strain in the $y$-direction:\n$$ \\sigma_{yy} = \\nu (\\sigma_{xx} + \\sigma_{zz}) $$\nNow, we substitute this expression for $\\sigma_{yy}$ back into the equation for the in-plane strain $\\varepsilon_{xx}$:\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ \\sigma_{xx} - \\nu (\\sigma_{yy} + \\sigma_{zz}) \\right] $$\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ \\sigma_{xx} - \\nu ( \\nu (\\sigma_{xx} + \\sigma_{zz}) + \\sigma_{zz}) \\right] $$\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ \\sigma_{xx} - \\nu^2 \\sigma_{xx} - \\nu^2 \\sigma_{zz} - \\nu \\sigma_{zz} \\right] $$\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ (1 - \\nu^2) \\sigma_{xx} - \\nu(1 + \\nu) \\sigma_{zz} \\right] $$\nTo find the effective modulus $E'$, we again consider a uniaxial stress state within the 2D plane, where $\\sigma_{xx} \\neq 0$ and $\\sigma_{zz} = 0$. Note that $\\sigma_{yy} = \\nu\\sigma_{xx} \\neq 0$.\nSubstituting $\\sigma_{zz} = 0$ into the derived expression for $\\varepsilon_{xx}$:\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ (1 - \\nu^2) \\sigma_{xx} - 0 \\right] = \\frac{1 - \\nu^2}{E} \\sigma_{xx} $$\nRearranging to solve for $\\sigma_{xx}$:\n$$ \\sigma_{xx} = \\frac{E}{1 - \\nu^2} \\varepsilon_{xx} $$\nBy comparison with the effective 1D law $\\sigma = E' \\varepsilon$, we identify the effective modulus for plane strain as:\n$$ E' = \\frac{E}{1 - \\nu^2} $$\n\n### Geological Applicability\n\nThe choice between plane stress and plane strain depends on the geometry of the dike and the boundary conditions of the surrounding rock mass. The coordinate $y$ represents the along-strike direction of the dike.\n\n- **Plane Stress Applicability**: The condition $\\sigma_y \\approx 0$ (or $\\sigma_{yy} \\approx 0$) implies that the material is free to expand or contract in the $y$-direction. This is a valid approximation for a body that is thin in that direction relative to its in-plane dimensions. For a vertical dike, this applies to models of dike segments that are short along strike or near the lateral ends of an extensive dike system where the out-of-plane stress must diminish to zero at the free boundary.\n\n- **Plane Strain Applicability**: The condition $\\varepsilon_y \\approx 0$ (or $\\varepsilon_{yy} \\approx 0$) implies that there is no deformation along the dike's strike. This occurs when the body is very long in that direction, such that the material in the central region is constrained by the adjacent material from deforming. For a dike, this is the appropriate assumption when modeling a segment located in the middle of a very long, laterally extensive feeder system, far from its ends. Such dikes are often envisioned as being deep within the crust.\n\n### Evaluation of Options\n\n- **Option A**:\n  - Plane stress: $E' = E$. (Correct)\n  - Applicability: \"applies when the dike segment is thin along strike or near traction-free lateral boundaries so that $\\sigma_y \\approx 0$\". (Correct)\n  - Plane strain: $E' = \\dfrac{E}{1-\\nu^2}$. (Correct)\n  - Applicability: \"applies when the dike is very long along strike with negligible variation and constrained out-of-plane deformation ($\\varepsilon_y \\approx 0$), such as deep, laterally extensive dikes far from ends\". (Correct)\n  - Verdict: **Correct**. This option accurately states both the derived expressions and their physical justifications in the geological context.\n\n- **Option B**:\n  - Plane stress: $E' = \\dfrac{E}{1-\\nu^2}$. (Incorrect, this is for plane strain).\n  - Plane strain: $E' = E$. (Incorrect, this is for plane stress).\n  - The applicabilities are also swapped.\n  - Verdict: **Incorrect**.\n\n- **Option C**:\n  - Plane stress: $E' = \\dfrac{E}{1+\\nu}$. (Incorrect). This expression is related to the shear modulus, $\\mu = \\dfrac{E}{2(1+\\nu)}$.\n  - Plane strain: $E' = E$. (Incorrect).\n  - Verdict: **Incorrect**. The mathematical expressions for $E'$ are wrong.\n\n- **Option D**:\n  - Plane stress: $E' = E(1-\\nu)$. (Incorrect).\n  - Plane strain: $E' = \\dfrac{E}{1-2\\nu}$. (Incorrect). This is related to the P-wave modulus under specific conditions, not the plane strain Young's modulus.\n  - Verdict: **Incorrect**. The mathematical expressions for $E'$ are wrong.\n\nBased on the derivations and analysis, Option A is the only one that is correct in all aspects.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While analytical solutions provide deep insight, they are limited to simple geometries and loading conditions. To tackle more realistic scenarios, such as dikes in layered rock, we turn to numerical methods like the Boundary Element Method (BEM). This hands-on coding practice involves implementing a BEM solver to determine a dike's opening profile under pressure, directly applying the elastic concepts from the previous exercise . You will validate your code against a known analytical solution before applying it to a more complex, heterogeneous case .",
            "id": "3608435",
            "problem": "You are asked to implement a boundary element method for a two-dimensional, plane-strain, pressurized crack (a magma-filled dike) of finite length embedded in an elastic medium. The crack lies along the $x$-axis from $x=-a$ to $x=+a$, with opening displacement $w(x)$ in the normal direction. The net internal pressure is $p(x)$ (positive in compression on the crack faces), and the medium has plane-strain modulus $E'(x)$ which may vary with position along the crack (to emulate layered host rocks projected onto the crack line). Under the quasi-static, linear elastic, plane-strain approximation, derive a discretized boundary integral equation from fundamental elasticity that relates $p(x)$ to $w(x)$ and implement a numerical solver using constant elements and collocation. Then validate the solver against an analytic solution for a homogeneous medium with uniform pressure.\n\nFundamental base:\n- Linear elasticity in plane strain, with the plane-strain modulus defined as $E' \\equiv E/(1-\\nu^2)$, where $E$ is Young’s modulus and $\\nu$ is Poisson’s ratio.\n- The Mode I traction–opening relation for a straight crack in an infinite medium, expressible as a hypersingular integral equation that, for a homogeneous medium with constant $E'$, relates the net pressure $p(x)$ to the derivative of the opening $w'(s)$ via a Cauchy principal value integral.\n\nDiscretization requirement:\n- Discretize the interval $[-a,a]$ into $N$ constant-opening elements with edges $x_i$ for $i=0,\\dots,N$, where $x_0=-a$, $x_N=+a$, $x_i=-a + i h$, and $h=2a/N$.\n- Let the unknown opening on element $i$ be $w_i$ for $i=1,\\dots,N$, taken as constant over $[x_{i-1},x_i]$.\n- Collocate the traction equation at the element midpoints $x_j^c=(x_{j-1}+x_j)/2$ for $j=1,\\dots,N$.\n- Use the hypersingular integral equation in a piecewise-constant discretization so that the contribution of element $i$ to the traction at collocation point $x_j^c$ is represented by the difference of simple pole terms at the element’s endpoints. Specifically, for a homogeneous medium with constant $E'$, the discrete system has the form\n$$\np(x_j^c) \\;=\\; \\frac{E'}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N.\n$$\n- To emulate layering along the crack line, allow $E'$ to vary with the observation point $x$ by using $E'(x_j^c)$ multiplicatively in each row, i.e.,\n$$\np(x_j^c) \\;=\\; \\frac{E'(x_j^c)}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N,\n$$\nwhich recovers the exact homogeneous kernel when $E'$ is constant.\n\nValidation requirement:\n- For a homogeneous medium with constant $E'$ under uniform internal pressure $p(x)=p_0$, the analytic opening profile is\n$$\nw_{\\mathrm{ana}}(x) \\;=\\; \\frac{4 p_0 a}{E'} \\sqrt{1 - \\left(\\frac{x}{a}\\right)^2}, \\quad x \\in (-a,a).\n$$\n- You must compute and report errors between the numerical solution and the analytic solution at the collocation points. Use the relative $\\ell^2$ error\n$$\n\\varepsilon_2 \\;=\\; \\sqrt{ \\frac{ \\sum_{j=1}^N \\left( w_j - w_{\\mathrm{ana}}(x_j^c) \\right)^2 }{ \\sum_{j=1}^N \\left( w_{\\mathrm{ana}}(x_j^c) \\right)^2 } }\n$$\nand the relative maximum error\n$$\n\\varepsilon_\\infty \\;=\\; \\frac{ \\max_{1\\le j\\le N} \\left| w_j - w_{\\mathrm{ana}}(x_j^c) \\right| }{ \\max_{1\\le j\\le N} \\left| w_{\\mathrm{ana}}(x_j^c) \\right| }.\n$$\n\nLayered case quantity:\n- For a heterogeneous $E'(x)$ and uniform internal pressure $p_0$, compute the fracture volume per unit thickness,\n$$\nV \\;=\\; \\int_{-a}^{a} w(x)\\, dx,\n$$\nand report it in square meters ($\\mathrm{m}^2$), using the midpoint rule for your piecewise-constant $w_i$ as\n$$\nV \\;\\approx\\; \\sum_{i=1}^N w_i \\, h.\n$$\n\nUnits and conventions:\n- Use meters ($\\mathrm{m}$) for lengths, Pascals ($\\mathrm{Pa}$) for pressures and moduli, and seconds ($\\mathrm{s}$) are not explicitly needed.\n- All reported error metrics $\\varepsilon_2$ and $\\varepsilon_\\infty$ are dimensionless. The fracture volume $V$ must be reported in $\\mathrm{m}^2$.\n- Angles are not used and need not be reported.\n- If any ratio is required, report it as a decimal (not with a percentage sign).\n\nTest suite:\nImplement your program to solve the following three test cases and aggregate the results into a single output line.\n\n- Test case A (homogeneous, fine discretization “happy path”):\n  - Half-length $a = 1500\\,\\mathrm{m}$.\n  - Uniform pressure $p_0 = 3.0\\times 10^6\\,\\mathrm{Pa}$.\n  - Elastic properties: $E=60.0\\times 10^9\\,\\mathrm{Pa}$, $\\nu=0.25$, hence $E' = E/(1-\\nu^2)$.\n  - Number of elements $N=256$.\n  - Output: the relative $\\ell^2$ error $\\varepsilon_2$ as a float.\n\n- Test case B (homogeneous, coarse discretization boundary case):\n  - Same $a$, $p_0$, $E$, $\\nu$ as in Test case A.\n  - Number of elements $N=32$.\n  - Output: the relative maximum error $\\varepsilon_\\infty$ as a float.\n\n- Test case C (piecewise-homogeneous “layered” along-crack modulus):\n  - Same $a$ and $p_0$ as in Test case A.\n  - Poisson’s ratio $\\nu=0.25$ everywhere.\n  - Young’s modulus $E(x)$ is $50.0\\times 10^9\\,\\mathrm{Pa}$ for $x0$ and $100.0\\times 10^9\\,\\mathrm{Pa}$ for $x\\ge 0$, and $E'(x)=E(x)/(1-\\nu^2)$.\n  - Number of elements $N=256$.\n  - Output: the fracture volume per unit thickness $V$ in $\\mathrm{m}^2$ as a float.\n\nFinal output format:\n- Your program should produce a single line of output containing the three results, in order, as a comma-separated list enclosed in square brackets, i.e.,\n$$\n[\\varepsilon_2,\\varepsilon_\\infty,V].\n$$\nNo additional text should be printed.",
            "solution": "The user has provided a well-posed problem in computational geophysics, specifically in the domain of magma dynamics and dike propagation. The task is to implement a two-dimensional boundary element method (BEM) to model a pressurized, plane-strain crack, validate it, and apply it to a heterogeneous material case. The problem statement is scientifically grounded in linear elastic fracture mechanics, is self-contained, and provides all necessary equations, parameters, and validation criteria. Therefore, the problem is valid and a solution will be constructed.\n\nThe core of the problem is to solve for the unknown crack opening displacement, $w(x)$, given an internal net pressure, $p(x)$, and the mechanical properties of the surrounding elastic medium. The relationship between these quantities is given by a discretized hypersingular boundary integral equation.\n\nThe provided discrete system of equations is:\n$$\np(x_j^c) \\;=\\; \\frac{E'(x_j^c)}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N.\n$$\nHere, $w_i$ represents the unknown constant opening of the $i$-th element, $p(x_j^c)$ is the known pressure at the $j$-th collocation point (element center), and $E'(x_j^c)$ is the plane-strain modulus at that point. The crack is discretized into $N$ elements of equal length $h = 2a/N$, with element boundaries at $x_i$ for $i=0,\\dots,N$.\n\nThis system of $N$ equations for $N$ unknowns can be formulated as a standard matrix-vector equation. To facilitate the solution, we can rearrange the equation to isolate the unknown Fvector $w$ with components $w_i$. For each collocation point $j$, we have:\n$$\n\\frac{p(x_j^c)}{E'(x_j^c)} = \\sum_{i=1}^N w_i \\left( \\frac{1}{4\\pi} \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right] \\right)\n$$\nThis is a linear system of the form $\\mathbf{A} \\mathbf{w} = \\mathbf{b}$, where:\n- $\\mathbf{w}$ is the vector of unknown element openings $[w_1, w_2, \\dots, w_N]^T$.\n- $\\mathbf{A}$ is the $N \\times N$ influence matrix, whose entries depend only on the geometry of the discretization. The entry $A_{ji}$ (for row $j$ and column $i$) is given by:\n$$\nA_{ji} = \\frac{1}{4\\pi} \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right]\n$$\n- $\\mathbf{b}$ is the $N \\times 1$ right-hand side vector, which incorporates the loading and material properties. The $j$-th component is:\n$$\nb_j = \\frac{p(x_j^c)}{E'(x_j^c)}\n$$\n\nThe numerical implementation proceeds as follows:\n\n1.  **Discretization and Mesh Generation**: For a given half-length $a$ and number of elements $N$, the domain $[-a, a]$ is divided. The element boundaries $x_i = -a + i h$ (for $i=0, \\dots, N$) and collocation points $x_j^c = -a + (j-0.5)h$ (for $j=1, \\dots, N$) are computed.\n\n2.  **Matrix and Vector Assembly**:\n    - The geometric influence matrix $\\mathbf{A}$ is constructed. The calculation of its $N^2$ entries can be efficiently vectorized by representing the collocation points and element boundaries as column and row vectors, respectively, and using broadcasting operations.\n    - The right-hand side vector $\\mathbf{b}$ is constructed. This requires evaluating the pressure $p(x)$ and the plane-strain modulus $E'(x)$ at each of the $N$ collocation points. For Test Case C, $E'(x)$ is a piecewise function, which must be evaluated accordingly for each $x_j^c$.\n\n3.  **Solving the System**: The dense linear system $\\mathbf{A} \\mathbf{w} = \\mathbf{b}$ is solved for the opening vector $\\mathbf{w}$ using a standard-library linear algebra solver, such as `numpy.linalg.solve`.\n\n4.  **Post-processing**:\n    - **Validation (Cases A and B)**: For the homogeneous medium, the numerical solution $\\mathbf{w}$ is compared against the analytical solution $w_{\\mathrm{ana}}(x)$ evaluated at the collocation points:\n      $$\n      w_{\\mathrm{ana}}(x) = \\frac{4 p_0 a}{E'} \\sqrt{1 - (x/a)^2}\n      $$\n      The relative $\\ell^2$ error, $\\varepsilon_2$, and the relative maximum error, $\\varepsilon_\\infty$, are computed as per the problem's definitions to quantify the accuracy of the BEM solver.\n    - **Quantity of Interest (Case C)**: For the heterogeneous case, the total fracture volume per unit thickness, $V$, is computed. Using a midpoint-rule approximation consistent with the piecewise-constant opening assumption, the volume is:\n      $$\n      V = \\int_{-a}^{a} w(x) \\,dx \\approx \\sum_{i=1}^N w_i h\n      $$\n\nThe following Python code implements this logic, handling all three specified test cases and producing the output in the required format. The core logic is encapsulated in a function that can handle both constant and variable material properties.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_bem(a, p0, E_param, nu, N, output_type):\n    \"\"\"\n    Implements a Boundary Element Method for a pressurized crack.\n\n    Args:\n        a (float): Crack half-length in meters.\n        p0 (float): Uniform internal pressure in Pascals.\n        E_param (float or callable): Young's modulus in Pascals.\n                                   If float, it's constant.\n                                   If callable, it's a function E(x).\n        nu (float): Poisson's ratio.\n        N (int): Number of elements.\n        output_type (str): The quantity to compute and return.\n                           'l2_error', 'max_error', or 'volume'.\n\n    Returns:\n        float: The requested output quantity.\n    \"\"\"\n    # 1. Setup mesh\n    h = 2.0 * a / N\n    # Element boundaries (N+1 points, 0-indexed)\n    x_nodes = np.linspace(-a, a, N + 1)\n    # Collocation points (N points, element centers)\n    x_colloc = x_nodes[:-1] + h / 2.0\n\n    # 2. Define E' and p vectors\n    p_vec = np.full(N, p0)\n    \n    if callable(E_param):  # Heterogeneous case\n        E_vals = np.array([E_param(x) for x in x_colloc])\n        E_prime_vals = E_vals / (1.0 - nu**2)\n    else:  # Homogeneous case\n        E_prime_const = E_param / (1.0 - nu**2)\n        E_prime_vals = np.full(N, E_prime_const)\n\n    # 3. Construct the influence matrix A and RHS vector b\n    # The system is A * w = b, where b_j = p_j / E'(x_j^c) and\n    # A_ji = (1/(4*pi)) * [ 1/(x_i - x_j^c) - 1/(x_{i-1} - x_j^c) ]\n    # Using 0-based indexing for i, j in [0, N-1]:\n    # x_i - x_nodes[i+1], x_{i-1} - x_nodes[i], x_j^c - x_colloc[j]\n    \n    x_colloc_col = x_colloc.reshape(-1, 1)    # Shape (N, 1)\n    xi_row = x_nodes[1:].reshape(1, -1)       # Shape (1, N), represents x_i\n    xi_m1_row = x_nodes[:-1].reshape(1, -1)   # Shape (1, N), represents x_{i-1}\n\n    # Broadcasting creates (N, N) matrices\n    term1_matrix = 1.0 / (xi_row - x_colloc_col)\n    term2_matrix = 1.0 / (xi_m1_row - x_colloc_col)\n\n    kernel_matrix = term1_matrix - term2_matrix\n    A = (1.0 / (4.0 * np.pi)) * kernel_matrix\n\n    b_vec = p_vec / E_prime_vals\n\n    # 4. Solve for w\n    w = np.linalg.solve(A, b_vec)\n\n    # 5. Calculate and return the required output\n    if output_type == 'l2_error':\n        E_prime = E_param / (1.0 - nu**2)\n        w_ana = (4.0 * p0 * a / E_prime) * np.sqrt(1.0 - (x_colloc / a)**2)\n        l2_error = np.linalg.norm(w - w_ana) / np.linalg.norm(w_ana)\n        return l2_error\n    \n    elif output_type == 'max_error':\n        E_prime = E_param / (1.0 - nu**2)\n        w_ana = (4.0 * p0 * a / E_prime) * np.sqrt(1.0 - (x_colloc / a)**2)\n        max_error = np.max(np.abs(w - w_ana)) / np.max(np.abs(w_ana))\n        return max_error\n        \n    elif output_type == 'volume':\n        volume = np.sum(w) * h\n        return volume\n        \n    else:\n        raise ValueError(\"Invalid output type specified.\")\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    # Test Case A: Homogeneous, fine discretization\n    a_A, p0_A, E_A, nu_A, N_A = 1500.0, 3.0e6, 60.0e9, 0.25, 256\n    result_A = calculate_bem(a_A, p0_A, E_A, nu_A, N_A, 'l2_error')\n    \n    # Test Case B: Homogeneous, coarse discretization\n    a_B, p0_B, E_B, nu_B, N_B = 1500.0, 3.0e6, 60.0e9, 0.25, 32\n    result_B = calculate_bem(a_B, p0_B, E_B, nu_B, N_B, 'max_error')\n    \n    # Test Case C: Layered modulus\n    a_C, p0_C, nu_C, N_C = 1500.0, 3.0e6, 0.25, 256\n    def E_func_C(x):\n        return 50.0e9 if x  0 else 100.0e9\n    result_C = calculate_bem(a_C, p0_C, E_func_C, nu_C, N_C, 'volume')\n    \n    results = [result_A, result_B, result_C]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}