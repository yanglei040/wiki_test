{
    "hands_on_practices": [
        {
            "introduction": "Understanding the temperature distribution within Earth's crust is fundamental to many geological processes. This first practice provides a foundational analytical exercise, guiding you through the derivation of the temperature profile in a continental crust that generates its own heat through radioactive decay. By solving the steady-state heat equation with an internal source term , you will develop essential skills in solving boundary value problems and gain a quantitative understanding of how radiogenic heating shapes the geotherm.",
            "id": "3611228",
            "problem": "Consider a thermally conductive continental crust idealized as a finite, homogeneous, one-dimensional (1D) plate of thickness $L$, with vertical coordinate $z$ measured downward from the surface ($z=0$) to the base of the crust ($z=L$). Assume constant thermal conductivity $k$ and steady-state energy conservation with volumetric internal heat production $H(z)$. The governing equation is the one-dimensional steady-state heat equation with internal heating,\n$$\n\\frac{d}{dz}\\!\\left(k\\,\\frac{dT}{dz}\\right)+H(z)=0,\n$$\nsubject to fixed temperatures at the boundaries $T(0)=T_s$ and $T(L)=T_b$. Let crustal radiogenic heat production be spatially uniform within the crust, $H(z)=H_0$ for $0\\le z\\le L$.\n\nStarting from the fundamental laws and definitions above, derive the temperature profile $T(z)$, obtain the depth $z_{\\max}$ where $T(z)$ attains its maximum inside the plate, and compare it to the non-radiogenic case with $H_0=0$. Using the following parameter values,\n- $L=60\\,\\mathrm{km}$,\n- $k=3\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$,\n- $T_s=273\\,\\mathrm{K}$,\n- $T_b=823\\,\\mathrm{K}$,\n- $H_0=2.0\\times10^{-6}\\,\\mathrm{W\\,m^{-3}}$,\ncompute the upward shift of the temperature maximum, defined as $\\Delta z=L-z_{\\max}$, relative to the non-radiogenic case. Express your final answer in kilometers and round your answer to three significant figures.",
            "solution": "The user has provided a well-posed problem in computational geophysics.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **Governing Equation**: $\\frac{d}{dz}\\!\\left(k\\,\\frac{dT}{dz}\\right)+H(z)=0$ for $0\\le z\\le L$.\n- **Thermal Conductivity**: $k$ is constant.\n- **Internal Heat Production**: $H(z) = H_0$ (constant) for $0\\le z\\le L$.\n- **Boundary Conditions**: $T(0)=T_s$ and $T(L)=T_b$.\n- **Plate Thickness**: $L = 60\\,\\mathrm{km}$.\n- **Thermal Conductivity Value**: $k=3\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$.\n- **Surface Temperature**: $T_s = 273\\,\\mathrm{K}$.\n- **Base Temperature**: $T_b = 823\\,\\mathrm{K}$.\n- **Heat Production Value**: $H_0=2.0\\times10^{-6}\\,\\mathrm{W\\,m^{-3}}$.\n- **Task**: Derive $T(z)$, find the depth of maximum temperature $z_{\\max}$, and compute the upward shift $\\Delta z=L-z_{\\max}$ relative to the non-radiogenic case ($H_0 = 0$). The final answer for $\\Delta z$ must be in kilometers, rounded to three significant figures.\n\n**1.2. Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is based on the one-dimensional steady-state heat equation, a cornerstone of thermal modeling in geophysics. All parameters are physically realistic for the continental crust.\n- **Well-Posedness**: The problem is a second-order ordinary differential equation with two Dirichlet boundary conditions. This constitutes a well-posed boundary value problem, ensuring a unique and stable solution.\n- **Objectivity**: The problem is stated using precise, unambiguous scientific language.\n\n**1.3. Verdict and Action**\nThe problem is scientifically sound, well-posed, and objective. It is deemed **valid**. We proceed to the solution.\n\n### Step 2: Derivation of the Temperature Profile $T(z)$\n\nThe governing equation for steady-state heat conduction in one dimension with constant thermal conductivity $k$ and uniform internal heat production $H_0$ is:\n$$\nk\\frac{d^2T}{dz^2} + H_0 = 0\n$$\nThis can be rewritten as:\n$$\n\\frac{d^2T}{dz^2} = -\\frac{H_0}{k}\n$$\nIntegrating this equation once with respect to $z$ yields the temperature gradient:\n$$\n\\frac{dT}{dz} = -\\frac{H_0}{k}z + C_1\n$$\nwhere $C_1$ is a constant of integration. Integrating a second time gives the temperature profile $T(z)$:\n$$\nT(z) = -\\frac{H_0}{2k}z^2 + C_1 z + C_2\n$$\nwhere $C_2$ is a second constant of integration. We determine the constants $C_1$ and $C_2$ by applying the boundary conditions.\n\nAt the surface, $z=0$, the temperature is $T(0) = T_s$:\n$$\nT(0) = -\\frac{H_0}{2k}(0)^2 + C_1(0) + C_2 = T_s\n$$\nThis directly gives $C_2 = T_s$. The temperature profile is now:\n$$\nT(z) = -\\frac{H_0}{2k}z^2 + C_1 z + T_s\n$$\nAt the base of the crust, $z=L$, the temperature is $T(L) = T_b$:\n$$\nT(L) = -\\frac{H_0}{2k}L^2 + C_1 L + T_s = T_b\n$$\nWe solve for $C_1$:\n$$\nC_1 L = T_b - T_s + \\frac{H_0 L^2}{2k}\n$$\n$$\nC_1 = \\frac{T_b - T_s}{L} + \\frac{H_0 L}{2k}\n$$\nSubstituting the expressions for $C_1$ and $C_2$ into the general solution for $T(z)$, we obtain the complete temperature profile:\n$$\nT(z) = -\\frac{H_0}{2k}z^2 + \\left(\\frac{T_b - T_s}{L} + \\frac{H_0 L}{2k}\\right)z + T_s\n$$\nThis can be rearranged to separate the linear conductive component and the radiogenic component:\n$$\nT(z) = T_s + (T_b - T_s)\\frac{z}{L} + \\frac{H_0}{2k}(Lz - z^2)\n$$\n\n### Step 3: Depth of Maximum Temperature, $z_{\\max}$\n\nThe maximum temperature within the plate occurs at a depth $z_{\\max}$ where the temperature gradient is zero, i.e., $\\frac{dT}{dz}|_{z=z_{\\max}} = 0$. Using the expression for the gradient derived earlier:\n$$\n\\frac{dT}{dz} = -\\frac{H_0}{k}z + C_1\n$$\nSetting the gradient to zero at $z=z_{\\max}$:\n$$\n0 = -\\frac{H_0}{k}z_{\\max} + C_1\n$$\nSolving for $z_{\\max}$:\n$$\nz_{\\max} = \\frac{k C_1}{H_0}\n$$\nSubstituting the derived expression for $C_1$:\n$$\nz_{\\max} = \\frac{k}{H_0}\\left(\\frac{T_b - T_s}{L} + \\frac{H_0 L}{2k}\\right)\n$$\n$$\nz_{\\max} = \\frac{k(T_b - T_s)}{H_0 L} + \\frac{L}{2}\n$$\nThis is the depth at which the temperature is at its maximum. For this maximum to be physically located within the crust, we must have $0 \\le z_{\\max} \\le L$.\n\n### Step 4: Non-Radiogenic Case and Upward Shift $\\Delta z$\n\nIn the non-radiogenic case, $H_0 = 0$. The governing equation simplifies to $\\frac{d^2T}{dz^2} = 0$, and the temperature profile becomes linear:\n$$\nT(z) = T_s + (T_b - T_s)\\frac{z}{L}\n$$\nThe temperature gradient is $\\frac{dT}{dz} = \\frac{T_b - T_s}{L}$. Since $T_b > T_s$, this gradient is a positive constant, meaning the temperature increases monotonically with depth. Therefore, the maximum temperature occurs at the bottom boundary, $z = L$.\n\nThe problem defines the upward shift of the temperature maximum, $\\Delta z$, as the difference between the depth of the maximum in the non-radiogenic case ($L$) and the depth of the maximum in the radiogenic case ($z_{\\max}$).\n$$\n\\Delta z = L - z_{\\max}\n$$\nSubstituting the expression for $z_{\\max}$:\n$$\n\\Delta z = L - \\left(\\frac{k(T_b - T_s)}{H_0 L} + \\frac{L}{2}\\right)\n$$\n$$\n\\Delta z = \\frac{L}{2} - \\frac{k(T_b - T_s)}{H_0 L}\n$$\n\n### Step 5: Numerical Calculation\n\nWe are given the following parameter values, which we must convert to base SI units:\n- $L = 60\\,\\mathrm{km} = 6 \\times 10^4\\,\\mathrm{m}$\n- $k = 3\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- $T_s = 273\\,\\mathrm{K}$\n- $T_b = 823\\,\\mathrm{K}$, so $T_b - T_s = 550\\,\\mathrm{K}$\n- $H_0 = 2.0 \\times 10^{-6}\\,\\mathrm{W\\,m^{-3}}$\n\nNow we substitute these values into the expression for $\\Delta z$:\n$$\n\\Delta z = \\frac{6 \\times 10^4\\,\\mathrm{m}}{2} - \\frac{(3\\,\\mathrm{W\\,m^{-1}\\,K^{-1}})(550\\,\\mathrm{K})}{(2.0 \\times 10^{-6}\\,\\mathrm{W\\,m^{-3}})(6 \\times 10^4\\,\\mathrm{m})}\n$$\nFirst, calculate the second term:\n$$\n\\frac{k(T_b - T_s)}{H_0 L} = \\frac{1650\\,\\mathrm{W\\,m^{-1}}}{1.2 \\times 10^{-1}\\,\\mathrm{W\\,m^{-2}}} = \\frac{1650}{0.12}\\,\\mathrm{m} = 13750\\,\\mathrm{m}\n$$\nNow, compute $\\Delta z$:\n$$\n\\Delta z = 30000\\,\\mathrm{m} - 13750\\,\\mathrm{m} = 16250\\,\\mathrm{m}\n$$\nThe problem requires the answer in kilometers:\n$$\n\\Delta z = 16.25\\,\\mathrm{km}\n$$\nRounding to three significant figures, we get:\n$$\n\\Delta z \\approx 16.3\\,\\mathrm{km}\n$$\nAs a check, the depth of the maximum temperature is $z_{\\max} = L - \\Delta z = 60\\,\\mathrm{km} - 16.25\\,\\mathrm{km} = 43.75\\,\\mathrm{km}$. Since $0 < 43.75 < 60$, the maximum is located inside the crust as expected.",
            "answer": "$$\\boxed{16.3}$$"
        },
        {
            "introduction": "While analytical models are powerful, real-world geophysical systems often involve complexities that require numerical solutions. In this practice, we will explore a more realistic model of the oceanic lithosphere where thermal conductivity, $k$, is not constant but varies with temperature, $T$. This temperature dependence introduces nonlinearity into the governing heat equation, making analytical solutions intractable . You will implement a robust numerical pipeline using the Finite Difference Method combined with a Newton-Raphson solver, providing you with hands-on experience in tackling the nonlinear problems frequently encountered in computational geophysics.",
            "id": "3611187",
            "problem": "Consider a one-dimensional, vertically stratified oceanic lithospheric plate that is thermally conducting in steady state with no internal heat production. The vertical coordinate is $z \\in [0,L]$, measured positive downward from the seafloor at $z=0$ to the base of the thermal boundary layer at $z=L$. Let the seafloor temperature be $T_s$ and the basal temperature be $T_m$, both specified in Kelvin. The thermal conductivity depends on temperature and is modeled by $k(T) = \\dfrac{k_0}{1+\\beta T}$, where $k_0$ is a positive constant with units of $\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$ and $\\beta$ is a nonnegative constant with units of $\\text{K}^{-1}$. The governing steady-state energy equation is the conservation of energy under Fourier’s law of heat conduction, which reduces in one dimension to\n$$\n\\frac{d}{dz}\\left(k(T)\\frac{dT}{dz}\\right) = 0,\n$$\nwith Dirichlet boundary conditions $T(0) = T_s$ and $T(L) = T_m$.\n\nYou must implement a Newton scheme to solve the discretized nonlinear boundary value problem using the Finite Difference Method (FDM). The discretization should use $N$ grid points with uniform spacing $\\Delta z = L/(N-1)$, and approximate the conduction operator with edge-centered conductivities to ensure discrete flux continuity. Specifically, for any interior node index $i$ (with $i=1,\\dots,N-2$), define $k_{i+1/2} = k\\!\\left(\\frac{T_i + T_{i+1}}{2}\\right)$ and $k_{i-1/2} = k\\!\\left(\\frac{T_{i-1} + T_i}{2}\\right)$, and enforce the discretized residual\n$$\nR_i(T) = \\frac{k_{i+1/2}(T_{i+1}-T_i) - k_{i-1/2}(T_i - T_{i-1})}{\\Delta z^2} = 0.\n$$\nConstruct the Newton-Raphson (NR) linearization by assembling the Jacobian matrix with exact partial derivatives $\\partial R_i/\\partial T_j$ derived from the chain rule including $\\frac{dk}{dT}(T)$, and iterate to convergence. Convergence must be declared when the infinity norm of the interior residual vector $\\|R\\|_\\infty$ is less than $10^{-10}$.\n\nFor the physically relevant thickness $L$ of the oceanic plate at age $t$, use the diffusion length scale $L = 2\\sqrt{\\kappa t}$, where $\\kappa$ is the thermal diffusivity in $\\text{m}^2\\,\\text{s}^{-1}$ and $t$ is the age in seconds. Take the age $t$ corresponding to $30$ million years ($30$ Myr) and compute $t$ in seconds using $365.25$ days per year.\n\nAfter solving for the temperature distribution $T(z)$, compute the upward heat flux magnitude at the seafloor as\n$$\nq_{\\text{nl}} = \\left| -\\,k\\!\\left(\\frac{T_0 + T_1}{2}\\right)\\frac{T_1 - T_0}{\\Delta z} \\right|,\n$$\nexpressed in $\\text{W}\\,\\text{m}^{-2}$. Then quantify the error introduced by assuming constant thermal conductivity equal to its cold-surface value $k_{\\text{const}} = k(T_s)$ by computing the constant-conductivity heat flux\n$$\nq_{\\text{const}} = \\frac{k_{\\text{const}}(T_m - T_s)}{L},\n$$\nin $\\text{W}\\,\\text{m}^{-2}$, and the relative error\n$$\nE = \\frac{q_{\\text{const}} - q_{\\text{nl}}}{q_{\\text{nl}}},\n$$\nas a decimal fraction (dimensionless). All fluxes must be computed and interpretable in $\\text{W}\\,\\text{m}^{-2}$, and all temperatures in Kelvin.\n\nImplement the algorithm and produce results for the following test suite of parameter sets; for each case, use the same age $t=30$ Myr and thermal diffusivity $\\kappa = 1.0\\times 10^{-6}\\ \\text{m}^2\\,\\text{s}^{-1}$, and vary the temperature dependence and resolution to test different facets of the solution:\n\n- Case A (baseline \"happy path\"): $k_0 = 3.2\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$, $\\beta = 4.0\\times 10^{-4}\\ \\text{K}^{-1}$, $T_s = 273\\ \\text{K}$, $T_m = 1573\\ \\text{K}$, $N=101$.\n- Case B (boundary condition of negligible temperature dependence): $k_0 = 3.2\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$, $\\beta = 0.0\\ \\text{K}^{-1}$, $T_s = 273\\ \\text{K}$, $T_m = 1573\\ \\text{K}$, $N=101$.\n- Case C (strong temperature dependence and refined grid): $k_0 = 3.2\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$, $\\beta = 1.0\\times 10^{-3}\\ \\text{K}^{-1}$, $T_s = 273\\ \\text{K}$, $T_m = 1573\\ \\text{K}$, $N=201$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n$$\n[q_{\\text{nl}}^{(A)}, q_{\\text{const}}^{(A)}, E^{(A)}, q_{\\text{nl}}^{(B)}, q_{\\text{const}}^{(B)}, E^{(B)}, q_{\\text{nl}}^{(C)}, q_{\\text{const}}^{(C)}, E^{(C)}].\n$$\nFluxes must be computed in $\\text{W}\\,\\text{m}^{-2}$ and errors as decimal fractions; the printed values should be floats without unit symbols.",
            "solution": "The user-provided problem is assessed to be valid. It is a well-posed, scientifically-grounded exercise in computational geophysics, specifically in numerically solving a nonlinear boundary value problem for heat conduction in the oceanic lithosphere. The problem is self-contained, with all necessary equations, parameters, and boundary conditions clearly specified. The methodology, using the Finite Difference Method (FDM) combined with a Newton-Raphson (NR) solver, is a standard and appropriate technique for this class of problem. There are no contradictions, ambiguities, or factual errors.\n\nThe solution proceeds as follows: First, we discretize the governing one-dimensional steady-state heat equation. Then, we derive the components of the Newton-Raphson algorithm, namely the residual vector and the Jacobian matrix, for the resulting system of nonlinear algebraic equations. Finally, we implement this algorithm to solve for the temperature profile and compute the required heat fluxes and relative error for each specified test case.\n\n**1. Governing Equation and Discretization**\n\nThe problem starts with the steady-state, one-dimensional heat conduction equation with no internal heat generation:\n$$\n\\frac{d}{dz}\\left(k(T)\\frac{dT}{dz}\\right) = 0\n$$\nwhere $z \\in [0,L]$ is the vertical coordinate, $T(z)$ is the temperature, and $k(T)$ is the temperature-dependent thermal conductivity, given by:\n$$\nk(T) = \\frac{k_0}{1+\\beta T}\n$$\nThe domain is subject to Dirichlet boundary conditions:\n$$\nT(0) = T_s, \\quad T(L) = T_m\n$$\nWe discretize the domain using $N$ grid points $z_i = i \\Delta z$ for $i=0, 1, \\dots, N-1$, where the grid spacing is $\\Delta z = L/(N-1)$. The temperatures at these points are denoted $T_i = T(z_i)$. The boundary conditions fix $T_0 = T_s$ and $T_{N-1} = T_m$. The remaining $N-2$ interior temperatures, $T_1, \\dots, T_{N-2}$, are the unknowns.\n\nThe governing equation is discretized using a finite difference scheme that ensures conservation of heat flux. At each interior node $i \\in \\{1, \\dots, N-2\\}$, we enforce the residual $R_i$ to be zero:\n$$\nR_i(\\mathbf{T}) = \\frac{k_{i+1/2}(T_{i+1}-T_i) - k_{i-1/2}(T_i - T_{i-1})}{\\Delta z^2} = 0\n$$\nThe thermal conductivity is evaluated at the midpoints (cell edges) between nodes to ensure discrete flux continuity:\n$$\nk_{i+1/2} = k\\left(\\frac{T_i + T_{i+1}}{2}\\right), \\quad k_{i-1/2} = k\\left(\\frac{T_{i-1} + T_i}{2}\\right)\n$$\nThis results in a system of $N-2$ nonlinear algebraic equations for the vector of unknown interior temperatures $\\mathbf{T}_{\\text{int}} = [T_1, T_2, \\dots, T_{N-2}]^T$.\n\n**2. Newton-Raphson Method**\n\nTo solve the nonlinear system $\\mathbf{R}(\\mathbf{T}_{\\text{int}}) = \\mathbf{0}$, we employ the Newton-Raphson method. Starting with an initial guess $\\mathbf{T}^{(0)}$, we iteratively refine the solution using the update rule:\n$$\n\\mathbf{T}^{(k+1)} = \\mathbf{T}^{(k)} + \\delta\\mathbf{T}\n$$\nwhere the update step $\\delta\\mathbf{T}$ is the solution to the linear system:\n$$\nJ(\\mathbf{T}^{(k)}) \\delta\\mathbf{T} = -\\mathbf{R}(\\mathbf{T}^{(k)})\n$$\nHere, $J$ is the Jacobian matrix with elements $J_{ij} = \\frac{\\partial R_i}{\\partial T_j}$ (where $i,j$ here refer to the indices of the interior nodes, $1, \\dots, N-2$). The iteration continues until the infinity norm of the residual vector is below a specified tolerance, $\\|R\\|_\\infty < 10^{-10}$. A linear temperature profile, $T_i = T_s + (T_m-T_s) \\frac{z_i}{L}$, serves as an excellent initial guess.\n\n**3. Jacobian Matrix Derivation**\n\nThe crucial step is constructing the Jacobian matrix. Since the residual $R_i$ depends only on $T_{i-1}$, $T_i$, and $T_{i+1}$, the Jacobian is a tridiagonal matrix. We derive its elements using the chain rule and the derivative of the conductivity function, $k'(T) = \\frac{dk}{dT} = -\\beta k_0 (1+\\beta T)^{-2}$.\n\nThe non-zero partial derivatives of $R_i$ with respect to the unknown temperatures are:\n\n*   **Sub-diagonal ($J_{i,i-1}$)**: For $i \\in \\{2, \\dots, N-2\\}$\n    $$\n    \\frac{\\partial R_i}{\\partial T_{i-1}} = \\frac{1}{\\Delta z^2} \\frac{\\partial}{\\partial T_{i-1}} \\left[ -k_{i-1/2}(T_i - T_{i-1}) \\right] = \\frac{1}{\\Delta z^2} \\left[ -\\frac{1}{2}k'_{i-1/2}(T_i - T_{i-1}) + k_{i-1/2} \\right]\n    $$\n*   **Main diagonal ($J_{i,i}$)**: For $i \\in \\{1, \\dots, N-2\\}$\n    $$\n    \\frac{\\partial R_i}{\\partial T_i} = \\frac{1}{\\Delta z^2} \\frac{\\partial}{\\partial T_i} \\left[ k_{i+1/2}(T_{i+1}-T_i) - k_{i-1/2}(T_i - T_{i-1}) \\right] \\\\\n    = \\frac{1}{\\Delta z^2} \\left[ \\frac{1}{2}k'_{i+1/2}(T_{i+1}-T_i) - k_{i+1/2} - \\frac{1}{2}k'_{i-1/2}(T_i - T_{i-1}) - k_{i-1/2} \\right]\n    $$\n*   **Super-diagonal ($J_{i,i+1}$)**: For $i \\in \\{1, \\dots, N-3\\}$\n    $$\n    \\frac{\\partial R_i}{\\partial T_{i+1}} = \\frac{1}{\\Delta z^2} \\frac{\\partial}{\\partial T_{i+1}} \\left[ k_{i+1/2}(T_{i+1}-T_i) \\right] = \\frac{1}{\\Delta z^2} \\left[ \\frac{1}{2}k'_{i+1/2}(T_{i+1}-T_i) + k_{i+1/2} \\right]\n    $$\n\nThis tridiagonal system $J\\delta\\mathbf{T} = -\\mathbf{R}$ can be solved efficiently in $O(N)$ time using an algorithm such as the Thomas algorithm, available in `scipy.linalg.solve_banded`.\n\n**4. Physical Parameters and Post-processing**\n\nThe thickness of the lithosphere, $L$, is determined by the thermal diffusion length scale for a plate of age $t=30$ million years. With $1 \\text{ yr} = 365.25 \\times 86400 \\text{ s}$, we calculate $t$ in seconds.\n$$\nL = 2\\sqrt{\\kappa t}\n$$\nwhere $\\kappa=1.0\\times 10^{-6}\\ \\text{m}^2\\,\\text{s}^{-1}$.\n\nAfter converging to the final temperature profile $T(z)$, we compute the required quantities. The upward heat flux magnitude at the seafloor ($z=0$) is computed from the solved near-surface temperature gradient:\n$$\nq_{\\text{nl}} = \\left| -k\\left(\\frac{T_0 + T_1}{2}\\right) \\frac{T_1 - T_0}{\\Delta z} \\right| = k\\left(\\frac{T_s + T_1}{2}\\right) \\frac{T_1 - T_s}{\\Delta z}\n$$\nThe reference heat flux for a constant conductivity $k_{\\text{const}} = k(T_s)$ is:\n$$\nq_{\\text{const}} = \\frac{k_{\\text{const}}(T_m - T_s)}{L}\n$$\nThe relative error is then calculated as:\n$$\nE = \\frac{q_{\\text{const}} - q_{\\text{nl}}}{q_{\\text{nl}}}\n$$\nThis procedure is repeated for each of the three test cases (A, B, C) specified in the problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\n# Define global constants\nT_YR_TO_S = 365.25 * 24.0 * 3600.0\n\ndef solve_case(k0, beta, Ts, Tm, N, kappa, t_myr):\n    \"\"\"\n    Solves the 1D steady-state heat conduction problem for a single parameter set.\n    \n    Args:\n        k0 (float): Thermal conductivity constant (W/m/K).\n        beta (float): Temperature dependence of conductivity (1/K).\n        Ts (float): Surface temperature (K).\n        Tm (float): Mantle temperature (K).\n        N (int): Number of grid points.\n        kappa (float): Thermal diffusivity (m^2/s).\n        t_myr (float): Age of the lithosphere (million years).\n\n    Returns:\n        tuple: A tuple containing q_nl, q_const, and E.\n    \"\"\"\n    # 1. Define physical and numerical parameters\n    t_s = t_myr * 1e6 * T_YR_TO_S\n    L = 2.0 * np.sqrt(kappa * t_s)\n    dz = L / (N - 1.0)\n    num_unknowns = N - 2\n    convergence_tol = 1e-10\n\n    # 2. Define temperature-dependent functions for conductivity\n    def k_func(T):\n        return k0 / (1.0 + beta * T)\n\n    def k_prime_func(T):\n        return -beta * k0 / (1.0 + beta * T)**2\n\n    # 3. Initial guess for temperature profile (linear)\n    T = np.linspace(Ts, Tm, N, dtype=np.float64)\n\n    # 4. Newton-Raphson iteration\n    max_iterations = 50 # A safeguard against non-convergence\n    for _ in range(max_iterations):\n        # We solve for the `num_unknowns` interior points T[1]...T[N-2]\n        # The full vector T is T[0]...T[N-1]\n        \n        # Assemble the residual vector R for interior nodes i=1...N-2\n        R = np.zeros(num_unknowns, dtype=np.float64)\n        \n        T_int = T[1:-1]\n        T_plus = T[2:]\n        T_minus = T[:-2]\n        \n        T_mid_right = (T_int + T_plus) / 2.0\n        T_mid_left = (T_minus + T_int) / 2.0\n        \n        k_right = k_func(T_mid_right)\n        k_left = k_func(T_mid_left)\n        \n        R = (k_right * (T_plus - T_int) - k_left * (T_int - T_minus)) / dz**2\n\n        # Check for convergence\n        inf_norm_R = np.max(np.abs(R))\n        if inf_norm_R < convergence_tol:\n            break\n\n        # Assemble the Jacobian matrix J (tridiagonal)\n        # J is (_num_unknowns x num_unknowns)\n        J_banded = np.zeros((3, num_unknowns), dtype=np.float64)\n        \n        k_prime_right = k_prime_func(T_mid_right)\n        k_prime_left = k_prime_func(T_mid_left)\n\n        # Main diagonal\n        term1 = 0.5 * k_prime_right * (T_plus - T_int) - k_right\n        term2 = -0.5 * k_prime_left * (T_int - T_minus) - k_left\n        J_banded[1, :] = (term1 + term2) / dz**2\n\n        # Super-diagonal\n        J_banded[0, 1:] = (0.5 * k_prime_right[:-1] * (T_plus[:-1] - T_int[:-1]) + k_right[:-1]) / dz**2\n        \n        # Sub-diagonal\n        J_banded[2, :-1] = (-0.5 * k_prime_left[1:] * (T_int[1:] - T_minus[1:]) + k_left[1:]) / dz**2\n      \n        # Solve the linear system J * delta_T = -R\n        delta_T = solve_banded((1, 1), J_banded, -R)\n        \n        # Update the temperature vector\n        T[1:-1] += delta_T\n\n    # 5. Post-processing and output calculation\n    # Nonlinear heat flux magnitude (upward)\n    T0, T1 = T[0], T[1]\n    q_nl = k_func((T0 + T1) / 2.0) * (T1 - T0) / dz\n    \n    # Constant-conductivity heat flux\n    k_const = k_func(Ts)\n    q_const = k_const * (Tm - Ts) / L\n    \n    # Relative error\n    # Handle the case where q_nl is zero to avoid division by zero\n    if q_nl == 0.0:\n        E = 0.0 if q_const == 0.0 else np.inf\n    else:\n        E = (q_const - q_nl) / q_nl\n    \n    return q_nl, q_const, E\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: baseline \"happy path\"\n        {'k0': 3.2, 'beta': 4.0e-4, 'Ts': 273.0, 'Tm': 1573.0, 'N': 101, 'kappa': 1.0e-6, 't_myr': 30.0},\n        # Case B: negligible temperature dependence\n        {'k0': 3.2, 'beta': 0.0, 'Ts': 273.0, 'Tm': 1573.0, 'N': 101, 'kappa': 1.0e-6, 't_myr': 30.0},\n        # Case C: strong temperature dependence and refined grid\n        {'k0': 3.2, 'beta': 1.0e-3, 'Ts': 273.0, 'Tm': 1573.0, 'N': 201, 'kappa': 1.0e-6, 't_myr': 30.0},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        qnl, qconst, E = solve_case(**case_params)\n        results.extend([qnl, qconst, E])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A primary goal of geophysics is to infer Earth's subsurface properties from surface observations. This final practice moves from forward modeling to the exciting realm of inverse problems, where you will estimate the mechanical strength of the lithosphere—its Effective Elastic Thickness ($T_e$). Using the theory of flexure, which links surface topography to the gravity field, you will build a program to invert synthetic admittance data to find the most likely $T_e$ . This capstone exercise will introduce you to powerful concepts like maximum likelihood estimation and uncertainty quantification, bridging the gap between physical theory and practical data interpretation.",
            "id": "3611244",
            "problem": "You are tasked with implementing a self-contained program that performs a maximum likelihood inversion for the Effective Elastic Thickness (EET) denoted by $T_e$ of a uniform elastic lithospheric plate, using synthetic band-averaged gravity-topography admittance observations generated from a physically grounded flexural model with known Gaussian noise. You must then quantify the resolution of the $T_e$ estimate as a function of wavenumber band using the Fisher Information (FI). The scenario draws from linear plate flexure and gravitational potential theory, and you must strictly adhere to the specifications described below.\n\nThe fundamental base of this problem consists of the following well-tested and widely used laws and definitions:\n- Linear elastic plate flexure under vertical loading: the vertical deflection $w(x,y)$ of a thin elastic plate of flexural rigidity $D$ floating on a fluid half-space of density $\\rho_m$ obeys the biharmonic balance with buoyancy. In the spectral domain with radial wavenumber $k$ (in radians per meter), the force balance under surface load $q_s$ is\n$$\n\\left(D k^4 + \\rho_m g\\right)\\, w(k) = q_s(k),\n$$\nwhere $g$ is gravitational acceleration.\n- The flexural rigidity of a plate of EET $T_e$ is\n$$\nD = \\frac{E T_e^3}{12 \\left(1 - \\nu^2\\right)},\n$$\nwith Young's modulus $E$ and Poisson's ratio $\\nu$.\n- For a topographic surface load of amplitude $h(k)$ and rock density $\\rho_c$, the spectral load is $q_s(k) = \\rho_c g\\, h(k)$, and the corresponding deflection is\n$$\nw(k) = \\frac{\\rho_c g}{D k^4 + \\rho_m g}\\, h(k).\n$$\n- The band-averaged free-air gravity-topography admittance $Z(k;T_e)$ (gravity per unit topography amplitude), assuming contributions from surface topography with density contrast $\\Delta \\rho_t$ and Moho relief with density contrast $\\Delta \\rho_m$ upward continued from depth $z_m$, is modeled as\n$$\nZ(k;T_e) = 2\\pi G\\left[\\Delta \\rho_t + \\Delta \\rho_m\\, e^{-k z_m}\\, \\frac{\\rho_c g}{D k^4 + \\rho_m g}\\right],\n$$\nwhere $G$ is the universal gravitational constant. This model assumes surface loading only, linear response, and small slopes.\n\nYou must implement the following steps to produce the requested outputs:\n1. Define the physical constants and parameters using the units specified:\n   - $E = 70\\times 10^9$ pascals (newtons per square meter),\n   - $\\nu = 0.25$,\n   - $\\rho_c = 2700$ kilograms per cubic meter,\n   - $\\rho_m = 3300$ kilograms per cubic meter,\n   - $\\Delta \\rho_t = 2700$ kilograms per cubic meter,\n   - $\\Delta \\rho_m = 600$ kilograms per cubic meter,\n   - $g = 9.81$ meters per second squared,\n   - $G = 6.67430\\times 10^{-11}$ cubic meters per kilogram per second squared,\n   - $z_m = 35\\times 10^3$ meters.\n2. For each wavenumber band, compute $Z(k;T_e)$ using the formula above and form a band-mean admittance $\\mu_j(T_e)$ by averaging $Z(k;T_e)$ over $k$ uniformly sampled across the band.\n3. Generate synthetic band-averaged observations $\\hat{Z}_j$ by evaluating $\\mu_j(T_e^\\text{true})$ and adding zero-mean Gaussian noise with known standard deviation $\\sigma_j$ for the band.\n4. For each band independently, perform a maximum likelihood inversion for $T_e$ using a one-dimensional grid search over $T_e \\in [2, 60]$ kilometers. Assume the observation model is Gaussian:\n$$\n\\ln \\mathcal{L}(T_e\\,|\\,\\hat{Z}_j) = -\\frac{1}{2}\\,\\frac{\\left(\\hat{Z}_j - \\mu_j(T_e)\\right)^2}{\\sigma_j^2} + \\text{constant}.\n$$\nReturn the maximum likelihood estimate $\\widehat{T}_{e,j}$ for each band.\n5. Quantify resolution per band using Fisher Information for the single band-mean observation:\n$$\n\\mathcal{I}_j(T_e) = \\frac{1}{\\sigma_j^2}\\left(\\frac{\\partial \\mu_j(T_e)}{\\partial T_e}\\right)^2,\n$$\nand compute the Cramér–Rao lower bound on the standard deviation as\n$$\n\\sigma_{T_e,j} = \\mathcal{I}_j\\left(\\widehat{T}_{e,j}\\right)^{-1/2}.\n$$\nUse a numerically stable finite difference to approximate the derivative at $\\widehat{T}_{e,j}$.\n\nUnits:\n- You must report all $T_e$ values and resolution values in kilometers. Wavenumber $k$ is in radians per meter, gravity-topography admittance $Z$ is in inverse seconds squared.\n\nYour program must implement the above for the following test suite of cases, each with three wavenumber bands and specified noise:\n- Wavenumber bands (sample uniformly in $k$):\n  - Band 1 (long wavelength): $\\lambda \\in [200\\times 10^3,\\, 500\\times 10^3]$ meters, i.e., $k \\in \\left[\\frac{2\\pi}{500\\times 10^3},\\, \\frac{2\\pi}{200\\times 10^3}\\right]$ radians per meter.\n  - Band 2 (mid wavelength): $\\lambda \\in [80\\times 10^3,\\, 200\\times 10^3]$ meters, i.e., $k \\in \\left[\\frac{2\\pi}{200\\times 10^3},\\, \\frac{2\\pi}{80\\times 10^3}\\right]$ radians per meter.\n  - Band 3 (short wavelength): $\\lambda \\in [40\\times 10^3,\\, 80\\times 10^3]$ meters, i.e., $k \\in \\left[\\frac{2\\pi}{80\\times 10^3},\\, \\frac{2\\pi}{40\\times 10^3}\\right]$ radians per meter.\n  - For each band, use $64$ uniformly spaced samples in $k$.\n- Test Case A (happy path): $T_e^\\text{true} = 25$ kilometers; noise standard deviations $(\\sigma_1, \\sigma_2, \\sigma_3) = (1.0\\times 10^{-8},\\, 1.5\\times 10^{-8},\\, 2.0\\times 10^{-8})$ inverse seconds squared.\n- Test Case B (thin plate, low noise): $T_e^\\text{true} = 5$ kilometers; $(\\sigma_1, \\sigma_2, \\sigma_3) = (1.0\\times 10^{-9},\\, 1.0\\times 10^{-9},\\, 1.0\\times 10^{-9})$ inverse seconds squared.\n- Test Case C (thick plate, high noise): $T_e^\\text{true} = 50$ kilometers; $(\\sigma_1, \\sigma_2, \\sigma_3) = (5.0\\times 10^{-8},\\, 5.0\\times 10^{-8},\\, 5.0\\times 10^{-8})$ inverse seconds squared.\n\nNumerical requirements:\n- Use a reproducible random number generator with a fixed seed to create noise realizations.\n- Use a $T_e$ search grid from $2$ to $60$ kilometers with a spacing of $0.1$ kilometers.\n- Finite difference step for derivative evaluation at the maximum likelihood estimate must be $0.1$ kilometers, with boundary-safe handling.\n\nFinal output format:\n- For each test case, independently report a list containing, in order for bands $1$, $2$, and $3$: the maximum likelihood estimate $\\widehat{T}_{e,j}$ (in kilometers) and the resolution $\\sigma_{T_e,j}$ (in kilometers) for that band. Aggregate the three test-case lists into a single list and print them on a single line as a comma-separated list enclosed in square brackets. For example,\n\"[[Te_hat_band1_caseA,res_band1_caseA,Te_hat_band2_caseA,res_band2_caseA,Te_hat_band3_caseA,res_band3_caseA],[...caseB...],[...caseC...]]\".",
            "solution": "The user-provided problem is deemed valid. It is scientifically grounded in established principles of computational geophysics, specifically the theory of lithospheric flexure and gravitational potential fields. The problem is well-posed, providing a complete and consistent set of physical constants, governing equations, and numerical parameters necessary to compute a unique solution. The objectives and methodology are stated with scientific and mathematical precision, leaving no room for ambiguity.\n\nThe solution will be implemented by following a structured, principle-based approach. First, we will establish the theoretical forward model for gravity-topography admittance. Second, we will detail the numerical procedure for generating synthetic data. Third, we will describe the maximum likelihood inversion via a grid search to estimate the Effective Elastic Thickness ($T_e$). Finally, we will outline the method for quantifying the resolution of the estimate using the Fisher Information and the Cramér-Rao Lower Bound.\n\n**1. Theoretical Framework: The Forward Model**\n\nThe core of the problem is the forward model that predicts the gravity-topography admittance $Z$ as a function of wavenumber $k$ and Effective Elastic Thickness $T_e$.\n\nThe model begins with the flexural rigidity, $D$, of a thin elastic plate, which quantifies its resistance to bending. For a plate with Young's modulus $E$, Poisson's ratio $\\nu$, and an effective elastic thickness $T_e$, the flexural rigidity is given by:\n$$\nD(T_e) = \\frac{E T_e^3}{12 (1 - \\nu^2)}\n$$\nHere, $T_e$ is provided in kilometers but must be converted to meters for dimensional consistency in physical calculations.\n\nWhen a surface load $q_s(k)$ (in the spectral domain) is applied, the plate deflects vertically. This deflection is balanced by the internal elastic stresses of the plate and the buoyancy forces from the underlying fluid mantle. For a plate floating on a fluid of density $\\rho_m$ under gravitational acceleration $g$, the vertical deflection $w(k)$ is related to the load by:\n$$\n\\left(D k^4 + \\rho_m g\\right) w(k) = q_s(k)\n$$\nwhere $k$ is the radial wavenumber. This equation represents the force balance in the spectral domain.\n\nFor a surface topographic load of amplitude $h(k)$ and density $\\rho_c$, the load is $q_s(k) = \\rho_c g h(k)$. Substituting this into the balance equation, we can solve for the ratio of deflection to topography, which represents the isostatic compensation:\n$$\n\\frac{w(k)}{h(k)} = \\frac{\\rho_c g}{D(T_e) k^4 + \\rho_m g}\n$$\n\nThe free-air gravity-topography admittance, $Z(k; T_e)$, is the ratio of the gravity anomaly to the topographic height. It arises from two main sources: the mass of the surface topography itself and the mass deficit from the compensating Moho deflection $w(k)$. The model provided is:\n$$\nZ(k; T_e) = 2\\pi G \\left[ \\Delta \\rho_t + \\Delta \\rho_m e^{-k z_m} \\frac{w(k)}{h(k)} \\right]\n$$\nSubstituting the expression for $w(k)/h(k)$ yields the complete forward model for admittance at a specific wavenumber $k$:\n$$\nZ(k; T_e) = 2\\pi G \\left[ \\Delta \\rho_t + \\Delta \\rho_m e^{-k z_m} \\frac{\\rho_c g}{D(T_e) k^4 + \\rho_m g} \\right]\n$$\nwhere $G$ is the gravitational constant, $\\Delta \\rho_t$ is the density contrast of the topography with respect to the surrounding medium (air, so $\\Delta \\rho_t = \\rho_c$), $\\Delta \\rho_m$ is the density contrast across the Moho, and $z_m$ is the mean depth of the Moho. The term $e^{-k z_m}$ is the upward continuation operator, which accounts for the attenuation of the gravitational signal from the Moho at depth $z_m$ to the surface.\n\nFinally, for each wavenumber band $j$, a band-averaged admittance $\\mu_j(T_e)$ is computed by taking the arithmetic mean of $Z(k; T_e)$ over a set of $N_k=64$ wavenumbers sampled uniformly within that band.\n\n**2. Synthetic Data Generation**\n\nTo test the inversion method, we first generate synthetic \"observed\" data. For a given test case with a known true elastic thickness, $T_e^{\\text{true}}$, and specified noise standard deviations $(\\sigma_1, \\sigma_2, \\sigma_3)$, we perform the following for each band $j$:\n1.  Calculate the true band-averaged admittance $\\mu_j(T_e^{\\text{true}})$ using the forward model described above.\n2.  Generate a random number from a zero-mean Gaussian (normal) distribution with the specified standard deviation $\\sigma_j$. This is achieved using a seeded random number generator for reproducibility.\n3.  The synthetic observation for band $j$ is then $\\hat{Z_j} = \\mu_j(T_e^{\\text{true}}) + \\text{noise}$.\n\n**3. Maximum Likelihood Estimation of $T_e$**\n\nThe goal is to find the value of $T_e$ that best explains the synthetic observation $\\hat{Z_j}$. Assuming the noise is Gaussian, the likelihood of observing $\\hat{Z_j}$ given a model parameter $T_e$ is:\n$$\n\\mathcal{L}(T_e | \\hat{Z_j}) \\propto \\exp\\left(-\\frac{1}{2}\\frac{(\\hat{Z_j} - \\mu_j(T_e))^2}{\\sigma_j^2}\\right)\n$$\nMaximizing the likelihood $\\mathcal{L}$ (or its logarithm, $\\ln\\mathcal{L}$) is equivalent to minimizing the squared residual term $R(T_e) = (\\hat{Z_j} - \\mu_j(T_e))^2$.\n\nWe perform this minimization using a one-dimensional grid search. A grid of candidate $T_e$ values is created, ranging from $2$ to $60$ km with a step of $0.1$ km. For each band $j$, we compute the model prediction $\\mu_j(T_e)$ for every $T_e$ on this grid. We then calculate the squared residual for each grid point and identify the $T_e$ value that yields the minimum residual. This value is our maximum likelihood estimate, $\\widehat{T}_{e,j}$.\n\n**4. Resolution Analysis via Fisher Information**\n\nThe resolution of our estimate $\\widehat{T}_{e,j}$ quantifies how well the data constrains the parameter. A high resolution (low uncertainty) means that small changes in $T_e$ produce large changes in the predicted admittance, making the parameter easy to pinpoint. We quantify this using the Fisher Information, $\\mathcal{I}_j(T_e)$. For a single Gaussian observation, it is defined as:\n$$\n\\mathcal{I}_j(T_e) = \\left( \\frac{\\partial \\mu_j(T_e)}{\\partial T_e} \\right)^2 \\frac{1}{\\sigma_j^2}\n$$\nThe derivative $\\frac{\\partial \\mu_j(T_e)}{\\partial T_e}$ measures the sensitivity of the model to changes in $T_e$.\n\nThe Cramér-Rao Lower Bound (CRLB) states that the variance of any unbiased estimator of $T_e$ is at least the inverse of the Fisher Information. We use the standard deviation from the CRLB as our measure of resolution:\n$$\n\\sigma_{T_e,j} = \\sqrt{\\text{Var}(\\widehat{T}_{e,j})} \\ge \\mathcal{I}_j(T_e)^{-1/2}\n$$\nWe compute this bound at our estimate $\\widehat{T}_{e,j}$: $\\sigma_{T_e,j} = \\mathcal{I}_j(\\widehat{T}_{e,j})^{-1/2}$.\n\nThe derivative $\\frac{\\partial \\mu_j}{\\partial T_e}$ is computed numerically using a finite difference scheme. Since we have already computed the model $\\mu_j(T_e)$ on a regular grid, and the specified finite difference step ($0.1$ km) matches the grid spacing, we can efficiently approximate the derivative at the grid point corresponding to $\\widehat{T}_{e,j}$ using its neighbors. A central difference is used for interior points, while forward or backward differences are used at the grid boundaries to ensure stability. The derivative with respect to $T_e$ in kilometers is used, so the resulting resolution $\\sigma_{T_e,j}$ is also in kilometers.\n\nThe implementation encapsulates these steps, processing each test case and each band independently, and formats the final results as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs maximum likelihood inversion for Effective Elastic Thickness (EET)\n    and quantifies resolution using Fisher Information.\n    \"\"\"\n\n    # 1. Define physical constants and parameters in SI units\n    CONSTANTS = {\n        'E': 70e9,             # Young's modulus (Pa)\n        'nu': 0.25,            # Poisson's ratio\n        'rho_c': 2700.,        # Crust/load density (kg/m^3)\n        'rho_m': 3300.,        # Mantle density (kg/m^3)\n        'Delta_rho_t': 2700.,  # Topography density contrast (kg/m^3)\n        'Delta_rho_m': 600.,   # Moho density contrast (kg/m^3)\n        'g': 9.81,             # Gravitational acceleration (m/s^2)\n        'G': 6.67430e-11,      # Gravitational constant (m^3/kg/s^2)\n        'z_m': 35e3,           # Mean Moho depth (m)\n    }\n\n    # Define wavenumber bands and test cases\n    BANDS = [\n        (2 * np.pi / 500e3, 2 * np.pi / 200e3),  # Band 1: 200-500 km wavelength\n        (2 * np.pi / 200e3, 2 * np.pi / 80e3),   # Band 2: 80-200 km wavelength\n        (2 * np.pi / 80e3, 2 * np.pi / 40e3),    # Band 3: 40-80 km wavelength\n    ]\n    N_K_SAMPLES = 64\n\n    TEST_CASES = {\n        'A': {'Te_true_km': 25.0, 'sigmas': (1.0e-8, 1.5e-8, 2.0e-8)},\n        'B': {'Te_true_km': 5.0,  'sigmas': (1.0e-9, 1.0e-9, 1.0e-9)},\n        'C': {'Te_true_km': 50.0, 'sigmas': (5.0e-8, 5.0e-8, 5.0e-8)},\n    }\n    \n    # Numerical parameters for inversion\n    TE_GRID_KM = np.linspace(2.0, 60.0, int((60.0 - 2.0) / 0.1) + 1)\n    FD_STEP_KM = 0.1\n\n    # Initialize a reproducible random number generator\n    RNG = np.random.default_rng(seed=42)\n\n    def calculate_band_mean_admittance(k_range, Te_km, n_samples, consts):\n        \"\"\"\n        Computes the band-averaged gravity-topography admittance for a given Te.\n        \"\"\"\n        Te_m = Te_km * 1000.0  # Convert Te from km to m\n        _E, _nu, _rho_c, _rho_m, _Delta_rho_t, _Delta_rho_m, _g, _G, _z_m = (\n            consts['E'], consts['nu'], consts['rho_c'], consts['rho_m'],\n            consts['Delta_rho_t'], consts['Delta_rho_m'], consts['g'], \n            consts['G'], consts['z_m']\n        )\n\n        # Flexural rigidity D\n        D = (_E * Te_m**3) / (12 * (1 - _nu**2))\n\n        # Wavenumber samples for the band\n        k_vec = np.linspace(k_range[0], k_range[1], n_samples)\n        \n        # Admittance model Z(k; Te)\n        flexure_term = (_rho_c * _g) / (D * k_vec**4 + _rho_m * _g)\n        Z_k = 2 * np.pi * _G * (_Delta_rho_t + _Delta_rho_m * np.exp(-k_vec * _z_m) * flexure_term)\n\n        # Band-averaged admittance mu\n        return np.mean(Z_k)\n\n    all_results = []\n    \n    for case_id in ['A', 'B', 'C']:\n        case = TEST_CASES[case_id]\n        Te_true_km = case['Te_true_km']\n        sigmas = case['sigmas']\n        \n        case_results = []\n        \n        for band_idx, (k_range, sigma_j) in enumerate(zip(BANDS, sigmas)):\n            \n            # --- Generate Synthetic Data ---\n            mu_true = calculate_band_mean_admittance(k_range, Te_true_km, N_K_SAMPLES, CONSTANTS)\n            noise = RNG.normal(loc=0.0, scale=sigma_j)\n            Z_hat_j = mu_true + noise\n\n            # --- Maximum Likelihood Inversion (Grid Search) ---\n            mu_grid = np.array([\n                calculate_band_mean_admittance(k_range, te, N_K_SAMPLES, CONSTANTS) for te in TE_GRID_KM\n            ])\n            \n            residuals_sq = (Z_hat_j - mu_grid)**2\n            best_idx = np.argmin(residuals_sq)\n            Te_hat_km = TE_GRID_KM[best_idx]\n\n            # --- Quantify Resolution using Fisher Information ---\n            # Use pre-computed grid for efficient finite difference\n            if best_idx == 0:  # Forward difference at lower boundary\n                dmu_dTe = (mu_grid[1] - mu_grid[0]) / FD_STEP_KM\n            elif best_idx == len(TE_GRID_KM) - 1:  # Backward difference at upper boundary\n                dmu_dTe = (mu_grid[best_idx] - mu_grid[best_idx - 1]) / FD_STEP_KM\n            else:  # Central difference for interior points\n                dmu_dTe = (mu_grid[best_idx + 1] - mu_grid[best_idx - 1]) / (2 * FD_STEP_KM)\n\n            fisher_info = (dmu_dTe**2) / (sigma_j**2)\n\n            if fisher_info > 1e-30: # Avoid division by zero for flat likelihoods\n                resolution_km = 1.0 / np.sqrt(fisher_info)\n            else:\n                resolution_km = np.inf # Unconstrained\n\n            case_results.extend([Te_hat_km, resolution_km])\n            \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    case_strs = []\n    for res_list in all_results:\n        # Using repr to get good precision without scientific notation for these numbers\n        case_strs.append(f\"[{','.join(map(repr, res_list))}]\")\n    print(f\"[{','.join(case_strs)}]\")\n\nsolve()\n```"
        }
    ]
}