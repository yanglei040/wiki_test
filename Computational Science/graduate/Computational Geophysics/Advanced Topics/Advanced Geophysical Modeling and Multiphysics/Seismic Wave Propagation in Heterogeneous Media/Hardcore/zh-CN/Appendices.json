{
    "hands_on_practices": [
        {
            "introduction": "在模拟地震波传播之前，我们必须首先建立其控制数学模型。这个基础性练习 () 将引导您从连续介质力学的第一性原理出发，为一个简单但富有说明性的非均匀介质推导弹性波方程。通过正确定义偏微分方程和界面上的传输条件，您将对不同地质层之间如何发生物理相互作用，以及这些相互作用如何在问题的强形式中得到数学表达，建立起坚实的理解。",
            "id": "3614112",
            "problem": "考虑一个由两个均匀半空间组成的二维、平面应变、各向同性、线性弹性的非均匀介质，两个半空间被位于 $y=0$ 的水平界面分开。区域 $\\Omega_{1}$ 是上半空间 $\\{(x,y)\\in\\mathbb{R}^{2}: y>0\\}$，其常数质量密度为 $\\rho_{1}$，第一 Lamé 参数为 $\\lambda_{1}$，剪切模量为 $\\mu_{1}$。区域 $\\Omega_{2}$ 是下半空间 $\\{(x,y)\\in\\mathbb{R}^{2}: y<0\\}$，其常数质量密度为 $\\rho_{2}$，第一 Lamé 参数为 $\\lambda_{2}$，剪切模量为 $\\mu_{2}$。令 $\\mathbf{u}(x,y,t)$ 表示位移场。假设没有体力。介质参数如下：\n- $\\rho_{1} = 2200$ kg/m³，$\\lambda_{1} = 5.0\\times 10^{9}$ Pa，$\\mu_{1} = 3.0\\times 10^{9}$ Pa，\n- $\\rho_{2} = 2700$ kg/m³，$\\lambda_{2} = 3.0\\times 10^{10}$ Pa，$\\mu_{2} = 3.0\\times 10^{10}$ Pa。\n\n任务：\n1) 从线性动量守恒、线性化运动学和各向同性 Hooke 定律出发，推导在每个区域 $\\Omega_{i}$ ($i\\in\\{1,2\\}$) 中关于 $\\mathbf{u}(x,y,t)$ 的强形式控制偏微分方程(PDE)。方程应以空间微分算子的形式表示，并明确其对各区域常数参数 $\\rho_{i}$、$\\lambda_{i}$ 和 $\\mu_{i}$ 的依赖关系。\n2) 以位移和 Cauchy 应力矢量的跳跃条件的形式，陈述在界面 $y=0$ 处符合物理的传输条件。\n3) 仅使用给定的 $\\rho_{i}$、$\\lambda_{i}$ 和 $\\mu_{i}$，计算每个区域 $\\Omega_{i}$ 的局部压缩波波速 $v_{p,i}$ 和剪切波波速 $v_{s,i}$。速度以米/秒为单位表示，并将答案四舍五入至四位有效数字。\n\n答案规格：以行矩阵的形式提供最终数值答案，顺序为 $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2})$。速度以米/秒为单位表示。四舍五入至四位有效数字。最终答案的矩阵内只能包含数字，不带单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第1步：提取已知条件\n- **介质描述**：二维、平面应变、各向同性、线性弹性、非均匀。\n- **几何形状**：两个均匀半空间，由位于 $y=0$ 的水平界面隔开。\n- **区域 $\\Omega_{1}$**：上半空间，$\\{(x,y)\\in\\mathbb{R}^{2}: y>0\\}$。\n  - 质量密度：$\\rho_{1} = 2200$ kg/m³\n  - 第一 Lamé 参数：$\\lambda_{1} = 5.0\\times 10^{9}$ Pa\n  - 剪切模量：$\\mu_{1} = 3.0\\times 10^{9}$ Pa\n- **区域 $\\Omega_{2}$**：下半空间，$\\{(x,y)\\in\\mathbb{R}^{2}: y<0\\}$。\n  - 质量密度：$\\rho_{2} = 2700$ kg/m³\n  - 第一 Lamé 参数：$\\lambda_{2} = 3.0\\times 10^{10}$ Pa\n  - 剪切模量：$\\mu_{2} = 3.0\\times 10^{10}$ Pa\n- **场变量**：位移场 $\\mathbf{u}(x,y,t)$。\n- **假设**：无体力。\n- **任务**：\n  1. 推导每个区域 $\\Omega_{i}$ 中关于 $\\mathbf{u}(x,y,t)$ 的强形式控制偏微分方程。\n  2. 陈述界面 $y=0$ 处的传输条件。\n  3. 计算每个区域的压缩波波速 $v_{p,i}$ 和剪切波波速 $v_{s,i}$。\n- **答案规格**：一个行矩阵 $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2})$，速度单位为 m/s，四舍五入至四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学依据**：该问题是弹性动力学和地震学中的一个经典设置，基于连续介质力学的基本原理：线性动量守恒、线性化运动学和各向同性材料的 Hooke 定律。所提供的材料参数($\\rho_{i}$, $\\lambda_{i}$, $\\mu_{i}$)对于地壳岩石是符合物理现实的。该问题在科学上是合理的。\n- **适定的**：这三个任务定义明确，并能得出唯一且有意义的解。波动方程的推导、界面条件的陈述以及波速的计算是该领域的标准程序。\n- **客观的**：问题陈述使用了来自连续介质力学和波动物理学的精确、明确和标准的术语。\n- **完整性和一致性**：问题提供了完成所有指定任务所需的全部材料参数($\\rho_{i}$, $\\lambda_{i}$, $\\mu_{i}$)。所提供的信息中没有矛盾之处。\n\n### 第3步：结论和行动\n该问题是**有效的**，因为它在科学上合理、适定、客观且自洽。现在将开始求解过程。\n\n---\n\n### 解答\n通过完成三个指定的任务来解决该问题。\n\n#### 1. 控制偏微分方程的推导\n\n弹性波动方程的推导始于连续介质力学的三个基本原理。我们首先对一个具有参数 $\\rho$、$\\lambda$ 和 $\\mu$ 的通用均匀区域进行推导，然后将其应用于区域 $\\Omega_{1}$ 和 $\\Omega_{2}$。\n\n1.  **线性动量守恒 (Cauchy 第一运动定律)**：在没有体力的情况下，线性动量守恒表示为：\n    $$ \\nabla \\cdot \\boldsymbol{\\sigma} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n    其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\rho$ 是质量密度，$\\mathbf{u}$ 是位移矢量，$t$ 是时间。\n\n2.  **线性化运动学 (应变-位移关系)**：线性化（或小）应变张量 $\\boldsymbol{\\varepsilon}$ 与位移场 $\\mathbf{u}$ 的关系为：\n    $$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right] $$\n\n3.  **本构定律 (各向同性 Hooke 定律)**：对于线性、各向同性、弹性材料，应力张量 $\\boldsymbol{\\sigma}$ 与应变张量 $\\boldsymbol{\\varepsilon}$ 的关系为：\n    $$ \\boldsymbol{\\sigma} = \\lambda (\\text{tr}(\\boldsymbol{\\varepsilon})) \\mathbf{I} + 2\\mu\\boldsymbol{\\varepsilon} $$\n    其中 $\\lambda$ 和 $\\mu$ 是 Lamé 参数，$\\mathbf{I}$ 是二阶单位张量。应变张量的迹等于位移的散度，即 $\\text{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$。\n\n我们现在将这三个方程结合起来。首先，将应变-位移关系代入本构定律：\n$$ \\boldsymbol{\\sigma} = \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + 2\\mu \\left( \\frac{1}{2} \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right] \\right) = \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + \\mu \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf.u})^T \\right] $$\n接下来，将这个应力表达式代入动量守恒方程：\n$$ \\nabla \\cdot \\left( \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + \\mu \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf.u})^T \\right] \\right) = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n散度算子作用于括号内的项。由于在每个区域内 $\\lambda$ 和 $\\mu$ 是常数：\n$$ \\nabla \\cdot (\\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I}) = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) $$\n$$ \\nabla \\cdot (\\mu[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]) = \\mu \\nabla \\cdot (\\nabla\\mathbf{u}) + \\mu \\nabla \\cdot ((\\nabla\\mathbf{u})^T) $$\n使用矢量微积分恒等式 $\\nabla \\cdot (\\nabla\\mathbf{u}) = \\nabla^2\\mathbf{u}$（矢量拉普拉斯算子）和 $\\nabla \\cdot ((\\nabla\\mathbf{u})^T) = \\nabla(\\nabla \\cdot \\mathbf{u})$，方程变为：\n$$ \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2\\mathbf{u} + \\mu \\nabla(\\nabla \\cdot \\mathbf.u}) = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n合并各项，我们得到强形式的控制偏微分方程，即 Navier 运动方程：\n$$ (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n该方程在每个均匀区域内均成立。对于两个区域 $\\Omega_{i}$ ($i \\in \\{1, 2\\}$)，偏微分方程为：\n- 在区域 $\\Omega_{1}$ ($y>0$) 中：\n$$ (\\lambda_{1} + \\mu_{1}) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu_{1} \\nabla^2 \\mathbf{u} = \\rho_{1} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n- 在区域 $\\Omega_{2}$ ($y<0$) 中：\n$$ (\\lambda_{2} + \\mu_{2}) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu_{2} \\nabla^2 \\mathbf{u} = \\rho_{2} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n\n#### 2. 界面 $y=0$ 处的传输条件\n\n假设两个半空间在界面 $y=0$ 处是完美粘合的。这意味着两个物理条件：\n1.  **位移连续性**：位移矢量必须跨界面连续，以确保不出现间隙或重叠。这意味着从区域 $\\Omega_{1}$ 逼近界面计算的位移矢量 $\\mathbf{u}$ 必须等于从区域 $\\Omega_{2}$ 逼近的值。在数学上，这表示为：\n    $$ \\mathbf{u}(x, y=0^+, t) = \\mathbf{u}(x, y=0^-, t) \\quad \\text{for all } x, t $$\n    使用跨界面的跳跃符号 $[\\![ \\psi ]\\!] = \\psi_{1} - \\psi_{2}$，该条件为在 $y=0$ 处 $[\\![ \\mathbf{u} ]\\!] = \\mathbf{0}$。\n\n2.  **应力连续性**：根据 Newton 第三定律，区域 $\\Omega_1$ 施加于区域 $\\Omega_2$ 的力必须与区域 $\\Omega_2$ 施加于 $\\Omega_1$ 的力大小相等、方向相反。这导致 Cauchy 应力矢量 $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$ 跨界面连续。指向 $\\Omega_1$ 且垂直于界面 $y=0$ 的单位法向量为 $\\mathbf{n} = (0, 1)^T$。应力连续性条件为：\n    $$ \\boldsymbol{\\sigma}_{1}(x, y=0^+, t) \\mathbf{n} = \\boldsymbol{\\sigma}_{2}(x, y=0^-, t) \\mathbf{n} \\quad \\text{for all } x, t $$\n    此处，$\\boldsymbol{\\sigma}_{1}$ 和 $\\boldsymbol{\\sigma}_{2}$ 分别是它们各自区域中的应力张量。用跳跃符号表示，即为在 $y=0$ 处 $[\\![ \\boldsymbol{\\sigma}\\mathbf{n} ]\\!] = \\mathbf{0}$。应力矢量的分量是 $t_x = \\sigma_{xy}$ 和 $t_y = \\sigma_{yy}$，因此该条件意味着剪应力 $\\sigma_{xy}$ 和正应力 $\\sigma_{yy}$ 均跨界面连续。\n\n#### 3. 波速计算\n\n在各向同性、线性弹性介质中，压缩波波速 ($v_p$) 和剪切波波速 ($v_s$) 由以下公式给出：\n$$ v_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}} $$\n$$ v_s = \\sqrt{\\frac{\\mu}{\\rho}} $$\n我们使用给定的参数将这些公式应用于每个区域。\n\n- **区域 $\\Omega_{1}$**：\n  - $\\rho_1 = 2200$ kg/m³\n  - $\\lambda_1 = 5.0 \\times 10^9$ Pa\n  - $\\mu_1 = 3.0 \\times 10^9$ Pa\n  \n  $$ v_{p,1} = \\sqrt{\\frac{\\lambda_1 + 2\\mu_1}{\\rho_1}} = \\sqrt{\\frac{5.0 \\times 10^9 + 2(3.0 \\times 10^9)}{2200}} = \\sqrt{\\frac{11.0 \\times 10^9}{2200}} = \\sqrt{5 \\times 10^6} \\approx 2236.0679.. \\text{ m/s} $$\n  四舍五入到四位有效数字，$v_{p,1} = 2236$ m/s。\n\n  $$ v_{s,1} = \\sqrt{\\frac{\\mu_1}{\\rho_1}} = \\sqrt{\\frac{3.0 \\times 10^9}{2200}} = \\sqrt{\\frac{15}{11} \\times 10^6} \\approx 1167.748... \\text{ m/s} $$\n  四舍五入到四位有效数字，$v_{s,1} = 1168$ m/s。\n\n- **区域 $\\Omega_{2}$**：\n  - $\\rho_2 = 2700$ kg/m³\n  - $\\lambda_2 = 3.0 \\times 10^{10}$ Pa\n  - $\\mu_2 = 3.0 \\times 10^{10}$ Pa\n\n  $$ v_{p,2} = \\sqrt{\\frac{\\lambda_2 + 2\\mu_2}{\\rho_2}} = \\sqrt{\\frac{3.0 \\times 10^{10} + 2(3.0 \\times 10^{10})}{2700}} = \\sqrt{\\frac{9.0 \\times 10^{10}}{2700}} = \\sqrt{\\frac{1}{3} \\times 10^8} \\approx 5773.5026.. \\text{ m/s} $$\n  四舍五入到四位有效数字，$v_{p,2} = 5774$ m/s。\n  \n  $$ v_{s,2} = \\sqrt{\\frac{\\mu_2}{\\rho_2}} = \\sqrt{\\frac{3.0 \\times 10^{10}}{2700}} = \\sqrt{\\frac{1}{9} \\times 10^8} = \\frac{1}{3} \\times 10^4 = 3333.333... \\text{ m/s} $$\n  四舍五入到四位有效数字，$v_{s,2} = 3333$ m/s。\n\n计算出的波速为 $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2}) = (2236, 1168, 5774, 3333)$ m/s。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2236  1168  5774  3333\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然波动方程提供了完整的物理描述，但直接求解它可能计算成本高昂。这个练习 () 介绍了一种强大的高频近似方法：射线理论。通过将费马原理 (Fermat's principle) 应用于一个具有线性速度梯度的介质，您将推导出射线路径和走时，从而深入了解地震射线在非均匀介质中如何弯曲，并学会如何分析地近似求解。",
            "id": "3614152",
            "problem": "考虑在非均匀介质中由程函方程控制的二维、各向同性的高频声波传播，其波速为 $v(x,y) = v_{0} \\left(1 + \\alpha x\\right)$，其中 $v_{0} > 0$ 是常数，$\\alpha$ 是一个小常数，在所考虑的传播距离上满足 $|\\alpha X| \\ll 1$。设波源位于 $\\left(0,0\\right)$，接收器位于 $\\left(X,Y\\right)$，其中 $X>0$ 且 $Y \\in \\mathbb{R}$。在高频极限下，射线遵循使走时平稳的路径，这与费马原理一致。沿路径 $\\gamma$ 的走时为 $T[\\gamma] = \\int_{\\gamma} s(\\mathbf{r}) \\,\\mathrm{d}\\ell$，其中 $s(\\mathbf{r}) = 1/v(\\mathbf{r})$ 是慢度，$\\mathrm{d}\\ell$ 是欧几里得线元。\n\n在 $\\alpha$ 的一阶近似下，使用费马原理和变分法来：\n- 推导一阶射线弯曲，表示为沿路径射线相对于 $x$ 轴的局部夹角 $\\theta(x)$，假设射线在从 $0$ 到 $X$ 的范围内，在 $x$ 方向上是单调的。\n- 推导从 $\\left(0,0\\right)$ 到 $\\left(X,Y\\right)$ 的一阶单程走时 $T$。\n\n你可以使用以下事实：(i) 程函方程为 $\\left|\\nabla T\\right| = s$，(ii) 射线方向与 $T$ 的梯度相切，(iii) 费马原理意味着对于固定端点之间的路径变化，$T$ 是平稳的。角度以弧度表示，走时以秒表示。以一对封闭形式的解析表达式 $\\left(\\theta(x), T\\right)$ 给出你的最终答案。不需要数值，并且只保留到 $\\alpha$ 的一阶项。",
            "solution": "在尝试解答之前，必须验证用户提供的问题陈述。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **波速：** 介质的波速为 $v(x,y) = v_{0} \\left(1 + \\alpha x\\right)$。\n-   **常数：** $v_{0} > 0$ 是一个常数。$\\alpha$ 是一个小常数。\n-   **近似条件：** 对于相关的传播距离 $X$，有 $|\\alpha X| \\ll 1$。\n-   **波源和接收器：** 波源位于 $(0,0)$，接收器位于 $(X,Y)$，其中 $X > 0$ 且 $Y \\in \\mathbb{R}$。\n-   **控制原理：** 高频波传播由程函方程和费马原理控制。\n-   **走时泛函：** $T[\\gamma] = \\int_{\\gamma} s(\\mathbf{r}) \\,\\mathrm{d}\\ell$，其中 $s(\\mathbf{r}) = 1/v(\\mathbf{r})$ 是慢度，$\\mathrm{d}\\ell$ 是欧几里得线元。\n-   **约束条件：** 射线路径在 $x$ 从 $x=0$ 到 $x=X$ 是单调的。\n-   **目标：**\n    1.  推导一阶射线弯曲，表示为射线相对于 $x$ 轴的局部夹角 $\\theta(x)$。\n    2.  推导从 $(0,0)$ 到 $(X,Y)$ 的一阶单程走时 $T$。\n-   **输出格式：** 以一对封闭形式的解析表达式 $(\\theta(x), T)$ 给出最终答案，保留项至 $\\alpha$ 的一阶。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据：** 该问题基于非均匀介质中波传播的基本原理，即程函方程和费马最短时间原理。速度模型 $v(x,y) = v_0(1+\\alpha x)$ 代表了一个简单且物理上真实的线性梯度，这是地球物理学和声学中用于分析研究的标准模型。所有概念在物理学中都是成熟的。\n-   **良构性：** 该问题提供了两个固定端点和一个明确定义的速度场。它要求计算路径和走时，在给定的近似条件下，可以使用变分法唯一确定。要求在一个小参数 $\\alpha$ 的一阶近似下进行计算，这是一个标准的良构摄动问题。\n-   **目标：** 问题陈述使用了精确的数学语言和定义，没有主观或模糊的术语。\n-   **完整性：** 问题是自洽的。它提供了速度函数、边界条件（源和接收器位置）、要应用的物理原理（费马原理）以及所需的近似阶数。明确说明了在 $x$ 方向的单调性假设，这使得将路径参数化为 $y(x)$ 是合理的。\n-   **一致性与可行性：** 已知条件是相互一致的。条件 $|\\alpha X| \\ll 1$ 确保了一阶泰勒展开在感兴趣的域上是有效的。该设置在物理上是合理的。\n\n**步骤 3：结论与行动**\n\n该问题被判定为 **有效**。这是一个理论地震学和波传播中的标准问题，它科学上合理、良构且完整。将推导其解。\n\n### 推导过程\n\n将通过对费马原理应用变分法来求解。从 $(0,0)$ 到 $(X,Y)$ 的路径 $y(x)$ 的走时 $T$ 由以下泛函给出：\n$$T[y] = \\int \\frac{\\mathrm{d}\\ell}{v(x,y)} = \\int_0^X \\frac{\\sqrt{1 + (y'(x))^2}}{v_0(1+\\alpha x)} \\mathrm{d}x$$\n被积函数是拉格朗日量 $L(x, y', y) = s(x) \\sqrt{1 + (y')^2}$，其中 $s(x) = \\frac{1}{v_0(1+\\alpha x)}$ 是慢度。由于 $L$ 不显式依赖于 $y$，欧拉-拉格朗日方程 $\\frac{\\partial L}{\\partial y} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\frac{\\partial L}{\\partial y'} = 0$ 简化为 $\\frac{\\mathrm{d}}{\\mathrm{d}x}\\frac{\\partial L}{\\partial y'} = 0$。这意味着 $\\frac{\\partial L}{\\partial y'}$ 沿射线路径是一个常数。这个常数是射线参数，记为 $p$。\n\n$$\\frac{\\partial L}{\\partial y'} = \\frac{1}{v_0(1+\\alpha x)} \\frac{y'}{\\sqrt{1+(y')^2}} = p$$\n局部射线角 $\\theta(x)$ 通过 $y'(x) = \\tan(\\theta(x))$ 与斜率相关。代入此式，我们得到：\n$$\\frac{\\tan(\\theta(x))}{v(x) \\sqrt{1+\\tan^2(\\theta(x))}} = \\frac{\\sin(\\theta(x))}{v(x)} = p$$\n这是对于垂直变化（此处为在 $x$ 方向变化）介质的斯涅尔定律的微分形式。设 $\\theta_0 = \\theta(0)$ 为波源处的初始出射角。在 $x=0$ 处，$v(0)=v_0$，所以 $p = \\frac{\\sin(\\theta_0)}{v_0}$。因此，沿路径的角度满足：\n$$\\sin(\\theta(x)) = v(x) p = v_0(1+\\alpha x) \\frac{\\sin(\\theta_0)}{v_0} = \\sin(\\theta_0)(1+\\alpha x)$$\n\n为了找到路径和角度，我们使用摄动法。设路径为 $y(x) = y^{(0)}(x) + y^{(1)}(x) + \\dots$，其中 $y^{(0)}$ 对应于 $\\alpha=0$ 的情况（一条直线）。\n未扰动路径是 $y^{(0)}(x) = \\frac{Y}{X}x$。此路径的角度是恒定的：$\\theta^{(0)} = \\arctan(Y/X)$。\n设真实出射角为 $\\theta_0 = \\theta^{(0)} + \\delta\\theta_0$，其中 $\\delta\\theta_0$ 是 $\\alpha$ 的量级。\n在一阶 $\\alpha$ 近似下，我们有：\n$$y'(x) = \\tan(\\theta(x)) = \\frac{\\sin(\\theta(x))}{\\sqrt{1-\\sin^2(\\theta(x))}} \\approx \\frac{\\sin(\\theta_0)(1+\\alpha x)}{\\sqrt{1-\\sin^2(\\theta_0)(1+2\\alpha x)}}$$\n展开到 $\\alpha$ 的一阶：\n$\\sin(\\theta_0) \\approx \\sin(\\theta^{(0)}) + \\delta\\theta_0 \\cos(\\theta^{(0)})$。\n$\\sin(\\theta_0)(1+\\alpha x) \\approx (\\sin(\\theta^{(0)}) + \\delta\\theta_0 \\cos(\\theta^{(0)}))(1+\\alpha x) \\approx \\sin(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0 \\cos(\\theta^{(0)})$。\n分母是 $\\cos(\\theta(x))$。在一阶近似下，$\\cos(\\theta(x)) \\approx \\cos(\\theta^{(0)})$。\n所以，$y'(x) \\approx \\frac{\\sin(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0\\cos(\\theta^{(0)})}{\\cos(\\theta^{(0)})} = \\tan(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0$。\n通过对 $y'(x)$ 积分来找到路径：\n$$Y = \\int_0^X y'(x) \\mathrm{d}x \\approx \\int_0^X \\left(\\tan(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0\\right) \\mathrm{d}x$$\n$$Y \\approx \\left[ x\\tan(\\theta^{(0)}) + \\frac{1}{2}\\alpha x^2 \\tan(\\theta^{(0)}) + x\\delta\\theta_0 \\right]_0^X = X\\tan(\\theta^{(0)}) + \\frac{1}{2}\\alpha X^2 \\tan(\\theta^{(0)}) + X\\delta\\theta_0$$\n由于 $Y = X\\tan(\\theta^{(0)})$，我们有：\n$$0 \\approx \\frac{1}{2}\\alpha X^2 \\tan(\\theta^{(0)}) + X\\delta\\theta_0 \\implies \\delta\\theta_0 = -\\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})$$\n现在我们求局部角度 $\\theta(x)$。设 $\\theta(x) = \\theta^{(0)} + \\delta\\theta(x)$。\n$\\sin(\\theta(x)) \\approx \\sin(\\theta^{(0)}) + \\delta\\theta(x)\\cos(\\theta^{(0)})$。\n根据斯涅尔定律，$\\sin(\\theta(x)) = \\sin(\\theta_0)(1+\\alpha x)$。到一阶：\n$\\sin(\\theta_0)(1+\\alpha x) \\approx (\\sin(\\theta^{(0)}) + \\delta\\theta_0\\cos(\\theta^{(0)}))(1+\\alpha x) \\approx \\sin(\\theta^{(0)}) + \\alpha x \\sin(\\theta^{(0)}) + \\delta\\theta_0\\cos(\\theta^{(0)})$。\n代入 $\\delta\\theta_0 = -\\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})$：\n$\\sin(\\theta_0)(1+\\alpha x) \\approx \\sin(\\theta^{(0)}) + \\alpha x \\sin(\\theta^{(0)}) - \\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})\\cos(\\theta^{(0)}) = \\sin(\\theta^{(0)})\\left(1 + \\alpha x - \\frac{1}{2}\\alpha X\\right)$。\n令 $\\sin(\\theta(x))$ 的两个表达式相等：\n$\\sin(\\theta^{(0)}) + \\delta\\theta(x)\\cos(\\theta^{(0)}) \\approx \\sin(\\theta^{(0)})\\left(1 + \\alpha\\left(x - \\frac{X}{2}\\right)\\right)$。\n$\\delta\\theta(x)\\cos(\\theta^{(0)}) \\approx \\alpha \\sin(\\theta^{(0)})\\left(x - \\frac{X}{2}\\right) \\implies \\delta\\theta(x) = \\alpha \\tan(\\theta^{(0)})\\left(x - \\frac{X}{2}\\right)$。\n代入 $\\tan(\\theta^{(0)}) = Y/X$，一阶射线角为：\n$$\\theta(x) = \\theta^{(0)} + \\delta\\theta(x) = \\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X}\\left(x - \\frac{X}{2}\\right)$$\n\n接下来，我们推导走时 $T$。根据费马原理，走时的一阶摄动可以通过沿未扰动路径 $\\gamma_0$ 积分慢度摄动来计算。\n$T = T_0 + \\delta T$。\n未扰动走时为 $T_0 = \\frac{\\text{length of } \\gamma_0}{v_0} = \\frac{\\sqrt{X^2+Y^2}}{v_0}$。\n慢度为 $s(x) = \\frac{1}{v_0(1+\\alpha x)} \\approx \\frac{1}{v_0}(1-\\alpha x)$。\n慢度摄动为 $\\delta s(x) = s(x) - s_0 = \\frac{1}{v_0}(1-\\alpha x) - \\frac{1}{v_0} = -\\frac{\\alpha x}{v_0}$。\n走时摄动为 $\\delta T = \\int_{\\gamma_0} \\delta s(x) \\mathrm{d}\\ell$。\n未扰动路径 $\\gamma_0$ 是一条直线。我们可以用 $x$ 将其参数化：$\\mathrm{d}\\ell = \\sqrt{1+(y^{(0)\\prime})^2} \\mathrm{d}x = \\sqrt{1 + (Y/X)^2} \\mathrm{d}x = \\frac{\\sqrt{X^2+Y^2}}{X} \\mathrm{d}x$。\n$$\\delta T = \\int_0^X \\left(-\\frac{\\alpha x}{v_0}\\right) \\frac{\\sqrt{X^2+Y^2}}{X} \\mathrm{d}x = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\int_0^X x \\mathrm{d}x$$\n$$\\delta T = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\left[\\frac{x^2}{2}\\right]_0^X = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\frac{X^2}{2} = -\\frac{\\alpha X \\sqrt{X^2+Y^2}}{2v_0}$$\n总走时为 $T = T_0 + \\delta T$：\n$$T = \\frac{\\sqrt{X^2+Y^2}}{v_0} - \\frac{\\alpha X \\sqrt{X^2+Y^2}}{2v_0} = \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)$$\n\n局部射线角 $\\theta(x)$ 和走时 $T$ 在 $\\alpha$ 的一阶近似下的最终表达式为：\n$\\theta(x) = \\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X} \\left(x - \\frac{X}{2}\\right)$\n$T = \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)$\n这些构成了所要求的一对结果。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X} \\left(x - \\frac{X}{2}\\right) & \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "数值模拟在有限的计算域上进行，这会引入人工边界并产生虚假的反射，从而污染模拟结果。这项动手设计任务 () 通过让您构建一个完全匹配层 (Perfectly Matched Layer, PML) 来解决这一关键问题。您将学习如何将一个物理要求（低反射率）转化为具体的数值参数，从而掌握吸收边界条件的设计，这是计算地球物理学中一项至关重要的实用技能。",
            "id": "3614122",
            "problem": "您的任务是为非均匀介质中的二维声波模拟设计完美匹配层（PML）吸收边界。目标是构建一个多项式阻尼剖面并选择PML厚度，使得在指定参考频率 $f_0$ 处的振幅反射系数不超过预设的目标值，并以增加的网格点数量化由PML引起的计算开销。\n\n物理出发点是非均匀介质中的二维声波方程，\n$$\n\\partial_t^2 p(x,z,t) = v(x,z)^2 \\nabla^2 p(x,z,t),\n$$\n其中 $p$ 是声压，$v(x,z)$ 是空间变化的相速度。使用时谐拟设 $p(x,z,t) = \\Re\\{P(x,z) e^{-i \\omega t}\\}$（其中 $\\omega = 2 \\pi f$）以转换到频域。通过复坐标拉伸在 $x$ 方向上对PML进行建模，其拉伸因子为 $s_x(x,\\omega) = 1 + i \\sigma_x(x)/\\omega$，其中 $\\sigma_x(x)$ 是作用于PML区域的非负阻尼剖面。假设波正入射到PML上（就PML内部的最大传播长度而言，这是衰减的最坏情况），并采用标量声学近似。在PML设计中，您可以将控制衰减的有效波速取为PML邻近区域的最小相速度 $v_{\\min}$。\n\n设计规范和数值离散化假设如下：\n- 阻尼剖面是在厚度为 $L_{\\mathrm{pml}}$ 的PML层中的一个 $m$ 阶多项式，即 $\\sigma_x(x) = \\sigma_{\\max} \\left(\\frac{x}{L_{\\mathrm{pml}}}\\right)^m$，其中 $x \\in [0, L_{\\mathrm{pml}}]$ 是从计算域-PML界面向内测量的距离。\n- 在频率 $f_0$ 下，计算域内部-PML界面处的目标最大振幅反射系数为 $R_{\\mathrm{target}}$（一个在 $(0,1)$ 范围内的数）。\n- 网格间距由 $f_0$ 处的解析度要求和最小速度 $v_{\\min}$ 决定：$\\Delta x = \\frac{v_{\\min}}{P f_0}$，其中 $P$ 是每个最小波长所需的网格点数。在两个方向上使用相同的间距。\n- 不含PML的基础计算域尺寸为 $L_x$ 和 $L_z$。基础网格点数为 $N_x^0 = \\lceil L_x / \\Delta x \\rceil$ 和 $N_z^0 = \\lceil L_z / \\Delta x \\rceil$。\n- 每侧的PML厚度必须是整数个网格点 $N_{\\mathrm{pml}}$，并且必须满足最小厚度约束 $N_{\\mathrm{pml}} \\ge N_{\\mathrm{pml}}^{\\min}$。对于本问题，设计上取 $N_{\\mathrm{pml}} = N_{\\mathrm{pml}}^{\\min}$，并选择 $\\sigma_{\\max}$ 以满足 $f_0$ 处的反射规范，该规范使用由复坐标拉伸和假设剖面所蕴含的正入射、有限厚度衰减来确定。\n\n计算开销定义为当向所有侧面添加厚度为 $N_{\\mathrm{pml}}$ 的PML时，网格点数增加的乘法因子：\n$$\n\\mathcal{O} = \\frac{(N_x^0 + 2 N_{\\mathrm{pml}})(N_z^0 + 2 N_{\\mathrm{pml}})}{N_x^0 N_z^0}.\n$$\n\n您的程序必须：\n- 从基本模型和复坐标拉伸定义出发，推导出用 $\\sigma_x(x)$ 和 $v_{\\min}$ 表示的正入射振幅反射表达式，并用它来求解 $\\sigma_{\\max}$，将其表示为 $R_{\\mathrm{target}}$、$m$、$L_{\\mathrm{pml}}$ 和 $v_{\\min}$ 的函数。\n- 使用 $N_{\\mathrm{pml}} = N_{\\mathrm{pml}}^{\\min}$ 实现设计，计算 $L_{\\mathrm{pml}} = N_{\\mathrm{pml}} \\Delta x$，计算 $\\sigma_{\\max}$，并计算如上定义的开销 $\\mathcal{O}$。\n\n单位和输出：\n- 所有长度必须以米表示，所有速度以米/秒表示，频率以赫兹表示，$\\sigma_{\\max}$ 以 1/秒 表示。开销 $\\mathcal{O}$ 是无量纲的。\n- 每个测试用例的最终输出必须是 $[N_{\\mathrm{pml}}, L_{\\mathrm{pml}}, \\sigma_{\\max}, \\mathcal{O}]$ 形式的列表，其中 $N_{\\mathrm{pml}}$ 是一个整数，其他条目是四舍五入到六位小数的浮点数。\n\n测试套件：\n使用以下四个测试用例。对于每个元组，参数按所述单位和顺序为 $(f_0, v_{\\min}, L_x, L_z, P, R_{\\mathrm{target}}, m, N_{\\mathrm{pml}}^{\\min})$：\n- 用例 A：($f_0 = $ $20$, $v_{\\min} = $ $1500$, $L_x = $ $2000$, $L_z = $ $1000$, $P = $ $12$, $R_{\\mathrm{target}} = $ $10^{-6}$, $m = $ $3$, $N_{\\mathrm{pml}}^{\\min} = $ $20$)。\n- 用例 B：($f_0 = $ $10$, $v_{\\min} = $ $2000$, $L_x = $ $500$, $L_z = $ $500$, $P = $ $10$, $R_{\\mathrm{target}} = $ $10^{-4}$, $m = $ $2$, $N_{\\mathrm{pml}}^{\\min} = $ $8$)。\n- 用例 C：($f_0 = $ $40$, $v_{\\min} = $ $1000$, $L_x = $ $3000$, $L_z = $ $2000$, $P = $ $15$, $R_{\\mathrm{target}} = $ $10^{-8}$, $m = $ $4$, $N_{\\mathrm{pml}}^{\\min} = $ $25$)。\n- 用例 D：($f_0 = $ $15$, $v_{\\min} = $ $1800$, $L_x = $ $1500$, $L_z = $ $1500$, $P = $ $10$, $R_{\\mathrm{target}} = $ $10^{-3}$, $m = $ $1$, $N_{\\mathrm{pml}}^{\\min} = $ $12$)。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有四个用例的结果，格式为一个由方括号括起来的逗号分隔列表，其中每个用例的结果本身也是如上所述的方括号列表，且不含空格。例如，结构必须类似于 $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot]]$。确保所有浮点数都四舍五入到六位小数，长度以米为单位，$\\sigma_{\\max}$ 以 1/秒 为单位，开销无量纲。",
            "solution": "所提出的问题是有效的，因为它在科学上基于波传播和计算物理学的原理，具有一组完整且一致的参数，是适定的，并使用了客观、正式的语言。因此，我们可以着手解决。\n\n目标是为二维声波模拟设计一个完美匹配层（PML）。这涉及到确定多项式阻尼剖面的参数（特别是 $\\sigma_{\\max}$）和PML厚度 $L_{\\mathrm{pml}}$，以满足给定的反射约束。我们还必须量化此PML的计算成本。解决方案包括两个主要部分：首先，推导反射系数和PML参数之间的必要物理关系；其次，在定义的数值框架内应用此关系。\n\n首先，我们推导正入射振幅反射系数的表达式。控制方程是二维声波方程：\n$$\n\\partial_t^2 p(x,z,t) = v(x,z)^2 \\nabla^2 p(x,z,t)\n$$\n假设时谐解为 $p(x,z,t) = \\Re\\{P(x,z) e^{-i \\omega t}\\}$，其中 $\\omega = 2 \\pi f_0$，波动方程变换为频域亥姆霍兹方程：\n$$\n\\nabla^2 P(x,z) + k^2 P(x,z) = 0\n$$\n其中 $k = \\omega/v(x,z)$ 是波数。\n\n在PML内部，我们在 $x$ 方向引入复坐标拉伸，这将导数算子 $\\partial_x$ 修改为 $\\frac{1}{s_x(x,\\omega)}\\partial_x$。拉伸因子给定为 $s_x(x,\\omega) = 1 + i \\sigma_x(x)/\\omega$。对于一个正向传播进入PML（即沿 $x$ 轴）的平面波，在 $z$ 方向上没有变化，因此 $\\partial_z P = 0$。PML区域内的亥姆霍兹方程变为：\n$$\n\\frac{1}{s_x(x,\\omega)^2} \\frac{d^2P}{dx^2} + k^2 P = 0\n$$\n$$\n\\frac{d^2P}{dx^2} + [k \\cdot s_x(x,\\omega)]^2 P = 0\n$$\n该方程描述了具有复的、与位置相关的波数 $\\tilde{k}_x(x) = k \\cdot s_x(x,\\omega)$ 的波传播。使用PML邻近的有效波速 $v_{\\min}$，介质中的波数为 $k = \\omega/v_{\\min}$。因此，PML中的复波数为：\n$$\n\\tilde{k}_x(x) = \\frac{\\omega}{v_{\\min}} \\left(1 + \\frac{i \\sigma_x(x)}{\\omega}\\right) = \\frac{\\omega}{v_{\\min}} + i \\frac{\\sigma_x(x)}{v_{\\min}}\n$$\n一个前向传播波的解具有形式 $P(x) \\propto e^{i \\int_0^x \\tilde{k}_x(x') dx'}$。代入 $\\tilde{k}_x(x')$ 的表达式，我们得到：\n$$\nP(x) \\propto \\exp\\left(i \\int_0^x \\left(\\frac{\\omega}{v_{\\min}} + i \\frac{\\sigma_x(x')}{v_{\\min}}\\right) dx'\\right) = \\exp\\left(i \\frac{\\omega x}{v_{\\min}}\\right) \\exp\\left(-\\frac{1}{v_{\\min}}\\int_0^x \\sigma_x(x') dx'\\right)\n$$\n第二个指数项代表振幅衰减。对于穿过整个厚度为 $L_{\\mathrm{pml}}$ 的PML的波，其单程衰减因子为：\n$$\nA = \\exp\\left(-\\frac{1}{v_{\\min}}\\int_0^{L_{\\mathrm{pml}}} \\sigma_x(x) dx\\right)\n$$\n对于有限厚度的PML，其理论反射系数 $R$（假设其外边界是一个完美反射体）由往返衰减决定。波在进入PML的路径上被衰减，反射，然后在出射路径上再次被衰减。因此，$R = |A^2|$。设计规范要求它等于目标反射系数 $R_{\\mathrm{target}}$：\n$$\nR_{\\mathrm{target}} = \\exp\\left(-\\frac{2}{v_{\\min}}\\int_0^{L_{\\mathrm{pml}}} \\sigma_x(x) dx\\right)\n$$\n接下来，我们对给定的多项式阻尼剖面 $\\sigma_x(x) = \\sigma_{\\max} \\left(x/L_{\\mathrm{pml}}\\right)^m$ 计算积分：\n$$\n\\int_0^{L_{\\mathrm{pml}}} \\sigma_x(x) dx = \\int_0^{L_{\\mathrm{pml}}} \\sigma_{\\max} \\left(\\frac{x}{L_{\\mathrm{pml}}}\\right)^m dx = \\frac{\\sigma_{\\max}}{L_{\\mathrm{pml}}^m} \\left[\\frac{x^{m+1}}{m+1}\\right]_0^{L_{\\mathrm{pml}}} = \\frac{\\sigma_{\\max} L_{\\mathrm{pml}}}{m+1}\n$$\n将此结果代入 $R_{\\mathrm{target}}$ 的方程，得到：\n$$\nR_{\\mathrm{target}} = \\exp\\left(-\\frac{2 \\sigma_{\\max} L_{\\mathrm{pml}}}{v_{\\min}(m+1)}\\right)\n$$\n我们求解该方程以得到 $\\sigma_{\\max}$。对两边取自然对数：\n$$\n\\ln(R_{\\mathrm{target}}) = -\\frac{2 \\sigma_{\\max} L_{\\mathrm{pml}}}{v_{\\min}(m+1)}\n$$\n$$\n\\sigma_{\\max} = -\\frac{v_{\\min}(m+1)\\ln(R_{\\mathrm{target}})}{2 L_{\\mathrm{pml}}}\n$$\n这就是 $\\sigma_{\\max}$ 所需的表达式。\n\n任务的第二部分是实现计算设计。每个测试用例的步骤如下：\n1.  将PML网格点数 $N_{\\mathrm{pml}}$ 设置为指定的最小值 $N_{\\mathrm{pml}}^{\\min}$。\n2.  使用提供的公式计算网格间距 $\\Delta x$：$\\Delta x = \\frac{v_{\\min}}{P f_0}$。\n3.  计算PML的厚度（单位：米）：$L_{\\mathrm{pml}} = N_{\\mathrm{pml}} \\Delta x$。\n4.  使用推导出的公式计算 $\\sigma_{\\max}$。为便于数值实现，代入 $L_{\\mathrm{pml}}$ 以直接用输入参数表示 $\\sigma_{\\max}$ 是有利的：\n    $$\n    \\sigma_{\\max} = -\\frac{v_{\\min}(m+1)\\ln(R_{\\mathrm{target}})}{2 (N_{\\mathrm{pml}} \\Delta x)} = -\\frac{v_{\\min}(m+1)\\ln(R_{\\mathrm{target}})}{2 N_{\\mathrm{pml}} (v_{\\min}/(P f_0))} = -\\frac{P f_0 (m+1)\\ln(R_{\\mathrm{target}})}{2 N_{\\mathrm{pml}}}\n    $$\n5.  使用定义 $N_x^0 = \\lceil L_x / \\Delta x \\rceil$ 和 $N_z^0 = \\lceil L_z / \\Delta x \\rceil$ 计算基础计算域中的网格点数 $N_x^0$ 和 $N_z^0$。\n6.  使用其定义计算计算开销 $\\mathcal{O}$：\n    $$\n    \\mathcal{O} = \\frac{(N_x^0 + 2 N_{\\mathrm{pml}})(N_z^0 + 2 N_{\\mathrm{pml}})}{N_x^0 N_z^0}\n    $$\n7.  最后，将四个输出量——$N_{\\mathrm{pml}}$（整数），以及 $L_{\\mathrm{pml}}$、$\\sigma_{\\max}$、$\\mathcal{O}$（四舍五入到六位小数的浮点数）——收集并格式化为指定的列表格式。\n\n这样就完成了原则性设计和实施计划。我们现在开始对给定的测试用例进行数值计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs PML absorbing boundaries for a 2D acoustic wave simulation.\n\n    For each test case, this function calculates:\n    1. The PML thickness in grid points (N_pml) and meters (L_pml).\n    2. The optimal peak damping value (sigma_max) for a polynomial profile.\n    3. The computational overhead (O) incurred by adding the PML.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (f0, v_min, Lx, Lz, P, R_target, m, Npml_min)\n    test_cases = [\n        (20.0, 1500.0, 2000.0, 1000.0, 12, 1e-6, 3, 20),\n        (10.0, 2000.0, 500.0, 500.0, 10, 1e-4, 2, 8),\n        (40.0, 1000.0, 3000.0, 2000.0, 15, 1e-8, 4, 25),\n        (15.0, 1800.0, 1500.0, 1500.0, 10, 1e-3, 1, 12),\n    ]\n\n    # A list to store the formatted string representation of each case's results.\n    results_as_strings = []\n\n    for case in test_cases:\n        f0, v_min, Lx, Lz, P, R_target, m, Npml_min = case\n\n        # Step 1: Set N_pml from the design apecification.\n        N_pml = Npml_min  # Integer by definition.\n\n        # Step 2: Calculate the grid spacing.\n        delta_x = v_min / (P * f0)\n\n        # Step 3: Calculate the PML thickness in meters.\n        L_pml = N_pml * delta_x\n\n        # Step 4: Calculate sigma_max using the derived formula.\n        # sigma_max = (-v_min * (m + 1) * np.log(R_target)) / (2 * L_pml)\n        # An equivalent, more direct formula is used here to avoid intermediate float divisions.\n        sigma_max = (-P * f0 * (m + 1) * np.log(R_target)) / (2 * N_pml)\n\n        # Step 5: Calculate the base grid counts.\n        # np.ceil ensures the grid covers the entire physical domain.\n        Nx0 = int(np.ceil(Lx / delta_x))\n        Nz0 = int(np.ceil(Lz / delta_x))\n\n        # Step 6: Calculate the computational overhead factor.\n        overhead = ((Nx0 + 2 * N_pml) * (Nz0 + 2 * N_pml)) / (Nx0 * Nz0)\n\n        # Step 7: Format the result for the current case into a string\n        # as per the specified output format: no spaces, 6 decimal places for floats.\n        result_str = (\n            f\"[{N_pml},\"\n            f\"{L_pml:.6f},\"\n            f\"{sigma_max:.6f},\"\n            f\"{overhead:.6f}]\"\n        )\n        results_as_strings.append(result_str)\n\n    # Final print statement in the exact required format.\n    # The list of formatted strings is joined by commas and enclosed in brackets.\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        }
    ]
}