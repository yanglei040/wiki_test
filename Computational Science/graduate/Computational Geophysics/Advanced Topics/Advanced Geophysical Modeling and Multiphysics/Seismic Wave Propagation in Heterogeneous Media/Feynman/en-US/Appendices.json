{
    "hands_on_practices": [
        {
            "introduction": "Before we can simulate wave propagation, we must first articulate the underlying physics in a precise mathematical form. This foundational exercise guides you through the derivation of the elastic wave equation from the principles of continuum mechanics for a simple, yet fundamental, heterogeneous model of two half-spaces. By establishing the governing equations and the essential transmission conditions at the interface, you will solidify your understanding of how material contrasts control wave behavior .",
            "id": "3614112",
            "problem": "Consider a two-dimensional, plane-strain, isotropic, linear elastic, heterogeneous medium composed of two homogeneous half-spaces separated by the horizontal interface at $y=0$. Region $\\Omega_{1}$ is the upper half-space $\\{(x,y)\\in\\mathbb{R}^{2}: y>0\\}$ with constant mass density $\\rho_{1}$, first Lamé parameter $\\lambda_{1}$, and shear modulus $\\mu_{1}$. Region $\\Omega_{2}$ is the lower half-space $\\{(x,y)\\in\\mathbb{R}^{2}: y<0\\}$ with constant mass density $\\rho_{2}$, first Lamé parameter $\\lambda_{2}$, and shear modulus $\\mu_{2}$. Let $\\mathbf{u}(x,y,t)$ denote the displacement field. Assume there are no body forces. The medium parameters are:\n- $\\rho_{1} = 2200$ kg/m$^{3}$, $\\lambda_{1} = 5.0\\times 10^{9}$ Pa, $\\mu_{1} = 3.0\\times 10^{9}$ Pa,\n- $\\rho_{2} = 2700$ kg/m$^{3}$, $\\lambda_{2} = 3.0\\times 10^{10}$ Pa, $\\mu_{2} = 3.0\\times 10^{10}$ Pa.\n\nTasks:\n1) Starting from the balance of linear momentum, linearized kinematics, and the isotropic Hooke law, derive the strong-form governing partial differential equation (PDE) for $\\mathbf{u}(x,y,t)$ in each region $\\Omega_{i}$, $i\\in\\{1,2\\}$, in terms of spatial differential operators, making explicit the dependence on the region-wise constant parameters $\\rho_{i}$, $\\lambda_{i}$, and $\\mu_{i}$.\n2) State the physically correct transmission conditions at the interface $y=0$ in terms of the jump conditions on displacement and the Cauchy traction vector.\n3) Using only the given $\\rho_{i}$, $\\lambda_{i}$, and $\\mu_{i}$, compute the local compressional-wave speed $v_{p,i}$ and shear-wave speed $v_{s,i}$ for each region $\\Omega_{i}$. Express the speeds in meters per second and round your answer to four significant figures.\n\nAnswer specification: Provide the final numerical answer as a row matrix in the order $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2})$. Express the speeds in meters per second. Round to four significant figures. The final answer must contain only numbers without units inside the matrix.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- **Medium Description**: Two-dimensional, plane-strain, isotropic, linear elastic, heterogeneous.\n- **Geometry**: Two homogeneous half-spaces separated by a horizontal interface at $y=0$.\n- **Region $\\Omega_{1}$**: Upper half-space, $\\{(x,y)\\in\\mathbb{R}^{2}: y>0\\}$.\n  - Mass density: $\\rho_{1} = 2200$ kg/m$^{3}$\n  - First Lamé parameter: $\\lambda_{1} = 5.0\\times 10^{9}$ Pa\n  - Shear modulus: $\\mu_{1} = 3.0\\times 10^{9}$ Pa\n- **Region $\\Omega_{2}$**: Lower half-space, $\\{(x,y)\\in\\mathbb{R}^{2}: y<0\\}$.\n  - Mass density: $\\rho_{2} = 2700$ kg/m$^{3}$\n  - First Lamé parameter: $\\lambda_{2} = 3.0\\times 10^{10}$ Pa\n  - Shear modulus: $\\mu_{2} = 3.0\\times 10^{10}$ Pa\n- **Field Variable**: Displacement field $\\mathbf{u}(x,y,t)$.\n- **Assumptions**: No body forces.\n- **Tasks**:\n  1. Derive the strong-form governing PDE for $\\mathbf{u}(x,y,t)$ in each region $\\Omega_{i}$.\n  2. State transmission conditions at the interface $y=0$.\n  3. Compute compressional-wave speed $v_{p,i}$ and shear-wave speed $v_{s,i}$ for each region.\n- **Answer Specification**: A row matrix $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2})$ with speeds in m/s, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem is a classic setup in elastodynamics and seismology, based on fundamental principles of continuum mechanics: balance of linear momentum, linearized kinematics, and Hooke's law for isotropic materials. The provided material parameters ($\\rho_{i}$, $\\lambda_{i}$, $\\mu_{i}$) are physically realistic for crustal rocks. The problem is scientifically sound.\n- **Well-Posed**: The three tasks are well-defined and lead to unique, meaningful solutions. The derivation of the wave equation, the statement of interface conditions, and the calculation of wave speeds are standard procedures in the field.\n- **Objective**: The problem is stated using precise, unambiguous, and standard terminology from continuum mechanics and wave physics.\n- **Completeness and Consistency**: The problem provides all necessary material parameters ($\\rho_{i}$, $\\lambda_{i}$, $\\mu_{i}$) to complete all specified tasks. There are no contradictions in the provided information.\n\n### Step 3: Verdict and Action\nThe problem is **valid** as it is scientifically sound, well-posed, objective, and self-contained. The solution process will now proceed.\n\n---\n\n### Solution\nThe problem is addressed by completing the three specified tasks.\n\n#### 1. Derivation of the Governing PDE\n\nThe derivation of the elastic wave equation starts from three fundamental principles of continuum mechanics. We perform the derivation for a generic homogeneous region with parameters $\\rho$, $\\lambda$, and $\\mu$, and then specialize it for regions $\\Omega_{1}$ and $\\Omega_{2}$.\n\n1.  **Balance of Linear Momentum (Cauchy's First Law of Motion)**: In the absence of body forces, the balance of linear momentum is stated as:\n    $$ \\nabla \\cdot \\boldsymbol{\\sigma} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n    where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\rho$ is the mass density, $\\mathbf{u}$ is the displacement vector, and $t$ is time.\n\n2.  **Linearized Kinematics (Strain-Displacement Relation)**: The linearized (or small) strain tensor $\\boldsymbol{\\varepsilon}$ is related to the displacement field $\\mathbf{u}$ by:\n    $$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right] $$\n\n3.  **Constitutive Law (Isotropic Hooke's Law)**: For a linear, isotropic, elastic material, the stress tensor $\\boldsymbol{\\sigma}$ is related to the strain tensor $\\boldsymbol{\\varepsilon}$ by:\n    $$ \\boldsymbol{\\sigma} = \\lambda (\\text{tr}(\\boldsymbol{\\varepsilon})) \\mathbf{I} + 2\\mu\\boldsymbol{\\varepsilon} $$\n    where $\\lambda$ and $\\mu$ are the Lamé parameters and $\\mathbf{I}$ is the second-order identity tensor. The trace of the strain tensor is equal to the divergence of the displacement, $\\text{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$.\n\nWe now combine these three equations. First, substitute the strain-displacement relation into the constitutive law:\n$$ \\boldsymbol{\\sigma} = \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + 2\\mu \\left( \\frac{1}{2} \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right] \\right) = \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + \\mu \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right] $$\nNext, substitute this expression for stress into the balance of momentum equation:\n$$ \\nabla \\cdot \\left( \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + \\mu \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right] \\right) = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\nThe divergence operator is applied to the terms in the parenthesis. Since $\\lambda$ and $\\mu$ are constant within each region:\n$$ \\nabla \\cdot (\\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I}) = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) $$\n$$ \\nabla \\cdot (\\mu[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]) = \\mu \\nabla \\cdot (\\nabla\\mathbf{u}) + \\mu \\nabla \\cdot ((\\nabla\\mathbf{u})^T) $$\nUsing the vector calculus identities $\\nabla \\cdot (\\nabla\\mathbf{u}) = \\nabla^2\\mathbf{u}$ (the vector Laplacian) and $\\nabla \\cdot ((\\nabla\\mathbf{u})^T) = \\nabla(\\nabla \\cdot \\mathbf{u})$, the equation becomes:\n$$ \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2\\mathbf{u} + \\mu \\nabla(\\nabla \\cdot \\mathbf{u}) = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\nCombining terms, we arrive at the strong-form governing PDE, Navier's equation of motion:\n$$ (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\nThis equation holds in each homogeneous region. For the two regions $\\Omega_{i}$ with $i \\in \\{1, 2\\}$, the PDEs are:\n- In region $\\Omega_{1}$ ($y>0$):\n$$ (\\lambda_{1} + \\mu_{1}) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu_{1} \\nabla^2 \\mathbf{u} = \\rho_{1} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n- In region $\\Omega_{2}$ ($y<0$):\n$$ (\\lambda_{2} + \\mu_{2}) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu_{2} \\nabla^2 \\mathbf{u} = \\rho_{2} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n\n#### 2. Transmission Conditions at the Interface $y=0$\n\nThe two half-spaces are assumed to be perfectly bonded at the interface $y=0$. This implies two physical conditions:\n1.  **Continuity of Displacement**: The displacement vector must be continuous across the interface to ensure that no gaps or overlaps occur. This means the displacement vector $\\mathbf{u}$ evaluated as a limit from region $\\Omega_{1}$ must equal that from region $\\Omega_{2}$. Mathematically, this is expressed as:\n    $$ \\mathbf{u}(x, y=0^+, t) = \\mathbf{u}(x, y=0^-, t) \\quad \\text{for all } x, t $$\n    Using the jump notation $[\\![ \\psi ]\\!] = \\psi_{1} - \\psi_{2}$ across the interface, this condition is $[\\![ \\mathbf{u} ]\\!] = \\mathbf{0}$ at $y=0$.\n\n2.  **Continuity of Traction**: By Newton's third law, the force exerted by region $\\Omega_1$ on region $\\Omega_2$ must be equal and opposite to the force exerted by $\\Omega_2$ on $\\Omega_1$. This results in the continuity of the Cauchy traction vector $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$ across the interface. The unit normal vector to the interface $y=0$, pointing from $\\Omega_2$ to $\\Omega_1$, is $\\mathbf{n} = (0, 1)^T$. The traction continuity condition is:\n    $$ \\boldsymbol{\\sigma}_{1}(x, y=0^+, t) \\mathbf{n} = \\boldsymbol{\\sigma}_{2}(x, y=0^-, t) \\mathbf{n} \\quad \\text{for all } x, t $$\n    Here, $\\boldsymbol{\\sigma}_{1}$ and $\\boldsymbol{\\sigma}_{2}$ are the stress tensors in their respective regions. In jump notation, this is $[\\![ \\boldsymbol{\\sigma}\\mathbf{n} ]\\!] = \\mathbf{0}$ at $y=0$. The components of the traction vector are $t_x = \\sigma_{xy}$ and $t_y = \\sigma_{yy}$, so this condition implies continuity of both the shear stress $\\sigma_{xy}$ and the normal stress $\\sigma_{yy}$ across the interface.\n\n#### 3. Computation of Wave Speeds\n\nThe compressional-wave speed ($v_p$) and shear-wave speed ($v_s$) in an isotropic, linear elastic medium are given by:\n$$ v_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}} $$\n$$ v_s = \\sqrt{\\frac{\\mu}{\\rho}} $$\nWe apply these formulas to each region using the given parameters.\n\n- **Region $\\Omega_{1}$**:\n  - $\\rho_1 = 2200$ kg/m$^3$\n  - $\\lambda_1 = 5.0 \\times 10^9$ Pa\n  - $\\mu_1 = 3.0 \\times 10^9$ Pa\n  \n  $$ v_{p,1} = \\sqrt{\\frac{\\lambda_1 + 2\\mu_1}{\\rho_1}} = \\sqrt{\\frac{5.0 \\times 10^9 + 2(3.0 \\times 10^9)}{2200}} = \\sqrt{\\frac{11.0 \\times 10^9}{2200}} = \\sqrt{5 \\times 10^6} \\approx 2236.0679.. \\text{ m/s} $$\n  Rounding to four significant figures, $v_{p,1} = 2236$ m/s.\n\n  $$ v_{s,1} = \\sqrt{\\frac{\\mu_1}{\\rho_1}} = \\sqrt{\\frac{3.0 \\times 10^9}{2200}} = \\sqrt{\\frac{15}{11} \\times 10^6} \\approx 1167.748... \\text{ m/s} $$\n  Rounding to four significant figures, $v_{s,1} = 1168$ m/s.\n\n- **Region $\\Omega_{2}$**:\n  - $\\rho_2 = 2700$ kg/m$^3$\n  - $\\lambda_2 = 3.0 \\times 10^{10}$ Pa\n  - $\\mu_2 = 3.0 \\times 10^{10}$ Pa\n\n  $$ v_{p,2} = \\sqrt{\\frac{\\lambda_2 + 2\\mu_2}{\\rho_2}} = \\sqrt{\\frac{3.0 \\times 10^{10} + 2(3.0 \\times 10^{10})}{2700}} = \\sqrt{\\frac{9.0 \\times 10^{10}}{2700}} = \\sqrt{\\frac{1}{3} \\times 10^8} \\approx 5773.5026.. \\text{ m/s} $$\n  Rounding to four significant figures, $v_{p,2} = 5774$ m/s.\n  \n  $$ v_{s,2} = \\sqrt{\\frac{\\mu_2}{\\rho_2}} = \\sqrt{\\frac{3.0 \\times 10^{10}}{2700}} = \\sqrt{\\frac{1}{9} \\times 10^8} = \\frac{1}{3} \\times 10^4 = 3333.333... \\text{ m/s} $$\n  Rounding to four significant figures, $v_{s,2} = 3333$ m/s.\n\nThe computed wave speeds are $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2}) = (2236, 1168, 5774, 3333)$ m/s.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2236 & 1168 & 5774 & 3333\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While full-wave solutions provide a complete picture, the high-frequency approximation offered by ray theory is an indispensable tool for building intuition and for efficient modeling in seismic imaging. This practice delves into this regime by applying Fermat's principle of least time to a medium with a continuous velocity gradient. You will use perturbation methods to derive the ray's trajectory and travel time, revealing the fundamental principles behind ray bending .",
            "id": "3614152",
            "problem": "Consider two-dimensional, isotropic, high-frequency acoustic wave propagation governed by the Eikonal equation in an inhomogeneous medium with wave speed $v(x,y) = v_{0} \\left(1 + \\alpha x\\right)$, where $v_{0} > 0$ is constant and $\\alpha$ is a small constant satisfying $|\\alpha X| \\ll 1$ for the propagation distance considered. Let the source be at $\\left(0,0\\right)$ and the receiver be at $\\left(X,Y\\right)$ with $X>0$ and $Y \\in \\mathbb{R}$. In the high-frequency limit, rays follow paths that render the travel time stationary, in accordance with Fermat’s principle. The travel time along a path $\\gamma$ is $T[\\gamma] = \\int_{\\gamma} s(\\mathbf{r}) \\,\\mathrm{d}\\ell$, where $s(\\mathbf{r}) = 1/v(\\mathbf{r})$ is the slowness and $\\mathrm{d}\\ell$ is the Euclidean line element. \n\nWorking to first order in $\\alpha$, use Fermat’s principle and the calculus of variations to:\n- Derive the first-order ray bending, expressed as the local ray angle $\\theta(x)$ with respect to the $x$-axis along the path, assuming the ray is monotonic in $x$ from $0$ to $X$.\n- Derive the first-order one-way travel time $T$ from $\\left(0,0\\right)$ to $\\left(X,Y\\right)$.\n\nYou may use the facts that (i) the Eikonal equation is $\\left|\\nabla T\\right| = s$, (ii) the ray direction is tangential to the gradient of $T$, and (iii) Fermat’s principle implies stationarity of $T$ with respect to path variations between fixed endpoints. Express the angle in radians and the travel time in seconds. Provide your final answer as a pair of closed-form analytic expressions $\\left(\\theta(x), T\\right)$. No numerical values are required, and retain terms through first order in $\\alpha$ only.",
            "solution": "The user has provided a problem statement that must be validated before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Wave Speed:** The medium has a wave speed given by $v(x,y) = v_{0} \\left(1 + \\alpha x\\right)$.\n-   **Constants:** $v_{0} > 0$ is a constant. $\\alpha$ is a small constant.\n-   **Approximation Condition:** $|\\alpha X| \\ll 1$ for the relevant propagation distance $X$.\n-   **Source and Receiver:** The source is at $(0,0)$ and the receiver is at $(X,Y)$, where $X > 0$ and $Y \\in \\mathbb{R}$.\n-   **Governing Principle:** High-frequency wave propagation is governed by the Eikonal equation and Fermat’s principle.\n-   **Travel Time Functional:** $T[\\gamma] = \\int_{\\gamma} s(\\mathbf{r}) \\,\\mathrm{d}\\ell$, where $s(\\mathbf{r}) = 1/v(\\mathbf{r})$ is the slowness and $\\mathrm{d}\\ell$ is the Euclidean line element.\n-   **Constraint:** The ray path is monotonic in $x$ from $x=0$ to $x=X$.\n-   **Objective:**\n    1.  Derive the first-order ray bending, expressed as the local ray angle $\\theta(x)$ with respect to the $x$-axis.\n    2.  Derive the first-order one-way travel time $T$ from $(0,0)$ to $(X,Y)$.\n-   **Output Format:** Provide the final answer as a pair of closed-form analytic expressions $(\\theta(x), T)$, with terms retained up to first order in $\\alpha$.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded:** The problem is based on fundamental principles of wave propagation in inhomogeneous media, namely the Eikonal equation and Fermat's principle of least time. The velocity model $v(x,y) = v_0(1+\\alpha x)$ represents a simple, physically realistic linear gradient, which is a standard model used in geophysics and acoustics for analytical studies. All concepts are well-established within physics.\n-   **Well-Posed:** The problem provides two fixed endpoints and a well-defined velocity field. It asks for the path and travel time, which can be determined uniquely under the given approximations using the calculus of variations. The requirement to work to first order in a small parameter $\\alpha$ is a standard and well-posed perturbation problem.\n-   **Objective:** The problem is stated using precise mathematical language and definitions. There are no subjective or ambiguous terms.\n-   **Completeness:** The problem is self-contained. It provides the velocity function, boundary conditions (source and receiver locations), the physical principle to apply (Fermat's), and the required order of approximation. The assumption of monotonicity in $x$ is explicitly stated, which legitimizes parametrizing the path as $y(x)$.\n-   **Consistency and Feasibility:** The givens are mutually consistent. The condition $|\\alpha X| \\ll 1$ ensures that the first-order Taylor expansion is valid over the domain of interest. The setup is physically plausible.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. It is a standard problem in theoretical seismology and wave propagation that is scientifically sound, well-posed, and complete. A solution will be derived.\n\n### Derivation\n\nThe solution will be found by applying the calculus of variations to Fermat's principle. The travel time $T$ for a path $y(x)$ from $(0,0)$ to $(X,Y)$ is given by the functional:\n$$T[y] = \\int \\frac{\\mathrm{d}\\ell}{v(x,y)} = \\int_0^X \\frac{\\sqrt{1 + (y'(x))^2}}{v_0(1+\\alpha x)} \\mathrm{d}x$$\nThe integrand is the Lagrangian $L(x, y', y) = s(x) \\sqrt{1 + (y')^2}$, where $s(x) = \\frac{1}{v_0(1+\\alpha x)}$ is the slowness. Since $L$ does not depend explicitly on $y$, the Euler-Lagrange equation $\\frac{\\partial L}{\\partial y} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\frac{\\partial L}{\\partial y'} = 0$ simplifies to $\\frac{\\mathrm{d}}{\\mathrm{d}x}\\frac{\\partial L}{\\partial y'} = 0$. This implies that $\\frac{\\partial L}{\\partial y'}$ is a constant along the ray path. This constant is the ray parameter, denoted by $p$.\n\n$$\\frac{\\partial L}{\\partial y'} = \\frac{1}{v_0(1+\\alpha x)} \\frac{y'}{\\sqrt{1+(y')^2}} = p$$\nThe local ray angle $\\theta(x)$ is related to the slope by $y'(x) = \\tan(\\theta(x))$. Substituting this, we get:\n$$\\frac{\\tan(\\theta(x))}{v(x) \\sqrt{1+\\tan^2(\\theta(x))}} = \\frac{\\sin(\\theta(x))}{v(x)} = p$$\nThis is the differential form of Snell's Law for a vertically-varying medium (here, varying in $x$). Let $\\theta_0 = \\theta(0)$ be the initial launch angle at the source. At $x=0$, $v(0)=v_0$, so $p = \\frac{\\sin(\\theta_0)}{v_0}$. Thus, the angle along the path satisfies:\n$$\\sin(\\theta(x)) = v(x) p = v_0(1+\\alpha x) \\frac{\\sin(\\theta_0)}{v_0} = \\sin(\\theta_0)(1+\\alpha x)$$\n\nTo find the path and angle, we use a perturbation approach. Let the path be $y(x) = y^{(0)}(x) + y^{(1)}(x) + \\dots$, where $y^{(0)}$ corresponds to the $\\alpha=0$ case (a straight line).\nThe unperturbed path is $y^{(0)}(x) = \\frac{Y}{X}x$. The angle for this path is constant: $\\theta^{(0)} = \\arctan(Y/X)$.\nLet the true launch angle be $\\theta_0 = \\theta^{(0)} + \\delta\\theta_0$, where $\\delta\\theta_0$ is of order $\\alpha$.\nTo first order in $\\alpha$, we have:\n$$y'(x) = \\tan(\\theta(x)) = \\frac{\\sin(\\theta(x))}{\\sqrt{1-\\sin^2(\\theta(x))}} \\approx \\frac{\\sin(\\theta_0)(1+\\alpha x)}{\\sqrt{1-\\sin^2(\\theta_0)(1+2\\alpha x)}}$$\nExpanding to first order in $\\alpha$:\n$\\sin(\\theta_0) \\approx \\sin(\\theta^{(0)}) + \\delta\\theta_0 \\cos(\\theta^{(0)})$.\n$\\sin(\\theta_0)(1+\\alpha x) \\approx (\\sin(\\theta^{(0)}) + \\delta\\theta_0 \\cos(\\theta^{(0)}))(1+\\alpha x) \\approx \\sin(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0 \\cos(\\theta^{(0)})$.\nThe denominator is $\\cos(\\theta(x))$. To first order, $\\cos(\\theta(x)) \\approx \\cos(\\theta^{(0)})$.\nSo, $y'(x) \\approx \\frac{\\sin(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0\\cos(\\theta^{(0)})}{\\cos(\\theta^{(0)})} = \\tan(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0$.\nThe path is found by integrating $y'(x)$:\n$$Y = \\int_0^X y'(x) \\mathrm{d}x \\approx \\int_0^X \\left(\\tan(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0\\right) \\mathrm{d}x$$\n$$Y \\approx \\left[ x\\tan(\\theta^{(0)}) + \\frac{1}{2}\\alpha x^2 \\tan(\\theta^{(0)}) + x\\delta\\theta_0 \\right]_0^X = X\\tan(\\theta^{(0)}) + \\frac{1}{2}\\alpha X^2 \\tan(\\theta^{(0)}) + X\\delta\\theta_0$$\nSince $Y = X\\tan(\\theta^{(0)})$, we have:\n$$0 \\approx \\frac{1}{2}\\alpha X^2 \\tan(\\theta^{(0)}) + X\\delta\\theta_0 \\implies \\delta\\theta_0 = -\\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})$$\nNow we find the local angle $\\theta(x)$. Let $\\theta(x) = \\theta^{(0)} + \\delta\\theta(x)$.\n$\\sin(\\theta(x)) \\approx \\sin(\\theta^{(0)}) + \\delta\\theta(x)\\cos(\\theta^{(0)})$.\nFrom Snell's law, $\\sin(\\theta(x)) = \\sin(\\theta_0)(1+\\alpha x)$. To first order:\n$\\sin(\\theta_0)(1+\\alpha x) \\approx (\\sin(\\theta^{(0)}) + \\delta\\theta_0\\cos(\\theta^{(0)}))(1+\\alpha x) \\approx \\sin(\\theta^{(0)}) + \\alpha x \\sin(\\theta^{(0)}) + \\delta\\theta_0\\cos(\\theta^{(0)})$.\nSubstituting $\\delta\\theta_0 = -\\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})$:\n$\\sin(\\theta_0)(1+\\alpha x) \\approx \\sin(\\theta^{(0)}) + \\alpha x \\sin(\\theta^{(0)}) - \\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})\\cos(\\theta^{(0)}) = \\sin(\\theta^{(0)})\\left(1 + \\alpha x - \\frac{1}{2}\\alpha X\\right)$.\nEquating the two expressions for $\\sin(\\theta(x))$:\n$\\sin(\\theta^{(0)}) + \\delta\\theta(x)\\cos(\\theta^{(0)}) \\approx \\sin(\\theta^{(0)})\\left(1 + \\alpha\\left(x - \\frac{X}{2}\\right)\\right)$.\n$\\delta\\theta(x)\\cos(\\theta^{(0)}) \\approx \\alpha \\sin(\\theta^{(0)})\\left(x - \\frac{X}{2}\\right) \\implies \\delta\\theta(x) = \\alpha \\tan(\\theta^{(0)})\\left(x - \\frac{X}{2}\\right)$.\nSubstituting $\\tan(\\theta^{(0)}) = Y/X$, the first-order ray angle is:\n$$\\theta(x) = \\theta^{(0)} + \\delta\\theta(x) = \\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X}\\left(x - \\frac{X}{2}\\right)$$\n\nNext, we derive the travel time $T$. By Fermat's principle, the first-order perturbation in travel time can be calculated by integrating the slowness perturbation along the unperturbed path $\\gamma_0$.\n$T = T_0 + \\delta T$.\nThe unperturbed travel time is $T_0 = \\frac{\\text{length of } \\gamma_0}{v_0} = \\frac{\\sqrt{X^2+Y^2}}{v_0}$.\nThe slowness is $s(x) = \\frac{1}{v_0(1+\\alpha x)} \\approx \\frac{1}{v_0}(1-\\alpha x)$.\nThe slowness perturbation is $\\delta s(x) = s(x) - s_0 = \\frac{1}{v_0}(1-\\alpha x) - \\frac{1}{v_0} = -\\frac{\\alpha x}{v_0}$.\nThe travel time perturbation is $\\delta T = \\int_{\\gamma_0} \\delta s(x) \\mathrm{d}\\ell$.\nThe unperturbed path $\\gamma_0$ is a straight line. We can parametrize it by $x$: $\\mathrm{d}\\ell = \\sqrt{1+(y^{(0)\\prime})^2} \\mathrm{d}x = \\sqrt{1 + (Y/X)^2} \\mathrm{d}x = \\frac{\\sqrt{X^2+Y^2}}{X} \\mathrm{d}x$.\n$$\\delta T = \\int_0^X \\left(-\\frac{\\alpha x}{v_0}\\right) \\frac{\\sqrt{X^2+Y^2}}{X} \\mathrm{d}x = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\int_0^X x \\mathrm{d}x$$\n$$\\delta T = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\left[\\frac{x^2}{2}\\right]_0^X = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\frac{X^2}{2} = -\\frac{\\alpha X \\sqrt{X^2+Y^2}}{2v_0}$$\nThe total travel time is $T = T_0 + \\delta T$:\n$$T = \\frac{\\sqrt{X^2+Y^2}}{v_0} - \\frac{\\alpha X \\sqrt{X^2+Y^2}}{2v_0} = \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)$$\n\nThe final expressions for the local ray angle $\\theta(x)$ and the travel time $T$ to first order in $\\alpha$ are:\n$\\theta(x) = \\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X} \\left(x - \\frac{X}{2}\\right)$\n$T = \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)$\nThese constitute the required pair of results.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X} \\left(x - \\frac{X}{2}\\right) & \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Computational geophysics provides a powerful laboratory for exploring how complex geology affects seismic data in ways that are difficult to isolate with field experiments. This advanced exercise challenges you to model the Amplitude-Versus-Offset (AVO) response from a sub-wavelength thin layer and quantify the resulting bias in interpretation. By implementing a physically consistent wave propagation model and an inversion loop, you will gain direct insight into the concept of effective media and its practical implications for seismic exploration .",
            "id": "3614101",
            "problem": "You are to investigate how sub-wavelength heterogeneity biases Amplitude-Versus-Offset (AVO) analysis in a one-dimensional layered acoustic medium by comparing inversion results from a thin-bed model to those from a homogeneous layered effective medium. Work within the framework of computational geophysics and seismic wave propagation in heterogeneous media, at the scale where layer thickness is much smaller than the dominant seismic wavelength. The objective is to compute a synthetic reflection amplitude-versus-angle gather using a physically consistent plane-wave formulation, invert for an effective impedance contrast assuming a two-term AVO model, and quantify the bias introduced by a thin, sub-wavelength layer relative to a corresponding homogeneous two-layer baseline.\n\nUse the following fundamental base:\n- The linear acoustic wave equation for pressure $p(\\mathbf{x},t)$ in a fluid of density $\\rho$ and compressional wave speed $v$ is $ \\nabla^2 p - \\frac{1}{v^2}\\frac{\\partial^2 p}{\\partial t^2} = 0$.\n- For a time-harmonic plane wave of angular frequency $\\omega$, the pressure field admits solutions of the form $p(\\mathbf{x},t) = \\Re\\{ \\tilde{p}(\\mathbf{x}) e^{-i \\omega t} \\}$, where $\\tilde{p}(\\mathbf{x})$ satisfies Helmholtz-type relations. For a plane wave with horizontal slowness $p$ (in units of $\\mathrm{s/m}$), the vertical wavenumber in a layer with speed $v$ is $k_z = \\omega \\sqrt{v^{-2} - p^2} = \\frac{\\omega}{v} q$, with $q = \\sqrt{1 - (p v)^2}$.\n- At each interface between fluid layers, the boundary conditions enforce continuity of pressure and of normal particle velocity. For an obliquely incident plane wave in a fluid, the characteristic normal acoustic impedance is $Z_n = \\frac{\\rho v}{q}$.\n- For a fluid layer of thickness $h$ and characteristic normal impedance $Z_n$ that is terminated by a load impedance $Z_L$ at its base, the input impedance at its top is given by the standard transmission-line recursion $Z_{\\mathrm{in}} = Z_n \\, \\frac{Z_L + i Z_n \\tan \\phi}{Z_n + i Z_L \\tan \\phi}$, where $\\phi = \\omega \\frac{h}{v} q$ is the phase thickness. The net plane-wave reflection coefficient $R$ at the interface between a fluid half-space above (characteristic normal impedance $Z_{\\mathrm{top}}$) and the load $Z_{\\mathrm{in}}$ below is $R = \\frac{Z_{\\mathrm{in}} - Z_{\\mathrm{top}}}{Z_{\\mathrm{in}} + Z_{\\mathrm{top}}}$.\n- The horizontal slowness is defined by Snell’s law for the top medium: $p = \\frac{\\sin \\theta_0}{v_0}$, where $\\theta_0$ is the incidence angle in the top half-space and $v_0$ is its compressional wave speed.\n\nYou must:\n1. Simulate the plane-wave reflection amplitude-versus-angle $R(\\theta_0)$ for a three-layer system composed of a top half-space (layer index $0$), a single finite-thickness thin layer (layer index $1$), and a bottom half-space (layer index $2$). Adopt the narrow-band approximation: use a central frequency $f_0$ with angular frequency $\\omega_0 = 2 \\pi f_0$ and take the real part of the complex plane-wave reflection coefficient at $\\omega_0$ as the observable amplitude. Use the oblique-incidence transmission-line recursion to combine the thin layer with the bottom half-space into a load seen from the top half-space. Assume all layers are acoustic fluids.\n2. Construct an AVO gather at a set of incidence angles $\\{\\theta_k\\}$ (angles are measured in degrees). For each $\\theta_k$, compute $p_k = \\sin(\\theta_k \\cdot \\pi/180)/v_0$, then $R(\\theta_k)$ as above, and define the observed amplitude as $\\Re\\{R(\\theta_k;\\omega_0)\\}$.\n3. Invert the gather for the two-term AVO intercept-gradient model $R(\\theta) \\approx A + B \\sin^2 \\theta$ by least squares over all angles, solving for the intercept $A$ and the gradient $B$. Define the inverted “effective impedance contrast” as $\\Delta Z_{\\mathrm{eff}}/ \\bar{Z} \\equiv 2 A$ (dimensionless).\n4. For the “layered effective media” baseline, remove the thin layer and consider only the two half-spaces (top and bottom). Compute the angle-dependent reflection coefficient $R_{\\mathrm{base}}(\\theta)$ between half-space $0$ and half-space $2$ using the same oblique-incidence fluid-fluid reflection framework (which for two half-spaces reduces to the impedance mismatch without any finite-thickness phase). Fit the same two-term model $R_{\\mathrm{base}}(\\theta) \\approx A_{\\mathrm{base}} + B_{\\mathrm{base}} \\sin^2 \\theta$ by least squares, and define the baseline effective contrast as $\\Delta Z_{\\mathrm{base}}/\\bar{Z} \\equiv 2 A_{\\mathrm{base}}$.\n5. Quantify the heterogeneity-induced AVO bias as the absolute difference $E \\equiv \\left| \\left(\\Delta Z_{\\mathrm{eff}}/\\bar{Z}\\right) - \\left(\\Delta Z_{\\mathrm{base}}/\\bar{Z}\\right) \\right|$ (dimensionless). This is a scalar for each test case.\n\nPhysical units and numerical conventions:\n- Compressional wave speeds $v_j$ must be specified in $\\mathrm{m/s}$.\n- Densities $\\rho_j$ must be specified in $\\mathrm{kg/m^3}$.\n- Thicknesses $h_j$ must be specified in $\\mathrm{m}$.\n- Frequency $f_0$ must be specified in $\\mathrm{Hz}$.\n- Incidence angles $\\theta$ must be specified in degrees; trigonometric evaluations must be performed in radians.\n- The final error $E$ is dimensionless; report it as a decimal number.\n\nAssumptions for scientific realism:\n- Use incidence angles that do not exceed the smallest critical angle across the model so that $p v_j < 1$ for all layers (no evanescent waves).\n- The thin layer thickness is sub-wavelength at the chosen central frequency $f_0$ in order to represent sub-wavelength heterogeneity.\n\nTest suite you must implement and evaluate:\n- Case $1$ (happy path, soft thin interbed): $v_0 = 2200\\,\\mathrm{m/s}$, $\\rho_0 = 2200\\,\\mathrm{kg/m^3}$; thin layer: $v_1 = 1800\\,\\mathrm{m/s}$, $\\rho_1 = 2000\\,\\mathrm{kg/m^3}$, $h_1 = 5\\,\\mathrm{m}$; bottom half-space: $v_2 = 2600\\,\\mathrm{m/s}$, $\\rho_2 = 2300\\,\\mathrm{kg/m^3}$; central frequency $f_0 = 30\\,\\mathrm{Hz}$; incidence angles $\\theta \\in \\{0^\\circ, 10^\\circ, 20^\\circ, 30^\\circ\\}$.\n- Case $2$ (boundary, no heterogeneity): same as Case $1$ but with thin layer thickness $h_1 = 0\\,\\mathrm{m}$.\n- Case $3$ (hard thin interbed, stronger contrast): $v_0 = 2500\\,\\mathrm{m/s}$, $\\rho_0 = 2200\\,\\mathrm{kg/m^3}$; thin layer: $v_1 = 3000\\,\\mathrm{m/s}$, $\\rho_1 = 2600\\,\\mathrm{kg/m^3}$, $h_1 = 8\\,\\mathrm{m}$; bottom half-space: $v_2 = 2400\\,\\mathrm{m/s}$, $\\rho_2 = 2100\\,\\mathrm{kg/m^3}$; central frequency $f_0 = 35\\,\\mathrm{Hz}$; incidence angles $\\theta \\in \\{0^\\circ, 5^\\circ, 15^\\circ, 25^\\circ, 30^\\circ\\}$.\n- Case $4$ (frequency effect, longer wavelength): same as Case $1$ but with central frequency $f_0 = 10\\,\\mathrm{Hz}$ and thin layer thickness $h_1 = 5\\,\\mathrm{m}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the four bias values $E$ for the test suite, as a comma-separated list enclosed in square brackets, for example $[e_1,e_2,e_3,e_4]$, where each $e_k$ is a decimal number. No other text must be printed.",
            "solution": "The objective of this problem is to quantify the bias introduced by sub-wavelength heterogeneity in Amplitude-Versus-Offset (AVO) analysis. This is accomplished by comparing the AVO inversion results from a one-dimensional, three-layer acoustic model, which includes a thin intermediate layer, against a simplified two-layer baseline model that omits it. The analysis is performed within the framework of plane-wave propagation in a layered fluid medium.\n\nThe physical model is based on the time-harmonic acoustic wave equation. For a plane wave with angular frequency $\\omega$ and horizontal slowness $p$, the propagation in a layered medium is conveniently described using an analogy to transmission lines. The key quantity is the angle-dependent characteristic normal acoustic impedance for each layer $j$, defined as:\n$$\nZ_{n,j} = \\frac{\\rho_j v_j}{q_j}\n$$\nwhere $\\rho_j$ is the fluid density, $v_j$ is the compressional wave speed, and $q_j$ is the vertical component of the slowness vector, normalized by $\\omega/v_j$:\n$$\nq_j = \\sqrt{1 - (p v_j)^2}\n$$\nThe horizontal slowness $p$ is constant across all layers due to Snell's law and is determined by the incidence angle $\\theta_0$ in the top medium (layer $0$):\n$$\np = \\frac{\\sin\\theta_0}{v_0}\n$$\nThe condition that no evanescent waves are generated requires $p v_j < 1$ for all layers $j$.\n\nThe first step is to calculate the plane-wave reflection coefficient for the three-layer system. This system consists of a top half-space (layer $0$), a thin layer of finite thickness $h_1$ (layer $1$), and a bottom half-space (layer $2$). The combination of layer $1$ and layer $2$ can be treated as a single system whose properties are seen from the interface between layer $0$ and layer $1$. The bottom half-space acts as a load impedance, $Z_L = Z_{n,2}$, for the thin layer. The input impedance $Z_{\\mathrm{in}}$ at the top of layer $1$ is then found using the transmission-line recursion formula:\n$$\nZ_{\\mathrm{in}} = Z_{n,1} \\frac{Z_L + i Z_{n,1} \\tan \\phi_1}{Z_{n,1} + i Z_L \\tan \\phi_1}\n$$\nwhere $i = \\sqrt{-1}$ is the imaginary unit and $\\phi_1$ is the angle-dependent phase thickness of the layer:\n$$\n\\phi_1 = \\omega \\frac{h_1}{v_{1}} q_1 = k_{z,1} h_1\n$$\nHere, $k_{z,1}$ is the vertical wavenumber in layer $1$. The total reflection coefficient $R(\\theta_0)$ for a wave incident from layer $0$ onto this composite system is given by the impedance contrast between the top half-space and the input impedance of the underlying structure:\n$$\nR(\\theta_0) = \\frac{Z_{\\mathrm{in}} - Z_{n,0}}{Z_{\\mathrm{in}} + Z_{n,0}}\n$$\nSince $Z_{\\mathrm{in}}$ is generally a complex number due to the phase-shift term $\\tan\\phi_1$, the reflection coefficient $R(\\theta_0)$ is also complex. The problem specifies that the observable seismic amplitude is the real part of this coefficient, evaluated at the central angular frequency $\\omega_0 = 2 \\pi f_0$: $r_{\\mathrm{eff}}(\\theta_0) = \\Re\\{R(\\theta_0; \\omega_0)\\}$. A set of these amplitudes, computed for discrete angles $\\{\\theta_k\\}$, forms the synthetic AVO gather for the thin-bed model.\n\nThe second step is to construct the baseline model. This model consists only of the top half-space (layer $0$) and the bottom half-space (layer $2$), effectively setting the thin-layer thickness to zero, $h_1=0$. In this case, the phase thickness $\\phi_1 = 0$, $\\tan\\phi_1 = 0$, and the input impedance formula simplifies to $Z_{\\mathrm{in}} = Z_L = Z_{n,2}$. The baseline reflection coefficient $R_{\\mathrm{base}}(\\theta_0)$ is thus a real-valued function (for non-evanescent waves) given by the direct contrast between the two half-spaces:\n$$\nR_{\\mathrm{base}}(\\theta_0) = \\frac{Z_{n,2} - Z_{n,0}}{Z_{n,2} + Z_{n,0}}\n$$\nThis calculation is repeated for the same set of angles $\\{\\theta_k\\}$ to generate a baseline AVO gather, $\\{r_{\\mathrm{base}}(\\theta_k)\\}$.\n\nThe third step is to perform AVO inversion on both synthetic gathers. We use the linearized two-term AVO approximation, $R(\\theta) \\approx A + B \\sin^2\\theta$. For each gather—the effective (thin-bed) and the baseline—we solve for the intercept $A$ and gradient $B$ using linear least squares. This involves solving the matrix system $\\mathbf{M}\\mathbf{x} = \\mathbf{r}$, where $\\mathbf{r}$ is the vector of computed reflection amplitudes, $\\mathbf{x} = [A, B]^T$ is the vector of unknown coefficients, and $\\mathbf{M}$ is the design matrix whose rows are $[1, \\sin^2\\theta_k]$ for each angle in the gather. The least-squares solution is $\\mathbf{x} = (\\mathbf{M}^T\\mathbf{M})^{-1}\\mathbf{M}^T\\mathbf{r}$. This procedure yields the intercept for the thin-bed model, $A_{\\mathrm{eff}}$, and for the baseline model, $A_{\\mathrm{base}}$.\n\nFinally, the AVO bias is quantified. The AVO intercept $A$ is related to the normal-incidence reflection coefficient, which is approximately proportional to the relative impedance contrast, $A \\approx \\frac{1}{2} \\frac{\\Delta Z}{\\bar{Z}}$. The problem defines the inverted \"effective impedance contrast\" as $2A$. The bias $E$ introduced by the thin bed is then the absolute difference between the effective impedance contrast derived from the thin-bed model and that from the baseline two-layer model:\n$$\nE = \\left| (2 A_{\\mathrm{eff}}) - (2 A_{\\mathrm{base}}) \\right| = 2 |A_{\\mathrm{eff}} - A_{\\mathrm{base}}|\n$$\n\nThe overall algorithm proceeds by iterating through each test case. For each case, we define the physical properties and the set of incidence angles. We then compute the two AVO gathers, perform the two separate least-squares inversions to find $A_{\\mathrm{eff}}$ and $A_{\\mathrm{base}}$, and calculate the final bias $E$. This provides a quantitative measure of how the presence of a sub-wavelength layer alters the AVO intercept, a key parameter in seismic interpretation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the AVO bias introduced by a sub-wavelength thin layer for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path, soft thin interbed)\n        {\n            \"v\": (2200.0, 1800.0, 2600.0), \"rho\": (2200.0, 2000.0, 2300.0), \"h1\": 5.0,\n            \"f0\": 30.0, \"angles\": [0.0, 10.0, 20.0, 30.0]\n        },\n        # Case 2 (boundary, no heterogeneity)\n        {\n            \"v\": (2200.0, 1800.0, 2600.0), \"rho\": (2200.0, 2000.0, 2300.0), \"h1\": 0.0,\n            \"f0\": 30.0, \"angles\": [0.0, 10.0, 20.0, 30.0]\n        },\n        # Case 3 (hard thin interbed, stronger contrast)\n        {\n            \"v\": (2500.0, 3000.0, 2400.0), \"rho\": (2200.0, 2600.0, 2100.0), \"h1\": 8.0,\n            \"f0\": 35.0, \"angles\": [0.0, 5.0, 15.0, 25.0, 30.0]\n        },\n        # Case 4 (frequency effect, longer wavelength)\n        {\n            \"v\": (2200.0, 1800.0, 2600.0), \"rho\": (2200.0, 2000.0, 2300.0), \"h1\": 5.0,\n            \"f0\": 10.0, \"angles\": [0.0, 10.0, 20.0, 30.0]\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        v = case[\"v\"]\n        rho = case[\"rho\"]\n        h1 = case[\"h1\"]\n        f0 = case[\"f0\"]\n        angles_deg = np.array(case[\"angles\"])\n\n        # Calculate AVO intercept for the thin-bed model\n        A_eff = calculate_avo_intercept(v, rho, h1, f0, angles_deg, is_thin_bed=True)\n\n        # Calculate AVO intercept for the baseline (two-layer) model\n        A_base = calculate_avo_intercept(v, rho, h1, f0, angles_deg, is_thin_bed=False)\n\n        # Quantify the bias\n        bias = 2 * abs(A_eff - A_base)\n        results.append(bias)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_avo_intercept(v, rho, h1, f0, angles_deg, is_thin_bed):\n    \"\"\"\n    Computes the AVO intercept 'A' for a given model configuration.\n\n    Args:\n        v (tuple): P-wave speeds (v0, v1, v2) in m/s.\n        rho (tuple): Densities (rho0, rho1, rho2) in kg/m^3.\n        h1 (float): Thickness of the thin layer in m.\n        f0 (float): Central frequency in Hz.\n        angles_deg (np.ndarray): Array of incidence angles in degrees.\n        is_thin_bed (bool): If True, use the 3-layer model. If False, use the 2-layer baseline.\n\n    Returns:\n        float: The AVO intercept parameter 'A'.\n    \"\"\"\n    v0, v1, v2 = v\n    rho0, rho1, rho2 = rho\n    omega0 = 2.0 * np.pi * f0\n    angles_rad = np.deg2rad(angles_deg)\n\n    r_gather = []\n    for theta0_rad in angles_rad:\n        # Horizontal slowness p\n        p = np.sin(theta0_rad) / v0\n\n        # Calculate q and normal impedances for all layers\n        # Using np.sqrt with complex numbers to handle potential (though avoided) evanescent cases gracefully\n        q0 = np.sqrt(1 - (p * v0)**2 + 0j)\n        q1 = np.sqrt(1 - (p * v1)**2 + 0j)\n        q2 = np.sqrt(1 - (p * v2)**2 + 0j)\n\n        Z_n0 = (rho0 * v0) / q0\n        Z_n1 = (rho1 * v1) / q1\n        Z_n2 = (rho2 * v2) / q2\n\n        if is_thin_bed:\n            if h1 == 0.0:\n                # If thickness is zero, it's equivalent to the baseline case\n                Z_in = Z_n2\n            else:\n                # Phase thickness for layer 1\n                phi1 = omega0 * (h1 / v1) * q1\n                # Input impedance at the top of layer 1 using transmission line formula\n                numerator = Z_n2 + 1j * Z_n1 * np.tan(phi1)\n                denominator = Z_n1 + 1j * Z_n2 * np.tan(phi1)\n                Z_in = Z_n1 * (numerator / denominator)\n        else: # Baseline model\n            Z_in = Z_n2\n\n        # Reflection coefficient at the top interface\n        R = (Z_in - Z_n0) / (Z_in + Z_n0)\n        \n        # Observable amplitude is the real part\n        r_gather.append(np.real(R))\n\n    # AVO inversion by least squares\n    # R(theta) = A + B * sin^2(theta)\n    r_vector = np.array(r_gather)\n    \n    # Design matrix M for the linear system M * x = r_vector\n    # where x = [A, B]^T\n    M = np.vstack([np.ones(len(angles_rad)), np.sin(angles_rad)**2]).T\n\n    # Solve for [A, B] using least squares\n    A, _ = np.linalg.lstsq(M, r_vector, rcond=None)[0]\n\n    return A\n\nsolve()\n```"
        }
    ]
}