{
    "hands_on_practices": [
        {
            "introduction": "孔隙介质力学仿真的核心是求解压力扩散方程。数值求解该方程需要选择时间步进格式，其中显式和隐式格式是两种最基本的选择。这一选择对计算的稳定性、准确性和效率有着深远的影响。本练习  将引导你亲手分析这两种格式的稳定性限制，这对于该领域的任何计算科学家来说都是一项基本技能。通过推导，你将清晰地看到岩石渗透率等物理参数如何直接制约数值模拟中的最大稳定时间步长，并理解高流度比如何给非线性求解器带来挑战。",
            "id": "3611794",
            "problem": "考虑多孔岩石中与水力裂缝相邻的二维滤失区域，该区域由质量守恒和达西定律推导出的压力扩散方程建模。令 $p(\\boldsymbol{x},t)$ 表示孔隙压力，定义总储集系数（压缩性）为 $C$（等于孔隙度乘以总压缩性），流体流度为 $\\lambda = k/\\mu$，其中 $k$ 是固有渗透率，$\\mu$ 是动力粘度。压力扩散方程为\n$$\nC \\, \\frac{\\partial p}{\\partial t} = \\nabla \\cdot \\big( \\lambda \\, \\nabla p \\big),\n$$\n在基质区域中，$\\lambda$ 被视作常数。该区域在均匀的笛卡尔网格上进行离散化，每个坐标方向的间距为 $h$，空间算子使用标准的五点模板上的二阶中心差分进行近似。\n\nA 部分（显式格式）：对上述离散扩散方程使用前向欧拉时间离散化，通过基于傅里叶（冯·诺依曼）模态的线性稳定性分析，估算最大稳定时间步长 $\\Delta t_{\\mathrm{exp},\\max}$，用 $h$、$k$、$\\mu$ 和 $C$ 表示。假设为二维空间。\n\nB 部分（隐式格式和非线性收敛）：现在考虑后向欧拉时间离散化，但由于裂缝和基质之间存在强烈的流度对比，产生了非线性空间耦合。通过引入一个流度为 $\\lambda_{f}$ 的裂缝单元和一个流度为 $\\lambda_{m}=k/\\mu$ 的基质单元来模拟这种对比。定义流度比为\n$$\nM = \\frac{\\lambda_{f}}{\\lambda_{m}},\n$$\n并假设在裂缝-基质界面处，最大的局部算子范数贡献与 $\\lambda_{m} + \\lambda_{f} = \\lambda_{m} (1+M)$ 成正比。从后向欧拉引起的非线性残差映射的不动点（Picard）观点出发，通过用二维中最坏情况下的五点模板因子来界定离散算子范数，估算一个时间步长的充分上界 $\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max}$，以保证 Picard 映射在无穷范数下是收缩的。\n\nC 部分（高流度比对非线性收敛的影响）：对于给定的试验时间步长 $\\Delta t$，使用与 B 部分相同的算子范数界，将 Picard 迭代的诱导收缩因子 $q(M,\\Delta t)$ 用 $h$、$k$、$\\mu$、$C$ 和 $M$ 表示。将“收缩因子”视为迭代映射在无穷范数下的 Lipschitz 常数。\n\n请以 $h$、$k$、$\\mu$、$C$ 和 $M$ 的封闭形式解析表达式提供 $\\Delta t_{\\mathrm{exp},\\max}$、$\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max}$ 和 $q(M,\\Delta t)$ 的最终答案。请用符号表示答案，不要代入数值。如果需要多个表达式，请按规定以单个行矩阵的形式呈现。最终方框内的表达式无需单位。",
            "solution": "该问题经核实具有科学依据，提法恰当且客观。它提出了计算地球物理学中偏微分方程数值分析领域一系列标准而重要的问题。推导所需量所需的所有信息均已提供。\n\n解答分为三部分，与问题陈述的三个部分相对应。\n\n### A 部分：显式格式的最大稳定时间步长\n\n压力扩散方程由下式给出\n$$\nC \\, \\frac{\\partial p}{\\partial t} = \\nabla \\cdot \\big( \\lambda \\, \\nabla p \\big)\n$$\n在基质区域，流度 $\\lambda = k/\\mu$ 被视为常数。该方程简化为标准的热/扩散方程：\n$$\n\\frac{\\partial p}{\\partial t} = D \\nabla^2 p\n$$\n其中 $D = \\lambda/C$ 是水力扩散系数。\n\n我们在间距为 $h$ 的均匀二维笛卡尔网格上离散化该方程。空间算子 $\\nabla^2$ 使用二阶中心差分的五点模板进行近似：\n$$\n\\nabla^2 p(x_i, y_j, t) \\approx \\frac{p_{i+1,j} - 2p_{i,j} + p_{i-1,j}}{h^2} + \\frac{p_{i,j+1} - 2p_{i,j} + p_{i,j-1}}{h^2}\n$$\n其中 $p_{i,j}(t) = p(ih, jh, t)$。半离散化方程为\n$$\nC \\frac{d p_{i,j}}{dt} = \\frac{\\lambda}{h^2} \\left( p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4p_{i,j} \\right)\n$$\n对时间进行离散化，应用时间步长为 $\\Delta t$ 的前向欧拉法，其中 $p_{i,j}^n = p(ih, jh, n\\Delta t)$：\n$$\nC \\frac{p_{i,j}^{n+1} - p_{i,j}^n}{\\Delta t} = \\frac{\\lambda}{h^2} \\left( p_{i+1,j}^n + p_{i-1,j}^n + p_{i,j+1}^n + p_{i,j-1}^n - 4p_{i,j}^n \\right)\n$$\n对 $p_{i,j}^{n+1}$ 进行整理，得到显式更新规则：\n$$\np_{i,j}^{n+1} = p_{i,j}^n + \\frac{\\lambda \\Delta t}{C h^2} \\left( p_{i+1,j}^n + p_{i-1,j}^n + p_{i,j+1}^n + p_{i,j-1}^n - 4p_{i,j}^n \\right)\n$$\n对于冯·诺依曼稳定性分析，我们代入一个通用的傅里叶模态作为误差，$p_{i,j}^n = G^n e^{I(k_x i h + k_y j h)}$，其中 $I = \\sqrt{-1}$，$G$ 是放大因子。\n$$\nG^{n+1} e^{I(k_x i h + k_y j h)} = G^n e^{I(k_x i h + k_y j h)} + \\frac{\\lambda \\Delta t}{C h^2} G^n e^{I(k_x i h + k_y j h)} \\left( e^{I k_x h} + e^{-I k_x h} + e^{I k_y h} + e^{-I k_y h} - 4 \\right)\n$$\n两边同除以 $G^n e^{I(k_x i h + k_y j h)}$ 得到放大因子 $G$：\n$$\nG = 1 + \\frac{\\lambda \\Delta t}{C h^2} (2\\cos(k_x h) + 2\\cos(k_y h) - 4)\n$$\n$$\nG = 1 - \\frac{2\\lambda \\Delta t}{C h^2} (2 - \\cos(k_x h) - \\cos(k_y h))\n$$\n使用恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\nG = 1 - \\frac{2\\lambda \\Delta t}{C h^2} (2\\sin^2(k_x h/2) + 2\\sin^2(k_y h/2)) = 1 - \\frac{4\\lambda \\Delta t}{C h^2} (\\sin^2(k_x h/2) + \\sin^2(k_y h/2))\n$$\n为保证稳定性，我们需要 $|G| \\le 1$。由于 $G$ 是实数，这意味着 $-1 \\le G \\le 1$。乘以时间步长的项是非负的，所以 $G \\le 1$ 总是满足的。关键条件是 $G \\ge -1$：\n$$\n-1 \\le 1 - \\frac{4\\lambda \\Delta t}{C h^2} (\\sin^2(k_x h/2) + \\sin^2(k_y h/2))\n$$\n$$\n\\frac{4\\lambda \\Delta t}{C h^2} (\\sin^2(k_x h/2) + \\sin^2(k_y h/2)) \\le 2\n$$\n$$\n\\Delta t \\le \\frac{2 C h^2}{4\\lambda (\\sin^2(k_x h/2) + \\sin^2(k_y h/2))} = \\frac{C h^2}{2\\lambda (\\sin^2(k_x h/2) + \\sin^2(k_y h/2))}\n$$\n为了对所有傅里叶模态都满足此条件，我们必须考虑最坏情况，即项 $(\\sin^2(k_x h/2) + \\sin^2(k_y h/2))$ 取最大值的情况。这发生在最高频率模态下，即 $k_x h = \\pi$ 且 $k_y h = \\pi$。\n$$\n\\max \\left(\\sin^2(k_x h/2) + \\sin^2(k_y h/2)\\right) = \\sin^2(\\pi/2) + \\sin^2(\\pi/2) = 1^2 + 1^2 = 2\n$$\n将此最大值代入不等式，得到稳定性极限：\n$$\n\\Delta t \\le \\frac{C h^2}{2\\lambda (2)} = \\frac{C h^2}{4\\lambda}\n$$\n因此，最大稳定时间步长为 $\\Delta t_{\\mathrm{exp},\\max} = \\frac{C h^2}{4\\lambda}$。代入 $\\lambda = k/\\mu$，我们得到\n$$\n\\Delta t_{\\mathrm{exp},\\max} = \\frac{C h^2 \\mu}{4 k}\n$$\n\n### B 部分：非线性隐式格式的时间步长界限\n\n对于采用后向欧拉离散化的非线性问题，在时间 $t_{n+1}$ 的压力向量 $P^{n+1}$ 的方程组为\n$$\nC \\frac{P^{n+1} - P^n}{\\Delta t} = \\mathcal{A}(P^{n+1})\n$$\n其中 $\\mathcal{A}(P)$ 代表非线性离散空间算子 $\\nabla_h \\cdot (\\lambda(P) \\nabla_h P)$。可以通过滞后非线性项来定义一个 Picard（或不动点）迭代格式：\n$$\nP^{(k+1)} = P^n + \\frac{\\Delta t}{C} \\mathcal{A}(P^{(k)})\n$$\n其中 $P^{(k)}$ 是第 $k$ 次 Picard 迭代时的压力向量。令迭代映射为 $\\Phi(P) = P^n + \\frac{\\Delta t}{C} \\mathcal{A}(P)$。为使迭代收敛，映射 $\\Phi$ 必须是一个收缩映射，这意味着其 Lipschitz 常数 $q$ 必须小于 $1$。Lipschitz 常数由下式给出\n$$\nq = \\text{Lip}(\\Phi) = \\frac{\\Delta t}{C} \\text{Lip}(\\mathcal{A})\n$$\n其中 $\\text{Lip}(\\mathcal{A})$ 可以由 $\\mathcal{A}$ 的雅可比矩阵范数的上确界 $\\sup_P \\|J_{\\mathcal{A}}(P)\\|_{\\infty}$ 来界定。问题为估算此界限提供了指导。它指出，分析应基于“裂缝-基质界面处的最大局部算子范数贡献”（与 $\\lambda_{m} + \\lambda_{f}$ 成正比）以及“二维空间中最坏情况下的五点模板因子”（即 $4$）。\n\n这提示我们与线性情况进行类比，在线性情况中，稳定性由算子范数决定。我们根据这些提示为非线性算子 $\\mathcal{A}$ 的 Lipschitz 常数构建一个估计：\n$$\n\\text{Lip}(\\mathcal{A}) \\approx \\frac{(\\text{模板因子}) \\times (\\text{流度项})}{h^2}\n$$\n使用所提供的值，我们估计界限为：\n$$\n\\text{Lip}(\\mathcal{A}) \\le \\frac{4(\\lambda_m + \\lambda_f)}{h^2}\n$$\nPicard 迭代成为收缩映射的条件（$q  1$）变为：\n$$\n\\frac{\\Delta t}{C} \\left( \\frac{4(\\lambda_m + \\lambda_f)}{h^2} \\right)  1\n$$\n这给出了时间步长 $\\Delta t$ 的一个充分条件：\n$$\n\\Delta t  \\frac{C h^2}{4(\\lambda_m + \\lambda_f)}\n$$\n保证收缩的最大时间步长是此区间的上界。使用流度比 $M = \\lambda_f / \\lambda_m$，我们有 $\\lambda_f = M \\lambda_m$。\n$$\n\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max} = \\frac{C h^2}{4(\\lambda_m + M \\lambda_m)} = \\frac{C h^2}{4\\lambda_m(1+M)}\n$$\n代入 $\\lambda_m = k/\\mu$，我们找到最终表达式：\n$$\n\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max} = \\frac{C h^2 \\mu}{4 k(1+M)}\n$$\n\n### C 部分：收缩因子表达式\n\n对于给定的试验时间步长 $\\Delta t$，收缩因子 $q(M, \\Delta t)$ 是 Picard 迭代映射 $\\Phi$ 的 Lipschitz 常数。根据 B 部分的推导：\n$$\nq(M, \\Delta t) = \\frac{\\Delta t}{C} \\text{Lip}(\\mathcal{A})\n$$\n使用与 B 部分相同的算子范数界，$\\text{Lip}(\\mathcal{A}) \\approx \\frac{4(\\lambda_m + \\lambda_f)}{h^2}$：\n$$\nq(M, \\Delta t) = \\frac{\\Delta t}{C} \\frac{4(\\lambda_m + \\lambda_f)}{h^2}\n$$\n我们用给定的变量 $h$、$k$、$\\mu$、$C$ 和 $M$ 来表示它。\n$$\n\\lambda_m + \\lambda_f = \\lambda_m(1+M) = \\frac{k}{\\mu}(1+M)\n$$\n将此代入 $q$ 的表达式中：\n$$\nq(M, \\Delta t) = \\frac{\\Delta t}{C} \\frac{4 \\frac{k}{\\mu}(1+M)}{h^2} = \\frac{4 \\Delta t k (1+M)}{C h^2 \\mu}\n$$\n此表达式显示了 Picard 迭代的收敛性如何随着时间步长 $\\Delta t$ 和流度比 $M$ 的增大而恶化（即 $q$ 增大）。\n\n### 最终表达式总结\n\n所要求的三个量是：\n1.  $\\Delta t_{\\mathrm{exp},\\max} = \\frac{C h^2 \\mu}{4 k}$\n2.  $\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max} = \\frac{C h^2 \\mu}{4 k (1+M)}$\n3.  $q(M, \\Delta t) = \\frac{4 \\Delta t k (1+M)}{C h^2 \\mu}$\n\n这些在最终答案中以行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{C h^{2} \\mu}{4 k}  \\frac{C h^{2} \\mu}{4 k (1+M)}  \\frac{4 \\Delta t k (1+M)}{C h^{2} \\mu} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "掌握了求解控制方程的数值方法后，我们将注意力转向断裂本身的物理机制。经典的断裂力学通常假设裂缝已经存在，但裂缝是如何从无到有产生的呢？本练习  将超越预存裂缝的假设，探索在一个看似完整的材料中裂缝如何成核这一基本问题。通过运用相场断裂模型，你将从第一性原理出发，基于能量平衡推导裂缝成核的临界孔隙压力，从而将连续介质力学的能量概念与材料的断裂韧性联系起来，并揭示材料内禀长度尺度的重要作用。",
            "id": "3611805",
            "problem": "考虑一个处于平面应变状态的二维矩形多孔弹性域 $\\Omega = (0,W) \\times (0,H)$，其杨氏模量为 $E$，泊松比为 $\\nu$，Biot 系数为 $\\alpha \\in (0,1]$。该域初始无应力，且不含任何预存裂纹或缺口。在整个孔隙空间中施加一个均匀的流体孔隙压力 $p_f$（例如，通过注入），使得固体骨架中的有效柯西应力遵循 Biot 的有效应力原理 $\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - \\alpha p_f \\mathbf{I}$。在没有外部牵引力的情况下，$\\boldsymbol{\\sigma} = \\boldsymbol{0}$，因此 $\\boldsymbol{\\sigma}' = -\\alpha p_f \\mathbf{I}$。\n\n假设一个通过标量相场 $d(\\mathbf{x}) \\in [0,1]$ 正则化的脆性断裂模型，其中 $d=0$ 表示材料完好，$d=1$ 表示材料完全断裂。采用标准的二次退化函数 $g(d) = (1-d)^2$ 和 Ambrosio–Tortorelli 裂纹面密度\n$$\n\\gamma_{\\ell}(d,\\nabla d) \\;=\\; \\frac{1}{2\\ell}\\,d^{2} \\;+\\; \\frac{\\ell}{2}\\,|\\nabla d|^{2},\n$$\n其中 $\\ell0$ 是控制正则化裂纹宽度的内禀长度尺度。固体骨架的总自由能密度为 $g(d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon})$，其中 $\\psi_{0}(\\boldsymbol{\\varepsilon})$ 是未损伤材料的线性弹性能密度。对于平面应变下的 I 型加载，相关刚度为平面应变模量 $E' = E/(1-\\nu^{2})$。\n\n考虑在 $\\Omega$ 中心形核一条直的、水平的 I 型裂纹。假设 $\\ell \\ll \\min\\{W,H\\}$，因此形核过程由一个一维剖面 $d(x)$ 决定，该剖面沿着垂直于预期裂纹面的坐标 $x$ 分布，且满足 $d(0)=1$ 和 $d(\\pm\\infty)=0$。使用一个基于能量的论证，该论证依据的是在宽度为 $\\mathcal{O}(\\ell)$ 的带内材料退化所释放的弹性能与形成相场裂纹所消耗的断裂能之间的平衡。具体而言：\n\n1) 在 $d(0)=1$ 和 $d(\\pm\\infty)=0$ 的约束条件下，推导使 $\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x$ 最小化的驻定一维损伤剖面 $d^{*}(x)$，并计算以下两个积分\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x,\n\\qquad\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x.\n$$\n\n2) 使用第 (1) 部分的结果，并取主导的 I 型有效张力下的未损伤弹性能密度为 $\\psi_{0} = \\sigma'^{2}/(2E')$，其中 $\\sigma' = \\alpha p_f$，推导当裂纹形核在能量上有利时临界孔隙压力 $p_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha)$ 的闭式表达式。最终答案以帕斯卡为单位表示。无需四舍五入；提供一个闭式表达式。\n\n3) 简要讨论当 $\\ell \\to 0$ 时您所得表达式的极限行为，及其与线性弹性断裂力学 (LEFM) 的关系，包括在无瑕疵体中的形核与从半长为 $a$ 的预存狭缝裂纹扩展之间的对比。裂纹扩展由 I 型应力强度因子 $K_{I} = p_f \\sqrt{\\pi a}$ 和 Griffith 关系式 $G_c = K_{I}^{2}/E'$ 控制。\n\n您的最终答案必须是关于 $p_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha)$ 的一个单一闭式解析表达式。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定且自洽的。这是断裂相场模拟领域的一个标准问题，基于连续介质力学、多孔弹性力学和变分法的既定原理。因此，有必要给出完整解答。\n\n该问题要求解在无瑕疵的多孔弹性介质中使裂纹形核所需的临界孔隙压力。我们将遵循问题陈述中概述的三个部分来解决此问题。\n\n**第一部分：最优一维损伤剖面的推导及相关积分**\n\n我们的任务是找到最小化总裂纹表面能泛函\n$$\nJ[d] = \\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d, d')\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left( \\frac{1}{2\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2} \\right) \\mathrm{d}x,\n$$\n的一维损伤剖面 $d(x)$，该剖面需满足边界条件 $d(0)=1$ 和 $d(\\pm\\infty)=0$。此处，$d' = \\mathrm{d}d/\\mathrm{d}x$。\n\n这是一个经典的变分法问题。最小化函数 $d^{*}(x)$ 必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0,\n$$\n其中拉格朗日量为 $L(d, d') = \\frac{1}{2\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2}$。\n\n偏导数是：\n$$\n\\frac{\\partial L}{\\partial d} = \\frac{d}{\\ell},\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = \\ell d'.\n$$\n将这些代入欧拉-拉格朗日方程，得到二阶常微分方程：\n$$\n\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\ell d') = 0 \\quad \\implies \\quad \\frac{d}{\\ell} - \\ell d'' = 0 \\quad \\implies \\quad \\ell^{2} d'' - d = 0.\n$$\n这个齐次线性常微分方程的通解是\n$$\nd(x) = C_1 \\exp(x/\\ell) + C_2 \\exp(-x/\\ell).\n$$\n我们应用边界条件。当 $x \\to \\infty$ 时 $d(x) \\to 0$ 的条件要求 $C_1 = 0$。当 $x \\to -\\infty$ 时 $d(x) \\to 0$ 的条件要求 $C_2 = 0$。这表明我们应该对 $x0$ 和 $x0$ 分段考虑解。\n\n对于 $x  0$，满足 $d(\\infty)=0$ 的解是 $d(x) = C_2 \\exp(-x/\\ell)$。\n对于 $x  0$，满足 $d(-\\infty)=0$ 的解是 $d(x) = C_1 \\exp(x/\\ell)$。\n为确保在 $x=0$ 处的连续性，两个表达式必须得到相同的值。条件 $d(0)=1$ 给出 $C_1 = 1$ 和 $C_2 = 1$。得到的剖面关于 $x=0$ 对称。\n因此，满足边界条件的驻定损伤剖面是：\n$$\nd^{*}(x) = \\exp(-|x|/\\ell).\n$$\n现在我们使用这个最优剖面 $d^{*}(x)$ 来计算所需的两个积分。\n\n第一个积分：\n该积分代表每单位面积的正则化裂纹表面积。$d^{*}(x)$ 的导数是 $d^{*'}(x) = -\\frac{\\mathrm{sgn}(x)}{\\ell} \\exp(-|x|/\\ell)$。其平方是 $(d^{*'}(x))^2 = \\frac{1}{\\ell^2} \\exp(-2|x|/\\ell)$。\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left[ \\frac{(d^{*})^2}{2\\ell} + \\frac{\\ell}{2}(d^{*'})^2 \\right] \\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\exp(-2|x|/\\ell)}{2\\ell} + \\frac{\\ell}{2} \\left(\\frac{1}{\\ell^2} \\exp(-2|x|/\\ell)\\right) \\right] \\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\exp(-2|x|/\\ell)}{2\\ell} + \\frac{\\exp(-2|x|/\\ell)}{2\\ell} \\right] \\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\frac{1}{\\ell} \\exp(-2|x|/\\ell) \\mathrm{d}x.\n$$\n由于被积函数是偶函数，我们可以写成：\n$$\n= 2 \\int_{0}^{\\infty} \\frac{1}{\\ell} \\exp(-2x/\\ell) \\mathrm{d}x = \\frac{2}{\\ell} \\left[ -\\frac{\\ell}{2} \\exp(-2x/\\ell) \\right]_{0}^{\\infty} = -1 \\left[ \\exp(-\\infty) - \\exp(0) \\right] = -1(0 - 1) = 1.\n$$\n所以，第一个积分是 $\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x = 1$。这是该公式体系下的一个标准归一化结果。\n\n第二个积分：\n该积分代表释放弹性能的有效体积。退化函数为 $g(d) = (1-d)^2$。\n$$\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left[1 - (1-d^{*}(x))^2\\right]\\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\big[1 - (1 - 2d^{*} + (d^{*})^2)\\big]\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\big[2d^{*} - (d^{*})^2\\big]\\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ 2\\exp(-|x|/\\ell) - \\exp(-2|x|/\\ell) \\right] \\mathrm{d}x.\n$$\n我们利用被积函数的偶函数性质，分别计算这两个部分：\n$$\n\\int_{-\\infty}^{\\infty} 2\\exp(-|x|/\\ell) \\mathrm{d}x = 4\\int_{0}^{\\infty} \\exp(-x/\\ell) \\mathrm{d}x = 4 [-\\ell \\exp(-x/\\ell)]_{0}^{\\infty} = 4\\ell.\n$$\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-2|x|/\\ell) \\mathrm{d}x = 2\\int_{0}^{\\infty} \\exp(-2x/\\ell) \\mathrm{d}x = 2 [-\\frac{\\ell}{2} \\exp(-2x/\\ell)]_{0}^{\\infty} = \\ell.\n$$\n综合这些结果：\n$$\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x = 4\\ell - \\ell = 3\\ell.\n$$\n\n**第二部分：临界孔隙压力的推导**\n\n当形成裂纹时总自由能的变化 $\\Delta\\mathcal{E}$ 为零或负时，裂纹形核在能量上变得有利。临界条件对应于 $\\Delta\\mathcal{E}=0$。\n每单位预期裂纹面面积的总自由能由以下泛函给出：\n$$\n\\mathcal{E}[d] = \\int_{-\\infty}^{\\infty} \\left[ g(d(x))\\,\\psi_{0} + G_c\\,\\gamma_{\\ell}(d(x), d'(x)) \\right] \\mathrm{d}x,\n$$\n其中 $\\psi_0$ 是未损伤弹性能密度，$G_c$ 是材料的断裂韧性（临界能量释放率）。未损伤状态对应于对所有 $x$ 都有 $d(x)=0$，因此其能量为 $\\mathcal{E}[0] = \\int_{-\\infty}^{\\infty} g(0)\\,\\psi_{0} \\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\psi_{0} \\,\\mathrm{d}x$。\n\n由于形成裂纹剖面 $d^{*}(x)$ 引起的能量变化是：\n$$\n\\Delta \\mathcal{E} = \\mathcal{E}[d^*] - \\mathcal{E}[0] = \\int_{-\\infty}^{\\infty} \\left[ (g(d^*) - 1)\\,\\psi_{0} + G_c\\,\\gamma_{\\ell}(d^*, d^{*'}) \\right] \\mathrm{d}x\n$$\n$$\n\\Delta \\mathcal{E} = -\\psi_{0} \\int_{-\\infty}^{\\infty} [1 - g(d^*)]\\,\\mathrm{d}x + G_c \\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d^*, d^{*'})\\,\\mathrm{d}x.\n$$\n第一项代表从体材料中释放的弹性能，第二项是创建断裂面所消耗的能量。\n使用第一部分计算的积分，能量变化为：\n$$\n\\Delta\\mathcal{E} = -\\psi_{0} (3\\ell) + G_c (1).\n$$\n形核的临界条件是 $\\Delta\\mathcal{E}=0$，这给出了临界弹性能密度：\n$$\n\\psi_{0,\\mathrm{crit}} = \\frac{G_c}{3\\ell}.\n$$\n问题陈述指出，对于 I 型加载，$\\psi_0 = \\sigma'^{2}/(2E')$，其中有效拉应力为 $\\sigma' = \\alpha p_f$，平面应变模量为 $E' = E/(1-\\nu^2)$。\n将这些代入临界条件：\n$$\n\\frac{(\\alpha p_{f,\\mathrm{crit}})^{2}}{2E'} = \\frac{G_c}{3\\ell}.\n$$\n我们求解临界孔隙压力 $p_{f,\\mathrm{crit}}$：\n$$\n(\\alpha p_{f,\\mathrm{crit}})^{2} = \\frac{2E'G_c}{3\\ell}\n$$\n$$\np_{f,\\mathrm{crit}}^{2} = \\frac{2E'G_c}{3\\ell\\alpha^2} = \\frac{2EG_c}{3\\ell\\alpha^2(1-\\nu^2)}.\n$$\n取正平方根，得到临界孔隙压力的最终表达式：\n$$\np_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha) = \\frac{1}{\\alpha}\\sqrt{\\frac{2EG_c}{3\\ell(1-\\nu^2)}}.\n$$\n\n**第三部分：极限行为的讨论**\n\n推导出的临界形核压力表达式为 $p_{f,\\mathrm{crit}} \\propto 1/\\sqrt{\\ell}$。当内禀长度尺度 $\\ell$ 趋近于零（$\\ell \\to 0$）时，形核所需的临界压力趋于无穷大（$p_{f,\\mathrm{crit}} \\to \\infty$）。这个极限对应于从正则化（相场）断裂理论到像线性弹性断裂力学 (LEFM) 这样的尖锐裂纹理论的过渡。该结果意味着，理论上完美的、无瑕疵的、均匀的弹性固体具有无限的抗拉强度。断裂不能凭空形核；它需要一个已存在的缺陷。\n\n这与 LEFM 方法形成根本性对比，LEFM 分析的是预存裂纹的扩展。对于一个长度为 $2a$ 的预存穿透裂纹，在远场拉应力 $\\sigma'$ 的作用下，其 I 型应力强度因子为 $K_I = \\sigma' \\sqrt{\\pi a}$。问题陈述为水力压裂给出了一个类似的表达式 $K_I = p_f \\sqrt{\\pi a}$，其中压力 $p_f$ 作用在裂纹面上。根据 Griffith 准则，当能量释放率 $G = K_I^2/E'$ 达到材料的韧性 $G_c$ 时，裂纹开始扩展。因此，扩展的临界压力为：\n$$\nG_c = \\frac{(p_{f,\\mathrm{prop}} \\sqrt{\\pi a})^2}{E'} \\implies p_{f,\\mathrm{prop}} = \\sqrt{\\frac{E'G_c}{\\pi a}} = \\sqrt{\\frac{EG_c}{\\pi a(1-\\nu^2)}}.\n$$\n在 LEFM 中，扩展压力 $p_{f,\\mathrm{prop}} \\propto 1/\\sqrt{a}$。强度由最大预存缺陷的尺寸 $a$ 控制，而不是一个内禀的材料长度尺度。当 $a \\to 0$ 时，$p_{f,\\mathrm{prop}} \\to \\infty$，这再次表明 LEFM 无法预测形核。相场模型通过引入内禀长度尺度 $\\ell$ 来正则化这个奇点，$\\ell$ 在物理上可以解释为材料微观结构尺寸（例如晶粒尺寸）的一种度量，为断裂过程区提供了一个特征长度。对于任何 $\\ell  0$，相场形核强度是有限的，从而有效地设定了在没有更大宏观缺陷的情况下材料的内禀强度。",
            "answer": "$$\n\\boxed{\\frac{1}{\\alpha} \\sqrt{\\frac{2EG_c}{3\\ell(1-\\nu^{2})}}}\n$$"
        },
        {
            "introduction": "真实世界的水力压裂模拟涉及多种物理过程，而这些过程往往发生在截然不同的时间尺度上，从流体快速注入到缓慢的压力扩散。这种多尺度特性给数值模拟带来了巨大挑战。本压轴练习  要求你直面这一挑战，设计一个稳健的自适应时间步长算法。你将综合运用流体扩散、裂缝扩展和滤失等物理过程的知识，创建一个能同时保证数值稳定性和计算效率的智能控制系统，这是开发实用压裂模拟软件的关键一步。",
            "id": "3611786",
            "problem": "您需要为一个简化的多相孔隙力学和水力压裂中的一维流动-断裂耦合问题设计并实现一个时间步长自适应策略。该算法必须基于对水力扩散时间尺度和裂缝前缘推进约束的估计，并将其结合在一个类似于 Courant–Friedrichs–Lewy (CFL) 的耦合稳定性最小化准则中。您的程序必须为每个指定的参数集计算一个自适应时间步长。\n\n仅从基本定律和核心定义出发。具体来说，从多孔介质流动的动量平衡（达西定律）和微可压缩多相混合物的质量守恒相结合开始。在不使用任何预先给定的简化公式的情况下，推导出：\n- 适用于流经具有固有渗透率的多孔基质的微可压缩多相混合物的线性化压力方程的有效水力扩散系数。\n- 在间距为 $\\Delta x$ 的均匀网格上对一维扩散方程进行显式时间积分的稳定性时间步长约束。\n- 一个遵循 Courant–Friedrichs–Lewy 准则精神的裂缝前缘推进约束，该约束基于前缘速度 $v_f$ 和特征尖端单元长度 $\\ell_{\\mathrm{tip}}$，并使用一个无量纲安全系数。\n- 一个由特征排泄长度 $L_c$ 和扩散系数构建的滤失或横向排泄时间尺度，并使用一个无量纲安全系数。\n- 一个最终规则，该规则选择时间步长为上述约束和施加的最大值中的最小值，但绝不小于一个规定的最小值。\n\n您的实现必须：\n- 从相对渗透率和粘度计算多相总流度。\n- 从固有渗透率、总流度、孔隙度和总压缩系数计算有效扩散系数。\n- 计算三个候选时间步长界限（网格扩散、裂缝前缘平流、排泄/滤失），并包含用户指定的安全系数。将任何不适用的约束（例如，零流度或零裂缝速度）视为非限制性的，为其分配一个有效的无限大界限。\n- 选择最终的自适应时间步长为所有有限界限和用户指定的最大值中的最小值，然后从下方强制施加用户指定的最小界限。\n\n物理单位和数值格式：\n- 所有长度必须以米 (m) 为单位，渗透率以平方米 (m$^2$) 为单位，粘度以帕斯卡-秒 (Pa·s) 为单位，压缩系数以帕斯卡的倒数 (Pa$^{-1}$) 为单位，速度以米每秒 (m/s) 为单位，时间以秒 (s) 为单位。\n- 您的程序必须以秒为单位输出每个自适应时间步长，形式为十进制浮点数，四舍五入到小数点后恰好六位，输出中不含单位符号。\n\n测试套件和要求的输出格式：\n- 使用以下五个测试用例。每个测试用例是一个元组，顺序为 $(\\Delta x, k, \\phi, c_t, k_{rw}, k_{ro}, \\mu_w, \\mu_o, v_f, \\ell_{\\mathrm{tip}}, L_c, C_d, C_{\\mathrm{tip}}, C_{\\mathrm{leak}}, \\Delta t_{\\max}, \\Delta t_{\\min})$，其中所有符号如上所述，所有输入均以一致的单位给出。下面的每个数值都使用其指定的单位：\n    1. $(0.25,\\;1\\times 10^{-19},\\;0.12,\\;8\\times 10^{-10},\\;0.2,\\;0.6,\\;1\\times 10^{-3},\\;2\\times 10^{-3},\\;0.5,\\;0.05,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;1.0,\\;1\\times 10^{-6})$\n    2. $(0.1,\\;1\\times 10^{-14},\\;0.2,\\;1\\times 10^{-9},\\;0.5,\\;0.5,\\;1\\times 10^{-3},\\;3\\times 10^{-3},\\;0.2,\\;0.02,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;0.5,\\;1\\times 10^{-6})$\n    3. $(0.2,\\;1\\times 10^{-18},\\;0.15,\\;1\\times 10^{-9},\\;0.1,\\;0.1,\\;1\\times 10^{-3},\\;2\\times 10^{-3},\\;0.0,\\;0.05,\\;0.1,\\;0.45,\\;0.8,\\;0.5,\\;100.0,\\;1\\times 10^{-6})$\n    4. $(0.3,\\;1\\times 10^{-20},\\;0.12,\\;1\\times 10^{-9},\\;0.0,\\;0.0,\\;1\\times 10^{-3},\\;1\\times 10^{-3},\\;1.0,\\;0.01,\\;0.03,\\;0.45,\\;0.8,\\;0.5,\\;1.0,\\;1\\times 10^{-6})$\n    5. $(0.1,\\;1\\times 10^{-20},\\;0.1,\\;1\\times 10^{-9},\\;0.0,\\;0.0,\\;1\\times 10^{-3},\\;1\\times 10^{-3},\\;0.0,\\;0.02,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;10.0,\\;1\\times 10^{-6})$\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如 $\\left[\\Delta t_1,\\Delta t_2,\\dots\\right]$，其中每个 $\\Delta t_i$ 是测试用例 $i$ 的自适应时间步长，格式化为小数点后六位，单位为秒。输出不得包含空格和任何其他文本。\n\n将所有最终数值答案以秒表示，并确保严格遵守上述四舍五入规则。",
            "solution": "该问题要求为一个简化的、一维的流体流动与裂缝扩展耦合问题设计并实现一个自适应时间步长算法，这是计算地球物理学中模拟水力压裂的常见任务。该方法必须从基本原理（即质量守恒和达西定律）推导而来，并结合与数值稳定性和裂缝扩展物理学相关的约束条件。\n\n推导和算法设计将分五个阶段进行：\n1.  推导多孔介质中多相流的有效水力扩散系数 $D$。\n2.  推导所得扩散方程的显式有限差分格式的数值稳定性约束 $\\Delta t_d$。\n3.  建立与裂缝前缘推进相关的物理时间尺度约束 $\\Delta t_{\\mathrm{tip}}$。\n4.  建立与流体向地层滤失相关的物理时间尺度约束 $\\Delta t_{\\mathrm{leak}}$。\n5.  将这些约束综合成一个用于选择自适应时间步长 $\\Delta t$ 的单一规则。\n\n**1. 多相流的有效水力扩散系数**\n\n推导始于多孔固体基质内流体混合物的质量守恒原理。单位体积内的流体质量由孔隙度 $\\phi$ 和平均流体密度 $\\rho_t$ 的乘积给出。质量守恒定律的微分形式为：\n$$\n\\frac{\\partial (\\phi \\rho_t)}{\\partial t} + \\nabla \\cdot (\\rho_t \\mathbf{v}_t) = 0\n$$\n其中 $\\mathbf{v}_t$ 是总流体体积通量（达西速度），$t$ 是时间。\n\n对于一个微可压缩系统，流体密度和孔隙度都随流体压力 $p$ 而变化。这种综合效应由总压缩系数 $c_t$ 捕捉，其定义为单位压力变化引起的流体质量含量的分数变化：\n$$\nc_t = \\frac{1}{\\phi \\rho_t} \\frac{\\partial (\\phi \\rho_t)}{\\partial p}\n$$\n使用链式法则，存储项（守恒方程中的第一项）可以表示为：\n$$\n\\frac{\\partial (\\phi \\rho_t)}{\\partial t} = \\frac{\\partial (\\phi \\rho_t)}{\\partial p} \\frac{\\partial p}{\\partial t} = (\\phi c_t \\rho_t) \\frac{\\partial p}{\\partial t}\n$$\n将此代入守恒定律，得到：\n$$\n(\\phi c_t \\rho_t) \\frac{\\partial p}{\\partial t} + \\nabla \\cdot (\\rho_t \\mathbf{v}_t) = 0\n$$\n假设密度的空间梯度与通量的梯度相比可以忽略不计（一种常见的线性化处理），我们可以将其简化为：\n$$\n\\phi c_t \\frac{\\partial p}{\\partial t} + \\nabla \\cdot \\mathbf{v}_t = 0\n$$\n总体积通量 $\\mathbf{v}_t$ 由达西定律的多相扩展描述。对于两个不互溶相，如水（$w$）和油（$o$），总通量是各相通量的总和：\n$$\n\\mathbf{v}_t = \\mathbf{v}_w + \\mathbf{v}_o\n$$\n每个相的通量由 $\\mathbf{v}_\\alpha = -\\frac{k k_{r\\alpha}}{\\mu_\\alpha} \\nabla p$ 给出，其中 $k$ 是多孔介质的固有渗透率，$k_{r\\alpha}$ 是 $\\alpha$ 相的相对渗透率，$\\mu_\\alpha$ 是其动力粘度。我们假设单个压力场 $p$ 控制两相的流动。\n将通量求和得到：\n$$\n\\mathbf{v}_t = -\\left( \\frac{k k_{rw}}{\\mu_w} + \\frac{k k_{ro}}{\\mu_o} \\right) \\nabla p\n$$\n我们将总流度 $\\lambda_t$ 定义为各相流度之和：$\\lambda_t = \\lambda_w + \\lambda_o = \\frac{k_{rw}}{\\mu_w} + \\frac{k_{ro}}{\\mu_o}$。这可将总通量表达式简化为：\n$$\n\\mathbf{v}_t = -k \\lambda_t \\nabla p\n$$\n将此通量代回简化的守恒方程，得到：\n$$\n\\phi c_t \\frac{\\partial p}{\\partial t} - \\nabla \\cdot (k \\lambda_t \\nabla p) = 0\n$$\n假设 $k$ 和 $\\lambda_t$ 是局部常数，我们得到线性压力扩散方程：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{k \\lambda_t}{\\phi c_t} \\nabla^2 p\n$$\n该方程具有 $\\frac{\\partial p}{\\partial t} = D \\nabla^2 p$ 的一般形式。通过比较，我们确定有效水力扩散系数 $D$ 为：\n$$\nD = \\frac{k \\lambda_t}{\\phi c_t} = \\frac{k}{\\phi c_t} \\left( \\frac{k_{rw}}{\\mu_w} + \\frac{k_{ro}}{\\mu_o} \\right)\n$$\n\n**2. 扩散时间步长约束**\n\n此约束源于扩散方程显式时间积分格式的稳定性要求。对于间距为 $\\Delta x$ 的均匀网格上的一维问题，扩散方程为 $\\frac{\\partial p}{\\partial t} = D \\frac{\\partial^2 p}{\\partial x^2}$。使用前向时间中心空间（FTCS）离散格式：\n$$\n\\frac{p_i^{n+1} - p_i^n}{\\Delta t} = D \\frac{p_{i+1}^n - 2p_i^n + p_{i-1}^n}{(\\Delta x)^2}\n$$\n其中 $p_i^n$ 是在网格点 $i$ 和时间步 $n$ 处的压力。为使该格式数值稳定，时间步长 $\\Delta t$ 必须满足 Courant–Friedrichs–Lewy (CFL) 条件，对于该方程，此条件为：\n$$\n\\frac{2 D \\Delta t}{(\\Delta x)^2} \\le 1 \\implies \\Delta t \\le \\frac{(\\Delta x)^2}{2D}\n$$\n问题指定将一个无量纲安全系数 $C_d$ 应用于此理论极限。因此，由网格扩散引起的最大允许时间步长为：\n$$\n\\Delta t_d = C_d \\frac{(\\Delta x)^2}{2D}\n$$\n如果扩散系数 $D$ 为零（例如，如果总流度 $\\lambda_t = 0$），则不会发生扩散，此约束变为非限制性的，这在数学上等同于 $\\Delta t_d \\to \\infty$。\n\n**3. 裂缝前缘推进约束**\n\n此约束基于裂缝尖端在介质中扩展的物理过程。扩展是一个类平流过程，其中新裂缝位置的“信息”以前缘速度 $v_f$ 移动。需要一个类似 CFL 的条件来确保裂缝在一个时间步内推进不超过一个特征单元长度 $\\ell_{\\mathrm{tip}}$。基本约束为 $\\Delta t \\le \\ell_{\\mathrm{tip}} / v_f$。包含指定的安全系数 $C_{\\mathrm{tip}}$，我们得到约束：\n$$\n\\Delta t_{\\mathrm{tip}} = C_{\\mathrm{tip}} \\frac{\\ell_{\\mathrm{tip}}}{v_f}\n$$\n如果裂缝是静止的（$v_f = 0$），此约束是非限制性的，因此 $\\Delta t_{\\mathrm{tip}} \\to \\infty$。\n\n**4. 滤失时间尺度约束**\n\n此约束确保模拟能充分解析流体从高压裂缝泄漏到低压周围岩石基质的过程。这是一个由水力扩散系数 $D$ 控制的扩散过程。扩散在特征长度 $L$ 上达到平衡的特征时间 $T$ 由标度律 $T \\sim L^2/D$ 给出。在此背景下，特征长度是排泄长度 $L_c$。时间步长应是此特征时间的一部分，以捕捉瞬态动力学。使用指定的安全系数 $C_{\\mathrm{leak}}$，此约束可表述为：\n$$\n\\Delta t_{\\mathrm{leak}} = C_{\\mathrm{leak}} \\frac{L_c^2}{D}\n$$\n与扩散约束一样，如果 $D=0$，则不会发生滤失，此约束变为非限制性的，即 $\\Delta t_{\\mathrm{leak}} \\to \\infty$。\n\n**5. 最终自适应时间步长算法**\n\n最终的自适应时间步长 $\\Delta t$ 是通过同时遵守所有约束来确定的。这是通过从计算出的界限集合和用户施加的最大时间步长 $\\Delta t_{\\max}$ 中选择最严格的（即最小的）时间步长来实现的。此外，时间步长不允许低于用户施加的最小值 $\\Delta t_{\\min}$。完整的规则是：\n1.  计算三个基于物理推导的时间步长限制：$\\Delta t_d$、$\\Delta t_{\\mathrm{tip}}$ 和 $\\Delta t_{\\mathrm{leak}}$。\n2.  求这些值与规定的最大值 $\\Delta t_{\\max}$ 中的最小值：\n    $$ \\Delta t_{\\text{candidate}} = \\min(\\Delta t_d, \\Delta t_{\\mathrm{tip}}, \\Delta t_{\\mathrm{leak}}, \\Delta t_{\\max}) $$\n3.  确保最终的时间步长不小于规定的最小值 $\\Delta t_{\\min}$：\n    $$ \\Delta t = \\max(\\Delta t_{\\text{candidate}}, \\Delta t_{\\min}) $$\n这种“多阶段最小值，后跟一个带下限的最大值”的方法是在复杂的多物理场模拟中控制时间步长大小的一种稳健方法。实现将为每个提供的参数集计算此值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the adaptive time step for a series of test cases based on \n    multiphase poromechanics and hydraulic fracturing stability criteria.\n    \"\"\"\n\n    # Test cases: tuples in the order\n    # (delta_x, k, phi, c_t, k_rw, k_ro, mu_w, mu_o, v_f, l_tip, L_c, C_d, C_tip, C_leak, dt_max, dt_min)\n    test_cases = [\n        (0.25, 1e-19, 0.12, 8e-10, 0.2, 0.6, 1e-3, 2e-3, 0.5, 0.05, 0.05, 0.45, 0.8, 0.5, 1.0, 1e-6),\n        (0.1, 1e-14, 0.2, 1e-9, 0.5, 0.5, 1e-3, 3e-3, 0.2, 0.02, 0.05, 0.45, 0.8, 0.5, 0.5, 1e-6),\n        (0.2, 1e-18, 0.15, 1e-9, 0.1, 0.1, 1e-3, 2e-3, 0.0, 0.05, 0.1, 0.45, 0.8, 0.5, 100.0, 1e-6),\n        (0.3, 1e-20, 0.12, 1e-9, 0.0, 0.0, 1e-3, 1e-3, 1.0, 0.01, 0.03, 0.45, 0.8, 0.5, 1.0, 1e-6),\n        (0.1, 1e-20, 0.1, 1e-9, 0.0, 0.0, 1e-3, 1e-3, 0.0, 0.02, 0.05, 0.45, 0.8, 0.5, 10.0, 1e-6),\n    ]\n\n    results = []\n    for params in test_cases:\n        dt = calculate_adaptive_timestep(params)\n        results.append(f\"{dt:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_adaptive_timestep(params):\n    \"\"\"\n    Calculates the adaptive time step for a single parameter set.\n    \"\"\"\n    (delta_x, k, phi, c_t, k_rw, k_ro, mu_w, mu_o, v_f, \n     l_tip, L_c, C_d, C_tip, C_leak, dt_max, dt_min) = params\n\n    # 1. Calculate total mobility\n    # Ensure mu_w and mu_o are not zero to avoid division by zero\n    lambda_w = k_rw / mu_w if mu_w > 0 else 0\n    lambda_o = k_ro / mu_o if mu_o > 0 else 0\n    lambda_t = lambda_w + lambda_o\n\n    # 2. Calculate effective diffusivity\n    # Denominator check for physical validity\n    if phi > 0 and c_t > 0 and lambda_t > 0:\n        D = (k * lambda_t) / (phi * c_t)\n    else:\n        D = 0.0\n\n    # 3. Calculate time step bounds\n    # Initialize bounds to infinity (non-restrictive)\n    dt_d = float('inf')\n    dt_leak = float('inf')\n    dt_tip = float('inf')\n\n    # Diffusion along-grid constraint\n    if D > 0:\n        dt_d = C_d * (delta_x**2) / (2 * D)\n\n    # Transverse drainage / leak-off constraint\n    if D > 0:\n        dt_leak = C_leak * (L_c**2) / D\n\n    # Fracture-front advection constraint\n    if v_f > 0:\n        dt_tip = C_tip * l_tip / v_f\n\n    # 4. Apply final rule\n    # Find the minimum of all finite bounds and the user-specified maximum\n    dt_candidate = min(dt_d, dt_leak, dt_tip, dt_max)\n\n    # Enforce the user-specified minimum bound from below\n    final_dt = max(dt_candidate, dt_min)\n\n    return final_dt\n\nsolve()\n```"
        }
    ]
}