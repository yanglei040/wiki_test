{
    "hands_on_practices": [
        {
            "introduction": "Before simulating complex fracture networks, it is crucial to understand how a crack is represented in a computational model. This exercise explores the modern phase-field approach, where a crack is not a sharp discontinuity but a localized region of intense damage. By minimizing a free energy functional that balances stored elastic energy with the energy of creating new surfaces, you will derive the critical pressure for crack nucleation, a concept that provides a powerful alternative to classical fracture mechanics .",
            "id": "3611805",
            "problem": "Consider a two-dimensional rectangular porous elastic domain $\\Omega = (0,W) \\times (0,H)$ in plane strain with Young’s modulus $E$, Poisson’s ratio $\\nu$, and Biot coefficient $\\alpha \\in (0,1]$. The domain is initially stress-free and contains no pre-existing cracks or notches. A uniform fluid pore pressure $p_f$ is imposed throughout the pore space (e.g., by injection), so that the effective Cauchy stress in the solid skeleton obeys Biot’s effective stress principle $\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - \\alpha p_f \\mathbf{I}$. With no external tractions, $\\boldsymbol{\\sigma} = \\boldsymbol{0}$ and thus $\\boldsymbol{\\sigma}' = -\\alpha p_f \\mathbf{I}$.\n\nAssume a brittle fracture model regularized by a scalar phase-field $d(\\mathbf{x}) \\in [0,1]$, with intact material at $d=0$ and fully broken at $d=1$. Adopt the standard quadratic degradation $g(d) = (1-d)^2$ and the Ambrosio–Tortorelli crack surface density\n$$\n\\gamma_{\\ell}(d,\\nabla d) \\;=\\; \\frac{1}{2\\ell}\\,d^{2} \\;+\\; \\frac{\\ell}{2}\\,|\\nabla d|^{2},\n$$\nwhere $\\ell>0$ is the internal length scale that controls the width of the regularized crack. The total free energy density of the solid skeleton is $g(d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon})$, where $\\psi_{0}(\\boldsymbol{\\varepsilon})$ is the linear elastic energy density of the undamaged material and, for Mode I loading in plane strain, the relevant stiffness is the plane strain modulus $E' = E/(1-\\nu^{2})$.\n\nConsider the nucleation of a straight, horizontal, Mode I crack centered in $\\Omega$. Assume that $\\ell \\ll \\min\\{W,H\\}$ so that the nucleation process is governed by a one-dimensional profile $d(x)$ along the coordinate $x$ normal to the prospective crack plane, with $d(0)=1$ and $d(\\pm\\infty)=0$. Use an energetic argument based on the balance between the elastic energy released by degrading the material in a band of width $\\mathcal{O}(\\ell)$ and the fracture energy consumed by creating the phase-field crack. Specifically:\n\n1) Derive the stationary one-dimensional damage profile $d^{*}(x)$ that minimizes $\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x$ subject to $d(0)=1$ and $d(\\pm\\infty)=0$, and compute the two integrals\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x,\n\\qquad\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x.\n$$\n\n2) Using the result of part (1), and taking the undamaged elastic energy density under the dominant Mode I effective tension to be $\\psi_{0} = {\\sigma'}^{2}/(2E')$ with $\\sigma' = \\alpha p_f$, derive a closed-form expression for the critical pore pressure $p_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha)$ at which nucleation becomes energetically favorable. Express your final answer in Pascals. No rounding is required; provide a closed-form expression.\n\n3) Briefly discuss the limiting behavior of your expression as $\\ell \\to 0$ and its relation to Linear Elastic Fracture Mechanics (LEFM), including the contrast between nucleation in a flawless body and propagation from a pre-existing slit crack of half-length $a$ governed by the Mode I stress intensity $K_{I} = p_f \\sqrt{\\pi a}$ and the Griffith relation $G_c = K_{I}^{2}/E'$.\n\nYour final answer must be a single closed-form analytical expression for $p_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha)$.",
            "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, and self-contained. It is a standard problem in the field of phase-field modeling of fracture and is based on established principles of continuum mechanics, poroelasticity, and calculus of variations. A full solution is therefore warranted.\n\nThe problem asks for the critical pore pressure required to nucleate a crack in a flawless porous elastic medium. We will solve this by following the three parts outlined in the problem statement.\n\n**Part 1: Derivation of the Optimal 1D Damage Profile and Associated Integrals**\n\nWe are tasked with finding the one-dimensional damage profile $d(x)$ that minimizes the total crack surface energy functional,\n$$\nJ[d] = \\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d, d')\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left( \\frac{1}{2\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2} \\right) \\mathrm{d}x,\n$$\nsubject to the boundary conditions $d(0)=1$ and $d(\\pm\\infty)=0$. Here, $d' = \\mathrm{d}d/\\mathrm{d}x$.\n\nThis is a classic problem in the calculus of variations. The minimizer $d^{*}(x)$ must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0,\n$$\nwhere the Lagrangian is $L(d, d') = \\frac{1}{2\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2}$.\n\nThe partial derivatives are:\n$$\n\\frac{\\partial L}{\\partial d} = \\frac{d}{\\ell},\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = \\ell d'.\n$$\nSubstituting these into the Euler-Lagrange equation yields the second-order ordinary differential equation:\n$$\n\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\ell d') = 0 \\quad \\implies \\quad \\frac{d}{\\ell} - \\ell d'' = 0 \\quad \\implies \\quad \\ell^{2} d'' - d = 0.\n$$\nThe general solution to this homogeneous linear ODE is\n$$\nd(x) = C_1 \\exp(x/\\ell) + C_2 \\exp(-x/\\ell).\n$$\nWe apply the boundary conditions. The condition $d(x) \\to 0$ as $x \\to \\infty$ requires $C_1 = 0$. The condition $d(x) \\to 0$ as $x \\to -\\infty$ requires $C_2 = 0$. This suggests we should consider the solution piecewise for $x>0$ and $x<0$.\n\nFor $x > 0$, the solution that satisfies $d(\\infty)=0$ is $d(x) = C_2 \\exp(-x/\\ell)$.\nFor $x < 0$, the solution that satisfies $d(-\\infty)=0$ is $d(x) = C_1 \\exp(x/\\ell)$.\nTo ensure continuity at $x=0$, both expressions must yield the same value. The condition $d(0)=1$ gives $C_1 = 1$ and $C_2 = 1$. The resulting profile is symmetric about $x=0$.\nThus, the stationary damage profile that satisfies the boundary conditions is:\n$$\nd^{*}(x) = \\exp(-|x|/\\ell).\n$$\nNow we compute the two required integrals using this optimal profile $d^{*}(x)$.\n\nFirst integral:\nThis integral represents the regularized crack surface area per unit area. The derivative of $d^{*}(x)$ is $d^{*'}(x) = -\\frac{\\mathrm{sgn}(x)}{\\ell} \\exp(-|x|/\\ell)$. Its square is $(d^{*'}(x))^2 = \\frac{1}{\\ell^2} \\exp(-2|x|/\\ell)$.\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left[ \\frac{(d^{*})^2}{2\\ell} + \\frac{\\ell}{2}(d^{*'})^2 \\right] \\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\exp(-2|x|/\\ell)}{2\\ell} + \\frac{\\ell}{2} \\left(\\frac{1}{\\ell^2} \\exp(-2|x|/\\ell)\\right) \\right] \\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\exp(-2|x|/\\ell)}{2\\ell} + \\frac{\\exp(-2|x|/\\ell)}{2\\ell} \\right] \\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\frac{1}{\\ell} \\exp(-2|x|/\\ell) \\mathrm{d}x.\n$$\nSince the integrand is even, we can write:\n$$\n= 2 \\int_{0}^{\\infty} \\frac{1}{\\ell} \\exp(-2x/\\ell) \\mathrm{d}x = \\frac{2}{\\ell} \\left[ -\\frac{\\ell}{2} \\exp(-2x/\\ell) \\right]_{0}^{\\infty} = -1 \\left[ \\exp(-\\infty) - \\exp(0) \\right] = -1(0 - 1) = 1.\n$$\nSo, the first integral is $\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x = 1$. This is a standard normalization result for this formulation.\n\nSecond integral:\nThis integral represents the effective volume over which elastic energy is released. The degradation function is $g(d) = (1-d)^2$.\n$$\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left[1 - (1-d^{*}(x))^2\\right]\\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\big[1 - (1 - 2d^{*} + (d^{*})^2)\\big]\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\big[2d^{*} - (d^{*})^2\\big]\\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ 2\\exp(-|x|/\\ell) - \\exp(-2|x|/\\ell) \\right] \\mathrm{d}x.\n$$\nWe evaluate the two parts separately, using the even property of the integrands:\n$$\n\\int_{-\\infty}^{\\infty} 2\\exp(-|x|/\\ell) \\mathrm{d}x = 4\\int_{0}^{\\infty} \\exp(-x/\\ell) \\mathrm{d}x = 4 [-\\ell \\exp(-x/\\ell)]_{0}^{\\infty} = 4\\ell.\n$$\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-2|x|/\\ell) \\mathrm{d}x = 2\\int_{0}^{\\infty} \\exp(-2x/\\ell) \\mathrm{d}x = 2 [-\\frac{\\ell}{2} \\exp(-2x/\\ell)]_{0}^{\\infty} = \\ell.\n$$\nCombining these results:\n$$\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x = 4\\ell - \\ell = 3\\ell.\n$$\n\n**Part 2: Derivation of the Critical Pore Pressure**\n\nCrack nucleation becomes energetically favorable when the change in total free energy, $\\Delta\\mathcal{E}$, upon forming the crack is zero or negative. The critical condition corresponds to $\\Delta\\mathcal{E}=0$.\nThe total free energy per unit area of the prospective crack plane is given by the functional:\n$$\n\\mathcal{E}[d] = \\int_{-\\infty}^{\\infty} \\left[ g(d(x))\\,\\psi_{0} + G_c\\,\\gamma_{\\ell}(d(x), d'(x)) \\right] \\mathrm{d}x,\n$$\nwhere $\\psi_0$ is the undamaged elastic energy density and $G_c$ is the material's fracture toughness (critical energy release rate). The undamaged state corresponds to $d(x)=0$ for all $x$, so its energy is $\\mathcal{E}[0] = \\int_{-\\infty}^{\\infty} g(0)\\,\\psi_{0} \\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\psi_{0} \\,\\mathrm{d}x$.\n\nThe change in energy due to the formation of the crack profile $d^{*}(x)$ is:\n$$\n\\Delta \\mathcal{E} = \\mathcal{E}[d^*] - \\mathcal{E}[0] = \\int_{-\\infty}^{\\infty} \\left[ (g(d^*) - 1)\\,\\psi_{0} + G_c\\,\\gamma_{\\ell}(d^*, d^{*'}) \\right] \\mathrm{d}x\n$$\n$$\n\\Delta \\mathcal{E} = -\\psi_{0} \\int_{-\\infty}^{\\infty} [1 - g(d^*)]\\,\\mathrm{d}x + G_c \\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d^*, d^{*'})\\,\\mathrm{d}x.\n$$\nThe first term represents the elastic energy released from the bulk, and the second term is the energy consumed to create the fracture surface.\nUsing the integrals calculated in Part 1, the energy change is:\n$$\n\\Delta\\mathcal{E} = -\\psi_{0} (3\\ell) + G_c (1).\n$$\nThe critical condition for nucleation is $\\Delta\\mathcal{E}=0$, which gives the critical elastic energy density:\n$$\n\\psi_{0,\\mathrm{crit}} = \\frac{G_c}{3\\ell}.\n$$\nThe problem states that for Mode I loading, $\\psi_0 = {\\sigma'}^{2}/(2E')$, where the effective tensile stress is $\\sigma' = \\alpha p_f$ and the plane strain modulus is $E' = E/(1-\\nu^2)$.\nSubstituting these into the critical condition:\n$$\n\\frac{(\\alpha p_{f,\\mathrm{crit}})^{2}}{2E'} = \\frac{G_c}{3\\ell}.\n$$\nWe solve for the critical pore pressure, $p_{f,\\mathrm{crit}}$:\n$$\n(\\alpha p_{f,\\mathrm{crit}})^{2} = \\frac{2E'G_c}{3\\ell}\n$$\n$$\np_{f,\\mathrm{crit}}^{2} = \\frac{2E'G_c}{3\\ell\\alpha^2} = \\frac{2EG_c}{3\\ell\\alpha^2(1-\\nu^2)}.\n$$\nTaking the positive square root gives the final expression for the critical pore pressure:\n$$\np_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha) = \\frac{1}{\\alpha}\\sqrt{\\frac{2EG_c}{3\\ell(1-\\nu^2)}}.\n$$\n\n**Part 3: Discussion of Limiting Behavior**\n\nThe derived expression for the critical nucleation pressure is $p_{f,\\mathrm{crit}} \\propto 1/\\sqrt{\\ell}$. As the internal length scale $\\ell$ approaches zero ($\\ell \\to 0$), the critical pressure required for nucleation tends to infinity ($p_{f,\\mathrm{crit}} \\to \\infty$). This limit corresponds to the transition from a regularized (phase-field) fracture theory to a sharp-crack theory like Linear Elastic Fracture Mechanics (LEFM). The result implies that a theoretically perfect, flawless, homogeneous elastic solid has infinite tensile strength. Fracture cannot nucleate from nothing; it requires an existing flaw.\n\nThis contrasts fundamentally with the LEFM approach, which analyzes the propagation of a pre-existing crack. For a pre-existing through-crack of length $2a$ subjected to a far-field tension $\\sigma'$, the Mode I stress intensity factor is $K_I = \\sigma' \\sqrt{\\pi a}$. The problem statement gives an analogous expression $K_I = p_f \\sqrt{\\pi a}$ for hydraulic fracture, where pressure $p_f$ acts on the crack faces. According to Griffith's criterion, the crack propagates when the energy release rate $G = K_I^2/E'$ reaches the material's toughness $G_c$. The critical pressure for propagation is therefore:\n$$\nG_c = \\frac{(p_{f,\\mathrm{prop}} \\sqrt{\\pi a})^2}{E'} \\implies p_{f,\\mathrm{prop}} = \\sqrt{\\frac{E'G_c}{\\pi a}} = \\sqrt{\\frac{EG_c}{\\pi a(1-\\nu^2)}}.\n$$\nIn LEFM, the propagation pressure $p_{f,\\mathrm{prop}} \\propto 1/\\sqrt{a}$. The strength is governed by the size $a$ of the largest pre-existing flaw, not an intrinsic material length scale. As $a \\to 0$, $p_{f,\\mathrm{prop}} \\to \\infty$, which again shows LEFM cannot predict nucleation. The phase-field model regularizes this singularity by introducing the internal length scale $\\ell$, which can be physically interpreted as a measure of the material's microstructural size (e.g., grain size) that provides a characteristic length for the fracture process zone. The phase-field nucleation strength is finite for any $\\ell > 0$, effectively setting a material's intrinsic strength in the absence of larger macroscopic flaws.",
            "answer": "$$\n\\boxed{\\frac{1}{\\alpha} \\sqrt{\\frac{2EG_c}{3\\ell(1-\\nu^{2})}}}\n$$"
        },
        {
            "introduction": "The accuracy and feasibility of any poromechanical simulation hinge on the numerical methods used to solve the governing partial differential equations. This practice focuses on the crucial aspect of time discretization, exploring the trade-offs between explicit and implicit methods for the pressure diffusion equation. You will perform a stability analysis to determine the maximum stable time step for an explicit scheme and analyze how nonlinearity impacts the convergence of an implicit scheme, providing essential skills for building robust simulators .",
            "id": "3611794",
            "problem": "Consider a two-dimensional leak-off region adjacent to a hydraulic fracture in a porous rock, modeled by the pressure diffusion equation derived from mass conservation and Darcy’s law. Let $p(\\boldsymbol{x},t)$ denote the pore pressure, and define the total storage coefficient (compressibility) by $C$, and the fluid mobility by $\\lambda = k/\\mu$, where $k$ is the intrinsic permeability and $\\mu$ is the dynamic viscosity. The pressure diffusion equation is\n$$\nC \\, \\frac{\\partial p}{\\partial t} = \\nabla \\cdot \\big( \\lambda \\, \\nabla p \\big),\n$$\nwith $\\lambda$ treated as constant in the matrix region. The domain is discretized on a uniform Cartesian grid with spacing $h$ in each coordinate direction, and the spatial operator is approximated using second-order central differences on the standard five-point stencil.\n\nPart A (explicit scheme): Using a forward Euler time discretization for the above discrete diffusion equation, estimate the maximum stable time step $\\Delta t_{\\mathrm{exp},\\max}$ in terms of $h$, $k$, $\\mu$, and $C$ by invoking a linear stability analysis based on Fourier (von Neumann) modes. Assume two spatial dimensions.\n\nPart B (implicit scheme and nonlinear convergence): Now consider a backward Euler time discretization, but with nonlinear spatial coupling arising from a strong mobility contrast between the fracture and matrix. Model this contrast by introducing a fracture cell with mobility $\\lambda_{f}$ and a matrix cell with mobility $\\lambda_{m}=k/\\mu$. Define the mobility ratio by\n$$\nM = \\frac{\\lambda_{f}}{\\lambda_{m}},\n$$\nand assume the largest local operator norm contribution at a fracture–matrix interface is proportional to $\\lambda_{m} + \\lambda_{f} = \\lambda_{m} (1+M)$. Using a fixed-point (Picard) viewpoint for the nonlinear residual mapping induced by backward Euler, estimate a sufficient upper bound $\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max}$ on the time step that guarantees the Picard mapping is a contraction under the infinity norm, by bounding the discrete operator norm with the worst-case five-point stencil factor in two spatial dimensions.\n\nPart C (effect of high mobility ratio on nonlinear convergence): For a given trial time step $\\Delta t$, express the induced contraction factor $q(M,\\Delta t)$ of the Picard iteration in terms of $h$, $k$, $\\mu$, $C$, and $M$, using the same operator norm bounds as in Part B. Treat “contraction factor” as the Lipschitz constant of the iteration map under the infinity norm.\n\nProvide your final answers as closed-form analytic expressions for $\\Delta t_{\\mathrm{exp},\\max}$, $\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max}$, and $q(M,\\Delta t)$ in terms of $h$, $k$, $\\mu$, $C$, and $M$. Express your answers symbolically; do not substitute numerical values. If multiple expressions are required, present them as a single row matrix as specified. No units are required in the final boxed expression.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard but substantive set of questions in the numerical analysis of partial differential equations relevant to computational geophysics. All necessary information is provided to derive the requested quantities.\n\nThe solution is presented in three parts, corresponding to the three parts of the problem statement.\n\n### Part A: Maximum Stable Time Step for the Explicit Scheme\n\nThe pressure diffusion equation is given by\n$$\nC \\, \\frac{\\partial p}{\\partial t} = \\nabla \\cdot \\big( \\lambda \\, \\nabla p \\big)\n$$\nIn the matrix region, the mobility $\\lambda = k/\\mu$ is treated as a constant. The equation simplifies to the standard heat/diffusion equation:\n$$\n\\frac{\\partial p}{\\partial t} = D \\nabla^2 p\n$$\nwhere $D = \\lambda/C$ is the hydraulic diffusivity.\n\nWe discretize this equation on a uniform 2D Cartesian grid with spacing $h$. The spatial operator $\\nabla^2$ is approximated using a second-order central difference five-point stencil:\n$$\n\\nabla^2 p(x_i, y_j, t) \\approx \\frac{p_{i+1,j} - 2p_{i,j} + p_{i-1,j}}{h^2} + \\frac{p_{i,j+1} - 2p_{i,j} + p_{i,j-1}}{h^2}\n$$\nwhere $p_{i,j}(t) = p(ih, jh, t)$.\nThe semi-discretized equation is\n$$\nC \\frac{d p_{i,j}}{dt} = \\frac{\\lambda}{h^2} \\left( p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4p_{i,j} \\right)\n$$\nApplying the forward Euler method for time discretization with a time step $\\Delta t$, where $p_{i,j}^n = p(ih, jh, n\\Delta t)$:\n$$\nC \\frac{p_{i,j}^{n+1} - p_{i,j}^n}{\\Delta t} = \\frac{\\lambda}{h^2} \\left( p_{i+1,j}^n + p_{i-1,j}^n + p_{i,j+1}^n + p_{i,j-1}^n - 4p_{i,j}^n \\right)\n$$\nRearranging for $p_{i,j}^{n+1}$ gives the explicit update rule:\n$$\np_{i,j}^{n+1} = p_{i,j}^n + \\frac{\\lambda \\Delta t}{C h^2} \\left( p_{i+1,j}^n + p_{i-1,j}^n + p_{i,j+1}^n + p_{i,j-1}^n - 4p_{i,j}^n \\right)\n$$\nFor the von Neumann stability analysis, we substitute a generic Fourier mode for the error, $p_{i,j}^n = G^n e^{I(k_x i h + k_y j h)}$, where $I = \\sqrt{-1}$ and $G$ is the amplification factor.\n$$\nG^{n+1} e^{I(k_x i h + k_y j h)} = G^n e^{I(k_x i h + k_y j h)} + \\frac{\\lambda \\Delta t}{C h^2} G^n e^{I(k_x i h + k_y j h)} \\left( e^{I k_x h} + e^{-I k_x h} + e^{I k_y h} + e^{-I k_y h} - 4 \\right)\n$$\nDividing by $G^n e^{I(k_x i h + k_y j h)}$ yields the amplification factor $G$:\n$$\nG = 1 + \\frac{\\lambda \\Delta t}{C h^2} (2\\cos(k_x h) + 2\\cos(k_y h) - 4)\n$$\n$$\nG = 1 - \\frac{2\\lambda \\Delta t}{C h^2} (2 - \\cos(k_x h) - \\cos(k_y h))\n$$\nUsing the identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\nG = 1 - \\frac{2\\lambda \\Delta t}{C h^2} (2\\sin^2(k_x h/2) + 2\\sin^2(k_y h/2)) = 1 - \\frac{4\\lambda \\Delta t}{C h^2} (\\sin^2(k_x h/2) + \\sin^2(k_y h/2))\n$$\nFor stability, we require $|G| \\le 1$. Since $G$ is real, this means $-1 \\le G \\le 1$. The term multiplying the time step is non-negative, so $G \\le 1$ is always satisfied. The critical condition is $G \\ge -1$:\n$$\n-1 \\le 1 - \\frac{4\\lambda \\Delta t}{C h^2} (\\sin^2(k_x h/2) + \\sin^2(k_y h/2))\n$$\n$$\n\\frac{4\\lambda \\Delta t}{C h^2} (\\sin^2(k_x h/2) + \\sin^2(k_y h/2)) \\le 2\n$$\n$$\n\\Delta t \\le \\frac{2 C h^2}{4\\lambda (\\sin^2(k_x h/2) + \\sin^2(k_y h/2))} = \\frac{C h^2}{2\\lambda (\\sin^2(k_x h/2) + \\sin^2(k_y h/2))}\n$$\nTo satisfy this for all Fourier modes, we must consider the worst case, which corresponds to the maximum value of the term $(\\sin^2(k_x h/2) + \\sin^2(k_y h/2))$. This occurs for the highest frequency modes, where $k_x h = \\pi$ and $k_y h = \\pi$.\n$$\n\\max \\left(\\sin^2(k_x h/2) + \\sin^2(k_y h/2)\\right) = \\sin^2(\\pi/2) + \\sin^2(\\pi/2) = 1^2 + 1^2 = 2\n$$\nSubstituting this maximum value into the inequality gives the stability limit:\n$$\n\\Delta t \\le \\frac{C h^2}{2\\lambda (2)} = \\frac{C h^2}{4\\lambda}\n$$\nThus, the maximum stable time step is $\\Delta t_{\\mathrm{exp},\\max} = \\frac{C h^2}{4\\lambda}$. Substituting $\\lambda = k/\\mu$, we get\n$$\n\\Delta t_{\\mathrm{exp},\\max} = \\frac{C h^2 \\mu}{4 k}\n$$\n\n### Part B: Time Step Bound for Nonlinear Implicit Scheme\n\nFor the nonlinear problem with a backward Euler discretization, the system of equations for the pressure vector $P^{n+1}$ at time $t_{n+1}$ is\n$$\nC \\frac{P^{n+1} - P^n}{\\Delta t} = \\mathcal{A}(P^{n+1})\n$$\nwhere $\\mathcal{A}(P)$ represents the nonlinear discrete spatial operator $\\nabla_h \\cdot (\\lambda(P) \\nabla_h P)$. A Picard (or fixed-point) iteration scheme can be defined by lagging the nonlinear term:\n$$\nP^{(k+1)} = P^n + \\frac{\\Delta t}{C} \\mathcal{A}(P^{(k)})\n$$\nwhere $P^{(k)}$ is the pressure vector at the $k$-th Picard iteration. Let the iteration map be $\\Phi(P) = P^n + \\frac{\\Delta t}{C} \\mathcal{A}(P)$. For the iteration to converge, the map $\\Phi$ must be a contraction, which means its Lipschitz constant, $q$, must be less than $1$. The Lipschitz constant is given by\n$$\nq = \\text{Lip}(\\Phi) = \\frac{\\Delta t}{C} \\text{Lip}(\\mathcal{A})\n$$\nwhere $\\text{Lip}(\\mathcal{A})$ can be bounded by the supremum of the norm of the Jacobian of $\\mathcal{A}$, $\\sup_P \\|J_{\\mathcal{A}}(P)\\|_{\\infty}$. The problem provides a guideline for estimating this bound. It states that the analysis should be based on the \"largest local operator norm contribution at a fracture-matrix interface,\" which is \"proportional to $\\lambda_{m} + \\lambda_{f}$,\" and the \"worst-case five-point stencil factor in two spatial dimensions,\" which is $4$.\n\nThis suggests an analogy with the linear case, where the stability is governed by the operator norm. We construct an estimate for the Lipschitz constant of the nonlinear operator $\\mathcal{A}$ based on these hints:\n$$\n\\text{Lip}(\\mathcal{A}) \\approx \\frac{(\\text{stencil factor}) \\times (\\text{mobility term})}{h^2}\n$$\nUsing the provided values, we estimate the bound as:\n$$\n\\text{Lip}(\\mathcal{A}) \\le \\frac{4(\\lambda_m + \\lambda_f)}{h^2}\n$$\nThe condition for the Picard iteration to be a contraction ($q < 1$) becomes:\n$$\n\\frac{\\Delta t}{C} \\left( \\frac{4(\\lambda_m + \\lambda_f)}{h^2} \\right) < 1\n$$\nThis gives a sufficient condition on the time step $\\Delta t$:\n$$\n\\Delta t < \\frac{C h^2}{4(\\lambda_m + \\lambda_f)}\n$$\nThe maximum time step that guarantees contraction is the upper bound of this interval. Using the mobility ratio $M = \\lambda_f / \\lambda_m$, we have $\\lambda_f = M \\lambda_m$.\n$$\n\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max} = \\frac{C h^2}{4(\\lambda_m + M \\lambda_m)} = \\frac{C h^2}{4\\lambda_m(1+M)}\n$$\nSubstituting $\\lambda_m = k/\\mu$, we find the final expression:\n$$\n\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max} = \\frac{C h^2 \\mu}{4 k(1+M)}\n$$\n\n### Part C: Contraction Factor Expression\n\nThe contraction factor $q(M, \\Delta t)$ for a given trial time step $\\Delta t$ is the Lipschitz constant of the Picard iteration map $\\Phi$. Following the derivation from Part B:\n$$\nq(M, \\Delta t) = \\frac{\\Delta t}{C} \\text{Lip}(\\mathcal{A})\n$$\nUsing the same operator norm bound as in Part B, $\\text{Lip}(\\mathcal{A}) \\approx \\frac{4(\\lambda_m + \\lambda_f)}{h^2}$:\n$$\nq(M, \\Delta t) = \\frac{\\Delta t}{C} \\frac{4(\\lambda_m + \\lambda_f)}{h^2}\n$$\nWe express this in terms of the given variables $h$, $k$, $\\mu$, $C$, and $M$.\n$$\n\\lambda_m + \\lambda_f = \\lambda_m(1+M) = \\frac{k}{\\mu}(1+M)\n$$\nSubstituting this into the expression for $q$:\n$$\nq(M, \\Delta t) = \\frac{\\Delta t}{C} \\frac{4 \\frac{k}{\\mu}(1+M)}{h^2} = \\frac{4 \\Delta t k (1+M)}{C h^2 \\mu}\n$$\nThis expression shows how the convergence of the Picard iteration deteriorates (i.e., $q$ increases) with larger time steps $\\Delta t$ and higher mobility ratios $M$.\n\n### Summary of Final Expressions\n\nThe three requested quantities are:\n1.  $\\Delta t_{\\mathrm{exp},\\max} = \\frac{C h^2 \\mu}{4 k}$\n2.  $\\Delta t_{\\mathrm{imp},\\mathrm{NL},\\max} = \\frac{C h^2 \\mu}{4 k (1+M)}$\n3.  $q(M, \\Delta t) = \\frac{4 \\Delta t k (1+M)}{C h^2 \\mu}$\n\nThese are presented as a row matrix in the final answer.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{C h^{2} \\mu}{4 k} & \\frac{C h^{2} \\mu}{4 k (1+M)} & \\frac{4 \\Delta t k (1+M)}{C h^{2} \\mu} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Real-world hydraulic fracturing simulations involve the tight coupling of fluid flow within the fracture and the porous rock, and the mechanical propagation of the crack itself. These processes often occur at vastly different time scales, making a fixed time step inefficient. This final practice guides you through the design of a sophisticated adaptive time-stepping algorithm that dynamically adjusts the step size by considering the constraints from fluid diffusion, fracture front advancement, and fluid leak-off, ensuring both stability and computational efficiency .",
            "id": "3611786",
            "problem": "You are to design and implement a time-step adaptation strategy for a simplified one-dimensional coupled flow–fracture problem in multiphase poromechanics and hydraulic fracturing. The algorithm must be based on estimating a hydraulic diffusion time scale and a fracture-front advance constraint, combined in a Courant–Friedrichs–Lewy (CFL)-like minimum rule for coupled stability. Your program must compute an adaptive time step for each specified parameter set.\n\nStart from fundamental laws and core definitions only. In particular, begin from the combination of the momentum balance for flow in porous media (Darcy’s law) and mass conservation for a slightly compressible multiphase mixture. Without using any pre-given shortcut formulas, derive:\n- An effective hydraulic diffusivity appropriate for a linearized pressure equation of a slightly compressible multiphase mixture flowing through a porous matrix with intrinsic permeability.\n- A stability time-step constraint for an explicit time integration of a one-dimensional diffusion equation on a uniform grid with spacing $\\Delta x$.\n- A fracture-front advance constraint, in the spirit of a Courant–Friedrichs–Lewy criterion, based on a front speed $v_f$ and a characteristic tip element length $\\ell_{\\mathrm{tip}}$, using a dimensionless safety factor.\n- A leak-off or transverse drainage time scale constructed from a characteristic drainage length $L_c$ and diffusivity, with a dimensionless safety factor.\n- A final rule that selects the time step as the minimum of the above constraints and an imposed maximum, but never smaller than a prescribed minimum.\n\nYour implementation must:\n- Compute the multiphase total mobility from relative permeabilities and viscosities.\n- Compute the effective diffusivity from the intrinsic permeability, total mobility, porosity, and total compressibility.\n- Compute the three candidate time-step bounds (diffusion along-grid, fracture-front advection, drainage/leak-off) and include user-specified safety factors. Treat any non-applicable constraint (for example, zero mobility or zero fracture speed) as non-restrictive by assigning it an effectively infinite bound.\n- Select the final adaptive time step as the minimum of all finite bounds and the user-specified maximum, then enforce a user-specified minimum bound from below.\n\nPhysical units and numerical formatting:\n- All lengths must be treated in meters (m), permeabilities in square meters (m$^2$), viscosities in pascal–seconds (Pa·s), compressibilities in reciprocal pascals (Pa$^{-1}$), speeds in meters per second (m/s), and time in seconds (s).\n- Your program must output each adaptive time step in seconds as a decimal float rounded to exactly six digits after the decimal point, with no unit symbol in the output.\n\nTest suite and required output format:\n- Use the following five test cases. Each test case is a tuple in the order $\\left(\\Delta x, k, \\phi, c_t, k_{rw}, k_{ro}, \\mu_w, \\mu_o, v_f, \\ell_{\\mathrm{tip}}, L_c, C_d, C_{\\mathrm{tip}}, C_{\\mathrm{leak}}, \\Delta t_{\\max}, \\Delta t_{\\min}\\right)$, where all symbols are as described above and all inputs are given in coherent units. Each numeric value below is in its stated unit:\n    1. $\\left(0.25,\\;1\\times 10^{-19},\\;0.12,\\;8\\times 10^{-10},\\;0.2,\\;0.6,\\;1\\times 10^{-3},\\;2\\times 10^{-3},\\;0.5,\\;0.05,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;1.0,\\;1\\times 10^{-6}\\right)$\n    2. $\\left(0.1,\\;1\\times 10^{-14},\\;0.2,\\;1\\times 10^{-9},\\;0.5,\\;0.5,\\;1\\times 10^{-3},\\;3\\times 10^{-3},\\;0.2,\\;0.02,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;0.5,\\;1\\times 10^{-6}\\right)$\n    3. $\\left(0.2,\\;1\\times 10^{-18},\\;0.15,\\;1\\times 10^{-9},\\;0.1,\\;0.1,\\;1\\times 10^{-3},\\;2\\times 10^{-3},\\;0.0,\\;0.05,\\;0.1,\\;0.45,\\;0.8,\\;0.5,\\;100.0,\\;1\\times 10^{-6}\\right)$\n    4. $\\left(0.3,\\;1\\times 10^{-20},\\;0.12,\\;1\\times 10^{-9},\\;0.0,\\;0.0,\\;1\\times 10^{-3},\\;1\\times 10^{-3},\\;1.0,\\;0.01,\\;0.03,\\;0.45,\\;0.8,\\;0.5,\\;1.0,\\;1\\times 10^{-6}\\right)$\n    5. $\\left(0.1,\\;1\\times 10^{-20},\\;0.1,\\;1\\times 10^{-9},\\;0.0,\\;0.0,\\;1\\times 10^{-3},\\;1\\times 10^{-3},\\;0.0,\\;0.02,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;10.0,\\;1\\times 10^{-6}\\right)$\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\left[\\Delta t_1,\\Delta t_2,\\dots\\right]$, where each $\\Delta t_i$ is the adaptive time step for test case $i$, formatted to six digits after the decimal point, in seconds. The output must contain no spaces and no additional text.\n\nExpress all final numerical answers in seconds and ensure the rounding rule above is followed exactly.",
            "solution": "The problem requires the design and implementation of an adaptive time-stepping algorithm for a simplified one-dimensional coupled fluid flow and fracture propagation problem, a common task in computational geophysics for simulating hydraulic fracturing. The method must be derived from fundamental principles, namely mass conservation and Darcy's law, and incorporate constraints related to numerical stability and the physics of fracture propagation.\n\nThe derivation and algorithmic design will proceed in five stages:\n1.  Derivation of the effective hydraulic diffusivity, $D$, for multiphase flow in a porous medium.\n2.  Derivation of the numerical stability constraint, $\\Delta t_d$, for an explicit finite difference scheme for the resulting diffusion equation.\n3.  Formulation of the physical time scale constraint, $\\Delta t_{\\mathrm{tip}}$, related to the fracture-front advancement.\n4.  Formulation of the physical time scale constraint, $\\Delta t_{\\mathrm{leak}}$, related to fluid leak-off into the formation.\n5.  Synthesis of these constraints into a single rule for selecting the adaptive time step, $\\Delta t$.\n\n**1. Effective Hydraulic Diffusivity for Multiphase Flow**\n\nThe derivation begins with the principle of mass conservation for a fluid mixture within a porous solid matrix. The mass of fluid per unit bulk volume is given by the product of porosity, $\\phi$, and the average fluid density, $\\rho_t$. The differential form of the mass conservation law is:\n$$\n\\frac{\\partial (\\phi \\rho_t)}{\\partial t} + \\nabla \\cdot (\\rho_t \\mathbf{v}_t) = 0\n$$\nwhere $\\mathbf{v}_t$ is the total fluid volumetric flux (Darcy velocity) and $t$ is time.\n\nFor a slightly compressible system, both the fluid density and the porosity change with fluid pressure, $p$. This combined effect is captured by the total compressibility, $c_t$, defined as the fractional change in fluid mass content per unit change in pressure:\n$$\nc_t = \\frac{1}{\\phi \\rho_t} \\frac{\\partial (\\phi \\rho_t)}{\\partial p}\n$$\nUsing the chain rule, the storage term (the first term in the conservation equation) can be expressed as:\n$$\n\\frac{\\partial (\\phi \\rho_t)}{\\partial t} = \\frac{\\partial (\\phi \\rho_t)}{\\partial p} \\frac{\\partial p}{\\partial t} = (\\phi c_t \\rho_t) \\frac{\\partial p}{\\partial t}\n$$\nSubstituting this into the conservation law yields:\n$$\n(\\phi c_t \\rho_t) \\frac{\\partial p}{\\partial t} + \\nabla \\cdot (\\rho_t \\mathbf{v}_t) = 0\n$$\nAssuming that spatial gradients in density are negligible compared to gradients in flux (a common linearization), we can simplify this to:\n$$\n\\phi c_t \\frac{\\partial p}{\\partial t} + \\nabla \\cdot \\mathbf{v}_t = 0\n$$\nThe total volumetric flux, $\\mathbf{v}_t$, is described by the multiphase extension of Darcy's law. For two immiscible phases, such as water ($w$) and oil ($o$), the total flux is the sum of the individual phase fluxes:\n$$\n\\mathbf{v}_t = \\mathbf{v}_w + \\mathbf{v}_o\n$$\nEach phase flux is given by $\\mathbf{v}_\\alpha = -\\frac{k k_{r\\alpha}}{\\mu_\\alpha} \\nabla p$, where $k$ is the intrinsic permeability of the porous medium, $k_{r\\alpha}$ is the relative permeability of phase $\\alpha$, and $\\mu_\\alpha$ is its dynamic viscosity. We assume a single pressure field $p$ governs the flow of both phases.\nSumming the fluxes gives:\n$$\n\\mathbf{v}_t = -\\left( \\frac{k k_{rw}}{\\mu_w} + \\frac{k k_{ro}}{\\mu_o} \\right) \\nabla p\n$$\nWe define the total mobility, $\\lambda_t$, as the sum of phase mobilities: $\\lambda_t = \\lambda_w + \\lambda_o = \\frac{k_{rw}}{\\mu_w} + \\frac{k_{ro}}{\\mu_o}$. This simplifies the total flux expression to:\n$$\n\\mathbf{v}_t = -k \\lambda_t \\nabla p\n$$\nSubstituting this flux back into the simplified conservation equation gives:\n$$\n\\phi c_t \\frac{\\partial p}{\\partial t} - \\nabla \\cdot (k \\lambda_t \\nabla p) = 0\n$$\nAssuming that $k$ and $\\lambda_t$ are locally constant, we arrive at the linear pressure diffusion equation:\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{k \\lambda_t}{\\phi c_t} \\nabla^2 p\n$$\nThis equation is of the general form $\\frac{\\partial p}{\\partial t} = D \\nabla^2 p$. By comparison, we identify the effective hydraulic diffusivity, $D$, as:\n$$\nD = \\frac{k \\lambda_t}{\\phi c_t} = \\frac{k}{\\phi c_t} \\left( \\frac{k_{rw}}{\\mu_w} + \\frac{k_{ro}}{\\mu_o} \\right)\n$$\n\n**2. Diffusion Time-Step Constraint**\n\nThis constraint arises from the stability requirements of an explicit time-integration scheme for the diffusion equation. For a one-dimensional problem on a uniform grid with spacing $\\Delta x$, the diffusion equation is $\\frac{\\partial p}{\\partial t} = D \\frac{\\partial^2 p}{\\partial x^2}$. Using a Forward-Time Centered-Space (FTCS) discretization scheme:\n$$\n\\frac{p_i^{n+1} - p_i^n}{\\Delta t} = D \\frac{p_{i+1}^n - 2p_i^n + p_{i-1}^n}{(\\Delta x)^2}\n$$\nwhere $p_i^n$ is the pressure at grid point $i$ and time step $n$. For this scheme to be numerically stable, the time step $\\Delta t$ must satisfy the Courant–Friedrichs–Lewy (CFL) condition, which for this equation is:\n$$\n\\frac{2 D \\Delta t}{(\\Delta x)^2} \\le 1 \\implies \\Delta t \\le \\frac{(\\Delta x)^2}{2D}\n$$\nThe problem specifies a dimensionless safety factor, $C_d$, to be applied to this theoretical limit. Therefore, the maximum allowable time step due to along-grid diffusion is:\n$$\n\\Delta t_d = C_d \\frac{(\\Delta x)^2}{2D}\n$$\nIf the diffusivity $D$ is zero (e.g., if total mobility $\\lambda_t = 0$), diffusion does not occur, and this constraint becomes non-restrictive, which is mathematically equivalent to $\\Delta t_d \\to \\infty$.\n\n**3. Fracture-Front Advance Constraint**\n\nThis constraint is based on the physics of the fracture tip propagating through the medium. The propagation is an advection-like process, where the \"information\" of the new fracture position moves with the front speed, $v_f$. A CFL-like condition is necessary to ensure that the fracture does not advance more than one characteristic element length, $\\ell_{\\mathrm{tip}}$, in a single time step. The basic constraint is $\\Delta t \\le \\ell_{\\mathrm{tip}} / v_f$. Including the specified safety factor, $C_{\\mathrm{tip}}$, we obtain the constraint:\n$$\n\\Delta t_{\\mathrm{tip}} = C_{\\mathrm{tip}} \\frac{\\ell_{\\mathrm{tip}}}{v_f}\n$$\nIf the fracture is stationary ($v_f = 0$), this constraint is non-restrictive, so $\\Delta t_{\\mathrm{tip}} \\to \\infty$.\n\n**4. Leak-off Time-Scale Constraint**\n\nThis constraint ensures that the simulation adequately resolves the process of fluid leaking from the high-pressure fracture into the lower-pressure surrounding rock matrix. This is a diffusive process governed by the hydraulic diffusivity $D$. The characteristic time, $T$, for diffusion to equilibrate over a characteristic length, $L$, is given by the scaling law $T \\sim L^2/D$. In this context, the characteristic length is the drainage length, $L_c$. The time step should be a fraction of this characteristic time to capture the transient dynamics. With a specified safety factor, $C_{\\mathrm{leak}}$, this constraint is formulated as:\n$$\n\\Delta t_{\\mathrm{leak}} = C_{\\mathrm{leak}} \\frac{L_c^2}{D}\n$$\nAs with the diffusion constraint, if $D=0$, leak-off does not occur, and this constraint becomes non-restrictive, $\\Delta t_{\\mathrm{leak}} \\to \\infty$.\n\n**5. Final Adaptive Time-Step Algorithm**\n\nThe final adaptive time step, $\\Delta t$, is determined by respecting all constraints simultaneously. This is achieved by selecting the most restrictive (i.e., the smallest) time step from the set of calculated bounds and the user-imposed maximum time step, $\\Delta t_{\\max}$. Furthermore, the time step is not allowed to fall below a user-imposed minimum, $\\Delta t_{\\min}$. The complete rule is:\n1.  Calculate the three physically-derived time-step limits: $\\Delta t_d$, $\\Delta t_{\\mathrm{tip}}$, and $\\Delta t_{\\mathrm{leak}}$.\n2.  Find the minimum of these values and the prescribed maximum, $\\Delta t_{\\max}$:\n    $$ \\Delta t_{\\text{candidate}} = \\min(\\Delta t_d, \\Delta t_{\\mathrm{tip}}, \\Delta t_{\\mathrm{leak}}, \\Delta t_{\\max}) $$\n3.  Ensure the final time step is not smaller than the prescribed minimum, $\\Delta t_{\\min}$:\n    $$ \\Delta t = \\max(\\Delta t_{\\text{candidate}}, \\Delta t_{\\min}) $$\nThis multi-stage-minimum, followed by a maximum-with-floor, is a robust method for controlling time-step size in complex multiphysics simulations. The implementation will compute this value for each supplied parameter set.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the adaptive time step for a series of test cases based on \n    multiphase poromechanics and hydraulic fracturing stability criteria.\n    \"\"\"\n\n    # Test cases: tuples in the order\n    # (delta_x, k, phi, c_t, k_rw, k_ro, mu_w, mu_o, v_f, l_tip, L_c, C_d, C_tip, C_leak, dt_max, dt_min)\n    test_cases = [\n        (0.25, 1e-19, 0.12, 8e-10, 0.2, 0.6, 1e-3, 2e-3, 0.5, 0.05, 0.05, 0.45, 0.8, 0.5, 1.0, 1e-6),\n        (0.1, 1e-14, 0.2, 1e-9, 0.5, 0.5, 1e-3, 3e-3, 0.2, 0.02, 0.05, 0.45, 0.8, 0.5, 0.5, 1e-6),\n        (0.2, 1e-18, 0.15, 1e-9, 0.1, 0.1, 1e-3, 2e-3, 0.0, 0.05, 0.1, 0.45, 0.8, 0.5, 100.0, 1e-6),\n        (0.3, 1e-20, 0.12, 1e-9, 0.0, 0.0, 1e-3, 1e-3, 1.0, 0.01, 0.03, 0.45, 0.8, 0.5, 1.0, 1e-6),\n        (0.1, 1e-20, 0.1, 1e-9, 0.0, 0.0, 1e-3, 1e-3, 0.0, 0.02, 0.05, 0.45, 0.8, 0.5, 10.0, 1e-6),\n    ]\n\n    results = []\n    for params in test_cases:\n        dt = calculate_adaptive_timestep(params)\n        results.append(f\"{dt:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_adaptive_timestep(params):\n    \"\"\"\n    Calculates the adaptive time step for a single parameter set.\n    \"\"\"\n    (delta_x, k, phi, c_t, k_rw, k_ro, mu_w, mu_o, v_f, \n     l_tip, L_c, C_d, C_tip, C_leak, dt_max, dt_min) = params\n\n    # 1. Calculate total mobility\n    # Ensure mu_w and mu_o are not zero to avoid division by zero\n    lambda_w = k_rw / mu_w if mu_w > 0 else 0\n    lambda_o = k_ro / mu_o if mu_o > 0 else 0\n    lambda_t = lambda_w + lambda_o\n\n    # 2. Calculate effective diffusivity\n    # Denominator check for physical validity\n    if phi > 0 and c_t > 0 and lambda_t > 0:\n        D = (k * lambda_t) / (phi * c_t)\n    else:\n        D = 0.0\n\n    # 3. Calculate time step bounds\n    # Initialize bounds to infinity (non-restrictive)\n    dt_d = float('inf')\n    dt_leak = float('inf')\n    dt_tip = float('inf')\n\n    # Diffusion along-grid constraint\n    if D > 0:\n        dt_d = C_d * (delta_x**2) / (2 * D)\n\n    # Transverse drainage / leak-off constraint\n    if D > 0:\n        dt_leak = C_leak * (L_c**2) / D\n\n    # Fracture-front advection constraint\n    if v_f > 0:\n        dt_tip = C_tip * l_tip / v_f\n\n    # 4. Apply final rule\n    # Find the minimum of all finite bounds and the user-specified maximum\n    dt_candidate = min(dt_d, dt_leak, dt_tip, dt_max)\n\n    # Enforce the user-specified minimum bound from below\n    final_dt = max(dt_candidate, dt_min)\n\n    return final_dt\n\nsolve()\n```"
        }
    ]
}