{
    "hands_on_practices": [
        {
            "introduction": "理解地幔部分熔融区域中熔体的运移是地球动力学的核心问题之一。本练习将引导你运用达西定律（Darcy's Law）——描述多孔介质流动的基本物理法则——来推导并计算由浮力驱动的熔体分离速度。通过这个计算，你将对控制熔体从固态地幔中提取出来的关键物理参数（如孔隙度、粘度和密度差）获得定量的直观认识。",
            "id": "3617298",
            "problem": "考虑在重力作用下，硅酸盐熔体通过部分熔融、可渗透的地幔基质的一维、稳态、垂直流动，规定向上为正方向。将此两相聚集体视为多孔介质，并采用以下物理图像：在连续介质尺度上，熔体相受到压力梯度力、浮力和与熔体-固体相对速度成正比的粘性拖曳力之间的平衡，这与孔隙中的斯托克斯流（Stokes flow）一致。采用熔体的牛顿流变学模型，并忽略惯性效应。假设固体基质近似处于静水压力状态，因此局部熔体压力梯度接近于固体岩石静压力梯度。将分异速度定义为熔体相对于固体基质的达西通量，记为 $w_{\\mathrm{seg}}$，其单位为速度。\n\n从多孔介质流动的力平衡和渗透率的定义出发，推导 $w_{\\mathrm{seg}}$ 的表达式，用渗透率 $k$、熔体粘度 $\\mu_{\\ell}$、固体与熔体之间的密度差 $\\Delta \\rho$（如果固体比熔体密度大，则取 $\\Delta \\rho > 0$）以及重力加速度 $g$ 来表示。然后，对于与孔隙度相关的渗透率 $k(\\phi)=k_{0}\\,\\phi^{n}$，其中 $k_{0}=1.0\\times 10^{-8}\\ \\mathrm{m}^{2}$ 且 $n=3$，熔体粘度 $\\mu_{\\ell}=10\\ \\mathrm{Pa \\cdot s}$，密度差 $\\Delta \\rho=300\\ \\mathrm{kg \\cdot m^{-3}}$，重力加速度 $g=9.81\\ \\mathrm{m \\cdot s^{-2}}$，计算在 $\\phi=0.01$ 和 $\\phi=0.05$ 时的分异速度。\n\n将两个结果均以 $\\mathrm{m \\cdot s^{-1}}$ 为单位表示，并四舍五入到三位有效数字。将这两个值按 $\\phi=0.01$、$\\phi=0.05$ 的顺序以单行矩阵的形式报告。",
            "solution": "该问题要求推导熔体分异速度 $w_{\\mathrm{seg}}$，并针对两个给定的孔隙度进行数值计算。该物理系统是熔体通过固体基质的一维、稳态、垂直流动，被视为多孔介质。\n\n出发点是熔体相的力平衡。问题陈述该平衡涉及压力梯度力、浮力和粘性拖曳力。这种平衡被广义达西定律所概括，该定律将达西通量与流体势的梯度联系起来。熔体相对于固体基质的达西通量被定义为分异速度 $w_{\\mathrm{seg}}$。设垂直坐标为 $z$，向上为正方向。因此，重力加速度矢量为 $\\mathbf{g} = -g \\hat{z}$，其中 $g$ 是重力加速度的大小。\n\n一维垂直分异速度 $w_{\\mathrm{seg}}$ 的达西定律由下式给出：\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( \\frac{dP_{\\ell}}{dz} - \\rho_{\\ell} (-g) \\right)\n$$\n其中 $k$ 是介质的渗透率，$\\mu_{\\ell}$ 是熔体的动力粘度，$P_{\\ell}$ 是熔体压力，$\\rho_{\\ell}$ 是熔体密度。该方程可重写为：\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( \\frac{dP_{\\ell}}{dz} + \\rho_{\\ell} g \\right)\n$$\n括号中的项代表熔体流动的驱动力。它是熔体压力梯度与熔体自身静水压力梯度的偏差。\n\n提供的一个关键信息是假设固体基质近似处于静水压力状态，并且“局部地，熔体压力梯度接近于固体岩石静压力梯度”。由密度为 $\\rho_s$ 的固相产生的岩石静压力梯度由 $\\frac{dP_s}{dz} = -\\rho_s g$ 给出。应用问题的假设，我们将熔体压力梯度近似为：\n$$\n\\frac{dP_{\\ell}}{dz} \\approx \\frac{dP_s}{dz} = -\\rho_s g\n$$\n这是熔体运移模型中的一个标准简化，它假定刚性的固体基质支撑着上覆载荷，因此压力梯度由固体的密度决定。\n\n将此近似代入 $w_{\\mathrm{seg}}$ 的方程中：\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( (-\\rho_s g) + \\rho_{\\ell} g \\right)\n$$\n$$\nw_{\\mathrm{seg}} = -\\frac{k g}{\\mu_{\\ell}} (\\rho_{\\ell} - \\rho_s)\n$$\n通过提出因子 $-1$，我们得到：\n$$\nw_{\\mathrm{seg}} = \\frac{k g}{\\mu_{\\ell}} (\\rho_s - \\rho_{\\ell})\n$$\n问题将密度差定义为 $\\Delta \\rho = \\rho_s - \\rho_{\\ell}$，由于固体比熔体密度大，因此 $\\Delta \\rho > 0$。分异速度的最终符号表达式因此为：\n$$\nw_{\\mathrm{seg}} = \\frac{k \\Delta \\rho g}{\\mu_{\\ell}}\n$$\n这完成了问题的第一部分。$w_{\\mathrm{seg}}$ 的正值表示向上流动，这与密度较小的熔体在重力作用下通过密度较大的固体基质向上渗滤的物理情况一致。\n\n对于第二部分，我们必须计算特定参数值下的 $w_{\\mathrm{seg}}$。渗透率 $k$ 是孔隙度 $\\phi$ 的函数：\n$$\nk(\\phi) = k_0 \\phi^n\n$$\n将此代入我们的 $w_{\\mathrm{seg}}$ 表达式中，得到：\n$$\nw_{\\mathrm{seg}}(\\phi) = \\frac{k_0 \\phi^n \\Delta \\rho g}{\\mu_{\\ell}}\n$$\n给定的参数值为：\n- $k_0 = 1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}$\n- $n = 3$\n- $\\mu_{\\ell} = 10\\ \\mathrm{Pa \\cdot s}$\n- $\\Delta \\rho = 300\\ \\mathrm{kg \\cdot m^{-3}}$\n- $g = 9.81\\ \\mathrm{m \\cdot s^{-2}}$\n\n我们现在计算两个指定孔隙度 $\\phi=0.01$ 和 $\\phi=0.05$ 下的 $w_{\\mathrm{seg}}$。\n\n情况1：孔隙度 $\\phi = 0.01$\n首先，计算渗透率：\n$$\nk(0.01) = (1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}) \\times (0.01)^3 = (1.0 \\times 10^{-8}) \\times (10^{-2})^3 = 1.0 \\times 10^{-14}\\ \\mathrm{m}^{2}\n$$\n现在，计算分异速度：\n$$\nw_{\\mathrm{seg}}(0.01) = \\frac{(1.0 \\times 10^{-14}\\ \\mathrm{m}^{2}) \\times (300\\ \\mathrm{kg \\cdot m^{-3}}) \\times (9.81\\ \\mathrm{m \\cdot s^{-2}})}{10\\ \\mathrm{Pa \\cdot s}}\n$$\n$$\nw_{\\mathrm{seg}}(0.01) = \\frac{2.943 \\times 10^{-11}}{10}\\ \\mathrm{m \\cdot s^{-1}} = 2.943 \\times 10^{-12}\\ \\mathrm{m \\cdot s^{-1}}\n$$\n四舍五入到三位有效数字，我们得到 $w_{\\mathrm{seg}}(0.01) = 2.94 \\times 10^{-12}\\ \\mathrm{m \\cdot s^{-1}}$。\n\n情况2：孔隙度 $\\phi = 0.05$\n首先，计算渗透率：\n$$\nk(0.05) = (1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}) \\times (0.05)^3 = (1.0 \\times 10^{-8}) \\times (1.25 \\times 10^{-4}) = 1.25 \\times 10^{-12}\\ \\mathrm{m}^{2}\n$$\n现在，计算分异速度：\n$$\nw_{\\mathrm{seg}}(0.05) = \\frac{(1.25 \\times 10^{-12}\\ \\mathrm{m}^{2}) \\times (300\\ \\mathrm{kg \\cdot m^{-3}}) \\times (9.81\\ \\mathrm{m \\cdot s^{-2}})}{10\\ \\mathrm{Pa \\cdot s}}\n$$\n$$\nw_{\\mathrm{seg}}(0.05) = \\frac{3.67875 \\times 10^{-9}}{10}\\ \\mathrm{m \\cdot s^{-1}} = 3.67875 \\times 10^{-10}\\ \\mathrm{m \\cdot s^{-1}}\n$$\n四舍五入到三位有效数字，我们得到 $w_{\\mathrm{seg}}(0.05) = 3.68 \\times 10^{-10}\\ \\mathrm{m \\cdot s^{-1}}$。\n\n计算出的两个分异速度分别是 $\\phi=0.01$ 时的 $2.94 \\times 10^{-12}\\ \\mathrm{m \\cdot s^{-1}}$ 和 $\\phi=0.05$ 时的 $3.68 \\times 10^{-10}\\ \\mathrm{m \\cdot s^{-1}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.94 \\times 10^{-12} & 3.68 \\times 10^{-10}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实的地幔中，熔体分离并非孤立发生，而是与大规模的固态地幔对流相互作用。这两个过程的时间尺度对比，决定了熔体是被快速提取至地表，还是被地幔对流重新卷入深部。本练习将通过量级分析（scaling analysis）这一强大的物理学工具，帮助你推导一个无量纲数，用以比较熔体运移和地幔对流的相对效率，从而深化对热化学对流系统复杂动力学的理解。",
            "id": "3617358",
            "problem": "考虑一个厚度为 $d$ 的、具有热化学浮力的部分熔融上地幔柱，其正在经历等粘性、无限普朗特数的对流和同时发生的熔体分离。假设从底到顶的温差 $\\Delta T$ 在固体中产生了一个被粘性阻力平衡的浮力，并且熔体在熔体和固体之间的密度差 $\\Delta \\rho$ 产生的浮力作用下，通过一个由依赖孔隙度的渗透率描述的可渗透基质垂直运移。使用以下基本定律和定义作为出发点：\n\n- 不可压缩蠕变流在热浮力作用下的稳态斯托克斯动量平衡：$-\\nabla p + \\mu \\nabla^{2} \\mathbf{u} + \\rho \\alpha g \\Delta T \\,\\hat{\\mathbf{z}} = \\mathbf{0}$。\n- 熔体通过多孔固体基质的相对通量的达西定律：$\\mathbf{q} = -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(\\nabla p - \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right)$。\n- 孔隙度-渗透率关系：$k(\\phi) = k_{0}\\,\\phi^{n}$。\n\n此处，$\\rho$ 是固体密度，$\\alpha$ 是热膨胀系数，$g$ 是重力加速度，$\\mu$ 是固体粘度，$\\mu_{m}$ 是熔体粘度，$\\phi$ 是局部孔隙度。通过在尺度 $d$ 上平衡热浮力与粘性阻力来处理对流固体速度标度 $U$，并通过在垂直方向上由浮力驱动的达西流来处理熔体分离速度标度 $w$，同时忽略固体流动产生的动态压力梯度并假设性质恒定。定义对流翻转时间 $\\tau_{\\mathrm{conv}} = d/U$ 和熔体分离时间 $\\tau_{\\mathrm{melt}} = d/w$。\n\n从这些基础出发，推导无量纲比 $S = \\tau_{\\mathrm{melt}}/\\tau_{\\mathrm{conv}}$ 关于给定参数的标度表达式，然后对以下代表上地幔熔融柱的参数集，数值计算 $S$：\n\n- 柱体厚度 $d = 50\\,\\mathrm{km}$，\n- 固体密度 $\\rho = 3300\\,\\mathrm{kg \\cdot m^{-3}}$，\n- 热膨胀系数 $\\alpha = 3.0 \\times 10^{-5}\\,\\mathrm{K^{-1}}$，\n- 温差 $\\Delta T = 500\\,\\mathrm{K}$，\n- 重力加速度 $g = 9.81\\,\\mathrm{m \\cdot s^{-2}}$，\n- 固体粘度 $\\mu = 1.0 \\times 10^{21}\\,\\mathrm{Pa\\,s}$，\n- 熔体粘度 $\\mu_{m} = 10\\,\\mathrm{Pa\\,s}$，\n- 密度差 $\\Delta \\rho = 500\\,\\mathrm{kg \\cdot m^{-3}}$，\n- 渗透率前置因子 $k_{0} = 1.0 \\times 10^{-10}\\,\\mathrm{m^{2}}$，\n- 孔隙度 $\\phi = 0.05$，\n- 渗透率指数 $n = 3$。\n\n将最终答案表示为单个无量纲数。将答案四舍五入到四位有效数字。最终答案中不应出现单位。",
            "solution": "问题陈述经核实具有科学依据、良定且客观。它基于应用于计算地球物理学中一个标准问题的已建立的流体动力学原理。给定的方程、假设和参数值对于地球上地幔中熔体生成的背景是恰当且物理上现实的。该问题是自洽的，并为得到唯一解提供了一条清晰明确的路径。因此，下面将给出完整解法。\n\n目标是推导无量纲比 $S = \\tau_{\\mathrm{melt}}/\\tau_{\\mathrm{conv}}$ 的标度表达式，其中 $\\tau_{\\mathrm{melt}}$ 是熔体分离时间，$\\tau_{\\mathrm{conv}}$ 是对流翻转时间。\n\n首先，我们确定固体地幔对流的特征速度标度 $U$。问题指明，该标度是通过在柱体长度尺度 $d$ 上平衡热浮力与粘性阻力得到的。固体流动的控制方程是稳态斯托克斯动量平衡：\n$$-\\nabla p + \\mu \\nabla^{2} \\mathbf{u} + \\rho \\alpha g \\Delta T \\,\\hat{\\mathbf{z}} = \\mathbf{0}$$\n在此方程中，单位体积的热浮力大小为 $\\rho \\alpha g \\Delta T$。单位体积的粘性阻力由项 $\\mu \\nabla^{2} \\mathbf{u}$ 表示。对于特征速度标度 $U$ 和长度标度 $d$，粘性项的标度为：\n$$|\\mu \\nabla^2 \\mathbf{u}| \\sim \\mu \\frac{U}{d^2}$$\n平衡浮力项和粘性项的大小，得到：\n$$\\mu \\frac{U}{d^2} \\sim \\rho \\alpha g \\Delta T$$\n求解对流速度标度 $U$ 得到：\n$$U \\sim \\frac{\\rho \\alpha g \\Delta T d^2}{\\mu}$$\n\n接下来，我们确定特征熔体分离速度 $w$。该速度由熔体相对通量 $\\mathbf{q}$ 通过可渗透固体基质的达西定律导出：\n$$\\mathbf{q} = -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(\\nabla p - \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right)$$\n问题指示我们忽略动态压力梯度，这意味着我们将 $\\nabla p$ 项设为零。流动于是纯粹由熔体相对于固体的浮力驱动。熔体通量矢量变为：\n$$\\mathbf{q} \\sim -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(- \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right) = \\frac{k(\\phi) \\Delta \\rho g}{\\mu_{m}} \\hat{\\mathbf{z}}$$\n熔体分离速度 $w$ 是此通量的大小，$w = |\\mathbf{q}|$：\n$$w \\sim \\frac{k(\\phi) \\Delta \\rho g}{\\mu_{m}}$$\n给定孔隙度-渗透率关系 $k(\\phi) = k_{0}\\,\\phi^{n}$。将其代入 $w$ 的表达式中得到：\n$$w \\sim \\frac{k_{0}\\,\\phi^{n} \\Delta \\rho g}{\\mu_{m}}$$\n\n现在我们可以定义两个时间尺度。对流翻转时间 $\\tau_{\\mathrm{conv}}$ 是固体以速度 $U$ 对流穿过厚度为 $d$ 的柱体所需的时间：\n$$\\tau_{\\mathrm{conv}} = \\frac{d}{U}$$\n熔体分离时间 $\\tau_{\\mathrm{melt}}$ 是熔体以速度 $w$ 运移穿过厚度为 $d$ 的柱体所需的时间：\n$$\\tau_{\\mathrm{melt}} = \\frac{d}{w}$$\n无量纲比 $S$ 是这两个时间尺度的比值：\n$$S = \\frac{\\tau_{\\mathrm{melt}}}{\\tau_{\\mathrm{conv}}} = \\frac{d/w}{d/U} = \\frac{U}{w}$$\n代入推导出的 $U$ 和 $w$ 的标度表达式：\n$$S = \\frac{\\left(\\dfrac{\\rho \\alpha g \\Delta T d^2}{\\mu}\\right)}{\\left(\\dfrac{k_{0}\\,\\phi^{n} \\Delta \\rho g}{\\mu_{m}}\\right)}$$\n通过消去重力加速度 $g$ 来简化表达式：\n$$S = \\frac{\\rho \\alpha \\Delta T d^2 \\mu_{m}}{\\mu k_{0} \\phi^{n} \\Delta \\rho}$$\n这就是比率 $S$ 的最终符号标度表达式。\n\n最后，我们使用提供的参数值对 $S$ 进行数值计算。首先，确保所有值都使用国际单位制（SI）单位。\n- $d = 50\\,\\mathrm{km} = 5 \\times 10^4\\,\\mathrm{m}$\n- $\\rho = 3300\\,\\mathrm{kg \\cdot m^{-3}}$\n- $\\alpha = 3.0 \\times 10^{-5}\\,\\mathrm{K^{-1}}$\n- $\\Delta T = 500\\,\\mathrm{K}$\n- $\\mu = 1.0 \\times 10^{21}\\,\\mathrm{Pa\\,s}$\n- $\\mu_{m} = 10\\,\\mathrm{Pa\\,s}$\n- $\\Delta \\rho = 500\\,\\mathrm{kg \\cdot m^{-3}}$\n- $k_{0} = 1.0 \\times 10^{-10}\\,\\mathrm{m^{2}}$\n- $\\phi = 0.05$\n- $n = 3$\n\n将这些值代入 $S$ 的表达式中：\n$$S = \\frac{(3300) \\cdot (3.0 \\times 10^{-5}) \\cdot (500) \\cdot (5 \\times 10^4)^2 \\cdot (10)}{(1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-10}) \\cdot (0.05)^3 \\cdot (500)}$$\n我们分别计算分子和分母。\n分子：\n$$N = (3300) \\cdot (3.0 \\times 10^{-5}) \\cdot (500) \\cdot (2.5 \\times 10^9) \\cdot (10)$$\n$$N = (3.3 \\times 10^3) \\cdot (3.0 \\times 10^{-5}) \\cdot (5 \\times 10^2) \\cdot (2.5 \\times 10^9) \\cdot (10^1) = 1.2375 \\times 10^{12}$$\n分母：\n$$D = (1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-10}) \\cdot (0.05)^3 \\cdot (500)$$\n$$D = (10^{11}) \\cdot (1.25 \\times 10^{-4}) \\cdot (5 \\times 10^2) = 6.25 \\times 10^9$$\n比率 $S$ 为：\n$$S = \\frac{N}{D} = \\frac{1.2375 \\times 10^{12}}{6.25 \\times 10^9} = 198$$\n问题要求答案四舍五入到四位有效数字。因此，结果是 $198.0$。",
            "answer": "$$\n\\boxed{198.0}\n$$"
        },
        {
            "introduction": "将描述熔体生成和运移的物理方程转化为可靠的计算机模拟，需要解决数值计算中的实际挑战，其中最核心的就是保证算法的稳定性。本练习模拟了一个简化但具有代表性的一维输运方程，要求你通过冯·诺依曼稳定性分析（von Neumann stability analysis）推导不同物理过程（平流、扩散和反应）对时间步长的约束。掌握这些约束条件是开发任何显式时间积分数值模型的必备技能，能够有效避免计算结果出现非物理的振荡或发散。",
            "id": "3617304",
            "problem": "考虑一个用于研究部分熔融地幔中伴随熔体生成的热化学对流的一维垂向柱状模型。代表温度和成分的标量场的演化受平流、扩散以及一个代表熔融/固化的线性化动力学源项控制。此外，孔隙度由熔体相对速度平流输运。假设代表温度、成分或孔隙度演化的通用标量场 $\\psi(x,t)$ 具有以下简化形式：\n$$\n\\frac{\\partial \\psi}{\\partial t} + v \\frac{\\partial \\psi}{\\partial x} = \\kappa \\frac{\\partial^{2} \\psi}{\\partial x^{2}} - \\lambda \\psi,\n$$\n其中，$v$ 是该场的相应平流速度（对于温度和成分，是固体速度；对于孔隙度，是熔体相对速度），$\\kappa$ 是相应的扩散系数（热或化学扩散系数），$\\lambda$ 是一个线性动力学速率，它来自于围绕当前状态对非平衡熔融和潜热耦合进行的线性化。\n\n假设该方程在一个间距为 $\\Delta x$ 的均匀网格上离散化，平流项使用一阶迎风差分，扩散项使用中心二阶差分（时间向前，空间中心），所有项在时间上均使用向前欧拉法。假定不使用算子分裂法；而是采用一个单一的显式时间步长，使用最严格的稳定时间步长来推进所有场。\n\n从离散更新式出发，并使用分别应用于平流、扩散和反应算子的线性傅里叶（von Neumann）分析方法，推导每个过程对时间步长 $\\Delta t$ 的稳定性约束，用 $\\Delta x$、$v$、$\\kappa$ 和 $\\lambda$ 表示。然后，使用所有场和过程中最严格的约束，计算在以下物理上合理的参数下的单一最大稳定时间步长 $\\Delta t_{\\max}$：\n- 网格间距：$\\Delta x = 500$ 米。\n- 最大固体速度大小：$|u_{s}|_{\\max} = 5 \\text{ cm/yr}$。\n- 最大熔体相对速度大小：$|w|_{\\max} = 2 \\text{ m/yr}$。\n- 热扩散系数：$\\kappa_{T} = 1.0 \\times 10^{-6} \\text{ m}^2\\text{/s}$。\n- 化学扩散系数：$\\kappa_{C} = 1.0 \\times 10^{-9} \\text{ m}^2\\text{/s}$。\n- 线性动力学速率：$\\lambda = 5.0 \\times 10^{-10} \\text{ s}^{-1}$。\n\n假定全局平流约束必须使用 $v_{\\max} = \\max\\{ |u_{s}|_{\\max}, |w|_{\\max} \\}$，而全局扩散约束必须使用显式更新的场中的最大扩散系数。你可以取 $1 \\text{ yr} = 3.1536 \\times 10^{7} \\text{ s}$。将最终答案 $\\Delta t_{\\max}$ 以年为单位表示，并将答案四舍五入到三位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 控制方程：$\\frac{\\partial \\psi}{\\partial t} + v \\frac{\\partial \\psi}{\\partial x} = \\kappa \\frac{\\partial^{2} \\psi}{\\partial x^{2}} - \\lambda \\psi$\n- 离散格式：\n    - 平流：一阶迎风差分。\n    - 扩散：中心二阶差分（空间上）。\n    - 时间积分：所有项采用向前欧拉法，在单一显式步骤中进行。\n- 分析方法：线性傅里叶（von Neumann）分析，分别应用于平流、扩散和反应算子。\n- 参数：\n    - 网格间距：$\\Delta x = 500$ 米。\n    - 最大固体速度大小：$|u_{s}|_{\\max} = 5 \\text{ cm/yr}$。\n    - 最大熔体相对速度大小：$|w|_{\\max} = 2 \\text{ m/yr}$。\n    - 热扩散系数：$\\kappa_{T} = 1.0 \\times 10^{-6} \\text{ m}^2\\text{/s}$。\n    - 化学扩散系数：$\\kappa_{C} = 1.0 \\times 10^{-9} \\text{ m}^2\\text{/s}$。\n    - 线性动力学速率：$\\lambda = 5.0 \\times 10^{-10} \\text{ s}^{-1}$。\n- 计算条件：\n    - 全局平流约束必须使用 $v_{\\max} = \\max\\{ |u_{s}|_{\\max}, |w|_{\\max} \\}$。\n    - 全局扩散约束必须使用最大扩散系数 $\\kappa_{\\max}$。\n    - 各个稳定性约束中最严格的一个决定了总的时间步长 $\\Delta t_{\\max}$。\n- 常数：$1 \\text{ yr} = 3.1536 \\times 10^{7} \\text{ s}$。\n- 输出要求：$\\Delta t_{\\max}$ 以年为单位，四舍五入到三位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据：**该问题描述了一个简化的平流-扩散-反应方程的数值稳定性分析，这是输运现象和计算地球物理学中的一个基本模型。所用的数值格式（向前欧拉法、迎风法、FTCS）是标准的显式方法。给出的参数被认为是对于地幔过程物理上合理的。该问题在科学上是合理的。\n- **适定的：**任务是为指定的数值格式推导稳定性约束，并根据一组明确的规则和给定参数计算最大时间步长。这是一个定义明确的数值分析问题，有唯一的解。\n- **客观性：**问题使用精确的数学和计算语言陈述，没有歧义或主观论断。\n\n该问题没有违反任何无效性标准。它是自洽的、一致的且有科学依据的。单独分析算子的指令是一个定义求解路径的特定指令，这在数值稳定性的入门处理中是一种常见的简化方法。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n### 稳定性约束的推导\n问题要求使用 von Neumann 分析法，分别为每个物理过程——平流、扩散和反应——推导稳定性约束。令 $\\psi_j^n$ 代表在网格点 $j$ 和时间步 $n$ 的数值解。我们通过将单个傅里叶模 $\\psi_j^n = G^n e^{i k j \\Delta x}$（其中 $k$ 是波数）代入每个过程的离散方程中，来求解增长因子 $G$。稳定性要求 $|G| \\leq 1$。\n\n**1. 平流稳定性（空间一阶迎风，时间向前欧拉）**\n纯平流方程为 $\\frac{\\partial \\psi}{\\partial t} + v \\frac{\\partial \\psi}{\\partial x} = 0$。对于 $v > 0$ 使用一阶迎风差分，格式为：\n$$ \\frac{\\psi_j^{n+1} - \\psi_j^n}{\\Delta t} + v \\frac{\\psi_j^n - \\psi_{j-1}^n}{\\Delta x} = 0 $$\n为 $\\psi_j^{n+1}$ 重新整理：\n$$ \\psi_j^{n+1} = \\psi_j^n - \\frac{v \\Delta t}{\\Delta x} (\\psi_j^n - \\psi_{j-1}^n) $$\n令 $C = \\frac{v \\Delta t}{\\Delta x}$ 为库朗数。代入傅里叶模：\n$$ G^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} - C (G^n e^{i k j \\Delta x} - G^n e^{i k (j-1) \\Delta x}) $$\n除以 $G^n e^{i k j \\Delta x}$：\n$$ G = 1 - C (1 - e^{-i k \\Delta x}) = 1 - C(1 - \\cos(k\\Delta x)) - i C \\sin(k\\Delta x) $$\n增长因子的模平方为：\n$$ |G|^2 = (1 - C(1-\\cos(k\\Delta x)))^2 + (C\\sin(k\\Delta x))^2 = 1 - 2C(1-C)(1-\\cos(k\\Delta x)) $$\n为了保证稳定性，要求 $|G|^2 \\leq 1$，这意味着 $-2C(1-C)(1-\\cos(k\\Delta x)) \\leq 0$。由于 $C>0$ 且 $1-\\cos(k\\Delta x) \\ge 0$，这简化为 $1-C \\ge 0$，即 $C \\leq 1$。对于一般速度 $v$，条件是 $\\frac{|v| \\Delta t}{\\Delta x} \\leq 1$。\n平流约束为：\n$$ \\Delta t_{\\text{adv}} \\leq \\frac{\\Delta x}{|v|} $$\n\n**2. 扩散稳定性（空间中心二阶差分，时间向前欧拉）**\n纯扩散方程为 $\\frac{\\partial \\psi}{\\partial t} = \\kappa \\frac{\\partial^{2} \\psi}{\\partial x^{2}}$。FTCS 格式为：\n$$ \\frac{\\psi_j^{n+1} - \\psi_j^n}{\\Delta t} = \\kappa \\frac{\\psi_{j+1}^n - 2\\psi_j^n + \\psi_{j-1}^n}{(\\Delta x)^2} $$\n令 $d = \\frac{\\kappa \\Delta t}{(\\Delta x)^2}$。代入傅里叶模：\n$$ G = 1 + d (e^{i k \\Delta x} - 2 + e^{-i k \\Delta x}) = 1 + 2d(\\cos(k\\Delta x) - 1) = 1 - 4d \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\n为了保证稳定性，我们要求 $|G| \\leq 1$。由于 $G$ 是实数，所以 $-1 \\leq G \\leq 1$。条件 $G \\leq 1$ 总是满足的。条件 $G \\geq -1$ 要求：\n$$ 1 - 4d \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\geq -1 \\implies 2 \\geq 4d \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\n这个条件必须对所有的 $k$ 都成立。$\\sin^2(\\frac{k\\Delta x}{2})$ 的最大值为 $1$。因此，我们需要 $2 \\geq 4d$，这意味着 $d \\leq \\frac{1}{2}$。\n扩散约束为：\n$$ \\Delta t_{\\text{diff}} \\leq \\frac{(\\Delta x)^2}{2\\kappa} $$\n\n**3. 反应稳定性（时间向前欧拉）**\n纯反应方程为 $\\frac{\\partial \\psi}{\\partial t} = -\\lambda \\psi$。向前欧拉格式为：\n$$ \\frac{\\psi_j^{n+1} - \\psi_j^n}{\\Delta t} = -\\lambda \\psi_j^n $$\n$$ \\psi_j^{n+1} = (1 - \\lambda \\Delta t) \\psi_j^n $$\n增长因子为 $G = 1 - \\lambda \\Delta t$。为了保证稳定性，要求 $|G| \\leq 1$。由于 $\\lambda > 0$ 且 $\\Delta t > 0$，所以 $G \\leq 1$ 总是成立的。条件 $-1 \\leq G$ 给出：\n$$ -1 \\leq 1 - \\lambda \\Delta t \\implies \\lambda \\Delta t \\leq 2 $$\n反应约束为：\n$$ \\Delta t_{\\text{reac}} \\leq \\frac{2}{\\lambda} $$\n\n### 最大稳定时间步长的计算\n我们现在使用给定的参数和规则计算每个约束的数值。首先，将所有参数转换为一致的国际单位制（米，秒）。\n\n**国际单位制下的参数：**\n- $\\Delta x = 500$ m\n- $|u_{s}|_{\\max} = 5 \\text{ cm/yr} = 5 \\times \\frac{10^{-2} \\text{ m}}{3.1536 \\times 10^7 \\text{ s}} \\approx 1.5855 \\times 10^{-9} \\text{ m/s}$\n- $|w|_{\\max} = 2 \\text{ m/yr} = \\frac{2 \\text{ m}}{3.1536 \\times 10^7 \\text{ s}} \\approx 6.3421 \\times 10^{-8} \\text{ m/s}$\n- $v_{\\max} = \\max\\{|u_{s}|_{\\max}, |w|_{\\max}\\} \\approx 6.3421 \\times 10^{-8} \\text{ m/s}$\n- $\\kappa_{\\max} = \\max\\{\\kappa_T, \\kappa_C\\} = \\max\\{1.0 \\times 10^{-6}, 1.0 \\times 10^{-9}\\} = 1.0 \\times 10^{-6} \\text{ m}^2\\text{/s}$\n- $\\lambda = 5.0 \\times 10^{-10} \\text{ s}^{-1}$\n\n**计算单个时间步长限制：**\n- **平流限制：**\n$$ \\Delta t_{\\text{adv}} = \\frac{\\Delta x}{v_{\\max}} = \\frac{500 \\text{ m}}{2 \\text{ m/yr}} = 250 \\text{ yr} $$\n换算成秒：$\\Delta t_{\\text{adv}} = 250 \\times (3.1536 \\times 10^7 \\text{ s}) = 7.884 \\times 10^9 \\text{ s}$。\n\n- **扩散限制：**\n$$ \\Delta t_{\\text{diff}} = \\frac{(\\Delta x)^2}{2\\kappa_{\\max}} = \\frac{(500 \\text{ m})^2}{2 \\times (1.0 \\times 10^{-6} \\text{ m}^2\\text{/s})} = \\frac{2.5 \\times 10^5 \\text{ m}^2}{2.0 \\times 10^{-6} \\text{ m}^2\\text{/s}} = 1.25 \\times 10^{11} \\text{ s} $$\n\n- **反应限制：**\n$$ \\Delta t_{\\text{reac}} = \\frac{2}{\\lambda} = \\frac{2}{5.0 \\times 10^{-10} \\text{ s}^{-1}} = 4.0 \\times 10^9 \\text{ s} $$\n\n**确定最严格的约束：**\n总的最大稳定时间步长 $\\Delta t_{\\max}$ 是各个限制中的最小值。\n$$ \\Delta t_{\\max} = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}}, \\Delta t_{\\text{reac}}) $$\n$$ \\Delta t_{\\max} = \\min(7.884 \\times 10^9 \\text{ s}, 1.25 \\times 10^{11} \\text{ s}, 4.0 \\times 10^9 \\text{ s}) $$\n最严格的限制来自反应项：\n$$ \\Delta t_{\\max} = 4.0 \\times 10^9 \\text{ s} $$\n\n**最终转换和四舍五入：**\n问题要求答案以年为单位，并四舍五入到三位有效数字。\n$$ \\Delta t_{\\max} (\\text{yr}) = \\frac{4.0 \\times 10^9 \\text{ s}}{3.1536 \\times 10^7 \\text{ s/yr}} \\approx 126.8404 \\text{ yr} $$\n四舍五入到三位有效数字得到 $127$ 年。",
            "answer": "$$\n\\boxed{127}\n$$"
        }
    ]
}