{
    "hands_on_practices": [
        {
            "introduction": "这项实践是量化熔体动力学的第一步。通过在地幔压力梯度背景下应用达西定律，你将推导并计算熔体分离速度。这项基础练习将基本物理原理与一个关键参数联系起来，该参数控制着地幔中熔体提取的效率。",
            "id": "3617298",
            "problem": "考虑硅酸盐熔体在重力作用下，通过部分熔融、可渗透的地幔基质的一维、稳态、垂直流动，并以向上为正方向。将此两相混合体视为多孔介质，并采用以下物理图像：在连续介质尺度上，熔体相受到压力梯度力、浮力和与熔体-固相相对速度成正比的粘性拖曳力之间的平衡，这与孔隙中的斯托克斯流 (Stokes flow) 一致。假设熔体具有牛顿流变性，并忽略惯性效应。假设固相基质近似处于静水压力状态，因此在局部，熔体压力梯度接近于固相岩石静压力梯度。将分离速度定义为熔体相对于固相基质的达西通量 (Darcy flux)，记为 $w_{\\mathrm{seg}}$，其单位为速度。\n\n从多孔介质流动的力平衡和渗透率的定义出发，推导 $w_{\\mathrm{seg}}$ 的表达式，该表达式应使用渗透率 $k$、熔体粘度 $\\mu_{\\ell}$、固相与熔体之间的密度差 $\\Delta \\rho$（如果固相比熔体密度大，则取 $\\Delta \\rho>0$）以及重力加速度 $g$ 来表示。然后，对于依赖于孔隙度的渗透率 $k(\\phi)=k_{0}\\,\\phi^{n}$，其中 $k_{0}=1.0\\times 10^{-8}\\ \\mathrm{m}^{2}$ 且 $n=3$，熔体粘度 $\\mu_{\\ell}=10\\ \\mathrm{Pa \\cdot s}$，密度差 $\\Delta \\rho=300\\ \\mathrm{kg \\cdot m^{-3}}$，以及重力加速度 $g=9.81\\ \\mathrm{m \\cdot s^{-2}}$，计算在 $\\phi=0.01$ 和 $\\phi=0.05$ 时的分离速度。\n\n将两个结果都以 $\\mathrm{m \\cdot s^{-1}}$ 为单位表示，并四舍五入到三位有效数字。将这两个值按 $\\phi=0.01$、$\\phi=0.05$ 的顺序列在一个单行矩阵中。",
            "solution": "该问题要求推导熔体分离速度 $w_{\\mathrm{seg}}$，并针对两个给定的孔隙度进行数值计算。物理系统是熔体通过固相基质的一维、稳态、垂直流动，该系统被视为多孔介质。\n\n出发点是熔体相的力平衡。问题陈述了该平衡涉及压力梯度力、浮力和粘性拖曳力。这种平衡关系被广义的达西定律 (Darcy's Law) 所概括，该定律将达西通量与流体势的梯度联系起来。熔体相对于固相基质的达西通量被定义为分离速度 $w_{\\mathrm{seg}}$。设垂直坐标为 $z$，以向上为正方向。因此，重力加速度矢量为 $\\mathbf{g} = -g \\hat{z}$，其中 $g$ 是重力加速度的大小。\n\n一维情况下，垂直分离速度 $w_{\\mathrm{seg}}$ 的达西定律由下式给出：\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( \\frac{dP_{\\ell}}{dz} - \\rho_{\\ell} (-g) \\right)\n$$\n其中 $k$ 是介质的渗透率，$\\mu_{\\ell}$ 是熔体的动力粘度，$P_{\\ell}$ 是熔体压力，$\\rho_{\\ell}$ 是熔体密度。该方程可重写为：\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( \\frac{dP_{\\ell}}{dz} + \\rho_{\\ell} g \\right)\n$$\n括号中的项代表熔体流动的驱动力。它是熔体压力梯度与熔体自身静水压力梯度的偏差。\n\n问题提供的一个关键信息是假设固相基质近似处于静水压力状态，并且“在局部，熔体压力梯度接近于固相岩石静压力梯度”。由密度为 $\\rho_s$ 的固相引起的岩石静压力梯度由 $\\frac{dP_s}{dz} = -\\rho_s g$ 给出。应用该问题的假设，我们将熔体压力梯度近似为：\n$$\n\\frac{dP_{\\ell}}{dz} \\approx \\frac{dP_s}{dz} = -\\rho_s g\n$$\n这是熔体运移模型中的一个标准简化，它假定刚性的固相基质支撑着上覆载荷，因此压力梯度由固相的密度决定。\n\n将此近似值代入 $w_{\\mathrm{seg}}$ 的方程中：\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( (-\\rho_s g) + \\rho_{\\ell} g \\right)\n$$\n$$\nw_{\\mathrm{seg}} = -\\frac{k g}{\\mu_{\\ell}} (\\rho_{\\ell} - \\rho_s)\n$$\n通过提出因子 $-1$，我们得到：\n$$\nw_{\\mathrm{seg}} = \\frac{k g}{\\mu_{\\ell}} (\\rho_s - \\rho_{\\ell})\n$$\n问题将密度差定义为 $\\Delta \\rho = \\rho_s - \\rho_{\\ell}$，由于固相比熔体密度大，因此 $\\Delta \\rho > 0$。因此，分离速度的最终符号表达式为：\n$$\nw_{\\mathrm{seg}} = \\frac{k \\Delta \\rho g}{\\mu_{\\ell}}\n$$\n这就完成了问题的第一部分。$w_{\\mathrm{seg}}$ 的正值表示向上流动，这在物理上与较轻的熔体在重力作用下渗透过较密的固相基质是一致的。\n\n对于第二部分，我们必须计算特定参数值下的 $w_{\\mathrm{seg}}$。渗透率 $k$ 是孔隙度 $\\phi$ 的函数，给出如下：\n$$\nk(\\phi) = k_0 \\phi^n\n$$\n将此式代入我们得到的 $w_{\\mathrm{seg}}$ 表达式中，得出：\n$$\nw_{\\mathrm{seg}}(\\phi) = \\frac{k_0 \\phi^n \\Delta \\rho g}{\\mu_{\\ell}}\n$$\n提供的参数值为：\n- $k_0 = 1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}$\n- $n = 3$\n- $\\mu_{\\ell} = 10\\ \\mathrm{Pa \\cdot s}$\n- $\\Delta \\rho = 300\\ \\mathrm{kg \\cdot m^{-3}}$\n- $g = 9.81\\ \\mathrm{m \\cdot s^{-2}}$\n\n我们现在计算在两个指定的孔隙度 $\\phi=0.01$ 和 $\\phi=0.05$ 下的 $w_{\\mathrm{seg}}$。\n\n情况1：孔隙度 $\\phi = 0.01$\n首先，计算渗透率：\n$$\nk(0.01) = (1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}) \\times (0.01)^3 = (1.0 \\times 10^{-8}) \\times (10^{-2})^3 = 1.0 \\times 10^{-14}\\ \\mathrm{m}^{2}\n$$\n现在，计算分离速度：\n$$\nw_{\\mathrm{seg}}(0.01) = \\frac{(1.0 \\times 10^{-14}\\ \\mathrm{m}^{2}) \\times (300\\ \\mathrm{kg \\cdot m^{-3}}) \\times (9.81\\ \\mathrm{m \\cdot s^{-2}})}{10\\ \\mathrm{Pa \\cdot s}}\n$$\n$$\nw_{\\mathrm{seg}}(0.01) = \\frac{2.943 \\times 10^{-11}}{10}\\ \\mathrm{m \\cdot s^{-1}} = 2.943 \\times 10^{-12}\\ \\mathrm{m \\cdot s^{-1}}\n$$\n四舍五入到三位有效数字，我们得到 $w_{\\mathrm{seg}}(0.01) = 2.94 \\times 10^{-12}\\ \\mathrm{m \\cdot s^{-1}}$。\n\n情况2：孔隙度 $\\phi = 0.05$\n首先，计算渗透率：\n$$\nk(0.05) = (1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}) \\times (0.05)^3 = (1.0 \\times 10^{-8}) \\times (1.25 \\times 10^{-4}) = 1.25 \\times 10^{-12}\\ \\mathrm{m}^{2}\n$$\n现在，计算分离速度：\n$$\nw_{\\mathrm{seg}}(0.05) = \\frac{(1.25 \\times 10^{-12}\\ \\mathrm{m}^{2}) \\times (300\\ \\mathrm{kg \\cdot m^{-3}}) \\times (9.81\\ \\mathrm{m \\cdot s^{-2}})}{10\\ \\mathrm{Pa \\cdot s}}\n$$\n$$\nw_{\\mathrm{seg}}(0.05) = \\frac{3.67875 \\times 10^{-9}}{10}\\ \\mathrm{m \\cdot s^{-1}} = 3.67875 \\times 10^{-10}\\ \\mathrm{m \\cdot s^{-1}}\n$$\n四舍五入到三位有效数字，我们得到 $w_{\\mathrm{seg}}(0.05) = 3.68 \\times 10^{-10}\\ \\mathrm{m \\cdot s^{-1}}$。\n\n计算出的两个分离速度分别为：当 $\\phi=0.01$ 时为 $2.94 \\times 10^{-12}\\ \\mathrm{m \\cdot s^{-1}}$，当 $\\phi=0.05$ 时为 $3.68 \\times 10^{-10}\\ \\mathrm{m \\cdot s^{-1}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.94 \\times 10^{-12} & 3.68 \\times 10^{-10}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在计算出熔体速度后，一个关键问题随之而来：熔体运移的速度与缓慢得多的固态地幔对流过程相比如何？本练习引入了量级分析，这是一个用于比较不同物理过程特征时间尺度的强大工具。通过建立和评估一个无量纲比率，你将深入理解熔体能否在其被大规模地幔流卷走之前逃离源区。",
            "id": "3617358",
            "problem": "考虑一个厚度为 $d$ 的具有热化学浮力的部分熔融上地幔柱，其正在经历等黏性、无限普朗特数对流以及同时发生的熔体分离。假设一个从底部到顶部的温差 $\\Delta T$ 在固体中产生了一个由黏性阻力平衡的浮力，并且熔体在熔体和固体之间的浮力差 $\\Delta \\rho$ 作用下，通过一个由孔隙度相关渗透率描述的可渗透基质垂直运移。使用以下基本定律和定义作为出发点：\n\n- 针对具有热浮力的不可压缩蠕变流的稳态斯托克斯动量平衡方程：$-\\nabla p + \\mu \\nabla^{2} \\mathbf{u} + \\rho \\alpha g \\Delta T \\,\\hat{\\mathbf{z}} = \\mathbf{0}$。\n- 描述熔体通过多孔固体基质的相对通量的达西定律：$\\mathbf{q} = -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(\\nabla p - \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right)$。\n- 孔隙度-渗透率关系：$k(\\phi) = k_{0}\\,\\phi^{n}$。\n\n在此，$\\rho$ 是固体密度，$\\alpha$ 是热膨胀系数，$g$ 是重力加速度，$\\mu$ 是固体黏度，$\\mu_{m}$ 是熔体黏度，$\\phi$ 是局部孔隙度。通过在尺度 $d$ 上平衡热浮力与黏性阻力来处理对流固体速度标度 $U$，并通过在垂直方向上由浮力驱动的达西流来处理熔体分离速度标度 $w$，同时忽略固体流动产生的动力压力梯度并假设性质恒定。定义对流翻转时间 $\\tau_{\\mathrm{conv}} = d/U$ 和熔体分离时间 $\\tau_{\\mathrm{melt}} = d/w$。\n\n基于这些基础，推导无量纲比率 $S = \\tau_{\\mathrm{melt}}/\\tau_{\\mathrm{conv}}$ 关于给定参数的标度表达式，然后对以下代表上地幔熔融柱的参数集进行数值计算：\n\n- 柱体厚度 $d = 50\\,\\mathrm{km}$，\n- 固体密度 $\\rho = 3300\\,\\mathrm{kg \\cdot m^{-3}}$，\n- 热膨胀系数 $\\alpha = 3.0 \\times 10^{-5}\\,\\mathrm{K^{-1}}$，\n- 温差 $\\Delta T = 500\\,\\mathrm{K}$，\n- 重力加速度 $g = 9.81\\,\\mathrm{m \\cdot s^{-2}}$，\n- 固体黏度 $\\mu = 1.0 \\times 10^{21}\\,\\mathrm{Pa \\cdot s}$，\n- 熔体黏度 $\\mu_{m} = 10\\,\\mathrm{Pa \\cdot s}$，\n- 密度差 $\\Delta \\rho = 500\\,\\mathrm{kg \\cdot m^{-3}}$，\n- 渗透率前置因子 $k_{0} = 1.0 \\times 10^{-10}\\,\\mathrm{m^{2}}$，\n- 孔隙度 $\\phi = 0.05$，\n- 渗透率指数 $n = 3$。\n\n将最终答案表示为单个无量纲数。将答案四舍五入至四位有效数字。最终答案中不应出现单位。",
            "solution": "该问题陈述经核实具有坚实的科学基础，提法恰当且客观。它基于流体动力学的既定原理，应用于计算地球物理学中的一个标准问题。给定的方程、假设和参数值对于地球上地幔中熔体生成的背景是恰当且物理上现实的。该问题是自洽的，并为得出唯一解提供了一条清晰明确的路径。因此，下面将给出完整解法。\n\n目标是推导无量纲比率 $S = \\tau_{\\mathrm{melt}}/\\tau_{\\mathrm{conv}}$ 的标度表达式，其中 $\\tau_{\\mathrm{melt}}$ 是熔体分离时间，$\\tau_{\\mathrm{conv}}$ 是对流翻转时间。\n\n首先，我们确定固体地幔对流的特征速度标度 $U$。问题指明，该标度是通过在柱体长度尺度 $d$ 上平衡热浮力与黏性阻力来找到的。固体流动的控制方程是稳态斯托克斯动量平衡方程：\n$$-\\nabla p + \\mu \\nabla^{2} \\mathbf{u} + \\rho \\alpha g \\Delta T \\,\\hat{\\mathbf{z}} = \\mathbf{0}$$\n在此方程中，单位体积的热浮力大小为 $\\rho \\alpha g \\Delta T$。单位体积的黏性阻力由项 $\\mu \\nabla^{2} \\mathbf{u}$ 表示。对于特征速度标度 $U$ 和长度标度 $d$，黏性项的标度为：\n$$|\\mu \\nabla^2 \\mathbf{u}| \\sim \\mu \\frac{U}{d^2}$$\n平衡浮力项和黏性项的大小，得到：\n$$\\mu \\frac{U}{d^2} \\sim \\rho \\alpha g \\Delta T$$\n求解对流速度标度 $U$ 得：\n$$U \\sim \\frac{\\rho \\alpha g \\Delta T d^2}{\\mu}$$\n\n接下来，我们确定特征熔体分离速度 $w$。该速度由描述熔体通过可渗透固体基质的相对通量 $\\mathbf{q}$ 的达西定律推导得出：\n$$\\mathbf{q} = -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(\\nabla p - \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right)$$\n问题指示我们忽略动力压力梯度，这意味着我们将 $\\nabla p$ 项设为零。于是，流动完全由熔体相对于固体的浮力驱动。熔体通量矢量变为：\n$$\\mathbf{q} \\sim -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(- \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right) = \\frac{k(\\phi) \\Delta \\rho g}{\\mu_{m}} \\hat{\\mathbf{z}}$$\n熔体分离速度 $w$ 是该通量的大小，即 $w = |\\mathbf{q}|$：\n$$w \\sim \\frac{k(\\phi) \\Delta \\rho g}{\\mu_{m}}$$\n给定孔隙度-渗透率关系 $k(\\phi) = k_{0}\\,\\phi^{n}$。将其代入 $w$ 的表达式中，得到：\n$$w \\sim \\frac{k_{0}\\,\\phi^{n} \\Delta \\rho g}{\\mu_{m}}$$\n\n现在我们可以定义这两个时间尺度。对流翻转时间 $\\tau_{\\mathrm{conv}}$ 是固体以速度 $U$ 对流通过厚度为 $d$ 的柱体所需的时间：\n$$\\tau_{\\mathrm{conv}} = \\frac{d}{U}$$\n熔体分离时间 $\\tau_{\\mathrm{melt}}$ 是熔体以速度 $w$ 运移通过厚度为 $d$ 的柱体所需的时间：\n$$\\tau_{\\mathrm{melt}} = \\frac{d}{w}$$\n无量纲比率 $S$ 是这两个时间尺度的比值：\n$$S = \\frac{\\tau_{\\mathrm{melt}}}{\\tau_{\\mathrm{conv}}} = \\frac{d/w}{d/U} = \\frac{U}{w}$$\n代入推导出的 $U$ 和 $w$ 的标度表达式：\n$$S = \\frac{\\left(\\dfrac{\\rho \\alpha g \\Delta T d^2}{\\mu}\\right)}{\\left(\\dfrac{k_{0}\\,\\phi^{n} \\Delta \\rho g}{\\mu_{m}}\\right)}$$\n通过消去重力加速度 $g$ 来简化表达式：\n$$S = \\frac{\\rho \\alpha \\Delta T d^2 \\mu_{m}}{\\mu k_{0} \\phi^{n} \\Delta \\rho}$$\n这就是比率 $S$ 的最终符号化标度表达式。\n\n最后，我们使用提供的参数值对 $S$ 进行数值计算。首先，确保所有值都采用国际单位制（SI units）。\n- $d = 50\\,\\mathrm{km} = 5 \\times 10^4\\,\\mathrm{m}$\n- $\\rho = 3300\\,\\mathrm{kg \\cdot m^{-3}}$\n- $\\alpha = 3.0 \\times 10^{-5}\\,\\mathrm{K^{-1}}$\n- $\\Delta T = 500\\,\\mathrm{K}$\n- $\\mu = 1.0 \\times 10^{21}\\,\\mathrm{Pa \\cdot s}$\n- $\\mu_{m} = 10\\,\\mathrm{Pa \\cdot s}$\n- $\\Delta \\rho = 500\\,\\mathrm{kg \\cdot m^{-3}}$\n- $k_{0} = 1.0 \\times 10^{-10}\\,\\mathrm{m^{2}}$\n- $\\phi = 0.05$\n- $n = 3$\n\n将这些值代入 $S$ 的表达式中：\n$$S = \\frac{(3300) \\cdot (3.0 \\times 10^{-5}) \\cdot (500) \\cdot (5 \\times 10^4)^2 \\cdot (10)}{(1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-10}) \\cdot (0.05)^3 \\cdot (500)}$$\n我们分别计算分子和分母。\n分子：\n$$N = (3300) \\cdot (3.0 \\times 10^{-5}) \\cdot (500) \\cdot (2.5 \\times 10^9) \\cdot (10)$$\n$$N = (3.3 \\times 10^3) \\cdot (3.0 \\times 10^{-5}) \\cdot (5 \\times 10^2) \\cdot (2.5 \\times 10^9) \\cdot (10^1) = 1.2375 \\times 10^{12}$$\n分母：\n$$D = (1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-10}) \\cdot (0.05)^3 \\cdot (500)$$\n$$D = (10^{11}) \\cdot (1.25 \\times 10^{-4}) \\cdot (5 \\times 10^2) = 6.25 \\times 10^9$$\n比率 $S$ 为：\n$$S = \\frac{N}{D} = \\frac{1.2375 \\times 10^{12}}{6.25 \\times 10^9} = 198$$\n问题要求答案四舍五入到四位有效数字。因此，结果为 $198.0$。",
            "answer": "$$\n\\boxed{198.0}\n$$"
        },
        {
            "introduction": "理解热化学过程的最后阶段是建立一个能够求解控制方程的数值模型。本实践将指导你为一个简化的输运方程实现一个有限差分求解器，该方程捕捉了地幔中标量输运的本质。至关重要的是，你将使用“人造解法”（Method of Manufactured Solutions, MMS）来严格验证代码的准确性，这是所有计算科学中的一项基本技能。",
            "id": "3617375",
            "problem": "考虑一个垂直定向的一维多孔柱，其代表了正在经历热化学对流和熔体生成的部分熔融地幔。我们对蠕变粘性固相流（斯托克斯流）、多孔介质熔体分离（达西流）以及被动热化学标量输运之间的耦合进行建模。空间域为 $z \\in [0,1]$，时间域为 $t \\in [0,T]$。控制性假设和方程如下。\n\n基本原理。我们从不可压缩蠕变粘性流的质量和动量守恒、熔体渗流的达西定律以及标量的对流-扩散-反应输运出发。在一维空间中，对于不可压缩流且边界为无滑移边界，固相速度 $u(z)$ 满足 $\\partial_z u = 0$ 和 $u(0)=u(1)=0$，这意味着 $u(z) \\equiv 0$。压力 $p(z)$ 由力平衡决定。在人工强迫设置中，我们将其视为一个预设的垂直压力梯度，\n$$\n\\frac{d p}{d z} = f,\n$$\n且 $p(0)=0$。熔体通量 $w(z)$ 遵循达西定律，\n$$\nw(z) = -\\frac{K}{\\mu}\\left(\\frac{d p}{d z} - \\Delta \\rho g\\right),\n$$\n其中 $K$ 是渗透率，$\\mu$ 是熔体粘度，$\\Delta \\rho$ 是固相和熔体之间的密度差，$g$ 是重力加速度。我们假设熔体分数 $\\phi$ 为常数，因此驱动热化学输运的对流速度为 $a \\equiv \\phi w$。\n\n被动热化学标量 $c(z,t)$ 满足对流-扩散-反应方程，\n$$\n\\frac{\\partial c}{\\partial t} + \\frac{\\partial}{\\partial z}\\left( a\\, c \\right) = D\\, \\frac{\\partial^2 c}{\\partial z^2} + S(z,t),\n$$\n其中 $D$ 是分子扩散率，$S(z,t)$ 是一个源项。我们施加齐次狄利克雷边界条件 $c(0,t)=0$ 和 $c(1,t)=0$，以及与下述人工精确解一致的初始条件 $c(z,0)$。\n\n人工精确解与源项。令\n$$\nc_{\\text{exact}}(z,t) = \\sin(2\\pi z)\\, e^{-\\lambda t},\n$$\n其中给定衰减率 $\\lambda > 0$。选择源项 $S(z,t)$，使得 $c_{\\text{exact}}$ 满足常数 $a$ 的连续输运方程：\n$$\nS(z,t) = \\frac{\\partial c_{\\text{exact}}}{\\partial t} + a \\frac{\\partial c_{\\text{exact}}}{\\partial z} - D\\, \\frac{\\partial^2 c_{\\text{exact}}}{\\partial z^2}.\n$$\n具体表达式为，\n$$\n\\frac{\\partial c_{\\text{exact}}}{\\partial t} = -\\lambda \\sin(2\\pi z)\\, e^{-\\lambda t},\\quad\n\\frac{\\partial c_{\\text{exact}}}{\\partial z} = 2\\pi \\cos(2\\pi z)\\, e^{-\\lambda t},\\quad\n\\frac{\\partial^2 c_{\\text{exact}}}{\\partial z^2} = - (2\\pi)^2 \\sin(2\\pi z)\\, e^{-\\lambda t}.\n$$\n初始条件为 $c(z,0) = c_{\\text{exact}}(z,0)$。\n\n数值离散化。使用 $N$ 个均匀间隔的网格点 $z_i = i \\Delta z$（$i=0,\\dots,N-1$），其中 $\\Delta z = 1/(N-1)$。时间以步长 $\\Delta t$ 进行离散；取 $n$ 个时间层级 $t^n = n \\Delta t$ 直至 $T$。根据 $dp/dz=f$ 和 $p(0)=0$ 计算 $p$，得到 $p(z)=f z$。然后计算 $w = -\\frac{K}{\\mu}(f - \\Delta \\rho g)$ 和 $a = \\phi w$。\n\n对于从 $c^n$到 $c^{n+1}$ 的输运更新，采用半隐式有限差分格式：对扩散项进行隐式处理，对流项（速度为常数 $a$）则通过一阶迎风格式进行显式处理。在内部节点 $i=1,\\dots,N-2$ 处的离散方程为\n$$\nc_i^{n+1} - c_i^n + \\Delta t\\, \\mathcal{A}_i(c^n) = \\Delta t\\, D\\, \\mathcal{L}_i(c^{n+1}) + \\Delta t\\, S(z_i,t^n),\n$$\n其中 $\\mathcal{L}_i(c) = \\dfrac{c_{i-1} - 2 c_i + c_{i+1}}{\\Delta z^2}$ 是带有齐次狄利克雷边界的标准二阶差分拉普拉斯算子，迎风对流算子 $\\mathcal{A}_i(c)$ 为\n$$\n\\mathcal{A}_i(c) =\n\\begin{cases}\na\\, \\dfrac{c_i - c_{i-1}}{\\Delta z}, & a \\ge 0, \\\\\na\\, \\dfrac{c_{i+1} - c_i}{\\Delta z}, & a < 0.\n\\end{cases}\n$$\n强制施加 $c_0^{n+1}=0$ 和 $c_{N-1}^{n+1}=0$。这样，在每个时间步，内部未知数构成一个三对角线性系统，其系数为\n$$\n\\text{diag} = 1 + 2 r,\\quad \\text{sub} = -r,\\quad \\text{sup} = -r,\\quad r=\\frac{\\Delta t\\, D}{\\Delta z^2}.\n$$\n在每个时间步求解该系统以推进 $c$；然后在最终时刻计算所有网格点上数值解与 $c_{\\text{exact}}(z,T)$ 之间的最大绝对差作为误差。\n\n测试套件。实现求解器，并报告以下每组参数在最终时刻的最大绝对误差。所有参数都是无量纲的，通过相对于特征尺度的无量纲化得到，因此输出是无单位的纯数。\n\n- 情况 A（理想路径，中等对流）：$N=101$，$\\Delta t=5\\times 10^{-4}$，$T=5\\times 10^{-2}$，$D=10^{-3}$，$K=10^{-2}$，$\\mu=1$，$\\phi=10^{-2}$，$\\Delta \\rho g=1$，$f=0.5$，$\\lambda=0.3$。\n- 情况 B（边界情况，零渗透率）：$N=101$，$\\Delta t=10^{-3}$，$T=5\\times 10^{-2}$，$D=10^{-3}$，$K=0$，$\\mu=1$，$\\phi=5\\times 10^{-2}$，$\\Delta \\rho g=1$，$f=0.9$，$\\lambda=0.3$。\n- 情况 C（边缘情况，高对流迎风格式）：$N=201$，$\\Delta t=10^{-3}$，$T=2\\times 10^{-2}$，$D=10^{-4}$，$K=1$，$\\mu=1$，$\\phi=0.1$，$\\Delta \\rho g=2$，$f=0$，$\\lambda=0.5$。\n- 情况 D（边界情况，静水压力平衡导致零熔体通量）：$N=151$，$\\Delta t=10^{-3}$，$T=5\\times 10^{-2}$，$D=5\\times 10^{-4}$，$K=10^{-1}$，$\\mu=1$，$\\phi=5\\times 10^{-2}$，$\\Delta \\rho g=1.5$，$f=1.5$，$\\lambda=0.25$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result\\_A,result\\_B,result\\_C,result\\_D]$），其中每个 $result$ 是相应情况下最终时刻的最大绝对误差，以浮点数表示。",
            "solution": "该问题要求开发一个数值求解器，用于求解一个一维对流-扩散-反应方程，该方程模拟了多孔介质中被动热化学标量的输运过程。求解器的精度将使用人工解方法进行验证。过程如下：首先，我们建立连续数学模型；其次，我们推导离散数值格式；第三，我们概述用于解决指定测试用例的计算算法。\n\n**1. 数学模型**\n\n物理系统是一个定义在空间域 $z \\in [0, 1]$ 上的一维多孔柱。被动标量浓度 $c(z,t)$ 随时间 $t$ 的输运由对流-扩散-反应方程控制：\n$$\n\\frac{\\partial c}{\\partial t} + \\frac{\\partial}{\\partial z}\\left( a\\, c \\right) = D\\, \\frac{\\partial^2 c}{\\partial z^2} + S(z,t)\n$$\n在这里，$D$ 是标量扩散率，$S(z,t)$ 是一个源项，$a$ 是对流速度。速度 $a$ 源于多孔固体内熔体流动的达西定律。给定一个恒定的熔体分数 $\\phi$，对流速度为 $a = \\phi w$，其中 $w$ 是熔体通量。熔体通量由以下公式给出：\n$$\nw(z) = -\\frac{K}{\\mu}\\left(\\frac{d p}{d z} - \\Delta \\rho g\\right)\n$$\n其中 $K$ 是渗透率，$\\mu$ 是熔体粘度，$\\Delta \\rho g$ 是浮力项，压力梯度被规定为一个常数，$\\frac{d p}{d z} = f$。由于所有参数（$K$、$\\mu$、$f$、$\\Delta \\rho g$、$\\phi$）都是常数，对流速度 $a$ 在空间和时间上都是恒定的。输运方程简化为：\n$$\n\\frac{\\partial c}{\\partial t} + a \\frac{\\partial c}{\\partial z} = D\\, \\frac{\\partial^2 c}{\\partial z^2} + S(z,t)\n$$\n该问题受齐次狄利克雷边界条件 $c(0,t)=0$ 和 $c(1,t)=0$ 的约束。\n\n为了验证数值实现，使用了一个人工解：\n$$\nc_{\\text{exact}}(z,t) = \\sin(2\\pi z)\\, e^{-\\lambda t}\n$$\n源项 $S(z,t)$ 是通过将 $c_{\\text{exact}}$ 代入控制方程得到的：\n$$\nS(z,t) = \\frac{\\partial c_{\\text{exact}}}{\\partial t} + a \\frac{\\partial c_{\\text{exact}}}{\\partial z} - D\\, \\frac{\\partial^2 c_{\\text{exact}}}{\\partial z^2}\n$$\n代入 $c_{\\text{exact}}$ 的偏导数可得：\n$$\nS(z,t) = e^{-\\lambda t} \\left[ \\left( D(2\\pi)^2 - \\lambda \\right) \\sin(2\\pi z) + 2\\pi a \\cos(2\\pi z) \\right]\n$$\n初始条件为 $c(z,0) = c_{\\text{exact}}(z,0) = \\sin(2\\pi z)$。\n\n**2. 数值离散化**\n\n空间域用 $N$ 个均匀间隔的网格点 $z_i = i \\Delta z$（$i=0, \\dots, N-1$）进行离散，网格间距为 $\\Delta z = 1/(N-1)$。时间以大小为 $\\Delta t$ 的离散步长推进，其中 $t^n = n \\Delta t$。在网格点 $z_i$ 和时间 $t^n$ 的浓度记为 $c_i^n$。\n\n采用了一种半隐式有限差分格式。扩散项被隐式处理（使用时间层 $n+1$ 的值），这为该项提供了无条件稳定性。对流项和源项被显式处理（使用时间层 $n$ 的值）。在内部网格点 $i \\in \\{1, \\dots, N-2\\}$ 处的离散方程为：\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} + \\mathcal{A}_i(c^n) = D\\, \\mathcal{L}_i(c^{n+1}) + S(z_i, t^n)\n$$\n其中 $\\mathcal{L}_i$ 是拉普拉斯算子的标准二阶中心差分近似：\n$$\n\\mathcal{L}_i(c) = \\frac{c_{i-1} - 2 c_i + c_{i+1}}{\\Delta z^2}\n$$\n而 $\\mathcal{A}_i$ 是对流项 $a \\frac{\\partial c}{\\partial z}$ 的一阶迎风近似：\n$$\n\\mathcal{A}_i(c) =\n\\begin{cases}\na\\, \\dfrac{c_i - c_{i-1}}{\\Delta z}, & \\text{if } a \\ge 0 \\\\\na\\, \\dfrac{c_{i+1} - c_i}{\\Delta z}, & \\text{if } a < 0\n\\end{cases}\n$$\n\n**3. 线性系统与算法**\n\n为了求解未知浓度 $c^{n+1}$，我们重新排列离散方程，将时间层 $n+1$ 的项组合在左侧，时间层 $n$ 的项组合在右侧：\n$$\nc_i^{n+1} - \\Delta t D \\, \\mathcal{L}_i(c^{n+1}) = c_i^n - \\Delta t \\mathcal{A}_i(c^n) + \\Delta t S(z_i, t^n)\n$$\n代入 $\\mathcal{L}_i(c^{n+1})$ 的表达式并定义扩散数 $r = \\frac{D \\Delta t}{\\Delta z^2}$，我们得到一个关于内部节点的线性方程组：\n$$\n-r c_{i-1}^{n+1} + (1+2r) c_i^{n+1} - r c_{i+1}^{n+1} = c_i^n - \\Delta t \\mathcal{A}_i(c^n) + \\Delta t S(z_i, t^n)\n$$\n边界条件为 $c_0^{n+1}=0$ 和 $c_{N-1}^{n+1}=0$。这些条件被并入第一个（$i=1$）和最后一个（$i=N-2$）内部节点的方程中，从而形成一个包含 $N-2$ 个方程的三对角系统，用于求解 $N-2$ 个未知的内部值 $c_1^{n+1}, \\dots, c_{N-2}^{n+1}$。该系统可以写成矩阵形式 $M \\mathbf{c}_{\\text{int}}^{n+1} = \\mathbf{b}^n$，其中 $\\mathbf{c}_{\\text{int}}^{n+1}$ 是内部未知数向量，$\\mathbf{b}^n$ 是根据时间 $t^n$ 的已知值计算出的右端向量，$M$ 是一个对称三对角矩阵，其对角线元素为 $(1+2r)$，非对角线元素为 $-r$。\n\n计算算法如下：\n1. **初始化**：对于给定的测试用例，定义所有参数（$N, \\Delta t, T, D, K, \\mu, \\phi, \\Delta \\rho g, f, \\lambda$）。计算派生常数：$\\Delta z$、对流速度 $a$ 和扩散数 $r$。建立网格 $z$ 和初始浓度分布 $c^0_i = \\sin(2\\pi z_i)$。构造三对角矩阵 $M$ 的带状表示。\n2. **时间推进**：循环所需的步数，$n_{\\text{steps}} = \\text{round}(T/\\Delta t)$。在每一步 $n$ 中：\n    a. 计算当前时间 $t^n = n \\Delta t$。\n    b. 使用 $c^n$ 的值、迎风对流算子 $\\mathcal{A}(c^n)$ 和源项 $S(z, t^n)$，为所有内部节点构造右端向量 $\\mathbf{b}^n$。\n    c. 求解三对角线性系统 $M \\mathbf{c}_{\\text{int}}^{n+1} = \\mathbf{b}^n$，以找到下一时间步浓度的内部值。使用专用的带状矩阵求解器可以高效地完成此任务。\n    d. 使用新的内部值更新完整的浓度向量 $c^{n+1}$，同时保持边界值为 $0$。\n3. **误差计算**：在最后一个时间步之后，计算最终时间 $T$ 的精确解 $c_{\\text{exact}}(z, T)$。然后将误差计算为所有网格点上数值解与精确解之间的最大绝对差：$E = \\max_{i} |c_i^{n_{\\text{steps}}} - c_{\\text{exact}}(z_i, T)|$。\n\n对所提供的四个测试用例中的每一个重复此过程。",
            "answer": "[3.5186419790407135e-05,3.865376045842857e-05,0.0033100650993077755,1.3411440620857366e-05]"
        }
    ]
}