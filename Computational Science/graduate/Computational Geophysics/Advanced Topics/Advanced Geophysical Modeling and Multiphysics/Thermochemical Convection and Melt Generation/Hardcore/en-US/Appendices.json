{
    "hands_on_practices": [
        {
            "introduction": "A fundamental process in understanding melt generation is quantifying how quickly molten rock can separate from its solid matrix. This practice provides a hands-on calculation of the melt segregation velocity based on Darcy's Law, which describes fluid flow through a porous medium. By deriving and applying the formula for buoyancy-driven flow, you will explore the critical role that rock porosity plays in controlling the efficiency of melt extraction from the mantle .",
            "id": "3617298",
            "problem": "Consider one-dimensional, steady, vertical flow of silicate melt through a partially molten, permeable mantle matrix under gravity, with upward positive. Treat the two-phase aggregate as a porous medium and use the following physical picture: at the continuum scale, the melt phase experiences a balance between pressure-gradient forces, buoyancy, and a viscous drag proportional to the relative velocity between melt and solid, consistent with Stokes flow in pores. Adopt Newtonian rheology for the melt and neglect inertial effects. Assume the solid matrix is nearly hydrostatic so that, locally, the melt pressure gradient is close to that of the solid lithostatic pressure. Define the segregation velocity as the Darcy flux of melt relative to the solid matrix, denoted by $w_{\\mathrm{seg}}$, which has units of velocity.\n\nStarting from the force balance for flow through a porous medium and the definition of permeability, derive an expression for $w_{\\mathrm{seg}}$ in terms of the permeability $k$, the melt viscosity $\\mu_{\\ell}$, the density difference $\\Delta \\rho$ between solid and melt (take $\\Delta \\rho0$ if the solid is denser than the melt), and gravity $g$. Then, for a porosity-dependent permeability $k(\\phi)=k_{0}\\,\\phi^{n}$ with $k_{0}=1.0\\times 10^{-8}\\ \\mathrm{m}^{2}$ and $n=3$, melt viscosity $\\mu_{\\ell}=10\\ \\mathrm{Pa\\cdot s}$, density difference $\\Delta \\rho=300\\ \\mathrm{kg\\ m^{-3}}$, and gravitational acceleration $g=9.81\\ \\mathrm{m\\ s^{-2}}$, compute the segregation velocity at $\\phi=0.01$ and $\\phi=0.05$.\n\nExpress both results in $\\mathrm{m\\ s^{-1}}$ and round to three significant figures. Report the two values in a single row matrix in the order $\\phi=0.01$, $\\phi=0.05$.",
            "solution": "The problem requires the derivation of the melt segregation velocity, $w_{\\mathrm{seg}}$, and its numerical calculation for two given porosities. The physical system is a one-dimensional, steady, vertical flow of melt through a solid matrix, treated as a porous medium.\n\nThe starting point is the force balance for the melt phase. The problem states this balance involves pressure-gradient forces, buoyancy, and viscous drag. This balance is encapsulated by the generalized form of Darcy's Law, which relates the Darcy flux to the gradient of the fluid potential. The Darcy flux of the melt relative to the solid matrix is defined as the segregation velocity, $w_{\\mathrm{seg}}$. Let the vertical coordinate be $z$, with the upward direction being positive. The gravitational acceleration vector is thus $\\mathbf{g} = -g \\hat{z}$, where $g$ is the magnitude of gravitational acceleration.\n\nDarcy's Law in one dimension for the vertical segregation velocity $w_{\\mathrm{seg}}$ is given by:\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( \\frac{dP_{\\ell}}{dz} - \\rho_{\\ell} (-g) \\right)\n$$\nwhere $k$ is the permeability of the medium, $\\mu_{\\ell}$ is the dynamic viscosity of the melt, $P_{\\ell}$ is the melt pressure, and $\\rho_{\\ell}$ is the melt density. This equation can be rewritten as:\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( \\frac{dP_{\\ell}}{dz} + \\rho_{\\ell} g \\right)\n$$\nThe term in the parentheses represents the driving force for melt flow. It is the deviation of the melt pressure gradient from the hydrostatic gradient of the melt itself.\n\nA critical piece of information provided is the assumption that the solid matrix is nearly hydrostatic and \"locally, the melt pressure gradient is close to that of the solid lithostatic pressure.\" The lithostatic pressure gradient due to the solid phase of density $\\rho_s$ is given by $\\frac{dP_s}{dz} = -\\rho_s g$. Applying the problem's assumption, we approximate the melt pressure gradient as:\n$$\n\\frac{dP_{\\ell}}{dz} \\approx \\frac{dP_s}{dz} = -\\rho_s g\n$$\nThis is a standard simplification in models of melt migration, positing that the stiff solid matrix supports the overburden, and the pressure gradient is thus dictated by the solid's density.\n\nSubstituting this approximation into the equation for $w_{\\mathrm{seg}}$:\n$$\nw_{\\mathrm{seg}} = -\\frac{k}{\\mu_{\\ell}} \\left( (-\\rho_s g) + \\rho_{\\ell} g \\right)\n$$\n$$\nw_{\\mathrm{seg}} = -\\frac{k g}{\\mu_{\\ell}} (\\rho_{\\ell} - \\rho_s)\n$$\nBy factoring out $-1$, we obtain:\n$$\nw_{\\mathrm{seg}} = \\frac{k g}{\\mu_{\\ell}} (\\rho_s - \\rho_{\\ell})\n$$\nThe problem defines the density difference as $\\Delta \\rho = \\rho_s - \\rho_{\\ell}$, where $\\Delta \\rho  0$ since the solid is denser than the melt. The final symbolic expression for the segregation velocity is therefore:\n$$\nw_{\\mathrm{seg}} = \\frac{k \\Delta \\rho g}{\\mu_{\\ell}}\n$$\nThis completes the first part of the problem. A positive value for $w_{\\mathrm{seg}}$ indicates upward flow, which is physically consistent with a less dense melt percolating through a denser solid matrix under gravity.\n\nFor the second part, we must calculate $w_{\\mathrm{seg}}$ for specific parameter values. The permeability $k$ is given as a function of porosity $\\phi$:\n$$\nk(\\phi) = k_0 \\phi^n\n$$\nSubstituting this into our expression for $w_{\\mathrm{seg}}$ yields:\n$$\nw_{\\mathrm{seg}}(\\phi) = \\frac{k_0 \\phi^n \\Delta \\rho g}{\\mu_{\\ell}}\n$$\nThe provided parameter values are:\n- $k_0 = 1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}$\n- $n = 3$\n- $\\mu_{\\ell} = 10\\ \\mathrm{Pa\\cdot s}$\n- $\\Delta \\rho = 300\\ \\mathrm{kg\\ m^{-3}}$\n- $g = 9.81\\ \\mathrm{m\\ s^{-2}}$\n\nWe now compute $w_{\\mathrm{seg}}$ for the two specified porosities, $\\phi=0.01$ and $\\phi=0.05$.\n\nCase 1: Porosity $\\phi = 0.01$\nFirst, calculate the permeability:\n$$\nk(0.01) = (1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}) \\times (0.01)^3 = (1.0 \\times 10^{-8}) \\times (10^{-2})^3 = 1.0 \\times 10^{-14}\\ \\mathrm{m}^{2}\n$$\nNow, calculate the segregation velocity:\n$$\nw_{\\mathrm{seg}}(0.01) = \\frac{(1.0 \\times 10^{-14}\\ \\mathrm{m}^{2}) \\times (300\\ \\mathrm{kg\\ m^{-3}}) \\times (9.81\\ \\mathrm{m\\ s^{-2}})}{10\\ \\mathrm{Pa\\cdot s}}\n$$\n$$\nw_{\\mathrm{seg}}(0.01) = \\frac{2.943 \\times 10^{-11}}{10}\\ \\mathrm{m\\ s^{-1}} = 2.943 \\times 10^{-12}\\ \\mathrm{m\\ s^{-1}}\n$$\nRounding to three significant figures, we get $w_{\\mathrm{seg}}(0.01) = 2.94 \\times 10^{-12}\\ \\mathrm{m\\ s^{-1}}$.\n\nCase 2: Porosity $\\phi = 0.05$\nFirst, calculate the permeability:\n$$\nk(0.05) = (1.0 \\times 10^{-8}\\ \\mathrm{m}^{2}) \\times (0.05)^3 = (1.0 \\times 10^{-8}) \\times (1.25 \\times 10^{-4}) = 1.25 \\times 10^{-12}\\ \\mathrm{m}^{2}\n$$\nNow, calculate the segregation velocity:\n$$\nw_{\\mathrm{seg}}(0.05) = \\frac{(1.25 \\times 10^{-12}\\ \\mathrm{m}^{2}) \\times (300\\ \\mathrm{kg\\ m^{-3}}) \\times (9.81\\ \\mathrm{m\\ s^{-2}})}{10\\ \\mathrm{Pa\\cdot s}}\n$$\n$$\nw_{\\mathrm{seg}}(0.05) = \\frac{3.67875 \\times 10^{-9}}{10}\\ \\mathrm{m\\ s^{-1}} = 3.67875 \\times 10^{-10}\\ \\mathrm{m\\ s^{-1}}\n$$\nRounding to three significant figures, we get $w_{\\mathrm{seg}}(0.05) = 3.68 \\times 10^{-10}\\ \\mathrm{m\\ s^{-1}}$.\n\nThe two computed segregation velocities are $2.94 \\times 10^{-12}\\ \\mathrm{m\\ s^{-1}}$ for $\\phi=0.01$ and $3.68 \\times 10^{-10}\\ \\mathrm{m\\ s^{-1}}$ for $\\phi=0.05$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.94 \\times 10^{-12}  3.68 \\times 10^{-10}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In a dynamic mantle, melt segregation does not happen in isolation; it competes with large-scale solid convection. This exercise introduces the powerful method of scaling analysis to compare the characteristic timescale of melt migration against that of convective turnover. By deriving a dimensionless ratio, you will gain physical intuition into whether melt is likely to escape to the surface or be entrained and stirred back into the mantle, a key factor in the chemical evolution of Earth .",
            "id": "3617358",
            "problem": "Consider a thermochemically buoyant, partially molten upper-mantle column of thickness $d$ undergoing isoviscous, infinite-Prandtl-number convection and simultaneous melt segregation. Assume a bottom-to-top temperature contrast $\\Delta T$ produces a buoyancy force in the solid that is balanced by viscous resistance, and that melt migrates vertically under a buoyancy contrast $\\Delta \\rho$ between melt and solid through a permeable matrix described by a porosity-dependent permeability. Use the following foundational laws and definitions as starting points:\n\n- The steady Stokes momentum balance for incompressible, creeping flow with thermal buoyancy: $-\\nabla p + \\mu \\nabla^{2} \\mathbf{u} + \\rho \\alpha g \\Delta T \\,\\hat{\\mathbf{z}} = \\mathbf{0}$.\n- Darcy’s law for melt relative flux through a porous solid matrix: $\\mathbf{q} = -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(\\nabla p - \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right)$.\n- The porosity-permeability relation: $k(\\phi) = k_{0}\\,\\phi^{n}$.\n\nHere, $\\rho$ is the solid density, $\\alpha$ is the thermal expansivity, $g$ is gravitational acceleration, $\\mu$ is the solid viscosity, $\\mu_{m}$ is the melt viscosity, and $\\phi$ is the local porosity. Treat the convective solid velocity scale $U$ by balancing thermal buoyancy with viscous resistance on the scale $d$, and treat the melt segregation speed scale $w$ by buoyancy-driven Darcy flow in the vertical direction, neglecting dynamic pressure gradients from solid flow and assuming constant properties. Define the convective turnover time $\\tau_{\\mathrm{conv}} = d/U$ and the melt segregation time $\\tau_{\\mathrm{melt}} = d/w$.\n\nDerive, from these bases, a scaling expression for the dimensionless ratio $S = \\tau_{\\mathrm{melt}}/\\tau_{\\mathrm{conv}}$ in terms of the given parameters, and then evaluate $S$ numerically for the following parameter set, representative of an upper-mantle melting column:\n\n- Column thickness $d = 50\\,\\mathrm{km}$,\n- Solid density $\\rho = 3300\\,\\mathrm{kg\\,m^{-3}}$,\n- Thermal expansivity $\\alpha = 3.0 \\times 10^{-5}\\,\\mathrm{K^{-1}}$,\n- Temperature contrast $\\Delta T = 500\\,\\mathrm{K}$,\n- Gravitational acceleration $g = 9.81\\,\\mathrm{m\\,s^{-2}}$,\n- Solid viscosity $\\mu = 1.0 \\times 10^{21}\\,\\mathrm{Pa\\,s}$,\n- Melt viscosity $\\mu_{m} = 10\\,\\mathrm{Pa\\,s}$,\n- Density contrast $\\Delta \\rho = 500\\,\\mathrm{kg\\,m^{-3}}$,\n- Permeability prefactor $k_{0} = 1.0 \\times 10^{-10}\\,\\mathrm{m^{2}}$,\n- Porosity $\\phi = 0.05$,\n- Permeability exponent $n = 3$.\n\nExpress the final answer as a single dimensionless number. Round your answer to four significant figures. No unit should appear in the final answer.",
            "solution": "The objective is to derive a scaling expression for the dimensionless ratio $S = \\tau_{\\mathrm{melt}}/\\tau_{\\mathrm{conv}}$, where $\\tau_{\\mathrm{melt}}$ is the melt segregation time and $\\tau_{\\mathrm{conv}}$ is the convective turnover time.\n\nFirst, we determine the characteristic velocity scale of the solid mantle convection, $U$. The problem specifies that this scale is found by balancing the thermal buoyancy force with the viscous resistance force over the length scale of the column, $d$. The governing equation for the solid flow is the steady Stokes momentum balance:\n$$-\\nabla p + \\mu \\nabla^{2} \\mathbf{u} + \\rho \\alpha g \\Delta T \\,\\hat{\\mathbf{z}} = \\mathbf{0}$$\nIn this equation, the thermal buoyancy force per unit volume has a magnitude of $\\rho \\alpha g \\Delta T$. The viscous resistance force per unit volume is represented by the term $\\mu \\nabla^{2} \\mathbf{u}$. For a characteristic velocity scale $U$ and length scale $d$, the viscous term scales as:\n$$|\\mu \\nabla^2 \\mathbf{u}| \\sim \\mu \\frac{U}{d^2}$$\nBalancing the magnitudes of the buoyancy and viscous terms yields:\n$$\\mu \\frac{U}{d^2} \\sim \\rho \\alpha g \\Delta T$$\nSolving for the convective velocity scale $U$ gives:\n$$U \\sim \\frac{\\rho \\alpha g \\Delta T d^2}{\\mu}$$\n\nNext, we determine the characteristic melt segregation speed, $w$. This speed is derived from Darcy's law for the relative flux of melt, $\\mathbf{q}$, through the permeable solid matrix:\n$$\\mathbf{q} = -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(\\nabla p - \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right)$$\nThe problem instructs us to neglect dynamic pressure gradients, which means we set the $\\nabla p$ term to zero. The flow is then driven purely by the buoyancy of the melt relative to the solid. The melt flux vector becomes:\n$$\\mathbf{q} \\sim -\\dfrac{k(\\phi)}{\\mu_{m}}\\left(- \\Delta \\rho\\, g\\, \\hat{\\mathbf{z}} \\right) = \\frac{k(\\phi) \\Delta \\rho g}{\\mu_{m}} \\hat{\\mathbf{z}}$$\nThe melt segregation speed $w$ is the magnitude of this flux, $w = |\\mathbf{q}|$:\n$$w \\sim \\frac{k(\\phi) \\Delta \\rho g}{\\mu_{m}}$$\nWe are given the porosity-permeability relation $k(\\phi) = k_{0}\\,\\phi^{n}$. Substituting this into the expression for $w$ yields:\n$$w \\sim \\frac{k_{0}\\,\\phi^{n} \\Delta \\rho g}{\\mu_{m}}$$\n\nNow we can define the two timescales. The convective turnover time, $\\tau_{\\mathrm{conv}}$, is the time it takes for the solid to convect across the column of thickness $d$ at speed $U$:\n$$\\tau_{\\mathrm{conv}} = \\frac{d}{U}$$\nThe melt segregation time, $\\tau_{\\mathrm{melt}}$, is the time it takes for the melt to migrate across the column of thickness $d$ at speed $w$:\n$$\\tau_{\\mathrm{melt}} = \\frac{d}{w}$$\nThe dimensionless ratio $S$ is the ratio of these two timescales:\n$$S = \\frac{\\tau_{\\mathrm{melt}}}{\\tau_{\\mathrm{conv}}} = \\frac{d/w}{d/U} = \\frac{U}{w}$$\nSubstituting the derived scaling expressions for $U$ and $w$:\n$$S = \\frac{\\left(\\dfrac{\\rho \\alpha g \\Delta T d^2}{\\mu}\\right)}{\\left(\\dfrac{k_{0}\\,\\phi^{n} \\Delta \\rho g}{\\mu_{m}}\\right)}$$\nSimplifying the expression by cancelling the gravitational acceleration $g$:\n$$S = \\frac{\\rho \\alpha \\Delta T d^2 \\mu_{m}}{\\mu k_{0} \\phi^{n} \\Delta \\rho}$$\nThis is the final symbolic scaling expression for the ratio $S$.\n\nFinally, we evaluate $S$ numerically using the provided parameter values. First, all values are ensured to be in SI units.\n- $d = 50\\,\\mathrm{km} = 5 \\times 10^4\\,\\mathrm{m}$\n- $\\rho = 3300\\,\\mathrm{kg\\,m^{-3}}$\n- $\\alpha = 3.0 \\times 10^{-5}\\,\\mathrm{K^{-1}}$\n- $\\Delta T = 500\\,\\mathrm{K}$\n- $\\mu = 1.0 \\times 10^{21}\\,\\mathrm{Pa\\,s}$\n- $\\mu_{m} = 10\\,\\mathrm{Pa\\,s}$\n- $\\Delta \\rho = 500\\,\\mathrm{kg\\,m^{-3}}$\n- $k_{0} = 1.0 \\times 10^{-10}\\,\\mathrm{m^{2}}$\n- $\\phi = 0.05$\n- $n = 3$\n\nSubstituting these values into the expression for $S$:\n$$S = \\frac{(3300) \\cdot (3.0 \\times 10^{-5}) \\cdot (500) \\cdot (5 \\times 10^4)^2 \\cdot (10)}{(1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-10}) \\cdot (0.05)^3 \\cdot (500)}$$\nLet's evaluate the numerator and denominator separately.\nNumerator:\n$$N = (3300) \\cdot (3.0 \\times 10^{-5}) \\cdot (500) \\cdot (2.5 \\times 10^9) \\cdot (10)$$\n$$N = (3.3 \\times 10^3) \\cdot (3.0 \\times 10^{-5}) \\cdot (5 \\times 10^2) \\cdot (2.5 \\times 10^9) \\cdot (10^1) = 1.2375 \\times 10^{12}$$\nDenominator:\n$$D = (1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-10}) \\cdot (0.05)^3 \\cdot (500)$$\n$$D = (10^{11}) \\cdot (1.25 \\times 10^{-4}) \\cdot (5 \\times 10^2) = 6.25 \\times 10^9$$\nThe ratio $S$ is:\n$$S = \\frac{N}{D} = \\frac{1.2375 \\times 10^{12}}{6.25 \\times 10^9} = 198$$\nThe problem requires the answer to be rounded to four significant figures. Therefore, the result is $198.0$.",
            "answer": "$$\n\\boxed{198.0}\n$$"
        },
        {
            "introduction": "Translating the physics of thermochemical convection into a computer simulation requires careful consideration of numerical methods and their limitations. This exercise delves into the practical challenge of numerical stability for the advection-diffusion-reaction equations that govern the transport of heat and chemical species. By analyzing the stability constraints for different physical processes, you will uncover the concept of stiffness, where the fastest process dictates the maximum allowable time step for the entire simulation, a crucial consideration for designing efficient and accurate numerical models .",
            "id": "3617304",
            "problem": "Consider a one-dimensional vertical column model for thermochemical convection with melt generation in a partially molten mantle. The evolution of scalar fields representing temperature and composition is governed by advection, diffusion, and a linearized kinetic source representing melting/solidification. Additionally, porosity is advected by the melt relative velocity. Assume the following simplified form for a generic scalar field $\\psi(x,t)$ representative of temperature, composition, or porosity evolution:\n$$\n\\frac{\\partial \\psi}{\\partial t} + v \\frac{\\partial \\psi}{\\partial x} = \\kappa \\frac{\\partial^{2} \\psi}{\\partial x^{2}} - \\lambda \\psi,\n$$\nwhere $v$ is the relevant advective speed for the field (either solid velocity for temperature and composition, or melt relative velocity for porosity), $\\kappa$ is the appropriate diffusivity (thermal or chemical), and $\\lambda$ is a linear kinetic rate that arises from linearizing disequilibrium melting and latent-heat coupling about the present state.\n\nSuppose the equation is discretized on a uniform grid with spacing $\\Delta x$, using first-order upwind differencing for advection, centered second differences for diffusion (forward-time, centered-space), and forward Euler in time for all terms. Assume operator splitting is not used; instead, a single explicit time step advances all fields using the most restrictive stable time step.\n\nStarting from the discrete update and using linear Fourier (von Neumann) analysis applied separately to the advection, diffusion, and reaction operators, derive the stability constraints on the time step $\\Delta t$ for each process in terms of $\\Delta x$, $v$, $\\kappa$, and $\\lambda$. Then, using the most restrictive constraints across all fields and processes, compute the single largest stable time step $\\Delta t_{\\max}$ for the following physically plausible parameters:\n- Grid spacing: $\\Delta x = 500$ m.\n- Maximum solid velocity magnitude: $|u_{s}|_{\\max} = 5$ cm/yr.\n- Maximum melt relative velocity magnitude: $|w|_{\\max} = 2$ m/yr.\n- Thermal diffusivity: $\\kappa_{T} = 1.0 \\times 10^{-6}$ m$^{2}$/s.\n- Chemical diffusivity: $\\kappa_{C} = 1.0 \\times 10^{-9}$ m$^{2}$/s.\n- Linear kinetic rate: $\\lambda = 5.0 \\times 10^{-10}$ s$^{-1}$.\n\nAssume that the global advective constraint must use $v_{\\max} = \\max\\{ |u_{s}|_{\\max}, |w|_{\\max} \\}$ and the global diffusive constraint must use the largest diffusivity among the fields updated explicitly. You may take one year as $1$ yr $= 3.1536 \\times 10^{7}$ s. Express the final answer $\\Delta t_{\\max}$ in years and round your answer to three significant figures.",
            "solution": "### Derivation of Stability Constraints\nThe problem requires deriving the stability constraints for each physical process—advection, diffusion, and reaction—separately using von Neumann analysis. Let $\\psi_j^n$ represent the numerical solution at grid point $j$ and time step $n$. We seek the amplification factor $G$ by substituting a single Fourier mode $\\psi_j^n = G^n e^{i k j \\Delta x}$ into the discretized equation for each process, where $k$ is the wavenumber. Stability requires $|G| \\leq 1$.\n\n**1. Advection Stability (First-Order Upwind in Space, Forward Euler in Time)**\nThe pure advection equation is $\\frac{\\partial \\psi}{\\partial t} + v \\frac{\\partial \\psi}{\\partial x} = 0$. Using first-order upwind differencing for $v  0$, the scheme is:\n$$ \\frac{\\psi_j^{n+1} - \\psi_j^n}{\\Delta t} + v \\frac{\\psi_j^n - \\psi_{j-1}^n}{\\Delta x} = 0 $$\nRearranging for $\\psi_j^{n+1}$:\n$$ \\psi_j^{n+1} = \\psi_j^n - \\frac{v \\Delta t}{\\Delta x} (\\psi_j^n - \\psi_{j-1}^n) $$\nLet $C = \\frac{v \\Delta t}{\\Delta x}$ be the Courant number. Substituting the Fourier mode:\n$$ G^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} - C (G^n e^{i k j \\Delta x} - G^n e^{i k (j-1) \\Delta x}) $$\nDividing by $G^n e^{i k j \\Delta x}$:\n$$ G = 1 - C (1 - e^{-i k \\Delta x}) = 1 - C(1 - \\cos(k\\Delta x)) - i C \\sin(k\\Delta x) $$\nThe squared magnitude of the amplification factor is:\n$$ |G|^2 = (1 - C(1-\\cos(k\\Delta x)))^2 + (C\\sin(k\\Delta x))^2 = 1 - 2C(1-C)(1-\\cos(k\\Delta x)) $$\nFor stability, $|G|^2 \\leq 1$, which requires $-2C(1-C)(1-\\cos(k\\Delta x)) \\leq 0$. Since $C0$ and $1-\\cos(k\\Delta x) \\ge 0$, this simplifies to $1-C \\ge 0$, or $C \\leq 1$. For a general velocity $v$, the condition is $\\frac{|v| \\Delta t}{\\Delta x} \\leq 1$.\nThe advection constraint is:\n$$ \\Delta t_{\\text{adv}} \\leq \\frac{\\Delta x}{|v|} $$\n\n**2. Diffusion Stability (Centered Second Difference in Space, Forward Euler in Time)**\nThe pure diffusion equation is $\\frac{\\partial \\psi}{\\partial t} = \\kappa \\frac{\\partial^{2} \\psi}{\\partial x^{2}}$. The FTCS scheme is:\n$$ \\frac{\\psi_j^{n+1} - \\psi_j^n}{\\Delta t} = \\kappa \\frac{\\psi_{j+1}^n - 2\\psi_j^n + \\psi_{j-1}^n}{(\\Delta x)^2} $$\nLet $d = \\frac{\\kappa \\Delta t}{(\\Delta x)^2}$. Substituting the Fourier mode:\n$$ G = 1 + d (e^{i k \\Delta x} - 2 + e^{-i k \\Delta x}) = 1 + 2d(\\cos(k\\Delta x) - 1) = 1 - 4d \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\nFor stability, we require $|G| \\leq 1$. Since $G$ is real, $-1 \\leq G \\leq 1$. The condition $G \\leq 1$ is always satisfied. The condition $G \\geq -1$ requires:\n$$ 1 - 4d \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\geq -1 \\implies 2 \\geq 4d \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\nThis must hold for all $k$. The maximum value of $\\sin^2(\\frac{k\\Delta x}{2})$ is $1$. Thus, we need $2 \\geq 4d$, which implies $d \\leq \\frac{1}{2}$.\nThe diffusion constraint is:\n$$ \\Delta t_{\\text{diff}} \\leq \\frac{(\\Delta x)^2}{2\\kappa} $$\n\n**3. Reaction Stability (Forward Euler in Time)**\nThe pure reaction equation is $\\frac{\\partial \\psi}{\\partial t} = -\\lambda \\psi$. The Forward Euler scheme is:\n$$ \\frac{\\psi_j^{n+1} - \\psi_j^n}{\\Delta t} = -\\lambda \\psi_j^n $$\n$$ \\psi_j^{n+1} = (1 - \\lambda \\Delta t) \\psi_j^n $$\nThe amplification factor is $G = 1 - \\lambda \\Delta t$. For stability, $|G| \\leq 1$. Since $\\lambda  0$ and $\\Delta t  0$, $G \\leq 1$ is always true. The condition $-1 \\leq G$ gives:\n$$ -1 \\leq 1 - \\lambda \\Delta t \\implies \\lambda \\Delta t \\leq 2 $$\nThe reaction constraint is:\n$$ \\Delta t_{\\text{reac}} \\leq \\frac{2}{\\lambda} $$\n\n### Calculation of the Maximum Stable Time Step\nWe now calculate the numerical value of each constraint using the provided parameters and rules. First, all parameters are converted to consistent SI units (m, s).\n\n**Parameters in SI units:**\n- $\\Delta x = 500$ m\n- $|u_{s}|_{\\max} = 5 \\, \\frac{\\text{cm}}{\\text{yr}} = 5 \\times \\frac{10^{-2} \\, \\text{m}}{3.1536 \\times 10^7 \\, \\text{s}} \\approx 1.5855 \\times 10^{-9}$ m/s\n- $|w|_{\\max} = 2 \\, \\frac{\\text{m}}{\\text{yr}} = \\frac{2 \\, \\text{m}}{3.1536 \\times 10^7 \\, \\text{s}} \\approx 6.3421 \\times 10^{-8}$ m/s\n- $v_{\\max} = \\max\\{|u_{s}|_{\\max}, |w|_{\\max}\\} = |w|_{\\max} \\approx 6.3421 \\times 10^{-8}$ m/s\n- $\\kappa_{\\max} = \\max\\{\\kappa_T, \\kappa_C\\} = \\max\\{1.0 \\times 10^{-6}, 1.0 \\times 10^{-9}\\} = 1.0 \\times 10^{-6}$ m$^2$/s\n- $\\lambda = 5.0 \\times 10^{-10}$ s$^{-1}$\n\n**Calculate individual time step limits:**\n- **Advection Limit:**\n$$ \\Delta t_{\\text{adv}} = \\frac{\\Delta x}{v_{\\max}} = \\frac{500 \\, \\text{m}}{2 \\, \\text{m/yr}} = 250 \\, \\text{yr} $$\nIn seconds: $\\Delta t_{\\text{adv}} = 250 \\times (3.1536 \\times 10^7 \\, \\text{s}) = 7.884 \\times 10^9$ s.\n\n- **Diffusion Limit:**\n$$ \\Delta t_{\\text{diff}} = \\frac{(\\Delta x)^2}{2\\kappa_{\\max}} = \\frac{(500 \\, \\text{m})^2}{2 \\times (1.0 \\times 10^{-6} \\, \\text{m}^2/\\text{s})} = \\frac{2.5 \\times 10^5 \\, \\text{m}^2}{2.0 \\times 10^{-6} \\, \\text{m}^2/\\text{s}} = 1.25 \\times 10^{11} \\, \\text{s} $$\n\n- **Reaction Limit:**\n$$ \\Delta t_{\\text{reac}} = \\frac{2}{\\lambda} = \\frac{2}{5.0 \\times 10^{-10} \\, \\text{s}^{-1}} = 4.0 \\times 10^9 \\, \\text{s} $$\n\n**Determine the Most Restrictive Constraint:**\nThe overall maximum stable time step $\\Delta t_{\\max}$ is the minimum of the individual limits.\n$$ \\Delta t_{\\max} = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}}, \\Delta t_{\\text{reac}}) $$\n$$ \\Delta t_{\\max} = \\min(7.884 \\times 10^9 \\, \\text{s}, 1.25 \\times 10^{11} \\, \\text{s}, 4.0 \\times 10^9 \\, \\text{s}) $$\nThe most restrictive limit is from the reaction term:\n$$ \\Delta t_{\\max} = 4.0 \\times 10^9 \\, \\text{s} $$\n\n**Final Conversion and Rounding:**\nThe problem requires the answer in years, rounded to three significant figures.\n$$ \\Delta t_{\\max} (\\text{yr}) = \\frac{4.0 \\times 10^9 \\, \\text{s}}{3.1536 \\times 10^7 \\, \\text{s/yr}} \\approx 126.8404 \\, \\text{yr} $$\nRounding to three significant figures gives $127$ yr.",
            "answer": "$$\n\\boxed{127}\n$$"
        }
    ]
}