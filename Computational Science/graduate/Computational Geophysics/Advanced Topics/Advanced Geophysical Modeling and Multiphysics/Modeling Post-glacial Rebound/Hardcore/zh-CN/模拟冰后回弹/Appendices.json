{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个练习将我们带回到冰后回弹的基础物理学。我们将把麦克斯韦粘弹性模型应用于一个简化的情景——一个由半空间表示的地球——来计算负载突然变化后的随时间变化的垂直位移。这个练习有助于建立对指数松弛过程以及麦克斯韦时间常数 $ \\tau = \\eta / \\mu $ 关键作用的直观理解 。",
            "id": "3610916",
            "problem": "考虑冰后回弹问题，该过程被建模为代表地球上地幔的 Maxwell 粘弹性半空间对 $t=0$ 时刻表面载荷瞬时变化的准静态垂直响应。假设地幔表现为剪切粘度为 $\\eta$、剪切模量为 $\\mu$ 的线性 Maxwell 固体，并忽略惯性项，因此平衡状态由力平衡和相容性条件决定。冰载荷的移除或施加可以理想化为表面压力 $p_{0}$ 的一个均匀阶跃变化，这会导致一个由均衡平衡决定的有限平衡垂直位移 $w_{\\infty}$。对于平衡态附近的小扰动，线性粘弹性对应原理表明，与平衡态的标量失配会以特征 Maxwell 时间 $\\tau$ 呈指数形式弛豫，而 $\\tau$ 仅取决于地幔的流变性质。\n\n从 (i) 准静态线性动量平衡，(ii) 表面的线性应变相容性，以及 (iii) 关联偏应力和应变率的 Maxwell 本构律出发，推导控制 $t=0$ 时载荷发生阶跃变化后表面垂直位移 $w(t)$ 的标量初值问题，并求出位移历史 $w(t)$ 作为 $t$、$\\eta$、$\\mu$ 和 $w_{\\infty}$ 的函数。然后，使用参数 $\\eta = 1 \\times 10^{21} \\,\\mathrm{Pa\\,s}$、$\\mu = 7 \\times 10^{10} \\,\\mathrm{Pa}$、$w_{\\infty} = 10 \\,\\mathrm{m}$ 和 $t = 3000 \\,\\mathrm{yr}$，数值计算位移 $w(t)$。时间单位使用国际单位制（$\\mathrm{s}$），并将最终数值答案四舍五入至四位有效数字。最终位移以米为单位表示。",
            "solution": "目标是求出 $t=0$ 时刻，在一个受到表面压力 $p_{0}$ 瞬时阶跃变化的 Maxwell 粘弹性半空间表面上的垂直位移历史 $w(t)$。我们利用适用于准静态粘弹性变形的基本原理来建立这个问题。\n\n首先，我们回顾在忽略惯性项情况下的准静态线性动量平衡方程，\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{g} = \\boldsymbol{0},\n$$\n其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\rho$ 是密度，$\\boldsymbol{g}$ 是重力加速度。在自由表面，施加的表面压力 $p_{0}$ 的阶跃变化会瞬时改变边界牵引力。施加载荷后，表面的垂直位移 $w(t)$ 随着地幔的粘弹性松弛而演化，趋向于一个均衡平衡位移 $w_{\\infty}$。在该平衡位移下，净浮力恢复力与所施加的表面载荷变化完全平衡。\n\n为模拟粘弹性响应，我们采用针对偏应力和应变的 Maxwell 本构律。对于适用于单一弛豫模式的一维标量形式，偏应力 $\\sigma$ 和应变 $\\epsilon$ 之间的 Maxwell 关系可以写作：\n$$\n\\dot{\\epsilon} = \\frac{\\dot{\\sigma}}{\\mu} + \\frac{\\sigma}{\\eta},\n$$\n其中 $\\mu$ 是弹性剪切模量，$\\eta$ 是剪切粘度，上方的点表示对时间的导数。这等价于一个 Maxwell 元件（弹簧和阻尼器串联）在给定变形下应力弛豫的标准形式。\n\n表面的垂直位移 $w(t)$ 源于地幔中的弹性剪切变形和粘性流动的共同作用。对于在平衡点附近线性化的均匀轴对称响应，我们可以将瞬时位移与其平衡对应量之间的标量失配写为\n$$\n\\delta w(t) \\equiv w_{\\infty} - w(t).\n$$\n由于 $w_{\\infty}$ 是通过均衡恢复力来平衡阶跃载荷 $p_{0}$ 的静态位移，$\\delta w$ 与尚待弛豫的偏应力成正比。在一个线性弹簧表示中，我们写作\n$$\n\\sigma(t) = k \\,\\delta w(t),\n$$\n其中 $k$ 是一个有效标量刚度，概括了半空间中的几何和弹性耦合。表面的应变率与位移的变化率成正比，即 $\\dot{\\epsilon} \\propto \\dot{w}$。在线性化的单模近似下，我们将几何因子吸收到 $k$ 中，从而 Maxwell 定律成为关于 $\\delta w(t)$ 的一个标量演化方程。\n\n对 $\\sigma(t) = k \\,\\delta w(t)$ 求导并代入 Maxwell 关系式，得到\n$$\n\\dot{\\epsilon} = \\frac{k \\,\\dot{\\delta w}}{\\mu} + \\frac{k \\,\\delta w}{\\eta}.\n$$\n在表面，相容性条件意味着 $\\dot{\\epsilon} \\propto -\\dot{\\delta w}$，因为增加 $w$ 会减小失配 $\\delta w$。通过线性重缩放将比例常数吸收到 $k$ 中后，该演化过程简化为关于失配的典型一阶弛豫方程：\n$$\n\\dot{\\delta w}(t) = -\\frac{1}{\\tau} \\,\\delta w(t),\n$$\n其中特征 Maxwell 时间为\n$$\n\\tau = \\frac{\\eta}{\\mu}.\n$$\n这个结果也可以通过粘弹性对应原理严格推导得出，方法是将弹性格林函数中的弹性剪切模量替换为 Maxwell 弛豫模量，并取阶跃载荷极限；对于单个 Maxwell 模式，其结果是时间常数为 $\\tau$ 的指数弛豫。\n\n求解初值问题 $\\dot{\\delta w} = -\\delta w/\\tau$，初始条件为 $\\delta w(0) = w_{\\infty} - w(0)$，并认识到在 $t=0^{+}$ 时对阶跃载荷的瞬时弹性响应是有界的，而粘弹性弛豫则驱动 $w$ 趋向 $w_{\\infty}$，我们得到\n$$\n\\delta w(t) = \\delta w(0) \\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right).\n$$\n对于一个典型的阶跃加载（或卸载）实验，若将其归一化使得在 $t=0^{+}$ 时的失配等于 $w_{\\infty}$，则位移历史呈现以下标准形式\n$$\nw(t) = w_{\\infty} \\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right).\n$$\n\n现在我们根据给定参数计算 $w(t)$ 的数值。Maxwell 时间为\n$$\n\\tau = \\frac{\\eta}{\\mu} = \\frac{1 \\times 10^{21} \\,\\mathrm{Pa\\,s}}{7 \\times 10^{10} \\,\\mathrm{Pa}} = \\frac{1}{7} \\times 10^{11} \\,\\mathrm{s} = 1.42857142857 \\times 10^{10} \\,\\mathrm{s}.\n$$\n时间 $t$ 必须转换为秒。一个儒略年等于 $365.25 \\times 24 \\times 3600 = 31{,}557{,}600 \\,\\mathrm{s}$。因此，\n$$\nt = 3000 \\,\\mathrm{yr} = 3000 \\times 31{,}557{,}600 \\,\\mathrm{s} = 9.46728 \\times 10^{10} \\,\\mathrm{s}.\n$$\n计算无量纲比值\n$$\n\\frac{t}{\\tau} = \\frac{9.46728 \\times 10^{10}}{1.42857142857 \\times 10^{10}} \\approx 6.627096.\n$$\n那么\n$$\n\\exp\\!\\left(-\\frac{t}{\\tau}\\right) = \\exp(-6.627096) \\approx 0.001324,\n$$\n因此\n$$\nw(t) = 10 \\,\\mathrm{m} \\times \\left(1 - 0.001324\\right) \\approx 9.98676 \\,\\mathrm{m}.\n$$\n四舍五入到四位有效数字，位移为\n$$\nw(t) \\approx 9.987 \\,\\mathrm{m}.\n$$",
            "answer": "$$\\boxed{9.987}$$"
        },
        {
            "introduction": "在超越简单的半空间模型后，这个实践将解决一个更实际的问题：计算一个随时间变化的冰荷载在球形地球上引起的表面抬升。您将使用预先计算好的格林函数，通过实现数值卷积来模拟对分段冰消历史的响应。这个练习对于理解冰川均衡调整 (GIA) 中的正演模型是如何构建并用于预测大地测量观测至关重要 。",
            "id": "3611010",
            "problem": "您的任务是计算一个球对称、线性、粘弹性地球表面上单个测站因时间相关的表面载荷（由球谐系数表示）而产生的瞬时径向抬升位移。目标是通过将一个与阶数相关的、已制表的载荷格林函数与一个分段常数的冰消历史进行卷积，严格推导并实现对指定观测时间的抬升进行数值计算，然后使用实球谐函数将谐波系数投影到测站位置。所有角度必须以弧度处理。所有最终位移值必须以米表示。\n\n基本出发点。在一个线性时不变物理系统中，对源的因果响应是一个卷积。对于球谐函数的阶 $l$ 和级 $m$，径向位移系数 $u_{lm}(t)$ 通过与 $l$ 阶载荷格林函数 $G_l(t)$ 的因果卷积，响应载荷系数 $\\hat{L}_{lm}(t)$ 的变化：\n$$\nu_{lm}(t) \\;=\\; \\int_{0}^{t} G_l(t - \\tau)\\, d\\hat{L}_{lm}(\\tau).\n$$\n对于分段常数的载荷历史，测度 $d\\hat{L}_{lm}(\\tau)$ 简化为在跳变时刻的一系列阶跃变化之和，因此积分简化为阶跃响应计算的有限和。位于余纬 $\\theta$ 和经度 $\\phi$ 的测站的抬升是通过使用实球谐函数进行球谐合成得到的。我们将注意力限制在级 $m=0$ 的纬向谐波上，此时对测站的位移贡献为\n$$\nu(t,\\theta) \\;=\\; u_{l0}(t)\\, Y_{l0}(\\theta),\n$$\n其中 $Y_{l0}(\\theta)$ 是 $l$ 阶的实纬向球谐函数，定义为\n$$\nY_{l0}(\\theta) \\;=\\; \\sqrt{\\frac{2l+1}{4\\pi}}\\;P_l(\\cos\\theta),\n$$\n并且 $P_l(x)$ 是在 $x=\\cos\\theta$ 处求值的 $l$ 阶勒让德多项式。球谐函数是无量纲的；当 $u_{l0}(t)$ 以米为单位时，抬升 $u(t,\\theta)$ 也以米为单位。\n\n数值计算要求。您必须通过对所有截至观测时间 $T$ 的载荷跳变的贡献求和来计算 $u_{l0}(T)$，每个贡献都由在自每次跳变以来经过的时间处求值的已制表的阶跃响应 $G_l(\\Delta t)$ 加权，然后通过 $Y_{l0}(\\theta)$ 投影到测站上。对于在时间 $t_k$ 发生的大小为 $\\Delta \\hat{L}_{l0}(t_k)$ 的跳变，其在 $T$ 时的贡献是 $\\Delta \\hat{L}_{l0}(t_k)\\,G_l(T - t_k)$。如果 $T - t_k$ 不是一个已制表的时间，您必须在最近的制表时间之间对 $G_l$ 进行线性插值。如果 $T - t_k$ 超出制表范围，您必须使用最后一个制表值。如果 $T - t_k = 0$，则使用第一个制表值。角度必须以弧度处理。最终输出必须是以米为单位的径向抬升，表示为浮点数。\n\n单位与约定。时间必须以千年（kyr）为单位进行 $G_l(t)$ 的制表和插值，角度必须以弧度为单位，位移必须以米为单位。载荷系数变化 $\\Delta \\hat{L}_{l0}(t_k)$ 是无量纲的归一化值。已制表的 $G_l(t)$ 的单位是米/单位归一化载荷变化。\n\n测试套件。为三个独立的测试用例实现计算，这些用例共同探测典型、插值和边界行为。在每个用例中，您必须：\n- 使用指定的函数形式和参数，在从 $t=0$ 到 $t=T$ 的均匀时间网格上（间距为 $\\Delta t_G$），构建已制表的 $G_l(t)$。\n- 在观测时间 $T$ 对跳变贡献求和。\n- 乘以在指定测站余纬处计算的 $Y_{l0}(\\theta)$ 值。\n\n您必须使用以下三个测试用例：\n\n1. 用例 1（常规两步历史，理想情况）：\n   - 阶 $l$：$2$ 和级 $m=0$。\n   - 测站余纬：$45$ 度（转换为弧度）。\n   - 观测时间：$T = 10.0$ kyr。\n   - 载荷跳变：在 $t_0 = 0.0$ kyr 时，$\\Delta \\hat{L}_{20}(t_0) = +1.0$；在 $t_1 = 5.0$ kyr 时，$\\Delta \\hat{L}_{20}(t_1) = -1.0$。\n   - 已制表的阶跃响应 $G_2(t)$ 在 $[0,T]$ 上定义，间距为 $\\Delta t_G = 1.0$ kyr，由下式给出：\n     $$\n     G_2(t) \\;=\\; G_{\\infty} \\;-\\; \\left(G_{\\infty} - G_{0}\\right)\\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n     $$\n     参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.4\\,\\text{m},\\,1.0\\,\\text{m},\\,3.0\\,\\text{kyr})$。\n\n2. 用例 2（带插值的粗略制表，多个负向跳变）：\n   - 阶 $l$：$2$ 和级 $m=0$。\n   - 测站余纬：$60$ 度（转换为弧度）。\n   - 观测时间：$T = 10.0$ kyr。\n   - 载荷跳变：在 $t_0 = 2.0$ kyr 时，$\\Delta \\hat{L}_{20}(t_0) = -0.8$；在 $t_1 = 4.0$ kyr 时，$\\Delta \\hat{L}_{20}(t_1) = -0.2$。\n   - 已制表的阶跃响应 $G_2(t)$ 在 $[0,T]$ 上定义，间距为 $\\Delta t_G = 2.0$ kyr，由下式给出：\n     $$\n     G_2(t) \\;=\\; G_{\\infty} \\;-\\; \\left(G_{\\infty} - G_{0}\\right)\\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n     $$\n     参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.5\\,\\text{m},\\,1.1\\,\\text{m},\\,2.5\\,\\text{kyr})$。\n\n3. 用例 3（观测时间的边界情况，常数响应）：\n   - 阶 $l$：$1$ 和级 $m=0$。\n   - 测站余纬：$30$ 度（转换为弧度）。\n   - 观测时间：$T = 5.0$ kyr。\n   - 载荷跳变：在 $t_0 = 5.0$ kyr 时，$\\Delta \\hat{L}_{10}(t_0) = +0.5$。\n   - 已制表的阶跃响应 $G_1(t)$ 在 $[0,T]$ 上定义，间距为 $\\Delta t_G = 1.0$ kyr，由下式给出：\n     $$\n     G_1(t) \\;=\\; G_{\\infty} \\;-\\; \\left(G_{\\infty} - G_{0}\\right)\\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n     $$\n     参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.7\\,\\text{m},\\,0.7\\,\\text{m},\\,1.0\\,\\text{kyr})$，这将得到对所有 $t$ 恒为 $G_1(t)=0.7$ m 的常数。\n\n输出规范。您的程序应生成单行输出，其中包含三个用例的结果，格式为用方括号括起来的逗号分隔列表，单位为米，每个结果四舍五入到六位小数，顺序为用例 1、用例 2、用例 3。例如：\n\"[result_case1,result_case2,result_case3]\"。",
            "solution": "### 步骤 1：提取已知条件\n\n问题提供了以下数据、定义和关系：\n\n**控制方程：**\n1. 径向位移谐波系数 $u_{lm}(t)$ 由卷积分给出：\n    $$u_{lm}(t) = \\int_{0}^{t} G_l(t - \\tau)\\, d\\hat{L}_{lm}(\\tau)$$\n    其中 $G_l(t)$ 是 $l$ 阶载荷格林函数，$\\hat{L}_{lm}(t)$ 是载荷系数。\n\n2. 对于具有阶跃变化的分段常数载荷历史，积分简化为阶跃响应计算的和。\n\n3. 对于纬向谐波（$m=0$），测站的物理抬升 $u(t,\\theta)$ 由下式给出：\n    $$u(t,\\theta) = u_{l0}(t)\\, Y_{l0}(\\theta)$$\n\n4. 实纬向球谐函数 $Y_{l0}(\\theta)$ 定义为：\n    $$Y_{l0}(\\theta) = \\sqrt{\\frac{2l+1}{4\\pi}}\\;P_l(\\cos\\theta)$$\n    其中 $P_l(x)$ 是 $l$ 阶勒让德多项式。\n\n**数值计算规则：**\n1. 观测时间 $T$ 的谐波系数 $u_{l0}(T)$ 通过对载荷跳变的贡献求和来计算：\n    $$u_{l0}(T) = \\sum_{k} \\Delta \\hat{L}_{l0}(t_k)\\,G_l(T - t_k)$$\n    其中 $\\Delta \\hat{L}_{l0}(t_k)$ 是在时间 $t_k$ 的跳变大小。\n\n2. $G_l(T-t_k)$ 的值必须从格林函数的制表版本中确定。\n    - 如果 $T - t_k$ 不是一个已制表的时间，则在最近的制表时间之间使用线性插值。\n    - 如果 $T - t_k$ 超出制表范围，则使用最后一个制表值。\n    - 如果 $T - t_k = 0$，则使用第一个制表值。\n\n**单位与约定：**\n- 时间（$t$, $T$, $\\tau$, $\\Delta t_G$）：千年 (kyr)。\n- 角度（$\\theta$, $\\phi$）：弧度。\n- 位移（$u$, $G_l$）：米 (m)。\n- 载荷系数变化（$\\Delta \\hat{L}_{l0}$）：无量纲。\n\n**测试用例：**\n**用例 1：**\n- $l=2$, $m=0$。\n- 测站余纬 $\\theta = 45^\\circ$。\n- 观测时间 $T = 10.0$ kyr。\n- 载荷跳变：$\\Delta \\hat{L}_{20}(0.0) = +1.0$；$\\Delta \\hat{L}_{20}(5.0) = -1.0$。\n- 在 $[0, T]$ 上的已制表阶跃响应，$\\Delta t_G = 1.0$ kyr，来自：\n    $$G_2(t) = G_{\\infty} - (G_{\\infty} - G_{0})\\exp(-t/\\tau)$$\n    参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.4\\,\\text{m},\\,1.0\\,\\text{m},\\,3.0\\,\\text{kyr})$。\n\n**用例 2：**\n- $l=2$, $m=0$。\n- 测站余纬 $\\theta = 60^\\circ$。\n- 观测时间 $T = 10.0$ kyr。\n- 载荷跳变：$\\Delta \\hat{L}_{20}(2.0) = -0.8$；$\\Delta \\hat{L}_{20}(4.0) = -0.2$。\n- 在 $[0, T]$ 上的已制表阶跃响应，$\\Delta t_G = 2.0$ kyr，函数形式与用例 1 相同，参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.5\\,\\text{m},\\,1.1\\,\\text{m},\\,2.5\\,\\text{kyr})$。\n\n**用例 3：**\n- $l=1$, $m=0$。\n- 测站余纬 $\\theta = 30^\\circ$。\n- 观测时间 $T = 5.0$ kyr。\n- 载荷跳变：$\\Delta \\hat{L}_{10}(5.0) = +0.5$。\n- 在 $[0, T]$ 上的已制表阶跃响应，$\\Delta t_G = 1.0$ kyr，函数形式与用例 1 相同，参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.7\\,\\text{m},\\,0.7\\,\\text{m},\\,1.0\\,\\text{kyr})$。\n\n**输出规范：**\n- 单行字符串：`\"[result_case1,result_case2,result_case3]\"`。\n- 结果是以米为单位的径向抬升，四舍五入到六位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n根据既定标准对问题进行验证。\n\n-   **科学性**：该问题基于粘弹性体的线性响应理论，这是地球物理学的基石。使用与格林函数的卷积来模拟冰后回弹是一种标准且科学有效的方法。球体上表面载荷和位移的球谐表示是地球物理学的基础。格林函数的函数形式 $G_l(t) = G_{\\infty} - (G_{\\infty} - G_{0})\\exp(-t/\\tau)$ 代表了一个简单的麦克斯韦粘弹性模型，这是一个常见且适当的理想化模型。该问题在科学上是合理的。\n\n-   **适定性**：该问题是适定的。它要求计算一个特定的物理量——径向抬升，并为其提供了所有必要的参数、方程和边界条件。所有三个测试用例都用阶数、时间、载荷大小和材料参数的数值完全指定。数值计算过程，包括插值和外插的规则，都得到了明确的定义。对于每个案例，都可以计算出唯一、稳定且有意义的解。勒让德多项式 $P_l(x)$ 的定义没有明确给出，但它是一个标准的数学函数，这是一个可接受的隐式先决条件。\n\n-   **客观性**：问题以精确、客观和技术性的语言陈述，没有任何主观性、模糊性或基于意见的断言。\n\n-   **完整性与一致性**：问题是自洽的。所有必要的公式和数据都已提供。没有矛盾之处。单位是一致的：格林函数 $G_l(t)$ 的单位是米，载荷变化 $\\Delta \\hat{L}_{l0}$ 是无量纲的，它们的乘积 $u_{l0}(t)$ 的单位是米。球谐函数 $Y_{l0}(\\theta)$ 是无量纲的，因此最终的抬升 $u(t,\\theta)$ 的单位正确地为米。\n\n-   **其他缺陷**：该问题没有表现出任何其他缺陷，例如不切实际、结构不良、过于简单或无法验证。参数在地球物理应用的物理合理范围内。\n\n### 步骤 3：结论与行动\n\n该问题**有效**。它是一个定义明确的计算任务，植根于计算地球物理学的既定原则。我将继续进行求解。\n\n该解决方案要求为每个测试用例实现一个遵循三个主要步骤的计算过程：\n1.  **制表格林函数**：对于给定的阶 $l$、观测时间 $T$ 和网格间距 $\\Delta t_G$，在时间间隔 $[0, T]$ 上构建格林函数 $G_l(t)$ 的值表。该函数由 $G_l(t) = G_{\\infty} - (G_{\\infty} - G_{0})\\exp(-t/\\tau)$ 给出。时间网格将是均匀的，从 $t=0$ 到 $t=T$。\n\n2.  **计算谐波位移系数**：通过对每个指定载荷跳变的贡献求和来计算 $u_{l0}(T)$。对于在时间 $t_k$ 的每个跳变 $\\Delta \\hat{L}_{l0}(t_k)$，通过将跳变大小乘以在经过的时间 $\\Delta t = T - t_k$ 处的格林函数值 $G_l(\\Delta t)$ 来找到其贡献。这个值 $G_l(T - t_k)$ 必须从步骤 1 中生成的表中获得，使用规定的插值（线性）、外插（常数，使用最后一个值）规则以及 $\\Delta t=0$ 的特殊情况（使用第一个值）。\n\n3.  **投影到测站位置**：通过将谐波系数 $u_{l0}(T)$ 乘以实纬向球谐函数 $Y_{l0}(\\theta)$ 来计算最终的径向抬升 $u(T, \\theta)$。这涉及在测站的余纬 $\\theta$（转换为弧度）处评估勒让德多项式 $P_l(\\cos\\theta)$，并应用归一化因子 $\\sqrt{(2l+1)/(4\\pi)}$。\n\n此过程将在一个函数中实现，并应用于指定的三个测试用例。数值结果将按要求格式化。实现的一个关键部分是正确使用标准插值函数，例如 `numpy.interp`，它自然地处理了指定的边界和插值条件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import eval_legendre\n\ndef solve():\n    \"\"\"\n    Solves the post-glacial rebound problem for three test cases\n    and prints the results in the specified format.\n    \"\"\"\n\n    def calculate_uplift(l, theta_deg, T, load_jumps, G_params, dt_G):\n        \"\"\"\n        Computes the instantaneous radial uplift for a single test case.\n\n        Args:\n            l (int): Spherical harmonic degree.\n            theta_deg (float): Station colatitude in degrees.\n            T (float): Observation time in kyr.\n            load_jumps (list): A list of tuples (t_k, delta_L) representing\n                               load jumps at time t_k with magnitude delta_L.\n            G_params (tuple): A tuple (G0, G_inf, tau) for the Green's function.\n            dt_G (float): Time grid spacing for the Green's function table in kyr.\n\n        Returns:\n            float: The calculated radial uplift in meters.\n        \"\"\"\n        G0, G_inf, tau = G_params\n\n        # Convert station colatitude from degrees to radians for calculations.\n        theta_rad = np.deg2rad(theta_deg)\n\n        # Step 1: Build the tabulated Green's function G_l(t).\n        # The grid is uniform from t=0 to t=T. Using np.linspace is robust for\n        # ensuring the endpoint T is included.\n        # The number of points is int(T/dt_G) + 1. round() adds robustness for floating point arithmetic.\n        num_points = int(round(T / dt_G)) + 1\n        t_table = np.linspace(0.0, T, num_points)\n        \n        # Define the analytical Green's function.\n        def G_func(t):\n            # Handle the case where tau is zero, as this would cause a division error.\n            if tau == 0:\n                if t == 0:\n                    return G0\n                else:\n                    return G_inf\n            # The standard exponential relaxation model.\n            return G_inf - (G_inf - G0) * np.exp(-t / tau)\n        \n        G_table = G_func(t_table)\n        \n        # Step 2: Calculate the harmonic displacement coefficient u_l0(T).\n        # This is the sum of contributions from each load jump, convolved with the Green's function.\n        u_l0_T = 0.0\n        for t_k, delta_L in load_jumps:\n            elapsed_time = T - t_k\n            \n            # Interpolate or extrapolate to find G_l(elapsed_time) from the table.\n            # np.interp handles all specified rules:\n            # - Linear interpolation for points within the table range.\n            # - Returns the first value (G_table[0]) for elapsed_time = t_table[0]. \n            #   This covers the case elapsed_time = 0 as per the problem.\n            # - Returns the last value (G_table[-1]) for elapsed_time >= t_table[-1].\n            G_val = np.interp(elapsed_time, t_table, G_table)\n            \n            u_l0_T += delta_L * G_val\n            \n        # Step 3: Project to station location to get final uplift u(T, theta).\n        # Calculate the real zonal spherical harmonic Y_l0(theta).\n        x = np.cos(theta_rad)\n        P_l_x = eval_legendre(l, x)\n        Y_l0 = np.sqrt((2 * l + 1) / (4 * np.pi)) * P_l_x\n        \n        # The final uplift is the product of the harmonic coefficient and the spherical harmonic.\n        uplift = u_l0_T * Y_l0\n        \n        return uplift\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general two-step history, happy path):\n        {\n            'l': 2, 'theta_deg': 45.0, 'T': 10.0,\n            'load_jumps': [(0.0, 1.0), (5.0, -1.0)],\n            'G_params': (0.4, 1.0, 3.0), 'dt_G': 1.0\n        },\n        # Case 2 (coarse tabulation, multiple negative jumps):\n        # Note: The elapsed times (8.0 and 6.0 kyr) fall on the grid points\n        # of the table [0, 2, 4, 6, 8, 10], so no interpolation is triggered.\n        # The code correctly handles this \"on-grid\" scenario.\n        {\n            'l': 2, 'theta_deg': 60.0, 'T': 10.0,\n            'load_jumps': [(2.0, -0.8), (4.0, -0.2)],\n            'G_params': (0.5, 1.1, 2.5), 'dt_G': 2.0\n        },\n        # Case 3 (boundary case at observation time, constant response):\n        # Note: The elapsed time is T - t_k = 5.0 - 5.0 = 0.0.\n        # The rule requires using the first tabulated value, which np.interp does correctly.\n        {\n            'l': 1, 'theta_deg': 30.0, 'T': 5.0,\n            'load_jumps': [(5.0, 0.5)],\n            'G_params': (0.7, 0.7, 1.0), 'dt_G': 1.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_uplift(**case)\n        # Format the result to six decimal places as a string.\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "建模的最终目标通常是从观测数据中推断未知的地球属性。在这个高级实践中，您将开发一个反演算法，使用合成的抬升数据来估计岩石圈的空间变化的弹性厚度。这个练习展示了我们所探讨的正演模型如何被整合到一个正则化反演问题中，这是计算地球物理学核心的一种强大技术 。",
            "id": "3610912",
            "problem": "考虑地球表面的一个球冠区域，该区域由局部球面坐标 $(\\theta,\\phi)$ 表示，并在所关注的尺度上近似为一个平面片块。目标是通过利用冰后隆升残差的观测数据和一个将冰荷载下岩石圈弯曲与粘弹性地幔流耦合的力学模型，来反演岩石圈空间变化的弹性厚度场 $T_e(\\theta,\\phi)$。物理上相关的出发点是横向荷载下的薄板弯曲和地幔的麦克斯韦粘弹性松弛。岩石圈被建模为具有弯曲刚度 $D(\\theta,\\phi)$ 的薄弹性板，地幔被建模为粘度为 $\\eta$、剪切模量为 $\\mu$ 的线性麦克斯韦材料。冰荷载被指定为片块上空间变化的表面压力 $q(\\theta,\\phi)$。\n\n您必须推导、论证并实现一个针对 $T_e(\\theta,\\phi)$ 的双参数、分段常数表示的反演：区域 $\\Omega_A$ 的弹性厚度未知，为 $T_e^A$；区域 $\\Omega_B$ 的弹性厚度未知，为 $T_e^B$。该分区由局部平面近似中的一条垂直子午线定义：左半平面为 $\\Omega_A$，右半平面为 $\\Omega_B$。假设观测到的隆升残差场 $u_{\\mathrm{obs}}(\\theta,\\phi)$ 是在 $t=0$ 时刻瞬时消冰后的单个时间 $t$ 采集的。\n\n从以下有效基础出发：\n- 横向荷载下的薄板弯曲：对于弯曲刚度为 $D$、横向荷载为 $q$ 的板，其控制方程为\n$$\nD \\nabla^4 w = q,\n$$\n其中 $w(\\theta,\\phi)$ 是垂直挠度。对于空间变化的 $D(\\theta,\\phi)$，论证一个合适的近似，该近似将荷载的主导空间波数与挠度振幅联系起来。\n- 麦克斯韦粘弹性地幔响应：对于粘度为 $\\eta$、剪切模量为 $\\mu$ 的麦克斯韦材料，其特征麦克斯韦时间为\n$$\n\\tau = \\frac{\\eta}{\\mu}.\n$$\n在 $t=0$ 时刻阶跃式移除荷载的情况下，到时间 $t$ 为止所实现的弹性恢复分数为\n$$\nf(t) = 1 - e^{-t/\\tau}.\n$$\n\n您的反演必须以纯数学术语进行表述，为两个未知参数 $T_e^A$ 和 $T_e^B$ 生成一个适定系统，并进行正则化以确保稳定性。您必须强制推断出的参数具有物理上的正性。使用岩石圈的弯曲刚度定义，\n$$\nD(\\theta,\\phi) = \\frac{E \\, T_e(\\theta,\\phi)^3}{12 \\left(1-\\nu^2\\right)},\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。清晰地陈述将 $q(\\theta,\\phi)$、$D(\\theta,\\phi)$ 和 $u_{\\mathrm{obs}}(\\theta,\\phi)$ 联系起来所需的任何建模近似。\n\n您必须实现一个完整的程序，该程序根据已知的 $T_e^A$ 和 $T_e^B$ 的真值构建合成观测数据 $u_{\\mathrm{obs}}(\\theta,\\phi)$，添加少量高斯噪声以模拟测量和模型误差，然后执行反演以估计 $T_e^A$ 和 $T_e^B$。在一个局部平面域上使用一个大小为 $N \\times N$（其中 $N = 16$）的方形网格，其笛卡尔坐标为 $(x,y) \\in [-1,1] \\times [-1,1]$，将左半平面 $x  0$ 映射到 $\\Omega_A$，右半平面 $x \\ge 0$ 映射到 $\\Omega_B$。使用一个由中心在原点的高斯压力峰定义的空间变化冰荷载，\n$$\nq(x,y) = p_0 \\exp\\left(-\\frac{x^2 + y^2}{2\\sigma^2}\\right),\n$$\n其中 $p_0$ 和 $\\sigma$ 在下文指定。使用与有效长度尺度 $L$ 相关联的单个主导空间波数 $k_0 = \\frac{2\\pi}{L}$。所有参数必须物理上合理且一致。您的反演必须包含参数为 $\\lambda$ 的吉洪诺夫正则化 (Tikhonov regularization)，并且必须强制模型参数的非负性。您设计的数学反演必须从上述基础推导而来，而非来自预先给定的简化公式。\n\n物理和数值单位：\n- 以 $\\mathrm{km}$ 表示 $T_e$。\n- 以 $\\mathrm{Pa}$ 表示 $q$。\n- 以 $\\mathrm{m}$ 表示 $u_{\\mathrm{obs}}$。\n- 时间 $t$ 在内部以 $\\mathrm{s}$ 表示；测试输入以 $\\mathrm{yr}$ 指定 $t$，其中 $1\\,\\mathrm{yr} = 365.25 \\times 24 \\times 3600\\,\\mathrm{s}$。\n- 在此局部平面近似中不需要角度。\n\n测试套件和参数：\n- 所有测试的通用常数：$N = 16$，$E = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$，$\\nu = 0.25$，$\\mu = 6.7 \\times 10^{10}\\,\\mathrm{Pa}$，$p_0 = 2.0 \\times 10^{7}\\,\\mathrm{Pa}$，$\\sigma = 0.40$（在 $[-1,1]$ 网格上是无量纲的），$\\lambda = 1.0 \\times 10^{-4}$。\n- 测试用例 1 (一般情况)：\n  - 真值：$T_e^A = 40\\,\\mathrm{km}$，$T_e^B = 60\\,\\mathrm{km}$。\n  - 地幔粘度：$\\eta = 1.0 \\times 10^{21}\\,\\mathrm{Pa\\,s}$。\n  - 观测时间：$t = 2000\\,\\mathrm{yr}$。\n  - 有效长度尺度：$L = 200000\\,\\mathrm{m}$。\n  - 添加到 $u_{\\mathrm{obs}}$ 的噪声标准差：$0.002\\,\\mathrm{m}$。\n- 测试用例 2 (边界松弛，厚度相等)：\n  - 真值：$T_e^A = 30\\,\\mathrm{km}$，$T_e^B = 30\\,\\mathrm{km}$。\n  - 地幔粘度：$\\eta = 5.0 \\times 10^{22}\\,\\mathrm{Pa\\,s}$。\n  - 观测时间：$t = 1000\\,\\mathrm{yr}$。\n  - 有效长度尺度：$L = 200000\\,\\mathrm{m}$。\n  - 添加到 $u_{\\mathrm{obs}}$ 的噪声标准差：$0.001\\,\\mathrm{m}$。\n- 测试用例 3 (快速松弛，强对比度)：\n  - 真值：$T_e^A = 35\\,\\mathrm{km}$，$T_e^B = 80\\,\\mathrm{km}$。\n  - 地幔粘度：$\\eta = 5.0 \\times 10^{20}\\,\\mathrm{Pa\\,s}$。\n  - 观测时间：$t = 3000\\,\\mathrm{yr}$。\n  - 有效长度尺度：$L = 250000\\,\\mathrm{m}$。\n  - 添加到 $u_{\\mathrm{obs}}$ 的噪声标准差：$0.003\\,\\mathrm{m}$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。该列表必须按顺序包含测试1的估计值 $[T_e^A(\\mathrm{km}), T_e^B(\\mathrm{km})]$，然后是测试2，然后是测试3，每个值都四舍五入到两位小数，最终形成一个包含6个浮点数的扁平列表，例如 $[t_{1A},t_{1B},t_{2A},t_{2B},t_{3A},t_{3B}]$，其中每个 $t_{ij}$ 均以 $\\mathrm{km}$ 为单位并四舍五入到两位小数。",
            "solution": "用户提供的问题已被分析并被认为是**有效的**。它在科学上基于薄板弯曲和麦克斯韦粘弹性的既定原理，这些是计算地球物理学中用于模拟冰后回弹的标准近似方法。该问题是适定的，提供了所有必要的参数和明确的目标。要求论证关键的建模近似是建模练习的标准部分，而不是一个缺陷。该问题是客观的、定量的且计算上可行的。\n\n在此，我们从指定的第一性原理出发，推导出一个完整的解决方案，并最终形成一个数值反演算法。\n\n**1. 正演模型的推导**\n\n目标是建立一个数学关系，即正演模型，该模型基于给定的弹性厚度场 $T_e(x,y)$ 和其他物理参数来预测观测到的隆升残差 $u_{\\mathrm{obs}}(x,y)$。\n\n岩石圈被建模为一个薄弹性板。其在冰荷载 $q(x,y)$ 下的初始静态挠度 $w(x,y)$ 由板弯曲的双调和方程控制：\n$$\n\\nabla \\cdot \\nabla (D(x,y) \\nabla^2 w(x,y)) - (1-\\nu) \\mathcal{L}(D,w) = q(x,y)\n$$\n其中 $D(x,y)$ 是空间变化的弯曲刚度，$\\mathcal{L}$ 是一个复杂的微分算子。对于一个常数 $D$，该方程简化为 $D \\nabla^4 w = q$。问题陈述给出了这个简化形式作为出发点，并承认 $D$ 是空间变化的。为了使问题易于处理，我们必须按照提示采用一个简化近似。\n\n提示要求为连接荷载主导空间波数与挠度的近似提供理由。一个常见且物理上合理的近似是“局部响应”或“局部岩石圈”近似，特别是当荷载的特征波长小于岩石圈属性变化尺度时。该近似假设点 $(x,y)$ 处的挠度主要由局部弯曲刚度 $D(x,y)$ 决定。在谱域中，这等同于假设挠度的傅里叶分量 $W(\\mathbf{k})$ 通过一个局部的、与位置相关的传递函数与荷载的傅里叶分量 $Q(\\mathbf{k})$ 相关联。对于代表荷载有效尺度的的主导波数 $k_0 = 2\\pi/L$，$\\nabla^4$ 算子可以近似为乘以 $k_0^4$。这产生了一个局部代数关系：\n$$\nD(x,y) k_0^4 w(x,y) \\approx q(x,y)\n$$\n由此，我们可以将初始弹性挠度 $w(x,y)$ 表示为：\n$$\nw(x,y) \\approx \\frac{q(x,y)}{D(x,y) k_0^4}\n$$\n弯曲刚度 $D(x,y)$ 与弹性厚度 $T_e(x,y)$ 的关系如下：\n$$\nD(x,y) = \\frac{E \\, T_e(x,y)^3}{12 \\left(1-\\nu^2\\right)}\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。将此式代入 $w(x,y)$ 的表达式中：\n$$\nw(x,y) \\approx \\frac{q(x,y)}{k_0^4} \\left( \\frac{12(1-\\nu^2)}{E \\, T_e(x,y)^3} \\right)\n$$\n在 $t=0$ 时刻瞬时消冰后，岩石圈因地幔中的粘弹性流而回弹。地幔被建模为麦克斯韦材料，其特征松弛时间为 $\\tau = \\eta/\\mu$，其中 $\\eta$ 是粘度，$\\mu$ 是剪切模量。到时间 $t$ 为止恢复的总初始弹性挠度的分数为 $f(t) = 1 - e^{-t/\\tau}$。观测到的隆升残差 $u(x,y,t)$ 是初始挠度的这一部分：\n$$\nu(x,y,t) = w(x,y) f(t) = w(x,y) \\left(1 - e^{-t/\\tau}\\right)\n$$\n结合这些方程，得到完整的正演模型：\n$$\nu(x,y,t) = \\frac{q(x,y)}{k_0^4} \\left( \\frac{12(1-\\nu^2)}{E} \\right) \\frac{1}{T_e(x,y)^3} \\left(1 - e^{-t/\\tau}\\right)\n$$\n该方程在给定局部荷载、局部弹性厚度和地幔属性的情况下，预测了任意点 $(x,y)$ 和时间 $t$ 的隆升。\n\n**2. 反演问题的表述**\n\n反演问题旨在从带有噪声的隆升观测网格 $\\mathbf{d} = \\{u_{\\mathrm{obs}}(x_i, y_i)\\}$ 中估计两个未知参数 $T_e^A$ 和 $T_e^B$。正演模型相对于 $T_e$ 是非线性的。为了构建一个线性反演问题，我们定义一组新的模型参数：\n$$\nm_A = \\frac{1}{(T_e^A)^3} \\quad \\text{和} \\quad m_B = \\frac{1}{(T_e^B)^3}\n$$\n未知模型参数的向量是 $\\mathbf{m} = [m_A, m_B]^T$。\n\n让我们用这些新参数重写正演模型。在每个观测点 $(x_i, y_i)$，预测的隆升为：\n$$\nu_i = K_i \\cdot m(x_i)\n$$\n其中 $m(x_i)$ 根据区域是 $m_A$ 或 $m_B$，而 $K_i$ 是一个包含所有其他项的已知系数：\n$$\nK_i = \\frac{q(x_i,y_i)}{k_0^4} \\left( \\frac{12(1-\\nu^2)}{E} \\right) \\left(1 - e^{-t/\\tau}\\right)\n$$\n这为 $N^2$ 个观测点定义了一个线性方程组，可以表示为矩阵形式 $\\mathbf{d} = \\mathbf{G}\\mathbf{m}$。\n这里，$\\mathbf{d}$ 是 $N^2 \\times 1$ 的隆升观测向量，$\\mathbf{m}$ 是 $2 \\times 1$ 的未知参数向量 $[m_A, m_B]^T$，$\\mathbf{G}$ 是 $N^2 \\times 2$ 的灵敏度矩阵（或雅可比矩阵）。\n\n$\\mathbf{G}$ 的结构由问题的空间分区决定。设 $I_A$ 为 $x  0$ 的网格索引集， $I_B$ 为 $x \\ge 0$ 的网格索引集。$\\mathbf{G}$ 的第 $i$ 行是：\n- 如果网格点 $i \\in I_A$，则为 $[K_i, 0]$\n- 如果网格点 $i \\in I_B$，则为 $[0, K_i]$\n\n**3. 通过吉洪诺夫正则化 (Tikhonov Regularization) 求解**\n\n为了找到系统 $\\mathbf{d} \\approx \\mathbf{G}\\mathbf{m}$ 的一个稳定解，我们使用吉洪诺夫正则化，它最小化数据失配和模型范数惩罚项的组合。我们寻求最小化目标函数 $\\Phi(\\mathbf{m})$：\n$$\n\\Phi(\\mathbf{m}) = ||\\mathbf{G}\\mathbf{m} - \\mathbf{d}||_2^2 + \\lambda^2 ||\\mathbf{m}||_2^2\n$$\n其中 $\\lambda$ 是问题陈述中给出的正则化参数。最小化 $\\Phi(\\mathbf{m})$ 的解由正规方程给出：\n$$\n\\mathbf{m}_{\\text{est}} = (\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T \\mathbf{d}\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 的单位矩阵。\n\n让我们计算矩阵 $\\mathbf{G}^T \\mathbf{G}$ 和 $\\mathbf{G}^T \\mathbf{d}$。由于 $\\mathbf{G}$ 列的正交结构（每个网格点只对 $m_A$ 或 $m_B$ 有贡献，但不同时对两者都有），矩阵 $\\mathbf{G}^T \\mathbf{G}$ 是对角的：\n$$\n\\mathbf{G}^T \\mathbf{G} = \\begin{pmatrix} \\sum_{i \\in I_A} K_i^2  0 \\\\ 0  \\sum_{i \\in I_B} K_i^2 \\end{pmatrix}\n$$\n向量 $\\mathbf{G}^T \\mathbf{d}$ 是：\n$$\n\\mathbf{G}^T \\mathbf{d} = \\begin{pmatrix} \\sum_{i \\in I_A} K_i d_i \\\\ \\sum_{i \\in I_B} K_i d_i \\end{pmatrix}\n$$\n待求逆的正则化矩阵是：\n$$\n(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I}) = \\begin{pmatrix} \\left(\\sum_{i \\in I_A} K_i^2\\right) + \\lambda^2  0 \\\\ 0  \\left(\\sum_{i \\in I_B} K_i^2\\right) + \\lambda^2 \\end{pmatrix}\n$$\n求逆是平凡的，系统解耦为两个独立的关于 $m_A$ 和 $m_B$ 的方程：\n$$\nm_{A, \\text{est}} = \\frac{\\sum_{i \\in I_A} K_i d_i}{\\left(\\sum_{i \\in I_A} K_i^2\\right) + \\lambda^2}\n$$\n$$\nm_{B, \\text{est}} = \\frac{\\sum_{i \\in I_B} K_i d_i}{\\left(\\sum_{i \\in I_B} K_i^2\\right) + \\lambda^2}\n$$\n问题要求强制物理参数 $T_e^A, T_e^B$ 的非负性。由于 $T_e = m^{-1/3}$，这要求 $m  0$。在我们的模型中，荷载 $q_i$ 是非负的，因此系数 $K_i$ 是非负的。观测到的隆升 $d_i$（代表物理隆升）也将是非负的（加上小的噪声）。因此，分子（$\\sum K_i d_i$）和分母（平方和加上 $\\lambda^2$）将是正的，自然确保了 $m_{A, \\text{est}}  0$ 和 $m_{B, \\text{est}}  0$。因此，非负性约束得以满足，无需额外的算法复杂性。\n\n最后，通过对估计的模型参数进行逆变换来恢复估计的弹性厚度值：\n$$\nT_{e, \\text{est}}^A = (m_{A, \\text{est}})^{-1/3} \\quad \\text{和} \\quad T_{e, \\text{est}}^B = (m_{B, \\text{est}})^{-1/3}\n$$\n这些以国际单位制（米）计算出的值，必须转换为千米以用于最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the geophysical inversion problem for piecewise-constant elastic thickness.\n    \n    The function iterates through three test cases. For each case, it:\n    1. Sets up the physical model (grid, load, parameters).\n    2. Generates synthetic uplift data using the forward model derived from thin-plate\n       flexure and Maxwell viscoelasticity, based on the true elastic thickness values.\n       Gaussian noise is added to simulate observations.\n    3. Implements a Tikhonov-regularized linear inversion to estimate the two elastic\n       thickness parameters (TeA for x0, TeB for x>=0). The inversion is based on\n       linearizing the problem by solving for m = 1/Te^3.\n    4. Converts the estimated parameters back to elastic thickness in kilometers.\n    5. Collects and formats the results as specified.\n    \"\"\"\n    \n    # Common constants\n    N = 16                                 # Grid size\n    E = 7.0e10                             # Young's modulus (Pa)\n    NU = 0.25                              # Poisson's ratio\n    MU = 6.7e10                            # Shear modulus (Pa)\n    P0 = 2.0e7                             # Peak ice load (Pa)\n    SIGMA = 0.40                           # Gaussian load width (dimensionless)\n    LAMBDA = 1.0e-4                        # Tikhonov regularization parameter\n    YR_TO_S = 365.25 * 24 * 3600           # Conversion from years to seconds\n\n    # Set up the computational grid\n    x_coords = np.linspace(-1.0, 1.0, N)\n    y_coords = np.linspace(-1.0, 1.0, N)\n    x, y = np.meshgrid(x_coords, y_coords)\n\n    # Define the ice load q(x,y)\n    q = P0 * np.exp(-(x**2 + y**2) / (2 * SIGMA**2))\n\n    # Test cases\n    test_cases = [\n        # (TeA_true_km, TeB_true_km, eta, t_yr, L_m, noise_std_m)\n        (40.0, 60.0, 1.0e21, 2000.0, 200000.0, 0.002),\n        (30.0, 30.0, 5.0e22, 1000.0, 200000.0, 0.001),\n        (35.0, 80.0, 5.0e20, 3000.0, 250000.0, 0.003),\n    ]\n\n    # For result reproducibility\n    np.random.seed(0)\n    \n    results = []\n    \n    for case in test_cases:\n        TeA_true_km, TeB_true_km, eta, t_yr, L_m, noise_std_m = case\n        \n        # --- 1. Forward Model: Generate synthetic data ---\n        \n        # Convert units to SI\n        TeA_true_m = TeA_true_km * 1000.0\n        TeB_true_m = TeB_true_km * 1000.0\n        t_s = t_yr * YR_TO_S\n\n        # Calculate model-dependent constants\n        k0 = (2 * np.pi) / L_m\n        tau = eta / MU\n        \n        # Create true Te field in meters\n        Te_true_field_m = np.full_like(x, TeB_true_m)\n        Te_true_field_m[x  0] = TeA_true_m\n        \n        # Calculate uplift using the forward model\n        # u = (q / (k0^4)) * (12*(1-nu^2)/E) * (1/Te^3) * (1 - exp(-t/tau))\n        C_flexure = (12 * (1 - NU**2)) / E\n        f_relax = 1.0 - np.exp(-t_s / tau)\n        \n        u_true = (q / (k0**4)) * C_flexure * (1.0 / Te_true_field_m**3) * f_relax\n\n        # Add Gaussian noise to create observed data\n        noise = np.random.normal(0, noise_std_m, (N, N))\n        u_obs = u_true + noise\n\n        # --- 2. Inverse Problem: Estimate TeA and TeB ---\n        \n        # Flatten grids to 1D vectors for easier processing\n        u_obs_flat = u_obs.flatten()\n        q_flat = q.flatten()\n        x_flat = x.flatten()\n        \n        # Identify points in region A (x  0) and region B (x >= 0)\n        idx_A = np.where(x_flat  0)[0]\n        idx_B = np.where(x_flat >= 0)[0]\n\n        # Calculate the coefficient K for the linearized model d = G*m\n        # K_i = (q_i / k0^4) * C_flexure * f_relax\n        K_flat = (q_flat / (k0**4)) * C_flexure * f_relax\n\n        d_A, d_B = u_obs_flat[idx_A], u_obs_flat[idx_B]\n        K_A, K_B = K_flat[idx_A], K_flat[idx_B]\n\n        # Calculate terms for the Tikhonov-regularized solution\n        # m_est = (G.T @ d) / (diag(G.T @ G) + lambda^2)\n        sum_K2_A = np.sum(K_A**2)\n        sum_K2_B = np.sum(K_B**2)\n        \n        sum_Kd_A = np.sum(K_A * d_A)\n        sum_Kd_B = np.sum(K_B * d_B)\n        \n        # Solve for the linearized parameters m_A and m_B\n        mA_est = sum_Kd_A / (sum_K2_A + LAMBDA**2)\n        mB_est = sum_Kd_B / (sum_K2_B + LAMBDA**2)\n        \n        # Back-transform to get physical parameters (Te) and convert to km\n        TeA_est_km = (mA_est**(-1/3)) / 1000.0\n        TeB_est_km = (mB_est**(-1/3)) / 1000.0\n        \n        results.extend([round(TeA_est_km, 2), round(TeB_est_km, 2)])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}