{
    "hands_on_practices": [
        {
            "introduction": "When we replace a continuous partial differential equation with a discrete numerical algorithm, we inevitably introduce errors. This practice delves into modified equation analysis, a powerful technique that reveals the true, continuous PDE that a numerical scheme approximates. By performing a Taylor series expansion on a first-order upwind scheme for the advection equation, you will uncover a hidden \"numerical diffusion\" term, providing a crucial insight into why simple schemes can artificially smear sharp gradients in a simulation .",
            "id": "3575280",
            "problem": "A one-dimensional passive tracer concentration field $c(x,t)$ is transported by a steady, positive velocity $u>0$ in a straight geophysical conduit of uniform cross section. The governing conservation law is the linear advection partial differential equation (PDE)\n$$\n\\frac{\\partial c}{\\partial t} + u\\,\\frac{\\partial c}{\\partial x} = 0,\n$$\nposed on a uniform grid with spacing $\\Delta x$. Consider a semi-discrete finite volume method (FVM) with first-order upwind numerical fluxes, so that for cell-averaged unknowns $c_i(t) \\approx c(x_i,t)$ the method-of-lines ordinary differential equation is\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x},\n$$\nwith $F_{i+1/2} = u\\,c_i$ and $F_{i-1/2} = u\\,c_{i-1}$ under the assumption $u>0$.\n\nUsing only fundamental series expansions and keeping terms consistently through second spatial derivatives, perform a modified equation analysis by Taylor expanding $c_{i-1}(t)$ about $x_i$ to derive a continuous PDE that the semi-discrete scheme approximates to leading order. From the coefficient multiplying the term $\\partial^2 c/\\partial x^2$ in the resulting modified equation, identify the effective numerical diffusion coefficient $\\tilde{D}$ induced by the first-order upwind discretization.\n\nYour final answer must be a single closed-form analytic expression for $\\tilde{D}$ in terms of $u$ and $\\Delta x$. Express the effective diffusion coefficient in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$. Do not use any pre-tabulated truncation error formulas and do not assume any particular time integrator beyond the semi-discrete formulation described here. Do not include any intermediate or auxiliary quantities in your final answer.",
            "solution": "The analysis begins with the semi-discrete finite volume method (FVM) formulation provided for the one-dimensional linear advection equation. The governing ordinary differential equation (ODE) for the cell-averaged concentration $c_i(t)$ in cell $i$ is given by the method of lines:\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x}\n$$\nThe problem specifies a first-order upwind numerical flux for a steady, positive velocity $u>0$. The fluxes at the cell interfaces $i+1/2$ and $i-1/2$ are:\n$$\nF_{i+1/2} = u\\,c_i\n$$\n$$\nF_{i-1/2} = u\\,c_{i-1}\n$$\nSubstituting these flux definitions into the semi-discrete FVM equation yields the specific ODE for the evolution of $c_i$:\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{u\\,c_i - u\\,c_{i-1}}{\\Delta x} = -u \\frac{c_i - c_{i-1}}{\\Delta x}\n$$\nTo derive the modified equation, we relate the discrete quantities in this equation to a continuous concentration field $c(x,t)$. We interpret $c_i(t)$ as the point value of the continuous function at the cell center, $c_i(t) \\equiv c(x_i, t)$. The term on the left-hand side, $\\frac{\\mathrm{d} c_i}{\\mathrm{d} t}$, is identified with the partial derivative with respect to time, $\\frac{\\partial c}{\\partial t}$, evaluated at $(x_i, t)$. The term $c_{i-1}(t)$ represents the concentration at the center of the adjacent upwind cell, $x_{i-1} = x_i - \\Delta x$. We use a Taylor series expansion to express $c_{i-1}(t) = c(x_i - \\Delta x, t)$ in terms of the concentration and its spatial derivatives at position $x_i$:\n$$\nc_{i-1} = c(x_i - \\Delta x, t) = c(x_i, t) - \\Delta x \\frac{\\partial c}{\\partial x}\\bigg|_{x_i} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 c}{\\partial x^2}\\bigg|_{x_i} - \\mathcal{O}((\\Delta x)^3)\n$$\nThe problem requires retaining terms consistently through the second spatial derivative. Therefore, we substitute this expansion into the right-hand side of our semi-discrete equation. For clarity, we will omit the explicit evaluation notation $\\big|_{x_i}$ as it is understood that all spatial derivatives are evaluated at $x_i$.\n$$\n\\frac{\\partial c}{\\partial t} = -u \\frac{c_i - \\left( c_i - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^3) \\right)}{\\Delta x}\n$$\nSimplifying the numerator inside the parentheses:\n$$\nc_i - \\left( c_i - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^3) \\right) = \\Delta x \\frac{\\partial c}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3)\n$$\nNow, substitute this simplified expression back into the equation for $\\frac{\\partial c}{\\partial t}$:\n$$\n\\frac{\\partial c}{\\partial t} = - \\frac{u}{\\Delta x} \\left( \\Delta x \\frac{\\partial c}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3) \\right)\n$$\nDistributing the factor $-u/\\Delta x$ across the terms in the parenthesis gives:\n$$\n\\frac{\\partial c}{\\partial t} = -u \\frac{\\partial c}{\\partial x} + u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^2)\n$$\nThis is the modified equation, representing the continuous PDE that is actually being solved by the semi-discrete scheme to leading order. We can rearrange this equation to better see the relationship to the original PDE:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^2)\n$$\nThe left-hand side is the original linear advection equation, $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0$. The leading-order truncation error term, which appears on the right-hand side, is $u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2}$. This term has the mathematical form of a diffusion (or dissipation) term. The general form of an advection-diffusion equation is:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = D \\frac{\\partial^2 c}{\\partial x^2}\n$$\nwhere $D$ is the diffusion coefficient. By comparing the modified equation with the general advection-diffusion equation, we can identify the effective numerical diffusion coefficient, denoted as $\\tilde{D}$, which is induced by the spatial discretization scheme.\nThe coefficient multiplying the term $\\frac{\\partial^2 c}{\\partial x^2}$ in our derived modified equation is $u \\frac{\\Delta x}{2}$. Therefore, the effective numerical diffusion coefficient is:\n$$\n\\tilde{D} = \\frac{u \\Delta x}{2}\n$$\nThis quantity has an adverse effect in numerical simulations, as it introduces artificial smearing or diffusion of sharp gradients in the concentration field, a well-known characteristic of first-order upwind schemes.",
            "answer": "$$\\boxed{\\frac{u \\Delta x}{2}}$$"
        },
        {
            "introduction": "Beyond accuracy, the most critical property of a numerical scheme is stability; an unstable scheme will produce physically meaningless, exploding solutions. This exercise introduces von Neumann analysis, the cornerstone technique for assessing the stability of linear finite difference schemes. You will derive the amplification factor $G(\\theta)$ for a full advection-diffusion-reaction discretization, learning how its magnitude $|G(\\theta)|$ governs stability and its phase $\\arg(G(\\theta))$ controls numerical dispersion, or phase error .",
            "id": "3575315",
            "problem": "A saturated, homogeneous porous medium transports a conservative tracer subject to advection, molecular diffusion, and first-order decay. Consider one spatial dimension with uniform, steady pore velocity $a &gt; 0$, constant molecular diffusion coefficient $D \\ge 0$, and decay rate $r \\ge 0$. The linear advection-diffusion-reaction (ADR) model governing the concentration $c(x,t)$ is\n$$\n\\frac{\\partial c}{\\partial t} + a \\frac{\\partial c}{\\partial x} \\;=\\; D \\frac{\\partial^2 c}{\\partial x^2} \\;-\\; r\\,c\\,.\n$$\nOn an infinite uniform grid $x_j = j\\,\\Delta x$ and time levels $t^n = n\\,\\Delta t$, discretize this equation using forward Euler in time, first-order upwind for advection (appropriate for $a>0$), second-order central differences for diffusion, and explicit reaction:\n$$\n\\frac{c_j^{n+1} - c_j^n}{\\Delta t} \\;+\\; a\\,\\frac{c_j^n - c_{j-1}^n}{\\Delta x} \\;=\\; D\\,\\frac{c_{j+1}^n - 2c_j^n + c_{j-1}^n}{\\Delta x^2} \\;-\\; r\\,c_j^n\\,.\n$$\nDefine the dimensionless parameters (commonly known in transport and stability analysis) $C = a\\,\\Delta t/\\Delta x$, $\\mu = D\\,\\Delta t/\\Delta x^2$, and $\\lambda = r\\,\\Delta t$. Assume an infinite or periodic domain so that a von Neumann Fourier analysis is appropriate, and consider a single Fourier mode with grid wavenumber $\\theta \\in \\mathbb{R}$ (in radians), of the form $c_j^n = \\hat{c}^n \\exp(i\\,j\\,\\theta)$ with $i^2=-1$.\n\nStarting from the conservation law statement above and the given finite-difference discretization, perform a von Neumann analysis to:\n- derive the one-step amplification factor $G(\\theta)$ defined by $\\hat{c}^{n+1} = G(\\theta)\\,\\hat{c}^n$,\n- identify, in terms of $G(\\theta)$, how magnitude and argument control stability and phase errors for this scheme.\n\nExpress your final answer as a single closed-form analytic expression for the amplification factor $G(\\theta)$ in terms of $\\theta$, $C$, $\\mu$, and $\\lambda$. No numerical evaluation is required. State angles in radians. Do not include any inequalities in your final answer.",
            "solution": "The task is to perform a von Neumann stability analysis on a given finite difference scheme for the one-dimensional advection-diffusion-reaction (ADR) equation. We need to derive the amplification factor $G(\\theta)$ and discuss its role in controlling stability and phase error.\n\nThe governing partial differential equation (PDE) is:\n$$\n\\frac{\\partial c}{\\partial t} + a \\frac{\\partial c}{\\partial x} \\;=\\; D \\frac{\\partial^2 c}{\\partial x^2} \\;-\\; r\\,c\n$$\nThe provided finite difference equation (FDE) discretizes this PDE:\n$$\n\\frac{c_j^{n+1} - c_j^n}{\\Delta t} \\;+\\; a\\,\\frac{c_j^n - c_{j-1}^n}{\\Delta x} \\;=\\; D\\,\\frac{c_{j+1}^n - 2c_j^n + c_{j-1}^n}{\\Delta x^2} \\;-\\; r\\,c_j^n\n$$\nHere, $c_j^n$ approximates the concentration $c(x_j, t^n)$ at grid point $x_j = j\\,\\Delta x$ and time level $t^n = n\\,\\Delta t$.\n\nFor the von Neumann analysis, we substitute a single Fourier mode ansatz, $c_j^n = \\hat{c}^n \\exp(i\\,j\\,\\theta)$, into the FDE. The term $\\hat{c}^n$ is the amplitude of the mode at time level $n$, $i$ is the imaginary unit ($i^2 = -1$), $j$ is the spatial grid index, and $\\theta = k\\,\\Delta x$ is the dimensionless grid wavenumber for a continuous wavenumber $k$.\n\nWe express each term in the FDE using this ansatz:\n- $c_j^{n+1} = \\hat{c}^{n+1} \\exp(i\\,j\\,\\theta)$\n- $c_j^n = \\hat{c}^n \\exp(i\\,j\\,\\theta)$\n- $c_{j-1}^n = \\hat{c}^n \\exp(i\\,(j-1)\\,\\theta) = \\hat{c}^n \\exp(i\\,j\\,\\theta) \\exp(-i\\,\\theta)$\n- $c_{j+1}^n = \\hat{c}^n \\exp(i\\,(j+1)\\,\\theta) = \\hat{c}^n \\exp(i\\,j\\,\\theta) \\exp(i\\,\\theta)$\n\nSubstituting these expressions into the FDE yields:\n$$\n\\frac{\\hat{c}^{n+1} e^{ij\\theta} - \\hat{c}^n e^{ij\\theta}}{\\Delta t} + a\\,\\frac{\\hat{c}^n e^{ij\\theta} - \\hat{c}^n e^{ij\\theta}e^{-i\\theta}}{\\Delta x} = D\\,\\frac{\\hat{c}^n e^{ij\\theta}e^{i\\theta} - 2\\hat{c}^n e^{ij\\theta} + \\hat{c}^n e^{ij\\theta}e^{-i\\theta}}{\\Delta x^2} - r\\,\\hat{c}^n e^{ij\\theta}\n$$\nThe common factor $\\exp(i\\,j\\,\\theta)$ is non-zero and can be divided out from every term:\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} + a\\,\\frac{\\hat{c}^n(1 - e^{-i\\theta})}{\\Delta x} = D\\,\\frac{\\hat{c}^n(e^{i\\theta} - 2 + e^{-i\\theta})}{\\Delta x^2} - r\\,\\hat{c}^n\n$$\nThe amplification factor $G(\\theta)$ is defined by the relation $\\hat{c}^{n+1} = G(\\theta)\\,\\hat{c}^n$. We rearrange the equation to solve for the ratio $\\hat{c}^{n+1} / \\hat{c}^n$.\nFirst, isolate the $\\hat{c}^{n+1}$ term:\n$$\n\\frac{\\hat{c}^{n+1}}{\\Delta t} = \\frac{\\hat{c}^n}{\\Delta t} - a\\,\\frac{\\hat{c}^n(1 - e^{-i\\theta})}{\\Delta x} + D\\,\\frac{\\hat{c}^n(e^{i\\theta} - 2 + e^{-i\\theta})}{\\Delta x^2} - r\\,\\hat{c}^n\n$$\nFactor out $\\hat{c}^n$ on the right-hand side:\n$$\n\\frac{\\hat{c}^{n+1}}{\\Delta t} = \\hat{c}^n \\left[ \\frac{1}{\\Delta t} - \\frac{a}{\\Delta x}(1 - e^{-i\\theta}) + \\frac{D}{\\Delta x^2}(e^{i\\theta} - 2 + e^{-i\\theta}) - r \\right]\n$$\nMultiply both sides by $\\Delta t$:\n$$\n\\hat{c}^{n+1} = \\hat{c}^n \\left[ 1 - \\frac{a\\Delta t}{\\Delta x}(1 - e^{-i\\theta}) + \\frac{D\\Delta t}{\\Delta x^2}(e^{i\\theta} - 2 + e^{-i\\theta}) - r\\Delta t \\right]\n$$\nBy definition, $G(\\theta) = \\hat{c}^{n+1}/\\hat{c}^n$, so the amplification factor is the expression in the brackets. We now substitute the given dimensionless parameters: the Courant number $C = a\\,\\Delta t/\\Delta x$, the diffusion number $\\mu = D\\,\\Delta t/\\Delta x^2$, and the reaction number $\\lambda = r\\,\\Delta t$.\n$$\nG(\\theta) = 1 - C(1 - e^{-i\\theta}) + \\mu(e^{i\\theta} - 2 + e^{-i\\theta}) - \\lambda\n$$\nThis is the required closed-form analytic expression for the amplification factor.\n\nThe second part of the task is to discuss how the magnitude and argument of $G(\\theta)$ relate to stability and phase errors.\n\n$1$. **Stability**: The numerical stability of the scheme is governed by the magnitude of the amplification factor, $|G(\\theta)|$. For a solution to remain bounded, the amplitude of any Fourier mode must not grow in time. This leads to the von Neumann stability condition:\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\nIf $|G(\\theta)| > 1$ for any wavenumber $\\theta$, the corresponding Fourier component will be amplified exponentially with each time step, leading to a rapid and unbounded growth of error, rendering the numerical solution useless. The scheme is conditionally stable, meaning this inequality imposes constraints on the values of $C$, $\\mu$, and $\\lambda$.\n\n$2$. **Phase Error**: The phase error is related to the argument (or phase angle) of the amplification factor, $\\arg(G(\\theta))$. For a complex number $z = x+iy$, $\\arg(z)$ is the angle $\\phi$ such that $z = |z|\\exp(i\\phi)$. The amplification factor determines how both the amplitude and phase of a Fourier mode change over one time step. The numerical phase velocity, $v_{p, \\text{num}}$, indicates the speed at which a wave of a given wavenumber propagates on the grid. It is given by:\n$$\nv_{p, \\text{num}} = -\\frac{\\arg(G(\\theta))}{k\\,\\Delta t} = -\\frac{\\arg(G(\\theta))}{\\theta} \\frac{\\Delta x}{\\Delta t}\n$$\nFor the pure advection part of the exact PDE, all Fourier components propagate at the same velocity, $a$. This corresponds to an exact phase shift of $-a\\,k\\,\\Delta t = -C\\,\\theta$ per timestep for a Fourier mode $\\exp(ikx)$. The numerical dispersion relation is generally not linear with $k$, meaning $v_{p, \\text{num}}$ depends on $\\theta$. The phase error is the discrepancy between the numerical phase velocity and the true physical phase velocity, $a$. This error manifests as numerical dispersion, where different wave components travel at incorrect speeds, distorting the shape of the solution profile. A large deviation of $\\arg(G(\\theta))$ from the ideal linear phase shift $-C\\theta$ signifies a substantial phase error.",
            "answer": "$$\n\\boxed{1 - C(1 - \\exp(-i\\theta)) + \\mu(\\exp(i\\theta) - 2 + \\exp(-i\\theta)) - \\lambda}\n$$"
        },
        {
            "introduction": "After developing a theoretically sound numerical model, how can you be certain your computer code implements it correctly? This practice introduces the Method of Manufactured Solutions (MMS), a rigorous and indispensable technique for code verification. You will work backward from a chosen complex, analytical \"manufactured\" solution to derive the specific source terms and boundary conditions required to make it an exact solution to the governing advection-diffusion-reaction equation, thereby creating a perfect test case to debug and validate your code .",
            "id": "3575306",
            "problem": "A two-dimensional ($2$-D) solute concentration field $c(x,y,t)$ in a saturated porous medium is modeled by the advection–diffusion–reaction partial differential equation (PDE) derived from conservation of mass and Fickian dispersion,\n$$\\frac{\\partial c}{\\partial t} + \\boldsymbol{u}(t)\\cdot \\nabla c \\;=\\; \\nabla\\cdot\\!\\big(\\boldsymbol{D}\\,\\nabla c\\big) \\;-\\; R(c) \\;+\\; f(x,y,t)\\quad \\text{in}\\;\\Omega\\times(0,T],$$\nwith a nonlinear reactive Robin boundary condition derived from a mixed kinetic–flux relation,\n$$\\boldsymbol{n}\\cdot\\!\\big(-\\boldsymbol{D}\\,\\nabla c + \\boldsymbol{u}(t)\\,c\\big) \\;+\\; \\kappa_{b}\\,c^{2} \\;=\\; h(x,y,t)\\quad \\text{on}\\;\\partial\\Omega\\times(0,T].$$\nHere $\\Omega=(0,L_{x})\\times(0,L_{y})$ is a rectangle, $\\boldsymbol{n}$ is the outward unit normal, $\\boldsymbol{u}(t)$ is a spatially uniform, divergence-free velocity, $\\boldsymbol{D}$ is a constant symmetric positive-definite anisotropic dispersion tensor, $R(c)$ is a nonlinear reaction rate, $f$ is a volumetric source, and $h$ is a boundary data function. For code verification using the Method of Manufactured Solutions (MMS), consider the following parameterized family (“suite”) of manufactured solutions and coefficients:\n- Velocity with time-dependent direction,\n$$\\boldsymbol{u}(t) \\;=\\; \\begin{pmatrix} u_{0}\\,\\cos(\\Omega t) \\\\[4pt] u_{0}\\,\\sin(\\Omega t) \\end{pmatrix},$$\n- Anisotropic dispersion tensor,\n$$\\boldsymbol{D} \\;=\\; \\begin{pmatrix} D_{x} & D_{xy} \\\\ D_{xy} & D_{y} \\end{pmatrix},\\quad D_{x}>0,\\;D_{y}>0,\\;D_{x}D_{y}-D_{xy}^{2}>0,$$\n- Nonlinear reaction,\n$$R(c) \\;=\\; k_{2}\\,c^{2} \\;+\\; \\frac{k_{m}\\,c}{K + c},$$\n- Manufactured concentration field,\n$$c(x,y,t) \\;=\\; A\\,\\exp(\\alpha t)\\,\\sin(k_{x} x)\\,\\cos(k_{y} y) \\;+\\; B\\,\\exp(\\beta t)\\,\\cos(k_{x}' x + \\omega t)\\,\\sin(k_{y}' y),$$\nwith constants $A,B,\\alpha,\\beta,k_{x},k_{y},k_{x}',k_{y}',\\omega,u_{0},\\Omega,D_{x},D_{y},D_{xy},k_{2},k_{m},K,\\kappa_{b}$ taken as arbitrary but fixed real parameters satisfying the stated positivity and definiteness conditions. Interpret all trigonometric function arguments in radians.\n\nStarting only from conservation of mass, the definition of advective and diffusive fluxes, and the above definitions, derive the explicit analytic expression for the interior forcing $f(x,y,t)$ that makes $c(x,y,t)$ an exact solution of the PDE in the interior. In addition, derive the explicit analytic expression for the reactive Robin boundary data $h(x,t)$ on the bottom boundary $y=0$ that makes $c(x,y,t)$ satisfy the boundary condition there.\n\nProvide your final answer as a row matrix with two entries using the $\\texttt{pmatrix}$ environment, with the first entry equal to $f(x,y,t)$ and the second entry equal to $h(x,t)$ evaluated on $y=0$. No numerical evaluation is required, and no units are needed.",
            "solution": "The problem requires the derivation of two functions, the interior source term $f(x,y,t)$ and the boundary data function $h(x,t)$ on the bottom boundary $y=0$, that make the given manufactured solution $c(x,y,t)$ an exact solution to the provided partial differential equation (PDE) and boundary condition (BC). This is a standard procedure in the Method of Manufactured Solutions (MMS) for code verification.\n\nThe manufactured solution is given by\n$$c(x,y,t) = A\\,\\exp(\\alpha t)\\,\\sin(k_{x} x)\\,\\cos(k_{y} y) + B\\,\\exp(\\beta t)\\,\\cos(k_{x}' x + \\omega t)\\,\\sin(k_{y}' y)$$\nLet's denote the two terms as $c_1(x,y,t)$ and $c_2(x,y,t)$ respectively:\n$c_1(x,y,t) = A\\,\\exp(\\alpha t)\\,\\sin(k_{x} x)\\,\\cos(k_{y} y)$\n$c_2(x,y,t) = B\\,\\exp(\\beta t)\\,\\cos(k_{x}' x + \\omega t)\\,\\sin(k_{y}' y)$\nsuch that $c = c_1 + c_2$.\n\n**Part 1: Derivation of the interior source term $f(x,y,t)$**\n\nThe PDE is given as:\n$$\\frac{\\partial c}{\\partial t} + \\boldsymbol{u}(t)\\cdot \\nabla c \\;=\\; \\nabla\\cdot\\!\\big(\\boldsymbol{D}\\,\\nabla c\\big) \\;-\\; R(c) \\;+\\; f(x,y,t)$$\nThe source term $f(x,y,t)$ can be isolated:\n$$f(x,y,t) = \\frac{\\partial c}{\\partial t} + \\boldsymbol{u}(t)\\cdot \\nabla c - \\nabla\\cdot\\!\\big(\\boldsymbol{D}\\,\\nabla c\\big) + R(c)$$\nTo find $f(x,y,t)$, we must compute each term on the right-hand side by substituting the manufactured solution $c(x,y,t)$.\n\n**1. Time derivative $\\frac{\\partial c}{\\partial t}$**:\n$\\frac{\\partial c_1}{\\partial t} = \\alpha A \\exp(\\alpha t) \\sin(k_x x)\\cos(k_y y) = \\alpha c_1$\n$\\frac{\\partial c_2}{\\partial t} = \\beta B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\sin(k_y' y) + B \\exp(\\beta t)(-\\sin(k_x' x + \\omega t))(\\omega)\\sin(k_y' y) = \\beta c_2 - \\omega B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y)$\n$\\frac{\\partial c}{\\partial t} = \\frac{\\partial c_1}{\\partial t} + \\frac{\\partial c_2}{\\partial t} = \\alpha c_1 + \\beta c_2 - \\omega B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y)$\n\n**2. Gradient $\\nabla c$**:\n$\\frac{\\partial c_1}{\\partial x} = k_x A \\exp(\\alpha t)\\cos(k_x x)\\cos(k_y y)$\n$\\frac{\\partial c_1}{\\partial y} = -k_y A \\exp(\\alpha t)\\sin(k_x x)\\sin(k_y y)$\n$\\frac{\\partial c_2}{\\partial x} = -k_x' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y)$\n$\\frac{\\partial c_2}{\\partial y} = k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\cos(k_y' y)$\n$\\nabla c = \\begin{pmatrix} \\frac{\\partial c_1}{\\partial x} + \\frac{\\partial c_2}{\\partial x} \\\\ \\frac{\\partial c_1}{\\partial y} + \\frac{\\partial c_2}{\\partial y} \\end{pmatrix}$\n\n**3. Advection term $\\boldsymbol{u}(t)\\cdot \\nabla c$**:\nWith $\\boldsymbol{u}(t) = (u_0\\cos(\\Omega t), u_0\\sin(\\Omega t))^T$:\n$\\boldsymbol{u}\\cdot\\nabla c = u_0\\cos(\\Omega t)\\left(\\frac{\\partial c_1}{\\partial x} + \\frac{\\partial c_2}{\\partial x}\\right) + u_0\\sin(\\Omega t)\\left(\\frac{\\partial c_1}{\\partial y} + \\frac{\\partial c_2}{\\partial y}\\right)$\n\n**4. Diffusion term $\\nabla\\cdot(\\boldsymbol{D}\\,\\nabla c)$**:\nSince $\\boldsymbol{D}$ is a constant tensor, $\\nabla\\cdot(\\boldsymbol{D}\\nabla c) = D_x \\frac{\\partial^2 c}{\\partial x^2} + D_y \\frac{\\partial^2 c}{\\partial y^2} + 2D_{xy} \\frac{\\partial^2 c}{\\partial x \\partial y}$. We compute the second derivatives:\n$\\frac{\\partial^2 c_1}{\\partial x^2} = -k_x^2 c_1$, $\\frac{\\partial^2 c_1}{\\partial y^2} = -k_y^2 c_1$, $\\frac{\\partial^2 c_1}{\\partial x \\partial y} = -k_x k_y A \\exp(\\alpha t)\\cos(k_x x)\\sin(k_y y)$\n$\\frac{\\partial^2 c_2}{\\partial x^2} = -(k_x')^2 c_2$, $\\frac{\\partial^2 c_2}{\\partial y^2} = -(k_y')^2 c_2$, $\\frac{\\partial^2 c_2}{\\partial x \\partial y} = -k_x' k_y' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\cos(k_y' y)$\n\nSo, $\\nabla\\cdot(\\boldsymbol{D}\\nabla c_1) = -D_x k_x^2 c_1 - D_y k_y^2 c_1 - 2D_{xy} k_x k_y A \\exp(\\alpha t)\\cos(k_x x)\\sin(k_y y)$\nand $\\nabla\\cdot(\\boldsymbol{D}\\nabla c_2) = -D_x (k_x')^2 c_2 - D_y (k_y')^2 c_2 - 2D_{xy} k_x' k_y' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\cos(k_y' y)$.\n\n**5. Reaction term $R(c)$**:\n$R(c) = k_2 c^2 + \\frac{k_m c}{K+c}$, where $c=c_1+c_2$.\n\n**6. Assembling $f(x,y,t)$**:\n$f(x,y,t) = \\left( \\frac{\\partial c_1}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla c_1 - \\nabla\\cdot(\\boldsymbol{D}\\nabla c_1) \\right) + \\left( \\frac{\\partial c_2}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla c_2 - \\nabla\\cdot(\\boldsymbol{D}\\nabla c_2) \\right) + R(c)$\n\nLet's assemble the part for $c_1$:\n$(\\alpha c_1) + \\big( u_0\\cos(\\Omega t) k_x A \\exp(\\alpha t)\\cos(k_x x)\\cos(k_y y) - u_0\\sin(\\Omega t) k_y A \\exp(\\alpha t)\\sin(k_x x)\\sin(k_y y) \\big) - \\big( -D_x k_x^2 c_1 - D_y k_y^2 c_1 - 2D_{xy} k_x k_y A \\exp(\\alpha t)\\cos(k_x x)\\sin(k_y y) \\big)$\n$= (\\alpha + D_x k_x^2 + D_y k_y^2) c_1 + A \\exp(\\alpha t) \\left[ u_0 k_x \\cos(\\Omega t)\\cos(k_x x)\\cos(k_y y) - u_0 k_y \\sin(\\Omega t)\\sin(k_x x)\\sin(k_y y) + 2D_{xy} k_x k_y \\cos(k_x x)\\sin(k_y y) \\right]$\n\nAnd the part for $c_2$:\n$(\\beta c_2 - \\omega B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y)) + \\big( -u_0\\cos(\\Omega t) k_x' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y) + u_0\\sin(\\Omega t) k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\cos(k_y' y) \\big) - \\big( -D_x (k_x')^2 c_2 - D_y (k_y')^2 c_2 - 2D_{xy} k_x' k_y' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\cos(k_y' y) \\big)$\n$= (\\beta + D_x (k_x')^2 + D_y (k_y')^2) c_2 + B \\exp(\\beta t) \\left[ -(\\omega + u_0 k_x' \\cos(\\Omega t))\\sin(k_x' x + \\omega t)\\sin(k_y' y) + u_0 k_y' \\sin(\\Omega t)\\cos(k_x' x + \\omega t)\\cos(k_y' y) + 2D_{xy} k_x' k_y' \\sin(k_x' x + \\omega t)\\cos(k_y' y) \\right]$\n\nSumming these parts and $R(c)$ gives the final expression for $f(x,y,t)$.\n\n**Part 2: Derivation of the boundary data $h(x,t)$ on $y=0$**\n\nThe Robin boundary condition is:\n$$\\boldsymbol{n}\\cdot\\!\\big(-\\boldsymbol{D}\\,\\nabla c + \\boldsymbol{u}(t)\\,c\\big) \\;+\\; \\kappa_{b}\\,c^{2} \\;=\\; h(x,y,t)$$\nOn the bottom boundary $y=0$, the outward unit normal is $\\boldsymbol{n} = (0,-1)^T$.\nSo, $h(x,0,t) = (0,-1)\\cdot(\\boldsymbol{D}\\nabla c - \\boldsymbol{u}c) + \\kappa_b c^2 \\bigg|_{y=0}$\nLet $\\boldsymbol{F} = -\\boldsymbol{D}\\nabla c + \\boldsymbol{u}c$ be the total flux. Then $h(x,0,t) = -F_y|_{y=0} + \\kappa_b c^2|_{y=0}$.\nThe y-component of the flux is $F_y = -(D_{xy}\\frac{\\partial c}{\\partial x} + D_y\\frac{\\partial c}{\\partial y}) + u_y(t) c$.\nTherefore, $h(x,0,t) = D_{xy}\\frac{\\partial c}{\\partial x} + D_y\\frac{\\partial c}{\\partial y} - u_y(t) c + \\kappa_b c^2$, all evaluated at $y=0$.\n\nWe evaluate the required terms at $y=0$:\n$c_1(x,0,t) = A \\exp(\\alpha t)\\sin(k_x x)\\cos(0) = A \\exp(\\alpha t)\\sin(k_x x)$\n$c_2(x,0,t) = B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\sin(0) = 0$\nThus, $c(x,0,t) = A \\exp(\\alpha t)\\sin(k_x x)$.\n\nThe derivatives at $y=0$:\n$\\frac{\\partial c}{\\partial x}\\Big|_{y=0} = \\frac{\\partial c_1}{\\partial x}\\Big|_{y=0} + \\frac{\\partial c_2}{\\partial x}\\Big|_{y=0} = k_x A \\exp(\\alpha t)\\cos(k_x x)\\cos(0) + 0 = k_x A \\exp(\\alpha t)\\cos(k_x x)$\n$\\frac{\\partial c}{\\partial y}\\Big|_{y=0} = \\frac{\\partial c_1}{\\partial y}\\Big|_{y=0} + \\frac{\\partial c_2}{\\partial y}\\Big|_{y=0} = -k_y A \\exp(\\alpha t)\\sin(k_x x)\\sin(0) + k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\cos(0) = k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)$\n\nNow, we evaluate $h(x,0,t)$:\n$h(x,0,t) = D_{xy} [k_x A \\exp(\\alpha t)\\cos(k_x x)] + D_y [k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)] - u_0\\sin(\\Omega t) [A \\exp(\\alpha t)\\sin(k_x x)] + \\kappa_b \\left(A \\exp(\\alpha t)\\sin(k_x x)\\right)^2$\n$h(x,0,t) = D_{xy} k_x A \\exp(\\alpha t)\\cos(k_x x) + D_y k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t) - u_0 \\sin(\\Omega t) A \\exp(\\alpha t)\\sin(k_x x) + \\kappa_b A^2 \\exp(2\\alpha t)\\sin^2(k_x x)$.\nThe problem denotes this function as $h(x,t)$ on $y=0$.\nWe now compile the two results into the required matrix format.\nFor compactness in the final answer, we can substitute the explicit expressions for $c_1$ and $c_2$ into the derived components for $f(x,y,t)$.\n\nThe final expression for $f(x,y,t)$ is the sum of three components:\n$f(x,y,t) = (\\text{terms from } c_1) + (\\text{terms from } c_2) + (\\text{reaction terms})$.\nLet's group by $A\\exp(\\alpha t)$ and $B\\exp(\\beta t)$:\n$f(x,y,t) = A\\exp(\\alpha t) \\Big(\\cdots\\Big) + B\\exp(\\beta t) \\Big(\\cdots\\Big) + k_2 c^2 + \\frac{k_m c}{K+c}$.\nThe expanded content of the parentheses is provided in the final answer.\nSimilarly, the terms for $h(x,t)$ are grouped.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n  A\\exp(\\alpha t) \\Big( (\\alpha+D_x k_x^2+D_y k_y^2) \\sin(k_x x)\\cos(k_y y) + u_0 k_x \\cos(\\Omega t)\\cos(k_x x)\\cos(k_y y) - u_0 k_y \\sin(\\Omega t)\\sin(k_x x)\\sin(k_y y) + 2 D_{xy} k_x k_y \\cos(k_x x)\\sin(k_y y) \\Big) + B\\exp(\\beta t) \\Big( (\\beta+D_x (k_x')^2+D_y (k_y')^2) \\cos(k_x' x+\\omega t)\\sin(k_y' y) - (\\omega+u_0 k_x' \\cos(\\Omega t)) \\sin(k_x' x+\\omega t)\\sin(k_y' y) + u_0 k_y' \\sin(\\Omega t)\\cos(k_x' x+\\omega t)\\cos(k_y' y) + 2 D_{xy} k_x' k_y' \\sin(k_x' x+\\omega t)\\cos(k_y' y) \\Big) + k_2 c(x,y,t)^2 + \\frac{k_m c(x,y,t)}{K+c(x,y,t)} & A \\exp(\\alpha t) \\Big( D_{xy} k_x \\cos(k_x x) - u_0\\sin(\\Omega t)\\sin(k_x x) \\Big) + D_y k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t) + \\kappa_b A^2 \\exp(2\\alpha t)\\sin^2(k_x x)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}