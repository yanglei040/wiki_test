{
    "hands_on_practices": [
        {
            "introduction": "数值格式在离散偏微分方程时会引入误差，但这并非纯粹的数学抽象。修正方程分析（modified equation analysis）是一种强大的技术，它通过泰勒级数展开，揭示了数值格式在离散化过程中实际求解的、包含高阶导数项的“修正”偏微分方程。这项实践练习  将指导您推导一阶迎风格式的修正方程，并从中识别出由于离散化而产生的等效物理项——数值扩散，从而直观地理解其平滑效应的来源。",
            "id": "3575280",
            "problem": "一个一维被动示踪剂浓度场 $c(x,t)$ 在一个横截面均匀的直地球物理管道中，以一个稳定正速度 $u>0$ 被输运。其控制守恒律是线性平流偏微分方程 (PDE)\n$$\n\\frac{\\partial c}{\\partial t} + u\\,\\frac{\\partial c}{\\partial x} = 0,\n$$\n该方程在一个间距为 $\\Delta x$ 的均匀网格上求解。考虑一种采用一阶迎风数值通量的半离散有限体积法 (FVM)，对于单元平均未知量 $c_i(t) \\approx c(x_i,t)$，其线方法常微分方程为\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x},\n$$\n在 $u>0$ 的假设下，有 $F_{i+1/2} = u\\,c_i$ 和 $F_{i-1/2} = u\\,c_{i-1}$。\n\n仅使用基本级数展开，并一致地保留到二阶空间导数项，通过对 $c_{i-1}(t)$ 在 $x_i$ 处进行泰勒展开，执行修正方程分析，以推导该半离散格式在主阶上近似的连续偏微分方程。从所得修正方程中 $\\partial^2 c/\\partial x^2$ 项的系数，确定由一阶迎风离散化引起的有效数值扩散系数 $\\tilde{D}$。\n\n你的最终答案必须是 $\\tilde{D}$ 关于 $u$ 和 $\\Delta x$ 的单个闭式解析表达式。将有效扩散系数以 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 表示。不要使用任何预先制表的截断误差公式，并且除了此处描述的半离散格式外，不要假设任何特定的时间积分器。最终答案中不要包含任何中间量或辅助量。",
            "solution": "分析始于为一维线性平流方程提供的半离散有限体积法 (FVM) 公式。单元 $i$ 中单元平均浓度 $c_i(t)$ 的控制常微分方程 (ODE) 由线方法给出：\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x}\n$$\n问题指定了对于稳定正速度 $u>0$ 的一阶迎风数值通量。在单元交界面 $i+1/2$ 和 $i-1/2$ 处的通量为：\n$$\nF_{i+1/2} = u\\,c_i\n$$\n$$\nF_{i-1/2} = u\\,c_{i-1}\n$$\n将这些通量定义代入半离散 FVM 方程，得到 $c_i$ 演化的具体 ODE：\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{u\\,c_i - u\\,c_{i-1}}{\\Delta x} = -u \\frac{c_i - c_{i-1}}{\\Delta x}\n$$\n为了推导修正方程，我们将此方程中的离散量与连续浓度场 $c(x,t)$ 相关联。我们将 $c_i(t)$ 解释为连续函数在单元中心处的点值，即 $c_i(t) \\equiv c(x_i, t)$。左侧项 $\\frac{\\mathrm{d} c_i}{\\mathrm{d} t}$ 被视为在 $(x_i, t)$ 处求值的关于时间的偏导数 $\\frac{\\partial c}{\\partial t}$。项 $c_{i-1}(t)$ 代表相邻上游单元中心的浓度，该中心位置为 $x_{i-1} = x_i - \\Delta x$。我们使用泰勒级数展开来表示 $c_{i-1}(t) = c(x_i - \\Delta x, t)$，用其在位置 $x_i$ 的浓度及其空间导数来表示：\n$$\nc_{i-1} = c(x_i - \\Delta x, t) = c(x_i, t) - \\Delta x \\frac{\\partial c}{\\partial x}\\bigg|_{x_i} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 c}{\\partial x^2}\\bigg|_{x_i} - \\mathcal{O}((\\Delta x)^3)\n$$\n问题要求一致地保留到二阶空间导数项。因此，我们将此展开式代入我们半离散方程的右侧。为清晰起见，我们将省略显式的求值记号 $\\big|_{x_i}$，因为所有空间导数都默认在 $x_i$ 处求值。\n$$\n\\frac{\\partial c}{\\partial t} = -u \\frac{c_i - \\left( c_i - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^3) \\right)}{\\Delta x}\n$$\n简化括号内的分子：\n$$\nc_i - \\left( c_i - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^3) \\right) = \\Delta x \\frac{\\partial c}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3)\n$$\n现在，将这个简化后的表达式代回到关于 $\\frac{\\partial c}{\\partial t}$ 的方程中：\n$$\n\\frac{\\partial c}{\\partial t} = - \\frac{u}{\\Delta x} \\left( \\Delta x \\frac{\\partial c}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3) \\right)\n$$\n将因子 $-u/\\Delta x$ 分配到括号中的各项，得到：\n$$\n\\frac{\\partial c}{\\partial t} = -u \\frac{\\partial c}{\\partial x} + u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^2)\n$$\n这就是修正方程，它代表了该半离散格式在主阶上实际求解的连续偏微分方程。我们可以重新整理这个方程，以更好地看出它与原始 PDE 的关系：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^2)\n$$\n左侧是原始的线性平流方程 $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0$。出现在右侧的主阶截断误差项是 $u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2}$。该项具有扩散（或耗散）项的数学形式。平流-扩散方程的一般形式是：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = D \\frac{\\partial^2 c}{\\partial x^2}\n$$\n其中 $D$ 是扩散系数。通过将修正方程与一般的平流-扩散方程进行比较，我们可以确定由空间离散化格式引起的有效数值扩散系数，记为 $\\tilde{D}$。\n在我们推导出的修正方程中，乘以 $\\frac{\\partial^2 c}{\\partial x^2}$ 项的系数是 $u \\frac{\\Delta x}{2}$。因此，有效数值扩散系数是：\n$$\n\\tilde{D} = \\frac{u \\Delta x}{2}\n$$\n这个量在数值模拟中会产生不利影响，因为它会在浓度场中引入人为的抹平或扩散，导致尖锐梯度变得模糊，这是一阶迎风格式的一个众所周知的特性。",
            "answer": "$$\\boxed{\\frac{u \\Delta x}{2}}$$"
        },
        {
            "introduction": "现实世界中的地球物理输运过程通常涉及多个物理过程的同时作用，如平流、扩散和化学反应。算子分裂法是一种高效的“分而治之”策略，它将复杂的耦合问题分解为一系列更简单的子问题进行顺序求解。然而，子问题求解的顺序对整个方案的精度和稳定性至关重要，尤其是在处理具有刚性的非线性反应项时。这项实践练习  要求您基于质量守恒、正定性、精度阶数和稳定性等基本原则，为一个复杂的平流-扩散-反应系统选择并论证最优的算子分裂组合方案。",
            "id": "3575260",
            "problem": "考虑一个单组分示踪剂浓度场 $c(\\mathbf{x}, t)$，它在有界利普希茨 (Lipschitz) 域 $\\Omega \\subset \\mathbb{R}^d$ 上，在平流、扩散和非线性反应的共同作用下演化，由偏微分方程 (PDE) 控制\n$$\n\\partial_t c + \\nabla \\cdot \\left( \\mathbf{u} \\, c \\right) = \\nabla \\cdot \\left( \\mathbf{K} \\nabla c \\right) + R(c),\n$$\n边界条件为 $\\partial \\Omega$ 上的 $\\mathbf{u} \\cdot \\mathbf{n} = 0$ 和 $\\mathbf{K} \\nabla c \\cdot \\mathbf{n} = 0$，其中 $\\mathbf{u}(\\mathbf{x}, t)$ 是一个给定的速度场，$\\mathbf{K}(\\mathbf{x})$ 是一个对称正定扩散张量，$R(c)$ 是一个局部利普希茨非线性反应项。假设在 $\\Omega$ 中 $\\nabla \\cdot \\mathbf{u} = 0$，$R(0) \\ge 0$，并且对于任意初始数据 $c_0(\\mathbf{x}) \\ge 0$，常微分方程 (ODE) $\\partial_t y = R(y)$ 在 $t \\ge 0$ 时保持非负性。\n\n通过在长度为 $\\Delta t > 0$ 的时间间隔上的子问题来定义算子 $A$、$D$ 和 $R$：\n- 平流：$\\partial_t c + \\nabla \\cdot (\\mathbf{u} c) = 0$，\n- 扩散：$\\partial_t c = \\nabla \\cdot (\\mathbf{K} \\nabla c)$，\n- 反应：$\\partial_t c = R(c)$。\n\n令 $S_A(\\tau)$、$S_D(\\tau)$ 和 $S_R(\\tau)$ 分别表示平流、扩散和反应子问题在时间 $\\tau$ 内的精确子流。假设每个子流都由一个数值子求解器近似，该求解器具有以下性质：\n- 对于平流：在所述边界条件下是守恒和保正的。\n- 对于扩散：在所述边界条件下是守恒和保正的。\n- 对于反应：对于刚性 $R(c)$ 是保正和无条件稳定的。\n\n仅使用基本守恒原理和子流的生成元属性，选择一个大小为 $\\Delta t$ 的单时间步上的算子分裂组合，该组合满足：\n- 对平流-扩散子动力学（即当 $R \\equiv 0$ 时）保持总质量守恒，\n- 在 $c(\\mathbf{x}, 0) \\ge 0$ 的条件下保持 $c$ 的非负性，\n- 在 $R \\equiv 0$ 的特殊情况下，相对于平流-扩散对易子达到 2 阶精度，\n- 以与稳定性一致的方式处理潜在的刚性反应。\n\n选择最合适的分裂序列：\n\nA. $S_R(\\Delta t)\\, S_D(\\Delta t)\\, S_A(\\Delta t)$\n\nB. $S_A(\\Delta t/2)\\, S_D(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)\\, S_A(\\Delta t/2)$\n\nC. $S_R(\\Delta t/2)\\, S_D(\\Delta t)\\, S_A(\\Delta t)\\, S_R(\\Delta t/2)$\n\nD. $S_A(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)$\n\n给出你的选择并从第一性原理出发进行论证，明确引用通过散度定理得到的质量守恒、通过极值原理和流属性得到的保正性，以及非对易生成元组合对精度阶数的影响。",
            "solution": "用户提供了一个关于为平流-扩散-反应偏微分方程选择合适的算子分裂数值格式的问题。我将首先验证问题陈述，然后进行完整解答。\n\n### 第 1 步：提取已知条件\n问题陈述提供了以下信息：\n- **控制 PDE：** $\\partial_t c + \\nabla \\cdot \\left( \\mathbf{u} \\, c \\right) = \\nabla \\cdot \\left( \\mathbf{K} \\nabla c \\right) + R(c)$\n- **区域：** 一个有界利普希茨域 $\\Omega \\subset \\mathbb{R}^d$。\n- **未知量：** $c(\\mathbf{x}, t)$，一个示踪剂浓度场。\n- **系数和项：**\n    - $\\mathbf{u}(\\mathbf{x}, t)$：一个给定的速度场。\n    - $\\mathbf{K}(\\mathbf{x})$：一个对称正定扩散张量。\n    - $R(c)$：一个局部利普希茨非线性反应项。\n- **边界条件：** 在边界 $\\partial \\Omega$ 上，$\\mathbf{u} \\cdot \\mathbf{n} = 0$ 和 $\\mathbf{K} \\nabla c \\cdot \\mathbf{n} = 0$。\n- **假设：**\n    - 在 $\\Omega$ 中 $\\nabla \\cdot \\mathbf{u} = 0$。\n    - $R(0) \\ge 0$。\n    - ODE $\\partial_t y = R(y)$ 对初始数据 $y(0) \\ge 0$ 保持非负性。\n- **算子定义：** 问题被分解为三个子问题：\n    - 平流 $(A)$：$\\partial_t c + \\nabla \\cdot (\\mathbf{u} c) = 0$，精确流为 $S_A(\\tau)$。\n    - 扩散 $(D)$：$\\partial_t c = \\nabla \\cdot (\\mathbf{K} \\nabla c)$，精确流为 $S_D(\\tau)$。\n    - 反应 $(R)$：$\\partial_t c = R(c)$，精确流为 $S_R(\\tau)$。\n- **数值子求解器属性：** 子流的数值近似具有以下性质：\n    - 平流求解器：守恒且保正。\n    - 扩散求解器：守恒且保正。\n    - 反应求解器：保正且对刚性 $R(c)$ 无条件稳定。\n- **组合格式所需属性：**\n    1.  对平流-扩散子动力学（$R \\equiv 0$）保持总质量守恒。\n    2.  当 $c(\\mathbf{x}, 0) \\ge 0$ 时保持 $c$ 的非负性。\n    3.  在 $R \\equiv 0$ 的情况下，相对于平流-扩散对易子达到 2 阶精度。\n    4.  以与稳定性一致的方式处理潜在的刚性反应。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题陈述在科学上和数学上是合理的。\n- **科学依据：** 平流-扩散-反应方程是许多 STEM 学科（包括计算地球物理学）中的基本模型。给定的条件（不可压缩性、无通量边界、反应项的性质）都是标准的并且具有物理意义。\n- **适定性：** 问题是适定的。它描述了一个抛物型 PDE 的标准初边值问题，并要求基于算子分裂的既定原则选择一个合适的数值方法。选择标准清晰，是数值分析中的标准。\n- **客观性：** 语言正式、精确、客观。\n- **完整性：** 问题提供了在选项中做出合理选择所需的所有信息。子求解器的属性和最终格式的要求都已明确说明。\n- **一致性：** 内部没有矛盾。\n\n### 第 3 步：结论与行动\n该问题是有效的。我将继续推导解答。\n\n### 解答推导\n\n任务是选择满足四个不同要求的算子分裂组合。我们将根据提供的选项分析每个要求。令 $c^n$ 为时间 $t_n$ 处的数值解。目标是找到算子 $S_A$、$S_D$ 和 $S_R$ 的一个组合，以计算在时间 $t_{n+1} = t_n + \\Delta t$ 处的 $c^{n+1}$。\n\n**要求 1：质量守恒（对于 $R \\equiv 0$）**\n示踪剂的总质量为 $M(t) = \\int_{\\Omega} c(\\mathbf{x}, t) \\, d\\mathbf{x}$。平流-扩散系统的总质量变化率为：\n$$\n\\frac{dM}{dt} = \\int_{\\Omega} \\partial_t c \\, d\\mathbf{x} = \\int_{\\Omega} \\left[ - \\nabla \\cdot (\\mathbf{u}c) + \\nabla \\cdot (\\mathbf{K} \\nabla c) \\right] d\\mathbf{x}\n$$\n使用散度定理，我们将体积分转换成面积分：\n$$\n\\frac{dM}{dt} = \\int_{\\partial\\Omega} \\left[ - (\\mathbf{u}c) \\cdot \\mathbf{n} + (\\mathbf{K} \\nabla c) \\cdot \\mathbf{n} \\right] dS\n$$\n边界条件为 $\\mathbf{u} \\cdot \\mathbf{n} = 0$ 和 $\\mathbf{K} \\nabla c \\cdot \\mathbf{n} = 0$。将这些代入积分得到：\n$$\n\\frac{dM}{dt} = \\int_{\\partial\\Omega} \\left[ - c(\\mathbf{u} \\cdot \\mathbf{n}) + (\\mathbf{K} \\nabla c \\cdot \\mathbf{n}) \\right] dS = \\int_{\\partial\\Omega} [0 + 0] \\, dS = 0\n$$\n因此，精确的平流-扩散动力学是质量守恒的。问题陈述指出，用于平流的数值子求解器 $S_A(\\tau)$ 和用于扩散的 $S_D(\\tau)$ 都是守恒的。守恒算子的任意组合也是守恒的。由于当 $R \\equiv 0$ 时，所有选项都是 $S_A$ 和 $S_D$ 的组合，因此所有四个选项都满足此要求。\n\n**要求 2：保正性**\n我们已知初始数据是非负的，$c(\\mathbf{x}, 0) \\ge 0$。平流、扩散（在无通量边界下）以及给定的反应动力学等物理过程已知会保持非负性。问题明确指出，数值子求解器 $S_A(\\tau)$、$S_D(\\tau)$ 和 $S_R(\\tau)$ 都是保正的。保正算子的组合本身也是保正的。因此，所有四个选项都满足此要求。\n\n**要求 3：平流-扩散的二阶精度（$R \\equiv 0$）**\n这是一个区分不同格式的关键要求。算子分裂格式的总体精度取决于它如何近似算子和的指数。令平流和扩散问题分别由算子 $A_{op}$ 和 $D_{op}$ 生成，使得 $\\partial_t c = (A_{op} + D_{op})c$。\n- 一阶分裂（戈杜诺夫 (Godunov) 分裂）的形式为 $S_D(\\Delta t)S_A(\\Delta t)$。局部截断误差为 $O(\\Delta t^2)$，导致全局误差为 $O(\\Delta t)$。这是一个一阶精度格式。主误差项与对易子 $[A_{op}, D_{op}] = A_{op}D_{op} - D_{op}A_{op}$ 成正比。\n- 二阶分裂（斯特朗 (Strang) 分裂）是一种对称组合，例如 $S_A(\\Delta t/2)S_D(\\Delta t)S_A(\\Delta t/2)$。这种形式抵消了主误差项，得到局部截断误差 $O(\\Delta t^3)$ 和全局误差 $O(\\Delta t^2)$。\n\n我们针对 $R \\equiv 0$ 的情况分析每个选项，此时反应子流 $S_R(\\tau)$ 是单位算子 $I$。\n- **选项 A：** $S_R(\\Delta t) S_D(\\Delta t) S_A(\\Delta t) \\to I \\, S_D(\\Delta t) S_A(\\Delta t) = S_D(\\Delta t) S_A(\\Delta t)$。这是一阶戈杜诺夫分裂。不满足要求。\n- **选项 B：** $S_A(\\Delta t/2) S_D(\\Delta t/2) S_R(\\Delta t) S_D(\\Delta t/2) S_A(\\Delta t/2) \\to S_A(\\Delta t/2) S_D(\\Delta t/2) I S_D(\\Delta t/2) S_A(\\Delta t/2)$。这简化为 $S_A(\\Delta t/2) S_D(\\Delta t/2) S_D(\\Delta t/2) S_A(\\Delta t/2)$。因为扩散算子是线性的，连续应用其流等效于应用时间总和的流：$S_D(\\tau_1)S_D(\\tau_2) = S_D(\\tau_1+\\tau_2)$。因此，该格式变为 $S_A(\\Delta t/2) S_D(\\Delta t) S_A(\\Delta t/2)$。这是经典的二阶斯特朗分裂。满足要求。\n- **选项 C：** $S_R(\\Delta t/2) S_D(\\Delta t) S_A(\\Delta t) S_R(\\Delta t/2) \\to I S_D(\\Delta t) S_A(\\Delta t) I = S_D(\\Delta t) S_A(\\Delta t)$。这是一阶戈杜诺夫分裂。不满足要求。\n- **选项 D：** $S_A(\\Delta t/2) S_R(\\Delta t) S_D(\\Delta t/2) \\to S_A(\\Delta t/2) I S_D(\\Delta t/2) = S_A(\\Delta t/2) S_D(\\Delta t/2)$。这是一个非对称的顺序分裂，是一阶精度的。不满足要求。\n\n基于精度，只有选项 B 是可行的。\n\n**要求 4：刚性反应的稳定处理**\n刚性 ODE 系统要求数值方法在步长 $\\Delta t$ 远大于系统最快时间尺度时仍保持稳定。问题指出 $S_R(\\tau)$ 的反应子求解器是无条件稳定的（例如，一个隐式方法）。在算子分裂中，标准做法是与处理非刚性分量不同地处理刚性分量。\n一种常见且稳健的策略是将非刚性算子分组，并将其对称地分裂在刚性算子周围，而刚性算子则在整个时间步 $\\Delta t$ 上进行积分。这避免了分裂刚性部分（可能会损害稳定性或效率），并保持了对称分裂的整体结构。\n让我们基于此原则评估各个选项。\n- **选项 A：** $S_R(\\Delta t)\\, S_D(\\Delta t)\\, S_A(\\Delta t)$。它对 $R$ 在整个步长 $\\Delta t$ 上积分，这对刚性问题有利，但该格式仅为一阶精度。\n- **选项 B：** $S_A(\\Delta t/2)\\, S_D(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)\\, S_A(\\Delta t/2)$。该格式将刚性反应项 $R$ 在整个时间步 $\\Delta t$ 上积分，并将其置于非刚性平流和扩散算子的对称（回文）序列中间。这是一个优秀且广泛使用的策略。它将非刚性部分的二阶精度与对刚性部分的稳定处理相结合。这是斯特朗-马丘克 (Strang-Marchuk) 分裂的一种形式。\n- **选项 C：** $S_R(\\Delta t/2)\\, S_D(\\Delta t)\\, S_A(\\Delta t)\\, S_R(\\Delta t/2)$。该格式分裂了刚性算子 $R$，每个时间步需要对刚性系统求解两次。这通常比在单一步骤中积分刚性部分效率更低且可能更不稳定。\n- **选项 D：** $S_A(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)$。这是一个非对称格式。虽然它对 $R$ 在整个 $\\Delta t$ 上积分，但缺乏对称性使其成为一阶精度，未能满足要求 3。\n\n### 逐项分析\n\n- **A. $S_R(\\Delta t)\\, S_D(\\Delta t)\\, S_A(\\Delta t)$**：该格式是质量守恒和保正的。然而，它仅为一阶精度，未能满足要求 3。**不正确**。\n\n- **B. $S_A(\\Delta t/2)\\, S_D(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)\\, S_A(\\Delta t/2)$**：该格式是质量守恒和保正的。对于 $R \\equiv 0$，它简化为二阶斯特朗分裂 $S_A(\\Delta t/2) S_D(\\Delta t) S_A(\\Delta t/2)$，满足要求 3。它还以标准、稳定的方式处理刚性反应项，即在整个步长 $\\Delta t$ 内在一个对称组合中积分，满足要求 4。这是一个优秀且广泛使用的策略。**正确**。\n\n- **C. $S_R(\\Delta t/2)\\, S_D(\\Delta t)\\, S_A(\\Delta t)\\, S_R(\\Delta t/2)$**：该格式是质量守恒和保正的。它是一种形式为 $S_R-S_{DA}-S_R$ 的对称组合。然而，对于 $R \\equiv 0$，它简化为一阶格式 $S_D(\\Delta t) S_A(\\Delta t)$，未能满足要求 3。它还分裂了刚性算子，这通常不是最优的。**不正确**。\n\n- **D. $S_A(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)$**：该格式是质量守恒和保正的。它是一个非对称组合，因此仅为一阶精度，未能满足要求 3。**不正确**。\n\n总之，只有选项 B 满足问题陈述中列出的所有四个要求。它为性质良好的平流-扩散部分提供了二阶精度，同时以稳健和稳定的方式处理了刚性反应项。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在开发了一个复杂的数值求解器后，我们如何确保代码的实现是正确的？由于大多数实际问题的解析解是未知的，直接比较变得不可能，这时代码验证就显得至关重要。制造解方法（Method of Manufactured Solutions, MMS）是代码验证的黄金标准，它通过“制造”一个解析解，并将其代入控制方程以反解出所需的人为源项和边界条件。这项实践练习  将带您完整地经历这一过程，为一个具有时变速度场、各向异性扩散和非线性反应的复杂二维输运模型，推导其内部源项和边界通量，为验证数值代码的正确性奠定坚实基础。",
            "id": "3575306",
            "problem": "在饱和多孔介质中，一个二维（$2$-D）溶质浓度场 $c(x,y,t)$ 可由根据质量守恒和 Fickian 弥散推导出的平流-扩散-反应偏微分方程（PDE）建模，\n$$\\frac{\\partial c}{\\partial t} + \\boldsymbol{u}(t)\\cdot \\nabla c \\;=\\; \\nabla\\cdot\\!\\big(\\boldsymbol{D}\\,\\nabla c\\big) \\;-\\; R(c) \\;+\\; f(x,y,t)\\quad \\text{在}\\;\\Omega\\times(0,T],$$\n并附带一个由混合动力学-通量关系推导出的非线性反应 Robin 边界条件，\n$$\\boldsymbol{n}\\cdot\\!\\big(-\\boldsymbol{D}\\,\\nabla c + \\boldsymbol{u}(t)\\,c\\big) \\;+\\; \\kappa_{b}\\,c^{2} \\;=\\; h(x,y,t)\\quad \\text{在}\\;\\partial\\Omega\\times(0,T].$$\n此处 $\\Omega=(0,L_{x})\\times(0,L_{y})$ 是一个矩形区域，$\\boldsymbol{n}$ 是单位外法线，$\\boldsymbol{u}(t)$ 是一个空间均匀、无散度的速度，$\\boldsymbol{D}$ 是一个常数对称正定各向异性弥散张量，$R(c)$ 是一个非线性反应速率，$f$ 是一个体积源，$h$ 是一个边界数据函数。为了使用制造解方法（MMS）进行代码验证，请考虑以下参数化族（“套件”）的制造解和系数：\n- 具有随时间变化方向的速度，\n$$\\boldsymbol{u}(t) \\;=\\; \\begin{pmatrix} u_{0}\\,\\cos(\\Omega t) \\\\ u_{0}\\,\\sin(\\Omega t) \\end{pmatrix},$$\n- 各向异性弥散张量，\n$$\\boldsymbol{D} \\;=\\; \\begin{pmatrix} D_{x}  D_{xy} \\\\ D_{xy}  D_{y} \\end{pmatrix},\\quad D_{x}0,\\;D_{y}0,\\;D_{x}D_{y}-D_{xy}^{2}0,$$\n- 非线性反应，\n$$R(c) \\;=\\; k_{2}\\,c^{2} \\;+\\; \\frac{k_{m}\\,c}{K + c},$$\n- 制造的浓度场，\n$$c(x,y,t) \\;=\\; A\\,\\exp(\\alpha t)\\,\\sin(k_{x} x)\\,\\cos(k_{y} y) \\;+\\; B\\,\\exp(\\beta t)\\,\\cos(k_{x}' x + \\omega t)\\,\\sin(k_{y}' y),$$\n其中常数 $A,B,\\alpha,\\beta,k_{x},k_{y},k_{x}',k_{y}',\\omega,u_{0},\\Omega,D_{x},D_{y},D_{xy},k_{2},k_{m},K,\\kappa_{b}$ 被视为满足所述正定性和确定性条件的任意但固定的实数参数。将所有三角函数的参数解释为弧度。\n\n仅从质量守恒、平流通量和扩散通量的定义以及上述定义出发，推导内部强迫项 $f(x,y,t)$ 的显式解析表达式，使 $c(x,y,t)$ 成为 PDE 在内部的精确解。此外，推导底部边界 $y=0$ 上的反应性 Robin 边界数据 $h(x,t)$ 的显式解析表达式，使 $c(x,y,t)$ 在该处满足边界条件。\n\n使用 $\\texttt{pmatrix}$ 环境，将您的最终答案表示为一个包含两个条目的行矩阵，第一个条目等于 $f(x,y,t)$，第二个条目等于在 $y=0$ 处求值的 $h(x,t)$。无需进行数值计算，也无需单位。",
            "solution": "该问题要求推导内部源项 $f(x,y,t)$ 和底部边界 $y=0$ 上的边界数据函数 $h(x,t)$，使得给定的制造解 $c(x,y,t)$ 成为所提供的偏微分方程（PDE）和边界条件（BC）的精确解。这是使用制造解方法（MMS）进行代码验证的一个标准流程。\n\n制造解由下式给出\n$$c(x,y,t) = A\\,\\exp(\\alpha t)\\,\\sin(k_{x} x)\\,\\cos(k_{y} y) + B\\,\\exp(\\beta t)\\,\\cos(k_{x}' x + \\omega t)\\,\\sin(k_{y}' y)$$\n我们将这两项分别表示为 $c_1(x,y,t)$ 和 $c_2(x,y,t)$：\n$c_1(x,y,t) = A\\,\\exp(\\alpha t)\\,\\sin(k_{x} x)\\,\\cos(k_{y} y)$\n$c_2(x,y,t) = B\\,\\exp(\\beta t)\\,\\cos(k_{x}' x + \\omega t)\\,\\sin(k_{y}' y)$\n使得 $c = c_1 + c_2$。\n\n**第一部分：内部源项 $f(x,y,t)$ 的推导**\n\nPDE 给出如下：\n$$\\frac{\\partial c}{\\partial t} + \\boldsymbol{u}(t)\\cdot \\nabla c \\;=\\; \\nabla\\cdot\\!\\big(\\boldsymbol{D}\\,\\nabla c\\big) \\;-\\; R(c) \\;+\\; f(x,y,t)$$\n源项 $f(x,y,t)$ 可以被分离出来：\n$$f(x,y,t) = \\frac{\\partial c}{\\partial t} + \\boldsymbol{u}(t)\\cdot \\nabla c - \\nabla\\cdot\\!\\big(\\boldsymbol{D}\\,\\nabla c\\big) + R(c)$$\n为求得 $f(x,y,t)$，我们必须通过代入制造解 $c(x,y,t)$ 来计算右侧的每一项。\n\n**1. 时间导数 $\\frac{\\partial c}{\\partial t}$**:\n$\\frac{\\partial c_1}{\\partial t} = \\alpha A \\exp(\\alpha t) \\sin(k_x x)\\cos(k_y y) = \\alpha c_1$\n$\\frac{\\partial c_2}{\\partial t} = \\beta B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\sin(k_y' y) + B \\exp(\\beta t)(-\\sin(k_x' x + \\omega t))(\\omega)\\sin(k_y' y) = \\beta c_2 - \\omega B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y)$\n$\\frac{\\partial c}{\\partial t} = \\frac{\\partial c_1}{\\partial t} + \\frac{\\partial c_2}{\\partial t} = \\alpha c_1 + \\beta c_2 - \\omega B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y)$\n\n**2. 梯度 $\\nabla c$**:\n$\\frac{\\partial c_1}{\\partial x} = k_x A \\exp(\\alpha t)\\cos(k_x x)\\cos(k_y y)$\n$\\frac{\\partial c_1}{\\partial y} = -k_y A \\exp(\\alpha t)\\sin(k_x x)\\sin(k_y y)$\n$\\frac{\\partial c_2}{\\partial x} = -k_x' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y)$\n$\\frac{\\partial c_2}{\\partial y} = k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\cos(k_y' y)$\n$\\nabla c = \\begin{pmatrix} \\frac{\\partial c_1}{\\partial x} + \\frac{\\partial c_2}{\\partial x} \\\\ \\frac{\\partial c_1}{\\partial y} + \\frac{\\partial c_2}{\\partial y} \\end{pmatrix}$\n\n**3. 平流项 $\\boldsymbol{u}(t)\\cdot \\nabla c$**:\n对于 $\\boldsymbol{u}(t) = (u_0\\cos(\\Omega t), u_0\\sin(\\Omega t))^T$:\n$\\boldsymbol{u}\\cdot\\nabla c = u_0\\cos(\\Omega t)\\left(\\frac{\\partial c_1}{\\partial x} + \\frac{\\partial c_2}{\\partial x}\\right) + u_0\\sin(\\Omega t)\\left(\\frac{\\partial c_1}{\\partial y} + \\frac{\\partial c_2}{\\partial y}\\right)$\n\n**4. 扩散项 $\\nabla\\cdot(\\boldsymbol{D}\\,\\nabla c)$**:\n由于 $\\boldsymbol{D}$ 是一个常数张量，$\\nabla\\cdot(\\boldsymbol{D}\\nabla c) = D_x \\frac{\\partial^2 c}{\\partial x^2} + D_y \\frac{\\partial^2 c}{\\partial y^2} + 2D_{xy} \\frac{\\partial^2 c}{\\partial x \\partial y}$。我们计算二阶导数：\n$\\frac{\\partial^2 c_1}{\\partial x^2} = -k_x^2 c_1$, $\\frac{\\partial^2 c_1}{\\partial y^2} = -k_y^2 c_1$, $\\frac{\\partial^2 c_1}{\\partial x \\partial y} = -k_x k_y A \\exp(\\alpha t)\\cos(k_x x)\\sin(k_y y)$\n$\\frac{\\partial^2 c_2}{\\partial x^2} = -(k_x')^2 c_2$, $\\frac{\\partial^2 c_2}{\\partial y^2} = -(k_y')^2 c_2$, $\\frac{\\partial^2 c_2}{\\partial x \\partial y} = -k_x' k_y' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\cos(k_y' y)$\n\n所以，$\\nabla\\cdot(\\boldsymbol{D}\\nabla c_1) = -D_x k_x^2 c_1 - D_y k_y^2 c_1 - 2D_{xy} k_x k_y A \\exp(\\alpha t)\\cos(k_x x)\\sin(k_y y)$\n且 $\\nabla\\cdot(\\boldsymbol{D}\\nabla c_2) = -D_x (k_x')^2 c_2 - D_y (k_y')^2 c_2 - 2D_{xy} k_x' k_y' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\cos(k_y' y)$。\n\n**5. 反应项 $R(c)$**:\n$R(c) = k_2 c^2 + \\frac{k_m c}{K+c}$，其中 $c=c_1+c_2$。\n\n**6. 组装 $f(x,y,t)$**:\n$f(x,y,t) = \\left( \\frac{\\partial c_1}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla c_1 - \\nabla\\cdot(\\boldsymbol{D}\\nabla c_1) \\right) + \\left( \\frac{\\partial c_2}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla c_2 - \\nabla\\cdot(\\boldsymbol{D}\\nabla c_2) \\right) + R(c)$\n\n我们来组装 $c_1$ 的部分：\n$(\\alpha c_1) + \\big( u_0\\cos(\\Omega t) k_x A \\exp(\\alpha t)\\cos(k_x x)\\cos(k_y y) - u_0\\sin(\\Omega t) k_y A \\exp(\\alpha t)\\sin(k_x x)\\sin(k_y y) \\big) - \\big( -D_x k_x^2 c_1 - D_y k_y^2 c_1 - 2D_{xy} k_x k_y A \\exp(\\alpha t)\\cos(k_x x)\\sin(k_y y) \\big)$\n$= (\\alpha + D_x k_x^2 + D_y k_y^2) c_1 + A \\exp(\\alpha t) \\left[ u_0 k_x \\cos(\\Omega t)\\cos(k_x x)\\cos(k_y y) - u_0 k_y \\sin(\\Omega t)\\sin(k_x x)\\sin(k_y y) + 2D_{xy} k_x k_y \\cos(k_x x)\\sin(k_y y) \\right]$\n\n以及 $c_2$ 的部分：\n$(\\beta c_2 - \\omega B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y)) + \\big( -u_0\\cos(\\Omega t) k_x' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\sin(k_y' y) + u_0\\sin(\\Omega t) k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\cos(k_y' y) \\big) - \\big( -D_x (k_x')^2 c_2 - D_y (k_y')^2 c_2 - 2D_{xy} k_x' k_y' B \\exp(\\beta t)\\sin(k_x' x + \\omega t)\\cos(k_y' y) \\big)$\n$= (\\beta + D_x (k_x')^2 + D_y (k_y')^2) c_2 + B \\exp(\\beta t) \\left[ -(\\omega + u_0 k_x' \\cos(\\Omega t))\\sin(k_x' x + \\omega t)\\sin(k_y' y) + u_0 k_y' \\sin(\\Omega t)\\cos(k_x' x + \\omega t)\\cos(k_y' y) + 2D_{xy} k_x' k_y' \\sin(k_x' x + \\omega t)\\cos(k_y' y) \\right]$\n\n将这些部分和 $R(c)$ 相加，得到 $f(x,y,t)$ 的最终表达式。\n\n**第二部分：在 $y=0$ 上的边界数据 $h(x,t)$ 的推导**\n\nRobin 边界条件为：\n$$\\boldsymbol{n}\\cdot\\!\\big(-\\boldsymbol{D}\\,\\nabla c + \\boldsymbol{u}(t)\\,c\\big) \\;+\\; \\kappa_{b}\\,c^{2} \\;=\\; h(x,y,t)$$\n在底部边界 $y=0$ 上，单位外法线为 $\\boldsymbol{n} = (0,-1)^T$。\n所以，$h(x,0,t) = (0,-1)\\cdot(-\\boldsymbol{D}\\nabla c + \\boldsymbol{u}c) + \\kappa_b c^2 \\bigg|_{y=0}$\n设 $\\boldsymbol{F} = -\\boldsymbol{D}\\nabla c + \\boldsymbol{u}c$ 为总通量。那么 $h(x,0,t) = -F_y|_{y=0} + \\kappa_b c^2|_{y=0}$ 是不正确的，应该是 $\\boldsymbol{n} \\cdot \\mathbf{F} = -F_y$。\n$h(x,0,t) = -F_y|_{y=0} + \\kappa_b c^2|_{y=0}$。\n通量的 y-分量为 $F_y = -(D_{xy}\\frac{\\partial c}{\\partial x} + D_y\\frac{\\partial c}{\\partial y}) + u_y(t) c$。\n\n我们在 $y=0$ 处计算所需各项：\n$c_1(x,0,t) = A \\exp(\\alpha t)\\sin(k_x x)\\cos(0) = A \\exp(\\alpha t)\\sin(k_x x)$\n$c_2(x,0,t) = B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\sin(0) = 0$\n因此，$c(x,0,t) = A \\exp(\\alpha t)\\sin(k_x x)$。\n\n在 $y=0$ 处的导数：\n$\\frac{\\partial c}{\\partial x}\\Big|_{y=0} = \\frac{\\partial c_1}{\\partial x}\\Big|_{y=0} + \\frac{\\partial c_2}{\\partial x}\\Big|_{y=0} = k_x A \\exp(\\alpha t)\\cos(k_x x)\\cos(0) + 0 = k_x A \\exp(\\alpha t)\\cos(k_x x)$\n$\\frac{\\partial c}{\\partial y}\\Big|_{y=0} = \\frac{\\partial c_1}{\\partial y}\\Big|_{y=0} + \\frac{\\partial c_2}{\\partial y}\\Big|_{y=0} = -k_y A \\exp(\\alpha t)\\sin(k_x x)\\sin(0) + k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)\\cos(0) = k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)$\n\n现在，我们在 $y=0$ 处计算 $-F_y$：\n$-F_y|_{y=0} = (D_{xy}\\frac{\\partial c}{\\partial x} + D_y\\frac{\\partial c}{\\partial y}) - u_y(t) c \\Big|_{y=0}$\n$-F_y|_{y=0} = \\left( D_{xy} [k_x A \\exp(\\alpha t)\\cos(k_x x)] + D_y [k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t)] \\right) - u_0\\sin(\\Omega t) [A \\exp(\\alpha t)\\sin(k_x x)]$\n$-F_y|_{y=0} = D_{xy} k_x A \\exp(\\alpha t)\\cos(k_x x) + D_y k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t) - u_0 \\sin(\\Omega t) A \\exp(\\alpha t)\\sin(k_x x)$\n\n最后，$h(x,0,t) = -F_y|_{y=0} + \\kappa_b c^2|_{y=0}$：\n$h(x,0,t) = D_{xy} k_x A \\exp(\\alpha t)\\cos(k_x x) + D_y k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t) - u_0 \\sin(\\Omega t) A \\exp(\\alpha t)\\sin(k_x x) + \\kappa_b \\left(A \\exp(\\alpha t)\\sin(k_x x)\\right)^2$\n$h(x,0,t) = D_{xy} k_x A \\exp(\\alpha t)\\cos(k_x x) + D_y k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t) - u_0 \\sin(\\Omega t) A \\exp(\\alpha t)\\sin(k_x x) + \\kappa_b A^2 \\exp(2\\alpha t)\\sin^2(k_x x)$。\n该问题将此函数在 $y=0$ 上表示为 $h(x,t)$。\n我们现在将两个结果编译成所需的矩阵格式。\n为了最终答案的简洁性，我们可以将 $c_1$ 和 $c_2$ 的显式表达式代入到为 $f(x,y,t)$ 推导出的分量中。\n\n$f(x,y,t)$ 的最终表达式是三个分量的和：\n$f(x,y,t) = (来自 c_1 的项) + (来自 c_2 的项) + (反应项)$。\n让我们按 $A\\exp(\\alpha t)$ 和 $B\\exp(\\beta t)$ 分组：\n$f(x,y,t) = A\\exp(\\alpha t) \\Big(\\cdots\\Big) + B\\exp(\\beta t) \\Big(\\cdots\\Big) + k_2 c^2 + \\frac{k_m c}{K+c}$。\n括号内的展开内容在最终答案中给出。\n类似地，对 $h(x,t)$ 的各项进行分组。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n  A\\exp(\\alpha t) \\Big( (\\alpha+D_x k_x^2+D_y k_y^2) \\sin(k_x x)\\cos(k_y y) + u_0 k_x \\cos(\\Omega t)\\cos(k_x x)\\cos(k_y y) - u_0 k_y \\sin(\\Omega t)\\sin(k_x x)\\sin(k_y y) + 2 D_{xy} k_x k_y \\cos(k_x x)\\sin(k_y y) \\Big) + B\\exp(\\beta t) \\Big( (\\beta+D_x (k_x')^2+D_y (k_y')^2) \\cos(k_x' x+\\omega t)\\sin(k_y' y) - (\\omega+u_0 k_x' \\cos(\\Omega t)) \\sin(k_x' x+\\omega t)\\sin(k_y' y) + u_0 k_y' \\sin(\\Omega t)\\cos(k_x' x+\\omega t)\\cos(k_y' y) + 2 D_{xy} k_x' k_y' \\sin(k_x' x+\\omega t)\\cos(k_y' y) \\Big) + k_2 c(x,y,t)^2 + \\frac{k_m c(x,y,t)}{K+c(x,y,t)}  A \\exp(\\alpha t) \\Big( D_{xy} k_x \\cos(k_x x) - u_0\\sin(\\Omega t)\\sin(k_x x) \\Big) + D_y k_y' B \\exp(\\beta t)\\cos(k_x' x + \\omega t) + \\kappa_b A^2 \\exp(2\\alpha t)\\sin^2(k_x x)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}