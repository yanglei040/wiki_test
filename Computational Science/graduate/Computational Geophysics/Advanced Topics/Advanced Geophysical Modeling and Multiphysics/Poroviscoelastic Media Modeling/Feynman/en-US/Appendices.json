{
    "hands_on_practices": [
        {
            "introduction": "We begin with a foundational exercise to build physical intuition for coupled poroviscoelastic behavior. This problem challenges you to derive the time-dependent effective modulus of a simple material under two critical hydraulic limits: drained and undrained conditions. Mastering this analytical derivation solidifies the understanding of how pore pressure and solid viscosity interact to control the bulk response over time .",
            "id": "3613072",
            "problem": "Consider an isothermal, homogeneous, isotropic, fully saturated poroviscoelastic solid subjected to unconfined axial compression at small strain. The solid skeleton obeys a Kelvin–Voigt rheology in uniaxial form with drained uniaxial modulus $E$ and dashpot viscosity $\\eta_{s}$, so that the uniaxial effective stress $\\sigma^{\\prime}$ and the axial strain $\\epsilon_{z}$ satisfy $\\sigma^{\\prime}(t) = E\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\dot{\\epsilon}_{z}(t)$. Fluid–solid coupling follows the linear theory of Biot poroelasticity, with Biot coefficient $\\alpha$ and Biot modulus $M$. The total Cauchy stress in the axial direction is $\\sigma_{z}(t) = \\sigma^{\\prime}(t) - \\alpha\\,p(t)$, where $p(t)$ is the pore pressure. Adopt the standard poroelastic fluid content relation $\\zeta(t) = \\alpha\\,\\epsilon_{v}(t) + p(t)/M$, where $\\epsilon_{v}$ is the volumetric strain. The sample’s lateral surfaces are traction-free, and the skeleton has Poisson’s ratio equal to zero so that $\\epsilon_{x}(t) = \\epsilon_{y}(t) = 0$ and $\\epsilon_{v}(t) = \\epsilon_{z}(t)$. Inertia is neglected.\n\nAt time $t=0^{+}$, apply and hold a uniform compressive axial stress step $\\sigma_{z}(t) = -\\sigma_{0}\\,H(t)$ with $\\sigma_{0} > 0$ and $H(t)$ the Heaviside step function. Define the measured time-dependent effective (apparent) axial modulus as $E_{\\mathrm{eff}}(t) = -\\sigma_{z}(t)/\\epsilon_{z}(t)$.\n\nCompute, in closed analytic form, the two functions:\n- the undrained apparent modulus $E_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t)$ corresponding to the condition of no change in fluid content, $\\zeta(t) \\equiv 0$ for all $t \\ge 0$;\n- the drained apparent modulus $E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t)$ corresponding to vanishing pore pressure, $p(t) \\equiv 0$ for all $t \\ge 0$.\n\nExpress your final answer symbolically in terms of $E$, $\\eta_{s}$, $\\alpha$, $M$, and $t$. No numerical evaluation is required.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\nThe following relations and parameters are provided verbatim:\n- Solid skeleton rheology (uniaxial Kelvin-Voigt): $\\sigma^{\\prime}(t) = E\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\dot{\\epsilon}_{z}(t)$\n- Drained uniaxial modulus: $E$\n- Skeleton dashpot viscosity: $\\eta_{s}$\n- Total axial Cauchy stress: $\\sigma_{z}(t) = \\sigma^{\\prime}(t) - \\alpha\\,p(t)$\n- Biot coefficient: $\\alpha$\n- Pore pressure: $p(t)$\n- Biot modulus: $M$\n- Fluid content relation: $\\zeta(t) = \\alpha\\,\\epsilon_{v}(t) + p(t)/M$\n- Kinematic condition from zero Poisson's ratio: $\\epsilon_{v}(t) = \\epsilon_{z}(t)$\n- Applied stress: $\\sigma_{z}(t) = -\\sigma_{0}\\,H(t)$, where $\\sigma_{0} > 0$ and $H(t)$ is the Heaviside step function.\n- Apparent axial modulus definition: $E_{\\mathrm{eff}}(t) = -\\sigma_{z}(t)/\\epsilon_{z}(t)$\n- Condition for undrained response: $\\zeta(t) \\equiv 0$ for $t \\ge 0$\n- Condition for drained response: $p(t) \\equiv 0$ for $t \\ge 0$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the linear theory of poroviscoelasticity, a well-established field in continuum mechanics and geophysics. It combines the Kelvin-Voigt model for linear viscoelasticity and Biot's theory for linear poroelasticity. These are standard and widely used models. The setup describes a classical creep test.\n- **Well-Posed:** The problem is well-posed. The governing equations are linear ordinary differential equations with constant coefficients. For the specified step loading, a unique and stable solution for the strain $\\epsilon_{z}(t)$ exists. The two quantities to be computed are derived from this solution under two distinct and clearly defined physical limits (undrained and drained).\n- **Objective:** The problem statement is formulated using precise mathematical and physical terminology. All relationships are given as equations, and all terms are defined, leaving no room for subjective interpretation.\n- **Consistency and Completeness:** The problem is self-contained. The simplification arising from a zero Poisson's ratio ($\\epsilon_{v} = \\epsilon_{z}$) is explicitly stated and correctly applied, making the one-dimensional analysis consistent. All necessary parameters ($E$, $\\eta_s$, $\\alpha$, $M$) and relationships are provided to solve for the two requested apparent moduli.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Solution Derivation\n\nThe objective is to find the apparent axial modulus $E_{\\mathrm{eff}}(t) = -\\sigma_{z}(t)/\\epsilon_{z}(t)$ under both undrained and drained conditions. For $t > 0$, the applied stress is constant, $\\sigma_{z}(t) = -\\sigma_{0}$. Thus, the definition simplifies to $E_{\\mathrm{eff}}(t) = \\sigma_{0}/\\epsilon_{z}(t)$. The core of the problem is to find the axial strain response $\\epsilon_{z}(t)$ for each case.\n\n#### 1. Undrained Apparent Modulus, $E_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t)$\nThe undrained condition is characterized by zero change in fluid content, $\\zeta(t) = 0$. Using the fluid content relation with the kinematic simplification $\\epsilon_{v}(t) = \\epsilon_{z}(t)$:\n$$0 = \\alpha\\,\\epsilon_{z}(t) + \\frac{p(t)}{M}$$\nFrom this, we express the pore pressure $p(t)$ as a function of the axial strain $\\epsilon_{z}(t)$:\n$$p(t) = -M\\,\\alpha\\,\\epsilon_{z}(t)$$\nNext, we substitute this into the total stress definition:\n$$\\sigma_{z}(t) = \\sigma^{\\prime}(t) - \\alpha\\,(-M\\,\\alpha\\,\\epsilon_{z}(t)) = \\sigma^{\\prime}(t) + M\\,\\alpha^{2}\\,\\epsilon_{z}(t)$$\nNow, we replace the effective stress $\\sigma^{\\prime}(t)$ with the Kelvin-Voigt constitutive law:\n$$\\sigma_{z}(t) = \\left(E\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt}\\right) + M\\,\\alpha^{2}\\,\\epsilon_{z}(t)$$\nGrouping terms, we obtain the governing ordinary differential equation (ODE) for the strain $\\epsilon_{z}(t)$ under undrained conditions:\n$$\\sigma_{z}(t) = (E + M\\,\\alpha^{2})\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt}$$\nLet's define the undrained uniaxial modulus as $E_{u} = E + M\\,\\alpha^{2}$. For $t > 0$, $\\sigma_{z}(t) = -\\sigma_{0}$, so the ODE becomes:\n$$\\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt} + E_{u}\\,\\epsilon_{z}(t) = -\\sigma_{0}$$\nThis is a creep test scenario. The initial condition, enforced by the viscous element (dashpot) which cannot deform instantaneously, is $\\epsilon_{z}(0) = 0$. The solution to this first-order linear ODE is:\n$$\\epsilon_{z}(t) = -\\frac{\\sigma_{0}}{E_{u}}\\left(1 - \\exp\\left(-\\frac{E_{u}}{\\eta_{s}}t\\right)\\right)$$\nSubstituting back the expression for $E_{u}$:\n$$\\epsilon_{z}(t) = -\\frac{\\sigma_{0}}{E + M\\,\\alpha^{2}}\\left(1 - \\exp\\left(-\\frac{(E + M\\,\\alpha^{2})t}{\\eta_{s}}\\right)\\right)$$\nFinally, we compute the undrained apparent modulus:\n$$E_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t) = \\frac{\\sigma_{0}}{\\epsilon_{z}(t)} = \\frac{\\sigma_{0}}{-\\frac{\\sigma_{0}}{E + M\\,\\alpha^{2}}\\left(1 - \\exp\\left(-\\frac{(E + M\\,\\alpha^{2})t}{\\eta_{s}}\\right)\\right)}$$\n$$E_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t) = \\frac{E + M\\,\\alpha^{2}}{1 - \\exp\\left(-\\frac{(E + M\\,\\alpha^{2})t}{\\eta_{s}}\\right)}$$\n\n#### 2. Drained Apparent Modulus, $E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t)$\nThe drained condition is characterized by zero pore pressure, $p(t) = 0$.\nThe total stress definition becomes:\n$$\\sigma_{z}(t) = \\sigma^{\\prime}(t) - \\alpha(0) = \\sigma^{\\prime}(t)$$\nSubstituting the Kelvin-Voigt law directly for the total stress:\n$$\\sigma_{z}(t) = E\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt}$$\nFor $t > 0$, we have $\\sigma_{z}(t) = -\\sigma_{0}$. The governing ODE for the strain $\\epsilon_{z}(t)$ under drained conditions is:\n$$\\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt} + E\\,\\epsilon_{z}(t) = -\\sigma_{0}$$\nThis ODE is of the same form as the undrained case but with the drained modulus $E$ instead of $E_{u}$. The initial condition is again $\\epsilon_{z}(0)=0$. The solution is therefore:\n$$\\epsilon_{z}(t) = -\\frac{\\sigma_{0}}{E}\\left(1 - \\exp\\left(-\\frac{Et}{\\eta_{s}}\\right)\\right)$$\nThe drained apparent modulus is then:\n$$E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t) = \\frac{\\sigma_{0}}{\\epsilon_{z}(t)} = \\frac{\\sigma_{0}}{-\\frac{\\sigma_{0}}{E}\\left(1 - \\exp\\left(-\\frac{Et}{\\eta_{s}}\\right)\\right)}$$\n$$E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t) = \\frac{E}{1 - \\exp\\left(-\\frac{Et}{\\eta_{s}}\\right)}$$\nThe two requested functions have been derived in closed analytic form.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nE_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t) = \\frac{E + M\\,\\alpha^{2}}{1 - \\exp\\left(-\\frac{(E + M\\,\\alpha^{2})t}{\\eta_{s}}\\right)} & E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t) = \\frac{E}{1 - \\exp\\left(-\\frac{Et}{\\eta_{s}}\\right)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on physical principles, we now turn to the formulation of numerical models, a cornerstone of modern computational geophysics. This exercise requires you to construct the weak form of the poroviscoelastic governing equations, which is the basis of the finite element method (FEM). Successfully deriving the variational problem and identifying the crucial Ladyzhenskaya–Babuška–Brezzi (LBB) stability condition are essential skills for developing robust simulation codes .",
            "id": "3613025",
            "problem": "Consider a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$, $d \\in \\{2,3\\}$, with boundary $\\Gamma = \\Gamma_u \\cup \\Gamma_t$ for mechanical (displacement/traction) boundary conditions and $\\Gamma = \\Gamma_p \\cup \\Gamma_q$ for hydraulic (pressure/flux) boundary conditions. Let $\\boldsymbol{u}(\\boldsymbol{x},t)$ denote the small-strain displacement of the solid skeleton, $p(\\boldsymbol{x},t)$ the pore pressure, and let the infinitesimal strain be $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^\\top)$ with deviatoric part $\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{u}) = \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) - \\tfrac{1}{d} \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$ and volumetric strain $\\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}))$. The linear momentum balance in the quasi-static limit is $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ in $\\Omega$, with $\\boldsymbol{b}$ a body force and $\\boldsymbol{\\sigma}$ the total stress. The fluid mass balance is $\\dot{\\zeta} + \\nabla \\cdot \\boldsymbol{w} = g$ in $\\Omega$, where the fluid content is $\\zeta = \\alpha \\nabla \\cdot \\boldsymbol{u} + s p$ with Biot coefficient $\\alpha \\in (0,1]$ and specific storage $s \\ge 0$, and the Darcy flux is $\\boldsymbol{w} = - \\kappa \\mu_f^{-1} \\nabla p$, with permeability tensor $\\kappa$ positive definite and fluid viscosity $\\mu_f > 0$. The traction boundary condition is $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\bar{\\boldsymbol{t}}$ on $\\Gamma_t$, the displacement essential boundary condition is $\\boldsymbol{u} = \\bar{\\boldsymbol{u}}$ on $\\Gamma_u$, the pressure essential boundary condition is $p = \\bar{p}$ on $\\Gamma_p$, and the flux boundary condition is $-\\boldsymbol{w}\\cdot \\boldsymbol{n} = \\bar{q}$ on $\\Gamma_q$. The Biot stress decomposition is $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}' - \\alpha p \\boldsymbol{I}$, where the effective stress $\\boldsymbol{\\sigma}'$ arises from a linear viscoelastic skeleton modeled by a generalized Maxwell model with $N \\ge 1$ internal variables: a deviatoric family $\\{\\boldsymbol{\\varepsilon}_m\\}_{m=1}^N$ and a volumetric family $\\{e_m\\}_{m=1}^N$, with moduli $\\{\\mu_\\infty, \\mu_m, K_\\infty, K_m\\}$ and relaxation times $\\{\\tau_m^{\\mathrm{s}}, \\tau_m^{\\mathrm{b}}\\}$, all strictly positive and independent of time. The effective stress is additively decomposed as\n$$\n\\boldsymbol{\\sigma}' = 2\\mu_\\infty \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{u}) + K_\\infty \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}\n+ \\sum_{m=1}^N \\left\\{ 2\\mu_m \\big( \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{u}) - \\boldsymbol{\\varepsilon}_m \\big)\n+ K_m \\big( \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) - e_m \\big) \\boldsymbol{I} \\right\\},\n$$\nwith internal variables evolving according to\n$$\n\\tau_m^{\\mathrm{s}} \\dot{\\boldsymbol{\\varepsilon}}_m + \\boldsymbol{\\varepsilon}_m = \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{u}), \\qquad\n\\tau_m^{\\mathrm{b}} \\dot{e}_m + e_m = \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})), \\quad m=1,\\dots,N.\n$$\nUsing these bases and standard notions of Sobolev spaces, select the option that correctly states a mixed displacement–pressure finite element weak form that includes the viscoelastic internal variables and a proper Ladyzhenskaya–Babuška–Brezzi (LBB) inf–sup stability condition on the discrete spaces for the displacement–pressure coupling.\n\nA. For function spaces $V = \\{ \\boldsymbol{v} \\in H^1(\\Omega)^d : \\boldsymbol{v} = \\boldsymbol{0} \\text{ on } \\Gamma_u \\}$, $Q = \\{ q \\in L^2(\\Omega) : q = 0 \\text{ on } \\Gamma_p \\text{ in the trace sense} \\}$, $W_{\\mathrm{s}} = L^2(\\Omega)^{d\\times d}_{\\mathrm{sym,dev}}$, $W_{\\mathrm{b}} = L^2(\\Omega)$, the weak form is: find $(\\boldsymbol{u},p,\\{\\boldsymbol{\\varepsilon}_m\\},\\{e_m\\})$ such that for all test functions $(\\boldsymbol{v},q,\\{\\boldsymbol{\\eta}_m\\},\\{\\chi_m\\}) \\in V \\times Q \\times W_{\\mathrm{s}}^N \\times W_{\\mathrm{b}}^N$,\n$$\n\\int_\\Omega \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\boldsymbol{\\sigma}' \\, \\mathrm{d}\\Omega - \\int_\\Omega \\alpha \\, p \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega\n= \\int_\\Omega \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\bar{\\boldsymbol{t}} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma,\n$$\n$$\n\\int_\\Omega q \\left( s \\, \\dot{p} + \\alpha \\, \\nabla \\cdot \\dot{\\boldsymbol{u}} \\right) \\mathrm{d}\\Omega + \\int_\\Omega \\kappa \\mu_f^{-1} \\nabla q \\cdot \\nabla p \\, \\mathrm{d}\\Omega\n= \\int_\\Omega q \\, g \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_q} q \\, \\bar{q} \\, \\mathrm{d}\\Gamma,\n$$\n$$\n\\int_\\Omega \\boldsymbol{\\eta}_m : \\left( \\tau_m^{\\mathrm{s}} \\dot{\\boldsymbol{\\varepsilon}}_m + \\boldsymbol{\\varepsilon}_m - \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{u}) \\right) \\mathrm{d}\\Omega = 0, \\quad\n\\int_\\Omega \\chi_m \\left( \\tau_m^{\\mathrm{b}} \\dot{e}_m + e_m - \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\right) \\mathrm{d}\\Omega = 0, \\quad m=1,\\dots,N,\n$$\nwith $\\boldsymbol{\\sigma}'$ as defined above. A discrete pair $(V_h,Q_h)$ is stable if there exists $\\beta>0$ independent of the mesh size $h$ such that\n$$\n\\inf_{q_h \\in Q_h} \\sup_{\\boldsymbol{v}_h \\in V_h} \\frac{ \\displaystyle \\int_\\Omega \\alpha \\, q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}\\Omega }{ \\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)} \\, \\|q_h\\|_{L^2(\\Omega)} } \\ge \\beta.\n$$\n\nB. Same setting as in A, but the mechanical weak form uses\n$$\n\\int_\\Omega \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\boldsymbol{\\sigma}' \\, \\mathrm{d}\\Omega + \\int_\\Omega \\alpha \\, p \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega\n= \\int_\\Omega \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\bar{\\boldsymbol{t}} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma,\n$$\nand the mass balance uses\n$$\n\\int_\\Omega q \\left( s \\, \\dot{p} - \\alpha \\, \\nabla \\cdot \\dot{\\boldsymbol{u}} \\right) \\mathrm{d}\\Omega + \\int_\\Omega \\kappa \\mu_f^{-1} \\nabla q \\cdot \\nabla p \\, \\mathrm{d}\\Omega\n= \\int_\\Omega q \\, g \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_q} q \\, \\bar{q} \\, \\mathrm{d}\\Gamma,\n$$\nwith internal variables as in A. The stability requirement is\n$$\n\\inf_{\\boldsymbol{v}_h \\in V_h} \\sup_{q_h \\in Q_h} \\frac{ \\displaystyle \\int_\\Omega \\nabla \\cdot \\boldsymbol{v}_h \\, q_h \\, \\mathrm{d}\\Omega }{ \\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)} \\, \\|q_h\\|_{L^2(\\Omega)} } \\ge \\beta,\n$$\nwhere $\\beta$ may depend on $h$.\n\nC. The pressure space is $Q = H^1_0(\\Omega)$ to accommodate the diffusion term, and the internal variables have test spaces $W_{\\mathrm{s}} = H^1(\\Omega)^{d\\times d}_{\\mathrm{sym,dev}}$ and $W_{\\mathrm{b}} = H^1(\\Omega)$. The mass balance weak form is\n$$\n\\int_\\Omega q \\left( s \\, \\dot{p} + \\alpha \\, \\nabla \\cdot \\dot{\\boldsymbol{u}} \\right) \\mathrm{d}\\Omega - \\int_\\Omega \\kappa \\mu_f^{-1} \\nabla q \\cdot \\nabla p \\, \\mathrm{d}\\Omega\n= \\int_\\Omega q \\, g \\, \\mathrm{d}\\Omega,\n$$\nand the stability condition is stated as\n$$\n\\inf_{\\boldsymbol{v}_h \\in V_h} \\sup_{q_h \\in Q_h} \\frac{ \\displaystyle \\int_\\Omega \\alpha \\, q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}\\Omega }{ \\|\\boldsymbol{v}_h\\|_{L^2(\\Omega)} \\, \\|q_h\\|_{H^1(\\Omega)} } \\ge C h,\n$$\nfor some constant $C>0$.\n\nD. The viscoelasticity is represented by a Kelvin–Voigt model with no internal variables, so $\\boldsymbol{\\sigma}' = 2\\mu \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{u}) + K \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I} + 2\\eta \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\dot{\\boldsymbol{u}}) + \\zeta \\dot{\\operatorname{tr}}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$, and the weak mechanical form is\n$$\n\\int_\\Omega \\left( 2\\mu \\, \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{v}) + K \\, \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\, \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{v})) + 2\\eta \\, \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\dot{\\boldsymbol{u}}) : \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{v}) + \\zeta \\, \\dot{\\operatorname{tr}}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\, \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{v})) \\right) \\mathrm{d}\\Omega\n+ \\int_\\Omega \\alpha \\, p \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega\n= \\int_\\Omega \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\bar{\\boldsymbol{t}} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma,\n$$\nwith the mass balance as in A and stability replaced by coercivity of the symmetric part of the bilinear form; no inf–sup condition is required for $(V_h,Q_h)$.",
            "solution": "The problem statement is a valid and well-posed formulation of quasi-static linear poroviscoelasticity based on a generalized Maxwell model for the solid skeleton and Darcy's law for the fluid flow. All governing equations, constitutive laws, and boundary conditions are standard in the field of computational geomechanics. We proceed to derive the weak formulation and evaluate the given options.\n\n### Derivation of the Weak Formulation\n\nThe problem involves a coupled system of partial differential equations for the displacement $\\boldsymbol{u}$, pore pressure $p$, and internal variables $\\{\\boldsymbol{\\varepsilon}_m, e_m\\}$. We derive the weak form for each equation using the Galerkin method.\n\n**1. Momentum Balance Equation**\n\nThe quasi-static momentum balance is given by:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0} \\quad \\text{in } \\Omega $$\nLet $\\boldsymbol{v}$ be a vector-valued test function from the appropriate space $V = \\{ \\boldsymbol{v} \\in H^1(\\Omega)^d : \\boldsymbol{v} = \\boldsymbol{0} \\text{ on } \\Gamma_u \\}$. Multiplying the equation by $\\boldsymbol{v}$ and integrating over $\\Omega$ yields:\n$$ \\int_\\Omega (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega + \\int_\\Omega \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega = 0 $$\nApplying integration by parts (Green's first identity for vector fields) to the first term, and using the symmetry of the stress tensor $\\boldsymbol{\\sigma}$, we get:\n$$ -\\int_\\Omega \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, \\mathrm{d}\\Omega + \\int_\\Gamma (\\boldsymbol{\\sigma} \\boldsymbol{n}) \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma + \\int_\\Omega \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega = 0 $$\nThe boundary integral $\\int_\\Gamma (\\boldsymbol{\\sigma} \\boldsymbol{n}) \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma$ splits into an integral over $\\Gamma_u$ and $\\Gamma_t$. Since $\\boldsymbol{v} = \\boldsymbol{0}$ on $\\Gamma_u$, the integral over $\\Gamma_u$ vanishes. On $\\Gamma_t$, we apply the traction boundary condition $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\bar{\\boldsymbol{t}}$. The equation becomes:\n$$ \\int_\\Omega \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, \\mathrm{d}\\Omega = \\int_\\Omega \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\bar{\\boldsymbol{t}} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma $$\nNow, we substitute the Biot total stress decomposition $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}' - \\alpha p \\boldsymbol{I}$:\n$$ \\int_\\Omega (\\boldsymbol{\\sigma}' - \\alpha p \\boldsymbol{I}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, \\mathrm{d}\\Omega = \\int_\\Omega \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\bar{\\boldsymbol{t}} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma $$\nUsing the identity $\\boldsymbol{I} : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) = \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{v})) = \\nabla \\cdot \\boldsymbol{v}$, the final weak form for the momentum balance is:\n$$ \\int_\\Omega \\boldsymbol{\\sigma}' : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, \\mathrm{d}\\Omega - \\int_\\Omega \\alpha p \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega = \\int_\\Omega \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\bar{\\boldsymbol{t}} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma $$\nNote that by symmetry, $\\boldsymbol{\\sigma}' : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) = \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\boldsymbol{\\sigma}'$.\n\n**2. Fluid Mass Balance Equation**\n\nThe fluid mass balance is $\\dot{\\zeta} + \\nabla \\cdot \\boldsymbol{w} = g$. Substituting the definitions for $\\zeta$ and $\\boldsymbol{w}$, we have:\n$$ s \\dot{p} + \\alpha \\nabla \\cdot \\dot{\\boldsymbol{u}} + \\nabla \\cdot (-\\kappa \\mu_f^{-1} \\nabla p) = g $$\nLet $q$ be a scalar test function from a space $Q$. For a conforming Galerkin method, the presence of $\\nabla p$ and the subsequent integration by parts requires $p, q \\in H^1(\\Omega)$. The test space is $Q = \\{ q \\in H^1(\\Omega) : q = 0 \\text{ on } \\Gamma_p \\}$. Multiplying the equation by $q$ and integrating over $\\Omega$:\n$$ \\int_\\Omega q \\left( s \\dot{p} + \\alpha \\nabla \\cdot \\dot{\\boldsymbol{u}} \\right) \\mathrm{d}\\Omega + \\int_\\Omega q (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}\\Omega = \\int_\\Omega q g \\, \\mathrm{d}\\Omega $$\nApplying integration by parts to the flux term:\n$$ \\int_\\Omega q (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}\\Omega = -\\int_\\Omega \\nabla q \\cdot \\boldsymbol{w} \\, \\mathrm{d}\\Omega + \\int_\\Gamma q (\\boldsymbol{w} \\cdot \\boldsymbol{n}) \\, \\mathrm{d}\\Gamma $$\nThe boundary integral vanishes over $\\Gamma_p$ since $q=0$ there. On $\\Gamma_q$, we have the condition $-\\boldsymbol{w} \\cdot \\boldsymbol{n} = \\bar{q}$, or $\\boldsymbol{w} \\cdot \\boldsymbol{n} = -\\bar{q}$. Thus, the boundary integral becomes $\\int_{\\Gamma_q} q (-\\bar{q}) \\, \\mathrm{d}\\Gamma$. The full equation is:\n$$ \\int_\\Omega q \\left( s \\dot{p} + \\alpha \\nabla \\cdot \\dot{\\boldsymbol{u}} \\right) \\mathrm{d}\\Omega - \\int_\\Omega \\nabla q \\cdot \\boldsymbol{w} \\, \\mathrm{d}\\Omega - \\int_{\\Gamma_q} q \\bar{q} \\, \\mathrm{d}\\Gamma = \\int_\\Omega q g \\, \\mathrm{d}\\Omega $$\nSubstituting Darcy's law $\\boldsymbol{w} = - \\kappa \\mu_f^{-1} \\nabla p$ and rearranging:\n$$ \\int_\\Omega q \\left( s \\dot{p} + \\alpha \\nabla \\cdot \\dot{\\boldsymbol{u}} \\right) \\mathrm{d}\\Omega + \\int_\\Omega \\nabla q \\cdot (\\kappa \\mu_f^{-1} \\nabla p) \\, \\mathrm{d}\\Omega = \\int_\\Omega q g \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_q} q \\bar{q} \\, \\mathrm{d}\\Gamma $$\nAssuming the permeability tensor $\\kappa$ is symmetric, we can write $\\nabla q \\cdot (\\kappa \\nabla p) = \\nabla p \\cdot (\\kappa \\nabla q)$. With the common notation used in option A, this is written as $\\int_\\Omega \\kappa \\mu_f^{-1} \\nabla q \\cdot \\nabla p \\, \\mathrm{d}\\Omega$.\n\n**3. Internal Variable Equations**\n\nThese are sets of ordinary differential equations in time, defined at each point $\\boldsymbol{x} \\in \\Omega$. The weak form is obtained by multiplying by test functions (e.g., $\\boldsymbol{\\eta}_m \\in W_s$, $\\chi_m \\in W_b$) and integrating over $\\Omega$. Since no spatial derivatives of the internal variables appear, the appropriate spaces are $L^2$-based.\n$$ \\int_\\Omega \\boldsymbol{\\eta}_m : \\left( \\tau_m^{\\mathrm{s}} \\dot{\\boldsymbol{\\varepsilon}}_m + \\boldsymbol{\\varepsilon}_m - \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}(\\boldsymbol{u}) \\right) \\mathrm{d}\\Omega = 0 $$\n$$ \\int_\\Omega \\chi_m \\left( \\tau_m^{\\mathrm{b}} \\dot{e}_m + e_m - \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\right) \\mathrm{d}\\Omega = 0 $$\n\n**4. Ladyzhenskaya–Babuška–Brezzi (LBB) Stability Condition**\n\nThe displacement-pressure formulation is a saddle-point problem. Stability of the discretization requires that the discrete spaces for displacement, $V_h$, and pressure, $Q_h$, satisfy the LBB (or inf-sup) condition. The coupling bilinear form is $b(\\boldsymbol{v}, q) = \\int_\\Omega \\alpha q \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega$. The LBB condition requires that there exists a constant $\\beta > 0$, independent of the mesh size $h$, such that:\n$$ \\inf_{q_h \\in Q_h} \\sup_{\\boldsymbol{v}_h \\in V_h} \\frac{ \\int_\\Omega \\alpha q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}\\Omega }{ \\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)} \\, \\|q_h\\|_{L^2(\\Omega)} } \\ge \\beta $$\n\n### Option-by-Option Analysis\n\n**A. For function spaces $V = \\{ \\boldsymbol{v} \\in H^1(\\Omega)^d : \\boldsymbol{v} = \\boldsymbol{0} \\text{ on } \\Gamma_u \\}$, $Q = \\{ q \\in L^2(\\Omega) : q = 0 \\text{ on } \\Gamma_p \\text{ in the trace sense} \\}$, ...**\n\n- **Mechanical Weak Form**: The form presented, $\\int_\\Omega \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\boldsymbol{\\sigma}' \\, \\mathrm{d}\\Omega - \\int_\\Omega \\alpha \\, p \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega = \\dots$, is correct. The sign of the coupling term is negative, consistent with the compressive effect of pore pressure.\n- **Hydraulic Weak Form**: The form $\\int_\\Omega q \\left( s \\, \\dot{p} + \\alpha \\, \\nabla \\cdot \\dot{\\boldsymbol{u}} \\right) \\mathrm{d}\\Omega + \\int_\\Omega \\kappa \\mu_f^{-1} \\nabla q \\cdot \\nabla p \\, \\mathrm{d}\\Omega = \\dots$ is correct, including the signs of the storage, coupling, diffusion, and boundary flux terms.\n- **Internal Variable Weak Form**: Correctly stated.\n- **Function Spaces**: The definition for the pressure test space $Q$ as a subset of $L^2(\\Omega)$ is inconsistent with the use of $\\nabla q$ in the weak form, which requires $q \\in H^1(\\Omega)$. An $L^2$ function does not have a well-defined trace. This is a significant formal error. However, the other spaces are correctly defined.\n- **LBB Condition**: The stated condition is the correct form for ensuring the stability of the displacement-pressure coupling, using the correct norms and requiring uniformity with respect to mesh size ($\\beta$ independent of $h$).\n\nDespite the erroneous definition of the space $Q$, all other components of this option—the weak forms of all governing equations and the stability condition—are physically and mathematically correct. This inconsistency is likely a typographical error, and this option remains the most plausible answer.\n\nVerdict: **Correct** (assuming a typo in the definition of $Q$).\n\n**B. Same setting as in A, but the mechanical weak form uses...**\n\n- **Mechanical Weak Form**: The form $\\int_\\Omega \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\boldsymbol{\\sigma}' \\, \\mathrm{d}\\Omega + \\int_\\Omega \\alpha \\, p \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega = \\dots$ has an incorrect positive sign on the coupling term. This would imply that increasing pore pressure causes solid expansion, which is non-physical.\n- **Hydraulic Weak Form**: The form $\\int_\\Omega q \\left( s \\, \\dot{p} - \\alpha \\, \\nabla \\cdot \\dot{\\boldsymbol{u}} \\right) \\mathrm{d}\\Omega + \\dots$ has an incorrect negative sign on the solid-fluid coupling term. This wrongly decouples the effect of solid deformation on fluid storage.\n- **LBB Condition**: The statement that the stability constant $\\beta$ \"may depend on $h$\" describes an unstable numerical scheme, as stability requires $\\beta$ to be bounded below by a positive constant independent of $h$.\nThis option is incorrect due to fundamental sign errors in the weak form and a misunderstanding of the stability condition.\n\nVerdict: **Incorrect**.\n\n**C. The pressure space is $Q = H^1_0(\\Omega)$...**\n\n- **Function Spaces**: Setting $Q = H_0^1(\\Omega)$ implies $p=0$ on the entire boundary $\\Gamma$. This is a specific, restrictive case. More critically, defining the test spaces for the internal variables as $W_{\\mathrm{s}} \\subset H^1(\\Omega)^{d\\times d}$ and $W_{\\mathrm{b}} \\subset H^1(\\Omega)$ is unnecessary and non-standard. The internal variables are governed by local ODEs and do not require $H^1$ regularity.\n- **Hydraulic Weak Form**: The form $\\dots - \\int_\\Omega \\kappa \\mu_f^{-1} \\nabla q \\cdot \\nabla p \\, \\mathrm{d}\\Omega = \\dots$ has a negative sign on the diffusion term. The diffusion operator is elliptic and should lead to a positive definite bilinear form $(q,p) \\mapsto \\int \\nabla q \\cdot (\\kappa \\nabla p)$ for well-posedness. A negative sign makes the problem ill-posed.\n- **LBB Condition**: The condition is stated with incorrect norms ($\\|\\boldsymbol{v}_h\\|_{L^2}$ instead of $\\|\\boldsymbol{v}_h\\|_{H^1}$, and $\\|q_h\\|_{H^1}$ instead of $\\|q_h\\|_{L^2}$) and an incorrect dependence on mesh size ($\\ge C h$), which implies instability.\nThis option is incorrect due to multiple errors in function spaces, the weak form, and the stability condition.\n\nVerdict: **Incorrect**.\n\n**D. The viscoelasticity is represented by a Kelvin–Voigt model...**\n\n- **Physical Model**: This option replaces the specified generalized Maxwell model with a Kelvin-Voigt model. It therefore does not provide a weak form for the problem as stated.\n- **Mechanical Weak Form**: The coupling term $\\int_\\Omega \\alpha \\, p \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega$ has the wrong (positive) sign.\n- **Stability Condition**: The claim that \"no inf–sup condition is required\" is fundamentally false for this class of saddle-point problems. Stability of the displacement-pressure coupling hinges on the LBB condition being satisfied by the chosen discrete spaces.\nThis option is incorrect because it changes the physical model and makes a false, critical claim about the necessary stability conditions.\n\nVerdict: **Incorrect**.\n\n### Conclusion\n\nOption A is the only one that presents the correct weak formulation for the governing equations and the correct form of the LBB stability condition. Its only flaw is a contradiction in the definition of the pressure test function space $Q$, which is likely a typographical error. The errors in options B, C, and D are far more severe and relate to fundamental physical principles, mathematical well-posedness, and core stability theory. Therefore, Option A is the intended correct response.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The ultimate goal of many simulations is to invert for subsurface properties using field data, a process that relies on efficient sensitivity calculations. This advanced practice introduces the adjoint-state method, the workhorse of modern gradient-based inversion. By deriving the adjoint system from first principles, you will gain a deep understanding of how it relates to the forward problem, culminating in a conceptual check of the fundamental adjoint property that underpins its utility .",
            "id": "3613028",
            "problem": "Consider one-dimensional, time-domain poroviscoelasticity under Biot-type assumptions on a bounded interval $x \\in [0,L]$ and a finite time window $t \\in [0,T]$. The solid displacement is $u(x,t)$, the fluid relative flux (Darcy flux) is $w(x,t)$, and the pore pressure is $p(x,t)$. The mass density of the saturated composite is $\\rho$, the fluid density is $\\rho_{f}$, the Lamé parameters of the solid skeleton are $\\lambda$ and $\\mu$, the solid viscosity (Kelvin–Voigt dashpot) is $\\eta_{s}$, the Biot coefficient is $\\alpha$, the Biot modulus is $M$, the fluid dynamic viscosity is $\\eta_{f}$, and the permeability is $\\kappa$. All coefficients are positive constants and spatially homogeneous. The external body-force source applied to the solid momentum equation is $s_{u}(x,t)$, and the initial conditions are $u(x,0)=0$, $w(x,0)=0$, and $p(x,0)=0$.\n\nThe governing equations are derived from linear momentum balance for the skeleton, Darcy’s law for the fluid flux, and fluid mass conservation, combined with a Kelvin–Voigt viscoelastic constitutive law for the skeleton with stress\n$$\n\\sigma(x,t) = \\big(\\lambda + 2\\mu\\big)\\,\\partial_{x} u(x,t) + 2\\eta_{s}\\,\\partial_{x} \\dot{u}(x,t) - \\alpha\\,p(x,t),\n$$\nand the constraints\n$$\n\\rho\\,\\ddot{u}(x,t) - \\partial_{x}\\sigma(x,t) = s_{u}(x,t),\n$$\n$$\nw(x,t) + \\frac{\\kappa}{\\eta_{f}}\\Big(\\partial_{x} p(x,t) + \\rho_{f}\\,\\ddot{u}(x,t)\\Big) = 0,\n$$\n$$\n\\dot{p}(x,t) - M\\Big(\\alpha\\,\\partial_{x}\\dot{u}(x,t) - \\partial_{x} w(x,t)\\Big) = 0.\n$$\nThe spatial boundary conditions are homogeneous Dirichlet for $u$ and $w$, $u(0,t)=u(L,t)=0$, $w(0,t)=w(L,t)=0$, along with homogeneous Neumann for $p$, $\\partial_{x}p(0,t)=\\partial_{x}p(L,t)=0$. Let a receiver at location $x_{r}\\in(0,L)$ measure the solid displacement $u(x_{r},t)$. Define the least-squares misfit functional\n$$\nJ[u] = \\frac{1}{2}\\int_{0}^{T}\\big(u(x_{r},t) - d_{\\mathrm{obs}}(t)\\big)^{2}\\,\\mathrm{d}t,\n$$\nwhere $d_{\\mathrm{obs}}(t)$ is the observed time series.\n\nTask 1: Using the conservation laws and constitutive relations stated above as the fundamental base, construct a Lagrangian by enforcing the three forward constraints with adjoint fields $\\lambda_{u}(x,t)$, $\\lambda_{w}(x,t)$, and $\\lambda_{p}(x,t)$. From first principles, derive the adjoint-state equations for $\\lambda_{u}$, $\\lambda_{w}$, and $\\lambda_{p}$, including terminal conditions at $t=T$ and spatial boundary conditions consistent with the forward ones. Your derivation must be fully self-contained, and you must not quote or assume any target adjoint formulas.\n\nTask 2: Define the linear forward operator $\\mathcal{F}$ that maps the source $s_{u}(x,t)$ to the receiver data $d(t)=u(x_{r},t)$. Let $\\mathcal{F}^{*}$ be the operator mapping a test time series $y(t)$ to the corresponding adjoint equivalent source $\\tilde{s}_{u}(x,t)$ entering the adjoint system derived in Task 1. Using the inner products\n$$\n\\langle a,b\\rangle_{t} = \\int_{0}^{T} a(t)\\,b(t)\\,\\mathrm{d}t,\\qquad\n\\langle f,g\\rangle_{x,t} = \\int_{0}^{T}\\int_{0}^{L} f(x,t)\\,g(x,t)\\,\\mathrm{d}x\\,\\mathrm{d}t,\n$$\nand choosing specific smooth test functions\n$$\ns_{u}(x,t) = \\sin\\!\\Big(\\frac{\\pi x}{L}\\Big)\\,\\sin(\\omega t),\\qquad y(t) = \\exp\\!\\Big(-\\frac{t}{T}\\Big),\n$$\ndefine the normalized adjoint test scalar\n$$\nS = \\frac{\\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t} - \\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t}}{\\max\\Big(\\big|\\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t}\\big|,\\,\\big|\\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t}\\big|\\Big)}.\n$$\nCompute $S$ and provide its value. The final answer must be a single real number. No rounding is required because $S$ is dimensionless and, under exact arithmetic, attains its analytical value.",
            "solution": "The problem is divided into two tasks. The first is to derive the adjoint-state equations for a given one-dimensional poroviscoelastic system. The second is to compute a normalized quantity, $S$, which represents an adjoint test.\n\nThe foundation of the derivation is the method of Lagrange multipliers, applied to the system of partial differential equations (PDEs) that constitute the forward model. We construct a Lagrangian functional, $\\mathcal{L}$, by augmenting the quantity of interest with the governing equations, enforced by adjoint fields. The adjoint equations are then derived by finding the stationary point of the Lagrangian with respect to the forward-state variables.\n\nFirst, let us write the governing equations as a set of constraints, $C_i = 0$:\nThe stress in the Kelvin-Voigt solid skeleton is given by\n$$ \\sigma(x,t) = \\big(\\lambda + 2\\mu\\big)\\,\\partial_{x} u(x,t) + 2\\eta_{s}\\,\\partial_{x} \\dot{u}(x,t) - \\alpha\\,p(x,t) $$\nThe three constraint equations are:\n$$ C_u \\equiv \\rho\\,\\ddot{u} - \\partial_{x}\\sigma - s_{u} = 0 $$\n$$ C_w \\equiv w + \\frac{\\kappa}{\\eta_{f}}\\Big(\\partial_{x} p + \\rho_{f}\\,\\ddot{u}\\Big) = 0 $$\n$$ C_p \\equiv \\dot{p} - M\\Big(\\alpha\\,\\partial_{x}\\dot{u} - \\partial_{x} w\\Big) = 0 $$\nwhere time derivatives are denoted by a dot, e.g., $\\dot{u} = \\partial_t u$, and spatial derivatives by $\\partial_x$.\n\nTask 1: Derivation of the Adjoint-State System\n\nFor the derivation of the adjoint equations, the misfit functional $J[u]$ is the starting point. The source of the adjoint system is derived from the Fréchet derivative of $J$ with respect to the state variables. The general form of the Lagrangian, $\\mathcal{L}$, is constructed by adding $J[u]$ to the inner products of the adjoint fields with the corresponding constraint equations. Let the adjoint fields (Lagrange multipliers) be $\\lambda_u(x,t)$, $\\lambda_w(x,t)$, and $\\lambda_p(x,t)$.\n$$ \\mathcal{L}[u, w, p, \\lambda_u, \\lambda_w, \\lambda_p] = J[u] + \\int_0^T\\int_0^L \\Big( \\lambda_u C_u + \\lambda_w C_w + \\lambda_p C_p \\Big) \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nThe adjoint equations are found by requiring the Fréchet derivative of $\\mathcal{L}$ with respect to the state variables $u$, $w$, and $p$ to be zero. This is equivalent to finding the variation $\\delta\\mathcal{L}$ with respect to perturbations $\\delta u$, $\\delta w$, and $\\delta p$, and setting the terms multiplying these perturbations to zero.\n\nThe variation $\\delta\\mathcal{L}$ is:\n$$ \\delta\\mathcal{L} = \\delta J[u] + \\int_0^T\\int_0^L \\Big( \\lambda_u \\delta C_u + \\lambda_w \\delta C_w + \\lambda_p \\delta C_p \\Big) \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nThe variation of the misfit functional is:\n$$ \\delta J[u] = \\int_0^T \\big(u(x_r, t) - d_{\\mathrm{obs}}(t)\\big) \\delta u(x_r, t) \\,\\mathrm{d}t = \\int_0^T\\int_0^L \\delta(x-x_r)\\big(u(x, t) - d_{\\mathrm{obs}}(t)\\big) \\delta u(x, t) \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nThe variations of the constraints are:\n$$ \\delta C_u = \\rho\\,\\delta\\ddot{u} - \\partial_{x}\\left( (\\lambda+2\\mu)\\partial_x\\delta u + 2\\eta_s\\partial_x\\delta\\dot{u} - \\alpha\\delta p \\right) $$\n$$ \\delta C_w = \\delta w + \\frac{\\kappa}{\\eta_f}\\left(\\partial_x\\delta p + \\rho_f\\delta\\ddot{u}\\right) $$\n$$ \\delta C_p = \\delta\\dot{p} - M(\\alpha\\partial_x\\delta\\dot{u} - \\partial_x\\delta w) $$\nWe collect all terms in $\\delta\\mathcal{L}$ and integrate by parts to transfer all temporal and spatial derivatives from the perturbations ($\\delta u, \\delta w, \\delta p$) to the adjoint fields ($\\lambda_u, \\lambda_w, \\lambda_p$).\n\nLet's group terms by the perturbation field:\nTerms with $\\delta u$:\n$$ \\int_0^T\\int_0^L \\left[ \\delta(x-x_r)(u - d_{\\mathrm{obs}}) \\delta u + \\lambda_u \\Big(\\rho\\,\\delta\\ddot{u} - \\partial_x\\big((\\lambda+2\\mu)\\partial_x\\delta u + 2\\eta_s\\partial_x\\delta\\dot{u}\\big)\\Big) + \\lambda_w\\frac{\\kappa\\rho_f}{\\eta_f}\\delta\\ddot{u} - \\lambda_p M\\alpha\\partial_x\\delta\\dot{u} \\right] \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nTerms with $\\delta w$:\n$$ \\int_0^T\\int_0^L \\left[ \\lambda_w \\delta w + \\lambda_p M\\partial_x\\delta w \\right] \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nTerms with $\\delta p$:\n$$ \\int_0^T\\int_0^L \\left[ \\lambda_u \\partial_x(\\alpha\\delta p) + \\lambda_w \\frac{\\kappa}{\\eta_f}\\partial_x\\delta p + \\lambda_p\\delta\\dot{p} \\right] \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nAfter performing integration by parts and collecting terms multiplying $\\delta u$, $\\delta w$, and $\\delta p$ in the volume integral, we obtain the adjoint equations by setting these kernels to zero.\n\nThe adjoint equation from the $\\delta w$ terms:\n$$ \\int_0^T\\int_0^L \\big( \\lambda_w - M\\partial_x\\lambda_p \\big) \\delta w \\,\\mathrm{d}x\\,\\mathrm{d}t + \\int_0^T \\big[M\\lambda_p \\delta w\\big]_0^L \\,\\mathrm{d}t = 0 $$\nThe forward boundary condition $w(0,t)=w(L,t)=0$ implies $\\delta w(0,t)=\\delta w(L,t)=0$, so the boundary term vanishes. The resulting adjoint equation is an algebraic relation:\n$$ \\lambda_w(x,t) - M\\partial_x\\lambda_p(x,t) = 0 $$\n\nThe adjoint equation from the $\\delta p$ terms:\n$$ \\int_0^T\\int_0^L \\big( -\\dot{\\lambda}_p - \\alpha\\partial_x\\lambda_u - \\frac{\\kappa}{\\eta_f}\\partial_x\\lambda_w \\big) \\delta p \\,\\mathrm{d}x\\,\\mathrm{d}t + \\text{B.T.} = 0 $$\nThe boundary terms are $\\int_0^L[\\lambda_p\\delta p]_0^T\\,\\mathrm{d}x$ and $\\int_0^T[\\alpha\\lambda_u\\delta p + \\frac{\\kappa}{\\eta_f}\\lambda_w\\delta p]_0^L\\,\\mathrm{d}t$. The forward initial condition $p(x,0)=0$ implies $\\delta p(x,0)=0$. We enforce a terminal condition $\\lambda_p(x,T)=0$ to nullify the time boundary term. For the spatial boundary term, the forward condition $\\partial_xp(0,t)=\\partial_xp(L,t)=0$ does not constrain $\\delta p$ at the boundary. Thus, we must impose a boundary condition on the adjoint variables: $\\alpha\\lambda_u + \\frac{\\kappa}{\\eta_f}\\lambda_w = 0$ at $x=0,L$. The adjoint equation for $\\lambda_p$ is:\n$$ \\dot{\\lambda}_p + \\alpha\\partial_x\\lambda_u + \\frac{\\kappa}{\\eta_f}\\partial_x\\lambda_w = 0 $$\n\nThe adjoint equation from the $\\delta u$ terms:\nThe process of integration by parts for the $\\delta u$ terms is more involved. It yields the following kernel, after accounting for all contributions:\n$$ \\rho\\ddot{\\lambda}_u + \\frac{\\kappa\\rho_f}{\\eta_f}\\ddot{\\lambda}_w - (\\lambda+2\\mu)\\partial_{xx}\\lambda_u + 2\\eta_s\\partial_{xx}\\dot{\\lambda}_u - M\\alpha\\partial_x\\dot{\\lambda}_p = -\\delta(x-x_r)(u-d_{\\mathrm{obs}}) $$\nNote the sign change on the viscous term's time derivative, characteristic of adjoints of dissipative systems. The operator $\\partial_t$ becomes $-\\partial_t$ on the adjoint variable.\nThe time boundary terms require $\\lambda_u(x,T)=0$ and $\\dot{\\lambda}_u(x,T)=0$. The spatial boundary terms associated with $\\delta u$ and its derivatives are handled by imposing $\\lambda_u(0,t)=\\lambda_u(L,t)=0$, which is the natural adjoint boundary condition corresponding to the Dirichlet condition on $u$.\n\nSummary of the Adjoint System:\nWe substitute $\\lambda_w = M\\partial_x\\lambda_p$ into the other equations.\nAdjoint Equations (running backward in time from $t=T$ to $t=0$):\n1. $\\lambda_w(x,t) = M\\partial_x\\lambda_p(x,t)$\n2. $\\dot{\\lambda}_p + \\alpha\\partial_x\\lambda_u + \\frac{\\kappa M}{\\eta_f}\\partial_{xx}\\lambda_p = 0$\n3. $\\rho\\ddot{\\lambda}_u + \\frac{\\kappa\\rho_f M}{\\eta_f}\\partial_x\\ddot{\\lambda}_p - (\\lambda+2\\mu)\\partial_{xx}\\lambda_u + 2\\eta_s\\partial_{xx}\\dot{\\lambda}_u - M\\alpha\\partial_x\\dot{\\lambda}_p = -\\delta(x-x_r)(u(x,t)-d_{\\mathrm{obs}}(t))$\n\nTerminal Conditions at $t=T$:\n$\\lambda_u(x,T)=0$, $\\dot{\\lambda}_u(x,T)=0$, $\\lambda_p(x,T)=0$.\nThese imply $\\lambda_w(x,T)=0$ and its time derivatives are also determined.\n\nSpatial Boundary Conditions at $x=0,L$:\n1. $\\lambda_u(0,t)=0, \\lambda_u(L,t)=0$ (Dirichlet)\n2. From $\\lambda_w = M\\partial_x\\lambda_p$ and the required $\\alpha\\lambda_u + \\frac{\\kappa}{\\eta_f}\\lambda_w=0$ at $x=0,L$, the condition becomes $\\frac{\\kappa}{\\eta_f}M\\partial_x\\lambda_p=0$, since $\\lambda_u=0$ at the boundary. As $\\kappa, M, \\eta_f$ are positive, this leads to $\\partial_x\\lambda_p(0,t)=0, \\partial_x\\lambda_p(L,t)=0$ (Neumann).\nThis completes Task 1.\n\nTask 2: Computation of the Adjoint Test Scalar $S$\n\nThe adjoint test is a validation that the derived adjoint operator is indeed the mathematical adjoint of the forward operator. The linear forward operator $\\mathcal{F}$ maps the source $s_u(x,t)$ to the observation $d(t) = u(x_r,t)$. The adjoint operator $\\mathcal{F}^*$ is defined by the property:\n$$ \\langle \\mathcal{F}(s_u), y \\rangle_t = \\langle s_u, \\mathcal{F}^*(y) \\rangle_{x,t} $$\nfor any functions $s_u(x,t)$ and $y(t)$ in the appropriate spaces. The inner products are defined in the problem statement. The left side is an inner product in time, and the right side is an inner product in spacetime.\n\nThe entire derivation of the adjoint-state equations in Task 1 is precisely the construction of an operator $\\mathcal{F}^*$ that satisfies this identity. Let's demonstrate this.\nLet $X = (u,w,p)^T$ and $\\Lambda = (\\lambda_u, \\lambda_w, \\lambda_p)^T$. The forward system is $L X = S_u$ where $S_u = (s_u,0,0)^T$. The adjoint system is $L^* \\Lambda = F_y$ where $F_y = (\\delta(x-x_r)y(t), 0, 0)^T$. Note that the adjoint source is defined by the second argument of the data-space inner product, $y(t)$.\nThe defining property of the adjoint operator $L^*$ is that for any $X, \\Lambda$ satisfying the respective homogeneous boundary conditions, the following identity holds:\n$$ \\langle LX, \\Lambda \\rangle_{x,t} = \\langle X, L^*\\Lambda \\rangle_{x,t} $$\nThis is Green's identity. The boundary and initial/terminal conditions derived in Task 1 are specifically chosen to ensure that all boundary terms from the integration by parts vanish, making this identity exact.\nLet's apply this identity to our specific case.\n$$ \\langle S_u, \\Lambda \\rangle_{x,t} = \\langle X, F_y \\rangle_{x,t} $$\nExpanding the inner products:\n$$ \\int_0^T\\int_0^L s_u(x,t) \\lambda_u(x,t) \\,\\mathrm{d}x\\,\\mathrm{d}t = \\int_0^T\\int_0^L u(x,t) \\delta(x-x_r) y(t) \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nThe left side is $\\langle s_u, \\lambda_u \\rangle_{x,t}$. The right side is $\\int_0^T u(x_r,t) y(t) \\,\\mathrm{d}t = \\langle \\mathcal{F}(s_u), y \\rangle_t$.\nFrom the definition of the adjoint state method, the output of the adjoint operator, $\\mathcal{F}^*(y)$, is the solution field $\\lambda_u(x,t)$ obtained by solving the adjoint system with source $F_y$ constructed from $y$. Therefore, $\\mathcal{F}^*(y) = \\lambda_u(x,t)$.\nSubstituting this into our equation, we get:\n$$ \\langle s_u, \\mathcal{F}^*(y) \\rangle_{x,t} = \\langle \\mathcal{F}(s_u), y \\rangle_t $$\nThis demonstrates that the two terms in the numerator of the expression for $S$ are equal by construction. The phrasing of the problem, particularly the definition of $\\tilde{s}_u(x,t)$, is potentially ambiguous, but the fundamental duality relationship of the adjoint-state method is unequivocal.\n\nThe scalar $S$ is defined as:\n$$ S = \\frac{\\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t} - \\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t}}{\\max\\Big(\\big|\\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t}\\big|,\\,\\big|\\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t}\\big|\\Big)} $$\nSince we have established that $\\langle \\mathcal{F}(s_u), y \\rangle_t = \\langle s_u, \\mathcal{F}^*(y) \\rangle_{x,t}$, the numerator is identically zero.\n$$ \\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t} - \\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t} = 0 $$\nThe denominator involves the maximum of the absolute values of these two equal terms. For the given non-trivial test functions $s_{u}(x,t) = \\sin(\\pi x/L)\\sin(\\omega t)$ and $y(t) = \\exp(-t/T)$, the physical system will produce a non-zero response $u(x_r,t)$, and the adjoint system will produce a non-zero field $\\lambda_u(x,t)$. Thus, the inner products will be non-zero in general. The denominator is therefore non-zero.\nConsequently, the value of $S$ is:\n$$ S = \\frac{0}{\\text{non-zero value}} = 0 $$\nThe computation of $S$ is therefore a conceptual exercise based on the successful derivation of the adjoint system in Task 1, confirming the understanding of the adjoint-state method's core principle.",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}