{
    "hands_on_practices": [
        {
            "introduction": "润滑理论是求解薄层中流体运动的一种强大近似方法，它极大地简化了斯托克斯方程。这种几何构造在地球动力学中十分常见，例如岩浆在岩床中的流动或岩石圈板块下的软流圈流动。本练习将通过一个经典的“挤压流”思想实验，引导你完整地推导速度和压力场，从而掌握在细长几何结构中应用润滑近似的核心分析技巧 。",
            "id": "3582782",
            "problem": "考虑一种粘性岩石的轴对称挤压流，该岩石被建模为动力粘度为 $\\eta$ 的不可压缩牛顿流体，限制在半径为 $a$ 的平行、刚性、圆形边界之间，边界间距为 $h(t)$，且该间隙厚度在径向坐标 $r$ 上是均匀的。该流动处于斯托克斯（蠕动）流态，惯性可忽略不计，且完全由边界的法向位移驱动，使得间隙厚度以恒定速率 $\\partial h/\\partial t$ 变化（其中 $\\partial h/\\partial t  0$ 对应于边界相互靠近）。假设岩石附着于边界（无滑移和无穿透条件），且外边缘 $r=a$ 处的压力等于环境参考压力（表压 $p(a)=0$）。该几何结构关于 $r=0$ 轴对称。\n\n使用不可压缩斯托克斯流的基本控制定律，即惯性可忽略的动量平衡方程和不可压缩性条件，推导细长间隙（$h \\ll a$）中挤压流的主阶轴对称解，并计算：\n- 高度平均的径向速度 $\\overline{u}_r(r)$，以及\n- 表压 $p(r)$。\n\n假设在任何时刻间隙 $h$ 在 $r$ 方向上是均匀的，并且 $\\partial h/\\partial t$ 在空间上是均匀的。将您的最终答案表示为 $r$、$a$、$h$、$\\eta$ 和 $\\partial h/\\partial t$ 的闭式解析函数。径向速度的单位为米/秒，压力的单位为帕斯卡。请提供数对 $\\left(\\overline{u}_r(r),\\,p(r)\\right)$ 作为您的最终答案。无需进行数值计算。",
            "solution": "问题陈述经过严格审查，被认为是有效的。这是一个适定的、有科学依据的流体力学问题，特别是润滑理论应用于斯托克斯流的一个经典例子。它是自洽的，定义了所有必要的条件和性质，没有矛盾或歧义。因此，我们可以进行形式推导。\n\n流动被描述为斯托克斯流态下的不可压缩牛顿流体。在以间隙中心为原点的柱坐标系（$r$, $\\theta$, $z$）中，并假设轴对称性（$\\frac{\\partial}{\\partial\\theta} = 0$）和无旋流速度（$u_\\theta=0$），其控制方程为连续性方程和斯托克斯动量方程。\n\n不可压缩流体的连续性方程为：\n$$ \\frac{1}{r}\\frac{\\partial}{\\partial r}(r u_r) + \\frac{\\partial u_z}{\\partial z} = 0 $$\n斯托克斯方程（惯性可忽略的动量平衡）为：\n$$ -\\frac{\\partial p}{\\partial r} + \\eta \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u_r}{\\partial r}\\right) - \\frac{u_r}{r^2} + \\frac{\\partial^2 u_r}{\\partial z^2} \\right] = 0 \\quad (r\\text{-动量}) $$\n$$ -\\frac{\\partial p}{\\partial z} + \\eta \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u_z}{\\partial r}\\right) + \\frac{\\partial^2 u_z}{\\partial z^2} \\right] = 0 \\quad (z\\text{-动量}) $$\n其中 $u_r$ 和 $u_z$ 分别是径向和垂向速度分量，$p$ 是压力，$\\eta$ 是动力粘度。\n\n问题指定了细长间隙，$h \\ll a$。这允许我们使用润滑近似。我们进行尺度分析。特征长度尺度在径向上为 $a$，在垂向上为 $h$。令 $\\dot{h} = \\frac{\\partial h}{\\partial t}$。从边界条件可知，特征垂向速度 $U_z$ 的量级为 $|\\dot{h}|$。根据连续性方程，$\\frac{U_r}{a} \\sim \\frac{U_z}{h}$，这意味着特征径向速度为 $U_r \\sim \\frac{a}{h} U_z \\sim \\frac{a}{h}|\\dot{h}|$。\n\n在 $r$-动量方程中，径向粘性项的尺度为 $\\eta \\frac{U_r}{a^2}$，而垂向粘性项的尺度为 $\\eta \\frac{U_r}{h^2}$。由于 $h \\ll a$，我们有 $\\frac{h^2}{a^2} \\ll 1$，因此垂向项 $\\frac{\\partial^2 u_r}{\\partial z^2}$ 在径向粘性项中占主导地位。$r$-动量方程简化为：\n$$ \\frac{\\partial p}{\\partial r} = \\eta \\frac{\\partial^2 u_r}{\\partial z^2} $$\n在 $z$-动量方程中，类似的分析表明压力梯度 $\\frac{\\partial p}{\\partial z}$ 必须与粘性项 $\\eta \\frac{\\partial^2 u_z}{\\partial z^2}$ 相平衡。穿过间隙的压力变化 $\\Delta p_z$ 的尺度为 $h \\cdot (\\eta U_z/h^2) = \\eta U_z/h$。径向压力变化 $\\Delta p_r$ 的尺度与简化后的 $r$-动量方程中的项相当，表明 $\\frac{\\Delta p_r}{a} \\sim \\eta \\frac{U_r}{h^2}$，因此 $\\Delta p_r \\sim \\frac{\\eta a U_r}{h^2}$。垂向与径向压力变化之比为 $\\frac{\\Delta p_z}{\\Delta p_r} \\sim \\frac{\\eta U_z/h}{\\eta a U_r/h^2} = \\frac{U_z h}{U_r a}$。代入 $U_r \\sim U_z \\frac{a}{h}$，该比率变为 $\\frac{h^2}{a^2} \\ll 1$。因此，$z$ 方向的压力变化可以忽略不计。我们可以假设 $p = p(r)$，这意味着 $\\frac{\\partial p}{\\partial z} = 0$。\n\n当 $p=p(r)$ 时，简化的 $r$-动量方程变为 $\\frac{dp}{dr} = \\eta \\frac{\\partial^2 u_r}{\\partial z^2}$。我们对此式关于 $z$ 积分两次：\n$$ \\frac{\\partial u_r}{\\partial z} = \\frac{1}{\\eta}\\frac{dp}{dr}z + C_1(r) $$\n$$ u_r(r,z) = \\frac{1}{2\\eta}\\frac{dp}{dr}z^2 + C_1(r)z + C_2(r) $$\n边界条件为在刚性边界 $z = \\pm h/2$ 处无滑移，即 $u_r(r, z=h/2) = 0$ 和 $u_r(r, z=-h/2) = 0$。根据对称性，速度剖面必须是 $z$ 的偶函数，这要求 $C_1(r)=0$。应用在 $z=h/2$ 处的条件：\n$$ 0 = \\frac{1}{2\\eta}\\frac{dp}{dr}\\left(\\frac{h}{2}\\right)^2 + C_2(r) \\implies C_2(r) = -\\frac{h^2}{8\\eta}\\frac{dp}{dr} $$\n代入 $C_2(r)$ 得到抛物线形的径向速度剖面：\n$$ u_r(r,z) = \\frac{1}{2\\eta}\\frac{dp}{dr}\\left(z^2 - \\frac{h^2}{4}\\right) $$\n接下来，我们计算高度平均的径向速度 $\\overline{u}_r(r)$：\n$$ \\overline{u}_r(r) = \\frac{1}{h} \\int_{-h/2}^{h/2} u_r(r,z) dz = \\frac{1}{2\\eta h}\\frac{dp}{dr} \\int_{-h/2}^{h/2} \\left(z^2 - \\frac{h^2}{4}\\right) dz $$\n$$ \\int_{-h/2}^{h/2} \\left(z^2 - \\frac{h^2}{4}\\right) dz = \\left[\\frac{z^3}{3} - \\frac{h^2}{4}z\\right]_{-h/2}^{h/2} = 2\\left(\\frac{h^3}{24} - \\frac{h^3}{8}\\right) = -\\frac{h^3}{6} $$\n$$ \\overline{u}_r(r) = \\frac{1}{2\\eta h}\\frac{dp}{dr}\\left(-\\frac{h^3}{6}\\right) = -\\frac{h^2}{12\\eta}\\frac{dp}{dr} $$\n为了求出压力梯度 $\\frac{dp}{dr}$，我们使用在间隙高度上积分的连续性方程：\n$$ \\int_{-h/2}^{h/2} \\left( \\frac{1}{r}\\frac{\\partial}{\\partial r}(r u_r) + \\frac{\\partial u_z}{\\partial z} \\right) dz = 0 $$\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r \\int_{-h/2}^{h/2} u_r dz \\right) + \\left[u_z\\right]_{-h/2}^{h/2} = 0 $$\n积分为 $h\\overline{u}_r$。第二项使用无穿透边界条件进行计算：$u_z(z=h/2) = \\frac{1}{2}\\frac{\\partial h}{\\partial t}$ 和 $u_z(z=-h/2) = -\\frac{1}{2}\\frac{\\partial h}{\\partial t}$。因此，$[u_z]_{-h/2}^{h/2} = \\frac{\\partial h}{\\partial t}$。积分后的连续性方程变为：\n$$ \\frac{1}{r}\\frac{d}{dr}(r h \\overline{u}_r) + \\frac{\\partial h}{\\partial t} = 0 $$\n代入 $\\overline{u}_r$ 的表达式：\n$$ \\frac{1}{r}\\frac{d}{dr}\\left( r h \\left(-\\frac{h^2}{12\\eta}\\frac{dp}{dr}\\right) \\right) = -\\frac{\\partial h}{\\partial t} $$\n$$ -\\frac{h^3}{12\\eta} \\frac{1}{r} \\frac{d}{dr}\\left(r \\frac{dp}{dr}\\right) = -\\frac{\\partial h}{\\partial t} \\implies \\frac{1}{r} \\frac{d}{dr}\\left(r \\frac{dp}{dr}\\right) = \\frac{12\\eta}{h^3}\\frac{\\partial h}{\\partial t} $$\n这是该问题的雷诺方程。我们对其关于 $r$ 积分一次：\n$$ r \\frac{dp}{dr} = \\frac{12\\eta}{h^3}\\frac{\\partial h}{\\partial t} \\frac{r^2}{2} + C_3 = \\frac{6\\eta}{h^3}\\frac{\\partial h}{\\partial t} r^2 + C_3 $$\n根据轴对称性，在 $r=0$ 处的压力梯度必须是有限的，这要求 $C_3=0$。\n$$ \\frac{dp}{dr} = \\frac{6\\eta}{h^3}\\frac{\\partial h}{\\partial t} r $$\n我们再次积分以求得 $p(r)$：\n$$ p(r) = \\frac{6\\eta}{h^3}\\frac{\\partial h}{\\partial t} \\frac{r^2}{2} + C_4 = \\frac{3\\eta}{h^3}\\frac{\\partial h}{\\partial t} r^2 + C_4 $$\n使用边界条件 $p(a)=0$：\n$$ 0 = \\frac{3\\eta}{h^3}\\frac{\\partial h}{\\partial t} a^2 + C_4 \\implies C_4 = -\\frac{3\\eta a^2}{h^3}\\frac{\\partial h}{\\partial t} $$\n因此，表压 $p(r)$ 为：\n$$ p(r) = \\frac{3\\eta}{h^3}\\frac{\\partial h}{\\partial t} (r^2 - a^2) $$\n最后，我们将 $\\frac{dp}{dr}$ 的表达式代回平均径向速度的方程中：\n$$ \\overline{u}_r(r) = -\\frac{h^2}{12\\eta}\\frac{dp}{dr} = -\\frac{h^2}{12\\eta} \\left(\\frac{6\\eta}{h^3}\\frac{\\partial h}{\\partial t} r\\right) $$\n$$ \\overline{u}_r(r) = -\\frac{6\\eta h^2}{12\\eta h^3} r \\frac{\\partial h}{\\partial t} = -\\frac{r}{2h} \\frac{\\partial h}{\\partial t} $$\n所求的两个量是高度平均的径向速度 $\\overline{u}_r(r)$ 和表压 $p(r)$。",
            "answer": "$$ \\boxed{ \\left(-\\frac{r}{2h} \\frac{\\partial h}{\\partial t}, \\frac{3\\eta(r^2 - a^2)}{h^3} \\frac{\\partial h}{\\partial t}\\right) } $$"
        },
        {
            "introduction": "虽然斯托克斯方程是纳维-斯托克斯方程的线性简化，但它在某些情况下会显现出微妙的数学难题。本练习探讨了著名的“斯托克斯佯谬”，即二维斯托克斯方程在无界域中无法同时满足所有边界条件。理解这一佯谬对于正确建立和解释地球动力学中的二维计算模型至关重要，因为它直接关系到如何处理远场边界条件以及计算域大小对模拟结果的影响 。",
            "id": "3582769",
            "problem": "在计算地球物理学中，岩石圈中的缓慢粘性变形通常通过斯托克斯区域的蠕动流来建模。考虑一种动力粘度为 $\\mu$、密度为 $\\rho$ 的牛顿流体，围绕一个半径为 $a$ 的无限长圆柱体的稳态不可压缩流动，该圆柱体代表一个长岩石圈包体的横截面。假设流动在垂直于圆柱轴线的平面内是二维（$2$D）的。圆柱体相对于远场以速度 $U$ 平移，或者等效地，流体以速度 $U$ 的均匀流经过一个固定的圆柱体。基于圆柱半径的雷诺数 (Re) 为 $Re = \\rho U a / \\mu$。\n\n从稳态不可压缩纳维-斯托克斯方程，\n$$\n\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u} = - \\nabla p + \\mu \\nabla^2 \\mathbf{u}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\n以及忽略 $\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u}$ 的斯托克斯极限 $Re \\to 0$ 出发，从第一性原理上论证，为何在一个无界域中，在无穷远处施加均匀流动的条件无法得到一个既满足圆柱体上无滑移条件（在圆柱坐标系中 $r=a$ 处 $\\mathbf{u}=\\mathbf{0}$）又满足 $r \\to \\infty$ 时为均匀流动的稳态解。然后考虑两种正则化方法：\n- 一个半径为 $R \\gg a$ 的有限圆形域，其外边界 $r=R$ 上有给定的均匀速度 $U$。\n- Oseen 线性化，它保留了关于均匀背景速度 $U$ 的主阶惯性项，从而产生一个有效的外部长度尺度。\n\n仅使用控制方程、远场结构和二维斯托克斯基本解的性质，确定哪些关于该悖论的本质、圆柱体上单位长度阻力 $f$ 的标度关系以及对长岩石圈包体地球物理建模的启示的陈述是正确的。\n\n选择所有适用项。\n\nA. 在无界域中，对于无穷远处为均匀流的圆柱体绕流问题，稳态二维斯托克斯问题无解，因为流函数的一般双调和解必然包含一个关于 $r$ 的对数项，该项的系数无法被选择来同时满足在 $r=a$ 处的无滑移条件和在 $r \\to \\infty$ 时的有界均匀速度。\n\nB. 将流动限制在半径为 $R$ 的有限圆形域内，可以对斯托克斯问题进行正则化；在主阶上，单位长度的阻力标度关系为 $f \\sim \\dfrac{4 \\pi \\mu U}{\\ln \\!\\left( R / a \\right)}$，这反映了其对外部尺度 $R$ 的对数敏感性。\n\nC. 在小雷诺数 $Re$ 的 Oseen 近似下，有效外部尺度为 $L_O \\sim a / Re$，且当 $Re \\to 0$ 时，产生的单位长度阻力标度关系为 $f \\sim \\dfrac{4 \\pi \\mu U}{Re}$。\n\nD. 对于非常长的岩石圈包体（近似为二维圆柱体）的地球物理应用，斯托克斯悖论意味着在小雷诺数 $Re$ 下，单位长度的阻力变得与域的大小无关，因此阻力是尺度不变的。\n\nE. 在长包体的计算模型中，选择过小的计算域（小的 $R/a$）会系统性地高估阻力，因为对外部尺度的对数依赖性在计算域尺寸处被截断，从而增加了 $f \\propto 1/\\ln(R/a)$。",
            "solution": "用户需要对问题陈述进行审慎验证，然后提供详细的解答和对所提供选项的评估。\n\n### 第1步：提取已知条件\n- **系统**：牛顿流体围绕半径为 $a$ 的无限长圆柱体的稳态、不可压缩二维流动。\n- **流体性质**：动力粘度 $\\mu$，密度 $\\rho$。\n- **流动状态**：蠕动流，斯托克斯区域，其特征为雷诺数 $Re = \\rho U a / \\mu \\to 0$。\n- **相对运动**：圆柱体相对于远场以速度 $U$ 平移，或流体以速度 $U$ 经过一个固定的圆柱体。\n- **控制方程（完整）**：稳态不可压缩纳维-斯托克斯方程：\n$$ \\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u} = - \\nabla p + \\mu \\nabla^2 \\mathbf{u} $$\n$$ \\nabla \\cdot \\mathbf{u} = 0 $$\n- **控制方程（近似）**：斯托克斯方程，通过忽略惯性项 $\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u}$ 得到。\n- **问题**：从第一性原理出发，论证为何在一个无界域中，对于受限于圆柱体上无滑移条件（$r=a$ 处 $\\mathbf{u}=\\mathbf{0}$）和无穷远处均匀流条件（$r \\to \\infty$ 时 $\\mathbf{u} \\to U \\mathbf{\\hat{e}}_x$）的斯托克斯流动问题，无法找到稳态解。评估关于这个悖论（称为斯托克斯悖论）、两种正则化方法（有限域、Oseen 线性化）及其启示的陈述。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学基础**：该问题是流体动力学中的一个经典问题，其在计算地球物理学中的应用是恰当的。纳维-斯托克斯方程和斯托克斯方程是基础。斯托克斯悖论是一个公认的概念。所有要素在科学上都是合理的。\n2.  **适定性**：该问题要求分析一个著名的不适定边值问题（无界二维斯托克斯流）。问题本身，即解释*为什么*它不适定并分析其正则化方法，是适定的，并且是高等流体力学中的一个标准课题。\n3.  **客观性**：问题使用了精确、客观和形式化的数学和物理语言进行陈述。不存在模糊性或主观性元素。\n4.  **完整性**：问题提供了所有必要的信息，以便对悖论进行推理并评估与正则化相关的标度律。它是自洽的。\n\n### 第3步：结论与行动\n问题陈述是**有效的**。这是一个关于流体力学标准课题的正确且适定的问题。我将继续进行解答。\n\n### 推导与选项分析\n\n该问题围绕二维流绕圆柱体的斯托克斯悖论展开。我们首先分析控制方程。\n\n**1. 二维斯托克斯流动方程与双调和解**\n\n对于稳态、不可压缩的二维流动，不可压缩条件 $\\nabla \\cdot \\mathbf{u} = 0$ 可以通过引入一个流函数 $\\psi(r, \\theta)$ 来自动满足，使得极坐标中的速度分量为：\n$$ u_r = \\frac{1}{r} \\frac{\\partial \\psi}{\\partial \\theta}, \\quad u_\\theta = - \\frac{\\partial \\psi}{\\partial r} $$\n对斯托克斯动量方程（$\\nabla p = \\mu \\nabla^2 \\mathbf{u}$）取旋度可以消除压力项，并得到流函数的双调和方程：\n$$ \\nabla^4 \\psi = \\nabla^2(\\nabla^2 \\psi) = 0 $$\n对于无穷远处沿 x 轴方向存在均匀来流 $U$ 的绕圆柱流动，流动必须关于 x 轴对称，这意味着流函数具有 $\\sin\\theta$ 的依赖关系。具有这种对称性的 $\\psi(r, \\theta)$ 的通解为：\n$$ \\psi(r, \\theta) = \\left( \\frac{A}{r} + Br + Cr\\ln r + Dr^3 \\right) \\sin\\theta $$\n速度分量则为：\n$$ u_r = \\frac{1}{r} \\frac{\\partial \\psi}{\\partial \\theta} = \\left( \\frac{A}{r^2} + B + C\\ln r + Dr^2 \\right) \\cos\\theta $$\n$$ u_\\theta = - \\frac{\\partial \\psi}{\\partial r} = - \\left( -\\frac{A}{r^2} + B + \\frac{C}{r}r\\frac{1}{r} + C\\ln r + 3Dr^2 \\right) \\sin\\theta \\quad \\text{推导有误。让我们精确一些。} $$\n$$ u_\\theta = - \\frac{\\partial}{\\partial r} \\left( \\frac{A}{r} + Br + Cr\\ln r + Dr^3 \\right) \\sin\\theta = - \\left( -\\frac{A}{r^2} + B + C(1+\\ln r) + 3Dr^2 \\right) \\sin\\theta $$\n\n**2. 无界域中的悖论**\n\n我们应用无界问题的边界条件：\n-   **远场条件**：当 $r \\to \\infty$ 时，流动必须趋近于均匀流，$\\mathbf{u} \\to U \\mathbf{\\hat{e}}_x$。在极坐标中，这表示为 $u_r \\to U\\cos\\theta$ 和 $u_\\theta \\to -U\\sin\\theta$。\n-   **无滑移条件**：在圆柱表面 $r=a$ 处，速度必须为零，$\\mathbf{u}(a, \\theta) = \\mathbf{0}$，因此 $u_r(a, \\theta) = 0$ 和 $u_\\theta(a, \\theta) = 0$。\n\n让我们检查远场速度。当 $r \\to \\infty$ 时：\n$$ u_r \\sim \\left( C\\ln r + Dr^2 \\right) \\cos\\theta $$\n$$ u_\\theta \\sim - \\left( C\\ln r + 3Dr^2 \\right) \\sin\\theta $$\n为了使速度在 $r \\to \\infty$ 时有界，更不用说均匀了，随 $r$ 增长的项的系数必须为零。这要求 $D=0$ 和 $C=0$。\n如果 $D=0$ 和 $C=0$，解变为：\n$$ \\psi(r, \\theta) = \\left( \\frac{A}{r} + Br \\right) \\sin\\theta $$\n速度为：\n$$ u_r = \\left( \\frac{A}{r^2} + B \\right) \\cos\\theta, \\quad u_\\theta = - \\left( -\\frac{A}{r^2} + B \\right) \\sin\\theta $$\n当 $r \\to \\infty$ 时应用远场条件（$u_r \\to U\\cos\\theta$，$u_\\theta \\to -U\\sin\\theta$）要求 $B=U$。\n所以，$\\psi(r, \\theta) = \\left( \\frac{A}{r} + Ur \\right) \\sin\\theta$。\n现在，我们在 $r=a$ 处应用无滑移条件：\n-   $u_r(a, \\theta) = \\left( \\frac{A}{a^2} + U \\right) \\cos\\theta = 0 \\implies A = -Ua^2$。\n-   $u_\\theta(a, \\theta) = - \\left( -\\frac{A}{a^2} + U \\right) \\sin\\theta = 0 \\implies - \\left( - \\frac{(-Ua^2)}{a^2} + U \\right) \\sin\\theta = - (U+U) \\sin\\theta = -2U\\sin\\theta = 0$。\n这最后一个条件只有在 $U=0$（无流动）时才能满足，这是一个平凡情况。对于任何 $U \\neq 0$，$u_\\theta$ 上的无滑移条件都被违反。\n问题的核心在于，为了满足均匀流的远场条件，我们必须设置 $C=0$，但剩余的自由度不足以同时满足圆柱表面的两个速度分量的无滑移条件。这就是斯托克斯悖论。\n\n**3. 通过有限域进行正则化**\n\n现在考虑限制在有限域 $a \\le r \\le R$ 内的流动，外边界 $r=R$ 处 $\\mathbf{u} = U\\mathbf{\\hat{e}}_x$。通解中的 $Dr^3$ 项可以忽略，因为它对应于一个并非由边界上均匀运动驱动的流动结构。我们使用 $\\psi(r, \\theta) = (A/r + Br + Cr \\ln r)\\sin\\theta$。求解所有常数的过程是繁琐的，但其物理意义可以通过标度分析来理解。悖论源于圆柱体的长程效应，这体现为对数项。将域限制在有限范围内提供了一个外部长度尺度 $R$。量纲分析表明，单位长度阻力 $f$ 的形式必为 $f = \\mu U g(R/a)$。二维基本解（斯托克斯子）的对数性质决定了这个函数将是对数形式的。从完整解（或匹配渐近展开）得到的既定结果是，对于 $R \\gg a$：\n$$ f \\sim \\frac{4\\pi \\mu U}{\\ln(R/a) + O(1)} $$\n在主阶上，阻力的标度关系为 $f \\propto 1/\\ln(R/a)$。\n\n**4. 通过 Oseen 近似进行正则化**\n\nOseen 近似部分地恢复了惯性项：$\\rho (\\mathbf{U} \\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2\\mathbf{u}$。这引入了一个新的长度尺度。惯性项大约为 $\\rho U (U/L)$，而粘性项为 $\\mu (U/L^2)$。Oseen 线性化保留了一个量级为 $\\rho U (u/L)$ 的项。当该项与粘性项 $\\mu u/L_O^2$ 相当时的长度尺度 $L_O$ 可以通过平衡 $\\rho U u/L_O \\sim \\mu u/L_O^2$ 找到，这给出 $L_O \\sim \\mu/(\\rho U)$。\n使用雷诺数 $Re = \\rho U a / \\mu$，这个外部尺度是 $L_O = a/Re$。\n对于小雷诺数 $Re$，Oseen 问题的解给出的单位长度阻力为：\n$$ f = \\frac{4\\pi \\mu U}{\\ln(1/Re) - \\gamma + \\ln(4) + O(Re)} \\approx \\frac{4\\pi \\mu U}{\\ln(1/Re)} $$\n其中 $\\gamma$ 是欧拉-马歇罗尼常数。这个结果与有限域的结果是类似的，如果我们把外部尺度 $R$ 等同于 $L_O \\sim a/Re$，因为 $\\ln(R/a) \\sim \\ln((a/Re)/a) = \\ln(1/Re)$。\n\n### 逐项分析\n\n**A. 在无界域中，对于无穷远处为均匀流的圆柱体绕流问题，稳态二维斯托克斯问题无解，因为流函数的一般双调和解必然包含一个关于 $r$ 的对数项，该项的系数无法被选择来同时满足在 $r=a$ 处的无滑移条件和在 $r \\to \\infty$ 时的有界均匀速度。**\n\n这个陈述准确地描述了该悖论。如第 2 节所示，为了在无穷远处获得有界速度，流函数 $\\psi$ 中 $r\\ln r$ 项的系数 $C$ 必须为零。然而，在 $C=0$ 的情况下，剩余的项没有足够的自由度来满足在 $r=a$ 处的无滑移条件（$u_r=0$ 和 $u_\\theta=0$）。反之，满足无滑移条件需要 $C \\neq 0$，但这会导致速度在无穷远处对数发散，从而违反了均匀流条件。\n**结论：正确。**\n\n**B. 将流动限制在半径为 $R$ 的有限圆形域内，可以对斯托克斯问题进行正则化；在主阶上，单位长度的阻力标度关系为 $f \\sim \\dfrac{4 \\pi \\mu U}{\\ln \\!\\left( R / a \\right)}$，这反映了其对外部尺度 $R$ 的对数敏感性。**\n\n这是受限斯托克斯流问题的标准结果，如第 3 节所讨论。引入外部长度尺度 $R$ 消除了数学上的不一致性，但解通过其对 $R$ 的缓慢、对数形式的依赖性衰减保留了悖论的“记忆”。这种标度关系被更高级的技术（如匹配渐近展开）所证实，并且与 Oseen 近似一致。\n**结论：正确。**\n\n**C. 在小雷诺数 $Re$ 的 Oseen 近似下，有效外部尺度为 $L_O \\sim a / Re$，且当 $Re \\to 0$ 时，产生的单位长度阻力标度关系为 $f \\sim \\dfrac{4 \\pi \\mu U}{Re}$。**\n\n陈述的第一部分是正确的：Oseen 长度尺度是 $L_O \\sim a/Re$。然而，第二部分声称了一个不正确的阻力标度关系。如第 4 节所示，阻力的标度关系为 $f \\propto 1/\\ln(1/Re)$，而不是 $1/Re$。当 $Re \\to 0$ 时，$1/Re$ 比 $\\ln(1/Re)$ 增长得快得多，因此所述的标度关系是错误的。\n**结论：不正确。**\n\n**D. 对于非常长的岩石圈包体（近似为二维圆柱体）的地球物理应用，斯托克斯悖论意味着在小雷诺数 $Re$ 下，单位长度的阻力变得与域的大小无关，因此阻力是尺度不变的。**\n\n这个陈述与从斯托克斯悖论分析中得出的结论相反。该悖论及其正则化方法（有限域和 Oseen 近似）都明确表明，阻力对外部长度尺度（$R$ 或 $a/Re$）具有持久的、长程的依赖性。阻力与 $1/\\ln(R/a)$ 成正比，这关键性地依赖于域的大小 $R$。它不是尺度不变的。这与三维斯托克斯流（例如，绕球流动）有关键区别，在三维情况下，无界域中的阻力与远场无关。\n**结论：不正确。**\n\n**E. 在长包体的计算模型中，选择过小的计算域（小的 $R/a$）会系统性地高估阻力，因为对外部尺度的对数依赖性在计算域尺寸处被截断，从而增加了 $f \\propto 1/\\ln(R/a)$。**\n\n阻力定律为 $f \\propto 1/\\ln(R/a)$。对于 $x=R/a  1$，函数 $g(x) = 1/\\ln(x)$ 是 $x$ 的单调递减函数。这意味着随着域尺寸比 $R/a$ 的减小，$\\ln(R/a)$ 减小，因此 $1/\\ln(R/a)$ 增大。因此，使用一个较小的计算域（对于固定的 $a$ 使用较小的 $R$）将导致计算出的阻力更大。该陈述正确地指出了这对数值模拟的实际影响。\n**结论：正确。**",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "本练习将理论与实践相结合，要求你构建一个功能完备的计算模型来解决一个核心的地球动力学问题。由浮力驱动的蠕变流是地幔对流等过程的基础，而本练习将指导你使用谱方法（基于快速傅里叶变换）来求解这一耦合了成分扩散的斯托克斯流问题。通过这项动手实践，你将学习如何将偏微分控制方程组转化为一个强大而精确的数值求解器，以探索复杂的地球内部流动模式 。",
            "id": "3582751",
            "problem": "考虑一个边长为 $L$（单位：$\\mathrm{m}$）的周期性方形区域中的二维、不可压缩、稳态斯托克斯流。该流动由一个标量组分场 $c(\\mathbf{x})$ 产生的浮力驱动，而该组分场受带有指定源项的稳态扩散方程控制。斯托克斯流态意味着惯性可以忽略不计。控制场为速度场 $\\mathbf{u}(\\mathbf{x})$、压力场 $p(\\mathbf{x})$ 和组分场 $c(\\mathbf{x})$。物理参数包括动力粘度 $\\mu$（单位：$\\mathrm{Pa\\cdot s}$）、单位组分的密度差 $\\Delta \\rho$（单位：$\\mathrm{kg/m^3}$）以及重力加速度矢量 $\\mathbf{g}$（单位：$\\mathrm{m/s^2}$）。由于稳态扩散方程中 $c$ 是无量纲的，标量源 $S(\\mathbf{x})$ 的单位为 $\\mathrm{m^{-2}}$。\n\n假设在区域 $[0,L)\\times[0,L)$ 上，所有场在两个空间方向上均满足周期性边界条件。采用恒定重力 $\\mathbf{g} = (0,-g)$，其中 $g0$。流体满足不可压缩性。在物理空间中，稳态蠕动流场和组分场满足以下方程：\n- 不可压缩性: $\\nabla \\cdot \\mathbf{u} = 0$,\n- 动量平衡: $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\Delta \\rho\\, c\\, \\mathbf{g} = \\mathbf{0}$,\n- 组分扩散: $\\nabla^2 c = - S$.\n\n从这些方程出发，仅使用基本原理（线性动量平衡、不可压缩性和稳态扩散），推导一种使用快速傅里叶变换（FFT）的谱精度数值方法，用于在网格间距为 $L/N$ 的均匀 $N\\times N$ 网格上求解 $\\mathbf{u}(\\mathbf{x})$ 和 $c(\\mathbf{x})$。您必须在周期性设置下工作，并实现与上述方程一致的方法，使用适用于边长为 $L$ 的周期性区域的波数矢量表示。\n\n对于本问题，物理空间中的源项取为\n$S(x,y) = S_0 \\cos\\!\\left(\\frac{2\\pi m x}{L}\\right)\\cos\\!\\left(\\frac{2\\pi n y}{L}\\right)$\n其中 $m,n \\ge 0$ 为整数， $S_0$ 为振幅（单位：$\\mathrm{m^{-2}}$），坐标 $(x,y) \\in [0,L)\\times[0,L)$。当 $m$ 或 $n$ 至少有一个非零时，函数 $S(x,y)$ 是周期的且均值为零。\n\n您的程序必须为每个指定的参数集计算均方根速率\n$U_{\\mathrm{rms}} = \\left( \\frac{1}{L^2}\\int_0^L\\int_0^L \\left\\|\\mathbf{u}(x,y)\\right\\|^2 \\, \\mathrm{d}x\\,\\mathrm{d}y \\right)^{1/2}$\n其中速度场 $\\mathbf{u}$ 是通过谱方法计算得到的。请将 $U_{\\mathrm{rms}}$ 以 $\\mathrm{m/s}$ 为单位表示。将每个结果四舍五入到 $6$ 位小数。\n\n测试套件。使用以下五个参数集来测试您的实现。在所有情况下，都使用边长 $L = 1.0$（单位：$\\mathrm{m}$）的方形区域和 $N = 64$ 的均匀网格。对于重力，取 $\\mathbf{g} = (0,-g)$。\n\n- 情况 A (基线，非零强迫): $\\mu = 100.0$ (单位: $\\mathrm{Pa\\cdot s}$), $\\Delta \\rho = 10.0$ (单位: $\\mathrm{kg/m^3}$), $g = 9.81$ (单位: $\\mathrm{m/s^2}$), $S_0 = 1.0$ (单位: $\\mathrm{m^{-2}}$), $m=1$, $n=1$。\n- 情况 B (无源，应产生零流速): $\\mu = 100.0$, $\\Delta \\rho = 10.0$, $g = 9.81$, $S_0 = 0.0$, $m=1$, $n=1$。\n- 情况 C (高粘度，弱流): $\\mu = 100000.0$, $\\Delta \\rho = 10.0$, $g = 9.81$, $S_0 = 1.0$, $m=1$, $n=1$。\n- 情况 D (较短波长，流速振幅减小): $\\mu = 100.0$, $\\Delta \\rho = 10.0$, $g = 9.81$, $S_0 = 1.0$, $m=3$, $n=2$。\n- 情况 E (无重力，应产生零流速): $\\mu = 100.0$, $\\Delta \\rho = 10.0$, $g = 0.0$, $S_0 = 1.0$, $m=1$, $n=1$。\n\n最终输出格式。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,r4,r5]”），其中每个 $r_k$ 是对应情况的 $U_{\\mathrm{rms}}$ 值，单位为 $\\mathrm{m/s}$，并四舍五入到恰好 $6$ 位小数。不应打印任何额外文本。输出必须按 [情况 A, 情况 B, 情况 C, 情况 D, 情况 E] 的顺序排列。\n\n需要遵守的假设：\n- 严格在斯托克斯（蠕动流）流态下工作。\n- 使用与谱导数一致的周期性边界条件。\n- 确保 $c$ 的均值被设定，以使 $\\mathbf{k}=\\mathbf{0}$ 傅里叶模式的处理方式与方程和周期性保持一致。\n- 使用适用于尺寸为 $L$ 的盒子的适当波数矢量，即角波数 $k_x = 2\\pi\\,\\ell_x/L$, $k_y = 2\\pi\\,\\ell_y/L$，其中 $\\ell_x,\\ell_y$ 是与离散傅里叶变换网格一致的整数频率。",
            "solution": "该问题要求推导并实现一种谱方法，用于求解周期性区域内由浮力驱动的斯托克斯流。解必须在傅里叶空间中使用快速傅里叶变换 (FFT) 进行计算。\n\n### **1. 问题验证**\n\n首先，根据指定的标准对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- **控制方程:**\n    - 不可压缩性: $\\nabla \\cdot \\mathbf{u} = 0$\n    - 动量平衡: $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\Delta \\rho\\, c\\, \\mathbf{g} = \\mathbf{0}$\n    - 组分扩散: $\\nabla^2 c = -S$\n- **区域和边界条件:** 一个二维方形区域 $[0,L)\\times[0,L)$，所有场（$\\mathbf{u}$, $p$, $c$）都具有周期性边界条件。\n- **物理参数:** 动力粘度 $\\mu$，密度差 $\\Delta \\rho$，重力加速度矢量 $\\mathbf{g} = (0,-g)$ 且 $g0$。\n- **源项:** $S(x,y) = S_0 \\cos\\!\\left(\\frac{2\\pi m x}{L}\\right)\\cos\\!\\left(\\frac{2\\pi n y}{L}\\right)$，具有整数模态 $m, n \\ge 0$ 和振幅 $S_0$。\n- **数值设置:** 均匀的 $N \\times N$ 网格。\n- **输出:** 均方根速率 $U_{\\mathrm{rms}} = \\left( \\frac{1}{L^2}\\int_0^L\\int_0^L \\left\\|\\mathbf{u}(x,y)\\right\\|^2 \\, \\mathrm{d}x\\,\\mathrm{d}y \\right)^{1/2}$。\n- **测试用例:** 提供了五组参数集 $(\\mu, \\Delta\\rho, g, S_0, m, n)$，固定 $L=1.0$ 和 $N=64$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了浮力驱动蠕动流的一种典型 Boussinesq 型近似，这是地球物理学和流体动力学中的一个标准和基本模型。控制方程是成熟的斯托克斯方程，与一个对流-扩散方程（此处简化为稳态扩散）耦合。这在科学上是合理的。\n- **适定性**：该问题提供了一套完整的线性偏微分方程组，具有周期性边界条件和明确定义的强迫项。对于指定的源项（其中 m 或 n 非零，确保均值为零），该系统对于速度场和组分场有唯一解（压力场除一个常数外，但这不影响速度）。该问题是适定的。\n- **客观性**：问题陈述使用了精确的数学和物理术语，没有主观或模棱两可的语言。\n\n**步骤 3：结论与行动**\n该问题在科学上是合理的、适定的、客观的和自洽的。因此，它被认为是**有效的**。我们可以继续进行求解。\n\n### **2. 谱解的推导**\n\n区域的周期性使得傅里叶级数成为表示这些场的理想基。任何场 $f(\\mathbf{x})$ 都可以写成傅里叶级数：\n$$\nf(\\mathbf{x}) = \\sum_{\\mathbf{k}} \\hat{f}(\\mathbf{k}) e^{i \\mathbf{k} \\cdot \\mathbf{x}}\n$$\n其中 $\\mathbf{x}=(x,y)$ 是空间坐标，$\\mathbf{k}=(k_x, k_y)$ 是波数矢量。对于边长为 $L$ 的周期性区域，波数矢量的分量是量子化的：$k_x = \\frac{2\\pi \\ell_x}{L}$ 和 $k_y = \\frac{2\\pi \\ell_y}{L}$，其中 $\\ell_x, \\ell_y$ 为整数。\n\n在傅里叶空间中，微分算子变为代数乘法：\n- 梯度: $\\nabla f \\rightarrow i\\mathbf{k} \\hat{f}(\\mathbf{k})$\n- 散度: $\\nabla \\cdot \\mathbf{u} \\rightarrow i\\mathbf{k} \\cdot \\hat{\\mathbf{u}}(\\mathbf{k})$\n- 拉普拉斯算子: $\\nabla^2 f \\rightarrow -|\\mathbf{k}|^2 \\hat{f}(\\mathbf{k}) = -(k_x^2 + k_y^2) \\hat{f}(\\mathbf{k})$\n\n将此变换应用于控制方程，可以得到关于每个波数矢量 $\\mathbf{k}$ 下各场傅里叶系数的代数方程组：\n\n1.  **不可压缩性:**\n    $$i\\mathbf{k} \\cdot \\hat{\\mathbf{u}}(\\mathbf{k}) = 0$$\n    这个条件意味着在傅里叶空间中，速度矢量 $\\hat{\\mathbf{u}}(\\mathbf{k})$ 与波数矢量 $\\mathbf{k}$ 正交。\n\n2.  **组分扩散:**\n    $$-|\\mathbf{k}|^2 \\hat{c}(\\mathbf{k}) = -\\hat{S}(\\mathbf{k})$$\n    对于任何非零波数矢量 $\\mathbf{k} \\ne \\mathbf{0}$，组分系数由源项直接确定：\n    $$\\hat{c}(\\mathbf{k}) = \\frac{\\hat{S}(\\mathbf{k})}{|\\mathbf{k}|^2}$$\n    对于零波数矢量 $\\mathbf{k} = \\mathbf{0}$（对应于空间平均值），方程变为 $0 = -\\hat{S}(\\mathbf{0})$。对于给定的测试用例（其中 $m$ 或 $n$ 非零），所提供的源项均值为零（$\\hat{S}(\\mathbf{0}) = 0$），因此这是一致的。该方程不约束平均组分 $\\hat{c}(\\mathbf{0})$。然而，如下所示，动量方程的一致性要求 $\\hat{c}(\\mathbf{0})=0$。\n\n3.  **动量平衡:**\n    $$-i\\mathbf{k} \\hat{p}(\\mathbf{k}) - \\mu |\\mathbf{k}|^2 \\hat{\\mathbf{u}}(\\mathbf{k}) + \\Delta \\rho\\, \\hat{c}(\\mathbf{k})\\, \\mathbf{g} = \\mathbf{0}$$\n    对于 $\\mathbf{k} = \\mathbf{0}$，方程简化为 $\\Delta \\rho\\, \\hat{c}(\\mathbf{0})\\, \\mathbf{g} = \\mathbf{0}$。给定 $\\Delta \\rho \\ne 0$ 和 $\\mathbf{g} \\ne \\mathbf{0}$，我们必须强制 $\\hat{c}(\\mathbf{0}) = 0$。平均速度 $\\hat{\\mathbf{u}}(\\mathbf{0})$ 不能由此方程确定，但在没有净外力的情况下，我们将平均流速设为零，即 $\\hat{\\mathbf{u}}(\\mathbf{0})=\\mathbf{0}$。\n\n对于 $\\mathbf{k} \\ne \\mathbf{0}$，我们可以求解 $\\hat{\\mathbf{u}}(\\mathbf{k})$。首先，我们通过将动量方程与 $i\\mathbf{k}$ 做点积并应用不可压缩条件 $i\\mathbf{k} \\cdot \\hat{\\mathbf{u}}(\\mathbf{k}) = 0$ 来消去压力 $\\hat{p}(\\mathbf{k})$：\n$$i\\mathbf{k} \\cdot (-i\\mathbf{k} \\hat{p}(\\mathbf{k})) - \\mu |\\mathbf{k}|^2 (i\\mathbf{k} \\cdot \\hat{\\mathbf{u}}(\\mathbf{k})) + i\\mathbf{k} \\cdot (\\Delta \\rho\\, \\hat{c}(\\mathbf{k})\\, \\mathbf{g}) = 0$$\n$$|\\mathbf{k}|^2 \\hat{p}(\\mathbf{k}) + i \\Delta \\rho\\, \\hat{c}(\\mathbf{k}) (\\mathbf{k} \\cdot \\mathbf{g}) = 0$$\n$$\\hat{p}(\\mathbf{k}) = -i \\frac{\\Delta \\rho\\, \\hat{c}(\\mathbf{k}) (\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2}$$\n将此代回动量方程：\n$$-i\\mathbf{k} \\left(-i \\frac{\\Delta \\rho\\, \\hat{c}(\\mathbf{k}) (\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2}\\right) - \\mu |\\mathbf{k}|^2 \\hat{\\mathbf{u}}(\\mathbf{k}) + \\Delta \\rho\\, \\hat{c}(\\mathbf{k})\\, \\mathbf{g} = \\mathbf{0}$$\n$$-\\frac{\\mathbf{k}(\\Delta \\rho\\, \\hat{c}(\\mathbf{k}) (\\mathbf{k} \\cdot \\mathbf{g}))}{|\\mathbf{k}|^2} - \\mu |\\mathbf{k}|^2 \\hat{\\mathbf{u}}(\\mathbf{k}) + \\Delta \\rho\\, \\hat{c}(\\mathbf{k})\\, \\mathbf{g} = \\mathbf{0}$$\n重新整理以求解 $\\hat{\\mathbf{u}}(\\mathbf{k})$:\n$$\\mu |\\mathbf{k}|^2 \\hat{\\mathbf{u}}(\\mathbf{k}) = \\Delta \\rho\\, \\hat{c}(\\mathbf{k}) \\left( \\mathbf{g} - \\frac{\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2} \\right)$$\n括号中的项是一个投影算子，它将矢量 $\\mathbf{g}$ 投影到与 $\\mathbf{k}$ 垂直的平面上。代入 $\\hat{c}(\\mathbf{k}) = \\hat{S}(\\mathbf{k})/|\\mathbf{k}|^2$:\n$$\\hat{\\mathbf{u}}(\\mathbf{k}) = \\frac{\\Delta \\rho\\, \\hat{S}(\\mathbf{k})}{\\mu |\\mathbf{k}|^4} \\left( \\mathbf{g} - \\frac{\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2} \\right)$$\n这为所有 $\\mathbf{k} \\ne \\mathbf{0}$ 提供了速度谱。\n\n### **3. 数值算法与均方根速率**\n\n该问题在 $N \\times N$ 网格上进行数值求解。连续傅里叶级数系数 $\\hat{f}(\\mathbf{k})$ 被其来自 FFT 的离散对应物 $F_k$ 所取代。对于在网格上采样的场 $f$，其二维 DFT 为 $F_k = \\sum_{j_x, j_y} f_{j_x, j_y} e^{-i(k_x x_{j_x} + k_y y_{j_y})}$。对于这些离散系数，控制方程保持相同的形式。\n\n算法如下：\n1.  **网格设置:** 为尺寸为 $L$ 的 $N \\times N$ 区域定义一个物理网格 $(x_j, y_l)$ 和一个对应的波数矢量网格 $(k_x, k_y)$。角波数为 $k_i = 2\\pi f_i$，其中 $f_i$ 是由 `numpy.fft.fftfreq` 给出的频率。\n2.  **源项:** 在物理网格上计算源项 $S(x,y)$。\n3.  **源项的 FFT:** 计算源项的二维 DFT，$S_k = \\text{FFT2}(S(x,y))$。\n4.  **速度谱:** 使用推导出的公式计算速度分量的 DFT 系数 $U_{x,k}$ 和 $U_{y,k}$。当 $\\mathbf{g} = (0, -g)$ 和 $\\mathbf{k} = (k_x, k_y)$ 时，$\\mathbf{g} - \\frac{\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2}$ 的分量是 $(\\frac{g k_x k_y}{|\\mathbf{k}|^2}, -\\frac{g k_x^2}{|\\mathbf{k}|^2})$。这给出：\n    $$U_{x,k} = \\frac{\\Delta \\rho\\, S_k}{\\mu |\\mathbf{k}|^4} \\left( \\frac{g k_x k_y}{|\\mathbf{k}|^2} \\right) = \\frac{\\Delta \\rho\\, g}{\\mu} \\frac{S_k k_x k_y}{|\\mathbf{k}|^6}$$\n    $$U_{y,k} = \\frac{\\Delta \\rho\\, S_k}{\\mu |\\mathbf{k}|^4} \\left( -\\frac{g k_x^2}{|\\mathbf{k}|^2} \\right) = -\\frac{\\Delta \\rho\\, g}{\\mu} \\frac{S_k k_x^2}{|\\mathbf{k}|^6}$$\n    这些公式仅在 $|\\mathbf{k}| \\ne 0$ 时应用。对于 $|\\mathbf{k}|=0$，$U_k = 0$。\n\n5.  **均方根速率计算:** 均方根速率 $U_{\\mathrm{rms}}$ 使用 Parseval 定理计算，该定理将函数的平方积分与其傅里叶系数的平方和联系起来。对于在 `numpy` 中实现的二维 DFT：\n    $$\\sum_{j_x=0}^{N-1} \\sum_{j_y=0}^{N-1} |f(x_{j_x}, y_{j_y})|^2 = \\frac{1}{N^2} \\sum_{k_x, k_y} |F_k|^2$$\n    $U_{\\mathrm{rms}}^2$ 的定义可以通过网格点上的和来近似：\n    $$U_{\\mathrm{rms}}^2 = \\frac{1}{L^2}\\int_0^L\\int_0^L \\|\\mathbf{u}\\|^2 \\,dx\\,dy \\approx \\frac{1}{L^2} \\sum_{j_x, j_y} \\|\\mathbf{u}(x_{j_x}, y_{j_y})\\|^2 \\left(\\frac{L}{N}\\right)^2 = \\frac{1}{N^2} \\sum_{j_x, j_y} \\|\\mathbf{u}_{j_x, j_y}\\|^2$$\n    对速度的每个分量应用 Parseval 定理：\n    $$U_{\\mathrm{rms}}^2 = \\frac{1}{N^2} \\left( \\sum_{j_x,j_y} |u_x|^2 + \\sum_{j_x,j_y} |u_y|^2 \\right) = \\frac{1}{N^2} \\left( \\frac{1}{N^2}\\sum_{k} |U_{x,k}|^2 + \\frac{1}{N^2}\\sum_{k} |U_{y,k}|^2 \\right)$$\n    $$U_{\\mathrm{rms}} = \\frac{1}{N^2} \\sqrt{ \\sum_{\\mathbf{k}} \\left( |U_{x,k}|^2 + |U_{y,k}|^2 \\right) }$$\n    这允许直接从计算出的速度谱高效地计算 $U_{\\mathrm{rms}}$，而无需执行逆 FFT。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for Stokes flow for all test cases and print results.\n    \"\"\"\n\n    test_cases = [\n        # Case A: (mu, delta_rho, g, S0, m, n)\n        (100.0, 10.0, 9.81, 1.0, 1, 1),\n        # Case B:\n        (100.0, 10.0, 9.81, 0.0, 1, 1),\n        # Case C:\n        (100000.0, 10.0, 9.81, 1.0, 1, 1),\n        # Case D:\n        (100.0, 10.0, 9.81, 1.0, 3, 2),\n        # Case E:\n        (100.0, 10.0, 0.0, 1.0, 1, 1),\n    ]\n\n    results = []\n    for params in test_cases:\n        u_rms = calculate_rms_speed(*params)\n        results.append(f\"{u_rms:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_rms_speed(mu, delta_rho, g, S0, m, n):\n    \"\"\"\n    Calculates the root-mean-square speed for a given set of physical parameters.\n\n    The method solves the steady, incompressible Stokes equations driven by buoyancy\n    in a 2D periodic domain using a spectral (FFT-based) method.\n\n    Parameters:\n    mu (float): Dynamic viscosity (Pa.s)\n    delta_rho (float): Density contrast per unit composition (kg/m^3)\n    g (float): Gravitational acceleration magnitude (m/s^2)\n    S0 (float): Source term amplitude (m^-2)\n    m, n (int): Wavenumbers of the source term\n\n    Returns:\n    float: The root-mean-square speed (U_rms) in m/s.\n    \"\"\"\n    # Grid and domain parameters as specified in the problem\n    L = 1.0  # m\n    N = 64\n    \n    # Handle trivial cases where no flow is expected\n    if S0 == 0.0 or g == 0.0:\n        return 0.0\n\n    # 1. Set up physical and spectral grids\n    # Physical grid coordinates\n    x = (L / N) * np.arange(N)\n    X, Y = np.meshgrid(x, x, indexing='ij')\n\n    # Spectral grid wavenumbers (angular)\n    freq = np.fft.fftfreq(N, d=L / N)\n    k = 2 * np.pi * freq\n    Kx, Ky = np.meshgrid(k, k, indexing='ij')\n    \n    # Squared magnitude of the wavevector\n    K2 = Kx**2 + Ky**2\n\n    # 2. Define source term in physical space and transform to Fourier space\n    S_grid = S0 * np.cos(2 * np.pi * m * X / L) * np.cos(2 * np.pi * n * Y / L)\n    S_dft = np.fft.fft2(S_grid)\n\n    # 3. Compute velocity components in Fourier space\n    \n    # Pre-compute a common factor\n    factor = (delta_rho * g) / mu\n    \n    # To avoid division by zero at k=0, we use np.divide with a `where` clause.\n    # The velocity response at k=0 is zero anyway.\n    K6_inv = np.divide(1.0, K2**3, where=(K2 > 0), out=np.zeros_like(K2))\n\n    # Calculate DFT coefficients for velocity components u_x and u_y.\n    # U_x,k = (Δρ*g/μ) * (S_k * k_x * k_y) / |k|^6\n    # U_y,k = -(Δρ*g/μ) * (S_k * k_x^2) / |k|^6\n    \n    Ukx_dft = factor * S_dft * (Kx * Ky) * K6_inv\n    Uky_dft = -factor * S_dft * (Kx**2) * K6_inv\n\n    # 4. Calculate RMS speed using Parseval's theorem\n    # U_rms^2 = (1/N^4) * Σ_k ( |U_{x,k}|^2 + |U_{y,k}|^2 )\n    sum_sq_U_dft = np.sum(np.abs(Ukx_dft)**2 + np.abs(Uky_dft)**2)\n    \n    u_rms = (1 / N**2) * np.sqrt(sum_sq_U_dft)\n\n    return u_rms\n\nsolve()\n```"
        }
    ]
}