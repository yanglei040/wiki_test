{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的地幔对流数值模拟之前，理解控制对流启动的基本物理条件至关重要。线性稳定性分析是研究这一问题的经典理论工具，它能帮助我们确定流体从静态热传导状态转变为对流运动的临界点。本练习将引导你通过推导一个理想化模型（自由滑移边界条件下的瑞利-贝纳德对流）的临界瑞利数（$Ra_c$）和临界波数（$k_c$），亲身体验确定热对流发生阈值的过程。",
            "id": "3610794",
            "problem": "考虑一个厚度为 $H$ 的水平无限延伸的不可压缩牛顿地幔流体层，其底部加热，顶部冷却，采用 Boussinesq 近似进行建模。重力 $\\boldsymbol{g}= -g\\,\\hat{\\boldsymbol{z}}$ 方向竖直向下。设密度为 $\\rho$，运动粘度为 $\\nu$，热扩散率为 $\\kappa$，热膨胀系数为 $\\alpha$，施加于流体层上下的温差为 $\\Delta T>0$。使用热扩散时间 $H^{2}/\\kappa$ 对时间进行无量纲化，使用层厚 $H$ 对长度进行无量纲化，使用施加的温差 $\\Delta T$ 对温度进行无量纲化，使得无量纲化的垂直坐标为 $z\\in[0,1]$，瑞利数为 $Ra = \\dfrac{\\alpha g \\Delta T H^{3}}{\\nu \\kappa}$。\n\n假设适用于地幔对流的无限普朗特数极限，因此在线性化动量方程中惯性项可以忽略。设基本传导态为 $T_{0}(z)=1-z$ 和 $\\boldsymbol{u}_{0}=\\boldsymbol{0}$。考虑围绕此基态的无穷小扰动 $(\\boldsymbol{u},p,\\theta)$，其中 $\\theta$ 是温度扰动。在上下两个边界上，对温度扰动施加等温边界条件，对速度施加自由滑移边界条件：\n- $z=0$ 和 $z=1$ 处：$\\,\\theta=0$，$\\,w=0$，$\\,\\partial^{2} w/\\partial z^{2}=0$，其中 $w$ 是垂直速度。\n\n从关于传导态的无量纲线性化 Boussinesq 方程出发，\n- 不可压缩性：$\\nabla\\cdot\\boldsymbol{u}=0$；\n- 斯托克斯动量平衡：$\\boldsymbol{0}=-\\nabla p+\\nabla^{2}\\boldsymbol{u}+Ra\\,\\theta\\,\\hat{\\boldsymbol{z}}$；\n- 热量：$\\dfrac{\\partial \\theta}{\\partial t}=\\nabla^{2}\\theta+w$，\n通过寻找与 $\\exp\\!\\big(i k x+\\sigma t\\big)$ 成正比的解，进行简正模线性稳定性分析，其中 $k>0$ 为水平波数，$\\sigma$ 为增长率，$z$ 的函数为垂直结构函数。在所述边界条件下，推导垂直速度振幅 $W(z)$ 和温度振幅 $\\Theta(z)$ 的常微分特征值问题，确定基底垂直模态的中性稳定色散关系 $Ra=Ra(k)$，并通过对 $k>0$ 最小化 $Ra(k)$ 来获得自由滑移、等温边界条件下定常对流开始时的临界瑞利数 $Ra_{c}$ 和相应的临界波数 $k_{c}$。\n\n然后，定性地（用文字而非公式）解释这些临界值与上下边界均为刚性、无滑移、等温情况下的临界值有何不同，以及为什么不同。\n\n对于自由滑移、等温情况，请提供无量纲数对 $\\big(Ra_{c},\\,k_{c}\\big)$ 的精确、闭合形式表达式作为最终答案，使用 LaTeX 的 $\\pmatrix$ 约定写成单行，不进行数值四舍五入。",
            "solution": "该问题要求对一个厚度为 $H$、具有自由滑移、等温边界条件的水平无限流体层中的瑞利-贝纳德对流进行线性稳定性分析。我们需要找到定常对流开始时的临界瑞利数 $Ra_c$ 和临界波数 $k_c$。\n\n首先，我们从给定的无量纲线性化 Boussinesq 方程开始，这些方程描述了围绕静态、传导基态的速度 $\\boldsymbol{u}=(u,v,w)$、压力 $p$ 和温度 $\\theta$ 的扰动。问题设定在一个坐标系中，其中 $\\hat{\\boldsymbol{z}}$ 指向正上方，因此垂直坐标 $z$ 的范围是从 $0$ 到 $1$。方程组为：\n1. 不可压缩性：$\\nabla\\cdot\\boldsymbol{u}=0$\n2. 斯托克斯动量平衡（无限普朗特数）：$\\boldsymbol{0}=-\\nabla p+\\nabla^{2}\\boldsymbol{u}+Ra\\,\\theta\\,\\hat{\\boldsymbol{z}}$\n3. 热输运：$\\dfrac{\\partial \\theta}{\\partial t}=\\nabla^{2}\\theta+w$\n\n此处，$Ra = \\frac{\\alpha g \\Delta T H^3}{\\nu \\kappa}$ 是瑞利数。\n\n我们进行简正模分析，寻找在水平方向上周期性、在时间上指数增长或衰减的解。根据 Squire 定理，不失一般性，我们可以考虑沿 $y$ 轴方向的二维对流滚筒，因此所有变量都与 $y$ 无关，且速度分量 $v=0$。扰动可以写为：\n$$w(x,z,t) = W(z) \\exp(i k x + \\sigma t)$$\n$$u(x,z,t) = U(z) \\exp(i k x + \\sigma t)$$\n$$\\theta(x,z,t) = \\Theta(z) \\exp(i k x + \\sigma t)$$\n$$p(x,z,t) = P(z) \\exp(i k x + \\sigma t)$$\n其中 $k>0$ 是水平波数，$\\sigma$ 是复增长率。将这些形式代入控制方程，将偏微分方程转化为关于振幅函数 $W(z)$、$U(z)$、$\\Theta(z)$ 和 $P(z)$ 的常微分方程（ODE）。令 $D \\equiv \\frac{d}{dz}$。\n\n不可压缩性方程 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} = 0$ 变为：\n$$ikU + DW = 0 \\quad \\implies \\quad U = \\frac{i}{k} DW$$\n\n动量方程变为：\nx-分量：$0 = -ikP + (D^2 - k^2)U$\nz-分量：$0 = -DP + (D^2 - k^2)W + Ra\\,\\Theta$\n\n热输运方程变为：\n$$\\sigma \\Theta = (D^2 - k^2)\\Theta + W$$\n\n下一步是消去 $U$ 和 $P$，以获得一个关于 $W$ 和 $\\Theta$ 的方程组。\n将 $U = \\frac{i}{k}DW$ 代入 x-动量方程：\n$$0 = -ikP + (D^2 - k^2)\\left(\\frac{i}{k}DW\\right) \\implies P = \\frac{1}{k^2}(D^2 - k^2)DW$$\n现在，通过对 $P$ 关于 $z$ 求导，将其表达式代入 z-动量方程：\n$$DP = \\frac{1}{k^2}(D^2 - k^2)D^2W$$\n于是 z-动量方程为：\n$$0 = -\\frac{1}{k^2}(D^2 - k^2)D^2W + (D^2 - k^2)W + Ra\\,\\Theta$$\n两边乘以 $k^2$ 并重新整理得到：\n$$k^2Ra\\,\\Theta = (D^2 - k^2)D^2W - k^2(D^2 - k^2)W = (D^2 - k^2)(D^2W - k^2W)$$\n这简化为一个耦合 $W$ 和 $\\Theta$ 的四阶常微分方程：\n$$(D^2 - k^2)^2 W = k^2 Ra\\,\\Theta \\quad (*)$$\n\n我们正在寻找定常对流的起始点，这对应于临界稳定情况，此时增长率为纯实数且等于零（$\\sigma=0$）。这可以通过稳定性交换原理来证明，该原理对此问题成立。在热输运方程中令 $\\sigma=0$，得到第二个常微分方程：\n$$(D^2 - k^2)\\Theta = -W \\quad (**)$$\n\n现在我们得到了一个关于 $W(z)$ 和 $\\Theta(z)$ 的耦合常微分方程组。顶部和底部边界（$z=0$ 和 $z=1$）的边界条件被设定为等温（$\\theta=0$）、不可穿透（$w=0$）和自由滑移。自由滑移条件（边界处 $\\frac{\\partial u}{\\partial z}=0$）与不可压缩性相结合，导出 $\\frac{\\partial^2 w}{\\partial z^2}=0$。因此，振幅函数的边界条件是：\n$$W(0) = W(1) = 0$$\n$$\\Theta(0) = \\Theta(1) = 0$$\n$$D^2W(0) = D^2W(1) = 0$$\n\n这些特定的边界条件都可以被正弦函数满足。我们尝试一个形如 $W(z) = A \\sin(n\\pi z)$ 的解，其中整数 $n \\ge 1$。\n- $W(0) = A \\sin(0) = 0$ 和 $W(1) = A \\sin(n\\pi) = 0$。\n- $D^2W = -A(n\\pi)^2 \\sin(n\\pi z)$，所以 $D^2W(0)=0$ 和 $D^2W(1)=0$。\n这种形式是该系统的一个有效特征函数。\n\n现在我们将 $W(z) = A \\sin(n\\pi z)$ 代入方程 $(*)$ 和 $(**)$ 来求解特征值 $Ra$。\n从 $(**)$，我们找到 $\\Theta(z)$：\n$$(D^2 - k^2)\\Theta = -A \\sin(n\\pi z)$$\n由于 $D^2[\\sin(n\\pi z)] = -(n\\pi)^2 \\sin(n\\pi z)$，我们可以假设 $\\Theta(z) = B \\sin(n\\pi z)$。代入可得：\n$$(-(n\\pi)^2 - k^2)B \\sin(n\\pi z) = -A \\sin(n\\pi z)$$\n$$B = \\frac{A}{(n\\pi)^2 + k^2}$$\n所以，$\\Theta(z) = \\frac{A}{(n\\pi)^2 + k^2}\\sin(n\\pi z)$。这种形式也满足边界条件 $\\Theta(0)=\\Theta(1)=0$。\n\n现在，将 $W(z)$ 和 $\\Theta(z)$ 都代入方程 $(*)$：\n$$(D^2 - k^2)^2 (A \\sin(n\\pi z)) = k^2 Ra \\left( \\frac{A}{(n\\pi)^2 + k^2}\\sin(n\\pi z) \\right)$$\n计算左边的算子：\n$$(D^2 - k^2)(A \\sin(n\\pi z)) = (-(n\\pi)^2 - k^2)A \\sin(n\\pi z)$$\n$$(D^2 - k^2)^2(A \\sin(n\\pi z)) = (-(n\\pi)^2 - k^2)^2 A \\sin(n\\pi z) = ((n\\pi)^2 + k^2)^2 A \\sin(n\\pi z)$$\n将此结果代回主方程：\n$$((n\\pi)^2 + k^2)^2 A \\sin(n\\pi z) = k^2 Ra \\frac{A}{(n\\pi)^2 + k^2} \\sin(n\\pi z)$$\n对于非平凡解（$A \\neq 0$），我们可以消去 $A\\sin(n\\pi z)$，从而得到 $Ra$ 作为 $k$ 和 $n$ 的函数的色散关系：\n$$Ra(k,n) = \\frac{((n\\pi)^2 + k^2)^3}{k^2}$$\n对流的起始对应于可能的最小瑞利数。我们必须针对模数 $n$ 和波数 $k$ 对 $Ra$ 进行最小化。对于任意固定的 $k>0$，函数 $Ra(k,n)$ 在选择最小可能整数 $n$ 时取最小值，即 $n=1$（基底模）。\n$$Ra(k) = \\frac{(\\pi^2 + k^2)^3}{k^2}$$\n为了找到使 $Ra(k)$ 最小化的临界波数 $k_c$，我们计算其关于 $k$ 的导数并令其为零。使用变量 $x=k^2$ 会更容易一些：\n$$Ra(x) = \\frac{(\\pi^2 + x)^3}{x}$$\n$$\\frac{dRa}{dx} = \\frac{3(\\pi^2+x)^2 \\cdot x - (\\pi^2+x)^3 \\cdot 1}{x^2} = 0$$\n为求最小值，分子必须为零。由于 $x=k^2>0$，$\\pi^2+x \\neq 0$，所以我们可以除以 $(\\pi^2+x)^2$：\n$$3x - (\\pi^2+x) = 0$$\n$$2x - \\pi^2 = 0 \\implies x = \\frac{\\pi^2}{2}$$\n因此，临界波数的平方是 $k_c^2 = \\frac{\\pi^2}{2}$，这给出了临界波数：\n$$k_c = \\sqrt{\\frac{\\pi^2}{2}} = \\frac{\\pi}{\\sqrt{2}}$$\n最后，我们将这个值代回 $Ra(k)$ 的表达式中，以找到临界瑞利数 $Ra_c$：\n$$Ra_c = \\frac{(\\pi^2 + k_c^2)^3}{k_c^2} = \\frac{(\\pi^2 + \\frac{\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{(\\frac{3\\pi^2}{2})^3}{\\frac{\\pi^2}{2}}$$\n$$Ra_c = \\frac{\\frac{27\\pi^6}{8}}{\\frac{\\pi^2}{2}} = \\frac{27\\pi^6}{8} \\cdot \\frac{2}{\\pi^2} = \\frac{27\\pi^4}{4}$$\n所以，对于自由滑移、等温边界，定常对流开始的临界值为 $k_c = \\frac{\\pi}{\\sqrt{2}}$ 和 $Ra_c = \\frac{27\\pi^4}{4}$。数值上，这些值约为 $k_c \\approx 2.221$ 和 $Ra_c \\approx 657.51$。\n\n与刚性、无滑移、等温情况的定性比较：\n\n对于刚性（无滑移）边界，垂直速度振幅的边界条件变为在 $z=0$ 和 $z=1$ 处 $W=0$ 和 $DW=0$。这些更严格的条件导致的临界值为 $Ra_c \\approx 1707.76$ 和 $k_c \\approx 3.117$。\n\n刚性边界的临界瑞利数（$Ra_c$）显著高于自由滑移边界（$1708$ 对 $657.5$）。瑞利数代表浮力驱动力与耗散力（粘性力和热力）之比。刚性、无滑移边界在流体层的顶部和底部引入了强大的粘性阻力，比自由滑移边界更有效地耗散动能，在自由滑移边界下，流体可以在没有剪切应力的情况下水平移动。这种增强的粘性耗散稳定了传导状态，意味着需要更强的浮力（即更高的 $Ra$）来克服阻力并引发对流运动。\n\n刚性边界的临界波数（$k_c$）大于自由滑移边界（$3.12$ 对 $2.22$）。波数与对流开始时的对流单体的水平波长成反比（$\\lambda_c = 2\\pi/k_c$）。更大的 $k_c$ 意味着更窄的对流单体。无滑移条件强烈约束了边界附近的垂直方向流体流动。流体必须减速并最终停止。为了适应这种强烈的垂直剪切，流动组织成更窄的单体。相比之下，对于自由滑移边界，顶部和底部缺乏粘性阻力，允许流体以较小的努力在更宽的水平距离上完成其翻转环流，从而导致更宽的对流单体和更小的临界波数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{27\\pi^4}{4} & \\frac{\\pi}{\\sqrt{2}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "当对流系统进入非线性、强时变状态时，解析分析变得异常困难，数值方法，特别是有限元方法（FEM），成为了不可或缺的研究工具。有限元法的核心在于将连续的偏微分方程转化为离散的代数方程组。本练习将带你完成这一转化的关键第一步：针对地幔对流中的斯托克斯流动问题，推导其弱形式（或称变分形式），并探讨为保证压力场数值解稳定而必须满足的LBB（Ladyzhenskaya–Babuška–Brezzi）条件。",
            "id": "3610779",
            "problem": "考虑一个在有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^2$（其边界为 $\\Gamma$）上，基于Boussinesq近似的二维地幔对流模型。该流体是不可压缩的牛顿流体，其粘度 $\\eta(T)$ 依赖于温度，且密度变化仅在浮力项中保留。控制方程为稳态Stokes动量平衡方程和不可压缩性方程：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho_0 \\alpha \\left( T - T_{\\mathrm{ref}} \\right) \\mathbf{g} = \\mathbf{0}, \\quad \\nabla \\cdot \\mathbf{u} = 0 \\quad \\text{in } \\Omega,\n$$\n其中 $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u})$ 是柯西应力（Cauchy stress），$p$ 是动压力，$\\mathbf{u}$ 是速度，$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2} \\left( \\nabla \\mathbf{u} + \\left( \\nabla \\mathbf{u} \\right)^{\\top} \\right)$ 是对称梯度，$\\rho_0$ 是一个常参考密度，$\\alpha$ 是热膨胀系数，$T$ 是温度场，$T_{\\mathrm{ref}}$ 是一个参考温度，$\\mathbf{g}$ 是重力加速度矢量。假设边界为自由滑移、不可渗透边界，即在 $\\Gamma$ 上有 $\\mathbf{u} \\cdot \\mathbf{n} = 0$ 和 $\\mathbf{t} \\cdot \\left( \\boldsymbol{\\sigma} \\mathbf{n} \\right) = 0$，其中 $\\mathbf{n}$ 和 $\\mathbf{t}$ 分别表示 $\\Gamma$ 上的单位法向和切向方向。\n\n从这些控制定律和边界条件出发，推导适用于Galerkin型有限元法（FEM）的弱（变分）形式。清晰地指明速度和压力的试探空间和检验空间，包括为保证压力唯一性所需的任何约束，并识别出所产生的双线性和线性形式。\n\n然后，关注离散混合格式，在标准假设下的性状正则网格上，选出所有满足Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup条件以保证压力稳定且无需任何额外稳定化项的有限元速度-压力空间对：\n\nA. Taylor–Hood $P_2$–$P_1$（三角形上连续二次速度，连续线性压力）\n\nB. 等阶连续 $P_1$–$P_1$（三角形上线性速度，线性压力）\n\nC. MINI元：速度场为在每个三角形上用一个内部泡函数丰富的$P_1$空间，压力场为$P_1$连续压力\n\nD. 四边形 $Q_2$–$Q_1$（四边形上双二次速度，双线性压力）\n\nE. 等阶连续 $P_2$–$P_2$（三角形上二次速度，二次压力）\n\nF. 在二维情况下，$k \\ge 3$ 时，重心细分的三角形网格上的Scott–Vogelius $P_k$–$P_{k-1}$（速度场为$k$次连续分片多项式，压力场为$k-1$次连续分片多项式）\n\nG. Crouzeix–Raviart非协调$P_1$速度与三角形上分片常数$P_0$压力的组合",
            "solution": "### 弱形式的推导\n\n目标是找到一个满足控制方程和边界条件的速度和压力解对 $(\\mathbf{u}, p)$。弱形式是通过将控制方程乘以合适的检验函数并在域 $\\Omega$ 上积分得到的。\n\n设速度的试探空间为 $V$，压力的试探空间为 $Q$。类似地，速度的检验空间为 $V$，压力的检验空间为 $Q$。速度的试探函数和检验函数 $\\mathbf{u}$ 和 $\\mathbf{v}$ 必须属于一个足够正则的空间，以使积分有明确定义，并且该空间要包含本质（Dirichlet型）边界条件。压力的试探函数和检验函数 $p$ 和 $q$ 必须属于一个适合该问题的空间。\n\n不可渗透边界条件 $\\mathbf{u} \\cdot \\mathbf{n} = 0$ 是一个本质条件，必须被构建到速度函数空间中。自由滑移条件 $\\mathbf{t} \\cdot (\\boldsymbol{\\sigma} \\mathbf{n}) = 0$ 是一个自然条件，将从弱形式中产生。\n\n合适的函数空间是Sobolev空间。速度空间 $V$ 定义为：\n$$\nV = \\{ \\mathbf{v} \\in [H^1(\\Omega)]^2 \\mid \\mathbf{v} \\cdot \\mathbf{n} = 0 \\text{ on } \\Gamma \\}\n$$\n压力空间 $Q$ 定义为：\n$$\nQ = L^2_0(\\Omega) = \\left\\{ q \\in L^2(\\Omega) \\mid \\int_{\\Omega} q \\, d\\Omega = 0 \\right\\}\n$$\n施加条件 $\\int_{\\Omega} q \\, d\\Omega = 0$ 是为了确保压力解的唯一性，否则压力解只能在相差一个任意加法常数的意义下确定。\n\n**1. 动量方程的弱形式**\n\n我们从动量平衡方程开始：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0} \\quad \\text{in } \\Omega\n$$\n其中 $\\mathbf{f} = \\rho_0 \\alpha (T - T_{\\mathrm{ref}}) \\mathbf{g}$ 代表浮力。我们将此方程乘以一个任意检验函数 $\\mathbf{v} \\in V$ 并在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\mathbf{v} \\, d\\Omega + \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = 0\n$$\n对第一项应用分部积分（向量的格林第一恒等式）得到：\n$$\n-\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{v} \\, d\\Omega + \\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma + \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = 0\n$$\n边界积分 $\\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma$ 必须被计算。边界上的任何向量都可以分解为其法向和切向分量。由于 $\\mathbf{v} \\in V$，它在 $\\Gamma$ 上满足 $\\mathbf{v} \\cdot \\mathbf{n} = 0$。这意味着在边界上 $\\mathbf{v}$ 是纯切向的。设 $\\mathbf{t}$ 为 $\\Gamma$ 上的单位切向量。则 $\\mathbf{v} = (\\mathbf{v} \\cdot \\mathbf{t}) \\mathbf{t}$。被积函数变为：\n$$\n(\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} = (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot ((\\mathbf{v} \\cdot \\mathbf{t}) \\mathbf{t}) = (\\mathbf{v} \\cdot \\mathbf{t}) (\\boldsymbol{\\sigma}\\mathbf{n} \\cdot \\mathbf{t})\n$$\n自由滑移边界条件恰好是切向牵引力为零：$\\mathbf{t} \\cdot (\\boldsymbol{\\sigma}\\mathbf{n}) = 0$。因此，整个边界积分消失：\n$$\n\\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma = 0\n$$\n动量方程的弱形式简化为：\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\n现在，我们代入柯西应力张量的定义，$\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u})$：\n$$\n\\int_{\\Omega} \\left( -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\right) : \\nabla \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\n涉及压力的项是 $-p\\mathbf{I} : \\nabla\\mathbf{v} = -p \\sum_{i} \\frac{\\partial v_i}{\\partial x_i} = -p (\\nabla \\cdot \\mathbf{v})$。\n粘性项是 $2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\nabla \\mathbf{v}$。由于 $\\boldsymbol{\\varepsilon}(\\mathbf{u})$ 是对称张量，其与 $\\nabla \\mathbf{v}$ 的反对称部分的内积为零。因此，$\\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\nabla \\mathbf{v} = \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v})$。\n这得到动量方程的最终弱形式：\n$$\n\\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\n\n**2. 不可压缩性方程的弱形式**\n\n不可压缩性约束是 $\\nabla \\cdot \\mathbf{u} = 0$。我们将其乘以一个压力检验函数 $q \\in Q$ 并在 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega = 0\n$$\n\n**3. 完整的变分问题**\n\n完整的问题是：求 $(\\mathbf{u}, p) \\in V \\times Q$，使得对于所有检验函数 $(\\mathbf{v}, q) \\in V \\times Q$：\n$$\n\\begin{cases}\n\\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega \\\\\n\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega = 0\n\\end{cases}\n$$\n我们可以识别出双线性和线性形式：\n*   粘性双线性形式： $a(\\mathbf{u}, \\mathbf{v}) = \\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega$\n*   压力-速度耦合双线性形式： $b(\\mathbf{v}, p) = - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega$\n*   载荷线性形式： $L(\\mathbf{v}) = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\rho_0 \\alpha (T - T_{\\mathrm{ref}}) \\mathbf{g} \\cdot \\mathbf{v} \\, d\\Omega$\n\n变分问题是：求 $(\\mathbf{u}, p) \\in V \\times Q$，使得：\n$$\n\\begin{cases}\na(\\mathbf{u}, \\mathbf{v}) + b(\\mathbf{v}, p) = L(\\mathbf{v}) \\quad \\forall \\mathbf{v} \\in V \\\\\nb(\\mathbf{u}, q) = 0 \\quad \\forall q \\in Q\n\\end{cases}\n$$\n注意，$b(\\cdot, \\cdot)$ 的标准定义意味着 $b(\\mathbf{u}, q) = -\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega$，所以 $b(\\mathbf{u}, q) = 0$ 等价于不可压缩性约束的弱形式。\n\n### 有限元对的评估\n\nStokes方程的离散混合格式的稳定性由Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup条件决定。如果存在一个与网格尺寸 $h$ 无关的常数 $\\beta > 0$，使得以下条件成立，则速度-压力对 $(V_h, Q_h)$ 是LBB稳定的：\n$$\n\\inf_{q_h \\in Q_h \\setminus \\{0\\}} \\sup_{\\mathbf{v}_h \\in V_h \\setminus \\{\\mathbf{0}\\}} \\frac{-\\int_{\\Omega} q_h (\\nabla \\cdot \\mathbf{v}_h) \\, d\\Omega}{\\|\\mathbf{v}_h\\|_{V} \\|q_h\\|_{Q}} \\ge \\beta\n$$\n满足此条件的对可以在没有额外稳定化项的情况下使用。我们现在评估给定的选项。\n\nA. **Taylor–Hood $P_2$–$P_1$（三角形上连续二次速度，连续线性压力）**：这是典型的LBB稳定单元对。速度空间比压力空间更丰富，满足LBB条件。\n**结论：正确**\n\nB. **等阶连续 $P_1$–$P_1$（三角形上线性速度，线性压力）**：这是一个LBB不稳定单元的经典例子。相对于速度空间，压力空间过大，导致虚假的压力振荡。该对需要稳定化技术才能工作。\n**结论：不正确**\n\nC. **MINI元：速度场为在每个三角形上用一个内部泡函数丰富的$P_1$空间，压力场为$P_1$连续压力**：这种单元，也称为$P_1b$-$P_1$元，通过一个在单元边界上为零的三次“泡”函数来丰富线性速度空间。这种丰富足以稳定线性压力。它满足LBB条件。\n**结论：正确**\n\nD. **四边形 $Q_2$–$Q_1$（四边形上双二次速度，双线性压力）**：这是Taylor–Hood单元的四边形类似物。它是四边形网格上一个著名的LBB稳定对。\n**结论：正确**\n\nE. **等阶连续 $P_2$–$P_2$（三角形上二次速度，二次压力）**：与 $P_1$–$P_1$ 单元类似，这种等阶连续对是LBB不稳定的，在没有稳定化的情况下会产生虚假的压力模式。\n**结论：不正确**\n\nF. **在二维情况下，$k \\ge 3$ 时，重心细分的三角形网格上的Scott–Vogelius $P_k$–$P_{k-1}$（速度场为$k$次连续分片多项式，压力场为$k-1$次连续分片多项式）**：Scott–Vogelius对通常指连续速度($P_k$)和*不连续*压力($P_{k-1}$)。虽然括号内的描述提到了连续压力，但对网格和多项式次数的特定条件强烈指向不连续压力的情况，其稳定性是一个非平凡的问题。对于一般网格，该对不是LBB稳定的。然而，在特定的网格条件下，如指定的重心细分，它已被证明在二维情况下对于 $k \\ge 3$ 是稳定的。\n**结论：正确**\n\nG. **Crouzeix–Raviart非协调$P_1$速度与三角形上分片常数$P_0$压力的组合**：这种单元使用仅在边中点处连续的线性多项式作为速度（这使其成为非协调的，因为它不属于$H^1(\\Omega)$），并与分片常数压力配对。该对满足一个适用于非协调方法的修正LBB条件，是Stokes问题的一个著名的稳定选择。\n**结论：正确**",
            "answer": "$$\\boxed{ACDFG}$$"
        },
        {
            "introduction": "通过有限元等方法将斯托克斯方程离散化后，我们会得到一个具有特定“鞍点”结构的线性方程组。在处理封闭域问题（如整个地幔）时，直接求解该系统会遇到一个常见而关键的陷阱：由于压力仅以其梯度的形式出现在动量方程中，其解并非唯一。本练习聚焦于这一实际挑战，探讨了两种常用的移除压力零空间（即保证压力解唯一性）的策略，并分析了它们对最终线性系统性质的影响，这对于开发稳健的对流模拟求解器至关重要。",
            "id": "3610784",
            "problem": "考虑布辛涅斯克近似下的地幔对流的不可压缩斯托克斯流，其中温度相关的浮力驱动运动，但除浮力项外，密度的变化被忽略。设域为一个闭合连通区域 $\\Omega \\subset \\mathbb{R}^d$，其边界不可渗透（无正交流动），并假设适当的速度边界条件以保证质量守恒。无量纲形式的控制方程为动量平衡和不可压缩性条件，\n$$\n- \\nabla \\cdot \\left( 2 \\eta(\\mathbf{x}) \\mathbf{D}(\\mathbf{u}) \\right) + \\nabla p = \\mathrm{Ra}\\, T(\\mathbf{x})\\, \\hat{\\mathbf{z}}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\n其中 $\\mathbf{u}(\\mathbf{x})$ 是速度， $p(\\mathbf{x})$ 是压力， $\\eta(\\mathbf{x})$ 是粘度，$\\mathbf{D}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top})$ 是应变率张量，$\\mathrm{Ra}$ 是瑞利数，$T(\\mathbf{x})$ 是温度，$\\hat{\\mathbf{z}}$ 是浮力方向的单位向量。一个稳定的混合有限元离散化（例如，Taylor–Hood）会导出一个线性代数鞍点系统\n$$\n\\begin{bmatrix}\n\\mathbf{A}  \\mathbf{B}^{\\top} \\\\\n\\mathbf{B}  \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u} \\\\\n\\mathbf{p}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{bmatrix},\n$$\n其中 $\\mathbf{A}$ 代表粘性双线性形式，$\\mathbf{B}$ 代表离散散度，$\\mathbf{u}$ 是速度基函数的系数向量，$\\mathbf{p}$ 是压力基函数的系数向量，$\\mathbf{f}$ 代表浮力强迫项和边界项。在一个闭合连通域中，该系统存在一个压力零空间，因为动量方程中只出现 $\\nabla p$。消除该零空间并使系统唯一可解的两种常用策略是：(i) 通过施加全局约束 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ 来固定平均压力，以及 (ii) 通过为选定的网格节点 $\\mathbf{x}_\\star$ 设置 $p(\\mathbf{x}_\\star) = 0$ 并从 $\\mathbf{p}$ 中消除相应的自由度来钉扎单个节点的压力。\n\n下列哪个陈述最好地描述了这些策略如何消除压力零空间，以及它们对所得线性系统的条件数和结构的影响？\n\nA. 因为动量方程依赖于 $\\nabla p$，给 $p$ 加上任意常数不会改变方程，所以离散压力向量有一个由常数向量张成的1维零空间。施加零均值约束 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ 可以消除这个零空间而不改变 $\\mathbf{u}$，保留了对称不定鞍点结构，并且通常比钉扎单个节点产生稍好的条件数，因为该约束是全局的，且与常数模态正交。\n\nB. 钉扎单个节点的压力会将鞍点矩阵转换为对称正定系统，并与固定平均压力相比改善了条件数，因为消除一个自由度总会增加最小奇异值。\n\nC. 在弱形式中添加一个带有较大 $\\alpha$ 的压力罚项 $\\alpha \\int_{\\Omega} p^2 \\,\\mathrm{d}\\Omega$ 等同于固定平均压力，并在保持原始物理特性的同时维持最优条件数。\n\nD. 固定平均压力 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ 会通过引入有效可压缩性来改变速度解 $\\mathbf{u}$，这种可压缩性会改变离散散度约束，因此它不适用于闭合域。\n\n选择正确的选项。",
            "solution": "问题的核心在于，在连续介质的动量方程中，压力 $p$ 仅以其梯度 $\\nabla p$ 的形式出现。这意味着如果 $p(\\mathbf{x})$ 是一个解，那么对于任何常数 $c$， $p(\\mathbf{x}) + c$ 也是一个解，因为 $\\nabla(p+c) = \\nabla p$。因此，压力解只能在一个任意加法常数的意义下确定（即压力解不唯一），尽管由压力梯度决定的速度场 $\\mathbf{u}$ 是唯一的。\n\n在离散的有限元框架下，这种不确定性表现为鞍点矩阵的一个零空间。矩阵 $\\mathbf{B}^{\\top}$ 是梯度算子的离散形式。对于一个常数压力场（在标准节点基下，其系数向量 $\\mathbf{p}_c$ 的所有分量相等），其离散梯度为零：$\\mathbf{B}^{\\top}\\mathbf{p}_c = \\mathbf{0}$。因此，整个鞍点矩阵 $\\mathbf{K} = \\begin{bmatrix} \\mathbf{A} & \\mathbf{B}^{\\top} \\\\ \\mathbf{B} & \\mathbf{0} \\end{bmatrix}$ 是奇异的，因为它存在一个零向量 $\\begin{bmatrix} \\mathbf{0} \\\\ \\mathbf{p}_c \\end{bmatrix}$。这使得线性系统对于压力向量 $\\mathbf{p}$ 不是唯一可解的。为了获得唯一解，我们必须对 $\\mathbf{p}$ 施加一个额外的约束来移除这个常数模态。\n\n现在我们分析各个选项：\n\n*   **A**: 这个陈述完全正确。它准确地指出了压力零空间是一维的，由常数向量构成。施加零均值约束 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ 是消除这个零空间的标准方法，它等效于要求压力解与常数函数正交。这个过程只用于从无限多的有效压力解中选出一个特定的解，并不会改变唯一的物理速度场 $\\mathbf{u}$。该方法保留了系统的对称不定结构。与钉扎单个节点的局部约束相比，这种全局积分约束在数学上更为“温和”，并且通常会产生一个条件数更好的线性系统。\n\n*   **B**: 这个陈述是错误的。钉扎单个节点的压力确实可以消除零空间，但它并不能将系统变为对称正定（SPD）的。由于右下角的零块矩阵依然存在，系统仍然是（对称）不定的。此外，该选项声称这种方法能改善条件数，这通常是错误的。钉扎法是一种“强力”的局部约束，通常会导致比全局约束更差的条件数。\n\n*   **C**: 这个陈述是错误的。添加压力罚项 $\\alpha \\int_{\\Omega} p^2 \\,\\mathrm{d}\\Omega$ 并不等同于固定平均压力。它从根本上改变了物理模型，将不可压缩性约束 $\\nabla \\cdot \\mathbf{u} = 0$ 修改为一种人工的可压缩性关系（例如，$\\nabla \\cdot \\mathbf{u} + \\alpha p = 0$）。此外，罚方法以随着罚参数 $\\alpha$ 的增大而恶化系统条件数而闻名。\n\n*   **D**: 这个陈述是错误的。固定平均压力不会改变速度解 $\\mathbf{u}$，因为它只是从压力解族中选择一个代表。它也不会引入有效可压缩性或改变散度约束。事实上，这种方法是处理封闭域问题最标准和理论上最稳健的方法之一。\n\n综上所述，选项 A 是唯一正确、完整的描述。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}