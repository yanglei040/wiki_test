{
    "hands_on_practices": [
        {
            "introduction": "为了研究和比较不同的对流系统，我们使用无量纲数来描述它们。本练习将引导你推导地幔对流中两个最重要的无量纲数：与底部加热相关的瑞利数$Ra$和与内部生热相关的瑞利数$Ra_H$。通过这个练习，你将为量化地幔对流的驱动力奠定坚实的基础。",
            "id": "3609282",
            "problem": "考虑一个内半径为 $r_{i}$、外半径为 $r_{o}$ 的三维球壳中不可压缩地幔的布辛涅斯克热对流。粘度具有强烈的温度依赖性，但为了进行无量纲化，我们使用在特定参考状态下定义的参考动力粘度 $\\eta_{0}$。假设除粘度外，材料属性（密度 $\\rho$、热膨胀系数 $\\alpha$、热导率 $k$、热扩散率 $\\kappa$ 和重力加速度 $g$）在径向上是均匀且恒定的。为定义控制参数，假设重力 $g$ 和材料属性为常数。壳层厚度为 $D=r_{o}-r_{i}$。存在两种热浮力来源：底部和顶部边界之间的底部温差 $\\Delta T_{b}$，以及由单位质量生热率 $H$（单位为 $\\mathrm{W\\,kg^{-1}}$）表征的均匀内部放射性生热，因此体生热率为 $\\dot{q}=\\rho H$（单位为 $\\mathrm{W\\,m^{-3}}$）。\n\n从有量纲的布辛涅斯克-斯托克斯方程和能量方程出发，使用热扩散时间尺度 $D^{2}/\\kappa$、长度尺度 $D$、速度尺度 $\\kappa/D$ 以及与每种驱动力相应的温度尺度，从第一性原理推导无量纲动量方程中乘以浮力项的无量纲控制参数：\n- 与给定的底部温差 $\\Delta T_{b}$ 相关的经典瑞利数 $Ra$，以及\n- 与均匀体生热 $\\dot{q}$ 相关的内加热瑞利数 $Ra_{H}$。\n\n然后，使用以下类地参数值\n- $r_{o}=6.371\\times 10^{6}\\ \\mathrm{m}$，$r_{i}=3.480\\times 10^{6}\\ \\mathrm{m}$，\n- $\\rho=3300\\ \\mathrm{kg\\,m^{-3}}$，$\\alpha=3.0\\times 10^{-5}\\ \\mathrm{K^{-1}}$，$g=9.81\\ \\mathrm{m\\,s^{-2}}$，\n- $\\kappa=1.0\\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}}$，$k=4.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$，\n- $\\eta_{0}=1.0\\times 10^{21}\\ \\mathrm{Pa\\,s}$，\n- $\\Delta T_{b}=2500\\ \\mathrm{K}$，以及 $H=5.0\\times 10^{-12}\\ \\mathrm{W\\,kg^{-1}}$，\n\n计算这两个瑞利数。将两个答案均表示为无量纲量，并四舍五入到四位有效数字。你的最终答案应按 $(Ra,\\ Ra_{H})$ 的顺序，使用为多个数值答案指定的格式，以单行形式报告。",
            "solution": "首先对问题进行验证，确认其在科学上合理、适定且完整。因此，我们可以进行推导和计算。\n\n无量纲瑞利数的推导始于不可压缩流体布辛涅斯克热对流的控制方程。相关的有量纲方程是斯托克斯方程（针对缓慢粘性流动的动量守恒）、连续性方程（质量守恒）和热能方程（能量守恒）。\n\n在布辛涅斯克近似下，包含浮力项的斯托克斯方程为：\n$$ \\nabla \\cdot \\boldsymbol{\\tau} - \\nabla P' + \\mathbf{f}_b = \\mathbf{0} $$\n其中 $\\boldsymbol{\\tau}$ 是偏应力张量，对于参考粘度为 $\\eta_0$ 的牛顿流体，其表达式为 $\\boldsymbol{\\tau} = \\eta_0(\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T)$。$P'$ 是动压力，$\\mathbf{f}_b$ 是浮力。浮力由 $\\mathbf{f}_b = \\Delta \\rho \\mathbf{g} = -\\rho \\alpha (T-T_{\\mathrm{ref}}) \\mathbf{g}$ 给出，其中 $\\rho$ 是参考密度，$\\alpha$ 是热膨胀系数，$T$ 是温度，$T_{\\mathrm{ref}}$ 是参考温度，$\\mathbf{g}$ 是重力加速度矢量。假设重力径向朝内作用（$\\mathbf{g} = -g\\hat{\\mathbf{r}}$），则浮力项变为 $\\rho \\alpha (T-T_{\\mathrm{ref}}) g \\hat{\\mathbf{r}}$。\n\n不可压缩流体的连续性方程为：\n$$ \\nabla \\cdot \\mathbf{u} = 0 $$\n其中 $\\mathbf{u}$ 是速度矢量。\n\n包含内热源的热能方程为：\n$$ \\rho c_p \\left( \\frac{\\partial T}{\\partial t} + (\\mathbf{u} \\cdot \\nabla) T \\right) = k \\nabla^2 T + \\dot{q} $$\n其中 $c_p$ 是定压比热容，$k$ 是热导率，$\\dot{q} = \\rho H$ 是体生热率。\n\n接下来，我们根据指定的尺度引入无量纲变量（用撇号表示）：\n- 位置：$\\mathbf{r}' = \\mathbf{r} / D$\n- 时间：$t' = t / (D^2/\\kappa)$\n- 速度：$\\mathbf{u}' = \\mathbf{u} / (\\kappa/D)$\n- 温度：$T = T_{\\mathrm{ref}} + \\Delta T_{scale} \\theta$，其中 $\\Delta T_{scale}$ 是特征温度尺度，$\\theta$ 是无量纲温度。\n- 压力：动压力的自然尺度是粘性应力尺度，所以我们定义 $P' = (\\eta_0 \\kappa / D^2) p'$。\n\n微分算子变换为 $\\nabla = (1/D)\\nabla'$ 和 $\\nabla^2 = (1/D^2)\\nabla'^2$。\n\n我们将这些代入斯托克斯方程：\n$$ \\nabla \\cdot \\left( \\eta_0 \\frac{\\kappa}{D^2}(\\nabla'\\mathbf{u}' + (\\nabla'\\mathbf{u}')^T) \\right) - \\nabla \\left( \\frac{\\eta_0 \\kappa}{D^2} p' \\right) + \\rho \\alpha (\\Delta T_{scale} \\theta) g \\hat{\\mathbf{r}} = \\mathbf{0} $$\n$$ \\frac{\\eta_0 \\kappa}{D^3} \\nabla' \\cdot (\\nabla'\\mathbf{u}' + (\\nabla'\\mathbf{u}')^T) - \\frac{\\eta_0 \\kappa}{D^3} \\nabla' p' + \\rho \\alpha g \\Delta T_{scale} \\theta \\hat{\\mathbf{r}} = \\mathbf{0} $$\n将整个方程乘以 $D^3 / (\\eta_0 \\kappa)$，得到无量纲动量方程：\n$$ \\nabla' \\cdot (\\nabla'\\mathbf{u}' + (\\nabla'\\mathbf{u}')^T) - \\nabla' p' + \\left( \\frac{\\rho \\alpha g D^3 \\Delta T_{scale}}{\\eta_0 \\kappa} \\right) \\theta \\hat{\\mathbf{r}} = \\mathbf{0} $$\n乘以浮力项的无量纲群是针对所选温度尺度 $\\Delta T_{scale}$ 的广义瑞利数。\n\n现在我们对能量方程进行无量纲化。从方程\n$$ \\rho c_p \\left( \\frac{\\partial T}{\\partial t} + (\\mathbf{u} \\cdot \\nabla) T \\right) = k \\nabla^2 T + \\rho H $$\n开始，代入无量纲变量：\n$$ \\rho c_p \\left( \\frac{\\Delta T_{scale}}{D^2/\\kappa} \\frac{\\partial \\theta}{\\partial t'} + \\frac{\\kappa}{D}\\mathbf{u}' \\cdot \\frac{\\Delta T_{scale}}{D}\\nabla'\\theta \\right) = k \\frac{\\Delta T_{scale}}{D^2}\\nabla'^2\\theta + \\rho H $$\n$$ \\rho c_p \\frac{\\kappa \\Delta T_{scale}}{D^2} \\left( \\frac{\\partial \\theta}{\\partial t'} + \\mathbf{u}' \\cdot \\nabla'\\theta \\right) = k \\frac{\\Delta T_{scale}}{D^2}\\nabla'^2\\theta + \\rho H $$\n将整个方程除以 $k \\Delta T_{scale} / D^2$。利用关系式 $\\kappa = k / (\\rho c_p)$，左侧的系数 $\\rho c_p \\kappa / k$ 变为 1。得到最终的无量纲能量方程：\n$$ \\frac{\\partial \\theta}{\\partial t'} + (\\mathbf{u}' \\cdot \\nabla')\\theta = \\nabla'^2\\theta + \\frac{\\rho H D^2}{k \\Delta T_{scale}} $$\n\n问题要求通过分别考虑每种加热模式来推导两个瑞利数。\n\n情况1：底部加热 ($Ra$)\n对于由给定的底部温差 $\\Delta T_b$ 驱动的对流，我们设置内部生热 $H=0$。温度尺度的自然选择是所施加的温差本身：$\\Delta T_{scale} = \\Delta T_b$。将此代入浮力项的无量纲系数，得到经典瑞利数 $Ra$：\n$$ Ra = \\frac{\\rho \\alpha g \\Delta T_b D^3}{\\eta_0 \\kappa} $$\n\n情况2：内部加热 ($Ra_H$)\n对于仅由均匀内部生热 $H$ 驱动的对流，没有外部施加的温差（$\\Delta T_b=0$）。温度尺度必须是系统内在的。从无量纲能量方程来看，$\\frac{\\rho H D^2}{k \\Delta T_{scale}}$ 项代表了内部生热的无量纲强度。为了进行适当的标度，主要的驱动项应为1的量级。因此，我们将此无量纲加热项设为1，定义了内部加热的内在温度尺度 $\\Delta T_H$：\n$$ \\Delta T_H = \\frac{\\rho H D^2}{k} $$\n将此尺度 $\\Delta T_{scale} = \\Delta T_H$ 代入广义瑞利数表达式，得到内加热瑞利数 $Ra_H$：\n$$ Ra_H = \\frac{\\rho \\alpha g D^3}{\\eta_0 \\kappa} \\left( \\frac{\\rho H D^2}{k} \\right) = \\frac{\\rho^2 \\alpha g H D^5}{\\eta_0 \\kappa k} $$\n\n现在，我们使用提供的类地参数来计算这两个瑞利数：\n- $r_{o} = 6.371 \\times 10^{6}\\ \\mathrm{m}$\n- $r_{i} = 3.480 \\times 10^{6}\\ \\mathrm{m}$\n- $\\rho = 3300\\ \\mathrm{kg\\,m^{-3}}$\n- $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n- $g = 9.81\\ \\mathrm{m\\,s^{-2}}$\n- $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}}$\n- $k = 4.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- $\\eta_{0} = 1.0 \\times 10^{21}\\ \\mathrm{Pa\\,s}$\n- $\\Delta T_{b} = 2500\\ \\mathrm{K}$\n- $H = 5.0 \\times 10^{-12}\\ \\mathrm{W\\,kg^{-1}}$\n\n首先，计算壳层厚度 $D$：\n$$ D = r_o - r_i = (6.371 - 3.480) \\times 10^{6}\\ \\mathrm{m} = 2.891 \\times 10^{6}\\ \\mathrm{m} $$\n\n计算 $Ra$：\n$$ Ra = \\frac{\\rho \\alpha g \\Delta T_b D^3}{\\eta_0 \\kappa} $$\n$$ Ra = \\frac{(3300) \\cdot (3.0 \\times 10^{-5}) \\cdot (9.81) \\cdot (2500) \\cdot (2.891 \\times 10^{6})^{3}}{(1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-6})} $$\n$$ Ra = \\frac{(2427.975) \\cdot (2.41654 \\times 10^{19})}{1.0 \\times 10^{15}} = \\frac{5.86718 \\times 10^{22}}{1.0 \\times 10^{15}} = 5.86718 \\times 10^{7} $$\n四舍五入到四位有效数字，$Ra = 5.867 \\times 10^{7}$。\n\n计算 $Ra_H$：\n$$ Ra_H = \\frac{\\rho^2 \\alpha g H D^5}{\\eta_0 \\kappa k} $$\n$$ Ra_H = \\frac{(3300)^2 \\cdot (3.0 \\times 10^{-5}) \\cdot (9.81) \\cdot (5.0 \\times 10^{-12}) \\cdot (2.891 \\times 10^{6})^{5}}{(1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-6}) \\cdot (4.0)} $$\n$$ Ra_H = \\frac{(1.089 \\times 10^{7}) \\cdot (3.0 \\times 10^{-5}) \\cdot (9.81) \\cdot (5.0 \\times 10^{-12}) \\cdot (2.01894 \\times 10^{32})}{4.0 \\times 10^{15}} $$\n$$ Ra_H = \\frac{(1.6033 \\times 10^{-8}) \\cdot (2.01894 \\times 10^{32})}{4.0 \\times 10^{15}} = \\frac{3.23588 \\times 10^{24}}{4.0 \\times 10^{15}} = 8.0897 \\times 10^{8} $$\n四舍五入到四位有效数字，$Ra_H = 8.090 \\times 10^{8}$。\n\n计算出的瑞利数为 $(Ra, Ra_H) = (5.867 \\times 10^7, 8.090 \\times 10^8)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 5.867 \\times 10^{7}  8.090 \\times 10^{8} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在理解了对流驱动力的基础上，本练习将运用量级分析这一地球物理学中的有力工具，来估算地幔流动产生的应力。通过将这些驱动应力与岩石圈的强度进行比较，我们可以对行星的构造样式（例如，是类似地球的活动板块，还是类似火星的停滞盖层）做出初步预测。",
            "id": "3609252",
            "problem": "考虑一个三维球壳中的全地幔对流，其内半径固定，外半径对应行星表面。假设流体为不可压缩、无限普朗特数、黏度依赖于温度的布辛涅斯克流体。设参考密度为 $\\rho_{0}$，热膨胀系数为 $\\alpha$，重力加速度为 $g$，穿过对流壳层的总超绝热温降为 $\\Delta T$。壳层厚度为 $d$。黏度随温度变化很大，但你可以认为主导阶的对流驱动应力由深度积分的浮力决定。假设岩石圈通过摩擦-塑性（Byerlee型）准则发生屈服，其屈服应力依赖于深度 $\\sigma_{y}(z)=C_{0}+f\\,\\rho_{\\ell}\\,g\\,z$，其中 $C_{0}$ 是内聚力，$f$ 是有效摩擦系数，$\\rho_{\\ell}$ 是岩石圈密度，$z$ 是深度。\n\n从不可压缩流体的布辛涅斯克近似下的稳态斯托克斯动量平衡方程出发，并使用基于深度积分浮力的量级标度分析，推导出特征对流应力量级 $\\sigma_{c}$ 的估计值，然后构建在特征脆塑性深度 $z=z_{b}$ 处评估的无量纲流动性度量 $\\Lambda=\\sigma_{c}/\\sigma_{y}$。你可以假设进入浮力积分的主导几何长度尺度为 $d$，并且球面曲率不改变径向应力的主导阶标度。\n\n使用以下类地行星参数值：$\\rho_{0}=3300\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\alpha=2.5\\times 10^{-5}\\,\\mathrm{K}^{-1}$，$\\Delta T=2500\\,\\mathrm{K}$，$g=9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，$d=2.8\\times 10^{6}\\,\\mathrm{m}$，$C_{0}=2.0\\times 10^{7}\\,\\mathrm{Pa}$，$f=0.60$，$\\rho_{\\ell}=3300\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，以及 $z_{b}=5.0\\times 10^{4}\\,\\mathrm{m}$。计算 $\\Lambda$ 的数值（作为一个纯数），并将你的最终答案四舍五入到三位有效数字。最终答案中不要包含单位。",
            "solution": "经评估，此问题是有效的。它在科学上基于连续介质力学和地球物理学的原理，特别是地幔对流和岩石圈流变学。该问题是适定的，为标度分析提供了所有必要的参数和明确的目标。语言客观，给定的数据对于类地行星是物理上一致和现实的。\n\n任务是推导特征对流应力量级 $\\sigma_{c}$ 的估计值，并用它来计算无量纲流动性度量 $\\Lambda$。$\\Lambda$ 定义为 $\\sigma_{c}$ 与岩石圈在特征深度 $z_{b}$ 处的屈服应力 $\\sigma_{y}$ 之比。\n\n我们从不可压缩、无限普朗特数、布辛涅斯克流体的动量平衡方程开始，即稳态斯托克斯方程：\n$$ -\\nabla p + \\nabla \\cdot \\boldsymbol{\\tau} + \\mathbf{F}_{b} = \\mathbf{0} $$\n这里，$p$ 是动力压力，$\\boldsymbol{\\tau}$ 是偏应力张量，$\\mathbf{F}_{b}$ 是单位体积的浮力。浮力由温度引起的密度变化产生，其表达式为：\n$$ \\mathbf{F}_{b} = \\delta \\rho \\, \\mathbf{g} $$\n在布辛涅斯克近似中，密度异常 $\\delta \\rho$ 通过热膨胀系数 $\\alpha$ 与温度异常 $\\delta T$ 相关联：$\\delta \\rho = -\\rho_{0} \\alpha \\, \\delta T$，其中 $\\rho_{0}$ 是参考密度。假设重力沿径向向内作用，$\\mathbf{g} = -g \\hat{\\mathbf{r}}$，则浮力矢量为 $\\mathbf{F}_{b} = (\\rho_{0} \\alpha \\, \\delta T g) \\hat{\\mathbf{r}}$。单位体积的浮力大小为 $|\\mathbf{F}_{b}| = \\rho_{0} \\alpha g |\\delta T|$。\n\n问题指出，主导阶的对流驱动应力 $\\sigma_{c}$ 由深度积分的浮力决定。该量表示作用在单位面积垂直流体柱上的总浮力，因此具有应力的单位。我们可以通过将特征单位体积浮力在对流壳层厚度 $d$ 上积分来估计其量级。穿过壳层的特征温度异常 $|\\delta T|$ 是超绝热温降 $\\Delta T$。\n$$ \\sigma_{c} \\sim \\int_{0}^{d} (\\rho_{0} \\alpha g \\Delta T) \\, dz $$\n由于在此标度论证中被积函数是常数，积分结果为：\n$$ \\sigma_{c} = \\rho_{0} \\alpha g \\Delta T d $$\n该表达式表示地幔对流的特征驱动应力。\n\n接下来，我们评估岩石圈的屈服应力 $\\sigma_{y}$。问题提供了一个依赖于深度的摩擦-塑性（Byerlee型）准则：\n$$ \\sigma_{y}(z) = C_{0} + f\\,\\rho_{\\ell}\\,g\\,z $$\n其中 $C_{0}$ 是内聚力，$f$ 是有效摩擦系数，$\\rho_{\\ell}$ 是岩石圈密度，$z$ 是深度。我们需要在特征脆塑性深度 $z = z_{b}$ 处评估该屈服应力。\n$$ \\sigma_{y}(z_{b}) = C_{0} + f\\,\\rho_{\\ell}\\,g\\,z_{b} $$\n\n无量纲流动性度量 $\\Lambda$ 是对流驱动应力与岩石圈抵抗强度之比：\n$$ \\Lambda = \\frac{\\sigma_{c}}{\\sigma_{y}(z_{b})} = \\frac{\\rho_{0} \\alpha g \\Delta T d}{C_{0} + f\\,\\rho_{\\ell}\\,g\\,z_{b}} $$\n\n现在我们代入给定的类地行星参数值：\n- $\\rho_{0} = 3300\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $\\alpha = 2.5 \\times 10^{-5}\\,\\mathrm{K}^{-1}$\n- $g = 9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $\\Delta T = 2500\\,\\mathrm{K}$\n- $d = 2.8 \\times 10^{6}\\,\\mathrm{m}$\n- $C_{0} = 2.0 \\times 10^{7}\\,\\mathrm{Pa}$\n- $f = 0.60$\n- $\\rho_{\\ell} = 3300\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $z_{b} = 5.0 \\times 10^{4}\\,\\mathrm{m}$\n\n首先，我们计算分子 $\\sigma_{c}$：\n$$ \\sigma_{c} = (3300) \\times (2.5 \\times 10^{-5}) \\times (9.8) \\times (2500) \\times (2.8 \\times 10^{6}) \\, \\mathrm{Pa} $$\n$$ \\sigma_{c} = 5.6595 \\times 10^{9} \\, \\mathrm{Pa} $$\n\n接下来，我们计算分母 $\\sigma_{y}(z_{b})$：\n$$ \\sigma_{y}(z_{b}) = (2.0 \\times 10^{7}) + (0.60) \\times (3300) \\times (9.8) \\times (5.0 \\times 10^{4}) \\, \\mathrm{Pa} $$\n第二项（摩擦阻力）为：\n$$ f\\,\\rho_{\\ell}\\,g\\,z_{b} = 9.702 \\times 10^{8} \\, \\mathrm{Pa} $$\n所以，总屈服应力为：\n$$ \\sigma_{y}(z_{b}) = (2.0 \\times 10^{7}) + (97.02 \\times 10^{7}) \\, \\mathrm{Pa} = (0.2 \\times 10^{8}) + (9.702 \\times 10^{8}) \\, \\mathrm{Pa} = 9.902 \\times 10^{8} \\, \\mathrm{Pa} $$\n\n最后，我们计算比值 $\\Lambda$：\n$$ \\Lambda = \\frac{5.6595 \\times 10^{9}}{9.902 \\times 10^{8}} = \\frac{56.595 \\times 10^{8}}{9.902 \\times 10^{8}} \\approx 5.7155019... $$\n\n问题要求答案四舍五入到三位有效数字。\n$$ \\Lambda \\approx 5.72 $$\n该值是一个无量纲度量，比较了驱动板块构造的力与岩石圈脆性部分抵抗该运动的力。",
            "answer": "$$\\boxed{5.72}$$"
        },
        {
            "introduction": "模拟地幔对流在计算上极具挑战性，特别是当地幔岩石的粘滞系数变化数个量级时。本练习将深入探讨这一数值挑战的核心：如何高效求解斯托克斯方程。你将使用一个性能模型来估算和比较不同的数值技术（代数多重网格预条件子中的光滑子）如何应对剧烈的粘滞系数跳变，从而深入了解现代地球动力学代码的设计原理。",
            "id": "3609251",
            "problem": "考虑在具有可变黏度的三维球壳中的地幔对流不可压缩 Stokes 流。控制动量平衡方程为 $-\\nabla \\cdot \\left(2 \\eta(\\mathbf{x}) \\mathbf{D}(\\mathbf{u})\\right) + \\nabla p = \\mathbf{f}$，以及不可压缩性约束 $\\nabla \\cdot \\mathbf{u} = 0$，其中 $\\eta(\\mathbf{x})$ 是空间变化的黏度，$\\mathbf{u}$ 是速度，$p$ 是压力，$\\mathbf{D}(\\mathbf{u}) = \\frac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\right)$ 是应变率张量，$\\mathbf{f}$ 是体力。在三维球壳的非结构化网格上进行离散化后，与对称正定算子 $-\\nabla \\cdot \\left(2 \\eta(\\mathbf{x}) \\mathbf{D}(\\cdot)\\right)$ 相关联的速度块通过采用代数多重网格 (AMG) 预处理的 Krylov 方法求解。预处理后的算子表示为 $P^{-1}A$，其中 $A$ 是离散速度块，$P$ 是 AMG 预处理器。对于对称正定的预处理算子，预处理共轭梯度 (PCG) 方法的收敛性由 $P^{-1}A$ 的有效条件数 $\\kappa_{\\text{eff}}$ 控制。\n\n你必须在非结构化网格上，针对两种平滑器策略（黏度加权平滑器和标准平滑器），估计并比较求解速度块的 AMG 预处理 Krylov 方法的迭代次数。该比较必须量化由黏度衬度 $\\Delta \\eta$ 度量的系数跳跃如何影响估计的迭代次数。\n\n从以下基本基础开始：由变系数椭圆问题产生的离散对称正定算子，根据谱边界定义的条件数 $\\kappa$，以及在预处理共轭梯度中每次迭代的最坏情况误差减少，由误差能量范数的界 $r(\\kappa) = \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}$ 给出。使用这些来构建一个迭代次数的预测模型，该模型能捕捉与三维球壳和非结构化网格中的可变黏度相关的主要依赖关系。\n\n实现以下有效条件数的估计器：\n1. 将基准 AMG 鲁棒性常数定义为 $\\kappa^\\star = 8$。\n2. 通过一个标量 $q \\in [0,1]$ 来建模网格质量，其中 $q = 1$ 代表一个优秀的、近乎各向同性的非结构化网格，而 $q = 0$ 代表一个非常差的、高度各向异性的非结构化网格。设网格因子为 $F_{\\text{mesh}}(q) = 1 + \\gamma (1 - q)$，其中 $\\gamma = 15$。\n3. 将 AMG 层级因子（考虑非结构化网格上非理想的粗化和插值）建模为 $F_{\\text{levels}}(L) = 1 + 0.1 (L - 1)$，其中 $L$ 是 AMG 的层级数。\n4. 将球壳几何因子建模为 $F_{\\text{shell}}(r_{\\text{in}}, r_{\\text{out}}) = 1 + \\delta \\frac{R_m}{H}$，其中 $R_m = \\frac{r_{\\text{in}} + r_{\\text{out}}}{2}$，$H = r_{\\text{out}} - r_{\\text{in}}$，且 $\\delta = 0.05$。半径 $r_{\\text{in}}$ 和 $r_{\\text{out}}$ 必须以米为单位提供。\n5. 针对两种平滑器策略，对由黏度衬度 $\\Delta \\eta$ 引起的系数跳跃因子进行不同建模：\n   - 对于标准平滑器，使用 $F_{\\text{jump,std}}(\\Delta \\eta) = (\\Delta \\eta)^{\\beta}$，其中 $\\beta = \\frac{1}{3}$。\n   - 对于黏度加权平滑器，使用 $F_{\\text{jump,w}}(\\Delta \\eta) = 1 + c \\log_{10}(\\Delta \\eta)$，其中 $c = 0.5$。\n\n将这些组合起来得到有效条件数\n$$\n\\kappa_{\\text{eff,std}} = \\kappa^\\star \\, F_{\\text{mesh}}(q) \\, F_{\\text{levels}}(L) \\, F_{\\text{shell}}(r_{\\text{in}}, r_{\\text{out}}) \\, F_{\\text{jump,std}}(\\Delta \\eta),\n$$\n$$\n\\kappa_{\\text{eff,w}} = \\kappa^\\star \\, F_{\\text{mesh}}(q) \\, F_{\\text{levels}}(L) \\, F_{\\text{shell}}(r_{\\text{in}}, r_{\\text{out}}) \\, F_{\\text{jump,w}}(\\Delta \\eta).\n$$\n\n对于给定的误差范数减小的容差 $\\epsilon$（从单位初始误差开始），通过界\n$$\nn = \\left\\lceil \\frac{\\ln(\\epsilon)}{\\ln\\left(r(\\kappa_{\\text{eff}})\\right)} \\right\\rceil,\n\\quad\n\\text{with}\n\\quad\nr(\\kappa_{\\text{eff}}) = \\frac{\\sqrt{\\kappa_{\\text{eff}}} - 1}{\\sqrt{\\kappa_{\\text{eff}}} + 1}.\n$$\n估计所需的 PCG 迭代次数 $n$。\n\n在你的方法中解释系数跳跃如何影响平滑器的功效，以及为什么黏度加权平滑器能减轻在非结构化网格上使用标准平滑器时出现的性能退化。\n\n实现一个程序，该程序对每个测试用例，使用上述估计器计算一对整数 $\\left[n_{\\text{std}}, n_{\\text{w}}\\right]$，分别代表标准平滑器和黏度加权平滑器的迭代次数。输出中不需要物理单位，因为迭代次数是无量纲的。本问题中不使用角度。\n\n使用以下测试套件，它涵盖了一般情况、良好的网格质量、严重系数跳跃伴随差网格的情况，以及显著的几何薄壳效应。所有半径均以米为单位指定：\n- 测试用例 1：$\\Delta \\eta = 10^{6}$，$q = 0.5$，$L = 5$，$r_{\\text{in}} = 3.48 \\times 10^{6}$，$r_{\\text{out}} = 6.371 \\times 10^{6}$，$\\epsilon = 10^{-6}$。\n- 测试用例 2：$\\Delta \\eta = 10^{3}$，$q = 0.95$，$L = 5$，$r_{\\text{in}} = 3.48 \\times 10^{6}$，$r_{\\text{out}} = 6.371 \\times 10^{6}$，$\\epsilon = 10^{-8}$。\n- 测试用例 3：$\\Delta \\eta = 10^{8}$，$q = 0.1$，$L = 6$，$r_{\\text{in}} = 3.48 \\times 10^{6}$，$r_{\\text{out}} = 6.371 \\times 10^{6}$，$\\epsilon = 10^{-4}$。\n- 测试用例 4：$\\Delta \\eta = 10^{6}$，$q = 0.7$，$L = 4$，$r_{\\text{in}} = 6.0 \\times 10^{6}$，$r_{\\text{out}} = 6.2 \\times 10^{6}$，$\\epsilon = 10^{-6}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个条目本身是对应于每个测试用例的（按上述顺序排列的）双元素列表，例如 $\\left[\\left[n_{\\text{std},1},n_{\\text{w},1}\\right],\\left[n_{\\text{std},2},n_{\\text{w},2}\\right],\\ldots\\right]$。",
            "solution": "这个问题是有效的，因为它在计算流体动力学和数值线性代数方面有科学依据，定义和参数完备，问题适定，并以客观、正式的语言表述。提供了获得唯一、可验证解所需的所有组成部分。\n\n该问题要求估计求解模拟地幔对流的 Stokes 流问题的速度块所需的预处理共轭梯度 (PCG) 迭代次数。该系统源于在三维球壳上使用非结构化网格对一个变系数椭圆偏微分方程进行离散化。分析的核心是比较代数多重网格 (AMG) 预处理器中两种不同平滑器策略的性能：标准平滑器和黏度加权平滑器。\n\n不可压缩 Stokes 流的控制动量方程为\n$$\n-\\nabla \\cdot \\left(2 \\eta(\\mathbf{x}) \\mathbf{D}(\\mathbf{u})\\right) + \\nabla p = \\mathbf{f}\n$$\n并与不可压缩性约束 $\\nabla \\cdot \\mathbf{u} = 0$ 相耦合。此处，$\\eta(\\mathbf{x})$ 是空间变化的黏度，在地球地幔内部可能变化多个数量级。速度算子的离散形式，记为 $A$，是一个对称正定矩阵。由于巨大的黏度衬度 $\\Delta \\eta$ 和网格的特性，$A$ 通常是病态的，因此需要为 Krylov 求解器 (PCG) 配备像 AMG 这样强大的预处理器。\n\nPCG 的收敛速率由预处理系统 $P^{-1}A$ 的条件数 $\\kappa$ 控制。一个众所周知的界给出了 $n$ 次迭代后误差能量范数的减小量，即 $r(\\kappa)^n$，其中收敛因子为 $r(\\kappa) = \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}$。为了从一个单位初始误差达到期望的误差容差 $\\epsilon$，迭代次数 $n$ 必须满足 $r(\\kappa)^n \\le \\epsilon$。求解 $n$ 得到估计值：\n$$\nn \\ge \\frac{\\ln(\\epsilon)}{\\ln(r(\\kappa))}\n$$\n由于 $n$ 必须是整数，我们取该值的向上取整：\n$$\nn = \\left\\lceil \\frac{\\ln(\\epsilon)}{\\ln\\left(r(\\kappa)\\right)} \\right\\rceil\n$$\n问题提供了一个唯象模型来估计 AMG 预处理系统的有效条件数 $\\kappa_{\\text{eff}}$。该模型组合了几个影响 AMG 性能的因素：\n$$\n\\kappa_{\\text{eff}} = \\kappa^\\star \\cdot F_{\\text{mesh}} \\cdot F_{\\text{levels}} \\cdot F_{\\text{shell}} \\cdot F_{\\text{jump}}\n$$\n其中 $\\kappa^\\star$ 是反映 AMG 理想鲁棒性的基准常数，其他因素则解释了由于网格质量、多重网格层级数、几何形状和系数非均匀性导致的性能下降。\n\n对于变系数问题，AMG 性能的一个关键方面在于平滑器的选择，它是一种迭代方法（如 Gauss-Seidel 或 Jacobi），用于在每个网格层级上减少高频误差分量。黏度 $\\eta(\\mathbf{x})$ 的大跳跃会导致矩阵 $A$ 的元素出现大跳跃。\n- **标准平滑器**：这些平滑器在运行时不考虑矩阵系数。在低黏度和高黏度区域的交界面上，它们变得效率低下。它们无法充分平滑在低黏度区域振荡但在高黏度区域平滑的误差模式，导致平滑与粗网格校正之间的协同作用失效。这种性能退化通过对黏度衬度 $\\Delta \\eta$ 的幂律依赖关系来建模：$F_{\\text{jump,std}}(\\Delta \\eta) = (\\Delta \\eta)^{\\beta}$，其中 $\\beta = \\frac{1}{3}$。这表明随着 $\\Delta \\eta$ 的增长，条件数会发生严重的多项式增长。\n- **黏度加权平滑器**：这些方法被设计为对此类问题具有鲁棒性。它们明确使用矩阵系数的大小（与黏度相关）来缩放平滑更新。这使得平滑器在系数跳跃处仍能保持有效。由此产生的 AMG 预处理器更具鲁棒性，其性能随 $\\Delta \\eta$ 的增加仅轻微下降。这通过对数依赖关系来捕捉：$F_{\\text{jump,w}}(\\Delta \\eta) = 1 + c \\log_{10}(\\Delta \\eta)$，其中 $c = 0.5$。\n\n计算过程首先为每个测试用例评估公共因子：\n1.  **网格因子**：$F_{\\text{mesh}}(q) = 1 + \\gamma (1 - q)$，其中 $\\gamma = 15$。随着网格质量 $q$ 的下降（趋近于 0），该因子增加。\n2.  **层级因子**：$F_{\\text{levels}}(L) = 1 + 0.1 (L - 1)$。该因子模拟了随着 AMG 层级数 $L$ 的增加而出现的轻微性能下降。\n3.  **球壳几何因子**：$F_{\\text{shell}}(r_{\\text{in}}, r_{\\text{out}}) = 1 + \\delta \\frac{R_m}{H}$，其中 $\\delta = 0.05$，平均半径 $R_m = \\frac{r_{\\text{in}} + r_{\\text{out}}}{2}$，厚度 $H = r_{\\text{out}} - r_{\\text{in}}$。该项解释了几何各向异性，对于薄壳（大的 $\\frac{R_m}{H}$ 比率）来说，这种各向异性更为显著。\n\n接下来，我们为每种情况计算两个不同的跳跃因子，$F_{\\text{jump,std}}$ 和 $F_{\\text{jump,w}}$。然后将它们与公共因子和基准 $\\kappa^\\star = 8$ 组合，计算出 $\\kappa_{\\text{eff,std}}$ 和 $\\kappa_{\\text{eff,w}}$。最后，对于每个有效条件数，我们计算相应的收敛因子 $r(\\kappa_{\\text{eff}})$，并使用迭代次数公式找出估计的迭代次数 $n_{\\text{std}}$ 和 $n_{\\text{w}}$。\n\n对于提供的每个测试用例，我们将计算迭代次数对 $[n_{\\text{std}}, n_{\\text{w}}]$。结果将定量地展示黏度加权平滑器的优越鲁棒性，特别是在高黏度衬度、差网格质量或具挑战性的几何形状等场景中，这体现在与 $n_{\\text{std}}$ 相比，预测的 $n_{\\text{w}}$ 迭代次数要低得多。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the estimated PCG iteration counts for standard and\n    viscosity-weighted AMG smoothers based on the provided model and test cases.\n    \"\"\"\n    \n    # Define constants from the problem statement.\n    KAPPA_STAR = 8.0\n    GAMMA = 15.0\n    DELTA = 0.05\n    BETA = 1.0 / 3.0\n    C = 0.5\n\n    # Define the factor models as functions.\n    def f_mesh(q):\n        \"\"\"Calculates the mesh quality factor.\"\"\"\n        return 1.0 + GAMMA * (1.0 - q)\n\n    def f_levels(L):\n        \"\"\"Calculates the AMG level factor.\"\"\"\n        return 1.0 + 0.1 * (L - 1.0)\n\n    def f_shell(r_in, r_out):\n        \"\"\"Calculates the spherical shell geometric factor.\"\"\"\n        if r_out == r_in:\n            # Avoid division by zero or negative thickness.\n            # This case is physically not expected in the problem context.\n            return 1.0 \n        R_m = (r_in + r_out) / 2.0\n        H = r_out - r_in\n        return 1.0 + DELTA * (R_m / H)\n\n    def f_jump_std(delta_eta):\n        \"\"\"Calculates the coefficient-jump factor for standard smoothers.\"\"\"\n        return delta_eta**BETA\n\n    def f_jump_w(delta_eta):\n        \"\"\"Calculates the coefficient-jump factor for viscosity-weighted smoothers.\"\"\"\n        return 1.0 + C * np.log10(delta_eta)\n\n    def calculate_iterations(kappa_eff, epsilon):\n        \"\"\"Estimates the number of PCG iterations required.\"\"\"\n        # For a perfectly preconditioned system, kappa_eff = 1, r = 0, iterations = 1.\n        if kappa_eff == 1.0:\n            return 1\n            \n        sqrt_kappa = np.sqrt(kappa_eff)\n        r = (sqrt_kappa - 1.0) / (sqrt_kappa + 1.0)\n        \n        # If r is close to 1, log(r) is close to 0, indicating slow convergence.\n        # This check prevents division by a very small number or zero if r=1.\n        if r >= 1.0:\n            return np.inf # Divergence\n\n        num_iter = np.ceil(np.log(epsilon) / np.log(r))\n        return int(num_iter)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'delta_eta': 1e6, 'q': 0.5, 'L': 5, 'r_in': 3.48e6, 'r_out': 6.371e6, 'epsilon': 1e-6},\n        {'delta_eta': 1e3, 'q': 0.95, 'L': 5, 'r_in': 3.48e6, 'r_out': 6.371e6, 'epsilon': 1e-8},\n        {'delta_eta': 1e8, 'q': 0.1, 'L': 6, 'r_in': 3.48e6, 'r_out': 6.371e6, 'epsilon': 1e-4},\n        {'delta_eta': 1e6, 'q': 0.7, 'L': 4, 'r_in': 6.0e6, 'r_out': 6.2e6, 'epsilon': 1e-6},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        delta_eta = case['delta_eta']\n        q = case['q']\n        L = case['L']\n        r_in = case['r_in']\n        r_out = case['r_out']\n        epsilon = case['epsilon']\n\n        # Calculate the common factors for the condition number\n        factor_mesh = f_mesh(q)\n        factor_levels = f_levels(L)\n        factor_shell = f_shell(r_in, r_out)\n\n        # Calculate the base part of the condition number\n        kappa_base = KAPPA_STAR * factor_mesh * factor_levels * factor_shell\n\n        # --- Standard Smoother Calculation ---\n        factor_jump_std = f_jump_std(delta_eta)\n        kappa_eff_std = kappa_base * factor_jump_std\n        n_std = calculate_iterations(kappa_eff_std, epsilon)\n        \n        # --- Viscosity-Weighted Smoother Calculation ---\n        factor_jump_w = f_jump_w(delta_eta)\n        kappa_eff_w = kappa_base * factor_jump_w\n        n_w = calculate_iterations(kappa_eff_w, epsilon)\n\n        results.append([n_std, n_w])\n\n    # Format the final output string exactly as required: [[n_std,1,n_w,1],[...]]\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}