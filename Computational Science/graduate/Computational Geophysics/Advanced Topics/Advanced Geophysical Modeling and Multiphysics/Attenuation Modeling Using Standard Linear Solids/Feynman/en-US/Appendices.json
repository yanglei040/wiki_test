{
    "hands_on_practices": [
        {
            "introduction": "A robust understanding of attenuation modeling begins with the fundamental building blocks. The Standard Linear Solid (SLS) is a cornerstone model in viscoelasticity, and a deep familiarity with its behavior is essential. This first practice challenges you to derive the time-domain response of the SLS model—its relaxation modulus $G(t)$ and creep compliance $J(t)$—directly from the first principles of mechanics, and then to implement these functions computationally. Completing this exercise will solidify your grasp of how the interplay between elastic and viscous components defines the material's response over time .",
            "id": "3576712",
            "problem": "You are to derive and implement the relaxation modulus and creep compliance functions for the Standard Linear Solid (SLS) model used in computational geophysics for attenuation modeling. The Standard Linear Solid (SLS) is constructed by placing a linear spring of modulus $E_{2}$ in parallel with a Maxwell element consisting of a linear spring of modulus $E_{1}$ in series with a linear dashpot of viscosity $\\eta$. The fundamental base you must use is: Hooke's law for a linear spring ($\\sigma = E \\,\\epsilon$) and Newtonian viscosity for a dashpot ($\\sigma = \\eta \\, d\\epsilon/dt$), plus equilibrium and compatibility in series and parallel connections.\n\nDefinitions to use:\n- The relaxation modulus $G(t)$ is defined as the stress response per unit step strain input, that is, $G(t) = \\sigma(t)/\\epsilon_{0}$ under $\\epsilon(t) = \\epsilon_{0} H(t)$, where $H(t)$ is the Heaviside step function.\n- The creep compliance $J(t)$ is defined as the strain response per unit step stress input, that is, $J(t) = \\epsilon(t)/\\sigma_{0}$ under $\\sigma(t) = \\sigma_{0} H(t)$.\n\nYou must start from the fundamental laws and the structure of the SLS, derive the governing equations and solve them to obtain explicit expressions for $G(t)$ and $J(t)$ valid for all $t \\ge 0$. No shortcut formulas are allowed in the problem statement, and you must ensure scientific realism throughout. The derivation must be strictly from the stated base, using correct mechanical equilibrium and strain compatibility for the series and parallel connections.\n\nYour program must implement the derived expressions and compute $G(t)$ in Pascals and $J(t)$ in $\\mathrm{Pa}^{-1}$ for the following test suite. You must also compute the characteristic relaxation and creep times you identify during derivation, denoted $\\tau_{r}$ and $\\tau_{c}$, respectively, in seconds.\n\nTest Suite:\n- Case $1$ (general happy path): $E_{1} = 28 \\times 10^{9}$ $\\mathrm{Pa}$, $E_{2} = 36 \\times 10^{9}$ $\\mathrm{Pa}$, $\\eta = 5 \\times 10^{14}$ $\\mathrm{Pa}\\cdot\\mathrm{s}$, time points $t = [0, 10^{-1}, 10^{1}, 10^{4}]$ $\\mathrm{s}$.\n- Case $2$ (large viscosity boundary): $E_{1} = 15 \\times 10^{9}$ $\\mathrm{Pa}$, $E_{2} = 15 \\times 10^{9}$ $\\mathrm{Pa}$, $\\eta = 10^{20}$ $\\mathrm{Pa}\\cdot\\mathrm{s}$, time points $t = [0, 10^{3}, 10^{9}]$ $\\mathrm{s}$.\n- Case $3$ (near-Maxwell edge with very small parallel spring): $E_{1} = 60 \\times 10^{9}$ $\\mathrm{Pa}$, $E_{2} = 10^{7}$ $\\mathrm{Pa}$, $\\eta = 10^{13}$ $\\mathrm{Pa}\\cdot\\mathrm{s}$, time points $t = [0, 1, 10^{6}]$ $\\mathrm{s}$.\n- Case $4$ (small viscosity boundary): $E_{1} = 45 \\times 10^{9}$ $\\mathrm{Pa}$, $E_{2} = 55 \\times 10^{9}$ $\\mathrm{Pa}$, $\\eta = 10^{3}$ $\\mathrm{Pa}\\cdot\\mathrm{s}$, time points $t = [0, 10^{-6}, 10^{-3}, 1]$ $\\mathrm{s}$.\n\nOutput requirements:\n- For each case, output a list containing:\n    1. A list of $G(t_{i})$ values in $\\mathrm{Pa}$ at the specified time points $t_{i}$.\n    2. A list of $J(t_{i})$ values in $\\mathrm{Pa}^{-1}$ at the specified time points $t_{i}$.\n    3. The value of $\\tau_{r}$ in $\\mathrm{s}$.\n    4. The value of $\\tau_{c}$ in $\\mathrm{s}$.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, with no additional text. For example, the final output should be of the form $[result\\_1, result\\_2, result\\_3, result\\_4]$, where each $result\\_k$ is the list described above.\n\nAll outputs must be expressed in the units specified: $G(t)$ in $\\mathrm{Pa}$, $J(t)$ in $\\mathrm{Pa}^{-1}$, and $\\tau_{r}$ and $\\tau_{c}$ in $\\mathrm{s}$. Angles are not involved in this problem. Percentages are not involved; all numeric answers are floats and lists of floats.\n\nYour derivation must ensure:\n- Scientific realism and correctness of limits: $G(0)$ equals the instantaneous modulus and $J(0)$ equals the instantaneous compliance; long-time limits are physically consistent.\n- Logical consistency across edge cases, including very large and very small viscosities, and very small parallel spring modulus.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of linear viscoelasticity, is well-posed with all necessary information provided, and is stated objectively. We shall proceed with the derivation and solution.\n\nThe objective is to derive the relaxation modulus $G(t)$ and creep compliance $J(t)$ for the Standard Linear Solid (SLS) model from first principles. The SLS model consists of a linear spring with modulus $E_2$ in parallel with a Maxwell element. The Maxwell element itself is composed of a linear spring with modulus $E_1$ in series with a linear dashpot of viscosity $\\eta$. The fundamental constitutive laws are Hooke's Law for a spring, $\\sigma = E \\epsilon$, and the Newtonian law for a dashpot, $\\sigma = \\eta \\dot{\\epsilon}$, where $\\dot{\\epsilon}$ is the strain rate $d\\epsilon/dt$.\n\nWe begin by deriving the governing differential equation that relates the total stress $\\sigma$ and total strain $\\epsilon$ for the composite model.\n\nLet $\\sigma_1$ and $\\epsilon_1$ be the stress and strain in the Maxwell element branch, and $\\sigma_2$ and $\\epsilon_2$ be the stress and strain in the parallel spring branch. Due to the parallel arrangement, the total strain $\\epsilon$ is equal to the strain in each branch:\n$$\n\\epsilon = \\epsilon_1 = \\epsilon_2\n$$\nThe total stress $\\sigma$ is the sum of the stresses in the parallel branches:\n$$\n\\sigma = \\sigma_1 + \\sigma_2\n$$\nFor the parallel spring (branch $2$), the stress-strain relation is given by Hooke's law:\n$$\n\\sigma_2 = E_2 \\epsilon_2 = E_2 \\epsilon\n$$\nNow, consider the Maxwell element (branch $1$). It consists of a spring (modulus $E_1$) and a dashpot (viscosity $\\eta$) in series. Let the strain in the spring be $\\epsilon_{1s}$ and the strain in the dashpot be $\\epsilon_{1d}$. The total strain of the Maxwell element is the sum of the strains of its components:\n$$\n\\epsilon_1 = \\epsilon_{1s} + \\epsilon_{1d}\n$$\nSince the overall strain is $\\epsilon$, we have $\\epsilon = \\epsilon_{1s} + \\epsilon_{1d}$. Differentiating with respect to time $t$ gives the strain rate relation:\n$$\n\\dot{\\epsilon} = \\dot{\\epsilon}_{1s} + \\dot{\\epsilon}_{1d}\n$$\nFor elements in series, the stress is the same throughout the branch. Thus, the stress $\\sigma_1$ is equal to the stress in the spring and the dashpot:\n$$\n\\sigma_1 = E_1 \\epsilon_{1s} \\implies \\epsilon_{1s} = \\frac{\\sigma_1}{E_1} \\implies \\dot{\\epsilon}_{1s} = \\frac{\\dot{\\sigma}_1}{E_1}\n$$\n$$\n\\sigma_1 = \\eta \\dot{\\epsilon}_{1d} \\implies \\dot{\\epsilon}_{1d} = \\frac{\\sigma_1}{\\eta}\n$$\nSubstituting these expressions for the strain rates back into the strain rate equation for the Maxwell element yields its governing equation:\n$$\n\\dot{\\epsilon} = \\frac{\\dot{\\sigma}_1}{E_1} + \\frac{\\sigma_1}{\\eta}\n$$\nTo obtain a single equation relating total stress $\\sigma$ and total strain $\\epsilon$, we use the relations $\\sigma = \\sigma_1 + \\sigma_2$ and $\\sigma_2 = E_2 \\epsilon$. From these, we express $\\sigma_1$ and its derivative $\\dot{\\sigma}_1$ in terms of the total quantities:\n$$\n\\sigma_1 = \\sigma - \\sigma_2 = \\sigma - E_2 \\epsilon\n$$\n$$\n\\dot{\\sigma}_1 = \\dot{\\sigma} - E_2 \\dot{\\epsilon}\n$$\nSubstituting these into the Maxwell element's governing equation:\n$$\n\\dot{\\epsilon} = \\frac{1}{E_1}(\\dot{\\sigma} - E_2 \\dot{\\epsilon}) + \\frac{1}{\\eta}(\\sigma - E_2 \\epsilon)\n$$\nTo group terms, we multiply the entire equation by $E_1 \\eta$:\n$$\nE_1 \\eta \\dot{\\epsilon} = \\eta(\\dot{\\sigma} - E_2 \\dot{\\epsilon}) + E_1(\\sigma - E_2 \\epsilon)\n$$\n$$\nE_1 \\eta \\dot{\\epsilon} = \\eta \\dot{\\sigma} - \\eta E_2 \\dot{\\epsilon} + E_1 \\sigma - E_1 E_2 \\epsilon\n$$\nRearranging to separate the stress and strain terms, we arrive at the governing differential equation for the Standard Linear Solid:\n$$\n\\eta \\dot{\\sigma} + E_1 \\sigma = \\eta(E_1 + E_2) \\dot{\\epsilon} + E_1 E_2 \\epsilon\n$$\n\nWith this governing equation, we can now derive the relaxation modulus and creep compliance.\n\n**Derivation of the Relaxation Modulus $G(t)$**\n\nThe relaxation modulus $G(t)$ is defined as the stress response $\\sigma(t)$ to a unit step strain, $\\epsilon(t) = \\epsilon_0 H(t)$, where $H(t)$ is the Heaviside step function. Thus, $G(t) = \\sigma(t)/\\epsilon_0$. For $t \\ge 0$, $\\epsilon(t) = \\epsilon_0$ is constant. The time derivative is $\\dot{\\epsilon}(t) = \\epsilon_0 \\delta(t)$, where $\\delta(t)$ is the Dirac delta function.\n\nSubstituting these into the governing equation:\n$$\n\\eta \\dot{\\sigma} + E_1 \\sigma = \\eta(E_1 + E_2) \\epsilon_0 \\delta(t) + E_1 E_2 \\epsilon_0 H(t)\n$$\nTo find the initial condition at $t=0^+$, we integrate the equation over an infinitesimal interval $[0^-, 0^+]$:\n$$\n\\int_{0^-}^{0^+} (\\eta \\dot{\\sigma} + E_1 \\sigma) dt = \\int_{0^-}^{0^+} (\\eta(E_1 + E_2) \\epsilon_0 \\delta(t) + E_1 E_2 \\epsilon_0 H(t)) dt\n$$\nAssuming the system is at rest for $t<0$ (i.e., $\\sigma(0^-) = 0$), the integral becomes:\n$$\n\\eta[\\sigma(0^+) - \\sigma(0^-)] + 0 = \\eta(E_1 + E_2) \\epsilon_0 + 0\n$$\n$$\n\\eta \\sigma(0^+) = \\eta(E_1 + E_2) \\epsilon_0 \\implies \\sigma(0^+) = (E_1 + E_2)\\epsilon_0\n$$\nThis initial condition represents the instantaneous elastic response, where the dashpot acts as a rigid element, and the total modulus is the sum of the two spring moduli.\n\nFor $t > 0$, the Dirac delta term is zero and $H(t)=1$, so the ODE simplifies to:\n$$\n\\eta \\dot{\\sigma} + E_1 \\sigma = E_1 E_2 \\epsilon_0\n$$\n$$\n\\dot{\\sigma} + \\frac{E_1}{\\eta} \\sigma = \\frac{E_1 E_2}{\\eta} \\epsilon_0\n$$\nThis is a first-order linear inhomogeneous differential equation. The homogeneous solution is $\\sigma_h(t) = C e^{-(E_1/\\eta)t}$. The particular solution $\\sigma_p$ is a constant, found by setting $\\dot{\\sigma}_p = 0$: $ \\frac{E_1}{\\eta} \\sigma_p = \\frac{E_1 E_2}{\\eta} \\epsilon_0 \\implies \\sigma_p = E_2 \\epsilon_0$.\nThe general solution for $t>0$ is $\\sigma(t) = \\sigma_h(t) + \\sigma_p(t) = C e^{-(E_1/\\eta)t} + E_2 \\epsilon_0$.\n\nWe use the initial condition $\\sigma(0^+) = (E_1 + E_2)\\epsilon_0$ to find the constant $C$:\n$$\n\\sigma(0^+) = C e^0 + E_2 \\epsilon_0 = C + E_2 \\epsilon_0 = (E_1 + E_2)\\epsilon_0\n$$\n$$\nC = E_1 \\epsilon_0\n$$\nThus, the stress response for $t \\ge 0$ is:\n$$\n\\sigma(t) = E_1 \\epsilon_0 e^{-(E_1/\\eta)t} + E_2 \\epsilon_0\n$$\nThe relaxation modulus is $G(t) = \\sigma(t)/\\epsilon_0$:\n$$\nG(t) = E_2 + E_1 e^{-t/\\tau_r}\n$$\nwhere the relaxation time $\\tau_r$ is identified as:\n$$\n\\tau_r = \\frac{\\eta}{E_1}\n$$\nThe limits are physically correct: the instantaneous modulus is $G(0) = E_1 + E_2$, and the long-term (relaxed) modulus is $G(\\infty) = E_2$.\n\n**Derivation of the Creep Compliance $J(t)$**\n\nThe creep compliance $J(t)$ is defined as the strain response $\\epsilon(t)$ to a unit step stress, $\\sigma(t) = \\sigma_0 H(t)$, so $J(t) = \\epsilon(t)/\\sigma_0$. Here, $\\sigma(t) = \\sigma_0$ for $t \\ge 0$, and $\\dot{\\sigma}(t) = \\sigma_0 \\delta(t)$.\n\nSubstituting into the governing equation:\n$$\n\\eta \\sigma_0 \\delta(t) + E_1 \\sigma_0 H(t) = \\eta(E_1 + E_2) \\dot{\\epsilon} + E_1 E_2 \\epsilon\n$$\nIntegrating across $[0^-, 0^+]$ with the at-rest condition $\\epsilon(0^-) = 0$:\n$$\n\\int_{0^-}^{0^+} (\\eta \\sigma_0 \\delta(t) + E_1 \\sigma_0 H(t)) dt = \\int_{0^-}^{0^+} (\\eta(E_1 + E_2) \\dot{\\epsilon} + E_1 E_2 \\epsilon) dt\n$$\n$$\n\\eta \\sigma_0 + 0 = \\eta(E_1 + E_2)[\\epsilon(0^+) - \\epsilon(0^-)] + 0\n$$\n$$\n\\eta \\sigma_0 = \\eta(E_1 + E_2) \\epsilon(0^+) \\implies \\epsilon(0^+) = \\frac{\\sigma_0}{E_1 + E_2}\n$$\nThis initial strain corresponds to the instantaneous compliance $1/(E_1+E_2)$.\n\nFor $t > 0$, the ODE becomes:\n$$\nE_1 \\sigma_0 = \\eta(E_1 + E_2) \\dot{\\epsilon} + E_1 E_2 \\epsilon\n$$\n$$\n\\dot{\\epsilon} + \\frac{E_1 E_2}{\\eta(E_1 + E_2)} \\epsilon = \\frac{E_1 \\sigma_0}{\\eta(E_1 + E_2)}\n$$\nThis is another first-order linear ODE. The homogeneous solution is $\\epsilon_h(t) = C \\exp\\left(-\\frac{E_1 E_2}{\\eta(E_1+E_2)}t\\right)$. The particular solution $\\epsilon_p$ is a constant: $\\frac{E_1 E_2}{\\eta(E_1 + E_2)} \\epsilon_p = \\frac{E_1 \\sigma_0}{\\eta(E_1 + E_2)} \\implies \\epsilon_p = \\sigma_0/E_2$.\nThe general solution for $t>0$ is $\\epsilon(t) = C \\exp\\left(-\\frac{E_1 E_2 t}{\\eta(E_1+E_2)}\\right) + \\frac{\\sigma_0}{E_2}$.\n\nUsing the initial condition $\\epsilon(0^+) = \\sigma_0 / (E_1 + E_2)$:\n$$\n\\epsilon(0^+) = C e^0 + \\frac{\\sigma_0}{E_2} = C + \\frac{\\sigma_0}{E_2} = \\frac{\\sigma_0}{E_1 + E_2}\n$$\n$$\nC = \\frac{\\sigma_0}{E_1 + E_2} - \\frac{\\sigma_0}{E_2} = \\sigma_0 \\left( \\frac{E_2 - (E_1 + E_2)}{E_2(E_1 + E_2)} \\right) = -\\sigma_0 \\frac{E_1}{E_2(E_1 + E_2)}\n$$\nThe strain response for $t \\ge 0$ is:\n$$\n\\epsilon(t) = \\frac{\\sigma_0}{E_2} - \\sigma_0 \\frac{E_1}{E_2(E_1 + E_2)} e^{-\\frac{E_1 E_2 t}{\\eta(E_1+E_2)}}\n$$\nThe creep compliance is $J(t) = \\epsilon(t)/\\sigma_0$:\n$$\nJ(t) = \\frac{1}{E_2} - \\frac{E_1}{E_2(E_1+E_2)} e^{-t/\\tau_c}\n$$\nwhere the creep time (or retardation time) $\\tau_c$ is:\n$$\n\\tau_c = \\frac{\\eta(E_1+E_2)}{E_1 E_2} = \\eta \\left( \\frac{1}{E_1} + \\frac{1}{E_2} \\right)\n$$\nThe limits are physically correct: the instantaneous compliance is $J(0) = \\frac{1}{E_2} - \\frac{E_1}{E_2(E_1+E_2)} = \\frac{E_1+E_2-E_1}{E_2(E_1+E_2)} = \\frac{1}{E_1+E_2}$. The long-term compliance is $J(\\infty) = 1/E_2$.\n\n**Summary of Derived Formulas for Implementation**\n- Relaxation Time: $\\tau_r = \\eta / E_1$\n- Creep Time: $\\tau_c = \\eta (E_1 + E_2) / (E_1 E_2)$\n- Relaxation Modulus: $G(t) = E_2 + E_1 \\exp(-t / \\tau_r)$\n- Creep Compliance: $J(t) = \\frac{1}{E_2} - \\frac{E_1}{E_2(E_1+E_2)} \\exp(-t / \\tau_c)$\nThese formulas are valid for $t \\ge 0$ and will be implemented in the provided code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the relaxation modulus G(t) and creep compliance J(t)\n    for the Standard Linear Solid (SLS) model based on provided test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: E1, E2, eta, t_points\n        (28e9, 36e9, 5e14, np.array([0, 1e-1, 1e1, 1e4])),\n        # Case 2: E1, E2, eta, t_points\n        (15e9, 15e9, 1e20, np.array([0, 1e3, 1e9])),\n        # Case 3: E1, E2, eta, t_points\n        (60e9, 1e7, 1e13, np.array([0, 1, 1e6])),\n        # Case 4: E1, E2, eta, t_points\n        (45e9, 55e9, 1e3, np.array([0, 1e-6, 1e-3, 1])),\n    ]\n\n    results_for_print = []\n\n    for case in test_cases:\n        E1, E2, eta, t_points = case\n\n        # Calculate characteristic relaxation and creep times.\n        # tau_r = eta / E1 (in seconds)\n        tau_r = eta / E1\n\n        # tau_c = eta * (E1 + E2) / (E1 * E2) (in seconds)\n        tau_c = eta * (E1 + E2) / (E1 * E2)\n\n        # Calculate Relaxation Modulus G(t) in Pascals.\n        # G(t) = E2 + E1 * exp(-t / tau_r)\n        # Using np.clip to prevent underflow for large t/tau_r\n        exp_term_g = np.exp(np.clip(-t_points / tau_r, -700, 700))\n        g_values = E2 + E1 * exp_term_g\n        \n        # Calculate Creep Compliance J(t) in Pa^-1.\n        # J(t) = 1/E2 - (E1 / (E2 * (E1 + E2))) * exp(-t / tau_c)\n        # An equivalent and more stable form is:\n        # J_instantaneous = 1 / (E1 + E2)\n        # J_long_term = 1 / E2\n        # J(t) = J_long_term - (J_long_term - J_instantaneous) * exp(-t / tau_c)\n        \n        j_inst = 1.0 / (E1 + E2)\n        j_long = 1.0 / E2\n        \n        exp_term_j = np.exp(np.clip(-t_points / tau_c, -700, 700))\n        j_values = j_long - (j_long - j_inst) * exp_term_j\n\n        # Assemble the results for the current case.\n        # Convert numpy arrays to lists for the required output format.\n        case_result = [g_values.tolist(), j_values.tolist(), tau_r, tau_c]\n        results_for_print.append(case_result)\n\n    # Format the final output string as specified.\n    # The default str() representation for lists is correct.\n    results_as_strings = [str(r) for r in results_for_print]\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from the time domain to the frequency domain allows us to directly tackle one of the central challenges in seismology: modeling the nearly frequency-independent quality factor, $Q$, observed in Earth materials. This exercise requires you to compare the performance of the Standard Linear Solid against the simpler Kelvin–Voigt model in their ability to approximate a constant-$Q$ response over a specified frequency band. By quantifying attenuation misfit and phase dispersion, you will gain critical insight into the limitations of simple viscoelastic models and the direct link between a model's mathematical structure and its physical predictions for wave propagation .",
            "id": "3576769",
            "problem": "A homogeneous one-dimensional viscoelastic rod of density $\\rho$ supports plane longitudinal waves governed by linear momentum balance and linear viscoelastic constitutive laws. For a harmonic plane wave displacement $u(x,t)=\\Re\\{U\\,e^{i(\\omega t - k(\\omega)x)}\\}$, the complex wavenumber $k(\\omega)$ satisfies $k(\\omega)=\\omega\\sqrt{\\rho/E^*(\\omega)}$, where $E^*(\\omega)$ is the complex modulus and the attenuation coefficient is defined by $\\alpha(\\omega)=\\operatorname{Im}\\{k(\\omega)\\}$. The quality factor (Q) is defined by $Q^{-1}(\\omega)=\\tan\\delta(\\omega)=\\operatorname{Im}\\{E^*(\\omega)\\}/\\operatorname{Re}\\{E^*(\\omega)\\}$ for weak dissipation. Consider two viscoelastic models and a finite frequency band intended to approximate a target constant quality factor $Q^{-1}(\\omega)\\equiv Q_0$ over that band:\n\n- Kelvin–Voigt (KV): $E^*_{\\mathrm{KV}}(\\omega)=E+i\\omega\\eta$ with real elastic modulus $E$ and viscosity $\\eta$.\n- Standard Linear Solid (SLS, Zener): a spring of modulus $E_1$ in parallel with a Maxwell branch consisting of a spring of modulus $E_2$ in series with a dashpot of viscosity $\\eta_{\\mathrm{M}}$. The SLS parameters are $(E_1,E_2,\\eta_{\\mathrm{M}})$.\n\nAssume the rod has $E_1=30\\times 10^9\\,\\mathrm{Pa}$, $\\rho=2500\\,\\mathrm{kg/m^3}$, and propagation distance $L=5\\times 10^3\\,\\mathrm{m}$. Define the band center frequency $f_0=20\\,\\mathrm{Hz}$ with angular frequency $\\omega_0=2\\pi f_0$, and the band edges $f_1=10\\,\\mathrm{Hz}$, $f_2=40\\,\\mathrm{Hz}$ with $\\omega_1=2\\pi f_1$ and $\\omega_2=2\\pi f_2$. The target is a constant quality factor $Q_0=0.05$ over $[\\omega_1,\\omega_2]$.\n\nTasks:\n1. For the Kelvin–Voigt model, choose $\\eta$ such that $Q^{-1}_{\\mathrm{KV}}(\\omega_0)=Q_0$. Using the nondispersive reference speed $c_1=\\sqrt{E_1/\\rho}$ to define the target constant-$Q$ attenuation $\\alpha_{\\mathrm{target}}(\\omega)=\\omega Q_0/(2c_1)$, quantify the fractional attenuation misfit $\\alpha_{\\mathrm{KV}}(\\omega)/\\alpha_{\\mathrm{target}}(\\omega)$ at $\\omega_1$ and $\\omega_2$.\n2. For the Standard Linear Solid, determine the complex modulus $E^*_{\\mathrm{SLS}}(\\omega)$ from the mechanical network, and choose $(E_2,\\eta_{\\mathrm{M}})$ so that the peak of $Q^{-1}_{\\mathrm{SLS}}(\\omega)$ equals $Q_0$ at $\\omega_0$. With the same nondispersive reference speed $c_1$, quantify the fractional attenuation misfit $\\alpha_{\\mathrm{SLS}}(\\omega)/\\alpha_{\\mathrm{target}}(\\omega)$ at $\\omega_1$ and $\\omega_2$.\n3. Using the phase accumulation $\\phi(\\omega)=\\operatorname{Re}\\{k(\\omega)\\}L=\\omega L/c(\\omega)$, where $c(\\omega)=\\sqrt{\\operatorname{Re}\\{E^*(\\omega)\\}/\\rho}$, assess the waveform phase error relative to the nondispersive reference speed $c_1$ by $\\Delta\\phi(\\omega)=\\omega L\\left(1/c(\\omega)-1/c_1\\right)$ for both KV and SLS at $\\omega_1$ and $\\omega_2$.\n\nSelect all correct statements about the comparative performance of KV and SLS as constant-$Q$ approximations over the band, based on the above setup and the first-principles definitions:\n\nA. Tuned at $\\omega_0$, the Kelvin–Voigt model produces $\\alpha_{\\mathrm{KV}}(\\omega)/\\alpha_{\\mathrm{target}}(\\omega)=\\omega/\\omega_0$, yielding a $+100\\%$ attenuation overestimation at $\\omega_2$ and a $-50\\%$ attenuation underestimation at $\\omega_1$. The Standard Linear Solid tuned at $\\omega_0$ produces a symmetric attenuation underestimation at both band edges of approximately $20\\%$ relative to $\\alpha_{\\mathrm{target}}(\\omega)$.\n\nB. The Kelvin–Voigt model has negligible phase dispersion to first order in $Q_0$ because $\\operatorname{Re}\\{E^*_{\\mathrm{KV}}(\\omega)\\}$ is constant, whereas the Standard Linear Solid introduces dispersion via $\\operatorname{Re}\\{E^*_{\\mathrm{SLS}}(\\omega)\\}$; for the given parameters and $L$, $\\Delta\\phi_{\\mathrm{SLS}}(\\omega_1)\\approx -0.88\\,\\mathrm{rad}$ and $\\Delta\\phi_{\\mathrm{SLS}}(\\omega_2)\\approx -14.2\\,\\mathrm{rad}$.\n\nC. A single Standard Linear Solid can be tuned to achieve exactly constant $Q^{-1}(\\omega)\\equiv Q_0$ over the full decade $[\\omega_1,\\omega_2]$, simultaneously yielding zero attenuation misfit and zero phase dispersion.\n\nD. If both models are tuned at $\\omega_0$, the Kelvin–Voigt model yields lower integrated attenuation misfit over $[\\omega_1,\\omega_2]$ than the Standard Linear Solid.\n\nChoose all correct options.",
            "solution": "The user has provided a problem in computational geophysics concerning the modeling of viscoelastic wave attenuation. I will first validate the problem statement and then proceed to a full solution, evaluating each option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Waveform**: Harmonic plane wave displacement is $u(x,t)=\\Re\\{U\\,e^{i(\\omega t - k(\\omega)x)}\\}$.\n-   **Complex Wavenumber**: $k(\\omega)=\\omega\\sqrt{\\rho/E^*(\\omega)}$.\n-   **Attenuation Coefficient**: $\\alpha(\\omega)=\\operatorname{Im}\\{k(\\omega)\\}$.\n-   **Quality Factor ($Q$)**: For weak dissipation, $Q^{-1}(\\omega)=\\tan\\delta(\\omega)=\\operatorname{Im}\\{E^*(\\omega)\\}/\\operatorname{Re}\\{E^*(\\omega)\\}$.\n-   **Kelvin–Voigt (KV) Model**: Complex modulus $E^*_{\\mathrm{KV}}(\\omega)=E+i\\omega\\eta$. The problem context implies $E$ should be equated with $E_1$ for comparison.\n-   **Standard Linear Solid (SLS) Model**: A spring of modulus $E_1$ in parallel with a Maxwell branch (spring $E_2$ in series with dashpot $\\eta_{\\mathrm{M}}$). Parameters are $(E_1,E_2,\\eta_{\\mathrm{M}})$.\n-   **Material Properties**: Density $\\rho=2500\\,\\mathrm{kg/m^3}$, SLS spring modulus $E_1=30\\times 10^9\\,\\mathrm{Pa}$, propagation distance $L=5\\times 10^3\\,\\mathrm{m}$.\n-   **Frequency Band**: Center frequency $f_0=20\\,\\mathrm{Hz}$ ($\\omega_0=2\\pi f_0$), band edges $f_1=10\\,\\mathrm{Hz}$ ($\\omega_1=2\\pi f_1$) and $f_2=40\\,\\mathrm{Hz}$ ($\\omega_2=2\\pi f_2$).\n-   **Target Attenuation**: Constant quality factor $Q_0=0.05$ over $[\\omega_1,\\omega_2]$.\n-   **Reference Speed**: Nondispersive reference speed $c_1=\\sqrt{E_1/\\rho}$.\n-   **Target Attenuation Formula**: $\\alpha_{\\mathrm{target}}(\\omega)=\\omega Q_0/(2c_1)$.\n-   **Phase Velocity**: $c(\\omega)=\\sqrt{\\operatorname{Re}\\{E^*(\\omega)\\}/\\rho}$.\n-   **Phase Error**: $\\Delta\\phi(\\omega)=\\omega L\\left(1/c(\\omega)-1/c_1\\right)$.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem is based on the standard theory of linear viscoelasticity and wave propagation, which are fundamental concepts in geophysics and continuum mechanics. The KV and SLS models are canonical, and the definitions of $k(\\omega)$, $\\alpha(\\omega)$, and $Q^{-1}(\\omega)$ are standard. The weak dissipation approximation is commonly used.\n-   **Well-Posed**: The problem provides all necessary parameters and defines clear tasks and tuning criteria for both models. The objectives are quantitative and derivable from the provided information.\n-   **Objective**: The language is precise and mathematical, with no subjective or ambiguous terminology.\n-   **Completeness and Consistency**: The problem is self-contained. The parameter values are physically plausible for crustal rock. $E_1=30\\,\\mathrm{GPa}$, $\\rho=2500\\,\\mathrm{kg/m^3}$ are typical. The frequency range is relevant to seismic exploration. The target $Q_0=0.05$ (i.e., $Q=20$) represents a highly attenuating medium but is physically realistic. The definition of the target attenuation using a reference speed is a standard convention in constant-Q modeling. The problem is internally consistent.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, well-posed, and internally consistent. It is a valid problem. I will now proceed to the solution.\n\n### Solution Derivation\n\nFirst, let's compute the common parameters:\n-   Angular frequencies: $\\omega_0 = 2\\pi(20) = 40\\pi\\,\\mathrm{rad/s}$, $\\omega_1 = 20\\pi\\,\\mathrm{rad/s}$, $\\omega_2 = 80\\pi\\,\\mathrm{rad/s}$. Note that $\\omega_1 = \\omega_0/2$ and $\\omega_2 = 2\\omega_0$.\n-   Reference speed: $c_1 = \\sqrt{E_1/\\rho} = \\sqrt{(30 \\times 10^9\\,\\mathrm{Pa}) / (2500\\,\\mathrm{kg/m^3})} = \\sqrt{12 \\times 10^6}\\,\\mathrm{m/s} \\approx 3464.1\\,\\mathrm{m/s}$.\n-   Target quality factor: $Q_0 = 0.05$.\n\n**Task 1: Kelvin–Voigt Model Analysis**\nFor comparison, we set the elastic modulus of the KV model to $E_1$.\nThe complex modulus is $E^*_{\\mathrm{KV}}(\\omega) = E_1 + i\\omega\\eta$.\nThe inverse quality factor is $Q^{-1}_{\\mathrm{KV}}(\\omega) = \\frac{\\operatorname{Im}\\{E^*_{\\mathrm{KV}}\\}}{\\operatorname{Re}\\{E^*_{\\mathrm{KV}}\\}} = \\frac{\\omega\\eta}{E_1}$.\nThe model is tuned at $\\omega_0$: $Q^{-1}_{\\mathrm{KV}}(\\omega_0) = Q_0 \\implies \\frac{\\omega_0\\eta}{E_1} = Q_0$, so the viscosity is $\\eta = \\frac{E_1 Q_0}{\\omega_0}$.\nSubstituting $\\eta$ back, we find the frequency-dependent $Q^{-1}$: $Q^{-1}_{\\mathrm{KV}}(\\omega) = \\frac{\\omega}{E_1}\\left(\\frac{E_1 Q_0}{\\omega_0}\\right) = Q_0 \\frac{\\omega}{\\omega_0}$.\nThe attenuation coefficient is $\\alpha(\\omega) = \\operatorname{Im}\\{k(\\omega)\\}$. For weak attenuation ($Q^{-1} \\ll 1$), we use the standard approximation:\n$\\alpha(\\omega) \\approx \\frac{\\omega}{2c(\\omega)}Q^{-1}(\\omega)$.\nFor the KV model, $\\operatorname{Re}\\{E^*_{\\mathrm{KV}}\\} = E_1$, so the phase velocity as defined in the problem is $c_{\\mathrm{KV}}(\\omega) = \\sqrt{E_1/\\rho} = c_1$.\nThus, $\\alpha_{\\mathrm{KV}}(\\omega) \\approx \\frac{\\omega}{2c_1} Q^{-1}_{\\mathrm{KV}}(\\omega) = \\frac{\\omega}{2c_1} \\left(Q_0 \\frac{\\omega}{\\omega_0}\\right)$.\nThe target attenuation is $\\alpha_{\\mathrm{target}}(\\omega) = \\frac{\\omega Q_0}{2c_1}$.\nThe fractional attenuation misfit is the ratio:\n$$ \\frac{\\alpha_{\\mathrm{KV}}(\\omega)}{\\alpha_{\\mathrm{target}}(\\omega)} = \\frac{\\frac{\\omega Q_0}{2c_1} \\frac{\\omega}{\\omega_0}}{\\frac{\\omega Q_0}{2c_1}} = \\frac{\\omega}{\\omega_0} $$\nAt the lower band edge $\\omega_1=\\omega_0/2$, the ratio is $1/2$. The relative error is $(1/2 - 1) = -0.5$, which is a $50\\%$ underestimation.\nAt the upper band edge $\\omega_2=2\\omega_0$, the ratio is $2$. The relative error is $(2 - 1) = +1.0$, which is a $100\\%$ overestimation.\nThis confirms the first part of option A.\n\n**Task 2: Standard Linear Solid Model Analysis**\nThe complex modulus is the sum of the parallel components: $E^*_{\\mathrm{SLS}}(\\omega) = E_1 + \\frac{E_2(i\\omega\\eta_{\\mathrm{M}})}{E_2+i\\omega\\eta_{\\mathrm{M}}}$.\nThe real and imaginary parts are:\n$\\operatorname{Re}\\{E^*_{\\mathrm{SLS}}\\} = E_1 + \\frac{E_2 \\omega^2\\eta_{\\mathrm{M}}^2}{E_2^2+\\omega^2\\eta_{\\mathrm{M}}^2}$\n$\\operatorname{Im}\\{E^*_{\\mathrm{SLS}}\\} = \\frac{E_2^2 \\omega\\eta_{\\mathrm{M}}}{E_2^2+\\omega^2\\eta_{\\mathrm{M}}^2}$\nThe inverse quality factor is $Q^{-1}_{\\mathrm{SLS}}(\\omega) = \\frac{\\operatorname{Im}\\{E^*\\}}{\\operatorname{Re}\\{E^*\\}}$.\nTo tune the model, we set the peak of $Q^{-1}_{\\mathrm{SLS}}(\\omega)$ to occur at $\\omega_0$ with a value of $Q_0$. The peak of $Q^{-1}$ for an SLS model occurs at the frequency $\\omega_{peak}$ and has the value $Q^{-1}_{peak}$ given by:\n$$ \\omega_{peak} = \\frac{E_2}{\\eta_{\\mathrm{M}}} \\sqrt{\\frac{E_1}{E_1+E_2}}, \\quad Q^{-1}_{peak} = \\frac{E_2}{2\\sqrt{E_1(E_1+E_2)}} $$\nSetting $\\omega_{peak}=\\omega_0$ and $Q^{-1}_{peak}=Q_0$ provides two equations to determine $E_2$ and $\\eta_{\\mathrm{M}}$.\nFor weak attenuation ($Q_0 \\ll 1$), it can be shown that $Q^{-1}_{\\mathrm{SLS}}(\\omega)$ is well-approximated by a Debye peak shape centered at $\\omega_0$:\n$$ Q^{-1}_{\\mathrm{SLS}}(\\omega) \\approx Q_0 \\frac{2(\\omega/\\omega_0)}{1+(\\omega/\\omega_0)^2} $$\nThe attenuation is $\\alpha_{\\mathrm{SLS}}(\\omega) \\approx \\frac{\\omega}{2c_{\\mathrm{SLS}}(\\omega)}Q^{-1}_{\\mathrm{SLS}}(\\omega)$.\nThe attenuation misfit is $\\frac{\\alpha_{\\mathrm{SLS}}(\\omega)}{\\alpha_{\\mathrm{target}}(\\omega)} = \\frac{Q^{-1}_{\\mathrm{SLS}}(\\omega)}{Q_0} \\frac{c_1}{c_{\\mathrm{SLS}}(\\omega)}$. The term $c_1/c_{\\mathrm{SLS}}(\\omega)$ is a correction of order $1-O(Q_0)$. To a first approximation, the misfit is dominated by the ratio of quality factors.\n$$ \\frac{\\alpha_{\\mathrm{SLS}}(\\omega)}{\\alpha_{\\mathrm{target}}(\\omega)} \\approx \\frac{Q^{-1}_{\\mathrm{SLS}}(\\omega)}{Q_0} \\approx \\frac{2(\\omega/\\omega_0)}{1+(\\omega/\\omega_0)^2} $$\nAt the band edges, let $x=\\omega/\\omega_0$. The band is $[1/2, 2]$.\nAt $\\omega_1$ ($x=1/2$): Misfit ratio $\\approx \\frac{2(1/2)}{1+(1/2)^2} = \\frac{1}{1+1/4} = \\frac{4}{5} = 0.8$. This is a $20\\%$ underestimation.\nAt $\\omega_2$ ($x=2$): Misfit ratio $\\approx \\frac{2(2)}{1+(2)^2} = \\frac{4}{5} = 0.8$. This is also a $20\\%$ underestimation.\nThe approximation predicts a symmetric underestimation of $20\\%$ at the band edges. This confirms the second part of option A.\n\n**Task 3: Phase Error Analysis**\nPhase error is $\\Delta\\phi(\\omega)=\\omega L\\left(1/c(\\omega)-1/c_1\\right)$.\n\nFor the **KV model**:\n$c_{\\mathrm{KV}}(\\omega) = \\sqrt{\\operatorname{Re}\\{E^*_{\\mathrm{KV}}\\}/\\rho} = \\sqrt{E_1/\\rho} = c_1$.\nTherefore, $1/c_{\\mathrm{KV}}(\\omega) - 1/c_1 = 0$, and $\\Delta\\phi_{\\mathrm{KV}}(\\omega)=0$. The KV model, by this definition of phase velocity, is non-dispersive. While the true physical phase velocity $v_p=\\omega/\\operatorname{Re}\\{k\\}$ is dispersive (of order $Q_0^2$), the dispersion is indeed negligible to first order in $Q_0$, and zero according to the problem's explicit formula.\n\nFor the **SLS model**:\n$c_{\\mathrm{SLS}}(\\omega) = \\sqrt{\\operatorname{Re}\\{E^*_{\\mathrm{SLS}}\\}/\\rho}$. As derived and verified in the thought process, the exact expression is:\n$$ \\operatorname{Re}\\{E^*_{\\mathrm{SLS}}\\} = E_1 \\frac{1+(\\omega/\\omega_0)^2}{1+(\\omega/\\omega_0)^2 \\frac{E_1}{E_1+E_2}} $$\nThe ratio $E_2/E_1$ is found by solving $Q_0 = \\frac{E_2/E_1}{2\\sqrt{1+E_2/E_1}}$. For $Q_0=0.05$, this gives $E_2/E_1 \\approx 0.105125$.\nThis gives $\\frac{E_1}{E_1+E_2} = \\frac{1}{1+E_2/E_1} \\approx 0.90487$. Let this factor be $\\beta$.\n$c(\\omega) = c_1 \\sqrt{\\frac{1+x^2}{1+\\beta x^2}}$, where $x=\\omega/\\omega_0$.\nThe phase error is $\\Delta\\phi_{\\mathrm{SLS}}(\\omega) = \\frac{\\omega L}{c_1}\\left(\\sqrt{\\frac{1+\\beta x^2}{1+x^2}} - 1\\right)$.\nAt $\\omega_1 = \\omega_0/2 = 20\\pi$:\n$\\frac{\\omega_1 L}{c_1} = \\frac{(20\\pi)(5000)}{3464.1} \\approx 90.79\\,\\mathrm{rad}$.\n$\\Delta\\phi_{\\mathrm{SLS}}(\\omega_1) = 90.79 \\left(\\sqrt{\\frac{1+0.90487(0.5)^2}{1+(0.5)^2}} - 1\\right) = 90.79 \\left(\\sqrt{\\frac{1.2262}{1.25}} - 1\\right) = 90.79(\\sqrt{0.98096}-1) \\approx 90.79(0.99044-1) \\approx -0.868\\,\\mathrm{rad}$.\nThis value is very close to the stated $-0.88\\,\\mathrm{rad}$ in option B.\n\nAt $\\omega_2 = 2\\omega_0 = 80\\pi$:\n$\\frac{\\omega_2 L}{c_1} = \\frac{(80\\pi)(5000)}{3464.1} \\approx 363.17\\,\\mathrm{rad}$.\n$\\Delta\\phi_{\\mathrm{SLS}}(\\omega_2) = 363.17 \\left(\\sqrt{\\frac{1+0.90487(2)^2}{1+(2)^2}} - 1\\right) = 363.17 \\left(\\sqrt{\\frac{4.6195}{5}} - 1\\right) = 363.17(\\sqrt{0.9239}-1) \\approx 363.17(0.9612-1) \\approx -14.09\\,\\mathrm{rad}$.\nThis value is very close to the stated $-14.2\\,\\mathrm{rad}$ in option B.\nThe small discrepancies are due to rounding of physical constants. The calculations confirm the statements in option B.\n\n### Evaluation of Options\n\n**A. Tuned at $\\omega_0$, the Kelvin–Voigt model produces $\\alpha_{\\mathrm{KV}}(\\omega)/\\alpha_{\\mathrm{target}}(\\omega)=\\omega/\\omega_0$, yielding a $+100\\%$ attenuation overestimation at $\\omega_2$ and a $-50\\%$ attenuation underestimation at $\\omega_1$. The Standard Linear Solid tuned at $\\omega_0$ produces a symmetric attenuation underestimation at both band edges of approximately $20\\%$ relative to $\\alpha_{\\mathrm{target}}(\\omega)$.**\n- Our analysis confirms every part of this statement. The KV model's misfit is $\\omega/\\omega_0$, leading to the stated errors. The SLS model's approximate misfit is $2x/(1+x^2)$ (where $x=\\omega/\\omega_0$), which is $0.8$ at both band edges, corresponding to a symmetric $20\\%$ underestimation.\n- **Verdict: Correct.**\n\n**B. The Kelvin–Voigt model has negligible phase dispersion to first order in $Q_0$ because $\\operatorname{Re}\\{E^*_{\\mathrm{KV}}(\\omega)\\}$ is constant, whereas the Standard Linear Solid introduces dispersion via $\\operatorname{Re}\\{E^*_{\\mathrm{SLS}}(\\omega)\\}$; for the given parameters and $L$, $\\Delta\\phi_{\\mathrm{SLS}}(\\omega_1)\\approx -0.88\\,\\mathrm{rad}$ and $\\Delta\\phi_{\\mathrm{SLS}}(\\omega_2)\\approx -14.2\\,\\mathrm{rad}$.**\n- Our analysis shows that $\\Delta\\phi_{\\mathrm{KV}}(\\omega)=0$ based on the problem's definition, which is consistent with \"negligible\". The SLS model is indeed dispersive. Our detailed calculation for $\\Delta\\phi_{\\mathrm{SLS}}$ yielded values of $-0.868\\,\\mathrm{rad}$ and $-14.09\\,\\mathrm{rad}$, which are in excellent agreement with the values given in the option.\n- **Verdict: Correct.**\n\n**C. A single Standard Linear Solid can be tuned to achieve exactly constant $Q^{-1}(\\omega)\\equiv Q_0$ over the full decade $[\\omega_1,\\omega_2]$, simultaneously yielding zero attenuation misfit and zero phase dispersion.**\n- The frequency dependence of $Q^{-1}_{\\mathrm{SLS}}(\\omega)$ is a peak function (Debye peak). It is fundamentally not constant over any finite frequency interval. To achieve nearly constant-Q behavior over a wide band, a distribution of SLS elements (a generalized standard linear solid) is required. Consequently, a single SLS cannot have zero attenuation misfit relative to a constant-Q target, nor can it have zero phase dispersion, as its $\\operatorname{Re}\\{E^*\\}$ is frequency-dependent.\n- **Verdict: Incorrect.**\n\n**D. If both models are tuned at $\\omega_0$, the Kelvin–Voigt model yields lower integrated attenuation misfit over $[\\omega_1,\\omega_2]$ than the Standard Linear Solid.**\n- The attenuation of the KV model, $\\alpha_{\\mathrm{KV}} \\propto \\omega^2$, is a poor functional match for the target $\\alpha_{\\mathrm{target}} \\propto \\omega$. The SLS model's attenuation is designed to be a better match around the peak. We can quantify the integrated absolute error, $\\int_{\\omega_1}^{\\omega_2} |\\alpha_{\\text{model}}/\\alpha_{\\text{target}} - 1|d\\omega$.\n- Let $x=\\omega/\\omega_0$.\n- $I_{KV} = \\int_{1/2}^{2} |x-1| dx = \\int_{1/2}^{1} (1-x)dx + \\int_1^2(x-1)dx = [x-x^2/2]_{1/2}^1 + [x^2/2-x]_1^2 = 1/8 + 1/2 = 5/8=0.625$. (This is the integral normalized by $\\omega_0$).\n- $I_{SLS} \\approx \\int_{1/2}^{2} |2x/(1+x^2) - 1|dx = \\int_{1/2}^{2} (1-2x/(1+x^2))dx = [x-\\ln(1+x^2)]_{1/2}^2 = (2-\\ln 5) - (1/2-\\ln(5/4)) = 1.5 - \\ln 4 \\approx 0.114$.\n- Since $0.114 \\ll 0.625$, the SLS model has a much smaller integrated misfit.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "While a single SLS mechanism provides a better approximation of constant-$Q$ attenuation than simpler models, it is still imperfect over broad frequency bands. The standard solution is to use a generalized SLS model comprising a spectrum of many relaxation mechanisms, but this can become computationally prohibitive. This advanced practice addresses this issue by having you develop and evaluate a coarse-graining strategy to reduce model complexity. You will learn to manage the crucial trade-off between computational cost and predictive accuracy, a vital skill for developing efficient and realistic large-scale geophysical simulations .",
            "id": "3576792",
            "problem": "You are modeling attenuation in a linear viscoelastic medium using a generalized collection of Standard Linear Solids (SLS), each characterized by a relaxation time $\\,\\tau_j\\,$ and a relaxation strength $\\,\\delta_j\\,$. In computational geophysics, evaluating the attenuation as a function of angular frequency $\\,\\omega\\,$ for many mechanisms incurs a computational cost that scales with the number of mechanisms. You are asked to derive, implement, and evaluate a coarse-graining strategy that reduces the number of mechanisms by aggregating them into bins in $\\,\\tau_j\\,$ while quantifying the trade-off in fitting accuracy to the target quality factor $\\,Q(\\omega)\\,$. The specific tasks and requirements are:\n\n- Begin from the fundamental base of linear viscoelasticity, specifically the definition of the quality factor $\\,Q(\\omega)\\,$ as the ratio of twice the energy stored to the energy dissipated per cycle under harmonic excitation, and the standard representation of the medium’s linear response via relaxation spectra. Derive, from first principles, how a multi-mechanism SLS model contributes to attenuation as a function of $\\,\\omega\\,$ in the small-loss regime. Explain why a distribution of mechanisms over logarithmic relaxation time $\\,\\ln \\tau\\,$ can approximate a nearly constant target $\\,Q^{-1}(\\omega)\\,$ over a finite bandwidth.\n\n- Propose a mathematically precise coarse-graining strategy that partitions the set of relaxation times $\\,\\{\\tau_j\\}\\,$ into a prescribed number of bins over $\\,\\ln \\tau\\,$. For each bin, define an effective relaxation time $\\,\\tau_{\\text{eff}}\\,$ and an effective relaxation strength $\\,\\delta_{\\text{eff}}\\,$ in a way that preserves key properties of the original spectrum. Justify the choice of aggregation rules.\n\n- Implement a program that constructs a “target” attenuation model with many mechanisms designed to approximate a nearly constant target $\\,Q^{-1}(\\omega)\\,$ over a specified frequency band. Use a uniform grid in $\\,\\ln \\tau\\,$ with $\\,N\\,=\\,60\\,$ mechanisms spanning relaxation times from $\\,\\tau_{\\min}\\,=\\,10^{-4}\\,\\text{s}\\,$ to $\\,\\tau_{\\max}\\,=\\,10^{2}\\,\\text{s}\\,$. Within the small-loss assumption, assign relaxation strengths $\\,\\delta_j\\,$ so that the ensemble approximates a nearly constant target $\\,Q^{-1}(\\omega)\\,$ whose nominal value is $\\,Q_{0}^{-1}\\,=\\,0.02\\,$ over a frequency band of $\\,f \\in [\\,0.1,\\,1000\\,]\\,$ Hertz. Compute attenuation on a logarithmically spaced frequency grid with $\\,256\\,$ points spanning this band. Use angular frequency $\\,\\omega\\,=\\,2\\pi f\\,$, with $\\,\\omega\\,$ expressed in $\\text{rad/s}$.\n\n- Apply your coarse-graining strategy by aggregating the original $\\,N\\,=\\,60\\,$ mechanisms into $\\,K\\,$ bins over $\\,\\ln\\tau\\,$ for several values of $\\,K\\,$. For each $\\,K\\,$, compute the attenuation of the coarse-grained model and compare it to the target model over the frequency grid. Quantify accuracy using the maximum relative error\n$$\n\\varepsilon_{\\max}(K) \\;=\\; \\max_{\\,\\omega\\,} \\left| \\frac{Q^{-1}_{\\text{coarse}}(\\omega;K) - Q^{-1}_{\\text{target}}(\\omega)}{Q^{-1}_{\\text{target}}(\\omega)} \\right| ,\n$$\nwhich is dimensionless. Quantify computational cost reduction as\n$$\n\\rho(K) \\;=\\; 1 \\;-\\; \\frac{K}{N} ,\n$$\nwhich is also dimensionless.\n\n- Physical and numerical units: express time $\\,\\tau\\,$ in seconds, frequency $\\,f\\,$ in Hertz, and angular frequency $\\,\\omega\\,$ in radians per second. The quality factor $\\,Q(\\omega)\\,$ and the error $\\,\\varepsilon_{\\max}(K)\\,$ are dimensionless. The final numeric answers must be decimals (not percentages), rounded by the program’s default representation.\n\n- Test suite parameter values: use the coarse-graining bin counts $\\,K \\in \\{\\,60,\\,30,\\,20,\\,10,\\,5,\\,1\\,\\}\\,$ to test a no-binning boundary case, intermediate coarse-graining levels, and an extreme single-bin case.\n\n- Final output format: your program should produce a single line of output containing the results for the test suite as a comma-separated list enclosed in square brackets. Each test case output must be a two-element list $[\\,\\varepsilon_{\\max}(K),\\,\\rho(K)\\,]$, and the overall output must be a list of these lists, ordered by the sequence of $\\,K\\,$ values. For example, an acceptable format is\n$[ [\\varepsilon_{\\max}(60),\\rho(60)], [\\varepsilon_{\\max}(30),\\rho(30)], \\dots, [\\varepsilon_{\\max}(1),\\rho(1)] ]$.\n\nYour program must be self-contained and require no input. It must compute and print the results in the exact format described above.",
            "solution": "The problem requires the derivation, implementation, and evaluation of a coarse-graining strategy for modeling viscoelastic attenuation. The process begins with a rigorous validation of the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Model**: Generalized collection of Standard Linear Solids (SLS).\n- **Mechanism Parameters**: Relaxation time $\\tau_j$, relaxation strength $\\delta_j$.\n- **Objective Function**: Attenuation $Q^{-1}(\\omega)$ as a function of angular frequency $\\omega$.\n- **Fundamental Definition**: $Q(\\omega)$ is the ratio of twice the energy stored to the energy dissipated per cycle.\n- **Approximation**: Small-loss regime.\n- **Strategy**: Coarse-graining by aggregating mechanisms into a prescribed number of bins over logarithmic relaxation time, $\\ln \\tau$.\n- **Target Model Specifications**:\n    - Number of mechanisms: $N = 60$.\n    - Relaxation time range: $\\tau_{\\min} = 10^{-4}\\,\\text{s}$ to $\\tau_{\\max} = 10^{2}\\,\\text{s}$.\n    - Relaxation time distribution: Uniform grid in $\\ln \\tau$.\n    - Target attenuation level: $Q_{0}^{-1} = 0.02$ (nearly constant).\n    - Frequency evaluation band: $f \\in [0.1, 1000]\\,$ Hz, with $\\omega = 2\\pi f$.\n    - Frequency sampling: $256$ logarithmically spaced points.\n- **Coarse-Graining Test Suite**: Number of bins $K \\in \\{60, 30, 20, 10, 5, 1\\}$.\n- **Performance Metrics**:\n    - Maximum relative error: $\\varepsilon_{\\max}(K) = \\max_{\\omega} \\left| \\frac{Q^{-1}_{\\text{coarse}}(\\omega;K) - Q^{-1}_{\\text{target}}(\\omega)}{Q^{-1}_{\\text{target}}(\\omega)} \\right|$.\n    - Computational cost reduction: $\\rho(K) = 1 - \\frac{K}{N}$.\n- **Units**: $\\tau$ in seconds (s), $f$ in Hertz (Hz), $\\omega$ in radians per second (rad/s). $Q$, $Q^{-1}$, and $\\varepsilon_{\\max}$ are dimensionless.\n- **Output Format**: A list of two-element lists, `[[ε_max(60),ρ(60)], [ε_max(30),ρ(30)], ..., [ε_max(1),ρ(1)]]`.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is based on the Standard Linear Solid model, a cornerstone of linear viscoelasticity and a standard tool in computational geophysics for modeling anelasticity and attenuation. The concept of approximating a constant-$Q$ response via a distribution of relaxation mechanisms is well-established. All principles are sound.\n- **Well-Posed**: The problem is clearly defined. It specifies the physical model, all parameters for constructing the reference \"target\" model, the exact procedure for evaluation (frequency range, sampling), the metrics for comparison ($\\varepsilon_{\\max}, \\rho$), and the test cases ($K$ values). While it asks for the proposal of a coarse-graining strategy, this is a standard design task in algorithm development and does not render the problem ill-posed. A unique, stable, and meaningful solution can be constructed.\n- **Objective**: The language is formal and quantitative. The tasks involve mathematical derivation and numerical computation, free of subjectivity.\n- **Completeness and Consistency**: The problem is self-contained. The provided parameters ($N$, $\\tau$ range, $Q_0^{-1}$, etc.) are sufficient and consistent.\n- **Realism**: The parameters are physically realistic for seismic wave attenuation in Earth's crust. The frequency band, $Q$ value, and relaxation time spectrum are all within typical ranges.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a well-structured exercise in computational physics that addresses the practical trade-off between model accuracy and computational cost. The solution process may now proceed.\n\n---\n\n### Principle-Based Solution and Algorithmic Design\n\n**1. Attenuation in a Multi-Mechanism SLS Model**\n\nIn linear viscoelasticity, for a harmonic stress $\\sigma(t) = \\sigma_0 e^{i\\omega t}$, the strain response is $\\epsilon(t) = \\epsilon_0 e^{i(\\omega t - \\phi)}$, where $\\phi$ is the phase lag. The system is described by a complex, frequency-dependent modulus $M(\\omega) = M_R(\\omega) + i M_I(\\omega)$, where $M_R$ is the storage modulus and $M_I$ is the loss modulus. The quality factor, $Q(\\omega)$, is defined as the ratio of the real part to the imaginary part of the modulus:\n$$\nQ^{-1}(\\omega) = \\frac{M_I(\\omega)}{M_R(\\omega)} = \\frac{\\text{Im}[M(\\omega)]}{\\text{Re}[M(\\omega)]}\n$$\nA generalized medium with multiple relaxation mechanisms can be modeled as a parallel arrangement of SLS elements. The complex modulus is a superposition of the responses of individual mechanisms. For a collection of $N$ mechanisms, each with relaxation time $\\tau_j$ and relaxation strength $\\delta_j$, the complex modulus $M(\\omega)$ relative to the unrelaxed modulus $M_U$ is:\n$$\nM(\\omega) = M_U \\left( 1 - \\sum_{j=1}^N \\delta_j \\frac{1}{1 + i\\omega\\tau_j} \\right)\n$$\nSeparating this into real and imaginary parts gives:\n$$\n\\text{Re}[M(\\omega)] = M_U \\left( 1 - \\sum_{j=1}^N \\frac{\\delta_j}{1 + (\\omega\\tau_j)^2} \\right)\n$$\n$$\n\\text{Im}[M(\\omega)] = M_U \\sum_{j=1}^N \\frac{\\delta_j \\omega\\tau_j}{1 + (\\omega \\tau_j)^2}\n$$\nThe problem specifies the small-loss regime, which implies that the total relaxation strength is small: $\\sum_{j=1}^N \\delta_j \\ll 1$. In this case, the anelastic effects are a minor perturbation to the purely elastic response. The real part of the modulus is approximately constant and equal to the unrelaxed modulus, $\\text{Re}[M(\\omega)] \\approx M_U$. This simplifies the expression for attenuation to:\n$$\nQ^{-1}(\\omega) \\approx \\frac{\\sum_{j=1}^N \\delta_j \\frac{\\omega\\tau_j}{1 + (\\omega \\tau_j)^2}}{1} = \\sum_{j=1}^N \\delta_j \\frac{\\omega\\tau_j}{1 + (\\omega\\tau_j)^2}\n$$\nThis fundamental result shows that in the small-loss limit, the total attenuation is a linear superposition of Debye peaks, where each term $\\delta_j \\frac{\\omega\\tau_j}{1 + (\\omega\\tau_j)^2}$ represents the contribution of a single mechanism.\n\n**2. Approximating Constant Attenuation**\n\nA single Debye peak is narrowly centered around the frequency $\\omega = 1/\\tau_j$. To model a nearly constant attenuation ($Q^{-1}(\\omega) \\approx \\text{const}$) over a broad frequency band, one must superimpose many such peaks. By distributing the relaxation times $\\tau_j$ logarithmically, the peaks are spaced evenly on a logarithmic frequency axis. If the relaxation strengths $\\delta_j$ are chosen appropriately, their sum can form a flat plateau. For a continuous distribution of mechanisms with density $D(\\tau)$, the attenuation is an integral. If the density of mechanisms per logarithmic time interval, $D(\\ln\\tau)$, is constant, $D(\\ln\\tau) = D_0$, then the integral approximates a constant:\n$$\nQ^{-1}(\\omega) = \\int_{-\\infty}^{\\infty} D_0 \\frac{\\omega\\tau}{1+(\\omega\\tau)^2} d(\\ln\\tau) = D_0 \\int_{-\\infty}^{\\infty} \\frac{v}{1+v^2} d(\\ln v) = D_0 \\frac{\\pi}{2}\n$$\nFor a discrete set of $N$ mechanisms uniformly spaced in $\\ln\\tau$ over a range $[\\ln\\tau_{\\min}, \\ln\\tau_{\\max}]$, the spacing is $\\Delta(\\ln\\tau) = (\\ln\\tau_{\\max} - \\ln\\tau_{\\min})/(N-1)$. By setting the relaxation strength of each mechanism to be a constant value $\\delta_j = \\delta_{\\text{const}}$, we discretize the constant distribution. The constant attenuation level $Q_0^{-1}$ is then approximated by setting $\\delta_{\\text{const}}/\\Delta(\\ln\\tau) \\approx D_0$. Thus, we can set each relaxation strength as:\n$$\n\\delta_j = \\delta_{\\text{const}} = Q_0^{-1} \\frac{2}{\\pi} \\Delta(\\ln\\tau) = Q_0^{-1} \\frac{2}{\\pi} \\frac{\\ln(\\tau_{\\max}/\\tau_{\\min})}{N-1}\n$$\nThis provides a systematic way to construct the fine-grained target model.\n\n**3. Coarse-Graining Strategy**\n\nThe goal is to replace a group of $M$ fine-grained mechanisms within a bin with a single effective mechanism $(\\tau_{\\text{eff}}, \\delta_{\\text{eff}})$ while minimizing the error. The original mechanisms are defined by $\\{\\tau_j, \\delta_j\\}$ for $j$ in a bin $\\mathcal{B}$.\n- **Effective Relaxation Strength $\\delta_{\\text{eff}}$**: Since the total attenuation in the small-loss limit is a linear sum of contributions, the most natural and physically consistent rule is to preserve the total relaxation strength of the bin. This ensures that the low-frequency and high-frequency limits of the attenuation contribution are preserved.\n$$\n\\delta_{\\text{eff}} = \\sum_{j \\in \\mathcal{B}} \\delta_j\n$$\n- **Effective Relaxation Time $\\tau_{\\text{eff}}$**: A simple arithmetic mean is inappropriate for logarithmically distributed parameters. A geometric mean is more suitable. A more robust choice is a strength-weighted geometric mean, which preserves the first moment of the relaxation spectrum distribution $D(\\ln\\tau)$ within the bin.\n$$\n\\ln(\\tau_{\\text{eff}}) = \\frac{\\sum_{j \\in \\mathcal{B}} \\delta_j \\ln(\\tau_j)}{\\sum_{j \\in \\mathcal{B}} \\delta_j} \\quad \\implies \\quad \\tau_{\\text{eff}} = \\exp\\left( \\frac{\\sum_{j \\in \\mathcal{B}} \\delta_j \\ln(\\tau_j)}{\\delta_{\\text{eff}}} \\right)\n$$\nSince our target model construction uses a constant $\\delta_j$ for all $j$, this simplifies to the standard geometric mean of the relaxation times within the bin (i.e., the arithmetic mean of their logarithms). This strategy is chosen for its physical consistency and mathematical robustness.\n\n**4. Implementation Algorithm**\n\nThe implementation follows these steps:\n1.  **Initialization**: Define constants $N, \\tau_{\\min}, \\tau_{\\max}, Q_0^{-1}$ and the frequency grid parameters. Define the test suite of $K$ values.\n2.  **Frequency Grid**: Construct a logarithmically spaced grid of $256$ angular frequencies $\\omega$ corresponding to $f \\in [0.1, 1000]\\,$ Hz.\n3.  **Target Model Construction ($N=60$)**:\n    a. Create an array of $N$ relaxation times $\\tau_j$ that are logarithmically spaced from $\\tau_{\\min}$ to $\\tau_{\\max}$.\n    b. Calculate the uniform logarithmic spacing $\\Delta(\\ln\\tau) = (\\ln\\tau_{\\max} - \\ln\\tau_{\\min})/(N-1)$.\n    c. Calculate the constant relaxation strength $\\delta_{\\text{const}} = Q_0^{-1} \\frac{2}{\\pi} \\Delta(\\ln\\tau)$. Create an array of $N$ identical strengths $\\delta_j$.\n    d. Compute the target attenuation $Q^{-1}_{\\text{target}}(\\omega)$ over the frequency grid using the formula $Q^{-1}(\\omega) \\approx \\sum_{j=1}^N \\delta_j \\frac{\\omega\\tau_j}{1+(\\omega\\tau_j)^2}$.\n4.  **Coarse-Graining Loop**: Iterate through each value of $K$ in the test suite $\\{60, 30, 20, 10, 5, 1\\}$.\n    a. Partition the $N=60$ original mechanisms into $K$ bins, each containing $M = N/K$ adjacent mechanisms.\n    b. For each bin, compute the effective parameters $\\tau_{\\text{eff}}$ and $\\delta_{\\text{eff}}$ using the aggregation rules defined in the previous section.\n    c. Compute the attenuation $Q^{-1}_{\\text{coarse}}(\\omega; K)$ for the resulting $K$-mechanism model.\n    d. Calculate the maximum relative error $\\varepsilon_{\\max}(K)$ by comparing $Q^{-1}_{\\text{coarse}}$ to $Q^{-1}_{\\text{target}}$ over the frequency grid.\n    e. Calculate the cost reduction factor $\\rho(K) = 1 - K/N$.\n    f. Store the pair $[\\varepsilon_{\\max}(K), \\rho(K)]$.\n5.  **Output**: Format the collected results into the specified string format and print to standard output.\n\nThis design provides a complete and rigorous solution to the problem, from first principles to final numerical evaluation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and evaluates a coarse-graining strategy for\n    modeling viscoelastic attenuation using Standard Linear Solids.\n    \"\"\"\n    # 1. Define constants and test parameters from the problem statement.\n    N = 60\n    tau_min = 1e-4  # s\n    tau_max = 1e2   # s\n    Q0_inv_target = 0.02\n    \n    f_min = 0.1    # Hz\n    f_max = 1000.0 # Hz\n    num_freqs = 256\n    \n    K_values = [60, 30, 20, 10, 5, 1]\n\n    # 2. Setup frequency grid.\n    omega_grid = 2 * np.pi * np.logspace(np.log10(f_min), np.log10(f_max), num_freqs)\n\n    # 3. Construct the \"target\" attenuation model with N=60 mechanisms.\n    \n    # Create a uniform grid of N relaxation times in log space.\n    tau_j = np.logspace(np.log10(tau_min), np.log10(tau_max), N)\n    ln_tau_j = np.log(tau_j)\n    \n    # Calculate constant relaxation strength delta_j required to approximate\n    # the target Q^-1 over the desired band.\n    # The spacing on the ln(tau) grid is uniform.\n    delta_ln_tau = (np.log(tau_max) - np.log(tau_min)) / (N - 1)\n    delta_const = (2 / np.pi) * Q0_inv_target * delta_ln_tau\n    delta_j = np.full(N, delta_const)\n\n    def calculate_Q_inv(omega, taus, deltas):\n        \"\"\"\n        Calculates Q^-1(omega) for a given set of mechanisms.\n        Uses broadcasting for efficient computation.\n        \n        Args:\n            omega (np.ndarray): Array of angular frequencies.\n            taus (np.ndarray): Array of relaxation times.\n            deltas (np.ndarray): Array of relaxation strengths.\n            \n        Returns:\n            np.ndarray: Attenuation Q^-1 as a function of omega.\n        \"\"\"\n        # Reshape for broadcasting:\n        # omega -> (num_freqs, 1), taus/deltas -> (1, num_mechanisms)\n        omega_col = omega[:, np.newaxis]\n        taus_row = taus[np.newaxis, :]\n        deltas_row = deltas[np.newaxis, :]\n        \n        # Calculate Debye peak for each (omega, tau) pair\n        debye_peaks = (omega_col * taus_row) / (1 + (omega_col * taus_row)**2)\n        \n        # Sum the contributions from all mechanisms (axis=1)\n        q_inv = np.sum(deltas_row * debye_peaks, axis=1)\n        return q_inv\n\n    # Compute the reference attenuation from the target model.\n    Q_inv_target = calculate_Q_inv(omega_grid, tau_j, delta_j)\n\n    results = []\n    \n    # 4. Loop through coarse-graining levels K.\n    for K in K_values:\n        # The problem ensures N is divisible by K, but it's good practice.\n        if N % K != 0:\n            raise ValueError(f\"N={N} is not divisible by K={K}\")\n        \n        bin_size = N // K\n        \n        tau_eff = np.zeros(K)\n        delta_eff = np.zeros(K)\n        \n        # 5. Apply the coarse-graining strategy to each bin.\n        for i in range(K):\n            start_idx = i * bin_size\n            end_idx = start_idx + bin_size\n            \n            # Get the fine-grained mechanisms for the current bin.\n            bin_deltas = delta_j[start_idx:end_idx]\n            bin_ln_taus = ln_tau_j[start_idx:end_idx]\n            \n            # Aggregation rule 1: Preserve total relaxation strength.\n            delta_eff[i] = np.sum(bin_deltas)\n            \n            # Aggregation rule 2: Use strength-weighted geometric mean for tau.\n            # Since deltas are constant, this simplifies to the geometric mean\n            # of taus, which is the arithmetic mean of ln(taus).\n            ln_tau_eff_i = np.average(bin_ln_taus, weights=bin_deltas)\n            tau_eff[i] = np.exp(ln_tau_eff_i)\n            \n        # 6. Compute Q^-1 for the coarse-grained model.\n        Q_inv_coarse = calculate_Q_inv(omega_grid, tau_eff, delta_eff)\n        \n        # 7. Quantify accuracy and computational cost reduction.\n        # Max relative error\n        relative_error = np.abs((Q_inv_coarse - Q_inv_target) / Q_inv_target)\n        epsilon_max = np.max(relative_error)\n        \n        # Cost reduction\n        rho = 1.0 - (K / N)\n        \n        results.append([epsilon_max, rho])\n\n    # 8. Format the final output string exactly as required.\n    inner_parts = [f\"[{e},{r}]\" for e, r in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    # Print the single-line result.\n    print(final_output)\n\n# Execute the main function.\nsolve()\n```"
        }
    ]
}