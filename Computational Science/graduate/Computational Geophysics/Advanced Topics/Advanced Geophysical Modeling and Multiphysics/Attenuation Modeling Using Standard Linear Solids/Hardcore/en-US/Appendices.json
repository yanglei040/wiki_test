{
    "hands_on_practices": [
        {
            "introduction": "To build robust computational models of seismic attenuation, one must first master the behavior of the fundamental building block: the single Standard Linear Solid (SLS). This practice guides you through the derivation of the SLS model's core time-domain responses—the relaxation modulus $G(t)$ and creep compliance $J(t)$—from first principles. By implementing these functions, you will gain a concrete understanding of how the model's parameters ($E_1$, $E_2$, $\\eta$) govern its viscoelastic behavior over time .",
            "id": "3576712",
            "problem": "You are to derive and implement the relaxation modulus and creep compliance functions for the Standard Linear Solid (SLS) model used in computational geophysics for attenuation modeling. The Standard Linear Solid (SLS) is constructed by placing a linear spring of modulus $E_1$ in parallel with a Maxwell element consisting of a linear spring of modulus $E_2$ in series with a linear dashpot of viscosity $\\eta$. The fundamental base you must use is: Hooke's law for a linear spring ($\\sigma = E \\,\\epsilon$) and Newtonian viscosity for a dashpot ($\\sigma = \\eta \\, d\\epsilon/dt$), plus equilibrium and compatibility in series and parallel connections.\n\nDefinitions to use:\n- The relaxation modulus $G(t)$ is defined as the stress response per unit step strain input, that is, $G(t) = \\sigma(t)/\\epsilon_{0}$ under $\\epsilon(t) = \\epsilon_{0} H(t)$, where $H(t)$ is the Heaviside step function.\n- The creep compliance $J(t)$ is defined as the strain response per unit step stress input, that is, $J(t) = \\epsilon(t)/\\sigma_{0}$ under $\\sigma(t) = \\sigma_{0} H(t)$.\n\nYou must start from the fundamental laws and the structure of the SLS, derive the governing equations and solve them to obtain explicit expressions for $G(t)$ and $J(t)$ valid for all $t \\ge 0$. No shortcut formulas are allowed in the problem statement, and you must ensure scientific realism throughout. The derivation must be strictly from the stated base, using correct mechanical equilibrium and strain compatibility for the series and parallel connections.\n\nYour program must implement the derived expressions and compute $G(t)$ in Pascals and $J(t)$ in $\\mathrm{Pa}^{-1}$ for the following test suite. You must also compute the characteristic relaxation and creep times you identify during derivation, denoted $\\tau_{r}$ and $\\tau_{c}$, respectively, in seconds.\n\nTest Suite:\n- Case $1$ (general happy path): $E_{1} = 36 \\times 10^{9}$ $\\mathrm{Pa}$, $E_{2} = 28 \\times 10^{9}$ $\\mathrm{Pa}$, $\\eta = 5 \\times 10^{14}$ $\\mathrm{Pa}\\cdot\\mathrm{s}$, time points $t = [0, 10^{-1}, 10^{1}, 10^{4}]$ $\\mathrm{s}$.\n- Case $2$ (large viscosity boundary): $E_{1} = 15 \\times 10^{9}$ $\\mathrm{Pa}$, $E_{2} = 15 \\times 10^{9}$ $\\mathrm{Pa}$, $\\eta = 10^{20}$ $\\mathrm{Pa}\\cdot\\mathrm{s}$, time points $t = [0, 10^{3}, 10^{9}]$ $\\mathrm{s}$.\n- Case $3$ (near-Maxwell edge with very small parallel spring): $E_{1} = 10^{7}$ $\\mathrm{Pa}$, $E_{2} = 60 \\times 10^{9}$ $\\mathrm{Pa}$, $\\eta = 10^{13}$ $\\mathrm{Pa}\\cdot\\mathrm{s}$, time points $t = [0, 1, 10^{6}]$ $\\mathrm{s}$.\n- Case $4$ (small viscosity boundary): $E_{1} = 55 \\times 10^{9}$ $\\mathrm{Pa}$, $E_{2} = 45 \\times 10^{9}$ $\\mathrm{Pa}$, $\\eta = 10^{3}$ $\\mathrm{Pa}\\cdot\\mathrm{s}$, time points $t = [0, 10^{-6}, 10^{-3}, 1]$ $\\mathrm{s}$.\n\nOutput requirements:\n- For each case, output a list containing:\n    1. A list of $G(t_{i})$ values in $\\mathrm{Pa}$ at the specified time points $t_{i}$.\n    2. A list of $J(t_{i})$ values in $\\mathrm{Pa}^{-1}$ at the specified time points $t_{i}$.\n    3. The value of $\\tau_{r}$ in $\\mathrm{s}$.\n    4. The value of $\\tau_{c}$ in $\\mathrm{s}$.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, with no additional text. For example, the final output should be of the form $[result\\_1, result\\_2, result\\_3, result\\_4]$, where each $result\\_k$ is the list described above.\n\nAll outputs must be expressed in the units specified: $G(t)$ in $\\mathrm{Pa}$, $J(t)$ in $\\mathrm{Pa}^{-1}$, and $\\tau_{r}$ and $\\tau_{c}$ in $\\mathrm{s}$. Angles are not involved in this problem. Percentages are not involved; all numeric answers are floats and lists of floats.\n\nYour derivation must ensure:\n- Scientific realism and correctness of limits: $G(0)$ equals the instantaneous modulus and $J(0)$ equals the instantaneous compliance; long-time limits are physically consistent.\n- Logical consistency across edge cases, including very large and very small viscosities, and very small parallel spring modulus.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of linear viscoelasticity, is well-posed with all necessary information provided, and is stated objectively. We shall proceed with the derivation and solution.\n\nThe objective is to derive the relaxation modulus $G(t)$ and creep compliance $J(t)$ for the Standard Linear Solid (SLS) model from first principles. The SLS model, as defined in the problem statement and consistent with the main article, consists of a linear spring with modulus $E_1$ in parallel with a Maxwell element. The Maxwell element itself is composed of a linear spring with modulus $E_2$ in series with a linear dashpot of viscosity $\\eta$. The fundamental constitutive laws are Hooke's Law for a spring, $\\sigma = E \\epsilon$, and the Newtonian law for a dashpot, $\\sigma = \\eta \\dot{\\epsilon}$, where $\\dot{\\epsilon}$ is the strain rate $d\\epsilon/dt$.\n\nWe begin by deriving the governing differential equation that relates the total stress $\\sigma$ and total strain $\\epsilon$ for the composite model.\n\nLet $\\sigma_1$ and $\\epsilon_1$ be the stress and strain in the parallel spring branch, and $\\sigma_2$ and $\\epsilon_2$ be the stress and strain in the Maxwell element branch. Due to the parallel arrangement, the total strain $\\epsilon$ is equal to the strain in each branch:\n$$\n\\epsilon = \\epsilon_1 = \\epsilon_2\n$$\nThe total stress $\\sigma$ is the sum of the stresses in the parallel branches:\n$$\n\\sigma = \\sigma_1 + \\sigma_2\n$$\nFor the parallel spring (branch 1), the stress-strain relation is given by Hooke's law:\n$$\n\\sigma_1 = E_1 \\epsilon_1 = E_1 \\epsilon\n$$\nNow, consider the Maxwell element (branch 2). It consists of a spring (modulus $E_2$) and a dashpot (viscosity $\\eta$) in series. Let the strain in the spring be $\\epsilon_{2s}$ and the strain in the dashpot be $\\epsilon_{2d}$. The total strain of the Maxwell element is the sum of the strains of its components:\n$$\n\\epsilon_2 = \\epsilon_{2s} + \\epsilon_{2d}\n$$\nSince the overall strain is $\\epsilon$, we have $\\epsilon = \\epsilon_{2s} + \\epsilon_{2d}$. Differentiating with respect to time $t$ gives the strain rate relation:\n$$\n\\dot{\\epsilon} = \\dot{\\epsilon}_{2s} + \\dot{\\epsilon}_{2d}\n$$\nFor elements in series, the stress is the same throughout the branch. Thus, the stress $\\sigma_2$ is equal to the stress in the spring and the dashpot:\n$$\n\\sigma_2 = E_2 \\epsilon_{2s} \\implies \\epsilon_{2s} = \\frac{\\sigma_2}{E_2} \\implies \\dot{\\epsilon}_{2s} = \\frac{\\dot{\\sigma}_2}{E_2}\n$$\n$$\n\\sigma_2 = \\eta \\dot{\\epsilon}_{2d} \\implies \\dot{\\epsilon}_{2d} = \\frac{\\sigma_2}{\\eta}\n$$\nSubstituting these expressions for the strain rates back into the strain rate equation for the Maxwell element yields its governing equation:\n$$\n\\dot{\\epsilon} = \\frac{\\dot{\\sigma}_2}{E_2} + \\frac{\\sigma_2}{\\eta}\n$$\nTo obtain a single equation relating total stress $\\sigma$ and total strain $\\epsilon$, we use the relations $\\sigma = \\sigma_1 + \\sigma_2$ and $\\sigma_1 = E_1 \\epsilon$. From these, we express $\\sigma_2$ and its derivative $\\dot{\\sigma}_2$ in terms of the total quantities:\n$$\n\\sigma_2 = \\sigma - \\sigma_1 = \\sigma - E_1 \\epsilon\n$$\n$$\n\\dot{\\sigma}_2 = \\dot{\\sigma} - E_1 \\dot{\\epsilon}\n$$\nSubstituting these into the Maxwell element's governing equation:\n$$\n\\dot{\\epsilon} = \\frac{1}{E_2}(\\dot{\\sigma} - E_1 \\dot{\\epsilon}) + \\frac{1}{\\eta}(\\sigma - E_1 \\epsilon)\n$$\nMultiplying by $E_2 \\eta$ and rearranging terms gives the governing differential equation for the Standard Linear Solid, consistent with the main article:\n$$\n\\sigma + \\frac{\\eta}{E_2}\\dot{\\sigma} = E_1 \\epsilon + \\eta\\left(1+\\frac{E_1}{E_2}\\right)\\dot{\\epsilon}\n$$\n\nWith this governing equation, we can now derive the relaxation modulus and creep compliance.\n\n**Derivation of the Relaxation Modulus $G(t)$**\n\nThe relaxation modulus $G(t)$ is defined as the stress response $\\sigma(t)$ to a unit step strain, $\\epsilon(t) = \\epsilon_0 H(t)$. Thus, $G(t) = \\sigma(t)/\\epsilon_0$. For $t \\ge 0$, $\\epsilon(t) = \\epsilon_0$ is constant. The time derivative is $\\dot{\\epsilon}(t) = \\epsilon_0 \\delta(t)$, where $\\delta(t)$ is the Dirac delta function.\n\nIntegrating the governing equation across an infinitesimal interval $[0^-, 0^+]$ gives the initial condition: $\\sigma(0^+) = (E_1 + E_2)\\epsilon_0$. This represents the instantaneous elastic response where the dashpot acts as a rigid element.\n\nFor $t > 0$, the delta term vanishes and the ODE simplifies to:\n$$\n\\sigma + \\frac{\\eta}{E_2}\\dot{\\sigma} = E_1 \\epsilon_0\n$$\n$$\n\\dot{\\sigma} + \\frac{E_2}{\\eta} \\sigma = \\frac{E_1 E_2}{\\eta} \\epsilon_0\n$$\nThis is a first-order linear inhomogeneous differential equation. The homogeneous solution is $\\sigma_h(t) = C e^{-(E_2/\\eta)t}$. The particular solution is the long-term steady state, $\\sigma_p = E_1 \\epsilon_0$. The general solution is $\\sigma(t) = C e^{-(E_2/\\eta)t} + E_1 \\epsilon_0$.\n\nWe use the initial condition $\\sigma(0^+) = (E_1 + E_2)\\epsilon_0$ to find the constant $C$:\n$$\n\\sigma(0^+) = C e^0 + E_1 \\epsilon_0 = C + E_1 \\epsilon_0 = (E_1 + E_2)\\epsilon_0 \\implies C = E_2 \\epsilon_0\n$$\nThus, the stress response for $t \\ge 0$ is $\\sigma(t) = E_1 \\epsilon_0 + E_2 \\epsilon_0 e^{-(E_2/\\eta)t}$. The relaxation modulus is $G(t) = \\sigma(t)/\\epsilon_0$:\n$$\nG(t) = E_1 + E_2 e^{-t/\\tau_r}\n$$\nwhere the relaxation time $\\tau_r$ is identified as:\n$$\n\\tau_r = \\frac{\\eta}{E_2}\n$$\nThe limits are physically correct: instantaneous modulus $G(0) = E_1 + E_2$, relaxed modulus $G(\\infty) = E_1$.\n\n**Derivation of the Creep Compliance $J(t)$**\n\nThe creep compliance $J(t)$ is the strain response $\\epsilon(t)$ to a unit step stress, $\\sigma(t) = \\sigma_0 H(t)$, so $J(t) = \\epsilon(t)/\\sigma_0$. Here, $\\sigma(t) = \\sigma_0$ for $t \\ge 0$, and $\\dot{\\sigma}(t) = \\sigma_0 \\delta(t)$.\n\nIntegrating the governing equation gives the initial condition: $\\epsilon(0^+) = \\frac{\\sigma_0}{E_1 + E_2}$. This corresponds to the instantaneous compliance $1/(E_1+E_2)$.\n\nFor $t > 0$, the ODE becomes:\n$$\n\\sigma_0 = E_1 \\epsilon + \\eta\\left(1+\\frac{E_1}{E_2}\\right)\\dot{\\epsilon}\n$$\n$$\n\\dot{\\epsilon} + \\frac{E_1 E_2}{\\eta(E_1 + E_2)} \\epsilon = \\frac{E_2 \\sigma_0}{\\eta(E_1 + E_2)}\n$$\nThis is another first-order linear ODE. The particular solution (long-term creep) is $\\epsilon_p = \\sigma_0/E_1$. The general solution is $\\epsilon(t) = C \\exp(-t/\\tau_c) + \\sigma_0/E_1$, where the creep time (or retardation time) $\\tau_c$ is:\n$$\n\\tau_c = \\frac{\\eta(E_1+E_2)}{E_1 E_2}\n$$\nUsing the initial condition $\\epsilon(0^+) = \\sigma_0 / (E_1 + E_2)$:\n$$\n\\epsilon(0^+) = C e^0 + \\frac{\\sigma_0}{E_1} = C + \\frac{\\sigma_0}{E_1} = \\frac{\\sigma_0}{E_1 + E_2}\n$$\n$$\nC = \\frac{\\sigma_0}{E_1 + E_2} - \\frac{\\sigma_0}{E_1} = \\sigma_0 \\left( \\frac{E_1 - (E_1 + E_2)}{E_1(E_1 + E_2)} \\right) = -\\sigma_0 \\frac{E_2}{E_1(E_1 + E_2)}\n$$\nThe strain response for $t \\ge 0$ is $\\epsilon(t) = \\frac{\\sigma_0}{E_1} - \\sigma_0 \\frac{E_2}{E_1(E_1 + E_2)} e^{-t/\\tau_c}$. The creep compliance is $J(t) = \\epsilon(t)/\\sigma_0$:\n$$\nJ(t) = \\frac{1}{E_1} - \\frac{E_2}{E_1(E_1+E_2)} e^{-t/\\tau_c}\n$$\nThe limits are correct: instantaneous compliance $J(0) = \\frac{1}{E_1+E_2}$ and long-term compliance $J(\\infty) = 1/E_1$.\n\n**Summary of Derived Formulas for Implementation**\n- Relaxation Time: $\\tau_r = \\eta / E_2$\n- Creep Time: $\\tau_c = \\eta (E_1 + E_2) / (E_1 E_2)$\n- Relaxation Modulus: $G(t) = E_1 + E_2 \\exp(-t / \\tau_r)$\n- Creep Compliance: $J(t) = \\frac{1}{E_1} - \\frac{E_2}{E_1(E_1+E_2)} \\exp(-t / \\tau_c)$\nThese formulas, which now align with the main article's convention, are valid for $t \\ge 0$ and will be implemented in the provided code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the relaxation modulus G(t) and creep compliance J(t)\n    for the Standard Linear Solid (SLS) model based on provided test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # The convention is now E1=Parallel Spring, E2=Maxwell Spring.\n    # The original test case values have been swapped to match this convention.\n    test_cases = [\n        # Case 1: E1 (parallel), E2 (Maxwell), eta, t_points\n        (36e9, 28e9, 5e14, np.array([0, 1e-1, 1e1, 1e4])),\n        # Case 2: E1, E2, eta, t_points (symmetric case, no change)\n        (15e9, 15e9, 1e20, np.array([0, 1e3, 1e9])),\n        # Case 3: E1, E2, eta, t_points\n        (1e7, 60e9, 1e13, np.array([0, 1, 1e6])),\n        # Case 4: E1, E2, eta, t_points\n        (55e9, 45e9, 1e3, np.array([0, 1e-6, 1e-3, 1])),\n    ]\n\n    results_for_print = []\n\n    for case in test_cases:\n        E1, E2, eta, t_points = case\n\n        # Calculate characteristic relaxation and creep times.\n        # tau_r = eta / E2 (in seconds)\n        tau_r = eta / E2\n\n        # tau_c = eta * (E1 + E2) / (E1 * E2) (in seconds)\n        tau_c = eta * (E1 + E2) / (E1 * E2)\n\n        # Calculate Relaxation Modulus G(t) in Pascals.\n        # G(t) = E1 + E2 * exp(-t / tau_r)\n        exp_term_g = np.exp(np.clip(-t_points / tau_r, -700, 700))\n        g_values = E1 + E2 * exp_term_g\n        \n        # Calculate Creep Compliance J(t) in Pa^-1.\n        # J(t) = 1/E1 - (E2 / (E1 * (E1 + E2))) * exp(-t / tau_c)\n        # An equivalent and more stable form is:\n        # J_instantaneous = 1 / (E1 + E2)\n        # J_long_term = 1 / E1\n        # J(t) = J_long_term - (J_long_term - J_instantaneous) * exp(-t / tau_c)\n        \n        j_inst = 1.0 / (E1 + E2)\n        j_long = 1.0 / E1\n        \n        exp_term_j = np.exp(np.clip(-t_points / tau_c, -700, 700))\n        j_values = j_long - (j_long - j_inst) * exp_term_j\n\n        # Assemble the results for the current case.\n        # Convert numpy arrays to lists for the required output format.\n        case_result = [g_values.tolist(), j_values.tolist(), tau_r, tau_c]\n        results_for_print.append(case_result)\n\n    # Format the final output string as specified.\n    # The default str() representation for lists is correct.\n    results_as_strings = [str(r) for r in results_for_print]\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While a single SLS model captures the essence of viscoelasticity, realistic geophysical media often exhibit nearly constant attenuation ($Q$) over broad frequency bands. This requires a superposition of many SLS mechanisms with a spectrum of relaxation times. This exercise challenges you to construct such a generalized model and then tackle the associated computational cost by developing and implementing a coarse-graining strategy, a vital technique for creating efficient yet accurate large-scale simulations .",
            "id": "3576792",
            "problem": "You are modeling attenuation in a linear viscoelastic medium using a generalized collection of Standard Linear Solids (SLS), each characterized by a relaxation time $\\tau_j$ and a relaxation strength $\\delta_j$. In computational geophysics, evaluating the attenuation as a function of angular frequency $\\omega$ for many mechanisms incurs a computational cost that scales with the number of mechanisms. You are asked to derive, implement, and evaluate a coarse-graining strategy that reduces the number of mechanisms by aggregating them into bins in $\\tau_j$ while quantifying the trade-off in fitting accuracy to the target quality factor $Q(\\omega)$. The specific tasks and requirements are:\n\n- Begin from the fundamental base of linear viscoelasticity, specifically the definition of the quality factor $Q(\\omega)$ as the ratio of twice the energy stored to the energy dissipated per cycle under harmonic excitation, and the standard representation of the medium’s linear response via relaxation spectra. Derive, from first principles, how a multi-mechanism SLS model contributes to attenuation as a function of $\\omega$ in the small-loss regime. Explain why a distribution of mechanisms over logarithmic relaxation time $\\ln \\tau$ can approximate a nearly constant target $Q^{-1}(\\omega)$ over a finite bandwidth.\n\n- Propose a mathematically precise coarse-graining strategy that partitions the set of relaxation times $\\{\\tau_j\\}$ into a prescribed number of bins over $\\ln \\tau$. For each bin, define an effective relaxation time $\\tau_{\\text{eff}}$ and an effective relaxation strength $\\delta_{\\text{eff}}$ in a way that preserves key properties of the original spectrum. Justify the choice of aggregation rules.\n\n- Implement a program that constructs a “target” attenuation model with many mechanisms designed to approximate a nearly constant target $Q^{-1}(\\omega)$ over a specified frequency band. Use a uniform grid in $\\ln \\tau$ with $N=60$ mechanisms spanning relaxation times from $\\tau_{\\min}=10^{-4}\\,\\text{s}$ to $\\tau_{\\max}=10^{2}\\,\\text{s}$. Within the small-loss assumption, assign relaxation strengths $\\delta_j$ so that the ensemble approximates a nearly constant target $Q^{-1}(\\omega)$ whose nominal value is $Q_{0}^{-1}=0.02$ over a frequency band of $f \\in [0.1, 1000]$ Hertz. Compute attenuation on a logarithmically spaced frequency grid with $256$ points spanning this band. Use angular frequency $\\omega=2\\pi f$, with $\\omega$ expressed in $\\text{rad/s}$.\n\n- Apply your coarse-graining strategy by aggregating the original $N=60$ mechanisms into $K$ bins over $\\ln\\tau$ for several values of $K$. For each $K$, compute the attenuation of the coarse-grained model and compare it to the target model over the frequency grid. Quantify accuracy using the maximum relative error\n$$\n\\varepsilon_{\\max}(K) = \\max_{\\omega} \\left| \\frac{Q^{-1}_{\\text{coarse}}(\\omega;K) - Q^{-1}_{\\text{target}}(\\omega)}{Q^{-1}_{\\text{target}}(\\omega)} \\right| ,\n$$\nwhich is dimensionless. Quantify computational cost reduction as\n$$\n\\rho(K) = 1 - \\frac{K}{N} ,\n$$\nwhich is also dimensionless.\n\n- Physical and numerical units: express time $\\tau$ in seconds, frequency $f$ in Hertz, and angular frequency $\\omega$ in radians per second. The quality factor $Q(\\omega)$ and the error $\\varepsilon_{\\max}(K)$ are dimensionless. The final numeric answers must be decimals (not percentages), rounded by the program’s default representation.\n\n- Test suite parameter values: use the coarse-graining bin counts $K \\in \\{60, 30, 20, 10, 5, 1\\}$ to test a no-binning boundary case, intermediate coarse-graining levels, and an extreme single-bin case.\n\n- Final output format: your program should produce a single line of output containing the results for the test suite as a comma-separated list enclosed in square brackets. Each test case output must be a two-element list $[\\varepsilon_{\\max}(K), \\rho(K)]$, and the overall output must be a list of these lists, ordered by the sequence of $K$ values. For example, an acceptable format is\n$[[\\varepsilon_{\\max}(60),\\rho(60)], [\\varepsilon_{\\max}(30),\\rho(30)], \\dots, [\\varepsilon_{\\max}(1),\\rho(1)]]$.\n\nYour program must be self-contained and require no input. It must compute and print the results in the exact format described above.",
            "solution": "The problem requires the derivation, implementation, and evaluation of a coarse-graining strategy for modeling viscoelastic attenuation. The process begins with a rigorous validation of the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Model**: Generalized collection of Standard Linear Solids (SLS).\n- **Mechanism Parameters**: Relaxation time $\\tau_j$, relaxation strength $\\delta_j$.\n- **Objective Function**: Attenuation $Q^{-1}(\\omega)$ as a function of angular frequency $\\omega$.\n- **Fundamental Definition**: $Q(\\omega)$ is the ratio of twice the energy stored to the energy dissipated per cycle.\n- **Approximation**: Small-loss regime.\n- **Strategy**: Coarse-graining by aggregating mechanisms into a prescribed number of bins over logarithmic relaxation time, $\\ln \\tau$.\n- **Target Model Specifications**:\n    - Number of mechanisms: $N = 60$.\n    - Relaxation time range: $\\tau_{\\min} = 10^{-4}\\,\\text{s}$ to $\\tau_{\\max} = 10^{2}\\,\\text{s}$.\n    - Relaxation time distribution: Uniform grid in $\\ln \\tau$.\n    - Target attenuation level: $Q_{0}^{-1} = 0.02$ (nearly constant).\n    - Frequency evaluation band: $f \\in [0.1, 1000]\\,$ Hz, with $\\omega = 2\\pi f$.\n    - Frequency sampling: $256$ logarithmically spaced points.\n- **Coarse-Graining Test Suite**: Number of bins $K \\in \\{60, 30, 20, 10, 5, 1\\}$.\n- **Performance Metrics**:\n    - Maximum relative error: $\\varepsilon_{\\max}(K) = \\max_{\\omega} \\left| \\frac{Q^{-1}_{\\text{coarse}}(\\omega;K) - Q^{-1}_{\\text{target}}(\\omega)}{Q^{-1}_{\\text{target}}(\\omega)} \\right|$.\n    - Computational cost reduction: $\\rho(K) = 1 - \\frac{K}{N}$.\n- **Units**: $\\tau$ in seconds (s), $f$ in Hertz (Hz), $\\omega$ in radians per second (rad/s). $Q$, $Q^{-1}$, and $\\varepsilon_{\\max}$ are dimensionless.\n- **Output Format**: A list of two-element lists, `[[ε_max(60),ρ(60)], [ε_max(30),ρ(30)], ..., [ε_max(1),ρ(1)]]`.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is based on the Standard Linear Solid model, a cornerstone of linear viscoelasticity and a standard tool in computational geophysics for modeling anelasticity and attenuation. The concept of approximating a constant-$Q$ response via a distribution of relaxation mechanisms is well-established. All principles are sound.\n- **Well-Posed**: The problem is clearly defined. It specifies the physical model, all parameters for constructing the reference \"target\" model, the exact procedure for evaluation (frequency range, sampling), the metrics for comparison ($\\varepsilon_{\\max}, \\rho$), and the test cases ($K$ values). While it asks for the proposal of a coarse-graining strategy, this is a standard design task in algorithm development and does not render the problem ill-posed. A unique, stable, and meaningful solution can be constructed.\n- **Objective**: The language is formal and quantitative. The tasks involve mathematical derivation and numerical computation, free of subjectivity.\n- **Completeness and Consistency**: The problem is self-contained. The provided parameters ($N$, $\\tau$ range, $Q_0^{-1}$, etc.) are sufficient and consistent.\n- **Realism**: The parameters are physically realistic for seismic wave attenuation in Earth's crust. The frequency band, $Q$ value, and relaxation time spectrum are all within typical ranges.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a well-structured exercise in computational physics that addresses the practical trade-off between model accuracy and computational cost. The solution process may now proceed.\n\n---\n\n### Principle-Based Solution and Algorithmic Design\n\n**1. Attenuation in a Multi-Mechanism SLS Model**\n\nIn linear viscoelasticity, for a harmonic stress $\\sigma(t) = \\sigma_0 e^{i\\omega t}$, the strain response is $\\epsilon(t) = \\epsilon_0 e^{i(\\omega t - \\phi)}$, where $\\phi$ is the phase lag. The system is described by a complex, frequency-dependent modulus $M(\\omega) = M_R(\\omega) + i M_I(\\omega)$, where $M_R$ is the storage modulus and $M_I$ is the loss modulus. The quality factor, $Q(\\omega)$, is defined as the ratio of the real part to the imaginary part of the modulus:\n$$\nQ^{-1}(\\omega) = \\frac{M_I(\\omega)}{M_R(\\omega)} = \\frac{\\text{Im}[M(\\omega)]}{\\text{Re}[M(\\omega)]}\n$$\nA generalized medium with multiple relaxation mechanisms can be modeled as a parallel arrangement of SLS elements. The complex modulus is a superposition of the responses of individual mechanisms. For a collection of $N$ mechanisms, each with relaxation time $\\tau_j$ and relaxation strength $\\delta_j$, the complex modulus $M(\\omega)$ relative to the unrelaxed modulus $M_U$ is:\n$$\nM(\\omega) = M_U \\left( 1 - \\sum_{j=1}^N \\delta_j \\frac{1}{1 + i\\omega\\tau_j} \\right)\n$$\nSeparating this into real and imaginary parts gives:\n$$\n\\text{Re}[M(\\omega)] = M_U \\left( 1 - \\sum_{j=1}^N \\frac{\\delta_j}{1 + (\\omega\\tau_j)^2} \\right)\n$$\n$$\n\\text{Im}[M(\\omega)] = M_U \\sum_{j=1}^N \\frac{\\delta_j \\omega\\tau_j}{1 + (\\omega\\tau_j)^2}\n$$\nThe problem specifies the small-loss regime, which implies that the total relaxation strength is small: $\\sum_{j=1}^N \\delta_j \\ll 1$. In this case, the anelastic effects are a minor perturbation to the purely elastic response. The real part of the modulus is approximately constant and equal to the unrelaxed modulus, $\\text{Re}[M(\\omega)] \\approx M_U$. This simplifies the expression for attenuation to:\n$$\nQ^{-1}(\\omega) \\approx \\frac{\\sum_{j=1}^N \\delta_j \\frac{\\omega\\tau_j}{1 + (\\omega\\tau_j)^2}}{1} = \\sum_{j=1}^N \\delta_j \\frac{\\omega\\tau_j}{1 + (\\omega\\tau_j)^2}\n$$\nThis fundamental result shows that in the small-loss limit, the total attenuation is a linear superposition of Debye peaks, where each term $\\delta_j \\frac{\\omega\\tau_j}{1 + (\\omega \\tau_j)^2}$ represents the contribution of a single mechanism.\n\n**2. Approximating Constant Attenuation**\n\nA single Debye peak is narrowly centered around the frequency $\\omega = 1/\\tau_j$. To model a nearly constant attenuation ($Q^{-1}(\\omega) \\approx \\text{const}$) over a broad frequency band, one must superimpose many such peaks. By distributing the relaxation times $\\tau_j$ logarithmically, the peaks are spaced evenly on a logarithmic frequency axis. If the relaxation strengths $\\delta_j$ are chosen appropriately, their sum can form a flat plateau. For a continuous distribution of mechanisms with density $D(\\tau)$, the attenuation is an integral. If the density of mechanisms per logarithmic time interval, $D(\\ln\\tau)$, is constant, $D(\\ln\\tau) = D_0$, then the integral approximates a constant:\n$$\nQ^{-1}(\\omega) = \\int_{-\\infty}^{\\infty} D_0 \\frac{\\omega\\tau}{1+(\\omega\\tau)^2} d(\\ln\\tau) = D_0 \\int_{-\\infty}^{\\infty} \\frac{v}{1+v^2} d(\\ln v) = D_0 \\frac{\\pi}{2}\n$$\nFor a discrete set of $N$ mechanisms uniformly spaced in $\\ln\\tau$ over a range $[\\ln\\tau_{\\min}, \\ln\\tau_{\\max}]$, the spacing is $\\Delta(\\ln\\tau) = (\\ln\\tau_{\\max} - \\ln\\tau_{\\min})/(N-1)$. By setting the relaxation strength of each mechanism to be a constant value $\\delta_j = \\delta_{\\text{const}}$, we discretize the constant distribution. The constant attenuation level $Q_0^{-1}$ is then approximated by setting $\\delta_{\\text{const}}/\\Delta(\\ln\\tau) \\approx D_0$. Thus, we can set each relaxation strength as:\n$$\n\\delta_j = \\delta_{\\text{const}} = Q_0^{-1} \\frac{2}{\\pi} \\Delta(\\ln\\tau) = Q_0^{-1} \\frac{2}{\\pi} \\frac{\\ln(\\tau_{\\max}/\\tau_{\\min})}{N-1}\n$$\nThis provides a systematic way to construct the fine-grained target model.\n\n**3. Coarse-Graining Strategy**\n\nThe goal is to replace a group of $M$ fine-grained mechanisms within a bin with a single effective mechanism $(\\tau_{\\text{eff}}, \\delta_{\\text{eff}})$ while minimizing the error. The original mechanisms are defined by $\\{\\tau_j, \\delta_j\\}$ for $j$ in a bin $\\mathcal{B}$.\n- **Effective Relaxation Strength $\\delta_{\\text{eff}}$**: Since the total attenuation in the small-loss limit is a linear sum of contributions, the most natural and physically consistent rule is to preserve the total relaxation strength of the bin. This ensures that the low-frequency and high-frequency limits of the attenuation contribution are preserved.\n$$\n\\delta_{\\text{eff}} = \\sum_{j \\in \\mathcal{B}} \\delta_j\n$$\n- **Effective Relaxation Time $\\tau_{\\text{eff}}$**: A simple arithmetic mean is inappropriate for logarithmically distributed parameters. A geometric mean is more suitable. A more robust choice is a strength-weighted geometric mean, which preserves the first moment of the relaxation spectrum distribution $D(\\ln\\tau)$ within the bin.\n$$\n\\ln(\\tau_{\\text{eff}}) = \\frac{\\sum_{j \\in \\mathcal{B}} \\delta_j \\ln(\\tau_j)}{\\sum_{j \\in \\mathcal{B}} \\delta_j} \\quad \\implies \\quad \\tau_{\\text{eff}} = \\exp\\left( \\frac{\\sum_{j \\in \\mathcal{B}} \\delta_j \\ln(\\tau_j)}{\\delta_{\\text{eff}}} \\right)\n$$\nSince our target model construction uses a constant $\\delta_j$ for all $j$, this simplifies to the standard geometric mean of the relaxation times within the bin (i.e., the arithmetic mean of their logarithms). This strategy is chosen for its physical consistency and mathematical robustness.\n\n**4. Implementation Algorithm**\n\nThe implementation follows these steps:\n1.  **Initialization**: Define constants $N, \\tau_{\\min}, \\tau_{\\max}, Q_0^{-1}$ and the frequency grid parameters. Define the test suite of $K$ values.\n2.  **Frequency Grid**: Construct a logarithmically spaced grid of $256$ angular frequencies $\\omega$ corresponding to $f \\in [0.1, 1000]\\,$ Hz.\n3.  **Target Model Construction ($N=60$)**:\n    a. Create an array of $N$ relaxation times $\\tau_j$ that are logarithmically spaced from $\\tau_{\\min}$ to $\\tau_{\\max}$.\n    b. Calculate the uniform logarithmic spacing $\\Delta(\\ln\\tau) = (\\ln\\tau_{\\max} - \\ln\\tau_{\\min})/(N-1)$.\n    c. Calculate the constant relaxation strength $\\delta_{\\text{const}} = Q_0^{-1} \\frac{2}{\\pi} \\Delta(\\ln\\tau)$. Create an array of $N$ identical strengths $\\delta_j$.\n    d. Compute the target attenuation $Q^{-1}_{\\text{target}}(\\omega)$ over the frequency grid using the formula $Q^{-1}(\\omega) \\approx \\sum_{j=1}^N \\delta_j \\frac{\\omega\\tau_j}{1+(\\omega\\tau_j)^2}$.\n4.  **Coarse-Graining Loop**: Iterate through each value of $K$ in the test suite $\\{60, 30, 20, 10, 5, 1\\}$.\n    a. Partition the $N=60$ original mechanisms into $K$ bins, each containing $M = N/K$ adjacent mechanisms.\n    b. For each bin, compute the effective parameters $\\tau_{\\text{eff}}$ and $\\delta_{\\text{eff}}$ using the aggregation rules defined in the previous section.\n    c. Compute the attenuation $Q^{-1}_{\\text{coarse}}(\\omega; K)$ for the resulting $K$-mechanism model.\n    d. Calculate the maximum relative error $\\varepsilon_{\\max}(K)$ by comparing $Q^{-1}_{\\text{coarse}}$ to $Q^{-1}_{\\text{target}}$ over the frequency grid.\n    e. Calculate the cost reduction factor $\\rho(K) = 1 - K/N$.\n    f. Store the pair $[\\varepsilon_{\\max}(K), \\rho(K)]$.\n5.  **Output**: Format the collected results into the specified string format and print to standard output.\n\nThis design provides a complete and rigorous solution to the problem, from first principles to final numerical evaluation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and evaluates a coarse-graining strategy for\n    modeling viscoelastic attenuation using Standard Linear Solids.\n    \"\"\"\n    # 1. Define constants and test parameters from the problem statement.\n    N = 60\n    tau_min = 1e-4  # s\n    tau_max = 1e2   # s\n    Q0_inv_target = 0.02\n    \n    f_min = 0.1    # Hz\n    f_max = 1000.0 # Hz\n    num_freqs = 256\n    \n    K_values = [60, 30, 20, 10, 5, 1]\n\n    # 2. Setup frequency grid.\n    omega_grid = 2 * np.pi * np.logspace(np.log10(f_min), np.log10(f_max), num_freqs)\n\n    # 3. Construct the \"target\" attenuation model with N=60 mechanisms.\n    \n    # Create a uniform grid of N relaxation times in log space.\n    tau_j = np.logspace(np.log10(tau_min), np.log10(tau_max), N)\n    ln_tau_j = np.log(tau_j)\n    \n    # Calculate constant relaxation strength delta_j required to approximate\n    # the target Q^-1 over the desired band.\n    # The spacing on the ln(tau) grid is uniform.\n    delta_ln_tau = (np.log(tau_max) - np.log(tau_min)) / (N - 1)\n    delta_const = (2 / np.pi) * Q0_inv_target * delta_ln_tau\n    delta_j = np.full(N, delta_const)\n\n    def calculate_Q_inv(omega, taus, deltas):\n        \"\"\"\n        Calculates Q^-1(omega) for a given set of mechanisms.\n        Uses broadcasting for efficient computation.\n        \n        Args:\n            omega (np.ndarray): Array of angular frequencies.\n            taus (np.ndarray): Array of relaxation times.\n            deltas (np.ndarray): Array of relaxation strengths.\n            \n        Returns:\n            np.ndarray: Attenuation Q^-1 as a function of omega.\n        \"\"\"\n        # Reshape for broadcasting:\n        # omega -> (num_freqs, 1), taus/deltas -> (1, num_mechanisms)\n        omega_col = omega[:, np.newaxis]\n        taus_row = taus[np.newaxis, :]\n        deltas_row = deltas[np.newaxis, :]\n        \n        # Calculate Debye peak for each (omega, tau) pair\n        debye_peaks = (omega_col * taus_row) / (1 + (omega_col * taus_row)**2)\n        \n        # Sum the contributions from all mechanisms (axis=1)\n        q_inv = np.sum(deltas_row * debye_peaks, axis=1)\n        return q_inv\n\n    # Compute the reference attenuation from the target model.\n    Q_inv_target = calculate_Q_inv(omega_grid, tau_j, delta_j)\n\n    results = []\n    \n    # 4. Loop through coarse-graining levels K.\n    for K in K_values:\n        # The problem ensures N is divisible by K, but it's good practice.\n        if N % K != 0:\n            raise ValueError(f\"N={N} is not divisible by K={K}\")\n        \n        bin_size = N // K\n        \n        tau_eff = np.zeros(K)\n        delta_eff = np.zeros(K)\n        \n        # 5. Apply the coarse-graining strategy to each bin.\n        for i in range(K):\n            start_idx = i * bin_size\n            end_idx = start_idx + bin_size\n            \n            # Get the fine-grained mechanisms for the current bin.\n            bin_deltas = delta_j[start_idx:end_idx]\n            bin_ln_taus = ln_tau_j[start_idx:end_idx]\n            \n            # Aggregation rule 1: Preserve total relaxation strength.\n            delta_eff[i] = np.sum(bin_deltas)\n            \n            # Aggregation rule 2: Use strength-weighted geometric mean for tau.\n            # Since deltas are constant, this simplifies to the geometric mean\n            # of taus, which is the arithmetic mean of ln(taus).\n            ln_tau_eff_i = np.average(bin_ln_taus, weights=bin_deltas)\n            tau_eff[i] = np.exp(ln_tau_eff_i)\n            \n        # 6. Compute Q^-1 for the coarse-grained model.\n        Q_inv_coarse = calculate_Q_inv(omega_grid, tau_eff, delta_eff)\n        \n        # 7. Quantify accuracy and computational cost reduction.\n        # Max relative error\n        relative_error = np.abs((Q_inv_coarse - Q_inv_target) / Q_inv_target)\n        epsilon_max = np.max(relative_error)\n        \n        # Cost reduction\n        rho = 1.0 - (K / N)\n        \n        results.append([epsilon_max, rho])\n\n    # 8. Format the final output string exactly as required.\n    inner_parts = [f\"[{e},{r}]\" for e, r in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    # Print the single-line result.\n    print(final_output)\n\n# Execute the main function.\nsolve()\n```"
        },
        {
            "introduction": "The generalized SLS model is not just for approximating constant-Q behavior; it is a powerful and versatile tool for representing other complex rheologies. In this advanced practice, you will use the multi-term SLS as a basis to approximate the response of a fractional Zener solid, a model known for its ability to capture power-law frequency dependence. This exercise introduces you to a formal optimization approach using non-negative least squares (NNLS) to fit the models, demonstrating how to make different physical descriptions of attenuation computationally interoperable .",
            "id": "3576801",
            "problem": "You are tasked with developing a complete, runnable program to approximate a fractional Zener viscoelastic solid with a multi-term Standard Linear Solid (SLS) over a specified angular-frequency band by minimizing a supremum-norm misfit in the complex modulus. The problem must be approached from first principles in linear viscoelasticity.\n\nA Standard Linear Solid (SLS) consisting of a single spring in parallel with a finite number of Maxwell elements has a complex modulus of the form\n$$\nE^{*}_{\\mathrm{SLS}}(\\omega) = E_{0} + \\sum_{j=1}^{N} \\Delta E_{j}\\frac{i\\omega\\tau_{j}}{1 + i\\omega\\tau_{j}},\n$$\nwhere $E_{0}$ is the relaxed (low-frequency) modulus, $\\Delta E_{j} \\ge 0$ are relaxation strengths, $\\tau_{j} > 0$ are relaxation times, $N$ is the number of Maxwell elements, $\\omega$ is the angular frequency in radians per second, and $i=\\sqrt{-1}$.\n\nA fractional Zener (FZ) solid of order $\\gamma \\in (0,1)$ has a complex modulus defined by\n$$\nE^{*}_{\\mathrm{frac}}(\\omega) = E_{0} + \\bigl(E_{\\infty} - E_{0}\\bigr)\\frac{(i\\omega\\tau)^{\\gamma}}{1 + (i\\omega\\tau)^{\\gamma}},\n$$\nwhere $E_{\\infty}$ is the unrelaxed (high-frequency) modulus and $\\tau>0$ is a characteristic time.\n\nYour goal is to fit a multi-term SLS to a given FZ target by minimizing the supremum norm of a relative complex-modulus misfit over a finite frequency band. Specifically, given a closed frequency band $\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]$, define the frequency-discretized supremum norm\n$$\n\\left\\|E^{*}_{\\mathrm{SLS}} - E^{*}_{\\mathrm{frac}}\\right\\|_{\\infty,\\,\\mathrm{rel}} \\equiv \\max_{\\omega \\in \\Omega}\\frac{\\left|E^{*}_{\\mathrm{SLS}}(\\omega) - E^{*}_{\\mathrm{frac}}(\\omega)\\right|}{\\left|E^{*}_{\\mathrm{frac}}(\\omega)\\right|},\n$$\nwhere $\\Omega$ is a dense logarithmically spaced grid spanning $[\\omega_{\\min}, \\omega_{\\max}]$, and $|\\cdot|$ denotes the complex modulus. You must determine, for each test case, the smallest integer $N$ for which there exist relaxation strengths $\\{\\Delta E_{j}\\}_{j=1}^{N}$ and relaxation times $\\{\\tau_{j}\\}_{j=1}^{N}$ (chosen as logarithmically spaced over a physically consistent range tied to $[\\omega_{\\min}, \\omega_{\\max}]$), such that\n$$\n\\left\\|E^{*}_{\\mathrm{SLS}} - E^{*}_{\\mathrm{frac}}\\right\\|_{\\infty,\\,\\mathrm{rel}} \\le \\epsilon,\n$$\nwith the additional passivity constraint $\\Delta E_{j} \\ge 0$ for all $j$. To ensure universal applicability, the design must start from the definitions above, rely on discretization of the frequency band, and use only numerical linear algebra to determine the relaxation strengths.\n\nFundamental base to be used for your derivation and implementation:\n- Linear viscoelasticity definitions of complex modulus for generalized Maxwell sums and for the fractional Zener solid.\n- The relation between relaxation spectra and frequency response via the complex modulus.\n- Discretization of continuous optimization problems to tractable linear-algebraic forms, preserving physical admissibility $\\Delta E_{j} \\ge 0$.\n\nScientific realism constraints:\n- Use $E_{0} = 1$ and $E_{\\infty} = 3$ (dimensionless, i.e., in consistent arbitrary units that cancel in the relative error).\n- Use $\\tau = 1$ second in the fractional Zener definition.\n- Use the angular-frequency band $[\\omega_{\\min}, \\omega_{\\max}] = [10^{-2}, 10^{2}]$ radians per second.\n- Use logarithmically spaced relaxation times $\\{\\tau_{j}\\}_{j=1}^{N}$ spanning $[1/\\omega_{\\max}, 1/\\omega_{\\min}]$ seconds for the SLS approximation.\n\nProgram requirements:\n- For each test case, search over $N \\in \\{1,2,\\dots,N_{\\max}\\}$ with $N_{\\max}$ chosen large enough to meet the most stringent $\\epsilon$ in the test suite if feasible. For each $N$, determine nonnegative $\\{\\Delta E_{j}\\}$ that minimize a frequency-sampled misfit derived from the definitions above, then evaluate the relative supremum error on a dense grid to check feasibility.\n- The program must return, for each test case, the smallest $N$ that satisfies the inequality above. If no $N \\le N_{\\max}$ satisfies it, return $-1$ for that test case.\n\nAngle and physical unit specifications:\n- Angular frequencies must be in radians per second.\n- The characteristic time constants must be in seconds.\n- The complex moduli are dimensionless here by construction; no unit conversion is required in the algorithm. All answers must be returned as integers without units.\n\nTest suite:\n- Case $1$: $\\gamma = 0.2$, $\\epsilon = 0.05$.\n- Case $2$: $\\gamma = 0.5$, $\\epsilon = 0.02$.\n- Case $3$: $\\gamma = 0.8$, $\\epsilon = 0.02$.\n- Case $4$: $\\gamma = 0.9$, $\\epsilon = 0.01$.\n- Case $5$: $\\gamma = 0.3$, $\\epsilon = 0.01$.\n- Case $6$: $\\gamma = 0.7$, $\\epsilon = 0.005$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of the minimal integers $N$ for the test cases, in the same order as listed above, enclosed in square brackets (for example, $[n_{1},n_{2},n_{3},n_{4},n_{5},n_{6}]$).",
            "solution": "The user-provided problem is deemed valid. It is scientifically grounded in linear viscoelasticity, is well-posed, objective, and contains all necessary information for a unique, verifiable solution.\n\nThe problem requires us to find the minimum number of Maxwell elements, $N$, in a Standard Linear Solid (SLS) model required to approximate a fractional Zener (FZ) model to a specified accuracy, $\\epsilon$. The approximation quality is measured by the supremum norm of the relative error in the complex modulus, $E^{*}(\\omega)$, over a given angular frequency band $[\\omega_{\\min}, \\omega_{\\max}]$.\n\nThe complex modulus of the target fractional Zener solid is given by:\n$$\nE^{*}_{\\mathrm{frac}}(\\omega) = E_{0} + \\bigl(E_{\\infty} - E_{0}\\bigr)\\frac{(i\\omega\\tau)^{\\gamma}}{1 + (i\\omega\\tau)^{\\gamma}}\n$$\nThe complex modulus of the approximating multi-term SLS is:\n$$\nE^{*}_{\\mathrm{SLS}}(\\omega) = E_{0} + \\sum_{j=1}^{N} \\Delta E_{j}\\frac{i\\omega\\tau_{j}}{1 + i\\omega\\tau_{j}}\n$$\nHere, $E_0$ is the relaxed modulus, which is common to both models and is given as $E_0=1$. The optimization concerns the frequency-dependent part of the moduli. Let us define the \"excess modulus\", $\\Delta E^{*}(\\omega) = E^{*}(\\omega) - E_0$. Our goal is to approximate the FZ excess modulus,\n$$\n\\Delta E^{*}_{\\mathrm{frac}}(\\omega) = \\bigl(E_{\\infty} - E_{0}\\bigr)\\frac{(i\\omega\\tau)^{\\gamma}}{1 + (i\\omega\\tau)^{\\gamma}}\n$$\nwith the SLS excess modulus,\n$$\n\\Delta E^{*}_{\\mathrm{SLS}}(\\omega) = \\sum_{j=1}^{N} \\Delta E_{j} A_j(\\omega), \\quad \\text{where} \\quad A_j(\\omega) = \\frac{i\\omega\\tau_{j}}{1 + i\\omega\\tau_{j}}\n$$\nThe parameters to be determined are the relaxation strengths, $\\{\\Delta E_j\\}_{j=1}^N$, subject to the physical passivity constraint $\\Delta E_j \\ge 0$. The relaxation times, $\\{\\tau_j\\}_{j=1}^N$, are not optimized but are fixed for a given $N$ as logarithmically spaced values over the interval $[1/\\omega_{\\max}, 1/\\omega_{\\min}]$. This choice of a fixed basis $\\{A_j(\\omega)\\}$ for a given $N$ transforms the problem into a linear one.\n\nThe objective is to find the smallest $N$ for which there exist $\\Delta E_j \\ge 0$ such that:\n$$\n\\max_{\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]}\\frac{\\left|E^{*}_{\\mathrm{SLS}}(\\omega) - E^{*}_{\\mathrm{frac}}(\\omega)\\right|}{\\left|E^{*}_{\\mathrm{frac}}(\\omega)\\right|} = \\max_{\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]}\\frac{\\left|\\Delta E^{*}_{\\mathrm{SLS}}(\\omega) - \\Delta E^{*}_{\\mathrm{frac}}(\\omega)\\right|}{\\left|E^{*}_{\\mathrm{frac}}(\\omega)\\right|} \\le \\epsilon\n$$\nDirectly minimizing the supremum ($L_{\\infty}$) norm is a complex task, often formulated as a linear program. A common and robust alternative is to minimize the $L_2$ norm (Euclidean norm) of the misfit, which corresponds to a least-squares problem. We will solve this simpler problem to find the optimal $\\{\\Delta E_j\\}$ and then verify if this solution satisfies the original $L_{\\infty}$-norm criterion.\n\nTo operationalize this, we discretize the continuous frequency band. We select a set of $M$ discrete angular frequencies, $\\{\\omega_k\\}_{k=1}^M$, logarithmically spaced within $[\\omega_{\\min}, \\omega_{\\max}]=[10^{-2}, 10^2]$ rad/s. The approximation problem becomes a system of linear equations:\n$$\n\\sum_{j=1}^{N} \\Delta E_{j} A_j(\\omega_k) \\approx \\Delta E^{*}_{\\mathrm{frac}}(\\omega_k) \\quad \\text{for} \\quad k = 1, \\dots, M\n$$\nThis can be written in matrix form as $\\mathbf{A}\\mathbf{x} \\approx \\mathbf{y}$, where:\n- $\\mathbf{x}$ is the $N \\times 1$ real vector of unknown relaxation strengths, $x_j = \\Delta E_j$.\n- $\\mathbf{y}$ is the $M \\times 1$ complex vector of the target excess modulus evaluated at each frequency, $y_k = \\Delta E^{*}_{\\mathrm{frac}}(\\omega_k)$.\n- $\\mathbf{A}$ is the $M \\times N$ complex matrix of basis functions, $A_{kj} = A_j(\\omega_k)$.\n\nWe seek to find the vector $\\mathbf{x}$ that minimizes the squared $L_2$ norm of the residual, $\\|\\mathbf{A}\\mathbf{x} - \\mathbf{y}\\|_2^2$, subject to the constraint $\\mathbf{x} \\ge \\mathbf{0}$ (i.e., $x_j \\ge 0$ for all $j$). This is a Non-Negative Least Squares (NNLS) problem.\n\nStandard NNLS solvers operate on real-valued matrices and vectors. We must therefore separate the complex system into its real and imaginary parts. Let $\\mathbf{A} = \\mathbf{A}_{\\mathrm{re}} + i\\mathbf{A}_{\\mathrm{im}}$ and $\\mathbf{y} = \\mathbf{y}_{\\mathrm{re}} + i\\mathbf{y}_{\\mathrm{im}}$. The minimization objective becomes:\n$$\n\\|\\mathbf{A}\\mathbf{x} - \\mathbf{y}\\|_2^2 = \\|(\\mathbf{A}_{\\mathrm{re}}\\mathbf{x} - \\mathbf{y}_{\\mathrm{re}}) + i(\\mathbf{A}_{\\mathrm{im}}\\mathbf{x} - \\mathbf{y}_{\\mathrm{im}})\\|_2^2 = \\|\\mathbf{A}_{\\mathrm{re}}\\mathbf{x} - \\mathbf{y}_{\\mathrm{re}}\\|_2^2 + \\|\\mathbf{A}_{\\mathrm{im}}\\mathbf{x} - \\mathbf{y}_{\\mathrm{im}}\\|_2^2\n$$\nThis is equivalent to solving a single real-valued least-squares problem for a stacked system:\n$$\n\\min_{\\mathbf{x} \\ge \\mathbf{0}} \\|\\tilde{\\mathbf{A}}\\mathbf{x} - \\tilde{\\mathbf{y}}\\|_2^2, \\quad \\text{where} \\quad \\tilde{\\mathbf{A}} = \\begin{pmatrix} \\mathbf{A}_{\\mathrm{re}} \\\\ \\mathbf{A}_{\\mathrm{im}} \\end{pmatrix}, \\quad \\tilde{\\mathbf{y}} = \\begin{pmatrix} \\mathbf{y}_{\\mathrm{re}} \\\\ \\mathbf{y}_{\\mathrm{im}} \\end{pmatrix}\n$$\nThe matrix $\\tilde{\\mathbf{A}}$ is of size $2M \\times N$ and the vector $\\tilde{\\mathbf{y}}$ is of size $2M \\times 1$. This NNLS problem can be efficiently solved using standard numerical libraries, such as `scipy.optimize.nnls`.\n\nThe overall algorithm proceeds as follows for each test case $(\\gamma, \\epsilon)$:\n1.  Initiate a search for the number of Maxwell elements, $N$, starting from $N=1$ up to a maximum value, $N_{\\max}$.\n2.  For a given $N$:\n    a. Define the set of $N$ relaxation times $\\{\\tau_j\\}$ by logarithmically spacing them in the range $[1/\\omega_{\\max}, 1/\\omega_{\\min}] = [10^{-2}, 10^2]$ s.\n    b. Define a \"fitting grid\" of $M_f$ frequencies $\\{\\omega_k\\}$ logarithmically spaced in $[\\omega_{\\min}, \\omega_{\\max}]=[10^{-2}, 10^2]$ rad/s.\n    c. Construct the real $2M_f \\times N$ matrix $\\tilde{\\mathbf{A}}$ and the real $2M_f \\times 1$ vector $\\tilde{\\mathbf{y}}$ as described above.\n    d. Solve the NNLS problem to find the non-negative relaxation strengths $\\{\\Delta E_j\\}_{j=1}^N$.\n3.  Once $\\{\\Delta E_j\\}$ are found, validate the solution against the original supremum-norm criterion. To approximate the supremum norm accurately, a \"validation grid\" denser than the fitting grid is used, containing $M_v > M_f$ points, $\\{\\omega_l\\}$, over the same frequency band.\n4.  Calculate the maximum relative error:\n    $$\n    e_{\\max} = \\max_l \\frac{|E^{*}_{\\mathrm{SLS}}(\\omega_l) - E^{*}_{\\mathrm{frac}}(\\omega_l)|}{|E^{*}_{\\mathrm{frac}}(\\omega_l)|}\n    $$\n5.  If $e_{\\max} \\le \\epsilon$, then $N$ is a valid solution. Since the search for $N$ is incremental, the first such $N$ found is the minimum required number. Record this $N$ and proceed to the next test case.\n6.  If the loop completes up to $N=N_{\\max}$ without satisfying the criterion, no solution is found within the search limit, and we return $-1$.\n\nFor this implementation, we use $E_0=1$, $E_\\infty=3$, $\\tau=1$ s, $[\\omega_{\\min}, \\omega_{\\max}]=[10^{-2}, 10^2]$ rad/s, $M_f=200$ fitting points, $M_v=1000$ validation points, and $N_{\\max}=100$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Finds the minimum number of Maxwell elements (N) for a Standard Linear Solid (SLS)\n    to approximate a fractional Zener (FZ) solid model within a given relative error\n    tolerance over a specified frequency band.\n    \"\"\"\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (gamma, epsilon)\n        (0.2, 0.05), (0.5, 0.02), (0.8, 0.02),\n        (0.9, 0.01), (0.3, 0.01), (0.7, 0.005)\n    ]\n    \n    # Global parameters defined in the problem\n    E0 = 1.0\n    E_inf = 3.0\n    tau_fz = 1.0\n    omega_min = 1e-2\n    omega_max = 1e2\n    \n    # Numerical parameters for the algorithm\n    n_fit_pts = 200      # Number of frequency points for fitting\n    n_val_pts = 1000     # Number of frequency points for error validation\n    N_max = 100          # Maximum number of Maxwell elements to test\n\n    # Pre-calculate frequency grids to avoid recomputation\n    fit_omegas = np.logspace(np.log10(omega_min), np.log10(omega_max), n_fit_pts)\n    val_omegas = np.logspace(np.log10(omega_min), np.log10(omega_max), n_val_pts)\n\n    results = []\n    \n    for gamma, epsilon in test_cases:\n        \n        # --- Pre-calculate a-priori known target responses for the FZ model ---\n\n        # 1. Target for fitting (excess modulus on fitting grid)\n        #    delta_E*_frac(w) = (E_inf - E0) * ( (i*w*tau)**gamma / (1 + (i*w*tau)**gamma) )\n        iw_tau_gamma_fit = (1j * fit_omegas * tau_fz)**gamma\n        y_fit_target = (E_inf - E0) * iw_tau_gamma_fit / (1 + iw_tau_gamma_fit)\n        \n        # 2. Target for validation (full modulus on validation grid)\n        #    E*_frac(w) = E0 + delta_E*_frac(w)\n        iw_tau_gamma_val = (1j * val_omegas * tau_fz)**gamma\n        E_frac_val = E0 + (E_inf - E0) * iw_tau_gamma_val / (1 + iw_tau_gamma_val)\n        \n        found_N = -1\n        \n        # --- Iteratively search for the minimum N ---\n        for N in range(1, N_max + 1):\n            # Define relaxation times for the SLS model, log-spaced over the inverse frequency band\n            tau_sls = np.logspace(np.log10(1/omega_max), np.log10(1/omega_min), N)\n\n            # --- Set up and solve the Non-Negative Least Squares (NNLS) problem ---\n            \n            # The SLS model for the excess modulus is a linear combination of basis functions:\n            # sum_{j=1 to N} Delta_E_j * [ (i*w*tau_j) / (1 + i*w*tau_j) ]\n            # Create the kernel matrix 'A' for this linear system.\n            iw_fit = 1j * fit_omegas.reshape(-1, 1) # Shape (n_fit_pts, 1)\n            term = iw_fit * tau_sls.reshape(1, -1)   # Shape (n_fit_pts, N) via broadcasting\n            A_complex = term / (1 + term)\n\n            # NNLS solvers require real-valued inputs. We stack the real and imaginary parts.\n            # The system A*x = y becomes [A_re; A_im] * x = [y_re; y_im]\n            A_real_stacked = np.vstack([A_complex.real, A_complex.imag])\n            y_real_stacked = np.hstack([y_fit_target.real, y_fit_target.imag])\n            \n            # Solve for relaxation strengths (delta_E), which must be non-negative.\n            delta_E, _ = nnls(A_real_stacked, y_real_stacked)\n\n            # --- Evaluate the error on the dense validation grid ---\n            \n            # Calculate the SLS modulus with the determined strengths\n            iw_val = 1j * val_omegas.reshape(-1, 1)\n            sls_kernel_val = (iw_val * tau_sls.reshape(1, -1)) / (1 + iw_val * tau_sls.reshape(1, -1))\n            E_sls_val = E0 + sls_kernel_val @ delta_E\n\n            # Calculate a-posteriori relative error\n            # rel_error = |E_sls - E_frac| / |E_frac|\n            rel_error = np.abs(E_sls_val - E_frac_val) / np.abs(E_frac_val)\n            max_rel_error = np.max(rel_error)\n\n            if max_rel_error = epsilon:\n                found_N = N\n                break # Found the smallest N, so we can exit the search loop\n        \n        results.append(found_N)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}