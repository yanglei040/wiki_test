{
    "hands_on_practices": [
        {
            "introduction": "Before we can model or interpret receiver functions, we must first correctly orient our observations with respect to the incoming seismic wave. This initial exercise establishes the fundamental geometric relationship between the horizontal slowness, or ray parameter $p$, of a teleseismic arrival and its incidence angle $\\theta$ at the surface. By mastering the coordinate transformation from the instrument's geographic frame $(Z,N,E)$ to a ray-centered frame $(L,Q,T)$, you will develop the essential skill of isolating the incident P-wavefield from the shear-wave conversions that are the primary target of receiver function analysis .",
            "id": "3613348",
            "problem": "A teleseismic compressional-wave (P-wave) arrival is recorded at a three-component broadband station as part of a Receiver Function (RF) study. Assume the near-surface Earth beneath the station can be modeled locally as an isotropic homogeneous half-space with P-wave speed $\\alpha_{0}$. A plane wave with back-azimuth $\\phi$ (measured clockwise from geographic North toward the source) and ray parameter $p$ (horizontal slowness at the surface) impinges on the station. Adopt a right-handed station coordinate system with components $Z$ (positive upward), $N$ (positive geographic North), and $E$ (positive geographic East). Define the incidence angle $\\theta$ as the angle between the propagation direction and the local vertical.\n\nTasks:\n1) Starting from the kinematics of plane waves in an isotropic medium, the definition of slowness, and Snell’s law, derive a relation that connects the incidence angle $\\theta$ at the free surface to the surface P-wave speed $\\alpha_{0}$ and the ray parameter $p$. Do not invoke any specialized receiver-function formula; instead, begin from the definitions of phase slowness and its horizontal projection.\n\n2) Using your derived relation, compute the numerical value of $\\theta$ for the following parameters: $\\phi = 123.4^{\\circ}$, $p = 0.0862068966 \\,\\text{s/km}$, and $\\alpha_{0} = 5.8 \\,\\text{km/s}$. Express the angle in degrees. Round your answer to four significant figures.\n\n3) Using geometric projection of particle motion, write the orthonormal rotation that maps the data vector $[Z,N,E]^{\\mathsf{T}}$ into $[L,Q,T]^{\\mathsf{T}}$, where $L$ is the longitudinal (P) component aligned with the propagation direction, $Q$ is the radial shear component in the $Z$–$R$ plane, and $T$ is the transverse shear component orthogonal to that plane. Express your rotation as the composition of a horizontal rotation by $\\phi$ and a dip rotation by $\\theta$, and provide the resulting $3\\times 3$ matrix in terms of $\\phi$ and $\\theta$ only. Do not substitute numbers in this step.\n\nOnly the result from Task 2 will be graded for numerical correctness. The final answer must be a single number (the value of $\\theta$ in degrees) rounded to four significant figures, as specified.",
            "solution": "We begin from plane-wave kinematics in an isotropic homogeneous medium. A plane wave may be written in terms of its phase as $\\Phi(\\mathbf{x},t) = \\mathbf{k}\\cdot\\mathbf{x} - \\omega t$, with angular frequency $\\omega$ and wave vector $\\mathbf{k}$ satisfying the dispersion relation $|\\mathbf{k}| = \\omega/\\alpha_{0}$ for a compressional wave speed $\\alpha_{0}$. The phase slowness vector $\\mathbf{s}$ is defined by $\\mathbf{s} = \\nabla_{\\mathbf{k}}(\\Phi/\\omega)$ for constant phase, which in an isotropic medium reduces to the vector $\\mathbf{s}$ of magnitude $|\\mathbf{s}| = 1/\\alpha_{0}$ pointing along the propagation direction. The horizontal projection of the slowness vector, $\\mathbf{s}_{h}$, has magnitude equal to the horizontal slowness (ray parameter) $p$, that is,\n$$\np \\equiv |\\mathbf{s}_{h}| = |\\mathbf{s}|\\sin\\theta = \\frac{1}{\\alpha_{0}}\\sin\\theta,\n$$\nwhere $\\theta$ is the incidence angle measured from the vertical. This follows from the right-triangle formed by the slowness vector and its horizontal and vertical components: the horizontal component is $|\\mathbf{s}|\\sin\\theta$, and the vertical component is $|\\mathbf{s}|\\cos\\theta$.\n\nRearranging the above relation yields the desired expression connecting $\\theta$, $p$, and $\\alpha_{0}$:\n$$\n\\sin\\theta = \\alpha_{0} p,\\qquad \\theta = \\arcsin\\!\\big(\\alpha_{0} p\\big).\n$$\n\nNext, we evaluate $\\theta$ numerically for the given parameters. We have $\\alpha_{0} = 5.8 \\,\\text{km/s}$ and $p = 0.0862068966 \\,\\text{s/km}$. Their product is\n$$\n\\alpha_{0} p = \\big(5.8 \\,\\text{km/s}\\big)\\big(0.0862068966 \\,\\text{s/km}\\big) = 0.5,\n$$\nso\n$$\n\\theta = \\arcsin(0.5) = \\frac{\\pi}{6}\\ \\text{radians} = 30\\ \\text{degrees}.\n$$\nRounding to four significant figures and expressing in degrees gives $30.00$.\n\nFinally, we construct the rotation mapping $[Z,N,E]^{\\mathsf{T}}$ to $[L,Q,T]^{\\mathsf{T}}$. First, rotate the horizontal components into radial–transverse coordinates $[R,T]^{\\mathsf{T}}$ using the back-azimuth $\\phi$ (measured clockwise from North toward the source). With $Z$ positive upward, $R$ pointing horizontally toward the source, and $T$ completing a right-handed system, the horizontal rotation is\n$$\n\\begin{pmatrix} R \\\\ T \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\cos\\phi & \\sin\\phi \\\\\n-\\sin\\phi & \\cos\\phi\n\\end{pmatrix}\n\\begin{pmatrix} N \\\\ E \\end{pmatrix}.\n$$\nNext, rotate in the $Z$–$R$ plane by the incidence angle $\\theta$ to obtain the longitudinal (P) component $L$ aligned with the propagation direction and the radial shear component $Q$ orthogonal to $L$ in that plane:\n$$\n\\begin{pmatrix}\nL \\\\ Q \\\\ T\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\cos\\theta & \\sin\\theta & 0 \\\\\n-\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nZ \\\\ R \\\\ T\n\\end{pmatrix}.\n$$\nComposing these two rotations yields the single $3\\times 3$ matrix $\\mathbf{M}$ that maps $[Z,N,E]^{\\mathsf{T}}$ to $[L,Q,T]^{\\mathsf{T}}$:\n$$\n\\begin{pmatrix}\nL \\\\ Q \\\\ T\n\\end{pmatrix}\n=\n\\underbrace{\n\\begin{pmatrix}\n\\cos\\theta & \\sin\\theta\\cos\\phi & \\sin\\theta\\sin\\phi \\\\\n-\\sin\\theta & \\cos\\theta\\cos\\phi & \\cos\\theta\\sin\\phi \\\\\n0 & -\\sin\\phi & \\cos\\phi\n\\end{pmatrix}\n}_{\\mathbf{M}(\\phi,\\theta)}\n\\begin{pmatrix}\nZ \\\\ N \\\\ E\n\\end{pmatrix}.\n$$\nThis $\\mathbf{M}(\\phi,\\theta)$ is orthonormal for all $\\phi$ and $\\theta$ under the stated sign conventions and coordinate definitions.\n\nOnly the numerical value of $\\theta$ is required as the final answer. From the computation above, the incidence angle is $30.00$ degrees to four significant figures.",
            "answer": "$$\\boxed{30.00}$$"
        },
        {
            "introduction": "With the geometric framework in place, we now turn to the heart of the matter: forward modeling the receiver function itself for a given Earth structure. This practice challenges you to implement a complete 1D forward model, from calculating wave transmission at layer boundaries using the Zoeppritz equations to propagating the wavefield and performing the final spectral deconvolution . Completing this exercise will provide you with a robust computational tool and a first-principles understanding of how layered elastic structures generate the converted phases that receiver functions are designed to detect.",
            "id": "3613361",
            "problem": "You are tasked with building a complete, runnable program that forward-models Receiver Functions for a one-dimensional, isotropic, three-layer Earth model using plane-wave P–SV (compressional–shear vertical) theory, propagators, and spectral deconvolution. The goal is to compute the free-surface vertical and radial Green’s functions in the frequency domain across a specified target frequency band, and generate a time-domain Receiver Function through stabilized spectral deconvolution. The program must be self-contained and produce a single-line output aggregating the specified test-case metrics.\n\nFundamental base and modeling assumptions: work in a one-dimensional layered elastic medium with isotropic layers and plane-wave propagation at a fixed horizontal slowness $p$. Start from the elastodynamic potential formulation for P–SV waves and the plane-wave dispersion and polarization relations. Let $x$ denote the horizontal (radial) direction and $z$ the vertical direction (positive downward). For a given layer with compressional-wave speed $v_p$, shear-wave speed $v_s$, density $\\rho$, horizontal slowness $p$ (in s/m), and angular frequency $\\omega$ (in rad/s), define the vertical slownesses\n$$\nq_P = \\sqrt{\\frac{1}{v_p^2} - p^2}, \\quad q_S = \\sqrt{\\frac{1}{v_s^2} - p^2},\n$$\nand the wavenumbers $k_x = \\omega p$, $k_{zP} = \\omega q_P$, and $k_{zS} = \\omega q_S$. The Lamé parameters are $\\mu = \\rho v_s^2$ and $\\lambda = \\rho v_p^2 - 2\\mu$. Use time-harmonic convention $\\exp(i(k_x x + k_z z - \\omega t))$. The P-wave displacement is given by the gradient of the scalar potential $\\phi$, and the SV-wave displacement is given by the curl of the scalar potential $\\psi$ in two dimensions. At a plane $z=\\text{constant}$, the polarization relations for unit-amplitude plane waves are\n$$\n\\begin{aligned}\n&\\text{P up (Pu):} && u_x = i k_x \\phi,\\quad u_z = - i k_{zP} \\phi,\\quad \\sigma_{xz} = + 2 \\mu k_x k_{zP}\\phi,\\quad \\sigma_{zz} = -\\left[\\lambda(k_x^2 + k_{zP}^2) + 2\\mu k_{zP}^2\\right]\\phi,\\\\\n&\\text{P down (Pd):} && u_x = i k_x \\phi,\\quad u_z = + i k_{zP} \\phi,\\quad \\sigma_{xz} = - 2 \\mu k_x k_{zP}\\phi,\\quad \\sigma_{zz} = -\\left[\\lambda(k_x^2 + k_{zP}^2) + 2\\mu k_{zP}^2\\right]\\phi,\\\\\n&\\text{SV up (Su):} && u_x = + i k_{zS} \\psi,\\quad u_z = + i k_x \\psi,\\quad \\sigma_{xz} = \\mu (k_{zS}^2 - k_x^2)\\psi,\\quad \\sigma_{zz} = + 2 \\mu k_x k_{zS}\\psi,\\\\\n&\\text{SV down (Sd):} && u_x = - i k_{zS} \\psi,\\quad u_z = + i k_x \\psi,\\quad \\sigma_{xz} = \\mu (k_{zS}^2 - k_x^2)\\psi,\\quad \\sigma_{zz} = - 2 \\mu k_x k_{zS}\\psi.\n\\end{aligned}\n$$\nAt a material interface, continuity of displacement and traction yields a $4\\times 4$ linear system (Zoeppritz system) for the reflected and transmitted amplitudes. For an upgoing incident P-wave from the lower medium (medium 2) into the upper medium (medium 1), define unknowns $A_{rp}$ (reflected downgoing P in medium 2), $B_{rs}$ (reflected downgoing SV in medium 2), $A_{tp}$ (transmitted upgoing P in medium 1), and $B_{ts}$ (transmitted upgoing SV in medium 1). Introducing the shorthand $p$, $q_{Pj}$, $q_{Sj}$, $\\mu_j$, $\\lambda_j$, and $Z_{Pj} = \\lambda_j(p^2 + q_{Pj}^2) + 2\\mu_j q_{Pj}^2$ for medium $j$, the continuity equations can be assembled into\n$$\n\\mathbf{A}\n\\begin{bmatrix}\nA_{rp}\\\\ B_{rs}\\\\ A_{tp}\\\\ B_{ts}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\np\\\\ -q_{P2}\\\\ 2\\mu_2 p q_{P2}\\\\ -Z_{P2}\n\\end{bmatrix},\n$$\nwith the coefficient matrix\n$$\n\\mathbf{A} = \\begin{bmatrix}\n- p & + q_{S2} & + p & + q_{S1}\\\\\n- q_{P2} & - p & - q_{P1} & + p\\\\\n+ 2 \\mu_2 p q_{P2} & - \\mu_2(q_{S2}^2 - p^2) & + 2 \\mu_1 p q_{P1} & + \\mu_1(q_{S1}^2 - p^2)\\\\\n+ Z_{P2} & + 2 \\mu_2 p q_{S2} & - Z_{P1} & + 2 \\mu_1 p q_{S1}\n\\end{bmatrix}.\n$$\nSolving this system yields the transmission coefficients $T_{PP} \\equiv A_{tp}$ and $T_{PS} \\equiv B_{ts}$ for P incidence. For an upgoing incident SV-wave from the lower medium, one solves the same linear system with modified right-hand side corresponding to Su incidence,\n$$\n\\mathbf{A}\n\\begin{bmatrix}\nA_{rp}\\\\ B_{rs}\\\\ A_{tp}\\\\ B_{ts}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nq_{S2}\\\\ p\\\\ \\mu_2(q_{S2}^2 - p^2)\\\\ 2\\mu_2 p q_{S2}\n\\end{bmatrix},\n$$\nobtaining $T_{SS} \\equiv B_{ts}$ (and $T_{SP} \\equiv A_{tp}$, not used here).\n\nFirst-order single-scattering forward model using propagators: treat only first-order P-to-S conversions at each interface (Born approximation), neglect internal multiples. Let there be three layers (1, 2, 3) over a half-space (4). The upward propagator for transmission is the product of transmission coefficients. For P reaching interface $j$ (counted from top: $j=1$ is between layers 1 and 2, $j=2$ between 2 and 3, $j=3$ between 3 and 4), the P amplitude is the product of $T_{PP}$ coefficients across deeper interfaces: specifically,\n$$\nA^{(P)}_{\\text{to } j} = \\prod_{k=j+1}^{3} T_{PP}(k\\leftrightarrow k+1),\n$$\nwith the convention that an empty product equals $1$. At interface $j$, the P-to-S converted amplitude is $B_{ts}^{(j)} = T_{PS}(j\\leftrightarrow j+1)$. The upward S propagates to the surface through the upper interfaces with transmitted amplitude\n$$\nA^{(S)}_{\\text{to surface from } j} = \\prod_{k=1}^{j-1} T_{SS}(k\\leftrightarrow k+1).\n$$\nTherefore, the SV potential amplitude arriving at the surface from interface $j$ is\n$$\n\\Psi_j = A^{(P)}_{\\text{to } j} \\, B_{ts}^{(j)} \\, A^{(S)}_{\\text{to surface from } j}.\n$$\nThe direct P-wave vertical potential amplitude at the surface is\n$$\n\\Phi_{\\text{surf}} = \\prod_{k=1}^{3} T_{PP}(k\\leftrightarrow k+1).\n$$\nThe frequency-domain free-surface displacements (Green’s functions) are modeled as a superposition of these contributions with phase propagation via exponential propagators. Denote the top-layer parameters $(v_{p1}, v_{s1}, \\rho_1)$, their vertical slownesses $(q_{P1}, q_{S1})$, and the propagator phases. The vertical and radial components in the frequency domain are\n$$\n\\begin{aligned}\nZ(\\omega) &= - i \\omega q_{P1}\\, \\Phi_{\\text{surf}} + \\sum_{j=1}^3 \\left[ i \\omega p \\, \\Psi_j \\, e^{- i \\omega\\, t_{PS}^{(j)}} \\right],\\\\\nR(\\omega) &= + i \\omega p\\, \\Phi_{\\text{surf}} + \\sum_{j=1}^3 \\left[ i \\omega q_{S1} \\, \\Psi_j \\, e^{- i \\omega\\, t_{PS}^{(j)}} \\right],\n\\end{aligned}\n$$\nwhere the relative arrival times of P-to-S conversions (Receiver Function delays) for interface $j$ are computed by vertical slowness integrals\n$$\nt_{PS}^{(j)} = \\sum_{m=1}^{j} h_m \\left( q_{Sm} - q_{Pm} \\right),\n$$\nwith $h_m$ the thickness of layer $m$ in meters. Note that the direct P reference time is absorbed as a baseline $t=0$.\n\nSpectral deconvolution to obtain the Receiver Function: use stabilized spectral division with a water-level parameter $\\epsilon$ and a band-limiting window $W(\\omega)$ covering the target frequency band,\n$$\n\\text{RF}(\\omega) = \\frac{R(\\omega)\\, Z^*(\\omega)}{|Z(\\omega)|^2 + \\epsilon}\\, W(\\omega),\n$$\nand obtain the time-domain Receiver Function via the inverse Fast Fourier Transform of $\\text{RF}(\\omega)$. Choose $W(\\omega)$ as an ideal band-pass mask restricted to $[f_\\min, f_\\max]$ Hertz. The water-level $\\epsilon$ must be chosen as a small fraction of the maximum of $|Z(\\omega)|^2$ over the band to stabilize division.\n\nNumerical units and implementation requirements: use International System of Units (SI) consistently.\n- Lengths $h_m$ in meters (m).\n- Velocities $v_p, v_s$ in meters per second (m/s).\n- Densities $\\rho$ in kilograms per cubic meter (kg/m$^3$).\n- Slowness $p$ in seconds per meter (s/m).\n- Frequency $f$ in Hertz (Hz), angular frequency $\\omega = 2\\pi f$ in radians per second.\n- Time $t$ in seconds (s).\n- The output Receiver Function time series must be sampled at a specified rate and duration with zero padding as needed for efficient Fast Fourier Transform.\n\nTest suite and output specification:\nYou must implement the above forward model and deconvolution, and compute the Receiver Function time series for the following three test cases. For each case, extract the Receiver Function amplitude samples at the three predicted arrival times $t_{PS}^{(j)}$ for $j=1,2,3$ (use nearest-neighbor in the sampled time series). The program must aggregate these nine amplitudes into a single list.\n\nCommon numerical settings for all test cases:\n- Sampling interval $\\Delta t = 0.025$ s; total duration $T = 102.4$ s; use a Fast Fourier Transform length consistent with this duration.\n- Frequency band window $f_\\min = 0.05$ Hz, $f_\\max = 1.0$ Hz.\n- Water-level fraction $\\eta = 0.01$, i.e., $\\epsilon = \\eta \\max_{\\omega} |Z(\\omega)|^2$ within the band.\n\nDefine the three test cases, each specifying $(h_1,h_2,h_3)$, $(v_{p1},v_{s1},\\rho_1)$, $(v_{p2},v_{s2},\\rho_2)$, $(v_{p3},v_{s3},\\rho_3)$, $(v_{p4},v_{s4},\\rho_4)$ for the half-space, and $p$:\n1. Case A (general happy path):\n   - $h_1 = 20000$ m, $h_2 = 15000$ m, $h_3 = 25000$ m.\n   - Layer 1: $v_{p1} = 6000$ m/s, $v_{s1} = 3464$ m/s, $\\rho_1 = 2700$ kg/m$^3$.\n   - Layer 2: $v_{p2} = 6500$ m/s, $v_{s2} = 3750$ m/s, $\\rho_2 = 2800$ kg/m$^3$.\n   - Layer 3: $v_{p3} = 8000$ m/s, $v_{s3} = 4600$ m/s, $\\rho_3 = 3200$ kg/m$^3$.\n   - Half-space (4): $v_{p4} = 8200$ m/s, $v_{s4} = 4700$ m/s, $\\rho_4 = 3300$ kg/m$^3$.\n   - $p = 6.0 \\times 10^{-5}$ s/m.\n2. Case B (weak contrasts boundary case):\n   - $h_1 = 20000$ m, $h_2 = 15000$ m, $h_3 = 25000$ m.\n   - Layer 1: $v_{p1} = 6000$ m/s, $v_{s1} = 3464$ m/s, $\\rho_1 = 2700$ kg/m$^3$.\n   - Layer 2: $v_{p2} = 6000$ m/s, $v_{s2} = 3464$ m/s, $\\rho_2 = 2700$ kg/m$^3$.\n   - Layer 3: $v_{p3} = 6000$ m/s, $v_{s3} = 3464$ m/s, $\\rho_3 = 2700$ kg/m$^3$.\n   - Half-space (4): $v_{p4} = 6000$ m/s, $v_{s4} = 3464$ m/s, $\\rho_4 = 2700$ kg/m$^3$.\n   - $p = 6.0 \\times 10^{-5}$ s/m.\n3. Case C (near-critical slowness edge case):\n   - Same layers as Case A.\n   - $p = 1.2 \\times 10^{-4}$ s/m.\n\nYour program should produce a single line of output containing the nine Receiver Function amplitudes at the predicted arrival times for the three cases, ordered case-by-case and interface-by-interface as $[A^{(A)}_1,A^{(A)}_2,A^{(A)}_3,A^{(B)}_1,A^{(B)}_2,A^{(B)}_3,A^{(C)}_1,A^{(C)}_2,A^{(C)}_3]$, where $A^{(X)}_j$ denotes the Receiver Function amplitude (a float) at $t_{PS}^{(j)}$ for case $X$ and interface index $j$. The output must be a comma-separated Python list enclosed in square brackets (e.g., \"[0.123,-0.045,0.001,...]\"). Angles are not used; all quantities are expressed in SI units. The program must be executable as is with no external input or files and must rely only on the specified runtime environment. Ensure scientific realism and numerical self-consistency throughout.",
            "solution": "The user has provided a detailed problem statement for forward-modeling seismic receiver functions. The task is to implement a specific algorithm based on plane-wave P-SV theory in a 1D layered medium, solve for three distinct test cases, and output specific numerical results.\n\n### Step 1: Problem Validation\n\nFirst, we must meticulously validate the problem statement against the criteria of scientific soundness, well-posedness, and objectivity.\n\n#### Givens Extraction\n\nThe problem provides the following data and definitions:\n- **Model**: A 1D Earth model with three isotropic elastic layers over an isotropic elastic half-space.\n- **Physics**: Plane-wave P–SV propagation at a fixed horizontal slowness $p$, using a first-order single-scattering (Born) approximation, neglecting internal multiples.\n- **Core Equations**:\n    - Vertical slownesses: $q_P = \\sqrt{1/v_p^2 - p^2}$ and $q_S = \\sqrt{1/v_s^2 - p^2}$.\n    - Lamé parameters: $\\mu = \\rho v_s^2$ and $\\lambda = \\rho v_p^2 - 2\\mu$.\n    - A $4 \\times 4$ linear system (Zoeppritz equations) to find transmission coefficients ($T_{PP}$, $T_{PS}$, $T_{SS}$) at an interface for upgoing P and SV waves. The matrix $\\mathbf{A}$ and the right-hand side vectors for both P and SV incidence are explicitly defined.\n- **Forward Model Equations**:\n    - P-wave amplitude to interface $j$: $A^{(P)}_{\\text{to } j} = \\prod_{k=j+1}^{3} T_{PP}(k\\leftrightarrow k+1)$.\n    - S-wave amplitude to surface from $j$: $A^{(S)}_{\\text{to surface from } j} = \\prod_{k=1}^{j-1} T_{SS}(k\\leftrightarrow k+1)$.\n    - SV potential from conversion at $j$: $\\Psi_j = A^{(P)}_{\\text{to } j} \\, T_{PS}(j\\leftrightarrow j+1) \\, A^{(S)}_{\\text{to surface from } j}$.\n    - Direct P potential: $\\Phi_{\\text{surf}} = \\prod_{k=1}^{3} T_{PP}(k\\leftrightarrow k+1)$.\n- **Frequency Domain Displacements**: Explicit formulas for vertical ($Z(\\omega)$) and radial ($R(\\omega)$) components at the free surface are given:\n    $$Z(\\omega) = - i \\omega q_{P1}\\, \\Phi_{\\text{surf}} + \\sum_{j=1}^3 \\left[ i \\omega p \\, \\Psi_j \\, e^{- i \\omega\\, t_{PS}^{(j)}} \\right]$$\n    $$R(\\omega) = + i \\omega p\\, \\Phi_{\\text{surf}} + \\sum_{j=1}^3 \\left[ i \\omega q_{S1} \\, \\Psi_j \\, e^{- i \\omega\\, t_{PS}^{(j)}} \\right]$$\n- **Time Delay**: The P-to-S conversion delay time is $t_{PS}^{(j)} = \\sum_{m=1}^{j} h_m ( q_{Sm} - q_{Pm} )$.\n- **Deconvolution**: A stabilized spectral division is defined to compute the receiver function: $\\text{RF}(\\omega) = \\frac{R(\\omega)\\, Z^*(\\omega)}{|Z(\\omega)|^2 + \\epsilon}\\, W(\\omega)$, followed by an inverse Fourier transform.\n- **Numerical Parameters**: Common settings for all tests are specified: $\\Delta t = 0.025$ s, $T = 102.4$ s, $f_\\min = 0.05$ Hz, $f_\\max = 1.0$ Hz, and water-level fraction $\\eta = 0.01$.\n- **Test Cases**: Three distinct cases are defined with specific layer thicknesses ($h_m$), P-wave speeds ($v_p$), S-wave speeds ($v_s$), densities ($\\rho$), and horizontal slowness ($p$).\n\n#### Validation Assessment\n\n1.  **Scientific Grounding**: The problem is firmly rooted in the fundamental principles of elastodynamics and seismology. The use of potentials, plane-wave decomposition, Zoeppritz equations, propagator formalism, and spectral deconvolution constitutes the standard framework for this type of modeling (e.g., as detailed in Aki & Richards, \"Quantitative Seismology\"). The physical parameters given in the test cases are realistic for Earth's crust and upper mantle. The equations for wave polarization and the Zoeppritz system have been verified against standard formulations and are correct for the specified convention ($z$ positive downwards, time-harmonic factor $e^{-i\\omega t}$).\n\n2.  **Well-Posedness**: The problem is well-posed. It describes a deterministic forward modeling algorithm where a unique output is expected for a given set of inputs. All required parameters are specified. The inclusion of a water-level parameter ($\\epsilon$) in the deconvolution formula explicitly addresses the potential instability of spectral division, ensuring the numerical procedure is stable.\n\n3.  **Objectivity**: The problem is stated in precise, objective, and mathematical language. There are no subjective or ambiguous terms. The required calculations and output format are specified without ambiguity.\n\n4.  **Completeness and Consistency**: The problem statement is self-contained. While the formulas for $Z(\\omega)$ and $R(\\omega)$ represent a known simplification (they model the incident wavefield displacements just below the surface, omitting the free-surface transfer functions), they are explicitly given as part of the algorithm to be implemented. The task is to execute this specific recipe, not to derive the most complete physical model. Therefore, this simplification is a feature of the specified task, not a flaw. The problem is internally consistent.\n\n5.  **Plausibility**: The test cases are physically plausible. Case A is a standard model. Case B (no impedance contrast) provides a crucial sanity check, as it should yield zero-amplitude converted phases. Case C uses a high horizontal slowness that approaches, but does not exceed, the critical slownesses of the deeper layers, correctly setting up a test for near-critical angle behavior without introducing the complication of evanescent waves (imaginary vertical slownesses), which simplifies the implementation while still testing the robustness of the code.\n\n#### Verdict\n\nThe problem is **valid**. It is a well-defined, scientifically sound, and numerically complete specification for a computational geophysics task. We may proceed to the solution.\n\n### Step 2: Algorithmic Design and Solution\n\nThe solution will be implemented in Python using the NumPy library, following the defined algorithm. The implementation is structured into three main parts: a function to solve the Zoeppritz equations, a main function to compute the receiver function for a given case, and a top-level `solve` function to manage the test cases and final output.\n\n1.  **Zoeppritz Coefficient Calculation**: A function, `calculate_zoeppritz`, will be created to compute the transmission coefficients ($T_{PP}$, $T_{PS}$, $T_{SS}$) for a single interface.\n    -   **Inputs**: Properties of the upper (medium 1) and lower (medium 2) layers ($v_p, v_s, \\rho$) and the horizontal slowness $p$. The incident wave is from medium 2.\n    -   **Process**:\n        -   Calculate the vertical slowness for P and S waves in each medium: $q_P = \\sqrt{1/v_p^2 - p^2}$, $q_S = \\sqrt{1/v_s^2 - p^2}$. All calculations will use complex numbers to accommodate any potential (though not present in these test cases) evanescent waves.\n        -   Compute the Lamé parameters $\\mu$ and $\\lambda$, and the term $Z_P = \\lambda(p^2 + q_P^2) + 2\\mu q_P^2$.\n        -   Construct the $4 \\times 4$ complex matrix $\\mathbf{A}$ as specified.\n        -   Construct the right-hand side vectors $\\mathbf{b}_P$ and $\\mathbf{b}_S$ for incident P and SV waves, respectively.\n        -   Solve the linear systems $\\mathbf{A}\\mathbf{x}_P = \\mathbf{b}_P$ and $\\mathbf{A}\\mathbf{x}_S = \\mathbf{b}_S$ using `numpy.linalg.solve`.\n        -   Extract the required transmission coefficients: $T_{PP}$ and $T_{PS}$ from the solution $\\mathbf{x}_P$, and $T_{SS}$ from $\\mathbf{x}_S$.\n    -   **Output**: A tuple $(T_{PP}, T_{PS}, T_{SS})$.\n\n2.  **Receiver Function Computation**: A function, `compute_receiver_function`, will orchestrate the main computation for a single test case.\n    -   **Inputs**: The case-specific parameters ($h_m, v_{pm}, v_{sm}, \\rho_m, p$) and the global numerical settings ($\\Delta t, T, f_{\\min}, f_{\\max}, \\eta$).\n    -   **Process**:\n        -   First, compute frequency-independent quantities. This includes calculating all vertical slownesses ($q_{Pm}, q_{Sm}$) for each layer and the P-to-S differential travel times $t_{PS}^{(j)}$ for each interface $j=1,2,3$.\n        -   Call `calculate_zoeppritz` for each of the three interfaces ($1\\leftrightarrow2$, $2\\leftrightarrow3$, $3\\leftrightarrow4$) to obtain the necessary transmission coefficients.\n        -   Compute the frequency-independent potential amplitudes: $\\Phi_{\\text{surf}}$ and $\\Psi_j$ for $j=1,2,3$, using the specified product formulas.\n        -   Set up the FFT parameters: number of points $N = T/\\Delta t$, and the frequency vector `freqs`.\n        -   Iterate through the frequency vector. For each angular frequency $\\omega = 2\\pi f$, compute the complex values of the vertical ($Z(\\omega)$) and radial ($R(\\omega)$) Green's functions using the provided formulas.\n        -   After the frequency loop, perform the deconvolution. Define the band-pass window $W(\\omega)$. Calculate the water-level parameter $\\epsilon$ from the maximum of $|Z(\\omega)|^2$ within the specified band.\n        -   Compute the frequency-domain receiver function $\\text{RF}(\\omega)$.\n        -   Perform the inverse real FFT of $\\text{RF}(\\omega)$ to obtain the time-domain receiver function, `rf_time`.\n        -   For each interface $j=1,2,3$, find the sample index in `rf_time` corresponding to the time closest to $t_{PS}^{(j)}$.\n    -   **Output**: A list containing the three receiver function amplitudes at the predicted arrival times.\n\n3.  **Main Execution**: The `solve` function will define the parameters for all three test cases, call `compute_receiver_function` for each, aggregate the results into a single list of nine amplitudes, and print the final list in the specified format. The number of FFT points will be $N = 102.4 / 0.025 = 4096$.\n\nThis structured approach ensures that each logical step of the problem is modularly and correctly implemented, leading to a verifiable and accurate final answer.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_zoeppritz(vp1, vs1, rho1, vp2, vs2, rho2, p):\n    \"\"\"\n    Solves the P-SV Zoeppritz equations for an upgoing wave from medium 2 to medium 1.\n\n    Args:\n        vp1, vs1, rho1: P-vel, S-vel, density of upper medium 1.\n        vp2, vs2, rho2: P-vel, S-vel, density of lower medium 2.\n        p (float): Horizontal slowness (ray parameter).\n\n    Returns:\n        (T_pp, T_ps, T_ss): Complex transmission coefficients.\n    \"\"\"\n    # Ensure all calculations are done with complex numbers for stability\n    p = complex(p)\n\n    # Vertical slownesses (q)\n    # Use (x + 0j)**0.5 to ensure complex result if argument is negative\n    qp1 = (1/vp1**2 - p**2 + 0j)**0.5\n    qs1 = (1/vs1**2 - p**2 + 0j)**0.5\n    qp2 = (1/vp2**2 - p**2 + 0j)**0.5\n    qs2 = (1/vs2**2 - p**2 + 0j)**0.5\n\n    # Lame parameters (mu, lambda)\n    mu1 = rho1 * vs1**2\n    mu2 = rho2 * vs2**2\n    lam1 = rho1 * vp1**2 - 2 * mu1\n    lam2 = rho2 * vp2**2 - 2 * mu2\n\n    # Zp terms\n    Zp1 = lam1 * (p**2 + qp1**2) + 2 * mu1 * qp1**2\n    Zp2 = lam2 * (p**2 + qp2**2) + 2 * mu2 * qp2**2\n    \n    # Construct the 4x4 coefficient matrix A\n    A = np.array([\n        [-p,       qs2,                          p,        qs1],\n        [-qp2,     -p,                           -qp1,     p],\n        [2*mu2*p*qp2, -mu2*(qs2**2 - p**2),     2*mu1*p*qp1, mu1*(qs1**2 - p**2)],\n        [Zp2,      2*mu2*p*qs2,                -Zp1,     2*mu1*p*qs1]\n    ], dtype=np.complex128)\n\n    # Right-hand side (RHS) for incident P-wave from medium 2\n    b_p = np.array([p, -qp2, 2*mu2*p*qp2, -Zp2], dtype=np.complex128)\n    \n    # Right-hand side (RHS) for incident SV-wave from medium 2\n    b_s = np.array([qs2, p, mu2*(qs2**2-p**2), 2*mu2*p*qs2], dtype=np.complex128)\n    \n    # Solve linear systems\n    x_p = np.linalg.solve(A, b_p)\n    x_s = np.linalg.solve(A, b_s)\n    \n    # Extract transmission coefficients\n    # x = [A_rp, B_rs, A_tp, B_ts]^T\n    T_pp = x_p[2] # A_tp\n    T_ps = x_p[3] # B_ts\n    T_ss = x_s[3] # B_ts (for incident SV)\n\n    return T_pp, T_ps, T_ss\n\ndef compute_receiver_function(h_layers, props, p, dt, T, f_min, f_max, eta):\n    \"\"\"\n    Computes the receiver function for a 3-layer model over a half-space.\n    \"\"\"\n    n_layers = len(h_layers) + 1\n    vps, vss, rhos = props\n\n    # FFT parameters\n    N = int(T / dt)\n    freqs = np.fft.rfftfreq(N, d=dt)\n    omegas = 2 * np.pi * freqs\n\n    # --- Frequency-independent calculations ---\n    # Vertical slownesses for all layers\n    qps = np.array([(1/vps[i]**2 - p**2 + 0j)**0.5 for i in range(n_layers)])\n    qss = np.array([(1/vss[i]**2 - p**2 + 0j)**0.5 for i in range(n_layers)])\n    \n    # P-to-S conversion delay times for each interface\n    t_ps = np.zeros(n_layers - 1)\n    if not np.isclose(qss[0], qps[0]): # Avoid NaN if q values are equal for 0-contrast\n        diff_slowness = qss - qps\n        for j in range(n_layers - 1): # j=0,1,2 for interfaces 1,2,3\n             t_ps[j] = np.sum(h_layers[:j+1] * diff_slowness[:j+1]).real\n\n    # Transmission coefficients for each interface (1->2, 2->3, 3->4)\n    T_coeffs = [calculate_zoeppritz(vps[i], vss[i], rhos[i], vps[i+1], vss[i+1], rhos[i+1], p) for i in range(n_layers-1)]\n    T_pps = np.array([c[0] for c in T_coeffs])\n    T_pss = np.array([c[1] for c in T_coeffs])\n    T_sss = np.array([c[2] for c in T_coeffs])\n    \n    # Potential amplitudes (frequency-independent)\n    # Phi_surf = Tpp(1->2) * Tpp(2->3) * Tpp(3->4)\n    Phi_surf = np.prod(T_pps)\n\n    # Psi_j for j=1,2,3\n    Psi = np.zeros(3, dtype=np.complex128)\n    # j=1 (interface 1->2): A(P)to1 * Tps(1->2) * A(S)from1\n    # A(P) = Tpp(2->3) * Tpp(3->4)\n    # A(S) = 1 (empty product)\n    Psi[0] = np.prod(T_pps[1:]) * T_pss[0] * 1.0\n    # j=2 (interface 2->3): A(P)to2 * Tps(2->3) * A(S)from2\n    # A(P) = Tpp(3->4)\n    # A(S) = Tss(1->2)\n    Psi[1] = T_pps[2] * T_pss[1] * T_sss[0]\n    # j=3 (interface 3->4): A(P)to3 * Tps(3->4) * A(S)from3\n    # A(P) = 1 (empty product)\n    # A(S) = Tss(1->2) * Tss(2->3)\n    Psi[2] = 1.0 * T_pss[2] * np.prod(T_sss[:2])\n\n    # --- Frequency-dependent calculations ---\n    Z_w = np.zeros_like(omegas, dtype=np.complex128)\n    R_w = np.zeros_like(omegas, dtype=np.complex128)\n    \n    # Direct P-wave contribution\n    Z_w += -1j * omegas * qps[0] * Phi_surf\n    R_w += 1j * omegas * p * Phi_surf\n    \n    # Sum of P-S converted wave contributions\n    for j in range(3): # interface j=1,2,3\n        phase_propagator = np.exp(-1j * omegas * t_ps[j])\n        # Vertical component from upgoing SV\n        Z_w += 1j * omegas * p * Psi[j] * phase_propagator\n        # Radial component from upgoing SV\n        R_w += 1j * omegas * qss[0] * Psi[j] * phase_propagator\n        \n    # --- Deconvolution ---\n    Z_w_conj = np.conj(Z_w)\n    Z_w_abs2 = np.abs(Z_w)**2\n    \n    # Window and water level\n    window = (freqs >= f_min) & (freqs <= f_max)\n    if np.any(window):\n        max_Z2_in_band = np.max(Z_w_abs2[window])\n        epsilon = eta * max_Z2_in_band\n    else:\n        epsilon = 1e-12 # Fallback for empty band\n\n    rf_freq = (R_w * Z_w_conj) / (Z_w_abs2 + epsilon)\n    rf_freq[~window] = 0.0 # Apply band-pass filter\n\n    # Inverse FFT to time domain\n    rf_time = np.fft.irfft(rf_freq, n=N)\n\n    # Extract amplitudes at predicted arrival times\n    time_axis = np.arange(N) * dt\n    amplitudes = []\n    for t_arrival in t_ps:\n        idx = np.argmin(np.abs(time_axis - t_arrival))\n        amplitudes.append(rf_time[idx])\n        \n    return amplitudes\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    # Common numerical settings\n    DT = 0.025\n    T_DUR = 102.4\n    F_MIN = 0.05\n    F_MAX = 1.0\n    ETA = 0.01\n\n    # Test cases definition\n    case_a_props = {\n        'h': np.array([20000.0, 15000.0, 25000.0]),\n        'vps': np.array([6000.0, 6500.0, 8000.0, 8200.0]),\n        'vss': np.array([3464.0, 3750.0, 4600.0, 4700.0]),\n        'rhos': np.array([2700.0, 2800.0, 3200.0, 3300.0]),\n        'p': 6.0e-5\n    }\n    \n    case_b_props = {\n        'h': np.array([20000.0, 15000.0, 25000.0]),\n        'vps': np.array([6000.0, 6000.0, 6000.0, 6000.0]),\n        'vss': np.array([3464.0, 3464.0, 3464.0, 3464.0]),\n        'rhos': np.array([2700.0, 2700.0, 2700.0, 2700.0]),\n        'p': 6.0e-5\n    }\n\n    case_c_props = {\n        'h': np.array([20000.0, 15000.0, 25000.0]),\n        'vps': np.array([6000.0, 6500.0, 8000.0, 8200.0]),\n        'vss': np.array([3464.0, 3750.0, 4600.0, 4700.0]),\n        'rhos': np.array([2700.0, 2800.0, 3200.0, 3300.0]),\n        'p': 1.2e-4\n    }\n\n    test_cases = [case_a_props, case_b_props, case_c_props]\n    \n    all_results = []\n    for case in test_cases:\n        props = (case['vps'], case['vss'], case['rhos'])\n        amplitudes = compute_receiver_function(\n            case['h'], props, case['p'], DT, T_DUR, F_MIN, F_MAX, ETA\n        )\n        all_results.extend(amplitudes)\n    \n    # Format output as a single-line list of floats\n    print(f\"[{','.join([f'{r:.6f}' for r in all_results])}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "A powerful model is only useful if we understand its limitations and the ambiguities in its output. This final practice explores a critical issue in receiver function interpretation: the interference between the primary converted phase ($Ps$) and later-arriving multiples, such as $PpPs$. By analyzing how the time separation between these phases depends on the ray parameter $p$, you will investigate the fundamental trade-off between signal resolution and phase aliasing, learning to identify scenarios where structural features may be obscured by wavefield interference .",
            "id": "3613392",
            "problem": "Consider a one-dimensional, horizontally layered, isotropic elastic medium consisting of a single homogeneous layer of thickness $H$ over a half-space. Let the layer have compressional-wave speed $\\alpha$ and shear-wave speed $\\beta$, both constant with depth. A teleseismic plane compressional wave (P-wave) with horizontal slowness $p$ (in $\\mathrm{s/km}$) impinges from below. In receiver function analysis, secondary phases arise due to mode conversions and free-surface multiples near the receiver. Two key converted phases are the primary $Ps$ (P-to-S conversion at the interface) and the free-surface multiple $PpPs$ (P reflection at the free surface, then P-to-S conversion at the interface). The receiver function is modeled as a linear time-invariant system acting on an incident wavelet, so that phase separability under linear filtering can be analyzed using pulse interference after band-limiting.\n\nYour task is to use slowness-dependent forward modeling to determine when $Ps$ and $PpPs$ become inseparable under zero-phase Gaussian low-pass filtering with a specified $-3\\,\\mathrm{dB}$ cutoff frequency $f$ (in $\\mathrm{Hz}$). The model and analysis must obey the following specifications:\n\n1. Fundamental base and kinematics:\n   - Adopt plane-wave ray theory. The ray parameter (horizontal slowness) is $p = \\sin i / v$, where $i$ is the incidence angle and $v$ is the phase speed for the given mode.\n   - The vertical slowness for a mode with speed $v$ is $q(v,p) = \\sqrt{v^{-2} - p^{2}}$ (in $\\mathrm{s/km}$), valid for $p < v^{-1}$.\n   - The one-way traveltime through a layer of thickness $H$ for a plane wave with vertical slowness $q$ is $H\\,q$ (in $\\mathrm{s}$).\n   - Using these definitions only, derive the arrival-time difference $\\Delta t$ between $PpPs$ and $Ps$ as a function of $H$, $\\alpha$, $\\beta$, and $p$.\n\n2. Linear filtering model and interference criterion:\n   - Use a zero-phase Gaussian low-pass filter with amplitude frequency response $H(f') = \\exp\\!\\big(-\\frac{f'^{2}}{2\\,\\sigma_{f}^{2}}\\big)$, where $f'$ is temporal frequency (in $\\mathrm{Hz}$) and $\\sigma_{f}$ is chosen so that the filter is at $-3\\,\\mathrm{dB}$ (that is, amplitude $1/\\sqrt{2}$) at the specified cutoff $f$. This implies $\\sigma_{f} = f/\\sqrt{\\ln 2}$.\n   - Model each phase as an idealized Dirac delta in time before filtering. After filtering, the time-domain pulse for a phase becomes the filter’s impulse response centered at the phase’s arrival time.\n   - Define the normalized coherence $\\rho$ between the two filtered pulses as the absolute value of their normalized inner product. Under the Gaussian filter above and the delta-pulse model, $\\rho$ is a deterministic function of the time separation $\\Delta t$ and $f$. Declare that phase separation by any linear time-invariant filter matched to this passband is infeasible if and only if $\\rho \\ge \\tau$, with threshold $\\tau = 0.6$ (dimensionless).\n\n3. Fixed physical model parameters for this problem:\n   - Thickness $H = 5$ $\\mathrm{km}$.\n   - Compressional-wave speed $\\alpha = 6.3$ $\\mathrm{km/s}$.\n   - Shear-wave speed $\\beta = 3.6$ $\\mathrm{km/s}$.\n\n4. Units and numerical requirements:\n   - Use $p$ in $\\mathrm{s/km}$, $f$ in $\\mathrm{Hz}$, speeds in $\\mathrm{km/s}$, thickness in $\\mathrm{km}$, and time in $\\mathrm{s}$.\n   - All computations must be carried out in these units with no conversions.\n   - If a test case has $p \\ge \\alpha^{-1}$, then the $P$ vertical slowness becomes imaginary and the case is non-physical for these phases; treat such a case as infeasible to separate (return boolean True) because the forward model assumption breaks down.\n\n5. Test suite:\n   For each pair $(p,f)$ below, compute whether separation is infeasible (boolean True) or feasible (boolean False) according to the criterion in item $2$ and the model in item $3$.\n   - Case $1$: $(p,f) = (0.10, 0.15)$.\n   - Case $2$: $(p,f) = (0.08, 0.15)$.\n   - Case $3$: $(p,f) = (0.10, 0.20)$.\n   - Case $4$: $(p,f) = (0.10, 0.10)$.\n   - Case $5$: $(p,f) = (0.06, 0.15)$.\n   - Case $6$: $(p,f) = (0.12, 0.10)$.\n\n6. Program output format:\n   - Your program must produce a single line containing a Python-style list of the six boolean results in the order of the test suite, with no spaces, for example, $[True,False,True,False,True,False]$ but with the actual computed values.\n\nThe delivered program must be complete and self-contained, with no external inputs. It must implement the above derivation and classification rigorously. All angles, if any, are implicit through the slowness definition; do not use degrees or radians. All numerical results are unit-consistent by construction. Express all final booleans as exact True or False in the output list.",
            "solution": "The problem requires an analysis of the separability of two seismic phases, $Ps$ and $PpPs$, in a simplified earth model. The analysis hinges on combining a kinematic model based on plane-wave ray theory with a signal processing model based on linear filtering. A phase pair is deemed inseparable if their temporal separation is insufficient to prevent significant destructive or constructive interference, as quantified by a coherence measure exceeding a specified threshold.\n\nThe solution proceeds in three main stages:\n1.  Derivation of the arrival-time difference, $\\Delta t$, between the $PpPs$ and $Ps$ phases.\n2.  Derivation of the inseparability criterion based on the normalized coherence, $\\rho$.\n3.  Application of the derived criterion to the provided test cases.\n\n**1. Derivation of Arrival-Time Difference $\\Delta t$**\n\nWe model the Earth as a single homogeneous layer of thickness $H$ over a half-space. The layer has a P-wave speed $\\alpha$ and an S-wave speed $\\beta$. A plane P-wave with horizontal slowness $p$ is incident from the half-space below. The receiver is at the free surface ($z=0$), and the layer-half-space interface is at depth $z=H$.\n\nAccording to plane-wave theory, the vertical slowness $q$ of a wave with phase speed $v$ and horizontal slowness $p$ is given by:\n$$q(v, p) = \\sqrt{v^{-2} - p^2}$$\nFor this to be a real quantity, we require $p < v^{-1}$. The one-way travel time for a wave crossing the layer of thickness $H$ is $H \\cdot q$.\n\nIn receiver function analysis, arrival times are typically measured relative to the arrival of the direct P-wave at the surface.\n-   **Direct P-wave ($P$):** Travels from the interface at $z=H$ to the receiver at $z=0$. Its travel time within the layer is $t_P = H \\cdot q_\\alpha$, where $q_\\alpha = \\sqrt{\\alpha^{-2} - p^2}$.\n-   **Primary Conversion ($Ps$):** The incident P-wave converts to an S-wave at the interface ($z=H$) and travels to the receiver ($z=0$). Its travel time in the layer is $t_{Ps_L} = H \\cdot q_\\beta$, where $q_\\beta = \\sqrt{\\beta^{-2} - p^2}$. The arrival time of the $Ps$ phase relative to the direct $P$ phase is:\n    $$\\Delta t_{Ps-P} = t_{Ps_L} - t_P = H(q_\\beta - q_\\alpha)$$\n-   **Surface Multiple ($PpPs$):** This phase represents a P-wave reverberation in the layer. The incident P-wave travels to the surface ($t_{up} = H q_\\alpha$), reflects down as a P-wave ($t_{down} = H q_\\alpha$), converts to an S-wave at the interface, and travels back to the surface ($t_{upS} = H q_\\beta$). The total travel time for this path generated within the layer is $2 H q_\\alpha + H q_\\beta$. The arrival time relative to the direct $P$ phase is this total time minus the direct P-wave's travel time:\n    $$\\Delta t_{PpPs-P} = (2 H q_\\alpha + H q_\\beta) - t_P = (2 H q_\\alpha + H q_\\beta) - H q_\\alpha = H(q_\\alpha + q_\\beta)$$\n\nThe time separation, $\\Delta t$, between the $PpPs$ phase and the $Ps$ phase is the difference between their arrival times relative to the direct P-wave:\n$$\\Delta t = \\Delta t_{PpPs-P} - \\Delta t_{Ps-P} = H(q_\\alpha + q_\\beta) - H(q_\\beta - q_\\alpha)$$\n$$\\Delta t = 2H q_\\alpha = 2H \\sqrt{\\alpha^{-2} - p^2}$$\nThis expression gives the required time separation as a function of $H$, $\\alpha$, and $p$.\n\n**2. Derivation of the Inseparability Criterion**\n\nThe problem states that two phases, modeled as Dirac delta functions, are filtered by a zero-phase Gaussian low-pass filter with an amplitude frequency response $H(f') = \\exp\\big(-\\frac{f'^{2}}{2\\sigma_{f}^{2}}\\big)$. The filter's standard deviation in the frequency domain, $\\sigma_f$, is defined by the condition that the filter has an amplitude of $1/\\sqrt{2}$ ($-3\\,\\mathrm{dB}$) at a specified cutoff frequency $f$.\n$$H(f) = \\exp\\left(-\\frac{f^2}{2\\sigma_f^2}\\right) = \\frac{1}{\\sqrt{2}} = 2^{-1/2}$$\nTaking the natural logarithm of both sides:\n$$-\\frac{f^2}{2\\sigma_f^2} = \\ln(2^{-1/2}) = -\\frac{1}{2}\\ln 2$$\n$$\\sigma_f^2 = \\frac{f^2}{\\ln 2}$$\nThe filter's impulse response, $g(t)$, is the inverse Fourier transform of $H(f')$. The two filtered phases are represented by pulses $g(t)$ and $g(t-\\Delta t)$. Their normalized coherence $\\rho$ is the absolute value of their normalized inner product:\n$$\\rho(\\Delta t) = \\frac{\\left| \\int_{-\\infty}^{\\infty} g(t) g(t-\\Delta t) dt \\right|}{\\int_{-\\infty}^{\\infty} g(t)^2 dt}$$\nThe numerator is the autocorrelation of $g(t)$ evaluated at lag $\\Delta t$, denoted $R_{gg}(\\Delta t)$. The denominator is the total energy, $R_{gg}(0)$. According to the Wiener-Khinchin theorem, the autocorrelation function is the inverse Fourier transform of the power spectral density, which is $|H(f')|^2$.\n$$|H(f')|^2 = \\left[ \\exp\\left(-\\frac{f'^2}{2\\sigma_f^2}\\right) \\right]^2 = \\exp\\left(-\\frac{f'^2}{\\sigma_f^2}\\right)$$\nThe inverse Fourier transform of a Gaussian in frequency, $\\exp(-a f'^2)$, is a Gaussian in time, $\\sqrt{\\pi/a} \\exp(-\\pi^2 t^2/a)$. Here, $a = 1/\\sigma_f^2$. Thus, $R_{gg}(\\Delta t) \\propto \\exp(-\\pi^2 \\sigma_f^2 \\Delta t^2)$.\nThe normalized coherence is then:\n$$\\rho(\\Delta t) = \\frac{R_{gg}(\\Delta t)}{R_{gg}(0)} = \\exp(-\\pi^2 \\sigma_f^2 \\Delta t^2)$$\nSubstituting the expression for $\\sigma_f^2$:\n$$\\rho(\\Delta t, f) = \\exp\\left(-\\pi^2 \\frac{f^2}{\\ln 2} \\Delta t^2\\right)$$\nInseparability is declared if $\\rho \\ge \\tau$, where the threshold $\\tau=0.6$. The criterion is:\n$$\\exp\\left(-\\frac{\\pi^2 f^2 \\Delta t^2}{\\ln 2}\\right) \\ge 0.6$$\n\n**3. Algorithmic Procedure and Application**\n\nThe following algorithm is used to evaluate each $(p,f)$ test case:\n\n1.  Input parameters are layer thickness $H=5\\,\\mathrm{km}$, P-wave speed $\\alpha=6.3\\,\\mathrm{km/s}$, S-wave speed $\\beta=3.6\\,\\mathrm{km/s}$, and coherence threshold $\\tau=0.6$.\n2.  For a given pair $(p, f)$:\n    a.  Check for non-physical propagation. If $p \\ge \\alpha^{-1}$, the P-wave is evanescent, and the model assumption is violated. Per the problem statement, we classify this as inseparable (`True`).\n    b.  If the propagation is physical ($p < \\alpha^{-1}$), calculate the time separation $\\Delta t = 2H\\sqrt{\\alpha^{-2} - p^2}$.\n    c.  Calculate the coherence $\\rho = \\exp\\left(-\\frac{\\pi^2 f^2 \\Delta t^2}{\\ln 2}\\right)$.\n    d.  Compare the coherence to the threshold. The result is `True` if $\\rho \\ge 0.6$ and `False` otherwise.\n3.  This procedure is applied to all six test cases, and the boolean results are collected into a list.\n\nThis concludes the rigorous derivation and formulation of the solution. The implementation will now be presented.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the separability of Ps and PpPs seismic phases for a set of test cases.\n\n    The function implements a forward model based on plane-wave ray theory and a\n    signal coherence criterion based on Gaussian low-pass filtering to determine\n    if the two phases are separable.\n    \"\"\"\n\n    # 3. Fixed physical model parameters for this problem:\n    H = 5.0      # Layer thickness in km\n    alpha = 6.3  # P-wave speed in km/s\n    beta = 3.6   # S-wave speed in km/s (not strictly needed for dt, but a model parameter)\n\n    # Coherence threshold from item 2\n    tau = 0.6\n\n    # 5. Test suite:\n    test_cases = [\n        # (p, f) in (s/km, Hz)\n        (0.10, 0.15),  # Case 1\n        (0.08, 0.15),  # Case 2\n        (0.10, 0.20),  # Case 3\n        (0.10, 0.10),  # Case 4\n        (0.06, 0.15),  # Case 5\n        (0.12, 0.10),  # Case 6\n    ]\n\n    results = []\n    \n    # Pre-calculate constants to optimize loop\n    alpha_inv_sq = alpha**-2\n    ln2 = np.log(2)\n    pi_sq = np.pi**2\n    alpha_inv = 1.0 / alpha\n\n    for p, f in test_cases:\n        # 4. Units and numerical requirements:\n        # Check for non-physical P-wave propagation (evanescent wave)\n        if p >= alpha_inv:\n            results.append(True)\n            continue\n\n        # 1. Fundamental base and kinematics:\n        # Derive the arrival-time difference delta_t\n        try:\n            # Vertical slowness for P-wave\n            q_alpha_sq = alpha_inv_sq - p**2\n            # This check is implicitly handled by the p >= 1/alpha check above\n            # but is good practice for robustness.\n            if q_alpha_sq < 0:\n                 results.append(True) # Treat as inseparable\n                 continue\n            q_alpha = np.sqrt(q_alpha_sq)\n            \n            # Time separation between PpPs and Ps\n            delta_t = 2.0 * H * q_alpha\n        except ValueError:\n            # Should not happen with the check above, but for safety\n            results.append(True)\n            continue\n\n        # 2. Linear filtering model and interference criterion:\n        # Calculate normalized coherence rho\n        exponent = -(pi_sq * f**2 * delta_t**2) / ln2\n        rho = np.exp(exponent)\n\n        # Apply the inseparability criterion\n        is_inseparable = rho >= tau\n        results.append(is_inseparable)\n\n    # 6. Program output format:\n    # Print the list of boolean results\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}