{
    "hands_on_practices": [
        {
            "introduction": "Mastering dimensional analysis begins with the Buckingham $\\Pi$ theorem, a powerful tool for reducing the number of variables in a physical problem. This practice challenges you to apply the theorem to a classic geophysical scenario: the drag on a settling particle. By systematically counting the physical variables and their fundamental dimensions, you can determine the number of independent dimensionless groups that fully characterize the system, a crucial first step in any experimental design or theoretical scaling analysis .",
            "id": "3584196",
            "problem": "In computational geophysics, dimensional analysis is used to reduce the complexity of governing relationships in fluid–solid interactions pertinent to sediment transport and particle settling. Consider the drag on a rigid sphere moving steadily through a Newtonian viscous fluid, a canonical problem relevant to geophysical flows of particulate suspensions. \n\nState the Buckingham $\\Pi$ theorem precisely in terms of the count of variables and base dimensions, and apply it to the drag problem as follows. Let the drag force be denoted by $F_{D}$ and assume the drag depends on the characteristic flow speed $U$, the characteristic sphere length $L$, the fluid mass density $\\rho$, and the dynamic viscosity $\\mu$. Treat the set of relevant variables as $\\{F_{D}, U, L, \\rho, \\mu\\}$, and use the standard mechanical base dimensions mass $M$, length $L$, and time $T$. Determine the number of independent dimensionless groups that characterize this drag problem. Your final answer must be a single integer. Do not provide any additional derivations in the final answer.",
            "solution": "The problem requires the determination of the number of independent dimensionless groups for the drag on a sphere using the Buckingham $\\Pi$ theorem.\n\nFirst, we state the Buckingham $\\Pi$ theorem as requested. The theorem provides a method for reducing the number of variables in a physical problem. It states that if a physically meaningful relationship among $n$ physical variables exists, and these variables can be described using $k$ independent fundamental dimensions, then the relationship can be expressed in terms of $p = n - k$ independent dimensionless groups, often denoted as $\\Pi_1, \\Pi_2, \\dots, \\Pi_p$. The functional relationship can be written as $f(\\Pi_1, \\Pi_2, \\dots, \\Pi_p) = 0$.\n\nThe steps to apply the theorem are as follows:\n1.  Identify and count the number of relevant physical variables, $n$.\n2.  Determine the dimensions of each variable in terms of a set of fundamental base dimensions.\n3.  Determine the number of independent fundamental dimensions, $k$, required to describe the variables. This is equivalent to finding the rank of the dimensional matrix.\n4.  Calculate the number of independent dimensionless groups, $p = n - k$.\n\nWe now apply this procedure to the given problem.\n\nStep 1: Identify the variables.\nThe problem provides the set of relevant variables: $\\{F_{D}, U, L, \\rho, \\mu\\}$.\n-   $F_{D}$: drag force\n-   $U$: characteristic flow speed\n-   $L$: characteristic sphere length\n-   $\\rho$: fluid mass density\n-   $\\mu$: dynamic viscosity\nThe total number of variables is $n=5$.\n\nStep 2: Determine the dimensions of each variable.\nThe specified base dimensions are mass ($M$), length ($L$), and time ($T$). We express the dimensions of each of the $n=5$ variables in terms of these base dimensions.\n-   The dimension of drag force, $F_{D}$, which is mass times acceleration, is $[F_{D}] = M L T^{-2}$.\n-   The dimension of speed, $U$, is $[U] = L T^{-1}$.\n-   The dimension of length, $L$, is $[L] = L$.\n-   The dimension of density, $\\rho$, which is mass per unit volume, is $[\\rho] = M L^{-3}$.\n-   The dimension of dynamic viscosity, $\\mu$, is derived from the relation for shear stress $\\tau = \\mu \\frac{\\partial u}{\\partial y}$. Thus, $[\\mu] = \\frac{[\\tau]}{[\\frac{\\partial u}{\\partial y}]} = \\frac{[Force/Area]}{[Speed/Length]} = \\frac{M L T^{-2} / L^2}{L T^{-1} / L} = \\frac{M L^{-1} T^{-2}}{T^{-1}} = M L^{-1} T^{-1}$.\n\nStep 3: Determine the number of independent fundamental dimensions.\nThe base dimensions are given as $M$, $L$, and $T$. To find the number of independent dimensions, $k$, we construct the dimensional matrix. The columns correspond to the variables $\\{F_{D}, U, L, \\rho, \\mu\\}$ and the rows correspond to the base dimensions $\\{M, L, T\\}$. The entries of the matrix are the exponents of the dimensions for each variable.\n\nThe dimensional matrix is:\n$$\n\\begin{pmatrix}\n   F_{D}  U  L  \\rho  \\mu \\\\\nM  1  0  0  1  1 \\\\\nL  1  1  1  -3  -1 \\\\\nT  -2  -1  0  0  -1\n\\end{pmatrix}\n$$\nThe number of independent dimensions, $k$, is the rank of this $3 \\times 5$ matrix. We can determine the rank by finding a submatrix with a non-zero determinant. Let's select the square submatrix formed by the columns corresponding to the variables $U$, $\\rho$, and $\\mu$:\n$$\n\\begin{pmatrix}\n0  1  1 \\\\\n1  -3  -1 \\\\\n-1  0  -1\n\\end{pmatrix}\n$$\nThe determinant of this $3 \\times 3$ submatrix is calculated as:\n$0 \\cdot ((-3)(-1) - (0)(-1)) - 1 \\cdot ((1)(-1) - (-1)(-1)) + 1 \\cdot ((1)(0) - (-3)(-1))$\n$= 0 - 1 \\cdot (-1 - 1) + 1 \\cdot (0 - 3)$\n$= -1 \\cdot (-2) - 3 = 2 - 3 = -1$.\nSince the determinant is non-zero (it is $-1$), the three column vectors are linearly independent. This implies that the rank of the submatrix is $3$. Therefore, the rank of the full $3 \\times 5$ dimensional matrix is $3$.\nThis confirms that all three base dimensions, $M$, $L$, and $T$, are independent for this set of variables.\nThus, the number of independent dimensions is $k=3$.\n\nStep 4: Calculate the number of dimensionless groups.\nUsing the Buckingham $\\Pi$ theorem, the number of independent dimensionless groups, $p$, is given by:\n$$p = n - k$$\nSubstituting the values we found:\n$$p = 5 - 3 = 2$$\nTherefore, the drag problem as stated is characterized by $2$ independent dimensionless groups. These are commonly known as the drag coefficient, $C_D = \\frac{F_D}{\\frac{1}{2}\\rho U^2 A}$ (where $A$ is a characteristic area, proportional to $L^2$), and the Reynolds number, $Re = \\frac{\\rho U L}{\\mu}$.\n\nThe final answer is the integer value for the number of independent dimensionless groups.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "While the $\\Pi$ theorem tells us *how many* dimensionless groups exist, nondimensionalizing the governing equations reveals their physical significance. This exercise guides you through the process of scaling an advection-diffusion-source equation, a model central to understanding tracer transport in the Earth's oceans, atmosphere, and subsurface. Through this process, you will see how fundamental parameters like the Péclet number naturally emerge, quantifying the crucial balance between advective and diffusive transport .",
            "id": "3584191",
            "problem": "A tracer concentration field in a geophysical flow, such as a dissolved isotope transported in a hydrothermal circulation cell, evolves according to the scalar conservation equation in the form of an advection–diffusion–source Partial Differential Equation (PDE):\n$$\n\\partial_{t} \\phi + \\boldsymbol{u}\\cdot\\nabla \\phi = \\kappa \\nabla^{2}\\phi + S,\n$$\nwhere $\\phi$ is the tracer concentration, $\\boldsymbol{u}$ is the velocity field, $\\kappa$ is the molecular diffusivity, and $S$ is a uniform volumetric source term representing constant generation of tracer per unit time. Assume the flow has a characteristic speed $U$ and length scale $L$, and the tracer exhibits a characteristic variation magnitude $\\Delta \\phi$ about a baseline level $\\phi_{0}$ over distances of order $L$.\n\nUsing only first-principles dimensional analysis and nondimensionalization grounded in the conservation law above and the kinematic definitions of the scales $U$, $L$, and $\\Delta \\phi$, do the following:\n\n- Introduce dimensionless variables $t^{\\ast}$, $\\boldsymbol{x}^{\\ast}$, $\\boldsymbol{u}^{\\ast}$, and $\\phi^{\\ast}$ by choosing appropriate scalings built from $U$, $L$, and $\\Delta \\phi$, ensuring that the advective term $\\boldsymbol{u}\\cdot\\nabla \\phi$ and the temporal term $\\partial_{t}\\phi$ are of the same order in the resulting nondimensional equation.\n- Derive the nondimensional form of the PDE and identify the dimensionless groups that multiply the diffusion and source terms, interpreting them as the Péclet number (Pe) and a source strength number (Sr), respectively.\n- Express these two dimensionless groups as closed-form analytic expressions in terms of $U$, $L$, $\\kappa$, $S$, and $\\Delta \\phi$.\n\nYour final answer must be the ordered pair of the two expressions for the Péclet number and the source strength number written as a single row in a matrix. No numerical values are required, and no units should be included in the final answer. If any intermediate numerical approximations were to be used, they should be avoided; present exact symbolic expressions only.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\n-   **Governing Equation**: The tracer concentration $\\phi$ evolves according to the advection–diffusion–source PDE:\n    $$\n    \\partial_{t} \\phi + \\boldsymbol{u}\\cdot\\nabla \\phi = \\kappa \\nabla^{2}\\phi + S\n    $$\n-   **Definitions**:\n    -   $\\phi$: tracer concentration.\n    -   $\\boldsymbol{u}$: velocity field.\n    -   $\\kappa$: molecular diffusivity.\n    -   $S$: uniform volumetric source term.\n-   **Characteristic Scales**:\n    -   $U$: characteristic speed.\n    -   $L$: characteristic length scale.\n    -   $\\Delta \\phi$: characteristic variation magnitude of $\\phi$ about a baseline level $\\phi_{0}$.\n-   **Constraint**: The nondimensionalization must ensure that the temporal term, $\\partial_{t}\\phi$, and the advective term, $\\boldsymbol{u}\\cdot\\nabla \\phi$, are of the same order of magnitude in the final dimensionless equation.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding**: The problem is based on the scalar advection-diffusion equation, a fundamental conservation law in transport phenomena. This equation is ubiquitously applied in geophysics, fluid dynamics, and heat transfer. All terms and parameters are standard and physically meaningful. The problem is scientifically sound.\n-   **Well-Posedness**: The problem is well-posed. It supplies all necessary physical parameters ($U$, $L$, $\\kappa$, $S$, $\\Delta \\phi$) and a governing PDE. The constraint on balancing the temporal and advective terms provides a clear path to determine the characteristic time scale, making the nondimensionalization procedure unambiguous. The objective—to find expressions for two specific dimensionless numbers—is precise and achievable.\n-   **Objectivity**: The language is formal, precise, and objective, typical of a problem in mathematical physics. There are no subjective or ambiguous statements.\n-   **Flaw Checklist**: The problem does not violate any of the specified criteria for invalidity. It is scientifically sound, formalizable, complete, feasible, and well-structured.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. A complete and reasoned solution will now be provided.\n\n### Solution Derivation\n\nThe goal is to nondimensionalize the given partial differential equation (PDE) and identify the dimensionless groups associated with the diffusion and source terms.\n\nThe governing PDE is:\n$$\n\\partial_{t} \\phi + \\boldsymbol{u}\\cdot\\nabla \\phi = \\kappa \\nabla^{2}\\phi + S\n$$\n\nWe introduce dimensionless variables, denoted with an asterisk ($^{\\ast}$), based on the provided characteristic scales $U$, $L$, and $\\Delta\\phi$.\n\n1.  **Dimensionless Variables**:\n    The spatial coordinates $\\boldsymbol{x}$, velocity $\\boldsymbol{u}$, time $t$, and concentration $\\phi$ are scaled as follows:\n    -   $\\boldsymbol{x} = L\\boldsymbol{x}^{\\ast}$\n    -   $\\boldsymbol{u} = U\\boldsymbol{u}^{\\ast}$\n\n    The problem states that $\\Delta\\phi$ is the \"characteristic variation magnitude about a baseline level $\\phi_0$\". This suggests analyzing the dynamics of the deviation from the baseline, $\\phi' = \\phi - \\phi_0$. Since $\\phi_0$ is a constant, its temporal and spatial derivatives are zero. Substituting $\\phi = \\phi' + \\phi_0$ into the PDE yields an identical equation for $\\phi'$:\n    $$\n    \\partial_{t} \\phi' + \\boldsymbol{u}\\cdot\\nabla \\phi' = \\kappa \\nabla^{2}\\phi' + S\n    $$\n    The characteristic scale for this deviation $\\phi'$ is $\\Delta\\phi$. Therefore, the dimensionless concentration is defined as:\n    $$\n    \\phi^{\\ast} = \\frac{\\phi'}{\\Delta\\phi} \\implies \\phi' = \\Delta\\phi \\phi^{\\ast}\n    $$\n    To determine the scaling for time $t$, we use the problem's constraint that the temporal and advective terms must be of the same order. Let $T$ be the characteristic time scale, so $t = T t^{\\ast}$.\n    The order of magnitude of the two terms are:\n    -   Temporal term: $\\partial_{t}\\phi' \\sim \\frac{\\Delta\\phi}{T}$\n    -   Advective term: $\\boldsymbol{u}\\cdot\\nabla \\phi' \\sim U \\frac{\\Delta\\phi}{L}$\n    Equating these orders of magnitude gives:\n    $$\n    \\frac{\\Delta\\phi}{T} \\sim \\frac{U\\Delta\\phi}{L} \\implies T = \\frac{L}{U}\n    $$\n    This is the advective time scale. The dimensionless time variable is thus:\n    $$\n    t^{\\ast} = \\frac{t}{T} = \\frac{tU}{L}\n    $$\n\n2.  **Transformation of Derivatives**:\n    Using the chain rule, we express the dimensional derivatives in terms of the dimensionless ones:\n    -   $\\partial_t = \\frac{\\partial}{\\partial t} = \\frac{\\partial t^{\\ast}}{\\partial t}\\frac{\\partial}{\\partial t^{\\ast}} = \\frac{U}{L}\\frac{\\partial}{\\partial t^{\\ast}}$\n    -   $\\nabla = \\frac{\\partial}{\\partial \\boldsymbol{x}} = \\frac{\\partial \\boldsymbol{x}^{\\ast}}{\\partial \\boldsymbol{x}}\\frac{\\partial}{\\partial \\boldsymbol{x}^{\\ast}} = \\frac{1}{L}\\nabla^{\\ast}$\n    -   $\\nabla^2 = \\nabla \\cdot \\nabla = \\left(\\frac{1}{L}\\nabla^{\\ast}\\right) \\cdot \\left(\\frac{1}{L}\\nabla^{\\ast}\\right) = \\frac{1}{L^2}\\nabla^{\\ast 2}$\n\n3.  **Substitution into the PDE**:\n    We substitute the scaled variables and derivatives into the PDE for $\\phi'$:\n    $$\n    \\left(\\frac{U}{L}\\frac{\\partial}{\\partial t^{\\ast}}\\right)(\\Delta\\phi\\phi^{\\ast}) + (U\\boldsymbol{u}^{\\ast})\\cdot\\left(\\frac{1}{L}\\nabla^{\\ast}\\right)(\\Delta\\phi\\phi^{\\ast}) = \\kappa \\left(\\frac{1}{L^2}\\nabla^{\\ast 2}\\right)(\\Delta\\phi\\phi^{\\ast}) + S\n    $$\n    Since the scales $U$, $L$, and $\\Delta\\phi$ are constants, we can factor them out of the derivatives:\n    $$\n    \\frac{U\\Delta\\phi}{L}\\frac{\\partial\\phi^{\\ast}}{\\partial t^{\\ast}} + \\frac{U\\Delta\\phi}{L}\\boldsymbol{u}^{\\ast}\\cdot\\nabla^{\\ast}\\phi^{\\ast} = \\frac{\\kappa\\Delta\\phi}{L^2}\\nabla^{\\ast 2}\\phi^{\\ast} + S\n    $$\n    To obtain the dimensionless form of the equation, we divide every term by the characteristic magnitude of the advective/temporal terms, which is $\\frac{U\\Delta\\phi}{L}$:\n    $$\n    \\frac{\\frac{U\\Delta\\phi}{L}}{\\frac{U\\Delta\\phi}{L}}\\frac{\\partial\\phi^{\\ast}}{\\partial t^{\\ast}} + \\frac{\\frac{U\\Delta\\phi}{L}}{\\frac{U\\Delta\\phi}{L}}\\boldsymbol{u}^{\\ast}\\cdot\\nabla^{\\ast}\\phi^{\\ast} = \\frac{\\frac{\\kappa\\Delta\\phi}{L^2}}{\\frac{U\\Delta\\phi}{L}}\\nabla^{\\ast 2}\\phi^{\\ast} + \\frac{S}{\\frac{U\\Delta\\phi}{L}}\n    $$\n    Simplifying the coefficients yields the final nondimensional equation (dropping the asterisks for notational simplicity, as is conventional):\n    $$\n    \\frac{\\partial\\phi}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla\\phi = \\left(\\frac{\\kappa\\Delta\\phi}{L^2} \\cdot \\frac{L}{U\\Delta\\phi}\\right)\\nabla^2\\phi + \\left(S \\cdot \\frac{L}{U\\Delta\\phi}\\right)\n    $$\n    $$\n    \\frac{\\partial\\phi}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla\\phi = \\left(\\frac{\\kappa}{UL}\\right)\\nabla^2\\phi + \\left(\\frac{SL}{U\\Delta\\phi}\\right)\n    $$\n\n4.  **Identification of Dimensionless Groups**:\n    The nondimensional equation reveals two dimensionless groups multiplying the diffusion and source terms.\n    -   **Péclet Number (Pe)**: The group multiplying the diffusion term, $\\nabla^2\\phi$, is $\\frac{\\kappa}{UL}$. The Péclet number, $\\text{Pe}$, is conventionally defined as the ratio of the rate of advection to the rate of diffusion. The advective transport scale is $\\sim UL$, while the diffusive transport scale is $\\sim \\kappa$. Thus, $\\text{Pe} \\propto \\frac{UL}{\\kappa}$. The coefficient in our equation is the inverse of the Péclet number, $\\frac{1}{\\text{Pe}}$. The expression for the Péclet number itself is therefore:\n      $$\n      \\text{Pe} = \\frac{UL}{\\kappa}\n      $$\n    -   **Source Strength Number (Sr)**: The group corresponding to the source term is a dimensionless source strength, which we label $\\text{Sr}$. It represents the ratio of the tracer generation rate to the tracer removal rate by advection. Its expression is:\n      $$\n      \\text{Sr} = \\frac{SL}{U\\Delta\\phi}\n      $$\n\nThese are the two required dimensionless groups, expressed as closed-form analytic expressions.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{UL}{\\kappa}  \\frac{SL}{U\\Delta\\phi} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The principles of dimensional analysis extend beyond physical laws into the domain of numerical computation, where they are essential for ensuring the stability and accuracy of our models. This advanced practice explores how dimensionless groups arise from the discretization of a PDE, focusing on the grid Péclet number, $Pe_g$. By analyzing the discrete form of the advection-diffusion equation, you will derive the stability constraints that link physical parameters to the chosen grid spacing, a foundational concept in computational geophysics that prevents unphysical numerical oscillations .",
            "id": "3584234",
            "problem": "Consider one-dimensional passive tracer transport in a uniform current, modeled by the advection–diffusion equation\n$$\n\\frac{\\partial c}{\\partial t} + U \\frac{\\partial c}{\\partial x} = \\kappa \\frac{\\partial^2 c}{\\partial x^2},\n$$\nwhere $c$ is concentration, $U$ is a constant velocity, and $\\kappa$ is a constant diffusivity. A uniform grid with spacing $\\Delta x$ and forward-Euler time step $\\Delta t$ is used. An explicit central-difference scheme updates $c_i^n$ to $c_i^{n+1}$ by approximating spatial derivatives with second-order central differences and the time derivative with forward Euler. Define the Courant–Friedrichs–Lewy (CFL) number\n$$\n\\lambda = \\frac{U \\Delta t}{\\Delta x},\n$$\nand the diffusion number\n$$\ns = \\frac{\\kappa \\Delta t}{\\Delta x^2},\n$$\nboth dimensionless.\n\nFrom a nondimensional discrete balance, derive the update and identify the coefficients (weights) multiplying $c_{i-1}^n$, $c_i^n$, and $c_{i+1}^n$. By requiring the update to be a convex combination of $c_{i-1}^n$, $c_i^n$, and $c_{i+1}^n$ (that is, all weights are nonnegative and sum to one), justify the monotonicity constraint\n$$\nPe_g \\le 2, \\quad Pe_g := \\frac{|U| \\Delta x}{\\kappa},\n$$\ntogether with any additional constraints that arise on $s$ and $\\lambda$. The quantity $Pe_g$ is the grid Péclet number and is dimensionless.\n\nYou must implement a program that, for a given set of physical parameters, evaluates the grid Péclet number $Pe_g$, checks the inequality $Pe_g \\le 2$, verifies the diffusion number constraint that arises from the convex-combination requirement, and determines whether the explicit central-difference update is monotone for that case by checking all weights are nonnegative. All outputs are dimensionless numbers or booleans.\n\nPhysical units to be used:\n- $U$ in meters per second (m/s).\n- $\\Delta x$ in meters (m).\n- $\\kappa$ in square meters per second (m$^2$/s).\n- $\\Delta t$ in seconds (s).\n\nYour program must produce results for the following test suite, each specified as $(U, \\Delta x, \\kappa, \\Delta t)$ using the units above:\n- Test 1: $(U, \\Delta x, \\kappa, \\Delta t) = (0.1, 10.0, 0.5, 60.0)$.\n- Test 2: $(U, \\Delta x, \\kappa, \\Delta t) = (0.05, 10.0, 0.5, 98.0)$.\n- Test 3: $(U, \\Delta x, \\kappa, \\Delta t) = (0.5, 10.0, 0.5, 50.0)$.\n- Test 4: $(U, \\Delta x, \\kappa, \\Delta t) = (-0.1, 20.0, 1.0, 160.0)$.\n- Test 5: $(U, \\Delta x, \\kappa, \\Delta t) = (0.2, 5.0, 0.5, 25.0)$.\n\nFor each test case, compute:\n1. The grid Péclet number $Pe_g = \\frac{|U| \\Delta x}{\\kappa}$, reported as a float rounded to six decimal places.\n2. A boolean indicating whether $Pe_g \\le 2$ holds.\n3. A boolean indicating whether the diffusion number constraint identified from the convex-combination requirement holds (report the constraint you derived as a boolean check on $s$).\n4. A boolean indicating whether the explicit central-difference update is monotone, determined by checking all three weights computed from the nondimensional discrete balance are nonnegative.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a list of the form $[Pe_g,\\mathrm{cond\\_Pe},\\mathrm{cond\\_s},\\mathrm{mono}]$. For example, the output should look like\n$$\n[\\,[Pe_g^{(1)},\\mathrm{cond\\_Pe}^{(1)},\\mathrm{cond\\_s}^{(1)},\\mathrm{mono}^{(1)}],\\,[Pe_g^{(2)},\\mathrm{cond\\_Pe}^{(2)},\\mathrm{cond\\_s}^{(2)},\\mathrm{mono}^{(2)}],\\,\\dots\\,].\n$$",
            "solution": "The problem is valid as it is scientifically grounded in the principles of transport phenomena and numerical analysis, well-posed with sufficient information for a unique solution, and objectively stated.\n\nWe begin with the one-dimensional advection–diffusion equation for a passive tracer concentration $c(x, t)$:\n$$\n\\frac{\\partial c}{\\partial t} + U \\frac{\\partial c}{\\partial x} = \\kappa \\frac{\\partial^2 c}{\\partial x^2}\n$$\nHere, $U$ is a constant velocity and $\\kappa$ is a constant diffusivity. We discretize this equation on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. Let $c_i^n$ denote the numerical approximation of $c(x_i, t_n)$, where $x_i = i \\Delta x$ and $t_n = n \\Delta t$.\n\nThe problem specifies using a forward-Euler scheme for the time derivative and second-order central differences for the spatial derivatives. The approximations at grid point $(i, n)$ are:\n\\begin{itemize}\n    \\item Time derivative (forward difference): $\\frac{\\partial c}{\\partial t} \\approx \\frac{c_i^{n+1} - c_i^n}{\\Delta t}$\n    \\item Advection term (central difference): $\\frac{\\partial c}{\\partial x} \\approx \\frac{c_{i+1}^n - c_{i-1}^n}{2 \\Delta x}$\n    \\item Diffusion term (central difference): $\\frac{\\partial^2 c}{\\partial x^2} \\approx \\frac{c_{i+1}^n - 2c_i^n + c_{i-1}^n}{\\Delta x^2}$\n\\end{itemize}\n\nSubstituting these approximations into the governing PDE yields the discrete equation:\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} + U \\left( \\frac{c_{i+1}^n - c_{i-1}^n}{2 \\Delta x} \\right) = \\kappa \\left( \\frac{c_{i+1}^n - 2c_i^n + c_{i-1}^n}{\\Delta x^2} \\right)\n$$\n\nTo derive the update rule for $c_i^{n+1}$, we solve for this term:\n$$\nc_i^{n+1} = c_i^n - \\frac{U \\Delta t}{2 \\Delta x}(c_{i+1}^n - c_{i-1}^n) + \\frac{\\kappa \\Delta t}{\\Delta x^2}(c_{i+1}^n - 2c_i^n + c_{i-1}^n)\n$$\n\nNow, we introduce the dimensionless Courant–Friedrichs–Lewy (CFL) number, $\\lambda$, and the diffusion number, $s$:\n$$\n\\lambda = \\frac{U \\Delta t}{\\Delta x}, \\quad s = \\frac{\\kappa \\Delta t}{\\Delta x^2}\n$$\nSubstituting these into the update rule gives:\n$$\nc_i^{n+1} = c_i^n - \\frac{\\lambda}{2}(c_{i+1}^n - c_{i-1}^n) + s(c_{i+1}^n - 2c_i^n + c_{i-1}^n)\n$$\n\nTo identify the coefficients (weights) for $c_{i-1}^n$, $c_i^n$, and $c_{i+1}^n$, we group the terms:\n$$\nc_i^{n+1} = (s + \\frac{\\lambda}{2})c_{i-1}^n + (1 - 2s)c_i^n + (s - \\frac{\\lambda}{2})c_{i+1}^n\n$$\nThe weights are therefore:\n\\begin{itemize}\n    \\item Weight for $c_{i-1}^n$: $w_{i-1} = s + \\frac{\\lambda}{2}$\n    \\item Weight for $c_i^n$: $w_i = 1 - 2s$\n    \\item Weight for $c_{i+1}^n$: $w_{i+1} = s - \\frac{\\lambda}{2}$\n\\end{itemize}\n\nThe problem requires the update to be a convex combination of $c_{i-1}^n$, $c_i^n$, and $c_{i+1}^n$. This means the weights must be non-negative and their sum must be equal to one. Physically, this ensures that the new concentration $c_i^{n+1}$ is a weighted average of the concentrations at the previous time step, which prevents the creation of new, unphysical local extrema (a property known as monotonicity).\n\nFirst, let's check if the weights sum to one:\n$$\nw_{i-1} + w_i + w_{i+1} = \\left(s + \\frac{\\lambda}{2}\\right) + (1 - 2s) + \\left(s - \\frac{\\lambda}{2}\\right) = (s - 2s + s) + \\left(\\frac{\\lambda}{2} - \\frac{\\lambda}{2}\\right) + 1 = 1\n$$\nThe sum is always one, so this condition is automatically satisfied.\n\nNext, we enforce the non-negativity of each weight to ensure monotonicity:\n1.  $w_i = 1 - 2s \\ge 0 \\implies 2s \\le 1 \\implies s \\le \\frac{1}{2}$. This is the identified constraint on the diffusion number $s$.\n2.  $w_{i-1} = s + \\frac{\\lambda}{2} \\ge 0 \\implies s \\ge -\\frac{\\lambda}{2}$\n3.  $w_{i+1} = s - \\frac{\\lambda}{2} \\ge 0 \\implies s \\ge \\frac{\\lambda}{2}$\n\nCombining the second and third conditions, we must have $s \\ge |\\frac{\\lambda}{2}|$. These two conditions, $s \\le 1/2$ and $s \\ge |\\lambda/2|$, together define the stability and monotonicity region for this scheme.\n\nThe problem asks to justify the monotonicity constraint $Pe_g \\le 2$. Let's analyze the condition $s \\ge |\\frac{\\lambda}{2}|$. We substitute the definitions of $s$ and $\\lambda$:\n$$\n\\frac{\\kappa \\Delta t}{\\Delta x^2} \\ge \\left| \\frac{U \\Delta t}{2 \\Delta x} \\right|\n$$\nSince $\\Delta t  0$ and $\\Delta x  0$, we can multiply the inequality by the positive quantity $\\frac{2\\Delta x^2}{\\Delta t}$ without changing its direction:\n$$\n2\\kappa \\ge |U| \\Delta x\n$$\nAssuming a non-zero diffusivity $\\kappa  0$, we can divide by $\\kappa$:\n$$\n2 \\ge \\frac{|U| \\Delta x}{\\kappa}\n$$\nThe term on the right is the definition of the grid Péclet number, $Pe_g$. Thus, we have derived the constraint:\n$$\nPe_g \\le 2\n$$\nThis constraint ensures that the weights for the neighboring points $c_{i-1}^n$ and $c_{i+1}^n$ are non-negative, provided that advection does not overwhelm diffusion at the grid scale.\n\nIn summary, for the explicit central-difference scheme to be monotone, all three weights must be non-negative. This is mathematically equivalent to satisfying two conditions simultaneously:\n\\begin{enumerate}\n    \\item The diffusion number constraint: $s = \\frac{\\kappa \\Delta t}{\\Delta x^2} \\le \\frac{1}{2}$\n    \\item The grid Péclet number constraint: $Pe_g = \\frac{|U| \\Delta x}{\\kappa} \\le 2$\n\\end{enumerate}\n\nThe program will compute $Pe_g$, check both of these constraints, and also directly check the non-negativity of all three weights to determine if the update is monotone for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the monotonicity of an explicit central-difference scheme\n    for the advection-diffusion equation.\n    \"\"\"\n    # Test cases: (U, delta_x, kappa, delta_t)\n    test_cases = [\n        (0.1, 10.0, 0.5, 60.0),\n        (0.05, 10.0, 0.5, 98.0),\n        (0.5, 10.0, 0.5, 50.0),\n        (-0.1, 20.0, 1.0, 160.0),\n        (0.2, 5.0, 0.5, 25.0)\n    ]\n\n    all_results = []\n    for U, dx, kappa, dt in test_cases:\n        # Prevent division by zero if parameters are non-physical\n        if dx == 0 or kappa == 0:\n            # Append an error state or skip, though problem constraints imply valid inputs.\n            # For robustness, we can handle it, but for this problem, it's not expected.\n            continue\n        \n        # 1. Calculate dimensionless numbers\n        # Courant-Friedrichs-Lewy (CFL) number\n        lambda_val = (U * dt) / dx\n        # Diffusion number\n        s = (kappa * dt) / (dx**2)\n        # Grid Péclet number\n        Pe_g = (abs(U) * dx) / kappa\n        \n        # 2. Calculate weights for the update scheme\n        # c_i^{n+1} = w_{i-1}*c_{i-1}^n + w_i*c_i^n + w_{i+1}*c_{i+1}^n\n        w_im1 = s + lambda_val / 2\n        w_i = 1 - 2 * s\n        w_ip1 = s - lambda_val / 2\n        \n        # 3. Perform the required checks\n        # a. Grid Péclet number, rounded to six decimal places\n        Pe_g_val = round(Pe_g, 6)\n        \n        # b. Check if Pe_g = 2\n        cond_Pe = Pe_g = 2\n        \n        # c. Check the derived diffusion number constraint: s = 1/2\n        cond_s = s = 0.5\n        \n        # d. Check for monotonicity: all weights must be non-negative\n        # Use a small tolerance for floating-point comparisons to zero\n        tol = 1e-12\n        is_monotone = (w_im1 = -tol) and (w_i = -tol) and (w_ip1 = -tol)\n        \n        # 4. Store the results for this case\n        case_result = [Pe_g_val, cond_Pe, cond_s, is_monotone]\n        all_results.append(case_result)\n\n    # 5. Format the final output string exactly as required\n    formatted_cases = []\n    for r in all_results:\n        # Each boolean should be 'True' or 'False' (default str representation)\n        # The float format should be standard.\n        formatted_cases.append(f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\")\n    \n    final_output_str = f\"[{','.join(formatted_cases)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}