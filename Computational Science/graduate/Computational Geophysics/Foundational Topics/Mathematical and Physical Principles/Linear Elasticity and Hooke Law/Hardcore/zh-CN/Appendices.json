{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固胡克定律的核心概念，即将抽象的应力与应变张量同材料常数联系起来。通过从一个简单的单轴应力状态出发，你将推导出完整的三维应变张量，从而加深对杨氏模量 $E$ 和泊松比 $\\nu$ 物理意义的理解。这项基础实践是掌握各向同性线弹性本构关系的关键一步 。",
            "id": "3607902",
            "problem": "在计算地球物理学中，实验室单轴加载实验被用于标定地球材料的弹性参数。这些材料在小应变下被建模为均匀、各向同性且线性弹性的。考虑一个无限大的均匀、各向同性、线性弹性体，其处于一个均匀、静态的 Cauchy 应力状态下，由 $\\boldsymbol{\\sigma}(\\boldsymbol{x}) = \\sigma_{0}\\,\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1}$ 给出，其中 $\\sigma_{0}$ 是一个常数标量，$\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$ 是一组标准正交基。假设无穷小运动学，因此小应变张量 $\\boldsymbol{\\varepsilon}$ 通过一个各向同性的四阶柔度张量与 $\\boldsymbol{\\sigma}$ 线性相关，该柔度张量仅由 Young 氏模量 $E$ 和 Poisson 比 $\\nu$ 表征。\n\n从小时变和 Cauchy 应力的定义、本构映射的线性以及各向同性四阶张量的旋转不变性出发，推导在给定单轴应力下，应变张量 $\\boldsymbol{\\varepsilon}$ 在基 $\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$ 中的显式 $3\\times 3$ 分量矩阵。用 $\\sigma_{0}$、$E$ 和 $\\nu$ 完全表示您的最终结果。将最终答案以完整的 $3\\times 3$ 矩阵形式呈现。不需要进行数值四舍五入，最终矩阵中不应包含单位。",
            "solution": "该问题设定是静态且空间均匀的，因此在此计算中，平衡方程不会在场中引入空间梯度。我们采用无穷小运动学，因此小应变张量 $\\boldsymbol{\\varepsilon}$ 通过一个四阶柔度张量 $\\mathsf{S}$ 与 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 线性相关：\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\mathsf{S} : \\boldsymbol{\\sigma},\n$$\n其中 $:$ 表示双点积。对于各向同性材料，旋转不变性约束了任何将对称二阶张量映射到对称二阶张量的线性四阶张量都具有以下形式\n$$\n\\mathsf{S} \\;=\\; \\alpha\\,\\mathsf{I}_{4}^{\\mathrm{s}} + \\beta\\,\\boldsymbol{I}\\otimes\\boldsymbol{I},\n$$\n其中 $\\mathsf{I}_{4}^{\\mathrm{s}}$ 是对称四阶单位张量，其分量为 $\\left(\\mathsf{I}_{4}^{\\mathrm{s}}\\right)_{ijkl} = \\tfrac{1}{2}\\left(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}\\right)$，$\\boldsymbol{I}$ 是二阶单位张量，其分量为 $I_{ij}=\\delta_{ij}$，而 $\\alpha, \\beta$ 是由材料参数决定的标量。使用体积投影算子和偏量投影算子来重构此表达式会很方便。定义体积投影算子 $\\mathsf{J} = \\tfrac{1}{3}\\,\\boldsymbol{I}\\otimes\\boldsymbol{I}$ 和偏量投影算子 $\\mathsf{K} = \\mathsf{I}_{4}^{\\mathrm{s}} - \\mathsf{J}$。对于各向同性线弹性，柔度张量有如下标准分解形式\n$$\n\\mathsf{S} \\;=\\; \\frac{1}{2G}\\,\\mathsf{K} \\;+\\; \\frac{1}{9K_{\\mathrm{b}}}\\,\\mathsf{J},\n$$\n其中 $G$ 是剪切模量，$K_{\\mathrm{b}}$ 是体积模量。这些投影算子作用于任意对称张量 $\\boldsymbol{A}$ 时，得到 $\\mathsf{K}:\\boldsymbol{A} = \\boldsymbol{A} - \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{A})\\,\\boldsymbol{I}$（偏量部分）和 $\\mathsf{J}:\\boldsymbol{A} = \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{A})\\,\\boldsymbol{I}$（球量部分）。因此，对于应力，\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\frac{1}{2G}\\left(\\boldsymbol{\\sigma} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}\\right) \\;+\\; \\frac{1}{9K_{\\mathrm{b}}}\\,\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}.\n$$\n为了用 Young 氏模量 $E$ 和 Poisson 比 $\\nu$ 来表示，我们使用经过充分验证的关系式\n$$\nG \\;=\\; \\frac{E}{2(1+\\nu)}, \\qquad K_{\\mathrm{b}} \\;=\\; \\frac{E}{3(1-2\\nu)}.\n$$\n因此，\n$$\n\\frac{1}{2G} \\;=\\; \\frac{1+\\nu}{E}, \\qquad \\frac{1}{9K_{\\mathrm{b}}} \\;=\\; \\frac{1-2\\nu}{3E}.\n$$\n将这些代入柔度分解式中并合并球量项，得到\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\frac{1+\\nu}{E}\\,\\boldsymbol{\\sigma} \\;-\\; \\frac{\\nu}{E}\\,\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}.\n$$\n实际上，\n$$\n\\frac{1+\\nu}{E}\\left(-\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}\\right) \\;+\\; \\frac{1-2\\nu}{3E}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I} \\;=\\; -\\frac{\\nu}{E}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}.\n$$\n\n现在应用给定的单轴应力状态 $\\boldsymbol{\\sigma} = \\sigma_{0}\\,\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1}$，其迹为 $\\operatorname{tr}(\\boldsymbol{\\sigma}) = \\sigma_{0}$。代入可得\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\frac{1+\\nu}{E}\\,\\sigma_{0}\\,\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1} \\;-\\; \\frac{\\nu}{E}\\,\\sigma_{0}\\,\\boldsymbol{I}.\n$$\n在基 $\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$ 中，单位张量是主对角线元素为 $\\left(1,1,1\\right)$ 的对角矩阵，而 $\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1}$ 是主对角线元素为 $\\left(1,0,0\\right)$ 的对角矩阵。因此，\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\begin{pmatrix}\n\\dfrac{1+\\nu}{E}\\sigma_{0} - \\dfrac{\\nu}{E}\\sigma_{0} & 0 & 0 \\\\\n0 & - \\dfrac{\\nu}{E}\\sigma_{0} & 0 \\\\\n0 & 0 & - \\dfrac{\\nu}{E}\\sigma_{0}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\dfrac{\\sigma_{0}}{E} & 0 & 0 \\\\\n0 & - \\dfrac{\\nu\\,\\sigma_{0}}{E} & 0 \\\\\n0 & 0 & - \\dfrac{\\nu\\,\\sigma_{0}}{E}\n\\end{pmatrix}.\n$$\n这表明纵向正应变为 $\\varepsilon_{11} = \\sigma_{0}/E$，横向正应变为 $\\varepsilon_{22} = \\varepsilon_{33} = -\\nu\\,\\sigma_{0}/E$，所有剪切分量均为 $0$，这与单轴加载下 Young 氏模量和 Poisson 比的定义一致。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{\\sigma_{0}}{E} & 0 & 0 \\\\[6pt] 0 & -\\dfrac{\\nu\\,\\sigma_{0}}{E} & 0 \\\\[6pt] 0 & 0 & -\\dfrac{\\nu\\,\\sigma_{0}}{E}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在计算地球物理学中，为了提高效率，常将三维问题简化为二维模型。本练习探讨了两种最常见的简化假设——平面应力与平面应变——的理论基础与实际影响。通过推导这些简化模型并量化其在特定约束下的误差，你将学会如何批判性地评估这些强大近似方法的适用范围 。",
            "id": "3607937",
            "problem": "考虑一个占据 $x$–$y$ 平面内地质横截面的均匀、各向同性、线性弹性固体，其变形为小变形且处于静力平衡状态（无体力）。您将推导三维线性弹性理论在二维假设下的简化形式，然后量化在存在平面外约束时，使用这些假设来近似平面外响应所产生的建模误差。\n\n从无体力情况下的线性动量平衡原理、小应变的定义以及三维各向同性线性弹性响应（胡克定律）的形式出发，完成以下任务：\n\n1) 针对平面应力（假设 $ \\sigma_{zz} = 0 $）和平面应变（假设 $ \\varepsilon_{zz} = 0 $），推导简化的二维本构关系。该关系需用平面内的应力和应变分量以及材料参数（杨氏模量 $ E $ 和泊松比 $ \\nu $）表示。您的推导必须仅从第一性原理出发。\n\n2) 建立一个平面外约束模型，该模型对平面外应变呈线性响应，其单位面积的有效刚度为 $ K $（单位为压力），并施加一个形式为 $ \\sigma_{zz} + K \\, \\varepsilon_{zz} = 0 $ 的本构闭合关系。对于空间均匀应变状态，将此闭合关系与三维各向同性线性弹性理论结合使用，以消去 $ \\varepsilon_{zz} $ 和 $ \\sigma_{zz} $，并用平面内应变 $ \\varepsilon_{xx} $ 和 $ \\varepsilon_{yy} $ 来表示。将 $ \\varepsilon_{zz} $ 和 $ \\sigma_{zz} $ 表示为 $ E $、$ \\nu $、$ K $ 以及平面内应变迹 $ \\varepsilon_{xx} + \\varepsilon_{yy} $ 的函数。\n\n3) 对于给定的平面内均匀应变状态，定义以下建模误差：\n- 平面应力模型误差：$ \\Delta \\sigma_{zz}^{\\mathrm{ps}} = \\sigma_{zz}^{\\mathrm{ps}} - \\sigma_{zz}^{\\mathrm{true}} $ 和 $ \\Delta \\varepsilon_{zz}^{\\mathrm{ps}} = \\varepsilon_{zz}^{\\mathrm{ps}} - \\varepsilon_{zz}^{\\mathrm{true}} $。\n- 平面应变模型误差：$ \\Delta \\sigma_{zz}^{\\mathrm{pe}} = \\sigma_{zz}^{\\mathrm{pe}} - \\sigma_{zz}^{\\mathrm{true}} $ 和 $ \\Delta \\varepsilon_{zz}^{\\mathrm{pe}} = \\varepsilon_{zz}^{\\mathrm{pe}} - \\varepsilon_{zz}^{\\mathrm{true}} $。\n\n此处，$ (\\cdot)^{\\mathrm{true}} $ 表示使用平面外约束 $ \\sigma_{zz} + K \\, \\varepsilon_{zz} = 0 $ 得到的解，$ (\\cdot)^{\\mathrm{ps}} $ 表示平面应力假设，$ (\\cdot)^{\\mathrm{pe}} $ 表示平面应变假设。\n\n4) 实现一个程序，为以下参数集测试套件计算上述四个误差量。每个参数集以元组 $ (E, \\nu, \\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}, K) $ 的形式给出，其中 $ E $ 和 $ K $ 的单位为吉帕斯卡 (GPa)，应变为无量纲：\n- 测试 $ 1 $ (平面外自由，平面应力为精确解的边界情况): $ (50, \\, 0.25, \\, 1\\times 10^{-4}, \\, 2\\times 10^{-4}, \\, 5\\times 10^{-5}, \\, 0) $。\n- 测试 $ 2 $ (平面外刚度非常大，接近平面应变): $ (70, \\, 0.33, \\, 1\\times 10^{-5}, \\, 3\\times 10^{-5}, \\, 0, \\, 10^{5}) $。\n- 测试 $ 3 $ (平面内体积应变为零，两者均为精确解的边界情况): $ (25, \\, 0.20, \\, 1\\times 10^{-4}, \\, -1\\times 10^{-4}, \\, 1\\times 10^{-5}, \\, 10) $。\n- 测试 $ 4 $ (中等部分约束): $ (40, \\, 0.30, \\, 2\\times 10^{-4}, \\, 1\\times 10^{-4}, \\, 2\\times 10^{-5}, \\, 40) $。\n\n您的程序必须：\n- 使用 $ 1 \\, \\mathrm{GPa} = 10^{9} \\, \\mathrm{Pa} $ 将 $ E $ 和 $ K $ 从吉帕斯卡 (GPa) 转换为帕斯卡 (Pa)。\n- 对于均匀状态，仅使用平面内应变迹 $ \\varepsilon_{xx} + \\varepsilon_{yy} $ 来计算 $ \\varepsilon_{zz} $ 和 $ \\sigma_{zz} $，因为在所述假设下，各向同性线性弹性理论中所有其他平面内分量均不影响 $ \\sigma_{zz} $ 或 $ \\varepsilon_{zz} $。\n- 将应力误差 $ \\Delta \\sigma_{zz}^{\\mathrm{ps}} $ 和 $ \\Delta \\sigma_{zz}^{\\mathrm{pe}} $ 以兆帕斯卡 (MPa) 表示，并将应变误差 $ \\Delta \\varepsilon_{zz}^{\\mathrm{ps}} $ 和 $ \\Delta \\varepsilon_{zz}^{\\mathrm{pe}} $ 表示为无量纲数。\n- 将报告的每个数字四舍五入到小数点后六位。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按以下顺序附加四个值：\n$ [ \\Delta \\sigma_{zz}^{\\mathrm{ps}} \\, (\\mathrm{MPa}), \\, \\Delta \\varepsilon_{zz}^{\\mathrm{ps}}, \\, \\Delta \\sigma_{zz}^{\\mathrm{pe}} \\, (\\mathrm{MPa}), \\, \\Delta \\varepsilon_{zz}^{\\mathrm{pe}} ] $，\n使得最后一行包含 $ 4 \\times 4 = 16 $ 个数字，按上面列出的顺序对应四个测试用例。例如，输出应类似于 $ [r_{1}, r_{2}, \\dots, r_{16}] $，其中每个 $ r_{i} $ 是按规定四舍五入的浮点数。",
            "solution": "所有推导的出发点是均匀、各向同性、线性弹性材料的三维胡克定律，该定律使用杨氏模量 $E$ 和泊松比 $\\nu$ 将应变张量分量 $\\varepsilon_{ij}$ 与应力张量分量 $\\sigma_{ij}$ 联系起来。相关的应变-应力方程为：\n$$ \\varepsilon_{xx} = \\frac{1}{E} [ \\sigma_{xx} - \\nu (\\sigma_{yy} + \\sigma_{zz}) ] $$\n$$ \\varepsilon_{yy} = \\frac{1}{E} [ \\sigma_{yy} - \\nu (\\sigma_{xx} + \\sigma_{zz}) ] $$\n$$ \\varepsilon_{zz} = \\frac{1}{E} [ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) ] $$\n剪应变 $\\gamma_{xy} = 2\\varepsilon_{xy}$ 与剪应力 $\\sigma_{xy}$ 的关系为 $\\sigma_{xy} = G \\gamma_{xy}$，其中 $G = \\frac{E}{2(1+\\nu)}$ 是剪切模量。对于各向同性材料，正应力分量与剪应变分量是解耦的。因此，$ \\sigma_{zz} $ 和 $ \\varepsilon_{zz} $ 与 $ \\gamma_{xy} $ 无关。\n\n另一种通常更直接的表述是使用拉梅参数 $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu=G$。应力-应变关系由 $\\sigma_{ij} = \\lambda \\varepsilon_v \\delta_{ij} + 2\\mu \\varepsilon_{ij}$ 给出，其中 $\\varepsilon_v = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$ 是体积应变，$\\delta_{ij}$ 是克罗内克符号。\n\n**1. 二维本构关系的推导**\n\n**平面应力：** 平面应力假设为 $\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$。我们关心的是平面外的法向分量。假设为 $\\sigma_{zz} = 0$。将此代入三维胡克定律中关于 $\\varepsilon_{zz}$ 的方程，可得：\n$$ \\varepsilon_{zz} = -\\frac{\\nu}{E}(\\sigma_{xx} + \\sigma_{yy}) $$\n为找到平面内应力与应变之间的本构关系，我们首先在 $\\sigma_{zz}=0$ 的条件下，根据平面内应变方程求解应力：\n$$ \\varepsilon_{xx} = \\frac{1}{E} (\\sigma_{xx} - \\nu \\sigma_{yy}) $$\n$$ \\varepsilon_{yy} = \\frac{1}{E} (\\sigma_{yy} - \\nu \\sigma_{xx}) $$\n求解该线性方程组得到关于 $\\sigma_{xx}$ 和 $\\sigma_{yy}$ 的解，即平面应力本构法则：\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2}(\\varepsilon_{xx} + \\nu\\varepsilon_{yy}) $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2}(\\varepsilon_{yy} + \\nu\\varepsilon_{xx}) $$\n为确定给定平面内应变状态 $(\\varepsilon_{xx}, \\varepsilon_{yy})$ 下的平面外应变 $\\varepsilon_{zz}^{\\mathrm{ps}}$，我们将以上两个方程相加，求得平面内应力之和：\n$$ \\sigma_{xx} + \\sigma_{yy} = \\frac{E}{1-\\nu^2}( (1+\\nu)\\varepsilon_{xx} + (1+\\nu)\\varepsilon_{yy} ) = \\frac{E}{1-\\nu}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n将此代入 $\\varepsilon_{zz}$ 的表达式，可得平面应力假设下的平面外法向应变：\n$$ \\varepsilon_{zz}^{\\mathrm{ps}} = -\\frac{\\nu}{E} \\left( \\frac{E}{1-\\nu}(\\varepsilon_{xx} + \\varepsilon_{yy}) \\right) = -\\frac{\\nu}{1-\\nu}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n\n**平面应变：** 平面应变假设为 $\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0$。条件是 $\\varepsilon_{zz} = 0$。这意味着可能需要一个非零应力 $\\sigma_{zz}$ 来将应变保持为零。根据三维胡克定律中关于 $\\varepsilon_{zz}$ 的方程：\n$$ 0 = \\frac{1}{E} [ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) ] \\implies \\sigma_{zz} = \\nu (\\sigma_{xx} + \\sigma_{yy}) $$\n这表明 $\\sigma_{zz}$ 通常不为零。为找到平面应变本构法则，我们使用拉梅参数的表述，这样更直接。当 $\\varepsilon_{zz}=0$ 时，体积应变为 $\\varepsilon_v = \\varepsilon_{xx} + \\varepsilon_{yy}$。应力为：\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + 2\\mu\\varepsilon_{xx} $$\n$$ \\sigma_{yy} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + 2\\mu\\varepsilon_{yy} $$\n将用 $E$ 和 $\\nu$ 表示的 $\\lambda$ 和 $\\mu$ 的表达式代入，得到关系式：\n$$ \\sigma_{xx} = \\frac{E}{(1+\\nu)(1-2\\nu)}[(1-\\nu)\\varepsilon_{xx} + \\nu\\varepsilon_{yy}] $$\n$$ \\sigma_{yy} = \\frac{E}{(1+\\nu)(1-2\\nu)}[(1-\\nu)\\varepsilon_{yy} + \\nu\\varepsilon_{xx}] $$\n平面外应力 $\\sigma_{zz}^{\\mathrm{pe}}$ 可从关系式 $\\sigma_{zz} = \\lambda \\varepsilon_v$ 中求得：\n$$ \\sigma_{zz}^{\\mathrm{pe}} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n\n**2. 平面外约束模型的推导**\n\n这个我们用上标 $(\\cdot)^{\\mathrm{true}}$ 表示的模型，由约束条件 $\\sigma_{zz} + K \\varepsilon_{zz} = 0$ 定义，其中 $K$ 是一个有效刚度。\n我们将此约束与三维应力-应变法则中关于 $\\sigma_{zz}$ 的方程结合使用：\n$$ \\sigma_{zz} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu\\varepsilon_{zz} $$\n代入 $\\sigma_{zz} = -K\\varepsilon_{zz}$：\n$$ -K\\varepsilon_{zz} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + (\\lambda+2\\mu)\\varepsilon_{zz} $$\n我们求解 $\\varepsilon_{zz}$：\n$$ -(\\lambda(\\varepsilon_{xx} + \\varepsilon_{yy})) = (K + \\lambda + 2\\mu)\\varepsilon_{zz} $$\n$$ \\varepsilon_{zz}^{\\mathrm{true}} = -\\frac{\\lambda}{K + \\lambda+2\\mu}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n为用 $E$、$\\nu$ 和 $K$ 表示，我们代入 $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\lambda+2\\mu = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}$：\n$$ \\varepsilon_{zz}^{\\mathrm{true}} = -\\frac{\\frac{E\\nu}{(1+\\nu)(1-2\\nu)}}{K + \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n分子和分母同乘以 $(1+\\nu)(1-2\\nu)$ 可将其简化为：\n$$ \\varepsilon_{zz}^{\\mathrm{true}} = -\\frac{E\\nu}{K(1+\\nu)(1-2\\nu) + E(1-\\nu)}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n相应的平面外应力可从约束条件中求得：\n$$ \\sigma_{zz}^{\\mathrm{true}} = -K\\varepsilon_{zz}^{\\mathrm{true}} = \\frac{KE\\nu}{K(1+\\nu)(1-2\\nu) + E(1-\\nu)}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n\n**3. 建模误差计算**\n\n现在我们得到了所有必要的表达式。令 $\\varepsilon_{trace} = \\varepsilon_{xx} + \\varepsilon_{yy}$。三种模型的平面外物理量为：\n**真实模型：**\n$$ \\sigma_{zz}^{\\mathrm{true}} = \\frac{KE\\nu}{K(1+\\nu)(1-2\\nu) + E(1-\\nu)} \\varepsilon_{trace} $$\n$$ \\varepsilon_{zz}^{\\mathrm{true}} = -\\frac{E\\nu}{K(1+\\nu)(1-2\\nu) + E(1-\\nu)} \\varepsilon_{trace} $$\n**平面应力模型：**\n$$ \\sigma_{zz}^{\\mathrm{ps}} = 0 $$\n$$ \\varepsilon_{zz}^{\\mathrm{ps}} = -\\frac{\\nu}{1-\\nu} \\varepsilon_{trace} $$\n**平面应变模型：**\n$$ \\sigma_{zz}^{\\mathrm{pe}} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} \\varepsilon_{trace} $$\n$$ \\varepsilon_{zz}^{\\mathrm{pe}} = 0 $$\n\n建模误差计算如下：\n- $\\Delta \\sigma_{zz}^{\\mathrm{ps}} = \\sigma_{zz}^{\\mathrm{ps}} - \\sigma_{zz}^{\\mathrm{true}} = -\\sigma_{zz}^{\\mathrm{true}}$\n- $\\Delta \\varepsilon_{zz}^{\\mathrm{ps}} = \\varepsilon_{zz}^{\\mathrm{ps}} - \\varepsilon_{zz}^{\\mathrm{true}}$\n- $\\Delta \\sigma_{zz}^{\\mathrm{pe}} = \\sigma_{zz}^{\\mathrm{pe}} - \\sigma_{zz}^{\\mathrm{true}}$\n- $\\Delta \\varepsilon_{zz}^{\\mathrm{pe}} = \\varepsilon_{zz}^{\\mathrm{pe}} - \\varepsilon_{zz}^{\\mathrm{true}} = -\\varepsilon_{zz}^{\\mathrm{true}}$\n\n将实施这些公式来计算指定测试用例的误差。材料参数 $E$ 和 $K$ 从 GPa 转换为 Pa ($1\\,\\mathrm{GPa} = 10^9\\,\\mathrm{Pa}$)，所得应力误差转换为 MPa ($1\\,\\mathrm{MPa} = 10^6\\,\\mathrm{Pa}$) 以便报告。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes modeling errors for plane stress and plane strain assumptions\n    relative to a more general out-of-plane constraint model in linear elasticity.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (E, nu, eps_xx, eps_yy, gam_xy, K)\n    # E and K are in GPa, strains are dimensionless.\n    test_cases = [\n        (50.0, 0.25, 1e-4, 2e-4, 5e-5, 0.0),      # Test 1: Plane stress case\n        (70.0, 0.33, 1e-5, 3e-5, 0.0, 1e5),       # Test 2: Near plane strain case\n        (25.0, 0.20, 1e-4, -1e-4, 1e-5, 10.0),    # Test 3: Zero in-plane volumetric strain\n        (40.0, 0.30, 2e-4, 1e-4, 2e-5, 40.0),     # Test 4: Moderate constraint\n    ]\n\n    all_results = []\n    \n    # Conversion factors\n    GPA_TO_PA = 1e9\n    PA_TO_MPA = 1e-6\n\n    for case in test_cases:\n        E_gpa, nu, eps_xx, eps_yy, _, K_gpa = case\n        \n        # Convert units from GPa to Pa\n        E = E_gpa * GPA_TO_PA\n        K = K_gpa * GPA_TO_PA\n        \n        # In-plane strain trace\n        eps_trace = eps_xx + eps_yy\n\n        # --- Calculate quantities for the \"true\" model ---\n        # Denominator for the true model expressions\n        denom_true = K * (1 + nu) * (1 - 2 * nu) + E * (1 - nu)\n        \n        # Handle cases where denominator might be zero, though not expected here\n        if np.isclose(denom_true, 0):\n            # This would correspond to unphysical material properties\n            eps_zz_true = 0.0\n        else:\n            eps_zz_true = - (E * nu * eps_trace) / denom_true\n        \n        sig_zz_true = -K * eps_zz_true\n\n        # --- Calculate quantities for the plane stress (ps) model ---\n        sig_zz_ps = 0.0\n        if np.isclose(1 - nu, 0): # nu = 1, unphysical\n            eps_zz_ps = 0.0\n        else:\n            eps_zz_ps = -nu / (1 - nu) * eps_trace\n\n        # --- Calculate quantities for the plane strain (pe) model ---\n        eps_zz_pe = 0.0\n        denom_pe = (1 + nu) * (1 - 2 * nu)\n        if np.isclose(denom_pe, 0): # nu = -1 or nu = 0.5, unphysical\n            sig_zz_pe = 0.0\n        else:\n            sig_zz_pe = (E * nu * eps_trace) / denom_pe\n            \n        # --- Calculate the four error quantities ---\n        # Plane-stress model errors\n        delta_sigma_zz_ps = (sig_zz_ps - sig_zz_true) * PA_TO_MPA # in MPa\n        delta_epsilon_zz_ps = eps_zz_ps - eps_zz_true           # dimensionless\n\n        # Plane-strain model errors\n        delta_sigma_zz_pe = (sig_zz_pe - sig_zz_true) * PA_TO_MPA # in MPa\n        delta_epsilon_zz_pe = eps_zz_pe - eps_zz_true           # dimensionless\n        \n        # Append results for the current test case\n        all_results.extend([delta_sigma_zz_ps, delta_epsilon_zz_ps, delta_sigma_zz_pe, delta_epsilon_zz_pe])\n\n    # Format results to six decimal places as required by the problem\n    formatted_results = [f\"{r:.6f}\" for r in all_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本项高级练习将带你从正演模拟跨越到更具挑战性的反演问题，这也是地球物理学的核心。你将学习并实践伴随状态法，这是一种在大规模优化问题中高效计算梯度的强大技术。通过推导并实现该方法，从位移数据中反演未知的体力分布，你将亲身体验现代地球物理反演的数学与算法基础 。",
            "id": "3607889",
            "problem": "您的任务是推导、离散化并实现伴随状态法，以最小化一维空间中静态、线性各向同性弹性力学的数据失配。请从计算地球物理学中适用于线性弹性和线性动量平衡的第一性原理出发。目标是在控制偏微分方程（PDE）约束下最小化数据失配泛函，并使用伴随梯度对分布式体力场执行一次梯度下降更新。所有输出必须以国际单位制（SI）表示。\n\n基本和控制方程：\n- 线性动量平衡（静态情况，无惯性）指出，应力张量的散度加上体力等于零：$$\\nabla \\cdot \\sigma(u) + f = 0.$$\n- 对于各向同性线性弹性，胡克定律关联了应力和应变。在一般维度下，$$\\sigma = \\lambda (\\nabla \\cdot u) I + 2 \\mu \\varepsilon(u),$$ 其中 $$\\varepsilon(u) = \\frac{1}{2}\\left( \\nabla u + (\\nabla u)^{\\top} \\right),$$ 拉梅参数为 $$\\lambda$$ 和 $$\\mu,$$ $$I$$ 是单位张量。\n- 在一维空间中，位移为标量 $$u(x),$$ 上述关系简化为 $$\\sigma(u) = (\\lambda + 2 \\mu) \\frac{du}{dx},$$ 因此 PDE 变为 $$\\frac{d}{dx}\\left( (\\lambda + 2 \\mu) \\frac{du}{dx} \\right) + f(x) = 0.$$\n- 假设参数 $$\\lambda$$ 和 $$\\mu$$ 在空间上是均匀的，并且在长度为 $$L$$ 的域上施加齐次狄利克雷边界条件 $$u(0) = 0$$ 和 $$u(L) = 0$$。\n\n目标：\n- 失配为 $$\\Phi(u) = \\frac{1}{2} \\| W(u - d) \\|^2,$$ 其中 $$W$$ 是一个对角加权算子，用于选择观测位置，$$d$$ 是观测到的位移。范数是标准的欧几里得范数。权重意味着 $$W^{\\top} W$$ 等于平方权重的对角矩阵。\n- 将体力 $$f(x)$$ 视为控制变量，通过伴随状态法进行一次梯度下降步骤来更新。状态变量是 $$u(x),$$ 受 PDE 约束。\n\n伴随状态推导要求：\n- 构建拉格朗日量 $$\\mathcal{L}(u, f, p) = \\Phi(u) + \\langle p, \\mathcal{A} u + f \\rangle,$$ 其中 $$\\mathcal{A} u = \\nabla \\cdot \\sigma(u)$$ 且 $$p(x)$$ 是伴随变量（拉格朗日乘子），内积 $$\\langle \\cdot, \\cdot \\rangle$$ 是标准的 $$L^2$$ 内积。\n- 通过对 $$u$$ 的平稳性推导伴随方程，并解释为什么在齐次狄利克雷边界条件下，伴随算子等于正演算子（自伴随性）。\n- 使用拉格朗日量推导 $$\\Phi$$ 相对于 $$f$$ 的梯度，并用伴随场表示其显式表达式。\n\n离散化要求：\n- 将域 $$[0, L]$$ 离散为 $$N$$ 个内部点，间距均匀 $$h = \\frac{L}{N + 1},$$ 在边界上强制施加齐次狄利克雷边界条件。\n- 使用二阶中心有限差分来离散化算子 $$\\mathcal{A} u = (\\lambda + 2 \\mu) \\frac{d^2 u}{dx^2},$$ 得到一个三对角矩阵 $$A \\in \\mathbb{R}^{N \\times N}$$，其中 $$A = \\frac{\\lambda + 2 \\mu}{h^2} \\operatorname{tridiag}(1, -2, 1).$$\n- 给定离散力 $$f \\in \\mathbb{R}^N,$$ 通过 $$A u = - f$$ 求解正演状态。设离散权重为 $$w_i \\ge 0$$ 并定义 $$W^{\\top} W$$ 为 $$\\operatorname{diag}(w_i^2).$$ 如果某个索引未被观测，则设置 $$w_i = 0$$ 和 $$d_i = 0.$$\n- 推导并实现伴随系统 $$A p = - W^{\\top} W (u - d),$$ 以及梯度 $$\\nabla_f \\Phi = p.$$\n- 对于给定的步长 $$\\alpha > 0,$$ 执行一次梯度下降更新 $$f_{\\text{new}} = f - \\alpha p$$，然后计算更新后的失配 $$\\Phi(u_{\\text{new}}) = \\frac{1}{2} \\sum_{i=1}^N w_i^2 (u_{\\text{new}, i} - d_i)^2.$$\n\n物理单位：\n- $$L$$ 必须以米（m）为单位。\n- $$\\lambda$$ 和 $$\\mu$$ 必须以帕斯卡（Pa）为单位。\n- $$f$$ 必须以牛顿每立方米（N/m^3）为单位。\n- $$u$$ 必须以米（m）为单位。\n- 最终失配 $$\\Phi(u)$$ 必须以平方米（m^2）报告，并打印为浮点数。不使用角度；不使用百分比。\n\n测试套件和程序输出格式：\n- 实现以下三个测试用例，每个用例在单次梯度下降更新后产生一个浮点失配值。您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3]”）。\n\n测试用例 1（一般情况）：\n- $$L = 1.0 \\text{ m}, \\quad N = 50.$$\n- $$\\lambda = 1.5 \\times 10^9 \\text{ Pa}, \\quad \\mu = 8.0 \\times 10^8 \\text{ Pa}.$$\n- 真实力 $$f_{\\text{true}}(x) = A \\exp\\left( - \\frac{(x - x_0)^2}{2 \\sigma^2} \\right)$$，其中 $$A = 1.0 \\times 10^6 \\text{ N/m}^3, \\quad x_0 = 0.5 \\text{ m}, \\quad \\sigma = 0.1 \\text{ m}.$$\n- 观测索引 $$\\{10, 25, 40\\}$$，权重 $$w_i = 1$$。其他地方 $$w_i = 0$$。\n- 数据 $$d_i$$ 等于由 $$f_{\\text{true}}$$ 在那些观测索引处生成的正演位移。初始力 $$f = 0$$。\n- 步长 $$\\alpha = 1.0 \\times 10^{-4}.$$\n\n测试用例 2（边界主导观测，刚性介质）：\n- $$L = 1.0 \\text{ m}, \\quad N = 50.$$\n- $$\\lambda = 3.0 \\times 10^{10} \\text{ Pa}, \\quad \\mu = 2.0 \\times 10^{10} \\text{ Pa}.$$\n- 真实力 $$f_{\\text{true}}(x) = A \\exp\\left( - \\frac{(x - x_0)^2}{2 \\sigma^2} \\right)$$，其中 $$A = 5.0 \\times 10^6 \\text{ N/m}^3, \\quad x_0 = 0.2 \\text{ m}, \\quad \\sigma = 0.08 \\text{ m}.$$\n- 观测索引 $$\\{1\\}$$，权重 $$w_1 = 1$$。其他地方 $$w_i = 0$$。\n- 数据 $$d_i$$ 等于由 $$f_{\\text{true}}$$ 在该观测索引处生成的正演位移。初始力 $$f = 0$$。\n- 步长 $$\\alpha = 5.0 \\times 10^{-5}.$$\n\n测试用例 3（低剪切模量，多点观测）：\n- $$L = 1.0 \\text{ m}, \\quad N = 50.$$\n- $$\\lambda = 1.0 \\times 10^9 \\text{ Pa}, \\quad \\mu = 1.0 \\times 10^7 \\text{ Pa}.$$\n- 真实力 $$f_{\\text{true}}(x) = A \\exp\\left( - \\frac{(x - x_0)^2}{2 \\sigma^2} \\right)$$，其中 $$A = 2.0 \\times 10^6 \\text{ N/m}^3, \\quad x_0 = 0.8 \\text{ m}, \\quad \\sigma = 0.05 \\text{ m}.$$\n- 观测索引 $$\\{15, 35\\}$$，权重 $$w_i = 1$$。其他地方 $$w_i = 0$$。\n- 数据 $$d_i$$ 等于由 $$f_{\\text{true}}$$ 在那些观测索引处生成的正演位移。初始力 $$f = 0$$。\n- 步长 $$\\alpha = 1.0 \\times 10^{-4}.$$\n\n规范：\n- 您的程序必须构建离散算子 $$A,$$ 为每个测试用例生成合成数据 $$d,$$ 求解初始 $$f$$ 的正演问题，求解伴随方程，对 $$f$$ 执行一次梯度下降更新，求解更新后的 $$f$$ 的正演问题，计算最终失配 $$\\Phi(u_{\\text{new}}),$$ 并以列表格式 \"[result1,result2,result3]\" 输出三个失配值。",
            "solution": "**1. 连续公式与伴随状态推导**\n\n正演问题由域 $[0, L]$ 上的位移 $u(x)$ 的 PDE 控制：\n$$ \\mathcal{A} u + f = 0 \\quad \\text{其中} \\quad u(0) = u(L) = 0 $$\n对于常数拉梅参数 $\\lambda$ 和 $\\mu$，算子 $\\mathcal{A}$ 定义为：\n$$ \\mathcal{A} u = \\frac{d}{dx}\\left( (\\lambda + 2 \\mu) \\frac{du}{dx} \\right) = (\\lambda + 2 \\mu) \\frac{d^2u}{dx^2} $$\n目标是最小化失配泛函 $\\Phi(u)$:\n$$ \\Phi(u) = \\frac{1}{2} \\| W(u - d) \\|^2 $$\n其中 $d$ 代表观测位移数据，$W$ 是一个加权算子。符号 $\\| \\cdot \\|$ 代表标准的欧几里得范数，在连续情况下对应于 $L^2$ 范数，因此 $\\Phi(u) = \\frac{1}{2} \\int_0^L (W(u-d))^2 dx$。我们将体力 $f(x)$ 视为控制变量。\n\n为解决此约束优化问题，我们引入拉格朗日量 $\\mathcal{L}$，其中 $p(x)$ 为伴随变量（一个拉格朗日乘子场）：\n$$ \\mathcal{L}(u, f, p) = \\Phi(u) + \\langle p, \\mathcal{A} u + f \\rangle $$\n内积 $\\langle a, b \\rangle$ 是 $L^2$ 内积，即 $\\int_0^L a(x) b(x) dx$。通过将 $\\mathcal{L}$ 对每个变量的偏弗雷歇导数设为零来找到最优性条件。\n\n**伴随方程的推导：**\n我们要求 $\\mathcal{L}$ 对状态变量 $u$ 的导数为零。让我们找到 $\\mathcal{L}$ 关于 $u$ 的变化 $\\delta u$ 的变分：\n$$ \\delta_u \\mathcal{L} = \\frac{d}{d\\epsilon} \\mathcal{L}(u + \\epsilon \\delta u, f, p) \\Big|_{\\epsilon=0} = 0 $$\n失配项的变分为：\n$$ \\frac{d}{d\\epsilon} \\left( \\frac{1}{2} \\langle W(u + \\epsilon \\delta u - d), W(u + \\epsilon \\delta u - d) \\rangle \\right) \\Big|_{\\epsilon=0} = \\langle W^{\\top}W(u-d), \\delta u \\rangle $$\n约束项的变分为：\n$$ \\frac{d}{d\\epsilon} \\left( \\langle p, \\mathcal{A}(u + \\epsilon \\delta u) + f \\rangle \\right) \\Big|_{\\epsilon=0} = \\langle p, \\mathcal{A} \\delta u \\rangle $$\n因此，$u$ 的平稳性条件是：\n$$ \\delta_u \\mathcal{L} = \\langle W^{\\top}W(u-d), \\delta u \\rangle + \\langle p, \\mathcal{A} \\delta u \\rangle = 0 $$\n为了使此表达式与 $\\delta u$ 无关，我们对第二项使用分部积分。算子 $\\mathcal{A}$ 有一个相关的伴随算子 $\\mathcal{A}^*$，定义为 $\\langle p, \\mathcal{A} \\delta u \\rangle = \\langle \\mathcal{A}^* p, \\delta u \\rangle$。\n$$ \\langle p, \\mathcal{A} \\delta u \\rangle = \\int_0^L p \\left( (\\lambda + 2\\mu) \\frac{d^2(\\delta u)}{dx^2} \\right) dx $$\n两次分部积分：\n$$ (\\lambda + 2\\mu) \\int_0^L p \\frac{d^2(\\delta u)}{dx^2} dx = (\\lambda + 2\\mu) \\left[ p \\frac{d(\\delta u)}{dx} \\right]_0^L - (\\lambda + 2\\mu) \\int_0^L \\frac{dp}{dx} \\frac{d(\\delta u)}{dx} dx $$\n$$ = (\\lambda + 2\\mu) \\left[ p \\frac{d(\\delta u)}{dx} - \\frac{dp}{dx} \\delta u \\right]_0^L + (\\lambda + 2\\mu) \\int_0^L \\frac{d^2p}{dx^2} \\delta u \\, dx $$\n正演问题的边界条件是齐次狄利克雷条件，$u(0)=u(L)=0$。变分 $\\delta u$ 必须遵守这些约束，因此 $\\delta u(0) = \\delta u(L) = 0$。为使边界项消失，我们也为伴随变量选择齐次狄利克雷边界条件，$p(0)=p(L)=0$。这导致：\n$$ \\langle p, \\mathcal{A} \\delta u \\rangle = \\int_0^L \\left( (\\lambda + 2\\mu) \\frac{d^2p}{dx^2} \\right) \\delta u \\, dx = \\langle \\mathcal{A} p, \\delta u \\rangle $$\n这表明算子 $\\mathcal{A}$ 在这些边界条件下是自伴随的（$\\mathcal{A}^* = \\mathcal{A}$）。平稳性条件变为：\n$$ \\langle W^{\\top}W(u-d) + \\mathcal{A} p, \\delta u \\rangle = 0 $$\n由于此式必须对所有容许的变分 $\\delta u$ 成立，内积中的项必须为零。这给出了**伴随方程**：\n$$ \\mathcal{A} p + W^{\\top}W(u-d) = 0 \\quad \\text{其中} \\quad p(0) = p(L) = 0 $$\n\n**梯度的推导：**\n失配 $\\Phi$ 相对于控制变量 $f$ 的梯度是通过求 $\\Phi$ 对 $f$ 的全导数得到的。伴随方法通过注意到 $d\\Phi/df = d\\mathcal{L}/df$ 来简化此过程。$\\mathcal{L}$ 对 $f$ 的全导数为：\n$$ \\frac{d\\mathcal{L}}{df} = \\frac{\\partial \\mathcal{L}}{\\partial f} + \\frac{\\partial \\mathcal{L}}{\\partial u} \\frac{du}{df} $$\n根据构造，选择伴随变量 $p$ 以满足平稳性条件 $\\delta_u \\mathcal{L} = 0$。这意味着弗雷歇导数 $\\partial \\mathcal{L}/\\partial u = 0$。因此，第二项消失，梯度计算简化为偏导数：\n$$ \\nabla_f \\Phi = \\frac{d\\mathcal{L}}{df} = \\frac{\\partial \\mathcal{L}}{\\partial f} $$\n从 $\\mathcal{L}(u, f, p) = \\Phi(u) + \\langle p, \\mathcal{A} u \\rangle + \\langle p, f \\rangle$ 的定义来看，唯一显式依赖于 $f$ 的项是 $\\langle p, f \\rangle$。对 $f$ 的变分是：\n$$ \\delta_f \\mathcal{L} = \\langle p, \\delta f \\rangle $$\n这意味着泛函相对于控制变量 $f$ 的梯度就是伴随场 $p$。\n$$ \\nabla_f \\Phi = p $$\n\n**2. 离散公式与算法**\n\n我们使用 $N$ 个内部点 $x_i = i h$（$i=1, \\dots, N$）来离散化域 $[0, L]$，均匀间距为 $h = L/(N+1)$。函数 $u(x)$、$f(x)$ 和 $p(x)$ 变为向量 $u, f, p \\in \\mathbb{R}^N$。\n\n二阶导数算子使用二阶中心有限差分格式近似：\n$$ \\frac{d^2u}{dx^2}\\Big|_{x_i} \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} $$\n在齐次狄利克雷边界条件 $u_0 = u_{N+1} = 0$ 下，算子 $\\mathcal{A}$ 被离散化为一个对称的三对角矩阵 $A \\in \\mathbb{R}^{N \\times N}$:\n$$ A = \\frac{\\lambda + 2 \\mu}{h^2} \\operatorname{tridiag}(1, -2, 1) $$\n离散方程组为：\n- **正演问题：** $A u = -f$\n- **伴随问题：** $A^{\\top} p = -W^{\\top}W(u-d)$。由于 $A$ 是对称的，$A^{\\top}=A$，因此 $A p = -W^{\\top}W(u-d)$。\n\n离散失配泛函为：\n$$ \\Phi(u) = \\frac{1}{2} (u-d)^{\\top} W^{\\top}W (u-d) = \\frac{1}{2} \\sum_{i=1}^N w_i^2 (u_i - d_i)^2 $$\n其中 $W^{\\top}W$ 是一个对角线上元素为 $w_i^2$ 的对角矩阵。离散梯度由离散伴随场给出：\n- **梯度：** $\\nabla_f \\Phi = p$\n\n一次梯度下降更新的算法如下：\n1.  **设置：** 定义网格参数（$L$, $N$）、材料属性（$\\lambda$, $\\mu$）和算法参数（$\\alpha$）。构建离散算子矩阵 $A$。\n2.  **生成合成数据：**\n    a. 在离散网格上定义真实力场 $f_{\\text{true}}$。\n    b. 求解正演问题 $A u_{\\text{true}} = -f_{\\text{true}}$ 得到真实位移 $u_{\\text{true}}$。\n    c. 构建数据向量 $d$ 和权重向量 $w$。对于观测索引 $i_{obs}$，设置 $d_{i_{obs}} = u_{\\text{true}, i_{obs}}$ 和 $w_{i_{obs}} = 1$。对于所有其他索引，设置 $d_i=0$ 和 $w_i=0$。\n3.  **梯度计算（伴随法）：**\n    a. 设置力的初始猜测值 $f_0 = 0$。\n    b. 求解当前猜测的正演问题：$A u_0 = -f_0$。（此处，$u_0 = 0$）。\n    c. 计算数据残差 $(u_0 - d)$。\n    d. 定义伴随源项：$s_p = -W^{\\top}W(u_0 - d)$。在实现中，这是元素级乘积 $-w^2 \\odot (u_0 - d)$。\n    e. 求解伴随问题得到伴随场 $p$：$A p = s_p$。\n4.  **梯度下降更新：**\n    a. 梯度为 $\\nabla_f \\Phi = p$。\n    b. 更新力场：$f_{\\text{new}} = f_0 - \\alpha p$。\n5.  **评估新失配：**\n    a. 用更新后的力求解正演问题：$A u_{\\text{new}} = -f_{\\text{new}}$。\n    b. 计算新的失配值：$\\Phi(u_{\\text{new}}) = \\frac{1}{2} \\sum_{i=1}^N w_i^2 (u_{\\text{new}, i} - d_i)^2$。\n\n此过程应用于每个测试用例，以获得所需的最终失配值。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import diags\nfrom scipy.sparse.linalg import spsolve\n\ndef run_one_case(L : float, N : int, lam : float, mu : float, f_true_params : tuple, obs_indices : list, alpha : float):\n    \"\"\"\n    Solves one test case of the 1D elastic inverse problem.\n\n    Args:\n        L (float): Length of the domain in meters.\n        N (int): Number of interior grid points.\n        lam (float): First Lamé parameter in Pascals.\n        mu (float): Second Lamé parameter (shear modulus) in Pascals.\n        f_true_params (tuple): Parameters (A, x0, sigma) for the true Gaussian force.\n        obs_indices (list): List of 1-based indices for observation points.\n        alpha (float): Step size for gradient descent.\n\n    Returns:\n        float: The misfit value after one gradient descent update.\n    \"\"\"\n    # 1. Discretization and Grid Setup\n    # h: grid spacing, x: grid point locations\n    h = L / (N + 1)\n    x = np.linspace(h, L - h, N)  # Grid points from x_1 to x_N\n\n    # 2. Construct the discrete operator A\n    # A = (lam + 2*mu)/h^2 * tridiag(1, -2, 1)\n    const = (lam + 2 * mu) / (h**2)\n    main_diag = -2.0 * np.ones(N)\n    off_diag = np.ones(N - 1)\n    # Use Compressed Sparse Column format for efficient solving\n    A_mat = const * diags([off_diag, main_diag, off_diag], [-1, 0, 1], format='csc')\n\n    # 3. Generate true force field and synthetic data\n    A_f_true, x0_f_true, sigma_f_true = f_true_params\n    f_true = A_f_true * np.exp(-(x - x0_f_true)**2 / (2 * sigma_f_true**2))\n    \n    # Solve forward problem for true displacement to get synthetic data\n    u_true = spsolve(A_mat, -f_true)\n    \n    # Create data vector d and weight vector w\n    d = np.zeros(N)\n    w = np.zeros(N)\n    # Convert 1-based indices from problem to 0-based for numpy arrays\n    obs_indices_0based = [i - 1 for i in obs_indices]\n    for i in obs_indices_0based:\n        if 0 = i  N:\n            d[i] = u_true[i]\n            w[i] = 1.0\n\n    # 4. Adjoint-State Method and Gradient Descent\n    # Initial guess for the force is a zero vector\n    f_initial = np.zeros(N)\n\n    # Solve forward problem for the initial guess. For f_initial=0, u_initial is also 0.\n    u_initial = spsolve(A_mat, -f_initial)\n\n    # Calculate residual and the right-hand side for the adjoint equation\n    residual = u_initial - d\n    # W^T * W is a diagonal matrix with w_i^2 on the diagonal.\n    # Multiplication by this matrix is equivalent to an element-wise product.\n    WTW_residual = (w**2) * residual\n    adjoint_rhs = -WTW_residual\n\n    # Solve the adjoint equation: A^T p = -W^T W (u - d)\n    # Since A is symmetric, A^T = A.\n    p = spsolve(A_mat, adjoint_rhs)\n    \n    # The gradient of the misfit with respect to f is the adjoint field p\n    gradient = p\n    \n    # Perform one gradient descent step to update the force field\n    f_new = f_initial - alpha * gradient\n    \n    # 5. Compute the new state and misfit\n    # Solve the forward problem with the updated force field\n    u_new = spsolve(A_mat, -f_new)\n    \n    # Compute the final misfit value, which should be in units of m^2\n    final_misfit = 0.5 * np.sum((w * (u_new - d))**2)\n    \n    return final_misfit\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 1.0, \"N\": 50, \"lam\": 1.5e9, \"mu\": 8.0e8,\n            \"f_true_params\": (1.0e6, 0.5, 0.1),\n            \"obs_indices\": [10, 25, 40],\n            \"alpha\": 1.0e-4\n        },\n        {\n            \"L\": 1.0, \"N\": 50, \"lam\": 3.0e10, \"mu\": 2.0e10,\n            \"f_true_params\": (5.0e6, 0.2, 0.08),\n            \"obs_indices\": [1],\n            \"alpha\": 5.0e-5\n        },\n        {\n            \"L\": 1.0, \"N\": 50, \"lam\": 1.0e9, \"mu\": 1.0e7,\n            \"f_true_params\": (2.0e6, 0.8, 0.05),\n            \"obs_indices\": [15, 35],\n            \"alpha\": 1.0e-4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_one_case(\n            case[\"L\"], case[\"N\"], case[\"lam\"], case[\"mu\"],\n            case[\"f_true_params\"], case[\"obs_indices\"], case[\"alpha\"]\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}