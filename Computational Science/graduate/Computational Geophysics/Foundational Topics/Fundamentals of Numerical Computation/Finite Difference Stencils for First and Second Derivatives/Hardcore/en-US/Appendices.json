{
    "hands_on_practices": [
        {
            "introduction": "The foundation of finite difference methods rests on our ability to construct accurate approximations for derivatives. This first practice guides you through the fundamental process of deriving the coefficients for a high-order stencil using Taylor series expansions. You will then apply Fourier analysis to compute the stencil's modified wavenumber, a crucial tool for understanding numerical dispersion and predicting how well the scheme propagates waves of different lengths, a central concern in geophysics .",
            "id": "3594256",
            "problem": "In one spatial dimension, consider the discretization of the second derivative $f''(x)$ on a uniform grid $x_{i} = x_{0} + i h$ with spacing $h$, as it appears in computational geophysics when modeling acoustic or elastic wave propagation. You are to derive a centered five-point stencil that is fourth-order accurate for approximating $f''(x_{i})$.\n\nStart from the assumption of a linear, shift-invariant discrete operator of the form\n$$\n\\mathcal{L} f_{i} = \\frac{1}{h^{2}} \\left( A f_{i-2} + B f_{i-1} + C f_{i} + B f_{i+1} + A f_{i+2} \\right),\n$$\nwith unknown real coefficients $A$, $B$, and $C$. Use Taylor series expansions of $f(x)$ about $x_{i}$, assuming $f(x)$ is sufficiently smooth, and impose the conditions necessary so that $\\mathcal{L} f_{i}$ approximates $f''(x_{i})$ with a truncation error of order $\\mathcal{O}(h^{4})$.\n\nThen, perform a dispersion analysis by applying $\\mathcal{L}$ to a Fourier mode $u_{i} = \\exp(i k x_{i})$ with real wavenumber $k$. Define the modified wavenumber $k^{*}(kh)$ for the second derivative stencil by the relation\n$$\n\\mathcal{L} u_{i} = -\\left(k^{*}(kh)\\right)^{2} u_{i}.\n$$\nCompute the closed-form expression for $k^{*}(kh)$ in terms of $h$ and $kh$.\n\nProvide your final answer as a single row matrix whose first five entries are the stencil coefficients $(A, B, C, B, A)$ in order $m=-2,-1,0,1,2$, and whose sixth entry is the analytical expression for $k^{*}(kh)$. No numerical rounding is required. Express your answer exactly in terms of rational numbers and trigonometric functions as appropriate.",
            "solution": "The user wants me to derive a fourth-order accurate, five-point centered finite difference stencil for the second derivative and then compute its modified wavenumber.\n\n### Step 1: Problem Validation\n\nFirst, I will validate the problem statement.\n\n**Extraction of Givens:**\n1.  **Problem:** Discretization of the second derivative $f''(x)$ on a uniform grid $x_i = x_0 + i h$.\n2.  **Operator Form:** A centered five-point stencil of the form $\\mathcal{L} f_{i} = \\frac{1}{h^{2}} \\left( A f_{i-2} + B f_{i-1} + C f_{i} + B f_{i+1} + A f_{i+2} \\right)$.\n3.  **Accuracy Requirement:** The stencil must approximate $f''(x_i)$ with a truncation error of order $\\mathcal{O}(h^{4})$.\n4.  **Derivation Method:** Use Taylor series expansions of $f(x)$ about $x_i$.\n5.  **Dispersion Analysis:** Apply the operator $\\mathcal{L}$ to a Fourier mode $u_i = \\exp(i k x_i)$.\n6.  **Modified Wavenumber Definition:** $\\mathcal{L} u_i = -(k^{*}(kh))^{2} u_i$.\n7.  **Task:**\n    a. Find the coefficients $A$, $B$, and $C$.\n    b. Find the closed-form expression for the modified wavenumber $k^{*}(kh)$.\n8.  **Output Format:** A single row matrix with the five stencil coefficients $(A, B, C, B, A)$ and the expression for $k^{*}(kh)$.\n\n**Validation using Extracted Givens:**\n*   **Scientifically Grounded:** The problem is a standard exercise in numerical analysis, specifically in the field of finite difference methods for solving partial differential equations, which is a core technique in computational geophysics. The concepts of Taylor series analysis for accuracy and dispersion analysis for wave propagation properties are fundamental. The problem is scientifically sound.\n*   **Well-Posed:** The problem is well-posed. It provides a clear objective and sufficient constraints (the form of the operator and the required order of accuracy) to uniquely determine the unknown coefficients $A, B, C$. The subsequent dispersion analysis is a direct calculation based on the derived operator.\n*   **Objective:** The problem is stated in precise, objective mathematical language.\n*   **Other Flaws:** The problem is self-contained and consistent. It does not contain any of the listed flaws (e.g., scientific unsoundness, missing information, ambiguity).\n\n**Verdict:** The problem is valid. I will now proceed with the solution.\n\n### Part 1: Derivation of Stencil Coefficients\n\nTo find the coefficients $A$, $B$, and $C$, we expand each term $f_{i+m} = f(x_i + mh)$ in the operator $\\mathcal{L}$ using a Taylor series around the point $x_i$, assuming $f(x)$ is sufficiently smooth.\n\nThe operator is given by:\n$$\n\\mathcal{L} f_{i} = \\frac{1}{h^{2}} \\left( A f_{i-2} + B f_{i-1} + C f_{i} + B f_{i+1} + A f_{i+2} \\right)\n$$\nWe can rewrite this as:\n$$\nh^2 \\mathcal{L} f_{i} = A(f_{i-2} + f_{i+2}) + B(f_{i-1} + f_{i+1}) + C f_i\n$$\nThe Taylor expansions for $f(x_i \\pm mh)$ are:\n$$\nf(x_i \\pm mh) = f(x_i) \\pm (mh)f'(x_i) + \\frac{(mh)^2}{2!}f''(x_i) \\pm \\frac{(mh)^3}{3!}f'''(x_i) + \\frac{(mh)^4}{4!}f^{(4)}(x_i) + \\frac{(mh)^5}{5!}f^{(5)}(x_i) + \\frac{(mh)^6}{6!}f^{(6)}(x_i) + \\dots\n$$\nDue to the symmetry of the stencil, when we sum the pairs $f_{i-m} + f_{i+m}$, the odd-powered derivative terms cancel out.\nFor $m=1$:\n$$\nf_{i-1} + f_{i+1} = 2f_i + \\frac{2 h^2}{2!} f_i'' + \\frac{2 h^4}{4!} f_i^{(4)} + \\frac{2 h^6}{6!} f_i^{(6)} + \\mathcal{O}(h^8) = 2 f_i + h^2 f_i'' + \\frac{1}{12} h^4 f_i^{(4)} + \\frac{1}{360} h^6 f_i^{(6)} + \\mathcal{O}(h^8)\n$$\nFor $m=2$:\n$$\nf_{i-2} + f_{i+2} = 2f_i + \\frac{2 (2h)^2}{2!} f_i'' + \\frac{2 (2h)^4}{4!} f_i^{(4)} + \\frac{2 (2h)^6}{6!} f_i^{(6)} + \\mathcal{O}(h^8) = 2 f_i + 4 h^2 f_i'' + \\frac{4}{3} h^4 f_i^{(4)} + \\frac{8}{45} h^6 f_i^{(6)} + \\mathcal{O}(h^8)\n$$\nSubstituting these sums back into the expression for $h^2 \\mathcal{L} f_i$:\n$$\nh^2 \\mathcal{L} f_i = A \\left( 2 f_i + 4 h^2 f_i'' + \\frac{4}{3} h^4 f_i^{(4)} + \\dots \\right) + B \\left( 2 f_i + h^2 f_i'' + \\frac{1}{12} h^4 f_i^{(4)} + \\dots \\right) + C f_i\n$$\nWe group terms by the order of the derivative of $f$ at $x_i$:\n$$\nh^2 \\mathcal{L} f_i = (2A + 2B + C) f_i + (4A + B) h^2 f_i'' + \\left(\\frac{4}{3}A + \\frac{1}{12}B\\right) h^4 f_i^{(4)} + \\left(\\frac{8}{45}A + \\frac{1}{360}B\\right) h^6 f_i^{(6)} + \\dots\n$$\nDividing by $h^2$, we get the expansion for the operator $\\mathcal{L}$:\n$$\n\\mathcal{L} f_i = \\frac{1}{h^2}(2A + 2B + C) f_i + (4A + B) f_i'' + \\left(\\frac{4}{3}A + \\frac{1}{12}B\\right) h^2 f_i^{(4)} + \\mathcal{O}(h^4)\n$$\nWe require that $\\mathcal{L}f_i$ approximates $f_i''$ with a truncation error of $\\mathcal{O}(h^4)$. This imposes the following conditions on the coefficients:\n1.  The coefficient of $f_i$ must be zero: $2A + 2B + C = 0$.\n2.  The coefficient of $f_i''$ must be one: $4A + B = 1$.\n3.  The coefficient of $h^2 f_i^{(4)}$ must be zero for the truncation error to be $\\mathcal{O}(h^4)$: $\\frac{4}{3}A + \\frac{1}{12}B = 0$.\n\nWe now solve this system of three linear equations for $A$, $B$, and $C$.\nFrom the third equation:\n$$\n\\frac{4}{3}A = -\\frac{1}{12}B \\implies 16A = -B \\implies B = -16A\n$$\nSubstitute this into the second equation:\n$$\n4A + (-16A) = 1 \\implies -12A = 1 \\implies A = -\\frac{1}{12}\n$$\nNow we find $B$:\n$$\nB = -16A = -16 \\left(-\\frac{1}{12}\\right) = \\frac{16}{12} = \\frac{4}{3}\n$$\nFinally, we find $C$ from the first equation:\n$$\nC = -2A - 2B = -2\\left(-\\frac{1}{12}\\right) - 2\\left(\\frac{4}{3}\\right) = \\frac{1}{6} - \\frac{8}{3} = \\frac{1}{6} - \\frac{16}{6} = -\\frac{15}{6} = -\\frac{5}{2}\n$$\nThe coefficients for the five-point, fourth-order stencil are $A = -1/12$, $B = 4/3$, and $C = -5/2$. The full set of stencil coefficients $(A, B, C, B, A)$ for points $(i-2, i-1, i, i+1, i+2)$ is $(-\\frac{1}{12}, \\frac{4}{3}, -\\frac{5}{2}, \\frac{4}{3}, -\\frac{1}{12})$.\n\n### Part 2: Dispersion Analysis and Modified Wavenumber\n\nNext, we perform a dispersion analysis by applying the discrete operator $\\mathcal{L}$ to a Fourier mode $u_i = \\exp(i k x_i)$, where $k$ is the wavenumber. We note that $u_{i+m} = \\exp(ik(x_i+mh)) = u_i \\exp(ikmh)$.\n$$\n\\mathcal{L} u_i = \\frac{1}{h^2} \\left[ A u_{i-2} + B u_{i-1} + C u_i + B u_{i+1} + A u_{i+2} \\right]\n$$\n$$\n\\mathcal{L} u_i = \\frac{u_i}{h^2} \\left[ A e^{-i2kh} + B e^{-ikh} + C + B e^{ikh} + A e^{i2kh} \\right]\n$$\nUsing Euler's identity, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we can simplify the expression:\n$$\n\\mathcal{L} u_i = \\frac{u_i}{h^2} \\left[ C + 2B \\cos(kh) + 2A \\cos(2kh) \\right]\n$$\nThe modified wavenumber $k^*(kh)$ is defined by the relation $\\mathcal{L} u_i = -(k^*(kh))^2 u_i$. Therefore, we have:\n$$\n-(k^*(kh))^2 = \\frac{1}{h^2} \\left[ C + 2B \\cos(kh) + 2A \\cos(2kh) \\right]\n$$\nNow, substitute the derived values for $A, B, C$:\n$$\n-(k^*)^2 = \\frac{1}{h^2} \\left[ -\\frac{5}{2} + 2\\left(\\frac{4}{3}\\right) \\cos(kh) + 2\\left(-\\frac{1}{12}\\right) \\cos(2kh) \\right]\n$$\n$$\n-(k^*)^2 = \\frac{1}{h^2} \\left[ -\\frac{5}{2} + \\frac{8}{3} \\cos(kh) - \\frac{1}{6} \\cos(2kh) \\right]\n$$\nMultiplying by $-1$ gives the expression for $(k^*)^2$:\n$$\n(k^*)^2 = \\frac{1}{h^2} \\left[ \\frac{5}{2} - \\frac{8}{3} \\cos(kh) + \\frac{1}{6} \\cos(2kh) \\right]\n$$\nTo simplify, we can use the identity $C = -(2A+2B) = -2(-1/12) - 2(4/3) = 1/6 - 8/3 = -15/6 = -5/2$.\nAn alternative approach recognizes that the sum of coefficients is zero.\n$C+2B+2A=0 \\implies C=-2A-2B$.\n$(k^*)^2 = -\\frac{1}{h^2} \\left[ -2A - 2B + 2B \\cos(kh) + 2A \\cos(2kh) \\right]$\n$(k^*)^2 = \\frac{2}{h^2} \\left[ B(1 - \\cos(kh)) + A(1 - \\cos(2kh)) \\right]$\nUsing the identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$(k^*)^2 = \\frac{2}{h^2} \\left[ B(2\\sin^2(kh/2)) + A(2\\sin^2(kh)) \\right]$\nUsing $\\sin(kh) = 2\\sin(kh/2)\\cos(kh/2)$:\n$(k^*)^2 = \\frac{4}{h^2} \\left[ B\\sin^2(kh/2) + A(4\\sin^2(kh/2)\\cos^2(kh/2)) \\right]$\n$(k^*)^2 = \\frac{4}{h^2} \\sin^2(kh/2) \\left[ B + 4A\\cos^2(kh/2) \\right]$\nSubstitute $B=4/3$ and $A=-1/12$:\n$(k^*)^2 = \\frac{4}{h^2} \\sin^2(kh/2) \\left[ \\frac{4}{3} + 4\\left(-\\frac{1}{12}\\right)\\cos^2(kh/2) \\right] = \\frac{4}{h^2} \\sin^2(kh/2) \\left[ \\frac{4}{3} - \\frac{1}{3}\\cos^2(kh/2) \\right]$\n$(k^*)^2 = \\frac{4}{3h^2} \\sin^2(kh/2) \\left[ 4 - \\cos^2(kh/2) \\right]$\nUsing $1 - \\cos^2(x) = \\sin^2(x)$, we can write $4-\\cos^2(kh/2) = 3+\\sin^2(kh/2)$.\nLet's return to the form with full-angle cosines for simplicity.\n$(k^*)^2 = \\frac{1}{3h^2} (\\cos^2(kh) - 8\\cos(kh) + 7)$\nThis can be factored as:\n$(k^*)^2 = \\frac{1}{3h^2} (1 - \\cos(kh))(7 - \\cos(kh))$\nTaking the square root and noting that for physical wavenumbers $k \\ge 0$ and $h  0$, we have:\n$$\nk^*(kh) = \\frac{1}{h} \\sqrt{\\frac{(1 - \\cos(kh))(7 - \\cos(kh))}{3}}\n$$\nThis is the closed-form expression for the modified wavenumber.\n\nThe final answer requires the five coefficients $(A, B, C, B, A)$ and the expression for $k^*(kh)$ in a single row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{12}  \\frac{4}{3}  -\\frac{5}{2}  \\frac{4}{3}  -\\frac{1}{12}  \\frac{1}{h} \\sqrt{\\frac{(1-\\cos(kh))(7-\\cos(kh))}{3}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While formal order of accuracy is a key metric, it doesn't tell the whole story. In this practice, we explore the critical design trade-off between minimizing numerical dispersion and ensuring provable long-term stability for simulations on bounded domains. By comparing a dispersion-optimized stencil with one designed to be compatible with the Summation-By-Parts (SBP) property, you will gain insight into the nuanced choices that underpin the construction of robust and reliable numerical models for wave propagation phenomena .",
            "id": "3594218",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ with constant wave speed $a0$ on a uniform grid $x_j = j h$, where $h0$ is the grid spacing and $j\\in\\mathbb{Z}$. Let $D$ be a centered finite difference approximation to the first derivative operator $d/dx$ constructed from a symmetric stencil of width $M$ according to\n$$D u_j = \\frac{1}{h}\\sum_{m=1}^M d_m\\,(u_{j+m}-u_{j-m}),$$\nwhere the $d_m$ are real coefficients. Two stencils of the same formal order of accuracy are considered:\n\n(I) An interior stencil compatible with Summation-By-Parts (SBP) closures, using a $7$-point, $6$th-order centered scheme with coefficients $d_1 = \\frac{3}{4}$, $d_2 = -\\frac{3}{20}$, and $d_3 = \\frac{1}{60}$ (and $d_m = 0$ for $m\\ge 4$).\n\n(II) A non-SBP, dispersion-optimized $9$-point, $6$th-order centered scheme with $d_4 = -\\frac{1}{154}$ chosen to improve the match between its discrete Fourier symbol and the exact wavenumber over moderate $kh$. The remaining coefficients are determined by the $6$th-order consistency conditions and satisfy $d_1 = \\frac{3}{4} - 14\\,d_4$, $d_2 = -\\frac{3}{20} + 14\\,d_4$, and $d_3 = \\frac{1}{60} - 6\\,d_4$.\n\nThe modified wavenumber $\\tilde{k}(kh)$ of a stencil is defined by the discrete Fourier response to a single mode $u_j = e^{i k x_j}$, namely\n$$D e^{i k x_j} = i\\,\\tilde{k}(kh)\\,e^{i k x_j},$$\nwith $kh = k h$. The normalized phase speed is $c_p(kh) = \\tilde{k}(kh)/k$.\n\nTasks:\n(a) Starting from the definition of $\\tilde{k}(kh)$ and the form of $D$, derive the expression for $\\tilde{k}(kh)$ for the two stencils above as a function of $kh$ and the corresponding coefficients $d_m$.\n\n(b) Evaluate $c_p(kh)$ at $kh = \\frac{\\pi}{2}$ and $kh = \\frac{\\pi}{3}$ for stencil (I) and for stencil (II) with $d_4 = -\\frac{1}{154}$, and compare the dispersion errors.\n\n(c) Using the energy method, discuss the implications of employing SBP-compatible interior stencils together with weak boundary enforcement via Simultaneous Approximation Terms (SAT), versus employing non-SBP dispersion-optimized stencils, on the existence of a semi-discrete energy estimate for advection with boundaries.\n\nWhich of the following statements best captures the combined outcome of the modified wavenumber comparison and the energy-stability trade-off?\n\nA. Because both stencils are $6$th-order accurate, their modified wavenumber functions are identical; therefore any dispersion difference is purely due to boundary closures.\n\nB. The non-SBP $9$-point $6$th-order stencil with $d_4 = -\\frac{1}{154}$ achieves a modified wavenumber closer to the exact $k$ than the SBP-compatible $7$-point $6$th-order interior stencil over moderate $kh$ (e.g., at $kh=\\frac{\\pi}{3}$ and $kh=\\frac{\\pi}{2}$), but it lacks the Summation-By-Parts (SBP) energy estimate when combined with weak boundary enforcement, highlighting a dispersion-versus-stability trade-off.\n\nC. The SBP-compatible stencil guarantees energy stability and therefore must under-resolve high wavenumbers more severely than any non-SBP stencil of the same formal order; hence its modified wavenumber satisfies $\\tilde{k}(kh) \\le k$ for all $kh$, with equality at Nyquist.\n\nD. On a periodic domain, the non-SBP optimized stencil necessarily produces discrete energy growth because it is not SBP; thus it should be avoided even if its dispersion is better.",
            "solution": "The user has requested a an analysis of a problem concerning finite difference stencils for the linear advection equation. As per the instructions, the first step is a rigorous validation of the problem statement.\n\n### Step 1: Extract Givens\n\n-   **Equation**: One-dimensional linear advection equation, $u_t + a\\,u_x = 0$, with constant wave speed $a0$.\n-   **Grid**: Uniform grid $x_j = j h$, where $h0$ is the grid spacing and $j\\in\\mathbb{Z}$.\n-   **Finite Difference Operator**: A centered finite difference approximation $D$ to $d/dx$, constructed from a symmetric stencil of width $M$:\n    $$D u_j = \\frac{1}{h}\\sum_{m=1}^M d_m\\,(u_{j+m}-u_{j-m})$$\n    where $d_m$ are real coefficients.\n-   **Stencil (I)**: An interior stencil compatible with Summation-By-Parts (SBP) closures.\n    -   Type: $7$-point, $6$th-order centered scheme.\n    -   Coefficients: $d_1 = \\frac{3}{4}$, $d_2 = -\\frac{3}{20}$, $d_3 = \\frac{1}{60}$, and $d_m = 0$ for $m\\geq 4$.\n-   **Stencil (II)**: A non-SBP, dispersion-optimized $9$-point, $6$th-order centered scheme.\n    -   Coefficient: $d_4 = -\\frac{1}{154}$ is chosen to optimize dispersion.\n    -   Remaining coefficients are determined by $6$th-order consistency conditions and given relations: $d_1 = \\frac{3}{4} - 14\\,d_4$, $d_2 = -\\frac{3}{20} + 14\\,d_4$, and $d_3 = \\frac{1}{60} - 6\\,d_4$.\n-   **Definitions**:\n    -   **Modified Wavenumber**: $\\tilde{k}(kh)$ is defined by the relation $D e^{i k x_j} = i\\,\\tilde{k}(kh)\\,e^{i k x_j}$, where $kh = k h$.\n    -   **Normalized Phase Speed**: $c_p(kh) = \\tilde{k}(kh)/k$.\n-   **Tasks**:\n    (a) Derive the expression for $\\tilde{k}(kh)$ for a general stencil of the given form.\n    (b) Evaluate and compare $c_p(kh)$ for both stencils at $kh = \\frac{\\pi}{2}$ and $kh = \\frac{\\pi}{3}$.\n    (c) Discuss the implications of SBP vs. non-SBP stencils for the existence of a semi-discrete energy estimate for advection with boundaries using the energy method.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientifically Grounded**: The problem is deeply rooted in the established field of numerical analysis for partial differential equations. The linear advection equation, finite difference methods, Taylor series analysis, Fourier analysis (modified wavenumber), and energy methods (specifically Summation-By-Parts and Simultaneous Approximation Terms) are all standard, fundamental concepts in computational science. The problem is scientifically and mathematically sound.\n2.  **Well-Posed**: The problem is clearly stated. It provides all necessary definitions and data (stencil coefficients, equations). The tasks are specific and lead logically to a final comparative question. A unique and meaningful analysis is possible.\n3.  **Objective**: The language is technical, precise, and devoid of subjective or ambiguous terminology. Terms like \"6th-order\", \"SBP-compatible\", and \"dispersion-optimized\" have well-defined mathematical meanings in this context.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. It is scientifically grounded, well-posed, and objective. I will now proceed with the solution derivation.\n\n#### Task (a): Derivation of the Modified Wavenumber\n\nThe modified wavenumber $\\tilde{k}$ is defined by the action of the difference operator $D$ on a single Fourier mode, $u_j = e^{i k x_j} = e^{i k j h}$. We substitute this into the definition of the operator $D$:\n$$D u_j = \\frac{1}{h}\\sum_{m=1}^M d_m\\,(u_{j+m}-u_{j-m})$$\n$$D e^{i k j h} = \\frac{1}{h}\\sum_{m=1}^M d_m\\,\\left(e^{i k (j+m) h} - e^{i k (j-m) h}\\right)$$\nWe factor out the term $e^{i k j h}$:\n$$D e^{i k j h} = \\frac{e^{i k j h}}{h}\\sum_{m=1}^M d_m\\,\\left(e^{i k m h} - e^{-i k m h}\\right)$$\nUsing Euler's formula, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, with $\\theta = k m h$, we get:\n$$D e^{i k j h} = \\frac{e^{i k j h}}{h}\\sum_{m=1}^M d_m\\,\\left(2i\\sin(k m h)\\right)$$\n$$D e^{i k j h} = i \\left( \\frac{2}{h}\\sum_{m=1}^M d_m\\,\\sin(m kh) \\right) e^{i k j h}$$\nBy comparing this result with the definition $D e^{i k x_j} = i\\,\\tilde{k}(kh)\\,e^{i k x_j}$, we can identify the expression for the modified wavenumber $\\tilde{k}(kh)$:\n$$\\tilde{k}(kh) = \\frac{2}{h}\\sum_{m=1}^M d_m\\,\\sin(m kh)$$\nIt is often convenient to work with the dimensionless modified wavenumber $\\tilde{\\kappa} = \\tilde{k}h$.\n$$\\tilde{k}(kh)h = 2\\sum_{m=1}^M d_m\\,\\sin(m kh)$$\n\n#### Task (b): Evaluation and Comparison of Normalized Phase Speed\n\nThe normalized phase speed is $c_p(kh) = \\frac{\\tilde{k}(kh)}{k}$. Multiplying the numerator and denominator by $h$ gives $c_p(kh) = \\frac{\\tilde{k}(kh)h}{kh}$. Using the result from Task (a):\n$$c_p(kh) = \\frac{2}{kh}\\sum_{m=1}^M d_m\\,\\sin(m kh)$$\nThe exact solution has $c_p(kh) = 1$ for all $kh$. The dispersion error is $|c_p(kh) - 1|$.\n\n**Stencil (I): SBP $7$-point, $6$th-order ($M=3$)**\nCoefficients: $d_1 = \\frac{3}{4}$, $d_2 = -\\frac{3}{20}$, $d_3 = \\frac{1}{60}$.\n$$c_p^{(I)}(kh) = \\frac{2}{kh}\\left(\\frac{3}{4}\\sin(kh) - \\frac{3}{20}\\sin(2kh) + \\frac{1}{60}\\sin(3kh)\\right)$$\n-   At $kh = \\frac{\\pi}{2}$:\n    $c_p^{(I)}(\\frac{\\pi}{2}) = \\frac{2}{\\pi/2}\\left(\\frac{3}{4}\\sin(\\frac{\\pi}{2}) - \\frac{3}{20}\\sin(\\pi) + \\frac{1}{60}\\sin(\\frac{3\\pi}{2})\\right) = \\frac{4}{\\pi}\\left(\\frac{3}{4}(1) - 0 + \\frac{1}{60}(-1)\\right)$\n    $c_p^{(I)}(\\frac{\\pi}{2}) = \\frac{4}{\\pi}\\left(\\frac{45-1}{60}\\right) = \\frac{4}{\\pi}\\frac{44}{60} = \\frac{44}{15\\pi} \\approx 0.93375$\n    Dispersion error: $|0.93375 - 1| \\approx 0.06625$.\n\n-   At $kh = \\frac{\\pi}{3}$:\n    $c_p^{(I)}(\\frac{\\pi}{3}) = \\frac{2}{\\pi/3}\\left(\\frac{3}{4}\\sin(\\frac{\\pi}{3}) - \\frac{3}{20}\\sin(\\frac{2\\pi}{3}) + \\frac{1}{60}\\sin(\\pi)\\right) = \\frac{6}{\\pi}\\left(\\frac{3}{4}\\frac{\\sqrt{3}}{2} - \\frac{3}{20}\\frac{\\sqrt{3}}{2} + 0\\right)$\n    $c_p^{(I)}(\\frac{\\pi}{3}) = \\frac{6}{\\pi}\\frac{\\sqrt{3}}{2}\\left(\\frac{3}{4} - \\frac{3}{20}\\right) = \\frac{3\\sqrt{3}}{\\pi}\\left(\\frac{15-3}{20}\\right) = \\frac{3\\sqrt{3}}{\\pi}\\frac{12}{20} = \\frac{9\\sqrt{3}}{5\\pi} \\approx 0.99236$\n    Dispersion error: $|0.99236 - 1| \\approx 0.00764$.\n\n**Stencil (II): Non-SBP $9$-point, $6$th-order optimized ($M=4$)**\nFirst, we calculate the coefficients with $d_4 = -\\frac{1}{154}$:\n$d_1 = \\frac{3}{4} - 14(-\\frac{1}{154}) = \\frac{3}{4} + \\frac{1}{11} = \\frac{33+4}{44} = \\frac{37}{44}$\n$d_2 = -\\frac{3}{20} + 14(-\\frac{1}{154}) = -\\frac{3}{20} - \\frac{1}{11} = \\frac{-33-20}{220} = -\\frac{53}{220}$\n$d_3 = \\frac{1}{60} - 6(-\\frac{1}{154}) = \\frac{1}{60} + \\frac{3}{77} = \\frac{77+180}{4620} = \\frac{257}{4620}$\n$$c_p^{(II)}(kh) = \\frac{2}{kh}\\left(\\frac{37}{44}\\sin(kh) - \\frac{53}{220}\\sin(2kh) + \\frac{257}{4620}\\sin(3kh) - \\frac{1}{154}\\sin(4kh)\\right)$$\n-   At $kh = \\frac{\\pi}{2}$:\n    $c_p^{(II)}(\\frac{\\pi}{2}) = \\frac{4}{\\pi}\\left(\\frac{37}{44}(1) - \\frac{53}{220}(0) + \\frac{257}{4620}(-1) - \\frac{1}{154}(0)\\right) = \\frac{4}{\\pi}\\left(\\frac{37}{44} - \\frac{257}{4620}\\right)$\n    $c_p^{(II)}(\\frac{\\pi}{2}) = \\frac{4}{\\pi}\\left(\\frac{37 \\cdot 105 - 257}{4620}\\right) = \\frac{4}{\\pi}\\left(\\frac{3885 - 257}{4620}\\right) = \\frac{4}{\\pi}\\frac{3628}{4620} = \\frac{907}{1155\\pi/4} \\approx 0.99985$\n    Dispersion error: $|0.99985 - 1| \\approx 0.00015$.\n\n-   At $kh = \\frac{\\pi}{3}$:\n    $c_p^{(II)}(\\frac{\\pi}{3}) = \\frac{6}{\\pi}\\left(\\frac{37}{44}\\sin(\\frac{\\pi}{3}) - \\frac{53}{220}\\sin(\\frac{2\\pi}{3}) + \\frac{257}{4620}\\sin(\\pi) - \\frac{1}{154}\\sin(\\frac{4\\pi}{3})\\right)$\n    $c_p^{(II)}(\\frac{\\pi}{3}) = \\frac{6}{\\pi}\\left(\\frac{37}{44}\\frac{\\sqrt{3}}{2} - \\frac{53}{220}\\frac{\\sqrt{3}}{2} + 0 - \\frac{1}{154}(-\\frac{\\sqrt{3}}{2})\\right) = \\frac{3\\sqrt{3}}{\\pi}\\left(\\frac{37}{44} - \\frac{53}{220} + \\frac{1}{154}\\right)$\n    The part in parenthesis is $\\frac{37\\cdot 35 - 53\\cdot 7 + 10}{1540} = \\frac{1295 - 371 + 10}{1540} = \\frac{934}{1540} = \\frac{467}{770}$.\n    $c_p^{(II)}(\\frac{\\pi}{3}) = \\frac{3\\sqrt{3}}{\\pi}\\frac{467}{770} \\approx 1.00351$\n    Dispersion error: $|1.00351 - 1| \\approx 0.00351$.\n\n**Comparison**:\n- At $kh = \\pi/2$: Stencil (I) error $\\approx 6.6\\%$, Stencil (II) error $\\approx 0.015\\%$.\n- At $kh = \\pi/3$: Stencil (I) error $\\approx 0.76\\%$, Stencil (II) error $\\approx 0.35\\%$.\nThe dispersion-optimized stencil (II) has a significantly smaller dispersion error (i.e., its modified wavenumber $\\tilde{k}$ is closer to the true wavenumber $k$) for these moderate wavenumbers.\n\n#### Task (c): Energy-Stability Implications\n\nThe energy method for the PDE $u_t+au_x=0$ on a domain $[x_L, x_R]$ involves multiplying by $u$ and integrating, which yields $\\frac{d}{dt} \\int \\frac{u^2}{2} dx = -\\frac{a}{2}[u^2]_{x_L}^{x_R}$. Stability depends on controlling the boundary flux term.\n\nFor the semi-discrete system $\\frac{d\\mathbf{u}}{dt} = -aD\\mathbf{u}$, the discrete energy is $E_h = \\frac{1}{2}\\mathbf{u}^T H \\mathbf{u}$, where $H$ is a symmetric positive-definite matrix defining a discrete norm. The rate of change of energy is $\\frac{dE_h}{dt} = -a\\mathbf{u}^T H D \\mathbf{u}$.\n\nA Summation-By-Parts (SBP) operator $D$ is constructed such that $D=H^{-1}Q$ where $Q+Q^T=B$ is a boundary matrix. For the first derivative, $B=\\text{diag}(-1, 0, ..., 0, 1) = e_N e_N^T - e_0 e_0^T$. This property makes $D$ a discrete analogue of the continuous integration-by-parts rule:\n$$\\mathbf{u}^T H D \\mathbf{u} = \\mathbf{u}^T Q \\mathbf{u} = \\frac{1}{2}\\mathbf{u}^T(Q+Q^T)\\mathbf{u} = \\frac{1}{2}\\mathbf{u}^T B \\mathbf{u} = \\frac{1}{2}(u_N^2-u_0^2)$$\nThe energy equation becomes $\\frac{dE_h}{dt} = -\\frac{a}{2}(u_N^2-u_0^2)$, perfectly mimicking the continuous case. Boundary conditions can then be imposed weakly using the Simultaneous Approximation Term (SAT) method. This allows for the construction of a penalty term that, when added to the energy equation, makes the total energy change non-positive (bounded by boundary data), thus proving numerical stability. The existence of such an energy estimate is a guarantee of robustness.\n\nA non-SBP operator, such as stencil (II), does not satisfy the discrete integration-by-parts property by definition. The quadratic form $\\mathbf{u}^T H D \\mathbf{u}$ does not simplify to boundary terms alone. It will contain a sum of interior terms whose sign is not definite. Consequently, one cannot formulate an energy argument to prove that the semi-discretization is stable for an initial-boundary-value problem. While the scheme might be stable in practice for many cases, it lacks the provable stability guarantee that the SBP-SAT framework provides. This highlights a classic trade-off: optimizing the interior stencil for dispersion (stencil II) can compromise the ability to prove stability on a bounded domain.\n\n### Option-by-Option Analysis\n\n**A. Because both stencils are $6$th-order accurate, their modified wavenumber functions are identical; therefore any dispersion difference is purely due to boundary closures.**\nThis is factually incorrect. Stencils of the same formal order of accuracy share the same leading terms in their Taylor series expansion about $kh=0$, but their behavior differs for finite $kh$. Our calculations in Task (b) explicitly show that their modified wavenumbers and phase speeds are different. **Verdict: Incorrect.**\n\n**B. The non-SBP $9$-point $6$th-order stencil with $d_4 = -\\frac{1}{154}$ achieves a modified wavenumber closer to the exact $k$ than the SBP-compatible $7$-point $6$th-order interior stencil over moderate $kh$ (e.g., at $kh=\\frac{\\pi}{3}$ and $kh=\\frac{\\pi}{2}$), but it lacks the Summation-By-Parts (SBP) energy estimate when combined with weak boundary enforcement, highlighting a dispersion-versus-stability trade-off.**\nThis statement aligns perfectly with our analysis. Task (b) demonstrated the superior dispersion properties of stencil (II). Task (c) explained why non-SBP stencils prevent the formulation of a semi-discrete energy estimate for bounded domains, which the SBP property enables. The statement correctly identifies this as a dispersion-versus-stability trade-off. **Verdict: Correct.**\n\n**C. The SBP-compatible stencil guarantees energy stability and therefore must under-resolve high wavenumbers more severely than any non-SBP stencil of the same formal order; hence its modified wavenumber satisfies $\\tilde{k}(kh) \\le k$ for all $kh$, with equality at Nyquist.**\nThis statement contains multiple inaccuracies. First, SBP stencils do not \"guarantee\" stability alone; they *enable* a proof of stability when combined with a proper boundary procedure (like SAT). Second, the claim \"must under-resolve more severely\" is too strong, although it happens in this specific example. Most importantly, the claim that $\\tilde{k}(kh)=k$ at Nyquist ($kh=\\pi$) is false. For any centered stencil of this form, $\\sin(m\\pi)=0$ for integer $m$, which implies $\\tilde{k}h(\\pi)=0$, not $\\pi$. **Verdict: Incorrect.**\n\n**D. On a periodic domain, the non-SBP optimized stencil necessarily produces discrete energy growth because it is not SBP; thus it should be avoided even if its dispersion is better.**\nThis is fundamentally wrong. On a periodic domain, *any* centered difference operator of the given form is skew-symmetric (i.e., its matrix representation $D$ satisfies $D^T = -D$). For the semi-discretization $\\frac{d\\mathbf{u}}{dt}=-aD\\mathbf{u}$, the rate of energy change is $\\frac{dE_h}{dt} \\propto \\mathbf{u}^T D \\mathbf{u} = 0$ due to skew-symmetry. Thus, energy is exactly conserved. The SBP property is irrelevant for proving stability on a periodic domain; its importance lies in handling non-periodic boundaries. The stencil does not produce energy growth in this case. **Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Manual derivation of stencil coefficients becomes tedious for high orders or complex geometries. This practice transitions you from manual calculation to computational construction by implementing an algorithm to generate stencil weights from first principles. You will formalize the Taylor series constraints into a linear system and write a program to solve for the weights, creating a versatile tool for generating custom stencils that can exactly differentiate polynomials up to a desired degree. This exercise demonstrates how theoretical principles can be translated into a powerful computational capability, with direct applications to modeling smooth background fields in geophysics .",
            "id": "3594272",
            "problem": "Construct a program that, on a one-dimensional uniform grid with spacing $h$, builds Finite Difference (FD) stencils for the second derivative $\\partial_{xx} u$ that are exactly differentiating polynomials up to degree $p$. Use the Taylor series as the fundamental base to derive the algebraic conditions that the stencil weights must satisfy for polynomial exactness. Your program must:\n\n1. From the Taylor series expansion of a sufficiently smooth function $u(x)$ about a point $x_0$, derive the moment conditions that FD weights $\\{\\alpha_i\\}_{i=0}^{p}$ must satisfy so that the FD approximation\n$$\n\\partial_{xx} u(x_0) \\approx \\frac{1}{h^2} \\sum_{i=0}^{p} \\alpha_i \\, u\\!\\left(x_0 + s_i h\\right)\n$$\nis exact for all polynomials $u(x)$ of degree up to $p$, where $\\{s_i\\}$ are the integer offsets specifying the stencil locations relative to $x_0$. Do not use any pre-tabulated formulas; derive the linear system from first principles.\n\n2. Implement a solver that, for a given integer degree $p \\ge 2$ and a specified stencil geometry (interior symmetric or boundary one-sided), constructs offsets $\\{s_i\\}$ and solves the resulting linear system for the weights $\\{\\alpha_i\\}$ ensuring exactness up to degree $p$. Use $p+1$ points:\n   - Interior symmetric stencils: for even $p$, choose offsets $s_i \\in \\{-\\frac{p}{2}, -\\frac{p}{2}+1, \\dots, \\frac{p}{2}\\}$, centered at $x_0$.\n   - Boundary one-sided stencils: choose offsets $s_i \\in \\{0,1,2,\\dots,p\\}$ at the left boundary $x_0$.\n\n3. Quantify the benefits for modeling smooth background fields in gravitational and magnetic surveying by evaluating approximation errors for a composite smooth background profile\n$$\nu(x) = 10^{-3} x^3 + \\sin(0.3 x),\n$$\nwhere the angle in the sine function is in radians. For this profile, report the maximum absolute error of your FD approximation to $\\partial_{xx} u(x)$ across specified grid points. The composite profile mimics a slowly varying gravitational background (polynomial trend) superimposed with a smooth magnetic variation (sinusoid). Treat all quantities as non-dimensionalized, so no physical units are required.\n\nBase your derivation on the Taylor series expansion\n$$\nu(x_0 + s h) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0)}{k!} (s h)^k,\n$$\nand the definition of the second derivative $u''(x_0) = \\partial_{xx} u(x_0)$.\n\nYour program must produce the FD weights by solving the linear system implied by exactness up to degree $p$ and then compute the requested errors. Do not rely on any specialized finite-difference libraries or shortcut formulas.\n\nTest Suite:\n- Use the following grid setups and degrees $p$.\n  - Polynomial exactness tests on an interior grid:\n    1. Case A: $p=2$, domain $x \\in [0,1]$, $N=101$ equally spaced points, $h = 1/100$, interior symmetric stencil, evaluate over interior points excluding $1$ grid cell near each boundary. For each polynomial $x^k$, $k=0,1,2$, compute the maximum absolute error between the FD approximation and the exact $\\partial_{xx} x^k$, and report the single maximum across all three $k$ values.\n    2. Case B: $p=6$, same domain and grid as Case A, interior symmetric stencil excluding $3$ cells near each boundary, polynomials $x^k$ for $k=0,1,2,3,4,5,6$, and report the maximum absolute error across all $k$ and interior points.\n\n  - Polynomial exactness test at the left boundary:\n    3. Case C: $p=6$, domain $x \\in [0,1]$, $N=101$, one-sided stencil at $x_0=0$ with offsets $\\{0,1,2,3,4,5,6\\}$. For polynomials $x^k$, $k=0,1,\\dots,6$, compute the maximum absolute error of the FD approximation at $x_0=0$.\n\n  - Smooth background composite profile tests:\n    4. Case D: $p=2$, domain $x \\in [0,10]$, $N=1001$, interior symmetric stencil excluding $1$ cell near boundaries; compute the maximum absolute error of the FD approximation to $\\partial_{xx} u(x)$ across interior points.\n    5. Case E: $p=4$, same domain and grid as Case D, interior symmetric stencil excluding $2$ cells near boundaries; report the maximum absolute error as in Case D.\n    6. Case F: $p=6$, same domain and grid as Case D, interior symmetric stencil excluding $3$ cells near boundaries; report the maximum absolute error as in Case D.\n    7. Case G: $p=6$, same domain and grid as Case D, one-sided left boundary stencil at $x_0=0$; report the absolute error at the boundary point.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the seven results in the order of Cases A through G, as a comma-separated list enclosed in square brackets, for example, \"[resultA,resultB,resultC,resultD,resultE,resultF,resultG]\". All seven results must be floating-point numbers. Angles must be interpreted as radians. No physical units are required because the variables are non-dimensionalized.",
            "solution": "The problem requires the construction and evaluation of finite difference (FD) stencils for the second derivative, $\\partial_{xx} u$, ensuring exactness for polynomials up to a specified degree $p$. The derivation must be based on first principles using the Taylor series expansion.\n\n### Derivation of Finite Difference Stencil Weights\n\nThe general form of a finite difference approximation for the second derivative of a function $u(x)$ at a point $x_0$ on a uniform grid with spacing $h$ is given by:\n$$\n\\partial_{xx} u(x_0) \\approx \\frac{1}{h^2} \\sum_{i=0}^{p} \\alpha_i u(x_0 + s_i h)\n$$\nHere, $\\{\\alpha_i\\}_{i=0}^{p}$ are the unknown dimensionless weights, and $\\{s_i\\}_{i=0}^{p}$ are integer offsets that define the stencil geometry relative to $x_0$. We use $p+1$ points to construct the stencil.\n\nTo determine the weights $\\alpha_i$, we require that this approximation be exact for all polynomials up to degree $p$. This is equivalent to matching the Taylor series expansion of the right-hand side with the exact second derivative, $u''(x_0)$.\n\nThe Taylor series expansion of $u(x)$ around $x_0$ is:\n$$\nu(x_0 + \\Delta x) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0)}{k!} (\\Delta x)^k\n$$\nwhere $u^{(k)}(x_0)$ is the $k$-th derivative of $u$ at $x_0$. Substituting $\\Delta x = s_i h$ for each term in the FD sum, we get:\n$$\nu(x_0 + s_i h) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0)}{k!} (s_i h)^k\n$$\nNow, we substitute this expansion into the FD formula:\n$$\n\\frac{1}{h^2} \\sum_{i=0}^{p} \\alpha_i \\left( \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0)}{k!} (s_i h)^k \\right)\n$$\nBy linearity, we can swap the order of summation:\n$$\n\\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0) h^k}{h^2 k!} \\left( \\sum_{i=0}^{p} \\alpha_i s_i^k \\right)\n$$\nWe want this expression to be equal to $u''(x_0)$. This means the coefficient of $u^{(2)}(x_0)$ must be $1$, and the coefficients of all other derivatives $u^{(k)}(x_0)$ for $k \\neq 2$ must be zero, at least for $k \\le p$. Let us examine the coefficients for each derivative term $u^{(k)}(x_0)$:\n\nFor $k=0$: The coefficient is $\\frac{h^0}{h^2 0!} \\sum_{i=0}^{p} \\alpha_i s_i^0 = \\frac{1}{h^2} \\sum_{i=0}^{p} \\alpha_i$. For this term to be zero, we must have:\n$$\n\\sum_{i=0}^{p} \\alpha_i s_i^0 = \\sum_{i=0}^{p} \\alpha_i = 0\n$$\n\nFor $k=1$: The coefficient is $\\frac{h^1}{h^2 1!} \\sum_{i=0}^{p} \\alpha_i s_i^1 = \\frac{1}{h} \\sum_{i=0}^{p} \\alpha_i s_i$. For this term to be zero:\n$$\n\\sum_{i=0}^{p} \\alpha_i s_i^1 = 0\n$$\n\nFor $k=2$: The coefficient is $\\frac{h^2}{h^2 2!} \\sum_{i=0}^{p} \\alpha_i s_i^2 = \\frac{1}{2} \\sum_{i=0}^{p} \\alpha_i s_i^2$. We require this to be $1$:\n$$\n\\frac{1}{2} \\sum_{i=0}^{p} \\alpha_i s_i^2 = 1 \\implies \\sum_{i=0}^{p} \\alpha_i s_i^2 = 2\n$$\n\nFor $k \\in \\{3, 4, \\dots, p\\}$: The coefficient is $\\frac{h^k}{h^2 k!} \\sum_{i=0}^{p} \\alpha_i s_i^k$. For these terms to be zero:\n$$\n\\sum_{i=0}^{p} \\alpha_i s_i^k = 0\n$$\n\nThese $p+1$ equations form a system of linear equations for the $p+1$ unknown weights $\\{\\alpha_i\\}$. We can express this system in matrix form, $\\mathbf{M} \\boldsymbol{\\alpha} = \\mathbf{b}$, where $\\boldsymbol{\\alpha} = [\\alpha_0, \\alpha_1, \\dots, \\alpha_p]^T$:\n$$\n\\begin{pmatrix}\ns_0^0     s_1^0     \\dots   s_p^0    \\\\\ns_0^1     s_1^1     \\dots   s_p^1    \\\\\ns_0^2     s_1^2     \\dots   s_p^2    \\\\\n\\vdots    \\vdots    \\ddots  \\vdots   \\\\\ns_0^p     s_1^p     \\dots   s_p^p\n\\end{pmatrix}\n\\begin{pmatrix}\n\\alpha_0 \\\\\n\\alpha_1 \\\\\n\\alpha_2 \\\\\n\\vdots \\\\\n\\alpha_p\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n2 \\\\\n\\vdots \\\\\n0\n\\end{pmatrix}\n$$\nThe coefficient matrix $\\mathbf{M}$ is a Vandermonde matrix, with elements $M_{ki} = s_i^k$. As long as the stencil points $s_i$ are distinct, this matrix is invertible, guaranteeing a unique solution for the weights $\\boldsymbol{\\alpha}$.\n\n### Implementation and Evaluation Strategy\n\nThe procedure involves the following steps for each test case:\n1.  **Define Stencil Geometry**: For a given degree $p$, determine the integer offsets $\\{s_i\\}$. For symmetric interior stencils with even $p$, $s_i \\in \\{ -p/2, \\dots, p/2 \\}$. For one-sided boundary stencils, $s_i \\in \\{ 0, \\dots, p \\}$.\n2.  **Solve for Weights**: Construct the Vandermonde matrix $\\mathbf{M}$ and the right-hand side vector $\\mathbf{b}$ as derived above. Solve the linear system $\\mathbf{M} \\boldsymbol{\\alpha} = \\mathbf{b}$ to find the weights $\\boldsymbol{\\alpha}$.\n3.  **Apply Stencil and Compute Error**:\n    *   Define the grid, test function $u(x)$, and its exact second derivative $u''(x)$.\n    *   At each specified evaluation point $x_j$, gather the function values $u(x_j + s_i h)$ required by the stencil.\n    *   Compute the FD approximation: $u''_{FD}(x_j) = \\frac{1}{h^2} \\sum_i \\alpha_i u(x_j + s_i h)$.\n    *   Calculate the absolute error $|u''_{FD}(x_j) - u''(x_j)|$.\n    *   Report the maximum of these errors over the specified domain or at the specified point, as required by the test case.\n\nFor polynomial exactness tests (Cases A, B, C), the theoretical error is zero, so the computed error should be on the order of machine floating-point precision. For the smooth composite function (Cases D-G), the error is expected to decrease as the degree of exactness $p$ increases, demonstrating the benefit of higher-order methods for resolving smooth fields. The order of accuracy for a symmetric stencil of degree $p$ (where $p$ is even) is $\\mathcal{O}(h^p)$, as the error term associated with the odd power $u^{(p+1)}$ cancels due to symmetry. For a one-sided stencil, the order is generally $\\mathcal{O}(h^{p-1})$. This explains why higher-order stencils yield significantly smaller errors for smooth functions, a crucial aspect in computational geophysics for accurately capturing background field variations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_stencil_weights(p, s_offsets):\n    \"\"\"\n    Computes finite difference weights for the second derivative.\n    The stencil must be exact for polynomials up to degree p.\n\n    Args:\n        p (int): The maximum degree of the polynomial for which the stencil is exact.\n        s_offsets (np.ndarray): An array of p+1 integer offsets for the stencil points.\n\n    Returns:\n        np.ndarray: The array of p+1 stencil weights.\n    \"\"\"\n    if len(s_offsets) != p + 1:\n        raise ValueError(\"Number of offsets must be p + 1.\")\n    \n    # Construct the Vandermonde matrix M, where M[k, i] = s_offsets[i]**k\n    # for k in 0..p and i in 0..p\n    M = np.vander(s_offsets, N=p + 1, increasing=True).T\n    \n    # Construct the right-hand side vector b\n    b = np.zeros(p + 1)\n    b[2] = 2.0  # The condition for the second derivative\n    \n    # Solve the linear system M @ alpha = b for the weights alpha\n    weights = np.linalg.solve(M, b)\n    return weights\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    results = []\n\n    # --- Case A: p=2, interior, polynomial exactness ---\n    p_A = 2\n    N_A = 101\n    x_A = np.linspace(0.0, 1.0, N_A)\n    h_A = 1.0 / (N_A - 1)\n    p_half_A = p_A // 2\n    s_offsets_A = np.arange(-p_half_A, p_half_A + 1)\n    weights_A = get_stencil_weights(p_A, s_offsets_A)\n    \n    max_err_A = 0.0\n    for k in range(p_A + 1):\n        u_poly = x_A**k\n        if k  2:\n            u_xx_exact_poly = np.zeros_like(x_A)\n        else:\n            u_xx_exact_poly = k * (k - 1) * x_A**(k - 2)\n\n        for j in range(p_half_A, N_A - p_half_A):\n            u_values = u_poly[j - p_half_A : j + p_half_A + 1]\n            u_xx_fd = np.dot(weights_A, u_values) / h_A**2\n            err = np.abs(u_xx_fd - u_xx_exact_poly[j])\n            if err > max_err_A:\n                max_err_A = err\n    results.append(max_err_A)\n\n    # --- Case B: p=6, interior, polynomial exactness ---\n    p_B = 6\n    N_B = 101\n    x_B = np.linspace(0.0, 1.0, N_B)\n    h_B = 1.0 / (N_B - 1)\n    p_half_B = p_B // 2\n    s_offsets_B = np.arange(-p_half_B, p_half_B + 1)\n    weights_B = get_stencil_weights(p_B, s_offsets_B)\n\n    max_err_B = 0.0\n    for k in range(p_B + 1):\n        u_poly = x_B**k\n        if k  2:\n            u_xx_exact_poly = np.zeros_like(x_B)\n        else:\n            u_xx_exact_poly = k * (k - 1) * x_B**(k - 2)\n            \n        for j in range(p_half_B, N_B - p_half_B):\n            u_values = u_poly[j - p_half_B : j + p_half_B + 1]\n            u_xx_fd = np.dot(weights_B, u_values) / h_B**2\n            err = np.abs(u_xx_fd - u_xx_exact_poly[j])\n            if err > max_err_B:\n                max_err_B = err\n    results.append(max_err_B)\n\n    # --- Case C: p=6, boundary, polynomial exactness ---\n    p_C = 6\n    N_C = 101\n    x_C = np.linspace(0.0, 1.0, N_C)\n    h_C = 1.0 / (N_C - 1)\n    s_offsets_C = np.arange(p_C + 1)\n    weights_C = get_stencil_weights(p_C, s_offsets_C)\n    \n    max_err_C = 0.0\n    for k in range(p_C + 1):\n        u_poly = x_C**k\n        if k  2:\n            u_xx_exact_val = 0.0\n        else:\n            u_xx_exact_val = k * (k - 1) * x_C[0]**(k - 2)\n\n        u_values = u_poly[0 : p_C + 1]\n        u_xx_fd = np.dot(weights_C, u_values) / h_C**2\n        err = np.abs(u_xx_fd - u_xx_exact_val)\n        if err > max_err_C:\n            max_err_C = err\n    results.append(max_err_C)\n\n    # --- Setup for Cases D, E, F, G (Smooth Profile) ---\n    N_smooth = 1001\n    x_smooth = np.linspace(0.0, 10.0, N_smooth)\n    h_smooth = 10.0 / (N_smooth - 1)\n    u_smooth = 1e-3 * x_smooth**3 + np.sin(0.3 * x_smooth)\n    u_xx_exact_smooth = 6e-3 * x_smooth - (0.3**2) * np.sin(0.3 * x_smooth)\n\n    # --- Case D: p=2, interior, smooth profile ---\n    p_D = 2\n    p_half_D = p_D // 2\n    s_offsets_D = np.arange(-p_half_D, p_half_D + 1)\n    weights_D = get_stencil_weights(p_D, s_offsets_D)\n    \n    u_xx_fd_D = np.zeros(N_smooth)\n    eval_indices_D = range(p_half_D, N_smooth - p_half_D)\n    for j in eval_indices_D:\n        u_values = u_smooth[j - p_half_D : j + p_half_D + 1]\n        u_xx_fd_D[j] = np.dot(weights_D, u_values) / h_smooth**2\n    max_err_D = np.max(np.abs(u_xx_fd_D[list(eval_indices_D)] - u_xx_exact_smooth[list(eval_indices_D)]))\n    results.append(max_err_D)\n    \n    # --- Case E: p=4, interior, smooth profile ---\n    p_E = 4\n    p_half_E = p_E // 2\n    s_offsets_E = np.arange(-p_half_E, p_half_E + 1)\n    weights_E = get_stencil_weights(p_E, s_offsets_E)\n\n    u_xx_fd_E = np.zeros(N_smooth)\n    eval_indices_E = range(p_half_E, N_smooth - p_half_E)\n    for j in eval_indices_E:\n        u_values = u_smooth[j - p_half_E : j + p_half_E + 1]\n        u_xx_fd_E[j] = np.dot(weights_E, u_values) / h_smooth**2\n    max_err_E = np.max(np.abs(u_xx_fd_E[list(eval_indices_E)] - u_xx_exact_smooth[list(eval_indices_E)]))\n    results.append(max_err_E)\n\n    # --- Case F: p=6, interior, smooth profile ---\n    p_F = 6\n    p_half_F = p_F // 2\n    s_offsets_F = np.arange(-p_half_F, p_half_F + 1)\n    weights_F = get_stencil_weights(p_F, s_offsets_F)\n    \n    u_xx_fd_F = np.zeros(N_smooth)\n    eval_indices_F = range(p_half_F, N_smooth - p_half_F)\n    for j in eval_indices_F:\n        u_values = u_smooth[j - p_half_F : j + p_half_F + 1]\n        u_xx_fd_F[j] = np.dot(weights_F, u_values) / h_smooth**2\n    max_err_F = np.max(np.abs(u_xx_fd_F[list(eval_indices_F)] - u_xx_exact_smooth[list(eval_indices_F)]))\n    results.append(max_err_F)\n\n    # --- Case G: p=6, boundary, smooth profile ---\n    p_G = 6\n    s_offsets_G = np.arange(p_G + 1)\n    weights_G = get_stencil_weights(p_G, s_offsets_G)\n\n    u_values_G = u_smooth[0 : p_G + 1]\n    u_xx_fd_G = np.dot(weights_G, u_values_G) / h_smooth**2\n    err_G = np.abs(u_xx_fd_G - u_xx_exact_smooth[0])\n    results.append(err_G)\n    \n    # Final print statement\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}