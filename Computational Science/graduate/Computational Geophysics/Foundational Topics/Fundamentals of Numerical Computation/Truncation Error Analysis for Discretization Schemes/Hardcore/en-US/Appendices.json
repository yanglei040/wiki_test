{
    "hands_on_practices": [
        {
            "introduction": "The foundation of analyzing any discretization scheme is the Taylor series, which connects the discrete world of grid points to the continuous world of derivatives. This first exercise provides direct, hands-on practice in using Taylor expansions to systematically construct a numerical scheme and quantify its error. By deriving the weights for a high-order accurate stencil from first principles , you will gain a concrete understanding of how a method's formal accuracy and its leading truncation error term are determined.",
            "id": "3617972",
            "problem": "In high-order finite difference discretizations used in computational geophysics, accurate spatial gradients of smooth fields are needed to reduce numerical dispersion in wave propagation simulations governed by Partial Differential Equations (PDE). Consider a smooth scalar geophysical field $u(x)$ sampled on a uniform grid with spacing $h$ at points $x_i + m h$ for integer offsets $m \\in \\{-2,-1,0,1,2\\}$. You aim to approximate the first spatial derivative $u_x(x_i)$ using a centered five-point stencil of the form\n$$\nD u_i \\equiv \\frac{1}{h} \\sum_{m=-2}^{2} w_m \\, u(x_i + m h),\n$$\nwith weights $w_m$ chosen so that $D u_i$ is fourth-order accurate at $x_i$. Starting from the Taylor series expansion of $u(x_i + m h)$ about $x_i$, determine the weights $w_m$ by matching coefficients so that $D u_i - u_x(x_i)$ vanishes through terms proportional to $h^k$ for $k = 0,1,2,3,4$ except for the correctly reproduced $u_x(x_i)$ term. Assume a centered stencil consistent with a first derivative, that is, $w_{-m} = - w_m$ for $m = 1,2$. Then, using the resulting weights, compute the leading truncation error coefficient $C$ defined by\n$$\nD u_i - u_x(x_i) = C \\, h^4 \\, u^{(5)}(x_i) + \\mathcal{O}(h^6).\n$$\nExpress the final coefficient $C$ as an exact rational number. No rounding is required and no units are associated with $C$.",
            "solution": "The user has requested the derivation of finite difference weights for a fourth-order accurate, five-point centered stencil for the first derivative, and the subsequent calculation of the leading truncation error coefficient.\n\nThe problem statement is scientifically grounded, well-posed, and objective. It represents a standard and fundamental problem in numerical analysis, specifically in the context of creating high-order accurate finite difference schemes for solving partial differential equations. The provided information is complete and consistent, allowing for a unique solution. The problem is therefore valid.\n\nThe objective is to find the weights $w_m$ and the coefficient $C$ for the approximation:\n$$\nD u_i \\equiv \\frac{1}{h} \\sum_{m=-2}^{2} w_m \\, u(x_i + m h) \\approx u_x(x_i)\n$$\nsuch that the truncation error is $\\mathcal{O}(h^4)$. The truncation error is defined as:\n$$\nD u_i - u_x(x_i) = C \\, h^4 \\, u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n\nThe stencil is centered and approximates a first derivative, which implies an anti-symmetric weight distribution: $w_{-m} = -w_m$. For the central point $m=0$, this condition gives $w_0 = -w_0$, which is only satisfied if $w_0=0$. With this condition, the approximation can be written as:\n$$\nD u_i = \\frac{1}{h} \\left( w_{-2} u(x_i - 2h) + w_{-1} u(x_i - h) + w_1 u(x_i + h) + w_2 u(x_i + 2h) \\right)\n$$\n$$\nD u_i = \\frac{1}{h} \\left( w_1 (u(x_i+h) - u(x_i-h)) + w_2 (u(x_i+2h) - u(x_i-2h)) \\right)\n$$\nTo determine the unknown weights $w_1$ and $w_2$, we expand the terms $u(x_i+mh)$ in a Taylor series around the point $x_i$. Let $u^{(k)}(x_i)$ denote the $k$-th derivative of $u$ at $x_i$. The expansions are:\n$$\nu(x_i \\pm mh) = u(x_i) \\pm (mh)u^{(1)}(x_i) + \\frac{(mh)^2}{2!}u^{(2)}(x_i) \\pm \\frac{(mh)^3}{3!}u^{(3)}(x_i) + \\frac{(mh)^4}{4!}u^{(4)}(x_i) \\pm \\frac{(mh)^5}{5!}u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nWe form the differences required by the stencil. The even-powered terms cancel out:\n$$\nu(x_i+h) - u(x_i-h) = 2h u^{(1)}(x_i) + \\frac{2h^3}{6} u^{(3)}(x_i) + \\frac{2h^5}{120} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n$$\nu(x_i+2h) - u(x_i-2h) = 2(2h) u^{(1)}(x_i) + \\frac{2(2h)^3}{6} u^{(3)}(x_i) + \\frac{2(2h)^5}{120} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\nSimplifying these expressions gives:\n$$\nu(x_i+h) - u(x_i-h) = 2h u^{(1)}(x_i) + \\frac{h^3}{3} u^{(3)}(x_i) + \\frac{h^5}{60} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n$$\nu(x_i+2h) - u(x_i-2h) = 4h u^{(1)}(x_i) + \\frac{8h^3}{3} u^{(3)}(x_i) + \\frac{8h^5}{15} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\nNow, substitute these expansions back into the expression for $D u_i$:\n$$\nD u_i = \\frac{w_1}{h} \\left( 2h u^{(1)}(x_i) + \\frac{h^3}{3} u^{(3)}(x_i) + \\frac{h^5}{60} u^{(5)}(x_i) + \\dots \\right) + \\frac{w_2}{h} \\left( 4h u^{(1)}(x_i) + \\frac{8h^3}{3} u^{(3)}(x_i) + \\frac{8h^5}{15} u^{(5)}(x_i) + \\dots \\right)\n$$\nWe can group the terms by the order of the derivative of $u$:\n$$\nD u_i = (2w_1 + 4w_2) u^{(1)}(x_i) + \\left(\\frac{w_1}{3} + \\frac{8w_2}{3}\\right) h^2 u^{(3)}(x_i) + \\left(\\frac{w_1}{60} + \\frac{8w_2}{15}\\right) h^4 u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nTo achieve a fourth-order accurate approximation of $u_x(x_i) = u^{(1)}(x_i)$, we must ensure that the coefficient of $u^{(1)}(x_i)$ is $1$, and the coefficients of higher-order derivative terms vanish up to the desired order. The error term should start at $\\mathcal{O}(h^4)$.\n1.  The coefficient of $u^{(1)}(x_i)$ must be $1$:\n    $$2w_1 + 4w_2 = 1 \\quad (1)$$\n2.  The coefficient of $h^2 u^{(3)}(x_i)$ must be $0$ to eliminate the $\\mathcal{O}(h^2)$ error term:\n    $$\\frac{w_1}{3} + \\frac{8w_2}{3} = 0 \\implies w_1 + 8w_2 = 0 \\quad (2)$$\n\nWe now have a system of two linear equations for the two unknown weights $w_1$ and $w_2$. From equation $(2)$, we express $w_1$ in terms of $w_2$:\n$$\nw_1 = -8w_2\n$$\nSubstitute this into equation $(1)$:\n$$\n2(-8w_2) + 4w_2 = 1\n$$\n$$\n-16w_2 + 4w_2 = 1\n$$\n$$\n-12w_2 = 1 \\implies w_2 = -\\frac{1}{12}\n$$\nNow, we find $w_1$:\n$$\nw_1 = -8 \\left(-\\frac{1}{12}\\right) = \\frac{8}{12} = \\frac{2}{3}\n$$\nThe complete set of weights for the stencil is:\n$w_2 = -1/12$, $w_1 = 2/3$, $w_0 = 0$, $w_{-1} = -2/3$, $w_{-2} = 1/12$.\n\nWith these weights, the terms for $u^{(1)}$ and $u^{(3)}$ are correct. The leading term of the truncation error is the first non-zero term, which is the $h^4 u^{(5)}(x_i)$ term.\n$$\nD u_i - u_x(x_i) = \\left(\\frac{w_1}{60} + \\frac{8w_2}{15}\\right) h^4 u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nThe coefficient $C$ is therefore:\n$$\nC = \\frac{w_1}{60} + \\frac{8w_2}{15}\n$$\nSubstituting the derived values of $w_1$ and $w_2$:\n$$\nC = \\frac{2/3}{60} + \\frac{8(-1/12)}{15} = \\frac{2}{3 \\cdot 60} - \\frac{8}{12 \\cdot 15}\n$$\n$$\nC = \\frac{2}{180} - \\frac{8}{180} = \\frac{2-8}{180} = \\frac{-6}{180}\n$$\nSimplifying the fraction gives the final result for the coefficient $C$:\n$$\nC = -\\frac{1}{30}\n$$",
            "answer": "$$\n\\boxed{-\\frac{1}{30}}\n$$"
        },
        {
            "introduction": "Building on the fundamental skill of deriving truncation errors, this practice explores a crucial real-world challenge: maintaining accuracy at domain boundaries. While high-order schemes offer excellent performance in the interior of a computational domain, boundaries often require special, and sometimes lower-order, formulas to be implemented. This exercise  guides you to analyze the local truncation error of such a boundary scheme, providing vital insight into how local inaccuracies can potentially degrade the global order of convergence of the entire simulation.",
            "id": "3617929",
            "problem": "Consider a one-dimensional vertical column model of mantle heat conduction in computational geophysics in which the temperature field $T(z)$ is smooth and admits at least six continuous derivatives on $z \\in [0,L]$. The governing operator is the second spatial derivative $T''(z)$, which arises, for example, from the diffusion term in a parabolic partial differential equation (PDE). Let the spatial domain be discretized on a uniform grid $z_i = i h$ for $i = 0,1,\\dots,N$ with $h = L/N$. Assume a Dirichlet boundary condition at the top surface $z=0$ is imposed exactly, so $T_0 = T(0)$.\n\nFor interior points $i = 2,3,\\dots,N-2$, suppose $T''(z)$ is approximated using a fourth-order Compact Finite Difference (CFD) scheme defined by the symmetric tridiagonal relation\n$$\n\\frac{1}{10} \\, \\delta_{zz} T_{i-1} + \\delta_{zz} T_{i} + \\frac{1}{10} \\, \\delta_{zz} T_{i+1} = \\frac{6}{5} \\, \\frac{T_{i-1} - 2 T_{i} + T_{i+1}}{h^{2}},\n$$\nwhere $\\delta_{zz} T_{i}$ denotes the discrete approximation to $T''(z_i)$. To close the system near the Dirichlet boundary, adopt the following specific second-order boundary closure at the first interior point $i=1$:\n$$\n\\delta_{zz} T_{1} = \\frac{T_{0} - 2 T_{1} + T_{2}}{h^{2}}.\n$$\n\nDefine the local boundary truncation error at $i=1$ as\n$$\n\\tau_{1} \\equiv \\delta_{zz} T_{1} - T''(z_{1}),\n$$\nwith $z_{1} = h$. Using only well-tested formulas and facts, in particular Taylor series expansions about $z_{1}$ for $T(z)$, derive the leading-order term of $\\tau_{1}$ in closed form. Express your final answer as a single analytic expression in terms of $h$ and derivatives of $T$ evaluated at $z_{1}$. No rounding is required.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of numerical analysis and computational physics, is well-posed with a clear objective, and is free of any inconsistencies, ambiguities, or factual errors. The task is a standard derivation of the local truncation error for a finite difference scheme, a fundamental concept in the analysis of numerical methods for differential equations.\n\nThe objective is to find the leading-order term of the local boundary truncation error, $\\tau_{1}$, at the grid point $i=1$. The truncation error is defined as the difference between the discrete operator and the continuous operator it approximates, when applied to the exact solution $T(z)$.\nThe definition is given as:\n$$\n\\tau_{1} \\equiv \\delta_{zz} T_{1} - T''(z_{1})\n$$\nThe finite difference approximation for the second derivative at the point $z_1 = h$ is:\n$$\n\\delta_{zz} T_{1} = \\frac{T_{0} - 2 T_{1} + T_{2}}{h^{2}}\n$$\nTo analyze the truncation error, we substitute the exact solution $T(z)$ evaluated at the grid points into this formula. The grid points are $z_0 = 0$, $z_1 = h$, and $z_2 = 2h$.\n$$\n\\tau_{1} = \\frac{T(z_0) - 2 T(z_1) + T(z_2)}{h^{2}} - T''(z_1)\n$$\nThe problem specifies using Taylor series expansions about the point $z_1 = h$. The locations $z_0$ and $z_2$ can be expressed relative to $z_1$ as $z_0 = z_1 - h$ and $z_2 = z_1 + h$. The problem states that $T(z)$ has at least six continuous derivatives, which justifies the use of high-order Taylor expansions.\n\nWe expand $T(z_0)$ and $T(z_2)$ around $z_1$:\nThe expansion for $T(z_0) = T(z_1 - h)$ is:\n$$\nT(z_1 - h) = T(z_1) - h T'(z_1) + \\frac{h^2}{2!} T''(z_1) - \\frac{h^3}{3!} T^{(3)}(z_1) + \\frac{h^4}{4!} T^{(4)}(z_1) - \\frac{h^5}{5!} T^{(5)}(z_1) + O(h^6)\n$$\nThe expansion for $T(z_2) = T(z_1 + h)$ is:\n$$\nT(z_1 + h) = T(z_1) + h T'(z_1) + \\frac{h^2}{2!} T''(z_1) + \\frac{h^3}{3!} T^{(3)}(z_1) + \\frac{h^4}{4!} T^{(4)}(z_1) + \\frac{h^5}{5!} T^{(5)}(z_1) + O(h^6)\n$$\nwhere $T^{(n)}(z_1)$ denotes the $n$-th derivative of $T(z)$ with respect to $z$, evaluated at $z=z_1$.\n\nNext, we evaluate the numerator of the finite difference fraction, $T(z_0) - 2 T(z_1) + T(z_2)$. We first sum the two expansions:\n$$\nT(z_0) + T(z_2) = \\left( T(z_1) - h T'(z_1) + \\frac{h^2}{2} T''(z_1) - \\ldots \\right) + \\left( T(z_1) + h T'(z_1) + \\frac{h^2}{2} T''(z_1) + \\ldots \\right)\n$$\nThe terms with odd powers of $h$ cancel out:\n$$\nT(z_0) + T(z_2) = 2 T(z_1) + 2 \\left( \\frac{h^2}{2!} T''(z_1) \\right) + 2 \\left( \\frac{h^4}{4!} T^{(4)}(z_1) \\right) + O(h^6)\n$$\n$$\nT(z_0) + T(z_2) = 2 T(z_1) + h^2 T''(z_1) + \\frac{h^4}{12} T^{(4)}(z_1) + O(h^6)\n$$\nNow, we subtract $2 T(z_1)$ to complete the numerator:\n$$\nT(z_0) - 2 T(z_1) + T(z_2) = \\left( 2 T(z_1) + h^2 T''(z_1) + \\frac{h^4}{12} T^{(4)}(z_1) + O(h^6) \\right) - 2 T(z_1)\n$$\n$$\nT(z_0) - 2 T(z_1) + T(z_2) = h^2 T''(z_1) + \\frac{h^4}{12} T^{(4)}(z_1) + O(h^6)\n$$\nWe substitute this expression back into the formula for the discrete operator, $\\delta_{zz} T_{1}$:\n$$\n\\delta_{zz} T_{1} = \\frac{h^2 T''(z_1) + \\frac{h^4}{12} T^{(4)}(z_1) + O(h^6)}{h^2}\n$$\n$$\n\\delta_{zz} T_{1} = T''(z_1) + \\frac{h^2}{12} T^{(4)}(z_1) + O(h^4)\n$$\nFinally, we compute the local truncation error $\\tau_1$ by subtracting the exact derivative $T''(z_1)$:\n$$\n\\tau_1 = \\delta_{zz} T_{1} - T''(z_1) = \\left( T''(z_1) + \\frac{h^2}{12} T^{(4)}(z_1) + O(h^4) \\right) - T''(z_1)\n$$\n$$\n\\tau_1 = \\frac{h^2}{12} T^{(4)}(z_1) + O(h^4)\n$$\nThe problem asks for the leading-order term of this error. The leading-order term is the first non-zero term in the expansion in powers of the grid spacing $h$. This term is second-order in $h$.\n\nThus, the leading-order term of the local boundary truncation error $\\tau_1$ at $z_1=h$ is $\\frac{h^2}{12} T^{(4)}(z_1)$. This result confirms that the given boundary closure scheme is second-order accurate.",
            "answer": "$$\n\\boxed{\\frac{h^{2}}{12} T^{(4)}(z_{1})}\n$$"
        },
        {
            "introduction": "In most scientific simulations, the exact solution to the governing equations is unknown, making direct measurement of the numerical error impossible. This final practice introduces Richardson extrapolation, a powerful a posteriori technique to estimate the error and verify the convergence rate using only the numerical solutions from different grid resolutions. By leveraging the asymptotic structure of the truncation error—the very concept analyzed in the previous exercises  —you will derive and implement an error estimator , bridging the gap between theoretical analysis and practical code verification.",
            "id": "3617978",
            "problem": "Consider a smooth scalar quantity of interest $Q$ extracted from the numerical solution of a Partial Differential Equation (PDE) on a uniform grid of spacing $h$. Assume the discretization scheme is consistent and stable, and its global error for $Q$ admits an asymptotic expansion $Q_h = Q + C_p h^p + C_{p+1} h^{p+1} + \\mathcal{O}(h^{p+2})$ for some integer order $p \\ge 1$, where $C_p$ is the leading truncation error constant that depends on the scheme, the PDE, boundary conditions, and the functional $Q$. The task is to use Richardson extrapolation on two nested grids of spacings $h$ and $h/2$ to derive an estimator for $C_p$, justify the assumptions under which it is valid, and implement it for specific test problems grounded in computational geophysics.\n\nYour program must:\n1. Derive, from first principles, an estimator for $C_p$ using the asymptotic error model and two solutions computed at spacings $h$ and $h/2$.\n2. Implement the estimator for the following tests in one spatial dimension, using the second-order centered finite difference discretization of the elliptic problem $-u''(x) = f(x)$ on the domain $[0,1]$ with homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$. In all cases, the exact solution is chosen as $u(x) = \\sin(k \\pi x)$, which implies $f(x) = k^2 \\pi^2 \\sin(k \\pi x)$, and the scheme has order $p = 2$. For a grid with $m$ interior points, use spacing $h = 1/(m+1)$ and interior grid points $x_j = j h$ for $j = 1, 2, \\dots, m$. Define the quantity of interest $Q$ as the solution’s pointwise value at a specified location $x_0$ that is a grid point for both the coarse grid of spacing $h$ and the fine grid of spacing $h/2$ (i.e., $x_0 = j h$ on the coarse grid and $x_0 = j' (h/2)$ on the fine grid).\n\nUse the following test suite:\n- Test $1$: $k = 1$, coarse grid interior points $m = 9$ (so $h = 1/10$), fine grid interior points $m' = 19$ (so $h' = h/2 = 1/20$), and $x_0 = 1/2$. Use $p = 2$.\n- Test $2$: $k = 3$, coarse grid interior points $m = 9$ (so $h = 1/10$), fine grid interior points $m' = 19$ (so $h' = h/2 = 1/20$), and $x_0 = 3/10$. Use $p = 2$.\n- Test $3$: $k = 1$, coarse grid interior points $m = 3$ (so $h = 1/4$), fine grid interior points $m' = 7$ (so $h' = h/2 = 1/8$), and $x_0 = 1/2$. Use $p = 2$.\n\nIn each test:\n- Assemble the discrete system for $-u''(x) = f(x)$ using the standard second-order centered finite difference stencil, which yields the linear system $A \\mathbf{u} = \\mathbf{f}$ with $A$ tridiagonal and $\\mathbf{f}$ evaluated at interior grid points.\n- Solve for $\\mathbf{u}$ on both grids.\n- Extract $Q_h$ and $Q_{h/2}$ as $\\mathbf{u}$ evaluated at $x_0$ on the coarse and fine grids, respectively.\n- Compute the Richardson-based estimator for $C_p$ derived in part $1$.\n\nAssumptions to state and justify for the estimator’s validity:\n- The scheme is consistent of order $p$ and stable, so the global error for $Q$ admits an asymptotic expansion $Q_h - Q = C_p h^p + C_{p+1} h^{p+1} + \\mathcal{O}(h^{p+2})$ for sufficiently small $h$.\n- The grids are uniform and nested, and the same discretization (including boundary treatment) is used for both $h$ and $h/2$.\n- The functional $Q$ is sufficiently smooth so that its discretization error inherits the scheme’s order $p$.\n- The leading constant $C_p$ is nonzero for the chosen $Q$, and round-off or solver error is negligible relative to truncation error at the chosen $h$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Tests $1$, $2$, and $3$, for example $[c_1,c_2,c_3]$, where each $c_i$ is the floating-point estimate of $C_p$ for the corresponding test. No units are needed, and angles do not appear.\n\nYour program must be self-contained and runnable as-is, and it must not read input from the user.",
            "solution": "The problem is assessed to be valid. It is a well-posed problem in numerical analysis, specifically concerning the analysis of truncation error for a finite difference scheme applied to a one-dimensional elliptic boundary value problem. All parameters and conditions are clearly defined, scientifically grounded, and internally consistent.\n\nThe solution proceeds in three parts: first, a derivation of the estimator for the leading truncation error constant $C_p$; second, a discussion of the assumptions justifying the estimator; and third, an outline of the numerical implementation for the specified test cases.\n\n**1. Derivation of the Estimator for $C_p$**\n\nThe problem states that a numerical quantity of interest, $Q_h$, computed on a grid with spacing $h$, possesses an asymptotic error expansion of the form:\n$$Q_h = Q + C_p h^p + C_{p+1} h^{p+1} + \\mathcal{O}(h^{p+2})$$\nHere, $Q$ is the exact value of the quantity, $p \\ge 1$ is the order of accuracy of the scheme, and $C_p$, $C_{p+1}$ are constants that are independent of $h$.\n\nWe are given two solutions computed on nested grids with spacings $h$ and $h/2$. Let these be $Q_h$ and $Q_{h/2}$, respectively. We can write the error expansion for each:\n$$Q_h = Q + C_p h^p + C_{p+1} h^{p+1} + \\mathcal{O}(h^{p+2}) \\quad (1)$$\n$$Q_{h/2} = Q + C_p \\left(\\frac{h}{2}\\right)^p + C_{p+1} \\left(\\frac{h}{2}\\right)^{p+1} + \\mathcal{O}(h^{p+2})$$\n$$Q_{h/2} = Q + \\frac{C_p}{2^p} h^p + \\frac{C_{p+1}}{2^{p+1}} h^{p+1} + \\mathcal{O}(h^{p+2}) \\quad (2)$$\n\nTo derive an estimator for $C_p$, we first eliminate the unknown exact value $Q$ by subtracting equation $(1)$ from equation $(2)$:\n$$Q_{h/2} - Q_h = \\left( \\frac{C_p}{2^p} h^p - C_p h^p \\right) + \\left( \\frac{C_{p+1}}{2^{p+1}} h^{p+1} - C_{p+1} h^{p+1} \\right) + \\mathcal{O}(h^{p+2})$$\n$$Q_{h/2} - Q_h = C_p h^p \\left( \\frac{1}{2^p} - 1 \\right) + C_{p+1} h^{p+1} \\left( \\frac{1}{2^{p+1}} - 1 \\right) + \\mathcal{O}(h^{p+2})$$\n\nTo obtain an estimator for $C_p$, we assume that $h$ is sufficiently small, such that the leading term $C_p h^p (...)$ dominates the higher-order terms. We can therefore truncate the series:\n$$Q_{h/2} - Q_h \\approx C_p h^p \\left( \\frac{1}{2^p} - 1 \\right)$$\nNow, we can solve for $C_p$:\n$$C_p \\approx \\frac{Q_{h/2} - Q_h}{h^p \\left( \\frac{1 - 2^p}{2^p} \\right)} = \\frac{Q_{h/2} - Q_h}{h^p} \\frac{2^p}{1 - 2^p}$$\nRearranging the numerator for a more conventional form gives the final expression for the estimator, which we shall denote $\\hat{C}_p$:\n$$\\hat{C}_p = \\frac{Q_h - Q_{h/2}}{h^p (2^p - 1)} 2^p = \\frac{2^p}{2^p - 1} \\frac{Q_h - Q_{h/2}}{h^p}$$\n\nThe problem specifies using a second-order scheme, so $p=2$. The estimator for the leading error constant $C_2$ becomes:\n$$\\hat{C}_2 = \\frac{2^2}{2^2 - 1} \\frac{Q_h - Q_{h/2}}{h^2} = \\frac{4}{3} \\frac{Q_h - Q_{h/2}}{h^2}$$\nThis expression will be used in the implementation.\n\n**2. Justification of Assumptions**\n\nThe validity of this estimator relies on several assumptions listed in the problem, which are justified in the context of the given PDE and numerical scheme.\n\n- **Asymptotic Error Expansion**: For the elliptic problem $-u''(x) = f(x)$ with a smooth source term $f(x)$ and solution $u(x)$, a centered finite difference scheme is known to produce a global error that admits such an asymptotic expansion in even powers of $h$. Since the exact solution $u(x) = \\sin(k\\pi x)$ and source term $f(x) = k^2\\pi^2\\sin(k\\pi x)$ are infinitely differentiable ($C^\\infty$), this assumption is well-founded.\n- **Nested Grids and Consistent Discretization**: The problem explicitly defines the fine grid to have spacing $h' = h/2$ by setting the number of interior fine grid points $m'$ to be $2m+1$ where $m$ is the number of interior coarse grid points. This construction ensures the grids are perfectly nested. Using the same standard second-order stencil for both grids satisfies the consistency requirement.\n- **Smooth Functional**: The quantity of interest $Q$ is the pointwise value of the solution, $Q[u] = u(x_0)$. This is a linear and well-behaved functional. The error of this functional, $u_h(x_0) - u(x_0)$, is known to inherit the order of the global error for the solution $u_h$, justifying its inclusion in the expansion.\n- **Non-zero $C_p$ and Negligible Round-off Error**: The leading error constant $C_p = C_2$ is proportional to the fourth derivative of the solution, $u^{(4)}(x)$. For $u(x) = \\sin(k\\pi x)$, we have $u^{(4)}(x) = (k\\pi)^4\\sin(k\\pi x)$. For all specified test cases, the evaluation point $x_0$ is chosen such that $\\sin(k\\pi x_0) \\neq 0$, ensuring that $C_2 \\neq 0$. The grid spacings ($h=1/10$ and $h=1/4$) are moderate, so truncation error is expected to dominate round-off error when using standard double-precision floating-point arithmetic.\n\n**3. Numerical Implementation**\n\nThe problem to be solved is $-u''(x) = f(x)$ on the domain $[0,1]$ with boundary conditions $u(0)=0$ and $u(1)=0$. We discretize the domain using $m$ interior grid points $x_j = j h$ for $j=1, 2, \\dots, m$, where $h = 1/(m+1)$.\n\nThe second-order centered difference approximation of $-u''$ at a point $x_j$ is:\n$$-u''(x_j) \\approx \\frac{-u(x_{j-1}) + 2u(x_j) - u(x_{j+1})}{h^2}$$\nLet $u_j$ be the numerical approximation to $u(x_j)$. The discrete system of equations is:\n$$\\frac{-u_{j-1} + 2u_j - u_{j+1}}{h^2} = f(x_j) \\quad \\text{for } j=1, \\dots, m$$\nThe boundary conditions $u_0=0$ and $u_{m+1}=0$ imply $u_0=0$ and $u_{m+1}=0$. The system can be written in matrix form $A\\mathbf{u} = \\mathbf{f}$, where $\\mathbf{u} = [u_1, u_2, \\dots, u_m]^T$ and $\\mathbf{f} = [f(x_1), f(x_2), \\dots, f(x_m)]^T$. The $m \\times m$ matrix $A$ is a symmetric positive-definite tridiagonal matrix:\n$$A = \\frac{1}{h^2} \\begin{pmatrix} 2  -1  0  \\dots  0 \\\\ -1  2  -1   \\vdots \\\\ 0  \\ddots  \\ddots  \\ddots  0 \\\\ \\vdots   -1  2  -1 \\\\ 0  \\dots  0  -1  2 \\end{pmatrix}$$\nFor each test case, we perform the following steps for both the coarse grid (spacing $h$) and the fine grid (spacing $h/2$):\n1. Construct the matrix $A$ and the right-hand side vector $\\mathbf{f}$.\n2. Solve the linear system $A\\mathbf{u} = \\mathbf{f}$ to obtain the numerical solution vector $\\mathbf{u}$.\n3. Extract the quantity of interest. Since $x_0$ is a grid point, $x_0 = j_0 h$ for some integer $j_0$. The value $Q$ is then the $j_0$-th element of the solution vector $\\mathbf{u}$ (accounting for $1$-based vs. $0$-based indexing, so it's `u[j_0-1]` in Python).\n4. With $Q_h$ and $Q_{h/2}$ computed, we apply the estimator formula derived above to find $\\hat{C}_2$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a Richardson-based estimator for the leading \n    truncation error constant C_p for a finite difference scheme applied \n    to a 1D elliptic PDE.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (k, m_coarse, x_0)\n    # The order p=2 is fixed for all tests.\n    test_cases = [\n        (1, 9, 0.5),   # Test 1\n        (3, 9, 0.3),   # Test 2\n        (1, 3, 0.5),   # Test 3\n    ]\n\n    def compute_Q_at_x0(k, m, x0):\n        \"\"\"\n        Solves the discrete system -u''=f on a grid with m interior points\n        and returns the numerical solution at the point x0.\n\n        Args:\n            k (int): Wavenumber for the exact solution u(x) = sin(k*pi*x).\n            m (int): Number of interior grid points.\n            x0 (float): The point at which to extract the solution value.\n\n        Returns:\n            float: The numerical solution u_h(x0).\n        \"\"\"\n        # 1. Define grid parameters\n        h = 1.0 / (m + 1)\n        \n        # 2. Set up the linear system A*u = f_vec\n        \n        # Create the grid points\n        x_grid = np.linspace(h, 1.0 - h, m)\n        \n        # Create the right-hand side vector f_vec\n        f_vec = (k * np.pi)**2 * np.sin(k * np.pi * x_grid)\n        \n        # Create the tridiagonal matrix A\n        main_diag = 2.0 * np.ones(m)\n        off_diag = -1.0 * np.ones(m - 1)\n        A = (np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)) / h**2\n        \n        # 3. Solve the linear system\n        u_vec = np.linalg.solve(A, f_vec)\n        \n        # 4. Extract solution at x0\n        # The grid points are x_j = j*h for j=1, ..., m.\n        # The corresponding Python index is j-1.\n        # We need to find the index corresponding to x0.\n        # j0 = x0/h\n        # Since x0 is guaranteed to be a grid point, this should be an integer.\n        # Use rounding for floating point safety.\n        j0 = int(round(x0 / h))\n        \n        # The python index is j0-1\n        idx = j0 - 1\n        \n        # Check if index is valid\n        if idx  0 or idx = m:\n            raise ValueError(f\"x0={x0} is not an interior grid point for m={m}, h={h}\")\n\n        return u_vec[idx]\n\n    results = []\n    p = 2  # The scheme is second order\n\n    for case in test_cases:\n        k, m_coarse, x0 = case\n        \n        # Grid parameters\n        m_fine = 2 * m_coarse + 1\n        h_coarse = 1.0 / (m_coarse + 1)\n        \n        # Compute the quantity of interest on coarse and fine grids\n        Q_h = compute_Q_at_x0(k, m_coarse, x0)\n        Q_h_half = compute_Q_at_x0(k, m_fine, x0)\n        \n        # Compute the estimator for the leading error constant C_p\n        # Formula: C_p_est = (2^p / (2^p - 1)) * (Q_h - Q_{h/2}) / h^p\n        numerator = Q_h - Q_h_half\n        denominator = h_coarse**p\n        factor = (2**p) / (2**p - 1)\n        \n        C_p_est = factor * numerator / denominator\n        results.append(C_p_est)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}