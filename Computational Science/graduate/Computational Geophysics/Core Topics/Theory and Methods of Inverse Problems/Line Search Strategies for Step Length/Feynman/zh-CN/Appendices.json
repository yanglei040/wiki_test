{
    "hands_on_practices": [
        {
            "introduction": "Armijo 条件是现代优化算法的基石，它确保了目标函数在每次迭代中都有足够的下降。这个练习提供了一个直接、循序渐进的机会来应用回溯线搜索算法。通过在一个简单的二次函数上执行计算，你将为最常见的线搜索过程建立核心技能和直观理解 。",
            "id": "3607600",
            "problem": "考虑一个线性化的地球物理反演问题，其中数据失配由最小二乘泛函 $F(m) = \\frac{1}{2}\\|A m - b\\|_{2}^{2}$ 建模。正演算子 $A$ 和数据 $b$ 由下式给出\n$$\nA = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n从当前模型向量\n$$\nm_k = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n$$\n开始，采用最速下降方向 $p_k = -\\nabla F(m_k)$，并使用充分下降参数 $c = \\frac{1}{10}$、初始步长 $\\alpha_0 = 1$ 和缩减因子 $\\tau = \\frac{1}{2}$ 执行 Armijo 回溯线搜索。通过从 $\\alpha = \\alpha_0$ 开始回溯，并逐步将 $\\alpha$ 缩减为 $\\alpha \\leftarrow \\tau \\alpha$，直到满足沿 $p_k$ 方向的 Armijo 充分下降准则，确定第一个可接受的步长 $\\alpha$。将最终答案表示为精确值，不进行四舍五入，也不带单位。",
            "solution": "问题要求在一个线搜索过程中找到第一个可接受的步长 $\\alpha$，以最小化给定的目标泛函。该线搜索采用 Armijo 回溯策略。\n\n目标泛函由下式给出\n$$F(m) = \\frac{1}{2}\\|A m - b\\|_{2}^{2}$$\n其中 $m = \\begin{pmatrix} m_1 \\\\ m_2 \\end{pmatrix}$ 是模型向量，正演算子 $A$ 和数据向量 $b$ 为\n$$A = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n由于 $b=0$，泛函简化为 $F(m) = \\frac{1}{2}\\|A m\\|_{2}^{2}$。\n\n首先，我们计算泛函的梯度 $\\nabla F(m)$。\n$$F(m) = \\frac{1}{2}(A m - b)^\\top(A m - b)$$\n梯度由下式给出\n$$\\nabla F(m) = A^\\top(A m - b)$$\n代入给定的 $A$ 和 $b$，并注意到 $A$ 是对称的（$A^\\top=A$），我们得到\n$$\\nabla F(m) = A(A m) = A^2 m = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} m = \\begin{pmatrix} 16  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} m_1 \\\\ m_2 \\end{pmatrix} = \\begin{pmatrix} 16m_1 \\\\ m_2 \\end{pmatrix}$$\n当前模型向量是 $m_k = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。我们在此点计算梯度：\n$$\\nabla F(m_k) = \\begin{pmatrix} 16(1) \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 16 \\\\ -1 \\end{pmatrix}$$\n问题指定了最速下降方向，即梯度的负方向：\n$$p_k = -\\nabla F(m_k) = -\\begin{pmatrix} 16 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -16 \\\\ 1 \\end{pmatrix}$$\n接下来，我们构建 Armijo 充分下降条件，步长 $\\alpha$ 必须满足该条件：\n$$F(m_k + \\alpha p_k) \\le F(m_k) + c \\alpha \\nabla F(m_k)^\\top p_k$$\n其中充分下降参数给定为 $c = \\frac{1}{10}$。\n\n我们必须计算此不等式中的每一项。\n首先，计算泛函在当前点 $m_k$ 的值：\n$$A m_k = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -1 \\end{pmatrix}$$\n$$F(m_k) = \\frac{1}{2}\\|A m_k\\|_{2}^{2} = \\frac{1}{2} \\left\\| \\begin{pmatrix} 4 \\\\ -1 \\end{pmatrix} \\right\\|_{2}^{2} = \\frac{1}{2}(4^2 + (-1)^2) = \\frac{1}{2}(16+1) = \\frac{17}{2}$$\n其次，计算方向导数项 $\\nabla F(m_k)^\\top p_k$：\n$$\\nabla F(m_k)^\\top p_k = \\begin{pmatrix} 16  -1 \\end{pmatrix} \\begin{pmatrix} -16 \\\\ 1 \\end{pmatrix} = (16)(-16) + (-1)(1) = -256 - 1 = -257$$\n注意，对于最速下降方向，这等价于 $-\\|\\nabla F(m_k)\\|_{2}^{2}$。实际上，$\\|\\nabla F(m_k)\\|_{2}^{2} = 16^2+(-1)^2 = 256+1=257$。\n\n现在，我们计算 Armijo 条件的左侧，$F(m_k + \\alpha p_k)$：\n$$m_k + \\alpha p_k = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} + \\alpha \\begin{pmatrix} -16 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 - 16\\alpha \\\\ -1 + \\alpha \\end{pmatrix}$$\n$$A(m_k + \\alpha p_k) = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 - 16\\alpha \\\\ -1 + \\alpha \\end{pmatrix} = \\begin{pmatrix} 4(1 - 16\\alpha) \\\\ -1 + \\alpha \\end{pmatrix} = \\begin{pmatrix} 4 - 64\\alpha \\\\ -1 + \\alpha \\end{pmatrix}$$\n$$F(m_k + \\alpha p_k) = \\frac{1}{2} \\left\\| \\begin{pmatrix} 4 - 64\\alpha \\\\ -1 + \\alpha \\end{pmatrix} \\right\\|_{2}^{2} = \\frac{1}{2}((4 - 64\\alpha)^2 + (-1 + \\alpha)^2)$$\n展开各项：\n$$F(m_k + \\alpha p_k) = \\frac{1}{2}(16 - 512\\alpha + 4096\\alpha^2 + 1 - 2\\alpha + \\alpha^2) = \\frac{1}{2}(17 - 514\\alpha + 4097\\alpha^2)$$\n将所有项代回 Armijo 不等式：\n$$\\frac{1}{2}(17 - 514\\alpha + 4097\\alpha^2) \\le \\frac{17}{2} + \\frac{1}{10}\\alpha(-257)$$\n$$\\frac{1}{2}(17 - 514\\alpha + 4097\\alpha^2) \\le \\frac{17}{2} - \\frac{257}{10}\\alpha$$\n两边同乘以 $2$：\n$$17 - 514\\alpha + 4097\\alpha^2 \\le 17 - \\frac{257}{5}\\alpha$$\n两边同减去 $17$：\n$$-514\\alpha + 4097\\alpha^2 \\le -\\frac{257}{5}\\alpha$$\n由于在线搜索中 $\\alpha  0$，我们可以两边同除以 $\\alpha$：\n$$-514 + 4097\\alpha \\le -\\frac{257}{5}$$\n$$4097\\alpha \\le 514 - \\frac{257}{5}$$\n$$4097\\alpha \\le \\frac{2570 - 257}{5} = \\frac{2313}{5}$$\n$$\\alpha \\le \\frac{2313}{5 \\times 4097} = \\frac{2313}{20485}$$\n数值上，$\\frac{2313}{20485} \\approx 0.1129$。\n\nArmijo 回溯过程从初始步长 $\\alpha_0 = 1$ 开始，并以因子 $\\tau = \\frac{1}{2}$ 迭代地减小步长，直到满足条件。试验步长序列为 $\\alpha = \\alpha_0, \\tau \\alpha_0, \\tau^2 \\alpha_0, \\dots$。即 $\\alpha = 1, \\frac{1}{2}, \\frac{1}{4}, \\frac{1}{8}, \\frac{1}{16}, \\dots$。\n\n我们对照导出的条件 $\\alpha \\le \\frac{2313}{20485}$ 检查此序列中的每个值。\n- 测试 $\\alpha = 1$：$1  \\frac{2313}{20485}$。条件不满足。\n- 测试 $\\alpha = \\frac{1}{2} = 0.5$：$\\frac{1}{2}  \\frac{2313}{20485}$。条件不满足。\n- 测试 $\\alpha = \\frac{1}{4} = 0.25$：$\\frac{1}{4}  \\frac{2313}{20485}$。条件不满足。\n- 测试 $\\alpha = \\frac{1}{8} = 0.125$：$\\frac{1}{8} = \\frac{2560.625}{20485}  \\frac{2313}{20485}$。条件不满足。\n- 测试 $\\alpha = \\frac{1}{16} = 0.0625$：$\\frac{1}{16} = \\frac{1280.3125}{20485} \\le \\frac{2313}{20485}$。条件满足。\n\n第一个可接受的步长是 $\\alpha = \\frac{1}{16}$。",
            "answer": "$$\\boxed{\\frac{1}{16}}$$"
        },
        {
            "introduction": "一个成功的线搜索不仅仅是找到一个可行的步长，而是要理解存在一个可接受步长的区间。这个练习将超越简单的回溯法，利用 Goldstein 条件来精确推导这个可接受区间 。通过将这些条件与二次函数上的真实极小值点联系起来，你将对线搜索准则的工作原理及其几何意义获得更深刻的洞察。",
            "id": "3607660",
            "problem": "在计算地球物理学的线性化反演问题的迭代解法中，通常需要最小化一个形式为 $F(m)=\\tfrac{1}{2} m^{\\top} Q m - b^{\\top} m$ 的二次模型，其中 $Q$ 是对失配和正则化项的海森矩阵的对称正定近似，而 $b$ 来自于线性化的数据项。考虑具体的二次函数 $F(m)=\\tfrac{1}{2} m^{\\top} Q m - b^{\\top} m$，其中 $Q=\\mathrm{diag}(2,10)$ 且 $b=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。设当前模型为 $m_k=\\begin{pmatrix}1 \\\\ -2\\end{pmatrix}$，搜索方向取为最速下降方向 $p_k=-\\nabla F(m_k)$。设 Goldstein 充分下降参数为 $c=\\tfrac{3}{10}$。\n\n仅从方向性一维约束 $\\phi(\\alpha)=F(m_k+\\alpha p_k)$ 的定义、其关于 $\\alpha$ 的导数以及 Goldstein 充分下降接受不等式出发，执行以下步骤：\n- 推导 $\\phi(\\alpha)$ 沿 $p_k$ 方向的精确线搜索最小值点 $\\alpha^{\\star}$。\n- 使用 Goldstein 接受不等式，确定对于给定的 $c$，在 $\\alpha^{\\star}$ 周围可接受的步长 $\\alpha$ 的完整区间，并用 $\\alpha^{\\star}$ 表示。\n- 将此区间具体化为给定的数值数据，然后选择此区间中最小的可接受步长 $\\alpha$。\n\n将你最终选择的步长表示为一个精确的有理数。仅报告所选 $\\alpha$ 的值作为你的最终答案。",
            "solution": "第一步是计算搜索方向 $p_k$。搜索方向定义为目标函数 $F(m)$ 在当前迭代点 $m_k$ 处梯度的负值。$F(m) = \\frac{1}{2} m^{\\top} Q m - b^{\\top} m$ 的梯度由下式给出：\n$$\n\\nabla F(m) = Qm - b\n$$\n我们在 $m_k = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$ 处，使用 $Q = \\begin{pmatrix} 2  0 \\\\ 0  10 \\end{pmatrix}$ 和 $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 计算该梯度：\n$$\n\\nabla F(m_k) = Qm_k - b = \\begin{pmatrix} 2  0 \\\\ 0  10 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\cdot 1 + 0 \\cdot (-2) \\\\ 0 \\cdot 1 + 10 \\cdot (-2) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -20 \\end{pmatrix}\n$$\n搜索方向 $p_k$ 是最速下降方向：\n$$\np_k = - \\nabla F(m_k) = - \\begin{pmatrix} 2 \\\\ -20 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 20 \\end{pmatrix}\n$$\n\n接下来，我们推导一维函数 $\\phi(\\alpha) = F(m_k + \\alpha p_k)$ 的精确线搜索最小值点 $\\alpha^{\\star}$。\n$$\n\\phi(\\alpha) = \\frac{1}{2} (m_k + \\alpha p_k)^{\\top} Q (m_k + \\alpha p_k) - b^{\\top} (m_k + \\alpha p_k)\n$$\n展开此表达式，我们得到：\n$$\n\\phi(\\alpha) = \\frac{1}{2} (m_k^{\\top} Q m_k + 2\\alpha p_k^{\\top} Q m_k + \\alpha^2 p_k^{\\top} Q p_k) - (b^{\\top} m_k + \\alpha b^{\\top} p_k)\n$$\n这是一个关于 $\\alpha$ 的二次函数。为了找到最小值点 $\\alpha^{\\star}$，我们将 $\\phi(\\alpha)$ 对 $\\alpha$ 求导，并令结果为零。\n$$\n\\phi'(\\alpha) = \\frac{d\\phi}{d\\alpha} = p_k^{\\top} Q m_k + \\alpha (p_k^{\\top} Q p_k) - b^{\\top} p_k\n$$\n我们可以使用梯度重写此式：$\\phi'(\\alpha) = (Qm_k - b + \\alpha Qp_k)^{\\top} p_k = (\\nabla F(m_k) + \\alpha Q p_k)^{\\top} p_k = (\\nabla F(m_k))^{\\top} p_k + \\alpha p_k^{\\top} Q p_k$。\n令 $\\phi'(\\alpha^{\\star}) = 0$：\n$$\n(\\nabla F(m_k))^{\\top} p_k + \\alpha^{\\star} p_k^{\\top} Q p_k = 0\n$$\n解出 $\\alpha^{\\star}$：\n$$\n\\alpha^{\\star} = - \\frac{(\\nabla F(m_k))^{\\top} p_k}{p_k^{\\top} Q p_k}\n$$\n代入 $p_k = -\\nabla F(m_k)$：\n$$\n\\alpha^{\\star} = - \\frac{(\\nabla F(m_k))^{\\top} (-\\nabla F(m_k))}{(-\\nabla F(m_k))^{\\top} Q (-\\nabla F(m_k))} = \\frac{(\\nabla F(m_k))^{\\top} (\\nabla F(m_k))}{(\\nabla F(m_k))^{\\top} Q (\\nabla F(m_k))}\n$$\n现在，我们使用 $\\nabla F(m_k) = \\begin{pmatrix} 2 \\\\ -20 \\end{pmatrix}$ 的值计算分子和分母：\n分子：\n$$\n(\\nabla F(m_k))^{\\top} (\\nabla F(m_k)) = \\begin{pmatrix} 2  -20 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -20 \\end{pmatrix} = (2)^2 + (-20)^2 = 4 + 400 = 404\n$$\n分母：\n$$\nQ (\\nabla F(m_k)) = \\begin{pmatrix} 2  0 \\\\ 0  10 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -20 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -200 \\end{pmatrix}\n$$\n$$\n(\\nabla F(m_k))^{\\top} Q (\\nabla F(m_k)) = \\begin{pmatrix} 2  -20 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -200 \\end{pmatrix} = 2(4) + (-20)(-200) = 8 + 4000 = 4008\n$$\n因此，精确线搜索最小值点为：\n$$\n\\alpha^{\\star} = \\frac{404}{4008} = \\frac{4 \\times 101}{4 \\times 1002} = \\frac{101}{1002}\n$$\n\n接下来，我们根据给定 $c \\in (0, 1/2)$ 的 Goldstein 条件确定可接受步长的区间。Goldstein 条件是：\n1. 充分下降条件：$\\phi(\\alpha) \\le \\phi(0) + c \\alpha \\phi'(0)$\n2. 曲率条件：$\\phi(\\alpha) \\ge \\phi(0) + (1-c) \\alpha \\phi'(0)$\n\n我们可以用 $\\phi(0)$、$\\phi'(0)$ 和 $\\alpha^{\\star}$ 来表示 $\\phi(\\alpha)$。根据我们对 $\\phi(\\alpha)$ 的推导：\n$$\n\\phi'(\\alpha) = p_k^{\\top} Q m_k - b^{\\top} p_k + \\alpha p_k^{\\top} Q p_k = \\phi'(0) + \\alpha p_k^{\\top} Q p_k\n$$\n我们得到 $\\alpha^{\\star} = -\\frac{\\phi'(0)}{p_k^{\\top} Q p_k}$，所以 $p_k^{\\top} Q p_k = -\\frac{\\phi'(0)}{\\alpha^{\\star}}$。\n将 $\\phi'(\\alpha)$ 对 $\\alpha$ 积分得到：\n$$\n\\phi(\\alpha) = \\phi(0) + \\alpha \\phi'(0) + \\frac{1}{2} \\alpha^2 p_k^{\\top} Q p_k = \\phi(0) + \\alpha \\phi'(0) - \\frac{1}{2} \\alpha^2 \\frac{\\phi'(0)}{\\alpha^{\\star}}\n$$\n我们将此表达式代入 Goldstein 不等式。对于下降方向，$\\phi'(0) = (\\nabla F(m_k))^{\\top} p_k = -\\|\\nabla F(m_k)\\|^2  0$。\n\n不等式 1：\n$$\n\\phi(0) + \\alpha \\phi'(0) - \\frac{1}{2} \\alpha^2 \\frac{\\phi'(0)}{\\alpha^{\\star}} \\le \\phi(0) + c \\alpha \\phi'(0)\n$$\n对于 $\\alpha  0$，我们减去 $\\phi(0)$ 并除以 $\\alpha$：\n$$\n\\phi'(0) - \\frac{1}{2} \\alpha \\frac{\\phi'(0)}{\\alpha^{\\star}} \\le c \\phi'(0)\n$$\n除以 $\\phi'(0)  0$ 会反转不等号：\n$$\n1 - \\frac{1}{2} \\frac{\\alpha}{\\alpha^{\\star}} \\ge c \\implies 1-c \\ge \\frac{\\alpha}{2\\alpha^{\\star}} \\implies \\alpha \\le 2(1-c)\\alpha^{\\star}\n$$\n\n不等式 2：\n$$\n\\phi(0) + \\alpha \\phi'(0) - \\frac{1}{2} \\alpha^2 \\frac{\\phi'(0)}{\\alpha^{\\star}} \\ge \\phi(0) + (1-c) \\alpha \\phi'(0)\n$$\n对于 $\\alpha  0$，我们化简：\n$$\n\\phi'(0) - \\frac{1}{2} \\alpha \\frac{\\phi'(0)}{\\alpha^{\\star}} \\ge (1-c) \\phi'(0)\n$$\n除以 $\\phi'(0)  0$ 并反转不等号：\n$$\n1 - \\frac{1}{2} \\frac{\\alpha}{\\alpha^{\\star}} \\le 1-c \\implies c \\le \\frac{\\alpha}{2\\alpha^{\\star}} \\implies \\alpha \\ge 2c\\alpha^{\\star}\n$$\n综合这些结果，可接受步长的区间为 $[2c\\alpha^{\\star}, 2(1-c)\\alpha^{\\star}]$。\n\n最后，我们将此区间具体化为给定的数值数据，$c = \\frac{3}{10}$ 和 $\\alpha^{\\star}=\\frac{101}{1002}$，并选择最小的可接受步长。\n该区间为：\n$$\n\\left[ 2\\left(\\frac{3}{10}\\right)\\alpha^{\\star}, \\quad 2\\left(1-\\frac{3}{10}\\right)\\alpha^{\\star} \\right] = \\left[ \\frac{6}{10}\\alpha^{\\star}, \\quad 2\\left(\\frac{7}{10}\\right)\\alpha^{\\star} \\right] = \\left[ \\frac{3}{5}\\alpha^{\\star}, \\quad \\frac{7}{5}\\alpha^{\\star} \\right]\n$$\n问题要求此区间中最小的可接受步长，即下界：\n$$\n\\alpha = \\frac{3}{5}\\alpha^{\\star} = \\frac{3}{5} \\times \\frac{101}{1002}\n$$\n为了化简这个分数，我们注意到 $1002$ 的各位数字之和为 $1+0+0+2=3$，所以 $1002$ 可以被 $3$ 整除。$1002 = 3 \\times 334$。\n$$\n\\alpha = \\frac{3}{5} \\times \\frac{101}{3 \\times 334} = \\frac{101}{5 \\times 334} = \\frac{101}{1670}\n$$\n数字 $101$ 是素数。为了检查 $1670$ 是否能被 $101$ 整除，我们可以注意到 $1670 = 10 \\times 167$。由于 $167$ 不是 $101$ 的倍数，该分数是最简分数。",
            "answer": "$$\\boxed{\\frac{101}{1670}}$$"
        },
        {
            "introduction": "理论与实践之间往往存在差距；现实世界的数据通常充满噪声，可能导致简单的线搜索策略失效。这个高级练习模拟了地球物理反演中重尾噪声（异常值）对目标函数的影响，并要求你选择合适的 Wolfe 条件参数 $(c_1, c_2)$ 以确保在复杂的非凸区域内线搜索的成功 。这个挑战性的问题展示了在设计稳健的优化算法时，深思熟虑地选择线搜索参数的重要性。",
            "id": "3607649",
            "problem": "在基于梯度的地震振幅反演中，目标函数通常由许多数据残差组合而成。当一部分接收器出现不稳定行为（例如，间歇性耦合或削波）时，其误差可能呈重尾分布。这会使得采用经典Armijo回溯策略的线搜索的接受变得不可靠，因为沿试探步长的函数值可能表现出非凸性或突然增加。考虑以下一个特意简化但科学上一致的设置，该设置分离了这种效应，并研究了在稳健损失函数下如何选择线搜索参数以提高接受率。\n\n一个线性化的正演模型贡献了一个主导的二次项部分，该部分来自许多行为良好的测量数据，以及一个单独的重尾异常值。设当前模型迭代为 $m$，最速下降方向为 $p=-\\nabla f(m)$，单变量线搜索函数为 $\\phi(\\alpha)=f(m+\\alpha p)$。假设：\n- 行为良好的测量数据产生一个二次项贡献，其沿 $p$ 方向的下降曲率由 $\\|\\nabla f(m)\\|^{2}=A$ 和 $p^{\\top}\\nabla^{2}f(m)p=K$ 来表征，因此它们对 $\\phi(\\alpha)$ 的贡献是 $-A\\,\\alpha+\\tfrac{1}{2}K\\alpha^{2}$。\n- 一个异常残差 $r(\\alpha)$ 的行为符合自由度 $\\nu=1$（柯西分布）和尺度 $\\sigma=1$ 的重尾学生t分布的负对数似然，即\n$$\n\\ell(r)=\\frac{\\nu+1}{2}\\ln\\!\\left(1+\\frac{r^{2}}{\\nu\\sigma^{2}}\\right)=\\ln\\!\\left(1+r^{2}\\right).\n$$\n- 沿着搜索射线，异常残差是仿射的：$r(\\alpha)=r_{0}-s\\,\\alpha$，其中 $r_{0}=10$ 且 $s=10$。\n- 总的二次项贡献满足 $A=100$ 和 $K=400$。\n\n1) 明确证明，如果所有项的失配都是最小二乘（忽略稳健性），那么在存在上述数值的异常值的情况下，使用单位试探步长 $\\alpha=1$ 的Armijo充分下降条件会经常失败。使用基于最速下降模型的预测来量化在标准Armijo常数 $c_{1}=10^{-4}$ 下的失败情况。\n\n2) 现在采用稳健目标函数，它将二次项部分与单个学生t分布异常值结合起来：\n$$\n\\phi(\\alpha)=\\phi(0)-A\\,\\alpha+\\frac{1}{2}K\\alpha^{2}+\\ln\\!\\left(\\frac{1+\\left(r_{0}-s\\alpha\\right)^{2}}{1+r_{0}^{2}}\\right),\n$$\n因此 $\\phi(0)$ 对于接受条件而言是一个无关紧要的常数。请明确写出 $\\phi'(\\alpha)$ 和 $\\phi'(0)$ 关于 $A,K,r_{0},s$ 的表达式。\n\n3) 考虑一个回溯候选步长集合 $\\alpha\\in[\\alpha_{\\min},\\alpha_{\\max}]$，其中 $\\alpha_{\\min}=0.1$ 且 $\\alpha_{\\max}=0.25$。对于稳健目标函数，常数为 $c_{1}\\in(0,1)$ 的Armijo条件是\n$$\n\\phi(\\alpha)\\le \\phi(0)+c_{1}\\,\\alpha\\,\\phi'(0),\n$$\n以及常数为 $c_{2}\\in(c_{1},1)$ 的（弱）Wolfe曲率条件是\n$$\n\\phi'(\\alpha)\\ge c_{2}\\,\\phi'(0).\n$$\n在 $[\\alpha_{\\min},\\alpha_{\\max}]$ 上定义两个诊断函数：\n$$\nT(\\alpha)=\\frac{\\phi(\\alpha)-\\phi(0)}{\\alpha\\,\\phi'(0)},\\qquad L(\\alpha)=\\frac{\\phi'(\\alpha)}{\\phi'(0)}.\n$$\n根据构造，区间中的步长 $\\alpha$ 满足Armijo条件的充要条件是 $c_{1}\\le T(\\alpha)$，并且满足曲率条件的充要条件是 $c_{2}\\le 1$ 且 $c_{2}\\le \\text{任何大于或等于 } L(\\alpha) \\text{ 的数}$；等价地，由于 $\\phi'(0)0$，条件为 $c_{2}\\ge L(\\alpha)$。选择一个单一的参数对 $(c_{1},c_{2})$ 使得 $[\\alpha_{\\min},\\alpha_{\\max}]$ 中的所有步长都可接受，需要满足\n$$\nc_{1}\\le \\min_{\\alpha\\in[\\alpha_{\\min},\\alpha_{\\max}]}T(\\alpha),\\qquad c_{2}\\ge \\max_{\\alpha\\in[\\alpha_{\\min},\\alpha_{\\max}]}L(\\alpha).\n$$\n\n对于给定的 $A,K,r_{0},s,\\nu,\\sigma$ 精确计算这两个极值，然后报告限制性最小的参数对\n$$\nc_{1}^{\\star}=\\min_{\\alpha\\in[\\alpha_{\\min},\\alpha_{\\max}]}T(\\alpha),\\qquad c_{2}^{\\star}=\\max_{\\alpha\\in[\\alpha_{\\min},\\alpha_{\\max}]}L(\\alpha),\n$$\n四舍五入到四位有效数字。\n\n你的最终答案必须是行向量 $\\begin{pmatrix} c_1^\\star  c_2^\\star \\end{pmatrix}$，其中两个条目都四舍五入到四位有效数字，且不带单位。",
            "solution": "### 第1部分：最小二乘失配的Armijo条件失效\n\n首先，我们构建一个假设情景下的目标函数，其中异常值也用最小二乘（二次）损失函数处理。异常残差对目标函数的贡献形式为 $\\frac{1}{2} C r(\\alpha)^2$，其中 $C$ 是某个常数。与问题中二次部分为 $\\frac{1}{2}K\\alpha^2$ 的表述一致，我们可以将沿搜索方向 $p$ 的总目标函数 $\\Phi(\\alpha)$ 建模为给定的二次部分与来自异常值的二次损失之和。为了匹配 $\\phi(\\alpha) = f(m+\\alpha p)$ 的结构，我们可以写出：\n$$\n\\Phi(\\alpha) = \\Phi(0) - A_{\\text{total}} \\alpha + \\frac{1}{2} K_{\\text{total}} \\alpha^2\n$$\n在我们的情况下，目标函数由行为良好的部分和假设为最小二乘形式 $\\frac{1}{2} r(\\alpha)^2$ 的异常值部分组成。那么线搜索函数为：\n$$\n\\Phi(\\alpha) = C_{\\text{const}} - A\\,\\alpha+\\frac{1}{2}K\\alpha^{2} + \\frac{1}{2}\\left(r_{0}-s\\,\\alpha\\right)^{2}\n$$\n其中 $C_{\\text{const}}$ 包含来自行为良好部分的 $\\phi(0)$ 和来自 $\\alpha=0$ 处异常值的 $\\frac{1}{2}r_0^2$。从 $\\alpha=0$ 开始的变化是：\n$$\n\\Phi(\\alpha) - \\Phi(0) = -A\\,\\alpha+\\frac{1}{2}K\\alpha^{2} + \\frac{1}{2}\\left(r_{0}-s\\,\\alpha\\right)^{2} - \\frac{1}{2}r_0^2\n$$\n关于 $\\alpha$ 的导数是：\n$$\n\\Phi'(\\alpha) = -A + K\\alpha + (r_0 - s\\alpha)(-s) = -A + K\\alpha - s(r_0 - s\\alpha)\n$$\n在 $\\alpha=0$ 处的导数决定了初始下降方向，其值为：\n$$\n\\Phi'(0) = -A -sr_0\n$$\nArmijo-Goldstein充分下降条件是：\n$$\n\\Phi(\\alpha) \\le \\Phi(0) + c_1 \\alpha \\Phi'(0)\n$$\n题目要求我们使用单位试探步长 $\\alpha=1$、Armijo常数 $c_{1}=10^{-4}$ 以及给定的参数 $A=100$、$K=400$、$r_{0}=10$ 和 $s=10$ 来检验这个条件。\n\n首先，我们计算左侧（LHS），即目标函数的实际变化：\n$$\n\\Phi(1) - \\Phi(0) = -A(1) + \\frac{1}{2}K(1)^2 + \\frac{1}{2}(r_0-s(1))^2 - \\frac{1}{2}r_0^2\n$$\n$$\n\\Phi(1) - \\Phi(0) = -100 + \\frac{1}{2}(400) + \\frac{1}{2}(10-10)^2 - \\frac{1}{2}(10)^2 = -100 + 200 + 0 - 50 = 50\n$$\n目标函数值*增加*了 $50$。\n\n接下来，我们计算右侧（RHS），即基于初始梯度的充分下降目标：\n$$\n\\Phi'(0) = -A - sr_0 = -100 - (10)(10) = -200\n$$\n$$\nc_1 \\alpha \\Phi'(0) = (10^{-4})(1)(-200) = -0.02\n$$\nArmijo条件变为：\n$$\n50 \\le -0.02\n$$\n这个不等式不成立。实际函数值急剧增加，而局部模型（梯度）预测的是急剧下降。这种巨大的差异导致Armijo条件失败，步长 $\\alpha=1$ 将被拒绝。失败的原因是大的异常残差引入了强非线性，其贡献 $(r_0-s\\alpha)^2$ 具有很大的正曲率，压倒了初始的下降趋势。\n\n### 第2部分：稳健目标函数的导数\n\n稳健目标函数由下式给出：\n$$\n\\phi(\\alpha)=\\phi(0)-A\\,\\alpha+\\frac{1}{2}K\\alpha^{2}+\\ln\\!\\left(\\frac{1+\\left(r_{0}-s\\alpha\\right)^{2}}{1+r_{0}^{2}}\\right)\n$$\n我们可以通过分离对数来重写此式：\n$$\n\\phi(\\alpha) = \\phi(0)-A\\,\\alpha+\\frac{1}{2}K\\alpha^{2}+\\ln(1+(r_0-s\\alpha)^2) - \\ln(1+r_0^2)\n$$\n为求 $\\phi'(\\alpha)$，我们对 $\\alpha$ 求导：\n$$\n\\phi'(\\alpha) = \\frac{d}{d\\alpha} \\left[ -A\\,\\alpha+\\frac{1}{2}K\\alpha^{2}+\\ln(1+(r_0-s\\alpha)^2) \\right]\n$$\n对对数项使用链式法则：\n$$\n\\frac{d}{d\\alpha}\\ln(1+(r_0-s\\alpha)^2) = \\frac{1}{1+(r_0-s\\alpha)^2} \\cdot \\left( 2(r_0-s\\alpha) \\cdot (-s) \\right) = -\\frac{2s(r_0-s\\alpha)}{1+(r_0-s\\alpha)^2}\n$$\n因此，完整的导数是：\n$$\n\\phi'(\\alpha) = -A + K\\alpha - \\frac{2s(r_0-s\\alpha)}{1+(r_0-s\\alpha)^2}\n$$\n在 $\\alpha=0$ 处求值得到 $\\phi'(0)$：\n$$\n\\phi'(0) = -A + K(0) - \\frac{2s(r_0-s(0))}{1+(r_0-s(0))^2} = -A - \\frac{2sr_0}{1+r_0^2}\n$$\n\n### 第3部分：限制性最小的线搜索参数计算\n\n我们需要在区间 $[\\alpha_{\\min},\\alpha_{\\max}]=[0.1, 0.25]$ 上计算 $c_{1}^{\\star}=\\min_{\\alpha\\in[\\alpha_{\\min},\\alpha_{\\max}]}T(\\alpha)$ 和 $c_{2}^{\\star}=\\max_{\\alpha\\in[\\alpha_{\\min},\\alpha_{\\max}]}L(\\alpha)$。\n\n诊断函数为 $T(\\alpha)=\\frac{\\phi(\\alpha)-\\phi(0)}{\\alpha\\,\\phi'(0)}$ 和 $L(\\alpha)=\\frac{\\phi'(\\alpha)}{\\phi'(0)}$。\n首先，我们用给定的参数 $A=100$、$r_0=10$、$s=10$ 计算常数值 $\\phi'(0)$：\n$$\n\\phi'(0) = -100 - \\frac{2(10)(10)}{1+10^2} = -100 - \\frac{200}{101} = -\\frac{10100+200}{101} = -\\frac{10300}{101}\n$$\n这个值是负数，与下降方向的预期一致。\n\n**分析 $L(\\alpha)$ 以寻找 $c_2^\\star$**\n我们需要在 $[0.1, 0.25]$ 上找到 $L(\\alpha) = \\frac{\\phi'(\\alpha)}{\\phi'(0)}$ 的最大值。最大值的位置可以通过检查其导数 $L'(\\alpha) = \\frac{\\phi''(\\alpha)}{\\phi'(0)}$ 的符号来找到。由于 $\\phi'(0)  0$， $L'(\\alpha)$ 的符号与 $\\phi''(\\alpha)$ 的符号相反。\n我们通过对 $\\phi'(\\alpha)$ 求导来计算 $\\phi''(\\alpha)$：\n$$\n\\phi''(\\alpha) = \\frac{d}{d\\alpha} \\left( -A + K\\alpha - \\frac{2s(r_0-s\\alpha)}{1+(r_0-s\\alpha)^2} \\right) = K - 2s \\frac{d}{d\\alpha} \\left( \\frac{r_0-s\\alpha}{1+(r_0-s\\alpha)^2} \\right)\n$$\n使用商法则，分数部分的导数是：\n$$\n\\frac{-s(1+(r_0-s\\alpha)^2) - (r_0-s\\alpha)(2(r_0-s\\alpha)(-s))}{(1+(r_0-s\\alpha)^2)^2} = \\frac{-s - s(r_0-s\\alpha)^2 + 2s(r_0-s\\alpha)^2}{(1+(r_0-s\\alpha)^2)^2} = \\frac{s((r_0-s\\alpha)^2-1)}{(1+(r_0-s\\alpha)^2)^2}\n$$\n所以，二阶导数是：\n$$\n\\phi''(\\alpha) = K - \\frac{2s^2((r_0-s\\alpha)^2-1)}{(1+(r_0-s\\alpha)^2)^2}\n$$\n我们来在区间 $[0.1, 0.25]$ 上计算它。令 $r(\\alpha) = r_0 - s\\alpha = 10-10\\alpha$。\n对于 $\\alpha \\in [0.1, 0.25]$，$r(\\alpha)$ 在 $[10-2.5, 10-1] = [7.5, 9]$ 的范围内。\n因此，项 $(r(\\alpha)^2-1)$ 是正的，范围从 $7.5^2-1=55.25$ 到 $9^2-1=80$。\n分数项是 $\\frac{2(10)^2(r(\\alpha)^2-1)}{(1+r(\\alpha)^2)^2}$。它在区间上的最大值出现在 $\\alpha=0.25$ 处（$r=7.5$）：$\\frac{200(55.25)}{(1+56.25)^2} \\approx 3.37$。其最小值出现在 $\\alpha=0.1$ 处（$r=9$）：$\\frac{200(80)}{(1+81)^2} \\approx 2.38$。\n由于 $K=400$，远大于这个分数项，$\\phi''(\\alpha) = 400 - (\\text{一个介于 } 2.38 \\text{ 和 } 3.37 \\text{ 之间的值})$ 总是正的。\n因为 $\\phi''(\\alpha)  0$ 且 $\\phi'(0)  0$，我们有 $L'(\\alpha) = \\phi''(\\alpha)/\\phi'(0)  0$。这意味着 $L(\\alpha)$ 在 $[0.1, 0.25]$ 上是一个严格递减的函数。\n因此，$L(\\alpha)$ 的最大值出现在左端点，即 $\\alpha_{\\min}=0.1$。\n$$\nc_2^\\star = L(0.1) = \\frac{\\phi'(0.1)}{\\phi'(0)}\n$$\n$$\n\\phi'(0.1) = -100 + 400(0.1) - \\frac{2(10)(10-10(0.1))}{1+(10-10(0.1))^2} = -60 - \\frac{20(9)}{1+9^2} = -60 - \\frac{180}{82} = -60 - \\frac{90}{41} = -\\frac{2550}{41}\n$$\n$$\nc_2^\\star = \\frac{-2550/41}{-10300/101} = \\frac{2550 \\times 101}{41 \\times 10300} = \\frac{257550}{422300} \\approx 0.60989817...\n$$\n四舍五入到四位有效数字，$c_2^\\star = 0.6099$。\n\n**分析 $T(\\alpha)$ 以寻找 $c_1^\\star$**\n我们需要在 $[0.1, 0.25]$ 上找到 $T(\\alpha) = \\frac{\\phi(\\alpha)-\\phi(0)}{\\alpha\\phi'(0)}$ 的最小值。我们分析其导数：\n$$\nT'(\\alpha) = \\frac{\\phi'(\\alpha)(\\alpha\\phi'(0)) - (\\phi(\\alpha)-\\phi(0))(\\phi'(0))}{(\\alpha\\phi'(0))^2} = \\frac{\\alpha\\phi'(\\alpha) - (\\phi(\\alpha)-\\phi(0))}{\\alpha^2\\phi'(0)}\n$$\n令 $g(\\alpha) = \\alpha\\phi'(\\alpha) - (\\phi(\\alpha)-\\phi(0))$。由于 $\\phi'(0)0$，$T'(\\alpha)$ 的符号与 $g(\\alpha)$ 的符号相反。$g(\\alpha)$ 的导数是：\n$$\ng'(\\alpha) = (\\phi'(\\alpha) + \\alpha\\phi''(\\alpha)) - \\phi'(\\alpha) = \\alpha\\phi''(\\alpha)\n$$\n在区间 $[0.1, 0.25]$ 上，$\\alpha  0$。我们已经确定 $\\phi''(\\alpha)  0$。因此，$g'(\\alpha)  0$，这意味着 $g(\\alpha)$ 是一个严格递增的函数。\n为了确定 $g(\\alpha)$ 在区间上的符号，我们检查其在区间起点 $\\alpha_{\\min}=0.1$ 处的值：\n$$\ng(0.1) = 0.1\\phi'(0.1) - (\\phi(0.1)-\\phi(0))\n$$\n我们有 $\\phi'(0.1) = -2550/41 \\approx -62.1951$。\n$\\phi(0.1)-\\phi(0) = -100(0.1) + \\frac{1}{2}400(0.1)^2 + \\ln(1+(10-1)^2) - \\ln(1+10^2) = -10 + 2 + \\ln(82) - \\ln(101) = -8 + \\ln(82/101) \\approx -8.2084$。\n$$\ng(0.1) \\approx 0.1(-62.1951) - (-8.2084) = -6.21951 + 8.2084 = 1.98889  0\n$$\n由于 $g(\\alpha)$ 是递增的并且在 $\\alpha=0.1$ 处为正，所以 $g(\\alpha)$ 在整个区间 $[0.1, 0.25]$ 上都是正的。\n因为 $g(\\alpha)0$ 且 $T'(\\alpha)$ 的分母为负，所以对于所有 $\\alpha \\in [0.1, 0.25]$，$T'(\\alpha)0$。因此，$T(\\alpha)$ 是一个严格递减的函数。\n$T(\\alpha)$ 的最小值必然出现在右端点，即 $\\alpha_{\\max}=0.25$。\n$$\nc_1^\\star = T(0.25) = \\frac{\\phi(0.25)-\\phi(0)}{0.25\\phi'(0)}\n$$\n$$\n\\phi(0.25)-\\phi(0) = -100(0.25) + \\frac{1}{2}400(0.25)^2 + \\ln(1+(10-2.5)^2) - \\ln(101)\n$$\n$$\n= -25 + 200(0.0625) + \\ln(1+7.5^2) - \\ln(101) = -25 + 12.5 + \\ln(57.25) - \\ln(101) = -12.5 + \\ln(57.25/101)\n$$\n分母是 $0.25\\phi'(0) = 0.25(-\\frac{10300}{101}) = -\\frac{2575}{101}$。\n$$\nc_1^\\star = \\frac{-12.5 + \\ln(57.25/101)}{-2575/101} \\approx \\frac{-12.5 - 0.56766345}{-25.4950495} = \\frac{-13.06766345}{-25.4950495} \\approx 0.5125574\n$$\n四舍五入到四位有效数字，$c_1^\\star=0.5126$。\n\n限制性最小的参数对 $(c_1^\\star, c_2^\\star)$ 是 $(0.5126, 0.6099)$。注意弱Wolfe条件 $c_2 > c_1$ 是满足的，因为 $0.6099 > 0.5126$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5126  0.6099 \\end{pmatrix}}\n$$"
        }
    ]
}