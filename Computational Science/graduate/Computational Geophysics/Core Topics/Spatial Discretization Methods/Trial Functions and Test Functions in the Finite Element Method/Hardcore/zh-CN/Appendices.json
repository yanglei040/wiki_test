{
    "hands_on_practices": [
        {
            "introduction": "对许多初学者来说，与直观的有限差分法相比，有限元法 (FEM) 似乎更为抽象。本练习旨在揭开有限元法的神秘面纱，它将向您展示，对于一个简单的一维问题，当采用标准的线性试探函数和测试函数（即伽辽金法）时，有限元法可以精确地再现广为人知的有限差分格式。通过这个实践，您将在两种主要数值方法之间建立起一座关键的桥梁，并为理解基函数的作用奠定坚实的基础。",
            "id": "3337463",
            "problem": "考虑从有界区间上扩散通量守恒推导得出的一维稳态扩散模型，其具有齐次狄利克雷边界条件：求解函数 $u$，使得在 $(0,L)$ 上满足 $- \\dfrac{d}{dx} \\left( \\nu \\dfrac{du}{dx} \\right) = s(x)$，并有 $u(0) = 0$ 和 $u(L) = 0$，其中 $\\nu > 0$ 是一个常数扩散系数，$s(x)$ 是一个给定的源项。设该区间被划分为 $N$ 个均匀子区间，节点为 $\\{x_i\\}_{i=0}^{N}$，网格间距为 $h = L/N$，并使用与节点 $\\{x_i\\}$ 相关的标准线性帽状基函数 $\\{\\phi_i\\}$。使用 Galerkin 有限元法 (FEM)，其试探空间和检验空间由满足本质边界条件的帽状函数张成，按以下步骤进行。\n\n从强形式乘以一个检验函数并分部积分得到的弱形式出发，通过对限制在单个单元 $e = [x_{i-1}, x_i]$ 上的帽状函数的导数乘积进行积分，计算以 $\\nu$ 和 $h$ 表示的单元级双线性形式贡献。组装这些单元贡献，以获得与内部节点 $i$ 相关的离散方程，该方程用未知节点值 $u_{i-1}$、 $u_i$ 和 $u_{i+1}$ 以及在检验函数 $\\phi_i$ 处求值的载荷泛函表示。\n\n然后，特化为常数源项 $s(x) = s_0$（其中 $s_0$ 为常数），并计算标量 $m_i = \\int_{0}^{L} \\phi_i(x)\\,dx$。将组装后的 FEM 方程除以 $m_i$，以获得节点 $i$ 处的逐点形式，该形式可与相同强形式的二阶中心有限差分 (FD) 离散直接比较。通过这种方式，确定节点 $i$ 处左侧的三点格式系数，顺序为 $(i-1,i,i+1)$，并表示为仅含 $\\nu$ 和 $h$ 的闭式函数。\n\n以包含这三个系数的单个行向量形式报告最终答案，顺序为 $(i-1,i,i+1)$。不包括任何单位。不提供中间结果。最终答案必须是闭式解析表达式。",
            "solution": "我们从强形式 $- \\dfrac{d}{dx} \\left( \\nu \\dfrac{du}{dx} \\right) = s(x)$ 及 $u(0)=0$ 和 $u(L)=0$ 开始。标准弱形式通过乘以一个检验函数 $v \\in H_0^1(0,L)$ 并进行分部积分推导得出，利用齐次本质边界条件消除边界项：\n$$\n\\int_{0}^{L} \\nu \\dfrac{du}{dx} \\dfrac{dv}{dx}\\,dx = \\int_{0}^{L} s(x)\\, v(x)\\,dx.\n$$\n在使用线性帽状函数 $\\{\\phi_i\\}$（在 $x=0$ 和 $x=L$ 处为零）的 Galerkin 有限元法 (FEM) 中，我们寻求一个近似解 $u_h = \\sum_{j=1}^{N-1} u_j \\phi_j$，并选择检验函数 $v = \\phi_i$。内部节点 $i$ 的离散方程为\n$$\n\\sum_{j} \\left( \\int_{0}^{L} \\nu \\dfrac{d\\phi_j}{dx} \\dfrac{d\\phi_i}{dx}\\,dx \\right) u_j \\;=\\; \\int_{0}^{L} s(x)\\, \\phi_i(x)\\,dx.\n$$\n因为网格是均匀的，间距为 $h$，且基函数是紧支的，所以对应于节点 $i$ 的行中唯一的非零贡献来自单元 $[x_{i-1},x_i]$ 和 $[x_i,x_{i+1}]$。\n\n在单个单元 $e=[x_{i-1},x_i]$ 上，局部基函数的限制是 $\\phi_{i-1}$ 和 $\\phi_i$。它们在 $e$ 上的导数是常数：$\\dfrac{d\\phi_{i-1}}{dx} = -\\dfrac{1}{h}$ 和 $\\dfrac{d\\phi_i}{dx} = \\dfrac{1}{h}$。对于 $r,s \\in \\{i-1,i\\}$，单元级双线性形式矩阵项 $a_{e,rs} = \\int_{e} \\nu \\dfrac{d\\phi_r}{dx}\\dfrac{d\\phi_s}{dx}\\,dx$ 为\n$$\na_{e,11} = \\int_{x_{i-1}}^{x_i} \\nu \\left(-\\dfrac{1}{h}\\right)\\left(-\\dfrac{1}{h}\\right) dx = \\nu \\dfrac{1}{h^2} h = \\dfrac{\\nu}{h}, \n$$\n$$\na_{e,12} = \\int_{x_{i-1}}^{x_i} \\nu \\left(-\\dfrac{1}{h}\\right)\\left(\\dfrac{1}{h}\\right) dx = - \\nu \\dfrac{1}{h^2} h = -\\dfrac{\\nu}{h},\n$$\n$$\na_{e,21} = \\int_{x_{i-1}}^{x_i} \\nu \\left(\\dfrac{1}{h}\\right)\\left(-\\dfrac{1}{h}\\right) dx = - \\dfrac{\\nu}{h}, \\quad\na_{e,22} = \\int_{x_{i-1}}^{x_i} \\nu \\left(\\dfrac{1}{h}\\right)\\left(\\dfrac{1}{h}\\right) dx = \\dfrac{\\nu}{h}.\n$$\n因此，在 $[x_{i-1},x_i]$ 上的单元矩阵是 $\\dfrac{\\nu}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。在单元 $[x_i,x_{i+1}]$ 上进行相同的计算，其局部基函数为 $\\{\\phi_i,\\phi_{i+1}\\}$，在该单元上的导数为 $\\dfrac{d\\phi_i}{dx} = -\\dfrac{1}{h}$ 和 $\\dfrac{d\\phi_{i+1}}{dx} = \\dfrac{1}{h}$，得到相同的 $2\\times 2$ 模式。\n\n从节点 $i$ 的两个相邻单元组装对全局行的贡献，产生刚度系数\n$$\nK_{i,i-1} = -\\dfrac{\\nu}{h}, \\qquad K_{i,i} = \\dfrac{\\nu}{h} + \\dfrac{\\nu}{h} = \\dfrac{2\\nu}{h}, \\qquad K_{i,i+1} = -\\dfrac{\\nu}{h}.\n$$\n因此，内部节点 $i$ 处的 FEM 离散方程为\n$$\n-\\dfrac{\\nu}{h} u_{i-1} + \\dfrac{2\\nu}{h} u_i - \\dfrac{\\nu}{h} u_{i+1} \\;=\\; f_i,\n$$\n其中载荷项为 $f_i = \\int_{0}^{L} s(x)\\, \\phi_i(x)\\,dx$。对于常数源项 $s(x) = s_0$，这变为 $f_i = s_0 \\int_{0}^{L} \\phi_i(x)\\,dx$。\n\n我们现在计算标量 $m_i = \\int_{0}^{L} \\phi_i(x)\\,dx$。在具有线性帽状函数的均匀网格上，$\\phi_i$ 是一个支集在 $[x_{i-1},x_{i+1}]$ 上的三角形，高为 $1$，底长为 $2h$。其面积是两个底为 $h$、高为 $1$ 的直角三角形的面积之和，所以\n$$\nm_i = \\int_{x_{i-1}}^{x_{i}} \\phi_i(x)\\,dx + \\int_{x_{i}}^{x_{i+1}} \\phi_i(x)\\,dx = \\dfrac{1\\cdot h}{2} + \\dfrac{1\\cdot h}{2} = h.\n$$\n那么 $f_i = s_0\\, m_i = s_0\\, h$。将整个 FEM 方程除以 $m_i = h$ 得到节点 $i$ 处的逐点平衡：\n$$\n-\\dfrac{\\nu}{h^2} u_{i-1} + \\dfrac{2\\nu}{h^2} u_i - \\dfrac{\\nu}{h^2} u_{i+1} \\;=\\; s_0.\n$$\n这个左端项正好是 $-\\nu \\dfrac{d^2 u}{dx^2}$ 的三点二阶中心有限差分 (FD) 格式，即 $\\nu \\dfrac{-u_{i-1} + 2u_i - u_{i+1}}{h^2}$。因此，按顺序 $(i-1,i,i+1)$ 排列的三点格式系数是\n$$\n\\left( -\\dfrac{\\nu}{h^2}, \\; \\dfrac{2\\nu}{h^2}, \\; -\\dfrac{\\nu}{h^2} \\right).\n$$\n正如要求，这些系数仅依赖于 $\\nu$ 和 $h$。",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\dfrac{\\nu}{h^{2}} & \\dfrac{2\\nu}{h^{2}} & -\\dfrac{\\nu}{h^{2}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "连续基函数并非总是最佳选择，尤其是在处理具有急剧梯度或材料属性不连续的地球物理问题时。本练习将引导您进入间断伽辽金 (DG) 方法的世界，该方法允许使用不连续的试探函数。您将通过一个具体的计算发现，这种自由度是有代价的：必须在弱形式中精心设计一个作用于测试函数的“罚”项，这对于保证解的稳定性和物理真实性至关重要。",
            "id": "3410396",
            "problem": "考虑在一维域 $[0,1]$ 上设定的标量泊松方程 $-u'' = f$，其具有齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。令 $\\mathcal{T}_h$ 为 $[0,1]$ 的一个一致剖分，将其划分为两个相等的子区间（单元），节点位于 $x=0$、$x=1/2$ 和 $x=1$，因此单元尺寸为 $h = 1/2$。令 $V_h$ 为 $\\mathcal{T}_h$ 上的分片常数函数空间，允许函数在界面 $x=1/2$ 处不连续。考虑对称内部罚 Galerkin (SIPG) 方法，其中每个面 $e$ 上的内部罚参数取为 $\\sigma/h$，且 $\\sigma > 0$，狄利克雷边界条件通过 Nitsche 方法进行弱施加。使用标准的非连续 Galerkin 跳跃和平均定义：在内部界面 $x=1/2$ 处，跳跃为 $[u] = u^{-} - u^{+}$，平均为 $\\{u'\\} = (u'^{-} + u'^{+})/2$，其中上标分别表示来自左、右单元的迹；在边界上，$u$ 的迹取自相邻单元，并使用外法线。\n\n构造振荡离散模式 $u_h \\in V_h$，其在左单元 $[0,1/2)$ 上取值为 $u_h(x) = 1$，在右单元 $(1/2,1]$ 上取值为 $u_h(x) = -1$。从泊松算子的 SIPG 方法的基本双线性形式以及齐次狄利克雷边界条件的 Nitsche 施加方法出发，推导内部罚能量 $a(u_h,u_h)$——即以 $u_h$ 作为两个参数对 SIPG 双线性形式求值的结果。你的推导必须从破碎梯度、跳跃和平均算子以及罚项缩放的定义出发。最后，给出对于这个 $h=1/2$ 的网格，$a(u_h,u_h)$ 作为 $\\sigma$ 函数的闭式解析表达式。\n\n答案格式要求：将 $a(u_h,u_h)$ 报告为仅依赖于 $\\sigma$ 的单个符号表达式。不需要进行数值舍入。在你的构造和推导中，解释为什么这种振荡模式在连续有限元方法中是不被允许的，但在内部罚框架中，当罚不足时其能量可能很小。",
            "solution": "对于在 $\\Omega = [0,1]$ 上的泊松问题 $-u'' = f$ 和在 $\\partial\\Omega$ 上的齐次狄利克雷边界条件 $u=0$，其 SIPG 格式旨在寻找一个函数 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$ 都有 $a(u_h, v_h) = L(v_h)$。双线性形式 $a(u,v)$ 由下式给出：\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_h} \\int_K u' v' \\, dx - \\sum_{e \\in \\mathcal{E}_h^i} \\left( \\{u'\\} [v] + \\{v'\\} [u] \\right)|_e + \\sum_{e \\in \\mathcal{E}_h^i} \\frac{\\sigma}{h_e} [u] [v]|_e - \\sum_{e \\in \\mathcal{E}_h^b} \\left( u' n_K v + v' n_K u \\right)|_e + \\sum_{e \\in \\mathcal{E}_h^b} \\frac{\\sigma}{h_e} u v|_e\n$$\n此处，$\\mathcal{E}_h^i$ 是内部面的集合，$\\mathcal{E}_h^b$ 是边界面的集合。对于我们的特定问题，当 $u=v$ 时，该表达式变为：\n$$\na(u,u) = \\sum_{K \\in \\mathcal{T}_h} \\int_K (u')^2 \\, dx - \\sum_{e \\in \\mathcal{E}_h^i} 2 \\{u'\\} [u]|_e + \\sum_{e \\in \\mathcal{E}_h^i} \\frac{\\sigma}{h_e} [u]^2|_e - \\sum_{e \\in \\mathcal{E}_h^b} 2 u' n_K u|_e + \\sum_{e \\in \\mathcal{E}_h^b} \\frac{\\sigma}{h_e} u^2|_e\n$$\n域 $[0,1]$ 被剖分为两个单元，$K_1 = [0, 1/2]$ 和 $K_2 = [1/2, 1]$。单元尺寸为 $h=1/2$。内部面为 $e_i = \\{1/2\\}$，边界面为 $e_{b0} = \\{0\\}$ 和 $e_{b1} = \\{1\\}$。域 $\\Omega$ 的单位外法向量在 $x=0$ 处为 $n_K = -1$，在 $x=1$ 处为 $n_K = 1$。\n\n离散函数 $u_h \\in V_h$ 定义如下：\n$$\nu_h(x) = \\begin{cases} 1 & \\text{for } x \\in K_1 = [0, 1/2] \\\\ -1 & \\text{for } x \\in K_2 = (1/2, 1] \\end{cases}\n$$\n由于 $u_h$ 是一个分片常数函数，其在每个单元内的导数都为零：对于 $x \\in (0, 1/2)$ 和 $x \\in (1/2, 1)$，$u_h'(x) = 0$。\n\n我们现在计算 $a(u_h, u_h)$ 的每一项：\n\n1.  **体项**：该项衡量单元内梯度的能量。由于 $u_h'=0$ 几乎处处成立，该项为零。\n    $$\n    \\sum_{K \\in \\mathcal{T}_h} \\int_K (u_h')^2 \\, dx = \\int_{0}^{1/2} (0)^2 \\, dx + \\int_{1/2}^{1} (0)^2 \\, dx = 0\n    $$\n\n2.  **内部面项**：该项在唯一的内部面 $e_i = \\{1/2\\}$ 上计算。我们首先计算所需的迹、跳跃和平均值。\n    -   来自左侧 ($^-$) 和右侧 ($^+$) 的迹：\n        $$\n        u_h^- = \\lim_{x \\to 1/2^-} u_h(x) = 1\n        $$\n        $$\n        u_h^+ = \\lim_{x \\to 1/2^+} u_h(x) = -1\n        $$\n    -   $u_h$ 的跳跃：\n        $$\n        [u_h]|_{1/2} = u_h^- - u_h^+ = 1 - (-1) = 2\n        $$\n    -   导数的迹：\n        $$\n        (u_h')^- = \\lim_{x \\to 1/2^-} u_h'(x) = 0\n        $$\n        $$\n        (u_h')^+ = \\lim_{x \\to 1/2^+} u_h'(x) = 0\n        $$\n    -   导数的平均值：\n        $$\n        \\{u_h'\\}|_{1/2} = \\frac{(u_h')^- + (u_h')^+}{2} = \\frac{0 + 0}{2} = 0\n        $$\n    内部面的贡献包括一致性/对称性项和罚项。\n    -   一致性/对称性：$- 2 \\{u_h'\\} [u_h]|_{1/2} = -2 \\cdot (0) \\cdot (2) = 0$。\n    -   罚项：$\\frac{\\sigma}{h} [u_h]^2|_{1/2}$。当 $h=1/2$ 时，该项为 $\\frac{\\sigma}{1/2} (2)^2 = 2\\sigma \\cdot 4 = 8\\sigma$。\n    内部面的总贡献为 $0 + 8\\sigma = 8\\sigma$。\n\n3.  **边界面项**：这些项在 $e_{b0}=0$ 和 $e_{b1}=1$ 处计算。\n    -   **在 $x=0$ 处**：迹取自单元 $K_1$ 内部。外法向量为 $n_K = -1$。\n        -   $u_h$ 的迹：$u_h|_0 = u_h(0^+) = 1$。\n        -   $u_h'$ 的迹：$u_h'|_0 = u_h'(0^+) = 0$。\n        -   贡献为 $-2 u_h' n_K u_h|_0 + \\frac{\\sigma}{h} u_h^2|_0 = -2 \\cdot (0) \\cdot (-1) \\cdot (1) + \\frac{\\sigma}{1/2} (1)^2 = 0 + 2\\sigma = 2\\sigma$。\n    -   **在 $x=1$ 处**：迹取自单元 $K_2$ 内部。外法向量为 $n_K = 1$。\n        -   $u_h$ 的迹：$u_h|_1 = u_h(1^-) = -1$。\n        -   $u_h'$ 的迹：$u_h'|_1 = u_h'(1^-) = 0$。\n        -   贡献为 $-2 u_h' n_K u_h|_1 + \\frac{\\sigma}{h} u_h^2|_1 = -2 \\cdot (0) \\cdot (1) \\cdot (-1) + \\frac{\\sigma}{1/2} (-1)^2 = 0 + 2\\sigma = 2\\sigma$。\n    边界面的总贡献为 $2\\sigma + 2\\sigma = 4\\sigma$。\n\n4.  **总内部罚能量**：我们将所有贡献相加。\n    $$\n    a(u_h, u_h) = (\\text{体项}) + (\\text{内部面项}) + (\\text{边界面项})\n    $$\n    $$\n    a(u_h, u_h) = 0 + 8\\sigma + 4\\sigma = 12\\sigma\n    $$\n\n对此结果的解释如下。在标准的连续有限元方法 (CG-FEM) 中，试探函数和检验函数必须属于 Sobolev 空间 $H^1([0,1])$，这要求它们是连续的。函数 $u_h$ 在 $x=1/2$ 处有一个跳跃间断点，因此不属于 $H^1([0,1])$。它根本不是 CG-FEM 空间中的一个容许函数，因此是“不被允许的”。\n\n在非连续 Galerkin (DG) 框架中，函数空间 $V_h$ 允许这种不连续性。函数 $u_h$ 是分片常数空间的一个有效成员。由双线性形式 $a(u_h, u_h)$ 度量的其“能量”为 $12\\sigma$。由于体 (梯度) 项为零，此能量完全来自内部和边界面上的罚项。该能量的大小与罚参数 $\\sigma$ 成正比。如果选择的 $\\sigma$ 非常小（这种情况称为“罚不足”），这个高度振荡的模式 $u_h$ 将具有非常小的能量。一个稳定的 DG 方法依赖于足够大的 $\\sigma$ 来确保这种非物理振荡被赋予大的能量，从而在数值解中有效地抑制它们。存在这样一个能量与 $\\sigma$ 成正比的模式，证明了罚参数在控制单元间跳跃和稳定 DG 方法方面的关键作用。\n\n最终推导出的内部罚能量表达式为 $a(u_h, u_h) = 12\\sigma$。",
            "answer": "$$\\boxed{12\\sigma}$$"
        },
        {
            "introduction": "如果我们可以为任何给定的问题设计出“最优”的测试函数，情况会怎样？这正是间断彼得罗夫-伽辽金 (DPG) 方法的核心思想。本练习将指导您将 DPG 方法应用于一个具有挑战性的各向异性扩散问题，该问题在地震波模拟等地球物理领域具有重要意义。您将亲手实现一种计算生成“最优”测试函数的机制，这些函数能够自动保证数值格式的稳定性，从而领略有限元方法中最前沿、最强大的策略之一。",
            "id": "3617854",
            "problem": "考虑一个源于地震各向异性的二维空间各向异性扩散模型，该模型建立在具有齐次狄利克雷边界条件的矩形域上。令对称正定张量场表示为 $\\mathbf{K}(\\mathbf{x}) \\in \\mathbb{R}^{2 \\times 2}$，其中 $\\mathbf{x} = (x,y)$，并考虑由守恒律 $-\\nabla \\cdot (\\mathbf{K}(\\mathbf{x}) \\nabla u(\\mathbf{x})) = f(\\mathbf{x})$ 控制的标量场 $u(\\mathbf{x})$。通过辅助通量 $\\boldsymbol{\\sigma}(\\mathbf{x})$ 引入一阶系统，使得 $\\boldsymbol{\\sigma}(\\mathbf{x}) + \\mathbf{K}(\\mathbf{x}) \\nabla u(\\mathbf{x}) = \\mathbf{0}$ 且 $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{x}) = f(\\mathbf{x})$。使用间断Petrov-Galerkin (DPG)超弱格式，其中试探空间由每个单元上的分片常数场构成（对于 $u(\\mathbf{x})$ 以及 $\\boldsymbol{\\sigma}(\\mathbf{x})$ 的每个分量），检验空间由每个单元上至多一次的多项式构成，具体来说，是一个向量值检验函数 $\\boldsymbol{\\tau}(\\mathbf{x})$（其分量在 $\\{1, x, y\\}$ 的张成空间内）和一个标量检验函数 $v(\\mathbf{x})$（在 $\\{1, x, y\\}$ 的张成空间内）。\n\n通过对强形式进行分部积分后得到的内部贡献来构建单元局部双线性形式 $b\\big((\\boldsymbol{\\sigma}, u); (\\boldsymbol{\\tau}, v)\\big)$，保留内部项并省略骨架项，以专注于齐次狄利克雷边界条件下的内部最优检验计算。内部双线性形式定义为\n$$\nb\\big((\\boldsymbol{\\sigma}, u); (\\boldsymbol{\\tau}, v)\\big)\n= \\big(\\mathbf{K}^{-1} \\boldsymbol{\\sigma}, \\boldsymbol{\\tau}\\big)_{\\Omega_e}\n+ \\big(u, \\nabla \\cdot \\boldsymbol{\\tau}\\big)_{\\Omega_e}\n- \\big(\\boldsymbol{\\sigma}, \\nabla v\\big)_{\\Omega_e},\n$$\n其中 $\\Omega_e$ 表示一个单元，$(\\cdot,\\cdot)_{\\Omega_e}$ 表示在 $\\Omega_e$ 上的 $L^2$ 内积。单元局部检验范数定义为\n$$\n\\|(\\boldsymbol{\\tau}, v)\\|_V^2\n= \\big(\\boldsymbol{\\tau}, \\boldsymbol{\\tau}\\big)_{\\Omega_e}\n+ \\big(\\nabla v, \\nabla v\\big)_{\\Omega_e}\n+ \\alpha \\big(v, v\\big)_{\\Omega_e},\n$$\n其中 $\\alpha > 0$ 是一个稳定化参数。\n\n令单元局部检验空间格拉姆矩阵 (Gram matrix) 为 $\\mathbf{G}_e$，由上述检验范数在所选多项式基上导出；令单元局部耦合矩阵为 $\\mathbf{B}_e$，由双线性形式 $b(\\cdot;\\cdot)$ 在所选试探基和检验基之间导出。单元局部最优检验基的系数通过Riesz表示定义为离散问题 $\\mathbf{G}_e \\mathbf{t}_e = \\mathbf{b}_e$ 的解，因此，将试探系数映射到检验范数中残数的集体算子具有舒尔补 (Schur complement) 形式 $\\mathbf{A}_e = \\mathbf{B}_e^{\\top} \\mathbf{G}_e^{-1} \\mathbf{B}_e$。对于由与坐标轴对齐的矩形单元组成的网格，通过考虑由单元局部 $\\mathbf{A}_e$ 形成的块对角算子来组装全局稳定性代理，并将全局稳定性指标定义为所有块的最小奇异值，这等于每个对称半正定块 $\\mathbf{A}_e$ 的最小特征值。\n\n您需要实现一个程序，对每个测试用例，纯粹在单元层面执行以下步骤：\n- 将矩形域 $[0,1] \\times [0,1]$ 剖分为一个由 $N_x \\times N_y$ 个等尺寸、轴对齐的矩形单元组成的均匀网格。\n- 在每个单元上，使用指定的 $\\boldsymbol{\\tau}(\\mathbf{x})$ 和 $v(\\mathbf{x})$ 的多项式基，根据检验范数构建局部检验格拉姆矩阵 $\\mathbf{G}_e$；使用指定的 $\\boldsymbol{\\sigma}(\\mathbf{x})$ 分量和 $u(\\mathbf{x})$ 的分片常数试探基，根据双线性形式构建局部耦合矩阵 $\\mathbf{B}_e$。\n- 计算单元局部算子 $\\mathbf{A}_e = \\mathbf{B}_e^{\\top} \\mathbf{G}_e^{-1} \\mathbf{B}_e$ 并提取其最小特征值。\n- 对于该测试用例，报告网格中所有单元的这些最小特征值中的最小值作为全局稳定性指标。\n\n所有积分必须通过张量积高斯-勒让德求积 (tensor-product Gauss-Legendre quadrature) 进行数值计算，每个坐标方向至少取三个点。角度必须以弧度指定。张量场 $\\mathbf{K}(\\mathbf{x})$ 通过地震学风格的各向异性定义为\n$$\n\\mathbf{K}(\\mathbf{x}) = \\mathbf{R}(\\theta(\\mathbf{x}))\n\\begin{bmatrix}\nk_1(\\mathbf{x}) & 0 \\\\\n0 & k_2(\\mathbf{x})\n\\end{bmatrix}\n\\mathbf{R}(\\theta(\\mathbf{x}))^{\\top},\n\\quad\n\\mathbf{R}(\\theta) =\n\\begin{bmatrix}\n\\cos\\theta & -\\sin\\theta \\\\\n\\sin\\theta & \\cos\\theta\n\\end{bmatrix},\n$$\n因此其逆为\n$$\n\\mathbf{K}(\\mathbf{x})^{-1} = \\mathbf{R}(\\theta(\\mathbf{x}))\n\\begin{bmatrix}\n1/k_1(\\mathbf{x}) & 0 \\\\\n0 & 1/k_2(\\mathbf{x})\n\\end{bmatrix}\n\\mathbf{R}(\\theta(\\mathbf{x}))^{\\top}.\n$$\n\n使用以下测试套件，涵盖一般情况、强各向异性边缘情况和空间变化的各向异性情况：\n- 测试用例 1：$N_x = 2$, $N_y = 2$, $k_1(\\mathbf{x}) \\equiv 1$, $k_2(\\mathbf{x}) \\equiv 0.5$, $\\theta(\\mathbf{x}) \\equiv \\pi/6$, $\\alpha = 10^{-3}$。\n- 测试用例 2：$N_x = 1$, $N_y = 1$, $k_1(\\mathbf{x}) \\equiv 10$, $k_2(\\mathbf{x}) \\equiv 0.1$, $\\theta(\\mathbf{x}) \\equiv \\pi/3$, $\\alpha = 10^{-3}$。\n- 测试用例 3：$N_x = 3$, $N_y = 1$, $k_1(\\mathbf{x}) = 1 + 0.5 x$, $k_2(\\mathbf{x}) = 0.2 + 0.1 y$, $\\theta(\\mathbf{x}) = \\pi x y$, $\\alpha = 10^{-3}$。\n\n您的程序应生成单行输出，其中包含三个测试用例的全局稳定性指标，形式为逗号分隔的列表，并用方括号括起来，每个浮点数四舍五入到六位小数（例如，$[a_1,a_2,a_3]$）。不需要物理单位，并且在整个过程中角度必须以弧度处理。",
            "solution": "### 1. 预备知识：单元几何与求积\n\n计算域为单位正方形 $\\Omega = [0,1] \\times [0,1]$，它被离散化为一个由 $N_x \\times N_y$ 个矩形单元组成的均匀网格。每个单元 $\\Omega_e$ 的尺寸为 $h_x = 1/N_x$ 和 $h_y = 1/N_y$。一个索引为 $(i,j)$（其中 $i=0, \\dots, N_x-1$ 且 $j=0, \\dots, N_y-1$）的单元占据区域 $[i h_x, (i+1)h_x] \\times [j h_y, (j+1)h_y]$。\n\n单元 $\\Omega_e$ 上的积分通过映射到参考单元 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 并使用数值求积来计算。线性映射为：\n$x(\\xi, \\eta) = x_c + \\frac{h_x}{2}\\xi$\n$y(\\xi, \\eta) = y_c + \\frac{h_y}{2}\\eta$\n其中 $(x_c, y_c)$ 是物理单元 $\\Omega_e$ 的中心。此变换的雅可比行列式为 $J = \\frac{h_x h_y}{4}$。因此，积分可近似为：\n$$\n\\int_{\\Omega_e} g(x,y) \\,dx\\,dy = \\int_{-1}^1 \\int_{-1}^1 g(x(\\xi,\\eta), y(\\xi,\\eta)) J \\,d\\xi\\,d\\eta \\approx J \\sum_{k=1}^{N_q} \\sum_{l=1}^{N_q} w_k w_l g(x(\\xi_k,\\eta_l), y(\\xi_k,\\eta_l))\n$$\n其中 $(\\xi_k, w_k)$ 和 $(\\eta_l, w_l)$ 是 $[-1,1]$ 上的高斯-勒让德求积点和权重，$N_q$ 是每个方向上的点数。根据题目要求，我们使用 $N_q=3$。\n\n### 2. 基函数与空间\n\n- **试探空间**：试探变量是标量场 $u$ 和向量通量 $\\boldsymbol{\\sigma} = (\\sigma_1, \\sigma_2)$。在每个单元上，这些变量都用分片常数来近似。局部试探空间的维度为 $3$，其基对应于将 $(\\sigma_1, \\sigma_2, u)$ 中的一个设为 $1$ 而其他设为 $0$。\n\n- **检验空间**：检验变量是标量场 $v$ 和向量通量 $\\boldsymbol{\\tau} = (\\tau_1, \\tau_2)$。在每个单元上，它们是至多一次的多项式，由集合 $\\{1, x, y\\}$ 张成。令 $P_1(x,y)=1$, $P_2(x,y)=x$, $P_3(x,y)=y$。$(\\boldsymbol{\\tau}, v)$ 的总局部检验空间维度为 $3 \\times 3 = 9$。我们选择一个有序基：\n    1-3: $(\\boldsymbol{\\tau}, v) = ((P_k, 0), 0)$，对于 $k=1,2,3$（$\\tau_1$ 的基）。\n    4-6: $(\\boldsymbol{\\tau}, v) = ((0, P_{k-3}), 0)$，对于 $k=4,5,6$（$\\tau_2$ 的基）。\n    7-9: $(\\boldsymbol{\\tau}, v) = ((0,0), P_{k-6})$，对于 $k=7,8,9$（$v$ 的基）。\n标量基函数的梯度为 $\\nabla P_1 = (0,0)$, $\\nabla P_2 = (1,0)$, 和 $\\nabla P_3 = (0,1)$。\n\n### 3. 局部矩阵的构建\n\n**检验格拉姆矩阵 (Gram Matrix) $\\mathbf{G}_e$**：\n$9 \\times 9$ 格拉姆矩阵的第 $(i,j)$ 个元素由第 $i$ 个和第 $j$ 个检验基函数 $(\\boldsymbol{\\tau}_i, v_i)$ 和 $(\\boldsymbol{\\tau}_j, v_j)$ 在检验空间中的内积给出：\n$$\n(\\mathbf{G}_e)_{ij} = \\langle (\\boldsymbol{\\tau}_i, v_i), (\\boldsymbol{\\tau}_j, v_j) \\rangle_V = (\\boldsymbol{\\tau}_i, \\boldsymbol{\\tau}_j)_{\\Omega_e} + (\\nabla v_i, \\nabla v_j)_{\\Omega_e} + \\alpha (v_i, v_j)_{\\Omega_e}\n$$\n由于我们基的结构，$\\mathbf{G}_e$ 是块对角矩阵：\n$$\n\\mathbf{G}_e = \\begin{pmatrix} \\mathbf{M} & \\mathbf{0} & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{M} & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{0} & \\mathbf{S} + \\alpha \\mathbf{M} \\end{pmatrix}\n$$\n其中 $\\mathbf{M}$ 和 $\\mathbf{S}$ 是 $3 \\times 3$ 的矩阵，其元素为：\n$(\\mathbf{M})_{kl} = \\int_{\\Omega_e} P_k P_l \\,dx\\,dy$\n$(\\mathbf{S})_{kl} = \\int_{\\Omega_e} \\nabla P_k \\cdot \\nabla P_l \\,dx\\,dy$\n这些矩阵使用求积法则进行数值计算。\n\n**耦合矩阵 $\\mathbf{B}_e$**：\n$9 \\times 3$ 耦合矩阵的第 $(i,j)$ 个元素是双线性形式对第 $i$ 个检验基函数和第 $j$ 个试探基函数的求值：\n$$\n(\\mathbf{B}_e)_{ij} = b\\big((\\boldsymbol{\\sigma}_j, u_j); (\\boldsymbol{\\tau}_i, v_i)\\big) = (\\mathbf{K}^{-1} \\boldsymbol{\\sigma}_j, \\boldsymbol{\\tau}_i)_{\\Omega_e} + (u_j, \\nabla \\cdot \\boldsymbol{\\tau}_i)_{\\Omega_e} - (\\boldsymbol{\\sigma}_j, \\nabla v_i)_{\\Omega_e}\n$$\n通过考虑三个试探基函数 $(\\boldsymbol{\\sigma}_j, u_j)$ 中的每一个来计算 $\\mathbf{B}_e$ 的元素：\n1. 对于 $(\\boldsymbol{\\sigma}_1, u_1) = ((1,0), 0)$：$\\mathbf{B}_e$ 的第1列。\n2. 对于 $(\\boldsymbol{\\sigma}_2, u_2) = ((0,1), 0)$：$\\mathbf{B}_e$ 的第2列。\n3. 对于 $(\\boldsymbol{\\sigma}_3, u_3) = ((0,0), 1)$：$\\mathbf{B}_e$ 的第3列。\n\n这导致 $\\mathbf{B}_e$ 具有以下结构，其中积分在单元上进行：\n$$\n\\mathbf{B}_e = \\begin{pmatrix}\n\\int K_{11}^{-1} P_1  & \\int K_{12}^{-1} P_1  & 0 \\\\\n\\int K_{11}^{-1} P_2  & \\int K_{12}^{-1} P_2  & h_x h_y \\\\\n\\int K_{11}^{-1} P_3  & \\int K_{12}^{-1} P_3  & 0 \\\\\n\\int K_{21}^{-1} P_1  & \\int K_{22}^{-1} P_1  & 0 \\\\\n\\int K_{21}^{-1} P_2  & \\int K_{22}^{-1} P_2  & 0 \\\\\n\\int K_{21}^{-1} P_3  & \\int K_{22}^{-1} P_3  & h_x h_y \\\\\n0 & 0 & 0 \\\\\n-h_x h_y & 0 & 0 \\\\\n0 & -h_x h_y & 0\n\\end{pmatrix}\n$$\n涉及 $\\mathbf{K}^{-1}$ 分量的积分是数值计算的。逆张量 $\\mathbf{K}^{-1}$ 的分量由下式给出：\n$K_{11}^{-1} = \\frac{\\cos^2\\theta}{k_1} + \\frac{\\sin^2\\theta}{k_2}$\n$K_{22}^{-1} = \\frac{\\sin^2\\theta}{k_1} + \\frac{\\cos^2\\theta}{k_2}$\n$K_{12}^{-1} = K_{21}^{-1} = \\cos\\theta \\sin\\theta (\\frac{1}{k_1} - \\frac{1}{k_2})$\n其中 $k_1, k_2, \\theta$ 是在每个求积点上求值的 $(x,y)$ 的函数。\n\n### 4. 稳定性指标的计算\n\n对于每个单元 $\\Omega_e$，形成局部算子 $\\mathbf{A}_e$：\n$$\n\\mathbf{A}_e = \\mathbf{B}_e^{\\top} \\mathbf{G}_e^{-1} \\mathbf{B}_e\n$$\n由于 $\\mathbf{G}_e$ 是块对角矩阵，其逆矩阵很容易通过对每个块求逆来找到。$\\mathbf{A}_e$ 的计算可以表示为三项之和：\n$$\n\\mathbf{A}_e = \\mathbf{B}_{e,1}^{\\top} \\mathbf{M}^{-1} \\mathbf{B}_{e,1} + \\mathbf{B}_{e,2}^{\\top} \\mathbf{M}^{-1} \\mathbf{B}_{e,2} + \\mathbf{B}_{e,3}^{\\top} (\\mathbf{S} + \\alpha \\mathbf{M})^{-1} \\mathbf{B}_{e,3}\n$$\n其中 $\\mathbf{B}_{e,1}, \\mathbf{B}_{e,2}, \\mathbf{B}_{e,3}$ 分别是 $\\mathbf{B}_e$ 的上、中、下三个 $3 \\times 3$ 的块。\n\n矩阵 $\\mathbf{A}_e$ 是一个 $3 \\times 3$ 的对称半正定矩阵。计算其最小特征值。一个测试用例的全局稳定性指标是网格中所有单元上这些最小特征值的最小值。对题目中指定的三个测试用例中的每一个重复此过程。",
            "answer": "$$ \\boxed{[0.007621, 0.003957, 0.002824]} $$"
        }
    ]
}