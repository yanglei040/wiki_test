{
    "hands_on_practices": [
        {
            "introduction": "The power of the isoparametric finite element method lies in its ability to map simple reference elements onto complex physical geometries. This transformation is governed by the Jacobian matrix, whose determinant, $\\det\\mathbf{J}$, is crucial for both mathematical validity and numerical stability. This exercise provides a hands-on calculation of $\\det\\mathbf{J}$ for a distorted quadrilateral element, offering direct insight into how mesh quality is assessed and why severely skewed elements can compromise simulation results. ",
            "id": "3572383",
            "problem": "Consider a two-dimensional isoparametric bilinear quadrilateral finite element used to discretize a heterogeneous conductivity field in computational geophysics within the Finite Element Method (FEM). The physical element is defined by its four corner nodes, which map from the reference square $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ using the bilinear isoparametric formulation $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,x_{i}$ and $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,y_{i}$, where $N_{i}(\\xi,\\eta)$ are the standard bilinear shape functions, and the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$ of the mapping is defined by $\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\partial x / \\partial \\xi & \\partial x / \\partial \\eta \\\\ \\partial y / \\partial \\xi & \\partial y / \\partial \\eta \\end{pmatrix}$. The nodes are ordered so that node $1$ corresponds to $(\\xi,\\eta) = (-1,-1)$, node $2$ to $(\\xi,\\eta) = (1,-1)$, node $3$ to $(\\xi,\\eta) = (1,1)$, and node $4$ to $(\\xi,\\eta) = (-1,1)$. The physical coordinates, in kilometers, of the four nodes are:\n- Node $1$: $(x_{1},y_{1}) = (0,\\,0)$,\n- Node $2$: $(x_{2},y_{2}) = (2.0,\\,0.1)$,\n- Node $3$: $(x_{3},y_{3}) = (2.2,\\,1.9)$,\n- Node $4$: $(x_{4},y_{4}) = (0.1,\\,2.0)$.\n\nThis element is convex but highly skewed.\n\nStarting from the isoparametric mapping and the definition of the Jacobian, compute the determinant $\\det\\mathbf{J}(\\xi,\\eta)$ at the four two-point Gauss–Legendre quadrature points for the square, located at $(\\xi,\\eta) = (\\pm 1/\\sqrt{3},\\,\\pm 1/\\sqrt{3})$. Based on these values, assess the risk of numerical instability due to near-singular mappings for this element.\n\nReport as your final result the minimum value of $\\det\\mathbf{J}(\\xi,\\eta)$ over the four Gauss points. Round your answer to four significant figures. Express your answer in square kilometers.",
            "solution": "The isoparametric bilinear mapping for a four-node quadrilateral uses the standard bilinear shape functions\n$$\nN_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta),\n$$\n$$\nN_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta),\n$$\nso that the physical position is\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,y_{i}.\n$$\nThe Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$ follows from the chain rule:\n$$\n\\mathbf{J}(\\xi,\\eta) = \n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\xi}x_{i} & \\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\eta}x_{i} \\\\\n\\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\xi}y_{i} & \\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\eta}y_{i}\n\\end{pmatrix}.\n$$\nThe derivatives of the shape functions are\n$$\n\\frac{\\partial N_{1}}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta),\\quad\n\\frac{\\partial N_{2}}{\\partial \\xi} = \\frac{1}{4}(1-\\eta),\\quad\n\\frac{\\partial N_{3}}{\\partial \\xi} = \\frac{1}{4}(1+\\eta),\\quad\n\\frac{\\partial N_{4}}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta),\n$$\n$$\n\\frac{\\partial N_{1}}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi),\\quad\n\\frac{\\partial N_{2}}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi),\\quad\n\\frac{\\partial N_{3}}{\\partial \\eta} = \\frac{1}{4}(1+\\xi),\\quad\n\\frac{\\partial N_{4}}{\\partial \\eta} = \\frac{1}{4}(1-\\xi).\n$$\nWith $(x_{1},y_{1}) = (0,\\,0)$, $(x_{2},y_{2}) = (2.0,\\,0.1)$, $(x_{3},y_{3}) = (2.2,\\,1.9)$, $(x_{4},y_{4}) = (0.1,\\,2.0)$, we can write compactly\n$$\n\\frac{\\partial x}{\\partial \\xi}(\\eta) = \\frac{(1-\\eta)\\,x_{2} + (1+\\eta)\\,x_{3} - (1+\\eta)\\,x_{4}}{4},\\qquad\n\\frac{\\partial y}{\\partial \\xi}(\\eta) = \\frac{(1-\\eta)\\,y_{2} + (1+\\eta)\\,y_{3} - (1+\\eta)\\,y_{4}}{4},\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}(\\xi) = \\frac{-(1+\\xi)\\,x_{2} + (1+\\xi)\\,x_{3} + (1-\\xi)\\,x_{4}}{4},\\qquad\n\\frac{\\partial y}{\\partial \\eta}(\\xi) = \\frac{-(1+\\xi)\\,y_{2} + (1+\\xi)\\,y_{3} + (1-\\xi)\\,y_{4}}{4}.\n$$\nThe two-point Gauss–Legendre quadrature points on $[-1,1]$ are at $\\xi = \\pm r$ and $\\eta = \\pm r$, where\n$$\nr = \\frac{1}{\\sqrt{3}} \\approx 0.577350269.\n$$\nWe evaluate $\\det\\mathbf{J}(\\xi,\\eta) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)$ at the four points.\n\nFirst, for $(\\xi,\\eta) = (r,r)$, use $(1-\\eta) = 1-r \\approx 0.422649731$, $(1+\\eta) = 1+r \\approx 1.577350269$, and $(1\\pm\\xi)$ similarly:\n$$\n\\frac{\\partial x}{\\partial \\xi}(r) = \\frac{0.422649731\\cdot 2.0 + 1.577350269\\cdot 2.2 - 1.577350269\\cdot 0.1}{4} \\approx 1.0394337568,\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi}(r) = \\frac{0.422649731\\cdot 0.1 + 1.577350269\\cdot 1.9 - 1.577350269\\cdot 2.0}{4} \\approx -0.02886751345,\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}(r) = \\frac{-1.577350269\\cdot 2.0 + 1.577350269\\cdot 2.2 + 0.422649731\\cdot 0.1}{4} \\approx 0.089433756775,\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta}(r) = \\frac{-1.577350269\\cdot 0.1 + 1.577350269\\cdot 1.9 + 0.422649731\\cdot 2.0}{4} \\approx 0.92113248655.\n$$\nThus,\n$$\n\\det\\mathbf{J}(r,r) \\approx 1.0394337568\\cdot 0.92113248655 - 0.089433756775\\cdot(-0.02886751345) \\approx 0.96003799.\n$$\n\nSecond, for $(\\xi,\\eta) = (-r,r)$, $(1+\\xi) = 1-r \\approx 0.422649731$, $(1-\\xi) = 1+r \\approx 1.577350269$, while $(1\\pm\\eta)$ as before:\n$$\n\\frac{\\partial x}{\\partial \\xi}(r) \\approx 1.0394337568,\\quad \\frac{\\partial y}{\\partial \\xi}(r) \\approx -0.02886751345,\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}(-r) = \\frac{-0.422649731\\cdot 2.0 + 0.422649731\\cdot 2.2 + 1.577350269\\cdot 0.1}{4} \\approx 0.060566243275,\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta}(-r) = \\frac{-0.422649731\\cdot 0.1 + 0.422649731\\cdot 1.9 + 1.577350269\\cdot 2.0}{4} \\approx 0.9788675135,\n$$\nand\n$$\n\\det\\mathbf{J}(-r,r) \\approx 1.0394337568\\cdot 0.9788675135 - 0.060566243275\\cdot(-0.02886751345) \\approx 1.019216337.\n$$\n\nThird, for $(\\xi,\\eta) = (r,-r)$, $(1-\\eta) = 1+r \\approx 1.577350269$, $(1+\\eta) = 1-r \\approx 0.422649731$:\n$$\n\\frac{\\partial x}{\\partial \\xi}(-r) = \\frac{1.577350269\\cdot 2.0 + 0.422649731\\cdot 2.2 - 0.422649731\\cdot 0.1}{4} \\approx 1.010566243275,\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi}(-r) = \\frac{1.577350269\\cdot 0.1 + 0.422649731\\cdot 1.9 - 0.422649731\\cdot 2.0}{4} \\approx 0.02886751345,\n$$\nand with $(1\\pm\\xi)$ as in the first case:\n$$\n\\frac{\\partial x}{\\partial \\eta}(r) \\approx 0.089433756775,\\qquad\n\\frac{\\partial y}{\\partial \\eta}(r) \\approx 0.92113248655,\n$$\nyielding\n$$\n\\det\\mathbf{J}(r,-r) \\approx 1.010566243275\\cdot 0.92113248655 - 0.089433756775\\cdot 0.02886751345 \\approx 0.928283607.\n$$\n\nFourth, for $(\\xi,\\eta) = (-r,-r)$:\n$$\n\\frac{\\partial x}{\\partial \\xi}(-r) \\approx 1.010566243275,\\quad \\frac{\\partial y}{\\partial \\xi}(-r) \\approx 0.02886751345,\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}(-r) \\approx 0.060566243275,\\quad \\frac{\\partial y}{\\partial \\eta}(-r) \\approx 0.9788675135,\n$$\nand\n$$\n\\det\\mathbf{J}(-r,-r) \\approx 1.010566243275\\cdot 0.9788675135 - 0.060566243275\\cdot 0.02886751345 \\approx 0.987461796.\n$$\n\nCollecting these, the four Jacobian determinants (in square kilometers) at the Gauss points are approximately:\n$$\n\\det\\mathbf{J}(r,r) \\approx 0.96003799,\\quad\n\\det\\mathbf{J}(-r,r) \\approx 1.019216337,\\quad\n\\det\\mathbf{J}(r,-r) \\approx 0.928283607,\\quad\n\\det\\mathbf{J}(-r,-r) \\approx 0.987461796.\n$$\nThe minimum value is\n$$\n\\min\\{\\det\\mathbf{J}\\} \\approx 0.928283607.\n$$\n\nRegarding numerical stability, the isoparametric mapping becomes near-singular when $\\det\\mathbf{J}(\\xi,\\eta)$ approaches zero or changes sign within the element, which leads to large interpolation gradients and ill-conditioned stiffness matrices. Here, all determinants remain positive and of comparable magnitude; the ratio of the minimum to the maximum, $0.928283607 / 1.019216337 \\approx 0.911$, indicates moderate distortion but not near-singularity. Therefore, the risk of numerical instability due to a near-singular mapping is low for this element.\n\nRounding the minimum determinant to four significant figures, and expressing the value in square kilometers as requested, gives\n$$\n0.9283.\n$$",
            "answer": "$$\\boxed{0.9283}$$"
        },
        {
            "introduction": "Assembling the element stiffness matrix is the heart of the finite element procedure, translating the governing physical equations into a computable algebraic system. This process becomes particularly intricate for anisotropic media on general quadrilateral meshes, as it requires careful transformation of both gradients and the integration measure. This problem challenges you to identify the correct formulation and numerical procedure for assembling the stiffness matrix, reinforcing the critical roles of the inverse-transpose Jacobian $\\mathbf{J}^{-T}$ for gradients and the Jacobian determinant $\\det\\mathbf{J}$ for area. ",
            "id": "3572415",
            "problem": "Consider the two-dimensional steady-state diffusion problem in a heterogeneous anisotropic medium typical of computational geophysics: find $u(\\mathbf{x})$ on a domain $\\Omega \\subset \\mathbb{R}^2$ such that $-\\nabla \\cdot (\\mathbf{K}(\\mathbf{x}) \\nabla u) = f$ with appropriate boundary conditions, where $\\mathbf{K}(\\mathbf{x})$ is a spatially varying symmetric positive-definite (SPD) conductivity tensor. In the Finite Element Method (FEM), the element stiffness matrix on a single quadrilateral element contributes to the global system that discretizes the weak form of this equation.\n\nFocus on a single isoparametric bilinear quadrilateral element ($Q_1$) with nodes at physical coordinates $\\{\\mathbf{x}_a\\}_{a=1}^4$ and corresponding bilinear shape functions $\\{N_a(\\xi,\\eta)\\}_{a=1}^4$ defined on the reference square $\\hat{\\Omega} = [-1,1]\\times[-1,1]$ with local coordinates $(\\xi,\\eta)$. The isoparametric mapping is defined by $\\mathbf{x}(\\xi,\\eta) = \\sum_{a=1}^4 N_a(\\xi,\\eta)\\,\\mathbf{x}_a$. The Jacobian matrix of this mapping is $\\mathbf{J}(\\xi,\\eta) = \\dfrac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)}$, and the chain rule relates physical gradients of shape functions to reference gradients via $\\nabla N_a = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N_a$, where $\\hat{\\nabla}$ denotes gradients with respect to $(\\xi,\\eta)$.\n\nYou are to select the option that correctly sets up the integral expression for the $4\\times 4$ element stiffness matrix for this $Q_1$ element with $\\mathbf{K}(\\mathbf{x})$ varying spatially and anisotropically, and that correctly states a numerically sound procedure to evaluate it using appropriate tensor-product Gauss-Legendre quadrature on $\\hat{\\Omega}$.\n\nWhich option gives a correct expression and evaluation steps?\n\nA. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\nabla N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\nabla N_j(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$, with $\\nabla N_i = \\mathbf{J}^{-T}\\hat{\\nabla}N_i$ and $\\mathbf{x}(\\xi,\\eta)=\\sum_{a=1}^4 N_a(\\xi,\\eta)\\mathbf{x}_a$. Procedure: choose tensor-product Gauss-Legendre points $\\{(\\xi_g,\\eta_g),w_g^\\xi,w_g^\\eta\\}$ of order at least $2\\times 2$ (increase order if $\\mathbf{K}$ varies strongly), and for each point compute $\\hat{\\nabla}N_i(\\xi_g,\\eta_g)$, $\\mathbf{J}(\\xi_g,\\eta_g)$, $\\det\\mathbf{J}(\\xi_g,\\eta_g)$, $\\nabla N_i(\\xi_g,\\eta_g)$, evaluate $\\mathbf{K}\\big(\\mathbf{x}(\\xi_g,\\eta_g)\\big)$, form $\\big(\\nabla N_i\\big)^T\\mathbf{K}\\nabla N_j$, and accumulate $k_{ij}^e \\mathrel{+}= \\big(\\nabla N_i\\big)^T\\mathbf{K}\\nabla N_j\\,\\det\\mathbf{J}\\,w_g^\\xi w_g^\\eta$ over all points.\n\nB. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\hat{\\nabla} N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}_c\\big)\\,\\hat{\\nabla} N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$, where $\\mathbf{x}_c$ is the element centroid. Procedure: use a single Gauss point at $(\\xi,\\eta)=(0,0)$ with weight $4$, evaluate $\\mathbf{K}$ at $\\mathbf{x}_c$, and compute $k_{ij}^e = 4\\,\\big(\\hat{\\nabla} N_i(0,0)\\big)^{T}\\,\\mathbf{K}(\\mathbf{x}_c)\\,\\hat{\\nabla} N_j(0,0)$.\n\nC. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\nabla N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\nabla N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$, with $\\nabla N_i = \\mathbf{J}^{T}\\hat{\\nabla}N_i$ and $\\mathbf{x}(\\xi,\\eta)=\\sum_{a=1}^4 N_a(\\xi,\\eta)\\mathbf{x}_a$. Procedure: choose $2\\times 2$ Gauss-Legendre points, compute $\\mathbf{J}$ only once at $(\\xi,\\eta)=(0,0)$, reuse it at all points, evaluate $\\mathbf{K}$ at each mapped point, and accumulate $k_{ij}^e$ without the $\\det\\mathbf{J}$ factor.\n\nD. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\hat{\\nabla} N_i(\\xi,\\eta)\\big)^{T}\\,\\big(\\mathbf{J}^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\mathbf{J}\\big)\\,\\hat{\\nabla} N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$. Procedure: use tensor-product Gauss-Legendre quadrature of order $1\\times 1$ for efficiency, compute $\\mathbf{J}$ and $\\mathbf{K}$ at the single Gauss point, form the inner product above, and sum with the quadrature weight; no determinant term is needed because the transformation is embedded in $\\mathbf{J}^{T}\\mathbf{K}\\mathbf{J}$.\n\nSelect the correct option.",
            "solution": "### Problem Validation\n\n#### Step 1: Extract Givens\n\nThe problem statement provides the following information:\n1.  **Governing Equation**: The two-dimensional steady-state diffusion equation in a heterogeneous anisotropic medium is $-\\nabla \\cdot (\\mathbf{K}(\\mathbf{x}) \\nabla u) = f$.\n2.  **Domain**: The problem is defined on a domain $\\Omega \\subset \\mathbb{R}^2$.\n3.  **Conductivity Tensor**: $\\mathbf{K}(\\mathbf{x})$ is a spatially varying, symmetric positive-definite (SPD) tensor.\n4.  **Discretization Method**: The Finite Element Method (FEM) is used.\n5.  **Element Type**: A single isoparametric bilinear quadrilateral element ($Q_1$) is considered.\n6.  **Nodal Coordinates**: The element has nodes at physical coordinates $\\{\\mathbf{x}_a\\}_{a=1}^4$.\n7.  **Shape Functions**: Bilinear shape functions $\\{N_a(\\xi,\\eta)\\}_{a=1}^4$ are defined on the reference square $\\hat{\\Omega} = [-1,1]\\times[-1,1]$ with local coordinates $(\\xi,\\eta)$.\n8.  **Isoparametric Mapping**: The mapping from reference to physical coordinates is $\\mathbf{x}(\\xi,\\eta) = \\sum_{a=1}^4 N_a(\\xi,\\eta)\\,\\mathbf{x}_a$.\n9.  **Jacobian Matrix**: The Jacobian of the mapping is $\\mathbf{J}(\\xi,\\eta) = \\dfrac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)}$.\n10. **Chain Rule for Gradients**: The relationship between physical gradients ($\\nabla$) and reference gradients ($\\hat{\\nabla}$) of the shape functions is given as $\\nabla N_a = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N_a$.\n\n#### Step 2: Validate Using Extracted Givens\n\nThe problem statement describes a standard application of the Finite Element Method to a second-order elliptic partial differential equation.\n-   **Scientifically Grounded**: The problem is rooted in the fundamental principles of continuum mechanics (diffusion) and numerical analysis (FEM). The governing equation is a standard model for heat conduction, fluid flow in porous media, and electrostatics. The use of isoparametric quadrilateral elements is a canonical topic in FEM literature. All elements are scientifically sound.\n-   **Well-Posed**: The problem asks for the correct expression and evaluation procedure for the element stiffness matrix. This is a well-defined question within the context of FEM theory. Given the inputs, a unique and correct expression exists.\n-   **Objective**: The language is precise, mathematical, and free of any subjective or ambiguous terminology. All terms ($\\mathbf{K}$, $Q_1$ element, isoparametric mapping, Jacobian) are standard in the field.\n-   **Completeness**: The problem provides all necessary information to derive the element stiffness matrix. The properties of $\\mathbf{K}$, the element type, the mapping, and the relationship between gradients are all specified.\n\nThe problem statement does not violate any of the invalidity criteria. It is a well-formed, standard question in computational science and engineering.\n\n#### Step 3: Verdict and Action\n\nThe problem statement is **valid**. Proceeding to the solution.\n\n### Derivation of the Element Stiffness Matrix\n\nThe solution begins with the weak form of the governing partial differential equation, $-\\nabla \\cdot (\\mathbf{K} \\nabla u) = f$. To find the weak form, we multiply by a suitable test function $v$ (from the same space as $u$) and integrate over the domain $\\Omega$.\n\n$$ -\\int_{\\Omega} v \\, \\nabla \\cdot (\\mathbf{K} \\nabla u) \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} v f \\, \\mathrm{d}\\mathbf{x} $$\n\nApplying Green's first identity (integration by parts in multiple dimensions) to the left-hand side:\n\n$$ \\int_{\\Omega} (\\nabla v)^T (\\mathbf{K} \\nabla u) \\, \\mathrm{d}\\mathbf{x} - \\int_{\\partial \\Omega} v (\\mathbf{K} \\nabla u) \\cdot \\mathbf{n} \\, \\mathrm{d}s = \\int_{\\Omega} v f \\, \\mathrm{d}\\mathbf{x} $$\n\nHere, $\\mathbf{n}$ is the outward unit normal to the boundary $\\partial \\Omega$. The boundary integral term is handled by applying boundary conditions. The element stiffness matrix arises from the bilinear form on the left-hand side, $a(v,u) = \\int_{\\Omega} (\\nabla v)^T (\\mathbf{K} \\nabla u) \\, \\mathrm{d}\\mathbf{x}$.\n\nIn the Finite Element Method, the domain $\\Omega$ is partitioned into elements $\\Omega_e$. The total integral is the sum of integrals over each element:\n\n$$ a(v,u) = \\sum_e \\int_{\\Omega_e} (\\nabla v)^T (\\mathbf{K} \\nabla u) \\, \\mathrm{d}\\mathbf{x} $$\n\nWithin a single element $\\Omega_e$, the solution $u$ and test function $v$ are approximated using the shape functions $N_a$:\n$u^e(\\mathbf{x}) = \\sum_{j=1}^4 u_j N_j(\\mathbf{x})$ and $v^e(\\mathbf{x}) = \\sum_{i=1}^4 v_i N_i(\\mathbf{x})$, where $u_j$ and $v_i$ are nodal values.\n\nSubstituting these approximations into the integral over one element:\n\n$$ a^e(v^e, u^e) = \\int_{\\Omega_e} \\left(\\nabla \\sum_{i=1}^4 v_i N_i\\right)^T \\mathbf{K} \\left(\\nabla \\sum_{j=1}^4 u_j N_j\\right) \\, \\mathrm{d}\\mathbf{x} $$\n$$ = \\sum_{i=1}^4 \\sum_{j=1}^4 v_i u_j \\int_{\\Omega_e} (\\nabla N_i)^T \\mathbf{K} (\\nabla N_j) \\, \\mathrm{d}\\mathbf{x} $$\n\nThe $(i,j)$-th entry of the $4 \\times 4$ element stiffness matrix, denoted $k_{ij}^e$, is the integral term:\n\n$$ k_{ij}^e = \\int_{\\Omega_e} (\\nabla N_i)^T \\mathbf{K}(\\mathbf{x}) (\\nabla N_j) \\, \\mathrm{d}\\mathbf{x} $$\n\nThis integral is over the physical element domain $\\Omega_e$. For computation, it must be transformed to the reference square $\\hat{\\Omega} = [-1,1]\\times[-1,1]$. This requires a change of variables, $\\mathbf{x} \\to (\\xi, \\eta)$. The differential area element transforms as $\\mathrm{d}\\mathbf{x} = \\det(\\mathbf{J}) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$. The physical gradients $\\nabla N_a$ are functions of the reference gradients $\\hat{\\nabla} N_a$ via the stated chain rule: $\\nabla N_a = \\mathbf{J}^{-T} \\hat{\\nabla} N_a$.\n\nSubstituting these transformations into the expression for $k_{ij}^e$:\n\n$$ k_{ij}^e = \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\Big(\\nabla N_i\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\Big)^T \\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big) \\Big(\\nabla N_j\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\Big) \\det\\mathbf{J}(\\xi,\\eta) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta $$\n\nThis is the fundamental expression for the element stiffness matrix entry, integrated over the reference element. For numerical evaluation, this integral is approximated using numerical quadrature, typically Gauss-Legendre quadrature for this geometry.\n\nThe integrand is $I(\\xi, \\eta) = (\\nabla N_i)^T \\mathbf{K} (\\nabla N_j) \\det(\\mathbf{J})$. For a general non-parallelogram quadrilateral, the Jacobian $\\mathbf{J}$ is a function of $(\\xi, \\eta)$. Its components are linear in $\\xi$ and $\\eta$. Consequently, $\\det(\\mathbf{J})$ is a polynomial of up to degree 2. The physical gradients are $\\nabla N_i = \\mathbf{J}^{-T} \\hat{\\nabla} N_i$, whose components are rational functions of $(\\xi, \\eta)$ (polynomials divided by $\\det(\\mathbf{J})$). Furthermore, the conductivity tensor $\\mathbf{K}(\\mathbf{x}(\\xi, \\eta))$ is also a function of $(\\xi, \\eta)$. Thus, the integrand is generally a complicated rational function, not a simple polynomial.\nNumerical quadrature is performed by summing the integrand evaluated at a set of Gauss points $\\{(\\xi_g, \\eta_g)\\}$ multiplied by corresponding weights $w_g$:\n\n$$ k_{ij}^e \\approx \\sum_g \\Big[ \\Big(\\nabla N_i\\Big)^T \\mathbf{K} \\Big(\\nabla N_j\\Big) \\det(\\mathbf{J}) \\Big]_{(\\xi_g, \\eta_g)} w_g $$\n\nFor a tensor-product grid of points, $w_g = w_g^\\xi w_g^\\eta$.\n\n### Option-by-Option Analysis\n\n**A. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\nabla N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\nabla N_j(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$, with $\\nabla N_i = \\mathbf{J}^{-T}\\hat{\\nabla}N_i$ and $\\mathbf{x}(\\xi,\\eta)=\\sum_{a=1}^4 N_a(\\xi,\\eta)\\mathbf{x}_a$. Procedure: choose tensor-product Gauss-Legendre points $\\{(\\xi_g,\\eta_g),w_g^\\xi,w_g^\\eta\\}$ of order at least $2\\times 2$ (increase order if $\\mathbf{K}$ varies strongly), and for each point compute $\\hat{\\nabla}N_i(\\xi_g,\\eta_g)$, $\\mathbf{J}(\\xi_g,\\eta_g)$, $\\det\\mathbf{J}(\\xi_g,\\eta_g)$, $\\nabla N_i(\\xi_g,\\eta_g)$, evaluate $\\mathbf{K}\\big(\\mathbf{x}(\\xi_g,\\eta_g)\\big)$, form $\\big(\\nabla N_i\\big)^T\\mathbf{K}\\nabla N_j$, and accumulate $k_{ij}^e \\mathrel{+}= \\big(\\nabla N_i\\big)^T\\mathbf{K}\\nabla N_j\\,\\det\\mathbf{J}\\,w_g^\\xi w_g^\\eta$ over all points.**\n\n-   **Integral Expression**: The formula for $k_{ij}^e$ perfectly matches the correctly derived expression after changing variables to the reference element.\n-   **Definitions**: The provided definitions for $\\nabla N_i$ and the isoparametric mapping are correct.\n-   **Procedure**: The evaluation procedure described is the standard and correct algorithm. It correctly states that all quantities depending on $(\\xi, \\eta)$ (i.e., $\\hat{\\nabla}N_i$, $\\mathbf{J}$, $\\det\\mathbf{J}$, $\\mathbf{K}$) must be computed at each Gauss point. Using a $2 \\times 2$ Gauss quadrature rule is the standard for bilinear quadrilaterals, as it integrates the mass matrix exactly for parallelograms and passes the patch test, ensuring convergence. The recommendation to increase the order for distorted elements or strongly varying $\\mathbf{K}$ is sound numerical practice for maintaining accuracy. The accumulation step is also correctly formulated.\n\nThis option is entirely correct. **Correct**.\n\n**B. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\hat{\\nabla} N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}_c\\big)\\,\\hat{\\nabla} N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$, where $\\mathbf{x}_c$ is the element centroid. Procedure: use a single Gauss point at $(\\xi,\\eta)=(0,0)$ with weight $4$, evaluate $\\mathbf{K}$ at $\\mathbf{x}_c$, and compute $k_{ij}^e = 4\\,\\big(\\hat{\\nabla} N_i(0,0)\\big)^{T}\\,\\mathbf{K}(\\mathbf{x}_c)\\,\\hat{\\nabla} N_j(0,0)$.**\n\n-   **Integral Expression**: This expression is fundamentally flawed. It applies reference gradients $\\hat{\\nabla} N_a$ directly, without transforming them to physical space using the Jacobian $\\mathbf{J}$. It also completely omits the $\\det(\\mathbf{J})$ factor from the area-element transformation. The formula effectively computes the stiffness matrix as if the physical element were the reference square itself, ignoring the actual element geometry and anisotropy induced by the mapping.\n-   **Procedure**: $1 \\times 1$ Gauss quadrature (reduced integration) is generally not accurate enough and can lead to spurious zero-energy modes. The procedure is consistent with the flawed integral (by also approximating $\\mathbf{K}$ as constant), but the integral itself is incorrect.\n\nThis option is incorrect due to a flawed mathematical formulation. **Incorrect**.\n\n**C. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\nabla N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\nabla N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$, with $\\nabla N_i = \\mathbf{J}^{T}\\hat{\\nabla}N_i$ and $\\mathbf{x}(\\xi,\\eta)=\\sum_{a=1}^4 N_a(\\xi,\\eta)\\mathbf{x}_a$. Procedure: choose $2\\times 2$ Gauss-Legendre points, compute $\\mathbf{J}$ only once at $(\\xi,\\eta)=(0,0)$, reuse it at all points, evaluate $\\mathbf{K}$ at each mapped point, and accumulate $k_{ij}^e$ without the $\\det\\mathbf{J}$ factor.**\n\n-   **Integral Expression**: The integral is missing the crucial Jacobian determinant factor $\\det(\\mathbf{J})$, which arises from the change of variables $\\mathrm{d}\\mathbf{x} = \\det(\\mathbf{J}) \\mathrm{d}\\xi \\mathrm{d}\\eta$.\n-   **Definitions**: The gradient transformation is stated as $\\nabla N_i = \\mathbf{J}^{T}\\hat{\\nabla}N_i$, which is incorrect. The correct relation is $\\nabla N_i = \\mathbf{J}^{-T}\\hat{\\nabla}N_i$.\n-   **Procedure**: The procedure suggests computing $\\mathbf{J}$ only once at the element's parametric center. This is only valid for parallelogram-shaped elements where $\\mathbf{J}$ is constant. For general distorted quadrilaterals, $\\mathbf{J}$ varies with $(\\xi, \\eta)$ and must be re-evaluated at each Gauss point.\n\nThis option contains multiple fundamental errors in the formula, definition, and procedure. **Incorrect**.\n\n**D. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\hat{\\nabla} N_i(\\xi,\\eta)\\big)^{T}\\,\\big(\\mathbf{J}^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\mathbf{J}\\big)\\,\\hat{\\nabla} N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$. Procedure: use tensor-product Gauss-Legendre quadrature of order $1\\times 1$ for efficiency, compute $\\mathbf{J}$ and $\\mathbf{K}$ at the single Gauss point, form the inner product above, and sum with the quadrature weight; no determinant term is needed because the transformation is embedded in $\\mathbf{J}^{T}\\mathbf{K}\\mathbf{J}$.**\n\n-   **Integral Expression**: The expression is incorrect. The correct transformation of the integrand is $(\\hat{\\nabla} N_i)^T \\mathbf{J}^{-1} \\mathbf{K} \\mathbf{J}^{-T} \\hat{\\nabla} N_j \\det(\\mathbf{J})$. This expression incorrectly uses $\\mathbf{J}^T$ and $\\mathbf{J}$ instead of $\\mathbf{J}^{-1}$ and $\\mathbf{J}^{-T}$ and also omits the $\\det(\\mathbf{J})$ factor.\n-   **Reasoning**: The claim that the determinant is not needed because the transformation is \"embedded\" is fallacious. The $\\det(\\mathbf{J})$ factor arises from the transformation of the differential area element and is a separate contribution from the transformation of the gradients.\n-   **Procedure**: Recommending $1 \\times 1$ quadrature as a general rule is poor advice. While usable in some contexts (reduced integration), it is not a generally \"sound\" procedure due to potential issues with accuracy and stability (spurious modes).\n\nThis option presents an incorrect formula and faulty reasoning. **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The accuracy of the finite element method often hinges on the precise evaluation of integrals for mass and stiffness matrices. Since these integrals are typically computed numerically, selecting an appropriate Gauss-Legendre quadrature rule is essential. This exercise delves into the theory of numerical integration by asking you to determine the minimum quadrature order needed to exactly integrate the mass matrix for a higher-order element, accounting for the polynomial complexity introduced by both the biquadratic shape functions and the bilinear isoparametric mapping. ",
            "id": "3572442",
            "problem": "Consider a two-dimensional (2D) isoparametric quadrilateral element used in the Finite Element Method (FEM) for computational geophysics. Let the reference, or parent, element be the square $[-1,1] \\times [-1,1]$ with parametric coordinates $(\\xi,\\eta)$. The physical element is obtained by a bilinear isoparametric map, in which the physical coordinates $(x(\\xi,\\eta),y(\\xi,\\eta))$ are constructed from the bilinear shape functions associated with the four corner nodes. Within the parent element, the displacement or scalar field is interpolated using biquadratic $Q_2$ shape functions with nine nodes (corners, edge midpoints, and center). The consistent element mass matrix entries are defined by\n$$\nM_{ij} \\;=\\; \\int_{\\Omega_e} \\rho\\, N_i\\, N_j \\, d\\Omega,\n$$\nwhere $\\rho$ is a constant mass density on the element, $N_i(\\xi,\\eta)$ and $N_j(\\xi,\\eta)$ are the $Q_2$ shape functions evaluated in the parent coordinates and mapped to the physical element via the isoparametric transformation, and $d\\Omega$ denotes the physical area measure.\n\nUnder the isoparametric transformation, the integral is evaluated over the parent element with the Jacobian determinant $J(\\xi,\\eta)$ of the mapping as\n$$\nM_{ij} \\;=\\; \\int_{-1}^{1} \\int_{-1}^{1} \\rho\\, N_i(\\xi,\\eta)\\, N_j(\\xi,\\eta)\\, J(\\xi,\\eta)\\, d\\xi\\, d\\eta.\n$$\n\nDetermine the minimal integer $k$ such that a tensor-product $k$-point Gauss–Legendre quadrature in each parametric direction $(\\xi,\\eta)$ will integrate every entry $M_{ij}$ exactly for a general bilinear isoparametric quadrilateral (i.e., not restricted to affine mappings). Your answer must account for the polynomial degree induced by the bilinear mapping in $J(\\xi,\\eta)$ and the biquadratic nature of the $Q_2$ shape functions. Express your final answer as the single integer $k$ with no units. No rounding is required.",
            "solution": "The problem requires determining the minimal integer $k$ for a $k$-point tensor-product Gauss-Legendre quadrature scheme to exactly integrate all entries of the consistent mass matrix for a general 2D bilinear isoparametric element using biquadratic ($Q_2$) shape functions.\n\nThe entry $M_{ij}$ of the consistent mass matrix is given by the integral:\n$$\nM_{ij} \\;=\\; \\int_{-1}^{1} \\int_{-1}^{1} \\rho\\, N_i(\\xi,\\eta)\\, N_j(\\xi,\\eta)\\, J(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\nwhere $\\rho$ is a constant density, $N_i$ and $N_j$ are the biquadratic shape functions, and $J(\\xi,\\eta)$ is the determinant of the Jacobian of the isoparametric mapping.\n\nA tensor-product $k$-point Gauss-Legendre quadrature rule, applied over the domain $[-1,1] \\times [-1,1]$, can integrate a polynomial $P(\\xi,\\eta)$ exactly if the polynomial degree of $P$ with respect to $\\xi$ is at most $2k-1$, and similarly, the degree with respect to $\\eta$ is at most $2k-1$. To find the minimal required $k$, we must determine the maximum polynomial degree of the integrand, $I(\\xi, \\eta) = \\rho\\, N_i(\\xi,\\eta)\\, N_j(\\xi,\\eta)\\, J(\\xi,\\eta)$, in each of the parametric coordinates, $\\xi$ and $\\eta$. Since $\\rho$ is a constant, it does not affect the polynomial degree.\n\nFirst, we analyze the term $N_i(\\xi,\\eta) N_j(\\xi,\\eta)$. The problem states that the shape functions $N_i$ are biquadratic ($Q_2$) for a nine-node quadrilateral. The basis for the $Q_2$ space of functions on the parent element is $\\{1, \\xi, \\eta, \\xi^2, \\eta^2, \\xi\\eta, \\xi^2\\eta, \\xi\\eta^2, \\xi^2\\eta^2\\}$. Any shape function $N_i(\\xi,\\eta)$ is a linear combination of these basis functions. The maximum degree of any $N_i$ in the variable $\\xi$ is $2$, and the maximum degree in $\\eta$ is also $2$.\nThe product of two such shape functions, $N_i(\\xi,\\eta) N_j(\\xi,\\eta)$, will therefore be a polynomial whose maximum degree in $\\xi$ is the sum of the maximum degrees of $N_i$ and $N_j$ in $\\xi$. This gives a maximum degree of $2+2=4$ in $\\xi$. By the same reasoning, the maximum degree in $\\eta$ is $2+2=4$. For instance, the shape function for the central node is $N_9(\\xi, \\eta) = (1-\\xi^2)(1-\\eta^2)$. Its square, $N_9^2$, contains terms $\\xi^4$ and $\\eta^4$.\n\nNext, we analyze the Jacobian determinant, $J(\\xi,\\eta)$. The mapping from the parent element coordinates $(\\xi,\\eta)$ to the physical coordinates $(x,y)$ is bilinear, meaning it is constructed using the four-node bilinear ($Q_1$) shape functions, $\\phi_a(\\xi,\\eta)$:\n$$\nx(\\xi,\\eta) = \\sum_{a=1}^{4} x_a \\phi_a(\\xi,\\eta) \\quad \\text{and} \\quad y(\\xi,\\eta) = \\sum_{a=1}^{4} y_a \\phi_a(\\xi,\\eta)\n$$\nwhere $(x_a, y_a)$ are the coordinates of the four corner nodes. The bilinear shape functions are of the form $c(1 \\pm \\xi)(1 \\pm \\eta)$, making them linear in $\\xi$ and linear in $\\eta$.\nThe entries of the Jacobian matrix $\\mathbf{J}$ are the partial derivatives of the mapping:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nLet's compute these derivatives. Since $x(\\xi,\\eta)$ is linear in $\\xi$ for a fixed $\\eta$, its derivative $\\frac{\\partial x}{\\partial \\xi}$ will be a function of $\\eta$ only. Specifically, since $x(\\xi,\\eta)$ is also linear in $\\eta$ for a fixed $\\xi$, this function of $\\eta$ will be linear. We can write $\\frac{\\partial x}{\\partial \\xi} = A_0 + A_1 \\eta$ for some constants $A_0, A_1$. Symmetrically, $\\frac{\\partial x}{\\partial \\eta}$ is a linear function of $\\xi$: $\\frac{\\partial x}{\\partial \\eta} = B_0 + B_1 \\xi$. The same applies to the derivatives of $y$: $\\frac{\\partial y}{\\partial \\xi} = C_0 + C_1 \\eta$ and $\\frac{\\partial y}{\\partial \\eta} = D_0 + D_1 \\xi$.\n\nThe Jacobian determinant is:\n$$\nJ(\\xi,\\eta) = \\det(\\mathbf{J}) = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta} \\frac{\\partial y}{\\partial \\xi}\n$$\nSubstituting the functional forms:\n$$\nJ(\\xi,\\eta) = (A_0 + A_1 \\eta)(D_0 + D_1 \\xi) - (B_0 + B_1 \\xi)(C_0 + C_1 \\eta)\n$$\nExpanding this gives:\n$$\nJ(\\xi,\\eta) = (A_0 D_0 - B_0 C_0) + (A_0 D_1 - B_1 C_0)\\xi + (A_1 D_0 - B_0 C_1)\\eta + (A_1 D_1 - B_1 C_1)\\xi\\eta\n$$\nA detailed calculation of the coefficients reveals that $A_1 = B_1 = \\frac{1}{4}(x_1 - x_2 + x_3 - x_4)$ and $C_1 = D_1 = \\frac{1}{4}(y_1 - y_2 + y_3 - y_4)$, where $(x_i, y_i)$ are the corner nodal coordinates. The coefficient of the $\\xi\\eta$ term is thus $A_1 D_1 - B_1 C_1 = A_1 C_1 - A_1 C_1 = 0$.\nTherefore, the Jacobian determinant simplifies to:\n$$\nJ(\\xi,\\eta) = c_0 + c_1\\xi + c_2\\eta\n$$\nfor some constants $c_0, c_1, c_2$. For a general quadrilateral (one that is not a parallelogram), at least one of $c_1$ or $c_2$ will be non-zero. Thus, the maximum polynomial degree of $J(\\xi,\\eta)$ is $1$ in $\\xi$ and $1$ in $\\eta$.\n\nFinally, we determine the maximum degree of the complete integrand, $I(\\xi,\\eta)$. The maximum degree of $I$ in $\\xi$ is the sum of the maximum degrees in $\\xi$ of its factors:\n$$\n\\text{deg}_{\\xi}(I) = \\text{deg}_{\\xi}(N_i N_j) + \\text{deg}_{\\xi}(J) = 4 + 1 = 5\n$$\nSimilarly, the maximum degree of the integrand in $\\eta$ is:\n$$\n\\text{deg}_{\\eta}(I) = \\text{deg}_{\\eta}(N_i N_j) + \\text{deg}_{\\eta}(J) = 4 + 1 = 5\n$$\nTo integrate a polynomial of degree $p=5$ exactly using a $k$-point Gauss-Legendre quadrature rule, the number of points $k$ must satisfy the inequality:\n$$\n2k - 1 \\ge p\n$$\nSubstituting $p=5$, we get:\n$$\n2k - 1 \\ge 5\n$$\n$$\n2k \\ge 6\n$$\n$$\nk \\ge 3\n$$\nThe minimal integer value for $k$ that satisfies this condition is $3$. Therefore, a tensor-product quadrature rule with $3 \\times 3$ Gauss points is required to guarantee exact integration of every mass matrix entry for a general bilinear isoparametric quadrilateral element with biquadratic field interpolation.",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}