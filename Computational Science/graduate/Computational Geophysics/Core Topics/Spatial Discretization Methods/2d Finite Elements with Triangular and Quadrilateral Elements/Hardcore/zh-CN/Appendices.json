{
    "hands_on_practices": [
        {
            "introduction": "在有限元方法中，等参元的使用使得我们可以用简单的参考单元（如正方形）去逼近复杂的物理几何形状。然而，这种从参考空间到物理空间的映射并非总是良性的；它可能引入显著的几何畸变。这个练习  将引导你亲手计算一个扭曲四边形单元的雅可比行列式，这是衡量映射质量和数值稳定性的关键指标，从而加深你对网格质量重要性的理解。",
            "id": "3572383",
            "problem": "考虑一个二维等参双线性四边形有限元，它在有限元法 (FEM) 框架内用于离散化计算地球物理学中的非均匀电导率场。该物理单元由其四个角节点定义，这些节点通过双线性等参公式 $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,x_{i}$ 和 $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,y_{i}$ 从参考正方形 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ 映射而来，其中 $N_{i}(\\xi,\\eta)$ 是标准双线性形函数，映射的雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 定义为 $\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\partial x / \\partial \\xi  \\partial x / \\partial \\eta \\\\ \\partial y / \\partial \\xi  \\partial y / \\partial \\eta \\end{pmatrix}$。节点的排序方式为：节点 $1$ 对应 $(\\xi,\\eta) = (-1,-1)$，节点 $2$ 对应 $(\\xi,\\eta) = (1,-1)$，节点 $3$ 对应 $(\\xi,\\eta) = (1,1)$，节点 $4$ 对应 $(\\xi,\\eta) = (-1,1)$。四个节点的物理坐标（单位为公里）如下：\n- 节点 $1$：$(x_{1},y_{1}) = (0,\\,0)$，\n- 节点 $2$：$(x_{2},y_{2}) = (2.0,\\,0.1)$，\n- 节点 $3$：$(x_{3},y_{3}) = (2.2,\\,1.9)$，\n- 节点 $4$：$(x_{4},y_{4}) = (0.1,\\,2.0)$。\n\n该单元是凸的，但高度扭曲。\n\n从等参映射和雅可比矩阵的定义出发，计算行列式 $\\det\\mathbf{J}(\\xi,\\eta)$ 在位于 $(\\xi,\\eta) = (\\pm 1/\\sqrt{3},\\,\\pm 1/\\sqrt{3})$ 的四个正方形两点 Gauss–Legendre 求积点处的值。根据这些值，评估此单元因近奇异映射而产生的数值不稳定性风险。\n\n报告您计算出的四个高斯点上 $\\det\\mathbf{J}(\\xi,\\eta)$ 的最小值为最终结果。将您的答案四舍五入到四位有效数字。用平方公里表示您的答案。",
            "solution": "四节点四边形的等参双线性映射使用标准双线性形函数\n$$\nN_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta),\n$$\n$$\nN_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta),\n$$\n因此物理位置为\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,y_{i}.\n$$\n雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 根据链式法则得出：\n$$\n\\mathbf{J}(\\xi,\\eta) = \n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\xi}x_{i}  \\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\eta}x_{i} \\\\\n\\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\xi}y_{i}  \\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\eta}y_{i}\n\\end{pmatrix}.\n$$\n形函数的导数为\n$$\n\\frac{\\partial N_{1}}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta),\\quad\n\\frac{\\partial N_{2}}{\\partial \\xi} = \\frac{1}{4}(1-\\eta),\\quad\n\\frac{\\partial N_{3}}{\\partial \\xi} = \\frac{1}{4}(1+\\eta),\\quad\n\\frac{\\partial N_{4}}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta),\n$$\n$$\n\\frac{\\partial N_{1}}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi),\\quad\n\\frac{\\partial N_{2}}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi),\\quad\n\\frac{\\partial N_{3}}{\\partial \\eta} = \\frac{1}{4}(1+\\xi),\\quad\n\\frac{\\partial N_{4}}{\\partial \\eta} = \\frac{1}{4}(1-\\xi).\n$$\n给定 $(x_{1},y_{1}) = (0,\\,0)$，$(x_{2},y_{2}) = (2.0,\\,0.1)$，$(x_{3},y_{3}) = (2.2,\\,1.9)$，$(x_{4},y_{4}) = (0.1,\\,2.0)$，我们可以紧凑地写出\n$$\n\\frac{\\partial x}{\\partial \\xi}(\\eta) = \\frac{(1-\\eta)\\,x_{2} + (1+\\eta)\\,x_{3} - (1+\\eta)\\,x_{4}}{4},\\qquad\n\\frac{\\partial y}{\\partial \\xi}(\\eta) = \\frac{(1-\\eta)\\,y_{2} + (1+\\eta)\\,y_{3} - (1+\\eta)\\,y_{4}}{4},\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}(\\xi) = \\frac{-(1+\\xi)\\,x_{2} + (1+\\xi)\\,x_{3} + (1-\\xi)\\,x_{4}}{4},\\qquad\n\\frac{\\partial y}{\\partial \\eta}(\\xi) = \\frac{-(1+\\xi)\\,y_{2} + (1+\\xi)\\,y_{3} + (1-\\xi)\\,y_{4}}{4}.\n$$\n$[-1,1]$ 上的两点 Gauss–Legendre 求积点位于 $\\xi = \\pm r$ 和 $\\eta = \\pm r$，其中\n$$\nr = \\frac{1}{\\sqrt{3}} \\approx 0.577350269.\n$$\n我们在四个点计算 $\\det\\mathbf{J}(\\xi,\\eta) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)$ 的值。\n\n首先，对于 $(\\xi,\\eta) = (r,r)$，使用 $(1-\\eta) = 1-r \\approx 0.422649731$ 和 $(1+\\eta) = 1+r \\approx 1.577350269$，$(1\\pm\\xi)$ 也类似：\n$$\n\\frac{\\partial x}{\\partial \\xi}(r) = \\frac{0.422649731\\cdot 2.0 + 1.577350269\\cdot 2.2 - 1.577350269\\cdot 0.1}{4} \\approx 1.0394337568,\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi}(r) = \\frac{0.422649731\\cdot 0.1 + 1.577350269\\cdot 1.9 - 1.577350269\\cdot 2.0}{4} \\approx -0.02886751345,\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}(r) = \\frac{-1.577350269\\cdot 2.0 + 1.577350269\\cdot 2.2 + 0.422649731\\cdot 0.1}{4} \\approx 0.089433756775,\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta}(r) = \\frac{-1.577350269\\cdot 0.1 + 1.577350269\\cdot 1.9 + 0.422649731\\cdot 2.0}{4} \\approx 0.92113248655.\n$$\n因此，\n$$\n\\det\\mathbf{J}(r,r) \\approx 1.0394337568\\cdot 0.92113248655 - 0.089433756775\\cdot(-0.02886751345) \\approx 0.96003799.\n$$\n\n其次，对于 $(\\xi,\\eta) = (-r,r)$，有 $(1+\\xi) = 1-r \\approx 0.422649731$ 和 $(1-\\xi) = 1+r \\approx 1.577350269$，而 $(1\\pm\\eta)$ 与之前相同：\n$$\n\\frac{\\partial x}{\\partial \\xi}(r) \\approx 1.0394337568,\\quad \\frac{\\partial y}{\\partial \\xi}(r) \\approx -0.02886751345,\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}(-r) = \\frac{-0.422649731\\cdot 2.0 + 0.422649731\\cdot 2.2 + 1.577350269\\cdot 0.1}{4} \\approx 0.060566243275,\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta}(-r) = \\frac{-0.422649731\\cdot 0.1 + 0.422649731\\cdot 1.9 + 1.577350269\\cdot 2.0}{4} \\approx 0.9788675135,\n$$\n且\n$$\n\\det\\mathbf{J}(-r,r) \\approx 1.0394337568\\cdot 0.9788675135 - 0.060566243275\\cdot(-0.02886751345) \\approx 1.019216337.\n$$\n\n第三，对于 $(\\xi,\\eta) = (r,-r)$，有 $(1-\\eta) = 1+r \\approx 1.577350269$ 和 $(1+\\eta) = 1-r \\approx 0.422649731$：\n$$\n\\frac{\\partial x}{\\partial \\xi}(-r) = \\frac{1.577350269\\cdot 2.0 + 0.422649731\\cdot 2.2 - 0.422649731\\cdot 0.1}{4} \\approx 1.010566243275,\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi}(-r) = \\frac{1.577350269\\cdot 0.1 + 0.422649731\\cdot 1.9 - 0.422649731\\cdot 2.0}{4} \\approx 0.02886751345,\n$$\n且 $(1\\pm\\xi)$ 与第一种情况相同：\n$$\n\\frac{\\partial x}{\\partial \\eta}(r) \\approx 0.089433756775,\\qquad\n\\frac{\\partial y}{\\partial \\eta}(r) \\approx 0.92113248655,\n$$\n得到\n$$\n\\det\\mathbf{J}(r,-r) \\approx 1.010566243275\\cdot 0.92113248655 - 0.089433756775\\cdot 0.02886751345 \\approx 0.928283607.\n$$\n\n第四，对于 $(\\xi,\\eta) = (-r,-r)$：\n$$\n\\frac{\\partial x}{\\partial \\xi}(-r) \\approx 1.010566243275,\\quad \\frac{\\partial y}{\\partial \\xi}(-r) \\approx 0.02886751345,\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}(-r) \\approx 0.060566243275,\\quad \\frac{\\partial y}{\\partial \\eta}(-r) \\approx 0.9788675135,\n$$\n且\n$$\n\\det\\mathbf{J}(-r,-r) \\approx 1.010566243275\\cdot 0.9788675135 - 0.060566243275\\cdot 0.02886751345 \\approx 0.987461796.\n$$\n\n汇总这些结果，高斯点处的四个雅可比行列式（单位为平方公里）的值大约为：\n$$\n\\det\\mathbf{J}(r,r) \\approx 0.96003799,\\quad\n\\det\\mathbf{J}(-r,r) \\approx 1.019216337,\\quad\n\\det\\mathbf{J}(r,-r) \\approx 0.928283607,\\quad\n\\det\\mathbf{J}(-r,-r) \\approx 0.987461796.\n$$\n最小值为\n$$\n\\min\\{\\det\\mathbf{J}\\} \\approx 0.928283607.\n$$\n\n关于数值稳定性，当 $\\det\\mathbf{J}(\\xi,\\eta)$ 在单元内趋近于零或改变符号时，等参映射变得近奇异，这会导致巨大的插值梯度和病态的刚度矩阵。在本例中，所有行列式值都保持为正且量级相当；最小值与最大值的比率 $0.928283607 / 1.019216337 \\approx 0.911$，表明存在中等程度的扭曲，但并非近奇异。因此，对于此单元，由近奇异映射引起的数值不稳定性风险很低。\n\n将最小行列式值四舍五入到四位有效数字，并按要求以平方公里为单位表示，得到\n$$\n0.9283.\n$$",
            "answer": "$$\\boxed{0.9283}$$"
        },
        {
            "introduction": "构建单元刚度矩阵是求解偏微分方程的有限元方法的核心步骤。对于各向异性且非均匀的介质，此过程涉及到从物理坐标到参考坐标的复杂变换，包括梯度算子的变换和积分面积元的变换。本练习  以一个多项选择题的形式，系统性地检验你是否掌握了在等参框架下正确构建刚度矩阵所需的全部要素，确保你能将理论无误地应用于实践。",
            "id": "3572415",
            "problem": "考虑计算地球物理学中典型的非均质各向异性介质中的二维稳态扩散问题：在域 $\\Omega \\subset \\mathbb{R}^2$ 上求解 $u(\\mathbf{x})$，使得 $-\\nabla \\cdot (\\mathbf{K}(\\mathbf{x}) \\nabla u) = f$ 满足适当的边界条件，其中 $\\mathbf{K}(\\mathbf{x})$ 是一个空间变化的对称正定 (SPD) 传导率张量。在有限元法 (FEM) 中，单个四边形单元上的单元刚度矩阵对离散化该方程弱形式的全局系统有贡献。\n\n专注于单个等参双线性四边形单元 ($Q_1$)，其节点位于物理坐标 $\\{\\mathbf{x}_a\\}_{a=1}^4$，并有相应的双线性形函数 $\\{N_a(\\xi,\\eta)\\}_{a=1}^4$ 定义在具有局部坐标 $(\\xi,\\eta)$ 的参考正方形 $\\hat{\\Omega} = [-1,1]\\times[-1,1]$ 上。等参映射定义为 $\\mathbf{x}(\\xi,\\eta) = \\sum_{a=1}^4 N_a(\\xi,\\eta)\\,\\mathbf{x}_a$。此映射的雅可比矩阵为 $\\mathbf{J}(\\xi,\\eta) = \\dfrac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)}$，并且链式法则通过 $\\nabla N_a = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N_a$ 将形函数的物理梯度与参考梯度联系起来，其中 $\\hat{\\nabla}$ 表示关于 $(\\xi,\\eta)$ 的梯度。\n\n您需要选择一个选项，该选项正确地建立了这个 $Q_1$ 单元在 $\\mathbf{K}(\\mathbf{x})$ 空间变化且各向异性情况下的 $4\\times 4$ 单元刚度矩阵的积分表达式，并且正确地陈述了使用 $\\hat{\\Omega}$ 上适当的张量积高斯-勒让德求积来计算它的数值上稳健的过程。\n\n哪个选项给出了正确的表达式和计算步骤？\n\nA. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\nabla N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\nabla N_j(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $\\nabla N_i = \\mathbf{J}^{-T}\\hat{\\nabla}N_i$ 且 $\\mathbf{x}(\\xi,\\eta)=\\sum_{a=1}^4 N_a(\\xi,\\eta)\\mathbf{x}_a$。过程：选择阶数至少为 $2\\times 2$ 的张量积高斯-勒让德点 $\\{(\\xi_g,\\eta_g),w_g^\\xi,w_g^\\eta\\}$（如果 $\\mathbf{K}$ 变化剧烈，则增加阶数），并对每个点计算 $\\hat{\\nabla}N_i(\\xi_g,\\eta_g)$、$\\mathbf{J}(\\xi_g,\\eta_g)$、$\\det\\mathbf{J}(\\xi_g,\\eta_g)$、$\\nabla N_i(\\xi_g,\\eta_g)$，计算 $\\mathbf{K}\\big(\\mathbf{x}(\\xi_g,\\eta_g)\\big)$，构造 $\\big(\\nabla N_i\\big)^T\\mathbf{K}\\nabla N_j$，并在所有点上累加 $k_{ij}^e \\mathrel{+}= \\big(\\nabla N_i\\big)^T\\mathbf{K}\\nabla N_j\\,\\det\\mathbf{J}\\,w_g^\\xi w_g^\\eta$。\n\nB. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\hat{\\nabla} N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}_c\\big)\\,\\hat{\\nabla} N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $\\mathbf{x}_c$ 是单元的形心。过程：使用位于 $(\\xi,\\eta)=(0,0)$ 的单个高斯点，权重为 $4$，在 $\\mathbf{x}_c$ 处计算 $\\mathbf{K}$，并计算 $k_{ij}^e = 4\\,\\big(\\hat{\\nabla} N_i(0,0)\\big)^{T}\\,\\mathbf{K}(\\mathbf{x}_c)\\,\\hat{\\nabla} N_j(0,0)$。\n\nC. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\nabla N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\nabla N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $\\nabla N_i = \\mathbf{J}^{T}\\hat{\\nabla}N_i$ 且 $\\mathbf{x}(\\xi,\\eta)=\\sum_{a=1}^4 N_a(\\xi,\\eta)\\mathbf{x}_a$。过程：选择 $2\\times 2$ 的高斯-勒让德点，仅在 $(\\xi,\\eta)=(0,0)$ 处计算一次 $\\mathbf{J}$，在所有点上重复使用它，在每个映射点上计算 $\\mathbf{K}$，并在没有 $\\det\\mathbf{J}$ 因子的情况下累加 $k_{ij}^e$。\n\nD. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\hat{\\nabla} N_i(\\xi,\\eta)\\big)^{T}\\,\\big(\\mathbf{J}^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\mathbf{J}\\big)\\,\\hat{\\nabla} N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。过程：为了效率，使用 $1\\times 1$ 阶的张量积高斯-勒让德求积，在单个高斯点上计算 $\\mathbf{J}$ 和 $\\mathbf{K}$，构造上述内积，并与求积权重相加；不需要行列式项，因为变换已嵌入在 $\\mathbf{J}^{T}\\mathbf{K}\\mathbf{J}$ 中。\n\n选择正确的选项。",
            "solution": "### 问题验证\n\n#### 步骤1：提取已知条件\n\n题目陈述提供了以下信息：\n1.  **控制方程**：非均质各向异性介质中的二维稳态扩散方程为 $-\\nabla \\cdot (\\mathbf{K}(\\mathbf{x}) \\nabla u) = f$。\n2.  **域**：问题定义在域 $\\Omega \\subset \\mathbb{R}^2$ 上。\n3.  **传导率张量**：$\\mathbf{K}(\\mathbf{x})$ 是一个空间变化的对称正定 (SPD) 张量。\n4.  **离散化方法**：使用有限元法 (FEM)。\n5.  **单元类型**：考虑单个等参双线性四边形单元 ($Q_1$)。\n6.  **节点坐标**：单元节点位于物理坐标 $\\{\\mathbf{x}_a\\}_{a=1}^4$。\n7.  **形函数**：双线性形函数 $\\{N_a(\\xi,\\eta)\\}_{a=1}^4$ 定义在具有局部坐标 $(\\xi,\\eta)$ 的参考正方形 $\\hat{\\Omega} = [-1,1]\\times[-1,1]$ 上。\n8.  **等参映射**：从参考坐标到物理坐标的映射为 $\\mathbf{x}(\\xi,\\eta) = \\sum_{a=1}^4 N_a(\\xi,\\eta)\\,\\mathbf{x}_a$。\n9.  **雅可比矩阵**：映射的雅可比矩阵为 $\\mathbf{J}(\\xi,\\eta) = \\dfrac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)}$。\n10. **梯度的链式法则**：形函数的物理梯度 ($\\nabla$) 和参考梯度 ($\\hat{\\nabla}$) 之间的关系由 $\\nabla N_a = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N_a$ 给出。\n\n#### 步骤2：使用提取的已知条件进行验证\n\n题目陈述描述了有限元法在二阶椭圆型偏微分方程上的一个标准应用。\n-   **科学依据**：该问题植根于连续介质力学（扩散）和数值分析（FEM）的基本原理。该控制方程是热传导、多孔介质中的流体流动和静电学的标准模型。使用等参四边形单元是FEM文献中的经典课题。所有元素都具有科学合理性。\n-   **良态性**：问题要求给出单元刚度矩阵的正确表达式和计算过程。在FEM理论的背景下，这是一个明确定义的问题。给定输入，存在唯一且正确的表达式。\n-   **客观性**：语言精确、数学化，不含任何主观或模糊的术语。所有术语（$\\mathbf{K}$、$Q_1$ 单元、等参映射、雅可比矩阵）都是该领域的标准术语。\n-   **完整性**：问题提供了推导单元刚度矩阵所需的所有信息。$\\mathbf{K}$的性质、单元类型、映射以及梯度之间的关系都已指定。\n\n题目陈述没有违反任何无效标准。这是一个在计算科学和工程领域中格式规范的标准问题。\n\n#### 步骤3：结论与操作\n\n题目陈述是**有效**的。开始解答。\n\n### 单元刚度矩阵的推导\n\n解答从控制偏微分方程 $-\\nabla \\cdot (\\mathbf{K} \\nabla u) = f$ 的弱形式开始。为求弱形式，我们乘以一个合适的检验函数 $v$（与 $u$ 来自同一空间）并在域 $\\Omega$ 上积分。\n\n$$ -\\int_{\\Omega} v \\, \\nabla \\cdot (\\mathbf{K} \\nabla u) \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} v f \\, \\mathrm{d}\\mathbf{x} $$\n\n对左侧应用格林第一恒等式（多维分部积分）：\n\n$$ \\int_{\\Omega} (\\nabla v)^T (\\mathbf{K} \\nabla u) \\, \\mathrm{d}\\mathbf{x} - \\int_{\\partial \\Omega} v (\\mathbf{K} \\nabla u) \\cdot \\mathbf{n} \\, \\mathrm{d}s = \\int_{\\Omega} v f \\, \\mathrm{d}\\mathbf{x} $$\n\n此处，$\\mathbf{n}$ 是边界 $\\partial \\Omega$ 上的单位外法向量。边界积分项通过施加边界条件来处理。单元刚度矩阵源于左侧的双线性形式 $a(v,u) = \\int_{\\Omega} (\\nabla v)^T (\\mathbf{K} \\nabla u) \\, \\mathrm{d}\\mathbf{x}$。\n\n在有限元法中，域 $\\Omega$ 被划分为单元 $\\Omega_e$。总积分是每个单元上积分的总和：\n\n$$ a(v,u) = \\sum_e \\int_{\\Omega_e} (\\nabla v)^T (\\mathbf{K} \\nabla u) \\, \\mathrm{d}\\mathbf{x} $$\n\n在单个单元 $\\Omega_e$ 内，解 $u$ 和检验函数 $v$ 使用形函数 $N_a$ 进行近似：\n$u^e(\\mathbf{x}) = \\sum_{j=1}^4 u_j N_j(\\mathbf{x})$ 和 $v^e(\\mathbf{x}) = \\sum_{i=1}^4 v_i N_i(\\mathbf{x})$，其中 $u_j$ 和 $v_i$ 是节点值。\n\n将这些近似代入单个单元的积分中：\n\n$$ a^e(v^e, u^e) = \\int_{\\Omega_e} \\left(\\nabla \\sum_{i=1}^4 v_i N_i\\right)^T \\mathbf{K} \\left(\\nabla \\sum_{j=1}^4 u_j N_j\\right) \\, \\mathrm{d}\\mathbf{x} $$\n$$ = \\sum_{i=1}^4 \\sum_{j=1}^4 v_i u_j \\int_{\\Omega_e} (\\nabla N_i)^T \\mathbf{K} (\\nabla N_j) \\, \\mathrm{d}\\mathbf{x} $$\n\n$4 \\times 4$ 单元刚度矩阵的第 $(i,j)$ 个元素，记作 $k_{ij}^e$，是该积分项：\n\n$$ k_{ij}^e = \\int_{\\Omega_e} (\\nabla N_i)^T \\mathbf{K}(\\mathbf{x}) (\\nabla N_j) \\, \\mathrm{d}\\mathbf{x} $$\n\n这个积分是在物理单元域 $\\Omega_e$ 上进行的。为了计算，必须将其转换到参考正方形 $\\hat{\\Omega} = [-1,1]\\times[-1,1]$ 上。这需要进行变量替换，$\\mathbf{x} \\to (\\xi, \\eta)$。微分面积元变换为 $\\mathrm{d}\\mathbf{x} = \\det(\\mathbf{J}) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$。物理梯度 $\\nabla N_a$ 是参考梯度 $\\hat{\\nabla} N_a$ 的函数，通过所述的链式法则：$\\nabla N_a = \\mathbf{J}^{-T} \\hat{\\nabla} N_a$。\n\n将这些变换代入 $k_{ij}^e$ 的表达式中：\n\n$$ k_{ij}^e = \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\Big(\\nabla N_i\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\Big)^T \\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big) \\Big(\\nabla N_j\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\Big) \\det\\mathbf{J}(\\xi,\\eta) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta $$\n\n这是在参考单元上积分的单元刚度矩阵元素的基本表达式。为了进行数值评估，该积分使用数值求积进行近似，对于这种几何形状，通常使用高斯-勒让德求积。\n\n被积函数是 $I(\\xi, \\eta) = (\\nabla N_i)^T \\mathbf{K} (\\nabla N_j) \\det(\\mathbf{J})$。对于一般的非平行四边形，雅可比矩阵 $\\mathbf{J}$ 是 $(\\xi, \\eta)$ 的函数。其分量是 $\\xi$ 和 $\\eta$ 的线性函数。因此，$\\det(\\mathbf{J})$ 是一个最高为2次的多项式。物理梯度 $\\nabla N_i = \\mathbf{J}^{-T} \\hat{\\nabla} N_i$，其分量是 $(\\xi, \\eta)$ 的有理函数（多项式除以 $\\det(\\mathbf{J})$）。此外，传导率张量 $\\mathbf{K}(\\mathbf{x}(\\xi, \\eta))$ 也是 $(\\xi, \\eta)$ 的函数。因此，被积函数通常是一个复杂的有理函数，而不是一个简单的多项式。\n数值求积是通过将在高斯点集 $\\{(\\xi_g, \\eta_g)\\}$ 上计算的被积函数值乘以相应的权重 $w_g$ 后求和来执行的：\n\n$$ k_{ij}^e \\approx \\sum_g \\Big[ \\Big(\\nabla N_i\\Big)^T \\mathbf{K} \\Big(\\nabla N_j\\Big) \\det(\\mathbf{J}) \\Big]_{(\\xi_g, \\eta_g)} w_g $$\n\n对于张量积点网格， $w_g = w_g^\\xi w_g^\\eta$。\n\n### 逐项分析\n\n**A. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\nabla N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\nabla N_j(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $\\nabla N_i = \\mathbf{J}^{-T}\\hat{\\nabla}N_i$ 且 $\\mathbf{x}(\\xi,\\eta)=\\sum_{a=1}^4 N_a(\\xi,\\eta)\\mathbf{x}_a$。过程：选择阶数至少为 $2\\times 2$ 的张量积高斯-勒让德点 $\\{(\\xi_g,\\eta_g),w_g^\\xi,w_g^\\eta\\}$（如果 $\\mathbf{K}$ 变化剧烈，则增加阶数），并对每个点计算 $\\hat{\\nabla}N_i(\\xi_g,\\eta_g)$、$\\mathbf{J}(\\xi_g,\\eta_g)$、$\\det\\mathbf{J}(\\xi_g,\\eta_g)$、$\\nabla N_i(\\xi_g,\\eta_g)$，计算 $\\mathbf{K}\\big(\\mathbf{x}(\\xi_g,\\eta_g)\\big)$，构造 $\\big(\\nabla N_i\\big)^T\\mathbf{K}\\nabla N_j$，并在所有点上累加 $k_{ij}^e \\mathrel{+}= \\big(\\nabla N_i\\big)^T\\mathbf{K}\\nabla N_j\\,\\det\\mathbf{J}\\,w_g^\\xi w_g^\\eta$。**\n\n-   **积分表达式**：$k_{ij}^e$ 的公式与变量变换到参考单元后正确推导出的表达式完全匹配。\n-   **定义**：所提供的 $\\nabla N_i$ 定义和等参映射是正确的。\n-   **过程**：所描述的计算过程是标准且正确的算法。它正确地指出，所有依赖于 $(\\xi, \\eta)$ 的量（即 $\\hat{\\nabla}N_i$、$\\mathbf{J}$、$\\det\\mathbf{J}$、$\\mathbf{K}$）都必须在每个高斯点上计算。使用 $2 \\times 2$ 高斯求积法是双线性四边形的标准做法，因为它能精确积分平行四边形的质量矩阵，并通过了分片检验，确保了收敛性。对于扭曲单元或变化剧烈的 $\\mathbf{K}$，建议增加阶数以保持精度，这是稳健的数值实践。累加步骤的表述也正确。\n\n此选项完全正确。**正确**。\n\n**B. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\hat{\\nabla} N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}_c\\big)\\,\\hat{\\nabla} N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $\\mathbf{x}_c$ 是单元的形心。过程：使用位于 $(\\xi,\\eta)=(0,0)$ 的单个高斯点，权重为 $4$，在 $\\mathbf{x}_c$ 处计算 $\\mathbf{K}$，并计算 $k_{ij}^e = 4\\,\\big(\\hat{\\nabla} N_i(0,0)\\big)^{T}\\,\\mathbf{K}(\\mathbf{x}_c)\\,\\hat{\\nabla} N_j(0,0)$。**\n\n-   **积分表达式**：此表达式存在根本性缺陷。它直接应用参考梯度 $\\hat{\\nabla} N_a$，而没有使用雅可比矩阵 $\\mathbf{J}$ 将其转换到物理空间。它还完全忽略了面积元变换中的 $\\det(\\mathbf{J})$ 因子。该公式实际上是假设物理单元就是参考正方形本身来计算刚度矩阵，忽略了实际的单元几何形状和映射引起的各向异性。\n-   **过程**：$1 \\times 1$ 高斯求积（减缩积分）通常不够精确，并可能导致伪零能模式。该过程与有缺陷的积分是一致的（通过也将 $\\mathbf{K}$ 近似为常数），但积分本身是不正确的。\n\n此选项因数学公式错误而**不正确**。\n\n**C. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\nabla N_i(\\xi,\\eta)\\big)^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\nabla N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $\\nabla N_i = \\mathbf{J}^{T}\\hat{\\nabla}N_i$ 且 $\\mathbf{x}(\\xi,\\eta)=\\sum_{a=1}^4 N_a(\\xi,\\eta)\\mathbf{x}_a$。过程：选择 $2\\times 2$ 的高斯-勒让德点，仅在 $(\\xi,\\eta)=(0,0)$ 处计算一次 $\\mathbf{J}$，在所有点上重复使用它，在每个映射点上计算 $\\mathbf{K}$，并在没有 $\\det\\mathbf{J}$ 因子的情况下累加 $k_{ij}^e$。**\n\n-   **积分表达式**：积分缺少了关键的雅可比行列式因子 $\\det(\\mathbf{J})$，该因子源于变量替换 $\\mathrm{d}\\mathbf{x} = \\det(\\mathbf{J}) \\mathrm{d}\\xi \\mathrm{d}\\eta$。\n-   **定义**：梯度变换被表述为 $\\nabla N_i = \\mathbf{J}^{T}\\hat{\\nabla}N_i$，这是不正确的。正确的关系是 $\\nabla N_i = \\mathbf{J}^{-T}\\hat{\\nabla}N_i$。\n-   **过程**：该过程建议仅在单元的参数中心计算一次 $\\mathbf{J}$。这仅对雅可比矩阵 $\\mathbf{J}$ 为常数的平行四边形单元有效。对于一般的扭曲四边形，$\\mathbf{J}$ 随 $(\\xi, \\eta)$ 变化，必须在每个高斯点重新计算。\n\n此选项在公式、定义和过程中包含多个根本性错误。**不正确**。\n\n**D. $k_{ij}^e = \\displaystyle \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\big(\\hat{\\nabla} N_i(\\xi,\\eta)\\big)^{T}\\,\\big(\\mathbf{J}^{T}\\,\\mathbf{K}\\big(\\mathbf{x}(\\xi,\\eta)\\big)\\,\\mathbf{J}\\big)\\,\\hat{\\nabla} N_j(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。过程：为了效率，使用 $1\\times 1$ 阶的张量积高斯-勒让德求积，在单个高斯点上计算 $\\mathbf{J}$ 和 $\\mathbf{K}$，构造上述内积，并与求积权重相加；不需要行列式项，因为变换已嵌入在 $\\mathbf{J}^{T}\\mathbf{K}\\mathbf{J}$ 中。**\n\n-   **积分表达式**：表达式不正确。被积函数的正确变换是 $(\\hat{\\nabla} N_i)^T \\mathbf{J}^{-1} \\mathbf{K} \\mathbf{J}^{-T} \\hat{\\nabla} N_j \\det(\\mathbf{J})$。此表达式错误地使用了 $\\mathbf{J}^T$ 和 $\\mathbf{J}$ 而非 $\\mathbf{J}^{-1}$ 和 $\\mathbf{J}^{-T}$，并且也省略了 $\\det(\\mathbf{J})$ 因子。\n-   **推理**：声称不需要行列式是因为变换“已嵌入”的说法是错误的。$\\det(\\mathbf{J})$ 因子源于微分面积元的变换，是与梯度变换分开的贡献。\n-   **过程**：将 $1 \\times 1$ 求积作为一般规则来推荐是不好的建议。虽然在某些情况下（减缩积分）可用，但由于可能存在精度和稳定性问题（伪模式），它不是一个普遍“稳健”的过程。\n\n此选项提出了不正确的公式和错误的推理。**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在有限元计算中，单元矩阵（如质量矩阵和刚度矩阵）的积分通常通过数值求积（如高斯求积）来完成。为了保证离散格式的精度和收敛阶，数值求积的阶数必须足够高，以精确地积分被积函数。本练习  将让你确定在特定情况下（$Q_2$ 基函数和双线性映射）精确积分质量矩阵所需的最小高斯求积阶数，这对于编写高效且准确的有限元代码至关重要。",
            "id": "3572442",
            "problem": "考虑一个用于计算地球物理学中有限元法 (FEM) 的二维 (2D) 等参四边形单元。设参考单元（或母单元）为方形区域 $[-1,1] \\times [-1,1]$，其参数坐标为 $(\\xi,\\eta)$。物理单元通过双线性等参映射得到，其中物理坐标 $(x(\\xi,\\eta),y(\\xi,\\eta))$ 由与四个角节点相关的双线性形函数构造而成。在母单元内，位移或标量场使用具有九个节点（角节点、边中点和中心节点）的双二次 $Q_2$ 形函数进行插值。一致单元质量矩阵的项定义为\n$$\nM_{ij} \\;=\\; \\int_{\\Omega_e} \\rho\\, N_i\\, N_j \\, d\\Omega,\n$$\n其中 $\\rho$ 是单元上的常数质量密度，$N_i(\\xi,\\eta)$ 和 $N_j(\\xi,\\eta)$ 是在母单元坐标中求值并通过等参变换映射到物理单元的 $Q_2$ 形函数，$d\\Omega$ 表示物理面积测度。\n\n在等参变换下，该积分在母单元上进行计算，其中包含映射的雅可比行列式 $J(\\xi,\\eta)$，形式如下\n$$\nM_{ij} \\;=\\; \\int_{-1}^{1} \\int_{-1}^{1} \\rho\\, N_i(\\xi,\\eta)\\, N_j(\\xi,\\eta)\\, J(\\xi,\\eta)\\, d\\xi\\, d\\eta.\n$$\n\n确定最小整数 $k$，使得在每个参数方向 $(\\xi,\\eta)$ 上的张量积 $k$ 点 Gauss–Legendre 求积能够对一个一般的（即不限于仿射映射的）双线性等参四边形的所有矩阵项 $M_{ij}$ 进行精确积分。您的答案必须考虑到由 $J(\\xi,\\eta)$ 中的双线性映射引起的以及 $Q_2$ 形函数的双二次特性所导致的多项式次数。请将您的最终答案表示为单个整数 $k$，不带单位。无需四舍五入。",
            "solution": "该问题要求确定一个最小整数 $k$，使得一个 $k$ 点张量积 Gauss-Legendre 求积方案能够为一个使用双二次 ($Q_2$) 形函数的一般二维双线性等参单元精确地积分其一致质量矩阵的所有项。\n\n一致质量矩阵的项 $M_{ij}$ 由以下积分给出：\n$$\nM_{ij} \\;=\\; \\int_{-1}^{1} \\int_{-1}^{1} \\rho\\, N_i(\\xi,\\eta)\\, N_j(\\xi,\\eta)\\, J(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\n其中 $\\rho$ 是常数密度，$N_i$ 和 $N_j$ 是双二次形函数，$J(\\xi,\\eta)$ 是等参映射的雅可比行列式。\n\n一个应用于区域 $[-1,1] \\times [-1,1]$ 上的张量积 $k$ 点 Gauss-Legendre 求积法则，能够精确积分一个多项式 $P(\\xi,\\eta)$，条件是 $P$ 关于 $\\xi$ 的多项式次数至多为 $2k-1$，同样，关于 $\\eta$ 的次数也至多为 $2k-1$。为了找到所需的最小 $k$，我们必须确定被积函数 $I(\\xi, \\eta) = \\rho\\, N_i(\\xi,\\eta)\\, N_j(\\xi,\\eta)\\, J(\\xi,\\eta)$ 在每个参数坐标 $\\xi$ 和 $\\eta$ 中的最高多项式次数。由于 $\\rho$ 是一个常数，它不影响多项式的次数。\n\n首先，我们分析 $N_i(\\xi,\\eta) N_j(\\xi,\\eta)$ 这一项。问题指出，对于九节点四边形，形函数 $N_i$ 是双二次的 ($Q_2$)。母单元上 $Q_2$ 函数空间的基是 $\\{1, \\xi, \\eta, \\xi^2, \\eta^2, \\xi\\eta, \\xi^2\\eta, \\xi\\eta^2, \\xi^2\\eta^2\\}$。任何形函数 $N_i(\\xi,\\eta)$ 都是这些基函数的线性组合。任何 $N_i$ 在变量 $\\xi$ 中的最高次数为 $2$，在 $\\eta$ 中的最高次数也为 $2$。\n因此，两个这样的形函数的乘积 $N_i(\\xi,\\eta) N_j(\\xi,\\eta)$ 将是一个多项式，其在 $\\xi$ 中的最高次数是 $N_i$ 和 $N_j$ 在 $\\xi$ 中最高次数之和。这给出了在 $\\xi$ 中的最高次数为 $2+2=4$。同理，在 $\\eta$ 中的最高次数为 $2+2=4$。例如，中心节点的形函数为 $N_9(\\xi, \\eta) = (1-\\xi^2)(1-\\eta^2)$。其平方 $N_9^2$ 包含 $\\xi^4$ 和 $\\eta^4$ 项。\n\n接下来，我们分析雅可比行列式 $J(\\xi,\\eta)$。从母单元坐标 $(\\xi,\\eta)$到物理坐标 $(x,y)$ 的映射是双线性的，这意味着它是使用四节点双线性 ($Q_1$) 形函数 $\\phi_a(\\xi,\\eta)$ 构造的：\n$$\nx(\\xi,\\eta) = \\sum_{a=1}^{4} x_a \\phi_a(\\xi,\\eta) \\quad \\text{and} \\quad y(\\xi,\\eta) = \\sum_{a=1}^{4} y_a \\phi_a(\\xi,\\eta)\n$$\n其中 $(x_a, y_a)$ 是四个角节点的坐标。双线性形函数的形式为 $c(1 \\pm \\xi)(1 \\pm \\eta)$，使其在 $\\xi$ 中是线性的，在 $\\eta$ 中也是线性的。\n雅可比矩阵 $\\mathbf{J}$ 的项是映射的偏导数：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们来计算这些导数。由于对于固定的 $\\eta$，$x(\\xi,\\eta)$ 在 $\\xi$ 中是线性的，其导数 $\\frac{\\partial x}{\\partial \\xi}$ 将仅是 $\\eta$ 的函数。具体来说，由于对于固定的 $\\xi$，$x(\\xi,\\eta)$ 在 $\\eta$ 中也是线性的，所以这个关于 $\\eta$ 的函数将是线性的。我们可以写成 $\\frac{\\partial x}{\\partial \\xi} = A_0 + A_1 \\eta$，其中 $A_0, A_1$ 是常数。对称地，$\\frac{\\partial x}{\\partial \\eta}$ 是 $\\xi$ 的线性函数：$\\frac{\\partial x}{\\partial \\eta} = B_0 + B_1 \\xi$。这同样适用于 $y$ 的导数：$\\frac{\\partial y}{\\partial \\xi} = C_0 + C_1 \\eta$ 和 $\\frac{\\partial y}{\\partial \\eta} = D_0 + D_1 \\xi$。\n\n雅可比行列式是：\n$$\nJ(\\xi,\\eta) = \\det(\\mathbf{J}) = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta} \\frac{\\partial y}{\\partial \\xi}\n$$\n代入函数形式：\n$$\nJ(\\xi,\\eta) = (A_0 + A_1 \\eta)(D_0 + D_1 \\xi) - (B_0 + B_1 \\xi)(C_0 + C_1 \\eta)\n$$\n展开此式得到：\n$$\nJ(\\xi,\\eta) = (A_0 D_0 - B_0 C_0) + (A_0 D_1 - B_1 C_0)\\xi + (A_1 D_0 - B_0 C_1)\\eta + (A_1 D_1 - B_1 C_1)\\xi\\eta\n$$\n对系数的详细计算表明 $A_1 = B_1 = \\frac{1}{4}(x_1 - x_2 + x_3 - x_4)$ 且 $C_1 = D_1 = \\frac{1}{4}(y_1 - y_2 + y_3 - y_4)$，其中 $(x_i, y_i)$ 是角节点坐标。因此，$\\xi\\eta$ 项的系数是 $A_1 D_1 - B_1 C_1 = A_1 C_1 - A_1 C_1 = 0$。\n因此，雅可比行列式简化为：\n$$\nJ(\\xi,\\eta) = c_0 + c_1\\xi + c_2\\eta\n$$\n其中 $c_0, c_1, c_2$ 为某些常数。对于一个一般的（非平行四边形的）四边形， $c_1$ 或 $c_2$ 中至少有一个非零。因此，$J(\\xi,\\eta)$ 在 $\\xi$ 中的最高多项式次数为 $1$，在 $\\eta$ 中的最高多项式次数也为 $1$。\n\n最后，我们确定完整被积函数 $I(\\xi,\\eta)$ 的最高次数。$I$ 在 $\\xi$ 中的最高次数是其各因子在 $\\xi$ 中最高次数之和：\n$$\n\\text{deg}_{\\xi}(I) = \\text{deg}_{\\xi}(N_i N_j) + \\text{deg}_{\\xi}(J) = 4 + 1 = 5\n$$\n类似地，被积函数在 $\\eta$ 中的最高次数是：\n$$\n\\text{deg}_{\\eta}(I) = \\text{deg}_{\\eta}(N_i N_j) + \\text{deg}_{\\eta}(J) = 4 + 1 = 5\n$$\n为了使用一个 $k$ 点 Gauss-Legendre 求积法则精确积分一个次数为 $p=5$ 的多项式，点数 $k$ 必须满足不等式：\n$$\n2k - 1 \\ge p\n$$\n代入 $p=5$，我们得到：\n$$\n2k - 1 \\ge 5\n$$\n$$\n2k \\ge 6\n$$\n$$\nk \\ge 3\n$$\n满足此条件的最小整数 $k$ 值为 $3$。因此，需要一个 $3 \\times 3$ Gauss 点的张量积求积法则来保证对一个具有双二次场插值的一般双线性等参四边形单元的每个质量矩阵项进行精确积分。",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}