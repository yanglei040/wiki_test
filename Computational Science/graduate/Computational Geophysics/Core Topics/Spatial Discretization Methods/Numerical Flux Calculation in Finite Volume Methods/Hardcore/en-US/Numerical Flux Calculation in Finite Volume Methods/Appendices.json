{
    "hands_on_practices": [
        {
            "introduction": "Understanding the numerical flux is central to the finite volume method. This first practice establishes the groundwork by asking you to derive the classic upwind numerical flux for the linear advection equation from first principles . By working through this derivation, you will solidify your understanding of how the direction of information flow, dictated by the sign of the advection speed $a$, directly determines the structure of a stable and accurate numerical scheme.",
            "id": "3611967",
            "problem": "Consider one-dimensional linear advection of a passive tracer in a homogeneous medium, modeled by the conservation law $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a \\in \\mathbb{R}$. In a Finite Volume Method (FVM) on a uniform mesh with cell centers $x_{i}$, cell interfaces $x_{i \\pm 1/2}$, cell width $\\Delta x > 0$, and a constant time step $\\Delta t > 0$, denote the cell average in cell $i$ at time level $n$ by $\\bar{u}_{i}^{n}$. Starting from the integral form of the conservation law and the definition of the numerical flux across cell interfaces, derive the one-step finite volume update for $\\bar{u}_{i}^{n+1}$ in terms of a consistent numerical flux $F_{i \\pm 1/2}^{n}$. Then, by analyzing the local Riemann problem at a cell interface and enforcing upwinding consistent with the sign of $a$, obtain a single closed-form analytic expression for the interfacial numerical flux $F_{i+1/2}^{n}$ that does not rely on piecewise case distinctions. Express your final answer explicitly in terms of $a$, $\\bar{u}_{i}^{n}$, and $\\bar{u}_{i+1}^{n}$. No numerical evaluation is required, and no rounding is needed. Provide the finite volume update as part of your derivation, but report only the requested interfacial flux expression as your final answer.",
            "solution": "The starting point is the conservation law $u_{t} + (f(u))_{x} = 0$ with physical flux $f(u) = a\\,u$ for constant advection speed $a$. Integrating over a control volume (cell) $I_{i} = [x_{i-1/2}, x_{i+1/2}]$ and using the Fundamental Theorem of Calculus, we obtain\n\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{\\Delta x}\\int_{I_{i}} u(x,t)\\,\\mathrm{d}x\\right) + \\frac{1}{\\Delta x}\\left(f(u(x_{i+1/2},t)) - f(u(x_{i-1/2},t))\\right) = 0.\n$$\n\nDefining the cell average $\\bar{u}_{i}(t) = \\frac{1}{\\Delta x}\\int_{I_{i}} u(x,t)\\,\\mathrm{d}x$ and replacing the physical interfacial fluxes by consistent numerical fluxes $F_{i\\pm 1/2}(t)$, we have\n\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\bar{u}_{i}(t) + \\frac{1}{\\Delta x}\\left(F_{i+1/2}(t) - F_{i-1/2}(t)\\right) = 0.\n$$\n\nA first-order accurate explicit time discretization (e.g., forward Euler) yields\n\n$$\n\\bar{u}_{i}^{n+1} = \\bar{u}_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right).\n$$\n\nIt remains to determine a consistent, monotone numerical flux $F_{i+1/2}^{n}$ that implements upwinding according to the sign of $a$.\n\nFor linear advection, the local Riemann problem at interface $x_{i+1/2}$ with left state $u_{L} = \\bar{u}_{i}^{n}$ and right state $u_{R} = \\bar{u}_{i+1}^{n}$ transports information at speed $a$. The exact solution is self-similar and constant along characteristics $x - a t = \\text{const}$. Therefore, the interfacial state $u^{*}$ at $x_{i+1/2}$ is\n\n$$\nu^{*} =\n\\begin{cases}\nu_{L},  a > 0, \\\\\nu_{R},  a  0,\n\\end{cases}\n$$\n\nand the corresponding physical flux is $f(u^{*}) = a\\,u^{*}$. This is the standard upwind choice, which can be written without an explicit case distinction using flux-splitting. Define the positive and negative parts of the advection speed,\n\n$$\na^{+} = \\frac{1}{2}\\left(a + |a|\\right), \\qquad a^{-} = \\frac{1}{2}\\left(a - |a|\\right),\n$$\n\nso that $a = a^{+} + a^{-}$ and $a^{+} \\ge 0$, $a^{-} \\le 0$, with $a^{+} = a$ and $a^{-} = 0$ when $a \\ge 0$, and $a^{+} = 0$, $a^{-} = a$ when $a \\le 0$. The Godunov upwind flux for linear advection can then be expressed as\n\n$$\nF_{i+1/2}^{n} = a^{+}\\,\\bar{u}_{i}^{n} + a^{-}\\,\\bar{u}_{i+1}^{n}.\n$$\n\nEliminating $a^{+}$ and $a^{-}$ gives a single closed-form analytic expression in terms of $a$, $\\bar{u}_{i}^{n}$, and $\\bar{u}_{i+1}^{n}$:\n\n$$\nF_{i+1/2}^{n} = \\frac{1}{2}\\left[a\\left(\\bar{u}_{i}^{n} + \\bar{u}_{i+1}^{n}\\right) - |a|\\left(\\bar{u}_{i+1}^{n} - \\bar{u}_{i}^{n}\\right)\\right].\n$$\n\nThis expression is consistent with the physical flux $f(u) = a\\,u$, is monotone, and reproduces the correct upwind selection: if $a > 0$, then $|a| = a$ and $F_{i+1/2}^{n} = a\\,\\bar{u}_{i}^{n}$; if $a  0$, then $|a| = -a$ and $F_{i+1/2}^{n} = a\\,\\bar{u}_{i+1}^{n}$. Thus, the required finite volume update is\n\n$$\n\\bar{u}_{i}^{n+1} = \\bar{u}_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right),\n$$\n\nwith the upwind numerical flux at interface $x_{i+1/2}$ given by the closed-form expression derived above.",
            "answer": "$$\\boxed{\\frac{1}{2}\\left[a\\left(\\bar{u}_{i}^{n} + \\bar{u}_{i+1}^{n}\\right) - |a|\\left(\\bar{u}_{i+1}^{n} - \\bar{u}_{i}^{n}\\right)\\right]}$$"
        },
        {
            "introduction": "While linear advection provides a clean starting point, many geophysical flows are inherently nonlinear, leading to complex phenomena like shock waves. This exercise transitions to the nonlinear realm using the inviscid Burgers' equation, a fundamental model for nonlinear advection and shock formation . You will solve a local Riemann problem to determine the wave structure and compute the corresponding Godunov flux, which represents the physically correct flux at a cell interface.",
            "id": "3612032",
            "problem": "Consider the one-dimensional inviscid Burgers equation, a canonical nonlinear conservation law used to model advective transport in computational geophysics,\n$$\nu_{t} + f(u)_{x} = 0,\n$$\nwhere the flux function is\n$$\nf(u) = \\frac{u^{2}}{2}.\n$$\nIn a Finite Volume Method (FVM), the interface numerical flux in the Godunov method is defined by evaluating the physical flux at the state selected by the exact self-similar Riemann solution at the interface, i.e., at $x/t = 0$. For the Riemann problem with initial data\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x  0, \\\\\nu_{R},  x > 0,\n\\end{cases}\n$$\nlet $u_{L} = 2$ and $u_{R} = 0$. Using only the fundamental laws of conservation, the definition of shock speed from the Rankineâ€“Hugoniot condition, and the entropy admissibility condition for nonlinear waves in strictly convex fluxes, determine the exact wave type and compute the corresponding Godunov numerical flux\n$$\nF(u_{L},u_{R})\n$$\nat the interface. Report only the value of $F(u_{L},u_{R})$ as your final answer, expressed as a real number with no units and no rounding.",
            "solution": "The problem asks for the Godunov numerical flux $F(u_{L}, u_{R})$ for the inviscid Burgers' equation, which is a nonlinear conservation law of the form $u_{t} + (f(u))_{x} = 0$ with the flux function $f(u) = \\frac{u^{2}}{2}$. The initial data is a Riemann problem with $u_{L} = 2$ and $u_{R} = 0$.\n\nFirst, we analyze the properties of the flux function. The flux $f(u) = \\frac{u^{2}}{2}$ is strictly convex, as its second derivative is $f''(u) = 1 > 0$ for all $u$. The characteristic speed of propagation for information is given by $a(u) = f'(u) = u$.\n\nThe solution to a Riemann problem depends on the relationship between the characteristic speeds of the left and right states, $a(u_{L})$ and $a(u_{R})$.\nFor the given states $u_{L}=2$ and $u_{R}=0$:\n-   The characteristic speed on the left is $a(u_{L}) = u_{L} = 2$.\n-   The characteristic speed on the right is $a(u_{R}) = u_{R} = 0$.\n\nSince $a(u_{L}) > a(u_{R})$ (specifically, $2 > 0$), the characteristics are converging. This indicates that the solution will involve a discontinuity, i.e., a shock wave. The solution is not a smooth rarefaction wave, which would occur if $a(u_{L})  a(u_{R})$.\n\nThe speed of this shock wave, denoted by $s$, is determined by the Rankine-Hugoniot condition, which expresses the conservation law across the discontinuity:\n$$\ns = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}\n$$\nSubstituting the given values and the flux function:\n$$\ns = \\frac{f(0) - f(2)}{0 - 2} = \\frac{\\frac{0^{2}}{2} - \\frac{2^{2}}{2}}{-2} = \\frac{0 - 2}{-2} = 1\n$$\nThe speed of the shock wave is $s=1$.\n\nFor a shock wave to be physically admissible, it must satisfy the entropy condition. For a strictly convex flux, this is the Lax entropy condition, which states that characteristics must enter the shock from both sides:\n$$\na(u_{L}) > s > a(u_{R})\n$$\nSubstituting the values we have:\n$$\nu_{L} > s > u_{R}\n$$\n$$\n2 > 1 > 0\n$$\nThe condition is satisfied. Thus, the solution to the Riemann problem is a single, stable shock wave propagating with speed $s=1$.\n\nThe solution of the Riemann problem, $u(x,t)$, is a function of the self-similar variable $\\xi = x/t$. For a single shock wave, the solution is piecewise constant:\n$$\nu(x,t) = u(\\xi) = \\begin{cases} u_{L}  \\text{if } \\xi  s \\\\ u_{R}  \\text{if } \\xi > s \\end{cases}\n$$\nSubstituting our values for $u_L$, $u_R$, and $s$:\n$$\nu(x,t) = u(x/t) = \\begin{cases} 2  \\text{if } x/t  1 \\\\ 0  \\text{if } x/t > 1 \\end{cases}\n$$\nThe Godunov numerical flux, $F(u_{L}, u_{R})$, is defined as the value of the physical flux at the state found at the cell interface, which corresponds to the location $x = 0$. In the self-similar plane, this is the line $\\xi = x/t = 0$.\n\nWe must determine the state $u$ at $\\xi = 0$. From the solution structure above, since $0  1$, the value of $\\xi = 0$ falls in the region where $\\xi  s$. Therefore, the state at the interface is $u(x/t = 0) = u_{L} = 2$.\n\nThe Godunov numerical flux is then the physical flux evaluated at this state:\n$$\nF(u_{L}, u_{R}) = f(u(x/t=0)) = f(u_{L}) = f(2)\n$$\nUsing the definition of the flux function, we compute the final value:\n$$\nF(u_{L}, u_{R}) = \\frac{2^{2}}{2} = \\frac{4}{2} = 2\n$$\nThus, the Godunov numerical flux for the given Riemann problem is $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "First-order schemes like the upwind or Godunov methods are robust but often introduce excessive numerical diffusion, smearing out sharp features in the solution. To achieve higher accuracy, we can use higher-order reconstructions within each cell, a concept central to MUSCL-type schemes . This practice provides a concrete comparison of several common slope limiters, allowing you to quantify their behavior and understand the trade-off between suppressing oscillations and minimizing numerical diffusion.",
            "id": "3611977",
            "problem": "Consider the one-dimensional linear advection of a passive scalar concentration in a sediment-laden flow, modeled by the conservation law $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$. A finite volume scheme on a uniform grid of spacing $\\Delta x$ advances the cell average $\\bar{u}_{i}$ via interface numerical fluxes $F_{i\\pm 1/2}$, which are constructed from a piecewise linear reconstruction in each cell. In the Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) framework, the reconstruction in cell $i$ uses a limited slope $s_{i}$ to define the left state at the right interface, $u_{i+1/2}^{-} = \\bar{u}_{i} + \\frac{1}{2}s_{i}$, which is then supplied to an upwind flux for $a>0$. To enforce Total Variation Diminishing (TVD) behavior, $s_{i}$ is obtained by applying a limiter to the one-sided differences $\\Delta_{i-1/2} = \\bar{u}_{i} - \\bar{u}_{i-1}$ and $\\Delta_{i+1/2} = \\bar{u}_{i+1} - \\bar{u}_{i}$.\n\nYou are given the cell averages $\\{\\bar{u}_{i-1},\\,\\bar{u}_{i},\\,\\bar{u}_{i+1}\\} = \\{1.0,\\,1.2,\\,1.5\\}$. Using the standard definitions of the minmod, Superbee, and Monotonized Central (MC) limiters, compute the limited slope $s_{i}$ in cell $i$ for each limiter. Then, define the dimensionless numerical dissipation index\n$$I = 1 - \\frac{s_{i}}{\\Delta_{i+1/2}},$$\nwhich quantifies the fraction of the unlimited forward difference $\\Delta_{i+1/2}$ removed by limiting. Evaluate $I$ for the minmod, MC, and Superbee limiters in this cell, and report the three values in the order (minmod, MC, Superbee) as a single row matrix. No rounding is necessary; express the final values as exact fractions. The answer is dimensionless and should be given without units.",
            "solution": "The problem is scientifically and mathematically well-posed, providing sufficient information to determine the requested quantities. We are tasked with computing the dimensionless numerical dissipation index, $I$, for three standard Total Variation Diminishing (TVD) limiters used in the Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) framework.\n\nThe limited slope in cell $i$, denoted by $s_i$, is constructed from the backward difference $\\Delta_{i-1/2}$ and the forward difference $\\Delta_{i+1/2}$. These are defined as:\n$$ \\Delta_{i-1/2} = \\bar{u}_{i} - \\bar{u}_{i-1} $$\n$$ \\Delta_{i+1/2} = \\bar{u}_{i+1} - \\bar{u}_{i} $$\nwhere $\\bar{u}_{i-1}$, $\\bar{u}_{i}$, and $\\bar{u}_{i+1}$ are the cell-averaged concentrations.\n\nWe are given the cell averages $\\{\\bar{u}_{i-1},\\,\\bar{u}_{i},\\,\\bar{u}_{i+1}\\} = \\{1.0,\\,1.2,\\,1.5\\}$.\nFirst, we compute the one-sided differences:\n$$ \\Delta_{i-1/2} = 1.2 - 1.0 = 0.2 $$\n$$ \\Delta_{i+1/2} = 1.5 - 1.2 = 0.3 $$\nSince both differences are positive, the local data is monotonic, and we are not near an extremum.\n\nThe limited slope $s_i$ is a function of these two differences. The dimensionless numerical dissipation index is defined as:\n$$ I = 1 - \\frac{s_{i}}{\\Delta_{i+1/2}} $$\nWe will now compute the slope $s_i$ and the index $I$ for each of the three specified limiters.\n\n1.  **Minmod Limiter**\n    The minmod limiter is defined as:\n    $$ \\text{minmod}(a, b) = \\begin{cases} \\min(a, b)  \\text{if } a > 0, b > 0 \\\\ \\max(a, b)  \\text{if } a  0, b  0 \\\\ 0  \\text{if } ab \\le 0 \\end{cases} $$\n    The limited slope is $s_{i}^{\\text{minmod}} = \\text{minmod}(\\Delta_{i-1/2}, \\Delta_{i+1/2})$.\n    With $\\Delta_{i-1/2} = 0.2$ and $\\Delta_{i+1/2} = 0.3$, both of which are positive, we have:\n    $$ s_{i}^{\\text{minmod}} = \\min(0.2, 0.3) = 0.2 $$\n    The dissipation index for the minmod limiter is:\n    $$ I_{\\text{minmod}} = 1 - \\frac{s_{i}^{\\text{minmod}}}{\\Delta_{i+1/2}} = 1 - \\frac{0.2}{0.3} = 1 - \\frac{2}{3} = \\frac{1}{3} $$\n\n2.  **Monotonized Central (MC) Limiter**\n    The Monotonized Central (or van Leer) limiter is defined for our slope calculation as:\n    $$ s_{i}^{\\text{MC}} = \\text{minmod}(2\\Delta_{i-1/2}, \\frac{1}{2}(\\Delta_{i-1/2} + \\Delta_{i+1/2}), 2\\Delta_{i+1/2}) $$\n    Since all arguments will be positive, the minmod function reduces to taking the minimum of its arguments.\n    The arguments are:\n    $2\\Delta_{i-1/2} = 2 \\times 0.2 = 0.4$\n    $\\frac{1}{2}(\\Delta_{i-1/2} + \\Delta_{i+1/2}) = \\frac{1}{2}(0.2 + 0.3) = \\frac{0.5}{2} = 0.25$\n    $2\\Delta_{i+1/2} = 2 \\times 0.3 = 0.6$\n    The limited slope is the minimum of these values:\n    $$ s_{i}^{\\text{MC}} = \\min(0.4, 0.25, 0.6) = 0.25 $$\n    The dissipation index for the MC limiter is:\n    $$ I_{\\text{MC}} = 1 - \\frac{s_{i}^{\\text{MC}}}{\\Delta_{i+1/2}} = 1 - \\frac{0.25}{0.3} = 1 - \\frac{25}{30} = 1 - \\frac{5}{6} = \\frac{1}{6} $$\n\n3.  **Superbee Limiter**\n    The Superbee limiter is defined as:\n    $$ s_{i}^{\\text{Superbee}} = \\max(\\text{minmod}(2\\Delta_{i-1/2}, \\Delta_{i+1/2}), \\text{minmod}(\\Delta_{i-1/2}, 2\\Delta_{i+1/2})) $$\n    Since all arguments are positive, this simplifies to:\n    $$ s_{i}^{\\text{Superbee}} = \\max(\\min(2\\Delta_{i-1/2}, \\Delta_{i+1/2}), \\min(\\Delta_{i-1/2}, 2\\Delta_{i+1/2})) $$\n    We compute the inner terms:\n    $\\min(2\\Delta_{i-1/2}, \\Delta_{i+1/2}) = \\min(2 \\times 0.2, 0.3) = \\min(0.4, 0.3) = 0.3$\n    $\\min(\\Delta_{i-1/2}, 2\\Delta_{i+1/2}) = \\min(0.2, 2 \\times 0.3) = \\min(0.2, 0.6) = 0.2$\n    The limited slope is the maximum of these two results:\n    $$ s_{i}^{\\text{Superbee}} = \\max(0.3, 0.2) = 0.3 $$\n    The dissipation index for the Superbee limiter is:\n    $$ I_{\\text{Superbee}} = 1 - \\frac{s_{i}^{\\text{Superbee}}}{\\Delta_{i+1/2}} = 1 - \\frac{0.3}{0.3} = 1 - 1 = 0 $$\n\nThe values of the dissipation index $I$ for the minmod, MC, and Superbee limiters are $\\frac{1}{3}$, $\\frac{1}{6}$, and $0$, respectively. The problem requests these values reported as a single row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3}  \\frac{1}{6}  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}