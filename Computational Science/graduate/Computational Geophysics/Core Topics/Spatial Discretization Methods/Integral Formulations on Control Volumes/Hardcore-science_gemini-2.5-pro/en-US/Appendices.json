{
    "hands_on_practices": [
        {
            "introduction": "This first practice explores the power of integral formulations in continuum mechanics. By applying the divergence theorem to the integral momentum balance for a Stokes flow, we can relate the net surface traction on a control volume to the body forces acting within it. This exercise demonstrates a fundamental principle of force equilibrium in a fluid and provides a method to calculate net forces without resolving the detailed stress distribution on every face. ",
            "id": "3604912",
            "problem": "Consider an incompressible Stokes flow of a viscous brine of constant density $\\rho$ and dynamic viscosity $\\mu$ over a rigid, impermeable planar boundary located at $z=0$. The flow occupies the half-space $z>0$. A rectangular Control Volume (CV) $V$ is adjacent to the boundary, defined by $0 \\leq x \\leq L_{x}$, $0 \\leq y \\leq L_{y}$, and $0 \\leq z \\leq L_{z}$, with its bottom face coincident with the boundary at $z=0$. The local velocity field near the boundary is measured to be linear in $z$ with components $u_{x}(x,y,z)=\\alpha z$ and $u_{y}(x,y,z)=\\beta z$, and $u_{z}(x,y,z)=0$, where $\\alpha$ and $\\beta$ are constants. The fluid is subject to a uniform gravitational body force $\\mathbf{f}=-\\rho g\\,\\mathbf{k}$, where $g$ is the gravitational acceleration and $\\mathbf{k}$ is the unit vector in the positive $z$-direction.\n\nUsing an integral formulation on the control volume and first principles appropriate for incompressible Stokes flow, compute the net traction vector $\\displaystyle \\int_{\\partial V}\\boldsymbol{\\sigma}\\cdot\\mathbf{n}\\,dS$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\mathbf{n}$ is the outward unit normal on $\\partial V$. The parameters are\n$$\\rho=1020\\ \\text{kg m}^{-3},\\quad \\mu=1.5\\ \\text{Pa s},\\quad g=9.81\\ \\text{m s}^{-2},\\quad L_{x}=0.50\\ \\text{m},\\quad L_{y}=0.30\\ \\text{m},\\quad L_{z}=0.020\\ \\text{m},\\quad \\alpha=0.20\\ \\text{s}^{-1},\\quad \\beta=-0.10\\ \\text{s}^{-1}.$$\nExpress your final answer as a $1\\times 3$ row vector in Newtons and round each component to four significant figures.",
            "solution": "The problem asks for the computation of the net traction vector, which is the integral of the traction vector $\\mathbf{t} = \\boldsymbol{\\sigma}\\cdot\\mathbf{n}$ over the entire closed surface $\\partial V$ of a control volume $V$. The net traction vector $\\mathbf{T}_{\\text{net}}$ is given by the surface integral:\n$$ \\mathbf{T}_{\\text{net}} = \\oint_{\\partial V} \\boldsymbol{\\sigma}\\cdot\\mathbf{n}\\,dS $$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\mathbf{n}$ is the outward unit normal vector on the boundary $\\partial V$.\n\nThe Divergence Theorem relates a surface integral of a vector field (or a tensor field contracted with the normal vector) over a closed surface to the volume integral of the divergence of that field over the volume enclosed by the surface. Applying the theorem to the expression for $\\mathbf{T}_{\\text{net}}$ yields:\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} (\\nabla \\cdot \\boldsymbol{\\sigma})\\,dV $$\n\nThe problem statement specifies that the fluid is undergoing an incompressible Stokes flow. The governing equation for conservation of momentum in this regime is the Stokes equation, which represents a balance between surface forces and body forces, as inertial forces are negligible. The differential form of this momentum balance is:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0} $$\nwhere $\\mathbf{f}$ is the body force per unit volume.\n\nBefore proceeding, we verify that the given velocity field $\\mathbf{u}(x,y,z) = (\\alpha z, \\beta z, 0)$ is consistent with the assumptions.\nFirst, for an incompressible flow, the continuity equation requires the divergence of the velocity field to be zero:\n$$ \\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} + \\frac{\\partial u_z}{\\partial z} = \\frac{\\partial(\\alpha z)}{\\partial x} + \\frac{\\partial(\\beta z)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0 + 0 + 0 = 0 $$\nThe velocity field is indeed divergence-free and thus satisfies the incompressibility condition.\n\nSecond, the Stokes flow approximation is valid when the inertial terms in the Navier-Stokes equations are negligible. The full steady-state momentum equation is $\\rho (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f}$. For the given velocity field, the advective acceleration term is:\n$$ (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = u_x \\frac{\\partial \\mathbf{u}}{\\partial x} + u_y \\frac{\\partial \\mathbf{u}}{\\partial y} + u_z \\frac{\\partial \\mathbf{u}}{\\partial z} $$\nSince $\\mathbf{u}$ is only a function of $z$, the derivatives with respect to $x$ and $y$ are zero: $\\frac{\\partial \\mathbf{u}}{\\partial x} = \\mathbf{0}$ and $\\frac{\\partial \\mathbf{u}}{\\partial y} = \\mathbf{0}$. Furthermore, the $z$-component of velocity, $u_z$, is zero. Therefore, the expression simplifies to:\n$$ (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = (\\alpha z)( \\mathbf{0}) + (\\beta z)(\\mathbf{0}) + (0) \\frac{\\partial \\mathbf{u}}{\\partial z} = \\mathbf{0} $$\nThe inertial term is identically zero for this velocity field, which means the Stokes equation $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0}$ is an exact description of the momentum balance, not an approximation.\n\nFrom the Stokes equation, we can express the divergence of the stress tensor as:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} = -\\mathbf{f} $$\nSubstituting this into the volume integral for $\\mathbf{T}_{\\text{net}}$:\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} (-\\mathbf{f})\\,dV $$\n\nThe problem states that the fluid is subject to a uniform gravitational body force $\\mathbf{f} = -\\rho g \\mathbf{k}$, where $\\rho$ is the constant density, $g$ is the gravitational acceleration, and $\\mathbf{k}$ is the unit vector in the positive $z$-direction. Substituting this expression for $\\mathbf{f}$:\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} -(-\\rho g \\mathbf{k})\\,dV = \\int_{V} \\rho g \\mathbf{k}\\,dV $$\n\nSince $\\rho$, $g$, and $\\mathbf{k}$ are all constants, they can be factored out of the integral:\n$$ \\mathbf{T}_{\\text{net}} = \\rho g \\mathbf{k} \\int_{V} dV $$\nThe integral $\\int_V dV$ is the volume of the control volume $V$. The control volume is a rectangular prism with dimensions $L_x$, $L_y$, and $L_z$. Its volume is:\n$$ \\text{Volume}(V) = L_x L_y L_z $$\nThus, the net traction vector is:\n$$ \\mathbf{T}_{\\text{net}} = \\rho g (L_x L_y L_z) \\mathbf{k} $$\n\nThis result indicates that the net traction is a vector pointing purely in the positive $z$-direction. Its magnitude is equal to the weight of the fluid contained within the control volume. This is a statement of Archimedes' principle in the context of continuum mechanics: the net force exerted by the surrounding fluid on the fluid within the control volume perfectly balances the body force (gravity) acting on it, as required for a body in static or non-accelerating equilibrium. The parameters describing the shearing of the flow, $\\mu$, $\\alpha$, and $\\beta$, determine the distribution of traction forces on the individual faces of the control volume, but they do not affect the net traction over the entire closed surface.\n\nWe now substitute the given numerical values to compute the final answer.\n$\\rho = 1020\\ \\text{kg m}^{-3}$\n$g = 9.81\\ \\text{m s}^{-2}$\n$L_x = 0.50\\ \\text{m}$\n$L_y = 0.30\\ \\text{m}$\n$L_z = 0.020\\ \\text{m}$\n\nThe components of the net traction vector $\\mathbf{T}_{\\text{net}} = (T_x, T_y, T_z)$ are:\n$T_x = 0\\ \\text{N}$\n$T_y = 0\\ \\text{N}$\n$T_z = \\rho g L_x L_y L_z = (1020)(9.81)(0.50)(0.30)(0.020)$\n$T_z = (1020)(9.81)(0.0030) = 30.0186\\ \\text{N}$\n\nThe problem requires rounding each component to four significant figures.\n$T_x = 0.000$\n$T_y = 0.000$\n$T_z = 30.02$\n\nThe net traction vector is $(0, 0, 30.02)$ in Newtons.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 30.02\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from continuous principles to numerical implementation, this exercise tasks you with building a core component of the finite volume method. You will discretize the integral conservation law for a passive scalar and implement the first-order upwind scheme to approximate the advective flux across control volume faces. This practical coding problem is fundamental to developing models for transport phenomena, such as the movement of contaminants in groundwater or heat in the Earth's mantle. ",
            "id": "3604928",
            "problem": "Consider a passive scalar concentration field $c(\\mathbf{x},t)$ transported by an Eulerian velocity field $\\mathbf{u}(\\mathbf{x},t)$ without sources or sinks. The scalar conservation law on a fixed control volume $V$ with boundary $\\partial V$ is, in integral form, that the rate of change of the total scalar content equals the negative of the net advective outflow through the boundary. You are to work with an axis-aligned rectangular control volume $V$ of edge lengths $L_x$, $L_y$, and $L_z$, with outward unit normals on the faces $\\{\\pm \\hat{\\mathbf{x}}, \\pm \\hat{\\mathbf{y}}, \\pm \\hat{\\mathbf{z}}\\}$.\n\nStarting from the fundamental integral conservation law and the Divergence Theorem, derive the expression for the advective contribution to the rate of change of $\\int_V c\\,dV$ as a surface integral involving $\\mathbf{u}c \\cdot \\mathbf{n}$ over $\\partial V$, and then specialize it to a discrete face-summed form appropriate for a single rectangular control volume with face-averaged data. Adopt the following modeling assumptions and definitions for the discrete approximation:\n- On each face $f$ of $\\partial V$, you are given:\n  - The face-normal velocity average $u_{n,f}$, defined as the average of $\\mathbf{u}\\cdot\\mathbf{n}_f$ over the face (with $\\mathbf{n}_f$ the outward unit normal of that face), in meters per second.\n  - An inflow concentration $c_{\\text{in},f}$, defined as the average of $c$ just outside the face and used only when the face flow is into $V$.\n- Use the first-order upwind approximation for the face concentration: for each face $f$, if $u_{n,f} \\ge 0$, take the donor concentration on the upwind side to be the cell-average $c_V$; if $u_{n,f} < 0$, take the donor concentration to be the prescribed inflow concentration $c_{\\text{in},f}$; and if $u_{n,f} = 0$, the face contributes zero flux.\n- The face areas are $A_{+x} = A_{-x} = L_y L_z$, $A_{+y} = A_{-y} = L_x L_z$, and $A_{+z} = A_{-z} = L_x L_y$.\n- The advective contribution to the rate of change of the total scalar in $V$ is the negative of the net advective flux summed over the faces of $\\partial V$.\n\nPhysical units:\n- Lengths $L_x$, $L_y$, $L_z$ must be in meters.\n- Velocity components $u_{n,f}$ must be in meters per second.\n- Concentrations $c_V$ and $c_{\\text{in},f}$ must be in kilograms per cubic meter.\n- The requested output, the advective contribution to $\\frac{d}{dt}\\int_V c\\,dV$, must be expressed in kilograms per second, rounded to six decimal places.\n\nYour task is to implement a program that, for each test case below, computes the advective contribution to the rate of change of $\\int_V c\\,dV$ under the upwind approximation described above.\n\nTest suite (each case is a complete, independent set of parameters):\n- Case $1$:\n  - $L_x = 2.0$ meters, $L_y = 1.0$ meters, $L_z = 1.5$ meters.\n  - $c_V = 3.0$ kilograms per cubic meter.\n  - Face-normal velocities (meters per second): $u_{n,+x} = 0.2$, $u_{n,-x} = -0.1$, $u_{n,+y} = -0.05$, $u_{n,-y} = 0.10$, $u_{n,+z} = 0.0$, $u_{n,-z} = -0.2$.\n  - Inflow concentrations (kilograms per cubic meter): $c_{\\text{in},+x} = 1.0$, $c_{\\text{in},-x} = 4.0$, $c_{\\text{in},+y} = 2.5$, $c_{\\text{in},-y} = 1.0$, $c_{\\text{in},+z} = 3.0$, $c_{\\text{in},-z} = 3.5$.\n- Case $2$:\n  - $L_x = 1.0$ meters, $L_y = 1.0$ meters, $L_z = 1.0$ meters.\n  - $c_V = 1.0$ kilograms per cubic meter.\n  - Face-normal velocities (meters per second): $u_{n,+x} = 0.0$, $u_{n,-x} = 0.0$, $u_{n,+y} = 0.0$, $u_{n,-y} = 0.0$, $u_{n,+z} = 0.0$, $u_{n,-z} = 0.0$.\n  - Inflow concentrations (kilograms per cubic meter): $c_{\\text{in},+x} = 1.0$, $c_{\\text{in},-x} = 1.0$, $c_{\\text{in},+y} = 1.0$, $c_{\\text{in},-y} = 1.0$, $c_{\\text{in},+z} = 1.0$, $c_{\\text{in},-z} = 1.0$.\n- Case $3$:\n  - $L_x = 1.5$ meters, $L_y = 1.0$ meters, $L_z = 2.0$ meters.\n  - $c_V = 3.2$ kilograms per cubic meter.\n  - Face-normal velocities (meters per second): $u_{n,+x} = 0.1$, $u_{n,-x} = -0.1$, $u_{n,+y} = 0.05$, $u_{n,-y} = -0.05$, $u_{n,+z} = 0.0$, $u_{n,-z} = 0.0$.\n  - Inflow concentrations (kilograms per cubic meter): $c_{\\text{in},+x} = 3.2$, $c_{\\text{in},-x} = 3.2$, $c_{\\text{in},+y} = 3.2$, $c_{\\text{in},-y} = 3.2$, $c_{\\text{in},+z} = 3.2$, $c_{\\text{in},-z} = 3.2$.\n- Case $4$:\n  - $L_x = 3.0$ meters, $L_y = 2.0$ meters, $L_z = 1.0$ meters.\n  - $c_V = 5.0$ kilograms per cubic meter.\n  - Face-normal velocities (meters per second): $u_{n,+x} = 0.0$, $u_{n,-x} = -1.0$, $u_{n,+y} = 0.2$, $u_{n,-y} = 0.0$, $u_{n,+z} = 0.1$, $u_{n,-z} = 0.0$.\n  - Inflow concentrations (kilograms per cubic meter): $c_{\\text{in},+x} = 5.0$, $c_{\\text{in},-x} = 0.5$, $c_{\\text{in},+y} = 5.0$, $c_{\\text{in},-y} = 5.0$, $c_{\\text{in},+z} = 5.0$, $c_{\\text{in},-z} = 5.0$.\n\nYour program should produce a single line of output containing the results for Cases $1$ through $4$ as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places in kilograms per second, for example, $[r_1,r_2,r_3,r_4]$ where each $r_i$ is a floating-point number with exactly six digits after the decimal point.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of mass conservation, is mathematically well-posed, and is defined with objective, unambiguous parameters.\n\nThe fundamental principle governing the transport of a passive scalar with concentration $c(\\mathbf{x}, t)$ by a velocity field $\\mathbf{u}(\\mathbf{x}, t)$ in a fixed control volume $V$, without internal sources or sinks, is the integral form of the conservation law. This law states that the time rate of change of the total amount of the scalar within $V$ is equal to the negative of the net advective flux of the scalar across the boundary surface $\\partial V$. Mathematically, this is expressed as:\n$$\n\\frac{d}{dt} \\int_V c \\, dV = - \\oint_{\\partial V} (c\\mathbf{u}) \\cdot \\mathbf{n} \\, dA\n$$\nHere, $\\mathbf{n}$ is the outward-pointing unit normal vector on the surface element $dA$. The term $c\\mathbf{u}$ represents the advective flux vector, and its dot product with $\\mathbf{n}$ gives the component of the flux perpendicular to the boundary.\n\nFor a discrete numerical method, the continuous surface integral over $\\partial V$ is approximated by a sum of fluxes over the discrete faces that constitute the boundary. The given control volume is a rectangular prism, so its boundary $\\partial V$ consists of six faces, which we denote by an index $f$. These faces correspond to the constant coordinate planes at the boundaries of the cell, labeled $\\{+x, -x, +y, -y, +z, -z\\}$. The surface integral is thus discretized as:\n$$\n\\oint_{\\partial V} (c\\mathbf{u}) \\cdot \\mathbf{n} \\, dA \\approx \\sum_{f \\in \\partial V} \\text{Flux}_f\n$$\nThe flux through a single face $f$ is approximated by assuming the relevant quantities are constant over the face area $A_f$. The flux through face $f$ is then given by:\n$$\n\\text{Flux}_f = \\int_{A_f} (c\\mathbf{u}) \\cdot \\mathbf{n}_f \\, dA \\approx (c_f u_{n,f}) A_f\n$$\nHere, $u_{n,f}$ is the face-averaged normal velocity component $(\\mathbf{u} \\cdot \\mathbf{n}_f)_f$, and $c_f$ is the representative scalar concentration at the face.\n\nThe problem specifies a first-order upwind scheme to determine the value of $c_f$. This scheme is based on the principle that the fluid crossing a face carries the concentration from the \"upwind\" or \"donor\" side.\n- If the flow is outwards ($u_{n,f} \\ge 0$), the fluid originates from inside the control volume. The concentration at the face is thus taken to be the average concentration within the volume, $c_V$.\n- If the flow is inwards ($u_{n,f} < 0$), the fluid originates from outside the control volume. The concentration at the face is taken to be the prescribed inflow concentration from the adjacent region, $c_{\\text{in},f}$.\n\nCombining these rules, the concentration on face $f$, $c_f$, is determined as:\n$$\nc_f =\n\\begin{cases}\nc_V & \\text{if } u_{n,f} \\ge 0 \\\\\nc_{\\text{in},f} & \\text{if } u_{n,f} < 0\n\\end{cases}\n$$\nThe net advective outflow is the sum of the fluxes over all six faces:\n$$\n\\text{Net Outflow} = \\sum_{f \\in \\partial V} c_f u_{n,f} A_f\n$$\nThe problem asks for the advective contribution to the rate of change of the total scalar in $V$, which is the negative of the net advective outflow:\n$$\n\\frac{d}{dt} \\int_V c \\, dV \\bigg|_{\\text{advection}} = - \\sum_{f \\in \\{+x, -x, +y, -y, +z, -z\\}} c_f u_{n,f} A_f\n$$\nThe face areas $A_f$ are given by the geometry of the rectangular control volume with side lengths $L_x$, $L_y$, and $L_z$:\n- $A_{\\pm x} = L_y L_z$\n- $A_{\\pm y} = L_x L_z$\n- $A_{\\pm z} = L_x L_y$\n\nTo compute the final value for each test case, we substitute the given values for $L_x, L_y, L_z, c_V$, and the face-specific values for $u_{n,f}$ and $c_{\\text{in},f}$ into this discrete formula. The units are consistent: the concentration $c$ is in $\\text{kg} \\cdot \\text{m}^{-3}$, velocity $u$ is in $\\text{m} \\cdot \\text{s}^{-1}$, and area $A$ is in $\\text{m}^2$. The resulting flux term $c u A$ has units of $\\text{kg} \\cdot \\text{s}^{-1}$, which is the correct unit for a rate of change of total mass.\n\nThe calculation proceeds as follows:\n$1$. For each of the six faces, determine the direction of flow from the sign of $u_{n,f}$.\n$2$. Select the appropriate concentration $c_f$ ($c_V$ for outflow, $c_{\\text{in},f}$ for inflow).\n$3$. Calculate the mass flux $\\Phi_f = c_f u_{n,f} A_f$ for each face.\n$4$. Sum the fluxes from all six faces to get the total net outflow, $\\sum \\Phi_f$.\n$5$. The final result is the negative of this sum, $-\\sum \\Phi_f$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the scalar transport problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"L\": (2.0, 1.0, 1.5),\n            \"c_V\": 3.0,\n            \"u_n\": {'+x': 0.2, '-x': -0.1, '+y': -0.05, '-y': 0.10, '+z': 0.0, '-z': -0.2},\n            \"c_in\": {'+x': 1.0, '-x': 4.0, '+y': 2.5, '-y': 1.0, '+z': 3.0, '-z': 3.5}\n        },\n        # Case 2\n        {\n            \"L\": (1.0, 1.0, 1.0),\n            \"c_V\": 1.0,\n            \"u_n\": {'+x': 0.0, '-x': 0.0, '+y': 0.0, '-y': 0.0, '+z': 0.0, '-z': 0.0},\n            \"c_in\": {'+x': 1.0, '-x': 1.0, '+y': 1.0, '-y': 1.0, '+z': 1.0, '-z': 1.0}\n        },\n        # Case 3\n        {\n            \"L\": (1.5, 1.0, 2.0),\n            \"c_V\": 3.2,\n            \"u_n\": {'+x': 0.1, '-x': -0.1, '+y': 0.05, '-y': -0.05, '+z': 0.0, '-z': 0.0},\n            \"c_in\": {'+x': 3.2, '-x': 3.2, '+y': 3.2, '-y': 3.2, '+z': 3.2, '-z': 3.2}\n        },\n        # Case 4\n        {\n            \"L\": (3.0, 2.0, 1.0),\n            \"c_V\": 5.0,\n            \"u_n\": {'+x': 0.0, '-x': -1.0, '+y': 0.2, '-y': 0.0, '+z': 0.1, '-z': 0.0},\n            \"c_in\": {'+x': 5.0, '-x': 0.5, '+y': 5.0, '-y': 5.0, '+z': 5.0, '-z': 5.0}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_rate_of_change(case)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_rate_of_change(case_data):\n    \"\"\"\n    Calculates the advective contribution to the rate of change of the total scalar\n    in a control volume using a first-order upwind scheme.\n    \"\"\"\n    Lx, Ly, Lz = case_data[\"L\"]\n    c_V = case_data[\"c_V\"]\n    u_n = case_data[\"u_n\"]\n    c_in = case_data[\"c_in\"]\n\n    # Define face areas\n    areas = {\n        '+x': Ly * Lz, '-x': Ly * Lz,\n        '+y': Lx * Lz, '-y': Lx * Lz,\n        '+z': Lx * Ly, '-z': Lx * Ly\n    }\n\n    faces = ['+x', '-x', '+y', '-y', '+z', '-z']\n    \n    total_net_outflow = 0.0\n    \n    for face in faces:\n        u_nf = u_n[face]\n        A_f = areas[face]\n        \n        # Apply the first-order upwind scheme to determine face concentration\n        if u_nf >= 0:\n            # Outflow: use the cell-average concentration\n            c_f = c_V\n        else:\n            # Inflow: use the prescribed inflow concentration\n            c_f = c_in[face]\n        \n        # Calculate flux through the face\n        flux = c_f * u_nf * A_f\n        total_net_outflow += flux\n            \n    # The rate of change is the negative of the net outflow\n    rate_of_change = -total_net_outflow\n    return rate_of_change\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice applies the integral conservation framework to a more complex, nonlinear problem common in geophysical fluid dynamics: two-phase flow in porous media. You will derive the speed of a saturation shock using the Rankine–Hugoniot condition, which is a direct consequence of the integral mass balance across a moving discontinuity. This exercise illustrates how integral formulations provide the essential tools for analyzing and modeling systems with sharp fronts or interfaces, such as in oil recovery or carbon sequestration. ",
            "id": "3604934",
            "problem": "Consider immiscible, incompressible two-phase flow of water and oil in a homogeneous one-dimensional porous medium along the spatial coordinate $x$, with constant porosity $\\phi$ and negligible capillary pressure and gravity. A control volume is the interval $[x_a, x_b]$. Let $S_w(x,t)$ denote the water saturation and $S_o(x,t) = 1 - S_w(x,t)$ the oil saturation. The total Darcy flux is $q_t$, and the individual phase fluxes are $q_w$ and $q_o$, with $q_t = q_w + q_o$. The absolute permeability $k$ is spatially uniform. The pressures of the phases are equal under the stated assumptions, so the same pressure gradient drives both phases. The water and oil viscosities are $\\mu_w$ and $\\mu_o$, respectively. The relative permeabilities are Corey-type functions of the water saturation, with residual saturations $S_{wr}$ and $S_{or}$, effective water saturation $S_{we} = (S_w - S_{wr})/(1 - S_{wr} - S_{or})$, and exponents $n_w$ and $n_o$:\n$$\nk_{rw}(S_w) = S_{we}^{n_w}, \\qquad k_{ro}(S_w) = (1 - S_{we})^{n_o}.\n$$\nYou may take the mobilities to be $\\lambda_w(S_w) = k \\, k_{rw}(S_w)/\\mu_w$ and $\\lambda_o(S_w) = k \\, k_{ro}(S_w)/\\mu_o$.\n\nStarting from the integral form of mass conservation for each phase over the control volume $[x_a, x_b]$ and Darcy’s law, derive the fractional flow function $f_w(S_w)$ as the ratio of the integral flux of water to the total integral flux. Then, using the integral Rankine–Hugoniot (R–H) condition for a conservation law across a moving saturation discontinuity, derive the shock speed formula across a discontinuity between left state $S_L$ and right state $S_R$ and compute the numerical value of the shock speed for the parameter set below.\n\nAssume the following parameter values, all constant in space and time:\n- Porosity $\\phi = 0.25$.\n- Total Darcy flux $q_t = 1.0 \\times 10^{-5} \\,\\mathrm{m/s}$.\n- Water viscosity $\\mu_w = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s}$.\n- Oil viscosity $\\mu_o = 5.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s}$.\n- Residual saturations $S_{wr} = 0.2$ and $S_{or} = 0.2$.\n- Corey exponents $n_w = 2$ and $n_o = 2$.\n- Left and right water saturations across the discontinuity are $S_L = 0.2$ and $S_R = 0.7$.\n\nYour tasks are:\n1. Using the integral fluxes over $[x_a, x_b]$, derive $f_w(S_w)$ in terms of $\\lambda_w(S_w)$ and $\\lambda_o(S_w)$ and then in terms of $S_w$, $\\mu_w$, $\\mu_o$, $S_{wr}$, $S_{or}$, $n_w$, and $n_o$.\n2. Use the integral Rankine–Hugoniot condition to express the shock speed $s$ in terms of $q_t$, $\\phi$, $S_L$, $S_R$, and $f_w(S)$, and compute its numerical value for the given parameters.\n\nExpress the final shock speed in $\\mathrm{m/s}$ and round your answer to four significant figures. The final answer must be a single number. Do not include units in the final boxed answer.",
            "solution": "We begin from the integral form of mass conservation for each phase over the fixed control volume $[x_a, x_b]$. For the water phase, conservation of mass reads\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{x_a}^{x_b} \\phi S_w(x,t) \\, \\mathrm{d}x \\;+\\; \\left[q_w(x_b,t) - q_w(x_a,t)\\right] \\;=\\; 0,\n$$\nand analogously for oil,\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{x_a}^{x_b} \\phi S_o(x,t) \\, \\mathrm{d}x \\;+\\; \\left[q_o(x_b,t) - q_o(x_a,t)\\right] \\;=\\; 0.\n$$\nSumming the two equations and using $S_o = 1 - S_w$ gives\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{x_a}^{x_b} \\phi \\, \\mathrm{d}x \\;+\\; \\left[q_t(x_b,t) - q_t(x_a,t)\\right] \\;=\\; 0,\n$$\nwhere $q_t = q_w + q_o$ is the total flux. With $\\phi$ constant and incompressible phases, the first term is zero, hence\n$$\nq_t(x_b,t) - q_t(x_a,t) = 0,\n$$\nwhich implies $q_t$ is spatially constant. In one dimension with negligible capillary pressure and gravity, Darcy’s law for each phase gives\n$$\nq_w = -k \\, \\frac{k_{rw}(S_w)}{\\mu_w} \\, \\frac{\\partial p}{\\partial x} \\;=\\; -\\lambda_w(S_w) \\, \\frac{\\partial p}{\\partial x},\n$$\n$$\nq_o = -k \\, \\frac{k_{ro}(S_w)}{\\mu_o} \\, \\frac{\\partial p}{\\partial x} \\;=\\; -\\lambda_o(S_w) \\, \\frac{\\partial p}{\\partial x},\n$$\nwith mobilities $\\lambda_w(S_w) = k \\, k_{rw}(S_w)/\\mu_w$ and $\\lambda_o(S_w) = k \\, k_{ro}(S_w)/\\mu_o$. The total flux is\n$$\nq_t \\;=\\; q_w + q_o \\;=\\; -\\left[\\lambda_w(S_w) + \\lambda_o(S_w)\\right] \\, \\frac{\\partial p}{\\partial x}.\n$$\nTherefore, the fractional flow of water, defined as the ratio of the water flux to the total flux,\n$$\nf_w(S_w) \\;=\\; \\frac{q_w}{q_t},\n$$\ncan be expressed using the mobilities as\n$$\nf_w(S_w) \\;=\\; \\frac{\\lambda_w(S_w)}{\\lambda_w(S_w) + \\lambda_o(S_w)}.\n$$\nUnder the Corey parameterization with residual saturations, the effective saturation is\n$$\nS_{we} \\;=\\; \\frac{S_w - S_{wr}}{1 - S_{wr} - S_{or}},\n$$\nand the relative permeabilities are\n$$\nk_{rw}(S_w) \\;=\\; S_{we}^{n_w}, \\qquad k_{ro}(S_w) \\;=\\; \\left(1 - S_{we}\\right)^{n_o}.\n$$\nConsequently, the mobilities become\n$$\n\\lambda_w(S_w) \\;=\\; k \\, \\frac{S_{we}^{n_w}}{\\mu_w}, \\qquad \\lambda_o(S_w) \\;=\\; k \\, \\frac{\\left(1 - S_{we}\\right)^{n_o}}{\\mu_o},\n$$\nand the fractional flow simplifies (the absolute permeability $k$ cancels) to\n$$\nf_w(S_w) \\;=\\; \\frac{\\dfrac{S_{we}^{n_w}}{\\mu_w}}{\\dfrac{S_{we}^{n_w}}{\\mu_w} + \\dfrac{\\left(1 - S_{we}\\right)^{n_o}}{\\mu_o}}.\n$$\n\nNext, we derive the shock speed from the integral Rankine–Hugoniot (R–H) condition. The water-phase conservation law in differential form is obtained by localizing the integral statement:\n$$\n\\phi \\, \\frac{\\partial S_w}{\\partial t} \\;+\\; \\frac{\\partial q_w}{\\partial x} \\;=\\; 0.\n$$\nSubstituting $q_w = f_w(S_w) \\, q_t$ and using that $q_t$ is constant in space and time under our assumptions, we have the conservative form\n$$\n\\phi \\, \\frac{\\partial S_w}{\\partial t} \\;+\\; \\frac{\\partial}{\\partial x} \\left[q_t \\, f_w(S_w)\\right] \\;=\\; 0.\n$$\nConsider a discontinuity (shock) moving with speed $s$ that separates a left state $S_L$ from a right state $S_R$. The integral R–H condition for a conservation law of the form $a \\, \\partial_t u + \\partial_x F(u) = 0$ yields the shock speed\n$$\ns \\;=\\; \\frac{F(u_R) - F(u_L)}{a \\, (u_R - u_L)}.\n$$\nHere, $u = S_w$, $a = \\phi$, and $F(S_w) = q_t \\, f_w(S_w)$, so\n$$\ns \\;=\\; \\frac{q_t \\, f_w(S_R) - q_t \\, f_w(S_L)}{\\phi \\, (S_R - S_L)} \\;=\\; \\frac{q_t}{\\phi} \\, \\frac{f_w(S_R) - f_w(S_L)}{S_R - S_L}.\n$$\n\nWe now compute $f_w(S_L)$ and $f_w(S_R)$ using the given parameters. The parameter values are\n$$\n\\phi = 0.25, \\quad q_t = 1.0 \\times 10^{-5} \\,\\mathrm{m/s}, \\quad \\mu_w = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s}, \\quad \\mu_o = 5.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s},\n$$\n$$\nS_{wr} = 0.2, \\quad S_{or} = 0.2, \\quad n_w = 2, \\quad n_o = 2, \\quad S_L = 0.2, \\quad S_R = 0.7.\n$$\nThe effective saturations are\n$$\nS_{we}(S_L) \\;=\\; \\frac{S_L - S_{wr}}{1 - S_{wr} - S_{or}} \\;=\\; \\frac{0.2 - 0.2}{1 - 0.2 - 0.2} \\;=\\; \\frac{0}{0.6} \\;=\\; 0,\n$$\n$$\nS_{we}(S_R) \\;=\\; \\frac{0.7 - 0.2}{1 - 0.2 - 0.2} \\;=\\; \\frac{0.5}{0.6} \\;=\\; \\frac{5}{6} \\;=\\; 0.833333\\ldots.\n$$\nThus,\n$$\nk_{rw}(S_L) = 0^{2} = 0, \\qquad k_{ro}(S_L) = (1 - 0)^{2} = 1,\n$$\n$$\nk_{rw}(S_R) = \\left(\\frac{5}{6}\\right)^{2} = \\frac{25}{36} \\approx 0.694444\\ldots, \\qquad k_{ro}(S_R) = \\left(1 - \\frac{5}{6}\\right)^{2} = \\left(\\frac{1}{6}\\right)^{2} = \\frac{1}{36} \\approx 0.027777\\ldots.\n$$\nThe mobilities (up to the common factor $k$ that cancels in $f_w$) are\n$$\n\\lambda_w(S_L) \\propto \\frac{k_{rw}(S_L)}{\\mu_w} = \\frac{0}{\\mu_w} = 0, \\qquad \\lambda_o(S_L) \\propto \\frac{k_{ro}(S_L)}{\\mu_o} = \\frac{1}{5.0 \\times 10^{-3}} = 200,\n$$\n$$\n\\lambda_w(S_R) \\propto \\frac{k_{rw}(S_R)}{\\mu_w} = \\frac{0.694444\\ldots}{1.0 \\times 10^{-3}} \\approx 694.444\\ldots, \\qquad \\lambda_o(S_R) \\propto \\frac{k_{ro}(S_R)}{\\mu_o} = \\frac{0.027777\\ldots}{5.0 \\times 10^{-3}} \\approx 5.555555\\ldots.\n$$\nTherefore,\n$$\nf_w(S_L) \\;=\\; \\frac{0}{0 + 200} \\;=\\; 0,\n$$\n$$\nf_w(S_R) \\;=\\; \\frac{694.444\\ldots}{694.444\\ldots + 5.555555\\ldots} \\;=\\; \\frac{694.444\\ldots}{700.000\\ldots} \\;=\\; 0.992063\\ldots.\n$$\nThe shock speed is\n$$\ns \\;=\\; \\frac{q_t \\left[f_w(S_R) - f_w(S_L)\\right]}{\\phi \\, (S_R - S_L)} \\;=\\; \\frac{\\left(1.0 \\times 10^{-5}\\right) \\times 0.992063\\ldots}{0.25 \\times (0.7 - 0.2)}.\n$$\nCompute the denominator:\n$$\n\\phi \\, (S_R - S_L) \\;=\\; 0.25 \\times 0.5 \\;=\\; 0.125.\n$$\nCompute the numerator:\n$$\nq_t \\left[f_w(S_R) - f_w(S_L)\\right] \\;=\\; 1.0 \\times 10^{-5} \\times 0.992063\\ldots \\;=\\; 9.9206349\\ldots \\times 10^{-6}.\n$$\nHence,\n$$\ns \\;=\\; \\frac{9.9206349\\ldots \\times 10^{-6}}{0.125} \\;=\\; 7.9365079\\ldots \\times 10^{-5}.\n$$\nRounding to four significant figures yields\n$$\ns \\;\\approx\\; 7.937 \\times 10^{-5}.\n$$\nPer the instructions, the final boxed answer should omit units; the speed is in $\\mathrm{m/s}$.",
            "answer": "$$\\boxed{7.937 \\times 10^{-5}}$$"
        }
    ]
}