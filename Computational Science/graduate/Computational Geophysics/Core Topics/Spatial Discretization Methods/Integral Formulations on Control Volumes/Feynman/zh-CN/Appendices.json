{
    "hands_on_practices": [
        {
            "introduction": "我们将从一个经典的连续介质力学问题开始，以展示积分公式的威力。这个练习的目标是计算作用在控制体积上的净牵引力，它展示了如何运用散度定理将复杂的表面应力积分转化为一个简单的体力体积积分。通过这个实践，你将加深对斯托克斯流（Stokes flow）中动量守恒的理解，即表面力与体力之间的基本平衡关系。",
            "id": "3604912",
            "problem": "考虑一种密度为 $\\rho$、动力粘度为 $\\mu$ 的恒定粘性盐水的不可压缩斯托克斯流，流经位于 $z=0$ 的刚性、不可渗透的平面边界。流体占据半空间 $z>0$。一个矩形控制体 (CV) $V$ 邻近该边界，其定义域为 $0 \\leq x \\leq L_{x}$，$0 \\leq y \\leq L_{y}$ 和 $0 \\leq z \\leq L_{z}$，其底面与位于 $z=0$ 的边界重合。测得边界附近的局部速度场关于 $z$ 是线性的，其分量为 $u_{x}(x,y,z)=\\alpha z$ 和 $u_{y}(x,y,z)=\\beta z$，以及 $u_{z}(x,y,z)=0$，其中 $\\alpha$ 和 $\\beta$ 为常数。流体受到均匀的重力体积力 $\\mathbf{f}=-\\rho g\\,\\mathbf{k}$ 的作用，其中 $g$ 是重力加速度，$\\mathbf{k}$ 是 $z$ 轴正方向的单位向量。\n\n使用适用于不可压缩斯托克斯流的控制体积分公式和基本原理，计算净牵引力矢量 $\\displaystyle \\oint_{\\partial V}\\boldsymbol{\\sigma}\\cdot\\mathbf{n}\\,dS$，其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\mathbf{n}$ 是 $\\partial V$ 上的外法向单位向量。参数如下：\n$$\\rho=1020\\ \\text{kg m}^{-3},\\quad \\mu=1.5\\ \\text{Pa s},\\quad g=9.81\\ \\text{m s}^{-2},\\quad L_{x}=0.50\\ \\text{m},\\quad L_{y}=0.30\\ \\text{m},\\quad L_{z}=0.020\\ \\text{m},\\quad \\alpha=0.20\\ \\text{s}^{-1},\\quad \\beta=-0.10\\ \\text{s}^{-1}.$$\n将最终答案表示为一个 $1\\times 3$ 的行向量，单位为牛顿，并将每个分量四舍五入到四位有效数字。",
            "solution": "该问题要求计算净牵引力矢量，即牵引力矢量 $\\mathbf{t} = \\boldsymbol{\\sigma}\\cdot\\mathbf{n}$ 在控制体 $V$ 的整个闭合曲面 $\\partial V$ 上的积分。净牵引力矢量 $\\mathbf{T}_{\\text{net}}$ 由以下曲面积分给出：\n$$ \\mathbf{T}_{\\text{net}} = \\oint_{\\partial V} \\boldsymbol{\\sigma}\\cdot\\mathbf{n}\\,dS $$\n其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\mathbf{n}$ 是边界 $\\partial V$ 上的外法向单位向量。\n\n散度定理将闭合曲面上矢量场（或与法向量缩并的张量场）的曲面积分与该场在曲面所围体积内的散度的体积分联系起来。将该定理应用于 $\\mathbf{T}_{\\text{net}}$ 的表达式，得到：\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} (\\nabla \\cdot \\boldsymbol{\\sigma})\\,dV $$\n\n问题陈述指明流体处于不可压缩斯托克斯流状态。在这种情况下，动量守恒的控制方程是斯托克斯方程，它表示表面力与体积力之间的平衡，因为惯性力可以忽略不计。这种动量平衡的微分形式是：\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0} $$\n其中 $\\mathbf{f}$ 是单位体积的体积力。\n\n在继续之前，我们验证给定的速度场 $\\mathbf{u}(x,y,z) = (\\alpha z, \\beta z, 0)$ 与假设是否一致。\n首先，对于不可压缩流，连续性方程要求速度场的散度为零：\n$$ \\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} + \\frac{\\partial u_z}{\\partial z} = \\frac{\\partial(\\alpha z)}{\\partial x} + \\frac{\\partial(\\beta z)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0 + 0 + 0 = 0 $$\n该速度场确实是无散的，因此满足不可压缩条件。\n\n其次，当纳维-斯托克斯方程中的惯性项可以忽略不计时，斯托克斯流近似是有效的。完整的稳态动量方程是 $\\rho (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f}$。对于给定的速度场，对流加速度项是：\n$$ (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = u_x \\frac{\\partial \\mathbf{u}}{\\partial x} + u_y \\frac{\\partial \\mathbf{u}}{\\partial y} + u_z \\frac{\\partial \\mathbf{u}}{\\partial z} $$\n由于 $\\mathbf{u}$ 仅是 $z$ 的函数，其对 $x$ 和 $y$ 的导数均为零：$\\frac{\\partial \\mathbf{u}}{\\partial x} = \\mathbf{0}$ 和 $\\frac{\\partial \\mathbf{u}}{\\partial y} = \\mathbf{0}$。此外，速度的 $z$ 分量 $u_z$ 为零。因此，表达式简化为：\n$$ (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = (\\alpha z)( \\mathbf{0}) + (\\beta z)(\\mathbf{0}) + (0) \\frac{\\partial \\mathbf{u}}{\\partial z} = \\mathbf{0} $$\n对于这个速度场，惯性项恒等于零，这意味着斯托克斯方程 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0}$ 是动量平衡的精确描述，而不是一个近似。\n\n根据斯托克斯方程，我们可以将应力张量的散度表示为：\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} = -\\mathbf{f} $$\n将此代入 $\\mathbf{T}_{\\text{net}}$ 的体积分：\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} (-\\mathbf{f})\\,dV $$\n\n题目说明流体受到均匀的重力体积力 $\\mathbf{f} = -\\rho g \\mathbf{k}$ 的作用，其中 $\\rho$ 是恒定密度， $g$ 是重力加速度，$\\mathbf{k}$ 是 $z$ 轴正方向的单位向量。代入 $\\mathbf{f}$ 的表达式：\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} -(-\\rho g \\mathbf{k})\\,dV = \\int_{V} \\rho g \\mathbf{k}\\,dV $$\n\n由于 $\\rho$、$g$ 和 $\\mathbf{k}$ 都是常数，它们可以从积分中提出：\n$$ \\mathbf{T}_{\\text{net}} = \\rho g \\mathbf{k} \\int_{V} dV $$\n积分 $\\int_V dV$ 是控制体 $V$ 的体积。该控制体是一个尺寸为 $L_x$、$L_y$ 和 $L_z$ 的长方体。其体积为：\n$$ \\text{Volume}(V) = L_x L_y L_z $$\n因此，净牵引力矢量为：\n$$ \\mathbf{T}_{\\text{net}} = \\rho g (L_x L_y L_z) \\mathbf{k} $$\n\n这个结果表明，净牵引力是一个完全指向 $z$ 轴正方向的矢量。其大小等于控制体内流体的重量。这是连续介质力学背景下的阿基米德原理的一种表述：周围流体对控制体内流体施加的净力，完全平衡了作用在其上的体积力（重力），这对于处于静止或非加速平衡状态的物体是必需的。描述流动剪切的参数 $\\mu$、$\\alpha$ 和 $\\beta$ 决定了牵引力在控制体各个表面上的分布，但它们不影响整个闭合曲面上的净牵引力。\n\n现在我们代入给定的数值来计算最终答案。\n$\\rho = 1020\\ \\text{kg m}^{-3}$\n$g = 9.81\\ \\text{m s}^{-2}$\n$L_x = 0.50\\ \\text{m}$\n$L_y = 0.30\\ \\text{m}$\n$L_z = 0.020\\ \\text{m}$\n\n净牵引力矢量 $\\mathbf{T}_{\\text{net}} = (T_x, T_y, T_z)$ 的分量为：\n$T_x = 0\\ \\text{N}$\n$T_y = 0\\ \\text{N}$\n$T_z = \\rho g L_x L_y L_z = (1020)(9.81)(0.50)(0.30)(0.020)$\n$T_z = (1020)(9.81)(0.0030) = 30.0186\\ \\text{N}$\n\n题目要求将每个分量四舍五入到四位有效数字。\n$T_x = 0.000$\n$T_y = 0.000$\n$T_z = 30.02$\n\n净牵引力矢量为 $(0, 0, 30.02)$，单位为牛顿。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 30.02\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了分析应用之后，我们转向积分守恒定律的数值近似。本练习将指导你为一个标量输运问题实现最基本也是最重要的数值格式之一：一阶迎风格式（first-order upwind scheme）。通过计算进出控制体积各个面的通量，你将学习如何将连续的积分通量项离散化，并理解迎风思想在保证数值解稳定性中的核心作用。",
            "id": "3604928",
            "problem": "考虑一个无源无汇的被动标量浓度场 $c(\\mathbf{x},t)$，由一个欧拉速度场 $\\mathbf{u}(\\mathbf{x},t)$ 输运。在具有边界 $\\partial V$ 的固定控制体 $V$ 上，标量守恒定律的积分形式为：总标量含量的变化率等于通过边界的净平流出量的负值。您将使用一个边长分别为 $L_x$、$L_y$ 和 $L_z$ 的轴对齐矩形控制体 $V$，其各面上的单位外法向量为 $\\{\\pm \\hat{\\mathbf{x}}, \\pm \\hat{\\mathbf{y}}, \\pm \\hat{\\mathbf{z}}\\}$。\n\n从基本积分守恒定律和散度定理出发，推导出 $\\int_V c\\,dV$ 变化率的平流贡献项的表达式，该表达式为一个涉及 $\\mathbf{u}c \\cdot \\mathbf{n}$ 在 $\\partial V$ 上的面积分，然后将其特化为适用于单个矩形控制体和面平均数据的离散面求和形式。对于离散近似，采用以下建模假设和定义：\n- 对于 $\\partial V$ 的每个面 $f$，给定以下数据：\n  - 面法向速度平均值 $u_{n,f}$，定义为 $\\mathbf{u}\\cdot\\mathbf{n}_f$ 在该面上的平均值（其中 $\\mathbf{n}_f$ 是该面的单位外法向量），单位为米/秒。\n  - 一个入流浓度 $c_{\\text{in},f}$，定义为面外侧紧邻处的 $c$ 的平均值，仅当流体流入 $V$ 时使用。\n- 对面浓度使用一阶迎风近似：对于每个面 $f$，如果 $u_{n,f} \\ge 0$，则取上游侧的施主浓度为单元平均值 $c_V$；如果 $u_{n,f} < 0$，则取施主浓度为给定的入流浓度 $c_{\\text{in},f}$；如果 $u_{n,f} = 0$，则该面通量贡献为零。\n- 面面积为 $A_{+x} = A_{-x} = L_y L_z$，$A_{+y} = A_{-y} = L_x L_z$，$A_{+z} = A_{-z} = L_x L_y$。\n- 对 $V$ 中总标量的变化率的平流贡献项，是 $\\partial V$ 各个面上净平流通量总和的负值。\n\n物理单位：\n- 长度 $L_x$、$L_y$、$L_z$ 必须以米为单位。\n- 速度分量 $u_{n,f}$ 必须以米/秒为单位。\n- 浓度 $c_V$ 和 $c_{\\text{in},f}$ 必须以千克/立方米为单位。\n- 所要求的输出，即对 $\\frac{d}{dt}\\int_V c\\,dV$ 的平流贡献，必须以千克/秒为单位表示，并四舍五入到六位小数。\n\n您的任务是实现一个程序，对下面的每个测试用例，根据上述迎风近似计算 $\\int_V c\\,dV$ 变化率的平流贡献项。\n\n测试套件（每个用例都是一组完整、独立的参数）：\n- 用例 1：\n  - $L_x = 2.0$ 米，$L_y = 1.0$ 米，$L_z = 1.5$ 米。\n  - $c_V = 3.0$ 千克/立方米。\n  - 面法向速度（米/秒）：$u_{n,+x} = 0.2$，$u_{n,-x} = -0.1$，$u_{n,+y} = -0.05$，$u_{n,-y} = 0.10$，$u_{n,+z} = 0.0$，$u_{n,-z} = -0.2$。\n  - 入流浓度（千克/立方米）：$c_{\\text{in},+x} = 1.0$，$c_{\\text{in},-x} = 4.0$，$c_{\\text{in},+y} = 2.5$，$c_{\\text{in},-y} = 1.0$，$c_{\\text{in},+z} = 3.0$，$c_{\\text{in},-z} = 3.5$。\n- 用例 2：\n  - $L_x = 1.0$ 米，$L_y = 1.0$ 米，$L_z = 1.0$ 米。\n  - $c_V = 1.0$ 千克/立方米。\n  - 面法向速度（米/秒）：$u_{n,+x} = 0.0$，$u_{n,-x} = 0.0$，$u_{n,+y} = 0.0$，$u_{n,-y} = 0.0$，$u_{n,+z} = 0.0$，$u_{n,-z} = 0.0$。\n  - 入流浓度（千克/立方米）：$c_{\\text{in},+x} = 1.0$，$c_{\\text{in},-x} = 1.0$，$c_{\\text{in},+y} = 1.0$，$c_{\\text{in},-y} = 1.0$，$c_{\\text{in},+z} = 1.0$，$c_{\\text{in},-z} = 1.0$。\n- 用例 3：\n  - $L_x = 1.5$ 米，$L_y = 1.0$ 米，$L_z = 2.0$ 米。\n  - $c_V = 3.2$ 千克/立方米。\n  - 面法向速度（米/秒）：$u_{n,+x} = 0.1$，$u_{n,-x} = -0.1$，$u_{n,+y} = 0.05$，$u_{n,-y} = -0.05$，$u_{n,+z} = 0.0$，$u_{n,-z} = 0.0$。\n  - 入流浓度（千克/立方米）：$c_{\\text{in},+x} = 3.2$，$c_{\\text{in},-x} = 3.2$，$c_{\\text{in},+y} = 3.2$，$c_{\\text{in},-y} = 3.2$，$c_{\\text{in},+z} = 3.2$，$c_{\\text{in},-z} = 3.2$。\n- 用例 4：\n  - $L_x = 3.0$ 米，$L_y = 2.0$ 米，$L_z = 1.0$ 米。\n  - $c_V = 5.0$ 千克/立方米。\n  - 面法向速度（米/秒）：$u_{n,+x} = 0.0$，$u_{n,-x} = -1.0$，$u_{n,+y} = 0.2$，$u_{n,-y} = 0.0$，$u_{n,+z} = 0.1$，$u_{n,-z} = 0.0$。\n  - 入流浓度（千克/立方米）：$c_{\\text{in},+x} = 5.0$，$c_{\\text{in},-x} = 0.5$，$c_{\\text{in},+y} = 5.0$，$c_{\\text{in},-y} = 5.0$，$c_{\\text{in},+z} = 5.0$，$c_{\\text{in},-z} = 5.0$。\n\n您的程序应生成一行输出，其中包含用例 1 到 4 的结果，格式为一个用方括号括起来的逗号分隔列表，每个值都以千克/秒为单位四舍五入到六位小数，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_i$ 是一个小数点后恰好有六位的浮点数。",
            "solution": "该问题是有效的，因为它科学地基于质量守恒原理，在数学上是适定的，并且由客观、明确的参数定义。\n\n控制被动标量（浓度为 $c(\\mathbf{x}, t)$）在速度场 $\\mathbf{u}(\\mathbf{x}, t)$ 中输运，且在固定控制体 $V$ 内无内部源或汇的基本原理是守恒定律的积分形式。该定律指出，控制体 $V$ 内标量总量的变化率等于穿过边界曲面 $\\partial V$ 的净平流通量的负值。其数学表达式为：\n$$\n\\frac{d}{dt} \\int_V c \\, dV = - \\oint_{\\partial V} (c\\mathbf{u}) \\cdot \\mathbf{n} \\, dA\n$$\n这里，$\\mathbf{n}$ 是面元 $dA$ 上的向外单位法向量。项 $c\\mathbf{u}$ 代表平流通量矢量，其与 $\\mathbf{n}$ 的点积给出了垂直于边界的通量分量。\n\n对于离散数值方法，对 $\\partial V$ 的连续面积分通过对构成边界的离散面上的通量求和来近似。给定的控制体是矩形棱柱，因此其边界 $\\partial V$ 由六个面组成，我们用索引 $f$ 表示。这些面对应于单元边界处的恒定坐标平面，标记为 $\\{+x, -x, +y, -y, +z, -z\\}$。因此，面积分被离散化为：\n$$\n\\oint_{\\partial V} (c\\mathbf{u}) \\cdot \\mathbf{n} \\, dA \\approx \\sum_{f \\in \\partial V} \\text{Flux}_f\n$$\n通过单个面 $f$ 的通量通过假设相关量在面面积 $A_f$ 上是恒定的来近似。因此，通过面 $f$ 的通量由下式给出：\n$$\n\\text{Flux}_f = \\int_{A_f} (c\\mathbf{u}) \\cdot \\mathbf{n}_f \\, dA \\approx (c_f u_{n,f}) A_f\n$$\n这里，$u_{n,f}$ 是面平均法向速度分量 $(\\mathbf{u} \\cdot \\mathbf{n}_f)_f$，$c_f$ 是面上的代表性标量浓度。\n\n问题指定使用一阶迎风格式来确定 $c_f$ 的值。该格式基于以下原理：穿过一个面的流体携带来自“迎风”或“施主”侧的浓度。\n- 如果流动是向外的（$u_{n,f} \\ge 0$），流体源自控制体内部。因此，面上的浓度被取为控制体内的平均浓度 $c_V$。\n- 如果流动是向内的（$u_{n,f} < 0$），流体源自控制体外部。面上的浓度被取为来自相邻区域的指定入流浓度 $c_{\\text{in},f}$。\n\n结合这些规则，面 $f$ 上的浓度 $c_f$ 确定如下：\n$$\nc_f =\n\\begin{cases}\nc_V & \\text{若 } u_{n,f} \\ge 0 \\\\\nc_{\\text{in},f} & \\text{若 } u_{n,f} < 0\n\\end{cases}\n$$\n净平流出量是六个面上通量的总和：\n$$\n\\text{Net Outflow} = \\sum_{f \\in \\partial V} c_f u_{n,f} A_f\n$$\n问题要求的是 $V$ 中总标量变化率的平流贡献，即净平流出量的负值：\n$$\n\\frac{d}{dt} \\int_V c \\, dV \\bigg|_{\\text{advection}} = - \\sum_{f \\in \\{+x, -x, +y, -y, +z, -z\\}} c_f u_{n,f} A_f\n$$\n面面积 $A_f$ 由边长为 $L_x$、$L_y$ 和 $L_z$ 的矩形控制体的几何形状给出：\n- $A_{\\pm x} = L_y L_z$\n- $A_{\\pm y} = L_x L_z$\n- $A_{\\pm z} = L_x L_y$\n\n为了计算每个测试用例的最终值，我们将给定的 $L_x, L_y, L_z, c_V$ 值以及特定于每个面的 $u_{n,f}$ 和 $c_{\\text{in},f}$ 值代入此离散公式。单位是一致的：浓度 $c$ 的单位是 $\\text{kg} \\cdot \\text{m}^{-3}$，速度 $u$ 的单位是 $\\text{m} \\cdot \\text{s}^{-1}$，面积 $A$ 的单位是 $\\text{m}^2$。得到的通量项 $c u A$ 的单位是 $\\text{kg} \\cdot \\text{s}^{-1}$，这是总质量变化率的正确单位。\n\n计算过程如下：\n1.  对于六个面中的每一个，根据 $u_{n,f}$ 的符号确定流动方向。\n2.  选择适当的浓度 $c_f$（出流时为 $c_V$，入流时为 $c_{\\text{in},f}$）。\n3.  计算每个面的质量通量 $\\Phi_f = c_f u_{n,f} A_f$。\n4.  将所有六个面的通量相加，得到总净流出量 $\\sum \\Phi_f$。\n5.  最终结果是该总和的负值，即 $-\\sum \\Phi_f$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the scalar transport problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"L\": (2.0, 1.0, 1.5),\n            \"c_V\": 3.0,\n            \"u_n\": {'+x': 0.2, '-x': -0.1, '+y': -0.05, '-y': 0.10, '+z': 0.0, '-z': -0.2},\n            \"c_in\": {'+x': 1.0, '-x': 4.0, '+y': 2.5, '-y': 1.0, '+z': 3.0, '-z': 3.5}\n        },\n        # Case 2\n        {\n            \"L\": (1.0, 1.0, 1.0),\n            \"c_V\": 1.0,\n            \"u_n\": {'+x': 0.0, '-x': 0.0, '+y': 0.0, '-y': 0.0, '+z': 0.0, '-z': 0.0},\n            \"c_in\": {'+x': 1.0, '-x': 1.0, '+y': 1.0, '-y': 1.0, '+z': 1.0, '-z': 1.0}\n        },\n        # Case 3\n        {\n            \"L\": (1.5, 1.0, 2.0),\n            \"c_V\": 3.2,\n            \"u_n\": {'+x': 0.1, '-x': -0.1, '+y': 0.05, '-y': -0.05, '+z': 0.0, '-z': 0.0},\n            \"c_in\": {'+x': 3.2, '-x': 3.2, '+y': 3.2, '-y': 3.2, '+z': 3.2, '-z': 3.2}\n        },\n        # Case 4\n        {\n            \"L\": (3.0, 2.0, 1.0),\n            \"c_V\": 5.0,\n            \"u_n\": {'+x': 0.0, '-x': -1.0, '+y': 0.2, '-y': 0.0, '+z': 0.1, '-z': 0.0},\n            \"c_in\": {'+x': 5.0, '-x': 0.5, '+y': 5.0, '-y': 5.0, '+z': 5.0, '-z': 5.0}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_rate_of_change(case)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_rate_of_change(case_data):\n    \"\"\"\n    Calculates the advective contribution to the rate of change of the total scalar\n    in a control volume using a first-order upwind scheme.\n    \"\"\"\n    Lx, Ly, Lz = case_data[\"L\"]\n    c_V = case_data[\"c_V\"]\n    u_n = case_data[\"u_n\"]\n    c_in = case_data[\"c_in\"]\n\n    # Define face areas\n    areas = {\n        '+x': Ly * Lz, '-x': Ly * Lz,\n        '+y': Lx * Lz, '-y': Lx * Lz,\n        '+z': Lx * Ly, '-z': Lx * Ly\n    }\n\n    faces = ['+x', '-x', '+y', '-y', '+z', '-z']\n    \n    total_net_outflow = 0.0\n    \n    for face in faces:\n        u_nf = u_n[face]\n        A_f = areas[face]\n        \n        # Apply the first-order upwind scheme to determine face concentration\n        if u_nf >= 0:\n            # Outflow: use the cell-average concentration\n            c_f = c_V\n        else:\n            # Inflow: use the prescribed inflow concentration\n            c_f = c_in[face]\n        \n        # Calculate flux through the face\n        flux = c_f * u_nf * A_f\n        total_net_outflow += flux\n            \n    # The rate of change is the negative of the net outflow\n    rate_of_change = -total_net_outflow\n    return rate_of_change\n\nsolve()\n```"
        },
        {
            "introduction": "最后，我们将探讨非线性守恒定律带来的挑战，其中简单的数值格式可能会失效。本练习将引导你从第一性原理出发，为伯格斯方程（Burgers' equation）推导戈杜诺夫通量（Godunov flux），这是一种先进的数值通量计算方法。通过在控制体积界面上求解精确的局部黎曼问题（Riemann problem），你将掌握构建能够正确捕捉激波和稀疏波等非线性现象的物理一致性数值格式的核心思想。",
            "id": "3604943",
            "problem": "考虑在一个均匀有限体积网格上的无量纲一维非线性标量守恒律，\n$$\\partial_{t} u(x,t) + \\partial_{x} f(u(x,t)) = 0,$$\n其通量函数由伯格斯 (Burgers) 通量给出，\n$$f(u) = \\frac{1}{2}u^{2}.$$\n设控制体积为区间 $[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$，其右侧界面的单位外法线指向 $x$ 轴正方向。假设在 $t=0$ 时刻，界面 $x_{i+\\frac{1}{2}}$ 附近的状态为分段常数：\n$$u(x,0) = \\begin{cases}\nu_{L}, & x < x_{i+\\frac{1}{2}},\\\\\nu_{R}, & x > x_{i+\\frac{1}{2}}.\n\\end{cases}$$\n从控制体积 $V$（其边界为 $\\partial V$）上的积分守恒律出发，\n$$\\frac{d}{dt}\\int_{V} u \\, dx + \\oint_{\\partial V} f(u)\\, \\boldsymbol{n} \\cdot d\\boldsymbol{s} = 0,$$\n并利用界面上的精确局部黎曼问题（初始数据为 $u_{L}$ 和 $u_{R}$），推导戈杜诺夫 (Godunov) 界面通量 $\\hat{f}(u_{L},u_{R})$，该通量为在时间区间 $[0,\\Delta t]$ 内通过界面 $x_{i+\\frac{1}{2}}$ 进入右侧控制体积的时间平均通量。假设 $\\Delta t$ 足够小，以满足针对最大波速的 Courant–Friedrichs–Lewy (CFL) 条件，从而保证该黎曼问题产生的波在 $[0,\\Delta t]$ 期间不与其他界面相互作用。您的推导必须从第一性原理出发：使用积分守恒表达式、针对激波的朗金-雨果尼奥 (Rankine–Hugoniot) 条件以及针对连续波的特征速度 $f'(u)$，而不能直接套用已有的戈杜诺夫 (Godunov) 公式。\n\n在得到 $\\hat{f}(u_{L},u_{R})$ 的表达式后，对于特定状态 $u_{L} = 2$ 和 $u_{R} = -1$，在满足 CFL 限制条件的任意 $\\Delta t > 0$ 下对其进行求值。报告进入右侧控制体积的时间平均通量的精确数值。最终答案必须是一个实数值。不需要四舍五入。",
            "solution": "本题要求从第一性原理出发，推导伯格斯 (Burgers) 方程的戈杜诺夫 (Godunov) 界面通量，并针对一组特定的初始状态进行求值。\n\n一维标量守恒律为\n$$ \\partial_{t} u(x,t) + \\partial_{x} f(u(x,t)) = 0 $$\n其中伯格斯 (Burgers) 通量函数为\n$$ f(u) = \\frac{1}{2}u^{2} $$\n在控制体积 $V$（其边界为 $\\partial V$）上的积分形式守恒律为\n$$ \\frac{d}{dt}\\int_{V} u \\, dx + \\int_{\\partial V} f(u)\\, \\boldsymbol{n} \\cdot d\\boldsymbol{s} = 0 $$\n其中 $\\boldsymbol{n}$ 是单位外法向量。\n\n戈杜诺夫 (Godunov) 方法利用了在单元界面处的局部黎曼问题的精确解。我们考虑在界面 $x = x_{i+\\frac{1}{2}}$ 处的分段常数初始数据：\n$$ u(x,0) = \\begin{cases} u_{L}, & x < x_{i+\\frac{1}{2}},\\\\ u_{R}, & x > x_{i+\\frac{1}{2}}. \\end{cases} $$\n在 CFL 条件（即波在时间步长 $[0, \\Delta t]$ 内不与相邻界面相互作用）下，该黎曼问题的解是自相似的。这意味着解 $u(x,t)$ 仅依赖于比值 $\\xi = (x - x_{i+\\frac{1}{2}})/t$。设该自相似解为 $w(\\xi)$。\n\n戈杜诺夫 (Godunov) 通量 $\\hat{f}(u_L, u_R)$ 定义为在时间区间 $[0, \\Delta t]$ 内界面 $x = x_{i+\\frac{1}{2}}$ 上的时间平均通量。按照惯例，这是指沿 $x$ 轴正方向的通量，对应于进入右侧控制体积 $V_{i+1} = [x_{i+\\frac{1}{2}}, x_{i+\\frac{3}{2}}]$ 的通量。因此，\n$$ \\hat{f}(u_L, u_R) = \\frac{1}{\\Delta t} \\int_{0}^{\\Delta t} f(u(x_{i+\\frac{1}{2}}, t)) \\, dt $$\n由于解是自相似的，对于所有 $t > 0$，在固定界面位置 $x = x_{i+\\frac{1}{2}}$ 处的状态是恒定的。该状态由在 $\\xi=0$ 处的自相似解给出：\n$$ u(x_{i+\\frac{1}{2}}, t) = w(0) \\equiv u_{God} $$\n因此，界面处的通量也是恒定的，即 $f(u_{God})$。时间平均通量简化为：\n$$ \\hat{f}(u_L, u_R) = \\frac{1}{\\Delta t} \\int_{0}^{\\Delta t} f(u_{God}) \\, dt = f(u_{God}) $$\n推导的核心是通过分析伯格斯 (Burgers) 方程的黎曼问题解来找到状态 $u_{God}$。伯格斯 (Burgers) 方程的特征速度为 $a(u) = f'(u) = u$。解的性质取决于 $u_L$ 和 $u_R$ 的相对大小。\n\n**情况 1：激波 ($u_L > u_R$)**\n当来自左右两边状态的特征线汇集时（$a(u_L) = u_L > u_R = a(u_R)$），会形成一个间断，即激波。该激波的速度 $s$ 由朗金-雨果尼奥 (Rankine-Hugoniot) 条件确定：\n$$ s = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{\\frac{1}{2}u_L^2 - \\frac{1}{2}u_R^2}{u_L - u_R} = \\frac{\\frac{1}{2}(u_L - u_R)(u_L + u_R)}{u_L - u_R} = \\frac{u_L + u_R}{2} $$\n解是一个以速度 $s$ 移动的阶跃函数：\n$$ u(x,t) = \\begin{cases} u_{L}, & (x - x_{i+\\frac{1}{2}})/t < s, \\\\ u_{R}, & (x - x_{i+\\frac{1}{2}})/t > s. \\end{cases} $$\n为了找到 $u_{God} = w(0)$，我们在 $\\xi=0$ 处对解进行求值。\n- 如果 $s > 0$，激波向右移动。界面所在区域（$\\xi=0$）位于激波轨迹（$\\xi=s$）的左侧。因此，该处的状态为 $u_L$。所以，$u_{God} = u_L$。\n- 如果 $s < 0$，激波向左移动。界面所在区域（$\\xi=0$）位于激波轨迹的右侧。因此，该处的状态为 $u_R$。所以，$u_{God} = u_R$。\n- 如果 $s = 0$，激波是静止的并保持在界面上。状态 $u_L$ 和 $u_R$ 分居两侧。在这种情况下，$u_L = -u_R$。通量在静止激波上是连续的，$f(u_L) = f(u_R)$，因此选择是明确的。按照惯例，我们可以将其归入 $s>0$ 的情况。\n\n总而言之，对于激波（$u_L > u_R$）：\n$$ u_{God} = \\begin{cases} u_{L}, & \\text{若 } s = \\frac{u_L+u_R}{2} \\ge 0, \\\\ u_{R}, & \\text{若 } s = \\frac{u_L+u_R}{2} < 0. \\end{cases} $$\n戈杜诺夫 (Godunov) 通量为 $\\hat{f}(u_L, u_R) = f(u_{God})$。\n\n**情况 2：稀疏波 ($u_L \\le u_R$)**\n当特征线发散时（$a(u_L) = u_L \\le u_R = a(u_R)$），会形成一个称为稀疏波的连续解。该波是从点 $(x_{i+\\frac{1}{2}}, 0)$ 发出的一簇特征线扇。自相似解 $w(\\xi)$ 为：\n$$ w(\\xi) = \\begin{cases} u_{L}, & \\xi < u_L, \\\\ \\xi, & u_L \\le \\xi \\le u_R, \\\\ u_{R}, & \\xi > u_R. \\end{cases} $$\n为了找到 $u_{God} = w(0)$，我们检查 $\\xi=0$ 相对于特征线扇的位置，该扇区覆盖了速度区间 $[u_L, u_R]$。\n- 如果 $u_L \\le 0 \\le u_R$，界面速度 $\\xi=0$ 落在稀疏扇内部。状态为 $u_{God} = w(0) = 0$。\n- 如果 $0 < u_L (\\le u_R)$，界面速度 $\\xi=0$ 位于扇区的左侧。状态为 $u_{God} = w(0) = u_L$。\n- 如果 $(u_L \\le) u_R < 0$，界面速度 $\\xi=0$ 位于扇区的右侧。状态为 $u_{God} = w(0) = u_R$。\n\n这样就完成了从第一性原理推导状态 $u_{God}$ 的过程。戈杜诺夫 (Godunov) 通量始终为 $\\hat{f}(u_L, u_R) = f(u_{God})$。\n\n**针对特定状态的求值**\n题目给出了特定状态 $u_L = 2$ 和 $u_R = -1$。\n首先，我们比较这两个状态：$u_L = 2 > u_R = -1$。这对应于激波情况。\n接下来，我们计算激波速度 $s$：\n$$ s = \\frac{u_L + u_R}{2} = \\frac{2 + (-1)}{2} = \\frac{1}{2} $$\n由于 $s = \\frac{1}{2} > 0$，激波沿 $x$ 轴正方向（向右）传播。\n根据我们的推导，如果 $s > 0$，界面 $x=x_{i+\\frac{1}{2}}$ 处的状态是激波左侧的状态，即 $u_L$。\n因此，界面处的恒定状态为 $u_{God} = u_L = 2$。\n戈杜诺夫 (Godunov) 通量，即进入右侧控制体积的时间平均通量，由 $\\hat{f}(2, -1) = f(u_{God})$ 给出。\n$$ \\hat{f}(2, -1) = f(2) $$\n使用伯格斯 (Burgers) 通量函数 $f(u) = \\frac{1}{2}u^2$：\n$$ \\hat{f}(2, -1) = \\frac{1}{2}(2)^2 = \\frac{1}{2}(4) = 2 $$\n进入右侧控制体积的时间平均通量恰好为 $2$。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}