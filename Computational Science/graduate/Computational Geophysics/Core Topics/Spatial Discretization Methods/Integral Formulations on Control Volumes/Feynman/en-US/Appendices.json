{
    "hands_on_practices": [
        {
            "introduction": "The integral formulation of conservation laws provides a powerful bridge between abstract field equations and tangible physical balances. This first practice explores the integral form of the momentum conservation principle for a fluid. You will see how the net force exerted by surface tractions over a closed control volume is fundamentally linked to the total body force acting within that volume, a direct consequence of mechanical equilibrium and the divergence theorem. This exercise hones your ability to apply these foundational theorems to simplify what appears to be a complex fluid dynamics problem into an elegant statement about force balance .",
            "id": "3604912",
            "problem": "Consider an incompressible Stokes flow of a viscous brine of constant density $\\rho$ and dynamic viscosity $\\mu$ over a rigid, impermeable planar boundary located at $z=0$. The flow occupies the half-space $z>0$. A rectangular Control Volume (CV) $V$ is adjacent to the boundary, defined by $0 \\leq x \\leq L_{x}$, $0 \\leq y \\leq L_{y}$, and $0 \\leq z \\leq L_{z}$, with its bottom face coincident with the boundary at $z=0$. The local velocity field near the boundary is measured to be linear in $z$ with components $u_{x}(x,y,z)=\\alpha z$ and $u_{y}(x,y,z)=\\beta z$, and $u_{z}(x,y,z)=0$, where $\\alpha$ and $\\beta$ are constants. The fluid is subject to a uniform gravitational body force $\\mathbf{f}=-\\rho g\\,\\mathbf{k}$, where $g$ is the gravitational acceleration and $\\mathbf{k}$ is the unit vector in the positive $z$-direction.\n\nUsing an integral formulation on the control volume and first principles appropriate for incompressible Stokes flow, compute the net traction vector $\\displaystyle \\int_{\\partial V}\\boldsymbol{\\sigma}\\cdot\\mathbf{n}\\,dS$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\mathbf{n}$ is the outward unit normal on $\\partial V$. The parameters are\n$$\\rho=1020\\ \\text{kg m}^{-3},\\quad \\mu=1.5\\ \\text{Pa s},\\quad g=9.81\\ \\text{m s}^{-2},\\quad L_{x}=0.50\\ \\text{m},\\quad L_{y}=0.30\\ \\text{m},\\quad L_{z}=0.020\\ \\text{m},\\quad \\alpha=0.20\\ \\text{s}^{-1},\\quad \\beta=-0.10\\ \\text{s}^{-1}.$$\nExpress your final answer as a $1\\times 3$ row vector in Newtons and round each component to four significant figures.",
            "solution": "The problem asks for the computation of the net traction vector, which is the integral of the traction vector $\\mathbf{t} = \\boldsymbol{\\sigma}\\cdot\\mathbf{n}$ over the entire closed surface $\\partial V$ of a control volume $V$. The net traction vector $\\mathbf{T}_{\\text{net}}$ is given by the surface integral:\n$$ \\mathbf{T}_{\\text{net}} = \\oint_{\\partial V} \\boldsymbol{\\sigma}\\cdot\\mathbf{n}\\,dS $$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\mathbf{n}$ is the outward unit normal vector on the boundary $\\partial V$.\n\nThe Divergence Theorem relates a surface integral of a vector field (or a tensor field contracted with the normal vector) over a closed surface to the volume integral of the divergence of that field over the volume enclosed by the surface. Applying the theorem to the expression for $\\mathbf{T}_{\\text{net}}$ yields:\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} (\\nabla \\cdot \\boldsymbol{\\sigma})\\,dV $$\n\nThe problem statement specifies that the fluid is undergoing an incompressible Stokes flow. The governing equation for conservation of momentum in this regime is the Stokes equation, which represents a balance between surface forces and body forces, as inertial forces are negligible. The differential form of this momentum balance is:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0} $$\nwhere $\\mathbf{f}$ is the body force per unit volume.\n\nBefore proceeding, we verify that the given velocity field $\\mathbf{u}(x,y,z) = (\\alpha z, \\beta z, 0)$ is consistent with the assumptions.\nFirst, for an incompressible flow, the continuity equation requires the divergence of the velocity field to be zero:\n$$ \\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} + \\frac{\\partial u_z}{\\partial z} = \\frac{\\partial(\\alpha z)}{\\partial x} + \\frac{\\partial(\\beta z)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0 + 0 + 0 = 0 $$\nThe velocity field is indeed divergence-free and thus satisfies the incompressibility condition.\n\nSecond, the Stokes flow approximation is valid when the inertial terms in the Navier-Stokes equations are negligible. The full steady-state momentum equation is $\\rho (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f}$. For the given velocity field, the advective acceleration term is:\n$$ (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = u_x \\frac{\\partial \\mathbf{u}}{\\partial x} + u_y \\frac{\\partial \\mathbf{u}}{\\partial y} + u_z \\frac{\\partial \\mathbf{u}}{\\partial z} $$\nSince $\\mathbf{u}$ is only a function of $z$, the derivatives with respect to $x$ and $y$ are zero: $\\frac{\\partial \\mathbf{u}}{\\partial x} = \\mathbf{0}$ and $\\frac{\\partial \\mathbf{u}}{\\partial y} = \\mathbf{0}$. Furthermore, the $z$-component of velocity, $u_z$, is zero. Therefore, the expression simplifies to:\n$$ (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = (\\alpha z)( \\mathbf{0}) + (\\beta z)(\\mathbf{0}) + (0) \\frac{\\partial \\mathbf{u}}{\\partial z} = \\mathbf{0} $$\nThe inertial term is identically zero for this velocity field, which means the Stokes equation $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0}$ is an exact description of the momentum balance, not an approximation.\n\nFrom the Stokes equation, we can express the divergence of the stress tensor as:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} = -\\mathbf{f} $$\nSubstituting this into the volume integral for $\\mathbf{T}_{\\text{net}}$:\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} (-\\mathbf{f})\\,dV $$\n\nThe problem states that the fluid is subject to a uniform gravitational body force $\\mathbf{f} = -\\rho g \\mathbf{k}$, where $\\rho$ is the constant density, $g$ is the gravitational acceleration, and $\\mathbf{k}$ is the unit vector in the positive $z$-direction. Substituting this expression for $\\mathbf{f}$:\n$$ \\mathbf{T}_{\\text{net}} = \\int_{V} -(-\\rho g \\mathbf{k})\\,dV = \\int_{V} \\rho g \\mathbf{k}\\,dV $$\n\nSince $\\rho$, $g$, and $\\mathbf{k}$ are all constants, they can be factored out of the integral:\n$$ \\mathbf{T}_{\\text{net}} = \\rho g \\mathbf{k} \\int_{V} dV $$\nThe integral $\\int_V dV$ is the volume of the control volume $V$. The control volume is a rectangular prism with dimensions $L_x$, $L_y$, and $L_z$. Its volume is:\n$$ \\text{Volume}(V) = L_x L_y L_z $$\nThus, the net traction vector is:\n$$ \\mathbf{T}_{\\text{net}} = \\rho g (L_x L_y L_z) \\mathbf{k} $$\n\nThis result indicates that the net traction is a vector pointing purely in the positive $z$-direction. Its magnitude is equal to the weight of the fluid contained within the control volume. This is a statement of Archimedes' principle in the context of continuum mechanics: the net force exerted by the surrounding fluid on the fluid within the control volume perfectly balances the body force (gravity) acting on it, as required for a body in static or non-accelerating equilibrium. The parameters describing the shearing of the flow, $\\mu$, $\\alpha$, and $\\beta$, determine the distribution of traction forces on the individual faces of the control volume, but they do not affect the net traction over the entire closed surface.\n\nWe now substitute the given numerical values to compute the final answer.\n$\\rho = 1020\\ \\text{kg m}^{-3}$\n$g = 9.81\\ \\text{m s}^{-2}$\n$L_x = 0.50\\ \\text{m}$\n$L_y = 0.30\\ \\text{m}$\n$L_z = 0.020\\ \\text{m}$\n\nThe components of the net traction vector $\\mathbf{T}_{\\text{net}} = (T_x, T_y, T_z)$ are:\n$T_x = 0\\ \\text{N}$\n$T_y = 0\\ \\text{N}$\n$T_z = \\rho g L_x L_y L_z = (1020)(9.81)(0.50)(0.30)(0.020)$\n$T_z = (1020)(9.81)(0.0030) = 30.0186\\ \\text{N}$\n\nThe problem requires rounding each component to four significant figures.\n$T_x = 0.000$\n$T_y = 0.000$\n$T_z = 30.02$\n\nThe net traction vector is $(0, 0, 30.02)$ in Newtons.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 30.02\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from theory to computation, this practice demonstrates how the integral conservation law forms the backbone of the finite volume method. Here, you will discretize the advective transport equation by approximating the surface integral of flux as a sum over the faces of a control volume. This hands-on coding exercise introduces the fundamental \"upwind\" approximation, a robust method for constructing numerical fluxes that respect the direction of information flow, a cornerstone of computational fluid dynamics .",
            "id": "3604928",
            "problem": "Consider a passive scalar concentration field $c(\\mathbf{x},t)$ transported by an Eulerian velocity field $\\mathbf{u}(\\mathbf{x},t)$ without sources or sinks. The scalar conservation law on a fixed control volume $V$ with boundary $\\partial V$ is, in integral form, that the rate of change of the total scalar content equals the negative of the net advective outflow through the boundary. You are to work with an axis-aligned rectangular control volume $V$ of edge lengths $L_x$, $L_y$, and $L_z$, with outward unit normals on the faces $\\{\\pm \\hat{\\mathbf{x}}, \\pm \\hat{\\mathbf{y}}, \\pm \\hat{\\mathbf{z}}\\}$.\n\nStarting from the fundamental integral conservation law and the Divergence Theorem, derive the expression for the advective contribution to the rate of change of $\\int_V c\\,dV$ as a surface integral involving $\\mathbf{u}c \\cdot \\mathbf{n}$ over $\\partial V$, and then specialize it to a discrete face-summed form appropriate for a single rectangular control volume with face-averaged data. Adopt the following modeling assumptions and definitions for the discrete approximation:\n- On each face $f$ of $\\partial V$, you are given:\n  - The face-normal velocity average $u_{n,f}$, defined as the average of $\\mathbf{u}\\cdot\\mathbf{n}_f$ over the face (with $\\mathbf{n}_f$ the outward unit normal of that face), in meters per second.\n  - An inflow concentration $c_{\\text{in},f}$, defined as the average of $c$ just outside the face and used only when the face flow is into $V$.\n- Use the first-order upwind approximation for the face concentration: for each face $f$, if $u_{n,f} \\ge 0$, take the donor concentration on the upwind side to be the cell-average $c_V$; if $u_{n,f} < 0$, take the donor concentration to be the prescribed inflow concentration $c_{\\text{in},f}$; and if $u_{n,f} = 0$, the face contributes zero flux.\n- The face areas are $A_{+x} = A_{-x} = L_y L_z$, $A_{+y} = A_{-y} = L_x L_z$, and $A_{+z} = A_{-z} = L_x L_y$.\n- The advective contribution to the rate of change of the total scalar in $V$ is the negative of the net advective flux summed over the faces of $\\partial V$.\n\nPhysical units:\n- Lengths $L_x$, $L_y$, $L_z$ must be in meters.\n- Velocity components $u_{n,f}$ must be in meters per second.\n- Concentrations $c_V$ and $c_{\\text{in},f}$ must be in kilograms per cubic meter.\n- The requested output, the advective contribution to $\\frac{d}{dt}\\int_V c\\,dV$, must be expressed in kilograms per second, rounded to six decimal places.\n\nYour task is to implement a program that, for each test case below, computes the advective contribution to the rate of change of $\\int_V c\\,dV$ under the upwind approximation described above.\n\nTest suite (each case is a complete, independent set of parameters):\n- Case $1$:\n  - $L_x = 2.0$ meters, $L_y = 1.0$ meters, $L_z = 1.5$ meters.\n  - $c_V = 3.0$ kilograms per cubic meter.\n  - Face-normal velocities (meters per second): $u_{n,+x} = 0.2$, $u_{n,-x} = -0.1$, $u_{n,+y} = -0.05$, $u_{n,-y} = 0.10$, $u_{n,+z} = 0.0$, $u_{n,-z} = -0.2$.\n  - Inflow concentrations (kilograms per cubic meter): $c_{\\text{in},+x} = 1.0$, $c_{\\text{in},-x} = 4.0$, $c_{\\text{in},+y} = 2.5$, $c_{\\text{in},-y} = 1.0$, $c_{\\text{in},+z} = 3.0$, $c_{\\text{in},-z} = 3.5$.\n- Case $2$:\n  - $L_x = 1.0$ meters, $L_y = 1.0$ meters, $L_z = 1.0$ meters.\n  - $c_V = 1.0$ kilograms per cubic meter.\n  - Face-normal velocities (meters per second): $u_{n,+x} = 0.0$, $u_{n,-x} = 0.0$, $u_{n,+y} = 0.0$, $u_{n,-y} = 0.0$, $u_{n,+z} = 0.0$, $u_{n,-z} = 0.0$.\n  - Inflow concentrations (kilograms per cubic meter): $c_{\\text{in},+x} = 1.0$, $c_{\\text{in},-x} = 1.0$, $c_{\\text{in},+y} = 1.0$, $c_{\\text{in},-y} = 1.0$, $c_{\\text{in},+z} = 1.0$, $c_{\\text{in},-z} = 1.0$.\n- Case $3$:\n  - $L_x = 1.5$ meters, $L_y = 1.0$ meters, $L_z = 2.0$ meters.\n  - $c_V = 3.2$ kilograms per cubic meter.\n  - Face-normal velocities (meters per second): $u_{n,+x} = 0.1$, $u_{n,-x} = -0.1$, $u_{n,+y} = 0.05$, $u_{n,-y} = -0.05$, $u_{n,+z} = 0.0$, $u_{n,-z} = 0.0$.\n  - Inflow concentrations (kilograms per cubic meter): $c_{\\text{in},+x} = 3.2$, $c_{\\text{in},-x} = 3.2$, $c_{\\text{in},+y} = 3.2$, $c_{\\text{in},-y} = 3.2$, $c_{\\text{in},+z} = 3.2$, $c_{\\text{in},-z} = 3.2$.\n- Case $4$:\n  - $L_x = 3.0$ meters, $L_y = 2.0$ meters, $L_z = 1.0$ meters.\n  - $c_V = 5.0$ kilograms per cubic meter.\n  - Face-normal velocities (meters per second): $u_{n,+x} = 0.0$, $u_{n,-x} = -1.0$, $u_{n,+y} = 0.2$, $u_{n,-y} = 0.0$, $u_{n,+z} = 0.1$, $u_{n,-z} = 0.0$.\n  - Inflow concentrations (kilograms per cubic meter): $c_{\\text{in},+x} = 5.0$, $c_{\\text{in},-x} = 0.5$, $c_{\\text{in},+y} = 5.0$, $c_{\\text{in},-y} = 5.0$, $c_{\\text{in},+z} = 5.0$, $c_{\\text{in},-z} = 5.0$.\n\nYour program should produce a single line of output containing the results for Cases $1$ through $4$ as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places in kilograms per second, for example, $[r_1,r_2,r_3,r_4]$ where each $r_i$ is a floating-point number with exactly six digits after the decimal point.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of mass conservation, is mathematically well-posed, and is defined with objective, unambiguous parameters.\n\nThe fundamental principle governing the transport of a passive scalar with concentration $c(\\mathbf{x}, t)$ by a velocity field $\\mathbf{u}(\\mathbf{x}, t)$ in a fixed control volume $V$, without internal sources or sinks, is the integral form of the conservation law. This law states that the time rate of change of the total amount of the scalar within $V$ is equal to the negative of the net advective flux of the scalar across the boundary surface $\\partial V$. Mathematically, this is expressed as:\n$$\n\\frac{d}{dt} \\int_V c \\, dV = - \\oint_{\\partial V} (c\\mathbf{u}) \\cdot \\mathbf{n} \\, dA\n$$\nHere, $\\mathbf{n}$ is the outward-pointing unit normal vector on the surface element $dA$. The term $c\\mathbf{u}$ represents the advective flux vector, and its dot product with $\\mathbf{n}$ gives the component of the flux perpendicular to the boundary.\n\nFor a discrete numerical method, the continuous surface integral over $\\partial V$ is approximated by a sum of fluxes over the discrete faces that constitute the boundary. The given control volume is a rectangular prism, so its boundary $\\partial V$ consists of six faces, which we denote by an index $f$. These faces correspond to the constant coordinate planes at the boundaries of the cell, labeled $\\{+x, -x, +y, -y, +z, -z\\}$. The surface integral is thus discretized as:\n$$\n\\oint_{\\partial V} (c\\mathbf{u}) \\cdot \\mathbf{n} \\, dA \\approx \\sum_{f \\in \\partial V} \\text{Flux}_f\n$$\nThe flux through a single face $f$ is approximated by assuming the relevant quantities are constant over the face area $A_f$. The flux through face $f$ is then given by:\n$$\n\\text{Flux}_f = \\int_{A_f} (c\\mathbf{u}) \\cdot \\mathbf{n}_f \\, dA \\approx (c_f u_{n,f}) A_f\n$$\nHere, $u_{n,f}$ is the face-averaged normal velocity component $(\\mathbf{u} \\cdot \\mathbf{n}_f)_f$, and $c_f$ is the representative scalar concentration at the face.\n\nThe problem specifies a first-order upwind scheme to determine the value of $c_f$. This scheme is based on the principle that the fluid crossing a face carries the concentration from the \"upwind\" or \"donor\" side.\n- If the flow is outwards ($u_{n,f} \\ge 0$), the fluid originates from inside the control volume. The concentration at the face is thus taken to be the average concentration within the volume, $c_V$.\n- If the flow is inwards ($u_{n,f} < 0$), the fluid originates from outside the control volume. The concentration at the face is taken to be the prescribed inflow concentration from the adjacent region, $c_{\\text{in},f}$.\n\nCombining these rules, the concentration on face $f$, $c_f$, is determined as:\n$$\nc_f =\n\\begin{cases}\nc_V & \\text{if } u_{n,f} \\ge 0 \\\\\nc_{\\text{in},f} & \\text{if } u_{n,f} < 0\n\\end{cases}\n$$\nThe net advective outflow is the sum of the fluxes over all six faces:\n$$\n\\text{Net Outflow} = \\sum_{f \\in \\partial V} c_f u_{n,f} A_f\n$$\nThe problem asks for the advective contribution to the rate of change of the total scalar in $V$, which is the negative of the net advective outflow:\n$$\n\\frac{d}{dt} \\int_V c \\, dV \\bigg|_{\\text{advection}} = - \\sum_{f \\in \\{+x, -x, +y, -y, +z, -z\\}} c_f u_{n,f} A_f\n$$\nThe face areas $A_f$ are given by the geometry of the rectangular control volume with side lengths $L_x$, $L_y$, and $L_z$:\n- $A_{\\pm x} = L_y L_z$\n- $A_{\\pm y} = L_x L_z$\n- $A_{\\pm z} = L_x L_y$\n\nTo compute the final value for each test case, we substitute the given values for $L_x, L_y, L_z, c_V$, and the face-specific values for $u_{n,f}$ and $c_{\\text{in},f}$ into this discrete formula. The units are consistent: the concentration $c$ is in $\\text{kg} \\cdot \\text{m}^{-3}$, velocity $u$ is in $\\text{m} \\cdot \\text{s}^{-1}$, and area $A$ is in $\\text{m}^2$. The resulting flux term $c u A$ has units of $\\text{kg} \\cdot \\text{s}^{-1}$, which is the correct unit for a rate of change of total mass.\n\nThe calculation proceeds as follows:\n$1$. For each of the six faces, determine the direction of flow from the sign of $u_{n,f}$.\n$2$. Select the appropriate concentration $c_f$ ($c_V$ for outflow, $c_{\\text{in},f}$ for inflow).\n$3$. Calculate the mass flux $\\Phi_f = c_f u_{n,f} A_f$ for each face.\n$4$. Sum the fluxes from all six faces to get the total net outflow, $\\sum \\Phi_f$.\n$5$. The final result is the negative of this sum, $-\\sum \\Phi_f$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the scalar transport problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"L\": (2.0, 1.0, 1.5),\n            \"c_V\": 3.0,\n            \"u_n\": {'+x': 0.2, '-x': -0.1, '+y': -0.05, '-y': 0.10, '+z': 0.0, '-z': -0.2},\n            \"c_in\": {'+x': 1.0, '-x': 4.0, '+y': 2.5, '-y': 1.0, '+z': 3.0, '-z': 3.5}\n        },\n        # Case 2\n        {\n            \"L\": (1.0, 1.0, 1.0),\n            \"c_V\": 1.0,\n            \"u_n\": {'+x': 0.0, '-x': 0.0, '+y': 0.0, '-y': 0.0, '+z': 0.0, '-z': 0.0},\n            \"c_in\": {'+x': 1.0, '-x': 1.0, '+y': 1.0, '-y': 1.0, '+z': 1.0, '-z': 1.0}\n        },\n        # Case 3\n        {\n            \"L\": (1.5, 1.0, 2.0),\n            \"c_V\": 3.2,\n            \"u_n\": {'+x': 0.1, '-x': -0.1, '+y': 0.05, '-y': -0.05, '+z': 0.0, '-z': 0.0},\n            \"c_in\": {'+x': 3.2, '-x': 3.2, '+y': 3.2, '-y': 3.2, '+z': 3.2, '-z': 3.2}\n        },\n        # Case 4\n        {\n            \"L\": (3.0, 2.0, 1.0),\n            \"c_V\": 5.0,\n            \"u_n\": {'+x': 0.0, '-x': -1.0, '+y': 0.2, '-y': 0.0, '+z': 0.1, '-z': 0.0},\n            \"c_in\": {'+x': 5.0, '-x': 0.5, '+y': 5.0, '-y': 5.0, '+z': 5.0, '-z': 5.0}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_rate_of_change(case)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_rate_of_change(case_data):\n    \"\"\"\n    Calculates the advective contribution to the rate of change of the total scalar\n    in a control volume using a first-order upwind scheme.\n    \"\"\"\n    Lx, Ly, Lz = case_data[\"L\"]\n    c_V = case_data[\"c_V\"]\n    u_n = case_data[\"u_n\"]\n    c_in = case_data[\"c_in\"]\n\n    # Define face areas\n    areas = {\n        '+x': Ly * Lz, '-x': Ly * Lz,\n        '+y': Lx * Lz, '-y': Lx * Lz,\n        '+z': Lx * Ly, '-z': Lx * Ly\n    }\n\n    faces = ['+x', '-x', '+y', '-y', '+z', '-z']\n    \n    total_net_outflow = 0.0\n    \n    for face in faces:\n        u_nf = u_n[face]\n        A_f = areas[face]\n        \n        # Apply the first-order upwind scheme to determine face concentration\n        if u_nf >= 0:\n            # Outflow: use the cell-average concentration\n            c_f = c_V\n        else:\n            # Inflow: use the prescribed inflow concentration\n            c_f = c_in[face]\n        \n        # Calculate flux through the face\n        flux = c_f * u_nf * A_f\n        total_net_outflow += flux\n            \n    # The rate of change is the negative of the net outflow\n    rate_of_change = -total_net_outflow\n    return rate_of_change\n\nsolve()\n```"
        },
        {
            "introduction": "After implementing a basic upwind scheme, we now explore a more sophisticated and physically grounded approach for constructing numerical fluxes, especially for nonlinear problems. This practice introduces the celebrated Godunov method, which relies on solving the exact local Riemann problem at each cell interface to determine the flux. By deriving the Godunov flux for the nonlinear Burgers' equation from first principles, you will uncover the elegant connection between local wave propagation phenomena—shocks and rarefactions—and the design of high-fidelity numerical methods .",
            "id": "3604943",
            "problem": "Consider the dimensionless one-dimensional nonlinear scalar conservation law on a uniform finite volume mesh,\n$$\\partial_{t} u(x,t) + \\partial_{x} f(u(x,t)) = 0,$$\nwith flux function given by Burgers flux,\n$$f(u) = \\frac{1}{2}u^{2}.$$\nLet a control volume be the interval $[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ with outward unit normal at the right face pointing in the positive $x$-direction. Assume a piecewise constant state at time $t=0$ near the face $x_{i+\\frac{1}{2}}$:\n$$u(x,0) = \\begin{cases}\nu_{L}, & x < x_{i+\\frac{1}{2}},\\\\\nu_{R}, & x > x_{i+\\frac{1}{2}}.\n\\end{cases}$$\nStarting from the integral conservation law on a control volume $V$ with boundary $\\partial V$,\n$$\\frac{d}{dt}\\int_{V} u \\, dx + \\int_{\\partial V} f(u)\\, \\boldsymbol{n} \\cdot d\\boldsymbol{s} = 0,$$\nand employing the exact local Riemann problem at the face (with initial data $u_{L}$ and $u_{R}$), derive the Godunov interface flux $\\hat{f}(u_{L},u_{R})$ as the time-averaged flux entering the right-side control volume through the face $x_{i+\\frac{1}{2}}$ over the interval $[0,\\Delta t]$, under the assumption that $\\Delta t$ is sufficiently small to satisfy the Courant–Friedrichs–Lewy (CFL) condition for the maximal wave speed so that waves from this Riemann problem do not interact with other faces during $[0,\\Delta t]$. Your derivation must proceed from first principles: use the integral conservation statement, the Rankine–Hugoniot condition for shock waves, and the characteristic speeds $f'(u)$ for continuous waves, without invoking pre-existing Godunov formulas.\n\nAfter obtaining the expression for $\\hat{f}(u_{L},u_{R})$, evaluate it for the specific states $u_{L} = 2$ and $u_{R} = -1$ with any $\\Delta t > 0$ consistent with the CFL restriction. Report the exact numerical value of the time-averaged flux entering the right-side control volume. The final answer must be a single real-valued number. No rounding is required.",
            "solution": "The problem requires the derivation of the Godunov interface flux for the Burgers' equation from first principles and its evaluation for a specific set of initial states.\n\nThe one-dimensional scalar conservation law is given by\n$$ \\partial_{t} u(x,t) + \\partial_{x} f(u(x,t)) = 0 $$\nwith the Burgers' flux function\n$$ f(u) = \\frac{1}{2}u^{2} $$\nThe integral form of the conservation law over a control volume $V$ with boundary $\\partial V$ is\n$$ \\frac{d}{dt}\\int_{V} u \\, dx + \\int_{\\partial V} f(u)\\, \\boldsymbol{n} \\cdot d\\boldsymbol{s} = 0 $$\nwhere $\\boldsymbol{n}$ is the outward unit normal.\n\nThe Godunov method utilizes the exact solution of local Riemann problems at the cell interfaces. We consider the interface at $x = x_{i+\\frac{1}{2}}$ with piecewise constant initial data:\n$$ u(x,0) = \\begin{cases} u_{L}, & x < x_{i+\\frac{1}{2}},\\\\ u_{R}, & x > x_{i+\\frac{1}{2}}. \\end{cases} $$\nThe solution to this Riemann problem, under the CFL condition that waves do not interact with neighboring interfaces over the time step $[0, \\Delta t]$, is self-similar. This means the solution $u(x,t)$ depends only on the ratio $\\xi = (x - x_{i+\\frac{1}{2}})/t$. Let this self-similar solution be denoted by $w(\\xi)$.\n\nThe Godunov flux, $\\hat{f}(u_L, u_R)$, is defined as the time-averaged flux at the interface $x = x_{i+\\frac{1}{2}}$ over the interval $[0, \\Delta t]$. By convention, this is the flux in the positive $x$-direction, which corresponds to the flux entering the right-side control volume, $V_{i+1} = [x_{i+\\frac{1}{2}}, x_{i+\\frac{3}{2}}]$. Thus,\n$$ \\hat{f}(u_L, u_R) = \\frac{1}{\\Delta t} \\int_{0}^{\\Delta t} f(u(x_{i+\\frac{1}{2}}, t)) \\, dt $$\nSince the solution is self-similar, the state at the fixed interface location $x = x_{i+\\frac{1}{2}}$ is constant for all $t > 0$. This state is given by the self-similar solution evaluated at $\\xi=0$:\n$$ u(x_{i+\\frac{1}{2}}, t) = w(0) \\equiv u_{God} $$\nThe flux at the interface is therefore also constant, $f(u_{God})$. The time-averaged flux simplifies to:\n$$ \\hat{f}(u_L, u_R) = \\frac{1}{\\Delta t} \\int_{0}^{\\Delta t} f(u_{God}) \\, dt = f(u_{God}) $$\nThe core of the derivation is to find the state $u_{God}$ by analyzing the solution of the Riemann problem for Burgers' equation. The characteristic speed for Burgers' equation is $a(u) = f'(u) = u$. The nature of the solution depends on the relative values of $u_L$ and $u_R$.\n\n**Case 1: Shock Wave ($u_L > u_R$)**\nWhen characteristics from the left and right states converge ($a(u_L) = u_L > u_R = a(u_R)$), a discontinuity, or shock wave, forms. The speed of this shock, $s$, is determined by the Rankine-Hugoniot condition:\n$$ s = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{\\frac{1}{2}u_L^2 - \\frac{1}{2}u_R^2}{u_L - u_R} = \\frac{\\frac{1}{2}(u_L - u_R)(u_L + u_R)}{u_L - u_R} = \\frac{u_L + u_R}{2} $$\nThe solution is a step function moving with speed $s$:\n$$ u(x,t) = \\begin{cases} u_{L}, & (x - x_{i+\\frac{1}{2}})/t < s, \\\\ u_{R}, & (x - x_{i+\\frac{1}{2}})/t > s. \\end{cases} $$\nTo find $u_{God} = w(0)$, we evaluate the solution at $\\xi=0$.\n- If $s > 0$, the shock moves to the right. The region at the interface ($\\xi=0$) is to the left of the shock trajectory ($\\xi=s$). Thus, the state is $u_L$. So, $u_{God} = u_L$.\n- If $s < 0$, the shock moves to the left. The region at the interface ($\\xi=0$) is to the right of the shock trajectory. Thus, the state is $u_R$. So, $u_{God} = u_R$.\n- If $s = 0$, the shock is stationary and remains at the interface. The states $u_L$ and $u_R$ are on either side. In this case, $u_L = -u_R$. The flux is continuous across a stationary shock, $f(u_L) = f(u_R)$, so the choice is unambiguous. We can associate this with the $s>0$ case by convention.\n\nIn summary, for a shock ($u_L > u_R$):\n$$ u_{God} = \\begin{cases} u_{L}, & \\text{if } s = \\frac{u_L+u_R}{2} \\ge 0, \\\\ u_{R}, & \\text{if } s = \\frac{u_L+u_R}{2} < 0. \\end{cases} $$\nThe Godunov flux is $\\hat{f}(u_L, u_R) = f(u_{God})$.\n\n**Case 2: Rarefaction Wave ($u_L \\le u_R$)**\nWhen characteristics diverge ($a(u_L) = u_L \\le u_R = a(u_R)$), a continuous solution called a rarefaction wave forms. This wave is a fan of characteristics originating from $(x_{i+\\frac{1}{2}}, 0)$. The self-similar solution $w(\\xi)$ is:\n$$ w(\\xi) = \\begin{cases} u_{L}, & \\xi < u_L, \\\\ \\xi, & u_L \\le \\xi \\le u_R, \\\\ u_{R}, & \\xi > u_R. \\end{cases} $$\nTo find $u_{God} = w(0)$, we check the position of $\\xi=0$ relative to the characteristic fan, which spans the speeds $[u_L, u_R]$.\n- If $u_L \\le 0 \\le u_R$, the interface speed $\\xi=0$ falls within the rarefaction fan. The state is $u_{God} = w(0) = 0$.\n- If $0 < u_L (\\le u_R)$, the interface speed $\\xi=0$ is to the left of the fan. The state is $u_{God} = w(0) = u_L$.\n- If $(u_L \\le) u_R < 0$, the interface speed $\\xi=0$ is to the right of the fan. The state is $u_{God} = w(0) = u_R$.\n\nThis completes the derivation of the state $u_{God}$ from first principles. The Godunov flux is always $\\hat{f}(u_L, u_R) = f(u_{God})$.\n\n**Evaluation for Specific States**\nThe problem provides the specific states $u_L = 2$ and $u_R = -1$.\nFirst, we compare the states: $u_L = 2 > u_R = -1$. This corresponds to the shock wave case.\nNext, we calculate the shock speed $s$:\n$$ s = \\frac{u_L + u_R}{2} = \\frac{2 + (-1)}{2} = \\frac{1}{2} $$\nSince $s = \\frac{1}{2} > 0$, the shock wave propagates in the positive $x$-direction (to the right).\nAccording to our derivation, if $s > 0$, the state at the interface $x=x_{i+\\frac{1}{2}}$ is the state to the left of the shock, which is $u_L$.\nTherefore, the constant state at the interface is $u_{God} = u_L = 2$.\nThe Godunov flux, which is the time-averaged flux entering the right-side control volume, is given by $\\hat{f}(2, -1) = f(u_{God})$.\n$$ \\hat{f}(2, -1) = f(2) $$\nUsing the Burgers' flux function $f(u) = \\frac{1}{2}u^2$:\n$$ \\hat{f}(2, -1) = \\frac{1}{2}(2)^2 = \\frac{1}{2}(4) = 2 $$\nThe time-averaged flux entering the right-side control volume is exactly $2$.",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}