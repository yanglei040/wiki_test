{
    "hands_on_practices": [
        {
            "introduction": "The centered finite difference is a cornerstone for approximating derivatives in geophysical modeling. Before applying any numerical method, however, it is crucial to understand its intrinsic limitations. This exercise guides you through the fundamental process of deriving the truncation error of the central difference operator using Taylor's theorem, providing a first-principles look at the concept of numerical accuracy and its dependence on grid spacing $h$. ",
            "id": "3593422",
            "problem": "In computational geophysics, spatial gradients of material properties are often estimated on uniform grids using finite differences. Let a scalar field $f(x)$ along a one-dimensional profile be sampled at uniformly spaced points $x_i$ with grid spacing $h>0$, and suppose $f\\in C^{5}$ on an interval containing $x_i$. Consider the central difference approximation to the spatial derivative at $x_i$, defined by\n$$\nD_{c}f(x_i) \\equiv \\frac{f(x_i+h)-f(x_i-h)}{2h}.\n$$\nStarting from Taylorâ€™s theorem about $x_i$ and using only the smoothness assumptions stated, derive the leading-order truncation error of $D_c f(x_i)$ as an asymptotic series in powers of $h$. Then, identify and compute the explicit coefficient multiplying $h^{2}$ in that truncation error, expressed in terms of $f^{(3)}(x_i)$. Provide your final answer as a single closed-form analytical expression. No rounding is required.",
            "solution": "The problem requires the derivation of the truncation error for the central difference approximation of the first derivative and the identification of the coefficient of the leading-order term.\n\nLet the scalar field be denoted by $f(x)$. We are given that $f(x)$ is five times continuously differentiable, i.e., $f \\in C^5$, on an interval containing the point of interest, $x_i$. The grid spacing is a positive constant $h > 0$. The central difference operator for the first derivative is defined as:\n$$\nD_{c}f(x_i) = \\frac{f(x_i+h)-f(x_i-h)}{2h}\n$$\nThe truncation error, $\\tau(x_i, h)$, is the difference between the approximation and the exact value of the derivative, $f'(x_i)$.\n$$\n\\tau(x_i, h) = D_{c}f(x_i) - f'(x_i)\n$$\nTo find an expression for $\\tau(x_i, h)$, we use Taylor's theorem to expand the functions $f(x_i+h)$ and $f(x_i-h)$ around the point $x_i$. The given condition $f \\in C^5$ ensures that the Taylor series expansions are valid.\n\nThe Taylor expansion of $f(x_i+h)$ about $x_i$ is:\n$$\nf(x_i+h) = f(x_i) + h f'(x_i) + \\frac{h^2}{2!} f''(x_i) + \\frac{h^3}{3!} f^{(3)}(x_i) + \\frac{h^4}{4!} f^{(4)}(x_i) + O(h^5)\n$$\nSimilarly, the Taylor expansion of $f(x_i-h)$ about $x_i$ is:\n$$\nf(x_i-h) = f(x_i) - h f'(x_i) + \\frac{h^2}{2!} f''(x_i) - \\frac{h^3}{3!} f^{(3)}(x_i) + \\frac{h^4}{4!} f^{(4)}(x_i) + O(h^5)\n$$\nNext, we compute the difference $f(x_i+h) - f(x_i-h)$:\n$$\nf(x_i+h) - f(x_i-h) = 2h f'(x_i) + 2 \\frac{h^3}{3!} f^{(3)}(x_i) + 2 \\frac{h^5}{5!} f^{(5)}(x_i) + O(h^7)\n$$\n$$\nf(x_i+h) - f(x_i-h) = 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + O(h^7)\n$$\nIn this subtraction, all terms with even-order derivatives cancel, while terms with odd-order derivatives are doubled.\n\nNow, we substitute this back into the definition of $D_c f(x_i)$:\n$$\nD_c f(x_i) = \\frac{1}{2h} \\left( 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + O(h^7) \\right)\n$$\nDistributing the $\\frac{1}{2h}$ factor, we get:\n$$\nD_c f(x_i) = f'(x_i) + \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + O(h^6)\n$$\nThis expression shows that the central difference operator approximates the true derivative $f'(x_i)$ plus a series of error terms in even powers of $h$.\n\nThe truncation error $\\tau(x_i, h)$ is then found by subtracting $f'(x_i)$:\n$$\n\\tau(x_i, h) = D_c f(x_i) - f'(x_i) = \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + O(h^6)\n$$\nThis is the asymptotic series for the truncation error. The leading-order truncation error is the first term, $\\frac{h^2}{6} f^{(3)}(x_i)$. The order of accuracy of the method is the power of $h$ in this leading term, which is $2$.\n\nThe problem asks for the explicit coefficient multiplying $h^2$ in the truncation error. From the derived asymptotic series for $\\tau(x_i, h)$, this is $\\frac{1}{6} f^{(3)}(x_i)$.",
            "answer": "$$\\boxed{\\frac{f^{(3)}(x_i)}{6}}$$"
        },
        {
            "introduction": "While local truncation error tells part of the story, the global behavior of a numerical scheme, especially its interaction with different wavenumbers, is critical for stability. In geophysical simulations, high-frequency numerical artifacts can grow uncontrollably and destroy the solution. This practice introduces the powerful technique of discrete Fourier analysis to reveal how a high-order artificial dissipation operator works, showing precisely how it targets and damps the most problematic grid-scale oscillations while preserving the underlying physical signal. ",
            "id": "3593444",
            "problem": "Consider a one-dimensional uniform spatial grid with spacing $h$ and grid indices $j \\in \\mathbb{Z}$. Let $u_j(t)$ denote the discrete field sampled at grid points. To control grid-scale oscillations in explicit finite difference discretizations commonly used in computational geophysics, a high-order artificial dissipation operator is added to the semi-discrete evolution equation. Define the dissipation operator of order $2p$ as\n$$\nQ_p[u]_j \\equiv \\epsilon \\, (-1)^{p+1} \\, h^{2p-1} \\, D^{(2p)} u_j,\n$$\nwhere $\\epsilon > 0$ is a constant, $p \\in \\mathbb{N}$, and $D^{(2p)}$ denotes the centered $2p$-th finite difference operator realized by repeated application of the centered second difference operator\n$$\nD^{(2)} u_j \\equiv \\frac{u_{j+1} - 2 u_j + u_{j-1}}{h^2}.\n$$\nConsider the semi-discrete ordinary differential equation $u_t = Q_p[u]$ and assume a discrete Fourier mode $u_j(t) = \\hat{u}(t) \\exp(i \\kappa j h)$ with wavenumber $\\kappa \\in \\mathbb{R}$, $|\\kappa| \\leq \\pi/h$. Using discrete Fourier (von Neumann) analysis from first principles, derive the damping factor in Fourier space after a single time interval $\\Delta t > 0$ under exact time integration of the semi-discrete system. Show that the dissipation strictly damps nonzero modes and that the maximum damping occurs at the Nyquist wavenumber $\\kappa_N = \\pi/h$, thereby suppressing spurious Nyquist modes.\n\nProvide your final answer as the closed-form expression for the damping factor $G(\\kappa_N)$ after one interval $\\Delta t$. No rounding is required. The final answer must be a single analytic expression.",
            "solution": "The objective is to analyze the semi-discrete equation $u_t = Q_p[u]$ using von Neumann analysis. We substitute the discrete Fourier mode $u_j(t) = \\hat{u}(t) \\exp(i \\kappa j h)$ into the equation.\n\nThe left-hand side (LHS) of the equation becomes:\n$$\n\\frac{d}{dt} u_j(t) = \\frac{d}{dt} \\left( \\hat{u}(t) \\exp(i \\kappa j h) \\right) = \\frac{d\\hat{u}}{dt} \\exp(i \\kappa j h).\n$$\n\nFor the right-hand side (RHS), we find the action of the operator $Q_p$ on the Fourier mode. This requires finding the Fourier symbol of the operator $D^{(2p)}$. We begin with the second-difference operator $D^{(2)}$:\n$$\nD^{(2)} u_j = \\frac{u_{j+1} - 2 u_j + u_{j-1}}{h^2} = \\frac{\\hat{u}(t) \\exp(i\\kappa(j+1)h) - 2 \\hat{u}(t) \\exp(i\\kappa j h) + \\hat{u}(t) \\exp(i\\kappa(j-1)h)}{h^2}.\n$$\nFactoring out $u_j(t) = \\hat{u}(t) \\exp(i \\kappa j h)$:\n$$\nD^{(2)} u_j = \\frac{u_j(t)}{h^2} \\left[ \\exp(i\\kappa h) - 2 + \\exp(-i\\kappa h) \\right] = \\frac{u_j(t)}{h^2} \\left( 2 \\cos(\\kappa h) - 2 \\right).\n$$\nUsing the identity $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$, we get:\n$$\nD^{(2)} u_j = \\frac{-2}{h^2} (1 - \\cos(\\kappa h)) u_j(t) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\kappa h}{2}\\right) u_j(t).\n$$\nThe operator $D^{(2p)}$ is the $p$-th power of $D^{(2)}$. Applying it to the Fourier mode yields the $p$-th power of the eigenvalue:\n$$\nD^{(2p)} u_j = \\left( D^{(2)} \\right)^p u_j = \\left[ -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\kappa h}{2}\\right) \\right]^p u_j(t) = (-1)^p \\frac{2^{2p}}{h^{2p}} \\sin^{2p}\\left(\\frac{\\kappa h}{2}\\right) u_j(t).\n$$\nNow, we substitute this into the definition of the dissipation operator $Q_p[u]_j$:\n$$\nQ_p[u]_j = \\epsilon \\, (-1)^{p+1} \\, h^{2p-1} \\left[ (-1)^p \\frac{2^{2p}}{h^{2p}} \\sin^{2p}\\left(\\frac{\\kappa h}{2}\\right) \\right] u_j(t).\n$$\nCombining terms, since $(-1)^{p+1}(-1)^p = (-1)^{2p+1} = -1$ and $h^{2p-1}/h^{2p} = 1/h$:\n$$\nQ_p[u]_j = -\\frac{\\epsilon \\, 2^{2p}}{h} \\sin^{2p}\\left(\\frac{\\kappa h}{2}\\right) u_j(t).\n$$\nEquating the LHS and RHS for the Fourier mode, we obtain an ODE for the Fourier amplitude $\\hat{u}(t)$:\n$$\n\\frac{d\\hat{u}}{dt} = \\lambda(\\kappa) \\hat{u}(t), \\quad \\text{where} \\quad \\lambda(\\kappa) = -\\frac{\\epsilon \\, 2^{2p}}{h} \\sin^{2p}\\left(\\frac{\\kappa h}{2}\\right).\n$$\nWith exact time integration, the solution is $\\hat{u}(t) = \\hat{u}(0) \\exp(\\lambda(\\kappa) t)$. The damping factor, $G(\\kappa)$, is the ratio $\\hat{u}(\\Delta t) / \\hat{u}(0)$:\n$$\nG(\\kappa) = \\exp(\\lambda(\\kappa) \\Delta t) = \\exp\\left( -\\frac{\\epsilon \\, 2^{2p} \\Delta t}{h} \\sin^{2p}\\left(\\frac{\\kappa h}{2}\\right) \\right).\n$$\nThis factor strictly damps nonzero modes, as for $\\kappa \\neq 0$ in the range $|\\kappa| \\le \\pi/h$, the term $\\sin^{2p}(\\kappa h/2) > 0$, making the exponent negative and thus $G(\\kappa)  1$. Maximum damping occurs when $\\sin^{2p}(\\kappa h/2)$ is maximized, which is at the Nyquist wavenumber $\\kappa_N = \\pi/h$, where $\\sin(\\kappa_N h / 2) = \\sin(\\pi/2) = 1$.\n\nFinally, we find the damping factor at this Nyquist wavenumber, $G(\\kappa_N)$:\n$$\nG(\\kappa_N) = \\exp\\left( -\\frac{\\epsilon \\, 2^{2p} \\Delta t}{h} \\sin^{2p}\\left(\\frac{\\pi}{2}\\right) \\right) = \\exp\\left( -\\frac{\\epsilon \\, 2^{2p} \\Delta t}{h} \\right).\n$$",
            "answer": "$$\n\\boxed{\\exp\\left(-\\frac{\\epsilon 2^{2p} \\Delta t}{h}\\right)}\n$$"
        },
        {
            "introduction": "The ultimate goal of this theoretical knowledge is to make informed practical decisions. In the real world, data is never perfectly smooth and is always contaminated by noise. This exercise synthesizes the concepts of accuracy and spectral properties into a realistic design challenge: selecting the optimal finite difference operator for seismic data processing. You will learn to navigate the fundamental trade-off between maximizing resolution for the signal and minimizing the amplification of high-frequency noise, a core skill in computational geophysics. ",
            "id": "3593473",
            "problem": "A one-dimensional seismic profile $s(x)$ is sampled uniformly at spacing $\\Delta x = 10\\,\\mathrm{m}$. You wish to compute the spatial derivative $\\partial s/\\partial x$ along $x$ to estimate reflector dips. The seismic signal is known (from processing and acquisition design) to be band-limited such that its spatial wavenumber content is negligible above $k_s = \\frac{\\pi}{2\\Delta x}$, corresponding to a smallest wavelength $\\lambda_{\\min} = 4\\Delta x = 40\\,\\mathrm{m}$. Additive noise can be modeled as stationary white noise that is spectrally flat up to the Nyquist wavenumber $k_N = \\frac{\\pi}{\\Delta x}$.\n\nYou will approximate $\\partial s/\\partial x$ by a centered finite-difference stencil of formal accuracy order $p \\in \\{2,4,6,8\\}$. Assume standard centered antisymmetric stencils are used for each $p$, and consider their action on the discrete spectrum via the symbol (transfer function) in wavenumber space. Your goal is to balance resolution (faithful differentiation of the highest signal wavenumber) and robustness (limiting amplification of near-Nyquist noise), guided by first principles of Fourier analysis of linear shift-invariant operators.\n\nFor design, impose both of the following constraints:\n1) Resolution: At the highest relevant signal wavenumber $k_s$, i.e., at $\\theta_t = k_s \\Delta x = \\frac{\\pi}{2}$, the magnitude response of the discrete derivative should approximate the ideal continuous derivative magnitude $|k_s|$ within $10\\%$, i.e., the relative error at $\\theta_t$ must be $\\le 10\\%$.\n2) Robustness: At a representative high-frequency point in the noise-dominated band, $\\theta_h = 0.9\\pi$, the magnitude of the discrete derivative operator must satisfy $|H(\\theta_h)| \\le \\frac{0.75}{\\Delta x}$ to avoid excessive noise amplification.\n\nWhich choice of formal accuracy order $p$ best satisfies both constraints?\n\nA. $p=2$ (second-order centered difference)\n\nB. $p=4$ (fourth-order centered difference)\n\nC. $p=6$ (sixth-order centered difference)\n\nD. $p=8$ (eighth-order centered difference)",
            "solution": "The analysis is performed in the normalized wavenumber domain, where $\\theta = k \\Delta x$. The ideal derivative operator has a normalized magnitude response of $\\tilde{H}_{ideal}(\\theta) = \\theta$. A centered finite-difference operator has a normalized magnitude response $\\tilde{H}_p(\\theta)$.\n\nThe normalized magnitude responses for the specified orders $p$ are:\n*   **p=2:** $\\tilde{H}_2(\\theta) = \\sin(\\theta)$\n*   **p=4:** $\\tilde{H}_4(\\theta) = \\frac{4}{3}\\sin(\\theta) - \\frac{1}{6}\\sin(2\\theta)$\n*   **p=6:** $\\tilde{H}_6(\\theta) = \\frac{3}{2}\\sin(\\theta) - \\frac{3}{10}\\sin(2\\theta) + \\frac{1}{30}\\sin(3\\theta)$\n*   **p=8:** $\\tilde{H}_8(\\theta) = \\frac{8}{5}\\sin(\\theta) - \\frac{2}{5}\\sin(2\\theta) + \\frac{8}{105}\\sin(3\\theta) - \\frac{1}{140}\\sin(4\\theta)$\n\nWe evaluate the two constraints for each order $p$.\n\n**Constraint 1: Resolution**\nThe constraint is on the relative error at the maximum signal wavenumber, $\\theta_t = \\frac{\\pi}{2}$.\n$$ \\text{Relative Error} = \\left| \\frac{\\tilde{H}_p(\\pi/2) - \\pi/2}{\\pi/2} \\right| \\le 0.10 $$\nThe ideal value is $\\tilde{H}_{ideal}(\\pi/2) = \\frac{\\pi}{2} \\approx 1.5708$.\n*   $p=2: \\tilde{H}_2(\\pi/2) = 1$. Error $\\approx 36.3\\%$. Fails.\n*   $p=4: \\tilde{H}_4(\\pi/2) \\approx 1.3333$. Error $\\approx 15.1\\%$. Fails.\n*   $p=6: \\tilde{H}_6(\\pi/2) \\approx 1.4667$. Error $\\approx 6.6\\%$. **Passes**.\n*   $p=8: \\tilde{H}_8(\\pi/2) \\approx 1.5238$. Error $\\approx 3.0\\%$. **Passes**.\n\nOnly orders $p=6$ and $p=8$ are acceptable based on the resolution constraint.\n\n**Constraint 2: Robustness**\nThe constraint is on the operator's magnitude at a high noise frequency, $\\theta_h = 0.9\\pi$.\n$$ |H_{eff}(\\theta_h)| = \\frac{\\tilde{H}_p(\\theta_h)}{\\Delta x} \\le \\frac{0.75}{\\Delta x} \\implies \\tilde{H}_p(0.9\\pi) \\le 0.75 $$\n*   $p=2: \\tilde{H}_2(0.9\\pi) \\approx 0.309$. **Passes**.\n*   $p=4: \\tilde{H}_4(0.9\\pi) \\approx 0.510$. **Passes**.\n*   $p=6: \\tilde{H}_6(0.9\\pi) \\approx 0.613$. **Passes**.\n*   $p=8: \\tilde{H}_8(0.9\\pi) \\approx 0.675$. **Passes**.\n\nAll four orders satisfy the robustness constraint.\n\n**Synthesizing and Selecting the Best Option**\nAn operator must pass both constraints.\n*   $p=2$: Fails Constraint 1.\n*   $p=4$: Fails Constraint 1.\n*   $p=6$: Passes both constraints.\n*   $p=8$: Passes both constraints.\n\nWe must choose between $p=6$ and $p=8$. The problem asks for the choice that *best* satisfies the constraints, which implies applying a design principle like parsimony. The $p=6$ operator is the lowest-order (simplest, least computationally expensive) model that meets all specifications. It provides the necessary resolution while keeping high-frequency noise amplification well below the limit, representing a balanced and efficient design.\n\n*   **A. $p=2$ (second-order centered difference):** Fails the resolution constraint.\n*   **B. $p=4$ (fourth-order centered difference):** Fails the resolution constraint.\n*   **C. $p=6$ (sixth-order centered difference):** This is the lowest-order operator that satisfies both the resolution and robustness constraints, representing the most balanced and efficient choice.\n*   **D. $p=8$ (eighth-order centered difference):** While it also satisfies both constraints and offers better resolution, it is more complex and less parsimonious than the $p=6$ option. Therefore, $p=6$ is the better choice.",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}