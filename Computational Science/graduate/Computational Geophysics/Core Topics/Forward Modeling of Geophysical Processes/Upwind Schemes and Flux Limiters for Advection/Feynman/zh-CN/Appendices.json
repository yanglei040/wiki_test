{
    "hands_on_practices": [
        {
            "introduction": "一阶迎风格式是求解平流方程最基础的数值方法。然而，任何显式时间推进格式的成功应用都取决于其数值稳定性。本练习将指导你通过冯·诺依曼稳定性分析，推导出该格式的稳定性约束——即著名的 Courant-Friedrichs-Lewy (CFL) 条件，这是理解和实现双曲型方程数值解法的一个基本出发点。",
            "id": "3618319",
            "problem": "地球物理流中的一维被动示踪剂由线性平流方程 $u_{t} + a\\,u_{x} = 0$ 建模，其中波速 $a0$ 为常数。考虑一个间距为 $\\Delta x$ 的均匀空间网格，并使用前向欧拉法进行显式时间推进。对于 $a0$，一阶迎风空间离散化使用左偏倚差分。假设一个空间周期性域，以便傅里叶模态是可接受的。\n\n从连续方程以及由时间上的前向欧拉法和空间上的一阶迎风法得到的离散更新出发，分析单个傅里叶模态的放大情况，并推导时间步长 $\\Delta t$ 必须满足的稳定性要求，以使数值解对所有波数都保持有界。然后，使用推导出的条件，计算当 $a = 1$ m/s 和 $\\Delta x = 100$ m 时的最大允许时间步长。用秒表示最终的时间步长，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导应用于线性平流方程的数值格式的稳定性条件，并随后为给定参数计算最大允许时间步长。\n\n控制偏微分方程 (PDE) 是一维线性平流方程：\n$$ u_t + a u_x = 0 $$\n其中 $u(x, t)$ 是被动示踪剂在位置 $x$ 和时间 $t$ 的浓度，$a$ 是恒定波速，给定 $a  0$。\n\n我们在一个均匀网格上离散化该方程，其中 $x_j = j \\Delta x$ 且 $t^n = n \\Delta t$。令 $u_j^n$ 表示 $u(x_j, t^n)$ 的数值近似。\n\n时间导数 $u_t$ 使用显式前向欧拉法离散化：\n$$ u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t} $$\n空间导数 $u_x$ 使用一阶迎风格式离散化。由于波速 $a$ 为正 ($a0$)，“迎风”方向是向左（$x$ 减小的方向）。这对应于一阶后向差分：\n$$ u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x} $$\n将这些离散近似代入偏微分方程，得到有限差分方程：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) = 0 $$\n我们可以重新整理这个方程，以求解下一个时间步的解 $u_j^{n+1}$：\n$$ u_j^{n+1} = u_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( u_j^n - u_{j-1}^n \\right) $$\n通常将库朗数（Courant number） $C$ 定义为以下无量纲比率：\n$$ C = \\frac{a \\Delta t}{\\Delta x} $$\n使用库朗数，更新格式变为：\n$$ u_j^{n+1} = u_j^n - C (u_j^n - u_{j-1}^n) = (1 - C) u_j^n + C u_{j-1}^n $$\n为了分析此格式的稳定性，我们进行 von Neumann 稳定性分析。我们考虑解的单个傅里叶模态的行为，其形式可以写为：\n$$ u_j^n = \\hat{u}^n(k) e^{i k x_j} $$\n其中 $k$ 是波数，$i = \\sqrt{-1}$，$\\hat{u}^n(k)$ 是在时间步 $n$ 的模态振幅。将此代入离散方程，得到：\n$$ \\hat{u}^{n+1} e^{i k x_j} = (1 - C) \\hat{u}^n e^{i k x_j} + C \\hat{u}^n e^{i k x_{j-1}} $$\n由于 $x_{j-1} = x_j - \\Delta x$，我们有 $e^{i k x_{j-1}} = e^{i k (x_j - \\Delta x)} = e^{i k x_j} e^{-i k \\Delta x}$。将此代入并将整个方程除以公因子 $e^{i k x_j}$（它不为零），我们得到：\n$$ \\hat{u}^{n+1} = (1 - C) \\hat{u}^n + C \\hat{u}^n e^{-i k \\Delta x} $$\n放大因子 $G(k)$ 定义为连续时间步长上振幅的比率，$G(k) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n}$：\n$$ G(k) = 1 - C + C e^{-i k \\Delta x} $$\n为使数值格式稳定，对于任何波数 $k$，放大因子的模都不得超过1。即 $|G(k)| \\le 1$。\n我们来分析 $G(k)$ 的模。使用欧拉公式 $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$，其中 $\\theta = k \\Delta x$：\n$$ G(k) = (1 - C) + C (\\cos(k \\Delta x) - i \\sin(k \\Delta x)) $$\n$$ G(k) = [1 - C + C \\cos(k \\Delta x)] - i [C \\sin(k \\Delta x)] $$\n$G(k)$ 的模的平方是其实部和虚部平方的和：\n$$ |G(k)|^2 = [1 - C + C \\cos(k \\Delta x)]^2 + [-C \\sin(k \\Delta x)]^2 $$\n$$ |G(k)|^2 = (1-C)^2 + 2C(1-C)\\cos(k\\Delta x) + C^2\\cos^2(k\\Delta x) + C^2\\sin^2(k\\Delta x) $$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$ |G(k)|^2 = (1-C)^2 + 2C(1-C)\\cos(k\\Delta x) + C^2 $$\n$$ |G(k)|^2 = (1 - 2C + C^2) + 2C\\cos(k\\Delta x) - 2C^2\\cos(k\\Delta x) + C^2 $$\n$$ |G(k)|^2 = 1 - 2C + 2C^2 + (2C - 2C^2)\\cos(k\\Delta x) $$\n$$ |G(k)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos(k\\Delta x) = 1 + 2C(1-C)(\\cos(k\\Delta x) - 1) $$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到 $\\cos(k\\Delta x) - 1 = -2\\sin^2(k\\Delta x/2)$。\n$$ |G(k)|^2 = 1 - 4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\n稳定性条件是 $|G(k)|^2 \\le 1$。将此应用于我们的表达式：\n$$ 1 - 4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 1 $$\n$$ -4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 0 $$\n$$ C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\ge 0 $$\n对于任何实数 $k$ 和 $\\Delta x$，项 $\\sin^2\\left(\\frac{k\\Delta x}{2}\\right)$ 总是非负的。库朗数 $C = \\frac{a \\Delta t}{\\Delta x}$ 也是非负的，因为 $a  0$、$\\Delta t  0$ 和 $\\Delta x  0$。因此，为使不等式成立，我们必须有：\n$$ 1 - C \\ge 0 \\implies C \\le 1 $$\n因此，对于采用前向欧拉时间步进的一阶迎风格式，稳定性要求是 $0 \\le C \\le 1$。这就是此特定格式的 Courant-Friedrichs-Lewy (CFL) 条件。\n$$ \\frac{a \\Delta t}{\\Delta x} \\le 1 $$\n这意味着时间步长 $\\Delta t$ 必须满足：\n$$ \\Delta t \\le \\frac{\\Delta x}{a} $$\n当等式成立时，获得最大允许时间步长 $\\Delta t_{\\text{max}}$：\n$$ \\Delta t_{\\text{max}} = \\frac{\\Delta x}{a} $$\n问题给出了以下数值：\n$$ a = 1 \\text{ m/s} $$\n$$ \\Delta x = 100 \\text{ m} $$\n将这些值代入最大时间步长的表达式中：\n$$ \\Delta t_{\\text{max}} = \\frac{100 \\text{ m}}{1 \\text{ m/s}} = 100 \\text{ s} $$\n问题要求答案以秒表示，并四舍五入到四位有效数字。计算出的值恰好是 $100$。为了用四位有效数字表示，我们将其写为 $100.0$。",
            "answer": "$$\n\\boxed{100.0}\n$$"
        },
        {
            "introduction": "虽然一阶迎风格式是稳定的，但其固有的数值耗散会使解的轮廓变得模糊。为了在抑制振荡的同时获得更高的精度，我们引入了带有通量限制器的高分辨率格式。本练习提供了一个具体算例，让你亲手实践如何应用 MUSCL (Monotone Upstream-centered Schemes for Conservation Laws) 方法和 van Leer 限制器，从计算斜率比 $r$ 到重构界面值，最终更新单元平均值，从而全面掌握高分辨率格式的计算流程。",
            "id": "3618311",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，该方程描述了在一个计算地球物理学背景下，一个无量纲被动示踪剂 $u(x,t)$ 如何被一个恒定正速度 $a0$ 沿着一条直线样带平流。假设在均匀网格上采用一种保守有限体积半离散格式，其中单元平均值 $u_{i}(t)$ 位于单元中心 $x_{i}$，单元尺寸为 $\\Delta x$，并使用显式时间步长 $\\Delta t$ 进行时间推进。\n\n从守恒律和一个与 $a0$ 一致的迎风 Godunov 通量出发，采用一个二阶守恒律的单调上游中心格式 (Monotone Upstream-centered Schemes for Conservation Laws, MUSCL) 的分段线性重构，并使用总变差递减通量限制器。使用由下式定义的 van Leer 限制器：\n$$\n\\phi(r) = \\frac{r + |r|}{1 + |r|}.\n$$\n通过以下比率定义单元 $i$ 处的局部光滑度指示器：\n$$\nr_{i} = \\frac{u_{i}^{n} - u_{i-1}^{n}}{u_{i+1}^{n} - u_{i}^{n}},\n$$\n并使用 $\\phi(r_{i})$ 在单元 $i$ 中构造一个受限斜率。对于 $a0$，从单元 $i$ 重构界面 $x_{i+1/2}$ 处的左状态，类似地，从单元 $i-1$ 重构 $x_{i-1/2}$ 处的左状态，然后通过保守通量差分更新 $u_{i}$。\n\n给定在时间层 $n$ 的以下数值上合理的数据：\n- 平流速度 $a = 1.5$，\n- 网格间距 $\\Delta x = 10$，\n- 时间步长 $\\Delta t = 4$，\n- 相邻单元平均值 $u_{i-2}^{n} = 0.80$, $u_{i-1}^{n} = 1.00$, $u_{i}^{n} = 1.10$, $u_{i+1}^{n} = 0.90$，\n\n从第一性原理出发，推导由 MUSCL 策略和 van Leer 限制器所隐含的有限体积界面重构，计算 $r_{i}$ 和控制界面 $x_{i+1/2}$ (对于 $a0$) 的受限斜率，构建迎风数值通量，并对 $u_{i}$ 执行一次显式更新以获得 $u_{i}^{n+1}$。将最终更新后的值 $u_{i}^{n+1}$ 报告为一个不带单位的纯数字。如果选择近似，请将答案四舍五入到六位有效数字；否则，请提供精确值。",
            "solution": "该问题要求使用二阶 MUSCL 有限体积格式计算线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的更新后单元平均值 $u_{i}^{n+1}$。\n\n有限体积法根据保守半离散形式更新单元平均值 $u_i$：\n$$\n\\frac{d u_i}{dt} = -\\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2})\n$$\n其中 $F_{i \\pm 1/2}$ 是单元界面 $x_{i \\pm 1/2}$ 处的数值通量。使用显式前向欧拉时间步长 $\\Delta t$，全离散更新格式为：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2}^n - F_{i-1/2}^n)\n$$\n物理通量函数为 $f(u) = a u$。由于平流速度 $a  0$，信息从左向右传播。界面处的迎风 Godunov 通量由界面左侧的状态决定，记为 $u^L$。因此，数值通量为：\n$$\nF_{i+1/2}^n = f(u_{i+1/2}^L) = a u_{i+1/2}^L\n$$\n$$\nF_{i-1/2}^n = f(u_{i-1/2}^L) = a u_{i-1/2}^L\n$$\n将这些代入更新公式，得到：\n$$\nu_i^{n+1} = u_i^n - \\frac{a \\Delta t}{\\Delta x} (u_{i+1/2}^L - u_{i-1/2}^L)\n$$\n项 $C = \\frac{a \\Delta t}{\\Delta x}$ 是库朗数。\n\nMUSCL (守恒律的单调上游中心格式) 方法通过在时间 $t^n$ 的每个单元内重构分段线性解来实现二阶精度。在一个通用单元 $j$ 中，解被近似为：\n$$\nu(x) = u_j^n + s_j (x - x_j) = u_j^n + \\frac{\\sigma_j}{\\Delta x} (x - x_j)\n$$\n其中 $x_j$ 是单元 $j$ 的中心，$s_j$ 是斜率，$\\sigma_j = s_j \\Delta x$ 是单元内受限的变差。\n\n迎风状态 $u_{i+1/2}^L$ 是单元 $i$ 右边界上的值，使用单元 $i$ 的数据重构得到：\n$$\nu_{i+1/2}^L = u(x_{i+1/2}) = u_i^n + \\frac{\\sigma_i}{\\Delta x}(x_{i+1/2} - x_i) = u_i^n + \\frac{\\sigma_i}{\\Delta x}\\left(\\frac{\\Delta x}{2}\\right) = u_i^n + \\frac{1}{2}\\sigma_i\n$$\n类似地，迎风状态 $u_{i-1/2}^L$ 是单元 $i-1$ 右边界上的值，使用单元 $i-1$ 的数据重构得到：\n$$\nu_{i-1/2}^L = u(x_{i-1/2}) = u_{i-1}^n + \\frac{\\sigma_{i-1}}{\\Delta x}(x_{i-1/2} - x_{i-1}) = u_{i-1}^n + \\frac{\\sigma_{i-1}}{\\Delta x}\\left(\\frac{\\Delta x}{2}\\right) = u_{i-1}^n + \\frac{1}{2}\\sigma_{i-1}\n$$\n\n为了保持稳定性并防止伪振荡，变差 $\\sigma_j$ 受到限制。该问题指定使用 van Leer 通量限制器。受限变差 $\\sigma_j$ 是使用光滑度指示器 $r_j$ 和限制器函数 $\\phi(r)$ 构造的：\n$$\nr_j = \\frac{u_j^n - u_{j-1}^n}{u_{j+1}^n - u_j^n}\n$$\n$$\n\\phi(r) = \\frac{r + |r|}{1 + |r|}\n$$\n单元 $j$ 内的受限变差计算为 $\\sigma_j = \\phi(r_j)(u_{j+1}^n - u_j^n)$。\n\n现在，我们将此框架应用于给定数据：\n- 平流速度：$a = 1.5$\n- 网格间距：$\\Delta x = 10$\n- 时间步长：$\\Delta t = 4$\n- 单元平均值：$u_{i-2}^{n} = 0.80$, $u_{i-1}^{n} = 1.00$, $u_{i}^{n} = 1.10$, $u_{i+1}^{n} = 0.90$\n\n首先，我们计算库朗数：\n$$\nC = \\frac{a \\Delta t}{\\Delta x} = \\frac{1.5 \\times 4}{10} = \\frac{6}{10} = 0.6\n$$\n更新方程为 $u_i^{n+1} = u_i^n - 0.6(u_{i+1/2}^L - u_{i-1/2}^L)$。为了继续，我们必须计算 $u_{i+1/2}^L$ 和 $u_{i-1/2}^L$，这需要求出 $\\sigma_i$ 和 $\\sigma_{i-1}$。\n\n步骤1：计算单元 $i$ 的光滑度指示器 $r_i$。\n所需的差值为：\n$$\nu_i^n - u_{i-1}^n = 1.10 - 1.00 = 0.10\n$$\n$$\nu_{i+1}^n - u_i^n = 0.90 - 1.10 = -0.20\n$$\n所以，光滑度指示器是：\n$$\nr_i = \\frac{0.10}{-0.20} = -0.5\n$$\n\n步骤2：计算受限变差 $\\sigma_i$ 和受限斜率 $s_i$。\n应用 van Leer 限制器函数 $\\phi(r_i)$：\n$$\n\\phi(r_i) = \\phi(-0.5) = \\frac{-0.5 + |-0.5|}{1 + |-0.5|} = \\frac{-0.5 + 0.5}{1 + 0.5} = \\frac{0}{1.5} = 0\n$$\n单元 $i$ 内的受限变差为：\n$$\n\\sigma_i = \\phi(r_i) (u_{i+1}^n - u_i^n) = 0 \\times (-0.20) = 0\n$$\n单元 $i$ 内的受限斜率 $s_i = \\sigma_i / \\Delta x = 0 / 10 = 0$，它控制着界面 $x_{i+1/2}$ 的重构。零斜率表示单元 $i$ 内的重构是分段常数，这是 TVD 格式在 $u_i^n$ 处检测到局部极值的结果。\n\n步骤3：计算单元 $i-1$ 的光滑度指示器 $r_{i-1}$。\n所需的差值为：\n$$\nu_{i-1}^n - u_{i-2}^n = 1.00 - 0.80 = 0.20\n$$\n$$\nu_i^n - u_{i-1}^n = 1.10 - 1.00 = 0.10\n$$\n所以，单元 $i-1$ 的光滑度指示器是：\n$$\nr_{i-1} = \\frac{0.20}{0.10} = 2\n$$\n\n步骤4：计算受限变差 $\\sigma_{i-1}$。\n应用 van Leer 限制器函数 $\\phi(r_{i-1})$：\n$$\n\\phi(r_{i-1}) = \\phi(2) = \\frac{2 + |2|}{1 + |2|} = \\frac{2+2}{1+2} = \\frac{4}{3}\n$$\n单元 $i-1$ 内的受限变差为：\n$$\n\\sigma_{i-1} = \\phi(r_{i-1}) (u_i^n - u_{i-1}^n) = \\frac{4}{3} \\times (0.10) = \\frac{4}{3} \\times \\frac{1}{10} = \\frac{4}{30} = \\frac{2}{15}\n$$\n\n步骤5：重构界面状态 $u_{i+1/2}^L$ 和 $u_{i-1/2}^L$。\n$$\nu_{i+1/2}^L = u_i^n + \\frac{1}{2}\\sigma_i = 1.10 + \\frac{1}{2}(0) = 1.10\n$$\n$$\nu_{i-1/2}^L = u_{i-1}^n + \\frac{1}{2}\\sigma_{i-1} = 1.00 + \\frac{1}{2}\\left(\\frac{2}{15}\\right) = 1 + \\frac{1}{15} = \\frac{16}{15}\n$$\n\n步骤6：计算最终更新值 $u_i^{n+1}$。\n将重构的状态和库朗数代入更新公式：\n$$\nu_i^{n+1} = u_i^n - C (u_{i+1/2}^L - u_{i-1/2}^L)\n$$\n$$\nu_i^{n+1} = 1.10 - 0.6 \\left( 1.10 - \\frac{16}{15} \\right)\n$$\n为了保持精度，我们使用分数进行计算：$1.10 = \\frac{11}{10}$ 和 $0.6 = \\frac{6}{10} = \\frac{3}{5}$。\n$$\nu_i^{n+1} = \\frac{11}{10} - \\frac{3}{5} \\left( \\frac{11}{10} - \\frac{16}{15} \\right)\n$$\n为括号内的项找到公分母：\n$$\n\\frac{11}{10} - \\frac{16}{15} = \\frac{11 \\times 3}{30} - \\frac{16 \\times 2}{30} = \\frac{33 - 32}{30} = \\frac{1}{30}\n$$\n现在代回：\n$$\nu_i^{n+1} = \\frac{11}{10} - \\frac{3}{5} \\left( \\frac{1}{30} \\right) = \\frac{11}{10} - \\frac{3}{150} = \\frac{11}{10} - \\frac{1}{50}\n$$\n最后，计算结果：\n$$\nu_i^{n+1} = \\frac{11 \\times 5}{50} - \\frac{1}{50} = \\frac{55 - 1}{50} = \\frac{54}{50} = \\frac{27}{25}\n$$\n作为小数，这个精确值是 $1.08$。",
            "answer": "$$\n\\boxed{1.08}\n$$"
        },
        {
            "introduction": "通量限制器的选择直接决定了数值格式的性能，影响着解的锐利度和光滑度。本练习将深入探讨总变差递减 (TVD) 属性的理论核心，它为我们设计无振荡的高分辨率格式提供了数学保证。通过分析 Superbee 限制器与 TVD 区域边界的关系，你将理解一个限制器的数学形式如何转化为其独特的数值行为，例如在锐化间断与产生“阶梯状”伪影之间的权衡。",
            "id": "3618340",
            "problem": "考虑一种被动地球物理示踪剂的一维线性平流，其由偏微分方程 $u_{t} + a\\,u_{x} = 0$ 描述，其中平流速度 $a0$ 为常数。在间距为 $\\Delta x$ 的均匀网格上采用有限体积离散化，并使用满足 $0  \\nu \\le 1$ 的显式时间步长 $\\Delta t$，其中 $\\nu = a\\,\\Delta t/\\Delta x$ 是库朗数。使用高分辨率的守恒律单调上游中心格式 (MUSCL) 重构，并将一个通量限制器函数 $\\phi(r)$ 应用于受限斜率，其中光滑度指示器 $r$ 在单元 $i$ 定义为 $r_i = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i}$。\n\n从总变差的定义和离散更新的总变差递减 (TVD) 要求 $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^{n})$ 出发，推导在 TVD 约束下，对于 $r \\ge 0$ 时限制器 $\\phi(r)$ 的容许上界 $\\Phi_{\\mathrm{UB}}(r)$。然后，仅使用从这些 TVD 约束以及限制器在保持 TVD 的同时应具有最大压缩性这一要求所引出的原理，确定对于哪些 $r \\ge 0$ 的值，所谓的“superbee”限制器会达到 TVD 上界饱和，即 $\\phi_{\\mathrm{SB}}(r) = \\Phi_{\\mathrm{UB}}(r)$。\n\n最后，作为推理的一部分，解释这种饱和对于格式解析陡峭地球物理锋面的能力，以及其在平流示踪剂剖面中产生阶梯效应的倾向意味着什么。将最终的 $r$ 值集合表示为关于 $r$ 的闭区间的并集。最终答案无需四舍五入，也没有单位。",
            "solution": "该问题要求推导总变差递减（TVD）格式中通量限制器函数的上界，并确定superbee限制器在哪些区域达到该上界饱和。\n\n### 推导与分析\n\n为了使基于MUSCL重构的有限体积格式具有TVD性质，通量限制器函数 $\\phi(r)$ 必须满足特定条件。这些条件将 $\\phi(r)$ 的图像限制在 $(r, \\phi)$ 平面上的一个特定区域内，该区域通常被称为Sweby图中的“TVD区域”。\n\n对于正斜率比 $r \\ge 0$，使格式成为TVD的充分条件由以下不等式给出：\n1.  $\\phi(r) \\ge 0$\n2.  $\\phi(r) \\le 2r$\n3.  $\\phi(r) \\le 2$\n\n这些条件确保格式不会引入新的局部极值，从而保证解的总变差不会随时间增加。\n\n**1. 容许上界 $\\Phi_{\\mathrm{UB}}(r)$**\n\n根据TVD约束，限制器 $\\phi(r)$ 必须为非负，并且其上界同时受 $2r$ 和 $2$ 的限制。为了同时满足这两个上界，$\\phi(r)$ 必须小于或等于两者中的较小者。因此，对于 $r \\ge 0$，容许上界 $\\Phi_{\\mathrm{UB}}(r)$ 为：\n$$\\Phi_{\\mathrm{UB}}(r) = \\min(2r, 2)$$\n我们可以将此上界分段表示：\n-   对于 $0 \\le r \\le 1$，我们有 $2r \\le 2$。因此，$\\Phi_{\\mathrm{UB}}(r) = 2r$。\n-   对于 $r > 1$，我们有 $2r > 2$。因此，$\\Phi_{\\mathrm{UB}}(r) = 2$。\n\n所以，上界为：\n$$\\Phi_{\\mathrm{UB}}(r) = \\begin{cases} 2r  \\text{对于 } 0 \\le r \\le 1 \\\\ 2  \\text{对于 } r > 1 \\end{cases}$$\n位于此边界上的限制器，例如UMIST限制器，在保持TVD性质的同时，被认为是具有最大压缩性的。\n\n**2. Superbee 限制器对上界的饱和**\n\nSuperbee通量限制器定义为：\n$$\\phi_{\\mathrm{SB}}(r) = \\max(0, \\min(1, 2r), \\min(r, 2))$$\n我们需要确定对于哪些 $r \\ge 0$ 的值，该函数等于上界 $\\Phi_{\\mathrm{UB}}(r)$。对于 $r \\ge 0$，$\\max$ 函数内的所有项都是非负的，因此我们可以将表达式简化为：\n$$\\phi_{\\mathrm{SB}}(r) = \\max(\\min(1, 2r), \\min(r, 2))$$\n让我们分段分析这个函数：\n-   对于 $0 \\le r \\le 1/2$：$\\min(1, 2r) = 2r$ 且 $\\min(r, 2) = r$。因此，$\\phi_{\\mathrm{SB}}(r) = \\max(2r, r) = 2r$。\n-   对于 $1/2  r \\le 1$：$\\min(1, 2r) = 1$ 且 $\\min(r, 2) = r$。因此，$\\phi_{\\mathrm{SB}}(r) = \\max(1, r) = 1$。\n-   对于 $1  r \\le 2$：$\\min(1, 2r) = 1$ 且 $\\min(r, 2) = r$。因此，$\\phi_{\\mathrm{SB}}(r) = \\max(1, r) = r$。\n-   对于 $r > 2$：$\\min(1, 2r) = 1$ 且 $\\min(r, 2) = 2$。因此，$\\phi_{\\mathrm{SB}}(r) = \\max(1, 2) = 2$。\n\n现在，我们在每个区间内将 $\\phi_{\\mathrm{SB}}(r)$ 与 $\\Phi_{\\mathrm{UB}}(r) = \\min(2r, 2)$ 进行比较：\n-   对于 $0 \\le r \\le 1/2$：$\\phi_{\\mathrm{SB}}(r) = 2r$。上界为 $\\Phi_{\\mathrm{UB}}(r) = \\min(2r, 2) = 2r$。它们在此区间内相等。\n-   对于 $1/2  r \\le 1$：$\\phi_{\\mathrm{SB}}(r) = 1$。上界为 $\\Phi_{\\mathrm{UB}}(r) = 2r$。因为 $r > 1/2$，所以 $2r > 1$，故 $\\phi_{\\mathrm{SB}}(r)  \\Phi_{\\mathrm{UB}}(r)$。它们不相等。\n-   对于 $1  r \\le 2$：$\\phi_{\\mathrm{SB}}(r) = r$。上界为 $\\Phi_{\\mathrm{UB}}(r) = \\min(2r, 2) = 2$。因为 $r  2$，所以 $\\phi_{\\mathrm{SB}}(r)  \\Phi_{\\mathrm{UB}}(r)$。它们不相等。\n-   对于 $r > 2$：$\\phi_{\\mathrm{SB}}(r) = 2$。上界为 $\\Phi_{\\mathrm{UB}}(r) = \\min(2r, 2) = 2$。它们在此区间内相等。\n\n综合这些结果，superbee限制器在 $r \\in [0, 1/2]$ 和 $r \\in [2, \\infty)$ 时达到TVD上界饱和。因此，值的集合是这两个闭区间的并集。\n\n**3. 饱和的含义**\n\n当一个限制器函数达到TVD上界饱和时，意味着该数值格式在对应的局部解结构下具有最大的压缩性（或最小的耗散性）。这对平流示踪剂的模拟有直接影响：\n\n-   **陡峭锋面的解析**：最大压缩性对于解析锋面或接触间断等陡峭特征非常有利。通过在TVD框架内允许最陡的重构斜率，该格式能有效抵抗数值扩散的模糊效应。Superbee限制器以其能为间断产生非常尖锐和清晰的剖面而闻名，这直接源于其在 $r \\le 1/2$ 和 $r \\ge 2$ 区域的压缩特性。这些 $r$ 值对应于梯度变化剧烈的区域，如方波的边缘。\n\n-   **产生阶梯效应的倾向**：高压缩性的代价是容易产生数值伪影，最著名的是“阶梯效应”。当一个光滑的单调剖面被人为地锐化成一系列平坦平台和陡峭台阶时，就会出现这种现象。虽然Superbee限制器是TVD的，不会产生过冲，但其激进的特性可能会扭曲光滑解。在它未达到上界饱和的区域，尤其是在 $r$ 值接近1的平滑区域，其行为可能导致平缓的斜坡被压平为水平段，从而形成阶梯状的模式。\n\n总之，superbee限制器在特定的 $r$ 值范围内达到TVD上界饱和，使其成为处理以陡峭间断为主的问题的绝佳选择，但同样的压缩特性也可能在流场较平滑的区域引入阶梯状伪影。\n\n最终，对于 $r \\ge 0$，superbee限制器达到TVD上界饱和的值的集合是 $[0, 1/2] \\cup [2, \\infty)$。",
            "answer": "$$\\boxed{[0, 1/2] \\cup [2, \\infty)}$$"
        }
    ]
}