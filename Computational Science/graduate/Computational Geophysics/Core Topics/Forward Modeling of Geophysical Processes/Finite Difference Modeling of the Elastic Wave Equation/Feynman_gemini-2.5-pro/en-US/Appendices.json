{
    "hands_on_practices": [
        {
            "introduction": "The choice of the time step, $\\Delta t$, is one of the most fundamental decisions in finite-difference time-domain modeling. It represents a critical trade-off between computational cost, numerical stability, and the accuracy of the simulation. This exercise guides you through the process of selecting an optimal $\\Delta t$ by balancing two competing constraints: the Courant–Friedrichs–Lewy (CFL) condition for stability and the acceptable level of numerical dispersion, which affects the phase accuracy of propagating waves . Mastering this balance is essential for creating any efficient and reliable wave propagation model.",
            "id": "3593130",
            "problem": "Consider one-dimensional propagation of small-amplitude elastic longitudinal waves in a homogeneous, isotropic solid. Let the mass density be $\\rho = 2700\\,\\mathrm{kg/m^3}$, the first Lamé parameter be $\\lambda = 20\\times 10^{9}\\,\\mathrm{Pa}$, and the shear modulus be $\\mu = 30\\times 10^{9}\\,\\mathrm{Pa}$. You will model the displacement field $u(x,t)$ using a second-order accurate central difference in time and a second-order accurate central difference in space on a uniform grid with spacing $\\Delta x = 2\\,\\mathrm{m}$. Assume that spatial dispersion is controlled by a sufficiently fine spatial resolution for the frequencies of interest, so that temporal dispersion dominates at the maximum modeling frequency.\n\nYour task is to select a single time step $\\Delta t$ that simultaneously satisfies:\n- the Courant–Friedrichs–Lewy (CFL) stability condition for the explicit scheme, and\n- a temporal phase error constraint at the maximum frequency $f_{\\max} = 500\\,\\mathrm{Hz}$ such that the relative temporal phase velocity error does not exceed $\\varepsilon = 0.005$.\n\nStarting from first principles (linear momentum balance and linear isotropic elasticity), derive the wave speed that controls the stability, derive the stability condition for the chosen second-order finite difference scheme, and derive a leading-order bound on $\\Delta t$ implied by the temporal dispersion requirement at angular frequency $\\omega_{\\max} = 2\\pi f_{\\max}$. Then, choose $\\Delta t$ as the minimum of the stability-limited time step and the temporal-dispersion-limited time step. Round your answer to four significant figures. Express the time step in seconds.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n-   Wave type: one-dimensional, small-amplitude elastic longitudinal waves.\n-   Medium: homogeneous, isotropic solid.\n-   Mass density: $\\rho = 2700\\,\\mathrm{kg/m^3}$.\n-   First Lamé parameter: $\\lambda = 20\\times 10^{9}\\,\\mathrm{Pa}$.\n-   Shear modulus (second Lamé parameter): $\\mu = 30\\times 10^{9}\\,\\mathrm{Pa}$.\n-   Displacement field: $u(x,t)$.\n-   Numerical scheme: second-order accurate central difference in time and a second-order accurate central difference in space.\n-   Grid spacing: $\\Delta x = 2\\,\\mathrm{m}$.\n-   Assumption: Temporal dispersion dominates at the maximum modeling frequency.\n-   Maximum modeling frequency: $f_{\\max} = 500\\,\\mathrm{Hz}$.\n-   Temporal phase error constraint: The relative temporal phase velocity error does not exceed $\\varepsilon = 0.005$.\n-   Task: Select a single time step $\\Delta t$ satisfying both the stability and dispersion constraints.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the fundamental principles of linear elastodynamics and the finite difference method, which are standard topics in computational geophysics and seismology. All physical parameters and concepts are well-established.\n-   **Well-Posed**: The problem provides a complete set of parameters ($\\rho, \\lambda, \\mu, \\Delta x, f_{\\max}, \\varepsilon$) and clear constraints (stability and dispersion) to determine a unique value for the time step $\\Delta t$.\n-   **Objective**: The problem is stated using precise, quantitative, and unbiased technical language.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It is deemed **valid**. The solution process will now proceed.\n\n### Derivation of the Governing Equation and Wave Speed\n\nThe one-dimensional equation of linear momentum balance is\n$$\n\\frac{\\partial \\sigma_{xx}}{\\partial x} = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\nwhere $\\sigma_{xx}$ is the longitudinal stress, $u$ is the longitudinal displacement, and $\\rho$ is the mass density.\n\nFor a linear isotropic elastic solid, the stress-strain relationship (Hooke's Law) in one dimension is\n$$\n\\sigma_{xx} = (\\lambda + 2\\mu) \\varepsilon_{xx}\n$$\nwhere $\\varepsilon_{xx}$ is the longitudinal strain, and $\\lambda$ and $\\mu$ are the Lamé parameters. The strain is related to the displacement by\n$$\n\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}\n$$\nSubstituting the strain-displacement and stress-strain relations into the momentum equation, we obtain\n$$\n\\frac{\\partial}{\\partial x} \\left( (\\lambda + 2\\mu) \\frac{\\partial u}{\\partial x} \\right) = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\nFor a homogeneous medium, $\\lambda$, $\\mu$, and $\\rho$ are constants. The equation simplifies to the one-dimensional elastic wave equation:\n$$\n(\\lambda + 2\\mu) \\frac{\\partial^2 u}{\\partial x^2} = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\nThis can be written in the standard form $\\frac{\\partial^2 u}{\\partial t^2} = c_p^2 \\frac{\\partial^2 u}{\\partial x^2}$, where $c_p$ is the compressional (P-wave) velocity, given by\n$$\nc_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}\n$$\nUsing the provided values:\n-   $\\lambda = 20 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\mu = 30 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\rho = 2700\\,\\mathrm{kg/m^3}$\n\nThe P-wave modulus is $M = \\lambda + 2\\mu = (20 \\times 10^9) + 2(30 \\times 10^9) = 80 \\times 10^9\\,\\mathrm{Pa}$.\nThe P-wave velocity is:\n$$\nc_p = \\sqrt{\\frac{80 \\times 10^9\\,\\mathrm{Pa}}{2700\\,\\mathrm{kg/m^3}}} = \\sqrt{\\frac{800}{27} \\times 10^6}\\,\\mathrm{m/s} \\approx 5443.3105\\,\\mathrm{m/s}\n$$\n\n### Stability Condition (CFL)\n\nThe problem specifies a second-order accurate central difference scheme in both time and space. The wave equation is discretized as:\n$$\n\\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{\\Delta t^2} = c_p^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\n$$\nwhere $u_j^n = u(j\\Delta x, n\\Delta t)$. For this explicit scheme, the Courant–Friedrichs–Lewy (CFL) stability condition is:\n$$\nS = \\frac{c_p \\Delta t}{\\Delta x} \\le 1\n$$\nwhere $S$ is the Courant number. This condition sets an upper bound on the time step for the scheme to be stable. The maximum time step allowed by stability is:\n$$\n\\Delta t_{\\text{stab}} = \\frac{\\Delta x}{c_p}\n$$\nUsing the given grid spacing $\\Delta x = 2\\,\\mathrm{m}$ and the calculated wave speed:\n$$\n\\Delta t_{\\text{stab}} = \\frac{2\\,\\mathrm{m}}{5443.3105\\,\\mathrm{m/s}} \\approx 3.6724 \\times 10^{-4}\\,\\mathrm{s}\n$$\n\n### Temporal Dispersion Constraint\n\nThe problem states that temporal dispersion dominates. This allows us to analyze the effect of time discretization independently of spatial discretization. We consider the semi-discretized equation in time, where the spatial derivatives are treated analytically. For a single harmonic component with angular frequency $\\omega_{\\text{phy}}$, the wave equation is $\\frac{\\partial^2 u}{\\partial t^2} = -\\omega_{\\text{phy}}^2 u$. Applying the second-order central difference operator in time gives:\n$$\n\\frac{u(t+\\Delta t) - 2u(t) + u(t-\\Delta t)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2 u(t)\n$$\nWe seek a numerical solution of the form $u(t) = \\exp(-i\\omega_{\\text{num}}t)$, where $\\omega_{\\text{num}}$ is the numerical angular frequency. Substituting this into the difference equation yields:\n$$\n\\frac{\\exp(-i\\omega_{\\text{num}}\\Delta t) - 2 + \\exp(i\\omega_{\\text{num}}\\Delta t)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n$$\n\\frac{2\\cos(\\omega_{\\text{num}}\\Delta t) - 2}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\nUsing the identity $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$:\n$$\n\\frac{-4\\sin^2(\\omega_{\\text{num}}\\Delta t / 2)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n$$\n\\frac{2\\sin(\\omega_{\\text{num}}\\Delta t / 2)}{\\Delta t} = \\omega_{\\text{phy}}\n$$\nThis is the dispersion relation for the semi-discretized system. From this, we solve for the numerical frequency $\\omega_{\\text{num}}$:\n$$\n\\omega_{\\text{num}} = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right)\n$$\nThe numerical phase velocity is $c_{\\text{num}} = c_p \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{phy}}}$. The relative phase velocity error $E_v$ is:\n$$\nE_v = \\frac{c_{\\text{num}}}{c_p} - 1 = \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{phy}}} - 1 = \\frac{2}{\\omega_{\\text{phy}}\\Delta t} \\arcsin\\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right) - 1\n$$\nFor small arguments $y$, the Taylor expansion of $\\arcsin(y)$ is $y + \\frac{y^3}{6} + O(y^5)$. Let $y = \\frac{\\omega_{\\text{phy}}\\Delta t}{2}$. For a small time step, $y$ is small, and we can approximate the error to leading order:\n$$\nE_v \\approx \\frac{1}{y} \\left(y + \\frac{y^3}{6}\\right) - 1 = \\left(1 + \\frac{y^2}{6}\\right) - 1 = \\frac{y^2}{6}\n$$\nSubstituting back $y$:\n$$\nE_v \\approx \\frac{1}{6} \\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right)^2 = \\frac{\\omega_{\\text{phy}}^2 \\Delta t^2}{24}\n$$\nThe problem requires that this error not exceed $\\varepsilon = 0.005$ at the maximum frequency $f_{\\max} = 500\\,\\mathrm{Hz}$, which corresponds to the maximum angular frequency $\\omega_{\\max} = 2\\pi f_{\\max} = 2\\pi(500) = 1000\\pi\\,\\mathrm{rad/s}$.\nThe constraint is:\n$$\n\\frac{\\omega_{\\max}^2 \\Delta t^2}{24} \\le \\varepsilon\n$$\nSolving for $\\Delta t$ gives the dispersion-limited time step, $\\Delta t_{\\text{disp}}$:\n$$\n\\Delta t \\le \\frac{\\sqrt{24\\varepsilon}}{\\omega_{\\max}} \\implies \\Delta t_{\\text{disp}} = \\frac{\\sqrt{24\\varepsilon}}{\\omega_{\\max}}\n$$\nPlugging in the values $\\varepsilon = 0.005$ and $\\omega_{\\max} = 1000\\pi\\,\\mathrm{rad/s}$:\n$$\n\\Delta t_{\\text{disp}} = \\frac{\\sqrt{24 \\times 0.005}}{1000\\pi} = \\frac{\\sqrt{0.12}}{1000\\pi} \\approx \\frac{0.346410}{3141.5927} \\approx 1.10266 \\times 10^{-4}\\,\\mathrm{s}\n$$\n\n### Final Time Step Selection\n\nThe time step $\\Delta t$ must satisfy both the stability and dispersion constraints. Therefore, it must be the minimum of the two derived upper bounds:\n$$\n\\Delta t \\le \\min(\\Delta t_{\\text{stab}}, \\Delta t_{\\text{disp}})\n$$\nWe have:\n-   $\\Delta t_{\\text{stab}} \\approx 3.6724 \\times 10^{-4}\\,\\mathrm{s}$\n-   $\\Delta t_{\\text{disp}} \\approx 1.10266 \\times 10^{-4}\\,\\mathrm{s}$\n\nThe more stringent constraint is imposed by the temporal dispersion requirement. Thus, the maximum allowable time step is $\\Delta t = \\Delta t_{\\text{disp}}$.\n$$\n\\Delta t = 1.10266 \\times 10^{-4}\\,\\mathrm{s}\n$$\nRounding to four significant figures, we get:\n$$\n\\Delta t = 1.103 \\times 10^{-4}\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{1.103 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "Numerical simulations are necessarily performed on a finite computational grid, yet we often wish to model wave propagation in an unbounded medium. To prevent spurious reflections from the artificial boundaries of the grid, we must implement absorbing boundary conditions. This practice delves into the design of a Perfectly Matched Layer (PML), a highly effective technique that absorbs outgoing wave energy by creating a non-physical, damped medium . You will derive the relationship between the PML's damping profile and its performance, providing a practical method for designing a boundary that meets a specific reflection tolerance.",
            "id": "3593129",
            "problem": "A linear, isotropic, homogeneous elastic medium occupies the half-space $x \\geq 0$ with constant mass density $\\rho$ and Lamé parameters $\\lambda$ and $\\mu$, supporting one-dimensional, normally incident plane compressional waves with phase speed $c_{p} = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}$. In a finite-difference time-domain simulation of the elastic wave equation, the computational domain is truncated at $x = x_{0}$ and a Perfectly Matched Layer (PML) is appended over $x \\in [x_{0}, x_{0} + L]$ to absorb outgoing waves.\n\nAssume the PML is implemented via a frequency-domain complex coordinate stretching in the $x$-direction and uses a polynomial damping profile\n$$\n\\sigma(x) = \\sigma_{\\max} \\left(\\frac{x - x_{0}}{L}\\right)^{m}, \\quad x \\in [x_{0}, x_{0} + L],\n$$\nwith profile order $m \\in \\mathbb{N}$ and unknown maximum damping $\\sigma_{\\max}$. For a simple one-dimensional analysis, model the outgoing plane $P$-wave of angular frequency $\\omega = 2\\pi f$ as entering the PML at $x = x_{0}$, propagating to the outer boundary at $x = x_{0} + L$, reflecting there with unit amplitude, and returning through the PML. Starting from the one-dimensional elastic wave equation and the standard frequency-domain complex coordinate stretching paradigm used in PML theory, derive the attenuation experienced by the wave traveling through the PML and back, and use this to determine the reflection coefficient at $x = x_{0}$ solely due to the finite PML thickness.\n\nDesign the PML to meet a target reflection coefficient $R_{\\text{target}} = 1.0 \\times 10^{-4}$ at the minimum frequency $f_{\\min} = 5$ Hz for a compressional wave speed $c_{p} = 4000$ m/s. Choose the thickness according to the rationale that at the lowest frequency the PML should be a small fraction of the wavelength, taking\n$$\nL = \\frac{\\lambda_{\\min}}{20} = \\frac{c_{p}}{20 f_{\\min}}.\n$$\nUse a cubic damping profile with $m = 3$. Compute the required maximum damping $\\sigma_{\\max}$ that achieves $R_{\\text{target}}$ under the above one-dimensional analysis assumptions.\n\nExpress your final answer for $\\sigma_{\\max}$ in s$^{-1}$ and round to four significant figures.",
            "solution": "The user wants me to solve the problem if it is valid.\n\n### Step 1: Extract Givens\n- Medium: Linear, isotropic, homogeneous elastic medium in half-space $x \\geq 0$.\n- Constants: Mass density $\\rho$, Lamé parameters $\\lambda$ and $\\mu$.\n- Wave type: One-dimensional, normally incident plane compressional waves.\n- Phase speed: $c_{p} = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}} = 4000$ m/s.\n- Computational domain truncation: At $x = x_{0}$.\n- Perfectly Matched Layer (PML) domain: $x \\in [x_{0}, x_{0} + L]$.\n- PML damping profile: $\\sigma(x) = \\sigma_{\\max} \\left(\\frac{x - x_{0}}{L}\\right)^{m}$ for $x \\in [x_{0}, x_{0} + L]$.\n- Profile order: $m = 3$.\n- Target reflection coefficient: $R_{\\text{target}} = 1.0 \\times 10^{-4}$.\n- Minimum frequency: $f_{\\min} = 5$ Hz.\n- PML thickness: $L = \\frac{\\lambda_{\\min}}{20} = \\frac{c_{p}}{20 f_{\\min}}$.\n- Reflection model: The reflection at $x = x_{0}$ is caused by a wave traveling from $x_{0}$ to $x_{0} + L$, reflecting at $x_{0} + L$ with unit amplitude, and traveling back through the PML to $x_{0}$.\n- Unknown: Maximum damping $\\sigma_{\\max}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it is based on the well-established theory of the elastic wave equation and Perfectly Matched Layers (PML) used in computational physics and geophysics. The concepts of complex coordinate stretching, damping profiles, and reflection due to finite layer thickness are standard. The problem is well-posed, providing all necessary parameters and a clear objective to calculate $\\sigma_{\\max}$. The language is objective and precise. The provided values are physically realistic for seismic wave propagation. The problem is not incomplete, contradictory, ill-posed, or trivial. It represents a standard design calculation for a simplified PML model.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed to the solution.\n\n### Detailed Solution\nThe one-dimensional elastic wave equation for compressional waves (P-waves) propagating in the $x$-direction is given by\n$$\n\\rho \\frac{\\partial^2 u}{\\partial t^2} = (\\lambda + 2\\mu) \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere $u(x,t)$ is the displacement. Using the definition of the P-wave phase speed, $c_p^2 = (\\lambda + 2\\mu)/\\rho$, this simplifies to\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c_p^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nFor a harmonic plane wave with time dependence $\\exp(i\\omega t)$, where $\\omega = 2\\pi f$ is the angular frequency, the equation in the frequency domain becomes\n$$\n\\frac{d^2 U}{d x^2} + k^2 U = 0\n$$\nwhere $U(x)$ is the complex amplitude of the displacement and $k = \\omega/c_p$ is the wavenumber.\n\nThe Perfectly Matched Layer (PML) is implemented via a complex coordinate stretching in the frequency domain. The derivative operator $\\frac{d}{dx}$ is transformed according to\n$$\n\\frac{d}{dx} \\rightarrow \\frac{1}{1 + \\frac{i\\sigma(x)}{\\omega}} \\frac{d}{dx}\n$$\nThis modifies the effective wavenumber in the medium. A plane wave propagating in the $+x$ direction, which normally has the form $U(x) = A \\exp(-ikx)$, will now have a complex, spatially varying wavenumber $\\tilde{k}(x)$.\n$$\n\\tilde{k}(x) = k \\left(1 + \\frac{i\\sigma(x)}{\\omega}\\right) = \\frac{\\omega}{c_p} \\left(1 + \\frac{i\\sigma(x)}{\\omega}\\right) = \\frac{\\omega}{c_p} + i\\frac{\\sigma(x)}{c_p}\n$$\nThe solution for a wave propagating from $x_0$ into the PML takes the form\n$$\nU(x) = U(x_0) \\exp\\left(-i \\int_{x_0}^{x} \\tilde{k}(\\xi) d\\xi\\right) = U(x_0) \\exp\\left(-i \\int_{x_0}^{x} \\left(\\frac{\\omega}{c_p} + i\\frac{\\sigma(\\xi)}{c_p}\\right) d\\xi\\right)\n$$\nSeparating the real and imaginary parts in the exponent, we get\n$$\nU(x) = U(x_0) \\exp\\left(-i \\frac{\\omega}{c_p} (x-x_0)\\right) \\exp\\left(-\\frac{1}{c_p} \\int_{x_0}^{x} \\sigma(\\xi) d\\xi\\right)\n$$\nThe second exponential term represents the attenuation of the wave's amplitude as it propagates through the PML. The one-way amplitude attenuation factor for a wave traveling from $x_0$ to $x_0+L$ is\n$$\nA_{\\text{1-way}} = \\exp\\left(-\\frac{1}{c_p} \\int_{x_0}^{x_0+L} \\sigma(x) dx\\right)\n$$\nThe problem specifies that the reflection measured at $x=x_0$ is due to a wave that propagates to the end of the PML at $x=x_0+L$, reflects with unit amplitude, and propagates back to $x=x_0$. The returning wave is attenuated by the same factor. Therefore, the total reflection coefficient $R$ at $x_0$ is the product of the forward and backward attenuation factors:\n$$\nR = A_{\\text{1-way}} \\times A_{\\text{1-way}} = \\left(A_{\\text{1-way}}\\right)^2 = \\exp\\left(-\\frac{2}{c_p} \\int_{x_0}^{x_0+L} \\sigma(x) dx\\right)\n$$\nWe must now evaluate the integral of the given polynomial damping profile, $\\sigma(x) = \\sigma_{\\max} \\left(\\frac{x - x_{0}}{L}\\right)^{m}$, with $m=3$.\n$$\n\\int_{x_0}^{x_0+L} \\sigma(x) dx = \\int_{x_0}^{x_0+L} \\sigma_{\\max} \\left(\\frac{x - x_{0}}{L}\\right)^{m} dx\n$$\nLet's perform a change of variables with $s = \\frac{x-x_0}{L}$. Then $ds = \\frac{dx}{L}$, so $dx = L ds$. The limits of integration become $s=0$ for $x=x_0$ and $s=1$ for $x=x_0+L$.\n$$\n\\int_{0}^{1} \\sigma_{\\max} s^m (L ds) = \\sigma_{\\max} L \\int_{0}^{1} s^m ds = \\sigma_{\\max} L \\left[ \\frac{s^{m+1}}{m+1} \\right]_{0}^{1} = \\frac{\\sigma_{\\max} L}{m+1}\n$$\nSubstituting this result into the expression for the reflection coefficient $R$:\n$$\nR = \\exp\\left(-\\frac{2 \\sigma_{\\max} L}{c_p (m+1)}\\right)\n$$\nWe need to solve for $\\sigma_{\\max}$ to achieve the target reflection coefficient $R_{\\text{target}}$.\n$$\n\\ln(R_{\\text{target}}) = -\\frac{2 \\sigma_{\\max} L}{c_p (m+1)}\n$$\n$$\n\\sigma_{\\max} = -\\frac{c_p (m+1) \\ln(R_{\\text{target}})}{2L}\n$$\nNow, we substitute the given values. First, we calculate the PML thickness $L$.\n$$\nL = \\frac{c_p}{20 f_{\\min}} = \\frac{4000 \\text{ m/s}}{20 \\times 5 \\text{ Hz}} = \\frac{4000}{100} \\text{ m} = 40 \\text{ m}\n$$\nThe other parameters are $c_p = 4000$ m/s, $m=3$, and $R_{\\text{target}} = 1.0 \\times 10^{-4}$.\n$$\n\\sigma_{\\max} = -\\frac{(4000 \\text{ m/s}) (3+1) \\ln(1.0 \\times 10^{-4})}{2 (40 \\text{ m})}\n$$\n$$\n\\sigma_{\\max} = -\\frac{4000 \\times 4 \\times \\ln(10^{-4})}{80} \\text{ s}^{-1}\n$$\nUsing the property $\\ln(a^b) = b \\ln(a)$:\n$$\n\\sigma_{\\max} = -\\frac{16000 \\times (-4 \\ln(10))}{80} \\text{ s}^{-1} = \\frac{64000 \\ln(10)}{80} \\text{ s}^{-1}\n$$\n$$\n\\sigma_{\\max} = 800 \\ln(10) \\text{ s}^{-1}\n$$\nNow, we compute the numerical value. Using $\\ln(10) \\approx 2.302585$:\n$$\n\\sigma_{\\max} \\approx 800 \\times 2.302585 \\text{ s}^{-1} \\approx 1842.068 \\text{ s}^{-1}\n$$\nRounding the result to four significant figures as requested:\n$$\n\\sigma_{\\max} \\approx 1842 \\text{ s}^{-1}\n$$\nIn standard scientific notation this is $1.842 \\times 10^3$ s$^{-1}$.",
            "answer": "$$\\boxed{1.842 \\times 10^{3}}$$"
        },
        {
            "introduction": "Geological media are inherently heterogeneous, often characterized by sharp interfaces between different rock types. Discretizing the elastic wave equation on a staggered grid across these strong material contrasts requires careful consideration of how to represent the properties at locations between grid points. This exercise explores how different averaging schemes for density and elastic moduli impact the physical consistency and stability of the simulation . By analyzing the continuity of energy flux, you will determine the physically-justified averaging method that ensures accuracy and robustness when modeling complex subsurface structures.",
            "id": "3593113",
            "problem": "Consider one-dimensional isotropic linear elasticity with longitudinal motion in $x$, governed by the conservation of linear momentum and Hooke’s law: $\\rho(x)\\,\\partial_t v(x,t)=\\partial_x \\sigma(x,t)$ and $\\partial_t \\sigma(x,t)=M(x)\\,\\partial_x v(x,t)$, where $v$ is particle velocity, $\\sigma$ is normal stress, $\\rho$ is density, and $M=\\lambda+2\\mu$ is the $P$-wave modulus expressed in terms of the Lamé parameters $\\lambda$ and $\\mu$. The continuous total energy density is $e=\\tfrac{1}{2}\\rho v^2+\\tfrac{1}{2}\\sigma^2/M$, and the continuous energy flux is $S=\\sigma v$. Assume a staggered-grid finite difference scheme in which $v$ is stored at half-grid locations $x_{i+1/2}$ and $\\sigma$ is stored at integer-grid locations $x_i$, with uniform spacing $\\Delta x$ and a planar material interface located at $x=x_0$ aligned with a stress grid point $x_{i_0}=x_0$. Material properties $\\rho$, $\\lambda$, and $\\mu$ are discontinuous at $x_0$, with strong contrast (e.g., order-one jumps).\n\nYou are asked to analyze the effect of different averaging schemes for placing $\\rho$, $\\lambda$, and $\\mu$ onto the staggered locations required by the discrete updates. Specifically, the velocity update requires $\\rho$ at $x_{i+1/2}$, and the stress update requires $M$ at $x_i$. When an averaging must be performed across the interface to supply a property at a staggered location that straddles two materials, three candidate averages are available: arithmetic, harmonic, and geometric. Using only first principles (conservation of linear momentum, Hooke’s law, and the definition of continuous energy density and flux), derive the discrete energy balance for the staggered scheme and determine which averaging choices ensure discrete energy flux continuity across $x_0$ and minimize spurious energy creation near the interface under strong contrast. In your analysis, connect the choice of averaging to the Courant–Friedrichs–Lewy (CFL) condition by discussing whether the local wave speed estimate near the interface is over- or under-estimated by each choice.\n\nWhich statement most accurately characterizes the averaging choices that yield the best stability and accuracy near strong property contrasts when judged by discrete energy flux continuity as the primary metric?\n\nA. Use the arithmetic average for both $\\rho$ and the moduli ($\\lambda$ and $\\mu$) at all staggered points; this preserves energy flux continuity and produces the most stable scheme near strong contrasts.\n\nB. Use the arithmetic average for $\\rho$ at velocity points and the harmonic average for the moduli, i.e., $\\lambda$ and $\\mu$ (equivalently $M=\\lambda+2\\mu$ in the $P$-wave update), at stress points; this choice enforces discrete energy flux continuity across the interface and improves stability and accuracy under strong contrasts.\n\nC. Use the geometric average for all three properties $\\rho$, $\\lambda$, and $\\mu$ at their staggered locations; this best preserves impedance and thereby guarantees energy flux continuity and stability.\n\nD. Use the harmonic average for $\\rho$ and the arithmetic average for $\\lambda$ and $\\mu$; this optimally balances mass and stiffness and gives the most accurate flux across strong contrasts.",
            "solution": "The problem statement is a valid, well-posed problem in computational geophysics. It asks for the determination of appropriate averaging schemes for material properties on a staggered finite difference grid at an interface with strong contrast. The criteria for judgment are discrete energy flux continuity and numerical stability.\n\nFirst, let's establish the physical principles at a continuous material interface located at $x=x_0$. For a welded contact, both displacement $u(x,t)$ and stress $\\sigma(x,t)$ must be continuous. Continuity of displacement implies continuity of particle velocity, $v = \\partial_t u$. Thus, we have:\n1. $v(x_0^-, t) = v(x_0^+, t)$\n2. $\\sigma(x_0^-, t) = \\sigma(x_0^+, t)$\n\nThese conditions have direct implications for the governing equations at the interface.\nFrom the first governing equation, $\\partial_t v = \\frac{1}{\\rho} \\partial_x \\sigma$. Since $v$ is continuous, $\\partial_t v$ is also continuous across the interface. As $\\rho$ is discontinuous, this implies that $\\partial_x \\sigma$ must have a jump such that the quantity $\\frac{1}{\\rho} \\partial_x \\sigma$ remains continuous.\nFrom the second governing equation, $\\partial_t \\sigma = M \\partial_x v$. Since $\\sigma$ is continuous, $\\partial_t \\sigma$ is also continuous. As the modulus $M$ is discontinuous, this implies that the strain rate $\\partial_x v$ must have a jump such that the quantity $M \\partial_x v$ remains continuous.\n\nAn accurate finite difference scheme should honor these continuity properties in its discrete form. This is achieved by selecting appropriate averaging schemes for the material properties $\\rho$ and $M$ at grid locations that straddle the interface.\n\nLet's analyze the averaging for the P-wave modulus $M = \\lambda+2\\mu$. The stress update is performed at integer grid points $x_i$, and requires $M_i$. If the interface is located at $x_{i_0}$, the value $M_{i_0}$ must be an effective modulus representing the properties of both materials, say $M_1$ and $M_2$. The stress update equation at $x_{i_0}$ is:\n$$ \\frac{\\sigma_{i_0}^{n+1} - \\sigma_{i_0}^n}{\\Delta t} = M_{i_0} \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0-1/2}^{n+1/2}}{\\Delta x} $$\nThe left side represents a discrete approximation of $\\partial_t \\sigma$ at $x_{i_0}$, which is continuous. The right side is a discrete approximation of $M \\partial_x v$, which is also continuous. The key physical insight is to consider the behavior of strain and stress across the interface grid cell $[x_{i_0-1/2}, x_{i_0+1/2}]$. Since stress $\\sigma$ is continuous, this is analogous to two springs connected in series. For materials in series, the compliances (inverse of stiffness) are additive. The strain across the cell is the sum of strains in each part. The effective compliance for the cell is the arithmetic average of the compliances of the two materials. The compliance is $1/M$.\nLet the grid cell centered at $x_{i_0}$ be composed of material $1$ on $[x_{i_0-1/2}, x_{i_0}]$ and material $2$ on $[x_{i_0}, x_{i_0+1/2}]$. The total strain increment over the cell $\\Delta x$ for a given stress $\\sigma$ is $\\Delta\\epsilon = (\\sigma/M_1)(\\Delta x/2) + (\\sigma/M_2)(\\Delta x/2)$. The effective modulus $M_{i_0}$ is defined by $\\Delta\\epsilon = (\\sigma/M_{i_0})\\Delta x$.\n$$ \\frac{\\sigma}{M_{i_0}} \\Delta x = \\sigma \\left( \\frac{1}{M_1} \\frac{\\Delta x}{2} + \\frac{1}{M_2} \\frac{\\Delta x}{2} \\right) \\implies \\frac{1}{M_{i_0}} = \\frac{1}{2}\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) $$\nThis is the definition of the harmonic average for $M_{i_0}$. An equivalent argument applies to $\\lambda$ and $\\mu$ individually if they are needed at the stress point.\n\nNext, let's analyze the averaging for density $\\rho$. The velocity update is performed at half-integer grid points $x_{i+1/2}$ and requires $\\rho_{i+1/2}$. If the interface is located at $x_{i_0+1/2}$, the value $\\rho_{i_0+1/2}$ must be an effective density. The velocity update equation is:\n$$ \\rho_{i_0+1/2} \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} = \\frac{\\sigma_{i_0+1}^n - \\sigma_{i_0}^n}{\\Delta x} $$\nThe left side is the product of mass per unit volume and acceleration (approximated discretely), and the right side is the force per unit volume. This equation is a discrete form of Newton's second law for the control volume $[x_{i_0}, x_{i_0+1}]$. The total mass in this volume is $\\text{mass} = \\rho_1 (\\Delta x/2) + \\rho_2 (\\Delta x/2)$. The net force is $\\sigma_{i_0+1}^n - \\sigma_{i_0}^n$. Applying Newton's law (Mass $\\times$ Acceleration = Force):\n$$ (\\rho_1 \\frac{\\Delta x}{2} + \\rho_2 \\frac{\\Delta x}{2}) \\left( \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} \\right) = \\sigma_{i_0+1}^n - \\sigma_{i_0}^n $$\nRearranging this to match the finite difference form, we get:\n$$ \\frac{\\rho_1 + \\rho_2}{2} \\left( \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} \\right) = \\frac{\\sigma_{i_0+1}^n - \\sigma_{i_0}^n}{\\Delta x} $$\nThis shows that the effective density $\\rho_{i_0+1/2}$ must be the arithmetic average of $\\rho_1$ and $\\rho_2$.\n\nThese choices of averaging ensure that the discrete scheme correctly honors the physical continuity conditions at the interface. This, in turn, minimizes the generation of spurious numerical energy and ensures the discrete form of energy flux continuity. The stability of the scheme near strong contrasts is thereby improved not by manipulating the CFL condition directly, but by constructing a more physically accurate and less oscillatory scheme. With arithmetic averaging for modulus $M$, the local wave speed $c = \\sqrt{M/\\rho}$ might be overestimated (since arithmetic mean is always greater than or equal to harmonic mean), potentially leading to a less restrictive but physically incorrect local condition. The combination of harmonic average for moduli and arithmetic average for density provides the highest stability and accuracy.\n\nWe now evaluate the given options based on this derivation.\n\nA. Use the arithmetic average for both $\\rho$ and the moduli ($\\lambda$ and $\\mu$) at all staggered points; this preserves energy flux continuity and produces the most stable scheme near strong contrasts.\nThis is incorrect. While the arithmetic average is correct for $\\rho$, it is incorrect for the elastic moduli $M$, $\\lambda$, and $\\mu$. Using the arithmetic average for moduli corresponds to assuming continuity of strain, which is physically false at an interface where stress is continuous and modulus is discontinuous. This choice violates the physical principles and does not ensure discrete energy flux continuity.\n\nB. Use the arithmetic average for $\\rho$ at velocity points and the harmonic average for the moduli, i.e., $\\lambda$ and $\\mu$ (equivalently $M=\\lambda+2\\mu$ in the $P$-wave update), at stress points; this choice enforces discrete energy flux continuity across the interface and improves stability and accuracy under strong contrasts.\nThis is correct. Our derivation from first principles (continuity of stress and Newton's second law for a control volume) shows that the harmonic average is appropriate for the moduli ($M$, and by extension $\\lambda$ and $\\mu$) and the arithmetic average is appropriate for the density ($\\rho$). This combination honors the physical continuity conditions, which is the discrete equivalent of ensuring energy flux continuity, and is known to provide the most stable and accurate results for staggered-grid schemes at strong-contrast interfaces.\n\nC. Use the geometric average for all three properties $\\rho$, $\\lambda$, and $\\mu$ at their staggered locations; this best preserves impedance and thereby guarantees energy flux continuity and stability.\nThis is incorrect. The geometric mean is not supported by the derivation from first principles for either density or moduli in this context. While impedance is an important concept for reflection/transmission, applying its preservation as a rule for averaging the constituent parameters is not physically justified for the discretization of the PDE operators themselves.\n\nD. Use the harmonic average for $\\rho$ and the arithmetic average for $\\lambda$ and $\\mu$; this optimally balances mass and stiffness and gives the most accurate flux across strong contrasts.\nThis is incorrect. This statement proposes the exact opposite of the correct scheme derived from physical principles. The harmonic average is incorrect for $\\rho$, and the arithmetic average is incorrect for the moduli.",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}