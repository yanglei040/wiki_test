{
    "hands_on_practices": [
        {
            "introduction": "Moving from one to multiple dimensions requires careful consideration of the grid layout to preserve fundamental physical laws. This exercise challenges you to analyze how different grid staggering choices affect the model's ability to maintain stress tensor symmetry and avoid producing non-physical energy from rigid-body motion. By comparing a properly constructed staggered grid with other arrangements, this practice reveals the elegance and necessity of the standard velocity-stress staggered grid in elastodynamics .",
            "id": "3593170",
            "problem": "Consider the two-dimensional isotropic linear elastic wave equation in velocity–stress form, derived from conservation of linear and angular momentum in a Cauchy continuum with no couple stresses. The primary fields are the particle velocities $v_x$ and $v_z$, the Cauchy stress components $\\sigma_{xx}$, $\\sigma_{zz}$, and the shear stress $\\sigma_{xz}$, with Lamé parameters $\\lambda$ and $\\mu$ and mass density $\\rho$, all assumed spatially constant. The continuum imposes the stress symmetry $\\sigma_{ij}=\\sigma_{ji}$ and the kinematic fact that a rigid-body rotation field produces zero strain and therefore zero stress.\n\nYou are asked to select a second-order accurate finite difference time domain (FDTD) leapfrog update on a uniform Cartesian grid with spacings $\\Delta x$ and $\\Delta z$, and time step $\\Delta t$, that preserves the stress symmetry $\\sigma_{ij}=\\sigma_{ji}$ to machine precision and exactly annihilates rigid-body rotation modes, avoiding spurious rotational energy growth. The goal is to choose a grid staggering and discrete update that meets these invariance properties, and to contrast this with known artifacts that can arise on collocated grids.\n\nDefine the grid indexing as follows. Integer indices $(i,j)$ refer to cell centers located at $(x_i,z_j)=(i\\,\\Delta x,j\\,\\Delta z)$. Half-integer indices denote face or corner positions. A leapfrog time stepping is used in which velocities are stored at integer times $t^n=n\\,\\Delta t$, and stresses are stored at half times $t^{n+\\tfrac{1}{2}}=\\left(n+\\tfrac{1}{2}\\right)\\Delta t$.\n\nChoose the single best option from the four discrete schemes below.\n\nA. A staggered-grid velocity–stress scheme that stores $v_x$ at $(i+\\tfrac{1}{2},j)$, $v_z$ at $(i,j+\\tfrac{1}{2})$, $\\sigma_{xx}$ and $\\sigma_{zz}$ at $(i,j)$, and a single shear stress $\\sigma_{xz}$ (representing both $\\sigma_{xz}$ and $\\sigma_{zx}$) at $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$. The updates are\n$$\n\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{xx}^{n-\\tfrac{1}{2}}(i,j)+\\Delta t\\left[(\\lambda+2\\mu)\\,\\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x}+\\lambda\\,\\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\n\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{zz}^{n-\\tfrac{1}{2}}(i,j)+\\Delta t\\left[\\lambda\\,\\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x}+(\\lambda+2\\mu)\\,\\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})\n+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}+\\frac{v_z^n(i+1,j+\\tfrac{1}{2})-v_z^n(i,j+\\tfrac{1}{2})}{\\Delta x}\\right],\n$$\nand\n$$\nv_x^{n+1}(i+\\tfrac{1}{2},j)=v_x^{n}(i+\\tfrac{1}{2},j)+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xx}^{n+\\tfrac{1}{2}}(i+1,j)-\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta x}+\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\nv_z^{n+1}(i,j+\\tfrac{1}{2})=v_z^{n}(i,j+\\tfrac{1}{2})+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i-\\tfrac{1}{2},j+\\tfrac{1}{2})}{\\Delta x}+\\frac{\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j+1)-\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta z}\\right].\n$$\n\nB. A collocated-grid scheme that stores all field components $v_x$, $v_z$, $\\sigma_{xx}$, $\\sigma_{zz}$, $\\sigma_{xz}$, and $\\sigma_{zx}$ at cell centers $(i,j)$ and time $t^n$, with stresses updated to $t^{n+1}$ without time staggering. The shear stresses are updated using one-sided spatial differences:\n$$\n\\sigma_{xz}^{n+1}(i,j)=\\sigma_{xz}^{n}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_x^{n}(i,j+1)-v_x^{n}(i,j)}{\\Delta z}+\\frac{v_z^{n}(i+1,j)-v_z^{n}(i,j)}{\\Delta x}\\right],\n$$\n$$\n\\sigma_{zx}^{n+1}(i,j)=\\sigma_{zx}^{n}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_z^{n}(i+1,j)-v_z^{n}(i,j)}{\\Delta x}+\\frac{v_x^{n}(i,j)-v_x^{n}(i,j-1)}{\\Delta z}\\right],\n$$\nand velocities are updated by forward–backward differences of stresses at the same centers.\n\nC. A staggered-grid scheme that uses the same placements as in option A but updates the shear stress with only one gradient component,\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})\n+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}\\right],\n$$\nand uses the same velocity and normal stress updates as in option A.\n\nD. A staggered-grid scheme that stores the shear stress at cell centers $(i,j)$ (rather than corners) and uses mixed forward–backward differences for velocity updates,\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_x^{n}(i,j+\\tfrac{1}{2})-v_x^{n}(i,j-\\tfrac{1}{2})}{\\Delta z}+\\frac{v_z^{n}(i+\\tfrac{1}{2},j)-v_z^{n}(i-\\tfrac{1}{2},j)}{\\Delta x}\\right],\n$$\n$$\nv_x^{n+1}(i+\\tfrac{1}{2},j)=v_x^{n}(i+\\tfrac{1}{2},j)+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xx}^{n+\\tfrac{1}{2}}(i+1,j)-\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta x}+\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j-1)}{\\Delta z}\\right],\n$$\n$$\nv_z^{n+1}(i,j+\\tfrac{1}{2})=v_z^{n}(i,j+\\tfrac{1}{2})+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i-1,j)}{\\Delta x}+\\frac{\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j+1)-\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta z}\\right].\n$$\n\nWhich option ensures $\\sigma_{ij}=\\sigma_{ji}$ to machine precision and eliminates spurious rigid-body rotation modes, while the other options exhibit artifacts characteristic of collocated or mismatched discretizations?",
            "solution": "The problem requires the selection of a finite-difference time-domain (FDTD) scheme for the 2D isotropic elastic wave equations that preserves stress symmetry and correctly handles rigid-body rotations. We begin by stating the governing continuous equations and the properties to be verified.\n\nThe velocity-stress formulation of the 2D isotropic linear elastic wave equations is given by:\nConservation of momentum:\n$$ \\rho \\frac{\\partial v_x}{\\partial t} = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xz}}{\\partial z} $$\n$$ \\rho \\frac{\\partial v_z}{\\partial t} = \\frac{\\partial \\sigma_{zx}}{\\partial x} + \\frac{\\partial \\sigma_{zz}}{\\partial z} $$\nConstitutive relations (Hooke's law for an isotropic solid):\n$$ \\frac{\\partial \\sigma_{xx}}{\\partial t} = (\\lambda + 2\\mu) \\frac{\\partial v_x}{\\partial x} + \\lambda \\frac{\\partial v_z}{\\partial z} $$\n$$ \\frac{\\partial \\sigma_{zz}}{\\partial t} = \\lambda \\frac{\\partial v_x}{\\partial x} + (\\lambda + 2\\mu) \\frac{\\partial v_z}{\\partial z} $$\n$$ \\frac{\\partial \\sigma_{xz}}{\\partial t} = \\mu \\left( \\frac{\\partial v_x}{\\partial z} + \\frac{\\partial v_z}{\\partial x} \\right) $$\nAnd for stress symmetry, $\\sigma_{zx} = \\sigma_{xz}$, which implies $\\frac{\\partial \\sigma_{zx}}{\\partial t} = \\frac{\\partial \\sigma_{xz}}{\\partial t}$.\n\nWe must analyze each proposed discrete scheme against two criteria:\n1.  **Preservation of stress symmetry**: The scheme must ensure $\\sigma_{xz} = \\sigma_{zx}$ to machine precision. A common way to achieve this is to compute only a single shear stress component, say $\\sigma_{xz}$, and use it in the update equations for both $v_x$ (representing $\\sigma_{xz}$) and $v_z$ (representing $\\sigma_{zx}$).\n2.  **Annihilation of rigid-body rotation modes**: A rigid-body rotation in the $x-z$ plane is described by the velocity field $v_x = -\\omega z$ and $v_z = \\omega x$ for some constant angular velocity $\\omega$. This velocity field corresponds to zero strain. A valid numerical scheme must not generate stresses from such a velocity field. This means that the discretized strain-rate terms must evaluate to zero for a discrete representation of this velocity field.\n\nLet's define the discrete derivative operators used in the FDTD schemes. A second-order centered difference of a field $f$ with respect to $x$ at location $(i,j)$ is typically of the form $D_x f(i,j) = \\frac{f(i+\\tfrac{1}{2},j) - f(i-\\tfrac{1}{2},j)}{\\Delta x}$.\n\n### Option-by-Option Analysis\n\n**Analysis of Option A**\n\nThis option proposes the standard rotated staggered grid, also known as the Virieux (1986) scheme.\n-   **Grid Staggering**: $v_x$ at $(i+\\tfrac{1}{2},j)$, $v_z$ at $(i,j+\\tfrac{1}{2})$, normal stresses $\\sigma_{xx}, \\sigma_{zz}$ at $(i,j)$, and shear stress $\\sigma_{xz}$ at $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$.\n-   **Stress Symmetry**: The scheme computes only one shear stress component, $\\sigma_{xz}$, and uses it in the updates for both $v_x$ and $v_z$. This enforces $\\sigma_{xz} = \\sigma_{zx}$ by construction. This property is satisfied.\n-   **Rigid-Body Rotation**: Let's discretize the rotation field $v_x = -\\omega z, v_z = \\omega x$ on the staggered grid.\n    $v_x$ is at $(x_{i+\\tfrac{1}{2}}, z_j)$, so $v_x^n(i+\\tfrac{1}{2}, j) = -\\omega z_j = -\\omega j \\Delta z$.\n    $v_z$ is at $(x_i, z_{j+\\tfrac{1}{2}})$, so $v_z^n(i, j+\\tfrac{1}{2}) = \\omega x_i = \\omega i \\Delta x$.\n\n    The updates for $\\sigma_{xx}$ and $\\sigma_{zz}$ at $(i,j)$ depend on the discrete approximations of $\\frac{\\partial v_x}{\\partial x}$ and $\\frac{\\partial v_z}{\\partial z}$:\n    $D_x v_x = \\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x} = \\frac{(-\\omega j \\Delta z) - (-\\omega j \\Delta z)}{\\Delta x} = 0$.\n    $D_z v_z = \\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z} = \\frac{(\\omega i \\Delta x) - (\\omega i \\Delta x)}{\\Delta z} = 0$.\n    Since these terms are zero, $\\sigma_{xx}$ and $\\sigma_{zz}$ are not spuriously generated.\n\n    The update for $\\sigma_{xz}$ at $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$ depends on the discrete approximation of $\\frac{\\partial v_x}{\\partial z} + \\frac{\\partial v_z}{\\partial x}$:\n    $D_z v_x = \\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z} = \\frac{(-\\omega (j+1) \\Delta z) - (-\\omega j \\Delta z)}{\\Delta z} = -\\omega$.\n    $D_x v_z = \\frac{v_z^n(i+1,j+\\tfrac{1}{2})-v_z^n(i,j+\\tfrac{1}{2})}{\\Delta x} = \\frac{(\\omega (i+1) \\Delta x) - (\\omega i \\Delta x)}{\\Delta x} = \\omega$.\n    The sum is $D_z v_x + D_x v_z = -\\omega + \\omega = 0$.\n    Thus, $\\sigma_{xz}$ is also not spuriously generated. All stress update equations yield zero change for a rigid-body rotation. This is because all spatial derivatives are naturally centered on the staggered grid.\n\n**Verdict for Option A**: Correct. The scheme satisfies both required properties.\n\n**Analysis of Option B**\n\nThis option proposes a collocated-grid scheme.\n-   **Grid Staggering**: All variables are located at the same points $(i,j)$. There is no time staggering.\n-   **Stress Symmetry**: The scheme updates $\\sigma_{xz}$ and $\\sigma_{zx}$ separately using different discrete formulas. For instance, $\\frac{\\partial v_x}{\\partial z}$ is approximated by a forward difference $\\frac{v_x^{n}(i,j+1)-v_x^{n}(i,j)}{\\Delta z}$ for the $\\sigma_{xz}$ update, but by a backward difference $\\frac{v_x^{n}(i,j)-v_x^{n}(i,j-1)}{\\Delta z}$ for the $\\sigma_{zx}$ update. Because the update rules are different, $\\sigma_{xz}$ and $\\sigma_{zx}$ will numerically diverge, violating symmetry. This is a known artifact of simple collocated schemes for elasticity. The property is not satisfied.\n-   **Time Stepping**: The problem statement specifies a leapfrog scheme, but Option B states \"stresses updated to $t^{n+1}$ without time staggering,\" which is not a leapfrog scheme. This violates a premise of the problem.\n\n**Verdict for Option B**: Incorrect. It fails to preserve stress symmetry and does not use the specified leapfrog time stepping.\n\n**Analysis of Option C**\n\nThis option uses the same staggered grid as Option A but modifies the shear stress update.\n-   **Grid Staggering**: Same as A.\n-   **Stress Symmetry**: A single shear stress component $\\sigma_{xz}$ is used. The property is satisfied.\n-   **Rigid-Body Rotation**: The update for $\\sigma_{xz}$ is given by:\n    $\\sigma_{xz}^{n+\\tfrac{1}{2}}(\\dots) = \\sigma_{xz}^{n-\\tfrac{1}{2}}(\\dots) + \\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}\\right]$.\n    This scheme only approximates $\\frac{\\partial \\sigma_{xz}}{\\partial t} = \\mu \\frac{\\partial v_x}{\\partial z}$, omitting the physically required $\\mu \\frac{\\partial v_z}{\\partial x}$ term. This is a fundamentally incorrect discretization of the governing equation.\n    Let's test this flawed scheme with the rigid-body rotation field. As calculated for Option A, the discrete term $D_z v_x$ evaluates to $-\\omega$. The missing $D_x v_z$ term would have evaluated to $+\\omega$. Because the second term is absent, the update for shear stress is non-zero: $\\frac{\\partial \\sigma_{xz}}{\\partial t} \\approx -\\mu\\omega \\neq 0$. This means a rigid-body rotation spuriously generates shear stress.\n\n**Verdict for Option C**: Incorrect. The scheme is physically inconsistent and fails to annihilate rigid-body rotation modes.\n\n**Analysis of Option D**\n\nThis option proposes a different staggered grid where the shear stress $\\sigma_{xz}$ is located at cell centers $(i,j)$ while other variables are placed as in Option A.\n-   **Grid Staggering**: $v_x$ at $(i+\\tfrac{1}{2},j)$, $v_z$ at $(i,j+\\tfrac{1}{2})$, $\\sigma_{xx}, \\sigma_{zz}$ at $(i,j)$, and $\\sigma_{xz}$ at $(i,j)$.\n-   **Internal Consistency**: The update for $\\sigma_{xz}$ is given as:\n    $\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)=\\dots+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i,j+\\tfrac{1}{2})-v_x^n(i,j-\\tfrac{1}{2})}{\\Delta z}+\\frac{v_z^n(i+\\tfrac{1}{2},j)-v_z^n(i-\\tfrac{1}{2},j)}{\\Delta x}\\right]$.\n    The formula requires $v_x$ at locations like $(i, j+\\tfrac{1}{2})$, but $v_x$ is defined on the grid at $(i+\\tfrac{1}{2},j)$. Similarly, it needs $v_z$ at $(i+\\tfrac{1}{2},j)$, but $v_z$ is defined at $(i,j+\\tfrac{1}{2})$. The formula is ill-defined as it queries variables at locations where they are not stored, without specifying an interpolation rule.\n-   **Derivative Centering**: Let's examine the velocity updates. The update for $v_x$ at $(i+\\tfrac{1}{2},j)$ involves the term $\\frac{\\partial \\sigma_{xz}}{\\partial z}$. The discrete formula is $\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j-1)}{\\Delta z}$. This finite difference is centered at location $(i, j-\\tfrac{1}{2})$. This is not the location of $v_x$, which is $(i+\\tfrac{1}{2},j)$. This spatial mismatch of the discrete derivative and the updated variable leads to reduced accuracy and can introduce numerical artifacts. A well-designed scheme, like Option A, has all derivatives centered exactly where they are needed.\n\n**Verdict for Option D**: Incorrect. The scheme is ill-defined as presented. Even if interpreted via some implicit interpolation, it suffers from misaligned derivative calculations, which is a known numerical deficiency (\"mismatched discretization\").\n\n### Conclusion\n\nOption A is the only scheme that is well-defined, correctly approximates the governing equations, and satisfies both crucial invariance properties: preservation of stress symmetry and annihilation of rigid-body rotation modes. These properties are a direct consequence of its specific staggered-grid structure, which ensures that the discrete operators have the correct adjoint relationships, mimicking the properties of the continuous differential operators. The other options all contain characteristic flaws of alternative discretizations.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Realistic geophysical models must account for sharp boundaries between different rock types, where material properties can change abruptly. A naive averaging of these properties across interfaces can lead to numerical instability and inaccurate wave reflections. This practice  delves into the crucial task of selecting physically-grounded averaging schemes for density $\\rho$ and elastic moduli $M$ on a staggered grid to ensure the continuity of physical quantities like stress and velocity, thereby conserving energy at a discrete level.",
            "id": "3593113",
            "problem": "Consider one-dimensional isotropic linear elasticity with longitudinal motion in $x$, governed by the conservation of linear momentum and Hooke’s law: $\\rho(x)\\,\\partial_t v(x,t)=\\partial_x \\sigma(x,t)$ and $\\partial_t \\sigma(x,t)=M(x)\\,\\partial_x v(x,t)$, where $v$ is particle velocity, $\\sigma$ is normal stress, $\\rho$ is density, and $M=\\lambda+2\\mu$ is the $P$-wave modulus expressed in terms of the Lamé parameters $\\lambda$ and $\\mu$. The continuous total energy density is $e=\\tfrac{1}{2}\\rho v^2+\\tfrac{1}{2}\\sigma^2/M$, and the continuous energy flux is $S=\\sigma v$. Assume a staggered-grid finite difference scheme in which $v$ is stored at half-grid locations $x_{i+1/2}$ and $\\sigma$ is stored at integer-grid locations $x_i$, with uniform spacing $\\Delta x$ and a planar material interface located at $x=x_0$ aligned with a stress grid point $x_{i_0}=x_0$. Material properties $\\rho$, $\\lambda$, and $\\mu$ are discontinuous at $x_0$, with strong contrast (e.g., order-one jumps).\n\nYou are asked to analyze the effect of different averaging schemes for placing $\\rho$, $\\lambda$, and $\\mu$ onto the staggered locations required by the discrete updates. Specifically, the velocity update requires $\\rho$ at $x_{i+1/2}$, and the stress update requires $M$ at $x_i$. When an averaging must be performed across the interface to supply a property at a staggered location that straddles two materials, three candidate averages are available: arithmetic, harmonic, and geometric. Using only first principles (conservation of linear momentum, Hooke’s law, and the definition of continuous energy density and flux), derive the discrete energy balance for the staggered scheme and determine which averaging choices ensure discrete energy flux continuity across $x_0$ and minimize spurious energy creation near the interface under strong contrast. In your analysis, connect the choice of averaging to the Courant–Friedrichs–Lewy (CFL) condition by discussing whether the local wave speed estimate near the interface is over- or under-estimated by each choice.\n\nWhich statement most accurately characterizes the averaging choices that yield the best stability and accuracy near strong property contrasts when judged by discrete energy flux continuity as the primary metric?\n\nA. Use the arithmetic average for both $\\rho$ and the moduli ($\\lambda$ and $\\mu$) at all staggered points; this preserves energy flux continuity and produces the most stable scheme near strong contrasts.\n\nB. Use the arithmetic average for $\\rho$ at velocity points and the harmonic average for the moduli, i.e., $\\lambda$ and $\\mu$ (equivalently $M=\\lambda+2\\mu$ in the $P$-wave update), at stress points; this choice enforces discrete energy flux continuity across the interface and improves stability and accuracy under strong contrasts.\n\nC. Use the geometric average for all three properties $\\rho$, $\\lambda$, and $\\mu$ at their staggered locations; this best preserves impedance and thereby guarantees energy flux continuity and stability.\n\nD. Use the harmonic average for $\\rho$ and the arithmetic average for $\\lambda$ and $\\mu$; this optimally balances mass and stiffness and gives the most accurate flux across strong contrasts.",
            "solution": "First, let's establish the physical principles at a continuous material interface located at $x=x_0$. For a welded contact, both displacement $u(x,t)$ and stress $\\sigma(x,t)$ must be continuous. Continuity of displacement implies continuity of particle velocity, $v = \\partial_t u$. Thus, we have:\n1.  $v(x_0^-, t) = v(x_0^+, t)$\n2.  $\\sigma(x_0^-, t) = \\sigma(x_0^+, t)$\n\nThese conditions have direct implications for the governing equations at the interface.\nFrom the first governing equation, $\\partial_t v = \\frac{1}{\\rho} \\partial_x \\sigma$. Since $v$ is continuous, $\\partial_t v$ is also continuous across the interface. As $\\rho$ is discontinuous, this implies that $\\partial_x \\sigma$ must have a jump such that the quantity $\\frac{1}{\\rho} \\partial_x \\sigma$ remains continuous.\nFrom the second governing equation, $\\partial_t \\sigma = M \\partial_x v$. Since $\\sigma$ is continuous, $\\partial_t \\sigma$ is also continuous. As the modulus $M$ is discontinuous, this implies that the strain rate $\\partial_x v$ must have a jump such that the quantity $M \\partial_x v$ remains continuous.\n\nAn accurate finite difference scheme should honor these continuity properties in its discrete form. This is achieved by selecting appropriate averaging schemes for the material properties $\\rho$ and $M$ at grid locations that straddle the interface.\n\nLet's analyze the averaging for the P-wave modulus $M = \\lambda+2\\mu$. The stress update is performed at integer grid points $x_i$, and requires $M_i$. If the interface is located at $x_{i_0}$, the value $M_{i_0}$ must be an effective modulus representing the properties of both materials, say $M_1$ and $M_2$. The stress update equation at $x_{i_0}$ is:\n$$ \\frac{\\sigma_{i_0}^{n+1} - \\sigma_{i_0}^n}{\\Delta t} = M_{i_0} \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0-1/2}^{n+1/2}}{\\Delta x} $$\nThe left side represents a discrete approximation of $\\partial_t \\sigma$ at $x_{i_0}$, which is continuous. The right side is a discrete approximation of $M \\partial_x v$, which is also continuous. The key physical insight is to consider the behavior of strain and stress across the interface grid cell $[x_{i_0-1/2}, x_{i_0+1/2}]$. Since stress $\\sigma$ is continuous, this is analogous to two springs connected in series. For materials in series, the compliances (inverse of stiffness) are additive. The strain across the cell is the sum of strains in each part. The effective compliance for the cell is the arithmetic average of the compliances of the two materials. The compliance is $1/M$.\nLet the grid cell centered at $x_{i_0}$ be composed of material $1$ on $[x_{i_0-1/2}, x_{i_0}]$ and material $2$ on $[x_{i_0}, x_{i_0+1/2}]$. The total strain increment over the cell $\\Delta x$ for a given stress $\\sigma$ is $\\Delta\\epsilon = (\\sigma/M_1)(\\Delta x/2) + (\\sigma/M_2)(\\Delta x/2)$. The effective modulus $M_{i_0}$ is defined by $\\Delta\\epsilon = (\\sigma/M_{i_0})\\Delta x$.\n$$ \\frac{\\sigma}{M_{i_0}} \\Delta x = \\sigma \\left( \\frac{1}{M_1} \\frac{\\Delta x}{2} + \\frac{1}{M_2} \\frac{\\Delta x}{2} \\right) \\implies \\frac{1}{M_{i_0}} = \\frac{1}{2}\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) $$\nThis is the definition of the harmonic average for $M_{i_0}$. An equivalent argument applies to $\\lambda$ and $\\mu$ individually if they are needed at the stress point.\n\nNext, let's analyze the averaging for density $\\rho$. The velocity update is performed at half-integer grid points $x_{i+1/2}$ and requires $\\rho_{i+1/2}$. If the interface is located at $x_{i_0+1/2}$, the value $\\rho_{i_0+1/2}$ must be an effective density. The velocity update equation is:\n$$ \\rho_{i_0+1/2} \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} = \\frac{\\sigma_{i_0+1}^n - \\sigma_{i_0}^n}{\\Delta x} $$\nThe left side is the product of mass per unit volume and acceleration (approximated discretely), and the right side is the force per unit volume. This equation is a discrete form of Newton's second law for the control volume $[x_{i_0}, x_{i_0+1}]$. The total mass in this volume is $\\text{mass} = \\rho_1 (\\Delta x/2) + \\rho_2 (\\Delta x/2)$. The net force is $\\sigma_{i_0+1}^n - \\sigma_{i_0}^n$. Applying Newton's law (Mass $\\times$ Acceleration = Force):\n$$ (\\rho_1 \\frac{\\Delta x}{2} + \\rho_2 \\frac{\\Delta x}{2}) \\left( \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} \\right) = \\sigma_{i_0+1}^n - \\sigma_{i_0}^n $$\nRearranging this to match the finite difference form, we get:\n$$ \\frac{\\rho_1 + \\rho_2}{2} \\left( \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} \\right) = \\frac{\\sigma_{i_0+1}^n - \\sigma_{i_0}^n}{\\Delta x} $$\nThis shows that the effective density $\\rho_{i_0+1/2}$ must be the arithmetic average of $\\rho_1$ and $\\rho_2$.\n\nThese choices of averaging ensure that the discrete scheme correctly honors the physical continuity conditions at the interface. This, in turn, minimizes the generation of spurious numerical energy and ensures the discrete form of energy flux continuity. The stability of the scheme near strong contrasts is thereby improved not by manipulating the CFL condition directly, but by constructing a more physically accurate and less oscillatory scheme. With arithmetic averaging for modulus $M$, the local wave speed $c = \\sqrt{M/\\rho}$ might be overestimated (since arithmetic mean is always greater than or equal to harmonic mean), potentially leading to a less restrictive but physically incorrect local condition. The combination of harmonic average for moduli and arithmetic average for density provides the highest stability and accuracy.\n\nWe now evaluate the given options based on this derivation.\n\nA. Use the arithmetic average for both $\\rho$ and the moduli ($\\lambda$ and $\\mu$) at all staggered points; this preserves energy flux continuity and produces the most stable scheme near strong contrasts.\nThis is incorrect. While the arithmetic average is correct for $\\rho$, it is incorrect for the elastic moduli $M$, $\\lambda$, and $\\mu$. Using the arithmetic average for moduli corresponds to assuming continuity of strain, which is physically false at an interface where stress is continuous and modulus is discontinuous. This choice violates the physical principles and does not ensure discrete energy flux continuity.\n\nB. Use the arithmetic average for $\\rho$ at velocity points and the harmonic average for the moduli, i.e., $\\lambda$ and $\\mu$ (equivalently $M=\\lambda+2\\mu$ in the $P$-wave update), at stress points; this choice enforces discrete energy flux continuity across the interface and improves stability and accuracy under strong contrasts.\nThis is correct. Our derivation from first principles (continuity of stress and Newton's second law for a control volume) shows that the harmonic average is appropriate for the moduli ($M$, and by extension $\\lambda$ and $\\mu$) and the arithmetic average is appropriate for the density ($\\rho$). This combination honors the physical continuity conditions, which is the discrete equivalent of ensuring energy flux continuity, and is known to provide the most stable and accurate results for staggered-grid schemes at strong-contrast interfaces.\n\nC. Use the geometric average for all three properties $\\rho$, $\\lambda$, and $\\mu$ at their staggered locations; this best preserves impedance and thereby guarantees energy flux continuity and stability.\nThis is incorrect. The geometric mean is not supported by the derivation from first principles for either density or moduli in this context. While impedance is an important concept for reflection/transmission, applying its preservation as a rule for averaging the constituent parameters is not physically justified for the discretization of the PDE operators themselves.\n\nD. Use the harmonic average for $\\rho$ and the arithmetic average for $\\lambda$ and $\\mu$; this optimally balances mass and stiffness and gives the most accurate flux across strong contrasts.\nThis is incorrect. This statement proposes the exact opposite of the correct scheme derived from physical principles. The harmonic average is incorrect for $\\rho$, and the arithmetic average is incorrect for the moduli.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "The choice of the time step $\\Delta t$ is a critical balancing act between computational cost, numerical stability, and simulation accuracy. A time step that is too large will cause the simulation to become unstable, while one that is too small will be computationally inefficient. This exercise guides you through the process of selecting an optimal $\\Delta t$ that not only satisfies the well-known Courant–Friedrichs–Lewy (CFL) stability condition but also adheres to a strict constraint on numerical dispersion , ensuring that simulated waves propagate at the correct speed without accumulating significant phase errors.",
            "id": "3593130",
            "problem": "Consider one-dimensional propagation of small-amplitude elastic longitudinal waves in a homogeneous, isotropic solid. Let the mass density be $\\rho = 2700\\,\\mathrm{kg/m^3}$, the first Lamé parameter be $\\lambda = 20\\times 10^{9}\\,\\mathrm{Pa}$, and the shear modulus be $\\mu = 30\\times 10^{9}\\,\\mathrm{Pa}$. You will model the displacement field $u(x,t)$ using a second-order accurate central difference in time and a second-order accurate central difference in space on a uniform grid with spacing $\\Delta x = 2\\,\\mathrm{m}$. Assume that spatial dispersion is controlled by a sufficiently fine spatial resolution for the frequencies of interest, so that temporal dispersion dominates at the maximum modeling frequency.\n\nYour task is to select a single time step $\\Delta t$ that simultaneously satisfies:\n- the Courant–Friedrichs–Lewy (CFL) stability condition for the explicit scheme, and\n- a temporal phase error constraint at the maximum frequency $f_{\\max} = 500\\,\\mathrm{Hz}$ such that the relative temporal phase velocity error does not exceed $\\varepsilon = 0.005$.\n\nStarting from first principles (linear momentum balance and linear isotropic elasticity), derive the wave speed that controls the stability, derive the stability condition for the chosen second-order finite difference scheme, and derive a leading-order bound on $\\Delta t$ implied by the temporal dispersion requirement at angular frequency $\\omega_{\\max} = 2\\pi f_{\\max}$. Then, choose $\\Delta t$ as the minimum of the stability-limited time step and the temporal-dispersion-limited time step. Round your answer to four significant figures. Express the time step in seconds.",
            "solution": "### Derivation of the Governing Equation and Wave Speed\n\nThe one-dimensional equation of linear momentum balance is\n$$\n\\frac{\\partial \\sigma_{xx}}{\\partial x} = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\nwhere $\\sigma_{xx}$ is the longitudinal stress, $u$ is the longitudinal displacement, and $\\rho$ is the mass density.\n\nFor a linear isotropic elastic solid, the stress-strain relationship (Hooke's Law) in one dimension is\n$$\n\\sigma_{xx} = (\\lambda + 2\\mu) \\varepsilon_{xx}\n$$\nwhere $\\varepsilon_{xx}$ is the longitudinal strain, and $\\lambda$ and $\\mu$ are the Lamé parameters. The strain is related to the displacement by\n$$\n\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}\n$$\nSubstituting the strain-displacement and stress-strain relations into the momentum equation, we obtain\n$$\n\\frac{\\partial}{\\partial x} \\left( (\\lambda + 2\\mu) \\frac{\\partial u}{\\partial x} \\right) = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\nFor a homogeneous medium, $\\lambda$, $\\mu$, and $\\rho$ are constants. The equation simplifies to the one-dimensional elastic wave equation:\n$$\n(\\lambda + 2\\mu) \\frac{\\partial^2 u}{\\partial x^2} = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\nThis can be written in the standard form $\\frac{\\partial^2 u}{\\partial t^2} = c_p^2 \\frac{\\partial^2 u}{\\partial x^2}$, where $c_p$ is the compressional (P-wave) velocity, given by\n$$\nc_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}\n$$\nUsing the provided values:\n-   $\\lambda = 20 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\mu = 30 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\rho = 2700\\,\\mathrm{kg/m^3}$\n\nThe P-wave modulus is $M = \\lambda + 2\\mu = (20 \\times 10^9) + 2(30 \\times 10^9) = 80 \\times 10^9\\,\\mathrm{Pa}$.\nThe P-wave velocity is:\n$$\nc_p = \\sqrt{\\frac{80 \\times 10^9\\,\\mathrm{Pa}}{2700\\,\\mathrm{kg/m^3}}} = \\sqrt{\\frac{800}{27} \\times 10^6}\\,\\mathrm{m/s} \\approx 5443.3105\\,\\mathrm{m/s}\n$$\n\n### Stability Condition (CFL)\n\nThe problem specifies a second-order accurate central difference scheme in both time and space. The wave equation is discretized as:\n$$\n\\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{\\Delta t^2} = c_p^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\n$$\nwhere $u_j^n = u(j\\Delta x, n\\Delta t)$. For this explicit scheme, the Courant–Friedrichs–Lewy (CFL) stability condition is:\n$$\nS = \\frac{c_p \\Delta t}{\\Delta x} \\le 1\n$$\nwhere $S$ is the Courant number. This condition sets an upper bound on the time step for the scheme to be stable. The maximum time step allowed by stability is:\n$$\n\\Delta t_{\\text{stab}} = \\frac{\\Delta x}{c_p}\n$$\nUsing the given grid spacing $\\Delta x = 2\\,\\mathrm{m}$ and the calculated wave speed:\n$$\n\\Delta t_{\\text{stab}} = \\frac{2\\,\\mathrm{m}}{5443.3105\\,\\mathrm{m/s}} \\approx 3.6724 \\times 10^{-4}\\,\\mathrm{s}\n$$\n\n### Temporal Dispersion Constraint\n\nThe problem states that temporal dispersion dominates. This allows us to analyze the effect of time discretization independently of spatial discretization. We consider the semi-discretized equation in time, where the spatial derivatives are treated analytically. For a single harmonic component with angular frequency $\\omega_{\\text{phy}}$, the wave equation is $\\frac{\\partial^2 u}{\\partial t^2} = -\\omega_{\\text{phy}}^2 u$. Applying the second-order central difference operator in time gives:\n$$\n\\frac{u(t+\\Delta t) - 2u(t) + u(t-\\Delta t)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2 u(t)\n$$\nWe seek a numerical solution of the form $u(t) = \\exp(-i\\omega_{\\text{num}}t)$, where $\\omega_{\\text{num}}$ is the numerical angular frequency. Substituting this into the difference equation yields:\n$$\n\\frac{\\exp(-i\\omega_{\\text{num}}\\Delta t) - 2 + \\exp(i\\omega_{\\text{num}}\\Delta t)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n$$\n\\frac{2\\cos(\\omega_{\\text{num}}\\Delta t) - 2}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\nUsing the identity $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$:\n$$\n\\frac{-4\\sin^2(\\omega_{\\text{num}}\\Delta t / 2)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n$$\n\\frac{2\\sin(\\omega_{\\text{num}}\\Delta t / 2)}{\\Delta t} = \\omega_{\\text{phy}}\n$$\nThis is the dispersion relation for the semi-discretized system. From this, we solve for the numerical frequency $\\omega_{\\text{num}}$:\n$$\n\\omega_{\\text{num}} = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right)\n$$\nThe numerical phase velocity is $c_{\\text{num}} = c_p \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{phy}}}$. The relative phase velocity error $E_v$ is:\n$$\nE_v = \\frac{c_{\\text{num}}}{c_p} - 1 = \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{phy}}} - 1 = \\frac{2}{\\omega_{\\text{phy}}\\Delta t} \\arcsin\\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right) - 1\n$$\nFor small arguments $y$, the Taylor expansion of $\\arcsin(y)$ is $y + \\frac{y^3}{6} + O(y^5)$. Let $y = \\frac{\\omega_{\\text{phy}}\\Delta t}{2}$. For a small time step, $y$ is small, and we can approximate the error to leading order:\n$$\nE_v \\approx \\frac{1}{y} \\left(y + \\frac{y^3}{6}\\right) - 1 = \\left(1 + \\frac{y^2}{6}\\right) - 1 = \\frac{y^2}{6}\n$$\nSubstituting back $y$:\n$$\nE_v \\approx \\frac{1}{6} \\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right)^2 = \\frac{\\omega_{\\text{phy}}^2 \\Delta t^2}{24}\n$$\nThe problem requires that this error not exceed $\\varepsilon = 0.005$ at the maximum frequency $f_{\\max} = 500\\,\\mathrm{Hz}$, which corresponds to the maximum angular frequency $\\omega_{\\max} = 2\\pi f_{\\max} = 2\\pi(500) = 1000\\pi\\,\\mathrm{rad/s}$.\nThe constraint is:\n$$\n\\frac{\\omega_{\\max}^2 \\Delta t^2}{24} \\le \\varepsilon\n$$\nSolving for $\\Delta t$ gives the dispersion-limited time step, $\\Delta t_{\\text{disp}}$:\n$$\n\\Delta t \\le \\frac{\\sqrt{24\\varepsilon}}{\\omega_{\\max}} \\implies \\Delta t_{\\text{disp}} = \\frac{\\sqrt{24\\varepsilon}}{\\omega_{\\max}}\n$$\nPlugging in the values $\\varepsilon = 0.005$ and $\\omega_{\\max} = 1000\\pi\\,\\mathrm{rad/s}$:\n$$\n\\Delta t_{\\text{disp}} = \\frac{\\sqrt{24 \\times 0.005}}{1000\\pi} = \\frac{\\sqrt{0.12}}{1000\\pi} \\approx \\frac{0.346410}{3141.5927} \\approx 1.10266 \\times 10^{-4}\\,\\mathrm{s}\n$$\n\n### Final Time Step Selection\n\nThe time step $\\Delta t$ must satisfy both the stability and dispersion constraints. Therefore, it must be the minimum of the two derived upper bounds:\n$$\n\\Delta t \\le \\min(\\Delta t_{\\text{stab}}, \\Delta t_{\\text{disp}})\n$$\nWe have:\n-   $\\Delta t_{\\text{stab}} \\approx 3.6724 \\times 10^{-4}\\,\\mathrm{s}$\n-   $\\Delta t_{\\text{disp}} \\approx 1.10266 \\times 10^{-4}\\,\\mathrm{s}$\n\nThe more stringent constraint is imposed by the temporal dispersion requirement. Thus, the maximum allowable time step is $\\Delta t = \\Delta t_{\\text{disp}}$.\n$$\n\\Delta t = 1.10266 \\times 10^{-4}\\,\\mathrm{s}\n$$\nRounding to four significant figures, we get:\n$$\n\\Delta t = 1.103 \\times 10^{-4}\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{1.103 \\times 10^{-4}}\n$$"
        }
    ]
}