{
    "hands_on_practices": [
        {
            "introduction": "Before we can simulate complex wave phenomena, we must first master the fundamental building block of any finite difference model: the numerical approximation of a derivative. This foundational exercise guides you through the process of deriving the coefficients for a high-order finite difference stencil directly from Taylor's theorem. By completing this practice , you will gain a first-principles understanding of how accuracy is defined and achieved, and how the choice of a numerical operator directly influences the local truncation error, a key concept in analyzing numerical methods.",
            "id": "3592389",
            "problem": "In finite difference (FD) modeling of earthquake ground motion, the one-dimensional velocity–stress formulation involves spatial derivatives such as $\\partial \\sigma / \\partial x$, where $\\sigma(x,t)$ is the normal stress. Consider a uniform grid $x_i = x_0 + i h$ with spacing $h>0$, and an interior point $x_i$. You aim to approximate $\\partial \\sigma / \\partial x$ at $x_i$ with a centered, symmetric, $5$-point stencil using samples $\\{\\sigma_{i-2},\\sigma_{i-1},\\sigma_i,\\sigma_{i+1},\\sigma_{i+2}\\}$:\n$$\nD_x \\sigma_i \\equiv \\frac{1}{h} \\sum_{k=-2}^{2} c_k \\,\\sigma_{i+k},\n$$\nwhere the coefficients $c_k$ are independent of $i$ and $h$. Starting only from Taylor’s theorem about smooth functions expanded about $x_i$ and the definition of the first derivative, derive the coefficients $c_k$ so that $D_x \\sigma_i$ is a $4$th-order accurate approximation to $\\partial \\sigma / \\partial x$ at $x_i$; that is, the local truncation error is $\\mathcal{O}(h^4)$. Then, verify from first principles the following consistency and accuracy conditions implied by your construction:\n$\\,\\,$(i) $\\sum_{k=-2}^{2} c_k = 0$, $\\,\\,$(ii) $\\sum_{k=-2}^{2} k\\,c_k = 1$, $\\,\\,$(iii) $\\sum_{k=-2}^{2} k^m c_k = 0$ for $m=2,3$, and determine explicitly the leading truncation error coefficient multiplying $h^4\\,\\sigma^{(5)}(x_i)$. \n\nExpress your final result as the row vector $(c_{-2},c_{-1},c_{0},c_{1},c_{2})$ with exact rational entries. No rounding is required. The final answer should not include physical units.",
            "solution": "The problem asks for the derivation of coefficients for a $5$-point, centered, symmetric finite difference stencil that approximates the first derivative $\\partial \\sigma / \\partial x$ with $4$th-order accuracy. We must also verify certain properties of these coefficients and determine the leading truncation error term.\n\nLet the approximation of the derivative $\\frac{\\partial \\sigma}{\\partial x}$ at a grid point $x_i$ be denoted by $D_x \\sigma_i$. The given form of the approximation is:\n$$\nD_x \\sigma_i = \\frac{1}{h} \\sum_{k=-2}^{2} c_k \\,\\sigma_{i+k} = \\frac{1}{h} (c_{-2}\\sigma_{i-2} + c_{-1}\\sigma_{i-1} + c_{0}\\sigma_{i} + c_{1}\\sigma_{i+1} + c_{2}\\sigma_{i+2})\n$$\nwhere $\\sigma_{i+k} = \\sigma(x_i + kh)$. To determine the coefficients $c_k$, we expand each term $\\sigma_{i+k}$ in a Taylor series around the point $x_i$, assuming $\\sigma(x)$ is sufficiently smooth. The expansion is:\n$$\n\\sigma(x_i + kh) = \\sigma(x_i) + (kh) \\sigma'(x_i) + \\frac{(kh)^2}{2!} \\sigma''(x_i) + \\frac{(kh)^3}{3!} \\sigma'''(x_i) + \\frac{(kh)^4}{4!} \\sigma^{(4)}(x_i) + \\frac{(kh)^5}{5!} \\sigma^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\nwhere $\\sigma^{(m)}(x_i)$ denotes the $m$-th derivative of $\\sigma$ evaluated at $x_i$.\n\nSubstituting these expansions into the formula for $D_x \\sigma_i$, we get:\n$$\nD_x \\sigma_i = \\frac{1}{h} \\sum_{k=-2}^{2} c_k \\left[ \\sigma(x_i) + kh \\sigma'(x_i) + \\frac{k^2h^2}{2} \\sigma''(x_i) + \\frac{k^3h^3}{6} \\sigma'''(x_i) + \\frac{k^4h^4}{24} \\sigma^{(4)}(x_i) + \\frac{k^5h^5}{120} \\sigma^{(5)}(x_i) + \\dots \\right]\n$$\nWe can regroup the terms by the derivatives of $\\sigma(x_i)$:\n$$\nD_x \\sigma_i = \\frac{\\sigma(x_i)}{h}\\left(\\sum_{k=-2}^{2} c_k\\right) + \\sigma'(x_i)\\left(\\sum_{k=-2}^{2} k c_k\\right) + h\\frac{\\sigma''(x_i)}{2}\\left(\\sum_{k=-2}^{2} k^2 c_k\\right) + h^2\\frac{\\sigma'''(x_i)}{6}\\left(\\sum_{k=-2}^{2} k^3 c_k\\right) + h^3\\frac{\\sigma^{(4)}(x_i)}{24}\\left(\\sum_{k=-2}^{2} k^4 c_k\\right) + h^4\\frac{\\sigma^{(5)}(x_i)}{120}\\left(\\sum_{k=-2}^{2} k^5 c_k\\right) + \\dots\n$$\nFor $D_x \\sigma_i$ to be a $4$th-order accurate approximation of $\\sigma'(x_i)$, the local truncation error $T_i = D_x \\sigma_i - \\sigma'(x_i)$ must be of order $\\mathcal{O}(h^4)$. This requires matching the coefficients of the derivatives on both sides of the equation $D_x \\sigma_i = \\sigma'(x_i) + \\mathcal{O}(h^4)$ up to the term proportional to $h^3$. This yields a system of linear equations for the coefficients $c_k$:\n\\begin{enumerate}\n    \\item Coefficient of $\\sigma(x_i)$: $\\sum_{k=-2}^{2} c_k = 0$\n    \\item Coefficient of $\\sigma'(x_i)$: $\\sum_{k=-2}^{2} k c_k = 1$\n    \\item Coefficient of $h\\sigma''(x_i)$: $\\sum_{k=-2}^{2} k^2 c_k = 0$\n    \\item Coefficient of $h^2\\sigma'''(x_i)$: $\\sum_{k=-2}^{2} k^3 c_k = 0$\n    \\item Coefficient of $h^3\\sigma^{(4)}(x_i)$: $\\sum_{k=-2}^{2} k^4 c_k = 0$\n\\end{enumerate}\nThis is a system of $5$ equations for the $5$ unknowns $(c_{-2}, c_{-1}, c_0, c_1, c_2)$.\n\nFrom the given property that the stencil is centered and symmetric, we expect $c_{-k} = -c_k$ for a first derivative approximation, which also implies $c_0=0$. Let's derive this from the system.\nEquations $3$ and $5$ involve even powers of $k$:\nEq. 3: $4c_{-2} + c_{-1} + c_1 + 4c_2 = 0 \\implies (c_{-1}+c_1) + 4(c_{-2}+c_2) = 0$\nEq. 5: $16c_{-2} + c_{-1} + c_1 + 16c_2 = 0 \\implies (c_{-1}+c_1) + 16(c_{-2}+c_2) = 0$\nSubtracting these two equations gives $12(c_{-2}+c_2) = 0$, which implies $c_{-2} = -c_2$. Substituting this back into either equation gives $c_{-1}+c_1 = 0$, so $c_{-1}=-c_1$.\nNow, from Equation 1:\n$c_{-2} + c_{-1} + c_0 + c_1 + c_2 = c_0 + (c_{-1}+c_1) + (c_{-2}+c_2) = c_0 + 0 + 0 = 0 \\implies c_0=0$.\nThe properties $c_{-k} = -c_k$ and $c_0=0$ are thus consequences of the accuracy requirements for a centered stencil.\n\nWe use the remaining equations (for odd powers of $k$) to find the values of $c_1$ and $c_2$.\nEq. 2: $\\sum k c_k = -2c_{-2} - c_{-1} + c_1 + 2c_2 = 1$. Substituting $c_{-k}=-c_k$:\n$-2(-c_2) - (-c_1) + c_1 + 2c_2 = 1 \\implies 2c_2+c_1+c_1+2c_2 = 1 \\implies 2c_1 + 4c_2 = 1$.\n\nEq. 4: $\\sum k^3 c_k = -8c_{-2} - c_{-1} + c_1 + 8c_2 = 0$. Substituting $c_{-k}=-c_k$:\n$-8(-c_2) - (-c_1) + c_1 + 8c_2 = 0 \\implies 8c_2+c_1+c_1+8c_2 = 0 \\implies 2c_1 + 16c_2 = 0$.\n\nWe now have a system of two equations for $c_1$ and $c_2$:\n(A) $2c_1 + 4c_2 = 1$\n(B) $2c_1 + 16c_2 = 0$\nSubtracting (A) from (B): $(2c_1 + 16c_2) - (2c_1 + 4c_2) = 0 - 1 \\implies 12c_2 = -1 \\implies c_2 = -\\frac{1}{12}$.\nSubstitute $c_2$ into (B): $2c_1 + 16(-\\frac{1}{12}) = 0 \\implies 2c_1 - \\frac{16}{12} = 0 \\implies 2c_1 = \\frac{4}{3} \\implies c_1 = \\frac{2}{3}$.\n\nThe coefficients are therefore:\n$c_2 = -\\frac{1}{12}$\n$c_1 = \\frac{2}{3}$\n$c_0 = 0$\n$c_{-1} = -c_1 = -\\frac{2}{3}$\n$c_{-2} = -c_2 = \\frac{1}{12}$\nThe vector of coefficients is $(c_{-2}, c_{-1}, c_0, c_1, c_2) = (\\frac{1}{12}, -\\frac{2}{3}, 0, \\frac{2}{3}, -\\frac{1}{12})$.\n\nNext, we verify the consistency and accuracy conditions as requested. These conditions are the same as those used in the derivation. We demonstrate that our calculated coefficients satisfy them.\n(i) $\\sum_{k=-2}^{2} c_k = \\frac{1}{12} - \\frac{2}{3} + 0 + \\frac{2}{3} - \\frac{1}{12} = 0$. This is satisfied.\n(ii) $\\sum_{k=-2}^{2} k\\,c_k = (-2)(\\frac{1}{12}) + (-1)(-\\frac{2}{3}) + (1)(\\frac{2}{3}) + (2)(-\\frac{1}{12}) = -\\frac{2}{12} + \\frac{2}{3} + \\frac{2}{3} - \\frac{2}{12} = -\\frac{4}{12} + \\frac{4}{3} = -\\frac{1}{3} + \\frac{4}{3} = \\frac{3}{3} = 1$. This is satisfied.\n(iii) $\\sum_{k=-2}^{2} k^m c_k = 0$ for $m=2,3$.\nFor $m=2$: $\\sum_{k=-2}^{2} k^2 c_k = (-2)^2(\\frac{1}{12}) + (-1)^2(-\\frac{2}{3}) + (1)^2(\\frac{2}{3}) + (2)^2(-\\frac{1}{12}) = \\frac{4}{12} - \\frac{2}{3} + \\frac{2}{3} - \\frac{4}{12} = 0$. This is satisfied.\nFor $m=3$: $\\sum_{k=-2}^{2} k^3 c_k = (-2)^3(\\frac{1}{12}) + (-1)^3(-\\frac{2}{3}) + (1)^3(\\frac{2}{3}) + (2)^3(-\\frac{1}{12}) = -\\frac{8}{12} + \\frac{2}{3} + \\frac{2}{3} - \\frac{8}{12} = -\\frac{16}{12} + \\frac{4}{3} = -\\frac{4}{3} + \\frac{4}{3} = 0$. This is satisfied.\nAs required by the construction, all conditions hold.\n\nFinally, we determine the leading truncation error term. The local truncation error is $T_i = D_x \\sigma_i - \\sigma'(x_i)$. From our expansion of $D_x \\sigma_i$, the first non-zero term after $\\sigma'(x_i)$ defines the leading error term. Since all sums up to $k^4$ are zeroed out or set to produce $\\sigma'(x_i)$, the leading error term is:\n$$\nT_i = h^4 \\frac{\\sigma^{(5)}(x_i)}{5!} \\left(\\sum_{k=-2}^{2} k^5 c_k\\right) + \\mathcal{O}(h^5)\n$$\nWe compute the sum $\\sum k^5 c_k$:\n$$\n\\sum_{k=-2}^{2} k^5 c_k = (-2)^5 c_{-2} + (-1)^5 c_{-1} + (1)^5 c_1 + (2)^5 c_2\n$$\nUsing $c_{-k}=-c_k$:\n$$\n= (-32)( -c_2 ) + (-1)( -c_1 ) + c_1 + 32 c_2 = 32c_2 + c_1 + c_1 + 32c_2 = 2c_1 + 64c_2\n$$\nSubstituting the derived values $c_1 = \\frac{2}{3}$ and $c_2 = -\\frac{1}{12}$:\n$$\n\\sum_{k=-2}^{2} k^5 c_k = 2\\left(\\frac{2}{3}\\right) + 64\\left(-\\frac{1}{12}\\right) = \\frac{4}{3} - \\frac{64}{12} = \\frac{4}{3} - \\frac{16}{3} = -\\frac{12}{3} = -4\n$$\nThe leading truncation error term is therefore:\n$$\nT_i = h^4 \\frac{\\sigma^{(5)}(x_i)}{120} (-4) = -\\frac{4}{120} h^4 \\sigma^{(5)}(x_i) = -\\frac{1}{30} h^4 \\sigma^{(5)}(x_i)\n$$\nThe coefficient multiplying $h^4 \\sigma^{(5)}(x_i)$ is $-\\frac{1}{30}$. The problem, however, asks only for the vector of coefficients as the final answer.",
            "answer": "$$\n\\boxed{\\left(\\frac{1}{12}, -\\frac{2}{3}, 0, \\frac{2}{3}, -\\frac{1}{12}\\right)}\n$$"
        },
        {
            "introduction": "A numerically stable simulation is a prerequisite for any meaningful scientific result. This hands-on practice  moves from theoretical derivation to a critical diagnostic skill: identifying the cause of instability in a simulation. You will analyze several hypothetical scenarios where a 2D wave simulation has failed, applying your knowledge of the Courant–Friedrichs–Lewy (CFL) condition to pinpoint the exact regions in the computational grid where the \"speed limit\" for numerical information transfer has been violated, leading to catastrophic failure.",
            "id": "3592396",
            "problem": "You are analyzing a two-dimensional explicit finite difference time-domain simulation of earthquake ground motion governed by the acoustic wave equation in heterogeneous media. The fundamental base is that wave propagation in an isotropic, lossless medium is described by the second-order partial differential equation\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c(\\mathbf{x})^2 \\nabla^2 u,\n$$\nwhere $u$ is the scalar displacement potential, $t$ is time, $\\mathbf{x}=(x,y)$ is position, $c(\\mathbf{x})$ is the position-dependent phase velocity, and $\\nabla^2$ is the Laplacian operator. The simulation uses explicit, centered finite differences in both space and time on a uniform rectilinear grid with spacings $\\Delta x$ and $\\Delta y$ and a fixed time step $\\Delta t$. The grid indexing is defined such that the $x$-index $i$ runs from $0$ to $N_x-1$ along the $x$-axis and the $y$-index $j$ runs from $0$ to $N_y-1$ along the $y$-axis.\n\nThe Courant–Friedrichs–Lewy (CFL) number is the nondimensional quantity that compares the time step to the fastest characteristic propagation over a grid cell. In a heterogeneous medium, the local CFL number depends on $c(\\mathbf{x})$ and the grid spacings. When the local CFL number exceeds the stability limit of the chosen explicit scheme, numerical instability is triggered, and the simulation may blow up after a finite number of time steps. Your task is to compute, for each provided test case, the maximum local CFL number over the grid and to identify the smallest axis-aligned bounding box of grid indices that encloses all points where instability is triggered by exceeding the stability criterion corresponding to a second-order accurate explicit central-difference scheme in two spatial dimensions.\n\nAll physical quantities must be handled with consistent units: use meters for spatial spacings and meters per second for velocities, and seconds for time. The answers for the maximum local CFL number must be reported as dimensionless floating-point values. Index bounds must be reported as integers referring to grid indices.\n\nDefine the instability region as the set of grid points $(i,j)$ where the local CFL number strictly exceeds the stability limit of the scheme. If no instability is triggered in a test case, the instability region is empty. The grid region to be reported is the minimal axis-aligned bounding box $[i_{\\min}, i_{\\max}, j_{\\min}, j_{\\max}]$ that contains all unstable points. If the instability region is empty, return an empty list for that test case.\n\nYour program should produce a single line of output containing a list of per-case results, one per test case, where each per-case result is itself a two-element list:\n- The first element is the maximum local CFL number over the grid, as a floating-point value.\n- The second element is either an empty list if no instability is triggered, or the four-element integer list $[i_{\\min}, i_{\\max}, j_{\\min}, j_{\\max}]$ as defined above.\n\nFor example, the output format must be\n$$\n[\\,[\\text{cfl}_1, [i_{\\min,1}, i_{\\max,1}, j_{\\min,1}, j_{\\max,1}]], \\; [\\text{cfl}_2, [\\dots]], \\; \\ldots\\,],\n$$\nprinted as a single line with no additional text.\n\nUse the following test suite, which is designed to exercise different aspects of the computation. In all cases, the medium is heterogeneous and $c(\\mathbf{x})$ is specified by a known spatial pattern over the uniform grid.\n\nTest case $1$ (heterogeneous lens; likely unstable due to a high-velocity inclusion):\n- Grid size: $N_x = 256$, $N_y = 192$.\n- Grid spacings: $\\Delta x = 7.5\\,\\text{m}$, $\\Delta y = 7.5\\,\\text{m}$.\n- Time step: $\\Delta t = 0.0012\\,\\text{s}$.\n- Velocity field: background velocity $c(\\mathbf{x}) = 2000\\,\\text{m/s}$, with an elliptical high-velocity inclusion of $4500\\,\\text{m/s}$ centered at the grid center. The ellipse is defined by the set of points $(x,y)$ satisfying $((x-x_0)/a)^2 + ((y-y_0)/b)^2 \\le 1$, where $(x_0,y_0)$ is the grid center, $a = 300\\,\\text{m}$ and $b = 225\\,\\text{m}$. Use $x=i\\,\\Delta x$, $y=j\\,\\Delta y$.\n\nTest case $2$ (layered medium; borderline stability near the top layer):\n- Grid size: $N_x = 128$, $N_y = 128$.\n- Grid spacings: $\\Delta x = 10\\,\\text{m}$, $\\Delta y = 8\\,\\text{m}$.\n- Time step: $\\Delta t = 0.001104\\,\\text{s}$.\n- Velocity field: a top layer occupying indices $j \\le 31$ has $c(\\mathbf{x}) = 4000\\,\\text{m/s}$; the remainder has $c(\\mathbf{x}) = 1800\\,\\text{m/s}$.\n\nTest case $3$ (highly anisotropic grid spacings; instability near a bottom stripe):\n- Grid size: $N_x = 64$, $N_y = 512$.\n- Grid spacings: $\\Delta x = 20\\,\\text{m}$, $\\Delta y = 2\\,\\text{m}$.\n- Time step: $\\Delta t = 0.0004\\,\\text{s}$.\n- Velocity field: background velocity $c(\\mathbf{x}) = 2500\\,\\text{m/s}$, with a bottom stripe of high velocity $c(\\mathbf{x}) = 5000\\,\\text{m/s}$ occupying indices $j \\ge 448$.\n\nYour program must compute, for each test case, the maximum local CFL number and the minimal axis-aligned bounding box of grid indices enclosing all points where the local CFL number strictly exceeds the stability limit for a second-order accurate explicit central-difference scheme in two spatial dimensions. Express the CFL numbers as dimensionless floats and the bounding boxes as integer lists. The final output must be a single line containing the results as a comma-separated list enclosed in square brackets, following the format specified above.",
            "solution": "The problem has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution.\n\nThe problem requires an analysis of the numerical stability of a finite-difference time-domain (FDTD) simulation for the two-dimensional acoustic wave equation in a heterogeneous medium. The governing partial differential equation is given by:\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c(\\mathbf{x})^2 \\nabla^2 u\n$$\nwhere $u$ is the scalar displacement potential, $t$ is time, $\\mathbf{x}=(x,y)$ represents the spatial coordinates, $c(\\mathbf{x})$ is the position-dependent wave velocity, and $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ is the Laplacian operator.\n\nThe simulation employs a second-order accurate, explicit, centered finite difference scheme on a uniform grid with spatial step sizes $\\Delta x$ and $\\Delta y$, and a temporal step size $\\Delta t$. Let $u_{i,j}^n$ approximate $u(i\\Delta x, j\\Delta y, n\\Delta t)$. The standard second-order central difference approximations for the derivatives are:\n$$\n\\frac{\\partial^2 u}{\\partial t^2} \\approx \\frac{u_{i,j}^{n+1} - 2u_{i,j}^n + u_{i,j}^{n-1}}{(\\Delta t)^2}\n$$\n$$\n\\nabla^2 u \\approx \\frac{u_{i+1,j}^n - 2u_{i,j}^n + u_{i-1,j}^n}{(\\Delta x)^2} + \\frac{u_{i,j+1}^n - 2u_{i,j}^n + u_{i,j-1}^n}{(\\Delta y)^2}\n$$\n\nThe stability of this explicit numerical scheme is governed by the Courant–Friedrichs–Lewy (CFL) condition. For the 2D acoustic wave equation discretized with the 5-point Laplacian stencil shown above, the stability requires the local CFL number, $\\sigma$, to be less than or equal to a specific limit. The local CFL number at a grid point $(i,j)$ is defined as:\n$$\n\\sigma_{i,j} = c_{i,j} \\Delta t \\sqrt{\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}}\n$$\nwhere $c_{i,j} = c(i\\Delta x, j\\Delta y)$ is the wave velocity at that grid point. The stability condition for this scheme is $\\sigma_{i,j} \\le 1$ for all points $(i,j)$ in the grid. Numerical instability is triggered at any point where this condition is violated. The problem specifies that the instability region consists of all points where the local CFL number *strictly exceeds* this limit, i.e., where $\\sigma_{i,j} > 1$.\n\nThe task is to compute two quantities for each test case:\n1. The maximum local CFL number over the entire computational domain, $\\sigma_{\\max} = \\max_{i,j}(\\sigma_{i,j})$.\n2. The minimal axis-aligned bounding box $[i_{\\min}, i_{\\max}, j_{\\min}, j_{\\max}]$ enclosing all grid points $(i,j)$ where $\\sigma_{i,j} > 1$. If no such points exist, this region is empty.\n\nThe general procedure for each test case is as follows:\n1.  Define the grid dimensions ($N_x, N_y$) and parameters ($\\Delta x, \\Delta y, \\Delta t$).\n2.  Construct a 2D array representing the velocity field $c_{i,j}$ for all grid indices $i \\in [0, N_x-1]$ and $j \\in [0, N_y-1]$, according to the specific rules of the test case.\n3.  Calculate the constant part of the CFL expression: $S = \\Delta t \\sqrt{1/(\\Delta x)^2 + 1/(\\Delta y)^2}$.\n4.  Compute the 2D array of local CFL numbers: $\\sigma_{i,j} = c_{i,j} \\cdot S$.\n5.  Find the maximum value in the $\\sigma_{i,j}$ array. This is $\\sigma_{\\max}$.\n6.  Identify all grid indices $(i,j)$ for which $\\sigma_{i,j} > 1$.\n7.  If the set of unstable indices is empty, the bounding box is reported as an empty list. Otherwise, determine the minimum and maximum values of the $i$ and $j$ coordinates from this set to form the bounding box $[i_{\\min}, i_{\\max}, j_{\\min}, j_{\\max}]$.\n\nThis procedure is now applied to each test case.\n\n**Test Case 1:**\n- Parameters: $N_x = 256$, $N_y = 192$, $\\Delta x = 7.5\\,\\text{m}$, $\\Delta y = 7.5\\,\\text{m}$, $\\Delta t = 0.0012\\,\\text{s}$.\n- The velocity field has a background of $c_b = 2000\\,\\text{m/s}$ and an elliptical inclusion of $c_e = 4500\\,\\text{m/s}$.\n- The spatial factor is $S_1 = 0.0012 \\sqrt{1/(7.5)^2 + 1/(7.5)^2} = \\frac{0.0012\\sqrt{2}}{7.5} \\approx 0.00022627$.\n- The maximum velocity is $c_{\\max} = 4500\\,\\text{m/s}$. Thus, the maximum CFL number is $\\sigma_{\\max} = 4500 \\cdot S_1 \\approx 1.01823$.\n- Since $\\sigma_{\\max} > 1$, an instability region exists. The instability condition $\\sigma_{i,j} > 1$ translates to $c_{i,j} > 1/S_1 \\approx 4419.4\\,\\text{m/s}$. This condition is only met within the elliptical high-velocity inclusion where $c_{i,j} = 4500\\,\\text{m/s}$. The bounding box is therefore the minimal box enclosing all grid points that fall within the specified ellipse.\n\n**Test Case 2:**\n- Parameters: $N_x = 128$, $N_y = 128$, $\\Delta x = 10\\,\\text{m}$, $\\Delta y = 8\\,\\text{m}$, $\\Delta t = 0.001104\\,\\text{s}$.\n- The velocity field consists of two layers: $c_1 = 4000\\,\\text{m/s}$ for $j \\le 31$ and $c_2 = 1800\\,\\text{m/s}$ for $j > 31$.\n- The spatial factor is $S_2 = 0.001104 \\sqrt{1/(10)^2 + 1/(8)^2} \\approx 0.00017673$.\n- The maximum velocity is $c_{\\max} = 4000\\,\\text{m/s}$. The maximum CFL number is $\\sigma_{\\max} = 4000 \\cdot S_2 \\approx 0.7069$.\n- Since $\\sigma_{\\max} \\le 1$, no grid point violates the stability criterion. The instability region is empty.\n\n**Test Case 3:**\n- Parameters: $N_x = 64$, $N_y = 512$, $\\Delta x = 20\\,\\text{m}$, $\\Delta y = 2\\,\\text{m}$, $\\Delta t = 0.0004\\,\\text{s}$.\n- The velocity field has a background of $c_b = 2500\\,\\text{m/s}$ and a high-velocity bottom stripe of $c_s = 5000\\,\\text{m/s}$ for $j \\ge 448$.\n- The spatial factor is $S_3 = 0.0004 \\sqrt{1/(20)^2 + 1/(2)^2} \\approx 0.00020100$.\n- The maximum velocity is $c_{\\max} = 5000\\,\\text{m/s}$. The maximum CFL number is $\\sigma_{\\max} = 5000 \\cdot S_3 \\approx 1.00499$.\n- Since $\\sigma_{\\max} > 1$, an instability region exists. The condition $\\sigma_{i,j} > 1$ means $c_{i,j} > 1/S_3 \\approx 4975.2\\,\\text{m/s}$. This is only true in the bottom stripe where $c_{i,j} = 5000\\,\\text{m/s}$.\n- This stripe spans all $i$-indices from $0$ to $N_x-1=63$ and all $j$-indices from $448$ to $N_y-1=511$. The bounding box is therefore $[0, 63, 448, 511]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum local CFL number and the bounding box of the instability\n    region for a series of 2D acoustic wave simulation scenarios.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"Case 1: Elliptical Inclusion\",\n            \"Nx\": 256, \"Ny\": 192,\n            \"dx\": 7.5, \"dy\": 7.5,\n            \"dt\": 0.0012,\n            \"velocity_params\": {\n                \"type\": \"ellipse\",\n                \"c_background\": 2000.0,\n                \"c_inclusion\": 4500.0,\n                \"a\": 300.0, \"b\": 225.0\n            }\n        },\n        {\n            \"name\": \"Case 2: Layered Medium\",\n            \"Nx\": 128, \"Ny\": 128,\n            \"dx\": 10.0, \"dy\": 8.0,\n            \"dt\": 0.001104,\n            \"velocity_params\": {\n                \"type\": \"layer\",\n                \"c_top\": 4000.0,\n                \"c_bottom\": 1800.0,\n                \"j_boundary\": 31\n            }\n        },\n        {\n            \"name\": \"Case 3: Bottom Stripe\",\n            \"Nx\": 64, \"Ny\": 512,\n            \"dx\": 20.0, \"dy\": 2.0,\n            \"dt\": 0.0004,\n            \"velocity_params\": {\n                \"type\": \"stripe\",\n                \"c_background\": 2500.0,\n                \"c_stripe\": 5000.0,\n                \"j_boundary\": 448\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny = case[\"Nx\"], case[\"Ny\"]\n        dx, dy, dt = case[\"dx\"], case[\"dy\"], case[\"dt\"]\n        vp = case[\"velocity_params\"]\n        \n        # Construct the velocity grid c(i, j)\n        # We use a grid indexed by (j, i) to match numpy's (row, col) convention\n        c = np.zeros((Ny, Nx))\n        \n        # Create index grids for vectorized calculations\n        i_indices = np.arange(Nx)\n        j_indices = np.arange(Ny)\n        i_grid, j_grid = np.meshgrid(i_indices, j_indices)\n\n        if vp[\"type\"] == \"ellipse\":\n            x0 = (Nx - 1) / 2.0 * dx\n            y0 = (Ny - 1) / 2.0 * dy\n            x_grid = i_grid * dx\n            y_grid = j_grid * dy\n            a, b = vp[\"a\"], vp[\"b\"]\n            \n            ellipse_mask = ((x_grid - x0) / a)**2 + ((y_grid - y0) / b)**2 <= 1.0\n            c = np.where(ellipse_mask, vp[\"c_inclusion\"], vp[\"c_background\"])\n\n        elif vp[\"type\"] == \"layer\":\n            c = np.full((Ny, Nx), vp[\"c_bottom\"])\n            c[:vp[\"j_boundary\"] + 1, :] = vp[\"c_top\"]\n            \n        elif vp[\"type\"] == \"stripe\":\n            c = np.full((Ny, Nx), vp[\"c_background\"])\n            c[vp[\"j_boundary\"]:, :] = vp[\"c_stripe\"]\n\n        # Calculate the local CFL number over the grid\n        spatial_factor = dt * np.sqrt(1.0/dx**2 + 1.0/dy**2)\n        cfl_grid = c * spatial_factor\n        \n        # Find the maximum CFL number\n        max_cfl = np.max(cfl_grid)\n        \n        # Identify the instability region and its bounding box\n        unstable_indices = np.argwhere(cfl_grid > 1.0)\n        \n        bounding_box = []\n        if unstable_indices.size > 0:\n            # np.argwhere returns indices as [row, col] -> [j, i]\n            j_unstable = unstable_indices[:, 0]\n            i_unstable = unstable_indices[:, 1]\n            \n            i_min = int(np.min(i_unstable))\n            i_max = int(np.max(i_unstable))\n            j_min = int(np.min(j_unstable))\n            j_max = int(np.max(j_unstable))\n            \n            bounding_box = [i_min, i_max, j_min, j_max]\n        \n        results.append([max_cfl, bounding_box])\n\n    # Convert the results list to the specified string format\n    # The default str() representation of a list of lists matches the required format\n    # with spaces after commas, which is a common and readable convention.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        },
        {
            "introduction": "Beyond stability, the ultimate goal of a simulation is accuracy—ensuring the numerical waves behave like their physical counterparts. This exercise  delves into the subtle but critical issues of numerical dispersion and aliasing, which distort the phase and speed of propagating waves. By comparing a standard stencil with a specialized Dispersion-Relation-Preserving (DRP) operator, you will learn to use modified wavenumber analysis to quantify phase errors and understand how different schemes perform, particularly for high-frequency waves that are challenging for a discrete grid to represent correctly.",
            "id": "3592376",
            "problem": "You are asked to design and implement a program to quantify and compare numerical dispersion and aliasing for two spatial differentiation operators used in finite difference modeling of earthquake ground motion. The comparison is between a standard staggered-grid first-derivative operator and a dispersion-relation-preserving (DRP) explicit centered stencil. Your analysis and implementation must be grounded in the one-dimensional linear acoustic wave equation and plane-wave solutions.\n\nStart from the following fundamental base and core definitions:\n- The one-dimensional linear acoustic wave equation is $ \\partial^2 u / \\partial t^2 = c^2 \\, \\partial^2 u / \\partial x^2 $, where $u(x,t)$ is the displacement and $c$ is the wave speed.\n- A plane wave solution is $ u(x,t) = \\Re\\{ \\exp(i(k x - \\omega t)) \\} $ with angular frequency $\\omega$ and wavenumber $k$ satisfying the continuous dispersion relation $ \\omega = c \\, k $.\n- Discretization on a spatial grid with spacing $ \\Delta x $ samples the wave and imposes that resolvable wavenumbers lie in the principal Brillouin zone $ k \\in (-\\pi/\\Delta x, \\pi/\\Delta x] $. Any true wavenumber $k_{\\text{true}}$ outside this interval is aliased to an observed wavenumber $k_{\\text{obs}}$ by wrapping it into the principal interval.\n\nDefine the following numerical differentiation operators and their Fourier symbols (modified wavenumbers), which connect to the semi-discrete dispersion relation via $ \\omega_{\\text{num}} = c \\, k_{\\text{mod}} $:\n- Standard staggered-grid first derivative (two-point difference on staggered nodes): for a sampled plane wave with normalized wavenumber $ \\kappa \\equiv k \\, \\Delta x \\in (-\\pi, \\pi] $, the modified wavenumber magnitude is\n$$ k_{\\text{mod,stag}}(\\kappa) = \\frac{2}{\\Delta x} \\left| \\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\right|. $$\n- A $7$-point explicit DRP centered first-derivative operator with anti-symmetric coefficients $a_1, a_2, a_3$ applied as\n$$ \\left.\\frac{\\partial u}{\\partial x}\\right|_{x_j} \\approx \\frac{1}{\\Delta x} \\left[ a_1 \\left(u_{j+1} - u_{j-1}\\right) + a_2 \\left(u_{j+2} - u_{j-2}\\right) + a_3 \\left(u_{j+3} - u_{j-3}\\right) \\right], $$\nwhose modified wavenumber magnitude is\n$$ k_{\\text{mod,drp}}(\\kappa) = \\frac{2}{\\Delta x} \\left| a_1 \\sin(\\kappa) + a_2 \\sin(2\\kappa) + a_3 \\sin(3\\kappa) \\right|. $$\nUse the dispersion-relation-preserving coefficients\n$$ a_1 = 0.770882380518225, \\quad a_2 = -0.166705904414580, \\quad a_3 = 0.020843142770311. $$\n\nTo quantify errors at high wavenumber, define for any true physical frequency $f$:\n- The true physical wavenumber $ k_{\\text{true}} = \\frac{2\\pi f}{c} $.\n- The true normalized wavenumber $ \\kappa_{\\text{true}} = k_{\\text{true}} \\Delta x $.\n- The aliased normalized wavenumber in the principal interval\n$$ \\kappa_{\\text{obs}} = \\mathrm{wrap}\\!\\left(\\kappa_{\\text{true}}\\right) \\in (-\\pi,\\pi], \\quad \\text{where} \\quad \\mathrm{wrap}(\\kappa) = \\kappa - 2\\pi \\left\\lfloor \\frac{\\kappa + \\pi}{2\\pi} \\right\\rfloor. $$\n- The observed wavenumber magnitude $ |k_{\\text{obs}}| = \\frac{|\\kappa_{\\text{obs}}|}{\\Delta x} $.\n- The aliasing ratio\n$$ r_{\\text{alias}} = \\frac{|k_{\\text{obs}}|}{|k_{\\text{true}}|} = \\frac{|\\kappa_{\\text{obs}}|}{|\\kappa_{\\text{true}}|}, $$\nwhich measures how much the grid under-represents the true physical wavenumber due to aliasing. This is a dimensionless number.\n- The phase error of the spatial operator, defined relative to the exactly representable derivative at the aliased wavenumber,\n$$ \\varepsilon_{\\text{phase,scheme}} = \\frac{k_{\\text{mod,scheme}}(\\kappa_{\\text{obs}})}{|k_{\\text{obs}}|} - 1, $$\nfor each scheme $\\{\\text{stag}, \\text{drp}\\}$. This is a dimensionless number.\n\nImplement a program that, for each test case, computes three outputs:\n- $ \\varepsilon_{\\text{phase,stag}} $,\n- $ \\varepsilon_{\\text{phase,drp}} $,\n- $ r_{\\text{alias}} $.\n\nPhysical parameters to be used for all cases:\n- Shear-wave speed $ c = 3000 \\, \\text{m/s} $,\n- Grid spacing $ \\Delta x = 10 \\, \\text{m} $.\n\nTest suite:\n- Frequencies $ f $ in Hertz: $ [30, 75, 120, 150, 160, 225] $.\n\nAngle unit: all trigonometric function arguments are in radians.\n\nUnits:\n- The program must accept no user input and will use the above fixed parameters.\n- All outputs are dimensionless decimals.\n\nFinal output specification:\n- For each test frequency $ f $, output a list $ [\\varepsilon_{\\text{phase,stag}}, \\varepsilon_{\\text{phase,drp}}, r_{\\text{alias}}] $ with each value rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of these lists, enclosed in square brackets, for example, $ [[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],\\dots] $ with no additional text.",
            "solution": "The problem has been validated and is determined to be a well-posed, scientifically sound problem in computational geophysics. All provided definitions, parameters, and equations are consistent and sufficient for arriving at a unique solution.\n\nThe task is to compute and compare numerical errors for two different finite difference stencils used to approximate a spatial first derivative. The errors to be quantified are the phase error, which arises from numerical dispersion, and the aliasing ratio, which captures the misrepresentation of high-frequency waves on a discrete grid. The analysis is performed for a range of physical frequencies using the one-dimensional acoustic wave equation as a basis.\n\nThe solution is derived by following a sequence of calculations for each given frequency $f$.\n\n**Step 1: Calculation of True Physical and Normalized Wavenumbers**\n\nThe fundamental relationship between angular frequency $\\omega$ and wavenumber $k$ for a wave propagating at speed $c$ is given by the continuous dispersion relation, $\\omega = c k$. The angular frequency is related to the temporal frequency $f$ by $\\omega = 2\\pi f$. Therefore, for a given frequency $f$, the true physical wavenumber $k_{\\text{true}}$ is:\n$$ k_{\\text{true}} = \\frac{2\\pi f}{c} $$\nThe physical parameters are given as $c = 3000 \\, \\text{m/s}$ and the grid spacing is $\\Delta x = 10 \\, \\text{m}$.\n\nFor analyzing grid-based effects, it is convenient to work with the dimensionless normalized wavenumber, $\\kappa$, defined as $\\kappa = k \\Delta x$. The true normalized wavenumber is thus:\n$$ \\kappa_{\\text{true}} = k_{\\text{true}} \\Delta x = \\frac{2\\pi f \\Delta x}{c} $$\nThis quantity measures the number of radians of phase the wave accumulates over one grid cell.\n\n**Step 2: Calculation of Aliased Wavenumber and Aliasing Ratio**\n\nA discrete grid with spacing $\\Delta x$ can only uniquely represent wavenumbers in the principal Brillouin zone, $k \\in (-\\pi/\\Delta x, \\pi/\\Delta x]$. In terms of the normalized wavenumber, this corresponds to $\\kappa \\in (-\\pi, \\pi]$. Any true normalized wavenumber $\\kappa_{\\text{true}}$ outside this interval is aliased, meaning it is indistinguishable from an observed normalized wavenumber $\\kappa_{\\text{obs}}$ within the interval. The problem provides the wrapping function to formalize this aliasing:\n$$ \\kappa_{\\text{obs}} = \\mathrm{wrap}(\\kappa_{\\text{true}}) = \\kappa_{\\text{true}} - 2\\pi \\left\\lfloor \\frac{\\kappa_{\\text{true}} + \\pi}{2\\pi} \\right\\rfloor $$\nThis function maps any real value $\\kappa_{\\text{true}}$ into the interval $(-\\pi, \\pi]$.\n\nThe aliasing ratio, $r_{\\text{alias}}$, quantifies the extent of this wavenumber distortion. It is the ratio of the magnitude of the observed wavenumber to the magnitude of the true wavenumber. Since $f > 0$, $k_{\\text{true}}$ and $\\kappa_{\\text{true}}$ are positive.\n$$ r_{\\text{alias}} = \\frac{|k_{\\text{obs}}|}{|k_{\\text{true}}|} = \\frac{|\\kappa_{\\text{obs}} / \\Delta x|}{k_{\\text{true}}} = \\frac{|\\kappa_{\\text{obs}}|}{\\kappa_{\\text{true}}} $$\nA value of $r_{\\text{alias}}=1$ indicates no aliasing (the wave is properly resolved), while $r_{\\text{alias}} < 1$ indicates that the grid perceives the wave as having a longer wavelength (smaller wavenumber) than it truly does.\n\n**Step 3: Calculation of Modified Wavenumbers**\n\nA numerical differentiation operator does not perfectly reproduce the analytical derivative. When applied to a plane wave $\\exp(i k x)$, a numerical derivative operator acts as a multiplication by $i k_{\\text{mod}}$, where $k_{\\text{mod}}$ is the modified wavenumber. The deviation of $k_{\\text{mod}}$ from the ideal wavenumber $k$ is the source of numerical dispersion. The problem provides the modified wavenumber magnitudes for the two schemes as functions of the normalized wavenumber $\\kappa = \\kappa_{\\text{obs}}$.\n\nFor the standard staggered-grid operator:\n$$ k_{\\text{mod,stag}}(\\kappa_{\\text{obs}}) = \\frac{2}{\\Delta x} \\left| \\sin\\!\\left(\\frac{\\kappa_{\\text{obs}}}{2}\\right) \\right| $$\nFor the $7$-point Dispersion-Relation-Preserving (DRP) operator with coefficients $a_1=0.770882380518225$, $a_2=-0.166705904414580$, and $a_3=0.020843142770311$:\n$$ k_{\\text{mod,drp}}(\\kappa_{\\text{obs}}) = \\frac{2}{\\Delta x} \\left| a_1 \\sin(\\kappa_{\\text{obs}}) + a_2 \\sin(2\\kappa_{\\text{obs}}) + a_3 \\sin(3\\kappa_{\\text{obs}}) \\right| $$\n\n**Step 4: Calculation of the Phase Error**\n\nThe phase error, $\\varepsilon_{\\text{phase,scheme}}$, measures the accuracy of the numerical operator relative to the ideal differentiation on the aliased wave. It is defined as the relative error between the operator's modified wavenumber magnitude and the magnitude of the observed wavenumber, $|k_{\\text{obs}}| = |\\kappa_{\\text{obs}}| / \\Delta x$:\n$$ \\varepsilon_{\\text{phase,scheme}} = \\frac{k_{\\text{mod,scheme}}(\\kappa_{\\text{obs}})}{|k_{\\text{obs}}|} - 1 $$\nThis formula can be simplified by substituting the expressions for $k_{\\text{mod}}$ and $|k_{\\text{obs}}|$, which reveals that the phase error depends only on the normalized observed wavenumber $\\kappa_{\\text{obs}}$:\n\nFor the staggered-grid scheme:\n$$ \\varepsilon_{\\text{phase,stag}} = \\frac{\\frac{2}{\\Delta x} \\left| \\sin(\\frac{\\kappa_{\\text{obs}}}{2}) \\right|}{|\\kappa_{\\text{obs}}| / \\Delta x} - 1 = \\frac{2 \\left| \\sin(\\frac{\\kappa_{\\text{obs}}}{2}) \\right|}{|\\kappa_{\\text{obs}}|} - 1 $$\nFor the DRP scheme:\n$$ \\varepsilon_{\\text{phase,drp}} = \\frac{\\frac{2}{\\Delta x} \\left| \\sum_{j=1}^{3} a_j \\sin(j\\kappa_{\\text{obs}}) \\right|}{|\\kappa_{\\text{obs}}| / \\Delta x} - 1 = \\frac{2 \\left| \\sum_{j=1}^{3} a_j \\sin(j\\kappa_{\\text{obs}}) \\right|}{|\\kappa_{\\text{obs}}|} - 1 $$\nA phase error of $0$ indicates perfect differentiation for the given (aliased) wavenumber. A negative error typically implies that the numerical scheme propagates waves more slowly than they should (numerical dispersion). Note that in the limit $\\kappa_{\\text{obs}} \\to 0$, both phase errors approach $0$, which is handled as a special case in the implementation to avoid division by zero.\n\n**Algorithmic Summary**\n\nFor each frequency $f$ in the test suite $[30, 75, 120, 150, 160, 225]$ Hz:\n1.  Calculate $k_{\\text{true}} = 2\\pi f / c$.\n2.  Calculate $\\kappa_{\\text{true}} = k_{\\text{true}} \\Delta x$.\n3.  Calculate $\\kappa_{\\text{obs}}$ by wrapping $\\kappa_{\\text{true}}$ into the interval $(-\\pi, \\pi]$.\n4.  Calculate $r_{\\text{alias}} = |\\kappa_{\\text{obs}}| / \\kappa_{\\text{true}}$.\n5.  Calculate $\\varepsilon_{\\text{phase,stag}}$ using the simplified formula with $\\kappa_{\\text{obs}}$.\n6.  Calculate $\\varepsilon_{\\text{phase,drp}}$ using the simplified formula with $\\kappa_{\\text{obs}}$.\n7.  Collect the three results $[\\varepsilon_{\\text{phase,stag}}, \\varepsilon_{\\text{phase,drp}}, r_{\\text{alias}}]$, round each to six decimal places, and append to a final list of results.\nThe final output is a list of these lists.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical dispersion and aliasing errors for two finite difference\n    schemes used in wave propagation modeling.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [30, 75, 120, 150, 160, 225]\n\n    # Physical and numerical parameters\n    c = 3000.0  # Shear-wave speed in m/s\n    dx = 10.0   # Grid spacing in m\n\n    # DRP operator coefficients\n    a1 = 0.770882380518225\n    a2 = -0.166705904414580\n    a3 = 0.020843142770311\n    \n    all_results = []\n\n    for f in test_cases:\n        # Step 1: Calculate true physical and normalized wavenumbers\n        k_true = 2 * np.pi * f / c\n        kappa_true = k_true * dx\n\n        # Step 2: Calculate aliased normalized wavenumber\n        # The wrap function maps kappa_true to the interval (-pi, pi]\n        kappa_obs = kappa_true - 2 * np.pi * np.floor((kappa_true + np.pi) / (2 * np.pi))\n\n        # Step 3: Calculate the aliasing ratio\n        # Since f > 0, kappa_true is always positive.\n        r_alias = np.abs(kappa_obs) / kappa_true\n\n        # Step 4: Calculate phase errors for each scheme\n        # A check is included for the case where kappa_obs is numerically zero to\n        # avoid division by zero. In this case, the phase error is zero.\n        if np.abs(kappa_obs) < 1e-9:\n            eps_stag = 0.0\n            eps_drp = 0.0\n        else:\n            # Staggered-grid scheme phase error\n            eps_stag = (2 * np.abs(np.sin(kappa_obs / 2)) / np.abs(kappa_obs)) - 1\n\n            # DRP scheme phase error\n            drp_sin_term = a1 * np.sin(kappa_obs) + a2 * np.sin(2 * kappa_obs) + a3 * np.sin(3 * kappa_obs)\n            eps_drp = (2 * np.abs(drp_sin_term) / np.abs(kappa_obs)) - 1\n            \n        # Collect results for the current frequency, rounded to 6 decimal places\n        case_results = np.round([eps_stag, eps_drp, r_alias], 6).tolist()\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, comma-separated, with no spaces between lists.\n    # e.g., [[-0.0, ...],[-0.0, ...]]\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}