{
    "hands_on_practices": [
        {
            "introduction": "等效源方法的核心在于，用一组简单的几何形状（如点、矩形或棱柱体）的源来表示复杂的地下源分布。要做到这一点，我们首先必须能够精确计算单个源元素产生的场。这个练习将带你从第一性原理出发，为等效层方法中最常用的单元——均匀密度的矩形面元——推导出其重力位和重力场的解析表达式。掌握这项基本的前向建模计算是构建任何更复杂等效源反演算法的基石 。",
            "id": "3589271",
            "problem": "考虑一种等效源方法，该方法通过对均匀密度的矩形片进行剖分来表示平面上的质量分布。设单个矩形片位于平面 $z=0$ 上，具有均匀的面密度 $\\sigma$（单位面积质量），其边界为 $x \\in [x_1, x_2]$ 和 $y \\in [y_1, y_2]$。设观测点为 $\\mathbf{r}_0 = (x_0, y_0, z_0)$，其中 $z_0 > 0$（垂直坐标向上为正）。使用牛顿引力，并设引力常数为 $G$，由该矩形片产生的引力势 $U(\\mathbf{r}_0)$ 定义为\n$$\nU(\\mathbf{r}_0) = G \\sigma \\iint_{\\text{patch}} \\frac{1}{\\|\\mathbf{r}_0 - \\mathbf{r}\\|} \\, \\mathrm{d}A,\n$$\n引力加速度为 $\\mathbf{g}(\\mathbf{r}_0) = \\nabla U(\\mathbf{r}_0)$，其垂直分量为 $g_z(\\mathbf{r}_0) = \\frac{\\partial U}{\\partial z_0}(\\mathbf{r}_0)$。\n\n从这些定义和位势理论的第一性原理出发，推导 $U(\\mathbf{r}_0)$ 和 $g_z(\\mathbf{r}_0)$ 关于 $x_1$、$x_2$、$y_1$、$y_2$、$x_0$、$y_0$、$z_0$、$\\sigma$ 和 $G$ 的闭合形式解析表达式。您的推导必须对 $z_0>0$ 的任意观测点都有效。用基于角的容斥原理，以四个依赖于到观测点相对偏移量的带符号贡献项来表示您的最终结果。无需进行数值计算。以解析表达式的形式提供最终答案。最终的方框表达式中不應包含单位。",
            "solution": "该问题要求推导由一个均匀密度的矩形片产生的引力势 $U(\\mathbf{r}_0)$ 和引力加速度的垂直分量 $g_z(\\mathbf{r}_0)$ 的闭合形式表达式。推导必须从第一性原理开始，并使用基于角的容斥公式来表示。\n\n设观测点为 $\\mathbf{r}_0 = (x_0, y_0, z_0)$，其中 $z_0 > 0$。该矩形片位于 $z=0$ 平面，边界为 $x \\in [x_1, x_2]$ 和 $y \\in [y_1, y_2]$，具有均匀的面密度 $\\sigma$。片上的一个点为 $\\mathbf{r} = (x, y, 0)$。\n\n观测点与片上一点之间的距离为：\n$$ \\|\\mathbf{r}_0 - \\mathbf{r}\\| = \\sqrt{(x-x_0)^2 + (y-y_0)^2 + (z_0-0)^2} $$\n为简单起见，我们引入相对坐标：$\\xi = x - x_0$ 和 $\\eta = y - y_0$。积分在平移后的矩形 $[\\xi_1, \\xi_2] \\times [\\eta_1, \\eta_2]$ 上进行，其中 $\\xi_i = x_i - x_0$ 且 $\\eta_j = y_j - y_0$。\n\n引力加速度的垂直分量 $g_z(\\mathbf{r}_0)$ 是引力势对 $z_0$ 的偏导数：\n$$ g_z(\\mathbf{r}_0) = \\frac{\\partial U}{\\partial z_0} = \\frac{\\partial}{\\partial z_0} \\left( G \\sigma \\iint \\frac{1}{\\sqrt{\\xi^2 + \\eta^2 + z_0^2}} \\, d\\xi \\, d\\eta \\right) $$\n在 $z_0 > 0$ 的条件下，被积函数是连续可微的，这允许我们交换微分和积分的顺序（莱布尼茨积分法则）：\n$$ g_z(\\mathbf{r}_0) = G \\sigma \\iint \\frac{\\partial}{\\partial z_0} \\left( (\\xi^2 + \\eta^2 + z_0^2)^{-1/2} \\right) \\, d\\xi \\, d\\eta $$\n$$ g_z(\\mathbf{r}_0) = G \\sigma \\iint -\\frac{1}{2} (\\xi^2 + \\eta^2 + z_0^2)^{-3/2} (2 z_0) \\, d\\xi \\, d\\eta $$\n$$ g_z(\\mathbf{r}_0) = -G \\sigma z_0 \\int_{\\eta_1}^{\\eta_2} \\int_{\\xi_1}^{\\xi_2} (\\xi^2 + \\eta^2 + z_0^2)^{-3/2} \\, d\\xi \\, d\\eta $$\n\n**垂直加速度 $g_z(\\mathbf{r}_0)$ 的推导**\n\n我们需要求解上述二重积分。我们可以将该积分的二重不定积分核函数定义为 $\\Psi_{g_z}(\\xi, \\eta, z_0)$，它满足 $\\frac{\\partial^2 \\Psi_{g_z}}{\\partial\\xi \\partial\\eta} = -z_0(\\xi^2 + \\eta^2 + z_0^2)^{-3/2}$。通过标准积分方法可以得到该核函数为：\n$$ \\Psi_{g_z}(\\xi, \\eta, z_0) = -\\arctan\\left(\\frac{\\xi\\eta}{z_0\\sqrt{\\xi^2+\\eta^2+z_0^2}}\\right) $$\n在矩形 $[\\xi_1, \\xi_2] \\times [\\eta_1, \\eta_2]$ 上的定二重积分通过容斥原理求得：\n$$ \\int_{\\eta_1}^{\\eta_2} \\int_{\\xi_1}^{\\xi_2} f(\\xi, \\eta) d\\xi d\\eta = F(\\xi_2, \\eta_2) - F(\\xi_2, \\eta_1) - F(\\xi_1, \\eta_2) + F(\\xi_1, \\eta_1) $$\n其中 $F$ 是 $f$ 的二重不定积分。\n将此应用于 $g_z$ 的被积函数，其不定积分为 $G\\sigma \\Psi_{g_z}$。\n$$ g_z(\\mathbf{r}_0) = G \\sigma \\left[ \\Psi_{g_z}(\\xi_2, \\eta_2, z_0) - \\Psi_{g_z}(\\xi_2, \\eta_1, z_0) - \\Psi_{g_z}(\\xi_1, \\eta_2, z_0) + \\Psi_{g_z}(\\xi_1, \\eta_1, z_0) \\right] $$\n这可以写成对四个角 $(i,j)$ 的求和，其中 $i,j \\in \\{1,2\\}$：\n$$ g_z(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\Psi_{g_z}(\\xi_i, \\eta_j, z_0) $$\n代入 $\\Psi_{g_z}$ 的表达式：\n$$ g_z(\\mathbf{r}_0) = -G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\arctan\\left(\\frac{\\xi_i\\eta_j}{z_0 r_{ij}}\\right) $$\n其中 $\\xi_i = x_i - x_0$，$\\eta_j = y_j - y_0$，以及 $r_{ij} = \\sqrt{\\xi_i^2 + \\eta_j^2 + z_0^2}$。\n\n**引力势 $U(\\mathbf{r}_0)$ 的推导**\n\n对 $1/r$ 的直接积分更为复杂。\n$$ U(\\mathbf{r}_0) = G \\sigma \\int_{\\eta_1}^{\\eta_2} \\int_{\\xi_1}^{\\xi_2} \\frac{1}{\\sqrt{\\xi^2 + \\eta^2 + z_0^2}} \\, d\\xi \\, d\\eta $$\n该积分的二重不定积分核函数 $\\Phi_U(\\xi, \\eta, z_0)$ 满足 $\\frac{\\partial^2 \\Phi_U}{\\partial\\xi \\partial\\eta} = \\frac{1}{\\sqrt{\\xi^2 + \\eta^2 + z_0^2}}$。\n该核函数的已知形式为：\n$$ \\Phi_U(\\xi, \\eta, z_0) = \\xi \\ln(\\eta + r) + \\eta \\ln(\\xi + r) - z_0 \\arctan\\left(\\frac{\\xi\\eta}{z_0 r}\\right) $$\n其中 $r = \\sqrt{\\xi^2+\\eta^2+z_0^2}$。这个结果可以通过对 $\\xi$ 和 $\\eta$ 进行微分来验证，或者通过验证 $\\frac{\\partial U}{\\partial z_0} = g_z$ 来确认其与 $g_z$ 表达式的一致性。\n\n通过对此核函数应用容斥原理，可得到引力势 $U(\\mathbf{r}_0)$：\n$$ U(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\Phi_U(\\xi_i, \\eta_j, z_0) $$\n$$ U(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\left[ \\xi_i \\ln(\\eta_j+r_{ij}) + \\eta_j \\ln(\\xi_i+r_{ij}) - z_0 \\arctan\\left(\\frac{\\xi_i\\eta_j}{z_0 r_{ij}}\\right) \\right] $$\n其中 $\\xi_i = x_i - x_0$，$\\eta_j = y_j - y_0$，以及 $r_{ij} = \\sqrt{\\xi_i^2 + \\eta_j^2 + z_0^2}$。\n\n至此完成了从第一性原理出发的推导。\n\n最终表达式：\n令 $\\xi_i = x_i - x_0$ 且 $\\eta_j = y_j - y_0$，$i,j \\in \\{1,2\\}$。令 $r_{ij} = \\sqrt{\\xi_i^2 + \\eta_j^2 + z_0^2}$。\n引力势为：\n$$ U(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\left[ \\xi_i \\ln(\\eta_j+r_{ij}) + \\eta_j \\ln(\\xi_i+r_{ij}) - z_0 \\arctan\\left(\\frac{\\xi_i\\eta_j}{z_0 r_{ij}}\\right) \\right] $$\n垂直引力加速度为：\n$$ g_z(\\mathbf{r}_0) = -G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\arctan\\left(\\frac{\\xi_i\\eta_j}{z_0 r_{ij}}\\right) $$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} U(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\left[ (x_i-x_0) \\ln(y_j-y_0+r_{ij}) + (y_j-y_0) \\ln(x_i-x_0+r_{ij}) - z_0 \\arctan\\left(\\frac{(x_i-x_0)(y_j-y_0)}{z_0 r_{ij}}\\right) \\right] \\\\ g_z(\\mathbf{r}_0) = -G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\arctan\\left(\\frac{(x_i-x_0)(y_j-y_0)}{z_0 r_{ij}}\\right) \\end{pmatrix} } $$"
        },
        {
            "introduction": "在实践中，当我们使用等效层来拟合观测数据时，一个固有的挑战是位场信号对浅源的敏感度远高于深源。如果不加校正，反演算法会倾向于将所有源都集中在靠近观测面的浅层，这通常是不符合地质实际的。这个练习将引导你推导一个深度加权函数，它能够系统地补偿这种随深度增加而衰减的灵敏度，从而确保在反演过程中对不同深度的源给予公平的“关注”，这是获得物理解释合理的地下模型的关键一步 。",
            "id": "3589251",
            "problem": "考虑在均匀半空间上方 $z=0$ 处的水平观测平面上测量的三维 ($3$D) 位场。使用一个等效层来表示该场，该层由位于深度为 $z=z_{0}>0$ 的平面上的标量单极子分布构成，其面密度为 $\\sigma(x',y')$。设 $U(x,y,z)$ 表示该层在 $(x,y,z)$ 处产生的标量位，并设测量数据为在观测平面上求值的位的 $n$ 阶垂直导数，即 $d_{n}(x,y)=\\partial^{n}U(x,y,0)/\\partial z^{n}$，其中 $n$ 是一个正整数。\n\n您将使用三维 Laplace 方程的基本格林函数 $G(\\mathbf{r})=1/(4\\pi|\\mathbf{r}|)$ 来模拟正演响应，并且您可以假设源的局部化程度足够高，以至于对于大的 $z_{0}$，轴上行为（接收器直接位于源单元上方，即 $(x,y)=(x',y')$）控制着灵敏度的深度依赖性的主阶项。对于 $d_{n}$，相对于位于 $(x',y',z_{0})$ 的单位源的等效层灵敏度核为 $K_{n}(x-x',y-y';z_{0})=\\partial^{n}G(\\mathbf{r})/\\partial z^{n}$，其中 $\\mathbf{r}=(x-x',y-y',0-z_{0})$。\n\n从第一性原理以及当 $z_{0}$ 很大时 $G(\\mathbf{r})$ 的渐近行为出发，推导一个显式的深度加权函数 $w(z_{0})$，该函数能够抵消灵敏度随深度的衰减，即当 $z_{0}\\to\\infty$ 时，$w(z_{0})\\,K_{n}(0,0;z_{0})$ 的主阶项与 $z_{0}$ 无关。通过施加条件 $w(1)=1$ 来归一化您的答案，从而使该权重无量纲。以闭合形式给出 $w(z_{0})$ 的最终表达式。不需要进行数值计算，您的答案必须是单一的解析表达式。",
            "solution": "问题要求为一个位场的等效层表示推导一个深度加权函数 $w(z_{0})$。该函数必须能够抵消轴上灵敏度核随深度 $z_{0}$ 的衰减。推导将从问题陈述中阐明的第一性原理出发。\n\n首先，我们确定关键组成部分。位场使用三维 Laplace 方程的格林函数 $G(\\mathbf{r}) = \\frac{1}{4\\pi|\\mathbf{r}|}$ 进行建模。源层位于恒定深度 $z = z_{0} > 0$，观测平面位于 $z=0$。向量 $\\mathbf{r}$ 连接源点 $(x', y', z_{0})$ 与观测点 $(x, y, z)$，因此 $\\mathbf{r} = (x-x', y-y', z-z_{0})$。该向量的模为 $|\\mathbf{r}| = \\sqrt{(x-x')^{2} + (y-y')^{2} + (z-z_{0})^{2}}$。\n\n位的 $n$ 阶垂直导数 $d_{n}(x,y)$ 的灵敏度核由 $K_{n}(x-x',y-y';z_{0})$ 给出。该核表示在 $(x,y,0)$ 处由位于 $(x',y',z_{0})$ 的单位源引起的响应。它被定义为格林函数关于垂直观测坐标 $z$ 的 $n$ 阶偏导数，并在观测平面 $z=0$ 处求值。形式上，\n$$\nK_{n}(x-x', y-y'; z_{0}) = \\left. \\frac{\\partial^{n}}{\\partial z^{n}} G(x-x', y-y', z-z_{0}) \\right|_{z=0}\n$$\n问题指明，深度依赖性的主阶项由轴上行为控制，即接收器直接位于源单元上方。这对应于 $(x,y) = (x',y')$ 的情况。因此，我们需要找到轴上核 $K_{n}(0,0;z_{0})$ 的表达式。\n\n对于轴上情况，$x-x'=0$ 且 $y-y'=0$。位置向量的模简化为 $|\\mathbf{r}| = \\sqrt{0^{2} + 0^{2} + (z-z_{0})^{2}} = |z-z_{0}|$。由于观测平面在 $z=0$ 处，源平面在 $z_{0}>0$ 处，我们关心的是空间中 $z < z_{0}$ 的点。在此范围内，$z-z_{0}$ 总是负的，因此 $|z-z_{0}| = -(z-z_{0}) = z_{0}-z$。\n\n那么，轴上格林函数为：\n$$\nG_{\\text{on-axis}}(z; z_{0}) = \\frac{1}{4\\pi(z_{0}-z)} = \\frac{1}{4\\pi}(z_{0}-z)^{-1}\n$$\n现在，我们计算该函数关于 $z$ 的 $n$ 阶偏导数。我们先进行前几次微分来确定一个模式。\n对于 $n=1$：\n$$\n\\frac{\\partial}{\\partial z} \\left( \\frac{1}{4\\pi}(z_{0}-z)^{-1} \\right) = \\frac{1}{4\\pi} (-1)(z_{0}-z)^{-2}(-1) = \\frac{1}{4\\pi}(z_{0}-z)^{-2}\n$$\n对于 $n=2$：\n$$\n\\frac{\\partial^{2}}{\\partial z^{2}} \\left( \\frac{1}{4\\pi}(z_{0}-z)^{-1} \\right) = \\frac{\\partial}{\\partial z} \\left( \\frac{1}{4\\pi}(z_{0}-z)^{-2} \\right) = \\frac{1}{4\\pi} (-2)(z_{0}-z)^{-3}(-1) = \\frac{2}{4\\pi}(z_{0}-z)^{-3}\n$$\n对于 $n=3$：\n$$\n\\frac{\\partial^{3}}{\\partial z^{3}} \\left( \\frac{1}{4\\pi}(z_{0}-z)^{-1} \\right) = \\frac{\\partial}{\\partial z} \\left( \\frac{2}{4\\pi}(z_{0}-z)^{-3} \\right) = \\frac{2}{4\\pi} (-3)(z_{0}-z)^{-4}(-1) = \\frac{6}{4\\pi}(z_{0}-z)^{-4}\n$$\n通过观察和归纳， $n$ 阶导数的一般公式为：\n$$\n\\frac{\\partial^{n}}{\\partial z^{n}} \\left( \\frac{1}{4\\pi}(z_{0}-z)^{-1} \\right) = \\frac{n!}{4\\pi}(z_{0}-z)^{-(n+1)}\n$$\n为了得到轴上灵敏度核 $K_{n}(0,0;z_{0})$，我们在观测平面 $z=0$ 处对该表达式求值：\n$$\nK_{n}(0,0;z_{0}) = \\left. \\frac{n!}{4\\pi}(z_{0}-z)^{-(n+1)} \\right|_{z=0} = \\frac{n!}{4\\pi}z_{0}^{-(n+1)}\n$$\n该表达式描述了对于位的 $n$ 阶垂直导数，轴上灵敏度随源深度 $z_{0}$ 的衰减情况。\n\n问题要求我们找到一个深度加权函数 $w(z_{0})$，使得当 $z_{0}$ 很大时，乘积 $w(z_{0})K_{n}(0,0;z_{0})$ 与 $z_{0}$ 无关。这意味着该乘积必须是一个常数。设该常数为 $C$。\n$$\nw(z_{0}) K_{n}(0,0;z_{0}) = C\n$$\n代入推导出的 $K_{n}(0,0;z_{0})$ 表达式：\n$$\nw(z_{0}) \\left( \\frac{n!}{4\\pi}z_{0}^{-(n+1)} \\right) = C\n$$\n为了使左侧与 $z_{0}$ 无关，$w(z_{0})$ 的结构必须能够抵消 $z_{0}^{-(n+1)}$ 项。因此，$w(z_{0})$ 必须与该项的倒数成正比：\n$$\nw(z_{0}) \\propto \\frac{1}{z_{0}^{-(n+1)}} = z_{0}^{n+1}\n$$\n我们可以用一个比例常数 $A$ 来表示这个关系：\n$$\nw(z_{0}) = A \\, z_{0}^{n+1}\n$$\n问题提供了一个归一化条件来确定常数 $A$：$w(1)=1$。我们应用这个条件：\n$$\nw(1) = A \\cdot (1)^{n+1} = A\n$$\n这意味着 $A=1$。\n\n因此，归一化深度加权函数的显式闭合形式表达式为：\n$$\nw(z_{0}) = z_{0}^{n+1}\n$$\n该函数乘以轴上灵敏度核 $K_{n}(0,0;z_{0})$，得到结果 $\\frac{n!}{4\\pi}$，此结果确实与深度 $z_{0}$ 无关。",
            "answer": "$$\\boxed{z_{0}^{n+1}}$$"
        },
        {
            "introduction": "由于等效源反演是一个典型的病态问题，直接求解往往会导致解不稳定且充满噪声。Tikhonov正则化通过在数据拟合与模型复杂度之间寻求平衡来解决此问题，而正则化参数 $\\lambda$ 的选择则至关重要。这个练习将深入探讨如何基于已知的数据噪声水平，使用Morozov差异原理来科学地选择 $\\lambda$。你将通过奇异值分解（SVD）的视角，推导出一个用于求解 $\\lambda$ 的牛顿法迭代公式，从而深刻理解正则化是如何在“光谱”域中工作的 。",
            "id": "3589321",
            "problem": "考虑一个二维标量势场，在位于包含 $p$ 个等效点源的水平面（$z=0$）上方高度 $z=z_{0}$ 处的 $n$ 个观测点进行测量。设观测数据向量为 $\\mathbf{d} \\in \\mathbb{R}^{n}$，等效源强度向量为 $\\mathbf{m} \\in \\mathbb{R}^{p}$。将源强度映射到观测数据的正演算子是线性矩阵 $\\mathbf{G} \\in \\mathbb{R}^{n \\times p}$。假设数据噪声是零均值高斯噪声，其协方差为 $\\mathbf{C}_{\\epsilon} = \\sigma^{2} \\mathbf{I}_{n}$，其中 $\\sigma^{2}$ 已知，$\\mathbf{I}_{n}$ 是 $n \\times n$ 单位矩阵。\n\n为了从 $\\mathbf{d}$ 估计 $\\mathbf{m}$，考虑使用带有零阶稳定子的 Tikhonov 正则化，求解\n$$\n\\min_{\\mathbf{m}} \\left\\| \\mathbf{W}_{d} \\left( \\mathbf{G} \\mathbf{m} - \\mathbf{d} \\right) \\right\\|_{2}^{2} + \\lambda^{2} \\left\\| \\mathbf{m} \\right\\|_{2}^{2},\n$$\n其中 $\\mathbf{W}_{d} = \\sigma^{-1} \\mathbf{I}_{n}$ 对数据进行白化，$\\lambda > 0$ 是正则化参数。定义白化量 $\\tilde{\\mathbf{G}} = \\mathbf{W}_{d} \\mathbf{G}$ 和 $\\tilde{\\mathbf{d}} = \\mathbf{W}_{d} \\mathbf{d}$。设 $\\tilde{\\mathbf{G}}$ 的奇异值分解（SVD）为 $\\tilde{\\mathbf{G}} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}$，其中 $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$ 和 $\\mathbf{V} \\in \\mathbb{R}^{p \\times p}$ 是正交矩阵，$\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{n \\times p}$ 的对角线上有非零奇异值 $\\sigma_{i} > 0$（对于 $i=1,\\dots,p$）。记 $a_{i} = \\mathbf{u}_{i}^{\\top} \\tilde{\\mathbf{d}}$，其中 $\\mathbf{u}_{i}$ 是 $\\mathbf{U}$ 的第 $i$ 列。\n\n偏差原理（也称为 Morozov 原理）规定选择 $\\lambda$ 使得白化残差范数满足\n$$\n\\left\\| \\tilde{\\mathbf{r}}(\\lambda) \\right\\|_{2}^{2} = n,\n$$\n其中 $\\tilde{\\mathbf{r}}(\\lambda) = \\tilde{\\mathbf{d}} - \\tilde{\\mathbf{G}} \\mathbf{m}(\\lambda)$ 是白化残差，$\\mathbf{m}(\\lambda)$ 是正则化解。从上述定义和 Tikhonov 正则化的结构出发，推导偏差函数\n$$\n\\Phi(\\lambda) = \\left\\| \\tilde{\\mathbf{r}}(\\lambda) \\right\\|_{2}^{2}\n$$\n关于 $\\{ \\sigma_{i} \\}_{i=1}^{p}$ 和 $\\{ a_{i} \\}_{i=1}^{n}$ 的显式表达式，以及其导数 $\\Phi'(\\lambda)$。然后，推导求解 $\\Phi(\\lambda) = n$ 的单步牛顿更新公式。\n\n在您的推导中，从正演算子的线性、奇异值分解的性质以及 Tikhonov 正则化的定义开始。清晰地论证构建 $\\Phi(\\lambda)$ 和 $\\Phi'(\\lambda)$ 的每一步，以及它们如何导出 $\\lambda$ 的牛顿更新。\n\n最后，简要分析通过偏差原理选择 $\\lambda$ 与通过广义交叉验证（GCV; Generalized Cross-Validation）和L曲线法选择 $\\lambda$ 在原理上的比较，注意已知噪声方差和拟合的有效自由度的作用。\n\n提供作为您最终答案的、在偏差原理下迭代计算 $\\lambda$ 的单步牛顿更新 $\\lambda_{k+1}$ 的单一闭式解析表达式，该表达式以 $\\lambda_{k}$、$\\{ \\sigma_{i} \\}$ 和 $\\{ a_{i} \\}$ 表示。不需要进行数值评估。您的最终答案必须是单一表达式，且不得包含任何单位。",
            "solution": "Tikhonov 正则化问题被表述为最小化目标函数 $J(\\mathbf{m})$：\n$$\nJ(\\mathbf{m}) = \\left\\| \\tilde{\\mathbf{G}} \\mathbf{m} - \\tilde{\\mathbf{d}} \\right\\|_{2}^{2} + \\lambda^{2} \\left\\| \\mathbf{m} \\right\\|_{2}^{2}\n$$\n其中 $\\tilde{\\mathbf{G}} = \\sigma^{-1}\\mathbf{G}$ 和 $\\tilde{\\mathbf{d}} = \\sigma^{-1}\\mathbf{d}$ 分别是白化算子和数据。为了找到最小值，我们计算 $J(\\mathbf{m})$ 关于 $\\mathbf{m}$ 的梯度并将其设为零。\n$$\n\\nabla_{\\mathbf{m}} J(\\mathbf{m}) = \\nabla_{\\mathbf{m}} \\left( (\\tilde{\\mathbf{G}}\\mathbf{m} - \\tilde{\\mathbf{d}})^{\\top}(\\tilde{\\mathbf{G}}\\mathbf{m} - \\tilde{\\mathbf{d}}) + \\lambda^2 \\mathbf{m}^{\\top}\\mathbf{m} \\right) = 2\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}}\\mathbf{m} - 2\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{d}} + 2\\lambda^2 \\mathbf{m} = \\mathbf{0}\n$$\n这得到了正则化解 $\\mathbf{m}(\\lambda)$ 的正规方程：\n$$\n(\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}} + \\lambda^2 \\mathbf{I}_{p}) \\mathbf{m}(\\lambda) = \\tilde{\\mathbf{G}}^{\\top} \\tilde{\\mathbf{d}}\n$$\n因此，模型参数的解为：\n$$\n\\mathbf{m}(\\lambda) = (\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}} + \\lambda^2 \\mathbf{I}_{p})^{-1} \\tilde{\\mathbf{G}}^{\\top} \\tilde{\\mathbf{d}}\n$$\n为了继续，我们代入 $\\tilde{\\mathbf{G}} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}$ 的 SVD。\n项 $\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}}$ 变为：\n$$\n\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}} = (\\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top})^{\\top}(\\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}) = \\mathbf{V}\\boldsymbol{\\Sigma}^{\\top}\\mathbf{U}^{\\top}\\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^{\\top} = \\mathbf{V}(\\boldsymbol{\\Sigma}^{\\top}\\boldsymbol{\\Sigma})\\mathbf{V}^{\\top}\n$$\n由于 $\\boldsymbol{\\Sigma}$ 是一个 $n \\times p$ 矩阵，其对角线元素为 $\\sigma_{i}$（对于 $i=1,\\dots,p$），$\\boldsymbol{\\Sigma}^{\\top}\\boldsymbol{\\Sigma}$ 是一个对角线元素为 $\\sigma_{i}^{2}$ 的 $p \\times p$ 对角矩阵。所以，$(\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}} + \\lambda^2 \\mathbf{I}_{p}) = \\mathbf{V}\\text{diag}(\\sigma_{i}^{2})\\mathbf{V}^{\\top} + \\lambda^2\\mathbf{V}\\mathbf{V}^{\\top} = \\mathbf{V}\\text{diag}(\\sigma_{i}^{2} + \\lambda^{2})\\mathbf{V}^{\\top}$。\n其逆矩阵为 $(\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}} + \\lambda^2 \\mathbf{I}_{p})^{-1} = \\mathbf{V}\\text{diag}\\left(\\frac{1}{\\sigma_{i}^{2} + \\lambda^{2}}\\right)\\mathbf{V}^{\\top}$。\n此外，$\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{d}} = \\mathbf{V}\\boldsymbol{\\Sigma}^{\\top}\\mathbf{U}^{\\top}\\tilde{\\mathbf{d}}$。\n结合这些，解 $\\mathbf{m}(\\lambda)$ 是：\n$$\n\\mathbf{m}(\\lambda) = \\mathbf{V}\\text{diag}\\left(\\frac{1}{\\sigma_{i}^{2} + \\lambda^{2}}\\right)\\mathbf{V}^{\\top} \\mathbf{V}\\boldsymbol{\\Sigma}^{\\top}\\mathbf{U}^{\\top}\\tilde{\\mathbf{d}} = \\mathbf{V}\\text{diag}\\left(\\frac{1}{\\sigma_{i}^{2} + \\lambda^{2}}\\right) \\boldsymbol{\\Sigma}^{\\top}\\mathbf{U}^{\\top}\\tilde{\\mathbf{d}}\n$$\n向量 $\\mathbf{U}^{\\top}\\tilde{\\mathbf{d}}$ 的分量为 $a_i = \\mathbf{u}_{i}^{\\top}\\tilde{\\mathbf{d}}$。乘积 $\\boldsymbol{\\Sigma}^{\\top}(\\mathbf{U}^{\\top}\\tilde{\\mathbf{d}})$ 得到一个在 $\\mathbb{R}^{p}$ 中的向量，其分量为 $\\sigma_{i}a_{i}$。因此，$\\mathbf{m}(\\lambda)$ 可以表示为基向量 $\\mathbf{v}_{i}$ 的和：\n$$\n\\mathbf{m}(\\lambda) = \\sum_{i=1}^{p} \\frac{\\sigma_{i} a_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} \\mathbf{v}_{i}\n$$\n现在我们推导偏差函数 $\\Phi(\\lambda) = \\left\\| \\tilde{\\mathbf{r}}(\\lambda) \\right\\|_{2}^{2} = \\|\\tilde{\\mathbf{d}} - \\tilde{\\mathbf{G}}\\mathbf{m}(\\lambda)\\|_2^2$。平方L2范数在正交变换 $\\mathbf{U}^{\\top}$ 下是不变的，所以：\n$$\n\\Phi(\\lambda) = \\|\\mathbf{U}^{\\top}(\\tilde{\\mathbf{d}} - \\tilde{\\mathbf{G}}\\mathbf{m}(\\lambda))\\|_2^2 = \\|\\mathbf{U}^{\\top}\\tilde{\\mathbf{d}} - \\mathbf{U}^{\\top}\\tilde{\\mathbf{G}}\\mathbf{m}(\\lambda)\\|_2^2\n$$\n我们有 $\\mathbf{U}^{\\top}\\tilde{\\mathbf{G}} = \\mathbf{U}^{\\top}\\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^{\\top} = \\boldsymbol{\\Sigma}\\mathbf{V}^{\\top}$。变换域中的残差向量 $\\mathbf{U}^{\\top}\\tilde{\\mathbf{r}}(\\lambda)$ 的分量是：\n$$\n(\\mathbf{U}^{\\top}\\tilde{\\mathbf{r}}(\\lambda))_{i} = a_{i} - (\\boldsymbol{\\Sigma}\\mathbf{V}^{\\top} \\mathbf{m}(\\lambda))_i\n$$\n使用 $\\mathbf{m}(\\lambda)$ 的表达式，$\\mathbf{V}^{\\top}\\mathbf{m}(\\lambda)$ 是一个在 $\\mathbb{R}^p$ 中的向量，其分量为 $\\frac{\\sigma_i a_i}{\\sigma_i^2+\\lambda^2}$。那么 $\\boldsymbol{\\Sigma}(\\mathbf{V}^{\\top}\\mathbf{m}(\\lambda))$ 是一个在 $\\mathbb{R}^n$ 中的向量，其前 $p$ 个分量为 $\\sigma_i \\frac{\\sigma_i a_i}{\\sigma_i^2+\\lambda^2} = \\frac{\\sigma_i^2 a_i}{\\sigma_i^2+\\lambda^2}$，其余分量为零。\n因此，残差向量的分量为：\n$$\n(\\mathbf{U}^{\\top}\\tilde{\\mathbf{r}}(\\lambda))_{i} = a_{i} - \\frac{\\sigma_{i}^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} = a_{i}\\left(1 - \\frac{\\sigma_{i}^{2}}{\\sigma_{i}^{2} + \\lambda^{2}}\\right) = \\frac{\\lambda^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} \\quad \\text{对于 } i=1,\\dots,p\n$$\n$$\n(\\mathbf{U}^{\\top}\\tilde{\\mathbf{r}}(\\lambda))_{i} = a_{i} - 0 = a_{i} \\quad \\text{对于 } i=p+1,\\dots,n\n$$\n平方范数 $\\Phi(\\lambda)$ 是这些分量的平方和：\n$$\n\\Phi(\\lambda) = \\sum_{i=1}^{p} \\left( \\frac{\\lambda^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} \\right)^{2} + \\sum_{i=p+1}^{n} a_{i}^{2}\n$$\n这是偏差函数的显式表达式。接下来，我们求它关于 $\\lambda$ 的导数 $\\Phi'(\\lambda)$：\n$$\n\\Phi'(\\lambda) = \\frac{d}{d\\lambda} \\left( \\sum_{i=1}^{p} \\frac{\\lambda^{4} a_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda^{2})^{2}} + \\sum_{i=p+1}^{n} a_{i}^{2} \\right)\n$$\n第二个和相对于 $\\lambda$ 是常数。我们使用商法则对第一个和中的项进行微分：\n$$\n\\frac{d}{d\\lambda} \\left( \\frac{\\lambda^{4}}{(\\sigma_{i}^{2} + \\lambda^{2})^{2}} \\right) = \\frac{4\\lambda^{3}(\\sigma_{i}^{2} + \\lambda^{2})^{2} - \\lambda^{4} \\cdot 2(\\sigma_{i}^{2} + \\lambda^{2})(2\\lambda)}{(\\sigma_{i}^{2} + \\lambda^{2})^{4}} = \\frac{4\\lambda^{3}(\\sigma_{i}^{2} + \\lambda^{2}) - 4\\lambda^{5}}{(\\sigma_{i}^{2} + \\lambda^{2})^{3}} = \\frac{4\\lambda^{3}\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda^{2})^{3}}\n$$\n因此，偏差函数的导数是：\n$$\n\\Phi'(\\lambda) = \\sum_{i=1}^{p} a_{i}^{2} \\frac{4\\lambda^{3}\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda^{2})^{3}} = 4\\lambda^{3} \\sum_{i=1}^{p} \\frac{a_{i}^{2}\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda^{2})^{3}}\n$$\n偏差原理要求找到 $\\lambda$ 使得 $\\Phi(\\lambda) = n$。这是一个关于函数 $f(\\lambda) = \\Phi(\\lambda) - n$ 的非线性求根问题。牛顿法提供了一个迭代更新方案：\n$$\n\\lambda_{k+1} = \\lambda_{k} - \\frac{f(\\lambda_{k})}{f'(\\lambda_{k})} = \\lambda_{k} - \\frac{\\Phi(\\lambda_{k}) - n}{\\Phi'(\\lambda_{k})}\n$$\n代入 $\\Phi(\\lambda_k)$ 和 $\\Phi'(\\lambda_k)$ 的表达式，得到单步牛顿更新公式：\n$$\n\\lambda_{k+1} = \\lambda_{k} - \\frac{\\left( \\sum_{i=1}^{p} \\left( \\frac{\\lambda_{k}^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda_{k}^{2}} \\right)^{2} + \\sum_{i=p+1}^{n} a_{i}^{2} \\right) - n}{4\\lambda_{k}^{3} \\sum_{i=1}^{p} \\frac{a_{i}^{2}\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda_{k}^{2})^{3}}}\n$$\n这个公式构成了所要求推导的核心。\n\n**方法比较**\n\n**偏差原理**具有统计学动机。它将白化残差范数 $\\|\\tilde{\\mathbf{r}}(\\lambda)\\|_2^2$ 设为其期望值 $n$。这是因为白化噪声向量 $\\tilde{\\mathbf{\\epsilon}} = \\sigma^{-1}\\mathbf{\\epsilon}$ 的协方差为 $\\mathbf{I}_{n}$，且 $E[\\|\\tilde{\\mathbf{\\epsilon}}\\|_2^2] = \\text{Tr}(\\mathbf{I}_{n}) = n$。此方法需要对噪声方差 $\\sigma^2$ 有准确的先验估计。如果对 $\\sigma^2$ 的估计不佳，得到的 $\\lambda$ 可能不是最优的。\n\n**GCV方法** 不需要知道 $\\sigma^2$。它旨在最小化 GCV 函数，该函数是留一交叉验证误差的代理。GCV 函数为 $V(\\lambda) = \\frac{\\|\\mathbf{G}\\mathbf{m}(\\lambda)-\\mathbf{d}\\|_2^2}{(\\text{Tr}(\\mathbf{I}-\\mathbf{A}(\\lambda)))^2}$，其中 $\\mathbf{A}(\\lambda)$ 是将数据映射到预测的影响矩阵。分母中的项 $\\text{Tr}(\\mathbf{I}-\\mathbf{A}(\\lambda))$ 是残差的有效自由度。因此，GCV 寻求一个能够最小化残差范数，但惩罚过于复杂的模型（即残差中有效自由度少的模型）的 $\\lambda$ 值。\n\n**L曲线法**是一种启发式技术，也不需要知道 $\\sigma^2$。它涉及在一系列 $\\lambda$ 值上，以对数-对数坐标绘制解范数 $\\|\\mathbf{m}(\\lambda)\\|_2$ 对残差范数 $\\|\\mathbf{G}\\mathbf{m}(\\lambda)-\\mathbf{d}\\|_2$。得到的曲线通常呈“L”形。这个“L”的拐角被解释为在最小化残差（数据拟合）和最小化解范数（正则化）之间达到最佳平衡的点。这对应于曲线上曲率最大的点。虽然直观，但它在统计学上的严谨性不如其他两种方法。\n\n总结来说，当噪声方差 $\\sigma^2$ 可靠已知时，偏差原理是理想的。当 $\\sigma^2$ 未知时，GCV 是一个稳健的替代方案，因为它通过适当地考虑模型的有效自由度，从数据中有效地估计噪声水平。当 $\\sigma^2$ 未知时，L曲线法提供了一种实用的、图形化的方法来平衡正则化中固有的权衡。",
            "answer": "$$\n\\boxed{\\lambda_{k+1} = \\lambda_{k} - \\frac{\\left( \\sum_{i=1}^{p} \\left( \\frac{\\lambda_{k}^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda_{k}^{2}} \\right)^{2} + \\sum_{i=p+1}^{n} a_{i}^{2} \\right) - n}{4\\lambda_{k}^{3} \\sum_{i=1}^{p} \\frac{a_{i}^{2}\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda_{k}^{2})^{3}}}}\n$$"
        }
    ]
}