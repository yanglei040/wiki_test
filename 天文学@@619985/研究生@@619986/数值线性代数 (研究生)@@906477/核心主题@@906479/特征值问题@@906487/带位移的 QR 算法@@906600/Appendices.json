{
        "hands_on_practices": [
            {
                "introduction": "为了真正掌握一个算法，没有什么比亲手计算一遍更有效了。第一个实践将聚焦于单步移位QR迭代的基本机理。我们将对一个对称三对角矩阵应用一个给定的位移，并使用正交变换（吉文斯旋转）来计算更新后的矩阵[@problem_id:3597253]。这个练习将巩固一个核心概念：移位QR步是一种正交相似变换，$A_1 = Q^T A Q$，它保持了矩阵的特征值不变。",
                "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 为对称三对角矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n2  1  0 \\\\\n1  3  1 \\\\\n0  1  4\n\\end{pmatrix},\n$$\n该矩阵有三个不同的特征值。考虑使用显式位移 $\\mu = 3$ 的正交三角分解 (QR) 算法的一个位移步。根据定义，一个位移 QR 步首先形成 $B = A - \\mu I$，然后将 $B$ 分解为 $B = Q R$（其中 $Q$ 是正交矩阵，$R$ 是上三角矩阵），最后更新 $A_1 = R Q + \\mu I$。从以下基本事实出发：\n- $Q$ 是正交的当且仅当 $Q^{T} Q = I$，\n- 并且当 $B = A - \\mu I$ 分解为 $B = Q R$ 时，位移 QR 步产生一个相似更新 $A_1 = Q^{T} A Q$，\n手动执行一个完整的位移 QR 步，使用保持数值稳定性和谱的基本正交变换。计算更新后的矩阵 $A_1$ 作为 $A$ 的一个正交相似变换，然后从 $A_1$ 中提取一个标量诊断值：第 $(1,2)$ 个元素。\n\n$A_1$ 的第 $(1,2)$ 个元素的确切值是多少？请以封闭形式的解析表达式给出你的答案。不允许进行四舍五入。",
                "solution": "本题要求计算对给定矩阵 $A$ 和位移 $\\mu$ 应用单位移 QR 步后得到的矩阵 $A_1$ 的第 $(1,2)$ 个元素。更新后的矩阵 $A_1$ 与原始矩阵 $A$ 通过相似变换 $A_1 = Q^{T} A Q$ 相关联，其中 $Q$ 是来自 $B = A - \\mu I$ 的 QR 分解的正交矩阵。\n\n给定矩阵为\n$$A = \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix}$$\n位移为 $\\mu = 3$。\n\n1.  **构造位移矩阵 B**\n    $$B = A - \\mu I = \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix} - 3 \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} -1  1  0 \\\\ 1  0  1 \\\\ 0  1  1 \\end{pmatrix}$$\n\n2.  **构造正交变换**\n    我们将使用 Givens 旋转来构造正交矩阵 $Q$。整个变换由 $Q^T = G_2 G_1$ 给出，其中 $G_1$ 和 $G_2$ 是连续的 Givens 旋转，旨在将 $B$ 变换为上三角矩阵。更新后的矩阵为 $A_1 = G_2 G_1 A (G_2 G_1)^T = G_2 (G_1 A G_1^T) G_2^T$。\n\n3.  **计算第一步变换**\n    第一步是消去 $B_{21}$。我们定义 Givens 旋转 $G_1 = \\begin{pmatrix} c_1  s_1  0 \\\\ -s_1  c_1  0 \\\\ 0  0  1 \\end{pmatrix}$，其中 $c_1 = -1/\\sqrt{2}$ 和 $s_1 = 1/\\sqrt{2}$。\n    我们先计算中间矩阵 $A' = G_1 A G_1^T$。\n    $$G_1 A = \\begin{pmatrix} -1/\\sqrt{2}  1/\\sqrt{2}  0 \\\\ -1/\\sqrt{2}  -1/\\sqrt{2}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix} = \\begin{pmatrix} -1/\\sqrt{2}  \\sqrt{2}  1/\\sqrt{2} \\\\ -3/\\sqrt{2}  -2\\sqrt{2}  -1/\\sqrt{2} \\\\ 0  1  4 \\end{pmatrix}$$\n    $$A' = (G_1 A) G_1^T = \\begin{pmatrix} -1/\\sqrt{2}  \\sqrt{2}  1/\\sqrt{2} \\\\ -3/\\sqrt{2}  -2\\sqrt{2}  -1/\\sqrt{2} \\\\ 0  1  4 \\end{pmatrix} \\begin{pmatrix} -1/\\sqrt{2}  -1/\\sqrt{2}  0 \\\\ 1/\\sqrt{2}  -1/\\sqrt{2}  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 3/2  -1/2  1/\\sqrt{2} \\\\ -1/2  7/2  -1/\\sqrt{2} \\\\ 1/\\sqrt{2}  -1/\\sqrt{2}  4 \\end{pmatrix}$$\n\n4.  **计算第二步变换并提取结果**\n    第二步需要构造 $G_2$ 来消去 $G_1 B$ 中的 $(3,2)$ 元素。我们定义 $G_2 = \\begin{pmatrix} 1  0  0 \\\\ 0  c_2  s_2 \\\\ 0  -s_2  c_2 \\end{pmatrix}$，其中 $c_2 = -1/\\sqrt{3}$ 和 $s_2 = \\sqrt{2}/\\sqrt{3}$。\n    我们需要计算 $A_1 = G_2 A' G_2^T$ 的 $(1,2)$ 元素。\n    $$(A_1)_{12} = \\sum_{k,l} (G_2)_{1k} A'_{kl} (G_2^T)_{l2}$$\n    由于 $G_2$ 的第一行是 $(1, 0, 0)$，这简化为：\n    $$(A_1)_{12} = \\sum_{l} A'_{1l} (G_2^T)_{l2} = (A'\\text{的第一行}) \\cdot (G_2^T\\text{的第二列})$$\n    $A'$ 的第一行是 $(3/2, -1/2, 1/\\sqrt{2})$。\n    $G_2$ 的转置是 $G_2^T = \\begin{pmatrix} 1  0  0 \\\\ 0  c_2  -s_2 \\\\ 0  s_2  c_2 \\end{pmatrix}$。它的第二列是 $\\begin{pmatrix} 0 \\\\ c_2 \\\\ s_2 \\end{pmatrix}$。\n    因此，\n    $$(A_1)_{12} = \\left(\\frac{3}{2}\\right)(0) + \\left(-\\frac{1}{2}\\right)(c_2) + \\left(\\frac{1}{\\sqrt{2}}\\right)(s_2)$$\n    代入 $c_2 = -1/\\sqrt{3}$ 和 $s_2 = \\sqrt{2}/\\sqrt{3}$ 的值：\n    $$(A_1)_{12} = \\left(-\\frac{1}{2}\\right)\\left(-\\frac{1}{\\sqrt{3}}\\right) + \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{\\sqrt{2}}{\\sqrt{3}}\\right) = \\frac{1}{2\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{3}{2\\sqrt{3}}$$\n    将分母有理化，我们得到最终结果：\n    $$(A_1)_{12} = \\frac{3\\sqrt{3}}{2 \\cdot 3} = \\frac{\\sqrt{3}}{2}$$",
                "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$",
                "id": "3597253"
            },
            {
                "introduction": "上一个练习展示了QR迭代步骤是*如何*运作的，但该算法的威力在于明智地选择位移量 $\\mu$。本实践旨在探讨位移策略在决定收敛速度方面的关键作用。通过分析一个特殊构造的矩阵[@problem_id:3597266]，我们将理解为何当特征值靠得很近时，像瑞利商位移这样的简单选择会导致收敛缓慢。这启发我们去推导更复杂且收敛更快的威尔金森（Wilkinson）位移，从而将位移的选择与矩阵的谱特性直接联系起来。",
                "problem": "考虑将带位移的正交三角分解（QR）算法应用于实对称三对角矩阵。方阵 $A$ 的正交三角（QR）分解是一种形式为 $A = Q R$ 的分解，其中 $Q$ 是正交矩阵，$R$ 是上三角矩阵。在带位移的QR算法中，对于一个选定的标量位移 $\\mu$，计算 $A - \\mu I$ 的QR分解，然后构成 $A^{+} = R Q + \\mu I$。$A^{+}$ 与 $A$ 正交相似，并且在隐式构造下保持对称性和三对角结构。\n\n设 $\\varepsilon$ 为一个小的正参数，并考虑对称三对角矩阵\n$$\nT(\\varepsilon) \\;=\\;\n\\begin{pmatrix}\n1  \\varepsilon  0 \\\\\n\\varepsilon  1 + \\varepsilon^{2}  \\varepsilon \\\\\n0  \\varepsilon  1 + 2 \\varepsilon^{2}\n\\end{pmatrix}.\n$$\n关注其尾部的 $2 \\times 2$ 子块\n$$\nB(\\varepsilon) \\;=\\;\n\\begin{pmatrix}\n1 + \\varepsilon^{2}  \\varepsilon \\\\\n\\varepsilon  1 + 2 \\varepsilon^{2}\n\\end{pmatrix}.\n$$\n将右下角元素作为 Rayleigh 商位移，即 $\\mu_{\\mathrm{R}}(\\varepsilon) = T_{33}(\\varepsilon) = 1 + 2 \\varepsilon^{2}$，这在实践中经常使用。但是，当最末两个特征值之间的间隔很小时，这种选择可能导致最末次对角线元素收敛到零的速度变慢，并延迟缩减（deflation）。\n\n从上述定义和性质出发，完成以下任务：\n\n1. 推导尾部子块 $B(\\varepsilon)$ 的精确特征值，并确定它们之间的谱隙（spectral gap）作为 $\\varepsilon$ 的函数。解释为什么当 $\\varepsilon$ 很小时，这个谱隙也很小。\n\n2. 基于正交相似性和带位移QR步在特征基下的行为进行论证，证明当位移取为 $\\mu_{\\mathrm{R}}(\\varepsilon)$ 时，为什么 $T(\\varepsilon)$ 的最后两个特征值之间的小谱隙意味着最末次对角线元素的衰减缓慢。你的证明应精确说明衰减对距离 $|\\lambda_{2}(\\varepsilon) - \\mu|$ 和 $|\\lambda_{3}(\\varepsilon) - \\mu|$ 的依赖关系，其中 $\\lambda_{2}(\\varepsilon)$ 和 $\\lambda_{3}(\\varepsilon)$ 是适当选择的特征值。\n\n3. 基于尾部 $2 \\times 2$ 子块的特征结构，提出一个改进的位移，并将其精确计算为 $\\varepsilon$ 的函数。将你的最终答案表示为改进位移的单个闭式解析表达式。如果可以简化，请提供简化形式。不需要四舍五入。",
                "solution": "该问题提法明确，科学上根植于数值线性代数，并提供了一个自洽、一致的设定。求解所需的所有数据均已提供。因此，我将进行完整的推导。\n\n问题要求对应用于特定对称三对角矩阵 $T(\\varepsilon)$ 的带位移QR算法进行三部分分析。\n\n**1. 尾部子块 $B(\\varepsilon)$ 的特征值和谱隙**\n\n尾部 $2 \\times 2$ 子块为：\n$$\nB(\\varepsilon) =\n\\begin{pmatrix}\n1 + \\varepsilon^{2}  \\varepsilon \\\\\n\\varepsilon  1 + 2 \\varepsilon^{2}\n\\end{pmatrix}\n$$\n$B(\\varepsilon)$ 的特征值（记为 $\\lambda$）是特征方程 $\\det(B(\\varepsilon) - \\lambda I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix}\n1 + \\varepsilon^{2} - \\lambda  \\varepsilon \\\\\n\\varepsilon  1 + 2 \\varepsilon^{2} - \\lambda\n\\end{pmatrix} = 0\n$$\n展开行列式得到二次方程：\n$$\n(1 + \\varepsilon^{2} - \\lambda)(1 + 2 \\varepsilon^{2} - \\lambda) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - \\lambda(1 + \\varepsilon^{2} + 1 + 2 \\varepsilon^{2}) + (1 + \\varepsilon^{2})(1 + 2 \\varepsilon^{2}) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - (2 + 3\\varepsilon^{2})\\lambda + (1 + 3\\varepsilon^{2} + 2\\varepsilon^{4}) - \\varepsilon^{2} = 0\n$$\n$$\n\\lambda^{2} - (2 + 3\\varepsilon^{2})\\lambda + (1 + 2\\varepsilon^{2} + 2\\varepsilon^{4}) = 0\n$$\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $\\lambda$，其中 $a=1$, $b=-(2 + 3\\varepsilon^{2})$, $c=1 + 2\\varepsilon^{2} + 2\\varepsilon^{4}$。\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{(-(2 + 3\\varepsilon^{2}))^2 - 4(1)(1 + 2\\varepsilon^{2} + 2\\varepsilon^{4})}}{2}\n$$\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{(4 + 12\\varepsilon^{2} + 9\\varepsilon^{4}) - (4 + 8\\varepsilon^{2} + 8\\varepsilon^{4})}}{2}\n$$\n$$\n\\lambda = \\frac{(2 + 3\\varepsilon^{2}) \\pm \\sqrt{4\\varepsilon^{2} + \\varepsilon^{4}}}{2}\n$$\n由于 $\\varepsilon$ 是一个小的正参数，我们可以从平方根中提出 $\\varepsilon^2$：\n$$\n\\lambda = \\frac{2 + 3\\varepsilon^{2} \\pm \\sqrt{\\varepsilon^{2}(4 + \\varepsilon^{2})}}{2} = \\frac{2 + 3\\varepsilon^{2} \\pm \\varepsilon\\sqrt{4 + \\varepsilon^{2}}}{2}\n$$\n$B(\\varepsilon)$ 的两个特征值为：\n$$\n\\lambda_B^{-}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n$$\n\\lambda_B^{+}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n这些特征值之间的谱隙为 $\\Delta\\lambda_B = \\lambda_B^{+}(\\varepsilon) - \\lambda_B^{-}(\\varepsilon)$。\n$$\n\\Delta\\lambda_B = \\left(1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - \\left(1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) = \\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n对于小的 $\\varepsilon$，我们可以分析这个谱隙的行为：$\\Delta\\lambda_B = \\varepsilon \\cdot 2\\sqrt{1 + \\varepsilon^2/4} \\approx 2\\varepsilon(1 + \\varepsilon^2/8) \\approx 2\\varepsilon$。这个谱隙是 $O(\\varepsilon)$ 阶的，当 $\\varepsilon$ 很小时，它也很小。这证实了尾部子块的特征值彼此接近。\n\n**2. 使用 Rayleigh 位移收敛缓慢的理由**\n\n在带位移的QR算法中，最末次对角线元素 $T_{n, n-1}$ 的收敛性取决于位移 $\\mu$ 的选择。收敛速度与位移在分离某个特征值方面的有效性有关。其关键机制可以通过QR步的位移反演解释来理解。该算法隐式地对 $(T - \\mu I)^{-1}$ 执行一步幂法。向对应于 $T$ 的某个特征值 $\\lambda_j$ 的特征向量收敛的速度由 $(T - \\mu I)^{-1}$ 的特征值大小之比决定，具体为 $|\\frac{1/(\\lambda_k-\\mu)}{1/(\\lambda_j-\\mu)}| = |\\frac{\\lambda_j - \\mu}{\\lambda_k - \\mu}|$，其中 $\\lambda_j$ 是 $T$ 中最接近 $\\mu$ 的特征值，而 $\\lambda_k$ 是次接近的。当这个比值很小时，收敛速度快。\n\n对于给定的矩阵 $T(\\varepsilon)$，其最末两个特征值（我们称之为 $\\lambda_2(\\varepsilon)$ 和 $\\lambda_3(\\varepsilon)$）可以很好地由 $B(\\varepsilon)$ 的特征值近似，即 $\\lambda_2(\\varepsilon) \\approx \\lambda_B^{-}(\\varepsilon)$ 和 $\\lambda_3(\\varepsilon) \\approx \\lambda_B^{+}(\\varepsilon)$。Rayleigh 商位移为 $\\mu_{\\mathrm{R}}(\\varepsilon) = T_{33}(\\varepsilon) = 1 + 2 \\varepsilon^{2}$。\n\n让我们分析此位移到 $B(\\varepsilon)$ 特征值的距离。设 $\\lambda_3(\\varepsilon)$ 为目标特征值。用于 (3,2) 元素缩减的收敛因子将与 $|\\lambda_{2}(\\varepsilon) - \\mu_{\\mathrm{R}}| / |\\lambda_{3}(\\varepsilon) - \\mu_{\\mathrm{R}}|$ 相关。\n使用来自 $B(\\varepsilon)$ 的近似值：\n$$\n|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\left| \\left(1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - (1 + 2\\varepsilon^{2}) \\right| = \\left| -\\frac{1}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} \\right|\n$$\n由于当 $\\varepsilon>0$ 时 $\\sqrt{4+\\varepsilon^2} > \\sqrt{\\varepsilon^2} = \\varepsilon$，绝对值内的项为正。\n$$\n|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}\n$$\n对于另一个特征值：\n$$\n|\\lambda_B^{-}(\\varepsilon) - \\mu_{\\mathrm{R}}| = \\left| \\left(1 + \\frac{3}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\\right) - (1 + 2\\varepsilon^{2}) \\right| = \\left| -\\frac{1}{2}\\varepsilon^{2} - \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} \\right| = \\frac{1}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n$\\lambda_B^{+}(\\varepsilon)$ 是更接近 $\\mu_R$ 的特征值。分离 $\\lambda_3(\\varepsilon)$（由 $\\lambda_B^{+}(\\varepsilon)$ 近似）的过程的收敛性由 $\\mu_R$ 到次近特征值 $\\lambda_2(\\varepsilon)$ 的距离与到 $\\lambda_3(\\varepsilon)$ 的距离之比决定。\n这个比值近似为：\n$$\n\\frac{|\\lambda_B^{+}(\\varepsilon) - \\mu_{\\mathrm{R}}|}{|\\lambda_B^{-}(\\varepsilon) - \\mu_{\\mathrm{R}}|} = \\frac{\\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}}{\\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} + \\frac{1}{2}\\varepsilon^{2}} = \\frac{\\sqrt{4 + \\varepsilon^{2}} - \\varepsilon}{\\sqrt{4 + \\varepsilon^{2}} + \\varepsilon}\n$$\n对于小的 $\\varepsilon$，$\\sqrt{4 + \\varepsilon^{2}} \\approx 2(1 + \\varepsilon^2/8) = 2 + \\varepsilon^2/4$。该比值变为：\n$$\n\\frac{(2 + \\varepsilon^2/4) - \\varepsilon}{(2 + \\varepsilon^2/4) + \\varepsilon} \\approx \\frac{2 - \\varepsilon}{2 + \\varepsilon} = \\frac{1 - \\varepsilon/2}{1 + \\varepsilon/2} \\approx (1 - \\varepsilon/2)^2 \\approx 1 - \\varepsilon\n$$\n接近 1 的收敛比表示收敛非常缓慢。Rayleigh 位移 $\\mu_{\\mathrm{R}}(\\varepsilon)$ 位于两个相近的特征值 $\\lambda_2(\\varepsilon)$ 和 $\\lambda_3(\\varepsilon)$ 之间，但并不特别接近任何一个，因此在这种情况下其性能不佳。\n\n**3. 改进位移的提出与计算**\n\nRayleigh 位移的缓慢收敛可以通过选择一个能极好地逼近目标特征值之一的位移来纠正。在这种情况下，标准且优越得多的策略是 Wilkinson 位移。对于对称三对角矩阵，Wilkinson 位移被定义为尾部 $2 \\times 2$ 子矩阵中更接近右下角元素 $T_{nn}$ 的那个特征值。\n\n在我们的例子中，尾部子矩阵是 $B(\\varepsilon)$，右下角元素是 $T_{33}(\\varepsilon) = B_{22}(\\varepsilon) = 1 + 2\\varepsilon^2$。我们必须确定两个特征值 $\\lambda_B^{-}(\\varepsilon)$ 和 $\\lambda_B^{+}(\\varepsilon)$ 中哪一个更接近 $1 + 2\\varepsilon^2$。\n我们已经在第2部分计算了这些距离：\n$$\n|\\lambda_B^{+}(\\varepsilon) - (1+2\\varepsilon^2)| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} - \\frac{1}{2}\\varepsilon^{2}\n$$\n$$\n|\\lambda_B^{-}(\\varepsilon) - (1+2\\varepsilon^2)| = \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}} + \\frac{1}{2}\\varepsilon^{2}\n$$\n通过观察可以清楚地看到 $|\\lambda_B^{+}(\\varepsilon) - (1+2\\varepsilon^2)|  |\\lambda_B^{-}(\\varepsilon) - (1+2\\varepsilon^2)|$。\n因此，改进的位移，即 Wilkinson 位移 $\\mu_W(\\varepsilon)$，是 $\\lambda_B^{+}(\\varepsilon)$。\n\n这个改进位移的精确解析表达式是：\n$$\n\\mu_W(\\varepsilon) = \\lambda_B^{+}(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}\n$$\n这个表达式是其最简闭式形式。选择此位移可以非常精确地逼近 $T(\\varepsilon)$ 的真实特征值 $\\lambda_3(\\varepsilon)$，从而确保比值 $|\\lambda_3(\\varepsilon) - \\mu_W| / |\\lambda_2(\\varepsilon) - \\mu_W|$ 极小，这反过来又保证了最末次对角线元素能快速（对于对称矩阵是三次）收敛到零。\n通过将 $1/2$ 移入平方根可以得到一个等价形式：\n$$\n\\mu_W(\\varepsilon) = 1 + \\frac{3}{2}\\varepsilon^{2} + \\varepsilon\\sqrt{1 + \\frac{\\varepsilon^{2}}{4}}\n$$\n然而，第一种形式是标准的。",
                "answer": "$$\\boxed{1 + \\frac{3}{2}\\varepsilon^{2} + \\frac{1}{2}\\varepsilon\\sqrt{4 + \\varepsilon^{2}}}$$",
                "id": "3597266"
            },
            {
                "introduction": "从理论到实践会引入新的挑战，特别是与有限精度计算机算术相关的挑战。即使是像威尔金森（Wilkinson）位移这样理论上最优的策略，如果实现方式不当，也可能会失败。本练习[@problem_id:3597254]将展示一个场景，其中计算威尔金森位移的标准公式会遭受灾难性相消，导致结果不准确。你将诊断出这种数值不稳定性的根源，并推导出一个代数上等价且能保证在浮点环境中稳健执行的“保护性”公式，这突显了数值分析与实际算法设计之间至关重要的相互作用。",
                "problem": "考虑将带位移的正交三角 (QR) 算法应用于对称三对角矩阵。在带位移的QR算法中，位移量从尾部 $2 \\times 2$ 主子矩阵的特征值中选取。设尾部块为\n$$\nB \\;=\\; \\begin{pmatrix}\n\\alpha  \\beta \\\\\n\\beta  \\gamma\n\\end{pmatrix}, \\quad \\text{with } \\delta \\equiv \\frac{\\alpha - \\gamma}{2}, \\quad s \\equiv \\frac{\\alpha + \\gamma}{2}, \\quad r \\equiv \\sqrt{\\delta^{2} + \\beta^{2}}.\n$$\n在一个浮点模型下进行计算，该模型采用舍入到最近，且十进制尾数具有 $8$ 位有效数字。构造一个对称三对角矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$，其尾部 $2 \\times 2$ 块具有以下参数\n$$\n\\gamma \\;=\\; 0, \\quad \\delta \\;=\\; -10^{-8}, \\quad \\beta \\;=\\; 3 \\times 10^{-13},\n$$\n并假设 $T$ 的其他元素在数值上适中，因此只有尾部块决定位移量的选择。位移量取为 $B$ 的特征值中更接近 $\\gamma$ 的那个。\n\n仅使用QR算法和浮点舍入的核心定义和已验证的事实，完成以下任务：\n\n1. 从 $B$ 的特征多项式出发，用 $s$ 和 $r$ 表示其特征值。当 $\\delta  0$ 时，确定 $s + r$ 和 $s - r$ 中哪一个更接近 $\\gamma$。解释为什么在有限精度下（在所述的舍入模型下），对该选择的朴素计算会遭受灾难性抵消，并确定在这种情况下朴素计算得到的值 $\\mu_{\\text{naive}}$。\n\n2. 在不引用任何预先给出的“受保护公式”的情况下，代数推导出一个等价的特征值表示，该表示可以证明避免了减法抵消。利用特征多项式所蕴含的恒等式来有理化表达式，并得到一个在 $\\delta  0$ 时是良态的分母。然后，对于给定的数值参数，将得到的受保护表达式 $\\mu_{\\text{guarded}}$ 简化为小比率 $|\\beta|/|\\delta|$ 的主导项。\n\n3. 对给定的参数，数值计算 $\\mu_{\\text{guarded}}$，并用科学记数法表示最终答案。将最终答案四舍五入到两位有效数字。\n\n你的最终答案必须是步骤3中得到的稳定位移量 $\\mu_{\\text{guarded}}$，表示为单一的科学记数法实数。",
                "solution": "我们从尾部块开始\n$$\nB \\;=\\; \\begin{pmatrix}\n\\alpha  \\beta \\\\\n\\beta  \\gamma\n\\end{pmatrix}, \\quad \\delta \\equiv \\frac{\\alpha - \\gamma}{2}, \\quad s \\equiv \\frac{\\alpha + \\gamma}{2}, \\quad r \\equiv \\sqrt{\\delta^{2} + \\beta^{2}}.\n$$\n$B$ 的特征多项式是\n$$\np(\\lambda) \\;=\\; \\lambda^{2} - (\\alpha + \\gamma)\\lambda + (\\alpha \\gamma - \\beta^{2}),\n$$\n它的两个实特征值是根\n$$\n\\lambda_{\\pm} \\;=\\; s \\pm r.\n$$\n在对称三对角带位移QR算法中，位移量选择为更接近右下角元素 $\\gamma$ 的特征值（即所谓的Wilkinson位移）。我们确定当 $\\delta  0$ 时，$\\lambda_{+}$ 或 $\\lambda_{-}$ 哪个更接近 $\\gamma$。注意到\n$$\ns \\;=\\; \\frac{\\alpha + \\gamma}{2} \\;=\\; \\gamma + \\delta,\n$$\n所以\n$$\n\\lambda_{+} \\;=\\; s + r \\;=\\; \\gamma + \\delta + r, \\qquad \\lambda_{-} \\;=\\; s - r \\;=\\; \\gamma + \\delta - r.\n$$\n当 $\\delta  0$ 时，我们有 $r \\approx |\\delta|$，因此\n$$\n|\\lambda_{+} - \\gamma| \\;=\\; |\\delta + r| \\;\\approx\\; | -|\\delta| + |\\delta| | \\;\\approx\\; 0, \\qquad |\\lambda_{-} - \\gamma| \\;\\approx\\; |-|\\delta| - |\\delta|| \\;=\\; 2|\\delta|,\n$$\n所以更接近 $\\gamma$ 的特征值是 $\\lambda_{+} = s + r$。\n\n我们现在证明，对 $s + r$ 的朴素计算在有限精度下会遭受灾难性抵消，并且在所述的舍入模型下，得出 $\\mu_{\\text{naive}} = \\gamma$。使用给定的参数\n$$\n\\gamma = 0, \\quad \\delta = -10^{-8}, \\quad \\beta = 3 \\times 10^{-13}.\n$$\n精确计算 $r$：\n$$\nr \\;=\\; \\sqrt{\\delta^{2} + \\beta^{2}} \\;=\\; \\sqrt{(10^{-8})^{2} + (3 \\times 10^{-13})^{2}} \\;=\\; 10^{-8}\\sqrt{1 + 9 \\times 10^{-10}}.\n$$\n使用一阶展开式 $\\sqrt{1 + x} = 1 + \\frac{x}{2} + \\mathcal{O}(x^{2})$，其中 $x = 9 \\times 10^{-10}$，我们有\n$$\nr \\;=\\; 10^{-8}\\left(1 + \\frac{9 \\times 10^{-10}}{2} + \\mathcal{O}\\!\\left(10^{-20}\\right)\\right) \\;=\\; 10^{-8} + 4.5 \\times 10^{-18} + \\mathcal{O}\\!\\left(10^{-28}\\right).\n$$\n在十进制下舍入到最近且有 $8$ 位有效数字的情况下，在 $10^{-8}$ 的尺度上，末位的单位是 $10^{-16}$。增量 $4.5 \\times 10^{-18}$ 小于半个ulp（$5 \\times 10^{-17}$），所以\n$$\n\\mathrm{fl}(r) \\;=\\; 10^{-8}, \\qquad \\mathrm{fl}(s) \\;=\\; \\mathrm{fl}(\\gamma + \\delta) \\;=\\; -10^{-8}.\n$$\n因此，朴素计算得到\n$$\n\\mu_{\\text{naive}} \\;=\\; \\mathrm{fl}(s + r) \\;=\\; \\mathrm{fl}(-10^{-8} + 10^{-8}) \\;=\\; 0 \\;=\\; \\gamma,\n$$\n这将位移量精确地置于右下角对角线上，并在随后的隐式QR步中产生近似的分解，因为 $B - \\mu_{\\text{naive}} I$ 的右下角对角元素为零，导致初始的凸起注入是病态的。\n\n为了恢复稳定性，我们寻求一个代数上等价的 $\\lambda_{+}$ 表示，以避免两个几乎相等的数相减。从恒等式\n$$\nr^{2} - \\delta^{2} \\;=\\; \\beta^{2} \\quad \\Rightarrow \\quad r + \\delta \\;=\\; \\frac{\\beta^{2}}{r - \\delta},\n$$\n开始，我们可以将 $\\lambda_{+}$ 有理化为\n$$\n\\lambda_{+} \\;=\\; s + r \\;=\\; \\gamma + \\delta + r \\;=\\; \\gamma + (r + \\delta) \\;=\\; \\gamma + \\frac{\\beta^{2}}{r - \\delta}.\n$$\n当 $\\delta  0$ 时，这个形式可以防止抵消，因为 $r - \\delta \\approx |\\delta| - \\delta = |\\delta| + |\\delta| = 2|\\delta|$ 与零有显著差异。对于我们的参数，\n$$\nr - \\delta \\;=\\; \\left(10^{-8} + 4.5 \\times 10^{-18} + \\cdots\\right) - (-10^{-8}) \\;=\\; 2 \\times 10^{-8} + 4.5 \\times 10^{-18} + \\cdots.\n$$\n因此，受保护的位移量是\n$$\n\\mu_{\\text{guarded}} \\;=\\; \\gamma + \\frac{\\beta^{2}}{r - \\delta} \\;\\approx\\; \\gamma + \\frac{\\beta^{2}}{2|\\delta|} \\;=\\; \\frac{(3 \\times 10^{-13})^{2}}{2 \\times 10^{-8}} \\;=\\; \\frac{9 \\times 10^{-26}}{2 \\times 10^{-8}} \\;=\\; 4.5 \\times 10^{-18}.\n$$\n这个值是一个不同于 $\\gamma$ 的小的正位移量，因此它打破了导致朴素计算停滞的精确抵消，并产生了一个良态的初始隐式QR步。\n\n根据问题陈述，我们以科学记数法报告最终值，并四舍五入到两位有效数字。主导项的值已经用两位有效数字表示：\n$$\n\\mu_{\\text{guarded}} \\;\\approx\\; 4.5 \\times 10^{-18}.\n$$",
                "answer": "$$\\boxed{4.5 \\times 10^{-18}}$$",
                "id": "3597254"
            }
        ]
    }