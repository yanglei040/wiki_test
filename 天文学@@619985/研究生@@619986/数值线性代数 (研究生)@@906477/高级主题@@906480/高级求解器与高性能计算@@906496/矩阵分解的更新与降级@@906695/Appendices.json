{
        "hands_on_practices": [
            {
                "introduction": "当从矩阵 $A$ 中移除一列时，其QR分解中的上三角因子 $R$ 会失去其结构，形成一个“凸起”或“尖峰”。本练习将通过一个具体的、分步的示例，指导您如何使用数值线性代数中的基本工具——吉文斯旋转 (Givens rotations)——来系统地消除这个凸起，恢复所需的上三角形式[@problem_id:3600365]。这项实践对于理解许多更新/降阶算法的底层机制至关重要。",
                "problem": "设 $n=3$ 且 $m=5$。考虑一个实矩阵 $A \\in \\mathbb{R}^{n \\times m}$，它有一个正交三角（QR）分解 $A = Q R$，其中 $Q \\in \\mathbb{R}^{3 \\times 3}$ 是正交矩阵，$R \\in \\mathbb{R}^{3 \\times 5}$ 是上梯形矩阵，其前导 $3 \\times 3$ 子块为上三角矩阵。假设因子 $R$ 为\n$$\nR \\;=\\;\n\\begin{pmatrix}\n2  1  2  0  3 \\\\\n0  5  3  1  2 \\\\\n0  0  4  2  1\n\\end{pmatrix}.\n$$\n我们移除 $A$ 的第二列（因此也移除 $R$ 的第二列），形成一个降级更新的矩阵 $A' \\in \\mathbb{R}^{3 \\times 4}$ 和一个通过删除 $R$ 的第二列得到的中间矩阵 $R_{\\text{del}} \\in \\mathbb{R}^{3 \\times 4}$。仅使用正交变换和 Givens 旋转的基本性质，通过明确指定应用于 $R_{\\text{del}}$ 以恢复具有上三角前导 $3 \\times 3$ 子块的上梯形结构的 Givens 旋转序列，来执行 QR 降级更新。特别地，从第一性原理推导旋转参数，并将其应用于受影响的列，以消除因列删除而引入的次对角线元素。\n\n作为最终答案，报告前导三角块中第二列更新后的对角线元素的确切值，即 $r'_{22}$。提供确切值；无需四舍五入。",
                "solution": "该问题陈述经核实具有科学依据、问题适定且客观。这是数值线性代数中一个标准练习，涉及在移除一列后对 QR 分解进行降级更新。所有必要数据均已提供，任务定义明确。\n\n出发点是给定矩阵 $A \\in \\mathbb{R}^{3 \\times 5}$ 的上梯形因子 $R \\in \\mathbb{R}^{3 \\times 5}$。\n$$\nR \\;=\\;\n\\begin{pmatrix}\n2  1  2  0  3 \\\\\n0  5  3  1  2 \\\\\n0  0  4  2  1\n\\end{pmatrix}.\n$$\n问题指明，移除原始矩阵 $A$ 的第二列，这对应于移除 $R$ 的第二列。此操作产生一个中间矩阵 $R_{\\text{del}} \\in \\mathbb{R}^{3 \\times 4}$。\n$$\nR_{\\text{del}} \\;=\\;\n\\begin{pmatrix}\n2  2  0  3 \\\\\n0  3  1  2 \\\\\n0  4  2  1\n\\end{pmatrix}.\n$$\n由于位置 $(3, 2)$ 处的非零元素 $r_{32} = 4$，矩阵 $R_{\\text{del}}$ 不再是上梯形形式。这种第一副对角线下方所有元素均为零的结构，被称为上海森堡形式（upper Hessenberg form）。\n\n为了恢复上梯形形式，我们必须在位置 $(3, 2)$ 处引入一个零。这可以通过将 $R_{\\text{del}}$ 左乘一个合适的正交矩阵来实现，该矩阵旋转第二行和第三行。Givens 旋转是为此目的设计的初等正交变换。我们寻找一个 Givens 旋转矩阵 $G_{23} \\in \\mathbb{R}^{3 \\times 3}$，它作用于由第二和第三标准基向量张成的平面。该矩阵具有以下形式：\n$$\nG_{23} =\n\\begin{pmatrix}\n1  0  0 \\\\\n0  c  s \\\\\n0  -s  c\n\\end{pmatrix}\n$$\n其中对于某个角度 $\\theta$，有 $c = \\cos(\\theta)$ 和 $s = \\sin(\\theta)$，并满足条件 $c^2 + s^2 = 1$。\n\n我们称之为 $R'$ 的新上梯形矩阵通过乘积 $R' = G_{23} R_{\\text{del}}$ 得到。该变换只影响 $R_{\\text{del}}$ 的第二行和第三行。设 $R_{\\text{del}}$ 的第二行和第三行分别为 $\\mathbf{r}_2^{\\mathsf{T}} = \\begin{pmatrix} 0  3  1  2 \\end{pmatrix}$ 和 $\\mathbf{r}_3^{\\mathsf{T}} = \\begin{pmatrix} 0  4  2  1 \\end{pmatrix}$。新的第二行和第三行 $\\mathbf{r'}_2^{\\mathsf{T}}$ 和 $\\mathbf{r'}_3^{\\mathsf{T}}$ 将是旧行的线性组合：\n$$\n\\begin{pmatrix} \\mathbf{r'}_2^{\\mathsf{T}} \\\\ \\mathbf{r'}_3^{\\mathsf{T}} \\end{pmatrix} = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} \\begin{pmatrix} \\mathbf{r}_2^{\\mathsf{T}} \\\\ \\mathbf{r}_3^{\\mathsf{T}} \\end{pmatrix}.\n$$\n参数 $c$ 和 $s$ 由所得矩阵 $R'$ 中位置 $(3, 2)$ 处的元素变为零的要求确定。这个条件应用于 $R_{\\text{del}}$ 的第二列，特别是子向量 $\\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$。我们要求：\n$$\n\\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} r'_{22} \\\\ 0 \\end{pmatrix}\n$$\n其中 $r'_{22}$ 是新的对角线元素。这个矩阵-向量方程产生一个由两个线性方程组成的方程组：\n1. $3c + 4s = r'_{22}$\n2. $-3s + 4c = 0$\n\n从第二个方程，我们得到 $4c = 3s$。我们可以用 $c$ 来表示 $s$，$s = \\frac{4}{3}c$。将此代入恒等式 $c^2+s^2=1$ 中：\n$$ c^2 + \\left(\\frac{4}{3}c\\right)^2 = 1 \\implies c^2 + \\frac{16}{9}c^2 = 1 \\implies \\frac{25}{9}c^2 = 1 \\implies c^2 = \\frac{9}{25}. $$\nGivens 旋转的一个标准约定是为 $c$ 选择正根，所以 $c = \\frac{3}{5}$。因此，$s = \\frac{4}{3}c = \\frac{4}{3} \\cdot \\frac{3}{5} = \\frac{4}{5}$。\n\n这些 $c$ 和 $s$ 的值定义了具体的 Givens 旋转。现在我们可以使用第一个方程计算新的对角线元素 $r'_{22}$：\n$$ r'_{22} = 3c + 4s = 3\\left(\\frac{3}{5}\\right) + 4\\left(\\frac{4}{5}\\right) = \\frac{9}{5} + \\frac{16}{5} = \\frac{25}{5} = 5. $$\n另外，对于一个旨在用主元 $a$ 将元素 $b$ 置零的 Givens 旋转，新的主元值总是向量 $\\begin{pmatrix} a \\\\ b \\end{pmatrix}$ 的欧几里得范数。在我们的例子中，$a = 3$ 且 $b = 4$，所以 $r'_{22} = \\sqrt{3^2 + 4^2} = \\sqrt{9+16} = \\sqrt{25} = 5$。这证实了我们的计算。\n\n问题要求的是 $r'_{22}$，我们已经找到了它。为了完整起见，我们可以计算整个更新后的矩阵 $R'$。第一行保持不变。新的第二行和第三行是：\n$$\n\\mathbf{r'}_2^{\\mathsf{T}} = c \\mathbf{r}_2^{\\mathsf{T}} + s \\mathbf{r}_3^{\\mathsf{T}} = \\frac{3}{5}\\begin{pmatrix} 0  3  1  2 \\end{pmatrix} + \\frac{4}{5}\\begin{pmatrix} 0  4  2  1 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{9+16}{5}  \\frac{3+8}{5}  \\frac{6+4}{5} \\end{pmatrix} = \\begin{pmatrix} 0  5  \\frac{11}{5}  2 \\end{pmatrix}.\n$$\n$$\n\\mathbf{r'}_3^{\\mathsf{T}} = -s \\mathbf{r}_2^{\\mathsf{T}} + c \\mathbf{r}_3^{\\mathsf{T}} = -\\frac{4}{5}\\begin{pmatrix} 0  3  1  2 \\end{pmatrix} + \\frac{3}{5}\\begin{pmatrix} 0  4  2  1 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{-12+12}{5}  \\frac{-4+6}{5}  \\frac{-8+3}{5} \\end{pmatrix} = \\begin{pmatrix} 0  0  \\frac{2}{5}  -1 \\end{pmatrix}.\n$$\n完全更新后的矩阵 $R'$ 是：\n$$\nR' =\n\\begin{pmatrix}\n2  2  0  3 \\\\\n0  5  \\frac{11}{5}  2 \\\\\n0  0  \\frac{2}{5}  -1\n\\end{pmatrix}.\n$$\n该矩阵是所要求的上梯形形式，并且其前导 $3 \\times 3$ 子块是上三角的。位置 $(2, 2)$ 处的值确实是 $5$。\n\n所要求的具体值是第二列中更新后的对角线元素 $r'_{22}$。\n$$\nr'_{22} = 5.\n$$",
                "answer": "$$\n\\boxed{5}\n$$",
                "id": "3600365"
            },
            {
                "introduction": "在掌握了因子分解更新的力学原理之后，这个练习将探讨一个常见的实际场景：当一个数据点被移除时，如何更新线性最小二乘问题的解。本练习将展示，通过对数据矩阵的QR或Cholesky因子分解进行降级，可以高效地得到新的解，从而避免从头开始进行昂贵的重新计算[@problem_id:3600432]。通过使用两种不同的方法（基于QR和基于正规方程）解决该问题，您将更深刻地体会到这些方法之间的联系及其实用价值。",
                "problem": "考虑由超定系统 $\\min_{x \\in \\mathbb{R}^{2}} \\|A x - b\\|_{2}$ 定义的线性最小二乘 (LS) 问题，其中\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  0\\\\\n1  1\\\\\n1  2\\\\\n2  1\n\\end{pmatrix}\n,\\quad\nb \\;=\\;\n\\begin{pmatrix}\n1\\\\\n2\\\\\n2\\\\\n3\n\\end{pmatrix}.\n$$\n移除单个观测值：删除 $A$ 的第三行和 $b$ 的第三个元素，得到降阶更新后的数据\n$$\nA' \\;=\\;\n\\begin{pmatrix}\n1  0\\\\\n1  1\\\\\n2  1\n\\end{pmatrix}\n,\\quad\nb' \\;=\\;\n\\begin{pmatrix}\n1\\\\\n2\\\\\n3\n\\end{pmatrix}.\n$$\n从 LS 的基本定义以及关于正规方程的正交三角 (QR) 分解和 Cholesky 分解的核心事实出发，使用以下两种基本方法推导出行删除后更新的 LS 解 $\\hat{x}'$：\n- 一种基于 QR 的降阶更新，通过正交变换恢复上三角因子。\n- 一种对正规矩阵和右端项进行的基于 Cholesky 的秩一降阶更新。\n\n证明这两种方法产生相同的 $\\hat{x}'$。将最终答案表示为单个行向量。无需四舍五入。",
                "solution": "该问题要求解一个降阶更新后的线性最小二乘 (LS) 问题。给定一个初始 LS 问题 $\\min_{x \\in \\mathbb{R}^{2}} \\|A x - b\\|_{2}$，通过删除矩阵 $A$ 的第三行和向量 $b$ 的第三个元素，形成一个新问题 $\\min_{x' \\in \\mathbb{R}^{2}} \\|A' x' - b'\\|_{2}$。我们必须使用两种不同的方法——基于 QR 的降阶更新和基于 Cholesky 的降阶更新——来找到新的解向量 $\\hat{x}'$，并证明它们得到相同的结果。\n\n原始数据为：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  0\\\\\n1  1\\\\\n1  2\\\\\n2  1\n\\end{pmatrix}\n,\\quad\nb \\;=\\;\n\\begin{pmatrix}\n1\\\\\n2\\\\\n2\\\\\n3\n\\end{pmatrix}.\n$$\n$A$ 的第三行是 $a_3^{\\mathsf{T}} = \\begin{pmatrix} 1  2 \\end{pmatrix}$，$b$ 的第三个元素是 $b_3 = 2$。\n降阶更新后的数据为：\n$$\nA' \\;=\\;\n\\begin{pmatrix}\n1  0\\\\\n1  1\\\\\n2  1\n\\end{pmatrix}\n,\\quad\nb' \\;=\\;\n\\begin{pmatrix}\n1\\\\\n2\\\\\n3\n\\end{pmatrix}.\n$$\nLS 问题 $\\min_{x} \\|Ax-b\\|_2$ 的解 $\\hat{x}$ 由正规方程 $A^{\\mathsf{T}} A x = A^{\\mathsf{T}} b$ 的解正式给出。类似地，降阶更新后的解 $\\hat{x}'$ 是 $A'^{\\mathsf{T}} A' x' = A'^{\\mathsf{T}} b'$ 的解。\n\n首先，我们建立原始正规方程与降阶更新后正规方程之间的关系。降阶更新后的正规矩阵 $A'^{\\mathsf{T}} A'$ 通过秩一更新与原始的 $A^{\\mathsf{T}} A$ 相关联：\n$$\nA'^{\\mathsf{T}} A' = A^{\\mathsf{T}} A - a_3 a_3^{\\mathsf{T}}.\n$$\n类似地，降阶更新后的右端向量为：\n$$\nA'^{\\mathsf{T}} b' = A^{\\mathsf{T}} b - a_3 b_3.\n$$\n\n我们现在将使用两种指定的方法求解 $\\hat{x}'$。\n\n**方法一：基于 QR 的降阶更新**\n\n此方法涉及对 $A$ 的 QR 分解的因子进行降阶更新。LS 解是通过求解三角系统 $Rx=c_1$ 得到的，其中 $A=QR$（$Q$ 具有标准正交列，$R$ 是上三角矩阵），$c_1$ 由 $Q^{\\mathsf{T}} b$ 的前 $n$ 个分量组成。正规方程可以写成 $R^{\\mathsf{T}} R x = R^{\\mathsf{T}} c_1$。\n\n降阶更新过程将因子 $R$ 和 $c_1$ 更新为新问题的 $R'$ 和 $c_1'$。新因子满足：\n$$\nR'^{\\mathsf{T}} R' = A'^{\\mathsf{T}} A' = A^{\\mathsf{T}} A - a_3 a_3^{\\mathsf{T}} = R^{\\mathsf{T}} R - a_3 a_3^{\\mathsf{T}}\n$$\n$$\nR'^{\\mathsf{T}} c_1' = A'^{\\mathsf{T}} b' = A^{\\mathsf{T}} b - a_3 b_3 = R^{\\mathsf{T}} c_1 - a_3 b_3\n$$\n\n1.  首先，我们计算原始正规方程的组成部分，$A^{\\mathsf{T}} A$ 和 $A^{\\mathsf{T}} b$。\n    $$\n    A^{\\mathsf{T}} A = \\begin{pmatrix} 1  1  1  2 \\\\ 0  1  2  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\\\ 2  1 \\end{pmatrix} = \\begin{pmatrix} 1+1+1+4  0+1+2+2 \\\\ 0+1+2+2  0+1+4+1 \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix}.\n    $$\n    $$\n    A^{\\mathsf{T}} b = \\begin{pmatrix} 1  1  1  2 \\\\ 0  1  2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1+2+2+6 \\\\ 0+2+4+3 \\end{pmatrix} = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix}.\n    $$\n    所以，$R^{\\mathsf{T}} R = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix}$ 且 $R^{\\mathsf{T}} c_1 = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix}$。\n\n2.  接下来，我们计算降阶更新后的矩阵 $R'^{\\mathsf{T}} R'$ 和 $R'^{\\mathsf{T}} c_1'$。其中 $a_3 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 且 $b_3=2$：\n    $$\n    R'^{\\mathsf{T}} R' = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} \\begin{pmatrix} 1  2 \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix} - \\begin{pmatrix} 1  2 \\\\ 2  4 \\end{pmatrix} = \\begin{pmatrix} 6  3 \\\\ 3  2 \\end{pmatrix}.\n    $$\n    $$\n    R'^{\\mathsf{T}} c_1' = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} (2) = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix}.\n    $$\n\n3.  为了恢复上三角结构，我们使用 Cholesky 分解从 $R'^{\\mathsf{T}} R'$ 中找到新的因子 $R'$。令 $R' = \\begin{pmatrix} r'_{11}  r'_{12} \\\\ 0  r'_{22} \\end{pmatrix}$。\n    $r'_{11} = \\sqrt{6}$。\n    $r'_{11} r'_{12} = 3 \\implies r'_{12} = 3 / \\sqrt{6} = \\sqrt{3/2}$。\n    $(r'_{12})^2 + (r'_{22})^2 = 2 \\implies 3/2 + (r'_{22})^2 = 2 \\implies (r'_{22})^2 = 1/2 \\implies r'_{22} = 1/\\sqrt{2}$。\n    因此，$R' = \\begin{pmatrix} \\sqrt{6}  \\sqrt{3/2} \\\\ 0  1/\\sqrt{2} \\end{pmatrix}$。\n\n4.  我们通过求解下三角系统 $R'^{\\mathsf{T}} c_1' = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix}$ 来找到新的右端向量 $c_1'$。令 $c_1' = \\begin{pmatrix} c'_1 \\\\ c'_2 \\end{pmatrix}$。\n    $R'^{\\mathsf{T}} = \\begin{pmatrix} \\sqrt{6}  0 \\\\ \\sqrt{3/2}  1/\\sqrt{2} \\end{pmatrix}$。\n    $\\sqrt{6} c'_1 = 9 \\implies c'_1 = 9/\\sqrt{6}$。\n    $\\sqrt{3/2} c'_1 + (1/\\sqrt{2}) c'_2 = 5 \\implies \\sqrt{3/2} (9/\\sqrt{6}) + c'_2/\\sqrt{2} = 5$。\n    $9\\sqrt{3/12} + c'_2/\\sqrt{2} = 5 \\implies 9\\sqrt{1/4} + c'_2/\\sqrt{2} = 5 \\implies 9/2 + c'_2/\\sqrt{2} = 5$。\n    $c'_2/\\sqrt{2} = 1/2 \\implies c'_2 = \\sqrt{2}/2 = 1/\\sqrt{2}$。\n    因此，$c_1' = \\begin{pmatrix} 9/\\sqrt{6} \\\\ 1/\\sqrt{2} \\end{pmatrix}$。\n\n5.  最后，我们求解上三角系统 $R' \\hat{x}' = c_1'$ 以得到降阶更新后的解 $\\hat{x}' = \\begin{pmatrix} x'_1 \\\\ x'_2 \\end{pmatrix}$。\n    $$\n    \\begin{pmatrix} \\sqrt{6}  \\sqrt{3/2} \\\\ 0  1/\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} x'_1 \\\\ x'_2 \\end{pmatrix} = \\begin{pmatrix} 9/\\sqrt{6} \\\\ 1/\\sqrt{2} \\end{pmatrix}.\n    $$\n    由第二行：$(1/\\sqrt{2}) x'_2 = 1/\\sqrt{2} \\implies x'_2 = 1$。\n    由第一行：$\\sqrt{6} x'_1 + \\sqrt{3/2} x'_2 = 9/\\sqrt{6}$。\n    $\\sqrt{6} x'_1 + \\sqrt{3/2} (1) = 9/\\sqrt{6}$。\n    两边乘以 $\\sqrt{6}$：$6 x'_1 + \\sqrt{3/2}\\sqrt{6} = 9 \\implies 6 x'_1 + \\sqrt{9} = 9 \\implies 6 x'_1 + 3 = 9$。\n    $6 x'_1 = 6 \\implies x'_1 = 1$。\n    因此，解为 $\\hat{x}' = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n**方法二：基于 Cholesky 的秩一降阶更新**\n\n此方法直接对正规方程矩阵 $M=A^{\\mathsf{T}} A$ 和右端向量 $y=A^{\\mathsf{T}} b$ 进行降阶更新，然后求解得到的线性系统。\n\n1.  从原始正规方程矩阵 $M=A^{\\mathsf{T}} A$ 和向量 $y=A^{\\mathsf{T}} b$ 开始：\n    $$\n    M = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix}.\n    $$\n\n2.  使用 $a_3 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 和 $b_3=2$ 执行秩一降阶更新。\n    降阶更新后的矩阵为 $M' = M - a_3 a_3^{\\mathsf{T}}$：\n    $$\n    M' = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} \\begin{pmatrix} 1  2 \\end{pmatrix} = \\begin{pmatrix} 7  5 \\\\ 5  6 \\end{pmatrix} - \\begin{pmatrix} 1  2 \\\\ 2  4 \\end{pmatrix} = \\begin{pmatrix} 6  3 \\\\ 3  2 \\end{pmatrix}.\n    $$\n    降阶更新后的向量为 $y' = y - a_3 b_3$：\n    $$\n    y' = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} (2) = \\begin{pmatrix} 11 \\\\ 9 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix}.\n    $$\n\n3.  求解降阶更新后的正规方程 $M' \\hat{x}' = y'$：\n    $$\n    \\begin{pmatrix} 6  3 \\\\ 3  2 \\end{pmatrix} \\begin{pmatrix} x'_1 \\\\ x'_2 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 5 \\end{pmatrix}.\n    $$\n    这是一个由两个线性方程组成的方程组：\n    $6x'_1 + 3x'_2 = 9 \\implies 2x'_1 + x'_2 = 3$。\n    $3x'_1 + 2x'_2 = 5$。\n    由第一个方程可得，$x'_2 = 3 - 2x'_1$。\n    代入第二个方程：$3x'_1 + 2(3 - 2x'_1) = 5$。\n    $3x'_1 + 6 - 4x'_1 = 5 \\implies -x'_1 = -1 \\implies x'_1 = 1$。\n    代回：$x'_2 = 3 - 2(1) = 1$。\n    解为 $\\hat{x}' = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n**结论**\n\n基于 QR 的降阶更新方法和基于 Cholesky 的降阶更新方法都为降阶更新后的最小二乘问题生成了相同的解：$\\hat{x}' = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。这证实了两种推导的正确性。最终答案按要求表示为行向量。",
                "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1\n\\end{pmatrix}\n}\n$$",
                "id": "3600432"
            },
            {
                "introduction": "在数值算法中，效率并非唯一考量，稳定性至关重要。本练习通过 $LDL^{\\mathsf{T}}$ 分解提供了一个警示性的例子。您将研究一个看似无害的降级操作，当使用一个未能重新考虑其主元选择的朴素算法来处理时，会导致灾难性的元素增长和数值不稳定性[@problem_id:3600385]。这个思想实验对于理解为何稳健的生产级算法需要包含复杂的选主元策略以避免此类陷阱至关重要。",
                "problem": "考虑一个对称矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 的下三角–对角–下三角转置 ($LDL^{\\mathsf{T}}$) 分解，其中 $L$ 为单位下三角矩阵，$D$ 为对角矩阵。已知 $A$ 是单位矩阵，即 $A = I_{3}$，$L = I_{3}$，$D = I_{3}$。定义对称秩-1降阶更新\n$$\nA_{-} = A - u u^{\\mathsf{T}}\n$$\n其中 $u = \\begin{pmatrix} 1 - \\delta \\\\ 1 \\\\ 0 \\end{pmatrix}$ 且 $\\delta = 10^{-8}$。一个不重新考虑主元选择的朴素 $LDL^{\\mathsf{T}}$ 降阶更新方法是，强制第一个主元保持为索引1处的 $1 \\times 1$ 主元，并直接在 $A_{-}$ 上执行第一步对称消去，而不改变主元顺序或切换到 $2 \\times 2$ 主元。在此步骤中，令 $\\tilde{d}_{1}$ 表示更新后的第一个对角主元，$\\tilde{L}_{21}$ 表示更新后的第一列次对角线乘子。\n\n仅从 $LDL^{\\mathsf{T}}$ 分解的定义、恒等式 $A = L D L^{\\mathsf{T}}$ 以及降阶更新的定义 $A_{-} = A - u u^{\\mathsf{T}}$ 出发，推导出这个朴素的第一步所产生的 $\\tilde{L}_{21}$ 的显式表达式，并根据上述数据计算其幅值。您的答案必须是 $\\left|\\tilde{L}_{21}\\right|$ 的数值。将您的答案四舍五入到四位有效数字。\n\n简要论证为什么这是一个反例，证明了不重新选择主元的朴素 $LDL^{\\mathsf{T}}$ 降阶更新可能导致巨大的元素增长或算法崩溃，并根据更新后的主元和乘子解释其机理。除了所述定义之外，不得使用任何额外的假设或外部公式。",
                "solution": "该问题是有效的，因为它提出了一个适定的、具有科学依据的数值线性代数问题。所有必要信息都已提供，任务是执行一个特定的计算，并基于矩阵分解的基本原理提供论证。\n\n首先，我们构造降阶更新后的矩阵 $A_{-} = A - u u^{\\mathsf{T}}$。给定 $A = I_{3}$（$3 \\times 3$ 单位矩阵）和 $u = \\begin{pmatrix} 1 - \\delta \\\\ 1 \\\\ 0 \\end{pmatrix}$，我们首先计算外积 $u u^{\\mathsf{T}}$：\n$$\nu u^{\\mathsf{T}} = \\begin{pmatrix} 1 - \\delta \\\\ 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 - \\delta  1  0 \\end{pmatrix} = \\begin{pmatrix} (1-\\delta)^{2}  1-\\delta  0 \\\\ 1-\\delta  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n那么降阶更新后的矩阵 $A_{-}$ 是：\n$$\nA_{-} = I_{3} - u u^{\\mathsf{T}} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} (1-\\delta)^{2}  1-\\delta  0 \\\\ 1-\\delta  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n$$\nA_{-} = \\begin{pmatrix} 1 - (1-\\delta)^{2}  -(1-\\delta)  0 \\\\ -(1-\\delta)  1-1  0 \\\\ 0  0  1-0 \\end{pmatrix}\n$$\n我们来简化元素 $A_{-}(1,1)$：\n$$\nA_{-}(1,1) = 1 - (1 - 2\\delta + \\delta^{2}) = 2\\delta - \\delta^{2} = \\delta(2-\\delta)\n$$\n因此，降阶更新后的矩阵是：\n$$\nA_{-} = \\begin{pmatrix} \\delta(2-\\delta)  -(1-\\delta)  0 \\\\ -(1-\\delta)  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n问题描述了一个不进行重新选择主元的朴素 $LDL^{\\mathsf{T}}$ 分解步骤，即强制使用 $(1,1)$ 元素作为主元。$LDL^{\\mathsf{T}}$ 分解是一种对称高斯消去法的形式。第一步中，主元为 $\\tilde{d}_{1} = A_{-}(1,1)$。为消去第一列次对角线元素所需的乘子存储在单位下三角矩阵 $\\tilde{L}$ 的第一列中。\n乘子 $\\tilde{L}_{21}$ 定义为将 $A_{-}$ 的第1行乘以该因子，然后从第2行中减去，从而在 $(2,1)$ 位置上产生零。它由待消去元素与主元元素之比给出：\n$$\n\\tilde{L}_{21} = \\frac{A_{-}(2,1)}{A_{-}(1,1)}\n$$\n代入 $A_{-}$ 的元素表达式：\n$$\n\\tilde{L}_{21} = \\frac{-(1-\\delta)}{\\delta(2-\\delta)}\n$$\n题目要求我们计算当 $\\delta = 10^{-8}$ 时 $|\\tilde{L}_{21}|$ 的幅值。\n$$\n\\left|\\tilde{L}_{21}\\right| = \\left| \\frac{-(1-\\delta)}{\\delta(2-\\delta)} \\right| = \\frac{1-\\delta}{\\delta(2-\\delta)}\n$$\n代入 $\\delta = 10^{-8}$：\n$$\n\\left|\\tilde{L}_{21}\\right| = \\frac{1 - 10^{-8}}{10^{-8}(2 - 10^{-8})} = \\frac{0.99999999}{10^{-8}(1.99999998)} = \\frac{0.99999999}{1.99999998 \\times 10^{-8}}\n$$\n进行除法运算：\n$$\n\\left|\\tilde{L}_{21}\\right| = 0.5000000025 \\times 10^{8} = 50000000.25\n$$\n将此结果四舍五入到四位有效数字，得到 $5.000 \\times 10^{7}$。\n\n该结果可作为一个反例，证明朴素降阶更新过程的不稳定性，原因如下：\n原始分解 $A = I_{3} = I_{3} I_{3} I_{3}^{\\mathsf{T}}$ 由良态矩阵构成，其元素幅值为 $1$ 或 $0$。使用向量 $u$ 进行的秩-1修改看似无害。然而，它将矩阵 $A$ 转换为 $A_{-}$，后者具有截然不同的结构。\n当 $\\delta = 10^{-8}$ 时，主元元素 $\\tilde{d}_{1} = A_{-}(1,1) = 2\\delta - \\delta^{2}$ 约等于 $2 \\times 10^{-8}$，非常接近于零。非对角元素 $A_{-}(2,1) = -(1-\\delta)$ 的幅值接近 $1$。\n不稳定的机理在于，用一个大小适中的非对角元素（$A_{-}(2,1) \\approx -1$）除以一个非常小的主元元素（$\\tilde{d}_{1} \\approx 2 \\times 10^{-8}$）。这导致了一个极大的乘子，即 $|\\tilde{L}_{21}| \\approx 0.5 \\times 10^{8}$。这种现象被称为元素增长。因子矩阵中的大元素是数值不稳定的主要指标，因为它们会放大后续计算中的舍入误差。一个稳健的对称不定分解算法，例如使用 Bunch-Kaufman 主元选择法的算法，会检查矩阵 $A_{-}$ 并识别出 $1 \\times 1$ 主元 $A_{-}(1,1)$ 相对于非对角元素而言太小。然后它会选择一个更稳定的主元，例如使用前导 $2 \\times 2$ 子矩阵 $\\begin{pmatrix} A_{-}(1,1)  A_{-}(1,2) \\\\ A_{-}(2,1)  A_{-}(2,2) \\end{pmatrix}$ 构成的 $2 \\times 2$ 块主元，从而避免除以一个小数以及随之而来的元素增长。朴素方法之所以失败，是因为它没有重新审视主元的选择，而这个选择在降阶更新后变得很差。",
                "answer": "$$\\boxed{5.000 \\times 10^{7}}$$",
                "id": "3600385"
            }
        ]
    }