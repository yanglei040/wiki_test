{
        "hands_on_practices": [
            {
                "introduction": "在深入研究舍入误差之前，我们必须首先理解我们进行计算的数字系统本身。这个练习将指导您描绘一个假设的浮点系统的边界，计算其可表示的最小和最大正规数，以及最小的次正规数。通过这个实践 [@problem_id:3575435]，您将为浮点表示和渐进下溢的关键作用建立一个具体的概念模型。",
                "problem": "考虑一个浮点系统，表示为 $F(\\beta,p,e_{\\min},e_{\\max})$，其中一个规格化浮点数的形式为 $\\pm \\beta^{e}\\left(d_{0} + d_{1}\\beta^{-1} + d_{2}\\beta^{-2} + \\cdots + d_{p-1}\\beta^{-(p-1)}\\right)$，其中 $1 \\leq d_{0} \\leq \\beta - 1$，对于 $i \\geq 1$ 有 $0 \\leq d_{i} \\leq \\beta - 1$，并且 $e_{\\min} \\leq e \\leq e_{\\max}$。当支持渐进下溢时，非规格化数被定义为具有固定指数 $e=e_{\\min}$ 且允许 $d_{0}=0$，因此其尾数可以小至 $d_{p-1}\\beta^{-(p-1)}$（其中 $d_{p-1} \\geq 1$）。\n\n假设舍入模式为“四舍五入到最近，偶数优先”，这是由电气和电子工程师协会（IEEE）的浮点算术标准（IEEE 754）所规定的。设 $\\beta=4$, $p=3$, $e_{\\min}=-6$, 且 $e_{\\max}=5$。\n\n仅使用上述定义和浮点表示的公认属性，计算：\n- $F(4,3,-6,5)$ 中最小的正规格化可表示数，\n- $F(4,3,-6,5)$ 中最大的正规格化可表示数，\n- 允许渐进下溢时的最小正非规格化数。\n\n然后，通过量化非规格化数的间距及其在指定舍入模式下与下溢边界处规格化范围的连续性，解释这些值如何展示渐进下溢的概念。\n\n以精确形式将这三个量表示为一个行向量。不需要舍入。",
                "solution": "该问题定义明确，并且科学地基于 IEEE 754 标准所定义的浮点算术原理。浮点系统 $F(\\beta, p, e_{\\min}, e_{\\max})$ 的所有必要参数均已提供。规格化数和非规格化数的定义是标准且明确的。因此，可以推导出有效的解。\n\n指定的浮点系统是 $F(\\beta, p, e_{\\min}, e_{\\max})$，其基数 $\\beta=4$，精度 $p=3$，最小指数 $e_{\\min}=-6$，最大指数 $e_{\\max}=5$。\n\n在该系统中，一个正规格化浮点数 $x$ 的形式为：\n$$x = \\left(d_{0} + d_{1}\\beta^{-1} + d_{2}\\beta^{-2}\\right) \\times \\beta^{e} = (d_{0}.d_{1}d_{2})_{\\beta} \\times \\beta^{e}$$\n其中数字 $d_i$ 满足 $1 \\leq d_{0} \\leq 3$ 和 $0 \\leq d_{1}, d_{2} \\leq 3$，指数 $e$ 的范围是 $-6 \\leq e \\leq 5$。\n\n一个正非规格化浮点数 $x_{sub}$（支持渐进下溢）的形式为：\n$$x_{sub} = \\left(0 + d_{1}\\beta^{-1} + d_{2}\\beta^{-2}\\right) \\times \\beta^{e_{\\min}} = (0.d_{1}d_{2})_{\\beta} \\times \\beta^{-6}$$\n其中数字 $d_1$ 或 $d_2$ 中至少有一个必须为非零。\n\n我们现在计算所需的量。\n\n**1. 最小的正规格化可表示数**\n为了找到最小的正规格化数，我们必须选择最小可能的尾数和最小可能的指数。\n最小指数是 $e = e_{\\min} = -6$。\n对于一个规格化数，首位数字 $d_0$ 必须至少为 $1$。为了最小化尾数，我们选择最小可能的数字：$d_{0} = 1$, $d_{1} = 0$, 和 $d_{2} = 0$。\n最小的规格化尾数是 $(1.00)_{4} = 1 + 0 \\cdot 4^{-1} + 0 \\cdot 4^{-2} = 1$。\n因此，最小的正规格化数，记为 $x_{\\min\\_norm}$，是：\n$$x_{\\min\\_norm} = 1 \\times 4^{e_{\\min}} = 1 \\times 4^{-6} = 4^{-6}$$\n\n**2. 最大的正规格化可表示数**\n为了找到最大的正规格化数，我们必须选择最大可能的尾数和最大可能的指数。\n最大指数是 $e = e_{\\max} = 5$。\n为了最大化尾数，我们选择最大可能的数字，即 $\\beta-1=3$。因此，$d_0=3$, $d_1=3$, 和 $d_2=3$。\n最大的规格化尾数是 $(3.33)_{4} = 3 + 3 \\cdot 4^{-1} + 3 \\cdot 4^{-2}$。\n这可以计算为：\n$$M_{\\max\\_norm} = 3 + \\frac{3}{4} + \\frac{3}{16} = \\frac{48 + 12 + 3}{16} = \\frac{63}{16}$$\n或者，这个尾数是在基点移动前，具有 $p=3$ 位数字的系统中最大的数，即 $4 - 4^{-(p-1)} = 4 - 4^{-2}$。\n$$M_{\\max\\_norm} = 4 - \\frac{1}{16} = \\frac{63}{16}$$\n因此，最大的正规格化数，记为 $x_{\\max\\_norm}$，是：\n$$x_{\\max\\_norm} = \\left(4 - 4^{-2}\\right) \\times 4^{e_{\\max}} = \\left(4 - 4^{-2}\\right) \\times 4^{5} = 4^{6} - 4^{3}$$\n$$x_{\\max\\_norm} = 4096 - 64 = 4032$$\n\n**3. 最小的正非规格化数**\n对于非规格化数，指数固定为 $e = e_{\\min} = -6$，且首位数字为 $d_0 = 0$。该数的形式为 $(0.d_{1}d_{2})_{4} \\times 4^{-6}$。\n为了找到最小的正值，我们必须找到最小的非零尾数。这发生在当我们为数字选择最小可能的非零值时。我们设置 $d_1=0$ 和最后一位数字 $d_2=1$。\n最小的非规格化尾数是 $(0.01)_{4} = 0 + 0 \\cdot 4^{-1} + 1 \\cdot 4^{-2} = 4^{-2}$。\n因此，最小的正非规格化数，记为 $x_{\\min\\_sub}$，是：\n$$x_{\\min\\_sub} = 4^{-2} \\times 4^{e_{\\min}} = 4^{-2} \\times 4^{-6} = 4^{-8}$$\n\n**渐进下溢的解释**\n渐进下溢是一种机制，当结果的绝对值小于最小规格化数时，它允许精度平滑地损失。上面计算出的值通过检查下溢边界附近可表示数的间距，完美地说明了这一概念。\n\n浮点数间距的基本单位是“末位单位”（ULP）。对于一个指数为 $e$ 的数，其 ULP 是 $\\beta^{e-(p-1)}$。在我们的系统 $F(4,3,-6,5)$ 中，ULP 是 $4^{e-2}$。\n\n让我们考虑下溢阈值附近规格化数的间距。最小规格化数是 $x_{\\min\\_norm} = (1.00)_4 \\times 4^{-6} = 4^{-6}$。其指数为 $e=-6$。\n该指数对应的 ULP 是 $4^{-6-2} = 4^{-8}$。\n下一个可表示的规格化数是 $(1.01)_4 \\times 4^{-6} = (1 + 4^{-2}) \\times 4^{-6} = 4^{-6} + 4^{-8}$。\n前两个规格化数之间的绝对间隙是 $(4^{-6} + 4^{-8}) - 4^{-6} = 4^{-8}$。\n\n现在，我们来研究非规格化数。它们的形式是 $(0.d_1 d_2)_4 \\times 4^{-6}$。这可以改写为：\n$$(d_1 \\cdot 4^{-1} + d_2 \\cdot 4^{-2}) \\times 4^{-6} = (4d_1 + d_2) \\cdot 4^{-2} \\cdot 4^{-6} = (4d_1 + d_2) \\cdot 4^{-8}$$\n因为 $d_1, d_2 \\in \\{0, 1, 2, 3\\}$，整数值 $4d_1 + d_2$ 的范围可以从 $1$（当 $d_1=0, d_2=1$ 时）到 $15$（当 $d_1=3, d_2=3$ 时）。\n这意味着正非规格化数恰好是 $4^{-8}$ 的整数倍：\n$$1 \\cdot 4^{-8}, 2 \\cdot 4^{-8}, 3 \\cdot 4^{-8}, \\dots, 15 \\cdot 4^{-8}$$\n其中最小的是 $x_{\\min\\_sub} = 1 \\cdot 4^{-8} = 4^{-8}$。任意两个连续非规格化数之间的间距是均匀的 $4^{-8}$。\n\n下溢的“渐进”性质体现在非规格化数和规格化数边界处间距的无缝过渡。\n最大的非规格化数是 $(0.33)_4 \\times 4^{-6} = (4 \\cdot 3 + 3) \\cdot 4^{-8} = 15 \\cdot 4^{-8}$。\n最小的规格化数是 $(1.00)_4 \\times 4^{-6} = 1 \\cdot 4^{-6} = 16 \\cdot 4^{-8}$。\n最大的非规格化数和最小的规格化数之间的间隙是 $(16 \\cdot 4^{-8}) - (15 \\cdot 4^{-8}) = 4^{-8}$。\n\n这个间距 $4^{-8}$，与连续非规格化数之间的间距相同，也与前几个规格化数之间的间距相同。如果没有渐进下溢，任何小于 $x_{\\min\\_norm} = 4^{-6}$ 的结果都将被刷新为 $0$，从而在 $0$ 和第一个可表示数之间造成一个巨大的间隙。渐进下溢通过非规格化数填补了这个间隙，这些非规格化数保持了与邻近规格化数相同的绝对间距，确保了相邻可表示数之间的距离平滑地减小直至为零。这避免了即使 `x` 和 `y` 不相等，`x - y` 也可能为 $0$ 的不良性质，因为它确保了如果 $x-y$ 落在该范围内，它可以表示为一个非规格化数。",
                "answer": "$$\\boxed{\\begin{pmatrix} 4^{-6} & 4032 & 4^{-8} \\end{pmatrix}}$$",
                "id": "3575435"
            },
            {
                "introduction": "在定义了数字系统之后，让我们来探究算术运算的行为。本练习聚焦于减法，一个看似简单却充满数值陷阱的运算。您将推导出一个著名的结果（Sterbenz引理），它为减法何时是精确的提供了一个条件 [@problem_id:3575443]，这是编写无误差数值代码的基石。",
                "problem": "考虑电气和电子工程师协会 (IEEE) 754标准的binary64浮点数算术，其基数 $\\beta = 2$，精度 $p = 53$（包括隐含的前导位），舍入方式为舍入到最近，偶数优先。在推理可表示性时，仅使用规格化浮点数和精确实数算术。使用以下基本事实作为出发点：在基数为2的规格化浮点表示中，任何非零数 $x$ 都可以唯一地写成 $x = m \\cdot 2^{E}$ 的形式，其中整数 $m$ 满足 $2^{p-1} \\leq m  2^{p}$；并且对于任意固定的指数 $E$，在 binade（同指数幂区间） $[2^{E}, 2^{E+1})$ 内，连续可表示数之间的距离等于 $2^{E-(p-1)}$。定义 $x$ 处的末位单位 (ULP) 为在 $x$ 的尺度下到下一个更大的可表示数之间的距离。\n1) 基于这些原则，且不引用任何定理，推导出一个尖锐的乘法阈值 $T \\geq 1$，该阈值具有以下性质：对于任意两个规格化浮点数 $x$ 和 $y$，$y \\neq 0$ 且满足\n$$\nT^{-1} \\leq \\frac{x}{y} \\leq T,\n$$\n精确的实数差 $x - y$ 本身就是该系统中的一个规格化浮点数（因此在任何舍入模式下减法都是精确的）。您的推导应确定必要的指数对齐，描述对齐前后的整数有效数，并证明在此范围内不需要舍入。\n2) 给出具体的双精度 (binary64) 示例，说明在舍入到最近，偶数优先的模式下，精确和不精确减法两种结果，并从第一性原理（ULP 和 binade 结构）解释每个结果：\n- 示例 A（可能精确）：取 $x_{A} = 1 + 2^{-52}$ 和 $y_{A} = 1$。\n- 示例 B（可能不精确）：取 $x_{B} = 1$ 和 $y_{B} = 2^{-53}$。\n- 示例 C（可能精确）：取 $x_{C} = \\frac{11}{8}$ 和 $y_{C} = \\frac{3}{4}$。\n对于每个示例，计算精确的实数差和在给定舍入模式下的浮点结果 $\\mathrm{fl}(x - y)$，并说明减法是精确的还是不精确的，通过分析 ULP 尺度的间距和相对于您推导的阈值的比率条件来证明您的论断。\n仅报告阈值 $T$ 的精确值作为最终答案。不需要舍入。",
                "solution": "问题分为两部分。第一部分要求推导精确浮点减法的尖锐乘法阈值 $T$。第二部分要求分析三个具体示例。\n\n第一部分：阈值 $T$ 的推导\n\n设 $x$ 和 $y$ 是指定系统中的两个规格化浮点数，基数 $\\beta=2$，精度 $p=53$。根据问题陈述，任何此类非零数 $z$ 都可以唯一地写成 $z = m \\cdot 2^E$ 的形式，其中 $m$ 是一个满足 $2^{p-1} \\leq m  2^p$ 的整数，$E$ 是一个整数指数。通过设置 $f=m/2^{p-1}$ 和 $e=E+p-1$，这种表示可以映射到更标准的形式 $z = f \\cdot 2^e$，其中 $1 \\le f  2$ 是有效数，$e$ 是指数。任何此类数的有效数 $f$ 都是形式为 $M/2^{p-1}$ 的有理数，其中 $M$ 是 $[2^{p-1}, 2^p)$ 区间内的某个整数。\n\n我们寻求一个尖锐的阈值 $T \\geq 1$，使得如果 $T^{-1} \\leq x/y \\leq T$，差值 $x-y$ 是一个可精确表示的规格化浮点数。减法精确意味着存储结果不需要舍入。\n\n不失一般性，我们假设 $x \\geq y > 0$。该条件简化为 $1 \\leq x/y \\leq T$。$y > x > 0$ 的情况是对称的：如果 $y-x$ 是精确的，那么 $x-y = -(y-x)$ 也是精确的。\n\n设 $x$ 和 $y$ 的表示为：\n$x = m_x \\cdot 2^{E_x}$\n$y = m_y \\cdot 2^{E_y}$\n其中 $m_x$ 和 $m_y$ 是 $p$ 位整数，满足 $2^{p-1} \\leq m_x, m_y  2^p$。\n\n精确差值为 $x-y = m_x \\cdot 2^{E_x} - m_y \\cdot 2^{E_y}$。为了执行减法，必须对齐指数。设 $k = E_x - E_y$。因为 $x \\geq y$，我们有 $x = m_x 2^{E_x} \\ge y = m_y 2^{E_y}$。比率 $x/y = (m_x/m_y) 2^k$。鉴于 $2^{p-1} \\le m_x, m_y  2^p$，我们有 $1/2  m_x/m_y  2$。因此，$2^{k-1}  x/y  2^{k+1}$。因为 $x/y \\ge 1$，必须有 $k+1 > \\log_2(1) = 0$，所以 $k > -1$，这意味着 $k \\ge 0$。\n\n差值可以用一个公共指数 $E_y$ 写成：\n$$x-y = (m_x \\cdot 2^{E_x - E_y} - m_y) \\cdot 2^{E_y} = (m_x 2^k - m_y) \\cdot 2^{E_y}$$\n设 $D = m_x 2^k - m_y$。$D$ 是一个整数。如果差值 $x-y$ 可以写成 $m_d \\cdot 2^{E_d}$ 的形式，其中 $m_d, E_d$ 是整数且 $2^{p-1} \\leq m_d  2^p$，那么它就是精确可表示的。这当且仅当整数 $D$ 可以表示为 $m_d \\cdot 2^s$ 的形式，其中 $s$ 是某个整数，而 $m_d$ 是一个其二进制表示最多需要 $p$ 位且在移位后能落入规格化范围内的整数。更正式地说，设 $D = \\tilde{D} \\cdot 2^s$，其中 $\\tilde{D}$ 是一个奇数。如果 $\\tilde{D}$ 可以存储在 $p$ 位的有效数中，即要求 $\\tilde{D}  2^p$，那么结果就是精确可表示的。\n\n比率的条件是 $1 \\leq x/y \\leq T$。我们将检验尖锐阈值为 $T=2$ 的假设。所以，我们分析条件 $1 \\leq x/y \\leq 2$。\n从 $2^{k-1}  x/y \\le 2$，我们必须有 $k-1  \\log_2(2) = 1$，这意味着 $k2$。如前所述，$k \\ge 0$。所以，$k$ 只能是 $0$ 或 $1$。\n\n情况 1：$k=0$ ($E_x = E_y$)。\n条件 $1 \\leq x/y \\leq 2$ 变为 $1 \\leq m_x/m_y  2$。因为 $m_x, m_y \\ge 2^{p-1}$，当 $x \\ge y$ 且 $k=0$ 时，这个条件总是满足的。\n整数差为 $D = m_x - m_y$。因为 $x \\ge y$，我们有 $D \\ge 0$。\n整数有效数有界：$2^{p-1} \\leq m_y \\leq m_x  2^p$。\n因此，$D = m_x - m_y  2^p - 2^{p-1} = 2^{p-1}$。\n$D$ 的奇数部分 $\\tilde{D}$ 必须小于或等于 $D$，所以 $\\tilde{D}  2^{p-1}$。这严格小于 $2^p$。因此，$D$ 可以被规格化为一个 $p$ 位的有效数，减法总是精确的。\n\n情况 2：$k=1$ ($E_x = E_y+1$)。\n条件 $1 \\leq x/y \\leq 2$ 变为 $1 \\leq (m_x/m_y) \\cdot 2 \\leq 2$，这意味着 $1/2 \\leq m_x/m_y \\leq 1$。\n整数差为 $D = m_x 2^1 - m_y$。从 $m_x/m_y \\leq 1$，我们有 $m_x \\leq m_y$。\n那么 $D = 2m_x - m_y \\leq 2m_x - m_x = m_x$。\n因为 $m_x  2^p$，我们有 $D  2^p$。\n$D$ 的奇数部分 $\\tilde{D}$ 必须小于或等于 $D$，所以 $\\tilde{D}  2^p$。这个条件保证了结果是精确可表示的。\n\n综合以上情况，如果 $1 \\le x/y \\le 2$，减法 $x-y$ 是精确的。\n如果我们考虑 $y > x > 0$，条件 $T^{-1} \\le x/y  T$ 变为 $1/2 \\le x/y  1$。设 $x' = y$ 和 $y'=x$。那么 $1  x'/y' \\le 2$。根据以上分析，$x'-y' = y-x$ 是精确的。因此，$x-y=-(y-x)$ 也是精确的。\n因此，对于任意两个规格化浮点数 $x,y$，如果 $1/2 \\leq x/y \\leq 2$，差值 $x-y$ 是精确的。这表明 $T=2$ 是一个有效的阈值。\n\n为了证明 $T=2$ 是最尖锐的阈值，我们必须证明对于任何 $T > 2$，都存在 $x, y$ 使得 $2  x/y \\le T$ 且 $x-y$ 不是精确可表示的。\n考虑一个略大于 $2$ 的比率。设 $k = E_x - E_y = 2$。那么 $x/y = (m_x/m_y) \\cdot 4$。要使这个值略大于 $2$，我们需要 $m_x/m_y$ 略大于 $1/2$。\n我们选择 $m_x = 2^{p-1}$（最小的 $p$ 位规格化整数有效数）和 $m_y = 2^p-1$（最大的）。\n当 $p=53$ 时：\n$x = 2^{52} \\cdot 2^{E_x}$\n$y = (2^{53}-1) \\cdot 2^{E_y}$\n设 $E_x = E_y+2$，所以 $k=2$。\n比率为 $x/y = \\frac{2^{52}}{2^{53}-1} \\cdot 2^2 = \\frac{2^{54}}{2^{53}-1} = \\frac{2(2^{53}-1)+2}{2^{53}-1} = 2 + \\frac{2}{2^{53}-1}$。这个比率略大于 $2$。\n我们计算差值的整数形式：\n$D = m_x 2^k - m_y = 2^{52} \\cdot 2^2 - (2^{53}-1) = 2^{54} - 2^{53} + 1 = 2 \\cdot 2^{53} - 2^{53} + 1 = 2^{53}+1$。\n整数结果为 $D=2^{53}+1$。在二进制中，这是一个 $1$ 后面跟着 $52$ 个零，然后是一个 $1$。它需要 $p+1=54$ 位来表示。奇数部分是 $\\tilde{D}=D=2^{53}+1$。\n由于 $\\tilde{D} > 2^{53}$，它不能用一个 $p=53$ 位的有效数来表示。结果 $x-y=D \\cdot 2^{E_y}=(2^{53}+1) \\cdot 2^{E_y}$ 不是精确可表示的。它必须被舍入。\n这表明对于任何比率 $x/y > 2$，都不能保证精确减法。因此，阈值 $T=2$ 是尖锐的。\n\n第二部分：示例分析\n\n我们使用 $p=53$ 进行 binary64 计算。\n\n示例 A：$x_{A} = 1 + 2^{-52}$, $y_{A} = 1$。\n$x_A$ 和 $y_A$ 是在 binade $[1, 2)$ 内的连续规格化浮点数。这个 binade 内的末位单位 (ULP) 是 $2^{0-(p-1)} = 2^{-52}$。\n$x_A = (1+2^{-52}) \\cdot 2^0$。其有效数为 $1+2^{-52}$，指数为 $0$。这是一个有效的 binary64 数。\n$y_A = 1 = 1.0 \\cdot 2^0$。也是一个有效的 binary64 数。\n比率为 $x_A/y_A = 1+2^{-52}$。这在区间 $[1/2, 2]$ 内。我们推导的定理预测减法是精确的。\n精确的实数差为 $x_A - y_A = (1+2^{-52}) - 1 = 2^{-52}$。\n数字 $2^{-52}$ 可以写成 $1.0 \\cdot 2^{-52}$，这是一个规格化的 binary64 数（有效数为 $1.0$，指数为 $-52$）。\n结果 $\\mathrm{fl}(x_A - y_A)$ 精确地为 $2^{-52}$。减法是**精确的**。\n\n示例 B：$x_{B} = 1$, $y_{B} = 2^{-53}$。\n$x_B = 1 = 1.0 \\cdot 2^0$。规格化数。\n$y_B = 2^{-53} = 1.0 \\cdot 2^{-53}$。规格化数。\n比率为 $x_B/y_B = 1 / 2^{-53} = 2^{53}$。这远大于阈值 $T=2$。该定理不保证精确减法。\n精确的实数差为 $x_B - y_B = 1 - 2^{-53}$。\n我们检查这是否是一个可精确表示的 binary64 数。\n$1 - 2^{-53} = (2-2^{-52}) \\cdot 2^{-1}$。\n有效数将是 $f_d = 2-2^{-52} = 1 + (1-2^{-52}) = 1 + \\sum_{i=1}^{52} 2^{-i}$。这对应于二进制表示 $1.11...1$，小数点后有52个1。这是一个有效的 $p=53$ 位有效数。指数是 $e_d = -1$，这是一个有效的指数。\n因此，$1-2^{-53}$ 是一个可精确表示的 binary64 数。事实上，它是严格小于1的最大可表示数。\n由于精确结果是一个可表示的数，因此不需要舍入。计算出的浮点结果是 $\\mathrm{fl}(x_B - y_B) = 1-2^{-53}$。减法是**精确的**。这表明 Sterbenz 条件 ($T^{-1} \\le x/y \\le T$) 是精确减法的充分条件，但不是必要条件。\n\n示例 C：$x_{C} = \\frac{11}{8}$, $y_{C} = \\frac{3}{4}$。\n$x_C = \\frac{11}{8} = 1.375 = (1.011)_2 = 1.375 \\cdot 2^0$。这是一个规格化的 binary64 数。\n$y_C = \\frac{3}{4} = 0.75 = (0.11)_2 = 1.5 \\cdot 2^{-1}$。这是一个规格化的 binary64 数。\n比率为 $x_C/y_C = (\\frac{11}{8}) / (\\frac{3}{4}) = \\frac{11}{8} \\cdot \\frac{4}{3} = \\frac{11}{6} \\approx 1.833$。\n这个比率在区间 $[1, 2]$ 内，所以它满足条件 $1/2 \\leq x_C/y_C \\leq 2$。该定理预测减法是精确的。\n精确的实数差为 $x_C - y_C = \\frac{11}{8} - \\frac{6}{8} = \\frac{5}{8}$。\n数字 $\\frac{5}{8} = 0.625 = (0.101)_2 = 1.25 \\cdot 2^{-1}$。有效数 $1.25$ 和指数 $-1$ 构成一个有效的规格化 binary64 数。\n结果 $\\mathrm{fl}(x_C - y_C)$ 精确地为 $\\frac{5}{8}$。减法是**精确的**。\n这一点也可以通过注意到两个操作数和结果都是一个公共的更小值 $\\frac{1}{8}$ 的整数倍来观察到，而 $\\frac{1}{8}$ 本身就是一个浮点数。\n$x_C=11 \\cdot (\\frac{1}{8})$, $y_C=6 \\cdot (\\frac{1}{8})$, 所以 $x_C-y_C=5 \\cdot (\\frac{1}{8}) = \\frac{5}{8}$。\n\n最终答案仅要求阈值 $T$ 的值。",
                "answer": "$$\n\\boxed{2}\n$$",
                "id": "3575443"
            },
            {
                "introduction": "现在，我们进入精度的极限区域。本练习将探讨当一次计算（如乘法）产生的结果太小而无法表示为正规数时会发生什么。您将追踪一个结果被舍入到次正规数范围内的完整过程，并在一个关键的平局情况中应用“舍入到最近，平局取偶”的规则 [@problem_id:3575479]。",
                "problem": "在电气和电子工程师协会（IEEE）754标准的binary64（双精度）格式中，基数为 $2$，尾数的精度为 $t=53$ 位（包括规格化数的隐含前导位），且规格化数的无偏指数范围为 $e \\in \\{-1022, -1021, \\dots, 1023\\}$。非规格化数是量值严格小于 $2^{-1022}$ 的数，其表示方式为尾数带有隐含的前导 $0$ 和固定的指数 $e_{\\min}=-1022$。舍入模式为向最近舍入，偶数优先。\n\n考虑两个可精确表示的双精度数\n$x = 1.5 \\times 2^{-500}$ 和 $y = 2^{-574}$。\n假设浮点乘法是先进行精确的实数乘法，然后根据给定的舍入模式进行单次舍入，得到一个可表示的双精度数，并允许非规格化数。\n\n仅从 IEEE 754 binary64 格式的基本定义出发（包括规格化和非规格化表示法，以及向最近舍入、偶数优先的规则），确定当 $x$ 和 $y$ 相乘时的精确舍入积 $\\operatorname{fl}(x\\,y)$，并评估相对于精确实数积 $x\\,y$ 的舍入误差。\n\n请给出最终答案，即绝对舍入误差 $|\\operatorname{fl}(x\\,y)-x\\,y|$，并将其精确地表示为 $2$ 的单个幂。最终答案不需要舍入。不要包含单位。如果选择以数值形式表示任何中间量，可以这样做，但最终报告的量必须是所要求的精确的 $2$ 的幂。",
                "solution": "该问题要求计算两个双精度浮点数 $x = 1.5 \\times 2^{-500}$ 和 $y = 2^{-574}$，在 IEEE 754 binary64 格式和向最近舍入、偶数优先的舍入规则下相乘所产生的绝对舍入误差。\n\n首先，我们确认输入数 $x$ 和 $y$ 本身在指定格式下是可精确表示的。\n一个规格化的 binary64 数的一般形式是 $(-1)^s \\times (1.f)_2 \\times 2^e$，其中 $s$ 是符号位，$(1.f)_2$ 是尾数，总精度为 $t=53$ 位（1 个隐含位，52 个小数位），无偏指数 $e$ 的范围是 $[-1022, 1023]$。\n数 $x = 1.5 \\times 2^{-500}$ 可以写成 $(1 + 0.5) \\times 2^{-500} = (1.1)_2 \\times 2^{-500}$。尾数 $(1.1)_2$ 可以使用可用的 $53$ 位中的 $2$ 位来表示，并且指数 $e = -500$ 在有效范围 $[-1022, 1023]$ 内。因此，$x$ 是一个可表示的规格化数。\n数 $y = 2^{-574}$ 可以写成 $1.0 \\times 2^{-574}$。尾数 $(1.0)_2$ 是可表示的，指数 $e=-574$ 也在有效范围内。因此，$y$ 是一个可表示的规格化数。\n\n该过程首先计算 $x$ 和 $y$ 的精确实数积，然后将此结果舍入到最接近的可表示的 binary64 数。\n\n步骤 1：计算精确积。\n设 $z$ 是 $x$ 和 $y$ 的精确实数积。\n$$z = x \\cdot y = (1.5 \\times 2^{-500}) \\times (2^{-574})$$\n$$z = 1.5 \\times 2^{-500 - 574}$$\n$$z = 1.5 \\times 2^{-1074}$$\n用二进制表示，即为 $z = (1.1)_2 \\times 2^{-1074}$。\n\n步骤 2：分析精确积 $z$。\n$z$ 的指数是 $e = -1074$。在 binary64 中，规格化数的最小指数是 $e_{\\min, \\text{norm}} = -1022$。由于 $e  e_{\\min, \\text{norm}}$，结果 $z$ 落在非规格化数范围内。\nbinary64 中的非规格化数使用等于最小规格化指数的固定指数 $e_{\\min} = -1022$ 来表示，并且尾数中有一个隐含的前导 $0$。其形式为 $(0.f)_2 \\times 2^{-1022}$，其中 $f$ 是 $52$ 位的小数部分。\n我们必须将 $z$ 改写为指数为 $-1022$ 的形式：\n$$z = 1.5 \\times 2^{-1074} = 1.5 \\times 2^{-1074 + 1022} \\times 2^{-1022} = 1.5 \\times 2^{-52} \\times 2^{-1022}$$\n$z$ 的尾数将是 $M_z = 1.5 \\times 2^{-52}$。让我们用二进制表示它：\n$$M_z = (1+0.5) \\times 2^{-52} = 2^{-52} + 2^{-53}$$\n$$M_z = (0.\\underbrace{00\\dots0}_{51 \\text{ zeros}}1)_2 + (0.\\underbrace{00\\dots0}_{52 \\text{ zeros}}1)_2 = (0.\\underbrace{00\\dots0}_{51 \\text{ zeros}}11)_2$$\n尾数 $M_z$ 需要小数点后 $53$ 位才能精确表示。然而，binary64 格式中非规格化数的小数域只提供 $52$ 位。因此，$z$ 不是一个可精确表示的数，必须进行舍入。\n\n步骤 3：确定两边的可表示数。\n可表示的非规格化数是最小可能非规格化增量的整数倍，该增量对应于小数部分的最低有效位（LSB）的值。这个值是 $2^{-52} \\times 2^{-1022} = 2^{-1074}$。我们称其为非规格化数的末位单位（ulp），$\\epsilon_{sub} = 2^{-1074}$。\n精确积是 $z = 1.5 \\times 2^{-1074} = 1.5 \\times \\epsilon_{sub}$。\n将 $z$ 夹在中间的两个可表示的 binary64 数是：\n$z_{-} = 1 \\times \\epsilon_{sub} = 1 \\times 2^{-1074}$。这个数对应于一个非规格化表示，其尾数的小数部分最低有效位为 $1$，所有其他位为 $0$。其 $52$ 位小数部分的整数值为 $1$。\n$z_{+} = 2 \\times \\epsilon_{sub} = 2 \\times 2^{-1074}$。这对应于一个非规格化表示，其 $52$ 位小数部分的整数值为 $2$。\n\n步骤 4：应用舍入模式。\n精确值 $z = 1.5 \\times 2^{-1074}$ 正好位于 $z_-$ 和 $z_+$ 的中间。这是一个平局情况。\n舍入模式为向最近舍入，偶数优先。在平局情况下，我们必须舍入到尾数最低有效位为 $0$ 的那个数。此处，尾数指的是由52个小数位所代表的整数。\n对于 $z_{-}$，其尾数小数部分的整数值为 $1$，是奇数。\n对于 $z_{+}$，其尾数小数部分的整数值为 $2$，是偶数。\n因此，规则规定向上舍入到 $z_{+}$。\n舍入后的积是 $\\operatorname{fl}(x\\,y) = z_{+}$。\n$$\\operatorname{fl}(x\\,y) = 2 \\times 2^{-1074} = 2^{-1073}$$\n\n步骤 5：计算绝对舍入误差。\n绝对舍入误差是舍入值与精确值之差的绝对值。\n$$\\text{绝对误差} = |\\operatorname{fl}(x\\,y) - z|$$\n$$\\text{绝对误差} = |2 \\times 2^{-1074} - 1.5 \\times 2^{-1074}|$$\n$$\\text{绝对误差} = |(2 - 1.5)| \\times 2^{-1074}$$\n$$\\text{绝对误差} = 0.5 \\times 2^{-1074}$$\n$$\\text{绝对误差} = 2^{-1} \\times 2^{-1074}$$\n$$\\text{绝对误差} = 2^{-1075}$$\n\n绝对舍入误差精确地为 $2^{-1075}$。",
                "answer": "$$\\boxed{2^{-1075}}$$",
                "id": "3575479"
            }
        ]
    }