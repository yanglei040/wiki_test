{"hands_on_practices": [{"introduction": "The smoothing kernel is the cornerstone of the Smoothed Particle Hydrodynamics (SPH) method, acting as a weighted interpolation function to estimate fluid properties from a discrete set of particles. To ensure fundamental physical laws like mass conservation are upheld, the kernel must be properly normalized. This foundational exercise [@problem_id:3534761] will guide you through the derivation of the normalization constant for a general, spherically symmetric kernel in any number of dimensions, a critical first step in constructing a valid SPH simulation.", "problem": "In Smoothed Particle Hydrodynamics (SPH), the smoothing kernel must be normalized so that it conserves mass in $ \\nu $-dimensional Euclidean space. Consider a spherically symmetric kernel of the form $ W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h) $ with compact support $ 0 \\le r  \\kappa h $, where $ \\kappa  0 $ is a finite support parameter, $ h  0 $ is the smoothing length, and $ f:[0,\\kappa) \\to \\mathbb{R}_{\\ge 0} $ is a dimensionless shape function satisfying $ f(q) = 0 $ for $ q \\ge \\kappa $. Enforce the normalization requirement $ \\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1 $ and derive a closed-form analytic expression for the normalization constant $ \\sigma_{\\nu} $ in terms of $ \\nu $, $ \\kappa $, and $ f $. You may use the standard fact that the surface area of the unit sphere in $ \\nu $ dimensions is $ S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)} $. Provide your final answer as a single analytic expression for $ \\sigma_{\\nu} $. No numerical approximation is required, and no units are needed in the final answer.", "solution": "The problem requires the derivation of a closed-form analytic expression for the normalization constant $\\sigma_{\\nu}$ of a spherically symmetric smoothing kernel $W(r,h)$ in $\\nu$-dimensional Euclidean space.\n\nFirst, we perform a validation of the problem statement.\n\n**Step 1: Extract Givens**\n- The smoothing kernel is given by $W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$.\n- The space is $\\nu$-dimensional Euclidean space, $\\mathbb{R}^{\\nu}$.\n- $r = |\\boldsymbol{x}|$ is the radial distance.\n- $h  0$ is the smoothing length.\n- $\\sigma_{\\nu}$ is the normalization constant to be determined.\n- $f(q)$ is a dimensionless shape function where $q = r/h$.\n- The kernel has compact support for $0 \\le r  \\kappa h$, where $\\kappa  0$ is a finite support parameter. This implies $f(q) = 0$ for $q \\ge \\kappa$.\n- The normalization requirement is $\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1$.\n- The surface area of a unit sphere in $\\nu$ dimensions is provided as $S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard and fundamental derivation in the theory of Smoothed Particle Hydrodynamics (SPH), a well-established method in computational physics. The concepts of kernel normalization, compact support, and the use of hyperspherical coordinates are all standard and sound.\n- **Well-Posed:** The problem provides a clear objective (find $\\sigma_{\\nu}$) with all necessary constraints and definitions. A unique, meaningful solution is expected.\n- **Objective:** The problem is stated in precise, mathematical language, free of ambiguity or subjectivity.\n- **Conclusion:** The problem is valid as it is scientifically sound, well-posed, objective, and does not violate any of the invalidity criteria.\n\nWe now proceed with the solution.\n\nThe starting point is the normalization condition:\n$$\n\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1\n$$\nWe substitute the given form of the kernel $W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$, where $r = |\\boldsymbol{x}|$:\n$$\n\\int_{\\mathbb{R}^{\\nu}} \\sigma_{\\nu}\\, h^{-\\nu}\\, f(|\\boldsymbol{x}|/h)\\, \\mathrm{d}^{\\nu} x = 1\n$$\nSince the integrand is spherically symmetric (it depends only on the magnitude $r=|\\boldsymbol{x}|$), it is advantageous to switch from Cartesian coordinates to $\\nu$-dimensional hyperspherical coordinates. The volume element $\\mathrm{d}^{\\nu} x$ in hyperspherical coordinates is given by $\\mathrm{d}^{\\nu} x = r^{\\nu-1} \\mathrm{d}r\\, \\mathrm{d}\\Omega_{\\nu-1}$, where $\\mathrm{d}\\Omega_{\\nu-1}$ is the infinitesimal solid angle element on the $(\\nu-1)$-dimensional unit sphere.\n\nThe integral can be rewritten as:\n$$\n\\int_0^\\infty \\int_{S_{\\nu-1}} \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)\\, r^{\\nu-1} \\mathrm{d}\\Omega_{\\nu-1} \\mathrm{d}r = 1\n$$\nThe integrand does not depend on the angular variables. Therefore, the integration over the solid angle $\\mathrm{d}\\Omega_{\\nu-1}$ yields the total surface area of the $(\\nu-1)$-dimensional unit sphere, which is $S_{\\nu-1}$.\n$$\nS_{\\nu-1} \\int_0^\\infty \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\nThe constants $\\sigma_{\\nu}$ and $h^{-\\nu}$ can be moved outside the integral:\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\int_0^\\infty f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\nThe kernel has compact support, meaning $f(r/h) = 0$ for $r \\ge \\kappa h$. This modifies the upper limit of the radial integral from $\\infty$ to $\\kappa h$.\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\int_0^{\\kappa h} f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\nTo evaluate the remaining integral, we perform a change of variables. Let $q = r/h$. Then $r = qh$ and $\\mathrm{d}r = h\\, \\mathrm{d}q$. The limits of integration for the new variable $q$ are from $r=0 \\implies q=0$ to $r=\\kappa h \\implies q=\\kappa$. Substituting these into the integral:\n$$\n\\int_0^{\\kappa h} f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = \\int_0^{\\kappa} f(q)\\, (qh)^{\\nu-1} (h\\, \\mathrm{d}q)\n$$\n$$\n= \\int_0^{\\kappa} f(q)\\, q^{\\nu-1}\\, h^{\\nu-1}\\, h\\, \\mathrm{d}q = h^{\\nu} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q\n$$\nNow we substitute this result back into the normalization equation:\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\left( h^{\\nu} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q \\right) = 1\n$$\nThe terms $h^{-\\nu}$ and $h^{\\nu}$ cancel each other out, which confirms that the normalization constant $\\sigma_{\\nu}$ is independent of the specific choice of the smoothing length $h$.\n$$\n\\sigma_{\\nu}\\, S_{\\nu-1} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q = 1\n$$\nWe can now solve for $\\sigma_{\\nu}$:\n$$\n\\sigma_{\\nu} = \\frac{1}{S_{\\nu-1} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\nFinally, we substitute the provided expression for the surface area of the $(\\nu-1)$-sphere, $S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$:\n$$\n\\sigma_{\\nu} = \\frac{1}{\\left( \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)} \\right) \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\nThis simplifies to the final closed-form analytic expression for the normalization constant $\\sigma_{\\nu}$:\n$$\n\\sigma_{\\nu} = \\frac{\\Gamma(\\nu/2)}{2 \\pi^{\\nu/2} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\nThis expression for $\\sigma_{\\nu}$ depends on the dimensionality $\\nu$, the support parameter $\\kappa$ (as the upper limit of the integral), and the form of the shape function $f$, as required.", "answer": "$$\\boxed{\\frac{\\Gamma(\\frac{\\nu}{2})}{2 \\pi^{\\frac{\\nu}{2}} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}}$$", "id": "3534761"}, {"introduction": "While SPH excels at modeling complex fluid flows, accurately capturing sharp discontinuities like shock waves presents a significant numerical challenge. This practice [@problem_id:3498269] contrasts two major approaches to this problem: the classic artificial viscosity method and the more modern Godunov-type SPH, which is based on solving inter-particle Riemann problems. By deriving and comparing the signal speeds and resulting shock properties, you will gain a deeper understanding of the trade-offs between numerical dissipation, accuracy, and physical fidelity in hydrodynamical simulations.", "problem": "Consider a one-dimensional compressible ideal gas with adiabatic index $\\gamma$ described by the Euler equations in conservative form. In Smoothed Particle Hydrodynamics (SPH), fluid quantities are represented by particles with positions $\\mathbf{r}_i$, velocities $\\mathbf{v}_i$, masses $m_i$, densities $\\rho_i$, and pressures $P_i$, and interact through kernel-weighted pairwise operators with a smoothing length $h$. In shock-capturing SPH, two broad approaches exist: (i) adding an artificial viscosity dissipation controlled by a pairwise \"signal speed\" between particles and (ii) solving an inter-particle Riemann problem (Godunov SPH) using approximate wave speeds.\n\nStarting from the characteristic analysis of the one-dimensional Euler equations for states on either side of an interface with velocities $u_L$, $u_R$ and sound speeds $c_L$, $c_R$ (where $c \\equiv \\sqrt{\\gamma P/\\rho}$), the fastest left- and right-propagating characteristics are $u_L - c_L$ and $u_R + c_R$, respectively. In SPH, the relevant interface is the line of centers between a pair $(i,j)$ with unit vector $\\hat{\\mathbf{r}}_{ij} \\equiv (\\mathbf{r}_i - \\mathbf{r}_j)/|\\mathbf{r}_i - \\mathbf{r}_j|$ and relative velocity component along the line of centers $s_{ij} \\equiv -\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}$, where $\\mathbf{v}_{ij} \\equiv \\mathbf{v}_i - \\mathbf{v}_j$. A compressive interaction has $s_{ij}  0$.\n\nUsing only these first principles and definitions, derive two signal speed choices:\n\n- For artificial viscosity SPH, derive a conservative pairwise signal speed $v_{\\mathrm{sig},ij}$ that bounds the pairwise propagation of acoustic information and applies dissipation only for compressive pairs. Discuss how the resulting numerical diffusion scales with $h$ and the consequence for shock thickness in units of $h$, as well as the tendency for post-shock oscillations.\n\n- For a Riemann-solver-based SPH (Godunov SPH) using an approximate Harten-Lax-van Leer (HLL) solver, derive the left and right signal speeds $S_L$ and $S_R$ along $\\hat{\\mathbf{r}}_{ij}$ from the extreme characteristic speeds of the Euler equations. Discuss how these choices affect the shock width relative to $h$ and their impact on post-shock oscillations, including the role of contact discontinuity capturing.\n\nAnswer the following multiple-choice question based on your derivations and discussion. Which statement best reflects the correct comparative behavior of artificial-viscosity SPH versus Godunov SPH for shock capturing, including the appropriate signal speed constructions, shock width, and post-shock oscillations?\n\nA. In artificial viscosity SPH, a conservative choice is $v_{\\mathrm{sig},ij} = \\max(c_i, c_j) + \\max(0, s_{ij})$, which applies only for $s_{ij}  0$; this produces shocks with thickness of order a few smoothing lengths $h$ (depending on dissipation coefficients), and residual post-shock oscillations persist due to imperfect contact handling and particle disorder. In Godunov SPH with the HLL solver, using $S_L = \\min(u_L - c_L, u_R - c_R)$ and $S_R = \\max(u_L + c_L, u_R + c_R)$ confines the shock to order $h$ and substantially suppresses post-shock oscillations by better resolving waves, especially when contact waves are included.\n\nB. In artificial viscosity SPH, choosing $v_{\\mathrm{sig},ij} = s_{ij}$ (excluding any sound speed) collapses the shock width to nearly zero and eliminates post-shock oscillations. In Godunov SPH, HLL speeds broaden shocks relative to artificial viscosity because they average characteristics.\n\nC. In Godunov SPH with an exact Riemann solver, contact discontinuities are exactly resolved independent of kernel choice and smoothing length $h$, and shocks become thinner than any fraction of $h$ even on coarse particle spacings; artificial viscosity SPH cannot ever produce shocks thinner than $10 h$.\n\nD. Artificial viscosity with time-dependent coefficients tuned to vanish away from compression can match Godunov SPH both in shock width (down to $h/10$) and in eliminating post-shock oscillations, provided $v_{\\mathrm{sig},ij}$ excludes sound speed to prevent overdissipation; HLL speeds are not necessary for accurate shock capturing in SPH.", "solution": "The user has requested a meticulous validation and solution of a problem concerning shock-capturing methods in Smoothed Particle Hydrodynamics (SPH).\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   System: One-dimensional compressible ideal gas.\n-   Adiabatic index: $\\gamma$.\n-   Governing equations: Euler equations in conservative form.\n-   SPH representation: particles with positions $\\mathbf{r}_i$, velocities $\\mathbf{v}_i$, masses $m_i$, densities $\\rho_i$, and pressures $P_i$.\n-   Interaction: Kernel-weighted pairwise operators with smoothing length $h$.\n-   Shock-capturing approaches: (i) artificial viscosity (AV) dissipation controlled by a pairwise \"signal speed\"; (ii) inter-particle Riemann problem (Godunov SPH) using approximate wave speeds.\n-   Characteristic analysis (1D Euler): States $(u_L, c_L)$ and $(u_R, c_R)$ with sound speed $c \\equiv \\sqrt{\\gamma P/\\rho}$. Fastest characteristics are $u_L - c_L$ and $u_R + c_R$.\n-   SPH interface definitions: Unit vector $\\hat{\\mathbf{r}}_{ij} \\equiv (\\mathbf{r}_i - \\mathbf{r}_j)/|\\mathbf{r}_i - \\mathbf{r}_j|$. Relative velocity component $s_{ij} \\equiv -\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}$, where $\\mathbf{v}_{ij} \\equiv \\mathbf{v}_i - \\mathbf{v}_j$.\n-   Condition for compression: $s_{ij}  0$.\n-   Task 1 (Derivation): Derive a conservative pairwise signal speed $v_{\\mathrm{sig},ij}$ for AV SPH, applicable only for compressive pairs.\n-   Task 2 (Discussion): Discuss AV's numerical diffusion scaling with $h$, shock thickness, and post-shock oscillations.\n-   Task 3 (Derivation): Derive left and right signal speeds $S_L$ and $S_R$ for an HLL-based Godunov SPH.\n-   Task 4 (Discussion): Discuss Godunov SPH's shock width relative to $h$ and its impact on post-shock oscillations.\n-   Task 5 (Question): Answer a multiple-choice question comparing the two methods.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is evaluated against the validation criteria:\n\n-   **Scientifically Grounded:** The problem is firmly rooted in the established principles of computational fluid dynamics, specifically the SPH method for solving the Euler equations. The concepts of artificial viscosity, Godunov methods, Riemann problems (HLL variant), characteristic speeds, and shock capturing are standard and correctly described. The definitions provided, such as that for sound speed $c$ and relative velocity $s_{ij}$, are accurate.\n-   **Well-Posed:** The problem requests the derivation of standard numerical constructs (signal speeds for AV and HLL methods) and a discussion of their well-known properties (shock width, oscillations). These tasks are clearly defined and lead to a specific, unique comparison that can be used to answer the multiple-choice question.\n-   **Objective:** The language is technical, precise, and free of subjective or ambiguous terminology.\n-   **Flaw Checklist:** The problem does not violate any of the specified flaw conditions. It is scientifically sound, formalizable, complete, feasible, well-posed, non-trivial, and scientifically verifiable.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **VALID**. The solution will now proceed.\n\n### Derivations and Discussion\n\n#### Artificial Viscosity (AV) SPH\n\n**Derivation of Signal Speed $v_{\\mathrm{sig},ij}$**\nThe purpose of artificial viscosity is to introduce dissipation in regions of strong compression (shocks) to prevent particle inter-penetration and capture the entropy increase across the shock. This dissipation must be causal, meaning the numerical effect must propagate faster than any physical signal between the interacting particles. The physical signals are acoustic waves propagating with speed $c$ relative to the fluid flow.\n\nFor a pair of particles $(i,j)$, we consider the interaction along the line of centers $\\hat{\\mathbf{r}}_{ij}$. The relevant physical speeds are the sound speeds $c_i$ and $c_j$, and the bulk velocity of approach, $s_{ij} = -\\mathbf{v}_{ij}\\cdot\\hat{\\mathbf{r}}_{ij}  0$. A conservative signal speed, $v_{\\mathrm{sig},ij}$, must bound the maximum speed of information exchange between the particles. This speed is a combination of the acoustic propagation and the bulk motion.\n\nA robust and conservative choice for the signal speed would be the sum of the maximum sound speed of the pair and their velocity of approach. This ensures that the dissipative signal outruns any physical wave traveling between the particles. Thus, a valid choice for the signal speed is:\n$$\nv_{\\mathrm{sig},ij} \\approx \\bar{c}_{ij} + s_{ij}\n$$\nwhere $\\bar{c}_{ij}$ is an average sound speed, e.g., $(\\ c_i + c_j)/2$. To be maximally conservative, one can use $\\max(c_i, c_j)$.\n\nThe problem states that dissipation should apply only for compressive pairs ($s_{ij}  0$). This is typically implemented by multiplying the entire AV term in the momentum equation by a switch, such as the Heaviside function $\\Theta(s_{ij})$ or by a factor proportional to $\\max(0, s_{ij})$. If we were to construct a single signal-speed variable that reflects this, as hinted at in the options, a possible form would be $v_{\\mathrm{sig},ij}' = \\max(c_i, c_j) + \\max(0, s_{ij})$. However, it is the entire viscous force, not just the signal speed, that must vanish for non-compressive interactions. The core derived principle is that the signal speed must combine sound speed and compression speed.\n\n**Discussion of AV SPH Properties**\n-   **Numerical Diffusion and Shock Thickness:** The AV term adds a viscous pressure $\\Pi_{ij}$ to the SPH momentum equation. A common form for the linear viscosity term is $\\Pi_{ij} \\propto \\alpha \\bar{c}_{ij} \\mu_{ij}$, where $\\alpha$ is a dissipation coefficient and $\\mu_{ij} \\propto s_{ij}$. This results in a viscous force that acts like a numerical diffusion on velocity. The effective diffusion coefficient is $\\nu \\propto \\alpha \\bar{c} h$. Balancing the convective and diffusive terms across a shock of width $\\Delta x$ shows that $\\Delta x \\propto \\alpha h$. Therefore, the shock is smeared over a few smoothing lengths, with the precise width being tunable via the parameter $\\alpha$. The shock width is of order $\\mathcal{O}(h)$.\n-   **Post-Shock Oscillations:** The AV term is a scalar pressure added isotropically (in the SPH formulation, it acts along the line of centers). It does not distinguish between the different wave families of the Euler equations (acoustic, entropy, contact). Its primary function is to dissipate kinetic energy into thermal energy. This \"brute-force\" approach is not tailored to the specific wave structure of a hydrodynamical discontinuity. This lack of specificity, combined with the discrete nature of SPH particles which can overshoot their equilibrium post-shock state, leads to spurious, unphysical oscillations in pressure and density behind the shock front.\n\n#### Godunov SPH (HLL Solver)\n\n**Derivation of Signal Speeds $S_L$ and $S_R$**\nGodunov SPH replaces the simple pressure averaging and AV of standard SPH with a more sophisticated approach: solving an approximate Riemann problem between each interacting particle pair. The interface is the plane midway between particles $i$ and $j$. The \"left\" state (L) can be taken as $(\\rho_i, \\mathbf{v}_i, P_i)$ and the \"right\" state (R) as $(\\rho_j, \\mathbf{v}_j, P_j)$. We project these states onto the line of centers $\\hat{\\mathbf{r}}_{ij}$. Let the projected velocities be $u_i = \\mathbf{v}_i \\cdot \\hat{\\mathbf{r}}_{ij}$ and $u_j = \\mathbf{v}_j \\cdot \\hat{\\mathbf{r}}_{ij}$. The problem becomes a $1$D Riemann problem with states $(L) \\equiv (\\rho_i, u_i, P_i)$ and $(R) \\equiv (\\rho_j, u_j, P_j)$.\n\nThe Harten-Lax-van Leer (HLL) solver approximates the solution of the Riemann problem by assuming it consists of two waves with speeds $S_L$ and $S_R$ that bound the entire wave fan (left-going wave, contact, right-going wave). To ensure all physical waves are captured, $S_L$ must be less than or equal to the minimum wave speed emerging from the interface, and $S_R$ must be greater than or equal to the maximum wave speed. The characteristic speeds of the Euler equations are $u-c$, $u$, and $u+c$. The full set of possible wave speeds from the two initial states (L and R) is $\\{u_i-c_i, u_i, u_i+c_i\\}$ and $\\{u_j-c_j, u_j, u_j+c_j\\}$.\n\nA conservative estimate for $S_L$ and $S_R$ requires bounding the extremal speeds from this set:\n-   The leftmost-propagating wave from the interface will have a speed given by the minimum of the $u-c$ speeds from both sides.\n    $$S_L = \\min(u_i - c_i, u_j - c_j)$$\n-   The rightmost-propagating wave will have a speed given by the maximum of the $u+c$ speeds from both sides.\n    $$S_R = \\max(u_i + c_i, u_j + c_j)$$\nThese are the standard, robust signal speed estimates for the HLL solver, consistent with the problem's notation ($L/R$ for $i/j$).\n\n**Discussion of Godunov SPH Properties**\n-   **Shock Width:** By solving a Riemann problem, the flux calculation inherently accounts for the direction of information flow (upwinding). This automatically applies the correct amount of dissipation needed to capture the wave structure between the particles. As a result, shocks are typically captured very sharply, with the transition occurring over the inter-particle separation distance, which is of order $h$. Godunov SPH generally produces sharper shocks than AV SPH for the same resolution.\n-   **Post-Shock Oscillations:** The HLL method provides a much better physical model for the discontinuity than a simple scalar viscosity. By approximately resolving the wave fan, it significantly suppresses the spurious post-shock oscillations seen in AV SPH. The primary limitation of the HLL solver is that it does not explicitly resolve the contact discontinuity, lumping it into the region between $S_L$ and $S_R$. This can be a source of minor errors. However, the overall performance is a substantial improvement, leading to much cleaner shock profiles. More advanced solvers like HLLC (which adds the contact wave) can eliminate these oscillations almost entirely.\n\n### Evaluation of Options\n\n**A. In artificial viscosity SPH, a conservative choice is $v_{\\mathrm{sig},ij} = \\max(c_i, c_j) + \\max(0, s_{ij})$, which applies only for $s_{ij}  0$; this produces shocks with thickness of order a few smoothing lengths $h$ (depending on dissipation coefficients), and residual post-shock oscillations persist due to imperfect contact handling and particle disorder. In Godunov SPH with the HLL solver, using $S_L = \\min(u_L - c_L, u_R - c_R)$ and $S_R = \\max(u_L + c_L, u_R + c_R)$ confines the shock to order $h$ and substantially suppresses post-shock oscillations by better resolving waves, especially when contact waves are included.**\n-   **AV Part:** The signal speed is a plausible, conservative construction derived from first principles (bounding sound and compression speeds). The description of shock width ($\\sim$ few $h$) and post-shock oscillations is accurate. The phrase \"which applies only for $s_{ij}0$\" correctly identifies the condition for applying viscosity, even if the formulation of $v_{\\mathrm{sig},ij}$ itself is slightly non-standard.\n-   **Godunov Part:** The formulae for $S_L$ and $S_R$ are correct based on the derivation from extremal characteristic speeds. The description of shock width ($\\sim h$) and the substantial suppression of oscillations is also correct. The reference to including contact waves points to the general superiority of Riemann-based methods.\n-   **Verdict:** **Correct**. This option provides an accurate and internally consistent comparison of the two methods, aligned with the derivations.\n\n**B. In artificial viscosity SPH, choosing $v_{\\mathrm{sig},ij} = s_{ij}$ (excluding any sound speed) collapses the shock width to nearly zero and eliminates post-shock oscillations. In Godunov SPH, HLL speeds broaden shocks relative to artificial viscosity because they average characteristics.**\n-   **AV Part:** Excluding the sound speed from the signal speed is physically incorrect. It violates causality for subsonic compressions and would lead to severe numerical instabilities, not clean shocks.\n-   **Godunov Part:** Godunov methods, including HLL, are known to produce *sharper* shocks than standard AV, not broader ones.\n-   **Verdict:** **Incorrect**. Both claims are factually wrong.\n\n**C. In Godunov SPH with an exact Riemann solver, contact discontinuities are exactly resolved independent of kernel choice and smoothing length $h$, and shocks become thinner than any fraction of $h$ even on coarse particle spacings; artificial viscosity SPH cannot ever produce shocks thinner than $10 h$.**\n-   **Godunov Part:** The resolution of any feature in SPH is fundamentally limited by the smoothing length $h$. No numerical method can resolve features \"independent of... $h$\" or to a scale \"thinner than any fraction of $h$\".\n-   **AV Part:** The claim \"cannot ever produce shocks thinner than $10h$\" is an exaggeration. The width is proportional to $\\alpha h$, and while very small $\\alpha$ is problematic, a width of several $h$ is typical, not necessarily $10h$.\n-   **Verdict:** **Incorrect**. The claims about resolution are physically impossible for a particle-based method.\n\n**D. Artificial viscosity with time-dependent coefficients tuned to vanish away from compression can match Godunov SPH both in shock width (down to $h/10$) and in eliminating post-shock oscillations, provided $v_{\\mathrm{sig},ij}$ excludes sound speed to prevent overdissipation; HLL speeds are not necessary for accurate shock capturing in SPH.**\n-   This option contains multiple errors seen in other options. It claims sub-h resolution ($h/10$), which is impossible. It incorrectly advocates for excluding the sound speed from the signal speed, which is dangerous. While modern AV switches improve performance, claiming they can fully match and eliminate all oscillations as well as Godunov methods is an overstatement.\n-   **Verdict:** **Incorrect**. The claims are physically and numerically unsound.", "answer": "$$\\boxed{A}$$", "id": "3498269"}, {"introduction": "A powerful simulation is only useful if its results are physically meaningful, which requires careful validation and an understanding of its resolution limits. This exercise [@problem_id:3498260] uses the classic Rayleigh-Taylor instability as a testbed to explore the connection between numerical parameters and physical accuracy in SPH. You will derive the analytical growth rate of the instability and then determine the minimum spatial resolution and maximum time step required for an SPH simulation to correctly capture this behavior, a crucial skill for designing and interpreting any numerical experiment.", "problem": "You are tasked with deriving, implementing, and applying a resolution criterion for capturing the early-time growth of the Rayleigh–Taylor instability using the Smoothed Particle Hydrodynamics (SPH) formalism in a gravitational field. Consider two inviscid, incompressible, barotropic fluids with densities $\\rho_{\\mathrm{h}}$ and $\\rho_{\\mathrm{l}}$ (with $\\rho_{\\mathrm{h}} gt; \\rho_{\\mathrm{l}}$), initially in hydrostatic equilibrium under a uniform gravitational field of magnitude $g$ oriented in the $-y$ direction. The fluids are separated at $y = 0$, with the heavier fluid above ($y  0$) and the lighter fluid below ($y  0$). Impose a single-mode small-amplitude sinusoidal perturbation of wavelength $\\lambda$ at the interface. Assume no surface tension and neglect viscosity. The Atwood number is defined by $A = (\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}})/(\\rho_{\\mathrm{h}} + \\rho_{\\mathrm{l}})$, and the perturbation wavenumber is $k = 2\\pi/\\lambda$. \n\nBegin from the Euler equations with gravity and linearize about the hydrostatic equilibrium to formulate the early-time normal-mode growth of the Rayleigh–Taylor instability. Model SPH smoothing using a Gaussian kernel with smoothing length $h$ to represent how discrete particle-based smoothing modifies continuum fields, and assume the effective growth rate in SPH is multiplicatively reduced by the factor induced by the kernel’s Fourier transform at the perturbation wavenumber. Define the spatial resolution requirement by bounding the relative error in the growth rate by a prescribed tolerance $\\epsilon_{\\mathrm{s}}$ in the sense that the SPH-modified growth rate differs from the continuum linear growth rate by no more than $\\epsilon_{\\mathrm{s}}$ in relative terms. Also, enforce a time-stepping requirement that the explicit integration of the exponential growth is approximated to within a relative tolerance $\\epsilon_{\\mathrm{t}}$ per step, and additionally respect a Courant–Friedrichs–Lewy (CFL) condition with sound speed $c_{\\mathrm{s}}$ and Courant factor $C$.\n\nUse the following physical and numerical base assumptions:\n- The continuum early-time growth rate is determined solely by the linearized Euler equations under gravity and depends on the Atwood number and wavenumber.\n- Smoothed Particle Hydrodynamics (SPH) represents fields by convolution with a kernel function. For a Gaussian kernel, the smoothing in Fourier space attenuates a mode of wavenumber $k$ by a factor that depends on $kh$.\n- The SPH smoothing length $h$ relates to the mean particle spacing $\\Delta x$ by $h = \\eta \\Delta x$, where $\\eta$ is a positive constant chosen to achieve a target neighbor count.\n- For an explicit first-order time integration of a linear ordinary differential equation, approximate the exponential amplification by the discrete update and bound the local relative error per step.\n- Impose a Courant-type bound using $c_{\\mathrm{s}}$ and $C$ such that the time step $\\,\\Delta t\\,$ satisfies a linear CFL constraint.\n\nYour tasks:\n1. From the linearized Euler equations with gravity, obtain the early-time continuum growth rate for the Rayleigh–Taylor instability as a function of $A$, $g$, and $k$. All derivations must start from fundamental laws and core definitions; do not assume or quote target formulas as given. Explain the dependence physically and mathematically.\n2. For Gaussian kernel smoothing in SPH, explain how convolution modifies a single Fourier mode and derive the attenuation factor for wavenumber $k$ in terms of the smoothing length $h$. Using this, define the SPH-modified growth rate and impose the requirement that the relative difference between SPH-modified and continuum growth rates is no greater than $\\epsilon_{\\mathrm{s}}$. Derive a closed-form upper bound for $h$ that satisfies this requirement.\n3. Using $h = \\eta \\Delta x$, derive the minimum number of particles per wavelength needed to meet the spatial tolerance, i.e., $N_{\\lambda} = \\lambda/\\Delta x$. Express this as a function of $\\lambda$, $\\eta$, and the bound on $h$.\n4. For time integration, consider a first-order explicit scheme applied to the linear ordinary differential equation that governs the amplitude’s exponential growth. Derive a bound on the time step $\\Delta t$ so that the relative error per step is at most $\\epsilon_{\\mathrm{t}}$. Combine this bound with a Courant-type condition $\\Delta t \\le C h / c_{\\mathrm{s}}$ to obtain a single conservative bound on $\\Delta t$.\n5. Implement a program that, for each test case, computes and returns the following quantities:\n   - The continuum linear growth rate $\\gamma$ in $\\mathrm{s}^{-1}$.\n   - The maximum smoothing length $h_{\\max}$ in $\\mathrm{m}$ that satisfies the spatial tolerance $\\epsilon_{\\mathrm{s}}$.\n   - The minimum particles-per-wavelength $N_{\\lambda,\\min}$ (dimensionless) implied by $h_{\\max}$ and $\\eta$.\n   - The maximum allowable time step $\\Delta t_{\\max}$ in $\\mathrm{s}$ that satisfies both the time-discretization tolerance $\\epsilon_{\\mathrm{t}}$ and the CFL bound.\n6. Express all floating-point answers in SI units with no unit strings, rounded to six decimal places. \n\nTest suite:\nProvide results for the following parameter sets, each given as the tuple $(\\rho_{\\mathrm{h}}, \\rho_{\\mathrm{l}}, g, \\lambda, \\epsilon_{\\mathrm{s}}, \\epsilon_{\\mathrm{t}}, \\eta, c_{\\mathrm{s}}, C)$ with SI units where applicable:\n- Case 1 (general case): $(2.0, 1.0, 9.81, 0.10, 0.10, 0.10, 1.2, 100.0, 0.30)$\n- Case 2 (shorter wavelength, stricter tolerances): $(2.0, 1.0, 9.81, 0.05, 0.02, 0.02, 1.2, 50.0, 0.30)$\n- Case 3 (low contrast, longer wavelength, relaxed CFL): $(1.05, 1.00, 9.81, 0.20, 0.10, 0.10, 1.2, 100.0, 0.50)$\n- Case 4 (high contrast, moderate wavelength, strict temporal tolerance): $(10.0, 1.0, 9.81, 0.10, 0.05, 0.01, 1.2, 150.0, 0.25)$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of the form $[\\gamma, h_{\\max}, N_{\\lambda,\\min}, \\Delta t_{\\max}]$. For example, the output must look like \n$[[\\gamma_1, h_{\\max,1}, N_{\\lambda,\\min,1}, \\Delta t_{\\max,1}], [\\gamma_2, h_{\\max,2}, N_{\\lambda,\\min,2}, \\Delta t_{\\max,2}], \\ldots]$ \nwith each floating-point number rounded to six decimal places.", "solution": "The problem is scientifically well-posed, internally consistent, and contains all necessary information to derive a unique solution based on established principles of fluid dynamics and numerical analysis. We may therefore proceed with the derivation.\n\nThe resolution criteria for the Smoothed Particle Hydrodynamics (SPH) simulation of the Rayleigh–Taylor instability are derived from fundamental principles in four sequential steps: obtaining the continuum linear growth rate, determining the spatial resolution from SPH smoothing effects, establishing the particle-per-wavelength requirement, and finally, deriving the time-step constraint.\n\n**1. Continuum Linear Growth Rate of the Rayleigh–Taylor Instability**\n\nWe begin with the Euler equations for an inviscid, incompressible fluid under a uniform gravitational field $\\mathbf{g} = (0, -g, 0)$:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0\n$$\n$$\n\\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla)\\mathbf{v} = -\\frac{1}{\\rho}\\nabla P + \\mathbf{g}\n$$\nThe incompressibility condition is $\\nabla \\cdot \\mathbf{v} = 0$. We consider a hydrostatic equilibrium base state ($\\mathbf{v}_0 = 0$) with density $\\rho_0(y)$ and pressure $P_0(y)$. The momentum equation reduces to the condition of hydrostatic balance: $\\frac{dP_0}{dy} = -\\rho_0 g$.\n\nWe introduce small perturbations to this equilibrium: $\\rho = \\rho_0 + \\rho'$, $P = P_0 + P'$, and $\\mathbf{v} = \\mathbf{v}'$. Linearizing the governing equations for these perturbations yields:\n$$\n\\frac{D\\rho}{Dt} = \\frac{\\partial \\rho'}{\\partial t} + v'_y \\frac{d\\rho_0}{dy} = 0 \\quad (\\text{for an incompressible fluid parcel})\n$$\n$$\n\\rho_0 \\frac{\\partial \\mathbf{v}'}{\\partial t} = -\\nabla P' - \\rho' g \\hat{\\mathbf{y}}\n$$\n$$\n\\nabla \\cdot \\mathbf{v}' = 0\n$$\nSince the curl of the gravitational force and the pressure gradient term (assuming barotropic fluid) is zero, if the flow starts irrotational, it remains so. Thus, we can introduce a velocity potential $\\phi$ such that $\\mathbf{v}' = \\nabla \\phi$. The incompressibility condition $\\nabla \\cdot \\mathbf{v}' = 0$ implies that the potential satisfies Laplace's equation: $\\nabla^2 \\phi = 0$.\n\nWe consider two separate domains: a heavy fluid of density $\\rho_{\\mathrm{h}}$ for $y  0$ and a light fluid of density $\\rho_{\\mathrm{l}}$ for $y  0$. We seek solutions for a single-mode perturbation at the interface $y = \\zeta(x, t)$ of the form $\\zeta(x, t) = \\zeta_0 e^{\\gamma t + i k x}$, where $k=2\\pi/\\lambda$ is the wavenumber and $\\gamma$ is the growth rate. The corresponding velocity potential is of the form $\\phi(x, y, t) = \\hat{\\phi}(y) e^{\\gamma t + i k x}$.\n\nSubstituting this form into Laplace's equation, $\\nabla^2 \\phi = 0$, gives an ordinary differential equation for $\\hat{\\phi}(y)$:\n$$\n\\frac{d^2\\hat{\\phi}}{dy^2} - k^2 \\hat{\\phi} = 0\n$$\nThe solutions must decay far from the interface. Thus, for the heavy fluid ($y0$) and light fluid ($y0$), the potentials are:\n$$\n\\phi_{\\mathrm{h}}(x, y, t) = C_{\\mathrm{h}} e^{-ky} e^{\\gamma t + i k x} \\quad (y0)\n$$\n$$\n\\phi_{\\mathrm{l}}(x, y, t) = C_{\\mathrm{l}} e^{ky} e^{\\gamma t + i k x} \\quad (y0)\n$$\nwhere $C_{\\mathrm{h}}$ and $C_{\\mathrm{l}}$ are constants.\n\nWe apply two boundary conditions at the interface $y = \\zeta$:\ni) **Kinematic boundary condition**: The fluid velocity normal to the interface equals the interface velocity. To first order, this is $v'_y = \\frac{\\partial \\zeta}{\\partial t}$ at $y=0$.\n$$\n\\frac{\\partial \\phi_{\\mathrm{h}}}{\\partial y}\\bigg|_{y=0} = \\frac{\\partial \\zeta}{\\partial t} \\implies -k C_{\\mathrm{h}} = \\gamma \\zeta_0\n$$\n$$\n\\frac{\\partial \\phi_{\\mathrm{l}}}{\\partial y}\\bigg|_{y=0} = \\frac{\\partial \\zeta}{\\partial t} \\implies k C_{\\mathrm{l}} = \\gamma \\zeta_0\n$$\nThese relations imply $C_{\\mathrm{l}} = -C_{\\mathrm{h}}$.\n\nii) **Dynamic boundary condition**: Pressure is continuous across the interface, as surface tension is neglected: $P_{\\mathrm{h}}(x, \\zeta, t) = P_{\\mathrm{l}}(x, \\zeta, t)$. We linearize the pressure $P(x, \\zeta, t) \\approx P_0(\\zeta) + P'(x, 0, t) \\approx P_0(0) + \\frac{dP_0}{dy}|_{y=0} \\zeta + P'(x, 0, t)$. The pressure perturbation $P'$ is found by integrating the linearized momentum equation: $P' = -\\rho_0 \\frac{\\partial \\phi}{\\partial t} = -\\rho_0 \\gamma \\phi$.\nThe continuity condition becomes:\n$$\nP_{0, \\mathrm{h}}(0) - \\rho_{\\mathrm{h}}g\\zeta + P'_{\\mathrm{h}}(0) = P_{0, \\mathrm{l}}(0) - \\rho_{\\mathrm{l}}g\\zeta + P'_{\\mathrm{l}}(0)\n$$\nWith $P_{0, \\mathrm{h}}(0)=P_{0, \\mathrm{l}}(0)$, we substitute for $P'$ and $\\zeta$:\n$$\n-\\rho_{\\mathrm{h}}g\\zeta_0 - \\rho_{\\mathrm{h}}\\gamma C_{\\mathrm{h}} = -\\rho_{\\mathrm{l}}g\\zeta_0 - \\rho_{\\mathrm{l}}\\gamma C_{\\mathrm{l}}\n$$\n$$\ng\\zeta_0(\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}}) = \\gamma (\\rho_{\\mathrm{l}} C_{\\mathrm{l}} - \\rho_{\\mathrm{h}} C_{\\mathrm{h}})\n$$\nUsing $C_{\\mathrm{l}} = \\gamma \\zeta_0 / k$ and $C_{\\mathrm{h}} = -\\gamma \\zeta_0 / k$ from the kinematic condition:\n$$\ng\\zeta_0(\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}}) = \\gamma \\left(\\rho_{\\mathrm{l}} \\frac{\\gamma\\zeta_0}{k} - \\rho_{\\mathrm{h}} \\frac{-\\gamma\\zeta_0}{k}\\right)\n$$\nDividing by $\\zeta_0$ (which is non-zero for a non-trivial solution):\n$$\ng(\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}}) = \\frac{\\gamma^2}{k}(\\rho_{\\mathrm{l}} + \\rho_{\\mathrm{h}})\n$$\nSolving for $\\gamma^2$:\n$$\n\\gamma^2 = gk \\frac{\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}}}{\\rho_{\\mathrm{h}} + \\rho_{\\mathrm{l}}} = gk A\n$$\nwhere $A = (\\rho_{\\mathrm{h}} - \\rho_{\\mathrm{l}})/(\\rho_{\\mathrm{h}} + \\rho_{\\mathrm{l}})$ is the Atwood number. The instability grows exponentially when $\\rho_{\\mathrm{h}}  \\rho_{\\mathrm{l}}$, so $A  0$. The linear growth rate is the positive real root:\n$$\n\\gamma = \\sqrt{A g k}\n$$\nThis rate is higher for larger gravity $g$, larger density contrast $A$, and smaller wavelengths $\\lambda$ (larger $k$).\n\n**2. SPH Spatial Resolution Requirement**\n\nIn SPH, a field $f(\\mathbf{r})$ is approximated by its convolution with a smoothing kernel $W(\\mathbf{r}, h)$, where $h$ is the smoothing length: $\\langle f(\\mathbf{r}) \\rangle = (f * W_h)(\\mathbf{r})$. By the convolution theorem, the Fourier transform of the smoothed field is $\\mathcal{F}\\{\\langle f \\rangle\\} = \\hat{f}(\\mathbf{k}) \\hat{W}(\\mathbf{k}, h)$.\nFor a 1D Gaussian kernel $W(x, h) = (2\\pi h^2)^{-1/2} e^{-x^2/(2h^2)}$, its Fourier transform is $\\hat{W}(k, h) = e^{-k^2 h^2 / 2}$.\nA single Fourier mode $e^{ikx}$ is thus attenuated by this factor. The problem states that the SPH growth rate $\\gamma_{\\mathrm{SPH}}$ is multiplicatively reduced by this factor:\n$$\n\\gamma_{\\mathrm{SPH}} = \\gamma \\hat{W}(k, h) = \\gamma e^{-k^2 h^2 / 2}\n$$\nThe spatial resolution requirement is that the relative error in the growth rate is bounded by $\\epsilon_{\\mathrm{s}}$:\n$$\n\\left| \\frac{\\gamma_{\\mathrm{SPH}} - \\gamma}{\\gamma} \\right| = 1 - \\frac{\\gamma_{\\mathrm{SPH}}}{\\gamma} = 1 - e^{-k^2 h^2 / 2} \\le \\epsilon_{\\mathrm{s}}\n$$\nSolving for $h$:\n$$\ne^{-k^2 h^2 / 2} \\ge 1 - \\epsilon_{\\mathrm{s}}\n$$\n$$\n-k^2 h^2 / 2 \\ge \\ln(1 - \\epsilon_{\\mathrm{s}})\n$$\n$$\nh^2 \\le -\\frac{2}{k^2} \\ln(1 - \\epsilon_{\\mathrm{s}}) = \\frac{2}{k^2} \\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)\n$$\nThis provides the upper bound on the smoothing length, $h_{\\max}$:\n$$\nh_{\\max} = \\frac{\\sqrt{2}}{k} \\sqrt{\\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)}\n$$\n\n**3. Minimum Particles Per Wavelength**\n\nThe SPH smoothing length $h$ is related to the mean inter-particle spacing $\\Delta x$ through a dimensionless factor $\\eta$: $h = \\eta \\Delta x$. To satisfy the spatial resolution criterion, we must have $h \\le h_{\\max}$, which implies $\\eta \\Delta x \\le h_{\\max}$, or $\\Delta x \\le h_{\\max}/\\eta$.\nThe number of particles required to resolve one wavelength $\\lambda$ is $N_{\\lambda} = \\lambda / \\Delta x$. To find the minimum required number of particles, we consider the largest permissible particle spacing, $\\Delta x_{\\max} = h_{\\max}/\\eta$.\n$$\nN_{\\lambda, \\min} = \\frac{\\lambda}{\\Delta x_{\\max}} = \\frac{\\lambda}{h_{\\max}/\\eta} = \\frac{\\eta \\lambda}{h_{\\max}}\n$$\nSubstituting the expression for $h_{\\max}$:\n$$\nN_{\\lambda, \\min} = \\frac{\\eta \\lambda}{\\frac{\\sqrt{2}}{k} \\sqrt{\\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)}} = \\frac{\\eta \\lambda (2\\pi/\\lambda)}{\\sqrt{2} \\sqrt{\\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)}} = \\frac{2\\pi\\eta}{\\sqrt{2\\ln\\left(\\frac{1}{1 - \\epsilon_{\\mathrm{s}}}\\right)}}\n$$\n\n**4. Maximum Allowable Time Step**\n\nThe time step $\\Delta t$ is constrained by two conditions: temporal accuracy and numerical stability (CFL condition).\n\ni) **Temporal Accuracy**: The amplitude of the instability $a(t)$ follows $\\dot{a} = \\gamma a$. A first-order explicit integration scheme (e.g., Forward Euler) gives the numerical update $a_{n+1} = a_n(1 + \\gamma \\Delta t)$. The exact solution is $a(t_n+\\Delta t) = a_n e^{\\gamma \\Delta t}$. The local relative error per step is:\n$$\n\\text{Err}_{\\mathrm{rel}} = \\left| \\frac{a_n(1 + \\gamma \\Delta t) - a_n e^{\\gamma \\Delta t}}{a_n e^{\\gamma \\Delta t}} \\right| = \\left| (1 + \\gamma \\Delta t)e^{-\\gamma \\Delta t} - 1 \\right|\n$$\nFor small $\\gamma \\Delta t$, Taylor expansion gives $e^{\\gamma \\Delta t} \\approx 1 + \\gamma \\Delta t + \\frac{1}{2}(\\gamma \\Delta t)^2$. The relative error is approximately $\\frac{1}{2}(\\gamma \\Delta t)^2$. We require this to be less than a tolerance $\\epsilon_{\\mathrm{t}}$:\n$$\n\\frac{1}{2}(\\gamma \\Delta t)^2 \\le \\epsilon_{\\mathrm{t}} \\implies \\Delta t \\le \\frac{\\sqrt{2\\epsilon_{\\mathrm{t}}}}{\\gamma}\n$$\nLet this bound be $\\Delta t_{\\mathrm{acc}}$.\n\nii) **CFL Condition**: The problem specifies a Courant-Friedrichs-Lewy (CFL) condition of the form $\\Delta t \\le C h / c_{\\mathrm{s}}$, where $C$ is the Courant factor and $c_{\\mathrm{s}}$ is the sound speed. This condition becomes more restrictive for smaller $h$. To ensure stability for any valid spatial resolution ($h \\le h_{\\max}$), the condition must hold for the chosen $h$. To find the most generous time step that is still valid under all spatially-resolved scenarios, we evaluate the constraint at the largest permitted smoothing length, $h_{\\max}$.\n$$\n\\Delta t \\le \\frac{C h_{\\max}}{c_{\\mathrm{s}}}\n$$\nLet this bound be $\\Delta t_{\\mathrm{CFL}}$.\n\nThe final maximum allowable time step must satisfy both conditions simultaneously:\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\mathrm{acc}}, \\Delta t_{\\mathrm{CFL}}) = \\min\\left(\\frac{\\sqrt{2\\epsilon_{\\mathrm{t}}}}{\\gamma}, \\frac{C h_{\\max}}{c_{\\mathrm{s}}}\\right)\n$$\n\nThese derived formulae are implemented to compute the required values for the given test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes resolution criteria for SPH simulation of Rayleigh-Taylor instability\n    for a suite of test cases.\n    \"\"\"\n    # Test cases: (rho_h, rho_l, g, lambda, eps_s, eps_t, eta, c_s, C)\n    test_cases = [\n        (2.0, 1.0, 9.81, 0.10, 0.10, 0.10, 1.2, 100.0, 0.30),\n        (2.0, 1.0, 9.81, 0.05, 0.02, 0.02, 1.2, 50.0, 0.30),\n        (1.05, 1.00, 9.81, 0.20, 0.10, 0.10, 1.2, 100.0, 0.50),\n        (10.0, 1.0, 9.81, 0.10, 0.05, 0.01, 1.2, 150.0, 0.25),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho_h, rho_l, g, lam, eps_s, eps_t, eta, c_s, C = case\n\n        # 1. Compute continuum linear growth rate (gamma)\n        atwood_number = (rho_h - rho_l) / (rho_h + rho_l)\n        wavenumber = 2.0 * np.pi / lam\n        \n        # gamma = sqrt(A * g * k)\n        gamma_sq = atwood_number * g * wavenumber\n        if gamma_sq  0: # Physically stable case, not expected here\n             gamma = 0.0\n        else:\n             gamma = np.sqrt(gamma_sq)\n\n        # 2. Compute maximum smoothing length (h_max)\n        # h_max = (sqrt(2)/k) * sqrt(ln(1/(1-eps_s)))\n        if eps_s = 1.0:\n            # Avoid ln of non-positive number; h_max would be undefined or infinite\n            h_max = np.inf \n        else:\n            log_term = np.log(1.0 / (1.0 - eps_s))\n            h_max = (np.sqrt(2.0) / wavenumber) * np.sqrt(log_term)\n\n        # 3. Compute minimum particles per wavelength (N_lambda_min)\n        # N_lambda_min = eta * lambda / h_max\n        if h_max == 0 or np.isinf(h_max):\n            N_lambda_min = np.inf if h_max == 0 else 0\n        else:\n            N_lambda_min = eta * lam / h_max\n\n        # 4. Compute maximum allowable time step (dt_max)\n        # Constraint from temporal accuracy\n        if gamma == 0:\n            dt_acc = np.inf\n        else:\n            dt_acc = np.sqrt(2.0 * eps_t) / gamma\n        \n        # Constraint from CFL condition\n        if c_s == 0:\n            dt_cfl = np.inf\n        else:\n            dt_cfl = C * h_max / c_s\n        \n        dt_max = min(dt_acc, dt_cfl)\n\n        # Store results for this case\n        results.append([gamma, h_max, N_lambda_min, dt_max])\n\n    # Format the final output string as specified\n    # e.g., [[gamma1,h_max1,N_min1,dt_max1],[gamma2,h_max2,N_min2,dt_max2],...]\n    # with each float rounded to 6 decimal places.\n    result_str_list = []\n    for r in results:\n        # Format each number in the sublist\n        formatted_r = [f\"{val:.6f}\" for val in r]\n        # Join into a string sublist like '[val1,val2,val3,val4]'\n        result_str_list.append(f\"[{','.join(formatted_r)}]\")\n\n    # Join all sublist strings into the final output string\n    final_output = f\"[{','.join(result_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3498260"}]}