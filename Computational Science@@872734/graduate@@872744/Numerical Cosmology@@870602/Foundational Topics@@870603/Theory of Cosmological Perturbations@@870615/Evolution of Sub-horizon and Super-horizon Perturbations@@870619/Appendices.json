{"hands_on_practices": [{"introduction": "A cornerstone of modern cosmology is understanding how structures like galaxies and clusters form from tiny initial density fluctuations. On scales much smaller than the cosmic horizon (sub-horizon scales), the evolution of these perturbations is accurately described by Newtonian gravity. However, on scales comparable to or larger than the horizon, a full General Relativistic treatment is necessary. This practice provides a direct numerical test of this principle by evolving perturbations in a $\\Lambda$CDM universe and quantifying the breakdown of the Newtonian Poisson equation as we move from sub-horizon to super-horizon scales. Mastering this exercise [@problem_id:3471486] is fundamental to validating any cosmological simulation that bridges these two regimes.", "problem": "You are tasked with numerically validating the Newtonian (Poisson-limit) behavior of scalar metric perturbations in a spatially flat Lambda Cold Dark Matter ($\\Lambda$CDM) cosmology. Specifically, for Fourier modes with wavenumber $k$ much larger than the conformal Hubble rate $aH$, the Newtonian Poisson equation $k^2 \\Phi = 4 \\pi G a^2 \\bar{\\rho} \\, \\delta$ should hold to high accuracy. For modes with $k \\lesssim aH$, general relativistic corrections introduce deviations from this Newtonian relation. Your program must implement a self-consistent numerical evolution of the linear perturbations to quantify the fractional residual of the Newtonian Poisson equation.\n\nThe cosmological background is a flat $\\Lambda$CDM Universe with present-day matter density parameter $\\Omega_{m0}$ and cosmological constant density parameter $\\Omega_{\\Lambda 0}$, and Hubble parameter $H(a) = H_0 \\sqrt{\\Omega_{m0} a^{-3} + \\Omega_{\\Lambda 0}}$. We define the conformal Hubble rate as $\\mathcal{H}(a) = a H(a)$. For convenience and to avoid unit conversion, set $H_0 = 1$ (dimensionless units), so all quantities are dimensionless. Use $\\Omega_{m0} = 0.3$ and $\\Omega_{\\Lambda 0} = 0.7$.\n\nConsider pressureless matter (cold dark matter) with linear perturbations in Newtonian gauge. Evolve the following system for a single Fourier mode $k$ as a function of the logarithmic scale factor $N = \\ln a$:\n\n- Continuity equation for dust:\n$$\n\\delta' = - \\theta + 3 \\Phi' \\, ,\n$$\n- Euler equation for dust:\n$$\n\\theta' = - \\mathcal{H} \\, \\theta + k^2 \\Phi \\, ,\n$$\n- Einstein momentum constraint (used to compute $\\Phi'$ self-consistently):\n$$\nk^2 \\left(\\Phi' + \\mathcal{H} \\Phi \\right) = 4 \\pi G \\, a^2 \\bar{\\rho} \\, \\theta \\, .\n$$\n\nHere, $\\delta$ is the matter density contrast, $\\theta$ is the velocity divergence, $\\Phi$ is the Bardeen potential, and a prime denotes a derivative with respect to conformal time $\\eta$. Convert these equations to derivatives with respect to $N$ using $X_N \\equiv \\frac{dX}{dN} = \\frac{X'}{\\mathcal{H}}$. Use the background Friedmann relation $3 H^2(a) = 8 \\pi G \\, \\bar{\\rho}_{\\text{tot}}(a)$ and define the matter fraction\n$$\n\\Omega_m(a) = \\frac{\\Omega_{m0} a^{-3}}{\\Omega_{m0} a^{-3} + \\Omega_{\\Lambda 0}} \\, ,\n$$\nto express $4 \\pi G a^2 \\bar{\\rho}$ in terms of $\\mathcal{H}(a)$ via\n$$\n4 \\pi G a^2 \\bar{\\rho} = \\frac{3}{2} \\mathcal{H}^2(a) \\, \\Omega_m(a) \\, .\n$$\n\nInitial conditions: choose an early time $a_i = 10^{-3}$ and set adiabatic growing-mode initial conditions deep in matter domination. Take $\\Phi(a_i) = \\Phi_0$ with $\\Phi_0 = 10^{-5}$, $\\delta(a_i) = -2 \\Phi_0$, and $\\theta(a_i) = 0$. Evolve to $a_f = 1$.\n\nFor each $k$, after evolving to $a_f$, compute the fractional residual of the Newtonian Poisson equation,\n$$\nR(k) = \\frac{\\left| k^2 \\Phi(a_f) - 4 \\pi G a_f^2 \\bar{\\rho}(a_f) \\, \\delta(a_f) \\right|}{\\left| 4 \\pi G a_f^2 \\bar{\\rho}(a_f) \\, \\delta(a_f) \\right|} \\, ,\n$$\nwhich is a dimensionless float.\n\nTest suite:\n- Use $a_f = 1$ and compute $\\mathcal{H}_f \\equiv \\mathcal{H}(a_f)$ with the given background parameters.\n- Evaluate the fractional residual $R(k)$ for the following four wavenumbers:\n    1. $k = 0.01 \\, \\mathcal{H}_f$ (super-horizon at $a_f$),\n    2. $k = 1 \\, \\mathcal{H}_f$ (near-horizon at $a_f$),\n    3. $k = 10 \\, \\mathcal{H}_f$ (sub-horizon at $a_f$),\n    4. $k = 100 \\, \\mathcal{H}_f$ (deeply sub-horizon at $a_f$).\nThis set probes behavior across super-horizon, horizon, and sub-horizon regimes.\n\nRequired final output:\n- Your program should produce a single line of output containing the four computed residuals as a comma-separated list enclosed in square brackets, in the order specified above, for example, \"[r1,r2,r3,r4]\".\n- All outputs are dimensionless floats. No percentages and no physical units should be printed.\n\nScientific and numerical realism:\n- The implementation must be based on the above fundamental relations from General Relativity (GR) linear perturbation theory and the ΛCDM background.\n- The numerical integration should be performed with robust ordinary differential equation solvers and appropriate variable transformations to ensure stability across the test suite.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It requires the numerical integration of a system of linear ordinary differential equations (ODEs) that describe the evolution of cosmological perturbations in a $\\Lambda$CDM universe. The equations and initial conditions are standard in the field of physical cosmology, based on General Relativity. The task is to compute the fractional residual of the Newtonian Poisson equation at the present day ($a_f=1$) for various perturbation scales, which is a classic exercise for understanding the transition from the general relativistic to the Newtonian description of gravity.\n\nThe solution proceeds as follows:\nFirst, we must formulate a system of first-order ODEs suitable for numerical integration. The problem provides three equations for the matter density contrast $\\delta$, the velocity divergence $\\theta$, and the gravitational potential $\\Phi$. The derivatives are with respect to conformal time $\\eta$. It is more convenient to integrate with respect to the logarithm of the scale factor, $N = \\ln a$. The relationship between derivatives is $\\frac{d}{dN} = \\frac{1}{\\mathcal{H}}\\frac{d}{d\\eta}$, where $\\mathcal{H} = aH$ is the conformal Hubble rate.\n\nThe given equations are:\n1.  Continuity: $\\delta' = - \\theta + 3 \\Phi'$\n2.  Euler: $\\theta' = - \\mathcal{H} \\, \\theta + k^2 \\Phi$\n3.  Einstein momentum constraint: $k^2 \\left(\\Phi' + \\mathcal{H} \\Phi \\right) = 4 \\pi G \\, a^2 \\bar{\\rho} \\, \\theta$\n\nLet a subscript $N$ denote a derivative with respect to $N$, i.e., $X_N = dX/dN = X'/\\mathcal{H}$.\nWe convert the equations:\n1.  $\\mathcal{H} \\delta_N = -\\theta + 3\\mathcal{H}\\Phi_N \\implies \\delta_N = -\\frac{\\theta}{\\mathcal{H}} + 3\\Phi_N$\n2.  $\\mathcal{H} \\theta_N = -\\mathcal{H}\\theta + k^2\\Phi \\implies \\theta_N = -\\theta + \\frac{k^2}{\\mathcal{H}^2}\\Phi$\n3.  $k^2(\\mathcal{H} \\Phi_N + \\mathcal{H}\\Phi) = 4\\pi G a^2 \\bar{\\rho} \\, \\theta \\implies \\Phi_N = \\frac{4\\pi G a^2 \\bar{\\rho}}{k^2\\mathcal{H}}\\theta - \\Phi$\n\nUsing the provided identity, $4 \\pi G a^2 \\bar{\\rho} = \\frac{3}{2} \\mathcal{H}^2(a) \\, \\Omega_m(a)$, where $\\bar{\\rho}$ is the background matter density, the equation for $\\Phi_N$ becomes:\n$$\n\\Phi_N = \\frac{\\frac{3}{2} \\mathcal{H}^2 \\Omega_m}{k^2 \\mathcal{H}}\\theta - \\Phi = \\frac{3}{2} \\Omega_m(a) \\frac{\\mathcal{H}(a)}{k^2} \\theta - \\Phi\n$$\nSubstituting this into the equation for $\\delta_N$ is possible, but it is numerically more direct to solve for all three variables, $[\\delta, \\theta, \\Phi]$, simultaneously. The system of first-order ODEs in $N$ for the state vector $Y(N) = [\\delta(N), \\theta(N), \\Phi(N)]^T$ is:\n$$\n\\frac{d\\delta}{dN} = -\\frac{\\theta}{\\mathcal{H}} + 3 \\left( \\frac{3}{2} \\Omega_m \\frac{\\mathcal{H}}{k^2}\\theta - \\Phi \\right) = \\left( \\frac{9}{2} \\frac{\\Omega_m \\mathcal{H}}{k^2} - \\frac{1}{\\mathcal{H}} \\right) \\theta - 3\\Phi\n$$\n$$\n\\frac{d\\theta}{dN} = -\\theta + \\frac{k^2}{\\mathcal{H}^2}\\Phi\n$$\n$$\n\\frac{d\\Phi}{dN} = \\frac{3}{2} \\Omega_m \\frac{\\mathcal{H}}{k^2}\\theta - \\Phi\n$$\nThe background quantities $\\mathcal{H}(a)$ and $\\Omega_m(a)$ are functions of $N$ through $a=e^N$:\n-   $\\mathcal{H}(a) = a H(a) = a H_0 \\sqrt{\\Omega_{m0} a^{-3} + \\Omega_{\\Lambda 0}} = H_0 \\sqrt{\\Omega_{m0} a^{-1} + \\Omega_{\\Lambda 0} a^2}$\n-   $\\Omega_m(a) = \\frac{\\Omega_{m0} a^{-3}}{\\Omega_{m0} a^{-3} + \\Omega_{\\Lambda 0}} = \\frac{\\Omega_{m0}}{\\Omega_{m0} + \\Omega_{\\Lambda 0} a^3}$\n\nWith $H_0 = 1$, $\\Omega_{m0} = 0.3$, and $\\Omega_{\\Lambda 0} = 0.7$, we integrate this system from the initial time $a_i = 10^{-3}$ ($N_i = \\ln(10^{-3})$) to the final time $a_f = 1$ ($N_f = 0$). The initial conditions correspond to the standard adiabatic growing mode deep in the matter-dominated era ($a \\ll 1$): $\\Phi(a_i) = \\Phi_0 = 10^{-5}$, $\\delta(a_i) = -2\\Phi_0$, and $\\theta(a_i) = 0$.\n\nThe integration is performed for four different wavenumbers: $k/\\mathcal{H}_f = \\{0.01, 1, 10, 100\\}$, where $\\mathcal{H}_f = \\mathcal{H}(a_f=1) = H_0\\sqrt{\\Omega_{m0}+\\Omega_{\\Lambda 0}} = 1$. The wavenumbers are thus $k \\in \\{0.01, 1, 10, 100\\}$. A numerical ODE solver, specifically `scipy.integrate.solve_ivp`, is used.\n\nAfter obtaining the final state $[\\delta(a_f), \\theta(a_f), \\Phi(a_f)]$, we compute the fractional residual of the Newtonian Poisson equation:\n$$\nR(k) = \\frac{\\left| k^2 \\Phi_f - (4 \\pi G a_f^2 \\bar{\\rho}_f) \\, \\delta_f \\right|}{\\left| (4 \\pi G a_f^2 \\bar{\\rho}_f) \\, \\delta_f \\right|}\n$$\nThe term $4 \\pi G a_f^2 \\bar{\\rho}_f$ is calculated using the identity:\n$$\n4 \\pi G a_f^2 \\bar{\\rho}(a_f) = \\frac{3}{2} \\mathcal{H}(a_f)^2 \\Omega_m(a_f) = \\frac{3}{2} (1)^2 (0.3) = 0.45\n$$\nThe resulting four values of $R(k)$ are then reported. The expectation is that $R(k)$ will be small for sub-horizon modes ($k \\gg \\mathcal{H}_f$) and larger for super-horizon modes ($k \\lesssim \\mathcal{H}_f$), demonstrating the regime where Newtonian gravity is a valid approximation.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Main function to encapsulate the solution process.\ndef solve():\n    \"\"\"\n    Numerically integrates the evolution of cosmological perturbations and computes\n    the fractional residual of the Newtonian Poisson equation for different\n    wavenumbers.\n    \"\"\"\n    # Cosmological Parameters\n    OMEGA_M0 = 0.3\n    OMEGA_L0 = 0.7\n    H0 = 1.0  # Dimensionless Hubble constant\n\n    # Integration settings\n    A_I = 1e-3  # Initial scale factor\n    A_F = 1.0   # Final scale factor\n    N_I = np.log(A_I)\n    N_F = np.log(A_F)\n\n    # Initial conditions for adiabatic growing mode\n    PHI_0 = 1e-5\n    DELTA_I = -2.0 * PHI_0\n    THETA_I = 0.0\n    PHI_I = PHI_0\n    Y0 = [DELTA_I, THETA_I, PHI_I]\n\n    # Helper functions for background evolution\n    def h_conf_func(a, omega_m0=OMEGA_M0, omega_l0=OMEGA_L0, h0=H0):\n        \"\"\"Calculates the conformal Hubble rate H_conf = a*H.\"\"\"\n        return h0 * np.sqrt(omega_m0 * a**(-1.0) + omega_l0 * a**(2.0))\n\n    def omega_m_func(a, omega_m0=OMEGA_M0, omega_l0=OMEGA_L0):\n        \"\"\"Calculates the matter density parameter Omega_m(a).\"\"\"\n        return (omega_m0 * a**(-3.0)) / (omega_m0 * a**(-3.0) + omega_l0)\n\n    # ODE system definition for the integrator\n    def ode_system(N, Y, k, omega_m0, omega_l0, h0):\n        \"\"\"\n        Defines the system of ODEs for (delta, theta, Phi) with respect to N = ln(a).\n        Y[0] = delta, Y[1] = theta, Y[2] = Phi\n        \"\"\"\n        delta, theta, phi = Y\n        a = np.exp(N)\n\n        # Calculate background quantities at the current step\n        h_conf = h_conf_func(a, omega_m0, omega_l0, h0)\n        omega_m = omega_m_func(a, omega_m0, omega_l0)\n\n        # The system of ODEs dY/dN\n        # Equation for d(delta)/dN\n        d_delta_dN = ( (9.0/2.0) * omega_m * h_conf / k**2 - 1.0 / h_conf ) * theta - 3.0 * phi\n        # Equation for d(theta)/dN\n        d_theta_dN = -theta + k**2 / h_conf**2 * phi\n        # Equation for d(Phi)/dN\n        d_phi_dN = (3.0/2.0) * omega_m * h_conf / k**2 * theta - phi\n        \n        return [d_delta_dN, d_theta_dN, d_phi_dN]\n\n    # Define the wavenumbers for the test suite\n    h_conf_f = h_conf_func(A_F)\n    test_cases_k = [0.01 * h_conf_f, 1.0 * h_conf_f, 10.0 * h_conf_f, 100.0 * h_conf_f]\n\n    results = []\n    for k_val in test_cases_k:\n        # Numerically integrate the ODE system for the current k\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[N_I, N_F],\n            y0=Y0,\n            args=(k_val, OMEGA_M0, OMEGA_L0, H0),\n            t_eval=[N_F],\n            method='RK45', # Standard solver, sufficient for this problem\n            rtol=1e-7, atol=1e-12 # Tolerances for high accuracy\n        )\n        \n        # Extract final values of the perturbations\n        delta_f, _, phi_f = sol.y[:, -1]\n\n        # Calculate the fractional residual of the Newtonian Poisson equation\n        # The term 4*pi*G*a^2*rho_m becomes (3/2)*H_conf^2*Omega_m\n        newtonian_coeff = (3.0/2.0) * h_conf_f**2 * omega_m_func(A_F)\n        \n        gr_poisson_term = k_val**2 * phi_f\n        newtonian_poisson_term = newtonian_coeff * delta_f\n        \n        # Guard against division by an extremely small number\n        if abs(newtonian_poisson_term)  1e-30:\n            # This case is not expected in a physical growing mode scenario\n            residual = np.nan\n        else:\n            residual = np.abs(gr_poisson_term - newtonian_poisson_term) / np.abs(newtonian_poisson_term)\n        \n        results.append(residual)\n\n    # Format and print the final output as specified\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\n# Execute the main function to produce the solution.\nsolve()\n```", "id": "3471486"}, {"introduction": "The inflationary paradigm posits that cosmological perturbations originated from quantum fluctuations in the very early universe. These modes begin deep inside the Hubble horizon, where they are described by the Bunch-Davies vacuum state. This exercise [@problem_id:3471532] tackles a crucial practical aspect of simulating this era: since we cannot start a simulation in the infinite past, we must choose a finite, early time to impose these initial conditions. By varying the starting scale, you will investigate the robustness of the predicted primordial power spectrum, gaining insight into the convergence and accuracy of numerical predictions for inflationary observables.", "problem": "Design and implement a program to numerically assess the robustness of Bunch–Davies initial conditions for curvature perturbations in a single-field, constant slow-roll parameter background by initializing sub-horizon modes at a finite ratio $k/(aH)=\\alpha \\gg 1$ and varying $\\alpha$ to quantify the sensitivity of the frozen curvature perturbation amplitude.\n\nYou must work within the following consistent, self-contained framework:\n\n- Background and perturbations:\n  - Consider a single-field inflationary background with constant first slow-roll parameter $\\epsilon$, where $\\epsilon \\in (0,1)$ is constant.\n  - Work in conformal time $\\eta  0$, with scale factor $a(\\eta)$ scaling as a pure power law for constant $\\epsilon$. Let $p \\equiv 1/(1-\\epsilon)$ and set the overall normalization of the scale factor to unity so that $a(\\eta) = (-\\eta)^{-p}$. This fixes the convention and removes an arbitrary multiplicative constant.\n  - The Mukhanov variable $v_k(\\eta)$ obeys the Mukhanov–Sasaki equation\n    $$ v_k''(\\eta) + \\left(k^2 - \\frac{z''(\\eta)}{z(\\eta)}\\right) v_k(\\eta) = 0, $$\n    where $z(\\eta) = a(\\eta) \\sqrt{2\\epsilon}$ in reduced Planck units (set to unity), and primes denote derivatives with respect to $\\eta$. For constant $\\epsilon$, one has\n    $$ \\frac{z''}{z} = \\frac{a''}{a} = \\frac{p(p+1)}{\\eta^2}. $$\n  - The comoving curvature perturbation is $\\zeta_k(\\eta) = v_k(\\eta)/z(\\eta)$, which freezes to a constant amplitude on super-horizon scales.\n\n- Initialization protocol (finite Bunch–Davies approximation):\n  - The exact Bunch–Davies vacuum requires $v_k(\\eta) \\to e^{-ik\\eta}/\\sqrt{2k}$ as $\\eta \\to -\\infty$. To approximate this at finite time, initialize at a finite sub-horizon ratio $k/(aH)=\\alpha$ with the plane-wave prescription:\n    $$ v_k(\\eta_i) = \\frac{e^{-ik\\eta_i}}{\\sqrt{2k}}, \\quad v_k'(\\eta_i) = -i k \\frac{e^{-ik\\eta_i}}{\\sqrt{2k}}. $$\n  - Using $aH = a'/a = -p/\\eta$, the sub-horizon condition $k/(aH)=\\alpha$ implies\n    $$ \\eta_i = -\\frac{p\\,\\alpha}{k}. $$\n\n- Numerical task:\n  - For given $\\epsilon$ and $k$, integrate the Mukhanov–Sasaki equation from $\\eta=\\eta_i$ to a final time $\\eta=\\eta_f$ chosen such that the mode is deeply super-horizon, i.e.,\n    $$ \\eta_f = -\\frac{p\\,\\alpha_{\\text{out}}}{k}, \\quad \\text{with} \\quad \\alpha_{\\text{out}} \\ll 1. $$\n  - At $\\eta_f$, compute the frozen amplitude\n    $$ A(\\alpha) \\equiv \\left|\\zeta_k(\\eta_f)\\right| = \\left|\\frac{v_k(\\eta_f)}{z(\\eta_f)}\\right|. $$\n\n- Robustness metric:\n  - Use a large reference value $\\alpha_{\\text{ref}}$ and report fractional deviations\n    $$ \\delta(\\alpha) \\equiv \\frac{A(\\alpha) - A(\\alpha_{\\text{ref}})}{A(\\alpha_{\\text{ref}})}. $$\n  - This removes any residual dependence on the arbitrary normalization of $a(\\eta)$ and isolates sensitivity to the finite-time initialization.\n\n- Parameter choices and units:\n  - Work in reduced Planck units with $M_{\\mathrm{pl}}=1$.\n  - Use the following fixed parameters: $\\epsilon = 0.01$, $k = 1$, $\\alpha_{\\text{out}} = 10^{-3}$, and $\\alpha_{\\text{ref}} = 100$.\n  - The results are dimensionless. No physical units are required.\n\n- Test suite:\n  - Evaluate the robustness metric for the set of initial sub-horizon depths\n    $$ \\{\\alpha\\} = [2, 5, 10, 20, 50, 100]. $$\n  - These probe a boundary case ($\\alpha=2$), intermediate cases, and approach the reference large value.\n\n- Output specification:\n  - Your program should numerically integrate the system for each $\\alpha$ in the order listed above, compute $\\delta(\\alpha)$ using $\\alpha_{\\text{ref}}=100$, and produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3,x4,x5,x6]\"). Each entry must be a floating-point number.\n\nConstraints and implementation details:\n- The computation must be done by explicitly integrating the second-order ordinary differential equation for $v_k(\\eta)$ rewritten as a first-order system in terms of real and imaginary parts.\n- Ensure numerical accuracy sufficient to resolve oscillatory behavior at large $\\alpha$ and the transition across horizon crossing to the super-horizon regime where $\\zeta_k$ freezes.\n- Do not assume or use any closed-form solution for $v_k(\\eta)$ or $\\zeta_k(\\eta)$; the solution must arise from numerical integration of the posed initial value problem.", "solution": "The user's problem is valid and will be solved as stated. It is scientifically grounded in the principles of cosmological perturbation theory, well-posed as a numerical initial value problem, and its parameters and objectives are defined with sufficient precision.\n\nThe problem requires a numerical investigation into the robustness of the Bunch–Davies vacuum initial conditions for scalar perturbations during single-field inflation. The standard Bunch–Davies vacuum is defined in the infinite past, $\\eta \\to -\\infty$. In numerical simulations, one must start at a finite time $\\eta_i$, which corresponds to a finite sub-horizon scale where the mode number $k$ is much larger than the expansion rate $aH$. This is parameterized by the ratio $\\alpha = k/(aH) \\gg 1$. The problem is to quantify how the final, super-horizon amplitude of the curvature perturbation depends on the choice of this initial scale $\\alpha$.\n\nThe core of the problem is the numerical integration of the Mukhanov–Sasaki equation for the gauge-invariant variable $v_k(\\eta)$. For a single scalar field with a constant first slow-roll parameter $\\epsilon$, this equation is\n$$ v_k''(\\eta) + \\left(k^2 - \\frac{z''(\\eta)}{z(\\eta)}\\right) v_k(\\eta) = 0 $$\nwhere primes denote derivatives with respect to conformal time $\\eta$. The background is characterized by the scale factor $a(\\eta) = (-\\eta)^{-p}$ with $p \\equiv 1/(1-\\epsilon)$, and the potential term is given by $\\frac{z''}{z} = \\frac{a''}{a} = \\frac{p(p+1)}{\\eta^2}$. The variable $z(\\eta)$ is defined as $z(\\eta) = a(\\eta) \\sqrt{2\\epsilon}$ in reduced Planck units ($M_{\\text{pl}}=1$).\n\nTo solve this second-order, linear, complex ordinary differential equation (ODE), we decompose the Mukhanov variable $v_k(\\eta)$ into its real and imaginary parts, $v_k(\\eta) = v_R(\\eta) + i v_I(\\eta)$. The Mukhanov–Sasaki equation then separates into two independent, identical equations for the real and imaginary components:\n$$ v_R''(\\eta) + \\left(k^2 - \\frac{p(p+1)}{\\eta^2}\\right) v_R(\\eta) = 0 $$\n$$ v_I''(\\eta) + \\left(k^2 - \\frac{p(p+1)}{\\eta^2}\\right) v_I(\\eta) = 0 $$\nFor numerical integration using a standard ODE solver, this system is rewritten as a system of four first-order ODEs. Let the state vector be $\\mathbf{y}(\\eta) = [y_0(\\eta), y_1(\\eta), y_2(\\eta), y_3(\\eta)]^T \\equiv [v_R(\\eta), v_R'(\\eta), v_I(\\eta), v_I'(\\eta)]^T$. The system is then described by $\\frac{d\\mathbf{y}}{d\\eta} = \\mathbf{f}(\\eta, \\mathbf{y})$, where:\n$$ \\mathbf{f}(\\eta, \\mathbf{y}) = \\begin{pmatrix} y_1 \\\\ -\\left(k^2 - \\frac{p(p+1)}{\\eta^2}\\right) y_0 \\\\ y_3 \\\\ -\\left(k^2 - \\frac{p(p+1)}{\\eta^2}\\right) y_2 \\end{pmatrix} $$\n\nThe integration starts at an initial time $\\eta_i$ corresponding to the sub-horizon ratio $\\alpha = k/(aH)$. Using $aH = a'/a = -p/\\eta$, we find $\\eta_i = -p\\alpha/k$. At this time, we impose the finite Bunch-Davies initial conditions, which approximate the pure negative-frequency plane wave solution $v_k(\\eta) \\approx e^{-ik\\eta}/\\sqrt{2k}$ that holds for $\\eta \\to -\\infty$. The initial conditions for $v_k$ and its derivative $v_k'$ are:\n$$ v_k(\\eta_i) = \\frac{e^{-ik\\eta_i}}{\\sqrt{2k}} = \\frac{1}{\\sqrt{2k}}\\left(\\cos(k\\eta_i) - i\\sin(k\\eta_i)\\right) $$\n$$ v_k'(\\eta_i) = -ik \\frac{e^{-ik\\eta_i}}{\\sqrt{2k}} = \\frac{k}{\\sqrt{2k}}\\left(-\\sin(k\\eta_i) - i\\cos(k\\eta_i)\\right) $$\nFrom these, we construct the initial state vector $\\mathbf{y}(\\eta_i)$:\n$$ \\mathbf{y}(\\eta_i) = \\frac{1}{\\sqrt{2k}} \\begin{pmatrix} \\cos(k\\eta_i) \\\\ -k\\sin(k\\eta_i) \\\\ -\\sin(k\\eta_i) \\\\ -k\\cos(k\\eta_i) \\end{pmatrix} $$\n\nThe integration is performed from $\\eta = \\eta_i$ to a final time $\\eta = \\eta_f$ where the mode is deep in the super-horizon regime. This corresponds to a ratio $\\alpha_{\\text{out}} = k/(aH) \\ll 1$, giving $\\eta_f = -p\\alpha_{\\text{out}}/k$. At $\\eta_f$, we compute the comoving curvature perturbation $\\zeta_k(\\eta_f) = v_k(\\eta_f)/z(\\eta_f)$. Its amplitude is given by\n$$ A(\\alpha) = |\\zeta_k(\\eta_f)| = \\frac{|v_k(\\eta_f)|}{|z(\\eta_f)|} = \\frac{\\sqrt{v_R(\\eta_f)^2 + v_I(\\eta_f)^2}}{(-\\eta_f)^{-p}\\sqrt{2\\epsilon}} $$\n\nTo quantify the sensitivity to the initial choice of $\\alpha$, we compute the fractional deviation $\\delta(\\alpha)$ of the amplitude $A(\\alpha)$ from a reference amplitude $A(\\alpha_{\\text{ref}})$ calculated with a very large reference value $\\alpha_{\\text{ref}}$:\n$$ \\delta(\\alpha) = \\frac{A(\\alpha) - A(\\alpha_{\\text{ref}})}{A(\\alpha_{\\text{ref}})} $$\nThis metric isolates the error introduced by starting the evolution at a finite sub-horizon scale $\\alpha$ instead of at $\\alpha \\to \\infty$.\n\nThe algorithm proceeds as follows:\n1.  Define the physical parameters: $\\epsilon = 0.01$, $k = 1$, $\\alpha_{\\text{out}} = 10^{-3}$, and $\\alpha_{\\text{ref}} = 100$. Calculate the derived parameter $p = 1/(1-\\epsilon)$.\n2.  Compute the reference amplitude $A(\\alpha_{\\text{ref}})$ by numerically integrating the system for $\\alpha = \\alpha_{\\text{ref}}$.\n3.  Iterate through the specified test set $\\{\\alpha\\} = \\{2, 5, 10, 20, 50, 100\\}$.\n4.  For each $\\alpha$ in the set, compute the corresponding amplitude $A(\\alpha)$ by numerical integration.\n5.  Calculate the robustness metric $\\delta(\\alpha)$ for each test case.\n6.  Collect the results and format them as specified. For $\\alpha = \\alpha_{\\text{ref}}$, the result is trivially $\\delta(\\alpha_{\\text{ref}}) = 0$.\nThe numerical integration will be performed using a high-precision solver to accurately capture the oscillatory behavior at early times ($\\eta \\ll -1/k$) and the subsequent freeze-out at late times ($\\eta \\gg -1/k$).", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Numerically assesses the robustness of Bunch-Davies initial conditions\n    for curvature perturbations by varying the initial sub-horizon scale.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    epsilon = 0.01\n    k = 1.0\n    alpha_out = 1e-3\n    alpha_ref = 100.0\n    test_alphas = [2.0, 5.0, 10.0, 20.0, 50.0, 100.0]\n\n    # --- Derived Constants ---\n    p = 1.0 / (1.0 - epsilon)\n    p_p_plus_1 = p * (p + 1.0)\n    sqrt_2k = np.sqrt(2.0 * k)\n    sqrt_2epsilon = np.sqrt(2.0 * epsilon)\n\n    def get_amplitude(alpha):\n        \"\"\"\n        Computes the frozen amplitude A(alpha) by integrating the Mukhanov-Sasaki equation.\n        \"\"\"\n        \n        # --- Time intervals ---\n        # Initial time eta_i, based on alpha = k/(aH)\n        eta_i = -p * alpha / k\n        # Final time eta_f, for deep super-horizon evolution\n        eta_f = -p * alpha_out / k\n\n        # --- Initial Conditions (Finite Bunch-Davies) ---\n        # v_k(eta_i) = exp(-i*k*eta_i) / sqrt(2k)\n        # v_k'(eta_i) = -i*k * v_k(eta_i)\n        cos_k_eta_i = np.cos(k * eta_i)\n        sin_k_eta_i = np.sin(k * eta_i)\n        \n        # State vector y = [v_R, v_R', v_I, v_I']\n        y_i = np.array([\n            cos_k_eta_i / sqrt_2k,          # v_R(eta_i)\n            -k * sin_k_eta_i / sqrt_2k,     # v_R'(eta_i)\n            -sin_k_eta_i / sqrt_2k,         # v_I(eta_i)\n            -k * cos_k_eta_i / sqrt_2k,     # v_I'(eta_i)\n        ])\n\n        # --- ODE System Definition ---\n        # y' = f(eta, y)\n        def mukhanov_sasaki_system(eta, y):\n            # Potential term in MS equation: (k^2 - z''/z)\n            # z''/z = a''/a = p(p+1)/eta^2\n            potential_term = k**2 - p_p_plus_1 / eta**2\n            \n            # y = [v_R, v_R', v_I, v_I']\n            # y' = [v_R', v_R'', v_I', v_I'']\n            return np.array([\n                y[1],                       # y_0' = y_1\n                -potential_term * y[0],     # y_1' = - (k^2 - ...) * y_0\n                y[3],                       # y_2' = y_3\n                -potential_term * y[2]      # y_3' = - (k^2 - ...) * y_2\n            ])\n\n        # --- Numerical Integration ---\n        # Use a high-precision solver from eta_i to eta_f\n        sol = solve_ivp(\n            mukhanov_sasaki_system,\n            [eta_i, eta_f],\n            y_i,\n            method='RK45',\n            t_eval=[eta_f],\n            rtol=1e-9,  # Relative tolerance for accuracy\n            atol=1e-12  # Absolute tolerance for accuracy\n        )\n\n        y_f = sol.y[:, -1]\n        v_R_f = y_f[0]\n        v_I_f = y_f[2]\n\n        # --- Amplitude Calculation ---\n        # v_k(eta_f) = v_R(eta_f) + i*v_I(eta_f)\n        v_k_f_abs = np.sqrt(v_R_f**2 + v_I_f**2)\n        \n        # z(eta_f) = a(eta_f) * sqrt(2*epsilon)\n        # a(eta_f) = (-eta_f)^(-p)\n        a_f = (-eta_f)**(-p)\n        z_f = a_f * sqrt_2epsilon\n        \n        # A(alpha) = |zeta_k(eta_f)| = |v_k(eta_f)/z(eta_f)|\n        amplitude = v_k_f_abs / z_f\n        \n        return amplitude\n\n    # --- Main Calculation Loop ---\n    \n    # 1. Compute reference amplitude\n    A_ref = get_amplitude(alpha_ref)\n    \n    # 2. Compute fractional deviation for each test alpha\n    results = []\n    for alpha in test_alphas:\n        A_alpha = get_amplitude(alpha)\n        delta_alpha = (A_alpha - A_ref) / A_ref\n        results.append(delta_alpha)\n        \n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3471532"}, {"introduction": "The comoving curvature perturbation, $\\zeta$, is a key quantity in cosmology because it remains constant on super-horizon scales for adiabatic perturbations. While its formal definition involves metric and density perturbations, there is a powerful and intuitive alternative known as the \"separate universe\" picture. This exercise [@problem_id:3471529] guides you to demonstrate the equivalence of these two viewpoints. By evolving a slightly perturbed patch of the universe and comparing its expansion history to an unperturbed background, you will explicitly construct $\\zeta$ via the $\\delta N$ formalism and show how it connects to the standard linear theory definition, providing a deeper physical intuition for what super-horizon perturbations represent.", "problem": "Consider a spatially flat Friedmann–Lemaître–Robertson–Walker (FLRW) universe filled with a single barotropic perfect fluid of constant equation-of-state parameter $w$, where the pressure $p$ and energy density $\\rho$ satisfy $p = w \\rho$. The unperturbed background obeys the continuity equation and Friedmann equation,\n$$\\frac{d\\rho}{dt} = -3 H (1+w)\\rho,\\quad H^2 = \\frac{8\\pi G}{3}\\rho,$$\nwhere $H$ is the Hubble expansion rate, $G$ is Newton's constant, and $t$ is cosmic time. Consider an adiabatic long-wavelength perturbation mode with comoving wavenumber $k$ satisfying the super-horizon condition $k \\ll a H / c$, where $a$ is the scale factor and $c$ is the speed of light. The comoving curvature perturbation $\\zeta$ is defined by\n$$\\zeta \\equiv -\\psi - \\frac{H}{\\dot{\\rho}}\\delta\\rho,$$\nwhere $\\psi$ is the scalar metric perturbation in longitudinal gauge, $\\delta\\rho$ is the density perturbation, and an overdot denotes a derivative with respect to cosmic time. For an adiabatic perturbation on super-horizon scales, $\\zeta$ is conserved.\n\nConstruct the separate-universe approximation by evolving two nearly homogeneous background patches: an unperturbed patch with initial background density $\\rho_i$ and scale factor $a_i$, and a perturbed patch with a slightly shifted initial density $(1+\\delta_i)\\rho_i$ on an initially spatially flat hypersurface, where $0  \\delta_i \\ll 1$ is the initial fractional density shift. Evolve both patches forward until they reach the same final uniform density $\\rho_f$ (with $\\rho_f \\le \\rho_i$), and compute the difference in integrated expansion (number of e-folds) $\\delta N$ between the two patches. In the separate-universe approximation, the comoving curvature perturbation is $\\zeta_{\\mathrm{SU}} = \\delta N$ evaluated between an initial spatially flat hypersurface and the final uniform-density hypersurface.\n\nIndependently compute the full linear-theory value $\\zeta_{\\mathrm{lin}}$ for $k \\ll aH/c$ using the definition above evaluated at the initial time on the spatially flat hypersurface, and treat it as conserved in time under the stated conditions.\n\nYour task is to write a program that, for each test case specified below, numerically constructs $\\zeta_{\\mathrm{SU}}$ by evolving the two homogeneous patches as described, computes $\\zeta_{\\mathrm{lin}}$ from first principles, and outputs the absolute difference $|\\zeta_{\\mathrm{SU}} - \\zeta_{\\mathrm{lin}}|$ for each test case. Use International System of Units (SI) consistently. Specifically:\n- Use $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$ and $c = 2.99792458\\times 10^8\\,\\mathrm{m\\,s^{-1}}$.\n- Energy densities are in $\\mathrm{kg\\,m^{-3}}$, wavenumber $k$ is in $\\mathrm{m^{-1}}$, the scale factor $a$ is dimensionless, and $H$ is in $\\mathrm{s^{-1}}$.\n- The program must verify the super-horizon condition by computing the dimensionless ratio $\\epsilon \\equiv k / (a_i H_i / c)$, where $H_i = \\sqrt{(8\\pi G/3)\\rho_i}$, but you must not output $\\epsilon$; only ensure that all test cases satisfy $k \\ll a_i H_i / c$.\n\nAlgorithmic construction requirements:\n- Evolve the background patches by integrating the continuity equation with respect to the number of e-folds $N \\equiv \\ln a$, i.e., treat $N$ as the evolution variable and use the exact background relation $d\\rho/dN = -3(1+w)\\rho$.\n- For the unperturbed patch, start at $N=0$ with $\\rho(0) = \\rho_i$ and integrate to $N = N_0$ such that $\\rho(N_0) = \\rho_f$.\n- For the perturbed patch, start at $N=0$ with $\\rho(0) = (1+\\delta_i)\\rho_i$ and integrate to $N = N_1$ such that $\\rho(N_1) = \\rho_f$.\n- Compute $\\zeta_{\\mathrm{SU}} = \\delta N = N_1 - N_0$.\n- Compute $\\zeta_{\\mathrm{lin}}$ at the initial time on the spatially flat hypersurface using the definition above, the background $\\dot{\\rho}_i = -3 H_i (1+w)\\rho_i$, and $\\psi=0$ on that hypersurface.\n- Report $|\\zeta_{\\mathrm{SU}} - \\zeta_{\\mathrm{lin}}|$ as dimensionless floats.\n\nTest suite:\nProvide results for the following five test cases, which probe typical and edge conditions. All quantities must be used in the exact values given.\n\n1. Matter-dominated-like fluid: $w = 0$, $a_i = 1$, $\\rho_i = 10^{-26}\\,\\mathrm{kg\\,m^{-3}}$, $\\rho_f = \\rho_i$, $\\delta_i = 10^{-6}$, $k = 10^{-35}\\,\\mathrm{m^{-1}}$.\n2. Radiation-dominated-like fluid: $w = \\tfrac{1}{3}$, $a_i = 10^{-3}$, $\\rho_i = 10^{-18}\\,\\mathrm{kg\\,m^{-3}}$, $\\rho_f = \\rho_i / 10$, $\\delta_i = 5\\times 10^{-6}$, $k = 10^{-30}\\,\\mathrm{m^{-1}}$.\n3. Intermediate equation-of-state: $w = 0.2$, $a_i = 0.5$, $\\rho_i = 5\\times 10^{-27}\\,\\mathrm{kg\\,m^{-3}}$, $\\rho_f = \\rho_i / 5$, $\\delta_i = 2\\times 10^{-6}$, $k = 10^{-33}\\,\\mathrm{m^{-1}}$.\n4. Tiny-amplitude perturbation: $w = 0$, $a_i = 1$, $\\rho_i = 2\\times 10^{-26}\\,\\mathrm{kg\\,m^{-3}}$, $\\rho_f = \\rho_i / 2$, $\\delta_i = 10^{-9}$, $k = 10^{-35}\\,\\mathrm{m^{-1}}$.\n5. Near-boundary super-horizon mode: $w = \\tfrac{1}{3}$, $a_i = 2\\times 10^{-3}$, $\\rho_i = 5\\times 10^{-19}\\,\\mathrm{kg\\,m^{-3}}$, $\\rho_f = \\rho_i / 4$, $\\delta_i = 10^{-5}$, and choose $k$ such that the ratio satisfies $k / (a_i H_i / c) = 10^{-2}$ exactly, with $H_i = \\sqrt{(8\\pi G/3)\\rho_i}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_j$ is the computed float $|\\zeta_{\\mathrm{SU}} - \\zeta_{\\mathrm{lin}}|$ for the $j$-th test case. All outputs are dimensionless. No additional text should be printed.", "solution": "The problem is valid as it is scientifically grounded in standard cosmology, well-posed, and objective. All necessary information is provided to compute a unique, meaningful result.\n\nThe core of the problem is to compute the difference between the comoving curvature perturbation, $\\zeta$, derived from two different but related perspectives for super-horizon modes: the separate-universe approximation ($\\zeta_{\\mathrm{SU}}$) and linear perturbation theory ($\\zeta_{\\mathrm{lin}}$). We will derive the analytical expressions for both quantities.\n\nThe universe is filled with a perfect fluid with a constant equation-of-state parameter $w$. The evolution of the background energy density $\\rho$ as a function of the number of e-folds, $N \\equiv \\ln a$, is governed by the continuity equation in the form:\n$$\n\\frac{d\\rho}{dN} = -3(1+w)\\rho\n$$\nThis first-order linear ordinary differential equation has the exact solution:\n$$\n\\rho(N) = \\rho_{\\text{initial}} e^{-3(1+w)N}\n$$\nwhere $\\rho_{\\text{initial}}$ is the density at the initial state, which we set to $N=0$.\n\n**1. Derivation of the Separate-Universe Curvature Perturbation, $\\zeta_{\\mathrm{SU}}$**\n\nThe separate-universe approximation involves evolving two homogeneous background patches from an initial spatially flat hypersurface at $N=0$ until they both reach a common final density $\\rho_f$.\n\nFor the unperturbed patch, the initial density is $\\rho(0) = \\rho_i$. It evolves to the final density $\\rho_f$ over $N_0$ e-folds. Using the solution to the evolution equation:\n$$\n\\rho_f = \\rho_i e^{-3(1+w)N_0}\n$$\nSolving for the number of e-folds $N_0$ yields:\n$$\nN_0 = \\frac{\\ln(\\rho_i / \\rho_f)}{3(1+w)}\n$$\n\nFor the perturbed patch, a small initial density excess $\\delta_i$ is introduced, so its initial density is $\\rho(0) = (1+\\delta_i)\\rho_i$. This patch evolves to the same final density $\\rho_f$ over $N_1$ e-folds:\n$$\n\\rho_f = (1+\\delta_i)\\rho_i e^{-3(1+w)N_1}\n$$\nSolving for the number of e-folds $N_1$ yields:\n$$\nN_1 = \\frac{\\ln((1+\\delta_i)\\rho_i / \\rho_f)}{3(1+w)}\n$$\n\nThe curvature perturbation in this formalism, $\\zeta_{\\mathrm{SU}}$, is defined as the difference in the integrated expansion, $\\delta N = N_1 - N_0$.\n$$\n\\zeta_{\\mathrm{SU}} = N_1 - N_0 = \\frac{1}{3(1+w)} \\left[ \\ln\\left(\\frac{(1+\\delta_i)\\rho_i}{\\rho_f}\\right) - \\ln\\left(\\frac{\\rho_i}{\\rho_f}\\right) \\right]\n$$\nUsing the logarithm property $\\ln(A) - \\ln(B) = \\ln(A/B)$, the expression simplifies considerably:\n$$\n\\zeta_{\\mathrm{SU}} = \\frac{1}{3(1+w)} \\ln\\left( \\frac{(1+\\delta_i)\\rho_i / \\rho_f}{\\rho_i / \\rho_f} \\right) = \\frac{\\ln(1+\\delta_i)}{3(1+w)}\n$$\nThis is the exact analytical expression for $\\zeta_{\\mathrm{SU}}$ according to the problem's construction.\n\n**2. Derivation of the Linear Theory Curvature Perturbation, $\\zeta_{\\mathrm{lin}}$**\n\nThe comoving curvature perturbation $\\zeta$ is defined in linear theory as:\n$$\n\\zeta \\equiv -\\psi - \\frac{H}{\\dot{\\rho}}\\delta\\rho\n$$\nThis is to be evaluated at the initial time $t_i$ on a spatially flat hypersurface. On such a hypersurface, the slicing condition sets the scalar metric perturbation $\\psi=0$. The expression for $\\zeta_{\\mathrm{lin}}$ at the initial time is therefore:\n$$\n\\zeta_{\\mathrm{lin}} = -\\frac{H_i}{\\dot{\\rho}_i}\\delta\\rho_i\n$$\nThe continuity equation in terms of cosmic time $t$ is $\\dot{\\rho} = -3H(1+w)\\rho$. At the initial time, this gives $\\dot{\\rho}_i = -3H_i(1+w)\\rho_i$. Substituting this into the equation for $\\zeta_{\\mathrm{lin}}$:\n$$\n\\zeta_{\\mathrm{lin}} = -\\frac{H_i}{-3H_i(1+w)\\rho_i}\\delta\\rho_i = \\frac{\\delta\\rho_i}{3(1+w)\\rho_i}\n$$\nThe initial density perturbation $\\delta\\rho_i$ is the difference between the perturbed and unperturbed initial densities, $\\delta\\rho_i = (1+\\delta_i)\\rho_i - \\rho_i = \\delta_i\\rho_i$. The fractional density perturbation is $\\delta\\rho_i/\\rho_i = \\delta_i$. Substituting this result gives the final expression for $\\zeta_{\\mathrm{lin}}$:\n$$\n\\zeta_{\\mathrm{lin}} = \\frac{\\delta_i}{3(1+w)}\n$$\n\n**3. The Difference $|\\zeta_{\\mathrm{SU}} - \\zeta_{\\mathrm{lin}}|$**\n\nThe quantity to be computed is the absolute difference between the two formulations of the curvature perturbation:\n$$\n|\\zeta_{\\mathrm{SU}} - \\zeta_{\\mathrm{lin}}| = \\left| \\frac{\\ln(1+\\delta_i)}{3(1+w)} - \\frac{\\delta_i}{3(1+w)} \\right| = \\frac{|\\ln(1+\\delta_i) - \\delta_i|}{3(1+w)}\n$$\nThis final expression is elegant and reveals that the difference depends only on the equation-of-state parameter $w$ and the initial fractional density perturbation $\\delta_i$. The other parameters provided in the test cases ($a_i$, $\\rho_i$, $\\rho_f$, $k$) are necessary to define a physically consistent cosmological scenario and to verify the super-horizon condition, but they cancel out from the calculation of the specified difference.\n\nFor $0  \\delta_i \\ll 1$, the Taylor series for the natural logarithm is $\\ln(1+\\delta_i) = \\delta_i - \\frac{\\delta_i^2}{2} + O(\\delta_i^3)$. The difference is therefore approximately:\n$$\n|\\zeta_{\\mathrm{SU}} - \\zeta_{\\mathrm{lin}}| \\approx \\frac{|(\\delta_i - \\frac{\\delta_i^2}{2}) - \\delta_i|}{3(1+w)} = \\frac{\\delta_i^2}{6(1+w)}\n$$\nThis demonstrates that $\\zeta_{\\mathrm{SU}}$ and $\\zeta_{\\mathrm{lin}}$ are equivalent to first order in $\\delta_i$, and the difference we are computing is the leading-order (second-order) correction.\n\n**4. Implementation Plan**\nThe program will perform the following for each test case:\n1.  Define the physical constants $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$ and $c = 2.99792458\\times 10^8\\,\\mathrm{m\\,s^{-1}}$.\n2.  Extract the parameters $w$, $a_i$, $\\rho_i$, $\\delta_i$, and $k$. For test case $5$, $k$ will be computed from the given condition $k / (a_i H_i / c) = 10^{-2}$.\n3.  As a required check, verify the super-horizon condition $k \\ll a_i H_i / c$ for all cases by computing the ratio $\\epsilon \\equiv k / (a_i H_i / c)$, where $H_i = \\sqrt{8\\pi G \\rho_i / 3}$.\n4.  Calculate the exact difference $|\\zeta_{\\mathrm{SU}} - \\zeta_{\\mathrm{lin}}|$ using the derived analytical formula.\n5.  Collect the results and print them in the specified format.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute difference between the comoving curvature perturbation\n    calculated using the separate-universe approximation (zeta_SU) and\n    linear perturbation theory (zeta_lin) for several cosmological test cases.\n    \"\"\"\n\n    # Physical constants as specified in the problem (SI units)\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    c = 2.99792458e8 # m s^-1\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1: Matter-dominated-like\n        {'w': 0.0, 'a_i': 1.0, 'rho_i': 1e-26, 'rho_f_factor': 1.0, 'delta_i': 1e-6, 'k': 1e-35},\n        \n        # Case 2: Radiation-dominated-like\n        {'w': 1./3., 'a_i': 1e-3, 'rho_i': 1e-18, 'rho_f_factor': 0.1, 'delta_i': 5e-6, 'k': 1e-30},\n        \n        # Case 3: Intermediate equation-of-state\n        {'w': 0.2, 'a_i': 0.5, 'rho_i': 5e-27, 'rho_f_factor': 0.2, 'delta_i': 2e-6, 'k': 1e-33},\n        \n        # Case 4: Tiny-amplitude perturbation\n        {'w': 0.0, 'a_i': 1.0, 'rho_i': 2e-26, 'rho_f_factor': 0.5, 'delta_i': 1e-9, 'k': 1e-35},\n        \n        # Case 5: Near-boundary super-horizon mode\n        {'w': 1./3., 'a_i': 2e-3, 'rho_i': 5e-19, 'rho_f_factor': 0.25, 'delta_i': 1e-5, 'k': 'special'},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        w = case['w']\n        a_i = case['a_i']\n        rho_i = case['rho_i']\n        delta_i = case['delta_i']\n\n        # Calculate initial Hubble parameter H_i\n        H_i = np.sqrt((8 * np.pi * G / 3) * rho_i)\n\n        # Determine wavenumber k and verify super-horizon condition\n        if case['k'] == 'special':\n            # For case 5, k is defined by the ratio k / (a_i H_i / c) = 1e-2\n            k_val = 1e-2 * (a_i * H_i / c)\n        else:\n            k_val = case['k']\n        \n        # The problem requires verification of the super-horizon condition k  aH/c.\n        # The ratio epsilon is computed for this check, but not used in the final calculation.\n        epsilon = k_val / (a_i * H_i / c)\n        if not epsilon  0.1: # A generous check for k  aH/c\n             # This block would handle invalid cases, but all test cases are valid.\n             pass\n\n        # As derived in the solution, the difference |zeta_SU - zeta_lin| is\n        # |ln(1+delta_i) - delta_i| / (3*(1+w)).\n        # The parameters a_i, rho_i, rho_f, and k define the physical context but\n        # cancel out of this specific calculation.\n\n        numerator = np.abs(np.log(1 + delta_i) - delta_i)\n        denominator = 3 * (1 + w)\n        diff = numerator / denominator\n        \n        results.append(diff)\n\n    # Format the final output as a comma-separated list of floating-point numbers\n    # in scientific notation, enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```", "id": "3471529"}]}