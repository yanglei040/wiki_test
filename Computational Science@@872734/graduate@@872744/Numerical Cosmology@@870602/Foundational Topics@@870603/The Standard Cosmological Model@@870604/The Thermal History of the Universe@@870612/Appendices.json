{"hands_on_practices": [{"introduction": "The universe's thermal history is fundamentally a story of its expansion and cooling. This exercise guides you through a cornerstone calculation in physical cosmology: charting the relationship between cosmic time $t$ and photon temperature $T$. By building a numerical model from first principles, you will move beyond simple power-law approximations and incorporate the changing effective number of relativistic species, $g_*(T)$, during the QCD crossover and electron-positron annihilation. This practice offers a direct, hands-on understanding of how these crucial microphysical events leave a measurable imprint on the macroscopic expansion history of the universe. [@problem_id:3499024]", "problem": "You are tasked with writing a complete, runnable program that numerically computes the cosmic time as a function of temperature, denoted by $t(T)$, across the Quantum Chromodynamics (QCD) crossover and electron-positron annihilation ($e^\\pm$) transitions in the early universe. You must compare the numerically computed $t(T)$ to a naive power-law estimate and quantify the distortion introduced by the temperature dependence of the effective degrees of freedom.\n\nThe foundational starting point is the radiation-dominated Friedmann-Lemaître-Robertson-Walker (FLRW) cosmology with the following fundamental laws and core definitions:\n\n- The Friedmann equation for a spatially flat universe, $H^2 = \\frac{8\\pi G_N}{3}\\rho$, where $H$ is the Hubble expansion rate, $G_N$ is Newton’s constant, and $\\rho$ is the energy density.\n- For a relativistic plasma, the energy density is $\\rho(T) = \\frac{\\pi^2}{30} g_*(T) T^4$, where $g_*(T)$ is the effective number of relativistic energy degrees of freedom and $T$ is the photon temperature.\n- The comoving entropy density is conserved, $s(T) a^3 = \\text{constant}$, where $s(T) = \\frac{2\\pi^2}{45} g_s(T) T^3$ is the entropy density and $g_s(T)$ is the effective number of relativistic entropy degrees of freedom, and $a$ is the scale factor.\n\nUsing these definitions, the program must derive from first principles the temperature-time relation by combining the Friedmann equation with entropy conservation. Specifically, you must obtain $dt/dT$ in terms of $H(T)$, $T$, $g_s(T)$, and $dg_s/dT$, starting from the above fundamentals without relying on pre-provided target formulas.\n\nThe temperature dependence of $g_*(T)$ and $g_s(T)$ must be modeled by smooth, scientifically plausible crossover functions that capture the QCD and $e^\\pm$ transitions (and the muon annihilation) via hyperbolic tangent steps. Define the transition shaping function\n$$\nS(T; T_0, \\Delta T) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right],\n$$\nwhich varies smoothly from $0$ at $T \\gg T_0$ to $1$ at $T \\ll T_0$. Use the following parameter values and reference degrees of freedom:\n\n- QCD crossover: $T_0^{\\mathrm{qcd}} = 155\\,\\mathrm{MeV}$, $\\Delta T^{\\mathrm{qcd}} = 50\\,\\mathrm{MeV}$.\n- Muon annihilation: $T_0^{\\mu} = 105\\,\\mathrm{MeV}$, $\\Delta T^{\\mu} = 20\\,\\mathrm{MeV}$.\n- Electron-positron annihilation: $T_0^{e} = 0.5\\,\\mathrm{MeV}$, $\\Delta T^{e} = 0.2\\,\\mathrm{MeV}$.\n- High-temperature baseline: $g_{\\mathrm{high}} = 61.75$.\n- Post-QCD baseline: $g_{\\mathrm{qcd}} = 17.25$.\n- Post-muon baseline: $g_{\\mu} = 10.75$.\n- Post-$e^\\pm$ baselines: $g_{*,e} = 3.36$ for the energy degrees and $g_{s,e} = 3.909$ for the entropy degrees.\n\nConstruct the energy and entropy degree functions as\n$$\ng_*(T) = g_{\\mathrm{high}} - \\left(g_{\\mathrm{high}} - g_{\\mathrm{qcd}}\\right) S(T; T_0^{\\mathrm{qcd}}, \\Delta T^{\\mathrm{qcd}})\n- \\left(g_{\\mathrm{qcd}} - g_{\\mu}\\right) S(T; T_0^{\\mu}, \\Delta T^{\\mu})\n- \\left(g_{\\mu} - g_{*,e}\\right) S(T; T_0^{e}, \\Delta T^{e}),\n$$\n$$\ng_s(T) = g_{\\mathrm{high}} - \\left(g_{\\mathrm{high}} - g_{\\mathrm{qcd}}\\right) S(T; T_0^{\\mathrm{qcd}}, \\Delta T^{\\mathrm{qcd}})\n- \\left(g_{\\mathrm{qcd}} - g_{\\mu}\\right) S(T; T_0^{\\mu}, \\Delta T^{\\mu})\n- \\left(g_{\\mu} - g_{s,e}\\right) S(T; T_0^{e}, \\Delta T^{e}).\n$$\nDerive and use $dg_s/dT$ consistent with the above $S(T)$.\n\nUse natural units with $\\hbar = c = k_B = 1$ inside the derivation and computation of $t(T)$, and convert to International System of Units (SI) seconds at the end using the conversion factor $1\\,\\mathrm{MeV}^{-1} = 6.582119569\\times 10^{-22}\\,\\mathrm{s}$. Use $G_N = 1/M_\\mathrm{Pl}^2$ with the (non-reduced) Planck mass $M_\\mathrm{Pl} = 1.2209\\times 10^{22}\\,\\mathrm{MeV}$.\n\nDefine the naive power-law estimate $t_{\\mathrm{naive}}(T)$ by assuming $g_s(T)$ is constant and $g_*(T)$ does not vary along the thermal trajectory; take $g_*$ fixed to the value at the final temperature $T$ for each test case, and perform the appropriate integral in temperature from a high-temperature reference $T_{\\mathrm{ref}}$ down to $T$.\n\nYour program must compute the dimensionless distortion\n$$\nD(T) = \\frac{t_{\\mathrm{true}}(T)}{t_{\\mathrm{naive}}(T)} - 1,\n$$\nwhere $t_{\\mathrm{true}}(T)$ is obtained by numerically integrating the derived $dt/dT$ (including the $g_s(T)$ and $g_*(T)$ variations) from $T_{\\mathrm{ref}}$ down to $T$ in $\\mathrm{MeV}$, and $t_{\\mathrm{naive}}(T)$ is computed under the above naive assumptions. All times must be expressed in seconds.\n\nImplement the following test suite using temperatures in megaelectronvolts (MeV):\n- Reference temperature: $T_{\\mathrm{ref}} = 5000\\,\\mathrm{MeV}$.\n- Target temperatures: $T \\in \\{150\\,\\mathrm{MeV}, 100\\,\\mathrm{MeV}, 20\\,\\mathrm{MeV}, 1\\,\\mathrm{MeV}, 0.1\\,\\mathrm{MeV}\\}$.\n\nDesign for coverage:\n- $T = 150\\,\\mathrm{MeV}$ probes the QCD crossover regime.\n- $T = 100\\,\\mathrm{MeV}$ probes the post-QCD, pre-muon annihilation regime.\n- $T = 20\\,\\mathrm{MeV}$ probes between muon and $e^\\pm$ transitions.\n- $T = 1\\,\\mathrm{MeV}$ probes just before $e^\\pm$ annihilation.\n- $T = 0.1\\,\\mathrm{MeV}$ probes well after $e^\\pm$ annihilation.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be the distortion $D(T)$ rounded to six decimal places. No other output is permitted.", "solution": "The problem requires the numerical computation of the cosmic time-temperature relation, $t(T)$, during the radiation-dominated era, accounting for the temperature-dependent effective degrees of freedom, $g_*(T)$ and $g_s(T)$. The result is to be compared with a naive estimate to quantify the distortion. The solution proceeds in two main stages: first, the derivation of the governing differential equation for $t(T)$ from first principles, and second, the design of a numerical algorithm to solve it.\n\n### Derivation of the Time-Temperature Relation\n\nThe evolution of the universe is governed by the Friedmann equation. For a spatially flat, radiation-dominated universe, this is:\n$$\nH^2 = \\left(\\frac{1}{a}\\frac{da}{dt}\\right)^2 = \\frac{8\\pi G_N}{3}\\rho(T)\n$$\nwhere $H$ is the Hubble parameter, $a$ is the scale factor, $G_N$ is Newton's gravitational constant, and $\\rho(T)$ is the energy density of the relativistic plasma. The energy density is given by:\n$$\n\\rho(T) = \\frac{\\pi^2}{30} g_*(T) T^4\n$$\nwhere $g_*(T)$ is the effective number of relativistic energy degrees of freedom and $T$ is the photon temperature. All calculations are performed in natural units ($\\hbar = c = k_B = 1$). Using the provided relation $G_N = 1/M_\\mathrm{Pl}^2$, where $M_\\mathrm{Pl} = 1.2209\\times 10^{22}\\,\\mathrm{MeV}$ is the non-reduced Planck mass, the Hubble parameter becomes:\n$$\nH(T) = \\sqrt{\\frac{8\\pi}{3 M_\\mathrm{Pl}^2} \\frac{\\pi^2}{30} g_*(T) T^4} = \\frac{T^2}{M_\\mathrm{Pl}} \\sqrt{\\frac{4\\pi^3 g_*(T)}{45}}\n$$\n\nThe second fundamental principle is the conservation of comoving entropy. The total entropy in a comoving volume, $S = s(T)a^3$, is constant. This implies its time derivative is zero:\n$$\n\\frac{d}{dt}(s a^3) = \\frac{ds}{dt}a^3 + s \\left(3a^2 \\frac{da}{dt}\\right) = 0\n$$\nUsing the chain rule, $\\frac{ds}{dt} = \\frac{ds}{dT}\\frac{dT}{dt}$, and the definition of the Hubble parameter, $H = \\frac{1}{a}\\frac{da}{dt}$, we find:\n$$\n\\frac{ds}{dT}\\frac{dT}{dt} a^3 + 3Hsa^3 = 0 \\implies \\frac{dT}{dt} = -3H \\frac{s}{ds/dT}\n$$\nThe entropy density $s(T)$ is given by $s(T) = \\frac{2\\pi^2}{45} g_s(T) T^3$. Its derivative with respect to temperature is:\n$$\n\\frac{ds}{dT} = \\frac{2\\pi^2}{45} \\left( \\frac{dg_s}{dT}T^3 + g_s(T) \\cdot 3T^2 \\right) = s(T) \\left( \\frac{1}{g_s(T)}\\frac{dg_s}{dT} + \\frac{3}{T} \\right)\n$$\nSubstituting this into the expression for $\\frac{dT}{dt}$:\n$$\n\\frac{dT}{dt} = -3H \\frac{s(T)}{s(T) \\left( \\frac{1}{g_s(T)}\\frac{dg_s}{dT} + \\frac{3}{T} \\right)} = -3H \\left( \\frac{T g_s(T)}{T \\frac{dg_s}{dT} + 3g_s(T)} \\right) = -HT \\left( \\frac{1}{1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT}} \\right)\n$$\nWe seek the rate of change of time with respect to temperature, $\\frac{dt}{dT}$, which is the reciprocal of $\\frac{dT}{dt}$:\n$$\n\\frac{dt}{dT} = -\\frac{1}{HT} \\left( 1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT} \\right)\n$$\nSubstituting the derived expression for $H(T)$, we obtain the final differential equation for the true time evolution, $t_{\\mathrm{true}}(T)$:\n$$\n\\frac{dt}{dT}\\bigg|_{\\mathrm{true}} = - \\frac{M_\\mathrm{Pl}}{T^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T)}} \\left( 1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT} \\right)\n$$\nThe elapsed time from a reference temperature $T_{\\mathrm{ref}}$ to a final temperature $T$ is found by integrating this expression:\n$$\nt_{\\mathrm{true}}(T) = \\int_{T_{\\mathrm{ref}}}^{T} \\frac{dt}{dT'}\\bigg|_{\\mathrm{true}} dT'\n$$\n\n### Naive Power-Law Estimate\nThe naive estimate, $t_{\\mathrm{naive}}(T)$, assumes that $g_s$ is constant (so $\\frac{dg_s}{dT} = 0$) and that $g_*$ is constant, fixed at its value at the final temperature, $g_*(T_{\\text{final}})$. Under these assumptions, the differential equation simplifies considerably:\n$$\n\\frac{dt}{dT}\\bigg|_{\\mathrm{naive}} = - \\frac{M_\\mathrm{Pl}}{T^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}}\n$$\nThis ODE can be integrated analytically from $T_{\\mathrm{ref}}$ to $T_{\\text{final}}$:\n$$\nt_{\\mathrm{naive}}(T_{\\text{final}}) = \\int_{T_{\\mathrm{ref}}}^{T_{\\text{final}}} \\left( - \\frac{M_\\mathrm{Pl}}{T'^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}} \\right) dT' = \\frac{M_\\mathrm{Pl}}{2} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}} \\left( \\frac{1}{T_{\\text{final}}^2} - \\frac{1}{T_{\\mathrm{ref}}^2} \\right)\n$$\n\n### Degrees of Freedom and Derivatives\nThe functions $g_*(T)$ and $g_s(T)$ are constructed using the provided shaping function $S(T; T_0, \\Delta T) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right]$. To evaluate the integrand for $t_{\\mathrm{true}}$, we need the analytic derivative of $g_s(T)$. The derivative of the shaping function is:\n$$\n\\frac{dS}{dT}(T; T_0, \\Delta T) = \\frac{d}{dT}\\left[\\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right)\\right] = -\\frac{1}{2\\Delta T} \\mathrm{sech}^2\\left(\\frac{T_0 - T}{\\Delta T}\\right)\n$$\nSince $g_s(T)$ is a linear combination of $S$ functions for the various transitions (QCD, muon, electron), its derivative $\\frac{dg_s}{dT}$ is the corresponding linear combination of $\\frac{dS}{dT}$ terms.\n\n### Numerical Implementation\nThe solution algorithm is as follows:\n1.  Define all physical constants ($M_\\mathrm{Pl}$, MeV-to-s conversion factor) and model parameters ($T_0, \\Delta T$, and baseline $g$ values for each transition).\n2.  Implement functions for $g_*(T)$, $g_s(T)$, and its analytical derivative $\\frac{dg_s}{dT}(T)$ based on the provided formulas.\n3.  For each target temperature $T_f$ in the test suite:\n    a. Numerically compute $t_{\\mathrm{true}}(T_f)$ by integrating $\\frac{dt}{dT}|_{\\mathrm{true}}$ from $T_{\\mathrm{ref}}$ to $T_f$. Since numerical integrators like `scipy.integrate.quad` typically require the lower limit to be less than the upper limit, we compute $t_{\\mathrm{true}}(T_f) = -\\int_{T_f}^{T_{\\mathrm{ref}}} \\frac{dt}{dT'}|_{\\mathrm{true}} dT' = \\int_{T_f}^{T_{\\mathrm{ref}}} \\left(-\\frac{dt}{dT'}|_{\\mathrm{true}}\\right) dT'$. The result is obtained in units of $\\mathrm{MeV}^{-1}$ and converted to seconds.\n    b. Analytically compute $t_{\\mathrm{naive}}(T_f)$ using its derived formula, where $g_*(T_{\\text{final}})$ is evaluated at $T_f$. The result is also obtained in $\\mathrm{MeV}^{-1}$ and converted to seconds.\n    c. Calculate the dimensionless distortion $D(T_f) = \\frac{t_{\\mathrm{true}}(T_f)}{t_{\\mathrm{naive}}(T_f)} - 1$.\n4.  Collect the distortion values, round them to six decimal places, and format the output as a comma-separated list in square brackets.\nThis procedure ensures a rigorous comparison between the accurate model and the simplified naive estimate, revealing the impact of entropy-releasing processes on the thermal history of the universe.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the distortion D(T) in the cosmic time-temperature relation\n    for a set of target temperatures in the early universe.\n    \"\"\"\n    # Define constants and parameters as per the problem statement\n    # Natural units: h_bar = c = k_B = 1\n    \n    # Physical constants\n    M_PL = 1.2209e22  # Non-reduced Planck mass in MeV\n    MEV_TO_S = 6.582119569e-22  # Conversion factor from MeV^-1 to s\n\n    # Transition parameters (T0 in MeV, dT in MeV)\n    T0_QCD, DT_QCD = 155.0, 50.0\n    T0_MU, DT_MU = 105.0, 20.0\n    T0_E, DT_E = 0.5, 0.2\n\n    # Degrees of freedom (g) baselines\n    G_HIGH = 61.75\n    G_QCD = 17.25\n    G_MU = 10.75\n    G_STAR_E = 3.36\n    G_S_E = 3.909\n\n    # Pre-calculate differences for g* and gs calculations\n    DG_QCD = G_HIGH - G_QCD\n    DG_MU = G_QCD - G_MU\n    DG_STAR_E = G_MU - G_STAR_E\n    DG_S_E = G_MU - G_S_E\n    \n    # Test suite parameters\n    T_REF = 5000.0  # Reference temperature in MeV\n    TARGET_TEMPS = [150.0, 100.0, 20.0, 1.0, 0.1] # Target temperatures in MeV\n\n    # --- Helper functions ---\n\n    def S(T, T0, dT):\n        \"\"\"Transition shaping function S(T; T0, dT).\"\"\"\n        return 0.5 * (1.0 + np.tanh((T0 - T) / dT))\n\n    def g_star(T):\n        \"\"\"Effective number of relativistic energy degrees of freedom g_*(T).\"\"\"\n        s_qcd = S(T, T0_QCD, DT_QCD)\n        s_mu = S(T, T0_MU, DT_MU)\n        s_e = S(T, T0_E, DT_E)\n        return G_HIGH - DG_QCD * s_qcd - DG_MU * s_mu - DG_STAR_E * s_e\n\n    def g_s(T):\n        \"\"\"Effective number of relativistic entropy degrees of freedom g_s(T).\"\"\"\n        s_qcd = S(T, T0_QCD, DT_QCD)\n        s_mu = S(T, T0_MU, DT_MU)\n        s_e = S(T, T0_E, DT_E)\n        return G_HIGH - DG_QCD * s_qcd - DG_MU * s_mu - DG_S_E * s_e\n\n    def dS_dT(T, T0, dT):\n        \"\"\"Derivative of the shaping function S with respect to T.\"\"\"\n        # sech(x)^2 = 1/cosh(x)^2\n        arg = (T0 - T) / dT\n        return -1.0 / (2.0 * dT * np.cosh(arg)**2)\n\n    def dg_s_dT(T):\n        \"\"\"Derivative of g_s(T) with respect to T.\"\"\"\n        dsdt_qcd = dS_dT(T, T0_QCD, DT_QCD)\n        dsdt_mu = dS_dT(T, T0_MU, DT_MU)\n        dsdt_e = dS_dT(T, T0_E, DT_E)\n        return -DG_QCD * dsdt_qcd - DG_MU * dsdt_mu - DG_S_E * dsdt_e\n    \n    # --- Integrand for dt/dT_true ---\n    # We compute -dt/dT, which is positive, and integrate from T_final to T_ref\n    # to get t_true = t(T_final) - t(T_ref).\n    \n    # Constant part of the expression for dt/dT: M_Pl * sqrt(45 / (4*pi^3))\n    const_integrand_part = M_PL * np.sqrt(45.0 / (4.0 * np.pi**3))\n\n    def true_integrand(T):\n        \"\"\"The function -dt/dT to be integrated for t_true.\"\"\"\n        g_star_val = g_star(T)\n        g_s_val = g_s(T)\n        dg_s_dT_val = dg_s_dT(T)\n        \n        term1 = const_integrand_part / (T**3 * np.sqrt(g_star_val))\n        term2 = 1.0 + (T / (3.0 * g_s_val)) * dg_s_dT_val\n        \n        return term1 * term2\n\n    results = []\n    for T_final in TARGET_TEMPS:\n        # --- 1. Calculate t_true ---\n        # Integrate from T_final (lower limit) to T_ref (upper limit).\n        integral_result, _ = integrate.quad(true_integrand, T_final, T_REF)\n        t_true_mev_inv = integral_result\n        t_true_s = t_true_mev_inv * MEV_TO_S\n\n        # --- 2. Calculate t_naive ---\n        g_star_final = g_star(T_final)\n        \n        # Coefficient for the naive calculation\n        c_naive = (M_PL / 2.0) * np.sqrt(45.0 / (4.0 * np.pi**3 * g_star_final))\n        \n        t_naive_mev_inv = c_naive * (1.0 / T_final**2 - 1.0 / T_REF**2)\n        t_naive_s = t_naive_mev_inv * MEV_TO_S\n\n        # --- 3. Calculate the distortion D(T) ---\n        distortion = t_true_s / t_naive_s - 1.0\n        results.append(f\"{distortion:.6f}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3499024"}, {"introduction": "Beyond the uniform background evolution, the early universe was filled with primordial density fluctuations that propagated as sound waves in the hot, dense photon-baryon plasma. This practice delves into the physics of Silk damping, the process by which photon diffusion inevitably erases these acoustic modes on small scales, dissipating their energy. By numerically implementing a model for this dissipation, you will calculate the resulting $\\mu$-distortion, a subtle but powerful signature in the Cosmic Microwave Background spectrum. This provides a tangible link between theoretical models of the primordial power spectrum and a potentially observable fossil from the pre-recombination era. [@problem_id:3498976]", "problem": "Consider a simplified, physically motivated model for the dissipation of small-scale primordial photon-baryon acoustic perturbations by photon diffusion (Silk damping) during the Cosmic Microwave Background (CMB) pre-decoupling era and the resulting spectral distortion in the CMB. In the tight-coupling regime of the photon-baryon fluid, spatial diffusion of photons damps acoustic modes with comoving wavenumber $k$ by a factor that is well-approximated near the center of the $\\mu$-distortion era by an exponential suppression window, with a characteristic comoving diffusion scale $k_{D}$. Let the primordial curvature power spectrum be parameterized by an amplitude $A_{s}$, a spectral tilt $n_{s}$ defined at a pivot $k_{p}$, and a running of the spectral index $\\alpha_{s}$, such that the spectrum is\n$$\nP_{\\zeta}(k) \\equiv A_{s} \\exp\\Big[(n_{s}-1)\\ln\\Big(\\frac{k}{k_{p}}\\Big) + \\frac{1}{2}\\alpha_{s}\\,\\ln^{2}\\Big(\\frac{k}{k_{p}}\\Big)\\Big].\n$$\nAssume that the fractional energy density dissipated by Silk damping in the $\\mu$-era is captured, in this simplified model, by an integral over $\\ln k$ of the primordial spectrum weighted by the diffusion suppression,\n$$\nQ_{\\mathrm{Silk}} \\propto \\int_{k_{\\min}}^{k_{\\max}} d\\ln k\\; P_{\\zeta}(k)\\,\\exp\\Big(-\\frac{2k^{2}}{k_{D}^{2}}\\Big),\n$$\nwhere $k_{\\min}$ and $k_{\\max}$ define the comoving wavenumber domain over which small-scale modes contribute appreciably and the proportionality constant is absorbed into the definition of $Q_{\\mathrm{Silk}}$ for the purposes of this numerical exercise. In this toy model, take the resulting chemical potential $\\mu$ of the CMB spectral distortion to be proportional to the fractional energy dissipated, with a constant conversion coefficient $C_{\\mu}$,\n$$\n\\mu = C_{\\mu}\\,Q_{\\mathrm{Silk}},\n$$\nwhich approximates the late-time mapping between energy injection and chemical potential when photon number-changing processes are inefficient while Compton scattering remains efficient.\n\nStarting strictly from the above definitions and the standard photon diffusion picture in the tight-coupling regime, and using the measure $d\\ln k$ consistently, derive an explicit one-dimensional integral expression for $Q_{\\mathrm{Silk}}$ in terms of $A_{s}$, $n_{s}$, $\\alpha_{s}$, $k_{p}$, and $k_{D}$, and then implement a numerically stable algorithm to evaluate $Q_{\\mathrm{Silk}}$ and the corresponding $\\mu$. Your algorithm must:\n\n- Treat $k$ in units of inverse megaparsecs, $\\mathrm{Mpc}^{-1}$.\n- Use $A_{s}$ as a dimensionless amplitude, $n_{s}$ and $\\alpha_{s}$ as dimensionless indices, $k_{p}$, $k_{D}$, $k_{\\min}$, and $k_{\\max}$ in $\\mathrm{Mpc}^{-1}$, and produce $Q_{\\mathrm{Silk}}$ and $\\mu$ as dimensionless floats.\n- Evaluate the integral with the measure $d\\ln k$ by integrating $k$ with the factor $1/k$ as needed to maintain consistency.\n- Implement numerically stable exponentials, avoiding overflow and underflow where possible, and ensure convergence across a wide parameter range.\n\nTest suite specification:\n\nEvaluate the pair $(Q_{\\mathrm{Silk}},\\mu)$ for the following six parameter sets that probe different small-scale tilts, runnings, and diffusion scales. Use $C_{\\mu} = 1.4$, $k_{p} = 0.05\\,\\mathrm{Mpc}^{-1}$, $k_{\\min} = 1\\,\\mathrm{Mpc}^{-1}$, and $k_{\\max} = 10^{4}\\,\\mathrm{Mpc}^{-1}$ for all cases unless otherwise stated.\n\n- Case $1$ (baseline red tilt, no running): $A_{s} = 2.1\\times 10^{-9}$, $n_{s} = 0.965$, $\\alpha_{s} = 0$, $k_{D} = 1300\\,\\mathrm{Mpc}^{-1}$.\n- Case $2$ (blue tilt, no running): $A_{s} = 2.1\\times 10^{-9}$, $n_{s} = 1.05$, $\\alpha_{s} = 0$, $k_{D} = 1300\\,\\mathrm{Mpc}^{-1}$.\n- Case $3$ (mild negative running): $A_{s} = 2.1\\times 10^{-9}$, $n_{s} = 0.97$, $\\alpha_{s} = -0.01$, $k_{D} = 1300\\,\\mathrm{Mpc}^{-1}$.\n- Case $4$ (positive running): $A_{s} = 2.1\\times 10^{-9}$, $n_{s} = 0.97$, $\\alpha_{s} = 0.02$, $k_{D} = 1300\\,\\mathrm{Mpc}^{-1}$.\n- Case $5$ (stronger damping window, smaller diffusion scale): $A_{s} = 2.1\\times 10^{-9}$, $n_{s} = 0.965$, $\\alpha_{s} = 0$, $k_{D} = 300\\,\\mathrm{Mpc}^{-1}$.\n- Case $6$ (weaker damping window, larger diffusion scale and blue tilt): $A_{s} = 2.1\\times 10^{-9}$, $n_{s} = 1.05$, $\\alpha_{s} = 0$, $k_{D} = 3000\\,\\mathrm{Mpc}^{-1}$.\n\nRequired final output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output $Q_{\\mathrm{Silk}}$ followed immediately by $\\mu$, so the twelve numbers for the six cases appear in order as $[Q_{1},\\mu_{1},Q_{2},\\mu_{2},\\dots,Q_{6},\\mu_{6}]$. All quantities must be dimensionless floats. Angle units are not applicable, and no percentages are to be used anywhere; express all numerical values as decimals.", "solution": "The problem is assessed to be valid. It is scientifically grounded in a simplified but physically motivated model of Silk damping and CMB spectral distortions. The parameters and definitions provided are self-contained, consistent, and well-posed, permitting a unique numerical solution. The problem statement is objective and free of ambiguity.\n\nThe objective is to compute the fractional energy density dissipated, $Q_{\\mathrm{Silk}}$, and the resulting CMB chemical potential, $\\mu$, for several parameter sets. The governing equation for $Q_{\\mathrm{Silk}}$ is given as an integral over comoving wavenumber $k$:\n$$\nQ_{\\mathrm{Silk}} = \\int_{k_{\\min}}^{k_{\\max}} P_{\\zeta}(k)\\,\\exp\\Big(-\\frac{2k^{2}}{k_{D}^{2}}\\Big)\\,d\\ln k\n$$\nThe notation $Q_{\\mathrm{Silk}} \\propto \\dots$ in the problem description, combined with the instruction to treat the proportionality constant as absorbed, implies this equation should be treated as an equality for this numerical exercise. The primordial curvature power spectrum, $P_{\\zeta}(k)$, is defined as:\n$$\nP_{\\zeta}(k) = A_{s} \\exp\\Big[(n_{s}-1)\\ln\\Big(\\frac{k}{k_{p}}\\Big) + \\frac{1}{2}\\alpha_{s}\\,\\ln^{2}\\Big(\\frac{k}{k_{p}}\\Big)\\Big]\n$$\nTo implement a numerically stable algorithm, we first address the integral measure $d\\ln k$. A change of variables is the most effective strategy. Let the integration variable be $u = \\ln k$. This transformation yields $k = e^u$ and, most importantly, $d\\ln k = du$. The integration limits in the new variable become $u_{\\min} = \\ln k_{\\min}$ and $u_{\\max} = \\ln k_{\\max}$.\n\nThe integral for $Q_{\\mathrm{Silk}}$ transforms to:\n$$\nQ_{\\mathrm{Silk}} = \\int_{\\ln k_{\\min}}^{\\ln k_{\\max}} P_{\\zeta}(e^u)\\,\\exp\\Big(-\\frac{2(e^u)^{2}}{k_{D}^{2}}\\Big)\\,du\n$$\nNext, we express the argument of the integral, the integrand, fully in terms of $u$. The terms within $P_{\\zeta}(k)$ become:\n$$\n\\ln\\Big(\\frac{k}{k_{p}}\\Big) = \\ln\\Big(\\frac{e^u}{k_{p}}\\Big) = u - \\ln k_{p}\n$$\nSubstituting this into the expression for $P_{\\zeta}(k)$ gives:\n$$\nP_{\\zeta}(e^u) = A_{s} \\exp\\Big[(n_{s}-1)(u - \\ln k_{p}) + \\frac{1}{2}\\alpha_{s}(u - \\ln k_{p})^{2}\\Big]\n$$\nThe full integrand, which we shall call $I(u)$, is the product of $P_{\\zeta}(e^u)$ and the exponential damping term. For superior numerical stability, it is advantageous to combine the arguments of all exponential functions into a single `exp` call.\n$$\nI(u) = P_{\\zeta}(e^u) \\exp\\Big(-\\frac{2e^{2u}}{k_{D}^{2}}\\Big) = A_{s} \\exp\\Big[(n_{s}-1)(u - \\ln k_{p}) + \\frac{1}{2}\\alpha_{s}(u - \\ln k_{p})^{2} - \\frac{2e^{2u}}{k_{D}^{2}}\\Big]\n$$\nThis form avoids the multiplication of potentially very large or very small numbers, mitigating the risk of floating-point overflow or underflow. The integral to be computed is now a standard one-dimensional definite integral over a finite interval $[\\ln k_{\\min}, \\ln k_{\\max}]$:\n$$\nQ_{\\mathrm{Silk}} = \\int_{\\ln k_{\\min}}^{\\ln k_{\\max}} I(u)\\,du\n$$\nThis integral can be robustly and accurately evaluated using a standard numerical quadrature algorithm, such as the `quad` function from the `scipy.integrate` library in Python.\n\nFinally, once the value of $Q_{\\mathrm{Silk}}$ is determined for a given set of parameters $\\{A_s, n_s, \\alpha_s, k_p, k_D, k_{\\min}, k_{\\max}\\}$, the corresponding chemical potential $\\mu$ is calculated via the simple linear relationship provided:\n$$\n\\mu = C_{\\mu}\\,Q_{\\mathrm{Silk}}\n$$\nwhere $C_{\\mu}$ is a given constant.\n\nThe algorithm proceeds as follows for each test case:\n1.  Define the integrand function $I(u)$ as specified above, parameterized by $A_s$, $n_s$, $\\alpha_s$, $k_p$, and $k_D$.\n2.  Set the integration limits $u_{\\min} = \\ln k_{\\min}$ and $u_{\\max} = \\ln k_{\\max}$.\n3.  Numerically evaluate the integral of $I(u)$ from $u_{\\min}$ to $u_{\\max}$ to find $Q_{\\mathrm{Silk}}$.\n4.  Calculate $\\mu = C_{\\mu} \\times Q_{\\mathrm{Silk}}$.\n5.  Store the resulting pair $(Q_{\\mathrm{Silk}}, \\mu)$.\nThis procedure is repeated for all specified parameter sets.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the Silk damping energy dissipation Q_Silk and the resulting\n    CMB chemical potential mu for a series of cosmological parameter sets.\n    \"\"\"\n    \n    # Common parameters for all test cases\n    C_mu = 1.4\n    k_p = 0.05  # Mpc^-1\n    k_min = 1.0  # Mpc^-1\n    k_max = 10000.0  # Mpc^-1\n\n    # Define the six test cases\n    test_cases = [\n        # (As, ns, alphas, kD)\n        (2.1e-9, 0.965, 0.0, 1300.0),      # Case 1\n        (2.1e-9, 1.05, 0.0, 1300.0),       # Case 2\n        (2.1e-9, 0.97, -0.01, 1300.0),     # Case 3\n        (2.1e-9, 0.97, 0.02, 1300.0),      # Case 4\n        (2.1e-9, 0.965, 0.0, 300.0),       # Case 5\n        (2.1e-9, 1.05, 0.0, 3000.0),       # Case 6\n    ]\n\n    results = []\n\n    def integrand(u, A_s, n_s, alpha_s, k_p_val, k_D_val):\n        \"\"\"\n        The integrand for Q_Silk after a change of variables u = ln(k).\n        \n        Args:\n            u: The integration variable, ln(k).\n            A_s: Amplitude of the primordial power spectrum.\n            n_s: Spectral tilt.\n            alpha_s: Running of the spectral index.\n            k_p_val: Pivot scale in Mpc^-1.\n            k_D_val: Diffusion scale in Mpc^-1.\n        \n        Returns:\n            The value of the integrand at u.\n        \"\"\"\n        log_kp = np.log(k_p_val)\n        log_k_over_kp = u - log_kp\n        \n        # Combine all terms inside a single exponential for numerical stability\n        exponent = (\n            (n_s - 1.0) * log_k_over_kp\n            + 0.5 * alpha_s * log_k_over_kp**2\n            - 2.0 * np.exp(2.0 * u) / k_D_val**2\n        )\n        \n        return A_s * np.exp(exponent)\n\n    # Set integration limits based on the change of variable u = ln(k)\n    u_min = np.log(k_min)\n    u_max = np.log(k_max)\n\n    for case in test_cases:\n        A_s, n_s, alpha_s, k_D = case\n        \n        # Perform the numerical integration\n        # Pass parameters to the integrand via the `args` tuple\n        q_silk, _ = quad(integrand, u_min, u_max, args=(A_s, n_s, alpha_s, k_p, k_D))\n        \n        # Calculate the chemical potential mu\n        mu = C_mu * q_silk\n        \n        results.append(q_silk)\n        results.append(mu)\n\n    # Format the final output string as specified\n    formatted_results = [f\"{val:.10e}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3498976"}, {"introduction": "The epoch of recombination, when the universe transitioned from an ionized plasma to a neutral gas, is a pivotal event that set the stage for the formation of stars and galaxies. Governed by the Saha equation in its early stages, the free electron fraction $x_e$ is sensitive to the underlying cosmological parameters. This analytical practice employs the powerful technique of linear response theory to derive how $x_e$ responds to small changes in the baryon density, $\\Omega_b h^2$, and the primordial helium fraction, $Y_p$. Mastering this type of sensitivity analysis is crucial for understanding how precise CMB measurements are used to constrain our cosmological model. [@problem_id:3499136]", "problem": "Consider the hydrogen recombination epoch of the early universe at a fixed redshift $z_{\\star}$ in the regime where thermodynamic equilibrium between matter and radiation holds and the ionization state of hydrogen is well described by the Saha equation. Assume that helium has already become neutral by $z_{\\star}$ so that it does not contribute free electrons, and that the photon temperature scales adiabatically with redshift, $T(z)=T_{0}(1+z)$, with $T_{0}$ held fixed. Define the free-electron fraction relative to hydrogen nuclei as $x_{e}(z)\\equiv n_{e}(z)/n_{H}(z)$, where $n_{H}(z)$ is the number density of hydrogen nuclei. Let the primordial helium mass fraction be $Y_{p}$, the present-day physical baryon density parameter be $\\Omega_{b}h^{2}$, and the effective number of relativistic neutrino species be $N_{\\rm eff}$.\n\nIn the Saha-equilibrium regime for hydrogen, the ionization balance is given implicitly by an equation of the form\n$$\nF\\!\\left(x_{e};\\,n_{H},T\\right)\\equiv \\frac{x_{e}^{2}}{1-x_{e}}-\\frac{A(T)}{n_{H}}=0,\n$$\nwhere $A(T)$ is a known function of $T$ containing constants of nature and the hydrogen ionization energy. You may treat $A(T)$ as independent of the cosmological parameters except through its explicit dependence on $T$, and you may assume $T$ is independent of $\\Omega_{b}h^{2}$, $Y_{p}$, and $N_{\\rm eff}$ at fixed $z_{\\star}$ under the conditions stated. The hydrogen number density can be written as $n_{H}(z)=(1-Y_{p})\\,\\bar{n}_{b}(z)$ with the baryon number density $\\bar{n}_{b}(z)$ proportional to $\\Omega_{b}h^{2}(1+z)^{3}$.\n\nUsing linear response (implicit differentiation) around a fiducial cosmological model with parameters $\\left\\{(\\Omega_{b}h^{2})^{\\star},\\,Y_{p}^{\\star},\\,N_{\\rm eff}^{\\star}\\right\\}$ at the fixed redshift $z_{\\star}$, derive closed-form analytic expressions for the parameter derivatives $\\partial x_{e}/\\partial(\\Omega_{b}h^{2})$, $\\partial x_{e}/\\partial Y_{p}$, and $\\partial x_{e}/\\partial N_{\\rm eff}$ evaluated at the fiducial model. Express your final result as a single row matrix containing the three derivatives, in terms of the fiducial quantities $x_{e}^{\\star}\\equiv x_{e}(z_{\\star})$, $(\\Omega_{b}h^{2})^{\\star}$, and $Y_{p}^{\\star}$. No numerical evaluation is required. State your final answer as a closed-form analytic expression. Do not include units in your final answer.", "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, and self-consistent. It presents a standard problem in physical cosmology that can be solved using established mathematical methods. We may therefore proceed with the derivation.\n\nThe core of the problem lies in the implicit definition of the free-electron fraction, $x_e$, through the Saha equation at a fixed redshift $z_{\\star}$:\n$$\nF\\!\\left(x_{e};\\,n_{H},T\\right)\\equiv \\frac{x_{e}^{2}}{1-x_{e}}-\\frac{A(T)}{n_{H}}=0\n$$\nHere, $x_e$ is implicitly a function of the cosmological parameters $\\boldsymbol{\\lambda} = \\{\\Omega_b h^2, Y_p, N_{\\rm eff}\\}$ through the hydrogen number density $n_H$. The temperature $T$ at the fixed redshift $z_{\\star}$ is given by $T(z_{\\star}) = T_0(1+z_{\\star})$ and is assumed to be independent of these cosmological parameters. Consequently, the function $A(T)$ is also independent of these parameters.\n\nTo find the derivatives $\\partial x_e / \\partial \\lambda_i$ for each parameter $\\lambda_i \\in \\boldsymbol{\\lambda}$, we use the technique of implicit differentiation. The total differential of $F$ must be zero:\n$$\ndF = \\frac{\\partial F}{\\partial x_e} dx_e + \\sum_i \\frac{\\partial F}{\\partial \\lambda_i} d\\lambda_i = 0\n$$\nFrom this, the partial derivative of $x_e$ with respect to a single parameter $\\lambda$ is given by:\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = -\\left(\\frac{\\partial F}{\\partial x_e}\\right)^{-1} \\frac{\\partial F}{\\partial \\lambda}\n$$\nFirst, we compute the partial derivative of $F$ with respect to $x_e$:\n$$\n\\frac{\\partial F}{\\partial x_e} = \\frac{\\partial}{\\partial x_e} \\left( \\frac{x_e^2}{1-x_e} \\right) = \\frac{2x_e(1-x_e) - x_e^2(-1)}{(1-x_e)^2} = \\frac{2x_e - 2x_e^2 + x_e^2}{(1-x_e)^2} = \\frac{x_e(2-x_e)}{(1-x_e)^2}\n$$\nNext, we compute the partial derivative of $F$ with respect to a generic parameter $\\lambda$. Since $A(T)$ is constant with respect to the parameters at fixed $z_{\\star}$, the derivative only acts on the $n_H$ term:\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( -\\frac{A(T)}{n_H} \\right) = -A(T) \\left( -\\frac{1}{n_H^2} \\right) \\frac{\\partial n_H}{\\partial \\lambda} = \\frac{A(T)}{n_H^2} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\nWe can simplify this by substituting for $A(T)$ using the original Saha equation, $A(T) = n_H \\frac{x_e^2}{1-x_e}$:\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{1}{n_H^2} \\left( n_H \\frac{x_e^2}{1-x_e} \\right) \\frac{\\partial n_H}{\\partial \\lambda} = \\frac{x_e^2}{(1-x_e) n_H} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\nCombining these results, we obtain a general expression for the desired derivatives:\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = -\\left( \\frac{x_e(2-x_e)}{(1-x_e)^2} \\right)^{-1} \\left( \\frac{x_e^2}{(1-x_e) n_H} \\frac{\\partial n_H}{\\partial \\lambda} \\right) = -\\frac{(1-x_e)^2}{x_e(2-x_e)} \\frac{x_e^2}{(1-x_e)} \\frac{1}{n_H} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\nThis simplifies to:\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( \\frac{1}{n_H} \\frac{\\partial n_H}{\\partial \\lambda} \\right)\n$$\nNow, we must determine the dependence of $n_H$ on each parameter. The hydrogen number density at redshift $z$ is $n_H(z) = (1-Y_p)\\bar{n}_b(z)$, where the total baryon number density $\\bar{n}_b(z)$ is proportional to $\\Omega_b h^2 (1+z)^3$. Let the constant of proportionality be $C_{\\rho}$, giving $\\bar{n}_b(z) = C_{\\rho} (\\Omega_b h^2) (1+z)^3$. At our fixed redshift $z_{\\star}$, we can write:\n$$\nn_H = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) (\\Omega_b h^2)\n$$\nWe can now compute the logarithmic derivative of $n_H$ for each parameter.\n\n1.  **Derivative with respect to $\\Omega_b h^2$:**\n    The partial derivative of $n_H$ with respect to $\\Omega_b h^2$ is:\n    $$\n    \\frac{\\partial n_H}{\\partial (\\Omega_b h^2)} = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) = \\frac{n_H}{\\Omega_b h^2}\n    $$\n    Therefore, the logarithmic derivative is $\\frac{1}{n_H} \\frac{\\partial n_H}{\\partial (\\Omega_b h^2)} = \\frac{1}{\\Omega_b h^2}$.\n    Substituting this into our general expression for $\\partial x_e/\\partial\\lambda$:\n    $$\n    \\frac{\\partial x_e}{\\partial (\\Omega_b h^2)} = - \\frac{x_e(1-x_e)}{2-x_e} \\frac{1}{\\Omega_b h^2}\n    $$\n\n2.  **Derivative with respect to $Y_p$:**\n    The partial derivative of $n_H$ with respect to $Y_p$ is:\n    $$\n    \\frac{\\partial n_H}{\\partial Y_p} = C_{\\rho} (1+z_{\\star})^3 (\\Omega_b h^2) (-1) = -\\frac{n_H}{1-Y_p}\n    $$\n    Therefore, the logarithmic derivative is $\\frac{1}{n_H} \\frac{\\partial n_H}{\\partial Y_p} = -\\frac{1}{1-Y_p}$.\n    Substituting this into our general expression:\n    $$\n    \\frac{\\partial x_e}{\\partial Y_p} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( -\\frac{1}{1-Y_p} \\right) = \\frac{x_e(1-x_e)}{(2-x_e)(1-Y_p)}\n    $$\n\n3.  **Derivative with respect to $N_{\\rm eff}$:**\n    According to the problem statement, the expression for $n_H = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) (\\Omega_b h^2)$ does not depend on $N_{\\rm eff}$. The temperature $T$ at fixed $z_{\\star}$ is also stated to be independent of $N_{\\rm eff}$. Therefore, within the specified model, $x_e$ at fixed $z_{\\star}$ has no dependence on $N_{\\rm eff}$.\n    Formally,\n    $$\n    \\frac{\\partial n_H}{\\partial N_{\\rm eff}} = 0\n    $$\n    which implies:\n    $$\n    \\frac{\\partial x_e}{\\partial N_{\\rm eff}} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( \\frac{1}{n_H} \\cdot 0 \\right) = 0\n    $$\n\nFinally, we evaluate these expressions at the fiducial cosmological model, replacing the parameters with their fiducial values, denoted by a superscript $\\star$:\n$$\n\\left. \\frac{\\partial x_e}{\\partial (\\Omega_b h^2)} \\right|_{\\star} = - \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(\\Omega_b h^2)^{\\star}}\n$$\n$$\n\\left. \\frac{\\partial x_e}{\\partial Y_p} \\right|_{\\star} = \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(1-Y_p^{\\star})}\n$$\n$$\n\\left. \\frac{\\partial x_e}{\\partial N_{\\rm eff}} \\right|_{\\star} = 0\n$$\nThe problem requests the final result as a single row matrix containing these three derivatives.", "answer": "$$\n\\boxed{\\begin{pmatrix} - \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(\\Omega_b h^2)^{\\star}}  \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(1-Y_p^{\\star})}  0 \\end{pmatrix}}\n$$", "id": "3499136"}]}