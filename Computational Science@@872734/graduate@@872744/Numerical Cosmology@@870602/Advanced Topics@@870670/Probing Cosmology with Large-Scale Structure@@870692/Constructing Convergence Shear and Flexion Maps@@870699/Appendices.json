{"hands_on_practices": [{"introduction": "The cornerstone of weak lensing mass mapping is the ability to invert the observed shear field to reconstruct the projected mass density, or convergence. This exercise provides a foundational, hands-on test of this process using the celebrated Kaiser-Squires relation. By analytically inverting the shear field of a Singular Isothermal Sphere—a classic and physically important lens model—you will solidify your understanding of the fundamental connection between shear and convergence in Fourier space. [@problem_id:3468573]", "problem": "Consider a statistically isotropic weak-lensing field generated by a Singular Isothermal Sphere (SIS), where the lens is centered at the origin of the angular coordinate plane with angular position vector $\\boldsymbol{\\theta} = (\\theta_{x}, \\theta_{y})$ and radial coordinate $\\theta = |\\boldsymbol{\\theta}| = \\sqrt{\\theta_{x}^{2} + \\theta_{y}^{2}}$. The observed complex shear is specified by its Cartesian components,\n$$\n\\gamma_{1}(\\theta_{x}, \\theta_{y}) = -\\frac{\\theta_{E}}{2}\\,\\frac{\\theta_{x}^{2} - \\theta_{y}^{2}}{\\left(\\theta_{x}^{2} + \\theta_{y}^{2}\\right)^{3/2}}, \n\\qquad\n\\gamma_{2}(\\theta_{x}, \\theta_{y}) = -\\frac{\\theta_{E}}{2}\\,\\frac{2\\,\\theta_{x}\\,\\theta_{y}}{\\left(\\theta_{x}^{2} + \\theta_{y}^{2}\\right)^{3/2}},\n$$\nwhere $\\theta_{E}  0$ is a constant angle parameter (the Einstein radius), and the shear is purely tangential around the origin. Assume the field is defined over the full plane and is free of curl-type (B-mode) systematics. Using the Fourier-space relation between shear and convergence derived from the lensing potential, invert the given shear to reconstruct the convergence $\\kappa(\\boldsymbol{\\theta})$ as a closed-form function of $\\theta$. Then compare the recovered $\\kappa(\\boldsymbol{\\theta})$ to the SIS expectation that it scales as $\\theta^{-1}$, and state the final expression for $\\kappa(\\theta)$ in simplest form. Express your final answer as a single analytical expression depending only on $\\theta$ and $\\theta_{E}$. Do not include any integrals in your final expression. No rounding is required, and no units should be included in the final expression.", "solution": "The problem requires the reconstruction of the convergence field $\\kappa(\\boldsymbol{\\theta})$ from the given shear components $\\gamma_1(\\boldsymbol{\\theta})$ and $\\gamma_2(\\boldsymbol{\\theta})$ for a Singular Isothermal Sphere (SIS) lens, using Fourier-space methods.\n\nFirst, we perform a validation of the problem statement.\n\n**Step 1: Extract Givens**\n- Lens model: Singular Isothermal Sphere (SIS) centered at the origin.\n- Angular position vector: $\\boldsymbol{\\theta} = (\\theta_{x}, \\theta_{y})$.\n- Radial coordinate: $\\theta = |\\boldsymbol{\\theta}| = \\sqrt{\\theta_{x}^{2} + \\theta_{y}^{2}}$.\n- Shear components:\n$$\n\\gamma_{1}(\\theta_{x}, \\theta_{y}) = -\\frac{\\theta_{E}}{2}\\,\\frac{\\theta_{x}^{2} - \\theta_{y}^{2}}{\\left(\\theta_{x}^{2} + \\theta_{y}^{2}\\right)^{3/2}}\n$$\n$$\n\\gamma_{2}(\\theta_{x}, \\theta_{y}) = -\\frac{\\theta_{E}}{2}\\,\\frac{2\\,\\theta_{x}\\,\\theta_{y}}{\\left(\\theta_{x}^{2} + \\theta_{y}^{2}\\right)^{3/2}}\n$$\n- Constant parameter: $\\theta_{E}  0$ (Einstein radius).\n- Condition: The shear is purely tangential.\n- Condition: The field is free of curl-type (B-mode) systematics.\n- Task: Invert the shear to find the convergence $\\kappa(\\boldsymbol{\\theta})$ as a closed-form function of $\\theta$ using Fourier-space relations. Compare the result with the expected $\\theta^{-1}$ scaling.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-posed and scientifically grounded. The given shear components are the correct expressions for a weak lensing field generated by an SIS potential, $\\psi(\\boldsymbol{\\theta}) = \\theta_E |\\boldsymbol{\\theta}|$. The relations $\\gamma_1 = \\frac{1}{2}(\\psi_{xx} - \\psi_{yy})$ and $\\gamma_2 = \\psi_{xy}$ (where subscripts on $\\psi$ denote partial derivatives with respect to $\\theta_x$ and $\\theta_y$) correctly yield the provided expressions. The condition of no B-modes is necessary for a unique inversion from shear to convergence and is consistent with the shear being derived from a scalar potential. The problem is a standard exercise in weak lensing theory. Therefore, the problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed to the solution.\n\nThe fundamental quantities of weak lensing, the convergence $\\kappa$ and the complex shear $\\gamma = \\gamma_1 + i\\gamma_2$, are related to the second derivatives of the lensing potential $\\psi(\\boldsymbol{\\theta})$. These relationships are most conveniently expressed in Fourier space. Let $\\hat{f}(\\boldsymbol{\\ell})$ denote the two-dimensional Fourier transform of a function $f(\\boldsymbol{\\theta})$, where $\\boldsymbol{\\ell}$ is the Fourier conjugate variable to $\\boldsymbol{\\theta}$. The relations are:\n$$\n\\hat{\\kappa}(\\boldsymbol{\\ell}) = \\frac{1}{2}(\\ell_x^2 + \\ell_y^2) \\hat{\\psi}(\\boldsymbol{\\ell}) = \\frac{1}{2}\\ell^2 \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\n$$\n\\hat{\\gamma}_1(\\boldsymbol{\\ell}) = \\frac{1}{2}(\\ell_x^2 - \\ell_y^2) \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\n$$\n\\hat{\\gamma}_2(\\boldsymbol{\\ell}) = \\ell_x \\ell_y \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\nwhere $\\ell = |\\boldsymbol{\\ell}|$. The Fourier transform of the complex shear is $\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\hat{\\gamma}_1(\\boldsymbol{\\ell}) + i\\hat{\\gamma}_2(\\boldsymbol{\\ell})$. Combining the expressions for $\\hat{\\gamma}_1$ and $\\hat{\\gamma}_2$:\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\frac{1}{2}(\\ell_x^2 - \\ell_y^2 + 2i\\ell_x\\ell_y) \\hat{\\psi}(\\boldsymbol{\\ell}) = \\frac{1}{2}(\\ell_x + i\\ell_y)^2 \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\nExpressing the Fourier-space vector $\\boldsymbol{\\ell}$ in polar coordinates, $\\ell_x+i\\ell_y = \\ell e^{i\\phi_\\ell}$, where $\\phi_\\ell$ is the polar angle of $\\boldsymbol{\\ell}$, we have:\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\frac{1}{2}\\ell^2 e^{i2\\phi_\\ell} \\hat{\\psi}(\\boldsymbol{\\ell})\n$$\nBy comparing this with the expression for $\\hat{\\kappa}(\\boldsymbol{\\ell})$, we arrive at the pivotal Kaiser-Squires relation:\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\hat{\\kappa}(\\boldsymbol{\\ell}) e^{i2\\phi_\\ell}\n$$\nThis relation allows for the reconstruction of the convergence from the shear. Inverting for $\\hat{\\kappa}(\\boldsymbol{\\ell})$ gives:\n$$\n\\hat{\\kappa}(\\boldsymbol{\\ell}) = \\hat{\\gamma}(\\boldsymbol{\\ell}) e^{-i2\\phi_\\ell}\n$$\nThe problem now reduces to computing the Fourier transform of the given shear field and then applying this inversion formula.\n\nFirst, let's express the given shear field in complex form.\n$$\n\\gamma(\\boldsymbol{\\theta}) = \\gamma_1 + i\\gamma_2 = -\\frac{\\theta_E}{2} \\frac{(\\theta_x^2 - \\theta_y^2) + i(2\\theta_x\\theta_y)}{(\\theta_x^2+\\theta_y^2)^{3/2}}\n$$\nThe numerator is $(\\theta_x + i\\theta_y)^2$. In polar coordinates for $\\boldsymbol{\\theta}$, we have $\\theta_x+i\\theta_y = \\theta e^{i\\phi}$. The denominator is simply $\\theta^3$.\n$$\n\\gamma(\\boldsymbol{\\theta}) = -\\frac{\\theta_E}{2} \\frac{(\\theta e^{i\\phi})^2}{\\theta^3} = -\\frac{\\theta_E}{2\\theta} e^{i2\\phi}\n$$\nThis form shows the characteristic quadrupolar ($e^{i2\\phi}$) nature of a shear field and its $\\theta^{-1}$ dependence for an SIS.\n\nNext, we calculate the 2D Fourier transform of $\\gamma(\\boldsymbol{\\theta})$:\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\int d^2\\theta \\, \\gamma(\\boldsymbol{\\theta}) e^{-i\\boldsymbol{\\ell} \\cdot \\boldsymbol{\\theta}} = \\int d^2\\theta \\, \\left( -\\frac{\\theta_E}{2\\theta} e^{i2\\phi} \\right) e^{-i\\boldsymbol{\\ell} \\cdot \\boldsymbol{\\theta}}\n$$\nThe Fourier transform of a function of the form $f(\\theta, \\phi) = f_R(\\theta) e^{im\\phi}$ is given by:\n$$\n\\hat{f}(\\ell, \\phi_\\ell) = 2\\pi (-i)^m e^{im\\phi_\\ell} \\int_0^\\infty \\theta \\, f_R(\\theta) J_m(\\ell \\theta) d\\theta\n$$\nwhere $J_m$ is the Bessel function of the first kind of order $m$. For our shear field, we have $m=2$ and $f_R(\\theta) = - \\frac{\\theta_E}{2\\theta}$.\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = 2\\pi (-i)^2 e^{i2\\phi_\\ell} \\int_0^\\infty \\theta \\left( -\\frac{\\theta_E}{2\\theta} \\right) J_2(\\ell \\theta) d\\theta\n$$\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = -2\\pi e^{i2\\phi_\\ell} \\left( -\\frac{\\theta_E}{2} \\right) \\int_0^\\infty J_2(\\ell \\theta) d\\theta = \\pi \\theta_E e^{i2\\phi_\\ell} \\int_0^\\infty J_2(\\ell \\theta) d\\theta\n$$\nWe use the standard integral identity $\\int_0^\\infty J_\\nu(ax) dx = \\frac{1}{a}$, which is valid for $\\Re(\\nu)  -1$. For our case, $\\nu=2$ and $a=\\ell$, so the condition is satisfied.\n$$\n\\int_0^\\infty J_2(\\ell \\theta) d\\theta = \\frac{1}{\\ell}\n$$\nSubstituting this result into the expression for $\\hat{\\gamma}(\\boldsymbol{\\ell})$:\n$$\n\\hat{\\gamma}(\\boldsymbol{\\ell}) = \\frac{\\pi \\theta_E}{\\ell} e^{i2\\phi_\\ell}\n$$\nNow we apply the inversion formula $\\hat{\\kappa}(\\boldsymbol{\\ell}) = \\hat{\\gamma}(\\boldsymbol{\\ell}) e^{-i2\\phi_\\ell}$:\n$$\n\\hat{\\kappa}(\\boldsymbol{\\ell}) = \\left(\\frac{\\pi \\theta_E}{\\ell} e^{i2\\phi_\\ell}\\right) e^{-i2\\phi_\\ell} = \\frac{\\pi \\theta_E}{\\ell}\n$$\nThis is the Fourier transform of the convergence field. It is radially symmetric, depending only on $\\ell = |\\boldsymbol{\\ell}|$, as expected for a circularly symmetric lens.\n\nTo find $\\kappa(\\boldsymbol{\\theta})$, we take the inverse Fourier transform of $\\hat{\\kappa}(\\boldsymbol{\\ell})$:\n$$\n\\kappa(\\boldsymbol{\\theta}) = \\int \\frac{d^2\\ell}{(2\\pi)^2} \\hat{\\kappa}(\\ell) e^{i\\boldsymbol{\\ell} \\cdot \\boldsymbol{\\theta}}\n$$\nSince $\\hat{\\kappa}(\\ell)$ is radially symmetric, the resulting $\\kappa(\\boldsymbol{\\theta})$ will also be radially symmetric, i.e., $\\kappa(\\boldsymbol{\\theta})=\\kappa(\\theta)$. The integral is a 0-th order Hankel transform.\n$$\n\\kappa(\\theta) = \\frac{1}{(2\\pi)^2} \\int_0^\\infty \\ell d\\ell \\int_0^{2\\pi} d\\phi_\\ell \\left(\\frac{\\pi\\theta_E}{\\ell}\\right) e^{i\\ell\\theta \\cos(\\phi_\\ell)}\n$$\nWe have aligned $\\boldsymbol{\\theta}$ with the $x$-axis without loss of generality.\n$$\n\\kappa(\\theta) = \\frac{\\pi\\theta_E}{4\\pi^2} \\int_0^\\infty d\\ell \\int_0^{2\\pi} d\\phi_\\ell e^{i\\ell\\theta \\cos(\\phi_\\ell)}\n$$\nThe integral over $\\phi_\\ell$ is an integral representation of the Bessel function $J_0$: $\\int_0^{2\\pi}e^{ix \\cos\\phi} d\\phi = 2\\pi J_0(x)$.\n$$\n\\kappa(\\theta) = \\frac{\\theta_E}{4\\pi} \\int_0^\\infty 2\\pi J_0(\\ell\\theta) d\\ell = \\frac{\\theta_E}{2} \\int_0^\\infty J_0(\\ell\\theta) d\\ell\n$$\nUsing the same integral identity as before, $\\int_0^\\infty J_0(ax) dx = \\frac{1}{a}$, with $a=\\theta$.\n$$\n\\int_0^\\infty J_0(\\ell\\theta) d\\ell = \\frac{1}{\\theta}\n$$\nTherefore, the reconstructed convergence is:\n$$\n\\kappa(\\theta) = \\frac{\\theta_E}{2} \\cdot \\frac{1}{\\theta} = \\frac{\\theta_E}{2\\theta}\n$$\nThis recovered convergence profile, $\\kappa(\\theta) = \\frac{\\theta_E}{2\\theta}$, scales as $\\theta^{-1}$, which is precisely the expected result for a Singular Isothermal Sphere. The entire derivation is self-consistent and confirms the well-known properties of the SIS model.\n\nThe final expression for the convergence $\\kappa(\\theta)$ is given in its simplest form.", "answer": "$$ \\boxed{ \\frac{\\theta_{E}}{2\\theta} } $$", "id": "3468573"}, {"introduction": "While analytical inversions are insightful, real astronomical surveys are plagued by incomplete data from bright stars, detector gaps, and complex boundaries. This practice moves from the idealized plane to a more realistic numerical setting, tackling the critical systematic effect of mode mixing caused by applying a mask to the shear field. Through a hands-on coding exercise, you will implement the inversion from shear to both \"electric-mode\" convergence ($\\kappa_E$) and \"magnetic-mode\" convergence ($\\kappa_B$), quantify the spurious $\\kappa_B$ signal generated by a hard-edged mask, and demonstrate how a smoothing technique called apodization is essential for mitigating this E-to-B leakage. [@problem_id:3468591]", "problem": "Consider weak gravitational lensing on a flat sky domain, modeled on a two-dimensional periodic square grid. Start from the gravitational lensing potential $\\,\\psi(\\boldsymbol{\\theta})\\,$, the convergence $\\,\\kappa(\\boldsymbol{\\theta})\\,$, and the shear components $\\,\\gamma_1(\\boldsymbol{\\theta}),\\gamma_2(\\boldsymbol{\\theta})\\,$ defined by linear differential operators of $\\,\\psi\\,$. Assume a controlled mock mass distribution that yields a purely scalar potential $\\,\\psi\\,$ and hence a purely gradient-like (\"electric\") shear field with no curl-like (\"magnetic\") component. An observation is made through an arbitrary binary mask $\\,W_0(\\boldsymbol{\\theta})\\in\\{0,1\\}\\,$ that removes data in selected regions; the observed shear is then $\\,\\gamma^{\\mathrm{obs}}(\\boldsymbol{\\theta})=W(\\boldsymbol{\\theta})\\,\\gamma(\\boldsymbol{\\theta})\\,$ where $\\,W(\\boldsymbol{\\theta})\\,$ may include a smooth apodization that transitions from $\\,0\\,$ to $\\,1\\,$ near mask boundaries.\n\nYour tasks are:\n- Derive the linear inversion in Fourier space that maps the observed shear field to the \"electric-mode\" convergence $\\,\\kappa_E(\\boldsymbol{\\theta})\\,$ and the \"magnetic-mode\" convergence $\\,\\kappa_B(\\boldsymbol{\\theta})\\,$ on the flat sky. The derivation should start only from the fundamental relations between $\\,\\psi\\,$, $\\,\\kappa\\,$, and $\\,\\gamma\\,$, without assuming any pre-known inversion formula.\n- Propose an apodization function $\\,A(d)\\,$ that depends only on the distance $\\,d\\,$ to the nearest mask boundary and yields a smooth transition of $\\,W(\\boldsymbol{\\theta})\\,$ inside the masked region to reduce $\\,E/B\\,$ mixing. Justify the choice of $\\,A(d)\\,$ based on minimizing sharp-edge effects.\n- Implement a numerical experiment on a square grid to evaluate leakage, defined as the dimensionless ratio\n$$L \\equiv \\sqrt{\\frac{\\sum_{i} W_i \\,\\kappa_B(\\boldsymbol{\\theta}_i)^2}{\\sum_{i} W_i \\,\\kappa_E(\\boldsymbol{\\theta}_i)^2}},$$\nwhere the sum runs over pixels with $\\,W_i0\\,$, and demonstrate how apodization reduces $\\,L\\,$ compared to a hard (non-apodized) mask.\n\nUse the following controlled mock and grid configuration:\n- Square grid of linear size $\\,N=128\\,$ pixels with unit pixel spacing. Treat the domain as periodic for Fourier transforms. All fields are dimensionless; no physical units are required.\n- Convergence $\\,\\kappa(\\boldsymbol{\\theta})\\,$ is a superposition of two isotropic Gaussian clumps centered at positions $\\,\\boldsymbol{\\theta}_1=(N/4,N/4)\\,$ and $\\,\\boldsymbol{\\theta}_2=(3N/4,3N/4)\\,$ with amplitudes $\\,A_1=1.0\\,$ and $\\,A_2=0.8\\,$, and standard deviations $\\,\\sigma_1=5\\,$ pixels and $\\,\\sigma_2=8\\,$ pixels, respectively. Subtract the mean of $\\,\\kappa\\,$ so that the zero-mode is zero.\n- Compute $\\,\\psi(\\boldsymbol{\\theta})\\,$, $\\,\\gamma_1(\\boldsymbol{\\theta})\\,$, and $\\,\\gamma_2(\\boldsymbol{\\theta})\\,$ from $\\,\\kappa(\\boldsymbol{\\theta})\\,$ using Fourier derivatives on the periodic grid.\n\nDefine masks and apodization widths for the test suite as follows:\n1. Case 1 (baseline): No mask, i.e., $\\,W_0(\\boldsymbol{\\theta})=1\\,$ everywhere; apodization width $\\,w=0\\,$ pixels.\n2. Case 2 (hard circular hole): $\\,W_0(\\boldsymbol{\\theta})=0\\,$ inside a circle of radius $\\,r=12\\,$ pixels centered at $\\,\\boldsymbol{\\theta}=(N/2,N/2)\\,$, and $\\,W_0(\\boldsymbol{\\theta})=1\\,$ elsewhere; apodization width $\\,w=0\\,$ pixels.\n3. Case 3 (apodized circular hole): Same $\\,W_0\\,$ as Case 2 but with apodization width $\\,w=6\\,$ pixels.\n4. Case 4 (apodized vertical stripe hole): $\\,W_0(\\boldsymbol{\\theta})=0\\,$ for the central vertical stripe where $\\,|x-N/2|\\leq s\\,$ with $\\,s=6\\,$ pixels, and $\\,W_0(\\boldsymbol{\\theta})=1\\,$ elsewhere; apodization width $\\,w=6\\,$ pixels.\n\nFor apodization, construct $\\,W(\\boldsymbol{\\theta})\\,$ from $\\,W_0(\\boldsymbol{\\theta})\\,$ by smoothly tapering from $\\,0\\,$ to $\\,1\\,$ inside the unmasked region across a boundary layer of width $\\,w\\,$ pixels using the same $\\,A(d)\\,$ for all mask geometries. If $\\,w=0\\,$, set $\\,W(\\boldsymbol{\\theta})=W_0(\\boldsymbol{\\theta})\\,$.\n\nYour program must:\n- Implement the derivation-based inversion from observed shear to $\\,\\kappa_E\\,$ and $\\,\\kappa_B\\,$ on the flat sky.\n- Implement the proposed apodization $\\,A(d)\\,$ and apply it to each mask $\\,W_0\\,$ to produce $\\,W\\,$.\n- Compute the leakage metric $\\,L\\,$ for each case on the specified mock, and round each result to six decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each entry must be the float $\\,L\\,$ for the corresponding case in the order given above, rounded to six decimal places.\n\nThe test suite is thus the ordered list of parameter triplets $\\,(\\text{mask type},\\,\\text{mask parameter},\\,w)\\,$:\n- Case 1: $\\,(\\text{none},\\,0,\\,0)\\,$\n- Case 2: $\\,(\\text{circular},\\,r=12,\\,0)\\,$\n- Case 3: $\\,(\\text{circular},\\,r=12,\\,6)\\,$\n- Case 4: $\\,(\\text{stripe},\\,s=6,\\,6)\\,$", "solution": "The problem requires the derivation of the weak lensing E/B mode inversion for masked data, the proposal of an apodization scheme, and a numerical implementation to quantify E-B mode leakage. The problem is well-defined, scientifically grounded in the principles of cosmology and data analysis, and all necessary parameters for a numerical solution are provided.\n\n### 1. Derivation of the E/B Mode Inversion\n\nThe analysis begins from the fundamental relations connecting the gravitational lensing potential $\\psi(\\boldsymbol{\\theta})$, the convergence $\\kappa(\\boldsymbol{\\theta})$, and the two components of the shear field, $\\gamma_1(\\boldsymbol{\\theta})$ and $\\gamma_2(\\boldsymbol{\\theta})$, on a flat sky. These are given by second derivatives of the potential:\n$$ \\kappa = \\frac{1}{2}(\\partial_1^2 + \\partial_2^2)\\psi = \\frac{1}{2}\\nabla^2\\psi $$\n$$ \\gamma_1 = \\frac{1}{2}(\\partial_1^2 - \\partial_2^2)\\psi $$\n$$ \\gamma_2 = \\partial_1 \\partial_2 \\psi $$\nwhere $\\partial_i$ denotes the partial derivative with respect to the angular coordinate $\\theta_i$.\n\nThese relations simplify in Fourier space. Let $\\hat{f}(\\boldsymbol{k})$ denote the Fourier transform of a field $f(\\boldsymbol{\\theta})$. The derivative operator $\\partial_i$ transforms to multiplication by $i k_i$, where $k_i$ is the wavevector component. Thus, the relations become:\n$$ \\hat{\\kappa}(\\boldsymbol{k}) = -\\frac{1}{2}(k_1^2 + k_2^2)\\hat{\\psi}(\\boldsymbol{k}) = -\\frac{1}{2}k^2\\hat{\\psi}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = -\\frac{1}{2}(k_1^2 - k_2^2)\\hat{\\psi}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = -(k_1 k_2)\\hat{\\psi}(\\boldsymbol{k}) $$\nHere, $k^2 = k_1^2 + k_2^2$. For this problem, the underlying mass distribution is assumed to produce a pure E-mode (gradient-only) field, so $\\kappa$ is the true E-mode convergence. We can express the shear components in terms of the convergence by substituting $\\hat{\\psi}(\\boldsymbol{k}) = -2\\hat{\\kappa}(\\boldsymbol{k})/k^2$ (for $\\boldsymbol{k} \\neq \\boldsymbol{0}$):\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}(\\boldsymbol{k}) $$\n\nA general shear field can be decomposed into a curl-free E-mode part, sourced by a potential $\\kappa_E$, and a divergence-free B-mode part, sourced by a pseudo-potential $\\kappa_B$. The Fourier-space relations for a general shear field are:\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}_E(\\boldsymbol{k}) + \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}_B(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}_E(\\boldsymbol{k}) - \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}_B(\\boldsymbol{k}) $$\nThis represents a system of two linear equations for $\\hat{\\kappa}_E(\\boldsymbol{k})$ and $\\hat{\\kappa}_B(\\boldsymbol{k})$ at each wavevector $\\boldsymbol{k}$. Solving this system yields the inversion formulae. Multiplying the first equation by $(k_1^2 - k_2^2)/k^2$ and the second by $(2k_1 k_2)/k^2$ and adding them isolates $\\hat{\\kappa}_E$. Similarly, multiplying the first by $(2k_1 k_2)/k^2$ and the second by $-(k_1^2 - k_2^2)/k^2$ and adding isolates $\\hat{\\kappa}_B$. The inversion is:\n$$ \\hat{\\kappa}_E(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\gamma}_1(\\boldsymbol{k}) + \\frac{2k_1 k_2}{k^2}\\hat{\\gamma}_2(\\boldsymbol{k}) $$\n$$ \\hat{\\kappa}_B(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\gamma}_1(\\boldsymbol{k}) - \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\gamma}_2(\\boldsymbol{k}) $$\nThese expressions are defined for $\\boldsymbol{k} \\neq \\boldsymbol{0}$. The mean convergence, $\\hat{\\kappa}(\\boldsymbol{0})$, is unobservable from shear (the mass-sheet degeneracy), and we set $\\hat{\\kappa}_E(\\boldsymbol{0}) = \\hat{\\kappa}_B(\\boldsymbol{0}) = 0$.\n\nIn an observational setting, the true shear field $\\gamma(\\boldsymbol{\\theta})$ is multiplied by a window function (mask) $W(\\boldsymbol{\\theta})$, such that the observed shear is $\\gamma^{\\mathrm{obs}}(\\boldsymbol{\\theta}) = W(\\boldsymbol{\\theta})\\gamma(\\boldsymbol{\\theta})$. Multiplication in real space corresponds to convolution in Fourier space: $\\hat{\\gamma}^{\\mathrm{obs}}(\\boldsymbol{k}) = (\\hat{W} * \\hat{\\gamma})(\\boldsymbol{k})$. If $W(\\boldsymbol{\\theta})$ has sharp edges, its Fourier transform $\\hat{W}(\\boldsymbol{k})$ has broad, slowly decaying wings. This convolution mixes power between different Fourier modes. Since the E/B filters depend on the direction of $\\boldsymbol{k}$, this mode-mixing corrupts the separation, causing power from the pure E-mode signal to \"leak\" into the reconstructed B-mode map. The inversion procedure is thus applied to the Fourier transform of the *observed* fields, $\\hat{\\gamma}^{\\mathrm{obs}}_1$ and $\\hat{\\gamma}^{\\mathrm{obs}}_2$, which leads to a non-zero $\\kappa_B$ even if the original field was pure E-mode.\n\n### 2. Apodization Strategy\n\nTo mitigate the E/B leakage caused by sharp mask boundaries, the window function $W(\\boldsymbol{\\theta})$ must be smoothed. This process is known as apodization. A good apodization function smoothly transitions from $0$ to $1$ over a finite width $w$ at the mask edges. The problem asks for a function $A(d)$ that depends on the distance $d$ to the nearest masked region.\n\nWe propose a sine-squared (or cosine-bell) tapering function. Let $W_0(\\boldsymbol{\\theta})$ be the binary mask ($0$ in excluded regions, $1$ elsewhere). For any point $\\boldsymbol{\\theta}$ in the unmasked region ($W_0(\\boldsymbol{\\theta})=1$), let $d(\\boldsymbol{\\theta})$ be its Euclidean distance to the nearest point in the masked region. The apodized window $W(\\boldsymbol{\\theta})$ is defined as:\n$$\nW(\\boldsymbol{\\theta}) =\n\\begin{cases}\n    0  \\text{if } W_0(\\boldsymbol{\\theta}) = 0 \\\\\n    \\sin^2\\left(\\frac{\\pi d(\\boldsymbol{\\theta})}{2w}\\right)  \\text{if } W_0(\\boldsymbol{\\theta}) = 1 \\text{ and } d(\\boldsymbol{\\theta})  w \\\\\n    1  \\text{if } W_0(\\boldsymbol{\\theta}) = 1 \\text{ and } d(\\boldsymbol{\\theta}) \\ge w\n\\end{cases}\n$$\nThe justification for this choice is its smoothness. This function is continuous and has a continuous first derivative at the transition points $d=0$ (boundary of the original mask) and $d=w$ (inner edge of the apodization region). A function $f(x)$ with continuous derivatives has a Fourier transform $\\hat{f}(k)$ that decays faster at large $k$. By ensuring $W(\\boldsymbol{\\theta})$ and its first derivative are continuous, we suppress the high-frequency power in $\\hat{W}(\\boldsymbol{k})$, narrowing its core and reducing the extent of mode-mixing, thereby minimizing E/B leakage.\n\n### 3. Numerical Experiment Design\n\nThe numerical experiment is designed to demonstrate the effectiveness of apodization. The procedure is as follows:\n1.  **Grid and Mock Field:** A $128 \\times 128$ pixel grid is defined. The true convergence field $\\kappa(\\boldsymbol{\\theta})$ is constructed as a superposition of two Gaussian clumps with specified parameters. Its mean is subtracted to ensure $\\hat{\\kappa}(\\boldsymbol{0}) = 0$.\n2.  **True Shear Generation:** The true shear fields $\\gamma_1(\\boldsymbol{\\theta})$ and $\\gamma_2(\\boldsymbol{\\theta})$ are generated from $\\kappa(\\boldsymbol{\\theta})$ using the Fourier space relations derived above. This involves FFT'ing $\\kappa$, applying the appropriate filters in $k$-space, and IFFT'ing back.\n3.  **Mask Application:** For each of the four test cases, the corresponding binary mask $W_0$ is created. The apodized mask $W$ is then constructed using the sine-squared tapering function with the specified width $w$. The observed shear fields $\\gamma_1^{\\mathrm{obs}}$ and $\\gamma_2^{\\mathrm{obs}}$ are obtained by multiplying the true shear fields by $W$.\n4.  **E/B Reconstruction:** The observed shear fields are Fourier transformed. The E/B inversion formulae are applied in Fourier space to obtain $\\hat{\\kappa}_E(\\boldsymbol{k})$ and $\\hat{\\kappa}_B(\\boldsymbol{k})$. These are then inverse Fourier transformed to yield the real-space maps $\\kappa_E(\\boldsymbol{\\theta})$ and $\\kappa_B(\\boldsymbol{\\theta})$.\n5.  **Leakage Calculation:** The leakage metric $L$ is calculated for each case using the formula:\n    $$ L = \\sqrt{\\frac{\\sum_{i} W_i \\,\\kappa_B(\\boldsymbol{\\theta}_i)^2}{\\sum_{i} W_i \\,\\kappa_E(\\boldsymbol{\\theta}_i)^2}} $$\n    This metric quantifies the ratio of power in the reconstructed B-mode to the E-mode, weighted by the mask itself to focus on the observed region. The results for the four cases will demonstrate that $L$ is negligible for the unmasked case, significant for a hard-edged mask, and substantially reduced by apodization.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.ndimage import distance_transform_edt\n\ndef create_mock_kappa(N, clumps):\n    \"\"\"Generates the mock convergence map.\"\"\"\n    y, x = np.meshgrid(np.arange(N), np.arange(N), indexing='ij')\n    kappa = np.zeros((N, N))\n    for clump in clumps:\n        A, (x0, y0), sigma = clump\n        dist_sq = (x - x0)**2 + (y - y0)**2\n        kappa += A * np.exp(-dist_sq / (2 * sigma**2))\n    \n    # Subtract the mean to ensure the DC mode is zero.\n    kappa -= np.mean(kappa)\n    return kappa\n\ndef kappa_to_shear(kappa, N):\n    \"\"\"Computes shear fields from a convergence map in Fourier space.\"\"\"\n    kappa_k = np.fft.fft2(kappa)\n    \n    ky = np.fft.fftfreq(N)[:, None]\n    kx = np.fft.fftfreq(N)[None, :]\n    \n    # Square of the wavenumber. Avoid division by zero at k=0.\n    k_sq = kx**2 + ky**2\n    k_sq[0, 0] = 1.0  # Avoid division by zero\n    \n    # Shear-to-convergence filters\n    # gamma1_k = kappa_k * (kx^2 - ky^2) / k^2\n    # gamma2_k = kappa_k * (2*kx*ky) / k^2\n    g1_k_filter = (kx**2 - ky**2) / k_sq\n    g2_k_filter = (2 * kx * ky) / k_sq\n    \n    # The k=0 mode has no shear, set filter to 0\n    g1_k_filter[0, 0] = 0.0\n    g2_k_filter[0, 0] = 0.0\n    \n    gamma1_k = kappa_k * g1_k_filter\n    gamma2_k = kappa_k * g2_k_filter\n        \n    gamma1 = np.fft.ifft2(gamma1_k).real\n    gamma2 = np.fft.ifft2(gamma2_k).real\n    \n    return gamma1, gamma2\n\ndef reconstruct_kEB(gamma1_obs, gamma2_obs, N):\n    \"\"\"Reconstructs E-mode and B-mode convergence from observed shear.\"\"\"\n    gamma1_obs_k = np.fft.fft2(gamma1_obs)\n    gamma2_obs_k = np.fft.fft2(gamma2_obs)\n\n    ky = np.fft.fftfreq(N)[:, None]\n    kx = np.fft.fftfreq(N)[None, :]\n    \n    k_sq = kx**2 + ky**2\n    k_sq[0, 0] = 1.0  # Avoid division by zero\n    \n    # E-mode filter: kE_k = ((kx^2-ky^2)*g1_k + (2*kx*ky)*g2_k)/k^2\n    kE_k = ((kx**2 - ky**2) * gamma1_obs_k + 2 * kx * ky * gamma2_obs_k) / k_sq\n    \n    # B-mode filter: kB_k = ((2*kx*ky)*g1_k - (kx^2-ky^2)*g2_k)/k^2\n    kB_k = (2 * kx * ky * gamma1_obs_k - (kx**2 - ky**2) * gamma2_obs_k) / k_sq\n\n    # Set DC modes to zero (mass sheet degeneracy)\n    kE_k[0, 0] = 0.0\n    kB_k[0, 0] = 0.0\n    \n    kappa_E = np.fft.ifft2(kE_k).real\n    kappa_B = np.fft.ifft2(kB_k).real\n    \n    return kappa_E, kappa_B\n\ndef generate_mask(mask_type, param, N):\n    \"\"\"Generates the binary mask W0.\"\"\"\n    W0 = np.ones((N, N))\n    y, x = np.meshgrid(np.arange(N), np.arange(N), indexing='ij')\n    center = N / 2\n\n    if mask_type == \"none\":\n        pass\n    elif mask_type == \"circular\":\n        radius = param\n        dist_sq = (x - center)**2 + (y - center)**2\n        W0[dist_sq = radius**2] = 0\n    elif mask_type == \"stripe\":\n        half_width = param\n        W0[:, np.abs(np.arange(N) - center) = half_width] = 0\n        \n    return W0\n\ndef apply_apodization(W0, w, N):\n    \"\"\"Applies sine-squared apodization to a binary mask.\"\"\"\n    if w == 0:\n        return W0.astype(float)\n\n    # distance_transform_edt computes the distance from each non-zero pixel \n    # to the nearest zero pixel. This is exactly d(theta).\n    dist_map = distance_transform_edt(W0)\n    \n    W = W0.copy().astype(float)\n    \n    # Identify the region to apply tapering\n    taper_zone = (W0 == 1)  (dist_map  w)\n    \n    # Apply the sine-squared apodization function\n    W[taper_zone] = np.sin(np.pi * dist_map[taper_zone] / (2 * w))**2\n    \n    return W\n\ndef calculate_leakage(kappa_E, kappa_B, W):\n    \"\"\"Calculates the E-to-B leakage metric L.\"\"\"\n    \n    # The sum is over all pixels, weighted by W_i.\n    # Pixels where W_i=0 contribute nothing.\n    power_B = np.sum(W * kappa_B**2)\n    power_E = np.sum(W * kappa_E**2)\n    \n    if power_E == 0:\n        return np.inf\n        \n    return np.sqrt(power_B / power_E)\n\ndef solve():\n    N = 128\n    \n    # Define the mock kappa field\n    clumps = [\n        (1.0, (N/4, N/4), 5.0),\n        (0.8, (3*N/4, 3*N/4), 8.0)\n    ]\n    kappa_true = create_mock_kappa(N, clumps)\n    \n    # Generate the true, unmasked shear fields\n    gamma1_true, gamma2_true = kappa_to_shear(kappa_true, N)\n    \n    # Define the test cases\n    test_cases = [\n        {\"mask_type\": \"none\", \"param\": 0, \"w\": 0},\n        {\"mask_type\": \"circular\", \"param\": 12, \"w\": 0},\n        {\"mask_type\": \"circular\", \"param\": 12, \"w\": 6},\n        {\"mask_type\": \"stripe\", \"param\": 6, \"w\": 6},\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        # 1. Generate binary mask\n        W0 = generate_mask(case[\"mask_type\"], case[\"param\"], N)\n        \n        # 2. Apply apodization to get final window function W\n        W = apply_apodization(W0, case[\"w\"], N)\n        \n        # 3. Create observed (masked) shear fields\n        gamma1_obs = gamma1_true * W\n        gamma2_obs = gamma2_true * W\n        \n        # 4. Reconstruct E and B modes from observed shear\n        kappa_E, kappa_B = reconstruct_kEB(gamma1_obs, gamma2_obs, N)\n        \n        # 5. Calculate leakage\n        leakage = calculate_leakage(kappa_E, kappa_B, W)\n        results.append(leakage)\n\n    # Format the final output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3468591"}, {"introduction": "A fundamental limitation of reconstructing convergence $\\kappa$ from shear alone is the mass-sheet degeneracy, where an entire family of mass maps, parameterized by $\\lambda$ as $\\kappa \\rightarrow \\lambda \\kappa + (1 - \\lambda)$, produces an identical observable shear field. This advanced exercise demonstrates how to break this degeneracy by incorporating a second, independent lensing observable: magnification $\\mu$. You will use the powerful Fisher information formalism to quantify exactly how much constraining power magnification data, via galaxy number counts, provides on the degeneracy parameter $\\lambda$. [@problem_id:3468642]", "problem": "You are given a weak gravitational lensing survey of total solid angle $A_{\\mathrm{tot}}$ from which you have numerically constructed a reduced shear map $g(\\boldsymbol{\\theta})$ and an independent magnification map $\\hat{\\mu}(\\boldsymbol{\\theta})$. Work throughout in the weak-lensing regime over a subregion where $| \\kappa | \\leq 0.1$ and $| g | \\leq 0.2$, so that to leading order you may approximate the baseline magnification field at the fiducial mass-sheet choice as spatially constant, $\\mu(\\boldsymbol{\\theta}; \\lambda{=}1) \\approx \\mu_{0}$ with $\\mu_{0} \\approx 1$. Assume that reduced shear $g(\\boldsymbol{\\theta})$ is measured with negligible noise relative to the magnification noise and that galaxy positions are randomly distributed so that intrinsic clustering can be neglected on the chosen pixel scale.\n\nAdopt the gravitational lensing Jacobian definition with convergence $\\kappa$ and complex shear $\\gamma$ and define magnification $\\mu$ as the reciprocal of the determinant of the Jacobian. The reduced shear is defined as $g \\equiv \\gamma / (1 - \\kappa)$. The mass-sheet transformation is parameterized by a global parameter $\\lambda$ acting on the convergence and shear as $\\kappa \\rightarrow \\lambda \\kappa + (1 - \\lambda)$ and $\\gamma \\rightarrow \\lambda \\gamma$. You will quantify how adding magnification information breaks the mass-sheet degeneracy by computing the Fisher-limited residual uncertainty on $\\lambda$ from magnification-only data, marginalizing over nothing else.\n\nFor magnification estimation, use galaxy number-count magnification bias with logarithmic count slope $s$ at the flux limit. In a pixel of solid angle $A_{\\mathrm{pix}}$, the expected number of galaxies is $n_{0} A_{\\mathrm{pix}} \\mu^{2.5 s - 1}$, where $n_{0}$ is the unlensed mean surface density of galaxies. Assume Poisson statistics for galaxy counts in each pixel and independent pixels across the survey. You may linearize any expressions about the weak-lensing limit as needed.\n\nSurvey specifications:\n- Total area $A_{\\mathrm{tot}} = 200~\\mathrm{deg}^{2}$.\n- Unlensed source density $n_{0} = 20~\\mathrm{arcmin}^{-2}$.\n- Number-count slope $s = 0.3$.\n- Treat $\\mu(\\boldsymbol{\\theta}; \\lambda{=}1) \\approx \\mu_{0} = 1$ across the selected weak-lensing subregion.\n- Evaluate the uncertainty at the true value $\\lambda = 1$.\n\nStarting only from the definitions above and standard probability for independent Poisson counts, derive a closed-form expression for the Fisher-information-limited uncertainty $\\sigma_{\\lambda}$ on $\\lambda$ in terms of $(A_{\\mathrm{tot}}, n_{0}, s, \\mu_{0})$ under the stated approximations, and then evaluate it numerically for the given survey. Express the final answer as a single real number and round your result to three significant figures. The answer is dimensionless; do not include units in your final answer.", "solution": "The problem asks for the Fisher-information-limited uncertainty, $\\sigma_{\\lambda}$, on the mass-sheet transformation parameter $\\lambda$, derived from magnification data alone. The solution proceeds by first deriving the Fisher information for $\\lambda$ based on the provided statistical model of galaxy number counts and then evaluating the resulting expression.\n\nThe magnification $\\mu$ is defined as the inverse of the determinant of the lensing Jacobian matrix $A_{ij} = \\frac{\\partial \\theta_S^i}{\\partial \\theta^j}$, which has components related to convergence $\\kappa$ and complex shear $\\gamma = \\gamma_1 + i\\gamma_2$. The Jacobian is $A = \\begin{pmatrix} 1-\\kappa-\\gamma_1  -\\gamma_2 \\\\ -\\gamma_2  1-\\kappa+\\gamma_1 \\end{pmatrix}$.\nThe magnification is $\\mu = (\\det A)^{-1} = ((1-\\kappa)^2 - |\\gamma|^2)^{-1}$.\n\nThe mass-sheet transformation (MST) is given by:\n$$ \\kappa \\rightarrow \\kappa' = \\lambda \\kappa + (1 - \\lambda) $$\n$$ \\gamma \\rightarrow \\gamma' = \\lambda \\gamma $$\nUnder this transformation, the magnification $\\mu$ transforms as:\n$$ \\mu(\\lambda) = \\frac{1}{(1-\\kappa')^2 - |\\gamma'|^2} = \\frac{1}{(1 - (\\lambda\\kappa + 1 - \\lambda))^2 - |\\lambda\\gamma|^2} = \\frac{1}{(\\lambda(1-\\kappa))^2 - \\lambda^2|\\gamma|^2} = \\frac{1}{\\lambda^2 ((1-\\kappa)^2 - |\\gamma|^2)} $$\nThis gives an exact relation between the magnification at a general $\\lambda$, denoted $\\mu(\\lambda)$, and the true magnification (at $\\lambda=1$), denoted $\\mu_{1}$:\n$$ \\mu(\\lambda) = \\frac{\\mu_{1}}{\\lambda^2} $$\nThis relation shows how magnification breaks the mass-sheet degeneracy, which otherwise leaves the reduced shear $g = \\gamma/(1-\\kappa)$ invariant.\n\nThe data consists of galaxy counts in pixels across the survey. The expected number of galaxies in a pixel $i$ with solid angle $A_{\\mathrm{pix}}$ is given by:\n$$ \\langle N_i \\rangle = n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} $$\nwhere $n_0$ is the unlensed surface density of galaxies and $\\alpha = 2.5s-1$, with $s$ being the logarithmic count slope. Galaxy counts in different pixels are assumed to be independent and to follow Poisson statistics.\n\nThe total Fisher information for the parameter $\\lambda$ is the sum of the Fisher information from each independent pixel: $F_{\\lambda\\lambda} = \\sum_i F_{\\lambda\\lambda}^{(i)}$. For a single Poisson observation $N_i$ with expected value $\\langle N_i(\\lambda) \\rangle$, the Fisher information is $F_{\\lambda\\lambda}^{(i)} = \\frac{1}{\\langle N_i \\rangle} \\left( \\frac{\\partial \\langle N_i \\rangle}{\\partial \\lambda} \\right)^2$.\nAlternatively, this can be written as $F_{\\lambda\\lambda}^{(i)} = \\langle N_i \\rangle \\left( \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} \\right)^2$.\n\nLet's calculate the derivative of the log-expectation value:\n$$ \\ln \\langle N_i \\rangle = \\ln(n_0 A_{\\mathrm{pix}}) + \\alpha \\ln(\\mu_i(\\lambda)) $$\n$$ \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} = \\alpha \\frac{1}{\\mu_i(\\lambda)} \\frac{\\partial \\mu_i(\\lambda)}{\\partial \\lambda} $$\nUsing the relation $\\mu_i(\\lambda) = \\mu_{1,i}/\\lambda^2$, we have:\n$$ \\frac{\\partial \\mu_i(\\lambda)}{\\partial \\lambda} = \\mu_{1,i} (-2\\lambda^{-3}) = -\\frac{2\\mu_i(\\lambda)}{\\lambda} $$\nSubstituting this into the derivative of the log-expectation:\n$$ \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} = \\alpha \\frac{1}{\\mu_i(\\lambda)} \\left( -\\frac{2\\mu_i(\\lambda)}{\\lambda} \\right) = -\\frac{2\\alpha}{\\lambda} $$\nThe Fisher information for a single pixel is then:\n$$ F_{\\lambda\\lambda}^{(i)} = \\langle N_i(\\lambda) \\rangle \\left( -\\frac{2\\alpha}{\\lambda} \\right)^2 = \\frac{4\\alpha^2}{\\lambda^2} \\langle N_i(\\lambda) \\rangle = \\frac{4\\alpha^2}{\\lambda^2} n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} $$\nThe total Fisher information is the sum over all pixels:\n$$ F_{\\lambda\\lambda}(\\lambda) = \\sum_i \\frac{4\\alpha^2}{\\lambda^2} n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} = \\frac{4\\alpha^2 n_0}{\\lambda^2} \\sum_i A_{\\mathrm{pix}} \\left(\\frac{\\mu_{1,i}}{\\lambda^2}\\right)^{\\alpha} $$\n$$ F_{\\lambda\\lambda}(\\lambda) = \\frac{4\\alpha^2 n_0}{\\lambda^{2+2\\alpha}} \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta $$\nWe need to evaluate this at the true value $\\lambda=1$:\n$$ F_{\\lambda\\lambda}|_{\\lambda=1} = 4\\alpha^2 n_0 \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta $$\nThe problem states to treat the baseline magnification as constant, $\\mu_1(\\boldsymbol{\\theta}) \\approx \\mu_0 = 1$. This approximation simplifies the integral:\n$$ \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta \\approx \\int_{A_{\\mathrm{tot}}} (1)^{\\alpha} d^2\\theta = A_{\\mathrm{tot}} $$\nThis approximation is equivalent to assuming that the spatial fluctuations of the magnification field average out, i.e., in the weak lensing limit $\\mu_1 \\approx 1+2\\kappa$, and $\\int (1+2\\kappa)^\\alpha d^2\\theta \\approx \\int(1+2\\alpha\\kappa)d^2\\theta = A_{\\mathrm{tot}}$ given that the mean convergence $\\bar{\\kappa}$ over the survey is zero.\n\nSubstituting this into the expression for the Fisher information gives:\n$$ F_{\\lambda\\lambda} = 4\\alpha^2 n_0 A_{\\mathrm{tot}} $$\nThe uncertainty on $\\lambda$ is given by the Cramer-Rao bound, $\\sigma_\\lambda^2 \\ge 1/F_{\\lambda\\lambda}$. The Fisher-limited uncertainty is $\\sigma_\\lambda = 1/\\sqrt{F_{\\lambda\\lambda}}$.\n$$ \\sigma_\\lambda = \\frac{1}{\\sqrt{4\\alpha^2 n_0 A_{\\mathrm{tot}}}} = \\frac{1}{2|\\alpha| \\sqrt{n_0 A_{\\mathrm{tot}}}} $$\nSubstituting $\\alpha = 2.5s-1$, we get the final closed-form expression:\n$$ \\sigma_\\lambda = \\frac{1}{2|2.5s-1| \\sqrt{n_0 A_{\\mathrm{tot}}}} $$\n\nNow, we evaluate this expression numerically with the given survey specifications:\n$A_{\\mathrm{tot}} = 200~\\mathrm{deg}^2$\n$n_0 = 20~\\mathrm{arcmin}^{-2}$\n$s = 0.3$\n\nFirst, we must ensure consistent units. We convert the total area $A_{\\mathrm{tot}}$ to square arcminutes:\n$1~\\mathrm{degree} = 60~\\mathrm{arcminutes}$, so $1~\\mathrm{deg}^2 = 3600~\\mathrm{arcmin}^2$.\n$A_{\\mathrm{tot}} = 200 \\times 3600~\\mathrm{arcmin}^2 = 720,000~\\mathrm{arcmin}^2$.\n\nNext, we calculate the total unlensed number of galaxies, $n_0 A_{\\mathrm{tot}}$:\n$n_0 A_{\\mathrm{tot}} = (20~\\mathrm{arcmin}^{-2}) \\times (720,000~\\mathrm{arcmin}^2) = 14,400,000 = 1.44 \\times 10^7$.\n\nThen, we calculate the exponent factor $\\alpha$:\n$\\alpha = 2.5s - 1 = 2.5 \\times 0.3 - 1 = 0.75 - 1 = -0.25$.\n$|\\alpha| = 0.25$.\n\nNow we can compute $\\sigma_\\lambda$:\n$$ \\sigma_\\lambda = \\frac{1}{2 \\times 0.25 \\times \\sqrt{1.44 \\times 10^7}} = \\frac{1}{0.5 \\times \\sqrt{1.44 \\times 10^7}} = \\frac{2}{\\sqrt{1.44 \\times 10^7}} $$\n$$ \\sigma_\\lambda = \\frac{2}{1.2 \\times \\sqrt{10^7}} = \\frac{2}{1.2 \\times 10^{3.5}} \\approx \\frac{2}{1.2 \\times 3162.277} \\approx \\frac{2}{3794.733} \\approx 0.000527046 $$\nRounding the result to three significant figures gives $0.000527$ or $5.27 \\times 10^{-4}$.", "answer": "$$\\boxed{5.27 \\times 10^{-4}}$$", "id": "3468642"}]}