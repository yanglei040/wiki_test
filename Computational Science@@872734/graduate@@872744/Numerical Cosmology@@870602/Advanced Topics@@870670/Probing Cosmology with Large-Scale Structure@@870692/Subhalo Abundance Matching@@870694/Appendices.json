{"hands_on_practices": [{"introduction": "The fundamental premise of Subhalo Abundance Matching (SHAM) is the one-to-one mapping established by equating the cumulative number densities of galaxies and halos. This exercise provides a direct, hands-on test of this core principle. By analyzing how a systematic error in stellar mass estimates propagates through the SHAM framework, you will gain a quantitative understanding of the sensitivity of the inferred galaxy-halo connection to observational uncertainties [@problem_id:3492426].", "problem": "A fundamental starting point of Subhalo Abundance Matching (SHAM) is that a monotonic mapping between galaxy stellar mass and a halo proxy is obtained by equating the cumulative number density of galaxies above a stellar mass threshold to the cumulative number density of (sub)halos above a corresponding halo proxy threshold. Consider a SHAM model at redshift $z \\approx 0$ in which the proxy is the peak pre-infall mass, denoted $M_{\\mathrm{peak}}$. Let $\\log$ denote base-$10$ logarithms. Assume the following local power-law descriptions in a narrow mass range around the current SHAM threshold:\n- The cumulative stellar mass function is locally $n_{\\mathrm{g}}(>M_{\\star}) \\propto M_{\\star}^{-\\beta}$ with $\\beta = 1.6$.\n- The cumulative abundance of distinct host halos is locally $n_{\\mathrm{host}}(>M) \\propto M^{-\\gamma_{\\mathrm{h}}}$ with $\\gamma_{\\mathrm{h}} = 0.9$.\n- The cumulative abundance of subhalos (in the cosmological volume, counted across all hosts) is locally $n_{\\mathrm{sub}}(>M) \\propto M^{-\\gamma_{\\mathrm{s}}}$ with $\\gamma_{\\mathrm{s}} = 1.2$.\n- At the current SHAM threshold, the satellite fraction is $f_{\\mathrm{sat},0} = 0.22$.\n\nAssume that a uniform systematic offset affects all stellar mass estimates such that $\\Delta \\log M_{\\star} = +0.10$ (that is, all stellar masses are overestimated by $0.10$ dex). Under the SHAM requirement of matching cumulative abundances, this induces a shift in the inferred $M_{\\mathrm{peak}}$ threshold. Treat the power-law approximations as valid over the small range of the shift, and work to first order in the shift.\n\nUsing only the principles stated above, and without assuming any further fitting formulas, compute:\n1. The induced shift $\\Delta \\log M_{\\mathrm{peak}}$ required to preserve the abundance matching condition after the systematic stellar mass offset.\n2. The new satellite fraction $f_{\\mathrm{sat}}$ evaluated at the shifted $M_{\\mathrm{peak}}$ threshold.\n\nProvide your final answers as two numbers in the order $\\left(\\Delta \\log M_{\\mathrm{peak}}, f_{\\mathrm{sat}}\\right)$. Round your numerical results to four significant figures. Express $\\Delta \\log M_{\\mathrm{peak}}$ in dex and $f_{\\mathrm{sat}}$ as a dimensionless decimal.", "solution": "The problem is valid. It is scientifically grounded in the principles of Subhalo Abundance Matching (SHAM) in cosmology, well-posed with sufficient information for a unique solution, and stated objectively. We can proceed with the solution.\n\nThe core principle of Subhalo Abundance Matching (SHAM) is the equation of cumulative number densities between galaxies and (sub)halos. Let $M_{\\star}$ be the galaxy stellar mass and $M_{\\text{peak}}$ be the halo mass proxy (peak pre-infall mass). The SHAM condition is:\n$$n_{\\text{g}}(>M_{\\star}) = n_{\\text{halo}}(>M_{\\text{peak}})$$\nThe total number density of halos, $n_{\\text{halo}}$, is the sum of the number densities of distinct host halos, $n_{\\text{host}}$, and subhalos, $n_{\\text{sub}}$.\n$$n_{\\text{halo}}(>M_{\\text{peak}}) = n_{\\text{host}}(>M_{\\text{peak}}) + n_{\\text{sub}}(>M_{\\text{peak}})$$\n\nWe are given local power-law descriptions for these cumulative abundances:\n-   Galaxy stellar mass function: $n_{\\text{g}}(>M_{\\star}) = C_{\\text{g}} M_{\\star}^{-\\beta}$, with $\\beta = 1.6$.\n-   Host halo mass function: $n_{\\text{host}}(>M) = C_{\\text{h}} M^{-\\gamma_{\\text{h}}}$, with $\\gamma_{\\text{h}} = 0.9$.\n-   Subhalo mass function: $n_{\\text{sub}}(>M) = C_{\\text{s}} M^{-\\gamma_{\\text{s}}}$, with $\\gamma_{\\text{s}} = 1.2$.\nHere, $C_{\\text{g}}$, $C_{\\text{h}}$, and $C_{\\text{s}}$ are normalization constants.\n\nLet $m_{\\star} = \\log M_{\\star}$ and $m_{\\text{p}} = \\log M_{\\text{peak}}$ denote the base-$10$ logarithms of the masses. The SHAM equation, applied at a specific abundance, establishes a relationship $m_{\\text{p}}(m_{\\star})$. We are given a systematic shift in stellar mass, $\\Delta m_{\\star} = +0.10$, and are asked to find the induced shift in the halo mass threshold, $\\Delta m_{\\text{p}}$, that preserves the abundance matching. We work to first order, which is appropriate for a small shift.\n\nThis implies that the change in $n_{\\text{g}}$ due to $\\Delta m_{\\star}$ must be compensated by the change in $n_{\\text{halo}}$ due to $\\Delta m_{\\text{p}}$, such that the total abundance remains matched. In differential form, $dn_{\\text{g}} = dn_{\\text{halo}}$.\n\nLet's express these differentials.\nFor galaxies:\n$n_{\\text{g}} \\propto (10^{m_{\\star}})^{-\\beta} = 10^{-\\beta m_{\\star}}$.\n$dn_{\\text{g}} = \\frac{dn_{\\text{g}}}{dm_{\\star}} dm_{\\star} = (-\\beta \\ln 10) n_{\\text{g}} dm_{\\star}$.\n\nFor halos:\n$n_{\\text{halo}} = n_{\\text{host}} + n_{\\text{sub}} \\propto 10^{-\\gamma_{\\text{h}} m_{\\text{p}}} + C' 10^{-\\gamma_{\\text{s}} m_{\\text{p}}}$, where $C'$ is a relative normalization.\n$dn_{\\text{halo}} = \\frac{dn_{\\text{halo}}}{dm_{\\text{p}}} dm_{\\text{p}} = \\left( \\frac{dn_{\\text{host}}}{dm_{\\text{p}}} + \\frac{dn_{\\text{sub}}}{dm_{\\text{p}}} \\right) dm_{\\text{p}}$.\n$\\frac{dn_{\\text{host}}}{dm_{\\text{p}}} = (-\\gamma_{\\text{h}} \\ln 10) n_{\\text{host}}$.\n$\\frac{dn_{\\text{sub}}}{dm_{\\text{p}}} = (-\\gamma_{\\text{s}} \\ln 10) n_{\\text{sub}}$.\nSo, $dn_{\\text{halo}} = \\left( (-\\gamma_{\\text{h}} \\ln 10) n_{\\text{host}} - (\\gamma_{\\text{s}} \\ln 10) n_{\\text{sub}} \\right) dm_{\\text{p}}$.\n\nEquating the differentials $dn_{\\text{g}} = dn_{\\text{halo}}$:\n$(-\\beta \\ln 10) n_{\\text{g}} dm_{\\star} = \\left( (-\\gamma_{\\text{h}} \\ln 10) n_{\\text{host}} - (\\gamma_{\\text{s}} \\ln 10) n_{\\text{sub}} \\right) dm_{\\text{p}}$.\nAt the matching threshold, $n_{\\text{g}} = n_{\\text{host}} + n_{\\text{sub}}$. Substituting this and canceling $(-\\ln 10)$:\n$\\beta (n_{\\text{host}} + n_{\\text{sub}}) dm_{\\star} = (\\gamma_{\\text{h}} n_{\\text{host}} + \\gamma_{\\text{s}} n_{\\text{sub}}) dm_{\\text{p}}$.\n\nSolving for the ratio of the shifts:\n$\\frac{dm_{\\text{p}}}{dm_{\\star}} = \\frac{\\beta (n_{\\text{host}} + n_{\\text{sub}})}{\\gamma_{\\text{h}} n_{\\text{host}} + \\gamma_{\\text{s}} n_{\\text{sub}}}$.\nTo evaluate the denominator, we use the initial satellite fraction, $f_{\\text{sat},0} = 0.22$. The satellite fraction is the number density of subhalos divided by the total number density of halos:\n$f_{\\text{sat},0} = \\frac{n_{\\text{sub}}}{n_{\\text{host}} + n_{\\text{sub}}}$.\nThis implies $n_{\\text{host}} = (1 - f_{\\text{sat},0})(n_{\\text{host}} + n_{\\text{sub}})$.\nDividing the numerator and denominator of the ratio $\\frac{dm_{\\text{p}}}{dm_{\\star}}$ by $(n_{\\text{host}} + n_{\\text{sub}})$ gives:\n$\\frac{dm_{\\text{p}}}{dm_{\\star}} = \\frac{\\beta}{\\gamma_{\\text{h}} \\frac{n_{\\text{host}}}{n_{\\text{host}} + n_{\\text{sub}}} + \\gamma_{\\text{s}} \\frac{n_{\\text{sub}}}{n_{\\text{host}} + n_{\\text{sub}}}} = \\frac{\\beta}{\\gamma_{\\text{h}}(1-f_{\\text{sat},0}) + \\gamma_{\\text{s}} f_{\\text{sat},0}}$.\n\nNow, we can compute the shift $\\Delta \\log M_{\\text{peak}} = \\Delta m_{\\text{p}}$. For small finite shifts, $\\Delta m_{\\text{p}} \\approx \\frac{dm_{\\text{p}}}{dm_{\\star}} \\Delta m_{\\star}$.\n$\\Delta \\log M_{\\text{peak}} = \\left( \\frac{\\beta}{\\gamma_{\\text{h}}(1-f_{\\text{sat},0}) + \\gamma_{\\text{s}} f_{\\text{sat},0}} \\right) \\Delta \\log M_{\\star}$.\nPlugging in the given values:\n$\\beta = 1.6$, $\\gamma_{\\text{h}} = 0.9$, $\\gamma_{\\text{s}} = 1.2$, $f_{\\text{sat},0} = 0.22$, and $\\Delta \\log M_{\\star} = 0.10$.\nThe denominator is $\\gamma_{\\text{h}}(1-f_{\\text{sat},0}) + \\gamma_{\\text{s}} f_{\\text{sat},0} = 0.9 \\times (1-0.22) + 1.2 \\times 0.22 = 0.9 \\times 0.78 + 0.264 = 0.702 + 0.264 = 0.966$.\n$\\Delta \\log M_{\\text{peak}} = \\frac{1.6}{0.966} \\times 0.10 \\approx 1.6563147 \\times 0.10 \\approx 0.16563$.\nRounding to four significant figures, $\\Delta \\log M_{\\text{peak}} = 0.1656$.\n\nNext, we calculate the new satellite fraction, $f_{\\text{sat}}$, at the shifted mass threshold. The new threshold is $M_{\\text{peak},1} = M_{\\text{peak},0} \\cdot 10^{\\Delta \\log M_{\\text{peak}}}$.\nThe new satellite fraction is $f_{\\text{sat}} = \\frac{n_{\\text{sub}}(>M_{\\text{peak},1})}{n_{\\text{host}}(>M_{\\text{peak},1}) + n_{\\text{sub}}(>M_{\\text{peak},1})}$.\nUsing the power-law forms, we can find the new number densities in terms of the old ones:\n$n_{\\text{host}}(>M_{\\text{peak},1}) = n_{\\text{host}}(>M_{\\text{peak},0}) \\left(\\frac{M_{\\text{peak},1}}{M_{\\text{peak},0}}\\right)^{-\\gamma_{\\text{h}}} = n_{\\text{host},0} \\left(10^{\\Delta \\log M_{\\text{peak}}}\\right)^{-\\gamma_{\\text{h}}} = n_{\\text{host},0} \\cdot 10^{-\\gamma_{\\text{h}}\\Delta \\log M_{\\text{peak}}}$.\n$n_{\\text{sub}}(>M_{\\text{peak},1}) = n_{\\text{sub}}(>M_{\\text{peak},0}) \\left(\\frac{M_{\\text{peak},1}}{M_{\\text{peak},0}}\\right)^{-\\gamma_{\\text{s}}} = n_{\\text{sub},0} \\left(10^{\\Delta \\log M_{\\text{peak}}}\\right)^{-\\gamma_{\\text{s}}} = n_{\\text{sub},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\text{peak}}}$.\n\nThe new satellite fraction is:\n$f_{\\text{sat}} = \\frac{n_{\\text{sub},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\text{peak}}}}{n_{\\text{host},0} \\cdot 10^{-\\gamma_{\\text{h}}\\Delta \\log M_{\\text{peak}}} + n_{\\text{sub},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\text{peak}}}}$.\nWe can express $n_{\\text{host},0}$ and $n_{\\text{sub},0}$ in terms of $f_{\\text{sat},0}$ and the total initial abundance $n_{\\text{tot},0}$:\n$n_{\\text{sub},0} = f_{\\text{sat},0} n_{\\text{tot},0}$ and $n_{\\text{host},0} = (1-f_{\\text{sat},0}) n_{\\text{tot},0}$.\nSubstituting and canceling $n_{\\text{tot},0}$:\n$f_{\\text{sat}} = \\frac{f_{\\text{sat},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\text{peak}}}}{(1-f_{\\text{sat},0}) \\cdot 10^{-\\gamma_{\\text{h}}\\Delta \\log M_{\\text{peak}}} + f_{\\text{sat},0} \\cdot 10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\text{peak}}}}$.\nTo simplify, divide the numerator and denominator by $10^{-\\gamma_{\\text{s}}\\Delta \\log M_{\\text{peak}}}$:\n$f_{\\text{sat}} = \\frac{f_{\\text{sat},0}}{(1-f_{\\text{sat},0}) \\cdot 10^{(\\gamma_{\\text{s}}-\\gamma_{\\text{h}})\\Delta \\log M_{\\text{peak}}} + f_{\\text{sat},0}}$.\n\nNow, we plug in the values:\n$f_{\\text{sat},0} = 0.22$, $\\gamma_{\\text{s}} - \\gamma_{\\text{h}} = 1.2 - 0.9 = 0.3$, and $\\Delta \\log M_{\\text{peak}} \\approx 0.16563147$.\nThe exponent is $(\\gamma_{\\text{s}}-\\gamma_{\\text{h}})\\Delta \\log M_{\\text{peak}} = 0.3 \\times 0.16563147 \\approx 0.0496894$.\nThe exponential term is $10^{0.0496894} \\approx 1.12128$.\nThe denominator is $(1-0.22) \\times 1.12128 + 0.22 = 0.78 \\times 1.12128 + 0.22 \\approx 0.874598 + 0.22 = 1.094598$.\n$f_{\\text{sat}} = \\frac{0.22}{1.094598} \\approx 0.20100488$.\nRounding to four significant figures, the new satellite fraction is $f_{\\text{sat}} = 0.2010$.\n\nThe final results are $\\Delta \\log M_{\\text{peak}} \\approx 0.1656$ and $f_{\\text{sat}} \\approx 0.2010$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1656 & 0.2010\n\\end{pmatrix}\n}\n$$", "id": "3492426"}, {"introduction": "In practical applications, the halo catalogs derived from cosmological simulations are not perfect and suffer from issues like finite resolution, which causes incompleteness in detecting smaller subhalos. This practice confronts this real-world challenge directly. You will learn to model the effects of such incompleteness on a key observable, the satellite fraction, and derive a correction to recover the true underlying value [@problem_id:3492412].", "problem": "A threshold-selected galaxy sample is constructed via Subhalo Abundance Matching (SHAM), assuming a monotonic mapping between stellar mass and subhalo peak circular velocity. Let the selection be defined by a cut at peak circular velocity $V_{\\text{cut}}$, so that subhalos with $V_{\\text{peak}} \\ge V_{\\text{cut}}$ host the sample galaxies. The satellite fraction is defined as $f_{\\text{sat}} \\equiv N_{\\text{sat}}/(N_{\\text{cen}}+N_{\\text{sat}})$, where $N_{\\text{sat}}$ and $N_{\\text{cen}}$ are the true numbers of satellites and centrals, respectively.\n\nA low-resolution simulation suffers from subhalo detection incompleteness near the threshold, which is calibrated using a higher-resolution run. The high-resolution calibration indicates the following completeness model: for satellite subhalos with $V_{\\text{peak}} \\in [V_{\\text{cut}}, (1+\\Delta)V_{\\text{cut}}]$ the detection probability is $c_{s}=0.7$ (i.e., $30\\%$ incompleteness), while for $V_{\\text{peak}} > (1+\\Delta)V_{\\text{cut}}$ the completeness is $1$. Centrals are complete across the entire relevant range. Assume $\\Delta = 0.1$. In the vicinity of $V_{\\text{cut}}$, the cumulative satellite subhalo velocity function is well-approximated by a local power law $N_{\\text{sat}}(>v) \\propto v^{-\\gamma}$ with $\\gamma = 3$. The observed satellite fraction measured in the low-resolution simulation is $f_{\\text{sat}}^{\\text{obs}} = 0.22$.\n\nStarting from the definition of $f_{\\text{sat}}$ and the completeness model above, derive the relationship between the true satellite fraction $f_{\\text{sat}}^{\\text{true}}$ and the observed fraction $f_{\\text{sat}}^{\\text{obs}}$, and use it to estimate the bias due to incompleteness. Then, propose a correction that uses the high-resolution calibration to recover $f_{\\text{sat}}^{\\text{true}}$ from $f_{\\text{sat}}^{\\text{obs}}$. Compute the corrected satellite fraction $f_{\\text{sat}}^{\\text{true}}$ numerically under the assumptions above. Express the final answer as a decimal fraction rounded to four significant figures.", "solution": "The problem is valid as it is scientifically grounded, well-posed, and objectively stated. We can proceed to find the true satellite fraction, $f_{\\text{sat}}^{\\text{true}}$.\n\nLet $N_{\\text{sat}}^{\\text{true}}(>v)$ and $N_{\\text{cen}}^{\\text{true}}(>v)$ be the true cumulative numbers of satellite and central subhalos above a peak circular velocity $v$. The true satellite fraction for a sample selected at $V_{\\text{cut}}$ is:\n$$f_{\\text{sat}}^{\\text{true}} = \\frac{N_{\\text{sat}}^{\\text{true}}(>V_{\\text{cut}})}{N_{\\text{cen}}^{\\text{true}}(>V_{\\text{cut}}) + N_{\\text{sat}}^{\\text{true}}(>V_{\\text{cut}})}$$\nThe observed numbers are affected by incompleteness. Centrals are complete, so $N_{\\text{cen}}^{\\text{obs}}(>V_{\\text{cut}}) = N_{\\text{cen}}^{\\text{true}}(>V_{\\text{cut}})$.\nThe number of observed satellites, $N_{\\text{sat}}^{\\text{obs}}(>V_{\\text{cut}})$, is the sum of detected satellites in two velocity ranges:\n1.  Range 1: $V_{\\text{peak}} \\in [V_{\\text{cut}}, (1+\\Delta)V_{\\text{cut}}]$. The number of true satellites in this range is $N_{\\text{sat,R1}}^{\\text{true}} = N_{\\text{sat}}^{\\text{true}}(>V_{\\text{cut}}) - N_{\\text{sat}}^{\\text{true}}(>(1+\\Delta)V_{\\text{cut}})$. The detection probability is $c_s = 0.7$.\n2.  Range 2: $V_{\\text{peak}} > (1+\\Delta)V_{\\text{cut}}$. The number of true satellites here is $N_{\\text{sat,R2}}^{\\text{true}} = N_{\\text{sat}}^{\\text{true}}(>(1+\\Delta)V_{\\text{cut}})$. The detection probability is 1.\n\nThe total number of observed satellites is:\n$$N_{\\text{sat}}^{\\text{obs}}(>V_{\\text{cut}}) = c_s \\cdot N_{\\text{sat,R1}}^{\\text{true}} + 1 \\cdot N_{\\text{sat,R2}}^{\\text{true}}$$\n$$N_{\\text{sat}}^{\\text{obs}}(>V_{\\text{cut}}) = c_s \\left(N_{\\text{sat}}^{\\text{true}}(>V_{\\text{cut}}) - N_{\\text{sat}}^{\\text{true}}(>(1+\\Delta)V_{\\text{cut}})\\right) + N_{\\text{sat}}^{\\text{true}}(>(1+\\Delta)V_{\\text{cut}})$$\nWe use the power-law approximation $N_{\\text{sat}}^{\\text{true}}(>v) \\propto v^{-\\gamma}$. This implies $N_{\\text{sat}}^{\\text{true}}(>(1+\\Delta)V_{\\text{cut}}) = N_{\\text{sat}}^{\\text{true}}(>V_{\\text{cut}}) \\cdot (1+\\Delta)^{-\\gamma}$.\nSubstituting this into the equation for $N_{\\text{sat}}^{\\text{obs}}$:\n$$N_{\\text{sat}}^{\\text{obs}}(>V_{\\text{cut}}) = N_{\\text{sat}}^{\\text{true}}(>V_{\\text{cut}}) \\left[ c_s(1 - (1+\\Delta)^{-\\gamma}) + (1+\\Delta)^{-\\gamma} \\right]$$\nThis gives the overall satellite completeness, $C_s = \\frac{N_{\\text{sat}}^{\\text{obs}}}{N_{\\text{sat}}^{\\text{true}}}$.\n$$C_s = c_s + (1-c_s)(1+\\Delta)^{-\\gamma}$$\nWith $c_s = 0.7$, $\\Delta = 0.1$, and $\\gamma = 3$:\n$$C_s = 0.7 + (1-0.7)(1.1)^{-3} = 0.7 + 0.3 \\times \\frac{1}{1.331} \\approx 0.7 + 0.3 \\times 0.75131 \\approx 0.7 + 0.22539 = 0.92539$$\nThe observed satellite fraction is:\n$$f_{\\text{sat}}^{\\text{obs}} = \\frac{N_{\\text{sat}}^{\\text{obs}}(>V_{\\text{cut}})}{N_{\\text{cen}}^{\\text{obs}}(>V_{\\text{cut}}) + N_{\\text{sat}}^{\\text{obs}}(>V_{\\text{cut}})} = \\frac{C_s N_{\\text{sat}}^{\\text{true}}}{N_{\\text{cen}}^{\\text{true}} + C_s N_{\\text{sat}}^{\\text{true}}}$$\nFor brevity, we drop the $(>V_{\\text{cut}})$ notation. From the definition of $f_{\\text{sat}}^{\\text{true}}$, we can write $N_{\\text{cen}}^{\\text{true}} = N_{\\text{sat}}^{\\text{true}} \\frac{1-f_{\\text{sat}}^{\\text{true}}}{f_{\\text{sat}}^{\\text{true}}}$.\nSubstituting this into the expression for $f_{\\text{sat}}^{\\text{obs}}$:\n$$f_{\\text{sat}}^{\\text{obs}} = \\frac{C_s N_{\\text{sat}}^{\\text{true}}}{N_{\\text{sat}}^{\\text{true}} \\frac{1-f_{\\text{sat}}^{\\text{true}}}{f_{\\text{sat}}^{\\text{true}}} + C_s N_{\\text{sat}}^{\\text{true}}} = \\frac{C_s}{\\frac{1-f_{\\text{sat}}^{\\text{true}}}{f_{\\text{sat}}^{\\text{true}}} + C_s} = \\frac{C_s f_{\\text{sat}}^{\\text{true}}}{1 - f_{\\text{sat}}^{\\text{true}} + C_s f_{\\text{sat}}^{\\text{true}}}$$\nThis equation relates the true and observed fractions. Now we solve for $f_{\\text{sat}}^{\\text{true}}$:\n$$f_{\\text{sat}}^{\\text{obs}} (1 - f_{\\text{sat}}^{\\text{true}} + C_s f_{\\text{sat}}^{\\text{true}}) = C_s f_{\\text{sat}}^{\\text{true}}$$\n$$f_{\\text{sat}}^{\\text{obs}} = f_{\\text{sat}}^{\\text{true}} (C_s - C_s f_{\\text{sat}}^{\\text{obs}} + f_{\\text{sat}}^{\\text{obs}}) = f_{\\text{sat}}^{\\text{true}} [C_s(1 - f_{\\text{sat}}^{\\text{obs}}) + f_{\\text{sat}}^{\\text{obs}}]$$\n$$f_{\\text{sat}}^{\\text{true}} = \\frac{f_{\\text{sat}}^{\\text{obs}}}{C_s(1 - f_{\\text{sat}}^{\\text{obs}}) + f_{\\text{sat}}^{\\text{obs}}}$$\nPlugging in the numerical values $f_{\\text{sat}}^{\\text{obs}} = 0.22$ and $C_s \\approx 0.92539$:\n$$f_{\\text{sat}}^{\\text{true}} = \\frac{0.22}{0.92539(1 - 0.22) + 0.22} = \\frac{0.22}{0.92539(0.78) + 0.22} = \\frac{0.22}{0.7218042 + 0.22} = \\frac{0.22}{0.9418042} \\approx 0.23359$$\nRounding to four significant figures, the corrected true satellite fraction is $0.2336$.", "answer": "$$\\boxed{0.2336}$$", "id": "3492412"}, {"introduction": "The galaxy-halo connection inferred from SHAM depends critically on how halos themselves are defined and identified within simulations. This exercise delves into the impact of the Friends-of-Friends (FoF) halo-finding algorithm, specifically its linking length parameter $b$. You will explore how this algorithmic choice systematically alters the halo mass function and derive a renormalization to ensure consistent SHAM results, a crucial step for robust scientific conclusions [@problem_id:3492474].", "problem": "A cosmological $N$-body simulation is post-processed with the Friends-of-Friends (FoF) halo finder. In FoF, the dimensionless linking length $b$ (in units of the mean interparticle separation) controls percolation of structures: increasing $b$ tends to merge nearby overdensities into larger hosts, while decreasing $b$ tends to fragment them. In Subhalo Abundance Matching (SHAM), one assigns galaxy stellar masses $M_{\\star}$ to halos or subhalos by equating cumulative number densities: the cumulative galaxy stellar mass function $n_{\\mathrm{gal}}(>M_{\\star})$ is matched to a cumulative halo property function $n_{\\mathrm{halo}}(>X)$, where $X$ is a monotonic halo property (for example, peak circular velocity or peak mass).\n\nConsider a reference catalog built with FoF linking length $b_{0}$, producing a host cumulative distribution $n_{b_{0}}(>X)$ for the property $X$. Let $X_{0}$ be the value of $X$ at which $n_{\\mathrm{gal}}(>M_{\\star,0}) = n_{b_{0}}(>X_{0})$ for some fiducial stellar mass $M_{\\star,0}$. Now reprocess the same simulation with a different linking length $b$, generating a new catalog. Empirically, two robust effects of changing $b$ near $X_{0}$ are observed:\n\n- A percolation-induced reduction in the number of distinct hosts above any local threshold, quantified by a fraction $f_{p}(b)$ of hosts that are merged away at $b$ relative to $b_{0}$ in the neighborhood of $X_{0}$.\n- A multiplicative rescaling of the measured host property in that neighborhood, $X \\mapsto X_{b} = q(b)\\,X$, with $q(b) > 0$.\n\nAssume that in the vicinity of $X_{0}$ the function $n_{b_{0}}(>X)$ is differentiable and monotonic, and that its local logarithmic slope\n$$\n\\gamma(X_{0}) \\equiv -\\left.\\frac{d\\ln n_{b_{0}}(>X)}{d\\ln X}\\right|_{X_{0}}\n$$\nis approximately constant over the small interval of interest. Also assume that $f_{p}(b)$ and $q(b)$ are approximately constant across this interval.\n\nDerive a multiplicative renormalization factor $r(b)$ for the $X$-axis such that replacing $X$ by $X' = r(b)\\,X$ in the $b$-catalog restores, to leading order around $X_{0}$, the equality\n$$\nn_{b}(>X') = n_{b_{0}}(>X)\n$$\nand hence preserves $n_{\\mathrm{gal}}(>M_{\\star})$ under SHAM across different choices of $b$. Express your final answer as a single closed-form analytical expression for $r(b)$ in terms of $q(b)$, $f_{p}(b)$, and $\\gamma(X_{0})$. No numerical evaluation is required, and no units should be included in your final expression.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of numerical cosmology, halo-finding algorithms (Friends-of-Friends), and the subhalo abundance matching (SHAM) technique. The problem is well-posed, with all necessary quantities, assumptions, and relationships defined to allow for a unique, meaningful solution. The language is objective and precise, and the setup is self-contained and consistent. No flaws meeting the invalidity criteria are found. Therefore, a solution will be derived.\n\nOur goal is to find a multiplicative renormalization factor $r(b)$ such that a rescaled halo property $X' = r(b)X$ preserves the abundance matching relation across different choices of the Friends-of-Friends (FoF) linking length, $b$. Specifically, we require that the cumulative number density of halos in the new catalog (generated with linking length $b$), evaluated at $X'$, is equal to the cumulative number density from the reference catalog (generated with linking length $b_0$) evaluated at the original property value $X$. This condition is expressed as:\n$$\nn_{b}(>X') = n_{b_{0}}(>X)\n$$\nTo proceed, we must first establish a relationship between the new cumulative function $n_{b}(>X)$ and the reference one $n_{b_{0}}(>X)$. The problem states two effects of changing the linking length from $b_0$ to $b$:\n\n1.  A fraction $f_{p}(b)$ of hosts are merged and thus removed from the distinct host catalog. This reduces the number counts by a factor of $(1 - f_{p}(b))$.\n2.  The measured property $X$ for the remaining hosts is rescaled to a new value $X_b = q(b)X$.\n\nLet us determine the cumulative number density $n_b(>\\tilde{X})$ for an arbitrary threshold $\\tilde{X}$ in the new catalog. A halo is counted in $n_b(>\\tilde{X})$ if its rescaled property $X_b$ is greater than $\\tilde{X}$. Using the rescaling relation, this condition becomes $q(b)X > \\tilde{X}$, which is equivalent to $X > \\tilde{X}/q(b)$. This means that the halos contributing to $n_b(>\\tilde{X})$ are precisely those that had an original property $X$ greater than $\\tilde{X}/q(b)$ in the reference $b_0$ catalog.\n\nThe number density of such halos in the reference catalog is $n_{b_{0}}(> \\tilde{X}/q(b))$. Taking into account the percolation-induced loss of hosts, the number density in the new catalog is reduced by the fraction $f_p(b)$. Therefore, the relationship between the two cumulative functions is:\n$$\nn_b(>\\tilde{X}) = (1 - f_p(b)) n_{b_{0}}\\left(> \\frac{\\tilde{X}}{q(b)}\\right)\n$$\nNow, we apply the required condition for our renormalized property $X' = r(b)X$. We set $\\tilde{X} = X'$ in the equation above and equate it to $n_{b_{0}}(>X)$:\n$$\n(1 - f_p(b)) n_{b_{0}}\\left(> \\frac{X'}{q(b)}\\right) = n_{b_{0}}(>X)\n$$\nThe problem specifies that the local logarithmic slope of the reference cumulative function, $\\gamma(X_{0}) \\equiv -\\frac{d\\ln n_{b_{0}}(>X)}{d\\ln X}$ at $X_0$, is approximately constant over the interval of interest. This implies that $n_{b_{0}}(>X)$ can be approximated by a power law in this region:\n$$\nn_{b_{0}}(>X) \\propto X^{-\\gamma(X_{0})}\n$$\nLet's denote $\\gamma \\equiv \\gamma(X_0)$ for notational brevity during the derivation. The proportionality constant is irrelevant as it will cancel out. Substituting this power-law form into our equation:\n$$\n(1 - f_p(b)) \\left( \\frac{X'}{q(b)} \\right)^{-\\gamma} = (X)^{-\\gamma}\n$$\nNow, we substitute $X' = r(b)X$ into this expression:\n$$\n(1 - f_p(b)) \\left( \\frac{r(b)X}{q(b)} \\right)^{-\\gamma} = X^{-\\gamma}\n$$\nWe can separate the terms:\n$$\n(1 - f_p(b)) (r(b))^{-\\gamma} (q(b))^{\\gamma} X^{-\\gamma} = X^{-\\gamma}\n$$\nAssuming $X > 0$, we can cancel the $X^{-\\gamma}$ term from both sides:\n$$\n(1 - f_p(b)) (r(b))^{-\\gamma} (q(b))^{\\gamma} = 1\n$$\nOur goal is to solve for $r(b)$. We first isolate the term containing $r(b)$:\n$$\n(r(b))^{-\\gamma} = \\frac{1}{(1 - f_p(b)) (q(b))^{\\gamma}} = (1 - f_p(b))^{-1} (q(b))^{-\\gamma}\n$$\nTo solve for $r(b)$, we raise both sides of the equation to the power of $-1/\\gamma$:\n$$\nr(b) = \\left[ (1 - f_p(b))^{-1} (q(b))^{-\\gamma} \\right]^{-\\frac{1}{\\gamma}}\n$$\nApplying the exponent to each factor inside the brackets:\n$$\nr(b) = \\left((1 - f_p(b))^{-1}\\right)^{-\\frac{1}{\\gamma}} \\left((q(b))^{-\\gamma}\\right)^{-\\frac{1}{\\gamma}}\n$$\n$$\nr(b) = (1 - f_p(b))^{\\frac{1}{\\gamma}} (q(b))^{1}\n$$\nSubstituting back the full definition $\\gamma = \\gamma(X_0)$, we obtain the final expression for the renormalization factor:\n$$\nr(b) = q(b) \\left(1 - f_p(b)\\right)^{\\frac{1}{\\gamma(X_0)}}\n$$\nThis factor $r(b)$, when applied multiplicatively to the halo property $X$ from a catalog generated with FoF linking length $b$, corrects for both the change in property values and the change in halo number counts, thereby ensuring that the SHAM-inferred galaxy properties remain consistent.", "answer": "$$\n\\boxed{q(b) \\left(1 - f_p(b)\\right)^{\\frac{1}{\\gamma(X_0)}}}\n$$", "id": "3492474"}]}