{"hands_on_practices": [{"introduction": "The stress-energy tensor, $T^{\\mu\\nu}$, is the central mathematical object in any relativistic theory of continuous media. This practice solidifies your understanding by guiding you through the explicit construction of its components for a perfect fluid, connecting abstract covariant forms to the concrete quantities—energy density, momentum, and pressure—measured in a specific reference frame. Mastering this transformation is a foundational skill for deriving and implementing the conservation laws that govern relativistic flows [@problem_id:3536844].", "problem": "Consider a non-magnetized perfect fluid in Special Relativistic Hydrodynamics (SRHD) within flat spacetime, relevant to computational astrophysics applications where primitive states are mapped to conservative variables. Adopt natural units where the speed of light is $c=1$, and use the Minkowski metric $g^{\\mu\\nu}=\\mathrm{diag}(-1,1,1,1)$ with Greek indices running from $0$ to $3$ and Latin indices from $1$ to $3$. The primitive state is given by rest-mass density $\\rho$, thermal pressure $p$, and three-velocity $\\mathbf{v}=(v_{x},v_{y},v_{z})$, with $|\\mathbf{v}|<1$. The Lorentz factor is $\\gamma=\\left(1-|\\mathbf{v}|^{2}\\right)^{-1/2}$, and the equation of state is a $\\Gamma$-law ideal gas with adiabatic index $\\Gamma=\\tfrac{4}{3}$.\n\nUsing only fundamental principles consistent with Lorentz covariance for a perfect fluid and the definition of the four-velocity $u^{\\mu}=\\gamma(1,\\mathbf{v})$, construct the stress-energy tensor $T^{\\mu\\nu}$ in the laboratory frame in terms of $\\rho$, $p$, and $\\mathbf{v}$. In particular:\n- Begin from a valid covariant representation of a perfect fluid’s stress-energy tensor in special relativity and the $\\Gamma$-law equation of state, without assuming any specialized shortcuts.\n- Derive all components $T^{00}$, $T^{0i}$, and $T^{ij}$ explicitly as functions of $\\rho$, $p$, $v_{x}$, $v_{y}$, and $v_{z}$.\n- Verify the symmetry property $T^{\\mu\\nu}=T^{\\nu\\mu}$ and compute the scalar trace $T\\equiv g_{\\mu\\nu}T^{\\mu\\nu}$ for $\\Gamma=\\tfrac{4}{3}$, expressing it in terms of $\\rho$ and $p$.\n\nExpress your final answer as the full $4\\times 4$ matrix $T^{\\mu\\nu}$ with entries written explicitly in terms of $\\rho$, $p$, $v_{x}$, $v_{y}$, $v_{z}$, and $\\gamma$. No numerical evaluation is required. If you introduce intermediate thermodynamic quantities, eliminate them in favor of $\\rho$ and $p$ using the given equation of state before presenting the final matrix. The final answer must be a single closed-form analytical expression for $T^{\\mu\\nu}$ with no units included in the expression.", "solution": "We work in flat spacetime with the Minkowski metric $g^{\\mu\\nu}=\\mathrm{diag}(-1,1,1,1)$ and natural units $c=1$. For a perfect fluid, the stress-energy tensor must be symmetric, rank-two, and Lorentz-covariant, and it must reduce in the comoving frame to energy density and isotropic pressure. The well-tested covariant form that satisfies these requirements is\n$$\nT^{\\mu\\nu}=\\rho h\\,u^{\\mu}u^{\\nu}+p\\,g^{\\mu\\nu},\n$$\nwhere $\\rho$ is the rest-mass density, $u^{\\mu}$ is the four-velocity satisfying $u^{\\mu}u_{\\mu}=-1$, $p$ is the isotropic thermal pressure, and $h$ is the specific enthalpy. The four-velocity in the laboratory frame is\n$$\nu^{\\mu}=\\gamma(1,v_{x},v_{y},v_{z}),\n$$\nwith $\\gamma=(1-|\\mathbf{v}|^{2})^{-1/2}$ and $|\\mathbf{v}|^{2}=v_{x}^{2}+v_{y}^{2}+v_{z}^{2}$. For a $\\Gamma$-law ideal gas,\n$$\np=(\\Gamma-1)\\rho\\epsilon,\n$$\nwhere $\\epsilon$ is the specific internal energy, and the specific enthalpy is\n$$\nh=1+\\epsilon+\\frac{p}{\\rho}.\n$$\nEliminating $\\epsilon$ using the equation of state gives\n$$\n\\epsilon=\\frac{p}{(\\Gamma-1)\\rho}\\quad\\Longrightarrow\\quad h=1+\\frac{p}{(\\Gamma-1)\\rho}+\\frac{p}{\\rho}=1+\\frac{\\Gamma}{\\Gamma-1}\\frac{p}{\\rho}.\n$$\nFor $\\Gamma=\\tfrac{4}{3}$,\n$$\n\\frac{\\Gamma}{\\Gamma-1}=\\frac{\\tfrac{4}{3}}{\\tfrac{1}{3}}=4\\quad\\Longrightarrow\\quad h=1+4\\frac{p}{\\rho}.\n$$\nHence\n$$\n\\rho h=\\rho+4p.\n$$\n\nSubstituting $u^{\\mu}$ and $g^{\\mu\\nu}$ into $T^{\\mu\\nu}=\\rho h\\,u^{\\mu}u^{\\nu}+p\\,g^{\\mu\\nu}$, we obtain component-wise:\n- The time-time component:\n$$\nT^{00}=\\rho h\\,u^{0}u^{0}+p\\,g^{00}=\\rho h\\,\\gamma^{2}+p(-1)=(\\rho+4p)\\gamma^{2}-p.\n$$\n- The time-space components:\n$$\nT^{0i}=\\rho h\\,u^{0}u^{i}+p\\,g^{0i}=\\rho h\\,\\gamma^{2}v_{i}+0=(\\rho+4p)\\gamma^{2}v_{i},\\quad i\\in\\{x,y,z\\}.\n$$\n- The space-space components:\n$$\nT^{ij}=\\rho h\\,u^{i}u^{j}+p\\,g^{ij}=\\rho h\\,\\gamma^{2}v_{i}v_{j}+p\\,\\delta^{ij}=(\\rho+4p)\\gamma^{2}v_{i}v_{j}+p\\,\\delta^{ij}.\n$$\n\nCollecting these into the full matrix in the ordered basis $(0,1,2,3)\\equiv(0,x,y,z)$, we have\n$$\nT^{\\mu\\nu}=\n\\begin{pmatrix}\n(\\rho+4p)\\gamma^{2}-p & (\\rho+4p)\\gamma^{2}v_{x} & (\\rho+4p)\\gamma^{2}v_{y} & (\\rho+4p)\\gamma^{2}v_{z} \\\\\n(\\rho+4p)\\gamma^{2}v_{x} & (\\rho+4p)\\gamma^{2}v_{x}^{2}+p & (\\rho+4p)\\gamma^{2}v_{x}v_{y} & (\\rho+4p)\\gamma^{2}v_{x}v_{z} \\\\\n(\\rho+4p)\\gamma^{2}v_{y} & (\\rho+4p)\\gamma^{2}v_{x}v_{y} & (\\rho+4p)\\gamma^{2}v_{y}^{2}+p & (\\rho+4p)\\gamma^{2}v_{y}v_{z} \\\\\n(\\rho+4p)\\gamma^{2}v_{z} & (\\rho+4p)\\gamma^{2}v_{x}v_{z} & (\\rho+4p)\\gamma^{2}v_{y}v_{z} & (\\rho+4p)\\gamma^{2}v_{z}^{2}+p\n\\end{pmatrix}.\n$$\n\nVerification of symmetry is immediate from construction: $u^{\\mu}u^{\\nu}$ is symmetric in its indices and $g^{\\mu\\nu}$ is symmetric, so $T^{\\mu\\nu}=T^{\\nu\\mu}$.\n\nFor the trace, we contract with the metric:\n$$\nT\\equiv g_{\\mu\\nu}T^{\\mu\\nu}=g_{\\mu\\nu}\\left(\\rho h\\,u^{\\mu}u^{\\nu}+p\\,g^{\\mu\\nu}\\right)=\\rho h\\,u^{\\mu}u_{\\mu}+p\\,g_{\\mu\\nu}g^{\\mu\\nu}.\n$$\nUsing $u^{\\mu}u_{\\mu}=-1$ and $g_{\\mu\\nu}g^{\\mu\\nu}=\\delta^{\\mu}_{\\mu}=4$, we obtain\n$$\nT=-\\rho h+4p.\n$$\nWith $h=1+4p/\\rho$, this becomes\n$$\nT=-\\rho\\left(1+4\\frac{p}{\\rho}\\right)+4p=-\\rho-4p+4p=-\\rho.\n$$\nThus, for $\\Gamma=\\tfrac{4}{3}$, the trace of the perfect fluid stress-energy tensor equals $-\\rho$, independent of $\\mathbf{v}$ and $p$. This is consistent with the expectation that in the comoving frame the energy density equals $E=\\rho+\\rho\\epsilon$, while the enthalpy satisfies $\\rho h=E+p$, ensuring $T^{00}=E$ and isotropic spatial stresses $T^{ii}=p$ at rest, and yields the above trace relation after Lorentz transformation.\n\nTherefore, the full laboratory-frame stress-energy tensor for the given state $(\\rho,p,\\mathbf{v})$ with $\\Gamma=\\tfrac{4}{3}$ is as written above, and it is symmetric with the trace equal to $-\\rho$.", "answer": "$$\\boxed{\n\\begin{pmatrix}\n(\\rho+4p)\\gamma^{2}-p & (\\rho+4p)\\gamma^{2}v_{x} & (\\rho+4p)\\gamma^{2}v_{y} & (\\rho+4p)\\gamma^{2}v_{z} \\\\\n(\\rho+4p)\\gamma^{2}v_{x} & (\\rho+4p)\\gamma^{2}v_{x}^{2}+p & (\\rho+4p)\\gamma^{2}v_{x}v_{y} & (\\rho+4p)\\gamma^{2}v_{x}v_{z} \\\\\n(\\rho+4p)\\gamma^{2}v_{y} & (\\rho+4p)\\gamma^{2}v_{x}v_{y} & (\\rho+4p)\\gamma^{2}v_{y}^{2}+p & (\\rho+4p)\\gamma^{2}v_{y}v_{z} \\\\\n(\\rho+4p)\\gamma^{2}v_{z} & (\\rho+4p)\\gamma^{2}v_{x}v_{z} & (\\rho+4p)\\gamma^{2}v_{y}v_{z} & (\\rho+4p)\\gamma^{2}v_{z}^{2}+p\n\\end{pmatrix}\n}$$", "id": "3536844"}, {"introduction": "Moving from analytical theory to computational practice reveals new challenges, particularly in extreme regimes. In SRHD, the transformation from primitive variables $(\\rho, p, \\mathbf{v})$ to conserved variables $(D, \\mathbf{S}, \\tau)$ depends critically on the Lorentz factor, $\\gamma$. This exercise explores the numerical sensitivity of this transformation, demonstrating how small inaccuracies in calculating $\\gamma$—especially as velocity approaches the speed of light—can be amplified into significant errors in the conserved quantities, a crucial consideration for developing stable and accurate numerical codes [@problem_id:3536896].", "problem": "Consider Special Relativistic Hydrodynamics (SRHD) in units where the speed of light is $c = 1$. Let a finite-volume cell have a cell-averaged three-velocity $\\mathbf{v}$ with squared magnitude $v^2 = \\mathbf{v}\\cdot\\mathbf{v}$, rest-mass density $\\rho$, thermal pressure $p$, and a constant adiabatic index $\\Gamma$ governed by a gamma-law Equation of State (EOS) $p = (\\Gamma - 1)\\rho \\epsilon$, where $\\epsilon$ is the specific internal energy. Define the Lorentz factor by the core special relativistic relation\n$$\n\\gamma = \\frac{1}{\\sqrt{1 - v^2}}.\n$$\nDefine the specific enthalpy by\n$$\nh = 1 + \\epsilon + \\frac{p}{\\rho} = 1 + \\frac{p}{(\\Gamma - 1)\\rho} + \\frac{p}{\\rho},\n$$\nand the standard SRHD conserved variables by\n$$\nD = \\gamma \\rho,\\quad S_i = \\gamma^2 h \\rho\\, v_i,\\quad \\tau = \\gamma^2 h \\rho - p - D,\n$$\nwhere $D$ is the conserved rest-mass density, $\\mathbf{S}$ is the conserved momentum density vector, and $\\tau$ is the conserved energy density minus the rest-mass contribution.\n\nSuppose the computed Lorentz factor has a relative perturbation $\\varepsilon_\\gamma$ such that the perturbed Lorentz factor is\n$$\n\\tilde{\\gamma} = \\gamma(1 + \\varepsilon_\\gamma).\n$$\nHolding $\\rho$, $p$, $\\Gamma$, and $\\mathbf{v}$ fixed, define the perturbed conserved variables $\\tilde{D}$, $\\tilde{\\mathbf{S}}$, and $\\tilde{\\tau}$ by substituting $\\tilde{\\gamma}$ in place of $\\gamma$ in the above definitions. For each conserved quantity $X \\in \\{D, \\|\\mathbf{S}\\|_2, \\tau\\}$, where $\\|\\mathbf{S}\\|_2$ denotes the Euclidean norm of $\\mathbf{S}$, define the measured relative error by\n$$\n\\mathrm{rel\\_err}(X) =\n\\begin{cases}\n\\frac{\\left| \\tilde{X} - X \\right|}{\\left| X \\right|}, & \\text{if } \\left| X \\right| > 0,\\\\\n0, & \\text{if } X = 0,\n\\end{cases}\n$$\ncomputed in $64$-bit IEEE $754$ double precision.\n\nYour task is to compute $\\gamma$, $D$, $\\mathbf{S}$, and $\\tau$, then apply the perturbation $\\varepsilon_\\gamma$ to $\\gamma$ and recompute the perturbed quantities, and finally compute $\\mathrm{rel\\_err}(D)$, $\\mathrm{rel\\_err}(\\|\\mathbf{S}\\|_2)$, and $\\mathrm{rel\\_err}(\\tau)$ for each test case given below. All quantities are dimensionless in these relativistic units. Implement all computations in double precision and treat all inputs as double-precision numbers.\n\nUse the following test suite of parameter sets $(\\rho, p, \\Gamma, \\mathbf{v}, \\varepsilon_\\gamma)$:\n\n- Test $1$:\n$$\n(\\rho, p, \\Gamma, \\mathbf{v}, \\varepsilon_\\gamma) = \\left(1.0,\\, 0.1,\\, \\frac{4}{3},\\, (0.0,\\, 0.0,\\, 0.0),\\, \\varepsilon_{\\text{mach}}\\right),\n$$\nwhere $\\varepsilon_{\\text{mach}}$ is the double-precision machine epsilon.\n\n- Test $2$: \n$$\n(\\rho, p, \\Gamma, \\mathbf{v}, \\varepsilon_\\gamma) = \\left(1.0,\\, 1.0,\\, \\frac{5}{3},\\, (0.3,\\, 0.4,\\, 0.0),\\, 10^{-12}\\right).\n$$\n\n- Test $3$: \n$$\n(\\rho, p, \\Gamma, \\mathbf{v}, \\varepsilon_\\gamma) = \\left(1.0,\\, 0.01,\\, \\frac{4}{3},\\, (0.6,\\, 0.6,\\, 0.0),\\, 10^{-8}\\right).\n$$\n\n- Test $4$: \n$$\n(\\rho, p, \\Gamma, \\mathbf{v}, \\varepsilon_\\gamma) = \\left(0.1,\\, 10.0,\\, \\frac{4}{3},\\, (0.99,\\, 0.0,\\, 0.0),\\, 10^{-12}\\right).\n$$\n\n- Test $5$: \n$$\n(\\rho, p, \\Gamma, \\mathbf{v}, \\varepsilon_\\gamma) = \\left(1.0,\\, 100.0,\\, \\frac{4}{3},\\, (0.0,\\, 0.999999,\\, 0.0),\\, 10^{-8}\\right).\n$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is itself a bracketed triple of the three measured relative errors $[\\mathrm{rel\\_err}(D), \\mathrm{rel\\_err}(\\|\\mathbf{S}\\|_2), \\mathrm{rel\\_err}(\\tau)]$. For example, the output format must be\n$$\n[\\,[x_1, y_1, z_1],\\,[x_2, y_2, z_2],\\,\\dots,\\,[x_5, y_5, z_5]\\,],\n$$\nwith all $x_k$, $y_k$, $z_k$ reported as floating-point numbers.", "solution": "The user has provided a problem statement that requires the computation of relative errors in the conserved variables of special relativistic hydrodynamics (SRHD) when the Lorentz factor is perturbed.\n\n### Problem Validation\nThe problem statement has been validated and is deemed valid.\n\n1.  **Givens Extraction**: All definitions, variables, and parameters are explicitly provided. These include the SRHD primitive variables ($\\rho, p, \\mathbf{v}$), the adiabatic index $\\Gamma$, the definitions for the Lorentz factor $\\gamma$, specific enthalpy $h$, and the conserved variables ($D, \\mathbf{S}, \\tau$). The perturbation scheme and the formula for relative error are also clearly defined, along with a complete set of test cases.\n2.  **Validation against Criteria**:\n    - **Scientifically Grounded**: The problem is based on the standard, well-established equations of SRHD, using a conventional gamma-law equation of state. These are fundamental principles in computational astrophysics. The analysis of error propagation due to a perturbation is a standard technique in numerical analysis.\n    - **Well-Posed**: The problem is deterministic and computationally straightforward. For each set of inputs, the sequence of calculations is explicitly defined, leading to a unique, meaningful solution.\n    - **Objective**: The problem is stated in precise, unambiguous scientific language, free from subjective or opinion-based content.\n\nThe problem contains no scientific flaws, ambiguities, or missing information. It represents a valid and well-posed computational exercise. Therefore, I will proceed with the solution.\n\n### Solution Derivation\nThe task is to calculate the propagation of a relative perturbation $\\varepsilon_\\gamma$ in the Lorentz factor $\\gamma$ to the SRHD conserved variables $D$, $\\|\\mathbf{S}\\|_2$, and $\\tau$. The solution involves a direct implementation of the provided formulae in double-precision arithmetic. The overall algorithm for each test case is as follows:\n\n1.  **Compute Baseline Physical Quantities**: First, we compute the unperturbed physical quantities based on the input primitive variables ($\\rho, p, \\Gamma, \\mathbf{v}$).\n    - The squared magnitude of the three-velocity is $v^2 = \\mathbf{v} \\cdot \\mathbf{v}$.\n    - The Lorentz factor is calculated from its definition:\n      $$\n      \\gamma = \\frac{1}{\\sqrt{1 - v^2}}\n      $$\n    - The specific enthalpy, $h$, is given by $h = 1 + \\epsilon + p/\\rho$. Using the gamma-law EOS, $p = (\\Gamma-1)\\rho\\epsilon$, we can express the specific internal energy as $\\epsilon = \\frac{p}{(\\Gamma-1)\\rho}$. Substituting this into the definition of $h$ and simplifying yields a form directly computable from the inputs:\n      $$\n      h = 1 + \\frac{\\Gamma p}{(\\Gamma-1)\\rho}\n      $$\n    - Using these intermediate quantities, we compute the unperturbed conserved variables:\n      - Conserved rest-mass density: $D = \\gamma \\rho$\n      - Magnitude of conserved momentum density: $\\|\\mathbf{S}\\|_2 = \\gamma^2 h \\rho \\|\\mathbf{v}\\|_2 = \\gamma^2 h \\rho v$, where $v = \\sqrt{v^2}$.\n      - Conserved energy density: $\\tau = \\gamma^2 h \\rho - p - D$\n\n2.  **Compute Perturbed Quantities**: Next, we introduce the perturbation to the Lorentz factor and compute the corresponding perturbed conserved variables. The primitive variables $\\rho$, $p$, $\\Gamma$, and $\\mathbf{v}$ (and thus $h$ and $v$) are held constant.\n    - The perturbed Lorentz factor is $\\tilde{\\gamma} = \\gamma(1 + \\varepsilon_\\gamma)$.\n    - The perturbed conserved variables are calculated by substituting $\\tilde{\\gamma}$ for $\\gamma$ in the definitions:\n      - Perturbed conserved rest-mass density: $\\tilde{D} = \\tilde{\\gamma} \\rho$\n      - Magnitude of perturbed conserved momentum density: $\\|\\tilde{\\mathbf{S}}\\|_2 = \\tilde{\\gamma}^2 h \\rho v$\n      - Perturbed conserved energy density: $\\tilde{\\tau} = \\tilde{\\gamma}^2 h \\rho - p - \\tilde{D}$\n\n3.  **Compute Relative Errors**: Finally, we compute the measured relative error for each conserved quantity $X \\in \\{D, \\|\\mathbf{S}\\|_2, \\tau\\}$ using the given formula:\n    $$\n    \\mathrm{rel\\_err}(X) = \\frac{\\left| \\tilde{X} - X \\right|}{\\left| X \\right|}\n    $$\n    A special condition is applied: if $|X|=0$, then $\\mathrm{rel\\_err}(X) = 0$. This case is relevant for $\\|\\mathbf{S}\\|_2$ when the fluid is at rest ($\\mathbf{v}=0$).\n\nThis three-step procedure is applied to each test case. All calculations are performed using $64$-bit double-precision floating-point numbers, as specified. For Test $1$, the double-precision machine epsilon, $\\varepsilon_{\\text{mach}}$, is used for $\\varepsilon_\\gamma$, obtained from standard numerical library functions. The final results are then formatted into a single string according to the specified output structure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes relative errors in SRHD conserved variables due to a perturbation\n    in the Lorentz factor for a suite of test cases.\n    \"\"\"\n\n    def compute_srhd_errors(rho, p, Gamma, v_vec, eps_gamma):\n        \"\"\"\n        Calculates the relative errors for a single set of parameters.\n        All computations are in double precision.\n\n        Args:\n            rho (float): Rest-mass density.\n            p (float): Thermal pressure.\n            Gamma (float): Adiabatic index.\n            v_vec (tuple): Three-velocity vector.\n            eps_gamma (float): Relative perturbation in the Lorentz factor.\n\n        Returns:\n            list: A list containing the three relative errors\n                  [rel_err(D), rel_err(||S||_2), rel_err(tau)].\n        \"\"\"\n        # Ensure v_vec is a numpy array for vector operations\n        v_np = np.array(v_vec, dtype=np.float64)\n\n        # 1. Calculate unperturbed physical quantities\n        v_squared = np.dot(v_np, v_np)\n        \n        # Check for unphysical velocity\n        if v_squared >= 1.0:\n            # Per problem spec, data is well-behaved. This is for robustness.\n            raise ValueError(\"Velocity magnitude must be less than the speed of light (c=1).\")\n        \n        v_norm = np.sqrt(v_squared)\n        \n        # Lorentz factor\n        gamma = 1.0 / np.sqrt(1.0 - v_squared)\n        \n        # Specific enthalpy\n        h = 1.0 + Gamma * p / (rho * (Gamma - 1.0))\n        \n        # Conserved variables (unperturbed)\n        D = gamma * rho\n        S_norm = gamma**2 * h * rho * v_norm\n        tau = gamma**2 * h * rho - p - D\n        \n        # 2. Calculate perturbed quantities\n        gamma_tilde = gamma * (1.0 + eps_gamma)\n        \n        # Conserved variables (perturbed)\n        D_tilde = gamma_tilde * rho\n        S_norm_tilde = gamma_tilde**2 * h * rho * v_norm\n        tau_tilde = gamma_tilde**2 * h * rho - p - D_tilde\n        \n        # 3. Compute relative errors\n        def rel_err(X_tilde, X):\n            \"\"\"Computes the relative error as defined in the problem.\"\"\"\n            if np.abs(X) == 0.0:\n                return 0.0\n            return np.abs(X_tilde - X) / np.abs(X)\n            \n        err_D = rel_err(D_tilde, D)\n        err_S = rel_err(S_norm_tilde, S_norm)\n        err_tau = rel_err(tau_tilde, tau)\n        \n        return [err_D, err_S, err_tau]\n\n    # Double-precision machine epsilon\n    eps_mach = np.finfo(np.float64).eps\n    \n    # Test suite from the problem statement\n    test_cases = [\n        (1.0, 0.1, 4.0/3.0, (0.0, 0.0, 0.0), eps_mach),\n        (1.0, 1.0, 5.0/3.0, (0.3, 0.4, 0.0), 1e-12),\n        (1.0, 0.01, 4.0/3.0, (0.6, 0.6, 0.0), 1e-8),\n        (0.1, 10.0, 4.0/3.0, (0.99, 0.0, 0.0), 1e-12),\n        (1.0, 100.0, 4.0/3.0, (0.0, 0.999999, 0.0), 1e-8)\n    ]\n    \n    results = []\n    for case in test_cases:\n        result_triple = compute_srhd_errors(*case)\n        results.append(result_triple)\n\n    # Format the final output string exactly as specified\n    formatted_triples = [f\"[{t[0]},{t[1]},{t[2]}]\" for t in results]\n    final_output_string = f\"[{','.join(formatted_triples)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "3536896"}, {"introduction": "Shock waves are ubiquitous in high-energy astrophysics and represent a fundamental test for any SRHD code. This advanced practice challenges you to build a solver for the relativistic shock jump conditions, which are the integral form of the conservation laws derived from $T^{\\mu\\nu}$ across a discontinuity. You will implement the Taub adiabat to find the post-shock state and explore how the shock's properties, such as its compression ratio, are fundamentally altered by the underlying physics encapsulated in different equations of state (EOS) [@problem_id:3536875].", "problem": "You are asked to write a complete and runnable program that implements a hierarchy of Equation of State (EOS) models and a solver for one-dimensional planar shocks in Special Relativistic Hydrodynamics (SRHD), with an additional check on the Special Relativistic Magnetohydrodynamics (SRMHD) degeneracy when the magnetic field vanishes. The program must compute, for given upstream states, the shock compression ratio and the post-shock effective adiabatic index, and aggregate the results for a specified test suite into a single line of output. All computations shall be performed in code units with speed of light $c=1$, Boltzmann constant $k_{\\mathrm{B}}=1$, and particle mass $m=1$, so that temperature-like quantities are dimensionless. No angles are involved.\n\nThe fundamental base consists of:\n- Conservation of rest mass, momentum, and energy for a steady, planar shock in the shock rest frame for a perfect fluid: these yield the Rankine–Hugoniot relations. Let upstream quantities be $(\\rho_1, p_1, v_1)$, where $\\rho$ is rest-mass density, $p$ is thermal pressure, and $v$ is the flow velocity along the shock normal. Let $\\gamma = 1/\\sqrt{1-v^2}$ be the Lorentz factor. Define the specific enthalpy per unit rest mass as $h = 1 + \\epsilon + p/\\rho$, where $\\epsilon$ is the specific internal energy (excluding rest mass).\n- Denote the enthalpy density by $w = \\rho h$, and the mass flux $j = \\rho \\gamma v$. For a perfect fluid, a well-tested set of relations that follow from the conservation laws in the shock rest frame is the Taub jump condition (also called the Taub adiabat) and the mass-flux relation:\n$$\nh_2^2 - h_1^2 = (p_2 - p_1)\\left(\\frac{h_2}{\\rho_2} + \\frac{h_1}{\\rho_1}\\right),\n$$\n$$\nj^2 = \\frac{p_2 - p_1}{\\frac{h_1}{\\rho_1} - \\frac{h_2}{\\rho_2}},\n$$\nwhere subscript $1$ denotes upstream and subscript $2$ denotes downstream quantities.\n- For Special Relativistic Hydrodynamics (SRHD), these relations, together with an EOS $h(p,\\rho)$, determine the downstream state $(\\rho_2,p_2,v_2)$ from the upstream state $(\\rho_1,p_1,v_1)$.\n\nYou must implement three EOS models:\n1. Ideal-gas EOS with constant adiabatic index: $p = (\\Gamma - 1)\\rho \\epsilon$, which implies $h = 1 + \\frac{\\Gamma}{\\Gamma - 1}\\frac{p}{\\rho}$ for a given constant $\\Gamma$.\n2. Synge EOS (relativistic Maxwell–Jüttner gas) for a single species with normalized mass, for which the pressure is $p = \\rho \\Theta$ with dimensionless temperature $\\Theta = k_{\\mathrm{B}}T/mc^2$, and the specific enthalpy is given by modified Bessel functions of the second kind:\n$$\nh(\\Theta) = \\frac{K_3(1/\\Theta)}{K_2(1/\\Theta)},\n$$\nwith $K_\\nu$ denoting the modified Bessel function of the second kind of order $\\nu$. In the adopted code units, $p/\\rho = \\Theta$.\n3. Tabulated EOS that provides $h(\\Theta)$ via monotone interpolation from a fixed in-program table of $(\\Theta, h)$ values computed by the Synge EOS on a prescribed grid of $\\Theta$ values.\n\nDefine the post-shock effective adiabatic index $\\Gamma_{\\mathrm{eff},2}$ for any EOS by the algebraic identity that matches the ideal-gas enthalpy relation at the downstream state:\n$$\nh_2 = 1 + \\frac{\\Gamma_{\\mathrm{eff},2}}{\\Gamma_{\\mathrm{eff},2} - 1}\\frac{p_2}{\\rho_2}.\n$$\nSolving for $\\Gamma_{\\mathrm{eff},2}$ yields\n$$\n\\Gamma_{\\mathrm{eff},2} = \\frac{h_2 - 1}{(h_2 - 1) - \\frac{p_2}{\\rho_2}}.\n$$\n\nAlgorithmic specification to obtain the downstream state for a given upstream state and EOS:\n- Given $(\\rho_1, p_1, v_1)$, compute $\\gamma_1 = 1/\\sqrt{1-v_1^2}$, the upstream specific enthalpy $h_1$ from the EOS, and the squared mass flux $j^2 = (\\rho_1 \\gamma_1 v_1)^2$.\n- The unknown $p_2$ is determined by imposing the Taub jump condition. To evaluate the residual for a trial $p_2$, you must obtain $(h_2, \\rho_2)$ consistently with the EOS and the mass-flux relation. Introduce the dimensionless downstream temperature-like variable $\\Theta_2 = p_2/\\rho_2$. For a given trial $p_2$, define\n$$\nA(p_2) = \\frac{h_1}{\\rho_1} - \\frac{p_2 - p_1}{j^2}.\n$$\nUsing the mass-flux relation, the consistency relation is $\\frac{h_2}{\\rho_2} = A(p_2)$. In terms of $\\Theta_2$ and the EOS, this becomes the scalar equation\n$$\ng(\\Theta_2; p_2) = \\Theta_2 \\, h(\\Theta_2) - p_2 \\, A(p_2) = 0,\n$$\nwhose solution yields $\\Theta_2$, then $\\rho_2 = p_2 / \\Theta_2$, and $h_2 = h(\\Theta_2)$.\n- Define the Taub residual function\n$$\nR(p_2) = h_2^2 - h_1^2 - (p_2 - p_1)\\left(\\frac{h_2}{\\rho_2} + \\frac{h_1}{\\rho_1}\\right),\n$$\nand solve $R(p_2) = 0$ for $p_2$ using a robust bracketed root-finding scheme over $p_2 \\in (p_1, p_{\\max})$ with $p_{\\max} = p_1 + \\alpha \\, j^2 \\, (h_1/\\rho_1)$ for some $\\alpha \\in (0,1)$ to ensure $A(p_2) > 0$. For each evaluation of $R(p_2)$, solve $g(\\Theta_2; p_2) = 0$ via a bracketed scalar root-finder over $\\Theta_2 \\in [\\Theta_{\\min}, \\Theta_{\\max}]$ with fixed bounds, exploiting monotonicity of $h(\\Theta)$ in $\\Theta$.\n\nFor the Special Relativistic Magnetohydrodynamics (SRMHD) degeneracy check, consider the case of a vanishing magnetic field. In ideal SRMHD with zero magnetic field, the jump conditions reduce exactly to those of SRHD, so the computed $(\\rho_2, p_2)$, compression ratio $r = \\rho_2/\\rho_1$, and downstream effective adiabatic index $\\Gamma_{\\mathrm{eff},2}$ coincide with the SRHD solution.\n\nYou must implement all three EOS classes (ideal, Synge, tabulated by interpolation), the solver described above, and compute for each test case the shock compression ratio $r$ and the post-shock effective adiabatic index $\\Gamma_{\\mathrm{eff},2}$. All results are dimensionless in the stated code units. Express each floating-point result rounded to six decimal places.\n\nTest suite:\n- Case 1 (SRHD, ideal EOS, cold-moderate shock): $\\rho_1 = 1.0$, $p_1 = 10^{-3}$, $v_1 = 0.5$, $\\Gamma = 5/3$.\n- Case 2 (SRHD, ideal EOS, strong-ultrarelativistic inflow): $\\rho_1 = 1.0$, $p_1 = 10^{-3}$, $v_1 = 0.9$, $\\Gamma = 4/3$.\n- Case 3 (SRHD, Synge EOS, moderately hot upstream): $\\rho_1 = 1.0$, $p_1 = 0.1$, $v_1 = 0.9$.\n- Case 4 (SRHD, Synge EOS, hot upstream): $\\rho_1 = 1.0$, $p_1 = 1.0$, $v_1 = 0.95$.\n- Case 5 (SRHD, tabulated EOS approximating Synge, moderately hot upstream): $\\rho_1 = 1.0$, $p_1 = 0.1$, $v_1 = 0.9$, with a fixed in-program table of $(\\Theta, h)$ values generated from the Synge EOS for $\\Theta \\in \\{0.01, 0.05, 0.1, 0.5, 1.0, 2.0, 5.0\\}$, and linear interpolation used to evaluate $h(\\Theta)$.\n- Case 6 (SRMHD degeneracy with zero magnetic field, ideal EOS): $\\rho_1 = 1.0$, $p_1 = 10^{-3}$, $v_1 = 0.9$, $\\Gamma = 4/3$, with zero magnetic field, which must reproduce the Case 2 SRHD solution.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets. Each inner list must contain two floats, the compression ratio $r$ and the post-shock effective adiabatic index $\\Gamma_{\\mathrm{eff},2}$, both rounded to six decimal places. For example, it should look like\n$[ [r_1,\\Gamma_{\\mathrm{eff},2,1}], [r_2,\\Gamma_{\\mathrm{eff},2,2}], \\ldots ]$,\nwith no extra text. The brackets and commas must be formatted exactly as in Python list string representation.\n\nScientific realism and constraints:\n- Use only the specified runtime environment and libraries. The Synge EOS must use modified Bessel functions of the second kind from a supported numerical library. The tabulated EOS must use monotone linear interpolation on the provided $\\Theta$ grid. The solver must be robust to the provided test cases by using bracketed root-finding for both nested scalar equations. All computations must adhere to $c=1$ units.\n\nDeliverables:\n- A complete program that performs the described computations and prints the aggregated results in the specified format.", "solution": "The problem requires the implementation of a numerical solver for one-dimensional, steady, planar shocks in special relativistic hydrodynamics (SRHD). The solution must be computed for several test cases involving different equations of state (EOS). The core of the problem lies in solving the relativistic Rankine-Hugoniot jump conditions.\n\nThe fundamental physical principles are the conservation of rest mass, momentum, and energy across the shock front. In the rest frame of the shock, these conservation laws for a perfect fluid lead to a system of algebraic equations connecting the upstream (pre-shock, subscript $1$) and downstream (post-shock, subscript $2$) fluid states. The state of the fluid is described by its rest-mass density $\\rho$, pressure $p$, and velocity $v$. It is convenient to use the specific enthalpy $h = 1 + \\epsilon + p/\\rho$, where $\\epsilon$ is the specific internal energy, and the Lorentz factor $\\gamma = (1 - v^2)^{-1/2}$. All calculations are performed in units where the speed of light $c=1$.\n\nThe governing equations provided are the Taub jump condition and the mass-flux relation:\n$$\nh_2^2 - h_1^2 = (p_2 - p_1)\\left(\\frac{h_2}{\\rho_2} + \\frac{h_1}{\\rho_1}\\right)\n$$\n$$\nj^2 = \\frac{p_2 - p_1}{\\frac{h_1}{\\rho_1} - \\frac{h_2}{\\rho_2}}\n$$\nHere, $j = \\rho \\gamma v$ is the conserved mass flux across the shock. Given an upstream state $(\\rho_1, p_1, v_1)$ and an EOS, these two equations, solved simultaneously, determine the downstream state.\n\nThe problem specifies an algorithmic procedure based on a nested root-finding approach. The outer problem is to find the downstream pressure $p_2$ that satisfies the Taub condition. For any trial value of $p_2$, the corresponding downstream density $\\rho_2$ and specific enthalpy $h_2$ must be found. This constitutes the inner problem.\n\nLet's formalize the nested solver structure. First, we compute the known upstream quantities: $\\gamma_1 = (1 - v_1^2)^{-1/2}$, $h_1$ (via the EOS), and the squared mass flux $j^2 = (\\rho_1 \\gamma_1 v_1)^2$.\n\nThe inner problem is to find the downstream state consistent with the mass-flux relation and the EOS, for a given trial $p_2$. We can rearrange the mass-flux relation to express the downstream quantity $h_2/\\rho_2$ in terms of knowns and the trial $p_2$:\n$$\n\\frac{h_2}{\\rho_2} = \\frac{h_1}{\\rho_1} - \\frac{p_2 - p_1}{j^2} \\equiv A(p_2)\n$$\nThe EOS provides a relationship between $h_2$, $p_2$, and $\\rho_2$. We introduce the dimensionless temperature-like variable $\\Theta_2 = p_2/\\rho_2$. The EOS can then be written as $h_2 = h(\\Theta_2)$. Substituting $\\rho_2 = p_2/\\Theta_2$ into the previous equation gives:\n$$\n\\frac{h(\\Theta_2)}{p_2/\\Theta_2} = A(p_2) \\implies \\Theta_2 h(\\Theta_2) - p_2 A(p_2) = 0\n$$\nWe define the inner residual function $g(\\Theta_2; p_2) = \\Theta_2 h(\\Theta_2) - p_2 A(p_2)$. For a given $p_2$, we solve $g(\\Theta_2; p_2) = 0$ for $\\Theta_2$ using a bracketed root-finding method, such as the Brent-Dekker method. Since the function $f(\\Theta) = \\Theta h(\\Theta)$ is monotonically increasing for any physical EOS, a unique solution for $\\Theta_2$ is guaranteed within a sufficiently large bracket $[\\Theta_{\\min}, \\Theta_{\\max}]$.\n\nOnce $\\Theta_2$ is found, we have $\\rho_2 = p_2/\\Theta_2$ and $h_2 = h(\\Theta_2)$. These values are then used in the outer problem, which involves solving the Taub jump condition. We define the Taub residual function:\n$$\nR(p_2) = h_2^2 - h_1^2 - (p_2 - p_1)\\left(\\frac{h_2}{\\rho_2} + \\frac{h_1}{\\rho_1}\\right)\n$$\nWe seek the root of $R(p_2) = 0$ for $p_2 > p_1$. The search for $p_2$ is performed within a physically motivated bracket $(p_1, p_{\\max})$. A valid upper bound $p_{\\max}$ is derived from the requirement that $h_2/\\rho_2 = A(p_2)$ must be positive. This implies $p_2 < p_1 + j^2 (h_1/\\rho_1)$. We choose $p_{\\max} = p_1 + \\alpha j^2 (h_1/\\rho_1)$ with $\\alpha < 1$ (e.g., $\\alpha = 0.9999$) to define a safe search interval. A robust bracketed root-finder is again employed to find $p_2$.\n\nThe implementation will feature a class-based design for the EOS models, with an abstract base class `EOS` defining the interface, and concrete classes for the three required models:\n1.  **Ideal-gas EOS**: For a constant adiabatic index $\\Gamma$, the pressure is $p = (\\Gamma-1)\\rho\\epsilon$, which translates to $h(\\Theta) = 1 + \\frac{\\Gamma}{\\Gamma-1}\\Theta$, where $\\Theta=p/\\rho$.\n2.  **Synge EOS**: This describes a relativistic perfect gas. The specific enthalpy is given by $h(\\Theta) = K_3(1/\\Theta)/K_2(1/\\Theta)$, where $K_\\nu$ is the modified Bessel function of the second kind of order $\\nu$. This requires functions from a numerical library like `SciPy`.\n3.  **Tabulated EOS**: This model approximates the Synge EOS by performing linear interpolation on a pre-computed table of $(\\Theta, h)$ values.\n\nAfter solving for the downstream state $(p_2, \\rho_2)$, we compute two quantities of interest: the compression ratio $r = \\rho_2/\\rho_1$ and the effective post-shock adiabatic index $\\Gamma_{\\mathrm{eff},2}$. The latter is defined by forcing the ideal gas enthalpy relation to hold for the computed post-shock state:\n$$\nh_2 = 1 + \\frac{\\Gamma_{\\mathrm{eff},2}}{\\Gamma_{\\mathrm{eff},2} - 1}\\frac{p_2}{\\rho_2} \\implies \\Gamma_{\\mathrm{eff},2} = \\frac{h_2 - 1}{h_2 - 1 - p_2/\\rho_2}\n$$\nThe program is structured to execute this entire procedure for each of the six test cases. This includes a check of the SRMHD degeneracy, where the SRHD code is run with parameters corresponding to an ideal SRMHD shock with a vanishing magnetic field, which must yield the same result as the equivalent SRHD problem. The final results are collected and printed in a specific list-of-lists format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import kn\nfrom scipy.optimize import brentq\nfrom abc import ABC, abstractmethod\n\nclass EOS(ABC):\n    \"\"\"Abstract base class for Equations of State.\"\"\"\n    @abstractmethod\n    def h_from_theta(self, theta: float) -> float:\n        \"\"\"Calculates specific enthalpy from dimensionless temperature.\"\"\"\n        pass\n\n    def h_from_p_rho(self, p: float, rho: float) -> float:\n        \"\"\"Calculates specific enthalpy from pressure and rest-mass density.\"\"\"\n        if rho = 0:\n            return 1.0\n        theta = p / rho\n        return self.h_from_theta(theta)\n\nclass IdealEOS(EOS):\n    \"\"\"Ideal gas Equation of State with a constant adiabatic index.\"\"\"\n    def __init__(self, gamma_ad: float):\n        if gamma_ad = 1.0:\n            raise ValueError(\"Adiabatic index must be > 1.\")\n        self.gamma_ad = gamma_ad\n        self.factor = gamma_ad / (gamma_ad - 1.0)\n    \n    def h_from_theta(self, theta: float) -> float:\n        return 1.0 + self.factor * theta\n\nclass SyngeEOS(EOS):\n    \"\"\"Synge Equation of State for a relativistic Maxwell-Jüttner gas.\"\"\"\n    def h_from_theta(self, theta: float) -> float:\n        if theta  1e-15:  # Cold limit\n            return 1.0\n        inv_theta = 1.0 / theta\n        # For very large arguments, kn can be 0, h -> 1 in this limit.\n        if inv_theta > 700:\n            return 1.0\n        # The ratio is well-behaved even if individual kn values are large.\n        return kn(3, inv_theta) / kn(2, inv_theta)\n\nclass TabulatedEOS(EOS):\n    \"\"\"Tabulated Equation of State based on Synge gas values.\"\"\"\n    def __init__(self):\n        synge_ref = SyngeEOS()\n        self.theta_points = np.array([0.01, 0.05, 0.1, 0.5, 1.0, 2.0, 5.0])\n        self.h_points = np.array([synge_ref.h_from_theta(t) for t in self.theta_points])\n\n    def h_from_theta(self, theta: float) -> float:\n        # np.interp handles extrapolation by using boundary values, which is acceptable.\n        return np.interp(theta, self.theta_points, self.h_points)\n\ndef solve_shock(rho1: float, p1: float, v1: float, eos: EOS) -> tuple[float, float]:\n    \"\"\"\n    Solves the SRHD shock jump conditions for a given upstream state and EOS.\n    Returns the compression ratio and post-shock effective adiabatic index.\n    \"\"\"\n    gamma1 = 1.0 / np.sqrt(1.0 - v1**2)\n    h1 = eos.h_from_p_rho(p1, rho1)\n    j2 = (rho1 * gamma1 * v1)**2\n\n    # Inner residual for theta2 solver\n    def g_theta2(theta2: float, p2: float) -> float:\n        A_p2 = h1 / rho1 - (p2 - p1) / j2\n        # A_p2 must be > 0 for a physical solution.\n        # The p2 bracket ensures this.\n        h2 = eos.h_from_theta(theta2)\n        return theta2 * h2 - p2 * A_p2\n        \n    # Outer residual for p2 solver (Taub residual)\n    def R_p2(p2: float) -> float:\n        # Solve for theta2 for the trial p2\n        try:\n            # The function g_theta2 is monotonic, so a solution exists if the bracket\n            # contains the root.\n            theta2 = brentq(lambda t2: g_theta2(t2, p2), 1e-8, 1e4)\n        except ValueError:\n            # Failure to find a root for theta2 likely means p2 is out of bounds\n            # such that g_theta2 does not cross zero in the bracket.\n            # This is typically because A_p2 becomes non-positive.\n            return -1e100 # Return a large negative number to guide solver\n            \n        rho2 = p2 / theta2\n        h2 = eos.h_from_theta(theta2)\n        \n        term_p = (p2 - p1) * (h2 / rho2 + h1 / rho1)\n        return h2**2 - h1**2 - term_p\n        \n    # Set up bracketing for the p2 root-finder\n    p_min_bracket = p1 * (1.0 + 1e-9) # Must be a compressive shock\n    alpha = 0.9999 # Safety factor to keep A(p2) > 0\n    p_max_bracket = p1 + alpha * j2 * (h1 / rho1)\n\n    p2 = brentq(R_p2, p_min_bracket, p_max_bracket)\n    \n    # Recalculate final state with converged p2\n    theta2 = brentq(lambda t2: g_theta2(t2, p2), 1e-8, 1e4)\n    rho2 = p2 / theta2\n    h2 = eos.h_from_theta(theta2)\n\n    # Compute final results\n    r = rho2 / rho1\n    \n    eps2_over_rho2 = h2 - 1.0 - theta2\n    if eps2_over_rho2 = 0:\n        # This case is unphysical and indicates an error or an extreme limit\n        gamma_eff_2 = float('inf')\n    else:\n        gamma_eff_2 = (h2 - 1.0) / eps2_over_rho2\n        \n    return r, gamma_eff_2\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        {'rho1': 1.0, 'p1': 1e-3, 'v1': 0.5, 'eos': IdealEOS(5.0/3.0)},\n        {'rho1': 1.0, 'p1': 1e-3, 'v1': 0.9, 'eos': IdealEOS(4.0/3.0)},\n        {'rho1': 1.0, 'p1': 0.1,  'v1': 0.9, 'eos': SyngeEOS()},\n        {'rho1': 1.0, 'p1': 1.0,  'v1': 0.95, 'eos': SyngeEOS()},\n        {'rho1': 1.0, 'p1': 0.1,  'v1': 0.9, 'eos': TabulatedEOS()},\n        {'rho1': 1.0, 'p1': 1e-3, 'v1': 0.9, 'eos': IdealEOS(4.0/3.0)}, # SRMHD degeneracy check\n    ]\n\n    results = []\n    for case in test_cases:\n        r, g_eff = solve_shock(case['rho1'], case['p1'], case['v1'], case['eos'])\n        results.append(f\"[{r:.6f},{g_eff:.6f}]\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3536875"}]}