{"hands_on_practices": [{"introduction": "Validating a sophisticated numerical tool like a magnetohydrodynamics (MHD) code is a multifaceted process that goes far beyond a single check. A comprehensive verification plan requires a carefully selected suite of test problems, where each test is chosen to rigorously probe a specific aspect of the code's performance. This practice [@problem_id:3520099] challenges you to design such a plan, distinguishing between tests for formal accuracy on smooth flows, robustness in handling shocks, and the crucial ability to maintain physical constraints like the divergence-free condition of the magnetic field.", "problem": "Consider the ideal equations of Magnetohydrodynamics (MHD), which in conservation form consist of the mass conservation, momentum conservation, induction, and total energy equations together with the solenoidal constraint. With primitive variables density $\\,\\rho\\,$, velocity $\\,\\mathbf{v}\\,$, magnetic field $\\,\\mathbf{B}\\,$, gas pressure $\\,p\\,$, and adiabatic index $\\,\\gamma\\,$, the system can be summarized as:\n$$\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0,$$\n$$\\partial_t (\\rho \\mathbf{v}) + \\nabla \\cdot \\left[\\rho \\mathbf{v}\\mathbf{v} + \\left(p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{I} - \\mathbf{B}\\mathbf{B}\\right] = 0,$$\n$$\\partial_t E + \\nabla \\cdot \\left[\\left(E + p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B}\\right] = 0,$$\n$$\\partial_t \\mathbf{B} + \\nabla \\cdot (\\mathbf{v}\\mathbf{B} - \\mathbf{B}\\mathbf{v}) = 0,$$\nsubject to the divergence-free condition\n$$\\nabla \\cdot \\mathbf{B} = 0,$$\nand with total energy $\\,E = \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho \\|\\mathbf{v}\\|^2 + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2.$$\n\nA computational astrophysics code claims to be high-order accurate for smooth flows, robust for discontinuities, and capable of controlling divergence errors in the magnetic field. You are asked to select a verification plan that uses a combination of linear wave propagation, the Brio–Wu shock tube, the magnetic rotor, and the Orszag–Tang vortex to separately assess:\n(i) accuracy on smooth solutions,\n(ii) robustness when strong discontinuities and rotational structures form,\n(iii) control of magnetic divergence errors, i.e., maintenance of the constraint $\\,\\nabla\\cdot\\mathbf{B}=0\\,$ and mitigation of the spurious magnetic-monopole forces that arise when $\\,\\nabla\\cdot\\mathbf{B}\\neq 0\\,$.\n\nThe plan should define scientifically consistent initial and boundary conditions, specify diagnostics tied to first principles of the above system, and avoid conflating objectives. Choose the option that correctly separates the objectives and uses appropriate diagnostics for each test.\n\nA. Accuracy is assessed using small-amplitude linear MHD waves on a periodic cube $[0,1]^3$: initialize three families (Alfvén, slow magnetosonic, fast magnetosonic) with amplitude $\\,A = 10^{-6}\\,$ and a normalized wavevector $\\,\\mathbf{k} \\propto (1,2,3)\\,$ to avoid grid alignment. Compute the error in $\\,(\\rho,\\mathbf{v},\\mathbf{B},p)\\,$ after one period $\\,T = 2\\pi/\\omega_{\\text{mode}}\\,$, comparing to the corresponding linear solution, and measure $\\,L_1\\,$, $\\,L_2\\,$, and $\\,L_\\infty\\,$ norms as functions of resolution $\\,N = 64, 128, 256\\,$ to confirm the expected order for smooth solutions. Robustness to discontinuities is assessed with the $\\,1\\,$-dimensional Brio–Wu shock tube on $[0,1]$ with outflow (non-reflecting) boundaries and standard left/right states $\\,(\\rho_L,p_L,\\mathbf{v}_L,\\mathbf{B}_L)=(1,1,(0,0,0),(0.75,1,0))\\,$, $\\,(\\rho_R,p_R,\\mathbf{v}_R,\\mathbf{B}_R)=(0.125,0.1,(0,0,0),(0.75,-1,0))\\,$, and with the $\\,2\\,$-dimensional magnetic rotor on $[0,1]^2$ (periodic) using a dense rotating disk of radius $\\,r_0=0.1\\,$ at the domain center with $\\,\\rho_{\\text{in}}=10\\,$, $\\,\\rho_{\\text{out}}=1\\,$, $\\,p=1\\,$, angular velocity $\\,\\omega=20\\,$, and a uniform background field $\\,\\mathbf{B}_0=(5,0,0)\\,$; diagnostics include shock/rarefaction locations, $\\,L_1\\,$ errors against a high-resolution reference, and preservation of angular momentum and peak vorticity. Control of divergence errors is evaluated with the Orszag–Tang vortex on $[0,1]^2$ (periodic) with $\\,\\gamma=5/3\\,$, $\\,\\rho=1\\,$, $\\,p=5/3\\,$, $\\,\\mathbf{v} = (-\\sin(2\\pi y), \\sin(2\\pi x), 0)\\,$, $\\,\\mathbf{B} = (-\\sin(2\\pi y), \\sin(4\\pi x), 0)\\,$; record $\\,\\|\\nabla\\cdot\\mathbf{B}\\|_2/\\|\\mathbf{B}\\|_2\\,$ and the maximum $\\,|\\nabla\\cdot\\mathbf{B}|\\,$ versus time for two algorithmic variants: Constrained Transport (CT) and Generalized Lagrange Multiplier (GLM) cleaning, plus a control run with cleaning disabled to demonstrate divergence growth and its impact on momentum/energy residuals.\n\nB. Accuracy is assessed with large-amplitude Alfvén waves of $\\,A=0.1\\,$ in $\\,1\\,$ dimension using inflow/outflow boundaries, comparing the total energy at $\\,t=1\\,$ at a single resolution $\\,N=128\\,$. Robustness to discontinuities is assessed by using the Orszag–Tang vortex as a proxy for a shock tube and computing shock widths, while divergence control is inferred indirectly from near-constancy of total energy without explicitly monitoring $\\,\\nabla\\cdot\\mathbf{B}\\,$; no periodic boundaries are used to avoid artificial constraints.\n\nC. Accuracy is assessed only on a grid-aligned $\\,1\\,$-dimensional Alfvén wave with periodic boundaries and amplitude $\\,A=10^{-6}\\,$ at a single resolution $\\,N=128\\,$ using $\\,L_1\\,$ error. Robustness to discontinuities is evaluated with the rotor test using reflective boundaries, and divergence control is folded into the rotor by examining $\\,\\nabla\\cdot\\mathbf{v}\\,$ rather than $\\,\\nabla\\cdot\\mathbf{B}\\,$, supplemented by an Orszag–Tang run without tracking divergence norms or comparing different divergence-control algorithms.\n\nD. Accuracy is evaluated via the Brio–Wu shock tube by measuring shock widths at $\\,t=0.2\\,$ for increasing $\\,N\\,$, assuming smooth-convergence extends to discontinuities; robustness to discontinuities is assessed with linear waves at $\\,A=10^{-6}\\,$ on $[0,1]^3$; divergence control is assessed by monitoring $\\,\\nabla\\cdot\\mathbf{v}\\,$ and by requiring the mean magnetic field $\\,\\langle \\mathbf{B} \\rangle\\,$ to remain constant on the Orszag–Tang vortex with outflow boundaries.\n\nWhich option provides a scientifically sound plan that correctly separates accuracy on smooth solutions, robustness to discontinuities, and control of divergence errors, with appropriate initial/boundary conditions and diagnostics rooted in the governing equations?", "solution": "The task is to select the most scientifically sound verification plan for a computational astrophysics code designed to solve the ideal Magnetohydrodynamics (MHD) equations. The plan must separately assess three key capabilities: (i) accuracy on smooth solutions, (ii) robustness in the presence of strong discontinuities, and (iii) control of the magnetic field divergence error.\n\nFirst, we must confirm the validity of the problem statement. The problem provides the standard conservative form of the ideal MHD equations:\n$$ \\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0 $$\n$$ \\partial_t (\\rho \\mathbf{v}) + \\nabla \\cdot \\left[\\rho \\mathbf{v}\\mathbf{v} + \\left(p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{I} - \\mathbf{B}\\mathbf{B}\\right] = 0 $$\n$$ \\partial_t E + \\nabla \\cdot \\left[\\left(E + p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B}\\right] = 0 $$\n$$ \\partial_t \\mathbf{B} + \\nabla \\cdot (\\mathbf{v}\\mathbf{B} - \\mathbf{B}\\mathbf{v}) = 0 $$\nThe total energy is defined as $E = \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho \\|\\mathbf{v}\\|^2 + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2$, and the system is subject to the solenoidal constraint $\\nabla \\cdot \\mathbf{B} = 0$. These equations are the fundamental and correct basis of ideal MHD. The specified test problems—linear wave propagation, the Brio–Wu shock tube, the magnetic rotor, and the Orszag–Tang vortex—are canonical benchmarks in the field of computational MHD. The three verification objectives are distinct and crucial for qualifying a modern MHD code. The problem is therefore scientifically grounded, well-posed, objective, and internally consistent. We may proceed to evaluate the proposed plans.\n\nA sound verification plan must employ specific tests tailored to each objective, with appropriate initial conditions, boundary conditions, and diagnostics.\n\n1.  **Objective (i): Accuracy on smooth solutions.** This requires a test problem with a known, smooth, analytic or semi-analytic solution. The numerical solution's convergence to the true solution as a function of grid resolution ($N$) is measured. For a scheme of order $m$, the error should decrease as $N^{-m}$.\n    -   **Methodology**: The propagation of small-amplitude linear waves is the ideal test. The amplitude must be small (e.g., $A \\sim 10^{-6}$) to ensure the system remains in the linear regime, preventing wave steepening and shock formation. To avoid artificially favorable results, the wavevector $\\mathbf{k}$ should not be aligned with the grid axes. A convergence study across multiple resolutions is mandatory to measure the order of accuracy.\n\n2.  **Objective (ii): Robustness to discontinuities.** This tests the code's ability to handle shocks, rarefactions, and contact discontinuities without generating fatal errors or excessive, unphysical oscillations. This is a test of stability and qualitative correctness in the highly nonlinear regime.\n    -   **Methodology**: Standard shock-tube problems, such as the Brio–Wu test, are designed to generate a complex fan of one-dimensional discontinuities. Higher-dimensional tests like the magnetic rotor or Orszag–Tang vortex test the interaction of strong shocks, shear flows, and vortices. Formal accuracy is not the primary diagnostic; rather, one compares the solution's structure to high-resolution reference solutions and checks for the preservation of physical principles (e.g., conservation laws).\n\n3.  **Objective (iii): Control of magnetic divergence errors.** This verifies the efficacy of the numerical algorithm in maintaining the $\\nabla \\cdot \\mathbf{B} = 0$ constraint. Failure to do so introduces a non-physical force proportional to $\\nabla \\cdot \\mathbf{B}$, which can corrupt the solution and lead to instability.\n    -   **Methodology**: A test problem with complex, evolving magnetic field structures, like the Orszag–Tang vortex, is ideal. The initial state has $\\nabla \\cdot \\mathbf{B} = 0$, but numerical error can cause it to grow. The primary diagnostic is the direct measurement of a discrete version of $\\nabla \\cdot \\mathbf{B}$ across the grid, often monitored via its $L_2$ or $L_\\infty$ norm, and comparing different divergence-control strategies (e.g., Constrained Transport, Powell's source terms, projection, or GLM cleaning).\n\nWe now evaluate each option against these principles.\n\n**Option A:**\n-   **Accuracy**: This plan correctly uses small-amplitude ($A = 10^{-6}$) linear MHD waves. The choice of a non-grid-aligned wavevector $\\mathbf{k} \\propto (1,2,3)$ is crucial for a rigorous test. It properly specifies a convergence study over multiple resolutions ($N = 64, 128, 256$) using standard error norms ($L_1, L_2, L_\\infty$). This constitutes a textbook procedure for verifying the formal order of accuracy.\n-   **Robustness**: It uses both the 1D Brio–Wu shock tube and the 2D magnetic rotor. These are standard, challenging tests for discontinuities and complex flows. The specified initial and boundary conditions are standard. The diagnostics—shock locations, $L_1$ errors against a reference, and conservation laws—are appropriate for this objective.\n-   **Divergence Control**: It correctly employs the Orszag–Tang vortex, a classic problem for this purpose. The diagnostics are direct and quantitative: monitoring norms of $\\nabla \\cdot \\mathbf{B}$ over time. Critically, it proposes comparing dedicated divergence-control algorithms (CT, GLM) against a run with no cleaning, which is the definitive method to demonstrate both the existence of the problem and the effectiveness of the solution.\n-   **Verdict**: This option correctly separates the three objectives and assigns the appropriate test, boundary conditions, and diagnostics to each. It represents a state-of-the-art verification plan. **Correct**.\n\n**Option B:**\n-   **Accuracy**: Uses large-amplitude ($A=0.1$) waves. This is incorrect, as non-linear effects will dominate, making it unsuitable for a clean accuracy test. It also lacks a convergence study (single resolution $N=128$), rendering it useless for determining the order of accuracy.\n-   **Robustness**: Uses Orszag–Tang as a \"proxy for a shock tube,\" which is an imprecise framing.\n-   **Divergence Control**: Relies on \"indirect\" inference from energy conservation. This is unreliable and unacceptable; the divergence of $\\mathbf{B}$ must be measured directly.\n-   **Verdict**: This plan is fundamentally flawed due to its use of incorrect methodologies and diagnostics. **Incorrect**.\n\n**Option C:**\n-   **Accuracy**: Uses a grid-aligned 1D wave and a single resolution. This is a weak, non-rigorous test that can hide errors and does not measure convergence.\n-   **Robustness**: Uses reflective boundaries for the rotor test, which is non-standard and complicates the physics with boundary interactions, making comparisons to established results difficult.\n-   **Divergence Control**: Proposes to examine $\\nabla \\cdot \\mathbf{v}$ instead of $\\nabla \\cdot \\mathbf{B}$. This is a nonsensical substitution, as the solenoidal constraint applies to the magnetic field, not the velocity field (which is non-solenoidal in compressible MHD).\n-   **Verdict**: This plan demonstrates a critical misunderstanding of the physics and the verification objectives. **Incorrect**.\n\n**Option D:**\n-   **Accuracy**: Conflates objectives by using a shock tube (Brio–Wu) to assess accuracy. Shock-capturing schemes are not high-order accurate at discontinuities, so this test cannot measure the formal accuracy for smooth flows.\n-   **Robustness**: Uses small-amplitude linear waves to assess robustness. This is incorrect. Linear waves are smooth and do not test the code's behavior with shocks or strong non-linearities.\n-   **Divergence Control**: Proposes monitoring $\\nabla \\cdot \\mathbf{v}$ (incorrect, as noted for C) and the mean magnetic field $\\langle \\mathbf{B} \\rangle$. Conservation of $\\langle \\mathbf{B} \\rangle$ on a periodic domain is trivial and provides no information about local divergence errors, which are the source of the unphysical forces.\n-   **Verdict**: This plan completely inverts the roles of accuracy and robustness tests and uses irrelevant diagnostics for divergence control. **Incorrect**.\n\nBased on this rigorous analysis, Option A is the only plan that is scientifically sound, methodologically correct, and separates the verification objectives without conflation. It employs the correct tests with the correct parameters and diagnostics for each objective.", "answer": "$$\\boxed{A}$$", "id": "3520099"}, {"introduction": "Before any of the verification tests can be run, a simulation must be able to advance in time without becoming numerically unstable. For explicit time-marching schemes, this is governed by the Courant-Friedrichs-Lewy (CFL) condition, which sets an upper limit on the size of the time step, $\\Delta t$. This fundamental exercise [@problem_id:3520095] guides you through the process of calculating a stable time step from first principles, taking into account the fastest signal speeds and the complexities introduced by a realistic, anisotropic computational grid.", "problem": "Consider the three-dimensional ideal magnetohydrodynamics (MHD) equations, which form a system of hyperbolic conservation laws. You are using an explicit, unsplit, finite-volume Godunov-type update with an approximate Riemann solver such as Harten–Lax–van Leer (HLL). The background flow is negligible, so wave propagation is dominated by the fast magnetosonic mode. The Courant–Friedrichs–Lewy (CFL) number adopted for time stepping is $C_{\\mathrm{CFL}} = 0.4$. The computational mesh is anisotropic with spacings $\\Delta x = 1.0 \\times 10^{9}\\ \\mathrm{m}$, $\\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$, and $\\Delta z = 2.0 \\times 10^{9}\\ \\mathrm{m}$. A robust characteristic analysis and limiter estimate have produced maximum directional fast magnetosonic signal speeds along the grid axes of $c_{f,x} = 1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $c_{f,y} = 2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, and $c_{f,z} = 1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\nStarting from the principle that the numerical domain of dependence of an explicit scheme must contain the physical domain of dependence of the underlying hyperbolic system, derive the functional form of the stability-limiting time step $\\Delta t$ for an unsplit update in terms of the directional signal speeds and grid spacings. Then, evaluate the stable $\\Delta t$ for the given values. Round your answer to four significant figures and express the time step in seconds.\n\nFinally, discuss qualitatively how anisotropic cells (unequal $\\Delta x$, $\\Delta y$, $\\Delta z$) impact the stability-limiting $\\Delta t$ under an unsplit flux divergence compared to an isotropic grid with the same minimum spacing. Your discussion should be grounded in the same first-principles CFL reasoning; do not rely on shortcut formulas.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information to derive and compute the stability-limiting time step for an explicit, unsplit numerical scheme for the ideal magnetohydrodynamics (MHD) equations. The provided physical parameters are consistent and within plausible ranges for astrophysical simulations. We may therefore proceed with a formal solution.\n\nThe problem requires the derivation of the stability-limiting time step, $\\Delta t$, for a three-dimensional explicit, unsplit finite-volume scheme. The governing principle is the Courant–Friedrichs–Lewy (CFL) condition, which states that for an explicit time-marching scheme to be stable, the numerical domain of dependence of a computational cell must contain the physical domain of dependence.\n\nFor a first-order, cell-centered finite-volume scheme, the solution in a cell $(i,j,k)$ at time $t^{n+1} = t^n + \\Delta t$ is computed using the solution at time $t^n$ in cell $(i,j,k)$ and the fluxes across its faces. These fluxes are determined using data from the immediate neighboring cells. Thus, in a single time step $\\Delta t$, information propagates from the centers of adjacent cells. The fastest physical signal must not travel further than this numerical stencil allows.\n\nIn one spatial dimension, say $x$, the fastest signal with speed $c_{f,x}$ travels a distance $c_{f,x} \\Delta t$. The CFL condition requires this distance to be less than or equal to the grid spacing $\\Delta x$ (multiplied by a safety factor, the CFL number $C_{\\mathrm{CFL}} \\le 1$).\n$$\nc_{f,x} \\Delta t \\le C_{\\mathrm{CFL}} \\Delta x \\implies \\Delta t \\le C_{\\mathrm{CFL}} \\frac{\\Delta x}{c_{f,x}}\n$$\nFor an unsplit scheme in three dimensions, we must consider the propagation of waves simultaneously in all directions. The update for a cell depends on fluxes through all of its faces. The stability condition for a multi-dimensional linear hyperbolic system solved with a first-order upwind or Godunov-type scheme is a generalization of the one-dimensional case. The Courant numbers for each dimension, $\\nu_i = c_{f,i} \\frac{\\Delta t}{\\Delta i}$ for $i \\in \\{x, y, z\\}$, are summed. The stability constraint is:\n$$\n\\nu_x + \\nu_y + \\nu_z \\le C_{\\mathrm{CFL}}\n$$\nSubstituting the expressions for the directional Courant numbers, we have:\n$$\nc_{f,x} \\frac{\\Delta t}{\\Delta x} + c_{f,y} \\frac{\\Delta t}{\\Delta y} + c_{f,z} \\frac{\\Delta t}{\\Delta z} \\le C_{\\mathrm{CFL}}\n$$\nFactoring out $\\Delta t$ yields the functional form for the stability-limiting time step:\n$$\n\\Delta t \\left( \\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z} \\right) \\le C_{\\mathrm{CFL}}\n$$\nTherefore, the maximum stable time step $\\Delta t$ is given by:\n$$\n\\Delta t = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}}\n$$\nThis expression shows that the inverse of the time step is determined by the sum of the inverse characteristic times for the fastest wave to cross the cell in each respective dimension.\n\nNext, we evaluate this expression using the provided values:\nCFL number: $C_{\\mathrm{CFL}} = 0.4$\nGrid spacings: $\\Delta x = 1.0 \\times 10^{9}\\ \\mathrm{m}$, $\\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$, $\\Delta z = 2.0 \\times 10^{9}\\ \\mathrm{m}$\nSignal speeds: $c_{f,x} = 1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $c_{f,y} = 2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $c_{f,z} = 1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$\n\nWe compute the terms in the denominator, which have units of inverse seconds ($\\mathrm{s}^{-1}$):\n$$\n\\frac{c_{f,x}}{\\Delta x} = \\frac{1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{1.0 \\times 10^{9}\\ \\mathrm{m}} = 1.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\frac{c_{f,y}}{\\Delta y} = \\frac{2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{5.0 \\times 10^{8}\\ \\mathrm{m}} = 0.4 \\times 10^{-2}\\ \\mathrm{s}^{-1} = 4.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\frac{c_{f,z}}{\\Delta z} = \\frac{1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{2.0 \\times 10^{9}\\ \\mathrm{m}} = 0.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\nThe sum of these terms is:\n$$\n\\sum_{i \\in \\{x,y,z\\}} \\frac{c_{f,i}}{\\Delta i} = (1.5 + 4.0 + 0.5) \\times 10^{-3}\\ \\mathrm{s}^{-1} = 6.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\nNow, we calculate the stable time step $\\Delta t$:\n$$\n\\Delta t = \\frac{0.4}{6.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}} = \\frac{4 \\times 10^{-1}}{6 \\times 10^{-3}}\\ \\mathrm{s} = \\frac{2}{3} \\times 10^{2}\\ \\mathrm{s} \\approx 66.666... \\mathrm{s}\n$$\nRounding the result to four significant figures, we get $\\Delta t = 66.67\\ \\mathrm{s}$.\n\nFinally, we discuss qualitatively the impact of anisotropic cells. The given grid is anisotropic, with the minimum spacing being $\\Delta_{\\min} = \\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$. An equivalent isotropic grid with the same minimum spacing would have $\\Delta x' = \\Delta y' = \\Delta z' = \\Delta_{\\min}$.\n\nThe stability condition for the anisotropic grid is:\n$$\n\\Delta t_{\\text{aniso}} = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}}\n$$\nFor the hypothetical isotropic grid with spacing $\\Delta_{\\min}$, the condition would be:\n$$\n\\Delta t_{\\text{iso}} = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta_{\\min}} + \\frac{c_{f,y}}{\\Delta_{\\min}} + \\frac{c_{f,z}}{\\Delta_{\\min}}}\n$$\nLet us compare the denominators. In the anisotropic case, the grid spacings in the $x$ and $z$ directions are larger than the minimum spacing: $\\Delta x  \\Delta_{\\min}$ and $\\Delta z  \\Delta_{\\min}$. Consequently, the corresponding terms in the denominator's sum are smaller:\n$$\n\\frac{c_{f,x}}{\\Delta x}  \\frac{c_{f,x}}{\\Delta_{\\min}} \\quad \\text{and} \\quad \\frac{c_{f,z}}{\\Delta z}  \\frac{c_{f,z}}{\\Delta_{\\min}}\n$$\nThe term for the $y$-direction is identical in both cases, since $\\Delta y = \\Delta_{\\min}$. Therefore, the sum in the denominator for the anisotropic case is strictly smaller than the sum for the isotropic case:\n$$\n\\left(\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}\\right)  \\left(\\frac{c_{f,x}}{\\Delta_{\\min}} + \\frac{c_{f,y}}{\\Delta_{\\min}} + \\frac{c_{f,z}}{\\Delta_{\\min}}\\right)\n$$\nSince the time step $\\Delta t$ is inversely proportional to this sum, the anisotropic grid permits a larger, less restrictive time step compared to an isotropic grid refined to the same minimum resolution in all directions: $\\Delta t_{\\text{aniso}}  \\Delta t_{\\text{iso}}$. This demonstrates a significant computational advantage of using anisotropic meshing for problems where high resolution is required only along certain axes, as the time step is not as severely penalized by the smallest cell dimension as it would be on a uniformly refined isotropic grid.", "answer": "$$\n\\boxed{66.67}\n$$", "id": "3520095"}, {"introduction": "A verification plan is incomplete without a robust framework for quantitatively analyzing the results. Simply looking at plots is not enough; we need objective metrics to measure code performance, such as the convergence rate of an accuracy test or the growth of non-physical artifacts. This practice [@problem_id:3520097] focuses on the essential diagnostic tools used for this purpose, asking you to identify the correct mathematical definitions for error norms, conservation errors, and the divergence of the magnetic field.", "problem": "Consider a periodic, uniform Cartesian domain $\\Omega \\subset \\mathbb{R}^3$ of volume $V$, discretized into $N_x \\times N_y \\times N_z$ cells with total cell count $N \\equiv N_x N_y N_z$ and cell volume $\\Delta V \\equiv V / N$. You simulate a small-amplitude linear wave in ideal Magnetohydrodynamics (MHD), where ideal denotes vanishing resistivity and viscosity, and where magnetic permeability $\\mu_0$ is set to $\\mu_0 \\equiv 1$ for simplicity. Let $\\rho$, $\\mathbf{v}$, $p$, and $\\mathbf{B}$ denote mass density, velocity, thermal pressure, and magnetic field, respectively. The analytical solution provides an exact diagnostic scalar field $q_{\\mathrm{exact}}(\\mathbf{x}, t)$ and the numerical method yields $q_{\\mathrm{num}}(\\mathbf{x}, t)$ at time $t$. Define the error field $e(\\mathbf{x}, t) \\equiv q_{\\mathrm{num}}(\\mathbf{x}, t) - q_{\\mathrm{exact}}(\\mathbf{x}, t)$, and let $e_i$ denote its value at the center of cell $i$.\n\nFrom first principles in analysis and ideal MHD:\n- The $L_p$ norm of a function on a domain is defined by an integral over $\\Omega$.\n- The ideal MHD total energy density is the sum of kinetic, internal (thermal), and magnetic energy densities.\n- Maxwell’s equations impose the solenoidal constraint $\\nabla \\cdot \\mathbf{B} \\equiv 0$; violations can be quantified as averages over $\\Omega$.\n\nWhich option correctly and self-consistently specifies:\n$1)$ the $L_1$, $L_2$, and $L_\\infty$ error norms for $e$ on $\\Omega$ and their standard uniform-grid discrete approximations,\n$2)$ a relative energy conservation error for the ideal MHD system in a periodic domain at time $t$, and\n$3)$ a volume-mean divergence error measure $\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle$?\n\nA. \n$$\nL_1(e) \\equiv \\int_{\\Omega} |e| \\, \\mathrm{d}V, \\quad L_1^h(e) \\equiv \\Delta V \\sum_{i=1}^{N} |e_i|, \\\\\nL_2(e) \\equiv \\left( \\int_{\\Omega} |e|^2 \\, \\mathrm{d}V \\right)^{1/2}, \\quad L_2^h(e) \\equiv \\left( \\Delta V \\sum_{i=1}^{N} e_i^2 \\right)^{1/2}, \\\\\nL_\\infty(e) \\equiv \\sup_{\\mathbf{x}\\in\\Omega} |e(\\mathbf{x})|, \\quad L_\\infty^h(e) \\equiv \\max_{1 \\le i \\le N} |e_i|,\n$$\nwith the ideal MHD total energy\n$$\nE_{\\mathrm{tot}}(t) \\equiv \\int_{\\Omega} \\left( \\tfrac{1}{2}\\rho |\\mathbf{v}|^2 + \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}|\\mathbf{B}|^2 \\right) \\mathrm{d}V,\n$$\nand the relative energy conservation error\n$$\n\\varepsilon_E(t) \\equiv \\frac{\\left| E_{\\mathrm{tot}}(t) - E_{\\mathrm{tot}}(0) \\right|}{E_{\\mathrm{tot}}(0)},\n$$\ntogether with the divergence error measure\n$$\n\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle \\equiv \\frac{1}{V} \\int_{\\Omega} \\left| \\nabla \\cdot \\mathbf{B} \\right| \\mathrm{d}V, \\quad \\langle |\\nabla \\cdot \\mathbf{B}| \\rangle^h \\equiv \\frac{1}{N} \\sum_{i=1}^{N} \\left| (\\nabla_h \\cdot \\mathbf{B})_i \\right|.\n$$\n\nB.\n$$\nL_1^h(e) \\equiv \\frac{1}{N} \\sum_{i=1}^{N} |e_i|, \\quad\nL_2^h(e) \\equiv \\left( \\frac{1}{N} \\sum_{i=1}^{N} e_i^2 \\right)^{1/2}, \\quad\nL_\\infty^h(e) \\equiv \\max_{1 \\le i \\le N} e_i,\n$$\nwith\n$$\nE_{\\mathrm{tot}}(t) \\equiv \\int_{\\Omega} \\left( \\tfrac{1}{2}\\rho |\\mathbf{v}|^2 + \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}|\\mathbf{B}|^2 \\right) \\mathrm{d}V, \\quad\n\\varepsilon_E(t) \\equiv \\left| E_{\\mathrm{tot}}(t) - E_{\\mathrm{tot}}(0) \\right|,\n$$\nand\n$$\n\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle^h \\equiv \\max_{1 \\le i \\le N} \\left| (\\nabla_h \\cdot \\mathbf{B})_i \\right|.\n$$\n\nC.\n$$\nL_1(e) \\equiv \\int_{\\Omega} e \\, \\mathrm{d}V, \\quad\nL_2(e) \\equiv \\int_{\\Omega} |e|^2 \\, \\mathrm{d}V, \\quad\nL_\\infty(e) \\equiv \\frac{1}{V} \\int_{\\Omega} |e| \\, \\mathrm{d}V,\n$$\nwith\n$$\nE_{\\mathrm{tot}}(t) \\equiv \\int_{\\Omega} \\left( \\tfrac{1}{2}\\rho |\\mathbf{v}|^2 + p + \\tfrac{1}{2}|\\mathbf{B}|^2 \\right) \\mathrm{d}V,\n$$\nand\n$$\n\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle \\equiv \\frac{1}{V} \\int_{\\Omega} \\left| \\nabla \\cdot \\mathbf{E} \\right| \\mathrm{d}V.\n$$\n\nD.\n$$\nL_1^h(e) \\equiv \\Delta V \\sum_{i=1}^{N} |e_i|, \\quad\nL_2^h(e) \\equiv \\Delta V \\sum_{i=1}^{N} |e_i|^2, \\quad\nL_\\infty^h(e) \\equiv \\max_{1 \\le i \\le N} |e_i|,\n$$\nwith\n$$\n\\varepsilon_E(t) \\equiv \\frac{\\left| \\int_{\\Omega} \\left( \\tfrac{1}{2}\\rho |\\mathbf{v}|^2 + \\tfrac{1}{2}|\\mathbf{B}|^2 \\right) \\mathrm{d}V - \\int_{\\Omega} \\left( \\tfrac{1}{2}\\rho |\\mathbf{v}|^2 + \\tfrac{1}{2}|\\mathbf{B}|^2 \\right) \\mathrm{d}V \\right|}{\\int_{\\Omega} \\tfrac{p}{\\gamma - 1} \\, \\mathrm{d}V},\n$$\nand\n$$\n\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle \\equiv \\frac{1}{V} \\int_{\\Omega} \\frac{\\left| \\nabla \\cdot \\mathbf{B} \\right|}{|\\mathbf{B}|} \\, \\mathrm{d}V.\n$$\n\nSelect the single best option.", "solution": "The problem statement poses a valid question regarding standard definitions used in the numerical analysis of ideal Magnetohydrodynamics (MHD). It is scientifically grounded, well-posed, and objective, using standard terminology from computational physics. The setup describes a common test problem for MHD codes. Therefore, a solution can be derived by evaluating the correctness of the definitions provided in each option against first principles.\n\nWe are asked to identify the option that correctly specifies three sets of definitions:\n1.  The continuous $L_1$, $L_2$, and $L_\\infty$ error norms and their discrete approximations on a uniform grid.\n2.  The relative total energy conservation error for an ideal MHD system.\n3.  A volume-mean measure for the divergence of the magnetic field, $\\nabla \\cdot \\mathbf{B}$.\n\nLet us establish the correct forms from first principles.\n\n**1. Error Norms**\n\nFor a function $e(\\mathbf{x}, t)$ on a domain $\\Omega$ of volume $V$, the standard continuous Lebesgue norms ($L_p$ norms) are defined as:\n-   The $L_1$ norm: $L_1(e) \\equiv \\int_{\\Omega} |e(\\mathbf{x},t)| \\, \\mathrm{d}V$. It measures the total integrated absolute error.\n-   The $L_2$ norm: $L_2(e) \\equiv \\left( \\int_{\\Omega} |e(\\mathbf{x},t)|^2 \\, \\mathrm{d}V \\right)^{1/2}$. It is related to the root-mean-square error.\n-   The $L_\\infty$ norm: $L_\\infty(e) \\equiv \\sup_{\\mathbf{x}\\in\\Omega} |e(\\mathbf{x},t)|$. It measures the maximum absolute error at any point in the domain.\n\nFor a uniform Cartesian grid with $N$ cells, each of volume $\\Delta V$, these continuous norms are approximated by their discrete counterparts. Let $e_i$ be the value of the error in cell $i$. The integral $\\int_{\\Omega} f(\\mathbf{x}) dV$ is approximated using a simple quadrature rule (a Riemann sum): $\\sum_{i=1}^{N} f_i \\Delta V$.\n-   Discrete $L_1$ norm, $L_1^h(e)$: This approximates the $L_1$ integral.\n    $$ L_1^h(e) = \\sum_{i=1}^{N} |e_i| \\Delta V $$\n-   Discrete $L_2$ norm, $L_2^h(e)$: This approximates the $L_2$ integral.\n    $$ L_2^h(e) = \\left( \\sum_{i=1}^{N} |e_i|^2 \\Delta V \\right)^{1/2} $$\n    Since $e_i$ is a real number, $|e_i|^2 = e_i^2$.\n-   Discrete $L_\\infty$ norm, $L_\\infty^h(e)$: The supremum over a discrete set of points is the maximum.\n    $$ L_\\infty^h(e) = \\max_{1 \\le i \\le N} |e_i| $$\n\n**2. Relative Energy Conservation Error**\n\nThe total energy of an ideal MHD fluid in a volume $\\Omega$ is the integral of the total energy density. The total energy density is the sum of kinetic energy density, internal energy density, and magnetic energy density.\n-   Kinetic energy density: $\\frac{1}{2}\\rho |\\mathbf{v}|^2$.\n-   Internal energy density ($u_{int}$): For an ideal gas with adiabatic index $\\gamma$, the thermal pressure is given by $p = (\\gamma - 1) u_{int}$. Thus, $u_{int} = \\frac{p}{\\gamma-1}$.\n-   Magnetic energy density: $\\frac{|\\mathbf{B}|^2}{2\\mu_0}$. With the given simplification $\\mu_0 \\equiv 1$, this is $\\frac{1}{2}|\\mathbf{B}|^2$.\n\nThe total energy $E_{\\mathrm{tot}}(t)$ at time $t$ is the volume integral of the sum of these densities:\n$$ E_{\\mathrm{tot}}(t) = \\int_{\\Omega} \\left( \\frac{1}{2}\\rho |\\mathbf{v}|^2 + \\frac{p}{\\gamma-1} + \\frac{1}{2}|\\mathbf{B}|^2 \\right) \\mathrm{d}V $$\nFor an ideal system in a periodic domain (no energy flux through the boundaries), the total energy is a conserved quantity, meaning $E_{\\mathrm{tot}}(t)$ should be constant. The relative energy conservation error, $\\varepsilon_E(t)$, quantifies the deviation from the initial total energy, $E_{\\mathrm{tot}}(0)$, normalized by the initial energy:\n$$ \\varepsilon_E(t) = \\frac{\\left| E_{\\mathrm{tot}}(t) - E_{\\mathrm{tot}}(0) \\right|}{E_{\\mathrm{tot}}(0)} $$\n\n**3. Volume-Mean Divergence Error**\n\nMaxwell's equations impose the solenoidal constraint, $\\nabla \\cdot \\mathbf{B} = 0$. Numerical methods might not preserve this condition perfectly. A common diagnostic is to measure the average magnitude of the numerical divergence over the domain. The notation $\\langle f \\rangle$ typically denotes a volume average of a quantity $f$.\n-   The continuous volume-mean absolute divergence is:\n    $$ \\langle |\\nabla \\cdot \\mathbf{B}| \\rangle = \\frac{1}{V} \\int_{\\Omega} |\\nabla \\cdot \\mathbf{B}| \\, \\mathrm{d}V $$\n-   The discrete approximation, $\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle^h$, is obtained by replacing the integral with a sum and the continuous operator $\\nabla \\cdot$ with its discrete counterpart $\\nabla_h \\cdot$. Let $(\\nabla_h \\cdot \\mathbf{B})_i$ be the value in cell $i$.\n    $$ \\langle |\\nabla \\cdot \\mathbf{B}| \\rangle^h = \\frac{1}{V} \\sum_{i=1}^{N} |(\\nabla_h \\cdot \\mathbf{B})_i| \\Delta V $$\n    Since $V = N \\Delta V$, this simplifies to the arithmetic mean of the absolute divergence values in each cell:\n    $$ \\langle |\\nabla \\cdot \\mathbf{B}| \\rangle^h = \\frac{1}{N} \\sum_{i=1}^{N} |(\\nabla_h \\cdot \\mathbf{B})_i| $$\n\nNow we evaluate each option.\n\n**A.**\n-   **Norms**:\n    -   $L_1(e) \\equiv \\int_{\\Omega} |e| \\, \\mathrm{d}V$ is correct.\n    -   $L_1^h(e) \\equiv \\Delta V \\sum_{i=1}^{N} |e_i|$ is the correct discrete approximation, but is often written with $\\Delta V$ inside the sum. As a constant factor, this is mathematically equivalent and correct.\n    -   $L_2(e) \\equiv \\left( \\int_{\\Omega} |e|^2 \\, \\mathrm{d}V \\right)^{1/2}$ is correct.\n    -   $L_2^h(e) \\equiv \\left( \\Delta V \\sum_{i=1}^{N} e_i^2 \\right)^{1/2}$ is correct.\n    -   $L_\\infty(e) \\equiv \\sup_{\\mathbf{x}\\in\\Omega} |e(\\mathbf{x})|$ is correct.\n    -   $L_\\infty^h(e) \\equiv \\max_{1 \\le i \\le N} |e_i|$ is correct.\n    All norm definitions are correct.\n-   **Energy**:\n    -   $E_{\\mathrm{tot}}(t)$ definition is correct, including the $\\frac{p}{\\gamma-1}$ term for internal energy.\n    -   $\\varepsilon_E(t)$ definition is the correct relative energy error.\n    All energy-related definitions are correct.\n-   **Divergence Error**:\n    -   $\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle$ definition is the correct continuous volume-mean.\n    -   $\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle^h$ definition is the correct discrete cell-average.\n    All divergence error definitions are correct.\nThis option provides a fully correct and self-consistent set of definitions.\n**Verdict: Correct.**\n\n**B.**\n-   **Norms**:\n    -   $L_1^h(e) \\equiv \\frac{1}{N} \\sum_{i=1}^{N} |e_i|$ is the mean error, not the discrete $L_1$ norm; it lacks the volume element $\\Delta V$. Incorrect.\n    -   $L_2^h(e) \\equiv \\left( \\frac{1}{N} \\sum_{i=1}^{N} e_i^2 \\right)^{1/2}$ is the root-mean-square (RMS) error, not the discrete $L_2$ norm. Incorrect.\n    -   $L_\\infty^h(e) \\equiv \\max_{1 \\le i \\le N} e_i$ is missing the absolute value, $|e_i|$. A norm must be non-negative. Incorrect.\n-   **Energy**:\n    -   $\\varepsilon_E(t) \\equiv \\left| E_{\\mathrm{tot}}(t) - E_{\\mathrm{tot}}(0) \\right|$ is the absolute error, not the relative error as requested. Incorrect.\n-   **Divergence Error**:\n    -   $\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle^h \\equiv \\max_{1 \\le i \\le N} \\left| (\\nabla_h \\cdot \\mathbf{B})_i \\right|$ is the $L_\\infty$ norm of the divergence, not the volume-mean. Incorrect.\n**Verdict: Incorrect.**\n\n**C.**\n-   **Norms**:\n    -   $L_1(e) \\equiv \\int_{\\Omega} e \\, \\mathrm{d}V$ is missing the absolute value. Incorrect.\n    -   $L_2(e) \\equiv \\int_{\\Omega} |e|^2 \\, \\mathrm{d}V$ is the square of the $L_2$ norm, missing the square root. Incorrect.\n    -   $L_\\infty(e) \\equiv \\frac{1}{V} \\int_{\\Omega} |e| \\, \\mathrm{d}V$ is the volume-averaged absolute error ($L_1/V$), not the $L_\\infty$ norm. Incorrect.\n-   **Energy**:\n    -   $E_{\\mathrm{tot}}(t)$ uses $p$ for the internal energy density term, instead of the correct $\\frac{p}{\\gamma-1}$. Incorrect.\n-   **Divergence Error**:\n    -   The formula is for the divergence of the electric field $\\mathbf{E}$, not the magnetic field $\\mathbf{B}$. Incorrect.\n**Verdict: Incorrect.**\n\n**D.**\n-   **Norms**:\n    -   $L_2^h(e) \\equiv \\Delta V \\sum_{i=1}^{N} |e_i|^2$ is the square of the discrete $L_2$ norm; it is missing the outer square root. Incorrect.\n-   **Energy**:\n    -   The expression for $\\varepsilon_E(t)$ is flawed. The numerator is written as the absolute difference of two identical integrals, which is zero. Presuming a typo and it should be $E(t)$ and $E(0)$, it still incorrectly omits the internal energy term $\\frac{p}{\\gamma-1}$ from the total energy calculation. The denominator is the total internal energy, not the total initial energy $E_{\\mathrm{tot}}(0)$. Incorrect.\n-   **Divergence Error**:\n    -   $\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle \\equiv \\frac{1}{V} \\int_{\\Omega} \\frac{\\left| \\nabla \\cdot \\mathbf{B} \\right|}{|\\mathbf{B}|} \\, \\mathrm{d}V$ describes a pointwise relative divergence error, not the standard volume-mean absolute divergence error implied by the notation $\\langle |\\nabla \\cdot \\mathbf{B}| \\rangle$. Incorrect.\n**Verdict: Incorrect.**\n\nBased on the analysis, only option A presents all definitions correctly and according to the standard conventions in computational physics and applied mathematics.", "answer": "$$\\boxed{A}$$", "id": "3520097"}]}