{"hands_on_practices": [{"introduction": "This exercise provides a foundational link between the integral and differential forms of the mass conservation law. By solving for the evolution of a simple density profile under a constant velocity field, you will gain a concrete understanding of advection, the process by which a quantity is transported by a bulk flow. This analytical problem [@problem_id:3506416] demonstrates the simplest, purest manifestation of a conservation law in action and is a crucial first step before tackling more complex systems.", "problem": "A one-dimensional compressible fluid in an inertial frame occupies the whole line $x \\in \\mathbb{R}$. The Eulerian mass density is $ \\rho(x,t) $, and the fluid velocity field is spatially uniform and time-independent, $ v(x,t) = v $, where $ v $ is a given real constant. The initial density profile at time $ t=0 $ is a Gaussian centered at $ x_0 $ with amplitude $ \\rho_0 $ and width parameter $ \\sigma $, namely $ \\rho(x,0) = \\rho_0 \\exp\\!\\big(-(x - x_0)^2/\\sigma^2\\big) $, where $ \\rho_0 > 0 $ and $ \\sigma > 0 $. Starting from the integral statement of mass conservation (the continuity law) for any fixed control interval $ [a,b] \\subset \\mathbb{R} $,\n$$\n\\frac{d}{dt}\\int_{a}^{b} \\rho(x,t)\\,dx = -\\Big[\\rho(x,t)\\,v\\Big]_{x=a}^{x=b},\n$$\nderive the governing equation for $ \\rho(x,t) $ and use it to obtain a closed-form expression for the density $ \\rho(x,t) $ at general time $ t \\ge 0 $ that satisfies the given initial condition. Express the final density profile $ \\rho(x,t) $ explicitly in terms of $ x $, $ t $, $ \\rho_0 $, $ x_0 $, $ \\sigma $, and $ v $. Your final answer must be a single analytic expression. Do not include units in your final boxed expression.", "solution": "The problem asks for the density profile $\\rho(x,t)$ of a one-dimensional compressible fluid, given its initial profile and the governing integral form of the continuity equation.\n\nFirst, we must derive the differential form of the governing equation from the provided integral statement of mass conservation for an arbitrary fixed control interval $[a,b]$:\n$$\n\\frac{d}{dt}\\int_{a}^{b} \\rho(x,t)\\,dx = -\\Big[\\rho(x,t)\\,v\\Big]_{x=a}^{x=b}\n$$\nThe velocity field $v(x,t)$ is given as a constant, $v$. The right-hand side (RHS) of the equation represents the net mass flux out of the control interval. We can expand it as:\n$$\n-\\Big[\\rho(b,t)\\,v - \\rho(a,t)\\,v\\Big] = \\rho(a,t)v - \\rho(b,t)v\n$$\nUsing the Fundamental Theorem of Calculus, we can express the RHS as an integral over the interval $[a,b]$:\n$$\n\\rho(a,t)v - \\rho(b,t)v = -\\int_{a}^{b} \\frac{\\partial}{\\partial x}(\\rho(x,t)v)\\,dx\n$$\nThe left-hand side (LHS) of the initial equation involves the time derivative of an integral. Since the limits of integration $a$ and $b$ are constant, we can apply the Leibniz integral rule to move the derivative inside the integral:\n$$\n\\frac{d}{dt}\\int_{a}^{b} \\rho(x,t)\\,dx = \\int_{a}^{b} \\frac{\\partial \\rho}{\\partial t}(x,t)\\,dx\n$$\nEquating the transformed LHS and RHS, we get:\n$$\n\\int_{a}^{b} \\frac{\\partial \\rho}{\\partial t}(x,t)\\,dx = -\\int_{a}^{b} \\frac{\\partial}{\\partial x}(\\rho(x,t)v)\\,dx\n$$\nRearranging the terms, we combine them into a single integral:\n$$\n\\int_{a}^{b} \\left( \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial}{\\partial x}(\\rho v) \\right) dx = 0\n$$\nSince this equation must hold for any arbitrary interval $[a,b]$, the integrand must be identically zero for all $x$ and $t$. This gives the differential form of the continuity equation:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial}{\\partial x}(\\rho v) = 0\n$$\nGiven that $v$ is a constant, it can be factored out of the spatial derivative:\n$$\n\\frac{\\partial \\rho}{\\partial t} + v \\frac{\\partial \\rho}{\\partial x} = 0\n$$\nThis is the one-dimensional linear advection equation. It describes how the density profile $\\rho$ is transported (advected) by the constant velocity field $v$.\n\nTo solve this first-order partial differential equation (PDE), we use the method of characteristics. The characteristic curves are paths $(x(t), t)$ along which the solution $\\rho$ is constant. The equation implies that the total derivative of $\\rho(x(t), t)$ with respect to $t$ is zero, provided that $\\frac{dx}{dt} = v$.\nThe characteristic equations are:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{d\\rho}{dt} = \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial \\rho}{\\partial x}\\frac{dx}{dt} = \\frac{\\partial \\rho}{\\partial t} + v\\frac{\\partial \\rho}{\\partial x} = 0\n$$\nThe second equation, $\\frac{d\\rho}{dt} = 0$, confirms that $\\rho$ is constant along the characteristic curves.\nThe first equation, $\\frac{dx}{dt} = v$, can be integrated to find the equations of the characteristic curves. For a characteristic curve passing through the point $(x,t)$, let its starting point at $t=0$ be $(\\xi, 0)$. Integrating from $t=0$ to a general time $t$ gives:\n$$\nx(t) - x(0) = \\int_0^t v \\,d\\tau = vt\n$$\nSubstituting $x(t) = x$ and $x(0) = \\xi$, we have:\n$$\nx - \\xi = vt \\implies \\xi = x - vt\n$$\nThe quantity $\\xi$ is the initial position of the fluid particle that is at position $x$ at time $t$. Since $\\rho$ is constant along each characteristic, its value at $(x,t)$ is equal to its value at the initial point $(\\xi, 0)$:\n$$\n\\rho(x,t) = \\rho(\\xi, 0)\n$$\nWe are given the initial density profile at $t=0$:\n$$\n\\rho(x,0) = \\rho_0 \\exp\\left(-\\frac{(x - x_0)^2}{\\sigma^2}\\right)\n$$\nTherefore, the density at the initial point $\\xi$ is:\n$$\n\\rho(\\xi, 0) = \\rho_0 \\exp\\left(-\\frac{(\\xi - x_0)^2}{\\sigma^2}\\right)\n$$\nSubstituting $\\xi = x - vt$ into this expression gives the solution for $\\rho(x,t)$:\n$$\n\\rho(x,t) = \\rho_0 \\exp\\left(-\\frac{((x - vt) - x_0)^2}{\\sigma^2}\\right)\n$$\nThis expression can be rearranged to show the advection of the center of the Gaussian pulse:\n$$\n\\rho(x,t) = \\rho_0 \\exp\\left(-\\frac{(x - (x_0 + vt))^2}{\\sigma^2}\\right)\n$$\nThe solution represents the initial Gaussian density profile translating with a constant velocity $v$ without changing its shape. The center of the Gaussian pulse, which was at $x_0$ at time $t=0$, is located at $x_0+vt$ at time $t$.\nTo present the final answer in the requested format, we use the first form derived:\n$$\n\\rho(x,t) = \\rho_0 \\exp\\left(-\\frac{(x - x_0 - vt)^2}{\\sigma^2}\\right)\n$$", "answer": "$$\\boxed{\\rho_0 \\exp\\left(-\\frac{(x - x_0 - vt)^{2}}{\\sigma^{2}}\\right)}$$", "id": "3506416"}, {"introduction": "The Riemann problem is a cornerstone for testing hydrodynamics codes and understanding the interplay of mass, momentum, and energy conservation. This classic exercise [@problem_id:3506428] challenges you to derive the solution for the non-linear interactions that produce a shock wave, a contact discontinuity, and a rarefaction wave from a simple initial discontinuity in pressure and density. Solving the Sod shock tube problem provides deep insight into the rich, non-linear behavior inherent in the physics of compressible flows.", "problem": "In computational astrophysics it is common to validate hydrodynamics solvers against exact solutions of one-dimensional Riemann problems governed by the compressible Euler equations, which express conservation of mass, momentum, and energy for a polytropic gas with adiabatic index $\\gamma$. Consider the one-dimensional shock tube problem (the Sod initial value problem) for a perfect gas with $\\gamma=1.4$ in nondimensional code units, where the initial left state $(\\rho_L,p_L,v_L)$ and right state $(\\rho_R,p_R,v_R)$ are given by $(\\rho_L,p_L,v_L)=(1,1,0)$ and $(\\rho_R,p_R,v_R)=(0.125,0.1,0)$. The flow evolves self-similarly and is composed of a left-going rarefaction, a contact discontinuity, and a right-going shock. The state between the rarefaction tail and the shock, called the star region, is uniform and characterized by the pressure $p^\\ast$ and velocity $v^\\ast$.\n\nStarting from the conservation laws and the jump or integral relations appropriate to smooth isentropic expansion waves and shocks in a polytropic gas, derive the nonlinear compatibility equation for the star-region pressure $p^\\ast$ and solve it to obtain the numerical value of $p^\\ast$ for the given initial states. Use nondimensional code units (so the pressure is unitless) and round your final answer to $6$ significant figures.", "solution": "### Step 1: Extract Givens\nThe problem statement provides the following information:\n- The governing equations are the $1$-dimensional compressible Euler equations for a polytropic gas.\n- The gas is perfect with an adiabatic index $\\gamma = 1.4$.\n- The initial left state is $(\\rho_L, p_L, v_L) = (1, 1, 0)$ in nondimensional units.\n- The initial right state is $(\\rho_R, p_R, v_R) = (0.125, 0.1, 0)$ in nondimensional units.\n- The flow structure consists of a left-going rarefaction, a contact discontinuity, and a right-going shock.\n- The region between the rarefaction and the shock (the star region) is characterized by a uniform pressure $p^\\ast$ and velocity $v^\\ast$.\n- The final answer for $p^\\ast$ must be rounded to $6$ significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes the Sod shock tube, a standard benchmark problem in computational fluid dynamics and astrophysics. It is governed by the Euler equations, which are fundamental principles of fluid dynamics. The setup is scientifically sound.\n- **Well-Posed:** The Sod Riemann problem with these initial conditions is well-known to have a unique, stable, and physically meaningful solution. The quantity to be found, $p^\\ast$, is well-defined.\n- **Objective:** The problem is stated using precise, technical language with no subjective or ambiguous terms.\n- **Completeness and Consistency:** All necessary parameters ($\\gamma$, initial states) are provided. There are no contradictions in the setup. The description of the wave pattern (rarefaction-contact-shock) is consistent with the initial conditions ($p_L > p_R$).\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Compatibility Equation for $p^\\ast$\n\nThe solution to the Riemann problem is self-similar and depends on the variable $\\xi = x/t$. The initial discontinuity at $x=0$ evolves into a set of waves separating regions of constant state. For the given initial conditions ($p_L > p_R$), the wave pattern consists of a left-propagating rarefaction wave, a central contact discontinuity, and a right-propagating shock wave.\n\nAcross the contact discontinuity, pressure and velocity are continuous. We denote these values in the \"star region\" (the region between the rarefaction tail and the shock front) as $p^\\ast$ and $v^\\ast$. Our goal is to find two expressions for $v^\\ast$ as a function of $p^\\ast$—one by relating the star region to the initial left state, and the other by relating it to the initial right state—and then equate them.\n\n**1. Left-Going Rarefaction Wave (Region L to Star Region)**\n\nA rarefaction wave is a continuous, isentropic expansion. Across the rarefaction fan, the Riemann invariant corresponding to the right-propagating characteristics ($C_+$) is conserved:\n$$v + \\int \\frac{dp}{\\rho c} = \\text{constant}$$\nwhere $c = \\sqrt{\\gamma p / \\rho}$ is the local sound speed. For an isentropic process in a polytropic gas, $p = K\\rho^\\gamma$, where $K$ is a constant. This allows us to write the sound speed as a function of pressure: $c = c_L (p/p_L)^{(\\gamma-1)/(2\\gamma)}$. The integral can be evaluated as:\n$$\\int \\frac{dp}{\\rho c} = \\int \\frac{c}{\\gamma p} dp = \\frac{2c}{\\gamma-1}$$\nThus, the Riemann invariant is $v + \\frac{2c}{\\gamma-1}$. Applying this across the rarefaction wave, from state $(\\rho_L, p_L, v_L)$ to state $(\\rho^\\ast, p^\\ast, v^\\ast)$:\n$$v_L + \\frac{2 c_L}{\\gamma-1} = v^\\ast + \\frac{2 c^\\ast}{\\gamma-1}$$\nwhere $c_L = \\sqrt{\\gamma p_L / \\rho_L}$ and $c^\\ast = \\sqrt{\\gamma p^\\ast / \\rho^\\ast}$. Since the flow is isentropic from state $L$ to the star region, $c^\\ast = c_L (p^\\ast/p_L)^{(\\gamma-1)/(2\\gamma)}$.\nSolving for $v^\\ast$, we get:\n$$v^\\ast = v_L + \\frac{2 c_L}{\\gamma-1} \\left[ 1 - \\left( \\frac{p^\\ast}{p_L} \\right)^{(\\gamma-1)/(2\\gamma)} \\right]$$\nThis equation gives the velocity in the star region as a function of $p^\\ast$ and the initial left state.\n\n**2. Right-Going Shock Wave (Region R to Star Region)**\n\nThe transition from the initial right state $(\\rho_R, p_R, v_R)$ to the star region state $(\\rho^\\ast, p^\\ast, v^\\ast)$ occurs across a shock wave. The relationship across a shock is given by the Rankine-Hugoniot jump conditions. A standard result derived from these conditions relates the change in velocity to the change in pressure:\n$$(v^\\ast - v_R)^2 = (p^\\ast - p_R)^2 \\frac{2/\\rho_R}{(\\gamma+1)p^\\ast + (\\gamma-1)p_R}$$\nFor a right-going shock, we have $p^\\ast > p_R$ and $v^\\ast > v_R$. Taking the positive square root gives:\n$$v^\\ast = v_R + (p^\\ast - p_R) \\sqrt{\\frac{2/\\rho_R}{(\\gamma+1)p^\\ast + (\\gamma-1)p_R}}$$\nThis equation gives the velocity in the star region as a function of $p^\\ast$ and the initial right state.\n\n**3. The Nonlinear Compatibility Equation**\n\nEquating the two expressions for $v^\\ast$ yields a single nonlinear equation for the unknown pressure $p^\\ast$:\n$$v_L + \\frac{2 c_L}{\\gamma-1} \\left[ 1 - \\left( \\frac{p^\\ast}{p_L} \\right)^{(\\gamma-1)/(2\\gamma)} \\right] = v_R + (p^\\ast - p_R) \\sqrt{\\frac{2/\\rho_R}{(\\gamma+1)p^\\ast + (\\gamma-1)p_R}}$$\n\n### Solving for $p^\\ast$\n\nWe now substitute the given numerical values into this equation.\n- $\\gamma = 1.4$\n- $(\\rho_L, p_L, v_L) = (1, 1, 0)$\n- $(\\rho_R, p_R, v_R) = (0.125, 0.1, 0)$\n\nFrom these, we can calculate accessory constants:\n- Sound speed in the left state: $c_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}$.\n- $\\gamma - 1 = 0.4$\n- $\\gamma + 1 = 2.4$\n- The exponent $(\\gamma-1)/(2\\gamma) = 0.4 / (2 \\times 1.4) = 0.4 / 2.8 = 1/7$.\n\nSubstituting these values into the compatibility equation:\n$$0 + \\frac{2 \\sqrt{1.4}}{0.4} \\left[ 1 - \\left( \\frac{p^\\ast}{1} \\right)^{1/7} \\right] = 0 + (p^\\ast - 0.1) \\sqrt{\\frac{2/0.125}{(2.4)p^\\ast + (0.4)(0.1)}}$$\nSimplifying the terms:\n$$5\\sqrt{1.4} \\left( 1 - (p^\\ast)^{1/7} \\right) = (p^\\ast - 0.1) \\sqrt{\\frac{16}{2.4 p^\\ast + 0.04}}$$\nLet $f(p^\\ast)$ be the function whose root we seek:\n$$f(p^\\ast) = 5\\sqrt{1.4} \\left( 1 - (p^\\ast)^{1/7} \\right) - (p^\\ast - 0.1) \\frac{4}{\\sqrt{2.4 p^\\ast + 0.04}} = 0$$\nThis is a transcendental equation that must be solved using a numerical root-finding method, such as the Newton-Raphson method or a bisection method. The solution must lie in the interval $p_R < p^\\ast < p_L$, which is $0.1 < p^\\ast < 1$.\n\nLet's test a value, for instance $p^\\ast = 0.3$:\n$$5\\sqrt{1.4} \\approx 5.91608$$\n$$(0.3)^{1/7} \\approx 0.84196$$\nLeft-hand side (LHS) term: $5.91608 \\times (1 - 0.84196) \\approx 0.93474$\nRight-hand side (RHS) term: $(0.3 - 0.1) \\frac{4}{\\sqrt{2.4(0.3) + 0.04}} = 0.2 \\frac{4}{\\sqrt{0.76}} \\approx \\frac{0.8}{0.87178} \\approx 0.91766$\nSince LHS $>$ RHS, the true value of $p^\\ast$ must be slightly higher than $0.3$.\n\nEmploying a numerical solver (e.g., the Newton-Raphson method) with an initial guess of $p^\\ast_0 = 0.3$, the solution converges rapidly. The unrounded result is approximately:\n$$p^\\ast \\approx 0.303130178$$\nRounding this value to $6$ significant figures, as requested by the problem, we obtain:\n$$p^\\ast = 0.303130$$", "answer": "$$\\boxed{0.303130}$$", "id": "3506428"}, {"introduction": "Moving from analytical solutions to direct computational practice, this problem requires you to implement a conservative Godunov-type numerical scheme to solve the full Euler equations. The exercise [@problem_id:3506463] uses a moving shock problem to investigate Galilean invariance, a fundamental symmetry of the fluid equations, and to quantify how numerical discretization can introduce subtle but important errors. This task is a direct application of the skills required to develop, validate, and critically analyze the results of modern computational astrophysics codes.", "problem": "Consider one-dimensional compressible flow governed by the Euler equations written in conservation form,\n$$\n\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\nwhere the conserved variables are\n$$\n\\mathbf{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix},\n$$\nwith mass density $ \\rho $, velocity $ u $, and total energy density $ E $. The fluxes are\n$$\n\\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E + p) u \\end{bmatrix},\n$$\nwhere the pressure $ p $ for an ideal gas with adiabatic index $ \\gamma $ obeys\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2} \\rho u^2, \\quad c_s = \\sqrt{\\frac{\\gamma p}{\\rho}},\n$$\nwith sound speed $ c_s $. The Euler equations are Galilean invariant: if $ (\\rho, u, p) $ is a solution, then $ (\\rho, u + U, p) $ is also a solution for any constant bulk speed $ U $. In finite-volume discretizations, numerical violations of Galilean invariance can introduce spurious entropy production and kinetic energy loss that depend on the ratio $ U / c_s $.\n\nYour task is to implement a conservative Godunov scheme for the one-dimensional Euler equations, using an approximate Riemann solver of your choice, and to quantify Galilean invariance errors by comparing the numerical evolution of a stationary normal shock ($ U = 0 $) to the same shock uniformly boosted by a bulk speed $ U $.\n\nUse the following scientifically sound and self-consistent setup in dimensionless units:\n- Ideal gas with adiabatic index $ \\gamma = 5/3 $.\n- Upstream (pre-shock) state: $ \\rho_1 = 1 $, $ p_1 = 1 $, and upstream Mach number $ M_1 = 3 $ relative to the shock in the shock-rest frame.\n- Derive the downstream (post-shock) state $ (\\rho_2, u_2, p_2) $ from the Rankine–Hugoniot conditions for a stationary normal shock starting from the fundamental conservation laws, without invoking any shortcut formulas. Place a single planar discontinuity (the shock) at position $ x_0 $ so that for $ U = 0 $ the shock remains at rest in the computational frame, with left state $ (\\rho_1, u_1, p_1) $ and right state $ (\\rho_2, u_2, p_2) $ such that $ u_1 > 0 $ and $ u_2 > 0 $. To generate a moving shock at bulk speed $ U $, add $ U $ uniformly to both $ u_1 $ and $ u_2 $.\n- Computational domain length $ L = 2 $ with uniform grid of $ N = 800 $ cells, shock centered at $ x_0 = L / 2 $. Use transmissive (zero-gradient) boundary conditions. Integrate to final time $ t_{\\mathrm{final}} = 0.05 $ with a stable explicit time-step constrained by the Courant–Friedrichs–Lewy (CFL) number, choosing $ \\mathrm{CFL} = 0.4 $.\n\nDefine the specific entropy per unit mass as\n$$\ns = \\ln\\left(\\frac{p}{\\rho^{\\gamma}}\\right),\n$$\nand define the domain-integrated entropy and kinetic energy\n$$\nS(t) = \\int_0^L \\rho s \\, dx, \\quad K(t) = \\int_0^L \\frac{1}{2} \\rho u^2 \\, dx.\n$$\nFor each bulk speed $ U $, run the simulation from $ t = 0 $ to $ t = t_{\\mathrm{final}} $, compute $ S(t_{\\mathrm{final}}) $ and $ K(t_{\\mathrm{final}}) $, and quantify the spurious errors due to numerical Galilean non-invariance by subtracting the baseline values at $ U = 0 $:\n$$\n\\Delta S(U) = S_U(t_{\\mathrm{final}}) - S_{U=0}(t_{\\mathrm{final}}), \\quad\n\\Delta K(U) = K_U(t_{\\mathrm{final}}) - K_{U=0}(t_{\\mathrm{final}}).\n$$\n\nTest suite:\n- Let $ c_{s,1} = \\sqrt{\\gamma p_1/\\rho_1} $ be the upstream sound speed. Use bulk speeds $ U $ corresponding to the ratios $ U / c_{s,1} \\in \\{ 0, 2, 5, 10 \\} $.\n\nImplementation requirements:\n- Use a first-order conservative Godunov finite-volume update with an approximate Riemann solver and transmissive boundary conditions.\n- Ensure numerical stability with an explicit time step satisfying the Courant–Friedrichs–Lewy (CFL) condition.\n\nOutput requirements:\n- Express all outputs in dimensionless units.\n- For each test bulk speed, report the pair $ [\\Delta S(U), \\Delta K(U)] $ as dimensionless floats rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one two-element list per test case in order of increasing $ U / c_{s,1} $. For example, the format must be\n$$\n[ [\\Delta S(U_1), \\Delta K(U_1)], [\\Delta S(U_2), \\Delta K(U_2)], \\dots ]\n$$\nwith no spaces after commas.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of compressible fluid dynamics, specifically the one-dimensional Euler equations. It presents a well-posed numerical experiment to quantify a known artifact—numerical violation of Galilean invariance—in finite-volume schemes. The problem is self-contained, providing all necessary physical parameters, computational domain specifications, and boundary conditions. The definitions and objectives are clear, precise, and objective, making it a formalizable and solvable problem in computational astrophysics.\n\n### Theoretical Framework and Initial Conditions\n\nThe physical system is governed by the one-dimensional Euler equations in conservation form:\n$$\n\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = \\mathbf{0}\n$$\nwhere $ \\mathbf{U} $ is the vector of conserved state variables and $ \\mathbf{F}(\\mathbf{U}) $ is the vector of fluxes. For an ideal gas, these are:\n$$\n\\mathbf{U} = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad\n\\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E + p) u \\end{bmatrix}\n$$\nHere, $ \\rho $ is the mass density, $ u $ is the fluid velocity, $ p $ is the pressure, and $ E $ is the total energy density. The system is closed by the ideal gas equation of state, which relates the total energy to the pressure:\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2} \\rho u^2\n$$\nwhere $ \\gamma $ is the adiabatic index, given as $ \\gamma = 5/3 $.\n\nThe initial condition is a planar shock, which is a discontinuity separating two uniform states. The properties of these states are related by the Rankine–Hugoniot jump conditions. As required, we derive these conditions from the fundamental conservation laws in a frame where the shock is stationary. Let state $ 1 $ be the upstream (pre-shock) state and state $ 2 $ be the downstream (post-shock) state.\n\n1.  **Conservation of Mass**: $ [ \\rho u ] = 0 \\implies \\rho_1 u_1 = \\rho_2 u_2 \\equiv j $\n2.  **Conservation of Momentum**: $ [ \\rho u^2 + p ] = 0 \\implies \\rho_1 u_1^2 + p_1 = \\rho_2 u_2^2 + p_2 $\n3.  **Conservation of Energy**: $ [ (E+p)u ] = 0 $. Using the definition of $E$, the energy flux is $ F_E = (\\frac{\\gamma p}{\\gamma-1} + \\frac{1}{2}\\rho u^2)u $. The conservation of total enthalpy across the shock is $ \\frac{u_1^2}{2} + \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} = \\frac{u_2^2}{2} + \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} $.\n\nFrom these, we can derive the relationships between the pre- and post-shock states as a function of the upstream Mach number, $ M_1 = u_1 / c_{s,1} $, where $ c_{s,1} = \\sqrt{\\gamma p_1 / \\rho_1} $. The derivation yields:\n\n-   **Pressure ratio**: $ \\frac{p_2}{p_1} = \\frac{2 \\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} $\n-   **Density ratio**: $ \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} $\n-   **Velocity ratio**: From mass conservation, $ \\frac{u_2}{u_1} = \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} $\n\nGiven the upstream state $ (\\rho_1, p_1) = (1, 1) $ in dimensionless units, $ \\gamma=5/3 $, and $ M_1=3 $, we calculate the initial state variables.\nThe upstream sound speed is $ c_{s,1} = \\sqrt{\\gamma p_1 / \\rho_1} = \\sqrt{(5/3) \\cdot 1 / 1} = \\sqrt{5/3} $.\nThe upstream velocity in the shock-rest frame is $ u_1 = M_1 c_{s,1} = 3 \\sqrt{5/3} = \\sqrt{15} $.\nUsing the jump conditions with $ M_1^2 = 9 $ and $ \\gamma=5/3 $:\n-   $ \\frac{p_2}{p_1} = \\frac{2(5/3)(9) - (2/3)}{8/3} = \\frac{30 - 2/3}{8/3} = 11 \\implies p_2 = 11 $.\n-   $ \\frac{\\rho_2}{\\rho_1} = \\frac{(8/3)(9)}{(2/3)(9) + 2} = \\frac{24}{6+2} = 3 \\implies \\rho_2 = 3 $.\n-   $ u_2 = u_1 \\frac{\\rho_1}{\\rho_2} = \\frac{\\sqrt{15}}{3} $.\n\nFor the stationary shock simulation ($ U=0 $), the initial condition is setup on the domain $ x \\in [0, L] $ with $ L=2 $ and the shock at $ x_0 = 1 $:\n-   Left state ($ x < 1 $): $ (\\rho_L, u_L, p_L) = (1, \\sqrt{15}, 1) $.\n-   Right state ($ x > 1 $): $ (\\rho_R, u_R, p_R) = (3, \\sqrt{15}/3, 11) $.\n\nFor a moving shock, a constant bulk velocity $ U $ is added to the velocities: $ u_L' = u_L + U $ and $ u_R' = u_R + U $. The densities and pressures remain unchanged due to Galilean invariance.\n\n### Numerical Method\n\nWe employ a first-order conservative finite-volume Godunov-type method. The domain is discretized into $ N=800 $ uniform cells of width $ \\Delta x = L/N $. The state vector $ \\mathbf{U}_i $ in cell $ i $ is updated via the semi-discrete formula:\n$$\n\\frac{d\\mathbf{U}_i}{dt} = -\\frac{1}{\\Delta x}(\\mathbf{F}_{i+1/2} - \\mathbf{F}_{i-1/2})\n$$\nwhere $ \\mathbf{F}_{i+1/2} $ is the numerical flux at the interface between cell $ i $ and cell $ i+1 $.\n\nThe numerical flux is calculated using the Harten-Lax-van Leer (HLL) approximate Riemann solver, which is robust for problems involving shocks. The HLL flux depends on the left and right states at an interface, $ \\mathbf{U}_L $ and $ \\mathbf{U}_R $, and their corresponding physical fluxes $ \\mathbf{F}_L $ and $ \\mathbf{F}_R $. The formula is:\n$$\n\\mathbf{F}_{HLL} = \\begin{cases} \n      \\mathbf{F}_L & \\text{if } S_L \\geq 0 \\\\\n      \\mathbf{F}_R & \\text{if } S_R \\leq 0 \\\\\n      \\frac{S_R \\mathbf{F}_L - S_L \\mathbf{F}_R + S_L S_R (\\mathbf{U}_R - \\mathbf{U}_L)}{S_R - S_L} & \\text{otherwise}\n   \\end{cases}\n$$\nThe signal velocities $ S_L $ and $ S_R $ estimate the speeds of the slowest and fastest waves in the Riemann fan. We use the Einfeldt (1988) estimates for robustness:\n$$\nS_L = \\min(u_L - c_{s,L}, u_R - c_{s,R}), \\quad S_R = \\max(u_L + c_{s,L}, u_R + c_{s,R})\n$$\nwhere $ c_{s,L} $ and $ c_{s,R} $ are the sound speeds in the left and right states.\n\nTime integration is performed using an explicit first-order Euler method. Numerical stability is ensured by satisfying the Courant–Friedrichs–Lewy (CFL) condition. The time step $ \\Delta t $ is calculated at each step as:\n$$\n\\Delta t = \\text{CFL} \\frac{\\Delta x}{\\max_i(|u_i| + c_{s,i})}\n$$\nwith a given CFL number of $0.4$.\n\nBoundary conditions are transmissive (zero-gradient), implemented by setting the state in the ghost cells equal to the state in the adjacent interior computational cell.\n\n### Analysis of Galilean Invariance\nAfter evolving the system to the final time $ t_{\\mathrm{final}} = 0.05 $, we compute the domain-integrated specific entropy and kinetic energy. In discrete form, these are:\n$$\nS(t) = \\int_0^L \\rho s \\, dx \\approx \\sum_{i=0}^{N-1} \\rho_i s_i \\Delta x, \\quad s_i = \\ln\\left(\\frac{p_i}{\\rho_i^{\\gamma}}\\right)\n$$\n$$\nK(t) = \\int_0^L \\frac{1}{2} \\rho u^2 \\, dx \\approx \\sum_{i=0}^{N-1} \\frac{1}{2}\\rho_i u_i^2 \\Delta x\n$$\nThe errors due to numerical violation of Galilean invariance are quantified by comparing the results for a boosted shock ($ U > 0 $) to the baseline stationary shock ($ U=0 $):\n$$\n\\Delta S(U) = S_U(t_{\\mathrm{final}}) - S_{U=0}(t_{\\mathrm{final}}), \\quad\n\\Delta K(U) = K_U(t_{\\mathrm{final}}) - K_{U=0}(t_{\\mathrm{final}})\n$$\nThis procedure is repeated for each bulk speed $ U $ corresponding to the specified ratios $ U/c_{s,1} \\in \\{ 0, 2, 5, 10 \\} $. The resulting pairs $ [\\Delta S(U), \\Delta K(U)] $ are reported. For the baseline case $ U=0 $, these differences are by definition zero.", "answer": "[[0.000000,0.000000],[-0.000099,-0.000452],[-0.000609,-0.002824],[-0.002409,-0.011247]]", "id": "3506463"}]}