{"hands_on_practices": [{"introduction": "A primary task for an astrophysicist is not just running simulations, but interpreting their results. This exercise puts you in the role of an analyst, using a simplified, analytical stellar model to pinpoint a region of profound physical change: the onset of convection [@problem_id:3539465]. By applying the Schwarzschild criterion to the given profiles, you will practice calculating the radiative temperature gradient, $\\nabla_{\\mathrm{rad}}$, and determine the precise mass coordinate where convection becomes the dominant mode of energy transport, a fundamental skill in stellar diagnostics.", "problem": "Consider a one-dimensional, spherically symmetric stellar interior model written in the Lagrangian mass coordinate $m$, where $m$ denotes the mass enclosed within radius $r$. The total stellar mass is $M = 1.000 \\, M_{\\odot}$, where $M_{\\odot}$ is the solar mass, and the total luminosity is $L_{\\mathrm{tot}}$. Assume radiative transport is valid in the interior until convection sets in. The following interior profiles are prescribed for $0 \\leq m \\leq M$:\n$$L(m) = L_{\\mathrm{tot}} \\left(\\frac{m}{M}\\right), \\quad P(m) = P_{c} \\left(1 - \\frac{m}{M}\\right)^{2}, \\quad T(m) = T_{c} \\left(1 - \\frac{m}{M}\\right), \\quad \\kappa(m) = \\kappa_{0} \\left(1 - \\frac{m}{M}\\right)^{-1}.$$\nHere $P_{c}$ and $T_{c}$ are characteristic central scales, and $\\kappa(m)$ is the Rosseland mean opacity.\n\nUse the following physical constants (in centimeter-gram-second units):\n$$G = 6.67430 \\times 10^{-8}, \\quad c = 2.99792458 \\times 10^{10}, \\quad a = 7.5657 \\times 10^{-15},$$\nwhere $G$ is the gravitational constant, $c$ is the speed of light (c), and $a$ is the radiation constant. The stellar parameters are:\n$$M = 1.98847 \\times 10^{33} \\, \\text{g}, \\quad L_{\\mathrm{tot}} = 3.846 \\times 10^{33} \\, \\text{erg s}^{-1}, \\quad P_{c} = 2.5 \\times 10^{17} \\, \\text{dyne cm}^{-2}, \\quad T_{c} = 1.5 \\times 10^{7} \\, \\text{K}, \\quad \\kappa_{0} = 0.34 \\, \\text{cm}^{2} \\text{g}^{-1}.$$\n\nStarting from the fundamental laws of hydrostatic equilibrium, radiative diffusion, mass conservation, and energy conservation, derive the radiative logarithmic temperature gradient $\\nabla_{\\mathrm{rad}}(m)$ and determine the mass coordinate $m_{\\mathrm{b}}$ of the convective boundary defined by the equality condition $\\nabla_{\\mathrm{rad}}(m_{\\mathrm{b}}) = \\nabla_{\\mathrm{ad}}$, where $\\nabla_{\\mathrm{ad}}$ is the adiabatic logarithmic temperature gradient appropriate for a fully ionized monatomic ideal gas. Round your final result for $m_{\\mathrm{b}}$ to four significant figures. Express the final answer in solar masses.", "solution": "The problem requires finding the mass coordinate $m_{\\mathrm{b}}$ of the convective boundary in a simplified stellar model. This boundary is defined by the Schwarzschild criterion, which states that convection begins when the radiative logarithmic temperature gradient, $\\nabla_{\\mathrm{rad}}$, equals the adiabatic logarithmic temperature gradient, $\\nabla_{\\mathrm{ad}}$.\n\nFirst, we must derive the expression for $\\nabla_{\\mathrm{rad}}(m)$ using the fundamental equations of stellar structure in the Lagrangian mass coordinate $m$. The radiative gradient is defined as:\n$$ \\nabla_{\\mathrm{rad}} = \\left(\\frac{d \\ln T}{d \\ln P}\\right)_{\\mathrm{rad}} = \\frac{P}{T} \\frac{(dT/dm)_{\\mathrm{rad}}}{dP/dm} $$\nThe term $(dT/dm)_{\\mathrm{rad}}$ represents the temperature gradient required to transport the luminosity $L(m)$ by radiation alone. It is derived from the equation of radiative diffusion. In spherical symmetry, this equation is:\n$$ \\frac{dT}{dr} = -\\frac{3}{4ac} \\frac{\\kappa \\rho}{T^3} \\frac{L(r)}{4\\pi r^2} $$\nwhere $r$ is the radial coordinate, $\\kappa$ is the opacity, $\\rho$ is the density, $T$ is the temperature, $L(r)$ is the luminosity at radius $r$, $a$ is the radiation constant, and $c$ is the speed of light.\n\nThe term $dP/dm$ represents the pressure gradient determined by hydrostatic equilibrium:\n$$ \\frac{dP}{dr} = -\\frac{G m(r) \\rho}{r^2} $$\nwhere $G$ is the gravitational constant and $m(r)$ is the mass enclosed within radius $r$.\n\nTo convert these gradients to the Lagrangian mass coordinate $m$, we use the mass conservation equation:\n$$ \\frac{dm}{dr} = 4\\pi r^2 \\rho \\quad \\implies \\quad \\frac{dr}{dm} = \\frac{1}{4\\pi r^2 \\rho} $$\nUsing the chain rule, we find the gradients with respect to $m$:\n$$ \\frac{dP}{dm} = \\frac{dP}{dr} \\frac{dr}{dm} = \\left(-\\frac{G m \\rho}{r^2}\\right) \\left(\\frac{1}{4\\pi r^2 \\rho}\\right) = -\\frac{G m}{4\\pi r^4} $$\n$$ \\left(\\frac{dT}{dm}\\right)_{\\mathrm{rad}} = \\frac{dT}{dr} \\frac{dr}{dm} = \\left(-\\frac{3 \\kappa \\rho L}{16\\pi a c r^2 T^3}\\right) \\left(\\frac{1}{4\\pi r^2 \\rho}\\right) = -\\frac{3 \\kappa L}{64 \\pi^2 a c r^4 T^3} $$\nSubstituting these expressions into the definition of $\\nabla_{\\mathrm{rad}}$:\n$$ \\nabla_{\\mathrm{rad}}(m) = \\frac{P(m)}{T(m)} \\frac{-3 \\kappa(m) L(m) / (64 \\pi^2 a c r(m)^4 T(m)^3)}{-G m / (4\\pi r(m)^4)} $$\n$$ \\nabla_{\\mathrm{rad}}(m) = \\frac{P}{T} \\frac{3 \\kappa L}{64 \\pi^2 a c T^3} \\frac{4\\pi r^4}{G m} $$\nThis simplifies to the standard expression for the radiative gradient in Lagrangian coordinates:\n$$ \\nabla_{\\mathrm{rad}}(m) = \\frac{3}{16\\pi a c G} \\frac{\\kappa(m) L(m) P(m)}{m T(m)^4} $$\nThe problem provides analytical profiles for $L(m)$, $P(m)$, $T(m)$, and $\\kappa(m)$. Let's introduce the dimensionless mass coordinate $x = m/M$, where $M$ is the total stellar mass. The given profiles are:\n$$ L(m) = L_{\\mathrm{tot}} \\left(\\frac{m}{M}\\right) = L_{\\mathrm{tot}} x $$\n$$ P(m) = P_{c} \\left(1 - \\frac{m}{M}\\right)^{2} = P_{c} (1-x)^2 $$\n$$ T(m) = T_{c} \\left(1 - \\frac{m}{M}\\right) = T_{c} (1-x) $$\n$$ \\kappa(m) = \\kappa_{0} \\left(1 - \\frac{m}{M}\\right)^{-1} = \\kappa_{0} (1-x)^{-1} $$\nSubstituting these profiles into the expression for $\\nabla_{\\mathrm{rad}}(m)$:\n$$ \\nabla_{\\mathrm{rad}}(x) = \\frac{3}{16\\pi a c G} \\frac{[\\kappa_{0}(1-x)^{-1}] [L_{\\mathrm{tot}}x] [P_{c}(1-x)^2]}{(Mx) [T_{c}(1-x)]^4} $$\n$$ \\nabla_{\\mathrm{rad}}(x) = \\left(\\frac{3 \\kappa_0 L_{\\mathrm{tot}} P_c}{16\\pi a c G M T_c^4}\\right) \\frac{x(1-x)^1}{x(1-x)^4} $$\nThe term in the parenthesis is a dimensionless constant, which we shall call $C$:\n$$ C = \\frac{3 \\kappa_0 L_{\\mathrm{tot}} P_c}{16\\pi a c G M T_c^4} $$\nThe expression for the radiative gradient simplifies to:\n$$ \\nabla_{\\mathrm{rad}}(x) = C \\frac{1}{(1-x)^3} = C \\left(1 - \\frac{m}{M}\\right)^{-3} $$\nNext, we determine the adiabatic gradient $\\nabla_{\\mathrm{ad}}$. The problem states the stellar material is a fully ionized monatomic ideal gas. For such a gas, the ratio of specific heats is $\\gamma = 5/3$. The adiabatic gradient is given by:\n$$ \\nabla_{\\mathrm{ad}} = \\frac{\\gamma - 1}{\\gamma} = 1 - \\frac{1}{\\gamma} = 1 - \\frac{1}{5/3} = 1 - \\frac{3}{5} = \\frac{2}{5} = 0.4 $$\nThe convective boundary is at the mass coordinate $m_{\\mathrm{b}}$ (or $x_{\\mathrm{b}} = m_{\\mathrm{b}}/M$) where $\\nabla_{\\mathrm{rad}}(m_{\\mathrm{b}}) = \\nabla_{\\mathrm{ad}}$.\n$$ C (1 - x_{\\mathrm{b}})^{-3} = \\nabla_{\\mathrm{ad}} $$\nSolving for $x_{\\mathrm{b}}$:\n$$ (1 - x_{\\mathrm{b}})^{-3} = \\frac{\\nabla_{\\mathrm{ad}}}{C} $$\n$$ (1 - x_{\\mathrm{b}})^{3} = \\frac{C}{\\nabla_{\\mathrm{ad}}} $$\n$$ 1 - x_{\\mathrm{b}} = \\left(\\frac{C}{\\nabla_{\\mathrm{ad}}}\\right)^{1/3} $$\n$$ x_{\\mathrm{b}} = 1 - \\left(\\frac{C}{\\nabla_{\\mathrm{ad}}}\\right)^{1/3} $$\nNow, we must calculate the numerical value of the constant $C$ using the provided cgs values:\n$G = 6.67430 \\times 10^{-8}$, $c = 2.99792458 \\times 10^{10}$, $a = 7.5657 \\times 10^{-15}$, $M = 1.98847 \\times 10^{33}$, $L_{\\mathrm{tot}} = 3.846 \\times 10^{33}$, $P_{c} = 2.5 \\times 10^{17}$, $T_{c} = 1.5 \\times 10^{7}$, $\\kappa_{0} = 0.34$.\nNumerator of $C$:\n$$ 3 \\kappa_0 L_{\\mathrm{tot}} P_c = 3 \\times (0.34) \\times (3.846 \\times 10^{33}) \\times (2.5 \\times 10^{17}) = 9.8073 \\times 10^{50} $$\nDenominator of $C$:\n$$ 16\\pi a c G M T_c^4 = 16\\pi (7.5657 \\times 10^{-15}) (2.99792458 \\times 10^{10}) (6.67430 \\times 10^{-8}) (1.98847 \\times 10^{33}) (1.5 \\times 10^7)^4 $$\n$$ \\approx 7.659259 \\times 10^{52} $$\nThus, the value of $C$ is:\n$$ C = \\frac{9.8073 \\times 10^{50}}{7.659259 \\times 10^{52}} \\approx 0.0128045 $$\nNow we can find $x_{\\mathrm{b}}$:\n$$ x_{\\mathrm{b}} = 1 - \\left(\\frac{0.0128045}{0.4}\\right)^{1/3} = 1 - (0.03201125)^{1/3} $$\n$$ x_{\\mathrm{b}} \\approx 1 - 0.317506 = 0.682494 $$\nThe mass coordinate of the convective boundary is $m_{\\mathrm{b}} = x_{\\mathrm{b}} M$. Since the total mass $M$ is given as $1.000 \\, M_{\\odot}$, the value of $m_{\\mathrm{b}}$ in solar masses is numerically equal to $x_{\\mathrm{b}}$.\n$$ m_{\\mathrm{b}} \\approx 0.682494 \\, M_{\\odot} $$\nRounding to four significant figures as requested:\n$$ m_{\\mathrm{b}} \\approx 0.6825 \\, M_{\\odot} $$", "answer": "$$\\boxed{0.6825}$$", "id": "3539465"}, {"introduction": "The accuracy and stability of numerical stellar models are critically dependent on the careful implementation of boundary conditions. This practice problem focuses on the stellar surface, where physical conditions change rapidly, making it a notoriously challenging region to model [@problem_id:3539464]. You will derive the relationship between pressure and optical depth in a simplified stellar atmosphere to understand how the outermost grid points of a model are defined. This exercise highlights the practical challenges of interfacing a stellar interior model with its atmosphere and provides a quantitative measure of how grid resolution can impact the boundary solution.", "problem": "A computational stellar structure code integrates the equations of hydrostatic equilibrium in a spherically symmetric star and closes the outer boundary using an optical-depth condition. Consider a star of mass $M$ and radius $R$ whose outermost layer is treated as a gray atmosphere with constant Rosseland mean opacity $\\kappa$ across the top cell. Assume the layer is sufficiently thin that the surface gravity $g$ can be taken constant and equal to $g = G M / R^{2}$, where $G$ is the gravitational constant, and that pressure at the top of the atmosphere ($\\tau = 0$) is negligible compared to the interior. The code places the photospheric boundary at optical depth $\\tau_{\\mathrm{ph}} = 2/3$ and uses a grid in optical depth such that moving one cell inward increases optical depth by $\\Delta \\tau$.\n\nStarting only from the definitions of hydrostatic equilibrium, $dP/dr = -\\rho G M(r)/r^{2}$, and optical depth, $d\\tau = -\\kappa \\rho \\, dr$, derive an expression for $P(\\tau)$ in the outer layer, compute the photospheric pressure $P_{\\mathrm{ph}} = P(\\tau_{\\mathrm{ph}})$, and the pressure one grid cell inward $P_{1} = P(\\tau_{\\mathrm{ph}} + \\Delta \\tau)$. Then define the dimensionless boundary sensitivity metric\n$$S \\equiv \\frac{P_{1} - P_{\\mathrm{ph}}}{P_{\\mathrm{ph}}}$$\nand evaluate it numerically for the following parameters:\n- $M = 4.971175 \\times 10^{33}~\\mathrm{g}$,\n- $R = 1.3914 \\times 10^{11}~\\mathrm{cm}$,\n- $\\kappa = 0.34~\\mathrm{cm^{2}~g^{-1}}$,\n- $\\Delta \\tau = 0.05$,\n- $G = 6.67430 \\times 10^{-8}~\\mathrm{cm^{3}~g^{-1}~s^{-2}}$.\n\nProvide the final answer as the value of $S$, rounded to four significant figures. Because $S$ is dimensionless, no physical units should be included with the final answer.", "solution": "The problem requires the derivation of a boundary sensitivity metric, $S$, for a computational stellar structure code. The derivation must start from the fundamental equations of hydrostatic equilibrium and radiative transfer, under a set of simplifying assumptions for the outermost layer of a star.\n\nFirst, the problem statement must be validated. The givens are the equations for hydrostatic equilibrium, $dP/dr = -\\rho G M(r)/r^{2}$, and the definition of optical depth, $d\\tau = -\\kappa \\rho \\, dr$. The problem specifies a set of assumptions for the star's outer layer: it is a gray atmosphere with constant Rosseland mean opacity $\\kappa$, and it is thin enough that the mass enclosed $M(r)$ can be approximated by the total stellar mass $M$ and the radius $r$ by the total stellar radius $R$. This allows the use of a constant surface gravity, $g = GM/R^{2}$. The pressure at the top of the atmosphere, where the optical depth $\\tau = 0$, is assumed to be negligible. The photospheric boundary is set at $\\tau_{\\mathrm{ph}} = 2/3$. The numerical grid step in optical depth is $\\Delta\\tau$. Finally, numerical values for $M$, $R$, $\\kappa$, $\\Delta\\tau$, and the gravitational constant $G$ are provided. The problem asks for the numerical evaluation of the metric $S \\equiv (P_{1} - P_{\\mathrm{ph}})/P_{\\mathrm{ph}}$, where $P_{\\mathrm{ph}}$ is the pressure at $\\tau_{\\mathrm{ph}}$ and $P_{1}$ is the pressure at $\\tau_{\\mathrm{ph}} + \\Delta\\tau$. The problem is scientifically grounded in the principles of stellar atmospheres, is well-posed with sufficient information for a unique solution, and is stated objectively. Therefore, the problem is valid, and we may proceed with the solution.\n\nThe equation of hydrostatic equilibrium under the assumption of a thin outer layer simplifies to:\n$$\n\\frac{dP}{dr} = -\\rho g\n$$\nwhere $P$ is the pressure, $r$ is the radial coordinate, $\\rho$ is the density, and $g$ is the constant surface gravity.\n\nThe definition of optical depth is given as:\n$$\nd\\tau = -\\kappa \\rho \\, dr\n$$\nwhere $\\kappa$ is the constant Rosseland mean opacity. From this, we can express the derivative of optical depth with respect to radius as:\n$$\n\\frac{d\\tau}{dr} = -\\kappa \\rho\n$$\nTo find the relationship between pressure $P$ and optical depth $\\tau$, we can use the chain rule to find the derivative $dP/d\\tau$:\n$$\n\\frac{dP}{d\\tau} = \\frac{dP/dr}{d\\tau/dr}\n$$\nSubstituting the expressions for $dP/dr$ and $d\\tau/dr$:\n$$\n\\frac{dP}{d\\tau} = \\frac{-\\rho g}{-\\kappa \\rho} = \\frac{g}{\\kappa}\n$$\nThis is a first-order ordinary differential equation for pressure as a function of optical depth. Since both $g$ and $\\kappa$ are assumed to be constant in this layer, we can integrate this equation directly to find $P(\\tau)$:\n$$\n\\int dP = \\int \\frac{g}{\\kappa} d\\tau\n$$\n$$\nP(\\tau) = \\frac{g}{\\kappa} \\tau + C\n$$\nwhere $C$ is the constant of integration. We determine $C$ using the boundary condition that the pressure is negligible at the top of the atmosphere, which corresponds to $\\tau=0$. Thus, we set $P(0) = 0$.\n$$\nP(0) = \\frac{g}{\\kappa}(0) + C = 0 \\implies C = 0\n$$\nThe pressure profile in the outer layer is therefore given by the simple relation:\n$$\nP(\\tau) = \\frac{g}{\\kappa} \\tau\n$$\nThis linear relationship is a standard result for a gray atmosphere under the specified approximations.\n\nNext, we compute the pressure at the photosphere, $P_{\\mathrm{ph}}$, and the pressure one grid cell inward, $P_{1}$. The photosphere is located at $\\tau_{\\mathrm{ph}} = 2/3$.\n$$\nP_{\\mathrm{ph}} = P(\\tau_{\\mathrm{ph}}) = P\\left(\\frac{2}{3}\\right) = \\frac{g}{\\kappa} \\frac{2}{3}\n$$\nThe next grid point inward is at an optical depth of $\\tau_{1} = \\tau_{\\mathrm{ph}} + \\Delta\\tau$. The pressure at this point is:\n$$\nP_{1} = P(\\tau_{\\mathrm{ph}} + \\Delta\\tau) = \\frac{g}{\\kappa} (\\tau_{\\mathrm{ph}} + \\Delta\\tau) = \\frac{g}{\\kappa} \\left(\\frac{2}{3} + \\Delta\\tau\\right)\n$$\nNow, we can evaluate the dimensionless boundary sensitivity metric, $S$:\n$$\nS \\equiv \\frac{P_{1} - P_{\\mathrm{ph}}}{P_{\\mathrm{ph}}}\n$$\nSubstituting the expressions derived for $P_{1}$ and $P_{\\mathrm{ph}}$:\n$$\nS = \\frac{\\frac{g}{\\kappa} \\left(\\frac{2}{3} + \\Delta\\tau\\right) - \\frac{g}{\\kappa} \\frac{2}{3}}{\\frac{g}{\\kappa} \\frac{2}{3}}\n$$\nThe factor $g/\\kappa$ is common to all terms and cancels out:\n$$\nS = \\frac{\\left(\\frac{2}{3} + \\Delta\\tau\\right) - \\frac{2}{3}}{\\frac{2}{3}} = \\frac{\\Delta\\tau}{2/3} = \\frac{3}{2} \\Delta\\tau\n$$\nThis elegant result demonstrates that the sensitivity metric $S$, as defined, depends only on the size of the optical depth grid step $\\Delta\\tau$ relative to the optical depth of the photosphere $\\tau_{\\mathrm{ph}}$. The specific physical parameters of the star ($M$, $R$, $G$) and its atmosphere ($\\kappa$) are not needed for the final calculation of $S$, as they cancel out during the derivation.\n\nThe final step is to substitute the given numerical value for $\\Delta\\tau$ to compute $S$. We are given $\\Delta\\tau = 0.05$.\n$$\nS = \\frac{3}{2} (0.05) = 1.5 \\times 0.05 = 0.075\n$$\nThe problem asks for the answer to be rounded to four significant figures. Thus, we express the result as $0.07500$.", "answer": "$$\\boxed{0.07500}$$", "id": "3539464"}, {"introduction": "Bridging the gap from theoretical equations to a working simulation is the essence of computational astrophysics. This capstone problem guides you through the entire process of building a simple numerical solver for radiative transport from the ground up [@problem_id:3539424]. You will discretize the governing differential equation, represent the system as a graph Laplacian, and implement a solver with appropriate boundary conditions. Finally, you will perform verification and validation tests to ensure your code is not only running but also producing physically meaningful and accurate results, providing a complete exercise in computational scientific practice.", "problem": "Consider a spherically symmetric star modeled as a set of $N$ concentric spherical shells (nodes) with radii $r \\in [0,R]$. Energy transport is radiative and is modeled on a graph whose nodes are shell centers and whose edges connect adjacent shells. Each edge carries a radiative conductance that yields a symmetric graph Laplacian operator. Assume a uniform mass density $\\rho$, a constant opacity $\\kappa$, and a constant volumetric energy generation rate $\\epsilon_{\\mathrm{v}}$. Use the Stefanâ€“Boltzmann constant (SBC) $\\sigma$ in all radiative relations. Work in International System of Units (SI): meters, kilograms, seconds, kelvins.\n\nStarting from the following foundational laws and definitions:\n\n- Hydrostatic equilibrium: \n$$\\frac{d p}{d r} = - \\rho \\frac{G M_r}{r^2},$$\nwhere $G$ is the gravitational constant and $M_r$ is the mass enclosed within radius $r$.\n- Energy generation and luminosity in spherical symmetry:\n$$\\frac{d L_r}{d r} = 4 \\pi r^2 \\epsilon_{\\mathrm{v}}, \\quad F(r) = \\frac{L_r}{4 \\pi r^2},$$\nwhere $L_r$ is the luminosity interior to $r$ and $F(r)$ is the radiative flux.\n- Radiative diffusion flux in the diffusion approximation:\n$$F(r) = - \\frac{16 \\sigma T^3}{3 \\kappa \\rho} \\frac{d T}{d r},$$\nwhere $T(r)$ is the temperature.\n\nUse these to derive a discrete, graph-Laplacian model for energy transport in the variable $u(r) = T(r)^4$, constructing a finite-volume discretization over shell volumes. Let the face area be $A(r) = 4 \\pi r^2$, and the shell-center spacing be uniform $\\Delta r = R/N$. Impose zero-flux symmetry at $r=0$ and a radiative boundary condition at $r=R$ equating the outgoing flux to blackbody emission:\n$$F(R) = \\sigma T(R)^4.$$\n\nTasks:\n\n1. Assemble the symmetric graph Laplacian matrix $L \\in \\mathbb{R}^{N \\times N}$ whose entries encode radiative conductances between adjacent shells and to the outer boundary, such that the discrete steady-state energy balance enforces that the net outgoing radiative flux from each shell equals the volumetric energy generation in that shell. Use conductances of the form $g = k_u A/\\Delta r$, where $k_u$ is a constant radiative conductivity associated with the variable $u(r)$ derived from the foundational laws. Construct the source vector $s \\in \\mathbb{R}^N$ whose components are the integrated volumetric energy generation over each shell volume. Solve the linear system $L \\mathbf{u} = \\mathbf{s}$ for the discrete field $\\mathbf{u}$ (the list of $T^4$ values at shell centers). The outer boundary value $u(R)$ must be enforced via a Dirichlet condition consistent with the blackbody flux matching the interior flux at $R$.\n\n2. Test homology preservation: Normalize the discrete temperature-to-the-fourth field by the central and surface values to obtain a dimensionless shape. Compare the normalized discrete shape to the continuum homology expectation $1 - (r/R)^2$. Quantify the maximum absolute discrepancy across the grid. A successful homology preservation test requires the maximum absolute error to be less than $5 \\times 10^{-3}$ (dimensionless).\n\n3. Test hydrostatic consistency: Using the same radial grid, construct the discrete hydrostatic pressure profile $p(r)$ implied by the hydrostatic equilibrium equation with constant $\\rho$, using the boundary condition $p(R) = 0$. Evaluate the discrete radial derivative at shell faces via centered differences and compare it to the continuum gravitational force term $-\\rho G M_r / r^2$ using $M_r = \\frac{4}{3}\\pi \\rho r^3$. Quantify the maximum relative error over all interior faces using the analytic gradient magnitude as the normalization. A successful hydrostatic consistency test requires the maximum relative error to be less than $10^{-12}$ (dimensionless).\n\nImplement the above as a complete program that produces a single line of output containing the results of the tests for a specified suite of parameter sets. For each parameter set, return a boolean indicating whether both the homology and hydrostatic tests pass under the stated thresholds. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").\n\nUse the following test suite with SI units:\n\n- Test Case 1 (general case): $N = 64$, $R = 7.0 \\times 10^8 \\ \\mathrm{m}$, $\\rho = 1400 \\ \\mathrm{kg/m^3}$, $\\kappa = 0.34 \\ \\mathrm{m^2/kg}$, $\\epsilon_{\\mathrm{v}} = 1.0 \\times 10^{-3} \\ \\mathrm{W/m^3}$.\n- Test Case 2 (coarser grid and lower generation): $N = 16$, $R = 7.0 \\times 10^8 \\ \\mathrm{m}$, $\\rho = 1400 \\ \\mathrm{kg/m^3}$, $\\kappa = 0.34 \\ \\mathrm{m^2/kg}$, $\\epsilon_{\\mathrm{v}} = 5.0 \\times 10^{-4} \\ \\mathrm{W/m^3}$.\n- Test Case 3 (scaled radius): $N = 64$, $R = 1.4 \\times 10^9 \\ \\mathrm{m}$, $\\rho = 1400 \\ \\mathrm{kg/m^3}$, $\\kappa = 0.34 \\ \\mathrm{m^2/kg}$, $\\epsilon_{\\mathrm{v}} = 1.0 \\times 10^{-3} \\ \\mathrm{W/m^3}$.\n\nThe program must not require any user input and must print exactly a single line in the specified format. All computed errors are dimensionless; ensure all intermediate calculations are performed in SI units. Angles do not appear. Percentages must not be used; express all errors as decimals wherever needed in the reasoning.", "solution": "The problem requires the construction and validation of a numerical model for a simplified, spherically symmetric star. The validation is performed against two criteria: a homology preservation test for the energy transport solution and a hydrostatic consistency test for the pressure gradient. The problem is scientifically grounded, well-posed, and provides sufficient information for a unique solution. We proceed with the derivation and implementation.\n\n### Part 1: Discretization of the Energy Transport Equation\n\nThe analysis begins with the provided equations for radiative energy transport and generation within a star of uniform mass density $\\rho$, constant opacity $\\kappa$, and constant volumetric energy generation rate $\\epsilon_{\\mathrm{v}}$.\n\nThe radiative flux $F(r)$ is given by the diffusion approximation:\n$$F(r) = - \\frac{16 \\sigma T^3}{3 \\kappa \\rho} \\frac{d T}{d r}$$\nwhere $\\sigma$ is the Stefan-Boltzmann constant and $T(r)$ is the temperature at radius $r$. We introduce the variable $u(r) = T(r)^4$. Its derivative is $\\frac{du}{dr} = 4T^3 \\frac{dT}{dr}$. Substituting this into the flux equation yields a linear relationship between flux and the gradient of $u$:\n$$F(r) = - \\left(\\frac{4 \\sigma}{3 \\kappa \\rho}\\right) \\frac{du}{dr} = -k_u \\frac{du}{dr}$$\nHere, $k_u = \\frac{4 \\sigma}{3 \\kappa \\rho}$ is the constant radiative conductivity for the variable $u$.\n\nThe steady-state energy conservation equation is $\\nabla \\cdot \\mathbf{F} = \\epsilon_{\\mathrm{v}}$. In spherical coordinates for a spherically symmetric flux $F(r)$, this becomes:\n$$\\frac{1}{r^2} \\frac{d}{dr}(r^2 F(r)) = \\epsilon_{\\mathrm{v}}$$\nSubstituting the expression for $F(r)$ in terms of $u(r)$, we obtain the governing second-order ordinary differential equation for $u(r)$:\n$$-\\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 k_u \\frac{du}{dr}\\right) = \\epsilon_{\\mathrm{v}}$$\n\nWe employ a finite-volume method to discretize this equation. The stellar interior is divided into $N$ concentric spherical shells. The shell centers are located at radii $r_i = (i + 1/2)\\Delta r$ for $i = 0, 1, \\dots, N-1$, where $\\Delta r = R/N$. The faces between shells are at radii $r_{i+1/2} = (i+1)\\Delta r$ for $i = -1, \\dots, N-1$. Note that $r_{-1/2}=0$ and $r_{N-1/2}=R$.\n\nIntegrating the energy conservation equation over the volume $V_i$ of shell $i$ (from $r_{i-1/2}$ to $r_{i+1/2}$) and applying the divergence theorem gives:\n$$A_{i+1/2} F_{i+1/2} - A_{i-1/2} F_{i-1/2} = \\epsilon_{\\mathrm{v}} V_i = s_i$$\nwhere $A_{i+1/2} = 4\\pi r_{i+1/2}^2$ is the area of the face at $r_{i+1/2}$, and $s_i$ is the total energy generated in shell $i$.\n\nThe flux at a face is approximated using a centered finite difference of $u$ between adjacent shell centers:\n$$F_{i+1/2} \\approx -k_u \\frac{u_{i+1} - u_i}{\\Delta r}$$\nSubstituting this into the integrated energy balance gives:\n$$-k_u \\frac{A_{i+1/2}}{\\Delta r}(u_{i+1} - u_i) - \\left(-k_u \\frac{A_{i-1/2}}{\\Delta r}(u_i - u_{i-1})\\right) = s_i$$\nIntroducing the radiative conductance $g_{i+1/2} = k_u A_{i+1/2} / \\Delta r$, the equation becomes:\n$$-g_{i+1/2}(u_{i+1} - u_i) + g_{i-1/2}(u_i - u_{i-1}) = s_i$$\nRearranging for a standard linear system $L \\mathbf{u} = \\mathbf{s}$:\n$$-g_{i-1/2} u_{i-1} + (g_{i-1/2} + g_{i+1/2})u_i - g_{i+1/2} u_{i+1} = s_i$$\nThis structure defines the entries of a symmetric, tridiagonal graph Laplacian matrix $L$.\n\nThe boundary conditions are:\n1.  **Center ($r=0$):** The symmetry condition implies zero flux, $F(0)=0$. This is naturally handled in our discretization because the face area $A_{-1/2}$ at $r_{-1/2}=0$ is zero, making the conductance $g_{-1/2}=0$. For the first shell ($i=0$), the equation is $(g_{1/2})u_0 - g_{1/2}u_1 = s_0$. The matrix row is $L_{0,0} = g_{1/2}$, $L_{0,1} = -g_{1/2}$.\n\n2.  **Surface ($r=R$):** The problem specifies enforcing a Dirichlet condition derived from the physical radiative boundary condition $F(R) = \\sigma T(R)^4 = \\sigma u(R)$. For constant $\\epsilon_{\\mathrm{v}}$, integrating the luminosity equation gives $L_r = \\frac{4}{3}\\pi r^3 \\epsilon_{\\mathrm{v}}$, so the analytical flux is $F(r) = L_r/(4\\pi r^2) = \\epsilon_{\\mathrm{v}} r / 3$. At the surface, $F(R) = \\epsilon_{\\mathrm{v}} R / 3$. Equating the two expressions for $F(R)$ yields an analytical value for $u$ at the boundary:\n$$u(R) = u_{BC} = \\frac{\\epsilon_{\\mathrm{v}} R}{3\\sigma}$$\nWe treat this as a Dirichlet boundary condition. For the last shell ($i=N-1$), the energy balance involves the flux at the boundary face $r_{N-1/2}=R$. We consider a virtual node $u_R = u_{BC}$. The balance equation is:\n$$-g_{N-3/2} u_{N-2} + (g_{N-3/2} + g_{N-1/2})u_{N-1} - g_{N-1/2} u_R = s_{N-1}$$\nSince $u_R$ is a known value, its term is moved to the right-hand side:\n$$-g_{N-3/2} u_{N-2} + (g_{N-3/2} + g_{N-1/2})u_{N-1} = s_{N-1} + g_{N-1/2} u_{BC}$$\nThis modifies the source term for the last shell to $s'_{N-1} = s_{N-1} + g_{N-1/2} u_{BC}$, while the matrix $L$ remains an $N \\times N$ symmetric tridiagonal matrix. The system $L\\mathbf{u} = \\mathbf{s}'$ is then solved for the vector $\\mathbf{u} = [u_0, u_1, \\dots, u_{N-1}]^T$.\n\n### Part 2: Homology Preservation Test\n\nFor the given constant parameters, the analytical solution to the differential equation for $u(r)$ is $u(r) = u_c - (\\epsilon_{\\mathrm{v}} / (6k_u)) r^2$, where $u_c = u(0)$. A dimensionless shape variable $\\theta(r)$ can be defined by normalizing $u(r)$ with its central and surface values:\n$$\\theta(r) = \\frac{u(r) - u(R)}{u_c - u(R)} = \\frac{(u_c - C r^2) - (u_c - C R^2)}{u_c - (u_c - C R^2)} = \\frac{R^2 - r^2}{R^2} = 1 - (r/R)^2$$\nThis result is independent of the stellar parameters and is a form of homologous transformation. The test involves comparing the normalized discrete solution $\\mathbf{u}$ to this analytical shape. For each discrete point $r_i$, we compute the normalized value $\\theta_i = (u_i - u_{BC}) / (u_0 - u_{BC})$ and the analytical value $\\theta_{\\text{analytic},i} = 1 - (r_i/R)^2$. The homology error is the maximum absolute difference $|\\theta_i - \\theta_{\\text{analytic},i}|$ across all shells. The test passes if this error is less than $5 \\times 10^{-3}$.\n\n### Part 3: Hydrostatic Consistency Test\n\nThis test verifies the numerical implementation of a gradient operator against an analytical expression. The equation of hydrostatic equilibrium is $\\frac{dp}{dr} = - \\rho \\frac{G M_r}{r^2}$. With constant density $\\rho$, the enclosed mass is $M_r = \\frac{4}{3}\\pi \\rho r^3$. The pressure gradient is then:\n$$\\frac{dp}{dr} = -\\rho G \\left(\\frac{4}{3}\\pi \\rho r\\right) = -\\left(\\frac{4}{3}\\pi G \\rho^2\\right) r$$\nThe analytical pressure profile $p(r)$ is found by integrating this expression from the surface (where $p(R)=0$) inwards:\n$$p(r) = \\int_R^r -\\left(\\frac{4}{3}\\pi G \\rho^2\\right) r' dr' = \\frac{2}{3}\\pi G \\rho^2 (R^2 - r^2)$$\nThe test computes the discrete pressure $p_i$ at each shell center $r_i$ using this analytical formula. Then, it calculates the numerical gradient at each interior face $r_{i+1/2}$ using a centered difference: $(\\frac{dp}{dr})^{\\text{discrete}}_{i+1/2} = \\frac{p_{i+1} - p_i}{\\Delta r}$. This numerical gradient is compared to the analytical gradient evaluated at the same face location, $f(r_{i+1/2}) = -(\\frac{4}{3}\\pi G \\rho^2) r_{i+1/2}$. Due to the quadratic nature of $p(r)$, the centered difference scheme is exact, so the error should be near machine precision. The hydrostatic consistency error is the maximum relative error $|(\\frac{dp}{dr})^{\\text{discrete}} - f|/|f|$ over all interior faces. The test passes if this error is less than $10^{-12}$.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases and print results.\n    \"\"\"\n    # SI unit constants\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    sigma = 5.670374e-8  # W m^-2 K^-4\n\n    test_cases = [\n        # (N, R, rho, kappa, eps_v)\n        (64, 7.0e8, 1400, 0.34, 1.0e-3),\n        (16, 7.0e8, 1400, 0.34, 5.0e-4),\n        (64, 1.4e9, 1400, 0.34, 1.0e-3),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_case(params, G, sigma)\n        results.append(result)\n\n    # Format the final output as a string representing a list of booleans\n    # str(True) -> 'True', so we convert to lowercase to match common conventions.\n    output_str = f\"[{','.join(str(r).lower() for r in results)}]\"\n    print(output_str)\n\ndef run_case(params, G, sigma):\n    \"\"\"\n    Executes the full simulation and testing for a single parameter set.\n\n    Args:\n        params (tuple): A tuple containing (N, R, rho, kappa, eps_v).\n        G (float): Gravitational constant.\n        sigma (float): Stefan-Boltzmann constant.\n\n    Returns:\n        bool: True if both homology and hydrostatic tests pass, False otherwise.\n    \"\"\"\n    N, R, rho, kappa, eps_v = params\n\n    # --- Part 1: Assemble and solve the linear system for u = T^4 ---\n\n    # Grid definition\n    delta_r = R / N\n    # Shell centers (r_i): r_{1/2}, r_{3/2}, ...\n    r_i = (np.arange(N) + 0.5) * delta_r\n    # Shell faces (r_{i+1/2}): r_1, r_2, ...\n    r_half = (np.arange(N) + 1.0) * delta_r\n\n    # Radiative conductivity for variable u = T^4\n    k_u = (4 * sigma) / (3 * kappa * rho)\n\n    # Face areas and conductances\n    A_half = 4 * np.pi * r_half**2\n    g_half = k_u * A_half / delta_r  # g_{i+1/2} corresponds to g_half[i]\n\n    # Shell volumes\n    r_faces_for_vol = np.arange(N + 1) * delta_r\n    V_i = (4 / 3) * np.pi * (r_faces_for_vol[1:]**3 - r_faces_for_vol[:-1]**3)\n\n    # Assemble the symmetric tridiagonal Laplacian matrix L in banded format\n    # For scipy.linalg.solve_banded, ab is (l+u+1, N). for (1,1) -> (3,N)\n    # Row 0: super-diagonal, Row 1: main-diagonal, Row 2: sub-diagonal\n    ab = np.zeros((3, N))\n    ab[0, 1:] = -g_half[:-1]      # Super-diagonal L_{i, i+1}\n    ab[2, :-1] = -g_half[:-1]     # Sub-diagonal L_{i, i-1} (symmetric)\n    ab[1, 0] = g_half[0]          # Diagonal L_{0,0}\n    ab[1, 1:-1] = g_half[:-2] + g_half[1:-1] # Diagonal L_{i,i}\n    ab[1, -1] = g_half[-2] + g_half[-1] # Diagonal L_{N-1,N-1}\n    \n    # Assemble source vector s\n    s = eps_v * V_i\n    \n    # Apply Dirichlet boundary condition at r=R\n    u_BC = (eps_v * R) / (3 * sigma)\n    # Modify the source term for the last shell\n    s[-1] += g_half[-1] * u_BC\n\n    # Solve the linear system L u = s\n    u = solve_banded((1, 1), ab, s)\n\n    # --- Part 2: Homology Preservation Test ---\n\n    u_c_discrete = u[0]\n    u_R_val = u_BC\n    \n    # Avoid division by zero if u_c is very close to u_R\n    if np.isclose(u_c_discrete, u_R_val):\n        homology_error = 0.0\n    else:\n        theta_discrete = (u - u_R_val) / (u_c_discrete - u_R_val)\n        theta_analytic = 1.0 - (r_i / R)**2\n        homology_error = np.max(np.abs(theta_discrete - theta_analytic))\n\n    homology_test_pass = homology_error < 5e-3\n\n    # --- Part 3: Hydrostatic Consistency Test ---\n\n    # Constant for pressure calculation\n    Cp = (4 / 3) * np.pi * G * rho**2\n\n    # Analytical pressure at shell centers r_i\n    p_i = 0.5 * Cp * (R**2 - r_i**2)\n\n    # Discrete pressure derivative at interior faces (r_{1/2} to r_{N-3/2})\n    # These are faces between cells 0..1, 1..2, ..., N-2..N-1\n    dp_dr_discrete = (p_i[1:] - p_i[:-1]) / delta_r\n    \n    # Analytical force term at the same interior faces\n    interior_face_radii = r_half[:-1]\n    f_analytic = -Cp * interior_face_radii\n\n    # Relative error, avoiding division by zero at r=0 (which is not in this set)\n    hydro_error = np.max(np.abs((dp_dr_discrete - f_analytic) / f_analytic))\n\n    hydro_test_pass = hydro_error < 1e-12\n    \n    return homology_test_pass and hydro_test_pass\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3539424"}]}