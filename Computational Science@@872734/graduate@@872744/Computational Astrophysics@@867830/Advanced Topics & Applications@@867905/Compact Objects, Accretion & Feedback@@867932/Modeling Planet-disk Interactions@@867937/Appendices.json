{"hands_on_practices": [{"introduction": "Before simulating the intricate dance between a planet and its natal disk, one must first construct a stable stage. This foundational exercise guides you through the process of initializing a quiescent, one-dimensional gas disk in quasi-equilibrium. By balancing stellar gravity, pressure gradients, and centrifugal forces, and verifying the result against key stability criteria, you will build the essential skills needed to generate robust and physically meaningful initial conditions for more complex planet-disk simulations [@problem_id:3520488].", "problem": "You are asked to design, implement, and validate a one-dimensional radial initialization for a gas disk around a central star in which there is no embedded planet. The goal is to demonstrate that the chosen boundary conditions and initial profiles yield a quasi-equilibrium configuration under Newtonian gravity and the equation of state of an ideal gas. The derivation and validation must start from first principles. The computational astrophysics context is a protoplanetary disk without a planet, where the dominant forces are pressure gradients and central gravity, and the vertical structure is hydrostatic. You must write a complete, runnable program that constructs the disk state over a specified radial domain and returns boolean validation outcomes for several parameter sets.\n\nFundamental physical base:\n- The steady, axisymmetric radial momentum balance (from the Euler equations in cylindrical coordinates for zero radial velocity) relates the centrifugal term, central gravity, and the radial pressure gradient. The central gravitational field is Newtonian and spherically symmetric.\n- The gas obeys the ideal gas law.\n- Vertical hydrostatic equilibrium defines the relation between scale height and sound speed.\n- The stability of rotation must satisfy the Rayleigh criterion, and gravito-rotational equilibrium is characterized by the Toomre stability parameter.\n\nInitial profiles:\n- The surface density is a prescribed power law given by $\\Sigma(r) = \\Sigma_0 \\left(\\frac{r}{r_0}\\right)^{-p}$.\n- The temperature is a prescribed power law given by $T(r) = T_0 \\left(\\frac{r}{r_0}\\right)^{-q}$.\n\nUnits and constants:\n- Use the International System of Units (SI): meters for length, kilograms for mass, seconds for time, and Kelvin for temperature.\n- Use $G$ for the gravitational constant, $k_B$ for Boltzmann’s constant, and $m_p$ for the proton mass. The mean molecular weight is a dimensionless parameter $\\mu$ defined such that the gas particle mass is $\\mu m_p$.\n\nRadial domain and boundary conditions:\n- The computational domain is one-dimensional in radius $r \\in [r_{\\mathrm{in}}, r_{\\mathrm{out}}]$ discretized by $N$ grid points. The grid should resolve several decades where appropriate.\n- The boundary condition for the radial velocity is $v_r(r)=0$ everywhere, including boundaries.\n- The radial pressure gradient should be calculated with consistent one-sided derivatives at boundaries and central differences in the interior.\n\nDerive from first principles:\n- Starting from the steady-state radial force balance, derive the condition that determines the rotation profile $v_\\phi(r)$ in terms of the central gravity and the radial pressure gradient.\n- Using the ideal gas law, define the isothermal sound speed $c_s(r)$ in terms of $T(r)$ and $\\mu$.\n- Using vertical hydrostatic equilibrium under the central gravity, define the scale height $H(r)$ in terms of $c_s(r)$ and the Keplerian angular frequency.\n- Obtain the midplane density $\\rho(r)$ and midplane pressure $P(r)$ consistent with the given $\\Sigma(r)$ and $T(r)$.\n\nValidation criteria for quasi-equilibrium:\n- Positivity of rotation: $v_\\phi^2(r) > 0$ across the entire domain.\n- Radial force balance residual: define a dimensionless residual $R(r)$ as the magnitude of the discrepancy in the radial force balance normalized by the sum of the magnitudes of the gravity and pressure support terms. Require $\\max_r R(r) \\le \\epsilon$ where $\\epsilon$ is a specified tolerance.\n- Rayleigh stability: the specific angular momentum $j(r) = r v_\\phi(r)$ must satisfy $\\frac{dj}{dr} \\ge 0$ everywhere.\n- Toomre stability: the Toomre parameter $Q(r)$ must satisfy $Q(r) \\ge 1$ everywhere.\n\nImplementational details:\n- Compute $c_s(r)$ from the ideal gas law. Compute the Keplerian angular frequency using Newtonian gravity. Compute $H(r)$ from vertical hydrostatic equilibrium. Compute $\\rho(r)$ from $\\Sigma(r)$ and $H(r)$ by assuming a Gaussian vertical structure at the midplane. Compute $P(r)$ at the midplane. Compute the radial pressure gradient $\\frac{dP}{dr}$ using a finite-difference scheme appropriate for nonuniform grids. Compute $v_\\phi(r)$ consistent with the radial force balance. Then evaluate the three stability checks.\n- Take the residual tolerance to be $\\epsilon = 5 \\times 10^{-4}$.\n\nTest suite:\nFor each test case, provide parameters $(M_\\star,\\Sigma_0,p,T_0,q,\\mu,r_0,r_{\\mathrm{in}},r_{\\mathrm{out}},N)$ in SI units, where $r_0$ is a reference radius that should be $1$ Astronomical Unit (AU), expressed in meters.\n\n- Test case 1 (happy path):\n    - $M_\\star = 1.98847 \\times 10^{30}\\ \\mathrm{kg}$, $\\Sigma_0 = 5.0 \\times 10^{3}\\ \\mathrm{kg/m^2}$, $p = 1.0$, $T_0 = 280\\ \\mathrm{K}$, $q = 0.5$, $\\mu = 2.34$, $r_0 = 1\\ \\mathrm{AU}$, $r_{\\mathrm{in}} = 0.1\\ \\mathrm{AU}$, $r_{\\mathrm{out}} = 50\\ \\mathrm{AU}$, $N = 512$.\n- Test case 2 (steeper surface density and cooler outer disk):\n    - $M_\\star = 0.5 \\times 1.98847 \\times 10^{30}\\ \\mathrm{kg}$, $\\Sigma_0 = 3.0 \\times 10^{3}\\ \\mathrm{kg/m^2}$, $p = 1.5$, $T_0 = 120\\ \\mathrm{K}$, $q = 0.7$, $\\mu = 2.34$, $r_0 = 1\\ \\mathrm{AU}$, $r_{\\mathrm{in}} = 1\\ \\mathrm{AU}$, $r_{\\mathrm{out}} = 100\\ \\mathrm{AU}$, $N = 512$.\n- Test case 3 (edge case expected to fail due to weak gravity and hot gas):\n    - $M_\\star = 0.2 \\times 1.98847 \\times 10^{30}\\ \\mathrm{kg}$, $\\Sigma_0 = 5.0 \\times 10^{2}\\ \\mathrm{kg/m^2}$, $p = 0.5$, $T_0 = 400\\ \\mathrm{K}$, $q = 0.0$, $\\mu = 2.34$, $r_0 = 1\\ \\mathrm{AU}$, $r_{\\mathrm{in}} = 0.5\\ \\mathrm{AU}$, $r_{\\mathrm{out}} = 300\\ \\mathrm{AU}$, $N = 512$.\n- Test case 4 (hot inner disk, small domain):\n    - $M_\\star = 1.98847 \\times 10^{30}\\ \\mathrm{kg}$, $\\Sigma_0 = 8.0 \\times 10^{3}\\ \\mathrm{kg/m^2}$, $p = 0.5$, $T_0 = 1000\\ \\mathrm{K}$, $q = 1.0$, $\\mu = 2.34$, $r_0 = 1\\ \\mathrm{AU}$, $r_{\\mathrm{in}} = 0.05\\ \\mathrm{AU}$, $r_{\\mathrm{out}} = 5\\ \\mathrm{AU}$, $N = 512$.\n\nAstronomical Unit conversion:\n- $1\\ \\mathrm{AU} = 1.495978707 \\times 10^{11}\\ \\mathrm{m}$.\n\nProgram output specification:\n- For each test case, your program must output a boolean indicating whether the quasi-equilibrium validation passes (true) or fails (false) under the criteria above.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[true,false,true,false]\"). Use Python’s boolean literals \"True\" or \"False\" as they appear when converted to strings, with no spaces.\n\nNo external input should be read; all constants and test parameters must be defined in the program. Angles are not used. Express all physical quantities in SI units. Percentages are not used; any fractional quantity should be dimensionless or in SI units as appropriate.", "solution": "The problem requires the design and validation of a one-dimensional radial model for a protoplanetary gas disk in quasi-equilibrium. The solution is constructed from first principles of fluid dynamics and Newtonian gravity, assuming an ideal gas. The process involves deriving the physical state of the disk—including density, pressure, and rotational velocity—from specified power-law profiles for surface density and temperature, and then testing this state against four criteria for physical and numerical validity.\n\n### Fundamental Principles and Governing Equations\n\nThe model is based on the following physical principles, expressed in cylindrical coordinates $(r, \\phi, z)$ under the assumption of axisymmetry ($\\partial/\\partial\\phi = 0$) and a steady state ($\\partial/\\partial t = 0$) with no radial flow ($v_r=0$).\n\n1.  **Radial Force Balance**: The radial component of the Euler momentum equation describes the balance between the gravitational force from the central star, the radial pressure gradient, and the centrifugal force due to rotation. For a parcel of gas with density $\\rho$, the equilibrium condition is:\n    $$\n    \\frac{v_\\phi^2(r)}{r} = \\frac{GM_\\star}{r^2} + \\frac{1}{\\rho(r)}\\frac{dP(r)}{dr}\n    $$\n    where $v_\\phi(r)$ is the azimuthal velocity, $M_\\star$ is the central star's mass, $P(r)$ is the midplane gas pressure, and $G$ is the gravitational constant.\n\n2.  **Ideal Gas Law**: The gas pressure $P$, density $\\rho$, and temperature $T$ are related by the ideal gas law:\n    $$\n    P = \\frac{\\rho k_B T}{\\mu m_p}\n    $$\n    where $k_B$ is the Boltzmann constant, and the mean particle mass is $\\mu m_p$ ($\\mu$ is the mean molecular weight and $m_p$ is the proton mass). This allows us to define the isothermal sound speed, $c_s$, whose square is $c_s^2 = P/\\rho = k_B T / (\\mu m_p)$.\n\n3.  **Vertical Hydrostatic Equilibrium**: In a thin disk, the vertical structure is determined by the balance between the vertical pressure gradient and the vertical component of the star's gravity, $g_z \\approx (GM_\\star/r^2)(z/r) = \\Omega_K^2 z$, where $\\Omega_K(r) = \\sqrt{GM_\\star/r^3}$ is the Keplerian angular frequency. This leads to a Gaussian vertical density profile $\\rho(r, z) = \\rho(r) \\exp(-z^2 / (2H(r)^2))$, where $\\rho(r)$ is the midplane density and $H(r)$ is the vertical pressure scale height given by:\n    $$\n    H(r) = \\frac{c_s(r)}{\\Omega_K(r)}\n    $$\n    Here, the disk's angular frequency is approximated by the Keplerian value, a standard simplification for an initial model. The surface density $\\Sigma(r)$ is the vertical integral of $\\rho(r, z)$, which gives $\\Sigma(r) = \\sqrt{2\\pi} \\rho(r) H(r)$.\n\n### Algorithmic Implementation of the Disk State\n\nThe disk state is constructed sequentially on a logarithmically spaced radial grid $r \\in [r_{\\mathrm{in}}, r_{\\mathrm{out}}]$ with $N$ points, which is appropriate for a domain spanning several orders of magnitude.\n\n1.  **Initial Profiles**: The prescribed power-law profiles for surface density and temperature are first evaluated on the grid:\n    $$\n    \\Sigma(r) = \\Sigma_0 \\left(\\frac{r}{r_0}\\right)^{-p} \\quad \\text{and} \\quad T(r) = T_0 \\left(\\frac{r}{r_0}\\right)^{-q}\n    $$\n\n2.  **Derived Physical Quantities**: Using these profiles, the following quantities are calculated at each grid point $r_i$:\n    -   Isothermal sound speed: $c_s(r) = \\sqrt{k_B T(r) / (\\mu m_p)}$.\n    -   Keplerian angular frequency: $\\Omega_K(r) = \\sqrt{G M_\\star / r^3}$.\n    -   Scale height: $H(r) = c_s(r) / \\Omega_K(r)$.\n    -   Midplane density: $\\rho(r) = \\Sigma(r) / (\\sqrt{2\\pi} H(r))$.\n    -   Midplane pressure: $P(r) = \\rho(r) c_s(r)^2$.\n\n3.  **Rotation Profile**: The radial pressure gradient, $dP/dr$, is computed numerically using second-order central differences for interior points and one-sided differences at the boundaries, as implemented in `numpy.gradient`. The azimuthal velocity $v_\\phi(r)$ is then determined by rearranging the radial force balance equation:\n    $$\n    v_\\phi^2(r) = \\frac{GM_\\star}{r} + \\frac{r}{\\rho(r)}\\frac{dP(r)}{dr}\n    $$\n    This formulation ensures that the rotational velocity is consistent with a balance between gravity and pressure support.\n\n### Validation Criteria\n\nThe resulting disk state is validated against four criteria to ensure it represents a physically plausible, quasi-equilibrium configuration.\n\n1.  **Positivity of Rotation**: The pressure support term, which is typically negative ($dP/dr < 0$), must not be so large as to overcome the gravitational term. This requires that $v_\\phi^2(r) > 0$ across the entire domain. A failure indicates an unphysical state where pressure forces would overwhelm gravity.\n\n2.  **Radial Force Balance Residual**: A dimensionless residual $R(r)$ is defined to verify numerical self-consistency. It measures the fractional error in the radial force (per unit mass) balance:\n    $$\n    R(r) = \\frac{\\left| \\frac{v_\\phi^2}{r} - \\left( \\frac{GM_\\star}{r^2} + \\frac{1}{\\rho}\\frac{dP}{dr} \\right) \\right|}{\\frac{GM_\\star}{r^2} + \\left| \\frac{1}{\\rho}\\frac{dP}{dr} \\right|}\n    $$\n    Since $v_\\phi^2$ is computed to satisfy this balance, $R(r)$ should be zero up to floating-point precision. The check $\\max_r R(r) \\le \\epsilon = 5 \\times 10^{-4}$ serves as a sanity check on the numerical implementation.\n\n3.  **Rayleigh Stability**: For a fluid in rotation, hydrodynamic stability requires that the specific angular momentum $j(r) = r v_\\phi(r)$ must be a non-decreasing function of radius. This is the Rayleigh criterion:\n    $$\n    \\frac{dj(r)}{dr} \\ge 0\n    $$\n    The derivative $dj/dr$ is computed numerically, and the condition is checked at all grid points.\n\n4.  **Toomre Stability**: For a disk to be stable against its own self-gravity, the Toomre $Q$ parameter must be greater than or equal to one. The $Q$ parameter is given by:\n    $$\n    Q(r) = \\frac{c_s(r) \\kappa(r)}{\\pi G \\Sigma(r)} \\ge 1\n    $$\n    where $\\kappa(r)$ is the epicyclic frequency, defined by $\\kappa^2(r) = \\frac{1}{r^3} \\frac{d(j^2)}{dr}$. The derivative $d(j^2)/dr$ is computed numerically. The Rayleigh stability criterion ensures that $\\kappa^2 \\ge 0$, so $\\kappa$ is real.\n\nA test case is considered to pass validation only if all four criteria are met across the entire computational domain. The final program iterates through each parameter set, performs these calculations, and returns a boolean result.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the disk validation for all test cases.\n    \"\"\"\n    # Physical and Astronomical Constants in SI units\n    G = 6.67430e-11  # Gravitational constant (m^3 kg^-1 s^-2)\n    K_B = 1.380649e-23  # Boltzmann constant (J K^-1)\n    M_P = 1.67262192e-27  # Proton mass (kg)\n    AU = 1.495978707e11  # Astronomical Unit (m)\n    SOLAR_MASS = 1.98847e30 # Solar mass (kg)\n\n    def check_disk_equilibrium(params):\n        \"\"\"\n        Constructs and validates a 1D protoplanetary disk model.\n\n        Args:\n            params (tuple): A tuple containing the disk parameters in SI units:\n            (M_star, Sigma0, p, T0, q, mu, r0, r_in, r_out, N)\n\n        Returns:\n            bool: True if the disk model passes all validation criteria, False otherwise.\n        \"\"\"\n        M_star, Sigma0, p, T0, q, mu, r0, r_in, r_out, N = params\n        epsilon = 5.0e-4\n\n        # 1. Set up a logarithmically spaced radial grid\n        r = np.geomspace(r_in, r_out, N)\n\n        # 2. Define initial power-law profiles for surface density and temperature\n        Sigma = Sigma0 * (r / r0)**(-p)\n        T = T0 * (r / r0)**(-q)\n\n        # 3. Derive other physical quantities from first principles\n        cs_sq = K_B * T / (mu * M_P)\n        cs = np.sqrt(cs_sq)\n\n        Omega_K_sq = G * M_star / r**3\n        Omega_K = np.sqrt(Omega_K_sq)\n        \n        # Scale height assuming rotation is approximately Keplerian\n        H = cs / Omega_K\n\n        # Midplane density from surface density and scale height\n        rho = Sigma / (np.sqrt(2 * np.pi) * H)\n\n        # Midplane pressure from ideal gas law\n        P = rho * cs_sq\n\n        # 4. Determine the azimuthal velocity from radial force balance\n        # Compute the pressure gradient numerically\n        dPdr = np.gradient(P, r)\n        \n        # Calculate the square of the azimuthal velocity\n        v_phi_sq = G * M_star / r + r * dPdr / rho\n\n        # --- VALIDATION CHECKS ---\n\n        # Criterion 1: Positivity of rotation (v_phi^2 must be positive)\n        if not np.all(v_phi_sq > 0):\n            return False\n        \n        v_phi = np.sqrt(v_phi_sq)\n\n        # Criterion 2: Radial force balance residual\n        a_centrifugal = v_phi_sq / r\n        a_gravity = G * M_star / r**2\n        a_pressure = dPdr / rho\n        \n        numerator = np.abs(a_centrifugal - a_gravity - a_pressure)\n        denominator = a_gravity + np.abs(a_pressure)\n        # Avoid division by zero in the unlikely event denominator is zero\n        denominator[denominator == 0] = 1.0 \n        \n        R = numerator / denominator\n        if not (np.max(R) <= epsilon):\n            return False\n\n        # Criterion 3: Rayleigh stability (specific angular momentum non-decreasing)\n        j = r * v_phi\n        djdr = np.gradient(j, r)\n        if not np.all(djdr >= 0):\n            return False\n\n        # Criterion 4: Toomre stability (stable against self-gravity)\n        j_sq = j**2\n        dj_sq_dr = np.gradient(j_sq, r)\n        \n        # Rayleigh stability implies kappa^2 is non-negative.\n        # Add a check for robustness against small numerical errors.\n        if np.any(dj_sq_dr < 0):\n             return False # Should be caught by Rayleigh check, but good practice\n        \n        kappa_sq = dj_sq_dr / r**3\n        kappa = np.sqrt(kappa_sq)\n\n        Q = cs * kappa / (np.pi * G * Sigma)\n        if not np.all(Q >= 1):\n            return False\n\n        # If all checks pass, the configuration is valid\n        return True\n\n    # Test suite parameters provided in the problem statement\n    test_cases = [\n        # (M_star, Sigma0, p, T0, q, mu, r0, r_in, r_out, N)\n        # Case 1: Happy path\n        (1.0 * SOLAR_MASS, 5.0e3, 1.0, 280.0, 0.5, 2.34, 1.0 * AU, 0.1 * AU, 50.0 * AU, 512),\n        # Case 2: Steeper density, cooler disk\n        (0.5 * SOLAR_MASS, 3.0e3, 1.5, 120.0, 0.7, 2.34, 1.0 * AU, 1.0 * AU, 100.0 * AU, 512),\n        # Case 3: Expected fail (weak gravity, hot gas)\n        (0.2 * SOLAR_MASS, 5.0e2, 0.5, 400.0, 0.0, 2.34, 1.0 * AU, 0.5 * AU, 300.0 * AU, 512),\n        # Case 4: Hot inner disk, small domain\n        (1.0 * SOLAR_MASS, 8.0e3, 0.5, 1000.0, 1.0, 2.34, 1.0 * AU, 0.05 * AU, 5.0 * AU, 512),\n    ]\n\n    results = []\n    for case in test_cases:\n        is_valid = check_disk_equilibrium(case)\n        results.append(str(is_valid))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3520488"}, {"introduction": "The migration of low-mass planets is largely dictated by the delicate balance of torques exerted by the surrounding disk, with the corotation torque being a critical component. This torque's magnitude and even its sign depend on whether it is \"saturated\" or \"unsaturated,\" a state determined by the competition between the gas libration timescale within the planet's horseshoe region and the diffusion timescales set by viscosity and thermal conduction. This practice provides a direct, hands-on application of modern migration theory, allowing you to explore these physical regimes and classify the state of the corotation torque by comparing these fundamental timescales [@problem_id:3520537].", "problem": "You are to implement a complete, runnable program that numerically maps the saturation of the corotation torque in a planet-disk system by varying the kinematic viscosity and thermal diffusivity. The focus is to verify the criterion that saturation transitions occur when the libration time across the horseshoe region is comparable to the diffusion time across that same region. Use the following foundational relations and constants. For a planet of planet-to-star mass ratio $q$ embedded at orbital radius $r$ in a Keplerian disk around a star of mass $M_\\star$, the orbital angular frequency is given by $ \\Omega = \\sqrt{G M_\\star / r^3} $, where $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$. The half-width of the horseshoe region scales as $ x_s \\approx 1.1\\, r \\sqrt{q/h} $, where $h$ is the disk aspect ratio $H/r$ treated as a dimensionless constant. The horseshoe libration time is $ t_{\\mathrm{lib}} \\approx \\dfrac{8\\pi r}{3\\,\\Omega\\,x_s} $. The diffusive timescales are obtained from the diffusion equation: a scalar field diffuses across a length scale $L$ in a time $t \\sim L^2/D$, where $D$ is the diffusion coefficient. Taking $L = x_s$, the viscous and thermal diffusion times are $ t_{\\mathrm{visc}} = x_s^2/\\nu $ and $ t_{\\mathrm{therm}} = x_s^2/\\chi $, respectively, where $\\nu$ is the kinematic viscosity and $\\chi$ is the thermal diffusivity. You must implement the following logic per test case: compute $x_s$, $\\Omega$, $t_{\\mathrm{lib}}$, $t_{\\mathrm{visc}}$, and $t_{\\mathrm{therm}}$; compute the ratios $ R_{\\mathrm{visc}} = t_{\\mathrm{lib}}/t_{\\mathrm{visc}} $ and $ R_{\\mathrm{therm}} = t_{\\mathrm{lib}}/t_{\\mathrm{therm}} $; evaluate whether the equality criterion $t_{\\mathrm{lib}} \\sim t_{\\mathrm{diff}}$ holds for each channel within a tolerance factor $f_{\\mathrm{tol}} = 2.0$, meaning the criterion is considered verified if the ratio is within the closed interval $[1/f_{\\mathrm{tol}}, f_{\\mathrm{tol}}]$. For classification, assign an integer per channel: if the closeness criterion is satisfied, label as marginal with code $2$; otherwise, if $t_{\\mathrm{diff}} < t_{\\mathrm{lib}}$ (fast diffusion, unsaturated corotation torque), label as $1$; otherwise (slow diffusion, saturated corotation torque), label as $0$. All times must be computed in seconds, viscosities and diffusivities must be in $\\mathrm{m^2/s}$, masses in kilograms, distances in meters, and the mass ratio $q$ and aspect ratio $h$ are dimensionless. Your program must round $ R_{\\mathrm{visc}} $ and $ R_{\\mathrm{therm}} $ to six decimal places.\n\nTest Suite. Use the following five test cases, each specified as a tuple $(M_\\star, r, q, h, \\nu, \\chi)$ with units and values as described above. The astronomical unit is $1\\,\\mathrm{au} = 1.496\\times 10^{11}\\,\\mathrm{m}$.\n\n1. General case near the equality regime at $r=5\\,\\mathrm{au}$: $(1.98847\\times 10^{30}, 5\\times 1.496\\times 10^{11}, 3\\times 10^{-5}, 0.05, 2.5\\times 10^{10}, 2.5\\times 10^{10})$.\n2. Low diffusion (both channels) at $r=5\\,\\mathrm{au}$: $(1.98847\\times 10^{30}, 5\\times 1.496\\times 10^{11}, 3\\times 10^{-5}, 0.05, 1\\times 10^{8}, 1\\times 10^{8})$.\n3. High diffusion (both channels) at $r=5\\,\\mathrm{au}$: $(1.98847\\times 10^{30}, 5\\times 1.496\\times 10^{11}, 3\\times 10^{-5}, 0.05, 1\\times 10^{12}, 1\\times 10^{12})$.\n4. Mixed diffusion at $r=5\\,\\mathrm{au}$: $(1.98847\\times 10^{30}, 5\\times 1.496\\times 10^{11}, 3\\times 10^{-5}, 0.05, 1\\times 10^{9}, 1\\times 10^{11})$.\n5. Different mass and aspect ratio at $r=1\\,\\mathrm{au}$: $(1.98847\\times 10^{30}, 1\\times 1.496\\times 10^{11}, 1\\times 10^{-4}, 0.03, 4\\times 10^{12}, 1\\times 10^{13})$.\n\nOutput Specification. Your program should produce a single line of output containing a list of per-test-case results, where each result is the list $[C_{\\mathrm{visc}}, C_{\\mathrm{therm}}, R_{\\mathrm{visc}}, R_{\\mathrm{therm}}, S_{\\mathrm{visc}}, S_{\\mathrm{therm}}]$, with $C_{\\mathrm{visc}}$ and $C_{\\mathrm{therm}}$ booleans, $R_{\\mathrm{visc}}$ and $R_{\\mathrm{therm}}$ floats rounded to six decimal places, and $S_{\\mathrm{visc}}$ and $S_{\\mathrm{therm}}$ integers. The final format must be a single comma-separated list enclosed in square brackets, for example, $[[\\dots],[\\dots],\\dots]$.", "solution": "The problem statement has been critically examined and is determined to be **valid**. It is scientifically grounded in the established theory of planet-disk interactions, specifically concerning the saturation of corotation torque. The provided formulas for the Keplerian angular frequency, horseshoe region width, libration time, and diffusive timescales are standard and correct representations within this physical model. All necessary constants, parameters, and logical conditions are provided, making the problem well-posed and self-contained. The numerical values are physically plausible for protoplanetary disk environments.\n\nThe core principle of this problem is the comparison of two characteristic timescales in the vicinity of a planet embedded in a protoplanetary disk: the libration time, $t_{\\mathrm{lib}}$, and the diffusion time, $t_{\\mathrm{diff}}$. The corotation torque arises from material in the horseshoe region of the planet's orbit. This torque remains strong (unsaturated) as long as physical diffusion processes (viscosity and thermal conduction) can smooth out gradients in vortensity and entropy across the horseshoe width, $x_s$, faster than the material circulates. The circulation time is the libration time, $t_{\\mathrm{lib}}$. If diffusion is too slow compared to libration, these gradients are maintained, and the torque saturates (weakens significantly). The transition between these regimes occurs when the timescales are comparable, i.e., $t_{\\mathrm{lib}} \\sim t_{\\mathrm{diff}}$.\n\nThe algorithmic procedure to solve this problem involves a sequence of calculations for each given test case, which is defined by a set of parameters $(M_\\star, r, q, h, \\nu, \\chi)$.\n\nFirst, we compute the fundamental dynamical quantities of the system. The orbital angular frequency, $\\Omega$, of the planet at an orbital radius $r$ around a star of mass $M_\\star$ is given by the Keplerian formula:\n$$ \\Omega = \\sqrt{\\frac{G M_\\star}{r^3}} $$\nwhere $G$ is the gravitational constant.\n\nNext, we establish the spatial scale of the interaction region. The half-width of the horseshoe region, $x_s$, is determined by the planet-to-star mass ratio, $q$, and the disk's aspect ratio, $h = H/r$, through the scaling relation:\n$$ x_s \\approx 1.1 r \\sqrt{\\frac{q}{h}} $$\n\nWith these quantities, we can calculate the libration time, which represents the time for gas parcels to complete one orbit along the horseshoe streamlines:\n$$ t_{\\mathrm{lib}} \\approx \\frac{8\\pi r}{3\\,\\Omega\\,x_s} $$\n\nThe diffusion times across this width $x_s$ are calculated for both the viscous and thermal channels, governed by the kinematic viscosity $\\nu$ and thermal diffusivity $\\chi$, respectively. The general form for a diffusion time across a length $L$ with diffusivity $D$ is $t \\sim L^2/D$. Applying this to our context:\n$$ t_{\\mathrm{visc}} = \\frac{x_s^2}{\\nu} \\quad \\text{and} \\quad t_{\\mathrm{therm}} = \\frac{x_s^2}{\\chi} $$\n\nThe saturation criterion is evaluated by computing the ratios of the libration time to each of the diffusion times:\n$$ R_{\\mathrm{visc}} = \\frac{t_{\\mathrm{lib}}}{t_{\\mathrm{visc}}} \\quad \\text{and} \\quad R_{\\mathrm{therm}} = \\frac{t_{\\mathrm{lib}}}{t_{\\mathrm{therm}}} $$\n\nFinally, for each channel (viscous and thermal, indexed by $k \\in \\{\\mathrm{visc}, \\mathrm{therm}\\}$), we classify the state of the corotation torque based on the value of the ratio $R_k$. A tolerance factor $f_{\\mathrm{tol}} = 2.0$ is used to define a \"marginal\" regime.\n\n1.  The verification boolean, $C_k$, is set to True if the criterion $t_{\\mathrm{lib}} \\sim t_{\\mathrm{diff}}$ is met, which is defined as the ratio $R_k$ falling within the interval $[1/f_{\\mathrm{tol}}, f_{\\mathrm{tol}}]$, i.e., $C_k = (0.5 \\le R_k \\le 2.0)$.\n2.  The saturation state integer, $S_k$, is assigned based on the following hierarchy:\n    - If $R_k > f_{\\mathrm{tol}}$ (i.e., $R_k > 2.0$), diffusion is rapid compared to libration ($t_{\\mathrm{diff}} \\ll t_{\\mathrm{lib}}$). The torque is unsaturated. We assign $S_k = 1$.\n    - If $R_k  1/f_{\\mathrm{tol}}$ (i.e., $R_k  0.5$), diffusion is slow compared to libration ($t_{\\mathrm{diff}} \\gg t_{\\mathrm{lib}}$). The torque is saturated. We assign $S_k = 0$.\n    - Otherwise, the ratio is within the marginal range, $1/f_{\\mathrm{tol}} \\le R_k \\le f_{\\mathrm{tol}}$. The torque is marginal. We assign $S_k = 2$.\n\nThis complete procedure is applied to each test case, and the results, including the booleans $C_k$, the ratios $R_k$ rounded to six decimal places, and the integer state codes $S_k$, are aggregated into the final specified output format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and classifies the saturation state of corotation torque\n    for a series of planet-disk interaction scenarios.\n    \"\"\"\n    \n    # Gravitational constant in SI units (m^3 kg^-1 s^-2)\n    G = 6.67430e-11\n    \n    # Tolerance factor for evaluating the saturation criterion\n    f_tol = 2.0\n\n    # Define the test cases as per the problem statement.\n    # Each case is a tuple: (M_star, r, q, h, nu, chi)\n    test_cases = [\n        # Case 1: General case\n        (1.98847e30, 5 * 1.496e11, 3e-5, 0.05, 2.5e10, 2.5e10),\n        # Case 2: Low diffusion\n        (1.98847e30, 5 * 1.496e11, 3e-5, 0.05, 1e8, 1e8),\n        # Case 3: High diffusion\n        (1.98847e30, 5 * 1.496e11, 3e-5, 0.05, 1e12, 1e12),\n        # Case 4: Mixed diffusion\n        (1.98847e30, 5 * 1.496e11, 3e-5, 0.05, 1e9, 1e11),\n        # Case 5: Different parameters\n        (1.98847e30, 1 * 1.496e11, 1e-4, 0.03, 4e12, 1e13),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        M_star, r, q, h, nu, chi = case\n\n        # 1. Compute orbital angular frequency\n        Omega = np.sqrt(G * M_star / r**3)\n\n        # 2. Compute horseshoe region half-width\n        xs = 1.1 * r * np.sqrt(q / h)\n\n        # 3. Compute horseshoe libration time\n        t_lib = (8.0 * np.pi * r) / (3.0 * Omega * xs)\n\n        # 4. Compute viscous and thermal diffusion times\n        t_visc = xs**2 / nu\n        t_therm = xs**2 / chi\n\n        # 5. Compute the ratios of libration to diffusion times\n        R_visc = t_lib / t_visc\n        R_therm = t_lib / t_therm\n        \n        # 6. Classify each channel (viscous and thermal)\n        results_for_case = []\n        \n        # Process viscous channel\n        C_visc = (1.0 / f_tol = R_visc = f_tol)\n        if R_visc  f_tol:\n            S_visc = 1  # Unsaturated\n        elif R_visc  1.0 / f_tol:\n            S_visc = 0  # Saturated\n        else:\n            S_visc = 2  # Marginal\n\n        # Process thermal channel\n        C_therm = (1.0 / f_tol = R_therm = f_tol)\n        if R_therm  f_tol:\n            S_therm = 1  # Unsaturated\n        elif R_therm  1.0 / f_tol:\n            S_therm = 0  # Saturated\n        else:\n            S_therm = 2  # Marginal\n            \n        # Assemble the result list for the current case as per specification\n        # [C_visc, C_therm, R_visc, R_therm, S_visc, S_therm]\n        case_output = [\n            C_visc, \n            C_therm, \n            round(R_visc, 6), \n            round(R_therm, 6), \n            S_visc, \n            S_therm\n        ]\n        all_results.append(case_output)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, stringified.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3520537"}, {"introduction": "A planet's gravitational influence excites spiral density waves at Lindblad resonances, which propagate through the disk carrying angular momentum. The deposition of this angular momentum is the primary mechanism for opening gaps around massive planets and driving the long-term evolution of the disk. In this advanced practice, you will use the WKB approximation to model the radial propagation and viscous damping of these waves, connecting the local dissipation of wave action to the global transport of angular momentum. By numerically integrating the wave's angular momentum flux, you will verify the fundamental conservation law that governs how planets sculpt their natal disks [@problem_id:3520550].", "problem": "You are modeling the transport of angular momentum by small-amplitude, planet-driven spiral waves in a geometrically thin, two-dimensional, isothermal, non-self-gravitating Keplerian disk. A planet of mass $M_{\\mathrm{p}}$ on a circular orbit of radius $r_{\\mathrm{p}}$ excites inner and outer spiral waves that carry angular momentum away from their respective Lindblad resonances. Assume a Keplerian angular frequency $\\Omega(r) = r^{-3/2}$ in units where the gravitational constant times the stellar mass equals unity, an isothermal sound speed $c_{\\mathrm{s}}(r) = h\\,r\\,\\Omega(r)$ with constant aspect ratio $h$, and a Shakura-Sunyaev kinematic viscosity $\\nu(r) = \\alpha\\,c_{\\mathrm{s}}(r)^2 / \\Omega(r)$ with constant $\\alpha$. Consider tightly wound waves with azimuthal wavenumber $m$ and pattern frequency $\\omega = m\\,\\Omega(r_{\\mathrm{p}})$ such that the linearized, local dispersion relation for inertial-acoustic waves holds, namely\n$$(\\omega - m\\,\\Omega(r))^2 = \\kappa(r)^2 + c_{\\mathrm{s}}(r)^2\\,k(r)^2,$$\nwhere $\\kappa(r) = \\Omega(r)$ for a Keplerian disk and $k(r)$ is the radial wavenumber along the WKB (Wentzel-Kramers-Brillouin) wave path. The inner and outer Lindblad resonance radii $r_{\\mathrm{IL}}$ and $r_{\\mathrm{OL}}$ are defined implicitly by $|\\omega - m\\,\\Omega(r_{\\mathrm{L}})| = \\kappa(r_{\\mathrm{L}})$; use the Keplerian identity to show $r_{\\mathrm{IL}} = \\Omega_{\\mathrm{IL}}^{-2/3}$ with $\\Omega_{\\mathrm{IL}} = \\Omega(r_{\\mathrm{p}})/(1 - 1/m)$, and $r_{\\mathrm{OL}} = \\Omega_{\\mathrm{OL}}^{-2/3}$ with $\\Omega_{\\mathrm{OL}} = \\Omega(r_{\\mathrm{p}})/(1 + 1/m)$.\n\nStarting from the linearized fluid equations and the definition of canonical wave action in a shearing flow, derive from first principles an evolution equation for the radial angular momentum flux $F_J(r)$ carried by a single WKB wave branch in the presence of viscous dissipation. You must begin from the conservation of wave action and the work done by viscous stresses on the perturbations. Show that in the absence of dissipation the canonical angular momentum flux $F_J$ is conserved along the ray, and obtain the leading-order viscous spatial damping rate in terms of the local kinematic viscosity, the radial wavenumber, and the radial group velocity $c_g(r)$, defined by the appropriate derivative of the dispersion relation with respect to the wavenumber for a fixed pattern frequency. Your derivation must produce a physically interpretable expression that connects $dF_J/dr$ to the local viscous dissipation of the wave and must be valid for both the inner and outer branches.\n\nThen, implement a program that, for specified parameters and boundaries, performs the following steps:\n- Compute $r_{\\mathrm{IL}}$ and $r_{\\mathrm{OL}}$ for the given $m$ and $r_{\\mathrm{p}}$.\n- For each branch (inner and outer), choose a starting radius $r_0$ slightly offset from the corresponding resonance in the propagation region, specifically $r_0 = r_{\\mathrm{IL}} - \\epsilon$ for the inner branch and $r_0 = r_{\\mathrm{OL}} + \\epsilon$ for the outer branch, with a small offset $\\epsilon$ such that the WKB approximation is valid and $k(r_0)^2 > 0$.\n- Treat the planet-to-wave coupling as establishing an initial angular momentum flux $F_J(r_0)$ for each branch equal to a specified launch value $T_{\\mathrm{launch,\\,in}}$ and $T_{\\mathrm{launch,\\,out}}$ (dimensionless torque units), respectively.\n- Using your derived viscous damping expression, integrate $F_J(r)$ along the ray from $r_0$ to the corresponding domain boundary ($r_{\\mathrm{in}}$ for the inner branch, $r_{\\mathrm{out}}$ for the outer branch), computing both:\n  1. The boundary flux $F_J$ at $r_{\\mathrm{in}}$ and $r_{\\mathrm{out}}$, and\n  2. The cumulative angular momentum deposition in the disk between $r_0$ and the boundary by integrating the local dissipation of $F_J$ along the path.\n- Verify global torque balance for each branch by checking that the angular momentum deposited in the disk between the resonance and the boundary equals the difference between the launched flux and the boundary flux, that is, the identity\n$$\\Delta J_{\\mathrm{dep}} = T_{\\mathrm{launch}} - F_J(\\text{boundary}),$$\nholds to within a specified numerical tolerance for both inner and outer branches.\n\nAll computations are to be performed in dimensionless code units consistent with the definitions above, so no physical unit conversion is required. Angles, if any, are to be treated implicitly through the azimuthal wavenumber $m$; no angle units are needed. Your program must implement the numerical integrals with appropriate resolution to capture the wave damping and must reject points where the propagation condition $k(r)^2 > 0$ fails.\n\nTest Suite:\nProvide results for the following parameter sets, each specified as a tuple $(r_{\\mathrm{p}}, m, h, \\alpha, T_{\\mathrm{launch,\\,in}}, T_{\\mathrm{launch,\\,out}}, r_{\\mathrm{in}}, r_{\\mathrm{out}}, \\epsilon, \\text{tol})$ with all quantities dimensionless:\n\n1. $(1.0, 20, 0.05, 0.001, 1.0\\times 10^{-5}, 1.2\\times 10^{-5}, 0.40, 2.50, 1.0\\times 10^{-3}, 1.0\\times 10^{-9})$.\n2. $(1.0, 20, 0.05, 0.0, 1.0\\times 10^{-5}, 1.0\\times 10^{-5}, 0.50, 2.00, 1.0\\times 10^{-3}, 1.0\\times 10^{-10})$.\n3. $(1.0, 20, 0.05, 0.005, 1.0\\times 10^{-5}, 1.0\\times 10^{-5}, 0.50, 2.50, 1.0\\times 10^{-3}, 1.0\\times 10^{-9})$.\n4. $(1.0, 30, 0.05, 0.001, 8.0\\times 10^{-6}, 9.0\\times 10^{-6}, 0.70, 1.30, 5.0\\times 10^{-4}, 1.0\\times 10^{-9})$.\n5. $(1.0, 50, 0.05, 0.001, 6.0\\times 10^{-6}, 6.5\\times 10^{-6}, 0.60, 1.80, 5.0\\times 10^{-4}, 1.0\\times 10^{-9})$.\n\nFor each test case, output a single boolean that is true if and only if the global torque balance identity holds to within the specified tolerance simultaneously for both the inner and outer branches.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where $r_i$ is the boolean result for test case $i$ as defined above.", "solution": "The problem is a well-posed and scientifically grounded exercise in the theory of planet-disk interactions, a fundamental topic in computational astrophysics. All provided definitions, equations, and physical assumptions are standard and consistent with the established literature on the subject. The problem is therefore deemed **valid**, and a full solution is presented below.\n\nOur objective is to derive the evolution equation for the radial angular momentum flux, $F_J(r)$, carried by a spiral density wave in a viscous disk, and then to use this equation to numerically verify the conservation of angular momentum.\n\nThe derivation proceeds from the principle of wave action conservation. For a wave in a time-invariant, axisymmetric medium, the wave action is conserved in the absence of dissipation. In the presence of dissipation, its conservation law provides a direct way to calculate the damping of the wave. The angular momentum flux of the wave is directly proportional to its action flux.\n\nLet $\\omega$ be the wave's pattern frequency in the inertial frame and $m$ be its azimuthal wavenumber. In a disk rotating with angular frequency $\\Omega(r)$, the wave's frequency in the local co-rotating fluid frame is the Doppler-shifted frequency, $\\omega'(r) = \\omega - m\\,\\Omega(r)$. The wave action density, $\\mathcal{A}$, is defined as the wave energy density in the local fluid frame, $E'$, divided by this local frequency: $\\mathcal{A} = E'/\\omega'$.\n\nThe conservation of wave action in a stationary state with dissipation is given by:\n$$\n\\nabla \\cdot \\vec{\\mathcal{F}}_{\\mathcal{A}} = -\\mathcal{D}_{\\mathcal{A}}\n$$\nwhere $\\vec{\\mathcal{F}}_{\\mathcal{A}} = \\vec{c}_g \\mathcal{A}$ is the wave action flux, $\\vec{c}_g$ is the group velocity, and $\\mathcal{D}_{\\mathcal{A}}$ is the rate of action dissipation per unit volume (or area in a 2D disk). For an axisymmetric 2D disk, this simplifies to:\n$$\n\\frac{1}{r} \\frac{d}{dr}(r \\, c_g(r) \\, \\mathcal{A}(r)) = -\\mathcal{D}_{\\mathcal{A}}(r)\n$$\nwhere $c_g$ is the radial component of the group velocity.\n\nThe total angular momentum flux, $F_J(r)$, passing through a cylinder of radius $r$ is related to the total energy flux, $F_E(r)$, by the relation $F_J = (m/\\omega) F_E$. The energy flux is the product of the wave energy density in the inertial frame, $E$, the group velocity, and the area $2\\pi r$. The energy density $E$ is related to the action density $\\mathcal{A}$ by $E = \\omega \\mathcal{A}$. Combining these, we find the relationship between the total angular momentum flux and the action density:\n$$\nF_J(r) = \\frac{m}{\\omega} F_E(r) = \\frac{m}{\\omega} (E \\, c_g \\, 2\\pi r) = \\frac{m}{\\omega} ((\\omega \\mathcal{A}) \\, c_g \\, 2\\pi r) = 2\\pi r m c_g(r) \\mathcal{A}(r)\n$$\nDifferentiating $F_J(r)$ with respect to $r$ yields:\n$$\n\\frac{dF_J}{dr} = 2\\pi m \\frac{d}{dr}(r c_g \\mathcal{A})\n$$\nSubstituting the action conservation equation, we get:\n$$\n\\frac{dF_J}{dr} = 2\\pi m (-r \\mathcal{D}_{\\mathcal{A}})\n$$\nThis equation provides the crucial link: the radial change in the angular momentum flux is equal to the torque exerted on the disk by the local dissipation of the wave. A negative $dF_J/dr$ corresponds to a positive torque on the disk.\n\nThe dissipation of action, $\\mathcal{D}_{\\mathcal{A}}$, is sourced by viscosity. For small-amplitude waves, the viscous dissipation rate of wave action is $\\mathcal{D}_{\\mathcal{A}} = 2\\gamma \\mathcal{A}$, where $\\gamma$ is the damping rate of the wave amplitude. For a viscous fluid, this damping rate is given by $\\gamma = \\nu k^2$ in the tightly-wound limit, where $\\nu$ is the kinematic viscosity and $k$ is the radial wavenumber.\nThus, $\\mathcal{D}_{\\mathcal{A}}(r) = 2\\nu(r) k(r)^2 \\mathcal{A}(r)$.\n\nSubstituting this into the equation for $dF_J/dr$:\n$$\n\\frac{dF_J}{dr} = -4\\pi r m \\nu(r) k(r)^2 \\mathcal{A}(r)\n$$\nTo obtain an equation solely in terms of $F_J$, we express $\\mathcal{A}$ using its relation to $F_J$: $\\mathcal{A}(r) = F_J(r) / (2\\pi r m c_g(r))$.\n$$\n\\frac{dF_J}{dr} = -4\\pi r m \\nu k^2 \\left( \\frac{F_J}{2\\pi r m c_g} \\right) = - \\frac{2\\nu(r) k(r)^2}{c_g(r)} F_J(r)\n$$\nThis is the first-order ordinary differential equation governing the radial evolution of the wave's angular momentum flux due to viscous damping. Without dissipation ($\\nu=0$), $dF_J/dr = 0$, and the angular momentum flux is conserved, as expected.\n\nTo solve this equation, we need explicit expressions for the coefficients, derived from the provided physical model.\n1.  **Disk Properties**: The Keplerian angular frequency is $\\Omega(r) = r^{-3/2}$ (in units of $GM_*=1$). The sound speed is $c_s(r) = h r \\Omega(r) = h r^{-1/2}$. The kinematic viscosity is $\\nu(r) = \\alpha c_s(r)^2 / \\Omega(r) = \\alpha (h^2 r^{-1}) / (r^{-3/2}) = \\alpha h^2 r^{1/2}$.\n\n2.  **Wavenumber $k(r)$**: From the given dispersion relation $(\\omega - m\\Omega)^2 = \\kappa^2 + c_s^2 k^2$, with $\\kappa=\\Omega$ for a Keplerian disk, we solve for $k^2$:\n    $$\n    k(r)^2 = \\frac{(\\omega - m\\Omega(r))^2 - \\Omega(r)^2}{c_s(r)^2}\n    $$\n    The wave propagates where $k^2 > 0$, i.e., outside the Lindblad resonances. The planet's pattern frequency is $\\omega = m\\,\\Omega(r_{\\mathrm{p}})$.\n\n3.  **Group Velocity $c_g(r)$**: The radial group velocity is found by differentiating the dispersion relation: $c_g = \\partial\\omega/\\partial k$. Using implicit differentiation, $c_g = -(\\partial D / \\partial k) / (\\partial D / \\partial \\omega)$, where $D(\\omega, k, r) = (\\omega - m\\Omega)^2 - \\Omega^2 - c_s^2 k^2 = 0$.\n    $$\n    \\frac{\\partial D}{\\partial\\omega} = 2(\\omega - m\\Omega) \\quad \\text{and} \\quad \\frac{\\partial D}{\\partial k} = -2c_s^2 k\n    $$\n    This yields $c_g(r) = \\frac{c_s(r)^2 k(r)}{\\omega - m\\Omega(r)}$. The sign of $c_g$ correctly indicates outward propagation for the outer wave ($\\omega  m\\Omega$) and inward for the inner wave ($\\omega  m\\Omega$).\n\nCombining these, the damping term in the ODE can be expressed as:\n$$\n\\frac{dF_J}{dr} = - \\left( \\frac{2\\nu k^2}{c_s^2 k / (\\omega - m\\Omega)} \\right) F_J = - \\frac{2\\nu(r) |k(r)| (\\omega - m\\Omega(r))}{c_s(r)^2} \\text{sgn}(k) F_J(r)\n$$\nwhere $|k| = \\sqrt{k^2}$. The term $\\text{sgn}(k)$ can be absorbed by noting that $\\omega - m\\Omega$ has the correct sign for each branch. The term $k/c_g = k^2 (\\omega-m\\Omega)/c_s^2 k^2 = (\\omega-m\\Omega)/c_s^2$. Then the ODE is:\n$$\n\\frac{dF_J}{dr} = - \\frac{2\\nu k^2 (\\omega-m\\Omega)}{c_s^2} F_J\n$$\nThis form avoids ambiguity around the sign of $k(r)$.\n\nTo perform the required verification, we numerically integrate this ODE. The total angular momentum deposited into the disk between the launch radius $r_0$ and a boundary $r_b$ is $\\Delta J_{\\mathrm{dep}} = \\int_{r_0}^{r_b} (-\\frac{dF_J}{dr'}) dr'$. By the fundamental theorem of calculus, this is equal to $F_J(r_0) - F_J(r_b)$. The problem asks to verify this identity numerically. We can set up a system of two ODEs: one for $F_J(r)$ and one for the cumulative deposited momentum $\\Delta J_{\\mathrm{dep}}(r) = \\int_{r_0}^r (-dF_J/dr')dr'$.\nLet $y_0(r) = F_J(r)$ and $y_1(r) = \\Delta J_{\\mathrm{dep}}(r)$. The system is:\n$$\n\\frac{dy_0}{dr} = - \\frac{2\\nu k^2}{c_g} y_0(r)\n$$\n$$\n\\frac{dy_1}{dr} = -\\frac{dy_0}{dr} = \\frac{2\\nu k^2}{c_g} y_0(r)\n$$\nwith initial conditions $y_0(r_0) = T_{\\mathrm{launch}}$ and $y_1(r_0) = 0$. After integrating from $r_0$ to $r_b$, we check if $|y_1(r_b) - (T_{\\mathrm{launch}} - y_0(r_b))|$ is within the specified tolerance `tol`. This confirms the self-consistency of the numerical integration of the derived physical model.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main solver function to process test cases for planet-disk interaction.\n    \"\"\"\n    test_cases = [\n        (1.0, 20, 0.05, 0.001, 1.0e-5, 1.2e-5, 0.40, 2.50, 1.0e-3, 1.0e-9),\n        (1.0, 20, 0.05, 0.0, 1.0e-5, 1.0e-5, 0.50, 2.00, 1.0e-3, 1.0e-10),\n        (1.0, 20, 0.05, 0.005, 1.0e-5, 1.0e-5, 0.50, 2.50, 1.0e-3, 1.0e-9),\n        (1.0, 30, 0.05, 0.001, 8.0e-6, 9.0e-6, 0.70, 1.30, 5.0e-4, 1.0e-9),\n        (1.0, 50, 0.05, 0.001, 6.0e-6, 6.5e-6, 0.60, 1.80, 5.0e-4, 1.0e-9),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation_for_case(case)\n        results.append(result)\n\n    # Format the final output as a comma-separated list of booleans in a string.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation_for_case(case):\n    \"\"\"\n    Runs the simulation for a single test case and verifies torque balance.\n    \"\"\"\n    rp, m, h, alpha, T_launch_in, T_launch_out, r_in, r_out, epsilon, tol = case\n\n    # Keplerian angular frequency (GM_* = 1)\n    Omega = lambda r: r**(-1.5)\n    # Sound speed\n    cs = lambda r: h * r * Omega(r)\n    # Kinematic viscosity\n    nu = lambda r: alpha * cs(r)**2 / Omega(r) if alpha  0.0 else 0.0\n\n    Omega_p = Omega(rp)\n    omega_pattern = m * Omega_p\n\n    # Lindblad resonance locations\n    # Omega_IL = omega_pattern / (m - 1) is unstable for m=1, but m=2 here.\n    Omega_IL = omega_pattern / (m - 1)\n    r_IL = Omega_IL**(-2.0/3.0)\n\n    Omega_OL = omega_pattern / (m + 1)\n    r_OL = Omega_OL**(-2.0/3.0)\n\n    def ode_system(r, y, is_outer_branch):\n        \"\"\"\n        Defines the system of ODEs for flux and deposited angular momentum.\n        y[0] = F_J (Angular momentum flux)\n        y[1] = Delta J_dep (Deposited angular momentum)\n        \"\"\"\n        F_J = y[0]\n        \n        # If viscosity is zero, there's no damping.\n        if alpha == 0.0:\n            return [0.0, 0.0]\n\n        Om_r = Omega(r)\n        cs_r = cs(r)\n        nu_r = nu(r)\n\n        # Wavenumber squared\n        doppler_shifted_freq = omega_pattern - m * Om_r\n        k_sq = (doppler_shifted_freq**2 - Om_r**2) / cs_r**2\n\n        # Propagation condition\n        if k_sq = 0:\n            return [0.0, 0.0]\n\n        # Group velocity\n        # k is chosen with a sign convention for physical propagation direction,\n        # but the final ODE form does not depend on the sign of k.\n        # cg = cs_r**2 * k / doppler_shifted_freq\n        \n        # RHS of the ODE for F_J: dF_J/dr = - (2 * nu * k^2 / cg) * F_J\n        # The term (k^2 / cg) can be simplified to avoid taking sqrt of k^2:\n        # k^2 / cg = k^2 / (cs^2 * k / (omega - m*Omega))\n        # This requires care with k's sign.\n        # Alternatively, rate = (2 * nu * k^2) / cg\n        # Here we use the simplified form derived in the solution text\n        # dF_J/dr =  - (2 * nu * k^2 * (omega - m*Omega) / cs^2) * F_J.\n        # This is more numerically robust as it avoids k in the denominator.\n        \n        dF_J_dr_coeff = - (2.0 * nu_r * k_sq * doppler_shifted_freq) / (cs_r**2)\n        dF_J_dr = dF_J_dr_coeff * F_J\n        \n        # d(Delta J)/dr = -dF_J/dr\n        dDelta_J_dr = -dF_J_dr\n\n        return [dF_J_dr, dDelta_J_dr]\n\n    # --- Inner Branch Simulation ---\n    r0_in = r_IL - epsilon\n    rb_in = r_in\n    y0_in = [T_launch_in, 0.0]\n    sol_in = solve_ivp(\n        lambda r, y: ode_system(r, y, is_outer_branch=False),\n        (r0_in, rb_in),\n        y0_in,\n        method='RK45', # Dormand-Prince\n        rtol=1e-13,\n        atol=1e-13,\n    )\n    F_J_final_in = sol_in.y[0, -1]\n    Delta_J_dep_in = sol_in.y[1, -1]\n    \n    balance_check_in = abs(Delta_J_dep_in - (T_launch_in - F_J_final_in))  tol\n\n    # --- Outer Branch Simulation ---\n    r0_out = r_OL + epsilon\n    rb_out = r_out\n    y0_out = [T_launch_out, 0.0]\n    sol_out = solve_ivp(\n        lambda r, y: ode_system(r, y, is_outer_branch=True),\n        (r0_out, rb_out),\n        y0_out,\n        method='RK45', # Dormand-Prince\n        rtol=1e-13,\n        atol=1e-13,\n    )\n    F_J_final_out = sol_out.y[0, -1]\n    Delta_J_dep_out = sol_out.y[1, -1]\n    \n    balance_check_out = abs(Delta_J_dep_out - (T_launch_out - F_J_final_out))  tol\n\n    return balance_check_in and balance_check_out\n\nsolve()\n```", "id": "3520550"}]}