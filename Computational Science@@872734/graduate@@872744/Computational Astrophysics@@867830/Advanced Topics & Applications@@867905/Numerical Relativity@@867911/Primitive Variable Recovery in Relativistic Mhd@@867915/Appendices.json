{"hands_on_practices": [{"introduction": "Before implementing any numerical scheme, it is crucial to understand the physical constraints of the underlying model. This first practice guides you through a foundational derivation of the relativistic sound speed, $c_s$. By performing this analysis [@problem_id:3530516], you will establish from first principles the causality condition for a $\\Gamma$-law equation of state, revealing the allowed range for the adiabatic index $\\Gamma$ and ensuring your physical model is consistent with special relativity.", "problem": "In special-relativistic magnetohydrodynamics (RMHD), conservative-to-primitive variable recovery requires an explicit expression for the adiabatic sound speed to evaluate characteristic speeds and ensure causal bounds during root finding. Consider a perfect fluid with a constant adiabatic index described by a $\\Gamma$-law equation of state (EOS), where $p=(\\Gamma-1)\\rho\\epsilon$, with rest-mass density $\\rho$, pressure $p$, and specific internal energy $\\epsilon$. Let the total energy density in the fluid rest frame be $e=\\rho(1+\\epsilon)$ and the specific enthalpy be $h=1+\\epsilon+p/\\rho$. Assume adiabatic perturbations, with the adiabatic sound speed defined by $c_{s}^{2}=(\\partial p/\\partial e)_{s}$ at fixed specific entropy $s$. Work in units where the speed of light $c$ is set to $1$.\n\nStarting only from conservation principles and standard thermodynamics for a perfect relativistic fluid, derive a closed-form expression for $c_{s}^{2}$ in terms of $\\Gamma$, $\\rho$, $p$, and $h$. Then, explain from first principles why causality in RMHD requires $0\\le c_{s}^{2}1$ and determine the implication this has for $\\Gamma$ if the EOS is to remain causal for all thermodynamic states accessible to the $\\Gamma$-law fluid.\n\nYour final answer must be the analytic expression you derive for $c_{s}^{2}$, written in simplest closed form. No units are required for the final answer, since $c=1$ is assumed. Do not include the explanatory discussion about causality in the final answer; include it only in your derivation.", "solution": "The problem requires the derivation of the adiabatic sound speed squared, $c_s^2$, for a perfect relativistic fluid with a $\\Gamma$-law equation of state, and an analysis of the constraints on the adiabatic index $\\Gamma$ imposed by causality.\n\nFirst, we validate the problem statement.\nStep 1: Extract Givens.\n- Fluid: Perfect fluid with a constant adiabatic index $\\Gamma$.\n- Equation of State (EOS): $p = (\\Gamma-1)\\rho\\epsilon$, where $\\rho$ is rest-mass density, $p$ is pressure, and $\\epsilon$ is specific internal energy.\n- Total energy density in the fluid rest frame: $e = \\rho(1+\\epsilon)$.\n- Specific enthalpy: $h = 1+\\epsilon+p/\\rho$.\n- Adiabatic sound speed squared: $c_{s}^{2}=(\\partial p/\\partial e)_{s}$ at constant specific entropy $s$.\n- Units: Speed of light $c=1$.\n- Task 1: Derive a closed-form expression for $c_{s}^{2}$ in terms of $\\Gamma$, $\\rho$, $p$, and $h$.\n- Task 2: Explain why causality requires $0 \\le c_s^2  1$.\n- Task 3: Determine the implication for $\\Gamma$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, using standard definitions and models from relativistic fluid dynamics. It is well-posed, objective, and self-contained, providing all necessary information to perform the derivation and analysis based on fundamental thermodynamic principles. The setup is a standard theoretical framework in computational astrophysics. No flaws are identified.\n\nStep 3: Verdict and Action.\nThe problem is valid. We proceed with the solution.\n\nThe derivation begins with the first law of thermodynamics for a fluid element in its rest frame, expressed in terms of specific quantities (per unit rest mass):\n$$d\\epsilon = Tds - p d\\left(\\frac{1}{\\rho}\\right) = Tds + \\frac{p}{\\rho^2}d\\rho$$\nwhere $T$ is the temperature and $s$ is the specific entropy.\n\nThe specific enthalpy is defined as $h = 1 + \\epsilon + p/\\rho$. Its differential is:\n$$dh = d\\epsilon + d\\left(\\frac{p}{\\rho}\\right) = d\\epsilon + \\frac{1}{\\rho}dp - \\frac{p}{\\rho^2}d\\rho$$\nSubstituting the expression for $d\\epsilon$ from the first law, we obtain a fundamental thermodynamic relation:\n$$dh = \\left(Tds + \\frac{p}{\\rho^2}d\\rho\\right) + \\frac{1}{\\rho}dp - \\frac{p}{\\rho^2}d\\rho = Tds + \\frac{dp}{\\rho}$$\nFor an adiabatic process, the specific entropy is constant, so $ds=0$. The relation simplifies to:\n$$dp = \\rho dh \\quad (\\text{for } ds=0)$$\nThis equation connects the change in pressure to the change in specific enthalpy during an adiabatic transformation.\n\nThe sound speed squared is defined as $c_s^2 = (\\partial p / \\partial e)_s$. To evaluate this, we need to express the total energy density $e$ in terms of variables we can relate to $p$. Using the EOS $p=(\\Gamma-1)\\rho\\epsilon$, we can write $\\rho\\epsilon = p/(\\Gamma-1)$. The total energy density $e = \\rho(1+\\epsilon) = \\rho+\\rho\\epsilon$ becomes:\n$$e = \\rho + \\frac{p}{\\Gamma-1}$$\nThe differential of $e$ is:\n$$de = d\\rho + \\frac{1}{\\Gamma-1}dp$$\nTo proceed, we need a relationship between $d\\rho$ and $dp$ for an adiabatic process. We can establish this using the specific enthalpy $h$. First, express $h$ in terms of $p$ and $\\rho$ using the EOS:\n$$h = 1 + \\epsilon + \\frac{p}{\\rho} = 1 + \\frac{p}{(\\Gamma-1)\\rho} + \\frac{p}{\\rho} = 1 + \\frac{p}{\\rho}\\left(\\frac{1}{\\Gamma-1} + 1\\right) = 1 + \\frac{\\Gamma p}{(\\Gamma-1)\\rho}$$\nRearranging gives $\\rho h = \\rho + \\frac{\\Gamma p}{\\Gamma-1}$. Differentiating this expression yields:\n$$d(\\rho h) = h d\\rho + \\rho dh = d\\rho + \\frac{\\Gamma}{\\Gamma-1}dp$$\nFor an adiabatic process, we substitute $dp = \\rho dh$:\n$$h d\\rho + dp = d\\rho + \\frac{\\Gamma}{\\Gamma-1}dp$$\nCollecting terms with $d\\rho$ and $dp$:\n$$(h-1)d\\rho = \\left(\\frac{\\Gamma}{\\Gamma-1} - 1\\right)dp = \\left(\\frac{\\Gamma - (\\Gamma-1)}{\\Gamma-1}\\right)dp = \\frac{1}{\\Gamma-1}dp$$\nNow we can substitute this expression for $d\\rho$ into the differential for $e$:\n$$de = \\frac{1}{(h-1)(\\Gamma-1)}dp + \\frac{1}{\\Gamma-1}dp = \\frac{dp}{\\Gamma-1}\\left(\\frac{1}{h-1} + 1\\right) = \\frac{dp}{\\Gamma-1}\\left(\\frac{1+h-1}{h-1}\\right) = \\frac{h\\,dp}{(\\Gamma-1)(h-1)}$$\nThe adiabatic sound speed squared is the ratio $dp/de$ for this process:\n$$c_s^2 = \\frac{dp}{de} = \\frac{(\\Gamma-1)(h-1)}{h}$$\nTo express this in the requested terms ($\\Gamma, \\rho, p, h$), we use the relation we found connecting $h, p, \\rho$:\n$$h-1 = \\frac{\\Gamma p}{(\\Gamma-1)\\rho}$$\nSubstituting this into our expression for $c_s^2$:\n$$c_s^2 = \\frac{(\\Gamma-1)}{h} (h-1) = \\frac{(\\Gamma-1)}{h} \\left(\\frac{\\Gamma p}{(\\Gamma-1)\\rho}\\right) = \\frac{\\Gamma p}{\\rho h}$$\nThis is the required closed-form expression.\n\nNext, we address the causality requirement. The principle of causality in special relativity dictates that no information can be transmitted faster than the speed of light, $c$. Since we work in units where $c=1$, any signal speed, including the sound speed $c_s$, must satisfy $c_s \\le 1$. Squaring this gives $c_s^2 \\le 1$. The problem specifies the condition $0 \\le c_s^2  1$.\nThe lower bound, $c_s^2 \\ge 0$, is a condition for thermodynamic stability. If $c_s^2  0$, then $(\\partial p/\\partial e)_s  0$. This would mean that a compression (increase in $e$) leads to a decrease in pressure, causing the fluid to be unstable to collapse. Any physical fluid must be stable, so $c_s^2 \\ge 0$. From the form $c_s^2 = (\\Gamma-1)(1-1/h)$, and knowing that for a physical fluid $p \\ge 0$ and $\\epsilon \\ge 0$ implies $h = 1+\\epsilon+p/\\rho \\ge 1$, the term $(1-1/h)$ is always non-negative. Thus, stability requires $\\Gamma-1 \\ge 0$, or $\\Gamma \\ge 1$.\n\nThe upper bound, $c_s^2  1$, is the causality condition. To ensure the EOS is causal for all accessible thermodynamic states, this inequality must hold for all possible values of the specific enthalpy $h$. As established, $h \\ge 1$. The \"cold\" limit is $h \\to 1$ (where $p, \\epsilon \\to 0$), and the ultra-relativistic limit is $h \\to \\infty$.\nLet's analyze the expression $c_s^2 = (\\Gamma-1)(1-1/h)$ as a function of $h$. For a stable fluid ($\\Gamma  1$), the derivative with respect to $h$ is $d(c_s^2)/dh = (\\Gamma-1)/h^2  0$. Therefore, $c_s^2$ is a monotonically increasing function of $h$. Its maximum value is approached in the ultra-relativistic limit as $h \\to \\infty$:\n$$\\lim_{h\\to\\infty} c_s^2 = \\lim_{h\\to\\infty} (\\Gamma-1)\\left(1 - \\frac{1}{h}\\right) = \\Gamma-1$$\nFor the causality condition $c_s^2 \\le 1$ to hold for all possible states, this limiting value must be less than or equal to $1$:\n$$\\Gamma-1 \\le 1 \\implies \\Gamma \\le 2$$\nIf $\\Gamma  2$, there would exist a sufficiently large enthalpy (a sufficiently hot or dense state) for which $c_s^2  1$, violating causality.\nIf $\\Gamma \\le 2$, then for any finite $h$, $c_s^2 = (\\Gamma-1)(1-1/h) \\le (2-1)(1-1/h) = 1-1/h  1$, satisfying the strict inequality posed in the problem for all physically realizable states (finite $h$).\nCombining the stability requirement ($\\Gamma \\ge 1$) and the causality requirement ($\\Gamma \\le 2$), the implication for the adiabatic index is that it must lie in the range $1 \\le \\Gamma \\le 2$.", "answer": "$$\\boxed{\\frac{\\Gamma p}{\\rho h}}$$", "id": "3530516"}, {"introduction": "A correct physical model is not enough; its numerical implementation must be robust, especially in the extreme conditions of astrophysical flows. This exercise [@problem_id:3530442] focuses on the ultra-relativistic limit to demonstrate a common pitfall known as catastrophic cancellation, where the subtraction of two large numbers leads to a loss of precision. By analyzing the asymptotic scaling of the conserved variables, you will appreciate the necessity of using well-conditioned, rescaled variables to maintain numerical accuracy.", "problem": "In special relativistic magnetohydrodynamics (RMHD) on flat spacetime with metric signature $(-,+,+,+)$ and in units $c=1$ and $4\\pi=1$, consider a uniform flow whose three-velocity $\\vec{v}$ is strictly parallel to a uniform magnetic field $\\vec{B}$, so that $\\vec{v} = v\\,\\hat{n}$ and $\\vec{B} = B\\,\\hat{n}$ for a fixed unit vector $\\hat{n}$ and speed $0 \\le v  1$. The fluid has rest-mass density $\\rho$, pressure $p$, specific enthalpy $h$, and enthalpy density $w \\equiv \\rho h$. The Lorentz factor is $\\gamma \\equiv (1-v^{2})^{-1/2}$. The ideal RMHD magnetic field four-vector is defined by $b^{0} \\equiv \\gamma\\,\\vec{v}\\cdot\\vec{B}$ and $b^{i} \\equiv B^{i}/\\gamma + \\gamma\\,(\\vec{v}\\cdot\\vec{B})\\,v^{i}$, with invariant $b^{2} \\equiv b^{\\mu}b_{\\mu} = B^{2}/\\gamma^{2} + (\\vec{v}\\cdot\\vec{B})^{2}$. The laboratory-frame conserved variables in the Valencia formulation are\n- $D \\equiv \\rho \\gamma$,\n- $S_{i} \\equiv (w+b^{2})\\,\\gamma^{2}\\,v_{i} - b^{0} b_{i}$,\n- $\\tau \\equiv T^{00} - D$, where $T^{\\mu\\nu} = (w+b^{2})\\,u^{\\mu}u^{\\nu} + (p + b^{2}/2)\\,g^{\\mu\\nu} - b^{\\mu} b^{\\nu}$ and $u^{\\mu} = \\gamma(1,v^{i})$.\n\nDefine the auxiliary quantities $W \\equiv w\\,\\gamma^{2}$ and $Q \\equiv W + b^{2}$, and the magnetization parameter $\\sigma \\equiv b^{2}/W$. You will analyze the ultra-relativistic regime $h\\gamma \\gg 1$ while keeping $\\sigma$ finite (order unity). Work only with the aligned case $\\vec{v}\\parallel\\vec{B}$.\n\nStarting exclusively from the above definitions and identities, do the following:\n\n1. Derive expressions for $S^{2} \\equiv S_{i}S^{i}$ and $\\tau$ in terms of $W$, $b^{2}$, $B^{2}$, $v$, $\\gamma$, $p$, and $D$ for the aligned case. Simplify $S^{2}$ as far as possible by exploiting exact cancellations that occur when $\\vec{v}\\parallel\\vec{B}$. Comment on the scaling of the individually large pieces that enter $S_{i}$ and $\\tau$, and identify where numerical cancellation can occur for $h\\gamma \\gg 1$.\n\n2. Using $W$ and $Q$ as primary scales, propose rescaled, dimensionless combinations that avoid loss of significance when $h\\gamma \\gg 1$, and justify why these are well-conditioned. In particular, justify the use of $S^{2}/Q^{2}$ and $\\tau/W$ in the aligned case.\n\n3. In the asymptotic regime $h\\gamma \\gg 1$ with fixed finite $\\sigma$, evaluate the leading-order limits of $S^{2}/Q^{2}$ and $\\tau/W$ by discarding terms that vanish as $h\\gamma \\to \\infty$. Express your final result solely in terms of $v$ and $\\sigma$.\n\nAnswer specification:\n- Provide your final answer as a single ordered pair containing the two expressions, arranged as a row matrix $\\bigl(S^{2}/Q^{2},\\,\\tau/W\\bigr)$.\n- No numerical evaluation or rounding is required; give exact, closed-form analytic expressions with no units.", "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-consistent. The definitions and scenario are standard in the field of computational astrophysics and special relativistic magnetohydrodynamics. I will proceed with the solution.\n\nThe analysis is performed for a uniform flow where the three-velocity $\\vec{v}$ is parallel to the magnetic field $\\vec{B}$. They are given by $\\vec{v} = v\\,\\hat{n}$ and $\\vec{B} = B\\,\\hat{n}$, where $\\hat{n}$ is a unit vector. The metric signature is $(-,+,+,+)$ and units are $c=1$, $4\\pi=1$.\n\nFirst, we calculate the components of the magnetic field four-vector $b^{\\mu}$ and its invariant magnitude $b^2$ for this aligned case.\nThe scalar product is $\\vec{v}\\cdot\\vec{B} = vB$. The magnitude squared of the magnetic field is $B^2 = \\vec{B}\\cdot\\vec{B}$.\nThe time component of $b^{\\mu}$ is $b^0 = \\gamma(\\vec{v}\\cdot\\vec{B}) = \\gamma v B$.\nThe spatial components are $b^i = B^i/\\gamma + \\gamma(\\vec{v}\\cdot\\vec{B})v^i = (B\\hat{n}^i)/\\gamma + \\gamma(vB)(v\\hat{n}^i) = (B/\\gamma + \\gamma v^2 B)\\hat{n}^i$.\nUsing the identity $1/\\gamma+\\gamma v^2 = \\sqrt{1-v^2} + v^2/\\sqrt{1-v^2} = (1-v^2+v^2)/\\sqrt{1-v^2} = 1/\\sqrt{1-v^2} = \\gamma$, we simplify $b^i$ to $b^i = B\\gamma\\hat{n}^i$.\nThe invariant $b^2$ is then calculated as $b^2 = b^\\mu b_\\mu = -(b^0)^2 + b_i b^i = -(\\gamma v B)^2 + (B\\gamma\\hat{n}_i)(B\\gamma\\hat{n}^i) = -B^2\\gamma^2 v^2 + B^2\\gamma^2 = B^2\\gamma^2(1-v^2) = B^2\\gamma^2(1/\\gamma^2) = B^2$.\nSo, for the aligned case, the invariant $b^2$ is simply the laboratory-frame magnetic field energy density, $B^2$.\n\n**Part 1: Derivation of $S^2$ and $\\tau$ and analysis of numerical cancellation.**\n\nWe derive an expression for the conserved momentum density vector $S_i$.\n$S_i \\equiv (w+b^2)\\gamma^2 v_i - b^0 b_i$.\nSubstituting the expressions for the aligned case ($v_i = v\\hat{n}_i$, $b^2=B^2$, $b^0=\\gamma v B$, $b_i=\\gamma B \\hat{n}_i$):\n$$S_i = (w+B^2)\\gamma^2 v\\hat{n}_i - (\\gamma v B)(\\gamma B \\hat{n}_i) = (w\\gamma^2 v + B^2\\gamma^2 v - B^2\\gamma^2 v)\\hat{n}_i$$\nA key cancellation occurs between the magnetic part of the total momentum and the Maxwell stress contribution. The terms $B^2\\gamma^2 v\\hat{n}_i$ and $-B^2\\gamma^2 v\\hat{n}_i$ are individually large in the ultra-relativistic limit ($\\gamma\\gg 1$) but cancel exactly. This is a source of catastrophic cancellation in numerical computations if not handled carefully.\nThe simplified expression for $S_i$ is $S_i = w\\gamma^2 v\\hat{n}_i$.\nUsing the definition $W \\equiv w\\gamma^2$, this becomes $S_i = W v \\hat{n}_i$.\nThe magnitude squared, $S^2 \\equiv S_i S^i$, is then:\n$$S^2 = (W v \\hat{n}_i)(W v \\hat{n}^i) = (Wv)^2 (\\hat{n}_i \\hat{n}^i) = (Wv)^2$$\nsince $\\hat{n}_i \\hat{n}^i=1$ in flat space.\n\nNext, we derive an expression for the conserved energy $\\tau$.\n$\\tau \\equiv T^{00} - D$.\nThe $00$-component of the stress-energy tensor is $T^{00} = (w+b^2)(u^0)^2 + (p+b^2/2)g^{00} - b^0 b^0$.\nWith $u^0=\\gamma$, $g^{00}=-1$, $b^2=B^2$, and $b^0=\\gamma v B$:\n$$T^{00} = (w+B^2)\\gamma^2 + (p+B^2/2)(-1) - (\\gamma v B)^2$$\n$$T^{00} = w\\gamma^2 + B^2\\gamma^2 - p - \\frac{B^2}{2} - \\gamma^2 v^2 B^2$$\n$$T^{00} = w\\gamma^2 - p - \\frac{B^2}{2} + B^2\\gamma^2 (1-v^2) = w\\gamma^2 - p - \\frac{B^2}{2} + B^2 = w\\gamma^2 - p + \\frac{B^2}{2}$$\nIn this calculation of $T^{00}$, a significant cancellation also occurs. The term $(w+b^2)(u^0)^2 = (w+B^2)\\gamma^2$ and the term $-(b^0)^2 = -B^2\\gamma^2 v^2$ are both large, scaling with $\\gamma^2$. Their combination simplifies to $w\\gamma^2 + B^2$. Without this analytical simplification, numerical evaluation would involve subtracting large numbers.\nNow, we find $\\tau$:\n$$\\tau = T^{00} - D = \\left(w\\gamma^2 - p + \\frac{B^2}{2}\\right) - \\rho\\gamma$$\nUsing the definitions $W=w\\gamma^2$ and $D=\\rho\\gamma$, and noting $B^2=b^2$ for this case:\n$$\\tau = W - p + \\frac{b^2}{2} - D$$\n\n**Part 2: Justification for rescaled variables.**\n\nIn the ultra-relativistic regime $h\\gamma \\gg 1$, with finite magnetization $\\sigma=b^2/W$, both $W$ and $b^2$ can be very large. Using ratios of quantities that scale similarly can improve numerical stability. The primary scales are given as $W$ and $Q \\equiv W+b^2 = W(1+\\sigma)$.\n\nThe variable $S^2/Q^2$ is proposed. Using our derived expression $S^2=(Wv)^2$ and the definition of $Q$:\n$$\\frac{S^2}{Q^2} = \\frac{(Wv)^2}{(W+b^2)^2} = \\frac{W^2 v^2}{W^2(1+b^2/W)^2} = \\frac{v^2}{(1+\\sigma)^2}$$\nBoth $S^2$ and $Q^2$ scale as $W^2$. Their ratio is independent of the large scale $W$ and is expressed in terms of the well-behaved velocity $v$ and finite magnetization $\\sigma$. This makes it a well-conditioned quantity, of order unity for non-zero $v$.\n\nThe variable $\\tau/W$ is proposed. Using our expression for $\\tau$:\n$$\\frac{\\tau}{W} = \\frac{W - p + b^2/2 - D}{W} = 1 - \\frac{p}{W} + \\frac{b^2}{2W} - \\frac{D}{W}$$\nSubstituting $\\sigma=b^2/W$ and $D/W = (\\rho\\gamma)/(w\\gamma^2) = (\\rho\\gamma)/(\\rho h \\gamma^2) = 1/(h\\gamma)$:\n$$\\frac{\\tau}{W} = 1 - \\frac{p}{W} + \\frac{\\sigma}{2} - \\frac{1}{h\\gamma}$$\nBoth $\\tau$ and $W$ are dominated by the large energy scales. Their ratio normalizes these scales, yielding a quantity of order unity, since $\\sigma$ is finite and the terms $p/W$ and $D/W$ are expected to be small in the ultra-relativistic limit. This avoids representing a physical state using a single large number $\\tau$, which might have been computed from the difference of other large numbers.\n\n**Part 3: Asymptotic limits for $h\\gamma \\to \\infty$.**\n\nWe evaluate the leading-order limits of the rescaled quantities in the regime $h\\gamma \\to \\infty$ with fixed finite $\\sigma$.\n\nFor $S^2/Q^2$:\nThe expression $\\frac{v^2}{(1+\\sigma)^2}$ is exact and does not depend on $h$ or $\\gamma$ directly. Therefore, its limit is simply the expression itself.\n$$\\lim_{h\\gamma \\to \\infty} \\frac{S^2}{Q^2} = \\frac{v^2}{(1+\\sigma)^2}$$\n\nFor $\\tau/W$:\nWe analyze the expression $\\frac{\\tau}{W} = 1 + \\frac{\\sigma}{2} - \\frac{p}{W} - \\frac{D}{W}$.\nWe must evaluate the limits of the last two terms.\nThe term $D/W = 1/(h\\gamma)$. By definition of the regime, $h\\gamma \\to \\infty$, so this term vanishes:\n$$\\lim_{h\\gamma \\to \\infty} \\frac{D}{W} = 0$$\nThe term $p/W = p/(w\\gamma^2) = p/(\\rho h \\gamma^2)$. We can write this as $\\frac{p}{\\rho h} \\frac{1}{\\gamma^2}$. From the definition of specific enthalpy $h=1+\\epsilon+p/\\rho$ (where $e$ is specific internal energy), we know $p/\\rho  h$, so the ratio $p/(\\rho h)$ is bounded between $0$ and $1$. The term \"ultra-relativistic regime\" in this context implies that the Lorentz factor is large, $\\gamma \\gg 1$. Under this standard interpretation, the term $p/W$ vanishes as $\\gamma \\to \\infty$.\n$$\\lim_{h\\gamma \\to \\infty} \\frac{p}{W} = 0$$\nThus, the leading-order limit of $\\tau/W$ is:\n$$\\lim_{h\\gamma \\to \\infty} \\frac{\\tau}{W} = 1 + \\frac{\\sigma}{2} - 0 - 0 = 1 + \\frac{\\sigma}{2}$$\n\nThe final result is the ordered pair of these two limiting expressions.\nThe first expression is $\\frac{v^2}{(1+\\sigma)^2}$.\nThe second expression is $1 + \\frac{\\sigma}{2}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{v^2}{(1+\\sigma)^2}  1 + \\frac{\\sigma}{2}\n\\end{pmatrix}\n}\n$$", "id": "3530442"}, {"introduction": "This final practice integrates the physical and numerical insights from the previous exercises into a complete, hands-on coding project. You are tasked with building a robust, two-dimensional Newton-Raphson solver to perform the conservative-to-primitive variable inversion for a specific physical scenario [@problem_id:3530471]. Implementing the algorithm, complete with an error estimator and a backtracking line search, solidifies your understanding of how to translate theoretical RMHD into a functional and reliable computational tool.", "problem": "You are tasked with designing and implementing an error estimator and iterative refinement procedure for primitive variable recovery in special relativistic ideal magnetohydrodynamics (MHD), restricted to flows where the velocity and magnetic field are everywhere perpendicular. All computations must be carried out in dimensionless units with the speed of light equal to $1$. The system is considered in flat spacetime with the Minkowski metric $\\eta^{\\mu\\nu} = \\mathrm{diag}(-1,1,1,1)$.\n\nBegin from the following foundational definitions that are standard in special relativistic ideal MHD:\n- The four-velocity is $u^{\\mu} = \\gamma (1, \\mathbf{v})$, where $\\gamma = 1/\\sqrt{1 - v^2}$ is the Lorentz factor and $\\mathbf{v}$ is the three-velocity with $v^2 = \\mathbf{v}\\cdot\\mathbf{v}$.\n- The specific enthalpy is $h = 1 + \\epsilon + p/\\rho$, where $\\rho$ is the rest-mass density, $p$ is the thermal pressure, and $\\epsilon$ is the specific internal energy. For a $\\Gamma$-law (polytropic) equation of state, $\\epsilon = p/[(\\Gamma - 1)\\rho]$, so $h = 1 + \\Gamma p / [(\\Gamma - 1)\\rho]$.\n- The magnetic four-vector is $b^{\\mu}$, which encodes the magnetic field measured in the fluid frame and is related to the laboratory-frame magnetic field $\\mathbf{B}$ and the velocity $\\mathbf{v}$ by the relations $b^0 = \\gamma (\\mathbf{v} \\cdot \\mathbf{B})$, $b^i = \\frac{B^i}{\\gamma} + \\gamma (\\mathbf{v} \\cdot \\mathbf{B}) v^i$, and $b^2 = b^{\\mu}b_{\\mu}$.\n- The total energy-momentum tensor is\n$$\nT^{\\mu\\nu} = (\\rho h + b^2) u^{\\mu} u^{\\nu} + \\left(p + \\frac{1}{2} b^2 \\right) \\eta^{\\mu\\nu} - b^{\\mu} b^{\\nu}.\n$$\n\nDefine the conserved variables in the laboratory frame as follows:\n- The mass density $D = \\rho \\gamma$.\n- The momentum density vector components $S_i = T^{0i}$.\n- The energy density excluding rest mass $\\tau = T^{00} - D$.\n\nUnder the physical restriction $\\mathbf{v} \\cdot \\mathbf{B} = 0$ (velocity strictly perpendicular to magnetic field), derive the mapping from primitive variables $(\\rho, p, \\mathbf{v}, \\mathbf{B})$ to the conserved variables $(D, \\mathbf{S}, \\tau)$ starting from the above foundational definitions. Express the mapping entirely in terms of $\\rho$, $p$, $\\gamma$, $\\mathbf{v}$, and $\\mathbf{B}$. Then, formulate the inverse problem of recovering $(\\rho, p, \\mathbf{v})$ from $(D, \\mathbf{S}, \\tau)$ and $\\mathbf{B}$ under the same perpendicularity constraint.\n\nBuild an error estimator that, given a candidate primitive state, recomputes the conserved variables and measures a normalized Euclidean norm of the difference relative to a target conserved state. Let the estimator be\n$$\nE = \\sqrt{\n\\left(\\frac{D_{\\mathrm{cand}} - D_{\\mathrm{tgt}}}{D_{\\mathrm{tgt}} + \\delta}\\right)^2\n+\n\\left(\\frac{\\|\\mathbf{S}_{\\mathrm{cand}} - \\mathbf{S}_{\\mathrm{tgt}}\\|}{\\|\\mathbf{S}_{\\mathrm{tgt}}\\| + \\delta}\\right)^2\n+\n\\left(\\frac{\\tau_{\\mathrm{cand}} - \\tau_{\\mathrm{tgt}}}{|\\tau_{\\mathrm{tgt}}| + \\delta}\\right)^2\n},\n$$\nwhere $\\delta$ is a small positive number for numerical stabilization.\n\nDesign a two-variable Newton method for the perpendicular case that solves simultaneously for the speed magnitude $v$ and the pressure $p$, while recovering $\\rho$ from $D$ via $\\rho = D/\\gamma$. Use the error estimator $E$ to guide iterative refinement by performing a backtracking line search that enforces monotonic decrease of $E$ and respects the physical constraints $0 \\le v  1$ and $p  0$. Your method must:\n- Use the $\\Gamma$-law equation of state with a fixed $\\Gamma$ provided in the test suite.\n- Compute the Jacobian matrix entries analytically from the residual equations you derive.\n- Halt when the error estimator satisfies $E  10^{-10}$ or when a maximum number of iterations is reached.\n\nTest Suite and Output Specification:\n- All quantities are in dimensionless units (speed of light equal to $1$).\n- Consider four test cases with true primitive variables chosen so that $\\mathbf{v} \\perp \\mathbf{B}$ in each case. For each case, compute the target conserved variables from the true primitives and attempt to recover the primitives starting from an inconsistent initial guess. Use $\\Gamma = 4/3$ in all cases.\n\nTest cases (true primitives and initial guesses):\n1. True: $\\rho = 1.0$, $p = 0.1$, $\\mathbf{v} = (0.2, 0, 0)$, $\\mathbf{B} = (0, 0.5, 0)$. Initial guess: $v_{\\mathrm{init}} = 0.6$, $p_{\\mathrm{init}} = 0.2$.\n2. True: $\\rho = 0.5$, $p = 0.05$, $\\mathbf{v} = (0.95, 0, 0)$, $\\mathbf{B} = (0, 1.0, 0)$. Initial guess: $v_{\\mathrm{init}} = 0.5$, $p_{\\mathrm{init}} = 0.2$.\n3. True: $\\rho = 10^{-3}$, $p = 10^{-3}$, $\\mathbf{v} = (0.3, 0, 0)$, $\\mathbf{B} = (0, 5.0, 0)$. Initial guess: $v_{\\mathrm{init}} = 0.8$, $p_{\\mathrm{init}} = 10^{-2}$.\n4. True: $\\rho = 1.0$, $p = 10^{-6}$, $\\mathbf{v} = (0.5, 0, 0)$, $\\mathbf{B} = (0, 0.1, 0)$. Initial guess: $v_{\\mathrm{init}} = 0.1$, $p_{\\mathrm{init}} = 10^{-3}$.\n\nYour program must, for each test case, compute the final error estimator value $E$ after the iterative refinement and indicate whether convergence was achieved. The final output must be a single line containing a flat list with eight entries in the order $[E_1,\\mathrm{conv}_1,E_2,\\mathrm{conv}_2,E_3,\\mathrm{conv}_3,E_4,\\mathrm{conv}_4]$, where each $E_i$ is a real number (float) and each $\\mathrm{conv}_i$ is a boolean. The line must have entries comma-separated and enclosed in square brackets, with no additional text.", "solution": "The user has provided a well-posed problem in computational relativistic astrophysics concerning the recovery of primitive variables $(\\rho, p, \\mathbf{v})$ from conserved variables $(D, \\mathbf{S}, \\tau)$ in special relativistic ideal magnetohydrodynamics (MHD). The problem is restricted to a simplified case where the fluid three-velocity $\\mathbf{v}$ is everywhere perpendicular to the magnetic field $\\mathbf{B}$, i.e., $\\mathbf{v} \\cdot \\mathbf{B} = 0$. The system is described by a $\\Gamma$-law equation of state. The task is to design and implement a two-variable Newton-Raphson method with a backtracking line search to solve this inverse problem.\n\nThe problem statement is scientifically sound, with definitions and equations consistent with standard literature in the field. The provided test cases are physically plausible and serve as a valid benchmark for the algorithm. Therefore, the problem is valid, and we proceed with the derivation and solution.\n\nFirst, we derive the explicit forms of the conserved variables under the perpendicularity constraint. The magnetic four-vector $b^{\\mu}$ is defined by $b^0 = \\gamma (\\mathbf{v} \\cdot \\mathbf{B})$ and $b^i = B^i/\\gamma + \\gamma (\\mathbf{v} \\cdot \\mathbf{B}) v^i$. The constraint $\\mathbf{v} \\cdot \\mathbf{B} = 0$ simplifies this to $b^0 = 0$ and $b^i = B^i/\\gamma$. The Lorentz-invariant square of the magnetic four-vector is $b^2 = b^{\\mu}b_{\\mu} = \\eta_{\\mu\\nu}b^{\\mu}b^{\\nu} = -(b^0)^2 + \\delta_{ij}b^i b^j = B^2/\\gamma^2$, where $B^2 = \\mathbf{B} \\cdot \\mathbf{B}$ and $\\gamma = (1-v^2)^{-1/2}$ is the Lorentz factor with $v^2 = \\mathbf{v} \\cdot \\mathbf{v}$.\n\nThe energy-momentum tensor for ideal MHD is:\n$$\nT^{\\mu\\nu} = (\\rho h + b^2) u^{\\mu} u^{\\nu} + \\left(p + \\frac{1}{2} b^2 \\right) \\eta^{\\mu\\nu} - b^{\\mu} b^{\\nu}\n$$\nwhere $\\rho$ is the rest-mass density, $p$ is the thermal pressure, and $h$ is the specific enthalpy, given by the $\\Gamma$-law EOS as $h = 1 + \\Gamma p / [(\\Gamma - 1)\\rho]$. The four-velocity is $u^\\mu = \\gamma(1, \\mathbf{v})$.\n\nSubstituting the simplified forms of $b^{\\mu}$ and $b^2$ into $T^{\\mu\\nu}$, we derive the laboratory-frame conserved variables:\n1.  Mass density: $D = \\rho \\gamma$.\n2.  Momentum density vector: $S_i = T^{0i}$.\n    With $u^0=\\gamma$, $u^i=\\gamma v^i$, $b^0=0$, and $\\eta^{0i}=0$, we find:\n    $$\n    S_i = \\left(\\rho h + \\frac{B^2}{\\gamma^2}\\right) u^0 u^i - b^0 b^i = \\left(\\rho h + \\frac{B^2}{\\gamma^2}\\right) \\gamma (\\gamma v^i) = (\\rho h \\gamma^2 + B^2) v^i\n    $$\n    The momentum vector is thus $\\mathbf{S} = (\\rho h \\gamma^2 + B^2)\\mathbf{v}$.\n3.  Energy density (excluding rest-mass): $\\tau = T^{00} - D$.\n    With $\\eta^{00}=-1$:\n    $$\n    T^{00} = \\left(\\rho h + \\frac{B^2}{\\gamma^2}\\right) (u^0)^2 + \\left(p + \\frac{B^2}{2\\gamma^2}\\right) \\eta^{00} - (b^0)^2 = (\\rho h \\gamma^2 + B^2) - \\left(p + \\frac{B^2}{2\\gamma^2}\\right)\n    $$\n    So, $\\tau = \\rho h \\gamma^2 + B^2 - p - \\frac{B^2}{2\\gamma^2} - D$.\n\nFor the inverse problem, we are given the target conserved state $(D_{\\mathrm{tgt}}, \\mathbf{S}_{\\mathrm{tgt}}, \\tau_{\\mathrm{tgt}})$ and the magnetic field $\\mathbf{B}$. We seek the primitive state $(\\rho, p, \\mathbf{v})$. The direction of the velocity vector $\\mathbf{v}$ is aligned with the momentum vector $\\mathbf{S}_{\\mathrm{tgt}}$, leaving its magnitude $v = \\|\\mathbf{v}\\|$ as an unknown. The problem reduces to finding two variables, $v$ and $p$. We can relate the rest-mass density $\\rho$ directly to the known $D_{\\mathrm{tgt}}$ and the unknown $v$ via $\\rho = D_{\\mathrm{tgt}}/\\gamma(v)$.\n\nWe define a system of two nonlinear equations for the two unknowns $(v, p)$ by requiring that the primitive state $(v, p)$ reproduces the target conserved quantities $S_{\\mathrm{tgt}} = \\|\\mathbf{S}_{\\mathrm{tgt}}\\|$ and $\\tau_{\\mathrm{tgt}}$. Let's define the residuals $f_1$ and $f_2$:\n$$\nf_1(v, p) = \\left( D_{\\mathrm{tgt}}\\gamma + \\frac{\\Gamma p \\gamma^2}{\\Gamma - 1} + B^2 \\right) v - S_{\\mathrm{tgt}} = 0\n$$\n$$\nf_2(v, p) = D_{\\mathrm{tgt}}(\\gamma-1) + p\\left(\\frac{\\Gamma \\gamma^2}{\\Gamma-1} - 1\\right) + B^2\\left(1 - \\frac{1}{2\\gamma^2}\\right) - \\tau_{\\mathrm{tgt}} = 0\n$$\nwhere $\\gamma = (1-v^2)^{-1/2}$, and $D_{\\mathrm{tgt}}$, $S_{\\mathrm{tgt}}$, $\\tau_{\\mathrm{tgt}}$, and $B^2$ are known constants.\n\nWe solve this system $\\mathbf{F}(v, p) = [f_1, f_2]^T = \\mathbf{0}$ using the Newton-Raphson method. The iterative update is given by $\\mathbf{J} \\Delta\\mathbf{x} = -\\mathbf{F}$, where $\\mathbf{x} = [v, p]^T$ and $\\mathbf{J}$ is the Jacobian matrix $J_{ij} = \\partial f_i / \\partial x_j$. We must compute the entries of $\\mathbf{J}$ analytically. Using the derivative $\\frac{d\\gamma}{dv} = v\\gamma^3$, we find:\n$$\nJ_{11} = \\frac{\\partial f_1}{\\partial v} = D_{\\mathrm{tgt}}\\gamma^3 + \\frac{\\Gamma p}{\\Gamma - 1}\\gamma^4(1+v^2) + B^2\n$$\n$$\nJ_{12} = \\frac{\\partial f_1}{\\partial p} = \\frac{\\Gamma v \\gamma^2}{\\Gamma - 1}\n$$\n$$\nJ_{21} = \\frac{\\partial f_2}{\\partial v} = v \\left( D_{\\mathrm{tgt}}\\gamma^3 + \\frac{2\\Gamma p \\gamma^4}{\\Gamma - 1} + B^2 \\right)\n$$\n$$\nJ_{22} = \\frac{\\partial f_2}{\\partial p} = \\frac{\\Gamma \\gamma^2}{\\Gamma - 1} - 1\n$$\nAt each iteration $k$, we compute $\\mathbf{F}(\\mathbf{x}_k)$ and $\\mathbf{J}(\\mathbf{x}_k)$ and solve the $2 \\times 2$ linear system for the update step $\\Delta \\mathbf{x}_k$.\n\nTo ensure robustness, we embed the Newton step within a backtracking line search. The new state is proposed as $\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\lambda \\Delta \\mathbf{x}_k$, with $\\lambda$ starting at $1$. We check if the candidate state is physical ($0 \\le v_{k+1}  1$ and $p_{k+1}  0$) and if it reduces the error estimator $E$. The error estimator is defined as:\n$$\nE = \\sqrt{\n\\left(\\frac{S_{\\mathrm{cand}} - S_{\\mathrm{tgt}}}{S_{\\mathrm{tgt}} + \\delta}\\right)^2\n+\n\\left(\\frac{\\tau_{\\mathrm{cand}} - \\tau_{\\mathrm{tgt}}}{|\\tau_{\\mathrm{tgt}}| + \\delta}\\right)^2\n}\n$$\nNote that the term for $D$ is zero because our formulation enforces $D_{\\mathrm{cand}} = D_{\\mathrm{tgt}}$. If the candidate step is not accepted, $\\lambda$ is halved, and the check is repeated. This ensures monotonic convergence towards the solution. The iteration terminates when $E$ falls below a tolerance of $10^{-10}$ or a maximum number of iterations is reached.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for primitive variable recovery.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (rho, p, v_vec, B_vec, v_init, p_init)\n    test_cases = [\n        (1.0, 0.1, np.array([0.2, 0, 0]), np.array([0, 0.5, 0]), 0.6, 0.2),\n        (0.5, 0.05, np.array([0.95, 0, 0]), np.array([0, 1.0, 0]), 0.5, 0.2),\n        (1.0e-3, 1.0e-3, np.array([0.3, 0, 0]), np.array([0, 5.0, 0]), 0.8, 1.0e-2),\n        (1.0, 1.0e-6, np.array([0.5, 0, 0]), np.array([0, 0.1, 0]), 0.1, 1.0e-3),\n    ]\n\n    results = []\n    gamma_eos = 4.0 / 3.0\n\n    for case in test_cases:\n        rho_true, p_true, v_true_vec, B_vec, v_init, p_init = case\n        \n        # 1. Compute target conserved variables from true primitives\n        D_tgt, S_tgt_vec, tau_tgt = _compute_conserved(rho_true, p_true, v_true_vec, B_vec, gamma_eos)\n        \n        # 2. Perform primitive variable recovery\n        final_E, converged = _recover_primitives(\n            D_tgt, S_tgt_vec, tau_tgt, B_vec, gamma_eos, v_init, p_init\n        )\n        results.extend([final_E, converged])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _compute_conserved(rho, p, v_vec, B_vec, gamma_eos):\n    \"\"\"Computes conserved variables from primitives for the perp (v.B=0) case.\"\"\"\n    v_sq = np.dot(v_vec, v_vec)\n    if v_sq >= 1.0:\n        raise ValueError(\"Velocity magnitude must be less than 1.\")\n    lorentz_gamma = 1.0 / np.sqrt(1.0 - v_sq)\n    B_sq = np.dot(B_vec, B_vec)\n    \n    h = 1.0 + gamma_eos * p / ((gamma_eos - 1.0) * rho)\n    \n    # Conserved mass density\n    D = rho * lorentz_gamma\n    \n    # Conserved momentum density\n    S_factor = rho * h * lorentz_gamma**2 + B_sq\n    S_vec = S_factor * v_vec\n    \n    # Total energy density T^00\n    T00 = rho * h * lorentz_gamma**2 + B_sq - p - B_sq / (2.0 * lorentz_gamma**2)\n    \n    # Conserved energy density (excluding rest mass)\n    tau = T00 - D\n    \n    return D, S_vec, tau\n\ndef _recover_primitives(D_tgt, S_tgt_vec, tau_tgt, B_vec, gamma_eos, v_init, p_init):\n    \"\"\"\n    Recovers primitive variables (v, p) using a 2D Newton-Raphson scheme.\n    \"\"\"\n    # Constants\n    MAX_ITER = 50\n    TOL = 1.0e-10\n    DELTA = 1.0e-12\n    MIN_LAMBDA = 1.0e-8\n    \n    # Pre-compute target magnitudes\n    S_tgt = np.linalg.norm(S_tgt_vec)\n    B_sq = np.dot(B_vec, B_vec)\n    \n    # Initial state\n    v, p = v_init, p_init\n    \n    # Calculate initial error\n    current_E = _calculate_error(v, p, D_tgt, S_tgt, tau_tgt, B_sq, gamma_eos, DELTA)\n\n    for _ in range(MAX_ITER):\n        # Check for convergence\n        if current_E  TOL:\n            return current_E, True\n\n        # Calculate residuals and Jacobian\n        F = _calculate_residuals(v, p, D_tgt, S_tgt, tau_tgt, B_sq, gamma_eos)\n        J = _calculate_jacobian(v, p, D_tgt, B_sq, gamma_eos)\n\n        # Solve linear system J * dx = -F for dx = [dv, dp]\n        detJ = J[0, 0] * J[1, 1] - J[0, 1] * J[1, 0]\n        if abs(detJ)  1.0e-100:  # Jacobian is singular or near-singular\n            return current_E, False\n        \n        inv_detJ = 1.0 / detJ\n        dv = inv_detJ * (-F[0] * J[1, 1] + F[1] * J[0, 1])\n        dp = inv_detJ * ( F[0] * J[1, 0] - F[1] * J[0, 0])\n\n        # Backtracking line search\n        Lambda = 1.0\n        step_found = False\n        for _ in range(10):  # Limit backtracking steps\n            v_cand = v + Lambda * dv\n            p_cand = p + Lambda * dp\n\n            # Check physical constraints\n            if not (0.0 = v_cand  1.0 and p_cand > 0.0):\n                Lambda /= 2.0\n                continue\n            \n            # Check for error reduction\n            E_cand = _calculate_error(v_cand, p_cand, D_tgt, S_tgt, tau_tgt, B_sq, gamma_eos, DELTA)\n            if E_cand  current_E:\n                v, p = v_cand, p_cand\n                current_E = E_cand\n                step_found = True\n                break\n            \n            Lambda /= 2.0\n            if Lambda  MIN_LAMBDA:\n                break\n        \n        if not step_found:\n            return current_E, False  # Failed to find a better state\n\n    # Check convergence after max iterations\n    final_E = _calculate_error(v, p, D_tgt, S_tgt, tau_tgt, B_sq, gamma_eos, DELTA)\n    converged = final_E  TOL\n    return final_E, converged\n\ndef _calculate_error(v, p, D_tgt, S_tgt, tau_tgt, B_sq, gamma_eos, delta):\n    \"\"\"Calculates the normalized error estimator E.\"\"\"\n    if not (0.0 = v  1.0 and p > 0.0):\n        return np.inf\n\n    residuals = _calculate_residuals(v, p, D_tgt, S_tgt, tau_tgt, B_sq, gamma_eos)\n    # The D-residual is zero by construction, so we only use S and tau.\n    S_cand = S_tgt + residuals[0]\n    tau_cand = tau_tgt + residuals[1]\n    \n    S_err_norm = (S_cand - S_tgt) / (S_tgt + delta)\n    tau_err_norm = (tau_cand - tau_tgt) / (abs(tau_tgt) + delta)\n\n    return np.sqrt(S_err_norm**2 + tau_err_norm**2)\n\ndef _calculate_residuals(v, p, D_tgt, S_tgt, tau_tgt, B_sq, gamma_eos):\n    \"\"\"Calculates the residual vector F = [f1, f2].\"\"\"\n    v_sq = v**2\n    gamma_sq = 1.0 / (1.0 - v_sq)\n    gamma = np.sqrt(gamma_sq)\n    \n    gamma_eos_m1 = gamma_eos - 1.0\n    \n    # f1: Momentum equation residual\n    f1 = (D_tgt * gamma + gamma_eos * p * gamma_sq / gamma_eos_m1 + B_sq) * v - S_tgt\n    \n    # f2: Energy equation residual\n    f2 = (D_tgt * (gamma - 1.0) + p * (gamma_eos * gamma_sq / gamma_eos_m1 - 1.0)\n          + B_sq * (1.0 - 0.5 / gamma_sq) - tau_tgt)\n          \n    return np.array([f1, f2])\n    \ndef _calculate_jacobian(v, p, D_tgt, B_sq, gamma_eos):\n    \"\"\"Calculates the 2x2 Jacobian matrix J.\"\"\"\n    v_sq = v**2\n    gamma_sq = 1.0 / (1.0 - v_sq)\n    gamma = np.sqrt(gamma_sq)\n    gamma3 = gamma**3\n    gamma4 = gamma**4\n    \n    gamma_eos_m1 = gamma_eos - 1.0\n    \n    J = np.zeros((2, 2))\n    \n    # J[0, 0] = df1/dv\n    J[0, 0] = (D_tgt * gamma3 + gamma_eos * p / gamma_eos_m1 * gamma4 * (1.0 + v_sq) + B_sq)\n    \n    # J[0, 1] = df1/dp\n    J[0, 1] = gamma_eos * v * gamma_sq / gamma_eos_m1\n    \n    # J[1, 0] = df2/dv\n    J[1, 0] = v * (D_tgt * gamma3 + 2.0 * gamma_eos * p / gamma_eos_m1 * gamma4 + B_sq)\n    \n    # J[1, 1] = df2/dp\n    J[1, 1] = gamma_eos * gamma_sq / gamma_eos_m1 - 1.0\n    \n    return J\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3530471"}]}