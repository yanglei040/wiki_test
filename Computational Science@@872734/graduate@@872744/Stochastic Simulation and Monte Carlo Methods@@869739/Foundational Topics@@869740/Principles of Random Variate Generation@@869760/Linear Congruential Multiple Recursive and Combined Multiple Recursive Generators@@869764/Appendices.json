{"hands_on_practices": [{"introduction": "Understanding the period of a Linear Congruential Generator (LCG) is the first step in assessing its suitability. This exercise [@problem_id:3318094] demonstrates a crucial analytical technique for LCGs with a composite modulus $m$. By decomposing the dynamics modulo the prime power factors of $m$ and then reconciling the results using the Chinese Remainder Theorem, you will gain hands-on experience with a powerful method that simplifies the analysis of complex state spaces.", "problem": "Consider the Linear Congruential Generator (LCG) defined by the recurrence $x_{n+1} \\equiv a x_n + c \\pmod{m}$ with parameters $m=45$, $a=8$, and $c=5$. Work in the ring of integers modulo $m$ and reason from first principles about modular arithmetic, prime power decomposition, and the Chinese Remainder Theorem (CRT). Analyze the induced dynamics modulo $9$ and modulo $5$, and then reconcile the dynamics modulo $45$ via the Chinese Remainder Theorem (CRT). Assume an initial seed $x_0$ is chosen such that $x_0 \\not\\equiv 0 \\pmod{5}$ and $x_0 \\not\\equiv 7 \\pmod{9}$, so that the evolution in each component avoids trivial degeneracies. Determine the exact period, as a single integer, of the purely periodic cycle realized by the sequence $\\{x_n\\}$ modulo $45$ under these assumptions.", "solution": "The problem asks for the period of a Linear Congruential Generator (LCG) defined by the recurrence relation $x_{n+1} \\equiv a x_n + c \\pmod{m}$, with parameters $m=45$, $a=8$, and $c=5$. The initial seed $x_0$ is constrained by $x_0 \\not\\equiv 0 \\pmod{5}$ and $x_0 \\not\\equiv 7 \\pmod{9}$.\n\nThe recurrence is explicitly given by:\n$$x_{n+1} \\equiv 8 x_n + 5 \\pmod{45}$$\n\nFirst, we analyze the structure of the generator. An LCG of the form $x_{n+1} \\equiv a x_n + c \\pmod{m}$ defines a permutation on the set of residues modulo $m$, $\\mathbb{Z}_m$, if and only if the multiplier $a$ is coprime to the modulus $m$, i.e., $\\gcd(a, m) = 1$. In our case, $a=8$ and $m=45$. We compute the greatest common divisor: $\\gcd(8, 45) = \\gcd(2^3, 3^2 \\times 5^1) = 1$. Since the condition is met, the function $f(x) = 8x+5$ is a permutation of the states in $\\mathbb{Z}_{45}$. This implies that the state space is partitioned into one or more disjoint cycles. Every sequence $\\{x_n\\}$ starting from any seed $x_0$ is purely periodic, with no pre-period or \"tail\". The problem is to find the length of the cycle, or period, for any sequence initiated with a seed satisfying the given constraints.\n\nTo determine the period of the sequence modulo $45$, we use the Chinese Remainder Theorem (CRT). The modulus $m=45$ can be decomposed into coprime factors $m = 9 \\times 5$. The behavior of the sequence $\\{x_n\\}$ modulo $45$ is uniquely determined by the behavior of two component sequences:\n$1$. $y_n = x_n \\pmod{5}$\n$2$. $z_n = x_n \\pmod{9}$\n\nThe period of the original sequence $\\{x_n\\}$, which we denote as $p$, will be the least common multiple (lcm) of the periods of the component sequences, $p_5$ and $p_9$, respectively.\n$$p = \\text{lcm}(p_5, p_9)$$\n\nLet's analyze each component sequence separately.\n\n**1. Analysis of the sequence modulo 5**\n\nThe recurrence for $y_n = x_n \\pmod{5}$ is obtained by taking the original recurrence modulo $5$:\n$$y_{n+1} \\equiv 8 y_n + 5 \\pmod{5}$$\nSimplifying the coefficients modulo $5$, we have $8 \\equiv 3 \\pmod{5}$ and $5 \\equiv 0 \\pmod{5}$. The recurrence becomes:\n$$y_{n+1} \\equiv 3 y_n \\pmod{5}$$\nThis is a multiplicative congruential generator. The problem specifies that the seed $x_0$ must satisfy $x_0 \\not\\equiv 0 \\pmod{5}$, which means $y_0 \\not\\equiv 0 \\pmod{5}$.\nIf $y_0 \\equiv 0 \\pmod{5}$, the sequence would be $0, 0, 0, \\dots$, a fixed point with period $1$. By excluding this case, we are considering initial states $y_0 \\in \\{1, 2, 3, 4\\}$.\nThe period $p_5$ of this sequence is the smallest positive integer $k$ such that $y_{n+k} \\equiv y_n \\pmod{5}$ for all $n \\ge 0$. Since $y_n \\equiv 3^n y_0 \\pmod{5}$, this is equivalent to finding the smallest $k>0$ such that $3^k y_0 \\equiv y_0 \\pmod{5}$. As $y_0 \\not\\equiv 0 \\pmod{5}$, it is invertible modulo $5$, so we must find the smallest $k>0$ such that $3^k \\equiv 1 \\pmod{5}$. This is the multiplicative order of $3$ in the group $(\\mathbb{Z}/5\\mathbb{Z})^*$.\nLet's compute the powers of $3$ modulo $5$:\n$3^1 \\equiv 3 \\pmod{5}$\n$3^2 \\equiv 9 \\equiv 4 \\pmod{5}$\n$3^3 \\equiv 3 \\times 4 = 12 \\equiv 2 \\pmod{5}$\n$3^4 \\equiv 3 \\times 2 = 6 \\equiv 1 \\pmod{5}$\nThe multiplicative order of $3$ modulo $5$ is $4$. Therefore, the period of the sequence $\\{y_n\\}$ is $p_5 = 4$. This holds for any starting value $y_0 \\not\\equiv 0 \\pmod{5}$.\n\n**2. Analysis of the sequence modulo 9**\n\nThe recurrence for $z_n = x_n \\pmod{9}$ is:\n$$z_{n+1} \\equiv 8 z_n + 5 \\pmod{9}$$\nSimplifying the coefficient $a=8$, we note that $8 \\equiv -1 \\pmod{9}$. The recurrence becomes:\n$$z_{n+1} \\equiv -z_n + 5 \\pmod{9}$$\nThe problem specifies the constraint $x_0 \\not\\equiv 7 \\pmod{9}$, which means $z_0 \\not\\equiv 7 \\pmod{9}$.\nLet's first search for any fixed points of this recurrence. A fixed point $z$ must satisfy $z \\equiv -z + 5 \\pmod{9}$.\n$$2z \\equiv 5 \\pmod{9}$$\nTo solve for $z$, we need to find the multiplicative inverse of $2$ modulo $9$. Since $2 \\times 5 = 10 \\equiv 1 \\pmod{9}$, the inverse of $2$ is $5$.\nMultiplying by $5$:\n$z \\equiv 5 \\times 5 = 25 \\equiv 7 \\pmod{9}$.\nSo, $z=7$ is the unique fixed point of this recurrence. If $z_0 = 7$, the sequence would be $7, 7, 7, \\dots$, having a period of $1$. The constraint $z_0 \\not\\equiv 7 \\pmod{9}$ explicitly prevents the sequence from starting at this fixed point.\nNow let's examine the behavior for any $z_0 \\not\\equiv 7 \\pmod{9}$. We compute the second iterate:\n$z_1 \\equiv -z_0 + 5 \\pmod{9}$\n$z_2 \\equiv -z_1 + 5 \\equiv -(-z_0 + 5) + 5 \\equiv z_0 - 5 + 5 \\equiv z_0 \\pmod{9}$\nSince $z_2 \\equiv z_0 \\pmod{9}$, the period of the sequence must divide $2$. The period can be either $1$ or $2$.\nThe period is $1$ if and only if $z_1 \\equiv z_0$, which corresponds to the fixed point case $z_0 \\equiv 7 \\pmod{9}$. As this case is excluded by the problem's constraints, we must have $z_1 \\not\\equiv z_0$.\nTherefore, for any $z_0 \\not\\equiv 7 \\pmod{9}$, the sequence $\\{z_n\\}$ is of the form $z_0, z_1, z_0, z_1, \\dots$ with $z_0 \\neq z_1$. The period of this sequence is $p_9 = 2$.\n\n**3. Reconciliation via CRT**\n\nWe have found the periods of the component sequences to be $p_5 = 4$ and $p_9 = 2$. The period $p$ of the LCG sequence $\\{x_n\\}$ modulo $45$ is the least common multiple of these component periods:\n$$p = \\text{lcm}(p_5, p_9) = \\text{lcm}(4, 2)$$\nThe least common multiple of $4$ and $2$ is $4$.\n$$p = 4$$\nThus, for any initial seed $x_0$ that satisfies the stated conditions, the sequence generated by the LCG will enter a cycle of period $4$. Since the mapping is a permutation, the sequence is purely periodic, and this period is realized from the very first term.", "answer": "$$\\boxed{4}$$", "id": "3318094"}, {"introduction": "While a long period is necessary, it is not sufficient for a good generator; the geometric structure of its output in multiple dimensions is equally critical. The spectral test provides a rigorous way to quantify this structure, but how does one synthesize results across different dimensions? This practice [@problem_id:3318052] challenges you to derive and apply the \"maximin\" criterion, a fundamental principle for selecting the most robust generator by focusing on its weakest-performing dimension.", "problem": "Consider a multiplicative linear congruential generator (LCG) defined by $x_{n+1} \\equiv a\\,x_n \\pmod{m}$ with prime modulus $m$ and multiplier $a \\in \\{1,2,\\dots,m-1\\}$, and the output sequence $u_n = x_n/m$ for $n \\ge 0$. For a fixed dimension $t \\ge 2$, the set of $t$-tuples $\\{(u_i, u_{i+1}, \\dots, u_{i+t-1}) : i \\ge 0\\}$ is known to lie on a finite collection of families of parallel hyperplanes in $[0,1)^t$. The spectral test evaluates the quality of the lattice structure by quantifying the largest gap between adjacent hyperplanes across all such families in dimension $t$. Equivalently, one can measure the length $v_t(a)$ of the shortest nonzero vector in the dual lattice of the $t$-dimensional lattice generated by the LCG with multiplier $a$. The largest interplane spacing in dimension $t$ is inversely related to $v_t(a)$, so larger $v_t(a)$ indicates smaller maximal gaps and thus better uniformity in dimension $t$.\n\nYou are given two candidate multipliers $a_1$ and $a_2$ for a fixed prime modulus $m$, with the aim of selecting the better LCG based on spectral test scores $v_t(a)$ across a set of dimensions $t \\in \\{2,3,4,5,6\\}$. Your task is to identify a scientifically justified criterion based on $v_t(a)$, motivated from first principles about hyperplane spacing and lattice uniformity, and apply it to the specific case $(m,a_1,a_2) = (2^{31}-1,16807,48271)$ to select the better multiplier.\n\nWhich option below correctly states a scientifically justified criterion based on the spectral test scores $v_t(a)$ over $t \\in \\{2,3,4,5,6\\}$, and correctly applies it to choose between $a_1 = 16807$ and $a_2 = 48271$ for $m=2^{31}-1$?\n\nA. Maximize the worst-case spectral score over the given dimensions: select the multiplier $a$ that maximizes $\\min_{t \\in \\{2,3,4,5,6\\}} v_t(a)$. Under standard published spectral test results for $m=2^{31}-1$, this criterion selects $a=48271$ over $a=16807$.\n\nB. Maximize the average largest interplane spacing across the given dimensions: select the multiplier $a$ that maximizes $\\frac{1}{5}\\sum_{t \\in \\{2,3,4,5,6\\}} \\Delta_t(a)$, where $\\Delta_t(a)$ denotes the largest interplane spacing in dimension $t$. Under this criterion for $m=2^{31}-1$, select $a=16807$.\n\nC. Maximize the best-case spectral score: select the multiplier $a$ that maximizes $\\max_{t \\in \\{2,3,4,5,6\\}} v_t(a)$. Applying this to $m=2^{31}-1$ selects $a=16807$.\n\nD. Ignore higher dimensions and focus on low-dimensional projections: select the multiplier $a$ that maximizes $\\min_{t \\in \\{2,3,4\\}} v_t(a)$, thereby choosing $a=16807$ for $m=2^{31}-1$.", "solution": "The fundamental principle for evaluating the quality of a pseudo-random number generator is its ability to produce sequences of numbers that appear uniformly and independently distributed. For an LCG, the sequence of $t$-tuples of consecutive outputs, $(u_i, u_{i+1}, \\dots, u_{i+t-1})$, does not fill the $t$-dimensional hypercube $[0,1)^t$ uniformly. Instead, all points lie on a lattice structure, which can be visualized as a set of parallel hyperplanes.\n\nA poor generator will have large gaps between these hyperplanes in some dimension $t$, indicating a lack of uniformity that can severely bias the results of a stochastic simulation sensitive to correlations in that dimension. The quality of the generator is therefore determined by the coarseness of its lattice structure.\n\nThe spectral test quantifies this coarseness. The maximal distance between adjacent hyperplanes in dimension $t$, which we can denote as $\\Delta_t(a)$, is inversely related to the length of the shortest non-zero vector, $v_t(a)$, in the corresponding dual lattice. The precise relationship is $\\Delta_t(a) = 1/v_t(a)$. Consequently, to ensure the smallest possible gaps and thus the best uniformity in dimension $t$, one must seek a multiplier $a$ that yields the largest possible value for $v_t(a)$.\n\nA generator is considered useful only if it exhibits good uniformity across *all* dimensions of interest. The quality of a generator is limited by its performance in its worst-performing dimension. An LCG that is excellent in dimensions $t=2, 3, 4$ but exhibits large gaps (a small $v_t(a)$) in dimension $t=5$ is a poor generator overall. This \"weakest link\" principle dictates the evaluation criterion.\n\nFor a given multiplier $a$, we should first identify its worst-case performance across the specified range of dimensions, $t \\in \\{2,3,4,5,6\\}$. The worst-case performance corresponds to the smallest spectral score, $\\min_{t \\in \\{2,3,4,5,6\\}} v_t(a)$. To select the best overall generator from a set of candidates, we should choose the one whose worst-case performance is as good as possible. This leads to the scientifically justified \"maximin\" criterion: select the multiplier $a$ that maximizes the minimum spectral score.\n$$\n\\text{Select } a = \\arg\\max_{a \\in \\{a_1, a_2\\}} \\left( \\min_{t \\in \\{2,3,4,5,6\\}} v_t(a) \\right)\n$$\nTo apply this criterion, we must use the standard published values for the squared spectral test scores, $v_t^2(a)$, for the given multipliers with modulus $m = 2^{31}-1$. These values are readily available in authoritative sources such as D. E. Knuth's \"The Art of Computer Programming, Vol. 2\" and review articles by P. L'Ecuyer. Note that comparing the minimum of $v_t^2(a)$ is equivalent to comparing the minimum of $v_t(a)$.\n\nFor $a_1 = 16807$:\n$v_2^2(a_1) = 282475250$\n$v_3^2(a_1) = 826486$\n$v_4^2(a_1) = 35313$\n$v_5^2(a_1) = 2490$\n$v_6^2(a_1) = 2030$\nThe minimum squared score is $\\min_{t \\in \\{2,\\dots,6\\}} v_t^2(a_1) = 2030$.\n\nFor $a_2 = 48271$:\n$v_2^2(a_2) = 2330192882$\n$v_3^2(a_2) = 932506$\n$v_4^2(a_2) = 31549$\n$v_5^2(a_2) = 11114$\n$v_6^2(a_2) = 5129$\nThe minimum squared score is $\\min_{t \\in \\{2,\\dots,6\\}} v_t^2(a_2) = 5129$.\n\nApplying the maximin criterion: We compare the minimum scores.\n$$\n\\min_{t} v_t^2(a_1) = 2030\n$$\n$$\n\\min_{t} v_t^2(a_2) = 5129\n$$\nSince $5129 > 2030$, we have $\\min_t v_t(a_2) > \\min_t v_t(a_1)$. The maximin criterion selects the multiplier $a_2 = 48271$ as it provides better worst-case performance over the dimensions considered.\n\nNow, we evaluate each option:\n\nA. Maximize the worst-case spectral score over the given dimensions: select the multiplier $a$ that maximizes $\\min_{t \\in \\{2,3,4,5,6\\}} v_t(a)$. Under standard published spectral test results for $m=2^{31}-1$, this criterion selects $a=48271$ over $a=16807$.\nThis option correctly identifies the scientifically justified maximin criterion derived from first principles. It also correctly applies this criterion to the specified multipliers, concluding that $a=48271$ is the better choice. Our calculation confirms this result.\n**Verdict: Correct.**\n\nB. Maximize the average largest interplane spacing across the given dimensions: select the multiplier $a$ that maximizes $\\frac{1}{5}\\sum_{t \\in \\{2,3,4,5,6\\}} \\Delta_t(a)$, where $\\Delta_t(a)$ denotes the largest interplane spacing in dimension $t$. Under this criterion for $m=2^{31}-1$, select $a=16807$.\nThis criterion is scientifically unsound. The largest interplane spacing $\\Delta_t(a)$ is a measure of non-uniformity; a smaller value is better. Therefore, a valid criterion would seek to minimize spacings, not maximize them. Maximizing the average spacing selects for a generator that is, on average, worse. Furthermore, averaging can mask critically poor performance in a single dimension.\n**Verdict: Incorrect.**\n\nC. Maximize the best-case spectral score: select the multiplier $a$ that maximizes $\\max_{t \\in \\{2,3,4,5,6\\}} v_t(a)$. Applying this to $m=2^{31}-1$ selects $a=16807$.\nThis criterion is scientifically unjustified. The overall quality of a generator is limited by its worst dimension (weakest link), not its best. A generator could have an exceptionally high score in one dimension but be unacceptably poor in another. This criterion ignores the most important aspect of multi-dimensional uniformity. Additionally, the application is factually incorrect. Using the published data, $\\max_t v_t^2(a_1) \\approx 2.82 \\times 10^8$ while $\\max_t v_t^2(a_2) \\approx 2.33 \\times 10^9$. This criterion would therefore select $a_2=48271$, not $a_1=16807$.\n**Verdict: Incorrect.**\n\nD. Ignore higher dimensions and focus on low-dimensional projections: select the multiplier $a$ that maximizes $\\min_{t \\in \\{2,3,4\\}} v_t(a)$, thereby choosing $a=16807$ for $m=2^{31}-1$.\nThis criterion is a truncated, and thus scientifically weak, version of the correct maximin criterion. While low-dimensional uniformity is crucial, there is no justification for arbitrarily ignoring available data for higher dimensions ($t=5, 6$), where critical flaws might exist. In fact, the worst-case score for $a_1=16807$ occurs at $t=6$. Ignoring this dimension leads to an incomplete and potentially misleading assessment. While the calculation within the option is correct (for $t \\in \\{2,3,4\\}$, $\\min v_t^2(a_1) = 35313$ and $\\min v_t^2(a_2) = 31549$, so $a_1$ is chosen), the criterion itself is not scientifically robust.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "3318052"}, {"introduction": "The theoretical flaws of a pseudo-random number generator are not merely academic curiosities; they can have dramatic consequences in real-world applications. This exercise [@problem_id:3318033] provides a powerful case study, revealing the infamous correlations present in the low-order bits of LCGs with a power-of-two modulus. By linking this predictable bit-level behavior to a systematic bias in a simple Monte Carlo integration, you will see firsthand why a deep understanding of generator structure is essential for any serious practitioner.", "problem": "Consider a linear congruential generator (LCG), defined as $X_{n+1} \\equiv a X_n + c \\pmod{m}$ with integers $a$, $c$, and $m$, and suppose $m$ is a power of $2$. Let $v_p(\\cdot)$ denote the $p$-adic valuation. Using $p$-adic analysis at $p=2$, justify how the least significant bit (LSB) of $X_n$ evolves in terms of $v_2(a-1)$ and $v_2(m)$, and from that characterization determine the exact cycle length of the LSB for the specific generator with $m=2^{12}$, $a=1+2^{3}$, $c=1$, and an even seed $X_0$. Then, consider the rounding-based Monte Carlo estimator\n$$\n\\hat{I}_N = \\frac{1}{N} \\sum_{n=0}^{N-1} g(U_n),\n$$\nwhere $U_n = X_n / m$ and $g(u) = (-1)^{\\lfloor m u \\rfloor}$, and the target integral\n$$\nI = \\int_{0}^{1} g(u) \\, du.\n$$\nExplain the link between the bit-cycle of the LSB and the behavior of $g(U_n)$, compute $I$ exactly, and obtain the exact bias $\\mathrm{Bias}_N = \\hat{I}_N - I$ for $N=4097$ under the given generator and seed. Report only the final bias as a single closed-form analytic expression. No rounding is required and no units apply to the final bias.", "solution": "The solution proceeds in four parts:\n1. Characterization of the least significant bit (LSB) of the sequence $X_n$.\n2. Establishing the link between the LSB's behavior and the sequence $g(U_n)$.\n3. Exact computation of the target integral $I$.\n4. Exact computation of the bias $\\mathrm{Bias}_N$ for $N=4097$.\n\n**1. LSB Cycle Length**\n\nThe LCG is defined by the recurrence $X_{n+1} \\equiv a X_n + c \\pmod{m}$. The least significant bit (LSB) of $X_n$ corresponds to its parity, i.e., $X_n \\pmod{2}$. Let $x_n = X_n \\pmod{2}$. The recurrence relation for the LSBs is obtained by taking the main recurrence modulo $2$:\n$$\nx_{n+1} \\equiv (a \\pmod{2}) x_n + (c \\pmod{2}) \\pmod{2}\n$$\nThe specific parameters are $m = 2^{12}$, $a = 1 + 2^3 = 9$, and $c=1$.\nWe find the parameters modulo $2$:\n$a \\pmod{2} = 9 \\pmod{2} = 1$\n$c \\pmod{2} = 1 \\pmod{2} = 1$\nSubstituting these into the LSB recurrence gives $x_{n+1} \\equiv (1) x_n + 1 \\pmod{2}$, so $x_{n+1} \\equiv x_n + 1 \\pmod{2}$.\nThis is a simple toggle. The current LSB determines the next one by flipping it. The problem states that the seed $X_0$ is even, which means $x_0 = X_0 \\pmod{2} = 0$.\nThe sequence of LSBs is therefore:\n$x_0 = 0$\n$x_1 = x_0 + 1 \\pmod{2} = 1$\n$x_2 = x_1 + 1 \\pmod{2} = 0$\n$x_3 = x_2 + 1 \\pmod{2} = 1$\nThe sequence of LSBs, $\\{x_n\\}_{n \\ge 0}$, is $0, 1, 0, 1, \\dots$. This sequence is periodic with a cycle length of $2$.\n\nThe problem asks for a justification in terms of $v_2(a-1)$. For an LCG with modulus $m=2^k$ and odd $c$, the period of the $j$-th least significant bit (for $j \\ge 1$) is known to be $2^{\\max(1, j - v_2(a-1))}$. Here, we are interested in the LSB, which corresponds to $j=1$. We have $a-1 = (1+2^3) - 1 = 2^3$, so $v_2(a-1) = v_2(2^3) = 3$. The cycle length of the LSB ($j=1$) is:\n$$\n\\text{Period}_{LSB} = 2^{\\max(1, 1 - v_2(a-1))} = 2^{\\max(1, 1 - 3)} = 2^{\\max(1, -2)} = 2^1 = 2\n$$\nThis confirms our direct calculation. The cycle length of the LSB is exactly $2$.\n\n**2. Link between LSB and $g(U_n)$**\n\nThe function $g(u)$ is defined as $g(u) = (-1)^{\\lfloor m u \\rfloor}$. The sequence of values $g(U_n)$ is obtained by substituting $U_n = X_n / m$:\n$$\ng(U_n) = (-1)^{\\lfloor m (X_n/m) \\rfloor} = (-1)^{\\lfloor X_n \\rfloor}\n$$\nSince each state $X_n$ of the LCG is an integer in the range $[0, m-1]$, we have $\\lfloor X_n \\rfloor = X_n$. Thus, the expression simplifies to:\n$$\ng(U_n) = (-1)^{X_n}\n$$\nThe value of $g(U_n)$ is $1$ if $X_n$ is even and $-1$ if $X_n$ is odd. The parity of $X_n$ is determined by its LSB, $x_n = X_n \\pmod{2}$. Therefore, $g(U_n) = (-1)^{x_n}$.\nAs established in the previous part, the sequence of LSBs $\\{x_n\\}$ for an even seed $X_0$ is $0, 1, 0, 1, \\dots$. The corresponding sequence $\\{g(U_n)\\}$ is:\n$$\n\\{g(U_n)\\}_{n \\ge 0} = \\{(-1)^{x_n}\\}_{n \\ge 0} = \\{(-1)^0, (-1)^1, (-1)^0, (-1)^1, \\dots\\} = \\{1, -1, 1, -1, \\dots\\}\n$$\nThis demonstrates a direct link: the highly predictable, short-period cycle of the LSB translates into a deterministic, non-random sequence of values for $g(U_n)$.\n\n**3. Computation of the Integral $I$**\n\nThe target integral is $I = \\int_{0}^{1} g(u) \\, du = \\int_{0}^{1} (-1)^{\\lfloor m u \\rfloor} \\, du$.\nLet's partition the interval $[0, 1]$ into $m$ subintervals of the form $[k/m, (k+1)/m)$ for $k = 0, 1, \\dots, m-1$.\n$$\nI = \\sum_{k=0}^{m-1} \\int_{k/m}^{(k+1)/m} (-1)^{\\lfloor m u \\rfloor} \\, du\n$$\nFor any $u$ in the subinterval $[k/m, (k+1)/m)$, the term $mu$ is in $[k, k+1)$, so $\\lfloor mu \\rfloor = k$. The integral becomes:\n$$\nI = \\sum_{k=0}^{m-1} \\int_{k/m}^{(k+1)/m} (-1)^k \\, du = \\sum_{k=0}^{m-1} (-1)^k \\left(\\frac{k+1}{m} - \\frac{k}{m}\\right) = \\sum_{k=0}^{m-1} \\frac{(-1)^k}{m}\n$$\n$$\nI = \\frac{1}{m} \\sum_{k=0}^{m-1} (-1)^k\n$$\nThe modulus is $m = 2^{12}$, which is an even number. The sum is an alternating series of $m$ terms:\n$$\n\\sum_{k=0}^{m-1} (-1)^k = \\underbrace{(1 - 1)}_{k=0,1} + \\underbrace{(1 - 1)}_{k=2,3} + \\dots + \\underbrace{(1 - 1)}_{k=m-2,m-1} = 0\n$$\nSince the sum is $0$, the exact value of the integral is:\n$$\nI = \\frac{1}{m} \\cdot 0 = 0\n$$\n\n**4. Computation of the Bias**\n\nThe bias is given by $\\mathrm{Bias}_N = \\hat{I}_N - I$. Since $I=0$, the bias is simply equal to the estimator, $\\mathrm{Bias}_N = \\hat{I}_N$. We need to compute this for $N=4097$.\n$$\n\\hat{I}_{4097} = \\frac{1}{4097} \\sum_{n=0}^{4096} g(U_n)\n$$\nFrom part 2, we know that the sequence $\\{g(U_n)\\}$ is $\\{1, -1, 1, -1, \\dots\\}$. This can be written compactly as $g(U_n) = (-1)^n$ for $n \\ge 0$, because the LSB sequence is $x_n = n \\pmod 2$.\nThe sum has $N=4097$ terms:\n$$\n\\sum_{n=0}^{4096} g(U_n) = \\sum_{n=0}^{4096} (-1)^n = 1 - 1 + 1 - 1 + \\dots - 1 + 1\n$$\nThis is a geometric series with first term $1$, ratio $-1$, and $4097$ terms. Alternatively, we can pair the terms. The sum consists of $4096/2 = 2048$ pairs of $(1-1)$, plus a final term for $n=4096$:\n$$\n\\sum_{n=0}^{4096} (-1)^n = \\left(\\sum_{n=0}^{4095} (-1)^n\\right) + (-1)^{4096} = \\underbrace{(1-1) + \\dots + (1-1)}_{2048 \\text{ pairs}} + 1 = 0 + 1 = 1\n$$\nTherefore, the estimator's value is:\n$$\n\\hat{I}_{4097} = \\frac{1}{4097} \\cdot 1 = \\frac{1}{4097}\n$$\nThe exact bias is:\n$$\n\\mathrm{Bias}_{4097} = \\hat{I}_{4097} - I = \\frac{1}{4097} - 0 = \\frac{1}{4097}\n$$\nThis result highlights a critical failure of the LCG. An ideal random number generator would produce an estimate $\\hat{I}_N$ that converges to the true value $I=0$ as $N \\to \\infty$. Here, due to the extreme correlation in the least significant bits, the estimator is systematically biased.", "answer": "$$\\boxed{\\frac{1}{4097}}$$", "id": "3318033"}]}