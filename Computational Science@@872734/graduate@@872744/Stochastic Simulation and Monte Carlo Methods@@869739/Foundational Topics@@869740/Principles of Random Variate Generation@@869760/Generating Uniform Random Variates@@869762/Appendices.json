{"hands_on_practices": [{"introduction": "Linear Congruential Generators (LCGs) are a cornerstone of historical random number generation due to their speed and simplicity. However, their deterministic nature imposes a rigid geometric structure on the output, a fact famously captured by the spectral test. This exercise provides a direct, hands-on demonstration of this property, showing how successive points from an LCG are not randomly scattered but are confined to a surprisingly small number of parallel hyperplanes [@problem_id:3309974]. By deriving this from first principles and verifying it with a concrete example, you will gain a tangible understanding of this fundamental limitation.", "problem": "Consider a Linear Congruential Generator (LCG), defined by the recurrence $X_{n+1} \\equiv a X_{n} + c \\pmod{m}$, used to generate pseudorandom integers $X_{n} \\in \\{0,1,\\dots,m-1\\}$, and its associated normalized sequence $U_{n} = X_{n}/m$, which is used to approximate independent draws from the uniform distribution on the unit interval. Let $s \\geq 2$ be fixed and form the $s$-dimensional points $\\mathbf{U}_{n} = (U_{n}, U_{n+1}, \\dots, U_{n+s-1}) \\in [0,1)^{s}$.\n\nStarting only from modular arithmetic and the definition of the LCG and normalization, derive the exact count of distinct parallel affine hyperplanes in $\\mathbb{R}^{s}$ (codimension $1$ subsets) of the form $b \\cdot \\mathbf{U}_{n} = t$ that are occupied by the point set $\\{\\mathbf{U}_{n}\\}$ when $c=0$ and $a  m$, where $b = (a, -1, 0, \\dots, 0)$ and $t$ ranges over values determined by the generatorâ€™s arithmetic. Your derivation must justify why these hyperplanes arise and must determine the precise number of distinct $t$ values that occur across all possible seeds $X_{0} \\in \\{0,1,\\dots,m-1\\}$.\n\nThen, set $s=3$ and the LCG parameters to $m = 13$, $a = 5$, and $c = 0$. Using exhaustive enumeration over all $X_{n} \\in \\{0,1,\\dots,12\\}$, verify your theoretical count empirically by determining the set of distinct values taken by $a U_{n} - U_{n+1}$ and counting them. Conclude with the exact number of distinct parallel affine hyperplanes of the form $a U_{n} - U_{n+1} = t$ occupied by the three-dimensional point set $\\{\\mathbf{U}_{n}\\}$ for these parameters. Provide your final answer as a single real-valued number. No rounding is required.", "solution": "The problem statement has been validated and is determined to be a well-posed and scientifically grounded problem in the mathematical analysis of pseudorandom number generators. It is free of any internal contradictions, ambiguities, or factual unsoundness. We may therefore proceed with a formal solution.\n\nThe problem asks for two main results: first, a general derivation for the number of hyperplanes that contain the points generated by a specific type of Linear Congruential Generator (LCG), and second, an empirical verification of this result for a given set of parameters.\n\n**Part 1: General Theoretical Derivation**\n\nWe are given a Linear Congruential Generator defined by the recurrence relation:\n$$X_{n+1} \\equiv a X_{n} + c \\pmod{m}$$\nThe problem specifies the case where the additive constant $c=0$. The recurrence simplifies to:\n$$X_{n+1} \\equiv a X_{n} \\pmod{m}$$\nThe values $X_n$ are integers in the set $\\{0, 1, \\dots, m-1\\}$. From these integers, a sequence of normalized real numbers $U_n$ is generated by $U_n = X_n / m$. These values fall in the interval $[0, 1)$. Subsequently, $s$-dimensional vectors are formed as $\\mathbf{U}_{n} = (U_{n}, U_{n+1}, \\dots, U_{n+s-1})$.\n\nWe are asked to investigate the geometric structure of the set of points $\\{\\mathbf{U}_n\\}$ by considering the affine hyperplanes they occupy. The family of hyperplanes is defined by the equation $b \\cdot \\mathbf{U}_{n} = t$, where the normal vector is given as $b = (a, -1, 0, \\dots, 0)$. The dot product is:\n$$b \\cdot \\mathbf{U}_{n} = a U_n + (-1) U_{n+1} + \\sum_{i=2}^{s-1} 0 \\cdot U_{n+i} = a U_n - U_{n+1}$$\nTherefore, the equation for the hyperplanes is:\n$$a U_n - U_{n+1} = t$$\nOur goal is to find the number of distinct values that $t$ can take as $X_n$ ranges over all possible values $\\{0, 1, \\dots, m-1\\}$.\n\nLet us substitute the definitions of $U_n$ and $U_{n+1}$ in terms of $X_n$ and $X_{n+1}$:\n$$t = a \\frac{X_n}{m} - \\frac{X_{n+1}}{m} = \\frac{a X_n - X_{n+1}}{m}$$\nFrom the LCG recurrence $X_{n+1} \\equiv a X_n \\pmod{m}$, we know that $a X_n - X_{n+1}$ must be an integer multiple of $m$. Let us write this explicitly. The definition of the modulo operator implies that there exists an integer, let's call it $k_n$, such that:\n$$a X_n = k_n m + X_{n+1}$$\nwhere $X_{n+1}$ is the remainder of the division of $a X_n$ by $m$. The integer $k_n$ is the quotient of this division, which can be expressed using the floor function:\n$$k_n = \\left\\lfloor \\frac{a X_n}{m} \\right\\rfloor$$\nRearranging the equation $a X_n = k_n m + X_{n+1}$ gives $a X_n - X_{n+1} = k_n m$.\n\nNow we substitute this back into our expression for $t$:\n$$t = \\frac{k_n m}{m} = k_n$$\nThis is a critical insight: the values $t$ that define the distinct hyperplanes are precisely the integer values $k_n$ generated by the LCG's arithmetic. To find the number of distinct hyperplanes, we must find the number of distinct values taken by $k_n = \\lfloor \\frac{a X_n}{m} \\rfloor$ as $X_n$ spans all possibilities. The problem specifies that we consider all possible seeds $X_0 \\in \\{0, 1, \\dots, m-1\\}$, which implies we must consider all possible states $X_n \\in \\{0, 1, \\dots, m-1\\}$.\n\nLet's analyze the range of values for $k_n$ for $X_n \\in \\{0, 1, \\dots, m-1\\}$.\nThe argument of the floor function is $\\frac{a X_n}{m}$.\nThe minimum value occurs at $X_n=0$:\n$$k_{\\min} = \\left\\lfloor \\frac{a \\cdot 0}{m} \\right\\rfloor = \\lfloor 0 \\rfloor = 0$$\nThe maximum value occurs at $X_n=m-1$:\n$$k_{\\max} = \\left\\lfloor \\frac{a (m-1)}{m} \\right\\rfloor = \\left\\lfloor \\frac{am - a}{m} \\right\\rfloor = \\left\\lfloor a - \\frac{a}{m} \\right\\rfloor$$\nThe problem states that $a$ is an integer and $a  m$. This implies that $0  \\frac{a}{m}  1$.\nTherefore, $a-1  a - \\frac{a}{m}  a$. The floor of this value is:\n$$k_{\\max} = a-1$$\nThe values of $k_n$ are integers ranging from a minimum of $0$ to a maximum of $a-1$. We must also confirm that all integer values between $0$ and $a-1$ are achieved. An integer $j$ is in the set of possible values for $k_n$ if there exists an $X_n \\in \\{0, 1, \\dots, m-1\\}$ such that $\\lfloor \\frac{a X_n}{m} \\rfloor = j$. This is equivalent to the condition $j \\le \\frac{a X_n}{m}  j+1$, or $\\frac{jm}{a} \\le X_n  \\frac{(j+1)m}{a}$. The length of this interval for $X_n$ is $\\frac{m}{a}$. Since $a  m$, the length is greater than $1$, guaranteeing that at least one integer $X_n$ exists in the interval. Thus, all integers $j$ from $0$ to $a-1$ are indeed possible values for $k_n$.\n\nThe set of all possible values for $t$ is $\\{0, 1, \\dots, a-1\\}$. The number of distinct values is $(a-1) - 0 + 1 = a$.\nTherefore, for an LCG with $c=0$ and $am$, the points $\\mathbf{U}_n$ lie on exactly $a$ distinct parallel hyperplanes of the form $aU_n - U_{n+1} = t$.\n\n**Part 2: Empirical Verification**\n\nWe are given the specific parameters $s=3$, $m=13$, $a=5$, and $c=0$. The condition $am$ ($513$) is satisfied.\nBased on our theoretical derivation, the number of distinct hyperplanes should be $a=5$. The hyperplanes should correspond to $t \\in \\{0, 1, 2, 3, 4\\}$.\n\nWe are asked to verify this by exhaustive enumeration. We need to compute the value of $t = a U_n - U_{n+1}$ for all possible values of $X_n \\in \\{0, 1, \\dots, 12\\}$.\nThe LCG is $X_{n+1} \\equiv 5 X_n \\pmod{13}$. The expression for $t$ is $t = \\frac{5 X_n - X_{n+1}}{13}$, where $X_{n+1}$ is the result of the LCG step. Let's compute $X_{n+1}$ and then $t$ for each $X_n$:\n\n- For $X_n=0$: $X_{n+1} = 5 \\cdot 0 \\pmod{13} = 0$. So, $t = \\frac{5(0) - 0}{13} = 0$.\n- For $X_n=1$: $X_{n+1} = 5 \\cdot 1 \\pmod{13} = 5$. So, $t = \\frac{5(1) - 5}{13} = 0$.\n- For $X_n=2$: $X_{n+1} = 5 \\cdot 2 \\pmod{13} = 10$. So, $t = \\frac{5(2) - 10}{13} = 0$.\n- For $X_n=3$: $X_{n+1} = 5 \\cdot 3 \\pmod{13} = 15 \\pmod{13} = 2$. So, $t = \\frac{5(3) - 2}{13} = \\frac{13}{13} = 1$.\n- For $X_n=4$: $X_{n+1} = 5 \\cdot 4 \\pmod{13} = 20 \\pmod{13} = 7$. So, $t = \\frac{5(4) - 7}{13} = \\frac{13}{13} = 1$.\n- For $X_n=5$: $X_{n+1} = 5 \\cdot 5 \\pmod{13} = 25 \\pmod{13} = 12$. So, $t = \\frac{5(5) - 12}{13} = \\frac{13}{13} = 1$.\n- For $X_n=6$: $X_{n+1} = 5 \\cdot 6 \\pmod{13} = 30 \\pmod{13} = 4$. So, $t = \\frac{5(6) - 4}{13} = \\frac{26}{13} = 2$.\n- For $X_n=7$: $X_{n+1} = 5 \\cdot 7 \\pmod{13} = 35 \\pmod{13} = 9$. So, $t = \\frac{5(7) - 9}{13} = \\frac{26}{13} = 2$.\n- For $X_n=8$: $X_{n+1} = 5 \\cdot 8 \\pmod{13} = 40 \\pmod{13} = 1$. So, $t = \\frac{5(8) - 1}{13} = \\frac{39}{13} = 3$.\n- For $X_n=9$: $X_{n+1} = 5 \\cdot 9 \\pmod{13} = 45 \\pmod{13} = 6$. So, $t = \\frac{5(9) - 6}{13} = \\frac{39}{13} = 3$.\n- For $X_n=10$: $X_{n+1} = 5 \\cdot 10 \\pmod{13} = 50 \\pmod{13} = 11$. So, $t = \\frac{5(10) - 11}{13} = \\frac{39}{13} = 3$.\n- For $X_n=11$: $X_{n+1} = 5 \\cdot 11 \\pmod{13} = 55 \\pmod{13} = 3$. So, $t = \\frac{5(11) - 3}{13} = \\frac{52}{13} = 4$.\n- For $X_n=12$: $X_{n+1} = 5 \\cdot 12 \\pmod{13} = 60 \\pmod{13} = 8$. So, $t = \\frac{5(12) - 8}{13} = \\frac{52}{13} = 4$.\n\nThe set of distinct values taken by $t = a U_n - U_{n+1}$ is $\\{0, 1, 2, 3, 4\\}$.\nThe count of these distinct values is $5$. This empirical result perfectly matches the theoretical prediction of $a=5$.\n\n**Conclusion**\n\nThe theoretical derivation shows that for an LCG with $c=0$ and multiplier $a  m$, the points $\\mathbf{U}_n$ are constrained to lie on $a$ parallel hyperplanes. For the specific parameters $m=13$ and $a=5$, the expected number of hyperplanes is $5$. This is confirmed by direct computation over all possible states of the generator. The specified three-dimensional points $\\{\\mathbf{U}_n\\}$ for this LCG are therefore confined to exactly $5$ distinct parallel planes given by $5U_n - U_{n+1} = t$ for $t \\in \\{0, 1, 2, 3, 4\\}$. The number of these planes is $5$.", "answer": "$$\n\\boxed{5}\n$$", "id": "3309974"}, {"introduction": "Once a sequence of pseudorandom integers is generated, it must be mapped to the unit interval to simulate a uniform distribution. This mapping is not a trivial step; a seemingly innocuous choice can have significant consequences for downstream applications. This practice explores the critical difference between generating variates in a right-open interval $[0,1)$ versus a closed interval $[0,1]$, revealing how the possibility of generating the exact value $U=1$ can lead to infinite (and often erroneous) results when using methods like inverse-transform sampling for heavy-tailed distributions [@problem_id:3309936].", "problem": "A pseudorandom number generator (PRNG) produces independent and identically distributed bits. Consider generating floating-point approximations to a Uniform distribution on the unit interval using two integer-to-float mapping schemes based on $b=53$ bits of precision, as typically used to populate the significand of a double-precision floating-point number.\n\n- Scheme A (right-open discretization): Sample $I$ uniformly from the discrete set $\\{0,1,2,\\ldots,2^{53}-1\\}$ and set $U_{A} = I / 2^{53}$.\n- Scheme B (closed discretization): Sample $J$ uniformly from the discrete set $\\{0,1,2,\\ldots,2^{53}\\}$ and set $U_{B} = J / 2^{53}$.\n\nYou will analyze the exact probabilities of generating the boundary values $U=0$ and $U=1$ under each scheme, and then assess the consequence of these probabilities on inverse-transform sampling for a heavy-tailed distribution.\n\nLet $F$ be the cumulative distribution function of a Pareto distribution with tail index $\\alpha  0$ and scale $x_{m}  0$, that is,\n$$\nF(x) =\n\\begin{cases}\n0,  x  x_{m},\\\\[4pt]\n1 - \\left(\\dfrac{x_{m}}{x}\\right)^{\\alpha},  x \\ge x_{m}.\n\\end{cases}\n$$\nIn inverse-transform sampling, one sets $X = F^{-1}(U)$ with $U$ uniform on $[0,1]$.\n\nStarting from the definitions of the discrete uniform distributions on finite sets and the inverse-transform method, do the following:\n\n1. Derive $P(U_{A} = 0)$, $P(U_{A} = 1)$, $P(U_{B} = 0)$, and $P(U_{B} = 1)$.\n2. Using only the definition of the Pareto cumulative distribution function above, derive $F^{-1}(u)$ for $u \\in [0,1]$ and determine, under each scheme, the exact probability that $X$ is infinite, i.e., $P(X = +\\infty)$.\n3. Now suppose you generate $N = 10^{12}$ independent variates $U_{B}^{(1)},\\ldots,U_{B}^{(N)}$ under Scheme B and transform each to $X^{(i)} = F^{-1}(U_{B}^{(i)})$. Compute the probability that at least one of the $X^{(i)}$ is $+\\infty$. Round your final numerical answer to four significant figures.\n\nYour final answer must be the single numerical value requested in item 3, rounded as specified, with no units.", "solution": "The problem requires an analysis of two different schemes for generating discrete approximations to a uniform random variate on the unit interval, and the consequences for inverse-transform sampling of a Pareto distribution. The solution is structured in three parts as requested.\n\n### Part 1: Probabilities of Boundary Values\n\nLet $b=53$.\n\n**Scheme A (right-open discretization)**\n\nUnder Scheme A, a random integer $I$ is drawn uniformly from the set $\\mathcal{I} = \\{0, 1, 2, \\ldots, 2^{b}-1\\}$. The size of this set is $|\\mathcal{I}| = 2^{b}$. The probability mass function for $I$ is $P(I=i) = \\frac{1}{2^{b}}$ for any $i \\in \\mathcal{I}$. The random variate is $U_{A} = I / 2^{b}$.\n\nWe determine the probabilities of generating the boundary values $0$ and $1$.\n\n-   **Probability of generating $U_{A}=0$**:\n    The event $U_{A}=0$ occurs if and only if $I=0$. Since $0 \\in \\mathcal{I}$, this event is possible. Its probability is:\n    $$P(U_{A}=0) = P(I=0) = \\frac{1}{2^{b}} = \\frac{1}{2^{53}}$$\n\n-   **Probability of generating $U_{A}=1$**:\n    The event $U_{A}=1$ occurs if and only if $I/2^{b}=1$, which implies $I=2^{b}$. However, the maximum value in the set $\\mathcal{I}$ is $2^{b}-1$. Therefore, $I=2^{b}$ is an impossible event.\n    $$P(U_{A}=1) = P(I=2^{b}) = 0$$\n\n**Scheme B (closed discretization)**\n\nUnder Scheme B, a random integer $J$ is drawn uniformly from the set $\\mathcal{J} = \\{0, 1, 2, \\ldots, 2^{b}\\}$. The size of this set is $|\\mathcal{J}| = 2^{b}+1$. The probability mass function for $J$ is $P(J=j) = \\frac{1}{2^{b}+1}$ for any $j \\in \\mathcal{J}$. The random variate is $U_{B} = J / 2^{b}$.\n\nWe determine the probabilities of generating the boundary values $0$ and $1$.\n\n-   **Probability of generating $U_{B}=0$**:\n    The event $U_{B}=0$ occurs if and only if $J=0$. Since $0 \\in \\mathcal{J}$, this event is possible. Its probability is:\n    $$P(U_{B}=0) = P(J=0) = \\frac{1}{2^{b}+1} = \\frac{1}{2^{53}+1}$$\n\n-   **Probability of generating $U_{B}=1$**:\n    The event $U_{B}=1$ occurs if and only if $J/2^{b}=1$, which implies $J=2^{b}$. Since $2^{b} \\in \\mathcal{J}$, this event is possible. Its probability is:\n    $$P(U_{B}=1) = P(J=2^{b}) = \\frac{1}{2^{b}+1} = \\frac{1}{2^{53}+1}$$\n\n### Part 2: Inverse CDF and Probability of Infinity\n\nFirst, we derive the inverse cumulative distribution function, $F^{-1}(u)$, for the Pareto distribution. The CDF is given by $F(x) = 1 - (x_{m}/x)^{\\alpha}$ for $x \\ge x_{m}$. We set $u = F(x)$ for $u$ in the range of $F$, which is $[0, 1)$, and solve for $x$:\n$$u = 1 - \\left(\\frac{x_{m}}{x}\\right)^{\\alpha}$$\n$$\\left(\\frac{x_{m}}{x}\\right)^{\\alpha} = 1 - u$$\n$$\\frac{x_{m}}{x} = (1 - u)^{1/\\alpha}$$\n$$x = \\frac{x_{m}}{(1 - u)^{1/\\alpha}} = x_{m}(1-u)^{-1/\\alpha}$$\nThus, for $u \\in [0, 1)$, the inverse CDF is $F^{-1}(u) = x_{m}(1-u)^{-1/\\alpha}$.\n\nThe problem requires considering $u \\in [0, 1]$. We must examine the behavior at $u=1$. As $u \\to 1^{-}$, the term $(1-u) \\to 0^{+}$, and thus $(1-u)^{-1/\\alpha} \\to +\\infty$ since $\\alpha  0$. It is therefore standard to define $F^{-1}(1) = +\\infty$.\n\nA sampled value $X$ from the Pareto distribution using the inverse-transform method, $X = F^{-1}(U)$, will be infinite if and only if the uniform variate $U$ is exactly $1$. Therefore, the probability $P(X=+\\infty)$ is equal to the probability $P(U=1)$.\n\nWe can now find this probability for each scheme using the results from Part 1.\n\n-   **Scheme A**:\n    $$P(X=+\\infty) = P(U_{A}=1) = 0$$\n\n-   **Scheme B**:\n    $$P(X=+\\infty) = P(U_{B}=1) = \\frac{1}{2^{53}+1}$$\n\nThis highlights a critical difference: Scheme A can never generate an infinite value, while Scheme B can, albeit with a very small probability.\n\n### Part 3: Probability of at Least One Infinite Variate\n\nWe are given $N = 10^{12}$ independent variates $U_{B}^{(i)}$ generated under Scheme B. For each $i \\in \\{1, \\ldots, N\\}$, we transform it to $X^{(i)} = F^{-1}(U_{B}^{(i)})$. We need to find the probability that at least one of these $X^{(i)}$ is $+\\infty$.\n\nLet $E_{i}$ be the event that $X^{(i)} = +\\infty$. As determined in Part 2, the probability of this event for a single trial is:\n$$p = P(E_{i}) = P(X = +\\infty \\text{ under Scheme B}) = \\frac{1}{2^{53}+1}$$\nThe trials are independent. The probability that at least one event $E_{i}$ occurs is $1$ minus the probability that none of them occur. The probability that a single event $E_{i}$ does not occur is $1-p$. The probability that none of the $N$ independent events occur is $(1-p)^{N}$.\n\nThe desired probability is:\n$$P(\\text{at least one } X^{(i)} = +\\infty) = 1 - (1-p)^{N} = 1 - \\left(1 - \\frac{1}{2^{53}+1}\\right)^{10^{12}}$$\n\nThis expression is exact. To compute its numerical value, we note that $N$ is very large and $p$ is very small. In such cases, the number of \"successes\" (occurrences of $X^{(i)}=+\\infty$) is well-approximated by a Poisson distribution with parameter $\\lambda = Np$. The probability of zero successes is $\\exp(-\\lambda)$. The probability of at least one success is $1 - \\exp(-\\lambda)$. This approximation is highly accurate.\n\nLet's compute $\\lambda$:\n$$\\lambda = Np = \\frac{10^{12}}{2^{53}+1}$$\nUsing $2^{53} = 9007199254740992$, we get:\n$$\\lambda = \\frac{10^{12}}{9007199254740993} \\approx 0.0001110223024625$$\nNow we compute the probability:\n$$P(\\text{at least one } \\infty) \\approx 1 - \\exp(-\\lambda) = 1 - \\exp(-0.0001110223024625)$$\nUsing a calculator,\n$$P(\\text{at least one } \\infty) \\approx 1 - 0.9998889838318...$$\n$$P(\\text{at least one } \\infty) \\approx 0.00011101616818...$$\nThe problem requires rounding the final answer to four significant figures. The first four significant figures are $1, 1, 1, 0$. The fifth significant figure is $1$, so we do not round up the fourth figure.\n\nThe final numerical value is $0.0001110$.", "answer": "$$\\boxed{0.0001110}$$", "id": "3309936"}, {"introduction": "Achieving a high-quality approximation of the continuous uniform distribution requires more than just a good underlying integer generator; it demands meticulous handling of numerical precision. A naive scaling of an integer to the unit interval can introduce a subtle but systematic bias, which can accumulate in large-scale simulations. This practice challenges you to move beyond simplistic approaches by constructing a provably unbiased, high-precision mapping from 32-bit integers to a 53-bit floating-point representation, and to precisely quantify the bias inherent in a more straightforward method [@problem_id:3309957].", "problem": "Consider a source of independent identically distributed $32$-bit unsigned integers $Y$ that are uniform on the finite set $\\{0,1,\\dots,2^{32}-1\\}$. You wish to generate a double-precision real variate that is as close as possible to a Uniform$(0,1)$ distribution under the Institute of Electrical and Electronics Engineers (IEEE) $754$ binary64 standard, and to quantify any bias introduced by a naive mapping.\n\nStarting from the core definitions of the uniform distribution, the binary representation of real numbers, and the fact that an IEEE $754$ binary64 number has a $53$-bit significand, do the following:\n\n1. Construct, using at most two independent draws $Y_{1}$ and $Y_{2}$ from the given source, a mapping from $(Y_{1},Y_{2})$ to a double-precision random variable $V\\in(0,1)$ whose distribution is exactly uniform over a grid with spacing at most $2^{-53}$. The construction must avoid producing the endpoints $0$ and $1$, and must be specified using only integer arithmetic and a single fixed reciprocal of a power of two. Provide a justification from first principles that the resulting discrete law is uniform over its support and that $\\mathbb{E}[V]=\\tfrac{1}{2}$.\n\n2. Analyze the naive scaling $U=Y/2^{32}$ performed in exact arithmetic and then represented in IEEE $754$ binary64. Derive, from fundamental properties of expectations and discrete uniform distributions, the exact bias $\\mathbb{E}[U]-\\tfrac{1}{2}$.\n\nProvide your final answer as the exact closed-form expression for $\\mathbb{E}[U]-\\tfrac{1}{2}$. No rounding is required and no units apply.", "solution": "The problem is divided into two parts. The first part requires the construction and justification of a method to generate a high-precision uniform random variate in $(0,1)$. The second part requires the analysis of the bias of a simpler, naive method.\n\n### Part 1: Construction and Justification of a High-Precision Variate $V$\n\nThe goal is to construct a random variable $V$ that is uniform on a discrete set of points in the interval $(0,1)$. The precision of this variable should be commensurate with the $53$-bit significand of the IEEE $754$ binary64 format. The source of randomness consists of i.i.d. $32$-bit unsigned integers $Y$, which are uniform on the set $\\{0, 1, \\dots, 2^{32}-1\\}$.\n\n**Construction:**\nWe require at least $53$ bits of randomness to construct the significand of our target variate. Since a single draw $Y$ provides only $32$ bits, we must use two draws, $Y_1$ and $Y_2$. These two draws provide a total of $64$ bits of randomness, which is sufficient.\n\n1.  **Generate a 53-bit uniform integer $I$:** We can combine bits from $Y_1$ and $Y_2$ to form a $53$-bit integer. A standard method is to use $Y_1$ for the most significant bits and a portion of $Y_2$ for the least significant bits. Let's construct a $53$-bit integer $I$ as follows, using integer arithmetic operations that correspond to bit-shifting and concatenation:\n    $$I = Y_1 \\cdot 2^{21} + \\lfloor Y_2 / 2^{11} \\rfloor$$\n    Here, $Y_1$ is treated as a $32$-bit integer, and multiplying by $2^{21}$ effectively shifts its bits to occupy positions $21$ through $52$. The term $\\lfloor Y_2 / 2^{11} \\rfloor$ extracts the most significant $21$ bits of the $32$-bit integer $Y_2$, which then occupy positions $0$ through $20$.\n\n2.  **Justify the uniformity of $I$:** The variable $Y_1$ can take any integer value in $\\{0, 1, \\dots, 2^{32}-1\\}$. The variable $\\lfloor Y_2 / 2^{11} \\rfloor$ can take any integer value in $\\{0, 1, \\dots, 2^{21}-1\\}$. The combination $I$ can thus take any integer value from $0 \\cdot 2^{21} + 0 = 0$ to $(2^{32}-1) \\cdot 2^{21} + (2^{21}-1) = 2^{53} - 2^{21} + 2^{21} - 1 = 2^{53}-1$. So, $I$ is an integer in the set $\\{0, 1, \\dots, 2^{53}-1\\}$.\n\n    To show that $I$ is uniformly distributed, we consider the number of pairs $(Y_1, Y_2)$ that map to a specific value $i \\in \\{0, 1, \\dots, 2^{53}-1\\}$. For any such $i$, we can uniquely determine the required value of $Y_1$ and the required value of the high bits of $Y_2$:\n    -   $Y_1 = \\lfloor i / 2^{21} \\rfloor$. This determines $Y_1$ uniquely.\n    -   $\\lfloor Y_2 / 2^{11} \\rfloor = i \\pmod{2^{21}}$. Let this value be $y'_2$. The condition on $Y_2$ is $y'_2 \\cdot 2^{11} \\le Y_2  (y'_2+1) \\cdot 2^{11}$. The number of integer values of $Y_2$ satisfying this is $(y'_2+1) \\cdot 2^{11} - y'_2 \\cdot 2^{11} = 2^{11}$.\n    Therefore, for any given value $i$ in the range of $I$, there are exactly $1 \\times 2^{11} = 2^{11}$ pairs of $(Y_1, Y_2)$ that produce it. Since each pair $(Y_1, Y_2)$ is equally likely with probability $(1/2^{32})^2 = 1/2^{64}$, the probability of obtaining any specific value $i$ is $P(I=i) = 2^{11} \\cdot (1/2^{64}) = 1/2^{53}$. This confirms that $I$ is uniformly distributed on $\\{0, 1, \\dots, 2^{53}-1\\}$.\n\n3.  **Construct the final variate $V$:** We need to map the integer $I$ to a real number $V \\in (0,1)$ such that the resulting discrete distribution is uniform on its support and the spacing is at most $2^{-53}$. The construction must use only integer arithmetic followed by multiplication by a single reciprocal of a power of two.\n    Let us define an intermediate integer $K = 2I+1$. Since $I$ is uniform on $\\{0, 1, \\dots, 2^{53}-1\\}$, $K$ is uniform on the set of odd integers $\\{1, 3, 5, \\dots, 2(2^{53}-1)+1\\} = \\{1, 3, 5, \\dots, 2^{54}-1\\}$.\n    Now, define $V$ as:\n    $$V = K \\cdot 2^{-54} = (2I+1) \\cdot 2^{-54}$$\n    The values of $V$ form the set $\\{\\frac{1}{2^{54}}, \\frac{3}{2^{54}}, \\dots, \\frac{2^{54}-1}{2^{54}}\\}$. All these values are strictly between $0$ and $1$. The spacing between consecutive values is $\\frac{2}{2^{54}} = \\frac{1}{2^{53}}$, which satisfies the condition of being at most $2^{-53}$. The construction involves only integer arithmetic ($2I+1$) followed by multiplication with the single reciprocal $2^{-54}$.\n\n**Justification of Uniformity and Expectation of $V$:**\n-   **Uniformity:** The mapping from $I$ to $K$ is a bijection. Since $I$ is uniform on its support of size $2^{53}$, $K$ is uniform on its support, which also has size $2^{53}$. The final variate $V$ is a linear transformation of $K$, so $V$ is uniform on its support.\n-   **Expectation:** We must show that $\\mathbb{E}[V] = \\frac{1}{2}$. We can use the linearity of expectation.\n    $$ \\mathbb{E}[V] = \\mathbb{E}[(2I+1) \\cdot 2^{-54}] = 2^{-54} \\cdot (2\\mathbb{E}[I]+1) $$\n    The random variable $I$ is uniform on $\\{0, 1, \\dots, N-1\\}$ where $N = 2^{53}$. The expectation of such a variable is:\n    $$ \\mathbb{E}[I] = \\frac{1}{N} \\sum_{i=0}^{N-1} i = \\frac{1}{N} \\frac{(N-1)N}{2} = \\frac{N-1}{2} $$\n    Substituting $N=2^{53}$, we get $\\mathbb{E}[I] = \\frac{2^{53}-1}{2}$.\n    Now, substituting this into the expression for $\\mathbb{E}[V]$:\n    $$ \\mathbb{E}[V] = 2^{-54} \\cdot \\left(2 \\cdot \\frac{2^{53}-1}{2} + 1\\right) = 2^{-54} \\cdot ((2^{53}-1)+1) = 2^{-54} \\cdot 2^{53} = \\frac{1}{2} $$\n    The construction is therefore validated from first principles.\n\n### Part 2: Bias of the Naive Scaling $U = Y/2^{32}$\n\nWe analyze the naive approach where a single $32$-bit unsigned integer $Y$ is scaled. $Y$ is a random variable with a discrete uniform distribution on the set $\\{0, 1, \\dots, 2^{32}-1\\}$. The naive variate is $U = Y/2^{32}$.\n\nThe problem specifies that the division is performed in exact arithmetic and the result is then represented as an IEEE $754$ binary64 number. The values of $U$ are of the form $k/2^{32}$ where $k$ is an integer. These are dyadic rationals. Any such number with a denominator that is a power of $2$ less than or equal to $2^{52}$ (for normalized numbers) has an exact finite representation in binary floating-point arithmetic. Since $32 \\le 52$, all values $k/2^{32}$ are represented exactly in binary64. Thus, the random variable $U$ is precisely $Y/2^{32}$.\n\nThe support of $U$ is the set $\\{0, \\frac{1}{2^{32}}, \\frac{2}{2^{32}}, \\dots, \\frac{2^{32}-1}{2^{32}}\\}$. Since $Y$ is uniform, each of these $2^{32}$ values is taken with equal probability $p = 1/2^{32}$.\n\nTo find the bias, we first compute the expectation $\\mathbb{E}[U]$. Let $N = 2^{32}$. The variable $Y$ is uniform on $\\{0, 1, \\dots, N-1\\}$.\nFrom fundamental properties of expectation, we have:\n$$ \\mathbb{E}[U] = \\mathbb{E}\\left[\\frac{Y}{N}\\right] = \\frac{1}{N}\\mathbb{E}[Y] $$\nThe expectation of the discrete uniform variable $Y$ is the mean of the values in its support:\n$$ \\mathbb{E}[Y] = \\frac{1}{N} \\sum_{k=0}^{N-1} k = \\frac{1}{N} \\frac{(N-1)N}{2} = \\frac{N-1}{2} $$\nSubstituting this into the expression for $\\mathbb{E}[U]$:\n$$ \\mathbb{E}[U] = \\frac{1}{N} \\left(\\frac{N-1}{2}\\right) = \\frac{N-1}{2N} $$\nThe bias is defined as the deviation of this expectation from the mean of a true Uniform$(0,1)$ distribution, which is $\\frac{1}{2}$.\n$$ \\text{Bias} = \\mathbb{E}[U] - \\frac{1}{2} = \\frac{N-1}{2N} - \\frac{1}{2} $$\nTo combine these terms, we use a common denominator of $2N$:\n$$ \\text{Bias} = \\frac{N-1}{2N} - \\frac{N}{2N} = \\frac{(N-1)-N}{2N} = \\frac{-1}{2N} $$\nFinally, substituting $N = 2^{32}$:\n$$ \\text{Bias} = \\frac{-1}{2 \\cdot 2^{32}} = -\\frac{1}{2^{33}} $$\nThis negative bias indicates that the mean of the naively generated variates is slightly less than $\\frac{1}{2}$, which is expected as the support of $U$ is $[0, 1 - 2^{-32}]$, an interval that is not symmetric around $\\frac{1}{2}$.", "answer": "$$\\boxed{-\\frac{1}{2^{33}}}$$", "id": "3309957"}]}