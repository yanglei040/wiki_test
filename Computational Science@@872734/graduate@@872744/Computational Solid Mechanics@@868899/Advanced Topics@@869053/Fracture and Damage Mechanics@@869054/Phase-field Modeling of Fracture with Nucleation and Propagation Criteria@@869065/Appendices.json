{"hands_on_practices": [{"introduction": "The initiation of fracture in a material is not an arbitrary event; it is governed by a delicate balance between the stored elastic energy that drives crack formation and the energy required to create new surfaces. This exercise grounds the abstract concept of a phase-field model in a tangible stability analysis, allowing you to perform a first-principles derivation of the critical load for damage nucleation. By analyzing the stability of the total potential energy functional, you will determine the precise condition under which an intact material becomes unstable and damage begins to form [@problem_id:3587452].", "problem": "Consider a one-dimensional elastic bar of length $L$ and unit cross-sectional area, aligned along the coordinate $x \\in [0,L]$, subjected at $x=L$ to a prescribed uniform traction $\\sigma$ and fixed at $x=0$ with $u(0)=0$. Assume small-strain linear elasticity with Young’s modulus $E$, so that the strain is $\\varepsilon(x) = u'(x)$ and the undamaged elastic energy density is $\\psi_{0}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2}$. Fracture is modeled by a scalar phase-field damage variable $d(x) \\in [0,1]$ that degrades the stiffness through the function $g(d) = (1-d)^{2}$ and is governed by the Ambrosio–Tortorelli (AT1) crack surface functional. Let the crack surface density (per unit reference length) be given by $\\psi_{c}(d,d') = \\tfrac{G_{c}}{2\\ell} d + \\tfrac{G_{c}\\ell}{2} (d')^{2}$, where $G_{c}$ is the critical energy release rate (fracture toughness) and $\\ell$ is the internal length scale. The total potential energy functional is\n$$\n\\Pi[u,d] = \\int_{0}^{L} \\left( g(d)\\, \\psi_{0}(u') + \\psi_{c}(d,d') \\right) \\, dx \\;-\\; \\int_{0}^{L} \\sigma\\, u'(x)\\, dx.\n$$\nYou may assume tension-only loading so that $\\sigma \\ge 0$.\n\n(a) Using the principle of minimum potential energy and one-dimensional equilibrium, construct the homogeneous displacement solution $u(x)$ consistent with the prescribed traction at $x=L$.\n\n(b) Restrict attention to spatially homogeneous damage fields $d(x)=d$ (so that $d' = 0$) and analyze the stationarity of $\\Pi$ with respect to $d$ at $d=0$. Determine the condition under which the undamaged state $d=0$ is stable against damage nucleation, and derive the corresponding critical traction $\\sigma_{c}$ in terms of $E$, $G_{c}$, and $\\ell$ for which $d=0$ loses stability. Express your final answer for $\\sigma_{c}$ in Pascals as a single closed-form analytic expression. No numerical values are provided; do not perform any numerical substitutions. No rounding is required.", "solution": "The user has provided a problem from the field of computational solid mechanics, specifically on the topic of phase-field modeling of fracture. The problem is to be solved by adhering to principles of mechanical equilibrium and stability analysis via the calculus of variations.\n\n### Problem Validation\nThe problem statement has been validated and is found to be scientifically grounded, well-posed, objective, and internally consistent. It provides all necessary information, definitions, and boundary conditions to derive a unique and meaningful solution. The formulation uses standard concepts from continuum mechanics and phase-field theory, such as the potential energy functional, Ambrosio-Tortorelli regularization, and the principle of minimum potential energy. Therefore, the problem is valid, and a solution will be provided.\n\n### Part (a): Homogeneous Displacement Solution\n\nThe total potential energy functional is given as:\n$$\n\\Pi[u,d] = \\int_{0}^{L} \\left( g(d)\\, \\psi_{0}(u') + \\psi_{c}(d,d') \\right) \\, dx \\;-\\; \\int_{0}^{L} \\sigma\\, u'(x)\\, dx\n$$\nwhere $\\psi_{0}(u') = \\frac{1}{2} E (u')^2$, $g(d)=(1-d)^2$, and $\\sigma$ is a prescribed uniform traction.\n\nAccording to the principle of minimum potential energy, the displacement field $u(x)$ must minimize $\\Pi$ for a given damage field $d(x)$. This requires the first variation of $\\Pi$ with respect to $u$ to be zero. The Euler-Lagrange equation for the variable $u(x)$ is:\n$$\n\\frac{d}{dx} \\left( \\frac{\\partial \\mathcal{L}}{\\partial u'} \\right) - \\frac{\\partial \\mathcal{L}}{\\partial u} = 0\n$$\nwhere the Lagrangian density $\\mathcal{L}$ is the integrand of the functional:\n$$\n\\mathcal{L}(u', d, d') = g(d)\\, \\psi_{0}(u') + \\psi_{c}(d,d') - \\sigma u'\n$$\nWe compute the partial derivatives of $\\mathcal{L}$:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial u'} = \\frac{\\partial}{\\partial u'} \\left( (1-d)^2 \\frac{1}{2} E (u')^2 \\right) - \\sigma = (1-d)^2 E u' - \\sigma\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial u} = 0\n$$\nSubstituting these into the Euler-Lagrange equation gives the equilibrium equation:\n$$\n\\frac{d}{dx} \\left( (1-d)^2 E u' - \\sigma \\right) = 0\n$$\nThis implies that the quantity $(1-d)^2 E u' - \\sigma$ is constant along the bar. Let's call this constant $C$.\n$$\n(1-d(x))^2 E u'(x) - \\sigma = C\n$$\nThe problem describes a traction boundary condition at $x=L$. In the context of this variational formulation, the term $-\\int_0^L \\sigma u' dx$ leads to a natural boundary condition at any free boundary. At $x=L$, the natural boundary condition is $\\frac{\\partial \\mathcal{L}}{\\partial u'} \\big|_{x=L} = 0$. This yields:\n$$\n\\left. \\left( (1-d)^2 E u' - \\sigma \\right) \\right|_{x=L} = 0\n$$\nThis determines the constant to be $C=0$. Therefore, the equilibrium condition holds for all $x \\in [0,L]$:\n$$\n(1-d(x))^2 E u'(x) = \\sigma\n$$\nThis equation states that the mechanical stress, $\\sigma_{int} = g(d) E u'$, is constant throughout the bar and equal to the applied traction $\\sigma$.\n\nFor part (a), we are asked for the homogeneous displacement solution. This is naturally interpreted as the solution for the undamaged state, which is the reference state for the stability analysis in part (b). In the undamaged state, $d(x) = 0$ for all $x$. Substituting this into the equilibrium equation gives:\n$$\n(1-0)^2 E u'(x) = \\sigma \\implies E u'(x) = \\sigma\n$$\nThe strain is constant: $u'(x) = \\frac{\\sigma}{E}$. Integrating this expression with respect to $x$ gives the displacement field:\n$$\nu(x) = \\int \\frac{\\sigma}{E} dx = \\frac{\\sigma}{E} x + C_1\n$$\nwhere $C_1$ is a constant of integration. We apply the fixed boundary condition at $x=0$, which is $u(0)=0$:\n$$\nu(0) = \\frac{\\sigma}{E}(0) + C_1 = 0 \\implies C_1 = 0\n$$\nThus, the displacement solution for the undamaged bar is:\n$$\nu(x) = \\frac{\\sigma}{E} x\n$$\n\n### Part (b): Stability Analysis and Critical Traction\n\nWe are instructed to restrict the analysis to spatially homogeneous damage fields, i.e., $d(x)=d$, where $d$ is a constant. Consequently, the derivative of the damage field is $d'(x)=0$.\n\nUnder this assumption, we can express the total potential energy as a function of the scalar variable $d$. First, we enforce the mechanical equilibrium condition derived in part (a), which for constant $d$ becomes $u'(x) = \\frac{\\sigma}{E(1-d)^2}$. We substitute this strain, along with $d'(x)=0$, into the potential energy functional $\\Pi[u,d]$:\n$$\n\\Pi(d) = \\int_{0}^{L} \\left( (1-d)^2 \\frac{E}{2} \\left( \\frac{\\sigma}{E(1-d)^2} \\right)^2 + \\left( \\frac{G_c}{2\\ell} d + \\frac{G_c\\ell}{2} (0)^2 \\right) \\right) dx - \\int_{0}^{L} \\sigma \\left( \\frac{\\sigma}{E(1-d)^2} \\right) dx\n$$\nSimplifying the terms within the integral:\n$$\n\\Pi(d) = \\int_{0}^{L} \\left( \\frac{(1-d)^2 E \\sigma^2}{2E^2(1-d)^4} + \\frac{G_c d}{2\\ell} - \\frac{\\sigma^2}{E(1-d)^2} \\right) dx\n$$\n$$\n\\Pi(d) = \\int_{0}^{L} \\left( \\frac{\\sigma^2}{2E(1-d)^2} + \\frac{G_c d}{2\\ell} - \\frac{\\sigma^2}{E(1-d)^2} \\right) dx\n$$\n$$\n\\Pi(d) = \\int_{0}^{L} \\left( -\\frac{\\sigma^2}{2E(1-d)^2} + \\frac{G_c d}{2\\ell} \\right) dx\n$$\nSince the integrand is independent of $x$, we can perform the integration over the length $L$:\n$$\n\\Pi(d) = L \\left( -\\frac{\\sigma^2}{2E(1-d)^2} + \\frac{G_c d}{2\\ell} \\right)\n$$\nThe undamaged state corresponds to $d=0$. The stability of this state is determined by the behavior of $\\Pi(d)$ for small positive values of $d$. Due to the unilateral physical constraint $d \\ge 0$, the state $d=0$ is stable if it is a local minimum of the potential energy in the feasible domain. This requires that the potential energy does not decrease for an infinitesimal increase in $d$ from $0$. Mathematically, the directional derivative of $\\Pi(d)$ at $d=0$ in the direction of increasing $d$ must be non-negative:\n$$\n\\frac{d\\Pi}{dd} \\bigg|_{d=0} \\ge 0\n$$\nFirst, we compute the derivative of $\\Pi(d)$ with respect to $d$:\n$$\n\\frac{d\\Pi}{dd} = \\frac{d}{dd} \\left[ L \\left( -\\frac{\\sigma^2}{2E}(1-d)^{-2} + \\frac{G_c d}{2\\ell} \\right) \\right]\n$$\n$$\n\\frac{d\\Pi}{dd} = L \\left[ -\\frac{\\sigma^2}{2E}(-2)(1-d)^{-3}(-1) + \\frac{G_c}{2\\ell} \\right]\n$$\n$$\n\\frac{d\\Pi}{dd} = L \\left( -\\frac{\\sigma^2}{E(1-d)^3} + \\frac{G_c}{2\\ell} \\right)\n$$\nNow, we evaluate this derivative at $d=0$:\n$$\n\\frac{d\\Pi}{dd} \\bigg|_{d=0} = L \\left( -\\frac{\\sigma^2}{E(1-0)^3} + \\frac{G_c}{2\\ell} \\right) = L \\left( -\\frac{\\sigma^2}{E} + \\frac{G_c}{2\\ell} \\right)\n$$\nThe stability condition is therefore:\n$$\nL \\left( -\\frac{\\sigma^2}{E} + \\frac{G_c}{2\\ell} \\right) \\ge 0 \\implies -\\frac{\\sigma^2}{E} + \\frac{G_c}{2\\ell} \\ge 0\n$$\n$$\n\\frac{\\sigma^2}{E} \\le \\frac{G_c}{2\\ell} \\implies \\sigma^2 \\le \\frac{E G_c}{2\\ell}\n$$\nThe undamaged state $d=0$ is stable as long as the applied traction $\\sigma$ satisfies this condition. The state loses stability when this inequality is first violated. The critical traction, $\\sigma_c$, is the value of $\\sigma$ at the boundary of the stable region, where the equality holds:\n$$\n\\sigma_c^2 = \\frac{E G_c}{2\\ell}\n$$\nSolving for $\\sigma_c$ (and taking the positive root since $\\sigma \\ge 0$):\n$$\n\\sigma_c = \\sqrt{\\frac{E G_c}{2\\ell}}\n$$\nThis expression gives the critical traction in Pascals, as required. For $\\sigma  \\sigma_c$, the derivative $\\frac{d\\Pi}{dd}|_{d=0}$ becomes negative, indicating that the potential energy can be decreased by introducing damage, and thus the undamaged state becomes unstable.", "answer": "$$\\boxed{\\sqrt{\\frac{E G_{c}}{2\\ell}}}$$", "id": "3587452"}, {"introduction": "Building on the concept of energy-driven damage, we now address a crucial aspect of physical realism: many materials, particularly brittle ones like ceramics and concrete, do not fail under compression in the same manner as they do under tension. This practice explores how phase-field models incorporate this asymmetric behavior through a spectral split of the elastic energy. By working through the derivation in a state of pure compression, you will see precisely how the mathematical formulation, specifically the use of $\\psi^{+}$, effectively shuts off the driving force for damage, a key feature for any robust fracture simulation [@problem_id:3587568].", "problem": "Consider a straight, prismatic, small-strain, linear-elastic, one-dimensional ($1$D) bar of length $L$ and Young’s modulus $E$, modeled by a tension-compression split phase-field fracture formulation based on the Ambrosio–Tortorelli (AT-2) regularization. The axial displacement is $u(x)$ and the phase-field (damage) variable is $d(x) \\in [0,1]$, with $d=0$ denoting the intact state and $d=1$ denoting fully broken material. The bar is subjected to a uniform compressive strain $\\varepsilon0$ imposed by kinematic boundary conditions on $u(x)$, and there is no pre-existing damage.\n\nAssume the following ingredients:\n- The spectral tension-compression split of the elastic energy density in $1$D is\n$$\n\\psi^{+}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2}, \n\\qquad\n\\psi^{-}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2},\n$$\nwith the Macaulay brackets $\\langle \\cdot \\rangle_{+}$ and $\\langle \\cdot \\rangle_{-}$ defined by $\\langle x \\rangle_{+} = \\max(x,0)$ and $\\langle x \\rangle_{-} = \\min(x,0)$.\n- The total internal energy functional over the domain $[0,L]$ is\n$$\n\\Pi[u,d] \n= \\int_{0}^{L} \\left( g(d)\\, \\psi^{+}(\\varepsilon(u)) + \\psi^{-}(\\varepsilon(u))\n+ G_{c} \\left( \\frac{d^{2}}{2\\ell} + \\frac{\\ell}{2} (d')^{2} \\right) \\right) \\,\\mathrm{d}x,\n$$\nwhere $G_{c}$ is the critical energy release rate, $\\ell$ is the length-scale parameter, and the degradation function is $g(d) = (1-d)^{2} + \\kappa$ with a small residual stiffness $\\kappa \\in (0,1)$.\n- The damage variable $d(x)$ satisfies natural (variationally consistent) boundary conditions at $x=0$ and $x=L$.\n\nStarting from the stationarity of $\\Pi$ with respect to $d(x)$ and the above definitions, perform the following:\n$1.$ Derive the strong form of the phase-field equation (Euler–Lagrange equation) for $d(x)$ in one dimension, identifying the source (damage-driving) term and the diffusive regularization terms.\n$2.$ Evaluate the source term in the uniform compressive state $\\varepsilon0$ and show that it vanishes under the tension-compression split.\n$3.$ Using the resulting boundary value problem and the natural boundary conditions, solve for the physically admissible phase-field profile $d(x)$ on $[0,L]$, consistent with an initially undamaged bar.\n\nProvide your final answer as the explicit expression for $d(x)$ over $[0,L]$. No intermediate work is required in the final answer. The answer has no units and requires no rounding.", "solution": "The user wants me to solve a problem in the field of computational solid mechanics, specifically concerning a phase-field model for fracture. The problem is to determine the equilibrium damage profile $d(x)$ in a one-dimensional bar under uniform compression.\n\n### Step 1: Extract Givens\n-   **Domain**: A straight, prismatic, one-dimensional ($1$) bar of length $L$.\n-   **Constitutive Model**: Small-strain, linear-elastic with Young’s modulus $E$.\n-   **State Variables**: Axial displacement $u(x)$, phase-field (damage) $d(x) \\in [0,1]$.\n-   **Loading**: Uniform compressive strain $\\varepsilon0$.\n-   **Initial Condition**: No pre-existing damage.\n-   **Energy Split**: Spectral tension-compression split with $\\psi^{+}(\\varepsilon) = \\frac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2}$ and $\\psi^{-}(\\varepsilon) = \\frac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2}$.\n-   **Macaulay Brackets**: $\\langle x \\rangle_{+} = \\max(x,0)$ and $\\langle x \\rangle_{-} = \\min(x,0)$.\n-   **Total Energy Functional**: $\\Pi[u,d] = \\int_{0}^{L} \\left( g(d)\\, \\psi^{+}(\\varepsilon(u)) + \\psi^{-}(\\varepsilon(u)) + G_{c} \\left( \\frac{d^{2}}{2\\ell} + \\frac{\\ell}{2} (d')^{2} \\right) \\right) \\,\\mathrm{d}x$.\n-   **Constants and Functions**: Critical energy release rate $G_c$, length-scale parameter $\\ell$, degradation function $g(d) = (1-d)^{2} + \\kappa$ with residual stiffness parameter $\\kappa \\in (0,1)$.\n-   **Boundary Conditions**: $d(x)$ satisfies natural (variationally consistent) boundary conditions at $x=0$ and $x=L$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is well-grounded in the theory of continuum damage mechanics and variational principles for fracture. The Ambrosio-Tortorelli (AT-2) phase-field model is a standard and widely accepted approach for regularizing sharp crack problems. The use of a tension-compression split is a critical and standard feature for realistic modeling of materials like concrete or ceramics, which have different responses in tension and compression. All elements are based on established scientific principles.\n-   **Well-Posed**: The problem is well-posed. It asks for the solution of a boundary value problem derived from a variational principle. The functional is defined, the domain is specified, and the nature of the boundary conditions is given. This structure allows for a unique solution to be determined.\n-   **Objective**: The problem is stated using precise mathematical definitions and objective language. There are no subjective, metaphorical, or opinion-based statements.\n-   **Completeness**: The problem is self-contained and provides all necessary information to proceed with the derivation and solution. No external information or unstated assumptions are required.\n-   **Consistency**: The givens are internally consistent. There are no contradictions in the definitions or constraints.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard exercise in the mechanics of materials and phase-field modeling. I will proceed with the solution.\n\nThe solution is derived by following the three steps outlined in the problem statement.\n\nFirst, we derive the strong form of the phase-field equation. The equilibrium state is found by requiring the first variation of the total energy functional $\\Pi[u,d]$ with respect to $d$ to be zero. The functional can be written as $\\Pi[d] = \\int_{0}^{L} \\mathcal{L}(d, d') \\,\\mathrm{d}x$, where the Lagrangian density $\\mathcal{L}$ (for a fixed strain field $\\varepsilon$) is\n$$\n\\mathcal{L}(d, d') = g(d)\\, \\psi^{+}(\\varepsilon) + \\psi^{-}(\\varepsilon) + G_{c} \\left( \\frac{d^{2}}{2\\ell} + \\frac{\\ell}{2} (d')^{2} \\right)\n$$\nThe corresponding Euler-Lagrange equation is $\\frac{\\partial \\mathcal{L}}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial \\mathcal{L}}{\\partial d'}\\right) = 0$. We compute the required derivatives. The derivative of the degradation function $g(d) = (1-d)^{2} + \\kappa$ is $g'(d) = -2(1-d)$.\nThe partial derivative of $\\mathcal{L}$ with respect to $d$ is:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d} = g'(d) \\psi^{+}(\\varepsilon) + G_{c} \\frac{d}{\\ell} = -2(1-d) \\psi^{+}(\\varepsilon) + G_{c} \\frac{d}{\\ell}\n$$\nThe partial derivative of $\\mathcal{L}$ with respect to $d'$ is:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d'} = G_{c} \\ell d'\n$$\nTaking the total derivative with respect to $x$ of the above expression gives:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial \\mathcal{L}}{\\partial d'}\\right) = G_{c} \\ell d''\n$$\nSubstituting these into the Euler-Lagrange equation yields the strong form of the phase-field equation:\n$$\n-2(1-d) \\psi^{+}(\\varepsilon) + G_{c} \\frac{d}{\\ell} - G_{c} \\ell d'' = 0\n$$\nRearranging this equation gives:\n$$\nG_{c} \\ell d'' - \\frac{G_{c}}{\\ell} d = -2(1-d) \\psi^{+}(\\varepsilon)\n$$\nHere, the terms on the left-hand side, $G_{c} \\ell d'' - \\frac{G_{c}}{\\ell} d$, are the diffusive regularization terms. The term on the right-hand side, $-2(1-d) \\psi^{+}(\\varepsilon)$, is the damage-driving source term.\n\nSecond, we evaluate the source term for the given loading condition. The bar is in a state of uniform compression, so the strain $\\varepsilon  0$. The tensile elastic energy density $\\psi^{+}(\\varepsilon)$ is defined as $\\psi^{+}(\\varepsilon) = \\frac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2}$, where the Macaulay bracket is $\\langle \\varepsilon \\rangle_{+} = \\max(\\varepsilon, 0)$. For a negative strain $\\varepsilon  0$, we have $\\langle \\varepsilon \\rangle_{+} = 0$. Thus, the tensile energy density is zero:\n$$\n\\psi^{+}(\\varepsilon) = \\frac{1}{2} E (0)^{2} = 0\n$$\nAs a result, the damage-driving source term vanishes: $-2(1-d) \\psi^{+}(\\varepsilon) = 0$. This confirms that in this model, compressive states do not cause material degradation.\n\nThird, we solve the resulting boundary value problem for $d(x)$. With a zero source term, the phase-field equation simplifies to a homogeneous, second-order, linear ordinary differential equation:\n$$\nG_{c} \\ell d'' - \\frac{G_{c}}{\\ell} d = 0\n$$\nSince $G_c  0$ and $\\ell  0$, we can divide by $G_c \\ell$ to get:\n$$\nd'' - \\frac{1}{\\ell^{2}} d = 0\n$$\nThe general solution to this ODE is\n$$\nd(x) = C_{1} \\exp\\left(\\frac{x}{\\ell}\\right) + C_{2} \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nwhere $C_1$ and $C_2$ are integration constants determined by the boundary conditions. The problem specifies natural boundary conditions. These are found from the boundary term in the first variation of $\\Pi$, which is $[ \\frac{\\partial \\mathcal{L}}{\\partial d'} \\delta d ]_{0}^{L} = [ G_c \\ell d' \\delta d ]_{0}^{L}$. For this term to be zero for arbitrary variations $\\delta d$, we must have $d'(0)=0$ and $d'(L)=0$.\nThe derivative of the general solution is:\n$$\nd'(x) = \\frac{C_1}{\\ell} \\exp\\left(\\frac{x}{\\ell}\\right) - \\frac{C_2}{\\ell} \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nApplying the condition at $x=0$:\n$$\nd'(0) = \\frac{C_1}{\\ell} - \\frac{C_2}{\\ell} = 0 \\quad \\implies \\quad C_1 = C_2\n$$\nApplying the condition at $x=L$ and substituting $C_1=C_2$:\n$$\nd'(L) = \\frac{C_1}{\\ell} \\exp\\left(\\frac{L}{\\ell}\\right) - \\frac{C_1}{\\ell} \\exp\\left(-\\frac{L}{\\ell}\\right) = \\frac{C_1}{\\ell} \\left( \\exp\\left(\\frac{L}{\\ell}\\right) - \\exp\\left(-\\frac{L}{\\ell}\\right) \\right) = \\frac{2C_1}{\\ell} \\sinh\\left(\\frac{L}{\\ell}\\right) = 0\n$$\nSince $L0$ and $\\ell0$, the term $\\sinh(L/\\ell)$ is non-zero. Therefore, the equality requires that $C_1 = 0$. Since $C_1=C_2$, we also have $C_2=0$.\nSubstituting $C_1=0$ and $C_2=0$ into the general solution yields the unique, physically admissible solution for the phase-field profile:\n$$\nd(x) = 0 \\quad \\text{for all } x \\in [0,L]\n$$\nThis solution corresponds to a completely intact material ($d=0$), which is consistent with an initially undamaged bar subjected to a purely compressive load, as compression does not drive damage in this model.", "answer": "$$\n\\boxed{0}\n$$", "id": "3587568"}, {"introduction": "Transitioning from continuous theory to computational practice is a critical step in mastering phase-field modeling. This exercise provides a hands-on introduction to the numerical solution of the phase-field evolution equation, forming the core of any fracture simulation code. You will implement a single time step for a damage field update using the finite element method, a process which demystifies the algorithm by breaking it down into assembling system matrices, solving for a candidate update, and enforcing physical constraints like irreversibility [@problem_id:3587473].", "problem": "Consider the phase-field modeling of brittle fracture in one spatial dimension under the Ambrosio-Tortorelli regularization using the so-called AT2 model. The total free energy per unit thickness for a one-dimensional bar of length $L$ is defined on the damage field $d(x,t)$ and the displacement field $u(x,t)$, and combines the elastic strain energy and a crack-surface density functional. The tensile part of the elastic strain energy density is denoted by $\\psi^+(u)$, and its history field $H(t)$ enforces irreversibility of damage growth. The governing equations follow from the principle of minimum potential energy and Karush-Kuhn-Tucker-type irreversibility constraints. All quantities in this problem are dimensionless, and no physical units are required.\n\nYou are to implement the backward-Euler time discretization for the damage field and compute the update of the nodal damage values on a single one-dimensional finite element with linear shape functions, subject to the following modeling assumptions:\n\n- The history field is defined as $H^n = \\max\\!\\left(H^{n-1}, \\psi^+(u^n)\\right)$, which enforces irreversibility of tensile energy driving fracture. For this problem, you are given $H^n$ directly for each test case and must not compute $\\psi^+(u^n)$.\n- The damage irreversibility constraint is $d^n(x) \\ge d^{n-1}(x)$ almost everywhere, and the bound constraint is $0 \\le d^n(x) \\le 1$.\n- A small rate dependence is included through a viscous regularization parameter $\\eta  0$ in the damage evolution, yielding an evolution equation of the form\n$$\n\\eta\\,\\dot{d} - G_c\\,\\ell\\,\\Delta d + \\frac{G_c}{\\ell}\\,d = 2\\,H\\,(1-d),\n$$\nwhere $G_c$ is the dimensionless critical energy release parameter, $\\ell$ is the dimensionless regularization length, and $\\Delta$ is the one-dimensional Laplacian.\n\nPerform a backward-Euler time discretization on a time step of size $\\Delta t$ for the damage field to obtain the semi-discrete strong form at time step $n$:\n$$\n\\frac{\\eta}{\\Delta t}\\left(d^n - d^{n-1}\\right) - G_c\\,\\ell\\,\\Delta d^n + \\frac{G_c}{\\ell}\\,d^n = 2\\,H^n\\,(1 - d^n).\n$$\nRearrange this to the weak form and discretize using a single one-dimensional finite element of length $L$ with linear shape functions $N_1(x)$ and $N_2(x)$, and homogeneous Neumann boundary conditions on $d$ (zero damage flux at the element ends). Let the nodal values of the damage field at time step $n$ be the vector $\\mathbf{d}^n = [d_1^n, d_2^n]^T$, and similarly for $\\mathbf{d}^{n-1}$.\n\nYou must derive the element matrices and implement the following linear system for the update:\n$$\n\\mathbf{K}\\,\\mathbf{d}^n = \\mathbf{r},\n$$\nwith\n$$\n\\mathbf{K} = G_c\\,\\ell\\,\\mathbf{K}_{\\nabla} + \\alpha\\,\\mathbf{M}, \\quad \\alpha = \\frac{\\eta}{\\Delta t} + \\frac{G_c}{\\ell} + 2\\,H^n,\n$$\n$$\n\\mathbf{r} = \\frac{\\eta}{\\Delta t}\\,\\mathbf{M}\\,\\mathbf{d}^{n-1} + 2\\,H^n\\,\\mathbf{f},\n$$\nwhere\n$$\n\\mathbf{K}_{\\nabla} = \\frac{1}{L}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix},\\quad\n\\mathbf{M} = \\frac{L}{6}\\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix},\\quad\n\\mathbf{f} = \\begin{bmatrix} \\int_0^L N_1(x)\\,dx \\\\ \\int_0^L N_2(x)\\,dx \\end{bmatrix} = \\frac{L}{2}\\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}.\n$$\nAfter solving the linear system, enforce the irreversibility and bound constraints nodewise:\n$$\n\\mathbf{d}^n \\leftarrow \\min\\!\\left(1, \\max\\!\\left(\\mathbf{d}^n, \\mathbf{d}^{n-1}\\right)\\right),\n$$\napplied componentwise to the nodal values. Additionally, include a nucleation criterion: when starting from an undamaged state $\\mathbf{d}^{n-1} = \\mathbf{0}$, if the history field does not exceed the classical AT2 nucleation threshold $H_{\\text{crit}} = \\dfrac{G_c}{2\\,\\ell}$, then no damage should nucleate, and you must set $\\mathbf{d}^n = \\mathbf{d}^{n-1}$.\n\nYour task is to implement a program that:\n- Assembles the element matrices for the single element.\n- Solves for $\\mathbf{d}^n$ via the above linear system.\n- Applies the irreversibility and bound constraints.\n- Applies the nucleation criterion when appropriate.\n- Produces the specified output format.\n\nAll quantities are dimensionless. Angles are not used in this problem. The final program must run without user input and use the test suite below. For each test case, the program must output the two nodal values $[d_1^n, d_2^n]$ as floating-point numbers rounded to $6$ decimal places.\n\nTest suite:\n- Case $1$ (general increase from zero damage, above nucleation threshold): $L=1.0$, $G_c=1.0$, $\\ell=0.1$, $\\eta=0.02$, $\\Delta t=0.1$, $H^n=6.0$, $\\mathbf{d}^{n-1}=[0.0, 0.0]$.\n- Case $2$ (no nucleation, history below threshold): $L=1.0$, $G_c=1.0$, $\\ell=0.1$, $\\eta=0.02$, $\\Delta t=0.1$, $H^n=3.0$, $\\mathbf{d}^{n-1}=[0.0, 0.0]$.\n- Case $3$ (propagation irreversibility from partially damaged state, history below threshold): $L=1.0$, $G_c=1.0$, $\\ell=0.1$, $\\eta=0.02$, $\\Delta t=0.1$, $H^n=3.0$, $\\mathbf{d}^{n-1}=[0.4, 0.4]$.\n- Case $4$ (edge case with small viscosity and small time step under high driving): $L=0.5$, $G_c=2.0$, $\\ell=0.05$, $\\eta=0.000001$, $\\Delta t=0.001$, $H^n=50.0$, $\\mathbf{d}^{n-1}=[0.1, 0.1]$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, each inner list holding the two rounded nodal values for a test case, enclosed in square brackets, for example: $[[d_{1}^{(1)},d_{2}^{(1)}],[d_{1}^{(2)},d_{2}^{(2)}],\\ldots]$, where the superscript indicates the test case index. The output must be exactly one line and contain no additional text.", "solution": "The problem presented is a valid and well-posed exercise in computational solid mechanics, specifically concerning the numerical solution of a phase-field model for brittle fracture. The model is the Ambrosio-Tortorelli (AT2) formulation, regularized with a viscous term and discretized in time using the backward-Euler method and in space using one-dimensional linear finite elements. The problem is self-contained, scientifically sound, and all required parameters and matrices for a single-element calculation are provided. A unique solution to the defined linear system exists and the subsequent algorithmic steps are unambiguous.\n\nThe core of the task is to implement a single time step update for the nodal damage values $\\mathbf{d}^n = [d_1^n, d_2^n]^T$ based on the values from the previous time step, $\\mathbf{d}^{n-1}$. The procedure is derived from the governing partial differential equation for the damage field $d(x, t)$:\n$$\n\\eta\\,\\dot{d} - G_c\\,\\ell\\,\\Delta d + \\frac{G_c}{\\ell}\\,d = 2\\,H\\,(1-d)\n$$\nApplying a backward-Euler time discretization, where $\\dot{d} \\approx (d^n - d^{n-1})/\\Delta t$, yields the semi-discrete strong form at time step $n$:\n$$\n\\frac{\\eta}{\\Delta t}\\left(d^n - d^{n-1}\\right) - G_c\\,\\ell\\,\\Delta d^n + \\frac{G_c}{\\ell}\\,d^n = 2\\,H^n\\,(1 - d^n)\n$$\nTo obtain the matrix form for a finite element implementation, we first rearrange the equation to group all terms related to the unknown field $d^n$ on the left-hand side:\n$$\n- G_c\\,\\ell\\,\\Delta d^n + \\left(\\frac{\\eta}{\\Delta t} + \\frac{G_c}{\\ell} + 2\\,H^n\\right) d^n = \\frac{\\eta}{\\Delta t}\\,d^{n-1} + 2\\,H^n\n$$\nThis is a linear elliptic partial differential equation for $d^n$. Following the Galerkin method, we multiply by a test function $v(x)$ and integrate over the element domain $[0, L]$. Applying integration by parts to the Laplacian term and incorporating the specified homogeneous Neumann boundary conditions ($\\nabla d^n = 0$ at $x=0$ and $x=L$) gives the weak form:\n$$\n\\int_0^L \\left[ G_c\\,\\ell\\,(\\nabla d^n) \\cdot (\\nabla v) + \\left(\\frac{\\eta}{\\Delta t} + \\frac{G_c}{\\ell} + 2H^n\\right) d^n v \\right] dx = \\int_0^L \\left[ \\frac{\\eta}{\\Delta t}\\, d^{n-1} v + 2H^n v \\right] dx\n$$\nThe fields $d^n(x)$ and $d^{n-1}(x)$ are discretized using linear shape functions $N_i(x)$ as $d^n(x) = \\sum_j d_j^n N_j(x)$ and $d^{n-1}(x) = \\sum_j d_j^{n-1} N_j(x)$. By choosing the test function $v(x)$ to be each shape function $N_i(x)$ in turn, we obtain a system of linear algebraic equations for the nodal values $\\mathbf{d}^n$. This system is precisely the one provided in the problem statement, $\\mathbf{K}\\,\\mathbf{d}^n = \\mathbf{r}$, where:\n$$\n\\mathbf{K} = G_c\\,\\ell\\,\\mathbf{K}_{\\nabla} + \\alpha\\,\\mathbf{M}\n$$\n$$\n\\mathbf{r} = \\frac{\\eta}{\\Delta t}\\,\\mathbf{M}\\,\\mathbf{d}^{n-1} + 2\\,H^n\\,\\mathbf{f}\n$$\nwith the coefficient $\\alpha = \\frac{\\eta}{\\Delta t} + \\frac{G_c}{\\ell} + 2\\,H^n$. The matrices $\\mathbf{K}_{\\nabla}$, $\\mathbf{M}$, and vector $\\mathbf{f}$ are the standard element gradient matrix, mass matrix, and force vector for a one-dimensional linear element, respectively.\n\nThe algorithm for a single update step is as follows:\n1.  **Nucleation Criterion:** Check if the element is in an undamaged state, $\\mathbf{d}^{n-1} = \\mathbf{0}$. If so, compare the history field value $H^n$ to the critical nucleation threshold $H_{\\text{crit}} = \\frac{G_c}{2\\,\\ell}$. If $H^n \\le H_{\\text{crit}}$, no damage nucleates, and we set $\\mathbf{d}^n = \\mathbf{d}^{n-1} = \\mathbf{0}$. Otherwise, or if the element was already damaged, proceed to the next step.\n2.  **Assembly:** Construct the matrices $\\mathbf{K}_{\\nabla}$, $\\mathbf{M}$, and vector $\\mathbf{f}$ based on the element length $L$. Calculate the scalar $\\alpha$. Assemble the system matrix $\\mathbf{K}$ and the right-hand side vector $\\mathbf{r}$ using the given formulae and input parameters.\n3.  **Solve:** Solve the $2 \\times 2$ linear system $\\mathbf{K}\\,\\mathbf{d}^n = \\mathbf{r}$ to obtain a candidate nodal damage vector $\\mathbf{d}^n$. The matrix $\\mathbf{K}$ is guaranteed to be positive definite, ensuring a unique solution exists.\n4.  **Enforce Constraints:** The damage field must be non-decreasing (irreversibility) and bounded by $0$ and $1$. These constraints, arising from Karush-Kuhn-Tucker conditions, are enforced at the nodal level via a post-processing step: \n    $$\n    \\mathbf{d}^n \\leftarrow \\min\\!\\left(1, \\max\\!\\left(\\mathbf{d}^n, \\mathbf{d}^{n-1}\\right)\\right)\n    $$ \n    This operation is applied componentwise to the elements of the nodal vector $\\mathbf{d}^n$.\n\nThis procedure is systematically applied to each test case provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_damage_update(L, Gc, l, eta, dt, Hn, d_prev):\n    \"\"\"\n    Computes the damage field update for a single 1D finite element.\n\n    Args:\n        L (float): Element length.\n        Gc (float): Critical energy release parameter.\n        l (float): Regularization length.\n        eta (float): Viscous regularization parameter.\n        dt (float): Time step size.\n        Hn (float): History field value at step n.\n        d_prev (np.ndarray): Nodal damage values from step n-1, shape (2,).\n\n    Returns:\n        np.ndarray: Updated nodal damage values at step n, shape (2,).\n    \"\"\"\n    \n    # 1. Nucleation Criterion\n    # Check if starting from an undamaged state\n    if np.all(d_prev == 0.0):\n        H_crit = Gc / (2.0 * l)\n        if Hn = H_crit:\n            return d_prev\n\n    # 2. Assembly\n    # Define standard 1D linear element matrices\n    K_nabla = (1.0 / L) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n    M = (L / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n    f = (L / 2.0) * np.array([1.0, 1.0])\n\n    # Calculate coefficient alpha\n    alpha = (eta / dt) + (Gc / l) + (2.0 * Hn)\n\n    # Assemble the system matrix K and right-hand side vector r\n    K = Gc * l * K_nabla + alpha * M\n    r = (eta / dt) * M @ d_prev + (2.0 * Hn) * f\n\n    # 3. Solve\n    d_n_candidate = np.linalg.solve(K, r)\n\n    # 4. Enforce Constraints\n    d_n = np.maximum(d_n_candidate, d_prev)\n    d_n = np.minimum(1.0, d_n)\n    \n    return d_n\n\ndef solve():\n    \"\"\"\n    Runs the test suite for the phase-field damage update problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'L': 1.0, 'Gc': 1.0, 'l': 0.1, 'eta': 0.02, 'dt': 0.1, 'Hn': 6.0, 'd_prev': np.array([0.0, 0.0])},\n        {'L': 1.0, 'Gc': 1.0, 'l': 0.1, 'eta': 0.02, 'dt': 0.1, 'Hn': 3.0, 'd_prev': np.array([0.0, 0.0])},\n        {'L': 1.0, 'Gc': 1.0, 'l': 0.1, 'eta': 0.02, 'dt': 0.1, 'Hn': 3.0, 'd_prev': np.array([0.4, 0.4])},\n        {'L': 0.5, 'Gc': 2.0, 'l': 0.05, 'eta': 0.000001, 'dt': 0.001, 'Hn': 50.0, 'd_prev': np.array([0.1, 0.1])},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_damage_update(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{r[0]:.6f},{r[1]:.6f}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3587473"}]}