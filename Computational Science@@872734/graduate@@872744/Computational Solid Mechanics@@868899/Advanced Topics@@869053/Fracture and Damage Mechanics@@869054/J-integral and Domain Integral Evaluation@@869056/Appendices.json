{"hands_on_practices": [{"introduction": "This first practice provides a fundamental exercise in applying the domain integral method, a cornerstone of computational fracture mechanics. Using pre-defined stress and strain energy fields, similar to what one would obtain from a finite element analysis, you will calculate the $J$-integral for a crack under both plane stress and plane strain conditions. This exercise reinforces the theoretical derivation of the domain integral from the Eshelby energy-momentum tensor and provides insight into how plane-state assumptions influence fracture parameters. [@problem_id:3576843]", "problem": "A cracked, homogeneous, linearly elastic, transversely isotropic solid is modeled in two-dimensional settings under plane stress and plane strain. The axis of transverse isotropy is normal to the plane, so the in-plane response is isotropic while the out-of-plane coupling distinguishes plane stress from plane strain. Consider a straight crack lying along the negative $x$-axis with its tip at the origin. Around the tip, a rectangular computational domain is used for a domain-integral evaluation: $\\Omega = \\{(x,y)\\,|\\,0 \\le x \\le L,\\,-b \\le y \\le b\\}$, with $L = 0.02\\,\\mathrm{m}$ and $b = 0.01\\,\\mathrm{m}$. A scalar weight function is prescribed as $q(x,y) = 1 - x/L$, which satisfies $q=1$ at the inner surface near the tip and $q=0$ at the far-side boundary $x=L$.\n\nIn each two-dimensional setting, the Finite Element (FE) post-processing provides the following field quantities over $\\Omega$:\n- The strain energy density $W(x,y)$ (units $\\mathrm{J/m^3}$).\n- The contracted mechanical power density $P(x,y) = \\sum_{i=1}^{2} \\sigma_{i1}(x,y)\\,\\frac{\\partial u_i}{\\partial x_1}(x,y)$ (units $\\mathrm{J/m^3}$), where $u_i$ are the displacement components and $\\sigma_{ij}$ are the Cauchy stress components.\n\nFor the plane stress case, the FE-computed fields are\n$$\nW_{\\mathrm{ps}}(x,y) = \\alpha_{\\mathrm{ps}} + \\beta_{\\mathrm{ps}}\\,x + \\gamma_{\\mathrm{ps}}\\,y^{2}, \\quad\nP_{\\mathrm{ps}}(x,y) = \\delta_{\\mathrm{ps}} + \\varepsilon_{\\mathrm{ps}}\\,x + \\zeta_{\\mathrm{ps}}\\,y^{2},\n$$\nwith constants\n$$\n\\alpha_{\\mathrm{ps}} = 3.40 \\times 10^{6},\\quad\n\\beta_{\\mathrm{ps}} = 1.20 \\times 10^{8},\\quad\n\\gamma_{\\mathrm{ps}} = 4.00 \\times 10^{9},\\quad\n\\delta_{\\mathrm{ps}} = 4.50 \\times 10^{6},\\quad\n\\varepsilon_{\\mathrm{ps}} = 1.10 \\times 10^{8},\\quad\n\\zeta_{\\mathrm{ps}} = 3.70 \\times 10^{9}.\n$$\n\nFor the plane strain case, the FE-computed fields are\n$$\nW_{\\mathrm{pe}}(x,y) = \\alpha_{\\mathrm{pe}} + \\beta_{\\mathrm{pe}}\\,x + \\gamma_{\\mathrm{pe}}\\,y^{2}, \\quad\nP_{\\mathrm{pe}}(x,y) = \\delta_{\\mathrm{pe}} + \\varepsilon_{\\mathrm{pe}}\\,x + \\zeta_{\\mathrm{pe}}\\,y^{2},\n$$\nwith constants\n$$\n\\alpha_{\\mathrm{pe}} = 3.90 \\times 10^{6},\\quad\n\\beta_{\\mathrm{pe}} = 1.00 \\times 10^{8},\\quad\n\\gamma_{\\mathrm{pe}} = 3.80 \\times 10^{9},\\quad\n\\delta_{\\mathrm{pe}} = 4.90 \\times 10^{6},\\quad\n\\varepsilon_{\\mathrm{pe}} = 1.05 \\times 10^{8},\\quad\n\\zeta_{\\mathrm{pe}} = 3.90 \\times 10^{9}.\n$$\n\nStarting from conservation of mechanical energy and the definition of the Eshelby energy-momentum tensor, derive the domain-integral representation of the $J$-integral component in the $x$-direction and use it, together with the given weight function $q(x,y)$, to evaluate the $J$-values for plane stress and plane strain:\n$$\nJ_{\\mathrm{ps}} \\quad \\text{and} \\quad J_{\\mathrm{pe}},\n$$\nrespectively, over the domain $\\Omega$. Then, compute the ratio\n$$\nR = \\frac{J_{\\mathrm{pe}}}{J_{\\mathrm{ps}}}.\n$$\n\nReport the single numerical value of $R$ rounded to four significant figures. The ratio is dimensionless. Do not report intermediate $J$-values; only report $R$ as instructed.", "solution": "The problem is validated as follows.\n\n**Step 1: Extract Givens**\n\n- **Material and Geometry**: A cracked, homogeneous, linearly elastic, transversely isotropic solid in 2D. The axis of transverse isotropy is normal to the plane, resulting in isotropic in-plane response. A straight crack lies along the negative $x$-axis with its tip at the origin.\n- **Computational Domain**: A rectangle $\\Omega = \\{(x,y)\\,|\\,0 \\le x \\le L,\\,-b \\le y \\le b\\}$, with $L = 0.02\\,\\mathrm{m}$ and $b = 0.01\\,\\mathrm{m}$.\n- **Weight Function**: $q(x,y) = 1 - x/L$.\n- **Field Quantities**:\n    - Strain energy density: $W(x,y)$\n    - Contracted mechanical power density: $P(x,y) = \\sum_{i=1}^{2} \\sigma_{i1}(x,y)\\,\\frac{\\partial u_i}{\\partial x_1}(x,y)$\n- **Plane Stress (ps) Fields**:\n    - $W_{\\mathrm{ps}}(x,y) = \\alpha_{\\mathrm{ps}} + \\beta_{\\mathrm{ps}}\\,x + \\gamma_{\\mathrm{ps}}\\,y^{2}$\n    - $P_{\\mathrm{ps}}(x,y) = \\delta_{\\mathrm{ps}} + \\varepsilon_{\\mathrm{ps}}\\,x + \\zeta_{\\mathrm{ps}}\\,y^{2}$\n    - Constants: $\\alpha_{\\mathrm{ps}} = 3.40 \\times 10^{6}$, $\\beta_{\\mathrm{ps}} = 1.20 \\times 10^{8}$, $\\gamma_{\\mathrm{ps}} = 4.00 \\times 10^{9}$, $\\delta_{\\mathrm{ps}} = 4.50 \\times 10^{6}$, $\\varepsilon_{\\mathrm{ps}} = 1.10 \\times 10^{8}$, $\\zeta_{\\mathrm{ps}} = 3.70 \\times 10^{9}$.\n- **Plane Strain (pe) Fields**:\n    - $W_{\\mathrm{pe}}(x,y) = \\alpha_{\\mathrm{pe}} + \\beta_{\\mathrm{pe}}\\,x + \\gamma_{\\mathrm{pe}}\\,y^{2}$\n    - $P_{\\mathrm{pe}}(x,y) = \\delta_{\\mathrm{pe}} + \\varepsilon_{\\mathrm{pe}}\\,x + \\zeta_{\\mathrm{pe}}\\,y^{2}$\n    - Constants: $\\alpha_{\\mathrm{pe}} = 3.90 \\times 10^{6}$, $\\beta_{\\mathrm{pe}} = 1.00 \\times 10^{8}$, $\\gamma_{\\mathrm{pe}} = 3.80 \\times 10^{9}$, $\\delta_{\\mathrm{pe}} = 4.90 \\times 10^{6}$, $\\varepsilon_{\\mathrm{pe}} = 1.05 \\times 10^{8}$, $\\zeta_{\\mathrm{pe}} = 3.90 \\times 10^{9}$.\n- **Task**: Derive the domain-integral representation of the $J$-integral component in the $x$-direction ($J_1$, hereafter denoted as $J$). Use it to evaluate $J_{\\mathrm{ps}}$ and $J_{\\mathrm{pe}}$ over $\\Omega$. Finally, compute the ratio $R = J_{\\mathrm{pe}} / J_{\\mathrm{ps}}$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is set within the established framework of linear elastic fracture mechanics. The concepts of $J$-integral, Eshelby tensor, domain integral evaluation, plane stress, and plane strain are fundamental to this field. The material properties (transversely isotropic) are physically realistic. The provided field functions are simple polynomials, which is a common representation for post-processed finite element results.\n- **Well-Posed**: The problem is well-defined. All necessary data, functions, and constants are provided. The objective is clear: to calculate a specific ratio based on these inputs. The structure allows for a unique solution. The functional forms of $W$ and $P$ (depending on $x$ and $y^2$) are consistent with the physical symmetries of a Mode I crack problem, for which the domain integral method is well-suited.\n- **Objective**: The problem is stated in precise, quantitative terms. There are no subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\n\nThe problem is scientifically sound, well-posed, and objective. It is a standard problem in computational fracture mechanics. The problem is declared **valid**.\n\n**Solution**\n\nThe $J$-integral is defined as a path-independent contour integral around a crack tip. For a crack along the negative $x_1$-axis, its $x_1$-component is given by:\n$$ J = \\int_{\\Gamma} (W n_1 - T_i \\frac{\\partial u_i}{\\partial x_1}) d\\Gamma $$\nwhere $\\Gamma$ is a counter-clockwise contour enclosing the tip, $W$ is the strain energy density, $u_i$ are displacements, $T_i = \\sigma_{ij}n_j$ are tractions, and $n_j$ are components of the outward normal to $\\Gamma$.\n\nThe definition of the Eshelby energy-momentum tensor is:\n$$ \\Sigma_{jk} = W \\delta_{jk} - \\sigma_{ij} \\frac{\\partial u_i}{\\partial x_k} $$\nThe $J$-integral can be expressed as $J = \\int_{\\Gamma} \\Sigma_{j1} n_j d\\Gamma$. For a homogeneous elastic material in static equilibrium with no body forces, conservation of energy leads to the property that the divergence of the Eshelby tensor is zero: $\\frac{\\partial \\Sigma_{jk}}{\\partial x_j} = 0$.\n\nThis property allows the contour integral to be converted into a domain integral over an area $A$ surrounding the crack tip, using a smooth weight function $q$ that is $1$ at the crack tip and $0$ on the outer boundary of $A$. The general domain-integral form is:\n$$ J = \\int_{A} \\left( \\sigma_{ij} \\frac{\\partial u_i}{\\partial x_1} \\frac{\\partial q}{\\partial x_j} - W \\frac{\\partial q}{\\partial x_1} \\right) dA $$\nThe problem specifies the weight function $q(x,y) = 1 - x/L$, where $x_1=x$. The partial derivatives of $q$ are:\n$$ \\frac{\\partial q}{\\partial x_1} = \\frac{\\partial q}{\\partial x} = -\\frac{1}{L} $$\n$$ \\frac{\\partial q}{\\partial x_2} = \\frac{\\partial q}{\\partial y} = 0 $$\nSubstituting these into the domain integral expression for $J$:\n$$ J = \\int_{A} \\left( \\sigma_{i1} \\frac{\\partial u_i}{\\partial x_1} \\left(-\\frac{1}{L}\\right) - W \\left(-\\frac{1}{L}\\right) \\right) dA $$\n$$ J = \\frac{1}{L} \\int_{A} \\left( W - \\sum_{i=1}^{2} \\sigma_{i1} \\frac{\\partial u_i}{\\partial x_1} \\right) dA $$\nThe problem defines the quantity $P(x,y) = \\sum_{i=1}^{2} \\sigma_{i1}(x,y)\\,\\frac{\\partial u_i}{\\partial x_1}(x,y)$. Thus, the expression for $J$ simplifies to:\n$$ J = \\frac{1}{L} \\int_{A} (W(x,y) - P(x,y)) dA $$\nThis derivation is valid under the assumption that boundary terms arising from the divergence theorem cancel, which is true for a Mode I crack configuration. The given functional forms for $W$ and $P$ (even functions of $y$) are consistent with Mode I symmetry.\n\nThe integral is to be evaluated over the domain $\\Omega = \\{(x,y)\\,|\\,0 \\le x \\le L,\\,-b \\le y \\le b\\}$.\nLet's first compute the integral symbolically. Let $W(x,y) - P(x,y) = (\\alpha-\\delta) + (\\beta-\\varepsilon)x + (\\gamma-\\zeta)y^2$.\n$$ J = \\frac{1}{L} \\int_0^L \\int_{-b}^b \\left[ (\\alpha-\\delta) + (\\beta-\\varepsilon)x + (\\gamma-\\zeta)y^2 \\right] dy dx $$\nIntegrate with respect to $y$:\n$$ \\int_{-b}^b \\left[ ((\\alpha-\\delta) + (\\beta-\\varepsilon)x) + (\\gamma-\\zeta)y^2 \\right] dy = \\left[ ((\\alpha-\\delta) + (\\beta-\\varepsilon)x)y + (\\gamma-\\zeta)\\frac{y^3}{3} \\right]_{-b}^b $$\n$$ = 2b ((\\alpha-\\delta) + (\\beta-\\varepsilon)x) + \\frac{2b^3}{3}(\\gamma-\\zeta) $$\nNow, integrate with respect to $x$:\n$$ \\int_0^L \\left[ 2b ((\\alpha-\\delta) + (\\beta-\\varepsilon)x) + \\frac{2b^3}{3}(\\gamma-\\zeta) \\right] dx $$\n$$ = \\left[ 2b \\left( (\\alpha-\\delta)x + (\\beta-\\varepsilon)\\frac{x^2}{2} \\right) + \\frac{2b^3}{3}(\\gamma-\\zeta)x \\right]_0^L $$\n$$ = 2b \\left( (\\alpha-\\delta)L + (\\beta-\\varepsilon)\\frac{L^2}{2} \\right) + \\frac{2b^3}{3}(\\gamma-\\zeta)L $$\nFinally, divide by $L$:\n$$ J = \\frac{1}{L} \\left[ 2b \\left( (\\alpha-\\delta)L + (\\beta-\\varepsilon)\\frac{L^2}{2} \\right) + \\frac{2b^3}{3}(\\gamma-\\zeta)L \\right] $$\n$$ J = 2b \\left( (\\alpha-\\delta) + (\\beta-\\varepsilon)\\frac{L}{2} \\right) + \\frac{2b^3}{3}(\\gamma-\\zeta) $$\n\nNow, we evaluate $J$ for the plane stress and plane strain cases.\nGiven values: $L = 0.02\\,\\mathrm{m}$, $b = 0.01\\,\\mathrm{m}$. Note: the provided coefficients result in an unphysical negative J-integral. We proceed with the calculation as specified, as the final requested ratio remains valid.\n\n**Plane Stress Case ($J_{\\mathrm{ps}}$)**\nThe differences in coefficients are:\n$\\alpha_{\\mathrm{ps}} - \\delta_{\\mathrm{ps}} = (3.40 - 4.50) \\times 10^{6} = -1.10 \\times 10^{6}$\n$\\beta_{\\mathrm{ps}} - \\varepsilon_{\\mathrm{ps}} = (1.20 - 1.10) \\times 10^{8} = 0.10 \\times 10^{8} = 1.0 \\times 10^{7}$\n$\\gamma_{\\mathrm{ps}} - \\zeta_{\\mathrm{ps}} = (4.00 - 3.70) \\times 10^{9} = 0.30 \\times 10^{9} = 3.0 \\times 10^{8}$\n\nSubstitute these into the formula for $J$:\n$$ J_{\\mathrm{ps}} = 2(0.01) \\left( (-1.10 \\times 10^6) + (1.0 \\times 10^7)\\frac{0.02}{2} \\right) + \\frac{2(0.01)^3}{3}(3.0 \\times 10^8) $$\n$$ J_{\\mathrm{ps}} = 0.02 \\left( -1.10 \\times 10^6 + (1.0 \\times 10^7)(0.01) \\right) + \\frac{2 \\times 10^{-6}}{3}(3.0 \\times 10^8) $$\n$$ J_{\\mathrm{ps}} = 0.02 \\left( -1.10 \\times 10^6 + 1.0 \\times 10^5 \\right) + \\frac{6.0 \\times 10^2}{3} $$\n$$ J_{\\mathrm{ps}} = 0.02 (-1.0 \\times 10^6) + 200 $$\n$$ J_{\\mathrm{ps}} = -20000 + 200 = -19800 $$\n\n**Plane Strain Case ($J_{\\mathrm{pe}}$)**\nThe differences in coefficients are:\n$\\alpha_{\\mathrm{pe}} - \\delta_{\\mathrm{pe}} = (3.90 - 4.90) \\times 10^{6} = -1.00 \\times 10^{6}$\n$\\beta_{\\mathrm{pe}} - \\varepsilon_{\\mathrm{pe}} = (1.00 - 1.05) \\times 10^{8} = -0.05 \\times 10^{8} = -5.0 \\times 10^{6}$\n$\\gamma_{\\mathrm{pe}} - \\zeta_{\\mathrm{pe}} = (3.80 - 3.90) \\times 10^{9} = -0.10 \\times 10^{9} = -1.0 \\times 10^{8}$\n\nSubstitute these into the formula for $J$:\n$$ J_{\\mathrm{pe}} = 2(0.01) \\left( (-1.00 \\times 10^6) + (-5.0 \\times 10^6)\\frac{0.02}{2} \\right) + \\frac{2(0.01)^3}{3}(-1.0 \\times 10^8) $$\n$$ J_{\\mathrm{pe}} = 0.02 \\left( -1.00 \\times 10^6 - (5.0 \\times 10^6)(0.01) \\right) - \\frac{2 \\times 10^{-6}}{3}(1.0 \\times 10^8) $$\n$$ J_{\\mathrm{pe}} = 0.02 \\left( -1.00 \\times 10^6 - 5.0 \\times 10^4 \\right) - \\frac{2.0 \\times 10^2}{3} $$\n$$ J_{\\mathrm{pe}} = 0.02 (-1.05 \\times 10^6) - \\frac{200}{3} $$\n$$ J_{\\mathrm{pe}} = -21000 - \\frac{200}{3} = -\\frac{63000}{3} - \\frac{200}{3} = -\\frac{63200}{3} $$\n\n**Ratio Calculation**\nFinally, we compute the ratio $R = J_{\\mathrm{pe}} / J_{\\mathrm{ps}}$:\n$$ R = \\frac{-63200/3}{-19800} = \\frac{63200}{3 \\times 19800} = \\frac{632}{3 \\times 198} = \\frac{632}{594} $$\n$$ R \\approx 1.06397306... $$\nRounding to four significant figures, we get:\n$$ R \\approx 1.064 $$", "answer": "$$\n\\boxed{1.064}\n$$", "id": "3576843"}, {"introduction": "Moving beyond the idealizations of Linear Elastic Fracture Mechanics (LEFM), this practice delves into the application of the $J$-integral within the context of cohesive zone models. You will derive and implement a domain integral formulation that explicitly accounts for the energy dissipated by cohesive tractions along the fracture process zone. This exercise is crucial for understanding how the macroscopic energy release rate connects to the microscopic work of separation and for verifying that cohesive models correctly converge to LEFM behavior in the limit of small-scale damage. [@problem_id:3576859]", "problem": "Consider a two-dimensional, linear elastic, isotropic body under Mode I loading with a straight crack aligned along the $x$-axis. The crack tip is at the origin and a cohesive zone of finite extent lies ahead of the tip on the crack plane. The material follows small-strain kinematics and plane stress conditions. The crack faces within the cohesive zone experience a traction that depends on the local opening displacement through a traction-separation law $T(\\delta)$. The task is to formulate and evaluate the domain form of the $J$-integral (commonly called the energy flux into the crack tip) in the presence of a cohesive zone and to verify its convergence to the Linear Elastic Fracture Mechanics (LEFM) value as the cohesive zone size tends to zero.\n\nStart from fundamental mechanical principles and core definitions:\n\n- The strain energy density is $W = \\tfrac{1}{2} \\sigma_{ij} \\varepsilon_{ij}$, where $\\sigma_{ij}$ and $\\varepsilon_{ij}$ are the Cauchy stress tensor and small-strain tensor, respectively.\n- The Eshelby energy-momentum tensor is $T_{jk}^{\\mathrm{E}} = W \\delta_{jk} - \\sigma_{ij} \\dfrac{\\partial u_i}{\\partial x_k}$, where $u_i$ are the displacement components and $\\delta_{jk}$ is the Kronecker delta.\n- The $J$-integral is the energy flux into the crack tip per unit thickness, defined by a path-independent integral in conservative, elastic settings, and can be expressed in domain form using a smooth weighting function $q(\\mathbf{x})$ that equals $1$ at the tip and decays to $0$ away from the tip.\n\nYou must derive a consistent domain-integral form of $J$ that includes the energetic contribution of the cohesive tractions. Assume the crack is stationary and lies along the $x$-axis with a cohesive zone extending from $x = 0$ to $x = \\ell_c$. Let the weighting function be $q(x) = \\max\\!\\left(1 - \\left(\\dfrac{x}{R}\\right)^m, 0\\right)$ for $x \\ge 0$, where $R  0$ is a chosen radius that localizes the domain integral and $m \\ge 1$ controls the decay. For a one-dimensional reduction along the crack path under Mode I opening, let the crack-face opening profile within the cohesive zone be $\\delta(x) = \\delta_c \\left(1 - \\left(\\dfrac{x}{\\ell_c}\\right)^p\\right)$ for $x \\in [0,\\ell_c]$ with $p \\ge 1$ and tip opening $\\delta(0) = \\delta_c$. The traction-separation law $T(\\delta)$ is strictly monotonic nonincreasing over $[0,\\delta_c]$ and vanishes at $\\delta = \\delta_c$ for softening laws.\n\nTasks:\n\n1. Derive the domain-integral expression of $J$ that includes the cohesive contribution using the Eshelby tensor and the divergence theorem, starting from the definition $J = \\int_\\Gamma T_{1k}^{\\mathrm{E}} n_k \\,\\mathrm{d}\\Gamma$ over a contour $\\Gamma$ enclosing the crack tip, and transforming it into a domain form over a neighborhood $\\Omega$ with the weighting function $q(\\mathbf{x})$. In your derivation, explicitly show how internal tractions on the cohesive crack faces contribute an additional term. Specialize your expression to the one-dimensional crack-path reduction under Mode I, and argue that under the assumed setting the cohesive contribution reduces to\n$$\nJ_{\\text{coh}}(q) \\;=\\; \\int_0^{\\ell_c} T(\\delta(x))\\, q(x)\\, \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| \\,\\mathrm{d}x \\, .\n$$\n2. Explain why, under displacement-controlled equilibrium at onset of crack growth, the LEFM energy release rate per unit thickness is $J_{\\text{LEFM}} = \\dfrac{K_I^2}{E'}$ with $K_I$ the Mode I stress intensity factor and $E'$ the effective modulus, and why choosing the remote stress to satisfy $J_{\\text{LEFM}} = \\Gamma$ implies $J_{\\text{LEFM}}$ equals the fracture energy $\\Gamma = \\int_0^{\\delta_c} T(\\delta)\\,\\mathrm{d}\\delta$. Here use plane stress so $E' = E$.\n3. Provide a numerical program that evaluates the weighted cohesive domain integral $J_{\\text{coh}}(q)$ for the given $q(x)$, $T(\\delta)$, and $\\delta(x)$, and compares it to the LEFM value $J_{\\text{LEFM}}$ for a set of prescribed test cases. Use numerical quadrature along $x \\in [0, \\min(\\ell_c,R)]$ and compute the absolute difference $\\left|J_{\\text{LEFM}} - J_{\\text{coh}}(q)\\right|$.\n4. Verify and discuss numerically the convergence $\\left|J_{\\text{LEFM}} - J_{\\text{coh}}(q)\\right| \\to 0$ as $\\ell_c \\to 0$, for fixed $R$ and smooth $q(x)$ with $q(0) = 1$. The output must be presented in the specified format.\n\nPhysical and numerical units:\n\n- Use the International System of Units (SI). Report $J$ and absolute differences in $\\mathrm{N/m}$, stresses in $\\mathrm{Pa}$ (Pascal), lengths in $\\mathrm{m}$ (meters).\n- Express angles, if any arise, in radians, though none are required for this one-dimensional reduction.\n- Do not use percentages; where ratios are needed, use decimals.\n\nTest suite and parameters:\n\n- Case $1$ (happy path, linear softening): $T(\\delta) = \\sigma_0 \\left(1 - \\dfrac{\\delta}{\\delta_c}\\right)$ for $\\delta \\in [0,\\delta_c]$, with $\\sigma_0 = 3.0 \\times 10^6\\,\\mathrm{Pa}$, $\\delta_c = 5.0 \\times 10^{-5}\\,\\mathrm{m}$, $\\ell_c = 5.0 \\times 10^{-4}\\,\\mathrm{m}$, $p = 1$, $R = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $m = 2$, elastic modulus $E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$, crack half-length $a = 1.0 \\times 10^{-1}\\,\\mathrm{m}$.\n- Case $2$ (boundary condition, very small cohesive zone): same linear softening as Case $1$ but $\\ell_c = 1.0 \\times 10^{-6}\\,\\mathrm{m}$.\n- Case $3$ (edge case, exponential law and large cohesive zone): $T(\\delta) = \\sigma_0 \\exp\\!\\left(-\\dfrac{\\delta}{\\delta_c}\\right)$ for $\\delta \\in [0,\\delta_c]$, with $\\sigma_0 = 5.0 \\times 10^6\\,\\mathrm{Pa}$, $\\delta_c = 2.0 \\times 10^{-5}\\,\\mathrm{m}$, $\\ell_c = 1.0 \\times 10^{-2}\\,\\mathrm{m}$, $p = 1$, $R = 1.0 \\times 10^{-2}\\,\\mathrm{m}$, $m = 2$, elastic modulus $E = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$, crack half-length $a = 1.0 \\times 10^{-1}\\,\\mathrm{m}$.\n- Case $4$ (convergence check, exponential law with very small cohesive zone): same exponential law as Case $3$ but $\\ell_c = 1.0 \\times 10^{-6}\\,\\mathrm{m}$, $R = 1.0 \\times 10^{-3}\\,\\mathrm{m}$.\n\nFor each case, set the remote uniform stress $\\sigma_\\infty$ such that $J_{\\text{LEFM}} = \\Gamma$, i.e., choose $\\sigma_\\infty = \\sqrt{\\dfrac{E\\, \\Gamma}{\\pi a}}$ and compute $J_{\\text{LEFM}} = \\dfrac{(\\sigma_\\infty \\sqrt{\\pi a})^2}{E}$, yielding $J_{\\text{LEFM}} = \\Gamma$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the absolute differences $\\left|J_{\\text{LEFM}} - J_{\\text{coh}}(q)\\right|$ for Cases $1$ through $4$ as a comma-separated list enclosed in square brackets and in $\\mathrm{N/m}$, for example, $\\left[ d_1, d_2, d_3, d_4 \\right]$ where each $d_i$ is a floating-point number representing the absolute difference in $\\mathrm{N/m}$.", "solution": "The problem is valid as it is scientifically grounded in the principles of fracture mechanics, is well-posed with sufficient and consistent data, and is objective in its formulation. We may therefore proceed with a complete solution.\n\nThe problem asks for the formulation and numerical evaluation of the domain integral form of the $J$-integral in the presence of a cohesive zone. This requires a multistep process involving theoretical derivation, conceptual explanation, and numerical implementation.\n\n**1. Derivation of the Cohesive Contribution to the $J$-integral**\n\nThe $J$-integral is fundamentally defined as the energy release rate associated with a virtual crack extension. In a purely elastic body, its value can be computed via a contour integral around the crack tip, $J = \\int_\\Gamma (W n_1 - t_k u_{k,1}) d\\Gamma$, where $W$ is the strain energy density, $\\mathbf{n}$ is the outward normal to the contour $\\Gamma$, $t_k = \\sigma_{kj}n_j$ are the traction components on $\\Gamma$, and $u_{k,1} = \\partial u_k / \\partial x_1$, assuming the crack lies along the $x_1$-axis. For a homogeneous elastic material, this integral is path-independent.\n\nUsing the divergence theorem in conjunction with a smooth weighting function $q(\\mathbf{x})$, where $q=1$ at the crack tip and $q=0$ on the outer boundary of an integration domain $\\Omega$, the contour integral can be converted into a domain integral. For a purely elastic material, this is:\n$$\nJ = \\int_\\Omega \\left( \\sigma_{ij}\\frac{\\partial u_i}{\\partial x_1} - W \\delta_{1j} \\right) \\frac{\\partial q}{\\partial x_j} d\\Omega\n$$\nWhen a cohesive zone is present, the material region contains a surface of discontinuity where energy is dissipated through the process of decohesion. The total energy release rate must account for this dissipation. A full derivation from first principles is intricate, but we can provide a physical argument for the form of the cohesive contribution, as requested.\n\nThe total energy dissipated per unit area to fully separate the two crack faces is the fracture energy, $\\Gamma$. It is defined by the work done by the cohesive tractions $T$ over the full range of separation $\\delta$:\n$$\n\\Gamma = \\int_0^{\\delta_c} T(\\delta) \\,d\\delta\n$$\nwhere $\\delta_c$ is the critical separation at which tractions vanish. We can express this integral over the length of the cohesive zone, $\\ell_c$, by a change of variables using the crack opening profile $\\delta(x)$. Given that $\\delta(x)$ is a decreasing function of $x$, its derivative $\\mathrm{d}\\delta/\\mathrm{d}x$ is negative, so $|\\mathrm{d}\\delta/\\mathrm{d}x| = -\\mathrm{d}\\delta/\\mathrm{d}x$. The integral becomes:\n$$\n\\Gamma = \\int_0^{\\ell_c} T(\\delta(x)) \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| \\,dx\n$$\nThis quantity represents the spatial density of energy dissipation along the cohesive zone. The domain integral method for $J$ uses the weighting function $q(x)$ to localize the energy calculation to the crack tip region. The function $q(x)$ can be interpreted as a virtual crack advance field. Therefore, the contribution of the cohesive zone to the overall domain integral, which we denote $J_{\\text{coh}}(q)$, is the integral of the spatial energy dissipation rate weighted by this virtual advance field $q(x)$. This provides a compelling physical justification for the given expression:\n$$\nJ_{\\text{coh}}(q) = \\int_0^{\\ell_c} T(\\delta(x))\\, q(x)\\, \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| \\,\\mathrm{d}x\n$$\nThis expression represents the work of separation within the cohesive zone, weighted by the $q$-function. In the limit of a very small cohesive zone ($\\ell_c \\to 0$), the integration occurs over a region where $x \\approx 0$. Since $q(x)$ is smooth and $q(0)=1$, $q(x) \\approx 1$ over the integration domain. In this case, $J_{\\text{coh}}(q)$ converges to the total fracture energy $\\Gamma$:\n$$\n\\lim_{\\ell_c \\to 0} J_{\\text{coh}}(q) = \\int_0^{\\ell_c} T(\\delta(x)) \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| \\,dx = \\Gamma\n$$\n\n**2. Relation between $J_{\\text{LEFM}}$ and Fracture Energy $\\Gamma$**\n\nIn Linear Elastic Fracture Mechanics (LEFM), the state of stress and strain near a crack tip is characterized by the stress intensity factor, $K$. For Mode I loading, this is $K_I$. The energy release rate, $J$, is related to $K_I$ by:\n$$\nJ_{\\text{LEFM}} = \\frac{K_I^2}{E'}\n$$\nwhere $E'$ is the effective elastic modulus. For the specified plane stress condition, $E' = E$.\n\nFor a crack of half-length $a$ in a large plate subjected to a remote uniform tensile stress $\\sigma_\\infty$, the stress intensity factor is given by $K_I = \\sigma_\\infty \\sqrt{\\pi a}$. Substituting this into the expression for $J_{\\text{LEFM}}$ gives:\n$$\nJ_{\\text{LEFM}} = \\frac{(\\sigma_\\infty \\sqrt{\\pi a})^2}{E} = \\frac{\\sigma_\\infty^2 \\pi a}{E}\n$$\nThe fundamental criterion for fracture in LEFM is that crack growth occurs when the energy release rate $J$ reaches a critical value, the material's fracture toughness, denoted $J_c$ or $G_c$. In the context of cohesive zone models, this macroscopic fracture toughness is determined by the microscopic work of separation, which is the fracture energy $\\Gamma = \\int_0^{\\delta_c} T(\\delta) d\\delta$. Therefore, at the onset of crack growth, the LEFM condition is $J_{\\text{LEFM}} = \\Gamma$.\n\nThe problem specifies that the remote stress $\\sigma_\\infty$ should be chosen to satisfy this condition. By setting $J_{\\text{LEFM}} = \\Gamma$, we are essentially calibrating the far-field load to the specific point of incipient failure as predicted by the cohesive model's energy criterion.\n$$\n\\frac{\\sigma_\\infty^2 \\pi a}{E} = \\Gamma \\quad \\implies \\quad \\sigma_\\infty = \\sqrt{\\frac{E \\Gamma}{\\pi a}}\n$$\nBy using this value of $\\sigma_\\infty$ to calculate $J_{\\text{LEFM}}$, it is ensured by definition that $J_{\\text{LEFM}} = \\Gamma$. This procedure connects the far-field LEFM description to the local failure criterion defined by the cohesive law.\n\n**3. Numerical Evaluation Strategy**\n\nThe numerical task is to calculate the absolute difference $|\\Delta J| = |J_{\\text{LEFM}} - J_{\\text{coh}}(q)|$ for four test cases. The procedure is as follows:\n\nFirst, we determine $J_{\\text{LEFM}}$. As established, we set $J_{\\text{LEFM}} = \\Gamma$. The value of $\\Gamma$ is calculated by analytically integrating the given traction-separation law $T(\\delta)$:\n- For the linear law $T(\\delta) = \\sigma_0(1 - \\delta/\\delta_c)$:\n  $$\n  \\Gamma = \\int_0^{\\delta_c} \\sigma_0 \\left(1 - \\frac{\\delta}{\\delta_c}\\right) d\\delta = \\sigma_0 \\left[\\delta - \\frac{\\delta^2}{2\\delta_c}\\right]_0^{\\delta_c} = \\frac{1}{2}\\sigma_0\\delta_c\n  $$\n- For the exponential law $T(\\delta) = \\sigma_0 \\exp(-\\delta/\\delta_c)$:\n  $$\n  \\Gamma = \\int_0^{\\delta_c} \\sigma_0 \\exp\\left(-\\frac{\\delta}{\\delta_c}\\right) d\\delta = \\sigma_0 \\left[-\\delta_c \\exp\\left(-\\frac{\\delta}{\\delta_c}\\right)\\right]_0^{\\delta_c} = \\sigma_0 \\delta_c \\left(1 - e^{-1}\\right)\n  $$\n\nSecond, we evaluate $J_{\\text{coh}}(q)$ by numerical quadrature. The integrand is a function of $x$:\n$$\nf(x) = T(\\delta(x)) \\, q(x) \\, \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right|\n$$\nThe components of the integrand are:\n- $\\delta(x) = \\delta_c \\left(1 - \\left(\\frac{x}{\\ell_c}\\right)^p\\right)$\n- $\\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| = \\left|-p\\frac{\\delta_c}{\\ell_c}\\left(\\frac{x}{\\ell_c}\\right)^{p-1}\\right| = p\\frac{\\delta_c}{\\ell_c^p}x^{p-1}$\n- $q(x) = \\max\\left(1 - \\left(\\frac{x}{R}\\right)^m, 0\\right)$\n- $T(\\delta(x))$ depends on the specific law.\n\nThe integral for $J_{\\text{coh}}(q)$ is computed over $x \\in [0, \\min(\\ell_c, R)]$, since for $x  R$, $q(x)=0$ and the integrand vanishes. We will use a standard numerical integration routine for this purpose.\n\n**4. Numerical Convergence Verification**\n\nBy comparing Case 1 with Case 2, and Case 3 with Case 4, we examine the behavior as the cohesive zone length $\\ell_c$ becomes very small. As argued in Part 1, we expect $J_{\\text{coh}}(q)$ to converge to $\\Gamma$. Consequently, the difference $|\\Delta J| = |\\Gamma - J_{\\text{coh}}(q)|$ should approach $0$. The numerical results will serve to verify this theoretical convergence. Cases 2 and 4, which feature a very small $\\ell_c$, are expected to yield significantly smaller differences than Cases 1 and 3, respectively. This convergence validates that the cohesive zone model properly reduces to LEFM in the limit of small-scale yielding, where the process zone size is negligible compared to other characteristic lengths.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves for the absolute difference between the LEFM J-integral and its\n    cohesive domain integral counterpart for the four specified test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (case_name, T_law_type, params, geom_params)\n    # T_law_type: 'linear' or 'exponential'\n    # params: (sigma0, delta_c)\n    # geom_params: (lc, p, R, m, E, a)\n    test_cases = [\n        (\n            \"Case 1 (linear, large lc)\",\n            'linear',\n            (3.0e6, 5.0e-5),\n            (5.0e-4, 1, 1.0e-3, 2, 2.10e11, 1.0e-1)\n        ),\n        (\n            \"Case 2 (linear, small lc)\",\n            'linear',\n            (3.0e6, 5.0e-5),\n            (1.0e-6, 1, 1.0e-3, 2, 2.10e11, 1.0e-1)\n        ),\n        (\n            \"Case 3 (exponential, large lc)\",\n            'exponential',\n            (5.0e6, 2.0e-5),\n            (1.0e-2, 1, 1.0e-2, 2, 7.0e10, 1.0e-1)\n        ),\n        (\n            \"Case 4 (exponential, small lc)\",\n            'exponential',\n            (5.0e6, 2.0e-5),\n            (1.0e-6, 1, 1.0e-3, 2, 7.0e10, 1.0e-1)\n        ),\n    ]\n\n    results = []\n    \n    for case_name, t_law, params, geom_params in test_cases:\n        sigma0, delta_c = params\n        lc, p, R, m, _, _ = geom_params\n\n        # 1. Define Traction-Separation Law (TSL) and calculate Gamma (fracture energy)\n        if t_law == 'linear':\n            T_func = lambda delta: sigma0 * (1 - delta / delta_c) if 0 = delta = delta_c else 0\n            # Gamma = integral of T(delta) from 0 to delta_c\n            gamma = 0.5 * sigma0 * delta_c\n        elif t_law == 'exponential':\n            T_func = lambda delta: sigma0 * np.exp(-delta / delta_c) if delta >= 0 else 0\n            # Gamma = integral of T(delta) from 0 to delta_c\n            gamma = sigma0 * delta_c * (1 - np.exp(-1))\n        \n        # J_LEFM is set to be equal to Gamma\n        j_lefm = gamma\n\n        # 2. Define the integrand for the cohesive domain integral J_coh(q)\n        # delta(x) = delta_c * (1 - (x/lc)^p)\n        delta_x_func = lambda x: delta_c * (1 - (x / lc)**p)\n        \n        # |d(delta)/dx| = p * delta_c / lc^p * x^(p-1)\n        abs_d_delta_dx_func = lambda x: p * delta_c / (lc**p) * x**(p-1) if x > 0 else 0\n        \n        # q(x) = max(0, 1 - (x/R)^m)\n        q_func = lambda x: max(0, 1 - (x / R)**m)\n\n        # The full integrand f(x) = T(delta(x)) * q(x) * |d(delta)/dx|\n        def integrand(x):\n            if x  0 or x > lc:\n                return 0.0\n            \n            delta_val = delta_x_func(x)\n            T_val = T_func(delta_val)\n            q_val = q_func(x)\n            abs_d_delta_dx_val = abs_d_delta_dx_func(x)\n            \n            return T_val * q_val * abs_d_delta_dx_val\n\n        # 3. Numerically integrate to find J_coh(q)\n        # The integration limit is from 0 to min(lc, R) because q(x)=0 for x>R\n        upper_limit = min(lc, R)\n        j_coh_q, _ = quad(integrand, 0, upper_limit)\n\n        # 4. Compute the absolute difference and store the result\n        abs_diff = abs(j_lefm - j_coh_q)\n        results.append(abs_diff)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3576859"}, {"introduction": "In practical simulations of crack propagation, the computational mesh must evolve with the crack, requiring the transfer of field data between successive discretizations. This practice confronts the numerical challenge of maintaining the accuracy of the $J$-integral across remeshing steps. By using a manufactured solution, you will investigate how different mesh-to-mesh transfer operators impact the calculated energy release rate and quantify the cumulative error, providing essential insights into the stability and fidelity of computational fracture simulations. [@problem_id:3576818]", "problem": "You are tasked with studying the continuity of the energy release rate described by the $J$-integral under remeshing during crack propagation and to propose a mesh-to-mesh transfer operator for the domain integral form of $J$. Begin from first principles in computational solid mechanics: conservation of energy, balance of linear momentum, and the definition of the strain energy density. Use the divergence theorem to relate a contour integral to an area (domain) integral and articulate the energy-momentum balance tensor that arises from translational invariance. Do not use any shortcut formulas for the $J$-integral; derive the domain integral form from the fundamental base.\n\nTo enable a controlled numerical study without solving the full elasticity boundary value problem at each step, consider an annular domain around a crack tip. Let the crack tip be initially at the origin, and let the crack propagate along the positive $x$-axis. To eliminate the unphysical singularity at the crack core, exclude a circular inner region of radius $r_1$ and consider an annular weighting function that is unity inside the inner circle and decreases linearly to zero at an outer radius $r_2$.\n\nDefine the following manufactured fields for analysis:\n\n- Use isotropic linear elasticity under plane strain. Given elastic modulus $E$ and Poisson ratio $\\nu$, define the effective modulus $E' := E/(1-\\nu^2)$.\n\n- For a specified stress intensity factor $K_I$ with unit $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$, the exact energy release rate is $J_{\\mathrm{exact}} := K_I^2 / E'$, with unit $\\mathrm{N}/\\mathrm{m}$.\n\n- Define a manufactured energy-momentum flux density vector field $F:\\mathbb{R}^2 \\to \\mathbb{R}^2$ in polar coordinates $(r,\\theta)$ around the current crack tip as\n$$\nF(r,\\theta) := J_0\\, r^{-p} \\begin{bmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\sin\\left(\\frac{\\theta}{2}\\right) \\end{bmatrix},\n$$\nfor a fixed exponent $p$ satisfying $0  p  1$ and a scalar amplitude $J_0$ to be chosen so that the exact domain integral equals $J_{\\mathrm{exact}}$ when integrated continuously over the annulus with the specified weighting function. Angles must be measured in radians.\n\n- Define the scalar weight function $q(r)$ as\n$$\nq(r) = \\begin{cases}\n1,  r \\le r_1,\\\\\n\\frac{r_2 - r}{r_2 - r_1},  r_1  r  r_2,\\\\\n0,  r \\ge r_2,\n\\end{cases}\n$$\nso that its gradient satisfies $ \\nabla q(r) = q'(r)\\, \\mathbf{e}_r $ with $q'(r)=-\\frac{1}{r_2 - r_1}$ for $r\\in(r_1,r_2)$ and $q'(r)=0$ elsewhere, and $\\mathbf{e}_r = [\\cos\\theta,\\sin\\theta]^T$.\n\nLet the domain integral be evaluated numerically by midpoint quadrature over a structured annular mesh between $r_1$ and $r_2$ with $N_r$ radial divisions and $N_\\theta$ angular divisions, covering $\\theta \\in [-\\pi,\\pi]$. At each remeshing step, the crack tip advances by $\\Delta a$ along the $x$-axis, and a new annular mesh centered at the new tip is generated.\n\nPropose two mesh-to-mesh transfer operators that map the discretized flux $F$ sampled at the midpoints of the previous mesh to the midpoints of the new mesh:\n\n- Nearest-neighbor operator $T_{\\mathrm{nn}}$: for each new midpoint position, copy the value of $F$ from the closest previous midpoint in Euclidean distance.\n\n- Least-squares $L^2$ projection operator $T_{\\mathrm{ls}}$: for each flux component, fit a linear model in Cartesian coordinates $[1,x,y]$ over the previous midpoint samples by solving the normal equations to minimize the sum of squared errors, and evaluate this model at the new midpoint positions to obtain the transferred flux.\n\nUsing these operators, quantify the accumulation of error in the domain-integral evaluation of $J$ over many propagation steps by performing a sequence of remeshing and transfers, where at each step you evaluate the domain integral using the transferred $F$ without recourse to the exact manufactured $F$. The error metric to report is the absolute difference $|J_{\\mathrm{num}} - J_{\\mathrm{exact}}|$ in $\\mathrm{N}/\\mathrm{m}$ after the prescribed number of propagation steps.\n\nPhysical units must be consistent and the final errors must be expressed in $\\mathrm{N}/\\mathrm{m}$.\n\nYour program must implement the above setup, compute $J_0$ so that the continuous domain integral of the manufactured $F$ with the specified $q(r)$ equals $J_{\\mathrm{exact}}$, and then run the following test suite. For each case, output two numbers: the final absolute error using $T_{\\mathrm{nn}}$ and the final absolute error using $T_{\\mathrm{ls}}$, both in $\\mathrm{N}/\\mathrm{m}$.\n\nTest suite:\n\n- Case $1$ (baseline resolution and small step):\n  - $E = 210\\times 10^{9}\\,\\mathrm{Pa}$,\n  - $\\nu = 0.3$,\n  - $K_I = 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$,\n  - $r_1 = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - $r_2 = 2\\times 10^{-2}\\,\\mathrm{m}$,\n  - $p = 0.5$,\n  - $N_r = 20$,\n  - $N_\\theta = 64$,\n  - $\\Delta a = 1\\times 10^{-3}\\,\\mathrm{m}$,\n  - number of propagation steps $S = 50$.\n\n- Case $2$ (coarse resolution and moderate step):\n  - $E = 210\\times 10^{9}\\,\\mathrm{Pa}$,\n  - $\\nu = 0.3$,\n  - $K_I = 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$,\n  - $r_1 = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - $r_2 = 2\\times 10^{-2}\\,\\mathrm{m}$,\n  - $p = 0.5$,\n  - $N_r = 8$,\n  - $N_\\theta = 16$,\n  - $\\Delta a = 1.5\\times 10^{-3}\\,\\mathrm{m}$,\n  - number of propagation steps $S = 50$.\n\n- Case $3$ (baseline resolution and large step):\n  - $E = 210\\times 10^{9}\\,\\mathrm{Pa}$,\n  - $\\nu = 0.3$,\n  - $K_I = 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$,\n  - $r_1 = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - $r_2 = 2\\times 10^{-2}\\,\\mathrm{m}$,\n  - $p = 0.5$,\n  - $N_r = 20$,\n  - $N_\\theta = 64$,\n  - $\\Delta a = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - number of propagation steps $S = 25$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[\\text{Case 1 error with }T_{\\mathrm{nn}}, \\text{Case 1 error with }T_{\\mathrm{ls}}, \\text{Case 2 error with }T_{\\mathrm{nn}}, \\text{Case 2 error with }T_{\\mathrm{ls}}, \\text{Case 3 error with }T_{\\mathrm{nn}}, \\text{Case 3 error with }T_{\\mathrm{ls}}]$, with each number in $\\mathrm{N}/\\mathrm{m}$.", "solution": "The energy release rate $J$-integral in linear elasticity arises from path-independent energy balance near a crack tip. Starting from the first principles of conservation of energy and balance of linear momentum, consider the strain energy density $W := \\tfrac{1}{2} \\sigma_{ij} \\varepsilon_{ij}$ where $\\sigma_{ij}$ is the Cauchy stress and $\\varepsilon_{ij}$ is the small-strain tensor defined by $\\varepsilon_{ij} := \\tfrac{1}{2}(\\partial u_i/\\partial x_j + \\partial u_j/\\partial x_i)$ in terms of the displacement field $u_i$. For a translation in the $x_1$ direction, the associated energy-momentum tensor contraction relevant to the $J$-integral is\n$$\n\\mathcal{F}_j := \\sigma_{ij}\\, \\frac{\\partial u_i}{\\partial x_1} - W\\, \\delta_{1j},\n$$\nwhere $\\delta_{1j}$ is the Kronecker delta. The classical contour integral form of $J$ follows by balancing the virtual work of traction and energy density on a contour $\\Gamma$ surrounding the crack tip. By applying the divergence theorem to convert the contour integral to a domain integral over an annulus $A$ bounded between an inner contour and an outer contour, one obtains the domain form\n$$\nJ = \\int_A \\mathcal{F}_j\\, \\frac{\\partial q}{\\partial x_j}\\, \\mathrm{d}A,\n$$\nwhere $q$ is a scalar weight function that equals $1$ on the inner boundary, decays to $0$ on the outer boundary, and has compact support in $A$. This form follows from the invariance of the incremental energy under translation and the divergence theorem applied to the energy-momentum tensor.\n\nTo evaluate $J$ numerically in a controlled setting and isolate the effect of remeshing and transfer, we introduce a manufactured flux field $F:\\mathbb{R}^2\\to \\mathbb{R}^2$ to play the role of $\\mathcal{F}$, constructed to yield a known exact domain integral when paired with a simple radial weight function $q(r)$. Let $(r,\\theta)$ be the polar coordinates with respect to the current crack tip. Define\n$$\nF(r,\\theta) := J_0\\, r^{-p}\\, \\begin{bmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\sin\\left(\\frac{\\theta}{2}\\right) \\end{bmatrix},\n$$\nwhere $p\\in(0,1)$ ensures integrability on $(r_1,r_2)$ when combined with the area element $r\\,\\mathrm{d}r\\,\\mathrm{d}\\theta$. Choose the radial weight function\n$$\nq(r) = \\begin{cases}\n1,  r \\le r_1,\\\\\n\\dfrac{r_2 - r}{r_2 - r_1},  r_1  r  r_2,\\\\\n0,  r \\ge r_2,\n\\end{cases}\n\\quad\\Rightarrow\\quad\n\\nabla q(r) = q'(r)\\, \\mathbf{e}_r = \\begin{cases}\n-\\dfrac{1}{r_2-r_1}\\, \\mathbf{e}_r,  r_1  r  r_2,\\\\\n\\mathbf{0},  \\text{otherwise},\n\\end{cases}\n$$\nwith $\\mathbf{e}_r := [\\cos\\theta,\\sin\\theta]^T$. The manufactured integral then becomes\n$$\nJ_{\\mathrm{manu}} = \\int_{r_1}^{r_2} \\int_{-\\pi}^{\\pi} F(r,\\theta) \\cdot \\nabla q(r)\\; r\\, \\mathrm{d}\\theta\\, \\mathrm{d}r\n= \\int_{r_1}^{r_2} \\int_{-\\pi}^{\\pi} J_0 r^{-p} \\begin{bmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\sin\\left(\\frac{\\theta}{2}\\right) \\end{bmatrix} \\cdot \\left( -\\frac{1}{r_2-r_1} \\begin{bmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{bmatrix} \\right) r\\, \\mathrm{d}\\theta\\, \\mathrm{d}r.\n$$\nUsing the trigonometric identity $\\cos\\theta\\cos(\\theta/2) + \\sin\\theta\\sin(\\theta/2) = \\cos(\\theta/2)$, the integrand simplifies:\n$$\nF(r,\\theta)\\cdot \\nabla q(r) = -\\frac{J_0}{r_2 - r_1} r^{-p} \\cos\\left(\\frac{\\theta}{2}\\right).\n$$\nHence,\n$$\nJ_{\\mathrm{manu}} = -\\frac{J_0}{r_2 - r_1} \\int_{r_1}^{r_2} r^{1-p} \\,\\mathrm{d}r \\int_{-\\pi}^{\\pi} \\cos\\left(\\frac{\\theta}{2}\\right)\\, \\mathrm{d}\\theta\n= -\\frac{J_0}{r_2 - r_1} \\left[ \\frac{r^{2-p}}{2-p} \\right]_{r_1}^{r_2} \\cdot \\left[ 2 \\sin\\left(\\frac{\\theta}{2}\\right) \\right]_{-\\pi}^{\\pi}.\n$$\nBecause $\\sin(\\pi/2)=1$ and $\\sin(-\\pi/2)=-1$, the angular integral equals $4$, giving\n$$\nJ_{\\mathrm{manu}} = -\\frac{4 J_0}{r_2 - r_1} \\cdot \\frac{r_2^{2-p} - r_1^{2-p}}{2-p}.\n$$\nWe enforce $J_{\\mathrm{manu}} = J_{\\mathrm{exact}}$ by choosing\n$$\nJ_0 := -\\, \\frac{J_{\\mathrm{exact}}\\, (r_2 - r_1)\\, (2-p)}{4\\,\\left(r_2^{2-p} - r_1^{2-p}\\right)}.\n$$\nWith this choice, the continuous domain integral equals the exact $J$ for the manufactured field and weight function.\n\nNumerical evaluation uses midpoint quadrature over a structured annular mesh. Let $N_r$ be the number of radial divisions, giving $\\Delta r := (r_2 - r_1)/N_r$, and let $N_\\theta$ be the number of angular divisions over $\\theta\\in[-\\pi,\\pi]$, giving $\\Delta\\theta := 2\\pi/N_\\theta$. The quadrature points are the midpoints $(r_m,\\theta_n)$ with $r_m := r_1 + (m+\\tfrac{1}{2})\\Delta r$ for $m\\in\\{0,\\dots,N_r-1\\}$ and $\\theta_n := -\\pi + (n+\\tfrac{1}{2})\\Delta\\theta$ for $n\\in\\{0,\\dots,N_\\theta-1\\}$. The area weight associated with a midpoint is $r_m \\Delta r \\Delta \\theta$. The numerical domain integral at a given crack tip position is\n$$\nJ_{\\mathrm{num}} \\approx \\sum_{m=0}^{N_r-1} \\sum_{n=0}^{N_\\theta-1} \\left( F(r_m,\\theta_n)\\cdot \\nabla q(r_m) \\right) \\, r_m \\Delta r \\Delta \\theta,\n$$\nwhere $\\nabla q(r_m) = -\\frac{1}{r_2-r_1} \\mathbf{e}_r(\\theta_n)$ and $F$ is evaluated at the corresponding quadrature point.\n\nRemeshing during crack advance by $\\Delta a$ generates a new annular mesh centered at the new tip at $(x_{\\mathrm{tip}}, y_{\\mathrm{tip}})$. To quantify transfer-induced error accumulation, we consider two mesh-to-mesh transfer operators that map the discretized $F$ from the previous mesh to the new mesh:\n\n- Nearest-neighbor operator $T_{\\mathrm{nn}}$: Given the set of previous midpoint coordinates $\\{ \\mathbf{x}_i^{\\mathrm{old}} \\}_{i=1}^M$ with flux values $\\{ F_i^{\\mathrm{old}} \\}$ and the set of new midpoints $\\{ \\mathbf{x}_j^{\\mathrm{new}} \\}_{j=1}^N$, set $F_j^{\\mathrm{new}} := F_i^{\\mathrm{old}}$ where $i$ minimizes $\\|\\mathbf{x}_i^{\\mathrm{old}} - \\mathbf{x}_j^{\\mathrm{new}}\\|_2$.\n\n- Least-squares $L^2$ projection operator $T_{\\mathrm{ls}}$: Represent each component of $F$ over the previous midpoints by a linear model in Cartesian coordinates $(x,y)$,\n$$\nF_x(x,y) \\approx c_{x,0} + c_{x,1} x + c_{x,2} y, \\quad F_y(x,y) \\approx c_{y,0} + c_{y,1} x + c_{y,2} y,\n$$\nand determine the coefficient vectors $\\mathbf{c}_x$ and $\\mathbf{c}_y$ by minimizing the sum of squared residuals over the previous midpoint samples. In matrix form, with the design matrix $\\Phi \\in \\mathbb{R}^{M\\times 3}$ having rows $[1, x_i, y_i]$, the normal equations are\n$$\n\\Phi^\\top \\Phi\\, \\mathbf{c}_x = \\Phi^\\top \\mathbf{f}_x, \\quad \\Phi^\\top \\Phi\\, \\mathbf{c}_y = \\Phi^\\top \\mathbf{f}_y,\n$$\nwhere $\\mathbf{f}_x$ and $\\mathbf{f}_y$ collect the previous $F_x$ and $F_y$ samples. Evaluate these linear models at the new midpoints to obtain $F^{\\mathrm{new}}$.\n\nAt each propagation step, we transfer the previously sampled $F$ to the new mesh using one of the operators without recomputing the exact manufactured $F$, and then we evaluate $J_{\\mathrm{num}}$ by domain quadrature. This mimics practical scenarios in which field quantities are transferred during remeshing rather than recomputed from first principles at every step. The error accumulation is characterized by the final absolute error $|J_{\\mathrm{num}} - J_{\\mathrm{exact}}|$ after the prescribed number of steps.\n\nAlgorithmic outline:\n\n- Compute $E' := E/(1-\\nu^2)$ and $J_{\\mathrm{exact}} := K_I^2 / E'$.\n\n- Compute $J_0$ using the formula derived above so that the continuous integral equals $J_{\\mathrm{exact}}$.\n\n- Initialize the crack tip at $(x_{\\mathrm{tip}}, y_{\\mathrm{tip}}) = (0,0)$ and build the initial annular midpoint set and area weights. Evaluate the manufactured $F$ at these midpoints to initialize the discrete field for both operators.\n\n- For each step $s \\in \\{1,\\dots,S\\}$:\n  - Advance the tip by $\\Delta a$ in the $x$ direction: $(x_{\\mathrm{tip}}, y_{\\mathrm{tip}}) \\leftarrow (x_{\\mathrm{tip}} + \\Delta a, y_{\\mathrm{tip}})$.\n  - Build the new annular midpoint set centered at the new tip.\n  - Transfer $F$ from the previous midpoints to the new midpoints using $T_{\\mathrm{nn}}$ and using $T_{\\mathrm{ls}}$ to obtain two sets of transferred fields.\n  - Evaluate the numerical domain integral $J_{\\mathrm{num}}$ for each transferred field using midpoint quadrature.\n\n- Report the final absolute errors for each operator in $\\mathrm{N}/\\mathrm{m}$, in the order prescribed by the test suite.\n\nScientific realism is ensured by basing the derivation on the energy-momentum tensor and the divergence theorem, using consistent physical units, and avoiding the crack-core singularity by excluding the inner radius $r_1$. The manufactured $F$ is chosen to yield a known exact domain integral under the specified $q(r)$, which allows isolating and quantifying the effects of remeshing and field transfer without confounding factors from solving the full elasticity problem at every step. The least-squares projection provides a reproducible $L^2$ transfer operator, while the nearest-neighbor mapping provides a simple baseline. By sweeping across mesh resolutions and step sizes, the test suite covers typical scenarios: a general case, a coarse-mesh case, and a large-step case, highlighting different error mechanisms.\n\nThe program aggregates the results for all cases into a single line formatted as a comma-separated list enclosed in square brackets, with each entry being a floating-point number in $\\mathrm{N}/\\mathrm{m}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef annulus_midpoints(tip, r1, r2, Nr, Nth):\n    \"\"\"\n    Build midpoint quadrature points for an annulus centered at tip.\n    Returns positions (x,y), polar coords (r,theta), and area weights.\n    \"\"\"\n    x_tip, y_tip = tip\n    dr = (r2 - r1) / Nr\n    dth = 2.0 * np.pi / Nth\n    # Midpoints in radial and angular directions\n    r_mid = r1 + (np.arange(Nr) + 0.5) * dr\n    th_mid = -np.pi + (np.arange(Nth) + 0.5) * dth\n    # Create grid\n    R, TH = np.meshgrid(r_mid, th_mid, indexing='ij')\n    # Coordinates in global frame\n    X = x_tip + R * np.cos(TH)\n    Y = y_tip + R * np.sin(TH)\n    # Area weights per midpoint\n    area = R * dr * dth\n    return X, Y, R, TH, area\n\ndef manufactured_F(R, TH, J0, p):\n    \"\"\"\n    Manufactured energy-momentum flux density:\n    F = J0 * R^{-p} * [cos(theta/2), sin(theta/2)].\n    \"\"\"\n    scale = J0 * np.power(R, -p)\n    Fx = scale * np.cos(TH / 2.0)\n    Fy = scale * np.sin(TH / 2.0)\n    return Fx, Fy\n\ndef grad_q(R, r1, r2):\n    \"\"\"\n    Gradient of the radial weight function q(r):\n    For r in (r1, r2): grad q = -(1/(r2-r1)) * e_r; else zero.\n    e_r = [cos(theta), sin(theta)] is accounted by caller via angle.\n    Returns radial derivative coefficient dqdr = -1/(r2-r1) where applicable,\n    else zero.\n    \"\"\"\n    dqdr = np.zeros_like(R)\n    mask = (R > r1)  (R  r2)\n    if np.any(mask):\n        dqdr[mask] = -1.0 / (r2 - r1)\n    return dqdr\n\ndef domain_integral(Fx, Fy, dqdr, TH, area):\n    \"\"\"\n    Evaluate J_num  sum (F  grad q) * area, with grad q = dqdr * e_r.\n    e_r = [cos(theta), sin(theta)].\n    \"\"\"\n    ex = np.cos(TH)\n    ey = np.sin(TH)\n    integrand = (Fx * ex + Fy * ey) * dqdr\n    J_num = np.sum(integrand * area)\n    return J_num\n\ndef compute_J0(J_exact, r1, r2, p):\n    \"\"\"\n    From continuous manufactured integral:\n    J_exact = -(4 J0 / (r2 - r1)) * (r2^{2-p} - r1^{2-p}) / (2 - p)\n    Solve for J0.\n    \"\"\"\n    numerator = -J_exact * (r2 - r1) * (2.0 - p)\n    denom = 4.0 * (np.power(r2, 2.0 - p) - np.power(r1, 2.0 - p))\n    return numerator / denom\n\ndef nearest_neighbor_transfer(X_old, Y_old, Fx_old, Fy_old, X_new, Y_new):\n    \"\"\"\n    Transfer field via nearest neighbor from old midpoints to new midpoints.\n    Brute-force using broadcasting; acceptable for moderate sizes.\n    \"\"\"\n    # Flatten arrays\n    xo = X_old.ravel(); yo = Y_old.ravel()\n    fx_o = Fx_old.ravel(); fy_o = Fy_old.ravel()\n    xn = X_new.ravel()[:, None]; yn = Y_new.ravel()[:, None]\n    # Compute squared distances to all old points\n    dx = xn - xo[None, :]\n    dy = yn - yo[None, :]\n    dist2 = dx*dx + dy*dy\n    idx = np.argmin(dist2, axis=1)\n    fx_n = fx_o[idx].reshape(X_new.shape)\n    fy_n = fy_o[idx].reshape(Y_new.shape)\n    return fx_n, fy_n\n\ndef ls_transfer(X_old, Y_old, Fx_old, Fy_old, X_new, Y_new):\n    \"\"\"\n    Transfer field via least-squares linear fit in [1, x, y].\n    Fits Fx and Fy separately.\n    \"\"\"\n    # Design matrix for old points\n    Phi = np.stack([np.ones_like(X_old), X_old, Y_old], axis=-1).reshape(-1, 3)\n    fx_vec = Fx_old.ravel()\n    fy_vec = Fy_old.ravel()\n    # Solve normal equations using lstsq\n    cx, *_ = np.linalg.lstsq(Phi, fx_vec, rcond=None)\n    cy, *_ = np.linalg.lstsq(Phi, fy_vec, rcond=None)\n    # Evaluate on new points\n    Phi_new = np.stack([np.ones_like(X_new), X_new, Y_new], axis=-1).reshape(-1, 3)\n    fx_new = (Phi_new @ cx).reshape(X_new.shape)\n    fy_new = (Phi_new @ cy).reshape(Y_new.shape)\n    return fx_new, fy_new\n\ndef run_case(E, nu, KI, r1, r2, p, Nr, Nth, da, steps):\n    \"\"\"\n    Run a test case; return final absolute errors for NN and LS operators.\n    \"\"\"\n    # Effective modulus and exact J\n    E_eff = E / (1.0 - nu**2)\n    J_exact = (KI**2) / E_eff\n    # Manufactured amplitude\n    J0 = compute_J0(J_exact, r1, r2, p)\n    # Initialize tip and mesh\n    tip = (0.0, 0.0)\n    X_old, Y_old, R_old, TH_old, area_old = annulus_midpoints(tip, r1, r2, Nr, Nth)\n    Fx_exact, Fy_exact = manufactured_F(R_old, TH_old, J0, p)\n    # Initialize fields for both operators with exact manufactured field\n    Fx_nn = Fx_exact.copy(); Fy_nn = Fy_exact.copy()\n    Fx_ls = Fx_exact.copy(); Fy_ls = Fy_exact.copy()\n    # Simulate propagation steps\n    J_nn = None; J_ls = None\n    for _ in range(steps):\n        tip = (tip[0] + da, tip[1])\n        X_new, Y_new, R_new, TH_new, area_new = annulus_midpoints(tip, r1, r2, Nr, Nth)\n        # Transfer nearest neighbor\n        Fx_nn_new, Fy_nn_new = nearest_neighbor_transfer(X_old, Y_old, Fx_nn, Fy_nn, X_new, Y_new)\n        # Transfer least squares\n        Fx_ls_new, Fy_ls_new = ls_transfer(X_old, Y_old, Fx_ls, Fy_ls, X_new, Y_new)\n        # Evaluate domain integrals\n        dqdr_new = grad_q(R_new, r1, r2)\n        J_nn = domain_integral(Fx_nn_new, Fy_nn_new, dqdr_new, TH_new, area_new)\n        J_ls = domain_integral(Fx_ls_new, Fy_ls_new, dqdr_new, TH_new, area_new)\n        # Update for next step\n        X_old, Y_old = X_new, Y_new\n        Fx_nn, Fy_nn = Fx_nn_new, Fy_nn_new\n        Fx_ls, Fy_ls = Fx_ls_new, Fy_ls_new\n    # Final absolute errors in N/m\n    err_nn = abs(J_nn - J_exact)\n    err_ls = abs(J_ls - J_exact)\n    return err_nn, err_ls\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: baseline resolution and small step\n        {\n            \"E\": 210e9, \"nu\": 0.3, \"KI\": 1e6,\n            \"r1\": 5e-3, \"r2\": 2e-2, \"p\": 0.5,\n            \"Nr\": 20, \"Nth\": 64, \"da\": 1e-3, \"steps\": 50\n        },\n        # Case 2: coarse resolution and moderate step\n        {\n            \"E\": 210e9, \"nu\": 0.3, \"KI\": 1e6,\n            \"r1\": 5e-3, \"r2\": 2e-2, \"p\": 0.5,\n            \"Nr\": 8, \"Nth\": 16, \"da\": 1.5e-3, \"steps\": 50\n        },\n        # Case 3: baseline resolution and large step\n        {\n            \"E\": 210e9, \"nu\": 0.3, \"KI\": 1e6,\n            \"r1\": 5e-3, \"r2\": 2e-2, \"p\": 0.5,\n            \"Nr\": 20, \"Nth\": 64, \"da\": 5e-3, \"steps\": 25\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        err_nn, err_ls = run_case(**case)\n        results.append(err_nn)\n        results.append(err_ls)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3576818"}]}