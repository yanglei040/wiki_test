{"hands_on_practices": [{"introduction": "The foundation of the Extended Finite Element Method (XFEM) lies in augmenting the standard finite element basis with new functions that capture specific physical behaviors. This first practice provides a direct, hands-on derivation of the element-level stiffness and mass matrices for a partition-of-unity enriched element. By working through this calculation [@problem_id:3564597], you will uncover the block structure of the system matrices and gain a concrete understanding of the cross-coupling terms that link the standard and enriched degrees of freedom.", "problem": "Consider a single two-dimensional linear triangular finite element under plane stress with nodes at coordinates $(0,0)$, $(h,0)$, and $(0,h)$, with uniform thickness $t$, Young’s modulus $E$, Poisson’s ratio $\\nu$, and mass density $\\rho$. Adopt the partition-of-unity enriched approximation of the displacement field\n$$\nu_h(\\mathbf{x})=\\sum_{i=1}^{3} N_i(\\mathbf{x})\\,\\mathbf{a}_i \\;+\\; \\sum_{i=1}^{3} N_i(\\mathbf{x})\\,L(\\mathbf{x})\\,\\mathbf{b}_i,\n$$\nwhere $N_i(\\mathbf{x})$ are the standard linear shape functions, $\\mathbf{a}_i=\\begin{pmatrix}a_{i}^{u}\\\\ a_{i}^{v}\\end{pmatrix}$ are the standard nodal degrees of freedom for displacement components, $\\mathbf{b}_i=\\begin{pmatrix}b_{i}^{u}\\\\ b_{i}^{v}\\end{pmatrix}$ are the enriched nodal degrees of freedom, and the enrichment function is $L(\\mathbf{x})=x$. Use the standard weak form of linear elastostatics with the constitutive law for isotropic plane stress,\n$$\n\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}, \\quad \\mathbf{C}=\\frac{E}{1-\\nu^2}\\begin{pmatrix}1 & \\nu & 0\\\\ \\nu & 1 & 0\\\\ 0 & 0 & \\frac{1-\\nu}{2}\\end{pmatrix}.\n$$\nThe small-strain operator applied to a displacement vector field $\\mathbf{u}=(u,v)^{\\mathsf{T}}$ is\n$$\n\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\begin{pmatrix}\\partial u/\\partial x\\\\ \\partial v/\\partial y\\\\ \\partial u/\\partial y + \\partial v/\\partial x\\end{pmatrix}.\n$$\nFor the consistent element mass matrix, use the standard $L^2$ inner product over the element domain $\\Omega_e$.\n\nTasks:\n- Starting from the weak form and the above definitions, construct the element-level consistent mass matrix and stiffness matrix for this enriched approximation. Explicitly identify the block partitions $(\\mathbf{M}_{aa},\\mathbf{M}_{ab},\\mathbf{M}_{bb})$ and $(\\mathbf{K}_{aa},\\mathbf{K}_{ab},\\mathbf{K}_{bb})$ corresponding to the standard-to-standard, standard-to-enriched, and enriched-to-enriched couplings, respectively. Clearly specify the shape-function gradients and the strain-displacement matrices used for both the standard and enriched fields, and evaluate the domain integrals exactly over $\\Omega_e$.\n- Interpret which sub-blocks embody the cross-coupling between standard and enriched degrees of freedom and explain briefly why these terms appear.\n\nAnswer specification:\n- As your final reported value, provide the closed-form analytical expression for the single stiffness entry that couples the standard $u$-component at node $2$ with the enriched $u$-component at node $2$, i.e., the $(2u,2u)$ entry of $\\mathbf{K}_{ab}$, expressed in terms of $E$, $\\nu$, $t$, and $h$ only.\n- Do not include units in the final answer. No rounding is required.", "solution": "The displacement field $\\mathbf{u}_h(\\mathbf{x})$ can be written as the sum of a standard part $\\mathbf{u}_a(\\mathbf{x})$ and an enriched part $\\mathbf{u}_b(\\mathbf{x})$:\n$$\n\\mathbf{u}_h(\\mathbf{x}) = \\mathbf{u}_a(\\mathbf{x}) + \\mathbf{u}_b(\\mathbf{x}) = \\sum_{i=1}^{3} N_i(\\mathbf{x}) \\mathbf{a}_i + \\sum_{i=1}^{3} N_i(\\mathbf{x}) L(\\mathbf{x}) \\mathbf{b}_i\n$$\nThe nodal degrees of freedom are arranged in a vector $\\mathbf{d} = (\\mathbf{a}^T, \\mathbf{b}^T)^T$, where $\\mathbf{a} = (\\mathbf{a}_1^T, \\mathbf{a}_2^T, \\mathbf{a}_3^T)^T$ and $\\mathbf{b} = (\\mathbf{b}_1^T, \\mathbf{b}_2^T, \\mathbf{b}_3^T)^T$. The element stiffness matrix $\\mathbf{K}_e$ and mass matrix $\\mathbf{M}_e$ will have a $2 \\times 2$ block structure:\n$$\n\\mathbf{K}_e = \\begin{pmatrix} \\mathbf{K}_{aa} & \\mathbf{K}_{ab} \\\\ \\mathbf{K}_{ba} & \\mathbf{K}_{bb} \\end{pmatrix}, \\quad\n\\mathbf{M}_e = \\begin{pmatrix} \\mathbf{M}_{aa} & \\mathbf{M}_{ab} \\\\ \\mathbf{M}_{ba} & \\mathbf{M}_{bb} \\end{pmatrix}\n$$\nThe generic expression for a stiffness matrix sub-block is given by:\n$$\n\\mathbf{K}_{XY} = \\int_{\\Omega_e} t (\\mathbf{B}_X)^T \\mathbf{C} \\mathbf{B}_Y \\, d\\Omega\n$$\nwhere $X, Y \\in \\{a, b\\}$, $\\mathbf{B}_X$ is the strain-displacement matrix corresponding to the $X$-part of the approximation, $\\mathbf{C}$ is the constitutive matrix, and $t$ is the element thickness.\n\nThe strain-displacement matrix $\\mathbf{B}$ relates the strain vector $\\boldsymbol{\\varepsilon}$ to the nodal DOFs. For the standard part, the strain is $\\boldsymbol{\\varepsilon}_a = \\sum_{i=1}^3 \\mathbf{B}_{a,i} \\mathbf{a}_i$, where $\\mathbf{B}_{a,i}$ is the standard strain-displacement matrix for node $i$:\n$$\n\\mathbf{B}_{a,i} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\nFor the enriched part, the strain is $\\boldsymbol{\\varepsilon}_b = \\sum_{i=1}^3 \\mathbf{B}_{b,i} \\mathbf{b}_i$. The basis functions for the enriched field are $\\Phi_i(\\mathbf{x}) = N_i(\\mathbf{x})L(\\mathbf{x})$. Using the product rule for differentiation and the given enrichment $L(\\mathbf{x}) = x$:\n$$\n\\frac{\\partial \\Phi_i}{\\partial x} = \\frac{\\partial (N_i x)}{\\partial x} = \\frac{\\partial N_i}{\\partial x} x + N_i, \\quad \\frac{\\partial \\Phi_i}{\\partial y} = \\frac{\\partial (N_i x)}{\\partial y} = \\frac{\\partial N_i}{\\partial y} x\n$$\nThis gives the strain-displacement matrix for the enriched DOFs at node $i$:\n$$\n\\mathbf{B}_{b,i} = \\begin{pmatrix} \\frac{\\partial \\Phi_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial \\Phi_i}{\\partial y} \\\\ \\frac{\\partial \\Phi_i}{\\partial y} & \\frac{\\partial \\Phi_i}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} x + N_i & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} x \\\\ \\frac{\\partial N_i}{\\partial y} x & \\frac{\\partial N_i}{\\partial x} x + N_i \\end{pmatrix}\n$$\nWe are tasked to find the stiffness entry that couples the standard $u$-component at node $2$, $a_{2u}$, with the enriched $u$-component at node $2$, $b_{2u}$. This entry is the element at position $(1,1)$ of the $2 \\times 2$ sub-block matrix $\\mathbf{K}_{ab}^{22}$, which couples DOFs $\\mathbf{a}_2$ and $\\mathbf{b}_2$. Its expression is:\n$$\n(\\mathbf{K}_{ab}^{22})_{11} = \\int_{\\Omega_e} t \\, (\\text{col } 1 \\text{ of } \\mathbf{B}_{a,2})^T \\mathbf{C} (\\text{col } 1 \\text{ of } \\mathbf{B}_{b,2}) \\, d\\Omega\n$$\nThe required vectors are:\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{a,2})^T = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial x} & 0 & \\frac{\\partial N_2}{\\partial y} \\end{pmatrix}\n$$\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{b,2}) = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial x} x + N_2 \\\\ 0 \\\\ \\frac{\\partial N_2}{\\partial y} x \\end{pmatrix}\n$$\nThe element nodes are at $(0,0)$, $(h,0)$, and $(0,h)$. The linear shape functions for this right-angled triangle are:\n$$\nN_1(x,y) = 1 - \\frac{x}{h} - \\frac{y}{h}, \\quad N_2(x,y) = \\frac{x}{h}, \\quad N_3(x,y) = \\frac{y}{h}\n$$\nThe gradients of $N_2$ are constant over the element:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{h}, \\quad \\frac{\\partial N_2}{\\partial y} = 0\n$$\nSubstituting these gradients into the vectors:\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{a,2})^T = \\begin{pmatrix} \\frac{1}{h} & 0 & 0 \\end{pmatrix}\n$$\n$$\n(\\text{col } 1 \\text{ of } \\mathbf{B}_{b,2}) = \\begin{pmatrix} \\frac{1}{h} x + \\frac{x}{h} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{2x}{h} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe integrand is $t \\, (\\begin{pmatrix} \\frac{1}{h} & 0 & 0 \\end{pmatrix}) \\mathbf{C} (\\begin{pmatrix} \\frac{2x}{h} \\\\ 0 \\\\ 0 \\end{pmatrix})$.\nLet's perform the matrix multiplication. The product of the two vectors with $\\mathbf{C}$ only involves the $(1,1)$ component of $\\mathbf{C}$, which is $C_{11} = \\frac{E}{1-\\nu^2}$.\n$$\n\\text{Integrand} = t \\left( \\frac{1}{h} \\right) \\left( \\frac{E}{1-\\nu^2} \\right) \\left( \\frac{2x}{h} \\right) = \\frac{2Et}{h^2(1-\\nu^2)} x\n$$\nNow, we must integrate this expression over the triangular domain $\\Omega_e$. The limits of integration are from $x=0$ to $x=h$, and for each $x$, from $y=0$ to $y=h-x$. The area of the element is $A = h^2/2$.\n$$\n(\\mathbf{K}_{ab}^{22})_{11} = \\int_{\\Omega_e} \\frac{2Et}{h^2(1-\\nu^2)} x \\, d\\Omega = \\frac{2Et}{h^2(1-\\nu^2)} \\int_{\\Omega_e} x \\, d\\Omega\n$$\nThe integral of $x$ over the triangle is the $x$-coordinate of the centroid times the area. The centroid is at $(\\frac{0+h+0}{3}, \\frac{0+0+h}{3}) = (\\frac{h}{3}, \\frac{h}{3})$.\n$$\n\\int_{\\Omega_e} x \\, d\\Omega = (\\text{Area}) \\times (\\bar{x}) = \\left(\\frac{h^2}{2}\\right) \\left(\\frac{h}{3}\\right) = \\frac{h^3}{6}\n$$\nSubstituting this result back into the expression for the stiffness entry:\n$$\n(\\mathbf{K}_{ab}^{22})_{11} = \\frac{2Et}{h^2(1-\\nu^2)} \\left( \\frac{h^3}{6} \\right) = \\frac{2E t h^3}{6h^2(1-\\nu^2)} = \\frac{E t h}{3(1-\\nu^2)}\n$$\nThe construction of the mass matrix blocks follows a similar procedure, starting from the general expression $\\mathbf{M}_{XY} = \\int_{\\Omega_e} \\rho t (\\mathbf{N}_X)^T \\mathbf{N}_Y \\, d\\Omega$, where $\\mathbf{N}_X$ and $\\mathbf{N}_Y$ are the matrix forms of the shape functions for the standard and enriched fields, respectively.\n\nRegarding the interpretation of cross-coupling terms: the off-diagonal blocks $\\mathbf{K}_{ab}$ and $\\mathbf{K}_{ba}$ (which is the transpose of $\\mathbf{K}_{ab}$) represent the energetic coupling between the standard and enriched degrees of freedom. These terms are non-zero because the strain field derived from the enriched basis functions, $\\boldsymbol{\\varepsilon}_b$, depends on both the standard shape functions $N_i$ and the enrichment function $L(\\mathbf{x})$. The integral of the product $(\\mathbf{B}_a)^T \\mathbf{C} \\mathbf{B}_b$ is generally non-zero, creating a link in the strain energy functional between the standard DOFs $\\mathbf{a}$ and the enriched DOFs $\\mathbf{b}$. This coupling is a fundamental feature of the partition-of-unity method, ensuring that the enriched part of the solution interacts correctly with the underlying standard finite element approximation. Similarly, $\\mathbf{M}_{ab}$ and $\\mathbf{M}_{ba}$ represent the coupling in the kinetic energy (or its virtual work equivalent) and are non-zero because the integral of the product of standard and enriched basis functions, $\\int N_i (N_j L) d\\Omega$, is not zero.\n\nThe final requested value is the single stiffness entry calculated above.", "answer": "$$\n\\boxed{\\frac{E t h}{3(1-\\nu^2)}}\n$$", "id": "3564597"}, {"introduction": "A critical issue in XFEM, known as 'blending error,' arises in elements where some nodes are enriched and others are not, potentially compromising the method's accuracy. This exercise uses a simple one-dimensional setup to provide a crystal-clear demonstration of this phenomenon and its elegant solution [@problem_id:3564649]. By comparing a standard 'unshifted' enrichment with a 'shifted' or blended version, you will verify how the latter restores the crucial polynomial reproduction property of the underlying approximation.", "problem": "Consider a one-dimensional linear Lagrange finite element over the reference interval $[-1,1]$ with two nodes located at $x_1=-1$ and $x_2=1$. Let $N_1(x)=\\tfrac{1-x}{2}$ and $N_2(x)=\\tfrac{1+x}{2}$ denote the standard shape functions, which satisfy the partition-of-unity property $\\sum_{i=1}^2 N_i(x)=1$ and the Kronecker delta property $N_i(x_j)=\\delta_{ij}$. In the Extended Finite Element Method (XFEM), an enriched approximation is constructed by augmenting the standard finite element space through the Partition of Unity Method (PUM). Given an enrichment function $\\psi(x)$ and an indicator $\\chi_i\\in\\{0,1\\}$ that marks whether node $i$ is enriched, two local interpolants of a target field $u(x)$ are defined:\n- The non-shifted PUM interpolant\n$$\nu_h^{\\mathrm{ns}}(x)=\\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,\\psi(x)\\right],\n$$\n- The shifted PUM interpolant using shifted enrichment\n$$\n\\tilde{\\psi}(x;x_i)=\\psi(x)-\\psi(x_i),\\quad\nu_h^{\\mathrm{sh}}(x)=\\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,\\tilde{\\psi}(x;x_i)\\right].\n$$\nThe shifted enrichment is a blending correction designed to eliminate spurious oscillations in elements where only a subset of nodes are enriched (blending elements), while preserving the standard finite element reproduction of polynomials. Starting from the fundamental facts that (i) the linear Lagrange shape functions reproduce polynomials up to degree $1$ exactly under nodal interpolation, and (ii) the partition-of-unity property $\\sum_i N_i(x)=1$ holds pointwise, derive, from first principles, that when $\\psi(x)$ is constant, the shifted interpolant $u_h^{\\mathrm{sh}}(x)$ reduces to the standard finite element interpolant and is therefore exact for polynomials up to degree $1$, independent of the enrichment pattern $\\chi_i$. Then, contrast this with the non-shifted interpolant $u_h^{\\mathrm{ns}}(x)$, which introduces spurious blending contributions when $\\chi_i\\neq 0$.\n\nLet the target fields be $u_0(x)=1$ and $u_1(x)=x$ and choose the constant enrichment $\\psi(x)\\equiv 1$. Consider the following test suite of enrichment patterns and targets:\n1. Full enrichment with both nodes enriched, $(\\chi_1,\\chi_2)=(1,1)$, target $u_0(x)=1$.\n2. Full enrichment with both nodes enriched, $(\\chi_1,\\chi_2)=(1,1)$, target $u_1(x)=x$.\n3. Blending element with only the left node enriched, $(\\chi_1,\\chi_2)=(1,0)$, target $u_1(x)=x$.\n4. Blending element with only the left node enriched, $(\\chi_1,\\chi_2)=(1,0)$, target $u_0(x)=1$.\n5. No enrichment, $(\\chi_1,\\chi_2)=(0,0)$, target $u_1(x)=x$.\n\nFor each test case, compute the $L^2$ error of both $u_h^{\\mathrm{ns}}(x)$ and $u_h^{\\mathrm{sh}}(x)$ over $[-1,1]$, defined by\n$$\n\\|u-u_h\\|_{L^2([-1,1])}=\\left(\\int_{-1}^{1}\\left[u(x)-u_h(x)\\right]^2\\,\\mathrm{d}x\\right)^{1/2}.\n$$\nYour program should produce a single line of output containing the ten results as a comma-separated list enclosed in square brackets, ordered as\n$$\n\\left[\\|u-u_h^{\\mathrm{ns}}\\|_1,\\|u-u_h^{\\mathrm{sh}}\\|_1,\\|u-u_h^{\\mathrm{ns}}\\|_2,\\|u-u_h^{\\mathrm{sh}}\\|_2,\\|u-u_h^{\\mathrm{ns}}\\|_3,\\|u-u_h^{\\mathrm{sh}}\\|_3,\\|u-u_h^{\\mathrm{ns}}\\|_4,\\|u-u_h^{\\mathrm{sh}}\\|_4,\\|u-u_h^{\\mathrm{ns}}\\|_5,\\|u-u_h^{\\mathrm{sh}}\\|_5\\right],\n$$\nwhere the subscript index corresponds to the numbered test cases above, and each entry is a floating-point number. No physical units are involved in this computation, and angles are not used. The code must be self-contained and require no input.", "solution": "This problem consists of a theoretical derivation followed by quantitative calculations for the specified test cases.\n\nFirst, we will establish the properties of the shifted and non-shifted interpolants for a constant enrichment function $\\psi(x)$. Let the one-dimensional reference element be defined on the interval $x \\in [-1, 1]$. The nodes are at $x_1 = -1$ and $x_2 = 1$. The linear Lagrange shape functions are $N_1(x) = \\frac{1-x}{2}$ and $N_2(x) = \\frac{1+x}{2}$. These functions satisfy two fundamental properties:\n1.  Partition of Unity: $\\sum_{i=1}^{2} N_i(x) = N_1(x) + N_2(x) = \\frac{1-x}{2} + \\frac{1+x}{2} = \\frac{2}{2} = 1$.\n2.  Linear polynomial reproduction: The standard finite element interpolant of a linear function $u(x) = a + bx$ is exact.\n    $$u_h^{\\mathrm{std}}(x) = \\sum_{i=1}^2 N_i(x) u(x_i) = N_1(x)(a+bx_1) + N_2(x)(a+bx_2)$$\n    Using the partition of unity property, $\\sum N_i(x) a = a \\sum N_i(x) = a$. Using the specific coordinates $x_1 = -1$ and $x_2 = 1$, we can show linear reproduction:\n    $$\\sum_{i=1}^2 N_i(x) x_i = N_1(x)x_1 + N_2(x)x_2 = \\frac{1-x}{2}(-1) + \\frac{1+x}{2}(1) = \\frac{x-1}{2} + \\frac{1+x}{2} = \\frac{2x}{2} = x$$\n    Thus, $u_h^{\\mathrm{std}}(x) = a \\sum N_i(x) + b \\sum N_i(x)x_i = a(1) + b(x) = a+bx = u(x)$.\n\n**Analysis of the Shifted PUM Interpolant ($u_h^{\\mathrm{sh}}(x)$)**\n\nThe shifted PUM interpolant is defined as:\n$$u_h^{\\mathrm{sh}}(x) = \\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,\\tilde{\\psi}(x;x_i)\\right]$$\nwhere the shifted enrichment is $\\tilde{\\psi}(x;x_i) = \\psi(x) - \\psi(x_i)$.\n\nThe problem specifies a constant enrichment function, $\\psi(x) = 1$. For any node $i$, the value of the enrichment function at the nodal coordinate $x_i$ is also $\\psi(x_i) = 1$.\nTherefore, the shifted enrichment function becomes:\n$$\\tilde{\\psi}(x;x_i) = \\psi(x) - \\psi(x_i) = 1 - 1 = 0$$\nSubstituting $\\tilde{\\psi}(x;x_i) = 0$ into the definition of $u_h^{\\mathrm{sh}}(x)$:\n$$u_h^{\\mathrm{sh}}(x) = \\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,(0)\\right] = \\sum_{i=1}^{2} N_i(x)u(x_i)$$\nThis is precisely the standard linear Lagrange finite element interpolant, $u_h^{\\mathrm{std}}(x)$. As demonstrated above, $u_h^{\\mathrm{std}}(x)$ reproduces linear polynomials exactly. The target fields provided are $u_0(x)=1$ (degree $0$) and $u_1(x)=x$ (degree $1$), both of which are polynomials of degree at most $1$.\n\nConsequently, for any enrichment pattern $(\\chi_1, \\chi_2)$, the shifted interpolant $u_h^{\\mathrm{sh}}(x)$ will be identical to the exact function $u(x)$. The interpolation error is therefore zero:\n$$u(x) - u_h^{\\mathrm{sh}}(x) = 0$$\nThis implies that the $L^2$ error norm $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2([-1,1])}$ will be $0$ for all five test cases. This result demonstrates the key advantage of the shifted enrichment: for constant enrichment, it recovers the optimal behavior of the standard finite element method, regardless of the enrichment pattern.\n\n**Analysis of the Non-Shifted PUM Interpolant ($u_h^{\\mathrm{ns}}(x)$)**\n\nThe non-shifted PUM interpolant is defined as:\n$$u_h^{\\mathrm{ns}}(x)=\\sum_{i=1}^{2} N_i(x)\\left[u(x_i)+\\chi_i\\,u(x_i)\\,\\psi(x)\\right]$$\nThis expression can be expanded and rearranged:\n$$u_h^{\\mathrm{ns}}(x) = \\sum_{i=1}^{2} N_i(x)u(x_i) + \\sum_{i=1}^{2} N_i(x)\\chi_i\\,u(x_i)\\,\\psi(x)$$\nRecognizing the first term as the standard interpolant $u_h^{\\mathrm{std}}(x)$:\n$$u_h^{\\mathrm{ns}}(x) = u_h^{\\mathrm{std}}(x) + \\psi(x)\\sum_{i=1}^{2} \\chi_i\\,N_i(x)\\,u(x_i)$$\nSince the target functions are linear, we have $u_h^{\\mathrm{std}}(x) = u(x)$. The interpolation error for the non-shifted scheme is therefore:\n$$e_{\\mathrm{ns}}(x) = u(x) - u_h^{\\mathrm{ns}}(x) = u(x) - \\left(u(x) + \\psi(x)\\sum_{i=1}^{2} \\chi_i\\,N_i(x)\\,u(x_i)\\right)$$\n$$e_{\\mathrm{ns}}(x) = -\\psi(x)\\sum_{i=1}^{2} \\chi_i\\,N_i(x)\\,u(x_i)$$\nWith $\\psi(x) = 1$, the error simplifies to:\n$$e_{\\mathrm{ns}}(x) = -\\sum_{i=1}^{2} \\chi_i\\,N_i(x)\\,u(x_i)$$\nThis error term is generally non-zero when any $\\chi_i$ is non-zero, leading to a loss of exactness. This is the spurious contribution from the enrichment in blending elements.\n\nWe now compute the $L^2$ error for each test case. The $L^2$ error is $\\|e\\|_{L^2} = (\\int_{-1}^{1} [e(x)]^2 dx)^{1/2}$.\n\n**Case 1: Full enrichment, $u_0(x)=1$**\nParameters: $(\\chi_1, \\chi_2) = (1, 1)$, $u(x) = 1$. Nodal values: $u(x_1)=1, u(x_2)=1$.\nError $e_{\\mathrm{ns}}(x) = -[1 \\cdot N_1(x) \\cdot 1 + 1 \\cdot N_2(x) \\cdot 1] = -(N_1(x)+N_2(x)) = -1$.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\int_{-1}^{1} (-1)^2 dx = \\int_{-1}^{1} 1 dx = [x]_{-1}^{1} = 2$.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2}$.\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$.\n\n**Case 2: Full enrichment, $u_1(x)=x$**\nParameters: $(\\chi_1, \\chi_2) = (1, 1)$, $u(x) = x$. Nodal values: $u(x_1)=-1, u(x_2)=1$.\nError $e_{\\mathrm{ns}}(x) = -[1 \\cdot N_1(x) \\cdot (-1) + 1 \\cdot N_2(x) \\cdot 1] = -[-N_1(x)+N_2(x)] = N_1(x) - N_2(x) = \\frac{1-x}{2} - \\frac{1+x}{2} = -x$.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\int_{-1}^{1} (-x)^2 dx = \\int_{-1}^{1} x^2 dx = [\\frac{x^3}{3}]_{-1}^{1} = \\frac{1}{3} - (-\\frac{1}{3}) = \\frac{2}{3}$.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$.\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$.\n\n**Case 3: Blending element, $u_1(x)=x$**\nParameters: $(\\chi_1, \\chi_2) = (1, 0)$, $u(x) = x$. Nodal values: $u(x_1)=-1, u(x_2)=1$.\nError $e_{\\mathrm{ns}}(x) = -[1 \\cdot N_1(x) \\cdot (-1) + 0 \\cdot N_2(x) \\cdot 1] = N_1(x) = \\frac{1-x}{2}$.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\int_{-1}^{1} (\\frac{1-x}{2})^2 dx = \\frac{1}{4}\\int_{-1}^{1} (1-2x+x^2) dx = \\frac{1}{4}[x-x^2+\\frac{x^3}{3}]_{-1}^{1} = \\frac{1}{4}[ (1-1+\\frac{1}{3}) - (-1-1-\\frac{1}{3}) ] = \\frac{1}{4}[\\frac{1}{3} - (-\\frac{7}{3})] = \\frac{1}{4}(\\frac{8}{3}) = \\frac{2}{3}$.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$.\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$.\n\n**Case 4: Blending element, $u_0(x)=1$**\nParameters: $(\\chi_1, \\chi_2) = (1, 0)$, $u(x) = 1$. Nodal values: $u(x_1)=1, u(x_2)=1$.\nError $e_{\\mathrm{ns}}(x) = -[1 \\cdot N_1(x) \\cdot 1 + 0 \\cdot N_2(x) \\cdot 1] = -N_1(x) = -\\frac{1-x}{2} = \\frac{x-1}{2}$.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\int_{-1}^{1} (\\frac{x-1}{2})^2 dx = \\frac{1}{4}\\int_{-1}^{1} (x^2-2x+1) dx$. This is the same integral as in Case 3.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2}^2 = \\frac{2}{3}$.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$.\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$.\n\n**Case 5: No enrichment, $u_1(x)=x$**\nParameters: $(\\chi_1, \\chi_2) = (0, 0)$, $u(x) = x$.\nError $e_{\\mathrm{ns}}(x) = -[0 \\cdot N_1(x) \\cdot u(x_1) + 0 \\cdot N_2(x) \\cdot u(x_2)] = 0$.\nIn this case, the non-shifted interpolant is identical to the standard interpolant, which is exact.\n$\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = 0$.\n$\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$.\n\nSummary of results:\n- Case 1: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2}$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$\n- Case 2: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$\n- Case 3: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$\n- Case 4: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = \\sqrt{2/3}$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$\n- Case 5: $\\|u-u_h^{\\mathrm{ns}}\\|_{L^2} = 0$, $\\|u-u_h^{\\mathrm{sh}}\\|_{L^2} = 0$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the L2 error for non-shifted and shifted PUM interpolants\n    for a series of test cases.\n    \"\"\"\n    # The enrichment function psi(x) is 1.\n    # The shifted enrichment psi_tilde(x; x_i) = psi(x) - psi(x_i) = 1 - 1 = 0.\n    # The shifted interpolant u_h_sh(x) thus reduces to the standard FEA interpolant.\n    # Since the target functions u(x) are linear, the standard interpolant is exact.\n    # Therefore, the error for the shifted interpolant is always 0.\n    \n    # Test cases: ( (chi1, chi2), u_id )\n    # u_id = 0 for u(x)=1\n    # u_id = 1 for u(x)=x\n    test_cases = [\n        ((1, 1), 0),  # Case 1\n        ((1, 1), 1),  # Case 2\n        ((1, 0), 1),  # Case 3\n        ((1, 0), 0),  # Case 4\n        ((0, 0), 1),  # Case 5\n    ]\n\n    results = []\n    \n    # Nodal coordinates\n    x1, x2 = -1.0, 1.0\n\n    # The error for the non-shifted interpolant is e_ns(x) = -sum(chi_i * N_i(x) * u(x_i)).\n    # We can express this error as e_ns(x) = a*x + b and use an analytical formula\n    # for the squared L2 norm over [-1, 1]:\n    # Integral from -1 to 1 of (ax+b)^2 dx = 2*a^2/3 + 2*b^2.\n    \n    for case in test_cases:\n        chi, u_id = case\n        chi1, chi2 = chi\n        \n        # Determine nodal values for the target function\n        if u_id == 0:  # u(x) = 1\n            u1, u2 = 1.0, 1.0\n        else:  # u(x) = x\n            u1, u2 = x1, x2\n\n        # The error e_ns(x) is -(chi1*u1*N1(x) + chi2*u2*N2(x))\n        # N1(x) = (1-x)/2, N2(x) = (1+x)/2\n        # e_ns(x) = - ( chi1*u1*(0.5 - 0.5*x) + chi2*u2*(0.5 + 0.5*x) )\n        # e_ns(x) = x * (0.5*chi1*u1 - 0.5*chi2*u2) - (0.5*chi1*u1 + 0.5*chi2*u2)\n        # This is of the form a*x + b\n        \n        a = 0.5 * chi1 * u1 - 0.5 * chi2 * u2\n        b = -0.5 * chi1 * u1 - 0.5 * chi2 * u2\n        \n        # Calculate squared L2 norm of the error for the non-shifted interpolant\n        l2_norm_sq_ns = (2.0/3.0) * a**2 + 2.0 * b**2\n        l2_norm_ns = np.sqrt(l2_norm_sq_ns)\n        \n        # The error for the shifted interpolant is 0 for all cases as derived.\n        l2_norm_sh = 0.0\n\n        results.append(l2_norm_ns)\n        results.append(l2_norm_sh)\n\n    # Format the final output string\n    # Using a high precision format string to avoid floating point representation issues.\n    output_str = f\"[{','.join(f'{r:.15f}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3564649"}, {"introduction": "Once a numerical method is formulated, its correctness must be rigorously verified. The patch test is a fundamental benchmark in computational mechanics that confirms whether a finite element formulation can exactly reproduce basic constant-strain states. This final practice guides you through performing a patch test for a two-element domain containing a crack modeled with a blended Heaviside enrichment [@problem_id:3564659], allowing you to prove from first principles that the assembled force residual is zero, thereby validating the consistency of the method.", "problem": "Consider a two-dimensional small-strain, linear-elastic, plane-stress body occupying the rectangle $\\Omega = [0,2L] \\times [0,H]$, with a straight, traction-free crack line $\\Gamma_{c}$ coincident with $y = H/2$ and extending from $x = 0$ to $x = 2L$. The body is partitioned into two linear triangular ($T3$) finite elements that cover the rectangle:\n- Element $e_{1}$ has nodes $1:(0,0)$, $2:(2L,0)$, and $3:(2L,H)$.\n- Element $e_{2}$ has nodes $1:(0,0)$, $3:(2L,H)$, and $4:(0,H)$.\n\nLet the displacement field be approximated using the Partition of Unity (PoU) with Heaviside-only extended finite element method (Extended Finite Element Method (XFEM)) enrichment and proper blending. Define the standard finite element interpolation by the linear shape functions $N_{i}(x,y)$ associated with node $i$, and the Heaviside step function $H(y - H/2)$ such that $H(y - H/2) = +1$ for $y > H/2$ and $H(y - H/2) = -1$ for $y < H/2$. Each node $i \\in \\{1,2,3,4\\}$ is enriched with a shifted Heaviside enrichment that ensures correct blending, so the enriched displacement contribution at node $i$ uses the corrected partition-of-unity function $N_{i}(x,y)\\left[H(y - H/2) - H(y_{i} - H/2)\\right]$, where $(x_{i},y_{i})$ is the coordinate of node $i$.\n\nAssume the material is homogeneous, isotropic, and linear elastic, with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The exact stress field is constant and given by\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{0} & 0 \\\\ 0 & 0 \\end{pmatrix},\n$$\nso that $\\sigma_{xx} = \\sigma_{0}$, $\\sigma_{yy} = 0$, and $\\sigma_{xy} = 0$. Body forces are absent, i.e., $\\boldsymbol{b} = \\boldsymbol{0}$. On the external boundary $\\partial\\Omega$, apply tractions $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}$, where $\\boldsymbol{n}$ is the outward unit normal, and the crack faces are traction-free, consistent with $\\boldsymbol{\\sigma}$ and the crack normal.\n\nUsing the principle of virtual work as the fundamental starting point, and the above discretization with PoU and shifted Heaviside enrichment, construct the assembled residual (internal minus external) vector for the two-element patch associated with:\n- the four standard nodal displacement degrees of freedom in $x$ and $y$ at nodes $1,2,3,4$, and\n- the four enriched nodal displacement degrees of freedom in $x$ and $y$ at nodes $1,2,3,4$ due to the Heaviside-only enrichment and blending.\n\nOrder the assembled residual vector as\n$$\n\\boldsymbol{R} = \\left( R_{u_{1}}, R_{v_{1}}, R_{u_{2}}, R_{v_{2}}, R_{u_{3}}, R_{v_{3}}, R_{u_{4}}, R_{v_{4}}, R_{a_{1x}}, R_{a_{1y}}, R_{a_{2x}}, R_{a_{2y}}, R_{a_{3x}}, R_{a_{3y}}, R_{a_{4x}}, R_{a_{4y}} \\right),\n$$\nwhere $u_{i}$ and $v_{i}$ are the standard $x$- and $y$-direction displacements at node $i$, and $a_{ix}$ and $a_{iy}$ are the enriched $x$- and $y$-direction displacement degrees of freedom at node $i$.\n\nDerive from first principles the expressions for each component of $\\boldsymbol{R}$ by evaluating the necessary domain and boundary integrals over the two elements, using the constant stress field, zero body forces, traction boundary loading $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}$, and traction-free crack. Carefully justify the role of blending through the shifted enrichment $N_{i}(x,y)\\left[H(y - H/2) - H(y_{i} - H/2)\\right]$ in the evaluation of the enriched residual components.\n\nCompute the assembled residual vector $\\boldsymbol{R}$ and provide its explicit value. Express each component in Newtons. No rounding is required.", "solution": "### Theoretical Analysis\nThe residual vector $\\boldsymbol{R}$ has components $R_k = F_k^{int} - F_k^{ext}$ corresponding to each degree of freedom $k$. The internal force is $F_k^{int} = \\int_\\Omega \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega$, and the external force is $F_k^{ext} = \\int_{\\partial\\Omega_t} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS + \\int_\\Omega \\boldsymbol{b} \\cdot \\delta\\boldsymbol{u}_k \\, d\\Omega$. The problem specifies using the exact stress field $\\boldsymbol{\\sigma}_{exact}$ for the internal force calculation.\n\nThe principle of virtual work in its weak form states that for a body in equilibrium, the internal work equals the external work for any admissible virtual displacement $\\delta\\boldsymbol{u}$. Mathematically, this is expressed using integration by parts (Green's theorem or the divergence theorem). For a virtual displacement field $\\boldsymbol{v}$ that may be discontinuous across a surface $\\Gamma_c$:\n$$ \\int_\\Omega \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{v} \\, d\\Omega = \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma n}) \\cdot \\boldsymbol{v} \\, dS - \\int_{\\Gamma_c} (\\boldsymbol{\\sigma n}) \\cdot [[\\boldsymbol{v}]] \\, dS - \\int_{\\Omega} (\\nabla\\cdot\\boldsymbol{\\sigma}) \\cdot \\boldsymbol{v} \\, d\\Omega $$\nwhere $[[\\boldsymbol{v}]]$ is the jump in $\\boldsymbol{v}$ across $\\Gamma_c$.\n\nIn this problem, $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}_{exact}$. It can be verified that:\n- $\\nabla \\cdot \\boldsymbol{\\sigma}_{exact} = \\boldsymbol{0}$ in $\\Omega$.\n- $\\boldsymbol{\\sigma}_{exact}\\boldsymbol{n} = \\boldsymbol{t}$ on the external boundary $\\partial\\Omega$ by definition.\n- The traction on the crack face $\\boldsymbol{t}_c = \\boldsymbol{\\sigma}_{exact}\\boldsymbol{n}$ is $\\boldsymbol{0}$ on $\\Gamma_c$.\n- Body forces $\\boldsymbol{b} = \\boldsymbol{0}$.\n\nSubstituting these into the identity, for any virtual displacement $\\delta\\boldsymbol{u}_k = \\boldsymbol{v}$:\n$$ \\int_\\Omega \\boldsymbol{\\sigma}_{exact} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega = \\int_{\\partial\\Omega} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS - \\int_{\\Gamma_c} \\boldsymbol{0} \\cdot [[\\delta\\boldsymbol{u}_k]] \\, dS - \\int_{\\Omega} \\boldsymbol{0} \\cdot \\delta\\boldsymbol{u}_k \\, d\\Omega $$\n$$ \\implies \\int_\\Omega \\boldsymbol{\\sigma}_{exact} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega = \\int_{\\partial\\Omega} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS $$\nThe left side is the internal force $F_k^{int}$. The right side is the external force $F_k^{ext}$ (since $\\boldsymbol{b}=\\boldsymbol{0}$).\nThus, $F_k^{int} = F_k^{ext}$ for every degree of freedom $k$. This holds for both standard and enriched (discontinuous) virtual displacements. Therefore, every component of the residual vector $\\boldsymbol{R} = \\boldsymbol{F}^{int} - \\boldsymbol{F}^{ext}$ must be zero.\n\nThe problem, however, asks for an explicit derivation by evaluating the integrals. We perform this calculation to verify the theoretical result.\n\n### Explicit Calculation of the Residual Vector\n\nFirst, define the finite element shape functions $N_i$.\nFor element $e_1$ (nodes $1(0,0), 2(2L,0), 3(2L,H)$), with Area $A_1 = LH$:\n$N_1^{e_1} = 1 - \\frac{x}{2L}$\n$N_2^{e_1} = \\frac{x}{2L} - \\frac{y}{H}$\n$N_3^{e_1} = \\frac{y}{H}$\n\nFor element $e_2$ (nodes $1(0,0), 3(2L,H), 4(0,H)$), with Area $A_2 = LH$:\nUsing the standard formula for T3 element shape functions:\n$N_1^{e_2} = \\frac{1}{2A_2}[(x_3y_4-x_4y_3)+(y_3-y_4)x+(x_4-x_3)y] = \\frac{1}{2LH}[(2LH-0)+(H-H)x+(0-2L)y] = 1 - \\frac{y}{H}$.\n$N_3^{e_2} = \\frac{1}{2A_2}[(x_4y_1-x_1y_4)+(y_4-y_1)x+(x_1-x_4)y] = \\frac{1}{2LH}[0+(H-0)x+(0-0)y] = \\frac{x}{2L}$.\n$N_4^{e_2} = \\frac{1}{2A_2}[(x_1y_3-x_3y_1)+(y_1-y_3)x+(x_3-x_1)y] = \\frac{1}{2LH}[0+(0-H)x+(2L-0)y] = \\frac{y}{H} - \\frac{x}{2L}$.\nThe sum is $(1 - y/H) + (x/2L) + (y/H - x/2L) = 1$, confirming correctness.\n\nThe virtual displacement for a DOF $k$ is $\\delta \\boldsymbol{u}_k$. The residual is $R_k = \\int_\\Omega \\boldsymbol{\\sigma}_{exact} : \\boldsymbol{\\varepsilon}(\\delta\\boldsymbol{u}_k) \\, d\\Omega - \\int_{\\partial\\Omega} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u}_k \\, dS$.\n\n**1. Residuals for y-direction DOFs ($R_{v_i}$ and $R_{a_{iy}}$)**\nFor any y-direction DOF (standard $v_k$ or enriched $a_{ky}$), the virtual displacement is $\\delta\\boldsymbol{u} = \\phi(\\boldsymbol{x}) (0, 1)^T$ where $\\phi$ is the corresponding basis function.\nThe virtual strains are $\\delta\\epsilon_{xx}=0$, $\\delta\\epsilon_{yy}=\\frac{\\partial \\phi}{\\partial y}$, $\\delta\\gamma_{xy}=\\frac{\\partial \\phi}{\\partial x}$.\nThe internal force component is:\n$F^{int} = \\int_\\Omega (\\sigma_{xx}\\delta\\epsilon_{xx} + \\sigma_{yy}\\delta\\epsilon_{yy} + \\sigma_{xy}\\delta\\gamma_{xy}) d\\Omega = \\int_\\Omega (\\sigma_0 \\cdot 0 + 0 \\cdot \\frac{\\partial \\phi}{\\partial y} + 0 \\cdot \\frac{\\partial \\phi}{\\partial x}) d\\Omega = 0$.\nThe external traction component $t_y$ is zero on all parts of the external boundary $\\partial\\Omega$.\n$F^{ext} = \\int_{\\partial\\Omega} t_y \\phi \\, dS = 0$.\nThus, $R_{v_i} = 0$ and $R_{a_{iy}} = 0$ for all $i \\in \\{1,2,3,4\\}$.\n\n**2. Residuals for x-direction Standard DOFs ($R_{u_i}$)**\nFor a standard DOF $u_k$, $\\delta\\boldsymbol{u} = N_k(\\boldsymbol{x}) (1, 0)^T$.\nVirtual strains: $\\delta\\epsilon_{xx}=\\frac{\\partial N_k}{\\partial x}$, $\\delta\\epsilon_{yy}=0$, $\\delta\\gamma_{xy}=\\frac{\\partial N_k}{\\partial y}$.\nInternal force: $F_{u_k}^{int} = \\int_\\Omega \\sigma_0 \\frac{\\partial N_k}{\\partial x} d\\Omega = \\sigma_0 \\int_\\Omega \\frac{\\partial N_k}{\\partial x} d\\Omega$.\nExternal force: $F_{u_k}^{ext} = \\int_{x=2L} \\sigma_0 N_k(2L,y) dy - \\int_{x=0} \\sigma_0 N_k(0,y) dy$.\n- For $k=1$: $\\frac{\\partial N_1^{e_1}}{\\partial x} = -1/(2L)$, $\\frac{\\partial N_1^{e_2}}{\\partial x}=0$. $N_1(2L,y)=0$, $N_1(0,y)=1-y/H$.\n  $F_{u_1}^{int} = \\sigma_0 \\int_{e_1} (-1/(2L)) dA = \\sigma_0 (-1/(2L)) A_1 = -\\sigma_0 H/2$.\n  $F_{u_1}^{ext} = 0 - \\int_0^H \\sigma_0 (1-y/H) dy = -\\sigma_0 [y-y^2/(2H)]_0^H = -\\sigma_0 H/2$.\n  $R_{u_1} = F_{u_1}^{int} - F_{u_1}^{ext} = 0$.\n- For $k=2$: $N_2$ exists only on $e_1$. $\\frac{\\partial N_2^{e_1}}{\\partial x} = 1/(2L)$. $N_2(0,y)=0$, $N_2(2L,y)=1-y/H$.\n  $F_{u_2}^{int} = \\sigma_0 \\int_{e_1} (1/(2L)) dA = \\sigma_0 A_1/(2L) = \\sigma_0 H/2$.\n  $F_{u_2}^{ext} = \\int_0^H \\sigma_0 (1-y/H) dy - 0 = \\sigma_0 H/2$.\n  $R_{u_2} = F_{u_2}^{int} - F_{u_2}^{ext} = 0$.\n- For $k=3$: $\\frac{\\partial N_3^{e_1}}{\\partial x} = 0$, $\\frac{\\partial N_3^{e_2}}{\\partial x}=1/(2L)$. $N_3(0,y)=0$, $N_3(2L,y)=y/H$.\n  $F_{u_3}^{int} = \\sigma_0 \\int_{e_2} (1/(2L)) dA = \\sigma_0 A_2/(2L) = \\sigma_0 H/2$.\n  $F_{u_3}^{ext} = \\int_0^H \\sigma_0 (y/H) dy - 0 = \\sigma_0 [y^2/(2H)]_0^H = \\sigma_0 H/2$.\n  $R_{u_3} = F_{u_3}^{int} - F_{u_3}^{ext} = 0$.\n- For $k=4$: $N_4$ exists only on $e_2$. $\\frac{\\partial N_4^{e_2}}{\\partial x} = -1/(2L)$. $N_4(2L,y)=0$, $N_4(0,y)=y/H$.\n  $F_{u_4}^{int} = \\sigma_0 \\int_{e_2} (-1/(2L)) dA = -\\sigma_0 A_2/(2L) = -\\sigma_0 H/2$.\n  $F_{u_4}^{ext} = 0 - \\int_0^H \\sigma_0 (y/H) dy = -\\sigma_0 H/2$.\n  $R_{u_4} = F_{u_4}^{int} - F_{u_4}^{ext} = 0$.\n\nAll standard residuals are zero.\n\n**3. Residuals for x-direction Enriched DOFs ($R_{a_{ix}}$)**\nFor an enriched DOF $a_{kx}$, the basis function is $\\Phi_k(\\boldsymbol{x}) = N_k(\\boldsymbol{x}) \\psi_k(y)$, where $\\psi_k(y) = H(y-H/2) - H(y_k-H/2)$.\nInternal force: $F_{a_{kx}}^{int} = \\int_\\Omega \\sigma_0 \\frac{\\partial \\Phi_k}{\\partial x} d\\Omega = \\sigma_0 \\int_\\Omega \\psi_k(y) \\frac{\\partial N_k}{\\partial x} d\\Omega$.\nExternal force: $F_{a_{kx}}^{ext} = \\int_{x=2L} \\sigma_0 \\Phi_k(2L,y) dy - \\int_{x=0} \\sigma_0 \\Phi_k(0,y) dy$.\n\n- For $k=1$ (node at $y_1=0$): $\\psi_1(y) = H(y-H/2) - (-1) = H(y-H/2)+1$. This is $0$ for $y<H/2$ and $2$ for $y>H/2$.\n  $F_{a_{1x}}^{int} = \\sigma_0 \\int_{e_1} (H(y-H/2)+1) \\frac{\\partial N_1^{e_1}}{\\partial x} dA = \\sigma_0 \\int_{e_1, y>H/2} 2 (-1/(2L)) dA$. The region is a triangle with area $LH/4$.\n  $F_{a_{1x}}^{int} = \\sigma_0 \\cdot 2 \\cdot (-1/(2L)) \\cdot (LH/4) = -\\sigma_0 H/4$.\n  $F_{a_{1x}}^{ext} = 0 - \\sigma_0 \\int_0^H \\Phi_1(0,y) dy = -\\sigma_0 \\int_{H/2}^H N_1(0,y) \\cdot 2 \\, dy = -2\\sigma_0 \\int_{H/2}^H (1-y/H) dy = -2\\sigma_0 [y-y^2/(2H)]_{H/2}^H = -2\\sigma_0 (H/8) = -\\sigma_0 H/4$.\n  $R_{a_{1x}} = F_{a_{1x}}^{int} - F_{a_{1x}}^{ext} = 0$.\n\n- For $k=2$ (node at $y_2=0$): $\\psi_2(y) = H(y-H/2)+1$.\n  $F_{a_{2x}}^{int} = \\sigma_0 \\int_{e_1} (H(y-H/2)+1) \\frac{\\partial N_2^{e_1}}{\\partial x} dA = \\sigma_0 \\int_{e_1, y>H/2} 2 (1/(2L)) dA$. Area is $LH/4$.\n  $F_{a_{2x}}^{int} = \\sigma_0 \\cdot 2 \\cdot (1/(2L)) \\cdot (LH/4) = \\sigma_0 H/4$.\n  $F_{a_{2x}}^{ext} = \\sigma_0 \\int_0^H \\Phi_2(2L,y) dy - 0 = \\sigma_0 \\int_{H/2}^H N_2(2L,y) \\cdot 2 \\, dy = 2\\sigma_0 \\int_{H/2}^H (1-y/H) dy = 2\\sigma_0 (H/8) = \\sigma_0 H/4$.\n  $R_{a_{2x}} = F_{a_{2x}}^{int} - F_{a_{2x}}^{ext} = 0$.\n\n- For $k=3$ (node at $y_3=H$): $\\psi_3(y) = H(y-H/2) - 1$. This is $-2$ for $y<H/2$ and $0$ for $y>H/2$.\n  $F_{a_{3x}}^{int} = \\sigma_0 \\int_{e_2} (H(y-H/2)-1) \\frac{\\partial N_3^{e_2}}{\\partial x} dA = \\sigma_0 \\int_{e_2, y<H/2} (-2) (1/(2L)) dA$. The region is a triangle with area $LH/4$.\n  $F_{a_{3x}}^{int} = \\sigma_0 \\cdot (-2) \\cdot (1/(2L)) \\cdot (LH/4) = -\\sigma_0 H/4$.\n  $F_{a_{3x}}^{ext} = \\sigma_0 \\int_0^H \\Phi_3(2L,y) dy - 0 = \\sigma_0 \\int_0^{H/2} N_3(2L,y) \\cdot (-2) \\, dy = -2\\sigma_0 \\int_0^{H/2} (y/H) dy = -2\\sigma_0/H [y^2/2]_0^{H/2} = -2\\sigma_0/H (H^2/8) = -\\sigma_0 H/4$.\n  $R_{a_{3x}} = F_{a_{3x}}^{int} - F_{a_{3x}}^{ext} = 0$.\n\n- For $k=4$ (node at $y_4=H$): $\\psi_4(y) = H(y-H/2)-1$.\n  $F_{a_{4x}}^{int} = \\sigma_0 \\int_{e_2} (H(y-H/2)-1) \\frac{\\partial N_4^{e_2}}{\\partial x} dA = \\sigma_0 \\int_{e_2, y<H/2} (-2) (-1/(2L)) dA$. Area is $LH/4$.\n  $F_{a_{4x}}^{int} = \\sigma_0 \\cdot (-2) \\cdot (-1/(2L)) \\cdot (LH/4) = \\sigma_0 H/4$.\n  $F_{a_{4x}}^{ext} = 0 - \\sigma_0 \\int_0^H \\Phi_4(0,y) dy = -\\sigma_0 \\int_0^{H/2} N_4(0,y) \\cdot (-2) \\, dy = 2\\sigma_0 \\int_0^{H/2} (y/H) dy = 2\\sigma_0/H (H^2/8) = \\sigma_0 H/4$.\n  $R_{a_{4x}} = F_{a_{4x}}^{int} - F_{a_{4x}}^{ext} = 0$.\n\nAll enriched x-direction residuals are zero. The role of the blending term, which makes the enrichment $N_{i}(x,y)\\left[H(y - H/2) - H(y_{i} - H/2)\\right]$ zero at node $i$, is to modify the basis functions of the enriched DOFs. The calculation demonstrates that for a system in equilibrium, the residual remains zero irrespective of the specific choice of basis functions, as long as they are valid test functions in the weak form.\n\n### Conclusion\nAll 16 components of the assembled residual vector $\\boldsymbol{R}$ are zero.\n$R_{u_1}=0, R_{v_1}=0, R_{u_2}=0, R_{v_2}=0, R_{u_3}=0, R_{v_3}=0, R_{u_4}=0, R_{v_4}=0$\n$R_{a_{1x}}=0, R_{a_{1y}}=0, R_{a_{2x}}=0, R_{a_{2y}}=0, R_{a_{3x}}=0, R_{a_{3y}}=0, R_{a_{4x}}=0, R_{a_{4y}}=0$\n\nThe assembled residual vector $\\boldsymbol{R}$ is the zero vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "3564659"}]}