{"hands_on_practices": [{"introduction": "The core idea of residual-based error estimation is to measure how well a computed solution satisfies the underlying physical laws. This practice [@problem_id:3595950] breaks this abstract concept down into its fundamental, computable parts: the interior element residual, which checks equilibrium within each element, and the edge jump residual, which checks force balance between elements. By working through a concrete example with a nonlinear material, you will gain hands-on experience in applying these definitions, which are the building blocks of adaptive finite element analysis.", "problem": "Consider a two-dimensional reference configuration given by the unit square with coordinates $(X,Y) \\in [0,1] \\times [0,1]$. The square is partitioned into two triangular finite elements by the diagonal edge from $(0,0)$ to $(1,1)$:\n- Element $K_{1}$ has vertices $(0,0)$, $(1,0)$, $(1,1)$.\n- Element $K_{2}$ has vertices $(0,0)$, $(0,1)$, $(1,1)$.\nLet $E_{0}$ denote the interior edge shared by $K_{1}$ and $K_{2}$ from $(0,0)$ to $(1,1)$.\n\nThe material is a compressible Neo-Hookean solid with stored-energy density\n$$\nW(F) = \\frac{\\mu}{2}\\big(\\mathrm{tr}(C)-3\\big) - \\mu \\ln J + \\frac{\\lambda}{2}(\\ln J)^{2},\n$$\nwhere $F$ is the deformation gradient, $C = F^\\top F$ is the right Cauchy-Green tensor, $J = \\det(F)$, and $\\mu, \\lambda$ are the Lamé parameters. Assume plane strain kinematics. The First Piola–Kirchhoff stress (FPK stress) $P(F)$ is defined by $P(F) = \\partial W / \\partial F$.\n\nAssume a piecewise-affine finite element displacement field whose gradient is piecewise constant and equal to the following values:\n$$\nF_{h}\\big|_{K_{1}} = \\begin{pmatrix} 1.1 & 0 \\\\ 0 & 1.0 \\end{pmatrix}, \\qquad\nF_{h}\\big|_{K_{2}} = \\begin{pmatrix} 0.9 & 0 \\\\ 0 & 1.0 \\end{pmatrix}.\n$$\nTake material parameters $\\mu = 80\\,\\mathrm{kPa}$ and $\\lambda = 120\\,\\mathrm{kPa}$. Let the body force be constant in the reference configuration, $b = (0.4,-0.2)\\,\\mathrm{kN/m}^{3}$, and let the prescribed traction on the external boundary be homogeneous, i.e., $t = (0,0)$ on all Neumann segments.\n\nStarting from the strong form of momentum balance in the reference configuration,\n$$\n\\mathrm{Div}\\,P(F) + b = 0 \\quad \\text{in the domain},\n$$\nand the traction boundary condition on a Neumann boundary,\n$$\nP(F)\\,n = t \\quad \\text{on the boundary},\n$$\nderive the expressions needed to evaluate the element residual and the edge jump that define residual-based error indicators for the piecewise-constant $F_{h}$:\n- The element residual over $K$ is the vector field $R_{K} = \\mathrm{Div}\\,P(F_{h}) + b$.\n- The interior-edge jump across $E$ shared by elements $K^{+}$ and $K^{-}$ is the vector field $J_{E} = P(F_{h}^{+})\\,n^{+} + P(F_{h}^{-})\\,n^{-}$, where $n^{\\pm}$ are the outward unit normals of $K^{\\pm}$ on $E$.\n\nUse the following size measures:\n- For each element, $h_{K}$ is the element diameter (the longest distance between any two points in $K$).\n- For the interior edge $E_{0}$, $h_{E_{0}}$ is the edge length.\n\nDefine the residual-based indicators as\n$$\nr_{K} = h_{K}\\,\\|R_{K}\\|_{L^{2}(K)}, \\qquad\nj_{E_{0}} = h_{E_{0}}^{1/2}\\,\\|J_{E_{0}}\\|_{L^{2}(E_{0})},\n$$\nwhere $\\|\\cdot\\|_{L^{2}}$ denotes the $L^{2}$-norm over the indicated set. For this configuration, use the unit normal on $E_{0}$ pointing outward from $K_{1}$ as $n^{+} = \\frac{1}{\\sqrt{2}}(-1,\\,1)$ and hence $n^{-} = -n^{+}$ outward from $K_{2}$.\n\nUsing these definitions, compute the total indicator\n$$\n\\eta = \\Big(r_{K_{1}}^{2} + r_{K_{2}}^{2} + j_{E_{0}}^{2}\\Big)^{1/2}.\n$$\nExpress the final value of $\\eta$ in $\\mathrm{kN/m}$ and round your answer to four significant figures.", "solution": "The user has provided a well-defined problem in computational solid mechanics. The problem is scientifically grounded, self-contained, and all provided data are consistent. Therefore, the problem is deemed valid and a full solution can be provided.\n\nThe objective is to compute the total residual-based error indicator $\\eta = \\Big(r_{K_{1}}^{2} + r_{K_{2}}^{2} + j_{E_{0}}^{2}\\Big)^{1/2}$. This requires the calculation of the element indicators $r_{K}$ and the edge indicator $j_{E_{0}}$.\n\nThe First Piola-Kirchhoff (FPK) stress $P$ is derived from the stored-energy density $W(F)$ as $P(F) = \\partial W/\\partial F$. For the given compressible Neo-Hookean model,\n$$\nW(F) = \\frac{\\mu}{2}\\big(\\mathrm{tr}(C)-3\\big) - \\mu \\ln J + \\frac{\\lambda}{2}(\\ln J)^{2}\n$$\nthe FPK stress is given by the standard formula:\n$$\nP(F) = \\mu F + (\\lambda \\ln J - \\mu) F^{-\\top}\n$$\nwhere $F$ is the deformation gradient, $J = \\det(F)$, and $\\mu, \\lambda$ are Lamé parameters.\n\nFirst, we compute the element residual indicators $r_{K_1}$ and $r_{K_2}$. The element residual is defined as $R_{K} = \\mathrm{Div}\\,P(F_{h}) + b$. The problem specifies a piecewise-constant deformation gradient $F_h$. Consequently, the stress tensor $P(F_h)$ is also piecewise-constant within each element. The divergence of a constant tensor is zero, i.e., $\\mathrm{Div}\\,P(F_{h}) = 0$ in the interior of each element $K$. Therefore, the element residual simplifies to the body force:\n$$\nR_{K_1} = b \\quad \\text{and} \\quad R_{K_2} = b\n$$\nThe body force is given as $b = (0.4, -0.2)\\,\\mathrm{kN/m}^{3}$. Thus, its squared magnitude is:\n$$\n|b|^2 = (0.4)^2 + (-0.2)^2 = 0.16 + 0.04 = 0.20 \\, (\\mathrm{kN/m}^3)^2\n$$\nThe element indicator is $r_{K} = h_{K}\\,\\|R_{K}\\|_{L^{2}(K)}$. Since $R_K=b$ is constant over the element, its $L^2$-norm is $\\|R_K\\|_{L^2(K)} = \\left(\\int_K |b|^2 dA\\right)^{1/2} = |b| \\sqrt{\\text{Area}(K)}$.\nThe elements $K_1$ and $K_2$ are right triangles with vertices $(0,0), (1,0), (1,1)$ and $(0,0), (0,1), (1,1)$ respectively. Both have an area of $1/2$.\n$$\n\\text{Area}(K_1) = \\text{Area}(K_2) = \\frac{1}{2} \\cdot 1 \\cdot 1 = \\frac{1}{2} \\, \\mathrm{m}^2\n$$\nThe diameter $h_K$ of an element is the length of its longest side. For $K_1$ with vertices $(0,0)$, $(1,0)$, and $(1,1)$, the side lengths are $1$, $1$, and $\\sqrt{1^2+1^2} = \\sqrt{2}$. Thus, the diameter is $h_{K_1}=\\sqrt{2}\\,\\mathrm{m}$. Similarly, for $K_2$ with vertices $(0,0)$, $(0,1)$, and $(1,1)$, the side lengths are $1$, $1$, and $\\sqrt{2}$, so the diameter is $h_{K_2}=\\sqrt{2}\\,\\mathrm{m}$.\nWe can now compute the squared element indicators:\n$$\nr_{K}^2 = h_{K}^2 \\|R_K\\|_{L^2(K)}^2 = h_K^2 |b|^2 \\text{Area}(K)\n$$\nFor both elements $K_1$ and $K_2$:\n$$\nr_{K_1}^2 = r_{K_2}^2 = (\\sqrt{2})^2 \\cdot 0.20 \\cdot \\frac{1}{2} = 2 \\cdot 0.20 \\cdot 0.5 = 0.20 \\, (\\mathrm{kN/m})^2\n$$\n\nNext, we compute the interior edge indicator $j_{E_0}$. The jump is $J_{E_{0}} = P(F_{h}^{+})\\,n^{+} + P(F_{h}^{-})\\,n^{-}$. With $K_1=K^+$, $K_2=K^-$, $F_1=F_h^+$, $F_2=F_h^-$, and $n^- = -n^+$, this becomes:\n$$\nJ_{E_0} = (P(F_1) - P(F_2))n^+\n$$\nLet's compute the stress tensors $P_1 = P(F_1)$ and $P_2 = P(F_2)$ using $\\mu = 80\\,\\mathrm{kPa}$ and $\\lambda = 120\\,\\mathrm{kPa}$.\n\nFor element $K_1$:\n$F_1 = \\begin{pmatrix} 1.1 & 0 \\\\ 0 & 1.0 \\end{pmatrix}$. Thus, $J_1 = \\det(F_1) = 1.1$ and $F_1^{-\\top} = \\begin{pmatrix} 1/1.1 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\n$$\nP_1 = 80 \\begin{pmatrix} 1.1 & 0 \\\\ 0 & 1 \\end{pmatrix} + (120 \\ln(1.1) - 80) \\begin{pmatrix} 1/1.1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 88 + \\frac{120\\ln(1.1)-80}{1.1} & 0 \\\\ 0 & 120\\ln(1.1) \\end{pmatrix}\n$$\n\nFor element $K_2$:\n$F_2 = \\begin{pmatrix} 0.9 & 0 \\\\ 0 & 1.0 \\end{pmatrix}$. Thus, $J_2 = \\det(F_2) = 0.9$ and $F_2^{-\\top} = \\begin{pmatrix} 1/0.9 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\n$$\nP_2 = 80 \\begin{pmatrix} 0.9 & 0 \\\\ 0 & 1 \\end{pmatrix} + (120 \\ln(0.9) - 80) \\begin{pmatrix} 1/0.9 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 72 + \\frac{120\\ln(0.9)-80}{0.9} & 0 \\\\ 0 & 120\\ln(0.9) \\end{pmatrix}\n$$\nThe difference in stress is $\\Delta P = P_1 - P_2 = \\text{diag}(\\Delta P_{11}, \\Delta P_{22})$:\n$$\n\\Delta P_{11} = \\left(88 + \\frac{120\\ln(1.1)-80}{1.1}\\right) - \\left(72 + \\frac{120\\ln(0.9)-80}{0.9}\\right) \\approx 56.60716\\,\\mathrm{kPa}\n$$\n$$\n\\Delta P_{22} = 120\\ln(1.1) - 120\\ln(0.9) = 120\\ln\\left(\\frac{1.1}{0.9}\\right) \\approx 24.08048\\,\\mathrm{kPa}\n$$\nThe normal vector is $n^+ = \\frac{1}{\\sqrt{2}}(-1, 1)^T$. The jump vector is constant along the edge:\n$$\nJ_{E_0} = \\Delta P n^+ = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -\\Delta P_{11} \\\\ \\Delta P_{22} \\end{pmatrix}\n$$\nThe squared magnitude of the jump vector is:\n$$\n|J_{E_0}|^2 = \\frac{1}{2}(\\Delta P_{11}^2 + \\Delta P_{22}^2) \\approx \\frac{1}{2}((56.60716)^2 + (24.08048)^2) \\approx 1892.122 \\, (\\mathrm{kPa})^2\n$$\nThe interior edge indicator is $j_{E_0} = h_{E_0}^{1/2} \\|J_{E_0}\\|_{L^2(E_0)}$. Since $J_{E_0}$ is constant, $\\|J_{E_0}\\|_{L^2(E_0)} = |J_{E_0}| \\sqrt{h_{E_0}}$. The length of the edge $E_0$ is $h_{E_0} = \\sqrt{2}\\,\\mathrm{m}$.\nSo, $j_{E_0} = h_{E_0}^{1/2} (|J_{E_0}| h_{E_0}^{1/2}) = h_{E_0} |J_{E_0}|$. The squared indicator is:\n$$\nj_{E_0}^2 = h_{E_0}^2 |J_{E_0}|^2 = (\\sqrt{2})^2 \\cdot |J_{E_0}|^2 = 2 \\cdot \\frac{1}{2}(\\Delta P_{11}^2 + \\Delta P_{22}^2) = \\Delta P_{11}^2 + \\Delta P_{22}^2\n$$\nThe units of this quantity are $\\mathrm{m}^2 \\cdot (\\mathrm{kPa})^2 = \\mathrm{m}^2 \\cdot (\\mathrm{kN/m^2})^2 = (\\mathrm{kN/m})^2$.\n$$\nj_{E_0}^2 \\approx (56.60716)^2 + (24.08048)^2 \\approx 3204.375 + 579.870 \\approx 3784.245 \\, (\\mathrm{kN/m})^2\n$$\n\nFinally, the total indicator $\\eta$ is computed:\n$$\n\\eta^2 = r_{K_1}^2 + r_{K_2}^2 + j_{E_0}^2 \\approx 0.20 + 0.20 + 3784.245 = 3784.645 \\, (\\mathrm{kN/m})^2\n$$\n$$\n\\eta = \\sqrt{3784.645} \\approx 61.519468 \\, \\mathrm{kN/m}\n$$\nRounding to four significant figures, we get $\\eta = 61.52\\,\\mathrm{kN/m}$.", "answer": "$$\n\\boxed{61.52}\n$$", "id": "3595950"}, {"introduction": "Beyond simply estimating the magnitude of the error, residual-based indicators serve as powerful diagnostic tools for identifying the *source* and *nature* of numerical inaccuracies. This practice [@problem_id:3595875] demonstrates this capability by focusing on a specific volumetric residual designed to monitor the pressure-dilatation constitutive law. You will see how its magnitude and pattern can unequivocally signal the presence of spurious pressure oscillations, a common pathology linked to volumetric locking in simulations of nearly incompressible materials.", "problem": "Consider small-strain, plane-strain, linear elastic solids with displacement field $u$ and pressure-like field $p$ introduced by the volumetric-deviatoric split of the Cauchy stress. The stress is decomposed as $\\sigma = -p I + 2 \\mu \\varepsilon^{\\mathrm{dev}}(u)$, where $\\varepsilon(u) = \\frac{1}{2} \\left( \\nabla u + \\nabla u^\\top \\right)$ is the small-strain tensor, $\\varepsilon^{\\mathrm{dev}}(u) = \\varepsilon(u) - \\frac{1}{2} \\operatorname{tr} \\varepsilon(u) I$ in two dimensions, $\\mu$ is the shear modulus, and $I$ is the identity tensor. In the mixed displacement-pressure formulation for nearly incompressible elasticity, the volumetric constitutive relation is $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$, where $\\kappa$ is the bulk modulus. The strong form of equilibrium is $\\nabla \\cdot \\sigma + b = 0$ in a domain $\\Omega$, with body force $b$ and appropriate boundary conditions.\n\nA residual-based error indicator can be built from the strong form and constitutive relations. In particular, the elementwise volumetric residual is defined as $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$ on each element $K$, where $(u_h, p_h)$ are the finite element approximations.\n\nVolumetric locking refers to the spurious stiffening and suppression of volumetric strain that occurs in displacement-only formulations as $\\kappa \\to \\infty$. In mixed formulations that are not Ladyzhenskaya–Babuška–Brezzi (LBB) stable (for example, equal-order bilinear $Q_1$–$Q_1$ elements for $(u_h, p_h)$), spurious pressure oscillations such as checkerboard patterns can arise.\n\nConsider the unit square domain $\\Omega = (0,1) \\times (0,1)$ under uniform hydrostatic compression with traction $t = -p_{\\mathrm{ext}} n$ applied on $\\partial \\Omega$ and no body force, with material parameters $\\mu = 1$ and $\\kappa = 1000$ (non-dimensionalized for simplicity). On a $2 \\times 2$ structured mesh, suppose a computed equal-order mixed solution exhibits the following elementwise fields:\n- The volumetric strain is nearly uniform: $\\operatorname{tr} \\varepsilon(u_h) \\approx s$ with $s = 0.002$ in every element.\n- The pressure shows a checkerboard oscillation: $p_h = +5$ on the top-left and bottom-right elements, and $p_h = -5$ on the top-right and bottom-left elements.\n\nDefine $r_{p,K}$ for each of the four elements and reason from the governing equations and constitutive relation how the magnitude and pattern of $r_{p,K}$ can be used to diagnose spurious pressure oscillations and the interplay with volumetric locking.\n\nWhich of the following statements are correct?\n\nA. In this scenario, the alternation of $p_h$ in sign will induce an alternation of $r_{p,K}$ in sign with large magnitude on the $2 \\times 2$ mesh, and this alternating pattern is a hallmark of a spurious pressure mode caused by violation of the Ladyzhenskaya–Babuška–Brezzi condition; additionally, the sensitivity of $r_{p,K}$ to such oscillations increases with $\\kappa$.\n\nB. If the equilibrium equation $\\nabla \\cdot \\sigma + b = 0$ happens to be satisfied elementwise in the discrete solution, then $r_{p,K}$ necessarily vanishes in every element, so a residual-based estimator cannot detect pressure oscillations.\n\nC. For equal-order $Q_1$–$Q_1$ interpolation in the nearly incompressible regime, reducing the mesh size alone ensures the checkerboard pattern in $p_h$ disappears and $r_{p,K} \\to 0$ uniformly as $h \\to 0$.\n\nD. If $r_{p,K}$ is constant and positive over all elements, this indicates a smooth pressure field and demonstrates that the mixed formulation has eliminated volumetric locking.\n\nE. Replacing the equal-order pair with an LBB-stable mixed pair (for example, Taylor–Hood) under the same loading and comparable mesh resolution yields $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$ elementwise, thereby driving $r_{p,K}$ close to zero and removing the alternating pattern.\n\nSelect all that apply.", "solution": "The problem statement is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Model**: Small-strain, plane-strain, linear elastic solid.\n- **Formulation**: Mixed displacement-pressure formulation with fields $u$ (displacement) and $p$ (pressure-like).\n- **Stress-Strain Relation**: Cauchy stress $\\sigma = -p I + 2 \\mu \\varepsilon^{\\mathrm{dev}}(u)$.\n- **Strain Tensor**: $\\varepsilon(u) = \\frac{1}{2} \\left( \\nabla u + \\nabla u^\\top \\right)$.\n- **Deviatoric Strain (2D)**: $\\varepsilon^{\\mathrm{dev}}(u) = \\varepsilon(u) - \\frac{1}{2} \\operatorname{tr} \\varepsilon(u) I$.\n- **Volumetric Constitutive Relation**: $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$.\n- **Constants**: $\\mu$ is the shear modulus, $\\kappa$ is the bulk modulus.\n- **Equilibrium Equation**: $\\nabla \\cdot \\sigma + b = 0$ in domain $\\Omega$.\n- **Error Indicator Definition**: Elementwise volumetric residual $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$ for a finite element approximation $(u_h, p_h)$ on element $K$.\n- **Scenario**:\n    - Domain: $\\Omega = (0,1) \\times (0,1)$.\n    - Loading: Uniform hydrostatic compression with traction $t = -p_{\\mathrm{ext}} n$ on $\\partial \\Omega$. Body force $b=0$.\n    - Material Parameters: $\\mu = 1$, $\\kappa = 1000$.\n    - Mesh: $2 \\times 2$ structured mesh.\n    - Finite Element Method: Equal-order ($Q_1$–$Q_1$) mixed formulation.\n    - Computed Solution Fields:\n        - Volumetric strain: $\\operatorname{tr} \\varepsilon(u_h) \\approx s = 0.002$ in every element.\n        - Pressure: $p_h = +5$ on top-left and bottom-right elements; $p_h = -5$ on top-right and bottom-left elements.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Groundedness**: The problem is based on standard, well-established principles of continuum mechanics and the finite element method for nearly incompressible elasticity. The mixed $u-p$ formulation, volumetric-deviatoric split, Ladyzhenskaya–Babuška–Brezzi (LBB) condition, and residual-based error estimation are all core concepts in computational mechanics. The governing equations are correctly stated.\n- **Well-Posedness**: The problem presents a hypothetical but realistic outcome of a numerical simulation using an LBB-unstable element pair ($Q_1$–$Q_1$) for a nearly incompressible problem. The presented checkerboard pressure field is a classic manifestation of this instability. The question asks for an analysis of this given result using a defined residual, which is a well-posed diagnostic task.\n- **Consistency and Completeness**: The problem provides all necessary data and definitions to calculate the residual and evaluate its behavior. There is a potential inconsistency: \"hydrostatic compression\" should physically result in a negative volumetric strain ($\\operatorname{tr} \\varepsilon(u) < 0$), whereas the given computed solution has a positive volumetric strain ($\\operatorname{tr} \\varepsilon(u_h) \\approx 0.002 > 0$). However, the problem asks to analyze a given \"computed ... solution,\" which can be, and in this case is, physically incorrect. The task is to use the residual to diagnose this incorrectness. The inconsistency is part of the pathological solution to be analyzed, rather than a flaw in the problem statement itself. The problem is a valid \"what if\" scenario for diagnostic purposes.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It describes a classic scenario in computational mechanics and poses a relevant question about error analysis. The solution process may now proceed.\n\n### Solution Derivation\nThe primary task is to analyze the volumetric residual, $r_{p,K}$, which is defined as the elementwise error in satisfying the volumetric constitutive relation.\nThe definition is given as:\n$$r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$$\nWe are given the following information for a $2 \\times 2$ mesh of a domain discretized with equal-order quadrilateral elements ($Q_1-Q_1$):\n- Bulk modulus: $\\kappa = 1000$.\n- Volumetric strain is approximately constant: $\\operatorname{tr} \\varepsilon(u_h) \\approx s = 0.002$.\n- The discrete pressure field $p_h$ exhibits a checkerboard pattern. Let's label the elements:\n    - $K_{TL}$ (top-left) and $K_{BR}$ (bottom-right): $p_h = +5$.\n    - $K_{TR}$ (top-right) and $K_{BL}$ (bottom-left): $p_h = -5$.\n\nWe can now compute the residual $r_{p,K}$ for each element.\n\nFor the elements where $p_h = +5$ ($K_{TL}$ and $K_{BR}$):\n$$r_{p,K} \\approx 5 + (1000)(0.002) = 5 + 2 = 7$$\n\nFor the elements where $p_h = -5$ ($K_{TR}$ and $K_{BL}$):\n$$r_{p,K} \\approx -5 + (1000)(0.002) = -5 + 2 = -3$$\n\nThe theoretical solution for uniform hydrostatic compression should have a constant pressure $p = p_{\\mathrm{ext}}$ and a constant negative volumetric strain $\\operatorname{tr} \\varepsilon(u) = -p_{\\mathrm{ext}}/\\kappa$. For the exact solution, the volumetric constitutive relation $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$ is satisfied exactly, meaning the true residual is zero everywhere.\n\nOur calculation based on the given FE solution shows that a checkerboard pattern in the pressure field $p_h$ directly produces a large-magnitude, oscillating pattern in the residual field $r_{p,K}$. The values alternate between approximately $7$ and $-3$. This non-zero, oscillating residual indicates that the numerical solution fails to satisfy the constitutive law and that this failure is linked to the spurious pressure mode. This demonstrates the diagnostic capability of the residual $r_{p,K}$.\n\n### Option-by-Option Analysis\n\n**A. In this scenario, the alternation of $p_h$ in sign will induce an alternation of $r_{p,K}$ in sign with large magnitude on the $2 \\times 2$ mesh, and this alternating pattern is a hallmark of a spurious pressure mode caused by violation of the Ladyzhenskaya–Babuška–Brezzi condition; additionally, the sensitivity of $r_{p,K}$ to such oscillations increases with $\\kappa$.**\n\n- Our calculation shows $r_{p,K}$ alternates between $\\approx 7$ and $\\approx -3$. This is an alternation in sign and the magnitudes are large.\n- The checkerboard pressure pattern is the canonical spurious mode for the $Q_1$–$Q_1$ element pair, which is known to violate the LBB stability condition. The residual $r_{p,K}$ inherits this pattern, making it an effective indicator.\n- The residual is $r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$. As $\\kappa \\to \\infty$ (the incompressible limit), any error in approximating the condition $\\operatorname{tr} \\varepsilon(u_h) = 0$ is amplified by the large factor $\\kappa$. This makes the residual a highly sensitive measure of volumetric error in the nearly incompressible regime.\nThus, the statement is a correct and complete description of the situation.\n**Verdict: Correct**\n\n**B. If the equilibrium equation $\\nabla \\cdot \\sigma + b = 0$ happens to be satisfied elementwise in the discrete solution, then $r_{p,K}$ necessarily vanishes in every element, so a residual-based estimator cannot detect pressure oscillations.**\n\n- This statement confuses two distinct sources of residual error. The residual for the equilibrium equation is $r_{\\sigma} := \\nabla \\cdot \\sigma_h + b$. The volumetric residual is $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$. These correspond to two separate equations in the strong form of the problem.\n- A numerical solution can satisfy one equation well while failing to satisfy the other. Specifically, the checkerboard pressure mode is problematic because it lies (nearly) in the null space of the discrete gradient operator, meaning $\\nabla \\cdot (-p_h I)$ can be small even if $p_h$ is large and oscillatory. Therefore, the equilibrium residual $r_{\\sigma}$ can be small, while the constitutive residual $r_{p,K}$ is large due to the oscillating $p_h$.\n- The premise does not imply the conclusion. The two residuals are independent indicators of different types of error.\n**Verdict: Incorrect**\n\n**C. For equal-order $Q_1$–$Q_1$ interpolation in the nearly incompressible regime, reducing the mesh size alone ensures the checkerboard pattern in $p_h$ disappears and $r_{p,K} \\to 0$ uniformly as $h \\to 0$.**\n\n- This statement is false. The LBB condition is a property of the chosen finite element spaces for displacement and pressure, independent of the mesh size $h$ (though the LBB constant may depend on $h$).\n- For an LBB-unstable pair like $Q_1$–$Q_1$, the pressure approximation is not guaranteed to converge to the correct solution as the mesh is refined. The spurious oscillations typically persist and do not vanish upon mesh refinement ($h \\to 0$).\n- To eliminate the checkerboard modes, one must either switch to an LBB-stable element pair (e.g., Taylor-Hood $Q_2-P_1$) or introduce a stabilization term into the variational formulation (e.g., GLS or PSPG methods). Mesh refinement alone is not a remedy.\n**Verdict: Incorrect**\n\n**D. If $r_{p,K}$ is constant and positive over all elements, this indicates a smooth pressure field and demonstrates that the mixed formulation has eliminated volumetric locking.**\n\n- A non-zero residual ($r_{p,K} = C > 0$) signifies that the numerical solution violates the volumetric constitutive law, which should be $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$. This indicates an error in the solution, not a success.\n- While a constant residual would rule out the specific alternating checkerboard pattern, it does not guarantee a \"smooth\" or correct pressure field.\n- More importantly, it does not demonstrate the elimination of volumetric locking. Volumetric locking is the spurious suppression of volumetric strain. If locking occurs, $\\operatorname{tr} \\varepsilon(u_h)$ might be driven to an artificially small value (e.g., $\\approx 0$). In this case, $r_{p,K} \\approx p_h$. If $p_h$ were constant, the residual would be constant, but this would be a symptom of a locked solution, not its absence. A constant, non-zero residual points to a systematic error, not a well-behaved solution.\n**Verdict: Incorrect**\n\n**E. Replacing the equal-order pair with an LBB-stable mixed pair (for example, Taylor–Hood) under the same loading and comparable mesh resolution yields $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$ elementwise, thereby driving $r_{p,K}$ close to zero and removing the alternating pattern.**\n\n- This describes the standard and correct approach to fixing the instability observed with the $Q_1$–$Q_1$ pair.\n- An LBB-stable pair, such as the Taylor-Hood ($Q_2$ for displacement, $P_1$ for pressure), provides the necessary control over the pressure approximation, preventing spurious, unphysical modes like the checkerboard pattern.\n- As a result, a convergent numerical method using a stable pair will produce a solution $(u_h, p_h)$ that is a good approximation of the true solution $(u, p)$. For the true solution, $p = -\\kappa \\operatorname{tr} \\varepsilon(u)$. Therefore, the computed solution will satisfy $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$.\n- This directly implies that the volumetric residual $r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$ will be close to zero, and the alternating pattern, which was a symptom of instability, will be gone.\n**Verdict: Correct**", "answer": "$$\\boxed{AE}$$", "id": "3595875"}, {"introduction": "The ultimate application of a posteriori error indicators is to guide adaptive algorithms that automatically refine the finite element model to improve accuracy where it is most needed. This practice [@problem_id:3595939] takes you from passively analyzing errors to actively controlling the simulation. You will develop a decision-making algorithm for advanced $hp$-adaptivity, learning how the rate of residual decay upon polynomial enrichment acts as a powerful local smoothness indicator to make an optimal choice between refining the mesh size ($h$) or the polynomial order ($p$).", "problem": "Consider the one-dimensional small-strain linear elasticity problem for a bar occupying the domain $[0,L]$ with Young's modulus $E(x)$, cross-sectional area $A(x)$, body force density $b(x)$, prescribed displacement $u=0$ at $x=0$, and prescribed traction $t(L)$ at $x=L$. The strong form of the balance of linear momentum in the absence of inertia is\n$$\n-\\frac{d}{dx}\\big(E(x)A(x)\\frac{du}{dx}\\big)=b(x) \\quad \\text{for } x\\in(0,L),\n$$\nwith the traction boundary condition\n$$\nE(L)A(L)\\frac{du}{dx}(L)=t(L).\n$$\nLet $u_{h,p}$ denote the finite element approximation in a $p$-th order polynomial space over a mesh of size $h$, and let $u_{h,p+1}$ denote the corresponding approximation on the same mesh with polynomial degree increased by $1$ on a given element. The residual functional $R(u_{h,p})$ acting on a test function $v$ can be written by integrating the strong form by parts elementwise as\n$$\nR(u_{h,p};v)=\\sum_{K}\\int_{K}\\left(b(x)+\\frac{d}{dx}\\big(E(x)A(x)\\frac{du_{h,p}}{dx}\\big)\\right)v(x)\\,dx+\\sum_{e\\in\\mathcal{E}_h}\\int_{e}\\big(\\llbracket E(x)A(x)\\frac{du_{h,p}}{dx} \\rrbracket - t(x)\\big)v(x)\\,ds,\n$$\nwhere $\\mathcal{E}_h$ denotes the set of element faces, $\\llbracket \\cdot \\rrbracket$ is the jump across an interior face, and $t(x)$ is the applied traction on the Neumann boundary. A residual-based a posteriori error indicator uses the norm of this residual to estimate the discretization error. For each element $K$, define a computable proxy of the residual norm $\\|R_K(u_{h,p})\\|$ (for instance, an $L^2$-norm of the volume equilibrium residual plus face jump contributions, scaled by local mesh sizes), and similarly for $\\|R_K(u_{h,p+1})\\|$.\n\nStarting from the definition of the residual and the fundamental link between the residual norm and the energy error in the weak form, derive a decision criterion that uses the local decay of the residual norm under polynomial enrichment as a smoothness indicator. Specifically, reason from first principles why, for sufficiently smooth exact solutions on element $K$, the ratio\n$$\n\\rho_K=\\frac{\\|R_K(u_{h,p+1})\\|}{\\|R_K(u_{h,p})\\|}\n$$\ntends to be significantly smaller than unity under polynomial enrichment, while for solutions with low regularity (e.g., singularities or steep gradients not well-resolved on $K$), $\\rho_K$ decays slowly and remains close to $1$. Use this to construct a robust $hp$-adaptive decision policy with three outcomes per element $K$:\n- Choose $p$-refinement (polynomial order increase) when $\\rho_K$ indicates sufficient decay,\n- Choose $h$-refinement (mesh subdivision) when $\\rho_K$ indicates slow decay,\n- Choose no refinement when the element is already sufficiently converged so that further refinement is not justified.\n\nYour algorithm must be implementable using only the local scalar proxies $\\|R_K(u_{h,p})\\|$ and $\\|R_K(u_{h,p+1})\\|$ supplied as inputs, without access to the full fields. To make the decision quantitative, you must introduce:\n- A decay threshold parameter $\\theta_p\\in(0,1)$ that codifies the minimum relative decay indicating sufficient smoothness,\n- A residual floor $\\varepsilon_{\\min}>0$ such that if $\\|R_K(u_{h,p})\\|\\le \\varepsilon_{\\min}$, the element is considered converged and should not be refined.\n\nYour task is to:\n1. Justify the structure of the decision rule from the weak form and residual-based error estimation principles without using any shortcut formulas that presuppose the final rule.\n2. Implement a program that, given elementwise pairs of residual norms $(\\|R_K(u_{h,p})\\|,\\|R_K(u_{h,p+1})\\|)$ along with $\\theta_p$ and $\\varepsilon_{\\min}$, outputs a per-element decision encoded as integers: output $1$ for $p$-refinement, $0$ for $h$-refinement, and $2$ for no refinement.\n\nUse the following test suite, designed to probe smoothness detection, singular behavior, near-convergence, and edge cases:\n- Test case $1$ (two elements, smooth-like decay): $\\theta_p=0.6$, $\\varepsilon_{\\min}=10^{-7}$, $\\|R_K(u_{h,p})\\|=[10^{-1},2\\cdot 10^{-1}]$, $\\|R_K(u_{h,p+1})\\|=[2\\cdot 10^{-2},5\\cdot 10^{-2}]$.\n- Test case $2$ (two elements, slow decay indicative of non-smoothness): $\\theta_p=0.6$, $\\varepsilon_{\\min}=10^{-7}$, $\\|R_K(u_{h,p})\\|=[1,5\\cdot 10^{-1}]$, $\\|R_K(u_{h,p+1})\\|=[9\\cdot 10^{-1},4.5\\cdot 10^{-1}]$.\n- Test case $3$ (two elements, near convergence): $\\theta_p=0.6$, $\\varepsilon_{\\min}=10^{-7}$, $\\|R_K(u_{h,p})\\|=[10^{-8},5\\cdot 10^{-9}]$, $\\|R_K(u_{h,p+1})\\|=[10^{-9},2\\cdot 10^{-9}]$.\n- Test case $4$ (three elements, includes a zero residual and mixed behavior): $\\theta_p=0.6$, $\\varepsilon_{\\min}=10^{-6}$, $\\|R_K(u_{h,p})\\|=[0,10^{-4},10^{-2}]$, $\\|R_K(u_{h,p+1})\\|=[0,5\\cdot 10^{-5},9\\cdot 10^{-3}]$.\n\nFor each test case, compute the decisions per element in order, and concatenate all decisions from test case $1$ through test case $4$ into a single list. The final program output must be a single line containing this concatenated list of integers, printed as a comma-separated list without spaces and enclosed in square brackets (for example, $[\\dots]$). There are no physical units in the output; the output is a list of integers as specified.", "solution": "The task is to derive and implement a decision algorithm for $hp$-adaptive finite element analysis based on the local decay of a residual norm proxy. The decision for each element $K$ can be $h$-refinement (subdivision), $p$-refinement (polynomial enrichment), or no refinement. The decision is based on the provided local residual norm proxies, $\\|R_K(u_{h,p})\\|$ and $\\|R_K(u_{h,p+1})\\|$, and two parameters: a decay threshold $\\theta_p$ and a residual floor $\\varepsilon_{\\min}$.\n\nThe derivation proceeds from fundamental principles of the Finite Element Method (FEM) and a posteriori error estimation.\n\n**1. The Role of the Residual in Error Estimation**\n\nThe starting point is the weak formulation of the governing one-dimensional elasticity problem. The exact solution $u$ satisfies the variational equation:\n$$\na(u,v) = L(v) \\quad \\forall v \\in V\n$$\nwhere $V$ is a suitable infinite-dimensional space of test functions, $a(\\cdot, \\cdot)$ is the energy bilinear form representing the internal virtual work, and $L(\\cdot)$ is the linear functional representing the external virtual work. For this problem,\n$$\na(w,z) = \\int_{0}^{L} E(x)A(x)\\frac{dw}{dx}\\frac{dz}{dx}\\,dx\n$$\nand\n$$\nL(v) = \\int_{0}^{L} b(x)v(x)\\,dx + t(L)v(L)\n$$\nThe finite element approximation $u_{h,p}$ is sought in a finite-dimensional subspace $V_{h,p} \\subset V$ and is defined by the Galerkin equation:\n$$\na(u_{h,p}, v_h) = L(v_h) \\quad \\forall v_h \\in V_{h,p}\n$$\nThe discretization error is defined as $e = u - u_{h,p}$. By subtracting the Galerkin equation from the exact weak form (with $v=v_h$), we obtain the Galerkin orthogonality property:\n$$\na(e, v_h) = a(u-u_{h,p}, v_h) = 0 \\quad \\forall v_h \\in V_{h,p}\n$$\nNow, consider the error $e$ tested against an arbitrary function $v \\in V$. We have:\n$$\na(e,v) = a(u,v) - a(u_{h,p}, v) = L(v) - a(u_{h,p}, v)\n$$\nThe right-hand side, $L(v) - a(u_{h,p}, v)$, defines the action of the residual functional $R(u_{h,p};v)$ on the test function $v$. Integrating $a(u_{h,p}, v)$ by parts on each element $K$ recovers the expression for the residual provided in the problem statement. This yields the exact error equation:\n$$\na(e,v) = R(u_{h,p};v) \\quad \\forall v \\in V\n$$\nThis fundamental equation establishes that the error $e$ is driven by the residual $R(u_{h,p})$. A key result in a posteriori error analysis is that the energy norm of the error, $\\|e\\|_{E} = \\sqrt{a(e,e)}$, is equivalent to an appropriate norm of the residual functional. This equivalence allows us to use a computable norm of the residual as an estimate (an indicator) of the true error. The problem provides $\\|R_K(u_{h,p})\\|$ as a computable, local proxy for this norm on each element $K$. The global error is then estimated by summing the local contributions: $\\|e\\|_{E}^2 \\approx \\sum_{K} \\|R_K(u_{h,p})\\|^2$.\n\n**2. Error Convergence and Solution Regularity**\n\nThe central idea of $hp$-adaptivity is to choose the type of refinement ($h$ or $p$) that is locally most efficient. This choice depends on the local regularity (smoothness) of the exact solution $u$.\n\n-   **Smooth Solution (High Regularity):** If the exact solution $u$ is analytic (infinitely differentiable) on an element $K$, then increasing the polynomial degree $p$ of the approximation leads to exponential convergence of the error. The error in the energy norm on element $K$ behaves as:\n    $$\n    \\|e\\|_{E,K} \\sim \\exp(-\\gamma p)\n    $$\n    for some constant $\\gamma > 0$ that depends on the analytic properties of $u$. This is known as spectral convergence and is extremely fast. Consequently, the residual norm proxy $\\|R_K(u_{h,p})\\|$, being an estimate of the error, is expected to decay exponentially with $p$.\n\n-   **Non-Smooth Solution (Low Regularity):** If the solution $u$ possesses a singularity on element $K$ (e.g., due to sharp corners, abrupt changes in material properties, or point loads, none of which are explicitly in this $1$D problem but serve as the general motivation), its regularity is low. For such solutions, $p$-refinement yields only a slow, algebraic convergence rate that saturates. The more effective strategy is $h$-refinement, which subdivides the element to isolate the singularity. This allows the smooth parts of the solution on the new, smaller elements to be approximated efficiently with polynomials, restoring an optimal algebraic convergence rate with respect to the mesh size $h$.\n\n**3. The Decision Criterion**\n\nThe local decay ratio $\\rho_K$ is designed to probe this convergence behavior.\n$$\n\\rho_K = \\frac{\\|R_K(u_{h,p+1})\\|}{\\|R_K(u_{h,p})\\|}\n$$\nThis ratio quantifies how much the local residual (and thus error) is reduced by increasing the polynomial degree from $p$ to $p+1$.\n\n-   If the solution is locally smooth, we expect exponential convergence. The ratio of successive residuals will be approximately constant and significantly smaller than $1$:\n    $$\n    \\rho_K \\approx \\frac{C \\exp(-\\gamma(p+1))}{C \\exp(-\\gamma p)} = \\exp(-\\gamma) \\ll 1\n    $$\n    A small value of $\\rho_K$ indicates that $p$-refinement is working very effectively.\n\n-   If the solution is locally non-smooth, $p$-refinement is inefficient. The residual will decay slowly, and the ratio $\\rho_K$ will be close to $1$. A large value of $\\rho_K$ indicates that $p$-refinement is not the optimal choice, and by exclusion, $h$-refinement is preferred.\n\nThis reasoning leads directly to the structure of the decision algorithm.\n\n**Algorithm:**\nThe decision for each element $K$ is made using a two-step hierarchical logic.\n\n**Step 1: Check for Convergence**\nAn adaptive algorithm must have a stopping criterion to avoid refining elements where the error is already acceptably small. The residual floor $\\varepsilon_{\\min}$ serves this purpose. The first check is always:\n-   If $\\|R_K(u_{h,p})\\| \\le \\varepsilon_{\\min}$, the element's contribution to the total error is negligible. No further refinement is necessary.\n    -   Decision: **No Refinement** (encoded as $2$).\n\n**Step 2: Select Refinement Type**\nIf the element has not converged (i.e., $\\|R_K(u_{h,p})\\| > \\varepsilon_{\\min}$), we must choose between $h$- and $p$-refinement. This is where the smoothness indicator $\\rho_K$ and the decay threshold $\\theta_p$ are used.\n-   We compute the ratio $\\rho_K$. Note that since $\\|R_K(u_{h,p})\\| > \\varepsilon_{\\min}$ and the problem gives $\\varepsilon_{\\min} > 0$, the denominator $\\|R_K(u_{h,p})\\|$ is guaranteed to be non-zero.\n-   We compare $\\rho_K$ to the threshold $\\theta_p \\in (0,1)$:\n    -   If $\\rho_K < \\theta_p$: The observed decay is \"fast\", indicating the solution is locally smooth and benefiting from polynomial enrichment.\n        -   Decision: **$p$-refinement** (encoded as $1$).\n    -   If $\\rho_K \\ge \\theta_p$: The observed decay is \"slow\", suggesting low regularity where $p$-refinement is inefficient.\n        -   Decision: **$h$-refinement** (encoded as $0$).\n\nThis logical sequence—first checking for convergence, then assessing smoothness for non-converged elements—provides a robust and physically-motivated strategy for $hp$-adaptive refinement. The special case where $\\|R_K(u_{h,p})\\|=0$ is correctly handled by the first step, as $0 \\le \\varepsilon_{\\min}$ for any $\\varepsilon_{\\min}>0$, leading to a \"no refinement\" decision, which is appropriate for an element with zero initial residual.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements an hp-adaptive decision policy for finite element analysis.\n\n    The function processes a series of test cases, each containing element-wise\n    residual norm proxies for polynomial degrees p and p+1. Based on a decay\n    threshold (theta_p) and a residual floor (eps_min), it decides for each\n    element whether to perform p-refinement, h-refinement, or no refinement.\n\n    Decision Logic:\n    - 2 (No Refinement): If the initial residual norm ||R_K(u_h,p)|| is below eps_min.\n    - 1 (p-refinement): If not converged and the decay ratio rho_K is less than theta_p.\n    - 0 (h-refinement): If not converged and the decay ratio rho_K is not less than theta_p.\n\n    The decay ratio is rho_K = ||R_K(u_h,p+1)|| / ||R_K(u_h,p)||.\n    \"\"\"\n    test_cases = [\n        {\n            \"theta_p\": 0.6,\n            \"eps_min\": 1e-7,\n            \"R_p\": [1e-1, 2e-1],\n            \"R_p1\": [2e-2, 5e-2]\n        },\n        {\n            \"theta_p\": 0.6,\n            \"eps_min\": 1e-7,\n            \"R_p\": [1.0, 5e-1],\n            \"R_p1\": [9e-1, 4.5e-1]\n        },\n        {\n            \"theta_p\": 0.6,\n            \"eps_min\": 1e-7,\n            \"R_p\": [1e-8, 5e-9],\n            \"R_p1\": [1e-9, 2e-9]\n        },\n        {\n            \"theta_p\": 0.6,\n            \"eps_min\": 1e-6,\n            \"R_p\": [0.0, 1e-4, 1e-2],\n            \"R_p1\": [0.0, 5e-5, 9e-3]\n        }\n    ]\n\n    all_decisions = []\n    for case in test_cases:\n        theta_p = case[\"theta_p\"]\n        eps_min = case[\"eps_min\"]\n        R_p_list = case[\"R_p\"]\n        R_p1_list = case[\"R_p1\"]\n\n        for R_p, R_p1 in zip(R_p_list, R_p1_list):\n            # Step 1: Check for convergence. If the residual is already below the\n            # tolerance floor, no refinement is needed.\n            if R_p = eps_min:\n                decision = 2  # No refinement\n            else:\n                # Step 2: Since not converged, decide between h- and p-refinement.\n                # The condition R_p > eps_min > 0 ensures R_p is not zero.\n                rho_K = R_p1 / R_p\n                \n                # Compare the decay ratio to the smoothness threshold.\n                if rho_K  theta_p:\n                    decision = 1  # p-refinement (fast decay)\n                else:\n                    decision = 0  # h-refinement (slow decay)\n            \n            all_decisions.append(decision)\n\n    # The final output must be a single string representing the list of integers.\n    print(f\"[{','.join(map(str, all_decisions))}]\")\n\nsolve()\n```", "id": "3595939"}]}