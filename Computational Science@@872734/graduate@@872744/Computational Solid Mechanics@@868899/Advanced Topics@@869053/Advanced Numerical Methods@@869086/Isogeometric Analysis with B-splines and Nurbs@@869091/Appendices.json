{"hands_on_practices": [{"introduction": "The foundation of isogeometric analysis lies in its use of B-spline basis functions, the same functions used in computer-aided design (CAD) to define geometry. To truly master IGA, one must understand how these functions are constructed. This first exercise provides essential hands-on practice with the Cox窶電e Boor recursion formula, the fundamental algorithm for evaluating B-spline basis functions at any point in the parametric domain [@problem_id:3575735]. Working through this calculation solidifies the understanding of concepts like local support and the recursive nature of splines.", "problem": "Consider a one-dimensional isogeometric discretization used in computational solid mechanics, where the approximation space is built from a quadratic B-spline basis defined on the open knot vector $\\Xi=\\{0,0,0,0.5,1,1,1\\}$. Such a space is commonly employed in Isogeometric Analysis (IGA) to approximate displacement fields, with Non-Uniform Rational B-Splines (NURBS) derived from these B-spline bases via weights if needed. Starting from the core definition of the B-spline basis via the Cox窶電e Boor recursion and the piecewise-constant zeroth-degree functions, compute the nonzero quadratic B-spline basis function values $N_{i,2}(u)$ at the parametric location $u=0.25$ for all indices $i$ that yield nonzero values. Report your final answer as a single row matrix ordered by increasing index $i$ of the nonzero functions. Provide exact values; no rounding is required. No physical units are associated with these basis values.", "solution": "The problem requires the computation of the values of quadratic ($p=2$) B-spline basis functions at the parametric coordinate $u=1/4$. The B-spline basis is defined by the open knot vector $\\Xi=\\{\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5, \\xi_6\\} = \\{0, 0, 0, 1/2, 1, 1, 1\\}$. We use 0-based indexing for knots and basis functions.\n\nFor a knot vector with $m+1=7$ knots and a degree $p=2$, there are $n+1 = (m+1) - (p+1) = 7-3=4$ basis functions, which we index from $i=0$ to $3$: $N_{0,2}(u)$, $N_{1,2}(u)$, $N_{2,2}(u)$, and $N_{3,2}(u)$.\n\nThe evaluation uses the Cox窶電e Boor recursion formula. For $p > 0$:\n$$N_{i,p}(u) = \\frac{u - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(u) + \\frac{\\xi_{i+p+1} - u}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(u)$$\nThe recursion starts from the base case for degree $p=0$:\n$$N_{i,0}(u) = \\begin{cases} 1 & \\text{if } \\xi_i \\le u < \\xi_{i+1} \\\\ 0 & \\text{otherwise} \\end{cases}$$\nBy convention, any term with a zero in the denominator (e.g., $\\frac{0}{0}$) is taken to be zero.\n\nA basis function $N_{i,p}(u)$ is non-zero only for $u \\in [\\xi_j, \\xi_{j+1})$ if $i \\le j \\le i+p$. For a given $u \\in [\\xi_k, \\xi_{k+1})$, the only potentially non-zero basis functions of degree $p$ are $N_{k-p,p}, \\dots, N_{k,p}$.\n\nIn our case, $u=1/4$ lies in the knot span $[\\xi_2, \\xi_3) = [0, 1/2)$. Thus, we set $k=2$. For degree $p=2$, the only basis functions that can be non-zero at $u=1/4$ are $N_{2-2,2}(u)$, $N_{2-1,2}(u)$, and $N_{2,2}(u)$, which are $N_{0,2}(u)$, $N_{1,2}(u)$, and $N_{2,2}(u)$. The function $N_{3,2}(u)$ is zero because its support is $[\\xi_3, \\xi_6) = [1/2, 1)$, which does not contain $u=1/4$.\n\n**Step 1: Zeroth-degree basis functions ($p=0$)**\nAt $u=1/4$, since $u \\in [\\xi_2, \\xi_3) = [0, 1/2)$, the only non-zero zeroth-degree basis function is:\n$$N_{2,0}(1/4) = 1$$\n\n**Step 2: First-degree basis functions ($p=1$)**\n- $N_{0,1}(1/4)$: Both terms in the recursion are zero because $\\xi_1-\\xi_0=0$ and $\\xi_2-\\xi_1=0$. So, $N_{0,1}(1/4) = 0$.\n\n- $N_{1,1}(1/4) = \\frac{u - \\xi_1}{\\xi_2 - \\xi_1} N_{1,0}(1/4) + \\frac{\\xi_3 - u}{\\xi_3 - \\xi_2} N_{2,0}(1/4)$.\nThe first denominator is $\\xi_2-\\xi_1=0-0=0$, so the first term is zero.\nThe second term is $\\frac{1/2 - 1/4}{1/2 - 0} N_{2,0}(1/4) = \\frac{1/4}{1/2} \\times 1 = \\frac{1}{2}$.\n$N_{1,1}(1/4) = 1/2$.\n\n- $N_{2,1}(1/4) = \\frac{u - \\xi_2}{\\xi_3 - \\xi_2} N_{2,0}(1/4) + \\frac{\\xi_4 - u}{\\xi_4 - \\xi_3} N_{3,0}(1/4)$.\n$N_{3,0}(1/4)=0$, so the second term is zero.\nThe first term is $\\frac{1/4 - 0}{1/2 - 0} N_{2,0}(1/4) = \\frac{1/4}{1/2} \\times 1 = \\frac{1}{2}$.\n$N_{2,1}(1/4) = 1/2$.\n\n**Step 3: Second-degree basis functions ($p=2$)**\n- $N_{0,2}(1/4) = \\frac{u - \\xi_0}{\\xi_2 - \\xi_0} N_{0,1}(1/4) + \\frac{\\xi_3 - u}{\\xi_3 - \\xi_1} N_{1,1}(1/4)$.\nThe first denominator is $\\xi_2-\\xi_0=0-0=0$, so the first term is zero.\nThe second term is $\\frac{1/2 - 1/4}{1/2 - 0} N_{1,1}(1/4) = \\frac{1/4}{1/2} \\times \\frac{1}{2} = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n$$N_{0,2}(1/4) = \\frac{1}{4}$$\n\n- $N_{1,2}(1/4) = \\frac{u - \\xi_1}{\\xi_3 - \\xi_1} N_{1,1}(1/4) + \\frac{\\xi_4 - u}{\\xi_4 - \\xi_2} N_{2,1}(1/4)$.\nThe first term is $\\frac{1/4 - 0}{1/2 - 0} N_{1,1}(1/4) = \\frac{1/4}{1/2} \\times \\frac{1}{2} = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\nThe second term is $\\frac{1 - 1/4}{1 - 0} N_{2,1}(1/4) = \\frac{3/4}{1} \\times \\frac{1}{2} = \\frac{3}{8}$.\n$N_{1,2}(1/4) = \\frac{1}{4} + \\frac{3}{8} = \\frac{2}{8} + \\frac{3}{8} = \\frac{5}{8}$.\n$$N_{1,2}(1/4) = \\frac{5}{8}$$\n\n- $N_{2,2}(1/4) = \\frac{u - \\xi_2}{\\xi_4 - \\xi_2} N_{2,1}(1/4) + \\frac{\\xi_5 - u}{\\xi_5 - \\xi_3} N_{3,1}(1/4)$.\n$N_{3,1}(1/4)=0$ (since its support starts at $\\xi_3=1/2$), so the second term is zero.\nThe first term is $\\frac{1/4 - 0}{1 - 0} N_{2,1}(1/4) = \\frac{1/4}{1} \\times \\frac{1}{2} = \\frac{1}{8}$.\n$$N_{2,2}(1/4) = \\frac{1}{8}$$\n\nAs established, $N_{3,2}(1/4)=0$.\n\nA crucial property of B-spline basis functions is the partition of unity, which states that the sum of all basis functions at any point within the domain is equal to $1$. Let's verify this for our results:\n$$ \\sum_{i=0}^{3} N_{i,2}(1/4) = N_{0,2}(1/4) + N_{1,2}(1/4) + N_{2,2}(1/4) + N_{3,2}(1/4) $$\n$$ = \\frac{1}{4} + \\frac{5}{8} + \\frac{1}{8} + 0 = \\frac{2}{8} + \\frac{5}{8} + \\frac{1}{8} = \\frac{8}{8} = 1 $$\nThe partition of unity is satisfied, confirming the correctness of our calculations.\n\nThe non-zero basis function values at $u=1/4$ correspond to indices $i=0,1,2$. Ordered by increasing index $i$, the values are:\n$N_{0,2}(1/4) = \\frac{1}{4}$\n$N_{1,2}(1/4) = \\frac{5}{8}$\n$N_{2,2}(1/4) = \\frac{1}{8}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4} & \\frac{5}{8} & \\frac{1}{8} \\end{pmatrix}}\n$$", "id": "3575735"}, {"introduction": "A primary advantage of IGA over traditional finite element methods is its ability to represent common engineering geometries, such as conic sections, exactly. This is achieved through Non-Uniform Rational B-Splines (NURBS), which extend B-splines by introducing weights. This practice [@problem_id:3575812] demonstrates this powerful capability by guiding you through the construction of a NURBS curve for a quarter-circle and, more importantly, verifying its geometric exactness for the entire parametric domain. This exercise reveals the mathematical elegance that allows IGA to eliminate geometric approximation errors.", "problem": "In the context of isogeometric analysis (IGA) for computational solid mechanics, exact geometric representation of curved boundaries is essential to prevent geometric discretization error from contaminating the numerical solution. Consider constructing a quadratic Non-Uniform Rational B-Spline (NURBS) curve that exactly represents the quarter unit circle spanning from the point $(1,0)$ to the point $(0,1)$ in the first quadrant.\n\nYou are given the control points $\\mathbf{P}_{0}=(1,0)$, $\\mathbf{P}_{1}=(1,1)$, and $\\mathbf{P}_{2}=(0,1)$, and the weights $w_{0}=1$, $w_{1}=\\frac{1}{\\sqrt{2}}$, and $w_{2}=1$. The parametric coordinate is $\\xi \\in [0,1]$, and the degree is $p=2$ with the open knot vector $\\Xi=(0,0,0,1,1,1)$.\n\nStarting from the Cox窶電e Boor definition of B-spline basis functions and the fundamental definition of Non-Uniform Rational B-Splines (NURBS) curves as rational B-splines, construct the corresponding quadratic NURBS parameterization $\\mathbf{x}(\\xi)$ for the data above. Then, by direct derivation using only these foundational definitions and algebraic simplification, verify that this parameterization is an exact representation of the quarter unit circle by showing that the Euclidean norm $\\|\\mathbf{x}(\\xi)\\|$ is constant and equal to the radius for all $\\xi \\in [0,1]$.\n\nProvide the simplified closed-form expression of $\\|\\mathbf{x}(\\xi)\\|$ as a function of $\\xi$. No numerical rounding is required, and no units should be included in your final expression.", "solution": "### Step 1: Validate Givens\n- **Curve type**: Quadratic NURBS curve.\n- **Degree**: $p=2$.\n- **Knot vector**: $\\Xi=\\{0,0,0,1,1,1\\}$.\n- **Control points**: $\\mathbf{P}_{0}=(1,0)$, $\\mathbf{P}_{1}=(1,1)$, $\\mathbf{P}_{2}=(0,1)$.\n- **Weights**: $w_{0}=1$, $w_{1}=\\frac{1}{\\sqrt{2}}$, $w_{2}=1$.\n- **Task**: Verify that $\\|\\mathbf{x}(\\xi)\\|=1$ for all $\\xi \\in [0,1]$.\n\nThe problem is a standard textbook example from Computer-Aided Geometric Design and is scientifically sound and well-posed. We proceed with the derivation.\n\n### Step 2: Derive the B-spline Basis Functions\nFor a quadratic basis ($p=2$) with the knot vector $\\Xi=\\{0,0,0,1,1,1\\}$, the B-spline basis functions reduce to the quadratic Bernstein polynomials over the interval $\\xi \\in [0,1]$. This can be shown with the Cox-de Boor recursion, but the result is standard:\n$$ N_{0,2}(\\xi) = (1-\\xi)^2 $$\n$$ N_{1,2}(\\xi) = 2\\xi(1-\\xi) $$\n$$ N_{2,2}(\\xi) = \\xi^2 $$\n\n### Step 3: Construct the NURBS Curve Parameterization\nA NURBS curve $\\mathbf{x}(\\xi)$ is defined as a weighted average of control points:\n$$ \\mathbf{x}(\\xi) = \\frac{\\sum_{i=0}^{2} w_i N_{i,2}(\\xi) \\mathbf{P}_i}{\\sum_{i=0}^{2} w_i N_{i,2}(\\xi)} = \\frac{\\mathbf{N}(\\xi)}{W(\\xi)} $$\nwhere $\\mathbf{N}(\\xi)$ is the numerator vector and $W(\\xi)$ is the scalar weighting function.\n\nLet's write the components of the numerator vector $\\mathbf{N}(\\xi) = (x_{num}(\\xi), y_{num}(\\xi))$:\n$$ \\mathbf{N}(\\xi) = w_0 N_{0,2}(\\xi) \\mathbf{P}_0 + w_1 N_{1,2}(\\xi) \\mathbf{P}_1 + w_2 N_{2,2}(\\xi) \\mathbf{P}_2 $$\n$$ \\mathbf{N}(\\xi) = 1 \\cdot N_{0,2}(\\xi) \\cdot (1,0) + \\frac{1}{\\sqrt{2}} \\cdot N_{1,2}(\\xi) \\cdot (1,1) + 1 \\cdot N_{2,2}(\\xi) \\cdot (0,1) $$\nThe components are:\n$$ x_{num}(\\xi) = N_{0,2}(\\xi) + \\frac{1}{\\sqrt{2}} N_{1,2}(\\xi) $$\n$$ y_{num}(\\xi) = \\frac{1}{\\sqrt{2}} N_{1,2}(\\xi) + N_{2,2}(\\xi) $$\n\nThe denominator (weighting function) is:\n$$ W(\\xi) = w_0 N_{0,2}(\\xi) + w_1 N_{1,2}(\\xi) + w_2 N_{2,2}(\\xi) = N_{0,2}(\\xi) + \\frac{1}{\\sqrt{2}} N_{1,2}(\\xi) + N_{2,2}(\\xi) $$\n\n### Step 4: Verify the Euclidean Norm\nThe goal is to show that $\\|\\mathbf{x}(\\xi)\\|^2 = x(\\xi)^2 + y(\\xi)^2 = 1$. This is equivalent to proving that $x_{num}(\\xi)^2 + y_{num}(\\xi)^2 = W(\\xi)^2$.\n\nLet's expand the left-hand side (LHS) and right-hand side (RHS) of this equation.\n$$ \\text{LHS} = (N_{0,2} + \\frac{1}{\\sqrt{2}} N_{1,2})^2 + (\\frac{1}{\\sqrt{2}} N_{1,2} + N_{2,2})^2 $$\n$$ = (N_{0,2}^2 + \\frac{2}{\\sqrt{2}} N_{0,2} N_{1,2} + \\frac{1}{2} N_{1,2}^2) + (\\frac{1}{2} N_{1,2}^2 + \\frac{2}{\\sqrt{2}} N_{1,2} N_{2,2} + N_{2,2}^2) $$\n$$ = N_{0,2}^2 + N_{2,2}^2 + N_{1,2}^2 + \\sqrt{2} N_{1,2} (N_{0,2} + N_{2,2}) $$\n\n$$ \\text{RHS} = (N_{0,2} + \\frac{1}{\\sqrt{2}} N_{1,2} + N_{2,2})^2 = ((N_{0,2} + N_{2,2}) + \\frac{1}{\\sqrt{2}} N_{1,2})^2 $$\n$$ = (N_{0,2} + N_{2,2})^2 + 2(N_{0,2} + N_{2,2})(\\frac{1}{\\sqrt{2}} N_{1,2}) + (\\frac{1}{\\sqrt{2}} N_{1,2})^2 $$\n$$ = N_{0,2}^2 + 2 N_{0,2} N_{2,2} + N_{2,2}^2 + \\sqrt{2} N_{1,2} (N_{0,2} + N_{2,2}) + \\frac{1}{2} N_{1,2}^2 $$\n\nFor LHS = RHS, we must have:\n$$ N_{0,2}^2 + N_{2,2}^2 + N_{1,2}^2 + \\sqrt{2} N_{1,2} (N_{0,2} + N_{2,2}) = N_{0,2}^2 + 2 N_{0,2} N_{2,2} + N_{2,2}^2 + \\sqrt{2} N_{1,2} (N_{0,2} + N_{2,2}) + \\frac{1}{2} N_{1,2}^2 $$\nSubtracting common terms from both sides, we are left with proving:\n$$ N_{1,2}^2 = 2 N_{0,2} N_{2,2} + \\frac{1}{2} N_{1,2}^2 $$\n$$ \\frac{1}{2} N_{1,2}^2 = 2 N_{0,2} N_{2,2} $$\nThis condition relates the weight and the basis functions for an exact conic section. Let's verify it with the expressions for the basis functions:\n$$ \\text{LHS} = \\frac{1}{2} (2\\xi(1-\\xi))^2 = \\frac{1}{2} (4\\xi^2(1-\\xi)^2) = 2\\xi^2(1-\\xi)^2 $$\n$$ \\text{RHS} = 2 ((1-\\xi)^2) (\\xi^2) = 2\\xi^2(1-\\xi)^2 $$\nThe condition $\\frac{1}{2} N_{1,2}^2 = 2 N_{0,2} N_{2,2}$ holds true for all $\\xi$.\n\n### Step 5: Conclusion\nSince the identity holds, it follows that $x_{num}(\\xi)^2 + y_{num}(\\xi)^2 = W(\\xi)^2$. Therefore:\n$$ \\|\\mathbf{x}(\\xi)\\|^2 = x(\\xi)^2 + y(\\xi)^2 = \\frac{x_{num}(\\xi)^2 + y_{num}(\\xi)^2}{W(\\xi)^2} = \\frac{W(\\xi)^2}{W(\\xi)^2} = 1 $$\nTaking the square root, we find that the Euclidean norm is constant and equal to 1 for all $\\xi \\in [0,1]$.\n$$ \\|\\mathbf{x}(\\xi)\\| = 1 $$\nThis verifies that the NURBS parameterization exactly represents a quarter unit circle.", "answer": "$$\n\\boxed{1}\n$$", "id": "3575812"}, {"introduction": "In any analysis, the ability to refine the discretization is crucial for improving solution accuracy. In IGA, the equivalent of mesh refinement (h-refinement) is achieved through knot insertion, a process that adds new knot values to the knot vector without changing the geometry or parameterization of the curve. This final practice [@problem_id:3575751] focuses on this key algorithmic procedure. By applying knot insertion to a NURBS curve, you will compute the new control points and weights, gaining insight into how the control net adapts to locally increase the number of basis functions and enable more detailed analysis.", "problem": "Consider a planar quadratic Non-Uniform Rational B-Splines (NURBS) curve of degree $p=2$ used to exactly represent a quarter circular arc of radius $R=2$ in a curved beam idealization. The curve is defined over the clamped knot vector $\\Xi=\\{0,0,0,1,1,1\\}$ with control points $P_0=(2,0)$, $P_1=(2,2)$, $P_2=(0,2)$ and corresponding weights $w_0=1$, $w_1=\\frac{1}{\\sqrt{2}}$, $w_2=1$. Starting from the fundamental definition of a NURBS curve in $\\mathbb{R}^2$ as a rational projection of a polynomial B-spline curve defined in homogeneous coordinates, and from the standard knot insertion process for B-splines (applied to homogeneous control points), perform a single knot insertion at parameter $\\xi=0.5$.\n\nUsing these principles only, derive the new knot vector and compute the updated set of control points and weights exactly (without numerical rounding). Present the final result as a single row matrix that first lists the entries of the new knot vector, followed by the tuples $(x_i,y_i,w_i)$ of the updated control points and weights in order $i=0,1,2,3$. All mathematical entities must be expressed in exact symbolic form. Do not round. The final answer must be a single analytical expression.", "solution": "The problem is to perform a single knot insertion on a given quadratic Non-Uniform Rational B-Splines (NURBS) curve and to determine the resulting new knot vector, control points, and weights.\n\n### Step 1: Homogeneous Representation\nThe procedure for knot insertion in a NURBS curve is most transparently performed by operating on its corresponding B-spline representation in homogeneous space. The homogeneous control points $\\mathbf{P}_i^w$ are formed by multiplying the Cartesian coordinates of the control points $\\mathbf{P}_i=(x_i, y_i)$ by their respective weights $w_i$, and appending the weight as the last coordinate: $\\mathbf{P}_i^w = (w_i x_i, w_i y_i, w_i)$.\n\nThe given control points and weights are:\n$\\mathbf{P}_0=(2,0)$ with $w_0=1$\n$\\mathbf{P}_1=(2,2)$ with $w_1=\\frac{1}{\\sqrt{2}}$\n$\\mathbf{P}_2=(0,2)$ with $w_2=1$\n\nThe corresponding homogeneous control points are:\n$\\mathbf{P}_0^w = (1 \\cdot 2, 1 \\cdot 0, 1) = (2, 0, 1)$\n$\\mathbf{P}_1^w = (\\frac{1}{\\sqrt{2}} \\cdot 2, \\frac{1}{\\sqrt{2}} \\cdot 2, \\frac{1}{\\sqrt{2}}) = (\\frac{2}{\\sqrt{2}}, \\frac{2}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}) = (\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}})$\n$\\mathbf{P}_2^w = (1 \\cdot 0, 1 \\cdot 2, 1) = (0, 2, 1)$\n\nThese are the control points for a polynomial B-spline curve of degree $p=2$ with knot vector $\\Xi=\\{0,0,0,1,1,1\\}$.\n\n### Step 2: Knot Insertion Algorithm\nWe will insert the new knot $\\bar{\\xi}=1/2$ into the knot vector $\\Xi$. First, we must identify the knot span $[\\xi_k, \\xi_{k+1})$ in which $\\bar{\\xi}$ lies. The knot vector is $\\Xi=\\{\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5\\} = \\{0,0,0,1,1,1\\}$. Since $\\xi_2=0 \\le 1/2  \\xi_3=1$, the index is $k=2$.\n\nThe insertion of a single knot increases the number of control points by one. The original curve has $3$ control points. The new curve will have $4$ control points, which we denote as $\\hat{\\mathbf{P}}_0^w, \\hat{\\mathbf{P}}_1^w, \\hat{\\mathbf{P}}_2^w, \\hat{\\mathbf{P}}_3^w$.\n\nThe formula for the new control points $\\hat{\\mathbf{P}}_j$ (Boehm's algorithm) is:\n$\\hat{\\mathbf{P}}_j = \\mathbf{P}_j$ for $j \\le k-p$\n$\\hat{\\mathbf{P}}_j = (1-\\alpha_j)\\mathbf{P}_{j-1} + \\alpha_j \\mathbf{P}_j$ for $k-p+1 \\le j \\le k$\n$\\hat{\\mathbf{P}}_j = \\mathbf{P}_{j-1}$ for $j \\ge k+1$\n\nHere, $\\alpha_j = \\frac{\\bar{\\xi} - \\xi_j}{\\xi_{j+p} - \\xi_j}$. We apply this to the homogeneous control points $\\mathbf{P}_i^w$. With $p=2$ and $k=2$:\n- For $j \\le k-p = 2-2=0$: $\\hat{\\mathbf{P}}_0^w = \\mathbf{P}_0^w$.\n- For $j \\ge k+1 = 3$: $\\hat{\\mathbf{P}}_3^w = \\mathbf{P}_{3-1}^w = \\mathbf{P}_2^w$.\n- For $k-p+1 \\le j \\le k$, which is $1 \\le j \\le 2$, we compute new points:\n\nFor $j=1$:\n$\\alpha_1 = \\frac{\\bar{\\xi} - \\xi_1}{\\xi_{1+p} - \\xi_1} = \\frac{1/2 - \\xi_1}{\\xi_3 - \\xi_1} = \\frac{1/2 - 0}{1 - 0} = \\frac{1}{2}$.\n$\\hat{\\mathbf{P}}_1^w = (1-\\alpha_1)\\mathbf{P}_0^w + \\alpha_1 \\mathbf{P}_1^w = \\frac{1}{2}\\mathbf{P}_0^w + \\frac{1}{2}\\mathbf{P}_1^w$.\n$\\hat{\\mathbf{P}}_1^w = \\frac{1}{2}(2, 0, 1) + \\frac{1}{2}(\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}}) = (1, 0, \\frac{1}{2}) + (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2\\sqrt{2}}) = (1+\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2}+\\frac{\\sqrt{2}}{4}) = (\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$.\n\nFor $j=2$:\n$\\alpha_2 = \\frac{\\bar{\\xi} - \\xi_2}{\\xi_{2+p} - \\xi_2} = \\frac{1/2 - \\xi_2}{\\xi_4 - \\xi_2} = \\frac{1/2 - 0}{1 - 0} = \\frac{1}{2}$.\n$\\hat{\\mathbf{P}}_2^w = (1-\\alpha_2)\\mathbf{P}_1^w + \\alpha_2 \\mathbf{P}_2^w = \\frac{1}{2}\\mathbf{P}_1^w + \\frac{1}{2}\\mathbf{P}_2^w$.\n$\\hat{\\mathbf{P}}_2^w = \\frac{1}{2}(\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}}) + \\frac{1}{2}(0, 2, 1) = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2\\sqrt{2}}) + (0, 1, \\frac{1}{2}) = (\\frac{\\sqrt{2}}{2}, 1+\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{4}+\\frac{1}{2}) = (\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$.\n\nSo, the new set of homogeneous control points is:\n$\\hat{\\mathbf{P}}_0^w = (2, 0, 1)$\n$\\hat{\\mathbf{P}}_1^w = (\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$\n$\\hat{\\mathbf{P}}_2^w = (\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$\n$\\hat{\\mathbf{P}}_3^w = (0, 2, 1)$\n\n### Step 3: Projection back to Cartesian Coordinates\nTo obtain the new Cartesian control points $\\hat{\\mathbf{P}}_j=(\\hat{x}_j, \\hat{y}_j)$ and weights $\\hat{w}_j$, we project the homogeneous points $\\hat{\\mathbf{P}}_j^w=(X_j, Y_j, W_j)$ back: $\\hat{w}_j = W_j$ and $(\\hat{x}_j, \\hat{y}_j) = (\\frac{X_j}{W_j}, \\frac{Y_j}{W_j})$.\n\n- For $\\hat{\\mathbf{P}}_0^w=(2,0,1)$:\n$\\hat{w}_0 = 1$\n$\\hat{\\mathbf{P}}_0 = (\\frac{2}{1}, \\frac{0}{1}) = (2,0)$.\n\n- For $\\hat{\\mathbf{P}}_1^w=(\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$:\n$\\hat{w}_1 = \\frac{2+\\sqrt{2}}{4}$\n$\\hat{x}_1 = \\frac{(2+\\sqrt{2})/2}{(2+\\sqrt{2})/4} = 2$\n$\\hat{y}_1 = \\frac{\\sqrt{2}/2}{(2+\\sqrt{2})/4} = \\frac{\\sqrt{2}}{2} \\cdot \\frac{4}{2+\\sqrt{2}} = \\frac{2\\sqrt{2}}{2+\\sqrt{2}} = \\frac{2\\sqrt{2}(2-\\sqrt{2})}{(2+\\sqrt{2})(2-\\sqrt{2})} = \\frac{4\\sqrt{2}-4}{4-2} = 2\\sqrt{2}-2$.\n$\\hat{\\mathbf{P}}_1 = (2, 2\\sqrt{2}-2)$.\n\n- For $\\hat{\\mathbf{P}}_2^w=(\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$:\n$\\hat{w}_2 = \\frac{2+\\sqrt{2}}{4}$\n$\\hat{x}_2 = \\frac{\\sqrt{2}/2}{(2+\\sqrt{2})/4} = 2\\sqrt{2}-2$\n$\\hat{y}_2 = \\frac{(2+\\sqrt{2})/2}{(2+\\sqrt{2})/4} = 2$.\n$\\hat{\\mathbf{P}}_2 = (2\\sqrt{2}-2, 2)$.\n\n- For $\\hat{\\mathbf{P}}_3^w=(0,2,1)$:\n$\\hat{w}_3 = 1$\n$\\hat{\\mathbf{P}}_3 = (\\frac{0}{1}, \\frac{2}{1}) = (0,2)$.\n\n### Step 4: Final Result\nThe new knot vector, $\\hat{\\Xi}$, is formed by inserting $\\bar{\\xi}=1/2$ into $\\Xi$:\n$\\hat{\\Xi} = \\{0,0,0,1/2,1,1,1\\}$.\n\nThe new control points and weights, expressed as tuples $(\\hat{x}_i, \\hat{y}_i, \\hat{w}_i)$, are:\nFor $i=0$: $(2, 0, 1)$\nFor $i=1$: $(2, 2\\sqrt{2}-2, \\frac{2+\\sqrt{2}}{4})$\nFor $i=2$: $(2\\sqrt{2}-2, 2, \\frac{2+\\sqrt{2}}{4})$\nFor $i=3$: $(0, 2, 1)$\n\nThese results are collected into a single row matrix as requested.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  \\frac{1}{2}  1  1  1  2  0  1  2  2\\sqrt{2}-2  \\frac{2+\\sqrt{2}}{4}  2\\sqrt{2}-2  2  \\frac{2+\\sqrt{2}}{4}  0  2  1\n\\end{pmatrix}\n}\n$$", "id": "3575751"}]}