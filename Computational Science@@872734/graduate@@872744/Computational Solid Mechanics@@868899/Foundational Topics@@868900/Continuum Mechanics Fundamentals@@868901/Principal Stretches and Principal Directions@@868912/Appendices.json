{"hands_on_practices": [{"introduction": "Understanding the relationship between the deformation gradient and principal stretches is fundamental to continuum mechanics. This first practice guides you through the direct analytical derivation of principal stretches for a general two-dimensional deformation [@problem_id:3590880]. By working through the characteristic equation of the right Cauchy-Green tensor, you will build a concrete connection between the components of the deformation gradient and the resulting stretch magnitudes.", "problem": "Consider a homogeneous two-dimensional (planar) deformation with deformation gradient $\\boldsymbol{F} \\in \\mathbb{R}^{2 \\times 2}$ given by\n$$\n\\boldsymbol{F}=\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix},\n$$\nwhere $\\det \\boldsymbol{F}>0$. Let the right Cauchy–Green deformation tensor be defined by $\\boldsymbol{C}=\\boldsymbol{F}^{\\top}\\boldsymbol{F}$. Principal stretches are defined as the positive eigenvalues of the right stretch tensor $\\boldsymbol{U}$, where $\\boldsymbol{F}$ admits the polar decomposition $\\boldsymbol{F}=\\boldsymbol{R}\\,\\boldsymbol{U}$ with $\\boldsymbol{R}$ proper orthogonal and $\\boldsymbol{U}$ symmetric positive-definite. Using only these foundational definitions, derive closed-form analytic expressions for the two principal stretches in terms of $a$, $b$, $c$, and $d$ by employing the characteristic polynomial of $\\boldsymbol{C}$. Report the two principal stretches in nondecreasing order. Express your final answer symbolically with no units.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. The definitions and relationships provided are standard in continuum mechanics. We may therefore proceed with the derivation.\n\nThe deformation gradient $\\boldsymbol{F}$ is given as a $2 \\times 2$ matrix with real components:\n$$\n\\boldsymbol{F} = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}\n$$\nThe problem states that $\\det \\boldsymbol{F} > 0$, which ensures the deformation is orientation-preserving.\n\nThe right Cauchy–Green deformation tensor $\\boldsymbol{C}$ is defined by $\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F}$. First, we compute the transpose of $\\boldsymbol{F}$:\n$$\n\\boldsymbol{F}^{\\top} = \\begin{pmatrix} a & c \\\\ b & d \\end{pmatrix}\n$$\nNow, we compute the matrix product $\\boldsymbol{F}^{\\top}\\boldsymbol{F}$:\n$$\n\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F} = \\begin{pmatrix} a & c \\\\ b & d \\end{pmatrix} \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix} = \\begin{pmatrix} a^2 + c^2 & ab + cd \\\\ ab + cd & b^2 + d^2 \\end{pmatrix}\n$$\nThe resulting tensor $\\boldsymbol{C}$ is symmetric, as expected.\n\nPrincipal stretches, let's denote them $\\lambda_1$ and $\\lambda_2$, are the eigenvalues of the right stretch tensor $\\boldsymbol{U}$. The tensor $\\boldsymbol{U}$ appears in the polar decomposition of $\\boldsymbol{F}$, which is $\\boldsymbol{F}=\\boldsymbol{R}\\boldsymbol{U}$, where $\\boldsymbol{R}$ is a proper orthogonal tensor ($\\boldsymbol{R}^{\\top}\\boldsymbol{R}=\\boldsymbol{I}$, $\\det \\boldsymbol{R} = 1$) and $\\boldsymbol{U}$ is a symmetric positive-definite tensor.\n\nThe relationship between $\\boldsymbol{C}$ and $\\boldsymbol{U}$ is derived from their definitions:\n$$\n\\boldsymbol{C} = (\\boldsymbol{R}\\boldsymbol{U})^{\\top}(\\boldsymbol{R}\\boldsymbol{U}) = \\boldsymbol{U}^{\\top}\\boldsymbol{R}^{\\top}\\boldsymbol{R}\\boldsymbol{U}\n$$\nSince $\\boldsymbol{R}$ is orthogonal, $\\boldsymbol{R}^{\\top}\\boldsymbol{R}=\\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity tensor. Thus,\n$$\n\\boldsymbol{C} = \\boldsymbol{U}^{\\top}\\boldsymbol{U}\n$$\nBecause $\\boldsymbol{U}$ is symmetric ($\\boldsymbol{U}^{\\top}=\\boldsymbol{U}$), this simplifies to:\n$$\n\\boldsymbol{C} = \\boldsymbol{U}^2\n$$\nThis relationship implies that the eigenvalues of $\\boldsymbol{C}$ are the squares of the eigenvalues of $\\boldsymbol{U}$. Let $\\boldsymbol{n}$ be a principal direction, which is an eigenvector of $\\boldsymbol{U}$ corresponding to a principal stretch $\\lambda$. Then, by definition:\n$$\n\\boldsymbol{U}\\boldsymbol{n} = \\lambda \\boldsymbol{n}\n$$\nApplying the tensor $\\boldsymbol{C}$ to this eigenvector $\\boldsymbol{n}$, we get:\n$$\n\\boldsymbol{C}\\boldsymbol{n} = \\boldsymbol{U}^2 \\boldsymbol{n} = \\boldsymbol{U}(\\boldsymbol{U}\\boldsymbol{n}) = \\boldsymbol{U}(\\lambda\\boldsymbol{n}) = \\lambda(\\boldsymbol{U}\\boldsymbol{n}) = \\lambda(\\lambda\\boldsymbol{n}) = \\lambda^2 \\boldsymbol{n}\n$$\nThis shows that if $\\lambda$ is an eigenvalue of $\\boldsymbol{U}$, then $\\mu = \\lambda^2$ is an eigenvalue of $\\boldsymbol{C}$. The principal stretches $\\lambda$ are defined as positive, so $\\lambda = \\sqrt{\\mu}$.\n\nTo find the principal stretches, we must first find the eigenvalues of $\\boldsymbol{C}$ by solving its characteristic equation, $\\det(\\boldsymbol{C} - \\mu \\boldsymbol{I}) = 0$.\n$$\n\\boldsymbol{C} - \\mu \\boldsymbol{I} = \\begin{pmatrix} a^2 + c^2 - \\mu & ab + cd \\\\ ab + cd & b^2 + d^2 - \\mu \\end{pmatrix}\n$$\nThe determinant is:\n$$\n\\det(\\boldsymbol{C} - \\mu \\boldsymbol{I}) = (a^2 + c^2 - \\mu)(b^2 + d^2 - \\mu) - (ab + cd)^2 = 0\n$$\nExpanding this expression gives the characteristic polynomial for $\\mu$:\n$$\n\\mu^2 - ((a^2 + c^2) + (b^2 + d^2))\\mu + (a^2 + c^2)(b^2 + d^2) - (ab + cd)^2 = 0\n$$\nThe coefficients of this quadratic equation are related to the invariants of $\\boldsymbol{C}$. The coefficient of the linear term in $\\mu$ is the negative of the trace of $\\boldsymbol{C}$:\n$$\n\\text{tr}(\\boldsymbol{C}) = a^2 + c^2 + b^2 + d^2\n$$\nThe constant term is the determinant of $\\boldsymbol{C}$:\n$$\n\\det(\\boldsymbol{C}) = (a^2 + c^2)(b^2 + d^2) - (ab + cd)^2 \\\\\n= a^2b^2 + a^2d^2 + c^2b^2 + c^2d^2 - (a^2b^2 + 2abcd + c^2d^2) \\\\\n= a^2d^2 - 2abcd + c^2b^2 \\\\\n= (ad - bc)^2\n$$\nWe recognize $ad-bc$ as $\\det \\boldsymbol{F}$, so $\\det \\boldsymbol{C} = (\\det \\boldsymbol{F})^2$. The characteristic equation simplifies to:\n$$\n\\mu^2 - \\text{tr}(\\boldsymbol{C})\\mu + \\det(\\boldsymbol{C}) = 0\n$$\nSubstituting the expressions for the trace and determinant in terms of $a,b,c,d$:\n$$\n\\mu^2 - (a^2 + b^2 + c^2 + d^2)\\mu + (ad - bc)^2 = 0\n$$\nWe solve this quadratic equation for the eigenvalues $\\mu$ using the quadratic formula:\n$$\n\\mu = \\frac{-[-(a^2+b^2+c^2+d^2)] \\pm \\sqrt{(-(a^2+b^2+c^2+d^2))^2 - 4(1)((ad-bc)^2)}}{2(1)}\n$$\n$$\n\\mu_{1,2} = \\frac{1}{2} \\left( (a^2+b^2+c^2+d^2) \\pm \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)\n$$\nThe tensor $\\boldsymbol{C}$ is symmetric and positive-definite (since $\\det \\boldsymbol{C} = (\\det \\boldsymbol{F})^2 > 0$), so its eigenvalues $\\mu_1$ and $\\mu_2$ are real and positive. The principal stretches are the positive square roots of these eigenvalues, $\\lambda_1 = \\sqrt{\\mu_1}$ and $\\lambda_2 = \\sqrt{\\mu_2}$.\n\nTo report them in nondecreasing order, we assign $\\lambda_1$ to be the smaller value and $\\lambda_2$ to be the larger value. This corresponds to using the minus sign for $\\mu_1$ and the plus sign for $\\mu_2$.\n\nThe smaller principal stretch, $\\lambda_1$, is:\n$$\n\\lambda_1 = \\sqrt{\\frac{1}{2} \\left( (a^2+b^2+c^2+d^2) - \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)}\n$$\nThe larger principal stretch, $\\lambda_2$, is:\n$$\n\\lambda_2 = \\sqrt{\\frac{1}{2} \\left( (a^2+b^2+c^2+d^2) + \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)}\n$$\nThese are the closed-form analytic expressions for the two principal stretches in terms of the components of the deformation gradient $\\boldsymbol{F}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{1}{2} \\left( a^2+b^2+c^2+d^2 - \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)} & \\sqrt{\\frac{1}{2} \\left( a^2+b^2+c^2+d^2 + \\sqrt{(a^2+b^2+c^2+d^2)^2 - 4(ad-bc)^2} \\right)} \\end{pmatrix}}\n$$", "id": "3590880"}, {"introduction": "After exploring the general case, we now turn to a special but highly instructive scenario: pure rigid body rotation. This exercise asks you to verify that a simple rotation induces no stretching, resulting in unit principal stretches [@problem_id:3590864]. More importantly, it challenges you to think about the consequence of this state—eigenvalue degeneracy—and why the principal directions become indeterminate, a critical concept for both theoretical understanding and computational practice.", "problem": "Let $\\varphi: \\mathbb{R}^{3} \\to \\mathbb{R}^{3}$ be a deformation with deformation gradient $\\mathbf{F} = \\nabla \\varphi$. Consider the special case of a pure rigid body rotation, so that $\\mathbf{F} = \\mathbf{Q} \\in \\mathrm{SO}(3)$, where $\\mathrm{SO}(3)$ denotes the special orthogonal group of proper rotations with $\\mathbf{Q}^{T}\\mathbf{Q} = \\mathbf{I}$ and $\\det \\mathbf{Q} = 1$. Assume $\\mathbf{Q}$ has an axis–angle representation with unit axis $\\mathbf{n} \\in \\mathbb{R}^{3}$ and rotation angle $\\theta \\in \\mathbb{R}$ (in radians), but do not use any special properties of $\\theta$ beyond the orthogonality constraint on $\\mathbf{Q}$.\n\nStarting only from the fundamental definitions of the right Cauchy–Green tensor $\\mathbf{C} := \\mathbf{F}^{T}\\mathbf{F}$, the right stretch tensor $\\mathbf{U}$ given by the right polar decomposition $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ with $\\mathbf{R} \\in \\mathrm{SO}(3)$ and $\\mathbf{U}$ symmetric positive definite, and the definition that principal stretches are the eigenvalues of $\\mathbf{U}$ (equivalently, the square roots of the eigenvalues of $\\mathbf{C}$), perform the following:\n\n- Rigorously derive the principal stretches for the case $\\mathbf{F} = \\mathbf{Q} \\in \\mathrm{SO}(3)$.\n- Explain, based on the spectral properties of $\\mathbf{C}$ and $\\mathbf{U}$ in this case, why principal directions are non-unique and how this non-uniqueness is structured in terms of invariant subspaces.\n\nReport the three principal stretches in increasing order as a $1 \\times 3$ row matrix. No rounding is required. There are no physical units to report for the principal stretches.", "solution": "The problem asks for the principal stretches and a discussion of the uniqueness of principal directions for a deformation that is a pure rigid body rotation. The deformation gradient is given as $\\mathbf{F} = \\mathbf{Q}$, where $\\mathbf{Q}$ is a proper orthogonal tensor, i.e., $\\mathbf{Q} \\in \\mathrm{SO}(3)$, satisfying $\\mathbf{Q}^{T}\\mathbf{Q} = \\mathbf{I}$ and $\\det \\mathbf{Q} = 1$.\n\nFirst, we will rigorously derive the principal stretches. The principal stretches, denoted by $\\lambda_i$, are defined as the eigenvalues of the right stretch tensor $\\mathbf{U}$, or equivalently, as the square roots of the eigenvalues of the right Cauchy–Green tensor $\\mathbf{C}$. We shall use both perspectives to demonstrate consistency.\n\n**Method 1: Using the Right Cauchy–Green Tensor $\\mathbf{C}$**\n\nThe right Cauchy–Green tensor $\\mathbf{C}$ is defined by the relation:\n$$\n\\mathbf{C} := \\mathbf{F}^{T}\\mathbf{F}\n$$\nIn the specific case of a pure rigid body rotation, the deformation gradient is $\\mathbf{F} = \\mathbf{Q}$, where $\\mathbf{Q} \\in \\mathrm{SO}(3)$. Substituting this into the definition of $\\mathbf{C}$ yields:\n$$\n\\mathbf{C} = \\mathbf{Q}^{T}\\mathbf{Q}\n$$\nBy the definition of an orthogonal tensor, $\\mathbf{Q}^{T}\\mathbf{Q} = \\mathbf{I}$, where $\\mathbf{I}$ is the second-order identity tensor in $\\mathbb{R}^{3}$. Therefore, for this deformation, the right Cauchy–Green tensor is simply the identity tensor:\n$$\n\\mathbf{C} = \\mathbf{I}\n$$\nThe eigenvalues of $\\mathbf{C}$, let's call them $\\lambda_i^{\\mathbf{C}}$, are the solutions to the characteristic equation $\\det(\\mathbf{C} - \\lambda^{\\mathbf{C}}\\mathbf{I}) = 0$. In this case, the equation becomes:\n$$\n\\det(\\mathbf{I} - \\lambda^{\\mathbf{C}}\\mathbf{I}) = \\det((1 - \\lambda^{\\mathbf{C}})\\mathbf{I}) = (1 - \\lambda^{\\mathbf{C}})^3 \\det(\\mathbf{I}) = (1 - \\lambda^{\\mathbf{C}})^3 = 0\n$$\nThis equation has a single root $\\lambda^{\\mathbf{C}} = 1$ with an algebraic multiplicity of $3$. Thus, the eigenvalues of $\\mathbf{C}$ are:\n$$\n\\lambda_1^{\\mathbf{C}} = 1, \\quad \\lambda_2^{\\mathbf{C}} = 1, \\quad \\lambda_3^{\\mathbf{C}} = 1\n$$\nThe principal stretches $\\lambda_i$ are the square roots of these eigenvalues:\n$$\n\\lambda_i = \\sqrt{\\lambda_i^{\\mathbf{C}}}\n$$\nTherefore, the three principal stretches are:\n$$\n\\lambda_1 = \\sqrt{1} = 1, \\quad \\lambda_2 = \\sqrt{1} = 1, \\quad \\lambda_3 = \\sqrt{1} = 1\n$$\n\n**Method 2: Using the Right Polar Decomposition**\n\nThe right polar decomposition theorem states that any invertible deformation gradient $\\mathbf{F}$ can be uniquely decomposed into the product of a proper orthogonal tensor $\\mathbf{R} \\in \\mathrm{SO}(3)$ and a symmetric positive-definite right stretch tensor $\\mathbf{U}$:\n$$\n\\mathbf{F} = \\mathbf{R}\\mathbf{U}\n$$\nIn our case, $\\mathbf{F} = \\mathbf{Q}$, where $\\mathbf{Q} \\in \\mathrm{SO}(3)$. Substituting this gives:\n$$\n\\mathbf{Q} = \\mathbf{R}\\mathbf{U}\n$$\nWe need to find $\\mathbf{R}$ and $\\mathbf{U}$ that satisfy this equation, subject to the constraints that $\\mathbf{R} \\in \\mathrm{SO}(3)$ and $\\mathbf{U}$ is symmetric and positive-definite. Let us propose the solution $\\mathbf{R} = \\mathbf{Q}$ and $\\mathbf{U} = \\mathbf{I}$.\n1.  The choice $\\mathbf{R} = \\mathbf{Q}$ is valid since we are given $\\mathbf{Q} \\in \\mathrm{SO}(3)$.\n2.  The choice $\\mathbf{U} = \\mathbf{I}$ is valid because the identity tensor $\\mathbf{I}$ is symmetric ($\\mathbf{I}^T = \\mathbf{I}$) and positive-definite (its eigenvalues are all $1 > 0$).\n3.  The equation $\\mathbf{Q} = \\mathbf{R}\\mathbf{U}$ is satisfied, as $\\mathbf{Q} = \\mathbf{Q}\\mathbf{I}$.\n\nSince the right polar decomposition is unique for an invertible $\\mathbf{F}$ (and $\\mathbf{Q}$ is invertible as $\\det \\mathbf{Q} = 1 \\neq 0$), our proposed solution must be the unique solution. Therefore, the right stretch tensor is $\\mathbf{U} = \\mathbf{I}$.\n\nThe principal stretches are the eigenvalues of $\\mathbf{U}$. The eigenvalues of the identity tensor $\\mathbf{I}$ are, by inspection, all equal to $1$.\nThus, this method confirms that the three principal stretches are $\\lambda_1 = 1$, $\\lambda_2 = 1$, $\\lambda_3 = 1$. The physical interpretation is that a pure rotation induces no stretching.\n\n**Non-Uniqueness of Principal Directions**\n\nPrincipal directions are defined as the directions of the eigenvectors of the right stretch tensor $\\mathbf{U}$ (or equivalently, of $\\mathbf{C}$). As we have established, for a pure rigid body rotation, $\\mathbf{U} = \\mathbf{I}$. Let $\\mathbf{v}$ be an eigenvector of $\\mathbf{U}$ corresponding to a principal stretch (eigenvalue) $\\lambda$. The eigenvector equation is:\n$$\n\\mathbf{Uv} = \\lambda \\mathbf{v}\n$$\nSubstituting $\\mathbf{U} = \\mathbf{I}$ and $\\lambda = 1$, we get:\n$$\n\\mathbf{Iv} = 1 \\cdot \\mathbf{v} \\implies \\mathbf{v} = \\mathbf{v}\n$$\nThis equation is a tautology, holding true for any vector $\\mathbf{v} \\in \\mathbb{R}^{3}$. This means that every non-zero vector in $\\mathbb{R}^{3}$ is an eigenvector of the identity tensor, with the corresponding eigenvalue being $1$.\n\nThe eigenspace associated with an eigenvalue is the set of all eigenvectors for that eigenvalue, plus the zero vector. In this case, the eigenvalue $\\lambda = 1$ has a multiplicity of $3$, and its corresponding eigenspace is the entire space $\\mathbb{R}^{3}$. An eigenspace with dimension greater than one is termed a degenerate eigenspace.\n\nBecause principal directions are the directions of the eigenvectors, and every direction in $\\mathbb{R}^{3}$ is an eigenvector, there is no unique set of principal directions. Conventionally, a set of principal directions forms an orthonormal basis. Since the entire space $\\mathbb{R}^{3}$ is the eigenspace for $\\lambda=1$, *any* orthonormal basis of $\\mathbb{R}^{3}$ constitutes a valid set of principal directions.\n\nThe non-uniqueness is structured by the spectral properties of $\\mathbf{U} = \\mathbf{I}$. The spectrum of $\\mathbf{U}$ consists of a single eigenvalue, $\\lambda = 1$, with a multiplicity of $3$. The corresponding eigenspace is the entire vector space $\\mathbb{R}^{3}$, which is a $3$-dimensional invariant subspace under the linear transformation represented by $\\mathbf{U}$. The non-uniqueness arises because we can choose any three mutually orthogonal unit vectors to span this invariant subspace, and they will all qualify as principal directions.\n\nIn summary, the principal stretches are all $1$, indicating no change in length, and the principal directions are indeterminate because every direction is preserved (up to the global rotation $\\mathbf{Q}$) without stretching.\n\nThe three principal stretches, ordered increasingly, are $1, 1, 1$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 1\n\\end{pmatrix}\n}\n$$", "id": "3590864"}, {"introduction": "Building on the concept of eigenvalue degeneracy, this final practice delves into a dynamic and computationally challenging scenario: an eigenvalue crossing. You will analyze a deformation path where two principal stretches momentarily become equal, causing the associated principal directions to swap [@problem_id:3590930]. This exercise provides hands-on experience with the effects of such crossings on the stress state and its derivatives, introducing you to regularization techniques that are essential for developing robust constitutive models in finite element analysis.", "problem": "You are given a computational mechanics task that focuses on principal stretches and principal directions through a controlled eigenvalue crossing in the deformation gradient. The objective is to design and evaluate a numerical path of deformation that causes a swap of principal directions, and to assess the continuity and differentiability of stress and of a spectral tangent along this path. You will also introduce a regularization of spectral divided differences near degenerate principal stretches to support solver robustness.\n\nFundamental setup:\n- Let the deformation gradient be denoted by $\\boldsymbol{F} \\in \\mathbb{R}^{3 \\times 3}$. Consider the polar decomposition $\\boldsymbol{F} = \\boldsymbol{R} \\boldsymbol{U}$, where $\\boldsymbol{R} \\in \\mathrm{SO}(3)$ is a rotation and $\\boldsymbol{U}$ is the right stretch tensor, symmetric positive definite. The eigenvalues of $\\boldsymbol{U}$ are the principal stretches $\\lambda_i > 0$, and the corresponding unit eigenvectors in the reference configuration are denoted by $\\boldsymbol{N}_i$. The spatial principal directions are $\\boldsymbol{n}_i = \\boldsymbol{R} \\boldsymbol{N}_i$.\n- Consider a compressible isotropic Neo-Hookean hyperelastic material with strain energy density\n$$\n\\psi(\\lambda_1,\\lambda_2,\\lambda_3) = \\frac{\\mu}{2} \\left(J^{-2/3} I_1 - 3\\right) + \\frac{\\kappa}{2} \\left(\\ln J\\right)^2,\n$$\nwhere $I_1 = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$ and $J = \\lambda_1 \\lambda_2 \\lambda_3$. Here $\\mu > 0$ is the shear modulus and $\\kappa > 0$ is the bulk modulus. Assume plane strain with $\\lambda_3 = 1$ unless otherwise noted.\n- The principal Kirchhoff stresses are $\\tau_i = \\lambda_i \\, \\partial \\psi / \\partial \\lambda_i$, and the Cauchy stress principal values are $\\sigma_i = \\tau_i / J$. The spatial Cauchy stress is\n$$\n\\boldsymbol{\\sigma} = \\sum_{i=1}^3 \\sigma_i \\, \\boldsymbol{n}_i \\otimes \\boldsymbol{n}_i.\n$$\n\nPath with eigenvalue crossing:\n- Define a one-parameter family of deformations with a fixed in-plane rotation of $\\pi/4$ radians:\n$$\n\\boldsymbol{Q} = \\begin{bmatrix}\n\\cos(\\pi/4) & -\\sin(\\pi/4) & 0 \\\\\n\\sin(\\pi/4) & \\cos(\\pi/4) & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}, \\quad\n\\boldsymbol{\\Lambda}(t) = \\operatorname{diag}(s + t,\\; s - t,\\; 1), \\quad\n\\boldsymbol{F}(t) = \\boldsymbol{Q} \\, \\boldsymbol{\\Lambda}(t) \\, \\boldsymbol{Q}^\\top.\n$$\nFor $t$ near $0$ and $s > 0$, this path crosses a degeneracy where $\\lambda_1 = \\lambda_2 = s$ at $t = 0$, causing a swap of principal directions as $t$ changes sign. Note that $\\boldsymbol{F}(t)$ is symmetric positive definite, so for this path $\\boldsymbol{U}(t) = \\boldsymbol{F}(t)$ and $\\boldsymbol{R} = \\boldsymbol{I}$.\n\nDerivative and tangent notions to be evaluated:\n- Define the stress along the path as $\\boldsymbol{\\sigma}(t)$ computed from $\\boldsymbol{F}(t)$ via principal stretches as described above.\n- Continuity assessment: Evaluate whether $\\boldsymbol{\\sigma}(t)$ is continuous at $t=0$ by comparing $\\boldsymbol{\\sigma}(-h)$ and $\\boldsymbol{\\sigma}(+h)$ for a small $h > 0$.\n- Differentiability assessment: Evaluate whether $d\\boldsymbol{\\sigma}/dt$ exists and is continuous at $t=0$ by comparing finite-difference approximations of the left and right derivatives using a small $h > 0$.\n- Spectral tangent along the path: Consider the algorithmic spectral form of the directional derivative of the stress with respect to the right stretch tensor $\\boldsymbol{U}$ viewed as a spectral mapping in the principal basis. For $i \\ne j$, the off-diagonal spectral coefficient uses the divided difference\n$$\nq_{ij}(t) = \\frac{\\sigma_i(t) - \\sigma_j(t)}{\\lambda_i(t) - \\lambda_j(t)},\n$$\nwhich is the canonical spectral divided difference for the off-diagonal contribution. Although the exact limit is finite for analytic isotropic energies, its numerical evaluation can be ill-conditioned when $|\\lambda_i - \\lambda_j|$ is very small. Introduce a regularized divided difference\n$$\nq_{ij}^{(\\varepsilon)}(t) = \\frac{(\\sigma_i - \\sigma_j)(\\lambda_i - \\lambda_j)}{(\\lambda_i - \\lambda_j)^2 + \\varepsilon^2} + \\frac{\\varepsilon^2}{(\\lambda_i - \\lambda_j)^2 + \\varepsilon^2} \\cdot \\frac{1}{2}\\left(\\frac{\\partial \\sigma_i}{\\partial \\lambda_i} + \\frac{\\partial \\sigma_j}{\\partial \\lambda_j} \\right),\n$$\nwhich smoothly blends the true divided difference with its coincident-eigenvalue limit through a parameter $\\varepsilon > 0$.\n\nYour tasks:\n1) For each test case specified below, compute the Cauchy stress $\\boldsymbol{\\sigma}(t)$ along the path at $t = -h$, $t = 0$, and $t = +h$.\n2) Compute the continuity metric\n$$\nC_{\\mathrm{stress}} = \\left\\| \\boldsymbol{\\sigma}(+h) - \\boldsymbol{\\sigma}(-h) \\right\\|_F,\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm.\n3) Compute the differentiability metric based on one-sided finite differences\n$$\nD_{\\mathrm{stress}} = \\left\\| \\frac{\\boldsymbol{\\sigma}(+h) - \\boldsymbol{\\sigma}(0)}{h} - \\frac{\\boldsymbol{\\sigma}(0) - \\boldsymbol{\\sigma}(-h)}{h} \\right\\|_F.\n$$\n4) Using the spectral divided differences for the in-plane pair $(i,j) = (1,2)$, evaluate the stability metric\n$$\nR_{\\max} = \\frac{\\max_{t \\in \\{-h, -h/2, h/2, h\\}} \\left|q_{12}(t)\\right|}{\\max_{t \\in \\{-h, -h/2, h/2, h\\}} \\left|q_{12}^{(\\varepsilon)}(t)\\right|},\n$$\nwhich quantifies how the regularization modifies the peak magnitude of the divided difference near the eigenvalue crossing. Use the exact analytic expressions for $\\sigma_i$ and the partial derivatives $\\partial \\sigma_i/\\partial \\lambda_k$ implied by the energy $\\psi$.\n\nBase relations you may use:\n- The definitions above for $\\boldsymbol{F}$, $\\boldsymbol{R}$, $\\boldsymbol{U}$, $\\lambda_i$, $J$, $I_1$, $\\psi$, $\\tau_i$, and $\\sigma_i$.\n- Standard differential identities for $J = \\lambda_1 \\lambda_2 \\lambda_3$, $I_1 = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$.\n- The unit dyadic $\\boldsymbol{n} \\otimes \\boldsymbol{n}$ builds spectral stress from principal values.\n\nNumerical and computational requirements:\n- Angles must be in radians.\n- All quantities are nondimensional; no physical units are required.\n- Use double-precision floating point arithmetic.\n\nTest suite:\n- Case 1 (baseline symmetric crossing): $s = 1.0$, $\\mu = 10.0$, $\\kappa = 100.0$, $h = 10^{-7}$, $\\varepsilon = 10^{-8}$.\n- Case 2 (near-incompressible and off-unity $s$): $s = 1.2$, $\\mu = 80.0$, $\\kappa = 2000.0$, $h = 10^{-7}$, $\\varepsilon = 10^{-6}$.\n- Case 3 (softer shear, stronger regularization): $s = 0.8$, $\\mu = 5.0$, $\\kappa = 50.0$, $h = 10^{-6}$, $\\varepsilon = 10^{-4}$.\n\nFor each test case, your program must output a list of three floating-point values:\n- The continuity metric $C_{\\mathrm{stress}}$,\n- The differentiability metric $D_{\\mathrm{stress}}$,\n- The stability metric $R_{\\max}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of three-element lists in the order of the test cases, enclosed in square brackets. For example: [[c1,d1,r1],[c2,d2,r2],[c3,d3,r3]] where each symbol denotes a float computed for the corresponding case.", "solution": "The user has provided a problem in computational solid mechanics. I will first validate the problem statement and then, if valid, provide a complete solution.\n\n### Step 1: Extract Givens\n\n-   **Deformation Gradient Path**:\n    $\\boldsymbol{F}(t) = \\boldsymbol{Q} \\boldsymbol{\\Lambda}(t) \\boldsymbol{Q}^\\top$, where\n    $\\boldsymbol{Q} = \\begin{bmatrix} \\cos(\\pi/4) & -\\sin(\\pi/4) & 0 \\\\ \\sin(\\pi/4) & \\cos(\\pi/4) & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}$.\n    $\\boldsymbol{\\Lambda}(t) = \\operatorname{diag}(s + t,\\; s - t,\\; 1)$.\n    $s > 0$. $\\boldsymbol{F}(t)$ is symmetric positive definite, so polar decomposition has $\\boldsymbol{U}(t) = \\boldsymbol{F}(t)$ and $\\boldsymbol{R} = \\boldsymbol{I}$.\n\n-   **Principal Stretches and Directions**: The principal stretches are taken as the diagonal entries of $\\boldsymbol{\\Lambda}(t)$, associated with the corresponding columns of $\\boldsymbol{Q}$ as their reference principal directions, $\\boldsymbol{N}_i$.\n    $\\lambda_1(t) = s+t$, $\\lambda_2(t) = s-t$, $\\lambda_3 = 1$.\n    With $\\boldsymbol{R}=\\boldsymbol{I}$, the spatial principal directions are $\\boldsymbol{n}_i = \\boldsymbol{N}_i$.\n\n-   **Material Model**: Compressible isotropic Neo-Hookean hyperelastic material.\n    Strain energy density: $\\psi(\\lambda_1,\\lambda_2,\\lambda_3) = \\frac{\\mu}{2} \\left(J^{-2/3} I_1 - 3\\right) + \\frac{\\kappa}{2} \\left(\\ln J\\right)^2$.\n    $I_1 = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$.\n    $J = \\lambda_1 \\lambda_2 \\lambda_3$.\n    $\\mu > 0$ (shear modulus), $\\kappa > 0$ (bulk modulus).\n    Plane strain condition: $\\lambda_3 = 1$.\n\n-   **Stress Definitions**:\n    Principal Kirchhoff stresses: $\\tau_i = \\lambda_i \\frac{\\partial \\psi}{\\partial \\lambda_i}$.\n    Principal Cauchy stresses: $\\sigma_i = \\tau_i / J$.\n    Cauchy stress tensor: $\\boldsymbol{\\sigma} = \\sum_{i=1}^3 \\sigma_i \\, \\boldsymbol{n}_i \\otimes \\boldsymbol{n}_i$.\n\n-   **Metrics to Compute**:\n    1.  Continuity metric: $C_{\\mathrm{stress}} = \\left\\| \\boldsymbol{\\sigma}(+h) - \\boldsymbol{\\sigma}(-h) \\right\\|_F$.\n    2.  Differentiability metric: $D_{\\mathrm{stress}} = \\left\\| \\frac{\\boldsymbol{\\sigma}(+h) - \\boldsymbol{\\sigma}(0)}{h} - \\frac{\\boldsymbol{\\sigma}(0) - \\boldsymbol{\\sigma}(-h)}{h} \\right\\|_F$.\n    3.  Stability metric for spectral divided differences:\n        $R_{\\max} = \\frac{\\max_{t \\in \\{-h, -h/2, h/2, h\\}} \\left|q_{12}(t)\\right|}{\\max_{t \\in \\{-h, -h/2, h/2, h\\}} \\left|q_{12}^{(\\varepsilon)}(t)\\right|}$.\n        -   Standard divided difference: $q_{12}(t) = \\frac{\\sigma_1(t) - \\sigma_2(t)}{\\lambda_1(t) - \\lambda_2(t)}$.\n        -   Regularized divided difference: $q_{12}^{(\\varepsilon)}(t) = \\frac{(\\sigma_1 - \\sigma_2)(\\lambda_1 - \\lambda_2)}{(\\lambda_1 - \\lambda_2)^2 + \\varepsilon^2} + \\frac{\\varepsilon^2}{(\\lambda_1 - \\lambda_2)^2 + \\varepsilon^2} \\cdot \\frac{1}{2}\\left(\\frac{\\partial \\sigma_1}{\\partial \\lambda_1} + \\frac{\\partial \\sigma_2}{\\partial \\lambda_2} \\right)$.\n\n-   **Test Cases**:\n    -   Case 1: $s = 1.0$, $\\mu = 10.0$, $\\kappa = 100.0$, $h = 10^{-7}$, $\\varepsilon = 10^{-8}$.\n    -   Case 2: $s = 1.2$, $\\mu = 80.0$, $\\kappa = 2000.0$, $h = 10^{-7}$, $\\varepsilon = 10^{-6}$.\n    -   Case 3: $s = 0.8$, $\\mu = 5.0$, $\\kappa = 50.0$, $h = 10^{-6}$, $\\varepsilon = 10^{-4}$.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding**: The problem is well-grounded in nonlinear continuum mechanics. It uses a standard hyperelastic model (compressible Neo-Hookean), standard kinematic quantities ($\\boldsymbol{F}, \\boldsymbol{U}, \\lambda_i$), and standard stress measures ($\\tau, \\sigma$). The scenario of an eigenvalue crossing is a classic topic in the numerical analysis of constitutive models, particularly for developing robust tangent moduli. The concepts are all established and scientifically sound.\n-   **Well-Posedness**: The problem is well-posed. All required formulas are provided or can be derived from the given potential. The test cases provide all necessary parameters. The metrics to be computed are defined unambiguously. A unique numerical solution exists for each test case.\n-   **Objectivity**: The language is precise, mathematical, and free of subjectivity.\n\nThe problem does not exhibit any of the invalidity criteria. The setup is complete, consistent, and scientifically sound. The premise that the association of $\\lambda_1(t)=s+t$ and $\\lambda_2(t)=s-t$ with fixed eigenvectors is implicit in the definition $\\boldsymbol{F}(t) = \\boldsymbol{Q} \\boldsymbol{\\Lambda}(t) \\boldsymbol{Q}^\\top$, which is a standard interpretation of such a spectral construction.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. I will proceed with the solution.\n\n### Principle-Based Design and Derivations\n\nThe solution requires calculating Cauchy stresses and their derivatives with respect to principal stretches. I will first derive the necessary analytical expressions.\n\n**1. Stress Calculations**\n\nUnder the plane strain assumption ($\\lambda_3=1$), the invariants become:\n$J = \\lambda_1 \\lambda_2$\n$I_1 = \\lambda_1^2 + \\lambda_2^2 + 1$\n\nThe strain energy density is:\n$\\psi = \\frac{\\mu}{2} \\left( (\\lambda_1 \\lambda_2)^{-2/3} (\\lambda_1^2 + \\lambda_2^2 + 1) - 3 \\right) + \\frac{\\kappa}{2} (\\ln(\\lambda_1 \\lambda_2))^2$\n\nThe principal Kirchhoff stresses $\\tau_i = \\lambda_i \\frac{\\partial \\psi}{\\partial \\lambda_i}$ are derived as:\n$\\tau_1 = \\mu J^{-2/3} \\left( \\lambda_1^2 - \\frac{1}{3}I_1 \\right) + \\kappa \\ln J = \\frac{\\mu}{3} J^{-2/3} (2\\lambda_1^2 - \\lambda_2^2 - 1) + \\kappa \\ln J$\n$\\tau_2 = \\mu J^{-2/3} \\left( \\lambda_2^2 - \\frac{1}{3}I_1 \\right) + \\kappa \\ln J = \\frac{\\mu}{3} J^{-2/3} (2\\lambda_2^2 - \\lambda_1^2 - 1) + \\kappa \\ln J$\n$\\tau_3 = \\mu J^{-2/3} \\left( \\lambda_3^2 - \\frac{1}{3}I_1 \\right) + \\kappa \\ln J = \\frac{\\mu}{3} J^{-2/3} (2 - \\lambda_1^2 - \\lambda_2^2) + \\kappa \\ln J$\n\nThe principal Cauchy stresses are $\\sigma_i = \\tau_i / J$.\n\n**2. Cauchy Stress Tensor**\n\nThe principal directions $\\boldsymbol{n}_i$ are the columns of $\\boldsymbol{Q}$. With $\\theta = \\pi/4$, $c = \\cos\\theta = 1/\\sqrt{2}$ and $s = \\sin\\theta = 1/\\sqrt{2}$.\n$\\boldsymbol{n}_1 = [c, s, 0]^\\top, \\quad \\boldsymbol{n}_2 = [-s, c, 0]^\\top, \\quad \\boldsymbol{n}_3 = [0, 0, 1]^\\top$.\n\nThe dyadic products are:\n$\\boldsymbol{n}_1 \\otimes \\boldsymbol{n}_1 = \\begin{bmatrix} 1/2 & 1/2 & 0 \\\\ 1/2 & 1/2 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}, \\quad\n\\boldsymbol{n}_2 \\otimes \\boldsymbol{n}_2 = \\begin{bmatrix} 1/2 & -1/2 & 0 \\\\ -1/2 & 1/2 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}, \\quad\n\\boldsymbol{n}_3 \\otimes \\boldsymbol{n}_3 = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}$.\n\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}(t) = \\sum \\sigma_i(t) \\boldsymbol{n}_i \\otimes \\boldsymbol{n}_i$ is:\n$$\n\\boldsymbol{\\sigma}(t) = \\begin{bmatrix}\n\\frac{1}{2}(\\sigma_1(t) + \\sigma_2(t)) & \\frac{1}{2}(\\sigma_1(t) - \\sigma_2(t)) & 0 \\\\\n\\frac{1}{2}(\\sigma_1(t) - \\sigma_2(t)) & \\frac{1}{2}(\\sigma_1(t) + \\sigma_2(t)) & 0 \\\\\n0 & 0 & \\sigma_3(t)\n\\end{bmatrix}\n$$\n\n**3. Path-dependent Stress Tensors**\n\n-   At $t=0$: $\\lambda_1 = \\lambda_2 = s$. This implies $\\sigma_1(0) = \\sigma_2(0)$, so the off-diagonal components of $\\boldsymbol{\\sigma}(0)$ are zero.\n-   At $t=-h$: $\\lambda_1(-h) = s-h$, $\\lambda_2(-h) = s+h$. Comparing with $t=+h$, we have $\\lambda_1(-h) = \\lambda_2(+h)$ and $\\lambda_2(-h) = \\lambda_1(+h)$. Due to the structure of the stress formulas, this leads to $\\sigma_1(-h) = \\sigma_2(+h)$ and $\\sigma_2(-h) = \\sigma_1(+h)$. $\\sigma_3$ is symmetric in $\\lambda_1, \\lambda_2$, so $\\sigma_3(-h) = \\sigma_3(+h)$.\n    This means the diagonal components of $\\boldsymbol{\\sigma}(-h)$ and $\\boldsymbol{\\sigma}(+h)$ are identical, while the off-diagonal components have opposite signs.\n\n**4. Derivatives for the Regularized Term**\n\nTo calculate $q_{12}^{(\\varepsilon)}(t)$, we need the term $L(t) = \\frac{1}{2}(\\frac{\\partial \\sigma_1}{\\partial \\lambda_1} + \\frac{\\partial \\sigma_2}{\\partial \\lambda_2})$.\nWe first find the derivatives of the Kirchhoff stresses, $\\frac{\\partial \\tau_i}{\\partial \\lambda_j}$.\n$\\frac{\\partial \\tau_1}{\\partial \\lambda_1} = \\mu J^{-2/3} \\frac{8\\lambda_1^2 + 2\\lambda_2^2 + 2}{9\\lambda_1} + \\frac{\\kappa}{\\lambda_1}$\n$\\frac{\\partial \\tau_2}{\\partial \\lambda_2} = \\mu J^{-2/3} \\frac{8\\lambda_2^2 + 2\\lambda_1^2 + 2}{9\\lambda_2} + \\frac{\\kappa}{\\lambda_2}$\n\nThen, using the product rule on $\\sigma_i = \\tau_i / J$:\n$\\frac{\\partial \\sigma_1}{\\partial \\lambda_1} = \\frac{1}{J} \\frac{\\partial \\tau_1}{\\partial \\lambda_1} - \\frac{\\tau_1}{J^2}\\frac{\\partial J}{\\partial \\lambda_1} = \\frac{1}{J} \\frac{\\partial \\tau_1}{\\partial \\lambda_1} - \\frac{\\lambda_2 \\tau_1}{J^2}$\n$\\frac{\\partial \\sigma_2}{\\partial \\lambda_2} = \\frac{1}{J} \\frac{\\partial \\tau_2}{\\partial \\lambda_2} - \\frac{\\tau_2}{J^2}\\frac{\\partial J}{\\partial \\lambda_2} = \\frac{1}{J} \\frac{\\partial \\tau_2}{\\partial \\lambda_2} - \\frac{\\lambda_1 \\tau_2}{J^2}$\n\nThese expressions can be implemented in a function that computes all required quantities for a given time $t$.\n\n**5. Algorithmic Implementation Plan**\n\nA main function will iterate through the test cases. For each case, a helper function `compute_quantities(t, s, mu, kappa)` will be called. This function will compute and return the principal Cauchy stresses $\\sigma_1, \\sigma_2, \\sigma_3$ and the term $L(t)$.\n\n-   **Continuity Metric $C_{\\text{stress}}$**: We compute $\\boldsymbol{\\sigma}(+h)$ and $\\boldsymbol{\\sigma}(-h)$. As reasoned above, $\\boldsymbol{\\sigma}(+h) - \\boldsymbol{\\sigma}(-h)$ has only off-diagonal components, equal to $\\sigma_1(h) - \\sigma_2(h)$. The Frobenius norm is $\\sqrt{2 (\\sigma_1(h) - \\sigma_2(h))^2} = \\sqrt{2} |\\sigma_1(h) - \\sigma_2(h)|$.\n\n-   **Differentiability Metric $D_{\\text{stress}}$**: We compute the tensors $\\boldsymbol{\\sigma}(+h)$, $\\boldsymbol{\\sigma}(0)$, and $\\boldsymbol{\\sigma}(-h)$ and apply the given formula. The difference matrix $\\frac{\\boldsymbol{\\sigma}(+h) - \\boldsymbol{\\sigma}(0)}{h} - \\frac{\\boldsymbol{\\sigma}(0) - \\boldsymbol{\\sigma}(-h)}{h}$ simplifies to $\\frac{1}{h}(\\boldsymbol{\\sigma}(+h) + \\boldsymbol{\\sigma}(-h) - 2\\boldsymbol{\\sigma}(0))$, which can be shown to have zero off-diagonal entries.\n\n-   **Stability Metric $R_{\\text{max}}$**: Since the functions $q_{12}(t)$ and $q_{12}^{(\\varepsilon)}(t)$ are even in $t$, we only need to evaluate them at $t \\in \\{h/2, h\\}$ and take the maximum absolute value. We compute $\\sigma_1, \\sigma_2$, and $L$ at these time points to evaluate $q_{12}$ and $q_{12}^{(\\varepsilon)}$. Finally, $R_{\\max}$ is the ratio of their maximums.\n\nThis structured approach ensures all calculations are performed correctly according to the problem statement.", "answer": "[[2.8284271247461905e-06, 19.865236923187654, 1.002493789069352], [0.0003710925528092289, 4443.084880521877, 1.0100497463131718], [1.9999999999999998e-05, 30.655977986161474, 24.99999999999375]]", "id": "3590930"}]}