{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will apply the Galerkin method to one of the most fundamental problems in engineering: the Poisson equation. This exercise bridges the gap between the abstract theory of weighted residuals and the concrete practice of finite element analysis. By deriving an element stiffness matrix from first principles, you will gain a foundational understanding of how a continuous partial differential equation is transformed into a discrete algebraic system ready for computational solution [@problem_id:3610256].", "problem": "Consider the steady two-dimensional Poisson equation for a scalar field $u(x,y)$ on a polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with constant, isotropic conductivity $k>0$:\n$$ -\\nabla \\cdot \\left( k \\nabla u \\right) = f \\quad \\text{in } \\Omega, $$\nwith appropriate essential boundary conditions on $\\partial \\Omega$. Starting from the weighted residual statement and using the Galerkin choice of test functions (i.e., test and trial spaces spanned by the same finite element basis functions), derive the element stiffness matrix expression on a triangular element $e$ as an integral of the form\n$$ K^{(e)} = \\int_{\\Omega_e} B^{T} k B \\, d\\Omega, $$\nwhere $B$ is constructed from the spatial gradients of the linear shape functions on the element. Show that for a linear triangular element $B$ is constant over the element and evaluate the integral explicitly in terms of the nodal coordinates.\n\nThen, consider the square domain $\\Omega = [0,1] \\times [0,1]$ discretized into two non-overlapping linear triangular elements by the diagonal from $(0,0)$ to $(1,1)$:\n- Element $e_1$ with global nodes $\\{1,2,3\\}$ having coordinates $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(1,0)$, $(x_3,y_3)=(1,1)$.\n- Element $e_2$ with global nodes $\\{1,3,4\\}$ having coordinates $(x_1,y_1)=(0,0)$, $(x_3,y_3)=(1,1)$, $(x_4,y_4)=(0,1)$.\n\nUsing the derived $B$ and the constant conductivity $k$, compute $K^{(e_1)}$ and $K^{(e_2)}$ explicitly by evaluating $\\int_{\\Omega_e} B^{T} k B \\, d\\Omega$ on each element. Assemble these two element matrices into the $4 \\times 4$ global stiffness matrix $K$ using the standard finite element assembly procedure based on the global node numbering $\\{1,2,3,4\\}$.\n\nWhat is the assembled global stiffness entry $K_{23}$, expressed exactly in terms of $k$? Provide your final answer as a single exact symbolic expression in terms of $k$ (no units and no approximation).", "solution": "The process begins with the validation of the problem statement.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The steady two-dimensional Poisson equation is given by $-\\nabla \\cdot (k \\nabla u) = f$ in a domain $\\Omega \\subset \\mathbb{R}^{2}$.\n- **Conductivity**: $k$ is a positive constant ($k>0$) and isotropic.\n- **Methodology**: The derivation should start from the weighted residual statement and employ the Galerkin method, where test functions and trial functions are from the same space spanned by finite element basis functions.\n- **Target Expression**: The element stiffness matrix $K^{(e)}$ must be derived in the form $K^{(e)} = \\int_{\\Omega_e} B^{T} k B \\, d\\Omega$.\n- **Element Type**: Linear triangular elements are used.\n- **Specific Domain**: A square domain $\\Omega = [0,1] \\times [0,1]$.\n- **Discretization**: The domain is divided into two non-overlapping linear triangular elements, $e_1$ and $e_2$, by the diagonal from $(0,0)$ to $(1,1)$.\n- **Element Connectivity and Coordinates**:\n    - Element $e_1$: Global nodes $\\{1,2,3\\}$ with coordinates $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(1,0)$, and $(x_3,y_3)=(1,1)$.\n    - Element $e_2$: Global nodes $\\{1,3,4\\}$ with coordinates $(x_1,y_1)=(0,0)$, $(x_3,y_3)=(1,1)$, and $(x_4,y_4)=(0,1)$.\n- **Objective**: Compute the element stiffness matrices $K^{(e_1)}$ and $K^{(e_2)}$, assemble them into the global stiffness matrix $K$, and determine the specific entry $K_{23}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Poisson equation, a fundamental partial differential equation in physics and engineering, and its solution using the Finite Element Method (FEM), a standard and well-established numerical technique. The principles are correct and mainstream within computational solid mechanics and heat transfer.\n- **Well-Posed**: The problem is clearly stated with all necessary information provided. The domain, element types, nodal coordinates, and connectivity are explicitly defined. This setup ensures a unique, stable, and meaningful solution for the requested stiffness matrix entry.\n- **Objective**: The problem is formulated using precise mathematical and technical language, free from any subjectivity or ambiguity.\n\nThe problem does not exhibit any of the invalidity flaws. It is scientifically sound, well-posed, complete, and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe derivation starts from the weighted residual statement for the given Poisson equation. Let $w$ be an arbitrary test function. The weighted residual statement is:\n$$ \\int_{\\Omega} w \\left[ -\\nabla \\cdot (k \\nabla u) - f \\right] d\\Omega = 0 $$\nApplying integration by parts (Green's first identity) to the divergence term gives:\n$$ \\int_{\\Omega} \\nabla w \\cdot (k \\nabla u) d\\Omega - \\int_{\\partial \\Omega} w (k \\nabla u \\cdot \\mathbf{n}) ds - \\int_{\\Omega} w f d\\Omega = 0 $$\nThis is the weak form of the problem. For the stiffness matrix, we are concerned with the bilinear form involving $u$ and $w$. In the Finite Element Method, the domain $\\Omega$ is discretized into elements $\\Omega_e$. The solution $u$ is approximated within each element $e$ by $u_h^{(e)}$ using shape functions $N_i$ and nodal values $d_i^{(e)}$:\n$$ u_h^{(e)}(x,y) = \\sum_{i=1}^{n_{en}} N_i^{(e)}(x,y) d_i^{(e)} = \\mathbf{N}^{(e)} \\mathbf{d}^{(e)} $$\nwhere $n_{en}$ is the number of nodes per element (here, $n_{en}=3$). In the Galerkin method, the test functions $w$ are chosen from the same space as the trial (shape) functions. Thus, we can write $w_h = \\sum_{j=1}^{n_{en}} c_j N_j^{(e)}$, where $c_j$ are arbitrary coefficients. This requires the weak form to hold for each basis function $N_j$ individually. The contribution of an element to the system of equations is given by a matrix, known as the element stiffness matrix $K^{(e)}$, with entries:\n$$ K_{ji}^{(e)} = \\int_{\\Omega_e} k (\\nabla N_j) \\cdot (\\nabla N_i) d\\Omega $$\nThe gradient of the approximation $u_h^{(e)}$ is:\n$$ \\nabla u_h^{(e)} = \\begin{pmatrix} \\frac{\\partial u_h^{(e)}}{\\partial x} \\\\ \\frac{\\partial u_h^{(e)}}{\\partial y} \\end{pmatrix} = \\sum_{i=1}^{n_{en}} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} d_i^{(e)} = \\mathbf{B}^{(e)} \\mathbf{d}^{(e)} $$\nwhere the matrix $\\mathbf{B}^{(e)}$ is defined as:\n$$ \\mathbf{B}^{(e)} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} & \\frac{\\partial N_2}{\\partial x} & \\dots & \\frac{\\partial N_{n_{en}}}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y} & \\frac{\\partial N_2}{\\partial y} & \\dots & \\frac{\\partial N_{n_{en}}}{\\partial y} \\end{pmatrix} $$\nThe integrand of the stiffness matrix can be written in matrix notation as $k (\\nabla N_j)^T (\\nabla N_i)$. The full matrix becomes:\n$$ K^{(e)} = \\int_{\\Omega_e} k \\mathbf{B}^{(e)T} \\mathbf{B}^{(e)} d\\Omega $$\nSince $k$ is a scalar constant, this is equivalent to the requested form $K^{(e)} = \\int_{\\Omega_e} \\mathbf{B}^{(e)T} k \\mathbf{B}^{(e)} d\\Omega$.\n\nFor a 3-node linear triangular element, the shape functions are linear functions of coordinates: $N_i(x,y) = a_i + b_i x + c_i y$. The derivatives are constants: $\\frac{\\partial N_i}{\\partial x} = b_i$ and $\\frac{\\partial N_i}{\\partial y} = c_i$. Consequently, the matrix $\\mathbf{B}^{(e)}$ is constant over the element. The coefficients $b_i$ and $c_i$ are given by:\n$$ b_i = \\frac{y_j - y_k}{2A_e}, \\quad c_i = \\frac{x_k - x_j}{2A_e} $$\nwhere $(i,j,k)$ is a cyclic permutation of $(1,2,3)$ and $A_e$ is the area of the element. The $\\mathbf{B}^{(e)}$ matrix is:\n$$ \\mathbf{B}^{(e)} = \\frac{1}{2A_e} \\begin{pmatrix} y_2-y_3 & y_3-y_1 & y_1-y_2 \\\\ x_3-x_2 & x_1-x_3 & x_2-x_1 \\end{pmatrix} $$\nSince $k$ and $\\mathbf{B}^{(e)}$ are constant over the element, the integral for $K^{(e)}$ simplifies to:\n$$ K^{(e)} = k \\mathbf{B}^{(e)T} \\mathbf{B}^{(e)} \\int_{\\Omega_e} d\\Omega = k A_e \\mathbf{B}^{(e)T} \\mathbf{B}^{(e)} $$\n\nNow, we compute the stiffness matrices for the two specified elements.\n\n**Element $e_1$**:\nNodes (local 1, 2, 3) are global nodes (1, 2, 3) with coordinates: $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(1,0)$, $(x_3,y_3)=(1,1)$.\nArea $A_{e_1} = \\frac{1}{2} |x_1(y_2-y_3)+x_2(y_3-y_1)+x_3(y_1-y_2)| = \\frac{1}{2}|0(0-1)+1(1-0)+1(0-0)| = \\frac{1}{2}$.\nThe components for the $\\mathbf{B}^{(1)}$ matrix are:\n$y_2-y_3 = 0-1 = -1$\n$y_3-y_1 = 1-0 = 1$\n$y_1-y_2 = 0-0 = 0$\n$x_3-x_2 = 1-1 = 0$\n$x_1-x_3 = 0-1 = -1$\n$x_2-x_1 = 1-0 = 1$\nWith $2A_{e_1}=1$, the $\\mathbf{B}^{(1)}$ matrix is:\n$$ \\mathbf{B}^{(1)} = \\frac{1}{1} \\begin{pmatrix} -1 & 1 & 0 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\begin{pmatrix} -1 & 1 & 0 \\\\ 0 & -1 & 1 \\end{pmatrix} $$\nThe element stiffness matrix $K^{(e_1)}$ is:\n$$ K^{(e_1)} = k A_{e_1} \\mathbf{B}^{(1)T} \\mathbf{B}^{(1)} = k \\left(\\frac{1}{2}\\right) \\begin{pmatrix} -1 & 0 \\\\ 1 & -1 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} -1 & 1 & 0 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\frac{k}{2} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} $$\nThe rows and columns of this matrix correspond to global nodes $\\{1, 2, 3\\}$.\n\n**Element $e_2$**:\nLocal nodes (1, 2, 3) are mapped to global nodes (1, 3, 4). The coordinates are: $(x_1,y_1)=(0,0)$ [global 1], $(x_2,y_2)=(1,1)$ [global 3], $(x_3,y_3)=(0,1)$ [global 4].\nArea $A_{e_2} = \\frac{1}{2}|0(1-1)+1(1-0)+0(0-1)| = \\frac{1}{2}$.\nThe components for the $\\mathbf{B}^{(2)}$ matrix (using local node coordinates) are:\n$y_2-y_3 = 1-1 = 0$\n$y_3-y_1 = 1-0 = 1$\n$y_1-y_2 = 0-1 = -1$\n$x_3-x_2 = 0-1 = -1$\n$x_1-x_3 = 0-0 = 0$\n$x_2-x_1 = 1-0 = 1$\nWith $2A_{e_2}=1$, the $\\mathbf{B}^{(2)}$ matrix is:\n$$ \\mathbf{B}^{(2)} = \\frac{1}{1} \\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\end{pmatrix} $$\nThe element stiffness matrix $K^{(e_2)}$ is:\n$$ K^{(e_2)} = k A_{e_2} \\mathbf{B}^{(2)T} \\mathbf{B}^{(2)} = k \\left(\\frac{1}{2}\\right) \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\end{pmatrix} = \\frac{k}{2} \\begin{pmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} $$\nThe rows and columns of this matrix correspond to its local nodes $\\{1, 2, 3\\}$, which map to global nodes $\\{1, 3, 4\\}$.\n\n**Assembly of the Global Stiffness Matrix and finding $K_{23}$**\nThe global stiffness matrix $K$ is a $4 \\times 4$ matrix. An entry $K_{IJ}$ is the sum of contributions from all elements that contain both global node $I$ and global node $J$.\n$$ K_{IJ} = \\sum_{e} K_{ij}^{(e)} \\quad \\text{where local node } i \\to \\text{global } I \\text{ and local node } j \\to \\text{global } J $$\nWe need to find the entry $K_{23}$. This entry represents the interaction between global node $2$ and global node $3$.\nWe inspect the element connectivity:\n- Element $e_1$ contains global nodes $\\{1, 2, 3\\}$. It contains both node $2$ and node $3$.\n- Element $e_2$ contains global nodes $\\{1, 3, 4\\}$. It does not contain node $2$.\nTherefore, only element $e_1$ contributes to the $K_{23}$ entry of the global stiffness matrix.\nThe local numbering for $e_1$ is $\\{1,2,3\\}$, which corresponds directly to the global numbering $\\{1,2,3\\}$. Thus, the contribution from $e_1$ to the global $K_{23}$ entry is simply the entry $K^{(e_1)}_{23}$.\nFrom our calculation of $K^{(e_1)}$:\n$$ K^{(e_1)} = \\frac{k}{2} \\begin{pmatrix} K^{(e_1)}_{11} & K^{(e_1)}_{12} & K^{(e_1)}_{13} \\\\ K^{(e_1)}_{21} & K^{(e_1)}_{22} & K^{(e_1)}_{23} \\\\ K^{(e_1)}_{31} & K^{(e_1)}_{32} & K^{(e_1)}_{33} \\end{pmatrix} = \\frac{k}{2} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} $$\nThe entry at the 2nd row and 3rd column is $K^{(e_1)}_{23} = \\frac{k}{2}(-1) = -\\frac{k}{2}$.\nSince no other element contributes to this entry, the assembled global stiffness entry is:\n$$ K_{23} = K^{(e_1)}_{23} = -\\frac{k}{2} $$\nThe final answer is the symbolic expression for this entry.", "answer": "$$\\boxed{-\\frac{k}{2}}$$", "id": "3610256"}, {"introduction": "Moving from static to dynamic systems, our next practice explores the treatment of inertia within the Galerkin framework. This exercise introduces the theoretically exact 'consistent' mass matrix and contrasts it with the computationally efficient 'lumped' mass matrix, viewing the latter as a form of inexact integration that introduces a residual. Through a guided coding problem, you will quantify the discrepancy between these two approaches, gaining insight into the crucial trade-offs between accuracy and efficiency in transient dynamic analysis [@problem_id:3610262].", "problem": "Consider the one-dimensional small-strain transient elastodynamics of a prismatic bar of length $L$ with constant cross-sectional area $A$, mass density $\\rho$, and Young's modulus $E$. Let the displacement field be $u(x,t)$ and the externally applied body force per unit length be $p(x,t)$. The strong form of the governing equation follows from Newton's Second Law and Hooke's Law:\n$$\n\\rho A \\, \\frac{\\partial^2 u}{\\partial t^2}(x,t) - \\frac{\\partial}{\\partial x}\\left(E A \\, \\frac{\\partial u}{\\partial x}(x,t)\\right) = p(x,t), \\quad x \\in (0,L), \\; t > 0.\n$$\nThe Galerkin weighted residual statement with test function $w(x)$, where the test space equals the trial space, is\n$$\n\\int_0^L \\rho A \\, w(x) \\, \\frac{\\partial^2 u}{\\partial t^2}(x,t) \\, \\mathrm{d}x + \\int_0^L E A \\, \\frac{\\partial w}{\\partial x}(x) \\, \\frac{\\partial u}{\\partial x}(x,t) \\, \\mathrm{d}x - \\int_0^L w(x) \\, p(x,t) \\, \\mathrm{d}x = 0,\n$$\nfor all admissible $w$. Using a finite element approximation with $n$ global nodes, let $u(x,t) \\approx \\sum_{j=1}^n N_j(x) \\, d_j(t)$ where $N_j(x)$ are the shape functions and $d_j(t)$ are the nodal displacements. With the Galerkin choice $w(x) = N_i(x)$, the semi-discrete system becomes\n$$\n\\mathbf{M} \\, \\ddot{\\mathbf{d}}(t) + \\mathbf{K} \\, \\mathbf{d}(t) = \\mathbf{f}(t),\n$$\nwhere the consistent mass and stiffness matrices have entries\n$$\nM_{ij} = \\int_0^L \\rho A \\, N_i(x) \\, N_j(x) \\, \\mathrm{d}x, \\quad K_{ij} = \\int_0^L E A \\, \\frac{\\mathrm{d}N_i}{\\mathrm{d}x}(x) \\, \\frac{\\mathrm{d}N_j}{\\mathrm{d}x}(x) \\, \\mathrm{d}x,\n$$\nand the force vector is $f_i(t) = \\int_0^L N_i(x) \\, p(x,t) \\, \\mathrm{d}x$. In standard practice, the consistent mass matrix $\\mathbf{M}$ is computed by exact or sufficiently accurate Gaussian quadrature. A lumped mass matrix $\\mathbf{M}_\\ell$ can be obtained by viewing mass assembly as inexact quadrature with nodal Newton–Cotes weights, which yields a diagonal approximation:\n$$\nM_{\\ell,ii} \\approx \\rho A \\, \\sum_{e} \\left(J_e \\sum_{k \\in \\mathcal{N}_e} \\alpha_k \\, N_i(\\xi_k) \\, N_i(\\xi_k)\\right),\n$$\nwhere the sum runs over elements $e$, $\\mathcal{N}_e$ are the element nodes, $\\xi_k$ are the reference-element nodal coordinates, $J_e = L_e/2$ is the element Jacobian, and $\\alpha_k$ are the closed Newton–Cotes weights on the reference interval. For two-node linear elements, use the trapezoidal weights $\\alpha = [1,1]$. For three-node quadratic elements, use Simpson's weights $\\alpha = [\\tfrac{1}{3}, \\tfrac{4}{3}, \\tfrac{1}{3}]$. In both cases, the quadrature is inexact for the integrand $N_i N_j$ of polynomial degree exceeding the exactness of the rule, inducing a residual in the Galerkin weighted residual statement.\n\nDefine the induced mass-term residual vector for a given acceleration $\\mathbf{a}(t) = \\ddot{\\mathbf{d}}(t)$ as\n$$\n\\mathbf{r}(t) = \\left(\\mathbf{M} - \\mathbf{M}_\\ell\\right)\\mathbf{a}(t).\n$$\nQuantify the effect of inexact quadrature by the dimensionless relative residual\n$$\n\\eta(t) = \\frac{\\left\\|\\mathbf{r}(t)\\right\\|_2}{\\left\\|\\mathbf{M}\\,\\mathbf{a}(t)\\right\\|_2}.\n$$\n\nYour task is to write a program that constructs meshes, assembles the consistent mass matrix $\\mathbf{M}$ using Gaussian quadrature exact for the polynomial degree of $N_i N_j$, assembles the lumped mass matrix $\\mathbf{M}_\\ell$ by nodal Newton–Cotes quadrature as specified above, evaluates a manufactured nodal acceleration vector $\\mathbf{a}$, and computes $\\eta$ for each of the following test cases. All trigonometric function arguments are in radians.\n\nTest Suite:\n- Case 1 (linear elements, nontrivial acceleration):\n    - $L = 1.0$ meters, $A = 1.0 \\times 10^{-4}$ square meters, $\\rho = 7800$ kilograms per cubic meter.\n    - Uniform mesh with $n_e = 4$ two-node linear elements.\n    - Manufactured displacement $u(x,t) = \\sin(\\pi x)\\cos(\\omega t)$ with $\\omega = 200$ radians per second; evaluate at $t=0$ seconds. Then $a(x,0) = \\ddot{u}(x,0) = -\\omega^2 \\sin(\\pi x)$, so set nodal accelerations $a_i = -\\omega^2 \\sin(\\pi x_i)$.\n- Case 2 (quadratic elements, higher spatial frequency acceleration):\n    - $L = 1.0$ meters, $A = 1.0 \\times 10^{-4}$ square meters, $\\rho = 7800$ kilograms per cubic meter.\n    - Uniform mesh with $n_e = 2$ three-node quadratic elements (nodes at element endpoints and midpoints).\n    - Manufactured displacement $u(x,t) = \\sin(2\\pi x)\\cos(\\omega t)$ with $\\omega = 300$ radians per second; evaluate at $t=0$ seconds. Then $a(x,0) = -\\omega^2 \\sin(2\\pi x)$, so set nodal accelerations $a_i = -\\omega^2 \\sin(2\\pi x_i)$.\n- Case 3 (linear elements, constant acceleration boundary case):\n    - $L = 1.0$ meters, $A = 1.0 \\times 10^{-4}$ square meters, $\\rho = 7800$ kilograms per cubic meter.\n    - Uniform mesh with $n_e = 3$ two-node linear elements.\n    - Constant acceleration $a_0 = 50$ meters per second squared; set nodal accelerations $a_i = a_0$ for all $i$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, where each entry is the floating-point value of $\\eta$ for that case. For example, the output must have the form \"[eta1,eta2,eta3]\". Because $\\eta$ is dimensionless, no physical unit needs to be reported.", "solution": "The user has provided a problem statement that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The one-dimensional transient elastodynamics equation is given as $\\rho A \\, \\frac{\\partial^2 u}{\\partial t^2}(x,t) - \\frac{\\partial}{\\partial x}\\left(E A \\, \\frac{\\partial u}{\\partial x}(x,t)\\right) = p(x,t)$.\n- **Discretization Method**: Galerkin finite element method with $u(x,t) \\approx \\sum_{j=1}^n N_j(x) \\, d_j(t)$ and test functions $w(x) = N_i(x)$.\n- **Semi-Discrete System**: $\\mathbf{M} \\, \\ddot{\\mathbf{d}}(t) + \\mathbf{K} \\, \\mathbf{d}(t) = \\mathbf{f}(t)$.\n- **Consistent Mass Matrix**: $M_{ij} = \\int_0^L \\rho A \\, N_i(x) \\, N_j(x) \\, \\mathrm{d}x$, to be computed using Gaussian quadrature exact for the integrand.\n- **Lumped Mass Matrix**: A diagonal matrix $\\mathbf{M}_\\ell$ obtained by element-wise nodal quadrature.\n  - For 2-node linear elements, weights $\\alpha = [1,1]$ (Trapezoidal rule).\n  - For 3-node quadratic elements, weights $\\alpha = [\\tfrac{1}{3}, \\tfrac{4}{3}, \\tfrac{1}{3}]$ (Simpson's rule).\n- **Residual Definition**: The induced mass-term residual vector is $\\mathbf{r}(t) = \\left(\\mathbf{M} - \\mathbf{M}_\\ell\\right)\\mathbf{a}(t)$, where $\\mathbf{a}(t) = \\ddot{\\mathbf{d}}(t)$.\n- **Error Metric**: The dimensionless relative residual is $\\eta(t) = \\frac{\\left\\|\\mathbf{r}(t)\\right\\|_2}{\\left\\|\\mathbf{M}\\,\\mathbf{a}(t)\\right\\|_2}$.\n- **Test Cases**:\n  1. **Case 1**: $L = 1.0$, $A = 10^{-4}$, $\\rho = 7800$. Mesh: $n_e = 4$ linear elements. Nodal accelerations: $a_i = -\\omega^2 \\sin(\\pi x_i)$ with $\\omega = 200$, evaluated at $t=0$.\n  2. **Case 2**: $L = 1.0$, $A = 10^{-4}$, $\\rho = 7800$. Mesh: $n_e = 2$ quadratic elements. Nodal accelerations: $a_i = -\\omega^2 \\sin(2\\pi x_i)$ with $\\omega = 300$, evaluated at $t=0$.\n  3. **Case 3**: $L = 1.0$, $A = 10^{-4}$, $\\rho = 7800$. Mesh: $n_e = 3$ linear elements. Nodal accelerations: $a_i = a_0 = 50$ for all nodes.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a rigorous validation check.\n- **Scientifically Grounded**: The problem is founded on the established principles of continuum mechanics, dynamics, and the finite element method. The concepts of consistent and lumped mass matrices are standard in computational dynamics. The use of a manufactured solution to define an acceleration field is a valid technique for verification.\n- **Well-Posed**: The problem is well-posed. All physical parameters ($L$, $A$, $\\rho$), mesh configurations ($n_e$, element type), and acceleration fields are explicitly defined for each case. The procedure to compute the matrices $\\mathbf{M}$ and $\\mathbf{M}_\\ell$ and the final quantity $\\eta$ is unambiguous, ensuring a unique solution exists.\n- **Objective**: The problem is stated in precise, objective mathematical language.\n- **Completeness and Consistency**: The problem is self-contained. While the governing equation includes a stiffness term with Young's Modulus $E$, the calculation of $\\eta$ depends only on the mass matrices and the acceleration vector. Thus, the value of $E$ is not necessary and its absence does not render the problem incomplete. The provided parameters and definitions are consistent with each other. The formula for the lumped mass matrix, while expressed in a slightly non-standard form, is shown through analysis to correctly represent standard nodal quadrature lumping schemes (Trapezoidal for linear, Simpson's for quadratic).\n- **Triviality/Tautology**: The problem is not trivial. It requires the implementation of FEM assembly procedures and highlights a key concept in computational dynamics: the error introduced by mass lumping. Case 3, which results in a zero residual, serves as a non-trivial check of understanding the properties of mass lumping, specifically that it preserves the total mass and first moment of mass for linear elements. The denominator $\\|\\mathbf{M}\\,\\mathbf{a}(t)\\|_2$ is only zero if $\\mathbf{a}(t)$ is the zero vector (since $\\mathbf{M}$ is positive definite), which is not the case in any of the test suites.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A detailed solution will be provided.\n\n### Solution\nThe objective is to compute the dimensionless relative residual $\\eta = \\|\\mathbf{r}\\|_2 / \\|\\mathbf{M}\\mathbf{a}\\|_2$, which quantifies the discrepancy introduced by using a lumped mass matrix $\\mathbf{M}_\\ell$ in place of a consistent mass matrix $\\mathbf{M}$ for a given nodal acceleration vector $\\mathbf{a}$. This requires assembling both matrices for several finite element meshes.\n\n**1. Finite Element Formulation and Element Matrices**\nWe consider a uniform discretization of the domain $x \\in [0, L]$. For an element of length $L_e$, we map the physical coordinate $x$ to a reference coordinate $\\xi \\in [-1, 1]$ using the Jacobian $J_e = L_e/2$.\n\n**For 2-node linear elements:**\nThe element consistent mass matrix is given by\n$$\n\\mathbf{M}^{(e)}_{cons} = \\int_{e} \\rho A \\mathbf{N}(x) \\mathbf{N}(x)^T \\mathrm{d}x = \\rho A J_e \\int_{-1}^{1} \\mathbf{N}(\\xi) \\mathbf{N}(\\xi)^T \\mathrm{d}\\xi = \\frac{\\rho A L_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\nThis integral is exact. The element lumped mass matrix, using the Trapezoidal rule (weights $\\alpha=[1,1]$ at nodes $\\xi=[-1,1]$), is\n$$\n\\mathbf{M}^{(e)}_{\\ell} = \\rho A J_e \\, \\text{diag}\\left(\\sum_{k=1}^2 \\alpha_k N_a(\\xi_k)^2\\right)_{a=1,2} = \\frac{\\rho A L_e}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\n\n**For 3-node quadratic elements:**\nThe element consistent mass matrix is\n$$\n\\mathbf{M}^{(e)}_{cons} = \\rho A J_e \\int_{-1}^{1} \\mathbf{N}(\\xi) \\mathbf{N}(\\xi)^T \\mathrm{d}\\xi = \\frac{\\rho A L_e}{30} \\begin{pmatrix} 4 & 2 & -1 \\\\ 2 & 16 & 2 \\\\ -1 & 2 & 4 \\end{pmatrix}.\n$$\nThe element lumped mass matrix, using Simpson's rule (weights $\\alpha=[\\tfrac{1}{3}, \\tfrac{4}{3}, \\tfrac{1}{3}]$ at nodes $\\xi=[-1,0,1]$), is\n$$\n\\mathbf{M}^{(e)}_{\\ell} = \\rho A J_e \\, \\text{diag}\\left(\\sum_{k=1}^3 \\alpha_k N_a(\\xi_k)^2\\right)_{a=1,2,3} = \\frac{\\rho A L_e}{6} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}.\n$$\n\n**2. Global Matrix Assembly**\nThe global matrices $\\mathbf{M}$ and $\\mathbf{M}_\\ell$ are assembled by iterating through each element, identifying the global indices of its nodes, and adding the entries of the corresponding element matrices $\\mathbf{M}^{(e)}_{cons}$ and $\\mathbf{M}^{(e)}_{\\ell}$ into the appropriate locations of the global matrices.\n\n**3. Nodal Acceleration and Residual Calculation**\nFor each test case, a mesh of nodes with coordinates $x_i$ is generated. The nodal acceleration vector $\\mathbf{a}$ is populated by evaluating the specified acceleration function at these coordinates, i.e., $a_i = a(x_i)$.\nWith the global matrices and acceleration vector defined, the residual vector $\\mathbf{r}$ and the consistent mass-weighted force vector $\\mathbf{f}_M = \\mathbf{M}\\mathbf{a}$ are computed. Finally, their Euclidean norms ($\\| \\cdot \\|_2$) are calculated to find $\\eta$.\n\n**Case 3 Analysis**\nFor linear elements, the shape functions possess the property $\\sum_j N_j(x) = 1$. When the acceleration is constant, $a_i = a_0$ for all $i$, so $\\mathbf{a} = a_0 \\mathbf{1}$, where $\\mathbf{1}$ is a vector of ones. The $i$-th component of the vector $\\mathbf{M}\\mathbf{1}$ is $\\sum_j M_{ij} = \\sum_j \\int_0^L \\rho A N_i(x) N_j(x) \\mathrm{d}x = \\int_0^L \\rho A N_i(x) \\left(\\sum_j N_j(x)\\right) \\mathrm{d}x = \\int_0^L \\rho A N_i(x) \\mathrm{d}x$. This operation is known as row-sum lumping. For linear elements, row-sum lumping is identical to the lumping scheme prescribed by the Trapezoidal rule. Therefore, $\\mathbf{M}\\mathbf{1} = \\mathbf{M}_\\ell\\mathbf{1}$. It follows that for a constant acceleration vector $\\mathbf{a}=a_0 \\mathbf{1}$, the residual vector $\\mathbf{r} = (\\mathbf{M} - \\mathbf{M}_\\ell)\\mathbf{a} = a_0(\\mathbf{M}\\mathbf{1} - \\mathbf{M}_\\ell\\mathbf{1}) = \\mathbf{0}$. Consequently, the relative residual $\\eta$ must be exactly $0$.\n\nThe following program implements this procedure for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating the relative residual for three test cases.\n    \"\"\"\n\n    # Define test cases as per the problem description\n    test_cases = [\n        {\n            \"L\": 1.0, \"A\": 1.0e-4, \"rho\": 7800,\n            \"n_e\": 4, \"elem_type\": \"linear\",\n            \"accel_func\": lambda x, omega=200.0: -omega**2 * np.sin(np.pi * x)\n        },\n        {\n            \"L\": 1.0, \"A\": 1.0e-4, \"rho\": 7800,\n            \"n_e\": 2, \"elem_type\": \"quadratic\",\n            \"accel_func\": lambda x, omega=300.0: -omega**2 * np.sin(2.0 * np.pi * x)\n        },\n        {\n            \"L\": 1.0, \"A\": 1.0e-4, \"rho\": 7800,\n            \"n_e\": 3, \"elem_type\": \"linear\",\n            \"accel_func\": lambda x, a0=50.0: a0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        L, A, rho = params[\"L\"], params[\"A\"], params[\"rho\"]\n        n_e, elem_type = params[\"n_e\"], params[\"elem_type\"]\n        accel_func = params[\"accel_func\"]\n\n        # 1. Generate mesh and nodal information\n        if elem_type == \"linear\":\n            num_nodes = n_e + 1\n            nodes_per_elem = 2\n        elif elem_type == \"quadratic\":\n            num_nodes = 2 * n_e + 1\n            nodes_per_elem = 3\n        else:\n            raise ValueError(\"Unsupported element type\")\n            \n        node_coords = np.linspace(0, L, num_nodes)\n        elem_len = L / n_e\n\n        # 2. Define element mass matrices\n        if elem_type == \"linear\":\n            # Consistent mass matrix for a 2-node linear bar element\n            Me_cons = (rho * A * elem_len / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n            # Lumped mass matrix (using Trapezoidal rule)\n            Me_lump = (rho * A * elem_len / 2.0) * np.identity(nodes_per_elem)\n        \n        elif elem_type == \"quadratic\":\n            # Consistent mass matrix for a 3-node quadratic bar element\n            Me_cons = (rho * A * elem_len / 30.0) * np.array([[4.0, 2.0, -1.0], [2.0, 16.0, 2.0], [-1.0, 2.0, 4.0]])\n            # Lumped mass matrix (using Simpson's rule)\n            Me_lump = (rho * A * elem_len / 6.0) * np.diag([1.0, 4.0, 1.0])\n            \n        # 3. Assemble global matrices\n        M_cons = np.zeros((num_nodes, num_nodes))\n        M_lump = np.zeros((num_nodes, num_nodes))\n        \n        for e in range(n_e):\n            if elem_type == \"linear\":\n                # Element e connects global nodes e and e+1\n                indices = [e, e + 1]\n            else: # quadratic\n                # Element e connects global nodes 2e, 2e+1, and 2e+2\n                indices = [2 * e, 2 * e + 1, 2 * e + 2]\n            \n            # Use np.ix_ to facilitate adding element matrix to global matrix\n            ix = np.ix_(indices, indices)\n            M_cons[ix] += Me_cons\n            \n            # Assemble diagonal lumped mass matrix\n            for i_local, i_global in enumerate(indices):\n                M_lump[i_global, i_global] += Me_lump[i_local, i_local]\n\n        # 4. Construct nodal acceleration vector\n        a_vals = accel_func(node_coords)\n        if np.isscalar(a_vals):\n            # Handle constant acceleration case\n            a = np.full(num_nodes, a_vals, dtype=float)\n        else:\n            a = a_vals\n            \n        # 5. Compute residual, norms, and the relative residual eta\n        r = (M_cons - M_lump) @ a\n        fM = M_cons @ a\n\n        norm_r = np.linalg.norm(r)\n        norm_fM = np.linalg.norm(fM)\n        \n        # The ratio is 0 if the numerator is 0. norm_fM is non-zero\n        # for non-zero acceleration, as M_cons is positive definite.\n        eta = norm_r / norm_fM if norm_fM != 0 else 0.0\n        results.append(eta)\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3610262"}, {"introduction": "Our final practice delves into a more advanced application, demonstrating how the weighted residual viewpoint is crucial for developing robust and reliable finite elements. We will investigate the phenomenon of 'hourglassing' in under-integrated elements, framing these spurious deformations as null residual directions that the standard weak form fails to penalize. This exercise will guide you through the process of deriving a residual-based stabilization term, calibrating it to restore the correct element rank without introducing excessive stiffness, a vital skill for advanced finite element development [@problem_id:3610216].", "problem": "Consider a single bilinear quadrilateral element ($\\mathrm{Q4}$) in the Finite Element (FE) method for small-strain, linear, isotropic, plane strain elasticity. The parent coordinates are $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$, and the element maps to a square of side length $L$ with constant Jacobian determinant $\\det J = L^{2}/4$. Let the bilinear shape functions be $N_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$, and $N_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$. Take the Lamé parameters to be $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $G = \\frac{E}{2(1+\\nu)}$, with $E$ the Young’s modulus and $\\nu$ the Poisson ratio. In the standard Galerkin weighted residual formulation, the weak form of linear momentum balance is $\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\boldsymbol{v} \\cdot \\boldsymbol{b} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_{t}} \\boldsymbol{v} \\cdot \\boldsymbol{t} \\, \\mathrm{d}\\Gamma$, where $\\boldsymbol{u}$ is the displacement field, $\\boldsymbol{v}$ is the test function, $\\boldsymbol{\\varepsilon}(\\cdot)$ is the small-strain operator, $\\mathbb{C}$ is the plane strain elasticity tensor characterized by $\\lambda$ and $G$, $\\boldsymbol{b}$ is the body force, and $\\boldsymbol{t}$ is the traction. Using one-point Gauss integration at $(\\xi,\\eta)=(0,0)$ (under-integration), the internal residual and stiffness are evaluated only at the element center. This under-integration admits nontrivial null residual directions (hourglass modes) that produce zero strain at the center and therefore zero internal virtual work, leading to rank deficiency.\n\nFocus on the following canonical hourglass mode: nodal displacements have nonzero $x$-components only, with $(u_{1x},u_{2x},u_{3x},u_{4x}) = (a,-a,a,-a)$ and $(u_{1y},u_{2y},u_{3y},u_{4y}) = (0,0,0,0)$, where $a$ is a real amplitude. This displacement pattern induces strains $\\varepsilon_{xx}$ and $\\varepsilon_{xy}$ that vanish at $(\\xi,\\eta)=(0,0)$, and so the Galerkin residual computed with one-point Gauss integration is zero along this direction.\n\nYou will construct a residual-based stabilization that restores rank without over-stiffening by adding a term confined to the hourglass null residual subspace. Let $e(\\xi,\\eta)$ denote the strain vector in Voigt notation with the third component taken as twice the tensorial shear strain, i.e., $e = [\\varepsilon_{xx}, \\varepsilon_{yy}, 2 \\varepsilon_{xy}]^{\\mathsf{T}}$, so that the stress vector $s = [\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^{\\mathsf{T}}$ satisfies $s = \\mathbf{D} \\, e$, with the plane strain elasticity matrix\n$$\n\\mathbf{D} = \\begin{bmatrix}\n\\lambda + 2 G & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2 G & 0 \\\\\n0 & 0 & G\n\\end{bmatrix}.\n$$\nDefine the stabilization energy functional restricted to the hourglass subspace by\n$$\nU_{\\mathrm{stab}}(u_{h}) = \\frac{1}{2} \\, \\alpha \\sum_{q=1}^{4} e_{h}(\\xi_{q},\\eta_{q})^{\\mathsf{T}} \\, \\mathbf{D} \\, e_{h}(\\xi_{q},\\eta_{q}) \\, \\det J,\n$$\nwhere $(\\xi_{q},\\eta_{q})$ are the four Gauss points of the $2 \\times 2$ rule, $\\det J = L^{2}/4$, $e_{h}$ is the strain induced by the hourglass displacement $u_{h}$ (the projector onto the hourglass null residual subspace is assumed exact so that no stabilization acts outside that subspace), and $\\alpha$ is a dimensionless stabilization coefficient to be determined.\n\nStarting from the Galerkin weak form and the bilinear shape functions, and using the weighted residual viewpoint, carry out the following steps:\n\n- Show that the chosen $u_{h}$ is a null residual direction under one-point Gauss integration by demonstrating that $e_{h}(0,0) = \\boldsymbol{0}$, and therefore the internal virtual work evaluated at the center vanishes.\n- Compute the exact Galerkin strain energy $U_{\\mathrm{full}}(u_{h})$ for this hourglass mode using full $2 \\times 2$ Gauss integration, expressing the result in terms of $a$, $\\lambda$, and $G$.\n- Impose the rank-restoring, non-over-stiffening calibration condition $U_{\\mathrm{stab}}(u_{h}) = U_{\\mathrm{full}}(u_{h})$ and solve for the stabilization coefficient $\\alpha$.\n\nYour final answer must be the single real number or closed-form expression for $\\alpha$. No rounding is necessary and no units are required for $\\alpha$.", "solution": "The problem statement is critically validated and found to be self-contained, scientifically grounded, and well-posed. It represents a standard problem in the field of computational solid mechanics concerning hourglass stabilization for under-integrated finite elements. All necessary data and definitions are provided.\n\nThe solution proceeds in three steps as requested by the problem statement. First, we will derive the strain field for the given hourglass displacement mode and verify that it vanishes at the element center. Second, we will compute the exact strain energy for this mode using full integration. Third, we will evaluate the stabilization energy functional and use the calibration condition to determine the stabilization coefficient $\\alpha$.\n\nStep 1: Strain field of the hourglass mode and verification of the null residual direction.\n\nThe displacement field $\\boldsymbol{u}(\\xi, \\eta)$ within the element is interpolated from the nodal displacements using the bilinear shape functions $N_i(\\xi, \\eta)$:\n$$\n\\boldsymbol{u}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\boldsymbol{u}_i\n$$\nThe problem specifies a particular hourglass mode, which we denote as $\\boldsymbol{u}_h$. The nodal displacements for this mode are given by $(u_{1x}, u_{2x}, u_{3x}, u_{4x}) = (a, -a, a, -a)$ and $(u_{1y}, u_{2y}, u_{3y}, u_{4y}) = (0, 0, 0, 0)$.\n\nThe $x$-component of the displacement field is:\n$$\nu_x(\\xi, \\eta) = N_1(\\xi, \\eta) a + N_2(\\xi, \\eta) (-a) + N_3(\\xi, \\eta) a + N_4(\\xi, \\eta) (-a)\n$$\nSubstituting the shape functions:\n$$\nu_x(\\xi, \\eta) = \\frac{a}{4} [ (1-\\xi)(1-\\eta) - (1+\\xi)(1-\\eta) + (1+\\xi)(1+\\eta) - (1-\\xi)(1+\\eta) ]\n$$\n$$\nu_x(\\xi, \\eta) = \\frac{a}{4} [ (1-\\eta)(1-\\xi-1-\\xi) + (1+\\eta)(1+\\xi-1+\\xi) ]\n$$\n$$\nu_x(\\xi, \\eta) = \\frac{a}{4} [ (1-\\eta)(-2\\xi) + (1+\\eta)(2\\xi) ] = \\frac{a}{4} [-2\\xi + 2\\xi\\eta + 2\\xi + 2\\xi\\eta] = \\frac{a}{4} [4\\xi\\eta] = a\\xi\\eta\n$$\nThe $y$-component of the displacement field is $u_y(\\xi, \\eta) = 0$. So, the hourglass displacement field is $\\boldsymbol{u}_h(\\xi, \\eta) = [a\\xi\\eta, 0]^{\\mathsf{T}}$.\n\nTo compute the strains, we need the mapping from parent coordinates $(\\xi, \\eta)$ to physical coordinates $(x, y)$. For a square element of side length $L$ with a constant Jacobian determinant $\\det \\mathbf{J} = L^2/4$, a suitable mapping is $x = \\frac{L}{2}\\xi$ and $y = \\frac{L}{2}\\eta$. The Jacobian matrix of this mapping is:\n$$\n\\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} L/2 & 0 \\\\ 0 & L/2 \\end{bmatrix}\n$$\nIts inverse is $\\mathbf{J}^{-1} = \\begin{bmatrix} 2/L & 0 \\\\ 0 & 2/L \\end{bmatrix}$. The gradient operator transforms as $\\begin{pmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{pmatrix}$. Thus, $\\frac{\\partial}{\\partial x} = \\frac{2}{L}\\frac{\\partial}{\\partial \\xi}$ and $\\frac{\\partial}{\\partial y} = \\frac{2}{L}\\frac{\\partial}{\\partial \\eta}$.\n\nThe components of the small strain tensor are:\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{2}{L} \\frac{\\partial}{\\partial \\xi}(a\\xi\\eta) = \\frac{2a}{L}\\eta\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{2}{L} \\frac{\\partial}{\\partial \\eta}(0) = 0\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}\\left(\\frac{2}{L}\\frac{\\partial}{\\partial \\eta}(a\\xi\\eta) + 0\\right) = \\frac{a}{L}\\xi\n$$\nIn the specified Voigt notation, the strain vector $e_h = [\\varepsilon_{xx}, \\varepsilon_{yy}, 2\\varepsilon_{xy}]^{\\mathsf{T}}$ is:\n$$\ne_h(\\xi, \\eta) = \\left[ \\frac{2a}{L}\\eta, \\, 0, \\, \\frac{2a}{L}\\xi \\right]^{\\mathsf{T}}\n$$\nEvaluating the strain vector at the element center $(\\xi, \\eta) = (0, 0)$:\n$$\ne_h(0, 0) = \\left[ \\frac{2a}{L}(0), \\, 0, \\, \\frac{2a}{L}(0) \\right]^{\\mathsf{T}} = [0, 0, 0]^{\\mathsf{T}} = \\boldsymbol{0}\n$$\nSince the strain vanishes at the center, the internal virtual work evaluated with one-point Gauss integration, which depends only on the values at the center, is zero. This confirms that $\\boldsymbol{u}_h$ is a null residual direction (an hourglass mode) for the under-integrated element.\n\nStep 2: Computation of the exact Galerkin strain energy $U_{\\mathrm{full}}(u_h)$.\n\nThe total strain energy is given by $U = \\frac{1}{2} \\int_{\\Omega} e^{\\mathsf{T}} \\mathbf{D} e \\, d\\Omega$. The differential area element is $d\\Omega = \\det \\mathbf{J} \\, d\\xi \\, d\\eta = \\frac{L^2}{4} d\\xi \\, d\\eta$.\nFirst, we compute the strain energy density term $e_h^{\\mathsf{T}} \\mathbf{D} e_h$:\n$$\ne_h^{\\mathsf{T}} \\mathbf{D} e_h = \\begin{bmatrix} \\frac{2a}{L}\\eta & 0 & \\frac{2a}{L}\\xi \\end{bmatrix} \\begin{bmatrix} \\lambda + 2 G & \\lambda & 0 \\\\ \\lambda & \\lambda + 2 G & 0 \\\\ 0 & 0 & G \\end{bmatrix} \\begin{bmatrix} \\frac{2a}{L}\\eta \\\\ 0 \\\\ \\frac{2a}{L}\\xi \\end{bmatrix}\n$$\n$$\ne_h^{\\mathsf{T}} \\mathbf{D} e_h = \\begin{bmatrix} \\frac{2a}{L}\\eta & 0 & \\frac{2a}{L}\\xi \\end{bmatrix} \\begin{bmatrix} (\\lambda + 2G)\\frac{2a}{L}\\eta \\\\ \\lambda\\frac{2a}{L}\\eta \\\\ G\\frac{2a}{L}\\xi \\end{bmatrix} = (\\lambda + 2G)\\left(\\frac{2a}{L}\\eta\\right)^2 + G\\left(\\frac{2a}{L}\\xi\\right)^2\n$$\n$$\ne_h^{\\mathsf{T}} \\mathbf{D} e_h = \\frac{4a^2}{L^2} \\left[ (\\lambda + 2G)\\eta^2 + G\\xi^2 \\right]\n$$\nNow, we integrate this density over the element domain to find the total energy $U_{\\mathrm{full}}(u_h)$. The problem asks for the energy using full $2 \\times 2$ Gauss integration. Since the integrand is quadratic in $\\xi$ and $\\eta$, this is equivalent to exact analytical integration over the parent element domain $[-1,1] \\times [-1,1]$.\n$$\nU_{\\mathrm{full}}(u_h) = \\frac{1}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\frac{4a^2}{L^2} \\left[ (\\lambda + 2G)\\eta^2 + G\\xi^2 \\right] \\right) \\left( \\frac{L^2}{4} \\right) d\\xi \\, d\\eta\n$$\n$$\nU_{\\mathrm{full}}(u_h) = \\frac{a^2}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\left[ (\\lambda + 2G)\\eta^2 + G\\xi^2 \\right] d\\xi \\, d\\eta\n$$\nWe evaluate the integrals:\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} \\eta^2 d\\xi \\, d\\eta = \\int_{-1}^{1} d\\xi \\int_{-1}^{1} \\eta^2 d\\eta = [\\xi]_{-1}^{1} \\left[\\frac{\\eta^3}{3}\\right]_{-1}^{1} = (2)\\left(\\frac{1}{3} - \\left(-\\frac{1}{3}\\right)\\right) = \\frac{4}{3}\n$$\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} \\xi^2 d\\xi \\, d\\eta = \\int_{-1}^{1} d\\eta \\int_{-1}^{1} \\xi^2 d\\xi = [\\eta]_{-1}^{1} \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = (2)\\left(\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\nSubstituting these results back into the energy expression:\n$$\nU_{\\mathrm{full}}(u_h) = \\frac{a^2}{2} \\left[ (\\lambda + 2G)\\frac{4}{3} + G\\frac{4}{3} \\right] = \\frac{a^2}{2} \\frac{4}{3} (\\lambda + 2G + G)\n$$\n$$\nU_{\\mathrm{full}}(u_h) = \\frac{2}{3} a^2 (\\lambda + 3G)\n$$\n\nStep 3: Determination of the stabilization coefficient $\\alpha$.\n\nThe stabilization energy functional is defined as:\n$$\nU_{\\mathrm{stab}}(u_{h}) = \\frac{1}{2} \\, \\alpha \\sum_{q=1}^{4} e_{h}(\\xi_{q},\\eta_{q})^{\\mathsf{T}} \\, \\mathbf{D} \\, e_{h}(\\xi_{q},\\eta_{q}) \\, \\det J\n$$\nThe summation is over the four Gauss points of the $2 \\times 2$ rule, which are $(\\xi_q, \\eta_q) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$. At each of these points, $\\xi_q^2 = 1/3$ and $\\eta_q^2 = 1/3$.\nLet's evaluate the summand at an arbitrary Gauss point $q$:\n$$\ne_{h}(\\xi_{q},\\eta_{q})^{\\mathsf{T}} \\, \\mathbf{D} \\, e_{h}(\\xi_{q},\\eta_{q}) = \\frac{4a^2}{L^2} \\left[ (\\lambda + 2G)\\eta_q^2 + G\\xi_q^2 \\right]\n$$\n$$\n= \\frac{4a^2}{L^2} \\left[ (\\lambda + 2G)\\frac{1}{3} + G\\frac{1}{3} \\right] = \\frac{4a^2}{3L^2} (\\lambda + 3G)\n$$\nThis value is constant for all four Gauss points. The term inside the summation is this quantity multiplied by $\\det J = L^2/4$:\n$$\n\\text{Summand} = \\left( \\frac{4a^2}{3L^2} (\\lambda + 3G) \\right) \\left( \\frac{L^2}{4} \\right) = \\frac{a^2}{3} (\\lambda + 3G)\n$$\nThe sum is over four identical terms:\n$$\n\\sum_{q=1}^{4} (\\dots) = 4 \\times \\frac{a^2}{3} (\\lambda + 3G)\n$$\nNow we compute the stabilization energy:\n$$\nU_{\\mathrm{stab}}(u_h) = \\frac{1}{2} \\alpha \\left( \\frac{4a^2}{3} (\\lambda + 3G) \\right) = \\frac{2}{3} \\alpha a^2 (\\lambda + 3G)\n$$\nThe calibration condition is $U_{\\mathrm{stab}}(u_h) = U_{\\mathrm{full}}(u_h)$.\n$$\n\\frac{2}{3} \\alpha a^2 (\\lambda + 3G) = \\frac{2}{3} a^2 (\\lambda + 3G)\n$$\nAssuming a non-trivial hourglass amplitude ($a \\neq 0$) and a physically realistic material ($\\lambda > 0$, $G > 0$, so $\\lambda + 3G \\neq 0$), we can cancel the common factors from both sides, which yields:\n$$\n\\alpha = 1\n$$\nThe stabilization parameter $\\alpha$ is a dimensionless value of $1$. This result indicates that the chosen form of the stabilization energy, when calibrated to match the exact energy of the hourglass mode, is precisely the energy contributed by the higher-order part of the strain field, which is correctly captured by the $2 \\times 2$ Gauss quadrature but missed by the single-point rule.", "answer": "$$\\boxed{1}$$", "id": "3610216"}]}