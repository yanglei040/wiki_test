{"hands_on_practices": [{"introduction": "This first exercise provides a foundational link between the abstract vector calculus operators and the core physical quantities of continuum mechanics. By starting with a given displacement field, you will compute the displacement gradient, $\\nabla \\mathbf{u}$, and decompose it into its symmetric (strain) and skew-symmetric (spin) parts. This practice will reinforce your understanding of how the divergence, $\\nabla \\cdot \\mathbf{u}$, quantifies volumetric change and how the curl, $\\nabla \\times \\mathbf{u}$, describes local material rotation, which are fundamental concepts in analyzing deformations [@problem_id:3568721].", "problem": "A homogeneous, isotropic solid body undergoes a small deformation described by the displacement field $\\mathbf{u}(\\mathbf{x}) = \\begin{bmatrix} \\alpha x^{2} \\\\ \\beta x y \\\\ \\gamma z \\end{bmatrix}$, where $\\alpha$, $\\beta$, and $\\gamma$ are real constants, and $\\mathbf{x} = (x,y,z)$ are Cartesian coordinates. Using the kinematics of the infinitesimal strain theory as the fundamental base, perform the following:\n\n1. Starting from the definition of the displacement gradient $\\nabla \\mathbf{u}$ in Cartesian coordinates and the additive decomposition of a second-order tensor into symmetric and skew-symmetric parts, derive explicit expressions for the displacement gradient $\\nabla \\mathbf{u}$, the infinitesimal strain tensor $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{T}\\right)$, and the infinitesimal spin tensor $\\boldsymbol{\\omega} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} - (\\nabla \\mathbf{u})^{T}\\right)$ as functions of $x$, $y$, $z$, $\\alpha$, $\\beta$, and $\\gamma$.\n\n2. Compute the divergence $\\nabla \\cdot \\mathbf{u}$ and the curl $\\nabla \\times \\mathbf{u}$, and verify from first principles that $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$ and that the axial (vector) representation of $\\boldsymbol{\\omega}$ equals $\\tfrac{1}{2}\\nabla \\times \\mathbf{u}$.\n\n3. Define the scalar invariant $S(x,y,z)$ by $S(x,y,z) := \\operatorname{tr}(\\boldsymbol{\\varepsilon}) + \\|\\boldsymbol{\\omega}_{\\text{ax}}\\|_{2}$, where $\\boldsymbol{\\omega}_{\\text{ax}}$ denotes the axial vector of $\\boldsymbol{\\omega}$ and $\\|\\cdot\\|_{2}$ is the Euclidean norm. Provide $S(x,y,z)$ in closed form as a function of $x$, $y$, $z$, $\\alpha$, $\\beta$, and $\\gamma$. Express the final result as a single analytic expression with no units.\n\nFinally, briefly comment on the spatial variation of the fields you computed and discuss the physical plausibility of the deformation under the small-strain hypothesis. The comment does not affect the grading of the calculation.\n\nYour final answer must be the single analytic expression for $S(x,y,z)$.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded within the established framework of infinitesimal strain theory in continuum mechanics. The problem is well-posed, objective, self-contained, and requires a standard, verifiable set of calculations based on the provided displacement field. All definitions and relationships are standard in the field.\n\nThe solution proceeds by following the three parts outlined in the problem statement.\n\nPart $1$: Derivation of the displacement gradient, strain tensor, and spin tensor.\n\nThe given displacement field is $\\mathbf{u}(\\mathbf{x}) = \\begin{pmatrix} u_x \\\\ u_y \\\\ u_z \\end{pmatrix} = \\begin{pmatrix} \\alpha x^{2} \\\\ \\beta x y \\\\ \\gamma z \\end{pmatrix}$.\nThe displacement gradient tensor, $\\nabla \\mathbf{u}$, is a second-order tensor whose components in Cartesian coordinates are given by $(\\nabla \\mathbf{u})_{ij} = \\frac{\\partial u_i}{\\partial x_j}$.\n\nThe components are calculated as follows:\n$(\\nabla \\mathbf{u})_{11} = \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial}{\\partial x}(\\alpha x^{2}) = 2\\alpha x$\n$(\\nabla \\mathbf{u})_{12} = \\frac{\\partial u_x}{\\partial y} = \\frac{\\partial}{\\partial y}(\\alpha x^{2}) = 0$\n$(\\nabla \\mathbf{u})_{13} = \\frac{\\partial u_x}{\\partial z} = \\frac{\\partial}{\\partial z}(\\alpha x^{2}) = 0$\n$(\\nabla \\mathbf{u})_{21} = \\frac{\\partial u_y}{\\partial x} = \\frac{\\partial}{\\partial x}(\\beta x y) = \\beta y$\n$(\\nabla \\mathbf{u})_{22} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial}{\\partial y}(\\beta x y) = \\beta x$\n$(\\nabla \\mathbf{u})_{23} = \\frac{\\partial u_y}{\\partial z} = \\frac{\\partial}{\\partial z}(\\beta x y) = 0$\n$(\\nabla \\mathbf{u})_{31} = \\frac{\\partial u_z}{\\partial x} = \\frac{\\partial}{\\partial x}(\\gamma z) = 0$\n$(\\nabla \\mathbf{u})_{32} = \\frac{\\partial u_z}{\\partial y} = \\frac{\\partial}{\\partial y}(\\gamma z) = 0$\n$(\\nabla \\mathbf{u})_{33} = \\frac{\\partial u_z}{\\partial z} = \\frac{\\partial}{\\partial z}(\\gamma z) = \\gamma$\n\nAssembling these components into a matrix gives the displacement gradient:\n$$ \\nabla \\mathbf{u} = \\begin{pmatrix} 2\\alpha x  0  0 \\\\ \\beta y  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} $$\nThe infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ is the symmetric part of $\\nabla \\mathbf{u}$:\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{T}\\right) = \\frac{1}{2}\\left( \\begin{pmatrix} 2\\alpha x  0  0 \\\\ \\beta y  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} + \\begin{pmatrix} 2\\alpha x  \\beta y  0 \\\\ 0  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} \\right) $$\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\begin{pmatrix} 4\\alpha x  \\beta y  0 \\\\ \\beta y  2\\beta x  0 \\\\ 0  0  2\\gamma \\end{pmatrix} = \\begin{pmatrix} 2\\alpha x  \\frac{1}{2}\\beta y  0 \\\\ \\frac{1}{2}\\beta y  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} $$\nThe infinitesimal spin tensor $\\boldsymbol{\\omega}$ is the skew-symmetric part of $\\nabla \\mathbf{u}$:\n$$ \\boldsymbol{\\omega} = \\frac{1}{2}\\left(\\nabla \\mathbf{u} - (\\nabla \\mathbf{u})^{T}\\right) = \\frac{1}{2}\\left( \\begin{pmatrix} 2\\alpha x  0  0 \\\\ \\beta y  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} - \\begin{pmatrix} 2\\alpha x  \\beta y  0 \\\\ 0  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} \\right) $$\n$$ \\boldsymbol{\\omega} = \\frac{1}{2} \\begin{pmatrix} 0  -\\beta y  0 \\\\ \\beta y  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\frac{1}{2}\\beta y  0 \\\\ \\frac{1}{2}\\beta y  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n\nPart $2$: Verification of continuum mechanics identities.\n\nFirst, compute the divergence of the displacement field, $\\nabla \\cdot \\mathbf{u}$:\n$$ \\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} + \\frac{\\partial u_z}{\\partial z} = 2\\alpha x + \\beta x + \\gamma = (2\\alpha + \\beta)x + \\gamma $$\nNext, compute the trace of the strain tensor, $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$:\n$$ \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33} = 2\\alpha x + \\beta x + \\gamma = (2\\alpha + \\beta)x + \\gamma $$\nComparing the two results, we verify that $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$.\n\nNext, compute the curl of the displacement field, $\\nabla \\times \\mathbf{u}$:\n$$ \\nabla \\times \\mathbf{u} = \\begin{vmatrix} \\mathbf{e}_x  \\mathbf{e}_y  \\mathbf{e}_z \\\\ \\frac{\\partial}{\\partial x}  \\frac{\\partial}{\\partial y}  \\frac{\\partial}{\\partial z} \\\\ \\alpha x^{2}  \\beta x y  \\gamma z \\end{vmatrix} = \\left(\\frac{\\partial(\\gamma z)}{\\partial y} - \\frac{\\partial(\\beta x y)}{\\partial z}\\right)\\mathbf{e}_x - \\left(\\frac{\\partial(\\gamma z)}{\\partial x} - \\frac{\\partial(\\alpha x^2)}{\\partial z}\\right)\\mathbf{e}_y + \\left(\\frac{\\partial(\\beta x y)}{\\partial x} - \\frac{\\partial(\\alpha x^2)}{\\partial y}\\right)\\mathbf{e}_z $$\n$$ \\nabla \\times \\mathbf{u} = (0 - 0)\\mathbf{e}_x - (0 - 0)\\mathbf{e}_y + (\\beta y - 0)\\mathbf{e}_z = \\beta y \\mathbf{e}_z = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\beta y \\end{pmatrix} $$\nThe axial vector $\\boldsymbol{\\omega}_{\\text{ax}}$ of the skew-symmetric tensor $\\boldsymbol{\\omega}$ has components $w_k = -\\frac{1}{2}\\epsilon_{ijk}\\omega_{ij}$, where $\\epsilon_{ijk}$ is the Levi-Civita symbol.\n$w_x = -\\frac{1}{2}(\\epsilon_{123}\\omega_{23} + \\epsilon_{132}\\omega_{32}) = -\\omega_{23} = 0$\n$w_y = -\\frac{1}{2}(\\epsilon_{213}\\omega_{13} + \\epsilon_{231}\\omega_{31}) = \\omega_{13} = 0$\n$w_z = -\\frac{1}{2}(\\epsilon_{312}\\omega_{12} + \\epsilon_{321}\\omega_{21}) = -\\omega_{12} = -(-\\frac{1}{2}\\beta y) = \\frac{1}{2}\\beta y$\nThus, the axial vector is $\\boldsymbol{\\omega}_{\\text{ax}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2}\\beta y \\end{pmatrix}$.\nWe are asked to verify that $\\boldsymbol{\\omega}_{\\text{ax}} = \\frac{1}{2}\\nabla \\times \\mathbf{u}$.\n$$ \\frac{1}{2}\\nabla \\times \\mathbf{u} = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\beta y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2}\\beta y \\end{pmatrix} $$\nThe identity $\\boldsymbol{\\omega}_{\\text{ax}} = \\frac{1}{2}\\nabla \\times \\mathbf{u}$ is thus explicitly verified for the given displacement field.\n\nPart $3$: Calculation of the scalar invariant $S(x,y,z)$.\n\nThe scalar invariant is defined as $S(x,y,z) := \\operatorname{tr}(\\boldsymbol{\\varepsilon}) + \\|\\boldsymbol{\\omega}_{\\text{ax}}\\|_{2}$.\nFrom Part $2$, we have $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = (2\\alpha + \\beta)x + \\gamma$.\nThe Euclidean norm of the axial vector $\\boldsymbol{\\omega}_{\\text{ax}}$ is:\n$$ \\|\\boldsymbol{\\omega}_{\\text{ax}}\\|_{2} = \\sqrt{w_x^2 + w_y^2 + w_z^2} = \\sqrt{0^2 + 0^2 + \\left(\\frac{1}{2}\\beta y\\right)^2} = \\sqrt{\\left(\\frac{1}{2}\\beta y\\right)^2} = \\left|\\frac{1}{2}\\beta y\\right| $$\nSubstituting these expressions into the definition of $S(x,y,z)$:\n$$ S(x,y,z) = (2\\alpha + \\beta)x + \\gamma + \\left|\\frac{1}{2}\\beta y\\right| $$\n\nBrief comment on spatial variation and plausibility:\nThe components of the strain tensor $\\boldsymbol{\\varepsilon}$ and spin tensor $\\boldsymbol{\\omega}$ are functions of the spatial coordinates $x$ and $y$, indicating a non-homogeneous deformation. The volumetric strain, $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$, varies linearly with $x$, implying that slices of the material at different $x$ coordinates expand or contract by different amounts. The local rotation, represented by $\\boldsymbol{\\omega}_{\\text{ax}}$, varies linearly with $y$ and is always directed along the $z$-axis.\nThe small-strain hypothesis requires that the magnitudes of the components of the displacement gradient tensor $\\nabla \\mathbf{u}$ are much less than $1$, i.e., $|\\nabla \\mathbf{u}_{ij}| \\ll 1$. Since components such as $(\\nabla \\mathbf{u})_{11}=2\\alpha x$ and $(\\nabla \\mathbf{u})_{21}=\\beta y$ grow linearly with the coordinates, this assumption can only hold true in a sufficiently small region around the origin $(0,0,0)$. This displacement field is therefore only physically tenable as a local approximation of a deformation in a small material neighborhood.", "answer": "$$\n\\boxed{(2\\alpha + \\beta)x + \\gamma + \\frac{1}{2}|\\beta y|}\n$$", "id": "3568721"}, {"introduction": "Real-world engineering problems often involve complex geometries that are not well-described by Cartesian coordinates. This practice extends the concept of divergence to general curvilinear coordinate systems, a necessary step for formulating physical laws like the balance of momentum in a coordinate-invariant manner. By deriving and applying the formula for the covariant divergence of a tensor using Christoffel symbols, you will gain hands-on experience with the mathematical machinery required for advanced computational solid mechanics [@problem_id:3568700].", "problem": "In computational solid mechanics, the balance of linear momentum is expressible through the divergence of the Cauchy stress tensor field. In curvilinear coordinates, the appropriate object is the covariant divergence of a second-order tensor field, constructed from the covariant derivative and the Christoffel symbols associated with the metric of the coordinate system.\n\nStarting from the definition of the covariant derivative of a second-order contravariant tensor field, derive the covariant divergence of a general symmetric tensor field $T^{i j}(x^{1}, x^{2}, x^{3})$ in a general curvilinear coordinate system with metric $g_{i j}(x^{1}, x^{2}, x^{3})$, where the Christoffel symbols are defined in terms of the metric by\n$$\n\\Gamma^{\\ell}_{i j} = \\frac{1}{2} g^{\\ell m} \\left( \\partial_{i} g_{j m} + \\partial_{j} g_{i m} - \\partial_{m} g_{i j} \\right),\n$$\nwith $g^{\\ell m}$ the inverse of $g_{\\ell m}$ and $\\partial_{i} \\equiv \\frac{\\partial}{\\partial x^{i}}$.\n\nThen, evaluate this covariant divergence for the orthogonal cylindrical coordinate system $(x^{1}, x^{2}, x^{3}) = (r, \\theta, z)$, whose metric is\n$$\ng_{i j} = \\mathrm{diag}(1, r^{2}, 1),\n$$\nfor the symmetric tensor field specified by the contravariant components\n$$\nT^{r r}(r,\\theta,z) = a r^{2}, \\quad T^{r \\theta}(r,\\theta,z) = T^{\\theta r}(r,\\theta,z) = b r, \\quad T^{r z}(r,\\theta,z) = T^{z r}(r,\\theta,z) = 0,\n$$\n$$\nT^{\\theta \\theta}(r,\\theta,z) = c, \\quad T^{\\theta z}(r,\\theta,z) = T^{z \\theta}(r,\\theta,z) = d r, \\quad T^{z z}(r,\\theta,z) = e r,\n$$\nwhere $a$, $b$, $c$, $d$, and $e$ are real constants.\n\nExpress your final answer as the components of the divergence vector $v^{i} = T^{i j}{}_{; j}$ in the coordinate order $(r, \\theta, z)$, written as a single row matrix. No numerical approximation or rounding is required, and no physical units are to be reported. Use the Einstein summation convention over repeated indices.", "solution": "The user wants to find the covariant divergence of a symmetric second-order contravariant tensor field in a general curvilinear coordinate system. Then, this general result is to be applied to a specific tensor in cylindrical coordinates.\n\nThe problem is self-contained, scientifically grounded in tensor calculus and continuum mechanics, and well-posed. All definitions, data, and conditions are provided and are consistent. Therefore, the problem is valid.\n\nThe covariant derivative of a second-order contravariant tensor field $T^{i j}$ with respect to the coordinate $x^{k}$ is given by:\n$$\nT^{i j}{}_{;k} = \\partial_{k} T^{i j} + \\Gamma^{i}_{lk} T^{l j} + \\Gamma^{j}_{lk} T^{i l}\n$$\nwhere $\\partial_k \\equiv \\frac{\\partial}{\\partial x^k}$ and $\\Gamma^{i}_{lk}$ are the Christoffel symbols of the second kind. The Einstein summation convention is implied for repeated indices.\n\nThe covariant divergence of the tensor field $T^{i j}$ is a vector field $v^i$ obtained by contracting the index of differentiation with one of the contravariant indices of the tensor. Let's contract on the second index, $j=k$:\n$$\nv^{i} = T^{i j}{}_{;j} = \\partial_{j} T^{i j} + \\Gamma^{i}_{lj} T^{l j} + \\Gamma^{j}_{lj} T^{i l}\n$$\nThis is the general expression for the covariant divergence of a second-order contravariant tensor field. The problem specifies that $T^{ij}$ is symmetric, i.e., $T^{ij} = T^{ji}$.\n\nNow, we evaluate this expression for the specified coordinate system and tensor field.\n\nThe coordinate system is orthogonal cylindrical coordinates, with $(x^{1}, x^{2}, x^{3}) = (r, \\theta, z)$.\nThe metric tensor is given by its covariant components:\n$$\ng_{i j} = \\begin{pmatrix} 1  0  0 \\\\ 0  r^{2}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe inverse metric tensor, with contravariant components $g^{ij}$, is:\n$$\ng^{i j} = \\begin{pmatrix} 1  0  0 \\\\ 0  r^{-2}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe only non-zero partial derivatives of the metric components with respect to the coordinates are:\n$$\n\\partial_{r} g_{\\theta \\theta} = \\partial_{1} g_{22} = \\frac{\\partial}{\\partial r}(r^{2}) = 2r\n$$\nThe Christoffel symbols are calculated using the formula:\n$$\n\\Gamma^{\\ell}_{i j} = \\frac{1}{2} g^{\\ell m} \\left( \\partial_{i} g_{j m} + \\partial_{j} g_{i m} - \\partial_{m} g_{i j} \\right)\n$$\nSince $g^{\\ell m}$ is diagonal, this simplifies to (no summation over $\\ell$):\n$$\n\\Gamma^{\\ell}_{i j} = \\frac{1}{2} g^{\\ell \\ell} \\left( \\partial_{i} g_{j \\ell} + \\partial_{j} g_{i \\ell} - \\partial_{\\ell} g_{i j} \\right)\n$$\nLet's compute the non-zero symbols:\n$$\n\\Gamma^{r}_{\\theta \\theta} = \\Gamma^{1}_{22} = \\frac{1}{2} g^{11} (\\partial_{2}g_{21} + \\partial_{2}g_{21} - \\partial_{1}g_{22}) = \\frac{1}{2} (1) (0 + 0 - 2r) = -r\n$$\n$$\n\\Gamma^{\\theta}_{r \\theta} = \\Gamma^{2}_{12} = \\frac{1}{2} g^{22} (\\partial_{1}g_{22} + \\partial_{2}g_{12} - \\partial_{2}g_{12}) = \\frac{1}{2} (r^{-2}) (2r + 0 - 0) = \\frac{1}{r}\n$$\nDue to the symmetry $\\Gamma^\\ell_{ij} = \\Gamma^\\ell_{ji}$, we also have $\\Gamma^{\\theta}_{\\theta r} = \\Gamma^{2}_{21} = \\frac{1}{r}$.\nAll other Christoffel symbols are zero.\n\nNow, we compute the components of the divergence vector $v^i = (v^r, v^\\theta, v^z)$.\n\n**Component $v^r$ ($i=1$):**\n$$\nv^{r} = \\partial_{j} T^{r j} + \\Gamma^{r}_{lj} T^{l j} + \\Gamma^{j}_{lj} T^{r l}\n$$\nExpanding the sums over $j, l \\in \\{r, \\theta, z\\}$:\n$$\nv^{r} = (\\partial_{r} T^{rr} + \\partial_{\\theta} T^{r\\theta} + \\partial_{z} T^{rz}) + (\\Gamma^{r}_{rr} T^{rr} + \\Gamma^{r}_{r\\theta} T^{r\\theta} + ... + \\Gamma^{r}_{\\theta \\theta} T^{\\theta \\theta} + ...) + (\\Gamma^{r}_{lr} T^{rl} + \\Gamma^{\\theta}_{l\\theta} T^{rl} + \\Gamma^{z}_{lz} T^{rl})\n$$\nLet's evaluate each part:\n1.  Partial derivatives: $\\partial_{r} (ar^{2}) + \\partial_{\\theta} (br) + \\partial_{z} (0) = 2ar + 0 + 0 = 2ar$.\n2.  First Christoffel term $\\Gamma^{r}_{lj} T^{lj}$: The only non-zero $\\Gamma^{r}_{..}$ is $\\Gamma^{r}_{\\theta\\theta}=-r$. So this term is $\\Gamma^{r}_{\\theta\\theta} T^{\\theta\\theta} = (-r)(c) = -cr$.\n3.  Second Christoffel term $\\Gamma^{j}_{lj} T^{rl}$: We sum over $j$ and $l$.\n    - For $j=r$: $\\Gamma^{r}_{lr}T^{rl} = \\Gamma^{r}_{rr}T^{rr} + \\Gamma^{r}_{\\theta r}T^{r\\theta} + \\Gamma^{r}_{zr}T^{rz} = 0$.\n    - For $j=\\theta$: $\\Gamma^{\\theta}_{l\\theta}T^{rl} = \\Gamma^{\\theta}_{r\\theta}T^{rr} + \\Gamma^{\\theta}_{\\theta\\theta}T^{r\\theta} + \\Gamma^{\\theta}_{z\\theta}T^{rz} = (\\frac{1}{r})(ar^{2}) + 0 + 0 = ar$.\n    - For $j=z$: $\\Gamma^{z}_{lz}T^{rl} = 0$.\n    This term is $ar$.\n\nCombining the parts: $v^{r} = 2ar - cr + ar = (3a-c)r$.\n\n**Component $v^\\theta$ ($i=2$):**\n$$\nv^{\\theta} = \\partial_{j} T^{\\theta j} + \\Gamma^{\\theta}_{lj} T^{l j} + \\Gamma^{j}_{lj} T^{\\theta l}\n$$\n1.  Partial derivatives: $\\partial_{r} T^{\\theta r} + \\partial_{\\theta} T^{\\theta\\theta} + \\partial_{z} T^{\\theta z} = \\partial_{r} (br) + \\partial_{\\theta} (c) + \\partial_{z} (dr) = b + 0 + 0 = b$.\n2.  First Christoffel term $\\Gamma^{\\theta}_{lj} T^{lj}$: The non-zero $\\Gamma^{\\theta}_{..}$ are $\\Gamma^{\\theta}_{r\\theta}=\\Gamma^{\\theta}_{\\theta r}=1/r$. This term is $\\Gamma^{\\theta}_{r\\theta} T^{r\\theta} + \\Gamma^{\\theta}_{\\theta r} T^{\\theta r} = (\\frac{1}{r})(br) + (\\frac{1}{r})(br) = b + b = 2b$.\n3.  Second Christoffel term $\\Gamma^{j}_{lj} T^{\\theta l}$:\n    - For $j=r$: $\\Gamma^{r}_{lr}T^{\\theta l} = 0$.\n    - For $j=\\theta$: $\\Gamma^{\\theta}_{l\\theta}T^{\\theta l} = \\Gamma^{\\theta}_{r\\theta}T^{\\theta r} + \\Gamma^{\\theta}_{\\theta\\theta}T^{\\theta\\theta} + \\Gamma^{\\theta}_{z\\theta}T^{\\theta z} = (\\frac{1}{r})(br) + 0 + 0 = b$.\n    - For $j=z$: $\\Gamma^{z}_{lz}T^{\\theta l} = 0$.\n    This term is $b$.\n\nCombining the parts: $v^{\\theta} = b + 2b + b = 4b$.\n\n**Component $v^z$ ($i=3$):**\n$$\nv^{z} = \\partial_{j} T^{z j} + \\Gamma^{z}_{lj} T^{l j} + \\Gamma^{j}_{lj} T^{z l}\n$$\n1.  Partial derivatives: $\\partial_{r} T^{zr} + \\partial_{\\theta} T^{z\\theta} + \\partial_{z} T^{zz} = \\partial_{r} (0) + \\partial_{\\theta} (dr) + \\partial_{z} (er) = 0 + 0 + 0 = 0$.\n2.  First Christoffel term $\\Gamma^{z}_{lj} T^{lj}$: All $\\Gamma^{z}_{..}$ are zero, so this term is $0$.\n3.  Second Christoffel term $\\Gamma^{j}_{lj} T^{zl}$:\n    - For $j=r$: $\\Gamma^{r}_{lr}T^{zl} = 0$.\n    - For $j=\\theta$: $\\Gamma^{\\theta}_{l\\theta}T^{zl} = \\Gamma^{\\theta}_{r\\theta}T^{zr} + \\Gamma^{\\theta}_{\\theta\\theta}T^{z\\theta} + \\Gamma^{\\theta}_{z\\theta}T^{zz}$. Since $T^{zr}=0$ and all other $\\Gamma$ symbols are zero, this term vanishes.\n    - For $j=z$: $\\Gamma^{z}_{lz}T^{zl} = 0$.\n    This term is $0$.\n\nCombining the parts: $v^{z} = 0 + 0 + 0 = 0$.\n\nThe components of the divergence vector $v^i$ in the order $(r, \\theta, z)$ are:\n$$\nv^{r} = (3a-c)r\n$$\n$$\nv^{\\theta} = 4b\n$$\n$$\nv^{z} = 0\n$$\n\nAs requested, the final answer is expressed as a single row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(3a-c)r  4b  0\n\\end{pmatrix}\n}\n$$", "id": "3568700"}, {"introduction": "This final exercise bridges the gap between continuous mathematical theory and discrete computational practice. You will explore the fundamental vector identity $\\nabla \\times \\nabla d = \\mathbf{0}$, which states that a gradient field is irrotational, and consider its implications in a numerical context. This problem demonstrates how a bedrock mathematical principle can be used as a powerful diagnostic tool to assess the consistency and accuracy of finite element approximations, revealing potential non-physical artifacts that can arise in simulations [@problem_id:3568747].", "problem": "Consider a gradient-damage regularization posed on a bounded open domain $\\Omega \\subset \\mathbb{R}^{3}$, where the damage field $d(\\mathbf{x})$ is treated as a non-dimensional scalar and is assumed sufficiently smooth. Let\n$$\nd(x,y,z) \\;=\\; \\alpha\\, x^{3}y^{2} \\;+\\; \\beta\\, x y z \\;+\\; \\gamma\\, \\sin(xy) \\;+\\; \\delta\\, \\cos(z),\n$$\nwith $\\alpha,\\beta,\\gamma,\\delta \\in \\mathbb{R}$ constants and $(x,y,z) \\in \\Omega$. You will investigate a consistency diagnostic relevant to computational implementations of gradient-damage models by analyzing the quantity $\\nabla \\times \\nabla d$.\n\nTasks:\n\n1. Starting strictly from the component-wise definitions of the gradient and the curl operators in $\\mathbb{R}^{3}$, compute $\\nabla \\times \\nabla d$ for the above $d(x,y,z)$. In your derivation, use only the equality of mixed second partial derivatives for sufficiently smooth functions as a fundamental fact. State the minimal smoothness assumptions on $d$ under which your simplification is valid.\n\n2. Define the scalar diagnostic\n$$\nJ \\;=\\; \\int_{\\Omega} \\left| \\nabla \\times \\nabla d(\\mathbf{x}) \\right|^{2} \\, \\mathrm{d}\\Omega.\n$$\nUsing your result from Task 1, evaluate $J$ exactly for the given $d(x,y,z)$ on any bounded $\\Omega$ and interpret the result physically for a consistent gradient-damage computation.\n\n3. Briefly explain how, in a finite element method (FEM) implementation with $C^{0}$ piecewise-linear interpolants for $d$ on a tetrahedral mesh, the classical (element-wise) evaluation of $\\nabla \\times \\nabla d_{h}$ might fail to reveal numerical artifacts, and indicate—using first principles—where nonzero contributions originate in the distributional sense.\n\nInstructions for the final numeric report: Treat all quantities as non-dimensional. Express the final value of $J$ as an exact number with no rounding. Provide no units for the final reported value.", "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- Domain: A bounded open domain $\\Omega \\subset \\mathbb{R}^{3}$.\n- Damage field: A non-dimensional scalar field $d(\\mathbf{x})$ assumed to be sufficiently smooth.\n- Functional form of the damage field: $d(x,y,z) = \\alpha\\, x^{3}y^{2} + \\beta\\, x y z + \\gamma\\, \\sin(xy) + \\delta\\, \\cos(z)$.\n- Constants: $\\alpha,\\beta,\\gamma,\\delta \\in \\mathbb{R}$.\n- Position vector: $(x,y,z) \\in \\Omega$.\n- Quantity to analyze: $\\nabla \\times \\nabla d$.\n- Scalar diagnostic: $J = \\int_{\\Omega} \\left| \\nabla \\times \\nabla d(\\mathbf{x}) \\right|^{2} \\, \\mathrm{d}\\Omega$.\n- Task 1: Compute $\\nabla \\times \\nabla d$ from component-wise definitions, using equality of mixed partials. State minimal smoothness assumptions.\n- Task 2: Evaluate $J$ and interpret the result.\n- Task 3: Explain the failure of classical element-wise evaluation of $\\nabla \\times \\nabla d_{h}$ in a $C^{0}$ FEM context and the origin of non-zero contributions in a distributional sense.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on fundamental principles of vector calculus, specifically the identity that the curl of the gradient of any sufficiently smooth scalar field is zero. It applies this concept to a relevant area in computational solid mechanics (gradient-damage models) and explores the implications for numerical methods (FEM). The concepts are standard and scientifically sound.\n- **Well-Posed**: The problem is clearly structured into three distinct tasks. The function $d(x,y,z)$ is explicitly given, and the quantities to be computed, $J$ and $\\nabla \\times \\nabla d$, are unambiguously defined. The third task asks for a conceptual explanation based on established principles of numerical analysis. A unique, meaningful solution exists for all parts.\n- **Objective**: The problem is stated using precise mathematical and technical language, free of any subjective or ambiguous terminology.\n- **Completeness and Consistency**: The problem provides all necessary information. The function $d(x,y,z)$ is well-defined. The operators $\\nabla$ and $\\nabla \\times$ are standard. There are no internal contradictions.\n- **Verdict**: The problem is valid. It is scientifically sound, well-posed, objective, and self-contained.\n\n### Task 1: Computation of $\\nabla \\times \\nabla d$\n\nThe gradient and curl operators in a Cartesian coordinate system $(x,y,z)$ are defined as:\n$$\n\\nabla f = \\frac{\\partial f}{\\partial x}\\hat{\\mathbf{i}} + \\frac{\\partial f}{\\partial y}\\hat{\\mathbf{j}} + \\frac{\\partial f}{\\partial z}\\hat{\\mathbf{k}}\n$$\n$$\n\\nabla \\times \\mathbf{F} = \\left( \\frac{\\partial F_z}{\\partial y} - \\frac{\\partial F_y}{\\partial z} \\right) \\hat{\\mathbf{i}} + \\left( \\frac{\\partial F_x}{\\partial z} - \\frac{\\partial F_z}{\\partial x} \\right) \\hat{\\mathbf{j}} + \\left( \\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y} \\right) \\hat{\\mathbf{k}}\n$$\nwhere $f$ is a scalar field and $\\mathbf{F} = F_x \\hat{\\mathbf{i}} + F_y \\hat{\\mathbf{j}} + F_z \\hat{\\mathbf{k}}$ is a vector field.\n\nWe are asked to compute $\\nabla \\times (\\nabla d)$. Let the vector field $\\mathbf{F}$ be the gradient of the scalar field $d$, i.e., $\\mathbf{F} = \\nabla d$. The components of $\\mathbf{F}$ are:\n$$\nF_x = \\frac{\\partial d}{\\partial x}, \\quad F_y = \\frac{\\partial d}{\\partial y}, \\quad F_z = \\frac{\\partial d}{\\partial z}\n$$\nSubstituting these into the definition of the curl, we obtain the general expression for the curl of a gradient:\n$$\n\\nabla \\times (\\nabla d) = \\left( \\frac{\\partial}{\\partial y}\\left(\\frac{\\partial d}{\\partial z}\\right) - \\frac{\\partial}{\\partial z}\\left(\\frac{\\partial d}{\\partial y}\\right) \\right) \\hat{\\mathbf{i}} + \\left( \\frac{\\partial}{\\partial z}\\left(\\frac{\\partial d}{\\partial x}\\right) - \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial d}{\\partial z}\\right) \\right) \\hat{\\mathbf{j}} + \\left( \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial d}{\\partial y}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{\\partial d}{\\partial x}\\right) \\right) \\hat{\\mathbf{k}}\n$$\nThis can be written using subscript notation for partial derivatives as:\n$$\n\\nabla \\times (\\nabla d) = (d_{zy} - d_{yz})\\hat{\\mathbf{i}} + (d_{xz} - d_{zx})\\hat{\\mathbf{j}} + (d_{yx} - d_{xy})\\hat{\\mathbf{k}}\n$$\nThe problem states to use the equality of mixed second partial derivatives for sufficiently smooth functions. This is Clairaut's theorem, which states that if a function $d$ has continuous second partial derivatives in a neighborhood of a point, then the order of differentiation does not matter, i.e., $\\frac{\\partial^2 d}{\\partial x_i \\partial x_j} = \\frac{\\partial^2 d}{\\partial x_j \\partial x_i}$. The minimal smoothness assumption for this theorem to hold is that the function $d$ must be of class $C^2$ (its second-order partial derivatives exist and are continuous).\n\nThe given damage field $d(x,y,z) = \\alpha\\, x^{3}y^{2} + \\beta\\, x y z + \\gamma\\, \\sin(xy) + \\delta\\, \\cos(z)$ is composed of polynomials and trigonometric functions sin and cos. These functions are infinitely differentiable ($C^{\\infty}$) over all of $\\mathbb{R}^3$. Thus, the function $d$ is of class $C^{\\infty}$, which is much smoother than the required $C^2$ condition.\n\nTherefore, for the given function $d$:\n$$\n\\frac{\\partial^2 d}{\\partial y \\partial z} = \\frac{\\partial^2 d}{\\partial z \\partial y}, \\quad \\frac{\\partial^2 d}{\\partial z \\partial x} = \\frac{\\partial^2 d}{\\partial x \\partial z}, \\quad \\frac{\\partial^2 d}{\\partial x \\partial y} = \\frac{\\partial^2 d}{\\partial y \\partial x}\n$$\nThis implies that each component of $\\nabla \\times (\\nabla d)$ is zero.\n$$\n\\nabla \\times (\\nabla d) = (0)\\hat{\\mathbf{i}} + (0)\\hat{\\mathbf{j}} + (0)\\hat{\\mathbf{k}} = \\mathbf{0}\n$$\nThis is a general result for any $C^2$ scalar field, often summarized by the vector identity $\\nabla \\times \\nabla d \\equiv \\mathbf{0}$. The computation for the specific $d(x,y,z)$ provided merely serves as a concrete verification of this identity.\n\nTo be explicit, let us compute the derivatives for the given $d$:\nFirst, the gradient $\\nabla d$:\n$$\n\\frac{\\partial d}{\\partial x} = 3\\alpha x^2 y^2 + \\beta y z + \\gamma y \\cos(xy)\n$$\n$$\n\\frac{\\partial d}{\\partial y} = 2\\alpha x^3 y + \\beta x z + \\gamma x \\cos(xy)\n$$\n$$\n\\frac{\\partial d}{\\partial z} = \\beta x y - \\delta \\sin(z)\n$$\nNow, the mixed second partial derivatives for the z-component of the curl:\n$$\n\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial d}{\\partial y}\\right) = \\frac{\\partial}{\\partial x}(2\\alpha x^3 y + \\beta x z + \\gamma x \\cos(xy)) = 6\\alpha x^2 y + \\beta z + \\gamma \\cos(xy) - \\gamma xy \\sin(xy)\n$$\n$$\n\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial d}{\\partial x}\\right) = \\frac{\\partial}{\\partial y}(3\\alpha x^2 y^2 + \\beta y z + \\gamma y \\cos(xy)) = 6\\alpha x^2 y + \\beta z + \\gamma \\cos(xy) - \\gamma xy \\sin(xy)\n$$\nThese are equal, so the z-component is zero. The equality of the other pairs of mixed partials follows similarly.\n\n### Task 2: Evaluation and Interpretation of $J$\n\nThe scalar diagnostic is defined as:\n$$\nJ = \\int_{\\Omega} \\left| \\nabla \\times \\nabla d(\\mathbf{x}) \\right|^{2} \\, \\mathrm{d}\\Omega\n$$\nFrom the result of Task 1, we established that for the given sufficiently smooth scalar field $d(x,y,z)$, the quantity $\\nabla \\times \\nabla d$ is identically the zero vector, $\\mathbf{0}$.\n$$\n\\nabla \\times \\nabla d(\\mathbf{x}) = \\mathbf{0} \\quad \\forall \\mathbf{x} \\in \\Omega\n$$\nSubstituting this into the definition of $J$:\n$$\nJ = \\int_{\\Omega} |\\mathbf{0}|^{2} \\, \\mathrm{d}\\Omega = \\int_{\\Omega} 0 \\, \\mathrm{d}\\Omega\n$$\nThe integral of zero over any bounded domain $\\Omega$ is zero.\n$$\nJ = 0\n$$\nPhysical Interpretation: The identity $\\nabla \\times \\nabla d = \\mathbf{0}$ means that any vector field that can be expressed as the gradient of a scalar potential (a conservative field) is irrotational (has zero curl). In the context of continuum mechanics, this is a fundamental consistency condition. The integral $J$ represents the total squared magnitude of the \"inconsistency\" over the domain $\\Omega$. A value of $J=0$ indicates perfect consistency. In a computational implementation, differential operators are approximated. Due to discretization error, the numerical approximation of the curl of the numerical gradient, $\\nabla_h \\times \\nabla_h d_h$, may not be exactly zero. Therefore, $J$ serves as a powerful diagnostic tool: a non-zero value of $J$ in a simulation indicates that the numerical scheme fails to preserve this fundamental vector identity and signals a loss of consistency in the computation. A robust numerical method for gradient-damage models should ensure that $J$ is zero, or at least approaches zero under mesh refinement at an appropriate rate.\n\n### Task 3: Finite Element Method (FEM) Implementation\n\nIn an FEM implementation with $C^0$ piecewise-linear interpolants for the damage field $d$ on a tetrahedral mesh, the discrete approximation is denoted $d_h(\\mathbf{x})$.\n1.  **$C^0$ Continuity and Piecewise Linearity**: $C^0$ continuity means the function $d_h$ is continuous across the faces of adjacent tetrahedra, but its derivatives (i.e., its gradient) are not guaranteed to be continuous. Within a single tetrahedron (element $e$), a linear interpolant has the form $d_h(\\mathbf{x}) = a_e + b_e x + c_e y + f_e z$, where the coefficients are constant for that element.\n2.  **Element-wise Gradient**: The gradient of $d_h$ within an element $e$ is $\\nabla d_h(\\mathbf{x}) = b_e \\hat{\\mathbf{i}} + c_e \\hat{\\mathbf{j}} + f_e \\hat{\\mathbf{k}}$. This is a constant vector field within each element.\n3.  **Classical Element-wise Curl**: The curl of any constant vector field is identically zero. Therefore, if one computes $\\nabla \\times (\\nabla d_h)$ by applying the curl operator *inside* each element, the result is $\\mathbf{0}$ everywhere within the interior of all elements. This is the \"classical (element-wise) evaluation\" mentioned in the problem. This evaluation is misleading because it completely misses the behavior at the element interfaces and would erroneously suggest perfect consistency ($J=0$).\n4.  **Distributional Origin of Non-zero Contributions**: The field $\\nabla d_h$ is a *piecewise-constant* vector field. It is constant within each tetrahedron but typically has a jump discontinuity across the shared faces of adjacent tetrahedra. The theory of distributions provides the framework for differentiating such functions. The derivative of a function with a jump discontinuity contains a Dirac delta function supported on the surface of the jump.\n5.  **Curl in the Distributional Sense**: Let's consider a face $S_{ij}$ with unit normal $\\mathbf{n}$ shared by two elements, $e_i$ and $e_j$. The gradient vectors in these elements are constant but different: $\\mathbf{g}_i = (\\nabla d_h)|_{e_i}$ and $\\mathbf{g}_j = (\\nabla d_h)|_{e_j}$. The jump in the gradient across the face is $[\\![\\nabla d_h]\\!] = \\mathbf{g}_j - \\mathbf{g}_i$. The curl of the discontinuous field $\\nabla d_h$ is not zero in the distributional sense. It contains a singular part that is concentrated on the mesh faces. This singular part can be expressed (using a generalized Stokes' theorem) as:\n$$\n(\\nabla \\times \\nabla d_h)_{\\text{singular}} = \\sum_{\\text{faces } S_{ij}} (\\mathbf{n} \\times [\\![\\nabla d_h]\\!])_S \\delta_S\n$$\nwhere $\\delta_S$ is a surface Dirac delta distribution. The term $\\mathbf{n} \\times [\\![\\nabla d_h]\\!]$ represents the jump in the tangential component of the gradient field across the face.\n6.  **Conclusion**: The non-zero contributions to the true, distributional $\\nabla \\times \\nabla d_h$ originate from the jump discontinuities of the gradient field $\\nabla d_h$ at the inter-element faces. An element-wise evaluation is blind to this, as it only sees the constant (and thus curl-free) field inside the elements. The failure of $C^0$ elements to enforce continuity of the gradient is what creates this numerical artifact, leading to a non-zero value of $J$ if it were computed correctly in a way that accounts for these inter-element contributions. This is a primary motivation for using higher-order elements or mixed finite element methods in problems where gradient or curl conformity is crucial.", "answer": "$$\n\\boxed{0}\n$$", "id": "3568747"}]}