{"hands_on_practices": [{"introduction": "To understand and model isotropic material response, we must dissect how a material behaves under different types of distortion. This exercise, [@problem_id:3605131], provides a hands-on guide to computationally isolating the effects of the second and third deviatoric invariants, $J_2$ and $J_3$, by constructing specialized stress paths in principal stress space. Mastering this technique is crucial for developing robust calibration procedures for advanced constitutive models.", "problem": "You are given a symmetric second-order tensor $A \\in \\mathbb{R}^{3 \\times 3}$ representing a generic stress-like quantity. Let $I$ denote the second-order identity tensor. Let the first invariant be $I_1 = \\operatorname{tr}(A)$ and the deviator be $A' = A - \\tfrac{1}{3} I_1 I$. Consider isotropic scalar functions of the deviator, i.e., scalar functions $g(A')$ that remain unchanged under any orthogonal change of basis. Define the deviatoric invariants $J_2 = \\tfrac{1}{2} A' : A'$ and $J_3 = \\det(A')$. Your task is to implement a computational procedure that constructs stress paths in principal space that isolate these deviatoric invariants for calibration, and to evaluate an example isotropic scalar function along these paths.\n\nBase definitions and requirements:\n- Invariance under orthogonal transformations is stated as follows: for any orthogonal tensor $Q$ with $Q^T Q = I$, an isotropic scalar function $g$ satisfies $g(Q A' Q^T) = g(A')$.\n- The invariants of $A'$ are $J_2 = \\tfrac{1}{2} A' : A'$ and $J_3 = \\det(A')$.\n- Principal-value representations are to be used for constructing the calibration paths.\n\nDesign three calibration paths in the principal basis (where $A$ is diagonal):\n\n$1.$ $J_2$-isolation path $\\mathcal{S}_2$: Choose a scalar $t \\in \\mathbb{R}$ and define principal deviatoric values by $s_1 = t$, $s_2 = -t$, $s_3 = 0$, so that $A' = \\operatorname{diag}(t,-t,0)$ and $I_1 = 0$. This path should vary $J_2$ while keeping $J_3$ equal to $0$.\n\n$2.$ $J_3$-isolation path $\\mathcal{S}_3$: Fix a radius $\\rho > 0$ and parameterize the principal deviatoric values on the standard Haigh–Westergaard $\\pi$-plane circle by an angle $\\theta$ (angles in radians) as\n$$\ns_1 = \\frac{2}{\\sqrt{6}} \\, \\rho \\, \\cos(\\theta), \\quad\ns_2 = \\frac{2}{\\sqrt{6}} \\, \\rho \\, \\cos\\!\\left(\\theta - \\frac{2\\pi}{3}\\right), \\quad\ns_3 = \\frac{2}{\\sqrt{6}} \\, \\rho \\, \\cos\\!\\left(\\theta + \\frac{2\\pi}{3}\\right),\n$$\nwith $A' = \\operatorname{diag}(s_1,s_2,s_3)$ and $I_1 = 0$. This path keeps $J_2$ constant while varying $J_3$ through the Lode angle $\\theta$.\n\n$3.$ Hydrostatic path $\\mathcal{H}$: Choose a scalar $p \\in \\mathbb{R}$ and set $A = p I$, so that $A' = 0$ and therefore $J_2 = 0$ and $J_3 = 0$. This provides a boundary check.\n\nDefine an isotropic scalar function $g$ of the deviator by\n$$\ng(A') = c_0 + c_1 \\sqrt{J_2} + c_2 \\, (J_3)^2,\n$$\nwith constants $c_0 = 0$, $c_1 = 2$, $c_2 = \\tfrac{1}{2}$. This $g$ depends only on the invariants and thus is isotropic.\n\nNumerical test suite:\n- Use the following parameter values (angles in radians):\n  - For $\\mathcal{S}_2$: $t \\in \\{\\, 0, \\, 1.5, \\, -2 \\,\\}$.\n  - For $\\mathcal{S}_3$: $\\rho = 2$ and $\\theta \\in \\{\\, 0, \\, \\tfrac{\\pi}{12}, \\, \\tfrac{\\pi}{6} \\,\\}$.\n  - For $\\mathcal{H}$: $p \\in \\{\\, 0, \\, 1 \\,\\}$.\n- For numerical checks, use an absolute tolerance $\\varepsilon = 10^{-10}$.\n\nComputational tasks for your program:\n- Implement routines to compute $I_1$, $A'$, $J_2$, and $J_3$ for any symmetric $A$.\n- Construct the principal-diagonal forms for the three paths using the test suite parameters.\n- For each $t$ in $\\mathcal{S}_2$, compute $J_2$ and $J_3$, and return the boolean value of the check $\\lvert J_3 \\rvert \\le \\varepsilon$.\n- For each $\\theta$ in $\\mathcal{S}_3$, compute $J_2$ and $J_3$, and return the boolean value of the check $\\lvert J_2 - J_{2,\\mathrm{ref}} \\rvert \\le \\varepsilon$, where $J_{2,\\mathrm{ref}} = \\rho^2 / 2$.\n- For each $p$ in $\\mathcal{H}$, verify $J_2 = 0$ and $J_3 = 0$ within tolerance and return both booleans.\n- Evaluate $g$ at three representative states:\n  - $g$ on $\\mathcal{S}_2$ at $t = 1.5$,\n  - $g$ on $\\mathcal{S}_3$ at $\\rho = 2$, $\\theta = \\tfrac{\\pi}{12}$,\n  - $g$ on $\\mathcal{H}$ at $p = 0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order:\n  $[\n  J_2(\\mathcal{S}_2,t\\!=\\!0), \\,\n  J_3(\\mathcal{S}_2,t\\!=\\!0), \\,\n  \\text{iso-}J_3(\\mathcal{S}_2,t\\!=\\!0), \\,\n  J_2(\\mathcal{S}_2,t\\!=\\!1.5), \\,\n  J_3(\\mathcal{S}_2,t\\!=\\!1.5), \\,\n  \\text{iso-}J_3(\\mathcal{S}_2,t\\!=\\!1.5), \\,\n  J_2(\\mathcal{S}_2,t\\!=\\!-2), \\,\n  J_3(\\mathcal{S}_2,t\\!=\\!-2), \\,\n  \\text{iso-}J_3(\\mathcal{S}_2,t\\!=\\!-2), \\,\n  J_2(\\mathcal{S}_3,\\theta\\!=\\!0), \\,\n  J_3(\\mathcal{S}_3,\\theta\\!=\\!0), \\,\n  \\text{const-}J_2(\\mathcal{S}_3,\\theta\\!=\\!0), \\,\n  J_2(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{12}), \\,\n  J_3(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{12}), \\,\n  \\text{const-}J_2(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{12}), \\,\n  J_2(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{6}), \\,\n  J_3(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{6}), \\,\n  \\text{const-}J_2(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{6}), \\,\n  J_2(\\mathcal{H},p\\!=\\!0)\\!=\\!0, \\,\n  J_3(\\mathcal{H},p\\!=\\!0)\\!=\\!0, \\,\n  J_2(\\mathcal{H},p\\!=\\!1)\\!=\\!0, \\,\n  J_3(\\mathcal{H},p\\!=\\!1)\\!=\\!0, \\,\n  g(\\mathcal{S}_2,t\\!=\\!1.5), \\,\n  g(\\mathcal{S}_3,\\theta\\!=\\!\\tfrac{\\pi}{12}), \\,\n  g(\\mathcal{H},p\\!=\\!0)\n  ]$.\n- All numerical outputs are dimensionless floats or booleans.\n- Angles must be treated in radians.", "solution": "The problem statement has been rigorously validated and is determined to be scientifically grounded, well-posed, and self-contained. The definitions, parameters, and computational tasks conform to established principles of computational solid mechanics and tensor analysis. We may therefore proceed with the solution.\n\nThe core of this problem is the analysis of isotropic scalar functions of a symmetric second-order tensor, which are fundamental in the formulation of constitutive models for isotropic materials. An isotropic function depends on the tensor only through its invariants. For a stress-like tensor $A \\in \\mathbb{R}^{3 \\times 3}$, it is convenient to decompose it into its hydrostatic and deviatoric parts. The deviatoric part, $A'$, captures the distortion or change in shape. Its invariants, particularly $J_2$ and $J_3$, are crucial for describing material behavior under different loading conditions.\n\nFirst, we define the necessary computational routines for an arbitrary symmetric tensor $A$.\nThe first invariant of $A$ is its trace:\n$$I_1 = \\operatorname{tr}(A) = \\sum_{i=1}^{3} A_{ii}$$\nThe deviatoric part of $A$, denoted $A'$, is defined as:\n$$A' = A - \\frac{1}{3} I_1 I$$\nwhere $I$ is the $3 \\times 3$ identity tensor. By construction, the trace of $A'$ is always zero: $\\operatorname{tr}(A') = \\operatorname{tr}(A) - \\frac{1}{3} I_1 \\operatorname{tr}(I) = I_1 - \\frac{1}{3} I_1 (3) = 0$.\n\nThe principal invariants of the deviatoric tensor $A'$ are $J_2$ and $J_3$.\n$J_2$ is a measure of the magnitude of the deviatoric tensor:\n$$J_2 = \\frac{1}{2} A' : A' = \\frac{1}{2} \\operatorname{tr}(A' A'^T) = \\frac{1}{2} \\sum_{i=1}^{3} \\sum_{j=1}^{3} A'_{ij} A'_{ij}$$\nFor a diagonal tensor $A' = \\operatorname{diag}(s_1, s_2, s_3)$, this simplifies to $J_2 = \\frac{1}{2} (s_1^2 + s_2^2 + s_3^2)$.\n$J_3$ is the determinant of the deviatoric tensor:\n$$J_3 = \\det(A')$$\nFor a diagonal tensor $A' = \\operatorname{diag}(s_1, s_2, s_3)$, this is $J_3 = s_1 s_2 s_3$.\n\nNow we analyze the three specified calibration paths in the principal basis.\n\n**1. $J_2$-isolation path $\\mathcal{S}_2$**\nThis path is defined by a deviatoric tensor whose principal values are $(s_1, s_2, s_3) = (t, -t, 0)$ for a scalar parameter $t$. The tensor is $A' = \\operatorname{diag}(t, -t, 0)$.\nThe invariants are:\n$$J_2 = \\frac{1}{2} (t^2 + (-t)^2 + 0^2) = \\frac{1}{2} (2 t^2) = t^2$$\n$$J_3 = (t)(-t)(0) = 0$$\nThis path isolates the effect of $J_2$ (by varying $t$) while keeping $J_3$ fixed at $0$.\nFor the test suite $t \\in \\{0, 1.5, -2\\}$:\n- For $t=0$: $A'=\\operatorname{diag}(0,0,0)$, so $J_2 = 0^2 = 0$ and $J_3 = 0$. The check $|J_3| \\le \\varepsilon$ is true.\n- For $t=1.5$: $J_2 = (1.5)^2 = 2.25$ and $J_3 = 0$. The check $|J_3| \\le \\varepsilon$ is true.\n- For $t=-2$: $J_2 = (-2)^2 = 4$ and $J_3 = 0$. The check $|J_3| \\le \\varepsilon$ is true.\n\n**2. $J_3$-isolation path $\\mathcal{S}_3$**\nThis path is defined on the $\\pi$-plane in Haigh–Westergaard space. For a fixed radius $\\rho > 0$ and angle $\\theta$, the principal deviatoric values are:\n$$s_1 = \\frac{2}{\\sqrt{6}} \\rho \\cos(\\theta), \\quad s_2 = \\frac{2}{\\sqrt{6}} \\rho \\cos(\\theta - \\frac{2\\pi}{3}), \\quad s_3 = \\frac{2}{\\sqrt{6}} \\rho \\cos(\\theta + \\frac{2\\pi}{3})$$\nLet's verify the properties of this path. The sum of principal values is $s_1+s_2+s_3 = 0$ due to trigonometric identities, confirming the tensor is deviatoric.\nFor $J_2$:\n$$J_2 = \\frac{1}{2} \\sum s_i^2 = \\frac{1}{2} \\left(\\frac{4\\rho^2}{6}\\right) \\left[ \\cos^2\\theta + \\cos^2(\\theta - \\tfrac{2\\pi}{3}) + \\cos^2(\\theta + \\tfrac{2\\pi}{3}) \\right]$$\nUsing the identity $\\cos^2\\alpha + \\cos^2(\\alpha - \\tfrac{2\\pi}{3}) + \\cos^2(\\alpha + \\tfrac{2\\pi}{3}) = \\frac{3}{2}$, we get:\n$$J_2 = \\frac{1}{2} \\left(\\frac{2\\rho^2}{3}\\right) \\left( \\frac{3}{2} \\right) = \\frac{\\rho^2}{2}$$\nThis confirms that $J_2$ is constant along this path, determined solely by $\\rho$. The reference value is correctly given as $J_{2,\\mathrm{ref}} = \\rho^2 / 2$.\nFor the test case $\\rho=2$, we have $J_{2,\\mathrm{ref}} = 2^2/2 = 2$.\nFor $J_3$:\n$$J_3 = s_1 s_2 s_3 = \\left(\\frac{2\\rho}{\\sqrt{6}}\\right)^3 \\cos\\theta \\cos(\\theta - \\tfrac{2\\pi}{3}) \\cos(\\theta + \\tfrac{2\\pi}{3})$$\nUsing the identity $\\cos\\alpha \\cos(\\alpha - \\tfrac{2\\pi}{3}) \\cos(\\alpha + \\tfrac{2\\pi}{3}) = \\frac{1}{4} \\cos(3\\alpha)$, we have:\n$$J_3 = \\left(\\frac{8\\rho^3}{6\\sqrt{6}}\\right) \\frac{1}{4} \\cos(3\\theta) = \\frac{\\rho^3}{3\\sqrt{6}} \\cos(3\\theta)$$\n$J_3$ varies with the Lode angle $\\theta$.\nFor test suite $\\rho=2$ and $\\theta \\in \\{0, \\pi/12, \\pi/6\\}$:\n- For $\\theta=0$: $J_2=2$. $J_3 = \\frac{2^3}{3\\sqrt{6}} \\cos(0) = \\frac{8}{3\\sqrt{6}} = \\frac{8\\sqrt{6}}{18} = \\frac{4\\sqrt{6}}{9} \\approx 0.54433$. The check $|J_2 - 2| \\le \\varepsilon$ is true.\n- For $\\theta=\\pi/12$: $J_2=2$. $J_3 = \\frac{8}{3\\sqrt{6}} \\cos(3\\pi/12) = \\frac{8}{3\\sqrt{6}} \\cos(\\pi/4) = \\frac{8}{3\\sqrt{6}} \\frac{\\sqrt{2}}{2} = \\frac{4\\sqrt{2}}{3\\sqrt{6}} = \\frac{4\\sqrt{12}}{18} = \\frac{8\\sqrt{3}}{18} = \\frac{4\\sqrt{3}}{9} \\approx 0.38490$. The check $|J_2 - 2| \\le \\varepsilon$ is true.\n- For $\\theta=\\pi/6$: $J_2=2$. $J_3 = \\frac{8}{3\\sqrt{6}} \\cos(3\\pi/6) = \\frac{8}{3\\sqrt{6}} \\cos(\\pi/2) = 0$. The check $|J_2 - 2| \\le \\varepsilon$ is true.\n\n**3. Hydrostatic path $\\mathcal{H}$**\nThis path is defined by a purely hydrostatic tensor $A = p I$, where $p$ is the hydrostatic pressure.\nThe first invariant is $I_1 = \\operatorname{tr}(pI) = 3p$.\nThe deviatoric tensor is $A' = A - \\frac{1}{3} I_1 I = pI - \\frac{1}{3}(3p)I = pI - pI = 0$.\nSince $A'$ is the zero tensor, its invariants are identically zero: $J_2 = 0$ and $J_3 = 0$. This holds for any $p$.\nFor the test suite $p \\in \\{0, 1\\}$:\n- For $p=0$: $A'$ is the zero tensor, so $J_2=0, J_3=0$. The checks $|J_2| \\le \\varepsilon$ and $|J_3| \\le \\varepsilon$ are both true.\n- For $p=1$: $A'$ is the zero tensor, so $J_2=0, J_3=0$. The checks $|J_2| \\le \\varepsilon$ and $|J_3| \\le \\varepsilon$ are both true.\n\n**Evaluation of the isotropic scalar function $g(A')$**\nThe function is given by $g(A') = c_0 + c_1 \\sqrt{J_2} + c_2 (J_3)^2$, with $c_0=0, c_1=2, c_2=0.5$.\nSo, $g(A') = 2\\sqrt{J_2} + 0.5 (J_3)^2$. We evaluate this at three specified states:\n- On $\\mathcal{S}_2$ at $t=1.5$: Here, $J_2 = (1.5)^2 = 2.25$ and $J_3 = 0$.\n  $g = 2\\sqrt{2.25} + 0.5(0)^2 = 2(1.5) = 3$.\n- On $\\mathcal{S}_3$ at $\\rho=2, \\theta=\\pi/12$: Here, $J_2 = 2$ and $J_3 = \\frac{4\\sqrt{3}}{9}$.\n  $g = 2\\sqrt{2} + 0.5 \\left(\\frac{4\\sqrt{3}}{9}\\right)^2 = 2\\sqrt{2} + 0.5 \\left(\\frac{16 \\cdot 3}{81}\\right) = 2\\sqrt{2} + \\frac{24}{81} = 2\\sqrt{2} + \\frac{8}{27}$.\n  $g \\approx 2(1.41421356) + 0.296296... \\approx 2.82842712 + 0.296296... \\approx 3.12472342$. Wait, my scratchpad calculation was wrong. $0.5 * (12/81)$ is $6/81=2/27 \\approx 0.074$. Let's re-calculate $J_3$ from my scratchpad: $J_3 = \\frac{2\\sqrt{3}}{9}$. That was also wrong. $J_3 = \\frac{4\\sqrt{3}}{9}$ as written here. No, let's re-verify from first principles:\n  $J_3 = \\frac{\\rho^3}{3\\sqrt{6}}\\cos(3\\theta) \\rightarrow \\frac{2^3}{3\\sqrt{6}}\\cos(3\\pi/12) = \\frac{8}{3\\sqrt{6}}\\frac{\\sqrt{2}}{2} = \\frac{4\\sqrt{2}}{3\\sqrt{6}} = \\frac{4\\sqrt{12}}{18} = \\frac{8\\sqrt{3}}{18} = \\frac{4\\sqrt{3}}{9}$.\n  $g = 2\\sqrt{2} + 0.5 (\\frac{4\\sqrt{3}}{9})^2 = 2\\sqrt{2} + 0.5 (\\frac{16 \\times 3}{81}) = 2\\sqrt{2} + 0.5(\\frac{48}{81}) = 2\\sqrt{2} + \\frac{24}{81} = 2\\sqrt{2} + \\frac{8}{27} \\approx 2.828427 + 0.296296 = 3.124723$.\n  Checking the scratchpad again. $J_3 = \\frac{2\\sqrt{3}}{9}$ came from $\\frac{\\sqrt{12}}{9}$. But $\\sqrt{12} = 2\\sqrt{3}$. So that was correct. Where did the $4\\sqrt{3}/9$ come from?\n  $s_1 = \\frac{4}{\\sqrt{6}}\\cos(\\pi/12)$, $s_2 = \\frac{4}{\\sqrt{6}}\\cos(\\pi/12-2\\pi/3) = \\frac{4}{\\sqrt{6}}\\cos(-7\\pi/12)$, $s_3 = \\frac{4}{\\sqrt{6}}\\cos(\\pi/12+2\\pi/3) = \\frac{4}{\\sqrt{6}}\\cos(9\\pi/12) = \\frac{4}{\\sqrt{6}}\\cos(3\\pi/4)$.\n  $\\cos(\\pi/12) = \\frac{\\sqrt{6}+\\sqrt{2}}{4}$.\n  $\\cos(-7\\pi/12) = \\cos(7\\pi/12) = \\frac{\\sqrt{2}-\\sqrt{6}}{4}$.\n  $\\cos(3\\pi/4) = -\\frac{\\sqrt{2}}{2}$.\n  $J_3 = s_1 s_2 s_3 = (\\frac{4}{\\sqrt{6}})^3 (\\frac{\\sqrt{6}+\\sqrt{2}}{4}) (\\frac{\\sqrt{2}-\\sqrt{6}}{4}) (-\\frac{\\sqrt{2}}{2}) = (\\frac{64}{6\\sqrt{6}}) (\\frac{2-6}{16}) (-\\frac{\\sqrt{2}}{2}) = (\\frac{32}{3\\sqrt{6}}) (\\frac{-4}{16}) (-\\frac{\\sqrt{2}}{2}) =  (\\frac{32}{3\\sqrt{6}}) (\\frac{-1}{4}) (-\\frac{\\sqrt{2}}{2}) = (\\frac{32}{3\\sqrt{6}}) (\\frac{\\sqrt{2}}{8}) = \\frac{4\\sqrt{2}}{3\\sqrt{6}} = \\frac{4\\sqrt{12}}{18} = \\frac{8\\sqrt{3}}{18} = \\frac{4\\sqrt{3}}{9}$.\n  The formula $J_3 = \\frac{\\rho^3}{3\\sqrt{6}}\\cos(3\\theta)$ is incorrect.\n  The identity is $\\cos\\alpha \\cos(\\alpha - \\phi)\\cos(\\alpha + \\phi) = \\frac{1}{4}(\\cos(3\\alpha-\\phi) + \\cos(\\phi))$ for $\\phi=0$, not general $\\phi$.\n  The identity $\\cos x \\cos y \\cos z$ with $x+y+z=0$ is not standard. Let's use $\\cos\\theta \\cos(\\theta-2\\pi/3)\\cos(\\theta+2\\pi/3)=\\frac{1}{4}\\cos(3\\theta)$.\n  Let's check this popular identity. For $\\theta=0$, $\\cos(0)\\cos(-2\\pi/3)\\cos(2\\pi/3) = 1(-\\frac{1}{2})(-\\frac{1}{2}) = \\frac{1}{4}$. RHS is $\\frac{1}{4}\\cos(0)=\\frac{1}{4}$. Correct.\n  For $\\theta=\\pi/6$, $\\cos(\\pi/6)\\cos(-3\\pi/6)\\cos(5\\pi/6) = \\cos(\\pi/6)\\cos(-\\pi/2)\\cos(5\\pi/6) = 0$. RHS is $\\frac{1}{4}\\cos(3\\pi/6)=\\frac{1}{4}\\cos(\\pi/2)=0$. Correct.\n  The identity is correct.\n  So $J_3 = (\\frac{2\\rho}{\\sqrt{6}})^3 \\frac{1}{4}\\cos(3\\theta) = \\frac{8\\rho^3}{6\\sqrt{6}} \\frac{1}{4}\\cos(3\\theta) = \\frac{2\\rho^3}{6\\sqrt{6}}\\cos(3\\theta) = \\frac{\\rho^3}{3\\sqrt{6}}\\cos(3\\theta)$. This formula is correct. What was wrong?\n  Ah, $\\rho=2$. $J_3 = \\frac{2^3}{3\\sqrt{6}}\\cos(3\\theta) = \\frac{8}{3\\sqrt{6}}\\cos(3\\theta)$.\n  At $\\theta=\\pi/12$, $J_3 = \\frac{8}{3\\sqrt{6}}\\cos(\\pi/4) = \\frac{8}{3\\sqrt{6}}\\frac{\\sqrt{2}}{2} = \\frac{4\\sqrt{2}}{3\\sqrt{6}} = \\frac{4\\sqrt{12}}{18} = \\frac{8\\sqrt{3}}{18} = \\frac{4\\sqrt{3}}{9}$.\n  Okay, $J_3 = \\frac{4\\sqrt{3}}{9} \\approx 0.7698$. My previous scratchpad value was wrong.\n  $g = 2\\sqrt{2} + 0.5(\\frac{4\\sqrt{3}}{9})^2 = 2\\sqrt{2} + 0.5(\\frac{16 \\cdot 3}{81}) = 2\\sqrt{2} + \\frac{24}{81} = 2\\sqrt{2} + \\frac{8}{27}$.\n  $g \\approx 2(1.41421356) + 0.296296... \\approx 3.1247234...$. This is the correct calculation. My scratchpad had errors.\n  Re-checking the $J_2$ check for $\\mathcal{S}_3$ with $\\rho=2$, my scratchpad and first derivation said $J_2 = \\rho^2/2 = 2$. This has to be correct.\n  `const-J2(S3,theta=pi/12)` should evaluate to `True`. Let's re-check the $J_3$ from scratchpad again, maybe I confused myself.\n  $J_3 = \\frac{2\\sqrt{6}}{9}\\cos(3\\theta)$ for $\\rho=2$.\n  $\\rho^3 / (3\\sqrt{6}) = 8 / (3\\sqrt{6})$.\n  The scratchpad formula was $J_3 = \\frac{2\\sqrt{6}}{9}\\cos(3\\theta)$.\n  My formula is $J_3 = \\frac{8}{3\\sqrt{6}}\\cos(3\\theta) = \\frac{8\\sqrt{6}}{18}\\cos(3\\theta) = \\frac{4\\sqrt{6}}{9}\\cos(3\\theta)$. My scratchpad was off by factor of 2.\n  So $J_3(\\theta=0) = \\frac{4\\sqrt{6}}{9} \\approx 1.08866$.\n  $J_3(\\theta=\\pi/12) = \\frac{4\\sqrt{6}}{9}\\cos(\\pi/4) = \\frac{4\\sqrt{6}}{9}\\frac{\\sqrt{2}}{2} = \\frac{2\\sqrt{12}}{9} = \\frac{4\\sqrt{3}}{9} \\approx 0.7698$.\n  $J_3(\\theta=\\pi/6) = 0$.\n  So $g = 2\\sqrt{2} + 0.5 (\\frac{4\\sqrt{3}}{9})^2$ is correct.\n- On $\\mathcal{H}$ at $p=0$: Here, $J_2 = 0$ and $J_3 = 0$.\n  $g = 2\\sqrt{0} + 0.5(0)^2 = 0$.\n\nLet's re-summarize the final numerical values for the implementation, using the corrected $J_3$ findings.\n$c_0=0, c_1=2, c_2=0.5, \\rho=2, \\varepsilon=10^{-10}$.\n\n- Path $\\mathcal{S}_2$ values:\n  - $t=0$: $J_2=0.0$, $J_3=0.0$, check=True\n  - $t=1.5$: $J_2=2.25$, $J_3=0.0$, check=True\n  - $t=-2$: $J_2=4.0$, $J_3=0.0$, check=True\n- Path $\\mathcal{S}_3$ values ($\\rho=2$, so $J_{2,\\text{ref}}=2.0$):\n  - $\\theta=0$: $J_2=2.0$, $J_3 \\approx 1.0886621079$, check=True\n  - $\\theta=\\pi/12$: $J_2=2.0$, $J_3 \\approx 0.7698003589$, check=True\n  - $\\theta=\\pi/6$: $J_2=2.0$, $J_3=0.0$, check=True\n- Path $\\mathcal{H}$ values:\n  - $p=0$: check $J_2=0$ is True, check $J_3=0$ is True\n  - $p=1$: check $J_2=0$ is True, check $J_3=0$ is True\n- Function $g$ values:\n  - $g(\\mathcal{S}_2, t=1.5) = 3.0$\n  - $g(\\mathcal{S}_3, \\theta=\\pi/12) = 2\\sqrt{2} + 8/27 \\approx 3.1247234188$\n  - $g(\\mathcal{H}, p=0) = 0.0$\n\nThe solution logic is now confirmed. The implementation will follow this refined calculation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to perform the computational tasks specified in the problem.\n    \"\"\"\n    \n    # Define constants and tolerance\n    c0 = 0.0\n    c1 = 2.0\n    c2 = 0.5\n    epsilon = 1e-10\n\n    # Helper functions for tensor invariants\n    def compute_I1(A):\n        \"\"\"Computes the first invariant (trace) of a tensor A.\"\"\"\n        return np.trace(A)\n\n    def compute_A_prime(A):\n        \"\"\"Computes the deviatoric part of a tensor A.\"\"\"\n        I1 = compute_I1(A)\n        return A - (I1 / 3.0) * np.identity(3)\n\n    def compute_J2(A_prime):\n        \"\"\"Computes the second deviatoric invariant J2.\"\"\"\n        # J2 = 0.5 * A_prime : A_prime = 0.5 * tr(A_prime . A_prime)\n        # For diagonal matrix, this is 0.5 * sum(diag^2)\n        if A_prime.ndim == 1: # Passed as principal values\n            return 0.5 * np.sum(A_prime**2)\n        return 0.5 * np.sum(A_prime * A_prime) # Frobenius inner product\n\n    def compute_J3(A_prime):\n        \"\"\"Computes the third deviatoric invariant J3.\"\"\"\n        if A_prime.ndim == 1: # Passed as principal values\n            return np.prod(A_prime)\n        return np.linalg.det(A_prime)\n\n    def evaluate_g(J2, J3):\n        \"\"\"Evaluates the isotropic scalar function g.\"\"\"\n        return c0 + c1 * np.sqrt(J2) + c2 * (J3**2)\n\n    results = []\n\n    # 1. Path S2: J2-isolation\n    t_values = [0.0, 1.5, -2.0]\n    for t in t_values:\n        # A_prime in principal basis is diag(t, -t, 0)\n        s = np.array([t, -t, 0.0])\n        J2 = compute_J2(s)\n        J3 = compute_J3(s)\n        is_J3_iso = np.abs(J3) <= epsilon\n        \n        results.extend([J2, J3, is_J3_iso])\n\n    # 2. Path S3: J3-isolation\n    rho = 2.0\n    theta_values = [0.0, np.pi/12, np.pi/6]\n    J2_ref = rho**2 / 2.0\n    \n    for theta in theta_values:\n        s1 = (2.0 / np.sqrt(6.0)) * rho * np.cos(theta)\n        s2 = (2.0 / np.sqrt(6.0)) * rho * np.cos(theta - 2.0 * np.pi / 3.0)\n        s3 = (2.0 / np.sqrt(6.0)) * rho * np.cos(theta + 2.0 * np.pi / 3.0)\n        s = np.array([s1, s2, s3])\n        \n        J2 = compute_J2(s)\n        J3 = compute_J3(s)\n        is_J2_const = np.abs(J2 - J2_ref) <= epsilon\n        \n        results.extend([J2, J3, is_J2_const])\n\n    # 3. Path H: Hydrostatic\n    p_values = [0.0, 1.0]\n    for p in p_values:\n        A = p * np.identity(3)\n        A_prime = compute_A_prime(A)\n        J2 = compute_J2(A_prime)\n        J3 = compute_J3(A_prime)\n        \n        is_J2_zero = np.abs(J2) <= epsilon\n        is_J3_zero = np.abs(J3) <= epsilon\n        results.extend([is_J2_zero, is_J3_zero])\n\n    # 4. Evaluate g at specific states\n    # g on S2 at t = 1.5\n    s_s2 = np.array([1.5, -1.5, 0.0])\n    J2_s2 = compute_J2(s_s2)\n    J3_s2 = compute_J3(s_s2)\n    g_s2 = evaluate_g(J2_s2, J3_s2)\n    \n    # g on S3 at rho = 2, theta = pi/12\n    rho_g = 2.0\n    theta_g = np.pi/12\n    s1_g = (2.0 / np.sqrt(6.0)) * rho_g * np.cos(theta_g)\n    s2_g = (2.0 / np.sqrt(6.0)) * rho_g * np.cos(theta_g - 2.0 * np.pi / 3.0)\n    s3_g = (2.0 / np.sqrt(6.0)) * rho_g * np.cos(theta_g + 2.0 * np.pi / 3.0)\n    s_s3 = np.array([s1_g, s2_g, s3_g])\n    J2_s3 = compute_J2(s_s3)\n    J3_s3 = compute_J3(s_s3)\n    g_s3 = evaluate_g(J2_s3, J3_s3)\n    \n    # g on H at p = 0\n    A_h = 0.0 * np.identity(3)\n    A_prime_h = compute_A_prime(A_h)\n    J2_h = compute_J2(A_prime_h)\n    J3_h = compute_J3(A_prime_h)\n    g_h = evaluate_g(J2_h, J3_h)\n    \n    results.extend([g_s2, g_s3, g_h])\n\n    # Final print statement in the exact required format\n    # Convert booleans to lowercase 'true'/'false' for output\n    formatted_results = [str(r).lower() if isinstance(r, bool) else str(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3605131"}, {"introduction": "Building upon the analysis of invariants, this practice [@problem_id:3605161] challenges you to construct and verify a complete isotropic plastic yield surface, a cornerstone of modern plasticity theory. You will implement a criterion that depends on mean stress $p$ and the deviatoric invariants $J_2$ and $J_3$, and then design numerical experiments to test its pressure sensitivity and Lode angle dependence. This exercise bridges the gap between abstract tensor theory and its practical application in predicting material failure.", "problem": "You are tasked with designing, analyzing, and testing an isotropic plastic yield surface for a solid mechanics model using fundamental tensor invariants. The formulation must depend only on scalar invariants of the Cauchy stress tensor to ensure isotropy, and the tests must explicitly check hydrostatic-shift behavior and sensitivity to the third invariant via paths that traverse the Lode angle. All stresses shall be specified in megapascal (MPa), all angles in radians, and all outputs from the yield function shall be dimensionless.\n\nFundamental base and definitions:\n- Let the Cauchy stress tensor be denoted by $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{3 \\times 3}$.\n- The mean stress (pressure) is defined as $p = \\dfrac{\\operatorname{tr}(\\boldsymbol{\\sigma})}{3}$.\n- The deviatoric stress tensor is defined as $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity tensor.\n- The second invariant of the deviatoric stress is $J_2 = \\dfrac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$.\n- The third invariant of the deviatoric stress is $J_3 = \\det(\\boldsymbol{s})$.\n- The Lode angle $\\theta \\in \\left[-\\dfrac{\\pi}{6},\\dfrac{\\pi}{6}\\right]$ is defined implicitly by the relation\n$$\n\\cos(3\\theta) = \\dfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}},\n$$\nwith appropriate numerical clipping to $[-1,1]$ for robustness, and $\\theta = \\dfrac{1}{3}\\arccos\\left(\\dfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}}\\right)$ for $J_2 > 0$. For $J_2 = 0$, define $\\theta = 0$ as a conventional limiting value.\n\nYou must formulate the following isotropic yield function:\n$$\nF(J_2, J_3, p) = \\dfrac{\\sqrt{J_2}}{\\kappa(p)} \\left(1 + \\beta \\cos(3\\theta)\\right) - 1,\n$$\nwhere $\\kappa(p) = k_0 + k_1 p$, with the constants $k_0 = 60$ MPa, $k_1 = 0.01$ (dimensionless), and the Lode dependence parameter $\\beta \\in \\mathbb{R}$. This $F$ is required to be expressed in terms of the invariants $J_2$, $J_3$, and $p$ only.\n\nTasks:\n1. Implement robust numerical functions to compute $p$, $\\boldsymbol{s}$, $J_2$, $J_3$, and $\\theta$ for any given $3 \\times 3$ stress tensor $\\boldsymbol{\\sigma}$ in MPa, using the definitions above. Compute $\\cos(3\\theta)$ from the invariants using the formula provided and ensure numerical clipping to $[-1,1]$ before applying $\\arccos(\\cdot)$.\n2. Implement the yield function $F(J_2, J_3, p)$ with the constants $k_0 = 60$ MPa and $k_1 = 0.01$, evaluated for two cases of $\\beta$: $\\beta = 0.3$ and $\\beta = 0$.\n3. Demonstrate equivalence under hydrostatic shifts: construct two stress states $\\boldsymbol{\\sigma}_a$ and $\\boldsymbol{\\sigma}_b$ that differ only by a hydrostatic shift, i.e., $\\boldsymbol{\\sigma}_b = \\boldsymbol{\\sigma}_a + \\Delta p \\boldsymbol{I}$ for a specified $\\Delta p$. Show numerically that $J_2(\\boldsymbol{\\sigma}_a) = J_2(\\boldsymbol{\\sigma}_b)$, $J_3(\\boldsymbol{\\sigma}_a) = J_3(\\boldsymbol{\\sigma}_b)$, and $\\cos(3\\theta(\\boldsymbol{\\sigma}_a)) = \\cos(3\\theta(\\boldsymbol{\\sigma}_b))$ within a tolerance of $10^{-10}$, and report the difference $F(\\boldsymbol{\\sigma}_b) - F(\\boldsymbol{\\sigma}_a)$ for $\\beta = 0.3$.\n4. Test identification of $J_3$ sensitivity via synthetic stress paths that circle around the Lode angle: for fixed $p$ and fixed $J_2$, construct a set of deviatoric principal stresses $\\{s_1, s_2, s_3\\}$ parametrized by $\\theta \\in [-\\pi/6, \\pi/6]$ such that $\\operatorname{tr}(\\boldsymbol{s}) = 0$ and $J_2$ is held constant. Use the parametrization\n$$\ns_1(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos(\\theta), \\quad s_2(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos\\left(\\theta - \\dfrac{2\\pi}{3}\\right), \\quad s_3(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos\\left(\\theta + \\dfrac{2\\pi}{3}\\right),\n$$\nwhere $R = \\sqrt{2 J_2}$. Compose $\\boldsymbol{\\sigma}(\\theta) = p \\boldsymbol{I} + \\operatorname{diag}(s_1(\\theta), s_2(\\theta), s_3(\\theta))$. Evaluate $F$ along this path for both $\\beta = 0.3$ and $\\beta = 0$, and report the amplitude (maximum minus minimum) of $F$ across the path for each $\\beta$. Conclude whether the path reveals $J_3$ sensitivity by checking if the amplitude is positive for $\\beta = 0.3$ and approximately zero (within $10^{-10}$) for $\\beta = 0$.\n5. Evaluate the yield function for a purely hydrostatic stress state ($J_2 = 0$) and for a general non-hydrostatic stress state.\n\nUse the following explicit test suite of stress states, parameters, and path values (all stresses in MPa, angles in radians):\n- Hydrostatic-shift test:\n  - Base deviatoric principal stresses: $s_1 = 10$, $s_2 = -5$, $s_3 = -5$ (so $\\operatorname{tr}(\\boldsymbol{s}) = 0$).\n  - Base mean stress: $p_a = 30$.\n  - Shift: $\\Delta p = 50$.\n  - Define $\\boldsymbol{\\sigma}_a = p_a \\boldsymbol{I} + \\operatorname{diag}(10, -5, -5)$ and $\\boldsymbol{\\sigma}_b = (p_a + \\Delta p)\\boldsymbol{I} + \\operatorname{diag}(10, -5, -5)$.\n  - Tolerance for equality checks: $10^{-10}$.\n- Lode-angle path:\n  - Fixed mean stress $p = 30$.\n  - Fixed $J_2 = 1600$.\n  - Path angles: $\\theta \\in \\{-\\dfrac{\\pi}{6}, -\\dfrac{\\pi}{9}, -\\dfrac{\\pi}{12}, -\\dfrac{\\pi}{18}, 0, \\dfrac{\\pi}{18}, \\dfrac{\\pi}{12}, \\dfrac{\\pi}{9}, \\dfrac{\\pi}{6}\\}$.\n  - Evaluate amplitudes for $\\beta = 0.3$ and for $\\beta = 0$.\n- Pure hydrostatic state:\n  - $\\boldsymbol{\\sigma}_h = 50 \\boldsymbol{I}$ (i.e., $p = 50$, $J_2 = 0$).\n- General non-hydrostatic state:\n  - $\\boldsymbol{\\sigma}_g = \\begin{bmatrix} 120 & 15 & -10 \\\\ 15 & 80 & 5 \\\\ -10 & 5 & 100 \\end{bmatrix}$.\n\nYour program must:\n- Implement the invariant calculations and the yield function as specified.\n- Apply the test suite in the order provided and compute the following outputs:\n  1. For the hydrostatic-shift test on $\\boldsymbol{\\sigma}_a$ and $\\boldsymbol{\\sigma}_b$ with $\\beta = 0.3$: three booleans indicating equality of $J_2$, $J_3$, and $\\cos(3\\theta)$ (each within the tolerance $10^{-10}$), followed by the float difference $F(\\boldsymbol{\\sigma}_b) - F(\\boldsymbol{\\sigma}_a)$.\n  2. For the Lode-angle path: the float amplitude of $F$ across the path for $\\beta = 0.3$, the float amplitude for $\\beta = 0$, a boolean indicating the nonzero amplitude for $\\beta = 0.3$, and a boolean indicating the near-zero amplitude for $\\beta = 0$ within $10^{-10}$.\n  3. The float $F(\\boldsymbol{\\sigma}_h)$ for the purely hydrostatic state with $\\beta = 0.3$.\n  4. The float $F(\\boldsymbol{\\sigma}_g)$ for the general state with $\\beta = 0.3$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), in the exact order described above. This output list must therefore contain $10$ entries: $3$ booleans and $1$ float from the hydrostatic-shift test, $2$ floats and $2$ booleans from the Lode-angle path, and $2$ floats from the hydrostatic and general states, respectively.", "solution": "The user has provided a problem in computational solid mechanics concerning the implementation and verification of an isotropic plastic yield surface. I will first validate the problem statement to ensure its correctness and solvability before proceeding.\n\n### Step 1: Extract Givens\n\n- **Cauchy Stress Tensor**: $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{3 \\times 3}$.\n- **Mean Stress (Pressure)**: $p = \\dfrac{\\operatorname{tr}(\\boldsymbol{\\sigma})}{3}$.\n- **Deviatoric Stress Tensor**: $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity tensor.\n- **Second Deviatoric Stress Invariant**: $J_2 = \\dfrac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$.\n- **Third Deviatoric Stress Invariant**: $J_3 = \\det(\\boldsymbol{s})$.\n- **Lode Angle ($\\theta$)**: Defined by $\\cos(3\\theta) = \\dfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}}$, with $\\theta \\in \\left[-\\dfrac{\\pi}{6},\\dfrac{\\pi}{6}\\right]$. For computation, $\\theta = \\dfrac{1}{3}\\arccos\\left(\\dfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}}\\right)$ for $J_2 > 0$ after clipping the argument of arccos to $[-1,1]$, and $\\theta = 0$ for $J_2=0$.\n- **Yield Function ($F$)**: $F(J_2, J_3, p) = \\dfrac{\\sqrt{J_2}}{\\kappa(p)} \\left(1 + \\beta \\cos(3\\theta)\\right) - 1$.\n- **Hardening Function ($\\kappa$)**: $\\kappa(p) = k_0 + k_1 p$.\n- **Constants**: $k_0 = 60$ MPa, $k_1 = 0.01$ (dimensionless), parameter $\\beta \\in \\{0.3, 0\\}$.\n- **Tasks**:\n  1. Implement robust numerical functions for invariants and the yield function.\n  2. Implement the yield function for $\\beta = 0.3$ and $\\beta = 0$.\n  3. Perform a hydrostatic-shift test.\n  4. Perform a Lode-angle path test.\n  5. Evaluate the yield function for specific stress states.\n- **Test Suite**:\n  - **Hydrostatic-shift test**: Base deviatoric principal stresses $s_1=10, s_2=-5, s_3=-5$; base mean stress $p_a=30$; shift $\\Delta p=50$. Tolerance $10^{-10}$. Use $\\beta=0.3$.\n  - **Lode-angle path**: Fixed $p=30$, fixed $J_2=1600$. Path angles $\\theta \\in \\{-\\dfrac{\\pi}{6}, -\\dfrac{\\pi}{9}, -\\dfrac{\\pi}{12}, -\\dfrac{\\pi}{18}, 0, \\dfrac{\\pi}{18}, \\dfrac{\\pi}{12}, \\dfrac{\\pi}{9}, \\dfrac{\\pi}{6}\\}$. Path parametrization: $s_1(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos(\\theta)$, $s_2(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos\\left(\\theta - \\dfrac{2\\pi}{3}\\right)$, $s_3(\\theta) = \\dfrac{2}{\\sqrt{6}} R \\cos\\left(\\theta + \\dfrac{2\\pi}{3}\\right)$, where $R = \\sqrt{2 J_2}$.\n  - **Pure hydrostatic state**: $\\boldsymbol{\\sigma}_h = 50 \\boldsymbol{I}$.\n  - **General non-hydrostatic state**: $\\boldsymbol{\\sigma}_g = \\begin{bmatrix} 120 & 15 & -10 \\\\ 15 & 80 & 5 \\\\ -10 & 5 & 100 \\end{bmatrix}$.\n\n- **Required Output**: A list of $10$ specific results in a predefined order.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientific Grounding**: The problem is firmly rooted in the classical theory of plasticity within continuum mechanics. The definitions of stress invariants ($p$, $J_2$, $J_3$), Lode angle ($\\theta$), and the general form of the isotropic yield function $F(p, J_2, J_3)$ are standard. The provided yield function is a specific instance of a pressure-sensitive model with Lode-angle dependence, a well-established class of models. The stress path parametrization for the Lode angle test correctly isolates the effect of the third invariant $J_3$ by keeping $p$ and $J_2$ constant. The problem is scientifically sound.\n- **Well-Posedness**: All necessary definitions, constants, and test cases are explicitly provided. The computational tasks are unambiguous and lead to a unique set of numerical results. The special case of hydrostatic stress ($J_2=0$), where the definition of the Lode angle becomes indeterminate, is handled by a stated convention ($\\theta = 0$), ensuring the problem is well-posed everywhere.\n- **Objectivity**: The problem is stated in precise, formal mathematical and engineering language, free of any subjectivity or ambiguity.\n- **Completeness and Consistency**: The problem is self-contained. All data and definitions required for the solution are provided. There are no internal contradictions. For example, the units are consistent: $k_0$ and $p$ in MPa, $k_1$ dimensionless, lead to $\\kappa$ in MPa. $\\sqrt{J_2}$ is in MPa, so the ratio $\\sqrt{J_2}/\\kappa$ is dimensionless, making the entire yield function $F$ dimensionless as required.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. It is scientifically grounded, well-posed, and complete. I will proceed with the solution.\n\n### Principle-Based Design\n\nThe solution will be structured into a series of functions, each representing a key physical or mathematical concept. This modular design enhances clarity and correctness.\n\n1.  **`compute_invariants(sigma)` Function**: This core function encapsulates the fundamental principles of tensor decomposition and invariants.\n    -   Given a Cauchy stress tensor $\\boldsymbol{\\sigma}$, it first computes the volumetric part of the stress, represented by the mean stress or pressure $p = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$. This isolates the hydrostatic component.\n    -   Next, it computes the deviatoric stress tensor $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\boldsymbol{I}$, which represents the shear (shape-changing) part of the stress state. By definition, $\\operatorname{tr}(\\boldsymbol{s}) = 0$.\n    -   It then calculates the principal scalar invariants of the deviatoric stress tensor, $J_2$ and $J_3$.\n        -   $J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$ is a measure of the magnitude of the deviatoric stress. The double-dot product $\\boldsymbol{s}:\\boldsymbol{s}$ is the sum of the squares of the components of $\\boldsymbol{s}$.\n        -   $J_3 = \\det(\\boldsymbol{s})$ is related to the third principal invariant of $\\boldsymbol{s}$ and characterizes the type of shear state.\n    -   Finally, it computes $\\cos(3\\theta)$, a measure related to the Lode angle, directly from the invariants. The formula $\\cos(3\\theta) = \\frac{3\\sqrt{3}}{2} \\frac{J_3}{J_2^{3/2}}$ is used. A critical numerical robustness step is included: if $J_2$ is close to zero (hydrostatic state), $\\cos(3\\theta)$ is set to $1$ by convention, as $J_3$ will also be zero. The argument to the expression is also clipped to the valid range $[-1, 1]$ to prevent domain errors in potential inverse trigonometric function calls, although the yield function itself only requires $\\cos(3\\theta)$, not $\\theta$.\n\n2.  **`yield_function(p, J2, cos3theta, beta, k0, k1)` Function**: This function implements the specific constitutive model for the yield surface.\n    -   Its inputs are the scalar invariants ($p, J2, \\cos(3\\theta)$) and material parameters ($\\beta, k0, k1$), reflecting the principle of isotropy (dependence only on invariants).\n    -   It first computes the pressure-dependent cohesion term $\\kappa(p) = k_0 + k_1 p$. This linear function models the increase (or decrease) in shear strength with hydrostatic pressure, characteristic of materials like soils, rocks, and polymers.\n    -   It then evaluates the yield criterion $F = \\frac{\\sqrt{J_2}}{\\kappa(p)} (1 + \\beta \\cos(3\\theta)) - 1$.\n        -   The term $\\sqrt{J_2}$ represents a measure of equivalent shear stress.\n        -   The term $(1 + \\beta \\cos(3\\theta))$ introduces sensitivity to the third invariant, making the yield surface shape in the deviatoric plane (the \"$\\pi$-plane\") non-circular. When $\\beta=0$, this dependence vanishes, and the model reduces to a Lode-angle-independent form like the Drucker-Prager criterion.\n        -   The function returns a dimensionless value: $F < 0$ implies an elastic state, $F = 0$ implies a state on the yield surface (plastic yielding), and $F > 0$ represents a mathematically non-admissible stress state.\n\n3.  **Test Procedures**: The subsequent parts of the code are designed as specific numerical experiments to verify the physical and mathematical properties of the implemented model.\n    -   **Hydrostatic-Shift Test**: This test verifies a fundamental property of the deviatoric invariants $J_2$ and $J_3$. Adding a purely hydrostatic stress ($\\Delta p \\boldsymbol{I}$) to a stress tensor $\\boldsymbol{\\sigma}$ only shifts its volumetric component $p$, leaving the deviatoric component $\\boldsymbol{s}$ unchanged. Consequently, $J_2$ and $J_3$ must remain invariant. The test confirms this numerically. It also demonstrates how the yield function value $F$ changes due to the pressure dependence of $\\kappa(p)$.\n    -   **Lode-Angle Path Test**: This test is designed to probe the sensitivity of the yield function to the third invariant, $J_3$. By constructing a stress path where $p$ and $J_2$ are held constant while the Lode angle $\\theta$ varies, we isolate the effect of the term $\\beta \\cos(3\\theta)$. The test computes the amplitude of variation in $F$ along this path. For $\\beta \\neq 0$, the amplitude should be non-zero, confirming $J_3$ sensitivity. For $\\beta = 0$, the amplitude must be zero (within numerical tolerance), confirming the model's reduction to a $J_3$-independent form.\n    -   **Specific State Evaluations**: Finally, the function is evaluated for a purely hydrostatic state ($\\boldsymbol{s}=\\mathbf{0}$, hence $J_2=0$) and a general, non-diagonal stress state to ensure the implementation is robust and correct for various inputs. For the hydrostatic case, $F$ must evaluate to $-1$, as $\\sqrt{J_2}=0$.\n\nThe overall design follows a principle of building from fundamental physical quantities (stress invariants) to a constitutive model (yield function) and then using targeted numerical experiments to validate key theoretical properties of that model.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to execute the full test suite for the isotropic yield surface.\n    \"\"\"\n\n    # --- Constants and Parameters from Problem Statement ---\n    k0 = 60.0  # MPa\n    k1 = 0.01  # dimensionless\n    TOLERANCE = 1e-10\n\n    # --- Helper Functions ---\n\n    def compute_invariants(sigma):\n        \"\"\"\n        Computes the pressure p, and deviatoric invariants J2, J3, and cos(3*theta).\n\n        Args:\n            sigma (np.ndarray): A 3x3 Cauchy stress tensor.\n\n        Returns:\n            tuple: A tuple containing (p, J2, J3, cos3theta).\n        \"\"\"\n        if not isinstance(sigma, np.ndarray) or sigma.shape != (3, 3):\n            raise TypeError(\"Input sigma must be a 3x3 numpy array.\")\n\n        # Mean stress (pressure)\n        p = np.trace(sigma) / 3.0\n\n        # Deviatoric stress tensor\n        s = sigma - p * np.identity(3)\n\n        # Second invariant of deviatoric stress\n        # s:s = sum(s_ij * s_ij)\n        J2 = 0.5 * np.sum(s**2)\n\n        # Third invariant of deviatoric stress\n        J3 = np.linalg.det(s)\n\n        # cos(3*theta)\n        if J2 <= TOLERANCE:\n            # Hydrostatic state convention\n            cos3theta = 1.0\n        else:\n            # Argument for arccos in Lode angle definition\n            arg = (3.0 * np.sqrt(3.0) / 2.0) * J3 / (J2**1.5)\n            # Numerical clipping for robustness\n            cos3theta = np.clip(arg, -1.0, 1.0)\n            \n        return p, J2, J3, cos3theta\n\n    def yield_function(p, J2, cos3theta, beta):\n        \"\"\"\n        Computes the value of the isotropic yield function F.\n\n        Args:\n            p (float): Mean stress.\n            J2 (float): Second deviatoric invariant.\n            cos3theta (float): Cosine of 3 times the Lode angle.\n            beta (float): Lode dependence parameter.\n\n        Returns:\n            float: The dimensionless value of the yield function F.\n        \"\"\"\n        if J2 < 0:\n            # J2 must be non-negative by definition\n            J2 = 0\n            \n        kappa = k0 + k1 * p\n        if abs(kappa) < TOLERANCE:\n            # Avoid division by zero, return large value if on failure locus\n            return np.inf if J2 > TOLERANCE else -1.0\n            \n        F_val = (np.sqrt(J2) / kappa) * (1.0 + beta * cos3theta) - 1.0\n        return F_val\n\n    results = []\n\n    # --- Task 3: Hydrostatic-shift test ---\n    beta_hydro_shift = 0.3\n    s_diag_a = np.array([10.0, -5.0, -5.0])\n    p_a = 30.0\n    delta_p = 50.0\n    p_b = p_a + delta_p\n\n    sigma_a = np.diag(s_diag_a) + p_a * np.identity(3)\n    sigma_b = np.diag(s_diag_a) + p_b * np.identity(3)\n\n    p_val_a, J2_a, J3_a, cos3theta_a = compute_invariants(sigma_a)\n    p_val_b, J2_b, J3_b, cos3theta_b = compute_invariants(sigma_b)\n\n    # Check for equality within tolerance\n    j2_eq = abs(J2_a - J2_b) < TOLERANCE\n    j3_eq = abs(J3_a - J3_b) < TOLERANCE\n    cos3th_eq = abs(cos3theta_a - cos3theta_b) < TOLERANCE\n\n    F_a = yield_function(p_val_a, J2_a, cos3theta_a, beta_hydro_shift)\n    F_b = yield_function(p_val_b, J2_b, cos3theta_b, beta_hydro_shift)\n    f_diff = F_b - F_a\n    results.extend([j2_eq, j3_eq, cos3th_eq, f_diff])\n\n    # --- Task 4: Lode-angle path test ---\n    p_fixed = 30.0\n    J2_fixed = 1600.0\n    R = np.sqrt(2 * J2_fixed)\n    path_angles = np.array([-np.pi/6, -np.pi/9, -np.pi/12, -np.pi/18, 0,\n                            np.pi/18, np.pi/12, np.pi/9, np.pi/6])\n\n    f_values_b03 = []\n    f_values_b00 = []\n\n    for theta_val in path_angles:\n        s1 = (2.0 / np.sqrt(6.0)) * R * np.cos(theta_val)\n        s2 = (2.0 / np.sqrt(6.0)) * R * np.cos(theta_val - 2.0 * np.pi / 3.0)\n        s3 = (2.0 / np.sqrt(6.0)) * R * np.cos(theta_val + 2.0 * np.pi / 3.0)\n        \n        sigma_path = p_fixed * np.identity(3) + np.diag([s1, s2, s3])\n        p_path, J2_path, J3_path, cos3theta_path = compute_invariants(sigma_path)\n        \n        f_b03 = yield_function(p_path, J2_path, cos3theta_path, 0.3)\n        f_b00 = yield_function(p_path, J2_path, cos3theta_path, 0.0)\n        \n        f_values_b03.append(f_b03)\n        f_values_b00.append(f_b00)\n\n    amp_03 = max(f_values_b03) - min(f_values_b03)\n    amp_00 = max(f_values_b00) - min(f_values_b00)\n    is_pos_amp03 = amp_03 > TOLERANCE  # Check if strictly positive beyond tolerance\n    is_zero_amp00 = amp_00 < TOLERANCE\n    results.extend([amp_03, amp_00, is_pos_amp03, is_zero_amp00])\n    \n    # --- Task 5: Evaluate specific states ---\n    beta_specific = 0.3\n    \n    # Pure hydrostatic state\n    sigma_h = 50.0 * np.identity(3)\n    p_h, J2_h, _, cos3theta_h = compute_invariants(sigma_h)\n    F_h = yield_function(p_h, J2_h, cos3theta_h, beta_specific)\n    results.append(F_h)\n\n    # General non-hydrostatic state\n    sigma_g = np.array([[120.0, 15.0, -10.0],\n                        [15.0, 80.0, 5.0],\n                        [-10.0, 5.0, 100.0]])\n    p_g, J2_g, _, cos3theta_g = compute_invariants(sigma_g)\n    F_g = yield_function(p_g, J2_g, cos3theta_g, beta_specific)\n    results.append(F_g)\n    \n    # --- Final Output ---\n    # Convert all results to strings for a uniform list\n    # Booleans will be converted to 'True'/'False'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3605161"}, {"introduction": "When deformations are large, ensuring that a constitutive model respects the principle of material frame-indifference is critical and non-trivial. This advanced practice [@problem_id:3605128] explores this concept by tasking you with creating a numerical experiment to expose a common but fatal flaw in hyperelastic implementations: the improper mixing of material and spatial tensors. By demonstrating how a 'buggy' formulation violates objectivity under rigid body rotation while the correct one remains invariant, you will solidify your understanding of this fundamental requirement in computational solid mechanics.", "problem": "Consider a compressible, isotropic, finite-strain hyperelastic material. Let the deformation gradient be denoted by $F$, the left Cauchy–Green tensor by $B = F F^{\\mathsf{T}}$, the right Cauchy–Green tensor by $C = F^{\\mathsf{T}} F$, and the Jacobian determinant by $J = \\det(F)$. Isotropy and frame indifference imply that the strain energy density can be written as a scalar function of the invariants of either $C$ or $B$. Define the first and second invariants of a second-order tensor $T$ as $I_1(T) = \\operatorname{tr}(T)$ and $I_2(T) = \\tfrac{1}{2} \\left( \\operatorname{tr}(T)^2 - \\operatorname{tr}(T^2) \\right)$.\n\nWe consider the strain energy\n$$\nW\\!\\left(I_1(C), I_2(C), J\\right) = a_1\\, I_1(C) + a_2\\, I_2(C) + \\frac{\\kappa}{2}\\, \\left(\\ln J\\right)^2,\n$$\nwith material parameters $a_1$, $a_2$, and $\\kappa$. Starting from the fundamental definitions and principles of objectivity and work-conjugacy, derive the expression for the Second Piola–Kirchhoff stress $S$, and the corresponding Cauchy stress $\\sigma$ obtained by a push-forward operation. Then, define and implement a deliberately flawed \"mixed-invariants\" stress computation in which the code forms a spatial (Kirchhoff) stress using the tensor $B$ multiplied by the derivative $\\partial W / \\partial C$, namely $\\tau_{\\text{bug}} = 2\\, B \\left( \\partial W / \\partial C \\right)$, and sets $\\sigma_{\\text{bug}} = \\tau_{\\text{bug}} / J$. Explain why this construction is not work-conjugate and generally violates frame indifference.\n\nDesign a numerical experiment to detect the bias introduced by this mixed-invariants mistake by testing frame indifference under superposed rigid body rotations. Specifically, for each test case:\n- Construct $F = R(\\theta)\\, U\\, S(\\gamma)$, where $R(\\theta)$ is a rotation about the $z$-axis by angle $\\theta$, $U = \\operatorname{diag}(s_1, s_2, s_3)$ is a diagonal stretch, and $S(\\gamma)$ is a simple shear in the $x$–$y$ plane with shear parameter $\\gamma$ given by $S(\\gamma) = \\begin{bmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}$. Angles must be expressed in radians.\n- Apply a superposed rigid body rotation $Q(\\phi)$ about the $y$-axis by angle $\\phi$ to form $F' = Q(\\phi)\\, F$.\n- Compute the correct Cauchy stress $\\sigma(F)$ and $\\sigma(F')$ and verify objectivity by comparing $\\sigma(F')$ to $Q(\\phi)\\, \\sigma(F)\\, Q(\\phi)^{\\mathsf{T}}$ using the relative residual\n$$\nr_{\\text{ok}} = \\frac{\\left\\| \\sigma(F') - Q(\\phi)\\, \\sigma(F)\\, Q(\\phi)^{\\mathsf{T}} \\right\\|_F}{\\left\\| Q(\\phi)\\, \\sigma(F)\\, Q(\\phi)^{\\mathsf{T}} \\right\\|_F + \\varepsilon},\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm and $\\varepsilon$ is a small positive number to avoid division by zero.\n- Compute the buggy Cauchy stress $\\sigma_{\\text{bug}}(F)$ and $\\sigma_{\\text{bug}}(F')$ using the mixed-invariants construction and evaluate\n$$\nr_{\\text{bug}} = \\frac{\\left\\| \\sigma_{\\text{bug}}(F') - Q(\\phi)\\, \\sigma_{\\text{bug}}(F)\\, Q(\\phi)^{\\mathsf{T}} \\right\\|_F}{\\left\\| Q(\\phi)\\, \\sigma_{\\text{bug}}(F)\\, Q(\\phi)^{\\mathsf{T}} \\right\\|_F + \\varepsilon}.\n$$\nDeclare that a bias has been detected if $r_{\\text{ok}} \\le t_{\\text{ok}}$ and $r_{\\text{bug}} > t_{\\text{bug}}$, with thresholds $t_{\\text{ok}} = 10^{-12}$ and $t_{\\text{bug}} = 10^{-6}$, and use $\\varepsilon = 10^{-16}$.\n\nYour program must implement the above, using the following material parameters: $a_1 = 4.0$, $a_2 = 1.2$, $\\kappa = 50.0$. Use the three test cases below, specified by $(\\theta, \\phi, s_1, s_2, s_3, \\gamma)$, with all angles in radians:\n1. $(\\theta = 0.5, \\phi = 0.7, s_1 = 1.3, s_2 = 0.9, s_3 = 1.1, \\gamma = 0.4)$,\n2. $(\\theta = 0.3, \\phi = 0.6, s_1 = 1.1, s_2 = 1.1, s_3 = 1.1, \\gamma = 0.0)$,\n3. $(\\theta = 1.1, \\phi = 0.9, s_1 = 1.0, s_2 = 1.0, s_3 = 1.0, \\gamma = 1.5)$.\n\nFor each test case, return a boolean indicating whether bias was detected. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[ \\text{result}_1, \\text{result}_2, \\text{result}_3 ]$), where each $\\text{result}_i$ is a boolean literal $\\text{True}$ or $\\text{False}$.", "solution": "The problem statement is assessed to be valid as it is scientifically grounded in continuum mechanics, well-posed, objective, and internally consistent. We shall proceed with the derivation and numerical implementation.\n\nThe analysis is structured into three parts: first, the derivation of the correct, objective stress-strain relationship from the given strain energy function; second, an analysis of the proposed \"mixed-invariants\" formulation to demonstrate its fundamental flaws; and third, the design and implementation of a numerical experiment to detect the consequences of these flaws.\n\n**1. Derivation of the Correct Constitutive Law**\n\nThe cornerstone of hyperelasticity is that the stress tensor is derived from a scalar potential, the strain energy density function $W$. For a material formulation, the second Piola-Kirchhoff stress tensor $S$ is energetically conjugate to the rate of change of the right Cauchy-Green tensor $C$. This relationship is expressed as:\n$$\nS = 2 \\frac{\\partial W}{\\partial C}\n$$\nThe given strain energy function is $W\\!\\left(I_1(C), I_2(C), J\\right) = a_1\\, I_1(C) + a_2\\, I_2(C) + \\frac{\\kappa}{2}\\, \\left(\\ln J\\right)^2$. To find $S$, we apply the chain rule:\n$$\nS = 2 \\left( \\frac{\\partial W}{\\partial I_1(C)} \\frac{\\partial I_1(C)}{\\partial C} + \\frac{\\partial W}{\\partial I_2(C)} \\frac{\\partial I_2(C)}{\\partial C} + \\frac{\\partial W}{\\partial J} \\frac{\\partial J}{\\partial C} \\right)\n$$\nThe required partial derivatives of $W$ with respect to the invariants are:\n$$\n\\frac{\\partial W}{\\partial I_1(C)} = a_1\n$$\n$$\n\\frac{\\partial W}{\\partial I_2(C)} = a_2\n$$\n$$\n\\frac{\\partial W}{\\partial J} = \\frac{\\kappa}{J} \\ln J\n$$\nThe derivatives of the invariants with respect to the tensor $C$ are standard results in tensor calculus:\n$$\n\\frac{\\partial I_1(C)}{\\partial C} = \\frac{\\partial \\operatorname{tr}(C)}{\\partial C} = I\n$$\n$$\n\\frac{\\partial I_2(C)}{\\partial C} = \\frac{\\partial}{\\partial C} \\left( \\tfrac{1}{2} \\left( \\operatorname{tr}(C)^2 - \\operatorname{tr}(C^2) \\right) \\right) = I_1(C) I - C\n$$\n$$\n\\frac{\\partial J}{\\partial C} = \\frac{\\partial \\sqrt{\\det(C)}}{\\partial C} = \\frac{1}{2\\sqrt{\\det(C)}} \\frac{\\partial \\det(C)}{\\partial C} = \\frac{1}{2J} J C^{-1} = \\frac{1}{2} J C^{-1}\n$$\nwhere $I$ is the second-order identity tensor and the last result utilizes Jacobi's formula.\n\nSubstituting these into the expression for $S$ yields:\n$$\nS = 2 \\left( a_1 I + a_2 \\left( I_1(C) I - C \\right) + \\left( \\frac{\\kappa}{J} \\ln J \\right) \\left( \\frac{1}{2} J C^{-1} \\right) \\right)\n$$\n$$\nS = 2 a_1 I + 2 a_2 \\left( I_1(C) I - C \\right) + \\kappa (\\ln J) C^{-1}\n$$\nThis is the expression for the second Piola-Kirchhoff stress in the reference configuration. The physically relevant stress in the current (deformed) configuration is the Cauchy stress, $\\sigma$. It is obtained by a push-forward operation on $S$:\n$$\n\\sigma = \\frac{1}{J} F S F^{\\mathsf{T}}\n$$\nSubstituting the expression for $S$:\n$$\n\\sigma = \\frac{1}{J} F \\left( 2 a_1 I + 2 a_2 (I_1(C) I - C) + \\kappa (\\ln J) C^{-1} \\right) F^{\\mathsf{T}}\n$$\nWe simplify the terms using the kinematic identities $B = F F^{\\mathsf{T}}$, $I_1(C) = I_1(B)$, $F C F^{\\mathsf{T}} = F (F^{\\mathsf{T}} F) F^{\\mathsf{T}} = (F F^{\\mathsf{T}}) (F F^{\\mathsf{T}}) = B^2$, and $F C^{-1} F^{\\mathsf{T}} = F (F^{\\mathsf{T}} F)^{-1} F^{\\mathsf{T}} = F F^{-1} (F^{\\mathsf{T}})^{-1} F^{\\mathsf{T}} = I$.\n$$\n\\sigma = \\frac{1}{J} \\left( 2 a_1 ( F I F^{\\mathsf{T}} ) + 2 a_2 (I_1(C) F F^{\\mathsf{T}} - F C F^{\\mathsf{T}}) + \\kappa (\\ln J) F C^{-1} F^{\\mathsf{T}} \\right)\n$$\n$$\n\\sigma = \\frac{1}{J} \\left( 2 a_1 B + 2 a_2 (I_1(B) B - B^2) + \\kappa (\\ln J) I \\right)\n$$\nThis final expression for the Cauchy stress $\\sigma$ is formulated entirely in terms of spatial quantities ($B$, $J$, $I$) and is guaranteed to be objective by its derivation.\n\n**2. Analysis of the Flawed \"Mixed-Invariants\" Formulation**\n\nThe problem defines a flawed \"buggy\" stress calculation as:\n$$\n\\tau_{\\text{bug}} = 2 B \\frac{\\partial W}{\\partial C} \\quad \\text{and} \\quad \\sigma_{\\text{bug}} = \\frac{1}{J} \\tau_{\\text{bug}}\n$$\nSince $S = 2 \\partial W / \\partial C$, the buggy formulation is equivalent to $\\tau_{\\text{bug}} = B S$. This is incorrect; the correct Kirchhoff stress is $\\tau = F S F^{\\mathsf{T}}$. The expression $B S = (F F^{\\mathsf{T}})S$ is not equivalent to $F S F^{\\mathsf{T}}$ unless $S$ and $F^{\\mathsf{T}}$ commute, which is not generally true. This formulation is flawed for two fundamental reasons:\n\nFirst, it is **not work-conjugate**. The derivation of stress from a potential function is predicated on a specific pairing of stress and strain measures that ensures conservation of energy. The buggy formulation circumvents this rigorous derivation, instead performing an ad-hoc multiplication of a spatial tensor, $B$, and a material tensor, $S$. This operation has no physical basis and breaks the energetic consistency required by hyperelasticity.\n\nSecond, it **violates frame indifference (objectivity)**. The principle of objectivity requires that constitutive laws remain invariant under a change of observer, which is modeled by a superposed rigid body rotation. Let the current configuration undergo a rotation described by the orthogonal tensor $Q$ ($Q Q^{\\mathsf{T}} = I$, $\\det(Q) = 1$). The deformation gradient transforms to $F' = Q F$.\nThe corresponding transformations of the kinematic tensors are:\n- Right Cauchy-Green: $C' = (F')^{\\mathsf{T}} F' = (Q F)^{\\mathsf{T}} (Q F) = F^{\\mathsf{T}} Q^{\\mathsf{T}} Q F = F^{\\mathsf{T}} I F = C$. $C$ is objective (invariant).\n- Jacobian: $J' = \\det(F') = \\det(Q F) = \\det(Q) \\det(F) = 1 \\cdot J = J$. $J$ is objective.\n- Left Cauchy-Green: $B' = F' (F')^{\\mathsf{T}} = (Q F) (Q F)^{\\mathsf{T}} = Q F F^{\\mathsf{T}} Q^{\\mathsf{T}} = Q B Q^{\\mathsf{T}}$. $B$ transforms as a proper spatial tensor.\n\nSince $C$ and $J$ are invariant, the strain energy $W$ and its derivative with respect to $C$, $\\partial W / \\partial C$, are also invariant.\nLet's compute the buggy stress in the new frame:\n$$\n\\sigma_{\\text{bug}}(F') = \\frac{1}{J'} \\left( 2 B' \\frac{\\partial W(C', J')}{\\partial C'} \\right) = \\frac{2}{J} (Q B Q^{\\mathsf{T}}) \\frac{\\partial W(C, J)}{\\partial C}\n$$\nFor objectivity to hold, $\\sigma_{\\text{bug}}(F')$ must be equal to the rotated original buggy stress, $Q \\sigma_{\\text{bug}}(F) Q^{\\mathsf{T}}$:\n$$\nQ \\sigma_{\\text{bug}}(F) Q^{\\mathsf{T}} = Q \\left( \\frac{2}{J} B \\frac{\\partial W(C, J)}{\\partial C} \\right) Q^{\\mathsf{T}} = \\frac{2}{J} Q B \\frac{\\partial W(C, J)}{\\partial C} Q^{\\mathsf{T}}\n$$\nObjectivity requires the equality:\n$$\n\\frac{2}{J} (Q B Q^{\\mathsf{T}}) \\frac{\\partial W}{\\partial C} = \\frac{2}{J} Q B \\frac{\\partial W}{\\partial C} Q^{\\mathsf{T}}\n$$\nThis simplifies to $(Q B Q^{\\mathsf{T}}) A = Q B A Q^{\\mathsf{T}}$, where $A = \\partial W / \\partial C$. This equality does not hold for arbitrary tensors $B$, $A$, and rotation $Q$, because matrix multiplication is not commutative. The expression improperly mixes a spatial tensor $B$ with a material tensor $A$, leading to a non-objective result.\n\n**3. Numerical Experiment**\n\nThe numerical experiment will concretely demonstrate the violation of objectivity. We will compute the correct Cauchy stress, $\\sigma(F)$, and the buggy stress, $\\sigma_{\\text{bug}}(F)$, for a given deformation $F$. We then apply a superposed rotation $Q$ to get $F' = Q F$ and compute $\\sigma(F')$ and $\\sigma_{\\text{bug}}(F')$.\nObjectivity of the correct stress is verified by checking if the residual $r_{\\text{ok}} = \\frac{\\left\\| \\sigma(F') - Q \\sigma(F) Q^{\\mathsf{T}} \\right\\|_F}{\\left\\| Q \\sigma(F) Q^{\\mathsf{T}} \\right\\|_F + \\varepsilon}$ is close to machine precision ($r_{\\text{ok}} \\le 10^{-12}$).\nThe non-objectivity of the buggy stress is detected if its corresponding residual $r_{\\text{bug}} = \\frac{\\left\\| \\sigma_{\\text{bug}}(F') - Q \\sigma_{\\text{bug}}(F) Q^{\\mathsf{T}} \\right\\|_F}{\\left\\| Q \\sigma_{\\text{bug}}(F) Q^{\\mathsf{T}} \\right\\|_F + \\varepsilon}$ is significantly larger than zero ($r_{\\text{bug}} > 10^{-6}$).\nA bias is detected if both conditions are met, confirming the theoretical analysis.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_stresses(F, a1, a2, kappa):\n    \"\"\"\n    Computes the correct Cauchy stress and the flawed \"mixed-invariants\"\n    Cauchy stress for a given deformation gradient F.\n    \"\"\"\n    I = np.eye(3)\n    J = np.linalg.det(F)\n    \n    # It is numerically more stable to compute B first, then C if needed.\n    B = F @ F.T\n    \n    # --- Correct Cauchy Stress Calculation (spatial form) ---\n    I1_B = np.trace(B)\n    B_sq = B @ B\n    \n    # sigma = (1/J) * (2*a1*B + 2*a2*(I1_B*B - B_sq) + kappa*np.log(J)*I)\n    # The problem description implicitly suggests a volumetric/deviatoric split\n    # where the volumetric part (involving J) contributes only to the pressure.\n    # The term a1*I1(C) + a2*I2(C) is often used for the isochoric part.\n    # In that context, one would use modified invariants. However, following the\n    # problem statement literally:\n    # W = a1*I1(C) + a2*I2(C) + (kappa/2)*(lnJ)^2\n    # The derived spatial form is used here.\n    \n    term_a1 = 2.0 * a1 * B\n    term_a2 = 2.0 * a2 * (I1_B * B - B_sq)\n    term_kappa = kappa * np.log(J) * I\n    \n    sigma_correct = (1.0 / J) * (term_a1 + term_a2 + term_kappa)\n    \n    # --- Buggy Cauchy Stress Calculation (mixed-frame form) ---\n    C = F.T @ F\n    try:\n        C_inv = np.linalg.inv(C)\n    except np.linalg.LinAlgError:\n        # Handle singular C if it occurs, though unlikely with given test cases.\n        return sigma_correct, np.full((3,3), np.nan)\n\n    I1_C = np.trace(C)\n    \n    # S = 2 * dW/dC\n    S = 2.0 * a1 * I + 2.0 * a2 * (I1_C * I - C) + kappa * np.log(J) * C_inv\n    \n    # tau_bug = B @ S\n    tau_bug = B @ S\n    sigma_buggy = (1.0 / J) * tau_bug\n    \n    return sigma_correct, sigma_buggy\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for detecting bias.\n    \"\"\"\n    # Material parameters\n    a1 = 4.0\n    a2 = 1.2\n    kappa = 50.0\n\n    # Numerical thresholds and constants\n    t_ok = 1e-12\n    t_bug = 1e-6\n    epsilon = 1e-16\n\n    # Test cases: (theta, phi, s1, s2, s3, gamma)\n    test_cases = [\n        (0.5, 0.7, 1.3, 0.9, 1.1, 0.4),\n        (0.3, 0.6, 1.1, 1.1, 1.1, 0.0),\n        (1.1, 0.9, 1.0, 1.0, 1.0, 1.5),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        theta, phi, s1, s2, s3, gamma = case\n\n        # --- Construct matrices ---\n        # Rotation about z-axis\n        cos_t, sin_t = np.cos(theta), np.sin(theta)\n        R_z = np.array([[cos_t, -sin_t, 0],\n                        [sin_t,  cos_t, 0],\n                        [0,      0,     1]])\n\n        # Diagonal stretch\n        U = np.diag([s1, s2, s3])\n\n        # Simple shear in x-y plane\n        S_gamma = np.array([[1, gamma, 0],\n                            [0, 1,     0],\n                            [0, 0,     1]])\n\n        # Superposed rotation about y-axis\n        cos_p, sin_p = np.cos(phi), np.sin(phi)\n        Q_y = np.array([[cos_p,  0, sin_p],\n                        [0,      1, 0],\n                        [-sin_p, 0, cos_p]])\n        Q = Q_y\n\n        # --- Compute deformation gradients ---\n        F = R_z @ U @ S_gamma\n        F_prime = Q @ F\n\n        # --- Compute stresses ---\n        sigma_F_ok, sigma_F_bug = compute_stresses(F, a1, a2, kappa)\n        sigma_F_prime_ok, sigma_F_prime_bug = compute_stresses(F_prime, a1, a2, kappa)\n        \n        # --- Evaluate residuals ---\n        \n        # Correct stress objectivity check\n        sigma_F_ok_rotated = Q @ sigma_F_ok @ Q.T\n        num_ok = np.linalg.norm(sigma_F_prime_ok - sigma_F_ok_rotated, 'fro')\n        den_ok = np.linalg.norm(sigma_F_ok_rotated, 'fro') + epsilon\n        r_ok = num_ok / den_ok\n\n        # Buggy stress objectivity check\n        sigma_F_bug_rotated = Q @ sigma_F_bug @ Q.T\n        num_bug = np.linalg.norm(sigma_F_prime_bug - sigma_F_bug_rotated, 'fro')\n        den_bug = np.linalg.norm(sigma_F_bug_rotated, 'fro') + epsilon\n        r_bug = num_bug / den_bug\n\n        # --- Check for bias detection ---\n        bias_detected = (r_ok <= t_ok) and (r_bug > t_bug)\n        results.append(bias_detected)\n\n    # Convert numpy booleans to Python booleans for standard string representation\n    py_results = [bool(r) for r in results]\n    print(f\"[{','.join(map(str, py_results))}]\")\n\nsolve()\n\n```", "id": "3605128"}]}