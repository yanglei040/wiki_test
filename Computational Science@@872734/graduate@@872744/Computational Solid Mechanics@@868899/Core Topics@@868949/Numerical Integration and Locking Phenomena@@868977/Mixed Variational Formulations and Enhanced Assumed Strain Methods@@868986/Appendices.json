{"hands_on_practices": [{"introduction": "Choosing compatible interpolation spaces for different fields in a mixed formulation is not a trivial matter. This exercise reveals the pitfalls of an intuitive but flawed choice, the equal-order bilinear element for displacement and pressure ($Q1/Q1$). By constructing a \"spurious pressure mode,\" you will diagnose the source of instability and understand why this element violates the fundamental Ladyzhenskaya–Babuška–Brezzi (LBB) condition, motivating the need for the advanced methods discussed in this article [@problem_id:3582079].", "problem": "Consider the mixed displacement–pressure formulation of linearized incompressible elasticity on a polygonal domain $\\Omega \\subset \\mathbb{R}^2$ with homogeneous Dirichlet boundary conditions for the displacement. Let the trial and test spaces be $V = [H^1_0(\\Omega)]^2$ and $Q = L^2_0(\\Omega)$, and the bilinear form associated with the incompressibility constraint be\n$$\nb(\\boldsymbol{v}, q) = \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega.\n$$\nThe Ladyzhenskaya–Babuška–Brezzi (LBB) condition (also called the inf–sup condition) requires the existence of a constant $\\beta > 0$, independent of the mesh size $h$, such that\n$$\n\\inf_{0 \\neq q_h \\in Q_h} \\sup_{0 \\neq \\boldsymbol{v}_h \\in V_h} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)} \\, \\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta,\n$$\nwhere $V_h \\subset V$ and $Q_h \\subset Q$ are the discrete spaces. Consider a family of shape-regular, quasi-uniform, axis-aligned quadrilateral meshes $\\{\\mathcal{T}_h\\}$ that partition $\\Omega$ into rectangles. Let the discrete spaces be\n$$\nV_h = \\{\\boldsymbol{v}_h \\in [C^0(\\overline{\\Omega})]^2: \\ \\boldsymbol{v}_h|_{K} \\in [Q_1(K)]^2 \\ \\forall K \\in \\mathcal{T}_h, \\ \\boldsymbol{v}_h|_{\\partial \\Omega} = \\boldsymbol{0}\\},\n$$\n$$\nQ_h = \\{q_h \\in C^0(\\overline{\\Omega}) \\cap L^2_0(\\Omega): \\ q_h|_{K} \\in Q_1(K) \\ \\forall K \\in \\mathcal{T}_h\\},\n$$\nwhere $Q_1(K)$ denotes the space of bilinear polynomials on element $K$.\n\nYou are to decide which of the following options correctly constructs a nontrivial sequence $q_h \\in Q_h$ and provides a correct argument showing that the pair $[Q_1]^2$–$Q_1$ on quadrilaterals violates the LBB condition. Your choice must start from the mixed variational form and reason from first principles (polynomial structure and element-wise mappings), without invoking black-box stabilization results.\n\nA. On a uniform rectangular mesh, assign the pressure nodal values by $p_{i,j} = (-1)^{i+j}$ at mesh node indices $(i,j)$ and define $q_h \\in Q_h$ by continuous bilinear interpolation. On each element $K$, the restriction $q_h|_K$ equals a scaled $Q_1$ basis function proportional to the monomial $x y$ in the element’s local coordinates. Since for any $\\boldsymbol{v}_h \\in [Q_1]^2$, the divergence $\\nabla \\cdot \\boldsymbol{v}_h|_K$ lies in $\\operatorname{span}\\{1, x, y\\}$, it follows that\n$$\n\\int_K q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}A = 0\n$$\nby orthogonality of $x y$ with $\\{1, x, y\\}$ over a rectangle. Summing over elements gives $b(\\boldsymbol{v}_h, q_h) = 0$ for all $\\boldsymbol{v}_h \\in V_h$, while $\\|q_h\\|_{L^2(\\Omega)} > 0$ and $\\int_{\\Omega} q_h \\, \\mathrm{d}\\Omega = 0$. Therefore, the discrete inf–sup constant is $\\beta_h = 0$, violating the LBB condition.\n\nB. Take $q_h$ to be any nonzero constant function on $\\Omega$. Since $\\boldsymbol{v}_h \\in V_h$ vanishes on $\\partial \\Omega$, the divergence theorem implies $b(\\boldsymbol{v}_h, q_h) = \\int_{\\Omega} q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}\\Omega = q_h \\int_{\\partial \\Omega} \\boldsymbol{v}_h \\cdot \\boldsymbol{n} \\, \\mathrm{d}s = 0$ for all $\\boldsymbol{v}_h \\in V_h$, hence the LBB condition is violated.\n\nC. Use a triangular mesh and the equal-order continuous piecewise linear pair $[P_1]^2$–$P_1$ and argue by analogy that equal-order pairs are always unstable, so $[Q_1]^2$–$Q_1$ on quadrilaterals is unstable for the same reason.\n\nD. Add an Enhanced Assumed Strain (EAS) enrichment to the displacement space within $[Q_1]^2$ elements and argue that because EAS modifies strains independently of displacements, the mixed pair $[Q_1]^2$–$Q_1$ becomes unstable, demonstrating violation of the LBB condition.\n\nSelect the option that correctly constructs and justifies a counterexample sequence $q_h$ demonstrating violation of the LBB condition for $[Q_1]^2$–$Q_1$ on quadrilateral meshes, using only the polynomial structure of $Q_1$ and properties of $b(\\cdot,\\cdot)$ as the fundamental base.", "solution": "The user wants me to validate the problem statement and, if valid, provide a detailed solution identifying the correct option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Problem Type**: Mixed displacement-pressure formulation for linearized incompressible elasticity.\n- **Domain**: $\\Omega \\subset \\mathbb{R}^2$, a polygonal domain.\n- **Boundary Conditions**: Homogeneous Dirichlet for displacement, $\\boldsymbol{v} = \\boldsymbol{0}$ on $\\partial\\Omega$.\n- **Continuous Function Spaces**:\n    - Displacement: $V = [H^1_0(\\Omega)]^2$.\n    - Pressure: $Q = L^2_0(\\Omega) = \\{q \\in L^2(\\Omega) : \\int_{\\Omega} q \\, \\mathrm{d}\\Omega = 0\\}$.\n- **Bilinear Form for Constraint**: $b(\\boldsymbol{v}, q) = \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega$.\n- **LBB (inf-sup) Condition**: There exists a constant $\\beta > 0$, independent of mesh size $h$, such that:\n$$\n\\inf_{0 \\neq q_h \\in Q_h} \\sup_{0 \\neq \\boldsymbol{v}_h \\in V_h} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)} \\, \\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta.\n$$\n- **Mesh**: A family of shape-regular, quasi-uniform, axis-aligned quadrilateral meshes $\\{\\mathcal{T}_h\\}$ composed of rectangles.\n- **Discrete Function Spaces**:\n    - $V_h = \\{\\boldsymbol{v}_h \\in [C^0(\\overline{\\Omega})]^2: \\ \\boldsymbol{v}_h|_{K} \\in [Q_1(K)]^2 \\ \\forall K \\in \\mathcal{T}_h, \\ \\boldsymbol{v}_h|_{\\partial \\Omega} = \\boldsymbol{0}\\}$.\n    - $Q_h = \\{q_h \\in C^0(\\overline{\\Omega}) \\cap L^2_0(\\Omega): \\ q_h|_{K} \\in Q_1(K) \\ \\forall K \\in \\mathcal{T}_h\\}$.\n- **Polynomial Space**: $Q_1(K)$ is the space of bilinear polynomials on an element $K$.\n- **Task**: Identify the option that correctly constructs a nontrivial sequence $q_h \\in Q_h$ and provides a correct argument from first principles to show that the $[Q_1]^2$–$Q_1$ pair violates the LBB condition.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem statement is a classic setup in the finite element analysis of saddle-point problems, specifically the Stokes problem or linearized incompressible elasticity. The LBB condition is the fundamental stability criterion for such mixed methods. The specified element pair, $[Q_1]^2$–$Q_1$ (equal-order bilinear interpolation for velocity and pressure), is a well-known example that fails to satisfy this condition. All concepts are standard and rigorously defined within computational mechanics and numerical analysis.\n- **Well-Posed**: The problem is well-posed. It asks for the identification of a correct mathematical argument among a set of choices to demonstrate a known instability. A unique and correct line of reasoning exists and is expected.\n- **Objective**: The language is formal, mathematical, and free of subjective or ambiguous terminology.\n- **Conclusion**: The problem statement is valid. It is scientifically sound, well-posed, objective, complete, and relevant to the specified field.\n\n**Step 3: Verdict and Action**\n- **Verdict**: The problem is valid.\n- **Action**: Proceed with the solution.\n\n### Derivation of the Correct Answer\n\nThe LBB condition is violated if the discrete inf-sup constant $\\beta_h$ is zero for a sequence of meshes. This occurs if there exists a non-zero pressure function $q_h \\in Q_h$ (often called a \"spurious pressure mode\") such that $b(\\boldsymbol{v}_h, q_h) = 0$ for all possible discrete displacement fields $\\boldsymbol{v}_h \\in V_h$. If such a $q_h$ exists, the supremum in the LBB expression for that specific $q_h$ becomes zero, forcing the infimum over all $q_h \\in Q_h$ to be zero.\n\nOur goal is to construct such a $q_h \\in Q_h$ where $q_h \\neq 0$ and prove that $b(\\boldsymbol{v}_h, q_h)=0$ for all $\\boldsymbol{v}_h \\in V_h$. The bilinear form is a sum over elements:\n$$\nb(\\boldsymbol{v}_h, q_h) = \\int_{\\Omega} q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}\\Omega = \\sum_{K \\in \\mathcal{T}_h} \\int_K q_h|_K \\, \\nabla \\cdot (\\boldsymbol{v}_h|_K) \\, \\mathrm{d}A.\n$$\nA sufficient (though not necessary) condition for $b(\\boldsymbol{v}_h, q_h) = 0$ is that the integral over each element is zero:\n$$\n\\int_K q_h|_K \\, \\nabla \\cdot (\\boldsymbol{v}_h|_K) \\, \\mathrm{d}A = 0 \\quad \\forall K \\in \\mathcal{T}_h, \\ \\forall \\boldsymbol{v}_h \\in V_h.\n$$\nLet's analyze the polynomial spaces on a reference element, the square $\\hat{K} = [-1, 1]^2$ with local coordinates $(\\xi, \\eta)$. For an axis-aligned rectangular element $K$, the mapping from $\\hat{K}$ is affine. A displacement field $\\boldsymbol{v}_h|_K \\in [Q_1(K)]^2$ has components $v_1, v_2$ which are bilinear polynomials. For simplicity, let's analyze the divergence in local coordinates. Let $\\boldsymbol{v}_h(\\xi, \\eta) = (v_1(\\xi,\\eta), v_2(\\xi,\\eta))^\\top$ where\n$$\nv_1(\\xi, \\eta) = c_0 + c_1 \\xi + c_2 \\eta + c_3 \\xi \\eta\n$$\n$$\nv_2(\\xi, \\eta) = d_0 + d_1 \\xi + d_2 \\eta + d_3 \\xi \\eta\n$$\nFor an axis-aligned rectangular element $K$ of size $2h_x \\times 2h_y$, the mapping is $x = x_c + \\xi h_x$ and $y = y_c + \\eta h_y$. The chain rule gives:\n$$\n\\nabla \\cdot \\boldsymbol{v}_h = \\frac{\\partial v_1}{\\partial x} + \\frac{\\partial v_2}{\\partial y} = \\frac{\\partial v_1}{\\partial \\xi}\\frac{\\partial \\xi}{\\partial x} + \\frac{\\partial v_2}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial y} = \\frac{1}{h_x}\\frac{\\partial v_1}{\\partial \\xi} + \\frac{1}{h_y}\\frac{\\partial v_2}{\\partial \\eta}.\n$$\nCalculating the partial derivatives:\n$$\n\\frac{\\partial v_1}{\\partial \\xi} = c_1 + c_3 \\eta, \\quad \\frac{\\partial v_2}{\\partial \\eta} = d_2 + d_3 \\xi.\n$$\nThus, the divergence restricted to the element is:\n$$\n\\nabla \\cdot (\\boldsymbol{v}_h|_K) = \\frac{1}{h_x}(c_1 + c_3 \\eta) + \\frac{1}{h_y}(d_2 + d_3 \\xi).\n$$\nThis function is a linear polynomial in $\\xi$ and $\\eta$. In local coordinates, the space of all possible discrete divergences on an element is $\\text{span}\\{1, \\xi, \\eta\\}$.\n\nNow, consider the pressure space. A pressure field $q_h|_K \\in Q_1(K)$ is a bilinear polynomial, which on the reference element belongs to $\\text{span}\\{1, \\xi, \\eta, \\xi\\eta\\}$.\nFor the element-wise integral $\\int_K q_h \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}A$ to be zero for any $\\boldsymbol{v}_h$, the function $q_h|_K$ must be $L^2$-orthogonal to the entire space of discrete divergences, $\\text{span}\\{1, \\xi, \\eta\\}$, over the element. The polynomial $\\xi\\eta$ has this property on the reference square $\\hat{K}$:\n$$\n\\int_{-1}^1 \\int_{-1}^1 (\\xi\\eta) \\cdot 1 \\, d\\xi d\\eta = 0, \\quad \\int_{-1}^1 \\int_{-1}^1 (\\xi\\eta) \\cdot \\xi \\, d\\xi d\\eta = 0, \\quad \\int_{-1}^1 \\int_{-1}^1 (\\xi\\eta) \\cdot \\eta \\, d\\xi d\\eta = 0.\n$$\nThis suggests constructing a global pressure field $q_h \\in Q_h$ such that on each element $K$, $q_h|_K$ is proportional to the local $\\xi\\eta$ monomial. The classic \"checkerboard\" pressure mode achieves this. Let the nodes of the mesh be indexed by $(i,j)$ and define the nodal values of $q_h$ as $p_{i,j} = (-1)^{i+j}$. On any element $K$ whose four nodes have indices $(i,j), (i+1,j), (i,j+1), (i+1,j+1)$, the nodal values are proportional to $1, -1, -1, 1$. The bilinear interpolant of these values on the reference element is proportional to $\\xi\\eta$.\n\nThis function $q_h$ is continuous by construction and thus belongs to $[C^0(\\overline{\\Omega})]$. It is non-zero, so $\\|q_h\\|_{L^2(\\Omega)} > 0$. We must check if it has a zero mean to be in $Q_h$. The integral of $\\xi\\eta$ over the reference element is $\\int_{-1}^1\\int_{-1}^1 \\xi\\eta \\,d\\xi d\\eta = 0$. Since the local function on each element is just a scaled version of this, the integral of $q_h|_K$ over any element $K$ is zero. Summing over all elements gives $\\int_{\\Omega} q_h \\, \\mathrm{d}\\Omega = 0$. Therefore, this checkerboard function $q_h$ is indeed a valid non-zero element of $Q_h$.\n\nWith this choice of $q_h$, for any $\\boldsymbol{v}_h \\in V_h$, we have:\n$$\nb(\\boldsymbol{v}_h, q_h) = \\sum_{K \\in \\mathcal{T}_h} \\int_K q_h|_K \\, \\nabla \\cdot (\\boldsymbol{v}_h|_K) \\, \\mathrm{d}A = \\sum_{K \\in \\mathcal{T}_h} 0 = 0.\n$$\nThis demonstrates the existence of a non-zero $q_h \\in Q_h$ in the discrete kernel of the divergence operator's adjoint. Consequently, the inf-sup constant $\\beta_h = 0$, violating the LBB condition.\n\n### Option-by-Option Analysis\n\n**A. On a uniform rectangular mesh, assign the pressure nodal values by $p_{i,j} = (-1)^{i+j}$...**\nThis option correctly describes the construction of the checkerboard pressure mode. It correctly identifies that on each element, this pressure field is proportional to the monomial $xy$ (in local coordinates) and that the divergence of any $[Q_1]^2$ field is a linear polynomial (in $\\text{span}\\{1, x, y\\}$). It correctly uses the orthogonality of these polynomial spaces on a rectangle to argue that the integral $\\int_K q_h \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}A$ is zero. It correctly confirms that $q_h \\in Q_h$ (non-zero and zero mean) and concludes that $\\beta_h = 0$. This argument is physically and mathematically sound and follows from first principles.\n\n**Verdict: Correct**\n\n**B. Take $q_h$ to be any nonzero constant function on $\\Omega$...**\nThis option suggests we test with a non-zero constant function $q_h = C \\neq 0$. The argument that $b(\\boldsymbol{v}_h, C) = 0$ is correct via the divergence theorem. However, the pressure space is specified as $Q_h \\subset L^2_0(\\Omega)$, which requires $\\int_{\\Omega} q_h \\, \\mathrm{d}\\Omega = 0$. For a non-zero constant $q_h = C$, the integral is $C \\cdot \\text{Area}(\\Omega)$, which is non-zero. Therefore, the function proposed is not an element of the test space $Q_h$. The argument is invalid because it uses a test function that is not admissible.\n\n**Verdict: Incorrect**\n\n**C. Use a triangular mesh and the equal-order continuous piecewise linear pair $[P_1]^2$–$P_1$ and argue by analogy...**\nThis option makes two fundamental errors. First, it changes the specified problem setting from quadrilateral meshes to triangular meshes. Second, it relies on an argument by analogy (\"equal-order pairs are always unstable\"), which is not a rigorous proof from first principles as required by the prompt. While the conclusion about the instability of $[P_1]^2$–$P_1$ is correct, it does not constitute a valid proof for the $[Q_1]^2$–$Q_1$ case.\n\n**Verdict: Incorrect**\n\n**D. Add an Enhanced Assumed Strain (EAS) enrichment...**\nThis option introduces a concept, EAS, that is not part of the original problem formulation. EAS is a technique used to improve the performance of displacement-based elements, particularly to cure locking. It is not a tool for analyzing the stability of a mixed displacement-pressure formulation. The argument that adding EAS demonstrates the instability of the original pair is a non-sequitur. The stability of the $[Q_1]^2$–$Q_1$ pair must be analyzed on its own terms, not by changing the formulation to something else entirely. The logic is flawed and irrelevant to the question.\n\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "3582079"}, {"introduction": "Having seen how an unstable element fails, we now turn to the construction of a mathematically sound mixed formulation. This practice guides you through the derivation of the mixed weak form for incompressible elasticity, the foundation for stable $u/p$ elements. You will then perform a concrete calculation of the inf-sup quotient [@problem_id:3582046], providing a hands-on feel for the LBB stability condition that ensures a well-posed problem.", "problem": "Consider linear, small-strain, incompressible elasticity for a two-dimensional body occupying the rectangular domain $\\Omega = (0,2\\pi)\\times(0,2\\pi)$. Assume periodic boundary conditions on $\\partial \\Omega$ for all kinematic fields and zero-mean pressure. The material behavior is governed by a shear modulus $\\mu>0$ and the incompressibility constraint. Start from the principle of virtual work, the small-strain kinematics $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})$, and the incompressibility constraint $\\nabla\\cdot \\boldsymbol{u} = 0$, and introduce a Lagrange multiplier field to enforce incompressibility.\n\nTasks:\n- Derive the mixed weak form of the incompressible elasticity problem by identifying appropriate function spaces $V$ and $Q$ that incorporate the boundary conditions and uniqueness conditions, and by expressing the bilinear and linear forms that appear in the resulting saddle-point problem. Clearly distinguish the deviatoric contribution of the strain. You may take the deviatoric part of any second-order tensor $A$ in spatial dimension $d$ to be $A^{\\text{d}} = A - \\tfrac{1}{d}\\operatorname{tr}(A)\\boldsymbol{I}$, and here use $d=2$.\n- Briefly explain, at the continuous level, how the Enhanced Assumed Strain (EAS) method enriches the strain space to alleviate volumetric locking and how this relates to the mixed formulation you have derived. No computation is required for this explanatory part.\n- Now fix the function spaces for this periodic setting as\n  - $V = \\{\\, \\boldsymbol{w} \\in [H^{1}_{\\mathrm{per}}(\\Omega)]^{2} : \\int_{\\Omega} \\boldsymbol{w}\\, \\mathrm{d}\\Omega = 0 \\,\\}$,\n  - $Q = L^{2}_{0}(\\Omega) = \\{\\, p \\in L^{2}(\\Omega) : \\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0 \\,\\}$,\n  and the bilinear form $b(\\cdot,\\cdot)$ that couples the divergence constraint with the pressure field as obtained in your derivation.\n- Using your $b(\\cdot,\\cdot)$ and the $H^{1}$- and $L^{2}$-norms defined by $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}^{2} = \\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^{2} + \\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^{2}$ and $\\|p\\|_{L^{2}(\\Omega)}^{2} = \\int_{\\Omega} p^{2}\\, \\mathrm{d}\\Omega$, compute the value of the following inf-sup quotient for the specific pair\n  - $\\boldsymbol{w}(x,y) = \\big(-\\tfrac{1}{2}\\cos x \\cos y,\\; \\tfrac{1}{2}\\sin x \\sin y\\big)$,\n  - $p(x,y) = \\sin x \\cos y$,\n  on $\\Omega$:\n  $$\\beta_{\\star} \\;=\\; \\frac{\\left|\\, b(\\boldsymbol{w},p) \\,\\right|}{\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}\\, \\|p\\|_{L^{2}(\\Omega)}}.$$\nProvide your final answer for $\\beta_{\\star}$ in exact, fully simplified analytic form. Do not round or approximate.", "solution": "The problem is evaluated to be scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. Therefore, it is deemed valid.\n\nThe problem is addressed in three parts as requested: derivation of the mixed weak form, explanation of the Enhanced Assumed Strain (EAS) method, and computation of the inf-sup quotient $\\beta_{\\star}$ for a specific pair of functions.\n\n**Part 1: Derivation of the Mixed Weak Form**\n\nWe begin with the principle of virtual work for a body $\\Omega$ with no body forces and periodic boundary conditions, which nullifies boundary integrals of tractions. The principle states that the internal virtual work is zero for any kinematically admissible virtual displacement $\\boldsymbol{w}$:\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\, \\mathrm{d}\\Omega = 0\n$$\nHere, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) = \\frac{1}{2}(\\nabla \\boldsymbol{w} + (\\nabla \\boldsymbol{w})^{\\top})$ is the virtual strain tensor corresponding to the virtual displacement field $\\boldsymbol{w}$.\n\nFor an incompressible elastic material, the stress tensor $\\boldsymbol{\\sigma}$ is decomposed into its deviatoric part $\\boldsymbol{\\sigma}'$ and a hydrostatic part determined by the pressure $p$, which acts as a Lagrange multiplier to enforce the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = 0$. The constitutive relation is:\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}' - p\\boldsymbol{I} = 2\\mu\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) - p\\boldsymbol{I}\n$$\nwhere $\\mu > 0$ is the shear modulus, $\\boldsymbol{I}$ is the identity tensor, and $\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u})$ is the deviatoric part of the strain tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$. In two dimensions ($d=2$), the deviatoric part of a tensor $A$ is given by $A^{\\text{d}} = A - \\frac{1}{2}\\operatorname{tr}(A)\\boldsymbol{I}$. The solution for the displacement field $\\boldsymbol{u}$ must satisfy the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) = 0$. Consequently, the strain tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ is purely deviatoric, i.e., $\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) = \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}))\\boldsymbol{I} = \\boldsymbol{\\varepsilon}(\\boldsymbol{u})$.\n\nSubstituting the constitutive law into the principle of virtual work:\n$$\n\\int_{\\Omega} (2\\mu\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) - p\\boldsymbol{I}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\, \\mathrm{d}\\Omega = 0\n$$\nUsing the linearity of the trace and the inner product, this becomes:\n$$\n\\int_{\\Omega} 2\\mu\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\, \\mathrm{d}\\Omega - \\int_{\\Omega} p (\\boldsymbol{I} : \\boldsymbol{\\varepsilon}(\\boldsymbol{w})) \\, \\mathrm{d}\\Omega = 0\n$$\nWe note that $\\boldsymbol{I} : \\boldsymbol{\\varepsilon}(\\boldsymbol{w}) = \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{w})) = \\nabla \\cdot \\boldsymbol{w}$. Also, for the solution $\\boldsymbol{u}$, $\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) = \\boldsymbol{\\varepsilon}(\\boldsymbol{u})$. The term $\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{w})$ can be expanded by decomposing $\\boldsymbol{\\varepsilon}(\\boldsymbol{w})$ into its deviatoric and volumetric parts: $\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) = \\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{w}) + \\frac{1}{2}(\\nabla \\cdot \\boldsymbol{w})\\boldsymbol{I}$.\n$$\n\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{w}) = \\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\left(\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{w}) + \\frac{1}{2}(\\nabla \\cdot \\boldsymbol{w})\\boldsymbol{I}\\right) = \\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{w}) + \\frac{1}{2}(\\nabla \\cdot \\boldsymbol{w}) (\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{I})\n$$\nSince $\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u})$ is deviatoric, its trace is zero, so $\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u})) = 0$. Thus, $\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{w}) = \\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{w})$.\n\nThe first equation of our weak form is:\n$$\n\\int_{\\Omega} 2\\mu\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{w}) \\, \\mathrm{d}\\Omega - \\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}\\Omega = 0\n$$\nThe second equation arises from the weak enforcement of the incompressibility constraint. We multiply $\\nabla \\cdot \\boldsymbol{u} = 0$ by a test function for the pressure, $q$, and integrate over $\\Omega$:\n$$\n\\int_{\\Omega} q (\\nabla \\cdot \\boldsymbol{u}) \\, \\mathrm{d}\\Omega = 0\n$$\nTo establish a symmetric saddle-point structure, it is conventional to introduce a minus sign. The choice of sign is a convention, but we will define our forms to match a common structure. Let's define the bilinear forms:\n$a(\\boldsymbol{u}, \\boldsymbol{w}) = \\int_{\\Omega} 2\\mu\\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}^{\\text{d}}(\\boldsymbol{w}) \\, \\mathrm{d}\\Omega$\n$b(\\boldsymbol{w}, p) = -\\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}\\Omega$\n\nThe mixed variational problem is to find $(\\boldsymbol{u}, p) \\in V \\times Q$ such that:\n$$\n\\begin{cases}\na(\\boldsymbol{u}, \\boldsymbol{w}) + b(\\boldsymbol{w}, p) = 0 & \\forall \\boldsymbol{w} \\in V \\\\\nb(\\boldsymbol{u}, q) = 0 & \\forall q \\in Q\n\\end{cases}\n$$\nThe function spaces $V$ and $Q$ must be chosen to ensure well-posedness and incorporate the boundary and uniqueness conditions. For the displacement field $\\boldsymbol{u}$ and test function $\\boldsymbol{w}$, we need square-integrable first derivatives, periodic boundary conditions, and a zero-mean condition to remove rigid body translations. For the pressure $p$ and its test function $q$, we require square-integrability and a zero-mean condition to ensure uniqueness. Thus, the appropriate spaces are:\n$V = \\{\\boldsymbol{w} \\in [H^{1}_{\\mathrm{per}}(\\Omega)]^{2} : \\int_{\\Omega} \\boldsymbol{w}\\, \\mathrm{d}\\Omega = 0 \\}$\n$Q = L^{2}_{0}(\\Omega) = \\{p \\in L^{2}(\\Omega) : \\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0 \\}$\n\n**Part 2: Explanation of the Enhanced Assumed Strain (EAS) Method**\n\nAt the continuous level, volumetric locking is a pathology that arises in the finite element discretization of problems with constraints, like incompressibility. Standard low-order displacement-based elements are too \"stiff\" because the discrete space for displacements cannot accurately represent the divergence-free fields required by the constraint. This results in a solution that is overly constrained, often leading to a pressure field that oscillates wildly and a displacement field that is trivially zero or near-zero.\n\nThe Enhanced Assumed Strain (EAS) method addresses this issue by enriching the strain field formulation directly, rather than by introducing a separate pressure field. The strain tensor $\\boldsymbol{\\varepsilon}$ within each element is decomposed into a compatible part, $\\boldsymbol{\\varepsilon}^{\\text{disp}}$, derived from the nodal displacements, and an incompatible, enhanced part, $\\tilde{\\boldsymbol{\\varepsilon}}$:\n$$\n\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{\\text{disp}} + \\tilde{\\boldsymbol{\\varepsilon}}\n$$\nThe enhanced strain $\\tilde{\\boldsymbol{\\varepsilon}}$ is chosen from a space of functions defined locally on the element. It is not required to be derivable from a continuous displacement field, hence \"incompatible\". To ensure consistency and convergence (specifically, to pass the patch test), the enhanced strain is required to be orthogonal to the space of constant stresses over the element domain $K$, leading to the condition $\\int_{K} \\tilde{\\boldsymbol{\\varepsilon}} \\, \\mathrm{d}V = 0$.\n\nIn the context of incompressibility, the enhancement is targeted at the volumetric part of the strain. By enriching the volumetric strain, the element gains the flexibility needed to satisfy the incompressibility constraint in a weak sense without locking. This enriched kinematic description allows for a more accurate representation of the nearly-divergence-free deformation modes.\n\nThe connection to the mixed formulation is deep. The parameters defining the enhanced strain field $\\tilde{\\boldsymbol{\\varepsilon}}$ act as internal degrees of freedom that can be statically condensed at the element level. It can be shown that for specific choices of enhancement spaces, the EAS method is mathematically equivalent to certain stable mixed $u/p$ formulations. The Lagrange multipliers associated with the orthogonality constraint on $\\tilde{\\boldsymbol{\\varepsilon}}$ play a role analogous to the pressure variable $p$ in the mixed method.\n\n**Part 3: Computation of the Inf-Sup Quotient $\\beta_{\\star}$**\n\nWe are asked to compute the value of $\\beta_{\\star} = \\frac{|b(\\boldsymbol{w},p)|}{\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)} \\|p\\|_{L^{2}(\\Omega)}}$ for the specific functions:\n$\\boldsymbol{w}(x,y) = (-\\frac{1}{2}\\cos x \\cos y, \\frac{1}{2}\\sin x \\sin y)$\n$p(x,y) = \\sin x \\cos y$\non the domain $\\Omega = (0, 2\\pi) \\times (0, 2\\pi)$. The bilinear form is $b(\\boldsymbol{w},p) = -\\int_{\\Omega} p(\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}\\Omega$.\n\nStep 1: Compute the numerator, $|b(\\boldsymbol{w},p)|$.\nFirst, we find the divergence of $\\boldsymbol{w}$:\n$$\n\\nabla \\cdot \\boldsymbol{w} = \\frac{\\partial w_1}{\\partial x} + \\frac{\\partial w_2}{\\partial y} = \\frac{\\partial}{\\partial x}\\left(-\\frac{1}{2}\\cos x \\cos y\\right) + \\frac{\\partial}{\\partial y}\\left(\\frac{1}{2}\\sin x \\sin y\\right)\n$$\n$$\n\\nabla \\cdot \\boldsymbol{w} = \\frac{1}{2}\\sin x \\cos y + \\frac{1}{2}\\sin x \\cos y = \\sin x \\cos y\n$$\nNow, we compute $b(\\boldsymbol{w},p)$:\n$$\nb(\\boldsymbol{w},p) = - \\int_0^{2\\pi} \\int_0^{2\\pi} (\\sin x \\cos y)(\\sin x \\cos y) \\, dx dy = - \\int_0^{2\\pi} \\sin^2 x \\, dx \\int_0^{2\\pi} \\cos^2 y \\, dy\n$$\nUsing the identities $\\int_0^{2\\pi} \\sin^2\\theta \\, d\\theta = \\pi$ and $\\int_0^{2\\pi} \\cos^2\\theta \\, d\\theta = \\pi$:\n$$\nb(\\boldsymbol{w},p) = -(\\pi)(\\pi) = -\\pi^2\n$$\nThe numerator is $|b(\\boldsymbol{w},p)| = |-\\pi^2| = \\pi^2$.\n\nStep 2: Compute the denominator, $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}\\|p\\|_{L^{2}(\\Omega)}$.\nFirst, we compute $\\|p\\|_{L^{2}(\\Omega)}$:\n$$\n\\|p\\|_{L^{2}(\\Omega)}^2 = \\int_{\\Omega} p^2 \\, \\mathrm{d}\\Omega = \\int_0^{2\\pi} \\int_0^{2\\pi} (\\sin x \\cos y)^2 \\, dx dy\n$$\n$$\n\\|p\\|_{L^{2}(\\Omega)}^2 = \\int_0^{2\\pi} \\sin^2 x \\, dx \\int_0^{2\\pi} \\cos^2 y \\, dy = (\\pi)(\\pi) = \\pi^2\n$$\nSo, $\\|p\\|_{L^{2}(\\Omega)} = \\sqrt{\\pi^2} = \\pi$.\n\nNext, we compute $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}$. The norm is defined by $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}^2 = \\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 + \\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2$.\nWe compute the $L^2$ norm of $\\boldsymbol{w}$:\n$$\n\\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\int_{\\Omega} (w_1^2 + w_2^2) \\, \\mathrm{d}\\Omega = \\int_0^{2\\pi}\\int_0^{2\\pi} \\left( \\left(-\\frac{1}{2}\\cos x \\cos y\\right)^2 + \\left(\\frac{1}{2}\\sin x \\sin y\\right)^2 \\right) \\, dx dy\n$$\n$$\n\\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{4} \\int_0^{2\\pi}\\int_0^{2\\pi} (\\cos^2 x \\cos^2 y + \\sin^2 x \\sin^2 y) \\, dx dy\n$$\n$$\n\\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{4} \\left( \\int_0^{2\\pi}\\cos^2 x dx \\int_0^{2\\pi}\\cos^2 y dy + \\int_0^{2\\pi}\\sin^2 x dx \\int_0^{2\\pi}\\sin^2 y dy \\right)\n$$\n$$\n\\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{4} ((\\pi)(\\pi) + (\\pi)(\\pi)) = \\frac{2\\pi^2}{4} = \\frac{\\pi^2}{2}\n$$\nNow we compute the $L^2$ norm of the gradient of $\\boldsymbol{w}$:\nThe gradient is $\\nabla \\boldsymbol{w} = \\begin{pmatrix} \\partial_x w_1 & \\partial_y w_1 \\\\ \\partial_x w_2 & \\partial_y w_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}\\sin x \\cos y & \\frac{1}{2}\\cos x \\sin y \\\\ \\frac{1}{2}\\cos x \\sin y & \\frac{1}{2}\\sin x \\cos y \\end{pmatrix}$.\n$$\n\\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\int_{\\Omega} (\\nabla \\boldsymbol{w} : \\nabla \\boldsymbol{w}) \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\left( (\\partial_x w_1)^2 + (\\partial_y w_1)^2 + (\\partial_x w_2)^2 + (\\partial_y w_2)^2 \\right) \\, \\mathrm{d}\\Omega\n$$\n$$\n\\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\int_0^{2\\pi}\\int_0^{2\\pi} \\frac{1}{4} \\left( (\\sin^2 x \\cos^2 y) + (\\cos^2 x \\sin^2 y) + (\\cos^2 x \\sin^2 y) + (\\sin^2 x \\cos^2 y) \\right) \\, dx dy\n$$\n$$\n\\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{2} \\int_0^{2\\pi}\\int_0^{2\\pi} (\\sin^2 x \\cos^2 y + \\cos^2 x \\sin^2 y) \\, dx dy\n$$\n$$\n\\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{2} \\left( \\int\\sin^2 x dx \\int\\cos^2 y dy + \\int\\cos^2 x dx \\int\\sin^2 y dy \\right)\n= \\frac{1}{2} ((\\pi)(\\pi) + (\\pi)(\\pi)) = \\pi^2\n$$\nCombining the terms for the $H^1$ norm:\n$$\n\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}^2 = \\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 + \\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{\\pi^2}{2} + \\pi^2 = \\frac{3\\pi^2}{2}\n$$\nSo, $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)} = \\sqrt{\\frac{3\\pi^2}{2}} = \\pi\\sqrt{\\frac{3}{2}}$.\n\nStep 3: Calculate $\\beta_{\\star}$.\n$$\n\\beta_{\\star} = \\frac{|b(\\boldsymbol{w},p)|}{\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)} \\|p\\|_{L^{2}(\\Omega)}} = \\frac{\\pi^2}{\\left(\\pi\\sqrt{\\frac{3}{2}}\\right)(\\pi)} = \\frac{\\pi^2}{\\pi^2\\sqrt{\\frac{3}{2}}} = \\frac{1}{\\sqrt{\\frac{3}{2}}} = \\sqrt{\\frac{2}{3}}\n$$\nSimplifying the final result:\n$$\n\\beta_{\\star} = \\frac{\\sqrt{2}}{\\sqrt{3}} = \\frac{\\sqrt{6}}{3}\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{6}}{3}}$$", "id": "3582046"}, {"introduction": "The Enhanced Assumed Strain (EAS) method provides a powerful alternative to mixed $u/p$ formulations, especially in nonlinear analysis. To harness its full potential within a Newton-Raphson solution scheme, it is crucial to derive the consistent tangent operator to preserve quadratic convergence. This advanced exercise [@problem_id:3582049] walks you through the linearization and static condensation procedure to obtain the condensed tangent matrix for a nonlinear EAS element, a cornerstone of its practical implementation.", "problem": "Consider a single finite element in a mixed variational formulation employing the Enhanced Assumed Strain (EAS) method for a small-strain hyperelastic solid. Let the element domain be denoted by $\\Omega_{e} \\subset \\mathbb{R}^{d}$, with $d \\in \\{2,3\\}$. The compatible strain field is $\\boldsymbol{\\varepsilon}^{c}(\\boldsymbol{u}) = \\boldsymbol{B}(\\boldsymbol{x}) \\boldsymbol{u}$, where $\\boldsymbol{u}$ is the vector of nodal displacements and $\\boldsymbol{B}(\\boldsymbol{x})$ is the standard strain-displacement matrix. The enhanced strain field is assumed as $\\boldsymbol{\\varepsilon}^{e}(\\boldsymbol{\\alpha}) = \\boldsymbol{E}(\\boldsymbol{x}) \\boldsymbol{\\alpha}$, where $\\boldsymbol{\\alpha}$ is the vector of internal EAS parameters and $\\boldsymbol{E}(\\boldsymbol{x})$ is a prescribed, element-local strain interpolation operator that vanishes on $\\partial \\Omega_{e}$ in the sense of virtual work. The total strain is $\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\boldsymbol{\\varepsilon}^{c}(\\boldsymbol{u}) + \\boldsymbol{\\varepsilon}^{e}(\\boldsymbol{\\alpha})$.\n\nAssume a hyperelastic stored energy density $\\Psi(\\boldsymbol{\\varepsilon})$ so that the Cauchy stress satisfies $\\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon}) = \\partial \\Psi / \\partial \\boldsymbol{\\varepsilon}$ and the consistent material tangent operator is $\\mathbb{C}_{t}(\\boldsymbol{\\varepsilon}) = \\partial^{2} \\Psi / \\partial \\boldsymbol{\\varepsilon} \\, \\partial \\boldsymbol{\\varepsilon}$, both evaluated at the current iterate. The total potential energy of the element is\n$$\n\\Pi(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\int_{\\Omega_{e}} \\Psi\\!\\left(\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha})\\right) \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\! \\cdot \\boldsymbol{u},\n$$\nwhere $\\boldsymbol{f}_{e}^{\\mathrm{ext}}$ is the external nodal force vector assembled over $\\Omega_{e}$.\n\nStarting from the principle of stationary potential energy, derive the mixed residual equations for $\\boldsymbol{u}$ and $\\boldsymbol{\\alpha}$, and perform an exact first-order linearization with respect to $(\\boldsymbol{u},\\boldsymbol{\\alpha})$ to obtain the block Newton system for the element. Then, to preserve quadratic Newton convergence under static condensation, condense the internal EAS parameters at the tangent level by eliminating $\\Delta \\boldsymbol{\\alpha}$ from the block system. Compute the resulting consistent tangent matrix of the condensed displacement-only system in closed form. Express your final answer as a single analytic expression in terms of the block tangent matrices emerging from the linearization.\n\nNo numerical evaluation is required. Your final expression must be analytic and self-contained. Do not include any units in the final expression. If you introduce any new acronyms beyond Enhanced Assumed Strain (EAS), define them upon first use.", "solution": "The problem is valid as it is scientifically grounded in the principles of computational solid mechanics, is well-posed, and uses objective, formal language. It presents a standard derivation task in the context of advanced finite element methods.\n\nThe starting point for the derivation is the principle of stationary potential energy applied to the provided functional for a single finite element. The total potential energy, $\\Pi$, is a function of the nodal displacements $\\boldsymbol{u}$ and the internal Enhanced Assumed Strain (EAS) parameters $\\boldsymbol{\\alpha}$:\n$$\n\\Pi(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\int_{\\Omega_{e}} \\Psi\\!\\left(\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha})\\right) \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\! \\cdot \\boldsymbol{u}\n$$\nThe total strain $\\boldsymbol{\\varepsilon}$ is the sum of the compatible strain $\\boldsymbol{\\varepsilon}^{c}(\\boldsymbol{u}) = \\boldsymbol{B}(\\boldsymbol{x}) \\boldsymbol{u}$ and the enhanced strain $\\boldsymbol{\\varepsilon}^{e}(\\boldsymbol{\\alpha}) = \\boldsymbol{E}(\\boldsymbol{x}) \\boldsymbol{\\alpha}$.\n\nThe principle of stationary potential energy requires that the first variation of $\\Pi$ vanishes for any admissible variations $\\delta\\boldsymbol{u}$ and $\\delta\\boldsymbol{\\alpha}$:\n$$\n\\delta \\Pi(\\boldsymbol{u},\\boldsymbol{\\alpha}) = 0\n$$\nWe compute the variation as:\n$$\n\\delta \\Pi = \\int_{\\Omega_{e}} \\frac{\\partial \\Psi}{\\partial \\boldsymbol{\\varepsilon}} : \\delta \\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\! \\cdot \\delta \\boldsymbol{u}\n$$\nGiven that $\\boldsymbol{\\sigma} = \\partial \\Psi / \\partial \\boldsymbol{\\varepsilon}$ and $\\delta\\boldsymbol{\\varepsilon} = \\delta\\boldsymbol{\\varepsilon}^{c} + \\delta\\boldsymbol{\\varepsilon}^{e} = \\boldsymbol{B}\\delta\\boldsymbol{u} + \\boldsymbol{E}\\delta\\boldsymbol{\\alpha}$, we can write:\n$$\n\\delta \\Pi = \\int_{\\Omega_{e}} \\boldsymbol{\\sigma} : (\\boldsymbol{B}\\delta\\boldsymbol{u} + \\boldsymbol{E}\\delta\\boldsymbol{\\alpha}) \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\! \\cdot \\delta \\boldsymbol{u}\n$$\nUsing the properties of the dot product and matrix-vector multiplication, this is rearranged to group terms in $\\delta\\boldsymbol{u}$ and `\\delta\\boldsymbol{\\alpha}`:\n$$\n\\delta \\Pi = \\left( \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\boldsymbol{\\sigma} \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\right) \\cdot \\delta\\boldsymbol{u} + \\left( \\int_{\\Omega_{e}} \\boldsymbol{E}^{\\top} \\boldsymbol{\\sigma} \\, \\mathrm{d}\\Omega \\right) \\cdot \\delta\\boldsymbol{\\alpha} = 0\n$$\nSince the variations $\\delta\\boldsymbol{u}$ and $\\delta\\boldsymbol{\\alpha}$ are independent and arbitrary, their respective coefficients must vanish. This yields the system of residual equations:\n$$\n\\boldsymbol{r}_{u}(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha})) \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} = \\boldsymbol{0}\n$$\n$$\n\\boldsymbol{r}_{\\alpha}(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\int_{\\Omega_{e}} \\boldsymbol{E}^{\\top} \\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha})) \\, \\mathrm{d}\\Omega = \\boldsymbol{0}\n$$\nThe first equation represents the balance of nodal forces, while the second enforces the orthogonality between the stress field and the enhanced strain modes.\n\nTo solve this nonlinear system using the Newton-Raphson method, we linearize the residuals at the current iterate $(\\boldsymbol{u}, \\boldsymbol{\\alpha})$ to find the corrections $(\\Delta\\boldsymbol{u}, \\Delta\\boldsymbol{\\alpha})$. The linearized system is given by:\n$$\n\\boldsymbol{r}_{u} + \\mathrm{D}\\boldsymbol{r}_{u}[\\Delta\\boldsymbol{u}, \\Delta\\boldsymbol{\\alpha}] = \\boldsymbol{0}\n$$\n$$\n\\boldsymbol{r}_{\\alpha} + \\mathrm{D}\\boldsymbol{r}_{\\alpha}[\\Delta\\boldsymbol{u}, \\Delta\\boldsymbol{\\alpha}] = \\boldsymbol{0}\n$$\nwhere $\\mathrm{D}\\boldsymbol{r}[\\cdot]$ denotes the directional derivative (or Gâteaux derivative). This can be written in a block matrix form:\n$$\n\\begin{bmatrix} \\frac{\\partial \\boldsymbol{r}_{u}}{\\partial \\boldsymbol{u}} & \\frac{\\partial \\boldsymbol{r}_{u}}{\\partial \\boldsymbol{\\alpha}} \\\\ \\frac{\\partial \\boldsymbol{r}_{\\alpha}}{\\partial \\boldsymbol{u}} & \\frac{\\partial \\boldsymbol{r}_{\\alpha}}{\\partial \\boldsymbol{\\alpha}} \\end{bmatrix} \\begin{pmatrix} \\Delta\\boldsymbol{u} \\\\ \\Delta\\boldsymbol{\\alpha} \\end{pmatrix} = - \\begin{pmatrix} \\boldsymbol{r}_{u} \\\\ \\boldsymbol{r}_{\\alpha} \\end{pmatrix}\n$$\nThe blocks of the tangent stiffness matrix are calculated by taking the directional derivatives of the residuals. The variation of stress is $\\mathrm{D}\\boldsymbol{\\sigma}[\\Delta\\boldsymbol{\\varepsilon}] = \\frac{\\partial\\boldsymbol{\\sigma}}{\\partial\\boldsymbol{\\varepsilon}}\\Delta\\boldsymbol{\\varepsilon} = \\mathbb{C}_{t}\\Delta\\boldsymbol{\\varepsilon}$, where $\\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{B}\\Delta\\boldsymbol{u} + \\boldsymbol{E}\\Delta\\boldsymbol{\\alpha}$.\n\nThe four blocks of the tangent matrix, which we denote as $\\boldsymbol{K}_{ij}$, are:\n$1$. $\\boldsymbol{K}_{uu} = \\frac{\\partial \\boldsymbol{r}_{u}}{\\partial \\boldsymbol{u}}$: The change in $\\boldsymbol{r}_{u}$ due to a change in $\\boldsymbol{u}$ (with $\\Delta\\boldsymbol{\\alpha}=\\boldsymbol{0}$, so $\\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{B}\\Delta\\boldsymbol{u}$).\n$$\n\\boldsymbol{K}_{uu} \\Delta\\boldsymbol{u} = \\mathrm{D}\\boldsymbol{r}_{u}[\\Delta\\boldsymbol{u}] = \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\left( \\mathrm{D}\\boldsymbol{\\sigma}[\\boldsymbol{B}\\Delta\\boldsymbol{u}] \\right) \\mathrm{d}\\Omega = \\left( \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\mathbb{C}_{t} \\boldsymbol{B} \\, \\mathrm{d}\\Omega \\right) \\Delta\\boldsymbol{u}\n$$\nThus, $\\boldsymbol{K}_{uu} = \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\mathbb{C}_{t} \\boldsymbol{B} \\, \\mathrm{d}\\Omega$.\n\n$2$. $\\boldsymbol{K}_{u\\alpha} = \\frac{\\partial \\boldsymbol{r}_{u}}{\\partial \\boldsymbol{\\alpha}}$: The change in $\\boldsymbol{r}_{u}$ due to a change in $\\boldsymbol{\\alpha}$ (with $\\Delta\\boldsymbol{u}=\\boldsymbol{0}$, so $\\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{E}\\Delta\\boldsymbol{\\alpha}$).\n$$\n\\boldsymbol{K}_{u\\alpha} \\Delta\\boldsymbol{\\alpha} = \\mathrm{D}\\boldsymbol{r}_{u}[\\Delta\\boldsymbol{\\alpha}] = \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\left( \\mathrm{D}\\boldsymbol{\\sigma}[\\boldsymbol{E}\\Delta\\boldsymbol{\\alpha}] \\right) \\mathrm{d}\\Omega = \\left( \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\mathbb{C}_{t} \\boldsymbol{E} \\, \\mathrm{d}\\Omega \\right) \\Delta\\boldsymbol{\\alpha}\n$$\nThus, $\\boldsymbol{K}_{u\\alpha} = \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\mathbb{C}_{t} \\boldsymbol{E} \\, \\mathrm{d}\\Omega$.\n\n$3$. $\\boldsymbol{K}_{\\alpha u} = \\frac{\\partial \\boldsymbol{r}_{\\alpha}}{\\partial \\boldsymbol{u}}$: The change in $\\boldsymbol{r}_{\\alpha}$ due to a change in $\\boldsymbol{u}$ (with $\\Delta\\boldsymbol{\\alpha}=\\boldsymbol{0}$, so $\\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{B}\\Delta\\boldsymbol{u}$).\n$$\n\\boldsymbol{K}_{\\alpha u} \\Delta\\boldsymbol{u} = \\mathrm{D}\\boldsymbol{r}_{\\alpha}[\\Delta\\boldsymbol{u}] = \\int_{\\Omega_{e}} \\boldsymbol{E}^{\\top} \\left( \\mathrm{D}\\boldsymbol{\\sigma}[\\boldsymbol{B}\\Delta\\boldsymbol{u}] \\right) \\mathrm{d}\\Omega = \\left( \\int_{\\Omega_{e}} \\boldsymbol{E}^{\\top} \\mathbb{C}_{t} \\boldsymbol{B} \\, \\mathrm{d}\\Omega \\right) \\Delta\\boldsymbol{u}\n$$\nThus, $\\boldsymbol{K}_{\\alpha u} = \\int_{\\Omega_{e}} \\boldsymbol{E}^{\\top} \\mathbb{C}_{t} \\boldsymbol{B} \\, \\mathrm{d}\\Omega$. Note that due to the major symmetry of $\\mathbb{C}_{t}$, $\\boldsymbol{K}_{\\alpha u} = \\boldsymbol{K}_{u\\alpha}^{\\top}$.\n\n$4$. $\\boldsymbol{K}_{\\alpha\\alpha} = \\frac{\\partial \\boldsymbol{r}_{\\alpha}}{\\partial \\boldsymbol{\\alpha}}$: The change in $\\boldsymbol{r}_{\\alpha}$ due to a change in $\\boldsymbol{\\alpha}$ (with $\\Delta\\boldsymbol{u}=\\boldsymbol{0}$, so $\\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{E}\\Delta\\boldsymbol{\\alpha}$).\n$$\n\\boldsymbol{K}_{\\alpha\\alpha} \\Delta\\boldsymbol{\\alpha} = \\mathrm{D}\\boldsymbol{r}_{\\alpha}[\\Delta\\boldsymbol{\\alpha}] = \\int_{\\Omega_{e}} \\boldsymbol{E}^{\\top} \\left( \\mathrm{D}\\boldsymbol{\\sigma}[\\boldsymbol{E}\\Delta\\boldsymbol{\\alpha}] \\right) \\mathrm{d}\\Omega = \\left( \\int_{\\Omega_{e}} \\boldsymbol{E}^{\\top} \\mathbb{C}_{t} \\boldsymbol{E} \\, \\mathrm{d}\\Omega \\right) \\Delta\\boldsymbol{\\alpha}\n$$\nThus, $\\boldsymbol{K}_{\\alpha\\alpha} = \\int_{\\Omega_{e}} \\boldsymbol{E}^{\\top} \\mathbb{C}_{t} \\boldsymbol{E} \\, \\mathrm{d}\\Omega$.\n\nThe full linearized system is:\n$$\n\\boldsymbol{K}_{uu} \\Delta\\boldsymbol{u} + \\boldsymbol{K}_{u\\alpha} \\Delta\\boldsymbol{\\alpha} = -\\boldsymbol{r}_{u}\n$$\n$$\n\\boldsymbol{K}_{\\alpha u} \\Delta\\boldsymbol{u} + \\boldsymbol{K}_{\\alpha\\alpha} \\Delta\\boldsymbol{\\alpha} = -\\boldsymbol{r}_{\\alpha}\n$$\nTo condense the system, we eliminate the internal parameters $\\Delta\\boldsymbol{\\alpha}$ at the tangent level. From the second equation, we solve for $\\Delta\\boldsymbol{\\alpha}$, assuming $\\boldsymbol{K}_{\\alpha\\alpha}$ is invertible:\n$$\n\\Delta\\boldsymbol{\\alpha} = -\\boldsymbol{K}_{\\alpha\\alpha}^{-1} ( \\boldsymbol{r}_{\\alpha} + \\boldsymbol{K}_{\\alpha u} \\Delta\\boldsymbol{u} )\n$$\nSubstituting this expression for $\\Delta\\boldsymbol{\\alpha}$ into the first equation:\n$$\n\\boldsymbol{K}_{uu} \\Delta\\boldsymbol{u} + \\boldsymbol{K}_{u\\alpha} \\left( -\\boldsymbol{K}_{\\alpha\\alpha}^{-1} ( \\boldsymbol{r}_{\\alpha} + \\boldsymbol{K}_{\\alpha u} \\Delta\\boldsymbol{u} ) \\right) = -\\boldsymbol{r}_{u}\n$$\nRearranging to group terms involving $\\Delta\\boldsymbol{u}$:\n$$\n( \\boldsymbol{K}_{uu} - \\boldsymbol{K}_{u\\alpha} \\boldsymbol{K}_{\\alpha\\alpha}^{-1} \\boldsymbol{K}_{\\alpha u} ) \\Delta\\boldsymbol{u} = -\\boldsymbol{r}_{u} + \\boldsymbol{K}_{u\\alpha} \\boldsymbol{K}_{\\alpha\\alpha}^{-1} \\boldsymbol{r}_{\\alpha}\n$$\nThis equation is of the form $\\boldsymbol{K}_{\\text{cond}} \\Delta\\boldsymbol{u} = -\\boldsymbol{r}_{\\text{cond}}$, where $\\boldsymbol{K}_{\\text{cond}}$ is the condensed tangent matrix (also known as the consistent tangent operator or the Schur complement of $\\boldsymbol{K}_{\\alpha\\alpha}$), and $\\boldsymbol{r}_{\\text{cond}}$ is the condensed residual vector.\n\nThe problem asks for the consistent tangent matrix of the condensed displacement-only system. This is the operator multiplying $\\Delta\\boldsymbol{u}$:\n$$\n\\boldsymbol{K}_{\\text{cond}} = \\boldsymbol{K}_{uu} - \\boldsymbol{K}_{u\\alpha} \\boldsymbol{K}_{\\alpha\\alpha}^{-1} \\boldsymbol{K}_{\\alpha u}\n$$\nThis expression represents the final condensed tangent matrix, which preserves the quadratic convergence of the Newton-Raphson method when the internal EAS parameters are eliminated.", "answer": "$$\n\\boxed{\\boldsymbol{K}_{uu} - \\boldsymbol{K}_{u\\alpha} \\boldsymbol{K}_{\\alpha\\alpha}^{-1} \\boldsymbol{K}_{\\alpha u}}\n$$", "id": "3582049"}]}