{"hands_on_practices": [{"introduction": "The foundation of logarithmic strain space algorithms is the Hencky strain tensor, defined as the matrix logarithm of the right stretch tensor, $E = \\ln U$. This first exercise solidifies the computational procedure for this key kinematic variable and prompts you to explore its behavior at the limits of extreme deformation—a critical consideration for robust numerical implementations. [@problem_id:3579140]", "problem": "Consider a homogeneous deformation with deformation gradient $F \\in \\mathbb{R}^{3 \\times 3}$ admitting the polar decomposition $F = R U$, where $R \\in \\mathrm{SO}(3)$ is a proper orthogonal tensor and $U \\in \\mathbb{R}^{3 \\times 3}$ is the right stretch tensor. Assume $U$ is symmetric positive definite (SPD) with principal stretches $\\lambda_{1} > 0$, $\\lambda_{2} > 0$, and $\\lambda_{3} > 0$, and that an orthonormal basis exists in which $U$ is diagonal, $U = \\mathrm{diag}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$. In logarithmic strain space algorithms, the Hencky (logarithmic) strain tensor is defined by the matrix logarithm of the stretch, $\\ln U$.\n\nStarting from the spectral characterization of analytic functions of SPD tensors and the properties of the natural logarithm on $(0,\\infty)$, compute the matrix logarithm $\\ln U$ in closed form for the given diagonal $U$. In addition, explain, based on first principles of numerical analysis and calculus, the qualitative behavior and numerical implications when any $\\lambda_{i}$ approaches zero or becomes very large in computations that form $\\ln U$ and its algorithmic tangent. Your final answer must be the single analytical expression for $\\ln U$. No rounding is required, and no physical units are involved.", "solution": "The problem statement is valid. It is scientifically grounded in continuum mechanics, well-posed, and presented with objective, precise language. All provided information is self-consistent and sufficient for deriving a solution.\n\nThe primary task is to compute the Hencky strain tensor, defined as the matrix logarithm $\\ln U$, where $U$ is the symmetric positive definite (SPD) right stretch tensor. We are given that in some orthonormal basis, $U$ is diagonal, $U = \\mathrm{diag}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$, where $\\lambda_{i} > 0$ are the principal stretches.\n\nThe computation of a function of a matrix, such as $\\ln U$, is defined through its spectral decomposition. For a symmetric (and thus diagonalizable) matrix $U$, the spectral theorem states that it can be written as:\n$$\nU = \\sum_{i=1}^{3} \\lambda_{i} \\mathbf{n}_{i} \\otimes \\mathbf{n}_{i}\n$$\nwhere $\\lambda_{i}$ are the real eigenvalues (the principal stretches) and $\\mathbf{n}_{i}$ are the corresponding orthonormal eigenvectors (the principal directions of stretch).\n\nIf a scalar function $f(x)$ is analytic on the spectrum of $U$ (i.e., at all eigenvalues $\\lambda_{i}$), then the tensor-valued function $f(U)$ is defined as:\n$$\nf(U) = \\sum_{i=1}^{3} f(\\lambda_{i}) \\mathbf{n}_{i} \\otimes \\mathbf{n}_{i}\n$$\nThis is the spectral characterization of an analytic function of an SPD tensor.\n\nIn this problem, the function is the natural logarithm, $f(x) = \\ln(x)$. The domain of analyticity for $\\ln(x)$ is the set of positive real numbers, $(0, \\infty)$. Since the stretch tensor $U$ is symmetric positive definite (SPD), its eigenvalues $\\lambda_{i}$ (the principal stretches) are all strictly positive. Thus, the spectrum of $U$ lies entirely within the domain of analyticity of the natural logarithm, and $\\ln U$ is well-defined.\n\nWe are given that in the basis of its eigenvectors $\\{\\mathbf{n}_1, \\mathbf{n}_2, \\mathbf{n}_3\\}$, the matrix representation of $U$ is diagonal:\n$$\n[U] = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix}\n$$\nApplying the definition of a matrix function, we substitute $f(\\lambda_{i}) = \\ln(\\lambda_{i})$ into the spectral representation of $f(U)$. In the same orthonormal basis, the matrix representation of $\\ln U$ will be:\n$$\n[\\ln U] = \\begin{pmatrix} f(\\lambda_1) & 0 & 0 \\\\ 0 & f(\\lambda_2) & 0 \\\\ 0 & 0 & f(\\lambda_3) \\end{pmatrix} = \\begin{pmatrix} \\ln(\\lambda_1) & 0 & 0 \\\\ 0 & \\ln(\\lambda_2) & 0 \\\\ 0 & 0 & \\ln(\\lambda_3) \\end{pmatrix}\n$$\nThis is the closed-form expression for the Hencky strain tensor in the principal basis of stretch.\n\nThe second part of the problem requires an explanation of the qualitative behavior and numerical implications under extreme stretches.\n\n**Case 1: A principal stretch approaches zero ($\\lambda_{i} \\to 0^{+}$)**\nThis corresponds to a state of extreme compression, where a material element is being crushed to zero length in the direction $\\mathbf{n}_{i}$.\n*   **Qualitative Behavior**: As $\\lambda_{i} \\to 0^{+}$, the corresponding principal logarithmic strain, $\\ln(\\lambda_{i})$, approaches $-\\infty$. This correctly represents an infinite compressive strain required to achieve a volume collapse in that direction.\n*   **Numerical Implications**: Standard floating-point arithmetic cannot represent $-\\infty$ without special flags. Computations involving $\\lambda_{i}$ close to zero will cause the value of $\\ln(\\lambda_{i})$ to become a very large negative number, potentially resulting in underflow or being flagged as `-Inf`. This can propagate through the algorithm, leading to `NaN` (Not a Number) results and failure of the numerical simulation (e.g., a Newton-Raphson iterative solver). Furthermore, the algorithmic tangent modulus, which is the fourth-order tensor representing the derivative of the Kirchhoff stress with respect to the logarithmic strain, often contains terms that become singular or ill-conditioned. For instance, components of the tangent can involve expressions like $\\frac{\\ln(\\lambda_i) - \\ln(\\lambda_j)}{\\lambda_i^2 - \\lambda_j^2}$. As $\\lambda_i \\to 0^+$, the numerator diverges to $-\\infty$ while the denominator remains finite (assuming $\\lambda_j > 0$), causing these tangent components to become infinite. This leads to an ill-conditioned stiffness matrix, convergence failure, and numerical instability.\n\n**Case 2: A principal stretch becomes very large ($\\lambda_{i} \\to \\infty$)**\nThis corresponds to a state of extreme tension, where a material element is stretched indefinitely in the direction $\\mathbf{n}_{i}$.\n*   **Qualitative Behavior**: As $\\lambda_{i} \\to \\infty$, the principal logarithmic strain $\\ln(\\lambda_{i})$ also approaches $+\\infty$. The logarithmic measure means the strain grows much more slowly than the stretch itself, which is a key advantage of this strain measure for large deformation analysis.\n*   **Numerical Implications**: While $\\ln(\\lambda_{i})$ grows without bound, it does so very slowly. Numerical overflow might occur on $\\lambda_{i}$ or related quantities (like $\\lambda_i^2$) before it occurs on $\\ln(\\lambda_{i})$. The primary numerical issue again relates to the conditioning of the algorithmic tangent. In the term $\\frac{\\ln(\\lambda_i) - \\ln(\\lambda_j)}{\\lambda_i^2 - \\lambda_j^2}$, as $\\lambda_i \\to \\infty$, the denominator grows like $\\lambda_i^2$ while the numerator grows like $\\ln(\\lambda_i)$. By L'Hôpital's rule, the term approaches $0$. While this may appear stable, having some tangent components approach zero while others remain finite can still cause severe ill-conditioning. A very large disparity between eigenvalues (e.g., $\\lambda_{i} \\gg \\lambda_{j}$) makes the system numerically \"stiff,\" where the stiffness matrix has eigenvalues of vastly different magnitudes. This is notoriously difficult for iterative linear solvers to handle, leading to poor convergence rates or failure.\n\nIn summary, the logarithmic mapping poses significant numerical challenges at the extremes of deformation (both extreme compression and tension), which must be handled with specialized numerical techniques in robust computational solid mechanics codes.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\ln(\\lambda_1) & 0 & 0 \\\\\n0 & \\ln(\\lambda_2) & 0 \\\\\n0 & 0 & \\ln(\\lambda_3)\n\\end{pmatrix}\n}\n$$", "id": "3579140"}, {"introduction": "With a solid grasp of the logarithmic strain tensor, we can now formulate constitutive laws that relate strain to stress. This practice explores a standard isotropic hyperelastic model defined directly in logarithmic space, deriving the Kirchhoff stress $\\tau$ from a Helmholtz free energy potential. By analyzing two fundamental deformation modes—pure volumetric expansion and pure isochoric shear—you will see firsthand how this framework elegantly separates the material's resistance to volume change from its resistance to shape change. [@problem_id:3579134]", "problem": "Consider a compressible, isotropic, hyperelastic solid modeled in logarithmic strain space. Let $F$ denote the deformation gradient with polar decomposition $F = R V$, where $R$ is a proper orthogonal tensor and $V$ is the left stretch tensor. The logarithmic (Hencky) strain is defined as $E = \\ln V$. The deviatoric and volumetric parts of any second-order tensor $X$ are defined by $X_{\\mathrm{dev}} = X - \\frac{1}{3} \\operatorname{tr}(X) I$ and $X_{\\mathrm{vol}} = \\frac{1}{3} \\operatorname{tr}(X) I$, respectively. Assume a quadratic, isotropic Helmholtz free energy density in $E$ of the form $W(E) = \\frac{K}{2} \\left(\\operatorname{tr} E\\right)^{2} + G \\, E_{\\mathrm{dev}} : E_{\\mathrm{dev}}$, where $K$ is the bulk modulus and $G$ is the shear modulus, both strictly positive. The Kirchhoff stress $\\tau$ is work-conjugate to $E$ in the sense that $\\mathrm{d} W = \\tau : \\mathrm{d} E$ for elastic processes.\n\nTwo homogeneous deformations are considered:\n\n1. A pure volumetric expansion specified by $F_{v} = J_{v}^{1/3} I$ with $J_{v} > 1$.\n2. An isochoric pure shear stretch specified by a left stretch with principal stretches $\\lambda_{s}$, $\\lambda_{s}^{-1}$, and $1$, where $\\lambda_{s} > 1$.\n\nStarting from the above definitions and assumptions, and without invoking any unproven shortcut formulae, do the following:\n\n- Derive the constitutive relation for $\\tau$ in terms of $E$ and its deviatoric and volumetric parts based on the given $W(E)$.\n- For each deformation, compute explicitly the deviatoric and volumetric parts of $E$ and $\\tau$, expressed in a principal basis where appropriate.\n- Briefly interpret the physical consistency of the results in each case with respect to the roles of $K$ and $G$.\n\nFinally, define the scalar ratio\n$$\nR := \\frac{\\|\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}\\|}{\\|\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}\\|},\n$$\nwhere $\\|\\cdot\\|$ denotes the Frobenius norm, $\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}$ is the deviatoric Kirchhoff stress for the pure shear stretch, and $\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}$ is the volumetric part of the Kirchhoff stress for the pure volumetric expansion. Express $R$ as a closed-form analytic expression in terms of $K$, $G$, $\\lambda_{s}$, and $J_{v}$. Provide this final expression for $R$ as your answer. Do not approximate; no rounding is required. The final answer is dimensionless and must be given without units.", "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-contained. It is based on established principles of continuum mechanics and hyperelasticity. The provided definitions and conditions are sufficient and consistent for deriving a unique solution.\n\nThe first step is to derive the constitutive relation for the Kirchhoff stress $\\tau$ from the given Helmholtz free energy density $W(E)$. The free energy is given by\n$$\nW(E) = \\frac{K}{2} (\\operatorname{tr} E)^2 + G \\, E_{\\mathrm{dev}} : E_{\\mathrm{dev}}\n$$\nwhere $E$ is the logarithmic strain, $K > 0$ is the bulk modulus, and $G > 0$ is the shear modulus. The deviatoric part of $E$ is $E_{\\mathrm{dev}} = E - \\frac{1}{3} \\operatorname{tr}(E) I$. The Kirchhoff stress $\\tau$ is work-conjugate to $E$, meaning $\\tau = \\frac{\\partial W}{\\partial E}$. We can compute this derivative by considering the differential $\\mathrm{d}W$.\n\nThe total differential of $W$ is $\\mathrm{d}W = \\frac{\\partial W}{\\partial E} : \\mathrm{d}E$. We compute the differential of each term of $W$.\n\nFor the first term, the volumetric part $W_{\\mathrm{vol}} = \\frac{K}{2}(\\operatorname{tr} E)^2$:\n$$\n\\mathrm{d}W_{\\mathrm{vol}} = \\frac{K}{2} \\cdot 2(\\operatorname{tr} E) \\cdot \\mathrm{d}(\\operatorname{tr} E) = K(\\operatorname{tr} E) \\operatorname{tr}(\\mathrm{d}E)\n$$\nSince $\\operatorname{tr}(\\mathrm{d}E) = I : \\mathrm{d}E$, we have\n$$\n\\mathrm{d}W_{\\mathrm{vol}} = K(\\operatorname{tr} E) (I : \\mathrm{d}E) = (K(\\operatorname{tr} E) I) : \\mathrm{d}E\n$$\nThis implies that the volumetric part of the stress is $\\tau_{\\mathrm{vol}} = \\frac{\\partial W_{\\mathrm{vol}}}{\\partial E} = K(\\operatorname{tr} E) I$.\n\nFor the second term, the deviatoric part $W_{\\mathrm{dev}} = G E_{\\mathrm{dev}} : E_{\\mathrm{dev}}$:\n$$\n\\mathrm{d}W_{\\mathrm{dev}} = G \\,\\mathrm{d}(E_{\\mathrm{dev}} : E_{\\mathrm{dev}}) = G (2 E_{\\mathrm{dev}} : \\mathrm{d}E_{\\mathrm{dev}})\n$$\nThe differential of the deviatoric strain is $\\mathrm{d}E_{\\mathrm{dev}} = \\mathrm{d}(E - \\frac{1}{3}\\operatorname{tr}(E)I) = \\mathrm{d}E - \\frac{1}{3}\\mathrm{d}(\\operatorname{tr}(E))I = \\mathrm{d}E - \\frac{1}{3}(\\operatorname{tr}(\\mathrm{d}E))I$.\nSubstituting this into the expression for $\\mathrm{d}W_{\\mathrm{dev}}$:\n$$\n\\mathrm{d}W_{\\mathrm{dev}} = 2G E_{\\mathrm{dev}} : \\left(\\mathrm{d}E - \\frac{1}{3}(\\operatorname{tr}(\\mathrm{d}E))I\\right) = 2G (E_{\\mathrm{dev}} : \\mathrm{d}E) - \\frac{2G}{3}(\\operatorname{tr}(\\mathrm{d}E))(E_{\\mathrm{dev}} : I)\n$$\nThe trace of a deviatoric tensor is zero, so $E_{\\mathrm{dev}} : I = \\operatorname{tr}(E_{\\mathrm{dev}}) = 0$. Therefore, the second term vanishes.\n$$\n\\mathrm{d}W_{\\mathrm{dev}} = (2G E_{\\mathrm{dev}}) : \\mathrm{d}E\n$$\nThis implies that the deviatoric part of the stress is $\\tau_{\\mathrm{dev}} = \\frac{\\partial W_{\\mathrm{dev}}}{\\partial E} = 2G E_{\\mathrm{dev}}$.\n\nCombining the volumetric and deviatoric parts, the total Kirchhoff stress is\n$$\n\\tau = \\tau_{\\mathrm{vol}} + \\tau_{\\mathrm{dev}} = K (\\operatorname{tr} E) I + 2G E_{\\mathrm{dev}}\n$$\nThis is the required constitutive relation.\n\nNext, we analyze the two specified deformations.\n\n**1. Pure Volumetric Expansion**\nThe deformation gradient is $F_{v} = J_{v}^{1/3} I$, with $J_{v} > 1$. Since $F_v$ is symmetric and positive definite, the polar decomposition is $F_v = R V$ with $R=I$ and the left stretch tensor $V = F_v = J_{v}^{1/3} I$.\nThe principal stretches are all equal: $\\lambda_1 = \\lambda_2 = \\lambda_3 = J_{v}^{1/3}$.\nThe logarithmic strain $E$ is given by $E = \\ln V = \\ln(J_{v}^{1/3} I)$. For any scalar $c>0$, $\\ln(cI) = (\\ln c)I$. Thus,\n$$\nE = (\\ln J_{v}^{1/3}) I = \\frac{1}{3}(\\ln J_{v}) I\n$$\nThis is a purely volumetric strain. The trace is $\\operatorname{tr}(E) = \\operatorname{tr}(\\frac{1}{3}(\\ln J_{v}) I) = \\frac{1}{3}(\\ln J_{v}) \\operatorname{tr}(I) = \\frac{1}{3}(\\ln J_{v}) \\cdot 3 = \\ln J_{v}$.\nThe volumetric part of the strain is $E_{\\mathrm{vol}} = \\frac{1}{3}\\operatorname{tr}(E)I = \\frac{1}{3}(\\ln J_{v})I = E$.\nThe deviatoric part of the strain is $E_{\\mathrm{dev}} = E - E_{\\mathrm{vol}} = 0$.\nNow we compute the stress components using the derived constitutive law.\nThe volumetric part of the stress for this expansion, denoted $\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}$, is:\n$$\n\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})} = K (\\operatorname{tr} E) I = K (\\ln J_{v}) I\n$$\nThe deviatoric part of the stress is:\n$$\n\\tau_{\\mathrm{dev}}^{(\\mathrm{vol\\,exp})} = 2G E_{\\mathrm{dev}} = 2G(0) = 0\n$$\nThe total stress $\\tau^{(\\mathrm{vol\\,exp})} = K (\\ln J_{v}) I$ is a purely hydrostatic state. This is physically consistent: a pure change in volume in an isotropic material should induce a pressure-like stress proportional to the bulk modulus $K$, with no shear stresses.\n\n**2. Isochoric Pure Shear Stretch**\nThe deformation is defined by a left stretch tensor $V$ with principal stretches $\\lambda_{s}$, $\\lambda_{s}^{-1}$, and $1$, where $\\lambda_s > 1$. The deformation is isochoric because the volume ratio $J = \\det(V) = \\lambda_{s} \\cdot \\lambda_{s}^{-1} \\cdot 1 = 1$.\nIn a principal basis, $V$ can be represented by the matrix $V = \\operatorname{diag}(\\lambda_{s}, \\lambda_{s}^{-1}, 1)$.\nThe logarithmic strain tensor $E$ in this basis is:\n$$\nE = \\ln V = \\operatorname{diag}(\\ln \\lambda_{s}, \\ln(\\lambda_{s}^{-1}), \\ln 1) = \\operatorname{diag}(\\ln \\lambda_{s}, -\\ln \\lambda_{s}, 0)\n$$\nThis is a purely deviatoric strain. The trace is $\\operatorname{tr}(E) = \\ln \\lambda_{s} - \\ln \\lambda_{s} + 0 = 0$.\nThe volumetric part of the strain is $E_{\\mathrm{vol}} = \\frac{1}{3}\\operatorname{tr}(E)I = 0$.\nThe deviatoric part of the strain is $E_{\\mathrm{dev}} = E - E_{\\mathrm{vol}} = E$.\nNow we compute the stress components.\nThe volumetric part of the stress for this shear, denoted $\\tau_{\\mathrm{vol}}^{(\\mathrm{shear})}$, is:\n$$\n\\tau_{\\mathrm{vol}}^{(\\mathrm{shear})} = K (\\operatorname{tr} E) I = K(0)I = 0\n$$\nThe deviatoric part of the stress, denoted $\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}$, is:\n$$\n\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})} = 2G E_{\\mathrm{dev}} = 2G E = 2G \\operatorname{diag}(\\ln \\lambda_{s}, -\\ln \\lambda_{s}, 0)\n$$\nThe total stress $\\tau^{(\\mathrm{shear})} = 2G E$ is purely deviatoric. This is also physically consistent: a pure change in shape (at constant volume) in an isotropic material should induce a purely deviatoric stress state proportional to the shear modulus $G$, with no hydrostatic component.\n\n**Final Calculation of the Ratio R**\nThe ratio $R$ is defined as\n$$\nR := \\frac{\\|\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}\\|}{\\|\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}\\|},\n$$\nwhere $\\|\\cdot\\|$ is the Frobenius norm, defined as $\\|A\\| = \\sqrt{\\operatorname{tr}(A^T A)}$.\nFor the numerator, we compute the norm of $\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})} = 2G \\operatorname{diag}(\\ln \\lambda_{s}, -\\ln \\lambda_{s}, 0)$.\n$$\n(\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})})^T (\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}) = (\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})})^2 = (2G)^2 \\operatorname{diag}((\\ln \\lambda_{s})^2, (-\\ln \\lambda_{s})^2, 0^2) = 4G^2 \\operatorname{diag}((\\ln \\lambda_{s})^2, (\\ln \\lambda_{s})^2, 0)\n$$\nThe trace is $\\operatorname{tr}((\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})})^2) = 4G^2 ((\\ln \\lambda_{s})^2 + (\\ln \\lambda_{s})^2 + 0) = 8G^2 (\\ln \\lambda_{s})^2$.\nThe norm is $\\|\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}\\| = \\sqrt{8G^2 (\\ln \\lambda_{s})^2}$. Since $G>0$ and $\\lambda_s > 1$ (so $\\ln \\lambda_s > 0$), this simplifies to:\n$$\n\\|\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}\\| = 2\\sqrt{2} G \\ln \\lambda_{s}\n$$\nFor the denominator, we compute the norm of $\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})} = K (\\ln J_{v}) I$.\n$$\n(\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})})^T (\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}) = (K (\\ln J_{v}) I)^T (K (\\ln J_{v}) I) = (K \\ln J_{v})^2 I^2 = (K \\ln J_{v})^2 I\n$$\nThe trace is $\\operatorname{tr}((K \\ln J_{v})^2 I) = (K \\ln J_{v})^2 \\operatorname{tr}(I) = 3(K \\ln J_{v})^2$.\nThe norm is $\\|\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}\\| = \\sqrt{3(K \\ln J_{v})^2}$. Since $K>0$ and $J_v > 1$ (so $\\ln J_v > 0$), this simplifies to:\n$$\n\\|\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}\\| = \\sqrt{3} K \\ln J_{v}\n$$\nFinally, the ratio $R$ is:\n$$\nR = \\frac{2\\sqrt{2} G \\ln \\lambda_{s}}{\\sqrt{3} K \\ln J_{v}}\n$$\nThis is the final closed-form analytic expression for the ratio $R$.", "answer": "$$\n\\boxed{\\frac{2\\sqrt{2} G \\ln(\\lambda_{s})}{\\sqrt{3} K \\ln(J_{v})}}\n$$", "id": "3579134"}, {"introduction": "The true power of logarithmic strain space algorithms is most apparent in the context of elastoplasticity, which is central to modeling the behavior of metals and many other engineering materials. This culminating exercise guides you through the implementation of a complete stress update for finite plasticity. You will derive and code the essential elastic-predictor/plastic-corrector scheme, also known as a return-mapping algorithm, for a simple yet highly illustrative uniaxial case. [@problem_id:3579149]", "problem": "Design a complete and verifiable algorithm for a single-step uniaxial update in finite strain elastoplasticity using the logarithmic (Hencky) strain space. The goal is to compute the updated stress and plastic strain for a uniaxial bar undergoing a specified total logarithmic strain at the end of the step. The derivation must begin from first principles appropriate to finite strain plasticity modeled in logarithmic strain space, and the implementation must follow the elastic predictor/plastic corrector structure in a rate-independent formulation with isotropic hardening.\n\nFundamental bases to use:\n- Kinematics: In one dimension, the total stretch is denoted by $\\lambda$, and the total logarithmic strain (Hencky strain) is $h = \\ln \\lambda$. The determinant of the deformation gradient (the Jacobian) is $J=\\lambda$, and the elastic-logarithmic strain and plastic-logarithmic strain add: $h = h_{\\mathrm{e}} + h_{\\mathrm{p}}$.\n- Work-conjugacy: The Kirchhoff stress $\\tau$ is work-conjugate to the logarithmic strain rate. In one dimension, the elastic constitutive relation in logarithmic strain space is $\\tau = E\\, h_{\\mathrm{e}} = E \\left(h - h_{\\mathrm{p}}\\right)$, where $E$ is the Young’s modulus.\n- Plasticity: Use a one-dimensional associative rate-independent plasticity with isotropic hardening. The yield function is $\\phi(\\tau,\\alpha) = |\\tau| - \\tau_{\\mathrm{y}}(\\alpha)$ with $\\tau_{\\mathrm{y}}(\\alpha)=\\tau_{\\mathrm{y0}}+H\\,\\alpha$, where $\\alpha$ is the accumulated plastic strain, $\\tau_{\\mathrm{y0}}$ is the initial yield stress, and $H$ is the isotropic hardening modulus. The Kuhn–Tucker conditions, consistency, and associative flow hold. In one dimension, the plastic flow direction is given by the sign of $\\tau$.\n\nYou must:\n- Derive the scalar return-mapping corrector in logarithmic strain space for the uniaxial case starting from these bases, without invoking any unproven shortcut formulas. Clearly show how the plastic multiplier is obtained under the consistency condition in the plastic regime.\n- Implement the elastic predictor and plastic corrector to compute the updated quantities at the end of the step: the Kirchhoff stress $\\tau_{n+1}$, plastic logarithmic strain $h_{\\mathrm{p},n+1}$, and accumulated plastic strain $\\alpha_{n+1}$. Finally, compute the Cauchy stress $\\sigma_{n+1}$ using $\\sigma_{n+1}=\\tau_{n+1}/\\lambda_{n+1}$ with $\\lambda_{n+1}=\\exp(h_{n+1})$.\n- For the purpose of numerical reporting, express the final Cauchy stress in megapascal (MPa). The strains $h_{\\mathrm{p}}$ and $\\alpha$ are dimensionless. All returned floating-point values must be rounded to $6$ decimal places.\n\nInput specification for each test case:\n- Material parameters: $E$ (in MPa), $\\tau_{\\mathrm{y0}}$ (in MPa), $H$ (in MPa).\n- State/input at step end: total logarithmic strain $h_{n+1}$ (dimensionless), prior plastic logarithmic strain $h_{\\mathrm{p},n}$ (dimensionless), prior accumulated plastic strain $\\alpha_n$ (dimensionless).\n\nOutput specification per test case:\n- A list of $3$ floats $[\\sigma_{n+1}, h_{\\mathrm{p},n+1}, \\alpha_{n+1}]$ where $\\sigma_{n+1}$ is in MPa and all values are rounded to $6$ decimals.\n\nYour program must process the following test suite and produce the aggregated results in a single line. Use exactly the parameter values provided below.\n\nTest suite (each bullet provides $(E,\\tau_{\\mathrm{y0}},H,h_{n+1},h_{\\mathrm{p},n},\\alpha_n)$):\n- Case A: $(200000, 300, 1000, 0.0005, 0.0, 0.0)$\n- Case B: $(210000, 250, 0, 0.003, 0.0, 0.0)$\n- Case C: $(70000, 100, 1000, 0.01, 0.0, 0.0)$\n- Case D: $(100000, 200, 500, -0.005, 0.0, 0.0)$\n- Case E: $(150000, 300, 200, 0.002, 0.0, 0.0)$\n- Case F: $(210000, 250, 5000, 0.003, 0.01, 0.01)$\n\nFinal output format:\n- Your program should produce a single line of output containing a Python-like list of the per-case lists, with no spaces, and each float rounded to $6$ decimals. For example, a valid format would look like: $[[1.234000,0.000000,0.000000],[\\dots]]$ where the ellipsis denotes additional cases.\n\nAngle units are not applicable. Ensure scientific realism and numerical consistency. No user input is required; the program must embed the test suite and print the results as a single line in the exact format described.", "solution": "The user-provided problem is assessed to be **valid**. It is scientifically grounded in the principles of continuum mechanics and computational plasticity, well-posed, objective, and contains all necessary information for a unique solution. The derivation and implementation of a return-mapping algorithm for finite strain uniaxial elastoplasticity in logarithmic strain space will now be presented.\n\n### **1. Problem Formulation**\n\nThe problem concerns the state update for a uniaxial bar undergoing finite deformation. The kinematics are described in terms of the total logarithmic strain, $h = \\ln \\lambda$, where $\\lambda$ is the stretch. The model assumes an additive decomposition of the total logarithmic strain into elastic and plastic parts:\n$$h = h_{\\mathrm{e}} + h_{\\mathrm{p}}$$\nThe state of the material at the beginning of a time step, denoted by subscript $n$, is characterized by the plastic logarithmic strain $h_{\\mathrm{p},n}$ and the accumulated plastic strain $\\alpha_n$. The problem requires finding the updated state $\\{h_{\\mathrm{p},n+1}, \\alpha_{n+1}\\}$ and the corresponding stresses at the end of the step, denoted by subscript $n+1$, given the total logarithmic strain $h_{n+1}$.\n\nThe constitutive relations are:\n- **Elasticity**: The Kirchhoff stress $\\tau$ is related to the elastic logarithmic strain $h_{\\mathrm{e}}$ via Young's modulus $E$:\n  $$\\tau = E h_{\\mathrm{e}} = E(h - h_{\\mathrm{p}})$$\n- **Yield Condition**: Plastic flow occurs when the yield function $\\phi$ is positive. For one-dimensional isotropic hardening, the yield function is:\n  $$\\phi(\\tau, \\alpha) = |\\tau| - \\tau_{\\mathrm{y}}(\\alpha) \\leq 0$$\n  where the yield stress $\\tau_{\\mathrm{y}}$ is a linear function of the accumulated plastic strain $\\alpha$:\n  $$\\tau_{\\mathrm{y}}(\\alpha) = \\tau_{\\mathrm{y0}} + H \\alpha$$\n  Here, $\\tau_{\\mathrm{y0}}$ is the initial yield stress and $H$ is the constant hardening modulus.\n- **Flow Rule**: An associative flow rule is assumed, where the increment of plastic strain is directed along the gradient of the yield function with respect to stress:\n  $$\\Delta h_{\\mathrm{p}} = h_{\\mathrm{p},n+1} - h_{\\mathrm{p},n} = \\Delta \\gamma \\frac{\\partial \\phi}{\\partial \\tau} = \\Delta \\gamma \\, \\text{sgn}(\\tau_{n+1})$$\n  where $\\Delta \\gamma \\geq 0$ is the plastic multiplier for the step.\n- **Hardening Law**: The increment of accumulated plastic strain is equal to the magnitude of the plastic strain increment, which in one dimension is simply the plastic multiplier:\n  $$\\Delta \\alpha = \\alpha_{n+1} - \\alpha_n = |\\Delta h_{\\mathrm{p}}| = \\Delta \\gamma$$\n\nThe final Cauchy stress $\\sigma_{n+1}$ is obtained from the Kirchhoff stress $\\tau_{n+1}$ via the relation:\n$$\\sigma_{n+1} = \\frac{\\tau_{n+1}}{J_{n+1}} = \\frac{\\tau_{n+1}}{\\lambda_{n+1}} = \\frac{\\tau_{n+1}}{\\exp(h_{n+1})}$$\n\n### **2. Algorithm Derivation: Return Mapping**\n\nThe algorithm is based on the standard elastic predictor/plastic corrector structure, which is an implicit time integration scheme.\n\n#### **Step 2.1: Elastic Predictor**\n\nFirst, assume the step is entirely elastic. The plastic state variables are provisionally held constant. The \"trial\" state is computed as follows:\n- Trial plastic strain: $h_{\\mathrm{p, trial}} = h_{\\mathrm{p},n}$\n- Trial accumulated plastic strain: $\\alpha_{\\text{trial}} = \\alpha_n$\n- Trial elastic strain: $h_{\\mathrm{e, trial}} = h_{n+1} - h_{\\mathrm{p, trial}} = h_{n+1} - h_{\\mathrm{p},n}$\n- Trial Kirchhoff stress: This is computed using the elastic law:\n  $$\\tau_{\\text{trial}} = E h_{\\mathrm{e, trial}} = E (h_{n+1} - h_{\\mathrm{p},n})$$\n\n#### **Step 2.2: Yield Check**\n\nThe trial state is checked against the yield condition. The yield stress at the beginning of the step is $\\tau_{\\mathrm{y},n} = \\tau_{\\mathrm{y0}} + H \\alpha_n$. The trial yield function value is:\n$$\\phi_{\\text{trial}} = |\\tau_{\\text{trial}}| - \\tau_{\\mathrm{y},n} = |\\tau_{\\text{trial}}| - (\\tau_{\\mathrm{y0}} + H \\alpha_n)$$\n\n- If $\\phi_{\\text{trial}} \\le 0$, the elastic assumption is correct. The trial state is the final state.\n  - $\\tau_{n+1} = \\tau_{\\text{trial}}$\n  - $h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n}$\n  - $\\alpha_{n+1} = \\alpha_n$\n\n- If $\\phi_{\\text{trial}} > 0$, plastic deformation has occurred. The trial state violates the yield condition, and a plastic correction is required.\n\n#### **Step 2.3: Plastic Corrector**\n\nWhen plasticity occurs, the state at the end of the step must satisfy the full set of constitutive equations simultaneously. This is the \"return mapping\" phase, which projects the trial stress back to the updated yield surface. The system of equations to be solved for the unknowns $\\{\\tau_{n+1}, h_{\\mathrm{p},n+1}, \\alpha_{n+1}, \\Delta\\gamma\\}$ is:\n1.  **Elasticity**: $\\tau_{n+1} = E(h_{n+1} - h_{\\mathrm{p},n+1})$\n2.  **Flow Rule**: $h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n} + \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$ (Note: $\\text{sgn}(\\tau_{n+1})=\\text{sgn}(\\tau_{\\text{trial}})$ since the return path is radial in stress space)\n3.  **Hardening Law**: $\\alpha_{n+1} = \\alpha_n + \\Delta \\gamma$\n4.  **Consistency Condition**: $\\phi_{n+1} = |\\tau_{n+1}| - (\\tau_{\\mathrm{y0}} + H \\alpha_{n+1}) = 0$\n\nWe solve this system for the plastic multiplier $\\Delta\\gamma$. Substitute Eq. (2) into Eq. (1):\n$$\\tau_{n+1} = E(h_{n+1} - (h_{\\mathrm{p},n} + \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})))$$\n$$\\tau_{n+1} = E(h_{n+1} - h_{\\mathrm{p},n}) - E \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$$\nRecognizing $E(h_{n+1} - h_{\\mathrm{p},n})$ as $\\tau_{\\text{trial}}$, we have:\n$$\\tau_{n+1} = \\tau_{\\text{trial}} - E \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$$\nMultiplying by $\\text{sgn}(\\tau_{\\text{trial}})$ and using $|\\tau| = \\tau \\cdot \\text{sgn}(\\tau)$ and $(\\text{sgn}(\\tau_{\\text{trial}}))^2=1$:\n$$|\\tau_{n+1}| = |\\tau_{\\text{trial}}| - E \\Delta \\gamma$$\nNow, substitute this expression for $|\\tau_{n+1}|$ and the hardening law (Eq. 3) into the consistency condition (Eq. 4):\n$$(|\\tau_{\\text{trial}}| - E \\Delta \\gamma) - (\\tau_{\\mathrm{y0}} + H (\\alpha_n + \\Delta \\gamma)) = 0$$\nRearranging to solve for $\\Delta\\gamma$:\n$$|\\tau_{\\text{trial}}| - (\\tau_{\\mathrm{y0}} + H \\alpha_n) = E \\Delta \\gamma + H \\Delta \\gamma$$\nThe left-hand side is precisely the trial yield function value, $\\phi_{\\text{trial}}$:\n$$\\phi_{\\text{trial}} = (E + H) \\Delta \\gamma$$\nThus, the plastic multiplier is determined as:\n$$\\Delta \\gamma = \\frac{\\phi_{\\text{trial}}}{E + H} = \\frac{|\\tau_{\\text{trial}}| - (\\tau_{\\mathrm{y0}} + H \\alpha_n)}{E + H}$$\nSince we are in the plastic case, $\\phi_{\\text{trial}} > 0$. With $E > 0$ and $H \\ge 0$, it follows that $\\Delta \\gamma > 0$, as required.\n\nWith $\\Delta \\gamma$ known, the state variables are updated:\n- **Accumulated Plastic Strain**:\n  $$\\alpha_{n+1} = \\alpha_n + \\Delta \\gamma$$\n- **Plastic Logarithmic Strain**:\n  $$h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n} + \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$$\n- **Kirchhoff Stress**: From the consistency condition, we know $|\\tau_{n+1}| = \\tau_{\\mathrm{y0}} + H \\alpha_{n+1}$. The sign is preserved from the trial state. This gives a numerically robust update:\n  $$\\tau_{n+1} = (\\tau_{\\mathrm{y0}} + H \\alpha_{n+1}) \\, \\text{sgn}(\\tau_{\\text{trial}})$$\n\n### **3. Summary of the Final Algorithm**\n\nFor each step from state $n$ to $n+1$:\n1.  **Inputs**: Material parameters $\\{E, \\tau_{\\mathrm{y0}}, H\\}$, and state $\\{h_{\\mathrm{p},n}, \\alpha_n, h_{n+1}\\}$.\n2.  **Elastic Predictor**: Calculate trial Kirchhoff stress:\n    $$\\tau_{\\text{trial}} = E (h_{n+1} - h_{\\mathrm{p},n})$$\n3.  **Yield Check**: Calculate trial yield function value:\n    $$\\phi_{\\text{trial}} = |\\tau_{\\text{trial}}| - (\\tau_{\\mathrm{y0}} + H \\alpha_n)$$\n4.  **Case Analysis**:\n    a.  **If $\\phi_{\\text{trial}} \\le 0$ (Elastic Step)**:\n        - $\\tau_{n+1} = \\tau_{\\text{trial}}$\n        - $h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n}$\n        - $\\alpha_{n+1} = \\alpha_n$\n    b.  **If $\\phi_{\\text{trial}} > 0$ (Plastic Step)**:\n        - Compute plastic multiplier: $\\Delta \\gamma = \\phi_{\\text{trial}} / (E + H)$\n        - Update accumulated plastic strain: $\\alpha_{n+1} = \\alpha_n + \\Delta \\gamma$\n        - Update plastic log-strain: $h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n} + \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$\n        - Update Kirchhoff stress: $\\tau_{n+1} = (\\tau_{\\mathrm{y0}} + H \\alpha_{n+1}) \\, \\text{sgn}(\\tau_{\\text{trial}})$\n5.  **Final Stress Calculation**: Compute the Cauchy (true) stress:\n    $$\\sigma_{n+1} = \\frac{\\tau_{n+1}}{\\exp(h_{n+1})}$$\n6.  **Outputs**: Return the set of updated values $\\{\\sigma_{n+1}, h_{\\mathrm{p},n+1}, \\alpha_{n+1}\\}$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a series of uniaxial finite strain elastoplasticity problems\n    using a return-mapping algorithm in logarithmic strain space.\n    \"\"\"\n    # Test suite: (E, tau_y0, H, h_np1, h_p_n, alpha_n)\n    # E, tau_y0, H are in MPa. Strains are dimensionless.\n    test_cases = [\n        (200000.0, 300.0, 1000.0, 0.0005, 0.0, 0.0),      # Case A\n        (210000.0, 250.0, 0.0, 0.003, 0.0, 0.0),          # Case B\n        (70000.0, 100.0, 1000.0, 0.01, 0.0, 0.0),         # Case C\n        (100000.0, 200.0, 500.0, -0.005, 0.0, 0.0),       # Case D\n        (150000.0, 300.0, 200.0, 0.002, 0.0, 0.0),        # Case E\n        (210000.0, 250.0, 5000.0, 0.003, 0.01, 0.01),     # Case F\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E, tau_y0, H, h_np1, h_p_n, alpha_n = case\n\n        # 1. Elastic Predictor\n        tau_trial = E * (h_np1 - h_p_n)\n\n        # 2. Yield Check\n        # Current yield stress at the start of the step\n        tau_y_n = tau_y0 + H * alpha_n\n        phi_trial = np.abs(tau_trial) - tau_y_n\n\n        # 3. Case Analysis: Elastic or Plastic\n        if phi_trial <= 0:\n            # Elastic step\n            tau_np1 = tau_trial\n            h_p_np1 = h_p_n\n            alpha_np1 = alpha_n\n        else:\n            # Plastic step: perform return mapping\n            # Calculate plastic multiplier\n            delta_gamma = phi_trial / (E + H)\n            \n            # Update state variables\n            alpha_np1 = alpha_n + delta_gamma\n            \n            # Handle the sign of trial stress for flow direction\n            # np.sign returns 0 for 0, but phi_trial > 0 implies tau_trial != 0\n            sign_tau_trial = np.sign(tau_trial)\n            h_p_np1 = h_p_n + delta_gamma * sign_tau_trial\n            \n            # Update Kirchhoff stress using the consistency condition (more robust)\n            tau_np1 = (tau_y0 + H * alpha_np1) * sign_tau_trial\n\n        # 4. Final Cauchy Stress Calculation\n        # Total stretch at the end of the step\n        lambda_np1 = np.exp(h_np1)\n        # Cauchy stress\n        sigma_np1 = tau_np1 / lambda_np1\n\n        # 5. Format results\n        # Round final values to 6 decimal places as required\n        result = [\n            round(sigma_np1, 6),\n            round(h_p_np1, 6),\n            round(alpha_np1, 6),\n        ]\n        all_results.append(result)\n\n    # Final print statement must be a single line in the exact specified format.\n    # The replace(\" \", \"\") ensures no spaces are present in the final output.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "3579149"}]}