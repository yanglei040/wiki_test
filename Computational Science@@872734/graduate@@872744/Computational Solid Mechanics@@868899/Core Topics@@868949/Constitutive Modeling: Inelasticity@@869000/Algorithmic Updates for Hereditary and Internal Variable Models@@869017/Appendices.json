{"hands_on_practices": [{"introduction": "Implementing hereditary models computationally requires a robust method for updating state variables over discrete time steps. This first practice focuses on the generalized Maxwell model, a foundational representation of linear viscoelasticity [@problem_id:3544102]. You will derive and apply a recursive update formula that exactly solves the model's evolution for a history of instantaneous strain changes, a core skill for building accurate and efficient simulation tools.", "problem": "A uniaxial, small-strain, isothermal linear viscoelastic solid is modeled by a generalized Maxwell chain (three Maxwell arms in parallel with one equilibrium spring). Let the stress be decomposed as $\\sigma(t) = E_{\\infty}\\,\\epsilon(t) + \\sum_{q=1}^{3} \\sigma_q(t)$, where $E_{\\infty}$ is the equilibrium elastic modulus and $\\sigma_q(t)$ are the stress contributions of the $q$-th Maxwell arm. Each Maxwell arm follows the evolution equation $ \\frac{d\\sigma_q}{dt} + \\frac{1}{\\tau_q}\\,\\sigma_q = E_q\\,\\frac{d\\epsilon}{dt}$, where $E_q$ is the arm modulus and $\\tau_q$ is its relaxation time. Assume initial conditions $\\epsilon(0^-)=0$ and $\\sigma_q(0^-)=0$ for $q=1,2,3$.\n\nThe material parameters are $E_{\\infty}=300\\,\\text{MPa}$, $E_1=700\\,\\text{MPa}$, $\\tau_1=1\\,\\text{s}$, $E_2=1000\\,\\text{MPa}$, $\\tau_2=5\\,\\text{s}$, $E_3=400\\,\\text{MPa}$, $\\tau_3=20\\,\\text{s}$.\n\nThe loading path consists of two consecutive strain jumps: at $t=0$ an instantaneous jump $\\Delta\\epsilon_1=0.012$ is applied and the strain is then held constant for $\\Delta t_1=2\\,\\text{s}$; at $t=\\Delta t_1$ an instantaneous jump $\\Delta\\epsilon_2=-0.004$ is applied and the strain is then held constant for $\\Delta t_2=3\\,\\text{s}$. Thus the final time is $t_f=\\Delta t_1+\\Delta t_2=5\\,\\text{s}$.\n\nStarting from the given evolution law for each mode and the stress decomposition, derive the algorithmic recursion for piecewise-constant strain segments with instantaneous strain jumps. Apply this recursion to compute the final stress $\\sigma(t_f)$ and report the contributions of each Maxwell mode separately, as well as the equilibrium spring contribution. Express all stresses in $\\text{MPa}$ and round your results to four significant figures. Present your final answer as a row matrix containing, in order, the total stress, the equilibrium spring contribution, and the contributions from modes $q=1,2,3$.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It describes a standard problem in linear viscoelasticity, providing all necessary material parameters, initial conditions, and a clearly defined loading path. The model and governing equations are fundamental to the field of continuum mechanics. Therefore, the problem is deemed valid and a solution is pursued.\n\nThe core of the problem is to solve the evolution equation for the non-equilibrium stress $\\sigma_q(t)$ in each Maxwell arm, which is a first-order linear ordinary differential equation:\n$$ \n\\frac{d\\sigma_q}{dt} + \\frac{1}{\\tau_q}\\,\\sigma_q = E_q\\,\\frac{d\\epsilon}{dt} \n$$\nThe loading is specified as a sequence of time intervals where an instantaneous strain jump is followed by a period of constant strain. We first derive a general recursive update formula for the stress $\\sigma_q$ over a generic time step from $t_n$ to $t_{n+1}$. Let the duration of the step be $\\Delta t_{n+1} = t_{n+1} - t_n$. At time $t_n$, an instantaneous strain jump $\\Delta\\epsilon_{n+1}$ is applied.\n\nThe effect of the instantaneous strain jump at $t_n$ on the stress $\\sigma_q$ must be evaluated. We can integrate the governing equation over an infinitesimal time interval $[t_n^-, t_n^+]$:\n$$ \n\\int_{t_n^-}^{t_n^+} \\left(\\frac{d\\sigma_q}{dt}\\right) dt + \\int_{t_n^-}^{t_n^+} \\frac{1}{\\tau_q}\\,\\sigma_q dt = \\int_{t_n^-}^{t_n^+} E_q\\,\\frac{d\\epsilon}{dt} dt \n$$\nAs the interval duration approaches zero, the second integral vanishes because $\\sigma_q$ is bounded. The equation reduces to:\n$$ \n\\sigma_q(t_n^+) - \\sigma_q(t_n^-) = E_q \\left(\\epsilon(t_n^+) - \\epsilon(t_n^-)\\right) \n$$\nLet $\\sigma_{q,n}$ denote the stress at the end of the previous step, $\\sigma_q(t_n^-)$, and $\\Delta\\epsilon_{n+1}$ be the strain jump at $t_n$. The stress immediately after the jump, $\\sigma_q(t_n^+)$, is:\n$$ \n\\sigma_q(t_n^+) = \\sigma_{q,n} + E_q \\Delta\\epsilon_{n+1} \n$$\nFor the subsequent period $t \\in (t_n, t_{n+1}]$, the strain is held constant, meaning $\\frac{d\\epsilon}{dt} = 0$. The governing equation becomes homogeneous:\n$$ \n\\frac{d\\sigma_q}{dt} + \\frac{1}{\\tau_q}\\,\\sigma_q = 0 \n$$\nThe solution to this equation is an exponential decay. With the initial condition $\\sigma_q(t_n^+)$ at time $t_n$, the solution for $t > t_n$ is:\n$$ \n\\sigma_q(t) = \\sigma_q(t_n^+) \\exp\\left(-\\frac{t-t_n}{\\tau_q}\\right) \n$$\nEvaluating this at the end of the time step, $t = t_{n+1}$, gives the stress $\\sigma_{q,n+1}$:\n$$ \n\\sigma_{q,n+1} = \\sigma_q(t_{n+1}) = \\sigma_q(t_n^+) \\exp\\left(-\\frac{\\Delta t_{n+1}}{\\tau_q}\\right) \n$$\nSubstituting the expression for $\\sigma_q(t_n^+)$, we arrive at the algorithmic recursion for the non-equilibrium stresses:\n$$ \n\\sigma_{q,n+1} = \\left(\\sigma_{q,n} + E_q \\Delta\\epsilon_{n+1}\\right) \\exp\\left(-\\frac{\\Delta t_{n+1}}{\\tau_q}\\right) \n$$\nWe now apply this formula to the specified loading history. The material is initially at rest, so at $t=0^-$, we have $\\epsilon(0^-)=0$ and $\\sigma_{q,0}=\\sigma_q(0^-)=0$ for $q=1,2,3$.\n\nStep 1: First loading segment, $t \\in [0, 2\\,\\text{s}]$.\nAt $t_0=0$, there is a strain jump $\\Delta\\epsilon_1 = 0.012$. The time interval is $\\Delta t_1 = 2\\,\\text{s}$. The strain during this interval is $\\epsilon(t) = \\epsilon_1 = 0.012$.\nThe stresses at the end of this step, $t_1 = 2\\,\\text{s}$, are calculated using the recursion with $n=0$:\n$$ \n\\sigma_{q,1} = (\\sigma_{q,0} + E_q \\Delta\\epsilon_1) \\exp\\left(-\\frac{\\Delta t_1}{\\tau_q}\\right) = (0 + E_q \\times 0.012) \\exp\\left(-\\frac{2}{\\tau_q}\\right) \n$$\nFor each Maxwell arm ($q=1,2,3$):\n$$ \\sigma_{1,1} = (700 \\times 0.012) \\exp\\left(-\\frac{2}{1}\\right) = 8.4 \\exp(-2)\\,\\text{MPa} $$\n$$ \\sigma_{2,1} = (1000 \\times 0.012) \\exp\\left(-\\frac{2}{5}\\right) = 12 \\exp(-0.4)\\,\\text{MPa} $$\n$$ \\sigma_{3,1} = (400 \\times 0.012) \\exp\\left(-\\frac{2}{20}\\right) = 4.8 \\exp(-0.1)\\,\\text{MPa} $$\n\nStep 2: Second loading segment, $t \\in (2\\,\\text{s}, 5\\,\\text{s}]$.\nAt $t_1=2\\,\\text{s}$, there is a strain jump $\\Delta\\epsilon_2 = -0.004$. The time interval is $\\Delta t_2 = 5 - 2 = 3\\,\\text{s}$. The initial stresses for this step are $\\sigma_{q,1}$ calculated above.\nThe final strain is $\\epsilon(t_f) = \\epsilon_1 + \\Delta\\epsilon_2 = 0.012 - 0.004 = 0.008$.\nThe stresses at the final time $t_f = 5\\,\\text{s}$ are calculated using the recursion with $n=1$:\n$$ \n\\sigma_{q,f} = \\sigma_q(t_f) = (\\sigma_{q,1} + E_q \\Delta\\epsilon_2) \\exp\\left(-\\frac{\\Delta t_2}{\\tau_q}\\right) \n$$\nFor each Maxwell arm:\n$$ \\sigma_{1,f} = (8.4 \\exp(-2) + 700(-0.004)) \\exp\\left(-\\frac{3}{1}\\right) = (8.4 \\exp(-2) - 2.8) \\exp(-3) = 8.4 \\exp(-5) - 2.8 \\exp(-3) $$\n$$ \\sigma_{2,f} = (12 \\exp(-0.4) + 1000(-0.004)) \\exp\\left(-\\frac{3}{5}\\right) = (12 \\exp(-0.4) - 4) \\exp(-0.6) = 12 \\exp(-1) - 4 \\exp(-0.6) $$\n$$ \\sigma_{3,f} = (4.8 \\exp(-0.1) + 400(-0.004)) \\exp\\left(-\\frac{3}{20}\\right) = (4.8 \\exp(-0.1) - 1.6) \\exp(-0.15) = 4.8 \\exp(-0.25) - 1.6 \\exp(-0.15) $$\nNow we compute the numerical values for these modal contributions at $t_f = 5\\,\\text{s}$ and round to four significant figures:\n$$ \\sigma_{1,f} \\approx 8.4(0.0067379) - 2.8(0.049787) \\approx 0.056598 - 0.139404 = -0.082805\\,\\text{MPa} \\implies -0.08281\\,\\text{MPa} $$\n$$ \\sigma_{2,f} \\approx 12(0.36788) - 4(0.54881) \\approx 4.41456 - 2.19524 = 2.21932\\,\\text{MPa} \\implies 2.219\\,\\text{MPa} $$\n$$ \\sigma_{3,f} \\approx 4.8(0.77880) - 1.6(0.86071) \\approx 3.73824 - 1.37714 = 2.36110\\,\\text{MPa} \\implies 2.361\\,\\text{MPa} $$\nThe contribution from the equilibrium spring is purely elastic:\n$$ \\sigma_{\\infty}(t_f) = E_{\\infty} \\epsilon(t_f) = 300\\,\\text{MPa} \\times 0.008 = 2.4\\,\\text{MPa} $$\nFor consistency in reporting, this is presented as $2.400\\,\\text{MPa}$.\n\nThe total stress $\\sigma(t_f)$ is the sum of the equilibrium and non-equilibrium contributions. Summing the high-precision values and then rounding to four significant figures:\n$$ \\sigma(t_f) = \\sigma_{\\infty}(t_f) + \\sigma_{1,f} + \\sigma_{2,f} + \\sigma_{3,f} $$\n$$ \\sigma(t_f) \\approx 2.4 + (-0.082805) + 2.21932 + 2.36110 = 6.897615\\,\\text{MPa} \\implies 6.898\\,\\text{MPa} $$\n\nThe final results are:\n- Total stress: $\\sigma(t_f) = 6.898\\,\\text{MPa}$\n- Equilibrium spring contribution: $\\sigma_{\\infty}(t_f) = 2.400\\,\\text{MPa}$\n- Mode $1$ contribution: $\\sigma_1(t_f) = -0.08281\\,\\text{MPa}$\n- Mode $2$ contribution: $\\sigma_2(t_f) = 2.219\\,\\text{MPa}$\n- Mode $3$ contribution: $\\sigma_3(t_f) = 2.361\\,\\text{MPa}$\nThese values are assembled into a row matrix as requested.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6.898  2.400  -0.08281  2.219  2.361\n\\end{pmatrix}\n}\n$$", "id": "3544102"}, {"introduction": "A numerically correct algorithm is not sufficient; it must also be physically consistent, respecting fundamental laws like the second law of thermodynamics. This practice delves into the crucial concept of algorithmic thermodynamic stability by analyzing the workhorse of implicit integration, the Backward Euler scheme [@problem_id:3544081]. Through a discrete energy analysis, you will verify that this method guarantees non-negative dissipation, a property that ensures simulations are physically meaningful and robust.", "problem": "Consider a one-dimensional hereditary viscoelastic material represented by a sum of Maxwell elements in parallel with an equilibrium elastic spring, commonly known as the Standard Linear Solid (SLS). Let the total small strain be denoted by $\\varepsilon(t)$ and the total stress be denoted by $\\sigma(t)$. The model consists of an equilibrium elastic spring with modulus $E_{\\infty}$ and a set of $m$ Maxwell elements with elastic moduli $E_k$ and relaxation times $\\tau_k$, where $k=1,\\dots,m$. Each Maxwell element is characterized by an internal variable $q_k(t)$ representing its viscous strain. The constitutive relations and evolution equations are defined by the following fundamental and widely accepted framework:\n\n- The free energy density is\n$$\n\\psi(\\varepsilon,\\{q_k\\}) \\;=\\; \\tfrac{1}{2} E_{\\infty}\\,\\varepsilon^2 \\;+\\; \\sum_{k=1}^m \\tfrac{1}{2} E_k\\,\\big(\\varepsilon - q_k\\big)^2.\n$$\n\n- The stress is\n$$\n\\sigma \\;=\\; \\dfrac{\\partial \\psi}{\\partial \\varepsilon} \\;=\\; E_{\\infty}\\,\\varepsilon \\;+\\; \\sum_{k=1}^m E_k\\,\\big(\\varepsilon - q_k\\big).\n$$\n\n- Each internal variable obeys a linear ordinary differential equation representing viscous relaxation:\n$$\n\\dot{q}_k \\;=\\; \\dfrac{1}{\\tau_k}\\,\\big(\\varepsilon - q_k\\big),\n\\quad k=1,\\dots,m.\n$$\n\nThe Clausiusâ€“Duhem inequality for isothermal processes states that the rate of dissipation $\\mathcal{D}(t)$ must satisfy\n$$\n\\mathcal{D}(t) \\;=\\; \\sigma\\,\\dot{\\varepsilon} \\;-\\; \\dot{\\psi} \\;\\ge\\; 0.\n$$\nUnder the above laws, one obtains the well-tested result\n$$\n\\mathcal{D}(t) \\;=\\; \\sum_{k=1}^m \\dfrac{E_k}{\\tau_k}\\,\\big(\\varepsilon - q_k\\big)^2 \\;\\ge\\; 0.\n$$\n\nWe now consider a time-discrete algorithmic update over time steps $t_n$ with fixed step size $\\Delta t$, where $t_{n+1}=t_n+\\Delta t$. The internal variables are updated using the Backward Euler (BE) scheme, which is a standard implicit method in computational solid mechanics:\n$$\nq_k^{n+1} - q_k^{n} \\;=\\; \\dfrac{\\Delta t}{\\tau_k}\\,\\big(\\varepsilon^{n+1} - q_k^{n+1}\\big),\n\\quad k=1,\\dots,m.\n$$\nThe stress at the end of the step is computed by\n$$\n\\sigma^{n+1} \\;=\\; E_{\\infty}\\,\\varepsilon^{n+1} \\;+\\; \\sum_{k=1}^m E_k\\,\\big(\\varepsilon^{n+1} - q_k^{n+1}\\big).\n$$\nDefine the discrete free energy at step $n$ as\n$$\n\\psi^{n} \\;=\\; \\tfrac{1}{2} E_{\\infty}\\,(\\varepsilon^{n})^2 \\;+\\; \\sum_{k=1}^m \\tfrac{1}{2} E_k\\,\\big(\\varepsilon^{n} - q_k^{n}\\big)^2.\n$$\nDefine the discrete incremental work $W^{n+1}$ over the step $[t_n,t_{n+1}]$ using a one-point quadrature at the end of the step as\n$$\nW^{n+1} \\;=\\; \\sigma^{n+1}\\,\\Delta\\varepsilon^{n+1},\n\\quad \\text{where}\\quad \\Delta\\varepsilon^{n+1} \\;=\\; \\varepsilon^{n+1} - \\varepsilon^{n}.\n$$\nDefine the discrete dissipation $D^{n+1}$ by\n$$\nD^{n+1} \\;=\\; W^{n+1} \\;-\\; \\big(\\psi^{n+1} - \\psi^{n}\\big).\n$$\n\nYour goal is to perform an energy analysis for numerical tests with alternating strain increments and verify whether the discrete dissipation $D^{n+1}$ remains nonnegative for the chosen Backward Euler scheme. The analysis must be implemented as a complete, runnable program.\n\nImplementation requirements:\n- Use the above model with $m$ Maxwell elements. The initial conditions are $\\varepsilon^{0} = 0$ and $q_k^{0} = 0$ for all $k$.\n- Construct the strain sequence $\\{\\varepsilon^n\\}$ via alternating increments of amplitude $A$:\n$$\n\\Delta\\varepsilon^{n+1} \\;=\\; A\\,(-1)^n,\n\\quad n=0,1,2,\\dots,N-1,\n$$\nand set $\\varepsilon^{n+1} = \\varepsilon^{n} + \\Delta\\varepsilon^{n+1}$ with $\\varepsilon^{0} = 0$.\n- Physical units:\n    - Strain $\\varepsilon$ is dimensionless.\n    - Stress $\\sigma$ and moduli $E_{\\infty}, E_k$ must be interpreted in Pascal ($\\mathrm{Pa}$).\n    - Time $t$ and $\\tau_k$ must be in seconds ($\\mathrm{s}$).\n- For each time step, compute $q_k^{n+1}$ using Backward Euler, then compute $\\sigma^{n+1}$, $\\psi^{n+1}$, and $D^{n+1}$. Use a tight numerical tolerance to decide nonnegativity: a step is acceptable if $D^{n+1} \\ge -\\mathrm{tol}$, where $\\mathrm{tol}$ is a small positive float chosen relative to the energy scale.\n- For each test case, the program must return a boolean indicating whether $D^{n+1}$ is nonnegative (within tolerance) for all steps $n=0,\\dots,N-1$.\n\nTest suite:\n- Case $1$ (general happy path):\n    - $m = 2$, $E_{\\infty} = 2.6\\times 10^{9}\\,\\mathrm{Pa}$,\n      $E_1 = 0.9\\times 10^{9}\\,\\mathrm{Pa}$, $E_2 = 0.4\\times 10^{9}\\,\\mathrm{Pa}$,\n      $\\tau_1 = 0.06\\,\\mathrm{s}$, $\\tau_2 = 0.8\\,\\mathrm{s}$,\n      $\\Delta t = 0.05\\,\\mathrm{s}$, $N = 12$, $A = 0.007$.\n- Case $2$ (boundary: no equilibrium spring):\n    - $m = 1$, $E_{\\infty} = 0\\,\\mathrm{Pa}$,\n      $E_1 = 1.2\\times 10^{9}\\,\\mathrm{Pa}$,\n      $\\tau_1 = 0.02\\,\\mathrm{s}$,\n      $\\Delta t = 0.02\\,\\mathrm{s}$, $N = 20$, $A = 0.005$.\n- Case $3$ (edge: large time step relative to some $\\tau_k$):\n    - $m = 3$, $E_{\\infty} = 3.0\\times 10^{9}\\,\\mathrm{Pa}$,\n      $E_1 = 1.5\\times 10^{9}\\,\\mathrm{Pa}$, $E_2 = 0.5\\times 10^{9}\\,\\mathrm{Pa}$, $E_3 = 0.2\\times 10^{9}\\,\\mathrm{Pa}$,\n      $\\tau_1 = 0.01\\,\\mathrm{s}$, $\\tau_2 = 0.1\\,\\mathrm{s}$, $\\tau_3 = 1.0\\,\\mathrm{s}$,\n      $\\Delta t = 0.5\\,\\mathrm{s}$, $N = 8$, $A = 0.03$.\n- Case $4$ (edge: zero amplitude increments):\n    - $m = 2$, $E_{\\infty} = 1.0\\times 10^{9}\\,\\mathrm{Pa}$,\n      $E_1 = 0.7\\times 10^{9}\\,\\mathrm{Pa}$, $E_2 = 0.3\\times 10^{9}\\,\\mathrm{Pa}$,\n      $\\tau_1 = 0.2\\,\\mathrm{s}$, $\\tau_2 = 0.5\\,\\mathrm{s}$,\n      $\\Delta t = 0.1\\,\\mathrm{s}$, $N = 10$, $A = 0$.\n\nAnswer specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the above four cases in order, for example $\\big[\\texttt{result1},\\texttt{result2},\\texttt{result3},\\texttt{result4}\\big]$, where each $\\texttt{resulti}$ is a boolean.", "solution": "The problem requires an analysis of the thermodynamic consistency of a numerical algorithm for a one-dimensional linear viscoelastic model. Specifically, we must verify whether the discrete dissipation, as defined, remains non-negative when a Backward Euler integration scheme is used.\n\nFirst, we establish the analytical framework. The model is a Standard Linear Solid, comprising an equilibrium spring ($E_{\\infty}$) in parallel with $m$ Maxwell elements. Each Maxwell element $k$ consists of a spring ($E_k$) and a dashpot, with its state described by an internal variable, the viscous strain $q_k$.\n\nThe free energy density $\\psi$, stress $\\sigma$, and the evolution of the internal variables $q_k$ are given by:\n$$\n\\psi(\\varepsilon, \\{q_k\\}) = \\frac{1}{2} E_{\\infty} \\varepsilon^2 + \\sum_{k=1}^m \\frac{1}{2} E_k (\\varepsilon - q_k)^2\n$$\n$$\n\\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon} = E_{\\infty} \\varepsilon + \\sum_{k=1}^m E_k (\\varepsilon - q_k)\n$$\n$$\n\\dot{q}_k = \\frac{1}{\\tau_k}(\\varepsilon - q_k)\n$$\nThe problem considers a time-discrete simulation over steps from $t_n$ to $t_{n+1} = t_n + \\Delta t$. The internal variables are updated using the implicit Backward Euler (BE) scheme:\n$$\n\\frac{q_k^{n+1} - q_k^n}{\\Delta t} = \\frac{1}{\\tau_k}(\\varepsilon^{n+1} - q_k^{n+1})\n$$\nThis equation is linear in the unknown $q_k^{n+1}$ and can be rearranged to provide an explicit update rule:\n$$\nq_k^{n+1} \\left(1 + \\frac{\\Delta t}{\\tau_k}\\right) = q_k^n + \\frac{\\Delta t}{\\tau_k} \\varepsilon^{n+1}\n$$\n$$\nq_k^{n+1} = \\frac{\\tau_k}{\\tau_k + \\Delta t} q_k^n + \\frac{\\Delta t}{\\tau_k + \\Delta t} \\varepsilon^{n+1}\n$$\nThis update formula is computationally convenient and will be used in the implementation.\n\nThe core of the task is to analyze the discrete dissipation $D^{n+1}$, defined as the difference between the incremental work $W^{n+1}$ and the change in stored free energy $\\psi^{n+1} - \\psi^n$:\n$$\nD^{n+1} = W^{n+1} - (\\psi^{n+1} - \\psi^n)\n$$\nwhere $W^{n+1} = \\sigma^{n+1} \\Delta\\varepsilon^{n+1}$ and $\\Delta\\varepsilon^{n+1} = \\varepsilon^{n+1} - \\varepsilon^n$. We must prove that $D^{n+1} \\ge 0$ for this specific algorithmic structure.\n\nLet's substitute the definitions of $W^{n+1}$ and $\\psi$ into the expression for $D^{n+1}$:\n$$\nD^{n+1} = \\sigma^{n+1}(\\varepsilon^{n+1} - \\varepsilon^n) - \\left[ \\left( \\frac{1}{2} E_{\\infty} (\\varepsilon^{n+1})^2 + \\sum_{k=1}^m \\frac{1}{2} E_k (\\varepsilon^{n+1} - q_k^{n+1})^2 \\right) - \\left( \\frac{1}{2} E_{\\infty} (\\varepsilon^n)^2 + \\sum_{k=1}^m \\frac{1}{2} E_k (\\varepsilon^n - q_k^n)^2 \\right) \\right]\n$$\nSubstituting the expression for stress $\\sigma^{n+1}$:\n$$\n\\sigma^{n+1} = E_{\\infty}\\varepsilon^{n+1} + \\sum_{k=1}^m E_k (\\varepsilon^{n+1} - q_k^{n+1})\n$$\nThe dissipation expression becomes:\n$$\nD^{n+1} = \\left( E_{\\infty}\\varepsilon^{n+1} + \\sum_{k=1}^m E_k (\\varepsilon^{n+1} - q_k^{n+1}) \\right) \\Delta\\varepsilon^{n+1} - \\frac{1}{2} E_{\\infty} ((\\varepsilon^{n+1})^2 - (\\varepsilon^n)^2) - \\sum_{k=1}^m \\frac{1}{2} E_k ((\\varepsilon^{n+1} - q_k^{n+1})^2 - (\\varepsilon^n - q_k^n)^2)\n$$\nWe can analyze the contributions from the equilibrium spring and the Maxwell elements separately.\n\nContribution from the equilibrium spring ($E_{\\infty}$):\n\\begin{align*}\nD_{\\infty}^{n+1} = E_{\\infty}\\varepsilon^{n+1} \\Delta\\varepsilon^{n+1} - \\frac{1}{2} E_{\\infty} ((\\varepsilon^{n+1})^2 - (\\varepsilon^n)^2) \\\\\n= E_{\\infty}\\varepsilon^{n+1}(\\varepsilon^{n+1} - \\varepsilon^n) - \\frac{1}{2} E_{\\infty}(\\varepsilon^{n+1} - \\varepsilon^n)(\\varepsilon^{n+1} + \\varepsilon^n) \\\\\n= \\frac{1}{2} E_{\\infty}(\\varepsilon^{n+1} - \\varepsilon^n) [2\\varepsilon^{n+1} - (\\varepsilon^{n+1} + \\varepsilon^n)] = \\frac{1}{2} E_{\\infty}(\\varepsilon^{n+1} - \\varepsilon^n)^2 = \\frac{1}{2} E_{\\infty}(\\Delta\\varepsilon^{n+1})^2\n\\end{align*}\nSince $E_{\\infty} \\ge 0$, this term is always non-negative.\n\nContribution from each Maxwell element ($k$):\nLet $h_k^n = \\varepsilon^n - q_k^n$. The BE evolution equation for $q_k$ can be written in terms of $h_k^{n+1}$ as $\\Delta q_k^{n+1} = q_k^{n+1} - q_k^n = \\frac{\\Delta t}{\\tau_k} h_k^{n+1}$.\nThe change in $h_k$ is $\\Delta h_k^{n+1} = h_k^{n+1} - h_k^n = (\\varepsilon^{n+1} - q_k^{n+1}) - (\\varepsilon^n - q_k^n) = \\Delta\\varepsilon^{n+1} - \\Delta q_k^{n+1}$.\nFrom this, we have $\\Delta\\varepsilon^{n+1} = \\Delta h_k^{n+1} + \\Delta q_k^{n+1} = \\Delta h_k^{n+1} + \\frac{\\Delta t}{\\tau_k} h_k^{n+1}$.\nThe dissipation part for element $k$, $D_k^{n+1}$, is:\n$$\nD_k^{n+1} = E_k h_k^{n+1} \\Delta\\varepsilon^{n+1} - \\frac{1}{2} E_k ((h_k^{n+1})^2 - (h_k^n)^2)\n$$\nSubstituting the expression for $\\Delta\\varepsilon^{n+1}$:\n\\begin{align*}\nD_k^{n+1} = E_k h_k^{n+1} \\left( \\Delta h_k^{n+1} + \\frac{\\Delta t}{\\tau_k} h_k^{n+1} \\right) - \\frac{1}{2} E_k ((h_k^{n+1})^2 - (h_k^n)^2) \\\\\n= E_k \\left( h_k^{n+1}(h_k^{n+1} - h_k^n) + \\frac{\\Delta t}{\\tau_k}(h_k^{n+1})^2 \\right) - \\frac{1}{2} E_k ((h_k^{n+1})^2 - (h_k^n)^2) \\\\\n= E_k \\left( (h_k^{n+1})^2 - h_k^{n+1}h_k^n + \\frac{\\Delta t}{\\tau_k}(h_k^{n+1})^2 - \\frac{1}{2}(h_k^{n+1})^2 + \\frac{1}{2}(h_k^n)^2 \\right) \\\\\n= E_k \\left( \\frac{1}{2}(h_k^{n+1})^2 - h_k^{n+1}h_k^n + \\frac{1}{2}(h_k^n)^2 + \\frac{\\Delta t}{\\tau_k}(h_k^{n+1})^2 \\right)\n\\end{align*}\nRecognizing the perfect square:\n$$\nD_k^{n+1} = \\frac{1}{2} E_k (h_k^{n+1} - h_k^n)^2 + \\frac{\\Delta t E_k}{\\tau_k} (h_k^{n+1})^2 = \\frac{1}{2} E_k (\\Delta h_k^{n+1})^2 + \\frac{\\Delta t E_k}{\\tau_k} (\\varepsilon^{n+1} - q_k^{n+1})^2\n$$\nSince the material parameters $E_k > 0$, $\\tau_k > 0$ and the time step $\\Delta t > 0$, both terms are non-negative.\n\nThe total discrete dissipation is the sum of all contributions:\n$$\nD^{n+1} = D_{\\infty}^{n+1} + \\sum_{k=1}^m D_k^{n+1} = \\frac{1}{2} E_{\\infty}(\\Delta\\varepsilon^{n+1})^2 + \\sum_{k=1}^m \\left( \\frac{1}{2} E_k (\\Delta h_k^{n+1})^2 + \\frac{\\Delta t E_k}{\\tau_k} (\\varepsilon^{n+1} - q_k^{n+1})^2 \\right)\n$$\nThis expression is a sum of non-negative terms. Therefore, $D^{n+1} \\ge 0$ is guaranteed analytically. This property is known as unconditional thermodynamic stability, and it is a key feature of the Backward Euler scheme for this class of material models.\n\nThe implementation will proceed by writing a program that simulates the strain history for each test case. At each time step $n=0, ..., N-1$, starting from $\\varepsilon^0=0, q_k^0=0$, the algorithm will:\n1.  Compute the strain increment $\\Delta\\varepsilon^{n+1} = A(-1)^n$ and the new strain $\\varepsilon^{n+1} = \\varepsilon^n + \\Delta\\varepsilon^{n+1}$.\n2.  Store the old free energy $\\psi^n$.\n3.  Calculate the new internal variables $q_k^{n+1}$ for all $k$ using the explicit update rule derived from the BE scheme.\n4.  Compute the new stress $\\sigma^{n+1}$ and new free energy $\\psi^{n+1}$.\n5.  Calculate the incremental work $W^{n+1}$ and, finally, the discrete dissipation $D^{n+1} = W^{n+1} - (\\psi^{n+1} - \\psi^n)$.\n6.  Verify if $D^{n+1} \\ge -\\mathrm{tol}$, where $\\mathrm{tol}$ is a small numerical tolerance (e.g., $10^{-9}$) to account for floating-point inaccuracies. If the condition is ever violated, the test for that case fails.\n\nBased on our proof, all test cases are expected to pass, returning `True`. Case 4, with zero strain amplitude ($A=0$), will result in all state variables remaining zero, and thus $D^{n+1}$ will be identically zero for all steps, which satisfies the non-negativity condition.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(m: int, E_inf: float, E_k: np.ndarray, tau_k: np.ndarray, dt: float, N: int, A: float) - bool:\n    \"\"\"\n    Runs a single simulation for a given set of parameters.\n\n    Args:\n        m (int): Number of Maxwell elements.\n        E_inf (float): Equilibrium elastic modulus.\n        E_k (np.ndarray): Array of elastic moduli for Maxwell elements.\n        tau_k (np.ndarray): Array of relaxation times for Maxwell elements.\n        dt (float): Time step size.\n        N (int): Number of time steps.\n        A (float): Amplitude of strain increments.\n\n    Returns:\n        bool: True if discrete dissipation is non-negative for all steps, False otherwise.\n    \"\"\"\n    # Numerical tolerance for checking non-negativity.\n    # This value is chosen to be small relative to any expected physical energy values.\n    TOL = 1e-9\n\n    # Initial conditions\n    epsilon_n = 0.0\n    q_n = np.zeros(m)  # Internal variables q_k^n\n\n    for n in range(N):\n        # 1. Calculate old free energy psi^n\n        h_n = epsilon_n - q_n\n        psi_n = 0.5 * E_inf * epsilon_n**2 + 0.5 * np.sum(E_k * h_n**2)\n\n        # 2. Update strain for step n+1\n        delta_epsilon_np1 = A * (-1)**n\n        epsilon_np1 = epsilon_n + delta_epsilon_np1\n\n        # 3. Update internal variables q_k^{n+1} using the explicit Backward Euler update rule\n        # q_k^{n+1} = (tau_k / (tau_k + dt)) * q_k^n + (dt / (tau_k + dt)) * epsilon^{n+1}\n        # This update is vectorized using numpy.\n        q_np1 = (tau_k / (tau_k + dt)) * q_n + (dt / (tau_k + dt)) * epsilon_np1\n\n        # 4. Calculate new stress sigma^{n+1}\n        h_np1 = epsilon_np1 - q_np1\n        sigma_np1 = E_inf * epsilon_np1 + np.sum(E_k * h_np1)\n\n        # 5. Calculate incremental work W^{n+1}\n        W_np1 = sigma_np1 * delta_epsilon_np1\n\n        # 6. Calculate new free energy psi^{n+1}\n        psi_np1 = 0.5 * E_inf * epsilon_np1**2 + 0.5 * np.sum(E_k * h_np1**2)\n\n        # 7. Calculate discrete dissipation D^{n+1}\n        D_np1 = W_np1 - (psi_np1 - psi_n)\n\n        # 8. Check for non-negativity\n        if D_np1  -TOL:\n            return False\n\n        # 9. Update state for the next step\n        epsilon_n = epsilon_np1\n        q_n = q_np1\n\n    return True\n\ndef solve():\n    \"\"\"\n    Defines the test suite and runs the simulation for each case.\n    \"\"\"\n    test_cases = [\n        # Case 1: General happy path\n        {'m': 2, 'E_inf': 2.6e9, 'E_k': [0.9e9, 0.4e9], 'tau_k': [0.06, 0.8], \n         'dt': 0.05, 'N': 12, 'A': 0.007},\n        \n        # Case 2: No equilibrium spring\n        {'m': 1, 'E_inf': 0.0, 'E_k': [1.2e9], 'tau_k': [0.02], \n         'dt': 0.02, 'N': 20, 'A': 0.005},\n        \n        # Case 3: Large time step relative to some tau_k\n        {'m': 3, 'E_inf': 3.0e9, 'E_k': [1.5e9, 0.5e9, 0.2e9], 'tau_k': [0.01, 0.1, 1.0], \n         'dt': 0.5, 'N': 8, 'A': 0.03},\n        \n        # Case 4: Zero amplitude increments\n        {'m': 2, 'E_inf': 1.0e9, 'E_k': [0.7e9, 0.3e9], 'tau_k': [0.2, 0.5], \n         'dt': 0.1, 'N': 10, 'A': 0.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized calculations\n        E_k_arr = np.array(case['E_k'], dtype=float)\n        tau_k_arr = np.array(case['tau_k'], dtype=float)\n        \n        is_nonnegative = run_simulation(\n            case['m'], case['E_inf'], E_k_arr, tau_k_arr, \n            case['dt'], case['N'], case['A']\n        )\n        # Format boolean as lowercase string for output\n        results.append(str(is_nonnegative).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3544081"}, {"introduction": "As we move to more complex inelastic phenomena like rate-independent plasticity, the governing equations often become non-smooth, posing significant challenges for numerical solvers. This practice introduces the powerful technique of homotopy continuation, which transforms a difficult problem into a sequence of more manageable ones [@problem_id:3544019]. You will use a physical viscosity parameter, $\\eta$, as a mathematical 'knob' to smoothly bridge the gap between a well-behaved viscoplastic model and the challenging rate-independent limit, a vital strategy for creating robust computational tools.", "problem": "Consider a one-dimensional small-strain elastoplastic material with linear isotropic hardening, modeled within the framework of algorithmic updates for internal variable models. Let the total strain be decomposed as $ \\varepsilon = \\varepsilon^{e} + \\varepsilon^{p} $, where $ \\varepsilon^{e} $ is the elastic strain and $ \\varepsilon^{p} $ is the plastic strain. The Cauchy stress is given by Hooke's law $ \\sigma = E \\, \\varepsilon^{e} $, where $ E $ is the Young's modulus (in $\\mathrm{Pa}$). The internal variable is chosen as the accumulated plastic strain $ \\alpha = \\varepsilon^{p} $, with linear isotropic hardening characterized by $ H $ (in $\\mathrm{Pa}$) and initial yield stress $ \\sigma_{y0} $ (in $\\mathrm{Pa}$). The yield function is $ f(\\sigma,\\alpha) = \\sigma - (\\sigma_{y0} + H \\alpha) $, assuming monotonic tension so that $ \\sigma \\ge 0 $ and the absolute value is not required.\n\nTo regularize and enable homotopy from viscous to rate-independent plasticity, consider a Perzyna-type viscoplastic update with an overstress parameter $ \\eta $ (in $ \\mathrm{s} $), and a backward Euler time discretization over a step of duration $ \\Delta t = 1 $ (in $ \\mathrm{s} $). The discrete plastic increment is $ \\Delta \\gamma \\ge 0 $ such that $ \\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta \\gamma $ and $ \\alpha_{n+1} = \\varepsilon^{p}_{n+1} $. The trial stress is $ \\sigma_{\\mathrm{trial}} = E \\left( \\varepsilon_{n} + \\Delta \\varepsilon - \\varepsilon^{p}_{n} \\right) $, where $ \\varepsilon_{n} $ is the previous total strain, $ \\Delta \\varepsilon $ is the strain increment over the step, and $ \\varepsilon^{p}_{n} $ is the previous plastic strain. Define the trial overstress relative to the current yield surface as $ r_{\\mathrm{trial}} = \\sigma_{\\mathrm{trial}} - \\left( \\sigma_{y0} + H \\alpha_{n} \\right) $.\n\nThe backward Euler discretization of the Perzyna rule with exponent $ m = 1 $ yields the scalar implicit update\n$$\n\\Delta \\gamma = \\frac{\\Delta t}{\\eta} \\, \\left\\langle f_{n+1} \\right\\rangle = \\frac{1}{\\eta} \\, \\max\\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma, \\, 0 \\right),\n$$\nwith $ f_{n+1} = \\sigma_{n+1} - \\left( \\sigma_{y0} + H \\alpha_{n+1} \\right) $ and $ \\sigma_{n+1} = \\sigma_{\\mathrm{trial}} - E \\Delta \\gamma $. In the viscous regime with $ \\eta  0 $, the update is well-posed. In the rate-independent limit $ \\eta \\to 0^{+} $, the plastic increment satisfies the classical consistency form $ \\Delta \\gamma = \\max(r_{\\mathrm{trial}},0)/(E+H) $.\n\nYour task is to create a homotopy continuation with respect to $ \\eta $, transitioning from a viscous state ($ \\eta $ large) to the rate-independent state ($ \\eta = 0 $), using the previous $ \\eta $-step solution as the initial guess to initialize difficult steps. For each test case, compute and report the path $ \\alpha_{n+1}(\\eta) $ over a specified sequence of $ \\eta $ values. You must implement a robust solver for the scalar nonlinear equation in $ \\Delta \\gamma $ at each $ \\eta  0 $ using Newton's method on the piecewise residual\n$$\nR(\\Delta \\gamma; \\eta) = \\Delta \\gamma - \\frac{1}{\\eta} \\, \\max\\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma, \\, 0 \\right),\n$$\nwith derivative chosen consistently with the active branch. At $ \\eta = 0 $, use the rate-independent limit $ \\Delta \\gamma = \\max(r_{\\mathrm{trial}},0)/(E+H) $.\n\nAll physical quantities must be treated with their appropriate units: $ E $ and $ H $ in $ \\mathrm{Pa} $, $ \\sigma_{y0} $ in $ \\mathrm{Pa} $, $ \\eta $ in $ \\mathrm{s} $, $ \\varepsilon $, $ \\varepsilon^{p} $, and $ \\alpha $ are dimensionless strains. The final reported $ \\alpha_{n+1}(\\eta) $ values must be dimensionless.\n\nTest Suite:\nUse the following material parameters common to metals for all tests: $ E = 200 \\times 10^{9} \\, \\mathrm{Pa} $, $ H = 1 \\times 10^{9} \\, \\mathrm{Pa} $, $ \\sigma_{y0} = 250 \\times 10^{6} \\, \\mathrm{Pa} $, $ \\Delta t = 1 \\, \\mathrm{s} $. For each test, compute $ \\alpha_{n+1}(\\eta) $ over the homotopy sequence $ \\eta \\in \\{ 10^{3}, 10^{2}, 10^{1}, 10^{0}, 10^{-1}, 10^{-2}, 0 \\} $ (in $ \\mathrm{s} $), where the last $ \\eta = 0 $ denotes the rate-independent limit.\n\n- Test $ 1 $ (strictly elastic): $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.001 $. This yields $ \\sigma_{\\mathrm{trial}} = 200 \\times 10^{6} \\, \\mathrm{Pa} $ and $ r_{\\mathrm{trial}}  0 $.\n- Test $ 2 $ (at yield boundary): $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = \\sigma_{y0}/E = 0.00125 $. This yields $ r_{\\mathrm{trial}} = 0 $.\n- Test $ 3 $ (moderately plastic): $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.002 $. This yields $ r_{\\mathrm{trial}}  0 $.\n- Test $ 4 $ (strongly plastic): $ \\varepsilon_{n} = 0 $, $ \\varepsilon^{p}_{n} = 0 $, $ \\Delta \\varepsilon = 0.005 $. This yields $ r_{\\mathrm{trial}} \\gg 0 $.\n\nRequired Output:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each of the four test cases, output the list of $ \\alpha_{n+1}(\\eta) $ values corresponding to the ordered $ \\eta $ sequence $ \\{ 10^{3}, 10^{2}, 10^{1}, 10^{0}, 10^{-1}, 10^{-2}, 0 \\} $. Hence the final output format must be\n$$\n\\text{[ [a_{1,1}, a_{1,2}, \\dots, a_{1,7}], [a_{2,1}, \\dots, a_{2,7}], [a_{3,1}, \\dots, a_{3,7}], [a_{4,1}, \\dots, a_{4,7}] ]},\n$$\nwhere each $ a_{i,j} $ is a dimensionless float representing $ \\alpha_{n+1}(\\eta_{j}) $ for test $ i $.", "solution": "We start from the small-strain one-dimensional kinematics $ \\varepsilon = \\varepsilon^{e} + \\varepsilon^{p} $, and Hooke's law $ \\sigma = E \\varepsilon^{e} $, where $E$ is the Young's modulus. The internal variable for isotropic hardening is chosen as $ \\alpha = \\varepsilon^{p} $, and the yield function in monotonic tension is $ f(\\sigma,\\alpha) = \\sigma - (\\sigma_{y0} + H \\alpha) $, with $\\sigma_{y0}$ the initial yield stress and $H$ the linear hardening modulus.\n\nConsider the discrete update from step $n$ to step $n+1$ over duration $\\Delta t = 1$. Define the trial stress, under the assumption of known previous total strain $\\varepsilon_{n}$ and strain increment $\\Delta \\varepsilon$, as\n$$\n\\sigma_{\\mathrm{trial}} = E \\left( \\varepsilon_{n} + \\Delta \\varepsilon - \\varepsilon^{p}_{n} \\right).\n$$\nThe updated plastic strain is $\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta \\gamma$ with $\\Delta \\gamma \\ge 0$. The updated stress then is\n$$\n\\sigma_{n+1} = E \\left( \\varepsilon_{n} + \\Delta \\varepsilon - \\varepsilon^{p}_{n+1} \\right) = \\sigma_{\\mathrm{trial}} - E \\Delta \\gamma.\n$$\nThe updated internal variable is $\\alpha_{n+1} = \\varepsilon^{p}_{n+1} = \\alpha_{n} + \\Delta \\gamma$. The updated yield function is\n$$\nf_{n+1} = \\sigma_{n+1} - \\left( \\sigma_{y0} + H \\alpha_{n+1} \\right) = \\sigma_{\\mathrm{trial}} - E \\Delta \\gamma - \\left( \\sigma_{y0} + H \\alpha_{n} + H \\Delta \\gamma \\right).\n$$\nGroup terms to define the trial overstress relative to the current yield surface,\n$$\nr_{\\mathrm{trial}} := \\sigma_{\\mathrm{trial}} - \\left( \\sigma_{y0} + H \\alpha_{n} \\right),\n$$\nso that the updated yield function reads\n$$\nf_{n+1} = r_{\\mathrm{trial}} - (E+H) \\Delta \\gamma.\n$$\n\nFor viscoplasticity using the Perzyna-type overstress regularization with exponent $m = 1$ and overstress parameter $\\eta$, the backward Euler discretization (with $\\Delta t = 1$) yields the implicit scalar equation\n$$\n\\Delta \\gamma = \\frac{1}{\\eta} \\, \\left\\langle f_{n+1} \\right\\rangle = \\frac{1}{\\eta} \\, \\max\\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma, \\, 0 \\right).\n$$\nDefine the residual for Newton's method,\n$$\nR(\\Delta \\gamma; \\eta) = \\Delta \\gamma - \\frac{1}{\\eta} \\, \\max\\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma, \\, 0 \\right).\n$$\nThere are two regimes:\n\n- If $r_{\\mathrm{trial}} \\le 0$, the elastic regime, then $\\langle f_{n+1} \\rangle = 0$, and the only admissible solution is $\\Delta \\gamma = 0$, hence $\\alpha_{n+1} = \\alpha_{n}$ for any $\\eta \\ge 0$.\n\n- If $r_{\\mathrm{trial}} > 0$, the plastic regime, then the solution must satisfy $r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma > 0$ at convergence (because otherwise the right-hand side of the equation would be zero and falsely enforce $\\Delta \\gamma = 0$). On this active branch, the residual simplifies to a linear form,\n$$\nR(\\Delta \\gamma; \\eta) = \\Delta \\gamma - \\frac{1}{\\eta} \\left( r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma \\right) = \\Delta \\gamma \\left( 1 + \\frac{E+H}{\\eta} \\right) - \\frac{r_{\\mathrm{trial}}}{\\eta}.\n$$\nSetting $R = 0$ yields the unique solution for $\\eta > 0$,\n$$\n\\Delta \\gamma(\\eta) = \\frac{r_{\\mathrm{trial}}}{\\eta + E + H}.\n$$\nOne may verify consistency: substituting back gives $f_{n+1} = r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma = r_{\\mathrm{trial}} \\left( \\frac{\\eta}{\\eta + E + H} \\right) > 0$, as required for $r_{\\mathrm{trial}} > 0$ and $\\eta > 0$. As $\\eta \\to 0^{+}$, the rate-independent limit becomes\n$$\n\\Delta \\gamma(0) = \\frac{r_{\\mathrm{trial}}}{E+H},\n$$\nwhich is the classical return-mapping update for linear isotropic hardening in one dimension.\n\nHence, the path of the internal variable $\\alpha_{n+1}(\\eta)$ is\n$$\n\\alpha_{n+1}(\\eta) =\n\\begin{cases}\n\\alpha_{n},  r_{\\mathrm{trial}} \\le 0, \\\\\n\\alpha_{n} + \\dfrac{r_{\\mathrm{trial}}}{\\eta + E + H},  r_{\\mathrm{trial}}  0,\\; \\eta  0, \\\\\n\\alpha_{n} + \\dfrac{r_{\\mathrm{trial}}}{E + H},  r_{\\mathrm{trial}}  0,\\; \\eta = 0.\n\\end{cases}\n$$\nThis path is monotone decreasing with respect to $\\eta$ for $r_{\\mathrm{trial}} > 0$, because the denominator $\\eta + E + H$ increases with $\\eta$, while for $r_{\\mathrm{trial}} \\le 0$ the path is constant.\n\nHomotopy continuation algorithm:\nWe proceed from a large $\\eta$ value in the viscous regime to the rate-independent limit $\\eta = 0$, using the solution at the previous $\\eta$ step as the initial guess for Newton's method. For $\\eta > 0$, the residual on the active branch has derivative\n$$\n\\frac{\\partial R}{\\partial \\Delta \\gamma} =\n\\begin{cases}\n1,  r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma \\le 0, \\\\\n1 + \\dfrac{E+H}{\\eta},  r_{\\mathrm{trial}} - (E+H)\\Delta \\gamma  0,\n\\end{cases}\n$$\nwhich ensures that Newton's method converges in a single iteration in the active branch because the residual is linear in $\\Delta \\gamma$. Nevertheless, we implement Newton's method robustly and guard the branch condition by evaluating the max operator explicitly. At $\\eta = 0$, we use the explicit rate-independent limit $\\Delta \\gamma = \\max(r_{\\mathrm{trial}},0)/(E+H)$.\n\nTest suite specification and units:\nFor all tests, use $E = 200 \\times 10^{9} \\, \\mathrm{Pa}$, $H = 1 \\times 10^{9} \\, \\mathrm{Pa}$, $\\sigma_{y0} = 250 \\times 10^{6} \\, \\mathrm{Pa}$, $\\Delta t = 1 \\, \\mathrm{s}$. The strain variables $\\varepsilon$, $\\varepsilon^{p}$, and $\\alpha$ are dimensionless; the reported $\\alpha_{n+1}(\\eta)$ values must be dimensionless. The sequence of homotopy parameters is $\\eta \\in \\{ 10^{3}, 10^{2}, 10^{1}, 10^{0}, 10^{-1}, 10^{-2}, 0 \\}$ in $\\mathrm{s}$.\n\nFor the four tests:\n- Test $1$: $\\varepsilon_{n} = 0$, $\\varepsilon^{p}_{n} = 0$, $\\Delta \\varepsilon = 0.001$ gives $\\sigma_{\\mathrm{trial}} = 200 \\times 10^{6} \\, \\mathrm{Pa}$ and $r_{\\mathrm{trial}} = -50 \\times 10^{6} \\, \\mathrm{Pa} \\le 0$, so $\\alpha_{n+1}(\\eta) = 0$ for all $\\eta$.\n- Test $2$: $\\varepsilon_{n} = 0$, $\\varepsilon^{p}_{n} = 0$, $\\Delta \\varepsilon = \\sigma_{y0}/E = 0.00125$ yields $r_{\\mathrm{trial}} = 0$, so $\\alpha_{n+1}(\\eta) = 0$ for all $\\eta$.\n- Test $3$: $\\varepsilon_{n} = 0$, $\\varepsilon^{p}_{n} = 0$, $\\Delta \\varepsilon = 0.002$ gives $\\sigma_{\\mathrm{trial}} = 400 \\times 10^{6} \\, \\mathrm{Pa}$, $r_{\\mathrm{trial}} = 150 \\times 10^{6} \\, \\mathrm{Pa} > 0$, so $\\alpha_{n+1}(\\eta) = \\dfrac{150 \\times 10^{6}}{\\eta + 201 \\times 10^{9}}$.\n- Test $4$: $\\varepsilon_{n} = 0$, $\\varepsilon^{p}_{n} = 0$, $\\Delta \\varepsilon = 0.005$ gives $\\sigma_{\\mathrm{trial}} = 1 \\times 10^{9} \\, \\mathrm{Pa}$, $r_{\\mathrm{trial}} = 750 \\times 10^{6} \\, \\mathrm{Pa} > 0$, so $\\alpha_{n+1}(\\eta) = \\dfrac{750 \\times 10^{6}}{\\eta + 201 \\times 10^{9}}$.\n\nThe program will implement the homotopy continuation and Newton's method for completeness, even though the closed-form solution is available; it will compute and output the lists $\\left[ \\alpha_{n+1}(10^{3}), \\alpha_{n+1}(10^{2}), \\alpha_{n+1}(10^{1}), \\alpha_{n+1}(10^{0}), \\alpha_{n+1}(10^{-1}), \\alpha_{n+1}(10^{-2}), \\alpha_{n+1}(0) \\right]$ for each test in the specified format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_delta_gamma(r_trial: float, E: float, H: float, eta: float, init_gamma: float = 0.0, tol: float = 1e-16, max_iter: int = 25) - float:\n    \"\"\"\n    Solve the scalar viscoplastic update for Delta gamma using Newton's method on:\n        R(gamma; eta) = gamma - (1/eta) * max(r_trial - (E+H)*gamma, 0) = 0  for eta  0.\n    For eta == 0, return the rate-independent limit gamma = max(r_trial, 0)/(E+H).\n    \"\"\"\n    if r_trial = 0.0:\n        # Elastic: no plastic increment for any eta.\n        return 0.0\n    if eta == 0.0:\n        # Rate-independent limit.\n        return r_trial / (E + H)\n\n    gamma = max(init_gamma, 0.0)\n    for _ in range(max_iter):\n        # Evaluate residual with the max operator.\n        arg = r_trial - (E + H) * gamma\n        pos_part = arg if arg  0.0 else 0.0\n        R = gamma - (pos_part / eta)\n        # Derivative depends on the active branch.\n        if arg  0.0:\n            dR = 1.0 + (E + H) / eta\n        else:\n            dR = 1.0\n        # Newton update\n        delta = -R / dR\n        gamma += delta\n        # Safeguards: gamma must be nonnegative\n        if gamma  0.0:\n            gamma = 0.0\n        # Convergence check\n        if abs(delta)  tol:\n            break\n    # Final projection to active branch if needed\n    if r_trial - (E + H) * gamma = 0.0:\n        # If we fell into the inactive branch, the correct solution is gamma = 0\n        # but since r_trial  0 for entering this function, the active solution exists.\n        # To ensure robustness, use the closed form.\n        gamma = r_trial / (eta + E + H)\n    return gamma\n\ndef compute_alpha_path(E: float, H: float, sigma_y0: float, eps_n: float, eps_p_n: float, delta_eps: float, eta_values: list[float]) - list[float]:\n    \"\"\"\n    Compute alpha_{n+1}(eta) along a homotopy path of eta values, using continuation:\n    previous solution as initial guess for the next eta.\n    \"\"\"\n    sigma_trial = E * (eps_n + delta_eps - eps_p_n)\n    r_trial = sigma_trial - (sigma_y0 + H * eps_p_n)\n    alpha_n = eps_p_n\n    path = []\n    prev_gamma = 0.0\n    for eta in eta_values:\n        gamma = solve_delta_gamma(r_trial, E, H, eta, init_gamma=prev_gamma)\n        alpha_np1 = alpha_n + gamma\n        path.append(alpha_np1)\n        prev_gamma = gamma\n    return path\n\ndef solve():\n    # Material parameters (SI units)\n    E = 200.0e9      # Pa\n    H = 1.0e9        # Pa\n    sigma_y0 = 250.0e6  # Pa\n    # Homotopy eta values (s), including the rate-independent limit represented by 0\n    eta_values = [1e3, 1e2, 1e1, 1e0, 1e-1, 1e-2, 0.0]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (eps_n, eps_p_n, delta_eps) for each test\n        (0.0, 0.0, 0.001),          # Test 1: strictly elastic\n        (0.0, 0.0, sigma_y0 / E),   # Test 2: at yield boundary\n        (0.0, 0.0, 0.002),          # Test 3: moderately plastic\n        (0.0, 0.0, 0.005),          # Test 4: strongly plastic\n    ]\n\n    results = []\n    for eps_n, eps_p_n, delta_eps in test_cases:\n        path = compute_alpha_path(E, H, sigma_y0, eps_n, eps_p_n, delta_eps, eta_values)\n        # Convert to regular Python floats for printing\n        results.append([float(x) for x in path])\n\n    # Final print statement in the exact required format.\n    # Single line: nested lists for the four test cases.\n    def format_list(lst):\n        return \"[\" + \",\".join(f\"{x:.12g}\" for x in lst) + \"]\"\n    print(\"[\" + \",\".join(format_list(r) for r in results) + \"]\")\n\nsolve()\n```", "id": "3544019"}]}