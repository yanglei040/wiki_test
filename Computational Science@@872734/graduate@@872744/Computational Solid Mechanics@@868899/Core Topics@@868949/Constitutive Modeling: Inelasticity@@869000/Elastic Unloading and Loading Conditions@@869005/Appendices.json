{"hands_on_practices": [{"introduction": "The cornerstone of most algorithms in computational plasticity is the elastic predictor-plastic corrector scheme. The first and most critical step is the decision-making process: we tentatively assume the material behaves elastically and compute a 'trial' stress state. This practice [@problem_id:3560485] guides you through this fundamental calculation, where you will evaluate the von Mises yield function at the trial state to determine whether the material undergoes elastic unloading or if plastic loading has commenced, necessitating a correction.", "problem": "A three-dimensional small-strain, isotropic von Mises (also called $J_{2}$) plasticity model with linear isotropic hardening is used to simulate a biaxial loading-unloading cycle. The elastic response is characterized by Young’s modulus $E$ and Poisson’s ratio $\\nu$. The plastic response is characterized by an initial yield stress $\\sigma_{y0}$ and an isotropic hardening modulus $H$. The current (converged) state at time $t_{n}$ is known to be on the yield surface. The following data are given:\n- $E = 210\\ \\mathrm{GPa}$, $\\nu = 0.30$,\n- $\\sigma_{y0} = 250\\ \\mathrm{MPa}$, $H = 1000\\ \\mathrm{MPa}$,\n- Cauchy stress at $t_{n}$: $\\boldsymbol{\\sigma}_{n} = \\mathrm{diag}(300,\\,300,\\,0)\\ \\mathrm{MPa}$,\n- Accumulated equivalent plastic strain at $t_{n}$: $\\bar{\\varepsilon}^{p}_{n} = 0.050$,\n- No shear strains are applied in what follows.\n\nTwo successive strain increments are applied:\n- Step $A$: $\\Delta \\boldsymbol{\\varepsilon}^{(A)} = \\mathrm{diag}\\!\\left(-1.0\\times 10^{-4},\\,-1.0\\times 10^{-4},\\,0\\right)$,\n- Step $B$: $\\Delta \\boldsymbol{\\varepsilon}^{(B)} = \\mathrm{diag}\\!\\left(2.0\\times 10^{-4},\\,2.0\\times 10^{-4},\\,0\\right)$.\n\nUsing the elastic predictor at each step, compute the trial Cauchy stress and the corresponding von Mises yield function value $f_{\\mathrm{tr}}$ based on linear isotropic hardening evaluated with the hardening variable at the start of the step. Decide, for each step, whether the increment is accepted as elastic (and if so, whether it corresponds to elastic unloading or elastic loading) or requires a plastic corrector (plastic loading).\n\nReport, as your final answer, the scalar value of the yield function $f_{\\mathrm{tr}}$ for Step $B$. Express the final value in $\\mathrm{MPa}$ and round your answer to four significant figures.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and internally consistent.\n\n**1. Givens Extraction and Validation**\n\nThe provided data consists of material properties for a small-strain, isotropic elastic-plastic material model ($J_2$ plasticity with linear isotropic hardening), an initial stress and internal state variable configuration, and two subsequent strain increments.\nMaterial properties: Young’s modulus $E = 210\\ \\mathrm{GPa}$, Poisson’s ratio $\\nu = 0.30$, initial yield stress $\\sigma_{y0} = 250\\ \\mathrm{MPa}$, and isotropic hardening modulus $H = 1000\\ \\mathrm{MPa}$.\nState at time $t_{n}$: Cauchy stress $\\boldsymbol{\\sigma}_{n} = \\mathrm{diag}(300,\\,300,\\,0)\\ \\mathrm{MPa}$, and accumulated equivalent plastic strain $\\bar{\\varepsilon}^{p}_{n} = 0.050$.\nStrain increments: $\\Delta \\boldsymbol{\\varepsilon}^{(A)} = \\mathrm{diag}(-1.0\\times 10^{-4},\\,-1.0\\times 10^{-4},\\,0)$ and $\\Delta \\boldsymbol{\\varepsilon}^{(B)} = \\mathrm{diag}(2.0\\times 10^{-4},\\,2.0\\times 10^{-4},\\,0)$.\n\nThe problem states that the initial state is on the yield surface. This assertion must be verified. The von Mises yield function is given by $f = \\sigma_{\\mathrm{eq}} - \\sigma_y(\\bar{\\varepsilon}^{p})$, where $\\sigma_{\\mathrm{eq}}$ is the von Mises equivalent stress and $\\sigma_y(\\bar{\\varepsilon}^{p})$ is the current yield stress.\n\nFirst, we compute the deviatoric part of the Cauchy stress $\\boldsymbol{\\sigma}_{n}$.\nThe trace of the stress tensor is $\\mathrm{tr}(\\boldsymbol{\\sigma}_{n}) = 300 + 300 + 0 = 600\\ \\mathrm{MPa}$.\nThe hydrostatic stress is $p_n = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}_{n}) = \\frac{1}{3}(600) = 200\\ \\mathrm{MPa}$.\nThe deviatoric stress tensor is $\\mathbf{s}_{n} = \\boldsymbol{\\sigma}_{n} - p_n \\mathbf{I} = \\mathrm{diag}(300-200,\\,300-200,\\,0-200)\\ \\mathrm{MPa} = \\mathrm{diag}(100,\\,100,\\,-200)\\ \\mathrm{MPa}$.\n\nThe von Mises equivalent stress is $\\sigma_{\\mathrm{eq},n} = \\sqrt{\\frac{3}{2}\\mathbf{s}_{n}:\\mathbf{s}_{n}}$.\n$\\mathbf{s}_{n}:\\mathbf{s}_{n} = s_{11}^2 + s_{22}^2 + s_{33}^2 = (100)^2 + (100)^2 + (-200)^2 = 10000 + 10000 + 40000 = 60000\\ \\mathrm{MPa}^2$.\n$\\sigma_{\\mathrm{eq},n} = \\sqrt{\\frac{3}{2}(60000)} = \\sqrt{90000} = 300\\ \\mathrm{MPa}$.\n\nNext, we compute the current yield stress based on linear isotropic hardening: $\\sigma_y(\\bar{\\varepsilon}^{p}_{n}) = \\sigma_{y0} + H \\bar{\\varepsilon}^{p}_{n}$.\n$\\sigma_y(\\bar{\\varepsilon}^{p}_{n}) = 250\\ \\mathrm{MPa} + (1000\\ \\mathrm{MPa})(0.050) = 250 + 50 = 300\\ \\mathrm{MPa}$.\n\nThe yield function value at $t_n$ is $f_n = \\sigma_{\\mathrm{eq},n} - \\sigma_y(\\bar{\\varepsilon}^{p}_{n}) = 300\\ \\mathrm{MPa} - 300\\ \\mathrm{MPa} = 0$.\nThe initial state is indeed on the yield surface. The problem is consistent and well-posed. The material properties are realistic for steel. We can proceed with the solution.\n\n**2. Constitutive Relations and Elastic Predictor**\n\nThe analysis uses the elastic predictor step of the return-mapping algorithm. For a given strain increment $\\Delta\\boldsymbol{\\varepsilon}$, we assume the entire increment is elastic, $\\Delta\\boldsymbol{\\varepsilon}^e = \\Delta\\boldsymbol{\\varepsilon}$. The trial stress increment $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}$ is computed using the isotropic linear elastic constitutive law (Hooke's Law):\n$\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\lambda \\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon})\\mathbf{I} + 2\\mu\\Delta\\boldsymbol{\\varepsilon}$,\nwhere $\\lambda$ and $\\mu$ are the Lamé parameters.\nThe trial stress state is $\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{\\text{start}} + \\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}$. We then evaluate the trial yield function, $f_{\\mathrm{tr}} = \\sigma_{\\mathrm{eq,tr}} - \\sigma_y(\\bar{\\varepsilon}^{p}_{\\text{start}})$.\nIf $f_{\\mathrm{tr}} \\le 0$, the step is elastic. If $f_{\\mathrm{tr}} > 0$, plastic loading occurs, and a corrector step is required.\n\nLet's compute the Lamé parameters from $E=210000\\ \\mathrm{MPa}$ and $\\nu=0.3$.\nShear modulus: $\\mu = \\frac{E}{2(1+\\nu)} = \\frac{210000}{2(1+0.3)} = \\frac{210000}{2.6} = \\frac{1050000}{13}\\ \\mathrm{MPa}$.\nFirst Lamé parameter: $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} = \\frac{210000 \\times 0.3}{(1+0.3)(1-2 \\times 0.3)} = \\frac{63000}{1.3 \\times 0.4} = \\frac{63000}{0.52} = \\frac{1575000}{13}\\ \\mathrm{MPa}$.\n\n**3. Analysis of Step A**\n\nThe initial state is $(\\boldsymbol{\\sigma}_n, \\bar{\\varepsilon}^p_n)$. The strain increment is $\\Delta \\boldsymbol{\\varepsilon}^{(A)} = \\mathrm{diag}(-1.0\\times 10^{-4},\\,-1.0\\times 10^{-4},\\,0)$.\nThe trace is $\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^{(A)}) = -1.0\\times 10^{-4} - 1.0\\times 10^{-4} + 0 = -2.0\\times 10^{-4}$.\nThe components of the trial stress increment $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}$ are:\n$\\Delta\\sigma_{\\mathrm{tr}, 11}^{(A)} = \\lambda \\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^{(A)}) + 2\\mu \\Delta\\varepsilon_{11}^{(A)} = \\frac{1575000}{13}(-2.0\\times 10^{-4}) + 2\\frac{1050000}{13}(-1.0\\times 10^{-4}) = \\frac{-315}{13} - \\frac{210}{13} = -\\frac{525}{13}\\ \\mathrm{MPa}$.\nSince $\\Delta\\varepsilon_{11}^{(A)} = \\Delta\\varepsilon_{22}^{(A)}$, $\\Delta\\sigma_{\\mathrm{tr}, 22}^{(A)} = -\\frac{525}{13}\\ \\mathrm{MPa}$.\n$\\Delta\\sigma_{\\mathrm{tr}, 33}^{(A)} = \\lambda \\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^{(A)}) + 2\\mu \\Delta\\varepsilon_{33}^{(A)} = \\frac{1575000}{13}(-2.0\\times 10^{-4}) + 0 = -\\frac{315}{13}\\ \\mathrm{MPa}$.\nSo, $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)} = \\mathrm{diag}(-\\frac{525}{13},\\, -\\frac{525}{13},\\, -\\frac{315}{13})\\ \\mathrm{MPa}$.\n\nThe trial stress is $\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)} = \\boldsymbol{\\sigma}_{n} + \\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}$.\n$\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)} = \\mathrm{diag}(300 - \\frac{525}{13},\\, 300 - \\frac{525}{13},\\, -\\frac{315}{13})\\ \\mathrm{MPa} = \\mathrm{diag}(\\frac{3375}{13},\\, \\frac{3375}{13},\\, -\\frac{315}{13})\\ \\mathrm{MPa}$.\n\nTo compute the trial von Mises stress $\\sigma_{\\mathrm{eq,tr}}^{(A)}$, we find the deviatoric part $\\mathbf{s}_{\\mathrm{tr}}^{(A)}$.\n$\\mathrm{tr}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}) = 2(\\frac{3375}{13}) - \\frac{315}{13} = \\frac{6435}{13}\\ \\mathrm{MPa}$.\n$p_{\\mathrm{tr}}^{(A)} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}) = \\frac{2145}{13}\\ \\mathrm{MPa}$.\n$s_{\\mathrm{tr}, 11}^{(A)} = \\frac{3375}{13} - \\frac{2145}{13} = \\frac{1230}{13}\\ \\mathrm{MPa}$.\n$s_{\\mathrm{tr}, 22}^{(A)} = \\frac{1230}{13}\\ \\mathrm{MPa}$.\n$s_{\\mathrm{tr}, 33}^{(A)} = -\\frac{315}{13} - \\frac{2145}{13} = -\\frac{2460}{13}\\ \\mathrm{MPa}$.\n$\\mathbf{s}_{\\mathrm{tr}}^{(A)}:\\mathbf{s}_{\\mathrm{tr}}^{(A)} = 2(\\frac{1230}{13})^2 + (-\\frac{2460}{13})^2 = \\frac{1}{169}(2 \\cdot 1230^2 + (2 \\cdot 1230)^2) = \\frac{6 \\cdot 1230^2}{169}$.\n$\\sigma_{\\mathrm{eq,tr}}^{(A)} = \\sqrt{\\frac{3}{2} \\frac{6 \\cdot 1230^2}{169}} = \\sqrt{\\frac{9 \\cdot 1230^2}{169}} = \\frac{3 \\cdot 1230}{13} = \\frac{3690}{13}\\ \\mathrm{MPa}$.\n\nThe trial yield function is $f_{\\mathrm{tr}}^{(A)} = \\sigma_{\\mathrm{eq,tr}}^{(A)} - \\sigma_y(\\bar{\\varepsilon}^{p}_{n}) = \\frac{3690}{13} - 300 = \\frac{3690-3900}{13} = -\\frac{210}{13}\\ \\mathrm{MPa}$.\nSince $f_{\\mathrm{tr}}^{(A)} \\approx -16.15\\ \\mathrm{MPa}  0$, the elastic assumption is valid. The step corresponds to elastic unloading. The new state is $(\\boldsymbol{\\sigma}_{n+1/2}, \\bar{\\varepsilon}^p_{n+1/2})$ where $\\boldsymbol{\\sigma}_{n+1/2} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}$ and $\\bar{\\varepsilon}^p_{n+1/2} = \\bar{\\varepsilon}^p_n = 0.050$.\n\n**4. Analysis of Step B**\n\nStep B starts from the state at the end of Step A. The starting stress is $\\boldsymbol{\\sigma}_{n+1/2} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}$ and the hardening variable is $\\bar{\\varepsilon}^p_{n+1/2} = 0.050$. The strain increment is $\\Delta \\boldsymbol{\\varepsilon}^{(B)} = \\mathrm{diag}(2.0\\times 10^{-4},\\,2.0\\times 10^{-4},\\,0)$.\nNote that $\\Delta \\boldsymbol{\\varepsilon}^{(B)} = -2 \\Delta \\boldsymbol{\\varepsilon}^{(A)}$. Due to the linearity of the elastic law, the trial stress increment is also related: $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = -2 \\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}$.\n$\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = -2 \\mathrm{diag}(-\\frac{525}{13},\\, -\\frac{525}{13},\\, -\\frac{315}{13}) = \\mathrm{diag}(\\frac{1050}{13},\\, \\frac{1050}{13},\\, \\frac{630}{13})\\ \\mathrm{MPa}$.\n\nThe trial stress for Step B is $\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = \\boldsymbol{\\sigma}_{n+1/2} + \\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)} + \\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)}$.\n$\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = \\mathrm{diag}(\\frac{3375}{13} + \\frac{1050}{13},\\, \\frac{3375}{13} + \\frac{1050}{13},\\, -\\frac{315}{13} + \\frac{630}{13})\\ \\mathrm{MPa}$.\n$\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = \\mathrm{diag}(\\frac{4425}{13},\\, \\frac{4425}{13},\\, \\frac{315}{13})\\ \\mathrm{MPa}$.\n\nNow, we compute the trial von Mises stress $\\sigma_{\\mathrm{eq,tr}}^{(B)}$.\n$\\mathrm{tr}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)}) = 2(\\frac{4425}{13}) + \\frac{315}{13} = \\frac{9165}{13}\\ \\mathrm{MPa}$.\n$p_{\\mathrm{tr}}^{(B)} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)}) = \\frac{3055}{13}\\ \\mathrm{MPa}$.\n$s_{\\mathrm{tr}, 11}^{(B)} = \\frac{4425}{13} - \\frac{3055}{13} = \\frac{1370}{13}\\ \\mathrm{MPa}$.\n$s_{\\mathrm{tr}, 22}^{(B)} = \\frac{1370}{13}\\ \\mathrm{MPa}$.\n$s_{\\mathrm{tr}, 33}^{(B)} = \\frac{315}{13} - \\frac{3055}{13} = -\\frac{2740}{13}\\ \\mathrm{MPa}$.\n$\\mathbf{s}_{\\mathrm{tr}}^{(B)}:\\mathbf{s}_{\\mathrm{tr}}^{(B)} = 2(\\frac{1370}{13})^2 + (-\\frac{2740}{13})^2 = \\frac{6 \\cdot 1370^2}{169}$.\n$\\sigma_{\\mathrm{eq,tr}}^{(B)} = \\sqrt{\\frac{3}{2} \\frac{6 \\cdot 1370^2}{169}} = \\sqrt{\\frac{9 \\cdot 1370^2}{169}} = \\frac{3 \\cdot 1370}{13} = \\frac{4110}{13}\\ \\mathrm{MPa}$.\n\nThe yield stress for the check is evaluated at the start of Step B, using $\\bar{\\varepsilon}^p_{n+1/2} = 0.050$.\n$\\sigma_y(\\bar{\\varepsilon}^p_{n+1/2}) = \\sigma_y(\\bar{\\varepsilon}^p_{n}) = 300\\ \\mathrm{MPa}$.\nThe trial yield function for Step B is $f_{\\mathrm{tr}}^{(B)} = \\sigma_{\\mathrm{eq,tr}}^{(B)} - \\sigma_y(\\bar{\\varepsilon}^p_{n+1/2})$.\n$f_{\\mathrm{tr}}^{(B)} = \\frac{4110}{13} - 300 = \\frac{4110-3900}{13} = \\frac{210}{13}\\ \\mathrm{MPa}$.\n\nSince $f_{\\mathrm{tr}}^{(B)} = \\frac{210}{13} \\approx 16.1538\\ \\mathrm{MPa} > 0$, the elastic assumption is invalid. The trial state lies outside the yield surface. This signifies plastic loading, and a plastic corrector step would be necessary to find the true final state.\n\nThe problem asks for the scalar value of $f_{\\mathrm{tr}}$ for Step B, in MPa, rounded to four significant figures.\n$f_{\\mathrm{tr}}^{(B)} = \\frac{210}{13} \\approx 16.153846\\ \\mathrm{MPa}$.\nRounding to four significant figures gives $16.15$.", "answer": "$$\\boxed{16.15}$$", "id": "3560485"}, {"introduction": "Real materials exhibit memory of their past plastic deformation, a feature captured through hardening laws. This exercise [@problem_id:3560476] moves beyond simple models to explore combined isotropic and kinematic hardening, which describe the expansion and translation of the yield surface, respectively. By analyzing a one-dimensional loading-unloading-reloading cycle, you will directly observe how kinematic hardening gives rise to the Bauschinger effect, a reduction in yield strength upon load reversal, which is critical for accurately simulating cyclic material behavior.", "problem": "A one-dimensional small-strain von Mises plasticity model with combined isotropic–kinematic hardening is considered. The material obeys the following ingredients of rate-independent associative plasticity:\n\n- The yield function is\n$$\nf(\\sigma,\\alpha,R) = |\\sigma - \\alpha| - \\left(\\sigma_{y0} + R\\right),\n$$\nwhere $\\sigma$ is the Cauchy stress, $\\alpha$ is the scalar backstress (the center of the yield surface in one dimension), $R$ is the scalar isotropic hardening variable (the increase in yield surface radius), and $\\sigma_{y0}$ is the initial yield stress.\n\n- Isotropic hardening is linear,\n$$\nR = H_{\\text{iso}}\\,\\bar{\\epsilon}^{p},\n$$\nwhere $H_{\\text{iso}}$ is the isotropic hardening modulus and $\\bar{\\epsilon}^{p}$ is the equivalent plastic strain. In one dimension with monotonic loading, take $\\bar{\\epsilon}^{p} = |\\epsilon^{p}|$, where $\\epsilon^{p}$ is the plastic strain.\n\n- Kinematic hardening is linear in one dimension along the loading direction,\n$$\n\\alpha = H_{\\text{kin}}\\,\\epsilon^{p},\n$$\nwhere $H_{\\text{kin}}$ is the one-dimensional kinematic hardening modulus. No static or dynamic recovery is present, so that internal variables evolve only with plastic flow.\n\n- The standard Kuhn–Tucker conditions hold:\n$$\nf \\le 0,\\quad \\dot{\\lambda} \\ge 0,\\quad \\dot{\\lambda}\\,f = 0,\n$$\nwith associative flow so that $\\dot{\\epsilon}^{p} \\propto \\partial f/\\partial \\sigma$, implying $\\dot{\\epsilon}^{p} = 0$ whenever $f0$.\n\nAt time $t_0$ after prior monotonic tensile plastic loading, the state is known to be exactly on the yield surface in tension with the following internal variables:\n$$\n\\bar{\\epsilon}^{p}_0 = 0.010,\\qquad \\epsilon^{p}_0 = 0.010,\\qquad \\sigma_{y0} = 250\\ \\mathrm{MPa},\\qquad H_{\\text{iso}} = 1000\\ \\mathrm{MPa},\\qquad H_{\\text{kin}} = 5000\\ \\mathrm{MPa}.\n$$\nNo further plastic flow occurs during unloading. The body is then unloaded elastically from $t_0$ down to $\\sigma=0$, after which it is reloaded in compression (negative $\\sigma$) until plastic flow reinitiates.\n\nTasks:\n\n1) Using only the above definitions and principles, determine the change in yield surface size $\\Delta R$ and the change in yield surface center $\\Delta \\alpha$ during the elastic unloading from $t_0$ to $\\sigma=0$.\n\n2) Determine the value of the compressive Cauchy stress $\\sigma$ (a negative number) at which plastic reloading first initiates upon reversal from $\\sigma=0$. Use the given model and data to obtain a closed-form expression and its numerical value.\n\nAnswer specification:\n- Provide any intermediate expressions needed for clarity in your derivation.\n- For your final reported result, output only the compressive stress at which plastic reloading initiates, in $\\mathrm{MPa}$, as a single number. No rounding is required beyond exact arithmetic. Do not include units in the final boxed answer.", "solution": "The user-provided problem is first subject to a validation check.\n\n### Step 1: Extract Givens\n-   **Model**: One-dimensional small-strain von Mises plasticity with combined isotropic–kinematic hardening. Rate-independent associative plasticity.\n-   **Yield Function**: $f(\\sigma,\\alpha,R) = |\\sigma - \\alpha| - (\\sigma_{y0} + R)$, where $\\sigma$ is Cauchy stress, $\\alpha$ is backstress, $R$ is isotropic hardening variable, and $\\sigma_{y0}$ is initial yield stress.\n-   **Isotropic Hardening**: $R = H_{\\text{iso}}\\,\\bar{\\epsilon}^{p}$, where $H_{\\text{iso}}$ is the isotropic hardening modulus and $\\bar{\\epsilon}^{p}$ is the equivalent plastic strain. For 1D monotonic loading, $\\bar{\\epsilon}^{p} = |\\epsilon^{p}|$.\n-   **Kinematic Hardening**: $\\alpha = H_{\\text{kin}}\\,\\epsilon^{p}$, where $H_{\\text{kin}}$ is the one-dimensional kinematic hardening modulus.\n-   **Flow Rule**: Standard Kuhn–Tucker conditions ($f \\le 0, \\dot{\\lambda} \\ge 0, \\dot{\\lambda}f = 0$) and associative flow ($\\dot{\\epsilon}^{p} \\propto \\partial f/\\partial \\sigma$).\n-   **State at time $t_0$**: The state is on the yield surface in tension after prior monotonic tensile plastic loading.\n-   **Material and State Parameters**:\n    -   $\\bar{\\epsilon}^{p}_0 = 0.010$\n    -   $\\epsilon^{p}_0 = 0.010$\n    -   $\\sigma_{y0} = 250\\ \\mathrm{MPa}$\n    -   $H_{\\text{iso}} = 1000\\ \\mathrm{MPa}$\n    -   $H_{\\text{kin}} = 5000\\ \\mathrm{MPa}$\n-   **Process**: Elastic unloading from state $t_0$ to $\\sigma=0$, followed by compressive reloading until plastic flow reinitiates. During unloading, no further plastic flow occurs.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Soundness**: The problem describes a standard, well-established model in continuum mechanics and the theory of plasticity (Prager-Ziegler hardening model). The equations and principles are fundamental to the field.\n2.  **Non-Formalizable or Irrelevant**: The problem is a formal exercise in computational solid mechanics and directly relates to elastic unloading and loading conditions.\n3.  **Incomplete or Contradictory Setup**: The problem is self-contained. All necessary material parameters and initial state variables are provided. The condition of monotonic tensile loading is consistent with $\\epsilon^{p}_0 > 0$ and $\\bar{\\epsilon}^{p}_0 = \\epsilon^{p}_0$.\n4.  **Unrealistic or Infeasible**: The numerical values for yield stress and hardening moduli are within a realistic range for metallic materials. The described loading-unloading-reloading path is a standard experimental and computational procedure.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed and has a unique, stable solution based on the provided model.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires a step-by-step application of plasticity theory and is a non-trivial exercise.\n7.  **Outside Scientific Verifiability**: The problem is entirely based on verifiable mathematical and physical principles.\n\n### Step 3: Verdict and Action\nThe problem is well-posed, scientifically sound, and internally consistent. It is deemed **valid**. A solution will be provided.\n\n---\n\nThe solution is derived in three steps: first, determining the full state of the material at time $t_0$; second, analyzing the elastic unloading process; and third, determining the stress at which plastic flow reinitiates in compression.\n\nFirst, we determine the values of the internal variables $R_0$ (isotropic hardening) and $\\alpha_0$ (kinematic hardening) at time $t_0$. Using the provided hardening laws and state variables:\nThe isotropic hardening variable is given by $R = H_{\\text{iso}}\\,\\bar{\\epsilon}^{p}$. At $t_0$, its value is:\n$$\nR_0 = H_{\\text{iso}}\\,\\bar{\\epsilon}^{p}_0 = (1000\\ \\mathrm{MPa}) \\times 0.010 = 10\\ \\mathrm{MPa}\n$$\nThe kinematic hardening variable (backstress) is given by $\\alpha = H_{\\text{kin}}\\,\\epsilon^{p}$. At $t_0$, its value is:\n$$\n\\alpha_0 = H_{\\text{kin}}\\,\\epsilon^{p}_0 = (5000\\ \\mathrm{MPa}) \\times 0.010 = 50\\ \\mathrm{MPa}\n$$\n\n**Task 1: Determine $\\Delta R$ and $\\Delta \\alpha$ during elastic unloading.**\n\nThe problem states that the body is unloaded elastically from the state at $t_0$ down to $\\sigma=0$. By definition, an elastic process involves no change in plastic strain, i.e., $\\dot{\\epsilon}^{p} = 0$. Consequently, the equivalent plastic strain also does not change, $\\dot{\\bar{\\epsilon}}^{p} = 0$.\n\nThe evolution of the internal variables $R$ and $\\alpha$ is governed by the plastic strain rates:\n$$\n\\dot{R} = H_{\\text{iso}}\\,\\dot{\\bar{\\epsilon}}^{p}\n$$\n$$\n\\dot{\\alpha} = H_{\\text{kin}}\\,\\dot{\\epsilon}^{p}\n$$\nSince $\\dot{\\epsilon}^{p} = 0$ and $\\dot{\\bar{\\epsilon}}^{p} = 0$ during the entire elastic unloading process, it follows that $\\dot{R} = 0$ and $\\dot{\\alpha} = 0$. This means the internal variables $R$ and $\\alpha$ remain constant throughout the unloading phase.\nTherefore, the change in the yield surface size and center during elastic unloading is zero:\n$$\n\\Delta R = 0\n$$\n$$\n\\Delta \\alpha = 0\n$$\nThe state of the material at the end of unloading (at $\\sigma = 0$) is characterized by $\\sigma = 0$, $R = R_0 = 10\\ \\mathrm{MPa}$, and $\\alpha = \\alpha_0 = 50\\ \\mathrm{MPa}$.\n\n**Task 2: Determine the compressive stress at which plastic reloading initiates.**\n\nAfter unloading, the material is reloaded in compression (negative $\\sigma$) from the state $\\sigma=0$. This reloading process is also elastic until the yield criterion is met. During this elastic reloading, the internal variables continue to remain constant at their values from time $t_0$, so $R = R_0$ and $\\alpha = \\alpha_0$.\n\nPlastic flow will reinitiate when the stress state $\\sigma$ once again satisfies the yield condition $f=0$:\n$$\nf(\\sigma, \\alpha_0, R_0) = |\\sigma - \\alpha_0| - (\\sigma_{y0} + R_0) = 0\n$$\nWe are reloading in compression, so we anticipate that the re-yield stress $\\sigma$ will be a negative value. The backstress $\\alpha_0 = 50\\ \\mathrm{MPa}$ is positive. Therefore, the term $\\sigma - \\alpha_0$ is negative.\nThis implies that the absolute value term can be written as:\n$$\n|\\sigma - \\alpha_0| = -(\\sigma - \\alpha_0) = \\alpha_0 - \\sigma\n$$\nSubstituting this into the yield condition gives:\n$$\n(\\alpha_0 - \\sigma) - (\\sigma_{y0} + R_0) = 0\n$$\nWe can now solve for the compressive stress $\\sigma$ at re-yield. This provides the requested closed-form expression:\n$$\n\\sigma = \\alpha_0 - (\\sigma_{y0} + R_0)\n$$\nFinally, we substitute the known numerical values to find the specific stress value:\n-   $\\alpha_0 = 50\\ \\mathrm{MPa}$\n-   $\\sigma_{y0} = 250\\ \\mathrm{MPa}$\n-   $R_0 = 10\\ \\mathrm{MPa}$\n\n$$\n\\sigma = 50\\ \\mathrm{MPa} - (250\\ \\mathrm{MPa} + 10\\ \\mathrm{MPa})\n$$\n$$\n\\sigma = 50\\ \\mathrm{MPa} - 260\\ \\mathrm{MPa}\n$$\n$$\n\\sigma = -210\\ \\mathrm{MPa}\n$$\nThus, plastic reloading initiates when the compressive stress reaches $-210\\ \\mathrm{MPa}$. This phenomenon, where the magnitude of the yield stress in compression is reduced after tensile plastic deformation, is known as the Bauschinger effect, which is captured by the kinematic hardening component of the model.", "answer": "$$\n\\boxed{-210}\n$$", "id": "3560476"}, {"introduction": "Bridging the gap between theory and practical application is a key skill in computational mechanics. This comprehensive practice [@problem_id:3560499] challenges you to implement a complete stress-update algorithm for $J_2$ plasticity from first principles. More than just coding the return-mapping scheme, you will also develop and track diagnostic indicators to assess the accuracy, stability, and physical realism of your simulation, learning to identify potential issues like numerical drift and spurious plasticity.", "problem": "Consider a small-strain, rate-independent, isotropic elastoplastic material governed by associative von Mises (also called $J_2$) plasticity with linear isotropic hardening. Let the Cauchy stress tensor be $\\sigma$, the total infinitesimal strain tensor be $\\varepsilon$, and the plastic strain be $\\varepsilon^{p}$. The elastic stiffness is defined by Young’s modulus $E$ and Poisson’s ratio $\\nu$, with shear modulus $G = \\dfrac{E}{2(1+\\nu)}$ and bulk modulus $K = \\dfrac{E}{3(1-2\\nu)}$. The additive decomposition holds, $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$, and linear elasticity gives $\\sigma = 2 G \\, \\mathrm{dev}(\\varepsilon^{e}) + K \\, \\mathrm{tr}(\\varepsilon^{e}) \\, I$, where $I$ is the identity tensor. The von Mises equivalent stress is $\\sigma_{\\mathrm{eq}} = \\sqrt{\\dfrac{3}{2} \\, s:s}$ with deviatoric stress $s = \\mathrm{dev}(\\sigma) = \\sigma - \\dfrac{1}{3} \\mathrm{tr}(\\sigma) I$. Let the hardening variable be the equivalent plastic strain $p$, with yield stress $\\sigma_{y}(p) = \\sigma_{y0} + H \\, p$, where $\\sigma_{y0}$ is the initial yield stress and $H$ is the (constant) hardening modulus.\n\nThe flow rule is associative with plastic multiplier $\\lambda$ and Kuhn–Tucker conditions\n$ \\lambda \\ge 0,\\quad f(\\sigma,p) \\le 0,\\quad \\lambda \\, f(\\sigma,p) = 0,$\nwhere the yield function is $f(\\sigma,p) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(p)$. During plastic loading at the yield surface, enforce the consistency condition $\\dot{f} = 0$. During elastic unloading (including at the yield surface), enforce $\\dot{\\lambda}=0$.\n\nImplement a computational stress-update algorithm per time step (incremental strains) as follows:\n- Start from known state $(\\sigma_{n}, p_{n})$ and a given total strain increment $\\Delta \\varepsilon$.\n- Form the elastic trial state $(\\sigma_{\\mathrm{trial}}, p_{n})$ using $\\Delta \\varepsilon$ and elastic response (with $\\Delta \\varepsilon^{p} = 0$ in the trial).\n- Use the consistency condition $\\dot{f}=0$ for plastic loading and $\\dot{\\lambda}=0$ for elastic unloading to determine whether the step is elastic or plastic, and to update $(\\sigma_{n+1}, p_{n+1})$ accordingly.\n- Use the equivalent plastic strain increment definition $\\Delta p = \\sqrt{\\dfrac{2}{3}} \\, \\|\\Delta \\varepsilon^{p}\\|$ (where $\\|\\cdot\\|$ is the Frobenius norm) and the associative flow rule to construct the return mapping without relying on any pre-provided shortcut formulas.\n\nYou must also compute diagnostic indicators that quantify numerical drift and potential spurious plasticity:\n- For each increment classified as plastic, compute the absolute consistency residual $|f_{n+1}|$ after the update. Define $r_1$ for a loading path as the maximum of these values (units: $\\mathrm{Pa}$).\n- For each increment classified as elastic, compute $\\max(f_{n+1}, 0)$ after the update. Define $r_2$ for a loading path as the maximum of these values (units: $\\mathrm{Pa}$).\n- To detect spurious plasticity during elastic unloading caused by numerical drift, use a discrete unloading indicator based on the trial state. Let $f_n$ be the yield function evaluated at $(\\sigma_n, p_n)$ and $f_{\\mathrm{trial}}$ at $(\\sigma_{\\mathrm{trial}}, p_n)$. If $|f_n| \\le \\tau_y$ and $f_{\\mathrm{trial}} - f_n  0$ (a move inward from the yield surface) but the algorithm produces $\\Delta p > 0$, accumulate this $\\Delta p$ as spurious. Define $r_3$ for a loading path as the total accumulated spurious $\\Delta p$ (dimensionless).\n- Use a fixed yield-surface tolerance $\\tau_y = 10^{-6} \\, \\sigma_{y0}$ (units: $\\mathrm{Pa}$) for classifying elastic versus plastic and for the unloading detection above. Express all stresses in $\\mathrm{Pa}$ and strains as dimensionless numbers.\n\nYour program must implement the above algorithm and produce the diagnostics $(r_1, r_2, r_3)$ for each of the following test loading paths (all with the same material parameters):\n- Material parameters for all tests: $E = 2.10 \\times 10^{11} \\, \\mathrm{Pa}$, $\\nu = 0.3$, $\\sigma_{y0} = 2.50 \\times 10^{8} \\, \\mathrm{Pa}$, $H = 1.00 \\times 10^{9} \\, \\mathrm{Pa}$.\n- Test $\\#1$ (purely elastic uniaxial straining): five increments of uniaxial strain in the $x$-direction, with $\\Delta \\varepsilon_{xx} = 1.00 \\times 10^{-4}$ and all other components zero, i.e., \n$\\Delta \\varepsilon^{(k)} = \\begin{bmatrix} 1.00 \\times 10^{-4}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$ for $k = 1,\\dots,5$.\n- Test $\\#2$ (plastic loading then elastic unloading in uniaxial straining): eight increments, the first four are $\\Delta \\varepsilon_{xx} = 5.00 \\times 10^{-4}$, followed by four unloading increments $\\Delta \\varepsilon_{xx} = -2.50 \\times 10^{-4}$, with all other components zero in each increment, i.e., \n$\\Delta \\varepsilon^{(k)} = \\begin{bmatrix} 5.00 \\times 10^{-4}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$ for $k=1,2,3,4$ and \n$\\Delta \\varepsilon^{(k)} = \\begin{bmatrix} -2.50 \\times 10^{-4}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$ for $k=5,6,7,8$.\n- Test $\\#3$ (oscillation about the yield surface in uniaxial straining): one larger increment to reach and exceed yield followed by small oscillations, with all other components zero:\n$\\Delta \\varepsilon^{(1)} = \\begin{bmatrix} 1.20 \\times 10^{-3}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$, then for $m = 1,\\dots,10$, two-step oscillations\n$\\Delta \\varepsilon^{(2m)} = \\begin{bmatrix} 1.00 \\times 10^{-5}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$ and\n$\\Delta \\varepsilon^{(2m+1)} = \\begin{bmatrix} -1.00 \\times 10^{-5}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$,\nfor a total of $21$ steps.\n- Test $\\#4$ (pure hydrostatic straining): five increments of purely volumetric strain, each \n$\\Delta \\varepsilon^{(k)} = 1.00 \\times 10^{-4} \\, I = \\begin{bmatrix} 1.00 \\times 10^{-4}  0  0 \\\\ 0  1.00 \\times 10^{-4}  0 \\\\ 0  0  1.00 \\times 10^{-4} \\end{bmatrix}$ for $k=1,\\dots,5$.\n\nYour program should compute $(r_1, r_2, r_3)$ for each test and produce a single line of output containing the results as a comma-separated list of lists in the order of the tests, where each inner list is $[r_1, r_2, r_3]$ (e.g., $\\left[\\,[r_{1}^{(1)}, r_{2}^{(1)}, r_{3}^{(1)}], [r_{1}^{(2)}, r_{2}^{(2)}, r_{3}^{(2)}], \\dots \\right]$). Express $r_1$ and $r_2$ in $\\mathrm{Pa}$ and $r_3$ as a dimensionless number. No angles are involved. No percentages should be printed; use decimal representations for all quantities.", "solution": "The user has provided a problem in the domain of computational solid mechanics, specifically focusing on rate-independent $J_2$ elastoplasticity with linear isotropic hardening. The task is to implement a stress-update algorithm and compute a set of diagnostic indicators for four distinct loading paths.\n\n### Problem Validation\n\nThe problem statement has been rigorously validated and is determined to be **valid**.\n\n1.  **Givens Extraction**: All required parameters and definitions are explicitly provided:\n    *   **Material Model**: Small-strain, rate-independent, isotropic elastoplasticity ($J_2$ with linear isotropic hardening).\n    *   **Material Parameters**: Young's Modulus $E = 2.10 \\times 10^{11} \\, \\mathrm{Pa}$, Poisson's Ratio $\\nu = 0.3$, initial yield stress $\\sigma_{y0} = 2.50 \\times 10^{8} \\, \\mathrm{Pa}$, and hardening modulus $H = 1.00 \\times 10^{9} \\, \\mathrm{Pa}$.\n    *   **Constitutive Relations**: Additive strain decomposition $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$, linear elasticity $\\sigma = 2 G \\, \\mathrm{dev}(\\varepsilon^{e}) + K \\, \\mathrm{tr}(\\varepsilon^{e}) \\, I$, associative flow rule, and yield condition $f(\\sigma,p) = \\sigma_{\\mathrm{eq}} - (\\sigma_{y0} + H p) \\le 0$.\n    *   **Algorithm**: The standard elastic-predictor, plastic-corrector (return mapping) algorithm is specified.\n    *   **Diagnostics**: Three indicators, $r_1, r_2, r_3$, are precisely defined to measure consistency residual, elastic drift, and spurious plasticity.\n    *   **Loading Paths**: Four test cases with well-defined incremental strain tensors are given.\n\n2.  **Validation Checks**:\n    *   **Scientifically Grounded**: The problem is based on the classical theory of plasticity, a fundamental and well-established part of solid mechanics. All equations are standard and correct.\n    *   **Well-Posed**: The problem is well-posed. The backward-Euler integration scheme (return mapping) for the given constitutive model is known to provide a unique and stable solution for a given strain increment.\n    *   **Objective and Complete**: The problem is stated objectively with precise numerical values and mathematical definitions. It is self-contained and provides all information necessary for implementation.\n    *   **Realistic**: The material parameters are representative of steel, and the strain increments are within the small-strain assumption, making the problem physically realistic.\n\nThe problem is a standard, albeit detailed, implementation task in computational mechanics. It is valid in all respects.\n\n### Algorithmic Approach\n\nThe solution involves implementing a function that performs a single stress update for a given strain increment, and then calling this function iteratively for each step in the provided loading paths.\n\n#### 1. Material Constants\nFirst, the shear modulus $G$ and bulk modulus $K$ are calculated from the given Young's modulus $E$ and Poisson's ratio $\\nu$:\n$$ G = \\frac{E}{2(1+\\nu)} $$\n$$ K = \\frac{E}{3(1-2\\nu)} $$\nThe yield surface tolerance $\\tau_y$ is also pre-calculated as $\\tau_y = 10^{-6} \\sigma_{y0}$.\n\n#### 2. Stress Update Algorithm\nFor each increment, starting from a known state $(\\sigma_n, p_n)$, the algorithm proceeds as follows:\n\n1.  **Elastic Predictor**: An elastic trial state is computed by assuming the entire strain increment $\\Delta\\varepsilon$ is elastic. The trial stress $\\sigma_{\\mathrm{trial}}$ is:\n    $$ \\sigma_{\\mathrm{trial}} = \\sigma_n + 2G \\, \\mathrm{dev}(\\Delta\\varepsilon) + K \\, \\mathrm{tr}(\\Delta\\varepsilon) I $$\n    The equivalent plastic strain remains unchanged in the trial step, $p_{\\mathrm{trial}} = p_n$.\n\n2.  **Yield Check**: The yield function is evaluated at the trial state:\n    $$ f_{\\mathrm{trial}} = \\sigma_{\\mathrm{eq, trial}} - (\\sigma_{y0} + H p_n) $$\n    where $\\sigma_{\\mathrm{eq, trial}} = \\sqrt{\\frac{3}{2} s_{\\mathrm{trial}}:s_{\\mathrm{trial}}}$.\n    If $f_{\\mathrm{trial}} \\le \\tau_y$, the step is elastic. The state is updated to $(\\sigma_{n+1}, p_{n+1}) = (\\sigma_{\\mathrm{trial}}, p_n)$.\n\n3.  **Plastic Corrector (Return Mapping)**: If $f_{\\mathrm{trial}} > \\tau_y$, the step involves plastic deformation. A return mapping algorithm is used to enforce the consistency condition, bringing the stress state back to the updated yield surface. The derivation from first principles, as requested, is as follows:\n    *   The state update is $\\sigma_{n+1} = \\sigma_{\\mathrm{trial}} - 2G \\Delta\\varepsilon^p$ (since plastic flow is isochoric, $\\mathrm{tr}(\\Delta\\varepsilon^p)=0$).\n    *   The associative flow rule is $\\Delta\\varepsilon^p = \\Delta\\lambda \\, \\frac{\\partial f}{\\partial \\sigma} = \\Delta\\lambda \\, \\frac{3}{2} \\frac{s_{n+1}}{\\sigma_{\\mathrm{eq},n+1}}$. This is an implicit formulation. The radial return algorithm uses an explicit approximation based on the trial state's normal direction: $s_{n+1}$ is assumed to be coaxial with $s_{\\mathrm{trial}}$.\n    *   From the flow rule, it can be shown that the plastic multiplier increment $\\Delta\\lambda$ is equal to the equivalent plastic strain increment $\\Delta p$.\n    *   The final state must lie on the yield surface: $f_{n+1} = \\sigma_{\\mathrm{eq},n+1} - (\\sigma_{y0} + H p_{n+1}) = 0$.\n    *   Combining the geometric relationship $\\sigma_{\\mathrm{eq},n+1} = \\sigma_{\\mathrm{eq},trial} - 3G \\Delta p$ with the consistency condition gives an explicit formula for $\\Delta p$:\n        $$ \\Delta p = \\frac{f_{\\mathrm{trial}}}{3G + H} $$\n    *   The state is then updated:\n        $$ p_{n+1} = p_n + \\Delta p $$\n        $$ \\sigma_{n+1} = s_{n+1} + \\frac{1}{3}\\mathrm{tr}(\\sigma_{\\mathrm{trial}})I, \\quad \\text{where } s_{n+1} = s_{\\mathrm{trial}} \\left(1 - \\frac{3G\\Delta p}{\\sigma_{\\mathrm{eq, trial}}}\\right) $$\n\n#### 3. Diagnostic Indicators\nFor each loading path, three diagnostics are computed:\n*   $r_1$: The maximum absolute value of the consistency residual, $|f_{n+1}|$, over all plastic steps. This measures the accuracy of the return mapping.\n*   $r_2$: The maximum value of $\\max(f_{n+1}, 0)$ over all elastic steps. This measures any drift outside the yield surface during elastic loading.\n*   $r_3$: The total accumulated spurious plastic strain $\\Delta p$. This is triggered if a step, identified as unloading from the yield surface (i.e., $|f_n| \\le \\tau_y$ and $f_{\\mathrm{trial}}  f_n$), is nonetheless classified as plastic by the algorithm ($\\Delta p > 0$). The implemented algorithm is robust, so this value is expected to be zero.\n\nThe described logic is encapsulated into a Python program that iterates through the four specified test cases and computes the diagnostics for each.", "answer": "```python\nimport numpy as np\n\ndef dev(tensor):\n    \"\"\"Computes the deviatoric part of a 3x3 tensor.\"\"\"\n    return tensor - (1/3) * np.trace(tensor) * np.identity(3)\n\ndef von_mises(sigma):\n    \"\"\"Computes the von Mises equivalent stress for a 3x3 Cauchy stress tensor.\"\"\"\n    s = dev(sigma)\n    # The Frobenius inner product s:s is equivalent to np.sum(s*s)\n    s_dot_s = np.sum(s * s)\n    # Handle the case where stress is purely hydrostatic to avoid sqrt of small negative number\n    if s_dot_s  1e-24: # Use a small tolerance instead of direct comparison\n        return 0.0\n    return np.sqrt(3/2 * s_dot_s)\n\ndef yield_f(sigma, p, sigma_y0, H):\n    \"\"\"Computes the value of the yield function.\"\"\"\n    sigma_eq = von_mises(sigma)\n    sigma_y = sigma_y0 + H * p\n    return sigma_eq - sigma_y\n\ndef run_test_path(strain_increments, E, nu, sigma_y0, H):\n    \"\"\"Runs a simulation for a given loading path and returns diagnostic indicators.\"\"\"\n    # Derived material properties\n    G = E / (2 * (1 + nu))\n    K = E / (3 * (1 - 2 * nu))\n    tau_y = 1e-6 * sigma_y0\n\n    # Initial state\n    sigma_n = np.zeros((3, 3))\n    p_n = 0.0\n\n    # Diagnostic accumulators\n    r1 = 0.0  # Max |f_np1| for plastic steps\n    r2 = 0.0  # Max max(f_np1, 0) for elastic steps\n    r3 = 0.0  # Accumulated spurious delta_p\n\n    for delta_eps in strain_increments:\n        # Calculate yield function at the beginning of the step for r3 check\n        f_n = yield_f(sigma_n, p_n, sigma_y0, H)\n\n        # 1. Elastic Trial Step\n        tr_delta_eps = np.trace(delta_eps)\n        dev_delta_eps = dev(delta_eps)\n        delta_sigma_trial = 2 * G * dev_delta_eps + K * tr_delta_eps * np.identity(3)\n        sigma_trial = sigma_n + delta_sigma_trial\n\n        # Current yield stress\n        sigma_y_n = sigma_y0 + p_n * H\n        \n        # Trial yield function value\n        sigma_eq_trial = von_mises(sigma_trial)\n        f_trial = sigma_eq_trial - sigma_y_n\n\n        delta_p = 0.0 # Initialize delta_p for the step\n\n        # 2. Check for Plasticity (Elastic/Plastic decision)\n        if f_trial = tau_y:\n            # Elastic step\n            sigma_np1 = sigma_trial\n            p_np1 = p_n\n            \n            f_np1 = yield_f(sigma_np1, p_np1, sigma_y0, H)\n            r2 = max(r2, max(f_np1, 0.0))\n\n        else:\n            # Plastic step (Return Mapping)\n            delta_p = f_trial / (3 * G + H)\n            p_np1 = p_n + delta_p\n            \n            s_trial = dev(sigma_trial)\n            \n            if sigma_eq_trial > 1e-12: # Avoid division by zero\n                s_np1 = s_trial * (1 - (3 * G * delta_p) / sigma_eq_trial)\n            else:\n                s_np1 = s_trial\n                \n            hydro_stress_trial = (1/3) * np.trace(sigma_trial)\n            sigma_np1 = s_np1 + hydro_stress_trial * np.identity(3)\n\n            f_np1 = yield_f(sigma_np1, p_np1, sigma_y0, H)\n            r1 = max(r1, abs(f_np1))\n\n        # 3. Spurious Plasticity Check (for r3)\n        is_on_surface = abs(f_n) = tau_y\n        is_unloading = (f_trial - f_n)  0\n        \n        if is_on_surface and is_unloading:\n            if delta_p > 0:\n                r3 += delta_p\n        \n        # 4. Update state for the next increment\n        sigma_n = sigma_np1\n        p_n = p_np1\n        \n    return [r1, r2, r3]\n\ndef solve():\n    \"\"\"\n    Defines and runs the test cases, then prints the results in the required format.\n    \"\"\"\n    # Material parameters from the problem statement\n    E = 2.10e11  # Pa\n    nu = 0.3\n    sigma_y0 = 2.50e8  # Pa\n    H = 1.00e9   # Pa\n\n    # Test Case #1: Purely elastic uniaxial straining\n    strain_path1 = []\n    delta_eps1 = np.zeros((3, 3))\n    delta_eps1[0, 0] = 1.00e-4\n    for _ in range(5):\n        strain_path1.append(delta_eps1)\n\n    # Test Case #2: Plastic loading then elastic unloading in uniaxial straining\n    strain_path2 = []\n    delta_eps2a = np.zeros((3, 3)); delta_eps2a[0, 0] = 5.00e-4\n    delta_eps2b = np.zeros((3, 3)); delta_eps2b[0, 0] = -2.50e-4\n    for _ in range(4):\n        strain_path2.append(delta_eps2a)\n    for _ in range(4):\n        strain_path2.append(delta_eps2b)\n\n    # Test Case #3: Oscillation about the yield surface in uniaxial straining\n    strain_path3 = []\n    delta_eps3_initial = np.zeros((3, 3)); delta_eps3_initial[0, 0] = 1.20e-3\n    delta_eps3_load = np.zeros((3, 3)); delta_eps3_load[0, 0] = 1.00e-5\n    delta_eps3_unload = np.zeros((3, 3)); delta_eps3_unload[0, 0] = -1.00e-5\n    strain_path3.append(delta_eps3_initial)\n    for _ in range(10):\n        strain_path3.append(delta_eps3_load)\n        strain_path3.append(delta_eps3_unload)\n\n    # Test Case #4: Pure hydrostatic straining\n    strain_path4 = []\n    delta_eps4 = np.identity(3) * 1.00e-4\n    for _ in range(5):\n        strain_path4.append(delta_eps4)\n        \n    test_cases = [\n        # (Parameter set 1) -> corresponds to Test #1 above\n        strain_path1,\n        # (Parameter set 2) -> Test #2\n        strain_path2,\n        # (Parameter set 3) -> Test #3\n        strain_path3,\n        # (Parameter set 4) -> Test #4\n        strain_path4,\n    ]\n    \n    results = []\n    for case_path in test_cases:\n        res = run_test_path(case_path, E, nu, sigma_y0, H)\n        results.append(res)\n    \n    # Format the output string to match the problem's specification exactly,\n    # i.e., a list of lists with no spaces.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "3560499"}]}