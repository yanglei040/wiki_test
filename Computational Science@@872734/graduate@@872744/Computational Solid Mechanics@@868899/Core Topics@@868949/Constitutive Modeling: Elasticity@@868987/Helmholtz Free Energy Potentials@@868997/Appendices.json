{"hands_on_practices": [{"introduction": "A cornerstone of continuum thermodynamics is the role of the Helmholtz free energy, $\\psi$, as a potential function for deriving constitutive relations. This exercise provides a foundational application of this principle, tasking you with deriving the stress state in a thermoelastic solid. By starting from a given free energy potential that includes thermal effects, you will practice applying the fundamental relation $\\boldsymbol{\\sigma} = \\partial\\psi/\\partial\\boldsymbol{\\varepsilon}$ and integrating it with principles of static equilibrium and mechanical boundary conditions to solve a complete boundary value problem. [@problem_id:3569898]", "problem": "A slender, prismatic bar occupies the interval $x \\in [0,L]$ in its reference configuration, has constant cross-sectional area $A$, and is made of an isotropic, small-strain thermoelastic solid. The bar’s lateral surface is traction-free, and there are no body forces. The bar is axially restrained such that $u(0)=0$ and $u(L)=0$, where $u(x)$ is the axial displacement. The absolute temperature field is prescribed and steady: $T(x)=T_{\\mathrm{ref}}+\\theta_{0}+b\\,x+c\\,x^{2}$, where $T_{\\mathrm{ref}}$ is a reference temperature, and $\\theta_{0}$, $b$, and $c$ are given constants.\n\nThe material Helmholtz free energy per unit reference volume is\n$$\n\\psi(\\boldsymbol{\\varepsilon},T)\n=\\frac{1}{2}\\,\\lambda\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}-3\\,\\alpha\\,[T-T_{\\mathrm{ref}}]\\right)^{2}\n+\\mu\\left(\\boldsymbol{\\varepsilon}-\\alpha\\,[T-T_{\\mathrm{ref}}]\\boldsymbol{I}\\right):\\left(\\boldsymbol{\\varepsilon}-\\alpha\\,[T-T_{\\mathrm{ref}}]\\boldsymbol{I}\\right),\n$$\nwhere $\\boldsymbol{\\varepsilon}$ is the small (infinitesimal) strain tensor, $\\lambda$ and $\\mu$ are the Lamé moduli, $\\alpha$ is a constant coefficient of linear thermal expansion, and $\\boldsymbol{I}$ is the identity tensor. Assume the temperature dependence of $\\lambda, \\mu$, and $\\alpha$ is negligible over the range of interest.\n\nStarting from this free energy and the thermodynamic structure of hyperelasticity, derive the expression for the axial Cauchy stress $\\sigma_{11}(x)$ in the bar under the given thermal field and mechanical constraints. Express your final answer in terms of $E$, $\\nu$, $\\alpha$, $\\theta_{0}$, $b$, $c$, and $L$, where $E$ is Young’s modulus and $\\nu$ is Poisson’s ratio, using the standard relationships between $(\\lambda,\\mu)$ and $(E,\\nu)$. State the final axial stress in Pascals. Your final answer must be a single closed-form analytic expression. If any numerical evaluation were needed, round to four significant figures; however, for this problem, provide an exact expression with no rounding.", "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- **Geometry and Configuration:** A slender, prismatic bar on $x \\in [0,L]$ with constant cross-sectional area $A$.\n- **Material Model:** Isotropic, small-strain thermoelastic solid.\n- **Helmholtz Free Energy:** $\\psi(\\boldsymbol{\\varepsilon},T) = \\frac{1}{2}\\,\\lambda\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}-3\\,\\alpha\\,[T-T_{\\mathrm{ref}}]\\right)^{2} + \\mu\\left(\\boldsymbol{\\varepsilon}-\\alpha\\,[T-T_{\\mathrm{ref}}]\\boldsymbol{I}\\right):\\left(\\boldsymbol{\\varepsilon}-\\alpha\\,[T-T_{\\mathrm{ref}}]\\boldsymbol{I}\\right)$.\n- **Mechanical Boundary Conditions:** $u(0)=0$ and $u(L)=0$.\n- **Thermal Field:** $T(x)=T_{\\mathrm{ref}}+\\theta_{0}+b\\,x+c\\,x^{2}$.\n- **Loads/Tractions:** The lateral surface is traction-free, and there are no body forces.\n- **Constants:** Lamé moduli $\\lambda, \\mu$; coefficient of linear thermal expansion $\\alpha$; reference temperature $T_{\\mathrm{ref}}$; and coefficients of the thermal field $\\theta_{0}, b, c$.\n- **Task:** Derive the axial Cauchy stress $\\sigma_{11}(x)$ in terms of Young's modulus $E$, Poisson's ratio $\\nu$, $\\alpha$, $\\theta_{0}$, $b$, $c$, and $L$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is based on the standard theory of linear thermoelasticity. The provided Helmholtz free energy potential is a valid and standard representation for an isotropic thermoelastic material.\n- **Well-Posedness:** The problem specifies the geometry, material law, boundary conditions ($u(0)$ and $u(L)$), and thermal loading. This constitutes a well-posed boundary value problem in one dimension.\n- **Objectivity:** The problem is stated using precise, objective, and standard terminology from continuum mechanics.\n- **Conclusion:** The problem is deemed valid as it is consistent, scientifically sound, and well-posed.\n\n**Step 3: Proceed with Solution**\n\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}$ is related to the Helmholtz free energy per unit reference volume $\\psi$ by the thermodynamic relation $\\boldsymbol{\\sigma} = \\frac{\\partial\\psi}{\\partial\\boldsymbol{\\varepsilon}}$. Let $\\theta(x) = T(x)-T_{\\mathrm{ref}} = \\theta_{0}+b\\,x+c\\,x^{2}$. The given free energy is:\n$$\n\\psi(\\boldsymbol{\\varepsilon}, \\theta) = \\frac{1}{2}\\,\\lambda\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}-3\\,\\alpha\\,\\theta\\right)^{2} + \\mu\\left(\\boldsymbol{\\varepsilon}-\\alpha\\,\\theta\\boldsymbol{I}\\right):\\left(\\boldsymbol{\\varepsilon}-\\alpha\\,\\theta\\boldsymbol{I}\\right)\n$$\nPerforming the differentiation using indicial notation yields the components of the stress tensor, $\\sigma_{ij}$:\n$$\n\\sigma_{ij} = \\frac{\\partial\\psi}{\\partial\\varepsilon_{ij}} = \\lambda\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}-3\\,\\alpha\\,\\theta\\right)\\delta_{ij} + 2\\mu\\left(\\varepsilon_{ij}-\\alpha\\,\\theta\\delta_{ij}\\right)\n$$\nThis can be rearranged into the more standard form of the Duhamel-Neumann constitutive relations:\n$$\n\\sigma_{ij} = \\lambda\\varepsilon_{kk}\\delta_{ij} + 2\\mu\\varepsilon_{ij} - (3\\lambda+2\\mu)\\alpha\\theta\\delta_{ij}\n$$\nFor a slender bar with traction-free lateral surfaces, the stress components normal to the axis of the bar are zero, i.e., $\\sigma_{22}=0$ and $\\sigma_{33}=0$. Due to the axial symmetry of the loading and geometry, we also have $\\varepsilon_{22} = \\varepsilon_{33}$.\nSetting $\\sigma_{22}=0$:\n$$\n\\sigma_{22} = \\lambda(\\varepsilon_{11}+2\\varepsilon_{22}) + 2\\mu\\varepsilon_{22} - (3\\lambda+2\\mu)\\alpha\\theta = 0\n$$\n$$\n\\lambda\\varepsilon_{11} + (2\\lambda+2\\mu)\\varepsilon_{22} = (3\\lambda+2\\mu)\\alpha\\theta\n$$\nFrom this, we can solve for the transverse strain $\\varepsilon_{22}$:\n$$\n\\varepsilon_{22} = \\frac{(3\\lambda+2\\mu)\\alpha\\theta - \\lambda\\varepsilon_{11}}{2(\\lambda+\\mu)}\n$$\nNow, we write the expression for the axial stress, $\\sigma_{11}$:\n$$\n\\sigma_{11} = \\lambda(\\varepsilon_{11}+2\\varepsilon_{22}) + 2\\mu\\varepsilon_{11} - (3\\lambda+2\\mu)\\alpha\\theta\n$$\nSubstituting the expression for $\\varepsilon_{22}$:\n$$\n\\sigma_{11} = (\\lambda+2\\mu)\\varepsilon_{11} + 2\\lambda\\left(\\frac{(3\\lambda+2\\mu)\\alpha\\theta - \\lambda\\varepsilon_{11}}{2(\\lambda+\\mu)}\\right) - (3\\lambda+2\\mu)\\alpha\\theta\n$$\nGrouping terms by $\\varepsilon_{11}$ and $\\alpha\\theta$:\n$$\n\\sigma_{11} = \\left(\\lambda+2\\mu - \\frac{\\lambda^2}{\\lambda+\\mu}\\right)\\varepsilon_{11} + \\left(\\frac{\\lambda(3\\lambda+2\\mu)}{\\lambda+\\mu} - (3\\lambda+2\\mu)\\right)\\alpha\\theta\n$$\nThe coefficient of $\\varepsilon_{11}$ simplifies to Young's modulus, $E$:\n$$\n\\lambda+2\\mu - \\frac{\\lambda^2}{\\lambda+\\mu} = \\frac{(\\lambda+2\\mu)(\\lambda+\\mu)-\\lambda^2}{\\lambda+\\mu} = \\frac{\\lambda^2+3\\lambda\\mu+2\\mu^2-\\lambda^2}{\\lambda+\\mu} = \\frac{\\mu(3\\lambda+2\\mu)}{\\lambda+\\mu} = E\n$$\nThe coefficient of $\\alpha\\theta$ simplifies to $-E$:\n$$\n\\frac{\\lambda(3\\lambda+2\\mu) - (3\\lambda+2\\mu)(\\lambda+\\mu)}{\\lambda+\\mu} = \\frac{(3\\lambda+2\\mu)(\\lambda - \\lambda - \\mu)}{\\lambda+\\mu} = \\frac{-\\mu(3\\lambda+2\\mu)}{\\lambda+\\mu} = -E\n$$\nThus, we obtain the one-dimensional constitutive relation for the axial stress:\n$$\n\\sigma_{11} = E\\varepsilon_{11} - E\\alpha\\theta = E(\\varepsilon_{11} - \\alpha\\theta)\n$$\nNote that Poisson's ratio $\\nu = \\frac{\\lambda}{2(\\lambda+\\mu)}$ does not appear in this axial relation, which is a key result for this stress state. The problem is one of static equilibrium. With no body forces, the equilibrium equation in one dimension is:\n$$\n\\frac{d\\sigma_{11}}{dx} = 0\n$$\nThis implies that $\\sigma_{11}$ must be a constant along the length of the bar. Let this constant be $\\sigma_0$.\n$$\n\\sigma_0 = E\\left(\\frac{du}{dx} - \\alpha\\theta(x)\\right)\n$$\nwhere $\\varepsilon_{11} = du/dx$. Rearranging for the strain gradient:\n$$\n\\frac{du}{dx} = \\frac{\\sigma_0}{E} + \\alpha\\theta(x)\n$$\nTo find the constant stress $\\sigma_0$, we integrate this expression with respect to $x$ from $0$ to $L$:\n$$\n\\int_0^L \\frac{du}{dx}\\,dx = \\int_0^L \\left(\\frac{\\sigma_0}{E} + \\alpha\\theta(x)\\right)dx\n$$\nThe left side is $u(L)-u(0)$. Applying the boundary conditions $u(0)=0$ and $u(L)=0$:\n$$\n0 = \\int_0^L \\frac{\\sigma_0}{E}\\,dx + \\int_0^L \\alpha\\theta(x)\\,dx\n$$\nSince $\\sigma_0, E$, and $\\alpha$ are constants:\n$$\n0 = \\frac{\\sigma_0 L}{E} + \\alpha\\int_0^L \\theta(x)\\,dx\n$$\nSolving for $\\sigma_0$ (which is our desired stress $\\sigma_{11}$):\n$$\n\\sigma_{11} = -\\frac{E\\alpha}{L}\\int_0^L \\theta(x)\\,dx\n$$\nNow we compute the integral of the temperature deviation $\\theta(x)$:\n$$\n\\int_0^L \\theta(x)\\,dx = \\int_0^L (\\theta_{0}+b\\,x+c\\,x^{2})\\,dx = \\left[\\theta_{0}x + \\frac{1}{2}bx^2 + \\frac{1}{3}cx^3\\right]_0^L\n$$\n$$\n\\int_0^L \\theta(x)\\,dx = \\theta_{0}L + \\frac{1}{2}bL^2 + \\frac{1}{3}cL^3\n$$\nSubstituting this result into the expression for $\\sigma_{11}$:\n$$\n\\sigma_{11} = -\\frac{E\\alpha}{L}\\left(\\theta_{0}L + \\frac{1}{2}bL^2 + \\frac{1}{3}cL^3\\right)\n$$\nSimplifying by distributing the $1/L$ term:\n$$\n\\sigma_{11} = -E\\alpha\\left(\\theta_{0} + \\frac{1}{2}bL + \\frac{1}{3}cL^2\\right)\n$$\nThis is the final expression for the axial stress in the bar. It is constant along the bar's length, consistent with static equilibrium. The expression has units of stress, which are Pascals in the SI system.", "answer": "$$\n\\boxed{-E\\alpha\\left(\\theta_{0} + \\frac{1}{2}bL + \\frac{1}{3}cL^2\\right)}\n$$", "id": "3569898"}, {"introduction": "Before a new material model can be confidently used in large-scale simulations, it must be rigorously verified. This computational benchmark guides you through the essential process of verifying the properties of a hyperelastic model derived from a Helmholtz free energy potential, $\\psi(\\mathbf{F})$. You will use numerical finite differences to probe the first and second derivatives of the potential, testing for critical properties like symmetry and positive-definiteness of the algorithmic tangent, which are vital for the stability and convergence of nonlinear solvers. [@problem_id:3569882]", "problem": "You are tasked with constructing a computational benchmark that, from first principles, evaluates the symmetry and positive-definiteness of the algorithmic tangent for a hyperelastic solid whose Helmholtz free energy is specified as a function of the deformation gradient. The benchmark must also diagnose numerical pathologies by checking energy consistency along small perturbation paths. All computations are to be performed in a dimensionless setting; no physical units are required.\n\nThe fundamental base for the problem consists of the following definitions and well-tested facts:\n\n- The Helmholtz free energy per unit reference volume, denoted by $\\psi$, is a scalar function of the deformation gradient $\\mathbf{F} \\in \\mathbb{R}^{3 \\times 3}$ for a hyperelastic material.\n- The first Piola–Kirchhoff stress $\\mathbf{P}$ is defined as $\\mathbf{P} = \\partial \\psi / \\partial \\mathbf{F}$.\n- The algorithmic tangent (a fourth-order tensor) is the Hessian of the free energy with respect to the deformation gradient, defined component-wise as $\\mathbb{C}_{ij,kl} = \\partial^2 \\psi / \\partial F_{ij} \\partial F_{kl}$.\n- For a twice continuously differentiable potential, the Hessian is symmetric with respect to exchange of the derivative order, which implies $\\mathbb{C}_{ij,kl} = \\mathbb{C}_{kl,ij}$.\n- Positive-definiteness of the Hessian of $\\psi$ at a state indicates local convexity of the potential and is necessary for quadratic convergence of Newton-type solvers.\n\nUse the following Helmholtz free energy for a compressible Neo-Hookean material:\n$$\n\\psi(\\mathbf{F}) = \\frac{\\mu}{2}\\left( I_1 - 3 - 2 \\ln J \\right) + \\frac{\\kappa}{2} \\left(\\ln J\\right)^2,\n$$\nwhere $I_1 = \\mathrm{tr}(\\mathbf{F}^\\top \\mathbf{F})$ and $J = \\det(\\mathbf{F})$, with material parameters $\\mu  0$ and $\\kappa  0$. The domain of $\\psi$ is restricted to $J0$.\n\nYour program must:\n1. Numerically approximate the gradient $\\partial \\psi / \\partial \\mathbf{F}$ and the Hessian $\\partial^2 \\psi / \\partial \\mathbf{F}^2$ using the Finite Difference Method (FDM), without using closed-form derivatives. You must treat $\\mathbf{F}$ as a $9$-dimensional vector by stacking its entries.\n2. Construct the $9 \\times 9$ Hessian matrix $H$ corresponding to the mapping of the fourth-order tensor $\\mathbb{C}$ via the chosen stacking convention. The symmetry check should measure the maximum absolute entry of $H - H^\\top$ and declare symmetry to be acceptable if this maximum is less than or equal to a user-defined tolerance $\\varepsilon_{\\text{sym}}$.\n3. Test positive-definiteness by computing the eigenvalues of the symmetrized Hessian $(H + H^\\top)/2$ and declare positive-definiteness to be acceptable if the minimum eigenvalue is greater than or equal to a user-defined threshold $\\varepsilon_{\\text{pd}}$.\n4. Perform an energy consistency check along a small perturbation path $\\mathbf{F}(t) = \\mathbf{F} + t \\, \\Delta \\mathbf{F}$, where $\\Delta \\mathbf{F}$ is a direction of unit Frobenius norm. Using a second-order Taylor expansion about $\\mathbf{F}$,\n$$\n\\Delta \\psi_{\\text{pred}}(t) = \\left\\langle \\frac{\\partial \\psi}{\\partial \\mathbf{F}}, \\Delta \\mathbf{F} \\right\\rangle t + \\frac{1}{2} \\, \\mathrm{vec}(\\Delta \\mathbf{F})^\\top H \\, \\mathrm{vec}(\\Delta \\mathbf{F}) \\, t^2,\n$$\ncompare $\\Delta \\psi_{\\text{pred}}(t)$ against the actual increment $\\Delta \\psi_{\\text{act}}(t) = \\psi(\\mathbf{F} + t \\, \\Delta \\mathbf{F}) - \\psi(\\mathbf{F})$ for a set of small step sizes $t$. Declare the energy check to be acceptable if the relative error\n$$\n\\mathrm{rel\\_err}(t) = \\frac{\\left| \\Delta \\psi_{\\text{pred}}(t) - \\Delta \\psi_{\\text{act}}(t) \\right|}{\\left| \\Delta \\psi_{\\text{act}}(t) \\right| + \\delta}\n$$\nis less than or equal to a user-defined tolerance $\\varepsilon_{\\text{eng}}$ for all specified $t$, where $\\delta$ is a small regularization constant to avoid division by zero.\n\nIf any evaluation of $\\psi(\\mathbf{F})$ or finite-difference sampling encounters $\\det(\\mathbf{F}) \\le 0$, then the energy is undefined. In that case, for the corresponding test case, all three checks (symmetry, positive-definiteness, energy consistency) must be marked as not acceptable.\n\nUse the following parameters for the benchmark:\n- Material parameters: $\\mu = 1.0$ and $\\kappa = 1000.0$ (dimensionless).\n- Finite difference step for both gradient and Hessian: $h = 10^{-6}$.\n- Symmetry tolerance: $\\varepsilon_{\\text{sym}} = 10^{-6}$.\n- Positive-definiteness threshold: $\\varepsilon_{\\text{pd}} = 10^{-9}$.\n- Energy consistency tolerance: $\\varepsilon_{\\text{eng}} = 0.05$ and regularization constant $\\delta = 10^{-12}$.\n- Perturbation step sizes: $t \\in \\{10^{-4}, 10^{-3}, 10^{-2}\\}$.\n- Perturbation direction $\\Delta \\mathbf{F}$ should have unit Frobenius norm and be reproducible; use a fixed random seed of $42$ to construct it.\n\nTest suite (each test case is a $3 \\times 3$ matrix):\n- Case 1 (reference configuration): $\\mathbf{F} = \\mathrm{diag}(1,1,1)$.\n- Case 2 (moderate shear, near isochoric): $\\mathbf{F} = \\begin{bmatrix} 1.2  0.5  0 \\\\ 0.2  0.9  0 \\\\ 0  0  1 \\end{bmatrix}$.\n- Case 3 (volumetric compression): $\\mathbf{F} = \\mathrm{diag}(0.6,0.6,0.6)$.\n- Case 4 (inverted orientation; invalid): $\\mathbf{F} = \\mathrm{diag}(-0.9,1.0,1.0)$.\n\nYour program must implement the checks for each case and produce, in a single line, a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a three-element list of booleans in the order $[\\text{symmetry\\_ok}, \\text{positive\\_definite\\_ok}, \\text{energy\\_consistency\\_ok}]$. For example, the output format should be like\n$$\n[\\,[\\text{True},\\text{True},\\text{True}],\\,[\\text{True},\\text{True},\\text{False}],\\,\\ldots\\,].\n$$\nThere must be no additional text or whitespace beyond necessary commas and brackets.", "solution": "The problem has been validated and is determined to be self-contained, scientifically grounded, and well-posed. The task is to construct a numerical benchmark for a specified hyperelastic material model, evaluating the properties of its numerically-computed algorithmic tangent. This involves implementing the material model, using finite differences to compute its first and second derivatives with respect to the deformation gradient, and then performing a series of checks for symmetry, positive-definiteness, and energy consistency.\n\nThe solution will be presented by first detailing the underlying continuum mechanics principles and the numerical methods to be employed, followed by the implementation logic for the required checks.\n\n### 1. Hyperelastic Constitutive Model\n\nThe material response is governed by a Helmholtz free energy potential, $\\psi$, which is a scalar-valued function of the deformation gradient $\\mathbf{F} \\in \\mathbb{R}^{3 \\times 3}$. The specific form provided is for a compressible Neo-Hookean material:\n$$\n\\psi(\\mathbf{F}) = \\frac{\\mu}{2}\\left( I_1 - 3 - 2 \\ln J \\right) + \\frac{\\kappa}{2} \\left(\\ln J\\right)^2\n$$\nThe terms in this potential are defined as:\n- $I_1 = \\mathrm{tr}(\\mathbf{C}) = \\mathrm{tr}(\\mathbf{F}^\\top \\mathbf{F})$ is the first invariant of the right Cauchy-Green deformation tensor $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$.\n- $J = \\det(\\mathbf{F})$ is the determinant of the deformation gradient, representing the local volume change.\n- $\\mu  0$ and $\\kappa  0$ are material parameters, analogous to the shear modulus and bulk modulus, respectively. For this problem, their dimensionless values are given as $\\mu = 1.0$ and $\\kappa = 1000.0$.\n\nA fundamental physical constraint is that the volume must remain positive, which translates to the mathematical requirement $J  0$. Any deformation leading to $J \\le 0$ is considered physically inadmissible, and the energy potential is undefined. Our implementation will rigorously enforce this by detecting any such occurrence during function evaluation and flagging the entire test case as invalid.\n\n### 2. Numerical Differentiation using the Finite Difference Method (FDM)\n\nThe problem requires numerical approximation of the derivatives of $\\psi$, forbidding the use of analytical (closed-form) expressions. This is a common practice in code verification to test the robustness of a numerical implementation against a known potential.\n\nTo apply standard numerical differentiation techniques for scalar functions of multiple variables, we first vectorize the $3 \\times 3$ deformation gradient $\\mathbf{F}$ into a $9$-dimensional vector $\\mathbf{f}$. We will adopt a row-major stacking convention, consistent with the default behavior of libraries like NumPy.\n\nThe first derivative of the energy potential with respect to the deformation gradient yields the first Piola-Kirchhoff stress tensor $\\mathbf{P}$:\n$$\n\\mathbf{P} = \\frac{\\partial \\psi}{\\partial \\mathbf{F}}\n$$\nIn vectorized form, each component of the gradient vector $\\mathbf{p} = \\mathrm{vec}(\\mathbf{P})$ is computed using a second-order central difference formula for improved accuracy:\n$$\np_i = \\frac{\\partial \\psi}{\\partial f_i} \\approx \\frac{\\psi(\\mathbf{f} + h \\mathbf{e}_i) - \\psi(\\mathbf{f} - h \\mathbf{e}_i)}{2h}\n$$\nwhere $\\mathbf{f}$ is the vectorized form of $\\mathbf{F}$, $\\mathbf{e}_i$ is the $i$-th standard basis vector in $\\mathbb{R}^9$, and $h = 10^{-6}$ is the specified small step size.\n\nThe second derivative of the energy potential is the fourth-order algorithmic tangent tensor $\\mathbb{C}$:\n$$\n\\mathbb{C}_{ij,kl} = \\frac{\\partial^2 \\psi}{\\partial F_{ij} \\partial F_{kl}}\n$$\nIn our vectorized framework, this corresponds to the $9 \\times 9$ Hessian matrix $H$, where $H_{ij} = \\partial^2 \\psi / \\partial f_i \\partial f_j$. We compute its components using a central difference formula for mixed partial derivatives:\n$$\nH_{ij} \\approx \\frac{\\psi(\\mathbf{f}+h\\mathbf{e}_i+h\\mathbf{e}_j) - \\psi(\\mathbf{f}+h\\mathbf{e}_i-h\\mathbf{e}_j) - \\psi(\\mathbf{f}-h\\mathbf{e}_i+h\\mathbf{e}_j) + \\psi(\\mathbf{f}-h\\mathbf{e}_i-h\\mathbf{e}_j)}{4h^2}\n$$\nThis formula is applied for all pairs $(i, j)$ to construct the full Hessian matrix $H$.\n\n### 3. Benchmark Criteria and Verification\n\nThe computed numerical derivatives are subjected to three distinct checks.\n\n**a) Symmetry Check:**\nFor a twice continuously differentiable potential, the order of differentiation does not matter (Clairaut's theorem), which implies the symmetry $\\mathbb{C}_{ij,kl} = \\mathbb{C}_{kl,ij}$. In matrix form, this means the Hessian $H$ must be symmetric, i.e., $H = H^\\top$. Numerical FDM computations introduce floating-point errors, so we verify this property within a specified tolerance $\\varepsilon_{\\text{sym}} = 10^{-6}$:\n$$\n\\text{Symmetry acceptable if } \\max_{i,j} |H_{ij} - H_{ji}| \\le \\varepsilon_{\\text{sym}}\n$$\n\n**b) Positive-Definiteness Check:**\nThe positive-definiteness of the Hessian is a condition for the local convexity of the energy potential. This is crucial for the stability of the material response and for ensuring the quadratic convergence of Newton-Raphson algorithms used in finite element simulations. The check is performed on the symmetrized Hessian, $H_{\\text{sym}} = \\frac{1}{2}(H + H^\\top)$, to ensure the computation of real eigenvalues. The condition is that the minimum eigenvalue must be greater than or equal to a small threshold $\\varepsilon_{\\text{pd}} = 10^{-9}$:\n$$\n\\text{Positive-definiteness acceptable if } \\min \\lambda_i(H_{\\text{sym}}) \\ge \\varepsilon_{\\text{pd}}\n$$\n\n**c) Energy Consistency Check:**\nThis check serves as an integrated test of the correctness of the computed gradient and Hessian. It compares the actual energy change along a small perturbation path with the change predicted by a second-order Taylor series expansion.\nThe perturbation path is $\\mathbf{F}(t) = \\mathbf{F} + t \\Delta \\mathbf{F}$, where $\\Delta \\mathbf{F}$ is a fixed perturbation direction with unit Frobenius norm.\nThe actual energy increment is:\n$$\n\\Delta \\psi_{\\text{act}}(t) = \\psi(\\mathbf{F}(t)) - \\psi(\\mathbf{F})\n$$\nThe predicted energy increment from the Taylor expansion is:\n$$\n\\Delta \\psi_{\\text{pred}}(t) = \\left\\langle \\frac{\\partial \\psi}{\\partial \\mathbf{F}}, \\Delta \\mathbf{F} \\right\\rangle t + \\frac{1}{2} \\, \\mathrm{vec}(\\Delta \\mathbf{F})^\\top H \\, \\mathrm{vec}(\\Delta \\mathbf{F}) \\, t^2\n$$\nConsistency is acceptable if the relative error is below a tolerance $\\varepsilon_{\\text{eng}} = 0.05$ for all specified step sizes $t \\in \\{10^{-4}, 10^{-3}, 10^{-2}\\}$:\n$$\n\\frac{\\left| \\Delta \\psi_{\\text{pred}}(t) - \\Delta \\psi_{\\text{act}}(t) \\right|}{\\left| \\Delta \\psi_{\\text{act}}(t) \\right| + \\delta} \\le \\varepsilon_{\\text{eng}}\n$$\nwhere $\\delta = 10^{-12}$ is a small regularization constant to prevent division by zero.\n\n### 4. Computational Workflow\n\nFor each test case $\\mathbf{F}$, the following procedure is executed:\n1. A top-level `try-except` block is established to catch any `DomainError` that arises from an evaluation where $J \\le 0$. This can occur during the initial evaluation, or during the finite difference or energy consistency check perturbations. If such an error is caught at any stage, all three checks for that test case are immediately marked as `False`.\n2. If the initial deformation state is valid, the gradient vector $\\mathbf{p}$ and Hessian matrix $H$ are computed using the FDM routines.\n3. The symmetry, positive-definiteness, and energy consistency checks are performed on the computed quantities using the specified numerical parameters and tolerances.\n4. The results for each test case are stored as a triplet of booleans: $[\\text{symmetry\\_ok}, \\text{positive\\_definite\\_ok}, \\text{energy\\_consistency\\_ok}]$.\n5. Finally, the collected results for all test cases are formatted into a single-line string as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and runs a computational benchmark for a hyperelastic model.\n    \"\"\"\n    # Define problem parameters\n    MU = 1.0\n    KAPPA = 1000.0\n    H_FD = 1e-6\n    EPS_SYM = 1e-6\n    EPS_PD = 1e-9\n    EPS_ENG = 0.05\n    DELTA_ENG = 1e-12\n    T_STEPS = [1e-4, 1e-3, 1e-2]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        np.diag([1.0, 1.0, 1.0]),  # Case 1: Reference configuration\n        np.array([[1.2, 0.5, 0.0], [0.2, 0.9, 0.0], [0.0, 0.0, 1.0]]),  # Case 2: Shear\n        np.diag([0.6, 0.6, 0.6]),  # Case 3: Compression\n        np.diag([-0.9, 1.0, 1.0]), # Case 4: Invalid (inverted)\n    ]\n\n    # Reproducible perturbation direction\n    np.random.seed(42)\n    dF = np.random.rand(3, 3)\n    dF /= np.linalg.norm(dF) # Normalize to unit Frobenius norm\n\n    class DomainError(Exception):\n        \"\"\"Custom exception for invalid deformations (det(F) = 0).\"\"\"\n        pass\n\n    def psi(F, mu, kappa):\n        \"\"\"Computes the Helmholtz free energy for a compressible Neo-Hookean material.\"\"\"\n        J = np.linalg.det(F)\n        if J = 0:\n            raise DomainError(\"Determinant of F is not positive.\")\n        \n        # Invariants\n        I1 = np.trace(F.T @ F)\n        lnJ = np.log(J)\n        \n        # Energy calculation\n        energy = (mu / 2.0) * (I1 - 3.0 - 2.0 * lnJ) + (kappa / 2.0) * (lnJ**2)\n        return energy\n\n    def compute_gradient_fdm(psi_func, f_vec, h):\n        \"\"\"Computes gradient via central differences.\"\"\"\n        grad = np.zeros_like(f_vec)\n        dim = f_vec.shape[0]\n        \n        for i in range(dim):\n            e_i = np.zeros(dim)\n            e_i[i] = 1.0\n            \n            f_plus = f_vec + h * e_i\n            f_minus = f_vec - h * e_i\n            \n            psi_plus = psi_func(f_plus)\n            psi_minus = psi_func(f_minus)\n            \n            grad[i] = (psi_plus - psi_minus) / (2.0 * h)\n        \n        return grad\n\n    def compute_hessian_fdm(psi_func, f_vec, h):\n        \"\"\"Computes Hessian via central differences.\"\"\"\n        dim = f_vec.shape[0]\n        hess = np.zeros((dim, dim))\n        \n        for i in range(dim):\n            for j in range(dim):\n                p_i = np.zeros(dim); p_i[i] = h\n                p_j = np.zeros(dim); p_j[j] = h\n                \n                psi_pp = psi_func(f_vec + p_i + p_j)\n                psi_pm = psi_func(f_vec + p_i - p_j)\n                psi_mp = psi_func(f_vec - p_i + p_j)\n                psi_mm = psi_func(f_vec - p_i - p_j)\n                \n                hess[i, j] = (psi_pp - psi_pm - psi_mp + psi_mm) / (4.0 * h**2)\n        \n        return hess\n\n    results = []\n    for F_mat in test_cases:\n        symm_ok, pd_ok, eng_ok = False, False, False\n        \n        try:\n            # Define a lambda that takes a vector and computes energy\n            psi_vec = lambda fv: psi(fv.reshape(3, 3), MU, KAPPA)\n\n            # Check base state first\n            psi_base = psi(F_mat, MU, KAPPA)\n            \n            # Vectorize F\n            f_vec = F_mat.flatten()\n\n            # 1. Compute Gradient and Hessian\n            grad_vec = compute_gradient_fdm(psi_vec, f_vec, H_FD)\n            hess_mat = compute_hessian_fdm(psi_vec, f_vec, H_FD)\n            \n            # 2. Perform Checks\n            # Symmetry Check\n            symm_err = np.max(np.abs(hess_mat - hess_mat.T))\n            symm_ok = symm_err = EPS_SYM\n            \n            # Positive-Definiteness Check\n            hess_symm = (hess_mat + hess_mat.T) / 2.0\n            eigenvalues = np.linalg.eigvalsh(hess_symm)\n            min_eig = np.min(eigenvalues)\n            pd_ok = min_eig = EPS_PD\n            \n            # Energy Consistency Check\n            is_consistent = True\n            grad_mat = grad_vec.reshape(3, 3)\n            dF_vec = dF.flatten()\n            \n            for t in T_STEPS:\n                F_pert = F_mat + t * dF\n                psi_pert = psi(F_pert, MU, KAPPA)\n                \n                delta_psi_act = psi_pert - psi_base\n                \n                grad_term = np.sum(grad_mat * dF)\n                hess_term = 0.5 * dF_vec @ hess_mat @ dF_vec\n                delta_psi_pred = grad_term * t + hess_term * t**2\n                \n                rel_err = abs(delta_psi_pred - delta_psi_act) / (abs(delta_psi_act) + DELTA_ENG)\n                \n                if rel_err  EPS_ENG:\n                    is_consistent = False\n                    break\n            \n            eng_ok = is_consistent\n\n        except DomainError:\n            # If det(F) = 0 at any point, all checks are False.\n            # The default False values are used.\n            pass\n\n        results.append([symm_ok, pd_ok, eng_ok])\n\n    # Final print statement in the exact required format.\n    # e.g., [[True,True,True],[False,False,False]]\n    output_strings = []\n    for r in results:\n        # Format each sublist like \"[True,False,True]\" without spaces\n        sublist_str = f\"[{','.join(str(b) for b in r)}]\"\n        output_strings.append(sublist_str)\n\n    # Join the sublist strings and wrap in outer brackets\n    final_str = f\"[{','.join(output_strings)}]\"\n    print(final_str)\n\nsolve()\n```", "id": "3569882"}, {"introduction": "The power of the Helmholtz free energy framework extends beyond simple elasticity to model complex, dissipative phenomena like material damage. This advanced practice demonstrates how to construct an inelastic constitutive model by augmenting the free energy $\\psi(\\varepsilon, d)$ with an internal state variable for damage, $d$. You will apply the principles of the generalized standard materials (GSM) framework to derive and implement an evolution law for damage that respects thermodynamic laws, including the crucial constraint of irreversibility, and observe its effect on material stiffness under cyclic loading. [@problem_id:3569933]", "problem": "Consider a one-dimensional small-strain, isotropic damage model for a homogeneous bar, formulated within the framework of Helmholtz free energy potentials and generalized standard materials. The bar is subjected to cyclic strain, and the model must enforce the irreversibility of damage through the Karush–Kuhn–Tucker (KKT) conditions. Your task is to derive, implement, and simulate the constitutive response and report quantifiable results that verify stiffness degradation and damage irreversibility.\n\nStart from the following fundamental base:\n1. The Helmholtz free energy density $\\psi$ expresses the recoverable energy stored in the material. For small strains, consider $\\psi$ as a function of the damage variable $d \\in [0,1]$ and the scalar strain $\\varepsilon$. The damage variable $d$ is dimensionless, where $d = 0$ denotes the undamaged state and $d \\to 1$ denotes complete loss of stiffness.\n2. The first and second laws of thermodynamics, combined in the Clausius–Duhem inequality for isothermal processes, state that the mechanical dissipation $\\mathcal{D}$ must satisfy $\\mathcal{D} \\ge 0$.\n3. The generalized standard materials framework postulates that the thermodynamic forces are derived from the Helmholtz free energy and the dissipation potential, and the evolution obeys variational principles consistent with the dissipation inequality.\n\nAssume the following constitutive choices (to be justified from the fundamental base):\n- The degradation function is $g(d) = (1 - d)^2$.\n- The Helmholtz free energy density is $\\psi(\\varepsilon, d) = \\tfrac{1}{2}\\,g(d)\\,E\\,\\varepsilon^{2} + \\tfrac{1}{2}\\,h\\,d^{2}$, where $E$ is the Young’s modulus and $h$ is a damage hardening modulus that penalizes damage growth.\n- The dissipation potential is $\\mathcal{R}(\\dot d) = Y_{0}\\,\\dot d + \\tfrac{1}{2}\\,\\eta\\,\\dot d^{2} + I_{[0,\\infty)}(\\dot d)$, where $Y_{0}$ is a damage activation threshold (in energy release units), $\\eta$ is a viscosity-like coefficient, and $I_{[0,\\infty)}$ is the indicator function that enforces unilateral evolution $\\dot d \\ge 0$.\n\nTasks to be carried out in your program:\n1. Derive the stress–strain relation and the damage driving force, starting from the Clausius–Duhem inequality and the above Helmholtz free energy density. Use the generalized standard materials framework to derive the flow rule from the dissipation potential. Enforce the irreversibility via the Karush–Kuhn–Tucker (KKT) conditions.\n2. Implement a time-stepping algorithm for the evolution of $d(t)$ under a prescribed cyclic strain history $\\varepsilon(t) = A \\sin(2\\pi f t)$, where $A$ is the strain amplitude and $f$ is the frequency. The sine function argument must be in radians. Use a forward Euler integration for $\\dot d$ consistent with the derived flow rule and KKT irreversibility.\n3. Simulate the evolution over a total duration $T = N_{\\mathrm{cycle}}/f$ with a constant time step $\\Delta t$ and initial conditions $d(0) = 0$, $\\varepsilon(0) = 0$.\n\nUse the following material parameters and loading conditions, all scientifically sound and expressed in standard units:\n- Young’s modulus $E = 210 \\times 10^{9}\\,\\mathrm{Pa}$.\n- Damage hardening modulus $h = 10^{7}\\,\\mathrm{Pa}$.\n- Damage activation threshold $Y_{0} = 10^{6}\\,\\mathrm{Pa}$.\n- Viscosity-like coefficient $\\eta = 10^{9}\\,\\mathrm{Pa\\cdot s}$.\n- Frequency $f = 1\\,\\mathrm{Hz}$.\n- Number of cycles $N_{\\mathrm{cycle}} = 10$ (dimensionless).\n- Time step $\\Delta t = 0.01\\,\\mathrm{s}$.\n- Strain is dimensionless; stress and energy quantities must be in $\\mathrm{Pa}$; time must be in $\\mathrm{s}$; the sine argument must be in radians.\n\nTest suite:\nEvaluate four test cases distinguished by the strain amplitude $A$:\n- Case 1 (boundary): $A = 0.0$.\n- Case 2 (sub-threshold): $A = 0.001$.\n- Case 3 (moderate): $A = 0.01$.\n- Case 4 (high): $A = 0.05$.\n\nFor each case, compute:\n- The final damage value $d(T)$ as a real number (dimensionless), rounded to six decimals.\n- A boolean that is true if and only if $d(t)$ is nondecreasing over the entire simulation interval $[0,T]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is represented as a two-element list $[d(T), \\text{is\\_nondecreasing}]$. For example, the output format must be of the form $[[d_{1},b_{1}],[d_{2},b_{2}],[d_{3},b_{3}],[d_{4},b_{4}]]$ with $d_{i}$ as floats rounded to six decimals and $b_{i}$ as booleans.\n\nEnsure that the model derivation is consistent with the stated fundamentals, the algorithm enforces irreversibility by the Karush–Kuhn–Tucker conditions, and the numerical outputs are scientifically plausible for the chosen parameters. No user input is permitted; all parameter values are fixed as specified above, and the program must run to completion and print the single-line result described.", "solution": "The problem is assessed to be valid as it is scientifically grounded in continuum damage mechanics, well-posed, and provides a complete and consistent set of data and objectives. The derivation and implementation steps are outlined below.\n\nThe constitutive relations for the one-dimensional damage model are derived from the specified Helmholtz free energy potential within the framework of generalized standard materials (GSM). The process begins with the Clausius–Duhem inequality for isothermal processes, which states that the mechanical dissipation $\\mathcal{D}$ must be non-negative:\n$$\n\\mathcal{D} = \\sigma\\dot{\\varepsilon} - \\dot{\\psi} \\ge 0\n$$\nwhere $\\sigma$ is the stress, $\\varepsilon$ is the strain, and $\\psi$ is the Helmholtz free energy density per unit volume. The state variables are the strain $\\varepsilon$ and the internal damage variable $d$. The free energy density is given as $\\psi(\\varepsilon, d)$. The rate of change of free energy is found using the chain rule:\n$$\n\\dot{\\psi} = \\frac{\\partial\\psi}{\\partial\\varepsilon}\\dot{\\varepsilon} + \\frac{\\partial\\psi}{\\partial d}\\dot{d}\n$$\nSubstituting this into the dissipation inequality yields:\n$$\n\\mathcal{D} = \\left(\\sigma - \\frac{\\partial\\psi}{\\partial\\varepsilon}\\right)\\dot{\\varepsilon} - \\frac{\\partial\\psi}{\\partial d}\\dot{d} \\ge 0\n$$\nFollowing the Coleman-Noll procedure, for this inequality to hold for arbitrary state evolution processes (i.e., for any $\\dot{\\varepsilon}$), the term multiplying $\\dot{\\varepsilon}$ must vanish. This defines the stress $\\sigma$ as the thermodynamic conjugate to the strain $\\varepsilon$:\n$$\n\\sigma = \\frac{\\partial\\psi}{\\partial\\varepsilon}\n$$\nWith the given form of the Helmholtz free energy density, $\\psi(\\varepsilon, d) = \\tfrac{1}{2}\\,(1 - d)^{2}\\,E\\,\\varepsilon^{2} + \\tfrac{1}{2}\\,h\\,d^{2}$, where $E$ is the Young's modulus and $h$ is the damage hardening modulus, the stress is derived as:\n$$\n\\sigma = \\frac{\\partial}{\\partial\\varepsilon}\\left(\\frac{1}{2}(1 - d)^2 E \\varepsilon^2 + \\frac{1}{2}h d^2\\right) = (1 - d)^2 E \\varepsilon\n$$\nThis equation shows that the effective stiffness of the material, $E_{\\text{eff}} = (1-d)^2 E$, degrades as damage $d$ increases.\n\nWith the stress relation established, the dissipation inequality reduces to:\n$$\n\\mathcal{D} = - \\frac{\\partial\\psi}{\\partial d}\\dot{d} \\ge 0\n$$\nWe define the thermodynamic force conjugate to the damage rate $\\dot{d}$, known as the damage driving force $Y$, as:\n$$\nY = -\\frac{\\partial\\psi}{\\partial d}\n$$\nThe dissipation is then expressed as $\\mathcal{D} = Y\\dot{d}$. Calculating $Y$ from the given $\\psi$:\n$$\nY = -\\frac{\\partial}{\\partial d}\\left(\\frac{1}{2}(1 - d)^2 E \\varepsilon^2 + \\frac{1}{2}h d^2\\right) = -\\left(\\frac{1}{2}E \\varepsilon^2 \\cdot 2(1-d)(-1) + h d\\right) = E \\varepsilon^2 (1-d) - h d\n$$\nThe GSM framework postulates that the evolution law for the internal variable $d$ is given by a normality rule with respect to a dissipation potential, $\\mathcal{R}(\\dot d)$. The damage driving force $Y$ must belong to the subdifferential of $\\mathcal{R}$ with respect to $\\dot d$:\n$$\nY \\in \\partial_{\\dot d} \\mathcal{R}(\\dot d)\n$$\nThe problem specifies the dissipation potential as $\\mathcal{R}(\\dot d) = Y_{0}\\,\\dot d + \\tfrac{1}{2}\\,\\eta\\,\\dot d^{2} + I_{[0,\\infty)}(\\dot d)$, where $Y_0$ is the damage activation threshold, $\\eta$ is a viscosity coefficient, and $I_{[0,\\infty)}$ is the indicator function for the set $[0,\\infty)$, which enforces the irreversibility of damage, $\\dot d \\ge 0$. The subdifferential is:\n$$\n\\partial_{\\dot d} \\mathcal{R}(\\dot d) = Y_0 + \\eta \\dot d + \\partial_{\\dot d} I_{[0,\\infty)}(\\dot d)\n$$\nwhere $\\partial_{\\dot d} I_{[0,\\infty)}(\\dot d)$ is the normal cone to $[0, \\infty)$ at $\\dot d$. This leads to a set of conditions equivalent to the Karush-Kuhn-Tucker (KKT) conditions for this constrained evolution. We analyze two cases:\n$1$. If damage is actively evolving ($\\dot d > 0$), the subdifferential of the indicator function is $\\{0\\}$. The normality rule becomes a direct equality: $Y = Y_0 + \\eta \\dot d$. This implies that for damage to grow, the driving force $Y$ must exceed the threshold $Y_0$.\n$2$. If there is no damage evolution ($\\dot d = 0$), the subdifferential is $(-\\infty, 0]$. The rule becomes $Y \\in Y_0 + (-\\infty, 0]$, which simplifies to $Y \\le Y_0$.\n\nThese two conditions can be unified into a single evolution law using the Macauley bracket $\\langle x \\rangle = \\max(x, 0)$:\n$$\n\\dot d = \\frac{\\langle Y - Y_0 \\rangle}{\\eta}\n$$\nThis is the flow rule for damage. It naturally enforces the KKT conditions: damage is irreversible ($\\dot d \\ge 0$); and damage grows only when the driving force $Y$ exceeds the threshold $Y_0$, with the rate of growth being proportional to this over-threshold force and inversely proportional to the viscosity $\\eta$.\n\nFor the numerical simulation, a forward Euler time integration scheme is used to update the damage variable $d$ at discrete time steps $t_k = k \\Delta t$. Given the damage $d_k$ at time $t_k$, the value at the next step $d_{k+1}$ is computed as:\n$$\nd_{k+1} = d_k + \\dot d_k \\Delta t\n$$\nwhere the damage rate $\\dot d_k$ is calculated using the state at time $t_k$:\n$1$. Prescribed strain at $t_k$: $\\varepsilon_k = A \\sin(2\\pi f t_k)$.\n$2$. Damage driving force at $t_k$: $Y_k = E \\varepsilon_k^2 (1 - d_k) - h d_k$.\n$3$. Damage rate at $t_k$: $\\dot d_k = \\frac{\\max(0, Y_k - Y_0)}{\\eta}$.\n\nThe simulation starts with $d_0 = 0$ at $t_0 = 0$ and proceeds for a total time $T = N_{\\text{cycle}}/f$ with a constant time step $\\Delta t$. The final damage $d(T)$ and the verification of the non-decreasing nature of $d(t)$ throughout the simulation are reported for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D damage mechanics problem for four test cases.\n    \"\"\"\n\n    # Material parameters and loading conditions\n    E = 210e9  # Young's modulus in Pa\n    h = 1e7    # Damage hardening modulus in Pa\n    Y0 = 1e6   # Damage activation threshold in Pa\n    eta = 1e9  # Viscosity-like coefficient in Pa*s\n    f = 1.0    # Frequency in Hz\n    N_cycle = 10 # Number of cycles\n    delta_t = 0.01 # Time step in s\n\n    # Test cases for strain amplitude A\n    test_cases = [\n        0.0,     # Case 1 (boundary)\n        0.001,   # Case 2 (sub-threshold)\n        0.01,    # Case 3 (moderate)\n        0.05,    # Case 4 (high)\n    ]\n\n    results = []\n    for A in test_cases:\n        # Simulation setup\n        T_total = N_cycle / f\n        # total number of steps, number of time points is n_steps + 1\n        n_steps = int(round(T_total / delta_t)) \n        \n        # Initial conditions\n        d = 0.0\n        d_history = [d]\n\n        # Time-stepping loop\n        for k in range(n_steps):\n            t = k * delta_t\n            \n            # 1. Calculate strain at current time tk\n            epsilon = A * np.sin(2 * np.pi * f * t)\n            \n            # 2. Calculate damage driving force Yk\n            # Y = E * epsilon^2 * (1-d) - h * d\n            Y = E * epsilon**2 * (1 - d) - h * d\n            \n            # 3. Calculate damage rate d_dot_k\n            # d_dot = Y - Y0 / eta\n            d_dot = np.maximum(0, Y - Y0) / eta\n            \n            # 4. Update damage d_k+1 using Forward Euler\n            d = d + d_dot * delta_t\n            \n            d_history.append(d)\n\n        # Final damage value, rounded to six decimals\n        final_d = round(d, 6)\n\n        # Check if damage is non-decreasing\n        is_nondecreasing = True\n        for i in range(len(d_history) - 1):\n            if d_history[i+1]  d_history[i]:\n                # This should not happen with the given update rule,\n                # as d_dot = 0 and delta_t  0.\n                is_nondecreasing = False\n                break\n        \n        results.append([final_d, is_nondecreasing])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists works perfectly.\n    print(f\"[[{results[0][0]}, {str(results[0][1]).lower()}],[{results[1][0]}, {str(results[1][1]).lower()}],[{results[2][0]}, {str(results[2][1]).lower()}],[{results[3][0]}, {str(results[3][1]).lower()}]]\")\n\nsolve()\n```", "id": "3569933"}]}