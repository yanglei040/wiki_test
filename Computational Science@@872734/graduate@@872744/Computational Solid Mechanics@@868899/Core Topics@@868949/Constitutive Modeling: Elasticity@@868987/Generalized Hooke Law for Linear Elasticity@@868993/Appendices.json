{"hands_on_practices": [{"introduction": "Mastering the generalized Hooke's law begins with the foundational case of isotropic materials. This practice guides you through the derivation of the $6 \\times 6$ stiffness matrix from a quadratic strain energy function, a cornerstone of hyperelasticity. By relating the Lamé parameters to the engineering constants $E$ and $\\nu$ and verifying the matrix's positive-definiteness, you will build a rigorous understanding of the physical and mathematical constraints governing linear elastic behavior.", "problem": "Consider a three-dimensional, small-strain, linearly elastic, isotropic solid characterized by a Young’s modulus $E>0$ and a Poisson’s ratio $\\nu$ with $-1<\\nu<\\tfrac{1}{2}$. Adopt the Voigt representation that maps the symmetric stress tensor $\\boldsymbol{\\sigma}$ and strain tensor $\\boldsymbol{\\varepsilon}$ to 6-vectors using the engineering shear convention:\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{V}}=\\begin{pmatrix}\\sigma_{xx} & \\sigma_{yy} & \\sigma_{zz} & \\sigma_{yz} & \\sigma_{xz} & \\sigma_{xy}\\end{pmatrix}^{\\mathsf{T}},\\quad\n\\boldsymbol{\\varepsilon}^{\\mathrm{V}}=\\begin{pmatrix}\\varepsilon_{xx} & \\varepsilon_{yy} & \\varepsilon_{zz} & 2\\varepsilon_{yz} & 2\\varepsilon_{xz} & 2\\varepsilon_{xy}\\end{pmatrix}^{\\mathsf{T}}.\n$$\nStarting from a frame-indifferent, quadratic strain energy density function consistent with isotropy at small strain, together with the definitions of Young’s modulus $E$ and Poisson’s ratio $\\nu$ under a uniaxial stress state, derive the generalized Hooke’s law in the form $\\boldsymbol{\\sigma}^{\\mathrm{V}}=\\boldsymbol{C}(E,\\nu)\\,\\boldsymbol{\\varepsilon}^{\\mathrm{V}}$ and compute the explicit $6\\times 6$ stiffness matrix $\\boldsymbol{C}(E,\\nu)$ in Voigt notation. Then, without invoking any pre-packaged stability criteria, verify the positive-definiteness of $\\boldsymbol{C}(E,\\nu)$ for $-1<\\nu<\\tfrac{1}{2}$ by analyzing the associated quadratic form.\n\nProvide your final result as the closed-form analytic expression for the $6\\times 6$ Voigt stiffness matrix $\\boldsymbol{C}(E,\\nu)$, expressed in terms of $E$ and $\\nu$. No numerical evaluation is required.", "solution": "### Derivation of the Stiffness Matrix\n\nThe derivation proceeds in four stages: (1) establishing the isotropic strain energy density function, (2) deriving the stress-strain relationship, (3) relating the material parameters to $E$ and $\\nu$, and (4) assembling the stiffness matrix in Voigt form.\n\n**1. Isotropic Strain Energy Density Function**\n\nFor a linearly elastic material under small strains, the strain energy density $W$ is a quadratic function of the strain tensor components $\\varepsilon_{ij}$. For an isotropic material, $W$ must be invariant under any rotation of the coordinate system, which means it can only be a function of the invariants of the strain tensor $\\boldsymbol{\\varepsilon}$. The most general quadratic form for $W$ using strain invariants is typically expressed in terms of the first principal invariant $I_1 = \\mathrm{tr}(\\boldsymbol{\\varepsilon})$ and the second-order term $\\mathrm{tr}(\\boldsymbol{\\varepsilon}^2)$:\n$$\nW(\\boldsymbol{\\varepsilon}) = \\frac{1}{2} \\lambda (I_1)^2 + \\mu \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}^2)\n$$\nwhere $\\lambda$ and $\\mu$ are the Lamé parameters. The factor of $\\frac{1}{2}$ is conventional. The invariants are expressed in terms of strain components as:\n$$\nI_1 = \\mathrm{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}\n$$\n$$\n\\mathrm{tr}(\\boldsymbol{\\varepsilon}^2) = \\varepsilon_{ij}\\varepsilon_{ji} = \\varepsilon_{xx}^2 + \\varepsilon_{yy}^2 + \\varepsilon_{zz}^2 + 2\\varepsilon_{xy}^2 + 2\\varepsilon_{xz}^2 + 2\\varepsilon_{yz}^2\n$$\n\n**2. Stress-Strain Relationship**\n\nThe components of the symmetric Cauchy stress tensor $\\boldsymbol{\\sigma}$ are obtained by differentiating the strain energy density with respect to the corresponding components of the strain tensor:\n$$\n\\sigma_{ij} = \\frac{\\partial W}{\\partial \\varepsilon_{ij}}\n$$\nUsing the chain rule and the relations $\\frac{\\partial I_1}{\\partial \\varepsilon_{ij}} = \\delta_{ij}$ and $\\frac{\\partial \\mathrm{tr}(\\boldsymbol{\\varepsilon}^2)}{\\partial \\varepsilon_{ij}} = 2\\varepsilon_{ij}$ (for a symmetric $\\boldsymbol{\\varepsilon}$), we obtain:\n$$\n\\sigma_{ij} = \\frac{\\partial}{\\partial \\varepsilon_{ij}} \\left( \\frac{1}{2} \\lambda (\\varepsilon_{kk})^2 + \\mu \\varepsilon_{lm}\\varepsilon_{ml} \\right) = \\lambda (\\varepsilon_{kk}) \\delta_{ij} + 2\\mu \\varepsilon_{ij}\n$$\nThis is the generalized Hooke's law for an isotropic material in tensor form.\n\n**3. Relating Lamé Parameters to $E$ and $\\nu$**\n\nWe consider a uniaxial stress state along the $x$-axis, where $\\sigma_{xx}$ is the only non-zero stress component. The stress tensor is:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx} & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nFrom the definition of Young's modulus $E$ and Poisson's ratio $\\nu$, the strain components are $\\varepsilon_{xx} = \\sigma_{xx}/E$, $\\varepsilon_{yy} = -\\nu\\varepsilon_{xx}$, and $\\varepsilon_{zz} = -\\nu\\varepsilon_{xx}$. The shear strains are zero. Substituting these into the tensor-form Hooke's law:\nFor $\\sigma_{yy}=0$:\n$$\n0 = \\sigma_{yy} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu\\varepsilon_{yy} = \\lambda(\\varepsilon_{xx} - \\nu\\varepsilon_{xx} - \\nu\\varepsilon_{xx}) + 2\\mu(-\\nu\\varepsilon_{xx})\n$$\nAssuming $\\varepsilon_{xx} \\neq 0$, we can divide by it:\n$$\n0 = \\lambda(1 - 2\\nu) - 2\\mu\\nu \\implies \\lambda = \\frac{2\\mu\\nu}{1-2\\nu}\n$$\nFor $\\sigma_{xx}$:\n$$\n\\sigma_{xx} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu\\varepsilon_{xx} = \\lambda\\varepsilon_{xx}(1 - 2\\nu) + 2\\mu\\varepsilon_{xx}\n$$\nThe Young's modulus is $E = \\sigma_{xx} / \\varepsilon_{xx}$:\n$$\nE = \\lambda(1 - 2\\nu) + 2\\mu\n$$\nSubstituting the expression for $\\lambda$:\n$$\nE = \\left(\\frac{2\\mu\\nu}{1-2\\nu}\\right)(1 - 2\\nu) + 2\\mu = 2\\mu\\nu + 2\\mu = 2\\mu(1+\\nu)\n$$\nThis gives the relationships for the Lamé parameters in terms of $E$ and $\\nu$:\n$$\n\\mu = \\frac{E}{2(1+\\nu)}\n$$\n$$\n\\lambda = \\frac{2\\nu}{1-2\\nu} \\mu = \\frac{2\\nu}{1-2\\nu} \\frac{E}{2(1+\\nu)} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n$$\nWe also derive an important combination:\n$$\n\\lambda + 2\\mu = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E\\nu + E(1-2\\nu)}{(1+\\nu)(1-2\\nu)} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\n\n**4. Assembling the $6\\times6$ Stiffness Matrix**\n\nWe write out the stress components in terms of the engineering strains $\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{yz}=2\\varepsilon_{yz}, \\gamma_{xz}=2\\varepsilon_{xz}, \\gamma_{xy}=2\\varepsilon_{xy}$:\n$$\n\\sigma_{xx} = (\\lambda + 2\\mu)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + \\lambda\\varepsilon_{zz}\n$$\n$$\n\\sigma_{yy} = \\lambda\\varepsilon_{xx} + (\\lambda + 2\\mu)\\varepsilon_{yy} + \\lambda\\varepsilon_{zz}\n$$\n$$\n\\sigma_{zz} = \\lambda\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + (\\lambda + 2\\mu)\\varepsilon_{zz}\n$$\n$$\n\\sigma_{yz} = 2\\mu\\varepsilon_{yz} = \\mu(2\\varepsilon_{yz}) = \\mu\\gamma_{yz}\n$$\n$$\n\\sigma_{xz} = 2\\mu\\varepsilon_{xz} = \\mu(2\\varepsilon_{xz}) = \\mu\\gamma_{xz}\n$$\n$$\n\\sigma_{xy} = 2\\mu\\varepsilon_{xy} = \\mu(2\\varepsilon_{xy}) = \\mu\\gamma_{xy}\n$$\nThese equations can be written in matrix form $\\boldsymbol{\\sigma}^{\\mathrm{V}} = \\boldsymbol{C} \\boldsymbol{\\varepsilon}^{\\mathrm{V}}$:\n$$\n\\boldsymbol{C} = \\begin{pmatrix}\n\\lambda+2\\mu & \\lambda & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda+2\\mu & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda & \\lambda+2\\mu & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\mu & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\mu & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\mu\n\\end{pmatrix}\n$$\nSubstituting the expressions for $\\lambda$ and $\\mu$ in terms of $E$ and $\\nu$ and factoring out the common term $\\frac{E}{(1+\\nu)(1-2\\nu)}$ yields the final matrix. The diagonal term for shear is $\\mu = \\frac{E}{2(1+\\nu)}$. To fit the factored form, we write it as:\n$$\n\\mu = \\frac{E}{(1+\\nu)(1-2\\nu)} \\left( \\frac{(1+\\nu)(1-2\\nu)}{2(1+\\nu)} \\right) = \\frac{E}{(1+\\nu)(1-2\\nu)} \\left( \\frac{1-2\\nu}{2} \\right)\n$$\nThe normal terms are $\\lambda+2\\mu = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}$ and $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$.\nThus the matrix is:\n$$\n\\boldsymbol{C}(E,\\nu) = \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{pmatrix}\n1-\\nu & \\nu & \\nu & 0 & 0 & 0 \\\\\n\\nu & 1-\\nu & \\nu & 0 & 0 & 0 \\\\\n\\nu & \\nu & 1-\\nu & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\frac{1-2\\nu}{2} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\frac{1-2\\nu}{2} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n$$\n\n### Verification of Positive-Definiteness\n\nFor thermodynamic stability, the strain energy density $W$ must be positive for any non-zero strain state, i.e., $W > 0$ for $\\boldsymbol{\\varepsilon} \\neq \\boldsymbol{0}$. The strain energy density can be written using the Voigt notation as $W = \\frac{1}{2}(\\boldsymbol{\\varepsilon}^{\\mathrm{V}})^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{\\varepsilon}^{\\mathrm{V}}$. Thus, we must show that the matrix $\\boldsymbol{C}$ is positive definite. This is equivalent to showing that the quadratic form $Q = (\\boldsymbol{\\varepsilon}^{\\mathrm{V}})^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{\\varepsilon}^{\\mathrm{V}}$ is positive for any non-zero strain vector $\\boldsymbol{\\varepsilon}^{\\mathrm{V}}$.\n\nDue to the block-diagonal structure of $\\boldsymbol{C}$, the quadratic form splits into two parts, one for normal strains and one for shear strains:\n$$\nQ = Q_{\\text{normal}} + Q_{\\text{shear}}\n$$\nWith $\\boldsymbol{\\varepsilon}^{\\mathrm{V}} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{yz}, \\gamma_{xz}, \\gamma_{xy})^{\\mathsf{T}}$, we have:\n$$\nQ_{\\text{shear}} = \\mu (\\gamma_{yz}^2 + \\gamma_{xz}^2 + \\gamma_{xy}^2)\n$$\nSince $E>0$ is given, $Q_{\\text{shear}} > 0$ for any non-zero shear strain if and only if $\\mu > 0$.\n$$\n\\mu = \\frac{E}{2(1+\\nu)} > 0 \\implies 1+\\nu > 0 \\implies \\nu > -1\n$$\nThis establishes the lower bound for $\\nu$.\n\nThe normal strain part is:\n$$\nQ_{\\text{normal}} = (\\lambda+2\\mu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2) + 2\\lambda(\\varepsilon_{xx}\\varepsilon_{yy}+\\varepsilon_{yy}\\varepsilon_{zz}+\\varepsilon_{zz}\\varepsilon_{xx})\n$$\nWe can rearrange this expression in terms of $E$ and $\\nu$:\n$$\nQ_{\\text{normal}} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\left[ (1-\\nu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2) + 2\\nu(\\varepsilon_{xx}\\varepsilon_{yy}+\\varepsilon_{yy}\\varepsilon_{zz}+\\varepsilon_{zz}\\varepsilon_{xx}) \\right]\n$$\nLet's analyze the term in the square brackets:\n$$\n[\\dots] = (1-2\\nu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2) + \\nu(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2 + 2\\varepsilon_{xx}\\varepsilon_{yy}+2\\varepsilon_{yy}\\varepsilon_{zz}+2\\varepsilon_{zz}\\varepsilon_{xx})\n$$\n$$\n[\\dots] = (1-2\\nu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2) + \\nu(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz})^2\n$$\nFor the entire quadratic form $Q_{\\text{normal}}$ to be positive, the pre-factor $\\frac{E}{(1+\\nu)(1-2\\nu)}$ must be positive. Since $E>0$ and we have established $1+\\nu>0$, we require:\n$$\n1-2\\nu > 0 \\implies \\nu < \\frac{1}{2}\n$$\nThis establishes the upper bound for $\\nu$.\nWith $-1 < \\nu < \\frac{1}{2}$, both $1-2\\nu$ and the pre-factor are positive. We must verify that the term in brackets is also positive for any non-zero normal strain state.\n- If $0 \\le \\nu < \\frac{1}{2}$, then $\\nu \\ge 0$ and $1-2\\nu > 0$. The term $(1-2\\nu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2)$ is non-negative, and $\\nu(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz})^2$ is non-negative. The sum is zero only if all strains are zero. Thus, it is positive definite.\n- If $-1 < \\nu < 0$, the term $\\nu(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz})^2$ is non-positive. A more robust way to show positive definiteness is to check the eigenvalues of the corresponding $3 \\times 3$ normal stiffness submatrix. The eigenvalues are $2\\mu$ (with multiplicity 2, corresponding to shear-like modes in the normal strain space) and $3K = 3(\\lambda+2/3\\mu)$ (with multiplicity 1, corresponding to the volumetric mode).\n- Condition 1: $2\\mu > 0$. We already showed this implies $\\nu > -1$.\n- Condition 2: $3K > 0$. The bulk modulus is $K = \\lambda + \\frac{2}{3}\\mu = \\frac{E}{3(1-2\\nu)}$. For $K>0$ (with $E>0$), we must have $1-2\\nu > 0$, which implies $\\nu  \\frac{1}{2}$.\n\nSince the eigenvalues of both blocks of the stiffness matrix $\\boldsymbol{C}$ are positive for $-1  \\nu  \\frac{1}{2}$, the matrix $\\boldsymbol{C}$ is positive definite, confirming the stability of the material in this range.", "answer": "$$\n\\boxed{\n\\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{pmatrix}\n1-\\nu  \\nu  \\nu  0  0  0 \\\\\n\\nu  1-\\nu  \\nu  0  0  0 \\\\\n\\nu  \\nu  1-\\nu  0  0  0 \\\\\n0  0  0  \\frac{1-2\\nu}{2}  0  0 \\\\\n0  0  0  0  \\frac{1-2\\nu}{2}  0 \\\\\n0  0  0  0  0  \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n}\n$$", "id": "3567935"}, {"introduction": "While isotropic models are common, many modern engineering materials, such as composites, are anisotropic. This exercise explores a key consequence of anisotropy by examining the stress response to a state of pure shear strain. By applying the generalized Hooke's law with a fully anisotropic stiffness matrix, you will identify the specific off-diagonal terms that induce normal stresses from shear deformation—a phenomenon absent in isotropic materials [@problem_id:3567935].", "problem": "Consider a homogeneous, linearly elastic, fully anisotropic solid under small strains. Let the small-strain tensor $\\boldsymbol{\\varepsilon}$ and the Cauchy stress tensor $\\boldsymbol{\\sigma}$ be second-order symmetric tensors related by a fourth-order stiffness tensor $\\mathbb{C}$ that possesses the usual minor and major symmetries associated with a differentiable elastic strain energy. Adopt the standard Voigt mapping in which the stress and strain vectors are ordered as $(11,22,33,23,13,12)$ and the engineering shear strains are used so that the Voigt strain vector is $\\boldsymbol{\\varepsilon}_{\\mathrm{V}} = [\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}, 2\\varepsilon_{23}, 2\\varepsilon_{13}, 2\\varepsilon_{12}]^{\\mathsf{T}}$. \n\nA simple shear is applied in the $1$–$2$ plane such that $\\varepsilon_{12} = \\gamma/2$ and all other components of $\\boldsymbol{\\varepsilon}$ are zero, where $\\gamma$ is the engineering shear strain amplitude. Using only the linear mapping from $\\boldsymbol{\\varepsilon}$ to $\\boldsymbol{\\sigma}$ through $\\mathbb{C}$ and the above Voigt conventions, derive the Cauchy stress response in Voigt form $\\boldsymbol{\\sigma}_{\\mathrm{V}} = [\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{23}, \\sigma_{13}, \\sigma_{12}]^{\\mathsf{T}}$ in terms of the components of the $6\\times 6$ stiffness matrix $\\mathbf{C}$ associated with $\\mathbb{C}$ and the scalar $\\gamma$. Then, from your expression, identify which specific anisotropic stiffness components in $\\mathbf{C}$ couple the applied shear strain to the normal stresses.\n\nExpress your final answer as a single row matrix containing, in order, the six components of $\\boldsymbol{\\sigma}_{\\mathrm{V}}$ followed by the three stiffness components that couple shear to normal stresses. No units are required in the final answer, and your expression must be fully symbolic.", "solution": "The problem requires the derivation of the Cauchy stress response for a linearly elastic, fully anisotropic solid subjected to a simple shear deformation. The relationship between the Cauchy stress tensor $\\boldsymbol{\\sigma}$ and the small-strain tensor $\\boldsymbol{\\varepsilon}$ is given by the generalized Hooke's law, $\\sigma_{ij} = \\mathbb{C}_{ijkl}\\varepsilon_{kl}$, where $\\mathbb{C}$ is the fourth-order stiffness tensor. For computational purposes, this relationship is commonly expressed in matrix-vector form using the Voigt notation.\n\nThe problem specifies the Voigt mapping convention as follows:\nThe stress vector $\\boldsymbol{\\sigma}_{\\mathrm{V}}$ is defined as:\n$$\n\\boldsymbol{\\sigma}_{\\mathrm{V}} = [\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{23}, \\sigma_{13}, \\sigma_{12}]^{\\mathsf{T}}\n$$\nThe strain vector $\\boldsymbol{\\varepsilon}_{\\mathrm{V}}$ is defined using engineering shear strains:\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{V}} = [\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}, 2\\varepsilon_{23}, 2\\varepsilon_{13}, 2\\varepsilon_{12}]^{\\mathsf{T}}\n$$\nUsing this convention, the constitutive relation becomes a matrix-vector product:\n$$\n\\boldsymbol{\\sigma}_{\\mathrm{V}} = \\mathbf{C} \\boldsymbol{\\varepsilon}_{\\mathrm{V}}\n$$\nwhere $\\mathbf{C}$ is the $6 \\times 6$ symmetric stiffness matrix.\n\nThe first step is to construct the Voigt strain vector $\\boldsymbol{\\varepsilon}_{\\mathrm{V}}$ for the specified deformation. The problem states that a simple shear is applied in the $1$–$2$ plane, such that the only non-zero component of the small-strain tensor $\\boldsymbol{\\varepsilon}$ is $\\varepsilon_{12} = \\gamma/2$. Due to the symmetry of the strain tensor, we also have $\\varepsilon_{21} = \\gamma/2$. All other components are zero:\n$$\n\\varepsilon_{11} = \\varepsilon_{22} = \\varepsilon_{33} = \\varepsilon_{23} = \\varepsilon_{32} = \\varepsilon_{13} = \\varepsilon_{31} = 0\n$$\nSubstituting these values into the definition of the Voigt strain vector:\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{V}} = \n\\begin{pmatrix}\n\\varepsilon_{11} \\\\\n\\varepsilon_{22} \\\\\n\\varepsilon_{33} \\\\\n2\\varepsilon_{23} \\\\\n2\\varepsilon_{13} \\\\\n2\\varepsilon_{12}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n2(0) \\\\\n2(0) \\\\\n2(\\gamma/2)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n\\gamma\n\\end{pmatrix}\n$$\nThe scalar $\\gamma$ is the engineering shear strain, $\\gamma = 2\\varepsilon_{12}$.\n\nThe next step is to calculate the Voigt stress vector $\\boldsymbol{\\sigma}_{\\mathrm{V}}$ by multiplying the stiffness matrix $\\mathbf{C}$ with the derived Voigt strain vector $\\boldsymbol{\\varepsilon}_{\\mathrm{V}}$. The general $6 \\times 6$ stiffness matrix for a fully anisotropic material is:\n$$\n\\mathbf{C} =\n\\begin{pmatrix}\nC_{11}  C_{12}  C_{13}  C_{14}  C_{15}  C_{16} \\\\\nC_{21}  C_{22}  C_{23}  C_{24}  C_{25}  C_{26} \\\\\nC_{31}  C_{32}  C_{33}  C_{34}  C_{35}  C_{36} \\\\\nC_{41}  C_{42}  C_{43}  C_{44}  C_{45}  C_{46} \\\\\nC_{51}  C_{52}  C_{53}  C_{54}  C_{55}  C_{56} \\\\\nC_{61}  C_{62}  C_{63}  C_{64}  C_{65}  C_{66}\n\\end{pmatrix}\n$$\nThe matrix-vector multiplication is:\n$$\n\\boldsymbol{\\sigma}_{\\mathrm{V}} = \\mathbf{C} \\boldsymbol{\\varepsilon}_{\\mathrm{V}} = \n\\begin{pmatrix}\nC_{11}  C_{12}  C_{13}  C_{14}  C_{15}  C_{16} \\\\\nC_{21}  C_{22}  C_{23}  C_{24}  C_{25}  C_{26} \\\\\nC_{31}  C_{32}  C_{33}  C_{34}  C_{35}  C_{36} \\\\\nC_{41}  C_{42}  C_{43}  C_{44}  C_{45}  C_{46} \\\\\nC_{51}  C_{52}  C_{53}  C_{54}  C_{55}  C_{56} \\\\\nC_{61}  C_{62}  C_{63}  C_{64}  C_{65}  C_{66}\n\\end{pmatrix}\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n\\gamma\n\\end{pmatrix}\n$$\nThis operation isolates the sixth column of the stiffness matrix $\\mathbf{C}$ and scales it by $\\gamma$. The resulting components of the Voigt stress vector are:\n$$\n\\sigma_{\\mathrm{V},1} = \\sigma_{11} = C_{16}\\gamma \\\\\n\\sigma_{\\mathrm{V},2} = \\sigma_{22} = C_{26}\\gamma \\\\\n\\sigma_{\\mathrm{V},3} = \\sigma_{33} = C_{36}\\gamma \\\\\n\\sigma_{\\mathrm{V},4} = \\sigma_{23} = C_{46}\\gamma \\\\\n\\sigma_{\\mathrm{V},5} = \\sigma_{13} = C_{56}\\gamma \\\\\n\\sigma_{\\mathrm{V},6} = \\sigma_{12} = C_{66}\\gamma\n$$\nTherefore, the Cauchy stress response in Voigt form is $\\boldsymbol{\\sigma}_{\\mathrm{V}} = [C_{16}\\gamma, C_{26}\\gamma, C_{36}\\gamma, C_{46}\\gamma, C_{56}\\gamma, C_{66}\\gamma]^{\\mathsf{T}}$.\n\nThe final task is to identify the anisotropic stiffness components that couple the applied shear strain to the normal stresses. The applied shear strain is $\\varepsilon_{12}$, which corresponds to the sixth component of the Voigt strain vector, $\\varepsilon_{\\mathrm{V},6} = \\gamma$. The normal stresses are $\\sigma_{11}$, $\\sigma_{22}$, and $\\sigma_{33}$, which are the first three components of the Voigt stress vector.\nThe relationships are:\n$$\n\\sigma_{11} = C_{16} \\gamma = C_{16} (2\\varepsilon_{12}) \\\\\n\\sigma_{22} = C_{26} \\gamma = C_{26} (2\\varepsilon_{12}) \\\\\n\\sigma_{33} = C_{36} \\gamma = C_{36} (2\\varepsilon_{12})\n$$\nThese equations show that the normal stresses $\\sigma_{11}$, $\\sigma_{22}$, and $\\sigma_{33}$ are generated in response to the shear strain $\\varepsilon_{12}$ (or equivalently, $\\gamma$). The stiffness components responsible for this coupling are the off-diagonal terms $C_{16}$, $C_{26}$, and $C_{36}$. In materials with higher symmetry, such as isotropic or orthotropic materials, these components are zero, and thus a pure shear strain does not induce normal stresses in the linear elastic regime. For a fully anisotropic material, these terms can be non-zero.\n\nThe final answer requires a single row matrix containing the six components of $\\boldsymbol{\\sigma}_{\\mathrm{V}}$ followed by the three identified coupling stiffness components.\nThe six components of $\\boldsymbol{\\sigma}_{\\mathrm{V}}$ are: $C_{16}\\gamma, C_{26}\\gamma, C_{36}\\gamma, C_{46}\\gamma, C_{56}\\gamma, C_{66}\\gamma$.\nThe three coupling stiffness components are: $C_{16}, C_{26}, C_{36}$.\nAssembling these nine elements into a single row matrix yields the final result.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nC_{16}\\gamma  C_{26}\\gamma  C_{36}\\gamma  C_{46}\\gamma  C_{56}\\gamma  C_{66}\\gamma  C_{16}  C_{26}  C_{36}\n\\end{pmatrix}\n}\n$$", "id": "3567985"}, {"introduction": "The true power of the generalized Hooke's law is realized in its computational implementation. This hands-on coding practice challenges you to build a small finite element model with orthotropic materials, a common form of anisotropy. You will implement the crucial step of rotating the material stiffness tensor from its local principal directions to the global coordinate system and assemble the global stiffness matrix, culminating in the calculation of strain energy for a deformed structure.", "problem": "Consider a two-dimensional small-strain, linear elastic, orthotropic material under plane stress. The material’s constitutive fourth-order elasticity tensor is defined in its local material frame aligned with axes $\\{1,2\\}$, and its principal properties are given by $(E_1,E_2,\\nu_{12},G_{12})$. The global computational frame is $\\{x,y\\}$. The displacement field is approximated with linear triangular finite elements, and numerical integration is used to assemble the global stiffness matrix.\n\nStarting from fundamental bases valid in computational solid mechanics for linear elasticity:\n- The small-strain kinematics define the strain tensor $\\varepsilon$ from the displacement field $u$ by $\\varepsilon = \\tfrac{1}{2}(\\nabla u + \\nabla u^\\top)$, and the engineering shear strain is $\\gamma_{xy} = 2 \\varepsilon_{xy}$.\n- The Generalized Hooke’s law (linear elasticity) defines the stress-strain relation $\\sigma = \\mathbb{C} : \\varepsilon$, where $\\mathbb{C}$ is the fourth-order elasticity tensor.\n- The principle of virtual work for linearized elasticity yields the element stiffness integrand as $B^\\top C B$, where $B$ maps nodal displacements to the engineering strain vector, and $C$ is the constitutive matrix consistent with the engineering strain vector.\n\nYour task is to implement a program that assembles the global stiffness matrix $K$ for a small mesh and evaluates the total strain energy for prescribed displacement fields. The essential algorithmic steps to be realized are:\n1. Build the local fourth-order plane-stress elasticity tensor $\\mathbb{C}^{(loc)}$ from $(E_1,E_2,\\nu_{12},G_{12})$ and $\\nu_{21} = \\nu_{12} E_2 / E_1$ so that major and minor symmetries are satisfied.\n2. For each element, rotate $\\mathbb{C}^{(loc)}$ to the element’s global frame using the proper tensor push-forward with the rotation matrix $Q(\\theta)$, where $\\theta$ is the angle between local axis $1$ and the global axis $x$. Specifically, compute $\\mathbb{C}^{(glob)}_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl} \\,\\mathbb{C}^{(loc)}_{ijkl}$.\n3. Map the rotated fourth-order tensor $\\mathbb{C}^{(glob)}$ to the $3\\times 3$ constitutive matrix $C$ consistent with the engineering strain vector $[\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}]^\\top$, taking care that $\\gamma_{xy} = 2\\varepsilon_{xy}$.\n4. For each linear triangular element with nodes $\\{(x_1,y_1),(x_2,y_2),(x_3,y_3)\\}$, compute the constant strain-displacement matrix $B$ and the element area $A_e$. For plane stress thickness $t$, evaluate the element stiffness as $K_e = t \\int_{\\Omega_e} B^\\top C B \\,\\mathrm{d}\\Omega$, which reduces to $K_e = t\\,A_e\\,B^\\top C B$ for linear triangles.\n5. Assemble the global stiffness matrix $K$ by summing contributions from all elements into the appropriate global degrees of freedom.\n6. For a prescribed nodal displacement vector $u$, compute the total strain energy as $U = \\tfrac{1}{2} u^\\top K u$.\n\nGeometry and discretization:\n- Use the unit square with nodes $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$, and two linear triangular elements: element $e_1$ with nodes $(0,0)\\rightarrow(1,0)\\rightarrow(1,1)$ and element $e_2$ with nodes $(0,0)\\rightarrow(1,1)\\rightarrow(0,1)$.\n- Assign a distinct orientation angle $\\theta$ (in degrees) to each element, measuring the rotation of the local material axis $1$ with respect to the global axis $x$.\n\nPrescribed displacement fields:\n- Field A (uniaxial $x$-extension): $u_x = \\epsilon_0 x$, $u_y = 0$, where $\\epsilon_0$ is a small strain amplitude.\n- Field B (uniaxial $y$-extension): $u_x = 0$, $u_y = \\epsilon_0 y$.\n\nUnits:\n- Material moduli $E_1$, $E_2$, and $G_{12}$ must be specified in Pascals ($\\text{Pa}$).\n- Poisson’s ratio $\\nu_{12}$ is unitless.\n- Thickness $t$ must be specified in meters ($\\text{m}$).\n- Coordinates are in meters ($\\text{m}$).\n- The strain amplitude $\\epsilon_0$ is unitless.\n- Report strain energies in Joules ($\\text{J}$).\n\nTest suite:\n- Test case 1 (happy path): material $(E_1,E_2,\\nu_{12},G_{12}) = (120\\times 10^9\\,\\text{Pa}, 60\\times 10^9\\,\\text{Pa}, 0.25, 40\\times 10^9\\,\\text{Pa})$, thickness $t = 0.01\\,\\text{m}$, strain amplitude $\\epsilon_0 = 10^{-3}$, element orientations $\\theta = [0^\\circ, 45^\\circ]$. Compute energies $U_x$ under Field A and $U_y$ under Field B, both in $\\text{J}$.\n- Test case 2 (boundary orientation): same material and thickness and $\\epsilon_0$ as Test case 1, with $\\theta = [0^\\circ, 90^\\circ]$. Compute energies $U_x$ and $U_y$ in $\\text{J}$.\n- Test case 3 (strong orthotropy edge case): material $(E_1,E_2,\\nu_{12},G_{12}) = (200\\times 10^9\\,\\text{Pa}, 5\\times 10^9\\,\\text{Pa}, 0.20, 3\\times 10^9\\,\\text{Pa})$, thickness $t = 0.01\\,\\text{m}$, $\\epsilon_0 = 10^{-3}$, element orientations $\\theta = [0^\\circ, 90^\\circ]$. Compute energy $U_x$ in $\\text{J}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n$[U_x^{(1)},U_y^{(1)},U_x^{(2)},U_y^{(2)},U_x^{(3)}]$\nAll values must be floating-point numbers in $\\text{J}$, with no additional text.", "solution": "This problem requires the implementation of a finite element assembly routine for a simple two-element mesh to calculate total strain energy under prescribed displacement fields for orthotropic materials. The solution follows the algorithmic steps outlined in the problem statement.\n\n**1. Constitutive Tensor in the Local Frame ($\\mathbb{C}^{(loc)}$)**\nFor a 2D orthotropic material under plane stress, the compliance matrix $S$ in the local material frame $\\{1,2\\}$ is given by:\n$$\nS = \\begin{pmatrix} 1/E_1  -\\nu_{12}/E_1  0 \\\\ -\\nu_{21}/E_2  1/E_2  0 \\\\ 0  0  1/G_{12} \\end{pmatrix}\n$$\nThe symmetry of the compliance tensor requires that $S_{12} = S_{21}$, which means $\\nu_{12}/E_1 = \\nu_{21}/E_2$. This yields the relation $\\nu_{21} = \\nu_{12} E_2 / E_1$, as specified in the problem. The local constitutive matrix $C^{(loc)}$ is the inverse of $S$. Since the shear response is uncoupled from the normal response for an orthotropic material aligned with the coordinate axes, we can invert the normal and shear blocks separately:\n$$\nC^{(loc)} = \\begin{pmatrix} \\frac{E_1}{1-\\nu_{12}\\nu_{21}}  \\frac{\\nu_{12}E_2}{1-\\nu_{12}\\nu_{21}}  0 \\\\ \\frac{\\nu_{21}E_1}{1-\\nu_{12}\\nu_{21}}  \\frac{E_2}{1-\\nu_{12}\\nu_{21}}  0 \\\\ 0  0  G_{12} \\end{pmatrix}\n$$\nThis $3 \\times 3$ matrix relates engineering stress $[\\sigma_{11}, \\sigma_{22}, \\sigma_{12}]^\\top$ to engineering strain $[\\varepsilon_{11}, \\varepsilon_{22}, \\gamma_{12}]^\\top$. We translate this into a fourth-order tensor $\\mathbb{C}^{(loc)}$, which relates the stress tensor $\\sigma_{ij}$ to the strain tensor $\\varepsilon_{kl}$. For an orthotropic material with axes aligned to the coordinate system, the non-zero components of $\\mathbb{C}^{(loc)}_{ijkl}$ are:\n- $\\mathbb{C}^{(loc)}_{1111} = C^{(loc)}_{11}$\n- $\\mathbb{C}^{(loc)}_{2222} = C^{(loc)}_{22}$\n- $\\mathbb{C}^{(loc)}_{1122} = \\mathbb{C}^{(loc)}_{2211} = C^{(loc)}_{12}$\n- $\\mathbb{C}^{(loc)}_{1212} = \\mathbb{C}^{(loc)}_{1221} = \\mathbb{C}^{(loc)}_{2112} = \\mathbb{C}^{(loc)}_{2121} = C^{(loc)}_{33} = G_{12}$\n\n**2. Tensor Rotation to the Global Frame ($\\mathbb{C}^{(glob)}$)**\nThe local material frame $\\{1,2\\}$ is rotated by an angle $\\theta$ with respect to the global frame $\\{x,y\\}$. The transformation of components of a fourth-order tensor from the local to the global frame is given by the push-forward operation specified:\n$$\n\\mathbb{C}^{(glob)}_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl} \\mathbb{C}^{(loc)}_{ijkl}\n$$\nwhere summation over repeated indices is implied, and $Q(\\theta)$ is the standard 2D rotation matrix for vector components:\n$$\nQ(\\theta) = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\nThis operation is efficiently implemented using `numpy.einsum`.\n\n**3. Mapping to Global Constitutive Matrix ($C$ from $\\mathbb{C}^{(glob)}$)**\nThe rotated fourth-order tensor $\\mathbb{C}^{(glob)}$ is mapped to a $3 \\times 3$ constitutive matrix $C$ consistent with the engineering strain vector $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$. The mapping from tensor components (using indices 0,1 for x,y) to matrix components is:\n- $C_{11} = \\mathbb{C}^{(glob)}_{0000}$\n- $C_{22} = \\mathbb{C}^{(glob)}_{1111}$\n- $C_{12} = C_{21} = \\mathbb{C}^{(glob)}_{0011}$\n- $C_{13} = C_{31} = \\mathbb{C}^{(glob)}_{0001}$\n- $C_{23} = C_{32} = \\mathbb{C}^{(glob)}_{1101}$\n- $C_{33} = \\mathbb{C}^{(glob)}_{0101}$\nDue to the symmetries of $\\mathbb{C}$, the resulting matrix $C$ is symmetric.\n\n**4. Element Stiffness Matrix ($K_e$)**\nFor a linear triangular element (Constant Strain Triangle or CST), the strain field is constant. The element stiffness matrix is:\n$$\nK_e = t \\int_{\\Omega_e} B^\\top C B \\, \\mathrm{d}\\Omega = t A_e B^\\top C B\n$$\nwhere $t$ is the thickness, $A_e$ is the element area, and $B$ is the strain-displacement matrix. For a triangle with nodes $(x_1,y_1), (x_2,y_2), (x_3,y_3)$, the $B$ matrix is given by:\n$$\nB = \\frac{1}{2A_e} \\begin{pmatrix}\nb_1  0  b_2  0  b_3  0 \\\\\n0  c_1  0  c_2  0  c_3 \\\\\nc_1  b_1  c_2  b_2  c_3  b_3\n\\end{pmatrix} \\quad\n\\begin{aligned}\nb_i = y_j - y_k \\\\\nc_i = x_k - x_j\n\\end{aligned} \\quad \\text{(cyclic } i,j,k \\text{)}\n$$\n$K_e$ is a $6 \\times 6$ matrix.\n\n**5. Global Stiffness Matrix Assembly ($K$)**\nThe global stiffness matrix $K$ is an $8 \\times 8$ matrix for this problem (4 nodes, 2 DOFs per node). It is assembled by iterating through the elements and adding each element's $K_e$ contribution into the appropriate global degrees of freedom.\n\n**6. Strain Energy Calculation ($U$)**\nWith the global stiffness matrix $K$ assembled, the total strain energy $U$ for a given global nodal displacement vector $u$ is calculated as:\n$$\nU = \\frac{1}{2} u^\\top K u\n$$\nThe nodal displacement vectors are computed by evaluating the prescribed displacement fields $u(x,y)$ at each of the four nodal coordinates. The implementation combines these steps into a single script that processes each test case and computes the required strain energies.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the simulation, and print results.\n    \"\"\"\n    # Define geometry and mesh using 0-based indexing for nodes.\n    NODES = np.array([\n        [0.0, 0.0],  # Node 0\n        [1.0, 0.0],  # Node 1\n        [1.0, 1.0],  # Node 2\n        [0.0, 1.0]   # Node 3\n    ])\n    ELEMENTS = np.array([\n        [0, 1, 2],  # Element 0 (nodes (0,0)->(1,0)->(1,1))\n        [0, 2, 3]   # Element 1 (nodes (0,0)->(1,1)->(0,1))\n    ])\n    NUM_NODES = NODES.shape[0]\n    NUM_DOFS = 2 * NUM_NODES\n\n    def get_displacements(epsilon_0):\n        \"\"\"Computes nodal displacements for prescribed fields A and B.\"\"\"\n        u_A = np.zeros(NUM_DOFS)\n        u_B = np.zeros(NUM_DOFS)\n        for i, (x, y) in enumerate(NODES):\n            # Field A: u_x = epsilon_0 * x, u_y = 0\n            u_A[2 * i] = epsilon_0 * x\n            u_A[2 * i + 1] = 0.0\n            # Field B: u_x = 0, u_y = epsilon_0 * y\n            u_B[2 * i] = 0.0\n            u_B[2 * i + 1] = epsilon_0 * y\n        return u_A, u_B\n\n    def build_local_elasticity_tensor(E1, E2, nu12, G12):\n        \"\"\"Builds the local 4th-order plane-stress elasticity tensor.\"\"\"\n        nu21 = nu12 * E2 / E1\n        if 1.0 - nu12 * nu21 = 1e-12: # Check for stability\n            raise ValueError(\"Material stability condition (1-nu12*nu21  0) violated.\")\n        \n        factor = 1.0 / (1.0 - nu12 * nu21)\n        C11 = E1 * factor\n        C22 = E2 * factor\n        C12 = nu12 * E2 * factor\n        \n        C_tensor_loc = np.zeros((2, 2, 2, 2))\n        C_tensor_loc[0, 0, 0, 0] = C11\n        C_tensor_loc[1, 1, 1, 1] = C22\n        C_tensor_loc[0, 0, 1, 1] = C_tensor_loc[1, 1, 0, 0] = C12\n        C_tensor_loc[0, 1, 0, 1] = C_tensor_loc[1, 0, 1, 0] = \\\n        C_tensor_loc[0, 1, 1, 0] = C_tensor_loc[1, 0, 0, 1] = G12\n        return C_tensor_loc\n\n    def rotate_and_map_to_C_matrix(C_tensor_loc, theta_deg):\n        \"\"\"Rotates the elasticity tensor and maps it to a 3x3 constitutive matrix.\"\"\"\n        theta_rad = np.deg2rad(theta_deg)\n        c, s = np.cos(theta_rad), np.sin(theta_rad)\n        Q = np.array([[c, -s], [s, c]])\n        \n        C_tensor_glob = np.einsum('pi,qj,rk,sl,ijkl-pqrs', Q, Q, Q, Q, C_tensor_loc, optimize=True)\n        \n        C_glob_3x3 = np.array([\n            [C_tensor_glob[0, 0, 0, 0], C_tensor_glob[0, 0, 1, 1], C_tensor_glob[0, 0, 0, 1]],\n            [C_tensor_glob[1, 1, 0, 0], C_tensor_glob[1, 1, 1, 1], C_tensor_glob[1, 1, 0, 1]],\n            [C_tensor_glob[0, 1, 0, 0], C_tensor_glob[0, 1, 1, 1], C_tensor_glob[0, 1, 0, 1]]\n        ])\n        return C_glob_3x3\n\n    def calculate_element_stiffness(coords, thickness, C_glob_3x3):\n        \"\"\"Computes the 6x6 element stiffness matrix for a linear triangle.\"\"\"\n        (x1, y1), (x2, y2), (x3, y3) = coords[0], coords[1], coords[2]\n        area = 0.5 * abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n        \n        b1, b2, b3 = y2 - y3, y3 - y1, y1 - y2\n        c1, c2, c3 = x3 - x2, x1 - x3, x2 - x1\n        \n        B = (1.0 / (2.0 * area)) * np.array([\n            [b1, 0, b2, 0, b3, 0],\n            [0, c1, 0, c2, 0, c3],\n            [c1, b1, c2, b2, c3, b3]\n        ])\n        \n        return thickness * area * (B.T @ C_glob_3x3 @ B)\n\n    def process_case(material_props, t, thetas, epsilon_0, compute_fields):\n        \"\"\"Assembles the global stiffness matrix and computes strain energies.\"\"\"\n        C_tensor_loc = build_local_elasticity_tensor(*material_props)\n        K_global = np.zeros((NUM_DOFS, NUM_DOFS))\n        \n        for i, element_nodes in enumerate(ELEMENTS):\n            C_glob_3x3 = rotate_and_map_to_C_matrix(C_tensor_loc, thetas[i])\n            element_coords = NODES[element_nodes]\n            Ke = calculate_element_stiffness(element_coords, t, C_glob_3x3)\n            \n            dof_indices = []\n            for node_idx in element_nodes:\n                dof_indices.extend([2 * node_idx, 2 * node_idx + 1])\n            \n            global_indices = np.ix_(dof_indices, dof_indices)\n            K_global[global_indices] += Ke\n\n        u_A, u_B = get_displacements(epsilon_0)\n        \n        case_results = []\n        if 'A' in compute_fields:\n            U_A = 0.5 * u_A.T @ K_global @ u_A\n            case_results.append(U_A)\n        if 'B' in compute_fields:\n            U_B = 0.5 * u_B.T @ K_global @ u_B\n            case_results.append(U_B)\n        return case_results\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'material': (120e9, 60e9, 0.25, 40e9), 't': 0.01, 'epsilon_0': 1e-3, 'thetas': [0.0, 45.0], 'fields': ['A', 'B']},\n        {'material': (120e9, 60e9, 0.25, 40e9), 't': 0.01, 'epsilon_0': 1e-3, 'thetas': [0.0, 90.0], 'fields': ['A', 'B']},\n        {'material': (200e9, 5e9, 0.20, 3e9), 't': 0.01, 'epsilon_0': 1e-3, 'thetas': [0.0, 90.0], 'fields': ['A']}\n    ]\n\n    all_results = []\n    for case in test_cases:\n        results = process_case(case['material'], case['t'], case['thetas'], case['epsilon_0'], case['fields'])\n        all_results.extend(results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3567978"}]}