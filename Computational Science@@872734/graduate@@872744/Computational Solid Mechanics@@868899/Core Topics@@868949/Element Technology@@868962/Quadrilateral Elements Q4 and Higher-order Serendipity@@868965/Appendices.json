{"hands_on_practices": [{"introduction": "In the finite element method, the proper definition of an element is the first and most critical step. While seemingly a minor bookkeeping detail, the order in which an element's nodes are numbered has profound implications for the validity of the entire analysis. This practice explores how different nodal orderings for the same physical quadrilateral affect the isoparametric mapping and its Jacobian, revealing fundamental principles that ensure a valid, orientation-preserving transformation from the parent domain [@problem_id:3592210]. Understanding this is essential for robust mesh generation and correct application of boundary conditions.", "problem": "A bilinear isoparametric quadrilateral element ($\\mathrm{Q}4$) maps the parent square $\\{(\\xi,\\eta)\\,|\\,\\xi,\\eta\\in[-1,1]\\}$ to a convex physical quadrilateral via the standard isoparametric construction. Consider the physical quadrilateral with vertices at coordinates $\\mathbf{x}_A=(0,0)$, $\\mathbf{x}_B=(2,0)$, $\\mathbf{x}_C=(2.5,1.5)$, and $\\mathbf{x}_D=(-0.2,1.2)$, given in the order $(A,B,C,D)$ which is counterclockwise in the plane.\n\nTwo different node orderings are used to define the same geometric element:\n- Ordering $\\mathcal{O}_1$: node $1\\mapsto A$, node $2\\mapsto B$, node $3\\mapsto C$, node $4\\mapsto D$.\n- Ordering $\\mathcal{O}_2$: node $1\\mapsto A$, node $2\\mapsto D$, node $3\\mapsto C$, node $4\\mapsto B$.\n\nStarting only from the definition of the bilinear isoparametric mapping for a $4$-node quadrilateral, perform the following tasks:\n- Derive the isoparametric mapping $\\mathbf{x}(\\xi,\\eta)$ for each ordering, explicitly identifying which physical vertex is associated with each corner of the parent square $\\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$.\n- From first principles, construct the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)=\\partial\\mathbf{x}/\\partial(\\xi,\\eta)$ and evaluate its determinant at the element center $(\\xi,\\eta)=(0,0)$ for both orderings.\n- Discuss, using your derivations, the implications of the different node orderings for Gaussian quadrature over the element interior and for the application of Neumann boundary conditions along an element edge in the Finite Element Method (FEM). Your discussion should state what changes, what must be kept consistent, and what invariants are preserved, and briefly comment on how these considerations extend to higher-order serendipity elements (e.g., $\\mathrm{Q}8$ and $\\mathrm{Q}9$).\n\nReport as your final answer the signed ratio\n$$\nr \\;=\\; \\frac{\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0)}{\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0)}\\,.\n$$\nThe ratio $r$ is dimensionless. Provide the exact value. If numerical evaluation is required, round to four significant figures.", "solution": "The problem requires an analysis of a bilinear isoparametric quadrilateral element ($\\mathrm{Q}4$) under two different nodal ordering schemes. We must derive the isoparametric mappings, evaluate the Jacobian determinant at the element center for each case, and discuss the implications.\n\nThe standard parent element for a $\\mathrm{Q}4$ element is a square in the parametric space $(\\xi, \\eta)$ defined by $\\{(\\xi,\\eta) \\,|\\, \\xi, \\eta \\in [-1, 1]\\}$. The four nodes of the parent element, numbered counter-clockwise, are located at:\nNode $1$: $(\\xi, \\eta) = (-1, -1)$\nNode $2$: $(\\xi, \\eta) = (1, -1)$\nNode $3$: $(\\xi, \\eta) = (1, 1)$\nNode $4$: $(\\xi, \\eta) = (-1, 1)$\n\nThe isoparametric mapping from the parent coordinates $(\\xi, \\eta)$ to the physical coordinates $\\mathbf{x} = (x, y)$ is given by:\n$$\n\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{x}_i\n$$\nwhere $\\mathbf{x}_i$ are the coordinates of the physical nodes and $N_i(\\xi, \\eta)$ are the bilinear shape functions:\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe Jacobian matrix of the mapping is defined as $\\mathbf{J} = \\frac{\\partial \\mathbf{x}}{\\partial(\\xi, \\eta)}$, which is a $2 \\times 2$ matrix whose columns are the partial derivatives of the position vector $\\mathbf{x}$ with respect to the parent coordinates:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nThe columns of the Jacobian are computed by differentiating the mapping function:\n$\\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} \\mathbf{x}_i$ and $\\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} \\mathbf{x}_i$.\n\nThe derivatives of the shape functions are:\n$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta)$, $\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)$\n$\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$, $\\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)$, $\\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)$, $\\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)$\n\nWe are asked to evaluate the Jacobian at the element center, $(\\xi, \\eta) = (0, 0)$. At this point, the derivatives of the shape functions simplify to:\n$\\frac{\\partial N_1}{\\partial \\xi}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\xi}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\xi}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\xi}(0,0) = -\\frac{1}{4}$\n$\\frac{\\partial N_1}{\\partial \\eta}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\eta}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\eta}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\eta}(0,0) = \\frac{1}{4}$\n\nThus, the columns of the Jacobian matrix at the center are:\n$\\frac{\\partial \\mathbf{x}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_1 + \\mathbf{x}_2 + \\mathbf{x}_3 - \\mathbf{x}_4)$\n$\\frac{\\partial \\mathbf{x}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_1 - \\mathbf{x}_2 + \\mathbf{x}_3 + \\mathbf{x}_4)$\n\nThe physical vertices are given as $\\mathbf{x}_A=(0,0)$, $\\mathbf{x}_B=(2,0)$, $\\mathbf{x}_C=(2.5,1.5)$, and $\\mathbf{x}_D=(-0.2,1.2)$.\n\n**Analysis for Ordering $\\mathcal{O}_1$**\nFor ordering $\\mathcal{O}_1$, the mapping between parent nodes and physical vertices is:\nNode $1 \\to \\mathbf{x}_1 = \\mathbf{x}_A = (0,0)$\nNode $2 \\to \\mathbf{x}_2 = \\mathbf{x}_B = (2,0)$\nNode $3 \\to \\mathbf{x}_3 = \\mathbf{x}_C = (2.5,1.5)$\nNode $4 \\to \\mathbf{x}_4 = \\mathbf{x}_D = (-0.2,1.2)$\nThis corresponds to a counter-clockwise traversal of the physical quadrilateral $A \\to B \\to C \\to D$.\n\nThe isoparametric mapping is $\\mathbf{x}_{\\mathcal{O}_1}(\\xi, \\eta) = N_1(\\xi,\\eta)\\mathbf{x}_A + N_2(\\xi,\\eta)\\mathbf{x}_B + N_3(\\xi,\\eta)\\mathbf{x}_C + N_4(\\xi,\\eta)\\mathbf{x}_D$.\n\nLet's compute the columns of the Jacobian matrix $\\mathbf{J}_{\\mathcal{O}_1}$ at $(\\xi,\\eta)=(0,0)$:\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_1}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A + \\mathbf{x}_B + \\mathbf{x}_C - \\mathbf{x}_D)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} - \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} 2 + 2.5 + 0.2 \\\\ 0 + 1.5 - 1.2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 4.7 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 1.175 \\\\ 0.075 \\end{pmatrix}$\n\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_1}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A - \\mathbf{x}_B + \\mathbf{x}_C + \\mathbf{x}_D)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} -2 + 2.5 - 0.2 \\\\ 0 + 1.5 + 1.2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 0.3 \\\\ 2.7 \\end{pmatrix} = \\begin{pmatrix} 0.075 \\\\ 0.675 \\end{pmatrix}$\n\nThe Jacobian matrix for ordering $\\mathcal{O}_1$ at the center is:\n$$\n\\mathbf{J}_{\\mathcal{O}_1}(0,0) = \\begin{pmatrix} 1.175  0.075 \\\\ 0.075  0.675 \\end{pmatrix}\n$$\nIts determinant is:\n$\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0) = (1.175)(0.675) - (0.075)(0.075) = 0.793125 - 0.005625 = 0.7875$.\nThe positive determinant is consistent with the counter-clockwise (orientation-preserving) mapping from the parent element.\n\n**Analysis for Ordering $\\mathcal{O}_2$**\nFor ordering $\\mathcal{O}_2$, the mapping is:\nNode $1 \\to \\mathbf{x}_1 = \\mathbf{x}_A = (0,0)$\nNode $2 \\to \\mathbf{x}_2 = \\mathbf{x}_D = (-0.2,1.2)$\nNode $3 \\to \\mathbf{x}_3 = \\mathbf{x}_C = (2.5,1.5)$\nNode $4 \\to \\mathbf{x}_4 = \\mathbf{x}_B = (2,0)$\nThis corresponds to a clockwise traversal of the physical quadrilateral $A \\to D \\to C \\to B$.\n\nThe isoparametric mapping is $\\mathbf{x}_{\\mathcal{O}_2}(\\xi, \\eta) = N_1(\\xi,\\eta)\\mathbf{x}_A + N_2(\\xi,\\eta)\\mathbf{x}_D + N_3(\\xi,\\eta)\\mathbf{x}_C + N_4(\\xi,\\eta)\\mathbf{x}_B$.\n\nLet's compute the columns of the Jacobian matrix $\\mathbf{J}_{\\mathcal{O}_2}$ at $(\\xi,\\eta)=(0,0)$:\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_2}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A + \\mathbf{x}_D + \\mathbf{x}_C - \\mathbf{x}_B)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} -0.2 + 2.5 - 2 \\\\ 1.2 + 1.5 - 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 0.3 \\\\ 2.7 \\end{pmatrix} = \\begin{pmatrix} 0.075 \\\\ 0.675 \\end{pmatrix}$\n\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_2}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A - \\mathbf{x}_D + \\mathbf{x}_C + \\mathbf{x}_B)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} 0.2 + 2.5 + 2 \\\\ -1.2 + 1.5 + 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 4.7 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 1.175 \\\\ 0.075 \\end{pmatrix}$\n\nThe Jacobian matrix for ordering $\\mathcal{O}_2$ at the center is:\n$$\n\\mathbf{J}_{\\mathcal{O}_2}(0,0) = \\begin{pmatrix} 0.075  1.175 \\\\ 0.675  0.075 \\end{pmatrix}\n$$\nWe observe that $\\mathbf{J}_{\\mathcal{O}_2}(0,0)$ is formed by swapping the columns of $\\mathbf{J}_{\\mathcal{O}_1}(0,0)$. Swapping two columns of a matrix negates its determinant.\n$\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0) = (0.075)(0.075) - (1.175)(0.675) = 0.005625 - 0.793125 = -0.7875$.\nThe negative determinant is consistent with the clockwise (orientation-reversing) mapping.\n\n**Final Answer Calculation**\nThe ratio $r$ is:\n$$\nr = \\frac{\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0)}{\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0)} = \\frac{-0.7875}{0.7875} = -1\n$$\n\n**Discussion of Implications**\n\nThe derivations highlight several critical aspects of node ordering in the Finite Element Method.\n\n1.  **Implications for Gaussian Quadrature**: Numerical integration over the physical element domain $\\Omega_e$ is performed in the parent domain: $\\int_{\\Omega_e} f(\\mathbf{x}) d\\Omega = \\int_{-1}^{1}\\int_{-1}^{1} f(\\mathbf{x}(\\xi,\\eta)) \\det\\mathbf{J}(\\xi,\\eta) d\\xi d\\eta$. The sign of the Jacobian determinant $\\det\\mathbf{J}$ depends directly on the node ordering. A counter-clockwise ordering (like $\\mathcal{O}_1$) yields a positive determinant, while a clockwise ordering (like $\\mathcal{O}_2$) yields a negative one. For a valid physical mapping, the determinant must be non-zero everywhere in the element. Most FEM codes require $\\det\\mathbf{J}  0$ and would flag an element with negative $\\det\\mathbf{J}$ as \"inverted\" or \"improperly defined.\" To compute a physical quantity like mass or energy, which must be positive, the integration must use the absolute value of the determinant, $|\\det\\mathbf{J}|$. While the final integrated value over the element is the same (since $|\\det\\mathbf{J}_{\\mathcal{O}_1}| = |\\det\\mathbf{J}_{\\mathcal{O}_2}|$ for this specific change), the functions being evaluated at each Gauss point—both the mapped function $f(\\mathbf{x}(\\xi,\\eta))$ and $\\det\\mathbf{J}(\\xi,\\eta)$—are different for each ordering. A consistent nodal ordering convention (e.g., always counter-clockwise) is crucial for robust mesh generation and analysis.\n\n2.  **Implications for Neumann Boundary Conditions**: Neumann boundary conditions, such as surface tractions or heat fluxes, are integrated over element edges. The definition of an edge is tied to the node ordering. For ordering $\\mathcal{O}_1$, the parent edge between nodes $1$ and $2$ ($\\eta=-1$, $\\xi \\in [-1,1]$) maps to the physical edge $A-B$. For ordering $\\mathcal{O}_2$, the same parent edge maps to physical edge $A-D$. Consequently, applying a boundary condition to a physical edge requires precise knowledge of which parent edge it corresponds to, which is entirely determined by the nodal ordering. In a mesh of multiple elements, adjacent elements must have a consistent definition for their shared edge. For example, if element $1$ defines edge $I-J$ with nodes $(i, j)$, the neighboring element $2$ must define it with nodes $(j, i)$. This ensures that outward normal vectors are computed consistently and inter-element fluxes are correctly balanced. A haphazard node ordering would make the application of boundary conditions and the assembly of the global system matrix impossible to manage correctly.\n\n3.  **Invariants and Changes**:\n    -   **Changes**: The node ordering directly changes the isoparametric map $\\mathbf{x}(\\xi,\\eta)$, the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$, and the sign of its determinant $\\det\\mathbf{J}$. The association between parent element features (e.g., edge $1-2$) and physical features (e.g., edge $A-B$) is altered.\n    -   **Invariants**: The physical geometry (the quadrilateral itself) and its intrinsic properties like area are invariant. The magnitude of the differential area element $|d\\Omega| = |\\det\\mathbf{J}| d\\xi d\\eta$ at a specific physical point is also invariant, although that physical point corresponds to different $(\\xi,\\eta)$ coordinates in each mapping.\n\n4.  **Extension to Higher-Order Elements**: These principles extend directly to higher-order serendipity ($\\mathrm{Q}8$) and Lagrangian ($\\mathrm{Q}9$) elements. For these elements, a consistent node numbering scheme (typically counter-clockwise for corner nodes, then counter-clockwise for midside nodes, and finally interior nodes) is even more critical. The mapping functions are of higher polynomial order, and an incorrect node ordering or poor placement of midside/interior nodes can easily cause the mapping to become non-invertible ($\\det\\mathbf{J} \\le 0$) at points inside the element, even if the physical quadrilateral is convex. Such \"element distortion\" invalidates the analysis. Therefore, strict adherence to a standard ordering convention is a fundamental requirement for generating valid meshes with higher-order elements.", "answer": "$$\n\\boxed{-1}\n$$", "id": "3592210"}, {"introduction": "Once an element is defined, the next step is to compute its characteristic matrices, such as the stiffness matrix $K_e$, which relates nodal forces to nodal displacements. While this assembly process is often relegated to a computational black box, a true understanding of the method requires appreciating the fundamental principles embedded within the calculation. This exercise tasks you with assembling a stiffness matrix and evaluating its symmetry, demonstrating a core theoretical property of finite elements derived from linear elastic models that serves as both a conceptual cornerstone and a vital numerical verification check [@problem_id:3592225].", "problem": "Consider a two-dimensional small-strain, plane stress analysis using a four-node isoparametric bilinear quadrilateral element (Q4). The element has thickness $t$ and occupies a distorted parallelogram in physical coordinates with nodal positions\n$$\n(x_1,y_1)=(0,0),\\quad (x_2,y_2)=(2,0.5),\\quad (x_3,y_3)=(2.5,2.0),\\quad (x_4,y_4)=(0.5,1.5).\n$$\nAssume linear elastic, homogeneous, isotropic material with Young’s modulus $E$ and Poisson’s ratio $\\nu$ under plane stress, so the constitutive matrix $D$ is\n$$\nD=\\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1  \\nu  0\\\\\n\\nu  1  0\\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{bmatrix}.\n$$\nLet $E=200\\times 10^{9}$, $\\nu=0.3$, and $t=0.01$, with all length units in meters and force units in Newtons. Use the standard $2\\times 2$ Gauss quadrature in the parent element $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ with Gauss points at $(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$ and unit weights. \n\nStarting from the kinematic definition of small strain and the isoparametric mapping, evaluate the strain-displacement matrix $B$ at each of the four Gauss points. Then, using the Gauss quadrature, assemble the element stiffness matrix\n$$\nK_e=\\sum_{g=1}^{4} B(\\xi_g,\\eta_g)^{\\mathsf{T}}\\,D\\,B(\\xi_g,\\eta_g)\\,t\\,\\det(J(\\xi_g,\\eta_g)),\n$$\nwhere $J$ is the Jacobian of the isoparametric mapping. Finally, define the dimensionless asymmetry index\n$$\ns=\\frac{\\|K_e-K_e^{\\mathsf{T}}\\|_{F}}{\\|K_e\\|_{F}},\n$$\nwhere $\\|\\cdot\\|_{F}$ denotes the Frobenius norm. Compute $s$ and round your final numerical answer to four significant figures. State clearly whether the computed $K_e$ is symmetric based on your evaluation.", "solution": "This problem requires the computation of an asymmetry index, $s$, for an element stiffness matrix $K_e$. While the problem provides all the numerical data to assemble the matrix, it is more instructive and rigorous to first examine the theoretical structure of the formulation. The question probes a fundamental property of the finite element method for linear elasticity.\n\nThe element stiffness matrix $K_e$ is assembled using $2\\times 2$ Gauss quadrature with unit weights ($w_g=1$) as:\n$$\nK_e = \\sum_{g=1}^{4} B(\\xi_g,\\eta_g)^{\\mathsf{T}}\\,D\\,B(\\xi_g,\\eta_g)\\,t\\,\\det(J(\\xi_g,\\eta_g))\n$$\nHere, $B$ is the strain-displacement matrix, $D$ is the constitutive matrix, $t$ is the thickness, and $J$ is the Jacobian of the isoparametric mapping. The summation is over the four Gauss points $(\\xi_g, \\eta_g)$.\n\nThe core of the problem lies in determining the symmetry of $K_e$. A matrix is symmetric if it is equal to its own transpose, i.e., $K_e = K_e^{\\mathsf{T}}$. Let's compute the transpose of $K_e$:\n$$\nK_e^{\\mathsf{T}} = \\left( \\sum_{g=1}^{4} B_g^{\\mathsf{T}}\\,D\\,B_g\\,t\\,\\det(J_g) \\right)^{\\mathsf{T}}\n$$\nwhere for brevity, $B_g = B(\\xi_g,\\eta_g)$ and $J_g = J(\\xi_g,\\eta_g)$. Since the transpose of a sum is the sum of the transposes, and the scalars $t$ and $\\det(J_g)$ are unaffected by the matrix transpose operation, we have:\n$$\nK_e^{\\mathsf{T}} = \\sum_{g=1}^{4} \\left( B_g^{\\mathsf{T}}\\,D\\,B_g \\right)^{\\mathsf{T}} t\\,\\det(J_g)\n$$\nUsing the property that $(ABC)^{\\mathsf{T}} = C^{\\mathsf{T}}B^{\\mathsf{T}}A^{\\mathsf{T}}$, we can expand the transpose of the matrix product:\n$$\n\\left( B_g^{\\mathsf{T}}\\,D\\,B_g \\right)^{\\mathsf{T}} = (B_g)^{\\mathsf{T}} \\, (D)^{\\mathsf{T}} \\, (B_g^{\\mathsf{T}})^{\\mathsf{T}}\n$$\nUsing the property that $(A^{\\mathsf{T}})^{\\mathsf{T}} = A$, we get:\n$$\n\\left( B_g^{\\mathsf{T}}\\,D\\,B_g \\right)^{\\mathsf{T}} = B_g^{\\mathsf{T}} \\, D^{\\mathsf{T}} \\, B_g\n$$\nSubstituting this back into the expression for $K_e^{\\mathsf{T}}$:\n$$\nK_e^{\\mathsf{T}} = \\sum_{g=1}^{4} B_g^{\\mathsf{T}}\\,D^{\\mathsf{T}}\\,B_g\\,t\\,\\det(J_g)\n$$\nFor $K_e$ to be symmetric, we must have $K_e = K_e^{\\mathsf{T}}$. Comparing the expressions for $K_e$ and $K_e^{\\mathsf{T}}$, this equality holds if and only if $D = D^{\\mathsf{T}}$. Thus, the symmetry of the element stiffness matrix is directly inherited from the symmetry of the constitutive matrix.\n\nLet's examine the constitutive matrix $D$ given in the problem statement for plane stress:\n$$\nD = \\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\nThis is the standard constitutive matrix for a linear elastic, isotropic material. By inspection, this matrix is symmetric ($D_{12} = D_{21}$). Therefore, $D = D^{\\mathsf{T}}$.\n\nSince the constitutive matrix $D$ is symmetric, it follows that $K_e^{\\mathsf{T}} = K_e$. Based on its theoretical construction, the element stiffness matrix must be symmetric. This result holds for any non-degenerate element geometry and for any material model with a symmetric constitutive law. Therefore, evaluating the strain-displacement matrix $B$ at each Gauss point and assembling $K_e$ will necessarily yield a symmetric matrix.\n\nThe asymmetry index is defined as:\n$$\ns = \\frac{\\|K_e - K_e^{\\mathsf{T}}\\|_{F}}{\\|K_e\\|_{F}}\n$$\nSince we have established that $K_e = K_e^{\\mathsf{T}}$, the difference $K_e - K_e^{\\mathsf{T}}$ is the zero matrix. The Frobenius norm of a zero matrix is $0$:\n$$\n\\|K_e - K_e^{\\mathsf{T}}\\|_{F} = \\|0\\|_{F} = 0\n$$\nThe denominator, $\\|K_e\\|_{F}$, is the Frobenius norm of the stiffness matrix. For a non-degenerate element with valid material properties, the stiffness matrix $K_e$ is a non-zero, positive semi-definite matrix. Its Frobenius norm is therefore strictly positive, $\\|K_e\\|_{F} > 0$.\n\nThus, the asymmetry index is precisely:\n$$\ns = \\frac{0}{\\|K_e\\|_{F}} = 0\n$$\nThe exact value is $0$. Rounding to four significant figures gives $0.0000$. Based on this evaluation, the computed stiffness matrix $K_e$ is symmetric. Any non-zero asymmetry index obtained from a numerical calculation would be due to floating-point arithmetic errors, which are not part of the theoretical model.", "answer": "$$\n\\boxed{0.0000}\n$$", "id": "3592225"}, {"introduction": "The ultimate goal of a finite element model is to accurately approximate the true solution of a physical problem. An element's ability to do so depends on whether its shape function space is \"rich\" enough to capture the behavior of the exact solution, a concept known as polynomial reproduction. This advanced practice delves into this crucial topic, challenging you to determine the minimum element order required to exactly model a problem with a given polynomial body force and to analyze why lower-order elements fail, particularly when geometric distortion and numerical integration are considered [@problem_id:3592231].", "problem": "A single isoparametric quadrilateral element occupies a physical domain mapped from the parent square with parent coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$. Consider a homogeneous, linear elastic, plane strain solid with Lamé operator acting on the displacement field $\\boldsymbol{u}=(u_x,u_y)$, body forces $\\boldsymbol{b}=(b_x,b_y)$, and total potential energy $\\Pi[\\boldsymbol{u}]$ defined by the standard principle of minimum potential energy. The body forces are quadratic polynomials in the physical coordinates: $b_x=x^2$ and $b_y=y^2$. The element mapping is bilinear (isoparametric with four-node bilinear shape functions) and mildly distorted, given explicitly by\n$$\nx(\\xi,\\eta)=\\xi+\\alpha\\,\\xi\\,\\eta,\\quad y(\\xi,\\eta)=\\eta,\n$$\nwith a fixed distortion parameter $\\alpha\\neq 0$. The standard Gauss–Legendre quadrature used for the four-node bilinear quadrilateral element $Q4$ is the $2\\times 2$ rule on the parent square.\n\nThroughout, assume exact material integration wherever claimed, and use the following base facts: (i) the linear momentum balance in the absence of inertia is $\\nabla\\cdot\\boldsymbol{\\sigma}+\\boldsymbol{b}=\\boldsymbol{0}$ with the Cauchy stress $\\boldsymbol{\\sigma}=\\mathbb{C}:\\boldsymbol{\\varepsilon}$ and small-strain tensor $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}(\\nabla\\boldsymbol{u}+\\nabla\\boldsymbol{u}^{\\top})$; (ii) the divergence of stress involves second derivatives of $\\boldsymbol{u}$, so if $u_x,u_y$ are polynomials of total degree $k$, then $\\nabla\\cdot\\boldsymbol{\\sigma}$ is a polynomial of total degree $k-2$.\n\nTask (a): Using only the foundational structure above, determine the minimal order $p$ in the two-dimensional serendipity family $S_p$ such that, under exact numerical integration, the finite element space on a single element can represent a displacement field that exactly balances the given quadratic body forces in the weak sense, thereby reproducing the exact total potential energy without discretization error. Report this minimal $p$ as a single integer.\n\nTask (b): For the four-node bilinear quadrilateral $Q4$ (which is $S_1$) under the specified bilinear mapping, consider the consistent nodal equivalent load corresponding to node $1$ in the $x$-direction,\n$$\nf_{1x}=\\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,b_x\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $N_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)$ is the shape function of node $1$ and $J(\\xi,\\eta)$ is the Jacobian determinant of the isoparametric mapping. By explicitly identifying the polynomial degree of the integrand in $\\xi$ and $\\eta$, demonstrate whether the standard $2\\times 2$ Gauss–Legendre quadrature integrates $f_{1x}$ exactly for $\\alpha\\neq 0$, and briefly explain the failure mode you find.\n\nAnswer specification: Your final answer must be only the integer value of the minimal $p$ from Task (a). No rounding is needed. No units are needed.", "solution": "The problem is first validated against the specified criteria.\n\n**Step 1: Extract Givens**\n- A single isoparametric quadrilateral element.\n- Parent domain: $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$.\n- Solid properties: homogeneous, linear elastic, plane strain.\n- Governing equations: principle of minimum potential energy, linear momentum balance $\\nabla\\cdot\\boldsymbol{\\sigma}+\\boldsymbol{b}=\\boldsymbol{0}$, with Cauchy stress $\\boldsymbol{\\sigma}=\\mathbb{C}:\\boldsymbol{\\varepsilon}$ and small-strain tensor $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}(\\nabla\\boldsymbol{u}+\\nabla\\boldsymbol{u}^{\\top})$.\n- Body forces: $\\boldsymbol{b}=(b_x,b_y)$ with $b_x=x^2$ and $b_y=y^2$.\n- Isoparametric mapping: $x(\\xi,\\eta)=\\xi+\\alpha\\,\\xi\\,\\eta$ and $y(\\xi,\\eta)=\\eta$, with a distortion parameter $\\alpha\\neq 0$.\n- Quadrature: $2\\times 2$ Gauss–Legendre rule for the four-node bilinear quadrilateral ($Q4$) element.\n- Base fact: If the displacement field $\\boldsymbol{u}=(u_x,u_y)$ has components that are polynomials of total degree $k$, then the components of $\\nabla\\cdot\\boldsymbol{\\sigma}$ are polynomials of total degree $k-2$.\n- Task (a): Find the minimal order $p$ of the serendipity family $S_p$ that can reproduce the exact total potential energy for the given body forces, assuming exact numerical integration.\n- Task (b): For the $Q4$ element, determine if the $2\\times 2$ Gauss quadrature integrates the consistent nodal load $f_{1x}=\\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,b_x(x(\\xi,\\eta),y(\\xi,\\eta))\\,J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$ exactly, where $N_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the theory of the finite element method for linear elasticity. All terms and concepts like isoparametric mapping, serendipity elements, potential energy, and Gauss quadrature are standard in computational mechanics. The problem is well-posed, objective, and internally consistent. The provided data is sufficient to determine the required polynomial order and analyze the numerical integral. The base facts are correct statements within the context of linear elasticity with constant material properties. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is **VALID**. A complete, reasoned solution will be provided.\n\n**Solution**\n\n**Task (a): Minimal Order of Serendipity Element**\n\nThe requirement to reproduce the exact total potential energy without discretization error is equivalent to the condition that the exact solution to the boundary value problem, $\\boldsymbol{u}_{exact}$, must be contained within the finite element approximation space $\\boldsymbol{V}_h$. If $\\boldsymbol{u}_{exact} \\in \\boldsymbol{V}_h$, then minimizing the potential energy functional $\\Pi[\\boldsymbol{u}]$ over $\\boldsymbol{V}_h$ will yield $\\boldsymbol{u}_{exact}$ itself. This is also known as passing the patch test for the specific solution field.\n\nThe governing differential equation in strong form is $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$. For a homogeneous linear elastic material, the stress $\\boldsymbol{\\sigma}$ is a linear function of the second derivatives of the displacement field $\\boldsymbol{u}$. The problem provides the key relationship: if the components of $\\boldsymbol{u}$ are polynomials of total degree $k$ in the physical coordinates $(x,y)$, denoted $\\mathcal{P}_k(x,y)$, then the components of $\\nabla \\cdot \\boldsymbol{\\sigma}$ are polynomials of total degree $k-2$ in $(x,y)$.\n\nThe given body force vector is $\\boldsymbol{b} = (x^2, y^2)$. The components $b_x=x^2$ and $b_y=y^2$ are polynomials of total degree $2$ in the physical coordinates $(x,y)$. To satisfy the equilibrium equation $\\nabla \\cdot \\boldsymbol{\\sigma} = -\\boldsymbol{b}$, the components of $\\nabla \\cdot \\boldsymbol{\\sigma}$ must be able to represent polynomials of total degree $2$. Based on the provided hint, this implies that the exact displacement solution $\\boldsymbol{u}_{exact}$ must consist of polynomials of total degree $k$ where $k-2=2$, which gives $k=4$. Therefore, the finite element space must be able to exactly represent any arbitrary polynomial displacement field of total degree up to $4$, i.e., $\\mathcal{P}_4(x,y) \\subseteq \\boldsymbol{V}_h$.\n\nFor an isoparametric element, the ability to represent a polynomial field in physical coordinates depends on the polynomial basis of its shape functions in the parent coordinates $(\\xi, \\eta)$. It is a standard result in finite element theory that for an element with an arbitrary (non-affine) isoparametric mapping to pass the patch test of order $m$ (i.e., to exactly reproduce any polynomial of degree $m$), its shape function space in the parent domain must contain the complete set of polynomials of degree $m$, $\\mathcal{P}_m(\\xi,\\eta)$.\n\nIn our case, we need to pass the patch test of order $m=4$. Thus, the shape function space of the element, denoted $\\mathcal{S}_p(\\xi, \\eta)$ for the serendipity family of order $p$, must contain $\\mathcal{P}_4(\\xi, \\eta)$.\n\nThe serendipity family of elements of order $p$, $S_p$, is constructed such that its space of shape functions $\\mathcal{S}_p$ contains the complete polynomial space $\\mathcal{P}_p(\\xi, \\eta)$. For $\\mathcal{S}_p$ to contain $\\mathcal{P}_4(\\xi, \\eta)$, it is necessary that $p \\ge 4$. The minimal integer order $p$ that satisfies this condition is $p=4$.\n\nTherefore, the minimal order of the serendipity family that can satisfy the stated requirement is $p=4$.\n\n**Task (b): Exactness of Quadrature for Nodal Load**\n\nWe are asked to analyze the exactness of the numerical integration of the consistent nodal load $f_{1x}$ for a four-node bilinear quadrilateral ($Q4$) element, which corresponds to the serendipity family $S_1$. The quadrature rule is a $2 \\times 2$ Gauss-Legendre scheme.\n\nThe integral for the nodal load is:\n$$\nf_{1x}=\\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,b_x\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nLet's analyze the integrand, which we denote as $I(\\xi, \\eta)$.\nThe components of the integrand are:\n1.  The shape function for node $1$: $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$.\n2.  The body force $b_x = x^2$ expressed in parent coordinates using the mapping $x(\\xi,\\eta)=\\xi(1+\\alpha\\eta)$:\n    $b_x(x(\\xi,\\eta), y(\\xi,\\eta)) = [\\xi(1+\\alpha\\eta)]^2 = \\xi^2(1+\\alpha\\eta)^2$.\n3.  The Jacobian determinant of the mapping. The Jacobian matrix is $\\boldsymbol{J} = \\begin{pmatrix} \\partial x/\\partial\\xi  \\partial y/\\partial\\xi \\\\ \\partial x/\\partial\\eta  \\partial y/\\partial\\eta \\end{pmatrix} = \\begin{pmatrix} 1+\\alpha\\eta  0 \\\\ \\alpha\\xi  1 \\end{pmatrix}$. The determinant is $J(\\xi, \\eta) = \\det(\\boldsymbol{J}) = 1+\\alpha\\eta$.\n\nThe full integrand is the product of these three terms:\n$$\nI(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot b_x \\cdot J = \\left[\\frac{1}{4}(1-\\xi)(1-\\eta)\\right] \\cdot \\left[\\xi^2(1+\\alpha\\eta)^2\\right] \\cdot \\left[1+\\alpha\\eta\\right]\n$$\n$$\nI(\\xi, \\eta) = \\frac{1}{4} ( (1-\\xi)\\xi^2 ) \\cdot ( (1-\\eta)(1+\\alpha\\eta)^3 )\n$$\nTo determine if the $2 \\times 2$ Gauss-Legendre quadrature is exact, we must find the polynomial degree of the integrand with respect to $\\xi$ and $\\eta$ individually.\n-   The polynomial term in $\\xi$ is $(1-\\xi)\\xi^2 = \\xi^2-\\xi^3$. This is a polynomial of degree $3$ in $\\xi$.\n-   The polynomial term in $\\eta$ is $(1-\\eta)(1+\\alpha\\eta)^3$. Since $\\alpha \\neq 0$, expanding this gives:\n    $(1-\\eta)(1 + 3\\alpha\\eta + 3\\alpha^2\\eta^2 + \\alpha^3\\eta^3) = 1 + (3\\alpha-1)\\eta + (3\\alpha^2-3\\alpha)\\eta^2 + (\\alpha^3-3\\alpha^2)\\eta^3 - \\alpha^3\\eta^4$.\n    This is a polynomial of degree $4$ in $\\eta$.\n\nA Gauss-Legendre quadrature rule with $n$ points in a given direction integrates polynomials of degree up to $2n-1$ exactly. The specified $2 \\times 2$ rule uses $n=2$ points in the $\\xi$-direction and $n=2$ points in the $\\eta$-direction.\n-   In the $\\xi$-direction, the rule is exact for polynomials up to degree $2(2)-1 = 3$. The integrand is degree $3$ in $\\xi$, so the integration with respect to $\\xi$ is performed exactly.\n-   In the $\\eta$-direction, the rule is exact for polynomials up to degree $2(2)-1 = 3$. The integrand is degree $4$ in $\\eta$.\n\nSince the degree of the integrand in the $\\eta$-direction ($4$) is greater than the degree the quadrature rule can integrate exactly ($3$), the numerical integration of $f_{1x}$ is not exact.\n\nThe failure mode is the insufficient order of the quadrature rule along the $\\eta$-coordinate axis. This high polynomial degree in $\\eta$ is a direct consequence of the element's geometric distortion, which is parameterized by $\\alpha \\neq 0$. The product of the shape function, the mapped body force, and the Jacobian determinant results in a polynomial that exceeds the integrating power of the standard $2\\times 2$ rule used for undistorted bilinear elements. If the element were undistorted ($\\alpha=0$), the integrand's dependency on $\\eta$ would be $\\frac{1}{4}(1-\\eta)$, which is degree $1$ and would be integrated exactly.", "answer": "$$\n\\boxed{4}\n$$", "id": "3592231"}]}