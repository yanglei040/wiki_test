{"hands_on_practices": [{"introduction": "The eight-node hexahedral (H8) element is a cornerstone of three-dimensional finite element analysis. This practice guides you through building the element from the ground up, starting with its trilinear shape functions used for interpolating field variables. You will then apply these fundamentals to derive a key dynamic property, an entry in the consistent mass matrix, connecting the element's mathematical formulation to its ability to model physical behavior like inertia. [@problem_id:3570555]", "problem": "Consider the eight-node hexahedral (H8) isoparametric finite element used in the Finite Element Method (FEM) for three-dimensional solid mechanics. The reference element occupies the parametric domain $[-1,1] \\times [-1,1] \\times [-1,1]$ with local coordinates $(\\xi,\\eta,\\zeta)$. The physical element is a rectangular brick aligned with the global Cartesian axes, with edge lengths $L_x$, $L_y$, and $L_z$, and vertices located at $(0,0,0)$, $(L_x,0,0)$, $(L_x,L_y,0)$, $(0,L_y,0)$, $(0,0,L_z)$, $(L_x,0,L_z)$, $(L_x,L_y,L_z)$, $(0,L_y,L_z)$. The mass density is uniform and equal to $\\rho$.\n\nStarting from first principles of interpolation and the isoparametric mapping, derive the H8 shape functions on the reference domain by enforcing the nodal interpolation property at the eight corners $(\\xi,\\eta,\\zeta) \\in \\{-1,1\\}^3$. Establish the partition of unity of these shape functions on the reference domain. Using the isoparametric map $x(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, x_i$, $y(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, y_i$, $z(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, z_i$, derive the Jacobian determinant $J(\\xi,\\eta,\\zeta)$ for the rectangular brick described above.\n\nThen, starting from the continuum kinetic energy and its Galerkin discretization, write the expression for the consistent mass matrix entry $M_{11}$ in terms of the shape function associated with the node at $(\\xi,\\eta,\\zeta) = (-1,-1,-1)$. Compute $M_{11}$ exactly for the given rectangular brick and uniform density.\n\nFinally, evaluate $M_{11}$ for $L_x = 1.2\\,\\mathrm{m}$, $L_y = 0.8\\,\\mathrm{m}$, $L_z = 0.5\\,\\mathrm{m}$, and $\\rho = 7{,}850\\,\\mathrm{kg/m^3}$. Round your final result to four significant figures. Express the final mass in kilograms (kg). The final answer must be a single real-valued number.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Element: Eight-node hexahedral (H8) isoparametric finite element.\n- Domain: Three-dimensional ($3$D) solid mechanics.\n- Reference element: Parametric domain $[-1,1] \\times [-1,1] \\times [-1,1]$ with local coordinates $(\\xi,\\eta,\\zeta)$.\n- Physical element: Rectangular brick with edge lengths $L_x$, $L_y$, and $L_z$.\n- Vertices: The $8$ vertices of the brick are located at $(0,0,0)$, $(L_x,0,0)$, $(L_x,L_y,0)$, $(0,L_y,0)$, $(0,0,L_z)$, $(L_x,0,L_z)$, $(L_x,L_y,L_z)$, $(0,L_y,L_z)$.\n- Material property: Uniform mass density $\\rho$.\n- Tasks:\n  1. Derive the H8 shape functions $N_i(\\xi,\\eta,\\zeta)$.\n  2. Establish the partition of unity property.\n  3. Derive the Jacobian determinant $J(\\xi,\\eta,\\zeta)$ for the mapping.\n  4. Write the expression for the consistent mass matrix entry $M_{11}$ for the node at $(\\xi,\\eta,\\zeta) = (-1,-1,-1)$.\n  5. Compute $M_{11}$ analytically.\n  6. Evaluate $M_{11}$ for $L_x = 1.2\\,\\mathrm{m}$, $L_y = 0.8\\,\\mathrm{m}$, $L_z = 0.5\\,\\mathrm{m}$, and $\\rho = 7{,}850\\,\\mathrm{kg/m^3}$, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard application of the Finite Element Method (FEM) for linear elastodynamics, rooted in established principles of continuum mechanics and numerical analysis. All concepts are fundamental to computational solid mechanics.\n- **Well-Posed:** The problem provides all necessary geometrical data, material properties, and definitions to derive a unique and meaningful solution.\n- **Objective:** The problem is stated using precise, standard terminology from the field of FEM, free from ambiguity or subjective claims.\n\nThe problem does not violate any of the invalidity criteria. It is a complete, consistent, and standard problem in computational mechanics.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be developed.\n\n**Derivation of H8 Shape Functions**\nThe H8 element shape functions are trilinear polynomials constructed as products of one-dimensional linear Lagrange polynomials. In the reference domain $\\xi \\in [-1, 1]$, the linear basis functions that are $1$ at one end and $0$ at the other are $L_{-1}(\\xi) = \\frac{1}{2}(1-\\xi)$ and $L_{+1}(\\xi) = \\frac{1}{2}(1+\\xi)$.\n\nThe shape function $N_i(\\xi, \\eta, \\zeta)$ for a node $i$ located at the corner $(\\xi_i, \\eta_i, \\zeta_i)$, where $\\xi_i, \\eta_i, \\zeta_i \\in \\{-1, 1\\}$, is formed by the product of the corresponding linear functions in each coordinate direction. This construction intrinsically satisfies the nodal interpolation property, $N_i(\\xi_j, \\eta_j, \\zeta_j) = \\delta_{ij}$.\n\nThe general form of the shape function for node $i$ is:\n$$N_i(\\xi, \\eta, \\zeta) = \\left( \\frac{1}{2}(1 + \\xi_i\\xi) \\right) \\left( \\frac{1}{2}(1 + \\eta_i\\eta) \\right) \\left( \\frac{1}{2}(1 + \\zeta_i\\zeta) \\right) = \\frac{1}{8}(1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta)$$\n\n**Partition of Unity Property**\nThe partition of unity avers that the sum of all shape functions equals $1$ everywhere within the element. We must show that $\\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = 1$.\n$$ \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = \\frac{1}{8} \\sum_{i=1}^{8} (1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta) $$\nThe summation is performed over all $8$ nodal locations, meaning over all combinations of $(\\xi_i, \\eta_i, \\zeta_i) \\in \\{-1,1\\}^3$.\nLet's expand the product term:\n$$ (1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta) = 1 + \\xi_i\\xi + \\eta_i\\eta + \\zeta_i\\zeta + \\xi_i\\eta_i\\xi\\eta + \\xi_i\\zeta_i\\xi\\zeta + \\eta_i\\zeta_i\\eta\\zeta + \\xi_i\\eta_i\\zeta_i\\xi\\eta\\zeta $$\nWhen summing over the $8$ nodes, any term containing at least one of $\\xi_i, \\eta_i,$ or $\\zeta_i$ will sum to zero. For instance, consider the term $\\xi_i\\xi$. The sum over the $8$ nodes is $\\xi \\sum_{i=1}^8 \\xi_i = \\xi(4 \\times 1 + 4 \\times (-1)) = 0$. The same logic applies to all other mixed terms (e.g., $\\sum \\xi_i\\eta_i = 2 \\times (1 \\cdot 1) + 2 \\times (1 \\cdot -1) + 2 \\times (-1 \\cdot 1) + 2 \\times (-1 \\cdot -1) = 0$). Only the constant term '$1$' survives.\n$$ \\sum_{i=1}^{8} (1 + \\xi_i\\xi + \\dots) = \\sum_{i=1}^{8} 1 = 8 $$\nTherefore,\n$$ \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = \\frac{1}{8} \\times 8 = 1 $$\nThis confirms the partition of unity property.\n\n**Isoparametric Mapping and Jacobian Determinant**\nThe global coordinates $(x, y, z)$ are mapped from the local coordinates $(\\xi, \\eta, \\zeta)$ using the shape functions:\n$x(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i x_i$, $y(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i y_i$, $z(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i z_i$.\nFor the given rectangular brick, the mapping simplifies. Using the partition of unity and grouping terms, we can show:\n$x(\\xi, \\eta, \\zeta) = \\frac{L_x}{2}(1+\\xi)$\n$y(\\xi, \\eta, \\zeta) = \\frac{L_y}{2}(1+\\eta)$\n$z(\\xi, \\eta, \\zeta) = \\frac{L_z}{2}(1+\\zeta)$\nThe Jacobian matrix $\\mathbf{J}$ of the transformation is given by:\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\eta} \\\\ \\frac{\\partial x}{\\partial \\zeta} & \\frac{\\partial y}{\\partial \\zeta} & \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix}^T = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} $$\nCalculating the partial derivatives:\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{L_x}{2}$, $\\frac{\\partial x}{\\partial \\eta} = 0$, $\\frac{\\partial x}{\\partial \\zeta} = 0$\n$\\frac{\\partial y}{\\partial \\xi} = 0$, $\\frac{\\partial y}{\\partial \\eta} = \\frac{L_y}{2}$, $\\frac{\\partial y}{\\partial \\zeta} = 0$\n$\\frac{\\partial z}{\\partial \\xi} = 0$, $\\frac{\\partial z}{\\partial \\eta} = 0$, $\\frac{\\partial z}{\\partial \\zeta} = \\frac{L_z}{2}$\nThe Jacobian matrix is a constant diagonal matrix:\n$$ \\mathbf{J} = \\begin{pmatrix} L_x/2 & 0 & 0 \\\\ 0 & L_y/2 & 0 \\\\ 0 & 0 & L_z/2 \\end{pmatrix} $$\nThe Jacobian determinant $J$ is the determinant of this matrix:\n$$ J = \\det(\\mathbf{J}) = \\left(\\frac{L_x}{2}\\right) \\left(\\frac{L_y}{2}\\right) \\left(\\frac{L_z}{2}\\right) = \\frac{L_x L_y L_z}{8} $$\n\n**Consistent Mass Matrix Entry $M_{11}$**\nThe consistent mass matrix relates nodal accelerations to nodal forces. Its entries are given by $M_{ab} = \\int_{V} \\rho N_a N_b dV$, where $a$ and $b$ refer to global degrees of freedom. The full mass matrix is composed of $3 \\times 3$ blocks, $\\mathbf{M}_{ij}$, for each pair of nodes $i$ and $j$. For an isotropic material property $\\rho$, this block is $\\mathbf{M}_{ij} = m_{ij} \\mathbf{I}$, where $m_{ij} = \\int_V \\rho N_i N_j dV$ and $\\mathbf{I}$ is the $3 \\times 3$ identity matrix.\nThe entry $M_{11}$ corresponds to the first degree of freedom of the first node. Let node $1$ be at $(\\xi_1, \\eta_1, \\zeta_1) = (-1, -1, -1)$. The mass matrix entry for its x-displacement is the top-left element of the $\\mathbf{M}_{11}$ block, which is $m_{11}$.\n$$ M_{11} = m_{11} = \\int_{V} \\rho N_1^2 dV $$\nTo evaluate this integral, we transform it to the reference element domain: $dV = J\\,d\\xi d\\eta d\\zeta$.\n$$ M_{11} = \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\rho [N_1(\\xi, \\eta, \\zeta)]^2 J \\, d\\xi d\\eta d\\zeta $$\nThe shape function for node $1$ at $(\\xi_1, \\eta_1, \\zeta_1) = (-1, -1, -1)$ is:\n$$ N_1(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1 - \\xi)(1 - \\eta)(1 - \\zeta) $$\nSubstituting $N_1$ and $J$ into the integral:\n$$ M_{11} = \\rho \\left( \\frac{L_x L_y L_z}{8} \\right) \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left[ \\frac{1}{8}(1-\\xi)(1-\\eta)(1-\\zeta) \\right]^2 d\\xi d\\eta d\\zeta $$\n$$ M_{11} = \\rho \\frac{L_x L_y L_z}{8 \\cdot 64} \\int_{-1}^{1} (1-\\xi)^2 d\\xi \\int_{-1}^{1} (1-\\eta)^2 d\\eta \\int_{-1}^{1} (1-\\zeta)^2 d\\zeta $$\nLet's compute the one-dimensional integral:\n$$ \\int_{-1}^{1} (1-u)^2 du = \\int_{-1}^{1} (1 - 2u + u^2) du = \\left[ u - u^2 + \\frac{u^3}{3} \\right]_{-1}^{1} $$\n$$ = \\left(1 - 1^2 + \\frac{1^3}{3}\\right) - \\left(-1 - (-1)^2 + \\frac{(-1)^3}{3}\\right) = \\left(\\frac{1}{3}\\right) - \\left(-1 - 1 - \\frac{1}{3}\\right) = \\frac{1}{3} - \\left(-\\frac{7}{3}\\right) = \\frac{8}{3} $$\nThe triple integral is the product of three such integrals:\n$$ \\left(\\frac{8}{3}\\right) \\times \\left(\\frac{8}{3}\\right) \\times \\left(\\frac{8}{3}\\right) = \\frac{512}{27} $$\nSubstituting this result back into the expression for $M_{11}$:\n$$ M_{11} = \\rho \\frac{L_x L_y L_z}{512} \\left( \\frac{512}{27} \\right) = \\frac{\\rho L_x L_y L_z}{27} $$\nThis is the exact analytical expression for the matrix entry $M_{11}$.\n\n**Numerical Evaluation**\nThe given values are:\n$L_x = 1.2\\,\\mathrm{m}$\n$L_y = 0.8\\,\\mathrm{m}$\n$L_z = 0.5\\,\\mathrm{m}$\n$\\rho = 7850\\,\\mathrm{kg/m^3}$\n\nFirst, calculate the volume $V$ of the brick:\n$$ V = L_x L_y L_z = 1.2 \\times 0.8 \\times 0.5 = 0.48\\,\\mathrm{m^3} $$\nThen, calculate the total mass $M_{\\text{total}}$ of the element:\n$$ M_{\\text{total}} = \\rho V = 7850\\,\\mathrm{kg/m^3} \\times 0.48\\,\\mathrm{m^3} = 3768\\,\\mathrm{kg} $$\nNow, evaluate $M_{11}$:\n$$ M_{11} = \\frac{\\rho V}{27} = \\frac{M_{\\text{total}}}{27} = \\frac{3768}{27} \\approx 139.555... \\,\\mathrm{kg} $$\nRounding the result to four significant figures gives:\n$$ M_{11} = 139.6\\,\\mathrm{kg} $$\nThe final answer is the numerical value of the mass in kilograms.", "answer": "$$\\boxed{139.6}$$", "id": "3570555"}, {"introduction": "To combat issues like shear locking, computational analysts often employ reduced integration schemes, but this technique introduces a new challenge: numerical instability. This exercise delves into the concept of hourglassing—non-physical, zero-energy deformation modes that arise in under-integrated elements. By analyzing the rank of the strain-displacement matrix ($B$-matrix) at a single integration point, you will determine the precise number of these spurious modes for an H8 element. [@problem_id:3570550]", "problem": "Consider an isoparametric $8$-node hexahedral (H8) finite element in three-dimensional linear elasticity, formulated within the Finite Element Method (FEM). The parent domain is the cube $[-1,1] \\times [-1,1] \\times [-1,1]$ with natural coordinates $(\\xi,\\eta,\\zeta)$ and standard trilinear shape functions. The element is mapped to a physical parallelepiped by an affine, invertible transformation with constant Jacobian matrix $\\mathbf{J}$ and constant determinant $\\det \\mathbf{J} \\neq 0$. The material is homogeneous and linearly elastic with a positive-definite constitutive tensor $\\mathbf{D}$.\n\nStarting from the principle of virtual work and the definition of the element stiffness matrix as the domain integral of the strain-displacement operator, consider the reduced integration scheme that uses a single Gauss point at the centroid $(\\xi,\\eta,\\zeta)=(0,0,0)$ with the corresponding three-dimensional Gauss weight. Under this reduced integration, the discrete element stiffness becomes a single-point approximation that depends only on the strain-displacement matrix evaluated at the centroid.\n\nDetermine the dimension (as a single integer) of the non-rigid zero-energy subspace (the so-called hourglass modes) of the element’s discrete stiffness under this reduced integration. That is, compute the number of linearly independent nodal displacement vectors that produce zero internal strain energy while excluding the rigid-body modes. Provide your final answer as a single integer with no units. No rounding is required.", "solution": "The user wants to determine the dimension of the non-rigid zero-energy subspace (hourglass modes) for an 8-node hexahedral element under single-point reduced integration.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Element: Isoparametric $8$-node hexahedral (H8).\n- Physics: $3$D linear elasticity.\n- Parent Domain: Cube $[-1,1] \\times [-1,1] \\times [-1,1]$ with coordinates $(\\xi,\\eta,\\zeta)$.\n- Shape Functions: Standard trilinear.\n- Mapping: Affine, invertible transformation to a physical parallelepiped.\n- Jacobian: Constant matrix $\\mathbf{J}$, with $\\det \\mathbf{J} \\neq 0$.\n- Material: Homogeneous, linearly elastic, positive-definite constitutive tensor $\\mathbf{D}$.\n- Integration Scheme: Reduced integration using a single Gauss point at the centroid $(\\xi,\\eta,\\zeta)=(0,0,0)$.\n- Objective: Determine the dimension of the non-rigid zero-energy subspace (hourglass modes).\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard topic in the theory of the Finite Element Method (FEM), specifically concerning the numerical stability of under-integrated solid elements. The concepts of isoparametric mapping, reduced integration, and hourglassing are fundamental in computational solid mechanics. All premises are factually and scientifically sound.\n- **Well-Posed:** The problem is clearly defined. It asks for a specific integer (the dimension of a vector subspace) under a precise set of assumptions. The conditions provided are sufficient to arrive at a unique, meaningful answer.\n- **Objective:** The language is formal, precise, and free of any subjective or ambiguous terminology.\n\nThe problem is valid as it is scientifically grounded, well-posed, and objective. It is a standard, formalizable problem in computational mechanics.\n\n### Solution\n\nThe element stiffness matrix $\\mathbf{K}^e$ is derived from the principle of virtual work and is given by the integral over the element's physical volume $V^e$:\n$$ \\mathbf{K}^e = \\int_{V^e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dV $$\nwhere $\\mathbf{B}$ is the strain-displacement matrix, and $\\mathbf{D}$ is the constitutive material tensor.\n\nUsing an isoparametric formulation, the integral is transformed to the parent domain, a cube defined by $\\xi, \\eta, \\zeta \\in [-1, 1]$:\n$$ \\mathbf{K}^e = \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}(\\xi, \\eta, \\zeta)^T \\mathbf{D} \\mathbf{B}(\\xi, \\eta, \\zeta) \\det(\\mathbf{J}) \\, d\\xi d\\eta d\\zeta $$\nThe problem specifies a reduced integration scheme using a single Gauss point at the centroid of the parent element, i.e., at $(\\xi, \\eta, \\zeta) = (0, 0, 0)$. The corresponding Gauss weight is $w = 2 \\times 2 \\times 2 = 8$. The stiffness matrix is thus approximated as:\n$$ \\mathbf{K}^e \\approx w \\det(\\mathbf{J}) \\mathbf{B}(0,0,0)^T \\mathbf{D} \\mathbf{B}(0,0,0) $$\nLet $\\mathbf{B}_0 = \\mathbf{B}(0,0,0)$. The mapping is affine, so the Jacobian determinant $\\det(\\mathbf{J})$ is a non-zero constant. The material is homogeneous, so $\\mathbf{D}$ is also constant.\n\nA nodal displacement vector $\\mathbf{u}^e$ corresponds to a zero-energy mode if it produces zero strain energy, i.e., $(\\mathbf{u}^e)^T \\mathbf{K}^e \\mathbf{u}^e = 0$. Given the form of the approximated $\\mathbf{K}^e$:\n$$ (\\mathbf{u}^e)^T \\left( w \\det(\\mathbf{J}) \\mathbf{B}_0^T \\mathbf{D} \\mathbf{B}_0 \\right) \\mathbf{u}^e = 0 $$\nSince $w > 0$, $\\det(\\mathbf{J}) \\neq 0$, and the constitutive tensor $\\mathbf{D}$ is positive-definite, this condition is equivalent to:\n$$ (\\mathbf{B}_0 \\mathbf{u}^e)^T \\mathbf{D} (\\mathbf{B}_0 \\mathbf{u}^e) = 0 \\implies \\mathbf{B}_0 \\mathbf{u}^e = \\mathbf{0} $$\nTherefore, the space of zero-energy modes is the null space (kernel) of the matrix $\\mathbf{B}_0$. We need to find the dimension of this null space, $\\dim(\\ker(\\mathbf{B}_0))$.\n\nThe H8 element has $8$ nodes. In $3$D elasticity, each node has $3$ degrees of freedom (displacements). The total number of degrees of freedom for the element is $N_{dof} = 8 \\times 3 = 24$. The nodal displacement vector $\\mathbf{u}^e$ is in $\\mathbb{R}^{24}$.\nThe strain vector in $3$D has $6$ components: $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\epsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx}]^T$. The strain-displacement matrix $\\mathbf{B}_0$ maps the $24$ nodal displacements to these $6$ strain components. Thus, $\\mathbf{B}_0$ is a $6 \\times 24$ matrix.\n\nBy the rank-nullity theorem, the dimension of the null space of $\\mathbf{B}_0$ is:\n$$ \\dim(\\ker(\\mathbf{B}_0)) = N_{dof} - \\text{rank}(\\mathbf{B}_0) = 24 - \\text{rank}(\\mathbf{B}_0) $$\nTo find the dimension of the zero-energy subspace, we must determine the rank of $\\mathbf{B}_0$. The rank is the number of linearly independent rows (or columns) of the matrix.\n\nThe matrix $\\mathbf{B}_i$ for node $i$ is:\n$$ \\mathbf{B}_i = \\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} & 0 \\\\\n0 & 0 & \\frac{\\partial N_i}{\\partial z} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial z} & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial z} & 0 & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix} $$\nwhere the derivatives are evaluated at the centroid. The full matrix is $\\mathbf{B}_0 = [\\mathbf{B}_1, \\mathbf{B}_2, \\ldots, \\mathbf{B}_8]_0$.\nThe derivatives of the trilinear shape functions $N_i = \\frac{1}{8}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(1+\\zeta_i\\zeta)$ at the centroid $(\\xi,\\eta,\\zeta)=(0,0,0)$ are:\n$$ \\frac{\\partial N_i}{\\partial \\xi}\\bigg|_0 = \\frac{1}{8}\\xi_i, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_0 = \\frac{1}{8}\\eta_i, \\quad \\frac{\\partial N_i}{\\partial \\zeta}\\bigg|_0 = \\frac{1}{8}\\zeta_i $$\nwhere $(\\xi_i, \\eta_i, \\zeta_i)$ are the coordinates of node $i$ (values are $\\pm 1$).\nThe spatial derivatives are related to these via the inverse Jacobian $\\mathbf{J}^{-1}$:\n$$ \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{Bmatrix}_0 = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{Bmatrix}_0 = \\frac{1}{8} \\mathbf{J}^{-1} \\begin{Bmatrix} \\xi_i \\\\ \\eta_i \\\\ \\zeta_i \\end{Bmatrix} $$\nLet $\\mathbf{d}_{x}$, $\\mathbf{d}_{y}$, $\\mathbf{d}_{z}$ be vectors in $\\mathbb{R}^8$ whose components are the spatial derivatives for each of the $8$ nodes, evaluated at the centroid. For example, $(\\mathbf{d}_{x})_i = \\frac{\\partial N_i}{\\partial x}|_0$. These three vectors are linear combinations of the nodal coordinate vectors $\\boldsymbol{\\xi_v} = (\\xi_1, \\dots, \\xi_8)^T$, $\\boldsymbol{\\eta_v} = (\\eta_1, \\dots, \\eta_8)^T$, and $\\boldsymbol{\\zeta_v} = (\\zeta_1, \\dots, \\zeta_8)^T$, using the rows of $\\frac{1}{8}\\mathbf{J}^{-1}$ as coefficients. The vectors $\\boldsymbol{\\xi_v}, \\boldsymbol{\\eta_v}, \\boldsymbol{\\zeta_v}$ are linearly independent. Since $\\mathbf{J}^{-1}$ is invertible, the vectors $\\mathbf{d}_{x}, \\mathbf{d}_{y}, \\mathbf{d}_{z}$ are also linearly independent.\n\nThe $6$ rows of the $6 \\times 24$ matrix $\\mathbf{B}_0$ can be written using these vectors:\n- Row 1: $[\\mathbf{d}_{x}^T, \\mathbf{0}^T, \\mathbf{0}^T]$\n- Row 2: $[\\mathbf{0}^T, \\mathbf{d}_{y}^T, \\mathbf{0}^T]$\n- Row 3: $[\\mathbf{0}^T, \\mathbf{0}^T, \\mathbf{d}_{z}^T]$\n- Row 4: $[\\mathbf{d}_{y}^T, \\mathbf{d}_{x}^T, \\mathbf{0}^T]$\n- Row 5: $[\\mathbf{0}^T, \\mathbf{d}_{z}^T, \\mathbf{d}_{y}^T]$\n- Row 6: $[\\mathbf{d}_{z}^T, \\mathbf{0}^T, \\mathbf{d}_{x}^T]$\n\nWe check for linear independence of these rows. Let a linear combination of the rows equal the zero vector: $\\sum_{k=1}^{6} c_k \\text{Row}_k = \\mathbf{0}$. Examining the first block of $8$ components yields $c_1 \\mathbf{d}_{x} + c_4 \\mathbf{d}_{y} + c_6 \\mathbf{d}_{z} = \\mathbf{0}$. Since $\\mathbf{d}_{x}, \\mathbf{d}_{y}, \\mathbf{d}_{z}$ are linearly independent, this implies $c_1 = c_4 = c_6 = 0$. Substituting these into the equation for the second block of $8$ components gives $c_2 \\mathbf{d}_{y} + c_5 \\mathbf{d}_{z} = \\mathbf{0}$, which implies $c_2 = c_5 = 0$. Finally, the third block gives $c_3 \\mathbf{d}_{z} = \\mathbf{0}$, which implies $c_3=0$. All coefficients $c_k$ must be zero, so the $6$ rows are linearly independent.\n\nThus, the rank of $\\mathbf{B}_0$ is $6$.\nThe dimension of the total zero-energy subspace is:\n$$ \\dim(\\ker(\\mathbf{B}_0)) = 24 - \\text{rank}(\\mathbf{B}_0) = 24 - 6 = 18 $$\nThis $18$-dimensional space contains all nodal displacement vectors that produce zero strain at the element's centroid. This space includes the rigid-body modes, which produce zero strain everywhere. For a $3$D body, there are $6$ linearly independent rigid-body modes: $3$ translations and $3$ rotations.\n\nThe problem asks for the dimension of the *non-rigid* zero-energy subspace, which are the hourglass modes. This is found by subtracting the dimension of the rigid-body mode subspace from the dimension of the total zero-energy subspace.\n$$ \\text{Dimension of hourglass modes} = \\dim(\\ker(\\mathbf{B}_0)) - \\text{Dimension of rigid-body modes} $$\n$$ \\text{Dimension of hourglass modes} = 18 - 6 = 12 $$\nThere are $12$ hourglass modes for an $8$-node hexahedral element with single-point reduced integration.", "answer": "$$\\boxed{12}$$", "id": "3570550"}, {"introduction": "The theoretical existence of hourglass modes can be made more tangible by examining a specific deformation pattern. This practice presents a nodal displacement pattern corresponding to an hourglass mode and challenges you to prove that it generates zero strain within the element. This hands-on calculation demonstrates exactly why such modes are 'invisible' to the element's stiffness under reduced integration, providing a deeper intuition for the mechanisms of numerical instability. [@problem_id:3570567]", "problem": "Consider a small-strain, linear elastic three-dimensional body discretized by a single eight-node trilinear hexahedral element (H8). Let the element be an axis-aligned rectangular brick with physical edge lengths $a$, $b$, and $c$ along the $x$, $y$, and $z$ directions, respectively. The isoparametric parent coordinates are $(\\xi,\\eta,\\zeta)\\in[-1,1]^{3}$ with the standard trilinear shape functions $N_{i}(\\xi,\\eta,\\zeta)$, where $i=1,\\dots,8$ and node $i$ is located at $(\\xi_{i},\\eta_{i},\\zeta_{i})\\in\\{\\pm 1\\}^{3}$. The strain-displacement matrix $B(\\xi,\\eta,\\zeta)$ collects the derivatives of the shape functions mapped to physical coordinates via the Jacobian of the isoparametric mapping. The constitutive law is the linear elastic relation $\\sigma = D\\,\\varepsilon$ with $\\varepsilon$ the small-strain vector and $D$ the elastic stiffness. In a selective integration scheme for nearly incompressible response, decompose $D$ into a volumetric part and a deviatoric part, and integrate the volumetric contribution using a single Gauss point at $(\\xi,\\eta,\\zeta)=(0,0,0)$, while integrating the deviatoric contribution using four Gauss points at $(\\xi,\\eta,\\zeta)=(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3},0)$ on the mid-plane $\\zeta=0$.\n\nYou will perform two patch tests in thought: first, a linear displacement patch that produces constant normal strains, and second, a constant shear patch in the $xy$-plane. The linear displacement patch field is $u_{x}=\\alpha x$, $u_{y}=\\beta y$, $u_{z}=\\gamma z$ with constants $\\alpha$, $\\beta$, and $\\gamma$, for which the element reproduces constant normal strains at the chosen Gauss points. For the constant shear patch, take the exact field $u_{x}=\\frac{\\gamma_{0}}{2}\\,y$, $u_{y}=\\frac{\\gamma_{0}}{2}\\,x$, $u_{z}=0$, which yields $\\gamma_{xy}=\\gamma_{0}$ in the continuum. To diagnose completeness of the discrete formulation under the stated selective integration, superimpose on the constant shear patch an hourglass-type nodal pattern that is invisible to the $B$ matrix at the selected deviatoric Gauss points. Define the nodal perturbation displacements by\n$$\nu_{x,i}^{h}=\\delta\\,a\\,\\eta_{i},\\quad u_{y,i}^{h}=-\\delta\\,b\\,\\xi_{i},\\quad u_{z,i}^{h}=0,\\quad i=1,\\dots,8,\n$$\nwhere $\\delta$ is a small, dimensionless amplitude and $a$ and $b$ are the element edge lengths. Assume a square in-plane element, $a=b$, and evaluate the resulting discrete shear strain $\\gamma_{xy}$ at any of the deviatoric Gauss points $(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3},0)$ using the $B$ matrix acting on the hourglass perturbation alone (i.e., compute the strain induced solely by $\\{u^{h}_{x,i},u^{h}_{y,i}\\}$). Express your final answer for the computed $\\gamma_{xy}$ as a dimensionless number. No rounding is required; provide the exact value.", "solution": "The objective is to compute the discrete shear strain component $\\gamma_{xy}$ resulting from a specific nodal displacement pattern applied to an eight-node trilinear hexahedral element (H8). The calculation will be performed at the specified deviatoric Gauss points.\n\nFirst, we establish the relationship between the physical coordinates $(x, y, z)$ and the isoparametric parent coordinates $(\\xi, \\eta, \\zeta)$. The problem states the element is an axis-aligned rectangular brick with side lengths $a$, $b$, and $c$. Assuming the element is centered at the origin, the physical coordinates of the nodes are given by $(x_i, y_i, z_i) = (\\frac{a}{2}\\xi_i, \\frac{b}{2}\\eta_i, \\frac{c}{2}\\zeta_i)$, where $(\\xi_i, \\eta_i, \\zeta_i)$ are the parent coordinates of node $i$, which take values in $\\{\\pm 1\\}$. The isoparametric mapping is given by:\n$$x(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) x_i$$\n$$y(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) y_i$$\n$$z(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) z_i$$\nFor the specified geometry and using the known identity $\\sum_i N_i(\\xi, \\eta, \\zeta) \\mathbf{p}_i = \\mathbf{p}$ for any linear function $\\mathbf{p}$ of the parent coordinates, the mapping simplifies to a linear relationship:\n$$x = \\frac{a}{2}\\xi, \\quad y = \\frac{b}{2}\\eta, \\quad z = \\frac{c}{2}\\zeta$$\nThe Jacobian matrix of this transformation is constant and diagonal:\n$$J = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\eta} \\\\ \\frac{\\partial x}{\\partial \\zeta} & \\frac{\\partial y}{\\partial \\zeta} & \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix}^T = \\begin{pmatrix} a/2 & 0 & 0 \\\\ 0 & b/2 & 0 \\\\ 0 & 0 & c/2 \\end{pmatrix}$$\nThe inverse Jacobian, required for transforming derivatives, is:\n$$J^{-1} = \\begin{pmatrix} 2/a & 0 & 0 \\\\ 0 & 2/b & 0 \\\\ 0 & 0 & 2/c \\end{pmatrix}$$\nThe chain rule relates derivatives with respect to physical coordinates to those with respect to parent coordinates:\n$$ \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\\\ \\frac{\\partial}{\\partial z} \\end{Bmatrix} = J^{-1} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\\\ \\frac{\\partial}{\\partial \\zeta} \\end{Bmatrix} $$\nSpecifically, $\\frac{\\partial}{\\partial x} = \\frac{2}{a}\\frac{\\partial}{\\partial \\xi}$ and $\\frac{\\partial}{\\partial y} = \\frac{2}{b}\\frac{\\partial}{\\partial \\eta}$.\n\nThe shear strain component $\\gamma_{xy}$ is defined as:\n$$ \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} $$\nUsing the chain rule, we can express this in terms of parent coordinate derivatives:\n$$ \\gamma_{xy} = \\frac{2}{b}\\frac{\\partial u_x}{\\partial \\eta} + \\frac{2}{a}\\frac{\\partial u_y}{\\partial \\xi} $$\nThe problem defines a nodal displacement perturbation, denoted by the superscript $h$:\n$$ u_{x,i}^{h}=\\delta\\,a\\,\\eta_{i}, \\quad u_{y,i}^{h}=-\\delta\\,b\\,\\xi_{i}, \\quad u_{z,i}^{h}=0 $$\nThe continuous displacement field within the element is obtained by interpolating these nodal values using the shape functions $N_i$:\n$$ u_{x}^{h}(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) u_{x,i}^h = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) (\\delta a \\eta_i) = \\delta a \\sum_{i=1}^{8} N_i \\eta_i $$\n$$ u_{y}^{h}(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) u_{y,i}^h = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) (-\\delta b \\xi_i) = -\\delta b \\sum_{i=1}^{8} N_i \\xi_i $$\nFor the trilinear H8 element, the following identities hold: $\\sum_{i=1}^{8} N_i \\xi_i = \\xi$ and $\\sum_{i=1}^{8} N_i \\eta_i = \\eta$. Therefore, the displacement fields are:\n$$ u_{x}^{h}(\\xi, \\eta, \\zeta) = \\delta a \\eta $$\n$$ u_{y}^{h}(\\xi, \\eta, \\zeta) = -\\delta b \\xi $$\nThese fields are linear in the parent coordinates. We now compute their partial derivatives:\n$$ \\frac{\\partial u_{x}^{h}}{\\partial \\eta} = \\delta a, \\quad \\frac{\\partial u_{y}^{h}}{\\partial \\xi} = -\\delta b $$\nAll other partial derivatives with respect to $(\\xi, \\eta, \\zeta)$ are zero. Now, we substitute these derivatives into the expression for the shear strain $\\gamma_{xy}$:\n$$ \\gamma_{xy} = \\frac{2}{b}(\\delta a) + \\frac{2}{a}(-\\delta b) = 2\\delta\\frac{a}{b} - 2\\delta\\frac{b}{a} = 2\\delta\\left(\\frac{a}{b} - \\frac{b}{a}\\right) $$\nThis expression for the strain is constant throughout the element, so its value is independent of the evaluation point $(\\xi, \\eta, \\zeta)$. This means the strain will be the same at all Gauss points.\n\nFinally, the problem specifies a square in-plane element, which means $a=b$. Substituting this condition into the expression for $\\gamma_{xy}$:\n$$ \\gamma_{xy} = 2\\delta\\left(\\frac{a}{a} - \\frac{a}{a}\\right) = 2\\delta(1 - 1) = 0 $$\nThe resulting shear strain is exactly zero. This is because for $a=b$, the prescribed nodal displacement pattern corresponds to a rigid body rotation of the element about the $z$-axis. A rigid body motion must, by definition, produce zero strain. The calculation confirms that the finite element formulation correctly reproduces this fundamental principle. The result is a dimensionless number as required.", "answer": "$$\n\\boxed{0}\n$$", "id": "3570567"}]}