{"hands_on_practices": [{"introduction": "This first exercise provides a concrete, step-by-step guide through the mechanics of static condensation. By working with a simple one-dimensional bar system [@problem_id:2562927], you will manually perform the partitioning, condensation, and assembly of substructures. This practice is crucial for solidifying your understanding of the core algorithm and visualizing how internal degrees of freedom are eliminated to create an efficient interface-only model.", "problem": "A straight prismatic one-dimensional bar aligned with the global $x$-axis is decomposed into two substructures, $\\mathcal{A}$ and $\\mathcal{B}$, connected at a single interface node $I$ (node $2$). Substructure $\\mathcal{A}$ consists of two linear two-node axial elements connecting nodes $0$–$1$ and $1$–$2$ with uniform axial rigidity $E A = 2.0 \\times 10^{5}\\,\\mathrm{N}$ and element lengths $L_{01} = 1\\,\\mathrm{m}$ and $L_{12} = 1\\,\\mathrm{m}$. Node $0$ is fixed with $u_{0} = 0$. A uniform axial body force density $b_{12} = 1000\\,\\mathrm{N/m}$ acts along element $(1$–$2)$ in the positive $x$-direction; element $(0$–$1)$ is load-free. Substructure $\\mathcal{B}$ consists of two linear two-node axial elements connecting nodes $2$–$3$ and $3$–$4$ with axial rigidities $E A = 1.0 \\times 10^{4}\\,\\mathrm{N}$, and lengths $L_{23} = 2\\,\\mathrm{m}$ and $L_{34} = 1\\,\\mathrm{m}$, respectively. A uniform axial body force density $b_{23} = 500\\,\\mathrm{N/m}$ acts along element $(2$–$3)$ in the positive $x$-direction. At node $4$ there is an external nodal traction $T_{4} = 2000\\,\\mathrm{N}$ applied in the positive $x$-direction. No other loads act.\n\nStarting from the principle of virtual work and the definition of the linear shape functions for a two-node axial element, derive the consistent element load vectors for the distributed body forces, assemble the substructure equilibrium equations, and perform static condensation (substructuring) to eliminate all internal degrees of freedom within each substructure so that only the interface displacement $u_{2}$ remains. Then, assemble the reduced global interface equation and solve for the interface displacement $u_{2}$.\n\nExpress the final value of $u_{2}$ in millimeters and round your answer to four significant figures.", "solution": "The problem is scientifically grounded, well-posed, and self-contained. All necessary data, boundary conditions, and material properties are provided. The request to use the principle of virtual work, consistent loads, and static condensation is a standard and valid procedure in the finite element method. Therefore, the problem is valid and a solution will be provided.\n\nThe analysis begins with the fundamental principles for a linear two-node axial element. The axial displacement field $u(x)$ within an element of length $L_e$ is interpolated from the nodal displacements $u_1$ and $u_2$ using linear shape functions $N_1(x)$ and $N_2(x)$:\n$$u(x) = N_1(x) u_1 + N_2(x) u_2 = \\mathbf{N}(x) \\mathbf{d}^{(e)}$$\nIn a local coordinate system where the element spans from $x=0$ to $x=L_e$, the shape functions are:\n$$N_1(x) = 1 - \\frac{x}{L_e} \\quad , \\quad N_2(x) = \\frac{x}{L_e}$$\nThe element stiffness matrix $\\mathbf{k}^{(e)}$ is derived from the strain energy and is given by:\n$$\\mathbf{k}^{(e)} = \\frac{EA}{L_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n\nThe consistent element load vector $\\mathbf{f}^{(e)}$ for a distributed body force $b(x)$ (force per unit length) is derived from the principle of virtual work. The virtual work done by the body force is:\n$$\\delta W_{\\text{ext}} = \\int_{0}^{L_e} \\delta u(x) b(x) dx$$\nSubstituting the interpolated virtual displacement $\\delta u(x) = \\mathbf{N}(x) \\delta\\mathbf{d}^{(e)}$:\n$$\\delta W_{\\text{ext}} = \\int_{0}^{L_e} (\\mathbf{N}(x) \\delta\\mathbf{d}^{(e)})^T b(x) dx = (\\delta\\mathbf{d}^{(e)})^T \\int_{0}^{L_e} \\mathbf{N}(x)^T b(x) dx$$\nSince $\\delta W_{\\text{ext}} = (\\delta\\mathbf{d}^{(e)})^T \\mathbf{f}^{(e)}$, the consistent load vector is:\n$$\\mathbf{f}^{(e)} = \\int_{0}^{L_e} \\mathbf{N}(x)^T b(x) dx$$\nFor a uniform body force $b$, the integral becomes:\n$$\\mathbf{f}^{(e)} = b \\int_{0}^{L_e} \\begin{pmatrix} 1 - x/L_e \\\\ x/L_e \\end{pmatrix} dx = b \\left[ \\begin{matrix} x - \\frac{x^2}{2L_e} \\\\ \\frac{x^2}{2L_e} \\end{matrix} \\right]_0^{L_e} = b \\begin{pmatrix} L_e - \\frac{L_e^2}{2L_e} \\\\ \\frac{L_e^2}{2L_e} \\end{pmatrix} = \\frac{bL_e}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\nThis means the total load $bL_e$ is distributed equally to the two nodes.\n\nNow, we analyze each substructure.\n\n**Substructure $\\mathcal{A}$ (Nodes $0, 1, 2$)**\nThe substructure consists of elements $(0-1)$ and $(1-2)$.\nElement $(0-1)$: $L_{01} = 1\\,\\mathrm{m}$, $EA = 2.0 \\times 10^5\\,\\mathrm{N}$. No body force.\n$$\\mathbf{k}^{(0-1)} = \\frac{2.0 \\times 10^5}{1} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}_{u_0, u_1} \\quad ; \\quad \\mathbf{f}^{(0-1)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\nElement $(1-2)$: $L_{12} = 1\\,\\mathrm{m}$, $EA = 2.0 \\times 10^5\\,\\mathrm{N}$, $b_{12} = 1000\\,\\mathrm{N/m}$.\n$$\\mathbf{k}^{(1-2)} = \\frac{2.0 \\times 10^5}{1} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}_{u_1, u_2} \\quad ; \\quad \\mathbf{f}^{(1-2)} = \\frac{1000 \\times 1}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}_{u_1, u_2} = \\begin{pmatrix} 500 \\\\ 500 \\end{pmatrix}$$\nThe assembled system for nodes $(0, 1, 2)$ is $\\mathbf{K}^\\mathcal{A} \\mathbf{u}^\\mathcal{A} = \\mathbf{F}^\\mathcal{A}$:\n$$\\begin{pmatrix} k^{(0-1)}_{11}  k^{(0-1)}_{12}  0 \\\\ k^{(0-1)}_{21}  k^{(0-1)}_{22}+k^{(1-2)}_{11}  k^{(1-2)}_{12} \\\\ 0  k^{(1-2)}_{21}  k^{(1-2)}_{22} \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f^{(0-1)}_1 \\\\ f^{(0-1)}_2 + f^{(1-2)}_1 \\\\ f^{(1-2)}_2 \\end{pmatrix}$$\n$$2.0 \\times 10^5 \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 500 \\\\ 500 \\end{pmatrix}$$\nApplying the boundary condition $u_0=0$, the system for the free DOFs $(u_1, u_2)$ becomes:\n$$2.0 \\times 10^5 \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} 500 \\\\ 500 \\end{pmatrix}$$\nTo perform static condensation, we partition the system into internal DOFs ($i = \\{1\\}$) and interface DOFs ($b = \\{2\\}$):\n$$\\begin{pmatrix} \\mathbf{K}_{ii}  \\mathbf{K}_{ib} \\\\ \\mathbf{K}_{bi}  \\mathbf{K}_{bb} \\end{pmatrix} \\begin{pmatrix} \\mathbf{u}_i \\\\ \\mathbf{u}_b \\end{pmatrix} = \\begin{pmatrix} \\mathbf{F}_i \\\\ \\mathbf{F}_b \\end{pmatrix}$$\nwhere $\\mathbf{K}_{ii} = 4.0 \\times 10^5$, $\\mathbf{K}_{ib} = -2.0 \\times 10^5$, $\\mathbf{K}_{bi} = -2.0 \\times 10^5$, $\\mathbf{K}_{bb} = 2.0 \\times 10^5$, $\\mathbf{F}_i = 500$, and $\\mathbf{F}_b = 500$.\nThe condensed system is $\\mathbf{K}^*_\\mathcal{A} \\mathbf{u}_b = \\mathbf{F}^*_\\mathcal{A}$, where:\n$\\mathbf{K}^*_\\mathcal{A} = \\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib} = 2.0 \\times 10^5 - (-2.0 \\times 10^5)(4.0 \\times 10^5)^{-1}(-2.0 \\times 10^5) = 2.0 \\times 10^5 - \\frac{(2.0 \\times 10^5)^2}{4.0 \\times 10^5} = 2.0 \\times 10^5 - 1.0 \\times 10^5 = 1.0 \\times 10^5\\,\\mathrm{N/m}$.\n$\\mathbf{F}^*_\\mathcal{A} = \\mathbf{F}_b - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{F}_i = 500 - (-2.0 \\times 10^5)(4.0 \\times 10^5)^{-1}(500) = 500 - (-\\frac{1}{2})(500) = 500 + 250 = 750\\,\\mathrm{N}$.\nThe condensed equation for substructure $\\mathcal{A}$ at interface node $2$ is $1.0 \\times 10^5 u_2 = 750$.\n\n**Substructure $\\mathcal{B}$ (Nodes $2, 3, 4$)**\nThe substructure consists of elements $(2-3)$ and $(3-4)$.\nElement $(2-3)$: $L_{23} = 2\\,\\mathrm{m}$, $EA = 1.0 \\times 10^4\\,\\mathrm{N}$, $b_{23} = 500\\,\\mathrm{N/m}$.\n$$\\mathbf{k}^{(2-3)} = \\frac{1.0 \\times 10^4}{2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}_{u_2, u_3} = 5000 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\quad ; \\quad \\mathbf{f}^{(2-3)} = \\frac{500 \\times 2}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}_{u_2, u_3} = \\begin{pmatrix} 500 \\\\ 500 \\end{pmatrix}$$\nElement $(3-4)$: $L_{34} = 1\\,\\mathrm{m}$, $EA = 1.0 \\times 10^4\\,\\mathrm{N}$. No body force.\n$$\\mathbf{k}^{(3-4)} = \\frac{1.0 \\times 10^4}{1} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}_{u_3, u_4} \\quad ; \\quad \\mathbf{f}^{(3-4)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\nNodal force at node $4$: $T_4 = 2000\\,\\mathrm{N}$.\nThe assembled system for nodes $(2, 3, 4)$ is $\\mathbf{K}^\\mathcal{B} \\mathbf{u}^\\mathcal{B} = \\mathbf{F}^\\mathcal{B}$:\n$$\\begin{pmatrix} 5000  -5000  0 \\\\ -5000  5000+10000  -10000 \\\\ 0  -10000  10000 \\end{pmatrix} \\begin{pmatrix} u_2 \\\\ u_3 \\\\ u_4 \\end{pmatrix} = \\begin{pmatrix} 500 \\\\ 500 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 2000 \\end{pmatrix}$$\n$$1000 \\begin{pmatrix} 5  -5  0 \\\\ -5  15  -10 \\\\ 0  -10  10 \\end{pmatrix} \\begin{pmatrix} u_2 \\\\ u_3 \\\\ u_4 \\end{pmatrix} = \\begin{pmatrix} 500 \\\\ 500 \\\\ 2000 \\end{pmatrix}$$\nWe condense out the internal DOFs $i=\\{3, 4\\}$ to find the relation for the interface DOF $b=\\{2\\}$.\n$\\mathbf{K}_{bb}=5000$, $\\mathbf{K}_{bi}=\\begin{pmatrix} -5000  0 \\end{pmatrix}$, $\\mathbf{K}_{ib}=\\begin{pmatrix} -5000 \\\\ 0 \\end{pmatrix}$, $\\mathbf{K}_{ii}=1000\\begin{pmatrix} 15  -10 \\\\ -10  10 \\end{pmatrix}$.\n$\\mathbf{F}_b = 500$, $\\mathbf{F}_i = \\begin{pmatrix} 500 \\\\ 2000 \\end{pmatrix}$.\nFirst, we find $\\mathbf{K}_{ii}^{-1}$: $\\det(\\mathbf{K}_{ii}) = (1000)^2 (150-100) = 50 \\times 10^6$.\n$\\mathbf{K}_{ii}^{-1} = \\frac{1}{50 \\times 10^6} \\begin{pmatrix} 10000  10000 \\\\ 10000  15000 \\end{pmatrix} = \\frac{1}{5000} \\begin{pmatrix} 1  1 \\\\ 1  1.5 \\end{pmatrix}$.\nThe condensed stiffness is $\\mathbf{K}^*_\\mathcal{B} = \\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib}$.\n$\\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} = \\begin{pmatrix} -5000  0 \\end{pmatrix} \\frac{1}{5000} \\begin{pmatrix} 1  1 \\\\ 1  1.5 \\end{pmatrix} = \\begin{pmatrix} -1  -1 \\end{pmatrix}$.\n$\\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib} = \\begin{pmatrix} -1  -1 \\end{pmatrix} \\begin{pmatrix} -5000 \\\\ 0 \\end{pmatrix} = 5000$.\n$\\mathbf{K}^*_\\mathcal{B} = 5000 - 5000 = 0$. This is expected, as substructure $\\mathcal{B}$ is unconstrained and allows rigid body motion.\nThe condensed force is $\\mathbf{F}^*_\\mathcal{B} = \\mathbf{F}_b - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{F}_i$.\n$\\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{F}_i = \\begin{pmatrix} -1  -1 \\end{pmatrix} \\begin{pmatrix} 500 \\\\ 2000 \\end{pmatrix} = -500 - 2000 = -2500$.\n$\\mathbf{F}^*_\\mathcal{B} = 500 - (-2500) = 3000\\,\\mathrm{N}$.\nThe condensed force represents the total force applied to the substructure, transferred to the interface. The external forces on $\\mathcal{B}$ are $b_{23}L_{23} + T_4 = (500)(2) + 2000 = 3000\\,\\mathrm{N}$.\n\n**Assembly and Solution**\nThe final step is to assemble the reduced equations from both substructures at the interface node $2$. The assembly rule for substructuring is $(\\mathbf{K}^*_\\mathcal{A} + \\mathbf{K}^*_\\mathcal{B}) u_2 = \\mathbf{F}^*_\\mathcal{A} + \\mathbf{F}^*_\\mathcal{B}$.\n$$(1.0 \\times 10^5 + 0) u_2 = 750 + 3000$$\n$$1.0 \\times 10^5 u_2 = 3750$$\nSolving for the interface displacement $u_2$:\n$$u_2 = \\frac{3750}{1.0 \\times 10^5} = 0.0375\\,\\mathrm{m}$$\nThe problem requires the answer in millimeters, rounded to four significant figures.\n$$u_2 = 0.0375\\,\\mathrm{m} \\times \\frac{1000\\,\\mathrm{mm}}{1\\,\\mathrm{m}} = 37.5\\,\\mathrm{mm}$$\nRounding to four significant figures gives $37.50\\,\\mathrm{mm}$.", "answer": "$$\\boxed{37.50}$$", "id": "2562927"}, {"introduction": "Moving beyond direct numerical elimination, this problem explores the elegant interplay between static condensation and kinematic constraints. You will derive an effective stiffness for a substructure subject to a Multi-Point Constraint (MPC) from an energy perspective [@problem_id:3602467]. This exercise demonstrates how condensation can encapsulate complex internal behaviors, defined by constraints, into a simple boundary-level stiffness matrix, a powerful concept in advanced modeling.", "problem": "Consider a one-dimensional linear elastic substructure intended for system-level substructuring. The substructure consists of $3$ nodes labeled $1$, $2$, and $3$, connected by $2$ axial bar elements: element $(1,2)$ with axial stiffness $k_1$ and element $(2,3)$ with axial stiffness $k_2$. Let the nodal displacements be $u_1$, $u_2$, and $u_3$, and the nodal forces be $f_1$, $f_2$, and $f_3$. The global equilibrium of the linear system is governed by the principle of virtual work (PVW), which for linear springs reduces to the linear system $\\mathbf{K} \\mathbf{u} = \\mathbf{f}$, where $\\mathbf{K}$ is the assembled global stiffness matrix constructed from the element stiffnesses, and the total potential energy is $\\Pi(\\mathbf{u}) = \\tfrac{1}{2} \\mathbf{u}^{\\mathsf T} \\mathbf{K} \\mathbf{u} - \\mathbf{f}^{\\mathsf T} \\mathbf{u}$.\n\nThe substructure is subject to a single linear Multi-Point Constraint (MPC) that ties the interior displacement $u_2$ to a convex combination of the boundary displacements,\n$$u_2 = \\eta\\, u_1 + (1-\\eta)\\, u_3,$$\nwith a given parameter $0  \\eta  1$. Physically, this MPC can arise, for example, from an internal rigid constraint selecting an affine interpolation between the retained boundary degrees of freedom.\n\nYou will regard nodes $1$ and $3$ as the retained boundary degrees of freedom and node $2$ as an interior degree of freedom to be eliminated. The substructure is to be used as a component in a larger model where node $3$ is clamped, so that $u_3 = 0$, and a scalar load $f_1$ is applied at node $1$ with $f_3$ representing the reaction. Define the effective boundary stiffness $k_{\\text{eff}}$ of the constrained and condensed substructure as\n$$k_{\\text{eff}} := \\frac{f_1}{u_1}\\quad\\text{under the boundary condition }u_3=0,$$\nwith the MPC enforced exactly and the interior degree of freedom eliminated in an energy-consistent manner.\n\nStarting only from the fundamental definitions stated above (linear elasticity of axial springs, PVW-based equilibrium, linear kinematic constraint), derive a closed-form analytic expression for $k_{\\text{eff}}$ as a function of $k_1$, $k_2$, and $\\eta$. Express the final effective stiffness in $\\text{N}/\\text{m}$. Provide your final answer as a single analytic expression in terms of $k_1$, $k_2$, and $\\eta$. No numerical values are to be substituted, and no rounding is required.", "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and self-contained. It presents a standard problem in computational solid mechanics concerning static condensation of a constrained substructure. All provided data and definitions are consistent and sufficient for deriving a unique, meaningful solution.\n\nThe objective is to find the effective stiffness $k_{\\text{eff}}$ of a one-dimensional, three-node substructure subject to a linear multi-point constraint (MPC). The effective stiffness is defined as $k_{\\text{eff}} := f_1/u_1$ when the boundary condition $u_3=0$ is applied. The derivation will proceed from the principle of potential energy, which is specified in the problem statement.\n\nThe total potential energy of the unconstrained system is given by $\\Pi(\\mathbf{u}) = \\frac{1}{2} \\mathbf{u}^{\\mathsf T} \\mathbf{K} \\mathbf{u} - \\mathbf{f}^{\\mathsf T} \\mathbf{u}$. The internal strain energy is stored in the two axial bar elements and is given by $\\Pi_{\\text{int}}(\\mathbf{u}) = \\frac{1}{2} \\mathbf{u}^{\\mathsf T} \\mathbf{K} \\mathbf{u}$. Explicitly for the two elements, this is:\n$$\n\\Pi_{\\text{int}}(u) = \\frac{1}{2} k_1 (u_2 - u_1)^2 + \\frac{1}{2} k_2 (u_3 - u_2)^2\n$$\nwhere $k_1$ and $k_2$ are the axial stiffnesses of elements $(1,2)$ and $(2,3)$ respectively, and $u_1, u_2, u_3$ are the nodal displacements.\n\nThe system is subject to a linear kinematic MPC:\n$$\nu_2 = \\eta u_1 + (1-\\eta) u_3\n$$\nwhere nodes $1$ and $3$ are the retained boundary degrees of freedom (DOFs) and node $2$ is the interior DOF to be eliminated. The parameter $\\eta$ is given, with $0  \\eta  1$.\n\nTo find the condensed (or effective) properties of the substructure, we must express the potential energy solely in terms of the retained boundary displacements $\\mathbf{u}_b = \\begin{pmatrix} u_1 \\\\ u_3 \\end{pmatrix}$. This is an energy-consistent elimination of the interior DOF $u_2$. We substitute the MPC into the strain energy expression.\n\nFirst, let's express the element elongations in terms of the boundary DOFs $u_1$ and $u_3$:\nThe elongation of the first element is $(u_2 - u_1)$:\n$$\nu_2 - u_1 = (\\eta u_1 + (1-\\eta) u_3) - u_1 = (\\eta - 1) u_1 + (1-\\eta) u_3 = (1-\\eta)(u_3 - u_1)\n$$\nThe elongation of the second element is $(u_3 - u_2)$:\n$$\nu_3 - u_2 = u_3 - (\\eta u_1 + (1-\\eta) u_3) = -\\eta u_1 + (1 - (1-\\eta)) u_3 = -\\eta u_1 + \\eta u_3 = \\eta(u_3 - u_1)\n$$\nNotice that the MPC forces both element elongations to be proportional to the total elongation of the substructure, $(u_3 - u_1)$.\n\nNow, substitute these expressions back into the strain energy equation:\n$$\n\\Pi_{\\text{int}}(u_1, u_3) = \\frac{1}{2} k_1 \\left[ (1-\\eta)(u_3 - u_1) \\right]^2 + \\frac{1}{2} k_2 \\left[ \\eta(u_3 - u_1) \\right]^2\n$$\nFactoring out the common term $(u_3 - u_1)^2$:\n$$\n\\Pi_{\\text{int}}(u_1, u_3) = \\frac{1}{2} \\left[ k_1 (1-\\eta)^2 + k_2 \\eta^2 \\right] (u_3 - u_1)^2\n$$\nThis expression is the strain energy of the condensed substructure, expressed entirely in terms of the boundary DOFs $u_1$ and $u_3$. This energy is of the form $\\frac{1}{2} \\mathbf{u}_b^{\\mathsf{T}} \\mathbf{K}_c \\mathbf{u}_b$, where $\\mathbf{K}_c$ is the $2 \\times 2$ condensed stiffness matrix. Let's expand the squared term to identify the components of $\\mathbf{K}_c$:\n$$\n(u_3 - u_1)^2 = u_1^2 - 2u_1 u_3 + u_3^2 = \\begin{pmatrix} u_1  u_3 \\end{pmatrix} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_3 \\end{pmatrix}\n$$\nLet the constant term be $C = k_1 (1-\\eta)^2 + k_2 \\eta^2$. Then the strain energy is:\n$$\n\\Pi_{\\text{int}}(u_1, u_3) = \\frac{1}{2} C (u_1^2 - 2u_1 u_3 + u_3^2) = \\frac{1}{2} \\begin{pmatrix} u_1  u_3 \\end{pmatrix} \\begin{pmatrix} C  -C \\\\ -C  C \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_3 \\end{pmatrix}\n$$\nFrom this, we identify the condensed stiffness matrix $\\mathbf{K}_c$:\n$$\n\\mathbf{K}_c = \\begin{pmatrix} k_1(1-\\eta)^2 + k_2\\eta^2  -[k_1(1-\\eta)^2 + k_2\\eta^2] \\\\ -[k_1(1-\\eta)^2 + k_2\\eta^2]  k_1(1-\\eta)^2 + k_2\\eta^2 \\end{pmatrix}\n$$\nThe equilibrium equation for the condensed system is $\\mathbf{K}_c \\mathbf{u}_b = \\mathbf{f}_b$, where $\\mathbf{f}_b = \\begin{pmatrix} f_1 \\\\ f_3 \\end{pmatrix}$ are the external forces acting on the boundary nodes (assuming no external force on the internal node, $f_2=0$).\n$$\n\\begin{pmatrix} K_{c,11}  K_{c,12} \\\\ K_{c,21}  K_{c,22} \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} f_1 \\\\ f_3 \\end{pmatrix}\n$$\nWe need to find $k_{\\text{eff}} = f_1/u_1$ under the condition $u_3=0$. We use the first row of the matrix equation:\n$$\nK_{c,11} u_1 + K_{c,12} u_3 = f_1\n$$\nApplying the boundary condition $u_3=0$:\n$$\nK_{c,11} u_1 + K_{c,12} (0) = f_1 \\implies K_{c,11} u_1 = f_1\n$$\nTherefore, the effective stiffness is given by the $(1,1)$ component of the condensed stiffness matrix:\n$$\nk_{\\text{eff}} = \\frac{f_1}{u_1} = K_{c,11}\n$$\nSubstituting the expression we found for $K_{c,11}$:\n$$\nk_{\\text{eff}} = k_1(1-\\eta)^2 + k_2\\eta^2\n$$\nThis is the final closed-form analytical expression for the effective stiffness of the constrained substructure as a function of the given parameters. The problem's mention of units `N/m` serves to specify the physical dimension of stiffness, consistent with the analytical result.", "answer": "$$\\boxed{k_1(1-\\eta)^2 + k_2\\eta^2}$$", "id": "3602467"}, {"introduction": "This final, computational practice brings the concept of substructuring into the realm of model order reduction. You will implement a procedure to create a \"superelement library\" by parameterizing a substructure and tabulating its condensed stiffness [@problem_id:3602488]. This hands-on coding exercise showcases how pre-computing and interpolating superelements can drastically accelerate analyses of large systems with repeating components, a cornerstone of modern engineering simulation.", "problem": "You are given a parameterized one-dimensional linear elastic substructure to be used as a superelement in a larger assembly. The substructure is a straight axial bar of length $L$ (in $\\mathrm{m}$) with constant Young's modulus $E$ (in $\\mathrm{Pa}$) and cross-sectional area $A$ (in $\\mathrm{m}^2$). The substructure is discretized into $m$ equal two-node finite elements, yielding an assembled linear system from the principle of virtual work and small-strain linear elasticity: a symmetric positive-definite global stiffness matrix $\\mathbf{K}$ (in $\\mathrm{N}/\\mathrm{m}$) relating the nodal displacement vector $\\mathbf{u}$ (in $\\mathrm{m}$) to the force vector $\\mathbf{f}$ (in $\\mathrm{N}$) by $\\mathbf{K} \\mathbf{u} = \\mathbf{f}$. The element stiffness for an axial bar of length $\\ell_e$ is obtained from basic constitutive law $\\sigma = E \\varepsilon$ and axial equilibrium, yielding an element stiffness matrix proportional to $E A / \\ell_e$.\n\nIn substructuring, the internal degrees of freedom are eliminated to define a condensed, or \"superelement,\" stiffness $\\mathbf{S}(\\theta)$ that maps the pair of boundary displacements at the two ends of the substructure to the corresponding boundary forces, where $\\theta = (E, A, L)$. The condensed matrix $\\mathbf{S}(\\theta)$ is a symmetric $2 \\times 2$ matrix depending on the parameters through the assembled and condensed finite element model.\n\nYour task is to implement the following steps purely in computational terms:\n\n1. Library construction:\n   - Fix $m = 4$ elements per substructure.\n   - Define parameter grids:\n     - $E \\in \\{70 \\times 10^{9}, 140 \\times 10^{9}, 210 \\times 10^{9}\\}$ (in $\\mathrm{Pa}$).\n     - $A \\in \\{5 \\times 10^{-4}, 10^{-3}, 2 \\times 10^{-3}\\}$ (in $\\mathrm{m}^2$).\n     - $L \\in \\{0.5, 1.0, 2.0\\}$ (in $\\mathrm{m}$).\n   - For each triplet $\\theta = (E, A, L)$ on the tensor-product grid, assemble the $m+1$ node axial finite element model using $m$ equal elements, and statically condense interior nodes to obtain the boundary condensed stiffness $\\mathbf{S}(\\theta)$ for the two boundary nodes. Tabulate this superelement library.\n\n2. Interpolant:\n   - For a general parameter point $\\theta$ contained within the convex hull of the grid (no extrapolation), construct a trilinear interpolant $\\tilde{\\mathbf{S}}(\\theta)$ by multilinear interpolation on the library in the $(E, A, L)$ space. The interpolation is applied entrywise to the $2 \\times 2$ condensed stiffness matrix.\n\n3. Global assembly and compliance:\n   - Consider a one-dimensional global structure composed by assembling two such superelements in series. Denote the left superelement by $\\theta_1$ and the right superelement by $\\theta_2$. Let the global left boundary node be fixed with displacement zero, and apply a right-end point load $P = 10^{5}$ (in $\\mathrm{N}$) at the global right boundary node. There is a single scalar degree of freedom at each node. Assemble the $3 \\times 3$ global stiffness from the two condensed $2 \\times 2$ superelement matrices using standard finite element assembly at the shared interface node. Compute the global displacement vector by solving the reduced system obtained after imposing the left Dirichlet boundary condition. Let the global compliance be $c = \\mathbf{f}^{\\mathsf{T}} \\mathbf{u}$ (in $\\mathrm{J}$).\n   - Define the relative compliance error for a parameter pair $(\\theta_1, \\theta_2)$ as the dimensionless quantity\n     $$\n     \\varepsilon = \\frac{\\lvert c(\\mathbf{S}(\\theta_1), \\mathbf{S}(\\theta_2)) - c(\\tilde{\\mathbf{S}}(\\theta_1), \\tilde{\\mathbf{S}}(\\theta_2)) \\rvert}{\\lvert c(\\mathbf{S}(\\theta_1), \\mathbf{S}(\\theta_2)) \\rvert}.\n     $$\n\n4. Test suite:\n   - Use the following four test cases, each specifying $(\\theta_1, \\theta_2)$ with $\\theta_i = (E_i, A_i, L_i)$:\n     - Test $1$ (on-grid, zero interpolation error expected): $\\theta_1 = (140 \\times 10^{9}, 10^{-3}, 1.0)$, $\\theta_2 = (140 \\times 10^{9}, 10^{-3}, 1.0)$.\n     - Test $2$ (one interior, one on-grid): $\\theta_1 = (100 \\times 10^{9}, 0.8 \\times 10^{-3}, 1.2)$, $\\theta_2 = (140 \\times 10^{9}, 10^{-3}, 1.0)$.\n     - Test $3$ (mixed interior and boundary in $L$): $\\theta_1 = (175 \\times 10^{9}, 1.5 \\times 10^{-3}, 0.5)$, $\\theta_2 = (100 \\times 10^{9}, 0.8 \\times 10^{-3}, 1.2)$.\n     - Test $4$ (face-boundary case and on-grid corner): $\\theta_1 = (140 \\times 10^{9}, 0.75 \\times 10^{-3}, 2.0)$, $\\theta_2 = (210 \\times 10^{9}, 2 \\times 10^{-3}, 2.0)$.\n   - All quantities are in the units specified above. The final reported errors are dimensionless.\n\n5. Program output format:\n   - Your program must build the library, interpolate as needed, assemble the global systems, and compute the relative compliance error $\\varepsilon$ for each of the four tests in the order listed.\n   - Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets (e.g., $[e_1,e_2,e_3,e_4]$), where each $e_i$ is a floating-point number.\n\nConstraints and clarifications:\n- Base your derivations on equilibrium of axial bars, linear elasticity, finite element assembly, and the definition of static condensation as elimination of interior degrees of freedom to obtain a boundary relation. Do not use any unproven shortcut formulas in the problem statement itself.\n- Numerical stability: The assembled interior stiffness blocks are symmetric positive-definite for the given data, so standard linear algebra suffices for static condensation.\n- Angles do not appear; no angle units are required.\n- Since the requested outputs are dimensionless relative errors, no explicit physical units are required in the final numeric outputs.", "solution": "The user-provided problem is rigorously validated and found to be scientifically grounded, well-posed, objective, and complete. All provided data and constraints are consistent and physically realistic within the framework of computational linear elasticity. The task is to compute the relative error in structural compliance arising from trilinear interpolation of superelement stiffness matrices. The solution will be implemented by following the prescribed computational steps.\n\n### Principle of Static Condensation\n\nThe static analysis of a finite element model is governed by the linear system $\\mathbf{K} \\mathbf{u} = \\mathbf{f}$, where $\\mathbf{K}$ is the global stiffness matrix, $\\mathbf{u}$ is the vector of nodal displacements, and $\\mathbf{f}$ is the vector of nodal forces. In substructuring, we partition the degrees of freedom (DOFs), $\\mathbf{u}$, into internal (or \"doomed\") DOFs, $\\mathbf{u}_i$, and boundary (or \"retained\") DOFs, $\\mathbf{u}_b$. The system of equations is partitioned accordingly:\n\n$$\n\\begin{pmatrix} \\mathbf{K}_{bb}  \\mathbf{K}_{bi} \\\\ \\mathbf{K}_{ib}  \\mathbf{K}_{ii} \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{u}_b \\\\ \\mathbf{u}_i \\end{pmatrix} =\n\\begin{pmatrix} \\mathbf{f}_b \\\\ \\mathbf{f}_i \\end{pmatrix}\n$$\n\nStatic condensation is the process of eliminating the internal DOFs, $\\mathbf{u}_i$, to find a direct relationship between the boundary forces, $\\mathbf{f}_b$, and boundary displacements, $\\mathbf{u}_b$. This is typically performed under the assumption that there are no external forces applied to the internal DOFs, i.e., $\\mathbf{f}_i = \\mathbf{0}$.\n\nFrom the second row of the partitioned system, we solve for $\\mathbf{u}_i$:\n$\\mathbf{K}_{ib} \\mathbf{u}_b + \\mathbf{K}_{ii} \\mathbf{u}_i = \\mathbf{0} \\implies \\mathbf{u}_i = -\\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib} \\mathbf{u}_b$.\nThe matrix $\\mathbf{K}_{ii}$ is invertible because it represents the stiffness matrix of the structure with its boundary DOFs held fixed, which is a stable configuration.\n\nSubstituting this expression for $\\mathbf{u}_i$ into the first row of the system gives:\n$\\mathbf{K}_{bb} \\mathbf{u}_b + \\mathbf{K}_{bi} (-\\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib} \\mathbf{u}_b) = \\mathbf{f}_b$\n$$\n(\\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib}) \\mathbf{u}_b = \\mathbf{f}_b\n$$\nThis defines the condensed stiffness matrix, or superelement stiffness matrix $\\mathbf{S}$, as:\n$$\n\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib}\n$$\nThis matrix $\\mathbf{S}$ relates the displacements and forces at the boundary of the substructure. Note that $\\mathbf{K}_{ib} = \\mathbf{K}_{bi}^{\\mathsf{T}}$ due to the symmetry of the stiffness matrix $\\mathbf{K}$.\n\n### Step 1: Substructure Stiffness Matrix Assembly and Condensation\n\nThe substructure is a one-dimensional axial bar of length $L$, Young's modulus $E$, and area $A$. It is discretized into $m=4$ equal-length elements. The length of each element is $\\ell_e = L/4$. The stiffness matrix for a single two-node bar element is:\n$$\n\\mathbf{k}_e = \\frac{EA}{\\ell_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\frac{4EA}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\nStandard finite element assembly for the $m=4$ elements (which have $m+1=5$ nodes) yields the global stiffness matrix $\\mathbf{K}$ of size $5 \\times 5$:\n$$\n\\mathbf{K} = \\frac{4EA}{L} \\begin{pmatrix}\n1  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  1\n\\end{pmatrix}\n$$\nThe boundary DOFs correspond to the first and last nodes (node indices $0$ and $4$), and the internal DOFs correspond to the intermediate nodes (indices $1, 2, 3$). Following the partitioning scheme, we identify the submatrices:\n$\\mathbf{u}_b = (u_0, u_4)^{\\mathsf{T}}$, $\\mathbf{u}_i = (u_1, u_2, u_3)^{\\mathsf{T}}$.\nBased on the full matrix $\\mathbf{K}$, the blocks are:\n$$\n\\mathbf{K}_{bb} = \\frac{4EA}{L} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\n\\mathbf{K}_{bi} = \\frac{4EA}{L} \\begin{pmatrix} -1  0  0 \\\\ 0  0  -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{ii} = \\frac{4EA}{L} \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}\n$$\nThe computation of $\\mathbf{S}(\\theta)$ for each parameter set $\\theta = (E, A, L)$ proceeds by numerically forming these matrices and evaluating the expression $\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{bi} (\\text{solve}(\\mathbf{K}_{ii}, \\mathbf{K}_{ib}))$. We will build a library by calculating and storing $\\mathbf{S}(\\theta)$ for each point on the specified tensor-product grid of $(E, A, L)$.\n\n### Step 2: Trilinear Interpolation\n\nFor a general parameter point $\\theta=(E, A, L)$ not on the grid, the condensed stiffness matrix $\\tilde{\\mathbf{S}}(\\theta)$ is approximated by entrywise trilinear interpolation from the pre-computed library. For any scalar quantity $f(E,A,L)$ defined on the grid, its trilinear interpolant at a point $(E,A,L)$ within a grid cell $[E_i, E_{i+1}] \\times [A_j, A_{j+1}] \\times [L_k, L_{k+1}]$ is found by first calculating the normalized coordinates:\n$$\nt_E = \\frac{E - E_i}{E_{i+1} - E_i}, \\quad t_A = \\frac{A - A_j}{A_{j+1} - A_j}, \\quad t_L = \\frac{L - L_k}{L_{k+1} - L_k}\n$$\nThe interpolated value is then computed through a sequence of linear interpolations (lerps). Let $c_{pqr} = f(E_{i+p}, A_{j+q}, L_{k+r})$ for $p,q,r \\in \\{0, 1\\}$.\n1.  Interpolate along the $E$-axis for each of the four edges of the cell parallel to it.\n2.  Interpolate the four results from step 1 along the $A$-axis to obtain two values.\n3.  Interpolate the two results from step 2 along the $L$-axis to get the final value.\n\nThis procedure is applied to the unique entries of the symmetric $2 \\times 2$ matrix $\\mathbf{S}(\\theta)$, namely $S_{11}$, $S_{12}$, and $S_{22}$.\n\n### Step 3: Global Assembly and Compliance Calculation\n\nTwo superelements, described by parameters $\\theta_1$ and $\\theta_2$, are assembled in series. This creates a global structure with three nodes: node $0$ (left end), node $1$ (interface), and node $2$ (right end). The global stiffness matrix $\\mathbf{K}_G$ is a $3 \\times 3$ matrix assembled from the two $2 \\times 2$ superelement matrices $\\mathbf{S}(\\theta_1)$ and $\\mathbf{S}(\\theta_2)$:\n$$\n\\mathbf{K}_G = \\begin{pmatrix}\nS(\\theta_1)_{11}  S(\\theta_1)_{12}  0 \\\\\nS(\\theta_1)_{21}  S(\\theta_1)_{22} + S(\\theta_2)_{11}  S(\\theta_2)_{12} \\\\\n0  S(\\theta_2)_{21}  S(\\theta_2)_{22}\n\\end{pmatrix}\n$$\nThe boundary condition is a fixed displacement at the left end, $u_0 = 0$. A load $P=10^5 \\, \\mathrm{N}$ is applied at the right end. The global system of equations is $\\mathbf{K}_G \\mathbf{u} = \\mathbf{f}$, with $\\mathbf{u} = (u_0, u_1, u_2)^{\\mathsf{T}}$ and an external force vector $\\mathbf{f}_{ext} = (0, 0, P)^{\\mathsf{T}}$.\n\nApplying the boundary condition $u_0=0$ reduces the system to a $2 \\times 2$ problem for the unknown displacements $u_1$ and $u_2$:\n$$\n\\begin{pmatrix}\nS(\\theta_1)_{22} + S(\\theta_2)_{11}  S(\\theta_2)_{12} \\\\\nS(\\theta_2)_{21}  S(\\theta_2)_{22}\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ P \\end{pmatrix}\n$$\nAfter solving for $u_1$ and $u_2$, the full displacement vector is $\\mathbf{u} = (0, u_1, u_2)^{\\mathsf{T}}$. The compliance $c$ is the work done by the external applied forces, defined as $c = \\mathbf{f}_{ext}^{\\mathsf{T}} \\mathbf{u}$. In this case, it simplifies to $c = P u_2$.\n\n### Step 4: Relative Error Calculation\n\nFor each test case $(\\theta_1, \\theta_2)$, we compute two compliance values:\n1.  $c_{exact}$: Using the exactly computed superelement matrices $\\mathbf{S}(\\theta_1)$ and $\\mathbf{S}(\\theta_2)$.\n2.  $c_{interp}$: Using the trilinearly interpolated matrices $\\tilde{\\mathbf{S}}(\\theta_1)$ and $\\tilde{\\mathbf{S}}(\\theta_2)$.\n\nThe relative compliance error $\\varepsilon$ is then calculated as:\n$$\n\\varepsilon = \\frac{\\lvert c_{exact} - c_{interp} \\rvert}{\\lvert c_{exact} \\rvert}\n$$\n\nThe following Python code implements this entire procedure for the four specified test cases.", "answer": "```python\nimport numpy as np\n\ndef compute_S(theta, m):\n    \"\"\"\n    Computes the condensed stiffness matrix S for a 1D bar.\n    \n    Args:\n        theta (tuple): A tuple (E, A, L) of material and geometric properties.\n        m (int): Number of finite elements.\n    \n    Returns:\n        numpy.ndarray: The 2x2 condensed stiffness matrix.\n    \"\"\"\n    E, A, L = theta\n    if E == 0 or A == 0 or L == 0:\n        return np.zeros((2, 2))\n    \n    le = L / m\n    k_factor = E * A / le\n    \n    n_nodes = m + 1\n    K = np.zeros((n_nodes, n_nodes))\n    \n    for i in range(m):\n        k_e = k_factor * np.array([[1, -1], [-1, 1]])\n        K[i:i+2, i:i+2] += k_e\n\n    retained_dofs = [0, m]\n    doomed_dofs = list(range(1, m))\n\n    K_rr = K[np.ix_(retained_dofs, retained_dofs)]\n    K_rd = K[np.ix_(retained_dofs, doomed_dofs)]\n    K_dr = K[np.ix_(doomed_dofs, retained_dofs)]\n    K_dd = K[np.ix_(doomed_dofs, doomed_dofs)]\n    \n    # Solve K_dd * X = K_dr for X, then S = K_rr - K_rd @ X\n    Kdd_inv_Kdr = np.linalg.solve(K_dd, K_dr)\n    S = K_rr - K_rd @ Kdd_inv_Kdr\n    return S\n\ndef get_indices_and_t(val, grid):\n    \"\"\"\n    Finds the lower-bound index and normalized distance for interpolation.\n    \n    Args:\n        val (float): The value to locate in the grid.\n        grid (numpy.ndarray): The 1D sorted grid array.\n    \n    Returns:\n        tuple: (lower_bound_index, normalized_distance_t)\n    \"\"\"\n    if val == grid[-1]:\n        return len(grid) - 2, 1.0\n    \n    idx = np.searchsorted(grid, val, side='right') - 1\n    \n    # Handle precision issues where val might be slightly less than grid[0]\n    idx = max(0, idx)\n\n    t = (val - grid[idx]) / (grid[idx+1] - grid[idx])\n    \n    return idx, t\n\ndef interpolate_S(theta, library, grids):\n    \"\"\"\n    Computes the interpolated stiffness matrix S_tilde using trilinear interpolation.\n    \n    Args:\n        theta (tuple): The parameter point (E, A, L).\n        library (dict): The pre-computed library of stiffness matrices.\n        grids (tuple): A tuple of (E_grid, A_grid, L_grid).\n\n    Returns:\n        numpy.ndarray: The 2x2 interpolated stiffness matrix.\n    \"\"\"\n    if theta in library:\n        return library[theta]\n\n    E_grid, A_grid, L_grid = grids\n    E, A, L = theta\n\n    i, tE = get_indices_and_t(E, E_grid)\n    j, tA = get_indices_and_t(A, A_grid)\n    k, tL = get_indices_and_t(L, L_grid)\n\n    # Get the 8 corner points of the grid cell\n    corners = np.zeros((8, 3)) # 8 corners, 3 values (S00, S01, S11)\n    \n    E_coords = [E_grid[i], E_grid[i+1]]\n    A_coords = [A_grid[j], A_grid[j+1]]\n    L_coords = [L_grid[k], L_grid[k+1]]\n\n    corner_idx = 0\n    # The order of loops establishes the convention for interpolation axes.\n    # E - x, A - y, L - z\n    for l_val in L_coords:\n        for a_val in A_coords:\n            for e_val in E_coords:\n                S_val = library[(e_val, a_val, l_val)]\n                corners[corner_idx, :] = [S_val[0,0], S_val[0,1], S_val[1,1]]\n                corner_idx += 1\n    \n    interp_vals = np.zeros(3)\n    for val_idx in range(3): # Iterate over S00, S01, S11\n        # Interpolate along E axis (tE)\n        c00 = corners[0, val_idx] * (1 - tE) + corners[1, val_idx] * tE\n        c10 = corners[2, val_idx] * (1 - tE) + corners[3, val_idx] * tE\n        c01 = corners[4, val_idx] * (1 - tE) + corners[5, val_idx] * tE\n        c11 = corners[6, val_idx] * (1 - tE) + corners[7, val_idx] * tE\n        \n        # Interpolate along A axis (tA)\n        c0 = c00 * (1 - tA) + c10 * tA\n        c1 = c01 * (1 - tA) + c11 * tA\n        \n        # Interpolate along L axis (tL)\n        interp_vals[val_idx] = c0 * (1 - tL) + c1 * tL\n\n    S_interp = np.array([\n        [interp_vals[0], interp_vals[1]],\n        [interp_vals[1], interp_vals[2]]\n    ])\n    return S_interp\n\ndef calculate_compliance(S1, S2, P):\n    \"\"\"\n    Calculates the global compliance for a two-element assembly.\n    \n    Args:\n        S1, S2 (numpy.ndarray): 2x2 stiffness matrices for elements 1 and 2.\n        P (float): Applied load at the right end.\n        \n    Returns:\n        float: The global compliance.\n    \"\"\"\n    K_red = np.array([\n        [S1[1,1] + S2[0,0], S2[0,1]],\n        [S2[1,0], S2[1,1]]\n    ])\n    f_red = np.array([0, P])\n    \n    if np.linalg.det(K_red) == 0:\n        return np.inf\n\n    u_red = np.linalg.solve(K_red, f_red)\n    u2 = u_red[1]\n    \n    return P * u2\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis and print the results.\n    \"\"\"\n    # Define parameters and problem setup\n    m = 4\n    P = 1e5\n    E_grid = np.array([70e9, 140e9, 210e9])\n    A_grid = np.array([5e-4, 1e-3, 2e-3])\n    L_grid = np.array([0.5, 1.0, 2.0])\n    grids = (E_grid, A_grid, L_grid)\n\n    # Define the test cases\n    test_cases = [\n        # ((E1, A1, L1), (E2, A2, L2))\n        ((140e9, 1e-3, 1.0), (140e9, 1e-3, 1.0)),\n        ((100e9, 0.8e-3, 1.2), (140e9, 1e-3, 1.0)),\n        ((175e9, 1.5e-3, 0.5), (100e9, 0.8e-3, 1.2)),\n        ((140e9, 0.75e-3, 2.0), (210e9, 2e-3, 2.0)),\n    ]\n\n    # Step 1: Library construction\n    library = {}\n    for E in E_grid:\n        for A in A_grid:\n            for L in L_grid:\n                theta = (E, A, L)\n                library[theta] = compute_S(theta, m)\n\n    results = []\n    for theta1, theta2 in test_cases:\n        # Exact calculation\n        S1_exact = compute_S(theta1, m)\n        S2_exact = compute_S(theta2, m)\n        c_exact = calculate_compliance(S1_exact, S2_exact, P)\n\n        # Interpolated calculation\n        S1_interp = interpolate_S(theta1, library, grids)\n        S2_interp = interpolate_S(theta2, library, grids)\n        c_interp = calculate_compliance(S1_interp, S2_interp, P)\n\n        # Relative error\n        if c_exact != 0:\n            error = np.abs(c_exact - c_interp) / np.abs(c_exact)\n        else:\n            # This case implies infinite stiffness, zero compliance\n            error = 0.0 if c_interp == 0.0 else np.inf\n        results.append(error)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3602488"}]}