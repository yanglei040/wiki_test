{"hands_on_practices": [{"introduction": "To effectively apply numerical integration, one must first grasp its underlying principles. This foundational exercise [@problem_id:3585301] demystifies the remarkable efficiency of Gauss-Legendre quadrature by guiding you through a derivation of its degree of precision. By connecting the orthogonality of Legendre polynomials to the rule's exactness, you will gain a core understanding of why this method is a cornerstone of finite element analysis.", "problem": "In the isoparametric finite element setting for computational solid mechanics, one frequently evaluates element matrices via integrals over the parent domain $[-1,1]$ using Gauss–Legendre quadrature. Consider the polynomial integrand $p(\\xi) = 1 + \\xi + \\xi^{4} + \\xi^{5}$ on $[-1,1]$. Starting only from the fundamental properties that the Legendre polynomials $\\{P_{k}(\\xi)\\}_{k=0}^{\\infty}$ are orthogonal on $[-1,1]$ with respect to the unit weight (i.e., $\\int_{-1}^{1} P_{i}(\\xi) P_{j}(\\xi)\\,d\\xi = 0$ for $i \\neq j$) and that the $n$-point Gauss–Legendre quadrature uses nodes given by the $n$ distinct roots of $P_{n}(\\xi)$ with positive weights, carry out the following:\n\n1. Derive, by exploiting orthogonality and the choice of nodes as the roots of $P_{n}(\\xi)$, the maximal polynomial degree for which an $n$-point Gauss–Legendre quadrature on $[-1,1]$ is exact. Your derivation must not assume this degree a priori but should logically follow from the orthogonality structure and the vanishing of $P_{n}(\\xi)$ at the quadrature nodes.\n\n2. Using your result from Part 1, determine the minimal number of quadrature points $n$ such that the Gauss–Legendre rule integrates $\\int_{-1}^{1} p(\\xi)\\,d\\xi$ exactly.\n\n3. For this minimal $n$, explicitly construct the nodes and weights by enforcing exactness on a sufficient set of low-degree monomials, and then evaluate the quadrature for $p(\\xi)$ to confirm exactness. Express the final value of the integral as an exact rational number.\n\nReport your final answer as a row matrix containing, in order, the minimal number of points and the exact value of the integral, i.e., $\\begin{pmatrix} n  I \\end{pmatrix}$, where $I = \\int_{-1}^{1} p(\\xi)\\,d\\xi$. No rounding is required and no units are needed.", "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution. The problem statement is therefore valid. We proceed in three parts as requested.\n\nPart 1: Derivation of the maximal polynomial degree of exactness.\nAn $n$-point Gauss-Legendre quadrature rule approximates an integral on the interval $[-1, 1]$ as\n$$\n\\int_{-1}^{1} f(\\xi)\\,d\\xi \\approx \\sum_{i=1}^{n} w_i f(\\xi_i)\n$$\nwhere $\\xi_i$ are the $n$ distinct roots (nodes) of the $n$-th degree Legendre polynomial $P_n(\\xi)$ and $w_i$ are the associated positive weights. We wish to find the maximal degree $d$ of an arbitrary polynomial $q(\\xi)$ for which this approximation is exact.\n\nLet $q(\\xi)$ be a polynomial. By the polynomial division algorithm, we can divide $q(\\xi)$ by $P_n(\\xi)$ to obtain a unique quotient polynomial $k(\\xi)$ and a unique remainder polynomial $r(\\xi)$:\n$$\nq(\\xi) = k(\\xi) P_n(\\xi) + r(\\xi)\n$$\nThe degree of the remainder is strictly less than the degree of the divisor, so $\\deg(r) \\le n-1$. The degree of the quotient is $\\deg(k) = \\deg(q) - \\deg(P_n) = \\deg(q) - n$.\n\nThe exact integral of $q(\\xi)$ is\n$$\nI(q) = \\int_{-1}^{1} q(\\xi)\\,d\\xi = \\int_{-1}^{1} \\left( k(\\xi) P_n(\\xi) + r(\\xi) \\right) d\\xi = \\int_{-1}^{1} k(\\xi) P_n(\\xi)\\,d\\xi + \\int_{-1}^{1} r(\\xi)\\,d\\xi\n$$\nThe quadrature approximation of the integral is\n$$\nQ_n(q) = \\sum_{i=1}^{n} w_i q(\\xi_i)\n$$\nBy definition, the quadrature nodes $\\xi_i$ are the roots of $P_n(\\xi)$, so $P_n(\\xi_i) = 0$ for all $i \\in \\{1, 2, \\dots, n\\}$. Evaluating $q(\\xi)$ at these nodes yields:\n$$\nq(\\xi_i) = k(\\xi_i) P_n(\\xi_i) + r(\\xi_i) = k(\\xi_i) \\cdot 0 + r(\\xi_i) = r(\\xi_i)\n$$\nTherefore, the quadrature sum simplifies to:\n$$\nQ_n(q) = \\sum_{i=1}^{n} w_i r(\\xi_i) = Q_n(r)\n$$\nThe quadrature is exact for $q(\\xi)$ if $I(q) = Q_n(q)$, which implies:\n$$\n\\int_{-1}^{1} k(\\xi) P_n(\\xi)\\,d\\xi + I(r) = Q_n(r)\n$$\nThe $n$ weights $w_i$ can be uniquely determined to make the $n$-point quadrature rule exact for all polynomials of degree up to $n-1$. This is a fundamental property of interpolatory quadrature. Since $\\deg(r) \\le n-1$, it follows that $I(r) = Q_n(r)$.\nWith this established, the condition for exactness for $q(\\xi)$ reduces to:\n$$\n\\int_{-1}^{1} k(\\xi) P_n(\\xi)\\,d\\xi = 0\n$$\nThe set of Legendre polynomials $\\{P_j(\\xi)\\}_{j=0}^{\\infty}$ forms an orthogonal basis for the space of polynomials on $[-1, 1]$ with respect to the unit weight function. Any polynomial, including $k(\\xi)$, can be expressed as a linear combination of Legendre polynomials. Let $\\deg(k) = m$. Then $k(\\xi) = \\sum_{j=0}^{m} c_j P_j(\\xi)$ for some coefficients $c_j$. The integral becomes:\n$$\n\\int_{-1}^{1} \\left( \\sum_{j=0}^{m} c_j P_j(\\xi) \\right) P_n(\\xi)\\,d\\xi = \\sum_{j=0}^{m} c_j \\int_{-1}^{1} P_j(\\xi) P_n(\\xi)\\,d\\xi\n$$\nDue to the orthogonality property, $\\int_{-1}^{1} P_j(\\xi) P_n(\\xi)\\,d\\xi = 0$ for all $j  n$. Thus, the integral is zero if the sum runs only over indices $j  n$, which is true if $m = \\deg(k) \\le n-1$.\nWe have the condition $\\deg(k) = \\deg(q) - n \\le n-1$, which implies $\\deg(q) \\le 2n-1$.\nThus, an $n$-point Gauss-Legendre quadrature is exact for all polynomials of degree up to $2n-1$.\n\nPart 2: Minimal number of quadrature points for $p(\\xi)$.\nThe given integrand is $p(\\xi) = 1 + \\xi + \\xi^{4} + \\xi^{5}$. This is a polynomial of degree $d = 5$. From Part 1, for the quadrature to be exact, we require the maximal degree of exactness, $2n-1$, to be at least the degree of the polynomial, $5$.\n$$\n2n-1 \\ge 5\n$$\n$$\n2n \\ge 6\n$$\n$$\nn \\ge 3\n$$\nThe minimal integer number of quadrature points is therefore $n=3$.\n\nPart 3: Construction of the $3$-point rule and evaluation of the integral.\nFor $n=3$, the rule is exact for polynomials of degree up to $2(3)-1 = 5$. We need to find the $3$ nodes ($\\xi_1, \\xi_2, \\xi_3$) and $3$ weights ($w_1, w_2, w_3$) by enforcing exactness for a basis of polynomials. We use the monomials $\\{1, \\xi, \\xi^2, \\xi^3, \\xi^4, \\xi^5 \\}$.\nDue to the symmetry of the Legendre polynomials and the interval $[-1, 1]$, the nodes and weights are symmetric: $\\xi_2=0$, $\\xi_3=-\\xi_1$, and $w_3=w_1$.\n\n1.  For $f(\\xi) = 1 = \\xi^0$: $\\int_{-1}^{1} 1\\,d\\xi = 2$. Quadrature: $w_1+w_2+w_3 = 2w_1+w_2=2$.\n2.  For $f(\\xi) = \\xi$: $\\int_{-1}^{1} \\xi\\,d\\xi = 0$. Quadrature: $w_1\\xi_1+w_2(0)+w_1(-\\xi_1) = 0$, which is satisfied by symmetry.\n3.  For $f(\\xi) = \\xi^2$: $\\int_{-1}^{1} \\xi^2\\,d\\xi = \\frac{2}{3}$. Quadrature: $w_1\\xi_1^2+w_2(0)^2+w_1(-\\xi_1)^2 = 2w_1\\xi_1^2 = \\frac{2}{3} \\implies w_1\\xi_1^2 = \\frac{1}{3}$.\n4.  For $f(\\xi) = \\xi^3$: $\\int_{-1}^{1} \\xi^3\\,d\\xi = 0$. Quadrature: $w_1\\xi_1^3+w_2(0)^3+w_1(-\\xi_1)^3 = 0$, satisfied by symmetry.\n5.  For $f(\\xi) = \\xi^4$: $\\int_{-1}^{1} \\xi^4\\,d\\xi = \\frac{2}{5}$. Quadrature: $w_1\\xi_1^4+w_2(0)^4+w_1(-\\xi_1)^4 = 2w_1\\xi_1^4 = \\frac{2}{5} \\implies w_1\\xi_1^4 = \\frac{1}{5}$.\n\nWe have the system of equations:\n(a) $2w_1+w_2=2$\n(b) $w_1\\xi_1^2 = \\frac{1}{3}$\n(c) $w_1\\xi_1^4 = \\frac{1}{5}$\n\nDividing (c) by (b): $\\frac{w_1\\xi_1^4}{w_1\\xi_1^2} = \\frac{1/5}{1/3} \\implies \\xi_1^2 = \\frac{3}{5}$.\nThe nodes are $\\xi_1 = -\\sqrt{\\frac{3}{5}}$, $\\xi_2 = 0$, and $\\xi_3 = \\sqrt{\\frac{3}{5}}$.\nSubstitute $\\xi_1^2$ into (b): $w_1(\\frac{3}{5}) = \\frac{1}{3} \\implies w_1 = \\frac{5}{9}$.\nThus, $w_1=w_3=\\frac{5}{9}$.\nSubstitute $w_1$ into (a): $2(\\frac{5}{9}) + w_2 = 2 \\implies w_2 = 2 - \\frac{10}{9} = \\frac{8}{9}$.\n\nThe $3$-point Gauss-Legendre rule is defined by:\nNodes: $\\{\\xi_1, \\xi_2, \\xi_3\\} = \\{-\\sqrt{\\frac{3}{5}}, 0, \\sqrt{\\frac{3}{5}}\\}$\nWeights: $\\{w_1, w_2, w_3\\} = \\{\\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}\\}$\n\nNow we find the value of the integral $I = \\int_{-1}^{1} p(\\xi)\\,d\\xi$ and confirm it with the quadrature.\nFirst, the exact integral:\n$$\nI = \\int_{-1}^{1} (1 + \\xi + \\xi^{4} + \\xi^{5}) \\,d\\xi\n$$\nThe integrals of the odd-powered terms over a symmetric interval are zero.\n$$\nI = \\int_{-1}^{1} (1 + \\xi^{4}) \\,d\\xi = \\left[ \\xi + \\frac{\\xi^5}{5} \\right]_{-1}^{1} = \\left(1 + \\frac{1}{5}\\right) - \\left(-1 - \\frac{1}{5}\\right) = 2 \\left(1 + \\frac{1}{5}\\right) = 2 \\left(\\frac{6}{5}\\right) = \\frac{12}{5}\n$$\nNext, the quadrature evaluation:\n$Q_3(p) = \\frac{5}{9}p(-\\sqrt{\\frac{3}{5}}) + \\frac{8}{9}p(0) + \\frac{5}{9}p(\\sqrt{\\frac{3}{5}})$.\n$p(0) = 1+0+0+0 = 1$.\n$p(\\sqrt{\\frac{3}{5}}) = 1 + \\sqrt{\\frac{3}{5}} + (\\frac{3}{5})^2 + (\\frac{3}{5})^2\\sqrt{\\frac{3}{5}} = 1 + \\frac{9}{25} + \\sqrt{\\frac{3}{5}}(1+\\frac{9}{25}) = \\frac{34}{25} + \\frac{34}{25}\\sqrt{\\frac{3}{5}}$.\n$p(-\\sqrt{\\frac{3}{5}}) = 1 - \\sqrt{\\frac{3}{5}} + (\\frac{3}{5})^2 - (\\frac{3}{5})^2\\sqrt{\\frac{3}{5}} = 1 + \\frac{9}{25} - \\sqrt{\\frac{3}{5}}(1+\\frac{9}{25}) = \\frac{34}{25} - \\frac{34}{25}\\sqrt{\\frac{3}{5}}$.\n$$\nQ_3(p) = \\frac{5}{9}\\left[ \\left(\\frac{34}{25} - \\frac{34}{25}\\sqrt{\\frac{3}{5}}\\right) + \\left(\\frac{34}{25} + \\frac{34}{25}\\sqrt{\\frac{3}{5}}\\right) \\right] + \\frac{8}{9}(1)\n$$\n$$\nQ_3(p) = \\frac{5}{9}\\left[ 2 \\cdot \\frac{34}{25} \\right] + \\frac{8}{9} = \\frac{5}{9} \\frac{68}{25} + \\frac{8}{9} = \\frac{1}{9} \\frac{68}{5} + \\frac{8}{9} = \\frac{68}{45} + \\frac{40}{45} = \\frac{108}{45}\n$$\nSimplifying the fraction gives $\\frac{108}{45} = \\frac{12 \\cdot 9}{5 \\cdot 9} = \\frac{12}{5}$.\nThe quadrature value matches the exact integral, confirming the derivation. The minimal number of points is $n=3$ and the exact value of the integral is $I=\\frac{12}{5}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  \\frac{12}{5}\n\\end{pmatrix}\n}\n$$", "id": "3585301"}, {"introduction": "Building on the fundamental theory, this practice [@problem_id:3585231] transitions to a common application in two-dimensional finite element analysis: calculating nodal forces from a distributed source. You will analyze the complete integrand, including shape functions and the Jacobian of the mapping, to determine the appropriate quadrature rule. This exercise highlights a crucial insight that for many common element formulations, numerical integration is not an approximation but a means of exact and efficient evaluation.", "problem": "Consider a two-dimensional scalar diffusion-type problem discretized by an isoparametric bilinear quadrilateral element (commonly denoted as a $Q1$ element). Let the physical coordinates of the element nodes be $\\{(x_{i},y_{i})\\}_{i=1}^{4}$, ordered counterclockwise. The isoparametric mapping from the reference square with local coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ to the physical element is given by\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i},\n$$\nwith the standard bilinear shape functions\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\nLet the body source per unit area be affine in the physical coordinates,\n$$\nq(x,y)=\\alpha\\,x+\\beta\\,y+\\gamma,\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are constants. The equivalent nodal load vector $\\boldsymbol{f}_{e}\\in\\mathbb{R}^{4}$ is defined by the weak form as\n$$\nf_{i}=\\int_{\\Omega_{e}}N_{i}(x,y)\\,q(x,y)\\,\\mathrm{d}\\Omega,\\qquad i=1,2,3,4.\n$$\nUsing the isoparametric mapping, this integral can be written on the reference square as\n$$\nf_{i}=\\int_{-1}^{1}\\int_{-1}^{1}N_{i}(\\xi,\\eta)\\,q\\!\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $\\mathbf{J}(\\xi,\\eta)$ is the Jacobian of the mapping and $\\det\\mathbf{J}(\\xi,\\eta)$ its determinant.\n\nTask:\n- Compute the nodal equivalent load vector $\\boldsymbol{f}_{e}$ using the standard $2\\times 2$ Gaussian quadrature rule on $[-1,1]^{2}$, that is, with points $(\\xi_{k},\\eta_{k})\\in\\{(-s,-s),(+s,-s),(+s,+s),(-s,+s)\\}$, where $s=1/\\sqrt{3}$, and unit weights in each direction.\n- Write your result explicitly in terms of $\\alpha$, $\\beta$, $\\gamma$, the nodal coordinates $\\{(x_{i},y_{i})\\}_{i=1}^{4}$, the shape functions evaluated at the Gaussian points, and the Jacobian determinant evaluated at the Gaussian points.\n- Then, verify from first principles of polynomial exactness that this $2\\times 2$ quadrature yields the exact value of $\\boldsymbol{f}_{e}$ for any bilinear quadrilateral geometry and any affine $q(x,y)$ as given above.\n\nFor compactness in your final expression, you may use the shorthand $N_{ik}=N_{i}(\\xi_{k},\\eta_{k})$, $x_{k}=x(\\xi_{k},\\eta_{k})$, $y_{k}=y(\\xi_{k},\\eta_{k})$, and $J_{k}=\\det\\mathbf{J}(\\xi_{k},\\eta_{k})$ for $k=1,2,3,4$ with $(\\xi_{k},\\eta_{k})$ ordered as listed above. Express your final answer as a $1\\times 4$ row matrix containing the four components of $\\boldsymbol{f}_{e}$ in this quadrature form. No numerical evaluation or rounding is required, and no units need be reported. The final answer must be a single closed-form analytic expression as specified.", "solution": "The problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe data, variables, and conditions provided in the problem statement are:\n- **Element Type**: A two-dimensional isoparametric bilinear quadrilateral element, denoted as a $Q1$ element.\n- **Nodal Coordinates**: Physical coordinates of the element nodes are $\\{(x_{i},y_{i})\\}_{i=1}^{4}$, ordered counterclockwise.\n- **Reference Domain**: Local coordinates $(\\xi,\\eta)$ are defined on the reference square $[-1,1]\\times[-1,1]$.\n- **Isoparametric Mapping**:\n  - $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i}$\n  - $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i}$\n- **Shape Functions**: The standard bilinear shape functions are:\n  - $N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$\n  - $N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$\n  - $N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$\n  - $N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$\n- **Source Term**: The body source per unit area is an affine function $q(x,y)=\\alpha\\,x+\\beta\\,y+\\gamma$, with $\\alpha$, $\\beta$, $\\gamma$ being constants.\n- **Nodal Load Vector**: The $i$-th component of the equivalent nodal load vector $\\boldsymbol{f}_{e}\\in\\mathbb{R}^{4}$ is defined by the integral $f_{i}=\\int_{\\Omega_{e}}N_{i}(x,y)\\,q(x,y)\\,\\mathrm{d}\\Omega$.\n- **Transformed Integral**: The integral on the reference square is $f_{i}=\\int_{-1}^{1}\\int_{-1}^{1}N_{i}(\\xi,\\eta)\\,q\\!\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$.\n- **Numerical Quadrature**: A $2\\times 2$ Gaussian quadrature rule is to be used.\n  - Quadrature points: $(\\xi_{k},\\eta_{k})\\in\\{(-s,-s),(+s,-s),(+s,+s),(-s,+s)\\}$ for $k=1,2,3,4$ respectively, where $s=1/\\sqrt{3}$.\n  - Quadrature weights: Unit weights in each direction, hence the weight for each $2$D point is $1$.\n- **Shorthand Notation**: $N_{ik}=N_{i}(\\xi_{k},\\eta_{k})$, $x_{k}=x(\\xi_{k},\\eta_{k})$, $y_{k}=y(\\xi_{k},\\eta_{k})$, and $J_{k}=\\det\\mathbf{J}(\\xi_{k},\\eta_{k})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined within the standard theory of the Finite Element Method (FEM).\n- **Scientifically Grounded**: All concepts, including isoparametric mapping, bilinear shape functions, weak form integrals for source terms, and Gaussian quadrature, are fundamental and correct principles in computational mechanics and numerical analysis.\n- **Well-Posed**: The problem is unambiguous and provides all necessary information to compute the requested quantity and perform the verification. A unique solution for the numerically integrated load vector exists.\n- **Objective**: The language is precise and mathematical. There are no subjective or opinion-based statements.\n- **Completeness**: The problem is self-contained. The geometry, source term, and numerical method are all specified.\n- **Consistency**: There are no internal contradictions in the provided data or definitions. The task of verifying exactness is a standard exercise that highlights an important property of the chosen numerical scheme for this specific integrand.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-posed, standard exercise in the field of computational solid mechanics. The solution process will now proceed.\n\n### Solution\n\nThe task is twofold: first, to compute the nodal equivalent load vector $\\boldsymbol{f}_{e}$ using a specified quadrature rule, and second, to verify that this numerical integration is exact.\n\n#### Part 1: Computation of the Nodal Load Vector\n\nThe $i$-th component of the equivalent nodal load vector, $f_i$, is given by the integral over the reference element:\n$$\nf_{i}=\\int_{-1}^{1}\\int_{-1}^{1}N_{i}(\\xi,\\eta)\\,q\\!\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nWe are instructed to evaluate this integral using a $2\\times 2$ Gaussian quadrature rule. The rule approximates the integral of a function $g(\\xi, \\eta)$ over the domain $[-1,1]^2$ as a weighted sum of the function values at four specific quadrature points:\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} g(\\xi,\\eta) \\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta \\approx \\sum_{k=1}^{4} w_{k} g(\\xi_{k},\\eta_{k})\n$$\nIn this problem, the quadrature points are $(\\xi_k, \\eta_k)$ for $k=1,2,3,4$ with $s=1/\\sqrt{3}$:\n- $(\\xi_1, \\eta_1) = (-s, -s)$\n- $(\\xi_2, \\eta_2) = (s, -s)$\n- $(\\xi_3, \\eta_3) = (s, s)$\n- $(\\xi_4, \\eta_4) = (-s, s)$\n\nThe weights are specified as unit weights, i.e., $w_k = 1$ for all $k=1,2,3,4$. The integrand is $g(\\xi,\\eta) = N_{i}(\\xi,\\eta)\\,q(x(\\xi,\\eta),y(\\xi,\\eta))\\,\\det\\mathbf{J}(\\xi,\\eta)$.\n\nApplying the quadrature rule, the component $f_i$ is approximated as:\n$$\nf_{i} \\approx \\sum_{k=1}^{4} (1) \\cdot N_{i}(\\xi_{k},\\eta_{k})\\,q\\!\\big(x(\\xi_{k},\\eta_{k}),y(\\xi_{k},\\eta_{k})\\big)\\,\\det\\mathbf{J}(\\xi_{k},\\eta_{k})\n$$\nUsing the specified shorthand notation:\n- $N_{ik} = N_{i}(\\xi_{k},\\eta_{k})$\n- $x_{k} = x(\\xi_{k},\\eta_{k}) = \\sum_{j=1}^{4}N_{j}(\\xi_{k},\\eta_{k})x_{j}$\n- $y_{k} = y(\\xi_{k},\\eta_{k}) = \\sum_{j=1}^{4}N_{j}(\\xi_{k},\\eta_{k})y_{j}$\n- $J_{k} = \\det\\mathbf{J}(\\xi_{k},\\eta_{k})$\n\nAnd substituting the source term $q(x,y) = \\alpha x + \\beta y + \\gamma$, we get:\n$$\nq(x_k, y_k) = \\alpha x_k + \\beta y_k + \\gamma\n$$\nThe expression for $f_i$ becomes:\n$$\nf_{i} \\approx \\sum_{k=1}^{4} N_{ik} \\, (\\alpha x_{k} + \\beta y_k + \\gamma) \\, J_{k}\n$$\nThis expression can be assembled for each component $i=1,2,3,4$ to form the nodal load vector $\\boldsymbol{f}_{e} = \\begin{pmatrix} f_1  f_2  f_3  f_4 \\end{pmatrix}$. This provides the explicit form requested.\n\n#### Part 2: Verification of Exactness\n\nWe must verify that the $2\\times 2$ Gaussian quadrature yields the exact value for the integral. A tensor-product $n$-point Gaussian quadrature rule on $[-1,1]^2$ exactly integrates any polynomial that is of degree at most $2n-1$ in each variable $\\xi$ and $\\eta$ independently. For the $2\\times 2$ rule, $n=2$, so it is exact for polynomials of degree up to $2(2)-1=3$ in $\\xi$ and up to degree $3$ in $\\eta$.\n\nTo prove exactness, we must analyze the polynomial degree of the integrand, $I_i(\\xi, \\eta) = N_{i}(\\xi,\\eta)\\,q(x(\\xi,\\eta),y(\\xi,\\eta))\\,\\det\\mathbf{J}(\\xi,\\eta)$, with respect to the local coordinates $\\xi$ and $\\eta$.\n\n1.  **Shape functions $N_i(\\xi, \\eta)$**: The shape functions $N_i(\\xi,\\eta) = \\frac{1}{4}(1\\pm\\xi)(1\\pm\\eta)$ are bilinear. They are polynomials of degree $1$ in $\\xi$ and degree $1$ in $\\eta$. Let us denote such a polynomial as being in the space $P_{11}$.\n\n2.  **Source term $q(x(\\xi,\\eta),y(\\xi,\\eta))$**: The physical coordinates $x$ and $y$ are given by the isoparametric mapping $x(\\xi,\\eta)=\\sum_{j=1}^4 N_j(\\xi,\\eta)x_j$ and $y(\\xi,\\eta)=\\sum_{j=1}^4 N_j(\\xi,\\eta)y_j$. Since this is a linear combination of the bilinear shape functions $N_j$, both $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$ are themselves bilinear polynomials in $\\xi$ and $\\eta$ (i.e., they belong to $P_{11}$).\n    The source term is $q(x,y) = \\alpha x + \\beta y + \\gamma$. When expressed in local coordinates, $q(\\xi,\\eta) = \\alpha x(\\xi,\\eta) + \\beta y(\\xi,\\eta) + \\gamma$. As a linear combination of functions in $P_{11}$, $q(\\xi,\\eta)$ is also a bilinear polynomial in $\\xi$ and $\\eta$, hence it belongs to $P_{11}$.\n\n3.  **Jacobian determinant $\\det\\mathbf{J}(\\xi, \\eta)$**: The Jacobian matrix of the transformation is $\\mathbf{J} = \\begin{pmatrix} \\partial x / \\partial \\xi  \\partial y / \\partial \\xi \\\\ \\partial x / \\partial \\eta  \\partial y / \\partial \\eta \\end{pmatrix}$.\n    The derivatives of the shape functions have the form $\\partial N_j/\\partial\\xi = c_j(1\\pm\\eta)$ and $\\partial N_j/\\partial\\eta = d_j(1\\pm\\xi)$, where $c_j, d_j$ are constants.\n    - The terms $\\partial x/\\partial\\xi = \\sum_j (\\partial N_j/\\partial\\xi)x_j$ and $\\partial y/\\partial\\xi = \\sum_j (\\partial N_j/\\partial\\xi)y_j$ are linear in $\\eta$ and constant in $\\xi$.\n    - The terms $\\partial x/\\partial\\eta = \\sum_j (\\partial N_j/\\partial\\eta)x_j$ and $\\partial y/\\partial\\eta = \\sum_j (\\partial N_j/\\partial\\eta)y_j$ are linear in $\\xi$ and constant in $\\eta$.\n    The determinant is $\\det\\mathbf{J} = (\\partial x / \\partial \\xi)(\\partial y / \\partial \\eta) - (\\partial y / \\partial \\xi)(\\partial x / \\partial \\eta)$.\n    Let's represent the components as polynomials:\n    - $\\partial x/\\partial \\xi = A_1+B_1\\eta$\n    - $\\partial y/\\partial \\xi = C_1+D_1\\eta$\n    - $\\partial x/\\partial \\eta = A_2+B_2\\xi$\n    - $\\partial y/\\partial \\eta = C_2+D_2\\xi$\n    where the coefficients $A_1, B_1, \\dots, D_2$ are constants depending on the nodal coordinates.\n    Then, the determinant is:\n    $$\n    \\det\\mathbf{J}(\\xi,\\eta) = (A_1+B_1\\eta)(C_2+D_2\\xi) - (C_1+D_1\\eta)(A_2+B_2\\xi)\n    $$\n    Expanding this product gives a polynomial containing terms $1$, $\\xi$, $\\eta$, and $\\xi\\eta$. Thus, $\\det\\mathbf{J}(\\xi,\\eta)$ is a bilinear polynomial in $\\xi$ and $\\eta$, belonging to $P_{11}$. This holds for any general (non-degenerate) quadrilateral geometry defined by the nodal coordinates.\n\n4.  **Total Integrand**: The integrand $I_i(\\xi, \\eta)$ is the product of three functions, each of which is a bilinear polynomial in $P_{11}$:\n    $$\n    I_i(\\xi, \\eta) = \\underbrace{N_{i}(\\xi,\\eta)}_{\\in P_{11}} \\times \\underbrace{q(\\xi,\\eta)}_{\\in P_{11}} \\times \\underbrace{\\det\\mathbf{J}(\\xi,\\eta)}_{\\in P_{11}}\n    $$\n    The product of a polynomial of degree $m_1$ in $\\xi$ and another of degree $m_2$ in $\\xi$ is a polynomial of degree $m_1+m_2$ in $\\xi$.\n    The highest degree of $\\xi$ in $I_i$ is $1+1+1=3$.\n    The highest degree of $\\eta$ in $I_i$ is $1+1+1=3$.\n    Therefore, the integrand $I_i(\\xi, \\eta)$ is a polynomial of degree at most $3$ in $\\xi$ and at most $3$ in $\\eta$.\n\nSince the $2\\times 2$ Gaussian quadrature rule exactly integrates all polynomials of degree up to $3$ in each variable independently, the numerical approximation is, in fact, exact for this specific problem. The use of \"$\\approx$\" in Part 1 was a formality of introducing a quadrature rule; for this specific case, it can be replaced by an equality. Thus, the computed vector is the exact load vector.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sum_{k=1}^{4} J_{k} N_{1k} (\\alpha x_{k} + \\beta y_{k} + \\gamma)  \\sum_{k=1}^{4} J_{k} N_{2k} (\\alpha x_{k} + \\beta y_{k} + \\gamma)  \\sum_{k=1}^{4} J_{k} N_{3k} (\\alpha x_{k} + \\beta y_{k} + \\gamma)  \\sum_{k=1}^{4} J_{k} N_{4k} (\\alpha x_{k} + \\beta y_{k} + \\gamma) \\end{pmatrix}}\n$$", "id": "3585231"}, {"introduction": "The choice of a quadrature rule involves critical trade-offs between computational cost and accuracy. This advanced practice [@problem_id:3585291] delves into the consequences of \"under-integration\" by comparing the stiffness matrix of a bilinear element computed with full and reduced quadrature rules. By analyzing the eigenvalues of these matrices, you will uncover the origin of non-physical \"hourglass\" modes, a phenomenon essential for any computational engineer to understand for building stable and reliable models.", "problem": "Consider a single four-node bilinear quadrilateral (often called $Q1$) finite element in the Finite Element Method (FEM) for linear elasticity under plane strain. The element occupies the unit square in physical coordinates with vertices at $(0,0)$, $(1,0)$, $(1,1)$, and $(0,1)$ and has constant thickness $t0$. The material is homogeneous, isotropic, linearly elastic with Young’s modulus $E0$ and Poisson’s ratio $\\nu$ satisfying $0\\nu\\frac{1}{2}$. The in-plane displacement field is interpolated with the standard bilinear shape functions defined on the bi-unit parent square $[-1,1]\\times[-1,1]$, and the isoparametric map from parent coordinates $(\\xi,\\eta)$ to physical coordinates $(x,y)$ is affine for this unit square, with $\\det J=\\frac{1}{4}$.\n\nStart from first principles of linear elasticity: the element stiffness matrix $K_{e}$ arises from the quadratic form of the total strain energy $U=\\frac{t}{2}\\int_{\\Omega_{e}} \\varepsilon^{T} D\\, \\varepsilon \\,\\mathrm{d}\\Omega$, where $\\varepsilon=B\\,d$ is the linearized strain expressed via the strain-displacement matrix $B$ and the nodal displacement vector $d\\in\\mathbb{R}^{8}$, and $D$ is the symmetric positive-definite $3\\times 3$ constitutive matrix for plane strain. Thus,\n$$\nK_{e}=t\\int_{\\Omega_{e}} B^{T} D\\, B\\, \\mathrm{d}\\Omega.\n$$\nUsing Gaussian Quadrature (GQ), assemble $K_{e}$ in two ways: \n(i) the reduced $1\\times 1$ rule with a single parent-space evaluation at $(\\xi,\\eta)=(0,0)$ with weight $w=4$, and \n(ii) the full $2\\times 2$ rule with parent-space points $(\\pm \\frac{1}{\\sqrt{3}},\\pm \\frac{1}{\\sqrt{3}})$ each with weight $w=1$. For both rules, include the Jacobian determinant factor $\\det J=\\frac{1}{4}$ and assume exact mapping for the unit square so that the Jacobian is constant.\n\nCompute and compare the spectra (eigenvalues with algebraic multiplicities) of the two element stiffness matrices. Identify the rigid body modes and any additional zero-energy modes that appear due to underintegration. As your final answer, report the number of additional zero eigenvalues introduced by the $1\\times 1$ quadrature rule relative to the $2\\times 2$ quadrature rule. Provide this final answer as a single integer. No rounding is needed and no physical units are required in the final answer.", "solution": "The user wants me to determine the number of additional zero-energy modes (zero eigenvalues of the stiffness matrix) when using a reduced $1 \\times 1$ Gaussian Quadrature (GQ) rule compared to a full $2 \\times 2$ GQ rule for a four-node bilinear quadrilateral ($Q1$) element under plane strain.\n\nThe problem is first validated.\n\n### Step 1: Extract Givens\n-   **Element**: Four-node bilinear quadrilateral ($Q1$) for plane strain.\n-   **Physical Coordinates**: Vertices at $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$ (a unit square).\n-   **Parent Coordinates**: Bilinear shape functions on a bi-unit square $[-1,1]\\times[-1,1]$.\n-   **Material Properties**: Homogeneous, isotropic, linear elastic with Young's modulus $E0$ and Poisson's ratio $0  \\nu  1/2$.\n-   **Thickness**: Constant, $t0$.\n-   **Stiffness Matrix Formula**: $K_{e} = t \\int_{\\Omega_{e}} B^{T} D B \\, \\mathrm{d}\\Omega$.\n-   **Kinematics**: Strain $\\varepsilon = B d$, where $d \\in \\mathbb{R}^{8}$ is the nodal displacement vector.\n-   **Constitutive Matrix**: $D$ is the symmetric positive-definite $3 \\times 3$ matrix for plane strain.\n-   **Mapping**: Isoparametric, with constant Jacobian determinant $\\det J = 1/4$.\n-   **Integration Rules**:\n    -   (i) Reduced $1 \\times 1$ GQ: single point $(\\xi,\\eta)=(0,0)$, weight $w=4$.\n    -   (ii) Full $2 \\times 2$ GQ: four points $(\\pm \\frac{1}{\\sqrt{3}},\\pm \\frac{1}{\\sqrt{3}})$, each with weight $w=1$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Groundedness**: The problem is a standard, fundamental exercise in computational solid mechanics, specifically the Finite Element Method (FEM). All concepts, including the $Q1$ element, plane strain elasticity, numerical integration, and the phenomenon of hourglassing, are well-established scientific principles.\n-   **Well-Posedness**: The problem is clearly stated with all necessary information to derive a unique, deterministic integer answer.\n-   **Objectivity**: The language is precise, technical, and free of any subjectivity.\n\nThe problem is self-contained, scientifically sound, and well-posed. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution will be provided.\n\n### Solution Derivation\n\nThe stiffness matrix for a finite element is given by:\n$$ K_{e} = t \\int_{\\Omega_{e}} B^{T} D B \\, \\mathrm{d}A $$\nwhere $t$ is the element thickness, $B$ is the strain-displacement matrix, and $D$ is the material constitutive matrix. The integral is over the element's area $\\Omega_e$. Using an isoparametric mapping from parent coordinates $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ to physical coordinates $(x,y)$, the integral becomes:\n$$ K_{e} = t \\int_{-1}^{1} \\int_{-1}^{1} B(\\xi, \\eta)^{T} D B(\\xi, \\eta) \\det(J) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta $$\nThe problem states that $\\det(J) = 1/4$ is constant. The number of zero eigenvalues of $K_e$ is equal to the dimension of its null space. A nodal displacement vector $d$ is in the null space of $K_e$ if and only if it corresponds to a zero-energy mode, i.e., $d^T K_e d = 0$.\n$$ d^T K_e d = t \\int_{-1}^{1} \\int_{-1}^{1} d^T B^{T} D B d \\, \\mathrm{d}\\xi \\mathrm{d}\\eta \\det(J) = t \\det(J) \\int_{-1}^{1} \\int_{-1}^{1} \\varepsilon(\\xi, \\eta)^{T} D \\varepsilon(\\xi, \\eta) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = 0 $$\nwhere $\\varepsilon = B d$. Since the material is elastic ($t0, E0, 0\\nu1/2$), the constitutive matrix $D$ is symmetric positive-definite. This means the integrand $\\varepsilon^T D \\varepsilon$ is always non-negative. For the integral to be zero, the integrand must be zero throughout the domain of integration.\n\nFor a $Q1$ element with an affine mapping (as we have for a parallelogram), the strain-displacement matrix $B(\\xi, \\eta)$ is a linear function of $\\xi$ and $\\eta$. Consequently, the integrand $B(\\xi, \\eta)^{T} D B(\\xi, \\eta)$ is a matrix whose entries are quadratic polynomials in $\\xi$ and $\\eta$.\n\n**Case (ii): Full $2 \\times 2$ Gaussian Quadrature**\n\nA $2 \\times 2$ GQ rule uses $4$ points and integrates polynomials of degree up to $2(2)-1=3$ in each variable exactly. Since our integrand is quadratic, this rule is exact. Let this matrix be $K_{e, \\text{full}}$. The quadrature approximation becomes an equality:\n$$ d^T K_{e, \\text{full}} d = t \\det(J) \\sum_{i=1}^{4} w_i \\left( \\varepsilon(\\xi_i, \\eta_i)^T D \\varepsilon(\\xi_i, \\eta_i) \\right) = 0 $$\nwhere the quadrature points are $(\\xi_i, \\eta_i) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$ and weights are $w_i=1$. Since $D$ is positive-definite, this sum is zero if and only if each term is zero.\n$$ \\varepsilon(\\xi_i, \\eta_i)^T D \\varepsilon(\\xi_i, \\eta_i) = 0 \\quad \\implies \\quad \\varepsilon(\\xi_i, \\eta_i) = B(\\xi_i, \\eta_i) d = 0 \\quad \\text{for } i=1,2,3,4. $$\nThe components of the strain vector $\\varepsilon = [\\varepsilon_x, \\varepsilon_y, \\gamma_{xy}]^T$ are themselves linear functions of $\\xi$ and $\\eta$. For example, $\\varepsilon_x(\\xi, \\eta)=c_0+c_1\\xi+c_2\\eta$. If a linear function is zero at all four Gauss points, it must be identically zero everywhere.\nTherefore, a mode $d$ is a zero-energy mode for the fully integrated element if and only if it produces zero strain everywhere, i.e., $\\varepsilon(\\xi, \\eta) \\equiv 0$ for all $(\\xi, \\eta)$.\nThe only displacement fields that produce zero strain are rigid body motions. For a 2D body, there are 3 such motions:\n1.  Translation in the $x$-direction.\n2.  Translation in the $y$-direction.\n3.  Infinitesimal rotation about an axis perpendicular to the plane.\n\nThese 3 modes span the null space of $K_{e, \\text{full}}$. Since $K_{e, \\text{full}}$ is an $8 \\times 8$ matrix, its rank is $8-3=5$. The number of zero eigenvalues for the fully integrated stiffness matrix is 3.\n\n**Case (i): Reduced $1 \\times 1$ Gaussian Quadrature**\n\nA $1 \\times 1$ GQ rule uses a single point $(\\xi, \\eta)=(0,0)$ with weight $w=4$. This rule only integrates polynomials of degree up to $2(1)-1=1$ exactly, so it is an approximation for our quadratic integrand. Let this matrix be $K_{e, \\text{red}}$.\n$$ K_{e, \\text{red}} = t \\cdot \\det(J) \\cdot w \\cdot B(0,0)^T D B(0,0) = t \\cdot \\frac{1}{4} \\cdot 4 \\cdot B(0,0)^T D B(0,0) = t B(0,0)^T D B(0,0) $$\nA mode $d$ is a zero-energy mode if $d^T K_{e, \\text{red}} d = 0$, which implies:\n$$ t (B(0,0) d)^T D (B(0,0) d) = 0 $$\nSince $t0$ and $D$ is positive-definite, this requires $\\varepsilon(0,0) = B(0,0) d = 0$. The strain must be zero *only at the element's center*. This is a much weaker condition than for the fully integrated element.\n\nTo find the dimension of the null space, we need the rank of $K_{e, \\text{red}}$. The rank of $K_{e, \\text{red}}$ is equal to the rank of $B(0,0)$. The strain-displacement matrix is:\n$$ B(\\xi, \\eta) = \\frac{1}{2} \\begin{pmatrix} -(1-\\eta)  0  (1-\\eta)  0  (1+\\eta)  0  -(1+\\eta)  0 \\\\ 0  -(1-\\xi)  0  -(1+\\xi)  0  (1+\\xi)  0  (1-\\xi) \\\\ -(1-\\xi)  -(1-\\eta)  -(1+\\xi)  (1-\\eta)  (1+\\xi)  (1+\\eta)  (1-\\xi)  -(1+\\eta) \\end{pmatrix} $$\nEvaluating at $(\\xi, \\eta) = (0,0)$:\n$$ B(0,0) = \\frac{1}{2} \\begin{pmatrix} -1  0  1  0  1  0  -1  0 \\\\ 0  -1  0  -1  0  1  0  1 \\\\ -1  -1  -1  1  1  1  1  -1 \\end{pmatrix} $$\nThis is a $3 \\times 8$ matrix. Its rank can be at most $3$. The three rows of $B(0,0)$ can be shown to be linearly independent. Therefore, $\\text{rank}(B(0,0))=3$.\nThe rank of $K_{e, \\text{red}}$ is also $3$.\nThe dimension of the null space of $K_{e, \\text{red}}$ is given by the nullity, which is $8 - \\text{rank}(K_{e, \\text{red}}) = 8 - 3 = 5$.\nSo, the number of zero eigenvalues for the reduced-integration stiffness matrix is 5.\n\nThese $5$ zero-energy modes include the $3$ rigid body motions (which have zero strain everywhere, and thus at the center) and $2$ additional modes. These additional modes have zero strain at the center but non-zero strain elsewhere. They are spurious, non-physical modes known as \"hourglass\" modes.\n\n**Comparison and Final Answer**\n\n- Number of zero eigenvalues for full ($2 \\times 2$) integration: $3$ (corresponding to rigid body modes).\n- Number of zero eigenvalues for reduced ($1 \\times 1$) integration: $5$ (corresponding to $3$ rigid body modes and $2$ hourglass modes).\n\nThe number of additional zero eigenvalues introduced by the $1 \\times 1$ quadrature rule relative to the $2 \\times 2$ quadrature rule is the difference:\n$$ 5 - 3 = 2 $$", "answer": "$$ \\boxed{2} $$", "id": "3585291"}]}