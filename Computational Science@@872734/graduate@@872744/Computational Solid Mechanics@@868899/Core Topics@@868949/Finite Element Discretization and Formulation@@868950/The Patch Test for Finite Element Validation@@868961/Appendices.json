{"hands_on_practices": [{"introduction": "Understanding the patch test begins with translating a continuous physical state into the discrete language of the finite element method. This exercise provides fundamental practice in this translation by starting with a prescribed uniform strain field, $\\varepsilon_{xx}=\\varepsilon_0$. You will derive the corresponding linear displacement field and then determine the exact nodal displacements for a simple patch of elements, illustrating how a passing element formulation should precisely capture this constant strain state from correct nodal data.", "problem": "Consider a square two-by-two patch of bilinear isoparametric quadrilateral elements used in the Finite Element Method (FEM) for small-strain, linear elasticity under plane stress. The physical domain is the square $[0,L] \\times [0,L]$, partitioned into four equal elements by a uniform grid with nodal coordinates at\n$$(x_i,y_i) \\in \\{0,\\tfrac{L}{2},L\\} \\times \\{0,\\tfrac{L}{2},L\\},$$\nand the nodes numbered left-to-right, bottom-to-top as follows:\n$$\n\\text{Node }1:(0,0),\\quad \\text{Node }2:(\\tfrac{L}{2},0),\\quad \\text{Node }3:(L,0),\\\\\n\\text{Node }4:(0,\\tfrac{L}{2}),\\quad \\text{Node }5:(\\tfrac{L}{2},\\tfrac{L}{2}),\\quad \\text{Node }6:(L,\\tfrac{L}{2}),\\\\\n\\text{Node }7:(0,L),\\quad \\text{Node }8:(\\tfrac{L}{2},L),\\quad \\text{Node }9:(L,L).\n$$\nAssume small-strain kinematics where the in-plane strains are defined by\n$$\\varepsilon_{xx}=\\frac{\\partial u}{\\partial x},\\quad \\varepsilon_{yy}=\\frac{\\partial v}{\\partial y},\\quad \\gamma_{xy}=\\frac{\\partial u}{\\partial y}+\\frac{\\partial v}{\\partial x},$$\nwith displacement components $u(x,y)$ and $v(x,y)$. A uniform strain state is prescribed on the entire patch:\n$$\\varepsilon_{xx}=\\varepsilon_0,\\quad \\varepsilon_{yy}=0,\\quad \\gamma_{xy}=0,$$\nwith rigid-body translation and rotation fixed by the constraints that $u(0,0)=0$ and $v(0,0)=0$. The material is linear elastic, homogeneous, and isotropic with Young’s modulus $E$ and Poisson’s ratio $\\nu$, and the stress-strain relation is that of plane stress.\n\nTasks:\n1. Starting from the small-strain kinematic definitions and the uniform strain specification, derive the exact displacement field $(u(x,y),v(x,y))$ consistent with the constraints, and then construct the global nodal displacement vector for the nine-node patch ordered as $\\left[u_1, v_1, u_2, v_2, \\dots, u_9, v_9\\right]$.\n2. Using the fact that bilinear isoparametric quadrilateral elements reproduce globally linear displacement fields exactly when nodal values are taken from the exact field, deduce the assembled stress field produced by the patch under plane stress. Express your stress components $\\sigma_{xx}$, $\\sigma_{yy}$, and $\\tau_{xy}$ symbolically in terms of $E$, $\\nu$, and $\\varepsilon_0$.\n\nExpress displacement units in meters and stress units in Pascals. The final answer must be a single row matrix containing the ordered nodal displacement components followed by the three stress components, all in closed-form analytic expressions. No rounding is required.", "solution": "The problem requires the determination of nodal displacements and the resulting stress state for a patch of finite elements under a prescribed uniform strain field. The solution proceeds in two main parts: first, deriving the exact displacement field and the corresponding nodal displacements, and second, using the properties of the finite elements to determine the stress field.\n\nPart 1: Derivation of the Exact Displacement Field and Nodal Displacements\n\nThe problem specifies a uniform strain state throughout the domain:\n$$ \\varepsilon_{xx} = \\varepsilon_0 $$\n$$ \\varepsilon_{yy} = 0 $$\n$$ \\gamma_{xy} = 0 $$\n\nThe small-strain kinematic relations are given as:\n$$ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n\nWe integrate these relations to find the displacement field $(u(x,y), v(x,y))$.\nFrom $\\frac{\\partial u}{\\partial x} = \\varepsilon_0$, we integrate with respect to $x$ to obtain:\n$$ u(x,y) = \\int \\varepsilon_0 \\, dx = \\varepsilon_0 x + f(y) $$\nwhere $f(y)$ is an arbitrary function of $y$.\n\nFrom $\\frac{\\partial v}{\\partial y} = 0$, we integrate with respect to $y$ to obtain:\n$$ v(x,y) = \\int 0 \\, dy = g(x) $$\nwhere $g(x)$ is an arbitrary function of $x$.\n\nNext, we use the shear strain condition $\\gamma_{xy} = 0$:\n$$ \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = 0 $$\nSubstituting the expressions for $u$ and $v$:\n$$ \\frac{\\partial}{\\partial y}(\\varepsilon_0 x + f(y)) + \\frac{\\partial}{\\partial x}(g(x)) = 0 $$\n$$ \\frac{df}{dy} + \\frac{dg}{dx} = 0 \\implies \\frac{df}{dy} = -\\frac{dg}{dx} $$\nSince the left side is a function of $y$ only and the right side is a function of $x$ only, they must both be equal to a constant, which we will call $C_1$.\n$$ \\frac{df}{dy} = C_1 \\implies f(y) = \\int C_1 \\, dy = C_1 y + C_2 $$\n$$ \\frac{dg}{dx} = -C_1 \\implies g(x) = \\int -C_1 \\, dx = -C_1 x + C_3 $$\nHere, $C_2$ and $C_3$ are constants of integration.\n\nSubstituting these functions back gives the general displacement field for the prescribed uniform strain state:\n$$ u(x,y) = \\varepsilon_0 x + C_1 y + C_2 $$\n$$ v(x,y) = -C_1 x + C_3 $$\nThe terms involving $C_1, C_2, C_3$ represent rigid-body motion. $(C_2, C_3)$ is a uniform translation, and the terms $C_1 y$ and $-C_1 x$ represent a small rigid-body rotation about the origin. The problem states that rigid-body translation and rotation are fixed. The specific constraints given are $u(0,0)=0$ and $v(0,0)=0$.\nApplying these constraints:\n$$ u(0,0) = \\varepsilon_0(0) + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n$$ v(0,0) = -C_1(0) + C_3 = 0 \\implies C_3 = 0 $$\nThe constraints fix the rigid-body translation. The problem's phrasing implies that rigid-body rotation is also to be suppressed. The rotation component is $\\omega_z = \\frac{1}{2}(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}) = \\frac{1}{2}(-C_1 - C_1) = -C_1$. To fix the rotation to zero, we must set $C_1 = 0$.\n\nTherefore, the exact displacement field corresponding to the pure strain state with no rigid-body motion is:\n$$ u(x,y) = \\varepsilon_0 x $$\n$$ v(x,y) = 0 $$\nThis field is linear in its spatial coordinates.\n\nNext, we evaluate this exact displacement field at the nine nodal coordinates to construct the global nodal displacement vector. The nodal coordinates are provided, and the vector is ordered as $[u_1, v_1, u_2, v_2, \\dots, u_9, v_9]$.\n\nNode 1: $(x_1,y_1) = (0,0) \\implies u_1 = \\varepsilon_0(0) = 0$, $v_1=0$\nNode 2: $(x_2,y_2) = (\\frac{L}{2},0) \\implies u_2 = \\varepsilon_0(\\frac{L}{2})$, $v_2=0$\nNode 3: $(x_3,y_3) = (L,0) \\implies u_3 = \\varepsilon_0 L$, $v_3=0$\nNode 4: $(x_4,y_4) = (0,\\frac{L}{2}) \\implies u_4 = \\varepsilon_0(0) = 0$, $v_4=0$\nNode 5: $(x_5,y_5) = (\\frac{L}{2},\\frac{L}{2}) \\implies u_5 = \\varepsilon_0(\\frac{L}{2})$, $v_5=0$\nNode 6: $(x_6,y_6) = (L,\\frac{L}{2}) \\implies u_6 = \\varepsilon_0 L$, $v_6=0$\nNode 7: $(x_7,y_7) = (0,L) \\implies u_7 = \\varepsilon_0(0) = 0$, $v_7=0$\nNode 8: $(x_8,y_8) = (\\frac{L}{2},L) \\implies u_8 = \\varepsilon_0(\\frac{L}{2})$, $v_8=0$\nNode 9: $(x_9,y_9) = (L,L) \\implies u_9 = \\varepsilon_0 L$, $v_9=0$\n\nThe global nodal displacement vector $\\mathbf{d}$ is the $18$-component vector:\n$$ \\mathbf{d} = \\left[ 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0, 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0, 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0 \\right]^T $$\n\nPart 2: Deduction of the Assembled Stress Field\n\nThe problem states a crucial property of the bilinear isoparametric quadrilateral elements: they reproduce globally linear displacement fields exactly. This property is known as passing the patch test for completeness. Since the exact displacement field $(u(x,y) = \\varepsilon_0 x, v(x,y) = 0)$ is linear, the finite element approximation $u^h(x,y), v^h(x,y)$ constructed from the exact nodal displacements will be identical to the exact field everywhere within the patch.\n$$ u^h(x,y) = u(x,y) = \\varepsilon_0 x $$\n$$ v^h(x,y) = v(x,y) = 0 $$\nConsequently, the strains computed from the finite element solution are constant and equal to the prescribed strains:\n$$ \\varepsilon_{xx}^h = \\frac{\\partial u^h}{\\partial x} = \\varepsilon_0 $$\n$$ \\varepsilon_{yy}^h = \\frac{\\partial v^h}{\\partial y} = 0 $$\n$$ \\gamma_{xy}^h = \\frac{\\partial u^h}{\\partial y} + \\frac{\\partial v^h}{\\partial x} = 0 + 0 = 0 $$\nThe stress field is obtained from the strain field using the plane stress constitutive relation for a linear elastic, isotropic material. The relationship is:\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{Bmatrix} $$\nSubstituting the strain values $\\{\\varepsilon_0, 0, 0\\}^T$:\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_0 \\\\ 0 \\\\ 0 \\end{Bmatrix} $$\nThis gives the stress components:\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2} (1 \\cdot \\varepsilon_0 + \\nu \\cdot 0) = \\frac{E \\varepsilon_0}{1-\\nu^2} $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2} (\\nu \\cdot \\varepsilon_0 + 1 \\cdot 0) = \\frac{\\nu E \\varepsilon_0}{1-\\nu^2} $$\n$$ \\tau_{xy} = \\frac{E}{1-\\nu^2} \\left( \\frac{1-\\nu}{2} \\cdot 0 \\right) = 0 $$\nSince the strain field is uniform across the entire patch, the stress field is also uniform.\n\nFinally, we assemble the final answer as a single row matrix containing the $18$ ordered nodal displacement components followed by the $3$ stress components $(\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy})$.", "answer": "$$ \\boxed{\\begin{pmatrix} 0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  \\frac{E \\varepsilon_0}{1-\\nu^2}  \\frac{\\nu E \\varepsilon_0}{1-\\nu^2}  0 \\end{pmatrix}} $$", "id": "3606154"}, {"introduction": "The patch test is not just a pass/fail check; it is a diagnostic tool that reveals whether an element's formulation satisfies fundamental consistency requirements. This thought experiment [@problem_id:3606135] explores what happens when a key property of shape functions—the Partition of Unity—is violated. By analyzing a hypothetical element, you will develop a deeper intuition for why these mathematical properties are essential for accurately reproducing even the simplest physical states like uniform strain.", "problem": "Consider a small-strain, two-dimensional, linear elastic patch test for the Finite Element Method (FEM) on a $2 \\times 2$ mesh of identical, $4$-node isoparametric quadrilateral elements covering the rectangular domain $\\Omega = [0,2L] \\times [0,2H]$. Let the exact displacement field be a uniform strain state,\n$$\n\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\,\\mathbf{x}, \\quad \\text{with } \\mathbf{B} \\text{ a constant } 2 \\times 2 \\text{ matrix}, \\quad \\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla \\mathbf{u}) = \\mathrm{sym}(\\mathbf{B}),\n$$\nand zero body forces. The nodal displacements on the entire $\\partial \\Omega$ are prescribed so that the nodal values exactly satisfy $\\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\,\\mathbf{x}_i$ for each boundary node $i$.\n\nFor each element, let the geometry mapping use the standard bilinear shape functions on the parent space $(\\xi,\\eta) \\in [-1,1]^2$,\n$$\nN_1 = \\tfrac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2 = \\tfrac{1}{4}(1+\\xi)(1-\\eta), \\quad N_3 = \\tfrac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4 = \\tfrac{1}{4}(1-\\xi)(1+\\eta),\n$$\nso that the physical coordinates are interpolated as $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i$. However, suppose the displacement interpolation violates the Partition of Unity (PoU) by modifying only the first displacement shape function with a bubble:\n$$\n\\tilde{N}_1(\\xi,\\eta) = N_1(\\xi,\\eta) + \\beta\\,b(\\xi,\\eta), \\quad \\tilde{N}_2 = N_2, \\quad \\tilde{N}_3 = N_3, \\quad \\tilde{N}_4 = N_4,\n$$\nwhere $\\beta \\neq 0$ is a fixed, dimensionless parameter and $b(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi^2)(1-\\eta^2)$ satisfies $b=0$ along the element boundary but $b0$ in the element interior. Thus, $\\sum_{i=1}^{4} \\tilde{N}_i = 1 + \\beta\\,b \\neq 1$ in the interior, while $\\sum_{i=1}^{4} \\tilde{N}_i = 1$ on the element boundary.\n\nUsing the above hypothetical displacement shape functions $\\{\\tilde{N}_i\\}$ on every element of the $2 \\times 2$ patch, and the exact nodal boundary displacements corresponding to the uniform strain field, which of the following best describes the qualitative error in the computed strain field and patch-test outcome?\n\nA. The computed strain field remains exactly uniform across the entire patch because nodal boundary displacements enforce the exact solution; the patch test passes.\n\nB. The computed displacement field is exact along all element boundaries, but the interior of each element exhibits nonuniform, oscillatory strains of order $\\mathcal{O}(\\beta)$, leading to nonconstant stresses and inconsistent nodal reactions; the patch test fails and the error does not vanish unless $\\beta \\to 0$.\n\nC. Only rigid-body motion reproduction is lost due to the PoU violation, but uniform strain reproduction remains exact; the patch test passes.\n\nD. The modification introduces a zero-energy hourglass mode that annihilates stiffness, producing identically zero stress throughout the patch, regardless of the imposed uniform strain.\n\nE. A spurious constant body force is induced by the PoU violation such that boundary reactions remain correct and the uniform strain is reproduced; the patch test passes.", "solution": "The fundamental principle being tested is the patch test, a necessary condition for the convergence of a finite element formulation. An element passes the patch test if, for any patch of elements, the finite element solution exactly reproduces any arbitrary constant strain state when the corresponding linear displacement field is imposed on the boundary of the patch.\n\nFirst, let us analyze the properties of the proposed displacement shape functions, $\\{\\tilde{N}_i\\}$. The sum of these shape functions is:\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) = \\tilde{N}_1 + N_2 + N_3 + N_4 = (N_1 + \\beta b) + N_2 + N_3 + N_4 = \\left(\\sum_{i=1}^{4} N_i\\right) + \\beta b(\\xi,\\eta)\n$$\nStandard bilinear shape functions satisfy the Partition of Unity (PoU) property, $\\sum_{i=1}^{4} N_i = 1$. Therefore, for the modified shape functions:\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) = 1 + \\beta b(\\xi,\\eta)\n$$\nSince $\\beta \\neq 0$ and the bubble function $b(\\xi,\\eta)  0$ in the element interior, the PoU property is violated. This violation has immediate consequences. For instance, the element cannot exactly reproduce a rigid-body translation. If we set all nodal displacements to a constant vector $\\mathbf{u}_0$, the interpolated displacement is:\n$$\n\\mathbf{u}^h = \\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{u}_0 = \\left(\\sum_{i=1}^{4} \\tilde{N}_i\\right) \\mathbf{u}_0 = (1 + \\beta b) \\mathbf{u}_0 \\neq \\mathbf{u}_0\n$$\nSince rigid-body motion reproduction is a necessary condition to pass the patch test, we can already conclude the element will fail. However, let us investigate the specific case of a constant strain state.\n\nThe patch test requires the exact reproduction of a linear displacement field, $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$. Let us check if the element formulation can do this. The finite element displacement field, $\\mathbf{u}^h$, is interpolated from the nodal values $\\mathbf{d}_i$. If the interpolation were exact, then by setting the nodal displacements to their exact values, $\\mathbf{d}_i = \\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\mathbf{x}_i$, the interpolated field $\\mathbf{u}^h$ should equal $\\mathbf{u}(\\mathbf{x})$ everywhere in the element.\nLet's compute the interpolated field with these nodal values:\n$$\n\\mathbf{u}^h(\\xi,\\eta) = \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) \\mathbf{d}_i = \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) (\\mathbf{B}\\mathbf{x}_i) = \\mathbf{B} \\left( \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) \\mathbf{x}_i \\right)\n$$\nNow we analyze the sum:\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{x}_i = (N_1 + \\beta b)\\mathbf{x}_1 + N_2\\mathbf{x}_2 + N_3\\mathbf{x}_3 + N_4\\mathbf{x}_4 = \\left(\\sum_{i=1}^{4} N_i \\mathbf{x}_i\\right) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\n$$\nFor an isoparametric element, the geometry is interpolated using the same standard shape functions used for displacement in a conventional formulation: $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\mathbf{x}_i$. Substituting this in, we get:\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{x}_i = \\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\n$$\nThe interpolated displacement field is therefore:\n$$\n\\mathbf{u}^h(\\xi,\\eta) = \\mathbf{B} \\left(\\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\\right) = \\mathbf{B}\\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{B}\\mathbf{x}_1\n$$\nSince $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$, we find:\n$$\n\\mathbf{u}^h(\\mathbf{x}) = \\mathbf{u}(\\mathbf{x}) + \\beta b(\\xi(\\mathbf{x}),\\eta(\\mathbf{x})) \\mathbf{u}(\\mathbf{x}_1)\n$$\nThe finite element field $\\mathbf{u}^h$ is not equal to the exact linear field $\\mathbf{u}$. There is an error term proportional to $\\beta$ and the bubble function $b$. This confirms that the formulation cannot exactly represent a constant strain state. Therefore, the patch test is failed.\n\nNow, let us examine the computed strain field, $\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}^h)$.\n$$\n\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}) + \\mathrm{sym}(\\nabla [\\beta b(\\xi(\\mathbf{x}),\\eta(\\mathbf{x})) \\mathbf{u}(\\mathbf{x}_1)])\n$$\nThe exact strain is $\\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla \\mathbf{u}) = \\mathrm{sym}(\\mathbf{B})$, which is a constant tensor. The error in strain is:\n$$\n\\boldsymbol{\\varepsilon}_{error} = \\beta \\, \\mathrm{sym}(\\nabla [b \\cdot \\mathbf{u}(\\mathbf{x}_1)]) = \\beta \\, \\mathrm{sym}((\\nabla b) \\otimes \\mathbf{u}(\\mathbf{x}_1))\n$$\nThe vector $\\mathbf{u}(\\mathbf{x}_1)$ is a constant for a given element. The gradient of the bubble function, $\\nabla b$, is generally not constant over the element. For example, $\\partial b / \\partial\\xi = -\\frac{1}{2}\\xi(1-\\eta^2)$, which is a function of position. The gradient $\\nabla b$ in physical coordinates involves the Jacobian of the geometric map, but it will remain a non-constant function of position.\nThis means the computed strain, $\\boldsymbol{\\varepsilon}^h = \\boldsymbol{\\varepsilon} + \\boldsymbol{\\varepsilon}_{error}$, is not uniform across the element. It contains a spurious, non-constant part with oscillatory characteristics inherited from the bubble function and its derivatives. The magnitude of this error is of order $\\mathcal{O}(\\beta)$. A non-uniform strain field implies a non-uniform stress field ($\\boldsymbol{\\sigma}^h = \\mathbf{C}\\boldsymbol{\\varepsilon}^h$), which is physically incorrect for this problem. The inability to satisfy equilibrium with the exact solution leads to incorrect nodal displacements being computed for the interior nodes, and consequently, inconsistent nodal reaction forces.\n\nWe can now evaluate the given options.\n\nA. The computed strain field remains exactly uniform across the entire patch because nodal boundary displacements enforce the exact solution; the patch test passes.\n**Incorrect**. As derived, the strain field is not uniform due to the inability of the modified shape functions to reproduce a linear displacement field. The patch test fails.\n\nB. The computed displacement field is exact along all element boundaries, but the interior of each element exhibits nonuniform, oscillatory strains of order $\\mathcal{O}(\\beta)$, leading to nonconstant stresses and inconsistent nodal reactions; the patch test fails and the error does not vanish unless $\\beta \\to 0$.\n**Correct**. This option correctly identifies the failure of the patch test and accurately describes the resulting error. The computed strain is indeed non-uniform and oscillatory of order $\\mathcal{O}(\\beta)$, leading to non-constant stresses. This inconsistency means the patch test fails. The phrase \"The computed displacement field is exact along all element boundaries\" is strictly true only for the outer boundary $\\partial\\Omega$ where displacements are prescribed. For internal element boundaries, the solved nodal displacements will be erroneous, leading to an inexact displacement field along those boundaries. However, among the given choices, this statement provides the best and most complete description of the physically significant consequences of the formulation error.\n\nC. Only rigid-body motion reproduction is lost due to the PoU violation, but uniform strain reproduction remains exact; the patch test passes.\n**Incorrect**. We have shown that both rigid-body motion and constant strain state reproduction are lost. The patch test fails.\n\nD. The modification introduces a zero-energy hourglass mode that annihilates stiffness, producing identically zero stress throughout the patch, regardless of the imposed uniform strain.\n**Incorrect**. This modification does not necessarily create a zero-energy mode. It creates an inconsistent formulation. The boundary conditions correspond to a non-zero strain state, so the computed stresses will be non-zero, albeit incorrect. Claiming identically zero stress is physically implausible.\n\nE. A spurious constant body force is induced by the PoU violation such that boundary reactions remain correct and the uniform strain is reproduced; the patch test passes.\n**Incorrect**. The patch test fails. The error induced in the strain field is non-constant, so it cannot be represented by a spurious constant body force.\n\nThus, option B provides the best qualitative description of the outcome.", "answer": "$$\\boxed{B}$$", "id": "3606135"}, {"introduction": "Moving from theory to practice, a robust patch test is a critical step in the verification of any finite element code. This exercise [@problem_id:3606149] challenges you to think like a code developer and identify a complete and reliable procedure for implementing the test. By evaluating different proposed workflows, you will learn to distinguish a methodologically sound test from common but flawed approaches, covering crucial details from mesh generation to error evaluation.", "problem": "Consider small-strain linear elastostatics on a bounded domain $\\Omega \\subset \\mathbb{R}^2$ with boundary $\\partial \\Omega$, governed by $-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u}) = \\boldsymbol{0}$ in $\\Omega$, where $\\boldsymbol{\\sigma}(\\boldsymbol{u}) = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u})$, $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)$, and $\\mathbb{C}$ is the linear elastic constitutive tensor determined by Young’s modulus $E$ and Poisson’s ratio $\\nu$ in either plane stress or plane strain. A manufactured linear displacement field $\\boldsymbol{u}^\\star(\\boldsymbol{x}) = \\boldsymbol{a} + \\mathbf{B}\\,\\boldsymbol{x}$, with constant vector $\\boldsymbol{a} \\in \\mathbb{R}^2$ and constant matrix $\\mathbf{B} \\in \\mathbb{R}^{2 \\times 2}$, induces a constant strain $\\boldsymbol{\\varepsilon}^\\star$ and constant stress $\\boldsymbol{\\sigma}^\\star$. The classical patch test for the Finite Element Method (FEM) asserts that a conforming element should reproduce this state exactly under appropriate boundary conditions and zero body force, provided the element-level integrals are evaluated with quadrature of sufficient exactness.\n\nYou are asked to select the most complete and robust implementation procedure for the patch test in a finite element code, covering mesh generation, parameter assignment $(E,\\nu)$, quadrature selection, boundary condition application, and postprocessing of error measures such as $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|$. The procedure should diagnose pass or fail reliably for first-order elements (e.g., linear triangles and bilinear quadrilaterals) on affine and mildly distorted meshes, without confounding effects not intrinsic to the polynomial consistency of the element.\n\nWhich option below best satisfies these requirements?\n\nA. Generate a multi-element patch (e.g., a regular or mildly distorted grid of at least $3 \\times 3$ first-order elements) in $\\Omega$. Assign material parameters with $E  0$ and a moderate $\\nu$ such as $\\nu = 0.30$ (plane stress or plane strain), with body force set to $\\boldsymbol{0}$. Choose element quadrature that exactly integrates the element stiffness for the chosen interpolation and mapping: for linear triangles use $1$-point exact area quadrature; for isoparametric bilinear quadrilaterals use full $2 \\times 2$ Gauss quadrature. Impose Dirichlet boundary conditions $\\boldsymbol{u} = \\boldsymbol{u}^\\star$ at all boundary nodes of the patch. Assemble and solve. Postprocess the error by evaluating $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} \\left\\|\\nabla \\boldsymbol{u}_h(\\boldsymbol{x}) - \\nabla \\boldsymbol{u}^\\star\\right\\|^2 \\,\\mathrm{d}\\Omega\\right)^{1/2}$ using quadrature of at least the same order used in the stiffness assembly (or higher). Declare “pass” if the error is at or near roundoff and the recovered stresses are elementwise constant and equal to $\\boldsymbol{\\sigma}^\\star$.\n\nB. Generate a single-element domain $\\Omega$ and assign $E  0$, any $\\nu \\in (-1,0.5)$. Use any available quadrature rule. Impose nodal values of $\\boldsymbol{u}^\\star$ only at the element’s corner nodes; leave other boundary nodes (if any) unconstrained. Solve and declare “pass” if the nodal displacement error $\\max_{\\text{nodes}} \\left\\|\\boldsymbol{u}_h - \\boldsymbol{u}^\\star\\right\\|$ is zero, without computing gradient-level error norms.\n\nC. Generate a multi-element patch. Assign $E  0$, moderate $\\nu$. Apply pure traction boundary conditions $\\boldsymbol{t} = \\boldsymbol{\\sigma}^\\star \\boldsymbol{n}$ on the entire boundary $\\partial \\Omega$ with no additional constraints, and use reduced integration for quadrilaterals (e.g., $1 \\times 1$ Gauss) to avoid over-stiffness. Compute the error only at the element Gauss points and declare “pass” if it is zero there.\n\nD. Generate a multi-element patch. Assign $E  0$ and nearly incompressible $\\nu = 0.499$ in a displacement-only formulation. Use full numerical integration for all elements and impose $\\boldsymbol{u} = \\boldsymbol{u}^\\star$ on $\\partial \\Omega$. Declare “fail” if $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|_{L^2(\\Omega)}$ is measurably nonzero, interpreting this as the element failing the patch test.\n\nE. Generate a multi-element patch and assign $E  0$, moderate $\\nu$. Use full quadrature in assembly and impose $\\boldsymbol{u} = \\boldsymbol{u}^\\star$ on $\\partial \\Omega$. Postprocess the patch test by computing $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|$ from nodal gradients obtained by simple averaging of surrounding element gradients, without domain integration, and declare “pass” if the averaged nodal gradient error is below tolerance.\n\nSelect the correct option(s).", "solution": "The problem statement has been validated and found to be scientifically sound, well-posed, objective, and complete. It provides a correct theoretical background for the patch test in linear elastostatics.\n\nThe core principle of the patch test is to verify that a finite element formulation can exactly reproduce an arbitrary state of constant strain. For the manufactured solution $\\boldsymbol{u}^\\star(\\boldsymbol{x}) = \\boldsymbol{a} + \\mathbf{B}\\,\\boldsymbol{x}$, the displacement gradient is a constant matrix $\\nabla \\boldsymbol{u}^\\star = \\mathbf{B}$, leading to constant strain $\\boldsymbol{\\varepsilon}^\\star$ and constant stress $\\boldsymbol{\\sigma}^\\star$. A conforming element passes the test if, for any patch of elements subjected to boundary conditions consistent with $\\boldsymbol{u}^\\star$, the finite element solution $\\boldsymbol{u}_h$ satisfies $\\nabla \\boldsymbol{u}_h(\\boldsymbol{x}) = \\mathbf{B}$ for all $\\boldsymbol{x} \\in \\Omega$. This is a necessary condition for convergence.\n\nA robust implementation procedure must address several critical points:\n$1$. The \"patch\" must consist of multiple elements, including at least one internal node, to test inter-element compatibility and the behavior of unconstrained degrees of freedom. Testing on distorted elements is essential to verify the robustness of the isoparametric mapping.\n$2$. Boundary conditions must correctly impose the constant strain state. Imposing Dirichlet conditions $\\boldsymbol{u} = \\boldsymbol{u}^\\star$ on all boundary nodes is the most direct and stable method.\n$3$. The choice of numerical quadrature is critical. The integration rule must be sufficiently accurate to compute the element stiffness matrix correctly. The required order of quadrature depends on the element type and the geometry of the mapping from the reference to the physical element.\n$4$. Material parameters should be chosen to avoid confounding effects. A moderate, non-extreme Poisson's ratio is appropriate for a general consistency test.\n$5$. Verification of a \"pass\" must be rigorous. It requires checking that the gradient of the numerical solution, $\\nabla \\boldsymbol{u}_h$, is constant and equal to $\\mathbf{B}$ throughout the domain. This is best measured by an integrated error norm, such as the $L^2$ norm of the gradient error, $\\left\\|\\nabla \\boldsymbol{u}_h - \\mathbf{B}\\right\\|_{L^2(\\Omega)}$, which should be zero up to machine precision.\n\nWe now evaluate each option against these principles.\n\nA. This option proposes a procedure that aligns perfectly with the requirements for a robust patch test.\n- It specifies a multi-element patch (e.g., a $3 \\times 3$ grid) including mild distortion, which is essential for a thorough test.\n- It recommends moderate, nonspecial material parameters ($E  0$, $\\nu = 0.30$) and zero body force, correctly isolating the consistency check.\n- It correctly identifies the necessity of adequate quadrature, specifying the standard, appropriate rules for first-order elements: $1$-point for linear triangles and $2 \\times 2$ Gauss quadrature for bilinear quadrilaterals. This is a critical detail.\n- It uses the standard and most reliable method for applying boundary conditions: imposing $\\boldsymbol{u} = \\boldsymbol{u}^\\star$ on all boundary nodes.\n- For postprocessing, it advocates computing the $L^2$ norm of the gradient error using adequate quadrature, which is the most rigorous and appropriate success metric. It also correctly notes that the resulting error should be near roundoff and the element-wise stresses should be constant and exact.\nThis procedure is complete, robust, and methodologically sound. **Correct**.\n\nB. This option is fundamentally flawed.\n- It proposes using a single-element domain. A patch test is meaningless on a single element, as it cannot test inter-element continuity or the behavior of internal nodes. The test would merely check if the element's shape functions can interpolate a linear field, which is trivial.\n- It allows \"any available quadrature rule,\" which is incorrect. The choice of quadrature is critical to passing the test.\n- It proposes checking only nodal displacement error, which is an insufficient metric. The patch test is fundamentally about the reproduction of a constant *strain* (gradient) state, not just nodal displacements.\nThis procedure is inadequate for verifying patch test passage. **Incorrect**.\n\nC. This option contains several significant errors.\n- It proposes applying pure traction boundary conditions $\\boldsymbol{t} = \\boldsymbol{\\sigma}^\\star \\boldsymbol{n}$ without any additional constraints. This renders the problem ill-posed, as the stiffness matrix will be singular due to unconstrained rigid body modes. The system of equations will have no unique solution.\n- It recommends using reduced integration ($1 \\times 1$ Gauss quadrature for quadrilaterals) to \"avoid over-stiffness.\" While reduced integration has its uses (e.g., mitigating volumetric locking), its use in a general patch test confounds the objective. The patch test is for verifying polynomial consistency, not for analyzing locking phenomena. Using reduced integration may allow an inconsistent element to pass or introduce spurious zero-energy modes.\n- It suggests computing the error only at Gauss points. This is not a comprehensive check; an element passes the patch test only if the solution is exact *everywhere*, not just at a few select points.\nThis procedure is ill-conceived and would not provide a reliable diagnosis. **Incorrect**.\n\nD. This option improperly conflates the patch test with a test for volumetric locking.\n- It specifies using a nearly incompressible material ($\\nu = 0.499$) in a standard displacement formulation. For many first-order elements, this setup will produce a large, non-zero error due to volumetric locking, a phenomenon where the element becomes overly stiff in near-incompressible conditions.\n- It then incorrectly interprets this non-zero error as the element failing the *patch test*. The element may be perfectly consistent (i.e., it passes the patch test with a moderate $\\nu$) but still perform poorly in the near-incompressible limit. The patch test is a check of completeness/consistency of the polynomial approximation, which is a separate issue from volumetric locking. This procedure misdiagnoses the cause of failure.\nA robust, general patch test procedure should use a moderate Poisson's ratio to avoid this confusion. **Incorrect**.\n\nE. The verification step in this option is flawed.\n- It suggests computing the gradient error from \"nodal gradients obtained by simple averaging of surrounding element gradients.\" The native gradient/strain/stress field from a standard first-order finite element solution is element-wise constant and discontinuous across element boundaries. Averaging is a post-processing or \"smoothing\" technique used to obtain a continuous nodal field, often for visualization.\n- Using this averaged quantity to verify the patch test is incorrect. The test requires that the *actual*, discontinuous, element-wise gradient field $\\nabla \\boldsymbol{u}_h$ is exact. Checking a smoothed, post-processed field does not test the underlying solution directly and can obscure the true behavior of the element formulation. The error must be computed from the raw element-level gradients.\nThis postprocessing methodology is not a rigorous verification of patch test satisfaction. **Incorrect**.\n\nIn summary, Option A is the only one that describes a complete, rigorous, and methodologically sound procedure for implementing the patch test for first-order finite elements. It correctly handles the mesh, material properties, quadrature, boundary conditions, and error verification.", "answer": "$$\\boxed{A}$$", "id": "3606149"}]}