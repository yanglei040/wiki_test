{"hands_on_practices": [{"introduction": "This first exercise establishes the foundational workflow for converting a distributed physical load into its equivalent nodal forces in the global system. By applying the principle of virtual work with standard beam shape functions, you will first derive the consistent local load vector, and then use the appropriate rotation matrix to transform it into the global frame [@problem_id:3555024]. This practice is essential for accurately modeling frame structures subjected to transverse loads like gravity or pressure.", "problem": "Consider a two-dimensional Euler–Bernoulli beam (frame) finite element of length $L$ connecting node $1$ to node $2$. The element’s local coordinate system $\\{x,y\\}$ is obtained by rotating the global system $\\{X,Y\\}$ by a constant angle $\\theta$ measured counterclockwise from the global $X$-axis to the local $x$-axis. The local $y$-axis is the in-plane transverse axis, orthonormal to the local $x$-axis. The nodal degrees of freedom in the local system are ordered as $[u_1, v_1, \\varphi_1, u_2, v_2, \\varphi_2]^{T}$, where $u$ is the axial displacement, $v$ is the transverse displacement, and $\\varphi$ is the rotation.\n\nA distributed load acts only in the local transverse direction $+y$ and varies along the element as\n$$\nq_l(x) \\;=\\; q_0 \\;+\\; q_1\\,\\frac{x}{L} \\;+\\; q_2\\,\\Bigl(\\frac{x}{L}\\Bigr)^{2},\n\\quad 0 \\le x \\le L,\n$$\nwith $q_0$, $q_1$, and $q_2$ being constants. Using the principle of virtual work and the standard cubic Hermite interpolation for the Euler–Bernoulli beam’s transverse displacement,\n$$\nv(x) \\;=\\; H_1(\\xi)\\,v_1 \\;+\\; H_2(\\xi)\\,L\\,\\varphi_1 \\;+\\; H_3(\\xi)\\,v_2 \\;+\\; H_4(\\xi)\\,L\\,\\varphi_2,\n\\quad \\xi \\equiv \\frac{x}{L},\n$$\nwith\n$$\nH_1(\\xi)=1-3\\xi^{2}+2\\xi^{3},\\quad\nH_2(\\xi)=\\xi-2\\xi^{2}+\\xi^{3},\\quad\nH_3(\\xi)=3\\xi^{2}-2\\xi^{3},\\quad\nH_4(\\xi)=-\\xi^{2}+\\xi^{3},\n$$\nfirst form the consistent local equivalent nodal load vector contribution associated with the transverse displacement at node $1$, i.e., the component $F_{v1}^{(l)}$ in the local vector $[F_{u1}^{(l)},F_{v1}^{(l)},M_{1}^{(l)},F_{u2}^{(l)},F_{v2}^{(l)},M_{2}^{(l)}]^{T}$ due solely to $q_l(x)$.\n\nThen map the local equivalent nodal loads into the global system using the force transformation\n$$\n\\mathbf{f}^{(g)} \\;=\\; \\mathbf{T}^{T}\\,\\mathbf{f}^{(l)},\n$$\nwhere $\\mathbf{T}$ is the block-diagonal transformation that maps global nodal displacements to local nodal displacements, i.e.,\n$$\n\\begin{bmatrix} u \\\\ v \\\\ \\varphi \\end{bmatrix}^{(l)}\n\\;=\\;\n\\mathbf{R}\\,\n\\begin{bmatrix} U \\\\ V \\\\ \\Phi \\end{bmatrix}^{(g)},\n\\qquad\n\\mathbf{R}\n=\n\\begin{bmatrix}\n\\cos\\theta & \\sin\\theta & 0 \\\\\n-\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\napplied independently at node $1$ and node $2$.\n\nDerive, from first principles, a closed-form expression for the global $X$-component of the equivalent nodal load at node $1$, denoted $F_{X1}^{(g)}$, due solely to $q_l(x)$. Express your final answer as a single symbolic expression in terms of $q_0$, $q_1$, $q_2$, $L$, and $\\theta$. Do not include units in your final expression. No numerical evaluation or rounding is required.", "solution": "The problem is valid as it is a well-posed, scientifically grounded problem in computational solid mechanics that is internally consistent and contains all necessary information for a unique solution.\n\nThe derivation proceeds in two main steps: first, the determination of the consistent local equivalent nodal loads using the principle of virtual work; second, the transformation of these local loads into the global coordinate system.\n\nThe principle of virtual work states that the virtual work done by the external distributed load, $\\delta W_{\\text{ext}}$, equals the work done by the equivalent nodal loads, $\\mathbf{f}^{(l)}$, through the virtual nodal displacements, $\\delta\\mathbf{d}^{(l)}$. The distributed load $q_l(x)$ acts only in the local transverse direction, so the virtual work is given by:\n$$\n\\delta W_{\\text{ext}} = \\int_0^L q_l(x) \\, \\delta v(x) \\, dx\n$$\nThe virtual transverse displacement, $\\delta v(x)$, is interpolated from the virtual nodal degrees of freedom using the provided Hermite shape functions, $H_i(\\xi)$, where $\\xi = x/L$:\n$$\n\\delta v(x) = H_1(\\xi)\\,\\delta v_1 + H_2(\\xi)\\,L\\,\\delta \\varphi_1 + H_3(\\xi)\\,\\delta v_2 + H_4(\\xi)\\,L\\,\\delta \\varphi_2\n$$\nThe virtual work can also be expressed discretely as:\n$$\n\\delta W_{\\text{ext}} = [F_{u1}^{(l)}, F_{v1}^{(l)}, M_1^{(l)}, F_{u2}^{(l)}, F_{v2}^{(l)}, M_2^{(l)}] \\begin{bmatrix} \\delta u_1 \\\\ \\delta v_1 \\\\ \\delta \\varphi_1 \\\\ \\delta u_2 \\\\ \\delta v_2 \\\\ \\delta \\varphi_2 \\end{bmatrix}\n$$\nSince the applied load $q_l(x)$ is purely transverse, it performs no work through any virtual axial displacement $\\delta u(x)$. Consequently, the consistent nodal axial forces are zero: $F_{u1}^{(l)} = 0$ and $F_{u2}^{(l)} = 0$.\n\nTo find the local transverse force at node $1$, $F_{v1}^{(l)}$, we equate the coefficient of the virtual displacement $\\delta v_1$ in both expressions for $\\delta W_{\\text{ext}}$:\n$$\nF_{v1}^{(l)} = \\int_0^L q_l(x) H_1(\\xi) \\, dx\n$$\nWe substitute the given expressions for $q_l(x)$ and $H_1(\\xi)$ and change the integration variable from $x$ to $\\xi$ using $x = L\\xi$ and $dx = L\\,d\\xi$:\n$$\nF_{v1}^{(l)} = \\int_0^1 \\left( q_0 + q_1\\xi + q_2\\xi^2 \\right) \\left( 1 - 3\\xi^2 + 2\\xi^3 \\right) L \\, d\\xi\n$$\nWe can separate this into three integrals based on the constants $q_0$, $q_1$, and $q_2$:\n$$\nF_{v1}^{(l)} = L \\left( q_0 \\int_0^1 H_1(\\xi) \\, d\\xi + q_1 \\int_0^1 \\xi H_1(\\xi) \\, d\\xi + q_2 \\int_0^1 \\xi^2 H_1(\\xi) \\, d\\xi \\right)\n$$\nWe evaluate each integral separately:\n$$\n\\int_0^1 H_1(\\xi) \\, d\\xi = \\int_0^1 (1 - 3\\xi^2 + 2\\xi^3) \\, d\\xi = \\left[ \\xi - \\xi^3 + \\frac{2}{4}\\xi^4 \\right]_0^1 = 1 - 1 + \\frac{1}{2} = \\frac{1}{2}\n$$\n$$\n\\int_0^1 \\xi H_1(\\xi) \\, d\\xi = \\int_0^1 (\\xi - 3\\xi^3 + 2\\xi^4) \\, d\\xi = \\left[ \\frac{1}{2}\\xi^2 - \\frac{3}{4}\\xi^4 + \\frac{2}{5}\\xi^5 \\right]_0^1 = \\frac{1}{2} - \\frac{3}{4} + \\frac{2}{5} = \\frac{10-15+8}{20} = \\frac{3}{20}\n$$\n$$\n\\int_0^1 \\xi^2 H_1(\\xi) \\, d\\xi = \\int_0^1 (\\xi^2 - 3\\xi^4 + 2\\xi^5) \\, d\\xi = \\left[ \\frac{1}{3}\\xi^3 - \\frac{3}{5}\\xi^5 + \\frac{2}{6}\\xi^6 \\right]_0^1 = \\frac{1}{3} - \\frac{3}{5} + \\frac{1}{3} = \\frac{2}{3} - \\frac{3}{5} = \\frac{10-9}{15} = \\frac{1}{15}\n$$\nSubstituting these results back, we obtain the expression for $F_{v1}^{(l)}$:\n$$\nF_{v1}^{(l)} = L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right)\n$$\nThe second step is to transform the local nodal loads to the global coordinate system. The transformation for the force/moment vectors is given by $\\mathbf{f}^{(g)} = \\mathbf{T}^T \\mathbf{f}^{(l)}$. The full transformation matrix $\\mathbf{T}$ is block-diagonal, composed of two $3 \\times 3$ rotation matrices $\\mathbf{R}$. The transformation for the nodal loads at node $1$ is thus:\n$$\n\\begin{bmatrix} F_{X1}^{(g)} \\\\ F_{Y1}^{(g)} \\\\ M_{Z1}^{(g)} \\end{bmatrix} = \\mathbf{R}^T \\begin{bmatrix} F_{u1}^{(l)} \\\\ F_{v1}^{(l)} \\\\ M_1^{(l)} \\end{bmatrix}\n$$\nThe transpose of the given rotation matrix $\\mathbf{R}$ is:\n$$\n\\mathbf{R}^T = \\begin{bmatrix}\n\\cos\\theta & -\\sin\\theta & 0 \\\\\n\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}\n$$\nPerforming the matrix-vector multiplication, the global $X$-component of the load at node $1$, $F_{X1}^{(g)}$, is:\n$$\nF_{X1}^{(g)} = F_{u1}^{(l)} \\cos\\theta - F_{v1}^{(l)} \\sin\\theta\n$$\nAs established earlier, the local axial force component $F_{u1}^{(l)}$ is zero because the applied distributed load is purely transverse. Therefore, the expression simplifies to:\n$$\nF_{X1}^{(g)} = - F_{v1}^{(l)} \\sin\\theta\n$$\nFinally, substituting the derived expression for $F_{v1}^{(l)}$ yields the desired global load component:\n$$\nF_{X1}^{(g)} = -L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right) \\sin\\theta\n$$\nThis expression is the final answer, given in terms of the specified constants $q_0$, $q_1$, $q_2$, $L$, and $\\theta$.", "answer": "$$ \\boxed{-L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right) \\sin\\theta} $$", "id": "3555024"}, {"introduction": "Beyond the mechanics of the matrix-vector product, it is crucial to understand that coordinate transformation is a physically consistent operation. This practice demonstrates that a self-equilibrated system of local forces remains in equilibrium after transformation to the global frame, a direct consequence of the invariance of virtual work [@problem_id:3555039]. By working through this problem, you will not only handle force and moment transformations but also verify the preservation of fundamental physical laws and see its connection to the symmetry of the global stiffness matrix.", "problem": "Consider a two-dimensional Euler–Bernoulli frame element in the Finite Element Method (FEM) with two nodes, denoted node $i$ and node $j$, and local coordinates $(x,y)$ where the local $x$-axis is aligned with the element axis. The element has length $L$ and is embedded in a global $(X,Y)$ frame by a rigid rotation about the out-of-plane $z$-axis through angle $\\theta$, with $\\theta$ measured in radians. The element orientation is specified by $\\theta = \\pi/3$ and $L = 2$, and the local nodal degrees of freedom at each node are ordered as $(u_x, u_y, \\varphi_z)$, where $u_x$ and $u_y$ are translations and $\\varphi_z$ is the in-plane rotation about $z$.\n\nA self-equilibrated system of local nodal actions is applied consisting of an end shear–moment pair at node $i$ and counter-actions at node $j$. In the local frame, the applied nodal actions are:\n- At node $i$: a shear $V_i$ along $+y$ with magnitude $V_i = 12$, and a nodal moment about $z$ with magnitude $M_i = 5$.\n- At node $j$: a shear $V_j$ along $+y$ and a nodal moment about $z$ with magnitude $M_j$, to be determined such that the element-level resultant force and resultant moment are both zero in the local frame.\n\nAssume standard sign conventions: positive shear along $+y$ and positive moment about $+z$ (counterclockwise). Let the local-to-global direction cosine rotation matrix $Q$ map local translational components to global translational components. The element-level displacement transformation matrix $T$ acts on the ordered nodal displacement vector $(u_{x,i}, u_{y,i}, \\varphi_{z,i}, u_{x,j}, u_{y,j}, \\varphi_{z,j})$ and is the block-diagonal assembly of appropriate rotation submatrices for translations and the identity for $\\varphi_z$.\n\nTasks:\n1. Enforce static equilibrium in the local frame to determine $V_j$ and $M_j$ in terms of $L$, $V_i$, and $M_i$.\n2. Starting from the invariance of virtual work and the definition of the rotation mapping by $Q$, derive the appropriate transformation for nodal force components and construct the global nodal load vector $F_g$ corresponding to the local nodal load vector $F_l$ defined by the ordered components $(f_{x,i}, f_{y,i}, m_{z,i}, f_{x,j}, f_{y,j}, m_{z,j})$.\n3. Compute the explicit global components of the nodal actions for the given numerical values of $L$, $V_i$, $M_i$, and $\\theta$.\n4. Verify, using first principles and properties of rigid rotations, that nodal equilibrium is preserved under the transformation and that the transformed global element stiffness matrix $K_g$ constructed from a symmetric local stiffness $K_l$ remains symmetric.\n\nExpress the final global nodal load vector $F_g$ components in the order $(f_{X,i}, f_{Y,i}, m_{Z,i}, f_{X,j}, f_{Y,j}, m_{Z,j})$ using Newtons for forces and Newton-meters for moments. Use radians for angles. No rounding is required; present exact values.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of computational solid mechanics and the Finite Element Method, is well-posed, objective, and contains all necessary information for a unique solution without contradictions.\n\nThe solution proceeds by addressing the four tasks in order.\n\nThe ordered degrees of freedom (DOFs) for the element are given in a local frame $(x,y)$ and a global frame $(X,Y)$.\nThe local displacement vector is $d_l = (u_{x,i}, u_{y,i}, \\varphi_{z,i}, u_{x,j}, u_{y,j}, \\varphi_{z,j})^T$.\nThe corresponding local nodal load vector is $F_l = (f_{x,i}, f_{y,i}, m_{z,i}, f_{x,j}, f_{y,j}, m_{z,j})^T$.\n\nThe element has length $L=2$ and is oriented at an angle $\\theta = \\pi/3$ with respect to the global frame.\n\n**Task 1: Enforce static equilibrium in the local frame**\n\nA self-equilibrated system of nodal actions is applied. At node $i$, the actions are a shear force of magnitude $V_i = 12$ along the $+y$ direction and a moment of magnitude $M_i = 5$ about the $+z$ axis. In the local load vector notation, this means:\n$f_{x,i} = 0$\n$f_{y,i} = V_i = 12$\n$m_{z,i} = M_i = 5$\n\nAt node $j$, there are counter-actions: a shear $V_j$ along $+y$ (so $f_{y,j} = V_j$) and a moment $M_j$ (so $m_{z,j} = M_j$). There is no specified axial force, so we assume $f_{x,j}$ is determined by equilibrium.\n\nFor the element to be in static equilibrium, the sum of forces and moments must be zero.\n1.  Sum of forces in the local $x$-direction:\n    $$ \\sum f_x = f_{x,i} + f_{x,j} = 0 $$\n    Since $f_{x,i}=0$, we have $f_{x,j}=0$.\n\n2.  Sum of forces in the local $y$-direction:\n    $$ \\sum f_y = f_{y,i} + f_{y,j} = 0 $$\n    $$ V_i + V_j = 0 \\implies V_j = -V_i = -12 $$\n    So, the shear action at node $j$ is $f_{y,j} = -12$.\n\n3.  Sum of moments about node $i$:\n    $$ \\sum M_i = m_{z,i} + m_{z,j} + (f_{y,j} \\times L) = 0 $$\n    The force $f_{y,j}$ at node $j$ has a lever arm of $L$ with respect to node $i$.\n    $$ M_i + M_j + (-V_i)L = 0 $$\n    Solving for $M_j$:\n    $$ M_j = V_i L - M_i $$\n    Substituting the given values $L=2$, $V_i=12$, and $M_i=5$:\n    $$ M_j = (12)(2) - 5 = 24 - 5 = 19 $$\n    So, the moment at node $j$ is $m_{z,j} = 19$.\n\nThe complete local nodal load vector is:\n$$ F_l = \\begin{pmatrix} f_{x,i} \\\\ f_{y,i} \\\\ m_{z,i} \\\\ f_{x,j} \\\\ f_{y,j} \\\\ m_{z,j} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 12 \\\\ 5 \\\\ 0 \\\\ -12 \\\\ 19 \\end{pmatrix} $$\n\n**Task 2: Derive the transformation for nodal forces and construct the global nodal load vector $F_g$**\n\nThe transformation of nodal forces from the local to the global frame is derived from the principle of invariance of virtual work, $\\delta W$.\n$$ \\delta W = (\\delta d_g)^T F_g = (\\delta d_l)^T F_l $$\nwhere $d_g$ and $d_l$ are the global and local nodal displacement vectors, and $F_g$ and $F_l$ are the corresponding nodal load vectors.\n\nThe local displacements $d_l$ are related to the global displacements $d_g$ by a transformation matrix $T$:\n$$ d_l = T d_g $$\nThe variation of displacements follows the same rule: $\\delta d_l = T \\delta d_g$.\nSubstituting this into the virtual work equation:\n$$ (\\delta d_g)^T F_g = (T \\delta d_g)^T F_l = (\\delta d_g)^T T^T F_l $$\nSince this equality must hold for any arbitrary non-zero virtual displacement vector $\\delta d_g$, we can conclude:\n$$ F_g = T^T F_l $$\nThe matrix $T$ transforms global DOFs to local DOFs. For a single node, the transformation relates $(u_{X}, u_{Y}, \\varphi_{Z})$ to $(u_{x}, u_{y}, \\varphi_{z})$. The translational components rotate, while the in-plane rotation $\\varphi_z$ is invariant.\nThe transformation for one node's DOFs is described by a matrix $T_{node}$:\n$$\nT_{node} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta & 0 \\\\ -\\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe full element transformation matrix $T$ is a $6 \\times 6$ block-diagonal matrix:\n$$ T = \\begin{pmatrix} T_{node} & \\mathbf{0} \\\\ \\mathbf{0} & T_{node} \\end{pmatrix} $$\nThe force transformation requires $T^T$:\n$$ T^T = \\begin{pmatrix} T_{node}^T & \\mathbf{0} \\\\ \\mathbf{0} & T_{node}^T \\end{pmatrix} \\quad \\text{where} \\quad T_{node}^T = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta & 0 \\\\ \\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\nLet $R = T_{node}^T$. The global force vector $F_g$ is obtained by transforming the nodal forces at nodes $i$ and $j$ separately using $R$:\n$$ F_{g,i} = \\begin{pmatrix} f_{X,i} \\\\ f_{Y,i} \\\\ m_{Z,i} \\end{pmatrix} = R \\begin{pmatrix} f_{x,i} \\\\ f_{y,i} \\\\ m_{z,i} \\end{pmatrix} \\quad \\text{and} \\quad F_{g,j} = \\begin{pmatrix} f_{X,j} \\\\ f_{Y,j} \\\\ m_{Z,j} \\end{pmatrix} = R \\begin{pmatrix} f_{x,j} \\\\ f_{y,j} \\\\ m_{z,j} \\end{pmatrix} $$\n\n**Task 3: Compute the explicit global components**\n\nGiven $\\theta = \\pi/3$:\n$\\cos(\\pi/3) = 1/2$\n$\\sin(\\pi/3) = \\sqrt{3}/2$\n\nThe transformation matrix $R$ is:\n$$ R = \\begin{pmatrix} 1/2 & -\\sqrt{3}/2 & 0 \\\\ \\sqrt{3}/2 & 1/2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\nThe local nodal loads are $F_{l,i} = (0, 12, 5)^T$ and $F_{l,j} = (0, -12, 19)^T$.\n\nFor node $i$:\n$$ \\begin{pmatrix} f_{X,i} \\\\ f_{Y,i} \\\\ m_{Z,i} \\end{pmatrix} = \\begin{pmatrix} 1/2 & -\\sqrt{3}/2 & 0 \\\\ \\sqrt{3}/2 & 1/2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 12 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} (1/2)(0) + (-\\sqrt{3}/2)(12) + (0)(5) \\\\ (\\sqrt{3}/2)(0) + (1/2)(12) + (0)(5) \\\\ (0)(0) + (0)(12) + (1)(5) \\end{pmatrix} = \\begin{pmatrix} -6\\sqrt{3} \\\\ 6 \\\\ 5 \\end{pmatrix} $$\n\nFor node $j$:\n$$ \\begin{pmatrix} f_{X,j} \\\\ f_{Y,j} \\\\ m_{Z,j} \\end{pmatrix} = \\begin{pmatrix} 1/2 & -\\sqrt{3}/2 & 0 \\\\ \\sqrt{3}/2 & 1/2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -12 \\\\ 19 \\end{pmatrix} = \\begin{pmatrix} (1/2)(0) + (-\\sqrt{3}/2)(-12) + (0)(19) \\\\ (\\sqrt{3}/2)(0) + (1/2)(-12) + (0)(19) \\\\ (0)(0) + (0)(-12) + (1)(19) \\end{pmatrix} = \\begin{pmatrix} 6\\sqrt{3} \\\\ -6 \\\\ 19 \\end{pmatrix} $$\n\nThe final global nodal load vector $F_g$ is assembled from these components:\n$$ F_g = (f_{X,i}, f_{Y,i}, m_{Z,i}, f_{X,j}, f_{Y,j}, m_{Z,j})^T = (-6\\sqrt{3}, 6, 5, 6\\sqrt{3}, -6, 19)^T $$\n\n**Task 4: Verification of equilibrium and stiffness matrix symmetry**\n\n*   **Preservation of Nodal Equilibrium:**\n    A system of forces and moments is in equilibrium if the resultant force vector and resultant moment vector (about any point) are zero. The transformation from a local frame to a global frame is a rigid rotation, which is an affine transformation that preserves vector sums and moment properties.\n    Formally, let the local-to-global rotation matrix for vector components be $Q$. Each global force vector is related to its local counterpart by $\\mathbf{F}_{g,k} = Q \\mathbf{F}_{l,k}$. The total force in the global frame is $\\mathbf{F}_{total, g} = \\sum_{k} \\mathbf{F}_{g,k}$.\n    $$ \\mathbf{F}_{total, g} = \\sum_{k} (Q \\mathbf{F}_{l,k}) = Q \\left( \\sum_{k} \\mathbf{F}_{l,k} \\right) = Q \\mathbf{F}_{total, l} $$\n    Since the local system is in equilibrium, $\\mathbf{F}_{total, l} = \\mathbf{0}$, which implies $\\mathbf{F}_{total, g} = Q \\mathbf{0} = \\mathbf{0}$.\n    Thus, force equilibrium is preserved. A similar argument holds for moment equilibrium. Our numerical result confirms this:\n    $\\sum F_X = -6\\sqrt{3} + 6\\sqrt{3} = 0$.\n    $\\sum F_Y = 6 - 6 = 0$.\n\n*   **Symmetry of Transformed Stiffness Matrix $K_g$:**\n    The transformation of the stiffness matrix from local coordinates to global coordinates is given by the congruence transformation:\n    $$ K_g = T^T K_l T $$\n    We are given that the local stiffness matrix $K_l$ is symmetric, which means $K_l^T = K_l$. We must verify that $K_g$ is also symmetric, i.e., $K_g^T = K_g$.\n    Let's compute the transpose of $K_g$:\n    $$ K_g^T = (T^T K_l T)^T $$\n    Using the property of the transpose of a product, $(ABC)^T = C^T B^T A^T$:\n    $$ K_g^T = T^T (K_l)^T (T^T)^T $$\n    Using the property that the transpose of a transpose is the original matrix, $(A^T)^T = A$:\n    $$ K_g^T = T^T (K_l)^T T $$\n    Since $K_l$ is symmetric, we substitute $K_l^T = K_l$:\n    $$ K_g^T = T^T K_l T $$\n    This is precisely the definition of $K_g$. Therefore, $K_g^T = K_g$, proving that the global stiffness matrix is symmetric if the local one is. This property is fundamental to the congruent transformation used in FEM.", "answer": "$$ \\boxed{\n\\begin{pmatrix} -6\\sqrt{3} & 6 & 5 & 6\\sqrt{3} & -6 & 19 \\end{pmatrix}\n} $$", "id": "3555039"}, {"introduction": "Real-world components are often curved and made from advanced materials with spatially varying properties. This exercise tackles such a scenario, where the element's local frame itself rotates along its length [@problem_id:3554988]. You will investigate a critical numerical issue: the difference between transforming pointwise before integration versus integrating local quantities first and then transforming the result. This practice illustrates the necessity of a frame-consistent approach to maintain accuracy and highlights potential pitfalls in the numerical implementation of advanced finite elements.", "problem": "Consider a one-dimensional curved element embedded in a two-dimensional ambient space. Let the element parameter be denoted by $\\xi \\in [-1,1]$. At each $\\xi$, there is a local orthonormal material frame related to the global frame by a proper orthogonal rotation field $R(\\xi) \\in \\mathbb{R}^{2 \\times 2}$ defined by a continuously differentiable angle function $\\theta(\\xi)$ (angle specified in radians). The local material stiffness is spatially varying due to the functionally graded nature of the material. The element is subjected to a distributed load that is specified in the local material frame.\n\nYour derivation and implementation must start strictly from fundamental principles appropriate to computational solid mechanics:\n- Frame invariance and change of basis under rigid rotations: a proper orthogonal matrix $R(\\xi)$ satisfies $R(\\xi)^\\top R(\\xi) = I$, and changing the basis of a quadratic form corresponds to $Q^{glob}(\\xi) = R(\\xi)^\\top Q^{loc}(\\xi) R(\\xi)$.\n- Linear superposition and numerical integration by Gauss–Legendre quadrature: an integral $\\int_{-1}^{1} g(\\xi)\\, d\\xi$ is approximated by a weighted sum $\\sum_{i=1}^{n} w_i\\, g(\\xi_i)$ using $n$ Gauss points $\\{\\xi_i\\}$ and weights $\\{w_i\\}$.\n\nDefine the following fields on $\\xi \\in [-1,1]$:\n- The rotation field $R(\\xi)$ given by\n$$\nR(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi) & \\phantom{-}\\cos\\theta(\\xi)\n\\end{bmatrix}.\n$$\n- The local stiffness matrix $K^{loc}(\\xi) \\in \\mathbb{R}^{2 \\times 2}$ of the functionally graded material modeled as a diagonal, positive semidefinite matrix\n$$\nK^{loc}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi) & 0 \\\\\n0 & k_n(\\xi)\n\\end{bmatrix}, \\quad\nk_t(\\xi) = k_0 \\left(1 + \\alpha\\, \\xi\\right)^p, \\quad\nk_n(\\xi) = \\beta\\, k_t(\\xi),\n$$\nwith $k_0 > 0$, $\\alpha \\in \\mathbb{R}$, $p \\ge 1$, and $\\beta \\ge 0$.\n- The local distributed load vector $f^{loc}(\\xi) \\in \\mathbb{R}^2$ given by\n$$\nf^{loc}(\\xi) =\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}, \\quad\nq_t(\\xi) = q_0 \\left(1 + \\gamma\\, \\xi\\right), \\quad\nq_n(\\xi) = \\frac{1}{2}\\, q_0 \\cos\\left(\\pi\\, \\xi\\right),\n$$\nwith $q_0 \\in \\mathbb{R}$ and $\\gamma \\in \\mathbb{R}$.\n\nFrom the change-of-basis principle, the frame-consistent global stiffness density and global load density at the parameter $\\xi$ are given by\n$$\nK^{glob}(\\xi) = R(\\xi)^\\top K^{loc}(\\xi) R(\\xi), \\qquad\nf^{glob}(\\xi) = R(\\xi)^\\top f^{loc}(\\xi).\n$$\nThe element-consistent aggregates are the integrals\n$$\nS_{cons} = \\int_{-1}^{1} K^{glob}(\\xi)\\, d\\xi, \\qquad\nL_{cons} = \\int_{-1}^{1} f^{glob}(\\xi)\\, d\\xi,\n$$\nto be evaluated numerically using Gauss–Legendre quadrature with $n$ points, where $n$ is a fixed small integer. A commonly used, but potentially inconsistent, shortcut replaces the spatially varying rotation with a single rotation evaluated at the element center, $\\bar{R} = R(0)$, and transforms after integration:\n$$\nS_{naive} = \\bar{R}^\\top \\left( \\int_{-1}^{1} K^{loc}(\\xi)\\, d\\xi \\right) \\bar{R}, \\qquad\nL_{naive} = \\bar{R}^\\top \\left( \\int_{-1}^{1} f^{loc}(\\xi)\\, d\\xi \\right).\n$$\n\nTask:\n1. Starting from the fundamental principles stated above, derive the frame-consistent and shortcut (naive) formulations for $S_{cons}$, $L_{cons}$ and $S_{naive}$, $L_{naive}$, explicitly showing the role of the rotation field $R(\\xi)$ inside the integrals.\n2. Implement both formulations using Gauss–Legendre quadrature on $\\xi \\in [-1,1]$ with $n=8$ points.\n3. For each test case provided below, compute the relative consistency errors\n$$\ne_K = \\frac{\\left\\| S_{naive} - S_{cons} \\right\\|_F}{\\left\\| S_{cons} \\right\\|_F}, \\qquad\ne_F = \\frac{\\left\\| L_{naive} - L_{cons} \\right\\|_2}{\\left\\| L_{cons} \\right\\|_2},\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm of a matrix and $\\|\\cdot\\|_2$ denotes the Euclidean norm of a vector.\n4. Angles must be treated in radians. The final numerical answers are dimensionless real numbers.\n\nTest Suite (each case defines $\\theta(\\xi)$, $k_0$, $\\alpha$, $p$, $\\beta$, $q_0$, $\\gamma$):\n- Case $1$ (slowly varying rotation, mild grading): $\\theta(\\xi) = \\left(\\frac{\\pi}{6}\\right)\\, \\xi$, $k_0 = 1$, $\\alpha = 0.2$, $p = 2$, $\\beta = 0.3$, $q_0 = 1.0$, $\\gamma = 0.1$.\n- Case $2$ (rapidly varying rotation, stronger grading): $\\theta(\\xi) = \\left(\\frac{\\pi}{2}\\right)\\, \\sin(\\pi\\, \\xi)$, $k_0 = 1$, $\\alpha = 0.5$, $p = 3$, $\\beta = 0.5$, $q_0 = 1.0$, $\\gamma = 0.5$.\n- Case $3$ (constant rotation, variable stiffness): $\\theta(\\xi) = \\frac{\\pi}{4}$, $k_0 = 1$, $\\alpha = 0.8$, $p = 2$, $\\beta = 0.2$, $q_0 = 2.0$, $\\gamma = 0.3$.\n- Case $4$ (odd cubic rotation, constant stiffness): $\\theta(\\xi) = \\pi\\, \\xi^3$, $k_0 = 1$, $\\alpha = 0.0$, $p = 1$, $\\beta = 0.4$, $q_0 = 1.5$, $\\gamma = 0.0$.\n\nYour program must compute $(e_K, e_F)$ for each case and produce a single line of output containing a comma-separated list of the $8$ floating-point results in the order $[e_{K,1}, e_{F,1}, e_{K,2}, e_{F,2}, e_{K,3}, e_{F,3}, e_{K,4}, e_{F,4}]$, enclosed in square brackets, with angles interpreted in radians throughout.", "solution": "The problem requires the derivation and comparison of two methods for computing element-level aggregate stiffness and load vectors for a one-dimensional curved element: a frame-consistent approach and a computationally simpler, but potentially inaccurate, shortcut (naive) approach. The comparison is quantified by relative error metrics. The problem is well-posed, scientifically grounded in the principles of computational solid mechanics, and contains all necessary information for a unique numerical solution.\n\n### 1. Derivation of Formulations\n\nLet all field variables be functions of the element parameter $\\xi \\in [-1, 1]$. The rotation from the local material frame to the global frame is given by the angle $\\theta(\\xi)$, which defines the proper orthogonal rotation matrix:\n$$\nR(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi) & \\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\nThe local stiffness matrix $K^{loc}(\\xi)$ and local distributed load vector $f^{loc}(\\xi)$ are given as:\n$$\nK^{loc}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi) & 0 \\\\\n0 & k_n(\\xi)\n\\end{bmatrix}, \\qquad\nf^{loc}(\\xi) =\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}\n$$\n\n#### 1.1. Frame-Consistent Formulation\nThis formulation respects frame invariance at every point $\\xi$ along the element before integration. The global stiffness and load densities, $K^{glob}(\\xi)$ and $f^{glob}(\\xi)$, are first computed pointwise by transforming the local quantities to the global frame.\n\nThe global load density $f^{glob}(\\xi)$ is found by the change-of-basis rule for vectors:\n$$\nf^{glob}(\\xi) = R(\\xi)^\\top f^{loc}(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & \\sin\\theta(\\xi) \\\\\n-\\sin\\theta(\\xi) & \\cos\\theta(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nq_t(\\xi)\\cos\\theta(\\xi) + q_n(\\xi)\\sin\\theta(\\xi) \\\\\n-q_t(\\xi)\\sin\\theta(\\xi) + q_n(\\xi)\\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\nThe global stiffness density $K^{glob}(\\xi)$ is found by the change-of-basis rule for quadratic forms (or second-order tensors):\n$$\nK^{glob}(\\xi) = R(\\xi)^\\top K^{loc}(\\xi) R(\\xi)\n$$\nPerforming the matrix multiplication gives:\n$$\nK^{glob}(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & \\sin\\theta(\\xi) \\\\\n-\\sin\\theta(\\xi) & \\cos\\theta(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\nk_t(\\xi) & 0 \\\\\n0 & k_n(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi) & \\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\n$$\nK^{glob}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi)\\cos^2\\theta(\\xi) + k_n(\\xi)\\sin^2\\theta(\\xi) & (k_n(\\xi) - k_t(\\xi))\\cos\\theta(\\xi)\\sin\\theta(\\xi) \\\\\n(k_n(\\xi) - k_t(\\xi))\\cos\\theta(\\xi)\\sin\\theta(\\xi) & k_t(\\xi)\\sin^2\\theta(\\xi) + k_n(\\xi)\\cos^2\\theta(\\xi)\n\\end{bmatrix}\n$$\nThe element-consistent aggregates, $S_{cons}$ and $L_{cons}$, are the integrals of these global densities over the element domain:\n$$\nS_{cons} = \\int_{-1}^{1} K^{glob}(\\xi) \\,d\\xi, \\qquad L_{cons} = \\int_{-1}^{1} f^{glob}(\\xi) \\,d\\xi\n$$\nThese integrals are evaluated using $n$-point Gauss–Legendre quadrature. For a generic integrand $g(\\xi)$:\n$$\n\\int_{-1}^{1} g(\\xi) \\,d\\xi \\approx \\sum_{i=1}^{n} w_i g(\\xi_i)\n$$\nwhere $\\{\\xi_i\\}$ are the Gauss points and $\\{w_i\\}$ are the corresponding weights. For this problem, $n=8$. Thus, the consistent aggregates are computed as:\n$$\nS_{cons} \\approx \\sum_{i=1}^{8} w_i K^{glob}(\\xi_i), \\qquad L_{cons} \\approx \\sum_{i=1}^{8} w_i f^{glob}(\\xi_i)\n$$\n\n#### 1.2. Shortcut (Naive) Formulation\nThis formulation reverses the order of operations: it first integrates the local quantities and then applies a single rotation based on the element's center point, $\\xi=0$.\n\nFirst, the integrated local stiffness and load are computed:\n$$\nK^{loc}_{int} = \\int_{-1}^{1} K^{loc}(\\xi) \\,d\\xi = \\int_{-1}^{1} \\begin{bmatrix} k_t(\\xi) & 0 \\\\ 0 & k_n(\\xi) \\end{bmatrix} \\,d\\xi = \\begin{bmatrix} \\int_{-1}^{1} k_t(\\xi) \\,d\\xi & 0 \\\\ 0 & \\int_{-1}^{1} k_n(\\xi) \\,d\\xi \\end{bmatrix}\n$$\n$$\nf^{loc}_{int} = \\int_{-1}^{1} f^{loc}(\\xi) \\,d\\xi = \\int_{-1}^{1} \\begin{bmatrix} q_t(\\xi) \\\\ q_n(\\xi) \\end{bmatrix} \\,d\\xi = \\begin{bmatrix} \\int_{-1}^{1} q_t(\\xi) \\,d\\xi \\\\ \\int_{-1}^{1} q_n(\\xi) \\,d\\xi \\end{bmatrix}\n$$\nThese integrals are evaluated numerically using the same Gauss quadrature scheme:\n$$\nK^{loc}_{int} \\approx \\sum_{i=1}^{8} w_i K^{loc}(\\xi_i), \\qquad f^{loc}_{int} \\approx \\sum_{i=1}^{8} w_i f^{loc}(\\xi_i)\n$$\nNext, a single, constant rotation matrix $\\bar{R}$ is evaluated at the element center, $\\xi=0$:\n$$\n\\bar{R} = R(0) =\n\\begin{bmatrix}\n\\cos\\theta(0) & -\\sin\\theta(0) \\\\\n\\sin\\theta(0) & \\cos\\theta(0)\n\\end{bmatrix}\n$$\nThe naive aggregates, $S_{naive}$ and $L_{naive}$, are then computed by applying this single rotation to the integrated local quantities:\n$$\nS_{naive} = \\bar{R}^\\top K^{loc}_{int} \\bar{R}, \\qquad L_{naive} = \\bar{R}^\\top f^{loc}_{int}\n$$\nThis approach is only exact if the rotation field $R(\\xi)$ is constant over the element, in which case $\\bar{R} = R(\\xi)$ for all $\\xi \\in [-1, 1]$.\n\n### 2. Error Metrics\nThe discrepancy between the two formulations is measured using the relative consistency errors $e_K$ and $e_F$.\n\nThe error in the stiffness matrix is measured using the Frobenius norm, $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$:\n$$\ne_K = \\frac{\\| S_{naive} - S_{cons} \\|_F}{\\| S_{cons} \\|_F}\n$$\nThe error in the load vector is measured using the Euclidean norm (or $L_2$-norm), $\\|v\\|_2 = \\sqrt{\\sum_i |v_i|^2}$:\n$$\ne_F = \\frac{\\| L_{naive} - L_{cons} \\|_2}{\\| L_{cons} \\|_2}\n$$\nIf $S_{cons}$ or $L_{cons}$ has a zero norm, the corresponding error is taken to be zero, which occurs if and only if the numerator is also zero.\n\n### 3. Computational Procedure\nThe numerical implementation will proceed as follows for each test case:\n1.  Define the parameter-dependent functions for the case: $\\theta(\\xi)$, $k_t(\\xi)$, $k_n(\\xi)$, $q_t(\\xi)$, and $q_n(\\xi)$.\n2.  Obtain the $n=8$ Gauss-Legendre quadrature points $\\xi_i$ and weights $w_i$.\n3.  Initialize four accumulators to zero: $S_{cons}$, $L_{cons}$, $K^{loc}_{int}$, and $f^{loc}_{int}$.\n4.  Loop through the $8$ Gauss points. At each point $\\xi_i$:\n    a. Evaluate all field functions: $\\theta(\\xi_i)$, $k_t(\\xi_i)$, $k_n(\\xi_i)$, $q_t(\\xi_i)$, $q_n(\\xi_i)$.\n    b. Construct the matrices $R(\\xi_i)$ and $K^{loc}(\\xi_i)$, and the vector $f^{loc}(\\xi_i)$.\n    c. Calculate the global densities $K^{glob}(\\xi_i) = R(\\xi_i)^\\top K^{loc}(\\xi_i) R(\\xi_i)$ and $f^{glob}(\\xi_i) = R(\\xi_i)^\\top f^{loc}(\\xi_i)$.\n    d. Add the weighted contributions to the consistent sums: $S_{cons} \\leftarrow S_{cons} + w_i K^{glob}(\\xi_i)$ and $L_{cons} \\leftarrow L_{cons} + w_i f^{glob}(\\xi_i)$.\n    e. Add the weighted contributions to the intermediate naive sums: $K^{loc}_{int} \\leftarrow K^{loc}_{int} + w_i K^{loc}(\\xi_i)$ and $f^{loc}_{int} \\leftarrow f^{loc}_{int} + w_i f^{loc}(\\xi_i)$.\n5.  After the loop, calculate the naive aggregates:\n    a. Evaluate $\\bar{R} = R(0)$.\n    b. Compute $S_{naive} = \\bar{R}^\\top K^{loc}_{int} \\bar{R}$ and $L_{naive} = \\bar{R}^\\top f^{loc}_{int}$.\n6.  Finally, compute the relative errors $e_K$ and $e_F$ using the specified norm definitions. These two values constitute the result for the test case.\nThis procedure is repeated for all four test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes consistency errors for two different FEA formulations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (theta_func, k0, alpha, p, beta, q0, gamma)\n    test_cases = [\n        (lambda xi: (np.pi / 6.0) * xi, 1.0, 0.2, 2, 0.3, 1.0, 0.1),\n        (lambda xi: (np.pi / 2.0) * np.sin(np.pi * xi), 1.0, 0.5, 3, 0.5, 1.0, 0.5),\n        (lambda xi: np.pi / 4.0, 1.0, 0.8, 2, 0.2, 2.0, 0.3),\n        (lambda xi: np.pi * (xi**3), 1.0, 0.0, 1, 0.4, 1.5, 0.0),\n    ]\n\n    # Number of Gauss-Legendre quadrature points\n    n_gauss = 8\n    gauss_points, gauss_weights = np.polynomial.legendre.leggauss(n_gauss)\n\n    results = []\n\n    for case in test_cases:\n        theta_func, k0, alpha, p, beta, q0, gamma = case\n\n        # Define material and load functions based on case parameters\n        def k_t(xi):\n            return k0 * (1.0 + alpha * xi)**p\n\n        def k_n(xi):\n            return beta * k_t(xi)\n\n        def q_t(xi):\n            return q0 * (1.0 + gamma * xi)\n\n        def q_n(xi):\n            return 0.5 * q0 * np.cos(np.pi * xi)\n\n        # Initialize aggregators\n        S_cons = np.zeros((2, 2))\n        L_cons = np.zeros(2)\n        K_loc_int = np.zeros((2, 2))\n        f_loc_int = np.zeros(2)\n\n        # Perform Gauss-Legendre quadrature\n        for i in range(n_gauss):\n            xi = gauss_points[i]\n            w = gauss_weights[i]\n\n            # Evaluate fields at the current Gauss point\n            th = theta_func(xi)\n            kt_val = k_t(xi)\n            kn_val = k_n(xi)\n            qt_val = q_t(xi)\n            qn_val = q_n(xi)\n            \n            # Construct local matrices and vectors\n            K_loc = np.array([[kt_val, 0.0], [0.0, kn_val]])\n            f_loc = np.array([qt_val, qn_val])\n\n            # Construct rotation matrix\n            c, s = np.cos(th), np.sin(th)\n            R = np.array([[c, -s], [s, c]])\n            R_T = R.T\n            \n            # --- Consistent Formulation: Transform then Integrate ---\n            K_glob = R_T @ K_loc @ R\n            f_glob = R_T @ f_loc\n            \n            S_cons += w * K_glob\n            L_cons += w * f_glob\n            \n            # --- Naive Formulation: Integrate then Transform ---\n            K_loc_int += w * K_loc\n            f_loc_int += w * f_loc\n\n        # Finalize the naive formulation calculation\n        th_0 = theta_func(0.0)\n        c0, s0 = np.cos(th_0), np.sin(th_0)\n        R_bar = np.array([[c0, -s0], [s0, c0]])\n        R_bar_T = R_bar.T\n\n        S_naive = R_bar_T @ K_loc_int @ R_bar\n        L_naive = R_bar_T @ f_loc_int\n        \n        # Calculate relative consistency errors\n        norm_S_cons = np.linalg.norm(S_cons, 'fro')\n        if norm_S_cons == 0.0:\n            e_K = 0.0\n        else:\n            e_K = np.linalg.norm(S_naive - S_cons, 'fro') / norm_S_cons\n\n        norm_L_cons = np.linalg.norm(L_cons)\n        if norm_L_cons == 0.0:\n            e_F = 0.0\n        else:\n            e_F = np.linalg.norm(L_naive - L_cons) / norm_L_cons\n        \n        results.extend([e_K, e_F])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3554988"}]}