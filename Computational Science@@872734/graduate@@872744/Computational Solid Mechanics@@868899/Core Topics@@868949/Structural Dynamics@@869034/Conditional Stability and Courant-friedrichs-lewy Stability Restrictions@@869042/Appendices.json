{"hands_on_practices": [{"introduction": "Understanding the Courant-Friedrichs-Lewy (CFL) condition begins with its origin. This exercise provides a foundational, first-principles derivation of the stability limit for an explicit time integration scheme. By analyzing a simple one-dimensional elastic bar, we will connect the physical wave speed, the spatial discretization size, and the maximum allowable time step, revealing how numerical stability is fundamentally tied to the speed of information propagation through the finite element mesh [@problem_id:3550116].", "problem": "Consider one-dimensional small-strain elastodynamics for a uniform slender bar with axial displacement field $u(x,t)$, cross-sectional area $A$, Young’s modulus $E$, and mass density $\\rho$. The governing equations follow from balance of linear momentum and the constitutive relation for a linear elastic solid: the axial stress satisfies $\\sigma=E\\varepsilon$ with axial strain $\\varepsilon = \\frac{\\partial u}{\\partial x}$, and the equation of motion is $\\rho A \\frac{\\partial^2 u}{\\partial t^2} = \\frac{\\partial (\\sigma A)}{\\partial x}$. The bar is discretized along its axis by a uniform mesh of $N$ linear two-noded finite elements of size $h$, using standard linear shape functions and a lumped mass matrix. Assume interior nodes in a large uniform mesh so that each interior nodal equation is representative of the spatially repeated structure.\n\nUsing the explicit central difference time integrator applied to the semi-discrete finite element equations, derive from first principles the conditional stability restriction on the time step $\\Delta t$ by analyzing the discrete equations of motion and the spectrum induced by the spatial discretization. Compute the maximum stable time step $\\Delta t_{\\max}$ in closed form as a function of the material parameters $E$ and $\\rho$, and the element size $h$, and then express the result in terms of the bar wave speed $c=\\sqrt{E/\\rho}$. Explain the relation of your bound to the Courant-Friedrichs-Lewy (CFL) condition.\n\nExpress the final time step in seconds. No numerical values are required; give a single symbolic expression for $\\Delta t_{\\max}$ in terms of $E$, $\\rho$, $h$, and $c$.", "solution": "The problem statement is evaluated to be valid as it is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution. It describes a standard problem in computational solid mechanics.\n\nThe problem asks for the derivation of the maximum stable time step, $\\Delta t_{\\max}$, for the explicit central difference time integration of the semi-discrete equations of motion for a one-dimensional elastic bar. The bar is spatially discretized using linear two-noded finite elements with a lumped mass matrix.\n\nFirst, we establish the governing partial differential equation (PDE). The equation of motion is given as $\\rho A \\frac{\\partial^2 u}{\\partial t^2} = \\frac{\\partial(\\sigma A)}{\\partial x}$. With a uniform cross-section $A$, Young's modulus $E$, and mass density $\\rho$, the stress is $\\sigma=E\\,\\varepsilon$, and the strain is $\\varepsilon=\\frac{\\partial u}{\\partial x}$. Substituting these into the equation of motion yields:\n$$\n\\rho A \\frac{\\partial^2 u}{\\partial t^2} = \\frac{\\partial}{\\partial x} \\left( E A \\frac{\\partial u}{\\partial x} \\right)\n$$\nSince $E$ and $A$ are uniform along the bar, this simplifies to the one-dimensional wave equation:\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = \\frac{E}{\\rho} \\frac{\\partial^2 u}{\\partial x^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere $c = \\sqrt{E/\\rho}$ is the speed of propagation of longitudinal waves in the bar.\n\nNext, we perform the spatial discretization using the finite element method. We consider a single generic linear element of length $h$ connecting nodes $i$ and $i+1$. The displacement field within this element, $u^{(e)}(x)$, is interpolated from the nodal displacements $u_i$ and $u_{i+1}$ using linear shape functions $N_i(x)$ and $N_{i+1}(x)$. The element stiffness matrix, $\\mathbf{K}^{(e)}$, is given by:\n$$\n\\mathbf{K}^{(e)} = \\int_{V^{(e)}} \\mathbf{B}^T E \\mathbf{B} \\, dV = A E \\int_{0}^{h} \\mathbf{B}^T \\mathbf{B} \\, dx\n$$\nwhere $\\mathbf{B} = \\left[ \\frac{dN_i}{dx}, \\frac{dN_{i+1}}{dx} \\right] = \\left[ -\\frac{1}{h}, \\frac{1}{h} \\right]$. Integrating over the element length $h$ gives:\n$$\n\\mathbf{K}^{(e)} = A E h \\begin{pmatrix} -1/h \\\\ 1/h \\end{pmatrix} \\begin{pmatrix} -1/h & 1/h \\end{pmatrix} = \\frac{AE}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe problem specifies a lumped mass matrix. For a linear element, the total mass $\\rho A h$ is distributed equally to its two nodes. The element lumped mass matrix, $\\mathbf{M}_L^{(e)}$, is therefore:\n$$\n\\mathbf{M}_L^{(e)} = \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nWe now assemble the semi-discrete equation of motion for a generic interior node $j$, which is connected to the element spanning nodes $(j-1, j)$ and the element spanning nodes $(j, j+1)$. The system of ordinary differential equations (ODEs) for free vibration is $\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{0}$. The equation for the $j$-th degree of freedom is:\n$$\nM_j \\ddot{u}_j + \\sum_k K_{jk} u_k = 0\n$$\nThe mass $M_j$ at node $j$ is the sum of contributions from the two adjacent elements: $M_j = \\frac{\\rho A h}{2} + \\frac{\\rho A h}{2} = \\rho A h$.\nThe stiffness contributions to the $j$-th row of the global stiffness matrix come from the assembled element matrices:\n$($Row $j$ of $\\mathbf{K u}) = K_{j,j-1}u_{j-1} + K_{j,j}u_j + K_{j,j+1}u_{j+1}$.\nFrom the structure of $\\mathbf{K}^{(e)}$, we find:\n$K_{j,j-1} = -\\frac{AE}{h}$\n$K_{j,j} = \\frac{AE}{h} + \\frac{AE}{h} = \\frac{2AE}{h}$\n$K_{j,j+1} = -\\frac{AE}{h}$\nThe semi-discrete equation for an interior node $j$ is:\n$$\n(\\rho A h) \\ddot{u}_j + \\frac{AE}{h} (2 u_j - u_{j-1} - u_{j+1}) = 0\n$$\nDividing by $\\rho A h$, we obtain:\n$$\n\\ddot{u}_j + \\frac{E}{\\rho h^2} (2 u_j - u_{j-1} - u_{j+1}) = 0\n$$\nThis equation represents a system of coupled ODEs, one for each interior node. To find the stability limit of the time integration scheme, we must first find the maximum natural frequency, $\\omega_{\\max}$, of this discrete system. The natural frequencies are found by assuming a harmonic solution of the form $u_j(t) = v_j e^{i\\omega t}$, leading to the generalized eigenvalue problem $\\mathbf{K}\\mathbf{v} = \\omega^2 \\mathbf{M} \\mathbf{v}$. For the infinite, uniform mesh, we can analyze this by assuming a spatial mode shape of the form $u_j(t) = \\hat{u} e^{i(k x_j - \\omega t)}$, where $x_j=jh$ is the position of node $j$ and $k$ is the wavenumber. Substituting this into the semi-discrete equation:\n$$\n-\\omega^2 e^{ikjh} + \\frac{E}{\\rho h^2} (2 e^{ikjh} - e^{ik(j-1)h} - e^{ik(j+1)h}) = 0\n$$\nDividing by $e^{ikjh}$ gives the dispersion relation for the numerical scheme:\n$$\n\\omega^2 = \\frac{E}{\\rho h^2} (2 - e^{-ikh} - e^{ikh}) = \\frac{E}{\\rho h^2} (2 - 2\\cos(kh))\n$$\nUsing the half-angle trigonometric identity $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$:\n$$\n\\omega^2 = \\frac{2E}{\\rho h^2} (2 \\sin^2(kh/2)) = \\frac{4E}{\\rho h^2} \\sin^2(kh/2)\n$$\nThe frequency $\\omega$ is thus given by:\n$$\n\\omega(k) = \\frac{2}{h} \\sqrt{\\frac{E}{\\rho}} |\\sin(kh/2)| = \\frac{2c}{h} |\\sin(kh/2)|\n$$\nThe maximum frequency, $\\omega_{\\max}$, occurs when $|\\sin(kh/2)| = 1$. This corresponds to the highest spatial frequency the mesh can represent, which has a wavelength of $\\lambda_{\\min} = 2h$. For this mode, the wavenumber is $k_{\\max} = 2\\pi/\\lambda_{\\min} = \\pi/h$, which gives $k_{\\max}h/2 = \\pi/2$, and indeed $\\sin(\\pi/2)=1$.\nTherefore, the maximum natural frequency of the discrete system is:\n$$\n\\omega_{\\max} = \\frac{2c}{h} = \\frac{2}{h} \\sqrt{\\frac{E}{\\rho}}\n$$\nThe explicit central difference time integration scheme is conditionally stable. The stability condition relates the time step $\\Delta t$ to the maximum frequency of the system:\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}}\n$$\nSubstituting the derived value for $\\omega_{\\max}$:\n$$\n\\Delta t \\le \\frac{2}{(2c/h)} = \\frac{h}{c}\n$$\nThe maximum stable time step is therefore:\n$$\n\\Delta t_{\\max} = \\frac{h}{c}\n$$\nThis result can be expressed in terms of the material properties $E$ and $\\rho$ and the element size $h$:\n$$\n\\Delta t_{\\max} = \\frac{h}{\\sqrt{E/\\rho}} = h \\sqrt{\\frac{\\rho}{E}}\n$$\nThis stability limit is directly related to the Courant-Friedrichs-Lewy (CFL) condition. The CFL condition is a necessary condition for convergence, stating that the numerical domain of dependence must contain the physical domain of dependence. For the 1D wave equation, a wave travels a distance $c \\Delta t$ in a time interval $\\Delta t$. In our numerical scheme (which is equivalent to a second-order central finite difference scheme for this uniform mesh), the value at a node $(j, n+1)$ depends on data from nodes $j-1$, $j$, and $j+1$ at previous time steps. The numerical \"speed\" of information propagation is thus $h/\\Delta t$. The CFL condition requires that a physical wave not propagate further than one element length in a single time step, ensuring that the numerical scheme can \"capture\" the physical phenomenon. This translates to the inequality $c \\Delta t \\le h$, or $\\Delta t \\le h/c$. Our derived stability limit $\\Delta t_{\\max} = h/c$ corresponds to the case where the Courant number, $\\mathcal{C} = c \\Delta t/h$, is equal to its limit of $1$.", "answer": "$$\n\\boxed{\\frac{h}{c}}\n$$", "id": "3550116"}, {"introduction": "Real-world engineering systems are often composed of multiple materials and discretized with non-uniform meshes. This practice extends the CFL concept to these more complex, heterogeneous scenarios [@problem_id:3550140]. We will employ Gershgorin's Circle Theorem, a powerful tool from matrix analysis, to efficiently estimate the highest system frequency and its corresponding stability limit, demonstrating how the global time step restriction is governed by the most challenging local conditions in the mesh.", "problem": "You are given a one-dimensional heterogeneous elastic bar discretized by linear two-node Finite Element Method (FEM) axial elements for small-amplitude undamped longitudinal vibrations. The semi-discrete equations of motion for nodal displacements are of the form $M \\ddot{u} + K u = 0$, where $K$ is the global stiffness matrix and $M$ is the global mass matrix. Consider the generalized eigenvalue problem $K \\phi = \\omega^2 M \\phi$ governing the natural frequencies $\\omega$. Your tasks are to construct $(K, M)$ from first principles for a heterogeneous bar, estimate an upper bound on the largest squared eigenvalue using Gershgorin’s theorem, convert it to a bound on the largest frequency $\\omega_{\\max}$, compute the corresponding explicit time integration stability limit $\\Delta t_{\\text{cr}} = 2 / \\omega_{\\max}$, and compare this to a mesh-size-based Courant–Friedrichs–Lewy (CFL) estimate.\n\nUse the following fundamental bases and data:\n- The $e$-th element has length $\\ell_e$ (in $\\text{m}$), Young’s modulus $E_e$ (in $\\text{Pa}$), density $\\rho_e$ (in $\\text{kg}/\\text{m}^3$), and constant cross-sectional area $A$ (in $\\text{m}^2$). Assume $A = 1\\,\\text{m}^2$ for all cases. The bar is free of external forces and constraints; natural frequencies are computed from the free–free system.\n- The $2 \\times 2$ elemental stiffness matrix for axial deformation is $k^{(e)} = \\dfrac{E_e A}{\\ell_e} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$.\n- Use a lumped elemental mass matrix with nodal masses $m^{(e)} = \\dfrac{\\rho_e A \\ell_e}{2}$ assigned to each of the two nodes of element $e$. Assemble these into a global diagonal mass matrix $M$.\n- With lumped $M$, consider the row-wise diagonally scaled matrix $A = M^{-1} K$ whose eigenvalues are the squared natural frequencies $\\lambda = \\omega^2$ of the generalized problem. For the $i$-th row of $A$, define the Gershgorin disc center $c_i = a_{ii}$ and radius $r_i = \\sum_{j \\neq i} |a_{ij}|$, and use the resulting bound $\\lambda_{\\max} \\le \\max_i \\left(c_i + r_i\\right)$. Set $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$ and the explicit central-difference critical time step $\\Delta t_{\\text{cr}} = 2 / \\omega_{\\max}$.\n- Independently, define a mesh-size-based CFL estimate using the one-dimensional dilatational wave speed $c_e = \\sqrt{E_e / \\rho_e}$ for each element and the local element size $\\ell_e$, namely $\\Delta t_{\\text{CFL}} = \\min_e \\dfrac{\\ell_e}{c_e}$. Express all time quantities in seconds.\n\nImplement a program that:\n1. Assembles the global stiffness matrix $K$ and the global lumped mass matrix $M$ from the given element data.\n2. Forms $A = M^{-1} K$ using the diagonal of $M$.\n3. Computes the Gershgorin upper bound on $\\lambda_{\\max}$ and thus $\\Delta t_{\\text{cr}} = 2/\\sqrt{\\lambda_{\\max}}$.\n4. Computes $\\Delta t_{\\text{CFL}} = \\min_e \\ell_e / \\sqrt{E_e/\\rho_e}$.\n5. Returns, for each test case, three values: $\\Delta t_{\\text{cr}}$ in seconds, $\\Delta t_{\\text{CFL}}$ in seconds, and the dimensionless ratio $r = \\Delta t_{\\text{cr}} / \\Delta t_{\\text{CFL}}$.\n\nUse the following test suite, with all quantities in SI units:\n- Case 1 (uniform, steel-like): $N=10$ elements; $\\ell_e = 0.1$ for all $e$; $E_e = 2.10 \\times 10^{11}$; $\\rho_e = 7800$; $A = 1$.\n- Case 2 (alternating heterogeneity, steel/aluminum-like): $N=8$ elements; $\\ell_e = 0.125$ for all $e$; $E_e = [7.0 \\times 10^{10}, 2.10 \\times 10^{11}, 7.0 \\times 10^{10}, 2.10 \\times 10^{11}, 7.0 \\times 10^{10}, 2.10 \\times 10^{11}, 7.0 \\times 10^{10}, 2.10 \\times 10^{11}]$; $\\rho_e = [2700, 7800, 2700, 7800, 2700, 7800, 2700, 7800]$; $A = 1$.\n- Case 3 (nonuniform mesh with a very small element): $N=5$ elements; $\\ell_e = [0.5, 0.3, 0.15, 0.04, 0.01]$; $E_e = 2.00 \\times 10^{11}$ for all $e$; $\\rho_e = 8000$ for all $e$; $A = 1$.\n- Case 4 (single element): $N=1$ element; $\\ell_e = [2.0]$; $E_e = [1.0 \\times 10^{9}]$; $\\rho_e = [1000]$; $A = 1$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Concatenate the triplets for all test cases in order. That is, the output must be of the form $[\\Delta t_{\\text{cr}}^{(1)}, \\Delta t_{\\text{CFL}}^{(1)}, r^{(1)}, \\Delta t_{\\text{cr}}^{(2)}, \\Delta t_{\\text{CFL}}^{(2)}, r^{(2)}, \\ldots]$, where each $\\Delta t$ is in seconds and each $r$ is dimensionless.", "solution": "The user wants to solve a computational solid mechanics problem.\n\n### Step 1: Extract Givens\n- **Governing Equation**: Semi-discrete equations of motion for nodal displacements are $M \\ddot{u} + K u = 0$.\n- **Eigenvalue Problem**: Natural frequencies $\\omega$ are governed by the generalized eigenvalue problem $K \\phi = \\omega^2 M \\phi$.\n- **Element Properties**: Element $e$ has length $\\ell_e$ (m), Young’s modulus $E_e$ (Pa), and density $\\rho_e$ (kg/m³).\n- **Cross-Sectional Area**: The area $A$ is constant and equal to $1\\,\\text{m}^2$.\n- **Boundary Conditions**: The bar is free of external forces and constraints (free-free system).\n- **Elemental Stiffness Matrix**: $k^{(e)} = \\dfrac{E_e A}{\\ell_e} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$.\n- **Elemental Mass Matrix**: A lumped mass matrix is used, with nodal masses $m^{(e)} = \\dfrac{\\rho_e A \\ell_e}{2}$ for each of the two nodes of element $e$. The global mass matrix $M$ is diagonal.\n- **Matrix for Analysis**: $A = M^{-1} K$, whose eigenvalues are $\\lambda = \\omega^2$.\n- **Gershgorin Bound**: $\\lambda_{\\max} \\le \\max_i \\left(c_i + r_i\\right)$, with disc center $c_i = a_{ii}$ and radius $r_i = \\sum_{j \\neq i} |a_{ij}|$.\n- **Critical Time Step (Gershgorin)**: $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$, and $\\Delta t_{\\text{cr}} = 2 / \\omega_{\\max}$.\n- **Critical Time Step (CFL)**: $\\Delta t_{\\text{CFL}} = \\min_e \\dfrac{\\ell_e}{c_e}$, where the dilatational wave speed is $c_e = \\sqrt{E_e / \\rho_e}$.\n- **Output**: For each test case, return $[\\Delta t_{\\text{cr}}, \\Delta t_{\\text{CFL}}, r]$, where $r = \\Delta t_{\\text{cr}} / \\Delta t_{\\text{CFL}}$.\n- **Test Cases**:\n    1.  Case 1 (uniform): $N=10$, $\\ell_e = 0.1$, $E_e = 2.10 \\times 10^{11}$, $\\rho_e = 7800$, $A = 1$.\n    2.  Case 2 (alternating): $N=8$, $\\ell_e = 0.125$, alternating $E_e = [7.0 \\times 10^{10}, 2.10 \\times 10^{11}]$ and $\\rho_e = [2700, 7800]$, $A = 1$.\n    3.  Case 3 (nonuniform mesh): $N=5$, $\\ell_e = [0.5, 0.3, 0.15, 0.04, 0.01]$, $E_e = 2.00 \\times 10^{11}$, $\\rho_e = 8000$, $A = 1$.\n    4.  Case 4 (single element): $N=1$, $\\ell_e = [2.0]$, $E_e = [1.0 \\times 10^{9}]$, $\\rho_e = [1000]$, $A = 1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific Soundness**: The problem is a standard exercise in the finite element analysis of wave propagation. The governing equations, element formulations (linear axial element), mass lumping, Gershgorin's theorem, and the CFL condition are all fundamental and correctly stated concepts in computational solid mechanics and numerical analysis. The stability limit $\\Delta t \\le 2/\\omega_{\\max}$ is the correct condition for the explicit central difference time integration scheme, which is implicitly assumed.\n- **Well-Posedness**: The problem is fully specified. All necessary data and formulas are provided to construct a unique numerical solution for each test case. The free-free boundary condition leads to a singular stiffness matrix $K$, which is physically correct (it allows for a rigid-body mode with $\\omega=0$). This does not pose an issue for the calculation, as the stability is governed by the maximum frequency $\\omega_{\\max}$, which is well-defined and positive.\n- **Objectivity**: The problem is stated in precise, quantitative terms, free from any subjective or ambiguous language.\n\nThe problem does not exhibit any of the invalidity flaws. It is a well-defined, verifiable problem in computational engineering.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\nThe solution requires constructing the global stiffness and mass matrices, applying Gershgorin's theorem to estimate the maximum eigenvalue, and calculating two different estimates for the critical time step for explicit time integration.\n\nA one-dimensional bar discretized into $N$ linear elements has $N+1$ nodes, indexed from $0$ to $N$. The global stiffness matrix $K$ and mass matrix $M$ are of size $(N+1) \\times (N+1)$.\n\n**1. Matrix Assembly**\nWe assemble the global matrices by summing the contributions from each element. For an element $e$ connecting nodes $i=e$ and $j=e+1$, its stiffness and mass are added to the global matrices.\n\n**Global Mass Matrix ($M$)**: The problem specifies a lumped mass matrix. The mass of element $e$, $\\rho_e A \\ell_e$, is split equally between its two nodes. An interior node $i$ (for $i=1, \\ldots, N-1$) is shared by a;element $i-1$ and element $i$. Its mass is the sum of contributions from both:\n$$M_{ii} = \\frac{\\rho_{i-1} A \\ell_{i-1}}{2} + \\frac{\\rho_i A \\ell_i}{2}$$\nThe end nodes $0$ and $N$ are connected to only one element each:\n$$M_{00} = \\frac{\\rho_0 A \\ell_0}{2}, \\quad M_{NN} = \\frac{\\rho_{N-1} A \\ell_{N-1}}{2}$$\nSince $M$ is a lumped mass matrix, all off-diagonal entries are zero, i.e., $M_{ij}=0$ for $i \\neq j$.\n\n**Global Stiffness Matrix ($K$)**: The elemental stiffness matrix for element $e$ is $k^{(e)} = \\frac{E_e A}{\\ell_e} \\begin{bsmallmatrix} 1 & -1 \\\\ -1 & 1 \\end{bsmallmatrix}$. Assembling these for all elements, an interior diagonal term $K_{ii}$ receives stiffness from elements $i-1$ and $i$:\n$$K_{ii} = \\frac{E_{i-1} A}{\\ell_{i-1}} + \\frac{E_i A}{\\ell_i}$$\nThe end-node diagonal terms are:\n$$K_{00} = \\frac{E_0 A}{\\ell_0}, \\quad K_{NN} = \\frac{E_{N-1} A}{\\ell_{N-1}}$$\nThe off-diagonal terms corresponding to element $e$ connecting nodes $e$ and $e+1$ are $K_{e, e+1} = K_{e+1, e} = -\\frac{E_e A}{\\ell_e}$.\n\n**2. Gershgorin Bound and Critical Time Step ($\\Delta t_{\\text{cr}}$)**\nWe analyze the matrix $A = M^{-1}K$. Since $M$ is diagonal, $M^{-1}$ is also diagonal with entries $(M^{-1})_{ii} = 1/M_{ii}$. The entries of $A$ are $a_{ij} = K_{ij} / M_{ii}$.\n\nGershgorin's theorem states that all eigenvalues of $A$ lie within the union of discs $D_i$ in the complex plane, where each disc is centered at $c_i = a_{ii}$ with radius $r_i = \\sum_{j \\neq i} |a_{ij}|$. This provides a bound on the maximum eigenvalue: $\\lambda_{\\max} \\le \\max_i(c_i + r_i)$.\n\nA key property of the stiffness matrix for a free-free system is that its row (and column) sums are zero: $\\sum_j K_{ij} = 0$. Since all off-diagonal terms $K_{ij}$ ($i \\neq j$) are non-positive, this means $K_{ii} = -\\sum_{j \\neq i} K_{ij} = \\sum_{j \\neq i} |K_{ij}|$.\n\nUsing this property, we can simplify the expression for the Gershgorin radius $r_i$:\n$$r_i = \\sum_{j \\neq i} |a_{ij}| = \\sum_{j \\neq i} \\frac{|K_{ij}|}{M_{ii}} = \\frac{1}{M_{ii}} \\sum_{j \\neq i} |K_{ij}| = \\frac{K_{ii}}{M_{ii}} = a_{ii} = c_i$$\nThis remarkable result, $r_i = c_i$, holds for every node $i$ in this specific formulation. The Gershgorin bound for each row is simply $c_i + r_i = 2a_{ii}$. The overall bound on the maximum eigenvalue is:\n$$\\lambda_{\\max} \\le \\max_i(2a_{ii})$$\nLet's analyze $a_{ii}$. For an end node, e.g., node $0$:\n$$a_{00} = \\frac{K_{00}}{M_{00}} = \\frac{E_0 A / \\ell_0}{\\rho_0 A \\ell_0 / 2} = \\frac{2 E_0}{\\rho_0 \\ell_0^2} = 2 \\frac{c_0^2}{\\ell_0^2}$$\nwhere $c_e = \\sqrt{E_e/\\rho_e}$ is the wave speed. The bound from this row is $2a_{00} = 4(c_0/\\ell_0)^2$.\nFor an interior node $i$:\n$$a_{ii} = \\frac{K_{ii}}{M_{ii}} = \\frac{E_{i-1} A / \\ell_{i-1} + E_i A / \\ell_i}{(\\rho_{i-1} A \\ell_{i-1} + \\rho_i A \\ell_i) / 2} = 2 \\frac{E_{i-1}/\\ell_{i-1} + E_i/\\ell_i}{\\rho_{i-1}\\ell_{i-1} + \\rho_i\\ell_i}$$\nThis expression is a weighted average. Let $w_e = \\rho_e \\ell_e$ and $s_e^2 = c_e^2/\\ell_e^2 = E_e/(\\rho_e \\ell_e^2)$. Then $E_e/\\ell_e = w_e s_e^2$. The term $2a_{ii}$ becomes:\n$$2a_{ii} = 4 \\frac{w_{i-1}s_{i-1}^2 + w_i s_i^2}{w_{i-1}+w_i}$$\nThe value of a weighted average is bounded by the minimum and maximum of the values being averaged. Therefore, $2a_{ii} \\le 4 \\max(s_{i-1}^2, s_i^2)$.\nCombining the bounds from all rows (end and interior), the maximum is determined by the maximum of all $4s_e^2 = 4(c_e/\\ell_e)^2$ terms:\n$$\\max_i(2a_{ii}) = \\max_e \\left(4 \\frac{c_e^2}{\\ell_e^2}\\right) = 4 \\left(\\max_e \\frac{c_e}{\\ell_e}\\right)^2$$\nThus, the Gershgorin bound on $\\lambda_{\\max} = \\omega_{\\max}^2$ is:\n$$\\lambda_{\\max} \\le 4 \\left(\\max_e \\frac{c_e}{\\ell_e}\\right)^2 \\implies \\omega_{\\max} \\le 2 \\left(\\max_e \\frac{c_e}{\\ell_e}\\right)$$\nThe critical time step is then calculated using this upper bound for $\\omega_{\\max}$:\n$$\\Delta t_{\\text{cr}} = \\frac{2}{\\omega_{\\max, \\text{bound}}} = \\frac{2}{2 \\max_e (c_e/\\ell_e)} = \\frac{1}{\\max_e (c_e/\\ell_e)} = \\min_e \\left(\\frac{\\ell_e}{c_e}\\right)$$\n\n**3. CFL-based Critical Time Step ($\\Delta t_{\\text{CFL}}$)**\nThe problem defines the CFL-based time step as:\n$$\\Delta t_{\\text{CFL}} = \\min_e \\frac{\\ell_e}{c_e}$$\n\n**4. Comparison and Ratio**\nFrom the analysis above, we find that for the 1D linear finite element formulation with lumped mass, the stability limit derived from the Gershgorin circle theorem is identical to the classic CFL stability limit.\n$$\\Delta t_{\\text{cr}} = \\Delta t_{\\text{CFL}}$$\nTherefore, we expect the ratio $r = \\Delta t_{\\text{cr}} / \\Delta t_{\\text{CFL}}$ to be exactly $1.0$ for all test cases, within numerical precision. The provided program will numerically verify this theoretical result by explicitly constructing the matrices and applying the theorems as instructed.", "answer": "```python\nimport numpy as np\n\ndef solve_case(N, L, E, rho, A=1.0):\n    \"\"\"\n    Solves for dt_cr, dt_cfl, and their ratio for a single test case.\n\n    Args:\n        N (int): Number of elements.\n        L (list or np.ndarray): List of element lengths.\n        E (list or np.ndarray): List of element Young's moduli.\n        rho (list or np.ndarray): List of element densities.\n        A (float): Cross-sectional area.\n\n    Returns:\n        tuple: A tuple containing (dt_cr, dt_cfl, r).\n    \"\"\"\n    num_nodes = N + 1\n\n    # 1. Assemble the global stiffness K and lumped mass M matrices.\n    K = np.zeros((num_nodes, num_nodes))\n    M_diag = np.zeros(num_nodes)\n\n    for e in range(N):\n        le, Ee, rhoe = L[e], E[e], rho[e]\n        \n        # elemental stiffness value\n        k_val = Ee * A / le\n        \n        # elemental nodal mass\n        m_node = rhoe * A * le / 2.0\n        \n        # Node indices for element e are (e, e+1)\n        n1, n2 = e, e + 1\n        \n        # Assemble K\n        K[n1, n1] += k_val\n        K[n1, n2] -= k_val\n        K[n2, n1] -= k_val\n        K[n2, n2] += k_val\n        \n        # Assemble M (diagonal)\n        M_diag[n1] += m_node\n        M_diag[n2] += m_node\n\n    # 2. Form the matrix A = M^-1 * K.\n    # Since M is diagonal, M_inv is diagonal with 1/M_ii.\n    # We can compute A by dividing each row of K by the corresponding M_ii.\n    A_mat = np.zeros_like(K)\n    for i in range(num_nodes):\n        if M_diag[i] > 0:\n            A_mat[i, :] = K[i, :] / M_diag[i]\n\n    # 3. Compute Gershgorin upper bound on lambda_max and dt_cr.\n    lambda_max_bound = 0.0\n    for i in range(num_nodes):\n        # Gershgorin disc center c_i = a_ii\n        center = A_mat[i, i]\n        # Gershgorin disc radius r_i = sum of absolute values of off-diagonal elements in a row\n        radius = np.sum(np.abs(A_mat[i, :])) - np.abs(center)\n        \n        # The upper bound of the Gershgorin interval for row i\n        g_i = center + radius\n        if g_i > lambda_max_bound:\n            lambda_max_bound = g_i\n    \n    # Calculate dt_cr from the Gershgorin bound on the maximum frequency\n    if lambda_max_bound <= 1e-12:  # Avoid division by zero for cases with no stiffness\n        dt_cr = float('inf')\n    else:\n        omega_max_bound = np.sqrt(lambda_max_bound)\n        dt_cr = 2.0 / omega_max_bound\n        \n    # 4. Compute dt_CFL based on mesh size and wave speed.\n    E_arr, rho_arr, L_arr = np.array(E), np.array(rho), np.array(L)\n    c_e = np.sqrt(E_arr / rho_arr)\n    dt_local = L_arr / c_e\n    dt_cfl = np.min(dt_local)\n\n    # 5. Compute the ratio and return the results.\n    if dt_cfl == 0:\n        ratio = float('nan')\n    else:\n        ratio = dt_cr / dt_cfl\n    \n    return dt_cr, dt_cfl, ratio\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    A_const = 1.0\n\n    test_cases = [\n        # Case 1: Uniform, steel-like material\n        {'N': 10, 'L': [0.1] * 10, 'E': [2.10e11] * 10, 'rho': [7800] * 10},\n        \n        # Case 2: Alternating heterogeneity, steel/aluminum-like\n        {'N': 8, 'L': [0.125] * 8, \n         'E': [7.0e10, 2.10e11, 7.0e10, 2.10e11, 7.0e10, 2.10e11, 7.0e10, 2.10e11],\n         'rho': [2700, 7800, 2700, 7800, 2700, 7800, 2700, 7800]},\n        \n        # Case 3: Nonuniform mesh with a very small element\n        {'N': 5, 'L': [0.5, 0.3, 0.15, 0.04, 0.01], \n         'E': [2.00e11] * 5, 'rho': [8000] * 5},\n\n        # Case 4: Single element\n        {'N': 1, 'L': [2.0], 'E': [1.0e9], 'rho': [1000]}\n    ]\n\n    all_results = []\n    for case in test_cases:\n        dt_cr, dt_cfl, r = solve_case(case['N'], case['L'], case['E'], case['rho'], A_const)\n        all_results.extend([dt_cr, dt_cfl, r])\n    \n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3550140"}, {"introduction": "After establishing how to determine the stability boundary, a critical question remains: what are the consequences of violating it? This computational exercise shifts our focus from prevention to observation [@problem_id:3550133]. By intentionally choosing a time step that exceeds the CFL limit, you will write a program to quantify the resulting exponential growth of numerical energy, providing a tangible connection between abstract stability theory and the practical behavior of an unstable simulation.", "problem": "Consider one-dimensional linear elastodynamics of a homogeneous, prismatic bar governed by the partial differential equation $\\rho \\frac{\\partial^2 u(x,t)}{\\partial t^2} = E \\frac{\\partial^2 u(x,t)}{\\partial x^2}$, where $\\rho$ is the mass density, $E$ is Young’s modulus, and $u(x,t)$ is the axial displacement. The bar supports longitudinal waves with speed $c = \\sqrt{E/\\rho}$. A uniform finite element spatial discretization with consistent mass leads to the semi-discrete system $M \\, \\ddot{\\mathbf{u}}(t) + K \\, \\mathbf{u}(t) = \\mathbf{0}$, where $M$ is symmetric positive definite and $K$ is symmetric positive semidefinite. Time is advanced with the standard explicit central difference scheme, which is conditionally stable.\n\nDefine the Courant number as $\\mathcal{C} = c \\, \\Delta t / h$, where $h$ is the element length and $\\Delta t$ is the time step. For a given spatial discretization (mesh order and uniform mesh), there is a maximum admissible Courant number $\\mathcal{C}_{\\max}$ associated with the highest discrete frequency $\\omega_{\\max}$ from the numerical dispersion relation of the semi-discrete operator. The central difference scheme is stable if and only if $\\Delta t \\le 2/\\omega_{\\max}$, equivalently $\\mathcal{C} \\le \\mathcal{C}_{\\max}$.\n\nA small violation of the Courant-Friedrichs-Lewy (CFL) restriction, namely choosing $\\mathcal{C} = (1+\\epsilon) \\mathcal{C}_{\\max}$ with $\\epsilon > 0$ small, yields spurious exponential growth of certain high-frequency modes. For a modal coordinate $y(t)$ obeying $\\ddot{y} + \\omega^2 y = 0$ and advanced by the central difference scheme, the one-step amplification factor $r$ satisfies $r^2 - 2 \\alpha r + 1 = 0$ with $\\alpha = 1 - (\\omega \\Delta t)^2/2$. The scheme is stable if $|\\alpha| \\le 1$ (then $|r| = 1$), and unstable if $|\\alpha| > 1$ (then $|r| > 1$). For an unstable mode, the discrete energy scales asymptotically like $|r|^{2n}$ after $n$ time steps. Define the energy growth rate per unit time as $\\gamma_E = \\frac{2}{\\Delta t} \\ln \\big(\\max_m |r_m|\\big)$, where the maximum is taken over all discrete modes of the semi-discrete system.\n\nYour task is to write a complete program that:\n- Constructs the consistent-mass and stiffness matrices for a periodic ring discretization of a bar of length $L$ using uniform finite elements of mesh order $p \\in \\{1,2\\}$:\n  - For mesh order $p = 1$ (linear elements), use $N$ elements and $N$ nodes.\n  - For mesh order $p = 2$ (quadratic elements), use $N$ elements and $2N$ nodes; the element spans two node spacings, and the local connectivity is $(2e, 2e+1, 2e+2)$ for element index $e$.\n  - Use consistent mass matrices.\n  - Use periodic boundary conditions by assembling on a ring (wrap-around indexing).\n- Computes the generalized eigenvalues $\\{\\omega_m^2\\}$ of $K \\mathbf{u} = \\omega^2 M \\mathbf{u}$ and identifies $\\omega_{\\max} = \\max_m \\omega_m$.\n- Sets $\\Delta t = (1+\\epsilon) \\cdot 2/\\omega_{\\max}$ for given $\\epsilon \\ge 0$.\n- Computes the per-mode amplification factor magnitude $\\max_m |r_m|$ from the characteristic equation of the central difference scheme and returns the energy growth rate $\\gamma_E = \\frac{2}{\\Delta t} \\ln \\big(\\max_m |r_m|\\big)$ in units of $\\mathrm{s}^{-1}$.\n\nUse the following physical and numerical parameters for all test cases:\n- Bar length $L = 1 \\ \\mathrm{m}$.\n- Cross-sectional area $A = 1 \\ \\mathrm{m}^2$.\n- Density $\\rho = 1 \\ \\mathrm{kg/m^3}$.\n- Wave speed $c = 1 \\ \\mathrm{m/s}$.\n- Young’s modulus $E = \\rho c^2$.\n- For mesh order $p = 1$, use $N = 200$ elements.\n- For mesh order $p = 2$, use $N = 100$ elements.\n\nYou must implement element-level consistent mass and stiffness matrices and assemble them into global matrices:\n- For mesh order $p = 1$ with element length $h = L/N$, use\n  - Element stiffness $k^{(e)} = \\frac{E A}{h} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$,\n  - Element mass $m^{(e)} = \\frac{\\rho A h}{6} \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$.\n- For mesh order $p = 2$ with element length $h = L/N$, use (standard quadratic Lagrange interpolation)\n  - Element stiffness $k^{(e)} = \\frac{E A}{3 h} \\begin{bmatrix} 7 & -8 & 1 \\\\ -8 & 16 & -8 \\\\ 1 & -8 & 7 \\end{bmatrix}$,\n  - Element mass $m^{(e)} = \\frac{\\rho A h}{30} \\begin{bmatrix} 4 & 2 & -1 \\\\ 2 & 16 & 2 \\\\ -1 & 2 & 4 \\end{bmatrix}$.\n\nDefine the energy growth rate $\\gamma_E$ as stated above. If all modes are stable (e.g., $\\epsilon = 0$), define $\\gamma_E = 0$ exactly.\n\nTest suite:\n- Case $1$: $(p = 1, \\ \\epsilon = 0.0)$.\n- Case $2$: $(p = 1, \\ \\epsilon = 0.02)$.\n- Case $3$: $(p = 2, \\ \\epsilon = 0.02)$.\n- Case $4$: $(p = 2, \\ \\epsilon = 0.05)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry must be the energy growth rate $\\gamma_E$ in $\\mathrm{s}^{-1}$, rounded to six decimal places, and listed in the same order as the test suite. For example, the output format must be exactly like $[\\gamma_1,\\gamma_2,\\gamma_3,\\gamma_4]$ with no spaces. No user input is required; all parameters are fixed as specified. All angles, if any, must be in radians. All dimensional quantities in the output must be in $\\mathrm{s}^{-1}$ as specified for $\\gamma_E$.", "solution": "We begin from the governing equation of axial motion in a linear elastic bar, $\\rho \\frac{\\partial^2 u(x,t)}{\\partial t^2} = E \\frac{\\partial^2 u(x,t)}{\\partial x^2}$, which is a second-order hyperbolic equation. The wave speed is $c = \\sqrt{E/\\rho}$. A spatial discretization using the finite element method with consistent mass on a uniform mesh leads to the semi-discrete system $M \\, \\ddot{\\mathbf{u}}(t) + K \\, \\mathbf{u}(t) = \\mathbf{0}$, where $M$ and $K$ are obtained by standard assembly of element-level contributions. For a uniform mesh and periodic structure, the semi-discrete operator admits Bloch-Floquet harmonic modes, and thus the generalized eigenproblem $K \\mathbf{\\phi} = \\omega^2 M \\mathbf{\\phi}$ yields the numerical dispersion relation: for each discrete wavenumber there is a discrete circular frequency $\\omega$.\n\nFor the mesh order $p = 1$ (linear elements) with element length $h$, the element-level stiffness and mass matrices are $k^{(e)} = \\frac{E A}{h} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$ and $m^{(e)} = \\frac{\\rho A h}{6} \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$. On a uniform ring with wrap-around connectivity, assembling these matrices and analyzing a discrete plane wave $u_j = \\hat{u} \\, e^{\\mathrm{i} j \\theta}$ with $\\theta \\in [0, 2\\pi)$ yields the closed-form dispersion relation\n$$\n\\omega^2(\\theta) \\;=\\; \\frac{4 E A}{h^2 \\rho A} \\cdot \\frac{3 \\, \\sin^2(\\theta/2)}{2 + \\cos \\theta} \\;=\\; \\frac{c^2}{h^2} \\cdot \\frac{12 \\, \\sin^2(\\theta/2)}{2 + \\cos \\theta} \\;=\\; \\frac{c^2}{h^2} \\cdot \\frac{4 \\, \\sin^2(\\theta/2)}{1 - \\frac{2}{3} \\sin^2(\\theta/2)}.\n$$\nThis relation is monotone in $\\sin^2(\\theta/2)$ and attains its maximum at $\\theta = \\pi$, yielding $\\omega_{\\max} = \\frac{2 \\sqrt{3} \\, c}{h}$. For mesh order $p = 2$ (quadratic elements), with element-level stiffness $k^{(e)} = \\frac{E A}{3 h} \\begin{bmatrix} 7 & -8 & 1 \\\\ -8 & 16 & -8 \\\\ 1 & -8 & 7 \\end{bmatrix}$ and mass $m^{(e)} = \\frac{\\rho A h}{30} \\begin{bmatrix} 4 & 2 & -1 \\\\ 2 & 16 & 2 \\\\ -1 & 2 & 4 \\end{bmatrix}$, the periodic assembly on a uniform ring leads to a block-Toeplitz operator with a two-branch dispersion relation when parameterized by a primitive cell. While a closed form is obtainable by a Bloch reduction to a $2 \\times 2$ (or $3 \\times 3$) symbol depending on the chosen primitive cell, it is simpler and fully equivalent to compute the spectrum numerically by assembling the global matrices under periodic boundary conditions and solving $K \\mathbf{\\phi} = \\omega^2 M \\mathbf{\\phi}$. For a sufficiently large uniform mesh, the eigenvalue set samples the numerical dispersion curves densely.\n\nThe central difference scheme for a single mode $y(t)$ obeying $\\ddot{y} + \\omega^2 y = 0$ reads\n$$\ny^{n+1} = 2 y^n - y^{n-1} - (\\omega \\Delta t)^2 y^n.\n$$\nSeeking $y^n = r^n$ gives the characteristic polynomial\n$$\nr^2 - 2 \\alpha r + 1 = 0, \\quad \\text{with} \\quad \\alpha = 1 - \\frac{(\\omega \\Delta t)^2}{2}.\n$$\nThe roots are\n$$\nr_{\\pm} = \\alpha \\pm \\sqrt{\\alpha^2 - 1}.\n$$\nIf $|\\alpha| \\le 1$ (equivalently $\\omega \\Delta t \\le 2$), the roots are complex conjugates on the unit circle, $|r_{\\pm}| = 1$, and the scheme is marginally stable (no growth). If $|\\alpha| > 1$ (equivalently $\\omega \\Delta t > 2$), the roots are real with magnitudes $|r_{+}| \\ge 1 \\ge |r_{-}|$, and the mode grows like $|r_{+}|^n$. For a superposition of modes, the worst-case growth is governed by $\\max_m |r_m|$, where $|r_m|$ is computed from the corresponding $\\omega_m$. Defining the discrete energy of a mode to scale with the square of amplitude, the energy grows asymptotically like $|r|^{2n}$. Thus a natural energy growth rate per unit time is\n$$\n\\gamma_E \\;=\\; \\frac{2}{\\Delta t} \\ln \\left( \\max_m |r_m| \\right).\n$$\n\nThe maximum admissible time step for the central difference scheme is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2}{\\omega_{\\max}},\n$$\nwhere $\\omega_{\\max}$ is the maximum discrete frequency of the spatially discretized system. A Courant number violation parameter $\\epsilon \\ge 0$ is imposed by taking\n$$\n\\Delta t \\;=\\; (1 + \\epsilon) \\, \\Delta t_{\\max}.\n$$\nWhen $\\epsilon = 0$, all modes satisfy $\\omega \\Delta t \\le 2$ and thus $\\gamma_E = 0$. For $\\epsilon > 0$, modes near $\\omega_{\\max}$ satisfy $\\omega \\Delta t > 2$ and cause growth with a rate that increases as $\\epsilon$ increases.\n\nAlgorithmic design:\n- Assemble the global $M$ and $K$ using the specified element matrices and periodic wrap-around connectivity. For mesh order $p = 1$, there are $N$ nodes; elements $(e,e+1)$ for $e = 0,\\dots,N-1$ with indices modulo $N$. For mesh order $p = 2$, there are $2N$ nodes at uniform spacing $a = h/2$; each element $e = 0,\\dots,N-1$ connects nodes $(2e, 2e+1, 2e+2)$ modulo $2N$.\n- Solve the generalized eigenproblem $K \\mathbf{\\phi} = \\omega^2 M \\mathbf{\\phi}$ and compute $\\omega_m = \\sqrt{\\lambda_m}$ for eigenvalues $\\lambda_m$. The largest $\\omega_m$ is $\\omega_{\\max}$.\n- Set $\\Delta t = (1 + \\epsilon) \\cdot 2/\\omega_{\\max}$ and compute, for each $\\omega_m$, the central difference amplification parameter $\\alpha_m = 1 - (\\omega_m \\Delta t)^2/2$. If $|\\alpha_m| \\le 1$, set $|r_m| = 1$. If $|\\alpha_m| > 1$, set $|r_m| = |\\alpha_m| + \\sqrt{\\alpha_m^2 - 1}$, which is the magnitude of the unstable root.\n- Compute $\\gamma_E = \\frac{2}{\\Delta t} \\ln \\left( \\max_m |r_m| \\right)$. If $\\max_m |r_m| = 1$ within numerical tolerance, report $\\gamma_E = 0$ exactly.\n- Units: with $c = 1 \\ \\mathrm{m/s}$, $L = 1 \\ \\mathrm{m}$, $A = 1 \\ \\mathrm{m}^2$, $\\rho = 1 \\ \\mathrm{kg/m^3}$, and $E = \\rho c^2$, the resulting $\\gamma_E$ will be in $\\mathrm{s}^{-1}$.\n\nTest suite and coverage rationale:\n- Case $1$ ($p = 1$, $\\epsilon = 0.0$) tests the boundary of stability, expecting exactly zero growth.\n- Case $2$ ($p = 1$, $\\epsilon = 0.02$) tests a mild violation for linear elements.\n- Case $3$ ($p = 2$, $\\epsilon = 0.02$) contrasts the effect of mesh order on growth under the same violation magnitude.\n- Case $4$ ($p = 2$, $\\epsilon = 0.05$) explores a stronger violation for quadratic elements.\n\nThe program aggregates the four $\\gamma_E$ values rounded to six decimal places into a single line formatted as $[\\gamma_1,\\gamma_2,\\gamma_3,\\gamma_4]$, with no spaces. This output is purely numeric (floats) and thus quantifiable and testable. All values are reported in $\\mathrm{s}^{-1}$.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef assemble_linear_FE(N, L, E, rho, A):\n    # Linear (p=1) elements with consistent mass on a periodic ring\n    h = L / N\n    ke = (E * A / h) * np.array([[1.0, -1.0],\n                                 [-1.0, 1.0]])\n    me = (rho * A * h / 6.0) * np.array([[2.0, 1.0],\n                                         [1.0, 2.0]])\n    ndof = N\n    K = np.zeros((ndof, ndof), dtype=float)\n    M = np.zeros((ndof, ndof), dtype=float)\n    for e in range(N):\n        n0 = e % N\n        n1 = (e + 1) % N\n        idx = [n0, n1]\n        K[np.ix_(idx, idx)] += ke\n        M[np.ix_(idx, idx)] += me\n    return K, M\n\ndef assemble_quadratic_FE(N, L, E, rho, A):\n    # Quadratic (p=2) elements with consistent mass on a periodic ring\n    # Element spans two node spacings; nodes per element = 3\n    h = L / N\n    # Standard quadratic Lagrange element matrices for axial bar\n    ke = (E * A / (3.0 * h)) * np.array([[7.0, -8.0, 1.0],\n                                         [-8.0, 16.0, -8.0],\n                                         [1.0, -8.0, 7.0]])\n    me = (rho * A * h / 30.0) * np.array([[4.0, 2.0, -1.0],\n                                          [2.0, 16.0, 2.0],\n                                          [-1.0, 2.0, 4.0]])\n    ndof = 2 * N  # nodes at spacing a = h/2\n    K = np.zeros((ndof, ndof), dtype=float)\n    M = np.zeros((ndof, ndof), dtype=float)\n    for e in range(N):\n        n0 = (2 * e) % ndof\n        n1 = (2 * e + 1) % ndof\n        n2 = (2 * e + 2) % ndof\n        idx = [n0, n1, n2]\n        K[np.ix_(idx, idx)] += ke\n        M[np.ix_(idx, idx)] += me\n    return K, M\n\ndef compute_growth_rate(K, M, eps):\n    # Solve generalized eigenproblem K phi = omega^2 M phi\n    # eigh returns eigenvalues in ascending order\n    # Ensure symmetry\n    Ksym = 0.5 * (K + K.T)\n    Msym = 0.5 * (M + M.T)\n    # Generalized symmetric definite eigenproblem\n    w2, _ = eigh(Ksym, Msym, overwrite_a=True, overwrite_b=True, check_finite=False)\n    # Numerical safety: clip small negatives to zero\n    w2 = np.maximum(w2, 0.0)\n    omega = np.sqrt(w2)\n    # Maximum discrete frequency\n    omega_max = np.max(omega)\n    if omega_max <= 0:\n        return 0.0\n    dt_max = 2.0 / omega_max\n    dt = (1.0 + eps) * dt_max\n    # Compute per-mode amplification magnitudes and take maximum\n    s = omega * dt\n    alpha = 1.0 - 0.5 * s * s\n    # For stable modes (|alpha| <= 1): |r| = 1\n    # For unstable modes (|alpha| > 1): |r| = |alpha| + sqrt(alpha^2 - 1)\n    abs_alpha = np.abs(alpha)\n    unstable = abs_alpha > 1.0 + 1e-12  # tolerance\n    rmag = np.ones_like(alpha)\n    if np.any(unstable):\n        aa = abs_alpha[unstable]\n        rmag[unstable] = aa + np.sqrt(aa * aa - 1.0)\n    rmax = np.max(rmag)\n    # Energy growth rate\n    if rmax <= 1.0 + 1e-14:\n        return 0.0\n    gamma_E = (2.0 / dt) * np.log(rmax)\n    return float(gamma_E)\n\ndef solve():\n    # Physical parameters\n    L = 1.0  # m\n    A = 1.0  # m^2\n    rho = 1.0  # kg/m^3\n    c = 1.0  # m/s\n    E = rho * c * c  # Pa\n\n    results = []\n\n    # Test cases: (p, N, epsilon)\n    test_cases = [\n        (1, 200, 0.0),\n        (1, 200, 0.02),\n        (2, 100, 0.02),\n        (2, 100, 0.05),\n    ]\n\n    for p, N, eps in test_cases:\n        if p == 1:\n            K, M = assemble_linear_FE(N, L, E, rho, A)\n        elif p == 2:\n            K, M = assemble_quadratic_FE(N, L, E, rho, A)\n        else:\n            raise ValueError(\"Unsupported mesh order\")\n        gamma = compute_growth_rate(K, M, eps)\n        # Round to six decimal places\n        results.append(f\"{gamma:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3550133"}]}