{"hands_on_practices": [{"introduction": "The primary factor governing the choice of an explicit solver is its conditionally stable nature, which links the maximum allowable time step to the mesh size and material wave speed. This exercise [@problem_id:3598266] provides hands-on practice with the Courant-Friedrichs-Lewy (CFL) condition by asking you to derive an adaptive time step for a wave traversing a non-uniform mesh. Mastering this concept is essential for accurately predicting the computational cost and feasibility of an explicit dynamics simulation.", "problem": "A one-dimensional, prismatic elastic bar of total length $L = L_1 + L_2$ is discretized for explicit dynamics with a mesh that is coarse in the left region $0 \\le x  L_1$ and refined in the right region $L_1 \\le x \\le L$. The left region has constant Young’s modulus $E_1$, mass density $\\rho_1$, and uniform element size $h_1$. The right region has constant Young’s modulus $E_2$, mass density $\\rho_2$, and uniform element size $h_2$, with $h_2  h_1$. The bar is otherwise free of external loads and damping.\n\nAt time $t=0$, a small-amplitude longitudinal pulse is initiated at $x=0$ and propagates to the right. Assume linear kinematics, the one-dimensional longitudinal wave speed $c(x)$ satisfies $c(x) = \\sqrt{E(x)/\\rho(x)}$, and reflections at $x=L_1$ are negligible due to impedance matching (i.e., choose material pairs such that transmission is dominant). The explicit time integrator is the standard second-order central-difference method applied to the semi-discretized equation of motion of the bar. You choose explicit dynamics instead of implicit dynamics to resolve the short-wavelength transient and seek to maintain a uniform Courant-Friedrichs-Lewy (CFL) number across the elements carrying the pulse by varying the global time step $\\Delta t$ adaptively as the wavefront travels from the coarse region into the refined region.\n\nLet the target Courant-Friedrichs-Lewy number be a constant $0  \\alpha  1$. Let $c_1 = \\sqrt{E_1/\\rho_1}$ and $c_2 = \\sqrt{E_2/\\rho_2}$ denote the wave speeds in the left and right regions, respectively. The wavefront position is $x(t)$, moving at the local wave speed, with the interface crossing time $t^{\\ast} = L_1 / c_1$. The adaptive explicit strategy sets the global time step $\\Delta t(t)$ so that the CFL number equals $\\alpha$ in the element set currently carrying the wavefront.\n\nDerive, from first principles and without invoking any pre-given stability shortcuts, an analytic expression for the adaptive time-step function $\\Delta t(t)$ in terms of $t$, $\\alpha$, $h_1$, $h_2$, $c_1$, $c_2$, and $L_1$. Express your final result as a single closed-form expression that uses the Heaviside step function $H(\\cdot)$ to represent the change at $t^{\\ast}$. Express the final answer in seconds. No numerical evaluation is required, and your final answer must be a single analytical expression.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extraction of Givens**\n- A one-dimensional prismatic elastic bar of total length $L = L_1 + L_2$.\n- The domain is discretized into two regions:\n    1.  Left region ($0 \\le x  L_1$): Young’s modulus $E_1$, mass density $\\rho_1$, uniform element size $h_1$.\n    2.  Right region ($L_1 \\le x \\le L$): Young’s modulus $E_2$, mass density $\\rho_2$, uniform element size $h_2$.\n- The mesh is refined in the right region, so $h_2  h_1$.\n- The system is free of external loads and damping.\n- A small-amplitude longitudinal pulse is initiated at $x=0$ at time $t=0$ and propagates to the right.\n- The analysis assumes linear kinematics.\n- The one-dimensional longitudinal wave speed is given by $c(x) = \\sqrt{E(x)/\\rho(x)}$. In the two regions, the constant wave speeds are $c_1 = \\sqrt{E_1/\\rho_1}$ and $c_2 = \\sqrt{E_2/\\rho_2}$.\n- Reflections at the interface $x=L_1$ are considered negligible.\n- The time integration scheme is the standard second-order central-difference method.\n- The adaptive time-stepping strategy aims to maintain a constant Courant-Friedrichs-Lewy (CFL) number, $\\alpha$ (where $0  \\alpha  1$), for the elements carrying the wavefront by varying the global time step $\\Delta t(t)$.\n- The wavefront crosses the interface at time $t^{\\ast} = L_1 / c_1$.\n- The task is to derive an analytical expression for the adaptive time-step function $\\Delta t(t)$ using the Heaviside step function $H(\\cdot)$.\n\n**Step 2: Validation**\nThe problem is scientifically grounded in the established theory of wave propagation and numerical methods for partial differential equations (PDEs), specifically the finite element or finite difference solution to the wave equation. The concepts of CFL stability, central-difference scheme, wave speed, and mesh properties are standard in computational mechanics. The problem is well-posed, providing all necessary information and a clear objective. The language is precise and objective. The simplifying assumption of negligible reflection is a standard technique to isolate the phenomenon of interest, in this case, the effect of changing mesh and material properties on the adaptive time step. The specified adaptive strategy, while idealized, is unambiguous and allows for a unique solution. The problem is therefore deemed valid.\n\n**Step 3: Solution Derivation**\nThe derivation proceeds from the fundamental principles of numerical stability for explicit time integration of the wave equation.\n\nThe governing PDE for longitudinal wave propagation in a one-dimensional elastic bar is the wave equation:\n$$ \\frac{\\partial^2 u}{\\partial t^2} = c(x)^2 \\frac{\\partial^2 u}{\\partial x^2} $$\nwhere $u(x, t)$ is the axial displacement at position $x$ and time $t$, and $c(x)$ is the local wave speed.\n\nUpon spatial discretization (e.g., using the finite element method with linear elements and a lumped mass matrix), this PDE is transformed into a system of second-order ordinary differential equations (ODEs):\n$ \\mathbf{M} \\ddot{\\mathbf{d}}(t) + \\mathbf{K} \\mathbf{d}(t) = \\mathbf{0} $\nwhere $\\mathbf{M}$ is the diagonal mass matrix, $\\mathbf{K}$ is the stiffness matrix, and $\\mathbf{d}(t)$ is the vector of nodal displacements.\n\nThe problem specifies the use of the second-order central-difference method for time integration. The stability of this explicit scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition. This condition originates from the principle that for a convergent numerical solution, the physical domain of dependence of the PDE must be contained within the numerical domain of dependence of the discretization scheme.\n\nFor a one-dimensional problem, this means that the distance a wave travels in one time step, $c \\Delta t$, must not exceed the characteristic length of a spatial element, $h$. This ensures that information does not propagate numerically faster than it does physically, which would lead to instability. The stability condition is therefore:\n$$ c \\Delta t \\le h $$\nThis can be expressed using the dimensionless Courant number (or CFL number), defined for each element as:\n$$ \\text{CFL} = \\frac{c \\Delta t}{h} $$\nThe stability requirement for the central-difference scheme is $\\text{CFL} \\le 1$.\n\nThe problem states that an adaptive strategy is used to maintain a constant target CFL number, $\\alpha$, where $0  \\alpha  1$, for the element carrying the wavefront. The time step $\\Delta t$ is thus set according to the properties of this specific element:\n$$ \\alpha = \\frac{c_{wavefront} \\Delta t}{h_{wavefront}} \\implies \\Delta t = \\alpha \\frac{h_{wavefront}}{c_{wavefront}} $$\n\nWe now apply this adaptive rule to the propagating pulse. The pulse starts at $x=0$ at $t=0$. The bar consists of two regions with different properties.\n\n**Region 1 ($0 \\le x  L_1$):**\n- Element size: $h = h_1$\n- Wave speed: $c = c_1$\nAs long as the wavefront is in this region, the time step $\\Delta t(t)$ is set based on these properties. Let's call this time step $\\Delta t_1$.\n$$ \\Delta t_1 = \\alpha \\frac{h_1}{c_1} $$\nThe wavefront travels at speed $c_1$, so its position is $x(t) = c_1 t$. The wavefront remains in Region $1$ for the time interval $0 \\le t  t^{\\ast}$, where $t^{\\ast}$ is the time it reaches the interface at $x=L_1$. This time is given by $L_1 = c_1 t^{\\ast}$, so $t^{\\ast} = L_1/c_1$.\n\n**Region 2 ($L_1 \\le x \\le L$):**\n- Element size: $h = h_2$\n- Wave speed: $c = c_2$\nOnce the wavefront crosses the interface at $t=t^{\\ast}$, it enters Region $2$ and propagates with speed $c_2$. For all $t \\ge t^{\\ast}$, the time step $\\Delta t(t)$ is set based on the properties of Region $2$. Let's call this time step $\\Delta t_2$.\n$$ \\Delta t_2 = \\alpha \\frac{h_2}{c_2} $$\n\nCombining these findings, the adaptive time step $\\Delta t(t)$ is a piecewise-constant function of time:\n$$\n\\Delta t(t) =\n\\begin{cases}\n\\Delta t_1 = \\alpha \\frac{h_1}{c_1}  \\text{if } 0 \\le t  t^{\\ast} \\\\\n\\Delta t_2 = \\alpha \\frac{h_2}{c_2}  \\text{if } t \\ge t^{\\ast}\n\\end{cases}\n$$\nwhere $t^{\\ast} = L_1/c_1$.\n\nThe final step is to express this piecewise function as a single closed-form expression using the Heaviside step function, $H(\\tau)$, defined as:\n$$\nH(\\tau) =\n\\begin{cases}\n0  \\text{if } \\tau  0 \\\\\n1  \\text{if } \\tau \\ge 0\n\\end{cases}\n$$\nA general piecewise function $f(t) = A$ for $t  t^{\\ast}$ and $f(t) = B$ for $t \\ge t^{\\ast}$ can be written as $f(t) = A + (B - A) H(t - t^{\\ast})$.\nApplying this to our function $\\Delta t(t)$, we have:\n- $A = \\Delta t_1 = \\alpha \\frac{h_1}{c_1}$\n- $B = \\Delta t_2 = \\alpha \\frac{h_2}{c_2}$\n- The transition occurs at $t^{\\ast} = L_1/c_1$.\n\nTherefore, the adaptive time step $\\Delta t(t)$ is:\n$$ \\Delta t(t) = \\alpha \\frac{h_1}{c_1} + \\left( \\alpha \\frac{h_2}{c_2} - \\alpha \\frac{h_1}{c_1} \\right) H(t - t^{\\ast}) $$\nSubstituting $t^{\\ast} = L_1/c_1$ and factoring out the common term $\\alpha$, we arrive at the final analytical expression:\n$$ \\Delta t(t) = \\alpha \\left( \\frac{h_1}{c_1} + \\left( \\frac{h_2}{c_2} - \\frac{h_1}{c_1} \\right) H\\left(t - \\frac{L_1}{c_1}\\right) \\right) $$\nThis expression provides the value of the global time step in seconds as a function of time $t$ and the given parameters of the system.", "answer": "$$\n\\boxed{\\alpha \\left( \\frac{h_1}{c_1} + \\left( \\frac{h_2}{c_2} - \\frac{h_1}{c_1} \\right) H\\left(t - \\frac{L_1}{c_1}\\right) \\right)}\n$$", "id": "3598266"}, {"introduction": "While the stability limit of explicit methods is strict, engineers have developed techniques to artificially increase the time step for certain classes of problems, such as quasi-static events. This practice [@problem_id:3598321] investigates mass scaling, a common method for increasing the critical time step $\\Delta t_{\\mathrm{cr}}$. By deriving the bias introduced into the system's dynamic response, you will gain a critical understanding of the trade-off between computational efficiency and physical accuracy when employing such techniques.", "problem": "A single-degree-of-freedom linear elastic oscillator of mass $m$, stiffness $k$, and viscous damping coefficient $c$ is subjected to a harmonic forcing $f(t) = F_{0} \\cos(\\omega_{f} t)$. The equation of motion is $m \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = f(t)$. An explicit time integration based on the central difference method is considered. To permit a larger stable time increment, a practitioner proposes mass scaling, replacing $m$ by $\\alpha m$ with $\\alpha > 1$, while keeping $k$ and $c$ unchanged. \n\nStarting from first principles:\n- Use the central difference method applied to the undamped free vibration ($c=0$, $f(t)=0$) to derive the critical time step $\\Delta t_{\\mathrm{cr}}$ for stability in terms of the natural circular frequency $\\omega_{n}$, and then determine how $\\Delta t_{\\mathrm{cr}}$ changes under mass scaling $m \\rightarrow \\alpha m$.\n- Using linear vibration theory, derive the steady-state displacement amplitude of the damped, forced response for the original physical system and for the mass-scaled system. Introduce the natural circular frequency $\\omega_{n} = \\sqrt{k/m}$, the damping ratio $\\zeta = \\dfrac{c}{2 \\sqrt{k m}}$, and the forcing-to-natural frequency ratio $r = \\dfrac{\\omega_{f}}{\\omega_{n}}$.\n\nDefine the amplitude bias factor $B(\\alpha,r,\\zeta)$ as the ratio of the mass-scaled steady-state displacement amplitude to the true physical steady-state displacement amplitude. Provide $B(\\alpha,r,\\zeta)$ as a single closed-form analytic expression in terms of $\\alpha$, $r$, and $\\zeta$. Report only $B(\\alpha,r,\\zeta)$ as your final answer. The bias factor is dimensionless; no units are required, and no rounding is needed.", "solution": "The governing equation for a single-degree-of-freedom linear oscillator is $m \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = f(t)$. The undamped free vibration problem, obtained by setting $c=0$ and $f(t)=0$, reads $m \\ddot{u}(t) + k u(t) = 0$. Its natural circular frequency is $\\omega_{n} = \\sqrt{\\dfrac{k}{m}}$.\n\nFirst, consider the explicit central difference method applied to the undamped free vibration. The central difference approximation of the second derivative at discrete times $t_{n} = n \\Delta t$ is\n$$\n\\ddot{u}(t_{n}) \\approx \\frac{u^{n+1} - 2 u^{n} + u^{n-1}}{\\Delta t^{2}}.\n$$\nSubstituting into $m \\ddot{u}(t_{n}) + k u^{n} = 0$ yields\n$$\nm \\frac{u^{n+1} - 2 u^{n} + u^{n-1}}{\\Delta t^{2}} + k u^{n} = 0,\n$$\nor equivalently,\n$$\nu^{n+1} = \\left( 2 - \\omega_{n}^{2} \\Delta t^{2} \\right) u^{n} - u^{n-1},\n$$\nwhere $\\omega_{n}^{2} = \\dfrac{k}{m}$. Seek solutions of the form $u^{n} = \\rho^{n}$ (a standard von Neumann stability analysis). Substitution gives the characteristic equation\n$$\n\\rho^{2} - 2 \\left(1 - \\frac{1}{2} \\omega_{n}^{2} \\Delta t^{2} \\right) \\rho + 1 = 0.\n$$\nStability requires that the amplification factors satisfy $|\\rho| \\leq 1$. For marginal stability, set $\\rho = \\exp(i \\theta)$ with real $\\theta$. Substituting $\\rho = \\exp(i \\theta)$ and simplifying using $\\rho + \\rho^{-1} = 2 \\cos \\theta$ yields\n$$\n2 \\cos \\theta = 2 \\left( 1 - \\frac{1}{2} \\omega_{n}^{2} \\Delta t^{2} \\right),\n$$\nso that\n$$\n\\cos \\theta = 1 - \\frac{1}{2} \\omega_{n}^{2} \\Delta t^{2}.\n$$\nA real $\\theta$ exists if and only if $-1 \\leq \\cos \\theta \\leq 1$, which imposes\n$$\n-1 \\leq 1 - \\frac{1}{2} \\omega_{n}^{2} \\Delta t^{2} \\leq 1.\n$$\nThe lower bound gives $1 - \\frac{1}{2} \\omega_{n}^{2} \\Delta t^{2} \\geq -1$, i.e.,\n$$\n\\omega_{n}^{2} \\Delta t^{2} \\leq 4,\n$$\nor\n$$\n\\Delta t \\leq \\frac{2}{\\omega_{n}}.\n$$\nTherefore, the critical stable time increment is $\\Delta t_{\\mathrm{cr}} = \\dfrac{2}{\\omega_{n}}$. Under mass scaling $m \\rightarrow \\alpha m$ with stiffness $k$ unchanged, the natural frequency becomes\n$$\n\\omega_{n}' = \\sqrt{\\frac{k}{\\alpha m}} = \\frac{\\omega_{n}}{\\sqrt{\\alpha}},\n$$\nand thus the critical time increment scales to\n$$\n\\Delta t_{\\mathrm{cr}}' = \\frac{2}{\\omega_{n}'} = \\sqrt{\\alpha} \\, \\Delta t_{\\mathrm{cr}}.\n$$\nHence mass scaling by $\\alpha$ increases the explicit stability limit for the time step by the factor $\\sqrt{\\alpha}$.\n\nNext, consider the forced, damped steady-state response for the original physical system. The equation\n$$\nm \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = F_{0} \\cos(\\omega_{f} t)\n$$\nadmits a particular solution of the form $u_{p}(t) = U \\cos(\\omega_{f} t - \\phi)$, where $U$ is the steady-state amplitude and $\\phi$ is the phase lag. Using standard harmonic balance (or complex impedance) analysis, define the natural circular frequency $\\omega_{n} = \\sqrt{\\dfrac{k}{m}}$, the damping ratio $\\zeta = \\dfrac{c}{2 m \\omega_{n}} = \\dfrac{c}{2 \\sqrt{k m}}$, and the frequency ratio $r = \\dfrac{\\omega_{f}}{\\omega_{n}}$. The steady-state displacement amplitude is\n$$\nU_{\\text{true}} = \\frac{F_{0}/k}{\\sqrt{\\left(1 - r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}}}.\n$$\n\nFor the mass-scaled explicit model, $m' = \\alpha m$, $k' = k$, and $c' = c$, so\n$$\n\\omega_{n}' = \\sqrt{\\frac{k}{m'}} = \\frac{\\omega_{n}}{\\sqrt{\\alpha}}, \\quad \\zeta' = \\frac{c'}{2 \\sqrt{k' m'}} = \\frac{c}{2 \\sqrt{k \\alpha m}} = \\frac{\\zeta}{\\sqrt{\\alpha}}, \\quad r' = \\frac{\\omega_{f}}{\\omega_{n}'} = \\sqrt{\\alpha} \\, r.\n$$\nThe mass-scaled steady-state displacement amplitude is therefore\n$$\nU_{\\text{scaled}} = \\frac{F_{0}/k}{\\sqrt{\\left(1 - r'^{2}\\right)^{2} + \\left(2 \\zeta' r'\\right)^{2}}}\n= \\frac{F_{0}/k}{\\sqrt{\\left(1 - \\alpha r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}}},\n$$\nbecause $2 \\zeta' r' = 2 \\left(\\frac{\\zeta}{\\sqrt{\\alpha}}\\right)\\left(\\sqrt{\\alpha} r \\right) = 2 \\zeta r$.\n\nDefine the amplitude bias factor as the ratio of the mass-scaled amplitude to the true amplitude:\n$$\nB(\\alpha,r,\\zeta) = \\frac{U_{\\text{scaled}}}{U_{\\text{true}}}\n= \\frac{\\dfrac{F_{0}}{k} \\left[ \\sqrt{\\left(1 - r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}} \\right]^{-1}}\n{\\dfrac{F_{0}}{k} \\left[ \\sqrt{\\left(1 - \\alpha r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}} \\right]^{-1}}\n= \\frac{\\sqrt{\\left(1 - r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}}}\n{\\sqrt{\\left(1 - \\alpha r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}}}.\n$$\nThis expression quantifies how mass scaling biases the steady-state displacement amplitude relative to the true physics for a single-mode system under harmonic excitation. It highlights that the damping contribution $2 \\zeta r$ is invariant under mass scaling when $c$ is held constant, while the inertial-stiffness term $1 - r^{2}$ is modified through $r' = \\sqrt{\\alpha} r$.\n\nTherefore, the requested closed-form analytic expression is\n$$\nB(\\alpha,r,\\zeta) = \\frac{\\sqrt{\\left(1 - r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}}}{\\sqrt{\\left(1 - \\alpha r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}}}.\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{\\left(1 - r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}}}{\\sqrt{\\left(1 - \\alpha r^{2}\\right)^{2} + \\left(2 \\zeta r\\right)^{2}}}}$$", "id": "3598321"}, {"introduction": "The decision between implicit and explicit methods is not always about computational speed; it can be a matter of algorithmic robustness. This problem [@problem_id:3598283] explores a scenario involving cohesive fracture and material softening, which can lead to structural snap-back. You will derive a criterion that predicts the failure of standard implicit methods, highlighting why an explicit solver is often the superior, or only, choice for tracing such complex, unstable equilibrium paths.", "problem": "Consider a one-dimensional bar of bulk stiffness in series with a cohesive interface that follows a bilinear traction–separation law. The end displacement is prescribed as a function of time and inertia is small but nonzero, so the analyst may choose either a quasi-static implicit update (e.g., Newton’s method on the equilibrium equations) or an explicit central-difference update. The goal is to derive, from first principles, a mathematically justified criterion to switch from implicit to explicit time integration near crack initiation when cohesive softening begins and may induce snap-back.\n\nAssume the following model and definitions.\n\n- The bulk is linear elastic with Young’s modulus $E$ (in $\\mathrm{Pa}$), cross-sectional area $A$ (in $\\mathrm{m}^2$), and length $L$ (in $\\mathrm{m}$). Its force–displacement relation is $F_{\\mathrm{bulk}} = K_b \\Delta_b$, where $K_b = \\dfrac{E A}{L}$ (in $\\mathrm{N/m}$), $\\Delta_b$ is the bulk elongation (in $\\mathrm{m}$), and $F_{\\mathrm{bulk}}$ is the internal axial force (in $\\mathrm{N}$).\n\n- The cohesive interface is characterized by a bilinear traction–separation law with maximum traction $\\sigma_{\\max}$ (in $\\mathrm{Pa}$), separation at peak $\\delta_0$ (in $\\mathrm{m}$), and final separation $\\delta_f$ (in $\\mathrm{m}$), with $0  \\delta_0  \\delta_f$. Let $\\delta$ be the current separation (in $\\mathrm{m}$). The cohesive traction $t(\\delta)$ (in $\\mathrm{Pa}$) and its tangent $K_t^{\\mathrm{(trac)}}(\\delta) = \\dfrac{\\mathrm{d}t}{\\mathrm{d}\\delta}$ (in $\\mathrm{Pa/m}$) are\n  - For $0 \\le \\delta \\le \\delta_0$: $t(\\delta) = \\left(\\dfrac{\\sigma_{\\max}}{\\delta_0}\\right) \\delta$, with $K_t^{\\mathrm{(trac)}}(\\delta) = \\dfrac{\\sigma_{\\max}}{\\delta_0}$.\n  - For $\\delta_0  \\delta \\le \\delta_f$: $t(\\delta) = \\sigma_{\\max} \\left( 1 - \\dfrac{\\delta - \\delta_0}{\\delta_f - \\delta_0} \\right)$, with $K_t^{\\mathrm{(trac)}}(\\delta) = - \\dfrac{\\sigma_{\\max}}{\\delta_f - \\delta_0}$.\n  The corresponding force-level secant and tangent stiffnesses (in $\\mathrm{N/m}$) for the interface are\n  $$\n  K_s = A \\dfrac{t(\\delta)}{\\delta}, \\quad K_t = A K_t^{\\mathrm{(trac)}}(\\delta).\n  $$\n\n- Series coupling enforces a common internal force $F$ (in $\\mathrm{N}$) and total end displacement $\\Delta$ (in $\\mathrm{m}$) satisfying $F = F_{\\mathrm{bulk}} = A t(\\delta)$ and $\\Delta = \\Delta_b + \\delta$.\n\nStarting from equilibrium and linearization fundamentals, derive a scalar switching criterion, expressed using the bulk stiffness $K_b$, the cohesive tangent stiffness $K_t$, and the cohesive secant stiffness $K_s$, that flags the onset of algorithmic difficulty for an implicit quasi-static update near softening initiation. The criterion must be justified by analyzing the local solvability of the displacement-controlled equilibrium equation under incremental loading and must reduce to a non-dimensional index built from $K_b$, $K_t$, and $K_s$ whose sign change indicates a turning point (snap-back) in the structural response.\n\nThen, implement this criterion as a program that evaluates, for each provided test case, whether to choose an explicit update ($1$) or to remain implicit ($0$). Use the following test suite of parameter tuples $(E, A, L, \\sigma_{\\max}, \\delta_0, \\delta_f, \\delta)$, with all quantities in the units specified above:\n\n- Case $1$ (typical near-initiation softening, strong bulk): `(210e9, 1.0e-4, 2.0e-1, 5.0e6, 1.0e-5, 5.0e-5, 1.2e-5)`.\n\n- Case $2$ (softening with weak bulk): `(210e9, 1.0e-4, 2.0, 5.0e6, 1.0e-5, 5.0e-5, 1.2e-5)`.\n\n- Case $3$ (boundary case at the turning point): `(210e9, 1.0e-4, 2.1e-1, 5.0e6, 1.0e-5, 1.5e-5, 1.2e-5)`.\n\n- Case $4$ (pre-peak, elastic cohesive response): `(210e9, 1.0e-4, 2.0e-1, 5.0e6, 1.0e-5, 5.0e-5, 8.0e-6)`.\n\n- Case $5$ (deep softening, large interface area): `(210e9, 5.0e-4, 5.0e-1, 6.0e6, 8.0e-6, 1.6e-5, 1.2e-5)`.\n\nYour program must, for each case, compute $K_b$, $K_s$, and $K_t$ from the definitions above, evaluate the derived non-dimensional index, and output a single line containing a list of $5$ integers in the following order corresponding to Cases $1$ through $5$: print $\\left[0,1\\right]$-valued decisions, with $1$ meaning “switch to explicit” and $0$ meaning “remain implicit.”\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5\\right]$), where each $\\mathrm{result}_i$ is an integer $0$ or $1$ as defined above.", "solution": "The problem requires the derivation of a criterion to switch from a quasi-static implicit solution strategy to an explicit dynamic one when analyzing a one-dimensional bar with a cohesive interface. The switch is motivated by the potential for algorithmic failure of the implicit method when structural instability, specifically snap-back, occurs during cohesive softening. The derivation proceeds from the fundamental principles of equilibrium and kinematic compatibility.\n\nThe system consists of a linear elastic bulk element and a nonlinear cohesive interface connected in series. The series connection implies two conditions:\n$1$. The force $F$ is uniform throughout the system: $F = F_{\\mathrm{bulk}} = F_{\\mathrm{cohesive}}$.\n$2$. The total displacement $\\Delta$ is the sum of the displacements of the components: $\\Delta = \\Delta_b + \\delta$, where $\\Delta_b$ is the elongation of the bulk material and $\\delta$ is the separation of the cohesive interface.\n\nThe constitutive relations for the components are given.\nFor the bulk element, the force-displacement relation is linear:\n$$F = K_b \\Delta_b$$\nwhere $K_b = \\dfrac{E A}{L}$ is the bulk stiffness.\n\nFor the cohesive interface, the force $F$ is related to the cohesive traction $t(\\delta)$ and the cross-sectional area $A$:\n$$F = A \\, t(\\delta)$$\nThe traction $t(\\delta)$ follows a bilinear law dependent on the separation $\\delta$.\n\nOur objective is to analyze the structural response under a prescribed total displacement $\\Delta$. It is advantageous to select a single independent variable that describes the state of the system. The cohesive separation $\\delta$ is the natural choice, as it governs the nonlinearity. We can express the total displacement $\\Delta$ as a function of $\\delta$.\n\nFrom the bulk constitutive relation, the bulk elongation is $\\Delta_b = \\dfrac{F}{K_b}$. Substituting the cohesive force relation, we get:\n$$\\Delta_b(\\delta) = \\dfrac{A \\, t(\\delta)}{K_b}$$\nThe total displacement $\\Delta$ is then given by:\n$$\\Delta(\\delta) = \\Delta_b(\\delta) + \\delta = \\dfrac{A \\, t(\\delta)}{K_b} + \\delta$$\nThis equation represents the equilibrium path of the system, relating the control parameter $\\Delta$ to the internal state variable $\\delta$.\n\nIn a quasi-static, displacement-controlled analysis, we incrementally increase the total displacement $\\Delta$ and solve for the corresponding equilibrium state $\\delta$. The local solvability and stability of this procedure depend on the relationship between an infinitesimal increment $\\mathrm{d}\\Delta$ and the corresponding increment $\\mathrm{d}\\delta$. This relationship is found by differentiating $\\Delta(\\delta)$ with respect to $\\delta$:\n$$\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta} = \\dfrac{\\mathrm{d}}{\\mathrm{d}\\delta} \\left[ \\dfrac{A \\, t(\\delta)}{K_b} + \\delta \\right] = \\dfrac{A}{K_b} \\dfrac{\\mathrm{d}t}{\\mathrm{d}\\delta} + 1$$\nWe recognize the term $A \\dfrac{\\mathrm{d}t}{\\mathrm{d}\\delta}$ as the tangent stiffness of the cohesive interface, which is provided as $K_t = A K_t^{\\mathrm{(trac)}}(\\delta) = A \\dfrac{\\mathrm{d}t}{\\mathrm{d}\\delta}$. Substituting this definition, we obtain:\n$$\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta} = \\dfrac{K_t}{K_b} + 1 = \\dfrac{K_b + K_t}{K_b}$$\nA stable equilibrium path under displacement control is one where an increase in total displacement $\\Delta$ corresponds to an increase in internal separation $\\delta$. This requires $\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta} > 0$. Since $K_b = \\dfrac{EA}{L}$ is always positive for a physical material, this condition is equivalent to:\n$$K_b + K_t > 0$$\nA critical point, or limit point, is reached when $\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta} = 0$. This corresponds to a vertical tangent on the $\\delta$ vs. $\\Delta$ curve, or a horizontal tangent on the $\\Delta$ vs. $\\delta$ curve. This limit point is defined by:\n$$K_b + K_t = 0$$\nBeyond this point, if the path continues, we have $\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta}  0$. This signifies a snap-back instability: to follow the equilibrium path, the total displacement $\\Delta$ must decrease as the internal separation $\\delta$ continues to increase. A standard displacement-controlled Newton-Raphson solver, which assumes a monotonic relationship between the control parameter and the state variables, will fail to converge across such a limit point. Explicit dynamic solvers, by integrating the equations of motion step-by-step in time, do not rely on inverting a tangent stiffness matrix and can trace unstable post-peak paths, provided the time step is sufficiently small.\n\nTherefore, the condition to switch from an implicit quasi-static to an explicit dynamic scheme is the onset of this snap-back instability. The criterion is:\n$$\\text{Switch to explicit when } K_b + K_t  0$$\nThis occurs only when the cohesive interface is in the softening regime, where its tangent stiffness $K_t$ is negative. The inequality can be rewritten as $K_b  -K_t$ or $K_b  |K_t|$. This is a physically intuitive result: snap-back occurs if the bulk material is compliant enough (small $K_b$) relative to the rate of cohesive softening (large negative $K_t$). If the bulk is very stiff, it can control the deformation and prevent the sudden release of stored elastic energy that drives the dynamic snap-back.\n\nThe problem asks for a non-dimensional index involving $K_b$, $K_t$, and the cohesive secant stiffness $K_s$. The derived condition $K_b + K_t = 0$ defines the turning point. We can construct an index whose sign change corresponds to this condition. Let us define the index $\\eta$ as:\n$$\\eta = \\dfrac{K_b + K_t}{K_s}$$\nwhere $K_s = A \\dfrac{t(\\delta)}{\\delta}$. Since we are interested in fracture initiation and propagation, we consider states where $\\delta > 0$ and $t(\\delta) > 0$, ensuring $K_s > 0$. Therefore, the sign of the index $\\eta$ is identical to the sign of its numerator, $K_b + K_t$. The switching criterion can be restated as:\n$$\\text{Switch to explicit when } \\eta  0$$\nThis formulation satisfies all constraints of the problem description.\n\nThe decision rule for the program is as follows: for a given set of parameters $(E, A, L, \\sigma_{\\max}, \\delta_0, \\delta_f, \\delta)$:\n$1$. Calculate the bulk stiffness $K_b = \\dfrac{E A}{L}$.\n$2$. Determine the cohesive tangent stiffness $K_t$ based on the value of $\\delta$:\n   - If $0 \\le \\delta \\le \\delta_0$: $K_t = A \\left( \\dfrac{\\sigma_{\\max}}{\\delta_0} \\right)$.\n   - If $\\delta_0  \\delta \\le \\delta_f$: $K_t = -A \\left( \\dfrac{\\sigma_{\\max}}{\\delta_f - \\delta_0} \\right)$.\n$3$. Evaluate the sum $K_b + K_t$.\n$4$. If $K_b + K_t  0$, the decision is to switch to an explicit scheme (output $1$). Otherwise, it is safe to remain with an implicit scheme (output $0$). The boundary case $K_b + K_t = 0$ falls under the \"remain implicit\" category as the instability has not yet manifested.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of deciding whether to switch from an implicit to an explicit\n    time integration scheme for a 1D bar with a cohesive interface.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (typical near-initiation softening, strong bulk)\n        (210e9, 1.0e-4, 2.0e-1, 5.0e6, 1.0e-5, 5.0e-5, 1.2e-5),\n        # Case 2 (softening with weak bulk)\n        (210e9, 1.0e-4, 2.0, 5.0e6, 1.0e-5, 5.0e-5, 1.2e-5),\n        # Case 3 (boundary case at the turning point)\n        (210e9, 1.0e-4, 2.1e-1, 5.0e6, 1.0e-5, 1.5e-5, 1.2e-5),\n        # Case 4 (pre-peak, elastic cohesive response)\n        (210e9, 1.0e-4, 2.0e-1, 5.0e6, 1.0e-5, 5.0e-5, 8.0e-6),\n        # Case 5 (deep softening, large interface area)\n        (210e9, 5.0e-4, 5.0e-1, 6.0e6, 8.0e-6, 1.6e-5, 1.2e-5),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E, A, L, sigma_max, delta_0, delta_f, delta = case\n        \n        # Calculate bulk stiffness Kb\n        # Kb = (E * A) / L\n        K_b = (E * A) / L\n        \n        # Calculate cohesive tangent stiffness Kt\n        # Kt depends on the current separation delta\n        if delta  0 or delta  delta_f:\n            # This case is outside the defined model, but for completeness,\n            # we can assume no stiffness or handle as an error.\n            # Here, we'll assume it doesn't happen based on problem constraints.\n            # A robust implementation might raise an error.\n            # For this problem let's assume Kt=0 for delta > delta_f\n            K_t = 0.0\n        elif delta = delta_0:\n            # Loading/elastic regime (positive tangent stiffness)\n            # K_t = A * (sigma_max / delta_0)\n            K_t = A * (sigma_max / delta_0)\n        else: # delta_0  delta = delta_f\n            # Softening regime (negative tangent stiffness)\n            # K_t = - A * (sigma_max / (delta_f - delta_0))\n            K_t = -A * (sigma_max / (delta_f - delta_0))\n            \n        # The stability criterion for a displacement-controlled system is K_b + K_t.\n        # Snap-back instability occurs if K_b + K_t  0.\n        # At this point, an implicit quasi-static solver will face convergence issues.\n        # It is advisable to switch to an explicit dynamic solver to trace the unstable path.\n        \n        # Decision: 1 for \"switch to explicit\", 0 for \"remain implicit\"\n        if K_b + K_t  0:\n            decision = 1\n        else:\n            decision = 0\n            \n        results.append(decision)\n\n    # Print results in the specified format: [result1,result2,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3598283"}]}