{"hands_on_practices": [{"introduction": "One of the most powerful features of the generalized-α method is its ability to provide controllable numerical dissipation for high-frequency modes, which are often spurious artifacts of spatial discretization. This exercise [@problem_id:3568272] provides a tangible link between the abstract spectral radius at infinity, $\\rho_\\infty$, and the practical rate at which these unwanted oscillations are damped. By estimating the highest frequency a finite element mesh can represent, you will calculate the real-world effect of your choice of $\\rho_\\infty$.", "problem": "A uniform prismatic bar is modeled in one spatial dimension under small-strain, linear-elastic, longitudinal motion with no external damping. The bar has Young’s modulus $E = 210 \\,\\text{GPa}$, mass density $\\rho = 7800 \\,\\text{kg/m}^3$, and length $L = 1.0 \\,\\text{m}$. The finite element semi-discrete model uses linear shape functions on a uniform mesh with $N_{e} = 100$ elements, so the nodal spacing is $h = L/N_{e}$. The time integration is performed by the generalized-$\\alpha$ method, configured with spectral radius at infinity $\\rho_{\\infty} = 0.5$.\n\nStarting only from fundamental laws and core definitions, proceed as follows:\n- Use Newton’s second law for a continuum and the one-dimensional constitutive relation to obtain the longitudinal wave speed $c$ for the bar.\n- Using spatial sampling considerations for a nodal grid with spacing $h$, identify the highest resolvable wavenumber $k_{\\max}$ that can be represented on the mesh and estimate the corresponding highest resolvable angular frequency $\\omega_{\\max}$ of the semi-discrete model.\n- Using the definition of spectral radius at infinity $\\rho_{\\infty}$ for the generalized-$\\alpha$ method and its implication for the asymptotic high-frequency amplification factor per time step, determine the minimal integer number of time steps $n$ required to reduce the amplitude of the $\\omega_{\\max}$ mode by a factor $10^{-3}$.\n\nReport the following:\n1. The estimate of the highest resolvable angular frequency $\\omega_{\\max}$ in radians per second, rounded to four significant figures.\n2. The minimal integer number of time steps $n$.\n\nExpress the final answer as a two-entry row in the form $\\left(\\omega_{\\max}, n\\right)$. Do not include units in the final answer box, but use radians per second for $\\omega_{\\max}$ in your calculations as specified above.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in continuum mechanics and computational methods, well-posed with sufficient and consistent data, and objectively stated.\n\nThe solution proceeds in three parts as requested.\n\nFirst, we derive the longitudinal wave speed $c$ for the uniform prismatic bar. We apply Newton's second law to a differential element of the bar with cross-sectional area $A$, length $dx$, and mass density $\\rho$. The mass of the element is $dm = \\rho A dx$. The net force on the element is the difference in stress $\\sigma$ over its length, $dF = (\\sigma(x+dx) - \\sigma(x))A \\approx \\frac{\\partial\\sigma}{\\partial x} A dx$. Newton's second law, $dF = (dm) a$, where the acceleration is $a = \\frac{\\partial^2 u}{\\partial t^2}$ for longitudinal displacement $u(x,t)$, becomes:\n$$ \\frac{\\partial\\sigma}{\\partial x} A dx = (\\rho A dx) \\frac{\\partial^2 u}{\\partial t^2} $$\nThis simplifies to the one-dimensional equation of motion:\n$$ \\frac{\\partial\\sigma}{\\partial x} = \\rho \\frac{\\partial^2 u}{\\partial t^2} $$\nFor a linear-elastic material under small strain, the constitutive relation is $\\sigma = E \\epsilon$, where $E$ is Young's modulus and $\\epsilon$ is the axial strain. The strain is defined as the spatial gradient of the displacement, $\\epsilon = \\frac{\\partial u}{\\partial x}$. Substituting this into the constitutive relation gives $\\sigma = E \\frac{\\partial u}{\\partial x}$.\nNext, we substitute this expression for stress into the equation of motion:\n$$ \\frac{\\partial}{\\partial x} \\left( E \\frac{\\partial u}{\\partial x} \\right) = \\rho \\frac{\\partial^2 u}{\\partial t^2} $$\nSince the bar is uniform, its properties $E$ and $\\rho$ are constant, so we can write:\n$$ E \\frac{\\partial^2 u}{\\partial x^2} = \\rho \\frac{\\partial^2 u}{\\partial t^2} $$\nRearranging this equation yields the classical one-dimensional wave equation:\n$$ \\frac{\\partial^2 u}{\\partial t^2} = \\frac{E}{\\rho} \\frac{\\partial^2 u}{\\partial x^2} $$\nBy comparing this to the canonical form $\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}$, we identify the square of the wave speed as $c^2 = \\frac{E}{\\rho}$. Thus, the longitudinal wave speed is $c = \\sqrt{\\frac{E}{\\rho}}$.\nGiven the values $E = 210 \\,\\text{GPa} = 210 \\times 10^9 \\,\\text{Pa}$ and $\\rho = 7800 \\,\\text{kg/m}^3$, the wave speed is:\n$$ c = \\sqrt{\\frac{210 \\times 10^9}{7800}} \\,\\text{m/s} $$\n\nSecond, we estimate the highest resolvable angular frequency $\\omega_{\\max}$. The bar of length $L = 1.0 \\,\\text{m}$ is discretized into $N_{e} = 100$ uniform finite elements. The nodal spacing is therefore $h = \\frac{L}{N_{e}} = \\frac{1.0}{100} = 0.01 \\,\\text{m}$.\nSpatial sampling theory dictates that a grid with spacing $h$ can, at best, represent a wave with a minimum wavelength of $\\lambda_{\\min} = 2h$. This is the spatial equivalent of the Nyquist-Shannon sampling theorem. This mode corresponds to a nodal displacement pattern of alternating signs (e.g., $..., +1, -1, +1, -1, ...$). The highest resolvable wavenumber $k_{\\max}$ is associated with this minimum wavelength:\n$$ k_{\\max} = \\frac{2\\pi}{\\lambda_{\\min}} = \\frac{2\\pi}{2h} = \\frac{\\pi}{h} $$\nThe problem asks for an estimate of the corresponding highest angular frequency $\\omega_{\\max}$. The simplest and most direct estimate is obtained by using the non-dispersive dispersion relation from the continuum wave equation, $\\omega = c k$. Applying this to the highest wavenumber gives:\n$$ \\omega_{\\max} = c k_{\\max} = c \\frac{\\pi}{h} $$\nSubstituting the expressions for $c$ and $h$:\n$$ \\omega_{\\max} = \\left( \\sqrt{\\frac{210 \\times 10^9}{7800}} \\right) \\frac{\\pi}{0.01} = 100\\pi \\sqrt{\\frac{210 \\times 10^9}{7800}} \\,\\text{rad/s} $$\nNumerically, this evaluates to:\n$$ \\omega_{\\max} \\approx 1630080.3 \\,\\text{rad/s} $$\nAs per the problem's requirement, rounding this value to four significant figures gives:\n$$ \\omega_{\\max} \\approx 1.630 \\times 10^6 \\,\\text{rad/s} $$\n\nThird, we determine the minimal number of time steps $n$ required to achieve the desired amplitude reduction for the highest frequency mode. The generalized-$\\alpha$ method is characterized by a parameter $\\rho_{\\infty}$, the spectral radius at infinity. This parameter defines the asymptotic behavior of the numerical amplification factor, $A(\\Omega)$, as the non-dimensional frequency $\\Omega = \\omega \\Delta t$ approaches infinity:\n$$ \\rho_{\\infty} = \\lim_{\\Omega \\to \\infty} |A(\\Omega)| $$\nFor the highest frequency modes of the semi-discrete system, such as the mode with frequency $\\omega_{\\max}$, the amplification factor per time step is approximated by $\\rho_{\\infty}$. Let the initial amplitude of the $\\omega_{\\max}$ mode be $A_0$. After $n$ time steps, its amplitude $A_n$ will be approximately:\n$$ A_n \\approx A_0 (\\rho_{\\infty})^n $$\nThe problem requires the amplitude to be reduced by a factor of $10^{-3}$, which means the ratio of the final to initial amplitude must be $A_n / A_0 \\le 10^{-3}$. This leads to the inequality:\n$$ (\\rho_{\\infty})^n \\le 10^{-3} $$\nWe are given $\\rho_{\\infty} = 0.5$. Substituting this value:\n$$ (0.5)^n \\le 10^{-3} $$\nTo solve for $n$, we take the natural logarithm of both sides:\n$$ \\ln\\left((0.5)^n\\right) \\le \\ln(10^{-3}) $$\nUsing the property of logarithms $\\ln(a^b) = b\\ln(a)$:\n$$ n \\ln(0.5) \\le -3 \\ln(10) $$\nSince $\\ln(0.5) = -\\ln(2)$ is a negative value, dividing by it reverses the inequality sign:\n$$ n \\ge \\frac{-3 \\ln(10)}{-\\ln(2)} = \\frac{3 \\ln(10)}{\\ln(2)} $$\nUsing the standard values $\\ln(10) \\approx 2.302585$ and $\\ln(2) \\approx 0.693147$:\n$$ n \\ge \\frac{3 \\times 2.302585}{0.693147} \\approx 9.96578 $$\nSince the number of time steps $n$ must be an integer, we must find the smallest integer that satisfies this condition. This is obtained by taking the ceiling of the value:\n$$ n = \\lceil 9.96578 \\rceil = 10 $$\nTherefore, a minimum of $10$ time steps are required.\n\nThe final answer consists of the estimated highest angular frequency $\\omega_{\\max}$ rounded to four significant figures and the minimal integer number of time steps $n$.\n$$ (\\omega_{\\max}, n) = (1.630 \\times 10^6, 10) $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.630 \\times 10^6  10\n\\end{pmatrix}\n}\n$$", "id": "3568272"}, {"introduction": "The generalized-α method is prized for its unconditional stability in linear analysis, but this property is guaranteed only when its parameters are chosen from an admissible set. This exercise [@problem_id:3568277] is a thought experiment designed to explore what happens when we venture outside these stable bounds. By deriving the asymptotic amplification factor for an invalid parameter set, you will witness firsthand how a seemingly small change can lead to catastrophic numerical instability.", "problem": "Consider a Single Degree of Freedom (SDOF) undamped linear oscillator governed by Newton’s second law $m \\ddot{x}(t) + k x(t) = 0$, where $m>0$ and $k>0$ are constant mass and stiffness, respectively, and define the circular frequency $\\omega = \\sqrt{k/m}$. Let the time step be $h>0$ and the non-dimensional step be $\\Omega = \\omega h$. The generalized-$\\alpha$ method is used to time-advance the discrete state $\\{x_{n}, v_{n}, a_{n}\\}$ to $\\{x_{n+1}, v_{n+1}, a_{n+1}\\}$ according to the implicit residual equation and kinematic updates:\n$$m\\, a_{n+\\alpha_{m}} + k\\, x_{n+\\alpha_{f}} = 0,$$\n$$x_{n+1} = x_{n} + h\\, v_{n} + h^{2}\\left(\\left(\\frac{1}{2} - \\beta\\right) a_{n} + \\beta\\, a_{n+1}\\right),$$\n$$v_{n+1} = v_{n} + h\\left((1 - \\gamma) a_{n} + \\gamma\\, a_{n+1}\\right),$$\nwith the generalized-$\\alpha$ interpolants\n$$a_{n+\\alpha_{m}} = (1 - \\alpha_{m}) a_{n+1} + \\alpha_{m} a_{n}, \\quad x_{n+\\alpha_{f}} = (1 - \\alpha_{f}) x_{n+1} + \\alpha_{f} x_{n}.$$\nAssume second-order accuracy parameters\n$$\\gamma = \\frac{1}{2} + \\alpha_{m} - \\alpha_{f}, \\quad \\beta = \\frac{1}{4}\\left(1 - \\alpha_{f} + \\alpha_{m}\\right)^{2},$$\nbut choose the generalized-$\\alpha$ parameters outside the standard admissible set by taking $\\alpha_{m} = 0.9$ and $\\alpha_{f} = 0.8$, which violates $\\alpha_{m} \\le \\alpha_{f}$. Starting from bounded initial discrete values $x_{n}$, $v_{n}$, $a_{n}$, derive, by asymptotic analysis of the above discrete equations for large $\\Omega$, the limiting displacement amplification factor\n$$g_{\\infty} = \\lim_{\\Omega \\to \\infty} \\frac{x_{n+1}}{x_{n}}.$$\nCompute the exact value of $g_{\\infty}$ for the specified parameters. Express your final answer as a dimensionless number with no units.", "solution": "The user has provided a problem from the field of computational mechanics, specifically concerning the analysis of the generalized-$\\alpha$ time integration method.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- The governing equation for a Single Degree of Freedom (SDOF) undamped linear oscillator: $m \\ddot{x}(t) + k x(t) = 0$, with mass $m>0$ and stiffness $k>0$.\n- The circular frequency: $\\omega = \\sqrt{k/m}$.\n- The time step $h>0$ and non-dimensional step $\\Omega = \\omega h$.\n- The discrete update equations for the generalized-$\\alpha$ method:\n    - Residual equation: $m\\, a_{n+\\alpha_{m}} + k\\, x_{n+\\alpha_{f}} = 0$.\n    - Kinematic updates:\n        $$x_{n+1} = x_{n} + h\\, v_{n} + h^{2}\\left(\\left(\\frac{1}{2} - \\beta\\right) a_{n} + \\beta\\, a_{n+1}\\right)$$\n        $$v_{n+1} = v_{n} + h\\left((1 - \\gamma) a_{n} + \\gamma\\, a_{n+1}\\right)$$\n    - Interpolants:\n        $$a_{n+\\alpha_{m}} = (1 - \\alpha_{m}) a_{n+1} + \\alpha_{m} a_{n}$$\n        $$x_{n+\\alpha_{f}} = (1 - \\alpha_{f}) x_{n+1} + \\alpha_{f} x_{n}$$\n- The parameters $\\gamma$ and $\\beta$ for second-order accuracy:\n    $$\\gamma = \\frac{1}{2} + \\alpha_{m} - \\alpha_{f}$$\n    $$\\beta = \\frac{1}{4}\\left(1 - \\alpha_{f} + \\alpha_{m}\\right)^{2}$$\n- Specific numerical values for the generalized-$\\alpha$ parameters: $\\alpha_{m} = 0.9$ and $\\alpha_{f} = 0.8$.\n- The task is to derive the limiting displacement amplification factor $g_{\\infty} = \\lim_{\\Omega \\to \\infty} \\frac{x_{n+1}}{x_{n}}$ and compute its value.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is a standard exercise in the numerical analysis of time integration schemes. The problem asks to investigate the behavior of the scheme with a specific set of parameters, which, while noted as being outside the usual set for unconditional stability, does not constitute a flaw. On the contrary, analyzing a method's behavior with non-standard parameters is a valid scientific inquiry to understand its properties. All necessary equations and data are provided. The problem is self-contained and free of contradictions or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Solution\nThe objective is to determine the asymptotic displacement amplification factor, $g_{\\infty}$, for the generalized-$\\alpha$ method as the non-dimensional time step $\\Omega = \\omega h$ approaches infinity. This is achieved by analyzing the amplification matrix of the numerical scheme in this limit.\n\nFirst, we express the state at time step $n+1$, $\\{x_{n+1}, v_{n+1}, a_{n+1}\\}$, in terms of the state at time step $n$, $\\{x_{n}, v_{n}, a_{n}\\}$. We begin by solving for the acceleration $a_{n+1}$ from the residual equation. Substitute the interpolants into the residual equation:\n$$m\\left((1 - \\alpha_{m}) a_{n+1} + \\alpha_{m} a_{n}\\right) + k\\left((1 - \\alpha_{f}) x_{n+1} + \\alpha_{f} x_{n}\\right) = 0$$\nNext, substitute the expression for $x_{n+1}$ into this equation:\n$$m\\left((1 - \\alpha_{m}) a_{n+1} + \\alpha_{m} a_{n}\\right) + k\\left((1 - \\alpha_{f}) \\left[x_{n} + h v_{n} + h^{2}\\left(\\left(\\frac{1}{2} - \\beta\\right) a_{n} + \\beta a_{n+1}\\right)\\right] + \\alpha_{f} x_{n}\\right) = 0$$\nCollecting terms for $a_{n+1}$:\n$$a_{n+1} \\left[m(1 - \\alpha_{m}) + k h^{2} \\beta (1 - \\alpha_{f})\\right] = -m \\alpha_{m} a_{n} - k \\alpha_{f} x_{n} - k(1 - \\alpha_{f}) \\left[x_{n} + h v_{n} + h^{2}\\left(\\frac{1}{2} - \\beta\\right) a_{n}\\right]$$\nSimplifying the right-hand side:\n$$a_{n+1} \\left[m(1 - \\alpha_{m}) + k h^{2} \\beta (1 - \\alpha_{f})\\right] = - \\left[m \\alpha_{m} + k h^{2} (1 - \\alpha_{f}) \\left(\\frac{1}{2} - \\beta\\right)\\right] a_{n} - k x_{n} - k h (1 - \\alpha_{f}) v_{n}$$\nWe define $\\omega^{2} = k/m$ and $\\Omega = \\omega h$, so $k h^{2} = m \\Omega^{2}$. Dividing by $m$:\n$$a_{n+1} \\left[(1 - \\alpha_{m}) + \\Omega^{2} \\beta (1 - \\alpha_{f})\\right] = - \\left[\\alpha_{m} + \\Omega^{2} (1 - \\alpha_{f}) \\left(\\frac{1}{2} - \\beta\\right)\\right] a_{n} - \\omega^{2} x_{n} - h \\omega^{2} (1 - \\alpha_{f}) v_{n}$$\nLet $D = (1 - \\alpha_{m}) + \\Omega^{2} \\beta (1 - \\alpha_{f})$. We can write $a_{n+1}$ as:\n$$a_{n+1} = -\\frac{\\alpha_{m} + \\Omega^{2}(1-\\alpha_f)(\\frac{1}{2}-\\beta)}{D} a_n - \\frac{\\omega^2}{D} x_n - \\frac{h\\omega^2(1-\\alpha_f)}{D} v_n$$\nTo analyze the system's behavior, we define a non-dimensional state vector $\\mathbf{y}_{n} = \\{x_{n}, h v_{n}, h^{2} a_{n}\\}^{T}$. Let $X_n = x_n$, $V_n = h v_n$, and $A_n = h^2 a_n$. The update rules become:\n$$A_{n+1} = h^2 a_{n+1} = c_A A_n + c_X X_n + c_V V_n$$\nwhere\n$$c_A = -\\frac{\\alpha_{m} + \\Omega^{2}(1-\\alpha_f)(\\frac{1}{2}-\\beta)}{D}, \\quad c_X = -h^2\\frac{\\omega^2}{D} = -\\frac{\\Omega^2}{D}, \\quad c_V = -h\\frac{h\\omega^2(1-\\alpha_f)}{D} = -\\frac{\\Omega^2(1-\\alpha_f)}{D}$$\nThe kinematic updates in terms of the new state vector are:\n$$X_{n+1} = X_n + V_n + \\left(\\frac{1}{2} - \\beta\\right) A_n + \\beta A_{n+1}$$\n$$V_{n+1} = V_n + (1 - \\gamma) A_n + \\gamma A_{n+1}$$\nSubstituting the expression for $A_{n+1}$:\n$$X_{n+1} = (1 + \\beta c_X) X_n + (1 + \\beta c_V) V_n + \\left(\\frac{1}{2} - \\beta + \\beta c_A\\right) A_n$$\n$$V_{n+1} = (\\gamma c_X) X_n + (1 + \\gamma c_V) V_n + (1 - \\gamma + \\gamma c_A) A_n$$\nThe system can now be written in matrix form $\\mathbf{y}_{n+1} = \\mathbf{A}_{\\Omega} \\mathbf{y}_{n}$, where $\\mathbf{A}_{\\Omega}$ is the amplification matrix:\n$$\\mathbf{A}_{\\Omega} = \\begin{pmatrix} 1 + \\beta c_X  1 + \\beta c_V  \\frac{1}{2} - \\beta + \\beta c_A \\\\ \\gamma c_X  1 + \\gamma c_V  1 - \\gamma + \\gamma c_A \\\\ c_X  c_V  c_A \\end{pmatrix}$$\nWe now take the limit of the coefficients as $\\Omega \\to \\infty$. The denominator $D = (1 - \\alpha_{m}) + \\Omega^{2} \\beta (1 - \\alpha_{f}) \\sim \\Omega^{2} \\beta (1 - \\alpha_{f})$ for large $\\Omega$.\n$$\\lim_{\\Omega\\to\\infty} c_A = \\lim_{\\Omega\\to\\infty} -\\frac{\\Omega^{2}(1-\\alpha_f)(\\frac{1}{2}-\\beta)}{\\Omega^{2}\\beta(1-\\alpha_f)} = -\\frac{\\frac{1}{2}-\\beta}{\\beta} = 1 - \\frac{1}{2\\beta}$$\n$$\\lim_{\\Omega\\to\\infty} c_X = \\lim_{\\Omega\\to\\infty} -\\frac{\\Omega^2}{\\Omega^{2} \\beta (1 - \\alpha_{f})} = -\\frac{1}{\\beta(1-\\alpha_f)}$$\n$$\\lim_{\\Omega\\to\\infty} c_V = \\lim_{\\Omega\\to\\infty} -\\frac{\\Omega^2(1-\\alpha_f)}{\\Omega^{2} \\beta (1 - \\alpha_{f})} = -\\frac{1}{\\beta}$$\nUsing these limits, we find the asymptotic amplification matrix $\\mathbf{A}_{\\infty} = \\lim_{\\Omega\\to\\infty} \\mathbf{A}_{\\Omega}$:\nThe entries of the first row of $\\mathbf{A}_{\\infty}$ are:\n$$A_{11, \\infty} = 1 + \\beta \\left(-\\frac{1}{\\beta(1-\\alpha_f)}\\right) = 1 - \\frac{1}{1-\\alpha_f} = \\frac{1-\\alpha_f-1}{1-\\alpha_f} = -\\frac{\\alpha_f}{1-\\alpha_f}$$\n$$A_{12, \\infty} = 1 + \\beta \\left(-\\frac{1}{\\beta}\\right) = 1 - 1 = 0$$\n$$A_{13, \\infty} = \\frac{1}{2} - \\beta + \\beta \\left(1 - \\frac{1}{2\\beta}\\right) = \\frac{1}{2} - \\beta + \\beta - \\frac{1}{2} = 0$$\nThe asymptotic update for the displacement $X_{n+1}=x_{n+1}$ is therefore:\n$$x_{n+1} \\approx \\left(-\\frac{\\alpha_f}{1-\\alpha_f}\\right) x_n + 0 \\cdot (h v_n) + 0 \\cdot (h^2 a_n)$$\nThis gives us the limiting displacement amplification factor:\n$$g_{\\infty} = \\lim_{\\Omega \\to \\infty} \\frac{x_{n+1}}{x_{n}} = -\\frac{\\alpha_f}{1-\\alpha_f}$$\nThe problem specifies the values $\\alpha_m = 0.9$ and $\\alpha_f = 0.8$. The value of $\\alpha_m$ does not influence $g_\\infty$, nor do the second-order accuracy parameters $\\beta$ and $\\gamma$. Substituting the value of $\\alpha_f$:\n$$g_{\\infty} = -\\frac{0.8}{1 - 0.8} = -\\frac{0.8}{0.2} = -4$$\nThe limiting displacement amplification factor is $-4$. This indicates that for very high frequencies (or large time steps), the numerical solution for displacement will be unstable, amplifying by a factor of $-4$ at each step. This behavior is expected because the chosen parameters $\\alpha_m = 0.9$ and $\\alpha_f = 0.8$ violate the condition $\\alpha_m \\le \\alpha_f$, which is a necessary condition for unconditional stability in the standard formulation.", "answer": "$$\\boxed{-4}$$", "id": "3568277"}, {"introduction": "The generalized-α framework provides a unified view of several popular time integration schemes, including the HHT-α and WBZ-α methods. While these schemes are equivalent for linear problems, their behavior diverges in the presence of nonlinearity. This advanced exercise [@problem_id:3568254] first establishes their linear equivalence and then uses a nonlinear oscillator to demonstrate how their different approaches to filtering—acting on inertial versus internal force terms—can lead to distinct energy conservation properties.", "problem": "Consider the second-order initial value problem that models a single-degree-of-freedom oscillator in computational solid mechanics, governed by Newton’s second law $M \\ddot{u}(t) + f_{\\text{int}}(u(t)) = f_{\\text{ext}}(t)$ with mass $M = 1$, no external force $f_{\\text{ext}}(t) = 0$, and internal force $f_{\\text{int}}(u) = k u + \\mu u^{3}$, where $k \\ge 0$ and $\\mu \\ge 0$. A two-parameter, second-order accurate time integrator known as the generalized-$\\alpha$ method is defined by Newmark-type kinematics and a weighted residual equilibrium enforced at an intermediate time. Specifically, with time step $\\Delta t$, update from step $n$ to $n+1$ uses\n$$\nu_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\Delta t^2 \\beta\\, a_{n+1}, \\quad\nv_{n+1} = v_n + \\Delta t\\left[(1-\\gamma) a_n + \\gamma a_{n+1}\\right],\n$$\nand the equilibrium is imposed at the weighted time levels\n$$\na_{n+\\alpha_m} = (1-\\alpha_m) a_{n+1} + \\alpha_m a_n, \\quad\nu_{n+\\alpha_f} = (1-\\alpha_f) u_{n+1} + \\alpha_f u_n,\n$$\nwith residual equation\n$$\na_{n+\\alpha_m} + f_{\\text{int}}(u_{n+\\alpha_f}) = 0.\n$$\nFor second-order accuracy and to control high-frequency numerical dissipation, the parameters satisfy\n$$\n\\gamma = \\tfrac{1}{2} + \\alpha_f - \\alpha_m, \\qquad\n\\beta = \\tfrac{1}{4}\\left(1 + \\alpha_f - \\alpha_m\\right)^2.\n$$\nTwo classical special cases are the Hilber–Hughes–Taylor-$\\alpha$ method (HHT-$\\alpha$) and the Wood–Bossak–Zienkiewicz-$\\alpha$ method (WBZ-$\\alpha$). In HHT-$\\alpha$, the inertia is not filtered ($\\alpha_m = 0$) but the internal force is filtered with parameter $\\alpha_{\\mathrm{HHT}}$; in WBZ-$\\alpha$, the internal force is unfiltered ($\\alpha_f = 0$) while the inertia is filtered with parameter $\\alpha_{\\mathrm{WBZ}}$. Both recover Newmark’s average acceleration at $\\alpha_{\\mathrm{HHT}} = 0$ or $\\alpha_{\\mathrm{WBZ}} = 0$.\n\nTask 1 (derivation): Starting from the linear undamped case with $f_{\\text{int}}(u) = k u$ and constant $\\Delta t$, derive parameter mappings that make the generalized-$\\alpha$ method identical to each special case in the sense of their one-step amplification mapping for the state. In particular:\n- Show that HHT-$\\alpha$ is recovered by setting $\\,\\alpha_m = 0\\,$ and $\\,\\alpha_f = -\\alpha_{\\mathrm{HHT}}\\,$ with the above $\\beta$ and $\\gamma$ choices, so the amplification factors coincide for all frequencies.\n- Show that WBZ-$\\alpha$ is recovered by setting $\\,\\alpha_f = 0\\,$ and $\\,\\alpha_m = -\\alpha_{\\mathrm{WBZ}}\\,$ with the above $\\beta$ and $\\gamma$ choices, so the amplification factors coincide for all frequencies.\n\nTask 2 (amplification check via a computable mapping): For the linear undamped oscillator ($\\mu = 0$), define the two-dimensional amplification matrix $A \\in \\mathbb{R}^{2 \\times 2}$ mapping the pair $(u_n, v_n)$ to $(u_{n+1}, v_{n+1})$ by executing one time step from two linearly independent, physically consistent initial conditions:\n- Basis 1: $u_n = 1$, $v_n = 0$, $a_n = -k u_n$.\n- Basis 2: $u_n = 0$, $v_n = 1$, $a_n = -k u_n = 0$.\nLet $A$ be formed by placing the resulting $(u_{n+1}, v_{n+1})$ as columns corresponding to each basis. Using this definition, compute the Frobenius norm of the difference of amplification matrices when comparing the generalized-$\\alpha$ method against HHT-$\\alpha$ or WBZ-$\\alpha$ under the mappings derived in Task 1.\n\nTask 3 (nonlinear experiment to expose differences): Consider the nonlinear Duffing-type oscillator with $f_{\\text{int}}(u) = k u + \\mu u^{3}$ and zero external load. Implement a Newton–Raphson corrector at each time step (using the exact tangent $k + 3 \\mu u^2$ evaluated at $u_{n+\\alpha_f}$) within the generalized-$\\alpha$ residual. Design an experiment that integrates from $t=0$ to $t = N \\Delta t$ with initial conditions $u_0 = 1$, $v_0 = 0$, and consistent $a_0$ from equilibrium. Compare three schemes under the same time step and model parameters:\n- HHT-$\\alpha$ with $\\alpha_{\\mathrm{HHT}} = -0.2$ mapped to the generalized-$\\alpha$ parameters.\n- WBZ-$\\alpha$ with $\\alpha_{\\mathrm{WBZ}} = 0.2$ mapped to the generalized-$\\alpha$ parameters.\n- A mixed generalized-$\\alpha$ scheme with $\\alpha_m = -0.1$, $\\alpha_f = 0.1$.\nQuantify and report, for each scheme, the energy drift $E_{N} - E_{0}$ where the discrete mechanical energy is\n$$\nE_n = \\tfrac{1}{2} v_n^2 + \\tfrac{1}{2} k u_n^2 + \\tfrac{1}{4} \\mu u_n^4.\n$$\nAll quantities are nondimensional in this problem, so no physical units are required.\n\nTest suite and required outputs:\n- Use the following test cases and produce the specified outputs.\n  1. Linear, undamped, mapping check HHT-$\\alpha$: set $\\Delta t = 0.01$, $k = 400$, $\\mu = 0$, $\\alpha_{\\mathrm{HHT}} = -0.2$. Compute the Frobenius norm of the difference between the amplification matrix for generalized-$\\alpha$ with $(\\alpha_m, \\alpha_f) = (0, -\\alpha_{\\mathrm{HHT}})$ and the HHT-$\\alpha$ scheme.\n  2. Linear, undamped, mapping check WBZ-$\\alpha$: set $\\Delta t = 0.01$, $k = 400$, $\\mu = 0$, $\\alpha_{\\mathrm{WBZ}} = 0.2$. Compute the Frobenius norm of the difference between the amplification matrix for generalized-$\\alpha$ with $(\\alpha_m, \\alpha_f) = (-\\alpha_{\\mathrm{WBZ}}, 0)$ and the WBZ-$\\alpha$ scheme.\n  3. Linear, undamped, boundary mapping check HHT-$\\alpha$: set $\\Delta t = 0.01$, $k = 400$, $\\mu = 0$, $\\alpha_{\\mathrm{HHT}} = -\\tfrac{1}{3}$. Compute the Frobenius norm of the difference between amplification matrices as in case 1.\n  4. Nonlinear experiment (Duffing): set $\\Delta t = 0.05$, $N = 400$, $k = 1$, $\\mu = 1$, $u_0 = 1$, $v_0 = 0$, with $a_0$ determined from $a_0 + k u_0 + \\mu u_0^3 = 0$. Compute and return the list of three floats $[E_{N}^{\\text{HHT}} - E_{0}, E_{N}^{\\text{WBZ}} - E_{0}, E_{N}^{\\text{GA-mixed}} - E_{0}]$ for the three schemes specified above.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with test cases in order. The fourth entry must be the bracketed list of three floats. The exact output format must be `[r1,r2,r3,[e1,e2,e3]]`.", "solution": "The problem statement has been critically validated and is determined to be sound. It is scientifically grounded in the principles of computational solid mechanics, specifically concerning time integration schemes for second-order ordinary differential equations. The problem is well-posed, objective, and provides a complete and consistent set of definitions, parameters, and tasks. All constants and initial conditions are explicitly stated, and the required computations are formalizable and standard within the field.\n\n### Task 1: Derivation of Parameter Mappings\n\nThe goal is to demonstrate that the generalized-$\\alpha$ method, under specific parameter choices, becomes identical to the Hilber–Hughes–Taylor-$\\alpha$ (HHT-$\\alpha$) and Wood–Bossak–Zienkiewicz-$\\alpha$ (WBZ-$\\alpha$) methods for the linear, undamped case. The governing equation is $M \\ddot{u} + k u = 0$. With $M=1$, this is $\\ddot{u} + k u = 0$.\n\nThe generalized-$\\alpha$ method is defined by the Newmark kinematic updates and a residual equation enforced at intermediate time points. The residual equation is:\n$$\nM a_{n+\\alpha_m} + f_{\\text{int}}(u_{n+\\alpha_f}) = 0\n$$\nWith $M=1$ and linear internal force $f_{\\text{int}}(u)=ku$, this becomes:\n$$\na_{n+\\alpha_m} + k u_{n+\\alpha_f} = 0\n$$\nThe interpolated acceleration $a_{n+\\alpha_m}$ and displacement $u_{n+\\alpha_f}$ are defined as:\n$$\na_{n+\\alpha_m} = (1-\\alpha_m) a_{n+1} + \\alpha_m a_n\n$$\n$$\nu_{n+\\alpha_f} = (1-\\alpha_f) u_{n+1} + \\alpha_f u_n\n$$\nSubstituting these into the residual equation yields the discrete equation of motion for the generalized-$\\alpha$ scheme:\n$$\n(1-\\alpha_m) a_{n+1} + \\alpha_m a_n + k \\left( (1-\\alpha_f) u_{n+1} + \\alpha_f u_n \\right) = 0\n$$\n\n**1. HHT-$\\alpha$ Method Equivalence:**\n\nThe problem states that in the HHT-$\\alpha$ method, inertia is not filtered ($\\alpha_m=0$) and the internal force is filtered. The specific mapping to recover HHT-$\\alpha$ is given as $\\alpha_m=0$ and $\\alpha_f = -\\alpha_{\\mathrm{HHT}}$. The parameter $\\alpha_{\\mathrm{HHT}}$ typically lies in $[-\\frac{1}{3}, 0]$.\n\nBy substituting $\\alpha_m=0$ and $\\alpha_f = -\\alpha_{\\mathrm{HHT}}$ into the generalized-$\\alpha$ residual equation, we obtain:\n$$\n(1-0) a_{n+1} + 0 \\cdot a_n + k \\left( (1 - (-\\alpha_{\\mathrm{HHT}})) u_{n+1} + (-\\alpha_{\\mathrm{HHT}}) u_n \\right) = 0\n$$\n$$\na_{n+1} + k \\left( (1 + \\alpha_{\\mathrm{HHT}}) u_{n+1} - \\alpha_{\\mathrm{HHT}} u_n \\right) = 0\n$$\nThis is the standard form of the HHT-$\\alpha$ method's discrete equation of motion for a linear system with $M=1$. The parameters $\\beta$ and $\\gamma$ for the Newmark updates are given by:\n$$\n\\gamma = \\frac{1}{2} + \\alpha_f - \\alpha_m = \\frac{1}{2} - \\alpha_{\\mathrm{HHT}}\n$$\n$$\n\\beta = \\frac{1}{4}(1 + \\alpha_f - \\alpha_m)^2 = \\frac{1}{4}(1 - \\alpha_{\\mathrm{HHT}})^2\n$$\nThese are the accepted relationships for ensuring second-order accuracy in the HHT-$\\alpha$ method. Since both the discrete equilibrium equation and the kinematic update parameters ($\\beta, \\gamma$) are identical, the generalized-$\\alpha$ method with this mapping is completely equivalent to the HHT-$\\alpha$ method.\n\n**2. WBZ-$\\alpha$ Method Equivalence:**\n\nThe problem states that in the WBZ-$\\alpha$ method, the internal force is not filtered ($\\alpha_f=0$) and the inertia is filtered. The specific mapping to recover WBZ-$\\alpha$ is given as $\\alpha_f=0$ and $\\alpha_m = -\\alpha_{\\mathrm{WBZ}}$. The parameter $\\alpha_{\\mathrm{WBZ}}$ typically lies in $[0, \\frac{1}{3}]$.\n\nBy substituting $\\alpha_f=0$ and $\\alpha_m = -\\alpha_{\\mathrm{WBZ}}$ into the generalized-$\\alpha$ residual equation, we obtain:\n$$\n(1 - (-\\alpha_{\\mathrm{WBZ}})) a_{n+1} + (-\\alpha_{\\mathrm{WBZ}}) a_n + k \\left( (1-0) u_{n+1} + 0 \\cdot u_n \\right) = 0\n$$\n$$\n(1 + \\alpha_{\\mathrm{WBZ}}) a_{n+1} - \\alpha_{\\mathrm{WBZ}} a_n + k u_{n+1} = 0\n$$\nThis is the standard form of the WBZ-$\\alpha$ method's discrete equation of motion. The parameters $\\beta$ and $\\gamma$ are:\n$$\n\\gamma = \\frac{1}{2} + \\alpha_f - \\alpha_m = \\frac{1}{2} + \\alpha_{\\mathrm{WBZ}}\n$$\n$$\n\\beta = \\frac{1}{4}(1 + \\alpha_f - \\alpha_m)^2 = \\frac{1}{4}(1 + \\alpha_{\\mathrm{WBZ}})^2\n$$\nAgain, these are the correct relationships for the WBZ-$\\alpha$ method. The equivalence is established.\n\n### Task 2: Amplification Matrix Computation\nBased on Task 1, comparing the generalized-$\\alpha$ method with a given mapping to the corresponding special case (HHT or WBZ) is a tautology, as they are identical by definition. The numerical check serves as a verification of the implementation. The Frobenius norm of the difference between the amplification matrices should be zero (or within machine precision).\n\nThe algorithm to compute the $2 \\times 2$ amplification matrix $A$ for a linear system is as follows:\n1.  Given parameters $k$, $\\Delta t$, $\\alpha_m$, $\\alpha_f$, calculate the dependent parameters $\\beta = \\frac{1}{4}(1 + \\alpha_f - \\alpha_m)^2$ and $\\gamma = \\frac{1}{2} + \\alpha_f - \\alpha_m$.\n2.  The goal is to find the matrix $A$ such that $\\begin{pmatrix} u_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A \\begin{pmatrix} u_n \\\\ v_n \\end{pmatrix}$. The columns of $A$ can be found by evaluating the result of one time step for the basis vectors of the state space.\n3.  **First Column of A**: Set initial state $(u_n, v_n) = (1, 0)$. The consistent initial acceleration is $a_n = -k u_n = -k$.\n    a. Solve for $a_{n+1}$. The residual equation is linear in $a_{n+1}$: $(1-\\alpha_m)a_{n+1} + \\alpha_m a_n + k( (1-\\alpha_f)u_{n+1} + \\alpha_f u_n)=0$. By substituting $u_{n+1} = u_n + \\Delta t v_n + \\Delta t^2 (\\frac{1}{2}-\\beta)a_n + \\Delta t^2 \\beta a_{n+1}$, we get an algebraic equation that can be solved directly for $a_{n+1}$.\n    $$\n    a_{n+1}[(1-\\alpha_m) + k(1-\\alpha_f)\\Delta t^2\\beta] = -k((1-\\alpha_f)u_n + \\alpha_f u_n) - k(1-\\alpha_f)\\Delta t v_n - (\\alpha_m + k(1-\\alpha_f)\\Delta t^2(\\tfrac{1}{2}-\\beta))a_n\n    $$\n    b. With $a_{n+1}$ known, compute $u_{n+1}$ and $v_{n+1}$ using the Newmark update formulas. This vector $(u_{n+1}, v_{n+1})^T$ is the first column of $A$.\n4.  **Second Column of A**: Set initial state $(u_n, v_n) = (0, 1)$. The consistent initial acceleration is $a_n = -k u_n=0$.\n    a. Repeat the process in step 3 to find the new $a_{n+1}$, $u_{n+1}$, and $v_{n+1}$.\n    b. This vector $(u_{n+1}, v_{n+1})^T$ is the second column of $A$.\n5.  This procedure yields the complete matrix $A$. By constructing two such matrices, $A_{\\text{gen}}$ and $A_{\\text{special}}$, using identical parameters, their difference can be calculated and its Frobenius norm computed.\n\n### Task 3: Nonlinear Experiment Algorithm\n\nFor the nonlinear Duffing oscillator, $f_{\\text{int}}(u) = k u + \\mu u^3$. The residual equation is nonlinear in the unknown displacement $u_{n+1}$:\n$$\nR(u_{n+1}) = a_{n+\\alpha_m}(u_{n+1}) + f_{\\text{int}}(u_{n+\\alpha_f}(u_{n+1})) = 0\n$$\nThis requires an iterative solver. A Newton-Raphson method is employed at each time step.\n\n1.  **Initial Conditions**: At $t_0$, given $u_0$ and $v_0$, the consistent initial acceleration is found from the equilibrium equation at $t_0$: $M a_0 + f_{\\text{int}}(u_0) = 0 \\implies a_0 = -(k u_0 + \\mu u_0^3)$.\n2.  **Newton-Raphson Iteration**: For each time step $n$, to find $u_{n+1}$:\n    a. Start with an initial guess, e.g., $u_{n+1}^{(0)} = u_n$.\n    b. For each iteration $i=0, 1, \\dots$:\n        i.  Express all state variables at time $n+1$ in terms of the current guess $u_{n+1}^{(i)}$ and knowns from time $n$.\n            - $a_{n+1}^{(i)} = \\frac{1}{\\Delta t^2 \\beta} [u_{n+1}^{(i)} - u_n - \\Delta t v_n - \\Delta t^2(\\tfrac{1}{2}-\\beta) a_n]$\n            - $a_{n+\\alpha_m}^{(i)} = (1-\\alpha_m) a_{n+1}^{(i)} + \\alpha_m a_n$\n            - $u_{n+\\alpha_f}^{(i)} = (1-\\alpha_f) u_{n+1}^{(i)} + \\alpha_f u_n$\n        ii. Evaluate the residual:\n            $$\n            R(u_{n+1}^{(i)}) = a_{n+\\alpha_m}^{(i)} + k u_{n+\\alpha_f}^{(i)} + \\mu (u_{n+\\alpha_f}^{(i)})^3\n            $$\n        iii. Evaluate the tangent stiffness $K_T = \\frac{dR}{du_{n+1}}$ at $u_{n+1}^{(i)}$:\n            $$\n            K_T^{(i)} = \\frac{\\partial a_{n+\\alpha_m}}{\\partial u_{n+1}} + \\frac{\\partial f_{\\text{int}}(u_{n+\\alpha_f})}{\\partial u_{n+1}} = \\frac{1-\\alpha_m}{\\Delta t^2 \\beta} + (1-\\alpha_f)f'_{\\text{int}}(u_{n+\\alpha_f}^{(i)})\n            $$\n            where $f'_{\\text{int}}(u) = k + 3\\mu u^2$.\n        iv. Compute the displacement update: $\\Delta u = -R(u_{n+1}^{(i)}) / K_T^{(i)}$.\n        v.  Update the guess: $u_{n+1}^{(i+1)} = u_{n+1}^{(i)} + \\Delta u$.\n        vi. Check for convergence, e.g., $|\\Delta u|$ is smaller than a prescribed tolerance.\n3.  **State Update**: Once $u_{n+1}$ has converged, calculate the final $v_{n+1}$ and $a_{n+1}$ for the step using the kinematic relations.\n4.  **Energy Calculation**: The total mechanical energy $E_n = \\frac{1}{2} v_n^2 + \\frac{1}{2}k u_n^2 + \\frac{1}{4}\\mu u_n^4$ is computed at the start ($E_0$) and end ($E_N$) of the simulation. The energy drift is reported as $E_N - E_0$. This process is repeated for the three specified integration schemes (HHT, WBZ, and mixed).\n\nThis principled design ensures a correct and robust implementation for all tasks specified in the problem.", "answer": "```python\nimport numpy as np\n\ndef get_beta_gamma(alpha_m, alpha_f):\n    \"\"\"Computes beta and gamma from alpha_m and alpha_f for second-order accuracy.\"\"\"\n    gamma = 0.5 + alpha_f - alpha_m\n    beta = 0.25 * (1.0 + alpha_f - alpha_m)**2\n    return beta, gamma\n\ndef compute_amplification_matrix(k, dt, alpha_m, alpha_f):\n    \"\"\"\n    Computes the 2x2 amplification matrix A mapping (u_n, v_n) to (u_{n+1}, v_{n+1})\n    for the linear SDOF system, using the numerical basis method described in the problem.\n    \"\"\"\n    beta, gamma = get_beta_gamma(alpha_m, alpha_f)\n    \n    A = np.zeros((2, 2))\n    \n    # Basis vectors for initial conditions (u_n, v_n)\n    basis_vectors = [\n        (1.0, 0.0),  # Basis 1\n        (0.0, 1.0)   # Basis 2\n    ]\n    \n    for i, (u_n, v_n) in enumerate(basis_vectors):\n        # Consistent initial acceleration for the linear system\n        a_n = -k * u_n\n        \n        # The residual R(a_{n+1}) = 0 is linear in a_{n+1}, allowing direct solution.\n        # Derived from: (1-alpha_m)*a_{n+1} + alpha_m*a_n + k*((1-alpha_f)*u_{n+1} + alpha_f*u_n) = 0\n        # where u_{n+1} = u_n + dt*v_n + dt^2*(0.5-beta)*a_n + dt^2*beta*a_{n+1}.\n        \n        # Denominator for a_{n+1} solution\n        den = (1.0 - alpha_m) + k * (1.0 - alpha_f) * dt**2 * beta\n        \n        # Numerator for a_{n+1} solution\n        num = - (alpha_m * a_n + \n                 k * (1.0 - alpha_f) * (u_n + dt * v_n + dt**2 * (0.5 - beta) * a_n) +\n                 k * alpha_f * u_n)\n                 \n        a_n1 = num / den\n        \n        # Compute u_{n+1} and v_{n+1} using the Newmark updates\n        u_n1 = u_n + dt * v_n + dt**2 * ((0.5 - beta) * a_n + beta * a_n1)\n        v_n1 = v_n + dt * ((1.0 - gamma) * a_n + gamma * a_n1)\n        \n        # Store the resulting vector (u_{n+1}, v_{n+1}) as a column in A\n        A[0, i] = u_n1\n        A[1, i] = v_n1\n        \n    return A\n\ndef run_nonlinear_simulation(k, mu, dt, N, u0, v0, alpha_m, alpha_f):\n    \"\"\"\n    Runs the nonlinear Duffing oscillator simulation for N steps using the generalized-alpha method\n    with a Newton-Raphson corrector.\n    \"\"\"\n    # Newton-Raphson solver parameters\n    tol = 1.0e-12\n    max_iter = 10\n    \n    # Get beta and gamma parameters for the chosen scheme\n    beta, gamma = get_beta_gamma(alpha_m, alpha_f)\n\n    # State variable arrays\n    u = np.zeros(N + 1)\n    v = np.zeros(N + 1)\n    a = np.zeros(N + 1)\n    \n    # Initial conditions\n    u[0] = u0\n    v[0] = v0\n    a[0] = -(k * u[0] + mu * u[0]**3) # Consistent initial acceleration\n    \n    # Energy calculation functions\n    potential_energy = lambda disp: 0.5 * k * disp**2 + 0.25 * mu * disp**4\n    kinetic_energy = lambda vel: 0.5 * vel**2\n    \n    E0 = kinetic_energy(v[0]) + potential_energy(u[0])\n\n    # Time integration loop\n    for n in range(N):\n        u_n, v_n, a_n = u[n], v[n], a[n]\n        \n        # Newton-Raphson to solve for u_{n+1}\n        u_n1_i = u_n  # Initial guess for the NR iteration\n        \n        for _ in range(max_iter):\n            # Calculate quantities based on the current NR guess u_n1_i\n            u_n_alpha_f = (1.0 - alpha_f) * u_n1_i + alpha_f * u_n\n            \n            # Express a_{n+1} in terms of u_{n+1} from the Newmark displacement update\n            a_n1_i = (u_n1_i - u_n - dt * v_n - dt**2 * (0.5 - beta) * a_n) / (dt**2 * beta)\n            a_n_alpha_m = (1.0 - alpha_m) * a_n1_i + alpha_m * a_n\n            \n            # Residual R(u_{n+1}) = a_{n+alpha_m} + f_int(u_{n+alpha_f})\n            f_int = k * u_n_alpha_f + mu * u_n_alpha_f**3\n            residual = a_n_alpha_m + f_int\n            \n            # Tangent stiffness dR/du_{n+1}\n            df_int_du = k + 3.0 * mu * u_n_alpha_f**2\n            tangent = ((1.0 - alpha_m) / (dt**2 * beta)) + (1.0 - alpha_f) * df_int_du\n            \n            # Update displacement\n            du = -residual / tangent\n            u_n1_i += du\n            \n            if abs(du)  tol:\n                break\n        \n        # Store converged state for step n+1\n        u[n+1] = u_n1_i\n        a[n+1] = (u[n+1] - u_n - dt * v_n - dt**2 * (0.5 - beta) * a_n) / (dt**2 * beta)\n        v[n+1] = v_n + dt * ((1.0 - gamma) * a_n + gamma * a[n+1])\n        \n    # Final energy and drift\n    EN = kinetic_energy(v[N]) + potential_energy(u[N])\n    return EN - E0\n\ndef solve():\n    results = []\n\n    # Test Case 1: HHT-alpha mapping check\n    k, dt, mu, alpha_hht = 400.0, 0.01, 0.0, -0.2\n    am_gen, af_gen = 0.0, -alpha_hht\n    am_hht, af_hht = 0.0, -alpha_hht\n    A_gen = compute_amplification_matrix(k, dt, am_gen, af_gen)\n    A_hht = compute_amplification_matrix(k, dt, am_hht, af_hht)\n    norm_diff1 = np.linalg.norm(A_gen - A_hht, 'fro')\n    results.append(norm_diff1)\n\n    # Test Case 2: WBZ-alpha mapping check\n    k, dt, mu, alpha_wbz = 400.0, 0.01, 0.0, 0.2\n    am_gen, af_gen = -alpha_wbz, 0.0\n    am_wbz, af_wbz = -alpha_wbz, 0.0\n    A_gen = compute_amplification_matrix(k, dt, am_gen, af_gen)\n    A_wbz = compute_amplification_matrix(k, dt, am_wbz, af_wbz)\n    norm_diff2 = np.linalg.norm(A_gen - A_wbz, 'fro')\n    results.append(norm_diff2)\n    \n    # Test Case 3: HHT-alpha boundary mapping check\n    k, dt, mu, alpha_hht_b = 400.0, 0.01, 0.0, -1.0/3.0\n    am_gen, af_gen = 0.0, -alpha_hht_b\n    am_hht, af_hht = 0.0, -alpha_hht_b\n    A_gen = compute_amplification_matrix(k, dt, am_gen, af_gen)\n    A_hht = compute_amplification_matrix(k, dt, am_hht, af_hht)\n    norm_diff3 = np.linalg.norm(A_gen - A_hht, 'fro')\n    results.append(norm_diff3)\n\n    # Test Case 4: Nonlinear experiment\n    dt_nl, N, k_nl, mu_nl, u0, v0 = 0.05, 400, 1.0, 1.0, 1.0, 0.0\n    \n    # HHT scheme\n    alpha_hht_nl = -0.2\n    am_hht, af_hht = 0.0, -alpha_hht_nl\n    energy_drift_hht = run_nonlinear_simulation(k_nl, mu_nl, dt_nl, N, u0, v0, am_hht, af_hht)\n    \n    # WBZ scheme\n    alpha_wbz_nl = 0.2\n    am_wbz, af_wbz = -alpha_wbz_nl, 0.0\n    energy_drift_wbz = run_nonlinear_simulation(k_nl, mu_nl, dt_nl, N, u0, v0, am_wbz, af_wbz)\n    \n    # Mixed GA scheme\n    am_mix, af_mix = -0.1, 0.1\n    energy_drift_mixed = run_nonlinear_simulation(k_nl, mu_nl, dt_nl, N, u0, v0, am_mix, af_mix)\n    \n    nonlinear_results = [energy_drift_hht, energy_drift_wbz, energy_drift_mixed]\n    results.append(nonlinear_results)\n\n    # Format the output string to match the required format exactly\n    r1, r2, r3, r4_list = results\n    r4_str = f\"[{','.join(f'{x:.7g}' for x in r4_list)}]\"\n    final_str = f\"[{r1:.7g},{r2:.7g},{r3:.7g},{r4_str}]\"\n    print(final_str)\n\nsolve()\n```", "id": "3568254"}]}