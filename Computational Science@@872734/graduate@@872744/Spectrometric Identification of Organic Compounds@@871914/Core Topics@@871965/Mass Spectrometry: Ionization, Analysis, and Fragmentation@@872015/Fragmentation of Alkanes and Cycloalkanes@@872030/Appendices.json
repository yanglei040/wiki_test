{"hands_on_practices": [{"introduction": "At the heart of high-resolution mass spectrometry (HRMS) is the ability to measure mass-to-charge ratios with extreme precision. This practice solidifies your understanding of how an ion's exact $m/z$ value is derived from the fundamental masses of its constituent isotopes and electrons. Mastering this calculation [@problem_id:3703528] is the first step toward distinguishing between ions of the same nominal mass but different elemental compositions.", "problem": "In Electron Ionization (EI) Mass Spectrometry (MS), the mass-to-charge ratio $m/z$ of an ion is defined as the ratio of its exact mass to its charge state. For hydrocarbon fragment ions derived from alkanes and cycloalkanes, the observed cations are typically carbocations formed via $\\sigma$-bond cleavage and rearrangements, and allylic cations formed via ring opening or side-chain cleavage. Use the following foundational facts to derive and evaluate exact masses:\n- The exact (monoisotopic) atomic mass of carbon-$12$ is $12.000000000$ atomic mass units.\n- The exact (monoisotopic) atomic mass of hydrogen-$1$ is $1.00782503223$ atomic mass units.\n- The mass of the electron is $0.000548579909$ atomic mass units.\n- Atomic masses are for neutral atoms; an ion of charge $+1$ has one fewer electron than its corresponding neutral aggregate of atoms.\n\nStarting from the definitions above, first derive the exact mass expression for a hydrocarbon fragment ion $\\mathrm{C}_n\\mathrm{H}_m^{+}$ as a singly charged cation by accounting explicitly for electron removal. Then, apply your expression to compute the exact $m/z$ values (dimensionless) for the fragment ions $\\mathrm{C}_3\\mathrm{H}_7^{+}$, $\\mathrm{C}_3\\mathrm{H}_5^{+}$, $\\mathrm{C}_4\\mathrm{H}_9^{+}$, and $\\mathrm{C}_4\\mathrm{H}_7^{+}$. Round each reported $m/z$ value to $4$ significant figures. Provide your final numerical results as a single row matrix, in the order listed, and do not include units in the final boxed answer.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It requires a rigorous application of the fundamental definitions of mass and mass-to-charge ratio in mass spectrometry.\n\nThe primary task is to first derive a general expression for the exact mass-to-charge ratio, $m/z$, of a singly charged hydrocarbon ion, $\\mathrm{C}_n\\mathrm{H}_m^{+}$, and subsequently to apply this expression to calculate the specific $m/z$ values for four designated fragment ions.\n\nThe foundational constants provided are:\n- The exact monoisotopic mass of a neutral carbon-$12$ atom: $M(^{12}\\mathrm{C}) = 12.000000000$ u.\n- The exact monoisotopic mass of a neutral hydrogen-$1$ atom: $M(^{1}\\mathrm{H}) = 1.00782503223$ u.\n- The mass of an electron: $m_e = 0.000548579909$ u.\n\nThe mass of an ion is related to the mass of its corresponding neutral species. The provided atomic masses are for neutral atoms, which include their full complement of electrons. A neutral molecular entity with the formula $\\mathrm{C}_n\\mathrm{H}_m$ is composed of $n$ carbon atoms and $m$ hydrogen atoms. Its exact monoisotopic mass, denoted $M(\\mathrm{C}_n\\mathrm{H}_m)_{\\text{neutral}}$, is the sum of the exact masses of its constituent neutral atoms:\n$$M(\\mathrm{C}_n\\mathrm{H}_m)_{\\text{neutral}} = n \\cdot M(^{12}\\mathrm{C}) + m \\cdot M(^{1}\\mathrm{H})$$\nThe problem specifies that the cation $\\mathrm{C}_n\\mathrm{H}_m^{+}$ has a charge of $+1$, which signifies that it has one fewer electron than the neutral species. Therefore, the mass of the cation, $M(\\mathrm{C}_n\\mathrm{H}_m^{+})$, is the mass of the neutral aggregate of atoms minus the mass of one electron, $m_e$:\n$$M(\\mathrm{C}_n\\mathrm{H}_m^{+}) = M(\\mathrm{C}_n\\mathrm{H}_m)_{\\text{neutral}} - m_e$$\nBy substitution, we arrive at the general expression for the exact mass of the ion:\n$$M(\\mathrm{C}_n\\mathrm{H}_m^{+}) = n \\cdot M(^{12}\\mathrm{C}) + m \\cdot M(^{1}\\mathrm{H}) - m_e$$\nThe mass-to-charge ratio, $m/z$, is defined as the ratio of the ion's mass to its charge state number, $z$. For the singly charged cations in this problem, $z=1$. Consequently, the $m/z$ value is numerically identical to the ion's mass expressed in atomic mass units.\n$$m/z = \\frac{M(\\mathrm{C}_n\\mathrm{H}_m^{+})}{z} = \\frac{n \\cdot M(^{12}\\mathrm{C}) + m \\cdot M(^{1}\\mathrm{H}) - m_e}{1}$$\n$$m/z = n \\cdot M(^{12}\\mathrm{C}) + m \\cdot M(^{1}\\mathrm{H}) - m_e$$\nThis is the derived general expression. We now apply this formula to compute the $m/z$ values for the specified ions and round each result to $4$ significant figures.\n\n1.  For the $\\mathrm{C}_3\\mathrm{H}_7^{+}$ cation ($n=3$, $m=7$):\n    $$m/z = 3 \\cdot (12.000000000) + 7 \\cdot (1.00782503223) - 0.000548579909$$\n    $$m/z = 36.000000000 + 7.05477522561 - 0.000548579909$$\n    $$m/z = 43.054226645701$$\n    Rounding to $4$ significant figures, we obtain $43.05$.\n\n2.  For the $\\mathrm{C}_3\\mathrm{H}_5^{+}$ cation ($n=3$, $m=5$):\n    $$m/z = 3 \\cdot (12.000000000) + 5 \\cdot (1.00782503223) - 0.000548579909$$\n    $$m/z = 36.000000000 + 5.03912516115 - 0.000548579909$$\n    $$m/z = 41.038576581241$$\n    Rounding to $4$ significant figures, we obtain $41.04$.\n\n3.  For the $\\mathrm{C}_4\\mathrm{H}_9^{+}$ cation ($n=4$, $m=9$):\n    $$m/z = 4 \\cdot (12.000000000) + 9 \\cdot (1.00782503223) - 0.000548579909$$\n    $$m/z = 48.000000000 + 9.07042529007 - 0.000548579909$$\n    $$m/z = 57.069876710161$$\n    Rounding to $4$ significant figures, we obtain $57.07$.\n\n4.  For the $\\mathrm{C}_4\\mathrm{H}_7^{+}$ cation ($n=4$, $m=7$):\n    $$m/z = 4 \\cdot (12.000000000) + 7 \\cdot (1.00782503223) - 0.000548579909$$\n    $$m/z = 48.000000000 + 7.05477522561 - 0.000548579909$$\n    $$m/z = 55.054226645701$$\n    Rounding to $4$ significant figures, we obtain $55.05$.\n\nThe final numerical results, in the specified order ($\\mathrm{C}_3\\mathrm{H}_7^{+}$, $\\mathrm{C}_3\\mathrm{H}_5^{+}$, $\\mathrm{C}_4\\mathrm{H}_9^{+}$, $\\mathrm{C}_4\\mathrm{H}_7^{+}$), are $43.05$, $41.04$, $57.07$, and $55.05$.", "answer": "$$\\boxed{\\begin{pmatrix} 43.05 & 41.04 & 57.07 & 55.05 \\end{pmatrix}}$$", "id": "3703528"}, {"introduction": "A frequent challenge in interpreting electron ionization (EI) spectra is the case of the 'disappearing' molecular ion, especially for highly branched alkanes. This exercise prompts you to connect molecular structure to fragmentation kinetics, using principles of carbocation stability to explain why certain molecular ions fragment too quickly to be observed [@problem_id:3703589]. By exploring this phenomenon, you will develop a more sophisticated intuition for spectral interpretation and learn how to experimentally manipulate conditions to enhance molecular ion detection.", "problem": "An electron ionization mass spectrometry experiment compares two isomeric alkanes at nominally identical conditions: a linear alkane and a highly branched isomer of the same molecular formula. At an incident electron energy of $70\\,\\mathrm{eV}$ and a conventional electron ionization (EI) source pressure in the high-vacuum regime, the highly branched isomer exhibits a vanishingly small intensity for the radical cation molecular ion $M^{\\bullet+}$, whereas the linear alkane shows a detectable, albeit weak, $M^{\\bullet+}$ peak. Using first-principles reasoning grounded in (i) the definition of electron ionization as one-electron removal from a neutral to form a radical cation, (ii) qualitative valence structure considerations that determine relative bond dissociation energies and carbocation stabilization, and (iii) microcanonical unimolecular dissociation kinetics such as those captured by Rice–Ramsperger–Kassel–Marcus (RRKM) theory, determine which statements correctly rationalize the observation and which practical source modifications are most likely to increase the observed $M^{\\bullet+}$ intensity of highly branched alkanes.\n\nAssumptions and physical bases for your reasoning must be restricted to the following well-tested facts:\n- In electron ionization (EI), a neutral analyte absorbs sufficient energy to eject an electron, forming $M^{\\bullet+}$ with a broad distribution of internal energies determined by the electron energy, the analyte ionization energy, and the partitioning of excess energy.\n- Relative carbocation stabilities follow the empirical order tertiary $>$ secondary $>$ primary, with corresponding trends in the thresholds for C–C bond cleavages that produce stabilized carbocations.\n- In unimolecular dissociation under isolated conditions, the decay rate $k(E)$ of an energized ion at internal energy $E$ increases steeply as the dissociation threshold energy $E_0$ decreases and as the number of accessible transition-state states increases; survival yield of $M^{\\bullet+}$ reflects competition between ion extraction and unimolecular decay.\n- Collisional cooling reduces internal energy prior to dissociation if sufficient collision frequency exists on the timescale of ion formation and extraction.\n\nSelect all statements that are consistent with these principles:\n\nA. Highly branched alkanes typically have higher ionization energies than their linear isomers; therefore, at $70\\,\\mathrm{eV}$ they absorb more internal energy upon ionization, which directly explains the loss of $M^{\\bullet+}$.\n\nB. For highly branched alkanes, many low-threshold C–C cleavages produce tertiary carbocation fragments; the reduced dissociation thresholds $E_0$ increase the microcanonical fragmentation rate $k(E)$ of $M^{\\bullet+}$ at a given internal energy, lowering the survival yield of the molecular ion relative to linear isomers.\n\nC. Reducing the electron energy from $70\\,\\mathrm{eV}$ to approximately $10$–$15\\,\\mathrm{eV}$ and/or increasing source pressure into the collisional regime (for example, into the $\\sim 1$–$100\\,\\mathrm{Pa}$ range in instruments designed for high-pressure EI) enhances $M^{\\bullet+}$ intensity by decreasing initial internal energy and enabling collisional cooling prior to dissociation.\n\nD. Switching from EI to positive-ion chemical ionization with methane at similar source conditions enhances $M^{\\bullet+}$ intensity for alkanes by proton transfer to form $[M+H]^+$, thereby directly reporting the radical cation molecular ion.\n\nE. Employing low-internal-energy ionization variants that produce colder molecular ions, such as field ionization or “cold EI” using a supersonic molecular beam, increases the observed $M^{\\bullet+}$ intensity of highly branched alkanes by suppressing fast unimolecular fragmentation.\n\nChoose all that apply. Provide your reasoning in terms of the stated foundational principles only; do not invoke unstated proprietary instrumental tricks or empirical “rules of thumb” without justification from the fundamentals above.", "solution": "The problem statement is valid. It presents a well-established phenomenon in electron ionization mass spectrometry—the relative instability of the molecular ion of highly branched alkanes compared to their linear isomers—and asks for a rationalization based on a provided set of fundamental principles of physical chemistry and mass spectrometry. The problem is scientifically sound, self-contained, and well-posed.\n\nThe core of the problem lies in understanding the competition between the survival of the molecular ion ($M^{\\bullet+}$) and its unimolecular fragmentation. The survival yield depends on the rate of fragmentation, $k(E)$, which in turn is a strong function of the ion's internal energy, $E$, and the energy threshold for the lowest-energy dissociation channel, $E_0$.\n\nIn electron ionization (EI) at an electron energy of $70\\,\\mathrm{eV}$, a neutral molecule $M$ is ionized to form a radical cation, $M^{\\bullet+}$. The ionization process deposits a range of internal energies into the nascent $M^{\\bullet+}$ population. According to the provided principles, the rate of fragmentation, $k(E)$, increases steeply as the dissociation threshold, $E_0$, decreases. The molecular ion peak is observed for ions that survive the timescale of residence in the ion source (typically microseconds).\n\nA linear alkane possesses only primary and secondary carbon atoms. Its C–C bond cleavages lead to the formation of less stable primary or secondary carbocations. Consequently, the fragmentation pathways have relatively high dissociation thresholds ($E_0$). A significant fraction of the $M^{\\bullet+}$ ions formed will have internal energies below these high thresholds or in an energy range where $k(E)$ is slow enough for the ion to survive and be detected.\n\nA highly branched alkane contains tertiary or quaternary carbon atoms. As stated in the provided principles, the stability of carbocations follows the order tertiary $>$ secondary $>$ primary. The fragmentation of the branched alkane's molecular ion can proceed via C–C bond cleavage that forms a highly stabilized tertiary carbocation. This pathway is energetically very favorable, resulting in a significantly lower dissociation threshold $E_0$ compared to the fragmentation channels available to the linear isomer. Because $k(E)$ increases steeply with decreasing $E_0$, even molecular ions with modest internal energy will fragment extremely rapidly. As a result, very few $M^{\\bullet+}$ ions from a highly branched alkane survive long enough to be detected, leading to a vanishingly small or absent molecular ion peak.\n\nWith this framework, each statement can be evaluated.\n\n**Analysis of Statement A:**\n\"Highly branched alkanes typically have higher ionization energies than their linear isomers; therefore, at $70\\,\\mathrm{eV}$ they absorb more internal energy upon ionization, which directly explains the loss of $M^{\\bullet+}$.\"\nThis statement's premise is factually incorrect. Increased alkyl substitution stabilizes a positive charge, both in a carbocation and a radical cation. Therefore, highly branched alkanes generally have *lower*, not higher, ionization energies than their linear isomers. For example, the ionization energy of n-hexane is $10.18\\,\\mathrm{eV}$, while that of its more branched isomer $2,2$-dimethylbutane is $10.06\\,\\mathrm{eV}$. Furthermore, even if the premise were true, a higher ionization energy would mean less excess energy ($70\\,\\mathrm{eV} - \\text{IE}$) is available to be partitioned into the ion's internal energy, which would argue for *less* fragmentation, not more.\n**Verdict:** Incorrect.\n\n**Analysis of Statement B:**\n\"For highly branched alkanes, many low-threshold C–C cleavages produce tertiary carbocation fragments; the reduced dissociation thresholds $E_0$ increase the microcanonical fragmentation rate $k(E)$ of $M^{\\bullet+}$ at a given internal energy, lowering the survival yield of the molecular ion relative to linear isomers.\"\nThis statement accurately describes the core physical-organic reason for the observation. The presence of branching allows for fragmentation pathways leading to stable tertiary carbocations. This is consistent with principle (ii). The formation of a stable product lowers the fragmentation activation energy, i.e., the dissociation threshold $E_0$. According to principle (iii), a lower $E_0$ leads to a much faster fragmentation rate $k(E)$ for any given internal energy $E$ above the threshold. This rapid fragmentation outcompetes ion extraction from the source, drastically reducing the survival yield of $M^{\\bullet+}$ and thus its observed intensity. This is a direct and correct rationalization of the phenomenon.\n**Verdict:** Correct.\n\n**Analysis of Statement C:**\n\"Reducing the electron energy from $70\\,\\mathrm{eV}$ to approximately $10$–$15\\,\\mathrm{eV}$ and/or increasing source pressure into the collisional regime (for example, into the $\\sim 1$–$100\\,\\mathrm{Pa}$ range in instruments designed for high-pressure EI) enhances $M^{\\bullet+}$ intensity by decreasing initial internal energy and enabling collisional cooling prior to dissociation.\"\nThis statement proposes two valid strategies to increase the molecular ion intensity.\n1.  Reducing the electron energy to a value just above the ionization energy of the alkane (which is typically $\\sim 10\\,\\mathrm{eV}$) significantly reduces the amount of excess energy deposited into the ion upon ionization, as per principle (i). With less internal energy, a much larger fraction of the $M^{\\bullet+}$ population will be formed below the fast fragmentation threshold, increasing survival.\n2.  Increasing the source pressure introduces frequent collisions between the newly formed, energized $M^{\\bullet+}$ ions and neutral background gas molecules. As stated in principle (iv), this leads to collisional cooling, which removes internal energy from the ions. By reducing the internal energy below the fragmentation threshold $E_0$, collisional cooling effectively \"quenches\" the fragmentation process, allowing the molecular ion to survive. Both methods work by reducing the internal energy available for fragmentation.\n**Verdict:** Correct.\n\n**Analysis of Statement D:**\n\"Switching from EI to positive-ion chemical ionization with methane at similar source conditions enhances $M^{\\bullet+}$ intensity for alkanes by proton transfer to form $[M+H]^+$, thereby directly reporting the radical cation molecular ion.\"\nThis statement contains multiple errors. In chemical ionization (CI) with methane, the primary reagent ions are $\\mathrm{CH}_5^+$ and $\\mathrm{C}_2\\mathrm{H}_5^+$. Alkanes are very weak bases and have low proton affinities; thus, proton transfer to an alkane $M$ to form $[M+H]^+$ is not a favorable process. The dominant CI reaction for alkanes is hydride abstraction, which forms an $[M-H]^+$ ion. Furthermore, the statement incorrectly claims that the formation of $[M+H]^+$ (an even-electron ion with mass $M+1$) \"directly report[s] the radical cation molecular ion\" ($M^{\\bullet+}$, an odd-electron ion with mass $M$). These are fundamentally different chemical species.\n**Verdict:** Incorrect.\n\n**Analysis of Statement E:**\n\"Employing low-internal-energy ionization variants that produce colder molecular ions, such as field ionization or “cold EI” using a supersonic molecular beam, increases the observed $M^{\\bullet+}$ intensity of highly branched alkanes by suppressing fast unimolecular fragmentation.\"\nThis statement correctly identifies established \"soft\" ionization techniques. Field ionization (FI) and \"cold EI\" (in which molecules are cooled in a supersonic expansion before ionization) are specifically designed to produce molecular ions with very little internal energy, as noted in principle (i). By creating a population of \"cold\" $M^{\\bullet+}$ ions, these methods ensure that the vast majority of ions are formed with internal energy well below the low fragmentation thresholds ($E_0$) of the branched alkane. As a result, fragmentation is suppressed, and the survival yield of the molecular ion is dramatically increased, consistent with the kinetic arguments of principle (iii).\n**Verdict:** Correct.", "answer": "$$\\boxed{BCE}$$", "id": "3703589"}, {"introduction": "Moving beyond qualitative interpretation, this practice challenges you to build a quantitative model that predicts an alkane's structure from its fragmentation pattern. You will translate core principles—fragmentation combinatorics and cation stability—into a working algorithm to identify an unknown compound from its mass spectrum [@problem_id:3703587]. This exercise exemplifies a powerful approach in modern analytical science, where physical models are used to extract definitive information from complex data.", "problem": "You are given an Electron Ionization (EI) mass spectral fingerprint of a saturated, straight-chain alkane with molecular formula $C_nH_{2n+2}$, acquired under high-energy conditions that favor bond homolysis and charge retention on carbocationic fragments. Empirically, the alkyl cation series corresponding to $m/z$ values $43$, $57$, $71$, and $85$ is prominent in EI spectra of unbranched alkanes, associated with the ions $C_3H_7^+$, $C_4H_9^+$, $C_5H_{11}^+$, and $C_6H_{13}^+$, respectively. The goal is to construct a quantitative, testable model from first principles of fragmentation combinatorics and stability to infer the most probable chain length $n$ from the observed intensities at these $m/z$ values.\n\nStart from the following foundational base:\n- In EI mass spectrometry, a neutral molecule $M$ is ionized to $M^{+\\cdot}$ by electron impact and undergoes unimolecular fragmentation. Fragmentation at a single carbon–carbon bond generates, for a straight-chain alkane, an alkyl carbocation $C_kH_{2k+1}^+$ and a complementary radical $C_{n-k}H_{2(n-k)+1}^\\cdot$.\n- The relative intensity at a given $m/z$ is proportional to the number of distinct ways to form the corresponding fragment under the accessible microcanonical energy, and to the thermodynamic stabilization of the carbocation (e.g., via hyperconjugation). Under the constraint of a linear $C_n$ backbone and single-bond cleavage, the number of distinct contiguous carbon segments of length $k$ inside a chain of length $n$ is $N_k(n) = \\max(n - k + 1, 0)$.\n- The stabilization propensity for $C_kH_{2k+1}^+$ increases with $k$ due to hyperconjugation; approximate this effect by a fixed stability weight $w_k$ that depends only on $k$, with $w_3$, $w_4$, $w_5$, and $w_6$ specified below.\n\nConstruct a parametric model in which the predicted, unscaled intensity for the ion at $m/z$ corresponding to $k \\in \\{3,4,5,6\\}$ is proportional to $N_k(n)\\, w_k$. Because the absolute scaling of the spectrum can vary, assume an unknown nonnegative scalar $s$ that scales the entire predicted vector. Assume additive, independent, identically distributed Gaussian noise on the observed intensities at these four channels with variance that is constant across channels.\n\nYour task is to implement a program that, for each provided test case, computes the integer $n$ in a candidate range that maximizes the Gaussian likelihood (equivalently, minimizes the sum of squared residuals) between the observed intensities and the optimally scaled prediction vector derived from $N_k(n)\\, w_k$. If multiple $n$ values have exactly the same minimized residual, report the smallest such $n$.\n\nUse the following fixed model parameters:\n- Stability weights: $w_3 = 1.00$, $w_4 = 1.25$, $w_5 = 1.55$, $w_6 = 1.75$.\n- Candidate chain length range: $n \\in \\{3,4,\\dots,20\\}$.\n\nFor the mapping between $m/z$ and $k$, use $m/z \\ 43 \\leftrightarrow k=3$, $m/z \\ 57 \\leftrightarrow k=4$, $m/z \\ 71 \\leftrightarrow k=5$, and $m/z \\ 85 \\leftrightarrow k=6$.\n\nDefine the model-predicted, unscaled intensity vector for a given $n$ as\n$$\n\\mathbf{y}(n) = \\big(N_3(n) w_3,\\; N_4(n) w_4,\\; N_5(n) w_5,\\; N_6(n) w_6\\big),\n$$\nwith $N_k(n) = \\max(n-k+1, 0)$.\nGiven an observed intensity vector\n$$\n\\mathbf{x} = \\big(x_{43}, x_{57}, x_{71}, x_{85}\\big),\n$$\nassume the optimal scale $s \\ge 0$ is to be chosen to minimize the squared error $\\|\\mathbf{x} - s\\,\\mathbf{y}(n)\\|_2^2$ for each candidate $n$, and select the $n$ that minimizes this error.\n\nYour program must process the following four test cases, where each observed intensity is to be treated in arbitrary units (dimensionless):\n- Test case $1$: $\\mathbf{x} = [802,\\, 871,\\, 935,\\, 870]$.\n- Test case $2$: $\\mathbf{x} = [305,\\, 248,\\, 152,\\, 0]$.\n- Test case $3$: $\\mathbf{x} = [279,\\, 263,\\, 218,\\, 123]$.\n- Test case $4$: $\\mathbf{x} = [242,\\, 147,\\, 0,\\, 0]$.\n\nYour program should produce a single line of output containing the predicted chain lengths for the four test cases as a comma-separated list enclosed in square brackets, in the order given above (for example, $[n_1,n_2,n_3,n_4]$). Each $n_i$ must be an integer.\n\nDesign for coverage:\n- The first test case represents a longer chain with significant contributions at $m/z\\,85$.\n- The second test case represents a boundary situation where the chain is too short to generate $m/z\\,85$ fragments ($k=6$), so the observed intensity at $85$ is zero.\n- The third test case exercises intermediate chain length with nontrivial contributions at all four channels.\n- The fourth test case represents a short chain with zero intensities at $m/z\\,71$ and $m/z\\,85$, testing correct handling of zero channels.\n\nYour program must be self-contained and not require user input. The final output format must be exactly one single line: a bracketed, comma-separated list of the four inferred integers.", "solution": "The problem is valid. It presents a scientifically grounded, well-posed, and objective task to infer the chain length of an alkane from its mass spectrum. The model is a simplified but physically plausible representation of fragmentation processes in electron ionization mass spectrometry. All parameters and constraints are clearly defined.\n\nThe goal is to determine the most probable integer chain length, $n$, of a straight-chain alkane ($C_nH_{2n+2}$) that corresponds to a given mass spectral fingerprint. The fingerprint consists of observed intensities for four specific fragment ions. The problem is framed as a model-fitting task, where we seek the parameter $n$ from a specified candidate set, $n \\in \\{3, 4, \\dots, 20\\}$, that best explains the data.\n\nThe model is based on two principles: the combinatorics of forming a fragment and the thermodynamic stability of the resulting carbocation. The observed intensity vector is given as $\\mathbf{x} = \\big(x_{43}, x_{57}, x_{71}, x_{85}\\big)$, where each component corresponds to the intensity at a specific mass-to-charge ratio ($m/z$). These $m/z$ values correspond to alkyl cations $C_kH_{2k+1}^+$ for $k \\in \\{3, 4, 5, 6\\}$, respectively.\n\nFor a given chain length $n$, the model predicts an unscaled intensity vector $\\mathbf{y}(n)$. The components of this vector are given by the product of a combinatorial term $N_k(n)$ and a stability weight $w_k$:\n$$\ny_k(n) = N_k(n) \\, w_k\n$$\nwhere $k \\in \\{3, 4, 5, 6\\}$.\nThe term $N_k(n) = \\max(n - k + 1, 0)$ represents the number of ways to cleave a linear chain of $n$ carbons to produce a contiguous fragment of $k$ carbons. The stability weights $w_k$ are provided as fixed parameters: $w_3 = 1.00$, $w_4 = 1.25$, $w_5 = 1.55$, and $w_6 = 1.75$.\n\nThe model-predicted vector for a given $n$ is thus:\n$$\n\\mathbf{y}(n) = \\big(N_3(n) w_3,\\; N_4(n) w_4,\\; N_5(n) w_5,\\; N_6(n) w_6\\big)\n$$\n\nThe relationship between the observed intensities $\\mathbf{x}$ and the model's prediction $\\mathbf{y}(n)$ is described by a scaling relation with additive Gaussian noise: $\\mathbf{x} \\approx s\\,\\mathbf{y}(n)$. Here, $s$ is an unknown, non-negative scaling factor that accounts for variations in absolute signal intensity.\n\nThe task is to find the integer $n$ that maximizes the Gaussian likelihood of observing $\\mathbf{x}$. This is equivalent to minimizing the sum of squared residuals (SSR) between the observed data and the optimally scaled model prediction. The objective function to minimize is the squared Euclidean norm of the residual vector:\n$$\nE(n, s) = \\|\\mathbf{x} - s\\,\\mathbf{y}(n)\\|_2^2\n$$\nThe optimization proceeds in two stages. First, for each candidate $n$, we find the optimal scaling factor $s^*(n)$ that minimizes $E(n, s)$. Second, we find the value of $n$ that results in the minimum possible value of this minimized error.\n\nTo find the optimal scale factor $s^*(n)$ for a fixed $n$, we minimize $E(n, s)$ with respect to $s$. In scalar form, this is $E(n,s) = \\sum_{k \\in \\{3,4,5,6\\}} (x_k - s \\, y_k(n))^2$. We take the derivative with respect to $s$ and set it to zero:\n$$\n\\frac{\\partial E}{\\partial s} = \\sum_k 2(x_k - s \\, y_k(n))(-y_k(n)) = -2 \\left( \\sum_k x_k y_k(n) - s \\sum_k y_k(n)^2 \\right) = 0\n$$\nSolving for $s$ yields the optimal scaling factor:\n$$\ns^*(n) = \\frac{\\sum_k x_k y_k(n)}{\\sum_k y_k(n)^2}\n$$\nIn vector notation, this is the ratio of the dot product of $\\mathbf{x}$ and $\\mathbf{y}(n)$ to the squared norm of $\\mathbf{y}(n)$:\n$$\ns^*(n) = \\frac{\\mathbf{x} \\cdot \\mathbf{y}(n)}{\\|\\mathbf{y}(n)\\|_2^2}\n$$\nThe problem specifies that $s \\geq 0$. Since the observed intensities $x_k$ are non-negative and the model vector components $y_k(n)$ are also non-negative (as $N_k(n) \\ge 0$ and $w_k > 0$), their dot product $\\mathbf{x} \\cdot \\mathbf{y}(n)$ will be non-negative. The denominator $\\|\\mathbf{y}(n)\\|_2^2$ is also non-negative, and is strictly positive for any $n$ in the candidate range $\\{3, \\dots, 20\\}$. Thus, the condition $s^*(n) \\ge 0$ is naturally satisfied.\n\nAfter determining $s^*(n)$, we substitute it back into the error function to find the minimum residual for that specific $n$:\n$$\nR(n) = \\min_{s \\ge 0} E(n, s) = \\|\\mathbf{x} - s^*(n)\\,\\mathbf{y}(n)\\|_2^2\n$$\n\nThe final step is to find the chain length $\\hat{n}$ that minimizes this residual over all possible values of $n$ in the candidate range:\n$$\n\\hat{n} = \\underset{n \\in \\{3, 4, \\dots, 20\\}}{\\arg\\min} \\, R(n)\n$$\nIf multiple values of $n$ yield the same minimum residual, the problem specifies that the smallest such $n$ should be chosen.\n\nThe algorithm to solve the problem for each test case is as follows:\n$1$. Initialize `min_residual` to infinity and `best_n` to a placeholder value.\n$2$. For each integer $n$ from $3$ to $20$:\n    a. Construct the model vector $\\mathbf{y}(n)$ using the formulae for $N_k(n)$ and the given weights $w_k$.\n    b. Calculate the optimal scaling factor $s^*(n) = (\\mathbf{x} \\cdot \\mathbf{y}(n)) / \\|\\mathbf{y}(n)\\|_2^2$.\n    c. Compute the squared residual $R(n) = \\|\\mathbf{x} - s^*(n)\\,\\mathbf{y}(n)\\|_2^2$.\n    d. If $R(n)$ is less than the current `min_residual`, update `min_residual` to $R(n)$ and set `best_n` to $n$.\n$3$. The value of `best_n` after the loop completes is the solution for the given test case.\nThis procedure is repeated for all four provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the most probable alkane chain length n for given mass spectral data.\n    \"\"\"\n\n    # Define the fixed model parameters from the problem statement.\n    # Stability weights for k = 3, 4, 5, 6\n    w_weights = np.array([1.00, 1.25, 1.55, 1.75])\n    # Corresponding k values for the fragments\n    k_values = np.array([3, 4, 5, 6])\n    # Candidate chain length range for n\n    n_range = range(3, 21)\n\n    # Define the test cases from the problem statement.\n    # Each list represents the observed intensities x = [x_43, x_57, x_71, x_85]\n    test_cases = [\n        np.array([802., 871., 935., 870.]),\n        np.array([305., 248., 152., 0.]),\n        np.array([279., 263., 218., 123.]),\n        np.array([242., 147., 0., 0.])\n    ]\n\n    results = []\n    \n    # Process each test case\n    for x_obs in test_cases:\n        best_n = -1\n        min_residual_sq = float('inf')\n\n        # Iterate through all possible chain lengths n in the candidate range\n        for n in n_range:\n            # Step 1: Construct the model-predicted, unscaled intensity vector y(n)\n            # N_k(n) = max(n - k + 1, 0) is the number of ways to form a k-fragment.\n            N_counts = np.maximum(n - k_values + 1, 0)\n            y_model = N_counts * w_weights\n            \n            # Step 2: Calculate the optimal scaling factor s to minimize ||x - s*y||^2\n            # s_opt = (x . y) / (y . y)\n            \n            y_dot_y = np.dot(y_model, y_model)\n            \n            # This check handles the theoretical case where y_model is a zero vector.\n            # For n >= 3, y_model will never be all zeros, so y_dot_y > 0.\n            if y_dot_y == 0:\n                # If y_model is zero, the best s*y is also zero.\n                # The residual is then just the magnitude of x_obs.\n                residual_sq = np.dot(x_obs, x_obs)\n            else:\n                x_dot_y = np.dot(x_obs, y_model)\n                s_opt = x_dot_y / y_dot_y\n                \n                # Step 3: Calculate the minimized squared residual for this n\n                # R(n) = ||x_obs - s_opt * y_model||^2\n                residual_vector = x_obs - s_opt * y_model\n                residual_sq = np.dot(residual_vector, residual_vector)\n\n            # Step 4: Update the best n if a smaller residual is found.\n            # The strict inequality handles the tie-breaking rule: the first n\n            # that achieves the minimum residual is kept, which is the smallest n.\n            if residual_sq < min_residual_sq:\n                min_residual_sq = residual_sq\n                best_n = n\n\n        results.append(best_n)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3703587"}]}