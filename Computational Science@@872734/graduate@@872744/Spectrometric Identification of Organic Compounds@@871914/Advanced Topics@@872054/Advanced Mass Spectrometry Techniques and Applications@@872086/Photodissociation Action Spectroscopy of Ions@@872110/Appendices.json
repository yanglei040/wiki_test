{"hands_on_practices": [{"introduction": "A cornerstone of quantitative spectroscopy is the ability to connect macroscopic experimental observables to fundamental microscopic properties. This first exercise provides practice in this essential skill by tasking you to determine an ion's absolute absorption cross-section, $\\sigma$, from a set of realistic experimental parameters. You will start with raw data—such as laser pulse energy, fragment ion counts, and detection efficiencies—and work backwards to find $\\sigma$. This problem specifically challenges you to move beyond simplistic assumptions by requiring an exact treatment of the spatial overlap between a Gaussian laser beam and a finite, uniformly distributed ion cloud, a scenario commonly encountered in ion trap experiments [@problem_id:3718304].", "problem": "An isolated, mass-selected organic cation is confined in a radiofrequency ion trap and irradiated with a single nanosecond pulse from a Light Amplification by Stimulated Emission of Radiation (LASER) at wavelength $\\lambda = 532~\\mathrm{nm}$. The pulse energy is $E_{p} = 0.35~\\mathrm{mJ}$. The transverse fluence profile of the pulse is well approximated by a cylindrically symmetric Gaussian with $1/e^{2}$ radius $w = 0.50~\\mathrm{mm}$. The ion cloud is centered on the beam axis and is uniformly distributed in a disk of radius $R = 0.25~\\mathrm{mm}$. Prior to irradiation, the number of parent ions is $N_{0} = 2.00 \\times 10^{5}$. After the pulse, the number of detected fragment ions in a diagnostic channel is $N_{\\mathrm{frag}} = 3.60 \\times 10^{4}$. The fragment detection efficiency is $\\eta = 0.85$ and the unimolecular dissociation branching fraction into the monitored fragment channel is $\\beta = 0.80$. Assume single-photon absorption followed by prompt unimolecular dissociation when that fragment channel is accessed, negligible excited-state relaxation on the pulse timescale, no reabsorption or shielding within the ion cloud, and that multiple absorption events per ion during the pulse are negligible beyond what is contained in the Beer–Lambert exponential for a single pulse.\n\nStarting from the Beer–Lambert law and the definition of photodissociation action yield, derive and compute the single-photon absorption cross section $\\sigma$ of the cation at $\\lambda = 532~\\mathrm{nm}$. Treat the spatial variation of photon fluence across the ion disk exactly under the given Gaussian beam and uniform ion density assumptions. Use the exact expression for the average single-pulse absorption probability over the disk implied by these assumptions and fundamental definitions. Physical constants to be used are Planck’s constant $h = 6.62607015 \\times 10^{-34}~\\mathrm{J\\,s}$ and the speed of light $c = 2.99792458 \\times 10^{8}~\\mathrm{m\\,s^{-1}}$.\n\nExpress your final result for $\\sigma$ in $\\mathrm{cm}^{2}$ and round your answer to four significant figures.", "solution": "The user wants me to solve a problem in the field of spectrometric identification of organic compounds, specifically focusing on photodissociation action spectroscopy. I will first validate the problem statement and then, if it is valid, provide a detailed solution.\n\n### Step 1: Extract Givens\n-   Source: Light Amplification by Stimulated Emission of Radiation (LASER) pulse\n-   Wavelength: $\\lambda = 532~\\mathrm{nm}$\n-   Pulse energy: $E_{p} = 0.35~\\mathrm{mJ}$\n-   Pulse profile: Cylindrically symmetric Gaussian\n-   $1/e^2$ radius: $w = 0.50~\\mathrm{mm}$\n-   Ion cloud distribution: Uniform disk\n-   Ion cloud radius: $R = 0.25~\\mathrm{mm}$\n-   Initial number of parent ions: $N_{0} = 2.00 \\times 10^{5}$\n-   Number of detected fragment ions: $N_{\\mathrm{frag}} = 3.60 \\times 10^{4}$\n-   Fragment detection efficiency: $\\eta = 0.85$\n-   Unimolecular dissociation branching fraction: $\\beta = 0.80$\n-   Assumptions: Single-photon absorption, prompt unimolecular dissociation, negligible excited-state relaxation, no reabsorption/shielding, multiple absorptions handled by the Beer–Lambert exponential form.\n-   Required constants: Planck’s constant $h = 6.62607015 \\times 10^{-34}~\\mathrm{J\\,s}$, speed of light $c = 2.99792458 \\times 10^{8}~\\mathrm{m\\,s^{-1}}$.\n-   Objective: Compute the single-photon absorption cross section $\\sigma$ in $\\mathrm{cm}^2$, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem describes a standard photodissociation experiment in an ion trap, a common technique in mass spectrometry and physical chemistry. The concepts of Gaussian beams, photon fluence, absorption cross section, and the Beer-Lambert law are fundamental principles in physics and chemistry. The setup is scientifically realistic.\n-   **Well-Posed:** All necessary parameters ($E_{p}$, $\\lambda$, $w$, $R$, $N_{0}$, $N_{\\mathrm{frag}}$, $\\eta$, $\\beta$) are provided to establish a quantitative relationship that can be solved for the unknown cross section $\\sigma$. The problem requires an exact treatment of spatial averaging, leading to a uniquely defined integral.\n-   **Objective:** The problem is stated using precise, quantitative, and unbiased language.\n\nThe problem requires the solution of a transcendental equation. While this is mathematically advanced, it does not render the problem invalid. The use of a series expansion to approximate the solution is a standard and rigorous mathematical technique appropriate for such a problem. Therefore, the problem is deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution will be provided.\n\n### Solution Derivation\n\nThe goal is to determine the single-photon absorption cross section, $\\sigma$. This quantity relates the probability of an ion absorbing a photon to the local photon fluence.\n\nFirst, we relate the number of detected fragment ions, $N_{\\mathrm{frag}}$, to the total number of parent ions that underwent photoabsorption, $N_{\\mathrm{abs}}$. The number of fragment ions produced in the monitored channel is the number detected divided by the detection efficiency, $N_{\\mathrm{frag}}/\\eta$. This number is a fraction $\\beta$ of the total number of ions that dissociated. Dissociation is assumed to be the sole outcome of photon absorption. Thus, the total number of absorbed ions is:\n$$\nN_{\\mathrm{abs}} = \\frac{N_{\\mathrm{frag}}}{\\eta \\beta}\n$$\nPlugging in the given values:\n$$\nN_{\\mathrm{abs}} = \\frac{3.60 \\times 10^{4}}{0.85 \\times 0.80} = \\frac{3.60 \\times 10^{4}}{0.68} \\approx 52941.176\n$$\nThe average probability of absorption over the entire ion cloud is the ratio of absorbed ions to the initial number of ions:\n$$\n\\langle P_{\\mathrm{abs}} \\rangle = \\frac{N_{\\mathrm{abs}}}{N_{0}} = \\frac{52941.176...}{2.00 \\times 10^{5}} \\approx 0.264706\n$$\nThe probability of absorption for a single ion at a given position is dependent on the local photon fluence $\\Phi(r)$. The problem states this relationship follows the Beer-Lambert law, which for a single particle in a beam of photons gives the absorption probability as:\n$$\nP_{\\mathrm{abs}}(r) = 1 - \\exp(-\\sigma \\Phi(r))\n$$\nThe photon fluence $\\Phi(r)$ is the number of photons per unit area. It is derived from the energy fluence $F(r)$, which has a Gaussian profile:\n$$\nF(r) = F_{0} \\exp\\left(-\\frac{2r^2}{w^2}\\right)\n$$\nwhere $F_{0}$ is the peak energy fluence at the center of the beam ($r=0$) and $w$ is the $1/e^2$ radius. The total pulse energy $E_{p}$ is the integral of the fluence over the entire beam area:\n$$\nE_{p} = \\int_0^{2\\pi} \\int_0^{\\infty} F(r) r \\, dr \\, d\\theta = 2\\pi F_{0} \\int_0^{\\infty} r \\exp\\left(-\\frac{2r^2}{w^2}\\right) dr = 2\\pi F_{0} \\left(\\frac{w^2}{4}\\right) = \\frac{\\pi w^2}{2} F_{0}\n$$\nFrom this, the peak energy fluence is $F_{0} = \\frac{2E_{p}}{\\pi w^2}$. The energy of a single photon is $E_{\\mathrm{photon}} = \\frac{hc}{\\lambda}$. The photon fluence is $\\Phi(r) = F(r)/E_{\\mathrm{photon}}$, so the peak photon fluence is:\n$$\n\\Phi_{0} = \\frac{F_{0}}{E_{\\mathrm{photon}}} = \\frac{2 E_{p} \\lambda}{\\pi w^2 hc}\n$$\nThe photon fluence profile is $\\Phi(r) = \\Phi_{0} \\exp(-2r^2/w^2)$. Let's calculate the value of $\\Phi_{0}$:\n$E_{p} = 0.35 \\times 10^{-3}~\\mathrm{J}$\n$\\lambda = 532 \\times 10^{-9}~\\mathrm{m}$\n$w = 0.50 \\times 10^{-3}~\\mathrm{m}$\n$h = 6.62607015 \\times 10^{-34}~\\mathrm{J\\,s}$\n$c = 2.99792458 \\times 10^{8}~\\mathrm{m\\,s^{-1}}$\n$$\n\\Phi_{0} = \\frac{2 (0.35 \\times 10^{-3}) (532 \\times 10^{-9})}{\\pi (0.50 \\times 10^{-3})^2 (6.62607015 \\times 10^{-34}) (2.99792458 \\times 10^{8})} \\approx 2.3873 \\times 10^{21}~\\mathrm{m^{-2}}\n$$\nThe total number of absorbed ions is found by integrating the absorption probability over the area of the ion disk, weighted by the ion area density, $n_A(r)$. The ions are uniformly distributed in a disk of radius $R$, so $n_A = N_0 / (\\pi R^2)$ for $r \\le R$. The average probability is:\n$$\n\\langle P_{\\mathrm{abs}} \\rangle = \\frac{1}{\\pi R^2} \\int_0^{2\\pi} \\int_0^R P_{\\mathrm{abs}}(r) \\, r \\, dr \\, d\\theta = \\frac{2}{R^2} \\int_0^R \\left(1 - \\exp(-\\sigma \\Phi_0 e^{-2r^2/w^2})\\right) r \\, dr\n$$\nThis integral does not have a simple closed-form solution. We solve it by expanding the exponential term in a power series, $1 - e^{-z} = \\sum_{k=1}^{\\infty} \\frac{(-1)^{k-1} z^k}{k!}$, and integrating term-by-term. Let $C = \\sigma \\Phi_{0}$.\n$$\n\\langle P_{\\mathrm{abs}} \\rangle = \\frac{2}{R^2} \\int_0^R \\left( \\sum_{k=1}^{\\infty} \\frac{(-1)^{k-1}}{k!} (C e^{-2r^2/w^2})^k \\right) r \\, dr = \\frac{2}{R^2} \\sum_{k=1}^{\\infty} \\frac{(-1)^{k-1} C^k}{k!} \\int_0^R r e^{-2kr^2/w^2} \\, dr\n$$\nThe integral part evaluates to: $\\int_0^R r e^{-2kr^2/w^2} \\, dr = \\left[ -\\frac{w^2}{4k} e^{-2kr^2/w^2} \\right]_0^R = \\frac{w^2}{4k} (1 - e^{-2kR^2/w^2})$.\nSubstituting this back gives the exact series solution. Letting $U = 2R^2/w^2$:\n$$\n\\langle P_{\\mathrm{abs}} \\rangle = \\frac{2}{R^2} \\sum_{k=1}^{\\infty} \\frac{(-1)^{k-1} C^k}{k!} \\frac{w^2}{4k} (1 - e^{-kU}) = \\frac{w^2}{2R^2} \\sum_{k=1}^{\\infty} \\frac{(-1)^{k-1} C^k}{k \\cdot k!} (1 - e^{-kU}) = \\frac{1}{U} \\sum_{k=1}^{\\infty} \\frac{(-1)^{k-1} C^k}{k \\cdot k!} (1 - e^{-kU})\n$$\nTo solve for $C$, we truncate this series. Using the first two terms ($k=1, 2$):\n$$\n\\langle P_{\\mathrm{abs}} \\rangle \\approx \\frac{1}{U} \\left[ \\frac{C}{1} (1-e^{-U}) - \\frac{C^2}{4} (1-e^{-2U}) \\right]\n$$\nWe have $U = 2(0.25)^2 / (0.50)^2 = 0.5$ and $\\langle P_{\\mathrm{abs}} \\rangle \\approx 0.264706$.\n$$\n0.264706 \\approx \\frac{1}{0.5} \\left[ C(1-e^{-0.5}) - \\frac{C^2}{4} (1-e^{-1}) \\right]\n$$\n$$\n0.132353 \\approx C(1-0.606531) - \\frac{C^2}{4}(1-0.367879)\n$$\n$$\n0.132353 \\approx 0.393469 C - 0.158030 C^2\n$$\nThis gives the quadratic equation:\n$$\n0.158030 C^2 - 0.393469 C + 0.132353 = 0\n$$\nSolving this quadratic equation yields two roots: $C \\approx 2.089$ and $C \\approx 0.4006$. The linear approximation (first term only) gives $C \\approx 0.132353/0.393469 \\approx 0.3364$, indicating that the smaller root is the physically correct one. We take $C = 0.4006$.\nNow we can finally calculate $\\sigma$:\n$$\n\\sigma = \\frac{C}{\\Phi_0} = \\frac{0.4006}{2.3873 \\times 10^{21}~\\mathrm{m^{-2}}} \\approx 1.6779 \\times 10^{-22}~\\mathrm{m^2}\n$$\nThe problem asks for the result in $\\mathrm{cm}^2$. Since $1~\\mathrm{m^2} = 10^4~\\mathrm{cm^2}$:\n$$\n\\sigma \\approx 1.6779 \\times 10^{-22} \\times 10^4~\\mathrm{cm^2} = 1.6779 \\times 10^{-18}~\\mathrm{cm^2}\n$$\nRounding to four significant figures, we get:\n$$\n\\sigma = 1.678 \\times 10^{-18}~\\mathrm{cm^2}\n$$", "answer": "$$\n\\boxed{1.678 \\times 10^{-18}}\n$$", "id": "3718304"}, {"introduction": "While direct determination of cross-sections is fundamental, absolute measurements of quantities like photon fluence can be experimentally challenging and prone to error. A more robust and common approach in modern research is to use a ratiometric method with a well-characterized reference standard. This practice problem guides you through the principles of such a calibration experiment, where an unknown analyte is measured relative to a known reference species co-trapped in the same environment. To solve it, you will model the photon absorption as a Poisson statistical process, allowing you to derive a powerful relationship between the observable parent ion survival fraction, $S$, and the product of the absorption cross-section, $\\sigma$, and dissociation quantum yield, $\\varphi$. By applying this relationship to both the analyte and the reference, you can precisely determine the analyte's cross-section without needing to know the absolute laser fluence [@problem_id:3718322].", "problem": "In a Photodissociation Action Spectroscopy (PDAS) experiment on mass-selected organic ions conducted in a quadrupole ion trap, a reference cation, denoted by species $\\mathrm{R}$, and an analyte cation, denoted by species $\\mathrm{A}$, are co-trapped and exposed simultaneously to the same train of identical laser pulses at photon energy corresponding to a fixed wavelength. The exposure conditions ensure that the ions experience the same effective photon fluence, denoted $\\Phi_{\\mathrm{eff}}$, integrated over the entire pulse train. The temporal spacing between pulses is long compared to vibrational cooling times, so that absorption events across pulses are independent. Parent ion depletion is quantified by the parent survival fraction, defined as the ratio of the parent ion signal with the laser on to that with the laser off for a fixed trapping time, denoted $S \\equiv I_{\\text{parent,on}}/I_{\\text{parent,off}}$. Fragment detection efficiencies are not required because only parent survival fractions are used.\n\nBy independent measurements at the excitation wavelength, the reference species $\\mathrm{R}$ is known to have a one-photon absorption cross-section $\\sigma_{\\mathrm{R}}$ and a dissociation quantum yield $\\varphi_{\\mathrm{R}}$ within the detection timescale. The analyte $\\mathrm{A}$ has a dissociation quantum yield $\\varphi_{\\mathrm{A}}$ measured independently under the same conditions, but its absorption cross-section $\\sigma_{\\mathrm{A}}$ is unknown. The following values are obtained at the same photon energy:\n- Reference absorption cross-section: $\\sigma_{\\mathrm{R}} = 1.35 \\times 10^{-17}\\ \\text{cm}^{2}$.\n- Reference dissociation quantum yield: $\\varphi_{\\mathrm{R}} = 0.80$.\n- Reference parent survival fraction: $S_{\\mathrm{R}} = 0.55$.\n- Analyte dissociation quantum yield: $\\varphi_{\\mathrm{A}} = 0.65$.\n- Analyte parent survival fraction: $S_{\\mathrm{A}} = 0.72$.\n\nStarting from first principles of photon absorption as a Poisson process and the definition of a quantum yield, determine the absolute one-photon absorption cross-section $\\sigma_{\\mathrm{A}}$ of the analyte. Express your final answer in $\\text{cm}^{2}$ and round your answer to three significant figures.", "solution": "The problem asks for the determination of the absolute one-photon absorption cross-section of an analyte cation, $\\sigma_{\\mathrm{A}}$, using a reference cation, $\\sigma_{\\mathrm{R}}$, in a photodissociation action spectroscopy (PDAS) experiment. The solution requires starting from the first principles of photon absorption as a Poisson process.\n\nFirst, we model the absorption of photons by a single ion. The problem states that ions are exposed to a train of laser pulses and that absorption events are independent. Under these conditions, the number of photons, $k$, absorbed by a single ion over the exposure time follows a Poisson distribution:\n$$P(k) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$$\nHere, $\\lambda$ is the mean number of photons absorbed by the ion. This mean is directly proportional to the ion's absorption cross-section, $\\sigma$, and the effective photon fluence, $\\Phi_{\\mathrm{eff}}$ (in photons per unit area), to which the ion is exposed. The relationship is:\n$$\\lambda = \\sigma \\Phi_{\\mathrm{eff}}$$\n\nNext, we model the dissociation process. The dissociation quantum yield, $\\varphi$, is the probability that an ion dissociates upon the absorption of a single photon. Consequently, the probability that an ion *survives* the absorption of a single photon is $(1-\\varphi)$. The problem specifies that the time between laser pulses is long enough for vibrational cooling, so each photon absorption can be treated as an independent event. If an ion absorbs $k$ photons, its probability of surviving all $k$ independent events is $(1-\\varphi)^k$.\n\nThe overall probability of an ion surviving the entire laser exposure, which is the parent survival fraction $S$, is the sum of the probabilities of surviving for each possible number of absorbed photons, $k$. We must sum over all possible values of $k$ from $0$ to $\\infty$, weighted by the Poisson probability of absorbing $k$ photons:\n$$S = \\sum_{k=0}^{\\infty} P(k) \\times (\\text{survival probability for } k \\text{ absorptions})$$\n$$S = \\sum_{k=0}^{\\infty} \\left(\\frac{\\lambda^k e^{-\\lambda}}{k!}\\right) (1-\\varphi)^k$$\nWe can rearrange this expression by factoring out the $e^{-\\lambda}$ term:\n$$S = e^{-\\lambda} \\sum_{k=0}^{\\infty} \\frac{(\\lambda(1-\\varphi))^k}{k!}$$\nThe summation is the Taylor series expansion for the exponential function $\\exp(x) = \\sum_{k=0}^{\\infty} \\frac{x^k}{k!}$, with $x = \\lambda(1-\\varphi)$. Therefore, the expression simplifies to:\n$$S = e^{-\\lambda} \\exp(\\lambda(1-\\varphi)) = \\exp(-\\lambda + \\lambda(1-\\varphi)) = \\exp(-\\lambda + \\lambda - \\lambda\\varphi) = \\exp(-\\lambda\\varphi)$$\nThis equation, $S = \\exp(-\\lambda\\varphi)$, provides the fundamental relationship between the observable survival fraction $S$, the dissociation quantum yield $\\varphi$, and the mean number of absorbed photons $\\lambda$.\n\nWe can now express $\\lambda$ in terms of the experimental observables. Taking the natural logarithm of both sides:\n$$\\ln(S) = -\\lambda\\varphi$$\nSolving for $\\lambda$ gives:\n$$\\lambda = -\\frac{\\ln(S)}{\\varphi}$$\nSubstituting $\\lambda = \\sigma \\Phi_{\\mathrm{eff}}$, we have:\n$$\\sigma \\Phi_{\\mathrm{eff}} = -\\frac{\\ln(S)}{\\varphi}$$\nThis equation holds for both the reference species, $\\mathrm{R}$, and the analyte species, $\\mathrm{A}$. For the reference species:\n$$\\sigma_{\\mathrm{R}} \\Phi_{\\mathrm{eff}} = -\\frac{\\ln(S_{\\mathrm{R}})}{\\varphi_{\\mathrm{R}}}$$\nAnd for the analyte species:\n$$\\sigma_{\\mathrm{A}} \\Phi_{\\mathrm{eff}} = -\\frac{\\ln(S_{\\mathrm{A}})}{\\varphi_{\\mathrm{A}}}$$\nThe problem states that both species are co-trapped and exposed to the same laser pulses, experiencing the same effective photon fluence $\\Phi_{\\mathrm{eff}}$. This allows us to eliminate $\\Phi_{\\mathrm{eff}}$ by taking the ratio of the two equations:\n$$\\frac{\\sigma_{\\mathrm{A}} \\Phi_{\\mathrm{eff}}}{\\sigma_{\\mathrm{R}} \\Phi_{\\mathrm{eff}}} = \\frac{- \\ln(S_{\\mathrm{A}})/\\varphi_{\\mathrm{A}}}{- \\ln(S_{\\mathrm{R}})/\\varphi_{\\mathrm{R}}}$$\n$$\\frac{\\sigma_{\\mathrm{A}}}{\\sigma_{\\mathrm{R}}} = \\frac{\\ln(S_{\\mathrm{A}})}{\\ln(S_{\\mathrm{R}})} \\frac{\\varphi_{\\mathrm{R}}}{\\varphi_{\\mathrm{A}}}$$\nFinally, we can solve for the unknown analyte absorption cross-section, $\\sigma_{\\mathrm{A}}$:\n$$\\sigma_{\\mathrm{A}} = \\sigma_{\\mathrm{R}} \\frac{\\varphi_{\\mathrm{R}}}{\\varphi_{\\mathrm{A}}} \\frac{\\ln(S_{\\mathrm{A}})}{\\ln(S_{\\mathrm{R}})}$$\nNow, we substitute the given values into this expression:\n- $\\sigma_{\\mathrm{R}} = 1.35 \\times 10^{-17}\\ \\text{cm}^{2}$\n- $\\varphi_{\\mathrm{R}} = 0.80$\n- $S_{\\mathrm{R}} = 0.55$\n- $\\varphi_{\\mathrm{A}} = 0.65$\n- $S_{\\mathrm{A}} = 0.72$\n\n$$\\sigma_{\\mathrm{A}} = (1.35 \\times 10^{-17}\\ \\text{cm}^2) \\times \\frac{0.80}{0.65} \\times \\frac{\\ln(0.72)}{\\ln(0.55)}$$\nFirst, we calculate the values of the natural logarithms and the ratio of quantum yields:\n$$\\ln(0.72) \\approx -0.328504$$\n$$\\ln(0.55) \\approx -0.597837$$\n$$\\frac{0.80}{0.65} \\approx 1.230769$$\nSubstituting these into the equation for $\\sigma_{\\mathrm{A}}$:\n$$\\sigma_{\\mathrm{A}} \\approx (1.35 \\times 10^{-17}\\ \\text{cm}^2) \\times (1.230769) \\times \\frac{-0.328504}{-0.597837}$$\n$$\\sigma_{\\mathrm{A}} \\approx (1.35 \\times 10^{-17}\\ \\text{cm}^2) \\times (1.230769) \\times (0.549530)$$\n$$\\sigma_{\\mathrm{A}} \\approx (1.35 \\times 10^{-17}\\ \\text{cm}^2) \\times (0.676254)$$\n$$\\sigma_{\\mathrm{A}} \\approx 9.1294 \\times 10^{-18}\\ \\text{cm}^2$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\\sigma_{\\mathrm{A}} = 9.13 \\times 10^{-18}\\ \\text{cm}^2$$", "answer": "$$\\boxed{9.13 \\times 10^{-18}}$$", "id": "3718322"}, {"introduction": "This final practice elevates the analysis from single-point calculations to the comprehensive modeling of an entire spectroscopic dataset, a task central to modern chemical physics. Here, you will tackle the challenge of determining a molecule's dissociation threshold energy, $E_0$, from an action spectrum. A key insight is that the observed \"turn-on\" of the dissociation signal is not a sharp step function at $E_0$, but is broadened by both the thermal internal energy distribution of the ion population and the finite bandwidth of the laser source. This exercise requires you to implement a computational model that convolves these two distributions to accurately reproduce the experimental yield curve, and then use a numerical optimization algorithm to fit your model to synthetic data, thereby extracting a precise estimate of the threshold energy [@problem_id:3718313]. This practice provides hands-on experience with the data analysis techniques that bridge theoretical models and experimental results.", "problem": "You are to implement a complete, runnable program that models and analyzes photodissociation action spectroscopy measurements of gas-phase organic ions. The objective is to estimate the dissociation threshold energy from synthetic action yield data generated under scientifically realistic assumptions.\n\nFundamental base and modeling assumptions to be used:\n- Energy conservation: an ion dissociates when $E_{\\text{ph}} + E_{\\text{int}} \\ge E_0$, where $E_{\\text{ph}}$ is the photon energy, $E_{\\text{int}}$ is the internal energy of the ion, and $E_0$ is the dissociation threshold energy.\n- Photon energy distribution: the laser emits photons with an energy distribution modeled as a Gaussian with mean $h\\nu$ and standard deviation $\\sigma$. The tail probability that a photon energy exceeds a value $x$ is\n$$\nP(E_{\\text{ph}} \\ge x) = \\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{x - h\\nu}{\\sqrt{2}\\,\\sigma}\\right),\n$$\nwhere $\\operatorname{erfc}(\\cdot)$ denotes the complementary error function.\n- Internal energy distribution: the internal energy of ions is modeled by a Gamma distribution with a shape parameter $s$ (representing the effective number of vibrational degrees of freedom contributing significant energy) and scale parameter $\\beta = k_{\\mathrm{B}} T$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the temperature. The probability density is\n$$\np_T(E_{\\text{int}}) = \\frac{E_{\\text{int}}^{s-1} \\exp(-E_{\\text{int}}/\\beta)}{\\Gamma(s)\\,\\beta^s}, \\quad E_{\\text{int}} \\ge 0.\n$$\n- Photodissociation action yield: for a given $h\\nu$, the observable single-photon dissociation probability (action yield) is the probability that the combined photon and internal energy exceeds $E_0$, averaged over both distributions:\n$$\nY(h\\nu; E_0) = \\int_{0}^{\\infty} p_T(E_{\\text{int}})\\,\\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{E_0 - E_{\\text{int}} - h\\nu}{\\sqrt{2}\\,\\sigma}\\right)\\,dE_{\\text{int}}.\n$$\n\nYour program must:\n1. Use $k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5}$ electronvolts per Kelvin ($\\text{eV/K}$).\n2. For each test case in the test suite below, generate synthetic action yield data by evaluating $Y(h\\nu; E_0)$ on a specified grid of $h\\nu$ values and adding small zero-mean Gaussian measurement noise with standard deviation $1.0\\times 10^{-2}$. Clamp the noisy yields to $[0,1]$ to maintain physical realism.\n3. Estimate the threshold energy $E_0$ by minimizing the sum of squared residuals between the synthetic yield data and the model $Y(h\\nu; E_0)$ over $E_0 \\in [0.5, 6.0]$ electronvolts. This requires a numerical implementation that treats the integral definition of $Y(h\\nu; E_0)$ without relying on any closed-form shortcut. You must design your own numerical quadrature for the integral over $E_{\\text{int}}$ and a bounded scalar minimization procedure that does not require external user input.\n4. Produce a single line of output containing a comma-separated list of the estimated thresholds for all test cases, rounded to three decimal places, enclosed in square brackets. All threshold energies must be expressed in electronvolts (eV).\n\nNumerical implementation requirements:\n- The integral over $E_{\\text{int}}$ in $Y(h\\nu; E_0)$ must be computed via explicit numerical quadrature over a finite grid $E_{\\text{int}} \\in [0, E_{\\max}]$, where $E_{\\max}$ is chosen large enough for the Gamma distribution tail to be negligible relative to the specified temperatures and shape parameters. Use a uniform grid and Riemann sum or composite trapezoidal rule; document your choice in the solution.\n- The minimization over $E_0$ must be carried out by a bounded, derivative-free method that you implement (e.g., golden-section search), ensuring convergence to a minimum within the specified interval.\n- All photon energies $h\\nu$, threshold energies $E_0$, and bandwidths $\\sigma$ must be treated in electronvolts (eV). Temperatures $T$ are in Kelvin (K). The final estimates must be reported in electronvolts (eV).\n\nTest suite:\nUse the following four scientifically plausible cases that probe different regimes.\n- Case 1 (typical laboratory conditions):\n  - $E_0 = 3.50$ eV, $T = 300$ K, $s = 3$, $\\sigma = 0.05$ eV,\n  - $h\\nu$ grid: $51$ equally spaced values from $2.5$ eV to $5.0$ eV inclusive.\n- Case 2 (cold ions, sharp threshold):\n  - $E_0 = 2.20$ eV, $T = 30$ K, $s = 3$, $\\sigma = 0.005$ eV,\n  - $h\\nu$ grid: $51$ equally spaced values from $1.5$ eV to $3.0$ eV inclusive.\n- Case 3 (broad laser bandwidth, smeared onset):\n  - $E_0 = 4.10$ eV, $T = 300$ K, $s = 5$, $\\sigma = 0.20$ eV,\n  - $h\\nu$ grid: $51$ equally spaced values from $3.0$ eV to $5.5$ eV inclusive.\n- Case 4 (hotter ions, thermal assistance):\n  - $E_0 = 1.80$ eV, $T = 600$ K, $s = 2$, $\\sigma = 0.02$ eV,\n  - $h\\nu$ grid: $51$ equally spaced values from $1.0$ eV to $3.0$ eV inclusive.\n\nFinal output format:\nYour program should produce a single line of output containing the four estimated thresholds for the cases above as a comma-separated list enclosed in square brackets, with each value rounded to three decimal places, in electronvolts (eV). For example, the output should look like \"[3.487,2.201,4.098,1.804]\".", "solution": "We begin from energy conservation at the single-ion level: dissociation occurs if and only if the sum of the absorbed photon energy $E_{\\text{ph}}$ and the ion’s internal energy $E_{\\text{int}}$ meets or exceeds the dissociation threshold $E_0$, namely $E_{\\text{ph}} + E_{\\text{int}} \\ge E_0$. In photodissociation action spectroscopy under conditions where only a single photon is absorbed, the observable is the fraction of ions dissociating upon exposure, which equals the probability of the above inequality when both $E_{\\text{ph}}$ and $E_{\\text{int}}$ are random variables with known distributions.\n\nThe laser photon energy is modeled by a Gaussian distribution with mean $h\\nu$ and standard deviation $\\sigma$, so the probability that $E_{\\text{ph}}$ exceeds a required energy $x$ is given by the complementary cumulative distribution function of the Gaussian:\n$$\nP(E_{\\text{ph}} \\ge x) = \\int_{x}^{\\infty} \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\left(-\\frac{(E - h\\nu)^2}{2\\sigma^2}\\right)\\,dE = \\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{x - h\\nu}{\\sqrt{2}\\,\\sigma}\\right).\n$$\nFor the ion internal energy, we employ a Gamma distribution that captures the aggregate vibrational energy content; with shape parameter $s$ and scale parameter $\\beta = k_{\\mathrm{B}} T$ (Boltzmann constant multiplied by temperature), the probability density function is\n$$\np_T(E_{\\text{int}}) = \\frac{E_{\\text{int}}^{s-1}\\exp(-E_{\\text{int}}/\\beta)}{\\Gamma(s)\\,\\beta^s}, \\quad E_{\\text{int}} \\ge 0.\n$$\nThe observable single-photon action yield $Y(h\\nu; E_0)$ is the probability that $E_{\\text{ph}} + E_{\\text{int}} \\ge E_0$, averaged over the internal energy distribution and the photon energy distribution. Conditioning on $E_{\\text{int}}$ and then averaging yields\n$$\nY(h\\nu; E_0) = \\int_{0}^{\\infty} p_T(E_{\\text{int}})\\,P\\!\\left(E_{\\text{ph}} \\ge E_0 - E_{\\text{int}}\\right)\\,dE_{\\text{int}}\n= \\int_{0}^{\\infty} p_T(E_{\\text{int}})\\,\\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{E_0 - E_{\\text{int}} - h\\nu}{\\sqrt{2}\\,\\sigma}\\right)\\,dE_{\\text{int}}.\n$$\nThis integral has no simple closed form across all parameters, so we compute it numerically via quadrature. Specifically, we:\n- Choose a uniform grid $E_{\\text{int},j}$ on $[0, E_{\\max}]$ with spacing $\\Delta E$, where $E_{\\max}$ is selected large enough so that the Gamma distribution tail beyond $E_{\\max}$ contributes negligibly. A practical choice uses $E_{\\max} = s\\beta + c\\sqrt{s}\\,\\beta + m$ with constants $c$ and $m$ ensuring coverage well into the tail. In our implementation, we select $c = 12$ and $m = 3.0$ electronvolts to conservatively capture the tail for all given test conditions.\n- Approximate the integral with a Riemann sum:\n$$\nY(h\\nu; E_0) \\approx \\sum_{j=0}^{N-1} p_T(E_{\\text{int},j})\\;\\frac{1}{2}\\operatorname{erfc}\\!\\left(\\frac{E_0 - E_{\\text{int},j} - h\\nu}{\\sqrt{2}\\,\\sigma}\\right)\\;\\Delta E,\n$$\nwhich converges as $N$ increases and as $E_{\\max}$ sufficiently exceeds the bulk of the distribution.\n\nTo estimate $E_0$ from synthetic data, we use least squares estimation. Given measured (synthetic) yields $\\{y_i\\}$ at photon energies $\\{h\\nu_i\\}$, we minimize the sum of squared residuals\n$$\nS(E_0) = \\sum_{i} \\left[y_i - Y(h\\nu_i; E_0)\\right]^2,\n$$\nover $E_0 \\in [0.5, 6.0]$ electronvolts. Because $S(E_0)$ is a univariate function and the model is smooth, a bounded derivative-free method such as golden-section search is appropriate and robust. Golden-section search maintains a bracketing interval $[a,b]$ and evaluates the function at two interior points $c$ and $d$, where $c = b - \\varphi(b-a)$ and $d = a + \\varphi(b-a)$ with $\\varphi = (\\sqrt{5} - 1)/2$. At each step, the interval is reduced depending on which interior point yields a lower objective value. Iteration proceeds until the interval length $|b-a|$ is less than a specified tolerance, at which point the midpoint $(a+b)/2$ is taken as the estimate.\n\nAlgorithmic steps per test case:\n1. Compute $\\beta = k_{\\mathrm{B}} T$ in electronvolts using $k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5}\\ \\text{eV/K}$ and form the uniform grid on $[0, E_{\\max}]$ with $N$ points (we choose $N = 3000$ for a balance of accuracy and efficiency).\n2. Evaluate the Gamma density $p_T(E_{\\text{int},j})$ on the grid using $\\Gamma(s)$ for normalization.\n3. For each photon energy grid point $h\\nu_i$, compute $Y(h\\nu_i; E_0)$ via the Riemann sum, using the complementary error function in the tail probability.\n4. Generate synthetic yields by using the true $E_0$ and adding independent Gaussian noise with standard deviation $10^{-2}$, then clamp the yields to $[0,1]$.\n5. Define the least squares objective $S(E_0)$ and minimize it over $[0.5, 6.0]$ eV using golden-section search with a tolerance of $10^{-4}$ eV.\n6. Round the resulting $E_0$ estimate to three decimal places and report it in electronvolts.\n\nEdge-case considerations covered by the test suite:\n- Cold ions ($T$ small) produce sharp near-step onsets; the algorithm’s bounded search and fine internal energy grid ensure stability.\n- Broad laser bandwidth ($\\sigma$ large) yields smeared onsets; the model accounts for this via the Gaussian tail probability.\n- Hotter ions (large $T$) shift the apparent onset to lower $h\\nu$ due to internal energy assistance; the convolution properly captures this effect.\n\nThe final program implements these steps for the four specified cases and prints a single line with the four threshold estimates in the requested format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom math import sqrt, gamma\nfrom scipy.special import erfc\n\n# Constants\nK_B_EV_PER_K = 8.617333262e-5  # Boltzmann constant in eV/K\n\ndef gamma_pdf(e_int, s, beta):\n    \"\"\"\n    Gamma distribution PDF for internal energy.\n    p_T(E) = E^{s-1} exp(-E/beta) / (Gamma(s) * beta^s)\n    \"\"\"\n    # Prevent issues at E=0 when s  1; but s >= 2 in our tests.\n    coeff = 1.0 / (gamma(s) * (beta ** s))\n    return coeff * (e_int ** (s - 1)) * np.exp(-e_int / beta)\n\ndef choose_eint_grid_params(s, beta):\n    \"\"\"\n    Choose an upper bound for the internal energy grid E_max conservatively such that\n    the Gamma distribution tail beyond E_max is negligible for our model.\n    E_max = s*beta + c*sqrt(s)*beta + m, with c=12, m=3.0 eV.\n    \"\"\"\n    c = 12.0\n    m = 3.0  # eV\n    e_max = s * beta + c * sqrt(s) * beta + m\n    return e_max\n\ndef compute_yield_model(hv_array, E0, s, beta, sigma, e_int_grid, pdf_grid, delta_e):\n    \"\"\"\n    Compute the action yield Y(hv; E0) for each hv in hv_array using\n    numerical quadrature over the internal energy grid.\n    Y(hv; E0) = \\int_0^\\infty p_T(E_int) * 0.5 * erfc((E0 - E_int - hv) / (sqrt(2)*sigma)) dE_int\n    Approximate via Riemann sum on [0, E_max].\n    \"\"\"\n    # Broadcast hv_array against e_int_grid to form a matrix of tail probabilities\n    # tail_prob[i, j] = 0.5 * erfc((E0 - e_int_grid[j] - hv_array[i]) / (sqrt(2)*sigma))\n    # Use numpy broadcasting for efficiency.\n    # Avoid division by zero in sigma; sigma > 0 in all cases.\n    arg = (E0 - e_int_grid[None, :] - hv_array[:, None]) / (sqrt(2.0) * sigma)\n    tail = 0.5 * erfc(arg)\n    # Integrate over e_int_grid: Y_i = sum_j pdf_grid[j] * tail[i,j] * delta_e\n    y = np.dot(tail, pdf_grid) * delta_e\n    # Clamp to [0,1] due to numerical approximations (should already be within)\n    return np.clip(y, 0.0, 1.0)\n\ndef golden_section_search(func, a, b, tol=1e-4, max_iter=200):\n    \"\"\"\n    Bounded golden-section search for univariate minimization.\n    Returns the argmin within [a, b] to within tolerance tol.\n    \"\"\"\n    invphi = (sqrt(5.0) - 1.0) / 2.0  # 1/phi = 0.618...\n    invphi2 = (3.0 - sqrt(5.0)) / 2.0  # 1/phi^2 = 0.382...\n\n    # Required steps to achieve tolerance\n    n = int(np.ceil(np.log(tol / (b - a)) / np.log(invphi)))\n\n    c = a + invphi2 * (b - a)\n    d = a + invphi * (b - a)\n    fc = func(c)\n    fd = func(d)\n\n    for k in range(min(n, max_iter)):\n        if fc  fd:\n            b, d, fd = d, c, fc\n            c = a + invphi2 * (b - a)\n            fc = func(c)\n        else:\n            a, c, fc = c, d, fd\n            d = a + invphi * (b - a)\n            fd = func(d)\n        if abs(b - a)  tol:\n            break\n    return 0.5 * (a + b)\n\ndef simulate_and_estimate(case, rng):\n    \"\"\"\n    For a given test case dict, simulate synthetic yields and estimate E0 by least squares fit.\n    case keys: E0_true, T, s, sigma, hv_min, hv_max, N_hv\n    \"\"\"\n    E0_true = case[\"E0_true\"]\n    T = case[\"T\"]\n    s = case[\"s\"]\n    sigma = case[\"sigma\"]\n    hv_min = case[\"hv_min\"]\n    hv_max = case[\"hv_max\"]\n    N_hv = case[\"N_hv\"]\n\n    beta = K_B_EV_PER_K * T  # eV\n    hv_array = np.linspace(hv_min, hv_max, N_hv)\n\n    # Internal energy grid\n    e_max = choose_eint_grid_params(s, beta)\n    N_grid = 3000\n    e_int_grid = np.linspace(0.0, e_max, N_grid)\n    delta_e = e_int_grid[1] - e_int_grid[0]\n    pdf_grid = gamma_pdf(e_int_grid, s, beta)\n\n    # Generate synthetic data\n    y_true = compute_yield_model(hv_array, E0_true, s, beta, sigma, e_int_grid, pdf_grid, delta_e)\n    noise = rng.normal(loc=0.0, scale=1.0e-2, size=y_true.shape)\n    y_meas = np.clip(y_true + noise, 0.0, 1.0)\n\n    # Define least squares objective function\n    def sse(E0):\n        y_model = compute_yield_model(hv_array, E0, s, beta, sigma, e_int_grid, pdf_grid, delta_e)\n        resid = y_meas - y_model\n        return float(np.dot(resid, resid))\n\n    # Minimize over [0.5, 6.0] eV using golden-section search\n    E0_est = golden_section_search(sse, 0.5, 6.0, tol=1e-4, max_iter=300)\n\n    return E0_est\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: typical laboratory conditions\n        {\"E0_true\": 3.50, \"T\": 300.0, \"s\": 3, \"sigma\": 0.05, \"hv_min\": 2.5, \"hv_max\": 5.0, \"N_hv\": 51},\n        # Case 2: cold ions, sharp threshold\n        {\"E0_true\": 2.20, \"T\": 30.0, \"s\": 3, \"sigma\": 0.005, \"hv_min\": 1.5, \"hv_max\": 3.0, \"N_hv\": 51},\n        # Case 3: broad laser bandwidth, smeared onset\n        {\"E0_true\": 4.10, \"T\": 300.0, \"s\": 5, \"sigma\": 0.20, \"hv_min\": 3.0, \"hv_max\": 5.5, \"N_hv\": 51},\n        # Case 4: hotter ions, thermal assistance\n        {\"E0_true\": 1.80, \"T\": 600.0, \"s\": 2, \"sigma\": 0.02, \"hv_min\": 1.0, \"hv_max\": 3.0, \"N_hv\": 51},\n    ]\n\n    rng = np.random.default_rng(seed=42)\n    results = []\n    for case in test_cases:\n        E0_est = simulate_and_estimate(case, rng)\n        # Round to three decimal places\n        results.append(round(E0_est, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda x: f'{x:.3f}', results))}]\")\n\nsolve()\n```", "id": "3718313"}]}