{"hands_on_practices": [{"introduction": "In high-energy physics, a particle's identity is rarely determined by a single measurement. This exercise demonstrates the foundational Bayesian framework for combining evidence from multiple, independent subdetectors to form a single, powerful decision variable. By working through this problem, you will learn to compute the posterior log-odds ratio, a cornerstone of statistical decision-making, and use it to design a classifier that meets a specific performance target, such as a controlled misidentification rate [@problem_id:3526746].", "problem": "In a particle identification (PID) task in computational high-energy physics, a track is observed by three subdetectors: a time of flight system (TOF), a ring imaging Cherenkov detector (RICH), and a tracker providing specific ionization by energy loss (dE/dx). The event-level feature vector is denoted by $x$. Assume that, conditional on the particle species, the three subdetector measurements are statistically independent and that the only two relevant particle hypotheses are pion $\\pi$ and kaon $K$. The prior species probabilities at the kinematics of this track are $p(\\pi)=0.65$ and $p(K)=0.35$. The subdetector likelihood (probability density) values at the observed $x$ are:\n- TOF: $p_{\\mathrm{TOF}}(x \\mid \\pi)=0.18$, $p_{\\mathrm{TOF}}(x \\mid K)=0.32$,\n- RICH: $p_{\\mathrm{RICH}}(x \\mid \\pi)=0.05$, $p_{\\mathrm{RICH}}(x \\mid K)=0.20$,\n- dE/dx: $p_{dE/dx}(x \\mid \\pi)=0.40$, $p_{dE/dx}(x \\mid K)=0.10$.\n\nUsing only fundamental probability rules, including Bayes’ theorem and the stated conditional independence, compute the posterior log-odds\n$$\ns(x)\\equiv \\ln \\frac{p(\\pi \\mid x)}{p(K \\mid x)}.\n$$\nNext, consider designing a threshold classifier that declares the particle a pion if $s(x)>\\tau$ and a kaon otherwise. Suppose that, under the true kaon hypothesis, the per-detector log-likelihood ratio contributions $\\ell_{i}(x)\\equiv \\ln\\!\\big(p_{i}(x \\mid \\pi)/p_{i}(x \\mid K)\\big)$ for $i\\in\\{\\mathrm{TOF},\\mathrm{RICH},dE/dx\\}$ are mutually independent and Gaussian with means and variances\n$$\n\\ell_{\\mathrm{TOF}} \\sim \\mathcal{N}(-0.6,\\,0.25),\\quad \\ell_{\\mathrm{RICH}} \\sim \\mathcal{N}(-1.1,\\,0.36),\\quad \\ell_{dE/dx} \\sim \\mathcal{N}(-0.2,\\,0.16).\n$$\nAssume the prior-odds contribution $\\ln\\!\\big(p(\\pi)/p(K)\\big)$ is a constant additive term in $s(x)$. Design the decision threshold $\\tau$ that achieves a target kaon misidentification rate of $r_{K\\to\\pi}=0.05$, where $r_{K\\to\\pi}$ is the probability that a true kaon is classified as a pion, i.e., $r_{K\\to\\pi}=\\mathbb{P}_{K}\\!\\big[s(x)>\\tau\\big]$.\n\nCompute both $s(x)$ for the given event and $\\tau$ for the specified target misidentification rate. For grading, report only the threshold $\\tau$. Express the threshold as a pure number with no units and round your answer to four significant figures.", "solution": "The problem asks for two calculations related to a particle identification task: the posterior log-odds $s(x)$ for a specific event, and a decision threshold $\\tau$ for a classifier based on a target misidentification rate.\n\nFirst, let's establish the general form of the posterior log-odds, $s(x)$, defined as:\n$$\ns(x) \\equiv \\ln \\frac{p(\\pi \\mid x)}{p(K \\mid x)}\n$$\nwhere $\\pi$ and $K$ represent the pion and kaon hypotheses, respectively, and $x$ is the event-level feature vector.\n\nUsing Bayes' theorem, the posterior probability for a hypothesis $H \\in \\{\\pi, K\\}$ is given by $p(H \\mid x) = \\frac{p(x \\mid H) p(H)}{p(x)}$. The term $p(x)$ is the evidence, which is common to both hypotheses and cancels out in the ratio:\n$$\n\\frac{p(\\pi \\mid x)}{p(K \\mid x)} = \\frac{p(x \\mid \\pi) p(\\pi) / p(x)}{p(x \\mid K) p(K) / p(x)} = \\frac{p(x \\mid \\pi)}{p(x \\mid K)} \\frac{p(\\pi)}{p(K)}\n$$\nTaking the natural logarithm gives the log-odds:\n$$\ns(x) = \\ln \\left( \\frac{p(x \\mid \\pi)}{p(x \\mid K)} \\right) + \\ln \\left( \\frac{p(\\pi)}{p(K)} \\right)\n$$\nThe problem states that the measurements from the three subdetectors (TOF, RICH, dE/dx) are conditionally independent given the particle species. Therefore, the total likelihood $p(x \\mid H)$ is the product of the individual subdetector likelihoods:\n$$\np(x \\mid H) = p_{\\mathrm{TOF}}(x \\mid H) \\cdot p_{\\mathrm{RICH}}(x \\mid H) \\cdot p_{dE/dx}(x \\mid H)\n$$\nSubstituting this into the expression for $s(x)$ and using the property of logarithms $\\ln(ab) = \\ln(a) + \\ln(b)$, we get:\n$$\ns(x) = \\left[ \\ln \\frac{p_{\\mathrm{TOF}}(x \\mid \\pi)}{p_{\\mathrm{TOF}}(x \\mid K)} + \\ln \\frac{p_{\\mathrm{RICH}}(x \\mid \\pi)}{p_{\\mathrm{RICH}}(x \\mid K)} + \\ln \\frac{p_{dE/dx}(x \\mid \\pi)}{p_{dE/dx}(x \\mid K)} \\right] + \\ln \\frac{p(\\pi)}{p(K)}\n$$\n\n**Part 1: Calculation of $s(x)$ for the given event**\n\nThe problem provides the following values for a specific event $x$:\n- Prior probabilities: $p(\\pi)=0.65$, $p(K)=0.35$.\n- TOF likelihoods: $p_{\\mathrm{TOF}}(x \\mid \\pi)=0.18$, $p_{\\mathrm{TOF}}(x \\mid K)=0.32$.\n- RICH likelihoods: $p_{\\mathrm{RICH}}(x \\mid \\pi)=0.05$, $p_{\\mathrm{RICH}}(x \\mid K)=0.20$.\n- dE/dx likelihoods: $p_{dE/dx}(x \\mid \\pi)=0.40$, $p_{dE/dx}(x \\mid K)=0.10$.\n\nWe calculate each term in the expression for $s(x)$:\nThe log-prior-odds term is:\n$$\n\\ln \\frac{p(\\pi)}{p(K)} = \\ln \\frac{0.65}{0.35} = \\ln \\frac{13}{7}\n$$\nThe log-likelihood ratio terms are:\n$$\n\\ell_{\\mathrm{TOF}}(x) = \\ln \\frac{p_{\\mathrm{TOF}}(x \\mid \\pi)}{p_{\\mathrm{TOF}}(x \\mid K)} = \\ln \\frac{0.18}{0.32} = \\ln \\frac{9}{16}\n$$\n$$\n\\ell_{\\mathrm{RICH}}(x) = \\ln \\frac{p_{\\mathrm{RICH}}(x \\mid \\pi)}{p_{\\mathrm{RICH}}(x \\mid K)} = \\ln \\frac{0.05}{0.20} = \\ln \\frac{1}{4}\n$$\n$$\n\\ell_{dE/dx}(x) = \\ln \\frac{p_{dE/dx}(x \\mid \\pi)}{p_{dE/dx}(x \\mid K)} = \\ln \\frac{0.40}{0.10} = \\ln(4)\n$$\nSumming these terms to find $s(x)$:\n$$\ns(x) = \\ln\\frac{9}{16} + \\ln\\frac{1}{4} + \\ln(4) + \\ln\\frac{13}{7} = \\ln\\frac{9}{16} - \\ln(4) + \\ln(4) + \\ln\\frac{13}{7} = \\ln\\frac{9}{16} + \\ln\\frac{13}{7} = \\ln\\left(\\frac{9 \\times 13}{16 \\times 7}\\right) = \\ln\\frac{117}{112}\n$$\nNumerically, $s(x) \\approx \\ln(1.0446) \\approx 0.0436$.\n\n**Part 2: Calculation of the decision threshold $\\tau$**\n\nFor the second part, we are given a statistical model for the log-likelihood ratios $\\ell_i(x) = \\ln(p_i(x \\mid \\pi)/p_i(x \\mid K))$ under the true kaon hypothesis. These are assumed to be independent Gaussian random variables:\n- $\\ell_{\\mathrm{TOF}} \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2)$ with $\\mu_1 = -0.6$ and $\\sigma_1^2 = 0.25$.\n- $\\ell_{\\mathrm{RICH}} \\sim \\mathcal{N}(\\mu_2, \\sigma_2^2)$ with $\\mu_2 = -1.1$ and $\\sigma_2^2 = 0.36$.\n- $\\ell_{dE/dx} \\sim \\mathcal{N}(\\mu_3, \\sigma_3^2)$ with $\\mu_3 = -0.2$ and $\\sigma_3^2 = 0.16$.\n\nThe test statistic $s(x)$ can be written as the sum of these random variables plus a constant term for the log-prior-odds:\n$$\ns(x) = \\ell_{\\mathrm{TOF}}(x) + \\ell_{\\mathrm{RICH}}(x) + \\ell_{dE/dx}(x) + \\ln\\frac{p(\\pi)}{p(K)}\n$$\nThe sum of independent Gaussian variables is also a Gaussian variable. Let $L(x) = \\ell_{\\mathrm{TOF}}(x) + \\ell_{\\mathrm{RICH}}(x) + \\ell_{dE/dx}(x)$. Under the kaon hypothesis, the distribution of $L(x)$ is $\\mathcal{N}(\\mu_L, \\sigma_L^2)$, where the mean is the sum of the means and the variance is the sum of the variances:\n$$\n\\mu_L = \\mu_1 + \\mu_2 + \\mu_3 = -0.6 - 1.1 - 0.2 = -1.9\n$$\n$$\n\\sigma_L^2 = \\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2 = 0.25 + 0.36 + 0.16 = 0.77\n$$\nThe statistic $s(x)$ is a linear transformation of $L(x)$, specifically $s(x)=L(x)+C$ where $C = \\ln(p(\\pi)/p(K))$. Therefore, the distribution of $s(x)$ under the kaon hypothesis is also Gaussian, $s(x) \\mid K \\sim \\mathcal{N}(\\mu_s, \\sigma_s^2)$, with:\n$$\n\\mu_s = \\mu_L + \\ln\\frac{p(\\pi)}{p(K)} = -1.9 + \\ln\\frac{0.65}{0.35} = -1.9 + \\ln\\frac{13}{7}\n$$\n$$\n\\sigma_s^2 = \\sigma_L^2 = 0.77\n$$\nThe standard deviation is $\\sigma_s = \\sqrt{0.77}$.\n\nThe kaon misidentification rate, $r_{K\\to\\pi}$, is the probability of classifying a true kaon as a pion. This occurs when $s(x) > \\tau$. We are given a target rate $r_{K\\to\\pi} = 0.05$.\n$$\n\\mathbb{P}_K[s(x) > \\tau] = 0.05\n$$\nTo find $\\tau$, we standardize the variable $s(x)$. Let $Z = \\frac{s(x) - \\mu_s}{\\sigma_s}$, which follows a standard normal distribution, $Z \\sim \\mathcal{N}(0, 1)$.\nThe condition becomes:\n$$\n\\mathbb{P}_K\\left[\\frac{s(x) - \\mu_s}{\\sigma_s} > \\frac{\\tau - \\mu_s}{\\sigma_s}\\right] = 0.05 \\implies \\mathbb{P}\\left[Z > \\frac{\\tau - \\mu_s}{\\sigma_s}\\right] = 0.05\n$$\nThis means that the value $\\frac{\\tau - \\mu_s}{\\sigma_s}$ is the critical value $z_{0.05}$ that corresponds to the upper $5\\%$ tail of the standard normal distribution. This value is the $95^{th}$ percentile of the distribution, $\\Phi^{-1}(0.95)$, where $\\Phi$ is the cumulative distribution function of the standard normal distribution.\nUsing standard tables or a calculator, $z_{0.05} \\approx 1.64485$.\nWe can now solve for $\\tau$:\n$$\n\\frac{\\tau - \\mu_s}{\\sigma_s} = z_{0.05} \\implies \\tau = \\mu_s + z_{0.05} \\sigma_s\n$$\nSubstituting the expressions for $\\mu_s$ and $\\sigma_s$:\n$$\n\\tau = \\left(-1.9 + \\ln\\frac{13}{7}\\right) + z_{0.05} \\sqrt{0.77}\n$$\nNow, we compute the numerical value:\n$$\n\\ln\\frac{13}{7} \\approx 0.619039\n$$\n$$\n\\mu_s \\approx -1.9 + 0.619039 = -1.280961\n$$\n$$\n\\sigma_s = \\sqrt{0.77} \\approx 0.877496\n$$\n$$\n\\tau \\approx -1.280961 + (1.64485 \\times 0.877496)\n$$\n$$\n\\tau \\approx -1.280961 + 1.443369\n$$\n$$\n\\tau \\approx 0.162408\n$$\nRounding to four significant figures, the threshold is $\\tau = 0.1624$.", "answer": "$$\n\\boxed{0.1624}\n$$", "id": "3526746"}, {"introduction": "The effectiveness of any particle classifier hinges on the fidelity of its underlying physical models. Simple Gaussian assumptions often fall short of describing the complex, non-Gaussian responses of real detectors. This practice confronts this challenge by modeling the specific energy loss ($dE/dx$), which famously exhibits a long tail, using a more realistic Gaussian Mixture Model. You will derive the misidentification probabilities for a classifier based on this advanced model, providing a direct link between sophisticated modeling and tangible performance evaluation [@problem_id:3526695].", "problem": "Consider Particle Identification (PID) in a gaseous tracker where the specific ionization energy loss per unit length, denoted by $x = dE/dx$, is measured in $\\mathrm{keV/cm}$. Two particle species, pions ($\\pi$) and kaons ($K$), traverse at fixed momentum where the Bethe-Bloch separation is modest and non-Gaussian tails are present due to rare, high-ionization clusters. Assume the class-conditional $x$ distributions are modeled as Gaussian-sum mixture models. Specifically, for each species $c \\in \\{\\pi, K\\}$,\nthe likelihood $f_{c}(x)$ is a convex combination of two Gaussian components: a core and a tail. Let the mixture weights, means, and standard deviations be:\n- For pions: core weight $w_{\\pi,1} = 0.88$, tail weight $w_{\\pi,2} = 0.12$, core mean $\\mu_{\\pi,1} = 2.0$, core standard deviation $\\sigma_{\\pi,1} = 0.10$, tail mean $\\mu_{\\pi,2} = 2.6$, tail standard deviation $\\sigma_{\\pi,2} = 0.20$.\n- For kaons: core weight $w_{K,1} = 0.90$, tail weight $w_{K,2} = 0.10$, core mean $\\mu_{K,1} = 2.25$, core standard deviation $\\sigma_{K,1} = 0.10$, tail mean $\\mu_{K,2} = 2.95$, tail standard deviation $\\sigma_{K,2} = 0.20$.\n\nLet the prior probabilities be $\\pi_{\\pi} = 0.60$ and $\\pi_{K} = 0.40$. A simple fixed-threshold classifier is employed: accept $K$ if $x \\geq t_{d}$ and accept $\\pi$ otherwise, with decision threshold $t_{d} = 2.3$.\n\nStarting only from Bayes’ theorem and the definition of the Gaussian mixture model (without shortcut formulas), derive expressions for the posterior probabilities $p(K \\mid x)$ and $p(\\pi \\mid x)$ in terms of $f_{K}(x)$, $f_{\\pi}(x)$, and the priors. Then, derive expressions for the class-conditional misidentification probabilities at the fixed threshold $t_{d}$, namely $P(\\text{misID} \\mid \\pi)$ and $P(\\text{misID} \\mid K)$, and the overall misidentification rate $P(\\text{misID})$ aggregated over priors. Using the numerical parameters above, evaluate the overall misidentification rate $P(\\text{misID})$ as a dimensionless decimal. Round your final numerical answer to four significant figures and express it as a pure number (no units).", "solution": "The problem asks for the derivation of posterior probabilities, misidentification probabilities, and the calculation of the overall misidentification rate for a binary classification problem involving pions ($\\pi$) and kaons ($K$). The observable is the specific ionization energy loss, $x$, and the class-conditional probability density functions (PDFs), $f_c(x)$, are given as Gaussian mixture models.\n\nFirst, we derive the expressions for the posterior probabilities, $p(\\pi \\mid x)$ and $p(K \\mid x)$, using Bayes' theorem. For a particle class $c \\in \\{\\pi, K\\}$, the posterior probability given a measurement $x$ is:\n$$p(c \\mid x) = \\frac{p(x \\mid c) p(c)}{p(x)}$$\nHere, $p(x \\mid c)$ is the class-conditional likelihood, which is the given PDF $f_c(x)$. The term $p(c)$ is the prior probability for the class, denoted as $\\pi_c$. The denominator, $p(x)$, is the marginal likelihood of the measurement $x$, also called the evidence. It is obtained by marginalizing over all possible classes using the law of total probability:\n$$p(x) = \\sum_{c' \\in \\{\\pi, K\\}} p(x \\mid c') p(c') = f_{\\pi}(x)\\pi_{\\pi} + f_{K}(x)\\pi_{K}$$\nSubstituting these terms, the posterior probabilities for pions and kaons are:\n$$p(\\pi \\mid x) = \\frac{f_{\\pi}(x) \\pi_{\\pi}}{f_{\\pi}(x) \\pi_{\\pi} + f_{K}(x) \\pi_{K}}$$\n$$p(K \\mid x) = \\frac{f_{K}(x) \\pi_{K}}{f_{\\pi}(x) \\pi_{\\pi} + f_{K}(x) \\pi_{K}}$$\n\nNext, we derive the expressions for the class-conditional misidentification probabilities. The classifier uses a fixed threshold $t_d = 2.3$. A particle is classified as a kaon if $x \\geq t_d$ and as a pion if $x < t_d$.\nThe probability of misidentifying a true pion, $P(\\text{misID} \\mid \\pi)$, is the probability that a pion-initiated event has an energy loss $x \\geq t_d$ and is thus classified as a kaon. This probability is the integral of the pion's PDF over the kaon decision region:\n$$P(\\text{misID} \\mid \\pi) = P(x \\geq t_d \\mid \\pi) = \\int_{t_d}^{\\infty} f_{\\pi}(x) dx$$\nThe probability of misidentifying a true kaon, $P(\\text{misID} \\mid K)$, is the probability that a kaon-initiated event has an energy loss $x < t_d$ and is thus classified as a pion. This probability is the integral of the kaon's PDF over the pion decision region:\n$$P(\\text{misID} \\mid K) = P(x < t_d \\mid K) = \\int_{-\\infty}^{t_d} f_{K}(x) dx$$\n\nThe overall misidentification rate, $P(\\text{misID})$, is the total probability of an error, aggregated over the prior probabilities of each particle species. Using the law of total probability again:\n$$P(\\text{misID}) = P(\\text{misID} \\mid \\pi) P(\\pi) + P(\\text{misID} \\mid K) P(K)$$\nSubstituting the prior probabilities $\\pi_{\\pi}$ and $\\pi_{K}$ and the integral expressions:\n$$P(\\text{misID}) = \\pi_{\\pi} \\int_{t_d}^{\\infty} f_{\\pi}(x) dx + \\pi_{K} \\int_{-\\infty}^{t_d} f_{K}(x) dx$$\n\nTo evaluate this expression numerically, we must compute the integrals. The PDFs are Gaussian mixture models of the form $f_c(x) = \\sum_{i=1}^{2} w_{c,i} G(x; \\mu_{c,i}, \\sigma_{c,i})$, where $G(x; \\mu, \\sigma)$ denotes the Gaussian PDF. Let $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution, $\\mathcal{N}(0, 1)$. The integral of a Gaussian PDF can be expressed in terms of $\\Phi(z)$:\n$$\\int_{-\\infty}^{t} G(x; \\mu, \\sigma) dx = \\Phi\\left(\\frac{t-\\mu}{\\sigma}\\right)$$\n$$\\int_{t}^{\\infty} G(x; \\mu, \\sigma) dx = 1 - \\Phi\\left(\\frac{t-\\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{\\mu-t}{\\sigma}\\right)$$\n\nNow, we calculate $P(\\text{misID} \\mid \\pi)$. The PDF for pions is $f_{\\pi}(x) = w_{\\pi,1} G(x; \\mu_{\\pi,1}, \\sigma_{\\pi,1}) + w_{\\pi,2} G(x; \\mu_{\\pi,2}, \\sigma_{\\pi,2})$.\n$$\n\\begin{align*} P(\\text{misID} \\mid \\pi) &= \\int_{t_d}^{\\infty} \\left[w_{\\pi,1} G(x; \\mu_{\\pi,1}, \\sigma_{\\pi,1}) + w_{\\pi,2} G(x; \\mu_{\\pi,2}, \\sigma_{\\pi,2})\\right] dx \\\\ &= w_{\\pi,1} \\int_{t_d}^{\\infty} G(x; \\mu_{\\pi,1}, \\sigma_{\\pi,1}) dx + w_{\\pi,2} \\int_{t_d}^{\\infty} G(x; \\mu_{\\pi,2}, \\sigma_{\\pi,2}) dx \\\\ &= w_{\\pi,1} \\left[1 - \\Phi\\left(\\frac{t_d - \\mu_{\\pi,1}}{\\sigma_{\\pi,1}}\\right)\\right] + w_{\\pi,2} \\left[1 - \\Phi\\left(\\frac{t_d - \\mu_{\\pi,2}}{\\sigma_{\\pi,2}}\\right)\\right]\\end{align*}\n$$\nUsing the given values: $t_d=2.3$, $w_{\\pi,1}=0.88$, $\\mu_{\\pi,1}=2.0$, $\\sigma_{\\pi,1}=0.10$, $w_{\\pi,2}=0.12$, $\\mu_{\\pi,2}=2.6$, $\\sigma_{\\pi,2}=0.20$.\nThe arguments of the CDF are:\n$$z_{\\pi,1} = \\frac{2.3 - 2.0}{0.10} = 3.0$$\n$$z_{\\pi,2} = \\frac{2.3 - 2.6}{0.20} = -1.5$$\nSo, $P(\\text{misID} \\mid \\pi) = 0.88 [1 - \\Phi(3.0)] + 0.12 [1 - \\Phi(-1.5)]$. Since $1-\\Phi(-z) = \\Phi(z)$, this simplifies to $0.88 [1 - \\Phi(3.0)] + 0.12 \\Phi(1.5)$.\nUsing $\\Phi(3.0) \\approx 0.998650$ and $\\Phi(1.5) \\approx 0.933193$:\n$$P(\\text{misID} \\mid \\pi) \\approx 0.88(1 - 0.998650) + 0.12(0.933193) = 0.88(0.001350) + 0.111983 = 0.001188 + 0.111983 = 0.113171$$\n\nNext, we calculate $P(\\text{misID} \\mid K)$. The PDF for kaons is $f_{K}(x) = w_{K,1} G(x; \\mu_{K,1}, \\sigma_{K,1}) + w_{K,2} G(x; \\mu_{K,2}, \\sigma_{K,2})$.\n$$\n\\begin{align*} P(\\text{misID} \\mid K) &= \\int_{-\\infty}^{t_d} \\left[w_{K,1} G(x; \\mu_{K,1}, \\sigma_{K,1}) + w_{K,2} G(x; \\mu_{K,2}, \\sigma_{K,2})\\right] dx \\\\ &= w_{K,1} \\int_{-\\infty}^{t_d} G(x; \\mu_{K,1}, \\sigma_{K,1}) dx + w_{K,2} \\int_{-\\infty}^{t_d} G(x; \\mu_{K,2}, \\sigma_{K,2}) dx \\\\ &= w_{K,1} \\Phi\\left(\\frac{t_d - \\mu_{K,1}}{\\sigma_{K,1}}\\right) + w_{K,2} \\Phi\\left(\\frac{t_d - \\mu_{K,2}}{\\sigma_{K,2}}\\right)\\end{align*}\n$$\nUsing the given values: $t_d=2.3$, $w_{K,1}=0.90$, $\\mu_{K,1}=2.25$, $\\sigma_{K,1}=0.10$, $w_{K,2}=0.10$, $\\mu_{K,2}=2.95$, $\\sigma_{K,2}=0.20$.\nThe arguments of the CDF are:\n$$z_{K,1} = \\frac{2.3 - 2.25}{0.10} = 0.5$$\n$$z_{K,2} = \\frac{2.3 - 2.95}{0.20} = -3.25$$\nSo, $P(\\text{misID} \\mid K) = 0.90 \\Phi(0.5) + 0.10 \\Phi(-3.25)$.\nUsing $\\Phi(0.5) \\approx 0.691462$ and $\\Phi(-3.25) = 1 - \\Phi(3.25) \\approx 1 - 0.999423 = 0.000577$:\n$$P(\\text{misID} \\mid K) \\approx 0.90(0.691462) + 0.10(0.000577) = 0.622316 + 0.000058 = 0.622374$$\n\nFinally, we calculate the overall misidentification rate $P(\\text{misID})$ using priors $\\pi_{\\pi}=0.60$ and $\\pi_{K}=0.40$:\n$$P(\\text{misID}) = \\pi_{\\pi} P(\\text{misID} \\mid \\pi) + \\pi_{K} P(\\text{misID} \\mid K)$$\n$$P(\\text{misID}) \\approx 0.60(0.113171) + 0.40(0.622374) = 0.0679026 + 0.2489496 = 0.3168522$$\nRounding the result to four significant figures gives $0.3169$.", "answer": "$$\n\\boxed{0.3169}\n$$", "id": "3526695"}, {"introduction": "This capstone computational exercise guides you through the construction of a statistically optimal classifier from first principles. You will implement a decision rule based on the Neyman-Pearson lemma, which guarantees the most powerful test for a given false-positive rate. The problem requires combining information from two distinct detector systems—one measuring energy loss ($dE/dx$) and the other time-of-flight (TOF)—and utilizes Monte Carlo simulation to determine the decision threshold when an analytical solution is intractable, a technique essential in modern data analysis [@problem_id:3526721].", "problem": "You are tasked with designing and implementing an optimal particle identification test between charged pions and charged kaons using energy loss per unit length and time-of-flight measurements in a tracking detector. The goal is to derive the most powerful decision rule at fixed false-alarm rate using the Neyman–Pearson lemma and to implement it computationally across discrete momentum slices. The decision rule compares the likelihood ratio built from the conditional distributions of the observables given each particle hypothesis, modeled with scientifically plausible approximations to Vavilov energy-loss straggling and Gaussian time-of-flight resolution.\n\nThe fundamental base for this problem is the combination of the classical energy-loss behavior of charged particles in matter and relativistic kinematics:\n- Energy loss per unit length is governed by the Bethe–Bloch behavior, which is monotonically shaped by the particle speed and exhibits a relativistic rise. For thin absorbers, the straggling distribution is well described by the Vavilov family; in the limit of small thickness parameter, the Landau shape is recovered. To keep the computation tractable while retaining scientific realism, you must approximate the Vavilov distribution with the Moyal distribution as a surrogate for the Landau limit. This approximation captures the characteristic long, positive tail of straggling in a thin detector layer.\n- Time-of-flight is kinematically determined by the relativistic speed, with a detector resolution modeled by a Gaussian distribution.\n\nYou must consider the following modeling assumptions and constants:\n- The hypotheses are simple: $H_{0}$ is \"pion\", $H_{1}$ is \"kaon\".\n- Masses are $m_{\\pi} = 0.13957$ $\\mathrm{GeV}/c^{2}$ and $m_{K} = 0.49368$ $\\mathrm{GeV}/c^{2}$.\n- Speed of light is $c = 0.299792458$ $\\mathrm{m/ns}$.\n- Path length is $L = 2.0$ $\\mathrm{m}$, so the time-of-flight mean is $t(p, m) = L/(\\beta(p, m)\\, c)$ with $\\beta(p, m) = p/\\sqrt{p^{2} + m^{2}}$ in natural units where $c = 1$ inside $\\beta$.\n- Time-of-flight resolution is Gaussian with standard deviation $\\sigma_{t} = 0.08$ $\\mathrm{ns}$.\n- The energy-loss per unit length distribution $dE/dx$ is approximated by a Moyal distribution (Landau-limit surrogate) with location parameter $\\mu(p, m)$ and scale parameter $s(p, m)$. Use the reduced, empirically shaped dependency capturing the $1/\\beta^{2}$ dominance and relativistic rise:\n  $$\\mu(p, m) = \\frac{A}{\\beta(p, m)^{2}} \\left(1 + r \\ln\\left(\\gamma(p, m)^{2}\\right)\\right), \\quad \\gamma(p, m) = \\frac{1}{\\sqrt{1 - \\beta(p, m)^{2}}},$$\n  where $A = 2.0$ $\\mathrm{keV/cm}$ and $r = 0.2$ are dimensionless shaping constants.\n  The scale parameter is\n  $$s(p, m) = s_{0} + s_{1}\\,\\mu(p, m),$$\n  with $s_{0} = 0.25$ $\\mathrm{keV/cm}$ and $s_{1} = 0.05$ dimensionless. This yields physically plausible heavy-tailed $dE/dx$ distributions that vary with momentum and species.\n- The time-of-flight conditional distribution given momentum $p$ and mass $m$ is Gaussian with mean $t(p, m)$ and standard deviation $\\sigma_{t}$.\n\nUnder the assumption that, conditional on the particle species and the momentum slice, the $dE/dx$ and time-of-flight are independent, the joint density is the product of the respective one-dimensional densities.\n\nYou must derive, from first principles, the optimal test according to the Neyman–Pearson lemma. Let $\\mathbf{x} = (x_{\\mathrm{dE}}, x_{t})$ denote a joint observation consisting of $dE/dx$ and time-of-flight. Define the likelihood ratio\n$$\\Lambda(\\mathbf{x}; p) = \\frac{p(x_{\\mathrm{dE}} \\mid p, K)\\, p(x_{t} \\mid p, K)}{p(x_{\\mathrm{dE}} \\mid p, \\pi)\\, p(x_{t} \\mid p, \\pi)},$$\nwhere $p(\\cdot \\mid p, \\cdot)$ denote the conditional probability density functions parametrized by the momentum slice $p$. The most powerful size-$\\alpha$ test compares $\\Lambda(\\mathbf{x}; p)$ to a threshold $\\tau(p)$ determined by the condition\n$$\\mathbb{P}_{\\pi}\\left(\\Lambda(\\mathbf{X}; p) > \\tau(p)\\right) = \\alpha,$$\nwhere the probability is under the pion hypothesis, and $\\alpha$ is the desired false positive rate. You must set $\\alpha = 0.1$ (decimal) for all momentum slices.\n\nBecause $\\tau(p)$ does not admit a general closed form under the above modeling, you must estimate $\\tau(p)$ by Monte Carlo sampling under $H_{0}$ for each momentum slice. Use scientifically sound sampling from the specified conditional distributions and numerically compute the quantile corresponding to $1 - \\alpha$ of the distribution of $\\log \\Lambda(\\mathbf{X}; p)$, which is equivalent to thresholding $\\Lambda(\\mathbf{X}; p)$.\n\nImplement a complete program that:\n- For each momentum slice $p$ in the test suite, draws a sufficiently large number of samples under $H_{0}$ to estimate $\\tau(p)$ robustly.\n- Computes the decision for each provided test observation by comparing $\\Lambda(\\mathbf{x}; p)$ to $\\tau(p)$.\n- Returns the decisions as booleans, where a boolean is true precisely when the observation is accepted as \"kaon\" by the Neyman–Pearson test at size $\\alpha$, and false otherwise.\n\nAll physical units in the input and modeling are:\n- $dE/dx$ in $\\mathrm{keV/cm}$.\n- Time-of-flight in $\\mathrm{ns}$.\n- Momentum in $\\mathrm{GeV}/c$.\n\nTest suite:\n- Momentum slices are $p \\in \\{0.6, 1.0, 2.0\\}$ $\\mathrm{GeV}/c$.\n- False positive rate is $\\alpha = 0.1$ (decimal).\n- Path length is $L = 2.0$ $\\mathrm{m}$.\n- Speed of light is $c = 0.299792458$ $\\mathrm{m/ns}$.\n- Time resolution is $\\sigma_{t} = 0.08$ $\\mathrm{ns}$.\n- Energy-loss shaping constants are $A = 2.0$ $\\mathrm{keV/cm}$, $r = 0.2$, $s_{0} = 0.25$ $\\mathrm{keV/cm}$, $s_{1} = 0.05$.\n- Masses are $m_{\\pi} = 0.13957$ $\\mathrm{GeV}/c^{2}$ and $m_{K} = 0.49368$ $\\mathrm{GeV}/c^{2}$.\n\nEvaluate the Neyman–Pearson decision rule for the following four observations, each assigned to its corresponding momentum slice:\n- Case $1$: $p = 0.6$ $\\mathrm{GeV}/c$, $x_{\\mathrm{dE}} = 3.4$ $\\mathrm{keV/cm}$, $x_{t} = 7.1$ $\\mathrm{ns}$.\n- Case $2$: $p = 1.0$ $\\mathrm{GeV}/c$, $x_{\\mathrm{dE}} = 3.3$ $\\mathrm{keV/cm}$, $x_{t} = 7.5$ $\\mathrm{ns}$.\n- Case $3$: $p = 2.0$ $\\mathrm{GeV}/c$, $x_{\\mathrm{dE}} = 4.1$ $\\mathrm{keV/cm}$, $x_{t} = 6.80$ $\\mathrm{ns}$.\n- Case $4$ (edge case stressing the heavy tail): $p = 1.0$ $\\mathrm{GeV}/c$, $x_{\\mathrm{dE}} = 8.0$ $\\mathrm{keV/cm}$, $x_{t} = 6.65$ $\\mathrm{ns}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\texttt{[result1,result2,result3,result4]}$, where each result is a boolean corresponding to the decision for the respective case in the order stated above.", "solution": "The core of the problem is to construct the most powerful statistical test to distinguish between two simple hypotheses: $H_{0}$, a detected particle is a charged pion ($\\pi$), and $H_{1}$, the particle is a charged kaon ($K$). The test is to be performed at a fixed false positive rate (significance level or size) of $\\alpha = 0.1$. The Neyman-Pearson lemma states that the most powerful test is a likelihood-ratio test.\n\nThe test relies on two independent observables for a particle with a given momentum $p$: the energy loss per unit length, $x_{\\mathrm{dE}}$, and the time-of-flight, $x_{t}$. Let the joint observation be denoted by the vector $\\mathbf{x} = (x_{\\mathrm{dE}}, x_{t})$. The decision rule is based on the likelihood ratio $\\Lambda(\\mathbf{x}; p)$:\n$$ \\Lambda(\\mathbf{x}; p) = \\frac{p(\\mathbf{x} \\mid H_{1}, p)}{p(\\mathbf{x} \\mid H_{0}, p)} = \\frac{p(\\mathbf{x} \\mid K, p)}{p(\\mathbf{x} \\mid \\pi, p)} $$\nGiven the conditional independence of the observables, the joint probability density function (PDF) is the product of the individual PDFs:\n$$ p(\\mathbf{x} \\mid \\text{species}, p) = p_{\\mathrm{dE}}(x_{\\mathrm{dE}} \\mid \\text{species}, p) \\cdot p_{t}(x_{t} \\mid \\text{species}, p) $$\nThe Neyman-Pearson test rejects the null hypothesis $H_{0}$ (i.e., decides in favor of $H_{1}$, the kaon) if $\\Lambda(\\mathbf{x}; p) > \\tau(p)$, where $\\tau(p)$ is a threshold determined by the desired false positive rate $\\alpha$:\n$$ \\mathbb{P}(\\Lambda(\\mathbf{X}; p) > \\tau(p) \\mid H_{0}) = \\alpha $$\nFor numerical stability and convenience, it is standard practice to work with the logarithm of the likelihood ratio, $\\ln \\Lambda$. The decision rule becomes: accept $H_1$ if $\\ln\\Lambda(\\mathbf{x}; p) > \\ln\\tau(p)$. The threshold $\\ln\\tau(p)$ is the $(1-\\alpha)$-quantile of the distribution of $\\ln\\Lambda(\\mathbf{X}; p)$ under the null hypothesis $H_0$.\n\nThe step-by-step procedure is as follows:\n1.  Define the kinematic and statistical models for pions and kaons.\n2.  For each momentum slice $p$, determine the threshold $\\ln\\tau(p)$ via Monte Carlo simulation.\n3.  For each test case, calculate $\\ln\\Lambda(\\mathbf{x}; p)$ and compare it with the corresponding threshold $\\ln\\tau(p)$ to make a decision.\n\n**1. Model Components**\n\nFirst, we define all necessary functions based on the provided physical model. The particle masses are $m_{\\pi} = 0.13957 \\mathrm{GeV}/c^{2}$ and $m_{K} = 0.49368 \\mathrm{GeV}/c^{2}$.\n\n**Kinematics:** The relativistic speed $\\beta$ and Lorentz factor $\\gamma$ for a particle of mass $m$ and momentum $p$ are:\n$$ \\beta(p, m) = \\frac{p}{\\sqrt{p^2 + m^2}} \\quad \\text{(using natural units with } c=1 \\text{)} $$\n$$ \\gamma(p, m) = \\frac{1}{\\sqrt{1 - \\beta(p, m)^2}} = \\frac{\\sqrt{p^2 + m^2}}{m} $$\n\n**Time-of-Flight (ToF) Model:** The mean time-of-flight over a path length $L = 2.0 \\mathrm{m}$ is:\n$$ t(p, m) = \\frac{L}{\\beta(p, m) \\cdot c} $$\nwhere $c = 0.299792458 \\mathrm{m/ns}$ is the speed of light. The ToF measurement is modeled by a Gaussian distribution with mean $t(p, m)$ and standard deviation $\\sigma_{t} = 0.08 \\mathrm{ns}$. The log-PDF is:\n$$ \\ln p_{t}(x_{t} \\mid p, m) = -\\frac{1}{2} \\left( \\frac{x_{t} - t(p, m)}{\\sigma_{t}} \\right)^2 - \\ln(\\sigma_{t}\\sqrt{2\\pi}) $$\n\n**Energy Loss ($dE/dx$) Model:** The $dE/dx$ distribution is modeled by a Moyal distribution, which is a computationally tractable surrogate for the Landau distribution. The location parameter $\\mu$ and scale parameter $s$ depend on momentum and mass:\n$$ \\mu(p, m) = \\frac{A}{\\beta(p, m)^{2}} \\left(1 + r \\ln\\left(\\gamma(p, m)^{2}\\right)\\right) $$\n$$ s(p, m) = s_{0} + s_{1}\\,\\mu(p, m) $$\nwith constants $A = 2.0 \\mathrm{keV/cm}$, $r = 0.2$, $s_{0} = 0.25 \\mathrm{keV/cm}$, and $s_{1} = 0.05$. The log-PDF of the Moyal distribution for an observation $x_{\\mathrm{dE}}$ with location $\\mu$ and scale $s$ is:\n$$ \\ln p_{\\mathrm{dE}}(x_{\\mathrm{dE}} \\mid p, m) = \\ln \\left( \\frac{1}{\\sqrt{2\\pi}s(p,m)} \\exp\\left(-\\frac{1}{2}\\left(z + e^{-z}\\right)\\right) \\right) \\quad \\text{with} \\quad z = \\frac{x_{\\mathrm{dE}} - \\mu(p,m)}{s(p,m)} $$\n\n**2. Threshold Determination via Monte Carlo**\n\nSince an analytical expression for the distribution of $\\ln\\Lambda(\\mathbf{X}; p)$ under $H_0$ is not available, we use Monte Carlo simulation. For each required momentum slice $p \\in \\{0.6, 1.0, 2.0\\} \\mathrm{GeV}/c$:\na.  Calculate the parameters for both hypotheses: $(\\mu_{\\pi}, s_{\\pi}, t_{\\pi})$ for $H_{0}$ (pion) and $(\\mu_{K}, s_{K}, t_{K})$ for $H_{1}$ (kaon).\nb.  Generate a large number $N$ (e.g., $N=1,000,000$) of pseudo-observations $\\mathbf{X}_i = (x_{\\mathrm{dE},i}, x_{t,i})$ under the pion hypothesis $H_0$:\n    $$ x_{\\mathrm{dE},i} \\sim \\mathrm{Moyal}(\\mu=\\mu_{\\pi}, s=s_{\\pi}) $$\n    $$ x_{t,i} \\sim \\mathcal{N}(\\mu=t_{\\pi}, \\sigma=\\sigma_{t}) $$\nc.  For each sample $\\mathbf{X}_i$, compute the log-likelihood ratio:\n    $$ \\ln\\Lambda(\\mathbf{X}_i; p) = \\left[ \\ln p_{\\mathrm{dE}}(x_{\\mathrm{dE},i} \\mid K, p) + \\ln p_{t}(x_{t,i} \\mid K, p) \\right] - \\left[ \\ln p_{\\mathrm{dE}}(x_{\\mathrm{dE},i} \\mid \\pi, p) + \\ln p_{t}(x_{t,i} \\mid \\pi, p) \\right] $$\nd.  The set of $N$ values of $\\ln\\Lambda$ forms an empirical distribution. The threshold $\\ln\\tau(p)$ is estimated as the $(1-\\alpha)$-quantile of this distribution. With $\\alpha = 0.1$, this is the $90$-th percentile.\n\n**3. Decision for Test Cases**\n\nFor each of the four test observations $(p, x_{\\mathrm{dE}}, x_t)$, we perform the following steps:\na.  Retrieve the pre-computed threshold $\\ln\\tau(p)$ for the given momentum $p$.\nb.  Calculate the log-likelihood ratio $\\ln\\Lambda(\\mathbf{x}; p)$ for the observation $\\mathbf{x} = (x_{\\mathrm{dE}}, x_t)$.\nc.  Apply the decision rule: If $\\ln\\Lambda(\\mathbf{x}; p) > \\ln\\tau(p)$, the particle is classified as a kaon (decision is `True`). Otherwise, it is classified as a pion (decision is `False`).\n\nThis procedure is implemented in the provided Python code, which yields the final set of decisions for the specified test cases. The use of a large Monte Carlo sample size ensures a robust and stable estimation of the decision thresholds. A random seed is fixed to ensure the reproducibility of the result.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import moyal, norm\n\ndef solve():\n    \"\"\"\n    Solves the particle identification problem using the Neyman-Pearson lemma.\n    \"\"\"\n    # Set a random seed for reproducibility of the Monte Carlo simulation\n    np.random.seed(0)\n\n    # --- Problem Constants and Parameters ---\n    # Particle masses in GeV/c^2\n    M_PI = 0.13957\n    M_K = 0.49368\n    \n    # Detector and physics constants\n    L = 2.0  # path length in m\n    C = 0.299792458  # speed of light in m/ns\n    SIGMA_T = 0.08  # time-of-flight resolution in ns\n    \n    # dE/dx model parameters\n    A = 2.0   # keV/cm\n    R = 0.2   # dimensionless\n    S0 = 0.25 # keV/cm\n    S1 = 0.05 # dimensionless\n    \n    # Statistical test parameters\n    ALPHA = 0.1  # false positive rate\n    N_SAMPLES = 1_000_000  # number of MC samples for threshold estimation\n\n    # --- Test Cases ---\n    test_cases = [\n        # (p [GeV/c], x_dE [keV/cm], x_t [ns])\n        (0.6, 3.4, 7.1),\n        (1.0, 3.3, 7.5),\n        (2.0, 4.1, 6.80),\n        (1.0, 8.0, 6.65),\n    ]\n\n    # --- Helper Functions for Physics Models ---\n    def get_beta(p, m):\n        \"\"\"Calculates relativistic beta.\"\"\"\n        return p / np.sqrt(p**2 + m**2)\n\n    def get_gamma(p, m):\n        \"\"\"Calculates relativistic gamma.\"\"\"\n        return np.sqrt(p**2 + m**2) / m\n\n    def get_tof_mean(p, m, l, c):\n        \"\"\"Calculates mean time-of-flight.\"\"\"\n        beta = get_beta(p, m)\n        return l / (beta * c)\n\n    def get_dEdx_mu(p, m, a, r):\n        \"\"\"Calculates location parameter for dE/dx distribution.\"\"\"\n        beta = get_beta(p, m)\n        gamma = get_gamma(p, m)\n        return (a / beta**2) * (1 + r * np.log(gamma**2))\n\n    def get_dEdx_s(mu, s0, s1):\n        \"\"\"Calculates scale parameter for dE/dx distribution.\"\"\"\n        return s0 + s1 * mu\n\n    def calculate_model_params(p, m):\n        \"\"\"Computes all model parameters for a given particle.\"\"\"\n        mu_dEdx = get_dEdx_mu(p, m, A, R)\n        s_dEdx = get_dEdx_s(mu_dEdx, S0, S1)\n        t_mean = get_tof_mean(p, m, L, C)\n        return mu_dEdx, s_dEdx, t_mean\n\n    def log_likelihood_ratio(x_dE, x_t, p, params_pi, params_k):\n        \"\"\"Calculates the log-likelihood ratio ln(P(x|K)/P(x|pi)).\"\"\"\n        mu_pi, s_pi, t_pi = params_pi[p]\n        mu_k, s_k, t_k = params_k[p]\n        \n        # Log-PDF for dE/dx under H0 (pion) and H1 (kaon)\n        log_pdf_dEdx_pi = moyal.logpdf(x_dE, loc=mu_pi, scale=s_pi)\n        log_pdf_dEdx_k = moyal.logpdf(x_dE, loc=mu_k, scale=s_k)\n        \n        # Log-PDF for ToF under H0 (pion) and H1 (kaon)\n        log_pdf_t_pi = norm.logpdf(x_t, loc=t_pi, scale=SIGMA_T)\n        log_pdf_t_k = norm.logpdf(x_t, loc=t_k, scale=SIGMA_T)\n        \n        # Total log-likelihood under each hypothesis\n        log_likelihood_pi = log_pdf_dEdx_pi + log_pdf_t_pi\n        log_likelihood_k = log_pdf_dEdx_k + log_pdf_t_k\n        \n        return log_likelihood_k - log_likelihood_pi\n\n    # --- Main Logic ---\n\n    # Pre-calculate model parameters for each unique momentum\n    unique_momenta = sorted(list(set(case[0] for case in test_cases)))\n    params_pi = {p: calculate_model_params(p, M_PI) for p in unique_momenta}\n    params_k = {p: calculate_model_params(p, M_K) for p in unique_momenta}\n\n    # Determine thresholds using Monte Carlo simulation\n    log_thresholds = {}\n    for p in unique_momenta:\n        # Get parameters for the null hypothesis (pion)\n        mu_pi, s_pi, t_pi = params_pi[p]\n        \n        # Generate samples under H0\n        samples_dEdx = moyal.rvs(loc=mu_pi, scale=s_pi, size=N_SAMPLES)\n        samples_t = norm.rvs(loc=t_pi, scale=SIGMA_T, size=N_SAMPLES)\n        \n        # Calculate log-likelihood ratio for each sample\n        log_lambda_samples = log_likelihood_ratio(samples_dEdx, samples_t, p, params_pi, params_k)\n        \n        # Determine the threshold as the (1-alpha) quantile\n        log_thresholds[p] = np.quantile(log_lambda_samples, 1 - ALPHA)\n\n    # Apply the decision rule to each test case\n    results = []\n    for p, x_dE, x_t in test_cases:\n        # Calculate log-likelihood ratio for the observation\n        log_lambda_obs = log_likelihood_ratio(x_dE, x_t, p, params_pi, params_k)\n        \n        # Retrieve the threshold for the momentum slice\n        log_tau = log_thresholds[p]\n        \n        # Make the decision\n        is_kaon = log_lambda_obs > log_tau\n        results.append(is_kaon)\n\n    # Format and print the final output as lowercase booleans\n    # Using str(b).lower() to produce 'true'/'false'\n    print(f\"[{','.join(map(lambda b: str(b).lower(), results))}]\")\n\nsolve()\n```", "id": "3526721"}]}