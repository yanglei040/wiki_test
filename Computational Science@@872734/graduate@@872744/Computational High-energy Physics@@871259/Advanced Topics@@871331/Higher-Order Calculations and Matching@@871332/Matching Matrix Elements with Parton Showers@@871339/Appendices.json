{"hands_on_practices": [{"introduction": "A central challenge in CKKW-style matching is to make the fixed-order matrix element (ME) calculation consistent with the parton shower's (PS) view of event evolution. This is achieved by reconstructing a plausible shower history from the ME partons and evaluating the strong coupling, $\\alpha_s$, at the scales of the corresponding emissions. This exercise [@problem_id:3521642] guides you through this core procedure by applying the $k_{\\perp}$ jet algorithm to a multi-parton final state, allowing you to determine the emission scales and compute the resulting CKKW event weight.", "problem": "Consider electron-positron annihilation at center-of-mass (CoM) energy $\\sqrt{s} = 100~\\mathrm{GeV}$ producing four massless partons identified as a quark $q$, an antiquark $\\bar{q}$, and two gluons $g$. In the CoM frame, the event is specified by the following four-momenta (in units of $\\mathrm{GeV}$) with the ordering $p^{\\mu} = (E, p_x, p_y, p_z)$:\n- $p_1$ (quark): $p_1 = \\left(\\frac{187}{5},\\, 0,\\, 0,\\, \\frac{187}{5}\\right)$,\n- $p_2$ (antiquark): $p_2 = \\left(\\frac{208}{5},\\, 0,\\, 0,\\, -\\frac{208}{5}\\right)$,\n- $p_3$ (gluon): $p_3 = \\left(12,\\, \\frac{36}{5},\\, 0,\\, \\frac{48}{5}\\right)$,\n- $p_4$ (gluon): $p_4 = \\left(9,\\, -\\frac{36}{5},\\, 0,\\, -\\frac{27}{5}\\right)$.\n\nThese four-momenta satisfy overall energy-momentum conservation and each parton is on the mass shell. Use the Durham $k_{\\perp}$-jet algorithm (appropriate for electron-positron collisions) defined by the pairwise distance\n$$\nk_{\\perp,ij}^{2} \\equiv 2\\,\\min\\!\\big(E_i^{2}, E_j^{2}\\big)\\,\\big(1-\\cos\\theta_{ij}\\big),\n$$\nwhere $\\theta_{ij}$ is the angle between the three-momenta of partons $i$ and $j$. Perform clustering with the E-scheme recombination $p_{ij}^{\\mu} \\equiv p_i^{\\mu} + p_j^{\\mu}$, iteratively merging the pair with the smallest $k_{\\perp,ij}^{2}$ until two pseudojets remain. Define the emission scales for Catani–Krauss–Kuhn–Webber (CKKW) reweighting as the $k_{\\perp}$ values (i.e., the square roots of the $k_{\\perp,ij}^{2}$ at each merging step) associated with each clustering.\n\nFor a simplified CKKW-like coupling reweighting, define the weight\n$$\nW \\equiv \\frac{\\alpha_s\\!\\big(k_{\\perp,1}\\big)\\,\\alpha_s\\!\\big(k_{\\perp,2}\\big)}{\\alpha_s\\!\\big(\\mu_0\\big)^{2}},\n$$\nwhere $\\mu_0 = 10~\\mathrm{GeV}$, and $\\alpha_s(Q)$ is the one-loop Quantum Chromodynamics (QCD) running coupling with $n_f = 5$ light flavors,\n$$\n\\alpha_s(Q) = \\frac{4\\pi}{\\beta_0\\,\\ln\\!\\big(Q^{2}/\\Lambda^{2}\\big)}, \\quad \\beta_0 = 11 - \\frac{2}{3}n_f, \\quad \\Lambda = 0.2~\\mathrm{GeV}.\n$$\n\nStarting from the definitions above and the given four-momenta, do the following:\n1. Compute all pairwise Durham distances $k_{\\perp,ij}^{2}$ for the initial set $\\{1,2,3,4\\}$ and identify the pair with the smallest value. Merge that pair using the E-scheme recombination and record the first emission scale $k_{\\perp,1}$.\n2. Recompute the distances among the resulting set of three objects and identify the next pair to merge. Perform the recombination and record the second emission scale $k_{\\perp,2}$. Stop when two pseudojets remain.\n3. Using the recorded emission scales, compute the weight $W$.\n\nExpress the final numerical value of $W$ as a dimensionless number and round your answer to four significant figures.", "solution": "The problem statement has been validated and is found to be self-contained, scientifically grounded, and well-posed. The provided four-momenta satisfy mass-shell conditions for massless partons and overall energy-momentum conservation in the center-of-mass frame. All definitions and constants are standard within the context of computational high-energy physics. We may therefore proceed with the solution.\n\nThe problem requires a two-step clustering of four partons using the Durham $k_{\\perp}$-jet algorithm, followed by the computation of a CKKW-like weight based on the emission scales found during clustering.\n\nThe four initial massless partons have four-momenta $p^{\\mu}=(E, p_x, p_y, p_z)$ given in units of $\\mathrm{GeV}$:\n- $p_1 = (37.4,\\, 0,\\, 0,\\, 37.4)$\n- $p_2 = (41.6,\\, 0,\\, 0,\\, -41.6)$\n- $p_3 = (12,\\, 7.2,\\, 0,\\, 9.6)$\n- $p_4 = (9,\\, -7.2,\\, 0,\\, -5.4)$\n\nThe corresponding energies are $E_1 = 37.4$, $E_2 = 41.6$, $E_3 = 12$, and $E_4 = 9$. Since the partons are massless, the magnitude of the three-momentum $|\\vec{p}_i|$ is equal to the energy $E_i$.\n\n### Step 1: First Clustering\nWe compute the six pairwise Durham distances, $k_{\\perp,ij}^{2} = 2\\,\\min(E_i^2, E_j^2)\\,(1-\\cos\\theta_{ij})$, where $\\cos\\theta_{ij} = \\frac{\\vec{p}_i \\cdot \\vec{p}_j}{|\\vec{p}_i||\\vec{p}_j|} = \\frac{\\vec{p}_i \\cdot \\vec{p}_j}{E_i E_j}$.\n\n1.  **Pair (1,2):** $\\vec{p}_1=(0,0,37.4)$, $\\vec{p}_2=(0,0,-41.6)$.\n    $\\cos\\theta_{12} = \\frac{(37.4)(-41.6)}{(37.4)(41.6)} = -1$.\n    $k_{\\perp,12}^{2} = 2\\,\\min(37.4^2, 41.6^2)\\,(1 - (-1)) = 2 \\cdot (37.4)^2 \\cdot 2 = 4 \\cdot 1398.76 = 5595.04$.\n\n2.  **Pair (1,3):** $\\vec{p}_1=(0,0,37.4)$, $\\vec{p}_3=(7.2,0,9.6)$.\n    $\\vec{p}_1 \\cdot \\vec{p}_3 = (37.4)(9.6) = 359.04$.\n    $E_1 E_3 = (37.4)(12) = 448.8$.\n    $\\cos\\theta_{13} = \\frac{359.04}{448.8} = 0.8$.\n    $k_{\\perp,13}^{2} = 2\\,\\min(37.4^2, 12^2)\\,(1 - 0.8) = 2 \\cdot 12^2 \\cdot 0.2 = 2 \\cdot 144 \\cdot 0.2 = 57.6$.\n\n3.  **Pair (1,4):** $\\vec{p}_1=(0,0,37.4)$, $\\vec{p}_4=(-7.2,0,-5.4)$.\n    $\\vec{p}_1 \\cdot \\vec{p}_4 = (37.4)(-5.4) = -201.96$.\n    $E_1 E_4 = (37.4)(9) = 336.6$.\n    $\\cos\\theta_{14} = \\frac{-201.96}{336.6} = -0.6$.\n    $k_{\\perp,14}^{2} = 2\\,\\min(37.4^2, 9^2)\\,(1 - (-0.6)) = 2 \\cdot 9^2 \\cdot 1.6 = 2 \\cdot 81 \\cdot 1.6 = 259.2$.\n\n4.  **Pair (2,3):** $\\vec{p}_2=(0,0,-41.6)$, $\\vec{p}_3=(7.2,0,9.6)$.\n    $\\vec{p}_2 \\cdot \\vec{p}_3 = (-41.6)(9.6) = -399.36$.\n    $E_2 E_3 = (41.6)(12) = 499.2$.\n    $\\cos\\theta_{23} = \\frac{-399.36}{499.2} = -0.8$.\n    $k_{\\perp,23}^{2} = 2\\,\\min(41.6^2, 12^2)\\,(1 - (-0.8)) = 2 \\cdot 12^2 \\cdot 1.8 = 2 \\cdot 144 \\cdot 1.8 = 518.4$.\n\n5.  **Pair (2,4):** $\\vec{p}_2=(0,0,-41.6)$, $\\vec{p}_4=(-7.2,0,-5.4)$.\n    $\\vec{p}_2 \\cdot \\vec{p}_4 = (-41.6)(-5.4) = 224.64$.\n    $E_2 E_4 = (41.6)(9) = 374.4$.\n    $\\cos\\theta_{24} = \\frac{224.64}{374.4} = 0.6$.\n    $k_{\\perp,24}^{2} = 2\\,\\min(41.6^2, 9^2)\\,(1 - 0.6) = 2 \\cdot 9^2 \\cdot 0.4 = 2 \\cdot 81 \\cdot 0.4 = 64.8$.\n\n6.  **Pair (3,4):** $\\vec{p}_3=(7.2,0,9.6)$, $\\vec{p}_4=(-7.2,0,-5.4)$.\n    $\\vec{p}_3 \\cdot \\vec{p}_4 = (7.2)(-7.2) + (9.6)(-5.4) = -51.84 - 51.84 = -103.68$.\n    $E_3 E_4 = (12)(9) = 108$.\n    $\\cos\\theta_{34} = \\frac{-103.68}{108} = -0.96$.\n    $k_{\\perp,34}^{2} = 2\\,\\min(12^2, 9^2)\\,(1 - (-0.96)) = 2 \\cdot 9^2 \\cdot 1.96 = 2 \\cdot 81 \\cdot 1.96 = 317.52$.\n\nThe minimum distance is $k_{\\perp,13}^{2} = 57.6$. We merge the pair $(1,3)$. The first emission scale is $k_{\\perp,1} = \\sqrt{57.6}$.\n\n### Step 2: Second Clustering\nWe merge partons $1$ and $3$ using the E-scheme recombination, $p_{13}^{\\mu} = p_1^{\\mu} + p_3^{\\mu}$:\n$p_{13} = \\left(37.4+12,\\, 0+7.2,\\, 0+0,\\, 37.4+9.6\\right) = \\left(49.4,\\, 7.2,\\, 0,\\, 47.0\\right)$.\nLet us denote this new pseudojet by $A$, so $p_A \\equiv p_{13}$. The remaining partons are $p_B \\equiv p_2$ and $p_C \\equiv p_4$. The new set of objects for clustering is $\\{A, B, C\\}$.\nThe energies are $E_A = 49.4$, $E_B = 41.6$, $E_C = 9$. Note that pseudojet $A$ is massive, so its three-momentum magnitude $|\\vec{p}_A|$ is not equal to $E_A$.\n$|\\vec{p}_A|^2 = 7.2^2 + 47.0^2 = 51.84 + 2209 = 2260.84$. So, $|\\vec{p}_A| = \\sqrt{2260.84} \\approx 47.548$.\n\nWe now compute the pairwise distances for $\\{A, B, C\\}$.\n1.  **Pair (A,B):** ($p_{13}$, $p_2$)\n    $\\vec{p}_A = (7.2, 0, 47.0)$, $\\vec{p}_B = (0, 0, -41.6)$.\n    $\\vec{p}_A \\cdot \\vec{p}_B = 47.0 \\times (-41.6) = -1955.2$.\n    $|\\vec{p}_A| = \\sqrt{2260.84}$, $|\\vec{p}_B| = E_B=41.6$.\n    $\\cos\\theta_{AB} = \\frac{-1955.2}{\\sqrt{2260.84} \\cdot 41.6} \\approx -0.98856$.\n    $k_{\\perp,AB}^{2} = 2\\,\\min(E_A^2, E_B^2)\\,(1 - \\cos\\theta_{AB}) = 2 \\cdot 41.6^2 \\cdot (1 - (-0.98856)) \\approx 6883.6$.\n\n2.  **Pair (A,C):** ($p_{13}$, $p_4$)\n    $\\vec{p}_A = (7.2, 0, 47.0)$, $\\vec{p}_C = (-7.2, 0, -5.4)$.\n    $\\vec{p}_A \\cdot \\vec{p}_C = (7.2)(-7.2) + (47.0)(-5.4) = -51.84 - 253.8 = -305.64$.\n    $|\\vec{p}_A| = \\sqrt{2260.84}$, $|\\vec{p}_C| = E_C = 9$.\n    $\\cos\\theta_{AC} = \\frac{-305.64}{\\sqrt{2260.84} \\cdot 9} \\approx -0.71421$.\n    $k_{\\perp,AC}^{2} = 2\\,\\min(E_A^2, E_C^2)\\,(1 - \\cos\\theta_{AC}) = 2 \\cdot 9^2 \\cdot (1 - (-0.71421)) \\approx 277.7$.\n\n3.  **Pair (B,C):** ($p_2$, $p_4$)\n    This is the same as the initial $k_{\\perp,24}^{2}$ calculation.\n    $k_{\\perp,BC}^{2} = k_{\\perp,24}^{2} = 64.8$.\n\nComparing the distances $\\{6883.6, 277.7, 64.8\\}$, the minimum is $k_{\\perp,BC}^{2} = 64.8$. We merge the pair $(B,C)$, which corresponds to the initial partons $(2,4)$. The second emission scale is $k_{\\perp,2} = \\sqrt{64.8}$.\n\nThe clustering procedure terminates as two pseudojets, $(1,3)$ and $(2,4)$, remain.\n\n### Step 3: Compute the Weight\nThe emission scales (squared) are $k_{\\perp,1}^2 = 57.6~\\mathrm{GeV}^2$ and $k_{\\perp,2}^2 = 64.8~\\mathrm{GeV}^2$.\nThe weight is given by $W = \\frac{\\alpha_s(k_{\\perp,1})\\,\\alpha_s(k_{\\perp,2})}{\\alpha_s(\\mu_0)^2}$.\nThe running coupling is $\\alpha_s(Q) = \\frac{4\\pi}{\\beta_0\\,\\ln(Q^2/\\Lambda^2)}$.\nSubstituting this into the weight expression, the constant factor $\\frac{4\\pi}{\\beta_0}$ cancels out:\n$$\nW = \\frac{\\frac{1}{\\ln(k_{\\perp,1}^2/\\Lambda^2)} \\cdot \\frac{1}{\\ln(k_{\\perp,2}^2/\\Lambda^2)}}{\\left(\\frac{1}{\\ln(\\mu_0^2/\\Lambda^2)}\\right)^2} = \\frac{\\left(\\ln(\\mu_0^2/\\Lambda^2)\\right)^2}{\\ln(k_{\\perp,1}^2/\\Lambda^2)\\,\\ln(k_{\\perp,2}^2/\\Lambda^2)}.\n$$\nWe are given $\\mu_0 = 10~\\mathrm{GeV}$ and $\\Lambda = 0.2~\\mathrm{GeV}$. We can now compute the arguments of the logarithms:\n- $\\mu_0^2 / \\Lambda^2 = (10 / 0.2)^2 = 50^2 = 2500$.\n- $k_{\\perp,1}^2 / \\Lambda^2 = 57.6 / (0.2)^2 = 57.6 / 0.04 = 1440$.\n- $k_{\\perp,2}^2 / \\Lambda^2 = 64.8 / (0.2)^2 = 64.8 / 0.04 = 1620$.\n\nSubstituting these values into the expression for $W$:\n$$\nW = \\frac{(\\ln(2500))^2}{\\ln(1440)\\,\\ln(1620)}\n$$\nUsing natural logarithms:\n$\\ln(2500) \\approx 7.824046$\n$\\ln(1440) \\approx 7.272398$\n$\\ln(1620) \\approx 7.390182$\n$$\nW \\approx \\frac{(7.824046)^2}{7.272398 \\times 7.390182} \\approx \\frac{61.2157}{53.7449} \\approx 1.13904\n$$\nRounding to four significant figures gives $1.139$.\nThe parameter $\\beta_0 = 11 - \\frac{2}{3}(5) = \\frac{23}{3}$ was not needed for the final calculation of the weight $W$, as it cancelled out from the ratio.", "answer": "$$\\boxed{1.139}$$", "id": "3521642"}, {"introduction": "The MLM matching scheme offers a different philosophy, employing a clear accept-or-reject decision for each event rather than continuous reweighting. This method ensures that hard jets generated by the parton shower do not duplicate those already described by the matrix element. This practice [@problem_id:3521637] places you in the role of the matching algorithm, where you must apply geometric matching criteria and enforce a jet veto to decide if a showered event correctly corresponds to its underlying hard process.", "problem": "In the context of quantum chromodynamics event generation, consider an exclusive sample whose Matrix Element (ME) description contains two final-state partons. After the Parton Shower (PS) and hadronization, the event is reconstructed into hadronic jets using an infrared-safe algorithm. To avoid double counting between the fixed-order ME description and the logarithmically resummed PS, use the Mangano–Moretti–Pantano–Nason–Ridolfi matching prescription, colloquially referred to as MLM matching. The following definitions and facts form the basis for the procedure:\n\n- In collinear-safe kinematics, jets are reconstructed from hadrons and characterized by transverse momentum $p_T$, pseudorapidity $\\eta$, and azimuthal angle $\\phi$. The angular separation is defined by the Euclidean metric in the $\\eta$–$\\phi$ plane, $\\Delta R = \\sqrt{(\\Delta \\eta)^2 + (\\Delta \\phi)^2}$, with $\\Delta \\phi$ taken modulo $2\\pi$ into the principal interval $(-\\pi, \\pi]$.\n- The exclusive two-parton sample is accepted if and only if each ME parton can be uniquely matched to a distinct reconstructed jet within a maximum matching radius $\\Delta R_{\\text{match}}$, subject to a minimum jet $p_T$ threshold $p_{T,\\text{min}}$, and there are no additional jets exceeding $p_{T,\\text{min}}$ (jet veto).\n\nYou are given one event whose ME final state consists of two partons, $p_1$ and $p_2$, and whose reconstruction yields three jets, $J_1$, $J_2$, and $J_3$. Their kinematic coordinates are:\n\n- ME partons:\n  - $p_1$: $(\\eta, \\phi, p_T) = (0.70, 1.90\\,\\text{rad}, 60\\,\\text{GeV})$,\n  - $p_2$: $(\\eta, \\phi, p_T) = (-1.20, -0.40\\,\\text{rad}, 45\\,\\text{GeV})$.\n- Reconstructed jets:\n  - $J_1$: $(\\eta, \\phi, p_T) = (0.72, 2.05\\,\\text{rad}, 58\\,\\text{GeV})$,\n  - $J_2$: $(\\eta, \\phi, p_T) = (-1.18, -0.35\\,\\text{rad}, 46\\,\\text{GeV})$,\n  - $J_3$: $(\\eta, \\phi, p_T) = (2.40, -2.80\\,\\text{rad}, 25\\,\\text{GeV})$.\n\nApply the MLM matching decision with matching radius $\\Delta R_{\\text{match}} = 0.30$, jet transverse momentum threshold $p_{T,\\text{min}} = 30\\,\\text{GeV}$, and the exclusive veto that rejects the event if any reconstructed jet with $p_T \\geq p_{T,\\text{min}}$ is not matched to an ME parton. Use $\\phi$ in radians. Compute all $\\Delta R$ values required for the unique one-to-one assignment, enforce the thresholds, and decide whether the event is accepted or rejected.\n\nReport the final acceptance decision as a single dimensionless number, with $1$ indicating acceptance and $0$ indicating rejection. No rounding is required.", "solution": "The problem requires the application of the Mangano–Moretti–Pantano–Nason–Ridolfi (MLM) matching prescription to decide whether a given event is accepted or rejected. The event consists of two matrix element (ME) partons, $p_1$ and $p_2$, and three reconstructed jets, $J_1$, $J_2$, and $J_3$. The decision is based on a set of specified criteria involving a matching radius $\\Delta R_{\\text{match}}$, a minimum jet transverse momentum $p_{T,\\text{min}}$, and an exclusive jet veto.\n\nThe acceptance criteria for this exclusive two-parton sample are:\n1. Each of the two ME partons must be uniquely matched to a distinct reconstructed jet whose transverse momentum $p_T$ is greater than or equal to $p_{T,\\text{min}}$.\n2. The angular separation $\\Delta R$ between each matched parton-jet pair must be less than or equal to $\\Delta R_{\\text{match}}$.\n3. There must be no other reconstructed jets with $p_T \\ge p_{T,\\text{min}}$ that are not matched to an ME parton.\n\nThe procedure is as follows:\n\nFirst, we filter the reconstructed jets based on the minimum transverse momentum threshold, $p_{T,\\text{min}} = 30\\,\\text{GeV}$.\nThe given jets are:\n- Jet $J_1$: $p_T(J_1) = 58\\,\\text{GeV}$. Since $58\\,\\text{GeV} \\ge 30\\,\\text{GeV}$, this jet is retained.\n- Jet $J_2$: $p_T(J_2) = 46\\,\\text{GeV}$. Since $46\\,\\text{GeV} \\ge 30\\,\\text{GeV}$, this jet is also retained.\n- Jet $J_3$: $p_T(J_3) = 25\\,\\text{GeV}$. Since $25\\,\\text{GeV}  30\\,\\text{GeV}$, this jet is discarded from the matching procedure and does not trigger the jet veto.\n\nThus, only jets $J_1$ and $J_2$ are considered for matching. Since there are two ME partons and two jets passing the $p_T$ cut, a one-to-one matching is possible.\n\nSecond, we calculate the angular separation $\\Delta R = \\sqrt{(\\Delta \\eta)^2 + (\\Delta \\phi)^2}$ between each ME parton and each of the surviving jets. The coordinates are:\n- Parton $p_1$: $(\\eta, \\phi) = (0.70, 1.90)$\n- Parton $p_2$: $(\\eta, \\phi) = (-1.20, -0.40)$\n- Jet $J_1$: $(\\eta, \\phi) = (0.72, 2.05)$\n- Jet $J_2$: $(\\eta, \\phi) = (-1.18, -0.35)$\n\nThe difference in azimuthal angle $\\Delta \\phi$ is calculated in the range $(-\\pi, \\pi]$. For the given values, no modular arithmetic is needed as all differences are within this range.\n\nThe pairwise $\\Delta R$ calculations are:\n- For the pair $(p_1, J_1)$:\n  $\\Delta \\eta = 0.70 - 0.72 = -0.02$\n  $\\Delta \\phi = 1.90 - 2.05 = -0.15$\n  $\\Delta R(p_1, J_1) = \\sqrt{(-0.02)^2 + (-0.15)^2} = \\sqrt{0.0004 + 0.0225} = \\sqrt{0.0229} \\approx 0.1513$\n\n- For the pair $(p_1, J_2)$:\n  $\\Delta \\eta = 0.70 - (-1.18) = 1.88$\n  $\\Delta \\phi = 1.90 - (-0.35) = 2.25$\n  $\\Delta R(p_1, J_2) = \\sqrt{(1.88)^2 + (2.25)^2} = \\sqrt{3.5344 + 5.0625} = \\sqrt{8.5969} \\approx 2.9320$\n\n- For the pair $(p_2, J_1)$:\n  $\\Delta \\eta = -1.20 - 0.72 = -1.92$\n  $\\Delta \\phi = -0.40 - 2.05 = -2.45$\n  $\\Delta R(p_2, J_1) = \\sqrt{(-1.92)^2 + (-2.45)^2} = \\sqrt{3.6864 + 6.0025} = \\sqrt{9.6889} \\approx 3.1127$\n\n- For the pair $(p_2, J_2)$:\n  $\\Delta \\eta = -1.20 - (-1.18) = -0.02$\n  $\\Delta \\phi = -0.40 - (-0.35) = -0.05$\n  $\\Delta R(p_2, J_2) = \\sqrt{(-0.02)^2 + (-0.05)^2} = \\sqrt{0.0004 + 0.0025} = \\sqrt{0.0029} \\approx 0.0539$\n\nThird, we perform the matching. For each parton, we find the closest jet and check if the separation is within the matching radius $\\Delta R_{\\text{match}} = 0.30$.\n- For parton $p_1$, the closest jet is $J_1$ with $\\Delta R(p_1, J_1) = \\sqrt{0.0229}$. Since $\\sqrt{0.0229} \\approx 0.1513 \\le 0.30$, parton $p_1$ is matched to jet $J_1$.\n- For parton $p_2$, the closest jet is $J_2$ with $\\Delta R(p_2, J_2) = \\sqrt{0.0029}$. Since $\\sqrt{0.0029} \\approx 0.0539 \\le 0.30$, parton $p_2$ is matched to jet $J_2$.\n\nThe resulting assignment is $p_1 \\to J_1$ and $p_2 \\to J_2$. This is a unique, one-to-one matching between ME partons and distinct reconstructed jets. Criterion 1 and 2 are satisfied.\n\nFourth, we apply the exclusive jet veto. The veto condition states that the event is rejected if there is any jet with $p_T \\ge p_{T,\\text{min}}$ that is not matched to an ME parton. The set of jets with $p_T \\ge p_{T,\\text{min}}$ is $\\{J_1, J_2\\}$. The set of matched jets is also $\\{J_1, J_2\\}$. There are no unmatched jets with $p_T \\ge p_{T,\\text{min}}$. Therefore, the event passes the jet veto.\n\nSince all acceptance criteria are met, the event is accepted. The final answer is $1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "3521637"}, {"introduction": "When combining exclusive matrix-element samples for various jet multiplicities (e.g., $Z+0j, Z+1j, Z+2j, \\dots$), a naive summation would fail to conserve the total cross section, violating the principle of unitarity. The UMEPS (Unitary Matrix Element + Parton Shower) framework provides an elegant solution by treating the highest-multiplicity sample inclusively, thereby absorbing the remainder of the cross section. This exercise [@problem_id:3521626] has you derive the underlying Poisson statistics of independent showering from first principles and demonstrate computationally how the UMEPS procedure perfectly preserves unitarity.", "problem": "Consider a toy yet physically faithful model of jet emission suitable for testing unitarization in Unitary Matrix Element plus Parton Shower (UMEPS). An inclusive hard process has a total rate (cross section) denoted by $\\sigma_{\\mathrm{incl}}$ in picobarns (pb). Emissions are modeled as independent and strongly ordered in a single hardness variable $q$ between a hard scale $Q_{\\max}$ and a merging scale $Q_{\\mathrm{cut}}$, both in $\\mathrm{GeV}$. Jets are defined by emissions with $q \\ge Q_{\\mathrm{cut}}$. The phase-space acceptance for emissions that qualify as jets is encoded by a dimensionless fraction $C \\in [0,1]$, representing the fraction of the full phase space that passes all applied cuts. The effective constant emission rate per unit logarithmic scale is defined as $\\kappa \\equiv \\bar{\\alpha}\\, C$, where $\\bar{\\alpha}$ is a dimensionless constant that aggregates the relevant coupling and color factors in this simplified model. \n\nUse the following foundational principles as the starting point:\n- The event generator’s shower physics obeys the independent-emission approximation with strong ordering in $q$, meaning successive emissions are uncorrelated except for ordering.\n- The no-emission probability between two scales $Q_a$ and $Q_b$ ($Q_a  Q_b$) is given by the Sudakov form factor,\n$$\n\\Delta(Q_a,Q_b) = \\exp\\left(-\\int_{\\ln Q_b}^{\\ln Q_a} \\kappa \\, d\\ln q\\right).\n$$\n- Jets are defined by emissions that pass a hardness threshold $Q_{\\mathrm{cut}}$ and the phase-space acceptance encapsulated by $C$.\n\nFrom these principles alone, and without assuming any pre-given final formula for multiplicity distributions, derive the exclusive $n$-jet cross sections and verify unitarization in UMEPS as follows:\n1) Starting from the definition of the Sudakov form factor and independent strongly ordered emissions, derive the probability distribution for observing exactly $n$ emissions with $q \\ge Q_{\\mathrm{cut}}$ in the interval $[Q_{\\mathrm{cut}}, Q_{\\max}]$, expressed in terms of the logarithmic range $L \\equiv \\ln(Q_{\\max}/Q_{\\mathrm{cut}})$ and the effective rate $\\kappa$. Then express the exclusive $n$-jet cross section $\\sigma_n$ in terms of $\\sigma_{\\mathrm{incl}}$, $L$, and $\\kappa$. Do not assume a particular named distribution a priori; obtain it from first principles of independent emissions and the Sudakov form factor.\n2) Suppose only exclusive samples up to a maximum resolved multiplicity $N_{\\max}$ are retained. Define the naive truncated-sum total,\n$$\n\\Sigma_{\\text{naive}}(N_{\\max}) \\equiv \\sum_{n=0}^{N_{\\max}} \\sigma_n,\n$$\nand the corresponding fractional deviation from unitarity,\n$$\n\\delta_{\\text{naive}} \\equiv \\frac{\\Sigma_{\\text{naive}}(N_{\\max}) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}}.\n$$\n3) In UMEPS, the highest-multiplicity sample is treated inclusively to restore unitarity. Implement this by defining\n$$\n\\sigma_{N_{\\max}}^{\\text{UMEPS}} \\equiv \\sigma_{\\mathrm{incl}} - \\sum_{n=0}^{N_{\\max}-1} \\sigma_n,\n$$\nwhile keeping $\\sigma_n^{\\text{UMEPS}} = \\sigma_n$ for $n  N_{\\max}$. Define\n$$\n\\Sigma_{\\text{UMEPS}}(N_{\\max}) \\equiv \\sum_{n=0}^{N_{\\max}} \\sigma_n^{\\text{UMEPS}},\n$$\nand the corresponding fractional deviation,\n$$\n\\delta_{\\text{UMEPS}} \\equiv \\frac{\\Sigma_{\\text{UMEPS}}(N_{\\max}) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}}.\n$$\n4) Implement a program that computes, for each specified test case, the pair of deviations $\\left[\\delta_{\\text{naive}}, \\delta_{\\text{UMEPS}}\\right]$ as real numbers (dimensionless decimals). The program must not read any input; it must use the test suite given below.\n\nUse the following test suite, where all $Q$ scales are in $\\mathrm{GeV}$ and $\\sigma_{\\mathrm{incl}}$ is in $\\mathrm{pb}$. For each case, compute the deviations as decimals:\n- Case A (general case): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 20\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.2$, $C = 0.5$, $N_{\\max} = 2$.\n- Case B (large logarithm): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 1\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.3$, $C = 1.0$, $N_{\\max} = 2$.\n- Case C (near-threshold): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 900\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.5$, $C = 0.8$, $N_{\\max} = 3$.\n- Case D (zero acceptance edge): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 100\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.2$, $C = 0.0$, $N_{\\max} = 4$.\n- Case E (very large tail, small $N_{\\max}$): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 0.5\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.5$, $C = 1.0$, $N_{\\max} = 1$.\n\nNumerical and output requirements:\n- All internal uses of $Q_{\\max}$ and $Q_{\\mathrm{cut}}$ must treat them in $\\mathrm{GeV}$; all $\\sigma$ in $\\mathrm{pb}$. The final deviations $\\delta_{\\text{naive}}$ and $\\delta_{\\text{UMEPS}}$ must be reported as unitless decimal numbers.\n- Your program should produce a single line of output containing the results as a comma-separated list of per-test-case lists, each inner list being $\\left[\\delta_{\\text{naive}}, \\delta_{\\text{UMEPS}}\\right]$, enclosed in square brackets. For example, the output must have the form \"[[dA_naive,dA_umeps],[dB_naive,dB_umeps],...]\" with no additional text.", "solution": "The problem requires the derivation of exclusive $n$-jet cross sections from first principles of a simplified parton shower model, and subsequently, the calculation of fractional deviations from unitarity for two different summation schemes.\n\n### Part 1: Derivation of the Exclusive $n$-Jet Cross Section\n\nThe foundation of the model is the independent and strongly ordered emission of partons, which are identified as jets if their hardness $q$ exceeds a cutoff $Q_{\\mathrm{cut}}$. The rate of emission is constant per unit of logarithmic hardness, given by the effective rate $\\kappa$. The total logarithmic range available for emissions is $L \\equiv \\ln(Q_{\\max}/Q_{\\mathrm{cut}})$.\n\nThe Sudakov form factor, $\\Delta(Q_a, Q_b)$, gives the probability of no emissions between scales $Q_a$ and $Q_b$ ($Q_a  Q_b$). As $\\kappa$ is constant, the integral defining the Sudakov form factor is:\n$$ \\Delta(Q_a, Q_b) = \\exp\\left(-\\int_{\\ln Q_b}^{\\ln Q_a} \\kappa \\, d\\ln q\\right) = \\exp\\left(-\\kappa [\\ln q]_{\\ln Q_b}^{\\ln Q_a}\\right) = \\exp(-\\kappa \\ln(Q_a/Q_b)) $$\n\nThe probability of having exactly zero emissions (jets) in the full range from $Q_{\\mathrm{cut}}$ to $Q_{\\max}$, denoted $P(0)$, is given by the Sudakov factor for this interval:\n$$ P(0) = \\Delta(Q_{\\max}, Q_{\\mathrm{cut}}) = \\exp(-\\kappa \\ln(Q_{\\max}/Q_{\\mathrm{cut}})) = e^{-\\kappa L} $$\n\nTo find the probability of exactly one emission, $P(1)$, we must consider an emission at some scale $q_1$ within the interval $[Q_{\\mathrm{cut}}, Q_{\\max}]$, with no other emissions. The differential probability for an emission to occur in an infinitesimal logarithmic interval $d\\ln q_1$ is $\\kappa \\, d\\ln q_1$. For an emission at $q_1$, there must be no emissions in the range $[q_1, Q_{\\max}]$ and no emissions in the range $[Q_{\\mathrm{cut}}, q_1]$. The total probability is found by integrating over all possible values of $q_1$:\n$$ P(1) = \\int_{\\ln Q_{\\mathrm{cut}}}^{\\ln Q_{\\max}} \\Delta(Q_{\\max}, q_1) \\cdot (\\kappa \\, d\\ln q_1) \\cdot \\Delta(q_1, Q_{\\mathrm{cut}}) $$\nThe product of the Sudakov factors simplifies:\n$$ \\Delta(Q_{\\max}, q_1) \\Delta(q_1, Q_{\\mathrm{cut}}) = e^{-\\kappa \\ln(Q_{\\max}/q_1)} e^{-\\kappa \\ln(q_1/Q_{\\mathrm{cut}})} = e^{-\\kappa(\\ln(Q_{\\max}/q_1) + \\ln(q_1/Q_{\\mathrm{cut}}))} = e^{-\\kappa \\ln(Q_{\\max}/Q_{\\mathrm{cut}})} = e^{-\\kappa L} $$\nThis term is independent of $q_1$. The integral becomes:\n$$ P(1) = \\int_{\\ln Q_{\\mathrm{cut}}}^{\\ln Q_{\\max}} \\kappa e^{-\\kappa L} \\, d\\ln q_1 = \\kappa e^{-\\kappa L} \\left[\\ln q_1\\right]_{\\ln Q_{\\mathrm{cut}}}^{\\ln Q_{\\max}} = \\kappa e^{-\\kappa L} (\\ln Q_{\\max} - \\ln Q_{\\mathrm{cut}}) = (\\kappa L) e^{-\\kappa L} $$\n\nFor the probability of exactly $n$ emissions, $P(n)$, we consider $n$ emissions at strongly ordered scales $Q_{\\max}  q_1  q_2  \\dots  q_n  Q_{\\mathrm{cut}}$. The differential probability for this specific configuration is the product of the probabilities of emission at each $q_i$ and no-emission probabilities in between:\n$$ dP(n) = \\Delta(Q_{\\max}, q_1) (\\kappa d\\ln q_1) \\Delta(q_1, q_2) (\\kappa d\\ln q_2) \\cdots \\Delta(q_{n-1}, q_n) (\\kappa d\\ln q_n) \\Delta(q_n, Q_{\\mathrm{cut}}) $$\nThe product of all Sudakov factors telescopes as before, yielding $e^{-\\kappa L}$. The differential probability simplifies to:\n$$ dP(n) = e^{-\\kappa L} \\kappa^n \\, d\\ln q_1 \\, d\\ln q_2 \\cdots d\\ln q_n $$\nTo find the total probability $P(n)$, we integrate over the ordered phase space. Let $t_i = \\ln q_i$, $T_{\\max} = \\ln Q_{\\max}$, and $T_{\\mathrm{cut}} = \\ln Q_{\\mathrm{cut}}$. The volume of integration is defined by $T_{\\max}  t_1  t_2  \\dots  t_n  T_{\\mathrm{cut}}$.\n$$ P(n) = \\kappa^n e^{-\\kappa L} \\int_{T_{\\mathrm{cut}}}^{T_{\\max}} dt_1 \\int_{T_{\\mathrm{cut}}}^{t_1} dt_2 \\cdots \\int_{T_{\\mathrm{cut}}}^{t_{n-1}} dt_n $$\nThis nested integral is the volume of an n-simplex of side length $(T_{\\max} - T_{\\mathrm{cut}}) = L$, which evaluates to $L^n/n!$.\nThus, the probability for exactly $n$ emissions is:\n$$ P(n) = \\frac{(\\kappa L)^n e^{-\\kappa L}}{n!} $$\nThis is the Poisson distribution with mean $\\lambda = \\kappa L$.\n\nThe exclusive $n$-jet cross section, $\\sigma_n$, is the inclusive cross section $\\sigma_{\\mathrm{incl}}$ multiplied by the probability of the $n$-jet final state:\n$$ \\sigma_n = \\sigma_{\\mathrm{incl}} \\cdot P(n) = \\sigma_{\\mathrm{incl}} \\frac{(\\kappa L)^n e^{-\\kappa L}}{n!} $$\n\n### Part 2: Naive Unitarity Deviation\n\nThe naive total cross section from summing exclusive samples up to $N_{\\max}$ is $\\Sigma_{\\text{naive}}(N_{\\max}) = \\sum_{n=0}^{N_{\\max}} \\sigma_n$. The corresponding fractional deviation from unitarity is:\n$$ \\delta_{\\text{naive}} = \\frac{\\Sigma_{\\text{naive}}(N_{\\max}) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}} = \\frac{\\sigma_{\\mathrm{incl}} \\left(\\sum_{n=0}^{N_{\\max}} P(n)\\right) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}} = \\left(\\sum_{n=0}^{N_{\\max}} P(n)\\right) - 1 $$\nSubstituting the Poisson probability $P(n)$:\n$$ \\delta_{\\text{naive}} = \\left(\\sum_{n=0}^{N_{\\max}} \\frac{(\\kappa L)^n e^{-\\kappa L}}{n!}\\right) - 1 $$\nThis deviation represents the fraction of the total cross section corresponding to multiplicities greater than $N_{\\max}$, which is truncated in this naive scheme.\n\n### Part 3: UMEPS Unitarity Deviation\n\nThe UMEPS procedure restores unitarity by construction. The cross sections for $n  N_{\\max}$ are unchanged ($\\sigma_n^{\\text{UMEPS}} = \\sigma_n$), while the highest multiplicity bin is defined to absorb the remainder of the cross section:\n$$ \\sigma_{N_{\\max}}^{\\text{UMEPS}} \\equiv \\sigma_{\\mathrm{incl}} - \\sum_{n=0}^{N_{\\max}-1} \\sigma_n $$\nThe total UMEPS cross section is the sum of these contributions:\n$$ \\Sigma_{\\text{UMEPS}}(N_{\\max}) = \\sum_{n=0}^{N_{\\max}} \\sigma_n^{\\text{UMEPS}} = \\left(\\sum_{n=0}^{N_{\\max}-1} \\sigma_n^{\\text{UMEPS}}\\right) + \\sigma_{N_{\\max}}^{\\text{UMEPS}} $$\nSubstituting the definitions:\n$$ \\Sigma_{\\text{UMEPS}}(N_{\\max}) = \\left(\\sum_{n=0}^{N_{\\max}-1} \\sigma_n\\right) + \\left(\\sigma_{\\mathrm{incl}} - \\sum_{n=0}^{N_{\\max}-1} \\sigma_n\\right) = \\sigma_{\\mathrm{incl}} $$\nThe total cross section is exactly conserved. The fractional deviation is therefore:\n$$ \\delta_{\\text{UMEPS}} = \\frac{\\Sigma_{\\text{UMEPS}}(N_{\\max}) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}} = \\frac{\\sigma_{\\mathrm{incl}} - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}} = 0 $$\nThis result holds analytically for any valid set of parameters.\n\n### Part 4: Computational Implementation\n\nThe program will implement the derived formulas. For each test case, the algorithm is:\n1.  Read the parameters: $\\sigma_{\\mathrm{incl}}$, $Q_{\\max}$, $Q_{\\mathrm{cut}}$, $\\bar{\\alpha}$, $C$, and $N_{\\max}$.\n2.  Calculate the effective emission rate $\\kappa = \\bar{\\alpha} C$.\n3.  Calculate the logarithmic range $L = \\ln(Q_{\\max}/Q_{\\mathrm{cut}})$. If $Q_{\\max} \\le Q_{\\mathrm{cut}}$, $L$ is set to $0$.\n4.  Calculate the Poisson mean $\\lambda = \\kappa L$.\n5.  Calculate $\\delta_{\\text{naive}} = (\\sum_{n=0}^{N_{\\max}} \\frac{\\lambda^n e^{-\\lambda}}{n!}) - 1$.\n6.  Set $\\delta_{\\text{UMEPS}} = 0.0$.\n7.  Return the pair $[\\delta_{\\text{naive}}, \\delta_{\\text{UMEPS}}]$.\nThe program will execute this for all specified test cases and format the output as requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the UMEPS unitarization problem for a suite of test cases.\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    # Each tuple contains: (sigma_incl, Q_max, Q_cut, alpha_bar, C, N_max)\n    test_cases = [\n        # Case A (general case)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 20.0, 'alpha_bar': 0.2, 'C': 0.5, 'N_max': 2},\n        # Case B (large logarithm)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 1.0, 'alpha_bar': 0.3, 'C': 1.0, 'N_max': 2},\n        # Case C (near-threshold)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 900.0, 'alpha_bar': 0.5, 'C': 0.8, 'N_max': 3},\n        # Case D (zero acceptance edge)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 100.0, 'alpha_bar': 0.2, 'C': 0.0, 'N_max': 4},\n        # Case E (very large tail, small N_max)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 0.5, 'alpha_bar': 0.5, 'C': 1.0, 'N_max': 1},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = calculate_deviations(\n            case['Q_max'], \n            case['Q_cut'], \n            case['alpha_bar'], \n            case['C'], \n            case['N_max']\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, e.g., [[-0.1, 0.0], [-0.2, 0.0]]\n    # map(str, results) correctly handles converting inner lists to string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_deviations(Q_max, Q_cut, alpha_bar, C, N_max):\n    \"\"\"\n    Calculates the naive and UMEPS fractional deviations from unitarity.\n\n    Args:\n        Q_max (float): The hard scale in GeV.\n        Q_cut (float): The merging scale in GeV.\n        alpha_bar (float): The dimensionless effective coupling.\n        C (float): The phase-space acceptance fraction.\n        N_max (int): The maximum resolved multiplicity.\n\n    Returns:\n        list: A list containing [delta_naive, delta_umeps].\n    \"\"\"\n    \n    # 1. Calculate the effective emission rate per unit logarithmic scale, kappa.\n    kappa = alpha_bar * C\n\n    # 2. Calculate the logarithmic range, L.\n    # The physical regime is Q_max  Q_cut. If Q_max = Q_cut, L must be non-positive.\n    # By convention, if Q_max = Q_cut, there is no phase space for emission, so L=0.\n    if Q_max = Q_cut:\n        L = 0.0\n    else:\n        L = np.log(Q_max / Q_cut)\n    \n    # 3. Calculate the mean of the Poisson distribution, lambda.\n    lmbda = kappa * L\n\n    # 4. Calculate the sum of probabilities for n=0 to N_max.\n    # P(n) = (lambda^n * exp(-lambda)) / n!\n    sum_P_naive = 0.0\n    \n    # The case lambda = 0 is special. P(0) = 1, P(n0) = 0.\n    if lmbda == 0:\n        sum_P_naive = 1.0\n    else:\n        # Sum the Poisson probabilities from n=0 to N_max.\n        # Direct summation is numerically stable for the small N_max values in test cases.\n        exp_neg_lmbda = np.exp(-lmbda)\n        for n in range(N_max + 1):\n            prob_n = (lmbda**n * exp_neg_lmbda) / math.factorial(n)\n            sum_P_naive += prob_n\n\n    # 5. Calculate the naive fractional deviation.\n    delta_naive = sum_P_naive - 1.0\n    \n    # 6. The UMEPS fractional deviation is 0 by construction, as shown in the derivation.\n    delta_umeps = 0.0\n    \n    return [delta_naive, delta_umeps]\n\nsolve()\n```", "id": "3521626"}]}