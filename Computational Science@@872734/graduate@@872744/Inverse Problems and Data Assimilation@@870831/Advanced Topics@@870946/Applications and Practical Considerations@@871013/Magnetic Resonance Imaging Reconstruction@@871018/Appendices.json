{"hands_on_practices": [{"introduction": "This problem provides a practical, computational entry point into MRI reconstruction. By simulating the process from a known phantom image to its k-space representation and back, you will directly visualize the consequences of different k-space sampling strategies. This exercise [@problem_id:2391669] is fundamental for building an intuitive understanding of how artifacts like aliasing and blurring arise from undersampling, setting the stage for more advanced reconstruction techniques.", "problem": "Construct a program that performs a discrete simulation of Magnetic Resonance Imaging (MRI) reconstruction by populating the two-dimensional discrete Fourier domain (often called \"k-space\") on a discrete grid along specified sampling sets, followed by reconstruction via a two-dimensional inverse transform. The program must implement the following mathematically precise definitions and produce quantitative error metrics for a fixed test suite.\n\nDefinitions:\n- Let $N$ be a positive even integer. Define a discrete image $g[n,m]$ for $n \\in \\{0,\\dots,N-1\\}$ and $m \\in \\{0,\\dots,N-1\\}$ by\n$$\nx_n = \\frac{n - N/2}{N}, \\quad y_m = \\frac{m - N/2}{N},\n$$\nand\n$$\ng[n,m] = \\exp\\!\\left(-\\frac{(x_n - a_1)^2 + (y_m - b_1)^2}{2 \\sigma_1^2}\\right) + \\alpha \\exp\\!\\left(-\\frac{(x_n - a_2)^2 + (y_m - b_2)^2}{2 \\sigma_2^2}\\right),\n$$\nwith parameters fixed to $a_1 = 0.15$, $b_1 = -0.10$, $\\sigma_1 = 0.08$, $\\alpha = 0.8$, $a_2 = -0.20$, $b_2 = 0.25$, $\\sigma_2 = 0.12$. All quantities are dimensionless.\n- Define the two-dimensional Discrete Fourier Transform (DFT) of $g[n,m]$ by\n$$\nG[k,\\ell] = \\sum_{n=0}^{N-1}\\sum_{m=0}^{N-1} g[n,m] \\exp\\!\\left(-2\\pi i \\left(\\frac{k n}{N} + \\frac{\\ell m}{N}\\right)\\right),\n$$\nfor $k,\\ell \\in \\{0,\\dots,N-1\\}$.\n- Define the \"centered\" Fourier array $K[p,q]$ by the index-shift\n$$\nK[p,q] = G[(p + N/2) \\bmod N,\\; (q + N/2) \\bmod N],\n$$\nfor $p,q \\in \\{0,\\dots,N-1\\}$. In this representation, the zero spatial frequency is located at the array index $(p,q) = (N/2, N/2)$.\n- Let a sampling set $S \\subseteq \\{0,\\dots,N-1\\}^2$ specify which indices in the centered array are retained. The sampled centered Fourier array is\n$$\n\\widetilde{K}[p,q] = \\begin{cases}\nK[p,q],  \\text{if } (p,q) \\in S,\\\\\n0,  \\text{otherwise,}\n\\end{cases}\n$$\nand the uncentered sampled array is obtained by the inverse shift\n$$\n\\widetilde{G}[k,\\ell] = \\widetilde{K}[(k - N/2) \\bmod N,\\; (\\ell - N/2) \\bmod N].\n$$\n- The reconstructed image is the inverse DFT\n$$\n\\widetilde{g}[n,m] = \\frac{1}{N^2} \\sum_{k=0}^{N-1}\\sum_{\\ell=0}^{N-1} \\widetilde{G}[k,\\ell] \\exp\\!\\left(2\\pi i \\left(\\frac{k n}{N} + \\frac{\\ell m}{N}\\right)\\right).\n$$\n- Define the normalized root-mean-square error (NRMSE) as the dimensionless scalar\n$$\n\\mathrm{NRMSE} = \\frac{\\left\\| \\widetilde{g} - g \\right\\|_2}{\\left\\| g \\right\\|_2},\n$$\nwhere $\\|\\cdot\\|_2$ denotes the Euclidean norm over all $N^2$ pixels and only the real part of $\\widetilde{g}$ is used in the difference.\n\nSampling set construction rules:\n- Let $c = N/2$ (an integer) denote the centered index. All angles are in radians.\n- Rounding rule: whenever a real-valued coordinate is to be mapped to a discrete index, it must be rounded to the nearest integer using \"round half to even\" (ties go to the nearest even integer).\n- Define $R_{\\max} = \\lfloor N/2 \\rfloor$.\n\nSpecify the following four test cases with $N = 64$:\n1. Full Cartesian sampling:\n   - Sampling set $S_{\\mathrm{full}} = \\{0,\\dots,N-1\\} \\times \\{0,\\dots,N-1\\}$, meaning all centered Fourier coefficients are retained.\n2. Radial spokes through the center:\n   - Let $M = 16$. For each $j \\in \\{0,\\dots,M-1\\}$, define $\\theta_j = j \\pi / M$. For each radius $r \\in \\{0,1,\\dots,R_{\\max}\\}$, generate a point\n   $$\n   p = c + \\operatorname{round}\\!\\left(r \\cos \\theta_j\\right), \\quad q = c + \\operatorname{round}\\!\\left(r \\sin \\theta_j\\right),\n   $$\n   using the specified rounding rule, and include $(p,q)$ in $S_{\\mathrm{rad}}$ if $0 \\le p  N$ and $0 \\le q  N$. The final sampling set is the union over all $j$ and $r$ (duplicates, if any, are inconsequential).\n3. Archimedean spiral through the center:\n   - Let $L = 3$ (number of turns) and $\\Delta\\theta = \\pi/128$. For $s \\in \\{0,1,\\dots,S\\}$ with $S = \\left\\lfloor \\frac{2\\pi L}{\\Delta\\theta} \\right\\rfloor$, define $\\theta_s = s \\Delta \\theta$ and radius\n   $$\n   r_s = \\frac{R_{\\max}}{2\\pi L} \\theta_s.\n   $$\n   Generate\n   $$\n   p = c + \\operatorname{round}\\!\\left(r_s \\cos \\theta_s\\right), \\quad q = c + \\operatorname{round}\\!\\left(r_s \\sin \\theta_s\\right),\n   $$\n   and include $(p,q)$ in $S_{\\mathrm{spi}}$ if $0 \\le p  N$ and $0 \\le q  N$.\n4. Low-pass square centered region:\n   - Let $K_c = 8$. Include all $(p,q)$ satisfying $|p - c| \\le K_c$ and $|q - c| \\le K_c$ in $S_{\\mathrm{lp}}$.\n\nFor each test case $t \\in \\{\\mathrm{full}, \\mathrm{rad}, \\mathrm{spi}, \\mathrm{lp}\\}$:\n- Construct $g[n,m]$ for $N = 64$ and the given parameters.\n- Compute $G[k,\\ell]$, $K[p,q]$, form $\\widetilde{K}$ by applying the specified sampling set $S_t$, obtain $\\widetilde{G}[k,\\ell]$ via inverse shift, and finally compute $\\widetilde{g}[n,m]$.\n- Compute the NRMSE as defined above.\n\nFinal output format:\n- Your program should produce a single line of output containing the four NRMSE values corresponding to the test cases in the order $\\left[\\mathrm{full}, \\mathrm{rad}, \\mathrm{spi}, \\mathrm{lp}\\right]$, as a comma-separated list enclosed in square brackets, for example, \"[$x_1,x_2,x_3,x_4$]\". Each entry must be a floating-point number.\n\nAngle unit specification: all angles are in radians. There are no physical units required; all quantities are dimensionless.", "solution": "The problem statement has been evaluated and is found to be valid. It is scientifically grounded in the principles of magnetic resonance imaging and digital signal processing, mathematically well-posed, and free of ambiguity. All definitions, parameters, and procedures are specified with sufficient rigor to permit a unique and verifiable solution.\n\nThe task is to simulate the reconstruction of a two-dimensional image from its Fourier-domain data, which has been subsampled according to various patterns. This process is central to Magnetic Resonance Imaging (MRI), where the Fourier-domain data, known as k-space, is acquired sequentially. The quality of the reconstructed image depends critically on which k-space samples are acquired. We will calculate the Normalized Root-Mean-Square Error (NRMSE) to quantify this quality for four different sampling schemes.\n\nThe procedure is as follows:\n\n1.  **Phantom Image Generation**:\n    First, we construct the original discrete image $g[n,m]$, which serves as the \"ground truth\". The image is defined on a grid of size $N \\times N$, with $N=64$. The spatial coordinates $(x_n, y_m)$ are normalized to the domain $[-0.5, 0.5)$. The image itself is a superposition of two Gaussian functions, representing a simplified biological structure.\n    The coordinates are given by:\n    $$\n    x_n = \\frac{n - N/2}{N}, \\quad y_m = \\frac{m - N/2}{N} \\quad \\text{for } n,m \\in \\{0, \\dots, N-1\\}\n    $$\n    The image intensity is:\n    $$\n    g[n,m] = \\exp\\!\\left(-\\frac{(x_n - a_1)^2 + (y_m - b_1)^2}{2 \\sigma_1^2}\\right) + \\alpha \\exp\\!\\left(-\\frac{(x_n - a_2)^2 + (y_m - b_2)^2}{2 \\sigma_2^2}\\right)\n    $$\n    with the provided parameters: $a_1 = 0.15$, $b_1 = -0.10$, $\\sigma_1 = 0.08$, $\\alpha = 0.8$, $a_2 = -0.20$, $b_2 = 0.25$, and $\\sigma_2 = 0.12$. Since $g[n,m]$ is a sum of real-valued exponential functions, it is a real-valued array.\n\n2.  **Fourier Transformation (k-space generation)**:\n    The MRI signal acquisition process samples the Fourier transform of the image. We simulate the complete set of Fourier coefficients by computing the two-dimensional Discrete Fourier Transform (DFT) of $g[n,m]$:\n    $$\n    G[k,\\ell] = \\sum_{n=0}^{N-1}\\sum_{m=0}^{N-1} g[n,m] \\exp\\!\\left(-2\\pi i \\left(\\frac{k n}{N} + \\frac{\\ell m}{N}\\right)\\right)\n    $$\n    This is efficiently computed using a Fast Fourier Transform (FFT) algorithm. By convention in digital signal processing, the zero-frequency component ($k=0, \\ell=0$) is located at the origin of the array `G`. For processing and visualization, it is standard practice to shift this component to the center of the array. This centered array is denoted $K[p,q]$:\n    $$\n    K[p,q] = G[(p + N/2) \\bmod N,\\; (q + N/2) \\bmod N]\n    $$\n    This operation places the low spatial frequencies at the center and high spatial frequencies at the periphery of the $K$-space array, which reflects how k-space is typically conceptualized in MRI.\n\n3.  **k-space Sampling**:\n    We then simulate partial k-space acquisition by creating a binary mask corresponding to a sampling set $S$. For each of the four test cases, we construct a unique set $S$. The sampled k-space, $\\widetilde{K}[p,q]$, is obtained by element-wise multiplication of the full k-space $K[p,q]$ with this mask:\n    $$\n    \\widetilde{K}[p,q] = \\begin{cases}\n    K[p,q],  \\text{if } (p,q) \\in S,\\\\\n    0,  \\text{otherwise.}\n    \\end{cases}\n    $$\n    The four sampling sets $S_t$ are constructed according to the rules provided:\n    -   $S_{\\mathrm{full}}$: A trivial case where the mask is all ones, representing complete data acquisition.\n    -   $S_{\\mathrm{rad}}$: A set of $M=16$ radial lines (spokes) passing through the center of k-space.\n    -   $S_{\\mathrm{spi}}$: An Archimedean spiral trajectory with $L=3$ turns.\n    -   $S_{\\mathrm{lp}}$: A square low-pass filter, retaining only the central $17 \\times 17$ region of k-space.\n    For the radial and spiral cases, floating-point coordinates are mapped to the discrete grid indices using the \"round half to even\" rule, which is the default behavior of Python 3's `round()` function.\n\n4.  **Image Reconstruction**:\n    To reconstruct the image from the sampled k-space data, we must first reverse the centering operation:\n    $$\n    \\widetilde{G}[k,\\ell] = \\widetilde{K}[(k - N/2) \\bmod N,\\; (\\ell - N/2) \\bmod N]\n    $$\n    This places the zero-frequency component back at the origin of the array, as required by the standard inverse DFT algorithm. The reconstructed image $\\widetilde{g}[n,m]$ is then computed via the inverse DFT:\n    $$\n    \\widetilde{g}[n,m] = \\frac{1}{N^2} \\sum_{k=0}^{N-1}\\sum_{\\ell=0}^{N-1} \\widetilde{G}[k,\\ell] \\exp\\!\\left(2\\pi i \\left(\\frac{k n}{N} + \\frac{\\ell m}{N}\\right)\\right)\n    $$\n    The factor of $1/N^2$ is the standard normalization for the inverse DFT. This is also computed efficiently using an inverse FFT algorithm. Because data was discarded from k-space, $\\widetilde{K}$ will generally not possess the conjugate symmetry required for its inverse Fourier transform to be purely real. Thus, $\\widetilde{g}[n,m]$ will be a complex-valued array.\n\n5.  **Error Quantification**:\n    Finally, we quantify the degradation in image quality due to the incomplete sampling. The Normalized Root-Mean-Square Error (NRMSE) is calculated. As specified, the error is computed between the original real-valued image $g$ and the real part of the reconstructed complex-valued image $\\widetilde{g}$:\n    $$\n    \\mathrm{NRMSE} = \\frac{\\left\\| \\mathrm{Re}(\\widetilde{g}) - g \\right\\|_2}{\\left\\| g \\right\\|_2}\n    $$\n    Here, $\\|\\cdot\\|_2$ is the Euclidean (or Frobenius) norm, calculated over all $N^2$ pixel values. This metric provides a dimensionless measure of the average reconstruction error, normalized by the \"energy\" of the original image.\n\nThis entire procedure will be executed for each of the four specified k-space sampling strategies, and the resulting NRMSE values will be reported.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates MRI reconstruction for different k-space sampling patterns\n    and calculates the Normalized Root-Mean-Square Error (NRMSE) for each.\n    \"\"\"\n    # Define problem parameters\n    N = 64\n    params_g = {\n        'a1': 0.15, 'b1': -0.10, 'sigma1': 0.08,\n        'alpha': 0.8,\n        'a2': -0.20, 'b2': 0.25, 'sigma2': 0.12\n    }\n    \n    # 1. Phantom Image Generation\n    def create_phantom(N, params):\n        n = np.arange(N)\n        m = np.arange(N)\n        x_n = (n - N / 2) / N\n        y_m = (m - N / 2) / N\n        xx, yy = np.meshgrid(x_n, y_m, indexing='ij')\n\n        g1 = np.exp(-((xx - params['a1'])**2 + (yy - params['b1'])**2) / (2 * params['sigma1']**2))\n        g2 = params['alpha'] * np.exp(-((xx - params['a2'])**2 + (yy - params['b2'])**2) / (2 * params['sigma2']**2))\n        \n        return g1 + g2\n\n    # 3. k-space Sampling Mask Generation\n    def get_sampling_mask(sampling_type, N):\n        mask = np.zeros((N, N), dtype=bool)\n        c = N / 2\n        R_max = np.floor(N / 2)\n\n        if sampling_type == 'full':\n            mask[:, :] = True\n            \n        elif sampling_type == 'rad':\n            M = 16\n            for j in range(M):\n                theta_j = j * np.pi / M\n                cos_theta = np.cos(theta_j)\n                sin_theta = np.sin(theta_j)\n                for r in range(int(R_max) + 1):\n                    p_float = c + r * cos_theta\n                    q_float = c + r * sin_theta\n                    p = int(round(p_float))\n                    q = int(round(q_float))\n                    if 0 = p  N and 0 = q  N:\n                        mask[p, q] = True\n\n        elif sampling_type == 'spi':\n            L = 3\n            delta_theta = np.pi / 128\n            S = int(np.floor(2 * np.pi * L / delta_theta))\n            for s_idx in range(S + 1):\n                theta_s = s_idx * delta_theta\n                r_s = (R_max / (2 * np.pi * L)) * theta_s\n                p_float = c + r_s * np.cos(theta_s)\n                q_float = c + r_s * np.sin(theta_s)\n                p = int(round(p_float))\n                q = int(round(q_float))\n                if 0 = p  N and 0 = q  N:\n                    mask[p, q] = True\n        \n        elif sampling_type == 'lp':\n            K_c = 8\n            c_int = int(c)\n            p_start, p_end = c_int - K_c, c_int + K_c\n            q_start, q_end = c_int - K_c, c_int + K_c\n            mask[p_start : p_end + 1, q_start : q_end + 1] = True\n        \n        else:\n            raise ValueError(\"Unknown sampling type\")\n            \n        return mask\n\n    # Execute simulation for each test case\n    g_true = create_phantom(N, params_g)\n    norm_g_true = np.linalg.norm(g_true)\n    \n    # 2. Fourier Transformation\n    G = np.fft.fft2(g_true)\n    K = np.fft.fftshift(G)\n    \n    results = []\n    test_cases = ['full', 'rad', 'spi', 'lp']\n\n    for case_name in test_cases:\n        # 3. Apply Sampling\n        sampling_mask = get_sampling_mask(case_name, N)\n        K_tilde = K * sampling_mask\n        \n        # 4. Image Reconstruction\n        G_tilde = np.fft.ifftshift(K_tilde)\n        g_tilde = np.fft.ifft2(G_tilde)\n        \n        # 5. Error Quantification\n        g_tilde_real = np.real(g_tilde)\n        nrmse = np.linalg.norm(g_tilde_real - g_true) / norm_g_true\n        results.append(nrmse)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2391669"}, {"introduction": "Building upon the visual intuition from the first practice, this exercise delves into the theoretical underpinnings that govern MRI acquisition. You will derive the fundamental relationships between the object's size (Field of View), the k-space sampling interval, and the achievable spatial resolution from first principles. This practice [@problem_id:3399736] is crucial for understanding the classic trade-offs in pulse sequence design and for appreciating the limitations that modern techniques like compressed sensing aim to overcome.", "problem": "Consider one-dimensional Magnetic Resonance Imaging (MRI) reconstruction under the standard non-unitary Fourier transform convention used in MRI, where the object $x(r)$ and its $k$-space transform $X(k)$ satisfy\n$$\nX(k) = \\int_{-\\infty}^{\\infty} x(r)\\,\\exp(-i\\,2\\pi\\,k\\,r)\\,dr,\\qquad\nx(r) = \\int_{-\\infty}^{\\infty} X(k)\\,\\exp(i\\,2\\pi\\,k\\,r)\\,dk.\n$$\nAssume a finite support model on the object $x(r)$: there exists a finite length $L0$ such that $x(r)=0$ for $|r|\\frac{L}{2}$. Suppose $k$-space is sampled uniformly on a Cartesian grid with sampling interval $\\Delta k0$, i.e., at locations $k_n=n\\,\\Delta k$ for integer $n$, and suppose the number of acquired samples is $N$ such that the $k$-space window is symmetric and approximately spans $[-K_{\\max},K_{\\max}]$ with $K_{\\max}\\approx \\frac{N\\,\\Delta k}{2}$. The reconstructed image is obtained by a discrete inverse Fourier transform corresponding to the chosen sampling.\n\nStarting from the above Fourier transform definitions and fundamental sampling theory (Dirac comb sampling and the Poisson summation formula), derive symbolically the largest allowable sampling interval in $k$-space, denoted $\\Delta k^{\\star}$, such that aliasing is avoided under the finite support model on $x(r)$. Then, using a physically meaningful resolution metric based on the main-lobe zero crossing of the point spread function (PSF) induced by a finite $k$-space window, derive an analytic expression for the nominal spatial resolution $\\delta r$ in terms of the Field of View (FOV) and the number of samples $N$. Here, define the Field of View by $\\mathrm{FOV} = \\frac{1}{\\Delta k}$, consistent with the above Fourier convention.\n\nFinally, evaluate both quantities numerically for the following parameters: support length $L = 0.18\\,\\mathrm{m}$, Field of View $\\mathrm{FOV} = 0.25\\,\\mathrm{m}$, and number of samples $N=256$. Express $\\Delta k^{\\star}$ in $\\mathrm{m}^{-1}$ and $\\delta r$ in $\\mathrm{mm}$. Round each numerical value to four significant figures.\n\nYour final answer must consist of the pair $\\left(\\Delta k^{\\star},\\,\\delta r\\right)$.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and self-contained. It contains no logical contradictions or factual unsoundness. We may therefore proceed with a formal solution.\n\nThe problem is divided into two main parts: first, the derivation of the condition to avoid aliasing based on fundamental sampling theory, which yields the maximum permissible $k$-space sampling interval $\\Delta k^{\\star}$; second, the derivation of the spatial resolution $\\delta r$ based on the point spread function (PSF) resulting from a finite $k$-space acquisition window.\n\n**Part 1: Derivation of the Maximum Sampling Interval $\\Delta k^{\\star}$**\n\nThe relationship between the one-dimensional object $x(r)$ and its $k$-space representation $X(k)$ is given by the Fourier transform pair:\n$$X(k) = \\int_{-\\infty}^{\\infty} x(r) \\exp(-i 2\\pi kr) dr$$\n$$x(r) = \\int_{-\\infty}^{\\infty} X(k) \\exp(i 2\\pi kr) dk$$\nSampling in $k$-space at discrete locations $k_n = n \\Delta k$ for integer $n$ can be modeled by multiplying the continuous signal $X(k)$ by a Dirac comb function, $S(k) = \\sum_{n=-\\infty}^{\\infty} \\delta(k - n\\Delta k)$, where $\\delta(\\cdot)$ is the Dirac delta function. The sampled $k$-space signal is thus $X_s(k) = X(k) \\cdot S(k)$.\n\nThe reconstructed image, which we denote as $x_{rep}(r)$, is the inverse Fourier transform of the sampled data $X_s(k)$:\n$$x_{rep}(r) = \\mathcal{F}^{-1}\\{X_s(k)\\} = \\mathcal{F}^{-1}\\{X(k) \\cdot S(k)\\}$$\nThe convolution theorem states that multiplication in the frequency domain is equivalent to convolution in the time domain (here, the $k$-domain and $r$-domain, respectively).\n$$x_{rep}(r) = \\left(\\mathcal{F}^{-1}\\{X(k)\\}\\right) * \\left(\\mathcal{F}^{-1}\\{S(k)\\}\\right) = x(r) * s(r)$$\nwhere $s(r)$ is the inverse Fourier transform of the sampling function $S(k)$. We compute $s(r)$:\n$$s(r) = \\mathcal{F}^{-1}\\left\\{\\sum_{n=-\\infty}^{\\infty} \\delta(k - n\\Delta k)\\right\\} = \\int_{-\\infty}^{\\infty} \\left(\\sum_{n=-\\infty}^{\\infty} \\delta(k - n\\Delta k)\\right) \\exp(i 2\\pi kr) dk$$\nBy linearity, we can swap the integral and summation:\n$$s(r) = \\sum_{n=-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\delta(k - n\\Delta k) \\exp(i 2\\pi kr) dk$$\nUsing the sifting property of the Dirac delta function, $\\int f(\\xi)\\delta(\\xi - \\xi_0)d\\xi = f(\\xi_0)$, we obtain:\n$$s(r) = \\sum_{n=-\\infty}^{\\infty} \\exp(i 2\\pi (n\\Delta k) r)$$\nThis is the Fourier series representation of a periodic train of Dirac delta functions. Based on the Poisson summation formula, this sum is equivalent to:\n$$s(r) = \\frac{1}{\\Delta k} \\sum_{m=-\\infty}^{\\infty} \\delta\\left(r - \\frac{m}{\\Delta k}\\right)$$\nSubstituting this back into the expression for $x_{rep}(r)$:\n$$x_{rep}(r) = x(r) * \\left(\\frac{1}{\\Delta k} \\sum_{m=-\\infty}^{\\infty} \\delta\\left(r - \\frac{m}{\\Delta k}\\right)\\right)$$\nThe convolution with a shifted delta function results in a shifted function, so:\n$$x_{rep}(r) = \\frac{1}{\\Delta k} \\sum_{m=-\\infty}^{\\infty} x\\left(r - \\frac{m}{\\Delta k}\\right)$$\nThis result shows that the reconstructed image consists of infinitely many replicas of the original object $x(r)$, centered at positions $r_m = m/\\Delta k$ and scaled by $1/\\Delta k$.\n\nAliasing is the overlapping of these replicas. The problem states that the object $x(r)$ has a finite support of length $L$, i.e., $x(r) = 0$ for $|r|  L/2$. The support of the central replica ($m=0$) is the interval $[-L/2, L/2]$. The support of the adjacent replica ($m=1$) is the interval $[1/\\Delta k - L/2, 1/\\Delta k + L/2]$. To prevent aliasing, these supports must not overlap. The condition is that the upper bound of the central replica's support must be less than or equal to the lower bound of the adjacent replica's support:\n$$\\frac{L}{2} \\le \\frac{1}{\\Delta k} - \\frac{L}{2} \\implies L \\le \\frac{1}{\\Delta k}$$\nThis implies that the sampling interval must satisfy $\\Delta k \\le 1/L$. The largest allowable sampling interval, $\\Delta k^{\\star}$, is the one that satisfies this condition at its limit:\n$$\\Delta k^{\\star} = \\frac{1}{L}$$\n\n**Part 2: Derivation of the Nominal Spatial Resolution $\\delta r$**\n\nA finite number of samples $N$ are acquired over a symmetric $k$-space window of total width $2K_{\\max}$. This is modeled by multiplying the ideal $k$-space data $X(k)$ by a rectangular window function $W(k) = \\mathrm{rect}(k/(2K_{\\max}))$, which is $1$ for $|k| \\le K_{\\max}$ and $0$ otherwise. The reconstructed image $x_{recon}(r)$ is then the convolution of the true object $x(r)$ with the Point Spread Function (PSF), which is the inverse Fourier transform of the window $W(k)$:\n$$x_{recon}(r) = x(r) * \\mathrm{PSF}(r)$$\nThe PSF is calculated as:\n$$\\mathrm{PSF}(r) = \\mathcal{F}^{-1}\\{W(k)\\} = \\int_{-K_{\\max}}^{K_{\\max}} 1 \\cdot \\exp(i 2\\pi kr) dk$$\n$$\\mathrm{PSF}(r) = \\left[ \\frac{\\exp(i 2\\pi kr)}{i 2\\pi r} \\right]_{-K_{\\max}}^{K_{\\max}} = \\frac{\\exp(i 2\\pi K_{\\max} r) - \\exp(-i 2\\pi K_{\\max} r)}{i 2\\pi r}$$\nUsing Euler's identity $\\sin(\\theta) = (\\exp(i\\theta) - \\exp(-i\\theta))/(2i)$, we simplify the expression:\n$$\\mathrm{PSF}(r) = \\frac{2i\\sin(2\\pi K_{\\max} r)}{i 2\\pi r} = \\frac{\\sin(2\\pi K_{\\max} r)}{\\pi r}$$\nThis is an unnormalized sinc function. The nominal resolution $\\delta r$ is defined by the main-lobe zero crossing, which corresponds to the distance from the central peak at $r=0$ to the first zero of the PSF. The zeros occur when the argument of the sine function is an integer multiple of $\\pi$. The first non-zero-crossing occurs when:\n$$|2\\pi K_{\\max} r| = \\pi \\implies |r| = \\frac{1}{2K_{\\max}}$$\nThus, the resolution is $\\delta r = 1/(2K_{\\max})$.\nThe total width of the $k$-space acquisition is given as $2K_{\\max} \\approx N \\Delta k$. Substituting this into the expression for $\\delta r$:\n$$\\delta r = \\frac{1}{N \\Delta k}$$\nThe problem defines the Field of View as $\\mathrm{FOV} = 1/\\Delta k$. Using this definition, we obtain the final expression for the nominal spatial resolution:\n$$\\delta r = \\frac{\\mathrm{FOV}}{N}$$\n\n**Part 3: Numerical Evaluation**\n\nGiven parameters: $L = 0.18\\,\\mathrm{m}$, $\\mathrm{FOV} = 0.25\\,\\mathrm{m}$, and $N=256$.\n\n1.  **Evaluation of $\\Delta k^{\\star}$**:\n    $$\\Delta k^{\\star} = \\frac{1}{L} = \\frac{1}{0.18\\,\\mathrm{m}} \\approx 5.5555... \\,\\mathrm{m}^{-1}$$\n    Rounding to four significant figures, we get $\\Delta k^{\\star} = 5.556\\,\\mathrm{m}^{-1}$.\n\n2.  **Evaluation of $\\delta r$**:\n    $$\\delta r = \\frac{\\mathrm{FOV}}{N} = \\frac{0.25\\,\\mathrm{m}}{256} = 0.0009765625\\,\\mathrm{m}$$\n    The problem requests the result in millimeters ($1\\,\\mathrm{m} = 1000\\,\\mathrm{mm}$):\n    $$\\delta r = 0.0009765625 \\times 1000\\,\\mathrm{mm} = 0.9765625\\,\\mathrm{mm}$$\n    Rounding to four significant figures, we get $\\delta r = 0.9766\\,\\mathrm{mm}$.\n\nThe resulting pair $(\\Delta k^{\\star}, \\delta r)$ contains the numerical values derived.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.556  0.9766\n\\end{pmatrix}\n}\n$$", "id": "3399736"}, {"introduction": "This final practice transitions from classical Fourier imaging to the modern framework of compressed sensing (CS), which enables reconstruction from far fewer samples than required by the Nyquist theorem. You will compute a key metric, the Restricted Isometry Property (RIP) constant, for a specific undersampled acquisition, providing a concrete measure of its suitability for sparse recovery. Through this calculation [@problem_id:3399804] and the accompanying conceptual analysis, you will gain insight into the mathematical guarantees that make CS-MRI a powerful and clinically viable technology.", "problem": "Consider a one-dimensional Magnetic Resonance Imaging (MRI) acquisition modeled by a partial Discrete Fourier Transform (DFT) with a variable-density sampling mask in $k$-space. Let the image be represented as a complex-valued vector $x \\in \\mathbb{C}^{N}$ with $N = 8$. The encoding operator is the unitary DFT matrix $F \\in \\mathbb{C}^{8 \\times 8}$ with entries $F_{k,n} = \\frac{1}{\\sqrt{8}}\\exp\\!\\left(- i \\frac{2\\pi}{8} k n\\right)$ for $k,n \\in \\{0,1,\\dots,7\\}$. A variable-density sampling mask selects $M = 4$ frequency indices $S = \\{0,1,3,6\\}$. The measurement operator $A \\in \\mathbb{C}^{4 \\times 8}$ is formed by taking the rows of $F$ indexed by $S$. To ensure unit-norm columns, the operator is column-normalized by the factor $\\sqrt{\\frac{N}{M}}$, so the normalized sensing matrix is $\\tilde{A} = \\sqrt{\\frac{N}{M}}\\,A$.\n\nDefine the mutual coherence of $\\tilde{A}$ as $\\mu(\\tilde{A}) = \\max_{i \\neq j} |\\langle \\tilde{a}_{i}, \\tilde{a}_{j} \\rangle|$, where $\\tilde{a}_{i}$ denotes the $i$-th column of $\\tilde{A}$ with unit norm. The Restricted Isometry Property (RIP) constant of order $s$, denoted $\\delta_{s}$, is the smallest constant such that for every $s$-sparse vector $z \\in \\mathbb{C}^{8}$, one has $(1 - \\delta_{s})\\|z\\|_{2}^{2} \\le \\|\\tilde{A}z\\|_{2}^{2} \\le (1 + \\delta_{s})\\|z\\|_{2}^{2}$. Using mutual coherence estimates based on the Gram submatrices associated with $s$-sparse supports, compute an upper bound on $\\delta_{2}$ for the given mask $S = \\{0,1,3,6\\}$.\n\nSpecifically, derive $\\mu(\\tilde{A})$ exactly from first principles and then use a valid mutual-coherence-to-RIP bound to obtain a numerical upper bound on $\\delta_{2}$ for this acquisition. Round your final numerical bound to four significant figures. No units are required for the final answer.\n\nIn addition, explain, starting from first principles in inverse problems and compressed sensing theory, how the magnitude of $\\delta_{s}$ influences the existence of stable and robust recovery guarantees in MRI reconstruction under sparsity-promoting regularization.", "solution": "The problem statement is first validated according to the specified criteria.\n\n**Step 1: Extract Givens**\n-   Image vector: $x \\in \\mathbb{C}^{N}$ with $N = 8$.\n-   DFT matrix: $F \\in \\mathbb{C}^{8 \\times 8}$ with entries $F_{k,n} = \\frac{1}{\\sqrt{8}}\\exp(- i \\frac{2\\pi}{8} k n)$ for $k,n \\in \\{0,1,\\dots,7\\}$.\n-   Sampling mask: $M = 4$ frequency indices $S = \\{0,1,3,6\\}$.\n-   Measurement operator: $A \\in \\mathbb{C}^{4 \\times 8}$ is formed by rows of $F$ indexed by $S$.\n-   Normalized sensing matrix: $\\tilde{A} = \\sqrt{\\frac{N}{M}}\\,A = \\sqrt{\\frac{8}{4}}\\,A = \\sqrt{2}\\,A$.\n-   Mutual coherence: $\\mu(\\tilde{A}) = \\max_{i \\neq j} |\\langle \\tilde{a}_{i}, \\tilde{a}_{j} \\rangle|$, where $\\tilde{a}_{i}$ is the $i$-th column of $\\tilde{A}$. The problem asserts these columns are unit-norm.\n-   Restricted Isometry Property (RIP) constant of order $s$: $\\delta_{s}$ is the smallest constant such that $(1 - \\delta_{s})\\|z\\|_{2}^{2} \\le \\|\\tilde{A}z\\|_{2}^{2} \\le (1 + \\delta_{s})\\|z\\|_{2}^{2}$ for every $s$-sparse vector $z \\in \\mathbb{C}^{8}$.\n-   Objective 1: Compute an upper bound on $\\delta_{2}$ by first deriving $\\mu(\\tilde{A})$ exactly and then using a coherence-based bound.\n-   Objective 2: Round the final numerical bound to four significant figures.\n-   Objective 3: Explain the influence of $\\delta_{s}$ on recovery guarantees in sparsity-promoting MRI reconstruction.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It provides a standard compressed sensing model for MRI acquisition using a partial Fourier matrix. The concepts of mutual coherence and the Restricted Isometry Property are central to this field. All necessary parameters ($N, M, S$) and definitions are provided, making the problem self-contained and mathematically consistent. The normalization factor $\\sqrt{N/M}$ correctly ensures that the columns of the sensing matrix $\\tilde{A}$ are unit-norm, as $\\|\\tilde{a}_j\\|_2^2 = (\\sqrt{N/M})^2 \\sum_{k \\in S} |F_{k,j}|^2 = (N/M) \\sum_{k \\in S} (1/N) = (N/M)(M/N) = 1$. The problem is a tractable, small-scale version of a real-world problem and is solvable as stated.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe solution proceeds in three parts: first, the exact calculation of the mutual coherence $\\mu(\\tilde{A})$; second, the derivation of an upper bound for the RIP constant $\\delta_{2}$ using this coherence value; and third, a conceptual explanation of the role of the RIP in inverse problems.\n\n**Part 1: Calculation of Mutual Coherence $\\mu(\\tilde{A})$**\nThe mutual coherence $\\mu(\\tilde{A})$ is defined as the maximum absolute inner product between distinct columns of the normalized sensing matrix $\\tilde{A}$. The columns of $\\tilde{A}$ are given by $\\tilde{a}_j = \\sqrt{N/M} \\, a_j$, where $a_j$ are the columns of the sub-sampled Fourier matrix $A$. The inner product between two distinct columns $\\tilde{a}_i$ and $\\tilde{a}_j$ (where $i, j \\in \\{0, 1, \\dots, 7\\}$ and $i \\neq j$) is:\n$$\n\\langle \\tilde{a}_{i}, \\tilde{a}_{j} \\rangle = \\left(\\sqrt{\\frac{N}{M}} a_i\\right)^H \\left(\\sqrt{\\frac{N}{M}} a_j\\right) = \\frac{N}{M} \\sum_{k \\in S} (F_{k,i})^* F_{k,j}\n$$\nSubstituting the definition of the DFT matrix entries, $F_{k,n} = \\frac{1}{\\sqrt{N}}\\exp(-i\\frac{2\\pi}{N}kn)$, we get:\n$$\n(F_{k,i})^* F_{k,j} = \\left(\\frac{1}{\\sqrt{N}}\\exp\\left(-i\\frac{2\\pi}{N}ki\\right)\\right)^* \\left(\\frac{1}{\\sqrt{N}}\\exp\\left(-i\\frac{2\\pi}{N}kj\\right)\\right) = \\frac{1}{N}\\exp\\left(i\\frac{2\\pi}{N}ki\\right)\\exp\\left(-i\\frac{2\\pi}{N}kj\\right) = \\frac{1}{N}\\exp\\left(i\\frac{2\\pi}{N}k(i-j)\\right)\n$$\nThe inner product becomes:\n$$\n\\langle \\tilde{a}_{i}, \\tilde{a}_{j} \\rangle = \\frac{N}{M} \\sum_{k \\in S} \\frac{1}{N}\\exp\\left(i\\frac{2\\pi}{N}k(i-j)\\right) = \\frac{1}{M} \\sum_{k \\in S} \\exp\\left(i\\frac{2\\pi}{N}k(i-j)\\right)\n$$\nThis expression depends only on the difference $\\ell = i-j$. We must evaluate its magnitude for all possible non-zero values of $\\ell \\pmod N$. With $N=8$, $M=4$, and $S=\\{0,1,3,6\\}$, we have:\n$$\n|\\langle \\tilde{a}_{i}, \\tilde{a}_{j} \\rangle| = \\frac{1}{4} \\left| \\sum_{k \\in \\{0,1,3,6\\}} \\exp\\left(i\\frac{2\\pi}{8}k\\ell\\right) \\right| = \\frac{1}{4} \\left| \\sum_{k \\in \\{0,1,3,6\\}} \\exp\\left(i\\frac{\\pi}{4}k\\ell\\right) \\right|\n$$\nfor $\\ell = i-j \\in \\{1, 2, \\dots, 7\\}$. We evaluate the sum for each $\\ell$:\n-   For $\\ell=1$: The sum is $1 + \\exp(i\\frac{\\pi}{4}) + \\exp(i\\frac{3\\pi}{4}) + \\exp(i\\frac{6\\pi}{4}) = 1 + (\\frac{\\sqrt{2}}{2}+i\\frac{\\sqrt{2}}{2}) + (-\\frac{\\sqrt{2}}{2}+i\\frac{\\sqrt{2}}{2}) + (-i) = 1 + i(\\sqrt{2}-1)$. The magnitude is $\\sqrt{1^2 + (\\sqrt{2}-1)^2} = \\sqrt{1 + 2 - 2\\sqrt{2} + 1} = \\sqrt{4 - 2\\sqrt{2}}$.\n-   For $\\ell=2$: The sum is $1 + \\exp(i\\frac{2\\pi}{4}) + \\exp(i\\frac{6\\pi}{4}) + \\exp(i\\frac{12\\pi}{4}) = 1 + i - i - 1 = 0$. The magnitude is $0$.\n-   For $\\ell=3$: The sum is $1 + \\exp(i\\frac{3\\pi}{4}) + \\exp(i\\frac{9\\pi}{4}) + \\exp(i\\frac{18\\pi}{4}) = 1 + \\exp(i\\frac{3\\pi}{4}) + \\exp(i\\frac{\\pi}{4}) + \\exp(i\\frac{\\pi}{2}) = 1 + (-\\frac{\\sqrt{2}}{2}+i\\frac{\\sqrt{2}}{2}) + (\\frac{\\sqrt{2}}{2}+i\\frac{\\sqrt{2}}{2}) + i = 1 + i(\\sqrt{2}+1)$. The magnitude is $\\sqrt{1^2 + (\\sqrt{2}+1)^2} = \\sqrt{1 + 2 + 2\\sqrt{2} + 1} = \\sqrt{4 + 2\\sqrt{2}}$.\n-   For $\\ell=4$: The sum is $1 + \\exp(i\\pi) + \\exp(i3\\pi) + \\exp(i6\\pi) = 1 - 1 - 1 + 1 = 0$. The magnitude is $0$.\nThe sum for $\\ell=5=8-3$ gives a magnitude equal to that for $\\ell=3$. The sum for $\\ell=6=8-2$ gives a magnitude of $0$. The sum for $\\ell=7=8-1$ gives a magnitude equal to that for $\\ell=1$. The maximum magnitude of the sum occurs for $\\ell=3$ and $\\ell=5$, which is $\\sqrt{4 + 2\\sqrt{2}}$.\n\nThe mutual coherence is the maximum of these absolute inner products:\n$$\n\\mu(\\tilde{A}) = \\max_{\\ell \\in \\{1,...,7\\}} \\frac{1}{4} \\left|\\sum_{k \\in S} \\exp\\left(i\\frac{\\pi}{4}k\\ell\\right)\\right| = \\frac{1}{4} \\sqrt{4 + 2\\sqrt{2}}\n$$\n\n**Part 2: Upper Bound on the RIP Constant $\\delta_2$**\nThe RIP constant $\\delta_s$ is related to the eigenvalues of all $s \\times s$ Gram submatrices $\\tilde{A}_T^H \\tilde{A}_T$, where $T$ is a support of size $s$. Specifically, $\\delta_s = \\max_{|T|=s} \\|\\tilde{A}_T^H \\tilde{A}_T - I_s\\|_{2 \\to 2}$. For $s=2$, the submatrices are $2 \\times 2$:\n$$\nG_T = \\begin{pmatrix} \\|\\tilde{a}_i\\|_2^2  \\langle \\tilde{a}_j, \\tilde{a}_i \\rangle \\\\ \\langle \\tilde{a}_i, \\tilde{a}_j \\rangle  \\|\\tilde{a}_j\\|_2^2 \\end{pmatrix} = \\begin{pmatrix} 1  \\langle \\tilde{a}_j, \\tilde{a}_i \\rangle \\\\ \\langle \\tilde{a}_i, \\tilde{a}_j \\rangle  1 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of this matrix satisfy $(1-\\lambda)^2 - |\\langle \\tilde{a}_i, \\tilde{a}_j \\rangle|^2 = 0$, which gives $\\lambda = 1 \\pm |\\langle \\tilde{a}_i, \\tilde{a}_j \\rangle|$.\nThe RIP conditions require $1 - \\delta_2 \\le \\lambda_{\\min}$ and $\\lambda_{\\max} \\le 1 + \\delta_2$ for all supports of size $2$.\nThis implies $1 - \\delta_2 \\le \\min_{i \\neq j} (1 - |\\langle \\tilde{a}_i, \\tilde{a}_j \\rangle|) = 1 - \\max_{i \\neq j} |\\langle \\tilde{a}_i, \\tilde{a}_j \\rangle| = 1 - \\mu(\\tilde{A})$.\nAnd $1 + \\delta_2 \\ge \\max_{i \\neq j} (1 + |\\langle \\tilde{a}_i, \\tilde{a}_j \\rangle|) = 1 + \\max_{i \\neq j} |\\langle \\tilde{a}_i, \\tilde{a}_j \\rangle| = 1 + \\mu(\\tilde{A})$.\nBoth inequalities imply $\\delta_2 \\ge \\mu(\\tilde{A})$. Since $\\delta_2$ is defined as the smallest possible constant satisfying the RIP, it follows that for the case $s=2$, the RIP constant is exactly equal to the mutual coherence: $\\delta_2 = \\mu(\\tilde{A})$.\nTherefore, a valid (and in fact, the tightest possible) upper bound for $\\delta_2$ is $\\mu(\\tilde{A})$ itself.\n$$\n\\delta_2 = \\frac{\\sqrt{4 + 2\\sqrt{2}}}{4}\n$$\nNumerically, this value is:\n$$\n\\delta_2 = \\frac{\\sqrt{4 + 2(1.41421356...)}}{4} = \\frac{\\sqrt{6.82842712...}}{4} \\approx \\frac{2.6131259...}{4} \\approx 0.6532814...\n$$\nRounding to four significant figures gives $0.6533$.\n\n**Part 3: Role of $\\delta_s$ in MRI Reconstruction**\nIn inverse problems like MRI reconstruction, the goal is to recover an image $x$ from undersampled measurements $y = Ax$. When $x$ is sparse or has a sparse representation in a transform domain (e.g., wavelets), one can use sparsity-promoting regularization, such as solving $\\min_z \\|z\\|_1$ subject to $y = A_{eff} z$, where $z$ is the sparse coefficient vector. The Restricted Isometry Property (RIP) of the sensing matrix $A_{eff}$ is a cornerstone for guaranteeing the success of such methods.\n\nThe RIP constant, $\\delta_s$, quantifies how well the sensing matrix preserves the Euclidean norm (or energy) of sparse signals. A value of $\\delta_s$ close to $0$ means the matrix acts almost as an isometry on the set of all $s$-sparse vectors, preserving distances and geometry. The magnitude of $\\delta_s$ directly influences recovery guarantees in three fundamental ways:\n\n1.  **Existence and Uniqueness of Sparse Solutions:** The condition $\\delta_{2s}  1$ is a sufficient condition to guarantee that any $s$-sparse signal $z$ is the unique sparsest solution to the linear system $y = A_{eff} z$. It ensures that the measurement operator is injective on the set of $2s$-sparse signals, meaning two different $s$-sparse signals cannot produce the same measurement vector. This prevents ambiguity and guarantees that, in a noiseless scenario, the true $s$-sparse signal can be perfectly recovered.\n\n2.  **Stability to Measurement Noise:** In any realistic acquisition, measurements are corrupted by noise: $y = A_{eff} z + e$. A good reconstruction algorithm must be stable, meaning small noise in the measurements should result in a correspondingly small error in the recovered image. If the RIP holds with $\\delta_{2s}  1$ (or other similar thresholds), the error in the reconstructed signal, $\\|z_{rec} - z_{true}\\|_2$, is guaranteed to be bounded by a constant multiple of the noise level $\\|e\\|_2$. The constants in these error bounds depend on $\\delta_{2s}$, typically deteriorating (growing larger) as $\\delta_{2s}$ approaches $1$. A smaller $\\delta_{2s}$ thus implies a more stable reconstruction.\n\n3.  **Robustness to Model Mismatch:** The assumption of perfect sparsity is often an idealization. Real-world images are better described as \"compressible,\" meaning they can be well-approximated by a sparse signal. The RIP also provides robustness in this case. If a signal $z_{true}$ is not strictly sparse but is close to an $s$-sparse signal, recovery algorithms are guaranteed to find a reconstruction $z_{rec}$ that is close to the true signal. The reconstruction error will be bounded by a term related to the noise level plus a term related to how well the true signal can be approximated by an $s$-sparse signal. Again, the quality of this bound (the constants involved) depends critically on the value of $\\delta_{2s}$.\n\nIn summary, a small RIP constant $\\delta_s$ (specifically, $\\delta_{2s} \\ll 1$) is a powerful indicator that sparsity-promoting reconstruction will be successful, providing solutions that are unique, stable against noise, and robust to the image not being perfectly sparse. Conversely, if $\\delta_{2s} \\ge 1$, no such guarantees hold, and reconstruction algorithms may fail catastrophically.", "answer": "$$\\boxed{0.6533}$$", "id": "3399804"}]}