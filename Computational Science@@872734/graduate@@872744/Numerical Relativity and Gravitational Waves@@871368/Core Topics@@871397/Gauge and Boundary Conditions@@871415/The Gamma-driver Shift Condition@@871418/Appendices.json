{"hands_on_practices": [{"introduction": "The Gamma-driver shift condition is built upon the contracted conformal connection functions, $\\tilde{\\Gamma}^i$, which act as a \"driver\" for the gauge dynamics. To gain a concrete understanding of this crucial term, this first exercise asks you to compute its components from first principles for a simple, conformally flat metric in spherical coordinates [@problem_id:3490848]. This foundational calculation will solidify your grasp of the mathematical objects that underpin this gauge condition.", "problem": "In the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formulation of numerical relativity, the Gamma-driver shift condition (Gamma-driver) evolves the spatial shift using the conformal connection functions $\\tilde{\\Gamma}^{i}$ associated with the conformal metric $\\tilde{\\gamma}_{ij}$. Starting from the fundamental definition of the Levi-Civita connection for a Riemannian metric and its contraction, compute the conformal connection functions $\\tilde{\\Gamma}^{i} \\equiv \\tilde{\\gamma}^{jk}\\tilde{\\Gamma}^{i}{}_{jk}$ for the conformally flat three-metric in spherical coordinates $(r,\\theta,\\phi)$ given by\n$$\n\\tilde{\\gamma}_{ij}=\\mathrm{diag}\\!\\big(1,\\,r^{2},\\,r^{2}\\sin^{2}\\theta\\big).\n$$\nUsing only the definitions of the Christoffel symbols in terms of the metric components and their derivatives, derive explicit expressions for the components $\\tilde{\\Gamma}^{r}$, $\\tilde{\\Gamma}^{\\theta}$, and $\\tilde{\\Gamma}^{\\phi}$, and identify which components are nonvanishing. Express your final answer as the ordered triple $(\\tilde{\\Gamma}^{r},\\tilde{\\Gamma}^{\\theta},\\tilde{\\Gamma}^{\\phi})$ in closed form. No numerical rounding is required, and no physical units are involved.", "solution": "The problem asks for the computation of the conformal connection functions $\\tilde{\\Gamma}^{i}$ for a specific three-metric in spherical coordinates. The problem is scientifically grounded in the field of numerical relativity, specifically within the BSSN formalism, and is a well-posed mathematical exercise in differential geometry. The given information is sufficient and consistent for a unique solution.\n\nThe conformal connection functions are defined as the contraction $\\tilde{\\Gamma}^{i} \\equiv \\tilde{\\gamma}^{jk}\\tilde{\\Gamma}^{i}{}_{jk}$, where $\\tilde{\\Gamma}^{i}{}_{jk}$ are the Christoffel symbols of the second kind associated with the conformal metric $\\tilde{\\gamma}_{ij}$. The coordinates are spherical, denoted by $(x^1, x^2, x^3) = (r, \\theta, \\phi)$.\n\nThe given conformal metric is:\n$$ \\tilde{\\gamma}_{ij} = \\mathrm{diag}\\!\\big(1,\\,r^{2},\\,r^{2}\\sin^{2}\\theta\\big) $$\nThe non-zero components of the metric tensor are:\n$$ \\tilde{\\gamma}_{rr} = 1 $$\n$$ \\tilde{\\gamma}_{\\theta\\theta} = r^2 $$\n$$ \\tilde{\\gamma}_{\\phi\\phi} = r^2\\sin^2\\theta $$\nSince the metric tensor $\\tilde{\\gamma}_{ij}$ is diagonal, its inverse $\\tilde{\\gamma}^{ij}$ is also diagonal, with components being the reciprocals of the corresponding components of $\\tilde{\\gamma}_{ij}$:\n$$ \\tilde{\\gamma}^{rr} = 1 $$\n$$ \\tilde{\\gamma}^{\\theta\\theta} = \\frac{1}{r^2} $$\n$$ \\tilde{\\gamma}^{\\phi\\phi} = \\frac{1}{r^2\\sin^2\\theta} $$\n\nThe definition of the conformal connection functions involves a summation over indices $j$ and $k$. Since $\\tilde{\\gamma}^{jk}$ is a diagonal tensor, this summation simplifies significantly, as only the terms where $j=k$ contribute:\n$$ \\tilde{\\Gamma}^{i} = \\sum_{j,k} \\tilde{\\gamma}^{jk}\\tilde{\\Gamma}^{i}{}_{jk} = \\tilde{\\gamma}^{rr}\\tilde{\\Gamma}^{i}{}_{rr} + \\tilde{\\gamma}^{\\theta\\theta}\\tilde{\\Gamma}^{i}{}_{\\theta\\theta} + \\tilde{\\gamma}^{\\phi\\phi}\\tilde{\\Gamma}^{i}{}_{\\phi\\phi} $$\nTo compute $\\tilde{\\Gamma}^{i}$, we must first calculate the Christoffel symbols of the form $\\tilde{\\Gamma}^{i}{}_{jj}$ (no implicit summation over $j$).\n\nThe Christoffel symbols of the second kind are defined by the formula:\n$$ \\tilde{\\Gamma}^{i}{}_{jk} = \\frac{1}{2} \\tilde{\\gamma}^{im} \\left( \\frac{\\partial \\tilde{\\gamma}_{mk}}{\\partial x^j} + \\frac{\\partial \\tilde{\\gamma}_{mj}}{\\partial x^k} - \\frac{\\partial \\tilde{\\gamma}_{jk}}{\\partial x^m} \\right) $$\nFor a diagonal metric, this formula simplifies. We calculate the required symbols for each component $i$.\n\nFirst, we list the non-zero partial derivatives of the metric components:\n$$ \\frac{\\partial \\tilde{\\gamma}_{\\theta\\theta}}{\\partial r} = \\frac{\\partial}{\\partial r}(r^2) = 2r $$\n$$ \\frac{\\partial \\tilde{\\gamma}_{\\phi\\phi}}{\\partial r} = \\frac{\\partial}{\\partial r}(r^2 \\sin^2\\theta) = 2r \\sin^2\\theta $$\n$$ \\frac{\\partial \\tilde{\\gamma}_{\\phi\\phi}}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta}(r^2 \\sin^2\\theta) = 2r^2 \\sin\\theta \\cos\\theta $$\n\nNow we compute the Christoffel symbols $\\tilde{\\Gamma}^{i}{}_{jj}$:\n\nComponent $i=r$:\n$$ \\tilde{\\Gamma}^{r}{}_{rr} = \\frac{1}{2} \\tilde{\\gamma}^{rm} (\\partial_r \\tilde{\\gamma}_{mr} + \\partial_r \\tilde{\\gamma}_{mr} - \\partial_m \\tilde{\\gamma}_{rr}) = \\frac{1}{2}\\tilde{\\gamma}^{rr}(-\\partial_r\\tilde{\\gamma}_{rr} + 2\\partial_r\\tilde{\\gamma}_{rr}) = \\frac{1}{2}(1)\\partial_r(1) = 0 $$\n$$ \\tilde{\\Gamma}^{r}{}_{\\theta\\theta} = \\frac{1}{2} \\tilde{\\gamma}^{rm} (\\partial_\\theta \\tilde{\\gamma}_{m\\theta} + \\partial_\\theta \\tilde{\\gamma}_{m\\theta} - \\partial_m \\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2}\\tilde{\\gamma}^{rr}(-\\partial_r\\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2}(1)(-2r) = -r $$\n$$ \\tilde{\\Gamma}^{r}{}_{\\phi\\phi} = \\frac{1}{2} \\tilde{\\gamma}^{rm} (\\partial_\\phi \\tilde{\\gamma}_{m\\phi} + \\partial_\\phi \\tilde{\\gamma}_{m\\phi} - \\partial_m \\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2}\\tilde{\\gamma}^{rr}(-\\partial_r\\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2}(1)(-2r\\sin^2\\theta) = -r\\sin^2\\theta $$\n\nComponent $i=\\theta$:\n$$ \\tilde{\\Gamma}^{\\theta}{}_{rr} = \\frac{1}{2}\\tilde{\\gamma}^{\\theta m}(-\\partial_m \\tilde{\\gamma}_{rr}) = \\frac{1}{2}\\tilde{\\gamma}^{\\theta\\theta}(-\\partial_\\theta\\tilde{\\gamma}_{rr}) = \\frac{1}{2r^2}(-\\partial_\\theta(1)) = 0 $$\n$$ \\tilde{\\Gamma}^{\\theta}{}_{\\theta\\theta} = \\frac{1}{2}\\tilde{\\gamma}^{\\theta m}(\\partial_\\theta \\tilde{\\gamma}_{m\\theta}) = \\frac{1}{2}\\tilde{\\gamma}^{\\theta\\theta}(\\partial_\\theta \\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2r^2}(\\partial_\\theta(r^2)) = 0 $$\n$$ \\tilde{\\Gamma}^{\\theta}{}_{\\phi\\phi} = \\frac{1}{2}\\tilde{\\gamma}^{\\theta m}(-\\partial_m \\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2}\\tilde{\\gamma}^{\\theta\\theta}(-\\partial_\\theta \\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2r^2}(-2r^2\\sin\\theta\\cos\\theta) = -\\sin\\theta\\cos\\theta $$\n\nComponent $i=\\phi$:\n$$ \\tilde{\\Gamma}^{\\phi}{}_{rr} = \\frac{1}{2}\\tilde{\\gamma}^{\\phi m}(-\\partial_m \\tilde{\\gamma}_{rr}) = \\frac{1}{2}\\tilde{\\gamma}^{\\phi\\phi}(-\\partial_\\phi\\tilde{\\gamma}_{rr}) = \\frac{1}{2r^2\\sin^2\\theta}(-\\partial_\\phi(1)) = 0 $$\n$$ \\tilde{\\Gamma}^{\\phi}{}_{\\theta\\theta} = \\frac{1}{2}\\tilde{\\gamma}^{\\phi m}(-\\partial_m \\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2}\\tilde{\\gamma}^{\\phi\\phi}(-\\partial_\\phi\\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2r^2\\sin^2\\theta}(-\\partial_\\phi(r^2)) = 0 $$\n$$ \\tilde{\\Gamma}^{\\phi}{}_{\\phi\\phi} = \\frac{1}{2}\\tilde{\\gamma}^{\\phi m}(\\partial_\\phi \\tilde{\\gamma}_{m\\phi}) = \\frac{1}{2}\\tilde{\\gamma}^{\\phi\\phi}(\\partial_\\phi \\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2r^2\\sin^2\\theta}(\\partial_\\phi(r^2\\sin^2\\theta)) = 0 $$\n\nWith the Christoffel symbols computed, we now perform the contraction to find the components of $\\tilde{\\Gamma}^i$.\n\nFor $i=r$:\n$$ \\tilde{\\Gamma}^{r} = \\tilde{\\gamma}^{rr}\\tilde{\\Gamma}^{r}{}_{rr} + \\tilde{\\gamma}^{\\theta\\theta}\\tilde{\\Gamma}^{r}{}_{\\theta\\theta} + \\tilde{\\gamma}^{\\phi\\phi}\\tilde{\\Gamma}^{r}{}_{\\phi\\phi} $$\n$$ \\tilde{\\Gamma}^{r} = (1)(0) + \\left(\\frac{1}{r^2}\\right)(-r) + \\left(\\frac{1}{r^2\\sin^2\\theta}\\right)(-r\\sin^2\\theta) = 0 - \\frac{1}{r} - \\frac{1}{r} = -\\frac{2}{r} $$\n\nFor $i=\\theta$:\n$$ \\tilde{\\Gamma}^{\\theta} = \\tilde{\\gamma}^{rr}\\tilde{\\Gamma}^{\\theta}{}_{rr} + \\tilde{\\gamma}^{\\theta\\theta}\\tilde{\\Gamma}^{\\theta}{}_{\\theta\\theta} + \\tilde{\\gamma}^{\\phi\\phi}\\tilde{\\Gamma}^{\\theta}{}_{\\phi\\phi} $$\n$$ \\tilde{\\Gamma}^{\\theta} = (1)(0) + \\left(\\frac{1}{r^2}\\right)(0) + \\left(\\frac{1}{r^2\\sin^2\\theta}\\right)(-\\sin\\theta\\cos\\theta) = -\\frac{\\cos\\theta}{r^2\\sin\\theta} = -\\frac{\\cot\\theta}{r^2} $$\n\nFor $i=\\phi$:\n$$ \\tilde{\\Gamma}^{\\phi} = \\tilde{\\gamma}^{rr}\\tilde{\\Gamma}^{\\phi}{}_{rr} + \\tilde{\\gamma}^{\\theta\\theta}\\tilde{\\Gamma}^{\\phi}{}_{\\theta\\theta} + \\tilde{\\gamma}^{\\phi\\phi}\\tilde{\\Gamma}^{\\phi}{}_{\\phi\\phi} $$\n$$ \\tilde{\\Gamma}^{\\phi} = (1)(0) + \\left(\\frac{1}{r^2}\\right)(0) + \\left(\\frac{1}{r^2\\sin^2\\theta}\\right)(0) = 0 $$\n\nThe components of the conformal connection functions are therefore $\\tilde{\\Gamma}^{r} = -2/r$, $\\tilde{\\Gamma}^{\\theta} = -(\\cot\\theta)/r^2$, and $\\tilde{\\Gamma}^{\\phi}=0$. The non-vanishing components are $\\tilde{\\Gamma}^{r}$ and $\\tilde{\\Gamma}^{\\theta}$.\n\nThe final answer is the ordered triple $(\\tilde{\\Gamma}^{r},\\tilde{\\Gamma}^{\\theta},\\tilde{\\Gamma}^{\\phi})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{2}{r}  -\\frac{\\cot\\theta}{r^2}  0\n\\end{pmatrix}\n}\n$$", "id": "3490848"}, {"introduction": "A key feature of the Gamma-driver is its ability to damp gauge dynamics and guide the coordinates toward a desired state. This exercise explores this behavior by analyzing the driver equations in a simplified stationary spacetime, where the connection functions are constant [@problem_id:3490844]. By solving this system analytically, you will directly observe how the damping parameter $\\eta$ ensures that the system reaches a stable, time-independent equilibrium.", "problem": "Consider the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation of the Einstein equations with the so-called Gamma-driver shift condition for the shift vector $\\,\\beta^{i}\\,$ and its driver $\\,B^{i}\\,$. The Gamma-driver system is a widely used hyperbolic–parabolic driver that, in its simplest form, can be written as the first-order-in-time system\n$$\n\\partial_{t}\\beta^{i} \\;=\\; f(\\alpha)\\,B^{i}, \n\\qquad\n\\partial_{t}B^{i} \\;=\\; \\partial_{t}\\tilde{\\Gamma}^{i} \\;-\\; \\eta\\,B^{i},\n$$\nwhere $\\,\\tilde{\\Gamma}^{i}\\,$ are the contracted conformal connection functions of the BSSN variables, $\\,\\alpha\\,$ is the lapse, $\\,f(\\alpha)0\\,$ is a positive gauge driver function, and $\\,\\eta0\\,$ is a positive damping parameter. Assume a stationary background in which $\\,\\partial_{t}\\tilde{\\Gamma}^{i}=0\\,$ and $\\,\\alpha\\,$ is time-independent so that $\\,f(\\alpha)\\,$ is a positive constant. Work locally at a fixed spatial point so that spatial derivatives do not enter. Let the initial data at $\\,t=0\\,$ be $\\,\\beta^{i}(0)=\\beta^{i}_{0}\\,$ and $\\,B^{i}(0)=B^{i}_{0}\\,$, where $\\,\\beta^{i}_{0}\\,$ and $\\,B^{i}_{0}\\,$ are finite constants.\n\nStarting from these evolution equations and assumptions, solve for $\\,\\beta^{i}(t)\\,$ and $\\,B^{i}(t)\\,$ and determine the large-time limits $\\,\\lim_{t\\to\\infty}\\beta^{i}(t)\\,$ and $\\,\\lim_{t\\to\\infty}B^{i}(t)\\,$. Your reasoning should begin with the stated Gamma-driver system and proceed by direct solution of the resulting ordinary differential equations. State any intermediate steps clearly and justify the sign of any exponential factors from the given conditions $\\,\\eta0\\,$ and $\\,f(\\alpha)0\\,$.\n\nExpress your final answer as a single two-entry row, in the order $\\bigl(\\lim_{t\\to\\infty}\\beta^{i}(t),\\;\\lim_{t\\to\\infty}B^{i}(t)\\bigr)$, using only the symbols $\\,\\beta^{i}_{0}\\,$, $\\,B^{i}_{0}\\,$, $\\,f(\\alpha)\\,$, and $\\,\\eta\\,$. No numerical evaluation is required. Do not include units.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard scenario for analyzing the behavior of the Gamma-driver shift condition in numerical relativity under simplifying, but physically meaningful, assumptions. Therefore, the problem is valid and we proceed with the solution.\n\nThe evolution equations for the shift vector $\\beta^{i}$ and its driver $B^{i}$ are given by the system:\n$$\n\\partial_{t}\\beta^{i} \\;=\\; f(\\alpha)\\,B^{i}\n$$\n$$\n\\partial_{t}B^{i} \\;=\\; \\partial_{t}\\tilde{\\Gamma}^{i} \\;-\\; \\eta\\,B^{i}\n$$\nThe problem specifies a stationary background, for which $\\partial_{t}\\tilde{\\Gamma}^{i}=0$. It also assumes that the lapse $\\alpha$ is time-independent, which implies that the gauge driver function $f(\\alpha)$ is a constant. As we are working at a fixed spatial point, the partial time derivatives $\\partial_{t}$ can be treated as total time derivatives $\\frac{d}{dt}$. The system of equations thus simplifies to a system of ordinary differential equations (ODEs):\n$$\n\\frac{d\\beta^{i}}{dt} = f(\\alpha)B^{i}\n\\quad \\quad (1)\n$$\n$$\n\\frac{dB^{i}}{dt} = -\\eta B^{i}\n\\quad \\quad (2)\n$$\nWe are given the initial conditions at $t=0$: $\\beta^{i}(0)=\\beta^{i}_{0}$ and $B^{i}(0)=B^{i}_{0}$.\n\nFirst, we solve equation $(2)$ for $B^{i}(t)$. This is a first-order linear homogeneous ODE with a constant coefficient $-\\eta$. The general solution is found by separation of variables:\n$$\n\\frac{dB^{i}}{B^{i}} = -\\eta \\, dt\n$$\nIntegrating both sides yields:\n$$\n\\ln|B^{i}| = -\\eta t + C_{1}\n$$\nwhere $C_{1}$ is an integration constant. Exponentiating both sides gives:\n$$\nB^{i}(t) = C_{2} \\exp(-\\eta t)\n$$\nwhere $C_{2} = \\pm \\exp(C_{1})$ is a constant vector. We determine $C_{2}$ using the initial condition $B^{i}(0)=B^{i}_{0}$:\n$$\nB^{i}_{0} = C_{2} \\exp(-\\eta \\cdot 0) = C_{2} \\exp(0) = C_{2}\n$$\nThus, the solution for $B^{i}(t)$ is:\n$$\nB^{i}(t) = B^{i}_{0} \\exp(-\\eta t)\n$$\nNext, we solve for $\\beta^{i}(t)$ by substituting the expression for $B^{i}(t)$ into equation $(1)$:\n$$\n\\frac{d\\beta^{i}}{dt} = f(\\alpha) \\left( B^{i}_{0} \\exp(-\\eta t) \\right)\n$$\nTo find $\\beta^{i}(t)$, we integrate with respect to time $t$:\n$$\n\\beta^{i}(t) = \\int f(\\alpha) B^{i}_{0} \\exp(-\\eta t) \\, dt\n$$\nSince $f(\\alpha)$ and $B^{i}_{0}$ are constants with respect to time, we have:\n$$\n\\beta^{i}(t) = f(\\alpha) B^{i}_{0} \\int \\exp(-\\eta t) \\, dt = f(\\alpha) B^{i}_{0} \\left( -\\frac{1}{\\eta} \\exp(-\\eta t) \\right) + C_{3}\n$$\nwhere $C_{3}$ is another integration constant vector. We use the initial condition $\\beta^{i}(0)=\\beta^{i}_{0}$ to determine $C_{3}$:\n$$\n\\beta^{i}_{0} = f(\\alpha) B^{i}_{0} \\left( -\\frac{1}{\\eta} \\exp(0) \\right) + C_{3} = -\\frac{f(\\alpha) B^{i}_{0}}{\\eta} + C_{3}\n$$\nSolving for $C_{3}$ gives:\n$$\nC_{3} = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}\n$$\nSubstituting this back into the expression for $\\beta^{i}(t)$, we obtain the complete solution:\n$$\n\\beta^{i}(t) = -\\frac{f(\\alpha) B^{i}_{0}}{\\eta} \\exp(-\\eta t) + \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}\n$$\nThis can be written more compactly as:\n$$\n\\beta^{i}(t) = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta} \\left( 1 - \\exp(-\\eta t) \\right)\n$$\nNow, we determine the large-time limits as $t \\to \\infty$. The problem states that $\\eta  0$. Consequently, the exponential term $\\exp(-\\eta t)$ approaches zero as $t \\to \\infty$:\n$$\n\\lim_{t\\to\\infty} \\exp(-\\eta t) = 0\n$$\nUsing this limit, we evaluate the large-time behavior of $B^{i}(t)$ and $\\beta^{i}(t)$. For the driver $B^{i}(t)$:\n$$\n\\lim_{t\\to\\infty} B^{i}(t) = \\lim_{t\\to\\infty} \\left( B^{i}_{0} \\exp(-\\eta t) \\right) = B^{i}_{0} \\cdot 0 = 0\n$$\nThis demonstrates that the driver term $B^{i}$ is damped to zero at late times, which is the intended behavior of the Gamma-driver condition in reaching a steady state.\nFor the shift vector $\\beta^{i}(t)$:\n$$\n\\lim_{t\\to\\infty} \\beta^{i}(t) = \\lim_{t\\to\\infty} \\left( \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta} \\left( 1 - \\exp(-\\eta t) \\right) \\right)\n$$\n$$\n\\lim_{t\\to\\infty} \\beta^{i}(t) = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta} \\left( 1 - 0 \\right) = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}\n$$\nThe shift vector asymptotes to a constant value, indicating that the coordinate system settles into a fixed state. The condition $f(\\alpha)0$ ensures that the sign of the contribution from $B^{i}_{0}$ depends only on the sign of $B^{i}_{0}$ itself.\n\nThe required limits are therefore $\\lim_{t\\to\\infty} \\beta^{i}(t) = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}$ and $\\lim_{t\\to\\infty} B^{i}(t) = 0$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}  0 \\end{pmatrix}}\n$$", "id": "3490844"}, {"introduction": "Theory comes to life when applied to the practical challenges of numerical simulations, such as controlling coordinate drift in inspiraling binary systems. This hands-on coding practice models the center-of-mass motion using a damped, driven harmonic oscillator, which is an excellent approximation for the effects of the Gamma-driver gauge [@problem_id:3490832]. By numerically solving the system, you will investigate how the damping parameter $\\eta$ influences stability and perform a parameter study to find the optimal choice for minimizing gauge drift, a task central to modern numerical relativity.", "problem": "You will model coordinate center-of-mass drift induced by the shift vector in the Gamma-driver gauge and quantify how the damping parameter influences that drift for an equal-mass binary. Work in geometric units with total mass normalized to one, so all lengths and times are in multiples of the total mass, denoted by $M$. All requested outputs must be expressed in units of $M$.\n\nFundamental base and definitions:\n- In the $3+1$ decomposition of spacetime, the shift vector is $ \\beta^i $, and the Eulerian coordinate time lines advect coordinates according to $ \\mathrm{d}x^i/\\mathrm{d}t = \\beta^i $, hence a uniform translation along the $x$-axis can be represented by a scalar coordinate displacement $ \\xi(t) $ that satisfies $ \\dot{\\xi}(t) = \\beta^x(t) $.\n- Consider the well-tested integrated Gamma-driver shift condition in its simplest form $ \\partial_t \\beta^i = \\mu_S \\tilde{\\Gamma}^i - \\eta \\beta^i $, where $ \\tilde{\\Gamma}^i $ are the conformal connection functions of the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formulation, $ \\mu_S $ is a positive constant, and $ \\eta $ is a positive damping parameter.\n- Quantify coordinate center-of-mass drift using the definition $ x_{\\mathrm{CM}}(t) = \\dfrac{\\int x \\, \\rho_{\\mathrm{eff}}(\\mathbf{x},t) \\, \\mathrm{d}^3 x}{\\int \\rho_{\\mathrm{eff}}(\\mathbf{x},t) \\, \\mathrm{d}^3 x} $, where $ \\rho_{\\mathrm{eff}} $ is an effective density.\n\nModel assumptions and reduction to an ordinary differential equation:\n- Model an equal-mass binary by two identical spherically symmetric Gaussian effective densities of masses $ m_1 = m_2 $, initially centered at $ x = \\pm a $ on the $x$-axis with $ y = 0 $ and $ z = 0 $. Under a spatially uniform coordinate translation $ \\xi(t) $ along $x$, the centers are at $ x_1(t) = -a + \\xi(t) $ and $ x_2(t) = +a + \\xi(t) $ for all $ t $.\n- Because the Gaussian profiles are normalized and spherically symmetric, the center-of-mass computed from $ x_{\\mathrm{CM}}(t) $ equals the average of the centers. Therefore, for the equal-mass case, one has $ x_{\\mathrm{CM}}(t) = \\xi(t) $ exactly, independent of the Gaussian width.\n- Linearize the conformal connection response to a small uniform translation so that $ \\tilde{\\Gamma}^x(t) \\approx -\\kappa \\, \\xi(t) + F_{\\mathrm{bias}}(t) $, with $ \\kappa  0 $ a constant that sets the restoring tendency of the driver and $ F_{\\mathrm{bias}}(t) $ a slowly varying bias that represents a net gauge curvature source from the binary. Adopt a smooth ramp for the bias, $ F_{\\mathrm{bias}}(t) = F_\\infty \\left(1 - e^{-t/\\tau}\\right) $, with constants $ F_\\infty  0 $ and $ \\tau  0 $.\n- Combining $ \\dot{\\xi} = \\beta^x $ with $ \\partial_t \\beta^x = \\mu_S \\tilde{\\Gamma}^x - \\eta \\beta^x $ yields the second-order ordinary differential equation\n$$\n\\ddot{\\xi}(t) + \\eta \\, \\dot{\\xi}(t) + \\omega_0^2 \\, \\xi(t) = \\mu_S \\, F_{\\mathrm{bias}}(t),\n$$\nwhere $ \\omega_0^2 = \\mu_S \\, \\kappa $. The asymptotic offset is $ \\xi_\\infty = \\dfrac{\\mu_S F_\\infty}{\\omega_0^2} = \\dfrac{F_\\infty}{\\kappa} $.\n\nTask:\n- For the parameter choices below, solve the initial value problem with $ \\xi(0) = 0 $ and $ \\dot{\\xi}(0) = 0 $. Use the resulting $ \\xi(t) $ to compute the drift metric\n$$\nD(\\eta) = \\max_{t \\in [0,T]} \\left| x_{\\mathrm{CM}}(t) - \\xi_\\infty \\right| = \\max_{t \\in [0,T]} \\left| \\xi(t) - \\xi_\\infty \\right|.\n$$\nInterpret $ D(\\eta) $ as the maximal dynamic drift relative to the asymptotic offset. All outputs must be given in units of $ M $.\n\nParameter values (these values constitute the test suite and must be used exactly as specified):\n- Total mass is normalized to one, so all times and lengths are in units of $M$.\n- Binary separation parameter $ a = 10 $.\n- Gaussian width parameter $ \\sigma = 1 $ (only used in the conceptual definition of $ \\rho_{\\mathrm{eff}} $, not needed numerically since $ x_{\\mathrm{CM}}(t) = \\xi(t) $ holds exactly for equal masses).\n- Driver constants: $ \\mu_S = 3/4 $, $ \\kappa = 4/3 $, hence $ \\omega_0^2 = \\mu_S \\kappa = 1 $.\n- Bias ramp: $ F_\\infty = \\kappa \\times 0.1 $, so that $ \\xi_\\infty = 0.1 $, and $ \\tau = 5 $.\n- Final time: $ T = 50 $.\n- Damping parameter test suite: $ \\eta \\in \\{ 0, 0.5, 1.0, 2.0, 4.0, 8.0 \\} $.\n\nNumerical requirements:\n- Integrate the ordinary differential equation for each $ \\eta $ in the test suite using a stable explicit scheme of your choice with a fixed time step sufficiently small to resolve the fastest timescale set by $ \\omega_0 $ and $ \\eta $. You must not rely on any user input.\n- For each $ \\eta $, compute $ D(\\eta) $ as defined above over the interval $ [0,T] $.\n- Determine $ k_{\\min} $, the $0$-based index of the $ \\eta $ in the given list that minimizes $ D(\\eta) $. If there are ties within numerical precision, choose the smallest index.\n\nFinal output specification:\n- Your program should produce a single line of output containing a JSON-like list with $7$ entries: the six values $ D(\\eta) $ for the test suite $ \\eta $ values in the specified order, followed by the integer $ k_{\\min} $. For example, the format must be exactly like $ [d_0,d_1,d_2,d_3,d_4,d_5,k_{\\min}] $, with commas separating entries and no spaces. All $ d_j $ must be floats in units of $ M $, and $ k_{\\min} $ must be an integer.", "solution": "### Step 1: Extract Givens\n\nThe problem provides the following data, definitions, and conditions:\n- **Fundamental relations**:\n  - Coordinate advection: $\\mathrm{d}x^i/\\mathrm{d}t = \\beta^i$\n  - Uniform translation displacement $\\xi(t)$ satisfies $\\dot{\\xi}(t) = \\beta^x(t)$.\n  - Integrated Gamma-driver shift condition: $\\partial_t \\beta^i = \\mu_S \\tilde{\\Gamma}^i - \\eta \\beta^i$, where $\\mu_S  0$ and $\\eta  0$.\n  - Center-of-mass definition: $x_{\\mathrm{CM}}(t) = \\dfrac{\\int x \\, \\rho_{\\mathrm{eff}}(\\mathbf{x},t) \\, \\mathrm{d}^3 x}{\\int \\rho_{\\mathrm{eff}}(\\mathbf{x},t) \\, \\mathrm{d}^3 x}$.\n- **Model Assumptions**:\n  - For an equal-mass binary, $x_{\\mathrm{CM}}(t) = \\xi(t)$.\n  - Linearized conformal connection response: $\\tilde{\\Gamma}^x(t) \\approx -\\kappa \\, \\xi(t) + F_{\\mathrm{bias}}(t)$, with $\\kappa  0$.\n  - Bias term functional form: $F_{\\mathrm{bias}}(t) = F_\\infty \\left(1 - e^{-t/\\tau}\\right)$, with $F_\\infty  0$ and $\\tau  0$.\n- **Governing Equation**:\n  - Second-order ordinary differential equation (ODE) for $\\xi(t)$:\n    $$ \\ddot{\\xi}(t) + \\eta \\, \\dot{\\xi}(t) + \\omega_0^2 \\, \\xi(t) = \\mu_S \\, F_{\\mathrm{bias}}(t) $$\n  - Definition of $\\omega_0^2$: $\\omega_0^2 = \\mu_S \\, \\kappa$.\n  - Initial conditions: $\\xi(0) = 0$ and $\\dot{\\xi}(0) = 0$.\n- **Drift Metric**:\n  - Asymptotic offset: $\\xi_\\infty = \\dfrac{\\mu_S F_\\infty}{\\omega_0^2} = \\dfrac{F_\\infty}{\\kappa}$.\n  - Drift metric definition: $D(\\eta) = \\max_{t \\in [0,T]} \\left| \\xi(t) - \\xi_\\infty \\right|$.\n- **Parameter Values**:\n  - Driver constants: $\\mu_S = 3/4$, $\\kappa = 4/3$. This implies $\\omega_0^2 = (3/4)(4/3) = 1$.\n  - Bias ramp parameters: $F_\\infty = \\kappa \\times 0.1$, $\\tau = 5$. This implies $\\xi_\\infty = 0.1$.\n  - Final time for integration: $T = 50$.\n  - Damping parameter test suite: $\\eta \\in \\{ 0, 0.5, 1.0, 2.0, 4.0, 8.0 \\}$.\n- **Task Requirements**:\n  - Solve the ODE for each $\\eta$.\n  - Compute $D(\\eta)$ for each $\\eta$.\n  - Determine $k_{\\min}$, the $0$-based index of the $\\eta$ that minimizes $D(\\eta)$.\n  - Numerical integration must use a stable explicit scheme with a fixed time step.\n  - The final output must be a single JSON-like list: $[D_0, D_1, D_2, D_3, D_4, D_5, k_{\\min}]$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is a well-posed initial value problem in mathematical physics, grounded in the standard theoretical framework of numerical relativity.\n- **Scientifically Grounded**: The problem uses the BSSN formulation's Gamma-driver shift condition, a standard gauge choice in simulating gravitational waves from binary systems. The model, while simplified (linearization, specific bias term), represents a valid physical approximation used to study gauge dynamics. The resulting equation is a damped, driven harmonic oscillator, a ubiquitous and fundamental model in physics.\n- **Well-Posed**: The problem specifies a linear, second-order, non-homogeneous ordinary differential equation with constant coefficients and a well-behaved forcing function. The initial conditions ($\\xi(0)=0, \\dot{\\xi}(0)=0$) are provided, ensuring that a unique and stable solution exists for all $t \\ge 0$.\n- **Objective**: All terms are defined with mathematical precision. The parameters are given as specific numerical values, and the task is stated unambiguously. There are no subjective or opinion-based components.\n- **Self-Contained and Consistent**: All necessary information is provided. The derived parameter values are consistent with the definitions ($\\omega_0^2 = 1$, $\\xi_\\infty = 0.1$). Substituting the given parameters into the general ODE yields a concrete equation to be solved. The forcing term on the right-hand side is $\\mu_S F_{\\mathrm{bias}}(t) = \\mu_S (F_\\infty) (1 - e^{-t/\\tau}) = (3/4) (\\kappa \\times 0.1) (1 - e^{-t/\\tau}) = (3/4) ((4/3) \\times 0.1) (1 - e^{-t/5}) = 0.1(1-e^{-t/5})$. The complete ODE is $\\ddot{\\xi}(t) + \\eta \\dot{\\xi}(t) + \\xi(t) = 0.1(1-e^{-t/5})$, which is consistent and solvable.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A full solution will be provided.\n\n### Solution\n\nThe problem requires solving the second-order initial value problem for the coordinate displacement $\\xi(t)$ for several values of the damping parameter $\\eta$, and then computing a drift metric $D(\\eta)$.\n\nThe governing ordinary differential equation, after substituting the given parameters $\\omega_0^2 = 1$, $\\mu_S = 3/4$, $F_\\infty = \\kappa \\times 0.1 = (4/3) \\times 0.1$, and $\\tau=5$, is:\n$$ \\ddot{\\xi}(t) + \\eta \\dot{\\xi}(t) + \\xi(t) = 0.1 \\left(1 - e^{-t/5}\\right) $$\nwith initial conditions $\\xi(0) = 0$ and $\\dot{\\xi}(0) = 0$.\n\nThe problem states that a stable, explicit numerical integration scheme with a fixed time step must be used. The fourth-order Runge-Kutta (RK4) method is an excellent choice, offering high accuracy and a broad stability region.\n\nTo apply the RK4 method, we first convert the second-order ODE into a system of two first-order ODEs. Let us define a state vector $\\mathbf{y}(t)$ as:\n$$ \\mathbf{y}(t) = \\begin{pmatrix} y_0(t) \\\\ y_1(t) \\end{pmatrix} = \\begin{pmatrix} \\xi(t) \\\\ \\dot{\\xi}(t) \\end{pmatrix} $$\nThe time derivative of this vector is:\n$$ \\frac{\\mathrm{d}\\mathbf{y}}{\\mathrm{d}t} = \\begin{pmatrix} \\dot{y}_0(t) \\\\ \\dot{y}_1(t) \\end{pmatrix} = \\begin{pmatrix} \\dot{\\xi}(t) \\\\ \\ddot{\\xi}(t) \\end{pmatrix} = \\begin{pmatrix} y_1(t) \\\\ 0.1 \\left(1 - e^{-t/5}\\right) - \\eta y_1(t) - y_0(t) \\end{pmatrix} $$\nThis defines our system as $\\dot{\\mathbf{y}}(t) = \\mathbf{f}(t, \\mathbf{y}(t), \\eta)$, with the initial condition $\\mathbf{y}(0) = [0, 0]^T$.\n\nThe RK4 algorithm advances the solution from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ for a fixed time step $\\Delta t$. For the state vector $\\mathbf{y}_n$ at time $t_n$, the state $\\mathbf{y}_{n+1}$ is computed as follows:\n$$ \\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4) $$\nwhere the intermediate slopes are:\n\\begin{align*}\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{f}(t_n, \\mathbf{y}_n, \\eta) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{f}(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_1}{2}, \\eta) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{f}(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_2}{2}, \\eta) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{f}(t_n + \\Delta t, \\mathbf{y}_n + \\mathbf{k}_3, \\eta)\n\\end{align*}\nThe fastest timescale in the system is set by the natural frequency $\\omega_0 = 1$, corresponding to a period of $2\\pi/ \\omega_0 \\approx 6.28$. A time step of $\\Delta t=0.01$ is chosen, which is sufficiently small to resolve this oscillation accurately.\n\nFor each value of $\\eta$ in the set $\\{ 0, 0.5, 1.0, 2.0, 4.0, 8.0 \\}$, we perform the following steps:\n1.  Initialize the state vector $\\mathbf{y} = [0, 0]^T$ at $t=0$. Create an array to store the history of $\\xi(t)$.\n2.  Iterate from $t=0$ to $t=T=50$ using the RK4 method with $\\Delta t=0.01$, storing the computed value of $\\xi(t)$ at each step.\n3.  After the integration is complete, we have the trajectory $\\xi(t)$ over the interval $[0, 50]$.\n4.  Compute the drift metric $D(\\eta)$. The asymptotic offset is given as $\\xi_\\infty = 0.1$. The metric is the maximum deviation from this offset:\n    $$ D(\\eta) = \\max_{t \\in [0,T]} \\left| \\xi(t) - \\xi_\\infty \\right| $$\n    This is found by taking the maximum value of the absolute difference between the stored $\\xi(t)$ values and $\\xi_\\infty$.\n5.  Store the calculated $D(\\eta)$ value.\n\nAfter computing $D(\\eta)$ for all specified $\\eta$ values, we find the $0$-based index $k_{\\min}$ corresponding to the minimum value in the list of results for $D(\\eta)$. If multiple $\\eta$ values yield the same minimum (within numerical precision), the one with the smallest index is chosen, as per the problem specification. This is naturally handled by standard functions for finding the index of a minimum value in an array.\n\nFinally, the six computed values of $D(\\eta)$ and the integer index $k_{\\min}$ are formatted into the required single-line list format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ODE for center-of-mass drift, calculates the drift metric D(eta)\n    for a suite of damping parameters, and finds the optimal parameter index.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    # Driver constants and derived quantities\n    mu_S = 3.0/4.0\n    kappa = 4.0/3.0\n    omega_0_2 = mu_S * kappa  # This is 1.0\n\n    # Bias ramp parameters and derived asymptotic offset\n    F_infty = kappa * 0.1\n    xi_infty = F_infty / kappa  # This is 0.1\n    tau = 5.0\n\n    # Integration time\n    T_final = 50.0\n\n    # Test suite for the damping parameter eta\n    eta_suite = [0.0, 0.5, 1.0, 2.0, 4.0, 8.0]\n\n    # --- Numerical Settings ---\n    # Fixed time step, chosen to be small enough to resolve the fastest timescale (omega_0=1)\n    dt = 0.01\n    n_steps = int(T_final / dt)\n\n    # --- ODE System Definition ---\n    # We solve the system d(y)/dt = f(t, y) where y = [xi, dot_xi]\n    # ddot(xi) + eta * dot(xi) + omega_0^2 * xi = mu_S * F_bias(t)\n    # The right-hand side forcing term simplifies to:\n    # mu_S * F_infty * (1 - exp(-t/tau)) = omega_0^2 * xi_infty * (1 - exp(-t/tau))\n    # Since omega_0^2=1 and xi_infty=0.1, this is 0.1 * (1 - exp(-t/tau))\n    \n    def forcing_term(t):\n        \"\"\"Calculates the forcing term of the ODE at a given time t.\"\"\"\n        return xi_infty * (1.0 - np.exp(-t / tau))\n\n    def ode_system(t, y, eta):\n        \"\"\"\n        Defines the system of first-order ODEs.\n        y[0] = xi (displacement)\n        y[1] = dot_xi (velocity)\n        \"\"\"\n        xi, dot_xi = y\n        # From the ODE: ddot_xi = forcing - eta * dot_xi - omega_0^2 * xi\n        ddot_xi = forcing_term(t) - eta * dot_xi - omega_0_2 * xi\n        return np.array([dot_xi, ddot_xi])\n\n    # --- Main Calculation Loop ---\n    D_results = []\n    \n    for eta in eta_suite:\n        # Initial conditions: xi(0)=0, dot_xi(0)=0\n        y = np.array([0.0, 0.0])\n        \n        # Store the history of xi(t) to calculate the max deviation later\n        xi_history = [y[0]]\n        \n        t = 0.0\n        for _ in range(n_steps):\n            # Fourth-Order Runge-Kutta (RK4) step\n            k1 = dt * ode_system(t, y, eta)\n            k2 = dt * ode_system(t + 0.5 * dt, y + 0.5 * k1, eta)\n            k3 = dt * ode_system(t + 0.5 * dt, y + 0.5 * k2, eta)\n            k4 = dt * ode_system(t + dt, y + k3, eta)\n            \n            y = y + (k1 + 2.0 * k2 + 2.0 * k3 + k4) / 6.0\n            t += dt\n            \n            xi_history.append(y[0])\n            \n        xi_values = np.array(xi_history)\n        \n        # Calculate the drift metric D(eta) = max |xi(t) - xi_infty| over [0, T]\n        deviation = np.abs(xi_values - xi_infty)\n        max_deviation = np.max(deviation)\n        D_results.append(max_deviation)\n\n    # --- Final Result Aggregation ---\n    # Find the 0-based index of the eta value that minimizes D(eta).\n    # np.argmin returns the index of the first occurrence of the minimum value,\n    # satisfying the tie-breaking rule.\n    k_min = np.argmin(D_results)\n\n    # Combine all results into a single list\n    final_output_list = D_results + [k_min]\n\n    # Format the output string exactly as specified: [d0,d1,d2,d3,d4,d5,k_min]\n    # No spaces, comma-separated values.\n    output_str = f\"[{','.join(map(str, final_output_list))}]\"\n    \n    # Print the final single-line result.\n    print(output_str)\n\n# Run the solver.\nsolve()\n```", "id": "3490832"}]}