{"hands_on_practices": [{"introduction": "The first step in translating the BSSN evolution equations into a computer program is to replace continuous derivatives with discrete approximations. The accuracy and stability of a numerical relativity simulation are fundamentally tied to the quality of these approximations. This practice guides you through the foundational process of deriving a high-order finite-difference stencil, a critical component of any BSSN code, and analyzing its inherent truncation error.", "problem": "In the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formalism of numerical relativity, the contracted conformal connection functions are denoted by $\\tilde{\\Gamma}^{i}$. Consider the divergence $\\partial_{i}\\tilde{\\Gamma}^{i}$ evaluated on a uniform Cartesian grid with spacing $h$ in each coordinate direction, with grid points at $x_{m}=m h$, $y_{n}=n h$, and $z_{p}=p h$ for integers $m,n,p$. \n\nStarting from Taylor expansions about a grid point, derive a fourth-order accurate, centered finite-difference approximation for $\\partial_{i}\\tilde{\\Gamma}^{i}$ at the grid point $(m,n,p)$ in terms of the values of $\\tilde{\\Gamma}^{i}$ at neighboring grid points. You must justify the order of accuracy directly from the Taylor expansions and identify the leading-order truncation error term symbolically.\n\nThen, specialize to the smooth test field\n- $\\tilde{\\Gamma}^{x}(x,y,z)=\\sin(x)\\,\\cos(y)\\,\\exp(z)$,\n- $\\tilde{\\Gamma}^{y}(x,y,z)=\\cos(x)\\,\\sin(y)\\,\\exp(z)$,\n- $\\tilde{\\Gamma}^{z}(x,y,z)=\\exp(x+y)\\,\\cos(z)$,\n\nand compute the leading-order truncation error of your fourth-order centered finite-difference approximation to $\\partial_{i}\\tilde{\\Gamma}^{i}$ at the physical point $(x,y,z)=(0,0,0)$. Express your final answer as a single closed-form analytic expression in terms of $h$ only. No numerical rounding is required, and no units are needed.", "solution": "The problem requires the derivation of a fourth-order accurate, centered finite-difference approximation for the divergence of the contracted conformal connection functions, $\\partial_{i}\\tilde{\\Gamma}^{i}$, and the calculation of its leading-order truncation error for a specific test field. The divergence in three-dimensional Cartesian coordinates is $\\partial_{i}\\tilde{\\Gamma}^{i} = \\partial_{x}\\tilde{\\Gamma}^{x} + \\partial_{y}\\tilde{\\Gamma}^{y} + \\partial_{z}\\tilde{\\Gamma}^{z}$. Due to the linearity of the differentiation and the finite-difference operators, we can derive the stencil for a single partial derivative, e.g., $\\partial_x f(x)$, and then apply it to each term in the divergence.\n\nLet's derive the fourth-order accurate, centered finite-difference approximation for the first derivative of a generic smooth function $f(x)$ at a grid point $x$. We use a five-point stencil involving points at $x \\pm h$ and $x \\pm 2h$. The approximation $D_x f$ can be written as a linear combination of the function values at these points:\n$$D_x f = \\frac{c_{-2}f(x-2h) + c_{-1}f(x-h) + c_0 f(x) + c_1 f(x+h) + c_2 f(x+2h)}{h}$$\nWe use Taylor series expansions of $f$ around $x$:\n$$ f(x+kh) = f(x) + (kh)f'(x) + \\frac{(kh)^2}{2!}f''(x) + \\frac{(kh)^3}{3!}f'''(x) + \\frac{(kh)^4}{4!}f^{(4)}(x) + \\frac{(kh)^5}{5!}f^{(5)}(x) + \\mathcal{O}(h^6) $$\nFor a centered difference scheme for the first derivative, the stencil must be antisymmetric, so $c_{-k} = -c_k$, and the central point coefficient must be zero, $c_0=0$. The approximation takes the form:\n$$ D_x f = \\frac{c_1(f(x+h) - f(x-h)) + c_2(f(x+2h) - f(x-2h))}{h} $$\nLet's expand the difference terms:\n$$ f(x+h) - f(x-h) = 2h f'(x) + \\frac{2h^3}{6}f'''(x) + \\frac{2h^5}{120}f^{(5)}(x) + \\mathcal{O}(h^7) $$\n$$ f(x+2h) - f(x-2h) = 4h f'(x) + \\frac{16h^3}{6}f'''(x) + \\frac{64h^5}{120}f^{(5)}(x) + \\mathcal{O}(h^7) $$\nSubstituting these into the expression for $D_x f$:\n$$ D_x f = \\frac{c_1}{h}\\left(2h f' + \\frac{h^3}{3}f''' + \\frac{h^5}{60}f^{(5)}\\right) + \\frac{c_2}{h}\\left(4h f' + \\frac{8h^3}{3}f''' + \\frac{8h^5}{15}f^{(5)}\\right) + \\mathcal{O}(h^6) $$\n$$ D_x f = (2c_1 + 4c_2)f'(x) + \\left(\\frac{c_1}{3} + \\frac{8c_2}{3}\\right)h^2f'''(x) + \\left(\\frac{c_1}{60} + \\frac{8c_2}{15}\\right)h^4f^{(5)}(x) + \\mathcal{O}(h^6) $$\nTo obtain an approximation for $f'(x)$, the coefficient of $f'(x)$ must be $1$. To achieve fourth-order accuracy, the coefficient of the $h^2f'''(x)$ term must be zero. This gives us a system of two linear equations for $c_1$ and $c_2$:\n1. $2c_1 + 4c_2 = 1$\n2. $\\frac{c_1}{3} + \\frac{8c_2}{3} = 0 \\implies c_1 + 8c_2 = 0 \\implies c_1 = -8c_2$\n\nSubstituting $c_1 = -8c_2$ into the first equation:\n$$ 2(-8c_2) + 4c_2 = 1 \\implies -16c_2 + 4c_2 = 1 \\implies -12c_2 = 1 \\implies c_2 = -\\frac{1}{12} $$\nThen, $c_1 = -8(-\\frac{1}{12}) = \\frac{8}{12} = \\frac{2}{3}$.\n\nThe finite-difference operator for $\\partial_x$ is therefore:\n$$ D_x f = \\frac{2}{3h}(f(x+h) - f(x-h)) - \\frac{1}{12h}(f(x+2h) - f(x-2h)) $$\n$$ D_x f = \\frac{8(f(x+h) - f(x-h)) - (f(x+2h) - f(x-2h))}{12h} $$\n$$ D_x f = \\frac{-f(x+2h) + 8f(x+h) - 8f(x-h) + f(x-2h)}{12h} $$\nThe leading-order truncation error term is given by the $h^4f^{(5)}(x)$ term in the expansion. Using the values found for $c_1$ and $c_2$:\n$$ \\text{Error Term} = \\left(\\frac{c_1}{60} + \\frac{8c_2}{15}\\right)h^4f^{(5)}(x) = \\left(\\frac{2/3}{60} + \\frac{8(-1/12)}{15}\\right)h^4f^{(5)}(x) $$\n$$ = \\left(\\frac{2}{180} - \\frac{8}{180}\\right)h^4f^{(5)}(x) = \\left(\\frac{1}{90} - \\frac{4}{90}\\right)h^4f^{(5)}(x) = -\\frac{3}{90}h^4f^{(5)}(x) = -\\frac{1}{30}h^4f^{(5)}(x) $$\nSo, the truncation error for the operator $D_x$ is $T_x = D_x f - \\partial_x f = -\\frac{1}{30}h^4 \\partial_x^5 f + \\mathcal{O}(h^6)$.\n\nThe fourth-order finite-difference approximation for $\\partial_{i}\\tilde{\\Gamma}^{i}$ at a grid point $(m,n,p)$ is the sum of the stencils for each partial derivative:\n$$ \\mathcal{D}(\\tilde{\\Gamma})|_{(m,n,p)} = \\frac{-\\tilde{\\Gamma}^x_{m+2,n,p} + 8\\tilde{\\Gamma}^x_{m+1,n,p} - 8\\tilde{\\Gamma}^x_{m-1,n,p} + \\tilde{\\Gamma}^x_{m-2,n,p}}{12h} $$\n$$ + \\frac{-\\tilde{\\Gamma}^y_{m,n+2,p} + 8\\tilde{\\Gamma}^y_{m,n+1,p} - 8\\tilde{\\Gamma}^y_{m,n-1,p} + \\tilde{\\Gamma}^y_{m,n-2,p}}{12h} $$\n$$ + \\frac{-\\tilde{\\Gamma}^z_{m,n,p+2} + 8\\tilde{\\Gamma}^z_{m,n,p+1} - 8\\tilde{\\Gamma}^z_{m,n,p-1} + \\tilde{\\Gamma}^z_{m,n,p-2}}{12h} $$\nThe leading-order truncation error $T = \\mathcal{D}(\\tilde{\\Gamma}) - \\partial_i \\tilde{\\Gamma}^i$ is the sum of the individual leading-order errors:\n$$ T_{LO} = -\\frac{h^4}{30}\\partial_x^5 \\tilde{\\Gamma}^x - \\frac{h^4}{30}\\partial_y^5 \\tilde{\\Gamma}^y - \\frac{h^4}{30}\\partial_z^5 \\tilde{\\Gamma}^z = -\\frac{h^4}{30}\\left(\\partial_x^5 \\tilde{\\Gamma}^x + \\partial_y^5 \\tilde{\\Gamma}^y + \\partial_z^5 \\tilde{\\Gamma}^z\\right) $$\n\nNow, we specialize to the given smooth test field and evaluate the error at $(x,y,z)=(0,0,0)$.\nThe components are:\n- $\\tilde{\\Gamma}^{x}(x,y,z)=\\sin(x)\\,\\cos(y)\\,\\exp(z)$\n- $\\tilde{\\Gamma}^{y}(x,y,z)=\\cos(x)\\,\\sin(y)\\,\\exp(z)$\n- $\\tilde{\\Gamma}^{z}(x,y,z)=\\exp(x+y)\\,\\cos(z)$\n\nWe need to compute the fifth partial derivatives and evaluate them at $(0,0,0)$.\n\nFor $\\tilde{\\Gamma}^x$:\n$$ \\partial_x^5 \\tilde{\\Gamma}^x = \\partial_x^5(\\sin(x)\\,\\cos(y)\\,\\exp(z)) = \\cos(y)\\,\\exp(z)\\,\\frac{d^5}{dx^5}(\\sin(x)) $$\nThe derivatives of $\\sin(x)$ are $\\cos(x)$, $-\\sin(x)$, $-\\cos(x)$, $\\sin(x)$, $\\cos(x)$. So, $\\frac{d^5}{dx^5}(\\sin(x)) = \\cos(x)$.\n$$ \\partial_x^5 \\tilde{\\Gamma}^x = \\cos(x)\\,\\cos(y)\\,\\exp(z) $$\nAt $(0,0,0)$: $\\partial_x^5 \\tilde{\\Gamma}^x|_{(0,0,0)} = \\cos(0)\\,\\cos(0)\\,\\exp(0) = 1 \\cdot 1 \\cdot 1 = 1$.\n\nFor $\\tilde{\\Gamma}^y$:\n$$ \\partial_y^5 \\tilde{\\Gamma}^y = \\partial_y^5(\\cos(x)\\,\\sin(y)\\,\\exp(z)) = \\cos(x)\\,\\exp(z)\\,\\frac{d^5}{dy^5}(\\sin(y)) $$\nSimilarly, $\\frac{d^5}{dy^5}(\\sin(y)) = \\cos(y)$.\n$$ \\partial_y^5 \\tilde{\\Gamma}^y = \\cos(x)\\,\\cos(y)\\,\\exp(z) $$\nAt $(0,0,0)$: $\\partial_y^5 \\tilde{\\Gamma}^y|_{(0,0,0)} = \\cos(0)\\,\\cos(0)\\,\\exp(0) = 1 \\cdot 1 \\cdot 1 = 1$.\n\nFor $\\tilde{\\Gamma}^z$:\n$$ \\partial_z^5 \\tilde{\\Gamma}^z = \\partial_z^5(\\exp(x+y)\\,\\cos(z)) = \\exp(x+y)\\,\\frac{d^5}{dz^5}(\\cos(z)) $$\nThe derivatives of $\\cos(z)$ are $-\\sin(z)$, $-\\cos(z)$, $\\sin(z)$, $\\cos(z)$, $-\\sin(z)$. So, $\\frac{d^5}{dz^5}(\\cos(z)) = -\\sin(z)$.\n$$ \\partial_z^5 \\tilde{\\Gamma}^z = -\\exp(x+y)\\,\\sin(z) $$\nAt $(0,0,0)$: $\\partial_z^5 \\tilde{\\Gamma}^z|_{(0,0,0)} = -\\exp(0)\\,\\sin(0) = -1 \\cdot 0 = 0$.\n\nFinally, we substitute these values into the expression for the leading-order truncation error at $(0,0,0)$:\n$$ T_{LO}|_{(0,0,0)} = -\\frac{h^4}{30}\\left(\\partial_x^5 \\tilde{\\Gamma}^x|_{(0,0,0)} + \\partial_y^5 \\tilde{\\Gamma}^y|_{(0,0,0)} + \\partial_z^5 \\tilde{\\Gamma}^z|_{(0,0,0)}\\right) $$\n$$ T_{LO}|_{(0,0,0)} = -\\frac{h^4}{30}(1 + 1 + 0) = -\\frac{2h^4}{30} = -\\frac{h^4}{15} $$\nThe leading-order truncation error is $-\\frac{h^4}{15}$.", "answer": "$$\\boxed{-\\frac{h^4}{15}}$$", "id": "3489794"}, {"introduction": "A key strength of the BSSN formalism is its ability to manage and suppress violations of the Hamiltonian and momentum constraints, which inevitably arise from numerical error. This is achieved through \"driver\" terms in the evolution equations that actively damp the constraints towards zero. In this hands-on coding exercise, you will implement a simplified numerical experiment to isolate and study this crucial damping mechanism, providing a practical understanding of how BSSN simulations maintain stability over long timescales.", "problem": "You are to implement a controlled numerical experiment to isolate the effect of the conformal connection function driver in the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formalism. The BSSN conformal connection functions are defined by $\\,\\tilde{\\Gamma}^{i} \\equiv -\\tilde{\\gamma}^{jk}\\tilde{\\Gamma}^{i}{}_{jk}\\,$ where $\\,\\tilde{\\gamma}_{ij}\\,$ is the conformal metric, and the associated conformal connection constraint is $\\,\\mathcal{G}^{i} \\equiv \\tilde{\\Gamma}^{i} - \\partial_{j}\\tilde{\\gamma}^{ij}\\,$. The goal is to isolate the effect of the driver by freezing all variables other than $\\,\\tilde{\\Gamma}^{i}\\,$ and evolving a reduced equation in one spatial dimension that captures the driver and a minimal dissipative term, then measuring the decay (or growth) rates of the constraint $\\,\\mathcal{G}^{i}$.\n\nFundamental base:\n- The Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formalism introduces conformal variables, including the conformal metric $\\,\\tilde{\\gamma}_{ij}\\,$ and the conformal connection functions $\\,\\tilde{\\Gamma}^{i}\\,$, and the constraint $\\,\\mathcal{G}^{i} \\equiv \\tilde{\\Gamma}^{i} - \\partial_{j}\\tilde{\\gamma}^{ij}\\,$.\n- In the shift-driver paradigm, source terms can be designed to damp the constraint $\\,\\mathcal{G}^{i}\\,$.\n- A reduced, one-dimensional experiment can be constructed by freezing the conformal metric $\\,\\tilde{\\gamma}_{ij}\\,$ such that $\\,\\partial_{j}\\tilde{\\gamma}^{ij}\\,$ is a constant in time, and including only driver and dissipation in the $\\,\\tilde{\\Gamma}^{i}\\,$ evolution.\n\nExperiment design to be implemented:\n1. Freeze the conformal metric and all variables other than the conformal connection function component $\\,\\tilde{\\Gamma}^{x}\\,$ so that $\\,\\partial_{j}\\tilde{\\gamma}^{ij}\\,$ is time-independent. Define $\\,\\bar{\\Gamma}^{x} \\equiv \\partial_{j}\\tilde{\\gamma}^{xj}\\,$ (a fixed function of space in this experiment), and define the conformal connection constraint as $\\,\\mathcal{G}^{x} \\equiv \\tilde{\\Gamma}^{x} - \\bar{\\Gamma}^{x}\\,$.\n2. Evolve only the reduced equation for $\\,\\tilde{\\Gamma}^{x}\\,$ with a driver and a dissipative term:\n   $$\\partial_{t}\\tilde{\\Gamma}^{x} = -\\kappa\\left(\\tilde{\\Gamma}^{x} - \\bar{\\Gamma}^{x}\\right) + \\sigma\\,\\partial_{x}^{2}\\tilde{\\Gamma}^{x},$$\n   where $\\,\\kappa \\ge 0\\,$ is a driver coefficient and $\\,\\sigma \\ge 0\\,$ represents dissipative smoothing. Under the freeze assumption, this induces the constraint evolution\n   $$\\partial_{t}\\mathcal{G}^{x} = -\\kappa\\,\\mathcal{G}^{x} + \\sigma\\,\\partial_{x}^{2}\\mathcal{G}^{x}.$$\n3. Work on a periodic domain of length $\\,L\\,$, discretized into $\\,N\\,$ points with spatial coordinate $\\,x_{j}\\,$ and spacing $\\,\\Delta x = L/N\\,$, with periodic boundary conditions. There are no physical units in this problem; all quantities are dimensionless.\n4. Initialize the constraint as a single Fourier mode:\n   $$\\mathcal{G}^{x}(x,0) = A\\,\\sin(k x), \\quad k = \\frac{2\\pi m}{L},$$\n   where $\\,m\\,$ is a nonnegative integer. The fixed background $\\,\\bar{\\Gamma}^{x}\\,$ can be set to zero without loss of generality for this experiment, which implies $\\,\\tilde{\\Gamma}^{x}(x,0) = \\mathcal{G}^{x}(x,0)\\,$ and $\\,\\bar{\\Gamma}^{x} = 0\\,$ thereafter due to freezing.\n5. Evolve the constraint $\\,\\mathcal{G}^{x}\\,$ according to the reduced equation using an explicit fourth-order Runge-Kutta method in time and a second-order centered finite-difference approximation for $\\,\\partial_{x}^{2}\\,$ on the periodic grid.\n\nMeasurement protocol:\n- At each time step, compute the mode amplitude $\\,a(t)\\,$ by projecting $\\,\\mathcal{G}^{x}(x,t)\\,$ onto $\\,\\sin(kx)\\,$ via the orthogonality relation over the periodic interval:\n  $$a(t) = \\frac{2}{L} \\int_{0}^{L} \\mathcal{G}^{x}(x,t)\\,\\sin(kx)\\,dx,$$\n  approximated by a Riemann sum on the grid.\n- Estimate the decay rate $\\,r\\,$ by a linear least-squares fit of $\\,\\ln|a(t)|\\,$ versus $\\,t\\,$ over the whole simulated time interval, and report $\\,r \\equiv -\\frac{d}{dt}\\ln|a(t)|\\,$ as a float for each test case. If the amplitude grows, the measured $\\,r\\,$ will be negative.\n\nTime-stepping details:\n- Use the explicit fourth-order Runge-Kutta scheme with time step $\\,\\Delta t\\,$ for total time $\\,T\\,$.\n- Spatial derivative $\\,\\partial_{x}^{2}\\,$ must be discretized by the second-order finite-difference stencil:\n  $$\\left.\\partial_{x}^{2}\\mathcal{G}^{x}\\right|_{j} \\approx \\frac{\\mathcal{G}^{x}_{j+1} - 2\\,\\mathcal{G}^{x}_{j} + \\mathcal{G}^{x}_{j-1}}{\\Delta x^{2}},$$\n  with periodic wrap for indices.\n\nTest suite:\nImplement the following $\\,4\\,$ parameter sets to test the driver and damping across a range of regimes. For each case, you must use the provided parameters exactly.\n\n- Case $\\,1\\,$ (general, driver and diffusion active):\n  - $\\,L = 2\\pi\\,$\n  - $\\,N = 128\\,$\n  - $\\,\\kappa = 0.1\\,$\n  - $\\,\\sigma = 0.05\\,$\n  - $\\,m = 3\\,$\n  - $\\,A = 0.2\\,$\n  - $\\,\\Delta t = 10^{-3}\\,$\n  - $\\,T = 5.0\\,$\n- Case $\\,2\\,$ (driver only, no diffusion):\n  - $\\,L = 2\\pi\\,$\n  - $\\,N = 128\\,$\n  - $\\,\\kappa = 0.2\\,$\n  - $\\,\\sigma = 0.0\\,$\n  - $\\,m = 5\\,$\n  - $\\,A = 0.2\\,$\n  - $\\,\\Delta t = 10^{-3}\\,$\n  - $\\,T = 5.0\\,$\n- Case $\\,3\\,$ (diffusion only, no driver):\n  - $\\,L = 2\\pi\\,$\n  - $\\,N = 128\\,$\n  - $\\,\\kappa = 0.0\\,$\n  - $\\,\\sigma = 0.05\\,$\n  - $\\,m = 6\\,$\n  - $\\,A = 0.2\\,$\n  - $\\,\\Delta t = 10^{-3}\\,$\n  - $\\,T = 2.0\\,$\n- Case $\\,4\\,$ (competing effects with negative driver causing growth):\n  - $\\,L = 2\\pi\\,$\n  - $\\,N = 128\\,$\n  - $\\,\\kappa = -0.05\\,$\n  - $\\,\\sigma = 0.005\\,$\n  - $\\,m = 1\\,$\n  - $\\,A = 0.2\\,$\n  - $\\,\\Delta t = 10^{-3}\\,$\n  - $\\,T = 2.0\\,$\n\nFinal output format:\n- Your program should produce a single line of output containing the measured decay rates for the cases above, as a comma-separated list enclosed in square brackets, for example $\\,\\left[ r_{1}, r_{2}, r_{3}, r_{4} \\right]\\,$ where each $\\,r_{i}\\,$ is a float.", "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, and self-contained. It describes a controlled numerical experiment to study a simplified one-dimensional reaction-diffusion equation, which serves as a toy model for understanding components of the BSSN formalism in numerical relativity. The parameters, initial conditions, and numerical methods are all specified unambiguously, allowing for a unique and meaningful solution.\n\nThe core of the experiment is to solve the partial differential equation (PDE) for the conformal connection constraint component $\\mathcal{G}^{x}(x,t)$:\n$$\n\\partial_{t}\\mathcal{G}^{x} = -\\kappa\\,\\mathcal{G}^{x} + \\sigma\\,\\partial_{x}^{2}\\mathcal{G}^{x}\n$$\non a periodic spatial domain $x \\in [0, L]$. The parameters $\\kappa$ and $\\sigma$ represent the driver and dissipation coefficients, respectively. The initial condition is a single Fourier sine mode:\n$$\n\\mathcal{G}^{x}(x,0) = A\\,\\sin(kx), \\quad \\text{where} \\quad k = \\frac{2\\pi m}{L}\n$$\nfor some integer mode number $m$.\n\nThis PDE is linear, and the initial condition $\\sin(kx)$ is an eigenfunction of the spatial operator $\\partial_{x}^{2}$. Specifically, $\\partial_{x}^{2}\\sin(kx) = -k^2\\sin(kx)$. We can therefore seek a solution of the form $\\mathcal{G}^{x}(x,t) = a(t)\\sin(kx)$. Substituting this into the PDE yields an ordinary differential equation (ODE) for the time-dependent amplitude $a(t)$:\n$$\n\\frac{da(t)}{dt}\\sin(kx) = -\\kappa\\,a(t)\\sin(kx) + \\sigma\\,(-k^2 a(t)\\sin(kx))\n$$\n$$\n\\frac{da(t)}{dt} = -(\\kappa + \\sigma k^2)a(t)\n$$\nThe solution to this ODE is an exponential decay or growth:\n$$\na(t) = a(0) e^{-(\\kappa + \\sigma k^2)t}\n$$\nwhere $a(0) = A$. The logarithm of the absolute amplitude is linear in time:\n$$\n\\ln|a(t)| = \\ln|A| - (\\kappa + \\sigma k^2)t\n$$\nThe theoretical decay rate $r$, defined as $r \\equiv -\\frac{d}{dt}\\ln|a(t)|$, is therefore a constant given by:\n$$\nr = \\kappa + \\sigma k^2\n$$\nThe numerical experiment aims to recover this rate by simulating the PDE and fitting the resulting amplitude data.\n\nThe numerical implementation proceeds as follows:\n1. The continuous spatial domain of length $L$ is discretized into a grid of $N$ points $x_j = j \\Delta x$ for $j = 0, 1, \\dots, N-1$, with grid spacing $\\Delta x = L/N$. The function $\\mathcal{G}^x(x,t)$ is represented by an array of values $\\mathcal{G}^x_j(t)$ at each grid point.\n\n2. The spatial derivative $\\partial_{x}^{2}$ is approximated using a second-order centered finite-difference stencil. Due to the periodic boundary conditions, the neighbors of the endpoints wrap around. The discrete Laplacian at grid point $j$ is:\n$$\n\\left.\\partial_{x}^{2}\\mathcal{G}^{x}\\right|_{j} \\approx \\frac{\\mathcal{G}^{x}_{j+1} - 2\\,\\mathcal{G}^{x}_{j} + \\mathcal{G}^{x}_{j-1}}{\\Delta x^{2}}\n$$\nwhere indices are taken modulo $N$.\n\n3. The resulting system of coupled ODEs (one for each grid point) is evolved in time using the explicit fourth-order Runge-Kutta (RK4) method with a fixed time step $\\Delta t$. For a given state vector $\\mathbf{G}(t) = \\{\\mathcal{G}^x_j(t)\\}$, the right-hand side of the ODE system is $\\mathbf{F}(\\mathbf{G}) = -\\kappa \\mathbf{G} + \\sigma \\nabla^2 \\mathbf{G}$, where $\\nabla^2$ is the discrete Laplacian operator. The RK4 update from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ is:\n$$\n\\begin{aligned}\n\\mathbf{k}_1 &= \\mathbf{F}(\\mathbf{G}(t_n)) \\\\\n\\mathbf{k}_2 &= \\mathbf{F}(\\mathbf{G}(t_n) + \\frac{\\Delta t}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 &= \\mathbf{F}(\\mathbf{G}(t_n) + \\frac{\\Delta t}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 &= \\mathbf{F}(\\mathbf{G}(t_n) + \\Delta t\\,\\mathbf{k}_3) \\\\\n\\mathbf{G}(t_{n+1}) &= \\mathbf{G}(t_n) + \\frac{\\Delta t}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{aligned}\n$$\n\n4. At each time step $t$, the amplitude $a(t)$ of the mode $\\sin(kx)$ is extracted from the numerical solution $\\mathcal{G}^x_j(t)$ by numerically evaluating the integral for the corresponding Fourier coefficient:\n$$\na(t) = \\frac{2}{L} \\int_{0}^{L} \\mathcal{G}^{x}(x,t)\\,\\sin(kx)\\,dx\n$$\nThis integral is approximated by a Riemann sum over the discrete grid points:\n$$\na(t) \\approx \\frac{2}{L} \\sum_{j=0}^{N-1} \\mathcal{G}^x_j(t)\\,\\sin(kx_j)\\,\\Delta x = \\frac{2}{N} \\sum_{j=0}^{N-1} \\mathcal{G}^x_j(t)\\,\\sin(kx_j)\n$$\n\n5. After the simulation is complete for a total time $T$, a set of data points $(t_n, \\ln|a(t_n)|)$ is collected. A linear least-squares fit is performed on this data to find the best-fit line $y(t) = p_1 t + p_0$. The slope $p_1$ is the numerical estimate of the derivative $\\frac{d}{dt}\\ln|a(t)|$. The decay rate $r$ is then calculated as $r = -p_1$. This procedure is repeated for each of the $4$ test cases provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the reduced BSSN constraint evolution equation for four test cases\n    and reports the measured decay rates.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general, driver and diffusion active\n        {'L': 2 * np.pi, 'N': 128, 'kappa': 0.1, 'sigma': 0.05, 'm': 3,\n         'A': 0.2, 'dt': 1e-3, 'T': 5.0},\n        # Case 2: driver only, no diffusion\n        {'L': 2 * np.pi, 'N': 128, 'kappa': 0.2, 'sigma': 0.0, 'm': 5,\n         'A': 0.2, 'dt': 1e-3, 'T': 5.0},\n        # Case 3: diffusion only, no driver\n        {'L': 2 * np.pi, 'N': 128, 'kappa': 0.0, 'sigma': 0.05, 'm': 6,\n         'A': 0.2, 'dt': 1e-3, 'T': 2.0},\n        # Case 4: competing effects with negative driver causing growth\n        {'L': 2 * np.pi, 'N': 128, 'kappa': -0.05, 'sigma': 0.005, 'm': 1,\n         'A': 0.2, 'dt': 1e-3, 'T': 2.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters\n        L = case['L']\n        N = case['N']\n        kappa = case['kappa']\n        sigma = case['sigma']\n        m = case['m']\n        A = case['A']\n        dt = case['dt']\n        T = case['T']\n\n        # Setup spatial grid\n        dx = L / N\n        x = np.linspace(0, L, N, endpoint=False)\n        \n        # Wavenumber\n        k = (2 * np.pi * m) / L\n\n        # Initial condition\n        G_x = A * np.sin(k * x)\n\n        def rhs(G, kappa_val, sigma_val, dx_val):\n            \"\"\"\n            Computes the right-hand side of the PDE: dG/dt = -kappa*G + sigma*d^2G/dx^2\n            \"\"\"\n            # 2nd-order finite difference for Laplacian with periodic boundaries\n            laplacian_G = (np.roll(G, -1) - 2 * G + np.roll(G, 1)) / (dx_val**2)\n            return -kappa_val * G + sigma_val * laplacian_G\n\n        times = []\n        amplitudes = []\n\n        t = 0.0\n        num_steps = int(round(T / dt))\n\n        for step in range(num_steps + 1):\n            # Measurement protocol: Compute mode amplitude a(t)\n            # a(t) = (2/L) * integral(G(x,t) * sin(kx) dx)\n            # Approximated by Riemann sum: (2/L) * sum(G * sin(kx) * dx)\n            # which simplifies to (2/N) * sum(G * sin(kx)) since dx = L/N\n            amplitude = (2.0 / N) * np.sum(G_x * np.sin(k * x))\n            \n            # Store data for linear regression, avoiding log(0)\n            if np.abs(amplitude) > 1e-15:\n                times.append(t)\n                amplitudes.append(amplitude)\n\n            if step == num_steps:\n                break\n\n            # Time evolution: 4th-order Runge-Kutta\n            k1 = rhs(G_x, kappa, sigma, dx)\n            k2 = rhs(G_x + 0.5 * dt * k1, kappa, sigma, dx)\n            k3 = rhs(G_x + 0.5 * dt * k2, kappa, sigma, dx)\n            k4 = rhs(G_x + dt * k3, kappa, sigma, dx)\n            G_x += (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n            \n            t += dt\n\n        # Convert lists to numpy arrays for calculation\n        times = np.array(times)\n        amplitudes = np.array(amplitudes)\n\n        # Measurement protocol: Estimate decay rate r\n        # Fit ln|a(t)| versus t to a line: y = p1*t + p0\n        log_abs_amplitudes = np.log(np.abs(amplitudes))\n        \n        # polyfit returns [slope, intercept] for degree 1\n        coeffs = np.polyfit(times, log_abs_amplitudes, 1)\n        slope = coeffs[0]\n        \n        # Decay rate r is defined as r = -d/dt(ln|a(t)|)\n        r = -slope\n        results.append(r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3489765"}, {"introduction": "The \"moving puncture\" approach revolutionized black hole simulations by providing a robust method for handling singularities. The technique relies on a specific choice of gauge and an ansatz for the BSSN fields that ensures the physical curvature remains finite at the puncture, even as the conformal metric diverges. This practice delves into the theoretical underpinnings of this method, requiring you to derive the precise mathematical conditions on the BSSN fields that guarantee a regular spacetime geometry near a black hole puncture.", "problem": "Consider a spherically symmetric neighborhood of a black-hole puncture at $r=0$ in the context of the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formalism, used in numerical relativity and gravitational-wave modeling. The spatial metric is written in a conformally flat form as $\\gamma_{ij} = e^{4 \\phi(r)} \\delta_{ij}$ with conformal factor $e^{4 \\phi(r)}$, and the trace of the extrinsic curvature is $K(r)$. In the moving-puncture approach, it is of practical interest to assess regularity at the puncture under BSSN updates by testing leading-order behavior of curvature invariants when $\\phi(r)$ and $K(r)$ follow prescribed asymptotics.\n\nAssume the following leading-order radial ansatz near the puncture:\n- $K(r) \\sim k_0 \\, r^{p}$ for some constant $k_0$ and real exponent $p$,\n- $\\phi(r) \\sim a \\log r$ for some real constant $a$.\n\nWork in the $3+1$ decomposition and use only well-established geometric identities and definitions to reason about regularity:\n- The $3$-dimensional spatial Ricci tensor $R_{ij}^{(3)}$ and Ricci scalar $R^{(3)}$ for a conformal rescaling $\\gamma_{ij} = e^{4 \\phi} \\tilde{\\gamma}_{ij}$, with $\\tilde{\\gamma}_{ij}$ flat, expressed in terms of $\\phi$ and its derivatives with respect to the flat background geometry.\n- The Gauss and Codazzi relations that connect the $4$-dimensional Riemann tensor $R_{abcd}$ to the spatial curvature and extrinsic curvature in the $3+1$ split.\n- The definition of the Kretschmann scalar $K_{\\mathrm{ret}} = R_{abcd} R^{abcd}$.\n\nStarting from these bases, derive an algorithm that, for given $(a,p)$, determines whether the leading-order behavior of the Kretschmann scalar $K_{\\mathrm{ret}}$ is finite as $r \\to 0$ under BSSN updates with the moving-puncture assumptions stated above and with the leading-order traceless part of the extrinsic curvature negligible compared to its trace. Your derivation should identify the dominant scaling in $r$ of the curvature contributions from:\n- Spatial curvature of $e^{4 \\phi} \\delta_{ij}$,\n- The extrinsic-curvature quadratic term from the Gauss relation,\n- The spatial-derivative term from the Codazzi relation.\n\nThen, implement a program that, given $(a,p)$, decides regularity by checking whether all leading-order contributions do not diverge as $r \\to 0$. The decision must be a boolean result: $True$ if the contributions remain finite, and $False$ otherwise. You may assume $k_0 \\neq 0$ is finite and nonzero, and you should treat $r$ only through asymptotic scaling decisions, not by evaluating at $r=0$.\n\nTest Suite:\nUse the following parameter sets to test your implementation:\n1. $(a,p) = (-0.5, 0.0)$,\n2. $(a,p) = (-0.6, 0.0)$,\n3. $(a,p) = (-0.4, 0.0)$,\n4. $(a,p) = (-0.5, -0.1)$,\n5. $(a,p) = (-0.5, 0.1)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the boolean results for the five test cases as a comma-separated list enclosed in square brackets (for example, $[True,False,True,True,False]$). No additional text should be printed.", "solution": "The problem asks for an algorithm to determine the regularity of the spacetime at a black hole puncture, based on the asymptotic behavior of the BSSN fields. Regularity is determined by whether the Kretschmann scalar, $K_{\\mathrm{ret}} = R_{abcd} R^{abcd}$, remains finite as the radial coordinate $r \\to 0$. The analysis is performed in the $3+1$ decomposition of spacetime. The Kretschmann scalar can be expressed in terms of the spatial Riemann tensor $R^{(3)}_{ijkl}$, the extrinsic curvature $K_{ij}$, and its spatial derivatives. We must analyze the scaling of the three main contributions to $K_{\\mathrm{ret}}$ as $r \\to 0$.\n\nThe given asymptotic behaviors are:\n- Conformal factor: $\\phi(r) \\sim a \\log r$, which implies $e^{\\phi} \\sim r^a$.\n- Spatial metric: $\\gamma_{ij} = e^{4\\phi} \\delta_{ij} \\sim r^{4a} \\delta_{ij}$. The inverse is $\\gamma^{ij} \\sim r^{-4a} \\delta^{ij}$.\n- Extrinsic curvature trace: $K(r) \\sim k_0 r^{p}$.\n- Traceless extrinsic curvature $A_{ij}$ is negligible, so $K_{ij} \\approx \\frac{1}{3}\\gamma_{ij}K$.\n\n#### 1. Contribution from Spatial Curvature\nThis contribution scales with invariants like $(R^{(3)})^2$ and $R^{(3)}_{ij}R^{(3)ij}$. For a conformally flat metric $\\gamma_{ij} = e^{4\\phi}\\delta_{ij}$, the components of the Ricci tensor $R^{(3)}_{ij}$ are constructed from second derivatives of $\\phi$. With $\\phi \\sim a \\log r$, we have $\\partial_k \\phi \\sim r^{-1}$ and $\\partial_j \\partial_k \\phi \\sim r^{-2}$. Therefore, the components of the Ricci tensor scale as:\n$$ R^{(3)}_{ij} \\sim r^{-2} $$\nThe Ricci scalar is $R^{(3)} = \\gamma^{ij} R^{(3)}_{ij}$, which scales as:\n$$ R^{(3)} \\sim (r^{-4a}) (r^{-2}) = r^{-4a-2} $$\nThe invariant $(R^{(3)})^2$ then scales as $(r^{-4a-2})^2 = r^{-8a-4}$.\nSimilarly, the invariant $R^{(3)}_{ij}R^{(3)ij} = R^{(3)}_{ij} \\gamma^{ik} \\gamma^{jl} R^{(3)}_{kl}$ scales as $(r^{-2}) (r^{-4a}) (r^{-4a}) (r^{-2}) = r^{-8a-4}$.\nFor this contribution to remain finite as $r \\to 0$, the exponent must be non-negative:\n$$ -8a - 4 \\ge 0 \\implies 8a \\le -4 \\implies \\boxed{a \\le -0.5} $$\n\n#### 2. Contribution from Extrinsic Curvature Quadratic Term\nThis contribution arises from terms in the Gauss-Codazzi equations that are quadratic in $K_{ij}$, leading to terms quartic in $K_{ij}$ in the Kretschmann scalar. A representative term is $R_{0i0j}R^{0i0j}$. The Gauss relation gives $R_{0i0j} \\approx -K_{ik}K^k_j$ (ignoring lapse terms for scaling analysis).\n\nFirst, find the scaling of $K_{ij}$ components:\n$$ K_{ij} \\approx \\frac{1}{3}\\gamma_{ij}K \\sim (r^{4a}) (r^p) \\delta_{ij} = r^{4a+p} \\delta_{ij} $$\nThe mixed-index tensor $K^k_j = \\gamma^{kl}K_{lj}$ scales as:\n$$ K^k_j \\sim (r^{-4a}) (r^{4a+p}) = r^p $$\nThe components of $R_{0i0j}$ scale as:\n$$ R_{0i0j} \\approx -K_{ik}K^k_j \\sim (r^{4a+p}) (r^p) = r^{4a+2p} $$\nTo form the scalar $R_{0i0j}R^{0i0j} = R_{0i0j} g^{00} g^{00} \\gamma^{ik} \\gamma^{jl} R_{0k0l}$, we contract with inverse metrics. Ignoring the $g^{00}$ constant factor, the scaling is:\n$$ R_{0i0j}R^{0i0j} \\sim (r^{4a+2p}) (\\text{inverse metrics}) (r^{4a+2p}) \\sim (r^{4a+2p}) (r^{-4a}) (r^{-4a}) (r^{4a+2p}) = r^{4p} $$\nFor this term to be finite as $r \\to 0$, the exponent must be non-negative:\n$$ 4p \\ge 0 \\implies \\boxed{p \\ge 0} $$\n\n#### 3. Contribution from Spatial Derivatives of Extrinsic Curvature\nThis contribution arises from the term $R_{0ijk}R^{0ijk}$. The Codazzi relation gives $R_{0ijk} = D_j K_{ik} - D_k K_{ij}$, where $D_j$ is the covariant derivative compatible with $\\gamma_{ij}$.\n$$ D_j K_{ik} = \\partial_j K_{ik} - \\Gamma^l_{ji} K_{lk} - \\Gamma^l_{jk} K_{il} $$\nThe Christoffel symbols $\\Gamma^l_{jk}$ for the metric $\\gamma_{ij} \\sim r^{4a}\\delta_{ij}$ scale as $\\Gamma \\sim \\partial_j \\gamma_{ik} \\sim r^{4a-1}$, which when raised with $\\gamma^{im}$ give $\\Gamma^l_{jk} \\sim r^{-1}$. The components $K_{ik}$ scale as $r^{4a+p}$. The partial derivative term $\\partial_j K_{ik}$ scales as $\\partial_r (r^{4a+p}) \\sim r^{4a+p-1}$. The connection terms $\\Gamma K$ scale as $(r^{-1})(r^{4a+p}) = r^{4a+p-1}$.\nThe leading-order scaling of the components of $D_j K_{ik}$ and thus $R_{0ijk}$ is:\n$$ R_{0ijk} \\sim r^{4a+p-1} $$\nThe scalar invariant $R_{0ijk}R^{0ijk}$ is formed by contracting with three inverse spatial metrics:\n$$ R_{0ijk}R^{0ijk} \\sim (r^{4a+p-1}) (r^{-4a}) (r^{-4a}) (r^{-4a}) (r^{4a+p-1}) = r^{-4a+2p-2} $$\nFor this contribution to remain finite as $r \\to 0$, the exponent must be non-negative:\n$$ -4a + 2p - 2 \\ge 0 \\implies 2p - 2 \\ge 4a \\implies \\boxed{a \\le \\frac{p-1}{2}} $$\n\n### Algorithm and Conditions\nFor the Kretschmann scalar to be regular, all three contributions must be finite. This requires that for a given pair $(a,p)$, all three derived inequalities are satisfied simultaneously:\n1. $a \\le -0.5$\n2. $p \\ge 0.0$\n3. $a \\le (p - 1.0) / 2.0$\n\nThe algorithm is to take a pair $(a,p)$ as input and return the logical AND of these three boolean conditions.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates a set of BSSN puncture parameters (a, p) against regularity conditions\n    derived from the asymptotic analysis of the Kretschmann scalar.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (-0.5, 0.0),  # 1\n        (-0.6, 0.0),  # 2\n        (-0.4, 0.0),  # 3\n        (-0.5, -0.1), # 4\n        (-0.5, 0.1),  # 5\n    ]\n\n    results = []\n    for a, p in test_cases:\n        # The Kretschmann scalar is regular at the puncture if and only if\n        # all of its constituent parts (spatial curvature, extrinsic curvature\n        # quadratic, and extrinsic curvature derivative) remain finite as r -> 0.\n        # This translates to three conditions on the parameters (a, p).\n\n        # Condition 1: Spatial curvature contribution regularity.\n        # This term scales as r^(-8a - 4). For it to be finite, the exponent must be >= 0.\n        # -8a - 4 >= 0  => a = -0.5\n        cond1 = (a = -0.5)\n\n        # Condition 2: Extrinsic curvature quadratic contribution regularity.\n        # This term scales as r^(4p). For it to be finite, the exponent must be >= 0.\n        # 4p >= 0 => p >= 0\n        cond2 = (p >= 0.0)\n\n        # Condition 3: Extrinsic curvature derivative contribution regularity.\n        # This term scales as r^(-4a + 2p - 2). For it to be finite, the exponent must be >= 0.\n        # -4a + 2p - 2 >= 0 => a = (p - 1) / 2\n        cond3 = (a = (p - 1.0) / 2.0)\n        \n        # The overall regularity requires all three conditions to be met.\n        is_regular = cond1 and cond2 and cond3\n        results.append(is_regular)\n\n    # The final print statement must produce a single-line string representation\n    # of the list of boolean results, as specified in the problem.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3489810"}]}