{"hands_on_practices": [{"introduction": "Before evolving spacetime forward in time, one must first construct a valid set of initial data on a spatial hypersurface. These initial conditions are not arbitrary; they are bound by the Hamiltonian and momentum constraints of general relativity. This foundational exercise [@problem_id:3490067] guides you through an analytical solution of these constraints for a time-symmetric, conformally flat spacetime, a scenario which provides the well-known Bowen-York initial data for multiple non-spinning black holes.", "problem": "Consider the vacuum Einstein constraint equations on a three-dimensional manifold with Riemannian metric, to be evolved according to the Cauchy problem of general relativity. Let the initial data manifold be $\\mathbb{R}^{3}$, and adopt the conformal method in which the physical metric is written as $\\bar{g}_{ij} = \\phi^{4} \\gamma_{ij}$ and the physical extrinsic curvature as $\\bar{K}_{ij} = \\phi^{-2} A_{ij} + \\tfrac{1}{3}\\phi^{4}\\gamma_{ij} K$, where $\\gamma_{ij}$ is a chosen background metric, $\\phi$ is a positive conformal factor, $K$ is the mean curvature, and $A_{ij}$ is a symmetric transverse-traceless tensor with respect to $\\gamma_{ij}$. Assume vacuum, so the constraint equations are the Hamiltonian constraint $R(\\bar{g}) + K^{2} - \\bar{K}_{ij}\\bar{K}^{ij} = 0$ and the momentum constraint $\\bar{\\nabla}^{j}\\bar{K}_{ij} - \\bar{\\nabla}_{i} K = 0$, where $R(\\bar{g})$ is the scalar curvature of $\\bar{g}_{ij}$ and $\\bar{\\nabla}$ is the Levi-Civita connection of $\\bar{g}_{ij}$. In the conformal method, the Hamiltonian constraint reduces to the Lichnerowicz equation\n$$\n\\Delta_{\\gamma} \\phi - \\tfrac{1}{8} R(\\gamma)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} A_{ij}A^{ij} - \\tfrac{1}{12}K^{2}\\phi^{5} = 0,\n$$\nwhere $\\Delta_{\\gamma}$ and $R(\\gamma)$ are the Laplace-Beltrami operator and scalar curvature of $\\gamma_{ij}$, respectively.\n\nWork with time-symmetric data, meaning $K_{ij} = 0$, which implies $K = 0$ and $A_{ij} = 0$. Choose a conformally flat background metric $\\gamma_{ij} = \\delta_{ij}$ on $\\mathbb{R}^{3}$ so that $R(\\gamma) = 0$. Then $\\phi$ satisfies the reduced equation\n$$\n\\Delta \\phi = 0\n$$\non the punctured domain $\\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{1},\\dots,\\mathbf{c}_{N}\\}$, where $\\{\\mathbf{c}_{a}\\}_{a=1}^{N} \\subset \\mathbb{R}^{3}$ are distinct points representing separate asymptotically flat ends. Impose the asymptotic flatness condition $\\phi(\\mathbf{x}) \\to 1$ as $|\\mathbf{x}| \\to \\infty$, and require that near each puncture $\\mathbf{c}_{a}$ the conformal factor has the local behavior\n$$\n\\phi(\\mathbf{x}) = \\frac{m_{a}}{2\\,|\\mathbf{x} - \\mathbf{c}_{a}|} + \\text{regular at } \\mathbf{c}_{a},\n$$\nwith fixed parameters $m_{a} > 0$ for $a = 1,\\dots,N$. Using only the vacuum constraints and standard elliptic theory as foundational principles, determine the unique harmonic function $\\phi(\\mathbf{x})$ on $\\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{a}\\}$ satisfying these boundary conditions. Give your final answer as a single closed-form analytical expression for $\\phi(\\mathbf{x})$. No numerical approximation is required, and no units are to be reported in the final answer.", "solution": "The problem asks for the unique solution for the conformal factor $\\phi$ under a specific set of simplifying assumptions within the context of the Cauchy problem for Einstein's vacuum field equations. The provided framework is the conformal method for constructing initial data.\n\nThe central equation governing the conformal factor $\\phi$ is the Hamiltonian constraint, which in the conformal decomposition takes the form of the Lichnerowicz equation:\n$$\n\\Delta_{\\gamma} \\phi - \\tfrac{1}{8} R(\\gamma)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} A_{ij}A^{ij} - \\tfrac{1}{12}K^{2}\\phi^{5} = 0.\n$$\nThe problem specifies several conditions:\n1.  The initial data is time-symmetric, which means the extrinsic curvature of the initial slice vanishes, $\\bar{K}_{ij} = 0$. This implies that its trace, the mean curvature $K=\\bar{g}^{ij}\\bar{K}_{ij}$, is zero, and its trace-free part, $A_{ij}$, is also zero. So, $K=0$ and $A_{ij}=0$.\n2.  The background metric $\\gamma_{ij}$ on the manifold $\\mathbb{R}^3$ is chosen to be the flat Euclidean metric, $\\gamma_{ij} = \\delta_{ij}$. The scalar curvature of the flat metric is zero, $R(\\gamma) = 0$. The corresponding Laplace-Beltrami operator $\\Delta_{\\gamma}$ becomes the standard Laplacian on $\\mathbb{R}^3$, denoted by $\\Delta$.\n\nSubstituting these conditions, $R(\\gamma)=0$, $A_{ij}=0$, and $K=0$, into the Lichnerowicz equation gives:\n$$\n\\Delta \\phi - \\tfrac{1}{8} (0)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} (0) - \\tfrac{1}{12}(0)^{2}\\phi^{5} = 0,\n$$\nwhich simplifies to the three-dimensional Laplace equation:\n$$\n\\Delta \\phi(\\mathbf{x}) = 0.\n$$\nThis equation for $\\phi(\\mathbf{x})$ must be solved on the domain $\\mathcal{D} = \\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{1},\\dots,\\mathbf{c}_{N}\\}$, where $\\{\\mathbf{c}_{a}\\}_{a=1}^{N}$ are $N$ distinct points, subject to a set of boundary conditions.\n\nThe boundary conditions are:\n1.  Asymptotic flatness: $\\phi(\\mathbf{x}) \\to 1$ as $|\\mathbf{x}| \\to \\infty$. This condition is imposed at the \"boundary at infinity\" of the domain.\n2.  Puncture behavior: Near each point $\\mathbf{c}_{a}$, the function $\\phi(\\mathbf{x})$ must exhibit a specific singular behavior:\n    $$\n    \\phi(\\mathbf{x}) = \\frac{m_{a}}{2\\,|\\mathbf{x} - \\mathbf{c}_{a}|} + \\text{regular at } \\mathbf{c}_{a}.\n    $$\n    The term \"regular at $\\mathbf{c}_{a}$\" implies that the remainder of $\\phi(\\mathbf{x})$ after subtracting the singular part is a harmonic function in a neighborhood that includes the point $\\mathbf{c}_{a}$.\n\nThis setup constitutes a standard boundary value problem in potential theory. Since the Laplace equation is a linear partial differential equation, we can use the principle of superposition to construct the solution. We seek a function that is harmonic on $\\mathcal{D}$ and satisfies the specified behaviors at the boundaries of $\\mathcal{D}$ (i.e., at infinity and at the punctures $\\mathbf{c}_{a}$).\n\nLet's build the solution from elementary harmonic functions.\nA constant function is harmonic. The function $f(\\mathbf{x}) = 1/|\\mathbf{x}-\\mathbf{y}|$ is the fundamental solution of the Laplacian in three dimensions and is harmonic for all $\\mathbf{x} \\neq \\mathbf{y}$.\n\nConsider the following general form for the solution, which is a linear combination of these elementary harmonic functions:\n$$\n\\phi(\\mathbf{x}) = C + \\sum_{a=1}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|},\n$$\nwhere $C$ and the set of coefficients $\\{C_a\\}_{a=1}^{N}$ are constants to be determined. By construction, this function is harmonic everywhere except at the points $\\mathbf{c}_a$, thus satisfying $\\Delta\\phi=0$ on the domain $\\mathcal{D}$.\n\nWe now apply the boundary conditions to determine the constants.\nFirst, let's examine the asymptotic behavior as $|\\mathbf{x}| \\to \\infty$. In this limit, each term of the sum vanishes:\n$$\n\\lim_{|\\mathbf{x}| \\to \\infty} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|} = 0.\n$$\nSo, the limit of our proposed solution is:\n$$\n\\lim_{|\\mathbf{x}| \\to \\infty} \\phi(\\mathbf{x}) = C.\n$$\nTo satisfy the asymptotic flatness condition $\\phi(\\mathbf{x}) \\to 1$, we must set $C=1$. The candidate solution becomes:\n$$\n\\phi(\\mathbf{x}) = 1 + \\sum_{a=1}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|}.\n$$\nNext, let's impose the condition at each puncture. Fix an index $b \\in \\{1, \\dots, N\\}$ and examine the function's behavior near $\\mathbf{c}_b$. We can separate the $b$-th term from the sum:\n$$\n\\phi(\\mathbf{x}) = \\frac{C_b}{|\\mathbf{x} - \\mathbf{c}_b|} + \\left( 1 + \\sum_{a=1, a \\neq b}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|} \\right).\n$$\nThe expression within the parentheses, let's call it $h_b(\\mathbf{x})$, is a sum of a constant and functions of the form $1/|\\mathbf{x} - \\mathbf{c}_a|$ where $a \\neq b$. As $\\mathbf{x}$ approaches $\\mathbf{c}_b$, none of the denominators $|\\mathbf{x} - \\mathbf{c}_a|$ for $a \\neq b$ approach zero. Therefore, $h_b(\\mathbf{x})$ is well-defined, continuously differentiable, and harmonic in a neighborhood of $\\mathbf{c}_b$. In other words, $h_b(\\mathbf{x})$ is the \"regular part\" of the solution at $\\mathbf{c}_b$.\n\nThe problem requires the singular part of $\\phi(\\mathbf{x})$ at $\\mathbf{c}_b$ to be precisely $\\frac{m_{b}}{2\\,|\\mathbf{x} - \\mathbf{c}_{b}|}$. By comparing this with the singular part of our candidate solution, $\\frac{C_b}{|\\mathbf{x} - \\mathbf{c}_b|}$, we can uniquely determine the coefficient $C_b$:\n$$\nC_b = \\frac{m_b}{2}.\n$$\nThis logic applies to every puncture $a = 1, \\dots, N$. Thus, we have determined all the coefficients: $C_a = \\frac{m_a}{2}$.\n\nSubstituting these coefficients into our general form yields the unique solution:\n$$\n\\phi(\\mathbf{x}) = 1 + \\sum_{a=1}^{N} \\frac{m_a}{2|\\mathbf{x} - \\mathbf{c}_a|}.\n$$\nThis function satisfies Laplace's equation on the punctured domain and all specified boundary conditions. The uniqueness of this solution is guaranteed by standard theorems of potential theory for exterior boundary value problems. This particular solution is known in the relativity literature as the Bowen-York solution for time-symmetric, conformally flat initial data corresponding to $N$ black holes.", "answer": "$$\n\\boxed{1 + \\sum_{a=1}^{N} \\frac{m_a}{2|\\mathbf{x} - \\mathbf{c}_a|}}\n$$", "id": "3490067"}, {"introduction": "The long-term predictability of a numerical spacetime evolution is critically dependent on the hyperbolic character of the governing equations. This hands-on coding practice [@problem_id:3490105] uses a simplified toy model to illustrate how certain 'gauge' choices can inadvertently change the equations from hyperbolic to elliptic, destroying the well-posedness of the Cauchy problem. By numerically observing the explosive growth that follows this transition, you will develop a concrete understanding of why maintaining hyperbolicity is essential for stable simulations.", "problem": "Consider a toy Partial Differential Equation (PDE) intended to mimic how gauge choices in General Relativity (GR) can affect the hyperbolicity of evolution equations and the well-posedness of the Cauchy problem. Let $u = u(t,x)$ be a scalar field on a one-dimensional spatial domain with periodic boundary conditions, and consider the PDE\n$$\n\\partial_t^2 u(t,x) \\;=\\; g(t)\\,\\partial_x^2 u(t,x),\n$$\non the periodic interval $x \\in [0,2\\pi]$ with angles measured in radians. Assume smooth initial data $u(0,x)$ and $\\partial_t u(0,x)$.\n\nYou are to treat this as a Cauchy problem and analyze the principal symbol and its dependence on a gauge-like function $g(t)$, showing how the classification of the PDE changes as $g(t)$ varies. The context is numerical relativity and gravitational waves, where global hyperbolicity guarantees well-posedness of the Cauchy problem for physically meaningful gauges; this toy model abstracts how poorly chosen gauges can destroy hyperbolicity.\n\nDefinitions and foundational bases:\n- The Cauchy problem asks whether given $u(0,x)$ and $\\partial_t u(0,x)$ one obtains a unique solution $u(t,x)$ that depends continuously on the initial data for $t \\ge 0$.\n- The principal symbol of a second-order PDE in two variables $t,x$ with co-vector $(\\tau,\\xi)$ has the form $p(\\tau,\\xi;t) = A(t)\\,\\tau^2 + B(t)\\,\\tau\\,\\xi + C(t)\\,\\xi^2$, where classification into hyperbolic, parabolic, or elliptic is determined by the discriminant $D(t) = B(t)^2 - 4 A(t) C(t)$.\n- For the given PDE, $A(t) = 1$, $B(t) = 0$, and $C(t) = -g(t)$, so the principal symbol is $p(\\tau,\\xi;t) = \\tau^2 - g(t)\\,\\xi^2$. Hyperbolicity corresponds to real characteristic speeds and hence $D(t) > 0$, ellipticity to $D(t)  0$, and parabolic degeneracy to $D(t) = 0$.\n- In numerical relativity, global hyperbolicity ensures that the evolution equations are hyperbolic in a globally consistent way, making the Cauchy problem well-posed globally on the spacetime. Loss of hyperbolicity corresponds to the breakdown of global hyperbolicity in the toy model.\n\nTasks:\n1. Starting from the definition of principal symbol and the discriminant, show in your solution how the sign of $g(t)$ determines whether the PDE is hyperbolic, elliptic, or degenerate. Then, explain why the initial-value problem is well-posed when $g(t) > 0$ (hyperbolic) and ill-posed when $g(t)  0$ (elliptic), and discuss the parabolic/degenerate boundary case $g(t) = 0$.\n2. Numerically integrate the PDE using a second-order accurate explicit time-stepping scheme for a Fourier-spectral spatial discretization with $N_x$ equispaced points on $[0,2\\pi]$ (angles in radians). Use initial data $u(0,x) = \\sin(x)$ and $\\partial_t u(0,x) = 0$.\n3. Define a dimensionless gauge function $g(t)$ for each test case and simulate over a fixed time window $t \\in [0,T_{\\text{end}}]$ with a uniform time step $\\Delta t$. For numerical stability and clarity, use $N_x = 256$, $T_{\\text{end}} = 2$, and $\\Delta t = 10^{-3}$.\n4. Track the squared $L^2$ energy\n$$\nE(t) \\;=\\; \\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)^2\\,dx,\n$$\nand define the energy growth factor $R(t) = E(t)/E(0)$. Let the ill-posedness onset time $t_{\\text{onset}}$ be the earliest time at which $R(t)$ first exceeds a threshold $R_{\\text{thr}} = 10$. If no such exceedance occurs by $T_{\\text{end}}$, set $t_{\\text{onset}} = -1$.\n5. Implement the following test suite of gauge functions $g(t)$:\n   - Case $1$ (globally hyperbolic): $g(t) = 1$ for all $t \\in [0,T_{\\text{end}}]$.\n   - Case $2$ (hyperbolic-to-elliptic transition): $g(t) = 1 - t$ for $t \\in [0,T_{\\text{end}}]$, which crosses from positive to negative at $t = 1$.\n   - Case $3$ (globally elliptic): $g(t) = -1$ for all $t \\in [0,T_{\\text{end}}]$.\n   - Case $4$ (degenerate boundary): $g(t) = 0$ for all $t \\in [0,T_{\\text{end}}]$.\n6. For each case, compute $t_{\\text{onset}}$ in dimensionless time units and aggregate the results into a single line of output containing the $4$ onset times as a comma-separated list enclosed in square brackets.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[t_1,t_2,t_3,t_4]$), where each $t_i$ is a floating-point number representing the ill-posedness onset time in dimensionless units, with $t_i = -1$ indicating that no onset occurred within the simulation window.\n\nThe implementation must be self-contained and runnable as-is, without any user input or external files. All angles are in radians, and all quantities are dimensionless. Ensure scientific realism by using the specified numerical parameters and by handling the transition case to demonstrate the onset of ill-posedness when the principal symbol changes sign. The output must strictly follow the prescribed single-line format.", "solution": "The problem presents a toy model for analyzing the well-posedness of the Cauchy problem in the context of partial differential equations (PDEs) that arise in numerical relativity. We are given a second-order linear PDE, $\\partial_t^2 u(t,x) = g(t)\\,\\partial_x^2 u(t,x)$, where the function $g(t)$ acts as a \"gauge choice\" that can alter the fundamental character of the equation. We will first provide a theoretical analysis of the PDE's classification and its implications for the initial-value problem. Subsequently, we will describe the numerical scheme used to simulate the evolution and detect the onset of ill-posedness.\n\n### Theoretical Analysis: PDE Classification and Well-Posedness\n\nThe given PDE is\n$$ \\partial_t^2 u(t,x) = g(t)\\,\\partial_x^2 u(t,x) $$\nwhich can be rewritten as\n$$ \\partial_t^2 u(t,x) - g(t)\\,\\partial_x^2 u(t,x) = 0. $$\nTo classify this PDE, we analyze its principal symbol. For a general second-order PDE in two variables $(t,x)$, given by $\\sum_{i,j} A_{ij} \\partial_i \\partial_j u + \\dots = 0$, the principal symbol is obtained by replacing each partial derivative $\\partial_i$ with a corresponding co-vector component $\\sigma_i$. Here, we use $(\\tau, \\xi)$ as the co-vector dual to $(t,x)$. We replace $\\partial_t \\rightarrow \\tau$ and $\\partial_x \\rightarrow \\xi$ in the highest-order terms of the PDE. This yields the characteristic polynomial:\n$$ p(\\tau, \\xi; t) = \\tau^2 - g(t)\\xi^2. $$\nThis is a quadratic form in $(\\tau, \\xi)$. Its classification into hyperbolic, elliptic, or parabolic types depends on its discriminant. For a general form $A\\tau^2 + B\\tau\\xi + C\\xi^2$, the discriminant is $D = B^2 - 4AC$. In our case, $A = 1$, $B = 0$, and $C = -g(t)$. The discriminant is therefore:\n$$ D(t) = (0)^2 - 4(1)(-g(t)) = 4g(t). $$\nThe classification of the PDE at a given time $t$ depends directly on the sign of $g(t)$:\n\n1.  **Hyperbolic Case ($g(t) > 0$):** If $g(t) > 0$, the discriminant $D(t) > 0$. The characteristic equation $p(\\tau, \\xi; t) = 0$ has two distinct real roots for $\\tau/\\xi$, given by $\\tau/\\xi = \\pm\\sqrt{g(t)}$. These roots represent the characteristic speeds, $c(t) = \\pm\\sqrt{g(t)}$, at which information propagates. Because these speeds are real and finite, the domain of dependence for any point $(t_0, x_0)$ is a finite interval on the initial slice $t=0$. This guarantees that the Cauchy problem is well-posed: a unique solution exists and depends continuously on the initial data. This is the case for wave-like phenomena.\n\n2.  **Elliptic Case ($g(t)  0$):** If $g(t)  0$, the discriminant $D(t)  0$. The characteristic speeds become purely imaginary, $c(t) = \\pm\\sqrt{-|g(t)|} = \\pm i\\sqrt{|g(t)|}$. This signifies a lack of a real-valued \"speed of propagation\". An elliptic PDE does not support a well-posed initial-value problem. To see why, consider a Fourier mode solution of the form $u(t,x) \\propto e^{ikx}$ for some wavenumber $k$. Substituting this into the PDE gives an ordinary differential equation (ODE) for the time-dependent amplitude $\\hat{u}_k(t)$:\n    $$ \\frac{d^2\\hat{u}_k}{dt^2} = g(t)(-k^2)\\hat{u}_k = -g(t)k^2\\hat{u}_k. $$\n    When $g(t)  0$, the coefficient on the right-hand side, $-g(t)k^2$, is positive. The ODE is $\\ddot{\\hat{u}}_k = \\omega_k(t)^2 \\hat{u}_k$ with a real frequency $\\omega_k(t) = k\\sqrt{|g(t)|}$. The general solution includes terms proportional to $e^{\\int \\omega_k(t) dt}$. This exponential growth factor is larger for higher wavenumbers $k$. Consequently, any high-frequency components in the initial data (including numerical round-off error) will be amplified at an arbitrarily fast rate, leading to a catastrophic breakdown of the solution. The problem is ill-posed.\n\n3.  **Parabolic/Degenerate Case ($g(t) = 0$):** If $g(t) = 0$, the discriminant $D(t) = 0$. The PDE simplifies to $\\partial_t^2 u = 0$. The characteristic speed is zero. The solution is simply $u(t,x) = u(0,x) + t\\,\\partial_t u(0,x)$. The evolution at each spatial point $x$ is independent of its neighbors. While degenerate, the Cauchy problem for this equation is still well-posed.\n\n### Numerical Implementation\n\nTo investigate these behaviors numerically, we discretize the PDE and solve it for the given initial data and test cases.\n\n**Spatial Discretization:** The problem specifies a periodic domain $x \\in [0, 2\\pi]$, which is ideally suited for a Fourier spectral method. We represent the solution $u(t,x)$ on a grid of $N_x$ equispaced points $x_j = 2\\pi j/N_x$ for $j=0, \\dots, N_x-1$. The second spatial derivative $\\partial_x^2 u$ is computed efficiently and with high accuracy in Fourier space. Let $\\hat{u}_k(t)$ be the Discrete Fourier Transform (DFT) of the grid values $u(t, x_j)$. The transform of the second derivative is then $(-k^2)\\hat{u}_k(t)$, where $k$ are the integer wavenumbers. The operation is performed as follows:\n1. Compute the DFT of $u$: $\\hat{u} = \\text{FFT}(u)$.\n2. Multiply by $-k^2$: $\\widehat{\\partial_x^2 u} = -k^2 \\hat{u}$.\n3. Compute the inverse DFT: $\\partial_x^2 u = \\text{IFFT}(\\widehat{\\partial_x^2 u})$.\n\n**Temporal Discretization:** We use a second-order accurate explicit time-stepping scheme. The leapfrog method is a standard choice for second-order-in-time equations. Given $u^n \\approx u(n\\Delta t)$, the update rule is:\n$$ u^{n+1} = 2u^n - u^{n-1} + (\\Delta t)^2 \\, g(n\\Delta t) \\, (\\partial_x^2 u)^n, $$\nwhere $(\\partial_x^2 u)^n$ is the spatial derivative evaluated at time $n\\Delta t$. This is a two-step method, requiring solutions at two previous time levels, $u^n$ and $u^{n-1}$. a\nTo initialize the scheme, we need $u^0$ and $u^1$. $u^0 = u(0,x)$ is given. We compute $u^1$ using a second-order Taylor expansion around $t=0$:\n$$ u^1 \\approx u(0,x) + \\Delta t \\, \\partial_t u(0,x) + \\frac{(\\Delta t)^2}{2} \\partial_t^2 u(0,x). $$\nUsing the initial data $\\partial_t u(0,x) = 0$ and the PDE itself to find $\\partial_t^2 u(0,x) = g(0)\\,\\partial_x^2 u(0,x)$, the first step becomes:\n$$ u^1 = u^0 + \\frac{(\\Delta t)^2}{2} g(0) (\\partial_x^2 u)^0. $$\nWith $u^0$ and $u^1$ available, we set $u_{\\text{prev}} = u^0$ and $u_{\\text{curr}} = u^1$ to begin the main leapfrog loop.\n\n**Analysis of Ill-Posedness:** We monitor the squared $L^2$ energy of the solution, which for a periodic domain is defined as $E(t) = \\frac{1}{2\\pi}\\int_0^{2\\pi} u(t,x)^2 dx$. Numerically, this is approximated as the mean of the squared grid values: $E(t) \\approx \\frac{1}{N_x} \\sum_{j=0}^{N_x-1} u(t,x_j)^2$. The energy growth factor $R(t) = E(t)/E(0)$ tracks the solution's stability. Ill-posedness manifests as a rapid, unbounded growth in energy. We define the onset time $t_{\\text{onset}}$ as the first time $t$ for which $R(t)$ exceeds a threshold $R_{\\text{thr}} = 10$. If the threshold is not met by the final time $T_{\\text{end}} = 2$, we set $t_{\\text{onset}} = -1$.\n\n### Expected Behavior of Test Cases\n\n1.  **Case 1 ($g(t) = 1$):** This is the standard wave equation. The analytical solution is $u(t,x) = \\sin(x)\\cos(t)$. The energy is $E(t) = E(0)\\cos^2(t)$, which is bounded. We expect $R(t) \\le 1$, so $t_{\\text{onset}} = -1$.\n2.  **Case 2 ($g(t) = 1 - t$):** The equation is hyperbolic for $t  1$ and elliptic for $t > 1$. The solution should remain stable until $t=1$, after which numerical noise at high frequencies will begin to grow exponentially. We expect $t_{\\text{onset}}$ to be slightly greater than $1$.\n3.  **Case 3 ($g(t) = -1$):** The equation is elliptic for all $t \\ge 0$. High-frequency modes will grow exponentially from the start. The onset time will be determined by the growth of the fastest-growing mode, $k_{\\text{max}} = N_x/2 = 128$, and should be very short.\n4.  **Case 4 ($g(t) = 0$):** The equation is $\\partial_t^2 u = 0$. With zero initial velocity, the solution is static: $u(t,x) = u(0,x) = \\sin(x)$. The energy is constant, so $t_{\\text{onset}} = -1$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_onset_time(g_func, T_end, dt, Nx, R_thr):\n    \"\"\"\n    Solves the PDE u_tt = g(t) u_xx and finds the onset time of ill-posedness.\n\n    Args:\n        g_func (callable): The gauge function g(t).\n        T_end (float): The end time of the simulation.\n        dt (float): The time step.\n        Nx (int): The number of spatial grid points.\n        R_thr (float): The energy growth ratio threshold.\n\n    Returns:\n        float: The onset time, or -1.0 if no onset occurs.\n    \"\"\"\n    # 1. Setup spatial grid and wavenumbers\n    x = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    # Wavenumbers for numpy's FFT\n    k = np.fft.fftfreq(Nx, d=1.0 / Nx)\n\n    # 2. Set initial conditions\n    u_0 = np.sin(x)\n    v_0 = np.zeros(Nx)  # du/dt(0, x) = 0\n\n    # 3. Calculate initial energy\n    E0 = np.mean(u_0**2)\n    # If initial energy is zero, growth factor is ill-defined.\n    if E0  1e-16: # A small tolerance for floating point\n        return -1.0\n\n    # 4. Initialize the time-stepping scheme (Leapfrog)\n    # The leapfrog scheme u_next = 2*u_curr - u_prev + dt^2 * accel\n    # requires a startup step. We use a Taylor expansion to find u(dt).\n    # u(dt) ~= u(0) + dt*v(0) + 0.5*dt^2*a(0)\n    # where a(0) = g(0)*d^2u/dx^2(0).\n\n    # Calculate acceleration at t=0\n    g_val_0 = g_func(0.0)\n    u_hat_0 = np.fft.fft(u_0)\n    d2u_dx2_hat_0 = -(k**2) * u_hat_0\n    d2u_dx2_0 = np.fft.ifft(d2u_dx2_hat_0).real\n    accel_0 = g_val_0 * d2u_dx2_0\n\n    # Compute u at the first time step, t=dt\n    u_1 = u_0 + dt * v_0 + 0.5 * dt**2 * accel_0\n\n    # Setup for the main loop\n    u_prev = u_0  # Solution at time t-dt\n    u_curr = u_1  # Solution at time t\n    t = dt\n\n    num_steps = int(round(T_end / dt))\n\n    # 5. Main evolution loop\n    # We already computed the state at step 1 (t=dt), so we loop from step 2.\n    for i in range(1, num_steps):\n        # Calculate acceleration at the current time t\n        g_val = g_func(t)\n        u_hat = np.fft.fft(u_curr)\n        d2u_dx2_hat = -(k**2) * u_hat\n        d2u_dx2 = np.fft.ifft(d2u_dx2_hat).real\n        accel = g_val * d2u_dx2\n\n        # Perform the leapfrog step to find u at t+dt\n        u_next = 2 * u_curr - u_prev + dt**2 * accel\n\n        # Update state variables for the next iteration\n        u_prev = u_curr\n        u_curr = u_next\n        t += dt\n\n        # 6. Check for ill-posedness onset\n        # Calculate energy and growth factor\n        E = np.mean(u_curr**2)\n        R = E / E0\n\n        if R > R_thr:\n            return t\n\n    # If the loop completes without exceeding the threshold\n    return -1.0\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (globally hyperbolic)\n        {'name': 'Case 1', 'g_func': lambda t: 1.0},\n        # Case 2 (hyperbolic-to-elliptic transition)\n        {'name': 'Case 2', 'g_func': lambda t: 1.0 - t},\n        # Case 3 (globally elliptic)\n        {'name': 'Case 3', 'g_func': lambda t: -1.0},\n        # Case 4 (degenerate boundary)\n        {'name': 'Case 4', 'g_func': lambda t: 0.0}\n    ]\n\n    # Simulation parameters\n    Nx = 256\n    T_end = 2.0\n    dt = 1e-3\n    R_thr = 10.0\n\n    results = []\n    for case in test_cases:\n        t_onset = compute_onset_time(\n            g_func=case['g_func'],\n            T_end=T_end,\n            dt=dt,\n            Nx=Nx,\n            R_thr=R_thr\n        )\n        # Round the result to a reasonable number of decimal places\n        # to match the time step precision for a clean output.\n        if t_onset != -1.0:\n            results.append(round(t_onset, 4))\n        else:\n            results.append(t_onset)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3490105"}, {"introduction": "In practice, numerical solutions to Einstein's equations always contain small errors that manifest as violations of the Hamiltonian and momentum constraints. A robust, physically meaningful evolution system ensures these non-physical violations propagate causally and do not contaminate the solution. This numerical experiment [@problem_id:3490117] tasks you with evolving initial constraint violations and measuring their propagation speed, allowing you to directly verify that they remain confined within the light cone, a hallmark of a globally hyperbolic formulation.", "problem": "You are asked to formalize and test the causal propagation of small constraint violations in a simplified model of the Einstein Field Equations (EFE) within a globally hyperbolic spacetime. The task is to start from the Cauchy problem on an initial data slice that has small but nonzero Hamiltonian and momentum constraint violations and to numerically verify that, under a linearized hyperbolic propagation model, these violations remain confined within the analytic light cone.\n\nThe fundamental base consists of the following definitions and facts:\n- A spacetime is globally hyperbolic if it admits a Cauchy hypersurface such that the domain of dependence of any subset is well defined and causal curves do not exhibit closed timelike loops. For globally hyperbolic spacetimes, the Cauchy problem for hyperbolic systems is well-posed.\n- In suitable hyperbolic formulations of General Relativity (GR), such as the Z4 constrained formulation (Z4c) or the Generalized Harmonic formulation, the constraint propagation system linearized about Minkowski spacetime, with the speed of light normalized to $c=1$, reduces to wave-like equations for the Hamiltonian constraint violation $\\mathcal{H}$ and the momentum constraint violation $\\mathcal{M}$.\n- In these formulations, the principal part for the constraints can be modeled by the one-dimensional wave equations\n$$\n\\partial_t^2 \\mathcal{H} - c_{\\mathcal{H}}^2 \\, \\partial_x^2 \\mathcal{H} = 0, \\quad\n\\partial_t^2 \\mathcal{M} - c_{\\mathcal{M}}^2 \\, \\partial_x^2 \\mathcal{M} = 0,\n$$\nwith characteristic speeds $c_{\\mathcal{H}}, c_{\\mathcal{M}} \\in [0,1]$. Confinement within the analytic light cone requires that the measured propagation speed does not exceed $1$ in units where $c=1$.\n\nYour program must implement a numerical experiment to verify this confinement in the following way:\n- Use a one-dimensional spatial domain of length $L$ with periodic boundary conditions, discretized into $N_x$ uniform points with spacing $\\Delta x = L/N_x$. Time integration is carried out up to final time $T$, using a stable explicit scheme and a time step $\\Delta t$ satisfying the Courant–Friedrichs–Lewy (CFL) condition for the maximal characteristic speed present.\n- Initialize both constraint fields at $t=0$ with a small, smooth violation of Gaussian form centered at $x=0$ and zero initial time derivative:\n$$\n\\mathcal{H}(x,0) = \\varepsilon \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right), \\quad \\partial_t \\mathcal{H}(x,0) = 0,\n$$\n$$\n\\mathcal{M}(x,0) = \\varepsilon \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right), \\quad \\partial_t \\mathcal{M}(x,0) = 0,\n$$\nwhere $\\varepsilon > 0$ is small and $\\sigma>0$ sets the width.\n- Evolve both $\\mathcal{H}$ and $\\mathcal{M}$ under their respective wave equations with speeds $c_{\\mathcal{H}}$ and $c_{\\mathcal{M}}$.\n\nTo quantify confinement, define the instantaneous support radius at time $t$ of a field $u(x,t)$ relative to the center $x_0=0$ as the maximal distance from $x_0$ at which the field amplitude exceeds a specified threshold:\n$$\nR[u](t) := \\max\\{ |x - x_0| \\, : \\, |u(x,t)| \\ge \\theta \\},\n$$\nwith absolute threshold $\\theta = f \\, \\varepsilon$ for a fixed fraction $f \\in (0,1)$ that is the same across all test cases. Estimate the propagation speed over the interval $[t_1,t_2]$ as\n$$\nv[u] \\approx \\frac{R[u](t_2) - R[u](t_1)}{t_2 - t_1},\n$$\nwith $t_1 = T/2$ and $t_2 = T$. Confinement within the analytic light cone is verified if $v[\\mathcal{H}] \\le 1$ and $v[\\mathcal{M}] \\le 1$ (within a small numerical tolerance).\n\nYour program must:\n- Discretize the wave equations with a consistent, explicit, second-order accurate scheme in space and time that is stable under a standard CFL restriction. Ensure that the chosen times $t_1$ and $t_2$ satisfy $0  t_1  t_2 \\le T$ and that the waves do not reach the periodic boundaries during $[0,T]$ to avoid wrap-around influencing the estimate.\n- Use a uniform threshold fraction $f$ for all test cases and a uniform numerical tolerance $\\tau$ for the inequality checks.\n\nImplement the above and evaluate the following test suite. Each tuple is $(c_{\\mathcal{H}}, c_{\\mathcal{M}}, L, N_x, \\sigma, \\varepsilon, T)$:\n1. $(1.0, 0.8, 100.0, 1200, 1.5, 10^{-3}, 20.0)$\n2. $(0.9, 0.9, 60.0, 900, 1.0, 5\\times 10^{-4}, 20.0)$\n3. $(0.0, 0.8, 80.0, 800, 2.0, 10^{-3}, 25.0)$\n\nUse units where the speed of light is $1$, so all speeds are dimensionless. Angles are not involved. Your program must produce, as its only output, a single line containing a comma-separated Python list of booleans with one boolean result per test case, where each boolean is true if both $v[\\mathcal{H}] \\le 1$ and $v[\\mathcal{M}] \\le 1$ (each within the numerical tolerance) and false otherwise. For example, the format must be exactly like:\n[True,False,True]", "solution": "The problem requires a numerical experiment to verify that constraint violations in a simplified model of General Relativity propagate causally, i.e., not faster than the speed of light, $c=1$. The model is based on the one-dimensional linear wave equation, which describes the evolution of the Hamiltonian constraint violation, $\\mathcal{H}$, and the momentum constraint violation, $\\mathcal{M}$. The governing equation for a generic field $u(x,t)$, representing either $\\mathcal{H}$ or $\\mathcal{M}$, is:\n$$\n\\partial_t^2 u - c_p^2 \\, \\partial_x^2 u = 0\n$$\nwhere $c_p$ is the characteristic propagation speed associated with the field ($c_{\\mathcal{H}}$ or $c_{\\mathcal{M}}$). The spacetime is assumed to be globally hyperbolic, ensuring the Cauchy problem is well-posed.\n\nTo solve this equation numerically, we employ a second-order accurate finite-difference scheme on a discrete grid. The spatial domain of length $L$ is discretized into $N_x$ grid points $x_j = -L/2 + j\\Delta x$ for $j=0, \\dots, N_x-1$, with uniform grid spacing $\\Delta x = L/N_x$. The time domain is discretized into steps of size $\\Delta t$. The value of the field at grid point $(x_j, t_n)$ is denoted by $u_j^n$. The second-order partial derivatives are approximated using centered finite differences:\n$$\n\\partial_t^2 u(x_j, t_n) \\approx \\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{\\Delta t^2}\n$$\n$$\n\\partial_x^2 u(x_j, t_n) \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\n$$\nSubstituting these approximations into the wave equation gives the explicit \"leapfrog\" integration scheme:\n$$\nu_j^{n+1} = 2u_j^n - u_j^{n-1} + \\lambda^2 (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nwhere $\\lambda = c_p \\Delta t / \\Delta x$ is the Courant number. This scheme is second-order accurate in both space and time.\n\nThe numerical stability of this explicit scheme is governed by the Courant–Friedrichs–Lewy (CFL) condition, which requires $\\lambda \\le 1$. To ensure stability for both fields and maintain a consistent time grid for the analysis, the time step $\\Delta t$ is determined by the maximum characteristic speed, $c_{max} = \\max(c_{\\mathcal{H}}, c_{\\mathcal{M}})$, for each test case:\n$$\n\\Delta t = \\alpha_{\\text{CFL}} \\frac{\\Delta x}{c_{max}}\n$$\nwhere $\\alpha_{\\text{CFL}}$ is a safety factor less than $1$. We choose $\\alpha_{\\text{CFL}} = 0.95$. If $c_{max}=0$, any non-zero value can be used in the denominator as the propagation speed $c_p$ will be zero, making the Courant number zero regardless of $\\Delta t$.\n\nThe initial conditions are given by $u(x,0) = \\varepsilon \\exp(-x^2/(2\\sigma^2))$ and $\\partial_t u(x,0) = 0$. Since the leapfrog scheme is a three-level method, it requires data at time levels $n$ and $n-1$ to compute level $n+1$. To initialize the scheme, we use the initial velocity condition to find the solution at the first time step, $t_1 = \\Delta t$. Approximating the initial velocity condition with a centered difference, $\\frac{u_j^1 - u_j^{-1}}{2\\Delta t} = 0$, implies $u_j^{-1} = u_j^1$. Substituting this into the leapfrog update for $n=0$ gives a special formula for the first time step:\n$$\nu_j^1 = u_j^0 + \\frac{1}{2}\\lambda^2 (u_{j+1}^0 - 2u_j^0 + u_{j-1}^0)\n$$\nSubsequent time steps proceed using the standard three-level formula. The domain has periodic boundary conditions, meaning the grid \"wraps around\". This is handled by accessing neighboring grid points using modulo arithmetic, such that the right neighbor of the last point ($j=N_x-1$) is the first point ($j=0$), and vice-versa.\n\nTo verify causal propagation, the speed of the wave's leading edge is measured. The support radius $R[u](t)$ is defined as the maximum distance from the center $x_0=0$ at which the field amplitude exceeds a certain threshold $\\theta$:\n$$\nR[u](t) := \\max\\{ |x_j| \\, : \\, |u(x_j,t)| \\ge \\theta \\}\n$$\nThe threshold is chosen as a small fraction $f$ of the initial peak amplitude, $\\theta = f \\varepsilon$. We set $f=0.01$. The average propagation speed over the time interval $[t_1, t_2]$, with $t_1=T/2$ and $t_2=T$, is then estimated by:\n$$\nv[u] \\approx \\frac{R[u](t_2) - R[u](t_1)}{t_2 - t_1}\n$$\nThe confinement condition is met if the measured speeds for both fields are less than or equal to the speed of light, $c=1$. To account for numerical errors inherent in the discretization (such as numerical dispersion), we check the condition $v[u] \\le 1 + \\tau$, where $\\tau$ is a small numerical tolerance. A value of $\\tau=0.05$ is used. For each test case, the final result is `True` if and only if this condition holds for both $v[\\mathcal{H}]$ and $v[\\mathcal{M}]$. For the special case where a propagation speed $c_p$ is exactly $0$, the equation reduces to $\\partial_t^2 u = 0$. With zero initial velocity, the solution is static, $u(x,t) = u(x,0)$, resulting in a measured propagation speed of $v[u] = 0.0$, which trivially satisfies the causality condition.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for all test cases.\n    \"\"\"\n    \n    # Uniform parameters for all test cases as per the problem description.\n    # f: fraction of initial amplitude for thresholding.\n    F_THRESHOLD_FRACTION = 0.01\n    # tau: numerical tolerance for speed verification.\n    NUMERICAL_TOLERANCE = 0.05\n    # CFL safety factor.\n    CFL_FACTOR = 0.95\n\n    test_cases = [\n        # (c_H, c_M, L, Nx, sigma, epsilon, T)\n        (1.0, 0.8, 100.0, 1200, 1.5, 1e-3, 20.0),\n        (0.9, 0.9, 60.0, 900, 1.0, 5e-4, 20.0),\n        (0.0, 0.8, 80.0, 800, 2.0, 1e-3, 25.0)\n    ]\n\n    def solve_single_wave(c_prop, L, Nx, sigma, epsilon, T, c_max_for_dt):\n        \"\"\"\n        Solves the 1D wave equation for a single field using a leapfrog scheme.\n        \n        Args:\n            c_prop (float): Propagation speed for this specific wave.\n            L (float): Length of the spatial domain.\n            Nx (int): Number of spatial grid points.\n            sigma (float): Width of the initial Gaussian pulse.\n            epsilon (float): Amplitude of the initial Gaussian pulse.\n            T (float): Final evolution time.\n            c_max_for_dt (float): Maximum speed in the test case, to set a common dt.\n\n        Returns:\n            A tuple (u_t1, u_t2) containing the field states at times T/2 and T.\n        \"\"\"\n        x_grid = np.linspace(-L / 2, L / 2, Nx, endpoint=False)\n        dx = L / Nx\n\n        # If propagation speed is zero, the solution is static.\n        if c_prop == 0.0:\n            u_static = epsilon * np.exp(-x_grid**2 / (2 * sigma**2))\n            return u_static, u_static\n\n        # Set time step based on the max speed of the pair (H, M).\n        # Handle edge case where c_max is 0 to avoid division by zero.\n        dt = CFL_FACTOR * dx / c_max_for_dt if c_max_for_dt > 0 else 1.0\n        \n        num_steps = int(np.ceil(T / dt))\n        t1_step = int(np.ceil((T / 2) / dt))\n        t2_step = num_steps\n\n        # Initial conditions: u at t=0 and t=-dt (from du/dt=0)\n        u_prev = epsilon * np.exp(-x_grid**2 / (2 * sigma**2))\n\n        # First time step using du/dt(0) = 0 condition\n        courant_sq = (c_prop * dt / dx)**2\n        laplacian_u_prev = np.roll(u_prev, -1) - 2 * u_prev + np.roll(u_prev, 1)\n        u_curr = u_prev + 0.5 * courant_sq * laplacian_u_prev\n\n        u_at_t1 = None\n\n        # Time evolution loop (Leapfrog)\n        for n in range(1, num_steps + 1):\n            if n == t1_step:\n                u_at_t1 = u_curr.copy()\n\n            laplacian_u_curr = np.roll(u_curr, -1) - 2 * u_curr + np.roll(u_curr, 1)\n            u_next = 2 * u_curr - u_prev + courant_sq * laplacian_u_curr\n            u_prev, u_curr = u_curr, u_next\n        \n        u_at_t2 = u_curr\n        \n        # In case T/2 is less than one time step\n        if u_at_t1 is None:\n            u_at_t1 = u_prev if t1_step == 0 else u_curr\n\n        return u_at_t1, u_at_t2\n\n    def calculate_radius(u_field, x_grid, threshold):\n        \"\"\"Calculates the support radius of the field.\"\"\"\n        above_threshold_indices = np.where(np.abs(u_field) >= threshold)[0]\n        if len(above_threshold_indices) == 0:\n            return 0.0\n        return np.max(np.abs(x_grid[above_threshold_indices]))\n\n    results = []\n    for case in test_cases:\n        cH, cM, L, Nx, sigma, epsilon, T = case\n        \n        c_max = max(cH, cM)\n        x = np.linspace(-L / 2, L / 2, Nx, endpoint=False)\n        t1, t2 = T / 2, T\n        threshold = F_THRESHOLD_FRACTION * epsilon\n\n        # --- Solve for Hamiltonian constraint H ---\n        uH_t1, uH_t2 = solve_single_wave(cH, L, Nx, sigma, epsilon, T, c_max)\n        \n        # --- Solve for Momentum constraint M ---\n        uM_t1, uM_t2 = solve_single_wave(cM, L, Nx, sigma, epsilon, T, c_max)\n\n        # --- Analyze results ---\n        # Calculate radii for H\n        RH_t1 = calculate_radius(uH_t1, x, threshold)\n        RH_t2 = calculate_radius(uH_t2, x, threshold)\n        vH = (RH_t2 - RH_t1) / (t2 - t1) if (t2 - t1) > 0 else 0.0\n        \n        # Calculate radii for M\n        RM_t1 = calculate_radius(uM_t1, x, threshold)\n        RM_t2 = calculate_radius(uM_t2, x, threshold)\n        vM = (RM_t2 - RM_t1) / (t2 - t1) if (t2 - t1) > 0 else 0.0\n        \n        # Verify confinement condition with numerical tolerance\n        is_confined = (vH = 1.0 + NUMERICAL_TOLERANCE) and \\\n                      (vM = 1.0 + NUMERICAL_TOLERANCE)\n        \n        results.append(is_confined)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3490117"}]}