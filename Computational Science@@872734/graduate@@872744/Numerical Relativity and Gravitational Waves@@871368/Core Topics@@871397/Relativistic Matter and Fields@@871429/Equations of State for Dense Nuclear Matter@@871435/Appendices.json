{"hands_on_practices": [{"introduction": "The foundation of any hydrodynamic simulation of a neutron star is the equation of state (EOS), which links the pressure and energy density of the stellar matter. This exercise demonstrates how a complete, thermodynamically consistent barotropic EOS can be constructed from first principles using a simplified but powerful physical assumption: a constant speed of sound. By integrating the fundamental laws of thermodynamics, you will gain a hands-on understanding of how phenomenological EOS models are built from the ground up. [@problem_id:3473683]", "problem": "In numerical relativity for modeling gravitational waves from binary neutron star mergers, one often requires a cold, barotropic Equation of State (EOS) for dense nuclear matter. Consider cold matter at zero temperature, modeled as a single-component baryonic fluid characterized by the baryon number density $n_{B}$, pressure $P$, energy density $\\varepsilon$, and baryon chemical potential $\\mu$. The relativistic speed of sound squared is defined as $c_{s}^{2} = \\left(\\partial P / \\partial \\varepsilon\\right)$ at fixed composition. For cold matter, the fundamental thermodynamic identities imply $d\\varepsilon = \\mu \\, dn_{B}$ and $P = n_{B} \\mu - \\varepsilon$. Assume microphysical causality and stability with $0 < c_{s}^{2}(n_{B}) < 1$.\n\nYou are given a low-density boundary condition at $n_{0}$ with known $P(n_{0}) = P_{0}$ and $\\varepsilon(n_{0}) = \\varepsilon_{0}$. The baryon chemical potential at the boundary satisfies $\\mu(n_{0}) = (\\varepsilon_{0} + P_{0}) / n_{0}$.\n\nChoose the sound-speed profile to be constant, $c_{s}^{2}(n_{B}) = \\alpha$, with $0 < \\alpha < 1$. Starting from the fundamental laws and definitions stated above, construct the EOS by integrating from the boundary at $n_{0}$ to obtain $P(n_{B})$ and $\\varepsilon(n_{B})$ consistent with thermodynamics. Express your final result as a single closed-form analytic expression for the pressure $P(n_{B})$ in terms of $n_{B}$, $n_{0}$, $\\alpha$, $P_{0}$, and $\\varepsilon_{0}$.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n-   **Model**: Cold, barotropic, single-component baryonic fluid at zero temperature ($T=0$).\n-   **Variables**: Baryon number density $n_{B}$, pressure $P$, energy density $\\varepsilon$, baryon chemical potential $\\mu$.\n-   **Definitions and Identities**:\n    -   Speed of sound squared: $c_{s}^{2} = \\left(\\frac{\\partial P}{\\partial \\varepsilon}\\right)$ at fixed composition.\n    -   First Law of Thermodynamics at $T=0$: $d\\varepsilon = \\mu \\, dn_{B}$.\n    -   Euler Relation at $T=0$: $P = n_{B} \\mu - \\varepsilon$.\n-   **Assumptions and Constraints**:\n    -   The speed of sound squared is constant: $c_{s}^{2}(n_{B}) = \\alpha$, where $\\alpha$ is a constant.\n    -   Causality and stability constraint: $0 < \\alpha < 1$.\n-   **Boundary Conditions**:\n    -   At a reference density $n_{0}$, the pressure is $P(n_{0}) = P_{0}$ and the energy density is $\\varepsilon(n_{0}) = \\varepsilon_{0}$.\n    -   The chemical potential at the boundary is given by $\\mu(n_{0}) = (\\varepsilon_{0} + P_{0}) / n_{0}$. This is consistent with the Euler relation evaluated at $n_{0}$.\n-   **Objective**: Derive a closed-form analytic expression for the pressure $P(n_{B})$ in terms of $n_{B}$, $n_{0}$, $\\alpha$, $P_{0}$, and $\\varepsilon_{0}$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is well-grounded in the principles of thermodynamics and fluid dynamics as applied to nuclear astrophysics. The thermodynamic identities are standard for a relativistic fluid at zero temperature. The use of a constant speed of sound, while a simplification, is a common and valid parameterization for phenomenological equations of state (EOS).\n-   **Well-Posed**: The problem provides a system of differential relations with well-defined boundary conditions. This setup allows for the unique determination of the functions $P(n_{B})$ and $\\varepsilon(n_{B})$ through integration.\n-   **Objective**: The problem is stated in precise, formal, and unbiased mathematical language.\n\n**Step 3: Verdict and Action**\nThe problem is found to be scientifically sound, well-posed, and objective. It contains no contradictions, ambiguities, or invalid premises. Therefore, the problem is **valid** and a solution will be constructed.\n\n**Derivation of the Equation of State**\n\nThe solution will be derived by first establishing a differential equation for the baryon chemical potential $\\mu$ as a function of the baryon number density $n_{B}$.\n\nThe fundamental thermodynamic relations given are:\n1.  $d\\varepsilon = \\mu \\, dn_{B}$\n2.  $P = n_{B}\\mu - \\varepsilon$\n3.  The specific assumption is $\\frac{dP}{d\\varepsilon} = \\alpha$, where $\\alpha$ is a constant.\n\nFrom relation (1), we can write the partial derivatives with respect to $n_{B}$ as:\n$$\n\\frac{d\\varepsilon}{dn_{B}} = \\mu\n$$\nUsing the chain rule, the derivative of pressure with respect to baryon number density is:\n$$\n\\frac{dP}{dn_{B}} = \\frac{dP}{d\\varepsilon} \\frac{d\\varepsilon}{dn_{B}}\n$$\nSubstituting the given relations, we find:\n$$\n\\frac{dP}{dn_{B}} = \\alpha \\mu\n$$\nNow, differentiate the Euler relation (2), $P = n_{B}\\mu - \\varepsilon$, with respect to $n_{B}$:\n$$\n\\frac{dP}{dn_{B}} = \\frac{d}{dn_{B}}(n_{B}\\mu) - \\frac{d\\varepsilon}{dn_{B}}\n$$\nUsing the product rule for the first term on the right-hand side:\n$$\n\\frac{dP}{dn_{B}} = \\mu + n_{B}\\frac{d\\mu}{dn_{B}} - \\frac{d\\varepsilon}{dn_{B}}\n$$\nWe can now substitute our previously established expressions for $\\frac{dP}{dn_{B}}$ and $\\frac{d\\varepsilon}{dn_{B}}$ into this equation:\n$$\n\\alpha \\mu = \\mu + n_{B}\\frac{d\\mu}{dn_{B}} - \\mu\n$$\nThis simplifies to:\n$$\n\\alpha \\mu = n_{B}\\frac{d\\mu}{dn_{B}}\n$$\nThis is a first-order separable ordinary differential equation for $\\mu(n_{B})$. We can rearrange it as:\n$$\n\\frac{d\\mu}{\\mu} = \\alpha \\frac{dn_{B}}{n_{B}}\n$$\nIntegrating both sides yields:\n$$\n\\int \\frac{d\\mu}{\\mu} = \\int \\alpha \\frac{dn_{B}}{n_{B}}\n$$\n$$\n\\ln(\\mu) = \\alpha \\ln(n_{B}) + C_{1}\n$$\nwhere $C_{1}$ is the constant of integration. We can write $C_{1} = \\ln(K)$ for a new constant $K$.\n$$\n\\ln(\\mu) = \\ln(n_{B}^{\\alpha}) + \\ln(K) = \\ln(K n_{B}^{\\alpha})\n$$\nExponentiating both sides gives the general solution for the chemical potential:\n$$\n\\mu(n_{B}) = K n_{B}^{\\alpha}\n$$\nTo determine the constant $K$, we apply the boundary condition at $n_{B}=n_{0}$. The problem states $\\mu(n_{0}) = (\\varepsilon_{0} + P_{0})/n_{0}$.\n$$\n\\mu(n_{0}) = K n_{0}^{\\alpha} \\implies K = \\frac{\\mu(n_{0})}{n_{0}^{\\alpha}} = \\frac{\\varepsilon_{0} + P_{0}}{n_{0} \\cdot n_{0}^{\\alpha}} = \\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\n$$\nSubstituting $K$ back into the expression for $\\mu(n_{B})$ gives:\n$$\n\\mu(n_{B}) = \\left(\\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\\right) n_{B}^{\\alpha}\n$$\nNow we can find the pressure $P(n_{B})$ by integrating the relation $\\frac{dP}{dn_{B}} = \\alpha \\mu(n_{B})$.\n$$\ndP = \\alpha \\mu(n_{B}) \\, dn_{B}\n$$\nWe integrate from the boundary $n_{0}$ to an arbitrary density $n_{B}$:\n$$\n\\int_{P_{0}}^{P(n_{B})} dP' = \\int_{n_{0}}^{n_{B}} \\alpha \\mu(n_{B}') \\, dn_{B}'\n$$\n$$\nP(n_{B}) - P_{0} = \\int_{n_{0}}^{n_{B}} \\alpha \\left(\\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\\right) (n_{B}')^{\\alpha} \\, dn_{B}'\n$$\nThe constant terms can be moved outside the integral:\n$$\nP(n_{B}) - P_{0} = \\alpha \\left(\\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\\right) \\int_{n_{0}}^{n_{B}} (n_{B}')^{\\alpha} \\, dn_{B}'\n$$\nPerforming the integration:\n$$\nP(n_{B}) - P_{0} = \\alpha \\left(\\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\\right) \\left[ \\frac{(n_{B}')^{\\alpha+1}}{\\alpha+1} \\right]_{n_{0}}^{n_{B}}\n$$\n$$\nP(n_{B}) - P_{0} = \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{(1+\\alpha)n_{0}^{1+\\alpha}} \\left( n_{B}^{1+\\alpha} - n_{0}^{1+\\alpha} \\right)\n$$\nRearranging the terms to isolate $P(n_{B})$ and factoring out $n_{0}^{1+\\alpha}$:\n$$\nP(n_{B}) = P_{0} + \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{1+\\alpha} \\left( \\frac{n_{B}^{1+\\alpha}}{n_{0}^{1+\\alpha}} - \\frac{n_{0}^{1+\\alpha}}{n_{0}^{1+\\alpha}} \\right)\n$$\nThis gives the final closed-form expression for the pressure as a function of baryon number density:\n$$\nP(n_{B}) = P_{0} + \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{1+\\alpha} \\left[ \\left(\\frac{n_{B}}{n_{0}}\\right)^{1+\\alpha} - 1 \\right]\n$$\nThis expression depends only on the variables specified in the problem statement, thus satisfying the objective.", "answer": "$$\n\\boxed{P_{0} + \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{1+\\alpha} \\left( \\left(\\frac{n_{B}}{n_{0}}\\right)^{1+\\alpha} - 1 \\right)}\n$$", "id": "3473683"}, {"introduction": "While phenomenological models are useful, a deeper understanding requires delving into the microphysics that determines the composition of dense matter. This computational practice guides you through modeling cold, catalyzed matter as a mixture of neutrons, protons, electrons, and muons in beta-equilibrium. You will implement the conditions of chemical equilibrium and charge neutrality to solve for the proton fraction $Y_p$, revealing how the microscopic state of matter is dictated by a balance between nuclear forces and lepton pressures. [@problem_id:3473660]", "problem": "Consider cold, catalyzed neutron-star matter described by a minimal microphysics model that couples baryons to leptons in beta-equilibrium. The baryon number density is denoted by $n_B$ and the proton fraction by $Y_p = n_p/n_B$, where $n_p$ is the proton number density and $n_n$ the neutron number density. Assume the following foundational laws and definitions hold:\n\n- Beta equilibrium without trapped neutrinos imposes $ \\mu_n = \\mu_p + \\mu_e $ and, when muons are present, $ \\mu_e = \\mu_\\mu $.\n- Charge neutrality requires $ n_p = n_e + n_\\mu $.\n- Baryon conservation implies $ n_B = n_n + n_p $.\n- For nucleons, adopt the widely used parabolic approximation for the nuclear symmetry energy in the difference of neutron and proton chemical potentials,\n$$\n\\mu_n - \\mu_p \\approx 4\\, S(n_B)\\, \\left(1 - 2 Y_p \\right),\n$$\nwith a power-law symmetry energy density dependence\n$$\nS(n_B) = S_0 \\left( \\frac{n_B}{n_0} \\right)^\\gamma,\n$$\nwhere $S_0 = 32\\,\\mathrm{MeV}$, $n_0 = 0.16\\,\\mathrm{fm}^{-3}$, and $\\gamma = 0.6$.\n- Electrons and muons are modeled as zero-temperature relativistic Fermi gases. Their chemical potentials as functions of number density $n_\\ell$ are\n$$\n\\mu_\\ell(n_\\ell) = \\sqrt{ \\left(m_\\ell c^2\\right)^2 + \\left(\\hbar c\\, (3\\pi^2 n_\\ell)^{1/3}\\right)^2 },\n$$\nfor $\\ell \\in \\{e,\\mu\\}$, with $m_e c^2 = 0.51099895\\,\\mathrm{MeV}$ and $m_\\mu c^2 = 105.6583755\\,\\mathrm{MeV}$. Use $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$. Invert this relation when needed via\n$$\nn_\\ell(\\mu) =\n\\begin{cases}\n0, & \\mu < m_\\ell c^2,\\\\[6pt]\n\\dfrac{1}{3\\pi^2}\\left(\\dfrac{\\sqrt{\\mu^2 - (m_\\ell c^2)^2}}{\\hbar c}\\right)^3, & \\mu \\ge m_\\ell c^2.\n\\end{cases}\n$$\n\nThe composition is determined by simultaneously enforcing beta equilibrium and charge neutrality, together with the definition $n_p = Y_p n_B$. Muons appear when the electron chemical potential reaches the muon rest energy threshold, that is when $\\mu_e \\ge m_\\mu c^2$. Below threshold, $n_\\mu = 0$ and $n_e = n_p$; above threshold, $\\mu_e = \\mu_\\mu \\equiv \\mu_\\ell$ and $n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = n_p$.\n\nYour task is to construct a program that, for each specified $n_B$, solves for the unique proton fraction $Y_p(n_B)$ that satisfies\n$$\n4\\, S(n_B)\\, \\left(1 - 2 Y_p \\right) = \n\\begin{cases}\n\\mu_e\\big(n_e = n_p\\big), & \\text{if } \\mu_e\\big(n_e = n_p\\big) < m_\\mu c^2,\\\\[6pt]\n\\mu_\\ell \\text{ such that } n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = n_p, & \\text{if } \\mu_e\\big(n_e = n_p\\big) \\ge m_\\mu c^2,\n\\end{cases}\n$$\nwith $n_p = Y_p n_B$, and where all quantities are expressed in the units indicated above. The existence and uniqueness of the solution should be justified by monotonicity arguments in your algorithmic design, and the numerical method should be robust across the threshold regime.\n\nNumerical and physical units to use throughout:\n- Number densities $n_B$, $n_p$, $n_e$, $n_\\mu$ must be in $\\mathrm{fm}^{-3}$.\n- Energies $\\mu_e$, $\\mu_\\mu$, $S(n_B)$, $m_\\ell c^2$, and $\\hbar c$ must be in $\\mathrm{MeV}$.\n- The proton fraction $Y_p$ is dimensionless and must be output as decimal numbers.\n\nTest suite:\nCompute $Y_p(n_B)$ for the following five baryon densities (in $\\mathrm{fm}^{-3}$):\n- $n_B = 1.0\\times 10^{-4}$,\n- $n_B = 2.0\\times 10^{-2}$,\n- $n_B = 1.6\\times 10^{-1}$,\n- $n_B = 4.8\\times 10^{-1}$,\n- $n_B = 1.0$.\n\nThese cases are designed to probe low-density electron-only matter, the approach to the muon threshold, near-saturation density, and well-above-threshold behavior.\n\nFinal output format:\nYour program should produce a single line of output containing the five results as a comma-separated list enclosed in square brackets, with each $Y_p$ rounded to six decimal places, for example $[0.001234,0.012345,0.034567,0.056789,0.078901]$.", "solution": "### Step 1: Extract Givens\nThe problem provides the following data, definitions, and relationships for modeling cold, catalyzed neutron-star matter:\n\n**Fundamental Principles and Definitions:**\n- Beta equilibrium (no trapped neutrinos): $ \\mu_n = \\mu_p + \\mu_e $\n- Muon equilibrium (when present): $ \\mu_e = \\mu_\\mu $\n- Charge neutrality: $ n_p = n_e + n_\\mu $\n- Baryon number conservation: $ n_B = n_n + n_p $\n- Proton fraction definition: $ Y_p = n_p/n_B $\n\n**Component Models (Equations of State):**\n- Nucleon chemical potential difference (parabolic approximation):\n$$\n\\mu_n - \\mu_p \\approx 4\\, S(n_B)\\, \\left(1 - 2 Y_p \\right)\n$$\n- Symmetry energy density dependence:\n$$\nS(n_B) = S_0 \\left( \\frac{n_B}{n_0} \\right)^\\gamma\n$$\n- Lepton chemical potential (relativistic Fermi gas):\n$$\n\\mu_\\ell(n_\\ell) = \\sqrt{ \\left(m_\\ell c^2\\right)^2 + \\left(\\hbar c\\, (3\\pi^2 n_\\ell)^{1/3}\\right)^2 }, \\quad \\ell \\in \\{e,\\mu\\}\n$$\n- Inverse relation for lepton number density:\n$$\nn_\\ell(\\mu) =\n\\begin{cases}\n0, & \\mu < m_\\ell c^2,\\\n\\dfrac{1}{3\\pi^2}\\left(\\dfrac{\\sqrt{\\mu^2 - (m_\\ell c^2)^2}}{\\hbar c}\\right)^3, & \\mu \\ge m_\\ell c^2.\n\\end{cases}\n$$\n\n**Physical and Numerical Constants:**\n- Symmetry energy at saturation: $S_0 = 32\\,\\mathrm{MeV}$\n- Nuclear saturation density: $n_0 = 0.16\\,\\mathrm{fm}^{-3}$\n- Symmetry energy power-law index: $\\gamma = 0.6$\n- Electron rest energy: $m_e c^2 = 0.51099895\\,\\mathrm{MeV}$\n- Muon rest energy: $m_\\mu c^2 = 105.6583755\\,\\mathrm{MeV}$\n- Planck-Dirac constant times speed of light: $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$\n\n**Task:**\nFor a given baryon number density $n_B$, solve for the proton fraction $Y_p$ that satisfies the equilibrium condition:\n$$\n4\\, S(n_B)\\, \\left(1 - 2 Y_p \\right) = \n\\begin{cases}\n\\mu_e\\big(n_e = n_p\\big), & \\text{if } \\mu_e\\big(n_e = n_p\\big) < m_\\mu c^2,\\\\[6pt]\n\\mu_\\ell \\text{ such that } n_e(\\mu_\\ell) + n_mu(\\mu_\\ell) = n_p, & \\text{if } \\mu_e\\big(n_e = n_p\\big) \\ge m_\\mu c^2,\n\\end{cases}\n$$\nwhere $n_p = Y_p n_B$.\n\n**Test Suite:**\n- $n_B = 1.0\\times 10^{-4}\\,\\mathrm{fm}^{-3}$\n- $n_B = 2.0\\times 10^{-2}\\,\\mathrm{fm}^{-3}$\n- $n_B = 1.6\\times 10^{-1}\\,\\mathrm{fm}^{-3}$\n- $n_B = 4.8\\times 10^{-1}\\,\\mathrm{fm}^{-3}$\n- $n_B = 1.0\\,\\mathrm{fm}^{-3}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a rigorous validation procedure.\n\n- **Scientifically Grounded (Critical):** The problem describes one of the simplest, yet standard, models for cold, dense nuclear matter in beta-equilibrium (often called npeμ matter). The equations for beta-equilibrium, charge neutrality, the parabolic approximation for symmetry energy, and the relativistic Fermi gas model for leptons are all cornerstones of nuclear astrophysics and the theory of neutron stars. The values for the physical constants ($m_e c^2$, $m_\\mu c^2$, $\\hbar c$) and the nuclear physics parameters ($S_0$, $n_0$, $\\gamma$) are standard and widely used in the literature. The model is scientifically sound and factually correct within its domain of applicability.\n- **Well-Posed:** The problem asks to find the root of a transcendental equation for the variable $Y_p$ given a parameter $n_B$. To assess if it is well-posed, we analyze the monotonicity of the functions involved. Let the equation be $L(Y_p) = R(Y_p)$.\n    - The left-hand side, $L(Y_p) = 4 S(n_B)(1 - 2Y_p)$, is a linear and strictly decreasing function of $Y_p$ for any fixed $n_B > 0$.\n    - The right-hand side, $R(Y_p)$, represents the equilibrium lepton chemical potential.\n        - In the muon-free case, $R(Y_p) = \\mu_e(n_p) = \\mu_e(Y_p n_B)$. Since $\\mu_e(n_e)$ is a strictly increasing function of $n_e$, and $n_p$ is a linear, increasing function of $Y_p$, $R(Y_p)$ is strictly increasing.\n        - In the muon-present case, $R(Y_p)$ is the value $\\mu_\\ell$ that solves $n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = Y_p n_B$. The function $N(\\mu_\\ell) = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell)$ is a strictly increasing function of $\\mu_\\ell$. Its inverse, $\\mu_\\ell = N^{-1}(Y_p n_B)$, is therefore a strictly increasing function of its argument, $Y_p n_B$. Thus, $R(Y_p)$ is strictly increasing in this case as well.\n    - We are therefore seeking the intersection of a strictly decreasing function and a strictly increasing function. Such an intersection, if it exists, is unique. Existence is guaranteed within the physical domain $Y_p \\in [0, 1]$ by the Intermediate Value Theorem, as $L(0) > R(0)$ (for the relevant densities) and $L(0.5) = 0$ while $R(0.5) > 0$, implying $L(0.5) < R(0.5)$. Thus, a unique solution exists in $Y_p \\in (0, 0.5)$. The problem is well-posed.\n- **Objective (Critical):** The problem is stated in precise, quantitative, and objective scientific language. All terms are formally defined. There are no subjective or opinion-based components.\n- **No other flaws:** The problem is self-contained, with all necessary equations and constants provided. It is not metaphorical, trivial, or contradictory. The units are consistent and specified.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-posed, scientifically grounded problem in computational nuclear astrophysics. A complete solution will be provided.\n\n### Solution Methodology\n\nThe core of the problem is to find the proton fraction $Y_p$ that establishes beta-equilibrium for a given baryon number density $n_B$. This is achieved by solving a transcendental equation that equates the chemical potential difference between neutrons and protons, driven by nuclear forces, with the chemical potential of the leptons, determined by electromagnetic and quantum statistics.\n\n**1. Governing Equation and Reformulation for Root-Finding**\nCombining the conditions for beta-equilibrium ($\\mu_n - \\mu_p = \\mu_e$) and the provided models, we obtain the central equation to be solved for $Y_p$:\n$$\n4 S(n_B)(1 - 2 Y_p) = \\mu_{\\text{lepton}}\n$$\nwhere $\\mu_{\\text{lepton}}$ is the equilibrium chemical potential of the charged leptons (electrons, and possibly muons). To solve this numerically, we reformulate it as a root-finding problem. We define a residual function $f(Y_p; n_B)$ such that its root corresponds to the solution:\n$$\nf(Y_p; n_B) = 4 S(n_B)(1 - 2Y_p) - \\mu_{\\text{lepton}}(Y_p, n_B) = 0\n$$\nAs established in the validation, this function is strictly monotonic with respect to $Y_p$ for any fixed $n_B > 0$, guaranteeing a unique root that can be found efficiently with standard numerical algorithms.\n\n**2. Algorithmic Design**\nThe algorithm proceeds by iterating through each specified baryon density $n_B$ and solving for the corresponding $Y_p$. For each $n_B$, the core of the algorithm is a numerical root-finder. We employ Brent's method, which is known for its robustness and efficiency, as it combines the guaranteed convergence of the bisection method with the speed of interpolation methods.\n\nThe key is the implementation of the residual function $f(Y_p; n_B)$, which must correctly evaluate the lepton chemical potential $\\mu_{\\text{lepton}}$. This evaluation depends on whether the conditions are suitable for muon creation.\n\n**3. Evaluation of the Lepton Chemical Potential, $\\mu_{\\text{lepton}}$**\nFor a given trial value of $Y_p$ and the specified $n_B$, the proton density is $n_p = Y_p n_B$. The charge neutrality condition is $n_p = n_e + n_\\mu$.\n\n- **Step 3a: Threshold Check.** We first determine if muons are present. Muons appear only if the electron chemical potential $\\mu_e$ reaches the muon rest-mass energy, $m_\\mu c^2 \\approx 105.7\\,\\mathrm{MeV}$. We test this by calculating a hypothetical electron chemical potential, $\\mu_e^{\\text{hyp}}$, assuming all negative charge is carried by electrons (i.e., $n_e = n_p$ and $n_\\mu=0$):\n$$\n\\mu_e^{\\text{hyp}} = \\mu_e(n_e=n_p) = \\sqrt{(m_e c^2)^2 + (\\hbar c (3\\pi^2 n_p)^{1/3})^2}\n$$\n\n- **Step 3b: Case 1 - Muon-Free Regime ($\\mu_e^{\\text{hyp}} < m_\\mu c^2$).** If the hypothetical potential is below the muon threshold, our assumption was correct. Muons are not present ($n_\\mu=0$), and the system consists of neutrons, protons, and electrons (npe matter). The equilibrium lepton chemical potential is simply this hypothetical value:\n$$\n\\mu_{\\text{lepton}} = \\mu_e^{\\text{hyp}}\n$$\n\n- **Step 3c: Case 2 - Muon-Present Regime ($\\mu_e^{\\text{hyp}} \\ge m_\\mu c^2$).** If the hypothetical potential is at or above the threshold, muons must be present to establish equilibrium (npeμ matter). The electrons and muons share a common chemical potential, $\\mu_e = \\mu_\\mu \\equiv \\mu_\\ell$. This common potential $\\mu_\\ell$ is the value that satisfies the charge neutrality condition with contributions from both leptons:\n$$\nn_p = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell)\n$$\nThis equation for $\\mu_\\ell$ is itself a transcendental equation that must be solved. We define a second residual function, $g(\\mu_\\ell)$, for this sub-problem:\n$$\ng(\\mu_\\ell) = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) - n_p = 0\n$$\nThe function $g(\\mu_\\ell)$ is strictly increasing for $\\mu_\\ell \\ge m_\\mu c^2$. The root is guaranteed to exist in the interval $[m_\\mu c^2, \\mu_e^{\\text{hyp}}]$. We once again use Brent's method to find the unique root $\\mu_\\ell$ within this bracket. This solved value becomes the equilibrium lepton potential for the main problem:\n$$\n\\mu_{\\text{lepton}} = \\mu_\\ell\n$$\n\n**4. Numerical Solution for $Y_p$**\nWith a complete method to evaluate the residual function $f(Y_p; n_B)$ for any valid $Y_p$, we apply Brent's method to find its root. The search for $Y_p$ is bracketed in the interval $[10^{-9}, 0.5]$. The lower bound is a small positive number to avoid numerical issues at $Y_p=0$. The upper bound is $0.5$ because for $Y_p > 0.5$, the LHS $4 S(n_B)(1 - 2Y_p)$ becomes negative while the RHS (a chemical potential) is always positive, making a solution impossible.\n\nThis nested root-finding approach provides a robust and accurate method to determine the equilibrium composition $Y_p$ for any given baryon density $n_B$ across both the muon-free and muon-present regimes. The final Python implementation encapsulates this logic, using `scipy.optimize.brentq` for both the outer ($Y_p$) and inner ($\\mu_\\ell$) root-finding tasks.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the proton fraction Yp in beta-equilibrated neutron star matter\n    for a given set of baryon number densities.\n    \"\"\"\n\n    #\n    # Step 1: Define physical constants and model parameters\n    # All units are in MeV and fm.\n    #\n\n    # Nuclear physics parameters for the symmetry energy\n    S0 = 32.0          # MeV, symmetry energy at saturation\n    N0 = 0.16          # fm^-3, nuclear saturation density\n    GAMMA = 0.6        # unitless, power-law index for S(n_B)\n\n    # Fundamental constants\n    M_E_C2 = 0.51099895   # MeV, electron rest energy\n    M_MU_C2 = 105.6583755 # MeV, muon rest energy\n    HBAR_C = 197.3269804   # MeV fm\n\n    #\n    # Step 2: Implement the physical model equations as functions\n    #\n\n    def S_func(n_b: float) -> float:\n        \"\"\"Calculates the nuclear symmetry energy S as a function of baryon density n_B.\"\"\"\n        return S0 * (n_b / N0)**GAMMA\n\n    def mu_lepton_from_density(n_l: float, m_l_c2: float) -> float:\n        \"\"\"\n        Calculates lepton chemical potential from its number density for a relativistic Fermi gas.\n        \"\"\"\n        if n_l <= 0:\n            return m_l_c2\n        # Expression: sqrt( (m*c^2)^2 + (hbar*c * k_F)^2 ), where k_F = (3*pi^2*n)^(1/3)\n        kf_term = HBAR_C * (3 * np.pi**2 * n_l)**(1/3)\n        return np.sqrt(m_l_c2**2 + kf_term**2)\n\n    def n_lepton_from_mu(mu: float, m_l_c2: float) -> float:\n        \"\"\"\n        Calculates lepton number density from its chemical potential (inverse of the above).\n        \"\"\"\n        if mu < m_l_c2:\n            return 0.0\n        # Expression: (k_F^3) / (3*pi^2), where k_F = sqrt(mu^2 - (m*c^2)^2) / (hbar*c)\n        kf3 = (np.sqrt(mu**2 - m_l_c2**2) / HBAR_C)**3\n        return kf3 / (3 * np.pi**2)\n\n    def equilibrium_residual(y_p: float, n_b: float) -> float:\n        \"\"\"\n        The residual function f(Y_p) = LHS - RHS = 0 that we need to solve.\n        LHS = 4 * S(n_B) * (1 - 2*Y_p)\n        RHS = mu_lepton (which depends on Y_p and n_B)\n        \"\"\"\n        # Ensure y_p is strictly positive to avoid division by zero or log of zero issues downstream\n        # if other models were used. For this model, it's just good practice.\n        if y_p <= 0:\n            y_p = 1e-15\n\n        # Left-hand side (from nuclear forces)\n        lhs = 4 * S_func(n_b) * (1 - 2 * y_p)\n\n        # Right-hand side (from lepton equilibrium)\n        n_p = y_p * n_b\n\n        # First, calculate hypothetical mu_e assuming no muons (n_e = n_p)\n        # to check if we are above the muon creation threshold.\n        mu_e_hypothetical = mu_lepton_from_density(n_p, M_E_C2)\n\n        if mu_e_hypothetical < M_MU_C2:\n            # Case 1: Muon-free regime.\n            # The lepton chemical potential is simply mu_e_hypothetical.\n            rhs = mu_e_hypothetical\n        else:\n            # Case 2: Muons are present.\n            # We must find the common chemical potential mu_l such that\n            # charge neutrality n_p = n_e(mu_l) + n_mu(mu_l) is satisfied.\n            # This requires solving another root-finding problem for mu_l.\n            \n            def charge_neutrality_residual(mu_l: float, n_p_target: float) -> float:\n                \"\"\"Residual for the inner root-finder to find mu_l.\"\"\"\n                return n_lepton_from_mu(mu_l, M_E_C2) + n_lepton_from_mu(mu_l, M_MU_C2) - n_p_target\n\n            # The root mu_l is bracketed by [M_MU_C2, mu_e_hypothetical].\n            # At mu_l=M_MU_C2, n_mu=0 and n_e < n_p, so residual < 0.\n            # At mu_l=mu_e_hypothetical, n_e=n_p and n_mu>0, so residual > 0.\n            try:\n                mu_l_equilibrium = brentq(\n                    charge_neutrality_residual,\n                    a=M_MU_C2,\n                    b=mu_e_hypothetical,\n                    args=(n_p,),\n                    xtol=1e-12, rtol=1e-12\n                )\n            except ValueError:\n                 # This can happen if the bracket endpoints do not have opposite signs,\n                 # which indicates an issue with the model or a very narrow range.\n                 # Let's ensure the upper bound is strictly larger.\n                 mu_l_equilibrium = brentq(\n                    charge_neutrality_residual,\n                    a=M_MU_C2,\n                    b=mu_e_hypothetical * (1 + 1e-9), # Widen bracket slightly\n                    args=(n_p,),\n                    xtol=1e-12, rtol=1e-12\n                )\n\n            rhs = mu_l_equilibrium\n\n        return lhs - rhs\n\n    #\n    # Step 3: Define the test cases and solve for each\n    #\n    test_cases = [1.0e-4, 2.0e-2, 1.6e-1, 4.8e-1, 1.0]\n\n    results = []\n    # Set up bracketing for Y_p. The solution must be in (0, 0.5).\n    # At Y_p -> 0, f > 0. At Y_p = 0.5, LHS = 0 and RHS > 0, so f < 0.\n    y_p_bracket_min = 1e-9\n    y_p_bracket_max = 0.5\n\n    for n_b_val in test_cases:\n        y_p_solution = brentq(\n            equilibrium_residual,\n            a=y_p_bracket_min,\n            b=y_p_bracket_max,\n            args=(n_b_val,),\n            xtol=1e-12, rtol=1e-12\n        )\n        results.append(f\"{y_p_solution:.6f}\")\n\n    #\n    # Step 4: Print the final output in the required format\n    #\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3473660"}, {"introduction": "Bridging the gap between a theoretical EOS and a functioning hydrodynamics code involves critical numerical implementation choices. This exercise tackles the \"conservative-to-primitive\" variable recovery, a core algorithm in any relativistic hydrodynamics simulation, which depends sensitively on the EOS. You will discover how the choice of interpolation scheme for a tabulated EOS can introduce non-physical artifacts like superluminal sound speeds, and you will learn how to prevent such causality violations using robust numerical techniques. [@problem_id:3473680]", "problem": "You are asked to implement a conservative-to-primitive variable recovery for special relativistic hydrodynamics using a tabulated Equation of State (EOS) for dense nuclear matter, and to demonstrate how a monotone piecewise cubic Hermite interpolation prevents spurious superluminal local sound speed during the inversion. Work in natural units with speed of light $c=1$, so all quantities are dimensionless. The EOS is assumed to be cold and barotropic, specified by a table of energy density $e$ versus pressure $p$, with $p=p(e)$. Your implementation must construct two EOS interpolants from the same table: a standard cubic spline (not-a-knot) and a monotone Piecewise Cubic Hermite Interpolating Polynomial (PCHIP). You will use each interpolant within a Newton iteration scheme that solves for the pressure $p$ from the conserved variables. Within the Newton iterations, you must compute the local sound speed squared $c_s^2=\\mathrm{d}p/\\mathrm{d}e$ via the derivative of the interpolant being used at the current iterate. You must record a boolean flag indicating whether $c_s^2$ exceeded $1$ at any point during the iterations (a causality violation).\n\nFundamental definitions and relations to be used as the base:\n- Special relativistic hydrodynamics conserved variables in one spatial dimension, using natural units $c=1$, are defined by\n  - Rest-mass density in the laboratory frame $D=\\rho W$,\n  - Momentum density magnitude $S = (e+p) W^2 v$,\n  - Energy density excluding $D$ given by $\\tau = (e+p) W^2 - p - D$,\n  where $\\rho$ is the rest-mass density in the fluid rest frame, $e$ is the total energy density including rest-mass energy, $p$ is the pressure, $v$ is the fluid three-velocity, and $W = 1/\\sqrt{1-v^2}$ is the Lorentz factor.\n- Define $Q \\equiv \\tau + D + p$. Then $Q = (e+p) W^2$. In terms of $Q$ and the given $S$, the velocity magnitude satisfies $v^2 = S^2/Q^2$, and the energy density satisfies the identity\n  $$ e = \\tau + D - \\frac{S^2}{\\tau + D + p} = \\tau + D - \\frac{S^2}{Q}. $$\n- The sound speed squared of a barotropic EOS is $c_s^2 = \\frac{\\mathrm{d}p}{\\mathrm{d}e}$. In the Newton iteration for the pressure $p$, define the residual $f(p) = p - p_{\\mathrm{EOS}}(e(p))$ with $e(p)$ given above. Then\n  $$ \\frac{\\mathrm{d}e}{\\mathrm{d}p} = \\frac{S^2}{(\\tau + D + p)^2} = \\frac{S^2}{Q^2}, \\quad \\frac{\\mathrm{d}f}{\\mathrm{d}p} = 1 - c_s^2 \\frac{S^2}{Q^2}. $$\n\nEOS table:\n- Use the following tabulated points $(e_i,p_i)$ for $i \\in \\{1,\\dots,6\\}$:\n  - $e_1 = 1.0$, $p_1 = 0.05$,\n  - $e_2 = 1.5$, $p_2 = 0.15$,\n  - $e_3 = 2.0$, $p_3 = 0.625$,\n  - $e_4 = 2.5$, $p_4 = 1.1$,\n  - $e_5 = 4.0$, $p_5 = 1.175$,\n  - $e_6 = 5.0$, $p_6 = 1.225$.\n- These data have segment slopes strictly less than $1$ to ensure a causal underlying barotropic EOS when interpolated monotonically. However, a standard cubic spline may produce local overshoots in $\\mathrm{d}p/\\mathrm{d}e$ exceeding $1$ between nodes due to non-monotone curvature.\n\nNumerical inversion task to implement:\n- For given conserved variables $(D,S,\\tau)$ and a chosen interpolant for $p(e)$, recover the primitive pressure $p$ by solving $f(p) = p - p_{\\mathrm{EOS}}(e(p)) = 0$ with Newton’s method. At each iteration:\n  - Compute $Q = \\tau + D + p$,\n  - Compute $e = \\tau + D - S^2/Q$,\n  - Evaluate $p_{\\mathrm{EOS}}(e)$ and $c_s^2 = \\mathrm{d}p_{\\mathrm{EOS}}/\\mathrm{d}e$ at this $e$,\n  - Update $p \\leftarrow p - f(p)/f'(p)$ with $f'(p) = 1 - c_s^2 S^2/Q^2$.\n- Use as initial guess $p^{(0)} = p_{\\mathrm{EOS}}(e^{(0)})$ with $e^{(0)} = \\tau + D - S^2/(\\tau + D)$, which corresponds to taking $p$ small in the denominator of the exact expression for $e$.\n- During iterations, clamp $p$ to the EOS table’s pressure bounds to remain within the interpolation range. Terminate when $|f(p)| < 10^{-12}$ or after $50$ iterations. Record a boolean flag that is true if $c_s^2 > 1$ at any iteration (use a tolerance of $10^{-12}$ when comparing to $1$).\n\nTest suite:\n- Construct three test cases by choosing $(e_{\\mathrm{true}}, v_{\\mathrm{true}})$ and setting $\\rho_{\\mathrm{true}} = e_{\\mathrm{true}}$. For each case, compute $p_{\\mathrm{true}}$ using the monotone PCHIP interpolant, then compute conserved variables using the definitions above. Use the following cases:\n  - Case $1$: $e_{\\mathrm{true}} = 1.8$, $v_{\\mathrm{true}} = 0.2$,\n  - Case $2$: $e_{\\mathrm{true}} = 2.3$, $v_{\\mathrm{true}} = 0.5$,\n  - Case $3$: $e_{\\mathrm{true}} = 4.5$, $v_{\\mathrm{true}} = 0.7$.\n- For each case, run the conservative-to-primitive recovery twice: once using the standard cubic spline interpolant and once using the monotone PCHIP interpolant. For each run, report the recovered pressure and whether any iteration saw $c_s^2 > 1$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must concatenate, for each of the three cases in order, the quadruple consisting of the recovered pressure using the cubic spline interpolant, the recovered pressure using the monotone PCHIP interpolant, the boolean flag for any $c_s^2>1$ during iterations for the cubic interpolant, and the boolean flag for any $c_s^2>1$ during iterations for the PCHIP interpolant. The output therefore has $12$ entries in total and looks like\n  $$ [p_{\\mathrm{cubic}}^{(1)}, p_{\\mathrm{pchip}}^{(1)}, \\mathrm{flag}_{\\mathrm{cubic}}^{(1)}, \\mathrm{flag}_{\\mathrm{pchip}}^{(1)}, p_{\\mathrm{cubic}}^{(2)}, p_{\\mathrm{pchip}}^{(2)}, \\mathrm{flag}_{\\mathrm{cubic}}^{(2)}, \\mathrm{flag}_{\\mathrm{pchip}}^{(2)}, p_{\\mathrm{cubic}}^{(3)}, p_{\\mathrm{pchip}}^{(3)}, \\mathrm{flag}_{\\mathrm{cubic}}^{(3)}, \\mathrm{flag}_{\\mathrm{pchip}}^{(3)} ]. $$\n- All pressures must be printed as floating-point numbers in natural units with $c=1$, and the flags as booleans.", "solution": "The task is to implement and compare two conservative-to-primitive variable recovery schemes in one-dimensional special relativistic hydrodynamics (SRHD). The core of the problem lies in solving for the primitive variables, particularly the pressure $p$, from the conserved variables $(D, S, \\tau)$, using a tabulated, barotropic Equation of State (EOS), $p=p(e)$. The comparison focuses on the impact of the interpolation method for the EOS table on the physical causality of the system during the numerical inversion. Specifically, we will contrast a standard cubic spline with a monotone piecewise cubic Hermite interpolating polynomial (PCHIP) and demonstrate that the former can lead to spurious superluminal sound speeds ($c_s > 1$), a violation of causality, whereas the latter, by design, prevents this issue.\n\nFirst, we establish the theoretical framework in natural units where the speed of light $c=1$. The conserved variables are the rest-mass density $D$, momentum density $S$, and energy density $\\tau$ as measured in the laboratory frame. They are defined in terms of the primitive variables—rest-mass density $\\rho$, total energy density $e$ (including rest mass), pressure $p$ in the fluid's rest frame, and the fluid's velocity $v$—as follows:\n$$ D = \\rho W $$\n$$ S = (e+p) W^2 v $$\n$$ \\tau = (e+p) W^2 - p - D $$\nwhere $W = 1/\\sqrt{1-v^2}$ is the Lorentz factor.\n\nThe goal of the conservative-to-primitive inversion is, given $(D, S, \\tau)$, to find $(p, v, e, \\rho)$. We can establish a set of algebraic relations that simplify this inversion. Let us define an auxiliary variable $Q \\equiv \\tau + D + p$. Substituting the expression for $\\tau$, we find:\n$$ Q = ( (e+p) W^2 - p - D ) + D + p = (e+p) W^2 $$\nUsing this definition of $Q$, the momentum density $S$ can be written as $S = Qv$, which immediately gives the velocity magnitude as $v = S/Q$. Since $v^2 = S^2/Q^2$, the Lorentz factor squared is $W^2 = 1/(1-v^2) = 1/(1 - S^2/Q^2) = Q^2/(Q^2-S^2)$.\n\nFurthermore, we can derive an expression for the energy density $e$ that depends only on the conserved variables and the yet-unknown pressure $p$:\n$$ \\tau = Q - p - D \\implies e = \\frac{Q}{W^2} - p = Q(1-v^2) - p = Q\\frac{Q^2-S^2}{Q^2} - p = \\frac{Q^2-S^2}{Q} - p $$\nSubstituting $Q = \\tau + D + p$ yields:\n$$ e = \\frac{(\\tau+D+p)^2 - S^2}{\\tau+D+p} - p = \\frac{(\\tau+D)^2 + 2p(\\tau+D) + p^2 - S^2 - p(\\tau+D+p)}{\\tau+D+p} $$\n$$ e = \\frac{(\\tau+D)^2 + p(\\tau+D) - S^2}{\\tau+D+p} = \\frac{(\\tau+D)(\\tau+D+p) - S^2}{\\tau+D+p} = \\tau + D - \\frac{S^2}{\\tau+D+p} $$\nThis final relation, $e = \\tau + D - S^2/Q$, shows that $e$ is a function of $p$ for given $(D, S, \\tau)$.\n\nSince the EOS is barotropic, $p$ is a function of $e$ alone, which we denote as $p_{\\mathrm{EOS}}(e)$. The problem of finding $p$ is thus reduced to solving the following scalar, non-linear equation:\n$$ f(p) = p - p_{\\mathrm{EOS}}(e(p)) = 0 $$\nwhere $e(p) = \\tau + D - S^2/(\\tau + D + p)$. This equation is solved using Newton's method, an iterative root-finding algorithm given by:\n$$ p_{k+1} = p_k - \\frac{f(p_k)}{f'(p_k)} $$\nThe derivative $f'(p)$ is found by applying the chain rule:\n$$ f'(p) = \\frac{\\mathrm{d}f}{\\mathrm{d}p} = 1 - \\frac{\\mathrm{d}p_{\\mathrm{EOS}}}{\\mathrm{d}e} \\frac{\\mathrm{d}e}{\\mathrm{d}p} $$\nThe term $\\mathrm{d}p_{\\mathrm{EOS}}/\\mathrm{d}e$ is the square of the local sound speed, $c_s^2$. The term $\\mathrm{d}e/\\mathrm{d}p$ is:\n$$ \\frac{\\mathrm{d}e}{\\mathrm{d}p} = \\frac{\\mathrm{d}}{\\mathrm{d}p} \\left( \\tau + D - \\frac{S^2}{\\tau + D + p} \\right) = -S^2 \\left( -(\\tau+D+p)^{-2} \\right) = \\frac{S^2}{(\\tau+D+p)^2} = \\frac{S^2}{Q^2} $$\nTherefore, the derivative of the residual function is:\n$$ f'(p) = 1 - c_s^2 \\frac{S^2}{Q^2} $$\n\nThe functions $p_{\\mathrm{EOS}}(e)$ and $c_s^2(e) = \\mathrm{d}p_{\\mathrm{EOS}}/\\mathrm{d}e$ are not known analytically but are constructed by interpolating a given table of $(e_i, p_i)$ points. The choice of interpolation scheme is critical. A standard cubic spline enforces $C^2$ continuity (continuous second derivative) at the data points, which can cause the first derivative of the interpolant to \"overshoot\" or oscillate between points. If such an overshoot causes $c_s^2$ to exceed $1$, it represents a numerical violation of causality, as no signal can propagate faster than light.\n\nIn contrast, a Piecewise Cubic Hermite Interpolating Polynomial (PCHIP) is designed to preserve monotonicity. If the input data is monotonic (i.e., $p_i$ is a non-decreasing function of $e_i$), the resulting interpolant will also be monotonic. This property also constrains the derivative of the interpolant, preventing the unphysical overshoots that can lead to $c_s^2 > 1$, provided the slopes of the segments of the underlying data are all less than or equal to $1$. The provided EOS table satisfies this condition.\n\nThe algorithm to be implemented is as follows:\n1.  Construct two EOS representations from the given table: one using `scipy.interpolate.CubicSpline` and another using `scipy.interpolate.PchipInterpolator`, along with their respective first derivative functions.\n2.  For each test case, defined by $(e_{\\mathrm{true}}, v_{\\mathrm{true}})$:\n    a. Calculate the \"true\" pressure $p_{\\mathrm{true}}$ using the PCHIP interpolant.\n    b. Assume $\\rho_{\\mathrm{true}} = e_{\\mathrm{true}}$ as per the problem statement.\n    c. Compute the corresponding conserved variables $(D, S, \\tau)$ using their definitions. These will serve as input to the recovery scheme.\n3.  For each set of $(D, S, \\tau)$ and for each of the two interpolants:\n    a. Initialize the pressure $p$ with a guess $p^{(0)} = p_{\\mathrm{EOS}}(e^{(0)})$, where $e^{(0)} = \\tau+D-S^2/(\\tau+D)$.\n    b. Begin Newton's method iterations. In each iteration, calculate $Q$, $e$, $p_{\\mathrm{EOS}}(e)$, and $c_s^2(e)$.\n    c. Track whether $c_s^2$ exceeds $1 + 10^{-12}$ at any point during the iteration.\n    d. Update the pressure $p$ using the Newton step. Clamp $p$ to stay within the tabulated pressure range. Also, clamp $e$ to stay within the tabulated energy density range before evaluating the interpolants to ensure numerical stability.\n    e. Terminate upon convergence ($|f(p)| < 10^{-12}$) or after $50$ iterations.\n4.  Record the final recovered pressure and the causality violation flag for each run. Collate and output all 12 results in the specified format. This process will highlight the robustness of PCHIP against the potential pathologies of standard cubic splines in a physically-motivated numerical context.", "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import CubicSpline, PchipInterpolator\n\ndef recover_pressure(D, S, tau, p_interp, cs2_interp, e_tab, p_tab):\n    \"\"\"\n    Recovers the primitive variable pressure 'p' from the conserved variables (D, S, tau)\n    using Newton's method with a given EOS interpolant.\n    \"\"\"\n    TOL = 1e-12\n    CAUSALITY_TOL = 1e-12\n    MAX_ITER = 50\n    \n    e_min, e_max = e_tab[0], e_tab[-1]\n    p_min, p_max = p_tab[0], p_tab[-1]\n    \n    causality_violated = False\n\n    # Initial guess for p\n    # Denominator (tau + D) is positive for the given test cases.\n    e0_denom = tau + D\n    if e0_denom <= 0:\n        # Fallback for a pathological case, though not expected here.\n        e0 = e_min\n    else:\n        e0 = tau + D - S**2 / e0_denom\n    \n    # Clamp initial e to the interpolator's domain\n    e0_clamped = np.clip(e0, e_min, e_max)\n    p = p_interp(e0_clamped)\n    p = np.clip(p, p_min, p_max)\n\n    for _ in range(MAX_ITER):\n        # Define Q based on current pressure iterate p\n        Q = tau + D + p\n        if Q <= 0:  # Physically Q = (e+p)W^2, should be > 0.\n            break\n\n        # Calculate energy density e\n        e = tau + D - S**2 / Q\n        \n        # Clamp e to the valid domain of the EOS table before interpolation\n        e_clamped = np.clip(e, e_min, e_max)\n\n        # Evaluate EOS and its derivative (cs^2)\n        p_eos = p_interp(e_clamped)\n        cs2 = cs2_interp(e_clamped)\n        \n        # Check for causality violation\n        if cs2 > 1.0 + CAUSALITY_TOL:\n            causality_violated = True\n            \n        # P-version of the residual function f(p) = p - p_eos(e(p))\n        f_p = p - p_eos\n        \n        # Check for convergence\n        if abs(f_p) < TOL:\n            break\n            \n        # Derivative of the residual function f'(p)\n        fp_prime = 1.0 - cs2 * S**2 / Q**2\n\n        # Avoid division by zero if stalled\n        if abs(fp_prime) < 1e-14:\n            break\n            \n        # Newton-Raphson update\n        p_update = p - f_p / fp_prime\n        \n        # Clamp pressure to remain within the tabulated EOS range\n        p = np.clip(p_update, p_min, p_max)\n        \n    return p, causality_violated\n\n\ndef solve():\n    \"\"\"\n    Main function to set up the problem, run the solvers, and print the results.\n    \"\"\"\n    # EOS Table data provided in the problem\n    e_tab = np.array([1.0, 1.5, 2.0, 2.5, 4.0, 5.0])\n    p_tab = np.array([0.05, 0.15, 0.625, 1.1, 1.175, 1.225])\n\n    # Test cases: (e_true, v_true)\n    test_cases = [\n        (1.8, 0.2),\n        (2.3, 0.5),\n        (4.5, 0.7),\n    ]\n\n    # 1. Construct interpolants and their derivatives\n    # Standard cubic spline\n    p_of_e_cubic = CubicSpline(e_tab, p_tab, bc_type='not-a-knot')\n    cs2_of_e_cubic = p_of_e_cubic.derivative(1)\n    \n    # Monotone PCHIP\n    p_of_e_pchip = PchipInterpolator(e_tab, p_tab)\n    cs2_of_e_pchip = p_of_e_pchip.derivative(1)\n\n    results = []\n    \n    # 2. Loop through test cases\n    for e_true, v_true in test_cases:\n        # a. Calculate \"true\" primitive variables\n        p_true = float(p_of_e_pchip(e_true))\n        # b. Use prescribed relation rho_true = e_true for test case generation\n        rho_true = e_true\n        \n        # c. Compute conserved variables from true primitives\n        W = 1.0 / np.sqrt(1.0 - v_true**2)\n        D = rho_true * W\n        S = (e_true + p_true) * W**2 * v_true\n        tau = (e_true + p_true) * W**2 - p_true - D\n        \n        # 3. Run recovery for each interpolant\n        p_rec_cubic, flag_cubic = recover_pressure(D, S, tau, p_of_e_cubic, cs2_of_e_cubic, e_tab, p_tab)\n        p_rec_pchip, flag_pchip = recover_pressure(D, S, tau, p_of_e_pchip, cs2_of_e_pchip, e_tab, p_tab)\n        \n        # 4. Append results in the specified order\n        results.append(p_rec_cubic)\n        results.append(p_rec_pchip)\n        results.append(str(flag_cubic).lower())\n        results.append(str(flag_pchip).lower())\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3473680"}]}