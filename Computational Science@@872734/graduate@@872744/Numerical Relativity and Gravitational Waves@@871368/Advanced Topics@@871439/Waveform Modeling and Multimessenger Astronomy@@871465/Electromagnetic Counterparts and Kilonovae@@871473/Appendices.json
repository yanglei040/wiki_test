{"hands_on_practices": [{"introduction": "A cornerstone of astrophysical modeling is distilling complex phenomena into understandable analytical forms. This exercise invites you to derive the fundamental scaling relations that govern kilonova evolution, starting from first principles like homologous expansion and photon diffusion [@problem_id:3473383]. By exploring how opacity, $\\kappa$—a key uncertainty tied to the composition of the ejecta—affects the light curve's peak time and temperature, you will gain a deep, physical intuition for why kilonovae evolve as they do.", "problem": "A binary neutron star (BNS) merger detected through gravitational waves yields a homologous, spherically symmetric kilonova ejecta characterized by fixed ejecta mass $M_{\\rm ej}$ and characteristic expansion velocity $v$. Numerical relativity provides $(M_{\\rm ej}, v)$ and indicates an approximately uniform density profile at early times. Assume the following physically motivated bases: (i) the ejecta radius evolves as $R(t) = v t$, (ii) the mass density is $\\rho(t) = 3 M_{\\rm ej}/(4 \\pi R(t)^{3})$, (iii) the optical depth is $\\tau(t) = \\kappa \\rho(t) R(t)$ with frequency-averaged (grey) opacity $\\kappa$, (iv) the diffusion time is $t_{\\rm diff}(t) = \\tau(t) R(t)/c$ where $c$ is the speed of light, and the bolometric light curve peaks when $t_{\\rm diff}(t)$ equals the expansion time $t$, and (v) the bolometric luminosity near peak is powered by radioactive heating with a power-law heating rate per unit mass $\\dot{q}(t) = q_{0} \\left(t/t_{0}\\right)^{-\\alpha}$, where $q_{0}$, $t_{0}$, and the index $\\alpha$ are constants independent of $\\kappa$. Further assume the emergent spectrum at peak is approximately thermal so that the color temperature can be identified with the effective temperature $T_{\\rm eff}$, defined by $L_{\\rm peak} = 4 \\pi R(t_{\\rm peak})^{2} \\sigma T_{\\rm eff}^{4}$, where $\\sigma$ is the Stefan–Boltzmann constant.\n\nSuppose updated atomic line data revise the opacity from $\\kappa$ to $2 \\kappa$, with $M_{\\rm ej}$ and $v$ fixed. Starting only from the bases listed above and no additional kilonova-specific scaling formulas, derive how the bolometric peak time $t_{\\rm peak}$ and the color temperature at peak $T_{\\rm eff}$ scale with $\\kappa$. Then, quantify the multiplicative change in $t_{\\rm peak}$ and $T_{\\rm eff}$ when $\\kappa$ is doubled (i.e., $\\kappa \\rightarrow 2 \\kappa$), leaving the heating index $\\alpha$ symbolic.\n\nExpress your final answer as a two-entry row matrix containing the multiplicative factor for $t_{\\rm peak}$ and the multiplicative factor for $T_{\\rm eff}$, in that order. No rounding is required, and you should not include units because both factors are dimensionless.", "solution": "We begin from the stated bases. The ejecta radius evolves homologously as $R(t) = v t$, and the density is\n$$\n\\rho(t) = \\frac{3 M_{\\rm ej}}{4 \\pi R(t)^{3}} = \\frac{3 M_{\\rm ej}}{4 \\pi v^{3} t^{3}}.\n$$\nThe optical depth is\n$$\n\\tau(t) = \\kappa \\rho(t) R(t) = \\kappa \\left( \\frac{3 M_{\\rm ej}}{4 \\pi v^{3} t^{3}} \\right) (v t) = \\frac{3 \\kappa M_{\\rm ej}}{4 \\pi v^{2} t^{2}}.\n$$\nThe diffusion time is $t_{\\rm diff}(t) = \\tau(t) R(t)/c$, which gives\n$$\nt_{\\rm diff}(t) = \\frac{3 \\kappa M_{\\rm ej}}{4 \\pi v^{2} t^{2}} \\cdot \\frac{v t}{c} = \\frac{3 \\kappa M_{\\rm ej}}{4 \\pi c v} \\cdot \\frac{1}{t}.\n$$\nThe bolometric light curve peaks when $t_{\\rm diff}(t_{\\rm peak}) = t_{\\rm peak}$, so\n$$\nt_{\\rm peak} = \\frac{3 \\kappa M_{\\rm ej}}{4 \\pi c v} \\cdot \\frac{1}{t_{\\rm peak}} \\quad \\Rightarrow \\quad t_{\\rm peak}^{2} = \\frac{3 \\kappa M_{\\rm ej}}{4 \\pi c v}.\n$$\nTherefore,\n$$\nt_{\\rm peak} \\propto \\kappa^{1/2},\n$$\nwith proportionality involving $(M_{\\rm ej}, v, c)$.\n\nNext, we derive the color temperature at peak. The bolometric luminosity near peak is taken to be $L_{\\rm peak} \\approx \\dot{q}(t_{\\rm peak}) M_{\\rm ej}$, with $\\dot{q}(t) = q_{0} \\left(t/t_{0}\\right)^{-\\alpha}$. Thus,\n$$\nL_{\\rm peak} = q_{0} M_{\\rm ej} \\left( \\frac{t_{\\rm peak}}{t_{0}} \\right)^{-\\alpha} = q_{0} M_{\\rm ej} t_{0}^{\\alpha} \\, t_{\\rm peak}^{-\\alpha}.\n$$\nAssuming a thermal spectrum at peak, the effective temperature $T_{\\rm eff}$ satisfies\n$$\nL_{\\rm peak} = 4 \\pi R(t_{\\rm peak})^{2} \\sigma T_{\\rm eff}^{4} = 4 \\pi (v t_{\\rm peak})^{2} \\sigma T_{\\rm eff}^{4}.\n$$\nSolving for $T_{\\rm eff}$,\n$$\nT_{\\rm eff}^{4} = \\frac{L_{\\rm peak}}{4 \\pi \\sigma v^{2} t_{\\rm peak}^{2}} = \\frac{q_{0} M_{\\rm ej} t_{0}^{\\alpha}}{4 \\pi \\sigma v^{2}} \\, t_{\\rm peak}^{-(\\alpha + 2)}.\n$$\nTherefore,\n$$\nT_{\\rm eff} \\propto t_{\\rm peak}^{-(\\alpha + 2)/4}.\n$$\nSince $t_{\\rm peak} \\propto \\kappa^{1/2}$, it follows that\n$$\nT_{\\rm eff} \\propto \\kappa^{-(\\alpha + 2)/8}.\n$$\n\nWe now quantify the multiplicative changes when $\\kappa$ is doubled, i.e., $\\kappa \\rightarrow 2 \\kappa$:\n- The peak time scales as $t_{\\rm peak} \\propto \\kappa^{1/2}$, so the multiplicative factor is\n$$\n\\frac{t_{\\rm peak}(2 \\kappa)}{t_{\\rm peak}(\\kappa)} = \\left( \\frac{2 \\kappa}{\\kappa} \\right)^{1/2} = 2^{1/2}.\n$$\n- The color temperature scales as $T_{\\rm eff} \\propto \\kappa^{-(\\alpha + 2)/8}$, so the multiplicative factor is\n$$\n\\frac{T_{\\rm eff}(2 \\kappa)}{T_{\\rm eff}(\\kappa)} = \\left( \\frac{2 \\kappa}{\\kappa} \\right)^{-(\\alpha + 2)/8} = 2^{-(\\alpha + 2)/8}.\n$$\n\nCollecting these, the requested two-entry row matrix (first entry for $t_{\\rm peak}$, second for $T_{\\rm eff}$) is\n$$\n\\begin{pmatrix}\n2^{1/2}  2^{-(\\alpha + 2)/8}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}2^{1/2}  2^{-(\\alpha+2)/8}\\end{pmatrix}}$$", "id": "3473383"}, {"introduction": "The joint detection of gravitational waves and a kilonova provides a uniquely powerful \"standard siren\" for cosmology. This practice simulates the process of measuring the Hubble constant, $H_0$, using a single multi-messenger event, a landmark achievement of modern astronomy [@problem_id:3473349]. You will apply statistical error propagation to combine a gravitational-wave-inferred distance with an electromagnetically-inferred redshift, gaining hands-on experience with the techniques and challenges of precision cosmology.", "problem": "A Binary Neutron Star (BNS) merger is observed in gravitational waves with an Electromagnetic (EM) kilonova counterpart, allowing identification of the host galaxy and measurement of its redshift. At low redshift, the recession velocity is related to the redshift by $v \\approx c z$, and the Hubble–Lemaître law gives $v_{\\mathrm{H}} = H_0 D$, where $H_0$ is the Hubble constant and $D$ is the distance. The observed line-of-sight recession velocity satisfies $c z = v_{\\mathrm{H}} + v_{\\mathrm{pec}}$, where $v_{\\mathrm{pec}}$ is the host galaxy’s line-of-sight peculiar velocity due to local gravitational flows. A gravitational-wave standard siren measurement provides a luminosity distance $D_L$, which for $z \\ll 1$ can be taken as the distance entering the low-redshift Hubble–Lemaître relation. Assume $v_{\\mathrm{pec}}$ is a zero-mean Gaussian with root-mean-square $\\sigma_v$, and that measurement errors in $z$, $D_L$, and the stochastic $v_{\\mathrm{pec}}$ are independent. Using linear uncertainty propagation, derive the point estimate of $H_0$ and its $1\\sigma$ uncertainty from the relations above.\n\nUse the following data: $D_L = 40 \\pm 10\\,\\mathrm{Mpc}$, $z = 0.0098 \\pm 0.0005$, and $\\sigma_v = 300\\,\\mathrm{km\\,s^{-1}}$. Take $c = 2.99792458 \\times 10^5\\,\\mathrm{km\\,s^{-1}}$. Round both the point estimate and its uncertainty to three significant figures. Express your final results in $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$.", "solution": "The problem requires the derivation of a point estimate for the Hubble constant, $H_0$, and its associated uncertainty, $\\sigma_{H_0}$, from a set of observational data and physical laws.\n\nFirst, we establish the expression for $H_0$ in terms of the given quantities. The problem provides the following relations:\n1.  The observed recession velocity: $c z = v_{\\mathrm{H}} + v_{\\mathrm{pec}}$, where $c$ is the speed of light, $z$ is the redshift, $v_{\\mathrm{H}}$ is the Hubble flow velocity, and $v_{\\mathrm{pec}}$ is the peculiar velocity.\n2.  The Hubble–Lemaître law: $v_{\\mathrm{H}} = H_0 D$, where $D$ is the distance to the host galaxy.\n3.  The low-redshift approximation ($z \\ll 1$): The luminosity distance $D_L$ is approximately equal to the proper distance, $D \\approx D_L$.\n\nSubstituting the second and third relations into the first gives:\n$$c z = H_0 D_L + v_{\\mathrm{pec}}$$\nSolving this equation for $H_0$ yields:\n$$H_0 = \\frac{c z - v_{\\mathrm{pec}}}{D_L}$$\n\nTo find the point estimate for $H_0$, denoted as $\\hat{H}_0$, we use the central values of the measured quantities. The peculiar velocity, $v_{\\mathrm{pec}}$, is described as a random variable from a zero-mean Gaussian distribution. Therefore, its expectation value, and thus its best estimate for a single measurement, is $\\langle v_{\\mathrm{pec}} \\rangle = 0$. Using the central values $\\hat{z}$ and $\\hat{D}_L$, the point estimate for $H_0$ is:\n$$\\hat{H}_0 = \\frac{c \\hat{z}}{\\hat{D}_L}$$\n\nThe problem provides the following data: $\\hat{D}_L = 40\\,\\mathrm{Mpc}$, $\\hat{z} = 0.0098$, and $c = 2.99792458 \\times 10^5\\,\\mathrm{km\\,s^{-1}}$. Substituting these values:\n$$\\hat{H}_0 = \\frac{(2.99792458 \\times 10^5\\,\\mathrm{km\\,s^{-1}}) \\times 0.0098}{40\\,\\mathrm{Mpc}} \\approx 73.44915\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$$\nRounding to three significant figures, the point estimate is $\\hat{H}_0 \\approx 73.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$.\n\nNext, we calculate the $1\\sigma$ uncertainty, $\\sigma_{H_0}$, using the linear propagation of uncertainty. For a function $H_0(z, D_L, v_{\\mathrm{pec}})$, the variance $\\sigma_{H_0}^2$ is given by:\n$$\\sigma_{H_0}^2 \\approx \\left(\\frac{\\partial H_0}{\\partial z}\\right)^2 \\sigma_z^2 + \\left(\\frac{\\partial H_0}{\\partial D_L}\\right)^2 \\sigma_{D_L}^2 + \\left(\\frac{\\partial H_0}{\\partial v_{\\mathrm{pec}}}\\right)^2 \\sigma_{v_{\\mathrm{pec}}}^2$$\nThis formula assumes that the uncertainties in $z$, $D_L$, and $v_{\\mathrm{pec}}$ are independent, as stated in the problem. The term $\\sigma_{v_{\\mathrm{pec}}}$ corresponds to the given root-mean-square $\\sigma_v$.\n\nWe compute the partial derivatives of $H_0 = (c z - v_{\\mathrm{pec}}) / D_L$ and evaluate them at the central values (i.e., $\\hat{z}$, $\\hat{D}_L$, and $v_{\\mathrm{pec}} = 0$):\n$$\\frac{\\partial H_0}{\\partial z} = \\frac{c}{D_L} \\implies \\left. \\frac{\\partial H_0}{\\partial z} \\right|_{\\mathrm{cen}} = \\frac{c}{\\hat{D}_L}$$\n$$\\frac{\\partial H_0}{\\partial D_L} = -\\frac{c z - v_{\\mathrm{pec}}}{D_L^2} \\implies \\left. \\frac{\\partial H_0}{\\partial D_L} \\right|_{\\mathrm{cen}} = -\\frac{c \\hat{z}}{\\hat{D}_L^2} = -\\frac{\\hat{H}_0}{\\hat{D}_L}$$\n$$\\frac{\\partial H_0}{\\partial v_{\\mathrm{pec}}} = -\\frac{1}{D_L} \\implies \\left. \\frac{\\partial H_0}{\\partial v_{\\mathrm{pec}}} \\right|_{\\mathrm{cen}} = -\\frac{1}{\\hat{D}_L}$$\n\nSubstituting these into the variance formula:\n$$\\sigma_{H_0}^2 \\approx \\left(\\frac{c}{\\hat{D}_L}\\right)^2 \\sigma_z^2 + \\left(-\\frac{\\hat{H}_0}{\\hat{D}_L}\\right)^2 \\sigma_{D_L}^2 + \\left(-\\frac{1}{\\hat{D}_L}\\right)^2 \\sigma_v^2$$\nTo simplify, we can work with the relative uncertainty, $(\\sigma_{H_0}/\\hat{H}_0)$. Dividing the equation by $\\hat{H}_0^2 = (c\\hat{z}/\\hat{D}_L)^2$:\n$$\\left(\\frac{\\sigma_{H_0}}{\\hat{H}_0}\\right)^2 \\approx \\frac{1}{\\hat{H}_0^2} \\left[ \\left(\\frac{c}{\\hat{D}_L}\\right)^2 \\sigma_z^2 + \\left(\\frac{\\hat{H}_0}{\\hat{D}_L}\\right)^2 \\sigma_{D_L}^2 + \\frac{\\sigma_v^2}{\\hat{D}_L^2} \\right]$$\n$$\\left(\\frac{\\sigma_{H_0}}{\\hat{H}_0}\\right)^2 \\approx \\left(\\frac{\\hat{D}_L}{c\\hat{z}}\\right)^2 \\left(\\frac{c}{\\hat{D}_L}\\right)^2 \\sigma_z^2 + \\left(\\frac{1}{\\hat{D}_L}\\right)^2 \\sigma_{D_L}^2 + \\frac{1}{\\hat{H}_0^2} \\frac{\\sigma_v^2}{\\hat{D}_L^2}$$\n$$\\left(\\frac{\\sigma_{H_0}}{\\hat{H}_0}\\right)^2 \\approx \\left(\\frac{\\sigma_z}{\\hat{z}}\\right)^2 + \\left(\\frac{\\sigma_{D_L}}{\\hat{D}_L}\\right)^2 + \\frac{\\sigma_v^2}{(c\\hat{z})^2}$$\nThis final expression succinctly captures the three independent sources of uncertainty in quadrature.\n\nNow, we substitute the numerical values: $\\sigma_z = 0.0005$, $\\sigma_{D_L} = 10\\,\\mathrm{Mpc}$, and $\\sigma_v = 300\\,\\mathrm{km\\,s^{-1}}$.\nThe recession velocity estimate is $c\\hat{z} = (2.99792458 \\times 10^5\\,\\mathrm{km\\,s^{-1}}) \\times 0.0098 \\approx 2937.97\\,\\mathrm{km\\,s^{-1}}$.\nThe squared relative uncertainties are:\n$$\\left(\\frac{\\sigma_z}{\\hat{z}}\\right)^2 = \\left(\\frac{0.0005}{0.0098}\\right)^2 \\approx 0.002603$$\n$$\\left(\\frac{\\sigma_{D_L}}{\\hat{D}_L}\\right)^2 = \\left(\\frac{10}{40}\\right)^2 = 0.0625$$\n$$\\left(\\frac{\\sigma_v}{c\\hat{z}}\\right)^2 = \\left(\\frac{300\\,\\mathrm{km\\,s^{-1}}}{2937.97\\,\\mathrm{km\\,s^{-1}}}\\right)^2 \\approx 0.010427$$\n\nThe total squared relative uncertainty is the sum of these terms:\n$$\\left(\\frac{\\sigma_{H_0}}{\\hat{H}_0}\\right)^2 \\approx 0.002603 + 0.0625 + 0.010427 = 0.07553$$\nThe relative uncertainty is the square root:\n$$\\frac{\\sigma_{H_0}}{\\hat{H}_0} \\approx \\sqrt{0.07553} \\approx 0.2748$$\nFinally, the absolute uncertainty $\\sigma_{H_0}$ is:\n$$\\sigma_{H_0} = \\hat{H}_0 \\times \\left(\\frac{\\sigma_{H_0}}{\\hat{H}_0}\\right) \\approx (73.44915\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}) \\times 0.2748 \\approx 20.1867\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$$\nRounding to three significant figures, the uncertainty is $\\sigma_{H_0} \\approx 20.2\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$.\n\nThe point estimate and its $1\\sigma$ uncertainty, rounded to three significant figures, are $73.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ and $20.2\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, respectively.", "answer": "$$\n\\boxed{\\begin{pmatrix} 73.4  20.2 \\end{pmatrix}}\n$$", "id": "3473349"}, {"introduction": "The future of multi-messenger astronomy hinges on our ability to predict and optimize the scientific return from upcoming surveys. This computational exercise challenges you to build a synthetic survey forecast, integrating models for gravitational-wave detector sensitivity, binary neutron star merger rates, and kilonova brightness distributions [@problem_id:3473376]. By estimating detection rates as a function of the neutron star equation of state, you will explore the powerful connection between nuclear physics, gravitational-wave astronomy, and observational strategy.", "problem": "You are tasked with designing a synthetic survey forecast for binary neutron star mergers, linking gravitational-wave detections to electromagnetic kilonova detections. The gravitational-wave (GW) detector network is characterized by an effective sensitivity, and the kilonova light curves have model dispersion. Your program must estimate the expected annual detection rates of the blue and red kilonova components as functions of the neutron star Equation of State (EOS) stiffness, under the assumptions described below. The final output must be a single line containing a list of per-test-case detection rate pairs, with each pair in the order $[\\text{blue}, \\text{red}]$, rounded to three decimal places, expressed in events per year.\n\nAssume the following physically grounded model and definitions:\n- Gravitational Wave (GW) detector network operates with an orientation-averaged range $R_{\\mathrm{av}}$ in $\\mathrm{Mpc}$ defined by $R_{\\mathrm{av}} = K / \\rho_{\\mathrm{th}}$, where $K$ is a calibration constant in $\\mathrm{Mpc} \\cdot \\text{Signal-to-Noise Ratio (SNR)}$ and $\\rho_{\\mathrm{th}}$ is the network SNR threshold for detection.\n- Binary Neutron Star (BNS) mergers occur homogeneously in space with volumetric rate $R_{\\mathrm{vol}}$ expressed in $\\mathrm{Gpc}^{-3} \\, \\mathrm{yr}^{-1}$. Over one year, the expected number of GW detections is\n$$\nN_{\\mathrm{GW}} = \\frac{4\\pi}{3} \\left(\\frac{R_{\\mathrm{av}}}{10^3}\\right)^3 R_{\\mathrm{vol}} \\, \\zeta,\n$$\nwhere $\\zeta \\in [0,1]$ is the duty cycle of the network and $10^3$ converts $\\mathrm{Mpc}$ to $\\mathrm{Gpc}$.\n- Electromagnetic (EM) kilonova detection is governed by a magnitude limit $m_{\\mathrm{lim}}$ (AB magnitudes). The blue component and the red component have absolute magnitude distributions modeled as Gaussian with means that depend linearly on EOS stiffness $s$:\n$$\n\\mu_{\\mathrm{blue}}(s) = M_{b,0} - a_b s, \\quad \\mu_{\\mathrm{red}}(s) = M_{r,0} - a_r s,\n$$\nand standard deviations $\\sigma_{\\mathrm{blue}}$ and $\\sigma_{\\mathrm{red}}$, respectively. Here EOS (Equation of State) stiffness $s$ is a dimensionless parameter; larger $s$ implies stiffer EOS.\n- For an event at distance $d$ (in $\\mathrm{pc}$), the distance modulus is $\\mathrm{DM}(d) = 5 \\log_{10}(d/10)$. An event with absolute magnitude $M$ is detectable if its apparent magnitude $m = M + \\mathrm{DM}(d)$ satisfies $m \\le m_{\\mathrm{lim}}$. The maximum detectable distance for absolute magnitude $M$ is therefore\n$$\nd_{\\max}(M) = 10 \\times 10^{(m_{\\mathrm{lim}} - M)/5} \\,\\, \\mathrm{pc} = \\frac{10 \\times 10^{(m_{\\mathrm{lim}} - M)/5}}{10^6} \\,\\, \\mathrm{Mpc}.\n$$\n- Among GW-detected events (uniformly distributed within the sphere of radius $R_{\\mathrm{av}}$), the fraction that are detectable in EM for a given $M$ is the fraction of the GW detection volume within $d_{\\max}(M)$, namely\n$$\nF_d(M) = \\min\\left( \\left(\\frac{d_{\\max}(M)}{R_{\\mathrm{av}}}\\right)^3,\\, 1 \\right).\n$$\n- The expected EM detection fraction for a component (blue or red) is the average of $F_d(M)$ over the component’s absolute magnitude distribution. You must approximate this average by Monte Carlo sampling from the corresponding Gaussian distribution. Let $\\eta_{\\mathrm{blue}}$ and $\\eta_{\\mathrm{red}}$ be fixed observability efficiencies (dimensionless) encoding cadence and color-selection efficiency. Then the expected detection rates are\n$$\nN_{\\mathrm{blue}} = N_{\\mathrm{GW}} \\, \\eta_{\\mathrm{blue}} \\, \\mathbb{E}[F_d(M_{\\mathrm{blue}})], \\quad\nN_{\\mathrm{red}} = N_{\\mathrm{GW}} \\, \\eta_{\\mathrm{red}} \\, \\mathbb{E}[F_d(M_{\\mathrm{red}})],\n$$\nwith $\\mathbb{E}[\\cdot]$ denoting expectation over the respective Gaussian magnitude distribution.\n\nYour program must implement the above model and compute, for each provided test case, the pair $[N_{\\mathrm{blue}}, N_{\\mathrm{red}}]$ with both values rounded to three decimals, expressed in events per year. Use a fixed random seed for reproducibility and sufficiently many samples to ensure numerical stability.\n\nUse the following constants for the magnitude–EOS mapping:\n- $M_{b,0} = -15.4$, $a_b = 0.6$,\n- $M_{r,0} = -15.0$, $a_r = 0.3$.\n\nUse the following test suite of parameter sets. Each test case is a tuple in the order\n$(K,\\rho_{\\mathrm{th}},R_{\\mathrm{vol}},\\zeta,m_{\\mathrm{lim}},\\sigma_{\\mathrm{blue}},\\sigma_{\\mathrm{red}},s,\\eta_{\\mathrm{blue}},\\eta_{\\mathrm{red}})$:\n\n1. $(1000.0, 12.0, 500.0, 0.8, 22.0, 0.8, 0.6, 1.0, 0.7, 0.9)$ — happy path, moderate EOS stiffness and typical survey depth.\n2. $(1000.0, 12.0, 500.0, 0.8, 25.0, 0.8, 0.6, 1.0, 0.7, 0.9)$ — deeper survey limit increases EM detectability.\n3. $(1000.0, 12.0, 500.0, 0.8, 22.0, 0.8, 0.6, 1.4, 0.7, 0.9)$ — stiffer EOS should brighten both components.\n4. $(1000.0, 12.0, 500.0, 0.8, 20.5, 0.8, 0.6, 0.8, 0.7, 0.9)$ — shallow survey limit; tests near boundary of EM non-detection.\n5. $(1600.0, 10.0, 1000.0, 0.85, 26.0, 1.0, 0.7, 0.8, 0.7, 0.9)$ — improved network sensitivity and higher volumetric rate with deeper survey and larger dispersion.\n\nAngle units do not apply. All magnitude inputs are AB magnitudes. Express the final detection rates in events per year, rounded to three decimals.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list in the order $[\\text{blue}, \\text{red}]$. For example, an output with three test cases must look like: $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$.", "solution": "The solution proceeds by implementing the specified model in a step-by-step manner for each test case provided. The core of the task is to compute the expected annual detection rates for the blue and red components of a kilonova, denoted $N_{\\mathrm{blue}}$ and $N_{\\mathrm{red}}$, respectively. This requires several intermediate calculations, as detailed below.\n\nFirst, we determine the parameters of the gravitational-wave (GW) survey. The orientation-averaged range $R_{\\mathrm{av}}$ of the detector network is given by:\n$$\nR_{\\mathrm{av}} = \\frac{K}{\\rho_{\\mathrm{th}}}\n$$\nwhere $K$ is the calibration constant in units of $\\mathrm{Mpc} \\cdot \\mathrm{SNR}$ and $\\rho_{\\mathrm{th}}$ is the signal-to-noise ratio (SNR) detection threshold. This range defines the radius of a sphere within which GW events are assumed to be detectable.\n\nGiven $R_{\\mathrm{av}}$, the expected annual number of GW detections, $N_{\\mathrm{GW}}$, is calculated based on the volumetric rate of binary neutron star (BNS) mergers, $R_{\\mathrm{vol}}$, and the network's operational duty cycle, $\\zeta$. Assuming mergers are uniformly distributed throughout cosmic volume, the rate is the product of the observable volume and the merger rate density, adjusted for the duty cycle:\n$$\nN_{\\mathrm{GW}} = V_{\\mathrm{GW}} \\cdot R_{\\mathrm{vol}} \\cdot \\zeta = \\frac{4\\pi}{3} R_{\\mathrm{av, Gpc}}^3 \\, R_{\\mathrm{vol}} \\, \\zeta\n$$\nHere, the GW detection volume $V_{\\mathrm{GW}}$ has a radius $R_{\\mathrm{av}}$ expressed in Gigaparsecs ($\\mathrm{Gpc}$) to match the units of $R_{\\mathrm{vol}}$ ($\\mathrm{Gpc}^{-3} \\mathrm{yr}^{-1}$). Since $R_{\\mathrm{av}}$ is given in Megaparsecs ($\\mathrm{Mpc}$), and $1 \\mathrm{Gpc} = 1000 \\mathrm{Mpc}$, we use the conversion $R_{\\mathrm{av, Gpc}} = R_{\\mathrm{av}} / 10^3$. This leads to the formula specified in the problem:\n$$\nN_{\\mathrm{GW}} = \\frac{4\\pi}{3} \\left(\\frac{R_{\\mathrm{av}}}{10^3}\\right)^3 R_{\\mathrm{vol}} \\, \\zeta\n$$\n\nNext, we model the intrinsic brightness of the kilonovae. The absolute magnitudes of the blue and red components, $M_{\\mathrm{blue}}$ and $M_{\\mathrm{red}}$, are not single values but are drawn from Gaussian distributions. The means of these distributions, $\\mu_{\\mathrm{blue}}(s)$ and $\\mu_{\\mathrm{red}}(s)$, depend linearly on the neutron star Equation of State (EOS) stiffness parameter, $s$:\n$$\n\\mu_{\\mathrm{blue}}(s) = M_{b,0} - a_b s\n$$\n$$\n\\mu_{\\mathrm{red}}(s) = M_{r,0} - a_r s\n$$\nThe parameters $M_{b,0}$, $a_b$, $M_{r,0}$, and $a_r$ are given constants. A stiffer EOS (larger $s$) results in a brighter kilonova (more negative absolute magnitude). The distributions have specified standard deviations $\\sigma_{\\mathrm{blue}}$ and $\\sigma_{\\mathrm{red}}$.\n\nFor an electromagnetic (EM) survey with a limiting apparent magnitude $m_{\\mathrm{lim}}$, an event with absolute magnitude $M$ at a distance $d$ is detectable if $m \\le m_{\\mathrm{lim}}$. The apparent magnitude $m$ is related to the absolute magnitude $M$ and distance $d$ (in parsecs, $\\mathrm{pc}$) via the distance modulus, $\\mathrm{DM}(d) = 5 \\log_{10}(d/10)$:\n$$\nm = M + 5 \\log_{10}\\left(\\frac{d}{10 \\, \\mathrm{pc}}\\right)\n$$\nThe maximum distance $d_{\\max}(M)$ at which an event of absolute magnitude $M$ can be detected is found by setting $m = m_{\\mathrm{lim}}$:\n$$\nd_{\\max}(M) = 10 \\times 10^{(m_{\\mathrm{lim}} - M)/5} \\,\\, [\\mathrm{pc}]\n$$\nTo be consistent with $R_{\\mathrm{av}}$, we convert this distance to Mpc using $1 \\mathrm{Mpc} = 10^6 \\mathrm{pc}$:\n$$\nd_{\\max}(M) = \\frac{10 \\times 10^{(m_{\\mathrm{lim}} - M)/5}}{10^6} = 10^{\\frac{m_{\\mathrm{lim}} - M}{5} - 5} \\,\\, [\\mathrm{Mpc}]\n$$\n\nThe probability that a GW-detected event is also detected by the EM survey depends on its location. An event detected in GWs is assumed to be located at a random, uniformly distributed position within the sphere of radius $R_{\\mathrm{av}}$. The fraction of this volume that is also within the EM detection horizon $d_{\\max}(M)$ is the ratio of the corresponding volumes:\n$$\nF_d(M) = \\frac{V_{\\mathrm{EM}}}{V_{\\mathrm{GW}}} = \\frac{\\frac{4\\pi}{3} \\min(d_{\\max}(M), R_{\\mathrm{av}})^3}{\\frac{4\\pi}{3} R_{\\mathrm{av}}^3} = \\min\\left( \\left(\\frac{d_{\\max}(M)}{R_{\\mathrm{av}}}\\right)^3, 1 \\right)\n$$\nThe minimum function ensures this fraction does not exceed $1$, which occurs when the EM detection horizon extends beyond the GW detection horizon ($d_{\\max}(M) \\ge R_{\\mathrm{av}}$).\n\nSince the absolute magnitude $M$ is a random variable, the detection fraction $F_d(M)$ is also a random variable. The expected detection fraction for a given component (blue or red) is the expectation of $F_d(M)$ averaged over its magnitude distribution, i.e., $\\mathbb{E}[F_d(M)]$. This expectation is computed using Monte Carlo integration. A large number of magnitude samples, $M_i$, are drawn from the appropriate Gaussian distribution ($\\mathcal{N}(\\mu, \\sigma^2)$), and the expectation is approximated by the sample mean:\n$$\n\\mathbb{E}[F_d(M)] \\approx \\frac{1}{N_{\\mathrm{samples}}} \\sum_{i=1}^{N_{\\mathrm{samples}}} F_d(M_i)\n$$\n\nFinally, the total expected annual detection rate for each component is the product of the GW detection rate, the component's specific observability efficiency ($\\eta_{\\mathrm{blue}}$ or $\\eta_{\\mathrm{red}}$), and the expected EM detection fraction:\n$$\nN_{\\mathrm{blue}} = N_{\\mathrm{GW}} \\, \\eta_{\\mathrm{blue}} \\, \\mathbb{E}[F_d(M_{\\mathrm{blue}})]\n$$\n$$\nN_{\\mathrm{red}} = N_{\\mathrm{GW}} \\, \\eta_{\\mathrm{red}} \\, \\mathbb{E}[F_d(M_{\\mathrm{red}})]\n$$\nThese final rates are calculated for each test case, and the results for $N_{\\mathrm{blue}}$ and $N_{\\mathrm{red}}$ are rounded to three decimal places as required. For numerical stability and reproducibility, we use a fixed random seed and $10^6$ Monte Carlo samples.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expected annual detection rates of blue and red kilonova\n    components associated with binary neutron star mergers.\n    \"\"\"\n\n    # Define the constants for the magnitude-EOS mapping.\n    M_B0 = -15.4\n    A_B = 0.6\n    M_R0 = -15.0\n    A_R = 0.3\n\n    # Define the suite of test cases.\n    # Each case: (K, rho_th, R_vol, zeta, m_lim, sigma_blue, sigma_red, s, eta_blue, eta_red)\n    test_cases = [\n        (1000.0, 12.0, 500.0, 0.8, 22.0, 0.8, 0.6, 1.0, 0.7, 0.9),\n        (1000.0, 12.0, 500.0, 0.8, 25.0, 0.8, 0.6, 1.0, 0.7, 0.9),\n        (1000.0, 12.0, 500.0, 0.8, 22.0, 0.8, 0.6, 1.4, 0.7, 0.9),\n        (1000.0, 12.0, 500.0, 0.8, 20.5, 0.8, 0.6, 0.8, 0.7, 0.9),\n        (1600.0, 10.0, 1000.0, 0.85, 26.0, 1.0, 0.7, 0.8, 0.7, 0.9),\n    ]\n\n    # Set Monte Carlo parameters for stable and reproducible results.\n    N_SAMPLES = 10**6\n    np.random.seed(42)\n\n    results = []\n    \n    for case in test_cases:\n        K, rho_th, R_vol, zeta, m_lim, sigma_blue, sigma_red, s, eta_blue, eta_red = case\n\n        # Step 1: Calculate Gravitational Wave (GW) detection parameters.\n        # Orientation-averaged range in Mpc.\n        R_av = K / rho_th\n        # Expected annual number of GW detections.\n        N_GW = (4.0 * np.pi / 3.0) * ((R_av / 1000.0)**3) * R_vol * zeta\n\n        # Step 2: Calculate kilonova absolute magnitude distribution means.\n        mu_blue = M_B0 - A_B * s\n        mu_red = M_R0 - A_R * s\n        \n        # Step 3: Compute expected EM detection fraction via Monte Carlo for the blue component.\n        # Draw samples from the absolute magnitude distribution.\n        M_blue_samples = np.random.normal(loc=mu_blue, scale=sigma_blue, size=N_SAMPLES)\n        # Calculate maximum detectable distance in Mpc for each sample.\n        d_max_blue = 10.0**((m_lim - M_blue_samples) / 5.0 - 5.0)\n        # Calculate the detection fraction for each sample.\n        Fd_blue_samples = np.minimum((d_max_blue / R_av)**3, 1.0)\n        # Approximate the expectation by taking the mean.\n        E_Fd_blue = np.mean(Fd_blue_samples)\n\n        # Step 4: Repeat for the red component.\n        M_red_samples = np.random.normal(loc=mu_red, scale=sigma_red, size=N_SAMPLES)\n        d_max_red = 10.0**((m_lim - M_red_samples) / 5.0 - 5.0)\n        Fd_red_samples = np.minimum((d_max_red / R_av)**3, 1.0)\n        E_Fd_red = np.mean(Fd_red_samples)\n\n        # Step 5: Calculate the final detection rates in events per year.\n        N_blue = N_GW * eta_blue * E_Fd_blue\n        N_red = N_GW * eta_red * E_Fd_red\n\n        # Append the rounded results for the current test case.\n        results.append([round(N_blue, 3), round(N_red, 3)])\n\n    # Format the final output string as a list of lists.\n    # The str() of a list includes spaces, so we build the string manually.\n    formatted_results = f\"[{','.join(map(str, results))}]\"\n    print(formatted_results)\n\n# Execute the solver function.\nsolve()\n```", "id": "3473376"}]}