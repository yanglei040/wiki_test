{"hands_on_practices": [{"introduction": "Before we can explore the dynamics of boson star mergers, it is essential to understand the structure of an individual boson star. This exercise delves into the fundamental concept of mass in General Relativity as it applies to a self-gravitating scalar field. By calculating and comparing the Tolman mass, which arises from the star's internal energy and pressure, with the asymptotically defined ADM mass, you will gain a hands-on appreciation for how the scalar field's properties constitute the total gravitational mass of the object [@problem_id:3466680].", "problem": "Consider an isolated, spherically symmetric boson star sourced by a single complex scalar field in a static, asymptotically flat spacetime. Work in units where the speed of light is $c=1$ but keep Newton's constant $G$ explicit. Adopt the metric signature $(+,-,-,-)$ and the line element\n$$\nds^{2} = \\alpha(r)^{2}\\,dt^{2} - a(r)^{2}\\,dr^{2} - r^{2}\\,d\\Omega^{2},\n$$\nwhere $\\alpha(r)$ is the lapse function and $a(r)$ is the radial metric function. The complex scalar field has the standard harmonic ansatz\n$$\n\\phi(t,r) = \\Phi(r)\\,\\exp\\!\\left(- i \\omega t\\right),\n$$\nwith real amplitude $\\Phi(r)$ and real frequency $\\omega$. The matter Lagrangian density is\n$$\n\\mathcal{L} = g^{\\mu \\nu}\\,\\partial_{\\mu}\\phi^{\\ast}\\,\\partial_{\\nu}\\phi - V\\!\\left(|\\phi|^{2}\\right),\n$$\nwith a nonnegative potential $V$ that depends only on $|\\phi|^{2}$, and the total stress-energy tensor is\n$$\nT_{\\mu \\nu} = \\partial_{\\mu}\\phi^{\\ast}\\,\\partial_{\\nu}\\phi + \\partial_{\\nu}\\phi^{\\ast}\\,\\partial_{\\mu}\\phi - g_{\\mu \\nu}\\,\\mathcal{L}.\n$$\n\nDefine the Tolman mass\n$$\nM_{\\mathrm{T}} \\equiv \\int_{\\Sigma_{t}} \\left(T^{0}{}_{0} - T^{i}{}_{i}\\right)\\sqrt{-g}\\,d^{3}x,\n$$\nwhere $\\Sigma_{t}$ is a constant-$t$ slice, $g$ is the determinant of the spacetime metric, and the spatial index $i$ runs over $r,\\theta,\\varphi$. Define the Arnowitt–Deser–Misner (ADM) mass $M_{\\mathrm{ADM}}$ by the standard asymptotic charge at spatial infinity associated with asymptotic time translations.\n\nStarting from the Einstein field equations and the above definitions, do the following:\n- Compute explicitly the Tolman integrand $T^{0}{}_{0} - T^{i}{}_{i}$ for the complex scalar field in terms of $\\alpha(r)$, $a(r)$, $\\Phi(r)$, $\\omega$, and $V\\!\\left(\\Phi^{2}\\right)$, and simplify it as far as possible.\n- Using the static Killing symmetry, the Gauss law associated with the lapse function $\\alpha(r)$, and asymptotic flatness, relate the resulting volume integral to the ADM surface integral at infinity to deduce the equality or inequality between $M_{\\mathrm{T}}$ and $M_{\\mathrm{ADM}}$.\n- Emphasize in your derivation how the scalar field pressure contributions enter $T^{i}{}_{i}$ and affect the Tolman integrand, and identify any cancellations that occur among gradient terms.\n\nFinally, report the exact value of the difference $M_{\\mathrm{T}} - M_{\\mathrm{ADM}}$ as a single real number or a single closed-form analytic expression. No numerical approximation is required and no units should be included in the final reported value.", "solution": "The problem requires us to determine the relationship between the Tolman mass $M_{\\mathrm{T}}$ and the ADM mass $M_{\\mathrm{ADM}}$ for a static, spherically symmetric boson star. We will first validate the problem statement and then proceed with the derivation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Spacetime metric: $ds^{2} = \\alpha(r)^{2}\\,dt^{2} - a(r)^{2}\\,dr^{2} - r^{2}\\,d\\Omega^{2}$, with signature $(+,-,-,-)$.\n- Spacetime properties: Isolated, spherically symmetric, static, asymptotically flat.\n- Scalar field ansatz: $\\phi(t,r) = \\Phi(r)\\,\\exp(-i \\omega t)$, with $\\Phi(r)$ and $\\omega$ real.\n- Matter Lagrangian density: $\\mathcal{L} = g^{\\mu \\nu}\\,\\partial_{\\mu}\\phi^{\\ast}\\,\\partial_{\\nu}\\phi - V(|\\phi|^{2})$.\n- Stress-energy tensor: $T_{\\mu \\nu} = \\partial_{\\mu}\\phi^{\\ast}\\,\\partial_{\\nu}\\phi + \\partial_{\\nu}\\phi^{\\ast}\\,\\partial_{\\mu}\\phi - g_{\\mu \\nu}\\,\\mathcal{L}$.\n- Tolman mass definition: $M_{\\mathrm{T}} \\equiv \\int_{\\Sigma_{t}} (T^{0}{}_{0} - T^{i}{}_{i})\\sqrt{-g}\\,d^{3}x$.\n- ADM mass definition: $M_{\\mathrm{ADM}}$ is the standard asymptotic charge at spatial infinity.\n- Units: $c=1$, $G$ is explicit.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard topic in theoretical astrophysics and numerical relativity. It is well-posed, providing all necessary definitions (metric, field, Lagrangian, mass formalisms) to perform the required calculations and deductions. The language is objective and formal. The setup is self-contained and consistent. The problem is a non-trivial application of the definitions of mass in general relativity. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We will proceed with the solution.\n\n### Detailed Solution\n\n**1. Calculation of the Stress-Energy Tensor and Tolman Integrand**\n\nFirst, we compute the components of the stress-energy tensor $T_{\\mu\\nu}$ and the mixed tensor $T^\\mu{}_\\nu$. The spacetime metric is $g_{\\mu\\nu} = \\mathrm{diag}(\\alpha(r)^2, -a(r)^2, -r^2, -r^2\\sin^2\\theta)$. Its inverse is $g^{\\mu\\nu} = \\mathrm{diag}(\\alpha(r)^{-2}, -a(r)^{-2}, -r^{-2}, -r^{-2}\\sin^{-2}\\theta)$.\nThe scalar field is $\\phi = \\Phi(r)e^{-i\\omega t}$. Its non-zero derivatives are $\\partial_t \\phi = -i\\omega\\phi$ and $\\partial_r \\phi = \\Phi'(r)e^{-i\\omega t}$. Note that $|\\phi|^2 = \\Phi^2(r)$.\n\nThe Lagrangian density $\\mathcal{L}$ is:\n$$\n\\mathcal{L} = g^{tt}(\\partial_t\\phi^*)(\\partial_t\\phi) + g^{rr}(\\partial_r\\phi^*)(\\partial_r\\phi) - V(\\Phi^2) = \\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V(\\Phi^2)\n$$\n\nNow we compute the components of the stress-energy tensor $T_{\\mu\\nu} = (\\partial_\\mu\\phi^*)(\\partial_\\nu\\phi) + (\\partial_\\nu\\phi^*)(\\partial_\\mu\\phi) - g_{\\mu\\nu}\\mathcal{L}$:\n- $T_{tt} = 2|\\partial_t\\phi|^2 - g_{tt}\\mathcal{L} = 2\\omega^2\\Phi^2 - \\alpha^2\\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V\\right) = \\omega^2\\Phi^2 + \\frac{\\alpha^2(\\Phi')^2}{a^2} + \\alpha^2 V$.\n- $T_{rr} = 2|\\partial_r\\phi|^2 - g_{rr}\\mathcal{L} = 2(\\Phi')^2 + a^2\\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V\\right) = (\\Phi')^2 + \\frac{a^2\\omega^2\\Phi^2}{\\alpha^2} - a^2 V$.\n- $T_{\\theta\\theta} = -g_{\\theta\\theta}\\mathcal{L} = r^2\\mathcal{L} = r^2\\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V\\right)$.\n- $T_{\\varphi\\varphi} = -g_{\\varphi\\varphi}\\mathcal{L} = r^2\\sin^2\\theta \\mathcal{L} = T_{\\theta\\theta}\\sin^2\\theta$.\n- Off-diagonal components are zero.\n\nFrom these, we find the mixed-tensor components $T^\\mu{}_\\nu = g^{\\mu\\rho}T_{\\rho\\nu}$:\nThe energy density is $\\rho = T^0{}_0 = g^{00}T_{00} = \\alpha^{-2}T_{tt} = \\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{(\\Phi')^2}{a^2} + V(\\Phi^2)$.\nThe radial pressure is $P_r = -T^r{}_r = -g^{rr}T_{rr} = a^{-2}T_{rr} = \\frac{(\\Phi')^2}{a^2} + \\frac{\\omega^2\\Phi^2}{\\alpha^2} - V(\\Phi^2)$.\nThe tangential pressure is $P_\\perp = -T^\\theta{}_\\theta = -g^{\\theta\\theta}T_{\\theta\\theta} = r^{-2}T_{\\theta\\theta} = \\mathcal{L} = \\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V(\\Phi^2)$.\nNote that $T^\\varphi{}_\\varphi = T^\\theta{}_\\theta = -P_\\perp$.\n\nThe Tolman integrand is $T^{0}{}_{0} - T^{i}{}_{i} = T^0{}_0 - (T^r{}_r + T^\\theta{}_\\theta + T^\\varphi{}_\\varphi)$. Using the definitions of energy density and pressures, this is:\n$$\nT^{0}{}_{0} - T^{i}{}_{i} = \\rho - (-P_r - P_\\perp - P_\\perp) = \\rho + P_r + 2P_\\perp\n$$\nSubstituting the expressions for $\\rho$, $P_r$, and $P_\\perp$:\n$$\n\\rho + P_r + 2P_\\perp = \\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{(\\Phi')^2}{a^2} + V\\right) + \\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{(\\Phi')^2}{a^2} - V\\right) + 2\\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V\\right)\n$$\nWe group the terms to identify cancellations.\n- Gradient terms: $\\frac{(\\Phi')^2}{a^2} + \\frac{(\\Phi')^2}{a^2} - \\frac{2(\\Phi')^2}{a^2} = 0$.\n- Time-derivative kinetic terms: $\\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{2\\omega^2\\Phi^2}{\\alpha^2} = \\frac{4\\omega^2\\Phi^2}{\\alpha^2}$.\n- Potential terms: $V - V - 2V = -2V$.\n\nThe pressures $P_r$ and $P_\\perp$ are anisotropic, i.e., $P_r \\neq P_\\perp$. Their different dependence on the scalar field gradient $\\Phi'$ is crucial. The contribution from the scalar field gradient to the energy density ($\\rho$) and radial pressure ($P_r$) is cancelled by the corresponding contribution from the tangential pressure ($P_\\perp$) in the specific combination $\\rho + P_r + 2P_\\perp$. This cancellation is a key feature.\n\nThe simplified Tolman integrand is:\n$$\nT^{0}{}_{0} - T^{i}{}_{i} = \\frac{4\\omega^2\\Phi(r)^2}{\\alpha(r)^2} - 2V(\\Phi(r)^2)\n$$\n\n**2. Relation between Tolman Mass ($M_{\\mathrm{T}}$) and ADM Mass ($M_{\\mathrm{ADM}}$)**\n\nThe Tolman mass is defined by the volume integral:\n$$\nM_{\\mathrm{T}} = \\int_{\\Sigma_{t}} (T^{0}{}_{0} - T^{i}{}_{i})\\sqrt{-g}\\,d^{3}x\n$$\nwhere $\\Sigma_t$ is a slice of constant time $t$, and $d^3x = dr\\,d\\theta\\,d\\varphi$. The metric determinant is $g = -\\alpha^2 a^2 r^4 \\sin^2\\theta$, so $\\sqrt{-g} = \\alpha a r^2\\sin\\theta$. Integrating over the angular variables ($4\\pi$ steradians), we get:\n$$\nM_{\\mathrm{T}} = 4\\pi \\int_0^\\infty \\left( T^{0}{}_{0} - T^{i}{}_{i} \\right) \\alpha(r) a(r) r^2 dr = 4\\pi \\int_0^\\infty (\\rho + P_r + 2P_\\perp) \\alpha(r) a(r) r^2 dr\n$$\nThe problem asks to use the static Killing symmetry. This suggests relating $M_{\\mathrm{T}}$ to the Komar mass, $M_{\\mathrm{K}}$, which is intrinsically defined via the time-translation Killing vector field $\\xi^\\mu = (1,0,0,0)$. For a static spacetime, the Komar mass can be expressed as a volume integral over a spatial hypersurface $\\Sigma$:\n$$\nM_{\\mathrm{K}} = \\int_\\Sigma (2T_{\\mu\\nu} - g_{\\mu\\nu}T) n^\\mu \\xi^\\nu dV\n$$\nHere, $n^\\mu = \\alpha^{-1}\\xi^\\mu = (\\alpha^{-1}, 0, 0, 0)$ is the future-pointing unit normal to $\\Sigma$, $dV = \\sqrt{\\gamma}\\,d^3x = a r^2 \\sin\\theta dr d\\theta d\\varphi$ is the proper volume element on $\\Sigma$, and $T=T^\\lambda{}_\\lambda=\\rho - P_r - 2P_\\perp$ is the trace of the stress-energy tensor. The integrand becomes:\n$$\n(2T_{00} - g_{00}T)n^0 = (2\\alpha^2\\rho - \\alpha^2(\\rho-P_r-2P_\\perp))\\alpha^{-1} = \\alpha(\\rho+P_r+2P_\\perp)\n$$\nSubstituting this into the Komar integral and integrating over the angular part:\n$$\nM_{\\mathrm{K}} = 4\\pi \\int_0^\\infty \\alpha(\\rho+P_r+2P_\\perp) a r^2 dr\n$$\nComparing this with the expression for the Tolman mass, we see they are identical:\n$$\nM_{\\mathrm{T}} = M_{\\mathrm{K}}\n$$\nThis equality holds because the definition of the Tolman mass, when applied to a static spacetime, coincides with the volume-integral form of the Komar mass.\n\nThe final step is to relate this to the ADM mass. A fundamental theorem in general relativity states that for any stationary, asymptotically flat spacetime with a stress-energy tensor that falls off sufficiently fast at spatial infinity, the Komar mass is equal to the ADM mass.\nThe boson star is a localized object, meaning the scalar field $\\Phi(r)$ and its derivatives vanish exponentially at large $r$. This ensures that all components of $T_{\\mu\\nu}$ fall off rapidly, satisfying the conditions of the theorem. The \"Gauss law associated with the lapse function\" is a hint towards the proof of this theorem, which involves converting the Komar volume integral into a surface integral at infinity using the Einstein field equations and Stokes' theorem. This surface integral is precisely the one defining the ADM mass, which measures the total gravitational mass from the asymptotic behavior of the metric ($g_{tt} \\approx 1 - 2GM_{\\mathrm{ADM}}/r$).\n\nTherefore, for the static boson star configuration described, we have the chain of equalities:\n$$\nM_{\\mathrm{T}} = M_{\\mathrm{K}} = M_{\\mathrm{ADM}}\n$$\nThis implies that the Tolman mass is exactly equal to the ADM mass.\n\nThe difference $M_{\\mathrm{T}} - M_{\\mathrm{ADM}}$ is thus zero.", "answer": "$$\n\\boxed{0}\n$$", "id": "3466680"}, {"introduction": "One of the most critical questions in a compact object merger is the nature of the final remnant: does it form a stable object or collapse into a black hole? This practice introduces the apparent horizon, the quasi-local boundary that signals black hole formation within a dynamic spacetime. You will bridge formal theory with practical application by implementing a simplified algorithm to locate the apparent horizon, an essential tool for interpreting the outcomes of numerical relativity simulations [@problem_id:3466725].", "problem": "You are asked to formalize and operationalize the apparent horizon in the context of mergers of self-gravitating scalar solitons known as boson stars within the field of Numerical Relativity (NR). Using fundamental definitions from General Relativity (GR) and the standard $3+1$ decomposition, perform the following.\n\nDefine the apparent horizon as the outermost marginally outer trapped surface. Concretely, for a closed, spacelike, two-surface $\\mathcal{S}$ embedded in a spatial slice $\\Sigma_t$, let $\\ell^a$ and $n^a$ be the future-directed outgoing and ingoing null normals, respectively, normalized so that $\\ell^a n_a = -1$. The null expansions are $\\theta_{(\\ell)}$ and $\\theta_{(n)}$, defined as the fractional rates of change of the area element of $\\mathcal{S}$ along $\\ell^a$ and $n^a$. A marginally outer trapped surface (MOTS) satisfies $\\theta_{(\\ell)} = 0$ and an apparent horizon is the outermost MOTS. In the $3+1$ decomposition with spatial metric $\\gamma_{ij}$, extrinsic curvature $K_{ij}$, trace $K = \\gamma^{ij} K_{ij}$, and outward-pointing unit spatial normal $s^i$ to $\\mathcal{S}$, the expansions are given by\n\n$$\n\\theta_{\\pm} = \\pm D_i s^i + K_{ij} s^i s^j - K,\n$$\n\nwhere $D_i$ is the covariant derivative compatible with $\\gamma_{ij}$, $\\theta_{+} \\equiv \\theta_{(\\ell)}$, and $\\theta_{-} \\equiv \\theta_{(n)}$.\n\nDescribe a numerical algorithm to detect an apparent horizon during a boson star merger simulation. Your description must be based on the above definition and must be appropriate for dynamical spacetimes. The algorithm should be expressed in terms of finding a closed surface $\\mathcal{S}$ such that $\\theta_{+} = 0$ and should include a well-posed iterative method that can be implemented numerically. The method must be universally applicable in principle, but for the coding task below you will implement a spherically symmetric reduction.\n\nFor the coding task, implement the following simplified detection core under spherical symmetry, consistent with the theoretical definition. Consider spherically symmetric, conformally flat spatial slices with metric\n\n$$\n\\gamma_{ij} = \\psi(r)^4 \\delta_{ij},\n$$\n\nand assume time symmetry, so that $K_{ij} = 0$ and $K = 0$. For a coordinate sphere of radius $r$, the outward-pointing unit normal vector field is $s^i = \\psi(r)^{-2} \\delta^{ir}$. Show that in this setting the outgoing expansion reduces to\n\n$$\n\\theta_{+}(r) = D_i s^i = \\frac{4 \\,\\psi'(r)}{\\psi(r)^3} + \\frac{2}{\\psi(r)^2 \\, r},\n$$\n\nwhere $\\psi'(r) = \\frac{d\\psi}{dr}$. An apparent horizon, if present, is located at the largest positive root of $\\theta_{+}(r) = 0$.\n\nImplement a program that, for a given conformal factor $\\psi(r)$, searches for the outermost apparent horizon by:\n- Scanning $r \\in [r_{\\min}, r_{\\max}]$ with $r_{\\min}  0$ to avoid the coordinate singularity at $r = 0$.\n- Detecting sign changes in $\\theta_{+}(r)$ and refining each bracket by bisection to locate roots of $\\theta_{+}(r) = 0$.\n- Returning the largest root in the interval if any exist; if no root exists, return a sentinel value of $-1.0$.\n\nUse geometric units with $G = c = 1$. All radii are to be reported as coordinate radii $r$ in isotropic coordinates, expressed as dimensionless floats. The final program must compute results for the following test suite:\n\n- Test $1$ (happy path, black hole in isotropic coordinates): Schwarzschild initial data with mass $M = 1.0$, where $\\psi(r) = 1 + \\frac{M}{2r}$. The expected apparent horizon is at $r = \\frac{M}{2} = 0.5$.\n- Test $2$ (small black hole boundary): Schwarzschild initial data with mass $M = 0.2$, where $\\psi(r) = 1 + \\frac{M}{2r}$. The expected apparent horizon is at $r = \\frac{M}{2} = 0.1$.\n- Test $3$ (boson-star-like, no horizon): A smooth, compact, horizonless configuration approximated by $\\psi(r) = 1 + A \\exp\\!\\left(-\\frac{r^2}{R^2}\\right)$ with $A = 0.8$ and $R = 1.0$. This is a surrogate for a non-collapsed boson star profile; no apparent horizon should be found in the searched domain, and the algorithm must return $-1.0$.\n\nNumerical details to enforce:\n- Use $r_{\\min} = 10^{-6}$ and $r_{\\max} = 50.0$.\n- Use at least $N = 20000$ uniform samples to detect sign changes robustly.\n- Use bisection with a tolerance of $\\varepsilon = 10^{-12}$ in $r$.\n- If multiple roots are detected, select the largest $r$ root as the apparent horizon.\n- If no root is detected, return $-1.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the tests above. For example, if the three results are $x_1, x_2, x_3$, print exactly $[x_1,x_2,x_3]$. Express all numbers as plain decimal floats with standard Python formatting. Do not include any additional text or whitespace.", "solution": "The problem is assessed to be valid as it is scientifically grounded in General Relativity, well-posed, and provides a complete and consistent set of definitions and parameters for a solvable numerical task.\n\n### Theoretical Framework and Algorithm Description\n\nAn apparent horizon is a fundamental concept in numerical relativity, serving as a quasi-local boundary of a black hole on a given spatial slice of spacetime. It is defined as the outermost marginally outer trapped surface (MOTS). A MOTS is a closed, two-dimensional surface $\\mathcal{S}$ for which the expansion of the outgoing future-directed null geodesics perpendicular to it vanishes.\n\nFollowing the $3+1$ decomposition of spacetime, a spatial hypersurface $\\Sigma_t$ is described by its spatial metric $\\gamma_{ij}$ and extrinsic curvature $K_{ij}$. On this slice, we consider a closed two-surface $\\mathcal{S}$. The expansion $\\theta_{(\\ell)}$ of the outgoing null normal vector field $\\ell^a$ is given by:\n$$\n\\theta_{(\\ell)} \\equiv \\theta_{+} = D_i s^i + K_{ij} s^i s^j - K\n$$\nHere, $D_i$ is the covariant derivative associated with $\\gamma_{ij}$, $s^i$ is the outward-pointing unit normal to $\\mathcal{S}$ within $\\Sigma_t$, and $K = \\gamma^{ij}K_{ij}$ is the trace of the extrinsic curvature. An apparent horizon is a surface $\\mathcal{S}$ that satisfies the equation $\\theta_{+} = 0$ and is the outermost such surface.\n\nIn a general, non-symmetric spacetime, the location and shape of the surface $\\mathcal{S}$ are not known a priori. The surface can be described by a function $r(\\theta, \\phi)$ in a spherical-like coordinate system. The condition $\\theta_{+} = 0$ then becomes a non-linear, elliptic partial differential equation for the function $r(\\theta, \\phi)$.\n\nA general numerical algorithm to find such a surface, often called an \"apparent horizon finder,\" is typically iterative:\n1.  **Initial Guess**: Start with an initial guess for the surface, for instance, a coordinate sphere $r(\\theta, \\phi) = r_0$.\n2.  **Expansion Calculation**: Evaluate the expansion $\\theta_{+}$ at a discrete set of points on the current guess surface $\\mathcal{S}_k$.\n3.  **Surface Deformation**: Deform the surface in a direction that drives $\\theta_{+}$ towards zero. A simple relaxation scheme modifies the radius at each point $(\\theta, \\phi)$ according to the local value of the expansion:\n    $$\n    r_{k+1}(\\theta, \\phi) = r_k(\\theta, \\phi) + \\delta \\cdot \\mathcal{F}[\\theta_{+}(r_k, \\theta, \\phi)]\n    $$\n    where $\\delta$ is a small, positive step-size parameter and $\\mathcal{F}$ is some function, which could be as simple as the identity. The idea is that if $\\theta_{+}  0$ (outward-expanding), the surface is too small and should be expanded, while if $\\theta_{+}  0$ (outward-contracting), the surface is too large and should be shrunk.\n4.  **Iteration**: Repeat from step 2 until the magnitude of $\\theta_{+}$ is below a specified tolerance everywhere on the surface. More sophisticated finders use Newton-Raphson methods to solve the underlying PDE, providing faster convergence.\n\n### Derivation for the Spherically Symmetric, Time-Symmetric Case\n\nThe problem specifies a significant simplification for the coding task: a spherically symmetric, conformally flat, and time-symmetric spacetime.\nThe givens are:\n-   Spatial metric: $\\gamma_{ij} = \\psi(r)^4 \\delta_{ij}$. In spherical coordinates $(r, \\theta, \\phi)$, the line element is $ds^2 = \\psi(r)^4 (dr^2 + r^2 d\\theta^2 + r^2 \\sin^2\\theta d\\phi^2)$. The non-zero metric components are $\\gamma_{rr} = \\psi^4$, $\\gamma_{\\theta\\theta} = \\psi^4 r^2$, and $\\gamma_{\\phi\\phi} = \\psi^4 r^2 \\sin^2\\theta$.\n-   Time symmetry: $K_{ij} = 0$, which implies its trace $K=0$.\n\nUnder these conditions, the expansion equation simplifies to $\\theta_{+} = D_i s^i$. The surface $\\mathcal{S}$ is a sphere of constant coordinate radius $r$. The outward-pointing spatial normal vector $s^i$ is purely in the radial direction. In spherical coordinates, $s^i = (s^r, 0, 0)$. For $s^i$ to be a unit vector, its norm must be $1$:\n$$\ns_i s^i = \\gamma_{ij} s^i s^j = \\gamma_{rr} (s^r)^2 = \\psi(r)^4 (s^r)^2 = 1\n$$\nThis gives $s^r = \\psi(r)^{-2}$, assuming $s^r  0$.\n\nThe divergence of a vector field $s^i$ in a general coordinate system is given by $D_i s^i = \\frac{1}{\\sqrt{\\det(\\gamma)}} \\partial_j (\\sqrt{\\det(\\gamma)} s^j)$.\nThe determinant of the spatial metric is:\n$$\n\\det(\\gamma) = \\gamma_{rr} \\gamma_{\\theta\\theta} \\gamma_{\\phi\\phi} = (\\psi^4)(\\psi^4 r^2)(\\psi^4 r^2 \\sin^2\\theta) = \\psi^{12} r^4 \\sin^2\\theta\n$$\nSo, $\\sqrt{\\det(\\gamma)} = \\psi^6 r^2 \\sin\\theta$.\n\nSince $s^i$ only has a non-zero $r$-component, the divergence simplifies to:\n$$\nD_i s^i = \\frac{1}{\\psi^6 r^2 \\sin\\theta} \\partial_r (\\sqrt{\\det(\\gamma)} s^r)\n$$\nSubstituting the expressions for $\\sqrt{\\det(\\gamma)}$ and $s^r$:\n$$\nD_i s^i = \\frac{1}{\\psi^6 r^2 \\sin\\theta} \\frac{d}{dr} \\left( (\\psi^6 r^2 \\sin\\theta) \\cdot \\psi^{-2} \\right)\n$$\nThe term $\\sin\\theta$ is constant with respect to $r$ and can be cancelled.\n$$\nD_i s^i = \\frac{1}{\\psi^6 r^2} \\frac{d}{dr} \\left( \\psi^4 r^2 \\right)\n$$\nUsing the product rule for differentiation, with $\\psi'(r) = \\frac{d\\psi}{dr}$:\n$$\n\\frac{d}{dr} (\\psi^4 r^2) = \\left(\\frac{d}{dr} \\psi^4 \\right) r^2 + \\psi^4 \\left(\\frac{d}{dr} r^2 \\right) = (4\\psi^3 \\psi') r^2 + \\psi^4 (2r)\n$$\nSubstituting this back into the divergence expression:\n$$\nD_i s^i = \\frac{4\\psi^3 \\psi' r^2 + 2r\\psi^4}{\\psi^6 r^2} = \\frac{4\\psi^3 \\psi' r^2}{\\psi^6 r^2} + \\frac{2r\\psi^4}{\\psi^6 r^2}\n$$\nThis simplifies to the required formula for the outgoing null expansion:\n$$\n\\theta_{+}(r) = \\frac{4 \\,\\psi'(r)}{\\psi(r)^3} + \\frac{2}{\\psi(r)^2 \\, r}\n$$\nAn apparent horizon is found at a coordinate radius $r$ where $\\theta_{+}(r) = 0$. The problem asks for the outermost horizon, which corresponds to the largest positive root of this equation.\n\nThe numerical implementation will search for roots of this one-dimensional function. This involves first scanning a range of $r$ values to identify intervals where the sign of $\\theta_{+}(r)$ changes, indicating the presence of a root. Then, a root-finding algorithm like bisection is used within each such interval to find the root to high precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for apparent horizon radii for a suite of test cases.\n    \"\"\"\n    \n    # Numerical parameters\n    r_min = 1e-6\n    r_max = 50.0\n    N = 20000\n    tolerance = 1e-12\n    \n    # Test case definitions\n    test_cases = [\n        {\n            \"name\": \"Schwarzschild M=1.0\",\n            \"psi\": lambda r: 1.0 + 1.0 / (2.0 * r),\n            \"dpsi_dr\": lambda r: -1.0 / (2.0 * r**2)\n        },\n        {\n            \"name\": \"Schwarzschild M=0.2\",\n            \"psi\": lambda r: 1.0 + 0.2 / (2.0 * r),\n            \"dpsi_dr\": lambda r: -0.2 / (2.0 * r**2)\n        },\n        {\n            \"name\": \"Boson-star-like\",\n            \"psi\": lambda r: 1.0 + 0.8 * np.exp(-r**2 / 1.0**2),\n            \"dpsi_dr\": lambda r: 0.8 * np.exp(-r**2) * (-2.0 * r)\n        }\n    ]\n    \n    results = []\n\n    for case in test_cases:\n        psi_func = case[\"psi\"]\n        dpsi_dr_func = case[\"dpsi_dr\"]\n\n        def theta_plus(r):\n            \"\"\"\n            Calculates the outgoing null expansion theta_+ for a given radius r.\n            theta_+(r) = 4 * psi'(r)/psi(r)^3 + 2/(psi(r)^2 * r)\n            \"\"\"\n            if r == 0:\n                # Handle singularity at r=0, though scan range avoids this.\n                return np.inf\n            psi_val = psi_func(r)\n            dpsi_dr_val = dpsi_dr_func(r)\n            \n            # Defensive check for psi_val being zero, although not expected for these funcs.\n            if psi_val == 0:\n                return np.inf\n\n            term1 = 4.0 * dpsi_dr_val / (psi_val**3)\n            term2 = 2.0 / (psi_val**2 * r)\n            return term1 + term2\n\n        # Step 1: Scan for sign changes to find brackets for roots\n        r_scan = np.linspace(r_min, r_max, N)\n        theta_vals = np.array([theta_plus(r) for r in r_scan])\n        \n        brackets = []\n        for i in range(len(r_scan) - 1):\n            if theta_vals[i] * theta_vals[i+1]  0:\n                brackets.append((r_scan[i], r_scan[i+1]))\n\n        # Step 2: Use bisection to find roots within each bracket\n        roots = []\n        for a, b in brackets:\n            fa = theta_plus(a)\n            fb = theta_plus(b)\n\n            # Bisection algorithm\n            # Ensure f(a) and f(b) have opposite signs\n            if fa * fb = 0:\n                continue # Should not happen with valid brackets\n\n            while (b - a) / 2.0  tolerance:\n                c = (a + b) / 2.0\n                fc = theta_plus(c)\n                if fc == 0: # Exact root found\n                    break\n                if np.sign(fc) == np.sign(fa):\n                    a, fa = c, fc\n                else:\n                    b = c\n            \n            roots.append((a + b) / 2.0)\n        \n        # Step 3: Determine the result for the current case\n        if not roots:\n            results.append(-1.0)\n        else:\n            # The apparent horizon is the outermost (largest r) root\n            results.append(max(roots))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3466725"}, {"introduction": "The gravitational waves emitted from boson star mergers carry unique imprints of the scalar fields' internal dynamics, potentially distinguishing them from black hole or neutron star mergers. This hands-on modeling exercise allows you to predict the unique spectral features arising from the merger of an excited-state boson star. By translating physical phenomena like mode conversion and orbital coupling into a gravitational-wave spectrum, you will learn how theoretical properties of boson stars connect directly to observable signatures [@problem_id:3466788].", "problem": "You are asked to design a self-contained program that predicts distinctive spectral lines in the post-merger gravitational-wave strain spectrum $h(f)$ for mergers of boson stars when one of the stars initially occupies an excited radial state exhibiting a node in the scalar field $ \\phi $. The modeling must be based on first principles relevant to numerical relativity and gravitational waves and employ a minimal, physically justified approximation. Begin from the linearized limit of General Relativity (GR), in which metric perturbations are small and gravitational waves arise from the second time derivative of the mass quadrupole moment, and from the canonical stress-energy tensor for a minimally coupled complex scalar field. Your program must implement the following requirements.\n\n1. Fundamental base and modeling assumptions:\n   - Adopt Linearized General Relativity (LGR): gravitational radiation at large distances is dominated by the second time derivative of the mass quadrupole. Specifically, for distant observers, the leading-order strain depends on the second time derivative of the quadrupole moment, which for a binary system yields a dominant line at twice the orbital frequency.\n   - Represent the boson star scalar field as a superposition of a fundamental radial mode and one excited radial mode with a node. Let the scalar field be approximated as a real-valued effective field $ \\phi(t) $ whose time dependence is a sum of sinusoidal components with angular frequencies $ \\omega_0 $ (fundamental) and $ \\omega_e $ (excited). The stress-energy tensor $ T_{\\mu\\nu} $ is quadratic in $ \\phi $ and its derivatives, which implies the presence of frequency mixing through products yielding second harmonics and sum/difference frequencies.\n   - Let the binary orbital dynamics contribute a quadrupolar modulation at angular frequency $ \\Omega $. In the weak-field, slow-motion regime, the dominant gravitational-wave line is at frequency $ 2 \\Omega $ in cyclic frequency units, and mixing between the orbital quadrupole and scalar-field oscillations generates sidebands at combination frequencies.\n   - Model the projection of the scalar stress-energy onto the $\\ell=2$ (quadrupole) gravitational-wave channel via a dimensionless coefficient $ C_2 $ that encodes geometry-dependent coupling. The node in the excited radial mode reduces its effective $\\ell=2$ projection compared to the fundamental mode by a factor $ \\eta $ with $ 0  \\eta \\leq 1 $.\n   - Include a mode-conversion efficiency $ \\chi $ that regulates the strength of sum/difference frequency components associated with cross-terms between the fundamental and excited scalar modes, and an orbital–scalar sideband mixing coefficient $ \\beta $ that regulates sideband amplitudes generated by the product of the orbital quadrupole and scalar oscillations.\n\n2. Frequency content to be predicted:\n   - The dominant binary quadrupolar line at cyclic frequency corresponding to $ 2\\Omega $.\n   - Scalar quadratic lines corresponding to second harmonics and cross terms generated by the quadratic structure of $ T_{\\mu\\nu} $: components at angular frequencies $ 2\\omega_0 $, $ 2\\omega_e $, and $ \\omega_e \\pm \\omega_0 $.\n   - Sidebands from orbital–scalar mixing: components at angular frequencies $ 2\\Omega \\pm \\omega_0 $ and $ 2\\Omega \\pm \\omega_e $.\n   - Convert all angular frequencies to cyclic frequencies using $ f = \\omega/(2\\pi) $. All output frequencies must be expressed in Hertz (Hz) and rounded to three decimal places.\n\n3. Amplitude modeling and filtering:\n   - Assign relative, dimensionless amplitudes to candidate lines consistent with the above couplings:\n     - The dominant quadrupole line amplitude $ A_{\\mathrm{orb}} $ is provided as an input scalar.\n     - Fundamental scalar second harmonic amplitude scales with $ C_2 $ and the fundamental mode amplitude $ a_0 $ as $ A_{2\\omega_0} \\propto C_2 a_0^2 $.\n     - Excited scalar second harmonic amplitude scales as $ A_{2\\omega_e} \\propto C_2 \\eta a_e^2 $, where $ a_e $ is the excited mode amplitude and $ \\eta $ encodes the node suppression.\n     - Sum/difference cross terms scale as $ A_{\\mathrm{sum/diff}} \\propto C_2 \\chi a_0 a_e $.\n     - Orbital–scalar sidebands scale as $ A_{\\mathrm{sb},0} \\propto \\beta C_2 a_0 $ and $ A_{\\mathrm{sb},e} \\propto \\beta C_2 \\eta a_e $ for the fundamental and excited modes, respectively.\n   - Your program must apply an amplitude threshold $ A_{\\mathrm{th}} $ and a minimum frequency threshold $ f_{\\min} $ (both provided) to discard any spectral line with amplitude below $ A_{\\mathrm{th}} $ or frequency below $ f_{\\min} $.\n   - After filtering, deduplicate predicted lines by merging any frequencies within a tolerance $ \\delta f $ into a single representative value via sorting and greedy clustering.\n\n4. Output specification:\n   - Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a bracketed, comma-separated list of the predicted cyclic frequencies in Hz, rounded to three decimal places and sorted in ascending order. For example, $ [ [f_1,f_2], [g_1,g_2,g_3] ] $ without spaces.\n   - No user input is permitted. Use only the parameters supplied below.\n\n5. Units and angle specification:\n   - All angle-like quantities are angular frequencies in radians per second. All output cyclic frequencies must be in Hertz (Hz). Round each numerical frequency value to three decimal places.\n   - There are no angles measured in degrees; all angular quantities use radians.\n\n6. Test suite:\n   Implement your program for the following test cases, which cover a general scenario, a symmetry-limited case, and a near-resonant edge case. Each test case supplies parameters as described above.\n   - Test Case $ 1 $ (general excited-mode merger):\n     - $ \\omega_0 = 2\\pi \\times 8000 \\ \\mathrm{rad/s} $, $ \\omega_e = 2\\pi \\times 12000 \\ \\mathrm{rad/s} $, $ \\Omega = 2\\pi \\times 150 \\ \\mathrm{rad/s} $.\n     - Mode amplitudes: $ a_0 = 1.0 $, $ a_e = 0.7 $.\n     - Couplings: $ C_2 = 0.6 $, $ \\eta = 0.5 $, $ \\chi = 0.3 $, $ \\beta = 0.1 $.\n     - Orbital line amplitude: $ A_{\\mathrm{orb}} = 1.0 $.\n     - Thresholds: $ A_{\\mathrm{th}} = 0.05 $, $ f_{\\min} = 10.0 \\ \\mathrm{Hz} $, $ \\delta f = 0.5 \\ \\mathrm{Hz} $.\n   - Test Case $ 2 $ (suppressed scalar–quadrupole projection):\n     - $ \\omega_0 = 2\\pi \\times 8000 \\ \\mathrm{rad/s} $, $ \\omega_e = 2\\pi \\times 12000 \\ \\mathrm{rad/s} $, $ \\Omega = 2\\pi \\times 150 \\ \\mathrm{rad/s} $.\n     - Mode amplitudes: $ a_0 = 1.0 $, $ a_e = 0.7 $.\n     - Couplings: $ C_2 = 0.0 $, $ \\eta = 0.5 $, $ \\chi = 0.3 $, $ \\beta = 0.0 $.\n     - Orbital line amplitude: $ A_{\\mathrm{orb}} = 1.0 $.\n     - Thresholds: $ A_{\\mathrm{th}} = 0.05 $, $ f_{\\min} = 10.0 \\ \\mathrm{Hz} $, $ \\delta f = 0.5 \\ \\mathrm{Hz} $.\n   - Test Case $ 3 $ (near-resonant excited and fundamental modes):\n     - $ \\omega_0 = 2\\pi \\times 10000 \\ \\mathrm{rad/s} $, $ \\omega_e = 2\\pi \\times 10020 \\ \\mathrm{rad/s} $, $ \\Omega = 2\\pi \\times 80 \\ \\mathrm{rad/s} $.\n     - Mode amplitudes: $ a_0 = 0.9 $, $ a_e = 0.9 $.\n     - Couplings: $ C_2 = 0.5 $, $ \\eta = 0.5 $, $ \\chi = 0.4 $, $ \\beta = 0.05 $.\n     - Orbital line amplitude: $ A_{\\mathrm{orb}} = 0.5 $.\n     - Thresholds: $ A_{\\mathrm{th}} = 0.05 $, $ f_{\\min} = 50.0 \\ \\mathrm{Hz} $, $ \\delta f = 0.3 \\ \\mathrm{Hz} $.\n\nYour program must implement the above physically motivated selection and filtering to produce a single-line output aggregating the results for all test cases with the exact formatting described: a single bracketed list of bracketed, comma-separated sublists, with no spaces, and each numerical entry rounded to three decimals in Hz.", "solution": "The problem statement is assessed to be **valid**. It presents a well-defined computational task based on a simplified but physically-grounded model of gravitational wave emission from boson star mergers. The problem is self-contained, with all necessary parameters, constants, and procedural rules clearly specified.\n\n1.  **Scientific Grounding**: The model is based on established principles of physics. It uses the leading-order quadrupole formula from Linearized General Relativity ($GR$) for gravitational wave emission. The prediction of spectral lines at harmonics ($2\\omega_0, 2\\omega_e$), sum/difference frequencies ($\\omega_e \\pm \\omega_0$), and sidebands ($2\\Omega \\pm \\omega_0, 2\\Omega \\pm \\omega_e$) is a direct consequence of modeling gravitational radiation from a system with quadratic nonlinearities (the scalar field stress-energy tensor, $T_{\\mu\\nu}$) and mixing phenomena (orbital motion coupled with internal oscillations). These are standard concepts in perturbation theory and signal analysis in physics.\n\n2.  **Well-Posedness**: The problem is unambiguous. It provides concrete mathematical relationships for the frequencies and amplitudes of all relevant spectral lines. The filtering criteria ($A_{\\mathrm{th}}$, $f_{\\min}$) and the deduplication procedure (sorting followed by greedy clustering with tolerance $\\delta f$) are explicitly defined, ensuring that a unique, deterministic solution can be computed for each test case.\n\n3.  **Objectivity**: The problem is expressed in objective, quantitative language, free of subjective or vague statements. The use of dimensionless coupling coefficients ($C_2, \\eta, \\chi, \\beta$) is a standard and objective method for parameterizing complex physical interactions in a simplified model.\n\nThe problem does not violate any of the invalidity criteria. Therefore, a solution is warranted.\n\nThe solution is an algorithm that translates the provided physical model into a computational procedure. For each test case, this procedure unfolds in three stages: candidate generation, filtering, and deduplication.\n\n**Stage 1: Candidate Generation**\n\nFirst, the input angular frequencies ($\\omega_0, \\omega_e, \\Omega$), given in radians per second, are converted into cyclic frequencies ($f_0, f_e, F_{\\mathrm{orb}}$), in Hertz, using the fundamental relation $f = \\omega / (2\\pi)$.\n\nNext, a list of all potential spectral lines (frequency and amplitude pairs) is generated according to the model:\n\n-   **Orbital Quadrupole Line**: This is the primary gravitational wave signal from the binary's orbital motion.\n    -   Frequency: $f_{\\mathrm{orb}} = 2 F_{\\mathrm{orb}}$\n    -   Amplitude: $A_{\\mathrm{orb}}$ (provided directly)\n\n-   **Scalar Self-Interaction Lines**: These arise from the term quadratic in the scalar field $\\phi$ within the stress-energy tensor $T_{\\mu\\nu}$. This results in second harmonics and mixing terms.\n    -   Second harmonic of the fundamental mode: $f = 2f_0$, with amplitude $A_{2f_0} = C_2 a_0^2$.\n    -   Second harmonic of the excited mode: $f = 2f_e$, with amplitude $A_{2f_e} = C_2 \\eta a_e^2$. The factor $\\eta$ models the reduced quadrupole coupling of the excited state due to its radial node.\n    -   Sum/difference frequencies: $f = f_e \\pm f_0$, both with amplitude $A_{f_e \\pm f_0} = C_2 \\chi a_0 a_e$. The frequency is computed as $|f_e - f_0|$ to ensure it is positive.\n\n-   **Orbital-Scalar Sidebands**: These lines are produced by the nonlinear mixing of the orbital quadrupole oscillation with the internal oscillations of the scalar fields.\n    -   Sidebands of the fundamental mode: $f = 2 F_{\\mathrm{orb}} \\pm f_0$, with amplitude $A_{2F_{\\mathrm{orb}} \\pm f_0} = \\beta C_2 a_0$.\n    -   Sidebands of the excited mode: $f = 2 F_{\\mathrm{orb}} \\pm f_e$, with amplitude $A_{2F_{\\mathrm{orb}} \\pm f_e} = \\beta C_2 \\eta a_e$.\n    -   For all sideband difference frequencies, the absolute value is taken, e.g., $|2 F_{\\mathrm{orb}} - f_0|$, to ensure positivity.\n\n**Stage 2: Filtering**\n\nEach candidate line generated in Stage $1$ is evaluated against two thresholds:\n$1$. The line's amplitude must be greater than or equal to the amplitude threshold, $A \\geq A_{\\mathrm{th}}$.\n$2$. The line's frequency must be greater than or equal to the minimum frequency threshold, $f \\geq f_{\\min}$.\n\nAny candidate line that fails to meet both of these criteria is discarded.\n\n**Stage 3: Deduplication and Formatting**\n\nThe frequencies of all surviving spectral lines are collected into a list. This list is then processed to produce the final output for the test case:\n$1$. The list of frequencies is sorted in ascending numerical order.\n$2$. A greedy clustering algorithm is applied for deduplication. An empty list of final frequencies is initialized. The first frequency from the sorted list is added to the final list. Then, the algorithm iterates through the remaining sorted frequencies. A frequency is added to the final list only if its value exceeds the most recently added frequency by more than the tolerance $\\delta f$. This procedure ensures that frequencies lying within a $\\delta f$ band are represented by a single entry (the lowest frequency in that band).\n$3$. The frequencies in the final, deduplicated list are rounded to three decimal places as required.\n\nThis entire process is repeated for each of the three test cases. The resulting lists of frequencies are then formatted into the final, single-line string specified by the problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It processes each test case, collects the results, and prints them\n    in the specified final format.\n    \"\"\"\n    test_cases = [\n        # Test Case 1 (general excited-mode merger)\n        {\n            \"w0\": 2 * np.pi * 8000, \"we\": 2 * np.pi * 12000, \"W\": 2 * np.pi * 150,\n            \"a0\": 1.0, \"ae\": 0.7,\n            \"C2\": 0.6, \"eta\": 0.5, \"chi\": 0.3, \"beta\": 0.1,\n            \"A_orb\": 1.0,\n            \"A_th\": 0.05, \"f_min\": 10.0, \"df\": 0.5\n        },\n        # Test Case 2 (suppressed scalar-quadrupole projection)\n        {\n            \"w0\": 2 * np.pi * 8000, \"we\": 2 * np.pi * 12000, \"W\": 2 * np.pi * 150,\n            \"a0\": 1.0, \"ae\": 0.7,\n            \"C2\": 0.0, \"eta\": 0.5, \"chi\": 0.3, \"beta\": 0.0,\n            \"A_orb\": 1.0,\n            \"A_th\": 0.05, \"f_min\": 10.0, \"df\": 0.5\n        },\n        # Test Case 3 (near-resonant excited and fundamental modes)\n        {\n            \"w0\": 2 * np.pi * 10000, \"we\": 2 * np.pi * 10020, \"W\": 2 * np.pi * 80,\n            \"a0\": 0.9, \"ae\": 0.9,\n            \"C2\": 0.5, \"eta\": 0.5, \"chi\": 0.4, \"beta\": 0.05,\n            \"A_orb\": 0.5,\n            \"A_th\": 0.05, \"f_min\": 50.0, \"df\": 0.3\n        }\n    ]\n\n    results = [process_case(params) for params in test_cases]\n\n    # Format the final output string as specified: [[f1,f2],[g1],[h1,h2,...]]\n    # with no spaces and frequencies rounded to three decimal places.\n    formatted_results = []\n    for res_list in results:\n        str_freqs = [f\"{freq:.3f}\" for freq in res_list]\n        formatted_results.append(f\"[{','.join(str_freqs)}]\")\n    \n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\ndef process_case(params):\n    \"\"\"\n    Calculates the predicted spectral lines for a single test case based on\n    the provided physical model.\n    \n    Args:\n        params (dict): A dictionary containing all parameters for the test case.\n        \n    Returns:\n        list: A sorted and deduplicated list of predicted frequencies in Hz.\n    \"\"\"\n    # Unpack parameters from the dictionary for clarity\n    w0, we, W = params[\"w0\"], params[\"we\"], params[\"W\"]\n    a0, ae = params[\"a0\"], params[\"ae\"]\n    C2, eta, chi, beta = params[\"C2\"], params[\"eta\"], params[\"chi\"], params[\"beta\"]\n    A_orb = params[\"A_orb\"]\n    A_th, f_min, df = params[\"A_th\"], params[\"f_min\"], params[\"df\"]\n\n    # Convert angular frequencies (rad/s) to cyclic frequencies (Hz)\n    f0 = w0 / (2 * np.pi)\n    fe = we / (2 * np.pi)\n    F_orb = W / (2 * np.pi)\n\n    candidates = []\n\n    # 1. Orbital line from binary dynamics\n    candidates.append({'freq': 2 * F_orb, 'amp': A_orb})\n\n    # 2. Scalar quadratic lines (from T_munu being quadratic in phi)\n    if C2  0:\n        candidates.append({'freq': 2 * f0, 'amp': C2 * a0**2})\n        candidates.append({'freq': 2 * fe, 'amp': C2 * eta * ae**2})\n        \n        amp_sumdiff = C2 * chi * a0 * ae\n        candidates.append({'freq': fe + f0, 'amp': amp_sumdiff})\n        diff_freq = abs(fe - f0)\n        if diff_freq  1e-9: # Avoid adding a 0 Hz line\n            candidates.append({'freq': diff_freq, 'amp': amp_sumdiff})\n\n    # 3. Sidebands from orbital-scalar mixing\n    if beta  0 and C2  0:\n        amp_sb0 = beta * C2 * a0\n        candidates.append({'freq': 2 * F_orb + f0, 'amp': amp_sb0})\n        candidates.append({'freq': abs(2 * F_orb - f0), 'amp': amp_sb0})\n        \n        amp_sbe = beta * C2 * eta * ae\n        candidates.append({'freq': 2 * F_orb + fe, 'amp': amp_sbe})\n        candidates.append({'freq': abs(2 * F_orb - fe), 'amp': amp_sbe})\n\n    # Apply amplitude and frequency thresholds\n    filtered_freqs = [\n        cand['freq'] for cand in candidates \n        if cand['amp'] = A_th and cand['freq'] = f_min\n    ]\n\n    # Deduplicate frequencies using sorting and greedy clustering\n    if not filtered_freqs:\n        return []\n\n    filtered_freqs.sort()\n    \n    deduplicated_freqs = [filtered_freqs[0]]\n    for freq in filtered_freqs[1:]:\n        if freq - deduplicated_freqs[-1]  df:\n            deduplicated_freqs.append(freq)\n            \n    return deduplicated_freqs\n\nsolve()\n```", "id": "3466788"}]}