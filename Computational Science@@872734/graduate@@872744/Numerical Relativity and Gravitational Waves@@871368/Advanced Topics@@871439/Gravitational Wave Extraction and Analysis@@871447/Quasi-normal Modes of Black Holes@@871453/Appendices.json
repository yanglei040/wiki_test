{"hands_on_practices": [{"introduction": "The frequencies of quasi-normal modes are not arbitrary; they are intimately tied to the geometry of the black hole spacetime itself. In the high-frequency limit, we can understand the ringing of a black hole by studying the behavior of light rays trapped in unstable orbits. This exercise provides a foundational, \"pen-and-paper\" practice that connects the properties of the unstable photon sphere to the complex frequencies of quasi-normal modes through the powerful Wentzel–Kramers–Brillouin (WKB) approximation, offering deep insight into the physical origin of the QNM spectrum [@problem_id:3484637].", "problem": "Work in geometrized units where $G=c=1$. Consider the Schwarzschild spacetime with line element $ds^{2} = - f(r)\\,dt^{2} + f(r)^{-1}\\,dr^{2} + r^{2}\\,(d\\theta^{2} + \\sin^{2}\\theta\\, d\\phi^{2})$, where $f(r) = 1 - \\dfrac{2M}{r}$. Focus on equatorial ($\\theta=\\dfrac{\\pi}{2}$) null geodesics and the associated effective potential description for their radial motion. Using only fundamental properties of null geodesics in a static, spherically symmetric spacetime and the existence of the unstable circular photon orbit, do the following:\n\n1) Determine the radius $r_{c}$ of the unstable circular null geodesic (the photon sphere) by extremizing the null geodesic effective potential. \n\n2) Compute the coordinate angular frequency $\\Omega_{c} \\equiv \\dfrac{d\\phi}{dt}$ of the photon at $r=r_{c}$, as measured by an observer at infinity.\n\n3) Define the Lyapunov exponent $\\lambda_{c}$ for the unstable photon orbit with respect to coordinate time $t$ as the exponential growth rate of small radial perturbations $\\delta r(t)$ about the circular null geodesic, $\\delta r(t) \\propto \\exp(\\lambda_{c} t)$. Linearize the null radial geodesic equation about $r=r_{c}$ and convert from an affine parameter to coordinate time to obtain $\\lambda_{c}$ in terms of $f(r)$ and its derivatives evaluated at $r_{c}$.\n\n4) In the eikonal (large multipole) limit of black hole perturbations, the leading-order Wentzel–Kramers–Brillouin (WKB) correspondence relates the peak of the curvature potential to the properties of the unstable photon orbit. Exploit this correspondence to express the leading-order complex quasi-normal mode frequency $\\omega_{\\ell n}$ at large $\\ell$ and fixed overtone index $n \\in \\{0,1,2,\\dots\\}$ in terms of the photon sphere quantities $\\Omega_{c}$ and $\\lambda_{c}$, making clear any large-$\\ell$ approximations used.\n\nProvide your final answer as a single closed-form analytic expression for $\\omega_{\\ell n}$ in terms of $M$, $\\ell$, and $n$.", "solution": "The problem statement is a valid, well-posed problem in the field of general relativity and gravitational wave physics. It is scientifically grounded, self-contained, and uses precise, objective language. I will now proceed with a full solution.\n\nThe problem requires a four-part derivation concerning null geodesics and quasi-normal modes (QNMs) in the Schwarzschild spacetime, described by the line element in geometrized units ($G=c=1$):\n$$ds^{2} = - f(r)\\,dt^{2} + f(r)^{-1}\\,dr^{2} + r^{2}\\,(d\\theta^{2} + \\sin^{2}\\theta\\, d\\phi^{2})$$\nwith $f(r) = 1 - \\dfrac{2M}{r}$. We focus on equatorial orbits, so $\\theta = \\dfrac{\\pi}{2}$.\n\nThe motion of a particle is described by the geodesic equation, which can be derived from the Lagrangian $\\mathcal{L} = \\frac{1}{2} g_{\\mu\\nu} \\dot{x}^{\\mu} \\dot{x}^{\\nu}$, where the dot denotes differentiation with respect to an affine parameter $\\tau$. For null geodesics (photons), we have $\\mathcal{L}=0$.\n\nThe spacetime is static and spherically symmetric, yielding two conserved quantities corresponding to the Killing vectors $\\partial_t$ and $\\partial_\\phi$:\n1.  Conserved energy per unit mass/energy: $E = -\\frac{\\partial \\mathcal{L}}{\\partial \\dot{t}} = f(r)\\dot{t}$.\n2.  Conserved angular momentum per unit mass/energy: $L = \\frac{\\partial \\mathcal{L}}{\\partial \\dot{\\phi}} = r^2 \\sin^2\\theta \\dot{\\phi}$. For equatorial geodesics, $\\theta=\\frac{\\pi}{2}$, so $L=r^2\\dot{\\phi}$.\n\nThe null geodesic condition $g_{\\mu\\nu}\\dot{x}^{\\mu}\\dot{x}^{\\nu}=0$ becomes:\n$$-f(r)\\dot{t}^2 + f(r)^{-1}\\dot{r}^2 + r^2\\dot{\\phi}^2 = 0$$\nSubstituting $\\dot{t} = E/f(r)$ and $\\dot{\\phi} = L/r^2$:\n$$-\\frac{E^2}{f(r)} + \\frac{\\dot{r}^2}{f(r)} + \\frac{L^2}{r^2} = 0$$\nMultiplying by $f(r)$ and rearranging for $\\dot{r}^2$ gives the radial equation of motion:\n$$\\dot{r}^2 = E^2 - \\frac{L^2}{r^2}f(r)$$\nThis equation is analogous to that of a classical particle with total energy $E^2$ moving in an effective potential.\n\n**1) Radius of the Unstable Circular Null Geodesic ($r_c$)**\n\nThe radial motion can be described by the equation $\\dot{r}^2 + V_{\\text{eff}}(r) = E^2$, where the effective potential for null geodesics is:\n$$V_{\\text{eff}}(r) = \\frac{L^2}{r^2}f(r) = \\frac{L^2}{r^2}\\left(1 - \\frac{2M}{r}\\right) = \\frac{L^2}{r^2} - \\frac{2ML^2}{r^3}$$\nCircular orbits occur at radii $r_c$ where the radial velocity is zero ($\\dot{r}=0$) and the effective force is zero, meaning the potential is at an extremum: $\\dfrac{dV_{\\text{eff}}}{dr} = 0$.\n$$\\frac{d V_{\\text{eff}}}{dr} = L^2 \\left(-\\frac{2}{r^3} + \\frac{6M}{r^4}\\right) = 0$$\nFor $L \\neq 0$, this implies:\n$$-\\frac{2}{r_c^3} + \\frac{6M}{r_c^4} = 0 \\implies 2r_c = 6M \\implies r_c = 3M$$\nThis is the radius of the photon sphere. To check for stability, we examine the second derivative of the potential:\n$$\\frac{d^2 V_{\\text{eff}}}{dr^2} = L^2 \\left(\\frac{6}{r^4} - \\frac{24M}{r^5}\\right)$$\nEvaluating at $r_c = 3M$:\n$$\\left.\\frac{d^2 V_{\\text{eff}}}{dr^2}\\right|_{r_c=3M} = L^2 \\left(\\frac{6}{(3M)^4} - \\frac{24M}{(3M)^5}\\right) = L^2 \\left(\\frac{6}{81M^4} - \\frac{24M}{243M^5}\\right) = \\frac{L^2}{81M^4}\\left(6 - \\frac{24}{3}\\right) = -\\frac{2L^2}{81M^4}$$\nSince $\\dfrac{d^2 V_{\\text{eff}}}{dr^2} < 0$, the potential has a maximum at $r_c=3M$, confirming that this circular orbit is unstable.\n\n**2) Coordinate Angular Frequency ($\\Omega_c$)**\n\nThe coordinate angular frequency for a circular orbit at radius $r$ is given by $\\Omega \\equiv \\dfrac{d\\phi}{dt}$. Using the chain rule and the conserved quantities:\n$$\\Omega = \\frac{d\\phi/d\\tau}{dt/d\\tau} = \\frac{\\dot{\\phi}}{\\dot{t}} = \\frac{L/r^2}{E/f(r)} = \\frac{L f(r)}{E r^2}$$\nFor a circular orbit at $r_c$, the condition $\\dot{r}=0$ implies $E^2=V_{\\text{eff}}(r_c) = \\dfrac{L^2}{r_c^2}f(r_c)$, which gives the relation $\\dfrac{L^2}{E^2} = \\dfrac{r_c^2}{f(r_c)}$.\nThus, the angular frequency at the photon sphere is:\n$$\\Omega_c^2 = \\left(\\frac{L f(r_c)}{E r_c^2}\\right)^2 = \\frac{L^2}{E^2} \\frac{f(r_c)^2}{r_c^4} = \\left(\\frac{r_c^2}{f(r_c)}\\right) \\frac{f(r_c)^2}{r_c^4} = \\frac{f(r_c)}{r_c^2}$$\nTaking the positive root, $\\Omega_c = \\dfrac{\\sqrt{f(r_c)}}{r_c}$.\nSubstituting $r_c=3M$ and $f(r_c) = 1 - \\frac{2M}{3M} = \\frac{1}{3}$:\n$$\\Omega_c = \\frac{\\sqrt{1/3}}{3M} = \\frac{1}{3\\sqrt{3}M}$$\n\n**3) Lyapunov Exponent ($\\lambda_c$)**\n\nThe Lyapunov exponent characterizes the exponential growth of small perturbations. The equation for a radial perturbation $\\delta r(\\tau)$ about the circular orbit $r_c$ is obtained by linearizing the equation of motion $\\ddot{r} = -\\dfrac{1}{2}\\dfrac{d V_{\\text{eff}}}{dr}$.\nLet $r(\\tau) = r_c + \\delta r(\\tau)$. A Taylor expansion gives:\n$$\\ddot{\\delta r} = -\\frac{1}{2}\\left( \\left.\\frac{dV_{\\text{eff}}}{dr}\\right|_{r_c} + \\left.\\frac{d^2V_{\\text{eff}}}{dr^2}\\right|_{r_c} \\delta r + \\mathcal{O}(\\delta r^2) \\right)$$\nSince $\\left.\\frac{dV_{\\text{eff}}}{dr}\\right|_{r_c}=0$, the linearized equation is:\n$$\\ddot{\\delta r} - \\left(-\\frac{1}{2}\\left.\\frac{d^2V_{\\text{eff}}}{dr^2}\\right|_{r_c}\\right) \\delta r = 0$$\nThis is an exponential growth equation $\\ddot{\\delta r} - \\lambda_{c,\\tau}^2 \\delta r = 0$, where $\\lambda_{c,\\tau}$ is the Lyapunov exponent with respect to the affine parameter $\\tau$.\n$$\\lambda_{c,\\tau}^2 = -\\frac{1}{2}\\left.\\frac{d^2V_{\\text{eff}}}{dr^2}\\right|_{r_c} = -\\frac{1}{2}L^2 \\left(\\frac{6}{r_c^4} - \\frac{24M}{r_c^5}\\right)$$\nUsing $r_c=3M$, we found this to be $\\lambda_{c,\\tau}^2 = -\\frac{1}{2}\\left(-\\frac{2L^2}{81M^4}\\right) = \\frac{L^2}{81M^4}$, so $\\lambda_{c,\\tau} = \\frac{L}{9M^2}$.\n\nThe problem requires the exponent $\\lambda_c$ with respect to coordinate time $t$, defined by $\\delta r(t) \\propto \\exp(\\lambda_c t)$. For the circular orbit, $\\dot{t} = \\frac{dt}{d\\tau} = \\frac{E}{f(r_c)}$ is constant. Thus, $d\\tau = \\frac{f(r_c)}{E}dt$. The conversion is:\n$$\\lambda_c = \\lambda_{c,\\tau} \\frac{d\\tau}{dt} = \\lambda_{c,\\tau} \\frac{f(r_c)}{E}$$\nTo express this in terms of $f(r)$ and its derivatives, we first note from part 2 that $\\Omega_c^2=\\frac{f(r_c)}{r_c^2}$. The condition for the circular orbit, $r_c f'(r_c) - 2f(r_c) = 0$, gives $f'(r_c) = 2f(r_c)/r_c$. The second derivative of the potential is $V_{\\text{eff}}''(r_c) = \\frac{L^2}{r_c^4}(r_c^2 f''(r_c) - 4r_c f'(r_c) + 6f(r_c)) = \\frac{L^2}{r_c^4}(r_c^2 f''(r_c) - 8f(r_c) + 6f(r_c)) = \\frac{L^2}{r_c^4}(r_c^2 f''(r_c) - 2f(r_c))$.\nSo, $\\lambda_{c,\\tau}^2 = -\\frac{1}{2}V_{\\text{eff}}''(r_c) = \\frac{L^2}{2r_c^4}(2f(r_c) - r_c^2 f''(r_c))$.\n$$\\lambda_c^2 = \\lambda_{c,\\tau}^2 \\left(\\frac{f(r_c)}{E}\\right)^2 = \\frac{L^2}{E^2} \\frac{f(r_c)^2}{2r_c^4}(2f(r_c) - r_c^2 f''(r_c))$$\nUsing $\\frac{L^2}{E^2}=\\frac{r_c^2}{f(r_c)}$:\n$$\\lambda_c^2 = \\frac{r_c^2}{f(r_c)} \\frac{f(r_c)^2}{2r_c^4}(2f(r_c) - r_c^2 f''(r_c)) = \\frac{f(r_c)}{2r_c^2}(2f(r_c) - r_c^2 f''(r_c)) = \\frac{f(r_c)}{r_c^2}\\left(f(r_c) - \\frac{1}{2}r_c^2 f''(r_c)\\right)$$\nRecognizing $\\Omega_c^2 = f(r_c)/r_c^2$, we get $\\lambda_c^2 = \\Omega_c^2 \\left(f(r_c) - \\frac{1}{2}r_c^2 f''(r_c)\\right)$.\nFor Schwarzschild, $f(r)=1-2M/r$, $f'(r)=2M/r^2$, $f''(r)=-4M/r^3$. At $r_c=3M$:\n$f(r_c) = 1/3$, $f''(r_c) = -4M/(3M)^3 = -4/(27M^2)$.\n$$\\lambda_c^2 = \\Omega_c^2 \\left(\\frac{1}{3} - \\frac{1}{2}(3M)^2 \\left(-\\frac{4}{27M^2}\\right) \\right) = \\Omega_c^2 \\left(\\frac{1}{3} + \\frac{9M^2}{2} \\frac{4}{27M^2} \\right) = \\Omega_c^2 \\left(\\frac{1}{3} + \\frac{2}{3}\\right) = \\Omega_c^2$$\nThus, for a Schwarzschild black hole, $\\lambda_c = \\Omega_c = \\dfrac{1}{3\\sqrt{3}M}$.\n\n**4) Quasi-Normal Mode Frequency ($\\omega_{\\ell n}$) via WKB Correspondence**\n\nIn the eikonal (large multipole number $\\ell$) limit, the complex frequencies of quasi-normal modes are related to the properties of the unstable circular null geodesic orbit. This is the WKB correspondence. The real part of the QNM frequency, $\\omega_R$, corresponds to the orbital frequency of the photon, and the imaginary part, $\\omega_I$, corresponds to the instability (Lyapunov exponent) of the orbit.\nThe standard first-order WKB formula relates $\\omega_{\\ell n} = \\omega_R - i\\omega_I$ to the photon sphere properties as:\n$$\\omega_{\\ell n} = \\Omega_c \\left(\\ell + \\frac{1}{2}\\right) - i \\lambda_c \\left(n + \\frac{1}{2}\\right)$$\nHere, $\\ell \\in \\{2, 3, \\dots\\}$ is the angular momentum number, and $n \\in \\{0, 1, 2, \\dots\\}$ is the overtone number, which counts the number of nodes in the radial wavefunction. The term $\\ell + 1/2$ arises from the Langer modification for a centrifugal barrier in the WKB analysis. At large $\\ell$, one can approximate $\\ell+1/2 \\approx \\ell$, but the expression with $1/2$ is the more standard leading-order result.\n\nSubstituting the calculated values for $\\Omega_c$ and $\\lambda_c$ for the Schwarzschild black hole ($\\Omega_c = \\lambda_c = \\frac{1}{3\\sqrt{3}M}$):\n$$\\omega_{\\ell n} = \\frac{1}{3\\sqrt{3}M} \\left(\\ell + \\frac{1}{2}\\right) - i \\frac{1}{3\\sqrt{3}M} \\left(n + \\frac{1}{2}\\right)$$\nCombining these terms yields the final expression for the complex quasi-normal mode frequency in the large-$\\ell$ limit.\n$$\\omega_{\\ell n} = \\frac{1}{3\\sqrt{3}M} \\left[ \\left(\\ell + \\frac{1}{2}\\right) - i \\left(n + \\frac{1}{2}\\right) \\right]$$", "answer": "$$\\boxed{\\frac{1}{3\\sqrt{3}M} \\left( \\left(\\ell + \\frac{1}{2}\\right) - i\\left(n + \\frac{1}{2}\\right) \\right)}$$", "id": "3484637"}, {"introduction": "A complete gravitational wave signal from a ringing black hole is more than just a single damped sinusoid. It is a rich superposition of multiple quasi-normal modes, each with its own frequency, damping time, and amplitude, complemented by a non-oscillatory, power-law decay at very late times as predicted by Price's law. This computational practice guides you through constructing a complete, physically-motivated ringdown model and calibrating it to a target waveform using linear least squares [@problem_id:3484558]. This is a core task in gravitational wave astronomy, essential for extracting the physical parameters of newly formed black holes from observational data.", "problem": "Consider the late-time gravitational-wave ringdown from a perturbed, nonspinning (Schwarzschild) black hole. In black hole perturbation theory, linearized metric perturbations obey a one-dimensional wave equation with an effective potential, and the causal response to perturbations can be represented by a Green’s function. The Green’s function in the frequency domain has discrete poles associated with quasi-normal modes and a branch cut associated with backscattering off the long-range curvature, producing a damped signal with oscillatory components and a power-law tail. Price’s law predicts that the leading tail for the dominant quadrupolar gravitational perturbation decays as a power of time.  \n\nStarting from these bases:\n- the linear response of a black hole to perturbations is encoded in a Green’s function whose inverse Laplace transform picks up contributions from isolated poles and a branch cut,\n- the polar contributions correspond to quasi-normal modes with complex frequencies,\n- the branch cut near zero frequency produces the late-time tail predicted by Price’s law,\nderive a computational model of the ringdown signal for a Schwarzschild black hole that superposes a finite set of damped oscillatory modes with a power-law tail. Your model must be linear in the amplitudes of the modes and in the coefficient of the tail so that a least-squares calibration to a target waveform can be performed.\n\nLet $t$ denote physical time in seconds and let $M$ denote the black hole mass. The natural time unit is $t_M = GM/c^3$, so that dimensionless time is $u = t/t_M$. The dominant multipole has quasi-normal mode frequencies that are well-tested and can be taken as literature values for $\\ell=2$ and overtone indices $n=0,1,2$. The late-time tail exponent for gravitational quadrupolar perturbations is a positive integer $p$ set consistently with Price’s law. Assume the model basis is formed by the damped oscillatory functions $e^{-i \\omega_n u}$, where $\\omega_n$ are the dimensionless complex quasi-normal mode frequencies, and a real tail basis $u^{-p}$, each multiplied by unknown complex and real coefficients, respectively.\n\nYou will compare your calibrated model to three synthetic target ringdowns acting as stand-ins for Numerical Relativity (NR) surrogate ringdowns. Each synthetic target is constructed by a superposition of selected modes with specified complex amplitudes and phases, plus a power-law tail with specified amplitude. The angle unit for phases is radians. All signals must be constructed and compared in physical time $t$ (in seconds), with conversion to dimensionless time via $u = t/t_M$.\n\nFor each test case below, construct the target waveform on a uniform time grid $t \\in [t_{\\text{min}}, t_{\\text{max}}]$, with $t_{\\text{min}} = 10\\,t_M$ and $t_{\\text{max}} = 100\\,t_M$. Use $N=5000$ equally spaced time samples. Calibrate your linear model by least squares to the target waveform over this interval, solving for the complex mode amplitudes and the real tail coefficient. Then, compute the normalized $L^2$ mismatch between your calibrated model $h_{\\text{model}}(t)$ and the target $h_{\\text{NR}}(t)$:\n$$\n\\mathcal{E} \\equiv \\frac{\\left(\\int_{t_{\\min}}^{t_{\\max}} \\left|h_{\\text{NR}}(t) - h_{\\text{model}}(t)\\right|^2\\, dt\\right)^{1/2}}{\\left(\\int_{t_{\\min}}^{t_{\\max}} \\left|h_{\\text{NR}}(t)\\right|^2\\, dt\\right)^{1/2}}.\n$$\nExpress $\\mathcal{E}$ as a decimal float (unitless).\n\nUse the following test suite. In all cases, set the tail exponent to $p=7$. The quasi-normal mode frequencies are the dimensionless, literature values for a Schwarzschild black hole with $\\ell=2$, $n=0,1,2$, which your program may hard-code as well-tested constants. For each case, the target waveform is\n$$\nh_{\\text{NR}}(t) = \\sum_{n \\in \\mathcal{I}} A_n \\exp\\!\\left[-i \\omega_n \\frac{t}{t_M}\\right] + C \\left(\\frac{t}{t_M}\\right)^{-p},\n$$\nwhere $A_n$ are complex amplitudes constructed from magnitudes and phases, $C$ is a real tail amplitude, and $\\mathcal{I}$ is the set of active overtones.\n\n- Case 1 (general case with two modes and a nonzero tail): $M = 60\\,M_\\odot$, $\\mathcal{I} = \\{0,1\\}$, magnitudes $|A_0| = 2.0 \\times 10^{-21}$, $|A_1| = 0.7 \\times 10^{-21}$, phases $\\phi_0 = 0.0$ radians, $\\phi_1 = 0.3$ radians, so $A_n = |A_n| e^{i \\phi_n}$; tail amplitude $C = 0.12 \\times 10^{-21}$.\n- Case 2 (boundary case with only the fundamental mode and zero tail): $M = 60\\,M_\\odot$, $\\mathcal{I} = \\{0\\}$, magnitude $|A_0| = 2.0 \\times 10^{-21}$, phase $\\phi_0 = 0.1$ radians; tail amplitude $C = 0$.\n- Case 3 (edge case with three modes and a stronger tail at lower mass): $M = 30\\,M_\\odot$, $\\mathcal{I} = \\{0,1,2\\}$, magnitudes $|A_0| = 1.5 \\times 10^{-21}$, $|A_1| = 0.9 \\times 10^{-21}$, $|A_2| = 0.25 \\times 10^{-21}$, phases $\\phi_0 = 0.2$ radians, $\\phi_1 = -0.15$ radians, $\\phi_2 = 0.4$ radians; tail amplitude $C = 0.20 \\times 10^{-21}$.\n\nConstants $G$ and $c$ must be taken as the standard gravitational constant and speed of light, respectively. The solar mass is $M_\\odot = 1.98847\\times 10^{30}\\,\\text{kg}$, and the gravitational time unit is $t_M = GM/c^3$. All computations are performed in seconds. Angles must be in radians. No percentage signs are permitted; express all outputs as decimal floats.\n\nYour program should produce a single line of output containing the normalized $L^2$ mismatches for the three cases as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3]$).", "solution": "The problem requires the construction and calibration of a model for the gravitational-wave ringdown signal from a nonspinning black hole. The solution is founded on the principles of black hole perturbation theory and numerical linear algebra.\n\nThe physical model for the ringdown waveform, $h(t)$, is a superposition of damped sinusoidal oscillations, known as quasi-normal modes (QNMs), and a late-time power-law decay, as predicted by Price's law. The model to be calibrated, $h_{\\text{model}}(t)$, is a linear combination of these basis functions:\n$$\nh_{\\text{model}}(t) = \\sum_{n=0}^{2} A'_{n} \\exp\\left(-i \\omega_n u(t)\\right) + C' \\left(u(t)\\right)^{-p}\n$$\nHere, $t$ is physical time, $u(t) = t/t_M$ is dimensionless time scaled by the light-travel time of the black hole's gravitational radius ($t_M = GM/c^3$), and $p=7$ is the power-law exponent for quadrupolar gravitational radiation. The quantities $\\omega_n$ for $n=\\{0,1,2\\}$ are the well-established dimensionless complex frequencies of the first three ($\\ell=2$) QNM overtones of a Schwarzschild black hole. The coefficients $A'_n$ are complex amplitudes and $C'$ is a real amplitude, which are the parameters to be determined by calibration.\n\nThe calibration is performed by fitting $h_{\\text{model}}(t)$ to a given target waveform, $h_{\\text{NR}}(t)$, using the method of linear least squares. This method seeks to find the coefficients $\\{A'_0, A'_1, A'_2, C'\\}$ that minimize the $L^2$ norm of the residual, which, upon discretization over a time grid $t_k$ with $k=0, ..., N-1$, is equivalent to minimizing the sum of squared differences:\n$$\n\\chi^2 = \\sum_{k=0}^{N-1} \\left|h_{\\text{NR}}(t_k) - h_{\\text{model}}(t_k)\\right|^2\n$$\nThe challenge is that the coefficients $A'_n$ are complex while $C'$ is real. To employ standard real-valued least-squares algorithms, we must reformulate the problem. Let $A'_n = a_n + i b_n$, where $a_n$ and $b_n$ are real numbers. The model involves $3$ complex coefficients and $1$ real coefficient, making a total of $3 \\times 2 + 1 = 7$ unknown real parameters: $\\vec{x} = [a_0, b_0, a_1, b_1, a_2, b_2, C']^T$.\n\nBy decomposing the complex-valued functions into their real and imaginary parts, the single complex equation $h_{\\text{model}}(t_k) \\approx h_{\\text{NR}}(t_k)$ at each time sample $t_k$ is separated into two real equations. This expands the problem into a system of $2N$ linear equations for the $7$ unknown real coefficients. This system is expressed in matrix form as $M \\vec{x} \\approx \\vec{d}$, where:\n- $\\vec{d}$ is a vector of length $2N$ formed by stacking the real and imaginary parts of the target waveform $h_{\\text{NR}}(t_k)$.\n- $M$ is a $2N \\times 7$ design matrix whose columns are constructed from the real and imaginary parts of the basis functions evaluated at each time sample $t_k$. For instance, the columns corresponding to $a_n$ and $b_n$ are formed from $\\text{Re}[\\Psi_n(t_k)]$ and $\\text{Im}[\\Psi_n(t_k)]$, where $\\Psi_n(t) = \\exp(-i \\omega_n u(t))$. The column for $C'$ is formed from the real-valued tail basis function $\\Psi_{\\text{tail}}(t_k) = (u(t_k))^{-p}$.\n\nThis real-valued overdetermined system is solved for the coefficient vector $\\vec{x}$ that minimizes the Euclidean norm $\\|M\\vec{x} - \\vec{d}\\|_2$. This is a standard procedure accomplished using numerical linear algebra techniques such as Singular Value Decomposition (SVD), as implemented in `numpy.linalg.lstsq`.\n\nOnce the optimal coefficients are found, the calibrated model $h_{\\text{model}}(t)$ is fully determined. The fidelity of the model is assessed by computing the normalized $L^2$ mismatch, $\\mathcal{E}$:\n$$\n\\mathcal{E} = \\frac{\\|h_{\\text{NR}} - h_{\\text{model}}\\|_{L^2}}{\\|h_{\\text{NR}}\\|_{L^2}} = \\frac{\\left(\\sum_{k=0}^{N-1} |h_{\\text{NR}}(t_k) - h_{\\text{model}}(t_k)|^2 \\right)^{1/2}}{\\left(\\sum_{k=0}^{N-1} |h_{\\text{NR}}(t_k)|^2 \\right)^{1/2}}\n$$\nThis value quantifies the fractional error of the fit. Since each synthetic target waveform is constructed from a subset of the basis functions used in the model, an accurate implementation should recover the input amplitudes and yield a mismatch $\\mathcal{E}$ close to machine precision. The procedure is applied to each test case provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the black hole ringdown model calibration problem.\n\n    For each test case, it constructs a synthetic target waveform, builds a\n    linear model from QNM and power-law tail basis functions, and calibrates\n    the model to the target using linear least squares. Finally, it computes\n    the normalized L2 mismatch between the target and the calibrated model.\n    \"\"\"\n    # Physical constants\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    C_LIGHT = 299792458.0  # m/s\n    M_SOLAR = 1.98847e30  # kg\n\n    # Dimensionless QNM frequencies for Schwarzschild, l=2\n    # Source: Berti, Cardoso, Will (2009), arXiv:0905.2975 [gr-qc]\n    OMEGAS = {\n        0: 0.37367 - 0.08896j,\n        1: 0.34671 - 0.27391j,\n        2: 0.30105 - 0.47828j,\n    }\n    \n    # Model parameters\n    P_TAIL = 7\n    N_SAMPLES = 5000\n    N_MODES = 3  # n=0, 1, 2\n\n    test_cases = [\n        {\n            \"M_sol\": 60.0,\n            \"active_modes\": {\n                0: (2.0e-21, 0.0),   # (magnitude, phase)\n                1: (0.7e-21, 0.3),\n            },\n            \"C_tail\": 0.12e-21,\n        },\n        {\n            \"M_sol\": 60.0,\n            \"active_modes\": {\n                0: (2.0e-21, 0.1),\n            },\n            \"C_tail\": 0.0,\n        },\n        {\n            \"M_sol\": 30.0,\n            \"active_modes\": {\n                0: (1.5e-21, 0.2),\n                1: (0.9e-21, -0.15),\n                2: (0.25e-21, 0.4),\n            },\n            \"C_tail\": 0.20e-21,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Set up parameters and time grid\n        m_bh_kg = case[\"M_sol\"] * M_SOLAR\n        t_m = (G * m_bh_kg) / (C_LIGHT**3)\n        t_min, t_max = 10.0 * t_m, 100.0 * t_m\n        \n        t_grid = np.linspace(t_min, t_max, N_SAMPLES)\n        u_grid = t_grid / t_m\n\n        # 2. Construct the target waveform h_NR\n        h_nr = np.zeros(N_SAMPLES, dtype=np.complex128)\n        for n, (mag, phase) in case[\"active_modes\"].items():\n            amplitude = mag * np.exp(1j * phase)\n            h_nr += amplitude * np.exp(-1j * OMEGAS[n] * u_grid)\n        h_nr += case[\"C_tail\"] * (u_grid**(-P_TAIL))\n\n        # 3. Construct basis functions for the linear model\n        basis_qnm = {n: np.exp(-1j * OMEGAS[n] * u_grid) for n in range(N_MODES)}\n        basis_tail = u_grid**(-P_TAIL)\n\n        # 4. Construct the design matrix M and data vector d for Ax=b\n        # The model has 3 complex QNM coeffs and 1 real tail coeff (7 real parameters)\n        num_real_params = 2 * N_MODES + 1\n        M = np.zeros((2 * N_SAMPLES, num_real_params))\n        \n        for n in range(N_MODES):\n            # Real part of complex coefficient A'_n\n            M[:N_SAMPLES, 2*n] = np.real(basis_qnm[n])\n            M[N_SAMPLES:, 2*n] = np.imag(basis_qnm[n])\n            # Imaginary part of complex coefficient A'_n\n            M[:N_SAMPLES, 2*n+1] = -np.imag(basis_qnm[n])\n            M[N_SAMPLES:, 2*n+1] = np.real(basis_qnm[n])\n        \n        # Real tail coefficient C'\n        M[:N_SAMPLES, -1] = basis_tail\n\n        d = np.concatenate([np.real(h_nr), np.imag(h_nr)])\n        \n        # 5. Solve the linear least-squares problem\n        coeffs, _, _, _ = np.linalg.lstsq(M, d, rcond=None)\n\n        # 6. Reconstruct the model waveform from the fitted coefficients\n        h_model = np.zeros(N_SAMPLES, dtype=np.complex128)\n        for n in range(N_MODES):\n            a_n, b_n = coeffs[2*n], coeffs[2*n+1]\n            A_prime_n = a_n + 1j * b_n\n            h_model += A_prime_n * basis_qnm[n]\n        \n        C_prime = coeffs[-1]\n        h_model += C_prime * basis_tail\n\n        # 7. Compute the normalized L2 mismatch\n        residual_norm = np.linalg.norm(h_nr - h_model)\n        h_nr_norm = np.linalg.norm(h_nr)\n        \n        mismatch = 0.0\n        if h_nr_norm > 0:\n            mismatch = residual_norm / h_nr_norm\n        \n        results.append(mismatch)\n\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\nsolve()\n```", "id": "3484558"}, {"introduction": "Our most accurate predictions for gravitational waveforms come from large-scale numerical relativity simulations, which solve Einstein's equations on a discretized spacetime grid. However, this discretization introduces numerical errors that must be carefully controlled and removed to ensure the fidelity of the results. This hands-on coding exercise introduces the indispensable techniques of convergence analysis and Richardson extrapolation, using a simplified model to demonstrate how physicists quantify numerical error and obtain results that are more accurate than any single simulation [@problem_id:3484524]. Mastering this practice is crucial for distinguishing genuine physical effects from artifacts of the simulation itself.", "problem": "You will quantify and remove the bias that a time-domain numerical dissipation parameter $\\nu_{\\text{num}}$ introduces in the measured imaginary part of a quasi-normal mode frequency $\\Im(\\omega_{\\ell m n})$ of a black hole. Work in geometric units $G=c=1$ so that all frequencies are in units of $1/M$.\n\nStarting point and modeling assumptions:\n- In linear perturbation theory, the late-time gravitational wave ringdown of a single mode is well-approximated by a damped sinusoid whose amplitude decays as $e^{-\\Im(\\omega_{\\ell m n}) t}$, where $\\Im(\\omega_{\\ell m n})>0$ denotes the physical decay rate.\n- In finite-difference time-domain evolutions with explicit Kreiss–Oliger-type dissipation, a smooth mode acquires an additional artificial decay rate that scales with resolution. For a fixed mode with effective wavenumber and a smooth solution, the leading artificial contribution to the measured decay rate is proportional to $\\nu_{\\text{num}} h^{p}$, where $h$ is the grid spacing and $p$ is the leading convergence order of the dissipative term. Subleading truncation effects can be modeled by a higher power $h^{p+2}$.\n\nSynthetic measurement model (to be used to generate data):\n- Given true $\\Im(\\omega_{\\ell m n})= \\omega_I^{(\\text{true})}$, parameters $\\alpha>0$, $\\beta\\ge 0$, $p\\in\\mathbb{N}$, numerical dissipation $\\nu_{\\text{num}}\\ge 0$, and grid spacing $h>0$, the grid-and-dissipation dependent measured decay rate is modeled as\n$$\n\\omega_I(h,\\nu_{\\text{num}})= \\omega_I^{(\\text{true})} + \\alpha\\, \\nu_{\\text{num}}\\, h^{p} + \\beta\\, h^{p+2}.\n$$\n- Use three nested resolutions $h,h/2,h/4$ per test case.\n\nYour tasks for each test case:\n1. Using the model above, compute the three synthetic measurements $\\omega_I(h,\\nu_{\\text{num}}),\\omega_I(h/2,\\nu_{\\text{num}}),\\omega_I(h/4,\\nu_{\\text{num}})$.\n2. Using only these three synthetic measurements (and not $\\omega_I^{(\\text{true})}$ itself), perform a grid-convergence analysis to estimate the observed leading order $p_{\\text{obs}}$ from the data.\n3. Using $p_{\\text{obs}}$, perform Richardson extrapolation to estimate the continuum-limit decay rate $\\omega_I^{(0)}=\\lim_{h\\to 0}\\omega_I(h,\\nu_{\\text{num}})$, thereby removing the leading artificial damping contribution.\n4. Report $\\omega_I^{(0)}$ in units of $1/M$, rounded to six decimal places.\n\nTest suite:\n- Case A (happy path): $\\omega_I^{(\\text{true})}=0.088962$, $\\alpha=0.80$, $\\beta=0.15$, $p=4$, $\\nu_{\\text{num}}=0.10$, $h=0.20$.\n- Case B (strong dissipation): $\\omega_I^{(\\text{true})}=0.088962$, $\\alpha=1.20$, $\\beta=0.30$, $p=4$, $\\nu_{\\text{num}}=0.50$, $h=0.20$.\n- Case C (no dissipation, edge case): $\\omega_I^{(\\text{true})}=0.088962$, $\\alpha=1.00$, $\\beta=0.25$, $p=4$, $\\nu_{\\text{num}}=0.00$, $h=0.20$.\n- Case D (higher-order dissipation): $\\omega_I^{(\\text{true})}=0.088962$, $\\alpha=1.00$, $\\beta=0.10$, $p=6$, $\\nu_{\\text{num}}=0.12$, $h=0.20$.\n- Case E (different target mode): $\\omega_I^{(\\text{true})}=0.050000$, $\\alpha=0.90$, $\\beta=0.20$, $p=4$, $\\nu_{\\text{num}}=0.20$, $h=0.25$.\n\nAngle units do not apply in this problem. All frequencies must be expressed in units of $1/M$. The final answers must be floats rounded to six decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the Richardson-extrapolated values $\\omega_I^{(0)}$ for the five cases, in the order A, B, C, D, E, as a comma-separated list enclosed in square brackets, for example $[\\omega_{A},\\omega_{B},\\omega_{C},\\omega_{D},\\omega_{E}]$, where each entry is rounded to six decimal places.", "solution": "The problem requires the quantification and removal of numerical error from a measured physical quantity, specifically the imaginary part of a black hole quasi-normal mode frequency, $\\Im(\\omega_{\\ell m n})$. The procedure involves generating synthetic data based on a given error model, performing a grid-convergence analysis to determine the observed order of convergence, and then using Richardson extrapolation to estimate the continuum-limit value, $\\omega_I^{(0)}$. All calculations are performed in geometric units where $G=c=1$.\n\nThe foundation of this analysis is the provided model for the measured decay rate, $\\omega_I$, as a function of grid spacing $h$ and numerical dissipation parameter $\\nu_{\\text{num}}$:\n$$\n\\omega_I(h, \\nu_{\\text{num}}) = \\omega_I^{(\\text{true})} + \\alpha\\, \\nu_{\\text{num}}\\, h^{p} + \\beta\\, h^{p+2}\n$$\nHere, $\\omega_I^{(\\text{true})}$ is the exact physical value, the term proportional to $h^p$ represents the leading-order error from artificial dissipation, and the term proportional to $h^{p+2}$ models subleading truncation error effects. The parameters $\\alpha$, $\\beta$, $p$, and $\\nu_{\\text{num}}$ are given for each test case.\n\nThe solution process for each test case proceeds in three steps as specified.\n\n**1. Generation of Synthetic Measurements**\n\nFor each test case, we are given a coarse grid spacing $h$ and parameters $(\\omega_I^{(\\text{true})}, \\alpha, \\beta, p, \\nu_{\\text{num}})$. We compute three synthetic measurements at three nested resolutions: coarse ($h_1=h$), medium ($h_2=h/2$), and fine ($h_3=h/4$). Let these measurements be denoted $\\omega_{I,1}$, $\\omega_{I,2}$, and $\\omega_{I,3}$, respectively.\n\n$$\n\\omega_{I,1} = \\omega_I(h, \\nu_{\\text{num}}) = \\omega_I^{(\\text{true})} + \\alpha\\, \\nu_{\\text{num}}\\, h^{p} + \\beta\\, h^{p+2}\n$$\n$$\n\\omega_{I,2} = \\omega_I(h/2, \\nu_{\\text{num}}) = \\omega_I^{(\\text{true})} + \\alpha\\, \\nu_{\\text{num}}\\, (h/2)^{p} + \\beta\\, (h/2)^{p+2}\n$$\n$$\n\\omega_{I,3} = \\omega_I(h/4, \\nu_{\\text{num}}) = \\omega_I^{(\\text{true})} + \\alpha\\, \\nu_{\\text{num}}\\, (h/4)^{p} + \\beta\\, (h/4)^{p+2}\n$$\n\nThese three values simulate the results that would be obtained from three numerical simulations run at different resolutions.\n\n**2. Estimation of Observed Convergence Order, $p_{\\text{obs}}$**\n\nTo estimate the convergence order from the data, we analyze how the differences between measurements at successive resolutions scale. We define the differences:\n$$\nD_{12} = \\omega_{I,1} - \\omega_{I,2} = \\alpha\\, \\nu_{\\text{num}}\\, h^p(1 - 2^{-p}) + \\beta\\, h^{p+2}(1 - 2^{-(p+2)})\n$$\n$$\nD_{23} = \\omega_{I,2} - \\omega_{I,3} = \\alpha\\, \\nu_{\\text{num}}\\, (h/2)^p(1 - 2^{-p}) + \\beta\\, (h/2)^{p+2}(1 - 2^{-(p+2)})\n$$\nThe convergence factor, $Q$, is the ratio of these differences:\n$$\nQ = \\frac{D_{12}}{D_{23}}\n$$\nIf the leading-order error term (proportional to $h^p$) were the only source of error, this ratio would be exactly $2^p$. The presence of the higher-order term (proportional to $h^{p+2}$) \"pollutes\" this ratio, causing the *observed* convergence factor to differ slightly from $2^p$. The observed convergence order, $p_{\\text{obs}}$, is then calculated from this factor $Q$:\n$$\np_{\\text{obs}} = \\log_2(Q) = \\log_2\\left(\\frac{\\omega_{I,1} - \\omega_{I,2}}{\\omega_{I,2} - \\omega_{I,3}}\\right)\n$$\nIn the special case where the leading error term vanishes (e.g., if $\\nu_{\\text{num}}=0$), the error is dominated by the $h^{p+2}$ term, and $p_{\\text{obs}}$ will correctly measure the order $p+2$.\n\n**3. Richardson Extrapolation to the Continuum Limit**\n\nRichardson extrapolation is a method to construct a more accurate estimate of the continuum value by canceling the leading-order error term. Assuming the error in our measurements behaves as $\\omega_I(h) \\approx \\omega_I^{(0)} + C h^{p_{\\text{obs}}}$ for some constant $C$, we can write for our two most accurate measurements (medium and fine resolutions):\n$$\n\\omega_{I,2} \\approx \\omega_I^{(0)} + C (h/2)^{p_{\\text{obs}}}\n$$\n$$\n\\omega_{I,3} \\approx \\omega_I^{(0)} + C (h/4)^{p_{\\text{obs}}} = \\omega_I^{(0)} + C \\frac{(h/2)^{p_{\\text{obs}}}}{2^{p_{\\text{obs}}}}\n$$\nThis is a system of two linear equations for the two unknowns $\\omega_I^{(0)}$ and $C$. Solving for the extrapolated value $\\omega_I^{(0)}$ yields:\n$$\n\\omega_I^{(0)} = \\frac{2^{p_{\\text{obs}}} \\omega_{I,3} - \\omega_{I,2}}{2^{p_{\\text{obs}}} - 1}\n$$\nRecognizing that the previously calculated convergence factor is $Q = 2^{p_{\\text{obs}}}$, we can write the extrapolation formula more simply as:\n$$\n\\omega_I^{(0)} = \\frac{Q\\, \\omega_{I,3} - \\omega_{I,2}}{Q - 1}\n$$\nThis value $\\omega_I^{(0)}$ is the estimate for the continuum-limit decay rate, with the leading error term removed. The final step is to report this value rounded to six decimal places, formatted to show all six places. This procedure is applied systematically to each of the five test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_extrapolated_omega(w_true, alpha, beta, p, nu_num, h):\n    \"\"\"\n    Computes the Richardson-extrapolated continuum-limit decay rate.\n    \n    Args:\n        w_true (float): The true physical decay rate omega_I.\n        alpha (float): Scaling factor for the leading error term.\n        beta (float): Scaling factor for the subleading error term.\n        p (int): Convergence order of the leading dissipative term.\n        nu_num (float): Numerical dissipation parameter.\n        h (float): Coarse grid spacing.\n    \n    Returns:\n        float: The Richardson-extrapolated decay rate omega_I^(0).\n    \"\"\"\n\n    # 1. Generate synthetic measurements at three resolutions h, h/2, h/4\n    h_1 = h\n    h_2 = h / 2.0\n    h_3 = h / 4.0\n\n    def omega_I(grid_spacing):\n        \"\"\"The synthetic measurement model.\"\"\"\n        error_leading = alpha * nu_num * grid_spacing**p\n        error_subleading = beta * grid_spacing**(p + 2)\n        return w_true + error_leading + error_subleading\n\n    omega_I_1 = omega_I(h_1)  # Coarse\n    omega_I_2 = omega_I(h_2)  # Medium\n    omega_I_3 = omega_I(h_3)  # Fine\n\n    # 2. Estimate the observed convergence order p_obs\n    diff_12 = omega_I_1 - omega_I_2\n    diff_23 = omega_I_2 - omega_I_3\n    \n    # Handle the case where the error is already zero at the finest levels\n    if diff_23 == 0:\n        return omega_I_3\n        \n    convergence_factor_Q = diff_12 / diff_23\n    \n    # 3. Perform Richardson extrapolation using p_obs ( implicitly via Q )\n    # omega_0 = (2**p_obs * omega_I_3 - omega_I_2) / (2**p_obs - 1)\n    # Since Q = 2**p_obs, this simplifies to:\n    omega_I_0 = (convergence_factor_Q * omega_I_3 - omega_I_2) / (convergence_factor_Q - 1)\n    \n    return omega_I_0\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (w_true, alpha, beta, p, nu_num, h)\n    test_cases = [\n        # Case A (happy path)\n        (0.088962, 0.80, 0.15, 4, 0.10, 0.20),\n        # Case B (strong dissipation)\n        (0.088962, 1.20, 0.30, 4, 0.50, 0.20),\n        # Case C (no dissipation, edge case)\n        (0.088962, 1.00, 0.25, 4, 0.00, 0.20),\n        # Case D (higher-order dissipation)\n        (0.088962, 1.00, 0.10, 6, 0.12, 0.20),\n        # Case E (different target mode)\n        (0.050000, 0.90, 0.20, 4, 0.20, 0.25),\n    ]\n\n    results = []\n    for case in test_cases:\n        w_true, alpha, beta, p, nu_num, h = case\n        result = calculate_extrapolated_omega(w_true, alpha, beta, p, nu_num, h)\n        results.append(result)\n\n    # Format the results rounded to six decimal places for the final output string.\n    formatted_results = [f'{val:.6f}' for val in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3484524"}]}