{"hands_on_practices": [{"introduction": "Before tackling dynamic spacetimes, it is essential to verify that the Arnowitt-Deser-Misner (ADM) formalism correctly describes the simplest case: flat, empty spacetime. This exercise involves deriving the Hamiltonian and momentum constraint equations from first principles and then confirming that they are satisfied by the initial data for Minkowski spacetime. Completing this foundational check ensures a solid understanding of the constraints, which must be satisfied by any valid initial data set in general relativity. [@problem_id:3463150]", "problem": "Consider the Arnowitt-Deser-Misner (ADM) $3+1$ decomposition of general relativity, with a spacetime sliced into spatial hypersurfaces $\\Sigma_{t}$ characterized by lapse $ \\alpha $, shift $ \\beta^{i} $, induced spatial metric $ \\gamma_{ij} $, and extrinsic curvature $ K_{ij} $. In vacuum, the initial data $(\\gamma_{ij}, K_{ij})$ must satisfy constraints implied by the Einstein field equations $ G_{\\mu\\nu} = 8\\pi T_{\\mu\\nu} $ with $ T_{\\mu\\nu} = 0 $.\n\nStarting from the fundamental definitions of the $3+1$ split and the projections of the Einstein tensor along the unit normal $ n^{\\mu} $ to $\\Sigma_{t}$ and tangential directions on $\\Sigma_{t}$, use the Gauss–Codazzi relations to derive the vacuum Hamiltonian and momentum constraints in terms of the spatial Ricci scalar $ R $, the extrinsic curvature $ K_{ij} $, and the spatial covariant derivative $ D_{i} $ compatible with $ \\gamma_{ij} $. Then, evaluate these constraints for Minkowski initial data specified by $ \\alpha = 1 $, $ \\beta^{i} = 0 $, $ \\gamma_{ij} = \\delta_{ij} $, and $ K_{ij} = 0 $ on $ \\mathbb{R}^{3} $.\n\nProvide the final result as a single row matrix whose first entry is the Hamiltonian constraint and whose next three entries are the components of the momentum constraint. Express the final answer exactly, with no rounding and no units.", "solution": "The problem requires the derivation of the Arnowitt-Deser-Misner (ADM) constraint equations in vacuum from first principles, followed by an evaluation of these constraints for a specific set of initial data corresponding to Minkowski spacetime.\n\nThe validation of the problem statement is performed as a prerequisite.\n\n### Step 1: Extract Givens\n- **Framework**: ADM $3+1$ decomposition of spacetime into spatial hypersurfaces $\\Sigma_t$.\n- **Quantities**: Lapse function $\\alpha$, shift vector $\\beta^i$, spatial metric $\\gamma_{ij}$ on $\\Sigma_t$, and extrinsic curvature $K_{ij}$ of $\\Sigma_t$.\n- **Physical Context**: Vacuum spacetime, where the Einstein field equations are $G_{\\mu\\nu} = 0$.\n- **Initial Data**: A pair $(\\gamma_{ij}, K_{ij})$ on a given hypersurface, which must satisfy constraint equations.\n- **Derivation Task**: Use the definitions of the $3+1$ split, the projections of the Einstein tensor $G_{\\mu\\nu}$, and the Gauss–Codazzi relations to derive the Hamiltonian and momentum constraint equations.\n- **Evaluation Task**: Evaluate the derived constraints for Minkowski initial data: $\\alpha=1$, $\\beta^i=0$, $\\gamma_{ij}=\\delta_{ij}$, $K_{ij}=0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and scientifically sound.\n- **Scientifically Grounded**: The ADM formalism, the Einstein field equations, and the Gauss-Codazzi relations are foundational concepts in general relativity and numerical relativity. The problem constitutes a standard, fundamental derivation in the field.\n- **Well-Posed**: The derivation is a standard textbook exercise with a unique result. The evaluation is for a specific, well-defined case (Minkowski spacetime), which also yields a unique result.\n- **Objective**: The problem is stated in precise mathematical and physical language, free of ambiguity or subjective elements.\n- **Completeness**: All necessary definitions and starting points for the derivation are provided or implicitly defined by the context of standard general relativity. The data for the evaluation are complete.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. The solution will be provided as follows.\n\n### Derivation of the ADM Constraint Equations\n\nThe ADM constraints are obtained by projecting the Einstein field equations, $G_{\\mu\\nu} = 0$, onto directions normal and tangential to the spatial hypersurface $\\Sigma_t$. The unit normal vector to $\\Sigma_t$ is denoted by $n^\\mu$.\n\n**1. Hamiltonian Constraint**\n\nThe Hamiltonian constraint arises from the projection of the Einstein tensor fully normal to the hypersurface: $G_{\\mu\\nu}n^\\mu n^\\nu = 0$.\nThe Einstein tensor is defined as $G_{\\mu\\nu} = R_{\\mu\\nu} - \\frac{1}{2}g_{\\mu\\nu}R^{(4)}$, where $R_{\\mu\\nu}$ is the $4$-dimensional Ricci tensor and $R^{(4)}$ is the $4$-dimensional Ricci scalar. Projecting this equation using $n^\\mu$ and noting that for a unit normal vector $g_{\\mu\\nu}n^\\mu n^\\nu = -1$ (with signature $(-,+,+,+)$), we get:\n$$\nG_{\\mu\\nu}n^\\mu n^\\nu = R_{\\mu\\nu}n^\\mu n^\\nu - \\frac{1}{2}g_{\\mu\\nu}n^\\mu n^\\nu R^{(4)} = R_{\\mu\\nu}n^\\mu n^\\nu + \\frac{1}{2}R^{(4)}\n$$\nTo proceed, we invoke an identity that relates the $4$-dimensional and $3$-dimensional Ricci scalars, which is itself a consequence of the Gauss equation. The Gauss equation relates the Riemann tensor of the hypersurface, $R_{ijkl}$, to the projection of the $4$-dimensional Riemann tensor $R^{(4)}_{\\alpha\\beta\\gamma\\delta}$:\n$$\nR_{ijkl} = \\gamma_i^\\alpha \\gamma_j^\\beta \\gamma_k^\\gamma \\gamma_l^\\delta R^{(4)}_{\\alpha\\beta\\gamma\\delta} + K_{ik}K_{jl} - K_{il}K_{jk}\n$$\nwhere $\\gamma_i^\\alpha$ is the projector onto the hypersurface. Contracting this equation and relating it to various projections of the $4$-dimensional Ricci tensor yields the fundamental identity:\n$$\nR = R^{(4)} + 2 R_{\\mu\\nu}n^\\mu n^\\nu + K_{ij}K^{ij} - K^2\n$$\nwhere $R$ is the Ricci scalar of the spatial metric $\\gamma_{ij}$, $K_{ij}$ is the extrinsic curvature, and $K = \\gamma^{ij}K_{ij}$ is its trace.\nFrom this identity, we can express the term $R_{\\mu\\nu}n^\\mu n^\\nu$:\n$$\n2R_{\\mu\\nu}n^\\mu n^\\nu = R - R^{(4)} - K_{ij}K^{ij} + K^2\n$$\nSubstituting this into the expression for $2G_{\\mu\\nu}n^\\mu n^\\nu = 2R_{\\mu\\nu}n^\\mu n^\\nu + R^{(4)}$ gives:\n$$\n2G_{\\mu\\nu}n^\\mu n^\\nu = (R - R^{(4)} - K_{ij}K^{ij} + K^2) + R^{(4)} = R + K^2 - K_{ij}K^{ij}\n$$\nThe vacuum Einstein equation $G_{\\mu\\nu}=0$ implies $G_{\\mu\\nu}n^\\mu n^\\nu = 0$. Thus, we obtain the Hamiltonian constraint equation:\n$$\n\\mathcal{H} \\equiv R + K^2 - K_{ij}K^{ij} = 0\n$$\n\n**2. Momentum Constraint**\n\nThe momentum constraint arises from the mixed projection of the Einstein tensor, tangential and normal to the hypersurface: $G_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = 0$, where $\\gamma^{i\\mu}$ represents the basis vectors tangent to $\\Sigma_t$.\nAs $n^\\mu$ is orthogonal to any vector $\\gamma^{i\\mu}$ in the hypersurface, $g_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = 0$. The projection of the Einstein equation thus simplifies to:\n$$\nG_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = R_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = 0\n$$\nTo relate this to $3$-dimensional quantities, we use the Codazzi equation:\n$$\nD_j K_{ik} - D_k K_{ij} = R^{(4)}_{\\alpha\\beta\\gamma\\delta}n^\\alpha \\gamma_i^\\beta \\gamma_j^\\gamma \\gamma_k^\\delta\n$$\nwhere $D_i$ is the covariant derivative compatible with the spatial metric $\\gamma_{ij}$. Contracting this equation with $\\gamma^{jk}$ gives:\n$$\n\\gamma^{jk}(D_j K_{ik} - D_k K_{ij}) = \\gamma^{jk} R^{(4)}_{\\alpha\\beta\\gamma\\delta} n^\\alpha \\gamma_i^\\beta \\gamma_j^\\gamma \\gamma_k^\\delta = R^{(4)}_{\\alpha\\beta} n^\\alpha \\gamma_i^\\beta = R_{\\mu\\nu} n^\\mu \\gamma^{i\\nu}\n$$\nThe left-hand side can be simplified using the fact that $D_{j}$ is compatible with $\\gamma_{ij}$ (i.e., $D_j \\gamma^{ik}=0$):\n$$\n\\gamma^{jk}(D_j K_{ik} - D_k K_{ij}) = D_j(\\gamma^{jk}K_{ik}) - D_k(\\gamma^{jk}K_{ij})\n$$\nRecognizing that $K^{ji} = \\gamma^{jk}\\gamma^{il}K_{kl}$ and that $K_{ij}$ is symmetric:\n$$\nD_j K^{ji} - D_k K^{ki} = D_j K^{ij} - D_i K\n$$\nHere, we have relabeled the dummy index $k$ to $j$ in the first term, raised the index $i$, and used the definition of the trace $K = \\gamma^{ki}K_{ki}$ in the second term which becomes $D_i K$. Thus, the Codazzi relation implies:\n$$\nD_j K^{ij} - \\gamma^{ij} D_j K = R_{\\mu\\nu} n^\\mu \\gamma^{i\\nu}\n$$\nIntroducing the contravariant form $D^i = \\gamma^{ij}D_j$, the momentum constraint, $R_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = 0$, becomes:\n$$\n\\mathcal{M}^i \\equiv D_j K^{ij} - D^i K = 0\n$$\nThis is a set of three equations, one for each component $i \\in \\{1, 2, 3\\}$.\n\n### Evaluation for Minkowski Initial Data\n\nWe now evaluate the expressions for the Hamiltonian constraint, $\\mathcal{H} = R + K^2 - K_{ij}K^{ij}$, and the momentum constraint, $\\mathcal{M}^i = D_j K^{ij} - D^i K$, using the initial data for Minkowski spacetime in Cartesian coordinates:\n- Spatial metric: $\\gamma_{ij} = \\delta_{ij}$ (the Euclidean metric on $\\mathbb{R}^3$).\n- Extrinsic curvature: $K_{ij} = 0$.\n\n**1. Hamiltonian Constraint Evaluation**\nWe evaluate each term in $\\mathcal{H}$:\n- **Extrinsic Curvature Terms**: Since $K_{ij} = 0$, its trace is $K = \\gamma^{ij}K_{ij} = \\delta^{ij}(0) = 0$. The quadratic term is $K_{ij}K^{ij} = \\delta^{ik}\\delta^{jl}K_{ij}K_{kl} = \\delta^{ik}\\delta^{jl}(0)(0) = 0$. Therefore, $K^2 - K_{ij}K^{ij} = 0^2 - 0 = 0$.\n- **Spatial Curvature Term**: The Ricci scalar $R$ is calculated for the metric $\\gamma_{ij} = \\delta_{ij}$. The Christoffel symbols $\\Gamma^k_{ij}$ are given by $\\Gamma^k_{ij} = \\frac{1}{2}\\gamma^{kl}(\\partial_i\\gamma_{jl} + \\partial_j\\gamma_{il} - \\partial_l\\gamma_{ij})$. Since $\\delta_{ij}$ are constants, all their partial derivatives are zero, which implies $\\Gamma^k_{ij} = 0$. The Riemann curvature tensor components $R^i_{jkl}$ depend on derivatives of the Christoffel symbols, so $R^i_{jkl}=0$. Consequently, the Ricci tensor $R_{jk} = R^i_{jik} = 0$ and the Ricci scalar $R = \\gamma^{jk}R_{jk} = \\delta^{jk}(0) = 0$.\n\nSubstituting these results into the Hamiltonian constraint expression:\n$$\n\\mathcal{H} = R + K^2 - K_{ij}K^{ij} = 0 + 0 - 0 = 0\n$$\n\n**2. Momentum Constraint Evaluation**\nWe evaluate each term in $\\mathcal{M}^i$:\n- Since $K_{ij} = 0$, we also have $K^{ij} = \\gamma^{ik}\\gamma^{jl}K_{kl} = 0$ and $K = 0$.\n- The momentum constraint expression becomes $\\mathcal{M}^i = D_j (0) - D^i (0)$.\n- The covariant derivative of a zero tensor (or a constant scalar) is zero. Therefore, $D_j K^{ij} = 0$ and $D^i K = 0$.\n\nSubstituting these results into the momentum constraint expression for each component $i$:\n$$\n\\mathcal{M}^i = 0 - 0 = 0\n$$\n\nThe evaluation shows that for the given Minkowski initial data, the Hamiltonian constraint expression evaluates to $0$ and all three components of the momentum constraint expression evaluate to $0$. This confirms that flat spacetime is a valid vacuum solution of the Einstein equations, as expected. The result of the evaluation is a set of four numbers.", "answer": "$$ \\boxed{\\begin{pmatrix} 0 & 0 & 0 & 0 \\end{pmatrix}} $$", "id": "3463150"}, {"introduction": "The ADM evolution equations are a system of continuous partial differential equations, but to solve them in practice, we must translate them into a discrete form that a computer can handle. This exercise focuses on a key step in that process: deriving a finite-difference approximation for the second covariant derivative of the lapse function, $D_i D_j \\alpha$. By converting this differential operator into an algebraic stencil involving values at neighboring grid points, you will be taking a crucial step from analytical theory to numerical implementation. [@problem_id:3463131]", "problem": "In the Arnowitt–Deser–Misner (ADM) 3+1 decomposition of General Relativity, the extrinsic curvature evolution involves the spatial double covariant derivative of the lapse, denoted by $D_{i}D_{j}\\alpha$, where $D_{i}$ is the covariant derivative compatible with the spatial metric $\\gamma_{ij}$. Consider a uniform Cartesian coordinate grid with equal spacing $h$ in each coordinate direction $x^{1},x^{2},x^{3}$. Let $\\alpha(\\mathbf{x})$ be a smooth scalar field sampled at grid points $\\mathbf{x}_{\\mathbf{n}}=\\mathbf{x}_{0}+n_{1}h\\,\\mathbf{e}_{1}+n_{2}h\\,\\mathbf{e}_{2}+n_{3}h\\,\\mathbf{e}_{3}$, with integer multi-index $\\mathbf{n}=(n_{1},n_{2},n_{3})$ and unit coordinate basis vectors $\\mathbf{e}_{i}$. Assume the Christoffel symbols $\\Gamma^{k}{}_{ij}(\\mathbf{x})$ associated with $\\gamma_{ij}$ are known at each grid point and are treated as pointwise coefficients in the discretization.\n\nStarting from the fundamental definitions that (i) for a scalar $D_{i}\\alpha=\\partial_{i}\\alpha$ and $D_{i}D_{j}\\alpha=\\partial_{i}\\partial_{j}\\alpha-\\Gamma^{k}{}_{ij}\\partial_{k}\\alpha$, and (ii) Taylor’s theorem for smooth fields on a Cartesian grid, derive a second-order accurate centered finite-difference stencil on the uniform grid that approximates $D_{i}D_{j}\\alpha$ at $\\mathbf{x}_{\\mathbf{n}}$. Your stencil must be explicit in terms of $\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}}$, $\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}\\pm\\mathbf{e}_{j}}$, the grid spacing $h$, the Kronecker delta $\\delta_{ij}$, and the Christoffel symbols $\\Gamma^{k}{}_{ij}(\\mathbf{x}_{\\mathbf{n}})$. Then, compute the leading-order truncation error at $\\mathbf{x}_{\\mathbf{n}}$ in terms of $h$ and spatial derivatives of $\\alpha$ evaluated at $\\mathbf{x}_{\\mathbf{n}}$, clearly identifying the dependence on whether $i=j$ or $i\\neq j$.\n\nExpress your final answer as closed-form analytic expressions. Do not provide any numerical approximations, and do not include units. If you produce more than one final expression, present them as entries of a single row matrix using the $\\LaTeX$ $\\texttt{pmatrix}$ environment. Use the Einstein summation convention only over the repeated index $k$, with $i$ and $j$ fixed.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Framework**: Arnowitt–Deser–Misner (ADM) 3+1 decomposition of General Relativity.\n- **Object of Interest**: $D_{i}D_{j}\\alpha$, the spatial double covariant derivative of the lapse $\\alpha$. $D_i$ is the covariant derivative compatible with the spatial metric $\\gamma_{ij}$.\n- **Grid**: Uniform Cartesian coordinate grid with spacing $h$ in directions $x^1, x^2, x^3$.\n- **Field Sampling**: A smooth scalar field $\\alpha(\\mathbf{x})$ is sampled at grid points $\\mathbf{x}_{\\mathbf{n}}=\\mathbf{x}_{0}+n_{1}h\\,\\mathbf{e}_{1}+n_{2}h\\,\\mathbf{e}_{2}+n_{3}h\\,\\mathbf{e}_{3}$.\n- **Coefficients**: Christoffel symbols $\\Gamma^{k}{}_{ij}(\\mathbf{x})$ are known at each grid point.\n- **Definition (i)**: For a scalar $\\alpha$, $D_{i}\\alpha=\\partial_{i}\\alpha$.\n- **Definition (ii)**: The second covariant derivative is $D_{i}D_{j}\\alpha=\\partial_{i}\\partial_{j}\\alpha-\\Gamma^{k}{}_{ij}\\partial_{k}\\alpha$. The Einstein summation convention is used for the index $k$.\n- **Tool**: Taylor's theorem.\n- **Task 1**: Derive a second-order accurate centered finite-difference stencil for $D_{i}D_{j}\\alpha$ at $\\mathbf{x}_{\\mathbf{n}}$.\n- **Task 2**: Compute the leading-order truncation error at $\\mathbf{x}_{\\mathbf{n}}$.\n- **Output Requirements**: The stencil must be explicit in terms of $\\alpha$ at neighboring grid points (e.g., $\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}}$, $\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}\\pm\\mathbf{e}_{j}}$), $h$, $\\delta_{ij}$, and $\\Gamma^{k}{}_{ij}(\\mathbf{x}_{\\mathbf{n}})$. The truncation error analysis must distinguish between the cases $i=j$ and $i\\neq j$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is correctly situated within the ADM formalism of general relativity and uses standard definitions for the covariant derivative of a scalar field. The method of finite differences is a cornerstone of numerical solutions to partial differential equations in physics. The problem is scientifically and mathematically sound.\n- **Well-Posed**: The problem is well-posed. It requests the derivation of a standard numerical approximation and its error term, given a clear starting point and a set of constraints. All necessary information is provided. A unique, meaningful solution is expected.\n- **Objective**: The problem is stated in precise, objective, and technical language, free of any subjective or non-scientific content.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard, well-posed exercise in numerical methods applied to general relativity. A solution will be derived.\n\n### Derivation of the Solution\n\nThe objective is to find a second-order accurate finite-difference approximation for $D_{i}D_{j}\\alpha$ at a grid point $\\mathbf{x}_{\\mathbf{n}}$. The governing equation is given as:\n$$\nD_{i}D_{j}\\alpha = \\partial_{i}\\partial_{j}\\alpha - \\Gamma^{k}{}_{ij}\\partial_{k}\\alpha\n$$\nThis will be accomplished by deriving second-order accurate centered finite-difference stencils for the partial derivative terms $\\partial_{k}\\alpha$ and $\\partial_{i}\\partial_{j}\\alpha$. We denote $\\alpha(\\mathbf{x}_{\\mathbf{n}})$ as $\\alpha_{\\mathbf{n}}$, and $\\alpha(\\mathbf{x}_{\\mathbf{n}} \\pm h\\mathbf{e}_{i})$ as $\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}}$, etc. All derivatives of $\\alpha$ and the Christoffel symbols $\\Gamma^{k}{}_{ij}$ are evaluated at the point $\\mathbf{x}_{\\mathbf{n}}$ unless otherwise specified.\n\n**1. Finite Difference Approximation for the First Derivative $\\partial_{k}\\alpha$**\n\nUsing Taylor's theorem, we expand $\\alpha$ around $\\mathbf{x}_{\\mathbf{n}}$ along the $k$-th coordinate direction:\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_k} = \\alpha_{\\mathbf{n}} + h\\partial_k\\alpha + \\frac{h^2}{2!}\\partial_k^2\\alpha + \\frac{h^3}{3!}\\partial_k^3\\alpha + O(h^4)\n$$\n$$\n\\alpha_{\\mathbf{n}-\\mathbf{e}_k} = \\alpha_{\\mathbf{n}} - h\\partial_k\\alpha + \\frac{h^2}{2!}\\partial_k^2\\alpha - \\frac{h^3}{3!}\\partial_k^3\\alpha + O(h^4)\n$$\nSubtracting the second expansion from the first and solving for $\\partial_k\\alpha$ yields a centered difference formula:\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k} = 2h\\partial_k\\alpha + \\frac{h^3}{3}\\partial_k^3\\alpha + O(h^5)\n$$\n$$\n\\partial_k\\alpha = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k}}{2h} - \\frac{h^2}{6}\\partial_k^3\\alpha + O(h^4)\n$$\nThe second-order accurate stencil is thus:\n$$\n(FD[\\partial_{k}\\alpha])_{\\mathbf{n}} = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k}}{2h}\n$$\nThe leading-order truncation error for this approximation is $-\\frac{h^2}{6}\\partial_k^3\\alpha$.\n\n**2. Finite Difference Approximation for the Second Derivative $\\partial_{i}\\partial_{j}\\alpha$**\n\nWe must consider two separate cases: diagonal terms ($i=j$) and off-diagonal terms ($i \\neq j$).\n\n**Case A: Diagonal terms ($i=j$)**\n\nWe seek an approximation for $\\partial_i^2\\alpha$. Adding the Taylor expansions for $\\alpha_{\\mathbf{n}+\\mathbf{e}_i}$ and $\\alpha_{\\mathbf{n}}-\\mathbf{e}_i$:\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_i} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i} = 2\\alpha_{\\mathbf{n}} + h^2\\partial_i^2\\alpha + \\frac{h^4}{12}\\partial_i^4\\alpha + O(h^6)\n$$\nSolving for $\\partial_i^2\\alpha$:\n$$\n\\partial_i^2\\alpha = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i} - 2\\alpha_{\\mathbf{n}} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i}}{h^2} - \\frac{h^2}{12}\\partial_i^4\\alpha + O(h^4)\n$$\nThe second-order accurate stencil for the second unmixed partial derivative is:\n$$\n(FD[\\partial_{i}^{2}\\alpha])_{\\mathbf{n}} = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i} - 2\\alpha_{\\mathbf{n}} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i}}{h^2}\n$$\nThe leading-order truncation error is $-\\frac{h^2}{12}\\partial_i^4\\alpha$.\n\n**Case B: Off-diagonal terms ($i \\neq j$)**\n\nWe seek an approximation for the mixed partial derivative $\\partial_i\\partial_j\\alpha$. We use a 2D Taylor expansion involving points $\\mathbf{x}_{\\mathbf{n}} \\pm h\\mathbf{e}_i \\pm h\\mathbf{e}_j$:\n$$\n\\alpha(\\mathbf{x}_{\\mathbf{n}}+h_i\\mathbf{e}_i+h_j\\mathbf{e}_j) = \\sum_{p=0}^{\\infty} \\frac{1}{p!} (h_i\\partial_i + h_j\\partial_j)^p \\alpha\n$$\nSetting $h_i = sh$ and $h_j=th$ with $s,t\\in\\{-1,1\\}$, we form the combination:\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}\n$$\nExpanding in powers of $h$:\n- $O(1)$: $\\alpha_{\\mathbf{n}}-\\alpha_{\\mathbf{n}}-\\alpha_{\\mathbf{n}}+\\alpha_{\\mathbf{n}} = 0$.\n- $O(h)$: $h[(\\partial_i+\\partial_j) - (\\partial_i-\\partial_j) - (-\\partial_i+\\partial_j) + (-\\partial_i-\\partial_j)]\\alpha = 0$.\n- $O(h^2)$: $\\frac{h^2}{2}[(\\partial_i+\\partial_j)^2 - (\\partial_i-\\partial_j)^2 - (-\\partial_i+\\partial_j)^2 + (-\\partial_i-\\partial_j)^2]\\alpha = \\frac{h^2}{2}[8\\partial_i\\partial_j]\\alpha = 4h^2\\partial_i\\partial_j\\alpha$.\n- $O(h^3)$: All terms cancel due to symmetry.\n- $O(h^4)$: $\\frac{h^4}{24}[(\\partial_i+\\partial_j)^4 - (\\partial_i-\\partial_j)^4 - (-\\partial_i+\\partial_j)^4 + (-\\partial_i-\\partial_j)^4]\\alpha = \\frac{h^4}{24}[16(\\partial_i^3\\partial_j+\\partial_i\\partial_j^3)]\\alpha = \\frac{2h^4}{3}(\\partial_i^3\\partial_j + \\partial_i\\partial_j^3)\\alpha$.\nWe thus have:\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\dots + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j} = 4h^2\\partial_i\\partial_j\\alpha + \\frac{2h^4}{3}(\\partial_i^3\\partial_j + \\partial_i\\partial_j^3)\\alpha + O(h^6)\n$$\nSolving for $\\partial_i\\partial_j\\alpha$:\n$$\n\\partial_i\\partial_j\\alpha = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}}{4h^2} - \\frac{h^2}{6}(\\partial_i^3\\partial_j + \\partial_i\\partial_j^3)\\alpha + O(h^4)\n$$\nThe second-order accurate stencil for the mixed partial derivative is:\n$$\n(FD[\\partial_{i}\\partial_{j}\\alpha])_{\\mathbf{n}} = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}}{4h^2}\n$$\nThe leading-order truncation error is $-\\frac{h^2}{6}(\\partial_i^3\\partial_j + \\partial_i\\partial_j^3)\\alpha$.\n\n**3. Assembling the Full Stencil for $D_i D_j \\alpha$**\n\nWe combine the stencils using the Kronecker delta, $\\delta_{ij}$, to create a single expression valid for both $i=j$ and $i \\neq j$. The finite-difference approximation of $D_{i}D_{j}\\alpha$, denoted $(D_iD_j\\alpha)_{\\mathbf{n}}^{FD}$, is:\n$$\n(D_iD_j\\alpha)_{\\mathbf{n}}^{FD} = (FD[\\partial_i\\partial_j\\alpha])_{\\mathbf{n}} - \\Gamma^k{}_{ij}(\\mathbf{x}_{\\mathbf{n}}) (FD[\\partial_k\\alpha])_{\\mathbf{n}}\n$$\nSubstituting the derived stencils gives the final expression for the stencil:\n$$\n(D_iD_j\\alpha)_{\\mathbf{n}}^{FD} = \\delta_{ij} \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i} - 2\\alpha_{\\mathbf{n}} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i}}{h^2} + (1-\\delta_{ij}) \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}}{4h^2} - \\Gamma^k{}_{ij} \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k}}{2h}\n$$\nThis is the required second-order accurate centered finite-difference stencil. Summation is implicit over the repeated index $k$.\n\n**4. Derivation of the Leading-Order Truncation Error**\n\nThe truncation error $\\mathcal{T}_{ij}$ is the difference between the exact derivative and its finite-difference approximation, $\\mathcal{T}_{ij} = D_iD_j\\alpha - (D_iD_j\\alpha)_{\\mathbf{n}}^{FD}$. The leading-order term of this error is $O(h^2)$.\n$$\n\\mathcal{T}_{ij} = (\\partial_i\\partial_j\\alpha - (FD[\\partial_i\\partial_j\\alpha])_{\\mathbf{n}}) - \\Gamma^k{}_{ij} (\\partial_k\\alpha - (FD[\\partial_k\\alpha])_{\\mathbf{n}})\n$$\nWe substitute the leading-order error terms derived previously:\n$$\n\\mathcal{T}_{ij} \\approx (\\text{Error from } \\partial_i\\partial_j) - \\Gamma^k{}_{ij}(\\text{Error from } \\partial_k)\n$$\nFor $i=j$:\n$$\n\\mathcal{T}_{ii} \\approx \\left(-\\frac{h^2}{12}\\partial_i^4\\alpha\\right) - \\Gamma^k{}_{ii}\\left(-\\frac{h^2}{6}\\partial_k^3\\alpha\\right) = \\frac{h^2}{12}(2\\Gamma^k{}_{ii}\\partial_k^3\\alpha - \\partial_i^4\\alpha)\n$$\n(No summation over $i$, but summation over $k$ is implied).\n\nFor $i \\neq j$:\n$$\n\\mathcal{T}_{ij} \\approx \\left(-\\frac{h^2}{6}(\\partial_i^3\\partial_j\\alpha + \\partial_i\\partial_j^3\\alpha)\\right) - \\Gamma^k{}_{ij}\\left(-\\frac{h^2}{6}\\partial_k^3\\alpha\\right) = \\frac{h^2}{6}(\\Gamma^k{}_{ij}\\partial_k^3\\alpha - \\partial_i^3\\partial_j\\alpha - \\partial_i\\partial_j^3\\alpha)\n$$\n(Summation over $k$ is implied).\n\nThese two expressions give the leading-order truncation error, which is $O(h^2)$. We can combine them into a single expression for the final answer.\nThe final answers are the unified stencil and the unified leading-order truncation error expression. Let's denote the stencil by $(D_iD_j\\alpha)^{FD}_{\\mathbf{n}}$ and the leading-order truncation error by $\\mathcal{T}_{ij}$.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\delta_{ij} \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i} - 2\\alpha_{\\mathbf{n}} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i}}{h^2} + (1-\\delta_{ij}) \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}}{4h^2} - \\Gamma^k{}_{ij} \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k}}{2h} & \\delta_{ij}\\frac{h^2}{12}(2\\Gamma^k{}_{ii}\\partial_k^3\\alpha - \\partial_i^4\\alpha) + (1-\\delta_{ij})\\frac{h^2}{6}(\\Gamma^k{}_{ij}\\partial_k^3\\alpha - \\partial_i^3\\partial_j\\alpha - \\partial_i\\partial_j^3\\alpha) \\end{pmatrix} } $$", "id": "3463131"}, {"introduction": "A defining challenge in numerical relativity is the long-term stability of spacetime evolutions, and the original ADM formulation is known to have issues with growing constraint violations. This exercise demonstrates this crucial point through a simplified numerical simulation, comparing the growth of initial constraint errors in the standard ADM system versus the more robust Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formulation. This hands-on comparison reveals the practical impact of the system's mathematical properties and motivates the use of modern, more stable evolution formalisms. [@problem_id:3463146]", "problem": "Consider a one-dimensional plane-symmetric Einstein–Klein–Gordon system in the Arnowitt–Deser–Misner (ADM) 3+1 decomposition with identical gauge conditions to the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation. Use fixed slicing and shift, specifically unit lapse and zero shift, i.e., $\\alpha = 1$ and $\\beta^i = 0$. Work in geometric units where $G = c = 1$, so all quantities are dimensionless. The scalar field is a minimally coupled, massless field with canonical stress-energy. We focus on the propagation of constraint violations in simplified linearized models for ADM and BSSN under identical gauges.\n\nFundamental base:\n- The Einstein field equations $G_{ab} = 8\\pi T_{ab}$, with $T_{ab}$ the stress-energy tensor of a massless scalar field $\\phi$, and the 3+1 split yielding the ADM evolution equations and constraints.\n- The definitions of the Hamiltonian constraint $\\mathcal{H}$ and momentum constraint $\\mathcal{M}^i$ in ADM, and the qualitative differences in constraint propagation resulting from the BSSN variable redefinitions and additional hyperbolic coupling of constraints.\n- The scalar field obeys the Klein–Gordon equation in curved spacetime. In the weak-field, linearized regime around Minkowski spacetime with $\\alpha=1$, $\\beta^i=0$, the scalar field dynamics can be approximated by the one-dimensional wave equation.\n\nSetup and derivation goals:\n1. Define the 3+1 split and constraints. The spatial metric is $g_{ij}$, the extrinsic curvature is $K_{ij}$, the Hamiltonian constraint is $\\mathcal{H} \\equiv R + K^2 - K_{ij}K^{ij} - 16\\pi \\rho$, and the momentum constraint is $\\mathcal{M}^i \\equiv D_j(K^{ij} - g^{ij}K) - 8\\pi S^i$, where $R$ is the Ricci scalar of $g_{ij}$, $D_j$ is the covariant derivative associated with $g_{ij}$, $K \\equiv g^{ij}K_{ij}$, $\\rho$ is the energy density, and $S^i$ is the momentum density, both measured by the normal observer. In one spatial dimension with plane symmetry, only the $x$-component is nontrivial, and we denote $\\mathcal{M} \\equiv \\mathcal{M}^x$.\n2. Model the scalar field dynamics in the weak-field limit under the identical gauge $\\alpha=1$, $\\beta^i=0$. In this regime, neglecting backreaction to leading order, the scalar field evolution reduces to the one-dimensional wave equation $\\partial_t^2 \\phi = \\partial_x^2 \\phi$ with canonical conjugate momentum $\\pi \\equiv \\partial_t \\phi$.\n3. Construct initial data that represents an ingoing localized pulse. Let $\\phi(x,0) = A \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)$ and $\\pi(x,0) = -\\partial_x \\phi(x,0)$, so that the initial scalar field is predominantly right-moving.\n4. Using the scalar field initial data and the definitions of energy and momentum densities in the weak-field limit, initialize constraint violations at $t=0$ as $\\mathcal{H}(x,0) = 8\\pi \\rho(x,0)$ and $\\mathcal{M}(x,0) = 8\\pi S(x,0)$, where $\\rho(x,0) = \\frac{1}{2}\\left(\\pi(x,0)^2 + (\\partial_x \\phi(x,0))^2\\right)$ and $S(x,0) = \\pi(x,0)\\,\\partial_x \\phi(x,0)$.\n5. Derive simplified, linearized constraint-propagation models under identical gauges:\n   - For ADM, the linearized constraint propagation exhibits zero-speed modes. In a minimal numerical model that includes only artificial viscosity to represent grid-scale dissipation, take\n     $$\\partial_t \\mathcal{H} = \\nu\\,\\partial_x^2 \\mathcal{H},\\quad \\partial_t \\mathcal{M} = \\nu\\,\\partial_x^2 \\mathcal{M},$$\n     where $\\nu > 0$ is a small diffusion coefficient modeling numerical dissipation.\n   - For BSSN, the rearranged variables induce hyperbolic propagation of constraints. In a minimal linearized model with the same artificial viscosity, take\n     $$\\partial_t \\mathcal{H} = \\partial_x \\mathcal{M} + \\nu\\,\\partial_x^2 \\mathcal{H},\\quad \\partial_t \\mathcal{M} = \\partial_x \\mathcal{H} + \\nu\\,\\partial_x^2 \\mathcal{M}.$$\n   These models share the same gauge and dissipation but differ in whether the constraints have hyperbolic transport coupling.\n6. Numerically evolve the scalar field and constraints on a periodic domain $x \\in [0,L]$ with $L=1$. Use a uniform grid of $N$ points with spacing $\\Delta x = L/N$ and an explicit fourth-order Runge–Kutta method with time step $\\Delta t = \\lambda\\,\\Delta x$, where $0 < \\lambda \\leq 1$ is the Courant factor. Evolve to a final time $T=0.5$.\n7. For each formulation (ADM and BSSN), compute the normalized Hamiltonian constraint growth factor,\n   $$G_{\\mathcal{H}} \\equiv \\frac{\\|\\mathcal{H}(\\cdot,T)\\|_2}{\\|\\mathcal{H}(\\cdot,0)\\|_2},$$\n   where $\\|\\cdot\\|_2$ denotes the discrete $L^2$ norm defined as $\\|u\\|_2 = \\sqrt{\\Delta x \\sum_j u_j^2}$. Compare constraint growth via the ratio\n   $$R \\equiv \\frac{G_{\\mathcal{H}}^{\\text{ADM}}}{G_{\\mathcal{H}}^{\\text{BSSN}}}.$$\n   All quantities are dimensionless under the chosen units.\n\nAlgorithmic requirements:\n- Use second-order central finite differences for spatial derivatives $\\partial_x$ and $\\partial_x^2$ with periodic boundary conditions.\n- Use a single artificial viscosity coefficient $\\nu = 10^{-4}$ for all cases.\n- Evolve the scalar field system $\\partial_t \\phi = \\pi$, $\\partial_t \\pi = \\partial_x^2 \\phi$ and the constraints in parallel, though the constraint models depend only on their own fields.\n- Ensure numerical stability by using $\\Delta t = \\lambda\\,\\Delta x$ with $\\lambda \\leq 1$.\n\nTest suite:\nProvide the following four test cases, each specified as $(A,N,\\lambda)$ with $L=1$, $\\sigma = 0.05$, $x_0 = 0.3$, $T=0.5$, and $\\nu = 10^{-4}$:\n- Case 1 (happy path): $(A=10^{-2}, N=512, \\lambda=0.5)$.\n- Case 2 (near-Courant boundary): $(A=10^{-2}, N=256, \\lambda=0.9)$.\n- Case 3 (low amplitude): $(A=10^{-4}, N=512, \\lambda=0.5)$.\n- Case 4 (coarse grid): $(A=10^{-2}, N=128, \\lambda=0.6)$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). For each test case, output the scalar float $R$ defined above, rounded by default floating-point printing. No angles or physical units appear in the output since all quantities are dimensionless under the specified geometric units.", "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of numerical relativity, specifically the ADM and BSSN formulations of Einstein's equations. The problem is well-posed, providing a complete set of initial-boundary value problems with all necessary parameters and numerical specifications. The language is objective and the setup is formalizable into a computational task. There are no contradictions, ambiguities, or reliance on pseudoscience. The problem presents a simplified but conceptually sound model to investigate a key feature of modern numerical relativity formalisms—the behavior of constraint violations.\n\nHerein, a detailed solution is provided, following the algorithmic design specified.\n\n### 1. Initial State and Problem Setup\n\nThe problem is defined on a one-dimensional periodic domain $x \\in [0, L]$ with $L=1$. The fundamental variables are evolved on a uniform grid of $N$ points, denoted $x_j=j \\Delta x$ for $j=0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = L/N$.\n\nThe initial state of the system is determined by a massless scalar field $\\phi$. The initial profile for $\\phi$ is a Gaussian pulse:\n$$\n\\phi(x,0) = A \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\n$$\nThe problem specifies that the initial data should represent a predominantly right-moving pulse. This is achieved by setting the initial time derivative of the scalar field, its conjugate momentum $\\pi \\equiv \\partial_t \\phi$, to be $\\pi(x,0) = -\\partial_x \\phi(x,0)$. The analytical derivative is:\n$$\n\\partial_x \\phi(x,0) = A \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right) \\left(-\\frac{x-x_0}{\\sigma^2}\\right) = -\\frac{x-x_0}{\\sigma^2} \\phi(x,0)\n$$\nTherefore, the initial conjugate momentum is:\n$$\n\\pi(x,0) = \\frac{x-x_0}{\\sigma^2} \\phi(x,0)\n$$\nIn the weak-field limit, the energy density $\\rho$ and momentum density $S$ as measured by a normal observer (for whom the lapse is $\\alpha=1$ and shift is $\\beta^i=0$) are given by:\n$$\n\\rho(x,0) = \\frac{1}{2}\\left(\\pi(x,0)^2 + (\\partial_x \\phi(x,0))^2\\right)\n$$\n$$\nS(x,0) = \\pi(x,0) \\partial_x \\phi(x,0) = -(\\partial_x \\phi(x,0))^2\n$$\nThe problem states that the initial configuration of the spacetime metric and extrinsic curvature is chosen such that the geometric parts of the ADM constraints are zero. The violations are sourced entirely by the matter fields. Thus, the initial constraint values are:\n$$\n\\mathcal{H}(x,0) = 8\\pi \\rho(x,0) = 4\\pi \\left(\\pi(x,0)^2 + (\\partial_x \\phi(x,0))^2\\right)\n$$\n$$\n\\mathcal{M}(x,0) = 8\\pi S(x,0) = 8\\pi \\pi(x,0) \\partial_x \\phi(x,0)\n$$\nWith our choice of $\\pi(x,0) = -\\partial_x \\phi(x,0)$, these simplify to:\n$$\n\\rho(x,0) = (\\partial_x \\phi(x,0))^2 \\quad \\text{and} \\quad S(x,0) = -(\\partial_x \\phi(x,0))^2\n$$\n$$\n\\mathcal{H}(x,0) = 8\\pi (\\partial_x \\phi(x,0))^2 \\quad \\text{and} \\quad \\mathcal{M}(x,0) = -8\\pi (\\partial_x \\phi(x,0))^2\n$$\n\n### 2. Evolution Equations\n\nWe solve three independent systems of partial differential equations.\n\n**a) Scalar Field:** The scalar field evolves according to the 1D wave equation, written as a first-order system:\n$$\n\\partial_t \\phi = \\pi\n$$\n$$\n\\partial_t \\pi = \\partial_x^2 \\phi\n$$\n\n**b) Simplified ADM Constraint Propagation:** The ADM constraints evolve as two decoupled diffusion (heat) equations, where $\\nu$ represents an artificial viscosity coefficient modeling numerical dissipation.\n$$\n\\partial_t \\mathcal{H}^{\\text{ADM}} = \\nu\\,\\partial_x^2 \\mathcal{H}^{\\text{ADM}}\n$$\n$$\n\\partial_t \\mathcal{M}^{\\text{ADM}} = \\nu\\,\\partial_x^2 \\mathcal{M}^{\\text{ADM}}\n$$\nThis model captures the fact that in the standard ADM formulation, constraint violations do not propagate and their growth is governed by local terms and numerical dissipation.\n\n**c) Simplified BSSN Constraint Propagation:** The BSSN model introduces hyperbolic terms, coupling the Hamiltonian and momentum constraints. This leads to constraint propagation, a key feature improving the stability of numerical simulations.\n$$\n\\partial_t \\mathcal{H}^{\\text{BSSN}} = \\partial_x \\mathcal{M}^{\\text{BSSN}} + \\nu\\,\\partial_x^2 \\mathcal{H}^{\\text{BSSN}}\n$$\n$$\n\\partial_t \\mathcal{M}^{\\text{BSSN}} = \\partial_x \\mathcal{H}^{\\text{BSSN}} + \\nu\\,\\partial_x^2 \\mathcal{M}^{\\text{BSSN}}\n$$\nBoth constraint systems start from the same initial data: $\\mathcal{H}^{\\text{ADM}}(x,0) = \\mathcal{H}^{\\text{BSSN}}(x,0) = \\mathcal{H}(x,0)$ and $\\mathcal{M}^{\\text{ADM}}(x,0) = \\mathcal{M}^{\\text{BSSN}}(x,0) = \\mathcal{M}(x,0)$.\n\n### 3. Numerical Method\n\n**a) Spatial Discretization:** We use second-order central finite differences for spatial derivatives on the grid $x_j$. For a generic field $u_j = u(x_j)$, the derivatives are approximated as:\n$$\n(\\partial_x u)_j \\approx \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}\n$$\n$$\n(\\partial_x^2 u)_j \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{(\\Delta x)^2}\n$$\nPeriodic boundary conditions are imposed, meaning that indices are evaluated modulo $N$. For example, $u_{N} = u_0$ and $u_{-1} = u_{N-1}$.\n\n**b) Time Integration:** The system of ordinary differential equations resulting from spatial discretization is evolved in time using the explicit fourth-order Runge–Kutta (RK4) method. For an equation of the form $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(t, \\mathbf{y})$, a single time step from $t_n$ to $t_{n+1} = t_n + \\Delta t$ is computed as:\n$$\n\\mathbf{k}_1 = \\Delta t \\, \\mathbf{F}(t_n, \\mathbf{y}_n)\n$$\n$$\n\\mathbf{k}_2 = \\Delta t \\, \\mathbf{F}(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_1}{2})\n$$\n$$\n\\mathbf{k}_3 = \\Delta t \\, \\mathbf{F}(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_2}{2})\n$$\n$$\n\\mathbf{k}_4 = \\Delta t \\, \\mathbf{F}(t_n + \\Delta t, \\mathbf{y}_n + \\mathbf{k}_3)\n$$\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nThis procedure is applied independently to the state vectors for the scalar field $(\\phi, \\pi)$, the ADM constraints $(\\mathcal{H}^{\\text{ADM}}, \\mathcal{M}^{\\text{ADM}})$, and the BSSN constraints $(\\mathcal{H}^{\\text{BSSN}}, \\mathcal{M}^{\\text{BSSN}})$. The time step is $\\Delta t = \\lambda \\Delta x$ with the Courant factor $\\lambda \\leq 1$ to ensure numerical stability for the hyperbolic parts of the system. The total number of steps is $N_{steps} = \\text{int}(T/\\Delta t)$.\n\n### 4. Analysis and Comparison\n\nAfter evolving the systems to the final time $T=0.5$, we quantify the growth of the Hamiltonian constraint violation. First, we compute the discrete $L^2$-norm of a field $u$ on the grid:\n$$\n\\|u\\|_2 = \\sqrt{\\Delta x \\sum_{j=0}^{N-1} u_j^2}\n$$\nThe normalized growth factor for the Hamiltonian constraint in each formulation is defined as:\n$$\nG_{\\mathcal{H}}^{\\text{ADM}} = \\frac{\\|\\mathcal{H}^{\\text{ADM}}(\\cdot, T)\\|_2}{\\|\\mathcal{H}(\\cdot, 0)\\|_2} \\quad \\text{and} \\quad G_{\\mathcal{H}}^{\\text{BSSN}} = \\frac{\\|\\mathcal{H}^{\\text{BSSN}}(\\cdot, T)\\|_2}{\\|\\mathcal{H}(\\cdot, 0)\\|_2}\n$$\nThe final metric for comparison is the ratio of these growth factors:\n$$\nR = \\frac{G_{\\mathcal{H}}^{\\text{ADM}}}{G_{\\mathcal{H}}^{\\text{BSSN}}}\n$$\nA value of $R > 1$ indicates that the ADM formulation exhibited greater constraint growth than the BSSN formulation under the specified conditions, highlighting the superior constraint-controlling behavior of the BSSN-like hyperbolic system.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the ratio of Hamiltonian constraint growth in ADM vs. BSSN\n    formulations for a series of test cases.\n    \"\"\"\n    test_cases = [\n        # (A, N, lambda)\n        (10**-2, 512, 0.5),  # Case 1\n        (10**-2, 256, 0.9),  # Case 2\n        (10**-4, 512, 0.5),  # Case 3\n        (10**-2, 128, 0.6),  # Case 4\n    ]\n\n    L = 1.0\n    sigma = 0.05\n    x0 = 0.3\n    T = 0.5\n    nu = 10**-4\n\n    results = []\n\n    for A, N, lam in test_cases:\n        # 1. Grid and Simulation Parameters\n        dx = L / N\n        dt = lam * dx\n        num_steps = int(T / dt)\n        x = np.linspace(0, L, N, endpoint=False)\n\n        # 2. Finite Difference Helper Functions (2nd Order Central, Periodic)\n        def deriv1(u, dx_val):\n            \"\"\"Computes the first derivative.\"\"\"\n            u_p1 = np.roll(u, -1)\n            u_m1 = np.roll(u, 1)\n            return (u_p1 - u_m1) / (2 * dx_val)\n\n        def deriv2(u, dx_val):\n            \"\"\"Computes the second derivative.\"\"\"\n            u_p1 = np.roll(u, -1)\n            u_m1 = np.roll(u, 1)\n            return (u_p1 - 2 * u + u_m1) / (dx_val**2)\n\n        # 3. Initial Conditions\n        # Scalar field and its spatial derivative\n        phi_0 = A * np.exp(-((x - x0) ** 2) / (2 * sigma**2))\n        dphi_dx_0 = deriv1(phi_0, dx) # Use numerical derivative for consistency\n\n        # Conjugate momentum for a right-moving pulse\n        pi_0 = -dphi_dx_0\n\n        # Energy and momentum densities (weak-field limit)\n        # Note: The problem defines S(x,0) = pi * dphi_dx, and pi = -dphi_dx\n        rho_0 = 0.5 * (pi_0**2 + dphi_dx_0**2)\n        S_0 = pi_0 * dphi_dx_0\n\n        # Initial constraint violations\n        H_0 = 8 * np.pi * rho_0\n        M_0 = 8 * np.pi * S_0\n\n        # 4. Set up state vectors for evolution\n        # Scalar field\n        phi, pi = np.copy(phi_0), np.copy(pi_0)\n        # ADM constraints\n        H_adm, M_adm = np.copy(H_0), np.copy(M_0)\n        # BSSN constraints\n        H_bssn, M_bssn = np.copy(H_0), np.copy(M_0)\n\n        # 5. RHS functions for RK4\n        def rhs_scalar(phi_vec, pi_vec, dx_val):\n            dphi_dt = pi_vec\n            dpi_dt = deriv2(phi_vec, dx_val)\n            return dphi_dt, dpi_dt\n\n        def rhs_adm(H_vec, M_vec, dx_val, nu_val):\n            dH_dt = nu_val * deriv2(H_vec, dx_val)\n            dM_dt = nu_val * deriv2(M_vec, dx_val)\n            return dH_dt, dM_dt\n\n        def rhs_bssn(H_vec, M_vec, dx_val, nu_val):\n            dH_dt = deriv1(M_vec, dx_val) + nu_val * deriv2(H_vec, dx_val)\n            dM_dt = deriv1(H_vec, dx_val) + nu_val * deriv2(M_vec, dx_val)\n            return dH_dt, dM_dt\n            \n        # 6. RK4 Time Evolution Loop\n        for _ in range(num_steps):\n            # --- Scalar Field Step ---\n            k1_phi, k1_pi = rhs_scalar(phi, pi, dx)\n            k2_phi, k2_pi = rhs_scalar(phi + 0.5 * dt * k1_phi, pi + 0.5 * dt * k1_pi, dx)\n            k3_phi, k3_pi = rhs_scalar(phi + 0.5 * dt * k2_phi, pi + 0.5 * dt * k2_pi, dx)\n            k4_phi, k4_pi = rhs_scalar(phi + dt * k3_phi, pi + dt * k3_pi, dx)\n            phi += (dt / 6.0) * (k1_phi + 2*k2_phi + 2*k3_phi + k4_phi)\n            pi += (dt / 6.0) * (k1_pi + 2*k2_pi + 2*k3_pi + k4_pi)\n\n            # --- ADM Step ---\n            k1_H, k1_M = rhs_adm(H_adm, M_adm, dx, nu)\n            k2_H, k2_M = rhs_adm(H_adm + 0.5 * dt * k1_H, M_adm + 0.5 * dt * k1_M, dx, nu)\n            k3_H, k3_M = rhs_adm(H_adm + 0.5 * dt * k2_H, M_adm + 0.5 * dt * k2_M, dx, nu)\n            k4_H, k4_M = rhs_adm(H_adm + dt * k3_H, M_adm + dt * k3_M, dx, nu)\n            H_adm += (dt / 6.0) * (k1_H + 2*k2_H + 2*k3_H + k4_H)\n            M_adm += (dt / 6.0) * (k1_M + 2*k2_M + 2*k3_M + k4_M)\n\n            # --- BSSN Step ---\n            k1_H, k1_M = rhs_bssn(H_bssn, M_bssn, dx, nu)\n            k2_H, k2_M = rhs_bssn(H_bssn + 0.5 * dt * k1_H, M_bssn + 0.5 * dt * k1_M, dx, nu)\n            k3_H, k3_M = rhs_bssn(H_bssn + 0.5 * dt * k2_H, M_bssn + 0.5 * dt * k2_M, dx, nu)\n            k4_H, k4_M = rhs_bssn(H_bssn + dt * k3_H, M_bssn + dt * k3_M, dx, nu)\n            H_bssn += (dt / 6.0) * (k1_H + 2*k2_H + 2*k3_H + k4_H)\n            M_bssn += (dt / 6.0) * (k1_M + 2*k2_M + 2*k3_M + k4_M)\n\n        # 7. Analysis and Calculation of R\n        def l2_norm(u, dx_val):\n            return np.sqrt(dx_val * np.sum(u**2))\n\n        norm_H0 = l2_norm(H_0, dx)\n        norm_H_adm_T = l2_norm(H_adm, dx)\n        norm_H_bssn_T = l2_norm(H_bssn, dx)\n\n        # Avoid division by zero if initial norm is zero\n        if norm_H0 == 0:\n            result = 1.0 if norm_H_adm_T == norm_H_bssn_T else np.inf\n        else:\n            G_adm = norm_H_adm_T / norm_H0\n            G_bssn = norm_H_bssn_T / norm_H0\n            # Avoid division by zero if BSSN constraint decays to zero\n            result = G_adm / G_bssn if G_bssn > 0 else np.inf\n\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3463146"}]}