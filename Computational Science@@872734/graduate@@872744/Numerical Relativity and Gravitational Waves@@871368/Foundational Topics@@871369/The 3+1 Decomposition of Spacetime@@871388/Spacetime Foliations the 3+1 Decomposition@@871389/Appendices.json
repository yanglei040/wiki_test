{"hands_on_practices": [{"introduction": "Understanding the 3+1 decomposition begins with the ability to calculate its fundamental components for a given spacetime foliation. This practice provides a crucial workout of these first principles by considering hyperboloidal slices of flat Minkowski spacetime [@problem_id:3487089]. By explicitly deriving the lapse, shift, and extrinsic curvature, you will gain a concrete understanding of how these gauge-dependent quantities emerge directly from the geometry of the slicing.", "problem": "Consider four-dimensional Minkowski spacetime with metric $g_{ab}$ of signature $(-,+,+,+)$ in global Cartesian coordinates $(t,x,y,z)$, where $r^{2} = x^{2} + y^{2} + z^{2}$. Define a hyperboloidal time coordinate $\\tau$ by the relation $t = \\sqrt{\\tau^{2} + r^{2}}$, so that each level set $\\tau = \\text{constant}$ is a spacelike hyperboloid. Using only core definitions of the $3+1$ decomposition in the Arnowitt–Deser–Misner (ADM) formalism, derive the future-directed unit normal $n^{a}$ to the slices, the lapse $\\alpha$, and the shift $\\beta^{i}$ associated with the coordinate system $(\\tau, x, y, z)$. Then compute the trace of the extrinsic curvature $K$ of the $\\tau = \\text{constant}$ slices and justify why $K$ is constant and negative on each slice. Provide the final answer as a single closed-form analytic expression for $K$ in terms of $\\tau$ only.", "solution": "We begin with Minkowski spacetime in Cartesian coordinates $(t,x,y,z)$, with metric $g_{ab}$ such that $ds^{2} = -dt^{2} + dx^{2} + dy^{2} + dz^{2}$ and signature $(-,+,+,+)$. We define a hyperboloidal time coordinate $\\tau$ by $t = \\sqrt{\\tau^{2} + r^{2}}$, where $r^{2} = x^{2} + y^{2} + z^{2}$. Equivalently, $\\tau$ is the function $\\tau = \\sqrt{t^{2} - r^{2}}$ on the region $t^{2}  r^{2}$.\n\nFor a foliation by level sets of $\\tau$, the future-directed unit normal $n^{a}$ to the hypersurfaces $\\tau = \\text{constant}$ can be obtained from the gradient of $\\tau$. The gradient covector is\n$$\n\\nabla_{a}\\tau = \\left(\\frac{\\partial \\tau}{\\partial t}, \\frac{\\partial \\tau}{\\partial x}, \\frac{\\partial \\tau}{\\partial y}, \\frac{\\partial \\tau}{\\partial z}\\right) = \\left(\\frac{t}{\\tau}, -\\frac{x}{\\tau}, -\\frac{y}{\\tau}, -\\frac{z}{\\tau}\\right).\n$$\nIts squared norm is\n$$\ng^{ab}\\nabla_{a}\\tau \\nabla_{b}\\tau = -\\left(\\frac{t}{\\tau}\\right)^{2} + \\frac{x^{2}+y^{2}+z^{2}}{\\tau^{2}} = -\\frac{t^{2}-r^{2}}{\\tau^{2}} = -1,\n$$\nso $|\\nabla \\tau|^{2} = -1$. In the $3+1$ decomposition for spacelike slices, the unit normal covector is related to the foliation function by $n_{a} = -\\alpha \\nabla_{a}\\tau$, where $\\alpha$ is the lapse. Since $|\\nabla \\tau|^{2} = -1$, normalization requires $\\alpha = 1$, hence\n$$\nn_{a} = -\\nabla_{a}\\tau = \\left(-\\frac{t}{\\tau}, \\frac{x}{\\tau}, \\frac{y}{\\tau}, \\frac{z}{\\tau}\\right).\n$$\nRaising indices with $g^{ab}$, we obtain the future-directed unit normal vector\n$$\nn^{a} = g^{ab} n_{b} = \\left(\\frac{t}{\\tau}, \\frac{x}{\\tau}, \\frac{y}{\\tau}, \\frac{z}{\\tau}\\right).\n$$\nThus the lapse is $\\alpha = 1$.\n\nNext we compute the shift $\\beta^{i}$ by expressing the metric in $(\\tau,x,y,z)$. Differentiating $t(\\tau,x,y,z) = \\sqrt{\\tau^{2} + r^{2}}$ gives\n$$\n\\frac{\\partial t}{\\partial \\tau} = \\frac{\\tau}{t}, \\quad \\frac{\\partial t}{\\partial x^{i}} = \\frac{x^{i}}{t},\n$$\nso\n$$\ndt = \\frac{\\tau}{t}\\, d\\tau + \\frac{x^{i}}{t}\\, dx^{i}.\n$$\nSubstituting into $ds^{2} = -dt^{2} + \\delta_{ij} dx^{i} dx^{j}$, we find\n$$\nds^{2} = -\\left(\\frac{\\tau}{t}\\, d\\tau + \\frac{x^{i}}{t}\\, dx^{i}\\right)^{2} + \\delta_{ij} dx^{i} dx^{j}.\n$$\nExpanding,\n$$\nds^{2} = -\\frac{\\tau^{2}}{t^{2}}\\, d\\tau^{2} - \\frac{2\\tau x^{i}}{t^{2}}\\, d\\tau\\, dx^{i} + \\left(\\delta_{ij} - \\frac{x^{i} x^{j}}{t^{2}}\\right) dx^{i} dx^{j}.\n$$\nThis identifies the spatial metric on the slices as\n$$\n\\gamma_{ij} = \\delta_{ij} - \\frac{x^{i} x^{j}}{t^{2}},\n$$\nand the mixed components as\n$$\ng_{\\tau i} = - \\frac{\\tau x^{i}}{t^{2}}.\n$$\nIn the $3+1$ form, $g_{\\tau i} = \\gamma_{ij} \\beta^{j}$, so\n$$\n\\beta^{i} = \\gamma^{ij} g_{\\tau j}.\n$$\nThe inverse of $\\gamma_{ij}$ is obtained via the Sherman–Morrison formula. Noting $t^{2} = \\tau^{2} + r^{2}$, one verifies\n$$\n\\gamma^{ij} = \\delta^{ij} + \\frac{x^{i} x^{j}}{\\tau^{2}}.\n$$\nTherefore,\n$$\n\\beta^{i} = \\left(\\delta^{ij} + \\frac{x^{i} x^{j}}{\\tau^{2}}\\right)\\left(-\\frac{\\tau x^{j}}{t^{2}}\\right) = -\\frac{\\tau}{t^{2}}\\left(x^{i} + \\frac{x^{i} r^{2}}{\\tau^{2}}\\right) = -\\frac{\\tau}{t^{2}}\\frac{t^{2}}{\\tau^{2}} x^{i} = -\\frac{x^{i}}{\\tau}.\n$$\nWe can also confirm the lapse from $g_{\\tau\\tau} = -\\alpha^{2} + \\gamma_{ij}\\beta^{i}\\beta^{j}$. From the above,\n$$\ng_{\\tau\\tau} = -\\frac{\\tau^{2}}{t^{2}}, \\quad \\gamma_{ij}\\beta^{i}\\beta^{j} = \\left(\\delta_{ij} - \\frac{x^{i} x^{j}}{t^{2}}\\right)\\frac{x^{i} x^{j}}{\\tau^{2}} = \\frac{r^{2}}{\\tau^{2}} - \\frac{r^{4}}{t^{2}\\tau^{2}} = \\frac{r^{2}}{t^{2}}.\n$$\nThus $-\\frac{\\tau^{2}}{t^{2}} = -\\alpha^{2} + \\frac{r^{2}}{t^{2}}$, implying $\\alpha^{2} = \\frac{\\tau^{2} + r^{2}}{t^{2}} = 1$ and hence $\\alpha = 1$, consistent with the normalization above.\n\nFinally, we compute the trace of the extrinsic curvature $K$. In the ADM convention for signature $(-,+,+,+)$, the extrinsic curvature tensor is $K_{ij} = -\\frac{1}{2}\\mathcal{L}_{n}\\gamma_{ij}$ plus terms involving the shift, and its trace obeys\n$$\nK = \\gamma^{ij} K_{ij} = -\\nabla_{a} n^{a},\n$$\nwhere $\\nabla_{a}$ is the covariant derivative compatible with $g_{ab}$. In Minkowski inertial coordinates, $\\nabla_{a} n^{a} = \\partial_{a} n^{a}$ because the Christoffel symbols vanish, but care is needed because $n^{a}$ depends on $(t,x,y,z)$ through $\\tau = \\sqrt{t^{2} - r^{2}}$. Define $\\sigma(t,x,y,z) = \\sqrt{t^{2} - r^{2}}$. Then\n$$\nn^{a} = \\left(\\frac{t}{\\sigma}, \\frac{x}{\\sigma}, \\frac{y}{\\sigma}, \\frac{z}{\\sigma}\\right).\n$$\nUsing\n$$\n\\partial_{t}\\sigma = \\frac{t}{\\sigma}, \\quad \\partial_{x}\\sigma = -\\frac{x}{\\sigma}, \\quad \\partial_{y}\\sigma = -\\frac{y}{\\sigma}, \\quad \\partial_{z}\\sigma = -\\frac{z}{\\sigma},\n$$\nwe compute\n\\begin{align*}\n\\partial_{t}\\left(\\frac{t}{\\sigma}\\right) = \\frac{\\sigma - t\\,\\partial_{t}\\sigma}{\\sigma^{2}} = \\frac{\\sigma - t^{2}/\\sigma}{\\sigma^{2}} = \\frac{\\sigma^{2} - t^{2}}{\\sigma^{3}} = -\\frac{r^{2}}{\\sigma^{3}}, \\\\\n\\partial_{x}\\left(\\frac{x}{\\sigma}\\right) = \\frac{\\sigma - x\\,\\partial_{x}\\sigma}{\\sigma^{2}} = \\frac{\\sigma + x^{2}/\\sigma}{\\sigma^{2}} = \\frac{\\sigma^{2} + x^{2}}{\\sigma^{3}}, \\\\\n\\partial_{y}\\left(\\frac{y}{\\sigma}\\right) = \\frac{\\sigma^{2} + y^{2}}{\\sigma^{3}}, \\\\\n\\partial_{z}\\left(\\frac{z}{\\sigma}\\right) = \\frac{\\sigma^{2} + z^{2}}{\\sigma^{3}}.\n\\end{align*}\nSumming yields\n$$\n\\nabla_{a} n^{a} = \\partial_{a} n^{a} = -\\frac{r^{2}}{\\sigma^{3}} + \\frac{\\sigma^{2} + x^{2}}{\\sigma^{3}} + \\frac{\\sigma^{2} + y^{2}}{\\sigma^{3}} + \\frac{\\sigma^{2} + z^{2}}{\\sigma^{3}} = \\frac{3\\sigma^{2}}{\\sigma^{3}} = \\frac{3}{\\sigma}.\n$$\nRestricting to the hypersurface $\\tau = \\sigma$, we obtain\n$$\n\\nabla_{a} n^{a} = \\frac{3}{\\tau}, \\quad \\text{hence} \\quad K = -\\nabla_{a} n^{a} = -\\frac{3}{\\tau}.\n$$\nThis shows that on each hyperboloidal slice $\\tau = \\text{constant}$, the trace of the extrinsic curvature is spatially constant and negative. Its constancy arises because $\\nabla_{a} n^{a}$ depends only on $\\sigma = \\sqrt{t^{2} - r^{2}}$, which is equal to the slice label $\\tau$ everywhere on the slice, and its negativity follows from the ADM sign convention $K = -\\nabla_{a} n^{a}$ with $n^{a}$ chosen future-directed in a spacetime of signature $(-,+,+,+)$.", "answer": "$$\\boxed{-\\frac{3}{\\tau}}$$", "id": "3487089"}, {"introduction": "The power of the 3+1 formalism lies in the freedom to choose gauge conditions, but this freedom comes with responsibility. This exercise explores the dynamical consequences of that choice by examining the popular Bona-Massó family of slicing conditions [@problem_id:3487151]. You will analyze how these conditions can lead to the formation of \"coordinate shocks\"—a critical gauge pathology—thereby learning firsthand about the stability issues that numerical relativists must confront and master.", "problem": "Consider a vacuum spacetime written in the three-plus-one decomposition with lapse $\\,\\alpha\\,$, vanishing shift $\\,\\beta^{i}=0\\,$, and spatial metric $\\,\\gamma_{ij}\\,$. Assume planar symmetry with a single spatial coordinate $\\,x\\,$, and small-amplitude gauge perturbations about Minkowski data so that $\\,\\gamma_{ij}\\approx \\delta_{ij}\\,$ to leading order. As fundamental starting points, use only:\n- The definition of the trace of the extrinsic curvature $\\,K:=\\gamma^{ij}K_{ij}\\,$ and the three-plus-one evolution equation for the spatial metric, which together imply for vanishing shift the identity $\\,\\partial_{t}\\ln\\gamma=-2\\alpha K\\,$, where $\\,\\gamma=\\det(\\gamma_{ij})\\,$.\n- The Bona–Massó slicing condition $\\,\\partial_{t}\\alpha=-\\alpha^{2}f(\\alpha)K\\,$ for some positive gauge driver function $\\,f(\\alpha)0\\,$.\n- The well-known principal part of the evolution equation for $\\,K\\,$ in vacuum, $\\,\\partial_{t}K\\simeq- D^{i}D_{i}\\alpha\\,$, where $\\,D_{i}\\,$ is the covariant derivative with respect to $\\,\\gamma_{ij}\\,$. In the present small-amplitude, planar, Minkowski-background approximation, you may take $\\,D^{i}D_{i}\\alpha\\simeq \\partial_{x}^{2}\\alpha\\,$.\n\nWork to leading nontrivial order in the perturbation amplitude and proceed as follows:\n1. Combine the above to obtain a quasilinear wave equation for the lapse of the schematic form $\\,\\partial_{t}^{2}\\alpha - c^{2}(\\alpha)\\,\\partial_{x}^{2}\\alpha \\simeq 0\\,$ and determine the function $\\,c(\\alpha)\\,$ in terms of $\\,\\alpha\\,$ and $\\,f(\\alpha)\\,$.\n2. In a unidirectional, weakly nonlinear approximation appropriate for right-moving gauge waves, reduce this to a first-order transport Partial Differential Equation (PDE) $\\,\\partial_{t}\\alpha + c(\\alpha)\\,\\partial_{x}\\alpha=0\\,$ governing the leading-order nonlinear steepening of the lapse.\n3. Using the method of characteristics for quasilinear first-order PDEs, derive the general expression for the earliest coordinate shock formation time $\\,t_{s}\\,$ in terms of the initial lapse profile $\\,\\alpha_{0}(x):=\\alpha(x,0)\\,$, namely the earliest time at which characteristics intersect.\n4. Specialize to the one-plus-log slicing defined by $\\,f(\\alpha)=\\dfrac{2}{\\alpha}\\,$ and the smooth initial lapse profile $\\,\\alpha_{0}(x)=1-\\varepsilon\\cos(kx)\\,$ with small positive amplitude $\\,\\varepsilon\\ll 1\\,$ and wavenumber $\\,k0\\,$. Compute, to leading order in $\\,\\varepsilon\\,$, the earliest shock formation time $\\,t_{s}\\,$ as a closed-form analytic expression in terms of $\\,\\varepsilon\\,$ and $\\,k\\,$ only. No rounding is required, and no physical units are to be reported. Provide the final answer as a single analytic expression.", "solution": "We begin from the three-plus-one evolution relation for the spatial metric determinant at vanishing shift,\n$$\n\\partial_{t}\\ln\\gamma=-2\\alpha K,\n$$\nand the Bona–Massó slicing condition,\n$$\n\\partial_{t}\\alpha=-\\alpha^{2} f(\\alpha)\\,K,\n$$\nwhere $\\,f(\\alpha)0\\,$ by assumption. We also use the principal part of the trace of the extrinsic curvature evolution in vacuum,\n$$\n\\partial_{t}K\\simeq - D^{i}D_{i}\\alpha.\n$$\nUnder the stated approximations (planar symmetry and small-amplitude perturbations about Minkowski data), we take $\\,\\gamma_{ij}\\simeq \\delta_{ij}\\,$ so that $\\,D^{i}D_{i}\\alpha\\simeq \\partial_{x}^{2}\\alpha\\,$.\n\nDifferentiate the slicing condition with respect to time:\n$$\n\\partial_{t}^{2}\\alpha \\;=\\; -\\,\\partial_{t}\\big(\\alpha^{2} f(\\alpha)\\,K\\big)\n\\;=\\; -\\big(2\\alpha f(\\alpha)+\\alpha^{2} f'(\\alpha)\\big)\\,(\\partial_{t}\\alpha)\\,K \\;-\\; \\alpha^{2} f(\\alpha)\\,\\partial_{t}K.\n$$\nHere $\\,f'(\\alpha)=\\dfrac{d f}{d\\alpha}\\,$. In the weakly nonlinear, small-amplitude regime, the product term $\\,(\\partial_{t}\\alpha)\\,K\\,$ is quadratic in perturbation amplitude and can be neglected at leading order. Retaining the principal part gives\n$$\n\\partial_{t}^{2}\\alpha \\;\\simeq\\; -\\,\\alpha^{2} f(\\alpha)\\,\\partial_{t}K \\;\\simeq\\; \\alpha^{2} f(\\alpha)\\,\\partial_{x}^{2}\\alpha.\n$$\nThus the lapse obeys, to leading order, a variable-coefficient wave equation\n$$\n\\partial_{t}^{2}\\alpha \\;-\\; c^{2}(\\alpha)\\,\\partial_{x}^{2}\\alpha \\;\\simeq\\; 0,\n$$\nwith\n$$\nc(\\alpha) \\;=\\; \\alpha\\,\\sqrt{f(\\alpha)}.\n$$\n\nTo expose nonlinear wave steepening, consider a unidirectional, weakly nonlinear approximation in which we restrict to predominantly right-moving waves. For a constant $\\,c\\,$, the one-dimensional wave operator factors, $\\,\\partial_{t}^{2}-c^{2}\\partial_{x}^{2}=(\\partial_{t}-c\\partial_{x})(\\partial_{t}+c\\partial_{x})\\,$, and pure right-movers satisfy $\\,(\\partial_{t}+c\\partial_{x})\\alpha=0\\,$. When $\\,c=c(\\alpha)\\,$ varies slowly with $\\,\\alpha\\,$, the leading-order unidirectional approximation generalizes to the quasilinear transport PDE\n$$\n\\partial_{t}\\alpha \\;+\\; c(\\alpha)\\,\\partial_{x}\\alpha \\;=\\; 0,\n$$\nwith $\\,c(\\alpha)=\\alpha\\sqrt{f(\\alpha)}\\,$ as obtained above. This first-order equation captures the amplitude-dependent propagation speed that leads to nonlinear steepening.\n\nWe now analyze shock formation for the quasilinear first-order PDE\n$$\n\\partial_{t}u + c(u)\\,\\partial_{x}u = 0,\\qquad u(x,0)=u_{0}(x),\n$$\nwith $\\,u=\\alpha\\,$ and $\\,c(u)=\\alpha\\sqrt{f(\\alpha)}\\,$. The method of characteristics gives ordinary differential equations along curves $\\,x(t)\\,$:\n$$\n\\frac{d x}{d t} = c(u),\\qquad \\frac{d u}{d t} = 0.\n$$\nThus $\\,u\\,$ is constant along characteristics, taking its value from the initial data, $\\,u=u_{0}(x_{0})\\,$, where $\\,x_{0}\\,$ labels the footpoint on the initial line $\\,t=0\\,$. The characteristic curves are then\n$$\nx(t; x_{0}) = x_{0} + c\\big(u_{0}(x_{0})\\big)\\,t.\n$$\nA shock forms when characteristics intersect, which occurs when the mapping $\\,x_{0}\\mapsto x(t;x_{0})\\,$ loses monotonicity, i.e., when $\\,\\partial x/\\partial x_{0}=0\\,$. We compute\n$$\n\\frac{\\partial x}{\\partial x_{0}} = 1 + c'\\big(u_{0}(x_{0})\\big)\\,u_{0}'(x_{0})\\,t,\n$$\nwhere $\\,c'(u)=\\dfrac{d c}{d u}\\,$ and prime on $\\,u_{0}\\,$ denotes spatial derivative. The earliest shock time $\\,t_{s}\\,$ is therefore\n$$\nt_{s} \\;=\\; -\\,\\frac{1}{\\displaystyle \\min_{x_{0}}\\big[c'\\big(u_{0}(x_{0})\\big)\\,u_{0}'(x_{0})\\big]}\\,,\n$$\nprovided the minimum is negative.\n\nWe now specialize to one-plus-log slicing, $\\,f(\\alpha)=\\dfrac{2}{\\alpha}\\,$, for which\n$$\nc(\\alpha) \\;=\\; \\alpha\\,\\sqrt{\\frac{2}{\\alpha}} \\;=\\; \\sqrt{2\\,\\alpha},\\qquad c'(\\alpha) \\;=\\; \\frac{\\sqrt{2}}{2}\\,\\alpha^{-1/2}.\n$$\nTake the initial lapse profile\n$$\n\\alpha_{0}(x) \\;=\\; 1 - \\varepsilon \\cos(k x),\\qquad \\varepsilon0,\\; k0,\\;\\varepsilon\\ll 1,\n$$\nwith derivative\n$$\n\\alpha_{0}'(x) \\;=\\; \\varepsilon k \\,\\sin(k x).\n$$\nThen\n$$\nc'\\big(\\alpha_{0}(x)\\big)\\,\\alpha_{0}'(x) \\;=\\; \\frac{\\sqrt{2}}{2}\\,\\big(\\alpha_{0}(x)\\big)^{-1/2}\\,\\varepsilon k \\,\\sin(k x).\n$$\nThe minimum of this expression is negative and occurs where $\\,\\sin(kx)\\,$ attains its most negative value while $\\,\\alpha_{0}(x)\\,$ does not significantly increase the magnitude through the factor $\\,(\\alpha_{0})^{-1/2}\\,$. For small $\\,\\varepsilon\\,$, the leading-order minimum is at $\\,kx=-\\frac{\\pi}{2}\\,$, where $\\,\\sin(kx)=-1\\,$ and $\\,\\cos(kx)=0\\,$, so that $\\,\\alpha_{0}=1\\,$. Hence, to leading order in $\\,\\varepsilon\\,$,\n$$\n\\min_{x}\\Big[c'\\big(\\alpha_{0}(x)\\big)\\,\\alpha_{0}'(x)\\Big] \\;\\simeq\\; -\\,\\frac{\\sqrt{2}}{2}\\,\\varepsilon k.\n$$\nTherefore, the earliest shock formation time is\n$$\nt_{s} \\;\\simeq\\; -\\,\\frac{1}{-\\,\\dfrac{\\sqrt{2}}{2}\\,\\varepsilon k} \\;=\\; \\frac{\\sqrt{2}}{\\varepsilon k},\n$$\nto leading order in $\\,\\varepsilon\\,$, as required. This gives a concrete demonstration of nonlinear steepening and coordinate shock formation in Bona–Massó slicing for the one-plus-log choice.", "answer": "$$\\boxed{\\frac{\\sqrt{2}}{\\varepsilon k}}$$", "id": "3487151"}, {"introduction": "Ultimately, the 3+1 decomposition is a tool for making physical predictions, which must be independent of our coordinate choices. This computational practice puts that principle to the test by examining the invariance of radiated energy under a change in time foliation [@problem_id:3487145]. By implementing the calculation both naively and with the correct physical measure, you will gain a practical appreciation for why careful handling of the lapse function is essential for extracting meaningful physics from numerical simulations.", "problem": "You are asked to verify the invariance of a physically measurable quantity under a time-reparametrization (lapse rescaling) in the context of the spacetime foliation known as the $3+1$ decomposition, and to quantify numerical artifacts introduced by performing the same calculation naively in coordinate time. Work in geometric units where $G=c=1$, so all quantities in this problem are dimensionless.\n\nConsider a gravitational wave strain proxy $h(u)$ at future null infinity, where $u$ is the physical retarded time. In the $3+1$ decomposition, coordinate time $t$ advances according to $du=\\alpha(t)\\,dt$, where $\\alpha$ is the lapse. A pure time-reparametrization rescales the lapse as $\\alpha\\rightarrow \\alpha'(t')=f(t')\\,\\alpha(t)$, corresponding to a new coordinate time $t'$ satisfying $du=\\alpha'(t')\\,dt'$ with the same physical $u$. The News function is $N(u)=dh/du$, and the Bondi mass loss rate is $dM/du=-(16\\pi)^{-1}\\int |N|^2\\,d\\Omega$. For this computational problem, you will work with the proxy energy functional\n$$\nE[h]:=\\int |N(u)|^2\\,du=\\int \\left|\\frac{dh}{du}\\right|^2\\,du,\n$$\nwhich is proportional to the integral of the energy flux over retarded time after a trivial angular normalization. Show numerically that $E[h]$ is invariant under time-reparametrization when computed consistently with the Jacobian implied by the lapse, and that a naive computation that ignores the Jacobian is not invariant.\n\nFundamental bases you may use:\n- The $3+1$ decomposition identifies a lapse $\\alpha$ such that $du=\\alpha\\,dt$.\n- Under a lapse rescaling $\\alpha\\rightarrow \\alpha'=f(t')\\alpha$ one has $du=\\alpha'(t')\\,dt'$.\n- The chain rule implies $dh/dt=\\alpha\\,N$ and $dh/dt'=\\alpha'\\,N$.\n\nYour program must implement the following steps:\n1. Define a smooth, localized waveform in physical retarded time $u$:\n   - Let $h(u)=A\\exp\\!\\left(-\\frac{(u-u_0)^2}{2\\sigma^2}\\right)\\cos\\!\\big(\\omega (u-u_0)\\big)$ with parameters $A=1$, $u_0=0$, $\\sigma=5$, and $\\omega=0.8$.\n   - Use a uniform physical-time grid $u\\in[-U,U]$ with $U=30$ and $N_u=60001$ points, so the uniform step is $\\Delta u=2U/(N_u-1)$.\n2. Original foliation:\n   - Take $\\alpha=1$, so $u=t$.\n   - Compute the “proper” energy $E_{\\text{proper}}=\\int |dh/dt|^2/\\alpha\\,dt$, which here reduces to $E_{\\text{proper}}=\\int |dh/du|^2\\,du$ on the $u$-grid.\n   - Also compute the “naive” energy $E_{\\text{naive}}=\\int |dh/dt|^2\\,dt$, which equals $E_{\\text{proper}}$ when $\\alpha=1$.\n3. Rescaled foliation:\n   - For each specified $f(t')$ below, construct the new coordinate time $t'(u)$ by solving the ordinary differential equation $dt'/du = 1/f(t')$ with initial condition $t'(u=-U)=0$. Use a stable, sufficiently accurate explicit method.\n   - Create a uniform $t'$-grid with the same number of points $N_u$, spanning the interval $[t'(u=-U),t'(u=+U)]$.\n   - Invert $t'(u)$ to obtain $u(t')$ by monotone interpolation, and evaluate $h$ on the uniform $t'$-grid via $h(t')=h(u(t'))$.\n   - Compute\n     - the “proper” rescaled energy $E'_{\\text{proper}}=\\int |dh/dt'|^2/\\alpha'(t')\\,dt' = \\int |dh/dt'|^2/f(t')\\,dt'$ on the uniform $t'$-grid,\n     - and the “naive” rescaled energy $E'_{\\text{naive}}=\\int |dh/dt'|^2\\,dt'$ on the same grid.\n4. For each rescaling $f$, report three diagnostics:\n   - The relative invariance error $\\epsilon_{\\text{inv}}=\\big|E'_{\\text{proper}}-E_{\\text{proper}}\\big|/E_{\\text{proper}}$,\n   - The naive relative deviation $\\epsilon_{\\text{naive}}=\\big|E'_{\\text{naive}}-E_{\\text{naive}}\\big|/E_{\\text{naive}}$,\n   - A sampling stretch factor $S=\\max_{t'} f(t')/\\min_{t'} f(t')$, which quantifies non-uniformity introduced by the time-dependent rescaling.\n\nTest suite:\n- Case $1$ (identity): $f_1(t')=1$.\n- Case $2$ (constant rescaling): $f_2(t')=2$.\n- Case $3$ (mildly time-dependent): $f_3(t')=1+0.3\\sin(0.5\\,t')$.\n- Case $4$ (strongly time-dependent): $f_4(t')=1+0.9\\sin(0.9\\,t')$.\n\nAngle units are radians. All outputs are dimensionless in geometric units.\n\nYour program must output a single line containing the concatenated results for the four cases, in order, as a comma-separated list enclosed in square brackets. For each case output the triplet $[\\epsilon_{\\text{inv}},\\epsilon_{\\text{naive}},S]$ in that order, concatenated into a single flat list. For example, the overall output format must be\n\"[eps_inv_case1,eps_naive_case1,S_case1,eps_inv_case2,eps_naive_case2,S_case2,eps_inv_case3,eps_naive_case3,S_case3,eps_inv_case4,eps_naive_case4,S_case4]\".\n\nAll numerical differentiation and integration must be implemented by your code. No user input is permitted. The final answers must be printed as floating-point numbers.", "solution": "The problem statement is valid. It is scientifically grounded in the principles of general relativity and its $3+1$ formulation, specifically concerning the invariance of physical observables under choices of spacetime foliation. The problem is well-posed, providing a complete set of definitions, parameters, and a clear computational objective that is feasible and verifiable.\n\nThe core principle to be demonstrated is the invariance of a physical quantity under a coordinate transformation. The proxy for total radiated energy, $E[h]$, is defined in terms of the physical retarded time $u$ as:\n$$\nE[h] = \\int \\left|\\frac{dh}{du}\\right|^2 du = \\int |N(u)|^2 du\n$$\nThis quantity must have the same value regardless of the coordinate system used for its computation, provided the computation correctly accounts for the transformation. We are considering a transformation from one coordinate time $t$ to another, $t'$, which reparametrizes the foliation. The relationship between the physical time interval $du$ and the coordinate time intervals $dt$ and $dt'$ is given by the lapse function, $\\alpha$ and $\\alpha'$ respectively:\n$$\ndu = \\alpha(t) \\, dt = \\alpha'(t') \\, dt'\n$$\nThe problem specifies an initial foliation with $\\alpha(t)=1$, so $du=dt$ and $u=t$ (up to a trivial constant). The reparametrization introduces a new lapse $\\alpha'(t') = f(t')\\alpha(t) = f(t')$.\n\nTo compute the integral for $E[h]$ in the new $t'$ coordinates, we must transform both the integrand and the measure. Using the chain rule, the News function $N(u) = dh/du$ can be expressed in terms of the derivative with respect to $t'$:\n$$\n\\frac{dh}{dt'} = \\frac{dh}{du} \\frac{du}{dt'} = N(u) \\, \\alpha'(t') \\implies N(u) = \\frac{1}{\\alpha'(t')} \\frac{dh}{dt'}\n$$\nThe integration measure transforms as $du = \\alpha'(t') dt'$. Substituting these into the definition of $E[h]$ yields the expression for the energy in the new coordinates:\n$$\nE[h] = \\int \\left| \\frac{1}{\\alpha'(t')} \\frac{dh}{dt'} \\right|^2 (\\alpha'(t') dt') = \\int \\frac{|dh/dt'|^2}{(\\alpha'(t'))^2} \\alpha'(t') dt' = \\int \\frac{|dh/dt'|^2}{\\alpha'(t')} dt'\n$$\nThis demonstrates that the \"proper\" energy computation, $E'_{\\text{proper}} = \\int |dh/dt'|^2/\\alpha'(t')\\,dt'$, is constructed precisely to be invariant. The \"naive\" computation, $E'_{\\text{naive}} = \\int |dh/dt'|^2\\,dt'$, omits the Jacobian factors and is therefore not expected to be invariant. Our task is to verify this numerically.\n\nThe computational procedure is as follows:\n\n1.  **Baseline Calculation**: First, we establish the baseline value for the energy. We define a uniform grid in the physical time $u$ spanning $[-U, U] = [-30, 30]$ with $N_u = 60001$ points. In the original foliation, $\\alpha=1$, so coordinate time $t$ is identical to $u$. We evaluate the waveform $h(u)$ on this grid. The derivative $dh/dt = dh/du$ is computed using a second-order finite difference scheme. The energy $E_{\\text{proper}} = \\int |dh/du|^2 du$ is then calculated using the trapezoidal rule for numerical integration. For this baseline case, $E_{\\text{naive}} = \\int |dh/dt|^2 dt$ is identical to $E_{\\text{proper}}$.\n\n2.  **Coordinate Transformation**: For each given rescaling function $f(t')$, we must establish the mapping between the physical time $u$ and the new coordinate time $t'$. This is achieved by solving the ordinary differential equation $dt'/du = 1/\\alpha'(t') = 1/f(t')$, with the initial condition $t'(u=-U)=0$. This initial value problem is solved using a high-accuracy adaptive Runge-Kutta method (`DOP853` or `RK45` as implemented in `scipy.integrate.solve_ivp`) to obtain discrete values of $t'(u)$ on our physical time grid.\n\n3.  **Rescaled Grid and Interpolation**: We then construct a new uniform computational grid in the $t'$ coordinate, spanning the calculated range $[t'(-U), t'(U)]$ with the same number of points, $N_u$. To evaluate the waveform $h$ on this new grid, we require the inverse mapping $u(t')$. Since $f(t')  0$, the function $t'(u)$ is strictly monotonic, guaranteeing a unique inverse. We construct a cubic spline interpolant for $u(t')$ from the results of the ODE integration. This allows us to find the value of $u$ corresponding to each point on our uniform $t'$-grid, and subsequently evaluate $h(t') = h(u(t'))$.\n\n4.  **Rescaled Energy Calculation**: On the uniform $t'$-grid, we compute the derivative $dh/dt'$ using the same finite difference method. We also evaluate the rescaled lapse $\\alpha'(t')=f(t')$ at each grid point. With these quantities, we compute the rescaled energies $E'_{\\text{proper}} = \\int |dh/dt'|^2/f(t')\\,dt'$ and $E'_{\\text{naive}} = \\int |dh/dt'|^2\\,dt'$ via numerical integration.\n\n5.  **Diagnostic Metrics**: Finally, for each test case, we compute the specified diagnostics. The relative invariance error $\\epsilon_{\\text{inv}} = |E'_{\\text{proper}} - E_{\\text{proper}}|/E_{\\text{proper}}$ quantifies how well the proper calculation preserves the energy value, isolating numerical (discretization, interpolation) errors. The naive relative deviation $\\epsilon_{\\text{naive}} = |E'_{\\text{naive}} - E_{\\text{naive}}|/E_{\\text{naive}}$ measures the failure of the naive calculation to be invariant. The stretch factor $S = \\max(f)/\\min(f)$ characterizes the degree of non-uniformity of the time transformation. We expect $\\epsilon_{\\text{inv}}$ to be small (close to machine precision, limited by numerical accuracy), whereas $\\epsilon_{\\text{naive}}$ will be significantly different from zero for any non-trivial rescaling where $f(t')$ is not uniformly equal to $1$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, trapezoid\nfrom scipy.interpolate import interp1d\n\ndef solve():\n    \"\"\"\n    Verifies the invariance of a physical energy functional under time-reparametrization\n    in the 3+1 decomposition of spacetime, and quantifies the error from a naive calculation.\n    \"\"\"\n    # 1. Define constants and the waveform\n    A = 1.0\n    u0 = 0.0\n    sigma = 5.0\n    omega = 0.8\n    U = 30.0\n    Nu = 60001\n\n    # Define a uniform grid in physical retarded time u\n    u_grid = np.linspace(-U, U, Nu)\n    du = u_grid[1] - u_grid[0]\n\n    def h_func(u_vals):\n        \"\"\"Defines the gravitational wave strain proxy h(u).\"\"\"\n        arg = u_vals - u0\n        return A * np.exp(-arg**2 / (2 * sigma**2)) * np.cos(omega * arg)\n\n    # 2. Original foliation (alpha=1, so t=u)\n    t_grid_orig = u_grid\n    dt_orig = du\n    h_orig = h_func(t_grid_orig)\n    \n    # Compute derivative dh/dt numerically using second-order central differences\n    dhdt_orig = np.gradient(h_orig, dt_orig)\n    \n    # In the original foliation, lapse alpha is 1\n    alpha_orig = 1.0\n    \n    # Integrands for proper and naive energy\n    integrand_proper_orig = dhdt_orig**2 / alpha_orig\n    integrand_naive_orig = dhdt_orig**2\n    \n    # Compute energies using the trapezoidal rule. They are identical for alpha=1.\n    E_proper = trapezoid(integrand_proper_orig, t_grid_orig)\n    E_naive = trapezoid(integrand_naive_orig, t_grid_orig)\n    \n    # Define the test cases for the rescaling function f(t')\n    test_cases = [\n        {\"func\": lambda tp: 1.0, \"name\": \"identity\"},\n        {\"func\": lambda tp: 2.0, \"name\": \"constant\"},\n        {\"func\": lambda tp: 1.0 + 0.3 * np.sin(0.5 * tp), \"name\": \"mildly_tdep\"},\n        {\"func\": lambda tp: 1.0 + 0.9 * np.sin(0.9 * tp), \"name\": \"strongly_tdep\"}\n    ]\n    \n    results = []\n\n    # 3. Loop through rescaled foliation cases\n    for case in test_cases:\n        f = case[\"func\"]\n        \n        # a. Solve the ODE dt'/du = 1/f(t') to get the map t'(u)\n        def ode_rhs(u, t_prime):\n            # The ODE depends on the value of the solution t_prime\n            return 1.0 / f(t_prime)\n        \n        sol = solve_ivp(\n            ode_rhs, \n            t_span=[u_grid[0], u_grid[-1]], \n            y0=[0.0],  # Initial condition t'(-U) = 0\n            t_eval=u_grid,\n            method='DOP853', # Use a high-order accurate solver\n            rtol=1e-13, \n            atol=1e-13\n        )\n        t_prime_of_u = sol.y.flatten()\n\n        # b. Create a new uniform grid in t' and interpolate to find u(t')\n        t_prime_min = t_prime_of_u[0]\n        t_prime_max = t_prime_of_u[-1]\n        t_prime_grid = np.linspace(t_prime_min, t_prime_max, Nu)\n        dt_prime = t_prime_grid[1] - t_prime_grid[0]\n        \n        # Create a cubic spline interpolant for u(t')\n        u_of_t_prime = interp1d(t_prime_of_u, u_grid, kind='cubic', bounds_error=False, fill_value=\"extrapolate\")\n        \n        # Evaluate u on the new t' grid\n        u_on_t_prime_grid = u_of_t_prime(t_prime_grid)\n\n        # c. Evaluate waveform, derivative, and lapse on the new t' grid\n        h_rescaled = h_func(u_on_t_prime_grid)\n        dhdt_prime = np.gradient(h_rescaled, dt_prime)\n        alpha_prime = f(t_prime_grid)\n\n        # d. Compute rescaled energies\n        integrand_proper_rescaled = dhdt_prime**2 / alpha_prime\n        integrand_naive_rescaled = dhdt_prime**2\n        \n        E_prime_proper = trapezoid(integrand_proper_rescaled, t_prime_grid)\n        E_prime_naive = trapezoid(integrand_naive_rescaled, t_prime_grid)\n\n        # e. Compute final diagnostic quantities\n        # Relative invariance error\n        eps_inv = np.abs(E_prime_proper - E_proper) / E_proper if E_proper != 0 else 0.0\n        \n        # Naive relative deviation\n        eps_naive = np.abs(E_prime_naive - E_naive) / E_naive if E_naive != 0 else 0.0\n\n        # Sampling stretch factor\n        stretch_factor_S = np.max(alpha_prime) / np.min(alpha_prime)\n\n        results.extend([eps_inv, eps_naive, stretch_factor_S])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{val:.15g}' for val in results)}]\")\n\nsolve()\n```", "id": "3487145"}]}