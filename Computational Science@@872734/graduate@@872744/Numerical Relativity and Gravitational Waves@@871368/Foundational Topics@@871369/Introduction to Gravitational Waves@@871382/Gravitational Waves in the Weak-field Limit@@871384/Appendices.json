{"hands_on_practices": [{"introduction": "In linearized gravity, the full metric perturbation $h_{\\mu\\nu}$ contains both physical radiative modes and unphysical gauge artifacts. To perform meaningful physics, one must first isolate the true gravitational wave content. This is accomplished using the Transverse-Traceless (TT) projector, an essential mathematical operator that filters out non-radiative components. This exercise [@problem_id:3476552] provides direct, hands-on practice in applying this projector to a general spatial tensor, reinforcing the algebraic steps required to distill the pure wave signal from the full perturbation.", "problem": "Consider linearized gravity in Minkowski spacetime in the weak-field limit, where the gravitational-wave content is isolated by imposing the Transverse-Traceless (TT) conditions on spatial, symmetric rank-two tensors. Let the propagation direction be the unit vector $\\hat{n} = \\frac{1}{\\sqrt{3}}(1,1,1)$, and let the symmetric spatial tensor be\n$$\nS_{ij}(t) \\equiv \\begin{pmatrix}\n2\\cos(\\Omega t) & \\sin(\\Omega t) & \\cos(\\Omega t) \\\\\n\\sin(\\Omega t) & -\\cos(\\Omega t) + \\sin(\\Omega t) & 2\\sin(\\Omega t) \\\\\n\\cos(\\Omega t) & 2\\sin(\\Omega t) & 3\\cos(\\Omega t)\n\\end{pmatrix},\n$$\nwhere $\\Omega$ is a constant angular frequency and $t$ is coordinate time.\n\nStarting from the definitions of the TT conditions for a plane wave in the weak-field limit of General Relativity (GR)—namely, that the TT part $S^{TT}_{ij}$ is transverse to the propagation direction, $\\hat{n}^{i} S^{TT}_{ij} = 0$, and traceless with respect to the spatial Euclidean metric, $\\delta^{ij} S^{TT}_{ij} = 0$—derive the TT projector that maps any symmetric spatial tensor $S_{ij}$ to its TT part $S^{TT}_{ij}$ using the spatial projector onto the plane orthogonal to $\\hat{n}$. Then apply your derived projector to the specific $S_{ij}(t)$ and $\\hat{n}$ given above to obtain an explicit closed-form expression for $S^{TT}_{ij}(t)$ as a $3\\times 3$ matrix in terms of $\\sin(\\Omega t)$ and $\\cos(\\Omega t)$.\n\nExpress your final answer as a single closed-form analytic $3\\times 3$ matrix. No numerical approximation or rounding is required, and no physical units should be included.", "solution": "The goal is to derive the Transverse-Traceless (TT) projector and apply it to the given tensor $S_{ij}$. The TT part of a tensor $S_{ij}$, denoted $S_{ij}^{TT}$, must satisfy two conditions: it must be transverse to the propagation direction $\\hat{n}$ ($\\hat{n}^i S_{ij}^{TT} = 0$), and it must be traceless ($\\delta^{ij} S_{ij}^{TT} = 0$).\n\n### Derivation of the TT Projector\n\nThe projection is a two-step process.\n1.  **Make the tensor transverse.** We use the projector $P_{ij} = \\delta_{ij} - \\hat{n}_i \\hat{n}_j$, which projects vectors onto the plane orthogonal to $\\hat{n}$. Applying this to both indices of $S_{kl}$ gives a transverse tensor, which we'll call $S'_{ij}$:\n    $$\n    S'_{ij} = P_{ik} P_{jl} S_{kl}\n    $$\n    This tensor is transverse by construction since $\\hat{n}^i P_{ik} = 0$.\n\n2.  **Make the transverse tensor traceless.** The tensor $S'_{ij}$ is transverse, but not necessarily traceless. Its trace is $S' = \\delta^{ij} S'_{ij}$. To make it traceless, we must subtract a tensor that has the correct trace but does not spoil the transverse property. The only symmetric transverse tensor available built from the metric is the projector $P_{ij}$ itself. We define the TT tensor as:\n    $$\n    S^{TT}_{ij} = S'_{ij} - K P_{ij}\n    $$\n    We find the scalar $K$ by enforcing the traceless condition:\n    $$\n    \\delta^{ij} S^{TT}_{ij} = \\delta^{ij} S'_{ij} - K \\delta^{ij} P_{ij} = 0\n    $$\n    This implies $S' - K \\text{Tr}(P) = 0$. The trace of the projector is $\\text{Tr}(P) = \\delta^{ij}(\\delta_{ij} - \\hat{n}_i \\hat{n}_j) = 3 - 1 = 2$.\n    Thus, $S' - 2K = 0$, which gives $K = \\frac{1}{2}S'$.\n\nThe complete TT projector operator $\\Lambda_{ijkl}$ acting on $S_{kl}$ is therefore:\n$$\nS^{TT}_{ij} = \\Lambda_{ijkl}S_{kl} = P_{ik}P_{jl}S_{kl} - \\frac{1}{2} P_{ij} (\\delta^{ab}P_{ac}P_{bd}S_{cd})\n$$\n\n### Application to the Specific Problem\n\nLet $c = \\cos(\\Omega t)$ and $s = \\sin(\\Omega t)$.\n\n1.  **Construct the projector $P_{ij}$**:\n    With $\\hat{n} = \\frac{1}{\\sqrt{3}}(1,1,1)$, the outer product $\\hat{n}_i \\hat{n}_j$ is a matrix of all $1/3$.\n    $$\n    P = \\delta - \\hat{n} \\otimes \\hat{n} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & 1 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}\n    $$\n\n2.  **Calculate the transverse tensor $S' = PSP$**:\n    The given tensor is:\n    $$\n    S = \\begin{pmatrix} 2c & s & c \\\\ s & s-c & 2s \\\\ c & 2s & 3c \\end{pmatrix}\n    $$\n    The matrix multiplication $S' = PSP$ yields:\n    $$\n    S' = \\frac{1}{9} \\begin{pmatrix} 6c+s & s & -6c-2s \\\\ s & 3c-8s & -3c+7s \\\\ -6c-2s & -3c+7s & 9c-5s \\end{pmatrix}\n    $$\n\n3.  **Calculate the trace $S'$**:\n    The trace of $S'$ is the sum of its diagonal elements:\n    $$\n    S' = \\text{Tr}(S') = \\frac{1}{9} [(6c+s) + (3c-8s) + (9c-5s)] = \\frac{1}{9} [18c - 12s] = \\frac{2}{3}(3c - 2s)\n    $$\n\n4.  **Construct the TT tensor $S^{TT} = S' - \\frac{1}{2}S'P$**:\n    First, we find the term to be subtracted:\n    $$\n    \\frac{1}{2}S'P = \\frac{1}{2} \\left(\\frac{2}{3}(3c-2s)\\right) \\left(\\frac{1}{3} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}\\right) = \\frac{3c-2s}{9} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}\n    $$\n    Now, we perform the subtraction $S^{TT} = S' - \\frac{1}{2}S'P$:\n    $$\n    S^{TT}_{11} = \\frac{1}{9}(6c+s) - \\frac{2(3c-2s)}{9} = \\frac{6c+s-6c+4s}{9} = \\frac{5s}{9}\n    $$\n    $$\n    S^{TT}_{12} = \\frac{1}{9}(s) - \\frac{-(3c-2s)}{9} = \\frac{s+3c-2s}{9} = \\frac{3c-s}{9}\n    $$\n    $$\n    S^{TT}_{13} = \\frac{1}{9}(-6c-2s) - \\frac{-(3c-2s)}{9} = \\frac{-6c-2s+3c-2s}{9} = \\frac{-3c-4s}{9}\n    $$\n    $$\n    S^{TT}_{22} = \\frac{1}{9}(3c-8s) - \\frac{2(3c-2s)}{9} = \\frac{3c-8s-6c+4s}{9} = \\frac{-3c-4s}{9}\n    $$\n    $$\n    S^{TT}_{23} = \\frac{1}{9}(-3c+7s) - \\frac{-(3c-2s)}{9} = \\frac{-3c+7s+3c-2s}{9} = \\frac{5s}{9}\n    $$\n    $$\n    S^{TT}_{33} = \\frac{1}{9}(9c-5s) - \\frac{2(3c-2s)}{9} = \\frac{9c-5s-6c+4s}{9} = \\frac{3c-s}{9}\n    $$\n    Assembling the matrix (and using symmetry for the remaining components), we get the final result:\n    $$\n    S^{TT}_{ij}(t) = \\frac{1}{9} \\begin{pmatrix} 5s & 3c-s & -3c-4s \\\\ 3c-s & -3c-4s & 5s \\\\ -3c-4s & 5s & 3c-s \\end{pmatrix}\n    $$\n    Substituting back $c = \\cos(\\Omega t)$ and $s = \\sin(\\Omega t)$ gives the explicit time-dependent matrix.\n\nAs a final check, we can verify that this matrix is indeed traceless (sum of diagonal is $5s - 3c - 4s + 3c - s = 0$) and transverse (sum of elements in any row or column is zero, because $\\hat{n}$ has equal components). For example, the sum of the first row is $5s + (3c-s) + (-3c-4s) = 0$. The conditions are satisfied.", "answer": "$$ \\boxed{ \\frac{1}{9} \\begin{pmatrix} 5\\sin(\\Omega t) & 3\\cos(\\Omega t)-\\sin(\\Omega t) & -3\\cos(\\Omega t)-4\\sin(\\Omega t) \\\\ 3\\cos(\\Omega t)-\\sin(\\Omega t) & -3\\cos(\\Omega t)-4\\sin(\\Omega t) & 5\\sin(\\Omega t) \\\\ -3\\cos(\\Omega t)-4\\sin(\\Omega t) & 5\\sin(\\Omega t) & 3\\cos(\\Omega t)-\\sin(\\Omega t) \\end{pmatrix} } $$", "id": "3476552"}, {"introduction": "Having learned how to isolate the gravitational wave polarizations, $h_+$ and $h_\\times$, we can now probe their fundamental physical nature. The way a field's components transform under a rotation of the observer's reference frame reveals its intrinsic spin. This exercise [@problem_id:3476585] guides you through the classic derivation of how the polarization amplitudes mix under a rotation in the transverse plane, a result that directly demonstrates the spin-$2$ character of gravitational waves and the graviton.", "problem": "A plane gravitational wave is modeled in the weak-field, linearized limit of General Relativity (GR) by a metric of the form $g_{\\mu \\nu} = \\eta_{\\mu \\nu} + h_{\\mu \\nu}$, with $|h_{\\mu \\nu}| \\ll 1$, where $\\eta_{\\mu \\nu}$ is the Minkowski metric and $h_{\\mu \\nu}$ is the metric perturbation. In the Transverse-Traceless (TT) gauge, for a wave propagating along $\\hat{\\boldsymbol{z}}$, the nonzero components of $h_{ij}$ lie in the plane orthogonal to $\\hat{\\boldsymbol{z}}$ and can be decomposed relative to an orthonormal transverse basis $\\{\\hat{\\boldsymbol{x}},\\hat{\\boldsymbol{y}}\\}$ as\n$$\nh_{ij}(t-z) = h_{+}(t-z)\\, e^{+}_{ij} + h_{\\times}(t-z)\\, e^{\\times}_{ij},\n$$\nwhere the polarization tensors are defined by\n$$\ne^{+}_{ij} = \\hat{x}_{i}\\hat{x}_{j} - \\hat{y}_{i}\\hat{y}_{j}, \\quad e^{\\times}_{ij} = \\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j}.\n$$\nConsider a rotation of the transverse basis vectors about $\\hat{\\boldsymbol{z}}$ by an angle $\\psi$ (measured in radians),\n$$\n\\hat{\\boldsymbol{x}}' = \\cos\\psi\\, \\hat{\\boldsymbol{x}} + \\sin\\psi\\, \\hat{\\boldsymbol{y}}, \\qquad \\hat{\\boldsymbol{y}}' = -\\sin\\psi\\, \\hat{\\boldsymbol{x}} + \\cos\\psi\\, \\hat{\\boldsymbol{y}}.\n$$\nLet $e^{+}_{ij}$ and $e^{\\times}_{ij}$ be redefined with respect to the rotated basis $\\{\\hat{\\boldsymbol{x}}',\\hat{\\boldsymbol{y}}'\\}$, and let $h_{+}'$ and $h_{\\times}'$ denote the corresponding polarization amplitudes in the rotated basis, defined by $h_{ij} = h_{+}'\\, e^{+}_{ij}{}' + h_{\\times}'\\, e^{\\times}_{ij}{}'$.\n\nStarting only from the definitions above, derive how the pair $(h_{+},h_{\\times})$ mixes under the rotation by $\\psi$. Express your final result as a single, closed-form analytic expression for the complex strain combination $h^{\\mathrm{c}} := h_{+} + i h_{\\times}$, relating $h^{\\mathrm{c}}{}'$ to $h^{\\mathrm{c}}$ and $\\psi$. Provide the exact symbolic expression; no numerical approximation or rounding is required. State your final answer with the angle $\\psi$ in radians.", "solution": "The goal is to determine how the polarization amplitudes, $h_{+}$ and $h_{\\times}$, transform under a rotation of the transverse spatial basis vectors. The key insight is that the physical metric perturbation tensor, $h_{ij}$, is an invariant object; its representation may change with the basis, but the tensor itself does not. This invariance allows us to equate the expressions for $h_{ij}$ in the original and rotated bases.\n\nLet the original basis be $\\{\\hat{\\boldsymbol{x}}, \\hat{\\boldsymbol{y}}\\}$ and the rotated basis be $\\{\\hat{\\boldsymbol{x}}', \\hat{\\boldsymbol{y}}'\\}$. The metric perturbation tensor $h_{ij}$ can be expressed in either basis:\n$$\nh_{ij} = h_{+}(t-z)\\, e^{+}_{ij} + h_{\\times}(t-z)\\, e^{\\times}_{ij} = h_{+}'(t-z)\\, e^{+}_{ij}{}' + h_{\\times}'(t-z)\\, e^{\\times}_{ij}{}'\n$$\nHere, $e^{+}_{ij}$ and $e^{\\times}_{ij}$ are the polarization tensors in the original basis, while $e^{+}_{ij}{}'$ and $e^{\\times}_{ij}{}'$ are the corresponding tensors in the rotated basis. To find the relationship between $(h_{+}, h_{\\times})$ and $(h_{+}', h_{\\times}')$, we must first express the rotated polarization tensors in terms of the original ones.\n\nThe rotated basis vectors are given by:\n$$\n\\hat{\\boldsymbol{x}}' = \\cos\\psi\\, \\hat{\\boldsymbol{x}} + \\sin\\psi\\, \\hat{\\boldsymbol{y}}\n$$\n$$\n\\hat{\\boldsymbol{y}}' = -\\sin\\psi\\, \\hat{\\boldsymbol{x}} + \\cos\\psi\\, \\hat{\\boldsymbol{y}}\n$$\nThe rotated polarization tensors are defined as:\n$$\ne^{+}_{ij}{}' = \\hat{x}'_{i}\\hat{x}'_{j} - \\hat{y}'_{i}\\hat{y}'_{j}\n$$\n$$\ne^{\\times}_{ij}{}' = \\hat{x}'_{i}\\hat{y}'_{j} + \\hat{y}'_{i}\\hat{x}'_{j}\n$$\nWe substitute the expressions for $\\hat{\\boldsymbol{x}}'$ and $\\hat{\\boldsymbol{y}}'$ into these definitions.\n\nFirst, for $e^{+}_{ij}{}'$:\nThe term $\\hat{x}'_{i}\\hat{x}'_{j}$ is:\n$$\n\\hat{x}'_{i}\\hat{x}'_{j} = (\\cos\\psi\\, \\hat{x}_{i} + \\sin\\psi\\, \\hat{y}_{i})(\\cos\\psi\\, \\hat{x}_{j} + \\sin\\psi\\, \\hat{y}_{j}) = \\cos^{2}\\psi\\, \\hat{x}_{i}\\hat{x}_{j} + \\sin^{2}\\psi\\, \\hat{y}_{i}\\hat{y}_{j} + \\sin\\psi\\cos\\psi\\, (\\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j})\n$$\nThe term $\\hat{y}'_{i}\\hat{y}'_{j}$ is:\n$$\n\\hat{y}'_{i}\\hat{y}'_{j} = (-\\sin\\psi\\, \\hat{x}_{i} + \\cos\\psi\\, \\hat{y}_{i})(-\\sin\\psi\\, \\hat{x}_{j} + \\cos\\psi\\, \\hat{y}_{j}) = \\sin^{2}\\psi\\, \\hat{x}_{i}\\hat{x}_{j} + \\cos^{2}\\psi\\, \\hat{y}_{i}\\hat{y}_{j} - \\sin\\psi\\cos\\psi\\, (\\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j})\n$$\nSubtracting the second from the first gives $e^{+}_{ij}{}'$:\n$$\ne^{+}_{ij}{}' = (\\cos^{2}\\psi - \\sin^{2}\\psi)(\\hat{x}_{i}\\hat{x}_{j} - \\hat{y}_{i}\\hat{y}_{j}) + (2\\sin\\psi\\cos\\psi)(\\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j})\n$$\nUsing the trigonometric identities $\\cos(2\\psi) = \\cos^{2}\\psi - \\sin^{2}\\psi$ and $\\sin(2\\psi) = 2\\sin\\psi\\cos\\psi$, and the definitions $e^{+}_{ij} = \\hat{x}_{i}\\hat{x}_{j} - \\hat{y}_{i}\\hat{y}_{j}$ and $e^{\\times}_{ij} = \\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j}$, we get:\n$$\ne^{+}_{ij}{}' = \\cos(2\\psi)\\, e^{+}_{ij} + \\sin(2\\psi)\\, e^{\\times}_{ij}\n$$\n\nNext, for $e^{\\times}_{ij}{}'$:\nThe term $\\hat{x}'_{i}\\hat{y}'_{j}$ is:\n$$\n\\hat{x}'_{i}\\hat{y}'_{j} = (\\cos\\psi\\, \\hat{x}_{i} + \\sin\\psi\\, \\hat{y}_{i})(-\\sin\\psi\\, \\hat{x}_{j} + \\cos\\psi\\, \\hat{y}_{j}) = -\\sin\\psi\\cos\\psi\\, \\hat{x}_{i}\\hat{x}_{j} + \\cos^{2}\\psi\\, \\hat{x}_{i}\\hat{y}_{j} - \\sin^{2}\\psi\\, \\hat{y}_{i}\\hat{x}_{j} + \\sin\\psi\\cos\\psi\\, \\hat{y}_{i}\\hat{y}_{j}\n$$\nAdding this to its symmetric counterpart $\\hat{y}'_{i}\\hat{x}'_{j}$ gives $e^{\\times}_{ij}{}'$:\n$$\ne^{\\times}_{ij}{}' = -\\sin(2\\psi)\\, (\\hat{x}_{i}\\hat{x}_{j} - \\hat{y}_{i}\\hat{y}_{j}) + (\\cos^{2}\\psi - \\sin^{2}\\psi)(\\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j})\n$$\n$$\ne^{\\times}_{ij}{}' = -\\sin(2\\psi)\\, e^{+}_{ij} + \\cos(2\\psi)\\, e^{\\times}_{ij}\n$$\nNow, we substitute these relations back into the invariance equation for $h_{ij}$:\n$$\nh_{+}\\, e^{+}_{ij} + h_{\\times}\\, e^{\\times}_{ij} = h_{+}'( \\cos(2\\psi)\\, e^{+}_{ij} + \\sin(2\\psi)\\, e^{\\times}_{ij} ) + h_{\\times}'( -\\sin(2\\psi)\\, e^{+}_{ij} + \\cos(2\\psi)\\, e^{\\times}_{ij} )\n$$\nWe group the terms by the basis tensors $e^{+}_{ij}$ and $e^{\\times}_{ij}$:\n$$\nh_{+}\\, e^{+}_{ij} + h_{\\times}\\, e^{\\times}_{ij} = (h_{+}'\\cos(2\\psi) - h_{\\times}'\\sin(2\\psi))\\, e^{+}_{ij} + (h_{+}'\\sin(2\\psi) + h_{\\times}'\\cos(2\\psi))\\, e^{\\times}_{ij}\n$$\nThe polarization tensors $e^{+}_{ij}$ and $e^{\\times}_{ij}$ are orthogonal and form a basis for the transverse-traceless part of the perturbation. Therefore, we can equate the coefficients on both sides of the equation:\n$$\nh_{+} = h_{+}'\\cos(2\\psi) - h_{\\times}'\\sin(2\\psi)\n$$\n$$\nh_{\\times} = h_{+}'\\sin(2\\psi) + h_{\\times}'\\cos(2\\psi)\n$$\nThis represents a rotation of coordinates. To find $h_{+}'$ and $h_{\\times}'$ in terms of $h_{+}$ and $h_{\\times}$, we invert this system of equations. This corresponds to a rotation by an angle of $2\\psi$:\n$$\nh_{+}' = h_{+}\\cos(2\\psi) + h_{\\times}\\sin(2\\psi)\n$$\n$$\nh_{\\times}' = -h_{+}\\sin(2\\psi) + h_{\\times}\\cos(2\\psi)\n$$\nFinally, we construct the complex strain in the rotated basis, $h^{\\mathrm{c}}{}' = h_{+}' + i h_{\\times}'$:\n$$\nh^{\\mathrm{c}}{}' = (h_{+}\\cos(2\\psi) + h_{\\times}\\sin(2\\psi)) + i(-h_{+}\\sin(2\\psi) + h_{\\times}\\cos(2\\psi))\n$$\nWe collect terms multiplying $h_{+}$ and $h_{\\times}$:\n$$\nh^{\\mathrm{c}}{}' = h_{+}(\\cos(2\\psi) - i\\sin(2\\psi)) + h_{\\times}(\\sin(2\\psi) + i\\cos(2\\psi))\n$$\nFactoring out an $i$ from the second term, we get $\\sin(2\\psi) + i\\cos(2\\psi) = i(\\cos(2\\psi) - i\\sin(2\\psi))$.\n$$\nh^{\\mathrm{c}}{}' = h_{+}(\\cos(2\\psi) - i\\sin(2\\psi)) + i h_{\\times}(\\cos(2\\psi) - i\\sin(2\\psi))\n$$\nFactoring out the common term $(\\cos(2\\psi) - i\\sin(2\\psi))$:\n$$\nh^{\\mathrm{c}}{}' = (h_{+} + i h_{\\times})(\\cos(2\\psi) - i\\sin(2\\psi))\n$$\nUsing Euler's formula, $\\exp(-i\\theta) = \\cos\\theta - i\\sin\\theta$, with $\\theta = 2\\psi$, and the definition $h^{\\mathrm{c}} = h_{+} + i h_{\\times}$, we arrive at the final expression:\n$$\nh^{\\mathrm{c}}{}' = h^{\\mathrm{c}}\\exp(-i2\\psi)\n$$\nThis result demonstrates that the complex strain transforms as a spin-$2$ quantity under rotations in the transverse plane, as a rotation by an angle $\\psi$ induces a phase shift of $-2\\psi$.", "answer": "$$\n\\boxed{h^{\\mathrm{c}}{}' = h^{\\mathrm{c}} \\exp(-i 2 \\psi)}\n$$", "id": "3476585"}, {"introduction": "Moving from analytical theory to computational practice is a critical step in modern physics. In numerical relativity, it is essential to verify that theoretical constructs hold true in a discretized, finite-precision environment. This problem [@problem_id:3476511] involves writing a program to confirm that an analytically constructed Transverse-Traceless (TT) wave does indeed satisfy the transverse ($\\partial_i h_{ij}^{\\mathrm{TT}} = 0$) and traceless ($h_{ii}^{\\mathrm{TT}} = 0$) conditions on a computational grid. This exercise builds foundational skills in numerical methods, such as finite differencing, and develops intuition for how continuous physical laws are realized in a computational setting.", "problem": "Consider weak-field gravitational waves described by a small metric perturbation $h_{\\mu\\nu}$ on a flat background, where $|h_{\\mu\\nu}| \\ll 1$. In the Transverse-Traceless (TT) gauge, the spatial components $h_{ij}^{\\mathrm{TT}}$ of a vacuum plane-wave solution are known to be divergence-free (transverse) and trace-free (traceless). The transversality and tracelessness conditions for the spatial tensor field $h_{ij}^{\\mathrm{TT}}(t,\\mathbf{x})$ are, respectively, $\\partial_i h_{ij}^{\\mathrm{TT}}(t,\\mathbf{x}) = 0$ and $h_{ii}^{\\mathrm{TT}}(t,\\mathbf{x}) = 0$, where repeated indices are summed over $i = 1,2,3$.\n\nYour task is to implement a numerical verification of these conditions over a three-dimensional Cartesian grid for a set of plane-wave test cases. Each test case defines: a cubic spatial domain, a discrete grid, a unit propagation direction vector, a fixed observation time, an angular frequency, and amplitudes for two orthogonal polarization modes. Construct a plane-wave field $h_{ij}^{\\mathrm{TT}}$ consistent with the Transverse-Traceless (TT) gauge and verify numerically that the divergence $\\partial_i h_{ij}^{\\mathrm{TT}}$ and the trace $h_{ii}^{\\mathrm{TT}}$ are within a given tolerance uniformly across the grid.\n\nUse the following foundational base:\n- In the weak-field limit, the linearized Einstein equations imply that, in vacuum, the metric perturbation satisfies the wave equation, and the Transverse-Traceless (TT) gauge imposes $\\partial_i h_{ij}^{\\mathrm{TT}} = 0$ and $h_{ii}^{\\mathrm{TT}} = 0$.\n- A plane wave with angular frequency $\\omega$ and wave vector $\\mathbf{k} = k\\,\\hat{\\mathbf{n}}$ propagates along a unit vector $\\hat{\\mathbf{n}}$, with $k = \\omega/c$ and $c$ the speed of light.\n- The field $h_{ij}^{\\mathrm{TT}}$ is dimensionless. Spatial coordinates are in $\\mathrm{m}$, time in $\\mathrm{s}$, frequency in $\\mathrm{rad/s}$, and angles used in trigonometric functions must be in radians. Use $c = 2.99792458\\times 10^8\\,\\mathrm{m/s}$.\n\nNumerical method requirements:\n- Discretize the domain as a uniform grid with $N_x$, $N_y$, $N_z$ points in each direction, spanning lengths $L_x$, $L_y$, $L_z$ in $\\mathrm{m}$. Let the spacings be $dx = L_x/(N_x-1)$, $dy = L_y/(N_y-1)$, $dz = L_z/(N_z-1)$.\n- Compute partial derivatives numerically using finite differences of at least second-order accuracy in the interior. Boundary handling may use one-sided differences that are first or second order, provided the global maximum norm is evaluated across the entire grid.\n- For each test case, evaluate the maximum absolute values $\\max_{\\mathbf{x},j}|\\partial_i h_{ij}^{\\mathrm{TT}}|$ and $\\max_{\\mathbf{x}}|h_{ii}^{\\mathrm{TT}}|$ over all grid points and indices, and compare against a tolerance $\\varepsilon$.\n\nTest suite:\nImplement the following four test cases. For each case, construct a plane wave consistent with the Transverse-Traceless (TT) gauge using the specified parameters and verify the conditions. Report a boolean result per test case indicating whether both transversality and tracelessness are satisfied to within tolerance across the domain.\n\n- Test case $1$:\n    - Domain: $L_x = L_y = L_z = 10000\\,\\mathrm{m}$, Grid: $N_x = N_y = N_z = 33$.\n    - Propagation direction: $\\hat{\\mathbf{n}} = (0,0,1)$.\n    - Angular frequency: $\\omega = 2\\pi\\times 100\\,\\mathrm{rad/s}$.\n    - Polarization amplitudes: $A_{+} = 1\\times 10^{-21}$, $A_{\\times} = 0$.\n    - Time: $t = 0\\,\\mathrm{s}$.\n    - Tolerance: $\\varepsilon = 1\\times 10^{-18}$.\n\n- Test case $2$:\n    - Domain: $L_x = L_y = L_z = 20000\\,\\mathrm{m}$, Grid: $N_x = N_y = N_z = 41$.\n    - Propagation direction: $\\hat{\\mathbf{n}} = (1,1,1)/\\sqrt{3}$.\n    - Angular frequency: $\\omega = 2\\pi\\times 50\\,\\mathrm{rad/s}$.\n    - Polarization amplitudes: $A_{+} = 0$, $A_{\\times} = 2\\times 10^{-21}$.\n    - Time: $t = 0\\,\\mathrm{s}$.\n    - Tolerance: $\\varepsilon = 1\\times 10^{-18}$.\n\n- Test case $3$:\n    - Domain: $L_x = L_y = L_z = 5000\\,\\mathrm{m}$, Grid: $N_x = N_y = N_z = 21$.\n    - Propagation direction: $\\hat{\\mathbf{n}} = (0,1,0)$.\n    - Angular frequency: $\\omega = 2\\pi\\times 1000\\,\\mathrm{rad/s}$.\n    - Polarization amplitudes: $A_{+} = 1\\times 10^{-21}$, $A_{\\times} = 3\\times 10^{-21}$.\n    - Time: $t = 1\\times 10^{-2}\\,\\mathrm{s}$.\n    - Tolerance: $\\varepsilon = 1\\times 10^{-18}$.\n\n- Test case $4$:\n    - Domain: $L_x = L_y = L_z = 1000\\,\\mathrm{m}$, Grid: $N_x = N_y = N_z = 9$.\n    - Propagation direction: $\\hat{\\mathbf{n}} = (0,0,1)$.\n    - Angular frequency: $\\omega = 2\\pi\\times 200\\,\\mathrm{rad/s}$.\n    - Polarization amplitudes: $A_{+} = 2\\times 10^{-21}$, $A_{\\times} = 1\\times 10^{-21}$.\n    - Time: $t = 5\\times 10^{-3}\\,\\mathrm{s}$.\n    - Tolerance: $\\varepsilon = 1\\times 10^{-16}$.\n\nImplementation details:\n- Construct orthonormal polarization basis vectors $\\hat{\\mathbf{e}}_{1}$ and $\\hat{\\mathbf{e}}_{2}$ perpendicular to $\\hat{\\mathbf{n}}$, and use them to build a Transverse-Traceless (TT) polarization tensor with two orthogonal modes and amplitudes $A_{+}$ and $A_{\\times}$.\n- Form a plane wave $h_{ij}^{\\mathrm{TT}}(t,\\mathbf{x})$ that is consistent with the Transverse-Traceless (TT) gauge and propagates along $\\hat{\\mathbf{n}}$, with phase depending on $\\omega$, $t$, and $\\mathbf{k}\\cdot\\mathbf{x}$, where $\\mathbf{k} = (\\omega/c)\\,\\hat{\\mathbf{n}}$.\n- Numerically compute $\\partial_i h_{ij}^{\\mathrm{TT}}$ via finite differences and compute $h_{ii}^{\\mathrm{TT}}$ directly from the field.\n\nOutput specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$, where each $r_m$ is a boolean indicating whether both conditions $\\partial_i h_{ij}^{\\mathrm{TT}} = 0$ and $h_{ii}^{\\mathrm{TT}} = 0$ are satisfied within the specified tolerance for test case $m$ across the entire grid.", "solution": "The solution proceeds in two main steps: first, the analytical construction of the gravitational wave field $h_{ij}^{\\mathrm{TT}}(t,\\mathbf{x})$; second, the numerical procedure to verify its properties on a discrete grid.\n\nA plane gravitational wave propagating in a vacuum is described by a perturbation $h_{\\mu\\nu}$ to the flat Minkowski metric $\\eta_{\\mu\\nu}$. In the TT gauge, the spatial part of this perturbation, $h_{ij}^{\\mathrm{TT}}$, is a solution to the vacuum wave equation. For a monochromatic plane wave with angular frequency $\\omega$ and wave vector $\\mathbf{k}$, the solution can be written as:\n$$\nh_{ij}^{\\mathrm{TT}}(t, \\mathbf{x}) = \\mathcal{A}_{ij} \\cos(\\phi) = \\mathcal{A}_{ij} \\cos(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)\n$$\nwhere $\\phi = \\mathbf{k} \\cdot \\mathbf{x} - \\omega t$ is the phase. The wave vector is given by $\\mathbf{k} = (\\omega/c) \\hat{\\mathbf{n}}$, where $\\hat{\\mathbf{n}}$ is the unit vector in the direction of propagation and $c = 2.99792458 \\times 10^8 \\, \\mathrm{m/s}$ is the speed of light. The amplitude tensor $\\mathcal{A}_{ij}$ is constant and encapsulates the polarization information.\n\nThe TT gauge imposes two conditions on the spatial tensor $h_{ij}^{\\mathrm{TT}}$:\n1.  **Tracelessness**: The trace of the tensor is zero, $h_{ii}^{\\mathrm{TT}} = 0$ (summation over $i=1,2,3$).\n2.  **Transversality**: The tensor is transverse to the direction of propagation, which, for a plane wave, implies $k_i h_{ij}^{\\mathrm{TT}} = 0$. This is equivalent to the divergence-free condition $\\partial_i h_{ij}^{\\mathrm{TT}} = 0$, as can be seen by applying the chain rule: $\\partial_i h_{ij}^{\\mathrm{TT}} = \\mathcal{A}_{ij} (-\\sin(\\phi)) (\\partial_i \\phi) = -k_i \\mathcal{A}_{ij} \\sin(\\phi)$.\n\nTo satisfy these conditions, the amplitude tensor $\\mathcal{A}_{ij}$ is constructed from a linear combination of two basis polarization tensors, $\\epsilon_{ij}^{+}$ and $\\epsilon_{ij}^{\\times}$:\n$$\n\\mathcal{A}_{ij} = A_{+} \\epsilon_{ij}^{+} + A_{\\times} \\epsilon_{ij}^{\\times}\n$$\nwhere $A_{+}$ and $A_{\\times}$ are the amplitudes of the \"plus\" and \"cross\" polarization modes, respectively.\n\nThe polarization tensors are constructed from an orthonormal basis $\\{\\hat{\\mathbf{e}}_1, \\hat{\\mathbf{e}}_2\\}$ in the plane perpendicular to the propagation direction $\\hat{\\mathbf{n}}$.\n$$\n\\epsilon_{ij}^{+} = (\\hat{e}_1)_i (\\hat{e}_1)_j - (\\hat{e}_2)_i (\\hat{e}_2)_j\n$$\n$$\n\\epsilon_{ij}^{\\times} = (\\hat{e}_1)_i (\\hat{e}_2)_j + (\\hat{e}_2)_i (\\hat{e}_1)_j\n$$\nThis basis can be constructed for any given $\\hat{\\mathbf{n}}$. A robust method is to choose a fixed, non-collinear vector, for instance $\\mathbf{v} = (0,0,1)$ (or $\\mathbf{v}=(1,0,0)$ if $\\hat{\\mathbf{n}}$ is parallel to $(0,0,1)$), and then use the Gram-Schmidt procedure or cross products. A reliable construction is:\n1.  Choose a vector $\\mathbf{v}$ not parallel to $\\hat{\\mathbf{n}}$.\n2.  Define $\\hat{\\mathbf{e}}_2 = \\frac{\\hat{\\mathbf{n}} \\times \\mathbf{v}}{|\\hat{\\mathbf{n}} \\times \\mathbf{v}|}$.\n3.  Define $\\hat{\\mathbf{e}}_1 = \\hat{\\mathbf{e}}_2 \\times \\hat{\\mathbf{n}}$.\nThe resulting set $\\{\\hat{\\mathbf{e}}_1, \\hat{\\mathbf{e}}_2, \\hat{\\mathbf{n}}\\}$ forms a right-handed orthonormal basis.\n\nBy construction, both $\\epsilon_{ij}^{+}$ and $\\epsilon_{ij}^{\\times}$ are traceless and transverse to $\\mathbf{k}$, ensuring that $h_{ij}^{\\mathrm{TT}}$ satisfies the TT gauge conditions analytically.\n\nFor the numerical verification, the spatial domain is discretized into a uniform Cartesian grid with dimensions $N_x \\times N_y \\times N_z$ and spacings $dx$, $dy$, $dz$. The field $h_{ij}^{\\mathrm{TT}}(t, \\mathbf{x})$ is evaluated at each grid point for a fixed time $t$.\n\n**Verification of Tracelessness:**\nThe trace $T(\\mathbf{x}) = h_{ii}^{\\mathrm{TT}}(\\mathbf{x}) = h_{11}^{\\mathrm{TT}}(\\mathbfx) + h_{22}^{\\mathrm{TT}}(\\mathbf{x}) + h_{33}^{\\mathrm{TT}}(\\mathbf{x})$ is computed at each grid point. The maximum absolute value of the trace over the entire grid is found:\n$$\n\\text{err}_{\\text{trace}} = \\max_{\\mathbf{x}} |T(\\mathbf{x})|\n$$\nThis value is compared against the tolerance $\\varepsilon$. Analytically, the trace is zero. Numerically, this error should be on the order of machine floating-point precision.\n\n**Verification of Transversality:**\nThe divergence vector, $D_j(\\mathbf{x}) = \\partial_i h_{ij}^{\\mathrm{TT}}(\\mathbf{x})$, is computed for each component $j \\in \\{1,2,3\\}$. This requires numerical differentiation. We use finite differences with second-order accuracy in the grid interior and first-order accuracy at the boundaries, as implemented in `numpy.gradient`. For each grid point $\\mathbf{x}$, the three components of the divergence are:\n$$\nD_1(\\mathbf{x}) = \\partial_1 h_{11}^{\\mathrm{TT}} + \\partial_2 h_{21}^{\\mathrm{TT}} + \\partial_3 h_{31}^{\\mathrm{TT}}\n$$\n$$\nD_2(\\mathbf{x}) = \\partial_1 h_{12}^{\\mathrm{TT}} + \\partial_2 h_{22}^{\\mathrm{TT}} + \\partial_3 h_{32}^{\\mathrm{TT}}\n$$\n$$\nD_3(\\mathbf{x}) = \\partial_1 h_{13}^{\\mathrm{TT}} + \\partial_2 h_{23}^{\\mathrm{TT}} + \\partial_3 h_{33}^{\\mathrm{TT}}\n$$\nThe maximum absolute value of the divergence over the entire grid and all three components is found:\n$$\n\\text{err}_{\\text{div}} = \\max_{\\mathbf{x}, j} |D_j(\\mathbf{x})|\n$$\nThis error, which arises from the discretization of the derivative operator, is compared against the tolerance $\\varepsilon$.\n\nFor each test case, the final result is `True` if and only if both conditions, $\\text{err}_{\\text{trace}} \\le \\varepsilon$ and $\\text{err}_{\\text{div}} \\le \\varepsilon$, are met.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            \"domain\": (10000.0, 10000.0, 10000.0),\n            \"grid_size\": (33, 33, 33),\n            \"n_hat\": np.array([0.0, 0.0, 1.0]),\n            \"omega\": 2.0 * np.pi * 100.0,\n            \"A_plus\": 1e-21,\n            \"A_cross\": 0.0,\n            \"time\": 0.0,\n            \"tolerance\": 1e-18,\n        },\n        # Test case 2\n        {\n            \"domain\": (20000.0, 20000.0, 20000.0),\n            \"grid_size\": (41, 41, 41),\n            \"n_hat\": np.array([1.0, 1.0, 1.0]) / np.sqrt(3),\n            \"omega\": 2.0 * np.pi * 50.0,\n            \"A_plus\": 0.0,\n            \"A_cross\": 2e-21,\n            \"time\": 0.0,\n            \"tolerance\": 1e-18,\n        },\n        # Test case 3\n        {\n            \"domain\": (5000.0, 5000.0, 5000.0),\n            \"grid_size\": (21, 21, 21),\n            \"n_hat\": np.array([0.0, 1.0, 0.0]),\n            \"omega\": 2.0 * np.pi * 1000.0,\n            \"A_plus\": 1e-21,\n            \"A_cross\": 3e-21,\n            \"time\": 1e-2,\n            \"tolerance\": 1e-18,\n        },\n        # Test case 4\n        {\n            \"domain\": (1000.0, 1000.0, 1000.0),\n            \"grid_size\": (9, 9, 9),\n            \"n_hat\": np.array([0.0, 0.0, 1.0]),\n            \"omega\": 2.0 * np.pi * 200.0,\n            \"A_plus\": 2e-21,\n            \"A_cross\": 1e-21,\n            \"time\": 5e-3,\n            \"tolerance\": 1e-16,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = verify_tt_conditions(**case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, [r.item() for r in results]))}]\")\n\n\ndef verify_tt_conditions(domain, grid_size, n_hat, omega, A_plus, A_cross, time, tolerance):\n    \"\"\"\n    Constructs a TT-gauge plane wave and verifies its properties numerically.\n\n    Args:\n        domain (tuple): A tuple (Lx, Ly, Lz) of domain lengths in meters.\n        grid_size (tuple): A tuple (Nx, Ny, Nz) of grid points.\n        n_hat (np.ndarray): A 3D unit vector for the propagation direction.\n        omega (float): Angular frequency in rad/s.\n        A_plus (float): Amplitude of the plus polarization.\n        A_cross (float): Amplitude of the cross polarization.\n        time (float): Observation time in seconds.\n        tolerance (float): Error tolerance for verification.\n\n    Returns:\n        np.bool_: True if both conditions are met, False otherwise.\n    \"\"\"\n    c = 2.99792458e8  # Speed of light in m/s\n    Lx, Ly, Lz = domain\n    Nx, Ny, Nz = grid_size\n\n    # 1. Construct polarization basis vectors e1, e2 orthogonal to n_hat\n    v = np.array([0.0, 0.0, 1.0])\n    # If n_hat is parallel to v, choose a different non-collinear vector\n    if np.allclose(np.abs(np.dot(n_hat, v)), 1.0):\n        v = np.array([1.0, 0.0, 0.0])\n    \n    e2 = np.cross(n_hat, v)\n    e2 /= np.linalg.norm(e2)\n    e1 = np.cross(e2, n_hat)\n\n    # 2. Construct polarization tensors\n    eps_plus = np.outer(e1, e1) - np.outer(e2, e2)\n    eps_cross = np.outer(e1, e2) + np.outer(e2, e1)\n\n    # 3. Set up the grid and wave vector\n    x = np.linspace(0, Lx, Nx)\n    y = np.linspace(0, Ly, Ny)\n    z = np.linspace(0, Lz, Nz)\n    xx, yy, zz = np.meshgrid(x, y, z, indexing='ij')\n\n    k_vec = (omega / c) * n_hat\n\n    # 4. Construct the h_ij field\n    phase = k_vec[0] * xx + k_vec[1] * yy + k_vec[2] * zz - omega * time\n    \n    # h_field shape: (Nx, Ny, Nz, 3, 3)\n    amplitude_tensor = A_plus * eps_plus + A_cross * eps_cross\n    h_field = amplitude_tensor[np.newaxis, np.newaxis, np.newaxis, :, :] * np.cos(phase)[..., np.newaxis, np.newaxis]\n\n    # 5. Verify tracelessness\n    trace_h = np.einsum('...ii->...', h_field)\n    max_trace_error = np.max(np.abs(trace_h))\n\n    # 6. Verify transversality (divergence-free)\n    dx = Lx / (Nx - 1) if Nx > 1 else 1.0\n    dy = Ly / (Ny - 1) if Ny > 1 else 1.0\n    dz = Lz / (Nz - 1) if Nz > 1 else 1.0\n    \n    # np.gradient computes the gradient of an N-dimensional array.\n    # It returns a list of arrays, one for each dimension specified in axis.\n    # Here, we get [grad_x(h_ij), grad_y(h_ij), grad_z(h_ij)].\n    # We stack them to create a tensor of shape (3, Nx, Ny, Nz, 3, 3).\n    # The first index 'i' corresponds to the derivative direction (d/dx_i).\n    grad_h_list = np.stack(np.gradient(h_field, dx, dy, dz, axis=(0, 1, 2)), axis=0)\n\n    # Compute divergence D_j = sum_i(d/dx_i h_ij) by contracting the\n    # derivative index with the first spatial index of h_ij.\n    # 'i...ij->...j' contracts over 'i'.\n    # The result `div_h` has shape (Nx, Ny, Nz, 3).\n    div_h = np.einsum('i...ij->...j', grad_h_list)\n    max_div_error = np.max(np.abs(div_h))\n\n    # 7. Final check\n    is_valid = (max_trace_error <= tolerance) and (max_div_error <= tolerance)\n    return np.bool_(is_valid)\n\n# Execute the solution\nsolve()\n```", "id": "3476511"}]}