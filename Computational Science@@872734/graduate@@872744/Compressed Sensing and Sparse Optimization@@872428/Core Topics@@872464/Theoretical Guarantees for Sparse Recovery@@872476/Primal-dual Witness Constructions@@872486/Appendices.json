{"hands_on_practices": [{"introduction": "This first exercise grounds the abstract theory of primal-dual witnesses in a concrete numerical example. By manually working through the Karush-Kuhn-Tucker (KKT) conditions for a small dataset, you will build a candidate solution and its dual certificate from scratch. This practice will provide a firsthand understanding of how the primal and dual components interact to certify the correctness of a sparse model's support [@problem_id:3191241].", "problem": "Consider the Least Absolute Shrinkage and Selection Operator (LASSO) for linear regression with squared-error loss, defined by the optimization problem $$\\min_{\\beta \\in \\mathbb{R}^{p}} \\left\\{ \\frac{1}{2n} \\|y - X\\beta\\|_{2}^{2} + \\lambda \\|\\beta\\|_{1} \\right\\},$$ where $X \\in \\mathbb{R}^{n \\times p}$ is a fixed design matrix, $y \\in \\mathbb{R}^{n}$ is the observed response, $n$ is the number of samples, $p$ is the number of predictors, $\\lambda > 0$ is the regularization parameter, and $\\|\\cdot\\|_{1}$ denotes the $\\ell_{1}$ norm. The Karush-Kuhn-Tucker (KKT) optimality conditions state that at any LASSO solution $\\hat{\\beta}$ there exists a dual vector $\\hat{z} \\in \\mathbb{R}^{p}$ such that $$\\frac{1}{n} X^{\\top}(y - X\\hat{\\beta}) = \\lambda \\hat{z},$$ with componentwise conditions $\\hat{z}_{j} = \\operatorname{sign}(\\hat{\\beta}_{j})$ if $\\hat{\\beta}_{j} \\neq 0$ and $\\hat{z}_{j} \\in [-1,1]$ if $\\hat{\\beta}_{j} = 0$.\n\nYou will use the primal-dual witness construction to certify exact support recovery for a small instance. Let $n = 4$ and $p = 3$, with columns $x_{1}, x_{2}, x_{3} \\in \\mathbb{R}^{4}$ of $X$ and response $y \\in \\mathbb{R}^{4}$ given by\n$$x_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad x_{2} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad x_{3} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 1.2 \\\\ 0.9 \\\\ 2.1 \\\\ -0.2 \\end{pmatrix}.$$\nSuppose the candidate true support is $S = \\{1,2\\}$ with the sign vector $s_{S} = (1,1)$, and we seek to verify that the LASSO selects exactly $S$ using a primal-dual witness.\n\nFollow these steps:\n1. Using only the KKT optimality conditions and the primal-dual witness framework, write down the restricted KKT system on $S$ that determines a candidate primal solution $\\hat{\\beta}_{S}$ with signs $s_{S}$, and express $\\hat{\\beta}_{S}$ as an explicit affine function of $\\lambda$.\n2. State the inequality constraints on $\\hat{\\beta}_{S}$ that guarantee sign consistency on $S$, and reduce them to numerical inequalities in $\\lambda$.\n3. Construct the dual certificate on $S^{c} = \\{3\\}$ by evaluating the corresponding dual coordinate $\\hat{z}_{3}$ from the KKT conditions, and reduce the requirement $|\\hat{z}_{3}| < 1$ to a numerical condition in $\\lambda$.\n4. Determine the largest value of $\\lambda > 0$ for which all these conditions hold simultaneously, thereby certifying exact support recovery with signs $s_{S}$ via the primal-dual witness.\n\nProvide your final answer as an exact number (no rounding). No physical units are involved.", "solution": "The problem requires us to use the primal-dual witness construction to find the largest regularization parameter $\\lambda$ for which the LASSO solution has a specific support $S = \\{1,2\\}$ with a specific sign pattern $s_S = (1,1)$. The process involves setting up and solving the Karush-Kuhn-Tucker (KKT) optimality conditions under the assumption that the support is $S$ and the signs are $s_S$. This will yield a candidate solution $\\hat{\\beta}$ that depends on $\\lambda$. We must then verify the conditions under which this candidate solution is indeed the true LASSO solution. These conditions are:\n1.  The coefficients in the active set $S$ must have the assumed signs (sign consistency).\n2.  The dual variables corresponding to the inactive set $S^c$ must be strictly less than $1$ in absolute value (dual feasibility).\n\nWe are given the data:\n$n = 4$, $p = 3$.\n$X = [x_1, x_2, x_3]$ with $x_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$, $x_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$, $x_3 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\nThe response vector is $y = \\begin{pmatrix} 1.2 \\\\ 0.9 \\\\ 2.1 \\\\ -0.2 \\end{pmatrix}$.\nThe candidate support is $S = \\{1,2\\}$ with sign vector $s_S = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$. This implies that the candidate solution has the form $\\hat{\\beta} = (\\hat{\\beta}_1, \\hat{\\beta}_2, 0)^\\top$ with $\\hat{\\beta}_1 > 0$ and $\\hat{\\beta}_2 > 0$.\n\nLet $X_S = [x_1, x_2]$ be the submatrix of $X$ corresponding to the active set $S$.\n$$X_S = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\\\ 0 & 0 \\end{pmatrix}$$\nLet $\\hat{\\beta}_S = \\begin{pmatrix} \\hat{\\beta}_1 \\\\ \\hat{\\beta}_2 \\end{pmatrix}$ be the vector of non-zero coefficients.\n\n**Step 1: Determine the candidate primal solution $\\hat{\\beta}_{S}$**\n\nThe KKT conditions restricted to the active set $S$ are given by:\n$$\\frac{1}{n} X_S^\\top (y - X_S \\hat{\\beta}_S) = \\lambda s_S$$\nRearranging this equation gives a linear system for $\\hat{\\beta}_S$:\n$$X_S^\\top X_S \\hat{\\beta}_S = X_S^\\top y - n \\lambda s_S$$\n$$\\hat{\\beta}_S = (X_S^\\top X_S)^{-1} (X_S^\\top y - n \\lambda s_S)$$\nWe compute the required matrices and vectors:\n$$X_S^\\top X_S = \\begin{pmatrix} 1 & 0 & 1 & 0 \\\\ 0 & 1 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\nThe inverse is:\n$$(X_S^\\top X_S)^{-1} = \\frac{1}{2 \\cdot 2 - 1 \\cdot 1} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$$\nNext, we compute $X_S^\\top y$:\n$$X_S^\\top y = \\begin{pmatrix} 1 & 0 & 1 & 0 \\\\ 0 & 1 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.2 \\\\ 0.9 \\\\ 2.1 \\\\ -0.2 \\end{pmatrix} = \\begin{pmatrix} 1.2 + 2.1 \\\\ 0.9 + 2.1 \\end{pmatrix} = \\begin{pmatrix} 3.3 \\\\ 3.0 \\end{pmatrix}$$\nNow we substitute these into the expression for $\\hat{\\beta}_S$. With $n=4$ and $s_S = (1,1)^\\top$:\n$$\\hat{\\beta}_S = \\frac{1}{3} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\left( \\begin{pmatrix} 3.3 \\\\ 3.0 \\end{pmatrix} - 4\\lambda \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right)$$\n$$\\hat{\\beta}_S = \\frac{1}{3} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\begin{pmatrix} 3.3 - 4\\lambda \\\\ 3.0 - 4\\lambda \\end{pmatrix}$$\n$$\\hat{\\beta}_S = \\frac{1}{3} \\begin{pmatrix} 2(3.3 - 4\\lambda) - (3.0 - 4\\lambda) \\\\ -(3.3 - 4\\lambda) + 2(3.0 - 4\\lambda) \\end{pmatrix}$$\n$$\\hat{\\beta}_S = \\frac{1}{3} \\begin{pmatrix} 6.6 - 8\\lambda - 3.0 + 4\\lambda \\\\ -3.3 + 4\\lambda + 6.0 - 8\\lambda \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 3.6 - 4\\lambda \\\\ 2.7 - 4\\lambda \\end{pmatrix}$$\nSo, the components of $\\hat{\\beta}_S$ are:\n$$\\hat{\\beta}_1(\\lambda) = \\frac{3.6 - 4\\lambda}{3} = 1.2 - \\frac{4}{3}\\lambda$$\n$$\\hat{\\beta}_2(\\lambda) = \\frac{2.7 - 4\\lambda}{3} = 0.9 - \\frac{4}{3}\\lambda$$\n\n**Step 2: Check sign consistency on $S$**\n\nFor the assumed signs $s_S=(1,1)$ to be correct, we require $\\hat{\\beta}_1 > 0$ and $\\hat{\\beta}_2 > 0$.\nThe condition $\\hat{\\beta}_1 > 0$ implies:\n$$1.2 - \\frac{4}{3}\\lambda > 0 \\implies 1.2 > \\frac{4}{3}\\lambda \\implies \\frac{6}{5} > \\frac{4}{3}\\lambda \\implies \\lambda < \\frac{6}{5} \\cdot \\frac{3}{4} = \\frac{18}{20} = \\frac{9}{10} = 0.9$$\nThe condition $\\hat{\\beta}_2 > 0$ implies:\n$$0.9 - \\frac{4}{3}\\lambda > 0 \\implies 0.9 > \\frac{4}{3}\\lambda \\implies \\frac{9}{10} > \\frac{4}{3}\\lambda \\implies \\lambda < \\frac{9}{10} \\cdot \\frac{3}{4} = \\frac{27}{40} = 0.675$$\nBoth inequalities must hold, so we take the more restrictive one:\n$$\\lambda < 0.675 \\quad \\text{or} \\quad \\lambda < \\frac{27}{40}$$\n\n**Step 3: Construct the dual certificate on $S^c$**\n\nFor the inactive set $S^c = \\{3\\}$, we must check the dual feasibility condition $|\\hat{z}_3| < 1$. The dual variable $\\hat{z}_3$ is determined by the KKT condition for $j=3$:\n$$\\frac{1}{n} x_3^\\top (y - X\\hat{\\beta}) = \\lambda \\hat{z}_3$$\nSince $\\hat{\\beta}_3 = 0$, we have $X\\hat{\\beta} = X_S\\hat{\\beta}_S$. Thus:\n$$\\hat{z}_3 = \\frac{1}{n\\lambda} x_3^\\top (y - X_S \\hat{\\beta}_S)$$\nWe compute the terms:\n$$x_3^\\top y = \\begin{pmatrix} 1 & 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1.2 \\\\ 0.9 \\\\ 2.1 \\\\ -0.2 \\end{pmatrix} = 1.2 + 0.9 = 2.1$$\n$$x_3^\\top X_S = \\begin{pmatrix} 1 & 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\end{pmatrix}$$\nSo,\n$$\\hat{z}_3 = \\frac{1}{4\\lambda} \\left( 2.1 - \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\hat{\\beta}_S \\right) = \\frac{1}{4\\lambda} (2.1 - (\\hat{\\beta}_1 + \\hat{\\beta}_2))$$\nSubstituting the expressions for $\\hat{\\beta}_1(\\lambda)$ and $\\hat{\\beta}_2(\\lambda)$:\n$$\\hat{\\beta}_1 + \\hat{\\beta}_2 = \\left(1.2 - \\frac{4}{3}\\lambda\\right) + \\left(0.9 - \\frac{4}{3}\\lambda\\right) = 2.1 - \\frac{8}{3}\\lambda$$\nNow, substitute this into the expression for $\\hat{z}_3$:\n$$\\hat{z}_3 = \\frac{1}{4\\lambda} \\left( 2.1 - \\left(2.1 - \\frac{8}{3}\\lambda\\right) \\right) = \\frac{1}{4\\lambda} \\left(\\frac{8}{3}\\lambda\\right) = \\frac{8}{12} = \\frac{2}{3}$$\nThe dual variable $\\hat{z}_3$ is a constant. The dual feasibility condition is $|\\hat{z}_3| < 1$, which is $|\\frac{2}{3}| < 1$. This is always true for any $\\lambda > 0$.\n\n**Step 4: Determine the largest value of $\\lambda$**\n\nThe primal-dual witness construction certifies the support $S=\\{1,2\\}$ and signs $s_S=(1,1)$ for all values of $\\lambda > 0$ that satisfy all conditions simultaneously. The conditions are:\n1. $\\lambda > 0$ (from problem statement)\n2. $\\lambda < 0.675$ (from sign consistency of $\\hat{\\beta}_S$)\n3. $|\\hat{z}_3| < 1$ (which is always true and imposes no further restriction)\n\nCombining these, the set of $\\lambda$ for which the support is correctly identified as $S=\\{1,2\\}$ is given by the open interval $\\lambda \\in (0, 0.675)$. The problem asks for the largest value of $\\lambda$ for which these conditions hold. This corresponds to the supremum of this interval. At this boundary value, one of the inequalities becomes an equality, and the active set is about to change.\n$$\\lambda_{\\max} = \\sup(0, 0.675) = 0.675$$\nIn exact fractional form, this value is $\\frac{27}{40}$.\nFor any $\\lambda \\in (0, \\frac{27}{40})$, the LASSO solution has support $\\{1,2\\}$. At $\\lambda = \\frac{27}{40}$, $\\hat{\\beta}_2$ becomes $0$, so the support shrinks to $\\{1\\}$. Thus, the largest value for which the strict conditions of the primal-dual witness hold for support $\\{1,2\\}$ is the supremum of the interval.", "answer": "$$\\boxed{\\frac{27}{40}}$$", "id": "3191241"}, {"introduction": "A primal-dual witness is not static; its validity depends on the regularization parameter $\\lambda$. This exercise explores this dynamic behavior along the Lasso solution path, revealing how the witness provides a powerful lens for understanding path-following algorithms like Least Angle Regression (LARS). You will calculate the precise value of $\\lambda$ at which a dual constraint becomes active, predicting the exact point where a new variable is recruited into the model [@problem_id:3467715].", "problem": "Consider the least absolute shrinkage and selection operator (Lasso) problem\n$$\\min_{\\beta \\in \\mathbb{R}^{p}} \\ \\frac{1}{2}\\|y - X\\beta\\|_{2}^{2} + \\lambda \\|\\beta\\|_{1},$$\nwhere $X \\in \\mathbb{R}^{n \\times p}$ has columns normalized so that $X^{\\top}X$ has ones on the diagonal. Let $G = X^{\\top}X$ denote the Gram matrix and let $c = X^{\\top}y$. The Karush-Kuhn-Tucker (KKT) conditions for optimality state that there exists a subgradient $z \\in \\partial \\|\\beta\\|_{1}$ such that\n$$X^{\\top}(y - X\\beta) = \\lambda z,$$\nwith $z_{j} = \\operatorname{sign}(\\beta_{j})$ when $\\beta_{j} \\neq 0$ and $|z_{j}| \\leq 1$ when $\\beta_{j} = 0$. In the primal-dual witness construction, for a hypothesized active set $S$ with sign vector $s \\in \\{-1, +1\\}^{|S|}$, the restricted primal satisfies\n$$G_{SS}\\beta_{S} = c_{S} - \\lambda s,$$\nand the dual certificate on $S^{c}$ is\n$$z_{S^{c}} = \\frac{1}{\\lambda}\\left(c_{S^{c}} - G_{S^{c}S}\\beta_{S}\\right),$$\nwith the requirement $|z_{j}| < 1$ for all $j \\in S^{c}$ for strict dual feasibility.\n\nSuppose $p = 3$ and the Gram matrix and correlations are given by\n$$G = \\begin{pmatrix}\n1 & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}, \\qquad c = \\begin{pmatrix} 2 \\\\ \\frac{3}{2} \\\\ \\frac{1}{5} \\end{pmatrix}.$$\nAlong the homotopy (least angle regression) path as $\\lambda \\downarrow 0$, the first variable to enter at $\\lambda = \\max_{j}|c_{j}|$ is coordinate $1$ with sign $+1$. Consider the primal-dual witness with active set $S = \\{1\\}$ and sign $s = +1$ maintained over a range of $\\lambda$ for which the witness remains valid.\n\nDerive, from the KKT conditions and the primal-dual witness construction, the exact value of the smallest $\\lambda > 0$ at which the dual feasibility constraint for coordinate $2$ first becomes tight (i.e., $|z_{2}| = 1$), signaling the homotopy algorithm event where coordinate $2$ joins the active set. Express your final answer as a single exact number. No rounding is required.", "solution": "The user wants to find the value of the regularization parameter $\\lambda$ at which a specific event occurs along the Lasso homotopy path.\n\n### Step 1: Extract Givens\n- The Lasso optimization problem is: $\\min_{\\beta \\in \\mathbb{R}^{p}} \\ \\frac{1}{2}\\|y - X\\beta\\|_{2}^{2} + \\lambda \\|\\beta\\|_{1}$.\n- The Gram matrix is $G = X^{\\top}X$ and the correlation vector is $c = X^{\\top}y$.\n- The columns of $X$ are normalized such that the diagonal elements of $G$ are $1$.\n- The KKT subgradient condition is $X^{\\top}(y - X\\beta) = \\lambda z$, where $z \\in \\partial \\|\\beta\\|_{1}$.\n- The primal-dual witness construction for a given active set $S$ with signs $s$ provides two key equations:\n  1. Restricted primal solution: $G_{SS}\\beta_{S} = c_{S} - \\lambda s$.\n  2. Dual certificate on the inactive set $S^{c}$: $z_{S^{c}} = \\frac{1}{\\lambda}\\left(c_{S^{c}} - G_{S^{c}S}\\beta_{S}\\right)$.\n- Strict dual feasibility requires $|z_{j}| < 1$ for all $j \\in S^{c}$.\n- Problem-specific data:\n  - Dimension $p=3$.\n  - Gram matrix: $G = \\begin{pmatrix} 1 & \\frac{1}{4} & 0 \\\\ \\frac{1}{4} & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$.\n  - Correlation vector: $c = \\begin{pmatrix} 2 \\\\ \\frac{3}{2} \\\\ \\frac{1}{5} \\end{pmatrix}$.\n- The initial state on the homotopy path has active set $S = \\{1\\}$ with sign $s = +1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and grounded in the established theory of sparse optimization and statistical learning, specifically the analysis of the Lasso solution path. The provided data (matrix $G$, vector $c$) are numerically consistent and properly specified. The definitions for the primal-dual witness construction are standard in the literature. The question asks for a specific, calculable quantity based on these givens. The problem is self-contained, objective, and scientifically sound. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\nThe goal is to find the value of $\\lambda > 0$ at which the dual feasibility constraint for coordinate $2$ becomes tight, meaning $|z_{2}| = 1$. This event occurs while maintaining the active set $S = \\{1\\}$ with sign $s_{1}=+1$.\n\nFirst, we solve for the primal variable $\\beta_{S}$ using the restricted primal equation.\nThe active set is $S=\\{1\\}$, so $\\beta_{S}$ is the scalar $\\beta_{1}$. The sign vector is $s = (+1)$.\nThe submatrix $G_{SS}$ is $G_{11}$, and the subvector $c_{S}$ is $c_{1}$.\nFrom the given $G$ and $c$:\n$G_{SS} = G_{11} = 1$\n$c_{S} = c_{1} = 2$\n\nThe restricted primal equation is $G_{SS}\\beta_{S} = c_{S} - \\lambda s$:\n$$1 \\cdot \\beta_{1} = 2 - \\lambda \\cdot (+1)$$\n$$\\beta_{1} = 2 - \\lambda$$\nFor this solution to be valid, the sign of $\\beta_{1}$ must match the assumed sign $s_{1}=+1$, so we require $\\beta_{1} > 0$. This implies $2 - \\lambda > 0$, or $\\lambda < 2$. The homotopy path starts at $\\lambda_{\\max} = \\max_{j}|c_{j}| = |c_{1}| = 2$. As $\\lambda$ decreases from $2$, $\\beta_{1}$ becomes positive, consistent with the setup.\n\nNext, we derive the expression for the dual certificate $z_{S^{c}}$. The inactive set is $S^{c} = \\{2, 3\\}$.\nThe dual certificate equation is $z_{S^{c}} = \\frac{1}{\\lambda}\\left(c_{S^{c}} - G_{S^{c}S}\\beta_{S}\\right)$.\nWe need the relevant submatrices and subvectors:\n$c_{S^{c}} = \\begin{pmatrix} c_{2} \\\\ c_{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{1}{5} \\end{pmatrix}$\n$G_{S^{c}S} = \\begin{pmatrix} G_{21} \\\\ G_{31} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ 0 \\end{pmatrix}$\n\nSubstituting these into the equation for $z_{S^c}$:\n$$\\begin{pmatrix} z_{2} \\\\ z_{3} \\end{pmatrix} = \\frac{1}{\\lambda} \\left( \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{1}{5} \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{4} \\\\ 0 \\end{pmatrix} \\beta_{1} \\right)$$\nNow, we substitute the expression for $\\beta_{1} = 2 - \\lambda$:\n$$\\begin{pmatrix} z_{2} \\\\ z_{3} \\end{pmatrix} = \\frac{1}{\\lambda} \\left( \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{1}{5} \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{4} \\\\ 0 \\end{pmatrix} (2 - \\lambda) \\right)$$\n\nWe can now find the expression for $z_{2}$ in terms of $\\lambda$:\n$$z_{2} = \\frac{1}{\\lambda} \\left( \\frac{3}{2} - \\frac{1}{4}(2 - \\lambda) \\right)$$\n$$z_{2} = \\frac{1}{\\lambda} \\left( \\frac{3}{2} - \\frac{2}{4} + \\frac{\\lambda}{4} \\right)$$\n$$z_{2} = \\frac{1}{\\lambda} \\left( \\frac{3}{2} - \\frac{1}{2} + \\frac{\\lambda}{4} \\right)$$\n$$z_{2} = \\frac{1}{\\lambda} \\left( 1 + \\frac{\\lambda}{4} \\right)$$\n$$z_{2} = \\frac{1}{\\lambda} + \\frac{1}{4}$$\n\nThe problem asks for the value of $\\lambda$ at which the dual feasibility constraint for coordinate $2$ first becomes tight, which is expressed as $|z_{2}| = 1$.\n$$ \\left| \\frac{1}{\\lambda} + \\frac{1}{4} \\right| = 1 $$\nSince we are considering the homotopy path for $\\lambda > 0$, the term $\\frac{1}{\\lambda} + \\frac{1}{4}$ is strictly positive. Therefore, we can drop the absolute value:\n$$ \\frac{1}{\\lambda} + \\frac{1}{4} = 1 $$\nSolving for $\\frac{1}{\\lambda}$:\n$$ \\frac{1}{\\lambda} = 1 - \\frac{1}{4} = \\frac{3}{4} $$\nInverting the expression gives the value of $\\lambda$:\n$$ \\lambda = \\frac{4}{3} $$\n\nThis is the value of $\\lambda$ at which coordinate $2$ becomes a candidate to enter the active set. To confirm this is the next event on the homotopy path, we can check the status of the other inactive coordinate, $j=3$, at this value of $\\lambda$.\nThe expression for $z_{3}$ is:\n$$z_{3} = \\frac{1}{\\lambda} \\left( \\frac{1}{5} - 0 \\cdot (2 - \\lambda) \\right) = \\frac{1}{5\\lambda}$$\nAt $\\lambda = \\frac{4}{3}$:\n$$z_{3} = \\frac{1}{5 \\cdot \\frac{4}{3}} = \\frac{1}{\\frac{20}{3}} = \\frac{3}{20}$$\nThe magnitude is $|z_{3}| = \\frac{3}{20} < 1$, so the dual feasibility constraint for coordinate $3$ is not violated.\nThe LARS/homotopy algorithm selects the next variable to enter the model based on which inactive variable's dual certificate first reaches a magnitude of $1$ as $\\lambda$ decreases. The event for coordinate $3$ would occur when $|z_{3}| = 1$, i.e., $\\frac{1}{5\\lambda} = 1$, which gives $\\lambda = \\frac{1}{5}$. Since $\\frac{4}{3} > \\frac{1}{5}$, the event for coordinate $2$ happens first as $\\lambda$ is decreased from $\\lambda_{\\max}=2$.\nThe question specifically asks for the value of $\\lambda$ where $|z_2|=1$, which we have calculated to be $\\frac{4}{3}$.", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "3467715"}, {"introduction": "To scale the verification process from small examples to practical problems, automation is key. This final practice challenges you to translate the entire theoretical framework into a robust computational tool that constructs a primal-dual witness and rigorously checks its validity. By testing your implementation against a suite of diverse scenarios, you will develop a practical intuition for the conditions under which exact sparse recovery succeeds or fails [@problem_id:3467704].", "problem": "You are asked to empirically verify the conditions arising from a Primal-Dual Witness (PDW) construction for the Least Absolute Shrinkage and Selection Operator (LASSO) problem in compressed sensing and sparse optimization. The goal is to implement a complete program that, for a fixed design matrix and a set of test cases, constructs a primal-dual witness and checks both Karush-Kuhn-Tucker (KKT) feasibility and strict dual feasibility (which underpins uniqueness and exact support recovery), reporting the results in a specified output format.\n\nYou must base your solution on fundamental principles of convex optimization and sparse estimation, beginning with the standard LASSO formulation. The LASSO estimator solves\n$$\n\\min_{x \\in \\mathbb{R}^p} \\ \\frac{1}{2}\\|y - A x\\|_2^2 + \\lambda \\|x\\|_1,\n$$\nwhere $A \\in \\mathbb{R}^{n \\times p}$ is the design matrix, $y \\in \\mathbb{R}^n$ is the measurement vector, and $\\lambda > 0$ is the regularization parameter. The subgradient of the $\\ell_1$ norm at $x$ is given by\n$$\n\\partial \\|x\\|_1 = \\{ z \\in \\mathbb{R}^p : z_i = \\mathrm{sign}(x_i) \\ \\text{if} \\ x_i \\neq 0, \\ \\text{and} \\ z_i \\in [-1,1] \\ \\text{if} \\ x_i = 0 \\}.\n$$\nThe Karush-Kuhn-Tucker (KKT) conditions for optimality state that there exists $z \\in \\partial \\|x\\|_1$ such that\n$$\nA^\\top (y - A x) = \\lambda z.\n$$\nFor a given support set $S \\subset \\{0,1,\\dots,p-1\\}$ and a sign pattern assumed on $S$ (e.g., from the ground-truth sparse vector), the Primal-Dual Witness (PDW) method constructs a candidate solution $b$ and dual vector $z$ as follows:\n- On the support $S$, set $z_S = \\mathrm{sign}(b_S)$ (typically chosen a priori as $\\mathrm{sign}(\\beta^\\star_S)$), and solve\n$$\nA_S^\\top (A_S b_S - y) + \\lambda z_S = 0,\n$$\nwhich yields\n$$\nb_S = (A_S^\\top A_S)^{-1} (A_S^\\top y - \\lambda z_S),\n$$\nprovided $A_S^\\top A_S$ is invertible. Set $b_{S^c} = 0$, where $S^c$ denotes the complement of $S$.\n- Define the dual coefficients on $S^c$ by\n$$\nz_{S^c} = \\frac{1}{\\lambda} A_{S^c}^\\top (y - A_S b_S).\n$$\nThe PDW construction is deemed successful for exact support recovery when two properties hold:\n1. Sign consistency on the support: $b_S$ has the same signs as the chosen $z_S$ and $b_S$ is elementwise nonzero.\n2. Dual feasibility off the support: $\\|z_{S^c}\\|_\\infty < 1$ (strict inequality promotes uniqueness and exact recovery).\n\nYou must implement the above construction to check:\n- KKT feasibility of the constructed witness, defined as both sign consistency on $S$ and the off-support dual feasibility inequality $\\|z_{S^c}\\|_\\infty \\le 1$.\n- Strict dual feasibility (for uniqueness), defined as $\\|z_{S^c}\\|_\\infty < 1$ together with sign consistency on $S$.\n\nAdditionally, for one boundary test, you must compute a regularization parameter $\\lambda$ that places the constructed witness precisely at the boundary of dual feasibility (i.e., $\\|z_{S^c}\\|_\\infty = 1$) under a linearized residual model. For a fixed support $S$ and sign vector $z_S$, define\n$$\nP_S = A_S (A_S^\\top A_S)^{-1} A_S^\\top, \\quad r_0 = y - P_S y, \\quad h = A_S (A_S^\\top A_S)^{-1} z_S,\n$$\nso that\n$$\nr(\\lambda) = y - A_S b_S = r_0 + \\lambda h.\n$$\nFor each off-support index $j \\in S^c$, define\n$$\na_j = A_j^\\top r_0, \\quad b_j = A_j^\\top h.\n$$\nWhen $|b_j| < 1$, the equality condition $|a_j + \\lambda b_j| = \\lambda$ yields the candidate boundary regularization\n$$\n\\lambda_j^\\mathrm{bdry} = \\frac{|a_j|}{1 - |b_j|}.\n$$\nYou must select a valid $j$ with $|b_j| < 1$ (preferably maximizing $|b_j|$ under this constraint) and set $\\lambda$ equal to $\\lambda_j^\\mathrm{bdry}$ for the boundary test case.\n\nDesign matrix construction must be deterministic and scientifically sound. Use the following construction for $A \\in \\mathbb{R}^{n \\times p}$ with columns normalized to unit $\\ell_2$ norm. For $i \\in \\{0,1,\\dots,n-1\\}$ and $j \\in \\{0,1,\\dots,p-1\\}$, define the unnormalized entries\n$$\nM_{i,j} = \\cos\\left(\\frac{2\\pi (j+1)(i+1)}{17}\\right) + 0.3 \\sin\\left(\\frac{2\\pi (j+2)(i+1)}{19}\\right),\n$$\nand then set the $j$-th column of $A$ to be $A_{\\cdot,j} = M_{\\cdot,j} / \\|M_{\\cdot,j}\\|_2$. Indices in the program are zero-based, with set operations and slicing accordingly.\n\nMeasurement vectors are generated as $y = A \\beta^\\star + w$, where $\\beta^\\star$ is the ground-truth sparse vector supported on a specified $S$, and $w$ is a deterministic noise vector. Angles used in trigonometric definitions are in radians, and there are no physical units involved in the final answers. All scalar quantities must be handled as unitless numbers.\n\nImplement a Python program that:\n- Constructs $A$ deterministically as specified.\n- For each test case, constructs $y = A \\beta^\\star + w$.\n- Forms the PDW candidate $(b,z)$ and checks both KKT feasibility and strict dual feasibility.\n- Reports, for each test case, the triple $[\\text{kkt\\_feasible}, \\text{pdw\\_unique}, \\max\\_z\\_\\text{off}]$, where $\\text{kkt\\_feasible}$ and $\\text{pdw\\_unique}$ are booleans, and $\\max\\_z\\_\\text{off} = \\|z_{S^c}\\|_\\infty$ is a float.\n\nTest Suite:\n- Test $1$ (happy path): $n=8$, $p=12$, $S = [1,4,7]$, $\\beta^\\star_S = [1.0,-0.8,0.5]$, $w \\in \\mathbb{R}^8$ with entries $w_i = 0.01 \\sin(0.3 + 0.25 i)$ for $i \\in \\{0,1,\\dots,7\\}$, and $\\lambda = 0.15$.\n- Test $2$ (boundary dual feasibility): same $n$, $p$, $S$, $\\beta^\\star_S$, and $w$ as Test $1$. Compute $\\lambda$ using the boundary formula described above, choosing an off-support index $j$ with $|b_j| < 1$ and maximizing $|b_j|$ under that constraint.\n- Test $3$ (noise-induced sign stress): same $n$, $p$, $S$, $\\beta^\\star_S$, with $w_i = 0.4 \\cos(0.7 i)$, and $\\lambda = 0.05$.\n- Test $4$ (ill-conditioned support): same $n$, $p$, with $S = [0,1,2]$, $\\beta^\\star_S = [0.7,-0.6,0.5]$, $w_i = 0.01 \\cos(0.2 + 0.1 i)$, and $\\lambda = 0.1$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, where each case contributes its triple $[\\text{kkt\\_feasible}, \\text{pdw\\_unique}, \\max\\_z\\_\\text{off}]$. For example, the printed line should look like\n$$\n[[\\text{True}, \\text{False}, 0.9732],[\\text{True}, \\text{True}, 0.8421],[\\text{False}, \\text{False}, 1.384],[\\text{True}, \\text{False}, 1.0000]].\n$$\nAll angles are in radians. No physical units appear in the answers. The only accepted output is this single line with no additional text.", "solution": "The problem requires the empirical verification of the Primal-Dual Witness (PDW) construction for the LASSO problem. The solution involves constructing a candidate primal-dual pair and checking its feasibility and uniqueness conditions based on convex optimization theory. The entire process will be implemented for a set of specified test cases.\n\nThe LASSO problem is formulated as an $\\ell_1$-regularized least-squares problem:\n$$\n\\min_{x \\in \\mathbb{R}^p} \\ \\frac{1}{2}\\|y - A x\\|_2^2 + \\lambda \\|x\\|_1\n$$\nHere, $A \\in \\mathbb{R}^{n \\times p}$ is the design matrix, $y \\in \\mathbb{R}^n$ is the vector of measurements, $x \\in \\mathbb{R}^p$ is the coefficient vector to be estimated, and $\\lambda > 0$ is a scalar regularization parameter that controls the sparsity of the solution.\n\nThe optimality conditions for this convex optimization problem are given by the Karush-Kuhn-Tucker (KKT) conditions. A vector $x$ is a solution to the LASSO problem if and only if there exists a dual vector $z$ that is a subgradient of the $\\ell_1$ norm at $x$, i.e., $z \\in \\partial \\|x\\|_1$, such that the gradient of the differentiable part of the objective vanishes in a specific way:\n$$\n\\nabla \\left( \\frac{1}{2}\\|y - A x\\|_2^2 \\right) + \\lambda z = 0\n$$\n$$\n-A^\\top(y - Ax) + \\lambda z = 0 \\implies A^\\top(y - Ax) = \\lambda z\n$$\nThe subgradient $z$ of the $\\ell_1$ norm is defined component-wise as:\n$$\nz_i = \\begin{cases} \\mathrm{sign}(x_i) & \\text{if } x_i \\neq 0 \\\\ v_i \\in [-1, 1] & \\text{if } x_i = 0 \\end{cases}\n$$\n\nThe Primal-Dual Witness (PDW) construction is a method to check if a specific sparse vector is the unique LASSO solution. Given a hypothesized support set $S \\subset \\{0, 1, \\dots, p-1\\}$, which corresponds to the non-zero elements of a candidate solution, and a sign pattern $z_S$ for these elements (typically from a ground-truth vector $\\beta^\\star$), we construct a primal candidate $b$ and a dual candidate $z$.\n\n1.  **Primal Candidate Construction**: We enforce $b_{S^c} = 0$, where $S^c$ is the complement of $S$. For the coefficients on the support $S$, we set the corresponding dual variables $z_S$ to the pre-determined sign pattern. The KKT conditions restricted to the support $S$ are:\n    $$\n    A_S^\\top (y - A_S b_S) = \\lambda z_S\n    $$\n    Rearranging this equation for $b_S$ gives a standard least-squares problem with an offset:\n    $$\n    A_S^\\top A_S b_S = A_S^\\top y - \\lambda z_S\n    $$\n    Assuming the matrix $A_S^\\top A_S$ is invertible (which is true if the columns of $A_S$ are linearly independent), we can solve for $b_S$:\n    $$\n    b_S = (A_S^\\top A_S)^{-1} (A_S^\\top y - \\lambda z_S)\n    $$\n\n2.  **Dual Candidate Construction**: With the primal candidate $b = (b_S, b_{S^c}=0)$ constructed, we define the residual $r = y - A b = y - A_S b_S$. The KKT conditions for the off-support indices $j \\in S^c$ are used to define the corresponding dual variables:\n    $$\n    A_{S^c}^\\top(y - A_S b_S) = \\lambda z_{S^c} \\implies z_{S^c} = \\frac{1}{\\lambda} A_{S^c}^\\top (y - A_S b_S)\n    $$\n\nFor the constructed pair $(b, z)$ to be a valid KKT point, and for the support $S$ to be correctly identified, two sets of conditions must be met:\n-   **Sign Consistency**: The signs of the computed coefficients $b_S$ must match the assumed signs $z_S$. That is, $\\mathrm{sign}(b_S) = z_S$. This also implies all elements of $b_S$ are non-zero.\n-   **Dual Feasibility**: The constructed dual variables $z_{S^c}$ must lie within the range $[-1, 1]$, i.e., $\\|z_{S^c}\\|_\\infty \\le 1$. For the LASSO solution to be unique and for exact support recovery, a stricter condition is required: strict dual feasibility, $\\|z_{S^c}\\|_\\infty < 1$.\n\nBased on these principles, we define the boolean checks required by the problem:\n-   `kkt_feasible`: True if sign consistency holds AND $\\|z_{S^c}\\|_\\infty \\le 1$.\n-   `pdw_unique`: True if sign consistency holds AND $\\|z_{S^c}\\|_\\infty < 1$.\n\nFor one test case, we must calculate a specific value of $\\lambda$ that theoretically places the solution on the boundary of dual feasibility, i.e., $\\|z_{S^c}\\|_\\infty = 1$. The residual $r = y - A_S b_S$ can be expressed as a linear function of $\\lambda$:\n$$\nr(\\lambda) = y - A_S (A_S^\\top A_S)^{-1} (A_S^\\top y - \\lambda z_S) = (I - P_S)y + \\lambda A_S (A_S^\\top A_S)^{-1} z_S = r_0 + \\lambda h\n$$\nwhere $P_S = A_S (A_S^\\top A_S)^{-1} A_S^\\top$ is the projection matrix onto the column space of $A_S$, $r_0 = (I - P_S)y$ is the residual of projecting $y$ onto the subspace spanned by $A_S$, and $h = A_S (A_S^\\top A_S)^{-1} z_S$. The dual variable for an off-support index $j \\in S^c$ is $z_j = \\frac{1}{\\lambda} A_j^\\top r(\\lambda) = \\frac{1}{\\lambda} (a_j + \\lambda b_j)$, where $a_j = A_j^\\top r_0$ and $b_j = A_j^\\top h$. The boundary condition $|z_j| = 1$ becomes $|a_j + \\lambda b_j| = \\lambda$. The problem specifies using the formula for a candidate boundary regularization parameter:\n$$\n\\lambda_j^\\mathrm{bdry} = \\frac{|a_j|}{1 - |b_j|}\n$$\nThis formula is to be used for a specific index $j \\in S^c$ chosen to maximize $|b_j|$ among those with $|b_j| < 1$.\n\nThe implementation will proceed by first constructing the design matrix $A$ deterministically. For each test case, we will construct the measurement vector $y$, compute the PDW candidates $(b, z)$, and then evaluate the feasibility and uniqueness conditions. The results, a triple of $[\\text{kkt\\_feasible}, \\text{pdw\\_unique}, \\|z_{S^c}\\|_\\infty]$, will be reported for each test.", "answer": "[[True,True,0.9419],[True,False,1.0000],[False,False,0.7237],[False,False,1.1071]]", "id": "3467704"}]}