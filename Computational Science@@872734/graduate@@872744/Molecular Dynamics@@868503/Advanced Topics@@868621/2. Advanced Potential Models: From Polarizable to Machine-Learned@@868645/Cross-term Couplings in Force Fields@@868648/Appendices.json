{"hands_on_practices": [{"introduction": "This first exercise provides a tangible calculation of the energy arising from a stretch-bend cross-term. By considering a specific distorted geometry of a water-like molecule, you will compute the energetic penalty associated with the coupled motion of bond stretching and angle bending [@problem_id:3406790]. This practice not only solidifies the meaning of the coupling constant $k_{r\\theta}$ but also prompts a connection to experimental results by considering how such couplings influence the intensities of infrared combination bands.", "problem": "A triatomic molecule with two equivalent bonds and one bond angle is modeled by a classical molecular mechanics force field. Near the equilibrium geometry, the potential energy in internal coordinates admits a second-order Taylor expansion in deviations from equilibrium, and, by symmetry, contains bilinear cross-term couplings between bond stretches and the bond angle. Consider a water-like molecule with two oxygen–hydrogen bond lengths $r_{\\mathrm{OH1}}$ and $r_{\\mathrm{OH2}}$ and the hydrogen–oxygen–hydrogen bond angle $\\theta_{\\mathrm{HOH}}$. The equilibrium values are $r_{0}$ and $\\theta_{0}$. The cross-term stretch–bend coupling has a single coupling parameter $k_{r\\theta}$ (with units kilojoules per mole per angstrom per radian, kJ mol$^{-1}$ Å$^{-1}$ rad$^{-1}$). Using only the physically motivated bilinear form implied by a second-order expansion and the symmetry that the two equivalent bond stretches contribute additively to the coupling with the bend, compute the cross-term coupling energy $E_{r\\theta}$ for the following instantaneous geometry:\n- $k_{r\\theta} = 200$ kJ mol$^{-1}$ Å$^{-1}$ rad$^{-1}$,\n- $r_{\\mathrm{OH1}} = 0.980$ Å,\n- $r_{\\mathrm{OH2}} = 0.980$ Å,\n- $r_{0} = 0.970$ Å,\n- $\\theta_{\\mathrm{HOH}} = 1.850$ radians,\n- $\\theta_{0} = 1.824$ radians.\n\nRound your numerical answer to four significant figures and express the final energy in kilojoules per mole (kJ mol$^{-1}$). Then, qualitatively discuss how a nonzero $k_{r\\theta}$ affects the intensities of infrared (Infrared, IR) combination bands involving the stretch and bend modes, based on mode mixing and transition dipole moment considerations. Your qualitative discussion does not affect the grading of the numerical answer.", "solution": "The user has requested a solution to a problem concerning cross-term couplings in a molecular mechanics force field. The initial step is to validate the problem statement.\n\n### Step 1: Extract Givens\n-   System: A triatomic, water-like molecule with two equivalent bonds ($r_{\\mathrm{OH1}}$, $r_{\\mathrm{OH2}}$) and one bond angle ($\\theta_{\\mathrm{HOH}}$).\n-   Model: Classical molecular mechanics force field, second-order Taylor expansion of potential energy near equilibrium.\n-   Coupling Term Form: Bilinear cross-term coupling between bond stretches and the bond angle. The two equivalent bond stretches contribute additively.\n-   Coupling Parameter: $k_{r\\theta} = 200$ kJ mol$^{-1}$ Å$^{-1}$ rad$^{-1}$.\n-   Equilibrium Geometry: $r_{0} = 0.970$ Å, $\\theta_{0} = 1.824$ radians.\n-   Instantaneous Geometry: $r_{\\mathrm{OH1}} = 0.980$ Å, $r_{\\mathrm{OH2}} = 0.980$ Å, $\\theta_{\\mathrm{HOH}} = 1.850$ radians.\n-   Task 1: Compute the cross-term coupling energy $E_{r\\theta}$ in kJ mol$^{-1}$, rounded to four significant figures.\n-   Task 2: Qualitatively discuss the effect of a nonzero $k_{r\\theta}$ on the intensities of infrared (IR) combination bands.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n-   **Scientifically Grounded**: The problem is well-grounded in the principles of molecular mechanics and vibrational spectroscopy. The use of a Taylor series expansion for potential energy, the concept of internal coordinates, and the inclusion of cross-terms (like stretch-bend couplings) are standard components of classical force fields (e.g., as Urey-Bradley terms). The numerical values for bond lengths, angles, and the force constant are physically plausible for a molecule like water.\n-   **Well-Posed**: The problem is well-posed. It specifies the functional form of the energy term (\"bilinear\" and \"additive contribution\"), provides all necessary parameters and variables, and requests a single, computable quantity.\n-   **Objective**: The problem is stated in precise, objective, and quantitative language, free of any subjective claims.\n-   **Incomplete or Contradictory Setup**: The problem is self-contained and free of contradictions. The units are consistent: the product of $k_{r\\theta}$ [kJ mol$^{-1}$ Å$^{-1}$ rad$^{-1}$], a displacement in bond length [Å], and a displacement in bond angle [rad] correctly yields energy units [kJ mol$^{-1}$].\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe potential energy $V$ of a molecule near its equilibrium geometry can be approximated by a second-order Taylor expansion in terms of displacements of internal coordinates from their equilibrium values. For the given triatomic molecule, the internal coordinates are the two bond lengths, $r_{\\mathrm{OH1}}$ and $r_{\\mathrm{OH2}}$, and the bond angle, $\\theta_{\\mathrm{HOH}}$. The displacements are $\\Delta r_1 = r_{\\mathrm{OH1}} - r_0$, $\\Delta r_2 = r_{\\mathrm{OH2}} - r_0$, and $\\Delta \\theta = \\theta_{\\mathrm{HOH}} - \\theta_0$.\n\nThe problem focuses on the cross-term coupling energy, $E_{r\\theta}$, which arises from the off-diagonal terms of the Hessian matrix of the potential energy, coupling the stretching coordinates with the bending coordinate. The problem specifies that this term is \"bilinear\", meaning it is linear in the stretch displacements and linear in the bend displacement. It also states that the contributions from the two equivalent bond stretches are additive.\n\nBased on these constraints, the functional form of the stretch-bend coupling energy term must be:\n$$ E_{r\\theta} = k_{r\\theta} (\\Delta r_1 + \\Delta r_2) \\Delta \\theta $$\nThis expression represents the simplest bilinear form that treats the two chemically equivalent O-H bonds symmetrically and additively in their coupling to the H-O-H bend. The constant $k_{r\\theta}$ is the stretch-bend coupling force constant.\n\nWe are given the following values:\n-   $k_{r\\theta} = 200$ kJ mol$^{-1}$ Å$^{-1}$ rad$^{-1}$\n-   $r_{\\mathrm{OH1}} = 0.980$ Å\n-   $r_{\\mathrm{OH2}} = 0.980$ Å\n-   $r_{0} = 0.970$ Å\n-   $\\theta_{\\mathrm{HOH}} = 1.850$ rad\n-   $\\theta_{0} = 1.824$ rad\n\nFirst, we compute the displacements from equilibrium:\n$$ \\Delta r_1 = r_{\\mathrm{OH1}} - r_0 = 0.980 \\text{ Å} - 0.970 \\text{ Å} = 0.010 \\text{ Å} $$\n$$ \\Delta r_2 = r_{\\mathrm{OH2}} - r_0 = 0.980 \\text{ Å} - 0.970 \\text{ Å} = 0.010 \\text{ Å} $$\n$$ \\Delta \\theta = \\theta_{\\mathrm{HOH}} - \\theta_0 = 1.850 \\text{ rad} - 1.824 \\text{ rad} = 0.026 \\text{ rad} $$\n\nNow, substitute these displacements into the energy expression:\n$$ E_{r\\theta} = (200 \\text{ kJ mol}^{-1} \\text{ Å}^{-1} \\text{ rad}^{-1}) \\times (0.010 \\text{ Å} + 0.010 \\text{ Å}) \\times (0.026 \\text{ rad}) $$\n$$ E_{r\\theta} = 200 \\times (0.020) \\times (0.026) \\text{ kJ mol}^{-1} $$\n$$ E_{r\\theta} = 200 \\times 0.00052 \\text{ kJ mol}^{-1} $$\n$$ E_{r\\theta} = 0.104 \\text{ kJ mol}^{-1} $$\nThe problem requires the answer to be rounded to four significant figures. The calculated value $0.104$ must be written as $0.1040$ to meet this requirement.\n\n### Qualitative Discussion on IR Combination Bands\nA non-zero stretch-bend coupling constant $k_{r\\theta}$ has significant implications for the infrared (IR) spectrum, particularly for the intensities of combination bands.\n\n1.  **Mode Mixing**: In a molecule with $C_{2v}$ symmetry, like water, the symmetric stretching vibration and the bending vibration both belong to the same irreducible representation ($A_1$). The antisymmetric stretch belongs to a different one ($B_2$). A non-zero $k_{r\\theta}$ term in the potential energy expression provides a coupling mechanism between coordinates of the same symmetry. This means that the resulting normal modes of vibration are not pure symmetric stretch or pure bend. Instead, the symmetric-stretch normal mode will have some degree of bending character, and the bending normal mode will contain some stretching character. The magnitude of $k_{r\\theta}$ dictates the extent of this mixing.\n\n2.  **Anharmonicity and IR Intensity**: The intensity of an IR absorption band is proportional to the square of the transition dipole moment integral, $|\\langle \\psi_f | \\boldsymbol{\\mu} | \\psi_i \\rangle|^2$. Combination bands, which involve a change of more than one vibrational quantum number (e.g., from the ground state $|0_s, 0_b\\rangle$ to an excited state with both stretch and bend quanta, $|1_s, 1_b\\rangle$), are formally forbidden under the harmonic oscillator approximation. Their appearance in experimental spectra is due to anharmonicity. Anharmonicity can be of two types:\n    -   **Mechanical Anharmonicity**: The potential energy function $V$ contains cubic or higher-order terms when expressed in normal coordinates (e.g., $g_{sbb}Q_s Q_b^2$). These terms cause the harmonic oscillator wavefunctions to mix. A non-zero $k_{r\\theta}$ is a quadratic coupling in internal coordinates which, upon transformation to the normal coordinate basis, contributes significantly to the cubic and higher-order anharmonic constants. This wavefunction mixing allows the combination state to \"borrow\" intensity from strongly allowed fundamental transitions.\n    -   **Electrical Anharmonicity**: The molecular dipole moment $\\boldsymbol{\\mu}$ has a nonlinear dependence on the normal coordinates (e.g., the mixed second derivative $\\partial^2 \\boldsymbol{\\mu} / \\partial Q_s \\partial Q_b$ is non-zero).\n\n3.  **Effect of $k_{r\\theta}$**: A larger $k_{r\\theta}$ implies stronger mechanical coupling. This enhances mechanical anharmonicity, leading to more extensive wavefunction mixing. Consequently, the transition dipole moment for the combination band becomes larger, and its intensity increases. Furthermore, the physical origin of the stretch-bend coupling (e.g., changes in orbital hybridization as the bond angle deforms, which in turn affects the bonds) is also responsible for electrical anharmonicity. Thus, a system with a large $k_{r\\theta}$ is also likely to have significant electrical anharmonicity. Both effects work in concert.\n\nIn conclusion, a nonzero $k_{r\\theta}$ is a direct measure of the mechanical coupling between stretching and bending motions. This coupling is a primary source of the anharmonicity that makes combination bands IR-active. Therefore, a larger value of $k_{r\\theta}$ generally leads to a more intense combination band involving the coupled modes.", "answer": "$$\n\\boxed{0.1040}\n$$", "id": "3406790"}, {"introduction": "To accurately simulate molecular motion, potential energy functions must be translated into forces. This exercise focuses on the Urey-Bradley (UB) potential, a common cross-term that models the interaction between atoms separated by two bonds (1,3-atoms) [@problem_id:3406812]. You will derive the analytical forces generated by the UB term, a fundamental task in the implementation of a molecular dynamics engine, and explore how this term implicitly contributes to the stiffness of the associated bond angle.", "problem": "Consider a triatomic fragment in a molecular mechanics force field where atoms labeled $1$, $2$, and $3$ are connected sequentially by bonds $1\\text{-}2$ and $2\\text{-}3$ and form an angle at atom $2$. Let the bond lengths be $r_{12} = |\\mathbf{r}_{2} - \\mathbf{r}_{1}|$ and $r_{23} = |\\mathbf{r}_{3} - \\mathbf{r}_{2}|$, and let the angle at atom $2$ be $\\theta_{123}$, defined by the bond vectors $\\mathbf{b}_{12} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$ and $\\mathbf{b}_{23} = \\mathbf{r}_{3} - \\mathbf{r}_{2}$ via $\\cos\\theta_{123} = \\dfrac{\\mathbf{b}_{12} \\cdot \\mathbf{b}_{23}}{r_{12}\\,r_{23}}$. Define the $1\\text{-}3$ separation $R_{13} = |\\mathbf{r}_{1} - \\mathbf{r}_{3}|$ and the corresponding unit vector $\\hat{\\mathbf{e}}_{13} = \\dfrac{\\mathbf{r}_{1} - \\mathbf{r}_{3}}{R_{13}}$, which points from atom $3$ to atom $1$. The Urey–Bradley (UB) cross-term energy is included to couple bond stretching and angle bending through the $1\\text{-}3$ separation:\n$$\nE_{\\mathrm{UB}} = \\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2},\n$$\nwhere $k_{\\mathrm{UB}}$ is the UB stiffness and $R_{13,0}$ is the UB reference $1\\text{-}3$ distance.\n\nStarting only from the definition of mechanical force as the negative gradient of potential energy and from geometric relations for $R_{13}$ in terms of $r_{12}$, $r_{23}$, and $\\theta_{123}$, derive the forces $\\mathbf{F}_{1}$ and $\\mathbf{F}_{3}$ on atoms $1$ and $3$ due solely to $E_{\\mathrm{UB}}$, expressed entirely in terms of $k_{\\mathrm{UB}}$, $r_{12}$, $r_{23}$, $\\theta_{123}$, $R_{13,0}$, and $\\hat{\\mathbf{e}}_{13}$ (no coordinates should appear). Use the law of cosines to eliminate $R_{13}$ in favor of $r_{12}$, $r_{23}$, and $\\theta_{123}$ wherever appropriate, and take the angle $\\theta_{123}$ in radians.\n\nThen, explain how these UB forces complement the conventional angle-bending forces by analyzing the small-angle variation of $E_{\\mathrm{UB}}$ at fixed $r_{12}$ and $r_{23}$, and identify the effective additional angular stiffness contributed by the UB term near equilibrium.\n\nProvide your final answer as the pair $\\left(\\mathbf{F}_{1},\\,\\mathbf{F}_{3}\\right)$ in a single closed-form expression. No numerical evaluation is required. Angles must be expressed in radians. Do not include units in the final boxed answer.", "solution": "The problem is subjected to validation before proceeding with a solution.\n\n### Step 1: Extract Givens\n-   **System**: A triatomic fragment with atoms $1$, $2$, and $3$ connected as $1\\text{-}2\\text{-}3$.\n-   **Coordinates and Vectors**:\n    -   Bond lengths: $r_{12} = |\\mathbf{r}_{2} - \\mathbf{r}_{1}|$ and $r_{23} = |\\mathbf{r}_{3} - \\mathbf{r}_{2}|$.\n    -   Bond vectors for angle definition: $\\mathbf{b}_{12} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$ and $\\mathbf{b}_{23} = \\mathbf{r}_{3} - \\mathbf{r}_{2}$.\n    -   Angle: $\\cos\\theta_{123} = \\dfrac{\\mathbf{b}_{12} \\cdot \\mathbf{b}_{23}}{r_{12}\\,r_{23}}$.\n    -   $1\\text{-}3$ distance: $R_{13} = |\\mathbf{r}_{1} - \\mathbf{r}_{3}|$.\n    -   $1\\text{-}3$ unit vector: $\\hat{\\mathbf{e}}_{13} = \\dfrac{\\mathbf{r}_{1} - \\mathbf{r}_{3}}{R_{13}}$.\n-   **Potential Energy**:\n    -   Urey–Bradley (UB) term: $E_{\\mathrm{UB}} = \\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2}$.\n    -   Constants: $k_{\\mathrm{UB}}$ (stiffness) and $R_{13,0}$ (reference distance).\n-   **Tasks**:\n    1.  Derive the forces $\\mathbf{F}_{1}$ and $\\mathbf{F}_{3}$ due to $E_{\\mathrm{UB}}$, expressed in terms of $k_{\\mathrm{UB}}$, $r_{12}$, $r_{23}$, $\\theta_{123}$, $R_{13,0}$, and $\\hat{\\mathbf{e}}_{13}$.\n    2.  Use the law of cosines to substitute for $R_{13}$.\n    3.  Explain how UB forces complement angle-bending forces by analyzing small-angle variations of $E_{\\mathrm{UB}}$.\n    4.  Identify the effective additional angular stiffness.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes the Urey–Bradley potential, a well-established cross-term in classical molecular mechanics force fields (e.g., CHARMM, CFF). The definition of force as the negative gradient of potential energy ($\\mathbf{F} = -\\nabla E$) is a fundamental principle of classical mechanics. All geometric definitions are standard. The problem is scientifically sound.\n-   **Well-Posed**: The problem asks for a specific derivation based on given definitions and principles. The required output is clearly defined, and a unique solution is expected from the application of vector calculus.\n-   **Objective**: The problem is stated using precise, formal, and unbiased scientific language.\n-   **Complete and Consistent**: All necessary information (potential energy function, geometric definitions, the principle relating force to energy) is provided. There are no contradictions in the setup.\n-   **Realistic and Feasible**: The model is a standard representation in computational chemistry, and the requested derivation is a standard, albeit non-trivial, exercise in the field.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Derivation of Forces $\\mathbf{F}_{1}$ and $\\mathbf{F}_{3}$\n\nThe force $\\mathbf{F}_i$ on atom $i$ is given by the negative gradient of the potential energy with respect to the coordinates of that atom, $\\mathbf{r}_i$.\n$$\n\\mathbf{F}_i = -\\nabla_i E_{\\mathrm{UB}} = -\\nabla_i \\left[\\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2}\\right]\n$$\nWe apply the chain rule for differentiation. The energy $E_{\\mathrm{UB}}$ depends on the atomic coordinates only through the distance $R_{13}$.\n$$\n\\mathbf{F}_i = -\\frac{\\partial E_{\\mathrm{UB}}}{\\partial R_{13}} \\nabla_i R_{13}\n$$\nFirst, we compute the derivative of $E_{\\mathrm{UB}}$ with respect to $R_{13}$:\n$$\n\\frac{\\partial E_{\\mathrm{UB}}}{\\partial R_{13}} = k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right)\n$$\nNext, we compute the gradients of $R_{13}$ with respect to the positions $\\mathbf{r}_1$ and $\\mathbf{r}_3$. The distance $R_{13}$ is defined as $R_{13} = |\\mathbf{r}_1 - \\mathbf{r}_3| = \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbf{r}_3)}$.\n\nFor atom $1$, the gradient is:\n$$\n\\nabla_1 R_{13} = \\nabla_1 \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3)^2} = \\frac{1}{2 R_{13}} \\nabla_1 \\left((\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbf{r}_3)\\right) = \\frac{2(\\mathbf{r}_1 - \\mathbf{r}_3)}{2 R_{13}} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_3}{R_{13}}\n$$\nBy definition, this is the unit vector $\\hat{\\mathbf{e}}_{13}$.\n$$\n\\nabla_1 R_{13} = \\hat{\\mathbf{e}}_{13}\n$$\nSubstituting these results into the force equation for atom $1$:\n$$\n\\mathbf{F}_1 = -k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) \\hat{\\mathbf{e}}_{13}\n$$\nFor atom $3$, the gradient is:\n$$\n\\nabla_3 R_{13} = \\nabla_3 \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3)^2} = \\frac{1}{2 R_{13}} \\nabla_3 \\left((\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbf{r}_3)\\right) = \\frac{2(\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (-1)}{2 R_{13}} = -\\frac{\\mathbf{r}_1 - \\mathbf{r}_3}{R_{13}}\n$$\n$$\n\\nabla_3 R_{13} = -\\hat{\\mathbf{e}}_{13}\n$$\nSubstituting these results into the force equation for atom $3$:\n$$\n\\mathbf{F}_3 = -k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) (-\\hat{\\mathbf{e}}_{13}) = k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) \\hat{\\mathbf{e}}_{13}\n$$\nAs expected, $\\mathbf{F}_1 = -\\mathbf{F}_3$, satisfying Newton's third law for this interaction pair. The force on atom $2$ from this potential is zero, since $E_{\\mathrm{UB}}$ does not depend on $\\mathbf{r}_2$.\n\nThe final step is to express $R_{13}$ in terms of the internal coordinates $r_{12}$, $r_{23}$, and $\\theta_{123}$. The atoms $1$, $2$, and $3$ form a triangle with sides of length $r_{12}$, $r_{23}$, and $R_{13}$. The angle at vertex $2$ is $\\theta_{123}$. Using the law of cosines:\n$$\nR_{13}^2 = r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}\n$$\nTherefore, the distance $R_{13}$ is:\n$$\nR_{13} = \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}}\n$$\nSubstituting this expression for $R_{13}$ into the force equations yields the final expressions:\n$$\n\\mathbf{F}_1 = -k_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}} - R_{13,0} \\right) \\hat{\\mathbf{e}}_{13}\n$$\n$$\n\\mathbf{F}_3 = k_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}} - R_{13,0} \\right) \\hat{\\mathbf{e}}_{13}\n$$\nThese expressions give the forces entirely in terms of the specified variables.\n\n### Complementarity with Angle-Bending Forces\n\nTo understand how the Urey-Bradley term complements conventional angle-bending potentials, we analyze its behavior for small variations in the angle $\\theta_{123}$, holding the bond lengths $r_{12}$ and $r_{23}$ constant. A typical harmonic angle-bending potential has the form $E_{\\text{angle}} = \\frac{1}{2} k_{\\text{angle}}(\\theta_{123} - \\theta_{\\text{eq}})^2$. We will show that the UB term, to a good approximation, also provides a harmonic restoring potential for the angle.\n\nLet us perform a Taylor series expansion of $E_{\\mathrm{UB}}$ as a function of $\\theta \\equiv \\theta_{123}$ around an equilibrium angle $\\theta_0$. We define $\\theta_0$ as the angle for which the $1\\text{-}3$ distance equals the reference distance, i.e., $R_{13}(\\theta_0) = R_{13,0}$.\n$$\nE_{\\mathrm{UB}}(\\theta) \\approx E_{\\mathrm{UB}}(\\theta_0) + \\left. \\frac{dE_{\\mathrm{UB}}}{d\\theta} \\right|_{\\theta_0} (\\theta - \\theta_0) + \\frac{1}{2} \\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} (\\theta - \\theta_0)^2\n$$\nThe first derivative of $E_{\\mathrm{UB}}$ with respect to $\\theta$ is found using the chain rule:\n$$\n\\frac{dE_{\\mathrm{UB}}}{d\\theta} = \\frac{dE_{\\mathrm{UB}}}{dR_{13}} \\frac{dR_{13}}{d\\theta} = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\frac{d}{d\\theta}\\left(r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta\\right)^{1/2}\n$$\n$$\n\\frac{dE_{\\mathrm{UB}}}{d\\theta} = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\left[\\frac{1}{2 R_{13}}(2r_{12}r_{23}\\sin\\theta)\\right] = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\frac{r_{12}r_{23}\\sin\\theta}{R_{13}}\n$$\nAt the equilibrium angle $\\theta_0$, we have $R_{13}(\\theta_0) = R_{13,0}$, so the term $(R_{13} - R_{13,0})$ is zero. Consequently, the first derivative vanishes:\n$$\n\\left. \\frac{dE_{\\mathrm{UB}}}{d\\theta} \\right|_{\\theta_0} = 0\n$$\nThis confirms that $\\theta_0$ corresponds to a minimum in the potential energy landscape (assuming the second derivative is positive). Also, $E_{\\mathrm{UB}}(\\theta_0) = 0$.\n\nNext, we compute the second derivative at $\\theta_0$:\n$$\n\\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} = k_{\\mathrm{UB}} \\frac{d}{d\\theta} \\left[ \\left(1 - \\frac{R_{13,0}}{R_{13}}\\right) r_{12}r_{23}\\sin\\theta \\right]\n$$\n$$\n= k_{\\mathrm{UB}} \\left[ \\left(\\frac{R_{13,0}}{R_{13}^2}\\frac{dR_{13}}{d\\theta}\\right) r_{12}r_{23}\\sin\\theta + \\left(1 - \\frac{R_{13,0}}{R_{13}}\\right) r_{12}r_{23}\\cos\\theta \\right]\n$$\nEvaluating at $\\theta=\\theta_0$, where $R_{13}=R_{13,0}$:\n$$\n\\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} = k_{\\mathrm{UB}} \\left[ \\left(\\frac{R_{13,0}}{R_{13,0}^2} \\left. \\frac{dR_{13}}{d\\theta}\\right|_{\\theta_0} \\right) r_{12}r_{23}\\sin\\theta_0 + 0 \\right]\n$$\nWe need the derivative of $R_{13}$ at $\\theta_0$: $\\left. \\frac{dR_{13}}{d\\theta}\\right|_{\\theta_0} = \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}}$.\n$$\n\\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} = k_{\\mathrm{UB}} \\left[ \\frac{1}{R_{13,0}} \\left(\\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}}\\right) r_{12}r_{23}\\sin\\theta_0 \\right] = k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2\n$$\nThe Taylor expansion of $E_{\\mathrm{UB}}$ around $\\theta_0$ is therefore:\n$$\nE_{\\mathrm{UB}}(\\theta) \\approx \\frac{1}{2} \\left[ k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2 \\right] (\\theta - \\theta_0)^2\n$$\nThis demonstrates that for small angular displacements, the Urey-Bradley potential is equivalent to a harmonic angle-bending potential. The effective angular stiffness contributed by the UB term is:\n$$\nk_{\\text{eff, UB}} = k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2\n$$\nIn a complete force field, the total potential for angle bending would be the sum of a traditional harmonic angle term and the UB term. The total effective stiffness for angle bending is thus the sum of the explicit angle stiffness and $k_{\\text{eff, UB}}$. This coupling between bond stretching and angle bending via the $1\\text{-}3$ distance provides a more physically realistic potential energy surface, particularly for accurately modeling vibrational frequencies and structures of strained rings or sterically crowded molecules.", "answer": "$$\n\\boxed{\nk_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2 r_{12} r_{23} \\cos\\theta_{123}} - R_{13,0} \\right) \\begin{pmatrix} -\\hat{\\mathbf{e}}_{13}  \\hat{\\mathbf{e}}_{13} \\end{pmatrix}\n}\n$$", "id": "3406812"}, {"introduction": "A robust force field requires that its parameters describe a physically stable system, where the equilibrium geometry corresponds to a true potential energy minimum. This advanced practice explores the mathematical conditions for this stability by analyzing the Hessian matrix of the potential energy [@problem_id:3406831]. You will derive the criterion for positive-definiteness and implement a computational diagnostic to flag unstable parameter sets, a critical skill for anyone involved in force field parameterization and validation.", "problem": "Consider a two-dimensional internal-coordinate harmonic model for a single bond length and its adjacent bond angle used in molecular dynamics force fields. Let the internal coordinates be the bond stretch displacement $\\,\\Delta r\\,$ (in $\\mathrm{nm}$) and the angle deviation $\\,\\Delta \\theta\\,$ (in radians). Near equilibrium, approximate the potential energy by a quadratic form\n$$\nU(\\Delta r,\\Delta \\theta) \\;=\\; \\tfrac{1}{2}\n\\begin{bmatrix}\n\\Delta r  \\Delta \\theta\n\\end{bmatrix}\n\\begin{bmatrix}\nk_r  k_{r\\theta} \\\\\nk_{r\\theta}  k_\\theta\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta r \\\\\n\\Delta \\theta\n\\end{bmatrix},\n$$\nwhere $\\,k_r\\,$ has units $\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$, $\\,k_\\theta\\,$ has units $\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$, and $\\,k_{r\\theta}\\,$ has units $\\mathrm{kJ\\,mol^{-1}\\,(nm\\cdot rad)^{-1}}$. Stability of the local quadratic approximation requires that the Hessian matrix\n$$\n\\mathbf{K} \\;=\\; \\begin{bmatrix}\nk_r  k_{r\\theta} \\\\\nk_{r\\theta}  k_\\theta\n\\end{bmatrix}\n$$\nbe symmetric positive-definite. Starting from the fundamental principle that stable equilibria require positive curvature in all directions (Newtonian dynamics with harmonic restoring forces), and applying Sylvester’s criterion for positive-definiteness of symmetric matrices, derive the necessary and sufficient inequalities among $\\,k_r$, $\\,k_\\theta$, and $\\,k_{r\\theta}\\,$ that ensure $\\,\\mathbf{K}\\,$ is positive-definite. In particular, establish the strict bound $\\,k_{r\\theta}^2  k_r\\,k_\\theta\\,$ and the sign requirements on $\\,k_r\\,$ and $\\,k_\\theta\\,$.\n\nDesign a numerical diagnostic for equilibration that flags unstable or nearly unstable cross-term parameterizations based on the spectrum of $\\,\\mathbf{K}\\,$ and thermal sampling. Use the equipartition-based covariance for internal coordinates,\n$$\n\\boldsymbol{\\Sigma} \\;=\\; k_\\mathrm{B} T\\,\\mathbf{K}^{-1},\n$$\nwith $\\,k_\\mathrm{B} T\\,$ expressed per mole, i.e., use the molar gas constant $\\,R\\,$ in $\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$ in place of $\\,k_\\mathrm{B}$ so that $\\,k_\\mathrm{B} N_\\mathrm{A} = R$. For $\\mathrm{kJ\\,mol^{-1}}$ energy units, take $\\,R = 0.008314462618\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$. Your diagnostic must:\n- Compute the eigenvalues $\\,\\lambda_{\\min}\\,$ and $\\,\\lambda_{\\max}\\,$ of $\\,\\mathbf{K}\\,$.\n- Declare the matrix to be positive-definite if and only if the derived inequalities hold.\n- Flag a parameter set as unstable during equilibration if either the matrix is not strictly positive-definite or the conditioning is poor, quantified by $\\,\\lambda_{\\min}/\\lambda_{\\max}  \\tau\\,$ for a given threshold $\\,\\tau  0\\,$. Additionally, when $\\,\\mathbf{K}\\,$ is positive-definite and well-conditioned, draw samples $\\,(\\Delta r, \\Delta \\theta)\\,$ from $\\,\\mathcal{N}(\\mathbf{0},\\boldsymbol{\\Sigma})\\,$ and verify that $\\,U(\\Delta r,\\Delta \\theta) \\ge 0\\,$ holds numerically for all samples; if any sampled energy is negative, flag the parameter set as unstable.\n\nImplement a complete, runnable program that, for the following test suite, computes for each case:\n- A boolean indicating whether $\\,\\mathbf{K}\\,$ is positive-definite.\n- A boolean diagnostic flag indicating instability during equilibration, according to the rule above.\n- The minimal eigenvalue $\\,\\lambda_{\\min}\\,$ of $\\,\\mathbf{K}\\,$, reported in $\\mathrm{kJ\\,mol^{-1}}$ per squared internal coordinate, rounded to six decimal places.\n\nUse angle units in radians. Use the specified units for all constants and report $\\,\\lambda_{\\min}\\,$ in $\\mathrm{kJ\\,mol^{-1}}$ per squared internal coordinate. For thermal sampling, use $\\,T\\,$ in $\\mathrm{K}$. The test suite consists of seven parameter sets, each given as $\\,(k_r, k_\\theta, k_{r\\theta}, T, n_\\mathrm{samples}, \\tau)\\,$:\n- Case $\\,1$: $(500.0, 200.0, 100.0, 300.0, 5000, 10^{-4})$.\n- Case $\\,2$: $(1.0, 1.0, 1.0, 300.0, 5000, 10^{-4})$.\n- Case $\\,3$: $(2.0, 2.0, 2.1, 300.0, 5000, 10^{-4})$.\n- Case $\\,4$: $(-10.0, 50.0, 0.0, 300.0, 5000, 10^{-4})$.\n- Case $\\,5$: $(10^{-3}, 10^{-3}, 0.999\\times 10^{-3}, 300.0, 5000, 10^{-3})$.\n- Case $\\,6$: $(300.0, 100.0, 0.0, 300.0, 5000, 10^{-4})$.\n- Case $\\,7$: $(500.0, 200.0, -100.0, 300.0, 5000, 10^{-4})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of the form $[\\,\\text{pd},\\,\\text{flag},\\,\\lambda_{\\min}\\,]$. For example, the output format must be like\n$$\n[\\,[\\text{True},\\text{False},0.123456],[\\text{False},\\text{True},-0.010000],\\dots]\n$$\nwith no extra spaces anywhere in the line.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It addresses fundamental concepts in molecular mechanics, namely the stability of a potential energy minimum and its relation to the mathematical properties of the Hessian matrix. The proposed numerical diagnostic is a valid, multi-step procedure combining analytical criteria, matrix conditioning, and statistical sampling to assess the stability of a force field parameterization. All necessary constants and parameters are provided. Therefore, I will proceed with a full solution.\n\n### Part 1: Derivation of Stability Conditions\n\nThe potential energy near an equilibrium point is given by the quadratic form:\n$$\nU(\\Delta r,\\Delta \\theta) \\;=\\; \\tfrac{1}{2}\n\\begin{bmatrix}\n\\Delta r  \\Delta \\theta\n\\end{bmatrix}\n\\mathbf{K}\n\\begin{bmatrix}\n\\Delta r \\\\\n\\Delta \\theta\n\\end{bmatrix}\n$$\nwhere $\\mathbf{x} = [\\Delta r, \\Delta \\theta]^T$ is the vector of internal coordinate displacements and $\\mathbf{K}$ is the Hessian matrix of second derivatives of the potential energy with respect to these coordinates.\n$$\n\\mathbf{K} \\;=\\; \\begin{bmatrix}\nk_r  k_{r\\theta} \\\\\nk_{r\\theta}  k_\\theta\n\\end{bmatrix}\n$$\nFor the equilibrium to be stable, the potential energy $U$ must be a local minimum. This requires the potential energy to increase for any small displacement $\\mathbf{x} \\ne \\mathbf{0}$, which means $U(\\mathbf{x}) > 0$. This condition is satisfied if and only if the Hessian matrix $\\mathbf{K}$ is positive-definite.\n\nWe use Sylvester's criterion to determine the conditions for a symmetric matrix to be positive-definite. The criterion states that a symmetric matrix is positive-definite if and only if all its leading principal minors are strictly positive.\n\nFor the $2 \\times 2$ matrix $\\mathbf{K}$, there are two leading principal minors.\n\n1.  **The first leading principal minor** is the determinant of the top-left $1 \\times 1$ submatrix, which is simply $[k_r]$.\n    $$\n    \\det([k_r]) \\;=\\; k_r\n    $$\n    For positive-definiteness, this must be strictly positive:\n    $$\n    k_r  0\n    $$\n\n2.  **The second leading principal minor** is the determinant of the entire $2 \\times 2$ matrix $\\mathbf{K}$.\n    $$\n    \\det(\\mathbf{K}) \\;=\\; \\det \\begin{pmatrix}\n    k_r  k_{r\\theta} \\\\\n    k_{r\\theta}  k_\\theta\n    \\end{pmatrix} \\;=\\; k_r k_\\theta - k_{r\\theta}^2\n    $$\n    For positive-definiteness, this also must be strictly positive:\n    $$\n    k_r k_\\theta - k_{r\\theta}^2  0\n    $$\n    This inequality can be rearranged to $k_{r\\theta}^2  k_r k_\\theta$.\n\nFrom the two necessary conditions, $k_r  0$ and $k_r k_\\theta  k_{r\\theta}^2$, we can also deduce the sign of $k_\\theta$. Since $k_{r\\theta}^2 \\ge 0$, the second inequality implies that $k_r k_\\theta$ must be positive. As we have already established that $k_r  0$, it logically follows that $k_\\theta$ must also be positive, i.e., $k_\\theta  0$.\n\nThus, the complete set of necessary and sufficient conditions for the matrix $\\mathbf{K}$ to be positive-definite, and therefore for the equilibrium to be stable, are:\n1.  $k_r  0$\n2.  $k_\\theta  0$\n3.  $k_r k_\\theta - k_{r\\theta}^2  0$\n\nThese are the inequalities that will be used in the first step of the numerical diagnostic.\n\n### Part 2: Design of the Numerical Diagnostic Algorithm\n\nFor each parameter set $(k_r, k_\\theta, k_{r\\theta}, T, n_\\mathrm{samples}, \\tau)$, the following algorithm is implemented.\n\n1.  **Construct the Hessian Matrix**: Form the numerical matrix $\\mathbf{K} = \\begin{bmatrix} k_r  k_{r\\theta} \\\\ k_{r\\theta}  k_\\theta \\end{bmatrix}$. A brief note on units: the elements of $\\mathbf{K}$ have different physical units ($\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$, $\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$, etc.), which means the eigenvalues do not have a single, simple physical unit. However, for the purpose of this problem, we treat $\\mathbf{K}$ as a pure numerical matrix, and the eigenvalues as numerical values representing force constants of the system's normal modes, reported with the generic unit label requested.\n\n2.  **Positive-Definiteness Check (`pd`)**: Analytically verify the derived stability conditions:\n    The matrix is declared positive-definite (`pd = True`) if and only if `(k_r  0) AND (k_theta  0) AND (k_r * k_theta  k_rtheta**2)`. Otherwise, `pd = False`.\n\n3.  **Eigenvalue Calculation**: Compute the eigenvalues of the symmetric matrix $\\mathbf{K}$, denoted $\\lambda_{\\min}$ and $\\lambda_{\\max}$. The minimal eigenvalue, $\\lambda_{\\min}$, is stored for output, rounded to six decimal places.\n\n4.  **Instability Flag (`flag`)**: Determine the stability flag based on a sequence of checks.\n    a.  **Initial Check**: If the matrix is not positive-definite (`pd = False`), the system is fundamentally unstable. Set `flag = True`.\n    b.  **Conditioning Check**: If the matrix is positive-definite (`pd = True`), evaluate its conditioning. The system is flagged as \"nearly unstable\" if the ratio of the minimum to maximum eigenvalue is below a given threshold $\\tau$. If $\\lambda_{\\min} / \\lambda_{\\max}  \\tau$, set `flag = True`. Note that if $\\mathbf{K}$ is positive-definite, both eigenvalues are strictly positive, ensuring $\\lambda_{\\max}  0$.\n    c.  **Thermal Sampling Check**: If the matrix is positive-definite and well-conditioned (i.e., `flag` is still `False`), perform a final check for numerical instability.\n        i.  Calculate the covariance matrix $\\boldsymbol{\\Sigma} = (R \\cdot T) \\cdot \\mathbf{K}^{-1}$, where $R = 0.008314462618\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$.\n        ii. Draw $n_\\mathrm{samples}$ random displacement vectors $\\mathbf{x} = [\\Delta r, \\Delta \\theta]^T$ from the bivariate normal distribution $\\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma})$.\n        iii. For each sampled vector $\\mathbf{x}$, compute the potential energy $U = \\tfrac{1}{2} \\mathbf{x}^T \\mathbf{K} \\mathbf{x}$.\n        iv. If, due to finite-precision arithmetic, any computed energy $U$ is negative, the parameterization is flagged as numerically unstable. Set `flag = True` and terminate the sampling for the current case.\n\n5.  **Output Generation**: For each test case, collect the three computed values: the boolean `pd`, the boolean `flag`, and the float `lambda_min`. These are formatted into a single string line as per the problem specification.\n\nThis comprehensive procedure correctly validates the stability of the given parameters, moving from a pure analytical check to numerical conditioning and finally to a practical test of numerical stability under thermal fluctuations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing the stability of a 2D harmonic potential\n    for a series of molecular dynamics force field parameter sets.\n    \"\"\"\n    R_KJ_MOL_K = 0.008314462618  # Molar gas constant in kJ/(mol*K)\n\n    # Test suite: (k_r, k_theta, k_rtheta, T, n_samples, tau)\n    test_cases = [\n        (500.0, 200.0, 100.0, 300.0, 5000, 1e-4),\n        (1.0, 1.0, 1.0, 300.0, 5000, 1e-4),\n        (2.0, 2.0, 2.1, 300.0, 5000, 1e-4),\n        (-10.0, 50.0, 0.0, 300.0, 5000, 1e-4),\n        (1e-3, 1e-3, 0.999 * 1e-3, 300.0, 5000, 1e-3),\n        (300.0, 100.0, 0.0, 300.0, 5000, 1e-4),\n        (500.0, 200.0, -100.0, 300.0, 5000, 1e-4),\n    ]\n\n    results_str_list = []\n\n    for case in test_cases:\n        k_r, k_theta, k_rtheta, T, n_samples, tau = case\n\n        # 1. Construct the Hessian Matrix K\n        K = np.array([[k_r, k_rtheta], [k_rtheta, k_theta]])\n\n        # 2. Positive-Definiteness Check (pd)\n        # Apply Sylvester's criterion: k_r  0 and det(K)  0\n        is_pd = (k_r  0) and (k_theta  0) and (k_r * k_theta  k_rtheta**2)\n\n        # 3. Eigenvalue Calculation\n        # Use eigvalsh for symmetric matrices; it returns sorted eigenvalues.\n        try:\n            eigs = np.linalg.eigvalsh(K)\n            lambda_min, lambda_max = eigs[0], eigs[1]\n        except np.linalg.LinAlgError:\n            # This should not happen for a 2x2 matrix unless entries are non-finite\n            lambda_min, lambda_max = np.nan, np.nan\n            is_pd = False # Mark as not PD if eigenvalues cannot be computed\n\n        # 4. Instability Flag (flag)\n        is_unstable = False\n\n        # a. Initial check based on positive-definiteness\n        if not is_pd:\n            is_unstable = True\n        else:\n            # b. Conditioning check\n            # Avoid division by zero if lambda_max is zero or negative (though impossible if PD)\n            if lambda_max  0:\n                condition_ratio = lambda_min / lambda_max\n                if condition_ratio  tau:\n                    is_unstable = True\n            else: # Should be unreachable if is_pd is True\n                is_unstable = True\n\n            # c. Thermal sampling check (only if not already flagged as unstable)\n            if not is_unstable:\n                RT = R_KJ_MOL_K * T\n                # Covariance matrix Sigma = RT * K^-1\n                try:\n                    K_inv = np.linalg.inv(K)\n                    Sigma = RT * K_inv\n                    \n                    # Check if covariance matrix is valid for sampling\n                    # (must be symmetric positive-semidefinite)\n                    # For a PD K, K_inv is PD, so Sigma is PD.\n                    \n                    # Draw samples from N(0, Sigma)\n                    mean = np.array([0.0, 0.0])\n                    samples = np.random.multivariate_normal(mean, Sigma, size=n_samples)\n\n                    # Check for negative potential energy\n                    for x in samples:\n                        # U = 0.5 * x.T @ K @ x\n                        U = 0.5 * np.dot(x, K @ x)\n                        if U  0:\n                            is_unstable = True\n                            break\n                except np.linalg.LinAlgError:\n                    # K is singular or near-singular, which should be caught by\n                    # is_pd or conditioning check, but this is a safeguard.\n                    is_unstable = True\n        \n        # Round lambda_min to 6 decimal places and format for output\n        formatted_lambda_min = f\"{round(lambda_min, 6):.6f}\"\n\n        # Compile the result string for this case\n        result_str = f\"[{'True' if is_pd else 'False'},{'True' if is_unstable else 'False'},{formatted_lambda_min}]\"\n        results_str_list.append(result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_str_list)}]\")\n\n\nsolve()\n```", "id": "3406831"}]}