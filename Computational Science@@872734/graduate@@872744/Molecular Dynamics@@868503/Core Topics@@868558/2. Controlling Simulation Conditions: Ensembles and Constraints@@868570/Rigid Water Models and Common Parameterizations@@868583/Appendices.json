{"hands_on_practices": [{"introduction": "Before implementing or analyzing any rigid water model, it is essential to understand its fundamental mechanical definition. This practice guides you through a first-principles calculation of the degrees of freedom for a system of rigid molecules. By comparing the unconstrained and constrained systems, you will solidify your understanding of how holonomic constraints are used to simplify molecular representations in simulations [@problem_id:3443178].", "problem": "Consider a classical molecular dynamics model in three-dimensional Euclidean space for a system composed of $N$ identical water molecules. Each water molecule is modeled explicitly by its three atoms (one oxygen and two hydrogens) with Cartesian coordinates, and the intramolecular geometry is to be treated as perfectly rigid. Assume there are no external holonomic constraints applied to the system as a whole (for example, do not fix the system center of mass or the total angular momentum), and ignore any boundary conditions that would reduce global motion.\n\nStarting from first principles for the counting of mechanical degrees of freedom and the definition of holonomic constraints, and using only the fact that a water monomer is a non-linear triatomic object, determine:\n\n- The total number of mechanical degrees of freedom of the constrained system as a function of $N$.\n- The minimal number of independent holonomic constraints that must be enforced per molecule to maintain fixed intramolecular geometry.\n\nYour final answer should be given as a pair of expressions depending on $N$ where appropriate, formatted as a single row matrix with the first entry equal to the total number of mechanical degrees of freedom of the system and the second entry equal to the number of independent holonomic constraints per molecule. No numerical rounding is required, and no units are needed in the final answer.", "solution": "The problem requires the determination of two quantities for a system of $N$ rigid water molecules in $3$-dimensional space: the total number of mechanical degrees of freedom and the number of holonomic constraints per molecule. We shall derive these from first principles.\n\nA degree of freedom in a mechanical system is an independent parameter that defines its configuration. For a system of point masses, each mass in $3$-dimensional space has $3$ translational degrees of freedom, corresponding to its coordinates along three mutually orthogonal axes.\n\nFirst, consider the system without any rigidity constraints. The system consists of $N$ water molecules. Each water molecule is composed of $3$ atoms ($1$ oxygen and $2$ hydrogens). Therefore, the total number of atoms in the system is $3N$. In the absence of any constraints, each of these $3N$ atoms can be treated as an independent point mass. The total number of degrees of freedom, $D_{unconstrained}$, for this unconstrained system is the total number of atoms multiplied by the degrees of freedom per atom:\n$$\nD_{unconstrained} = (3N) \\times 3 = 9N\n$$\n\nThe problem states that the intramolecular geometry of each water molecule is to be treated as perfectly rigid. A rigid body in $3$-dimensional space is an object where the distance between any two of its constituent particles remains constant. The motion of a rigid body can be completely described by the translation of its center of mass and the rotation about its center of mass.\n\nA general rigid body in $3$-dimensional space has $6$ degrees of freedom. These are:\n1.  $3$ translational degrees of freedom, which describe the position of the body's center of mass.\n2.  $3$ rotational degrees of freedom, which describe the orientation of the body in space.\n\nThis holds true for any non-linear object. The problem explicitly states that a water molecule is a non-linear triatomic object. Therefore, each rigid water molecule possesses $6$ mechanical degrees of freedom.\n\nThe system is composed of $N$ such identical, rigid water molecules. The problem specifies that there are no external holonomic constraints applied to the system as a whole. This implies that each molecule is free to translate and rotate independently of the others. Consequently, the total number of degrees of freedom for the entire system, $D_{system}$, is the sum of the degrees of freedom for each of the $N$ molecules:\n$$\nD_{system} = N \\times (\\text{degrees of freedom per rigid molecule}) = N \\times 6 = 6N\n$$\nThis is the first part of the required answer.\n\nNext, we must determine the minimal number of independent holonomic constraints that must be enforced per molecule to maintain this fixed intramolecular geometry. Let this number be $C_{molecule}$. A holonomic constraint is a relation between the coordinates of the particles, which can be expressed as an equation $f(q_1, q_2, \\dots, t) = 0$. Each independent holonomic constraint removes one degree of freedom from the system.\n\nFor a single water molecule, the unconstrained system of $3$ atoms has $3 \\times 3 = 9$ degrees of freedom. After applying the rigidity constraints, the molecule behaves as a single rigid body with $6$ degrees of freedom. The number of constraints is therefore the difference between the initial (unconstrained) and final (constrained) number of degrees of freedom:\n$$\nC_{molecule} = D_{unconstrained, 1 molecule} - D_{constrained, 1 molecule} = 9 - 6 = 3\n$$\nThus, $3$ independent holonomic constraints are required per molecule.\n\nWe can verify this by explicitly considering the geometry. To make a collection of $n_a = 3$ atoms rigid, we must fix their relative positions. This is achieved by fixing the distances between pairs of atoms. For $3$ atoms with positions $\\vec{r}_1, \\vec{r}_2, \\vec{r}_3$, we can define three interatomic distances: $d_{12} = |\\vec{r}_1 - \\vec{r}_2|$, $d_{23} = |\\vec{r}_2 - \\vec{r}_3|$, and $d_{13} = |\\vec{r}_1 - \\vec{r}_3|$. Imposing these three distances as constants fixes the shape of the triangle formed by the three atoms. These constraints can be written as:\n1.  $|\\vec{r}_1 - \\vec{r}_2|^2 - d_{12}^2 = 0$\n2.  $|\\vec{r}_2 - \\vec{r}_3|^2 - d_{23}^2 = 0$\n3.  $|\\vec{r}_3 - \\vec{r}_1|^2 - d_{31}^2 = 0$\n\nThese represent $3$ independent scalar equations. Therefore, a minimum of $3$ holonomic constraints are required to render a triatomic molecule rigid. This confirms our previous deduction.\n\nThe total number of constraints for the system of $N$ molecules is $C_{system} = N \\times C_{molecule} = 3N$. We can use this to provide a consistency check for the total degrees of freedom of the system:\n$$\nD_{system} = D_{unconstrained} - C_{system} = 9N - 3N = 6N\n$$\nThis result is consistent with our direct calculation based on rigid-body mechanics.\n\nIn summary:\n- The total number of mechanical degrees of freedom for the system of $N$ rigid water molecules is $6N$.\n- The minimal number of independent holonomic constraints per molecule required to enforce rigidity is $3$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6N & 3\n\\end{pmatrix}\n}\n$$", "id": "3443178"}, {"introduction": "Rigid water models are defined by a specific geometry and a set of partial charges, which together aim to reproduce the electrostatic field of a real water molecule. This exercise connects these abstract parameters to key physical observables: the electric dipole and quadrupole moments [@problem_id:3443213]. Mastering this calculation allows you to appreciate how different parameterizations, like the TIP4P model family, are designed and how their electrostatic properties are linked to thermodynamic behavior.", "problem": "A rigid water model of the Transferable Intermolecular Potential with 4 Points (TIP4P) type is defined as follows. Place the oxygen atom at the origin of a Cartesian frame. The two hydrogen atoms lie in the $x$–$z$ plane, symmetrically about the $z$ axis, each at an oxygen–hydrogen bond distance $r_{OH}$ and forming a hydrogen–oxygen–hydrogen angle $\\theta_{HOH}$. Thus the hydrogen coordinates are $(r_{OH}\\sin(\\theta_{HOH}/2),\\,0,\\,r_{OH}\\cos(\\theta_{HOH}/2))$ and $(-r_{OH}\\sin(\\theta_{HOH}/2),\\,0,\\,r_{OH}\\cos(\\theta_{HOH}/2)).$ The massless negative charge site $M$ lies on the $z$ axis along the bisector of the angle at a distance $d_{OM}$ from the oxygen toward the hydrogen side, at coordinates $(0,\\,0,\\,d_{OM})$. The partial charges are $q_H$ on each hydrogen, $q_O$ on the oxygen at the origin, and $q_M$ on the $M$ site, with overall charge neutrality enforced by $$q_O + 2 q_H + q_M = 0.$$ The oxygen atom is the only Lennard–Jones (LJ) site, with LJ size parameter $\\sigma$ and LJ energy parameter $\\epsilon$.\n\nStarting from the definitions of the electric dipole moment and the traceless Cartesian quadrupole moment of a collection of point charges,\n$$\\boldsymbol{\\mu} = \\sum_i q_i \\mathbf{r}_i,$$\n$$Q_{\\alpha\\beta} = \\sum_i q_i \\left(3 r_{i,\\alpha} r_{i,\\beta} - r_i^2 \\delta_{\\alpha\\beta}\\right),$$\nwhere $\\alpha,\\beta \\in \\{x,y,z\\}$ and $\\delta_{\\alpha\\beta}$ is the Kronecker delta, carry out the following:\n\n1. Using the above geometry and charges, derive closed-form analytic expressions for the $z$ component of the dipole moment, $\\mu \\equiv \\mu_z$, and for the $zz$ component of the quadrupole tensor, $Q \\equiv Q_{zz}$, in terms of $q_O$, $q_H$, $r_{OH}$, $d_{OM}$, and $\\theta_{HOH}$. Use the charge-neutrality constraint to eliminate $q_M$ if needed. Take the $+z$ direction to point from oxygen toward the hydrogen side.\n\n2. Consider a Stockmayer-type pair potential combining Lennard–Jones 12–6 interactions between oxygen sites and point–dipole interactions between molecular dipoles. By nondimensionalizing the pair Hamiltonian using the LJ parameters $\\sigma$ and $\\epsilon$ and the vacuum permittivity $\\varepsilon_0$, define the reduced dipole strength $\\mu^{\\star}$ as the dimensionless coefficient multiplying the orientational dipole–dipole interaction. Then solve for $\\epsilon$ in terms of $\\mu$, $\\mu^{\\star}$, $\\sigma$, and $\\varepsilon_0$. Express your result as a single closed-form analytic expression.\n\nExpress your final answer as a single row matrix containing, in order, the expressions for $\\mu$, $Q$, and $\\epsilon$. Do not numerically evaluate or round; provide exact analytic expressions only. No units should be included in the final boxed answer.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. All necessary information is provided, and the tasks are standard derivations in the field of molecular modeling and classical electrostatics.\n\nThe solution is developed in two parts as requested.\n\nPart 1: Derivation of the dipole and quadrupole moments.\n\nThe system consists of four point charges: one oxygen atom (O), two hydrogen atoms (H1, H2), and one massless site (M). Their positions and charges are given as:\n- Oxygen (O): charge $q_O$ at $\\mathbf{r}_O = (0, 0, 0)$.\n- Hydrogen 1 (H1): charge $q_H$ at $\\mathbf{r}_{H1} = (r_{OH}\\sin(\\theta_{HOH}/2), 0, r_{OH}\\cos(\\theta_{HOH}/2))$.\n- Hydrogen 2 (H2): charge $q_H$ at $\\mathbf{r}_{H2} = (-r_{OH}\\sin(\\theta_{HOH}/2), 0, r_{OH}\\cos(\\theta_{HOH}/2))$.\n- M-site (M): charge $q_M$ at $\\mathbf{r}_M = (0, 0, d_{OM})$.\n\nThe molecule is electrically neutral, so the sum of charges is zero: $q_O + 2q_H + q_M = 0$. This constraint can be used to express $q_M$ in terms of the other charges: $q_M = -q_O - 2q_H$.\n\nFirst, we derive the $z$ component of the electric dipole moment, $\\mu \\equiv \\mu_z$. The dipole moment vector $\\boldsymbol{\\mu}$ is defined as $\\boldsymbol{\\mu} = \\sum_i q_i \\mathbf{r}_i$. We calculate its $z$ component, $\\mu_z = \\sum_i q_i r_{i,z}$.\nThe sum over the four sites is:\n$$ \\mu_z = q_O r_{O,z} + q_H r_{H1,z} + q_H r_{H2,z} + q_M r_{M,z} $$\nSubstituting the $z$-coordinates of the sites:\n- $r_{O,z} = 0$\n- $r_{H1,z} = r_{OH}\\cos(\\theta_{HOH}/2)$\n- $r_{H2,z} = r_{OH}\\cos(\\theta_{HOH}/2)$\n- $r_{M,z} = d_{OM}$\n\nWe obtain:\n$$ \\mu_z = q_O(0) + q_H (r_{OH}\\cos(\\theta_{HOH}/2)) + q_H (r_{OH}\\cos(\\theta_{HOH}/2)) + q_M (d_{OM}) $$\n$$ \\mu_z = 2 q_H r_{OH}\\cos(\\theta_{HOH}/2) + q_M d_{OM} $$\nThe problem requires the expression in terms of $q_O$, $q_H$, $r_{OH}$, $d_{OM}$, and $\\theta_{HOH}$. We eliminate $q_M$ using the charge neutrality condition $q_M = -q_O - 2q_H$:\n$$ \\mu_z = 2 q_H r_{OH}\\cos(\\theta_{HOH}/2) + (-q_O - 2q_H) d_{OM} $$\n$$ \\mu \\equiv \\mu_z = 2 q_H (r_{OH}\\cos(\\frac{\\theta_{HOH}}{2}) - d_{OM}) - q_O d_{OM} $$\n\nSecond, we derive the $zz$ component of the traceless quadrupole moment tensor, $Q \\equiv Q_{zz}$. The general definition is $Q_{\\alpha\\beta} = \\sum_i q_i (3 r_{i,\\alpha} r_{i,\\beta} - r_i^2 \\delta_{\\alpha\\beta})$. For the $zz$ component, $\\alpha=\\beta=z$, so $\\delta_{zz}=1$, and the expression becomes:\n$$ Q_{zz} = \\sum_i q_i (3 r_{i,z}^2 - r_i^2) $$\nThe sum is over the four sites. We calculate the term for each site:\n- Oxygen (O): $\\mathbf{r}_O = (0,0,0)$, so $r_{O,z}=0$ and $r_O^2=0$. Its contribution is $q_O (3(0)^2 - 0^2) = 0$.\n- Hydrogens (H1 and H2): For both atoms, $r_{i,z} = r_{OH}\\cos(\\theta_{HOH}/2)$. The squared distance from the origin is $r_i^2 = ( \\pm r_{OH}\\sin(\\theta_{HOH}/2) )^2 + 0^2 + (r_{OH}\\cos(\\theta_{HOH}/2))^2 = r_{OH}^2(\\sin^2(\\theta_{HOH}/2) + \\cos^2(\\theta_{HOH}/2)) = r_{OH}^2$. The contribution from each hydrogen is $q_H (3(r_{OH}\\cos(\\theta_{HOH}/2))^2 - r_{OH}^2)$.\n- M-site (M): $\\mathbf{r}_M = (0,0,d_{OM})$, so $r_{M,z}=d_{OM}$ and $r_M^2=d_{OM}^2$. Its contribution is $q_M (3d_{OM}^2 - d_{OM}^2) = 2 q_M d_{OM}^2$.\n\nSumming the contributions:\n$$ Q_{zz} = 2 \\times \\left[ q_H (3 r_{OH}^2 \\cos^2(\\frac{\\theta_{HOH}}{2}) - r_{OH}^2) \\right] + 2 q_M d_{OM}^2 $$\n$$ Q_{zz} = 2 q_H r_{OH}^2 (3 \\cos^2(\\frac{\\theta_{HOH}}{2}) - 1) + 2 q_M d_{OM}^2 $$\nAgain, we eliminate $q_M$ using $q_M = -q_O - 2q_H$:\n$$ Q_{zz} = 2 q_H r_{OH}^2 (3 \\cos^2(\\frac{\\theta_{HOH}}{2}) - 1) + 2(-q_O - 2q_H) d_{OM}^2 $$\n$$ Q_{zz} = 2 q_H r_{OH}^2 (3 \\cos^2(\\frac{\\theta_{HOH}}{2}) - 1) - 4 q_H d_{OM}^2- 2 q_O d_{OM}^2 $$\nGrouping terms by charge:\n$$ Q \\equiv Q_{zz} = 2 q_H \\left[ r_{OH}^2 (3 \\cos^2(\\frac{\\theta_{HOH}}{2}) - 1) - 2d_{OM}^2 \\right] - 2 q_O d_{OM}^2 $$\n\nPart 2: Derivation of the LJ energy parameter $\\epsilon$.\n\nThe Stockmayer-type potential is the sum of a Lennard-Jones ($U_{LJ}$) and a dipole-dipole ($U_{DD}$) term:\n$$ U(r) = U_{LJ}(r) + U_{DD}(r, \\omega_1, \\omega_2) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] + \\frac{1}{4\\pi\\varepsilon_0 r^3} \\left[ \\boldsymbol{\\mu}_1 \\cdot \\boldsymbol{\\mu}_2 - 3(\\boldsymbol{\\mu}_1 \\cdot \\hat{\\mathbf{r}})(\\boldsymbol{\\mu}_2 \\cdot \\hat{\\mathbf{r}}) \\right] $$\nHere, $r$ is the distance between the LJ centers (oxygen atoms), $\\epsilon$ and $\\sigma$ are the LJ parameters, $\\varepsilon_0$ is the vacuum permittivity, and $\\boldsymbol{\\mu}_i$ are the molecular dipole vectors of magnitude $\\mu$.\n\nTo nondimensionalize the potential, we define reduced quantities: $r^{\\star} = r/\\sigma$ and $U^{\\star} = U/\\epsilon$.\n$$ U^{\\star}(r^\\star) = \\frac{U(r^\\star \\sigma)}{\\epsilon} = \\frac{1}{\\epsilon} \\left( 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r^\\star \\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{r^\\star \\sigma}\\right)^6 \\right] \\right) + \\frac{1}{\\epsilon} \\left( \\frac{1}{4\\pi\\varepsilon_0 (r^\\star \\sigma)^3} \\left[ \\dots \\right] \\right) $$\nThe term in brackets $[\\dots]$ describes the orientation-dependent part of the dipole-dipole interaction. Let's denote the angular part as $g(\\omega_1, \\omega_2) = \\frac{1}{\\mu^2}[\\boldsymbol{\\mu}_1 \\cdot \\boldsymbol{\\mu}_2 - 3(\\boldsymbol{\\mu}_1 \\cdot \\hat{\\mathbf{r}})(\\boldsymbol{\\mu}_2 \\cdot \\hat{\\mathbf{r}})]$.\n$$ U^{\\star}(r^\\star, \\omega_1, \\omega_2) = 4 \\left[ (r^{\\star})^{-12} - (r^{\\star})^{-6} \\right] + \\left( \\frac{\\mu^2}{4\\pi\\varepsilon_0 \\epsilon \\sigma^3} \\right) \\frac{g(\\omega_1, \\omega_2)}{(r^{\\star})^3} $$\nThe problem defines the reduced dipole strength $\\mu^{\\star}$ as the dimensionless coefficient multiplying the orientational dipole-dipole interaction. The standard definition of the reduced dipole moment relates it to the coefficient of the dipole-dipole interaction term as follows:\n$$ (\\mu^{\\star})^2 = \\frac{\\mu^2}{4\\pi\\varepsilon_0 \\epsilon \\sigma^3} $$\nThis definition ensures that $\\mu^{\\star}$ is dimensionless and proportional to $\\mu$. We are asked to solve for $\\epsilon$. Rearranging the equation gives:\n$$ \\epsilon (\\mu^{\\star})^2 = \\frac{\\mu^2}{4\\pi\\varepsilon_0 \\sigma^3} $$\n$$ \\epsilon = \\frac{\\mu^2}{4\\pi\\varepsilon_0 \\sigma^3 (\\mu^{\\star})^2} $$\nIn this expression, $\\mu$ represents the magnitude of the dipole moment. Since the derived dipole moment vector has only a $z$-component, its magnitude is $|\\mu_z|$. The problem uses the notation $\\mu \\equiv \\mu_z$, and the expression for $\\epsilon$ involves $\\mu^2$, so the sign of $\\mu_z$ is immaterial.\n\nThe final answers are the derived expressions for $\\mu$, $Q$, and $\\epsilon$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 2 q_H (r_{OH} \\cos(\\frac{\\theta_{HOH}}{2}) - d_{OM}) - q_O d_{OM} & 2 q_H \\left[ r_{OH}^2 (3 \\cos^2(\\frac{\\theta_{HOH}}{2}) - 1) - 2d_{OM}^2 \\right] - 2 q_O d_{OM}^2 & \\frac{\\mu^2}{4\\pi\\varepsilon_0 \\sigma^3 (\\mu^{\\star})^2} \\end{pmatrix} } $$", "id": "3443213"}, {"introduction": "Implementing a rigid model in a simulation involves numerical algorithms that are not perfect, leading to subtle but important artifacts. This advanced practice explores the consequences of using a constrained integrator on the conservation of energy, a cornerstone of microcanonical ($NVE$) simulations [@problem_id:3443225]. By deriving expressions for energy fluctuations and drift, you will gain crucial insight into how choices like the time step and constraint tolerance affect the physical realism of your simulation results.", "problem": "You are to model energy conservation properties for a single rigid water molecule integrated in the microcanonical ensemble (NVE) using a constrained, time-reversible, symplectic scheme (for example, velocity Verlet with a SHAKE-style position projection). Starting from Newton’s second law with holonomic constraints, treat the rigid water as a non-linear rigid triatomic with holonomic constraints that reduce its quadratic degrees of freedom to translational and rotational motions.\n\nUse the following foundational bases without shortcut formulas:\n- Newton’s second law with holonomic constraints and Lagrange multipliers.\n- The concept of a shadow Hamiltonian for symplectic integrators: the discrete-time trajectory exactly conserves a modified Hamiltonian whose deviation from the true Hamiltonian is of higher order in the time step.\n- The equipartition theorem for classical quadratic degrees of freedom at temperature $T$.\n- Dimensional consistency and order-of-magnitude reasoning for the effect of an inexact constraint projection tolerance on energy drift.\n\nWorking assumptions for quantitative estimates in this problem:\n- Consider one rigid water molecule (non-linear rigid triatomic), so the number of quadratic degrees of freedom is $6$, corresponding to $3$ translational and $3$ rotational modes. Hence, a characteristic energy scale is $E_{\\mathrm{char}} = 3 k_{\\mathrm{B}} T$, where $k_{\\mathrm{B}}$ is the Boltzmann constant.\n- Use $k_{\\mathrm{B}} = 0.008314462618$ kJ/(mol·K). Every final energy quantity must be expressed in kJ/mol.\n- Assume a characteristic angular frequency for the smooth intermolecular forces of rigid water of $\\omega_{\\mathrm{char}} = 2\\pi \\times 10^{12}$ s$^{-1}$ (that is, $1$ terahertz angular frequency scaled by $2\\pi$). This is used only to non-dimensionalize the time step when estimating bounded oscillations in the total energy.\n- The number of holonomic constraints enforcing rigidity is $m = 3$ for water (two bond-length constraints and one angle or equivalent).\n- The constraint solver stops when a dimensionless tolerance $\\varepsilon$ is reached; a nonzero $\\varepsilon$ breaks exact symplecticity and can induce a slow linear energy drift. Assume the per-step energy defect scales as $m \\varepsilon^2 E_{\\mathrm{char}}$.\n\nFrom these bases, you must derive two quantitative predictions for a given time step $\\Delta t$ (expressed in femtoseconds), constraint tolerance $\\varepsilon$ (dimensionless), and temperature $T$ (Kelvin):\n1) A bound on the oscillatory amplitude of the total energy about a constant mean due to the shadow Hamiltonian, in kJ/mol. Denote this amplitude by $A$. Your derivation must use the characteristic timescale provided to form a dimensionless small parameter and must be consistent with symplectic backward error analysis.\n2) A linear energy drift rate per nanosecond due to finite constraint tolerance, in kJ/(mol·ns). Denote this rate by $R$. Your derivation must be consistent with the per-step defect scaling and appropriate conversion of time units.\n\nAcceptability criterion over nanosecond timescales:\n- Define a non-dimensional threshold $\\theta = 0.01$. The drift rate $R$ is acceptable if $R \\le \\theta k_{\\mathrm{B}} T$. Interpret this as “no more than a fraction $\\theta$ of $k_{\\mathrm{B}} T$ of total energy drift per nanosecond.”\n\nAngle units are not required. All energies must be reported in kJ/mol and energy drift rates in kJ/(mol·ns). The time step must be interpreted in femtoseconds, and nanoseconds must be used for drift-rate reporting.\n\nTest suite:\nFor each parameter set $(T, \\Delta t, \\varepsilon, \\tau)$, where $\\tau$ is the total simulated time in nanoseconds, compute:\n- $A$ in kJ/mol,\n- $R$ in kJ/(mol·ns),\n- a boolean indicating whether the acceptability criterion holds.\n\nUse the following four cases, each corresponding to a common rigid water parameterization label, which you will treat identically in your derivation (labels are for identification only):\n- Case $1$: model label “TIP3P”, temperature $T = 300$ K, time step $\\Delta t = 2$ fs, tolerance $\\varepsilon = 10^{-4}$, total time $\\tau = 1$ ns.\n- Case $2$: model label “SPC/E”, temperature $T = 300$ K, time step $\\Delta t = 1$ fs, tolerance $\\varepsilon = 10^{-6}$, total time $\\tau = 1$ ns.\n- Case $3$: model label “TIP4P/2005”, temperature $T = 300$ K, time step $\\Delta t = 2$ fs, tolerance $\\varepsilon = 10^{-5}$, total time $\\tau = 10$ ns.\n- Case $4$: model label “TIP3P”, temperature $T = 600$ K, time step $\\Delta t = 2$ fs, tolerance $\\varepsilon = 5\\times 10^{-5}$, total time $\\tau = 1$ ns.\n\nYour program must:\n- Implement your derived expressions consistently for all cases.\n- Use $\\omega_{\\mathrm{char}}$ as given to non-dimensionalize $\\Delta t$ when estimating $A$.\n- Convert units carefully: femtoseconds to seconds and nanoseconds to seconds where appropriate.\n\nFinal output format:\nYour program should produce a single line of output containing a Python-style list of results, one per test case, in order, with each result being a three-element list $[A, R, \\text{boolean}]$. For example, the output must look like\n\"[[A1,R1,True],[A2,R2,False],[A3,R3,True],[A4,R4,False]]\"\nwith the actual floating-point values in place of $A1$, $R1$, etc. No other characters or lines should be printed.", "solution": "The problem requires the derivation of two quantities related to energy conservation in a molecular dynamics simulation of a single rigid water molecule: the amplitude of energy oscillations, $A$, arising from the use of a symplectic integrator, and the rate of linear energy drift, $R$, due to an inexact constraint-solving algorithm. The problem is scientifically well-posed and contains all necessary information for a complete derivation from first principles.\n\n**1. Derivation of the Energy Oscillation Amplitude ($A$)**\n\nA symplectic numerical integrator, such as the velocity Verlet algorithm, applied to a Hamiltonian system, does not conserve the true Hamiltonian, $H$. Instead, it exactly conserves a modified \"shadow\" Hamiltonian, $H_{\\text{shadow}}$. From the theory of backward error analysis, for a time step $\\Delta t$, the shadow Hamiltonian is an asymptotic series in even powers of $\\Delta t$:\n$$H_{\\text{shadow}} = H + \\mathcal{O}((\\Delta t)^2)$$\nThe true energy $H(t)$, when evaluated along a trajectory generated using $H_{\\text{shadow}}$, is therefore not constant but exhibits bounded oscillations around a mean value. The amplitude of these oscillations, which we denote as $A$, is proportional to the leading-order error term.\n\nThe problem specifies that the derivation should use the provided characteristic angular frequency $\\omega_{\\mathrm{char}} = 2\\pi \\times 10^{12}$ s$^{-1}$ to non-dimensionalize the time step, forming the dimensionless parameter $\\omega_{\\mathrm{char}} \\Delta t$. The magnitude of the energy fluctuations is also proportional to a characteristic energy of the system. The problem defines this as $E_{\\mathrm{char}} = 3 k_{\\mathrm{B}} T$. This is consistent with the equipartition theorem for a non-linear rigid molecule with $6$ degrees of freedom ($3$ translational and $3$ rotational), where the average energy is $\\langle E \\rangle = \\frac{6}{2} k_{\\mathrm{B}} T = 3 k_{\\mathrm{B}} T$.\n\nCombining these elements, we can construct an order-of-magnitude estimate for the amplitude $A$ by assuming a proportionality constant of unity:\n$$A \\approx (\\omega_{\\mathrm{char}} \\Delta t)^2 E_{\\mathrm{char}}$$\nTo ensure dimensional consistency, we must convert the time step $\\Delta t$, given in femtoseconds (fs), to seconds (s) using the relation $1 \\text{ fs} = 10^{-15} \\text{ s}$. Substituting $E_{\\mathrm{char}} = 3 k_{\\mathrm{B}} T$, the final expression for $A$ in kJ/mol is:\n$$A(T, \\Delta t) = \\left( \\omega_{\\mathrm{char}} \\cdot (\\Delta t \\times 10^{-15}) \\right)^2 \\cdot (3 k_{\\mathrm{B}} T)$$\n\n**2. Derivation of the Linear Energy Drift Rate ($R$)**\n\nThe enforcement of holonomic constraints for molecular rigidity is typically achieved with an iterative algorithm (like SHAKE) that stops when a certain numerical tolerance, $\\varepsilon$, is met. This finite tolerance breaks the perfect time-reversibility and symplecticity of the underlying integrator, introducing a small, systematic energy error in each step. This error accumulates over time, resulting in a linear energy drift.\n\nThe problem provides the scaling for the energy defect per time step, $\\Delta E_{\\mathrm{step}}$, as:\n$$\\Delta E_{\\mathrm{step}} \\propto m \\varepsilon^2 E_{\\mathrm{char}}$$\nHere, $m$ is the number of holonomic constraints. For a rigid water molecule, there are three constraints (two bond lengths and one angle), so $m=3$. Again assuming a proportionality constant of unity and substituting $E_{\\mathrm{char}} = 3 k_{\\mathrm{B}} T$:\n$$\\Delta E_{\\mathrm{step}} \\approx 3 \\cdot \\varepsilon^2 \\cdot (3 k_{\\mathrm{B}} T) = 9 \\varepsilon^2 k_{\\mathrm{B}} T$$\nThe energy drift rate, $R$, is the energy defect per unit time. The problem requires $R$ in units of kJ/(mol·ns). We obtain this by dividing the per-step energy defect (in kJ/mol) by the duration of the time step, $\\Delta t$, expressed in nanoseconds (ns). Given $\\Delta t$ in femtoseconds, we use the conversion $1 \\text{ ns} = 10^6 \\text{ fs}$, so $\\Delta t_{\\text{ns}} = \\Delta t_{\\text{fs}} \\times 10^{-6}$.\n$$R = \\frac{\\Delta E_{\\mathrm{step}}}{\\Delta t_{\\text{ns}}}$$\nThe final expression for the drift rate is:\n$$R(T, \\Delta t, \\varepsilon) = \\frac{9 \\varepsilon^2 k_{\\mathrm{B}} T}{\\Delta t \\times 10^{-6}}$$\n\n**3. Acceptability Criterion**\n\nThe problem defines an acceptability criterion for the drift rate: $R \\le \\theta k_{\\mathrm{B}} T$, with $\\theta = 0.01$. The interpretation is that the energy drift per nanosecond should not exceed a fraction $\\theta$ of the thermal energy scale $k_{\\mathrm{B}} T$. This implies that the threshold value, $R_{\\text{crit}} = \\theta k_{\\mathrm{B}} T$, has units of kJ/(mol·ns) for the comparison. Thus, for each case, we will check if the calculated value of $R$ satisfies $R \\le 0.01 \\cdot k_{\\mathrm{B}} \\cdot T$.", "answer": "[[0.012506822812675953,0.33261625902199995,False],[7.816764257922471e-05,0.002217441726813333,True],[0.012506822812675953,0.00831540647555,True],[0.025013645625351906,0.4157703237775,False]]", "id": "3443225"}]}