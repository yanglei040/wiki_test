{"hands_on_practices": [{"introduction": "Correctly setting up the equations of motion is the foundation of any valid molecular dynamics simulation. This first exercise focuses on the fundamental structure of the Nosé-Hoover chain equations and the precise counting of degrees of freedom. By reasoning through how constraints on particle motion, such as fixed bond lengths or zero center-of-mass momentum, affect the thermodynamic properties of the system, you will solidify your understanding of the crucial parameter $g$ that ensures the thermostat targets the correct temperature [@problem_id:3429682].", "problem": "Consider a classical molecular system of $N$ point particles of masses $\\{m_i\\}_{i=1}^N$ in $d$ spatial dimensions with holonomic constraints $C_a(\\mathbf{q})=0$ for $a=1,\\dots,n_c$, enforced exactly. The total center-of-mass (COM) linear momentum is constrained to vanish at all times. The system is thermostatted in the canonical ensemble at temperature $T$ using a Nosé-Hoover chain (NHC), where the physical momenta $\\{\\mathbf{p}_i\\}$ are coupled only to the first thermostat variable with velocity $\\xi_1$ and mass parameter $Q_1$, and the first thermostat itself is coupled to a second thermostat with velocity $\\xi_2$ (chain length at least $2$). The physical equations of motion are of the form\n- $d\\mathbf{q}_i/dt=\\mathbf{p}_i/m_i$,\n- $d\\mathbf{p}_i/dt=\\mathbf{F}_i(\\mathbf{q})-\\xi_1\\,\\mathbf{p}_i+\\text{constraint forces}$,\nand the chain variables evolve according to some ordinary differential equations (ODEs) to be determined. Let $K$ denote the instantaneous kinetic energy of the thermostatted, independent momenta that remain after enforcing all constraints. In equilibrium at temperature $T$, the equipartition theorem implies $\\langle K\\rangle=(g/2)\\,k_{\\mathrm{B}}T$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $g$ is the number of independent quadratic momentum degrees of freedom actually sampled by the thermostat.\n\nUsing only Newton’s laws, the definition of kinetic energy $K=\\sum (\\mathbf{p}_i^2/2m_i)$ over independent momenta, the effect of the friction-like term $-\\xi_1\\mathbf{p}_i$ on the rate of change of kinetic energy, and the equipartition relation $\\langle K\\rangle=(g/2)\\,k_{\\mathrm{B}}T$, reason about (i) the form of the first thermostat ODE that consistently drives $K$ toward its canonical target while allowing coupling to the second thermostat in a chain, and (ii) the correct value of $g$ when there are $n_c$ holonomic constraints and the COM momentum is constrained to zero. Select the single option that is consistent with these requirements.\n\nA. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1-\\xi_2\\,\\xi_1$, with $g=dN-n_c-d$ when the COM momentum is constrained to zero, and $K$ computed over the independent momenta only.\n\nB. $d\\xi_1/dt=(K-(g/2)\\,k_{\\mathrm{B}}T)/Q_1-\\xi_2\\,\\xi_1$, with $g=dN$, independent of constraints or momentum removal.\n\nC. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1$, with no coupling to $\\xi_2$, and $g=dN-n_c$, regardless of any COM momentum constraint.\n\nD. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1-\\xi_1^2$, with $g=dN-n_c-2d$ when the COM momentum is constrained to zero.", "solution": "The user wants me to validate and solve a problem concerning a Nosé-Hoover chain thermostat in a classical molecular dynamics simulation.\n\n### Problem Validation\n\nFirst, I will extract the givens and validate the problem statement.\n\n**Step 1: Extract Givens**\n-   System: A classical system of $N$ point particles with masses $\\{m_i\\}_{i=1}^N$ in $d$ spatial dimensions.\n-   Holonomic Constraints: $n_c$ constraints of the form $C_a(\\mathbf{q})=0$ are enforced exactly.\n-   Center-of-Mass (COM) Momentum Constraint: The total COM linear momentum is constrained to be zero at all times.\n-   Thermostatting: The system is in the canonical ensemble at temperature $T$, using a Nosé-Hoover chain (NHC) of length at least $2$.\n-   Coupling Scheme: The physical momenta $\\{\\mathbf{p}_i\\}$ are coupled only to the first thermostat variable, which has velocity $\\xi_1$ and mass parameter $Q_1$. The first thermostat is coupled to a second thermostat with velocity $\\xi_2$.\n-   Particle Equations of Motion (EOMs):\n    -   $d\\mathbf{q}_i/dt = \\mathbf{p}_i/m_i$\n    -   $d\\mathbf{p}_i/dt = \\mathbf{F}_i(\\mathbf{q}) - \\xi_1\\,\\mathbf{p}_i + \\text{constraint forces}$\n-   Kinetic Energy, $K$: $K$ is the instantaneous kinetic energy of the independent momenta remaining after all constraints are enforced.\n-   Equipartition Theorem: In equilibrium, $\\langle K \\rangle = (g/2)\\,k_{\\mathrm{B}}T$, where $g$ is the number of independent quadratic momentum degrees of freedom sampled by the thermostat and $k_{\\mathrm{B}}$ is the Boltzmann constant.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding:** The problem is firmly grounded in the well-established theory of statistical mechanics and computational physics, specifically concerning molecular dynamics simulations and constant temperature ensembles. The Nosé-Hoover chain is a standard, widely-used algorithm. The concepts of holonomic constraints and COM momentum removal are also standard practice. The problem is scientifically sound.\n-   **Well-Posedness:** The problem asks for the EOM of the first thermostat variable and the number of degrees of freedom, $g$. These quantities are uniquely determined by the theoretical framework of the NHC thermostat and constraint dynamics. The setup is sufficient to derive a single, correct answer.\n-   **Objectivity:** The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, objective, and self-contained. It is a valid problem. I will proceed to derive the solution.\n\n### Derivation\n\nThe problem has two parts: (i) determining the equation of motion for the first thermostat variable, $\\xi_1$, and (ii) determining the correct value for the number of degrees of freedom, $g$.\n\n**(i) Equation of Motion for $\\xi_1$**\n\nThe Nosé-Hoover chain thermostat is designed to generate a canonical phase space distribution. This is achieved by introducing a chain of fictitious thermostat variables. The first variable, $\\xi_1$, directly couples to the physical system's kinetic energy, $K$. Each subsequent variable in the chain, $\\xi_j$, thermostats the preceding one, $\\xi_{j-1}$.\n\nThe general structure of the NHC equations of motion is as follows. The EOM for a thermostat variable $\\xi_j$ is driven by the kinetic energy of the variable(s) it thermostats, and it is damped by the next thermostat variable in the chain, $\\xi_{j+1}$.\n\nFor the first thermostat variable, $\\xi_1$, the \"kinetic energy\" it controls is that of the physical particles, $K$. The thermostat is designed to drive $K$ towards its canonical ensemble average, which is $\\langle K \\rangle = (g/2)k_{\\mathrm{B}}T$. The driving term in the EOM for a Nosé-Hoover style thermostat is proportional to the deviation of the instantaneous \"kinetic temperature\" from the target temperature. For the quantity $2K$, the target value is $g k_{\\mathrm{B}}T$. Thus, the driving term is $(2K - g k_{\\mathrm{B}}T)$.\n\nThe problem states that the chain has a length of at least $2$, meaning $\\xi_1$ is coupled to a second thermostat variable $\\xi_2$. In the NHC formalism, this coupling takes the form of a friction-like term. The EOM for the momentum $p_1 = Q_1 \\xi_1$ of the first thermostat is damped by the second. A standard derivation from the extended Hamiltonian shows the damping term for $\\dot{p_1}$ is $-\\xi_2 p_1$. The full equation for $p_1$ is:\n$$ \\frac{dp_1}{dt} = 2K - g k_{\\mathrm{B}}T - \\xi_2 p_1 $$\nSubstituting $p_1 = Q_1 \\xi_1$ and $dp_1/dt = Q_1 (d\\xi_1/dt)$, we get:\n$$ Q_1 \\frac{d\\xi_1}{dt} = 2K - g k_{\\mathrm{B}}T - \\xi_2 (Q_1 \\xi_1) $$\nDividing by the thermostat mass parameter $Q_1$ gives the EOM for the thermostat velocity $\\xi_1$:\n$$ \\frac{d\\xi_1}{dt} = \\frac{2K - g k_{\\mathrm{B}}T}{Q_1} - \\xi_2 \\xi_1 $$\nThis equation shows that if the kinetic energy $K$ is too high, $\\xi_1$ tends to increase, enhancing the friction on the particles (since $\\dot{\\mathbf{p}}_i \\propto -\\xi_1 \\mathbf{p}_i$) and cooling the system. If $K$ is too low, $\\xi_1$ tends to decrease, leading to heating. The term $-\\xi_2 \\xi_1$ represents the thermostatting of the first thermostat itself, which is essential for ensuring ergodicity and proper canonical sampling.\n\n**(ii) Number of Degrees of Freedom, $g$**\n\nThe parameter $g$ represents the number of independent quadratic momentum degrees of freedom that are being thermostatted. This is the total number of kinetic degrees of freedom of the system.\n\n1.  The system has $N$ particles in $d$ dimensions. Without any constraints, there are $d$ momentum components for each particle, leading to a total of $dN$ momentum degrees of freedom.\n\n2.  There are $n_c$ holonomic constraints, $C_a(\\mathbf{q})=0$. For these constraints to hold at all times, their time derivatives must be zero:\n    $$ \\frac{dC_a}{dt} = \\sum_{i=1}^N \\frac{\\partial C_a}{\\partial \\mathbf{q}_i} \\cdot \\frac{d\\mathbf{q}_i}{dt} = \\sum_{i=1}^N \\frac{\\partial C_a}{\\partial \\mathbf{q}_i} \\cdot \\frac{\\mathbf{p}_i}{m_i} = 0 $$\n    Each of these $n_c$ equations imposes an independent linear constraint on the momentum components $\\{\\mathbf{p}_i\\}$. Therefore, the holonomic constraints remove $n_c$ degrees of freedom. The number of remaining degrees of freedom is $dN - n_c$.\n\n3.  The total center-of-mass (COM) momentum is constrained to be zero. The COM momentum is the vector $\\mathbf{P}_{\\text{COM}} = \\sum_{i=1}^N \\mathbf{p}_i$. The constraint $\\mathbf{P}_{\\text{COM}} = \\mathbf{0}$ is a vector equation, which decomposes into $d$ independent scalar equations, one for each spatial dimension:\n    $$ \\sum_{i=1}^N p_{i,x} = 0, \\quad \\sum_{i=1}^N p_{i,y} = 0, \\quad \\dots \\quad (d \\text{ components})$$\n    These $d$ constraints are, in general, independent of the holonomic constraints. For instance, fixing bond lengths in a molecule does not fix its overall momentum. Therefore, these constraints remove an additional $d$ degrees of freedom.\n\nCombining these, the total number of independent momentum degrees of freedom being thermostatted is:\n$$ g = dN - n_c - d $$\nThe kinetic energy $K$ that enters the thermostat equation must be computed over precisely these $g$ independent degrees of freedom.\n\n### Option-by-Option Analysis\n\n**A. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1-\\xi_2\\,\\xi_1$, with $g=dN-n_c-d$ when the COM momentum is constrained to zero, and $K$ computed over the independent momenta only.**\n-   **ODE Form:** The equation $d\\xi_1/dt = (2K-g\\,k_{\\mathrm{B}}T)/Q_1 - \\xi_2\\,\\xi_1$ correctly represents the dynamics of the first variable in a Nosé-Hoover chain.\n-   **Value of $g$:** The value $g=dN-n_c-d$ correctly counts the number of independent momentum degrees of freedom by subtracting those removed by the $n_c$ holonomic constraints and the $d$ COM momentum constraints.\n-   **Verdict:** This option is fully consistent with the derived results. **Correct**.\n\n**B. $d\\xi_1/dt=(K-(g/2)\\,k_{\\mathrm{B}}T)/Q_1-\\xi_2\\,\\xi_1$, with $g=dN$, independent of constraints or momentum removal.**\n-   **ODE Form:** The form $d\\xi_1/dt = (K-(g/2)\\,k_{\\mathrm{B}}T)/Q_1 - \\xi_2\\,\\xi_1$ is algebraically equivalent to $(2K-g\\,k_{\\mathrm{B}}T)/(2Q_1) - \\xi_2\\,\\xi_1$. While the form is structurally plausible (it's a matter of defining $Q_1$), the value of $g$ is incorrect.\n-   **Value of $g$:** The value $g=dN$ fails to account for any of the constraints. This would lead to an incorrect target temperature for the actual dynamic degrees of freedom.\n-   **Verdict:** The value of $g$ is incorrect. **Incorrect**.\n\n**C. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1$, with no coupling to $\\xi_2$, and $g=dN-n_c$, regardless of any COM momentum constraint.**\n-   **ODE Form:** The equation lacks the $-\\xi_2\\,\\xi_1$ coupling term. This describes a simple Nosé-Hoover thermostat, not a Nosé-Hoover *chain* as specified in the problem.\n-   **Value of $g$:** The value $g=dN-n_c$ incorrectly ignores the $d$ constraints imposed by fixing the COM momentum to zero.\n-   **Verdict:** Both the ODE form and the value of $g$ are incorrect. **Incorrect**.\n\n**D. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1-\\xi_1^2$, with $g=dN-n_c-2d$ when the COM momentum is constrained to zero.**\n-   **ODE Form:** The damping term is $-\\xi_1^2$, which implies self-damping. In an NHC, thermostat $\\xi_1$ is damped by $\\xi_2$, not by itself. This form is incorrect for an NHC.\n-   **Value of $g$:** The value $g=dN-n_c-2d$ is incorrect. It subtracts $2d$ degrees of freedom for the COM constraint, but setting the COM momentum vector to zero imposes only $d$ constraints.\n-   **Verdict:** Both the ODE form and the value of $g$ are incorrect. **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "3429682"}, {"introduction": "A thermostat can be viewed as a feedback controller that regulates a system's temperature. This practice adopts a control theory perspective to analyze the stability and performance of a Nosé-Hoover thermostat. By linearizing a coarse-grained model of the temperature dynamics, you will derive the thermostat's natural frequency of oscillation, revealing the direct link between the thermostat mass parameter $Q$ and the timescale of temperature fluctuations [@problem_id:3429699]. This analysis is key to tuning the thermostat for a stable yet responsive simulation, avoiding both sluggish control and resonant instabilities.", "problem": "Consider a classical system with $g$ mechanical degrees of freedom and instantaneous kinetic energy $K(t)$, integrated by deterministic molecular dynamics under a Nosé–Hoover thermostat. The kinetic temperature is defined by $T(t) = \\dfrac{2 K(t)}{g k_B}$, where $k_B$ is the Boltzmann constant and $T_0$ is the target temperature. The Nosé–Hoover thermostat exerts a friction-like coupling through a scalar thermostat variable $\\xi(t)$ that modifies the momenta $\\{p_i\\}$ via $\\dfrac{d p_i}{d t} = F_i - \\xi p_i$, and evolves according to\n$$\n\\frac{d \\xi}{d t} = \\frac{2 K(t) - g k_B T_0}{Q(t)} \\, ,\n$$\nwhere $Q(t)$ is the thermostat mass parameter. In the near-equilibrium, coarse-grained limit in which the rapid exchange between kinetic and potential energy is averaged out, the kinetic temperature obeys\n$$\n\\frac{d T}{d t} \\approx - 2 \\, \\xi \\, T \\, .\n$$\nYou are tasked with designing an adaptive thermostat mass controller that depends on the instantaneous temperature error $e(t) = T(t) - T_0$ through\n$$\nQ(t) = \\frac{Q_0}{1 + \\gamma \\, e(t)^2} \\, ,\n$$\nwith constants $Q_0 > 0$ and $\\gamma \\ge 0$. Treat the molecular system as ergodic on the thermostat timescale so that the above coarse-grained temperature equation is valid. Work in the closed loop defined by the dynamics of $T(t)$ and $\\xi(t)$.\n\nStarting only from the definitions and equations given in this statement, perform a linearization about the equilibrium point defined by $T = T_0$ and $\\xi = 0$. Determine the linearized closed-loop error dynamics for $e(t)$ and deduce, from the characteristic equation, the regions of linear stability and the presence or absence of oscillatory overshoot in terms of the sign of $Q_0$. Then extract the linearized natural frequency $\\omega_0$ of the temperature error mode.\n\nAnswer specification: Report only the linearized natural frequency $\\omega_0$ as a single, closed-form symbolic expression in terms of $g$, $k_B$, $T_0$, and $Q_0$. Do not evaluate numerically. Do not include units in your final reported expression.", "solution": "## PROBLEM VALIDATION\n\n### Step 1: Extract Givens\n- System: A classical system with $g$ mechanical degrees of freedom.\n- Instantaneous kinetic energy: $K(t)$.\n- Integration method: Deterministic molecular dynamics under a Nosé–Hoover thermostat.\n- Kinetic temperature definition: $T(t) = \\dfrac{2 K(t)}{g k_B}$.\n- Target temperature: $T_0$.\n- Boltzmann constant: $k_B$.\n- Thermostat variable: $\\xi(t)$.\n- Equation of motion for momenta $\\{p_i\\}$: $\\dfrac{d p_i}{d t} = F_i - \\xi p_i$.\n- Equation of motion for the thermostat variable: $\\dfrac{d \\xi}{d t} = \\dfrac{2 K(t) - g k_B T_0}{Q(t)}$.\n- Thermostat mass parameter: $Q(t)$.\n- Coarse-grained approximation for temperature evolution: $\\dfrac{d T}{d t} \\approx - 2 \\, \\xi \\, T$.\n- Adaptive thermostat mass controller: $Q(t) = \\dfrac{Q_0}{1 + \\gamma \\, e(t)^2}$, with $Q_0 > 0$ and $\\gamma \\ge 0$.\n- Instantaneous temperature error: $e(t) = T(t) - T_0$.\n- Assumption: The molecular system is ergodic on the thermostat timescale, validating the coarse-grained temperature equation.\n- Analysis point: The equilibrium point defined by $T = T_0$ and $\\xi = 0$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is firmly located within the standard theoretical framework of molecular dynamics simulations. The Nosé-Hoover thermostat, the definition of kinetic temperature, and the concept of a thermostat \"mass\" are all established concepts in statistical mechanics and computational physics. The proposed adaptive mass controller is a plausible extension for Rienstra-like control schemes applied to this context. The problem is scientifically sound.\n2.  **Well-Posed:** The problem provides a closed system of differential equations and asks for a specific analysis (linearization) and a specific result (natural frequency). The provided information is sufficient to perform the analysis and obtain a unique answer.\n3.  **Objective:** The problem is stated using precise mathematical and physical terminology, free of subjective language.\n4.  **Completeness and Consistency:** All necessary equations and definitions are provided. There are no contradictions. For example, the definition of kinetic temperature $2K(t) = g k_B T(t)$ is consistent with its use in the equation for $d\\xi/dt$.\n5.  **Realism and Feasibility:** The parameters and equations describe a valid theoretical model in computational physics. No physically impossible conditions are stipulated.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined exercise in the linear stability analysis of a dynamical system relevant to molecular dynamics. The solution can now proceed.\n\n## SOLUTION\n\nThe problem requires a linearization of the closed-loop dynamics of the temperature error $e(t)$ and the thermostat variable $\\xi(t)$ around the specified equilibrium point. The system is described by two coupled, first-order, non-linear ordinary differential equations.\n\nFirst, we express the given dynamical equations in terms of the error variable $e(t) = T(t) - T_0$. By definition, this implies $T(t) = T_0 + e(t)$ and $\\dfrac{d T}{d t} = \\dfrac{d e}{d t}$.\n\nThe coarse-grained equation for the temperature is:\n$$\n\\frac{d T}{d t} = -2 \\, \\xi \\, T\n$$\nSubstituting $T(t) = T_0 + e(t)$, we get the equation for the evolution of the error, $e(t)$:\n$$\n\\frac{d e}{d t} = -2 \\, \\xi \\, (T_0 + e(t))\n$$\n\nNext, we consider the equation for the evolution of the thermostat variable, $\\xi(t)$:\n$$\n\\frac{d \\xi}{d t} = \\frac{2 K(t) - g k_B T_0}{Q(t)}\n$$\nUsing the definition of kinetic temperature, $T(t) = \\dfrac{2 K(t)}{g k_B}$, we can write $2 K(t) = g k_B T(t)$. Substituting this into the equation for $\\dfrac{d \\xi}{d t}$:\n$$\n\\frac{d \\xi}{d t} = \\frac{g k_B T(t) - g k_B T_0}{Q(t)} = \\frac{g k_B (T(t) - T_0)}{Q(t)}\n$$\nNow, substituting $e(t) = T(t) - T_0$ and the given form of the adaptive mass $Q(t) = \\dfrac{Q_0}{1 + \\gamma \\, e(t)^2}$:\n$$\n\\frac{d \\xi}{d t} = \\frac{g k_B e(t)}{\\frac{Q_0}{1 + \\gamma \\, e(t)^2}} = \\frac{g k_B e(t) (1 + \\gamma \\, e(t)^2)}{Q_0}\n$$\n\nThe system of non-linear differential equations for the state variables $(e, \\xi)$ is therefore:\n$$\n\\begin{cases}\n\\dfrac{d e}{d t} = -2 \\, T_0 \\, \\xi - 2 \\, e \\, \\xi \\\\\n\\dfrac{d \\xi}{d t} = \\dfrac{g k_B}{Q_0} e + \\dfrac{g k_B \\gamma}{Q_0} e^3\n\\end{cases}\n$$\nThe problem specifies the equilibrium point as $T = T_0$ (which corresponds to $e = 0$) and $\\xi = 0$. We linearize the system by expanding the right-hand sides around this point, $(e, \\xi) = (0, 0)$, and retaining only the terms that are linear in $e$ and $\\xi$.\nFor the first equation, the term $-2 \\, e \\, \\xi$ is quadratic in the state variables and is dropped in the linearization.\nFor the second equation, the term $\\dfrac{g k_B \\gamma}{Q_0} e^3$ is cubic and is dropped.\n\nThe resulting linearized system of equations is:\n$$\n\\begin{cases}\n\\dfrac{d e}{d t} = -2 \\, T_0 \\, \\xi \\\\\n\\dfrac{d \\xi}{d t} = \\dfrac{g k_B}{Q_0} e\n\\end{cases}\n$$\nThis can be written in matrix form as:\n$$\n\\frac{d}{dt} \\begin{pmatrix} e \\\\ \\xi \\end{pmatrix} = \\begin{pmatrix} 0 & -2 T_0 \\\\ \\frac{g k_B}{Q_0} & 0 \\end{pmatrix} \\begin{pmatrix} e \\\\ \\xi \\end{pmatrix}\n$$\nTo find the closed-loop error dynamics for $e(t)$, we can differentiate the first linearized equation with respect to time:\n$$\n\\frac{d^2 e}{d t^2} = -2 \\, T_0 \\, \\frac{d \\xi}{d t}\n$$\nNow, substitute the second linearized equation into this expression:\n$$\n\\frac{d^2 e}{d t^2} = -2 \\, T_0 \\left( \\frac{g k_B}{Q_0} e \\right)\n$$\nRearranging this gives a second-order linear homogeneous ordinary differential equation for the error $e(t)$:\n$$\n\\frac{d^2 e}{d t^2} + \\left( \\frac{2 g k_B T_0}{Q_0} \\right) e = 0\n$$\nThis equation is the standard form of an undamped simple harmonic oscillator, $\\dfrac{d^2 x}{dt^2} + \\omega_0^2 x = 0$, where $\\omega_0$ is the natural angular frequency.\n\nThe characteristic equation of this system is found by assuming a solution of the form $e(t) \\propto \\exp(\\lambda t)$, which yields:\n$$\n\\lambda^2 + \\frac{2 g k_B T_0}{Q_0} = 0\n$$\nThe eigenvalues are $\\lambda = \\pm \\sqrt{-\\dfrac{2 g k_B T_0}{Q_0}}$.\nGiven the problem constraints $g > 0$, $k_B > 0$, $T_0 > 0$, and importantly $Q_0 > 0$, the term inside the square root is negative. The eigenvalues are purely imaginary:\n$$\n\\lambda = \\pm i \\sqrt{\\frac{2 g k_B T_0}{Q_0}}\n$$\nThis indicates that the linearized system is marginally stable and exhibits undamped oscillations around the equilibrium point. The presence of oscillations confirms that there will be oscillatory overshoot in the temperature response. If $Q_0$ were negative, the eigenvalues would be real (one positive, one negative), leading to exponential instability without oscillations.\n\nBy direct comparison of our derived equation for $e(t)$ with the canonical form of a harmonic oscillator, we can identify the square of the linearized natural frequency $\\omega_0^2$ as:\n$$\n\\omega_0^2 = \\frac{2 g k_B T_0}{Q_0}\n$$\nThe linearized natural frequency $\\omega_0$ is the positive square root of this quantity:\n$$\n\\omega_0 = \\sqrt{\\frac{2 g k_B T_0}{Q_0}}\n$$\nThis is the final expression required by the problem.", "answer": "$$\\boxed{\\sqrt{\\frac{2 g k_B T_0}{Q_0}}}$$", "id": "3429699"}, {"introduction": "For complex molecules or materials, a single thermostat coupled to all degrees of freedom may not be optimal, as it can inefficiently thermalize motions occurring at different frequencies. This advanced practice introduces the powerful technique of mode-selective thermostatting, where independent thermostats are coupled to the system's underlying vibrational modes. You will derive how to engineer the thermostat mass parameter $Q_k$ for each mode to achieve a uniform \"feedback bandwidth\" across all frequencies, a sophisticated approach that ensures efficient and accurate thermal equilibration for all parts of the system [@problem_id:3429718].", "problem": "Consider a one-dimensional periodic harmonic chain of $N$ identical particles of mass $m$ and lattice spacing $a$, with nearest-neighbor spring constant $K$. The Hamiltonian is\n$$\nH = \\sum_{j=1}^{N} \\left( \\frac{p_j^2}{2m} + \\frac{K}{2} \\left( x_{j+1} - x_j \\right)^2 \\right),\n$$\nwith periodic boundary conditions $x_{N+1} \\equiv x_1$. \n\n1. Using the discrete Fourier transform to normal coordinates, diagonalize the chain into independent normal modes indexed by wave number $k$ and show that the dynamics reduces to a set of decoupled harmonic oscillators with coordinates $q_k$, conjugate momenta $p_k$, and angular frequencies $\\omega_k$.\n\n2. To each normal mode, attach an independent Nosé-Hoover thermostat (NHT), defined by introducing, for each mode $k$, a thermostat friction variable $\\xi_k$ with thermostat mass parameter $Q_k$ and temperature $T$. The mode-level equations of motion are\n$$\n\\dot{q}_k = \\frac{p_k}{m},\\quad \\dot{p}_k = - m \\omega_k^2 q_k - \\xi_k p_k,\\quad \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right),\n$$\nwhere $k_B$ is the Boltzmann constant.\n\n3. Define the instantaneous mode energy by $E_k = \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2$. By starting from Newton’s equations and the Nosé-Hoover equations above, and without assuming any special form beyond harmonicity, derive the averaged slow dynamics for the mode energy $E_k$ and the thermostat variable $\\xi_k$ by averaging over the fast phase of the harmonic motion. Linearize these averaged equations about the thermal fixed point $E_k = k_B T$, $\\xi_k = 0$ to obtain a two-dimensional linear system. From this linearized system, extract the small-signal angular frequency $\\Omega_k$ that characterizes the feedback exchange rate between the mode energy and the thermostat.\n\n4. You are tasked with designing a mode-specific thermostat mass function $Q_k(\\omega_k)$ so that the feedback bandwidth is flat across mode frequencies in the following precise sense: the ratio of the small-signal feedback rate to the mode’s angular frequency is a prescribed constant $c>0$ for all modes, that is, $\\Omega_k / \\omega_k = c$ for every $k$. Using only the result of your linearization and the definition of $\\Omega_k$, determine a closed-form expression for $Q_k(\\omega_k)$ as a function of $\\omega_k$, $k_B$, $T$, and $c$.\n\nProvide your final answer as a single closed-form analytic expression in terms of $\\omega$, $k_B$, $T$, and $c$. Do not include units in your final answer.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It outlines a standard, albeit detailed, theoretical exercise in the field of molecular dynamics simulation, specifically concerning the application of Nosé-Hoover thermostats to the normal modes of a harmonic system. We can therefore proceed with the derivation.\n\nThe first step of diagonalizing the harmonic chain Hamiltonian via a discrete Fourier transform is a standard result in solid-state physics. It decomposes the collective motion of the $N$ particles into $N$ independent normal modes, each behaving as a harmonic oscillator with a specific angular frequency $\\omega_k$. The problem asks us to consider one such generic mode $k$ with coordinates $q_k$, momenta $p_k$, and frequency $\\omega_k$.\n\nThe second step provides the equations of motion for this mode when coupled to a Nosé-Hoover thermostat (NHT). These equations define the dynamics we must analyze:\n$$ \\dot{q}_k = \\frac{p_k}{m} $$\n$$ \\dot{p}_k = - m \\omega_k^2 q_k - \\xi_k p_k $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right) $$\nHere, $\\xi_k$ is the thermostat dynamical friction coefficient, $Q_k$ is the thermostat mass parameter that sets its response timescale, $T$ is the target temperature, and $k_B$ is the Boltzmann constant.\n\nThe third step requires us to find the slow dynamics by averaging over the fast oscillations of the harmonic mode. We begin by defining the instantaneous energy of the mode, $E_k$:\n$$ E_k = \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2 $$\nWe calculate its time derivative, $\\dot{E}_k$, using the chain rule and substituting the equations of motion for $\\dot{q}_k$ and $\\dot{p}_k$:\n$$ \\dot{E}_k = \\frac{d}{dt} \\left( \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2 \\right) = \\frac{p_k \\dot{p}_k}{m} + m \\omega_k^2 q_k \\dot{q}_k $$\n$$ \\dot{E}_k = \\frac{p_k}{m} \\left( - m \\omega_k^2 q_k - \\xi_k p_k \\right) + m \\omega_k^2 q_k \\left( \\frac{p_k}{m} \\right) $$\n$$ \\dot{E}_k = - \\omega_k^2 p_k q_k - \\frac{\\xi_k p_k^2}{m} + \\omega_k^2 q_k p_k $$\nThe terms involving $p_k q_k$ cancel, leaving:\n$$ \\dot{E}_k = - \\frac{\\xi_k p_k^2}{m} $$\nThe full system for the variables $(E_k, \\xi_k)$ is thus:\n$$ \\dot{E}_k = - \\xi_k \\frac{p_k^2}{m} $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right) $$\nThe core idea of the slow-dynamics approximation is that the variables $E_k$ and $\\xi_k$ change slowly compared to the harmonic oscillation at frequency $\\omega_k$. We can therefore average the right-hand sides of these equations over one period of the fast motion. For a harmonic oscillator of energy $E_k$, the virial theorem states that the average kinetic energy equals the average potential energy, so $\\left\\langle \\frac{p_k^2}{2m} \\right\\rangle_{fast} = \\frac{E_k}{2}$. This implies that the average of the term appearing in the equations is $\\left\\langle \\frac{p_k^2}{m} \\right\\rangle_{fast} = E_k$. Treating $E_k$ and $\\xi_k$ as constants during this averaging process, we obtain the averaged equations of motion for the slow variables:\n$$ \\dot{E}_k = - \\xi_k E_k $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( E_k - k_B T \\right) $$\nThe fixed point of this $2$-dimensional system is found by setting $\\dot{E}_k = 0$ and $\\dot{\\xi}_k = 0$. The second equation gives $E_k^* = k_B T$. Substituting this into the first equation gives $-\\xi_k^* (k_B T) = 0$, which implies $\\xi_k^* = 0$ as $k_B T > 0$. The fixed point is thus $(E_k^*, \\xi_k^*) = (k_B T, 0)$.\n\nNext, we linearize this system around the fixed point. Let $E_k(t) = k_B T + \\delta E_k(t)$ and $\\xi_k(t) = 0 + \\delta \\xi_k(t)$, where $\\delta E_k$ and $\\delta \\xi_k$ are small deviations. Substituting these into the averaged equations and retaining only first-order terms gives:\n$$ \\delta \\dot{E}_k = -(0 + \\delta \\xi_k)(k_B T + \\delta E_k) \\approx -(k_B T) \\delta \\xi_k $$\n$$ \\delta \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( (k_B T + \\delta E_k) - k_B T \\right) = \\frac{1}{Q_k} \\delta E_k $$\nThis is a linear system that can be written in matrix form:\n$$ \\frac{d}{dt} \\begin{pmatrix} \\delta E_k \\\\ \\delta \\xi_k \\end{pmatrix} = \\begin{pmatrix} 0 & -k_B T \\\\ 1/Q_k & 0 \\end{pmatrix} \\begin{pmatrix} \\delta E_k \\\\ \\delta \\xi_k \\end{pmatrix} $$\nThe dynamics are governed by the eigenvalues $\\lambda$ of the Jacobian matrix $J = \\begin{pmatrix} 0 & -k_B T \\\\ 1/Q_k & 0 \\end{pmatrix}$. The characteristic equation is $\\det(J - \\lambda I) = 0$:\n$$ \\det \\begin{pmatrix} -\\lambda & -k_B T \\\\ 1/Q_k & -\\lambda \\end{pmatrix} = \\lambda^2 + \\frac{k_B T}{Q_k} = 0 $$\nThe eigenvalues are $\\lambda = \\pm i \\sqrt{\\frac{k_B T}{Q_k}}$. These purely imaginary eigenvalues describe oscillations around the fixed point. The angular frequency of these oscillations is the feedback exchange rate $\\Omega_k$:\n$$ \\Omega_k = \\sqrt{\\frac{k_B T}{Q_k}} $$\n\nFinally, in the fourth step, we must determine the function $Q_k(\\omega_k)$ to satisfy the design criterion that the feedback bandwidth is flat across modes, specified by the condition $\\Omega_k / \\omega_k = c$, where $c$ is a positive constant.\n$$ \\frac{\\Omega_k}{\\omega_k} = c \\implies \\Omega_k = c \\omega_k $$\nWe equate this with our derived expression for $\\Omega_k$:\n$$ c \\omega_k = \\sqrt{\\frac{k_B T}{Q_k}} $$\nTo solve for $Q_k$, we square both sides:\n$$ (c \\omega_k)^2 = \\frac{k_B T}{Q_k} \\implies c^2 \\omega_k^2 = \\frac{k_B T}{Q_k} $$\nRearranging to isolate $Q_k$ gives the desired function:\n$$ Q_k = \\frac{k_B T}{c^2 \\omega_k^2} $$\nAs requested, we provide this as a general function of mode frequency $\\omega$.", "answer": "$$\n\\boxed{\\frac{k_B T}{c^2 \\omega^2}}\n$$", "id": "3429718"}]}