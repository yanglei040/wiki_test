{"hands_on_practices": [{"introduction": "The connection between the microscopic details of a pair potential and the macroscopic thermodynamic properties of a fluid is a cornerstone of statistical mechanics. This exercise provides a direct, analytical link between the parameters of the square-well potential—its diameter $\\sigma$, well depth $\\varepsilon$, and range $\\lambda$—and a key macroscopic quantity, the Boyle temperature $T_B$. By calculating the second virial coefficient $B_2(T)$ and find the temperature at which it vanishes, you will practice a fundamental technique for characterizing how real gases deviate from ideal behavior [@problem_id:3415440].", "problem": "A monatomic fluid is modeled by a pairwise additive square-well (SW) potential with a hard core of diameter $\\sigma$, an attractive well depth $\\varepsilon0$, and a relative range parameter $\\lambda1$. The pair potential $u(r)$ as a function of center-to-center separation $r$ is\n$$\nu(r)=\n\\begin{cases}\n+\\infty,  0 \\le r\\sigma,\\\\\n-\\varepsilon,  \\sigma \\le r\\lambda\\sigma,\\\\\n0,  r \\ge \\lambda\\sigma.\n\\end{cases}\n$$\nThe second virial coefficient $B_{2}(T)$ is defined by the Mayer $f$-function $f(r)=\\exp\\!\\big(-\\beta u(r)\\big)-1$ with $\\beta=1/(k_{B}T)$, as\n$$\nB_{2}(T)=-2\\pi\\int_{0}^{\\infty} f(r)\\,r^{2}\\,dr,\n$$\nwhere $k_{B}$ is the Boltzmann constant. The Boyle temperature $T_{B}$ is defined implicitly by the condition $B_{2}(T_{B})=0$.\n\nStarting from the above definition and the piecewise form of $u(r)$, derive an explicit, closed-form expression for $T_{B}$ in terms of $\\varepsilon$, $\\lambda$, and $k_{B}$. Your final answer must be a single analytic expression. Express the temperature in kelvin units. Do not substitute numerical values.", "solution": "The problem requires the derivation of the Boyle temperature, $T_B$, for a monatomic fluid described by a square-well potential. The Boyle temperature is defined as the temperature at which the second virial coefficient, $B_2(T)$, equals zero.\n\nThe second virial coefficient $B_2(T)$ is given by the integral:\n$$\nB_2(T) = -2\\pi \\int_{0}^{\\infty} f(r)\\,r^2\\,dr\n$$\nwhere the Mayer $f$-function is defined as $f(r) = \\exp(-\\beta u(r)) - 1$, with $\\beta = 1/(k_B T)$.\n\nFirst, we must evaluate the Mayer $f$-function for the given piecewise square-well potential, $u(r)$:\n$$\nu(r)=\n\\begin{cases}\n+\\infty,  0 \\le r\\sigma,\\\\\n-\\varepsilon,  \\sigma \\le r\\lambda\\sigma,\\\\\n0,  r \\ge \\lambda\\sigma.\n\\end{cases}\n$$\n\nThe $f$-function takes the following form in each region:\n1.  For $0 \\le r  \\sigma$: $u(r) = +\\infty$. Thus, $\\exp(-\\beta u(r)) = \\exp(-\\infty) = 0$, which gives $f(r) = 0 - 1 = -1$.\n2.  For $\\sigma \\le r  \\lambda\\sigma$: $u(r) = -\\varepsilon$. Thus, $\\exp(-\\beta u(r)) = \\exp(-\\beta(-\\varepsilon)) = \\exp(\\beta\\varepsilon)$, which gives $f(r) = \\exp(\\beta\\varepsilon) - 1$.\n3.  For $r \\ge \\lambda\\sigma$: $u(r) = 0$. Thus, $\\exp(-\\beta u(r)) = \\exp(0) = 1$, which gives $f(r) = 1 - 1 = 0$.\n\nNow, we can substitute this piecewise function into the integral for $B_2(T)$, splitting the integral over the three regions:\n$$\nB_2(T) = -2\\pi \\left[ \\int_{0}^{\\sigma} (-1) r^2 dr + \\int_{\\sigma}^{\\lambda\\sigma} (\\exp(\\beta\\varepsilon) - 1) r^2 dr + \\int_{\\lambda\\sigma}^{\\infty} (0) r^2 dr \\right]\n$$\n\nLet's evaluate each integral:\nThe first integral corresponds to the hard-core repulsion:\n$$\n\\int_{0}^{\\sigma} (-1) r^2 dr = - \\left[ \\frac{r^3}{3} \\right]_0^\\sigma = -\\frac{\\sigma^3}{3}\n$$\n\nThe second integral corresponds to the attractive well. The term $(\\exp(\\beta\\varepsilon) - 1)$ is constant with respect to the integration variable $r$:\n$$\n\\int_{\\sigma}^{\\lambda\\sigma} (\\exp(\\beta\\varepsilon) - 1) r^2 dr = (\\exp(\\beta\\varepsilon) - 1) \\int_{\\sigma}^{\\lambda\\sigma} r^2 dr = (\\exp(\\beta\\varepsilon) - 1) \\left[ \\frac{r^3}{3} \\right]_\\sigma^{\\lambda\\sigma}\n$$\n$$\n= (\\exp(\\beta\\varepsilon) - 1) \\left( \\frac{(\\lambda\\sigma)^3}{3} - \\frac{\\sigma^3}{3} \\right) = (\\exp(\\beta\\varepsilon) - 1) \\frac{\\sigma^3}{3} (\\lambda^3 - 1)\n$$\n\nThe third integral is zero because the integrand is zero:\n$$\n\\int_{\\lambda\\sigma}^{\\infty} (0) r^2 dr = 0\n$$\n\nCombining these results, we obtain the expression for $B_2(T)$:\n$$\nB_2(T) = -2\\pi \\left[ -\\frac{\\sigma^3}{3} + (\\exp(\\beta\\varepsilon) - 1) \\frac{\\sigma^3}{3} (\\lambda^3 - 1) \\right]\n$$\nFactoring out the common term $2\\pi\\sigma^3/3$:\n$$\nB_2(T) = \\frac{2\\pi\\sigma^3}{3} \\left[ 1 - (\\exp(\\beta\\varepsilon) - 1) (\\lambda^3 - 1) \\right]\n$$\n\nThe Boyle temperature, $T_B$, is defined by the condition $B_2(T_B) = 0$. Let $\\beta_B = 1/(k_B T_B)$. Setting the expression for $B_2(T)$ to zero, we have:\n$$\n\\frac{2\\pi\\sigma^3}{3} \\left[ 1 - (\\exp(\\beta_B\\varepsilon) - 1) (\\lambda^3 - 1) \\right] = 0\n$$\nSince $\\sigma$ is a physical diameter, $\\sigma > 0$, so the prefactor $2\\pi\\sigma^3/3$ is non-zero. Therefore, the term in the square brackets must be zero:\n$$\n1 - (\\exp(\\beta_B\\varepsilon) - 1) (\\lambda^3 - 1) = 0\n$$\n\nWe now solve this equation for $T_B$. Rearranging the terms gives:\n$$\n1 = (\\exp(\\beta_B\\varepsilon) - 1) (\\lambda^3 - 1)\n$$\nThe problem statement specifies $\\lambda > 1$, which means $\\lambda^3 - 1 \\neq 0$. We can divide by this term:\n$$\n\\frac{1}{\\lambda^3 - 1} = \\exp(\\beta_B\\varepsilon) - 1\n$$\nIsolating the exponential term:\n$$\n\\exp(\\beta_B\\varepsilon) = 1 + \\frac{1}{\\lambda^3 - 1}\n$$\nCombining the terms on the right-hand side over a common denominator:\n$$\n\\exp(\\beta_B\\varepsilon) = \\frac{(\\lambda^3 - 1) + 1}{\\lambda^3 - 1} = \\frac{\\lambda^3}{\\lambda^3 - 1}\n$$\nTo solve for $\\beta_B$, we take the natural logarithm of both sides:\n$$\n\\beta_B\\varepsilon = \\ln\\left(\\frac{\\lambda^3}{\\lambda^3 - 1}\\right)\n$$\nSubstituting $\\beta_B = 1/(k_B T_B)$:\n$$\n\\frac{\\varepsilon}{k_B T_B} = \\ln\\left(\\frac{\\lambda^3}{\\lambda^3 - 1}\\right)\n$$\nFinally, solving for $T_B$ yields the explicit, closed-form expression. Given that $\\varepsilon > 0$, we can rearrange the equation to:\n$$\nT_B = \\frac{\\varepsilon}{k_B \\ln\\left(\\frac{\\lambda^3}{\\lambda^3-1}\\right)}\n$$\nThis expression provides the Boyle temperature in kelvin units if the well depth $\\varepsilon$ is given in Joules and the Boltzmann constant $k_B$ is in Joules per kelvin.", "answer": "$$\n\\boxed{\\frac{\\varepsilon}{k_{B} \\ln\\left(\\frac{\\lambda^{3}}{\\lambda^{3} - 1}\\right)}}\n$$", "id": "3415440"}, {"introduction": "Simulating particles with discontinuous potentials, such as hard spheres and square wells, presents a unique challenge that cannot be efficiently handled by standard time-stepping integrators like the Verlet algorithm. The correct and most elegant approach is event-driven molecular dynamics, where the system is propagated exactly from one discrete \"event\" (a collision or boundary crossing) to the next. This practice requires you to design the core logic of an event-driven algorithm, from predicting event times using kinematics to applying the correct velocity updates that conserve energy and momentum at each type of interaction [@problem_id:3415442].", "problem": "Consider a two-particle Molecular Dynamics (MD) system under a hard-sphere plus square-well (HS+SW) pair potential defined by $u(r) = +\\infty$ for $r  \\sigma$, $u(r) = -\\varepsilon$ for $\\sigma \\le r  \\lambda \\sigma$, and $u(r) = 0$ for $r \\ge \\lambda \\sigma$, where $r$ is the scalar separation, $\\sigma$ is the hard-core diameter, $\\lambda  1$ is the square-well range factor, and $\\varepsilon  0$ is the well depth. Between discontinuity surfaces at $r = \\sigma$ and $r = \\lambda \\sigma$, the force is zero and particles free-stream. Discontinuities impart impulsive, central interactions at the surfaces. You will design a time-stepping scheme for a single finite time step of size $\\Delta t$ that is robust to crossings of $r = \\sigma$ and $r = \\lambda \\sigma$.\n\nStarting from Newton’s laws for free motion between impulses ($\\mathbf{r}_i(t + \\tau) = \\mathbf{r}_i(t) + \\tau \\mathbf{v}_i(t)$, $\\mathbf{v}_i(t + \\tau) = \\mathbf{v}_i(t)$ for $\\tau$ until an event) and conservation laws at impulsive, central interactions (linear momentum conservation in the laboratory frame, angular momentum conservation about the pair center, and total energy conservation with appropriate potential step), select the option that gives a scientifically consistent and computationally robust scheme that:\n\n- Detects crossings of $r = \\sigma$ and $r = \\lambda \\sigma$ that may occur within a single finite time step $\\Delta t$, for arbitrary initial relative position $\\mathbf{r}_{ij}(t)$ and velocity $\\mathbf{v}_{ij}(t)$, where $\\mathbf{r}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j$ and $\\mathbf{v}_{ij} = \\mathbf{v}_i - \\mathbf{v}_j$.\n- Interpolates to the event time $t^*$ within the step using the correct kinematics of free streaming.\n- Applies velocity updates at $r = \\sigma$ and $r = \\lambda \\sigma$ that respect conservation of linear momentum, angular momentum, and energy given the HS+SW potential.\n- Correctly orders multiple possible events by executing the earliest event first, sub-stepping to $t^*$, updating, and then continuing for the remaining portion of the time step, possibly encountering another event.\n\nWhich option is correct?\n\nA. For each pair, free-stream positions over $\\Delta t$ only until an event by solving the quadratic for the earliest crossing time $t^* \\in (0, \\Delta t]$ of $r(t) = b \\in \\{\\sigma, \\lambda \\sigma\\}$: find the smallest positive root of $(\\mathbf{r}_{ij}\\cdot \\mathbf{r}_{ij}) + 2 t (\\mathbf{r}_{ij}\\cdot \\mathbf{v}_{ij}) + t^2 (\\mathbf{v}_{ij}\\cdot \\mathbf{v}_{ij}) = b^2$. If both surfaces could be crossed, compute both candidate times and choose the smallest admissible $t^*$. Advance all particles by $t^*$ with $\\mathbf{r}_k(t + t^*) = \\mathbf{r}_k(t) + t^* \\mathbf{v}_k(t)$, $\\mathbf{v}_k$ unchanged until $t^*$. At $r = \\sigma$, apply an elastic hard-sphere collision update via a central impulse along $\\hat{\\mathbf{n}} = \\mathbf{r}_{ij}(t^*)/b$ that reverses the relative normal component while conserving linear momentum: let masses be $m_i$, $m_j$, and compute impulse magnitude $J = - \\frac{2 (\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{n}})}{\\frac{1}{m_i} + \\frac{1}{m_j}}$ (coefficient of restitution $e = 1$), then set $\\mathbf{v}_i' = \\mathbf{v}_i + \\frac{J}{m_i} \\hat{\\mathbf{n}}$ and $\\mathbf{v}_j' = \\mathbf{v}_j - \\frac{J}{m_j} \\hat{\\mathbf{n}}$. At $r = \\lambda \\sigma$, preserve the tangential component of $\\mathbf{v}_{ij}$ and update only the normal component by energy continuity across the potential step of magnitude $\\Delta U = \\pm \\varepsilon$: with reduced mass $\\mu = \\frac{m_i m_j}{m_i + m_j}$, enforce $\\frac{\\mu}{2} v_{\\parallel}'^2 = \\frac{\\mu}{2} v_{\\parallel}^2 - \\Delta U$, where $v_{\\parallel} = \\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{n}}$, taking the sign of $v_{\\parallel}'$ consistent with the crossing direction; if attempting to exit the well and $\\frac{\\mu}{2} v_{\\parallel}^2  \\varepsilon$ then reflect (turning point) by setting $v_{\\parallel}' = - v_{\\parallel}$ and no crossing occurs. After the event, resume free streaming for the remaining $\\Delta t - t^*$ and repeat if further events occur; always process the earliest event first. This guarantees energy, linear momentum, and angular momentum conservation and robust detection.\n\nB. During a time step, linearly interpolate the scalar separation $r(t)$ as $r(t) \\approx r_0 + \\frac{t}{\\Delta t} (r_1 - r_0)$, where $r_0 = \\|\\mathbf{r}_{ij}(t)\\|$ and $r_1 = \\|\\mathbf{r}_{ij}(t + \\Delta t)\\|$, to detect if $r = \\sigma$ or $r = \\lambda \\sigma$ is crossed. If a crossing is detected, place the event at $t^*$ given by linear interpolation of $r$, then at either surface simply reverse the relative normal velocity component $v_{\\parallel}$, leaving the tangential component unchanged for both $r = \\sigma$ and $r = \\lambda \\sigma$. Continue with the remainder of the time step without recomputing candidate crossings.\n\nC. Use a standard velocity-Verlet integrator over $\\Delta t$ with a continuous proxy force that approximates the hard core and square well by steep repulsive and attractive forces near $r = \\sigma$ and $r = \\lambda \\sigma$; do not perform event detection. At the end of the step, if $r  \\sigma$ or $r$ has jumped across $\\lambda \\sigma$, correct by minimally adjusting positions to remove overlap and apply a small damping to velocities to stabilize.\n\nD. Detect events by solving a linear equation only for the normal projection: $(\\mathbf{r}_{ij}\\cdot \\hat{\\mathbf{n}}) + t (\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{n}}) = b$, where $b \\in \\{\\sigma, \\lambda \\sigma\\}$ and $\\hat{\\mathbf{n}}$ is taken from the start of the step as $\\hat{\\mathbf{n}} = \\mathbf{r}_{ij}(t)/\\|\\mathbf{r}_{ij}(t)\\|$. Use the resulting time as $t^*$ even if the tangential motion is large. At $r = \\sigma$ reverse the entire relative velocity vector $\\mathbf{v}_{ij}$; at $r = \\lambda \\sigma$ keep $\\mathbf{v}_{ij}$ unchanged, because the force is zero except at $r = \\sigma$. Process events in the order they are found without comparing their times.", "solution": "The problem statement is scientifically sound and well-posed. It describes a classic problem in computational statistical mechanics: the simulation of particles interacting via a hard-sphere plus square-well (HS+SW) potential. The correct method for such discontinuous potentials is an event-driven molecular dynamics algorithm. The problem asks to identify the correct description of this algorithm. The core principles are exact propagation between events (free-streaming) and instantaneous updates at events (collisions) that respect fundamental conservation laws: conservation of linear momentum, angular momentum, and total energy.\n\nLet us derive the correct procedure from first principles.\n\n**1. Event Detection**\nBetween events, particles $i$ and $j$ move at constant velocities $\\mathbf{v}_i$ and $\\mathbf{v}_j$. Their relative position vector evolves linearly in time:\n$$ \\mathbf{r}_{ij}(t' ) = \\mathbf{r}_{ij}(t) + (t'-t) \\mathbf{v}_{ij}(t) $$\nwhere $\\mathbf{r}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j$ and $\\mathbf{v}_{ij} = \\mathbf{v}_i - \\mathbf{v}_j$. Let $\\tau = t'-t$ be the time elapsed from the beginning of a free-streaming interval. An event occurs when the inter-particle separation $r_{ij} = |\\mathbf{r}_{ij}|$ becomes equal to one of the potential's discontinuity radii, $b \\in \\{\\sigma, \\lambda\\sigma\\}$. To find the time $\\tau = t^*$ of the event, we must solve $r_{ij}^2(t^*) = b^2$:\n$$ |\\mathbf{r}_{ij}(0) + t^* \\mathbf{v}_{ij}(0)|^2 = b^2 $$\n$$ (\\mathbf{r}_{ij}(0) + t^* \\mathbf{v}_{ij}(0)) \\cdot (\\mathbf{r}_{ij}(0) + t^* \\mathbf{v}_{ij}(0)) = b^2 $$\nExpanding this gives a quadratic equation for $t^*$:\n$$ |\\mathbf{v}_{ij}|^2 (t^*)^2 + 2(\\mathbf{r}_{ij} \\cdot \\mathbf{v}_{ij}) t^* + (|\\mathbf{r}_{ij}|^2 - b^2) = 0 $$\nThe physically relevant solution is the smallest, positive, real root $t^*$ that falls within the current simulation time step, i.e., $t^* \\in (0, \\Delta t]$. This calculation must be performed for both $b=\\sigma$ and $b=\\lambda\\sigma$. The earliest of these valid times determines the next event.\n\n**2. State Update at an Event**\nAt the event time $t^*$, all particles in the system are advanced to their new positions: $\\mathbf{r}_k(t+t^*) = \\mathbf{r}_k(t) + t^* \\mathbf{v}_k(t)$. The velocities $\\mathbf{v}_k$ are unchanged up to this point. Then, the velocities of the interacting pair $(i, j)$ are updated instantaneously based on the conservation laws.\nThe interaction is impulsive and central, acting along the line of centers $\\hat{\\mathbf{n}} = \\mathbf{r}_{ij}(t+t^*) / b$.\n- **Linear Momentum**: Conservation of total linear momentum, $m_i \\mathbf{v}_i + m_j \\mathbf{v}_j$, is guaranteed by applying equal and opposite impulses to the two particles.\n- **Angular Momentum**: Conservation of orbital angular momentum $\\mathbf{L} = \\mu \\mathbf{r}_{ij} \\times \\mathbf{v}_{ij}$ (with reduced mass $\\mu = \\frac{m_i m_j}{m_i+m_j}$) is guaranteed because the impulse is central. This implies the tangential component of the relative velocity, $\\mathbf{v}_{ij, t} = \\mathbf{v}_{ij} - (\\mathbf{v}_{ij} \\cdot \\hat{\\mathbf{n}})\\hat{\\mathbf{n}}$, is conserved.\n- **Total Energy**: The total energy $E = K + U$ is conserved. The change in velocity is confined to the normal component of the relative velocity, $v_{ij,n} = \\mathbf{v}_{ij} \\cdot \\hat{\\mathbf{n}}$.\n\n**Update at $r = \\sigma$ (Hard-core collision):**\nThe potential rises to $+\\infty$, so particles cannot penetrate. This is an elastic collision. The potential energy is the same before and after (both infinitesimally outside the core), so kinetic energy is conserved. Since $v_{ij,t}$ is conserved, kinetic energy conservation implies $v_{ij,n}'^2 = v_{ij,n}^2$. To have a collision, particles must approach ($v_{ij,n}  0$) and then separate ($v_{ij,n}'  0$). The only physical solution is $v_{ij,n}' = -v_{ij,n}$.\n\n**Update at $r = \\lambda \\sigma$ (Well-boundary crossing):**\nThe potential energy changes by a finite step $\\Delta U$. Conservation of total energy means the change in kinetic energy is $\\Delta K = -\\Delta U$. As only the relative normal motion contributes to the change, we have:\n$$ \\frac{1}{2} \\mu (v_{ij,n}'^2 - v_{ij,n}^2) = -\\Delta U $$\n$$ v_{ij,n}'^2 = v_{ij,n}^2 - \\frac{2\\Delta U}{\\mu} $$\n- **Entering the well**: $r$ decreases past $\\lambda\\sigma$. $U$ changes from $0$ to $-\\varepsilon$, so $\\Delta U = -\\varepsilon$. The particles are approaching ($v_{ij,n}  0$). Then $v_{ij,n}'^2 = v_{ij,n}^2 + \\frac{2\\varepsilon}{\\mu}$, and they continue moving inward, so $v_{ij,n}'  0$.\n- **Exiting the well**: $r$ increases past $\\lambda\\sigma$. $U$ changes from $-\\varepsilon$ to $0$, so $\\Delta U = +\\varepsilon$. Particles are separating ($v_{ij,n}  0$). Then $v_{ij,n}'^2 = v_{ij,n}^2 - \\frac{2\\varepsilon}{\\mu}$.\n    - If the relative normal kinetic energy $\\frac{1}{2}\\mu v_{ij,n}^2  \\varepsilon$, then $v_{ij,n}'^2  0$ and the particles escape the well. The new velocity is $v_{ij,n}' = +\\sqrt{v_{ij,n}^2 - 2\\varepsilon/\\mu}$.\n    - If $\\frac{1}{2}\\mu v_{ij,n}^2  \\varepsilon$, then $v_{ij,n}'^2  0$, which is impossible. The particles lack the energy to escape the well. They are reflected at the boundary (a classical turning point). In this reflection, the total energy is conserved, and the potential energy does not change (it remains at $-\\varepsilon$). Thus, the kinetic energy is also conserved, which implies $v_{ij,n}' = -v_{ij,n}$.\n\n**3. Algorithmic Structure**\nThe correct time-stepping scheme for a duration $\\Delta t$ is to:\n1. Find the earliest event time $t^*$ for any pair in $(0, \\Delta t]$.\n2. If no event occurs, advance all particles by $\\Delta t$.\n3. If an event is found at $t^*$, advance all particles by $t^*$. Update the velocities of the interacting pair.\n4. Repeat the process for the remaining time $\\Delta t' = \\Delta t - t^*$.\n\nWith this correct procedure established, we evaluate the options.\n\n**Option A - Evaluation:**\nThis option correctly describes the event detection by solving the quadratic equation derived from the kinematics of free streaming. It correctly prescribes finding the earliest admissible event time by comparing candidates. It correctly describes the free-streaming advance of all particles. The velocity update for the hard-sphere collision at $r=\\sigma$ is correctly formulated using an impulse $J$ that reverses the normal component of relative velocity, conserving momentum and energy. The formula for $J$ is standard. The velocity update for the square-well boundary $r=\\lambda\\sigma$ correctly applies energy conservation to the normal velocity component via the equation $\\frac{1}{2}\\mu (v'_{\\parallel})^2 = \\frac{1}{2}\\mu v_{\\parallel}^2 - \\Delta U$ (using $v_\\parallel$ to denote the normal component, as defined in the option). It correctly identifies the condition for reflection when exiting the well ($\\frac{1}{2}\\mu v_{\\parallel}^2  \\varepsilon$) and the corresponding velocity update ($v_{\\parallel}' = -v_{\\parallel}$). Finally, it correctly specifies that the simulation should proceed by sub-stepping for the remainder of the time step, always processing the earliest event first. This option is a complete and accurate description of the correct event-driven algorithm.\n**Verdict: Correct**\n\n**Option B - Evaluation:**\nThis option proposes a linear interpolation of the scalar separation $r(t)$. This is fundamentally incorrect. The vector $\\mathbf{r}_{ij}$ varies linearly with time, but its magnitude $r_{ij}(t)$ does not, unless the motion is perfectly radial. This approximation will lead to incorrect event times and can miss events entirely (e.g., glancing collisions). The velocity update rule—reversing the normal relative velocity at both surfaces—is incorrect for the square-well boundary, as it fails to account for the change in potential energy, thus violating energy conservation. The suggestion to not recompute subsequent event times after a collision is also a critical flaw, as the velocity change from the first event alters the future trajectories of the particles involved.\n**Verdict: Incorrect**\n\n**Option C - Evaluation:**\nThis option proposes using a velocity-Verlet integrator with a continuous proxy force. This is a time-stepped, not an event-driven, method. It is an approximation that fundamentally changes the nature of the interaction. The potential is discontinuous, not continuous. The proposed *ad hoc* corrections for overlaps ($r  \\sigma$) and the use of velocity damping are non-physical fixes that violate energy conservation. This approach does not respect the exact dynamics of the HS+SW potential as required by the problem's premise of scientific consistency.\n**Verdict: Incorrect**\n\n**Option D - Evaluation:**\nThis option proposes an event detection method based on a linear equation for the projected separation. This is incorrect as it assumes the line-of-centers vector $\\hat{\\mathbf{n}}$ is constant, which is only true for purely radial motion. It will fail for any trajectory with a tangential velocity component. The proposed velocity updates are also erroneous: reversing the entire relative velocity vector $\\mathbf{v}_{ij}$ at $r=\\sigma$ violates angular momentum conservation, and keeping $\\mathbf{v}_{ij}$ unchanged at $r=\\lambda\\sigma$ violates energy conservation. Lastly, processing events \"in the order they are found\" without comparing their times is a fatal flaw in the logic of an event-driven simulation, which must always process the chronologically first event.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "3415442"}, {"introduction": "A primary motivation for studying simple models like the square-well fluid is their ability to capture complex phase behavior, such as the liquid-gas coexistence curve. The Gibbs Ensemble Monte Carlo (GEMC) method is a powerful simulation technique designed specifically for this purpose, allowing two distinct phases to be simulated in thermodynamic equilibrium. This hands-on exercise guides you through the derivation of the Metropolis acceptance criteria for the essential GEMC moves—particle transfers and volume exchanges—grounding this advanced simulation technique in the fundamental principles of detailed balance and the canonical ensemble [@problem_id:3415378].", "problem": "Consider a classical two-box formulation for phase coexistence of a one-component fluid interacting via a hard-sphere plus square-well pair potential. The pair potential is defined by the square-well model with a hard core: for an interparticle separation $r$, $u(r) = +\\infty$ if $r  \\sigma$, $u(r) = -\\epsilon$ if $\\sigma \\le r  \\lambda \\sigma$, and $u(r) = 0$ if $r \\ge \\lambda \\sigma$, where $\\sigma$ is the hard-sphere diameter, $\\epsilon$ is the well depth, and $\\lambda  1$ is the relative range of the well. Two cubic simulation boxes labeled $1$ and $2$ contain $N_1$ and $N_2$ particles, with volumes $V_1$ and $V_2$, respectively, and periodic boundary conditions are assumed. The total number of particles $N = N_1 + N_2$ and the total volume $V = V_1 + V_2$ are fixed. We work in reduced, dimensionless units in which Boltzmann's constant $k_B$, the hard-sphere diameter $\\sigma$, and the well depth $\\epsilon$ are all set to $1$, so that the reduced temperature is $T^\\star = T$ and reduced energy is in units of $\\epsilon$; volumes are in units of $\\sigma^3$. All angles are irrelevant in this setting, so no angle unit is needed.\n\nStarting point for the derivation must be the canonical ensemble for classical indistinguishable particles and the principle of detailed balance. In the canonical ensemble, the classical configurational contribution to the equilibrium probability density of a microstate with particle counts $N_1, N_2$, volumes $V_1, V_2$, and total potential energy $U = U_1 + U_2$ is proportional to\n$$\n\\frac{V_1^{N_1} V_2^{N_2}}{N_1! \\, N_2!} \\, e^{-\\beta U},\n$$\nwhere $\\beta = 1/T^\\star$ is the inverse reduced temperature. For the purpose of computing Metropolis acceptance probabilities, you must use detailed balance with symmetric proposal distributions for the following two move types in a Gibbs-ensemble Monte Carlo scheme:\n\n- Particle transfer move: delete a uniformly randomly chosen particle from box $1$ and insert it at a uniformly random position in box $2$ (i.e., a $1 \\to 2$ transfer). Assume proposals are symmetric in the sense that the reverse $2 \\to 1$ move is constructed analogously. The hard-sphere (infinite) repulsion must be enforced: any proposed insertion that produces an overlap ($r  \\sigma$ with any existing particle) must be rejected with zero acceptance. For the square-well part, in reduced units, the energy change contribution of removing a particle from box $1$ that had $m_1$ neighbors within the attractive well is $\\Delta U_\\text{remove,1} = + m_1$, whereas inserting into box $2$ with $m_2$ neighbors within the attractive well yields $\\Delta U_\\text{insert,2} = - m_2$ provided no hard-sphere overlap occurs. The total reduced energy change for the transfer is then $\\Delta U = \\Delta U_\\text{remove,1} + \\Delta U_\\text{insert,2}$.\n\n- Logarithmic volume exchange move: change the volumes to new values $V_1'$ and $V_2'$ that satisfy $V_1' + V_2' = V$ (total volume conservation), constructed via a symmetric proposal in the variable $\\xi = \\ln\\left(V_1/V_2\\right)$, while affinely rescaling all particle coordinates in each box so that reduced coordinates remain within the unit cube. The reduced energy change due to this volume move is denoted $\\Delta U_\\text{vol} = (U_1' + U_2') - (U_1 + U_2)$. For the purposes of this problem, you will be given $\\Delta U_\\text{vol}$ as a numeric input for each test case.\n\nTask:\n1. From the canonical ensemble weight and detailed balance, derive the Metropolis acceptance probability for the particle transfer move described above in terms of $N_1, N_2, V_1, V_2, \\beta$, and $\\Delta U$, explicitly accounting for indistinguishability and the uniform selection of a particle for deletion and the uniform random insertion position. State clearly how the hard-sphere rejection affects the acceptance probability.\n2. From the same principles, derive the Metropolis acceptance probability for the logarithmic volume exchange move in terms of $N_1, N_2, V_1, V_2, V_1', V_2'$, $\\beta$, and $\\Delta U_\\text{vol}$.\n\nImplementation requirements:\n- Implement a program that evaluates, for each provided test case, two acceptance probabilities: the particle transfer acceptance probability for the $1 \\to 2$ transfer and the logarithmic volume exchange acceptance probability. Use the standard Metropolis rule, i.e., the acceptance probability is the minimum of $1$ and the appropriate acceptance ratio implied by detailed balance. If $N_1  1$ for a $1 \\to 2$ transfer, the move is impossible and must have acceptance probability $0$.\n- Use reduced units: $k_B = 1$, $\\sigma = 1$, $\\epsilon = 1$, so $\\beta = 1/T^\\star$ and energies are in units of $\\epsilon$.\n- For the particle transfer energy change, use the given integers $m_1$ and $m_2$ describing the number of square-well neighbors broken and made, respectively, and enforce hard-sphere rejection if specified. The reduced energy change is $\\Delta U = m_1 - m_2$ when no overlap occurs; if a hard-sphere overlap would result upon insertion, the acceptance probability must be $0$.\n- For the volume move, use the provided scalar $\\Delta U_\\text{vol}$ and the proposed $V_1', V_2'$ that satisfy $V_1' + V_2' = V_1 + V_2$.\n\nYour program must compute the acceptance probabilities for the following test suite, which probes a typical case, an overlap-rejection case, an edge case with an empty donor box, and a case at low temperature with a favorable transfer:\n- Test case A:\n  - $T^\\star = 1.2$, $N_1 = 150$, $N_2 = 50$, $V_1 = 100$, $V_2 = 100$.\n  - Particle transfer: $m_1 = 5$, $m_2 = 3$, and there is no hard-sphere overlap on insertion into box $2$.\n  - Volume move: $V_1' = 105$, $V_2' = 95$, $\\Delta U_\\text{vol} = 7.5$.\n- Test case B:\n  - $T^\\star = 0.8$, $N_1 = 80$, $N_2 = 120$, $V_1 = 150$, $V_2 = 50$.\n  - Particle transfer: $m_1 = 2$, $m_2 = 4$, and a hard-sphere overlap would occur on insertion into box $2$.\n  - Volume move: $V_1' = 100$, $V_2' = 100$, $\\Delta U_\\text{vol} = -1.0$.\n- Test case C:\n  - $T^\\star = 1.5$, $N_1 = 0$, $N_2 = 200$, $V_1 = 120$, $V_2 = 80$.\n  - Particle transfer: $m_1 = 0$, $m_2 = 1$, and there is no hard-sphere overlap on insertion into box $2$; however, note that $N_1 = 0$.\n  - Volume move: $V_1' = 60$, $V_2' = 140$, $\\Delta U_\\text{vol} = 0$.\n- Test case D:\n  - $T^\\star = 0.5$, $N_1 = 60$, $N_2 = 140$, $V_1 = 90$, $V_2 = 110$.\n  - Particle transfer: $m_1 = 1$, $m_2 = 5$, and there is no hard-sphere overlap on insertion into box $2$.\n  - Volume move: $V_1' = 70$, $V_2' = 130$, $\\Delta U_\\text{vol} = 3.0$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a comma-separated list of the results for all test cases, where the result for each test case is itself a two-element list in the order [particle-transfer-acceptance, volume-move-acceptance]. Each acceptance probability must be a floating-point number rounded to six decimal places. The entire output must be a single line in the following format:\n  - For example, if there were two test cases with results $x_1, y_1$ and $x_2, y_2$, the output would be formatted as [[x_1,y_1],[x_2,y_2]] with no spaces.", "solution": "The problem requires the derivation and implementation of Metropolis acceptance probabilities for particle transfer and volume exchange moves in a Gibbs Ensemble Monte Carlo (GEMC) simulation. The derivation must be grounded in the principles of statistical mechanics, specifically the canonical ensemble probability distribution and the principle of detailed balance for a Markov chain Monte Carlo process.\n\nThe foundation of the Metropolis-Hastings algorithm is the detailed balance condition, which ensures that a simulation's trajectory correctly samples the desired equilibrium probability distribution. For a transition from a state $i$ to a state $j$, the condition is:\n$$\nP(i) \\, T(i \\to j) = P(j) \\, T(j \\to i)\n$$\nwhere $P(i)$ is the equilibrium probability of state $i$, and $T(i \\to j)$ is the transition probability. The transition probability is a product of the proposal probability, $\\alpha(i \\to j)$, and the acceptance probability, $A(i \\to j)$. This leads to the general form for the acceptance probability:\n$$\nA(i \\to j) = \\min \\left( 1, \\frac{P(j) \\, \\alpha(j \\to i)}{P(i) \\, \\alpha(i \\to j)} \\right)\n$$\nThe problem specifies that the configurational contribution to the equilibrium probability of a state defined by particle counts ($N_1, N_2$), volumes ($V_1, V_2$), and total potential energy ($U=U_1+U_2$) is proportional to:\n$$\nP(N_1, V_1, N_2, V_2, U) \\propto \\frac{V_1^{N_1} V_2^{N_2}}{N_1! \\, N_2!} e^{-\\beta U}\n$$\nwhere $\\beta = 1/T^\\star$ is the inverse reduced temperature. We will use this as the equilibrium probability $P$ for the system's macroscopic state.\n\n**1. Derivation of the Particle Transfer Acceptance Probability**\n\nConsider a particle transfer move from box $1$ to box $2$.\nThe initial state, state $i$, is characterized by $(N_1, V_1)$ in box $1$ and $(N_2, V_2)$ in box $2$, with a total potential energy $U_i$.\nThe proposed final state, state $j$, is characterized by $(N_1-1, V_1)$ in box $1$ and $(N_2+1, V_2)$ in box $2$, with a total potential energy $U_j$. The change in potential energy is given as $\\Delta U = U_j - U_i$.\n\nThe ratio of the equilibrium probabilities of these two states is:\n$$\n\\frac{P(j)}{P(i)} = \\frac{\\frac{V_1^{N_1-1} V_2^{N_2+1}}{(N_1-1)! \\, (N_2+1)!} e^{-\\beta U_j}}{\\frac{V_1^{N_1} V_2^{N_2}}{N_1! \\, N_2!} e^{-\\beta U_i}}\n$$\nSimplifying the terms yields:\n$$\n\\frac{P(j)}{P(i)} = \\frac{V_1^{N_1-1}}{V_1^{N_1}} \\cdot \\frac{V_2^{N_2+1}}{V_2^{N_2}} \\cdot \\frac{N_1!}{(N_1-1)!} \\cdot \\frac{N_2!}{(N_2+1)!} \\cdot \\frac{e^{-\\beta U_j}}{e^{-\\beta U_i}}\n$$\n$$\n\\frac{P(j)}{P(i)} = \\frac{1}{V_1} \\cdot V_2 \\cdot N_1 \\cdot \\frac{1}{N_2+1} \\cdot e^{-\\beta (U_j - U_i)} = \\frac{N_1 V_2}{(N_2+1) V_1} e^{-\\beta \\Delta U}\n$$\nNext, we consider the proposal probabilities. The problem specifies a move where a particle is chosen uniformly from box $1$ and inserted at a random position in box $2$. A standard GEMC scheme involves choosing with probability $0.5$ to attempt a $1 \\to 2$ transfer and with probability $0.5$ to attempt a $2 \\to 1$ transfer. The problem states to \"Assume proposals are symmetric in the sense that the reverse $2 \\to 1$ move is constructed analogously.\" This implies that the choice of attempting a forward move ($i \\to j$) versus a reverse move ($j \\to i$) is made with equal probability. Therefore, the proposal probabilities for the entire transition between macrostates are equal, $\\alpha(i \\to j) = \\alpha(j \\to i)$, and their ratio is $1$.\n\nSubstituting these components into the Metropolis acceptance rule gives the acceptance ratio:\n$$\n\\text{ratio} = \\frac{P(j)}{P(i)} \\frac{\\alpha(j \\to i)}{\\alpha(i \\to j)} = \\frac{N_1 V_2}{(N_2+1) V_1} e^{-\\beta \\Delta U}\n$$\nThe energy change in reduced units for breaking $m_1$ neighbor interactions in box $1$ and forming $m_2$ interactions in box $2$ is $\\Delta U = m_1 - m_2$. Thus, the acceptance probability is:\n$$\nA_{\\text{transfer}}(1 \\to 2) = \\min \\left( 1, \\frac{N_1 V_2}{(N_2+1) V_1} e^{-\\beta (m_1 - m_2)} \\right)\n$$\nThe problem defines specific conditions for rejection:\n- If a proposed insertion results in a hard-sphere overlap ($r  \\sigma$), the energy change is effectively infinite ($\\Delta U = +\\infty$). This makes the exponential term, and thus the acceptance probability, zero.\n- If $N_1  1$, a particle cannot be removed from box $1$. The move is impossible. The factor $N_1$ in the numerator correctly yields an acceptance probability of $0$.\n\n**2. Derivation of the Logarithmic Volume Exchange Acceptance Probability**\n\nConsider a volume exchange move.\nThe initial state, state $i$, is characterized by $(N_1, V_1)$ and $(N_2, V_2)$, with total energy $U_i = U_1+U_2$.\nThe proposed final state, state $j$, has volumes $(V_1', V_2')$ such that $V_1' + V_2' = V_1 + V_2 = V$, and total energy $U_j = U_1' + U_2'$. The particle numbers $(N_1, N_2)$ remain constant. The energy change is given as $\\Delta U_{\\text{vol}} = U_j - U_i$.\n\nThe ratio of equilibrium probabilities is:\n$$\n\\frac{P(j)}{P(i)} = \\frac{\\frac{(V_1')^{N_1} (V_2')^{N_2}}{N_1! \\, N_2!} e^{-\\beta U_j}}{\\frac{V_1^{N_1} V_2^{N_2}}{N_1! \\, N_2!} e^{-\\beta U_i}}\n$$\nThe factorial terms cancel, leaving:\n$$\n\\frac{P(j)}{P(i)} = \\left(\\frac{V_1'}{V_1}\\right)^{N_1} \\left(\\frac{V_2'}{V_2}\\right)^{N_2} e^{-\\beta \\Delta U_{\\text{vol}}}\n$$\nThe move is generated by proposing a change to the variable $\\xi = \\ln(V_1/V_2)$. Specifically, a random value $\\delta\\xi$ is drawn from a symmetric probability distribution $g(\\delta\\xi)$ (where $g(\\delta\\xi) = g(-\\delta\\xi)$), and the new state is proposed as $\\xi' = \\xi + \\delta\\xi$. To reverse the move, one must draw $-\\delta\\xi$, for which the proposal probability is $g(-\\delta\\xi)$. Due to the symmetry of $g$, the probability of proposing the forward move is the same as proposing the reverse move. Thus, $\\alpha(i \\to j) = \\alpha(j \\to i)$, and their ratio is $1$.\n\nThe acceptance ratio is therefore equal to the ratio of state probabilities:\n$$\n\\text{ratio} = \\left(\\frac{V_1'}{V_1}\\right)^{N_1} \\left(\\frac{V_2'}{V_2}\\right)^{N_2} e^{-\\beta \\Delta U_{\\text{vol}}}\n$$\nThis expression can be rewritten using logarithms for numerical stability:\n$$\n\\text{ratio} = \\exp\\left( N_1 \\ln\\left(\\frac{V_1'}{V_1}\\right) + N_2 \\ln\\left(\\frac{V_2'}{V_2}\\right) - \\beta \\Delta U_{\\text{vol}} \\right)\n$$\nThe resulting acceptance probability is:\n$$\nA_{\\text{vol}} = \\min(1, \\text{ratio}) = \\min\\left(1, \\exp\\left( N_1 \\ln\\frac{V_1'}{V_1} + N_2 \\ln\\frac{V_2'}{V_2} - \\beta \\Delta U_{\\text{vol}} \\right)\\right)\n$$\nThis concludes the derivations required to solve the problem. The implementation will consist of applying these two final formulae to the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates Metropolis acceptance probabilities for particle transfer and volume\n    exchange moves in a Gibbs Ensemble Monte Carlo simulation for a series of test cases.\n    \"\"\"\n    test_cases = [\n        # Test case A\n        {'T_star': 1.2, 'N1': 150, 'N2': 50, 'V1': 100, 'V2': 100,\n         'm1': 5, 'm2': 3, 'no_overlap': True,\n         'V1_p': 105, 'V2_p': 95, 'dU_vol': 7.5},\n        # Test case B\n        {'T_star': 0.8, 'N1': 80, 'N2': 120, 'V1': 150, 'V2': 50,\n         'm1': 2, 'm2': 4, 'no_overlap': False,\n         'V1_p': 100, 'V2_p': 100, 'dU_vol': -1.0},\n        # Test case C\n        {'T_star': 1.5, 'N1': 0, 'N2': 200, 'V1': 120, 'V2': 80,\n         'm1': 0, 'm2': 1, 'no_overlap': True,\n         'V1_p': 60, 'V2_p': 140, 'dU_vol': 0.0},\n        # Test case D\n        {'T_star': 0.5, 'N1': 60, 'N2': 140, 'V1': 90, 'V2': 110,\n         'm1': 1, 'm2': 5, 'no_overlap': True,\n         'V1_p': 70, 'V2_p': 130, 'dU_vol': 3.0}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters\n        T_star = case['T_star']\n        N1, N2 = case['N1'], case['N2']\n        V1, V2 = case['V1'], case['V2']\n        m1, m2 = case['m1'], case['m2']\n        no_overlap = case['no_overlap']\n        V1_p, V2_p = case['V1_p'], case['V2_p']\n        dU_vol = case['dU_vol']\n        \n        beta = 1.0 / T_star\n\n        # --- Particle Transfer Acceptance Probability ---\n        # Move is impossible if donor box is empty (N1  1) or if insertion causes overlap\n        if N1  1 or not no_overlap:\n            p_transfer = 0.0\n        else:\n            dU_transfer = float(m1 - m2)\n            # The acceptance ratio is based on the derived formula\n            ratio_transfer = (N1 * V2) / ((N2 + 1) * V1) * np.exp(-beta * dU_transfer)\n            p_transfer = min(1.0, ratio_transfer)\n\n        # --- Volume Exchange Acceptance Probability ---\n        # The volumes must be positive to take logarithms\n        if V1 = 0 or V2 = 0 or V1_p = 0 or V2_p = 0:\n            # Physically this should not occur in a valid simulation state\n            p_volume = 0.0\n        else:\n            # The argument of the exponential in the acceptance ratio\n            exponent = N1 * np.log(V1_p / V1) + N2 * np.log(V2_p / V2) - beta * dU_vol\n            ratio_volume = np.exp(exponent)\n            p_volume = min(1.0, ratio_volume)\n        \n        results.append([p_transfer, p_volume])\n\n    # Format the final output string exactly as specified.\n    case_strings = [f\"[{p1:.6f},{p2:.6f}]\" for p1, p2 in results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3415378"}]}