{"hands_on_practices": [{"introduction": "The Lennard-Jones potential is a cornerstone model for describing non-bonded interactions in molecular systems. By performing a Taylor expansion around its equilibrium distance, we can dissect this complex function into a more intuitive series of approximations. This fundamental exercise connects the mathematical coefficients of the expansion to core physical concepts, revealing how the quadratic term represents an ideal harmonic spring and how higher-order terms introduce essential anharmonic corrections that account for the true nature of atomic bonds. [@problem_id:3451240]", "problem": "In Molecular Dynamics (MD), small-amplitude vibrations around equilibrium separations are often analyzed by expanding the pair potential in a Taylor series about its minimum. Consider the Lennard–Jones pair potential $u(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^6\\right]$, which has its minimum at $r_0=2^{1/6}\\sigma$. Define the Taylor expansion of $u(r)$ about $r_0$ in powers of $\\Delta r = r - r_0$ by\n$$\nu(r) \\approx \\sum_{n=0}^{4} a_n \\, (\\Delta r)^{n},\n$$\nwhere $a_n = u^{(n)}(r_0)/n!$ and $u^{(n)}$ denotes the $n$-th derivative with respect to $r$. Starting from the fundamental definition of the Taylor series and the given Lennard–Jones potential, compute the coefficients $a_0$, $a_1$, $a_2$, $a_3$, and $a_4$ in closed form, simplifying your expressions using $\\epsilon$ and $r_0$.\n\nThen, from first principles, interpret the physical meaning of the quadratic term (associated with $a_2$) and the quartic term (associated with $a_4$) within the context of small-amplitude vibrations and the harmonic versus anharmonic approximations in MD.\n\nProvide the final numerical-symbolic coefficients $(a_0, a_1, a_2, a_3, a_4)$ as a single row matrix in your final answer. No units are required for the final answer.", "solution": "The problem requires the computation of the first five coefficients of the Taylor series expansion of the Lennard-Jones (LJ) potential, $u(r)$, around its minimum, $r_0$, and a physical interpretation of the quadratic and quartic terms.\n\nThe LJ potential is given by:\n$$\nu(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]\n$$\nThe minimum of this potential occurs at $r_0 = 2^{1/6}\\sigma$. This relation allows us to express the parameter $\\sigma$ in terms of the equilibrium separation $r_0$:\n$$\n\\sigma^6 = \\frac{r_0^6}{2} \\quad \\text{and} \\quad \\sigma^{12} = \\frac{r_0^{12}}{4}\n$$\nSubstituting these into the potential expression provides a form more convenient for differentiation with respect to $r$ and evaluation at $r_0$:\n$$\nu(r) = 4\\epsilon\\left[\\frac{r_0^{12}}{4r^{12}} - \\frac{r_0^6}{2r^6}\\right] = \\epsilon\\left[\\left(\\frac{r_0}{r}\\right)^{12} - 2\\left(\\frac{r_0}{r}\\right)^6\\right]\n$$\nThe Taylor expansion coefficients $a_n$ are defined by $a_n = \\frac{u^{(n)}(r_0)}{n!}$, where $u^{(n)}(r_0)$ is the $n$-th derivative of $u(r)$ evaluated at $r=r_0$. We will now compute these derivatives up to $n=4$.\n\nFor $n=0$: The coefficient $a_0$ is the value of the potential at the minimum.\n$$\nu^{(0)}(r) = u(r) = \\epsilon\\left[r_0^{12}r^{-12} - 2r_0^6r^{-6}\\right]\n$$\n$$\nu(r_0) = \\epsilon\\left[r_0^{12}r_0^{-12} - 2r_0^6r_0^{-6}\\right] = \\epsilon(1-2) = -\\epsilon\n$$\n$$\na_0 = \\frac{u(r_0)}{0!} = -\\epsilon\n$$\nThis represents the depth of the potential well, or the dissociation energy of the pair.\n\nFor $n=1$: The coefficient $a_1$ is determined by the first derivative.\n$$\nu^{(1)}(r) = \\frac{du}{dr} = \\epsilon\\left[r_0^{12}(-12r^{-13}) - 2r_0^6(-6r^{-7})\\right] = \\epsilon\\left[-12r_0^{12}r^{-13} + 12r_0^6r^{-7}\\right]\n$$\n$$\nu^{(1)}(r_0) = \\epsilon\\left[-12r_0^{12}r_0^{-13} + 12r_0^6r_0^{-7}\\right] = \\frac{12\\epsilon}{r_0}(-1+1) = 0\n$$\n$$\na_1 = \\frac{u^{(1)}(r_0)}{1!} = 0\n$$\nThis result is expected, as the first derivative of any function at a minimum (or any extremum) is zero. This signifies that there is no net force at the equilibrium separation.\n\nFor $n=2$: The coefficient $a_2$ is determined by the second derivative.\n$$\nu^{(2)}(r) = \\frac{d^2u}{dr^2} = \\epsilon\\left[-12r_0^{12}(-13r^{-14}) + 12r_0^6(-7r^{-8})\\right] = \\epsilon\\left[156r_0^{12}r^{-14} - 84r_0^6r^{-8}\\right]\n$$\n$$\nu^{(2)}(r_0) = \\epsilon\\left[156r_0^{12}r_0^{-14} - 84r_0^6r_0^{-8}\\right] = \\frac{\\epsilon}{r_0^2}(156 - 84) = \\frac{72\\epsilon}{r_0^2}\n$$\n$$\na_2 = \\frac{u^{(2)}(r_0)}{2!} = \\frac{1}{2}\\frac{72\\epsilon}{r_0^2} = \\frac{36\\epsilon}{r_0^2}\n$$\n\nFor $n=3$: The coefficient $a_3$ is determined by the third derivative.\n$$\nu^{(3)}(r) = \\frac{d^3u}{dr^3} = \\epsilon\\left[156r_0^{12}(-14r^{-15}) - 84r_0^6(-8r^{-9})\\right] = \\epsilon\\left[-2184r_0^{12}r^{-15} + 672r_0^6r^{-9}\\right]\n$$\n$$\nu^{(3)}(r_0) = \\epsilon\\left[-2184r_0^{12}r_0^{-15} + 672r_0^6r_0^{-9}\\right] = \\frac{\\epsilon}{r_0^3}(-2184 + 672) = -\\frac{1512\\epsilon}{r_0^3}\n$$\n$$\na_3 = \\frac{u^{(3)}(r_0)}{3!} = \\frac{1}{6}\\left(-\\frac{1512\\epsilon}{r_0^3}\\right) = -\\frac{252\\epsilon}{r_0^3}\n$$\n\nFor $n=4$: The coefficient $a_4$ is determined by the fourth derivative.\n$$\nu^{(4)}(r) = \\frac{d^4u}{dr^4} = \\epsilon\\left[-2184r_0^{12}(-15r^{-16}) + 672r_0^6(-9r^{-10})\\right] = \\epsilon\\left[32760r_0^{12}r^{-16} - 6048r_0^6r^{-10}\\right]\n$$\n$$\nu^{(4)}(r_0) = \\epsilon\\left[32760r_0^{12}r_0^{-16} - 6048r_0^6r_0^{-10}\\right] = \\frac{\\epsilon}{r_0^4}(32760 - 6048) = \\frac{26712\\epsilon}{r_0^4}\n$$\n$$\na_4 = \\frac{u^{(4)}(r_0)}{4!} = \\frac{1}{24}\\left(\\frac{26712\\epsilon}{r_0^4}\\right) = \\frac{1113\\epsilon}{r_0^4}\n$$\n\nThe Taylor expansion of the potential up to the fourth order is thus:\n$$\nu(r) \\approx -\\epsilon + \\frac{36\\epsilon}{r_0^2}(\\Delta r)^2 - \\frac{252\\epsilon}{r_0^3}(\\Delta r)^3 + \\frac{1113\\epsilon}{r_0^4}(\\Delta r)^4\n$$\n\nPhysical Interpretation of the Quadratic ($a_2$) and Quartic ($a_4$) Terms:\n\nThe expansion of the potential energy $u(r)$ around its minimum is fundamental to understanding molecular vibrations.\nThe force on a particle is given by $F(r) = -u'(r)$. Expanding this force in a Taylor series around $r_0$ for a small displacement $\\Delta r = r - r_0$ gives:\n$$\nF(r) = -u'(r_0) - u''(r_0)\\Delta r - \\frac{u'''(r_0)}{2}(\\Delta r)^2 - \\dots\n$$\nSince $u'(r_0) = 0$, the leading term in the force is:\n$$\nF(r) \\approx -u''(r_0)\\Delta r = -2a_2\\Delta r\n$$\nThis is the mathematical form of Hooke's Law, $F = -k_s x$, where $k_s = u''(r_0) = 2a_2 = 72\\epsilon/r_0^2$ is the force constant or \"spring stiffness\" of the effective bond. The potential energy associated with this force is $u(r) - u(r_0) \\approx a_2(\\Delta r)^2 = \\frac{1}{2}k_s(\\Delta r)^2$, which is the potential for a simple harmonic oscillator (SHO). Therefore, the quadratic term, governed by $a_2$, represents the **harmonic approximation** of the interatomic potential. This approximation models the bond as an ideal spring and is accurate for infinitesimally small vibrations around the equilibrium position. It describes oscillations with a frequency independent of the amplitude.\n\nThe cubic ($a_3$) and quartic ($a_4$) terms represent the lowest-order **anharmonic corrections** to the potential. Real molecular bonds are not ideal springs, and their behavior deviates from the SHO model, especially at larger vibrational amplitudes. This deviation is known as anharmonicity.\nThe cubic term, $a_3(\\Delta r)^3$, introduces an asymmetry into the potential well. Since $a_3$ is negative for the LJ potential, the potential rises more steeply for compression ($\\Delta r  0$) than for expansion ($\\Delta r > 0$). This asymmetry is the microscopic origin of thermal expansion, a phenomenon that cannot be explained by the symmetric harmonic model.\nThe quartic term, $a_4(\\Delta r)^4$, is the next even-powered correction after the harmonic term. It modifies the curvature of the potential well away from the minimum. Since $a_4$ is positive, it makes the potential well steeper and \"narrower\" at larger displacements than the pure harmonic parabola would suggest. This term, along with the cubic term, affects the vibrational frequency, causing it to depend on the amplitude of oscillation. The quartic term is a crucial component in describing the true shape of the potential for non-infinitesimal displacements and is essential for accurately modeling properties that depend on the details of the potential shape, such as heat capacity at high temperatures and phononic interactions. In summary, the quartic term provides the leading symmetric correction for the anharmonicity of the bond, refining the spring constant for larger-amplitude vibrations.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\epsilon  0  \\frac{36\\epsilon}{r_0^2}  -\\frac{252\\epsilon}{r_0^3}  \\frac{1113\\epsilon}{r_0^4} \\end{pmatrix}}\n$$", "id": "3451240"}, {"introduction": "Building on the analysis of potential minima, we now explore the dynamics at other stationary points, particularly the saddle points that represent transition states in chemical reactions. This computational practice demonstrates how the second-order term of the Taylor expansion, the Hessian matrix $H$, directly governs the stability and time-evolution of a system. By numerically solving the linearized equations of motion, you will observe firsthand how the curvature of the potential dictates whether a small displacement results in stable oscillation or exponential growth away from the stationary point. [@problem_id:3451224]", "problem": "Consider a system in Molecular Dynamics (MD) described by a potential energy function $U(\\mathbf{R})$ of $N$ Cartesian coordinates collected in the vector $\\mathbf{R} \\in \\mathbb{R}^{N}$. Let $\\mathbf{R}^{\\ddagger}$ denote a stationary configuration where the gradient of the potential vanishes, that is $\\nabla U(\\mathbf{R}^{\\ddagger}) = \\mathbf{0}$, and assume that the Hessian matrix $H$ of second derivatives of $U$ evaluated at $\\mathbf{R}^{\\ddagger}$ has exactly one negative eigenvalue and the remaining eigenvalues are nonnegative. Near $\\mathbf{R}^{\\ddagger}$, the Taylor expansion of $U$ up to second order yields an approximation of the form $U(\\mathbf{R}^{\\ddagger} + \\mathbf{x}) \\approx U(\\mathbf{R}^{\\ddagger}) + \\dfrac{1}{2} \\mathbf{x}^{\\top} H \\mathbf{x}$, where $\\mathbf{x} = \\mathbf{R} - \\mathbf{R}^{\\ddagger}$ is the displacement vector. Newton's second law with a diagonal mass matrix $M = \\mathrm{diag}(m_{1}, \\dots, m_{N})$ states $M \\ddot{\\mathbf{R}} = -\\nabla U(\\mathbf{R})$. In the linearized regime around $\\mathbf{R}^{\\ddagger}$, this reduces to $M \\ddot{\\mathbf{x}} = - H \\mathbf{x}$ for sufficiently small $\\mathbf{x}$. This linear system can be recast as a first-order system in the augmented state $\\mathbf{y} = \\begin{pmatrix}\\mathbf{x} \\\\ \\mathbf{v}\\end{pmatrix} \\in \\mathbb{R}^{2N}$, where $\\mathbf{v} = \\dot{\\mathbf{x}}$, via $\\dot{\\mathbf{y}} = A \\mathbf{y}$ with the block matrix $A = \\begin{pmatrix} 0  I \\\\ -M^{-1} H  0 \\end{pmatrix}$. The short-time growth or decay of $\\mathbf{x}(t)$ is governed by the eigenstructure of $H$ and the masses $m_{i}$, with indefinite curvature producing an unstable mode.\n\nYour task is to implement a program that, for each given test case, computes the amplification factor defined as the ratio $a = \\dfrac{\\lVert \\mathbf{x}(T) \\rVert_{2}}{\\lVert \\mathbf{x}(0) \\rVert_{2}}$, where $\\lVert \\cdot \\rVert_{2}$ denotes the Euclidean norm, $T$ is a specified short time, and $\\mathbf{x}(t)$ evolves under the linearized dynamics $M \\ddot{\\mathbf{x}} = - H \\mathbf{x}$ with initial conditions $\\mathbf{x}(0) = \\mathbf{x}_{0}$ and $\\mathbf{v}(0) = \\mathbf{0}$. The matrix $H$ is symmetric and provided in units of newton per meter ($\\mathrm{N}/\\mathrm{m}$), the masses $m_{i}$ are provided in kilograms ($\\mathrm{kg}$), the displacements $\\mathbf{x}_{0}$ are provided in meters ($\\mathrm{m}$), velocities are provided in meters per second ($\\mathrm{m}/\\mathrm{s}$), and time $T$ is provided in seconds ($\\mathrm{s}$). The amplification factor $a$ is dimensionless.\n\nUse the following test suite, each specified by $N$, $M$, $H$, $\\mathbf{x}_{0}$, $\\mathbf{v}_{0}$, and $T$. In all cases, $N = 2$, $\\mathbf{v}_{0} = \\mathbf{0}$, and $T = 1.0 \\times 10^{-13}\\ \\mathrm{s}$.\n\n- Test case $1$ (indefinite curvature, diagonal Hessian, initial displacement aligned with the unstable mode):\n  - Masses: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$.\n  - Hessian: $H = \\begin{pmatrix} -0.5  0.0 \\\\ 0.0  0.8 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$.\n  - Initial displacement: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$.\n\n- Test case $2$ (positive definite curvature, diagonal Hessian, initial displacement aligned with a stable mode):\n  - Masses: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$.\n  - Hessian: $H = \\begin{pmatrix} 0.7  0.0 \\\\ 0.0  1.1 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$.\n  - Initial displacement: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$.\n\n- Test case $3$ (semidefinite curvature with a flat direction):\n  - Masses: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$.\n  - Hessian: $H = \\begin{pmatrix} 0.0  0.0 \\\\ 0.0  0.6 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$.\n  - Initial displacement: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$.\n\n- Test case $4$ (indefinite curvature with mode coupling):\n  - Masses: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$.\n  - Hessian: $H = \\begin{pmatrix} -0.2  0.15 \\\\ 0.15  0.3 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$.\n  - Initial displacement: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 1.0 \\times 10^{-12} \\end{pmatrix}\\ \\mathrm{m}$.\n\nAlgorithmic requirements:\n- Formulate the linearized dynamics as the first-order system $\\dot{\\mathbf{y}} = A \\mathbf{y}$ with $A = \\begin{pmatrix} 0  I \\\\ -M^{-1} H  0 \\end{pmatrix}$, where $I$ is the $N \\times N$ identity matrix and $M^{-1}$ is the inverse of the diagonal mass matrix.\n- Propagate the initial state $\\mathbf{y}(0) = \\begin{pmatrix}\\mathbf{x}_{0} \\\\ \\mathbf{0}\\end{pmatrix}$ to time $T$ using the matrix exponential solution $\\mathbf{y}(T)$, and extract $\\mathbf{x}(T)$ from the first $N$ components of $\\mathbf{y}(T)$.\n- Compute the amplification factor $a = \\dfrac{\\lVert \\mathbf{x}(T) \\rVert_{2}}{\\lVert \\mathbf{x}(0) \\rVert_{2}}$ for each test case.\n\nYour program should produce a single line of output containing the amplification factors for the $4$ test cases as a comma-separated list enclosed in square brackets, for example $[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}]$, where each $\\text{result}_{i}$ is a floating-point number. The amplification factors are dimensionless quantities and must be computed exactly as specified above. No additional output beyond this single line is permitted.", "solution": "The problem statement is valid. It is scientifically grounded in the principles of classical mechanics and linear stability analysis as applied to molecular dynamics. It is well-posed, providing all necessary matrices, vectors, and scalar parameters for each test case, and specifies a clear, unambiguous computational task. The provided physical values are realistic for molecular systems, and the units are consistent. The problem is objective and requires a formal, algorithmic solution.\n\nThe core of the problem lies in solving the linearized equation of motion for a molecular system near a stationary point on its potential energy surface. The provided equation is Newton's second law in matrix form for small displacements $\\mathbf{x}$ from a stationary configuration $\\mathbf{R}^{\\ddagger}$:\n$$\nM \\ddot{\\mathbf{x}} = -H \\mathbf{x}\n$$\nwhere $M$ is the diagonal mass matrix, $\\ddot{\\mathbf{x}}$ is the acceleration vector, and $H$ is the Hessian matrix of the potential energy function $U(\\mathbf{R})$ evaluated at $\\mathbf{R}^{\\ddagger}$.\n\nTo solve this second-order linear system, we reformulate it as a first-order system. We define a state vector $\\mathbf{y} \\in \\mathbb{R}^{2N}$ that concatenates the position displacements $\\mathbf{x} \\in \\mathbb{R}^N$ and the velocities $\\mathbf{v} = \\dot{\\mathbf{x}} \\in \\mathbb{R}^N$:\n$$\n\\mathbf{y}(t) = \\begin{pmatrix} \\mathbf{x}(t) \\\\ \\mathbf{v}(t) \\end{pmatrix}\n$$\nThe time derivative of this state vector, $\\dot{\\mathbf{y}}(t)$, is then:\n$$\n\\dot{\\mathbf{y}}(t) = \\begin{pmatrix} \\dot{\\mathbf{x}}(t) \\\\ \\dot{\\mathbf{v}}(t) \\end{pmatrix} = \\begin{pmatrix} \\mathbf{v}(t) \\\\ \\ddot{\\mathbf{x}}(t) \\end{pmatrix}\n$$\nFrom the equation of motion, we can express the acceleration as $\\ddot{\\mathbf{x}} = -M^{-1}H\\mathbf{x}$. Substituting this and $\\mathbf{v} = \\dot{\\mathbf{x}}$ into the expression for $\\dot{\\mathbf{y}}$ yields:\n$$\n\\dot{\\mathbf{y}}(t) = \\begin{pmatrix} \\mathbf{v}(t) \\\\ -M^{-1}H\\mathbf{x}(t) \\end{pmatrix} = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix} \\begin{pmatrix} \\mathbf{x}(t) \\\\ \\mathbf{v}(t) \\end{pmatrix}\n$$\nwhere $I$ is the $N \\times N$ identity matrix and $0$ is the $N \\times N$ zero matrix. This is a linear homogeneous system of first-order ordinary differential equations of the form $\\dot{\\mathbf{y}} = A \\mathbf{y}$, with the dynamics matrix $A$ given by:\n$$\nA = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix}\n$$\nThe solution to this system with an initial condition $\\mathbf{y}(0) = \\mathbf{y}_0$ is given by the matrix exponential:\n$$\n\\mathbf{y}(t) = e^{At} \\mathbf{y}_0\n$$\nFor this problem, the initial conditions are specified as an initial displacement $\\mathbf{x}(0) = \\mathbf{x}_0$ and zero initial velocity $\\mathbf{v}(0) = \\mathbf{0}$. Therefore, the initial state vector is:\n$$\n\\mathbf{y}(0) = \\begin{pmatrix} \\mathbf{x}_0 \\\\ \\mathbf{0} \\end{pmatrix}\n$$\nWe need to find the state at a specific time $T$. The solution is:\n$$\n\\mathbf{y}(T) = e^{AT} \\mathbf{y}(0) = \\begin{pmatrix} \\mathbf{x}(T) \\\\ \\mathbf{v}(T) \\end{pmatrix}\n$$\nThe displacement vector at time $T$, $\\mathbf{x}(T)$, consists of the first $N$ components of the resulting vector $\\mathbf{y}(T)$.\n\nThe final step is to compute the amplification factor $a$, which is defined as the ratio of the Euclidean norm of the displacement vector at time $T$ to its norm at time $t=0$:\n$$\na = \\frac{\\lVert \\mathbf{x}(T) \\rVert_2}{\\lVert \\mathbf{x}(0) \\rVert_2}\n$$\nwhere $\\lVert \\mathbf{z} \\rVert_2 = \\sqrt{\\sum_{i=1}^{N} z_i^2}$ for any vector $\\mathbf{z} \\in \\mathbb{R}^N$.\n\nThe algorithm for each test case is as follows:\n$1$. Construct the diagonal mass matrix $M$ and the Hessian matrix $H$ from the given values. For all test cases, $N=2$.\n$2$. Calculate the inverse mass matrix $M^{-1}$, which is a diagonal matrix whose elements are the reciprocals of the masses $m_i$.\n$3$. Construct the $4 \\times 4$ dynamics matrix $A = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix}$.\n$4$. Construct the $4 \\times 1$ initial state vector $\\mathbf{y}(0)$ by concatenating the given $\\mathbf{x}_0$ and the zero vector $\\mathbf{v}_0 = \\mathbf{0}$.\n$5$. Compute the matrix exponential of $A \\times T$, where $T = 1.0 \\times 10^{-13}\\ \\mathrm{s}$. Numerically, this is done using a robust algorithm like the one provided by `scipy.linalg.expm`.\n$6$. Calculate the state vector at time $T$ via the matrix-vector product $\\mathbf{y}(T) = (e^{AT}) \\mathbf{y}(0)$.\n$7$. Extract the displacement vector $\\mathbf{x}(T)$ from the first $N=2$ components of $\\mathbf{y}(T)$.\n$8$. Compute the Euclidean norms of $\\mathbf{x}(T)$ and $\\mathbf{x}(0)$ using `numpy.linalg.norm`.\n$9$. Calculate the amplification factor $a$ as their ratio.\n\nThis procedure will be repeated for each of the four test cases provided, yielding four distinct amplification factors. The nature of the Hessian matrix in each case (indefinite, positive definite, semi-definite) determines the stability of the dynamics. An indefinite Hessian implies at least one negative eigenvalue, corresponding to an unstable direction (a saddle point) where small displacements can grow exponentially, leading to $a > 1$. A positive definite Hessian corresponds to a stable minimum where displacements lead to oscillations, typically resulting in $a \\le 1$. A semi-definite Hessian with a zero eigenvalue corresponds to a flat direction, where a particle with no initial velocity will not accelerate, leading to $a = 1$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Computes the amplification factor for linearized dynamics near a stationary point\n    for several test cases in molecular dynamics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[-0.5, 0.0], [0.0, 0.8]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 2\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[0.7, 0.0], [0.0, 1.1]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 3\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[0.0, 0.0], [0.0, 0.6]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 4\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[-0.2, 0.15], [0.15, 0.3]]),\n            \"x0\": np.array([1.0e-12, 1.0e-12]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case[\"N\"]\n        M_diag = case[\"M_diag\"]\n        H = case[\"H\"]\n        x0 = case[\"x0\"]\n        v0 = case[\"v0\"]\n        T = case[\"T\"]\n\n        # 1. Construct matrices\n        M_inv = np.diag([1.0/m for m in M_diag])\n        I = np.identity(N)\n        Z = np.zeros((N, N))\n\n        # 2. Construct the dynamics matrix A\n        A = np.block([\n            [Z, I],\n            [-M_inv @ H, Z]\n        ])\n\n        # 3. Construct the initial state vector y0\n        y0 = np.concatenate([x0, v0])\n\n        # 4. Propagate using the matrix exponential\n        # y(T) = exp(A*T) @ y(0)\n        exp_AT = expm(A * T)\n        yT = exp_AT @ y0\n\n        # 5. Extract x(T)\n        xT = yT[:N]\n\n        # 6. Compute norms\n        norm_x0 = np.linalg.norm(x0)\n        norm_xT = np.linalg.norm(xT)\n        \n        # 7. Compute amplification factor a\n        # Avoid division by zero if x0 is the zero vector, although not the case here.\n        if norm_x0  0:\n            amplification_factor = norm_xT / norm_x0\n        else:\n            amplification_factor = 1.0 # Or undefined, but 1 seems reasonable.\n\n        results.append(amplification_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3451224"}, {"introduction": "Here, we transition from theoretical analysis to a practical challenge in modern molecular dynamics: the need to truncate long-range potentials without introducing simulation artifacts. This exercise demonstrates how the principles of Taylor expansions are applied to engineer polynomial \"switching functions\" that smoothly taper the potential and its derivatives to zero at a cutoff distance. By implementing and quantifying the \"force noise\" from functions of varying smoothness, you will see a direct link between enforcing higher-order derivative continuity and improving the physical accuracy of the forces that drive the simulation. [@problem_id:3451255]", "problem": "You are given a base pair potential energy function in reduced units (dimensionless), and you will construct switching functions that smoothly bring the potential to zero at a cutoff while preserving Taylor expansion coefficients of the base potential at the start of the switching interval. Then you will quantify the force noise introduced by different smoothness classes of tapers.\n\nDefinitions and assumptions:\n- The base potential energy is the Lennard-Jones form in reduced units with $ \\epsilon = 1 $ and $ \\sigma = 1 $:\n$$\nU_0(r) = 4 \\left[ r^{-12} - r^{-6} \\right].\n$$\n- The corresponding unswitched force is given by $ F_0(r) = -\\frac{dU_0}{dr} $, i.e.,\n$$\nF_0(r) = 24 \\left[ 2 r^{-13} - r^{-7} \\right].\n$$\n- A switched potential $ U(r) $ is defined as a multiplicative switch,\n$$\nU(r) =\n\\begin{cases}\nU_0(r),  r \\le r_s, \\\\\nS\\!\\left(\\dfrac{r-r_s}{r_c - r_s}\\right)\\, U_0(r),  r_s lt; r lt; r_c, \\\\\n0,  r \\ge r_c,\n\\end{cases}\n$$\nwhere $ r_s $ is the switching start radius and $ r_c $ is the cutoff radius, with $ r_c gt; r_s $, and $ S(x) $ is a polynomial on $ x \\in [0,1] $. Define the switching width $ w = r_c - r_s $ and the normalized coordinate $ x = (r - r_s)/w $.\n\n- The switched force is\n$$\nF(r) = -\\frac{d}{dr} \\big( S(x)\\, U_0(r) \\big) = -\\left[ S(x)\\, \\frac{dU_0}{dr}(r) + \\frac{1}{w}\\, \\frac{dS}{dx}(x)\\, U_0(r) \\right],\n$$\nfor $ r \\in (r_s, r_c) $, and equals $ F_0(r) $ for $ r \\le r_s $, and $ 0 $ for $ r \\ge r_c $.\n\n- Define the force error in the switching region by\n$$\n\\Delta F(r) = F(r) - F_0(r).\n$$\n- Define the root-mean-square (RMS) force noise over the switching interval by the continuous average\n$$\n\\mathrm{RMS} = \\sqrt{ \\frac{1}{r_c - r_s} \\int_{r_s}^{r_c} \\left[ \\Delta F(r) \\right]^2 \\, dr }.\n$$\n\nTasks:\n1) Construct three switching functions $ S(x) $ on $ x \\in [0,1] $ of increasing smoothness class:\n   - $C^0$ linear taper, enforcing only $ S(0) = 1 $ and $ S(1) = 0 $, with no derivative constraints at the endpoints. This results in a polynomial of degree $1$.\n   - $C^1$ Hermite cubic taper, enforcing $ S(0) = 1 $, $ \\frac{dS}{dx}(0) = 0 $, $ S(1) = 0 $, $ \\frac{dS}{dx}(1) = 0 $. This results in a polynomial of degree $3$.\n   - $C^2$ optimized quintic taper, enforcing at the cutoff $ r_c $ the conditions $ U(r_c) = 0 $, $ U'(r_c) = 0 $, $ U''(r_c) = 0 $ and preserving the Taylor expansion of $ U_0(r) $ at $ r_s $ up to second order. Show that this is achieved by taking $ S(x) $ such that\n$$\nS(0) = 1,\\quad \\frac{dS}{dx}(0) = 0,\\quad \\frac{d^2S}{dx^2}(0) = 0;\\qquad\nS(1) = 0,\\quad \\frac{dS}{dx}(1) = 0,\\quad \\frac{d^2S}{dx^2}(1) = 0,\n$$\nwhich determines a polynomial of degree $5$.\n\n2) For each switching function, compute the RMS force noise as defined above by numerically evaluating the integral using a uniform grid in $ r \\in [r_s, r_c] $ with at least $ N = 20001 $ points. All quantities are dimensionless in reduced units.\n\n3) Use the following test suite of parameter pairs $ (r_s, r_c) $:\n   - Case A (happy path): $ r_s = 1.8 $, $ r_c = 2.5 $.\n   - Case B (narrow switch): $ r_s = 2.45 $, $ r_c = 2.5 $.\n   - Case C (early switch): $ r_s = 1.3 $, $ r_c = 1.6 $.\n\nYour program must:\n- Derive the $C^2$ optimized quintic coefficients by solving the linear system implied by the six endpoint conditions above (do not hard-code the coefficients).\n- Implement the $C^0$, $C^1$, and derived $C^2$ tapers.\n- For each case in the test suite, compute and return a list with the three RMS values $ [\\mathrm{RMS}_{C^0}, \\mathrm{RMS}_{C^1}, \\mathrm{RMS}_{C^2}] $.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the three test cases as a comma-separated list of lists, enclosed in square brackets, in the order A, B, C. For example:\n\"[ [rA_C0,rA_C1,rA_C2],[rB_C0,rB_C1,rB_C2],[rC_C0,rC_C1,rC_C2] ]\"\nAll numbers are dimensionless and should be printed as standard floating-point literals.", "solution": "The user-provided problem has been analyzed and is deemed valid. It is scientifically grounded in the principles of molecular dynamics, well-posed, objective, and contains all necessary information for a unique solution.\n\n### 1. Problem Formulation\n\nThe problem requires the construction and analysis of three polynomial switching functions, $S(x)$, used to smoothly truncate a Lennard-Jones (LJ) potential, $U_0(r)$, to zero over a finite interval $[r_s, r_c]$. The base LJ potential and its corresponding force are given in reduced units as:\n$$\nU_0(r) = 4 \\left( r^{-12} - r^{-6} \\right)\n$$\n$$\nF_0(r) = -\\frac{dU_0}{dr} = 24 \\left( 2r^{-13} - r^{-7} \\right)\n$$\nThe switched potential, $U(r)$, is defined using a normalized coordinate $x = \\frac{r-r_s}{r_c - r_s}$ for $r \\in [r_s, r_c]$, where $w = r_c - r_s$ is the switching width:\n$$\nU(r) = S(x) U_0(r) \\quad \\text{for } r \\in (r_s, r_c)\n$$\nThe corresponding switched force is $F(r) = -U'(r)$. Using the chain rule, this becomes:\n$$\nF(r) = -\\frac{d}{dr}\\left[S(x) U_0(r)\\right] = - \\left( \\frac{dS}{dx}\\frac{dx}{dr} U_0(r) + S(x) \\frac{dU_0}{dr} \\right)\n$$\nSince $\\frac{dx}{dr} = \\frac{1}{w}$ and $-\\frac{dU_0}{dr} = F_0(r)$, the force is:\n$$\nF(r) = S(x) F_0(r) - \\frac{1}{w} \\frac{dS}{dx}(x) U_0(r)\n$$\nThe force error, $\\Delta F(r) = F(r) - F_0(r)$, in the switching region $(r_s, r_c)$ is therefore:\n$$\n\\Delta F(r) = \\left( S(x) - 1 \\right) F_0(r) - \\frac{1}{w} \\frac{dS}{dx}(x) U_0(r)\n$$\nThe quality of a switching function is quantified by the root-mean-square (RMS) force noise over the switching interval:\n$$\n\\mathrm{RMS} = \\sqrt{ \\frac{1}{r_c - r_s} \\int_{r_s}^{r_c} \\left[ \\Delta F(r) \\right]^2 \\, dr }\n$$\n\n### 2. Construction of Switching Functions $S(x)$\n\nWe construct three polynomial switching functions of increasing smoothness on $x \\in [0,1]$.\n\n#### 2.1. $C^0$ Linear Taper\nThis function is a polynomial of degree $1$, $S_{C^0}(x) = c_1 x + c_0$. It must satisfy boundary conditions for the potential to be continuous ($C^0$).\n1.  At $r=r_s$ ($x=0$): $U(r_s) = U_0(r_s) \\implies S(0)U_0(r_s) = U_0(r_s) \\implies S(0) = 1$.\n2.  At $r=r_c$ ($x=1$): $U(r_c) = 0 \\implies S(1)U_0(r_c) = 0 \\implies S(1) = 0$.\n\nThe conditions $S(0) = 1$ and $S(1) = 0$ give:\n$c_0 = 1$\n$c_1 + c_0 = 0 \\implies c_1 = -1$\nThus, the linear taper is $S_{C^0}(x) = 1 - x$, with derivative $\\frac{dS_{C^0}}{dx} = -1$.\n\n#### 2.2. $C^1$ Hermite Cubic Taper\nThis function is a polynomial of degree $3$, $S_{C^1}(x) = c_3 x^3 + c_2 x^2 + c_1 x + c_0$. It enforces continuity of the potential and its first derivative (the force), making the overall potential $U(r)$ a $C^1$ function. This requires four conditions:\n1.  $S(0) = 1$ (Potential continuity at $r_s$)\n2.  $S(1) = 0$ (Potential is zero at $r_c$)\n3.  $\\frac{dS}{dx}(0) = 0$ (Force continuity at $r_s$)\n4.  $\\frac{dS}{dx}(1) = 0$ (Force is zero at $r_c$)\n\nApplying these to $S(x)$ and its derivative $S'(x) = 3c_3 x^2 + 2c_2 x + c_1$:\n1.  $S(0) = 1 \\implies c_0 = 1$.\n2.  $S'(0) = 0 \\implies c_1 = 0$.\n3.  $S(1) = 0 \\implies c_3 + c_2 + c_1 + c_0 = 0 \\implies c_3 + c_2 = -1$.\n4.  $S'(1) = 0 \\implies 3c_3 + 2c_2 + c_1 = 0 \\implies 3c_3 + 2c_2 = 0$.\n\nSolving the system $c_3 + c_2 = -1$ and $3c_3 + 2c_2 = 0$ yields $c_3 = 2$ and $c_2 = -3$.\nThus, the cubic taper is $S_{C^1}(x) = 2x^3 - 3x^2 + 1$, with derivative $\\frac{dS_{C^1}}{dx} = 6x^2 - 6x$.\n\n#### 2.3. $C^2$ Optimized Quintic Taper\nThis function is a polynomial of degree $5$, $S_{C^2}(x) = \\sum_{i=0}^{5} c_i x^i$. It ensures continuity of the potential and its first two derivatives, making $U(r)$ a $C^2$ function.\n\nFirst, we demonstrate that the required conditions on $U(r)$ translate to the specified conditions on $S(x)$.\nThe derivatives of $U(r) = S(x(r))U_0(r)$ are:\n$U'(r) = \\frac{1}{w}S'(x)U_0(r) + S(x)U_0'(r)$\n$U''(r) = \\frac{1}{w^2}S''(x)U_0(r) + \\frac{2}{w}S'(x)U_0'(r) + S(x)U_0''(r)$\n\nAt $r=r_s$ ($x=0$), we require $U(r)$ to match the Taylor expansion of $U_0(r)$ up to second order. This means $U(r_s)=U_0(r_s)$, $U'(r_s)=U_0'(r_s)$, and $U''(r_s)=U_0''(r_s)$.\n- $U(r_s)=U_0(r_s) \\implies S(0)U_0(r_s)=U_0(r_s) \\implies S(0)=1$.\n- $U'(r_s)=U_0'(r_s) \\implies \\frac{1}{w}S'(0)U_0(r_s) + S(0)U_0'(r_s) = U_0'(r_s)$. With $S(0)=1$, this simplifies to $\\frac{1}{w}S'(0)U_0(r_s)=0$, which implies $S'(0)=0$.\n- $U''(r_s)=U_0''(r_s) \\implies \\frac{1}{w^2}S''(0)U_0(r_s) + \\frac{2}{w}S'(0)U_0'(r_s) + S(0)U_0''(r_s) = U_0''(r_s)$. With $S(0)=1$ and $S'(0)=0$, this simplifies to $\\frac{1}{w^2}S''(0)U_0(r_s)=0$, which implies $S''(0)=0$.\n\nAt $r=r_c$ ($x=1$), we require the potential and its first two derivatives to be zero: $U(r_c)=U'(r_c)=U''(r_c)=0$.\n- $U(r_c)=0 \\implies S(1)U_0(r_c)=0 \\implies S(1)=0$.\n- $U'(r_c)=0 \\implies \\frac{1}{w}S'(1)U_0(r_c) + S(1)U_0'(r_c)=0$. With $S(1)=0$, this simplifies to $\\frac{1}{w}S'(1)U_0(r_c)=0$, which implies $S'(1)=0$.\n- $U''(r_c)=0 \\implies \\frac{1}{w^2}S''(1)U_0(r_c) + \\frac{2}{w}S'(1)U_0'(r_c) + S(1)U_0''(r_c)=0$. With $S(1)=0$ and $S'(1)=0$, this simplifies to $\\frac{1}{w^2}S''(1)U_0(r_c)=0$, which implies $S''(1)=0$.\n\nThis confirms the six conditions: $S(0)=1$, $S'(0)=0$, $S''(0)=0$, $S(1)=0$, $S'(1)=0$, $S''(1)=0$.\nApplying these to $S(x) = \\sum_{i=0}^{5} c_i x^i$:\n- Conditions at $x=0$ immediately give $c_0=1, c_1=0, c_2=0$.\n- Conditions at $x=1$ on $S(x) = c_5 x^5 + c_4 x^4 + c_3 x^3 + 1$ give a $3 \\times 3$ linear system for $(c_3, c_4, c_5)$:\n$$\n\\begin{pmatrix} 1  1  1 \\\\ 3  4  5 \\\\ 6  12  20 \\end{pmatrix} \\begin{pmatrix} c_3 \\\\ c_4 \\\\ c_5 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThis system is solved numerically in the implementation. The solution is $c_3=-10, c_4=15, c_5=-6$.\nThus, the quintic taper is $S_{C^2}(x) = -6x^5 + 15x^4 - 10x^3 + 1$.\n\n### 3. Numerical Calculation of RMS Force Noise\n\nThe RMS force noise is computed for each test case $(r_s, r_c)$ and for each of the three switching functions. The procedure is as follows:\n1.  A uniform grid of $N=20001$ points, $\\{r_i\\}$, is created over the interval $[r_s, r_c]$.\n2.  The corresponding grid of normalized coordinates, $\\{x_i\\}$, is calculated.\n3.  The base potential $U_0(r_i)$ and force $F_0(r_i)$ are evaluated at each grid point.\n4.  For each smoother ($C^0, C^1, C^2$), the polynomial $S(x_i)$ and its derivative $\\frac{dS}{dx}(x_i)$ are evaluated.\n5.  The force error array, $\\Delta F(r_i)$, is computed using the formula derived in Section 1.\n6.  The definite integral $\\int_{r_s}^{r_c} [\\Delta F(r)]^2 dr$ is approximated numerically using the trapezoidal rule on the grid data.\n7.  The final RMS value is calculated from the integral and the switching width $w=r_c-r_s$.\n\nThis process is repeated for each parameter set, and the results are aggregated for the final output. The expectation is that the RMS noise will decrease as the smoothness of the switching function increases ($C^0  C^1  C^2$), reflecting the progressive reduction of artifacts introduced by the potential truncation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial import Polynomial\n\ndef solve():\n    \"\"\"\n    Solves the molecular dynamics switching function problem.\n    1. Derives the C^2 quintic polynomial switching function.\n    2. Implements C^0, C^1, and C^2 switching functions.\n    3. Computes the RMS force noise for three test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.8, 2.5),  # Case A: Happy path\n        (2.45, 2.5), # Case B: Narrow switch\n        (1.3, 1.6),  # Case C: Early switch\n    ]\n    \n    N_points = 20001\n    \n    # -------------------------------------------------------------\n    # Task 1: Construct Switching Functions S(x)\n    # -------------------------------------------------------------\n    \n    # C^0 Linear Taper: S(x) = 1 - x\n    S0_poly = Polynomial([1.0, -1.0])\n    dS0_poly = S0_poly.deriv()\n\n    # C^1 Hermite Cubic Taper: S(x) = 2x^3 - 3x^2 + 1\n    S1_poly = Polynomial([1.0, 0.0, -3.0, 2.0])\n    dS1_poly = S1_poly.deriv()\n\n    # C^2 Optimized Quintic Taper\n    # The problem requires deriving the coefficients by solving the linear system.\n    # S(x) = c5*x^5 + c4*x^4 + c3*x^3 + c2*x^2 + c1*x + c0\n    # Conditions at x=0 (S(0)=1, S'(0)=0, S''(0)=0) yield c0=1, c1=0, c2=0.\n    # Conditions at x=1 (S(1)=0, S'(1)=0, S''(1)=0) on S(x) = c5*x^5+c4*x^4+c3*x^3+1\n    # yield a 3x3 system for (c3, c4, c5):\n    # S(1)=0  = c3 + c4 + c5 = -1\n    # S'(1)=0 = 3*c3 + 4*c4 + 5*c5 = 0\n    # S''(1)=0= 6*c3 + 12*c4 + 20*c5 = 0\n    A = np.array([\n        [1.0, 1.0, 1.0],\n        [3.0, 4.0, 5.0],\n        [6.0, 12.0, 20.0]\n    ])\n    b = np.array([-1.0, 0.0, 0.0])\n    c3, c4, c5 = np.linalg.solve(A, b)\n    c2_coeffs = np.array([1.0, 0.0, 0.0, c3, c4, c5])\n    S2_poly = Polynomial(c2_coeffs)\n    dS2_poly = S2_poly.deriv()\n\n    smoothers = [\n        (S0_poly, dS0_poly),\n        (S1_poly, dS1_poly),\n        (S2_poly, dS2_poly)\n    ]\n\n    # -------------------------------------------------------------\n    # Base Potential and Force Definitions\n    # -------------------------------------------------------------\n    \n    def U0(r):\n        \"\"\"Lennard-Jones potential.\"\"\"\n        r_inv = 1.0 / r\n        r_inv6 = r_inv**6\n        return 4.0 * (r_inv6**2 - r_inv6)\n\n    def F0(r):\n        \"\"\"Lennard-Jones force.\"\"\"\n        r_inv = 1.0 / r\n        r_inv7 = r_inv**7\n        return 24.0 * (2.0 * r_inv7 * r_inv**6 - r_inv7)\n\n    all_results = []\n    for rs, rc in test_cases:\n        # -------------------------------------------------------------\n        # Task 2: Compute RMS force noise\n        # -------------------------------------------------------------\n        \n        # Setup grid and pre-compute base values\n        w = rc - rs\n        r_grid = np.linspace(rs, rc, N_points)\n        x_grid = (r_grid - rs) / w\n\n        u0_vals = U0(r_grid)\n        f0_vals = F0(r_grid)\n\n        case_results = []\n        for S_poly, dS_poly in smoothers:\n            # Evaluate switching function and its derivative on the grid\n            s_vals = S_poly(x_grid)\n            ds_dx_vals = dS_poly(x_grid)\n\n            # Calculate force error Delta_F(r)\n            # Delta_F = (S(x) - 1) * F0(r) - (1/w) * S'(x) * U0(r)\n            delta_f = (s_vals - 1.0) * f0_vals - (1.0 / w) * ds_dx_vals * u0_vals\n            \n            # Calculate integrand for RMS\n            integrand = delta_f**2\n            \n            # Numerically integrate using the trapezoidal rule\n            integral_val = np.trapz(integrand, r_grid)\n\n            # Compute RMS\n            rms = np.sqrt(integral_val / w)\n            case_results.append(rms)\n        \n        all_results.append(case_results)\n\n    # -------------------------------------------------------------\n    # Final Output Formatting\n    # -------------------------------------------------------------\n    \n    # Format the results into the required string \"[[...],[...],[...]]\"\n    sub_lists_str = [f\"[{','.join(map(str, sub))}]\" for sub in all_results]\n    print(f\"[{','.join(sub_lists_str)}]\")\n\nsolve()\n```", "id": "3451255"}]}