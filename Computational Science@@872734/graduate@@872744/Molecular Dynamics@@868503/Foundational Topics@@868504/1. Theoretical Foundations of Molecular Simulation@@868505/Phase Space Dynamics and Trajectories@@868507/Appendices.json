{"hands_on_practices": [{"introduction": "The evolution of any physical observable in a Hamiltonian system is governed by its Poisson bracket with the Hamiltonian. This mathematical structure is the classical analogue of the commutator in quantum mechanics and forms the algebraic foundation of phase space dynamics. This foundational exercise [@problem_id:3435414] asks you to compute the Poisson brackets between the components of the angular momentum vector, revealing the underlying Lie algebra structure that governs rotations and ensures the conservation of angular momentum in isotropic systems.", "problem": "Consider a single particle evolving in classical Molecular Dynamics (MD) in a three-dimensional (3D) Cartesian phase space with canonical position coordinates $q_{x}$, $q_{y}$, $q_{z}$ and canonical momentum coordinates $p_{x}$, $p_{y}$, $p_{z}$. The orbital angular momentum components are defined by $L_{x} = q_{y} p_{z} - q_{z} p_{y}$, $L_{y} = q_{z} p_{x} - q_{x} p_{z}$, and $L_{z} = q_{x} p_{y} - q_{y} p_{x}$. The Poisson bracket of two phase-space functions $A(q,p)$ and $B(q,p)$ is defined by\n$$\n\\{A,B\\} = \\sum_{i \\in \\{x,y,z\\}} \\left( \\frac{\\partial A}{\\partial q_{i}} \\frac{\\partial B}{\\partial p_{i}} - \\frac{\\partial A}{\\partial p_{i}} \\frac{\\partial B}{\\partial q_{i}} \\right),\n$$\nand the Levi-Civita symbol $\\epsilon_{ijk}$ and Kronecker delta $\\delta_{ij}$ are used with the Einstein summation convention over repeated indices.\n\nStarting from the fundamental definition of the Poisson bracket above and the canonical structure of the phase space, compute the Poisson brackets between the angular momentum components and express the final result for the general bracket in compact index notation as a single analytic expression. No numerical evaluation is required, and no units are to be reported.", "solution": "The problem asks for the computation of the Poisson brackets between the components of the orbital angular momentum vector, $\\{L_i, L_j\\}$, and to express the result in compact index notation.\n\nWe adopt the Einstein summation convention. The canonical coordinates are $q_i$ and $p_i$ for $i \\in \\{1,2,3\\}$. The components of angular momentum are given by the Levi-Civita symbol $\\epsilon_{ijk}$ as $L_i = \\epsilon_{ik\\ell} q_k p_\\ell$. The Poisson bracket is defined as:\n$$\n\\{A,B\\} = \\sum_{a=1}^{3} \\left( \\frac{\\partial A}{\\partial q_{a}} \\frac{\\partial B}{\\partial p_{a}} - \\frac{\\partial A}{\\partial p_{a}} \\frac{\\partial B}{\\partial q_{a}} \\right)\n$$\nWe first compute the necessary partial derivatives of the angular momentum components. The fundamental canonical relations are $\\frac{\\partial q_k}{\\partial q_a} = \\delta_{ka}$ and $\\frac{\\partial p_\\ell}{\\partial p_a} = \\delta_{\\ell a}$.\n$$\n\\frac{\\partial L_i}{\\partial q_a} = \\frac{\\partial}{\\partial q_a} (\\epsilon_{ik\\ell} q_k p_\\ell) = \\epsilon_{ik\\ell} \\delta_{ka} p_\\ell = \\epsilon_{ia\\ell} p_\\ell\n$$\n$$\n\\frac{\\partial L_i}{\\partial p_a} = \\frac{\\partial}{\\partial p_a} (\\epsilon_{ik\\ell} q_k p_\\ell) = \\epsilon_{ik\\ell} q_k \\delta_{\\ell a} = \\epsilon_{ika} q_k\n$$\nSubstituting these into the Poisson bracket definition for $\\{L_i, L_j\\}$:\n$$\n\\{L_i, L_j\\} = \\sum_{a=1}^{3} \\left( (\\epsilon_{ia\\ell} p_\\ell) (\\epsilon_{jma} q_m) - (\\epsilon_{ika} q_k) (\\epsilon_{jan} p_n) \\right)\n$$\nwhere we have used distinct dummy indices for each angular momentum component to avoid confusion. We evaluate the two terms separately.\n\nFor the first term, we sum over the index $a$:\n$$\n\\sum_a (\\epsilon_{ia\\ell} p_\\ell) (\\epsilon_{jma} q_m) = p_\\ell q_m \\sum_a \\epsilon_{ia\\ell} \\epsilon_{jma} = p_\\ell q_m \\sum_a \\epsilon_{a\\ell i} \\epsilon_{amj}\n$$\nUsing the identity for the product of two Levi-Civita symbols, $\\sum_a \\epsilon_{a\\ell i} \\epsilon_{amj} = \\delta_{\\ell m}\\delta_{ij} - \\delta_{\\ell j}\\delta_{im}$:\n$$\np_\\ell q_m (\\delta_{\\ell m}\\delta_{ij} - \\delta_{\\ell j}\\delta_{im}) = \\delta_{ij} (p_m q_m) - p_j q_i\n$$\nFor the second term, we again sum over $a$:\n$$\n\\sum_a (\\epsilon_{ika} q_k) (\\epsilon_{jan} p_n) = q_k p_n \\sum_a \\epsilon_{ika} \\epsilon_{jan} = q_k p_n \\sum_a \\epsilon_{kai} \\epsilon_{anj}\n$$\nUsing the identity $\\sum_a \\epsilon_{kai} \\epsilon_{anj} = \\delta_{kn}\\delta_{ij} - \\delta_{ki}\\delta_{nj}$:\n$$\nq_k p_n (\\delta_{kn}\\delta_{ij} - \\delta_{ki}\\delta_{nj}) = \\delta_{ij} (q_k p_k) - q_i p_j\n$$\nCombining the two terms for the Poisson bracket:\n$$\n\\{L_i, L_j\\} = ( \\delta_{ij} (p_m q_m) - p_j q_i ) - ( \\delta_{ij} (q_k p_k) - q_i p_j )\n$$\nSince $p_m q_m = q_k p_k = \\vec{q} \\cdot \\vec{p}$, the terms with $\\delta_{ij}$ cancel out. Also, since positions and momenta are scalar functions, their order of multiplication does not matter.\n$$\n\\{L_i, L_j\\} = q_i p_j - q_j p_i\n$$\nTo express this in the most compact form, we relate it back to the definition of $L_k$. We consider the expression $\\epsilon_{ijk} L_k$:\n$$\n\\epsilon_{ijk} L_k = \\epsilon_{ijk} (\\epsilon_{k\\ell m} q_\\ell p_m) = (\\epsilon_{ijk} \\epsilon_{k\\ell m}) q_\\ell p_m\n$$\nUsing the contraction identity $\\sum_k \\epsilon_{ijk} \\epsilon_{k\\ell m} = \\sum_k \\epsilon_{kij} \\epsilon_{k\\ell m} = \\delta_{i\\ell}\\delta_{jm} - \\delta_{im}\\delta_{j\\ell}$:\n$$\n\\epsilon_{ijk} L_k = (\\delta_{i\\ell}\\delta_{jm} - \\delta_{im}\\delta_{j\\ell}) q_\\ell p_m = q_i p_j - q_j p_i\n$$\nComparing the two results, we find the compact expression:\n$$\n\\{L_i, L_j\\} = \\epsilon_{ijk} L_k\n$$\nThis fundamental commutation relation shows that the components of angular momentum form a Lie algebra, specifically $\\mathfrak{so}(3)$, under the Poisson bracket.", "answer": "$$\n\\boxed{\\epsilon_{ijk} L_k}\n$$", "id": "3435414"}, {"introduction": "Moving from the abstract algebra of dynamics, we can visualize phase space as a landscape whose topography is defined by the system's energy. This landscape is partitioned by separatrices—special trajectories that divide regions of qualitatively different motion, such as being trapped in a potential well versus roaming freely. In this numerical practice [@problem_id:3435429], you will map this landscape for a classic double-well potential, gaining a powerful intuition for how a particle's long-term fate is sensitively determined by its initial position and momentum relative to the separatrix.", "problem": "Consider a single classical particle of unit mass in one spatial dimension moving in a symmetric double-well potential under Hamiltonian dynamics. The Hamiltonian is $H(x,p) = \\dfrac{p^2}{2} + V(x)$ with $m=1$ and the potential $V(x) = \\dfrac{(x^2 - 1)^2}{4}$. All quantities are nondimensional; no physical units are used. The equations of motion follow from Newton's second law and Hamilton's equations, namely $\\dot{x} = \\dfrac{\\partial H}{\\partial p}$ and $\\dot{p} = -\\dfrac{\\partial H}{\\partial x}$. The phase space separatrix divides initial conditions that remain trapped in a single well from those that traverse between the two wells. Your goal is to identify the separatrix by fundamental principles and then numerically map the long-time fate of trajectories as a function of initial conditions across this boundary.\n\nTasks:\n- Starting from the definitions, determine the phase space separatrix energy by identifying stationary points of $V(x)$ through $V'(x) = 0$, classifying their stability via $V''(x)$, and using the Hamiltonian at the unstable stationary point to define the separatrix energy $E_{\\mathrm{sep}}$. Do not use any pre-known or shortcut formulas; determine the stationary points and their nature directly from $V(x)$.\n- Implement a symplectic time integrator based on first principles (for example, the velocity-Verlet scheme derived from Hamilton's equations) to evolve trajectories from specified initial conditions $(x_0,p_0)$ over a long time. Use a fixed time step $\\Delta t = 10^{-3}$ and integrate up to total time $T = 200$.\n- For each trajectory, classify its long-time fate solely from the simulated time series as follows. Let $f_L$ be the fraction of steps with $x(t)  0$ and $f_R$ the fraction with $x(t)  0$, ignoring steps where $|x(t)|$ is within a small buffer $\\delta_x = 10^{-3}$ around the separatrix coordinate $x=0$. If the trajectory remains within a tiny neighborhood of the saddle (detected by $\\max_t |x(t)|  \\delta_x$ and $\\max_t |p(t)|  \\delta_p$ with $\\delta_p = 10^{-6}$), classify it as separatrix-stuck. Otherwise, if $f_L  0.95$ and $f_R  0.05$, classify it as left-well trapped; if $f_R  0.95$ and $f_L  0.05$, classify it as right-well trapped; else classify it as roaming between wells.\n- Encode the classification as an integer code $c$ for each trajectory: left-well trapped $c=-1$, right-well trapped $c=+1$, roaming $c=0$, separatrix-stuck $c=2$.\n\nTest suite:\nSimulate the following initial conditions $(x_0,p_0)$, expressed as ordered pairs of real numbers: \n$(-1.2,0.0)$, $(1.2,0.0)$, $(0.0,1.0)$, $(0.0,0.0)$, $(0.01,0.0)$, $(-0.01,0.0)$, $(0.01,0.2)$.\nThese cases collectively probe a happy-path trapped case in each well, an above-barrier roaming case, the exact saddle, and near-separatrix sensitivity on both sides.\n\nFinal output specification:\nYour program should produce a single line of output containing the classification results for the test suite, in the same order as listed above, as a comma-separated list of integers enclosed in square brackets (for example, $[c_1,c_2,\\dots]$). No additional text should be printed. All computations are to be performed in nondimensional form as stated above. The required output is unitless and contains only integers. Angles are not involved in this problem. The only acceptable outputs are booleans, integers, floats, or lists thereof; here, the required output is a list of integers.", "solution": "The problem requires an analysis and numerical simulation of a particle's motion in a one-dimensional double-well potential. The solution proceeds in three stages: first, an analytical characterization of the system's key features, such as equilibrium points and the separatrix energy; second, the formulation of a suitable numerical integration scheme; and third, the implementation of a classification algorithm to determine the long-term fate of trajectories.\n\nThe system is described by the Hamiltonian $H(x,p) = \\frac{p^2}{2m} + V(x)$, with mass $m=1$ and potential $V(x) = \\frac{1}{4}(x^2 - 1)^2$. All quantities are dimensionless. The equations of motion are derived from Hamilton's equations:\n$$ \\dot{x} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m} = p $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial x} = -\\frac{dV}{dx} $$\n\nFirst, we must determine the phase space separatrix, which is defined by the energy level of the unstable equilibrium points (saddle points in phase space). We find the equilibrium positions by identifying the stationary points of the potential $V(x)$, where the force $F(x) = -V'(x)$ is zero.\nThe potential is $V(x) = \\frac{1}{4}(x^4 - 2x^2 + 1)$.\nThe first derivative is:\n$$ V'(x) = \\frac{d}{dx} \\left[ \\frac{1}{4}(x^4 - 2x^2 + 1) \\right] = \\frac{1}{4}(4x^3 - 4x) = x^3 - x $$\nSetting $V'(x)=0$ to find the stationary points:\n$$ x^3 - x = x(x^2 - 1) = x(x-1)(x+1) = 0 $$\nThe stationary points are located at $x = -1$, $x = 0$, and $x = +1$.\n\nTo classify the stability of these points, we examine the second derivative of the potential, $V''(x)$:\n$$ V''(x) = \\frac{d}{dx}(x^3 - x) = 3x^2 - 1 $$\nWe evaluate $V''(x)$ at each stationary point:\n- At $x = -1$: $V''(-1) = 3(-1)^2 - 1 = 2 > 0$. This indicates a local potential minimum, corresponding to a stable equilibrium.\n- At $x = +1$: $V''(+1) = 3(1)^2 - 1 = 2 > 0$. This also indicates a local potential minimum, a stable equilibrium.\n- At $x = 0$: $V''(0) = 3(0)^2 - 1 = -1  0$. This indicates a local potential maximum, corresponding to an unstable equilibrium.\n\nThe separatrix is the trajectory that passes through the unstable equilibrium point. In phase space, this point is $(x,p) = (0,0)$, as the particle must be at rest at the peak of the potential barrier. The energy of this trajectory defines the separatrix energy, $E_{\\mathrm{sep}}$:\n$$ E_{\\mathrm{sep}} = H(0,0) = \\frac{0^2}{2} + V(0) = \\frac{(0^2 - 1)^2}{4} = \\frac{1}{4} = 0.25 $$\nTrajectories with total energy $E  E_{\\mathrm{sep}}$ are confined to one of the potential wells, while trajectories with $E  E_{\\mathrm{sep}}$ can roam between the two wells. Trajectories with $E = E_{\\mathrm{sep}}$ lie on the separatrix itself.\n\nTo simulate the trajectories, we employ a symplectic integrator, specifically the velocity-Verlet algorithm, which is well-suited for long-term integration of Hamiltonian systems due to its good energy conservation properties. For a particle of mass $m=1$, the algorithm is derived from a Taylor expansion of the position and consists of the following steps for a time step $\\Delta t$:\n1. Update the position: $x(t + \\Delta t) = x(t) + p(t)\\Delta t + \\frac{1}{2} F(x(t)) \\Delta t^2$.\n2. Compute the force at the new position: $F(x(t + \\Delta t)) = -V'(x(t + \\Delta t))$.\n3. Update the momentum: $p(t + \\Delta t) = p(t) + \\frac{1}{2} [F(x(t)) + F(x(t + \\Delta t))] \\Delta t$.\nHere, the force is $F(x) = -V'(x) = -(x^3 - x) = x - x^3$. The simulation will run from $t=0$ to $T=200$ with a time step of $\\Delta t = 10^{-3}$.\n\nFinally, each simulated trajectory, represented by the time series $\\{x(t_i), p(t_i)\\}$, must be classified. The classification is performed according to a prescribed set of rules.\nFirst, we check if the trajectory is \"stuck\" at the saddle point $(0,0)$. This is the case if the maximum absolute position and momentum values throughout the simulation are below specified thresholds: $\\max_t |x(t)|  \\delta_x$ and $\\max_t |p(t)|  \\delta_p$, where $\\delta_x = 10^{-3}$ and $\\delta_p = 10^{-6}$. If so, the trajectory is assigned the code $c=2$.\n\nIf the trajectory is not stuck, we analyze its distribution across the two potential wells. We calculate the fraction of time steps the particle spends in the left well ($x(t)  0$) and the right well ($x(t)  0$), ignoring any steps where the particle is within a small buffer zone around the origin, i.e., $|x(t)| \\le \\delta_x$. Let $N_L$ be the count of steps where $x(t)  -\\delta_x$, and $N_R$ be the count where $x(t)  \\delta_x$. The total number of relevant steps is $N_{total} = N_L + N_R$. The fractions are then $f_L = N_L / N_{total}$ and $f_R = N_R / N_{total}$.\nThe classification is then:\n- Left-well trapped ($c=-1$): If $f_L  0.95$ and $f_R  0.05$.\n- Right-well trapped ($c=+1$): If $f_R  0.95$ and $f_L  0.05$.\n- Roaming ($c=0$): Otherwise.\n\nThe following Python code implements this entire procedure, applying it to the specified suite of initial conditions and producing the required output format.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of classifying trajectories in a double-well potential.\n    \"\"\"\n\n    def run_simulation(x0, p0, dt, T):\n        \"\"\"\n        Integrates a trajectory using the velocity-Verlet algorithm.\n        \n        Args:\n            x0 (float): Initial position.\n            p0 (float): Initial momentum.\n            dt (float): Time step.\n            T (float): Total integration time.\n\n        Returns:\n            tuple: A tuple containing arrays for the position and momentum trajectories.\n        \"\"\"\n        num_steps = int(T / dt)\n        x = float(x0)\n        p = float(p0)\n        \n        x_traj = np.zeros(num_steps + 1)\n        p_traj = np.zeros(num_steps + 1)\n        x_traj[0] = x\n        p_traj[0] = p\n        \n        def force(pos):\n            \"\"\"Calculates the force F(x) = -V'(x) = x - x^3.\"\"\"\n            return pos - pos**3\n\n        for i in range(num_steps):\n            F_current = force(x)\n            # Update position\n            x_next = x + p * dt + 0.5 * F_current * dt**2\n            # Update force\n            F_next = force(x_next)\n            # Update momentum\n            p_next = p + 0.5 * (F_current + F_next) * dt\n            \n            x = x_next\n            p = p_next\n            \n            x_traj[i+1] = x\n            p_traj[i+1] = p\n            \n        return x_traj, p_traj\n\n    def classify_trajectory(x_traj, p_traj):\n        \"\"\"\n        Classifies a trajectory based on its long-term behavior.\n\n        Args:\n            x_traj (np.array): Array of position values over time.\n            p_traj (np.array): Array of momentum values over time.\n\n        Returns:\n            int: Classification code (-1, 1, 0, or 2).\n        \"\"\"\n        delta_x = 1e-3\n        delta_p = 1e-6\n\n        # Rule 1: Check for separatrix-stuck condition\n        if np.max(np.abs(x_traj))  delta_x and np.max(np.abs(p_traj))  delta_p:\n            return 2\n\n        # Rules 2-4: Analyze well-trapping vs. roaming\n        # Ignore points within the buffer zone |x| = delta_x\n        relevant_x_points = x_traj[np.abs(x_traj) > delta_x]\n        \n        if relevant_x_points.size == 0:\n            # Trajectory stayed entirely within the x buffer but didn't meet the 'stuck'\n            # momentum requirement. This is an edge case, but most consistent to classify\n            # as roaming, as it is neither definitively left nor right trapped.\n            return 0\n            \n        count_L = np.sum(relevant_x_points  0)\n        count_R = np.sum(relevant_x_points > 0)\n        count_total = relevant_x_points.size\n\n        f_L = count_L / count_total\n        f_R = count_R / count_total\n\n        if f_L > 0.95 and f_R  0.05:\n            return -1  # Left-well trapped\n        elif f_R > 0.95 and f_L  0.05:\n            return 1   # Right-well trapped\n        else:\n            return 0   # Roaming\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (-1.2, 0.0),\n        (1.2, 0.0),\n        (0.0, 1.0),\n        (0.0, 0.0),\n        (0.01, 0.0),\n        (-0.01, 0.0),\n        (0.01, 0.2),\n    ]\n\n    # Simulation parameters\n    dt = 1e-3\n    T = 200.0\n\n    results = []\n    for x0, p0 in test_cases:\n        x_trajectory, p_trajectory = run_simulation(x0, p0, dt, T)\n        classification = classify_trajectory(x_trajectory, p_trajectory)\n        results.append(classification)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# To generate the answer, one would run `solve()`\n# The expected output is [-1,1,0,2,1,-1,0]\n```", "answer": "[-1,1,0,2,1,-1,0]", "id": "3435429"}, {"introduction": "While many theoretical examples focus on isolated systems, most real-world molecular dynamics simulations involve coupling to a thermostat to maintain a constant temperature. This practice explores the dynamics generated by the Nosé-Hoover thermostat, a popular deterministic method for sampling the canonical ensemble. By analyzing the thermostatted motion of a simple harmonic oscillator [@problem_id:3435403], you will uncover the subtle but critical concept of non-ergodicity, demonstrating how regular, periodic trajectories can exist and trap the system, preventing it from exploring the full phase space as intended.", "problem": "Consider a single particle of unit mass in one spatial dimension moving in a harmonic potential and coupled to a Nosé–Hoover (NH) thermostat. In reduced units where the Boltzmann constant times temperature is set to $1$, and the harmonic oscillator frequency is $1$, the equations of motion for position $q$, momentum $p$, and thermostat variable $\\zeta$ are\n$$\n\\dot{q} = p,\\qquad \\dot{p} = -q - \\zeta\\,p,\\qquad \\dot{\\zeta} = \\frac{p^{2} - 1}{\\tau^{2}},\n$$\nwhere $\\tau  0$ is the thermostat relaxation time parameter. Let the invariant canonical density on the extended phase space be postulated in the form\n$$\n\\rho(q,p,\\zeta) = Z^{-1}\\,\\exp\\!\\left(-\\frac{q^{2}+p^{2}}{2}\\right)\\,\\exp\\!\\left(-\\frac{\\tau^{2}\\zeta^{2}}{2}\\right),\n$$\nwith normalization constant $Z \\in \\mathbb{R}_{0}$. Throughout, you may use the fundamental definitions of Newtonian dynamics, the Liouville continuity equation, and standard averaging arguments for systems with a clear separation of fast and slow variables.\n\n(a) Starting from the Liouville continuity equation for a stationary density, $\\nabla\\cdot(\\rho \\mathbf{v}) = 0$ with $\\mathbf{v}(q,p,\\zeta) = \\big(p,\\,-q-\\zeta p,\\,(p^{2}-1)/\\tau^{2}\\big)$, verify that the above $\\rho(q,p,\\zeta)$ is stationary under the NH flow.\n\n(b) Define the instantaneous oscillator energy $E = (q^{2}+p^{2})/2$. Show that\n$$\n\\dot{E} = -\\zeta\\,p^{2},\\qquad \\dot{\\zeta} = \\frac{p^{2}-1}{\\tau^{2}}.\n$$\nUsing the fact that for the harmonic oscillator the angle variable is fast compared to the slow variables $(E,\\zeta)$ when $\\tau$ is large, perform a cycle-average over the fast angle to obtain the averaged equations\n$$\n\\dot{E} = -\\zeta\\,E,\\qquad \\dot{\\zeta} = \\frac{E-1}{\\tau^{2}}.\n$$\nProve that the averaged system admits a smooth first integral $I(E,\\zeta)$ and derive one such integral explicitly. Conclude that the averaged dynamics possesses a family of closed orbits surrounding the point $(E,\\zeta)=(1,0)$, and explain briefly (without detailed proof) how standard averaging theorems imply the existence of nearby nontrivial periodic orbits of the full NH system for all sufficiently large $\\tau$.\n\n(c) Let $\\mathcal{S} \\subset \\mathbb{R}^{3}$ denote the set of all initial conditions $(q,p,\\zeta)$ whose trajectories under the full NH flow are periodic in time. Using only measure-theoretic reasoning based on absolute continuity of $\\rho$ with respect to the three-dimensional Lebesgue measure, determine the canonical probability of $\\mathcal{S}$ under $\\rho$, that is\n$$\n\\mu(\\mathcal{S}) = \\int_{\\mathcal{S}} \\rho(q,p,\\zeta)\\,dq\\,dp\\,d\\zeta.\n$$\nExpress your final answer as a pure number. No rounding is required.", "solution": "The problem is analyzed in three parts as requested.\n\n(a) Verification that the density $\\rho(q,p,\\zeta)$ is stationary.\n\nA density function $\\rho$ is stationary for a flow described by the velocity field $\\mathbf{v}$ if it satisfies the Liouville continuity equation for a steady state, $\\nabla \\cdot (\\rho \\mathbf{v}) = 0$. The phase space coordinates are $(q,p,\\zeta)$, and the velocity field is given by $\\mathbf{v} = (\\dot{q}, \\dot{p}, \\dot{\\zeta})$.\n\nThe given equations of motion are:\n$$\n\\dot{q} = p\n$$\n$$\n\\dot{p} = -q - \\zeta p\n$$\n$$\n\\dot{\\zeta} = \\frac{p^2 - 1}{\\tau^2}\n$$\nSo the velocity field in the extended phase space is $\\mathbf{v}(q,p,\\zeta) = \\left(p, -q - \\zeta p, \\frac{p^2 - 1}{\\tau^2}\\right)$.\n\nThe divergence of the vector field $(\\rho \\mathbf{v})$ is given by:\n$$\n\\nabla \\cdot (\\rho \\mathbf{v}) = \\frac{\\partial}{\\partial q}(\\rho \\dot{q}) + \\frac{\\partial}{\\partial p}(\\rho \\dot{p}) + \\frac{\\partial}{\\partial \\zeta}(\\rho \\dot{\\zeta})\n$$\nThe postulated stationary density is:\n$$\n\\rho(q,p,\\zeta) = Z^{-1}\\,\\exp\\left(-\\frac{q^{2}+p^{2}}{2}\\right)\\,\\exp\\left(-\\frac{\\tau^{2}\\zeta^{2}}{2}\\right)\n$$\nLet us compute the partial derivatives of $\\rho$ with respect to the phase space variables:\n$$\n\\frac{\\partial \\rho}{\\partial q} = -q \\rho\n$$\n$$\n\\frac{\\partial \\rho}{\\partial p} = -p \\rho\n$$\n$$\n\\frac{\\partial \\rho}{\\partial \\zeta} = -\\tau^2 \\zeta \\rho\n$$\nNow we compute each term in the divergence expression using the product rule:\n$$\n\\frac{\\partial}{\\partial q}(\\rho \\dot{q}) = \\frac{\\partial}{\\partial q}(\\rho p) = p \\frac{\\partial \\rho}{\\partial q} = p(-q \\rho) = -qp\\rho\n$$\n$$\n\\frac{\\partial}{\\partial p}(\\rho \\dot{p}) = \\frac{\\partial}{\\partial p}(\\rho(-q - \\zeta p)) = (-q - \\zeta p)\\frac{\\partial \\rho}{\\partial p} + \\rho \\frac{\\partial}{\\partial p}(-q - \\zeta p) = (-q - \\zeta p)(-p \\rho) + \\rho(-\\zeta) = (qp + \\zeta p^2 - \\zeta)\\rho\n$$\n$$\n\\frac{\\partial}{\\partial \\zeta}(\\rho \\dot{\\zeta}) = \\frac{\\partial}{\\partial \\zeta}\\left(\\rho \\frac{p^2 - 1}{\\tau^2}\\right) = \\left(\\frac{p^2 - 1}{\\tau^2}\\right) \\frac{\\partial \\rho}{\\partial \\zeta} = \\left(\\frac{p^2 - 1}{\\tau^2}\\right)(-\\tau^2 \\zeta \\rho) = -(p^2 - 1)\\zeta \\rho = (-\\zeta p^2 + \\zeta)\\rho\n$$\nSumming these three terms to find the divergence:\n$$\n\\nabla \\cdot (\\rho \\mathbf{v}) = (-qp)\\rho + (qp + \\zeta p^2 - \\zeta)\\rho + (-\\zeta p^2 + \\zeta)\\rho\n$$\n$$\n\\nabla \\cdot (\\rho \\mathbf{v}) = \\rho \\left( -qp + qp + \\zeta p^2 - \\zeta - \\zeta p^2 + \\zeta \\right)\n$$\n$$\n\\nabla \\cdot (\\rho \\mathbf{v}) = \\rho \\left( 0 \\right) = 0\n$$\nSince the divergence is zero, the density $\\rho(q,p,\\zeta)$ is indeed stationary under the Nosé–Hoover flow, as required.\n\n(b) Averaged dynamics and first integral.\n\nFirst, we find the time derivative of the instantaneous oscillator energy $E = \\frac{q^2+p^2}{2}$.\n$$\n\\dot{E} = \\frac{d}{dt}\\left(\\frac{q^2+p^2}{2}\\right) = q\\dot{q} + p\\dot{p}\n$$\nSubstituting the equations of motion $\\dot{q}=p$ and $\\dot{p}=-q-\\zeta p$:\n$$\n\\dot{E} = q(p) + p(-q - \\zeta p) = qp - qp - \\zeta p^2 = -\\zeta p^2\n$$\nThe equation for $\\dot{\\zeta}$ is given in the problem statement as $\\dot{\\zeta} = \\frac{p^2-1}{\\tau^2}$.\n\nNext, we perform a cycle-average over the fast motion of the harmonic oscillator, assuming $\\tau$ is large, which makes $(E,\\zeta)$ slow variables. For a fixed energy $E$, the oscillator traces a circle $q^2+p^2 = 2E$ in its own phase space. The average of a quantity $f(q,p)$ over one cycle of the harmonic oscillator is denoted by $\\langle f \\rangle$. Due to equipartition of energy for a harmonic oscillator, the average kinetic energy equals the average potential energy, $\\langle \\frac{1}{2}p^2 \\rangle = \\langle \\frac{1}{2}q^2 \\rangle = \\frac{1}{2}E$. From this, we directly have $\\langle p^2 \\rangle = E$.\n\nAveraging the equations for the slow variables $(\\dot{E}, \\dot{\\zeta})$, we treat $E$ and $\\zeta$ as constant over the fast cycle:\n$$\n\\langle \\dot{E} \\rangle \\approx \\dot{E}_{\\text{avg}} = \\langle -\\zeta p^2 \\rangle = -\\zeta \\langle p^2 \\rangle = -\\zeta E\n$$\n$$\n\\langle \\dot{\\zeta} \\rangle \\approx \\dot{\\zeta}_{\\text{avg}} = \\left\\langle \\frac{p^2-1}{\\tau^2} \\right\\rangle = \\frac{\\langle p^2 \\rangle - 1}{\\tau^2} = \\frac{E-1}{\\tau^2}\n$$\nThese are the averaged equations of motion. A first integral is a function $I(E,\\zeta)$ that is constant along the trajectories of this averaged system, meaning $\\frac{dI}{dt} = 0$. We can find one by considering the ratio of the derivatives:\n$$\n\\frac{dE}{d\\zeta} = \\frac{\\dot{E}}{\\dot{\\zeta}} = \\frac{-\\zeta E}{(E-1)/\\tau^2} = -\\frac{\\tau^2 \\zeta E}{E-1}\n$$\nThis is a separable differential equation. We rearrange and integrate:\n$$\n\\frac{E-1}{E} dE = -\\tau^2 \\zeta d\\zeta\n$$\n$$\n\\int \\left(1 - \\frac{1}{E}\\right) dE = \\int -\\tau^2 \\zeta d\\zeta\n$$\n$$\nE - \\ln(E) = -\\frac{\\tau^2 \\zeta^2}{2} + C\n$$\nwhere $C$ is a constant of integration. We can define a smooth first integral $I(E,\\zeta)$ as:\n$$\nI(E,\\zeta) = E - \\ln(E) + \\frac{\\tau^2\\zeta^2}{2}\n$$\nThe averaged system possesses a fixed point where $\\dot{E}=0$ and $\\dot{\\zeta}=0$. This occurs at $(E,\\zeta)=(1,0)$. The level sets of the first integral $I(E,\\zeta)$ define the trajectories in the $(E,\\zeta)$ plane. An analysis of the function $I(E,\\zeta)$ shows it has a global minimum at $(1,0)$. Therefore, the level sets $I(E,\\zeta) = \\text{constant}$ for values of the constant greater than $I(1,0)=1$ are closed curves (ovals) surrounding the fixed point. These closed curves represent periodic orbits of the averaged system.\nStandard averaging theorems assert that for a system with a separation of time scales (controlled by a large parameter like $\\tau$), the existence of a non-degenerate family of periodic orbits in the averaged system implies the existence of periodic orbits in the full, original system. These full-system periodic orbits are located near the corresponding surfaces (tori) traced by the fast variables as the slow variables evolve along the averaged periodic orbit. Thus, for sufficiently large $\\tau$, there exist nontrivial periodic orbits in the full NH system.\n\n(c) Canonical probability of the set of periodic orbits.\n\nLet $\\mathcal{S} \\subset \\mathbb{R}^3$ be the set of all initial conditions $(q,p,\\zeta)$ whose trajectories are periodic under the full Nosé-Hoover flow. We wish to find its measure $\\mu(\\mathcal{S})$. The measure $\\mu$ is defined by the density $\\rho(q,p,\\zeta)$ with respect to the standard three-dimensional Lebesgue measure $m_L = dq\\,dp\\,d\\zeta$:\n$$\n\\mu(\\mathcal{S}) = \\int_{\\mathcal{S}} \\rho(q,p,\\zeta)\\,dq\\,dp\\,d\\zeta\n$$\nThe existence of the density function $\\rho$, which is a well-behaved (smooth and strictly positive) function, implies that the measure $\\mu$ is absolutely continuous with respect to the Lebesgue measure $m_L$. By definition, if $\\mu$ is absolutely continuous with respect to $m_L$ (denoted $\\mu \\ll m_L$), then for any measurable set $A$, if $m_L(A)=0$, it must follow that $\\mu(A)=0$.\n\nThe problem now reduces to determining the Lebesgue measure of the set $\\mathcal{S}$. A trajectory is periodic if it returns to its starting point in finite time. The set $\\mathcal{S}$ is composed of all such points.\nIn a generic non-integrable dynamical system in $\\mathbb{R}^n$, the set of points belonging to periodic orbits is expected to have Lebesgue measure zero. A single periodic orbit is a closed curve, which is a one-dimensional manifold. A one-dimensional manifold has zero Lebesgue measure in a three-dimensional space. The set $\\mathcal{S}$ is the union of all such periodic orbits. While part (b) implies the existence of a family of such orbits, particularly for large $\\tau$, they are generally understood to form a \"skeleton\" of measure zero within a larger phase space volume occupied by chaotic or quasiperiodic trajectories. Even if there is an infinite number of such periodic orbits, they typically form a countable set of one-dimensional manifolds. A countable union of sets of measure zero is itself a set of measure zero.\nThere are exceptional systems where periodic orbits fill a region of positive measure, but the Nosé-Hoover oscillator is known to exhibit chaotic dynamics and is not such an exception. Therefore, it is a standard result from the theory of dynamical systems that the set $\\mathcal{S}$ has Lebesgue measure zero:\n$$\nm_L(\\mathcal{S}) = 0\n$$\nGiven that $\\mu \\ll m_L$ and $m_L(\\mathcal{S})=0$, we can directly conclude that the canonical probability of $\\mathcal{S}$ is zero.\n$$\n\\mu(\\mathcal{S}) = \\int_{\\mathcalS} \\rho(q,p,\\zeta)\\,dq\\,dp\\,d\\zeta = 0\n$$\nThe value of the integral of any integrable function (here $\\rho$) over a set of measure zero is zero. The final answer is a pure number, $0$.", "answer": "$$\\boxed{0}$$", "id": "3435403"}]}