{"hands_on_practices": [{"introduction": "Understanding when a system transitions from a stable equilibrium to self-sustained oscillations is a cornerstone of nonlinear dynamics. This transition, known as a Hopf bifurcation, is critical in many multiphysics systems where delays in feedback or transport are common. This exercise [@problem_id:3518527] provides hands-on practice with the essential analytical technique of linear stability analysis for delay differential equations (DDEs), guiding you to derive the precise conditions under which time delay induces oscillatory instability.", "problem": "Consider a single-degree-of-freedom delayed feedback oscillator arising in a multiphysics coupled simulation of an electrothermal microresonator with sensor-actuator latency. The governing law is the Delay Differential Equation (DDE)\n$$\n\\dot{x}(t) \\;=\\; \\mu\\,x(t) \\;-\\; \\beta\\,x(t-\\tau) \\;-\\; x^{3}(t),\n$$\nwhere $\\mu$ models instantaneous self-excitation due to a thermal-to-mechanical coupling pathway, $\\beta0$ quantifies stabilizing delayed feedback, and $\\tau0$ is the feedback delay. The cubic term $-x^{3}(t)$ models local saturation from multiphysics nonlinearities. The zero state $x^{\\ast}=0$ is an equilibrium for all parameters.\n\nStarting from first principles of linearization, exponential solutions to linear DDEs, and the definition of a Hopf bifurcation as the emergence of a pair of purely imaginary characteristic exponents crossing the imaginary axis with nonzero frequency, perform the following:\n\n- Linearize the system about $x^{\\ast}=0$ to obtain the linear DDE governing small perturbations.\n- Derive the characteristic equation for exponential perturbations of the form $x(t)\\sim \\exp(s t)$.\n- Impose the Hopf bifurcation condition $s=i\\omega$ with $\\omega\\neq 0$, and derive the conditions on $\\omega$ and $\\tau$ under which purely imaginary roots exist.\n- Under the assumptions $\\beta0$ and $|\\mu|\\beta$ (which ensure existence of such roots), determine the smallest positive delay $\\tau=\\tau_{c}$ that induces a Hopf bifurcation at $x^{\\ast}=0$.\n\nProvide your final answer as a single exact symbolic expression for $\\tau_{c}$ in terms of $\\mu$ and $\\beta$. Do not include units in the boxed final answer; no rounding is required.", "solution": "The problem provided is a well-posed problem in the field of nonlinear dynamics and bifurcation theory. It is scientifically grounded, self-contained, and asks for a standard derivation of a Hopf bifurcation condition for a delay differential equation. We can proceed with the solution.\n\nThe governing Delay Differential Equation (DDE) is given by:\n$$\n\\dot{x}(t) = \\mu\\,x(t) - \\beta\\,x(t-\\tau) - x^{3}(t)\n$$\nThe zero state $x^{\\ast}=0$ is an equilibrium point, as substituting $x(t) = 0$ for all $t$ yields $\\dot{x}(t)=0$.\n\n**Step 1: Linearization**\nTo analyze the stability of the equilibrium $x^{\\ast}=0$, we linearize the DDE around this point. Let $x(t) = x^{\\ast} + \\delta x(t) = \\delta x(t)$, where $\\delta x(t)$ is a small perturbation. Substituting this into the DDE:\n$$\n\\frac{d}{dt}(\\delta x(t)) = \\mu\\,\\delta x(t) - \\beta\\,\\delta x(t-\\tau) - (\\delta x(t))^{3}\n$$\nFor small perturbations, the cubic term $(\\delta x(t))^{3}$ is of higher order and can be neglected. This yields the linear DDE governing small perturbations:\n$$\n\\dot{\\delta x}(t) = \\mu\\,\\delta x(t) - \\beta\\,\\delta x(t-\\tau)\n$$\n\n**Step 2: Characteristic Equation**\nWe seek exponential solutions to the linear DDE of the form $\\delta x(t) = C e^{st}$, where $C$ is a constant and $s$ is a complex number representing the characteristic exponent (or eigenvalue). Substituting this ansatz into the linear DDE:\n$$\n\\frac{d}{dt}(C e^{st}) = \\mu\\,(C e^{st}) - \\beta\\,(C e^{s(t-\\tau)})\n$$\n$$\ns C e^{st} = \\mu\\,C e^{st} - \\beta\\,C e^{st} e^{-s\\tau}\n$$\nAssuming a non-trivial solution ($C \\neq 0$), we can divide the entire equation by $C e^{st}$ to obtain the characteristic equation for the system:\n$$\ns = \\mu - \\beta e^{-s\\tau}\n$$\n\n**Step 3: Hopf Bifurcation Condition**\nA Hopf bifurcation occurs when a pair of complex conjugate characteristic exponents crosses the imaginary axis with a non-zero speed. At the bifurcation point, the exponents are purely imaginary. We impose the condition $s = i\\omega$, where $\\omega \\in \\mathbb{R}$ and $\\omega \\neq 0$ is the Hopf frequency. Substituting $s = i\\omega$ into the characteristic equation:\n$$\ni\\omega = \\mu - \\beta e^{-i\\omega\\tau}\n$$\nUsing Euler's formula, $e^{-i\\omega\\tau} = \\cos(\\omega\\tau) - i\\sin(\\omega\\tau)$, we get:\n$$\ni\\omega = \\mu - \\beta (\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\n$$\ni\\omega = (\\mu - \\beta\\cos(\\omega\\tau)) + i(\\beta\\sin(\\omega\\tau))\n$$\nFor this equality to hold, the real and imaginary parts of both sides must be equal.\n\nEquating the real parts:\n$$\n0 = \\mu - \\beta\\cos(\\omega\\tau) \\implies \\cos(\\omega\\tau) = \\frac{\\mu}{\\beta}\n$$\n\nEquating the imaginary parts:\n$$\n\\omega = \\beta\\sin(\\omega\\tau) \\implies \\sin(\\omega\\tau) = \\frac{\\omega}{\\beta}\n$$\n\n**Step 4: Derivation of $\\tau_c$**\nWe now have a system of two equations for the unknowns $\\omega$ and $\\tau$. We can find the Hopf frequency $\\omega$ by using the fundamental trigonometric identity $\\sin^2(\\theta) + \\cos^2(\\theta) = 1$. Applying this to our equations with $\\theta = \\omega\\tau$:\n$$\n\\left(\\frac{\\omega}{\\beta}\\right)^{2} + \\left(\\frac{\\mu}{\\beta}\\right)^{2} = 1\n$$\n$$\n\\frac{\\omega^{2}}{\\beta^{2}} + \\frac{\\mu^{2}}{\\beta^{2}} = 1\n$$\n$$\n\\omega^{2} + \\mu^{2} = \\beta^{2}\n$$\nSolving for $\\omega^{2}$:\n$$\n\\omega^{2} = \\beta^{2} - \\mu^{2}\n$$\nFor a Hopf bifurcation to occur, we require a non-zero real frequency $\\omega$, which means $\\omega^{2} > 0$. This implies $\\beta^{2} > \\mu^{2}$, or $|\\beta| > |\\mu|$. Since $\\beta > 0$ is given, this condition becomes $\\beta > |\\mu|$, which is equivalent to the problem's assumption $|\\mu|  \\beta$. This assumption guarantees the existence of a purely oscillatory solution. We take the positive root for the frequency without loss of generality:\n$$\n\\omega = \\sqrt{\\beta^{2} - \\mu^{2}}\n$$\nNow we find the delay $\\tau$. We have the relations for $\\cos(\\omega\\tau)$ and $\\sin(\\omega\\tau)$. We can find the angle $\\omega\\tau$ from these two values. Specifically, from $\\sin(\\omega\\tau) = \\frac{\\omega}{\\beta} = \\frac{\\sqrt{\\beta^{2} - \\mu^{2}}}{\\beta}$, we see that $\\sin(\\omega\\tau) > 0$ because $\\beta>0$ and $\\omega>0$. This means the angle $\\omega\\tau$ must be in the interval $(0, \\pi)$ plus integer multiples of $2\\pi$.\nThe `arccos` function has a range of $[0, \\pi]$. Applying it to our cosine equation gives the principal value for the angle:\n$$\n\\omega\\tau = \\arccos\\left(\\frac{\\mu}{\\beta}\\right)\n$$\nThis choice is consistent with $\\sin(\\omega\\tau) > 0$, because for an argument $x \\in (-1, 1)$, $\\arccos(x) \\in (0, \\pi)$, and for any angle $\\theta \\in (0, \\pi)$, $\\sin(\\theta) > 0$.\nThe general solution for the delay is given by:\n$$\n\\omega\\tau_{k} = \\arccos\\left(\\frac{\\mu}{\\beta}\\right) + 2\\pi k, \\quad k \\in \\{0, 1, 2, \\dots\\}\n$$\n$$\n\\tau_{k} = \\frac{1}{\\omega}\\left(\\arccos\\left(\\frac{\\mu}{\\beta}\\right) + 2\\pi k\\right)\n$$\nWe are asked for the smallest positive delay, $\\tau_{c}$. This corresponds to $k=0$:\n$$\n\\tau_{c} = \\frac{1}{\\omega}\\arccos\\left(\\frac{\\mu}{\\beta}\\right)\n$$\nSince $|\\mu|\\beta$, the argument of the arccosine is in $(-1, 1)$, so $\\arccos(\\mu/\\beta) \\in (0, \\pi)$. As $\\omega > 0$, $\\tau_c$ is guaranteed to be positive.\nSubstituting the expression for $\\omega$:\n$$\n\\tau_{c} = \\frac{1}{\\sqrt{\\beta^{2} - \\mu^{2}}} \\arccos\\left(\\frac{\\mu}{\\beta}\\right)\n$$\nThis is the final expression for the smallest positive delay that induces a Hopf bifurcation at the origin.", "answer": "$$\n\\boxed{\\frac{\\arccos\\left(\\frac{\\mu}{\\beta}\\right)}{\\sqrt{\\beta^{2}-\\mu^{2}}}}\n$$", "id": "3518527"}, {"introduction": "While bifurcation analysis tells us when simple dynamics become unstable, it does not fully describe the complex, aperiodic behavior that can follow. The Lorenz system is a paradigmatic model of chaos, but visual inspection alone is not enough; we need a quantitative measure of this complexity. This computational exercise [@problem_id:3518460] walks you through the implementation of the standard algorithm to calculate the largest Lyapunov exponent, $\\lambda_{\\max}$, the definitive diagnostic for chaos, and use it to probe the robustness of chaotic regimes in parameter space.", "problem": "Consider the reduced-order model of buoyancy-driven convection that couples fluid momentum and thermal transport, popularly known as the Lorenz system. The system is described by the ordinary differential equations (ODEs)\n$$\n\\frac{dX}{dt}=\\sigma\\,(Y-X),\\qquad\n\\frac{dY}{dt}=X\\,(r-Z)-Y,\\qquad\n\\frac{dZ}{dt}=X\\,Y-b\\,Z,\n$$\nwhere $X$, $Y$, and $Z$ are state variables, and $\\sigma$, $r$, and $b$ are parameters representing, respectively, the Prandtl number, the normalized Rayleigh parameter, and a geometric or dissipative factor. In this problem, you will perform a sensitivity analysis of the onset and robustness of chaos with respect to the parameters $(\\sigma,r,b)$ using the derivatives of the largest Lyapunov exponent (LLE).\n\nThe largest Lyapunov exponent $\\lambda_{\\max}$ quantifies the average exponential rate of divergence of nearby trajectories. For a trajectory $x(t)=(X(t),Y(t),Z(t))$, the LLE is defined from the linearized (tangent) dynamics\n$$\n\\frac{d\\delta x}{dt}=J(x(t))\\,\\delta x,\n$$\nwhere $\\delta x$ is an infinitesimal perturbation and $J(x)$ is the Jacobian of the vector field $f(x)$ associated with the Lorenz ODEs. The Jacobian $J(x)$ is\n$$\nJ(x)=\n\\begin{bmatrix}\n-\\sigma  \\sigma  0 \\\\\nr-Z  -1  -X \\\\\nY  X  -b\n\\end{bmatrix}.\n$$\nThe largest Lyapunov exponent is given by\n$$\n\\lambda_{\\max}=\\lim_{T\\to\\infty}\\frac{1}{T}\\log\\left(\\frac{\\|\\delta x(T)\\|}{\\|\\delta x(0)\\|}\\right),\n$$\nwhere $\\|\\cdot\\|$ denotes the Euclidean norm. Numerically, this limit can be approximated by evolving the state $x(t)$ together with a tangent perturbation $\\delta x(t)$ and periodically renormalizing $\\delta x(t)$, accumulating the logarithm of its growth factor, and dividing by the total evolution time.\n\nYour tasks are:\n- Starting from the above ODEs and Jacobian, derive and implement a numerical procedure to estimate $\\lambda_{\\max}$ for given $(\\sigma,r,b)$. Use the following scientifically sound choices for numerical parameters: a fixed time step $\\Delta t$ satisfying $0  \\Delta t \\ll 1$, a transient integration time $T_{\\mathrm{trans}} > 0$ to allow trajectories to approach attracting sets, and an accumulation time $T_{\\mathrm{acc}} > 0$ to estimate $\\lambda_{\\max}$. Use deterministic initial conditions $X(0)=Y(0)=Z(0)=1$ and a unit-norm initial tangent vector. You must use explicit fourth-order Runge–Kutta integration for both the nonlinear system and the tangent linear system. At each time step, renormalize the tangent vector and accumulate the instantaneous logarithmic growth to estimate $\\lambda_{\\max}$ as the accumulated sum divided by the total accumulation time.\n- Estimate the partial derivatives $\\partial \\lambda_{\\max}/\\partial \\sigma$, $\\partial \\lambda_{\\max}/\\partial r$, and $\\partial \\lambda_{\\max}/\\partial b$ using second-order central finite differences with small parameter increments $h_\\sigma$, $h_r$, and $h_b$, respectively. For example,\n$$\n\\frac{\\partial \\lambda_{\\max}}{\\partial \\sigma}\\approx \\frac{\\lambda_{\\max}(\\sigma+h_\\sigma,r,b)-\\lambda_{\\max}(\\sigma-h_\\sigma,r,b)}{2h_\\sigma},\n$$\nwith analogous formulas for $r$ and $b$.\n- Interpret robustness of chaotic regimes quantitatively as follows: declare a parameter set $(\\sigma,r,b)$ to exhibit robust chaos if and only if $\\lambda_{\\max}(\\sigma,r,b) > 0$ and $\\lambda_{\\max}$ remains strictly positive under all single-parameter perturbations $\\sigma\\mapsto \\sigma\\pm h_\\sigma$, $r\\mapsto r\\pm h_r$, and $b\\mapsto b\\pm h_b$. Otherwise, declare it non-robust.\n\nYour program must implement the above procedure with the following fixed numerical choices:\n- Use $\\Delta t=0.01$, $T_{\\mathrm{trans}}=15.0$, and $T_{\\mathrm{acc}}=60.0$.\n- Use the explicit fourth-order Runge–Kutta scheme for both the nonlinear ODE and the tangent linear ODE, evaluating the Jacobian $J$ at the appropriate stage states of the Runge–Kutta method.\n- Initialize the tangent vector as $\\delta x(0)=(1,1,1)/\\sqrt{3}$ before the accumulation phase.\n- Compute and return $\\lambda_{\\max}$ and its parameter sensitivities rounded to six decimal places.\n\nTest Suite:\nEvaluate the following five parameter sets and their corresponding finite-difference increments. Each test case is a tuple $(\\sigma,r,b,h_\\sigma,h_r,h_b)$:\n- Case $1$: $(10,\\,28,\\,8/3,\\,0.2,\\,0.2,\\,0.1)$,\n- Case $2$: $(10,\\,20,\\,8/3,\\,0.2,\\,0.2,\\,0.1)$,\n- Case $3$: $(10,\\,24.5,\\,8/3,\\,0.2,\\,0.2,\\,0.1)$,\n- Case $4$: $(10,\\,99.65,\\,8/3,\\,0.5,\\,0.5,\\,0.2)$,\n- Case $5$: $(10,\\,28,\\,2.0,\\,0.2,\\,0.2,\\,0.1)$.\n\nRequired final output format:\n- For each test case, produce a list $[\\lambda_{\\max},\\partial \\lambda_{\\max}/\\partial \\sigma,\\partial \\lambda_{\\max}/\\partial r,\\partial \\lambda_{\\max}/\\partial b,\\mathrm{robust}]$ where $\\lambda_{\\max}$ and all partial derivatives are floats rounded to six decimals, and $\\mathrm{robust}$ is a boolean indicating robust chaos as defined above.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets; that is, a list of five such lists corresponding to the five test cases. For example, the output should look like\n$$\n[\\,[\\lambda_1,\\partial_\\sigma \\lambda_1,\\partial_r \\lambda_1,\\partial_b \\lambda_1,\\mathrm{robust}_1],\\dots,[\\lambda_5,\\partial_\\sigma \\lambda_5,\\partial_r \\lambda_5,\\partial_b \\lambda_5,\\mathrm{robust}_5]\\,].\n$$\nNo physical units are required in this problem. Angles do not appear and therefore have no specified units. Percentages are not used; all answers must be given as floats or booleans as specified.", "solution": "The problem is valid as it is scientifically grounded in the well-established theory of nonlinear dynamics, specifically the analysis of the Lorenz system. It is well-posed, with all necessary parameters, initial conditions, and numerical methods clearly specified. The tasks are computationally feasible and constitute a standard exercise in computational physics and chaos theory.\n\nThe solution is implemented by following a multi-step procedure for each given parameter set $(\\sigma, r, b)$ and its corresponding perturbation magnitudes $(h_\\sigma, h_r, h_b)$.\n\nFirst, we design a core function to compute the largest Lyapunov exponent (LLE), $\\lambda_{\\max}$, for a given set of parameters $(\\sigma, r, b)$. This function encapsulates the numerical integration of the Lorenz system and its associated tangent dynamics. The procedure is as follows:\n\n1.  **Transient Integration**: The Lorenz system, given by the ordinary differential equations (ODEs),\n    $$\n    \\frac{dX}{dt}=\\sigma(Y-X),\\quad \\frac{dY}{dt}=X(r-Z)-Y,\\quad \\frac{dZ}{dt}=XY-bZ,\n    $$\n    is integrated for a duration of $T_{\\mathrm{trans}} = 15.0$ starting from the initial condition $x(0) = (X(0), Y(0), Z(0)) = (1, 1, 1)$. This allows the system's trajectory to settle onto its attractor, discarding any initial transient behavior. The integration is performed using the explicit fourth-order Runge-Kutta (RK4) method with a time step of $\\Delta t = 0.01$.\n\n2.  **LLE Accumulation**: Following the transient phase, the LLE is estimated over an accumulation period of $T_{\\mathrm{acc}} = 60.0$. This involves simultaneously integrating the nonlinear state vector $x(t) = (X(t), Y(t), Z(t))$ and an infinitesimal tangent vector $\\delta x(t)$. The evolution of the tangent vector is governed by the linearized dynamics:\n    $$\n    \\frac{d(\\delta x)}{dt} = J(x(t)) \\delta x(t),\n    $$\n    where $J(x)$ is the Jacobian matrix of the Lorenz system's vector field:\n    $$\n    J(x) = \\begin{bmatrix} -\\sigma  \\sigma  0 \\\\ r-Z  -1  -X \\\\ Y  X  -b \\end{bmatrix}.\n    $$\n    The tangent vector is initialized to a unit-norm vector $\\delta x = (1, 1, 1) / \\sqrt{3}$ at the beginning of the accumulation phase.\n\n3.  **Coupled RK4 Integration and Renormalization**: The coupled system of ODEs for $(x, \\delta x)$ is advanced step-by-step using an RK4 scheme. For a single step from time $t_n$ to $t_{n+1} = t_n + \\Delta t$, we treat the state and tangent vectors as an augmented state vector $y = (x, \\delta x)$. The RK4 method is applied to the augmented system $\\dot{y} = (f(x), J(x)\\delta x)$. At each stage of the RK4 integrator, the Jacobian $J$ is evaluated at the corresponding intermediate state of $x$. After each full time step $\\Delta t$, the evolved tangent vector $\\delta \\tilde{x}_{n+1}$ will have grown or shrunk. We calculate its Euclidean norm, $\\|\\delta \\tilde{x}_{n+1}\\|$, and accumulate the natural logarithm of this norm: $\\sum \\log(\\|\\delta \\tilde{x}_{n+1}\\|)$. The tangent vector is then renormalized to a unit vector, $\\delta x_{n+1} = \\delta \\tilde{x}_{n+1} / \\|\\delta \\tilde{x}_{n+1}\\|$, before the next step. This Gram-Schmidt procedure prevents the tangent vector from growing infinitely or shrinking to zero, ensuring numerical stability while capturing its exponential growth rate.\n\n4.  **Final LLE Calculation**: After $N_{\\mathrm{acc}} = T_{\\mathrm{acc}}/\\Delta t$ steps, the LLE is calculated as the time-average of the accumulated logarithmic growth rates:\n    $$\n    \\lambda_{\\max} \\approx \\frac{1}{T_{\\mathrm{acc}}} \\sum_{i=0}^{N_{\\mathrm{acc}}-1} \\log(\\|\\delta \\tilde{x}_{i+1}\\|).\n    $$\n\nSecond, with the ability to compute $\\lambda_{\\max}$ for any parameter set, we perform the sensitivity and robustness analysis for each test case.\nFor a central parameter set $(\\sigma_0, r_0, b_0)$ and increments $(h_\\sigma, h_r, h_b)$:\n\n1.  **Sensitivity Analysis**: The partial derivatives of the LLE with respect to each parameter are estimated using a second-order central finite difference scheme. For example, the sensitivity to $\\sigma$ is:\n    $$\n    \\frac{\\partial \\lambda_{\\max}}{\\partial \\sigma} \\approx \\frac{\\lambda_{\\max}(\\sigma_0+h_\\sigma, r_0, b_0) - \\lambda_{\\max}(\\sigma_0-h_\\sigma, r_0, b_0)}{2h_\\sigma}.\n    $$\n    Analogous formulas are used for $\\partial \\lambda_{\\max}/\\partial r$ and $\\partial \\lambda_{\\max}/\\partial b$. This requires computing $\\lambda_{\\max}$ a total of seven times for each test case: one at the central parameters, and two for each of the three parameters being perturbed.\n\n2.  **Robustness Analysis**: A parameter set is declared to exhibit \"robust chaos\" if and only if the LLE is strictly positive at the central parameter values and remains strictly positive for all six single-parameter perturbations ($\\sigma_0 \\pm h_\\sigma$, $r_0 \\pm h_r$, $b_0 \\pm h_b$). This requires checking that all seven calculated LLE values are greater than zero.\n\nFinally, the computed values for $\\lambda_{\\max}$, its three partial derivatives, and the boolean robustness flag are collected for each test case. The floating-point numbers are rounded to six decimal places, and the results for all test cases are formatted into a single-line list of lists as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem as specified.\n    It iterates through test cases, calculates the largest Lyapunov exponent (LLE),\n    its sensitivities, and chaos robustness, then prints the formatted results.\n    \"\"\"\n    \n    # Numerical parameters specified in the problem statement\n    DT = 0.01\n    T_TRANS = 15.0\n    T_ACC = 60.0\n    N_TRANS = int(T_TRANS / DT)\n    N_ACC = int(T_ACC / DT)\n    X0 = np.array([1.0, 1.0, 1.0])\n\n    def lorenz_f(x, sigma, r, b):\n        \"\"\"Computes the vector field of the Lorenz system.\"\"\"\n        X, Y, Z = x\n        dX_dt = sigma * (Y - X)\n        dY_dt = X * (r - Z) - Y\n        dZ_dt = X * Y - b * Z\n        return np.array([dX_dt, dY_dt, dZ_dt])\n\n    def lorenz_J(x, sigma, r, b):\n        \"\"\"Computes the Jacobian matrix of the Lorenz system.\"\"\"\n        X, Y, Z = x\n        return np.array([\n            [-sigma, sigma, 0.0],\n            [r - Z, -1.0, -X],\n            [Y, X, -b]\n        ])\n\n    def calculate_lle(sigma, r, b):\n        \"\"\"\n        Calculates the largest Lyapunov exponent for the Lorenz system with given parameters.\n        \"\"\"\n        x = np.copy(X0)\n        \n        # Transient phase to let the trajectory settle on the attractor\n        for _ in range(N_TRANS):\n            k1_x = lorenz_f(x, sigma, r, b)\n            k2_x = lorenz_f(x + 0.5 * DT * k1_x, sigma, r, b)\n            k3_x = lorenz_f(x + 0.5 * DT * k2_x, sigma, r, b)\n            k4_x = lorenz_f(x + DT * k3_x, sigma, r, b)\n            x += (DT / 6.0) * (k1_x + 2*k2_x + 2*k3_x + k4_x)\n\n        # Accumulation phase for LLE calculation\n        dx = np.array([1.0, 1.0, 1.0]) / np.sqrt(3.0)\n        log_growth_sum = 0.0\n\n        for _ in range(N_ACC):\n            # RK4 for the augmented system (state x and tangent vector dx)\n            # Stage 1\n            k1_x = lorenz_f(x, sigma, r, b)\n            k1_dx = lorenz_J(x, sigma, r, b) @ dx\n            \n            # Stage 2\n            x_s2 = x + 0.5 * DT * k1_x\n            dx_s2 = dx + 0.5 * DT * k1_dx\n            k2_x = lorenz_f(x_s2, sigma, r, b)\n            k2_dx = lorenz_J(x_s2, sigma, r, b) @ dx_s2\n\n            # Stage 3\n            x_s3 = x + 0.5 * DT * k2_x\n            dx_s3 = dx + 0.5 * DT * k2_dx\n            k3_x = lorenz_f(x_s3, sigma, r, b)\n            k3_dx = lorenz_J(x_s3, sigma, r, b) @ dx_s3\n\n            # Stage 4\n            x_s4 = x + DT * k3_x\n            dx_s4 = dx + DT * k3_dx\n            k4_x = lorenz_f(x_s4, sigma, r, b)\n            k4_dx = lorenz_J(x_s4, sigma, r, b) @ dx_s4\n            \n            # Update state and evolved tangent vector\n            x = x + (DT / 6.0) * (k1_x + 2*k2_x + 2*k3_x + k4_x)\n            dx_tilde = dx + (DT / 6.0) * (k1_dx + 2*k2_dx + 2*k3_dx + k4_dx)\n            \n            # Renormalize tangent vector and accumulate log growth\n            norm = np.linalg.norm(dx_tilde)\n            if norm > 1e-15: # Avoid log(0)\n                log_growth_sum += np.log(norm)\n                dx = dx_tilde / norm\n            else: # Perturbation vanished, LLE is effectively -inf\n                return -np.inf\n        \n        return log_growth_sum / T_ACC\n\n    test_cases = [\n        (10.0, 28.0, 8.0/3.0, 0.2, 0.2, 0.1),\n        (10.0, 20.0, 8.0/3.0, 0.2, 0.2, 0.1),\n        (10.0, 24.5, 8.0/3.0, 0.2, 0.2, 0.1),\n        (10.0, 99.65, 8.0/3.0, 0.5, 0.5, 0.2),\n        (10.0, 28.0, 2.0, 0.2, 0.2, 0.1),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        sigma, r, b, h_sigma, h_r, h_b = case\n\n        # Calculate LLE for central and perturbed parameters\n        lles = {\n            'center': calculate_lle(sigma, r, b),\n            'sigma_p': calculate_lle(sigma + h_sigma, r, b),\n            'sigma_m': calculate_lle(sigma - h_sigma, r, b),\n            'r_p': calculate_lle(sigma, r + h_r, b),\n            'r_m': calculate_lle(sigma, r - h_r, b),\n            'b_p': calculate_lle(sigma, r, b + h_b),\n            'b_m': calculate_lle(sigma, r, b - h_b),\n        }\n\n        # Calculate sensitivities using central finite differences\n        d_lambda_d_sigma = (lles['sigma_p'] - lles['sigma_m']) / (2.0 * h_sigma)\n        d_lambda_d_r = (lles['r_p'] - lles['r_m']) / (2.0 * h_r)\n        d_lambda_d_b = (lles['b_p'] - lles['b_m']) / (2.0 * h_b)\n\n        # Determine robustness based on the problem's definition\n        is_robust = all(val > 0 for val in lles.values())\n        \n        case_result = [\n            round(lles['center'], 6),\n            round(d_lambda_d_sigma, 6),\n            round(d_lambda_d_r, 6),\n            round(d_lambda_d_b, 6),\n            is_robust\n        ]\n        all_results.append(case_result)\n\n    # Format the final output string exactly as required\n    result_strings = []\n    for res in all_results:\n        res_str = f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]}]\"\n        result_strings.append(res_str)\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "3518460"}, {"introduction": "No real-world system is truly deterministic; noise is an ever-present factor that can dramatically alter dynamics. This practice problem [@problem_id:3518525] builds upon the concept of the Hopf bifurcation by introducing stochastic forcing to a classic oscillator. You will use the powerful method of stochastic averaging to derive a Fokker–Planck equation for the oscillation's amplitude, revealing how noise blurs the sharp deterministic bifurcation into a smooth transition and allowing you to predict the system's most probable state.", "problem": "A thermoacoustic one-mode surrogate oscillator coupled to a fluctuating flow can be reduced, after nondimensionalization, to a stochastic van der Pol oscillator\n$$\\ddot{q} - \\epsilon \\left(1 - q^{2}\\right)\\dot{q} + q = \\sqrt{2 D}\\,\\xi(t),$$\nwhere $q(t)$ is the generalized coordinate, $\\epsilon$ is the small nonlinearity parameter controlling the onset of self-excited oscillations, $D$ is the (dimensionless) noise intensity associated with broadband flow fluctuations, and $\\xi(t)$ is a standard Gaussian white noise with zero mean and autocorrelation $\\langle \\xi(t)\\,\\xi(t') \\rangle = \\delta(t - t')$. The Hopf point of the underlying deterministic system occurs at $\\epsilon = 0$. In multiphysics coupled simulations of thermoacoustics or electromechanical oscillators, such a reduced model captures the emergence of limit-cycle oscillations and their noise-driven modulation.\n\nStarting only from the fundamental second-order dynamics above, conservation-law definitions (mechanical energy of the underlying linear oscillator), and first principles of stochastic calculus in the Itô sense, perform a leading-order stochastic averaging analysis near the Hopf point for small positive $\\epsilon$ and small $D$. In particular:\n- Introduce a slowly varying oscillation amplitude $r(t)$ and a fast phase $\\theta(t)$ through a near-harmonic representation of the oscillator, and derive the one-dimensional stationary Fokker–Planck equation (Fokker–Planck equation (FPE)) for the probability density of the amplitude $p(r)$ by averaging over the fast phase to leading order in $\\epsilon$ and $D$.\n- From the stationary $p(r)$, determine the most probable oscillation amplitude $r_{\\mathrm{mode}}(\\epsilon, D)$ by maximizing $p(r)$ with respect to $r$.\n\nProvide, as your final answer, a single closed-form analytic expression for $r_{\\mathrm{mode}}(\\epsilon, D)$ valid for $r \\ge 0$ in the supercritical regime $\\epsilon > 0$. Do not round; no numerical approximation is required. Express the amplitude in the same nondimensional units as $q$.", "solution": "The problem statement is to find the most probable oscillation amplitude, $r_{\\mathrm{mode}}$, for a stochastic van der Pol oscillator by performing a leading-order stochastic averaging analysis. The system dynamics are given by the Itô stochastic differential equation (SDE):\n$$ \\ddot{q} - \\epsilon \\left(1 - q^{2}\\right)\\dot{q} + q = \\sqrt{2 D}\\,\\xi(t) $$\nwhere $\\xi(t)$ is a standard Gaussian white noise. This can be written as a system of first-order SDEs. Let $x_1 = q$ and $x_2 = \\dot{q}$. The system is:\n$$\n\\begin{cases}\ndx_1 = x_2 dt \\\\\ndx_2 = \\left[ \\epsilon \\left(1 - x_1^2\\right) x_2 - x_1 \\right] dt + \\sqrt{2D} dW_t\n\\end{cases}\n$$\nwhere $dW_t = \\xi(t)dt$ represents the increment of a Wiener process.\n\nThe problem suggests using conservation-law definitions related to the underlying linear oscillator. The mechanical energy of the linear oscillator $\\ddot{q} + q = 0$ is given by $E = \\frac{1}{2}(\\dot{q}^2 + q^2)$, which is $E = \\frac{1}{2}(x_2^2 + x_1^2)$. For the full nonlinear, stochastic oscillator, this energy is no longer conserved. We derive the SDE for $E(t) = \\frac{1}{2}(x_1^2 + x_2^2)$ using Itô's lemma for a function $f(x_1, x_2)$:\n$$ dE = \\frac{\\partial E}{\\partial x_1} dx_1 + \\frac{\\partial E}{\\partial x_2} dx_2 + \\frac{1}{2} \\left( \\frac{\\partial^2 E}{\\partial x_1^2} (dx_1)^2 + \\frac{\\partial^2 E}{\\partial x_2^2} (dx_2)^2 + 2 \\frac{\\partial^2 E}{\\partial x_1 \\partial x_2} dx_1 dx_2 \\right) $$\nThe partial derivatives are $\\frac{\\partial E}{\\partial x_1} = x_1$, $\\frac{\\partial E}{\\partial x_2} = x_2$, $\\frac{\\partial^2 E}{\\partial x_1^2} = 1$, $\\frac{\\partial^2 E}{\\partial x_2^2} = 1$, and $\\frac{\\partial^2 E}{\\partial x_1 \\partial x_2} = 0$. The quadratic variations (Itô products) are $(dx_1)^2 = (x_2 dt)^2 = 0$, $(dx_2)^2 = (\\sqrt{2D} dW_t)^2 = 2D dt$, and $dx_1 dx_2 = 0$. Substituting these into Itô's lemma:\n$$ dE = x_1 (x_2 dt) + x_2 \\left( \\left[ \\epsilon(1-x_1^2)x_2 - x_1 \\right] dt + \\sqrt{2D}dW_t \\right) + \\frac{1}{2}(1 \\cdot (2D dt)) $$\n$$ dE = \\left( x_1 x_2 + \\epsilon(1-x_1^2)x_2^2 - x_1 x_2 + D \\right) dt + x_2 \\sqrt{2D} dW_t $$\n$$ dE = \\left( \\epsilon(1-x_1^2)x_2^2 + D \\right) dt + \\sqrt{2D} x_2 dW_t $$\nThis is the exact SDE for the energy $E(t)$. For stochastic averaging, we introduce the near-harmonic representation $x_1 = q = r \\cos\\theta$ and $x_2 = \\dot{q} = -r \\sin\\theta$, where $\\theta \\approx t$ for the fast phase. The energy is $E = \\frac{1}{2}(q^2 + \\dot{q}^2) = \\frac{1}{2}r^2$. We substitute the polar representation into the SDE for $E$:\n$$ dE = \\left( \\epsilon(1-2E\\cos^2\\theta)(2E\\sin^2\\theta) + D \\right) dt - \\sqrt{4ED}\\sin\\theta dW_t $$\nWe now average this equation over one period of the fast oscillation, $T=2\\pi$. The drift and diffusion coefficients of the averaged SDE for $E$ are obtained by averaging over $\\theta$.\nThe averaged drift is:\n$$ A(E) = \\langle \\epsilon(1-2E\\cos^2\\theta)(2E\\sin^2\\theta) + D \\rangle_\\theta $$\n$$ A(E) = 2\\epsilon E \\langle \\sin^2\\theta \\rangle_\\theta - 4\\epsilon E^2 \\langle \\cos^2\\theta \\sin^2\\theta \\rangle_\\theta + D $$\nUsing the standard averages $\\langle \\sin^2\\theta \\rangle_\\theta = \\frac{1}{2}$ and $\\langle \\cos^2\\theta \\sin^2\\theta \\rangle_\\theta = \\frac{1}{8}$:\n$$ A(E) = 2\\epsilon E \\left(\\frac{1}{2}\\right) - 4\\epsilon E^2 \\left(\\frac{1}{8}\\right) + D = \\epsilon E - \\frac{\\epsilon E^2}{2} + D $$\nThe squared diffusion coefficient is obtained by averaging the square of the noise multiplier:\n$$ B(E) = \\langle (\\sqrt{4ED}\\sin\\theta)^2 \\rangle_\\theta = \\langle 4ED \\sin^2\\theta \\rangle_\\theta = 4ED \\langle \\sin^2\\theta \\rangle_\\theta = 4ED\\left(\\frac{1}{2}\\right) = 2ED $$\nThe averaged Itô SDE for the energy is:\n$$ dE = \\left( \\epsilon E - \\frac{\\epsilon E^2}{2} + D \\right) dt + \\sqrt{2ED} dW_t $$\nThe stationary Fokker-Planck equation for the probability density $p(E)$ is given by $\\frac{\\partial J(E)}{\\partial E} = 0$, where $J(E)$ is the probability flux. With a reflecting boundary at $E=0$ and a natural boundary at $E \\to \\infty$, the flux must be zero everywhere: $J(E)=0$.\n$$ J(E) = A(E)p(E) - \\frac{1}{2}\\frac{d}{dE}[B(E)p(E)] = 0 $$\n$$ \\left( \\epsilon E - \\frac{\\epsilon E^2}{2} + D \\right) p(E) = \\frac{1}{2}\\frac{d}{dE}[2ED p(E)] = \\frac{d}{dE}[ED p(E)] $$\n$$ \\left( \\epsilon E - \\frac{\\epsilon E^2}{2} + D \\right) p(E) = D p(E) + ED \\frac{dp(E)}{dE} $$\n$$ \\left( \\epsilon E - \\frac{\\epsilon E^2}{2} \\right) p(E) = ED \\frac{dp(E)}{dE} $$\nWe can separate variables to solve for $p(E)$:\n$$ \\frac{dp}{p} = \\frac{\\epsilon E - \\frac{\\epsilon E^2}{2}}{ED} dE = \\left( \\frac{\\epsilon}{D} - \\frac{\\epsilon E}{2D} \\right) dE $$\nIntegrating both sides gives:\n$$ \\ln p(E) = \\int \\left( \\frac{\\epsilon}{D} - \\frac{\\epsilon E}{2D} \\right) dE = \\frac{\\epsilon E}{D} - \\frac{\\epsilon E^2}{4D} + C' $$\nSo, the probability density for energy is $p(E) = C \\exp\\left( \\frac{\\epsilon}{D} \\left(E - \\frac{E^2}{4}\\right) \\right)$.\n\nWe are interested in the distribution of the amplitude $r$. The relationship is $E = \\frac{r^2}{2}$, so $dE = r dr$. Probability conservation implies $p(r)dr = p(E)dE$. Thus, the probability density for the amplitude is:\n$$ p(r) = p(E(r)) \\frac{dE}{dr} = C \\exp\\left( \\frac{\\epsilon}{D} \\left(\\frac{r^2}{2} - \\frac{(r^2/2)^2}{4}\\right) \\right) \\cdot r $$\n$$ p(r) = C r \\exp\\left( \\frac{\\epsilon}{D} \\left(\\frac{r^2}{2} - \\frac{r^4}{16}\\right) \\right) $$\nTo find the most probable amplitude $r_{\\mathrm{mode}}$, we maximize $p(r)$ by solving $\\frac{dp(r)}{dr}=0$ for $r > 0$. It is equivalent and simpler to maximize $\\ln p(r)$:\n$$ \\frac{d}{dr} \\ln p(r) = \\frac{d}{dr} \\left( \\ln C + \\ln r + \\frac{\\epsilon}{D} \\left(\\frac{r^2}{2} - \\frac{r^4}{16}\\right) \\right) = 0 $$\n$$ \\frac{1}{r} + \\frac{\\epsilon}{D} \\left(r - \\frac{4r^3}{16}\\right) = 0 $$\n$$ \\frac{1}{r} + \\frac{\\epsilon}{D} \\left(r - \\frac{r^3}{4}\\right) = 0 $$\nFor $r > 0$, we multiply by $4Dr$:\n$$ 4D + 4\\epsilon r^2 - \\epsilon r^4 = 0 $$\n$$ \\epsilon r^4 - 4\\epsilon r^2 - 4D = 0 $$\nThis is a quadratic equation for $y = r^2$. Using the quadratic formula:\n$$ y = \\frac{-(-4\\epsilon) \\pm \\sqrt{(-4\\epsilon)^2 - 4(\\epsilon)(-4D)}}{2\\epsilon} = \\frac{4\\epsilon \\pm \\sqrt{16\\epsilon^2 + 16\\epsilon D}}{2\\epsilon} $$\n$$ y = \\frac{4\\epsilon \\pm 4\\sqrt{\\epsilon^2 + \\epsilon D}}{2\\epsilon} = 2 \\pm 2\\sqrt{1 + \\frac{D}{\\epsilon}} $$\nSince $r^2$ must be positive and $\\epsilon > 0$, $D > 0$, the term $\\sqrt{1+D/\\epsilon} > 1$, which makes the solution $2 - 2\\sqrt{1+D/\\epsilon}$ negative. We must take the positive root:\n$$ r_{\\mathrm{mode}}^2 = 2 + 2\\sqrt{1 + \\frac{D}{\\epsilon}} $$\nThe most probable amplitude is the square root of this expression:\n$$ r_{\\mathrm{mode}} = \\sqrt{2 + 2\\sqrt{1 + \\frac{D}{\\epsilon}}} $$", "answer": "$$\\boxed{\\sqrt{2 + 2\\sqrt{1 + \\frac{D}{\\epsilon}}}}$$", "id": "3518525"}]}