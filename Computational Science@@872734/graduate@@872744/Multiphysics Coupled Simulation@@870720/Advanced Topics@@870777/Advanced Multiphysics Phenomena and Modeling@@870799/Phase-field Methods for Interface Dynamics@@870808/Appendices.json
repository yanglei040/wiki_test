{"hands_on_practices": [{"introduction": "Before simulating complex dynamics, it is essential to understand the static properties of the interface predicted by the model. This foundational exercise connects the abstract parameters of the Ginzburg-Landau free energy functional, namely the gradient energy coefficient $\\kappa$ and the bulk energy scale $\\lambda$, to the physically meaningful quantity of surface tension, $\\sigma$. By applying the calculus of variations to find the equilibrium interface profile, you will derive a crucial relationship that is fundamental to calibrating phase-field models against experimental data [@problem_id:3521619].", "problem": "Consider a one-dimensional, planar equilibrium interface in a binary system modeled by a phase-field order parameter $\\,\\phi(x)\\,$ with $\\,\\phi(-\\infty)=-1\\,$ and $\\,\\phi(+\\infty)=+1\\,$. The Helmholtz free-energy functional per unit area is taken to be\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; \\lambda\\,W(\\phi) \\right]\\,dx,\n$$\nwhere $\\,\\kappa0\\,$ is the gradient-energy coefficient, $\\,\\lambda0\\,$ is the bulk energy scale, and the double-well potential is\n$$\nW(\\phi) \\;=\\; \\frac{1}{4}\\left(\\phi^{2}-1\\right)^{2}.\n$$\nAssume the system is at mechanical equilibrium and that the interface is stationary and planar, such that the equilibrium profile $\\,\\phi(x)\\,$ minimizes $\\,\\mathcal{F}\\,$ subject to the boundary conditions. The surface tension $\\,\\sigma\\,$ is defined as the excess free energy per unit area associated with the interface, given by\n$$\n\\sigma \\;=\\; \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; \\lambda\\,W(\\phi) \\right]\\,dx,\n$$\nwith the homogeneous bulk contributions subtracted implicitly because $\\,W(\\pm 1)=0\\,$.\n\nStarting from fundamental variational principles and conservation of energy in the one-dimensional stationary profile, derive the necessary relation(s) for the equilibrium profile $\\,\\phi(x)\\,$ and compute $\\,\\sigma\\,$ in closed form as an analytical expression in terms of $\\,\\kappa\\,$ and $\\,\\lambda\\,$. Then explain how this value compares to the corresponding sharp-interface surface tension obtained by taking the limit of vanishing interface thickness while retaining the same bulk thermodynamics.\n\nProvide your final answer for $\\,\\sigma\\,$ as a single, simplified analytical expression in terms of $\\,\\kappa\\,$ and $\\,\\lambda\\,$. No rounding is required. Do not include units in your final boxed answer.", "solution": "The problem asks for the derivation of the equilibrium profile equation for a one-dimensional phase-field model and the calculation of the corresponding surface tension $\\sigma$. The problem statement is validated as scientifically grounded, well-posed, and objective. It represents a canonical problem in the theory of diffuse interfaces.\n\nThe Helmholtz free-energy functional per unit area is given by\n$$\n\\mathcal{F}[\\phi] = \\int_{-\\infty}^{+\\infty} \\mathcal{L}(\\phi, \\phi') \\,dx = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\lambda\\,W(\\phi) \\right]\\,dx\n$$\nwhere $\\phi' = \\frac{d\\phi}{dx}$ and the double-well potential is $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$. The parameters $\\kappa$ and $\\lambda$ are positive constants. The boundary conditions are $\\phi(x \\to -\\infty) = -1$ and $\\phi(x \\to +\\infty) = +1$.\n\nThe equilibrium profile $\\phi(x)$ is the function that minimizes this functional. According to the calculus of variations, the minimizer must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} - \\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\phi'}\\right) = 0\n$$\nFirst, we compute the required partial derivatives of the integrand $\\mathcal{L}(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^2 + \\lambda W(\\phi)$:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} = \\lambda \\frac{dW}{d\\phi} = \\lambda \\frac{d}{d\\phi}\\left[\\frac{1}{4}(\\phi^4 - 2\\phi^2 + 1)\\right] = \\lambda (\\phi^3 - \\phi)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi'} = \\kappa \\phi' = \\kappa \\frac{d\\phi}{dx}\n$$\nSubstituting these into the Euler-Lagrange equation gives the governing ordinary differential equation for the equilibrium profile:\n$$\n\\lambda (\\phi^3 - \\phi) - \\frac{d}{dx}\\left(\\kappa \\frac{d\\phi}{dx}\\right) = 0\n$$\n$$\n\\kappa \\frac{d^2\\phi}{dx^2} = \\lambda (\\phi^3 - \\phi)\n$$\nThis is the necessary relation for the stationary, one-dimensional equilibrium profile $\\phi(x)$.\n\nTo compute the surface tension $\\sigma = \\mathcal{F}[\\phi_{\\text{eq}}]$, we can first find a first integral of the Euler-Lagrange equation. This is analogous to the conservation of energy in a classical mechanics problem. We multiply the equilibrium equation by $\\frac{d\\phi}{dx}$:\n$$\n\\kappa \\frac{d^2\\phi}{dx^2}\\frac{d\\phi}{dx} - \\lambda (\\phi^3 - \\phi)\\frac{d\\phi}{dx} = 0\n$$\nRecognizing that each term is a total derivative with respect to $x$:\n$$\n\\frac{d}{dx}\\left[\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2\\right] - \\frac{d}{dx}[\\lambda W(\\phi)] = 0\n$$\n$$\n\\frac{d}{dx}\\left[\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 - \\lambda W(\\phi)\\right] = 0\n$$\nThis implies that the quantity in the brackets is a constant along the profile. We can evaluate this constant using the boundary conditions at $x \\to \\pm\\infty$. At infinity, the system is in a bulk phase, so the profile is flat, $\\frac{d\\phi}{dx} \\to 0$. Also, $\\phi \\to \\pm 1$, and by definition, $W(\\pm 1) = \\frac{1}{4}((\\pm 1)^2 - 1)^2 = 0$. Therefore, the constant is zero. This yields a critical relationship for the equilibrium profile:\n$$\n\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 = \\lambda W(\\phi)\n$$\nThis relation signifies an equipartition between the gradient energy density and the bulk potential energy density at every point $x$ within the interface.\n\nNow we can calculate the surface tension $\\sigma$, which is the value of the functional $\\mathcal{F}$ for the equilibrium profile:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\lambda W(\\phi) \\right]\\,dx\n$$\nUsing the equipartition relation $\\lambda W(\\phi) = \\frac{\\kappa}{2}(\\frac{d\\phi}{dx})^2$, we can simplify the integrand:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\right]\\,dx = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right)^2 dx\n$$\nAn elegant way to evaluate this integral without explicitly solving for $\\phi(x)$ is to change the integration variable from $x$ to $\\phi$. From the equipartition relation, we have:\n$$\n\\frac{d\\phi}{dx} = \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}}\n$$\n(We take the positive root since $\\phi$ increases from $-1$ to $+1$ as $x$ increases from $-\\infty$ to $+\\infty$).\nWe can write the integral for $\\sigma$ as:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right) \\left(\\frac{d\\phi}{dx} dx\\right) = \\int_{\\phi(-\\infty)}^{\\phi(+\\infty)} \\kappa \\left(\\frac{d\\phi}{dx}\\right) d\\phi\n$$\nSubstituting the expression for $\\frac{d\\phi}{dx}$:\n$$\n\\sigma = \\int_{-1}^{+1} \\kappa \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}} d\\phi = \\int_{-1}^{+1} \\sqrt{2\\kappa\\lambda W(\\phi)} d\\phi\n$$\nNow, substitute the form of $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$. For $\\phi \\in [-1, +1]$, $\\sqrt{W(\\phi)} = \\frac{1}{2}(1-\\phi^2)$.\n$$\n\\sigma = \\sqrt{2\\kappa\\lambda} \\int_{-1}^{+1} \\frac{1}{2}(1-\\phi^2) d\\phi\n$$\nThe integral is straightforward to evaluate:\n$$\n\\int_{-1}^{+1} (1-\\phi^2) d\\phi = \\left[\\phi - \\frac{\\phi^3}{3}\\right]_{-1}^{+1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\left(\\frac{2}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\nSubstituting this result back into the expression for $\\sigma$:\n$$\n\\sigma = \\sqrt{2\\kappa\\lambda} \\cdot \\frac{1}{2} \\cdot \\frac{4}{3} = \\frac{2}{3}\\sqrt{2\\kappa\\lambda}\n$$\nThis can be written in the final simplified form:\n$$\n\\sigma = \\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa\\lambda}\n$$\n\nRegarding the comparison to the sharp-interface limit: the value of $\\sigma$ derived here is the exact surface tension for the specified diffuse-interface model. In a classical sharp-interface model, the surface tension, say $\\sigma_{\\text{si}}$, is a prescribed thermodynamic parameter representing the excess energy of a zero-thickness mathematical surface. To connect the two models, one equates the phase-field surface tension with the sharp-interface value: $\\sigma = \\sigma_{\\text{si}}$. This equation provides one constraint on the model parameters $\\kappa$ and $\\lambda$. A second constraint comes from defining a characteristic interface thickness, $l$. By non-dimensionalizing the equilibrium equation, one finds that $l$ scales as $l \\propto \\sqrt{\\kappa/\\lambda}$.\nThe \"sharp-interface limit\" refers to the limit where $l \\to 0$ while $\\sigma_{\\text{si}}$ remains constant. From the scaling relations, if $\\sigma \\propto \\sqrt{\\kappa\\lambda}$ and $l \\propto \\sqrt{\\kappa/\\lambda}$, we find that $\\kappa \\propto \\sigma l$ and $\\lambda \\propto \\sigma/l$. Therefore, the limit $l \\to 0$ while keeping $\\sigma$ constant corresponds to $\\kappa \\to 0$ and $\\lambda \\to \\infty$, such that the product $\\kappa\\lambda$ remains constant. Our expression correctly shows that if $\\kappa\\lambda$ is held constant, the surface tension of the phase-field model remains constant, thereby consistently matching the sharp-interface value even as the interface profile becomes infinitely steep.", "answer": "$$\\boxed{\\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa\\lambda}}$$", "id": "3521619"}, {"introduction": "Moving from statics to dynamics, this practice introduces the Allen-Cahn equation, a cornerstone model for the evolution of a non-conserved order parameter. You will implement a robust semi-implicit numerical scheme using the Fast Fourier Transform (FFT) to simulate the motion of an interface under a thermodynamic driving force. This computational exercise provides direct insight into how modeling choices, specifically the form of the mobility function $M(\\phi)$, can profoundly affect interface kinetics and the overall system evolution [@problem_id:3521556].", "problem": "You are asked to implement and analyze a one-dimensional Allen–Cahn phase-field model with a mobility that is either constant or degenerate in the bulk. Your goal is to quantify how mobility degeneracy modifies interface kinetics under a small thermodynamic driving force by computing the interface velocity from first principles. The complete program must be self-contained, perform the required calculations for the specified test suite, and print the aggregated results in the exact format described at the end of this problem.\n\nConsider a scalar order parameter field $ \\phi(x,t) \\in [0,1] $ on a periodic one-dimensional domain $ x \\in [0,L) $, evolving under the Allen–Cahn dynamics driven by a Ginzburg–Landau free energy with a double-well potential and a small linear tilt that induces motion of the interface. The free energy functional is\n$$\n\\mathcal{F}[\\phi] = \\int_{0}^{L} \\left( \\frac{\\epsilon^2}{2} \\left| \\frac{\\partial \\phi}{\\partial x} \\right|^2 + W(\\phi) - h \\, \\phi \\right) \\, dx,\n$$\nwhere $ \\epsilon  0 $ sets the interface thickness, $ W(\\phi) = \\phi^2 (1-\\phi)^2 $ is the double-well potential, and $ h \\in \\mathbb{R} $ is a small constant tilt that biases the two wells. The variational derivative (chemical potential) is\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = - \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + W'(\\phi) - h,\n$$\nwith $ W'(\\phi) = 2 \\phi (1-\\phi)(1-2\\phi) $. The Allen–Cahn evolution is the relaxational dynamics\n$$\n\\frac{\\partial \\phi}{\\partial t} = - M(\\phi) \\, \\mu = M(\\phi) \\left( \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - W'(\\phi) + h \\right),\n$$\nwhere $ M(\\phi) $ is the mobility. You will study two cases:\n- Constant mobility: $ M(\\phi) = M_0 $, where $ M_0  0 $ is constant.\n- Degenerate mobility: $ M(\\phi) = M_0 \\, \\phi^2 (1-\\phi)^2 $, which vanishes in the bulk phases $ \\phi = 0 $ and $ \\phi = 1 $ and is maximal near the interface $ \\phi \\approx 1/2 $.\n\nInitial condition: a single diffuse interface centered at $ x_0 = L/2 $,\n$$\n\\phi(x,0) = \\frac{1}{2} \\left[ 1 - \\tanh \\left( \\frac{x - x_0}{\\sqrt{2} \\, w} \\right) \\right],\n$$\nwith a smooth width $ w $ chosen proportionally to $ \\epsilon $ so that the interface is well-resolved.\n\nYou must derive from first principles a numerically stable semi-implicit time-stepping scheme in which the linear diffusive term is treated implicitly with a constant operator, while nonlinear and variable-coefficient terms are treated explicitly. Use a periodic spatial discretization and a Fast Fourier Transform (FFT) to implement the implicit linear solve efficiently by diagonalization in Fourier space. Specifically, write an update of the form\n$$\n\\left( I - \\Delta t \\, M_0 \\, \\epsilon^2 \\, \\frac{\\partial^2}{\\partial x^2} \\right) \\phi^{n+1} = \\phi^n + \\Delta t \\left[ \\left( M(\\phi^n) - M_0 \\right) \\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n) W'(\\phi^n) + M(\\phi^n) h \\right],\n$$\nwhere $ \\Delta t $ is the time step and superscripts denote time levels. Under periodic boundary conditions, the operator on the left-hand side is diagonal in Fourier space.\n\nDefine the instantaneous interface position $ x_\\ast(t) $ as the unique location nearest to $ x_0 $ where $ \\phi(x_\\ast(t),t) = 1/2 $. Use linear interpolation between grid points to estimate $ x_\\ast(t) $ from the discrete field $ \\phi(x,t) $. Because the domain is periodic, compute the net displacement using the minimum image convention:\n$$\n\\Delta x = \\mathrm{wrap}( x_\\ast(T) - x_\\ast(0) ), \\quad \\mathrm{wrap}(d) = \n\\begin{cases}\nd - L  \\text{if } d  L/2, \\\\\nd + L  \\text{if } d  -L/2, \\\\\nd  \\text{otherwise.}\n\\end{cases}\n$$\nThe average interface velocity is then\n$$\nv = \\frac{\\Delta x}{T},\n$$\nwhere $ T $ is the final simulation time.\n\nImplement the above numerical scheme and compute, for each test case below, the pair of velocities $ v_{\\mathrm{const}} $ and $ v_{\\mathrm{deg}} $ obtained with constant and degenerate mobility, respectively, and the ratio\n$$\nR = \n\\begin{cases}\n\\frac{v_{\\mathrm{deg}}}{v_{\\mathrm{const}}},  \\text{if } |v_{\\mathrm{const}}| \\ge \\delta, \\\\\n0,  \\text{if } |v_{\\mathrm{const}}|  \\delta,\n\\end{cases}\n$$\nwith $ \\delta = 10^{-8} $.\n\nAll simulations are nondimensional. Ensure numerical stability by choosing $ \\Delta t $ and the number of grid points $ N $ such that the interface is resolved and the scheme is stable.\n\nTest suite. For all cases use a periodic domain $ [0,L) $ with $ L = 1 $, and set $ w = 2 \\epsilon $ in the initial condition. Use the following parameter sets:\n- Case A (driven, thin interface): $ \\epsilon = 0.01 $, $ h = 0.05 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $.\n- Case B (undriven control): $ \\epsilon = 0.01 $, $ h = 0.0 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $.\n- Case C (driven, wider interface): $ \\epsilon = 0.02 $, $ h = 0.05 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $.\n\nFor each case, compute three floats $ [v_{\\mathrm{const}}, v_{\\mathrm{deg}}, R] $.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Concatenate the three floats for Case A, then the three floats for Case B, then the three floats for Case C, in that order, yielding a flat list of nine floats. Round each float to exactly six digits after the decimal point in the printed output. For example, the printed line must have the form\n$$\n[\\text{A1},\\text{A2},\\text{A3},\\text{B1},\\text{B2},\\text{B3},\\text{C1},\\text{C2},\\text{C3}],\n$$\nwhere each placeholder is a decimal number with exactly six digits after the decimal point.", "solution": "The user has provided a well-posed problem in computational physics, specifically concerning the numerical solution of the Allen-Cahn equation. The problem is scientifically grounded, free of contradictions, and contains all necessary information for a unique solution. I will proceed with the derivation and implementation of the solution.\n\n### 1. Theoretical Framework and Numerical Scheme\n\nThe evolution of the scalar phase field $\\phi(x,t)$ is governed by the Allen-Cahn equation, a gradient descent dynamics for the Ginzburg-Landau free energy functional $\\mathcal{F}[\\phi]$:\n$$\n\\frac{\\partial \\phi}{\\partial t} = -M(\\phi) \\frac{\\delta \\mathcal{F}}{\\delta \\phi}\n$$\nThe free energy functional is given by:\n$$\n\\mathcal{F}[\\phi] = \\int_{0}^{L} \\left( \\frac{\\epsilon^2}{2} \\left| \\frac{\\partial \\phi}{\\partial x} \\right|^2 + W(\\phi) - h \\, \\phi \\right) \\, dx\n$$\nwhere $W(\\phi) = \\phi^2 (1-\\phi)^2$ is the double-well potential. The variational derivative, or chemical potential $\\mu$, is:\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = - \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + W'(\\phi) - h\n$$\nwith $W'(\\phi) = 2\\phi(1-\\phi)(1-2\\phi)$. This leads to the partial differential equation (PDE):\n$$\n\\frac{\\partial \\phi}{\\partial t} = M(\\phi) \\left( \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - W'(\\phi) + h \\right)\n$$\nWe analyze two forms for the mobility $M(\\phi)$: constant ($M(\\phi) = M_0$) and degenerate ($M(\\phi) = M_0 \\phi^2(1-\\phi)^2$).\n\nA semi-implicit time integration scheme is specified to handle the stiffness of the diffusive term $\\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2}$. The scheme separates the PDE into a linear part with a constant coefficient, treated implicitly, and the remaining nonlinear/variable-coefficient parts, treated explicitly. We rewrite the PDE as:\n$$\n\\frac{\\partial \\phi}{\\partial t} = M_0 \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + \\left[ (M(\\phi) - M_0)\\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - M(\\phi)W'(\\phi) + M(\\phi)h \\right]\n$$\nApplying a forward-Euler step for the explicit part and a backward-Euler step for the implicit part gives:\n$$\n\\frac{\\phi^{n+1} - \\phi^n}{\\Delta t} = M_0 \\epsilon^2 \\frac{\\partial^2 \\phi^{n+1}}{\\partial x^2} + \\left[ (M(\\phi^n) - M_0)\\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n)W'(\\phi^n) + M(\\phi^n)h \\right]\n$$\nRearranging for $\\phi^{n+1}$ yields the update equation specified in the problem:\n$$\n\\left( I - \\Delta t \\, M_0 \\, \\epsilon^2 \\, \\frac{\\partial^2}{\\partial x^2} \\right) \\phi^{n+1} = \\text{RHS}(\\phi^n)\n$$\nwhere $I$ is the identity operator and $\\text{RHS}(\\phi^n)$ collects all terms evaluated at the current time step $n$:\n$$\n\\text{RHS}(\\phi^n) = \\phi^n + \\Delta t \\left[ \\left( M(\\phi^n) - M_0 \\right) \\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n) W'(\\phi^n) + M(\\phi^n) h \\right]\n$$\n\n### 2. Spectral Implementation\n\nThe problem is set on a periodic domain $x \\in [0,L)$, making a spectral method based on the Fast Fourier Transform (FFT) highly efficient. The spatial domain is discretized into $N$ grid points $x_j = j \\cdot \\Delta x$ for $j = 0, \\dots, N-1$, where $\\Delta x = L/N$.\n\nIn Fourier space, the second derivative operator $\\frac{\\partial^2}{\\partial x^2}$ becomes a multiplication by $-q^2$, where $q$ are the angular wavenumbers. For a discrete grid, these are $q = 2\\pi k$, where $k$ are the spatial frequencies given by `numpy.fft.fftfreq(N, d=dx)`.\n\nLet $\\hat{\\phi}$ be the FFT of $\\phi$. The update equation in Fourier space becomes:\n$$\n\\left( 1 + \\Delta t \\, M_0 \\, \\epsilon^2 \\, q^2 \\right) \\hat{\\phi}^{n+1} = \\widehat{\\text{RHS}}(\\phi^n)\n$$\nWe can solve for $\\hat{\\phi}^{n+1}$ by a simple element-wise division:\n$$\n\\hat{\\phi}^{n+1} = \\frac{\\widehat{\\text{RHS}}(\\phi^n)}{1 + \\Delta t \\, M_0 \\, \\epsilon^2 \\, q^2}\n$$\nThe field at the new time step, $\\phi^{n+1}$, is then obtained by an inverse FFT.\n\nThe algorithm for one time step is:\n1.  Start with $\\phi^n$ in real space and $\\hat{\\phi}^n$ in Fourier space.\n2.  Compute the explicit term $\\frac{\\partial^2 \\phi^n}{\\partial x^2}$ by applying an inverse FFT to $-q^2 \\hat{\\phi}^n$.\n3.  Compute $W'(\\phi^n)$ and $M(\\phi^n)$ in real space.\n4.  Assemble the full $\\text{RHS}(\\phi^n)$ expression in real space.\n5.  Compute the FFT of the right-hand side, $\\widehat{\\text{RHS}}$.\n6.  Divide by the denominator $(1 + \\Delta t M_0 \\epsilon^2 q^2)$ to find $\\hat{\\phi}^{n+1}$.\n7.  The real part of the inverse FFT of $\\hat{\\phi}^{n+1}$ gives $\\phi^{n+1}$.\n\n### 3. Interface Velocity Calculation\n\nThe instantaneous position of the interface, $x_*(t)$, is defined as the location where $\\phi(x,t) = 1/2$. Given the discrete field $\\phi_j$, this position is found by identifying the grid cell $[x_j, x_{j+1}]$ where the crossing occurs (i.e., $(\\phi_j - 0.5)(\\phi_{j+1} - 0.5) \\le 0$) and using linear interpolation:\n$$\nx_* = x_j + \\Delta x \\frac{0.5 - \\phi_j}{\\phi_{j+1} - \\phi_j}\n$$\nThe periodic nature of the domain is handled by checking the crossing between the last and first grid points as well. If multiple crossings exist, the one nearest to the initial center $x_0 = L/2$ is chosen.\n\nThe net displacement $\\Delta x$ over the total simulation time $T$ is computed as $\\Delta x = x_*(T) - x_*(0)$, adjusted for periodicity using the minimum image convention:\n$$\n\\Delta x \\to \\Delta x - L \\quad \\text{if } \\Delta x  L/2\n$$\n$$\n\\Delta x \\to \\Delta x + L \\quad \\text{if } \\Delta x  -L/2\n$$\nThe average velocity is then $v = \\Delta x / T$.\n\nFor each test case, we compute the velocities for constant mobility, $v_{\\mathrm{const}}$, and degenerate mobility, $v_{\\mathrm{deg}}$. The ratio $R$ is calculated as $v_{\\mathrm{deg}}/v_{\\mathrm{const}}$, with a threshold to prevent division by zero for stationary interfaces.\n\nThe implementation will consist of a main function to loop through the test suite, calling a simulation function that executes the time-stepping loop and calculates the velocity. All parameters provided in the problem statement are used directly.", "answer": "```python\n#\n# Meticulous and Exacting Professor: STEM Fields\n# Final Answer: Allen-Cahn Phase-Field Simulation\n#\nimport numpy as np\n\ndef W_prime(phi):\n    \"\"\"Derivative of the double-well potential W(phi) = phi^2 * (1-phi)^2.\"\"\"\n    return 2.0 * phi * (1.0 - phi) * (1.0 - 2.0 * phi)\n\ndef M_const(phi, M0):\n    \"\"\"Constant mobility function.\"\"\"\n    return np.full_like(phi, M0)\n\ndef M_degen(phi, M0):\n    \"\"\"Degenerate mobility function.\"\"\"\n    return M0 * phi**2 * (1.0 - phi)**2\n\ndef find_interface_position(x, phi, L, x0_center):\n    \"\"\"\n    Finds the interface position (phi=0.5) using linear interpolation.\n    Handles periodic boundaries and selects the crossing nearest to x0_center.\n    \"\"\"\n    N = len(x)\n    dx = L / N\n    \n    phi_shifted = np.roll(phi, -1)\n    # Find indices j where a sign change occurs for phi-0.5\n    indices = np.where((phi - 0.5) * (phi_shifted - 0.5) = 0)[0]\n\n    if indices.size == 0:\n        center_idx = np.argmin(np.abs(phi - 0.5))\n        return x[center_idx]\n        \n    crossings = []\n    for j in indices:\n        phi_j = phi[j]\n        phi_j1 = phi_shifted[j]\n        \n        delta_phi = phi_j1 - phi_j\n        if np.abs(delta_phi)  1e-12:\n            if np.abs(phi_j - 0.5)  1e-9: # Point is on the crossing\n                crossings.append(x[j])\n            continue\n        \n        pos = x[j] + dx * (0.5 - phi_j) / delta_phi\n        crossings.append(pos)\n    \n    if not crossings:\n        center_idx = np.argmin(np.abs(phi - 0.5))\n        return x[center_idx]\n        \n    crossings = np.array(crossings)\n    crossings = crossings % L\n    \n    dist = np.abs(crossings - x0_center)\n    dist = np.minimum(dist, L - dist)\n    \n    return crossings[np.argmin(dist)]\n\ndef run_simulation(L, N, T, dt, eps, h, M0, mobility_type):\n    \"\"\"Runs a single Allen-Cahn simulation.\"\"\"\n    dx = L / N\n    x = np.arange(N) * dx\n    q = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n    laplacian_k = -q**2\n\n    w = 2.0 * eps\n    x0_center = L / 2.0\n    phi_initial = 0.5 * (1.0 - np.tanh((x - x0_center) / (np.sqrt(2.0) * w)))\n    \n    pos0 = find_interface_position(x, phi_initial, L, x0_center)\n\n    mobility_map = {'const': M_const, 'degen': M_degen}\n    M_func = mobility_map[mobility_type]\n\n    num_steps = int(round(T / dt))\n    phi_k = np.fft.fft(phi_initial)\n    \n    denominator = 1.0 - dt * M0 * eps**2 * laplacian_k\n    denominator[np.abs(denominator)  1e-12] = 1.0\n\n    for _ in range(num_steps):\n        phi = np.fft.ifft(phi_k).real\n        M_phi = M_func(phi, M0)\n        W_p = W_prime(phi)\n        \n        if mobility_type == 'const':\n            rhs = phi + dt * (-M_phi * W_p + M_phi * h)\n        else:\n            lap_phi = np.fft.ifft(laplacian_k * phi_k).real\n            rhs = phi + dt * ((M_phi - M0) * eps**2 * lap_phi - M_phi * W_p + M_phi * h)\n        \n        rhs_k = np.fft.fft(rhs)\n        phi_k = rhs_k / denominator\n\n    phi_final = np.fft.ifft(phi_k).real\n    \n    pos_final = find_interface_position(x, phi_final, L, x0_center)\n    \n    delta_x = pos_final - pos0\n    if delta_x  L / 2.0:\n        delta_x -= L\n    elif delta_x  -L / 2.0:\n        delta_x += L\n        \n    velocity = delta_x / T\n    \n    return velocity\n\ndef solve():\n    \"\"\"Main function to run the test suite and print results.\"\"\"\n    test_suite = [\n        # Case A (driven, thin interface)\n        {'eps': 0.01, 'h': 0.05, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n        # Case B (undriven control)\n        {'eps': 0.01, 'h': 0.0, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n        # Case C (driven, wider interface)\n        {'eps': 0.02, 'h': 0.05, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n    ]\n    \n    common_params = {'L': 1.0, 'M0': 1.0}\n    delta_R = 1e-8\n    \n    results = []\n    for case_params in test_suite:\n        params = {**common_params, **case_params}\n        \n        v_const = run_simulation(**params, mobility_type='const')\n        v_deg = run_simulation(**params, mobility_type='degen')\n        \n        R = 0.0\n        if abs(v_const) = delta_R:\n            R = v_deg / v_const\n            \n        results.extend([v_const, v_deg, R])\n\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```", "id": "3521556"}, {"introduction": "Real-world applications often involve the coupling of multiple physical phenomena that evolve on vastly different time scales. This advanced practice addresses such a scenario by coupling phase-field dynamics with thermal relaxation, a common feature in solidification and phase transformation problems. You will implement a sophisticated and energy-stable multirate time-stepping scheme, a powerful technique for efficiently solving stiff, coupled systems while preserving the underlying thermodynamic consistency of the gradient-flow structure [@problem_id:3521568].", "problem": "Consider a one-dimensional phase-field model for thermo–phase coupling on a periodic domain. Let the spatial domain be the interval $\\left[0,1\\right]$ with $N$ uniformly spaced grid points and periodic boundary conditions. The state variables are the phase-field $\\phi(x,t)$ and the temperature-like variable $T(x,t)$. The total free energy is\n$$\n\\mathcal{F}[\\phi,T] \\;=\\; \\int_{0}^{1} \\left( \\frac{\\varepsilon^{2}}{2}\\, |\\partial_x \\phi|^{2} \\;+\\; W(\\phi) \\;-\\; \\alpha\\, T\\, \\phi \\;+\\; \\frac{c_T}{2}\\,(T - T_0)^2 \\right) \\,\\mathrm{d}x,\n$$\nwhere $W(\\phi)$ is a double-well potential, $\\varepsilon0$ is the gradient energy length scale, $\\alpha0$ controls thermo–phase coupling, $c_T0$ is a heat-capacity-like coefficient, and $T_0$ is a reference temperature. Assume $W(\\phi) = \\tfrac{1}{4}\\,(\\phi^{2}-1)^{2}$.\n\nThe coupled dynamics are assumed to be gradient flows with respect to $\\mathcal{F}$ in the $L^2$ inner product:\n- Phase kinetics (Allen–Cahn type): $\\partial_t \\phi \\;=\\; -\\, M\\, \\frac{\\delta \\mathcal{F}}{\\delta \\phi}$ with mobility $M0$.\n- Thermal relaxation: $\\partial_t T \\;=\\; -\\, K\\, \\frac{\\delta \\mathcal{F}}{\\delta T}$ with relaxation coefficient $K0$.\n\nYour tasks are:\n- Starting from the free energy functional $\\mathcal{F}$, compute the variational derivatives $\\delta \\mathcal{F}/\\delta \\phi$ and $\\delta \\mathcal{F}/\\delta T$ in the continuum.\n- Propose a multirate time-stepping strategy that advances $(\\phi,T)$ from time $t^{n}$ to $t^{n+1}=t^{n}+\\Delta t$ such that:\n  - The phase-field $\\phi$ is advanced using $n_{\\text{sub}}\\ge 1$ local substeps of size $\\delta t = \\Delta t / n_{\\text{sub}}$ while holding $T$ fixed at $T^{n}$ during the subcycling.\n  - The temperature $T$ is then updated once from $T^{n}$ to $T^{n+1}$ using information at time $t^{n+1}$ for $\\phi$ and a scheme that is a time-discrete gradient descent with respect to $\\mathcal{F}$.\n- For the phase substeps, construct an unconditionally energy-stable update based on a convex–concave splitting of the bulk energy density $W(\\phi)$, in which the convex part is treated implicitly and the concave part explicitly. Use a splitting parameter $a \\ge 0$ so that $W(\\phi) = W_{\\text{convex}}(\\phi) - W_{\\text{concave}}(\\phi)$ with both $W_{\\text{convex}}$ and $W_{\\text{concave}}$ convex functions. You must ensure that the resulting semi-implicit substep for $\\phi$ is a gradient descent with respect to the discrete energy with $T$ held fixed at $T^{n}$. In your implementation use $a = 1$.\n- Use a second-order finite difference spatial discretization with periodic boundary conditions to approximate spatial derivatives. Make all updates fully discrete in space and time, using $N$ grid points and grid spacing $\\Delta x = 1/N$.\n\nScientific realism requirement:\n- Justify, from first principles of gradient flow and convexity, why the composition of the phase subcycling (with $T$ lagged) and the implicit temperature update yields a nonincreasing discrete energy across each macro time step, i.e., $\\mathcal{F}^{n+1} \\le \\mathcal{F}^{n}$.\n\nNumerical implementation requirements:\n- Implement the derived multirate strategy in a program. Use the following fixed modeling parameters for all tests: $\\varepsilon = 0.02$, $\\alpha = 0.5$, $c_T = 1.0$, $T_0 = 0.0$, $K = 1.0$, $a=1.0$. Use $N = 64$ and a periodic spatial grid on $\\left[0,1\\right]$.\n- Initialize the fields at $t^0$ with a heterogeneous but smooth profile:\n  - $\\phi(x,0) = 0.5 \\sin(2\\pi x) + \\eta_\\phi(x)$,\n  - $T(x,0) = 0.0 + \\eta_T(x)$,\n  where $\\eta_\\phi(x)$ and $\\eta_T(x)$ are independent mean-zero random perturbations with amplitude $10^{-2}$. Use a fixed pseudorandom number generator seed so that results are reproducible.\n- In each macro step, first advance $\\phi$ from $\\phi^{n}$ to $\\phi^{n+1}$ using $n_{\\text{sub}}$ local substeps with $T$ frozen at $T^{n}$, then advance $T$ from $T^{n}$ to $T^{n+1}$ using an unconditionally energy-stable implicit gradient descent for $T$ with $\\phi^{n+1}$ held fixed.\n- Compute the discrete energy $\\mathcal{F}^{n}$ at the end of each macro time step using the trapezoidal-rule-equivalent rectangle rule on the uniform grid:\n  $$\n  \\mathcal{F}^{n} \\;=\\; \\sum_{j=0}^{N-1} \\Delta x \\left( \\frac{\\varepsilon^{2}}{2}\\, |\\nabla_h \\phi^{n}_j|^{2} \\;+\\; \\frac{1}{4}\\left((\\phi^{n}_j)^{2}-1\\right)^{2} \\;-\\; \\alpha\\, T^{n}_j\\, \\phi^{n}_j \\;+\\; \\frac{c_T}{2}\\,(T^{n}_j - T_0)^2 \\right),\n  $$\n  where $|\\nabla_h \\phi^{n}_j|$ denotes the centered finite-difference gradient magnitude at grid point $j$.\n\nTest suite:\n- For each parameter tuple $(M,\\Delta t,n_{\\text{sub}},n_{\\text{macro}})$ listed below, run the simulation for $n_{\\text{macro}}$ macro steps and record whether the discrete energy is nonincreasing across macro steps, i.e., $\\mathcal{F}^{n+1} \\le \\mathcal{F}^{n}$ for all $n$ from $0$ to $n_{\\text{macro}}-1$ (within a small numerical tolerance of $10^{-10}$ added to the right-hand side).\n  1. $(M=\\;5.0,\\;\\Delta t=\\;0.05,\\;n_{\\text{sub}}=\\;5,\\;n_{\\text{macro}}=\\;8)$,\n  2. $(M=\\;20.0,\\;\\Delta t=\\;0.05,\\;n_{\\text{sub}}=\\;10,\\;n_{\\text{macro}}=\\;8)$,\n  3. $(M=\\;20.0,\\;\\Delta t=\\;0.05,\\;n_{\\text{sub}}=\\;1,\\;n_{\\text{macro}}=\\;8)$,\n  4. $(M=\\;20.0,\\;\\Delta t=\\;0.10,\\;n_{\\text{sub}}=\\;1,\\;n_{\\text{macro}}=\\;8)$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the boolean results for the four test cases as a comma-separated list enclosed in square brackets (e.g., \"[True,True,False,True]\").\n- Angles do not appear; no angle units are required. No physical unit conversion is required since the model is nondimensionalized. All reported values are booleans.\n\nYour deliverables:\n- A complete derivation and explanation showing what the scheme is, why it is energy-dissipative at the macro-step level, and how it follows from the gradient-flow structure and convexity.\n- A complete, runnable program that implements the scheme exactly as specified and prints the required single-line output for the test suite.", "solution": "The problem asks for the derivation, justification, and implementation of an energy-stable multirate numerical scheme for a coupled thermo-phase-field model.\n\n### 1. Model and Governing Equations\n\nThe system is described by a phase-field variable $\\phi(x,t)$ and a temperature-like variable $T(x,t)$ on a periodic domain $x \\in [0,1]$. The total free energy is given by the functional:\n$$\n\\mathcal{F}[\\phi,T] = \\int_{0}^{1} \\left( \\frac{\\varepsilon^{2}}{2}\\, |\\partial_x \\phi|^{2} + W(\\phi) - \\alpha\\, T\\, \\phi + \\frac{c_T}{2}\\,(T - T_0)^2 \\right) \\,\\mathrm{d}x\n$$\nwhere $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$ is the double-well potential. The dynamics are gradient flows with respect to this energy functional. To derive the governing partial differential equations (PDEs), we compute the variational (Fréchet) derivatives of $\\mathcal{F}$ with respect to $\\phi$ and $T$.\n\n#### Variational Derivative with respect to $\\phi$\nLet the integrand be $L(\\phi, \\partial_x \\phi, T)$. The variational derivative $\\delta \\mathcal{F}/\\delta \\phi$ is found using the Euler-Lagrange equation, $\\frac{\\delta \\mathcal{F}}{\\delta \\phi} = \\frac{\\partial L}{\\partial \\phi} - \\frac{d}{dx}\\frac{\\partial L}{\\partial(\\partial_x \\phi)}$.\n\\begin{align*}\n\\frac{\\partial L}{\\partial \\phi} = W'(\\phi) - \\alpha T \\\\\n\\frac{\\partial L}{\\partial(\\partial_x \\phi)} = \\varepsilon^2 \\partial_x \\phi \\\\\n\\frac{d}{dx}\\frac{\\partial L}{\\partial(\\partial_x \\phi)} = \\varepsilon^2 \\partial_{xx}^2 \\phi\n\\end{align*}\nCombining these terms, we get:\n$$\n\\frac{\\delta \\mathcal{F}}{\\delta \\phi} = W'(\\phi) - \\alpha T - \\varepsilon^2 \\partial_{xx}^2 \\phi\n$$\nGiven $W(\\phi) = \\frac{1}{4}(\\phi^4 - 2\\phi^2 + 1)$, its derivative is $W'(\\phi) = \\phi^3 - \\phi$. Thus:\n$$\n\\frac{\\delta \\mathcal{F}}{\\delta \\phi} = \\phi^3 - \\phi - \\alpha T - \\varepsilon^2 \\partial_{xx}^2 \\phi\n$$\n\n#### Variational Derivative with respect to $T$\nThe integrand $L$ does not contain derivatives of $T$, so the variational derivative is simply the partial derivative:\n$$\n\\frac{\\delta \\mathcal{F}}{\\delta T} = \\frac{\\partial L}{\\partial T} = -\\alpha \\phi + c_T(T - T_0)\n$$\n\n### 2. Continuum Governing PDEs\nThe dynamics are given by $\\partial_t \\phi = -M (\\delta \\mathcal{F}/\\delta \\phi)$ and $\\partial_t T = -K (\\delta \\mathcal{F}/\\delta T)$:\n$$\n\\partial_t \\phi = -M \\left(\\phi^3 - \\phi - \\alpha T - \\varepsilon^2 \\partial_{xx}^2 \\phi \\right) = M \\left(\\varepsilon^2 \\partial_{xx}^2 \\phi - (\\phi^3 - \\phi) + \\alpha T \\right) \\quad \\text{(Allen-Cahn)}\n$$\n$$\n\\partial_t T = -K \\left(-\\alpha \\phi + c_T(T - T_0)\\right) = K \\left(\\alpha \\phi - c_T(T - T_0)\\right) \\quad \\text{(Thermal Relaxation)}\n$$\n\n### 3. Spatiotemporal Discretization and Numerical Scheme\n\nWe discretize the spatial domain $[0,1]$ into $N$ grid points $x_j = j \\Delta x$ for $j=0, ..., N-1$, with grid spacing $\\Delta x = 1/N$. We use centered finite differences for spatial derivatives, respecting the periodic boundary conditions. The second derivative (Laplacian) of a field $u$ at grid point $j$ is approximated by $(\\Delta_h \\boldsymbol{u})_j = (u_{j+1} - 2u_j + u_{j-1})/\\Delta x^2$.\n\nThe proposed numerical scheme is a multirate operator splitting scheme. For each macro time step from $t^n$ to $t^{n+1} = t^n + \\Delta t$, we perform two sequential updates:\n\n**Step A: Phase-Field Subcycling**\nThe field $\\phi$ is evolved from $\\phi^n$ to $\\phi^{n+1}$ using $n_{\\text{sub}}$ smaller time steps of size $\\delta t = \\Delta t/n_{\\text{sub}}$. During this process, the temperature is held constant at $T^n$. For each substep $s=0, \\dots, n_{\\text{sub}}-1$, we update $\\phi^{n,s}$ to $\\phi^{n, s+1}$ (where $\\phi^{n,0} = \\phi^n$) by solving:\n$$\n\\partial_t \\phi = -M\\frac{\\delta \\mathcal{F}}{\\delta \\phi}[\\phi, T^n]\n$$\nTo ensure unconditional energy stability, we use a convex-concave splitting of the energy functional $\\mathcal{F}[\\phi, T^n]$. Let this functional be $\\mathcal{F}_{\\phi}$. We split the local (non-gradient) part of the energy density $f(\\phi) = W(\\phi) - \\alpha T^n \\phi$ into a convex part and a concave part. A standard approach is to add and subtract a stabilizing quadratic term $\\frac{a}{2}\\phi^2$. We write $W(\\phi) = W_c(\\phi) - W_{cc}(\\phi)$ where both $W_c$ and $W_{cc}$ are convex. With the problem-specified parameter $a=1$, a valid splitting is:\n- $W_c(\\phi) = W(\\phi) + \\frac{1}{2}\\phi^2 = \\frac{1}{4}(\\phi^2-1)^2 + \\frac{1}{2}\\phi^2 = \\frac{1}{4}\\phi^4 + \\frac{1}{4}$. This is convex as its second derivative is $3\\phi^2 \\ge 0$.\n- $W_{cc}(\\phi) = \\frac{1}{2}\\phi^2$. This is also convex.\nThus, $W'(\\phi) = W'_c(\\phi) - W'_{cc}(\\phi) = \\phi^3 - \\phi$.\n\nThe semi-implicit scheme treats the convex part of the energy gradient implicitly and the concave/linear parts explicitly:\n$$\n\\frac{\\phi^{n,s+1} - \\phi^{n,s}}{\\delta t} = -M \\left( [-\\varepsilon^2 \\Delta_h \\phi^{n,s+1} + W'_c(\\phi^{n,s+1}) ] - [W'_{cc}(\\phi^{n,s}) + \\alpha T^n] \\right)\n$$\nIn this case, the $-\\alpha T^n \\phi$ term is linear and can be treated explicitly without harming stability. Substituting the derivatives:\n$$\n\\frac{\\phi_j^{n,s+1} - \\phi_j^{n,s}}{\\delta t} = -M \\left( [-\\varepsilon^2 (\\Delta_h \\phi^{n,s+1})_j + (\\phi_j^{n,s+1})^3] - [\\phi_j^{n,s} + \\alpha T_j^n] \\right)\n$$\nRearranging gives a nonlinear system of equations for the vector $\\boldsymbol{\\phi}^{n,s+1}$:\n$$\n\\boldsymbol{\\phi}^{n,s+1} - M \\delta t \\varepsilon^2 \\Delta_h \\boldsymbol{\\phi}^{n,s+1} + M \\delta t (\\boldsymbol{\\phi}^{n,s+1})^3 = \\boldsymbol{\\phi}^{n,s} + M \\delta t (\\boldsymbol{\\phi}^{n,s} + \\alpha \\boldsymbol{T}^n)\n$$\nThis nonlinear system must be solved at each substep, for which we use Newton's method.\n\n**Step B: Temperature Update**\nAfter obtaining $\\phi^{n+1} = \\phi^{n,n_{\\text{sub}}}$, we update the temperature from $T^n$ to $T^{n+1}$ while holding $\\phi$ fixed at $\\phi^{n+1}$:\n$$\n\\partial_t T = -K\\frac{\\delta \\mathcal{F}}{\\delta T}[T, \\phi^{n+1}]\n$$\nThe energy functional $\\mathcal{F}[\\phi^{n+1}, T]$ is quadratic (and thus convex) in $T$. For a convex energy, a simple backward Euler (fully implicit) scheme is unconditionally energy-dissipative.\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = -K \\left(-\\alpha \\phi_j^{n+1} + c_T(T_j^{n+1} - T_0)\\right)\n$$\nThis equation is linear in $T_j^{n+1}$ and can be solved explicitly for each grid point $j$:\n$$\nT_j^{n+1}(1 + K \\Delta t c_T) = T_j^n + K \\Delta t (\\alpha \\phi_j^{n+1} + c_T T_0)\n$$\n$$\nT_j^{n+1} = \\frac{T_j^n + K \\Delta t (\\alpha \\phi_j^{n+1} + c_T T_0)}{1 + K \\Delta t c_T}\n$$\n\n### 4. Justification of Energy Stability\n\nThe overall scheme's energy stability, $\\mathcal{F}(\\phi^{n+1}, T^{n+1}) \\le \\mathcal{F}(\\phi^{n}, T^{n})$, is established by showing that each step in the sequential update is energy-dissipative.\n\n1.  **Phase Subcycling Stability**: First, we show $\\mathcal{F}(\\phi^{n+1}, T^n) \\le \\mathcal{F}(\\phi^{n}, T^n)$.\n    The phase update consists of $n_{\\text{sub}}$ substeps. For any single substep $s \\to s+1$, the update conserves $T^n$. The energy functional is $\\mathcal{F}_{\\phi}[\\phi] = \\mathcal{F}[\\phi, T^n]$. We have split this into convex and \"less-convex\" parts: $\\mathcal{F}_{\\phi} = \\mathcal{F}_{\\phi,C} - \\mathcal{F}_{\\phi,NC}$ where $\\mathcal{F}_{\\phi,C}[\\phi] = \\int (\\frac{\\varepsilon^2}{2}|\\partial_x\\phi|^2 + W_c(\\phi))dx$ and $\\mathcal{F}_{\\phi,NC}[\\phi] = \\int (W_{cc}(\\phi) - \\alpha T^n \\phi)dx$. Note $\\mathcal{F}_{\\phi,C}$ is convex and while $\\mathcal{F}_{\\phi,NC}$ is not concave, its treatment is explicit. The scheme is a gradient descent on $\\mathcal{F}_\\phi$.\n    A key property of a convex function $f$ is $f(y) - f(x) \\ge \\langle \\nabla f(x), y-x \\rangle$. For our scheme, applying this property proves that $\\mathcal{F}_{\\phi}[\\phi^{n,s+1}] \\le \\mathcal{F}_{\\phi}[\\phi^{n,s}]$ for each substep. Briefly, the change in energy $\\Delta \\mathcal{F}_{\\phi}$ satisfies:\n    $$\n    \\Delta \\mathcal{F}_{\\phi} \\le \\left\\langle \\frac{\\delta \\mathcal{F}_{\\phi,C}}{\\delta \\phi}(\\phi^{s+1}) - \\frac{\\delta \\mathcal{F}_{\\phi,NC}}{\\delta \\phi}(\\phi^{s}), \\phi^{s+1} - \\phi^{s} \\right\\rangle\n    $$\n    The term in the inner product is exactly $-\\frac{1}{M \\delta t}(\\phi^{s+1} - \\phi^{s})$ from the scheme's definition. Thus,\n    $$\n    \\Delta \\mathcal{F}_{\\phi} \\le -\\frac{1}{M \\delta t} \\lVert \\phi^{s+1} - \\phi^{s} \\rVert_{L^2}^2 \\le 0\n    $$\n    This inequality holds for each substep, so by induction, $\\mathcal{F}(\\phi^{n+1}, T^n) \\le \\mathcal{F}(\\phi^n, T^n)$.\n\n2.  **Temperature Update Stability**: Second, we show $\\mathcal{F}(\\phi^{n+1}, T^{n+1}) \\le \\mathcal{F}(\\phi^{n+1}, T^n)$.\n    The update from $(\\phi^{n+1}, T^n)$ to $(\\phi^{n+1}, T^{n+1})$ holds $\\phi$ constant. The relevant energy is $\\mathcal{F}_T[T] = \\mathcal{F}[\\phi^{n+1}, T]$. As $\\mathcal{F}_T[T]$ is a convex functional of $T$, the implicit Euler scheme is energy-dissipating. The proof is analogous to the one above:\n    $$\n    \\mathcal{F}_T[T^{n+1}] - \\mathcal{F}_T[T^n] \\le \\left\\langle \\frac{\\delta \\mathcal{F}_T}{\\delta T}(T^{n+1}), T^{n+1} - T^n \\right\\rangle = \\left\\langle \\frac{-(T^{n+1} - T^n)}{K \\Delta t}, T^{n+1} - T^n \\right\\rangle = -\\frac{1}{K \\Delta t}\\lVert T^{n+1} - T^n \\rVert_{L^2}^2 \\le 0\n    $$\n    This confirms $\\mathcal{F}(\\phi^{n+1}, T^{n+1}) \\le \\mathcal{F}(\\phi^{n+1}, T^n)$.\n\nBy combining both results, we have $\\mathcal{F}^{n+1} = \\mathcal{F}(\\phi^{n+1}, T^{n+1}) \\le \\mathcal{F}(\\phi^{n+1}, T^n) \\le \\mathcal{F}(\\phi^n, T^n) = \\mathcal{F}^n$, which proves that the entire macro-step is unconditionally energy-stable.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the coupled thermo-phase-field model using a multirate energy-stable scheme.\n    \"\"\"\n\n    # --- Fixed modeling parameters ---\n    eps = 0.02\n    alpha = 0.5\n    c_T = 1.0\n    T0 = 0.0\n    K = 1.0\n    # a = 1.0, as used in the derivation for convex splitting\n\n    # --- Spatial grid ---\n    N = 64\n    dx = 1.0 / N\n    x = np.linspace(0, 1, N, endpoint=False)\n\n    # --- Test suite parameters ---\n    test_cases = [\n        # (M, dt_macro, n_sub, n_macro)\n        (5.0, 0.05, 5, 8),\n        (20.0, 0.05, 10, 8),\n        (20.0, 0.05, 1, 8),\n        (20.0, 0.10, 1, 8),\n    ]\n\n    # --- Numerical solver settings ---\n    newton_tol = 1e-12\n    max_newton_iter = 15\n    energy_stability_tol = 1e-10\n\n    results = []\n\n    for M, dt_macro, n_sub, n_macro in test_cases:\n        dt_sub = dt_macro / n_sub\n\n        # --- Initial Conditions ---\n        # Fixed seed for reproducibility\n        rng = np.random.default_rng(seed=12345)\n        eta_phi = (rng.random(N) - 0.5) * 2 * 1e-2\n        eta_T = (rng.random(N) - 0.5) * 2 * 1e-2\n        \n        phi = 0.5 * np.sin(2 * np.pi * x) + eta_phi\n        T = 0.0 + eta_T\n        \n        is_stable = True\n\n        # --- FDM Laplacian Matrix (for Newton Jacobian) ---\n        # The matrix representation of L_h = -Delta_h is (1/dx^2) * tridiag( -1, 2, -1 ) with periodic corners\n        L_h_op_matrix = np.diag([2.0 / dx**2] * N) + \\\n                        np.diag([-1.0 / dx**2] * (N - 1), 1) + \\\n                        np.diag([-1.0 / dx**2] * (N - 1), -1)\n        L_h_op_matrix[0, N - 1] = -1.0 / dx**2\n        L_h_op_matrix[N - 1, 0] = -1.0 / dx**2\n\n        # --- Discrete energy calculation function ---\n        def calculate_discrete_energy(p, temp):\n            grad_p = (np.roll(p, -1) - np.roll(p, 1)) / (2 * dx)\n            \n            e_grad = 0.5 * eps**2 * grad_p**2\n            e_pot = 0.25 * (p**2 - 1)**2\n            e_couple = -alpha * temp * p\n            e_therm = 0.5 * c_T * (temp - T0)**2\n            \n            integrand = e_grad + e_pot + e_couple + e_therm\n            return np.sum(integrand) * dx\n\n        # --- Macro time stepping loop ---\n        for n in range(n_macro):\n            energy_n = calculate_discrete_energy(phi, T)\n            \n            phi_n = phi.copy()\n            T_n = T.copy()\n\n            # --- Step A: Phi subcycling ---\n            phi_s = phi_n.copy()\n            for s in range(n_sub):\n                # Solve the nonlinear system for phi_s_plus_1 using Newton's method\n                # Equation: F(v) = (I + M*dt_sub*eps^2*L_h)v + M*dt_sub*v^3 - b = 0\n                # v = phi_s_plus_1\n                b = phi_s + M * dt_sub * (phi_s + alpha * T_n)\n                \n                v_k = phi_s.copy() # Newton iteration initial guess\n\n                for k in range(max_newton_iter):\n                    # Residual F(v_k)\n                    lap_v = (np.roll(v_k, 1) - 2 * v_k + np.roll(v_k, -1)) / dx**2\n                    F_v = (v_k - M*dt_sub*eps**2*lap_v + M*dt_sub*v_k**3) - b\n\n                    # Jacobian J(v_k)\n                    J_diag = 1 + M * dt_sub * (eps**2 * 2 / dx**2) + 3 * M * dt_sub * v_k**2\n                    J = np.diag(J_diag) + np.diag([-M*dt_sub*eps**2/dx**2]*(N-1), 1) + \\\n                        np.diag([-M*dt_sub*eps**2/dx**2]*(N-1), -1)\n                    J[0, N-1] = -M*dt_sub*eps**2/dx**2\n                    J[N-1, 0] = -M*dt_sub*eps**2/dx**2\n\n                    # Solve linear system J * delta_v = -F\n                    delta_v = np.linalg.solve(J, -F_v)\n                    v_k += delta_v\n                    \n                    if np.linalg.norm(delta_v)  newton_tol:\n                        break\n                \n                phi_s = v_k.copy()\n            \n            phi_n_plus_1 = phi_s\n\n            # --- Step B: T update ---\n            T_n_plus_1 = (T_n + K * dt_macro * (alpha * phi_n_plus_1 + c_T * T0)) / (1 + K * dt_macro * c_T)\n\n            # Update state for next step\n            phi = phi_n_plus_1\n            T = T_n_plus_1\n\n            # Check energy stability\n            energy_n_plus_1 = calculate_discrete_energy(phi, T)\n            if energy_n_plus_1  energy_n + energy_stability_tol:\n                is_stable = False\n                break\n        \n        results.append(is_stable)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3521568"}]}