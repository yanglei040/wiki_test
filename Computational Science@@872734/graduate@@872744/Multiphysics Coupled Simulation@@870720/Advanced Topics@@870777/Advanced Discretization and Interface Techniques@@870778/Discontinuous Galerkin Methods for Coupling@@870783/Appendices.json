{"hands_on_practices": [{"introduction": "The power of Discontinuous Galerkin methods lies in how they handle communication across element boundaries. This is achieved through a \"numerical flux,\" which approximates the solution of a local conservation law at the interface. This foundational exercise guides you through the process of deriving the celebrated Godunov numerical flux from first principles for a nonlinear problem, revealing how it intrinsically provides the necessary numerical dissipation to ensure a stable and physically meaningful solution [@problem_id:3401198]. Understanding this mechanism is the first step toward mastering the art of building robust DG schemes for complex coupled systems.", "problem": "Consider the scalar conservation law Burgers’ equation $u_{t} + (f(u))_{x} = 0$ with $f(u) = \\frac{u^{2}}{2}$. In a one-dimensional Discontinuous Galerkin (DG) method, the inter-element coupling is effected via a numerical flux at each interface. The Godunov numerical flux is defined as the physical flux evaluated at the state of the exact self-similar Riemann solution at the interface $x=0$ for the initial data $u(x,0) = u^{-}$ for $x<0$ and $u(x,0) = u^{+}$ for $x>0$. Starting from the fundamental principles for scalar conservation laws, namely (i) Rankine–Hugoniot jump condition for shocks, (ii) Lax entropy condition for admissible discontinuities, and (iii) method of characteristics for rarefactions, derive the explicit analytic expression of the Godunov flux $F_{G}(u^{-},u^{+})$ in terms of $u^{-}$ and $u^{+}$ for Burgers’ equation. Then, explain how using this flux in the DG method at interfaces yields a discrete entropy (quadratic entropy) inequality and stabilizes the semi-discrete scheme by dissipating inter-element jumps.\n\nYour final answer must be the single closed-form analytic expression for $F_{G}(u^{-},u^{+})$. No numerical evaluation is required.", "solution": "The problem requires the derivation of the Godunov numerical flux for Burgers' equation, followed by an explanation of its role in ensuring entropy stability in a Discontinuous Galerkin (DG) framework.\n\nThe scalar conservation law under consideration is Burgers' equation:\n$$\nu_{t} + \\left(\\frac{u^2}{2}\\right)_x = 0\n$$\nwhere the flux function is $f(u) = \\frac{u^2}{2}$. The characteristic speed is given by $c(u) = f'(u) = u$.\n\nThe Godunov numerical flux, $F_{G}(u^{-},u^{+})$, is defined as the physical flux evaluated at the self-similar solution of the Riemann problem at the interface location $x=0$. The Riemann problem is defined by the initial condition:\n$$\nu(x,0) = \\begin{cases} u^{-} & x < 0 \\\\ u^{+} & x > 0 \\end{cases}\n$$\nThe solution to this problem, $u(x,t)$, is a function of the similarity variable $\\xi = x/t$. The Godunov flux is then $F_{G}(u^{-},u^{+}) = f(u(0,t)) = f(u(\\xi=0))$. We must analyze the solution based on the relationship between $u^{-}$ and $u^{+}$.\n\n**Part 1: Derivation of the Godunov Flux $F_{G}(u^{-},u^{+})$**\n\nThe nature of the Riemann solution depends on whether characteristics are diverging or converging.\n\n**Case 1: Rarefaction Wave ($u^{-} < u^{+}$)**\nThe characteristics with speeds $c(u)=u$ are diverging from the origin, creating a continuous solution known as a rarefaction wave. The solution is given by:\n$$\nu(x,t) = \\begin{cases} u^{-} & \\text{for } x/t < u^{-} \\\\ x/t & \\text{for } u^{-} \\le x/t \\le u^{+} \\\\ u^{+} & \\text{for } x/t > u^{+} \\end{cases}\n$$\nThe state at the interface, $u(\\xi=0)$, is found by evaluating this solution at $x/t=0$.\n- If $u^{-} < 0 < u^{+}$, the interface state is $u(0,t)=0$. The flux is $F_{G} = f(0) = 0$.\n- If $0 \\le u^{-} < u^{+}$, the characteristics have positive speeds, so they all move to the right. The region $x<0$ remains in state $u^{-}$, thus the interface state is $u(0,t)=u^{-}$. The flux is $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$.\n- If $u^{-} < u^{+} \\le 0$, the characteristics have negative speeds, so they all move to the left. The region $x>0$ remains in state $u^{+}$, thus the interface state is $u(0,t)=u^{+}$. The flux is $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$.\n\nThese three sub-cases for the rarefaction wave can be summarized elegantly. The flux function $f(u) = u^2/2$ is convex, with a global minimum at $u=0$. The value of the Godunov flux in a rarefaction corresponds to the value of the physical flux at the point that minimizes $f(u)$ over the interval $[u^{-}, u^{+}]$. That is, for $u^{-} < u^{+}$,\n$$\nF_{G}(u^{-},u^{+}) = \\min_{u \\in [u^{-}, u^{+}]} f(u)\n$$\n\n**Case 2: Shock Wave ($u^{-} > u^{+}$)**\nThe characteristics are converging, which leads to the formation of a discontinuity, or shock. The speed of this shock, $s$, is determined by the Rankine-Hugoniot jump condition:\n$$\ns = \\frac{[f]}{[u]} = \\frac{f(u^{+}) - f(u^{-})}{u^{+} - u^{-}}\n$$\nFor Burgers' equation, this yields:\n$$\ns = \\frac{\\frac{(u^{+})^2}{2} - \\frac{(u^{-})^2}{2}}{u^{+} - u^{-}} = \\frac{(u^{+} - u^{-})(u^{+} + u^{-})}{2(u^{+} - u^{-})} = \\frac{u^{-} + u^{+}}{2}\n$$\nA shock is physically admissible only if it satisfies the Lax entropy condition, which states that characteristics must enter the shock from both sides: $f'(u^{-}) > s > f'(u^{+})$. For Burgers' equation, this is $u^{-} > s > u^{+}$.\n- $u^{-} > \\frac{u^{-} + u^{+}}{2} \\implies 2u^{-} > u^{-} + u^{+} \\implies u^{-} > u^{+}$\n- $\\frac{u^{-} + u^{+}}{2} > u^{+} \\implies u^{-} + u^{+}> 2u^{+} \\implies u^{-} > u^{+}$\nThe condition is satisfied for any $u^{-} > u^{+}$, so all such shocks are admissible.\n\nThe state at the interface $x=0$ depends on the direction of shock propagation, determined by the sign of $s$.\n- If $s > 0$ (i.e., $u^{-} + u^{+} > 0$), the shock propagates to the right. For $t>0$, the state at $x=0$ is the left state, $u^{-}$. The flux is $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$.\n- If $s < 0$ (i.e., $u^{-} + u^{+} < 0$), the shock propagates to the left. For $t>0$, the state at $x=0$ is the right state, $u^{+}$. The flux is $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$.\n- If $s = 0$ (i.e., $u^{-} + u^{+} = 0$), the shock is stationary at $x=0$. The Rankine-Hugoniot condition implies $f(u^{+}) - f(u^{-}) = 0$, so $f(u^{-}) = f(u^{+})$. The flux is continuous across the shock, and we can take either value. Note that $f(u^{-}) = f(-u^{+}) = \\frac{(-u^{+})^2}{2} = \\frac{(u^{+})^2}{2} = f(u^{+})$. Our convention for $s \\le 0$ correctly selects $f(u^{+})$.\n\nWe can express these sub-cases for the shock wave in a compact form. The sign of $f(u^{-}) - f(u^{+}) = \\frac{1}{2}(u^{-}-u^{+})(u^{-}+u^{+})$ depends on the sign of $u^{-}+u^{+}$, since $u^{-}-u^{+}>0$.\n- If $u^{-}+u^{+} > 0$, then $f(u^{-}) > f(u^{+})$, so $F_{G} = f(u^{-}) = \\max(f(u^{-}), f(u^{+}))$.\n- If $u^{-}+u^{+} < 0$, then $f(u^{-}) < f(u^{+})$, so $F_{G} = f(u^{+}) = \\max(f(u^{-}), f(u^{+}))$.\nSince $f(u)=u^2/2$ is convex, its maximum on an interval $[u^{+}, u^{-}]$ must occur at an endpoint. Thus, for $u^{-} > u^{+}$,\n$$\nF_{G}(u^{-},u^{+}) = \\max(f(u^{-}), f(u^{+}))\n$$\n\n**Explicit Analytic Expression for $F_{G}(u^{-},u^{+})$**\nCombining all cases, we arrive at the explicit piecewise definition of the Godunov flux for Burgers' equation:\n$$\nF_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right) & \\text{if } u^{-} > u^{+} \\\\ \\frac{(u^{-})^2}{2} & \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0 & \\text{if } u^{-} < 0 < u^{+} \\\\ \\frac{(u^{+})^2}{2} & \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}\n$$\nNote that the case $u^{-}=u^{+}$ is consistent, as $F_G(u,u) = f(u)$.\n\n**Part 2: Entropy Stability and Scheme Stabilization**\n\nThe use of the Godunov flux in a DG scheme ensures that a discrete version of the entropy inequality is satisfied, thereby guaranteeing the nonlinear stability of the semi-discrete scheme.\n\nFor a convex entropy function $U(u)$ and corresponding entropy flux $Q(u)$ (where $Q'(u) = U'(u)f'(u)$), the continuous entropy inequality is $U(u)_t + Q(u)_x \\le 0$. For Burgers' equation, the quadratic entropy is $U(u) = u^2/2$, for which $U'(u)=u$ and the entropy flux is $Q(u) = u^3/3$.\n\nIn a DG scheme, summing the local weak formulation over all elements and choosing the test function $v_h = U'(u_h) = u_h$ leads to an evolution equation for the total entropy $\\mathcal{E}(t) = \\int_{\\Omega} U(u_h) dx$. The rate of change of total entropy is determined by the sum of contributions from each inter-element interface. The contribution from the interface between states $u^{-}$ and $u^{+}$ is the numerical entropy dissipation:\n$$\n\\mathcal{D}(u^{-}, u^{+}) = F_G(u^{-}, u^{+}) [U'] - [Q] = F_G(u^{-}, u^{+})(u^{+} - u^{-}) - \\left(\\frac{(u^{+})^3}{3} - \\frac{(u^{-})^3}{3}\\right)\n$$\nThe semi-discrete scheme is entropy stable if this term is non-positive, i.e., $\\mathcal{D}(u^{-}, u^{+}) \\le 0$, at every interface. This would imply $\\frac{d\\mathcal{E}}{dt} \\le 0$.\n\nThe Godunov flux is an \"E-flux,\" a class of numerical fluxes known to be entropy-satisfying. An E-flux satisfies the property that $(u^{-} - u^{+})(F_G(u^{-},u^{+}) - f(u)) \\ge 0$ for all values of $u$ on the path between $u^{-}$ and $u^{+}$. As shown in Part 1, the Godunov flux for Burgers' equation is $F_G = \\max f$ for shocks ($u^{-}>u^{+}$) and $F_G = \\min f$ for rarefactions ($u^{-}<u^{+}$), which directly satisfies this condition. This property is sufficient to prove that $\\mathcal{D}(u^{-}, u^{+}) \\le 0$.\n\nThis dissipation mechanism is what stabilizes the scheme. Inter-element jumps $[u] = u^+ - u^-$ are sources of potential instability, especially for under-resolved shocks which manifest as oscillations. The Godunov flux introduces a precise amount of numerical dissipation—no more and no less than what is present in the exact solution of the local Riemann problem.\n- For a rarefaction ($u^{-}<u^{+}$), the exact solution is smooth and entropy is conserved. The Godunov flux is constructed to yield zero numerical entropy dissipation in this case (apart from spatial discretization errors within the element).\n- For a shock ($u^{-}>u^{+}$), the exact solution is discontinuous and produces entropy. The Godunov flux mimics this physical dissipation by satisfying $\\mathcal{D}(u^{-}, u^{+}) < 0$, effectively damping oscillations that would arise from the jump and ensuring the correct shock propagation.\n\nIn conclusion, the Godunov flux stabilizes the DG scheme by building in the physical mechanism of entropy production at discontinuities, preventing the growth of non-physical oscillations and ensuring the solution converges to the weak, entropy-satisfying solution of the PDE.", "answer": "$$\n\\boxed{F_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right) & \\text{if } u^{-} > u^{+} \\\\ \\frac{(u^{-})^2}{2} & \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0 & \\text{if } u^{-} < 0 < u^{+} \\\\ \\frac{(u^{+})^2}{2} & \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}}\n$$", "id": "3401198"}, {"introduction": "Before using a numerical method for discovery, we must first verify that our code is correct. The Method of Manufactured Solutions (MMS) is a rigorous mathematical technique for code verification, where we construct a problem for which the exact solution is known. This practice provides essential hands-on experience by having you build a manufactured solution for a coupled, multi-domain physics problem [@problem_id:3504002]. Successfully completing this task demonstrates a deep understanding of the interface physics and is a critical skill for developing trustworthy simulation tools.", "problem": "Consider a one-dimensional two-field diffusion model on the composite domain $\\Omega = \\Omega_{1} \\cup \\Omega_{2}$ with $\\Omega_{1} = [-1,0]$ and $\\Omega_{2} = [0,1]$. Each subdomain hosts a scalar field $u_{i}(x)$, governed by the steady diffusion–reaction equation\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(k_{i}\\,\\frac{\\mathrm{d}u_{i}}{\\mathrm{d}x}\\right) + r_{i}\\,u_{i} = f_{i}(x) \\quad \\text{in } \\Omega_{i}, \\quad i \\in \\{1,2\\},\n$$\nwhere $k_{i} > 0$ are constant diffusivities and $r_{i} \\ge 0$ are constant reaction coefficients. At the interface $x=0$, the two fields exchange through a linear Robin-type condition that enforces flux continuity with an interfacial conductance $h>0$:\n$$\n- k_{1}\\,u_{1}'(0^{-}) \\,=\\, h\\big(u_{1}(0) - u_{2}(0)\\big), \n\\qquad\nk_{2}\\,u_{2}'(0^{+}) \\,=\\, h\\big(u_{1}(0) - u_{2}(0)\\big).\n$$\nOn the external boundaries, impose Dirichlet conditions $u_{1}(-1) = 0.3$ and $u_{2}(1) = -0.1$. You are to construct a pair of manufactured solutions that satisfy these interface and boundary conditions exactly, so they can be used to verify a Discontinuous Galerkin (DG) coupling method (for example, the Symmetric Interior Penalty (SIP) formulation) for flux consistency and penalty scaling across heterogeneous subdomains.\n\nLet the diffusivities and interfacial conductance be fixed at $k_{1} = 2$, $k_{2} = 5$, and $h = 4$. Consider the following manufactured ansatz with unknown constants $A, B, C, D$:\n$$\nu_{1}(x) = \\exp(x) + A\\,x + C \\quad \\text{for } x \\in [-1,0], \n\\qquad\nu_{2}(x) = \\cosh(x) + B\\,x + D \\quad \\text{for } x \\in [0,1].\n$$\nDetermine the unique constants $A, B, C, D$ such that the interface exchange conditions at $x=0$ and the boundary conditions at $x=-1$ and $x=1$ hold exactly. These values define a manufactured cross-coupled solution pair suitable for a DG verification study on flux consistency and penalty scaling across the interface.\n\nAnswer format requirement: Provide your final result as a single row matrix $\\big[A \\;\\; B \\;\\; C \\;\\; D\\big]$. No rounding is required; report the exact expressions.", "solution": "The objective is to find the unique constants $A, B, C, D$ by enforcing the boundary and interface conditions on the given manufactured solution forms.\n\nThe manufactured solutions and their derivatives are:\n$$\n\\begin{aligned}\nu_{1}(x) &= \\exp(x) + A\\,x + C & \\implies u_{1}'(x) &= \\exp(x) + A \\\\\nu_{2}(x) &= \\cosh(x) + B\\,x + D & \\implies u_{2}'(x) &= \\sinh(x) + B\n\\end{aligned}\n$$\nWe apply the four conditions to derive a system of four linear equations for the four unknowns.\n\n**1. External Boundary Conditions:**\n- At $x=-1$: $u_{1}(-1) = \\exp(-1) - A + C = 0.3 \\implies -A + C = \\frac{3}{10} - \\exp(-1) \\quad \\text{(I)}$\n- At $x=1$: $u_{2}(1) = \\cosh(1) + B + D = -0.1 \\implies B + D = -\\frac{1}{10} - \\cosh(1) \\quad \\text{(II)}$\n\n**2. Interface Conditions at $x=0$:**\nFirst, evaluate the solution and derivative traces at $x=0$:\n$u_{1}(0) = 1+C$, $u_{2}(0) = 1+D$, $u_{1}'(0) = 1+A$, $u_{2}'(0) = B$.\nThe interface conditions, with $k_{1}=2, k_{2}=5, h=4$, become:\n$$\n\\begin{aligned}\n-2(1+A) &= 4((1+C) - (1+D)) = 4(C-D) \\\\\n5B &= 4((1+C) - (1+D)) = 4(C-D)\n\\end{aligned}\n$$\nThe right-hand sides are identical. Equating the left-hand sides gives a direct relationship between $A$ and $B$:\n$$ -2(1+A) = 5B \\implies 2A + 5B = -2 \\quad \\text{(III)} $$\nWe need one more independent equation. We can use either of the interface conditions, for example, $-2(1+A) = 4(C-D) \\implies A + 2C - 2D = -1 \\quad \\text{(IV)}$.\n\n**3. Solving the Linear System:**\nWe have a system of four equations: (I), (II), (III), and (IV). We solve it by substitution. From (I) and (II), express $C$ and $D$ in terms of $A$ and $B$:\n$$ C = A + \\frac{3}{10} - \\exp(-1) $$\n$$ D = -B - \\frac{1}{10} - \\cosh(1) $$\nSubstitute these into equation (IV):\n$$ A + 2\\left(A + \\frac{3}{10} - \\exp(-1)\\right) - 2\\left(-B - \\frac{1}{10} - \\cosh(1)\\right) = -1 $$\n$$ A + 2A + \\frac{6}{10} - 2\\exp(-1) + 2B + \\frac{2}{10} + 2\\cosh(1) = -1 $$\n$$ 3A + 2B + \\frac{8}{10} = -1 + 2\\exp(-1) - 2\\cosh(1) $$\n$$ 3A + 2B = -\\frac{18}{10} + 2\\exp(-1) - 2\\cosh(1) = -\\frac{9}{5} + 2\\exp(-1) - 2\\cosh(1) \\quad \\text{(V)} $$\nNow we solve the $2 \\times 2$ system for $A$ and $B$ given by (III) and (V).\n- Multiply (III) by 3: $6A + 15B = -6$\n- Multiply (V) by -2: $-6A - 4B = \\frac{18}{5} - 4\\exp(-1) + 4\\cosh(1)$\nAdding these two equations eliminates $A$:\n$$ 11B = -6 + \\frac{18}{5} - 4\\exp(-1) + 4\\cosh(1) = -\\frac{12}{5} - 4\\exp(-1) + 4\\cosh(1) $$\n$$ \\implies B = -\\frac{12}{55} - \\frac{4}{11}\\exp(-1) + \\frac{4}{11}\\cosh(1) $$\nSubstitute $B$ into (III) to find $A$:\n$$ 2A = -2 - 5B = -2 - 5\\left(-\\frac{12}{55} - \\frac{4}{11}\\exp(-1) + \\frac{4}{11}\\cosh(1)\\right) $$\n$$ 2A = -2 + \\frac{12}{11} + \\frac{20}{11}\\exp(-1) - \\frac{20}{11}\\cosh(1) = -\\frac{10}{11} + \\frac{20}{11}\\exp(-1) - \\frac{20}{11}\\cosh(1) $$\n$$ \\implies A = -\\frac{5}{11} + \\frac{10}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1) $$\nFinally, substitute $A$ and $B$ back into the expressions for $C$ and $D$ to find their values.\n$$ C = \\left(-\\frac{5}{11} + \\frac{10}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1)\\right) + \\frac{3}{10} - \\exp(-1) = -\\frac{17}{110} - \\frac{1}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1) $$\n$$ D = -\\left(-\\frac{12}{55} - \\frac{4}{11}\\exp(-1) + \\frac{4}{11}\\cosh(1)\\right) - \\frac{1}{10} - \\cosh(1) = \\frac{13}{110} + \\frac{4}{11}\\exp(-1) - \\frac{15}{11}\\cosh(1) $$\nThis completes the derivation of the four constants.", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{5}{11} + \\frac{10}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1) & -\\frac{12}{55} - \\frac{4}{11}\\exp(-1) + \\frac{4}{11}\\cosh(1) & -\\frac{17}{110} - \\frac{1}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1) & \\frac{13}{110} + \\frac{4}{11}\\exp(-1) - \\frac{15}{11}\\cosh(1) \\end{pmatrix} } $$", "id": "3504002"}, {"introduction": "As simulation complexity grows, the efficiency of the linear solver becomes paramount. The Hybridizable Discontinuous Galerkin (HDG) method is an advanced variant that reformulates the problem to produce a much smaller and better-structured global system, making it more amenable to fast solvers. This problem delves into the algebraic structure of the HDG method, showing how static condensation leads to an \"interface-focused\" system [@problem_id:3504028]. By deriving a preconditioner based on the Schur complement, you will bridge the gap between numerical analysis and high-performance computing, a vital step for tackling large-scale multiphysics simulations.", "problem": "Consider a steady coupled diffusion-reaction model on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$, partitioned into two non-overlapping subdomains $\\Omega_{1}$ and $\\Omega_{2}$ with common interface $\\Gamma := \\partial \\Omega_{1} \\cap \\partial \\Omega_{2}$. The governing laws for each subdomain are conservation of flux and linear reaction:\n- On $\\Omega_{1}$: $\\nabla \\cdot \\left(-\\kappa_{1} \\nabla u_{1}\\right) + \\alpha_{1} u_{1} = f_{1}$,\n- On $\\Omega_{2}$: $\\nabla \\cdot \\left(-\\kappa_{2} \\nabla u_{2}\\right) + \\alpha_{2} u_{2} = f_{2}$,\nwhere $\\kappa_{i} > 0$ are symmetric positive definite diffusion tensors, $\\alpha_{i} \\ge 0$ are reaction coefficients, and $f_{i} \\in L^{2}(\\Omega_{i})$ are source terms. Across the interface $\\Gamma$, impose continuity via a skeleton trace field $\\hat{u}$ with numerical flux stabilization of magnitude $\\eta > 0$:\n- On $\\Gamma$ from $\\Omega_{1}$: $-\\kappa_{1} \\nabla u_{1} \\cdot n_{1} + \\eta \\left(u_{1} - \\hat{u}\\right) = 0$,\n- On $\\Gamma$ from $\\Omega_{2}$: $-\\kappa_{2} \\nabla u_{2} \\cdot n_{2} + \\eta \\left(u_{2} - \\hat{u}\\right) = 0$,\nwhere $n_{i}$ is the outward unit normal of $\\Omega_{i}$ on $\\Gamma$. On $\\partial \\Omega \\setminus \\Gamma$, assume appropriate boundary conditions compatible with the Hybridizable Discontinuous Galerkin (HDG) method, which are not needed explicitly here.\n\nDiscretize the model with the Hybridizable Discontinuous Galerkin (HDG) method on a conforming simplicial mesh that is matching across $\\Gamma$. Introduce elementwise interior unknowns $u_{1}$ and $u_{2}$ and their fluxes, together denoted as local vectors, and skeleton trace unknowns $\\lambda$ living on the mesh skeleton, including $\\Gamma$. After assembling the linear system and performing static condensation of the elementwise interior degrees of freedom, the global coupled algebraic system can be written in the following block form for the unknown vector $(x_{1}, x_{2}, y)$, where $x_{i}$ are condensed interior vectors on $\\Omega_{i}$ and $y$ are the skeleton trace degrees of freedom:\n$$\n\\begin{pmatrix}\nA_{1} & 0 & B_{1}^{\\top} \\\\\n0 & A_{2} & B_{2}^{\\top} \\\\\nB_{1} & B_{2} & D\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1} \\\\\nx_{2} \\\\\ny\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb_{1} \\\\\nb_{2} \\\\\nc\n\\end{pmatrix},\n$$\nwhere $A_{i}$ are subdomain-local condensed stiffness matrices (symmetric positive definite), $B_{i}$ are local-to-skeleton coupling matrices, and $D$ is the skeleton stabilization and interface coupling matrix induced by the numerical fluxes and boundary conditions. All blocks are assumed to be of compatible dimensions and the system is symmetric.\n\nStarting from the governing partial differential equations and the definition of the Hybridizable Discontinuous Galerkin (HDG) method, first derive the above block structure by identifying the role of each block from the local variational problems and the skeleton coupling. Then, analyze how hybridization enables interface-focused preconditioning by forming the exact Schur complement with respect to the skeleton trace unknowns $y$. Using this analysis, propose a domain-interface preconditioner that exploits the HDG trace unknowns, built from exact local subdomain inverses and the exact skeleton Schur complement. Express your proposed preconditioner as a single closed-form analytic matrix expression in terms of $A_{1}$, $A_{2}$, $B_{1}$, $B_{2}$, and $D$. Your final answer must be this expression only. If you introduce auxiliary operators in your derivation, eliminate them in the final expression by writing them explicitly in terms of the given blocks. No numerical approximation is required.", "solution": "The problem asks for two main tasks: first, to explain the origin of the block structure of the HDG system matrix, and second, to derive a preconditioner based on the Schur complement.\n\nLet the global system matrix be denoted by $\\mathcal{A}$.\n$$\n\\mathcal{A} =\n\\begin{pmatrix}\nA_{1} & 0 & B_{1}^{\\top} \\\\\n0 & A_{2} & B_{2}^{\\top} \\\\\nB_{1} & B_{2} & D\n\\end{pmatrix}\n$$\nThe vector of unknowns is partitioned into interior unknowns for each subdomain, $x_{1}$ and $x_{2}$, and the skeleton trace unknowns, $y$.\n\n**1. Origin of the Matrix Blocks**\n\nThe Hybridizable Discontinuous Galerkin (HDG) method discretizes the problem by introducing separate unknowns for the solution within each mesh element, and a single-valued trace variable on the mesh skeleton (the faces of the elements).\n- The matrices **$A_{1}$ and $A_{2}$** represent the discretized PDE operators within each subdomain, $\\Omega_1$ and $\\Omega_2$, respectively. They are block-diagonal with respect to the mesh elements. The zero off-diagonal blocks in the top-left part of $\\mathcal{A}$ signify that the interior variables in $\\Omega_1$ are not directly coupled to the interior variables in $\\Omega_2$; all coupling is mediated by the skeleton variable $y$. The problem states that $A_i$ are symmetric positive definite, a standard property for this type of discretization.\n- The matrices **$B_{1}$ and $B_{2}$** (and their transposes) represent the coupling between the element-interior unknowns ($x_{i}$) and the skeleton trace unknowns ($y$). These blocks arise from the integral terms on element boundaries that appear during integration by parts in the weak formulation. They relate the traces of the interior solution and flux to the hybrid trace variable.\n- The matrix **$D$** represents the direct coupling between the skeleton trace unknowns themselves. These terms arise from enforcing the transmission conditions across element faces, including the flux continuity and the specific interface conditions on $\\Gamma$. For instance, the penalty term $\\eta(u_i - \\hat{u})$ on $\\Gamma$, when tested against a trace test function, contributes terms involving only the skeleton unknowns $y$.\n\n**2. Hybridization and the Schur Complement**\n\nThe key advantage of the HDG method is that the element-interior unknowns can be eliminated locally via a procedure known as **static condensation**. This leads to a smaller global system solely in terms of the skeleton trace unknowns $y$. This is evident from the first two block rows of the linear system:\n$$ A_{1} x_{1} + B_{1}^{\\top} y = b_{1} \\implies x_{1} = A_{1}^{-1} (b_{1} - B_{1}^{\\top} y) $$\n$$ A_{2} x_{2} + B_{2}^{\\top} y = b_{2} \\implies x_{2} = A_{2}^{-1} (b_{2} - B_{2}^{\\top} y) $$\nThe inversion of $A_i$ is computationally inexpensive as it corresponds to solving small, independent linear systems on each mesh element.\n\nSubstituting these expressions into the third block row, $B_{1} x_{1} + B_{2} x_{2} + D y = c$, yields the Schur complement system:\n$$ B_{1} \\left( A_{1}^{-1} (b_{1} - B_{1}^{\\top} y) \\right) + B_{2} \\left( A_{2}^{-1} (b_{2} - B_{2}^{\\top} y) \\right) + D y = c $$\nRearranging the terms to isolate the unknown vector $y$ gives:\n$$ \\left( D - B_{1} A_{1}^{-1} B_{1}^{\\top} - B_{2} A_{2}^{-1} B_{2}^{\\top} \\right) y = c - B_{1} A_{1}^{-1} b_{1} - B_{2} A_{2}^{-1} b_{2} $$\nThe matrix $S = D - B_{1} A_{1}^{-1} B_{1}^{\\top} - B_{2} A_{2}^{-1} B_{2}^{\\top}$ is the **Schur complement** of the system with respect to the trace unknowns $y$.\n\n**3. A Domain-Interface Preconditioner**\n\nThe problem asks for a preconditioner $\\mathcal{P}$ for the full system $\\mathcal{A}$ that is built from the exact local inverses $A_{i}^{-1}$ and the exact Schur complement $S$. A highly effective preconditioner can be constructed from the block LDU factorization of $\\mathcal{A}$. A standard choice, which corresponds to one step of block Gaussian elimination, is the block upper-triangular matrix:\n$$\n\\mathcal{P} =\n\\begin{pmatrix}\nA_{1} & 0 & B_{1}^{\\top} \\\\\n0 & A_{2} & B_{2}^{\\top} \\\\\n0 & 0 & S\n\\end{pmatrix}\n$$\nThis preconditioner is exact in the first two block rows and uses the exact Schur complement for the final block row, making it very powerful for iterative solvers. Substituting the expression for the Schur complement $S$ gives the final form of the preconditioner.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nA_{1} & 0 & B_{1}^{\\top} \\\\\n0 & A_{2} & B_{2}^{\\top} \\\\\n0 & 0 & D - B_{1} A_{1}^{-1} B_{1}^{\\top} - B_{2} A_{2}^{-1} B_{2}^{\\top}\n\\end{pmatrix}\n}\n$$", "id": "3504028"}]}