{"hands_on_practices": [{"introduction": "While many introductory problems assume isotropic materials, advanced engineering materials such as composites and crystals often exhibit direction-dependent thermal properties. This practice solidifies the understanding of Fourier's law in its most general, tensorial form. By deriving the transformation rules for the thermal conductivity tensor, you will gain a foundational skill for modeling heat transfer in anisotropic media, a key topic in continuum mechanics. [@problem_id:3508533]", "problem": "Consider a crystalline solid that exhibits orthotropic symmetry in thermal conduction, meaning there exist three mutually orthogonal crystal directions along which heat conduction is decoupled. Let the crystal frame be defined by the orthonormal basis $\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$, in which the thermal conductivity tensor is diagonal with principal conductivities $k_{1}$, $k_{2}$, and $k_{3}$. Let the laboratory frame be defined by the orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$, related to the crystal frame by a proper orthogonal rotation matrix $\\mathbf{R}$, with components $R_{ij} = \\mathbf{e}_{i} \\cdot \\mathbf{E}_{j}$, satisfying $\\mathbf{R}^{\\top}\\mathbf{R} = \\mathbf{I}$ and $\\det(\\mathbf{R}) = 1$. Assume steady-state heat conduction in the absence of advection and radiation, with a volumetric heat source $\\dot{q}(\\mathbf{x})$.\n\nStarting from the First Law of Thermodynamics (energy conservation) in local differential form and the requirement from the Second Law of Thermodynamics (Clausius–Duhem inequality) that the linear conductive mapping is dissipative, derive the component form of Fourier’s law in the laboratory frame and determine how the principal conductivities transform under the rotation $\\mathbf{R}$. Your derivation should explicitly use the tensorial nature of the conductivity and the transformation properties of vectors and second-order tensors under rotations.\n\nExpress your final answer as a single row matrix containing:\n- the component form of Fourier’s law in the laboratory frame, and\n- the component expression for the transformed conductivity tensor components in terms of $R_{ij}$ and the principal conductivities $k_{1}$, $k_{2}$, and $k_{3}$.\n\nNo numerical evaluation is required. Provide your final expressions symbolically. If you introduce any auxiliary definitions or operators (such as the gradient), define them clearly. Round-off instructions are not applicable because no numerical computation is requested.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- A crystalline solid with orthotropic symmetry in thermal conduction.\n- Crystal frame basis: $\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$, orthonormal.\n- Thermal conductivity tensor in the crystal frame is diagonal, with principal conductivities $k_{1}$, $k_{2}$, and $k_{3}$.\n- Laboratory frame basis: $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$, orthonormal.\n- Rotation matrix $\\mathbf{R}$ relates the frames, with components $R_{ij} = \\mathbf{e}_{i} \\cdot \\mathbf{E}_{j}$.\n- Properties of $\\mathbf{R}$: proper orthogonal, i.e., $\\mathbf{R}^{\\top}\\mathbf{R} = \\mathbf{I}$ and $\\det(\\mathbf{R}) = 1$.\n- Physical conditions: steady-state heat conduction, no advection, no radiation.\n- A volumetric heat source $\\dot{q}(\\mathbf{x})$ is present.\n- Starting principles: First Law of Thermodynamics (energy conservation) and Second Law of Thermodynamics (Clausius–Duhem inequality, expressed as dissipation).\n- Task: Derive the component form of Fourier’s law in the laboratory frame.\n- Task: Derive the component expression for the transformed conductivity tensor components in terms of $R_{ij}$ and principal conductivities $k_{1}, k_{2}, k_{3}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on fundamental principles of continuum mechanics, thermodynamics, and tensor analysis as applied to heat transfer in anisotropic materials. These concepts are standard in physics and engineering.\n- **Well-Posed**: The problem is clearly specified. It asks for the derivation of standard results in the field, with all necessary information provided. A unique analytical solution exists.\n- **Objective**: The language is precise, technical, and free of any subjectivity or ambiguity.\n- **Flaw Checklist**: The problem does not violate any of the specified flaw criteria. It is scientifically sound, formalizable, complete, realistic, well-posed, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Derivation\nThe derivation begins with the fundamental laws of thermodynamics. Throughout this derivation, the Einstein summation convention is assumed for repeated indices, unless a summation symbol is explicitly written. We denote vectors and tensors with boldface type.\n\nThe First Law of Thermodynamics, representing the conservation of energy, for a control volume at steady state and in the absence of mechanical work or advection, states that the net rate of heat entering the volume must be balanced by the rate of heat generated within it. In local differential form, this is expressed as:\n$$ \\nabla \\cdot \\mathbf{q} = \\dot{q}(\\mathbf{x}) $$\nwhere $\\mathbf{q}$ is the heat flux vector, $\\dot{q}$ is the volumetric heat source, and $\\nabla \\cdot$ is the divergence operator.\n\nThe Second Law of Thermodynamics, in the form of the Clausius–Duhem inequality, requires that the rate of local entropy production must be non-negative. For a process of pure heat conduction, this inequality reduces to:\n$$ -\\frac{1}{T^2} (\\mathbf{q} \\cdot \\nabla T) \\ge 0 $$\nwhere $T$ is the absolute temperature. As the temperature must be positive, $T>0$, this simplifies to the dissipation inequality:\n$$ -\\mathbf{q} \\cdot \\nabla T \\ge 0 $$\nThis fundamental constraint dictates that heat cannot flow from a colder region to a hotter region. To satisfy this for any possible temperature gradient, a linear constitutive model relating the heat flux $\\mathbf{q}$ and the temperature gradient $\\nabla T$ must be of the form:\n$$ \\mathbf{q} = -\\mathbf{K} \\nabla T $$\nwhere $\\mathbf{K}$ is the second-order thermal conductivity tensor. The dissipation inequality requires that the tensor $\\mathbf{K}$ be positive-definite.\n\nWe now express this relationship in the laboratory frame, which has the orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$. The components of a vector $\\mathbf{v}$ are $v_i = \\mathbf{v} \\cdot \\mathbf{e}_i$, and the components of a second-order tensor $\\mathbf{T}$ are $T_{ij} = \\mathbf{e}_i \\cdot (\\mathbf{T} \\mathbf{e}_j)$.\nThe components of the heat flux vector $\\mathbf{q}$ are $q_i$.\nThe components of the temperature gradient vector $\\nabla T$ are $(\\nabla T)_j = \\frac{\\partial T}{\\partial x_j}$, where $x_j$ are the coordinates in the laboratory frame.\nThe components of the thermal conductivity tensor $\\mathbf{K}$ in this frame are $K_{ij}$.\n\nWriting the vector equation $\\mathbf{q} = -\\mathbf{K} \\nabla T$ in component form, we get:\n$$ q_i = -K_{ij} \\frac{\\partial T}{\\partial x_j} $$\nThis is the component form of Fourier's law in the laboratory frame, which is the first required expression. The summation over the index $j$ from $1$ to $3$ is implied.\n\nNext, we must find the expression for the components $K_{ij}$ in terms of the principal conductivities $k_1, k_2, k_3$ and the rotation matrix $\\mathbf{R}$.\nThe problem states that in the crystal frame, with orthonormal basis $\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$, the conductivity tensor is diagonal. This means that the basis vectors of the crystal frame are the eigenvectors of the tensor $\\mathbf{K}$. We can write the tensor $\\mathbf{K}$ in its spectral decomposition form:\n$$ \\mathbf{K} = k_1 \\mathbf{E}_1 \\otimes \\mathbf{E}_1 + k_2 \\mathbf{E}_2 \\otimes \\mathbf{E}_2 + k_3 \\mathbf{E}_3 \\otimes \\mathbf{E}_3 $$\nThe components of $\\mathbf{K}$ in the crystal frame, denoted $K'_{mn} = \\mathbf{E}_m \\cdot (\\mathbf{K} \\mathbf{E}_n)$, are therefore given by a diagonal matrix:\n$$ K'_{mn} = \\begin{pmatrix} k_1 & 0 & 0 \\\\ 0 & k_2 & 0 \\\\ 0 & 0 & k_3 \\end{pmatrix} $$\nThis can be written compactly using the Kronecker delta as $K'_{mn} = k_m \\delta_{mn}$, where no summation over $m$ is implied.\n\nThe components of a second-order tensor transform from one orthonormal basis to another according to the following transformation law:\n$$ K_{ij} = R_{im} R_{jn} K'_{mn} $$\nHere, $R_{im} = \\mathbf{e}_i \\cdot \\mathbf{E}_m$ are the components of the rotation matrix $\\mathbf{R}$ that maps components from the crystal frame to the laboratory frame. The indices $m$ and $n$ are summed from $1$ to $3$.\n\nWe substitute the component form of the tensor in the crystal frame, $K'_{mn} = k_m \\delta_{mn}$, into the transformation law:\n$$ K_{ij} = \\sum_{m=1}^{3} \\sum_{n=1}^{3} R_{im} R_{jn} (k_m \\delta_{mn}) $$\nThe Kronecker delta $\\delta_{mn}$ is only non-zero when $m=n$, which collapses one of the summations (over $n$):\n$$ K_{ij} = \\sum_{m=1}^{3} R_{im} R_{jm} k_m $$\nThis equation can be expanded to show the contribution of each principal conductivity:\n$$ K_{ij} = k_1 R_{i1} R_{j1} + k_2 R_{i2} R_{j2} + k_3 R_{i3} R_{j3} $$\nThis is the component expression for the transformed conductivity tensor in the laboratory frame, which is the second required expression. The resulting tensor $\\mathbf{K}$ with components $K_{ij}$ is symmetric ($K_{ij} = K_{ji}$) because the product $R_{im}R_{jm}$ is symmetric in $i$ and $j$. Since the principal conductivities $k_m$ are positive, and $\\mathbf{R}$ is a rotation, the tensor $\\mathbf{K}$ remains positive-definite, as required by the Second Law.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nq_i = -K_{ij} \\frac{\\partial T}{\\partial x_j} & K_{ij} = \\sum_{m=1}^{3} k_{m} R_{im} R_{jm}\n\\end{pmatrix}\n}\n$$", "id": "3508533"}, {"introduction": "Many critical multiphysics problems, from welding to cryogenics, involve phase change at a moving interface. This exercise tackles the classic Stefan problem by employing the Ghost-Fluid Method (GFM), a powerful numerical technique for enforcing jump conditions at sharp, dynamically evolving boundaries. You will implement a quasi-steady model to track the interface motion and quantify how numerical artifacts, like spurious velocities in Volume-of-Fluid (VOF) methods, can impact the global conservation of energy. [@problem_id:3508535]", "problem": "Consider a one-dimensional two-phase heat transfer problem on a fixed domain of length $L_x$ with a sharp moving phase-change interface at position $x_s(t)$. The phases are separated by a discontinuous thermal conductivity $k(x)$, with $k(x) = k_\\ell$ for $x < x_s(t)$ and $k(x) = k_r$ for $x > x_s(t)$. The material density $ \\rho $ and specific heat $ c_p $ are constant and equal in both phases, and the latent heat of phase change per unit mass is $ L $. The governing energy equation in each phase is the conservation of energy, written for Temperature $ T(x,t) $ and a phase indicator function $ C(x,t) $ (equal to $1$ in the left phase and $0$ in the right phase) as\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho L \\frac{\\partial C}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k(x)\\frac{\\partial T}{\\partial x}\\right),\n$$\nsupplemented at the phase-change interface by the continuity of temperature and the Stefan jump condition for heat flux,\n$$\n[T] = 0, \\quad [ -\\mathbf{n} \\cdot k \\nabla T ] = \\rho L V_n,\n$$\nwhere $ [\\cdot] $ denotes the jump across the interface, $ \\mathbf{n} $ is the unit normal pointing from the left phase to the right phase, and $ V_n = \\frac{dx_s}{dt} $ is the normal interface velocity. You are asked to derive a numerically tractable algorithm based on the Ghost-Fluid Method (GFM) and the Volume-of-Fluid (VOF) method to solve this problem under the quasi-steady conduction assumption in each phase. The quasi-steady assumption means that, for each time step, the temperature field in each phase is approximated by a linear profile between boundary temperature and the interfacial temperature.\n\nBase your derivation exclusively on the following fundamental principles and definitions:\n- Conservation of energy in continua, expressed by $ \\rho c_p \\frac{\\partial T}{\\partial t} + \\rho L \\frac{\\partial C}{\\partial t} = \\frac{\\partial}{\\partial x}(k \\frac{\\partial T}{\\partial x}) $.\n- Continuity of temperature at the interface, $ [T] = 0 $.\n- The Stefan condition for latent heat consumption at a moving interface, $ [ -\\mathbf{n} \\cdot k \\nabla T ] = \\rho L V_n $.\n- Piecewise-constant material properties and Dirichlet boundary conditions at the domain ends.\n\nUsing the Ghost-Fluid Method (GFM), treat the interface as an internal Dirichlet boundary with a specified interfacial temperature $ T_m $ (e.g., the melting temperature). In each phase, approximate the temperature profile as linear between the respective domain boundary and $ T_m $. Compute the one-sided interfacial heat fluxes using the one-sided thermal gradients:\n$$\nq_\\ell = k_\\ell \\frac{T_\\ell - T_m}{x_s}, \\quad q_r = k_r \\frac{T_m - T_r}{L_x - x_s},\n$$\nand advance the interface position using the Stefan condition:\n$$\nV_n = \\frac{q_\\ell - q_r}{\\rho L}, \\quad x_s^{n+1} = x_s^n + V_n \\Delta t.\n$$\n\nTo assess the impact of spurious currents typical of interface-capturing Volume-of-Fluid (VOF) discretizations on energy conservation, model an artificial spurious velocity field of magnitude $ U_s $ that advects the VOF interface independently from the Stefan update. In a one-dimensional setting, approximate this by a uniform advective displacement of the VOF-tracked interface:\n$$\nx_{s,\\mathrm{VOF}}^{n+1} = x_{s,\\mathrm{VOF}}^n + U_s \\Delta t.\n$$\n\nDefine the total energy in the domain under the quasi-steady linear profile assumption as the sum of sensible and latent contributions:\n$$\nE(x_s) = \\rho c_p\\left[x_s \\frac{T_\\ell + T_m}{2} + (L_x - x_s)\\frac{T_m + T_r}{2}\\right] + \\rho L x_s,\n$$\nwhere $ T_\\ell $ and $ T_r $ are the boundary temperatures on the left and right ends, respectively. Use this $ E(x_s) $ to compute two energies at the final time: the \"GFM-consistent\" energy $ E(x_s(t_{\\mathrm{end}})) $ and the \"VOF-advected\" energy $ E(x_{s,\\mathrm{VOF}}(t_{\\mathrm{end}})) $. The energy conservation error due to spurious currents will be measured as\n$$\n\\varepsilon = \\left| E\\big(x_{s,\\mathrm{VOF}}(t_{\\mathrm{end}})\\big) - E\\big(x_s(t_{\\mathrm{end}})\\big) \\right|\\quad\\text{(in Joules)}.\n$$\n\nTasks:\n- Derive the above algorithm starting from the conservation of energy and the interfacial jump conditions.\n- Implement the algorithm to simulate the interface position using the Stefan condition and, in parallel, to advect a VOF-tracked interface subject to a prescribed spurious velocity $ U_s $. Compute the energy conservation error $ \\varepsilon $ at the final time using the formula above.\n\nPhysical and numerical units:\n- All lengths must be in meters ($\\mathrm{m}$), time in seconds ($\\mathrm{s}$), temperature in kelvin ($\\mathrm{K}$), density in kilograms per cubic meter ($\\mathrm{kg/m^3}$), specific heat in joules per kilogram-kelvin ($\\mathrm{J/(kg\\cdot K)}$), conductivity in watts per meter-kelvin ($\\mathrm{W/(m\\cdot K)}$), and latent heat in joules per kilogram ($\\mathrm{J/kg}$).\n- Express the final energy conservation error $ \\varepsilon $ in joules ($\\mathrm{J}$) for each test case.\n\nTest suite:\nUse the following set of parameter values (each test case provides $(L_x, x_s^0, T_\\ell, T_r, T_m, \\rho, c_p, k_\\ell, k_r, L, \\Delta t, N_{\\mathrm{steps}}, U_s)$):\n\n1. General \"happy path\" case with no spurious currents:\n   - $ L_x = 1.0 $, $ x_s^0 = 0.6 $, $ T_\\ell = 283.15 $, $ T_r = 263.15 $, $ T_m = 273.15 $, $ \\rho = 1000.0 $, $ c_p = 1000.0 $, $ k_\\ell = 1.0 $, $ k_r = 0.1 $, $ L = 2.5\\times10^5 $, $ \\Delta t = 0.1 $, $ N_{\\mathrm{steps}} = 100 $, $ U_s = 0.0 $.\n\n2. Small spurious currents:\n   - Same as case 1, but $ U_s = 1.0\\times10^{-5} $.\n\n3. Larger spurious currents:\n   - Same as case 1, but $ U_s = 5.0\\times10^{-4} $.\n\n4. Boundary-condition edge case (symmetric, no Stefan motion) with spurious currents:\n   - $ L_x = 1.0 $, $ x_s^0 = 0.5 $, $ T_\\ell = 273.15 $, $ T_r = 273.15 $, $ T_m = 273.15 $, $ \\rho = 1000.0 $, $ c_p = 1000.0 $, $ k_\\ell = 1.0 $, $ k_r = 1.0 $, $ L = 2.5\\times10^5 $, $ \\Delta t = 0.1 $, $ N_{\\mathrm{steps}} = 100 $, $ U_s = 1.0\\times10^{-4} $.\n\nRequired final output format:\nYour program should produce a single line of output containing the energy conservation error values $ \\varepsilon $ for the four test cases as a comma-separated list enclosed in square brackets, for example, $ [\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4] $. Each $ \\varepsilon_i $ must be a float in joules.", "solution": "The user has provided a problem concerning one-dimensional, two-phase heat transfer with a moving interface, and has requested the derivation and implementation of a numerical algorithm to quantify an energy conservation error. The problem is to be solved under a quasi-steady conduction assumption using a Ghost-Fluid Method (GFM) approach for the interface dynamics, and to compare the resulting system energy to that of a system where the interface is advected by an artificial spurious velocity field, representative of an artifact in Volume-of-Fluid (VOF) methods.\n\nThe problem is validated as scientifically grounded, well-posed, and objective. It is based on the classical Stefan problem, employing standard assumptions and numerical techniques. All necessary parameters are provided, and the objective is clearly defined. The formulation is self-consistent and physically plausible.\n\nHerein, a detailed derivation of the algorithm is provided, followed by its implementation. All mathematical entities are rendered in LaTeX as required.\n\n### Derivation of the Numerical Algorithm\n\nThe derivation begins with the fundamental principles laid out in the problem statement. The system is one-dimensional on a domain $x \\in [0, L_x]$ with a sharp phase-change interface at $x_s(t)$.\n\n**1. Quasi-Steady Temperature Profile**\n\nThe governing energy conservation equation is given as:\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho L \\frac{\\partial C}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k(x)\\frac{\\partial T}{\\partial x}\\right)\n$$\nThe problem specifies a quasi-steady conduction assumption. This implies that for the short duration of a single time step $\\Delta t$, the temperature field within each bulk phase ($x < x_s$ and $x > x_s$) reaches a steady state instantly. At steady state, the term $\\frac{\\partial T}{\\partial t}$ vanishes. The term $\\frac{\\partial C}{\\partial t}$ is non-zero only at the interface $x=x_s(t)$, so it is zero within the bulk of each phase. Thus, the governing equation in each phase simplifies to:\n$$\n\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) = 0\n$$\nSince the thermal conductivity $k$ is constant within each phase ($k_\\ell$ for the left phase, $k_r$ for the right phase), this equation can be integrated twice to yield a linear temperature profile $T(x) = Ax + B$ in each sub-domain.\n\nThe constants of integration are determined by the boundary conditions:\n-   At the left boundary: $T(0) = T_\\ell$\n-   At the right boundary: $T(L_x) = T_r$\n-   At the interface (treated as a Dirichlet boundary in the GFM framework): $T(x_s) = T_m$\n\nFor the left phase ($x \\in [0, x_s]$):\nThe profile is $T(x) = A_\\ell x + B_\\ell$.\n-   $T(0) = T_\\ell \\implies B_\\ell = T_\\ell$.\n-   $T(x_s) = T_m \\implies A_\\ell x_s + T_\\ell = T_m \\implies A_\\ell = \\frac{T_m - T_\\ell}{x_s}$.\nSo, the temperature profile is $T(x) = T_\\ell + (T_m - T_\\ell)\\frac{x}{x_s}$.\n\nFor the right phase ($x \\in [x_s, L_x]$):\nThe profile is $T(x) = A_r (x-x_s) + B_r$. (Using $x_s$ as the reference simplifies algebra).\n-   $T(x_s) = T_m \\implies B_r = T_m$.\n-   $T(L_x) = T_r \\implies A_r (L_x - x_s) + T_m = T_r \\implies A_r = \\frac{T_r - T_m}{L_x - x_s}$.\nSo, the temperature profile is $T(x) = T_m + (T_r - T_m)\\frac{x - x_s}{L_x - x_s}$.\n\n**2. Interface Velocity from the Stefan Condition**\n\nThe Stefan jump condition dictates the relationship between the heat flux discontinuity at the interface and the interface velocity $V_n = \\frac{dx_s}{dt}$. The condition is given as:\n$$\n[ -\\mathbf{n} \\cdot k \\nabla T ] = \\rho L V_n\n$$\nIn one dimension, with the normal vector $\\mathbf{n}$ pointing from the left to the right phase (i.e., in the $+x$ direction), this becomes:\n$$\n\\left(-k \\frac{dT}{dx}\\right)\\Big|_{x=x_s^+} - \\left(-k \\frac{dT}{dx}\\right)\\Big|_{x=x_s^-} = \\rho L V_n\n$$\nThe temperature gradients are the slopes $A_\\ell$ and $A_r$ derived above:\n-   $\\frac{dT}{dx}\\Big|_{x=x_s^-} = A_\\ell = \\frac{T_m - T_\\ell}{x_s}$\n-   $\\frac{dT}{dx}\\Big|_{x=x_s^+} = A_r = \\frac{T_r - T_m}{L_x - x_s}$\n\nSubstituting these into the Stefan condition:\n$$\n\\left(-k_r \\frac{T_r - T_m}{L_x - x_s}\\right) - \\left(-k_\\ell \\frac{T_m - T_\\ell}{x_s}\\right) = \\rho L V_n\n$$\nRearranging terms:\n$$\nk_\\ell \\frac{T_\\ell - T_m}{x_s} + k_r \\frac{T_m - T_r}{L_x - x_s} = \\rho L V_n\n$$\nThe problem statement defines one-sided interfacial heat fluxes as $q_\\ell = k_\\ell \\frac{T_\\ell - T_m}{x_s}$ and $q_r = k_r \\frac{T_m - T_r}{L_x - x_s}$. These represent the heat flux from the boundary towards the interface in each phase. With these definitions, the equation becomes:\n$$\nq_\\ell - q_r = \\rho L V_n\n$$\nThis yields an expression for the interface velocity:\n$$\nV_n = \\frac{q_\\ell - q_r}{\\rho L}\n$$\nThis completes the derivation of the interface velocity based on the quasi-steady assumption.\n\n**3. Time-Marching Algorithm**\n\nA forward Euler method is used to update the interface position over discrete time steps of size $\\Delta t$. Let $x_s^n$ be the interface position at time $t_n = n \\Delta t$.\n-   **GFM Interface Update:** The position $x_s$ is advanced based on the physically-derived Stefan velocity $V_n$:\n    $$\n    x_s^{n+1} = x_s^n + \\left(\\frac{q_\\ell^n - q_r^n}{\\rho L}\\right) \\Delta t\n    $$\n    where $q_\\ell^n = k_\\ell \\frac{T_\\ell - T_m}{x_s^n}$ and $q_r^n = k_r \\frac{T_m - T_r}{L_x - x_s^n}$.\n\n-   **VOF Interface Advection:** In parallel, a second interface position $x_{s,\\mathrm{VOF}}$ is tracked. Its motion is governed solely by the prescribed artificial spurious velocity $U_s$:\n    $$\n    x_{s,\\mathrm{VOF}}^{n+1} = x_{s,\\mathrm{VOF}}^n + U_s \\Delta t\n    $$\n\nThis process is repeated for $N_{\\mathrm{steps}}$, from an initial position $x_s^0$ to a final time $t_{\\mathrm{end}} = N_{\\mathrm{steps}} \\Delta t$.\n\n**4. Energy Calculation and Error Metric**\n\nThe total energy $E$ in the domain (per unit cross-sectional area, assuming $A=1 \\text{ m}^2$ for the units to be in Joules) is the sum of sensible and latent heat contributions.\n-   **Sensible Heat:** The sensible heat is the integral of $\\rho c_p T(x)$ over the domain. With linear temperature profiles, the integral in each phase is simply the domain length multiplied by the average temperature.\n    $$\n    E_{\\text{sensible}} = \\int_0^{L_x} \\rho c_p T(x) dx = \\rho c_p \\left( \\int_0^{x_s} T(x) dx + \\int_{x_s}^{L_x} T(x) dx \\right)\n    $$\n    $$\n    E_{\\text{sensible}} = \\rho c_p \\left( x_s \\frac{T(0) + T(x_s)}{2} + (L_x - x_s) \\frac{T(x_s) + T(L_x)}{2} \\right)\n    $$\n    $$\n    E_{\\text{sensible}} = \\rho c_p \\left( x_s \\frac{T_\\ell + T_m}{2} + (L_x - x_s) \\frac{T_m + T_r}{2} \\right)\n    $$\n-   **Latent Heat:** The phase indicator $C(x,t)$ is $1$ for the left phase ($x < x_s$) and $0$ for the right phase. The total latent heat stored in the system (relative to a state where the entire domain is in the right phase) is:\n    $$\n    E_{\\text{latent}} = \\int_0^{L_x} \\rho L C(x,t) dx = \\int_0^{x_s} \\rho L \\cdot 1 \\, dx = \\rho L x_s\n    $$\n-   **Total Energy:** The sum gives the total energy expression provided in the problem:\n    $$\n    E(x_s) = \\rho c_p\\left[x_s \\frac{T_\\ell + T_m}{2} + (L_x - x_s)\\frac{T_m + T_r}{2}\\right] + \\rho L x_s\n    $$\nThe energy conservation error $\\varepsilon$ due to spurious currents is defined as the absolute difference between the energy calculated using the VOF-advected interface position, $x_{s,\\mathrm{VOF}}(t_{\\mathrm{end}})$, and the energy calculated using the GFM-consistent interface position, $x_s(t_{\\mathrm{end}})$.\n$$\n\\varepsilon = \\left| E\\big(x_{s,\\mathrm{VOF}}(t_{\\mathrm{end}})\\big) - E\\big(x_s(t_{\\mathrm{end}})\\big) \\right|\n$$\nThe implementation will calculate these two final positions, apply the energy function to each, and compute the difference.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the one-dimensional two-phase heat transfer problem to assess the\n    impact of spurious VOF currents on energy conservation.\n    \"\"\"\n    # Test suite: (Lx, xs^0, T_ell, T_r, T_m, rho, c_p, k_ell, k_r, L, dt, N_steps, U_s)\n    test_cases = [\n        # Case 1: General \"happy path\" case with no spurious currents\n        (1.0, 0.6, 283.15, 263.15, 273.15, 1000.0, 1000.0, 1.0, 0.1, 2.5e5, 0.1, 100, 0.0),\n        # Case 2: Small spurious currents\n        (1.0, 0.6, 283.15, 263.15, 273.15, 1000.0, 1000.0, 1.0, 0.1, 2.5e5, 0.1, 100, 1.0e-5),\n        # Case 3: Larger spurious currents\n        (1.0, 0.6, 283.15, 263.15, 273.15, 1000.0, 1000.0, 1.0, 0.1, 2.5e5, 0.1, 100, 5.0e-4),\n        # Case 4: Boundary-condition edge case (symmetric, no Stefan motion) with spurious currents\n        (1.0, 0.5, 273.15, 273.15, 273.15, 1000.0, 1000.0, 1.0, 1.0, 2.5e5, 0.1, 100, 1.0e-4)\n    ]\n\n    results = []\n\n    def calculate_energy(xs, Lx, Tl, Tr, Tm, rho, cp, L):\n        \"\"\"\n        Computes the total energy in the domain based on the interface position xs.\n        The energy is per unit cross-sectional area, resulting in units of J.\n        (Implicit assumption: cross-sectional area is 1 m^2).\n        \"\"\"\n        # Sensible heat contribution from the left phase\n        sensible_l = rho * cp * xs * (Tl + Tm) / 2.0\n        # Sensible heat contribution from the right phase\n        sensible_r = rho * cp * (Lx - xs) * (Tm + Tr) / 2.0\n        # Latent heat contribution (left phase has latent heat)\n        latent = rho * L * xs\n        return sensible_l + sensible_r + latent\n\n    for case in test_cases:\n        Lx, xs_0, Tl, Tr, Tm, rho, cp, kl, kr, L, dt, N_steps, Us = case\n        \n        # Initialize interface positions\n        xs_gfm = xs_0  # GFM-consistent interface\n        xs_vof = xs_0  # VOF-advected interface\n\n        # Time-stepping loop\n        for _ in range(N_steps):\n            # Guard against division by zero if interface reaches a boundary\n            if xs_gfm = 1e-9 or xs_gfm >= Lx - 1e-9:\n                break\n            \n            # --- GFM interface update ---\n            # Calculate one-sided heat fluxes\n            q_l = kl * (Tl - Tm) / xs_gfm\n            q_r = kr * (Tm - Tr) / (Lx - xs_gfm)\n            \n            # Calculate interface velocity from Stefan condition\n            Vn = (q_l - q_r) / (rho * L)\n            \n            # Update GFM interface position using forward Euler\n            xs_gfm += Vn * dt\n\n            # --- VOF interface update ---\n            # Advect VOF interface with prescribed spurious velocity\n            xs_vof += Us * dt\n            \n        # Calculate energies at the final time t_end\n        E_gfm = calculate_energy(xs_gfm, Lx, Tl, Tr, Tm, rho, cp, L)\n        E_vof = calculate_energy(xs_vof, Lx, Tl, Tr, Tm, rho, cp, L)\n\n        # Calculate the energy conservation error\n        error = abs(E_vof - E_gfm)\n        results.append(error)\n        \n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n\n```", "id": "3508535"}, {"introduction": "Solving fully coupled multiphysics systems can be computationally expensive, leading to the widespread use of partitioned, or operator-splitting, numerical schemes. This practice delves into the theoretical analysis of such methods by examining a coupled induction heating problem. You will use modified equation analysis, involving the Lie bracket of the physical operators, to derive the leading-order error introduced by splitting the electromagnetic and thermal solves, and identify conditions under which this 'splitting error' is minimized. [@problem_id:3508515]", "problem": "Consider a reduced-order, spatially lumped model of induction heating that couples an electromagnetic relaxation with a thermal energy balance. Let $T(t)$ denote the spatially uniform temperature and let $E(t)$ denote a representative magnitude of the electric field driving Joule heating. The electrical conductivity is temperature-dependent via the empirically grounded form $\\sigma(T) = \\sigma_0 \\exp(-\\beta\\,(T - T_a))$, where $\\sigma_0 gt; 0$ is the conductivity at ambient temperature $T_a$ and $\\beta \\ge 0$ parameterizes the sensitivity to temperature.\n\nStarting from the First Law of Thermodynamics (energy conservation for a control volume) and the Joule heating constitutive relation (Ohmic heating), the lumped thermal balance reads\n$$\nC\\,\\frac{dT}{dt} = \\sigma(T)\\,E^2 - h\\,(T - T_a),\n$$\nwhere $C gt; 0$ is the volumetric heat capacity and $h \\ge 0$ is a linearized heat transfer coefficient to the ambient $T_a$. Under the quasi-static eddy-current approximation with an impressed current density $J_0$, a reduced electromagnetic relaxation is modeled as\n$$\n\\frac{dE}{dt} = -\\frac{1}{\\tau_e}\\Big(E - \\bar{E}(\\sigma(T))\\Big),\n\\qquad\n\\bar{E}(\\sigma) = \\frac{J_0}{\\sigma},\n$$\nwhere $\\tau_e gt; 0$ is an effective electromagnetic relaxation time scale. The coupled system can be written as $y' = F(y)$ for $y = (E,T)$ with\n$$\nF(y) = F_{\\text{em}}(y) + F_{\\text{th}}(y),\n\\quad\nF_{\\text{em}}(E,T) = \\big(-\\tfrac{1}{\\tau_e}\\,(E - \\bar{E}(\\sigma(T))),\\,0\\big),\n\\quad\nF_{\\text{th}}(E,T) = \\big(0,\\,\\tfrac{1}{C}\\big(\\sigma(T)\\,E^2 - h\\,(T - T_a)\\big)\\big).\n$$\n\nDefine a sequential (Lie) partitioned time integrator over a single time step $\\Delta t gt; 0$ by first evolving $F_{\\text{em}}$ with $T$ frozen for time $\\Delta t$, followed by evolving $F_{\\text{th}}$ with $E$ frozen for time $\\Delta t$. Let the exact monolithic evolution over time $\\Delta t$ be the flow of $F$. Using formal composition analysis for smooth vector fields, the sequential integrator is first-order accurate in general, and admits a modified equation whose vector field is $F + \\tfrac{\\Delta t}{2}[F_{\\text{th}},F_{\\text{em}}] + \\mathcal{O}(\\Delta t^2)$, where $[G,H]$ denotes the Lie bracket $D H \\cdot G - D G \\cdot H$. Focusing on the temperature component, the modified temperature equation under sequential coupling can be written as\n$$\n\\frac{dT}{dt} = H(T,E) + \\frac{\\Delta t}{2}\\,\\Big(\\frac{\\partial H}{\\partial E}(T,E)\\cdot G(T,E)\\Big) + \\mathcal{O}(\\Delta t^2),\n$$\nwhere $H(T,E) = \\tfrac{1}{C}\\big(\\sigma(T)\\,E^2 - h\\,(T - T_a)\\big)$ and $G(T,E) = -\\tfrac{1}{\\tau_e}\\big(E - \\tfrac{J_0}{\\sigma(T)}\\big)$. The leading-order splitting error in the temperature dynamics is therefore governed by the scalar quantity $\\tfrac{1}{2}\\,\\tfrac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$.\n\nTasks:\n1. Starting from the stated fundamental laws, derive the sequential-coupling modified equation for $T(t)$ by computing the temperature component of the Lie bracket $[F_{\\text{th}},F_{\\text{em}}]$. Show that the leading correction is proportional to $\\tfrac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$ and precisely determine $\\tfrac{\\partial H}{\\partial E}$ and $G$ in terms of the model parameters $(\\sigma_0,\\beta,T_a,C,h,J_0,\\tau_e)$ and the state $(T,E)$.\n2. Identify mathematically precise conditions on $H$ and $G$ under which the leading-order correction term vanishes identically for all $(T,E)$, implying that the sequential coupling achieves second-order local accuracy in the temperature equation (that is, the local truncation error in $T$ scales as $\\mathcal{O}(\\Delta t^2)$ rather than $\\mathcal{O}(\\Delta t)$). Express these conditions as properties of the vector fields $F_{\\text{th}}$ and $F_{\\text{em}}$ (e.g., commutation or independence).\n3. Implement a program that, for a fixed list of parameter sets (the test suite below), determines whether the sequential coupling for the temperature equation is first-order ($\\mathcal{O}(\\Delta t)$) or second-order ($\\mathcal{O}(\\Delta t^2)$) with respect to the leading modified-equation correction. Your classification must be based on the vanishing of the scalar field $\\tfrac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$ identically for all $(T,E)$ in the model, not merely at a single initial state. Concretely, treat two special modeling flags per test case:\n   • If the electromagnetic subproblem is algebraic (meaning $E$ is instantaneously set to $\\bar{E}(\\sigma(T))$ with no dynamics), then $G \\equiv 0$ and the leading correction vanishes.\n   • If the Joule heating source uses a prescribed current model independent of $E$ (meaning $H(T,E) = \\tfrac{1}{C}\\big(\\tfrac{J_0^2}{\\sigma(T)} - h\\,(T - T_a)\\big)$), then $\\tfrac{\\partial H}{\\partial E} \\equiv 0$ and the leading correction vanishes.\n   In all other cases, classify as first-order.\n\nYour program should output a single line containing the classification results for all test cases as integers in a comma-separated list enclosed in square brackets, where the integer $1$ denotes $\\mathcal{O}(\\Delta t)$ and the integer $2$ denotes $\\mathcal{O}(\\Delta t^2)$.\n\nTest suite (each case lists $(\\sigma_0,\\beta,T_a,C,h,J_0,\\tau_e,T_0,E_0)$ and the two modeling flags):\nCase A (general induction heating, sequential coupling expected $\\mathcal{O}(\\Delta t)$):\n$\\sigma_0 = 6.0\\times 10^6$, $\\beta = 4.0\\times 10^{-3}$, $T_a = 300$, $C = 3.9\\times 10^6$, $h = 500$, $J_0 = 1.0\\times 10^7$, $\\tau_e = 1.0\\times 10^{-3}$, $T_0 = 300$, $E_0 = 0.5\\,J_0/\\sigma(T_0)$, electromagnetic algebraic flag $\\text{em\\_algebraic} = \\text{False}$, prescribed-current Joule heating flag $\\text{source\\_depends\\_on\\_E} = \\text{True}$.\n\nCase B (prescribed current source independent of $E$, sequential coupling achieves $\\mathcal{O}(\\Delta t^2)$ in $T$):\nSame parameters as Case A but with $\\text{source\\_depends\\_on\\_E} = \\text{False}$.\n\nCase C (algebraic electromagnetics, $G \\equiv 0$, sequential coupling achieves $\\mathcal{O}(\\Delta t^2)$ in $T$):\nSame as Case A but with $\\text{em\\_algebraic} = \\text{True}$.\n\nCase D (initially equilibrated field $E_0 = \\bar{E}(\\sigma(T_0))$ but dynamic electromagnetics and standard Joule heating, still first-order because the vanishing at one point does not imply identically zero):\nSame as Case A but with $E_0 = J_0/\\sigma(T_0)$ and flags $\\text{em\\_algebraic} = \\text{False}$, $\\text{source\\_depends\\_on\\_E} = \\text{True}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[1,2,2,1]\"). No physical units are required in the output; the answers are integers.", "solution": "The fundamental base consists of two laws: energy conservation for a control volume and Ohmic Joule heating in a conducting medium, as well as a quasi-static eddy-current relaxation toward an algebraic state. Energy conservation in the lumped model yields\n$$\nC\\,\\frac{dT}{dt} = q_{\\text{Joule}}(T,E) - q_{\\text{loss}}(T),\n$$\nwith $q_{\\text{Joule}}(T,E) = \\sigma(T)\\,E^2$ and $q_{\\text{loss}}(T) = h\\,(T - T_a)$. This gives the thermal vector field\n$$\nF_{\\text{th}}(E,T) = \\big(0,\\,H(T,E)\\big), \\quad H(T,E) = \\frac{1}{C}\\Big(\\sigma(T)\\,E^2 - h\\,(T - T_a)\\Big).\n$$\nIn induction heating with impressed current density $J_0$, the quasi-static electromagnetic steady field satisfies $\\bar{E}(\\sigma) = J_0/\\sigma$ under Ohm’s law $J = \\sigma E$ for a prescribed $J$. A simple dynamical relaxation model that respects the tendency toward this steady state is\n$$\n\\frac{dE}{dt} = -\\frac{1}{\\tau_e}\\Big(E - \\bar{E}(\\sigma(T))\\Big), \\quad \\bar{E}(\\sigma(T)) = \\frac{J_0}{\\sigma(T)},\n$$\nleading to the electromagnetic vector field\n$$\nF_{\\text{em}}(E,T) = \\big(G(T,E),\\,0\\big), \\quad G(T,E) = -\\frac{1}{\\tau_e}\\Big(E - \\frac{J_0}{\\sigma(T)}\\Big).\n$$\n\nWe analyze the sequential (Lie) coupling that over a time step $\\Delta t$ applies the flow generated by $F_{\\text{em}}$ (with $T$ frozen) followed by the flow generated by $F_{\\text{th}}$ (with $E$ frozen). For smooth vector fields $F_{\\text{em}}$ and $F_{\\text{th}}$, the Baker–Campbell–Hausdorff composition formula for flows implies that the combined sequential step is the exact flow of a modified vector field\n$$\nF_{\\text{mod}} = F_{\\text{em}} + F_{\\text{th}} + \\frac{\\Delta t}{2}\\,[F_{\\text{th}},F_{\\text{em}}] + \\mathcal{O}(\\Delta t^2),\n$$\nwhere the Lie bracket of vector fields is defined by $[A,B] = D B \\cdot A - D A \\cdot B$. Writing $y = (E,T)$, $F_{\\text{th}}(y) = (0,H(T,E))$ and $F_{\\text{em}}(y) = (G(T,E),0)$, we compute the bracket’s temperature component. The Jacobian of $F_{\\text{th}}$ acting on a perturbation $(\\delta E, \\delta T)$ is\n$$\nD F_{\\text{th}}(E,T)\\cdot(\\delta E,\\delta T) = \\big(0,\\,\\frac{\\partial H}{\\partial E}(T,E)\\,\\delta E + \\frac{\\partial H}{\\partial T}(T,E)\\,\\delta T\\big),\n$$\nwhile the Jacobian of $F_{\\text{em}}$ acting on $(\\delta E,\\delta T)$ is\n$$\nD F_{\\text{em}}(E,T)\\cdot(\\delta E,\\delta T) = \\big(\\frac{\\partial G}{\\partial E}(T,E)\\,\\delta E + \\frac{\\partial G}{\\partial T}(T,E)\\,\\delta T,\\,0\\big).\n$$\nBy definition,\n$$\n[F_{\\text{th}},F_{\\text{em}}](E,T) = D F_{\\text{em}}(E,T)\\cdot F_{\\text{th}}(E,T) - D F_{\\text{th}}(E,T)\\cdot F_{\\text{em}}(E,T).\n$$\nSubstituting $F_{\\text{th}}(E,T) = (0,H(T,E))$ and $F_{\\text{em}}(E,T) = (G(T,E),0)$,\nthe temperature component of $D F_{\\text{em}}(E,T)\\cdot F_{\\text{th}}(E,T)$ is zero, and the temperature component of $D F_{\\text{th}}(E,T)\\cdot F_{\\text{em}}(E,T)$ is $\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$. Therefore,\n$$\n\\big([F_{\\text{th}},F_{\\text{em}}](E,T)\\big)_T = -\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E).\n$$\nBecause in the Lie composition we apply first $F_{\\text{em}}$ then $F_{\\text{th}}$, the modified vector field correction is $\\tfrac{\\Delta t}{2}[F_{\\text{th}},F_{\\text{em}}]$. The modified temperature equation is therefore\n$$\n\\frac{dT}{dt} = H(T,E) - \\frac{\\Delta t}{2}\\,\\Big(\\frac{\\partial H}{\\partial E}(T,E)\\cdot G(T,E)\\Big) + \\mathcal{O}(\\Delta t^2).\n$$\n\nWe now compute the needed derivatives explicitly. With $\\sigma(T) = \\sigma_0 e^{-\\beta(T - T_a)}$, we have\n$$\nH(T,E) = \\frac{1}{C}\\big(\\sigma(T)\\,E^2 - h\\,(T - T_a)\\big), \\quad\n\\frac{\\partial H}{\\partial E}(T,E) = \\frac{1}{C}\\cdot 2\\,\\sigma(T)\\,E.\n$$\nFor the electromagnetic vector field,\n$$\nG(T,E) = -\\frac{1}{\\tau_e}\\left(E - \\frac{J_0}{\\sigma(T)}\\right).\n$$\nThus, the leading-order splitting correction term in the temperature modified equation is\n$$\n-\\frac{\\Delta t}{2}\\,\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E)\n=\n\\Delta t\\,\\frac{\\sigma(T)\\,E}{C\\,\\tau_e}\\left(E - \\frac{J_0}{\\sigma(T)}\\right).\n$$\n\nThe sequential coupling is therefore generically first-order in $\\Delta t$ for the temperature equation, with a leading local error term linear in $\\Delta t$ proportional to the scalar $\\frac{\\partial H}{\\partial E}(T,E)\\,G(T,E)$. We now identify when this linear term vanishes identically for all states $(T,E)$, which is the necessary and sufficient condition for the local error to be at least $\\mathcal{O}(\\Delta t^2)$ in $T$ under sequential coupling.\n\nFrom the expression, the linear term vanishes identically if and only if either:\n1. $\\frac{\\partial H}{\\partial E}(T,E) \\equiv 0$ for all $(T,E)$, meaning the thermal source is independent of $E$. Physically, this corresponds to modeling Joule heating with a prescribed current density that does not include the dynamical electric field as a state; for example, using $H(T,E) = \\frac{1}{C}\\big(\\frac{J_0^2}{\\sigma(T)} - h\\,(T - T_a)\\big)$ makes $\\frac{\\partial H}{\\partial E} \\equiv 0$.\n2. $G(T,E) \\equiv 0$ for all $(T,E)$, meaning the electromagnetic subproblem is algebraic with no dynamics (instantaneous enforcement of $E = \\bar{E}(\\sigma(T))$). In this case, the electromagnetic vector field vanishes identically, so the commutator contribution is zero.\n\nNote that the condition $E = \\frac{J_0}{\\sigma(T)}$ at a single time or for particular initial data does not ensure the linear term vanishes along the entire trajectory unless $G \\equiv 0$; sequential coupling freezes $E$ during the thermal substep, so changes in $T$ render $E - \\frac{J_0}{\\sigma(T)}$ nonzero unless the electromagnetic relaxation is algebraic. Therefore, merely choosing initial data with $E_0 = \\bar{E}(\\sigma(T_0))$ does not elevate the order; the criterion must hold identically as a property of the vector fields.\n\nAlgorithmic design for the program:\nWe encode the two physically motivated flags that enforce the vanishing of the linear term as properties of the model:\n(i) source independent of $E$ (sets $\\frac{\\partial H}{\\partial E} \\equiv 0$),\n(ii) electromagnetic algebraic (sets $G \\equiv 0$).\nFor each test case, we classify as second-order if either flag is active; otherwise, we classify as first-order. This directly implements the mathematical conditions $\\frac{\\partial H}{\\partial E}\\equiv 0$ or $G\\equiv 0$. The program uses the provided parameter sets to define test cases and outputs the integer classification for each case in the required single-line format.\n\nApplied to the specified test suite:\nCase A has both flags inactive, so the leading correction is nonzero and the method is first-order, output $1$.\nCase B has source independent of $E$, so the leading correction vanishes and the method is second-order in $T$, output $2$.\nCase C has algebraic electromagnetics, so the leading correction vanishes and the method is second-order in $T$, output $2$.\nCase D has equilibrated initial data but neither flag active; the leading correction does not vanish identically as $T$ evolves, so the method remains first-order, output $1$.\n\nThe program returns the list of integers $[1,2,2,1]$ as the single-line output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Define the test cases from the problem statement as dictionaries.\n    # Each case includes parameters and two flags:\n    # - em_algebraic: if True, electromagnetic dynamics are algebraic (G ≡ 0).\n    # - source_depends_on_E: if True, Joule heating depends on E (∂H/∂E ≠ 0);\n    #                        if False, source independent of E (∂H/∂E ≡ 0).\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"sigma0\": 6.0e6,\n            \"beta\": 4.0e-3,\n            \"Ta\": 300.0,\n            \"C\": 3.9e6,\n            \"h\": 500.0,\n            \"J0\": 1.0e7,\n            \"tau_e\": 1.0e-3,\n            \"T0\": 300.0,\n            \"E0\": None,  # computed below from J0/sigma(T0), then scaled\n            \"em_algebraic\": False,\n            \"source_depends_on_E\": True,\n            \"E0_scale\": 0.5,\n        },\n        {\n            \"name\": \"Case B\",\n            \"sigma0\": 6.0e6,\n            \"beta\": 4.0e-3,\n            \"Ta\": 300.0,\n            \"C\": 3.9e6,\n            \"h\": 500.0,\n            \"J0\": 1.0e7,\n            \"tau_e\": 1.0e-3,\n            \"T0\": 300.0,\n            \"E0\": None,\n            \"em_algebraic\": False,\n            \"source_depends_on_E\": False,  # source independent of E\n            \"E0_scale\": 0.5,\n        },\n        {\n            \"name\": \"Case C\",\n            \"sigma0\": 6.0e6,\n            \"beta\": 4.0e-3,\n            \"Ta\": 300.0,\n            \"C\": 3.9e6,\n            \"h\": 500.0,\n            \"J0\": 1.0e7,\n            \"tau_e\": 1.0e-3,\n            \"T0\": 300.0,\n            \"E0\": None,\n            \"em_algebraic\": True,          # electromagnetic algebraic\n            \"source_depends_on_E\": True,\n            \"E0_scale\": 0.5,\n        },\n        {\n            \"name\": \"Case D\",\n            \"sigma0\": 6.0e6,\n            \"beta\": 4.0e-3,\n            \"Ta\": 300.0,\n            \"C\": 3.9e6,\n            \"h\": 500.0,\n            \"J0\": 1.0e7,\n            \"tau_e\": 1.0e-3,\n            \"T0\": 300.0,\n            \"E0\": None,  # set to equilibrium exactly\n            \"em_algebraic\": False,\n            \"source_depends_on_E\": True,\n            \"E0_scale\": 1.0,               # E0 = J0/sigma(T0)\n        },\n    ]\n\n    def sigma(T, sigma0, beta, Ta):\n        return sigma0 * np.exp(-beta * (T - Ta))\n\n    # Prepare initial E0 for each case based on equilibrium scaling.\n    for case in test_cases:\n        sig_T0 = sigma(case[\"T0\"], case[\"sigma0\"], case[\"beta\"], case[\"Ta\"])\n        e_eq = case[\"J0\"] / sig_T0\n        case[\"E0\"] = case[\"E0_scale\"] * e_eq\n\n    # Classification logic based on analytical conditions:\n    # If em_algebraic is True => G ≡ 0 => second-order (2).\n    # If source_depends_on_E is False => ∂H/∂E ≡ 0 => second-order (2).\n    # Else => first-order (1).\n    results = []\n    for case in test_cases:\n        if case[\"em_algebraic\"] or (not case[\"source_depends_on_E\"]):\n            results.append(2)\n        else:\n            results.append(1)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3508515"}]}