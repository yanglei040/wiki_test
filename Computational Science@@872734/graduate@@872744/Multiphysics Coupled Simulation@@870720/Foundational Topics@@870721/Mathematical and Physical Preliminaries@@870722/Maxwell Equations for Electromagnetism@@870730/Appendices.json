{"hands_on_practices": [{"introduction": "Before tackling complex numerical simulations, it is crucial to solidify your understanding of how electromagnetic fields arise from fundamental sources. This practice guides you through the analytical derivation of the magnetic field from a finite solenoid, a common component in many electromechanical devices. By applying the principles of magnetostatics and the law of superposition, you will build a foundational skill in translating a physical current configuration into a precise mathematical field description [@problem_id:3514106].", "problem": "A long, thin-walled solenoid of finite length is modeled for magnetostatic analysis in a multiphysics coupled simulation, where electromagnetic fields are decoupled from mechanical and thermal fields due to steady direct current and negligible Joule heating. The solenoid has radius $a$, total length $\\ell$, and $N$ tightly packed turns carrying a steady current $I$ in the azimuthal direction, producing an effective surface current density on the cylindrical shell. Assume free space surrounds the solenoid so that the magnetic response is linear and isotropic with $\\mathbf{B}=\\mu_{0}\\mathbf{H}$. The solenoid’s axis is aligned with the $z$-axis and spans from $z=-\\ell/2$ to $z=+\\ell/2$. \n\nStarting from the magnetostatic Maxwell equations $\\nabla\\times\\mathbf{H}=\\mathbf{J}_{f}$ and $\\nabla\\cdot\\mathbf{B}=0$, and using only well-tested results that can be derived from these equations under magnetostatic conditions, model the winding as a continuous distribution of circular current loops and derive the exact magnetic flux density component $B_{z}(z)$ on the axis at an arbitrary axial coordinate $z$ (measured from the solenoid center). Express your final answer as a single closed-form analytic expression in terms of $\\mu_{0}$, $N$, $I$, $a$, $\\ell$, and $z$. Use the International System of Units (SI), so the magnetic flux density is in tesla. Do not provide intermediate steps or multiple alternatives in your final expression; give a single simplified expression only. No numerical evaluation or rounding is required.", "solution": "The problem statement has been validated and is deemed valid. It is a scientifically grounded, well-posed, and objective problem from the field of electromagnetism. All necessary information is provided, and the objective is clearly defined.\n\nThe problem requires the derivation of the axial component of the magnetic flux density, $B_z(z)$, on the axis of a finite solenoid. We begin from the fundamental equations of magnetostatics and a suitable model for the solenoid's current distribution.\n\nThe governing equations are the magnetostatic forms of Maxwell's equations:\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J}_{f} $$\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\nwhere $\\mathbf{H}$ is the magnetic field intensity, $\\mathbf{B}$ is the magnetic flux density, and $\\mathbf{J}_{f}$ is the free current density. For a linear, isotropic medium like free space, $\\mathbf{B} = \\mu_{0}\\mathbf{H}$.\n\nThe solenoid has $N$ turns over a length $\\ell$, carrying a steady current $I$. Since the turns are tightly packed, we can model this as a continuous cylindrical sheet of current. The number of turns per unit length is $n = N/\\ell$. The effective surface current density, $K$, is the total current crossing a unit length along the axis. This is given by $K = nI = (N/\\ell)I$. The direction of this current is azimuthal ($\\hat{\\boldsymbol{\\phi}}$).\n\nA standard result derivable from the Biot-Savart law (which itself is a solution to Maxwell's equations for localized currents) is the magnetic field on the axis of a single circular loop of radius $a$ carrying a current $I_{\\text{loop}}$. If the loop is centered at the origin and lies in the $xy$-plane, the magnetic flux density at a point $z$ on the axis is:\n$$ B_z^{\\text{loop}}(z) = \\frac{\\mu_{0} I_{\\text{loop}} a^2}{2(a^2 + z^2)^{3/2}} $$\n\nWe model the finite solenoid as a continuous stack of such circular loops. Consider an infinitesimal segment of the solenoid of axial length $dz'$ located at position $z'$. The current flowing in this infinitesimal ring is $dI = K \\, dz' = (N/\\ell)I \\, dz'$. This ring produces an infinitesimal magnetic flux density $dB_z$ at an observation point $(0,0,z)$ on the axis. The axial distance from the ring to the observation point is $(z-z')$. Using the formula for a single loop, we can write the contribution from this infinitesimal ring as:\n$$ dB_z = \\frac{\\mu_{0} (dI) a^2}{2(a^2 + (z-z')^2)^{3/2}} = \\frac{\\mu_{0} (N/\\ell)I a^2}{2(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\n\nTo find the total magnetic flux density $B_z(z)$, we integrate this expression over the entire length of the solenoid, from $z' = -\\ell/2$ to $z' = +\\ell/2$:\n$$ B_z(z) = \\int_{-\\ell/2}^{+\\ell/2} \\frac{\\mu_{0} N I a^2}{2\\ell} \\frac{1}{(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\nLet's factor out the constants:\n$$ B_z(z) = \\frac{\\mu_{0} N I a^2}{2\\ell} \\int_{-\\ell/2}^{+\\ell/2} \\frac{1}{(a^2 + (z-z')^2)^{3/2}} \\, dz' $$\n\nTo solve the integral, we perform a change of variables. Let $u = z' - z$. Then $du = dz'$. The limits of integration for $u$ become:\n- Lower limit: $z' = -\\ell/2 \\implies u = -\\ell/2 - z = -(z + \\ell/2)$\n- Upper limit: $z' = +\\ell/2 \\implies u = \\ell/2 - z$\n\nThe integral becomes:\n$$ \\int_{-(z + \\ell/2)}^{\\ell/2 - z} \\frac{1}{(a^2 + u^2)^{3/2}} \\, du $$\nThe standard indefinite integral is:\n$$ \\int \\frac{1}{(a^2 + u^2)^{3/2}} \\, du = \\frac{1}{a^2} \\frac{u}{\\sqrt{a^2 + u^2}} $$\nNow, we evaluate the definite integral using the fundamental theorem of calculus:\n$$ \\left[ \\frac{1}{a^2} \\frac{u}{\\sqrt{a^2 + u^2}} \\right]_{-(z + \\ell/2)}^{\\ell/2 - z} = \\frac{1}{a^2} \\left( \\frac{\\ell/2 - z}{\\sqrt{a^2 + (\\ell/2 - z)^2}} - \\frac{-(z + \\ell/2)}{\\sqrt{a^2 + (-(z + \\ell/2))^2}} \\right) $$\n$$ = \\frac{1}{a^2} \\left( \\frac{\\ell/2 - z}{\\sqrt{a^2 + (\\ell/2 - z)^2}} + \\frac{z + \\ell/2}{\\sqrt{a^2 + (z + \\ell/2)^2}} \\right) $$\n\nSubstituting this result back into the expression for $B_z(z)$:\n$$ B_z(z) = \\frac{\\mu_{0} N I a^2}{2\\ell} \\left[ \\frac{1}{a^2} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + (z + \\frac{\\ell}{2})^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + (\\frac{\\ell}{2} - z)^2}} \\right) \\right] $$\nThe $a^2$ terms cancel, yielding the final expression for the magnetic flux density on the axis of the finite solenoid:\n$$ B_z(z) = \\frac{\\mu_{0} N I}{2\\ell} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + \\left(z + \\frac{\\ell}{2}\\right)^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + \\left(\\frac{\\ell}{2} - z\\right)^2}} \\right) $$\nThis expression gives the axial component of the magnetic flux density at any point $z$ on the axis of the solenoid, defined from $z=-\\ell/2$ to $z=+\\ell/2$. It is expressed purely in terms of the given parameters, as required.", "answer": "$$\\boxed{\\frac{\\mu_{0} N I}{2\\ell} \\left( \\frac{z + \\frac{\\ell}{2}}{\\sqrt{a^2 + \\left(z + \\frac{\\ell}{2}\\right)^2}} + \\frac{\\frac{\\ell}{2} - z}{\\sqrt{a^2 + \\left(\\frac{\\ell}{2} - z\\right)^2}} \\right)}$$", "id": "3514106"}, {"introduction": "Real-world multiphysics problems almost always involve interfaces between different materials, which may have anisotropic or lossy properties. This exercise transitions from pure analysis to numerical modeling, challenging you to build a finite-volume solver for an electrostatic problem with a composite dielectric [@problem_id:3514139]. Through this practice, you will implement a key numerical technique for handling material discontinuities and numerically verify the fundamental continuity conditions for the electric field $\\mathbf{E}$ and electric flux density $\\mathbf{D}$ that are central to Maxwell's theory.", "problem": "Consider a two-dimensional electrostatic boundary-value problem governed by Maxwell's equations on a rectangular domain of width $W$ and height $H$, partitioned into two subdomains by a vertical interface at $x = W/2$. The left subdomain has a homogeneous, diagonal, possibly complex permittivity tensor $\\boldsymbol{\\epsilon}^{(L)} = \\mathrm{diag}(\\epsilon_{x}^{(L)}, \\epsilon_{y}^{(L)})$ and the right subdomain has a homogeneous, diagonal, possibly complex permittivity tensor $\\boldsymbol{\\epsilon}^{(R)} = \\mathrm{diag}(\\epsilon_{x}^{(R)}, \\epsilon_{y}^{(R)})$. The electrostatic potential $\\phi(x,y)$ satisfies the constitutive relation $\\mathbf{D} = \\boldsymbol{\\epsilon}\\,\\mathbf{E}$ and $\\mathbf{E} = -\\nabla \\phi$, and, in the absence of free charge, Gauss’s law reads $\\nabla \\cdot \\mathbf{D} = 0$. Combining these gives the governing equation\n$$\n\\nabla \\cdot \\left( \\boldsymbol{\\epsilon}(x,y)\\,\\nabla \\phi(x,y) \\right) = 0\n$$\nwith piecewise constant $\\boldsymbol{\\epsilon}(x,y)$ equal to $\\boldsymbol{\\epsilon}^{(L)}$ for $x < W/2$ and $\\boldsymbol{\\epsilon}^{(R)}$ for $x \\ge W/2$. Impose Dirichlet boundary conditions $\\phi(0,y) = V_{\\mathrm{left}}$, $\\phi(W,y) = V_{\\mathrm{right}}$, $\\phi(x,0) = V_{\\mathrm{bottom}}$, and $\\phi(x,H) = V_{\\mathrm{top}}$, all expressed in volts (V). At the interface, the physical continuity conditions are: the potential $\\phi$ is continuous, the tangential component of the electric field $\\mathbf{E}$ is continuous (in volts per meter, V/m), and the normal component of the electric flux density $\\mathbf{D}$ is continuous (in coulombs per square meter, C/m$^2$).\n\nDiscretize the domain with a uniform grid of $N_x$ points in the $x$-direction and $N_y$ points in the $y$-direction. Use a conservative finite-volume discretization of the operator $\\nabla \\cdot (\\boldsymbol{\\epsilon}\\,\\nabla \\phi)$ for a diagonal $\\boldsymbol{\\epsilon}$: compute face-centered coefficients with harmonic averaging for $\\epsilon_x$ on vertical faces and for $\\epsilon_y$ on horizontal faces, and assemble the resulting five-point stencil linear system for interior nodes; for boundary nodes, enforce Dirichlet conditions directly.\n\nAfter solving for $\\phi(x,y)$, verify the interface continuity numerically along the entire vertical interface line located between the last left column and the first right column. Define the following metrics:\n\n- The maximum magnitude of the jump in the tangential component of the electric field across the interface,\n$$\n\\Delta E_{\\mathrm{t},\\max} = \\max_{y\\ \\mathrm{grid}}\\left| E_y^{(L)}(y) - E_y^{(R)}(y) \\right|,\n$$\nwhere $E_y^{(L)}(y)$ is approximated at the last left column by a centered finite difference in $y$, and $E_y^{(R)}(y)$ is approximated at the first right column by the corresponding centered finite difference in $y$. Express $\\Delta E_{\\mathrm{t},\\max}$ in volts per meter (V/m).\n\n- The maximum magnitude of the jump in the normal component of the electric flux density across the interface,\n$$\n\\Delta D_{\\mathrm{n},\\max} = \\max_{y\\ \\mathrm{grid}}\\left| D_x^{(L)}(y) - D_x^{(R)}(y) \\right|,\n$$\nwhere $D_x^{(L)}(y) = \\epsilon_{x}^{(L)}\\,E_x^{(L)}(y)$ and $D_x^{(R)}(y) = \\epsilon_{x}^{(R)}\\,E_x^{(R)}(y)$, with $E_x^{(L)}(y)$ approximated by a backward finite difference in $x$ at the last left column and $E_x^{(R)}(y)$ approximated by a forward finite difference in $x$ at the first right column. Express $\\Delta D_{\\mathrm{n},\\max}$ in coulombs per square meter (C/m$^2$).\n\nUse the vacuum permittivity $\\epsilon_0 = 8.854187817 \\times 10^{-12}$ F/m, and treat complex-valued permittivities and potentials in a phasor sense. When computing magnitudes of jumps for complex quantities, use the complex modulus.\n\nYour program must implement this discretization and evaluation and produce results for the following test suite. All geometry and boundary values are identical across tests:\n\n- Geometry and grid:\n    - $W = 1.0 \\times 10^{-2}$ m,\n    - $H = 1.0 \\times 10^{-2}$ m,\n    - $N_x = 64$,\n    - $N_y = 64$.\n\n- Boundary conditions (Dirichlet):\n    - $V_{\\mathrm{left}} = 0.5$ V,\n    - $V_{\\mathrm{right}} = 0.0$ V,\n    - $V_{\\mathrm{bottom}} = 0.0$ V,\n    - $V_{\\mathrm{top}} = 1.0$ V.\n\n- Test cases (material tensors):\n    1. Isotropic, real:\n        - Left: $\\boldsymbol{\\epsilon}^{(L)} = \\mathrm{diag}(2\\,\\epsilon_0,\\,2\\,\\epsilon_0)$\n        - Right: $\\boldsymbol{\\epsilon}^{(R)} = \\mathrm{diag}(5\\,\\epsilon_0,\\,5\\,\\epsilon_0)$\n    2. Anisotropic, real (diagonal contrast):\n        - Left: $\\boldsymbol{\\epsilon}^{(L)} = \\mathrm{diag}(1\\,\\epsilon_0,\\,10\\,\\epsilon_0)$\n        - Right: $\\boldsymbol{\\epsilon}^{(R)} = \\mathrm{diag}(10\\,\\epsilon_0,\\,1\\,\\epsilon_0)$\n    3. Anisotropic, complex (diagonal):\n        - Left: $\\boldsymbol{\\epsilon}^{(L)} = \\mathrm{diag}\\big((2 + 0.5\\,\\mathrm{i})\\,\\epsilon_0,\\,(3 + 0.2\\,\\mathrm{i})\\,\\epsilon_0\\big)$\n        - Right: $\\boldsymbol{\\epsilon}^{(R)} = \\mathrm{diag}\\big((5 + 1.0\\,\\mathrm{i})\\,\\epsilon_0,\\,(1 + 0.1\\,\\mathrm{i})\\,\\epsilon_0\\big)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a two-element list of floats $[\\Delta E_{\\mathrm{t},\\max}, \\Delta D_{\\mathrm{n},\\max}]$ in the units specified above, using complex modulus for magnitude in the complex case. For example, the output format must be like\n$$\n[\\,[\\Delta E_{\\mathrm{t},\\max}^{(1)},\\Delta D_{\\mathrm{n},\\max}^{(1)}],\\,[\\Delta E_{\\mathrm{t},\\max}^{(2)},\\Delta D_{\\mathrm{n},\\max}^{(2)}],\\,[\\Delta E_{\\mathrm{t},\\max}^{(3)},\\Delta D_{\\mathrm{n},\\max}^{(3)}]\\,].\n$$", "solution": "The electrostatic boundary-value problem is derived from fundamental principles. Begin with Gauss’s law in the absence of free charges, $\\nabla \\cdot \\mathbf{D} = 0$, and the constitutive relation $\\mathbf{D} = \\boldsymbol{\\epsilon}\\,\\mathbf{E}$, with the electric field $\\mathbf{E} = -\\nabla \\phi$. Substituting gives the second-order elliptic equation\n$$\n\\nabla \\cdot \\left( \\boldsymbol{\\epsilon}(x,y)\\,\\nabla \\phi(x,y) \\right) = 0,\n$$\nwhere $\\boldsymbol{\\epsilon}(x,y)$ is piecewise constant and diagonal within each subdomain. Across material interfaces without free surface charge and without surface current, the potential $\\phi$ is continuous, the tangential component of $\\mathbf{E}$ is continuous, and the normal component of $\\mathbf{D}$ is continuous. On the external boundary, Dirichlet conditions $\\phi = V$ are imposed, ensuring a well-posed linear system.\n\nTo discretize this equation on a uniform grid, employ a conservative finite-volume method (FVM), which is consistent with the divergence form and enforces local flux conservation. Let the grid have $N_x$ points in the $x$-direction and $N_y$ points in the $y$-direction, with spacings $\\Delta x = W/(N_x - 1)$ and $\\Delta y = H/(N_y - 1)$. Denote the discrete potential at node $(i,j)$ by $\\phi_{i,j}$. For a diagonal permittivity tensor $\\boldsymbol{\\epsilon} = \\mathrm{diag}(\\epsilon_x, \\epsilon_y)$, the fluxes through cell faces are approximated as\n$$\nF_x\\big|_{i+\\frac{1}{2},j} \\approx \\epsilon_{x,i+\\frac{1}{2},j}\\,\\frac{\\phi_{i+1,j} - \\phi_{i,j}}{\\Delta x},\n\\quad\nF_y\\big|_{i,j+\\frac{1}{2}} \\approx \\epsilon_{y,i,j+\\frac{1}{2}}\\,\\frac{\\phi_{i,j+1} - \\phi_{i,j}}{\\Delta y},\n$$\nwhere the face-centered coefficients are computed by harmonic averaging to ensure flux continuity across jumps in material properties:\n$$\n\\epsilon_{x,i+\\frac{1}{2},j} = \\frac{2\\,\\epsilon_{x,i,j}\\,\\epsilon_{x,i+1,j}}{\\epsilon_{x,i,j} + \\epsilon_{x,i+1,j}},\n\\quad\n\\epsilon_{y,i,j+\\frac{1}{2}} = \\frac{2\\,\\epsilon_{y,i,j}\\,\\epsilon_{y,i,j+1}}{\\epsilon_{y,i,j} + \\epsilon_{y,i,j+1}}.\n$$\nApplying the discrete divergence over each control volume yields the five-point stencil\n$$\n- \\left( a_E + a_W + a_N + a_S \\right)\\,\\phi_{i,j}\n+ a_E\\,\\phi_{i+1,j} + a_W\\,\\phi_{i-1,j} + a_N\\,\\phi_{i,j+1} + a_S\\,\\phi_{i,j-1} = 0,\n$$\nwith coefficients\n$$\na_E = \\frac{\\epsilon_{x,i+\\frac{1}{2},j}}{\\Delta x^2},\\quad\na_W = \\frac{\\epsilon_{x,i-\\frac{1}{2},j}}{\\Delta x^2},\\quad\na_N = \\frac{\\epsilon_{y,i,j+\\frac{1}{2}}}{\\Delta y^2},\\quad\na_S = \\frac{\\epsilon_{y,i,j-\\frac{1}{2}}}{\\Delta y^2}.\n$$\nFor nodes on the external boundary, enforce Dirichlet conditions directly by setting $\\phi_{i,j} = V_{\\mathrm{boundary}}$ and replacing the corresponding equation with an identity row.\n\nThe resulting linear system $A\\,\\boldsymbol{\\phi} = \\mathbf{b}$ is assembled in sparse format and solved using a robust sparse direct solver. The system supports complex-valued coefficients and unknowns, interpreting $\\boldsymbol{\\epsilon}$ and $\\phi$ as phasors, so the solution remains consistent with electroquasistatic conduction losses represented by complex permittivity.\n\nTo verify interface continuity, select the vertical interface lying between columns $i_{\\mathrm{L}}$ and $i_{\\mathrm{R}} = i_{\\mathrm{L}} + 1$, where $i_{\\mathrm{L}} = \\lfloor N_x/2 \\rfloor - 1$. The tangential direction along this interface is the $y$-direction, and the normal direction is the $x$-direction. Compute the electric field components by discrete differentiation:\n\n- Tangential electric field at the last left column and first right column via centered differences in $y$ (excluding the top and bottom boundaries to avoid one-sided differences):\n$$\nE_y^{(L)}(j) \\approx -\\frac{\\phi_{i_{\\mathrm{L}},\\,j+1} - \\phi_{i_{\\mathrm{L}},\\,j-1}}{2\\,\\Delta y},\\quad\nE_y^{(R)}(j) \\approx -\\frac{\\phi_{i_{\\mathrm{R}},\\,j+1} - \\phi_{i_{\\mathrm{R}},\\,j-1}}{2\\,\\Delta y}.\n$$\nUse the complex modulus to quantify the difference and define\n$$\n\\Delta E_{\\mathrm{t},\\max} = \\max_{j=1,\\ldots,N_y-2} \\left| E_y^{(L)}(j) - E_y^{(R)}(j) \\right|,\n$$\nexpressed in volts per meter (V/m).\n\n- Normal component of the electric flux density on each side via one-sided differences in $x$:\n$$\nE_x^{(L)}(j) \\approx -\\frac{\\phi_{i_{\\mathrm{L}},\\,j} - \\phi_{i_{\\mathrm{L}}-1,\\,j}}{\\Delta x},\\quad\nE_x^{(R)}(j) \\approx -\\frac{\\phi_{i_{\\mathrm{R}}+1,\\,j} - \\phi_{i_{\\mathrm{R}},\\,j}}{\\Delta x},\n$$\nand then\n$$\nD_x^{(L)}(j) = \\epsilon_{x}^{(L)}\\,E_x^{(L)}(j),\\quad\nD_x^{(R)}(j) = \\epsilon_{x}^{(R)}\\,E_x^{(R)}(j).\n$$\nDefine the jump metric\n$$\n\\Delta D_{\\mathrm{n},\\max} = \\max_{j=1,\\ldots,N_y-2} \\left| D_x^{(L)}(j) - D_x^{(R)}(j) \\right|,\n$$\nexpressed in coulombs per square meter (C/m$^2$). For complex-valued fields, use the complex modulus to compute magnitudes.\n\nThis procedure simultaneously evaluates the continuity of tangential $\\mathbf{E}$ and normal $\\mathbf{D}$ along the material interface under mixed Dirichlet boundary conditions, providing a stringent test across isotropic, anisotropic, and complex-valued permittivity tensors. The final program assembles the sparse system using harmonic face coefficients, solves for $\\phi$, computes the interface metrics $\\Delta E_{\\mathrm{t},\\max}$ and $\\Delta D_{\\mathrm{n},\\max}$ for each test case, and prints a single line containing a list of pairs $[\\Delta E_{\\mathrm{t},\\max}, \\Delta D_{\\mathrm{n},\\max}]$ for the entire test suite, in the units specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef harmonic_average(a, b):\n    # Handles complex values; avoid division by zero by small regularization if needed\n    if np.abs(a + b)  1e-15:\n        return (a + b) / 2.0\n    return (2.0 * a * b) / (a + b)\n\ndef assemble_and_solve(W, H, Nx, Ny, eps_left, eps_right, V_left, V_right, V_bottom, V_top):\n    # Grid spacings\n    dx = W / (Nx - 1)\n    dy = H / (Ny - 1)\n\n    # Material property arrays (diagonal tensors: eps_x, eps_y)\n    eps_x = np.empty((Nx, Ny), dtype=np.complex128)\n    eps_y = np.empty((Nx, Ny), dtype=np.complex128)\n\n    # Interface column index: last left column and first right column\n    iL = (Nx // 2) - 1\n    iR = iL + 1\n\n    # Fill material tensors: left side columns [0..iL], right side [iR..Nx-1]\n    eps_x[:iR, :] = eps_left[0]\n    eps_y[:iR, :] = eps_left[1]\n    eps_x[iR:, :] = eps_right[0]\n    eps_y[iR:, :] = eps_right[1]\n\n    N = Nx * Ny\n    A = lil_matrix((N, N), dtype=np.complex128)\n    b = np.zeros(N, dtype=np.complex128)\n\n    def idx(i, j):\n        return i + Nx * j\n\n    # Assemble matrix\n    for j in range(Ny):\n        for i in range(Nx):\n            p = idx(i, j)\n            # Boundary Dirichlet conditions\n            on_left = (i == 0)\n            on_right = (i == Nx - 1)\n            on_bottom = (j == 0)\n            on_top = (j == Ny - 1)\n\n            if on_left or on_right or on_bottom or on_top:\n                # Dirichlet: set identity row\n                A[p, p] = 1.0 + 0.0j\n                # Determine boundary potential\n                if on_left:\n                    b[p] = V_left\n                if on_right:\n                    b[p] = V_right\n                if on_bottom:\n                    b[p] = V_bottom\n                if on_top:\n                    b[p] = V_top\n                continue\n\n            # Interior node: compute face coefficients via harmonic average\n            # East\n            kxe = harmonic_average(eps_x[i, j], eps_x[i + 1, j])\n            ae = kxe / (dx * dx)\n            # West\n            kxw = harmonic_average(eps_x[i, j], eps_x[i - 1, j])\n            aw = kxw / (dx * dx)\n            # North\n            kyn = harmonic_average(eps_y[i, j], eps_y[i, j + 1])\n            an = kyn / (dy * dy)\n            # South\n            kys = harmonic_average(eps_y[i, j], eps_y[i, j - 1])\n            a_s = kys / (dy * dy)\n\n            # Center coefficient\n            ap = -(ae + aw + an + a_s)\n\n            # Fill matrix\n            A[p, p] = ap\n            A[p, idx(i + 1, j)] = ae\n            A[p, idx(i - 1, j)] = aw\n            A[p, idx(i, j + 1)] = an\n            A[p, idx(i, j - 1)] = a_s\n            # RHS is zero for interior nodes\n\n    # Solve\n    A_csr = csr_matrix(A)\n    phi = spsolve(A_csr, b)  # complex solution\n\n    # Compute interface continuity metrics\n    # Tangential E along vertical interface is Ey; use centered differences in y\n    Ey_left = []\n    Ey_right = []\n    # Avoid top/bottom boundaries for centered difference\n    for j in range(1, Ny - 1):\n        pL_up = idx(iL, j + 1)\n        pL_dn = idx(iL, j - 1)\n        pR_up = idx(iR, j + 1)\n        pR_dn = idx(iR, j - 1)\n        EyL = -(phi[pL_up] - phi[pL_dn]) / (2.0 * dy)\n        EyR = -(phi[pR_up] - phi[pR_dn]) / (2.0 * dy)\n        Ey_left.append(EyL)\n        Ey_right.append(EyR)\n    Ey_left = np.array(Ey_left, dtype=np.complex128)\n    Ey_right = np.array(Ey_right, dtype=np.complex128)\n    dEt = np.abs(Ey_left - Ey_right)\n    delta_Et_max = float(np.max(dEt))  # in V/m\n\n    # Normal D across vertical interface is Dx; use one-sided differences in x\n    Dx_left = []\n    Dx_right = []\n    for j in range(1, Ny - 1):\n        # Backward difference at iL\n        pL = idx(iL, j)\n        pLm1 = idx(iL - 1, j)\n        ExL = -(phi[pL] - phi[pLm1]) / dx\n        epsxL = eps_x[iL, j]\n        DxL = epsxL * ExL\n        Dx_left.append(DxL)\n\n        # Forward difference at iR\n        pR = idx(iR, j)\n        pRp1 = idx(iR + 1, j)\n        ExR = -(phi[pRp1] - phi[pR]) / dx\n        epsxR = eps_x[iR, j]\n        DxR = epsxR * ExR\n        Dx_right.append(DxR)\n        \n    Dx_left = np.array(Dx_left, dtype=np.complex128)\n    Dx_right = np.array(Dx_right, dtype=np.complex128)\n    dDn = np.abs(Dx_left - Dx_right)\n    delta_Dn_max = float(np.max(dDn))  # in C/m^2\n\n    return delta_Et_max, delta_Dn_max\n\ndef solve():\n    # Define constants and test cases from the problem statement.\n    eps0 = 8.854187817e-12  # F/m\n    W = 1.0e-2  # m\n    H = 1.0e-2  # m\n    Nx = 64\n    Ny = 64\n\n    V_left = 0.5 + 0.0j  # V\n    V_right = 0.0 + 0.0j  # V\n    V_bottom = 0.0 + 0.0j  # V\n    V_top = 1.0 + 0.0j  # V\n\n    test_cases = [\n        # (eps_left (eps_x, eps_y), eps_right (eps_x, eps_y))\n        ((2.0 * eps0 + 0.0j, 2.0 * eps0 + 0.0j), (5.0 * eps0 + 0.0j, 5.0 * eps0 + 0.0j)),\n        ((1.0 * eps0 + 0.0j, 10.0 * eps0 + 0.0j), (10.0 * eps0 + 0.0j, 1.0 * eps0 + 0.0j)),\n        (((2.0 + 0.5j) * eps0, (3.0 + 0.2j) * eps0), ((5.0 + 1.0j) * eps0, (1.0 + 0.1j) * eps0)),\n    ]\n\n    results = []\n    for eps_left, eps_right in test_cases:\n        delta_Et_max, delta_Dn_max = assemble_and_solve(\n            W, H, Nx, Ny,\n            eps_left=eps_left,\n            eps_right=eps_right,\n            V_left=V_left, V_right=V_right, V_bottom=V_bottom, V_top=V_top\n        )\n        results.append([delta_Et_max, delta_Dn_max])\n\n    # Final print statement in the exact required format.\n    # Ensure pure float rendering without additional text.\n    print(f\"[[{results[0][0]},{results[0][1]}],[{results[1][0]},{results[1][1]}],[{results[2][0]},{results[2][1]}]]\")\n\nsolve()\n```", "id": "3514139"}, {"introduction": "A key skill in multiphysics modeling is choosing the appropriate physical approximation to balance computational cost and accuracy. This practice directly addresses this challenge by comparing a full-wave electromagnetic solution with the widely-used magnetoquasistatic (MQS) approximation for eddy currents in a conductor [@problem_id:3514073]. By quantifying the error of the MQS model under different conditions, you will develop the physical intuition and practical judgment needed to determine when displacement currents are negligible, a critical decision in many low-to-mid-frequency simulations.", "problem": "Consider an infinite, homogeneous, isotropic conducting half-space occupying $x \\ge 0$ with constant electrical conductivity $\\sigma$ (in $\\mathrm{S/m}$), magnetic permeability $\\mu$ (in $\\mathrm{H/m}$), and electric permittivity $\\epsilon$ (in $\\mathrm{F/m}$). A time-harmonic tangential magnetic field with complex amplitude $H_0$ (in $\\mathrm{A/m}$) is imposed at the surface: the total magnetic field is $H_z(x,t) = \\Re\\{ \\tilde{H}_z(x) e^{j \\omega t} \\}$, with the boundary condition $\\tilde{H}_z(0) = H_0$ and angular frequency $\\omega = 2 \\pi f$ (with $f$ in $\\mathrm{Hz}$). Assume one-dimensional variation along the normal direction $x$ and uniformity along tangential directions, with nonzero field components $\\tilde{E}_y(x)$ and $\\tilde{H}_z(x)$ only.\n\nStarting from Maxwell's equations and the constitutive relations in the International System of Units (SI),\n- Faraday's law: $\\nabla \\times \\tilde{E} = - j \\omega \\tilde{B}$,\n- Ampère-Maxwell law: $\\nabla \\times \\tilde{H} = \\tilde{J} + j \\omega \\tilde{D}$,\n- Ohm's law: $\\tilde{J} = \\sigma \\tilde{E}$,\n- Electric displacement: $\\tilde{D} = \\epsilon \\tilde{E}$,\n- Magnetic flux: $\\tilde{B} = \\mu \\tilde{H}$,\nderive the governing one-dimensional equations for $\\tilde{E}_y(x)$ and $\\tilde{H}_z(x)$ under the stated symmetry and time-harmonic convention $e^{j \\omega t}$.\n\nThen:\n- Derive the full solution for the eddy current density $\\tilde{J}_y(x)$ including displacement current (the full Maxwell solution).\n- Derive the magnetoquasistatic (MQS) solution by neglecting displacement current (i.e., omitting the $j \\omega \\epsilon \\tilde{E}$ term in the Ampère-Maxwell law), and obtain the corresponding eddy current density $\\tilde{J}_y^{\\mathrm{MQS}}(x)$.\n- For each test case below, define an evaluation interval $x \\in [0, L]$ where $L$ equals $5$ times the characteristic penetration depth of the MQS solution (commonly referred to as the skin depth of the MQS solution). All distances must be in $\\mathrm{m}$.\n- On this interval, compute the relative $L^2$ error between the MQS and full Maxwell eddy current densities:\n$$\n\\mathcal{E} = \\sqrt{\\frac{\\int_0^{L} \\left| \\tilde{J}_y(x) - \\tilde{J}_y^{\\mathrm{MQS}}(x) \\right|^2 \\, \\mathrm{d}x}{\\int_0^{L} \\left| \\tilde{J}_y(x) \\right|^2 \\, \\mathrm{d}x}}.\n$$\nHere $\\left| \\cdot \\right|$ denotes the complex modulus. The error $\\mathcal{E}$ is dimensionless and must be reported as a floating-point number.\n\nYour implementation must use a numerical quadrature over a uniform grid with at least $1000$ points spanning $[0, L]$ to approximate the integrals. All input parameters must be interpreted in SI units: $\\sigma$ in $\\mathrm{S/m}$, $\\mu$ in $\\mathrm{H/m}$, $\\epsilon$ in $\\mathrm{F/m}$, $f$ in $\\mathrm{Hz}$, $H_0$ in $\\mathrm{A/m}$, and $L$ in $\\mathrm{m}$.\n\nTest suite:\nUse the following four scientifically consistent parameter sets; for each case, set $L$ to $5$ times the MQS penetration depth as specified above.\n\n- Case $1$ (good conductor, low frequency, non-magnetic):\n  - $\\sigma = 5.8 \\times 10^{7} \\ \\mathrm{S/m}$,\n  - $\\mu = \\mu_0$ with $\\mu_0 = 4 \\pi \\times 10^{-7} \\ \\mathrm{H/m}$,\n  - $\\epsilon = \\epsilon_0$ with $\\epsilon_0 = 8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$,\n  - $f = 60 \\ \\mathrm{Hz}$,\n  - $H_0 = 1 \\ \\mathrm{A/m}$.\n\n- Case $2$ (magnetic material, moderate conductivity, low frequency):\n  - $\\sigma = 1 \\times 10^{6} \\ \\mathrm{S/m}$,\n  - $\\mu = 100 \\, \\mu_0$,\n  - $\\varepsilon = \\epsilon_0$,\n  - $f = 100 \\ \\mathrm{Hz}$,\n  - $H_0 = 1 \\ \\mathrm{A/m}$.\n\n- Case $3$ (poor conductor, high permittivity, high frequency; displacement current significant):\n  - $\\sigma = 1 \\times 10^{-6} \\ \\mathrm{S/m}$,\n  - $\\mu = \\mu_0$,\n  - $\\epsilon = 4 \\, \\epsilon_0$,\n  - $f = 10^{6} \\ \\mathrm{Hz}$,\n  - $H_0 = 1 \\ \\mathrm{A/m}$.\n\n- Case $4$ (intermediate conductivity, higher frequency; transitional regime):\n  - $\\sigma = 1 \\times 10^{3} \\ \\mathrm{S/m}$,\n  - $\\mu = \\mu_0$,\n  - $\\epsilon = \\epsilon_0$,\n  - $f = 10^{5} \\ \\mathrm{Hz}$,\n  - $H_0 = 1 \\ \\mathrm{A/m}$.\n\nFinal output format:\nYour program should produce a single line of output containing the relative $L^2$ errors for the $4$ test cases as a comma-separated list enclosed in square brackets, for example, $\\left[ e_1, e_2, e_3, e_4 \\right]$, where each $e_i$ is a floating-point number. The line must be exactly in the format $\\left[ e_1,e_2,e_3,e_4 \\right]$ with commas separating the values and no additional spaces.", "solution": "The problem is well-posed, scientifically grounded, and provides sufficient information for a unique solution. We proceed with the derivation and computational solution.\n\nThe analysis begins with the time-harmonic form of Maxwell's equations in a linear, isotropic, and homogeneous medium, using the $e^{j \\omega t}$ convention:\n1.  Faraday's Law: $\\nabla \\times \\tilde{E} = - j \\omega \\tilde{B}$\n2.  Ampère-Maxwell Law: $\\nabla \\times \\tilde{H} = \\tilde{J} + j \\omega \\tilde{D}$\n\nThe constitutive relations are:\n3.  Ohm's Law: $\\tilde{J} = \\sigma \\tilde{E}$\n4.  Electric Displacement: $\\tilde{D} = \\epsilon \\tilde{E}$\n5.  Magnetic Flux Density: $\\tilde{B} = \\mu \\tilde{H}$\n\nSubstituting the constitutive relations $3$, $4$, and $5$ into $1$ and $2$ yields:\n$$ \\nabla \\times \\tilde{E} = - j \\omega \\mu \\tilde{H} $$\n$$ \\nabla \\times \\tilde{H} = \\sigma \\tilde{E} + j \\omega \\epsilon \\tilde{E} = (\\sigma + j \\omega \\epsilon) \\tilde{E} $$\n\nThe problem states that the fields vary only in the $x$ direction and have only specific components: $\\tilde{E} = \\tilde{E}_y(x) \\hat{y}$ and $\\tilde{H} = \\tilde{H}_z(x) \\hat{z}$. The curl operator in Cartesian coordinates simplifies under these conditions:\n$$ \\nabla \\times \\tilde{E} = (\\frac{\\partial E_z}{\\partial y} - \\frac{\\partial E_y}{\\partial z})\\hat{x} + (\\frac{\\partial E_x}{\\partial z} - \\frac{\\partial E_z}{\\partial x})\\hat{y} + (\\frac{\\partial E_y}{\\partial x} - \\frac{\\partial E_x}{\\partial y})\\hat{z} = \\frac{d\\tilde{E}_y(x)}{dx} \\hat{z} $$\nThere is a sign error in the standard curl formula as recalled. Let's re-verify: $\\nabla \\times \\mathbf{F}$'s z-component is indeed $\\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y}$. The y-component is $\\frac{\\partial F_x}{\\partial z} - \\frac{\\partial F_z}{\\partial x}$.\nFor $\\tilde{E} = \\tilde{E}_y(x) \\hat{y}$, we have $\\nabla \\times \\tilde{E} = - \\frac{d\\tilde{E}_y}{dx} \\hat{z}$.\nFor $\\tilde{H} = \\tilde{H}_z(x) \\hat{z}$, we have $\\nabla \\times \\tilde{H} = \\frac{d\\tilde{H}_z}{dx} \\hat{y}$.\n\nSubstituting these simplified curls into Maxwell's equations gives a system of one-dimensional ordinary differential equations:\n$$ - \\frac{d\\tilde{E}_y}{dx} \\hat{z} = -j \\omega \\mu \\tilde{H}_z \\hat{z} \\implies \\frac{d\\tilde{E}_y}{dx} = j \\omega \\mu \\tilde{H}_z \\quad (I) $$\n$$ \\frac{d\\tilde{H}_z}{dx} \\hat{y} = (\\sigma + j \\omega \\epsilon) \\tilde{E}_y \\hat{y} \\implies \\frac{d\\tilde{H}_z}{dx} = (\\sigma + j \\omega \\epsilon) \\tilde{E}_y \\quad (II) $$\n\nTo obtain a governing equation for $\\tilde{H}_z$, we differentiate equation $(II)$ with respect to $x$ and substitute equation $(I)$:\n$$ \\frac{d^2\\tilde{H}_z}{dx^2} = (\\sigma + j \\omega \\epsilon) \\frac{d\\tilde{E}_y}{dx} = (\\sigma + j \\omega \\epsilon) (j \\omega \\mu \\tilde{H}_z) $$\nThis is the Helmholtz equation for $\\tilde{H}_z(x)$:\n$$ \\frac{d^2\\tilde{H}_z}{dx^2} - \\gamma^2 \\tilde{H}_z = 0 $$\nwhere $\\gamma$ is the complex propagation constant, defined by $\\gamma^2 = j \\omega \\mu (\\sigma + j \\omega \\epsilon)$.\n\nThe general solution is $\\tilde{H}_z(x) = A e^{-\\gamma x} + C e^{\\gamma x}$. For a physically realistic solution in the half-space $x \\ge 0$, the fields must decay as $x \\to \\infty$. We must choose the root for $\\gamma$ such that its real part $\\Re\\{\\gamma\\} > 0$. This forces the coefficient of the growing exponential term to be zero, so $C=0$. The boundary condition at the surface is $\\tilde{H}_z(0) = H_0$, which gives $A=H_0$. Thus, the full Maxwell solution for the magnetic field is:\n$$ \\tilde{H}_z(x) = H_0 e^{-\\gamma x} $$\n\nFrom equation $(II)$, we can find the electric field $\\tilde{E}_y(x)$:\n$$ \\tilde{E}_y(x) = \\frac{1}{\\sigma + j \\omega \\epsilon} \\frac{d\\tilde{H}_z}{dx} = \\frac{1}{\\sigma + j \\omega \\epsilon} (- \\gamma H_0 e^{-\\gamma x}) = - \\frac{\\gamma}{\\sigma + j \\omega \\epsilon} H_0 e^{-\\gamma x} $$\nThe eddy current density is $\\tilde{J}_y(x) = \\sigma \\tilde{E}_y(x)$. Therefore, the full solution for the eddy current density is:\n$$ \\tilde{J}_y(x) = - \\frac{\\sigma \\gamma}{\\sigma + j \\omega \\epsilon} H_0 e^{-\\gamma x} \\quad (\\text{Full Maxwell Solution}) $$\nwhere $\\gamma = \\sqrt{j \\omega \\mu (\\sigma + j \\omega \\epsilon)}$.\n\nNext, we derive the magnetoquasistatic (MQS) solution. The MQS approximation neglects displacement current, which is equivalent to setting $\\epsilon = 0$ or, more formally, dropping the $j \\omega \\epsilon \\tilde{E}$ term. The Ampère-Maxwell law becomes $\\nabla \\times \\tilde{H} = \\tilde{J} = \\sigma \\tilde{E}$.\nEquation $(II)$ simplifies to $\\frac{d\\tilde{H}_z}{dx} = \\sigma \\tilde{E}_y$. The Helmholtz equation for $\\tilde{H}_z$ becomes:\n$$ \\frac{d^2\\tilde{H}_z^{\\mathrm{MQS}}}{dx^2} - (\\gamma^{\\mathrm{MQS}})^2 \\tilde{H}_z^{\\mathrm{MQS}} = 0 $$\nwhere the MQS propagation constant is $(\\gamma^{\\mathrm{MQS}})^2 = j \\omega \\mu \\sigma$.\nThe solution for the magnetic field, applying the same boundary conditions, is:\n$$ \\tilde{H}_z^{\\mathrm{MQS}}(x) = H_0 e^{-\\gamma^{\\mathrm{MQS}} x} $$\nFrom the simplified Ampère's law, $\\tilde{E}_y^{\\mathrm{MQS}}(x) = \\frac{1}{\\sigma} \\frac{d\\tilde{H}_z^{\\mathrm{MQS}}}{dx} = -\\frac{\\gamma^{\\mathrm{MQS}}}{\\sigma} H_0 e^{-\\gamma^{\\mathrm{MQS}} x}$.\nThe corresponding MQS eddy current density is $\\tilde{J}_y^{\\mathrm{MQS}}(x) = \\sigma \\tilde{E}_y^{\\mathrm{MQS}}(x)$:\n$$ \\tilde{J}_y^{\\mathrm{MQS}}(x) = - \\gamma^{\\mathrm{MQS}} H_0 e^{-\\gamma^{\\mathrm{MQS}} x} \\quad (\\text{MQS Solution}) $$\nwhere $\\gamma^{\\mathrm{MQS}} = \\sqrt{j \\omega \\mu \\sigma}$.\n\nThe MQS propagation constant can be expressed as $\\gamma^{\\mathrm{MQS}} = \\sqrt{j} \\sqrt{\\omega \\mu \\sigma} = \\frac{1+j}{\\sqrt{2}} \\sqrt{\\omega \\mu \\sigma} = \\frac{1+j}{\\delta}$, where $\\delta = \\sqrt{\\frac{2}{\\omega \\mu \\sigma}}$ is the classical skin depth. The problem defines the integration interval as $x \\in [0, L]$, with $L = 5\\delta$.\n\nThe relative $L^2$ error between the MQS and full Maxwell solutions is:\n$$ \\mathcal{E} = \\sqrt{\\frac{\\int_0^{L} \\left| \\tilde{J}_y(x) - \\tilde{J}_y^{\\mathrm{MQS}}(x) \\right|^2 \\, \\mathrm{d}x}{\\int_0^{L} \\left| \\tilde{J}_y(x) \\right|^2 \\, \\mathrm{d}x}} $$\nTo compute $\\mathcal{E}$, we will use numerical integration. We establish a uniform grid of $N \\ge 1000$ points over the interval $[0, L]$. For each point $x_i$ on the grid, we evaluate the complex values of $\\tilde{J}_y(x_i)$ and $\\tilde{J}_y^{\\mathrm{MQS}}(x_i)$ using the derived expressions. We then compute the squared magnitudes of their difference for the numerator's integrand and the squared magnitude of the full solution for the denominator's integrand. The integrals are approximated using a numerical quadrature rule, such as Simpson's rule, a standard method for integration over a uniform grid. Finally, the error $\\mathcal{E}$ is computed from the ratio of these integrals. The parameter $H_0$ is a common multiplicative factor in all current densities and thus cancels out in the final error calculation.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Solves the electromagnetism problem for the given test cases.\n    It calculates the relative L2 error between the full Maxwell and MQS\n    solutions for eddy current density.\n    \"\"\"\n    \n    # Physical constants in SI units\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space (H/m)\n    EPSILON_0 = 8.854187817e-12  # Permittivity of free space (F/m)\n\n    test_cases = [\n        # Case 1: good conductor, low frequency, non-magnetic\n        # sigma (S/m), mu_r, epsilon_r, f (Hz), H0 (A/m)\n        (5.8e7, 1.0, 1.0, 60, 1.0),\n        # Case 2: magnetic material, moderate conductivity, low frequency\n        (1.0e6, 100.0, 1.0, 100, 1.0),\n        # Case 3: poor conductor, high permittivity, high frequency\n        (1.0e-6, 1.0, 4.0, 1.0e6, 1.0),\n        # Case 4: intermediate conductivity, higher frequency\n        (1.0e3, 1.0, 1.0, 1.0e5, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        sigma, mu_r, epsilon_r, f, H0 = case\n        \n        # Absolute material properties\n        mu = mu_r * MU_0\n        epsilon = epsilon_r * EPSILON_0\n        omega = 2 * np.pi * f\n        \n        # --- MQS Solution ---\n        # MQS propagation constant\n        gamma_mqs = np.sqrt(1j * omega * mu * sigma)\n        \n        # Classical skin depth for MQS solution\n        # This defines the integration domain length L\n        if omega * mu * sigma > 0:\n            skin_depth_mqs = np.sqrt(2 / (omega * mu * sigma))\n        else:\n            # Handle cases with zero sigma or omega to avoid division by zero,\n            # though not present in test suite.\n            skin_depth_mqs = np.inf\n\n        L = 5 * skin_depth_mqs\n        \n        # If L is infinite or very large, cap it for practical computation.\n        # This scenario implies MQS predicts no decay, which would make the integral diverge.\n        # However, the test cases provided are well-behaved.\n        if np.isinf(L):\n           L = 1.0 # Fallback for non-conducting case.\n\n        # --- Full Maxwell Solution ---\n        # Full propagation constant\n        complex_permittivity = sigma + 1j * omega * epsilon\n        gamma_full = np.sqrt(1j * omega * mu * complex_permittivity)\n\n        # Ensure the root with positive real part is used for decaying wave\n        if np.real(gamma_full)  0:\n            gamma_full = -gamma_full\n        \n        # --- Numerical Integration Setup ---\n        # Create a uniform grid with N > 1000 points\n        N = 2000\n        x = np.linspace(0, L, N)\n\n        # --- Calculate Current Densities on the Grid ---\n        # The constant H0 cancels in the relative error formula.\n        # J_y(x) = C_full * exp(-gamma_full * x)\n        # J_y_MQS(x) = C_mqs * exp(-gamma_mqs * x)\n        \n        # Prefactor for full Maxwell current density\n        C_full = -H0 * sigma * gamma_full / complex_permittivity\n        \n        # Prefactor for MQS current density\n        C_mqs = -H0 * gamma_mqs\n        \n        # Evaluate current densities on the grid\n        J_full_vals = C_full * np.exp(-gamma_full * x)\n        J_mqs_vals = C_mqs * np.exp(-gamma_mqs * x)\n        \n        # --- Compute L2 Norms using Simpson's Rule ---\n        # The integrands are the squared magnitudes\n        integrand_num = np.abs(J_full_vals - J_mqs_vals)**2\n        integrand_den = np.abs(J_full_vals)**2\n\n        # Integrate using scipy.integrate.simpson\n        integral_num = simpson(y=integrand_num, x=x)\n        integral_den = simpson(y=integrand_den, x=x)\n        \n        # --- Calculate Relative Error ---\n        # Guard against division by zero if the true solution is identically zero\n        if integral_den == 0:\n            error = 0.0 if integral_num == 0 else np.inf\n        else:\n            error = np.sqrt(integral_num / integral_den)\n            \n        results.append(error)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3514073"}]}