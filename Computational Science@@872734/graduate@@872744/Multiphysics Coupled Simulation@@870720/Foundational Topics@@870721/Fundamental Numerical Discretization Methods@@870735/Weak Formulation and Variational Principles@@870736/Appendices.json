{"hands_on_practices": [{"introduction": "A cornerstone of modern simulation is the ability to solve inverse and optimization problems, where we seek to determine unknown causes (like forces or material properties) from observed effects. This practice guides you through the application of the calculus of variations to derive the governing equations for a PDE-constrained optimization problem. By constructing a Lagrangian and finding its stationary point, you will derive the full optimality system, including the crucial adjoint equation, providing a foundational skill for sensitivity analysis and gradient-based optimization. [@problem_id:3532291]", "problem": "Consider a distributed parameter optimization problem arising from a simplified multiphysics coupling where a scalar potential field is driven by a source distribution. Let $\\Omega \\subset \\mathbb{R}^{d}$ be a bounded domain with Lipschitz boundary $\\partial \\Omega$, and assume homogeneous Dirichlet boundary conditions. The state variable $u$ and the control $f$ are related by the Poisson-type Partial Differential Equation (PDE)\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \\qquad u = 0 \\quad \\text{on } \\partial \\Omega,\n$$\nwith $u \\in H_{0}^{1}(\\Omega)$ and $f \\in L^{2}(\\Omega)$. The desired target field $u_{d}$ is prescribed and satisfies $u_{d} \\in H_{0}^{1}(\\Omega) \\cap H^{2}(\\Omega)$. The objective functional to be minimized is\n$$\nJ(u) = \\frac{1}{2}\\int_{\\Omega} (u - u_{d})^{2}\\, dx.\n$$\nUsing the calculus of variations for functionals over infinite-dimensional spaces and Lagrange multipliers for PDE-constrained optimization, construct the continuous adjoint by forming a Lagrangian that enforces the PDE constraint in weak form. Derive the weak formulation of the state and adjoint equations, the corresponding strong forms with boundary conditions, and the first-order optimality condition with respect to the control. Then, eliminate the adjoint and state variables to obtain a single explicit expression for the optimal control $f^{\\ast}$ solely in terms of the given data $u_{d}$.\n\nExpress your final result as a closed-form analytic expression. No rounding is required, and no units should be included in your final expression.", "solution": "The optimization problem is to find a control $f \\in L^2(\\Omega)$ and a corresponding state $u \\in H_0^1(\\Omega)$ that minimize the objective functional\n$$\nJ(u) = \\frac{1}{2}\\int_{\\Omega} (u - u_{d})^{2}\\, dx\n$$\nsubject to the state equation\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \\qquad u = 0 \\quad \\text{on } \\partial \\Omega.\n$$\nWe use the method of Lagrange multipliers to solve this constrained optimization problem. First, we must express the state equation in its weak (or variational) form. We multiply the PDE by an arbitrary test function $v \\in H_0^1(\\Omega)$ and integrate over $\\Omega$:\n$$\n-\\int_{\\Omega} (\\Delta u) v \\, dx = \\int_{\\Omega} f v \\, dx.\n$$\nApplying integration by parts (Green's first identity) to the left-hand side gives\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx - \\int_{\\partial\\Omega} (\\nabla u \\cdot \\mathbf{n}) v \\, dS = \\int_{\\Omega} f v \\, dx.\n$$\nSince the test function $v \\in H_0^1(\\Omega)$, we have $v=0$ on $\\partial\\Omega$, which makes the boundary integral vanish. The weak form of the state equation is thus: Find $u \\in H_0^1(\\Omega)$ such that\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx = \\int_{\\Omega} f v \\, dx \\quad \\forall v \\in H_0^1(\\Omega).\n$$\nWe can define a Lagrangian functional $\\mathcal{L}(u, f, p)$ by augmenting the objective functional with the weak form of the constraint, where the Lagrange multiplier $p$ (the adjoint state) is a function in the same space as the test functions, i.e., $p \\in H_0^1(\\Omega)$.\n$$\n\\mathcal{L}(u, f, p) = J(u) + \\left( \\int_{\\Omega} \\nabla u \\cdot \\nabla p \\, dx - \\int_{\\Omega} f p \\, dx \\right).\n$$\nSubstituting the expression for $J(u)$, we have\n$$\n\\mathcal{L}(u, f, p) = \\frac{1}{2}\\int_{\\Omega} (u - u_{d})^{2}\\, dx + \\int_{\\Omega} \\nabla u \\cdot \\nabla p \\, dx - \\int_{\\Omega} f p \\, dx.\n$$\nThe first-order necessary conditions for an extremum are that the Gateaux derivatives of $\\mathcal{L}$ with respect to each variable ($u$, $f$, and $p$) vanish at the optimal point $(u^*, f^*, p^*)$.\n\n1.  **Derivative with respect to the adjoint state $p$**: We compute the variation of $\\mathcal{L}$ with respect to $p$ in an arbitrary direction $\\delta p \\in H_0^1(\\Omega)$.\n    $$\n    \\delta_p \\mathcal{L}[\\delta p] = \\frac{d}{d\\epsilon} \\mathcal{L}(u, f, p+\\epsilon\\delta p)\\bigg|_{\\epsilon=0} = \\int_{\\Omega} \\nabla u \\cdot \\nabla(\\delta p) \\, dx - \\int_{\\Omega} f \\delta p \\, dx.\n    $$\n    Setting this to zero for all $\\delta p \\in H_0^1(\\Omega)$ recovers the weak form of the state equation:\n    $$\n    \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx = \\int_{\\Omega} f v \\, dx \\quad \\forall v \\in H_0^1(\\Omega).\n    $$\n    The corresponding strong form is $-\\Delta u = f$ in $\\Omega$, with boundary condition $u=0$ on $\\partial\\Omega$.\n\n2.  **Derivative with respect to the state $u$**: We compute the variation of $\\mathcal{L}$ with respect to $u$ in an arbitrary direction $\\delta u \\in H_0^1(\\Omega)$.\n    $$\n    \\delta_u \\mathcal{L}[\\delta u] = \\frac{d}{d\\epsilon} \\mathcal{L}(u+\\epsilon\\delta u, f, p)\\bigg|_{\\epsilon=0} = \\int_{\\Omega} (u - u_d) \\delta u \\, dx + \\int_{\\Omega} \\nabla(\\delta u) \\cdot \\nabla p \\, dx.\n    $$\n    Setting this to zero for all $\\delta u \\in H_0^1(\\Omega)$ yields the adjoint equation in weak form:\n    $$\n    \\int_{\\Omega} \\nabla p \\cdot \\nabla v \\, dx = - \\int_{\\Omega} (u - u_d) v \\, dx = \\int_{\\Omega} (u_d - u) v \\, dx \\quad \\forall v \\in H_0^1(\\Omega).\n    $$\n    The right-hand side term $u_d - u$ is in $L^2(\\Omega)$. By elliptic regularity theory, the corresponding strong form of the adjoint equation is $-\\Delta p = u_d - u$ in $\\Omega$, with boundary condition $p=0$ on $\\partial\\Omega$.\n\n3.  **Derivative with respect to the control $f$**: We compute the variation of $\\mathcal{L}$ with respect to $f$ in an arbitrary direction $\\delta f \\in L^2(\\Omega)$.\n    $$\n    \\delta_f \\mathcal{L}[\\delta f] = \\frac{d}{d\\epsilon} \\mathcal{L}(u, f+\\epsilon\\delta f, p)\\bigg|_{\\epsilon=0} = - \\int_{\\Omega} p \\, \\delta f \\, dx.\n    $$\n    Setting this to zero for all $\\delta f \\in L^2(\\Omega)$ gives $\\int_{\\Omega} p \\, \\delta f \\, dx = 0$. By the fundamental lemma of calculus of variations, this implies that the multiplier $p$ must be zero almost everywhere in $\\Omega$. This is the first-order optimality condition:\n    $$\n    p = 0 \\quad \\text{in } \\Omega.\n    $$\n\nSummarizing, the optimality system consists of the state equation, the adjoint equation, and the optimality condition:\n(i) State (strong form): $-\\Delta u = f$ in $\\Omega$, $u=0$ on $\\partial\\Omega$.\n(ii) Adjoint (strong form): $-\\Delta p = u_d - u$ in $\\Omega$, $p=0$ on $\\partial\\Omega$.\n(iii) Optimality condition: $p=0$ in $\\Omega$.\n\nWe now solve this system for the optimal control $f^*$.\nFirst, substitute the optimality condition $p=0$ into the adjoint equation (ii):\n$$\n-\\Delta(0) = u_d - u \\implies 0 = u_d - u \\implies u = u_d.\n$$\nThis result indicates that at the optimum, the state $u$ must be identical to the target state $u_d$. This is achievable because the objective functional does not include a penalty on the control, meaning the control effort is \"free\". The minimum value of the objective functional is $J(u_d) = \\frac{1}{2}\\int_{\\Omega} (u_d - u_d)^2 dx = 0$.\n\nNext, we substitute the result $u = u_d$ into the state equation (i) to find the corresponding optimal control $f^*$:\n$$\n-\\Delta u_d = f^*.\n$$\nThe problem states that $u_d \\in H^2(\\Omega)$, which guarantees that its Laplacian, $\\Delta u_d$, is a well-defined function in $L^2(\\Omega)$. Therefore, $f^* = -\\Delta u_d$ is an admissible control, i.e., $f^* \\in L^2(\\Omega)$.\n\nThe explicit expression for the optimal control $f^*$ solely in terms of the given data $u_d$ is $f^* = -\\Delta u_d$.", "answer": "$$\\boxed{-\\Delta u_{d}}$$", "id": "3532291"}, {"introduction": "While weak formulations provide a powerful basis for the finite element method, a direct discretization of the underlying PDE can sometimes lead to catastrophic numerical failures. This practice explores the phenomenon of \"volumetric locking\" in nearly incompressible elasticity, where low-order elements become unphysically stiff. You will analyze how a mixed variational formulation, which treats pressure as an independent field, circumvents this issue and leads to the critical Ladyzhenskaya–Babuška–Brezzi (LBB) stability condition. [@problem_id:3532251]", "problem": "Consider small-strain, isotropic, static linear elasticity on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$ with $d \\in \\{2,3\\}$, subject to body force density $\\boldsymbol{f}$, traction $\\boldsymbol{t}$ on a Neumann boundary $\\Gamma_N$, and homogeneous displacement on a Dirichlet boundary $\\Gamma_D$, with $\\Gamma_D \\cup \\Gamma_N = \\partial \\Omega$ and $\\Gamma_D \\cap \\Gamma_N = \\emptyset$. Let the displacement be $\\boldsymbol{u} : \\Omega \\to \\mathbb{R}^d$, the small-strain tensor be $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) := \\tfrac{1}{2}\\big(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^\\top\\big)$, the stress be $\\boldsymbol{\\sigma}(\\boldsymbol{u}) := 2\\mu\\, \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\, (\\nabla \\cdot \\boldsymbol{u}) \\boldsymbol{I}$, and the Lamé parameters satisfy $\\mu > 0$ and $\\lambda \\ge 0$. The governing equation is the balance of linear momentum $\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u}) + \\boldsymbol{f} = \\boldsymbol{0}$ in $\\Omega$, with $\\boldsymbol{u} = \\boldsymbol{0}$ on $\\Gamma_D$ and $\\boldsymbol{\\sigma}(\\boldsymbol{u})\\boldsymbol{n} = \\boldsymbol{t}$ on $\\Gamma_N$. The nearly incompressible regime corresponds to Poisson ratio $\\nu \\to \\tfrac{1}{2}$, equivalently $\\lambda \\to \\infty$ with $\\mu$ fixed.\n\nStarting from the principle of virtual work and the total potential energy, one obtains a displacement-only (primal) weak formulation and, by introducing a scalar pressure field $p$ that represents the hydrostatic part of the stress, a mixed displacement–pressure weak formulation. These formulations can be discretized by the Finite Element Method (FEM). In the nearly incompressible limit, low-order displacement-only discretizations are known to exhibit volumetric locking, while appropriately designed mixed methods can avoid it.\n\nWhich of the following statements about the weak formulations and their FEM discretizations are correct in the limit $\\lambda \\to \\infty$ on shape-regular meshes using standard continuous Lagrange finite element spaces?\n\nA. For the primal displacement-only weak formulation discretized with continuous piecewise linear elements for $\\boldsymbol{u}$, the error in the elastic energy norm remains uniformly bounded as $\\lambda \\to \\infty$; therefore volumetric locking does not occur.\n\nB. In the mixed displacement–pressure weak formulation that introduces $p$ as an additional unknown, if the displacement and pressure spaces satisfy the Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup condition uniformly (for example, Taylor–Hood with quadratic $\\boldsymbol{u}$ and linear $p$), then the discrete solution is uniformly stable and convergent as $\\lambda \\to \\infty$, thereby eliminating volumetric locking.\n\nC. Equal-order continuous piecewise linear elements for both $\\boldsymbol{u}$ and $p$ automatically satisfy the LBB inf-sup condition in the mixed formulation without any stabilization, because the term proportional to $1/\\lambda$ controls the pressure for all $\\lambda$, including the limit $\\lambda \\to \\infty$.\n\nD. Performing selective (reduced) integration only on the volumetric part of the primal displacement-only weak form is mathematically equivalent to a provably stable mixed formulation with an LBB-stable pair, and thus guarantees uniform stability and convergence independent of $\\lambda$.\n\nE. In the mixed formulation, the coercivity of the deviatoric elastic bilinear form on the kernel of the divergence operator, together with an LBB inf-sup condition for the pair of discrete spaces, yields a priori error estimates with constants independent of $\\lambda$, which explains why the mixed method avoids volumetric locking when $\\lambda \\to \\infty$.\n\nSelect all that apply.", "solution": "The core of the problem lies in the behavior of numerical solutions as the Lamé parameter $\\lambda$ tends to infinity, which corresponds to the Poisson's ratio $\\nu$ approaching $\\frac{1}{2}$. This limit enforces the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = 0$.\n\nLet's define the two weak formulations. Let the displacement space be $V = \\{ \\boldsymbol{v} \\in [H^1(\\Omega)]^d : \\boldsymbol{v} = \\boldsymbol{0} \\text{ on } \\Gamma_D \\}$ and the pressure space be $Q = L^2_0(\\Omega) = \\{ q \\in L^2(\\Omega) : \\int_\\Omega q \\,d\\Omega = 0 \\}$ (the zero mean is needed for uniqueness if $\\Gamma_N=\\emptyset$).\n\n**1. Primal (Displacement-Only) Formulation:**\nFind $\\boldsymbol{u} \\in V$ such that\n$$ a(\\boldsymbol{u}, \\boldsymbol{v}) := \\int_\\Omega \\left( 2\\mu\\, \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) + \\lambda\\, (\\nabla \\cdot \\boldsymbol{u})(\\nabla \\cdot \\boldsymbol{v}) \\right) d\\Omega = \\int_\\Omega \\boldsymbol{f} \\cdot \\boldsymbol{v} \\, d\\Omega + \\int_{\\Gamma_N} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS \\quad \\forall \\boldsymbol{v} \\in V $$\nAs $\\lambda \\to \\infty$, the solution must approximately satisfy $\\nabla \\cdot \\boldsymbol{u} = 0$. In a discrete setting with a finite element space $V_h \\subset V$, the discrete solution $\\boldsymbol{u}_h \\in V_h$ is forced to belong to a subspace of $V_h$ where the divergence is 'small'. For low-order elements, this subspace can be too restrictive, leading to an overly stiff system and a solution that polluted by large errors, a phenomenon known as volumetric locking.\n\n**2. Mixed (Displacement-Pressure) Formulation:**\nIntroduce a pressure variable $p \\in Q$. One standard form is derived by setting $p = -\\lambda (\\nabla \\cdot \\boldsymbol{u})$. The system is: Find $(\\boldsymbol{u}, p) \\in V \\times Q$ such that for all $(\\boldsymbol{v}, q) \\in V \\times Q$:\n$$ \\int_\\Omega 2\\mu\\, \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\,d\\Omega - \\int_\\Omega p (\\nabla \\cdot \\boldsymbol{v}) \\,d\\Omega = \\int_\\Omega \\boldsymbol{f} \\cdot \\boldsymbol{v} \\, d\\Omega + \\int_{\\Gamma_N} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS $$\n$$ -\\int_\\Omega (\\nabla \\cdot \\boldsymbol{u}) q \\,d\\Omega - \\int_\\Omega \\frac{1}{\\lambda} p q \\,d\\Omega = 0 $$\nThis is a saddle-point problem. In the limit $\\lambda \\to \\infty$, the term $\\frac{1}{\\lambda} \\int_\\Omega p q \\, d\\Omega$ vanishes, and the second equation becomes the weak form of the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = 0$. The stability of the discrete version of this problem depends critically on the choice of finite element spaces $V_h$ and $Q_h$.\n\nNow, let's analyze each option.\n\n**A. For the primal displacement-only weak formulation discretized with continuous piecewise linear elements for $\\boldsymbol{u}$, the error in the elastic energy norm remains uniformly bounded as $\\lambda \\to \\infty$; therefore volumetric locking does not occur.**\n\nThe elastic energy norm is given by $\\|\\boldsymbol{v}\\|^2_E = \\int_\\Omega \\boldsymbol{\\sigma}(\\boldsymbol{v}):\\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\,d\\Omega = \\int_\\Omega (2\\mu |\\boldsymbol{\\varepsilon}(\\boldsymbol{v})|^2 + \\lambda (\\nabla \\cdot \\boldsymbol{v})^2 ) d\\Omega$. Volumetric locking occurs when, for a fixed mesh, the error in this norm (or other relevant norms) does not converge to zero as the mesh is refined, or it deteriorates significantly as $\\lambda \\to \\infty$. Discretizing the primal formulation with continuous piecewise linear elements ($P_1$ elements) is the classic example of a method that exhibits severe volumetric locking. The space of discretely divergence-free functions is too small, leading to an overly stiff system. The error does not remain bounded as $\\lambda \\to \\infty$; on the contrary, the approximation quality collapses. Thus, the statement is a claim of the exact opposite of what actually happens.\n\n**Verdict: Incorrect.**\n\n**B. In the mixed displacement–pressure weak formulation that introduces $p$ as an additional unknown, if the displacement and pressure spaces satisfy the Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup condition uniformly (for example, Taylor–Hood with quadratic $\\boldsymbol{u}$ and linear $p$), then the discrete solution is uniformly stable and convergent as $\\lambda \\to \\infty$, thereby eliminating volumetric locking.**\n\nThis statement accurately describes the standard solution to the volumetric locking problem. The stability of the mixed formulation is governed by two conditions: coercivity of the primary bilinear form on the kernel of the divergence operator, and the LBB (inf-sup) condition. The LBB condition for the discrete spaces $(V_h, Q_h)$ ensures that the pressure is well-behaved and that the incompressibility constraint is not over-constraining. If the LBB condition holds with a constant bounded away from zero uniformly in the mesh size $h$, and the coercivity condition holds, the resulting discrete system is stable uniformly in both $h$ and $\\lambda$. This uniform stability leads to optimal error estimates that do not degrade as $\\lambda \\to \\infty$. The Taylor–Hood element pair (continuous quadratic velocity $\\boldsymbol{u}$, continuous linear pressure $p$, i.e., $P_2-P_1$) is a well-known example of a pair that satisfies the LBB condition. Therefore, using such a pair indeed eliminates volumetric locking.\n\n**Verdict: Correct.**\n\n**C. Equal-order continuous piecewise linear elements for both $\\boldsymbol{u}$ and $p$ automatically satisfy the LBB inf-sup condition in the mixed formulation without any stabilization, because the term proportional to $1/\\lambda$ controls the pressure for all $\\lambda$, including the limit $\\lambda \\to \\infty$.**\n\nThe pair of equal-order continuous piecewise linear elements ($P_1-P_1$) is a famously unstable element choice for saddle-point problems like Stokes flow or incompressible elasticity. It violates the LBB inf-sup condition. This violation leads to spurious, non-physical oscillations in the pressure solution. While the term $\\int_\\Omega (1/\\lambda) p_h q_h \\, d\\Omega$ does provide stability for any finite $\\lambda > 0$, its stabilizing effect vanishes as $\\lambda \\to \\infty$. The core of the problem of near-incompressibility lies in this very limit. Therefore, this element pair is unstable in the limit and requires stabilization techniques (e.g., Pressure-Stabilized Petrov-Galerkin, PSPG) to be usable. The statement that it *automatically* satisfies the LBB condition and is stable in the limit is false.\n\n**Verdict: Incorrect.**\n\n**D. Performing selective (reduced) integration only on the volumetric part of the primal displacement-only weak form is mathematically equivalent to a provably stable mixed formulation with an LBB-stable pair, and thus guarantees uniform stability and convergence independent of $\\lambda$.**\n\nSelective reduced integration (SRI) is a technique used to alleviate locking. The underlying principle, as shown by Malkus and Hughes, is that for certain choices of elements and quadrature rules, the SRI scheme is equivalent to a specific mixed formulation. For instance, using 4-node quadrilateral elements ($Q_1$) with $1$-point quadrature for the volumetric term ($\\lambda (\\nabla \\cdot \\boldsymbol{u})(\\nabla \\cdot \\boldsymbol{v})$) is equivalent to a mixed method with a piecewise constant pressure ($P_0$) on each element. This $Q_1-P_0$ pair is LBB-stable. However, the statement makes the universal claim that SRI *guarantees* stability because it is mathematically equivalent to a *provably stable* mixed formulation. This is an overgeneralization. The equivalence is not always to a stable pair. For example, using a single integration point (a form of reduced integration) on a linear triangular element ($P_1$) does not resolve locking. Therefore, SRI is not a universal guarantee of stability, and the statement is too strong to be considered correct in general.\n\n**Verdict: Incorrect.**\n\n**E. In the mixed formulation, the coercivity of the deviatoric elastic bilinear form on the kernel of the divergence operator, together with an LBB inf-sup condition for the pair of discrete spaces, yields a priori error estimates with constants independent of $\\lambda$, which explains why the mixed method avoids volumetric locking when $\\lambda \\to \\infty$.**\n\nThis statement provides a precise and complete theoretical justification for why well-chosen mixed methods work. The stability analysis of the mixed finite element method for this problem, based on Brezzi's theory for saddle-point problems, relies on two fundamental conditions:\n1.  The bilinear form $a(\\boldsymbol{u},\\boldsymbol{v}) = \\int_\\Omega 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\,d\\Omega$ is coercive on the kernel of the discrete divergence operator. This is satisfied thanks to Korn's inequality.\n2.  The discrete spaces for displacement and pressure must satisfy the LBB (inf-sup) condition, with an inf-sup constant that is uniformly bounded below, independent of the mesh size.\n\nWhen these two conditions hold, it is possible to prove that the discrete mixed problem is stable, with stability constants that are independent of the parameter $\\lambda$. This uniform stability is the key to deriving a priori error estimates where the constant in the estimate does not depend on $\\lambda$. Consequently, the convergence of the method does not degrade as $\\lambda \\to \\infty$, which is the mathematical definition of avoiding volumetric locking. The statement is a correct and fundamental result in numerical analysis.\n\n**Verdict: Correct.**\n\nIn summary, statements B and E are correct. Statement B describes the practical consequence of using an LBB-stable method, while statement E provides the more fundamental theoretical underpinning for why it works. Both are correct descriptions of the finite element theory for nearly incompressible materials.", "answer": "$$\\boxed{BE}$$", "id": "3532251"}, {"introduction": "The stability of mixed formulations, such as those used for incompressible fluid flow, depends on a delicate balance between the discrete velocity and pressure spaces. This practice delves into what happens when this balance, dictated by the LBB condition, is not met, as is common when using simple, equal-order elements. You will derive and analyze the Pressure-Stabilized Petrov-Galerkin (PSPG) method, a technique that intelligently modifies the weak form to restore stability, showcasing a powerful strategy for designing robust numerical methods. [@problem_id:3532264]", "problem": "Consider the steady incompressible Stokes equations in a two-dimensional domain $\\Omega \\subset \\mathbb{R}^{2}$ with boundary $\\partial \\Omega$, viscosity $\\mu > 0$, body force $\\boldsymbol{f}$, velocity $\\boldsymbol{u}$, and pressure $p$,\n$$\n-\\mu \\nabla^{2} \\boldsymbol{u} + \\nabla p = \\boldsymbol{f} \\quad \\text{in } \\Omega, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega,\n$$\nsubject to homogeneous Dirichlet boundary conditions $\\boldsymbol{u} = \\boldsymbol{0}$ on $\\partial \\Omega$ and the pressure normalization $\\int_{\\Omega} p \\, \\mathrm{d}\\Omega = 0$. Let $\\mathcal{T}_{h}$ be a conforming simplicial mesh of $\\Omega$ with characteristic size $h$, and consider equal-order interpolation spaces for velocity and pressure: the conforming finite element method (FEM) velocity space $\\boldsymbol{V}_{h} \\subset [H_{0}^{1}(\\Omega)]^{2}$ and pressure space $Q_{h} \\subset L_{0}^{2}(\\Omega)$, both piecewise linear and continuous on $\\mathcal{T}_{h}$. In this equal-order setting, the standard Galerkin finite element method lacks stability because the discrete Ladyzhenskaya–Babuška–Brezzi (LBB) inf–sup condition may fail.\n\nPressure-Stabilized Petrov–Galerkin (PSPG) stabilization augments the formulation with a consistent term constructed from the element-wise momentum residual. Define the element-wise momentum residual\n$$\n\\boldsymbol{r}_{m}(\\boldsymbol{u}_{h}, p_{h}) := -\\mu \\nabla^{2} \\boldsymbol{u}_{h} + \\nabla p_{h} - \\boldsymbol{f},\n$$\nand let $\\tau_{e} > 0$ denote an element-wise stabilization parameter with $\\tau_{e}$ scaling as $\\tau_{e} \\sim c \\, h_{e}^{2}/\\mu$ for a dimensionless constant $c>0$ and element size $h_{e}$. The PSPG-stabilized weak formulation seeks $(\\boldsymbol{u}_{h}, p_{h}) \\in \\boldsymbol{V}_{h} \\times Q_{h}$ such that for all $(\\boldsymbol{v}_{h}, q_{h}) \\in \\boldsymbol{V}_{h} \\times Q_{h}$,\n$$\n\\mu \\int_{\\Omega} \\nabla \\boldsymbol{u}_{h} : \\nabla \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega - \\int_{\\Omega} p_{h} \\, \\nabla \\cdot \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega + \\int_{\\Omega} q_{h} \\, \\nabla \\cdot \\boldsymbol{u}_{h} \\, \\mathrm{d}\\Omega + \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\nabla q_{h} \\cdot \\boldsymbol{r}_{m}(\\boldsymbol{u}_{h}, p_{h}) \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega,\n$$\nwhere $\\Omega_{e}$ is the domain of element $e$. The PSPG term is consistent because it vanishes for the exact solution $(\\boldsymbol{u}, p)$, and it penalizes spurious pressure modes by adding control on $\\nabla p_{h}$.\n\nTasks:\n- Starting from the fundamental laws stated above and the definitions of the function spaces, derive the PSPG-stabilized weak formulation and show that the additional PSPG term induces a symmetric positive definite bilinear form in the discrete pressure space, which enforces a discrete inf–sup condition. In particular, demonstrate how the PSPG term contributes a pressure-seminorm of the form\n$$\ns(p_{h}, q_{h}) := \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\nabla p_{h} \\cdot \\nabla q_{h} \\, \\mathrm{d}\\Omega,\n$$\nunder standard consistency assumptions, and explain how this yields a mesh-independent lower bound on the discrete inf–sup constant in terms of $\\tau_{e}$.\n- To provide a concrete calculation illustrating the stabilization, take the special case $\\Omega = (0,1) \\times (0,1)$, $\\boldsymbol{f} = \\boldsymbol{0}$, and a constant stabilization parameter $\\tau_{e} \\equiv \\tau > 0$ for all elements. Let the discrete pressure field be the smooth mode $p_{h}(x,y) = \\sin(\\pi x) \\sin(\\pi y)$ restricted to $\\Omega$, and let $q_{h} = p_{h}$. Compute the stabilized pressure term $s(p_{h}, p_{h})$ explicitly as a closed-form analytical expression in terms of $\\tau$ and $\\pi$.\n\nExpress your final answer as a single closed-form analytical expression. No rounding is required. Do not include units in your final answer.", "solution": "The problem consists of two parts. First, we are asked to derive the Pressure-Stabilized Petrov-Galerkin (PSPG) weak formulation and analyze the role of the stabilization term in satisfying a discrete inf-sup condition. Second, we are to compute a specific stabilization term for a given pressure mode.\n\n**Part 1: Derivation and Analysis of the PSPG Formulation**\n\nThe strong form of the steady incompressible Stokes equations is given by:\n$$\n-\\mu \\nabla^{2} \\boldsymbol{u} + \\nabla p = \\boldsymbol{f} \\quad \\text{in } \\Omega\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega\n$$\nwith boundary conditions $\\boldsymbol{u} = \\boldsymbol{0}$ on $\\partial \\Omega$ and the constraint $\\int_{\\Omega} p \\, \\mathrm{d}\\Omega = 0$. The function spaces for the velocity and pressure are $\\boldsymbol{u} \\in [H_{0}^{1}(\\Omega)]^2$ and $p \\in L_{0}^{2}(\\Omega)$, respectively.\n\nTo derive the standard weak (Galerkin) formulation, we multiply the momentum equation by a vector test function $\\boldsymbol{v} \\in [H_{0}^{1}(\\Omega)]^2$ and the continuity equation by a scalar test function $q \\in L_{0}^{2}(\\Omega)$, and integrate over the domain $\\Omega$. Applying the divergence theorem (integration by parts) to the viscosity and pressure gradient terms and using the fact that $\\boldsymbol{v} = \\boldsymbol{0}$ on $\\partial\\Omega$ yields:\n$$\n\\int_{\\Omega} (-\\mu \\nabla^2 \\boldsymbol{u}) \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\mu \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\, \\mathrm{d}\\Omega - \\int_{\\partial\\Omega} \\mu (\\nabla \\boldsymbol{u} \\cdot \\boldsymbol{n}) \\cdot \\boldsymbol{v} \\, \\mathrm{d}S = \\int_{\\Omega} \\mu \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\, \\mathrm{d}\\Omega\n$$\n$$\n\\int_{\\Omega} (\\nabla p) \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega = - \\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{v}) \\, \\mathrm{d}\\Omega + \\int_{\\partial\\Omega} p (\\boldsymbol{v} \\cdot \\boldsymbol{n}) \\, \\mathrm{d}S = - \\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{v}) \\, \\mathrm{d}\\Omega\n$$\nThe standard weak formulation is to find $(\\boldsymbol{u}, p) \\in [H_{0}^{1}(\\Omega)]^2 \\times L_{0}^{2}(\\Omega)$ such that for all $(\\boldsymbol{v}, q) \\in [H_{0}^{1}(\\Omega)]^2 \\times L_{0}^{2}(\\Omega)$:\n$$\n\\mu \\int_{\\Omega} \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\, \\mathrm{d}\\Omega - \\int_{\\Omega} p \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega\n$$\n$$\n\\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{u} \\, \\mathrm{d}\\Omega = 0\n$$\nDiscretizing these equations using finite element spaces $\\boldsymbol{V}_h \\subset [H_{0}^{1}(\\Omega)]^2$ and $Q_h \\subset L_{0}^{2}(\\Omega)$ leads to a numerical method which is only stable if the pair of spaces $(\\boldsymbol{V}_h, Q_h)$ satisfies the discrete Ladyzhenskaya–Babuška–Brezzi (LBB) or inf-sup condition. For equal-order piecewise linear elements, this condition is not generally met, leading to spurious pressure oscillations.\n\nThe PSPG method addresses this by adding a stabilization term to the weak formulation. The given PSPG formulation seeks $(\\boldsymbol{u}_h, p_h) \\in \\boldsymbol{V}_h \\times Q_h$ such that for all $(\\boldsymbol{v}_h, q_h) \\in \\boldsymbol{V}_h \\times Q_h$:\n$$\n\\mu \\int_{\\Omega} \\nabla \\boldsymbol{u}_{h} : \\nabla \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega - \\int_{\\Omega} p_{h} \\, \\nabla \\cdot \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega + \\int_{\\Omega} q_{h} \\, \\nabla \\cdot \\boldsymbol{u}_{h} \\, \\mathrm{d}\\Omega + \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\nabla q_{h} \\cdot \\boldsymbol{r}_{m}(\\boldsymbol{u}_{h}, p_{h}) \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega\n$$\nThe stabilization term is added to the discrete continuity equation. The momentum residual is defined element-wise as $\\boldsymbol{r}_{m}(\\boldsymbol{u}_{h}, p_{h}) := -\\mu \\nabla^{2} \\boldsymbol{u}_{h} + \\nabla p_{h} - \\boldsymbol{f}$. Since the velocity space $\\boldsymbol{V}_h$ consists of continuous piecewise linear functions, the second derivative $\\nabla^2 \\boldsymbol{u}_h$ is zero within each element $\\Omega_e$. Therefore, the residual inside any element simplifies to $\\boldsymbol{r}_{m}|_{\\Omega_e} = \\nabla p_h - \\boldsymbol{f}$.\n\nSubstituting this simplified residual into the stabilization term, we get:\n$$\n\\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\nabla q_{h} \\cdot (\\nabla p_h - \\boldsymbol{f}) \\, \\mathrm{d}\\Omega = \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\nabla p_h \\cdot \\nabla q_h \\, \\mathrm{d}\\Omega - \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\boldsymbol{f} \\cdot \\nabla q_h \\, \\mathrm{d}\\Omega\n$$\nThe stabilized weak formulation can be written as a single bilinear form equation $B_{stab}((\\boldsymbol{u}_h, p_h), (\\boldsymbol{v}_h, q_h)) = F_{stab}(\\boldsymbol{v}_h, q_h)$:\n$$\nB_{stab}((\\boldsymbol{u}_h, p_h), (\\boldsymbol{v}_h, q_h)) = \\mu \\int_{\\Omega} \\nabla \\boldsymbol{u}_{h} : \\nabla \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega - \\int_{\\Omega} p_{h} \\, \\nabla \\cdot \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega + \\int_{\\Omega} q_{h} \\, \\nabla \\cdot \\boldsymbol{u}_{h} \\, \\mathrm{d}\\Omega + \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\nabla p_{h} \\cdot \\nabla q_{h} \\, \\mathrm{d}\\Omega\n$$\n$$\nF_{stab}(\\boldsymbol{v}_h, q_h) = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\boldsymbol{v}_{h} \\, \\mathrm{d}\\Omega + \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\boldsymbol{f} \\cdot \\nabla q_h \\, \\mathrm{d}\\Omega\n$$\nThe problem asks to show that the additional term induces a symmetric positive definite bilinear form $s(p_h, q_h)$ and how this leads to a stable method. The induced term affecting the pressure coupling is precisely:\n$$\ns(p_h, q_h) := \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, \\nabla p_h \\cdot \\nabla q_h \\, \\mathrm{d}\\Omega\n$$\nThis bilinear form is clearly symmetric, since the dot product is commutative. To check for positive definiteness, we set $q_h = p_h$:\n$$\ns(p_h, p_h) = \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_{e} \\, |\\nabla p_h|^2 \\, \\mathrm{d}\\Omega\n$$\nSince $\\tau_e > 0$, the integrand is non-negative, so $s(p_h, p_h) \\ge 0$. If $s(p_h, p_h) = 0$, then $\\nabla p_h = \\boldsymbol{0}$ inside every element $e$. Because $p_h$ is a continuous piecewise polynomial, this implies that $p_h$ is a global constant. Since the pressure space is $Q_h \\subset L_0^2(\\Omega)$, we have the constraint $\\int_\\Omega p_h \\, \\mathrm{d}\\Omega = 0$. The only constant function satisfying this constraint is $p_h = 0$. Thus, $s(p_h, p_h) = 0$ if and only if $p_h = 0$, proving that $s(\\cdot, \\cdot)$ is a symmetric positive definite bilinear form on $Q_h$. It constitutes an inner product on the discrete pressure space.\n\nThe stabilization works by providing control over the pressure field independently of the velocity field. The stabilized inf-sup condition can be shown to hold. A simplified argument demonstrates how a mesh-independent lower bound arises. The stabilized formulation introduces a modified bilinear form for which the inf-sup condition must hold. Consider the terms coupling pressure to the system, which are $(\\nabla \\cdot \\boldsymbol{u}_h, q_h)$ and $s(p_h, q_h)$. The stability of the pressure requires that for any $q_h \\in Q_h$, there exists a test function pair $(\\boldsymbol{v}_h, w_h)$ that controls it. By choosing the test pair $(\\boldsymbol{v}_h, w_h) = (\\boldsymbol{0}, q_h)$, the relevant part of the stabilized bilinear form evaluates to $B_{stab}((\\boldsymbol{0}, q_h), (\\boldsymbol{0}, q_h)) = s(q_h, q_h)$.\n\nWe have $s(q_h,q_h) = \\sum_e \\tau_e \\|\\nabla q_h\\|^2_{L^2(\\Omega_e)}$. Using a standard inverse inequality for finite element functions, $\\|\\nabla q_h\\|_{L^2(\\Omega_e)} \\ge C_{inv} h_e^{-1} \\|q_h\\|_{L^2(\\Omega_e)}$, where $C_{inv}$ is a constant independent of the element size $h_e$. With the given scaling $\\tau_e \\sim c h_e^2/\\mu$, we find:\n$$\ns(q_h, q_h) \\ge \\sum_{e \\in \\mathcal{T}_{h}} \\left(\\frac{c h_e^2}{\\mu}\\right) \\left(C_{inv} h_e^{-1} \\|q_h\\|_{L^2(\\Omega_e)}\\right)^2 = \\frac{c C_{inv}^2}{\\mu} \\sum_{e \\in \\mathcal{T}_{h}} \\|q_h\\|^2_{L^2(\\Omega_e)} = \\frac{c C_{inv}^2}{\\mu} \\|q_h\\|^2_{L^2(\\Omega)}\n$$\nThis demonstrates that the stabilization term $s(q_h, q_h)$ is coercive on the pressure space $Q_h$ with a coercivity constant that is independent of the mesh size $h$. This pressure-coercivity is sufficient to establish a mesh-independent lower bound on the discrete inf-sup constant for the full stabilized system, thereby curing the instability of the equal-order Galerkin method.\n\n**Part 2: Explicit Calculation**\n\nWe are asked to compute the stabilized pressure term $s(p_h, p_h)$ for a specific case:\n- Domain: $\\Omega = (0,1) \\times (0,1)$\n- Stabilization parameter: $\\tau_e \\equiv \\tau > 0$\n- Pressure field: $p_h(x,y) = \\sin(\\pi x) \\sin(\\pi y)$\n\nThe term to be computed is $s(p_h, p_h) = \\sum_{e \\in \\mathcal{T}_{h}} \\int_{\\Omega_{e}} \\tau_e \\, |\\nabla p_h|^2 \\, \\mathrm{d}\\Omega$. Since $\\tau$ is constant across all elements, this simplifies to an integral over the entire domain $\\Omega$:\n$$\ns(p_h, p_h) = \\tau \\int_{\\Omega} |\\nabla p_h|^2 \\, \\mathrm{d}\\Omega = \\tau \\int_0^1 \\int_0^1 |\\nabla p_h(x,y)|^2 \\, \\mathrm{d}x \\, \\mathrm{d}y\n$$\nFirst, we compute the gradient of $p_h(x,y)$:\n$$\n\\frac{\\partial p_h}{\\partial x} = \\pi \\cos(\\pi x) \\sin(\\pi y)\n$$\n$$\n\\frac{\\partial p_h}{\\partial y} = \\pi \\sin(\\pi x) \\cos(\\pi y)\n$$\nNext, we compute the squared magnitude of the gradient:\n$$\n|\\nabla p_h|^2 = \\left(\\frac{\\partial p_h}{\\partial x}\\right)^2 + \\left(\\frac{\\partial p_h}{\\partial y}\\right)^2 = (\\pi \\cos(\\pi x) \\sin(\\pi y))^2 + (\\pi \\sin(\\pi x) \\cos(\\pi y))^2\n$$\n$$\n|\\nabla p_h|^2 = \\pi^2 \\left( \\cos^2(\\pi x) \\sin^2(\\pi y) + \\sin^2(\\pi x) \\cos^2(\\pi y) \\right)\n$$\nNow we integrate this expression over the unit square $\\Omega = [0,1] \\times [0,1]$:\n$$\n\\int_{\\Omega} |\\nabla p_h|^2 \\, \\mathrm{d}\\Omega = \\pi^2 \\int_0^1 \\int_0^1 \\left( \\cos^2(\\pi x) \\sin^2(\\pi y) + \\sin^2(\\pi x) \\cos^2(\\pi y) \\right) \\, \\mathrm{d}x \\, \\mathrm{d}y\n$$\nWe can separate the integral into two parts and exploit the separability of the variables $x$ and $y$:\n$$\n\\int_{\\Omega} |\\nabla p_h|^2 \\, \\mathrm{d}\\Omega = \\pi^2 \\left[ \\left(\\int_0^1 \\cos^2(\\pi x) \\, \\mathrm{d}x\\right) \\left(\\int_0^1 \\sin^2(\\pi y) \\, \\mathrm{d}y\\right) + \\left(\\int_0^1 \\sin^2(\\pi x) \\, \\mathrm{d}x\\right) \\left(\\int_0^1 \\cos^2(\\pi y) \\, \\mathrm{d}y\\right) \\right]\n$$\nWe evaluate the standard definite integrals:\n$$\n\\int_0^1 \\sin^2(\\pi z) \\, \\mathrm{d}z = \\int_0^1 \\frac{1 - \\cos(2\\pi z)}{2} \\, \\mathrm{d}z = \\left[ \\frac{z}{2} - \\frac{\\sin(2\\pi z)}{4\\pi} \\right]_0^1 = \\frac{1}{2}\n$$\n$$\n\\int_0^1 \\cos^2(\\pi z) \\, \\mathrm{d}z = \\int_0^1 \\frac{1 + \\cos(2\\pi z)}{2} \\, \\mathrm{d}z = \\left[ \\frac{z}{2} + \\frac{\\sin(2\\pi z)}{4\\pi} \\right]_0^1 = \\frac{1}{2}\n$$\nSubstituting these values back into the expression for the integral of $|\\nabla p_h|^2$:\n$$\n\\int_{\\Omega} |\\nabla p_h|^2 \\, \\mathrm{d}\\Omega = \\pi^2 \\left[ \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) \\right] = \\pi^2 \\left[ \\frac{1}{4} + \\frac{1}{4} \\right] = \\pi^2 \\left( \\frac{1}{2} \\right) = \\frac{\\pi^2}{2}\n$$\nFinally, we multiply by the stabilization parameter $\\tau$ to obtain the value of $s(p_h, p_h)$:\n$$\ns(p_h, p_h) = \\tau \\int_{\\Omega} |\\nabla p_h|^2 \\, \\mathrm{d}\\Omega = \\tau \\frac{\\pi^2}{2}\n$$\nThis is the closed-form analytical expression for the stabilized pressure term.", "answer": "$$\\boxed{\\frac{\\tau \\pi^2}{2}}$$", "id": "3532264"}]}