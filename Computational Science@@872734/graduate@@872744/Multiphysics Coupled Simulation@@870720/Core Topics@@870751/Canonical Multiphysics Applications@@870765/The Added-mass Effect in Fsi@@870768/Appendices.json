{"hands_on_practices": [{"introduction": "To grasp the added-mass effect, we must first understand its direct impact on a structure's inherent dynamic properties. This exercise guides you through a foundational analysis, starting with a single-degree-of-freedom (SDOF) system to derive how added mass lowers the natural frequency of vibration [@problem_id:3527967]. We will then extend this insight qualitatively and quantitatively to a multi-degree-of-freedom (MDOF) system, where hydrodynamic coupling can alter not only the frequencies but also the fundamental mode shapes of vibration.", "problem": "A rigid structure executing one-dimensional motion is immersed in an incompressible, inviscid fluid so that the fluid exerts an inertial reaction that can be represented by an added mass. Consider two settings.\n\n(a) Single-degree-of-freedom setting: A point mass with structural mass $m_{s}$ connected to a linear spring of stiffness $k$ moves with displacement $x(t)$ in a quiescent fluid. The hydrodynamic reaction is modeled as an added mass $m_{a}$ that multiplies the structural acceleration. Starting from Newton’s second law and the definition of linear elastic force, derive the undamped free-vibration equation of motion and obtain the natural frequency as a function of $m_{s}$, $m_{a}$, and $k$.\n\n(b) Multi-degree-of-freedom setting: Two colinear point masses with structural masses $m_{1}$ and $m_{2}$ are connected by linear springs so that the first mass is connected to ground by a spring of stiffness $k_{1}$ and the two masses are connected by a spring of stiffness $k_{2}$. The system undergoes small-amplitude motion in an incompressible, inviscid fluid. The fluid-induced inertia is represented by a symmetric added-mass matrix. Using Newton’s second law for each degree of freedom and assembling the undamped free-vibration equations, explain qualitatively how the presence of a non-proportional added-mass matrix modifies the mode shapes and modal participation factors relative to the in-vacuo system.\n\nThen, for the specific parameter values\n- $m_{1} = 10\\,\\mathrm{kg}$, $m_{2} = 10\\,\\mathrm{kg}$,\n- $k_{1} = 4000\\,\\mathrm{N/m}$, $k_{2} = 2000\\,\\mathrm{N/m}$,\n- added-mass matrix $M_{a}$ with entries $m_{a,11} = 5\\,\\mathrm{kg}$, $m_{a,22} = 5\\,\\mathrm{kg}$, and $m_{a,12} = m_{a,21} = 2\\,\\mathrm{kg}$,\n\ncompute the lowest natural frequency of the coupled fluid-structure system in radians per second by seeking nontrivial harmonic solutions. Round your answer to four significant figures and express the frequency in radians per second.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. It presents a standard analysis of the added-mass effect in structural dynamics for both single-degree-of-freedom (SDOF) and multi-degree-of-freedom (MDOF) systems. All provided parameters are physically realistic and dimensionally consistent.\n\n**Part (a): Single-Degree-of-Freedom System**\n\nWe consider a point mass $m_s$ attached to a spring of stiffness $k$. The displacement of the mass is $x(t)$. The system is submerged in a quiescent, incompressible, and inviscid fluid.\n\nAccording to Newton's second law, the sum of external forces acting on the mass equals its mass times its acceleration.\n$$ \\sum F_{\\text{ext}} = m_s \\ddot{x}(t) $$\nThe external forces are the spring restoring force, $F_k$, and the hydrodynamic force from the fluid, $F_f$.\n\nThe spring force is given by Hooke's law:\n$$ F_k = -k x(t) $$\n\nThe problem states that the hydrodynamic reaction is modeled as an added mass, $m_a$, that multiplies the structural acceleration, $\\ddot{x}(t)$. This force opposes the acceleration of the body relative to the stationary fluid. The force exerted by the fluid on the structure is therefore:\n$$ F_f = -m_a \\ddot{x}(t) $$\n\nSubstituting the external forces into Newton's second law:\n$$ F_k + F_f = m_s \\ddot{x}(t) $$\n$$ -k x(t) - m_a \\ddot{x}(t) = m_s \\ddot{x}(t) $$\n\nRearranging the terms to form the standard equation of motion for free vibration:\n$$ m_s \\ddot{x}(t) + m_a \\ddot{x}(t) + k x(t) = 0 $$\n$$ (m_s + m_a) \\ddot{x}(t) + k x(t) = 0 $$\n\nThis is the equation of motion for an undamped SDOF system. It is of the form $M_{\\text{eff}} \\ddot{x} + K_{\\text{eff}} x = 0$, where the effective mass is $M_{\\text{eff}} = m_s + m_a$ and the effective stiffness is $K_{\\text{eff}} = k$. The natural frequency, $\\omega_n$, of such a system is given by:\n$$ \\omega_n = \\sqrt{\\frac{K_{\\text{eff}}}{M_{\\text{eff}}}} $$\nSubstituting the expressions for the effective mass and stiffness, we obtain the natural frequency of the fluid-structure system:\n$$ \\omega_n = \\sqrt{\\frac{k}{m_s + m_a}} $$\n\n**Part (b): Multi-Degree-of-Freedom System - Qualitative Explanation**\n\nFor the MDOF system, the undamped free-vibration equation of motion in matrix form is:\n$$ M \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} $$\nwhere $\\mathbf{x} = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$ is the displacement vector, $M$ is the mass matrix, and $K$ is the stiffness matrix.\n\nFor the in-vacuo system, the mass matrix, $M_s$, is diagonal, containing only the structural masses:\n$$ M_s = \\begin{pmatrix} m_1  0 \\\\ 0  m_2 \\end{pmatrix} $$\nThe stiffness matrix, $K$, is derived from the forces in the springs. The force on mass $1$ is $-k_1 x_1 + k_2(x_2-x_1)$, and the force on mass $2$ is $-k_2(x_2-x_1)$. This yields:\n$$ K = \\begin{pmatrix} k_1+k_2  -k_2 \\\\ -k_2  k_2 \\end{pmatrix} $$\nThe in-vacuo equation of motion is $M_s \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0}$. The mode shapes are the eigenvectors of the generalized eigenvalue problem $(K - \\omega^2 M_s) \\mathbf{\\phi} = \\mathbf{0}$.\n\nWhen the system is immersed in the fluid, the total mass matrix becomes the sum of the structural mass matrix $M_s$ and the added-mass matrix $M_a$:\n$$ M_{\\text{total}} = M_s + M_a $$\nThe added-mass matrix $M_a$ is given as symmetric and non-diagonal:\n$$ M_a = \\begin{pmatrix} m_{a,11}  m_{a,12} \\\\ m_{a,21}  m_{a,22} \\end{pmatrix}, \\quad m_{a,12} = m_{a,21} \\neq 0 $$\nThe equation of motion for the coupled system is:\n$$ (M_s + M_a) \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} \\quad \\implies \\quad M_{\\text{total}} \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} $$\nThe total mass matrix $M_{\\text{total}}$ is non-diagonal due to the off-diagonal terms $m_{a,12}$ and $m_{a,21}$. These terms represent hydrodynamic (inertial) coupling: the acceleration of mass $1$ induces an inertial fluid force on mass $2$, and vice-versa.\n\nThe presence of a non-proportional added-mass matrix modifies the system's modal properties as follows:\n1.  **Mode Shapes**: The mode shapes of the coupled system are the eigenvectors of the modified eigenvalue problem $(K - \\omega^2 M_{\\text{total}}) \\mathbf{\\phi} = \\mathbf{0}$. Since the total mass matrix $M_{\\text{total}}$ is not proportional to the structural mass matrix $M_s$ (i.e., $M_{\\text{total}} \\neq c M_s$ for any scalar $c$), the eigenvectors of the coupled system will be different from the eigenvectors (mode shapes) of the in-vacuo system. The inertial coupling fundamentally alters the dynamic relationships between the degrees of freedom, resulting in different characteristic patterns of vibration. The new mode shapes are orthogonal with respect to both $M_{\\text{total}}$ and $K$, but they are generally not orthogonal with respect to the original structural mass matrix $M_s$.\n\n2.  **Modal Participation Factors**: Modal participation factors, $\\Gamma_i$, quantify how much each mode contributes to the system's response under a given external load pattern. For a load vector $\\mathbf{f}(t) = \\mathbf{p} f(t)$, the participation factor for mode $i$ is $\\Gamma_i = \\mathbf{\\phi}_i^T M \\mathbf{p} / (\\mathbf{\\phi}_i^T M \\mathbf{\\phi}_i)$. Both the mode shapes $\\mathbf{\\phi}_i$ and the mass matrix $M$ (changing from $M_s$ to $M_{\\text{total}}$) are altered by the fluid. Therefore, the modal participation factors will change. The hydrodynamic coupling redistributes the effective inertia of the system, which in turn alters how each mode participates in the response to external loads.\n\n**Part (c): MDOF System - Numerical Calculation**\n\nWe are given the following parameter values:\n$m_1 = 10\\,\\mathrm{kg}$, $m_2 = 10\\,\\mathrm{kg}$\n$k_1 = 4000\\,\\mathrm{N/m}$, $k_2 = 2000\\,\\mathrm{N/m}$\n$M_a = \\begin{pmatrix} 5  2 \\\\ 2  5 \\end{pmatrix}\\,\\mathrm{kg}$\n\nFirst, we assemble the structural and total mass matrices and the stiffness matrix.\nThe structural mass matrix is:\n$$ M_s = \\begin{pmatrix} 10  0 \\\\ 0  10 \\end{pmatrix}\\,\\mathrm{kg} $$\nThe total mass matrix is:\n$$ M_{\\text{total}} = M_s + M_a = \\begin{pmatrix} 10  0 \\\\ 0  10 \\end{pmatrix} + \\begin{pmatrix} 5  2 \\\\ 2  5 \\end{pmatrix} = \\begin{pmatrix} 15  2 \\\\ 2  15 \\end{pmatrix}\\,\\mathrm{kg} $$\nThe stiffness matrix is:\n$$ K = \\begin{pmatrix} k_1+k_2  -k_2 \\\\ -k_2  k_2 \\end{pmatrix} = \\begin{pmatrix} 4000+2000  -2000 \\\\ -2000  2000 \\end{pmatrix} = \\begin{pmatrix} 6000  -2000 \\\\ -2000  2000 \\end{pmatrix}\\,\\mathrm{N/m} $$\n\nTo find the natural frequencies, we seek non-trivial harmonic solutions of the form $\\mathbf{x}(t) = \\mathbf{\\phi} e^{i\\omega t}$. Substituting this into the equation of motion $M_{\\text{total}} \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0}$ yields the generalized eigenvalue problem:\n$$ (K - \\omega^2 M_{\\text{total}}) \\mathbf{\\phi} = \\mathbf{0} $$\nThis requires the determinant of the coefficient matrix to be zero. Let $\\lambda = \\omega^2$.\n$$ \\det(K - \\lambda M_{\\text{total}}) = 0 $$\n$$ \\det\\left( \\begin{pmatrix} 6000  -2000 \\\\ -2000  2000 \\end{pmatrix} - \\lambda \\begin{pmatrix} 15  2 \\\\ 2  15 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\begin{pmatrix} 6000 - 15\\lambda  -2000 - 2\\lambda \\\\ -2000 - 2\\lambda  2000 - 15\\lambda \\end{pmatrix} = 0 $$\nExpanding the determinant gives the characteristic equation:\n$$ (6000 - 15\\lambda)(2000 - 15\\lambda) - (-2000 - 2\\lambda)^2 = 0 $$\n$$ (12 \\times 10^6 - 90000\\lambda - 30000\\lambda + 225\\lambda^2) - (4 \\times 10^6 + 8000\\lambda + 4\\lambda^2) = 0 $$\n$$ 225\\lambda^2 - 120000\\lambda + 12 \\times 10^6 - 4\\lambda^2 - 8000\\lambda - 4 \\times 10^6 = 0 $$\nCombining terms, we get a quadratic equation in $\\lambda$:\n$$ 221\\lambda^2 - 128000\\lambda + 8 \\times 10^6 = 0 $$\nWe solve for $\\lambda$ using the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{(-128000)^2 - 4(221)(8 \\times 10^6)}}{2(221)} $$\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{16.384 \\times 10^9 - 7.072 \\times 10^9}}{442} $$\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{9.312 \\times 10^9}}{442} $$\n$$ \\lambda = \\frac{128000 \\pm 96498.7046...}{442} $$\nThe two eigenvalues $\\lambda = \\omega^2$ are:\n$$ \\lambda_1 = \\frac{128000 - 96498.7046...}{442} \\approx 71.2699... \\ (\\text{rad/s})^2 $$\n$$ \\lambda_2 = \\frac{128000 + 96498.7046...}{442} \\approx 507.9156... \\ (\\text{rad/s})^2 $$\nThe lowest natural frequency corresponds to the smaller eigenvalue, $\\lambda_1$.\n$$ \\omega_{lowest} = \\sqrt{\\lambda_1} \\approx \\sqrt{71.2699...} \\approx 8.442150... \\ \\text{rad/s} $$\nRounding the result to four significant figures gives:\n$$ \\omega_{lowest} \\approx 8.442 \\ \\text{rad/s} $$", "answer": "$$ \\boxed{8.442} $$", "id": "3527967"}, {"introduction": "After seeing *how* added mass alters dynamics, a crucial practical question arises: *when* is this effect significant enough to warrant special attention? This exercise tackles this question by developing a quantitative framework based on the dimensionless ratio of fluid added mass to structural mass [@problem_id:3527931]. By implementing a parametric study, you will learn to classify Fluid-Structure Interaction (FSI) scenarios into regimes where added mass is negligible, comparable, or dominant, and see how this classification directly informs critical choices in designing numerical simulations, such as selecting an appropriate coupling strategy.", "problem": "Consider a one-degree-of-freedom linear structural oscillator immersed in an inviscid, incompressible flow, representing a canonical Fluid-Structure Interaction (FSI) setting for assessing the added-mass effect. The structure is modeled as a rigid mass attached to a linear spring, moving normal to the fluid, and the fluid is characterized solely by its added mass. Let the structural mass be $m_s = \\rho_s V$, and the fluid added mass be $m_a = C_a \\rho_f V$, where $\\rho_s$ is the structural density, $\\rho_f$ is the fluid density, $V$ is a characteristic displaced volume, and $C_a$ is a dimensionless added-mass coefficient determined by geometry. The effective mass is $m_{\\text{eff}} = m_s + m_a$. The linear spring has stiffness $k$. Assume zero structural damping.\n\nStarting from Newton's second law and the definition of effective inertia, your task is to derive, implement, and evaluate a parameterized study across the density ratio $\\beta = \\rho_s/\\rho_f$ to identify regimes where added mass is negligible, comparable to, or dominant over the structural inertia, and to extract implications for numerical coupling strategies in multiphysics solvers.\n\nUse the following foundational modeling assumptions and requirements:\n- Fundamental base: Newton's second law, linear oscillator dynamics, and the definition of added mass. The fluid contribution is purely inertial: $m_a = C_a \\rho_f V$.\n- Dry natural frequency: $\\omega_{\\text{dry}} = \\sqrt{k/m_s}$.\n- Wet (coupled) natural frequency: $\\omega = \\sqrt{k/(m_s + m_a)}$.\n- Mass ratio: $r = m_a/m_s = C_a/\\beta$.\n- Frequency ratio: $\\omega/\\omega_{\\text{dry}} = \\sqrt{m_s/(m_s + m_a)} = 1/\\sqrt{1 + r}$.\n\nDefine the regime classification using a principled, quantitative criterion:\n- Added-mass negligible (code $0$): the relative frequency reduction is small, that is $1 - \\omega/\\omega_{\\text{dry}} \\le \\varepsilon_{\\text{negl}}$, with $\\varepsilon_{\\text{negl}} = 0.05$. Show that this corresponds to $r \\le r_{\\text{negl}}$, where $r_{\\text{negl}} = \\dfrac{1}{(1 - \\varepsilon_{\\text{negl}})^2} - 1$.\n- Added-mass dominant (code $2$): the added mass overwhelms the structural mass by at least one order of magnitude, that is $r \\ge \\tau_{\\text{dom}}$, with $\\tau_{\\text{dom}} = 10$.\n- Added-mass comparable (code $1$): the intermediate regime $r_{\\text{negl}}  r  \\tau_{\\text{dom}}$.\n\nNumerical coupling implication (to be computed and reported as a boolean): define the fluid inertia fraction $\\gamma = \\dfrac{m_a}{m_s + m_a} = \\dfrac{r}{1 + r}$. Recommend strong (implicit) coupling if $\\gamma \\ge \\gamma_{\\text{crit}}$, with $\\gamma_{\\text{crit}} = 0.3$. Otherwise, weak (explicit) coupling may be acceptable. This criterion must be computed and reported as a boolean for each test case.\n\nAdditionally, compute the explicit central-difference stability time-step limit for the linear oscillator,\n$$\\Delta t_{\\text{crit}} = \\dfrac{2}{\\omega},$$\nand report it in seconds.\n\nUse the following fixed parameters for all cases:\n- Stiffness $k = 1.0 \\times 10^5\\,\\mathrm{N/m}$,\n- Volume $V = 1.0\\,\\mathrm{m^3}$.\n\nTest suite:\nFor each test case, the inputs are $(\\rho_s,\\ \\rho_f,\\ C_a)$ in $\\mathrm{kg/m^3}$ and dimensionless, respectively.\n\n- Case $1$: $(10.0,\\ 1000.0,\\ 1.0)$.\n- Case $2$: $(1000.0,\\ 1000.0,\\ 1.0)$.\n- Case $3$: $(10000.0,\\ 1000.0,\\ 1.0)$, which corresponds to $r = 0.1$.\n- Case $4$: $(8333.333333333333,\\ 1000.0,\\ 1.0)$, which corresponds to $r = 0.12$.\n- Case $5$: $(111.11111111111111,\\ 1000.0,\\ 1.0)$, which corresponds to $r = 9.0$.\n- Case $6$: $(50.0,\\ 1000.0,\\ 0.5)$, which corresponds to $r = 10.0$.\n- Case $7$: $(8000.0,\\ 1000.0,\\ 2.0)$, which corresponds to $r = 0.25$.\n\nFor each test case, your program must output a list with four entries:\n- The regime code as an integer: $0$ (negligible), $1$ (comparable), or $2$ (dominant).\n- The frequency ratio $\\omega/\\omega_{\\text{dry}}$ as a floating-point number.\n- The strong-coupling recommendation as a boolean, based on $\\gamma \\ge \\gamma_{\\text{crit}}$.\n- The critical explicit time step $\\Delta t_{\\text{crit}}$ in seconds as a floating-point number.\n\nFinal output format:\nYour program should produce a single line of output containing the results for all seven cases as a comma-separated list enclosed in square brackets. Each element must itself be a list of the four values for the corresponding test case, in the order specified above. For example:\n$[\\,[\\text{code}_1,\\ \\text{fr}_1,\\ \\text{bool}_1,\\ \\Delta t_1],\\ [\\text{code}_2,\\ \\text{fr}_2,\\ \\text{bool}_2,\\ \\Delta t_2],\\ \\ldots\\,]$.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of classical mechanics and fluid dynamics, specifically the modeling of linear oscillators and the added-mass effect in fluid-structure interaction (FSI). The problem is well-posed, with all necessary parameters, definitions, and criteria clearly specified, ensuring that a unique and meaningful solution can be determined. The setup is self-contained and logically consistent.\n\nThe solution proceeds by first establishing the theoretical framework and then applying it to the specified test cases.\n\nThe system under consideration is a single-degree-of-freedom (SDOF) structural oscillator immersed in a fluid. The motion of the structure is governed by Newton's second law. In a vacuum (or \"dry\" condition), the equation of motion for the undamped oscillator with mass $m_s$ and spring stiffness $k$ is:\n$$m_s \\ddot{x} + kx = 0$$\nwhere $x$ is the displacement and $\\ddot{x}$ is the acceleration. The natural frequency of this \"dry\" system is given by:\n$$\\omega_{\\text{dry}} = \\sqrt{\\frac{k}{m_s}}$$\n\nWhen the oscillator is immersed in a fluid, its motion accelerates the surrounding fluid, which in turn exerts an inertial force back on the structure. For an inviscid, incompressible fluid, this effect can be modeled as an \"added mass,\" $m_a$, which is conceptually a mass of fluid that moves with the structure. The total effective mass of the system becomes the sum of the structural mass and the added mass:\n$$m_{\\text{eff}} = m_s + m_a$$\nThe equation of motion for the \"wet\" system is then:\n$$(m_s + m_a) \\ddot{x} + kx = 0$$\nThe natural frequency of this coupled FSI system, or the \"wet\" frequency, is:\n$$\\omega = \\sqrt{\\frac{k}{m_s + m_a}}$$\n\nThe problem provides the following definitions:\n- Structural mass: $m_s = \\rho_s V$, where $\\rho_s$ is the structural density and $V$ is a characteristic volume.\n- Added mass: $m_a = C_a \\rho_f V$, where $\\rho_f$ is the fluid density and $C_a$ is the added-mass coefficient.\n\nA key dimensionless parameter governing the system's behavior is the mass ratio, $r$, defined as the ratio of the added mass to the structural mass:\n$$r = \\frac{m_a}{m_s} = \\frac{C_a \\rho_f V}{\\rho_s V} = \\frac{C_a \\rho_f}{\\rho_s}$$\nUsing the definition of the density ratio, $\\beta = \\rho_s/\\rho_f$, the mass ratio can be expressed as $r = C_a/\\beta$.\n\nThe added mass reduces the system's natural frequency. The extent of this reduction is quantified by the frequency ratio:\n$$\\frac{\\omega}{\\omega_{\\text{dry}}} = \\frac{\\sqrt{k/(m_s + m_a)}}{\\sqrt{k/m_s}} = \\sqrt{\\frac{m_s}{m_s + m_a}} = \\sqrt{\\frac{1}{1 + m_a/m_s}} = \\frac{1}{\\sqrt{1 + r}}$$\nThis relationship shows that the frequency ratio, and thus the entire dynamic behavior of the system, is uniquely determined by the mass ratio $r$.\n\nThe problem requires a regime classification based on the significance of the added-mass effect. The criterion is based on the relative frequency reduction, $1 - \\omega/\\omega_{\\text{dry}}$.\n- **Added-mass negligible (code $0$)**: This regime is defined by a small frequency reduction: $1 - \\omega/\\omega_{\\text{dry}} \\le \\varepsilon_{\\text{negl}}$, with $\\varepsilon_{\\text{negl}} = 0.05$. We can translate this into a condition on $r$:\n$$1 - \\frac{1}{\\sqrt{1+r}} \\le \\varepsilon_{\\text{negl}} \\implies 1 - \\varepsilon_{\\text{negl}} \\le \\frac{1}{\\sqrt{1+r}} \\implies \\sqrt{1+r} \\le \\frac{1}{1 - \\varepsilon_{\\text{negl}}}$$\n$$1+r \\le \\frac{1}{(1 - \\varepsilon_{\\text{negl}})^2} \\implies r \\le \\frac{1}{(1 - \\varepsilon_{\\text{negl}})^2} - 1$$\nThis defines the threshold $r_{\\text{negl}}$. Substituting $\\varepsilon_{\\text{negl}} = 0.05$:\n$$r_{\\text{negl}} = \\frac{1}{(1 - 0.05)^2} - 1 = \\frac{1}{0.95^2} - 1 = \\frac{1}{0.9025} - 1 \\approx 1.108033 - 1 = 0.108033$$\nSo, the negligible regime corresponds to $r \\le 0.108033$.\n\n- **Added-mass dominant (code $2$)**: This regime is defined by the added mass being significantly larger than the structural mass, specifically by a factor of at least $10$. The criterion is $r \\ge \\tau_{\\text{dom}}$, with $\\tau_{\\text{dom}} = 10$.\n\n- **Added-mass comparable (code $1$)**: This regime covers all intermediate cases where $r_{\\text{negl}}  r  \\tau_{\\text{dom}}$.\n\nFor multiphysics simulations, the strength of the coupling between fluid and solid domains is crucial. A key indicator is the fluid inertia fraction, $\\gamma$, which measures the proportion of the total effective mass contributed by the fluid:\n$$\\gamma = \\frac{m_a}{m_s + m_a} = \\frac{m_a/m_s}{1 + m_a/m_s} = \\frac{r}{1+r}$$\nThe problem states that strong (implicit) coupling is recommended if the fluid inertia fraction is significant, specifically if $\\gamma \\ge \\gamma_{\\text{crit}}$, with $\\gamma_{\\text{crit}} = 0.3$. This condition is equivalent to:\n$$\\frac{r}{1+r} \\ge 0.3 \\implies r \\ge 0.3(1+r) \\implies 0.7r \\ge 0.3 \\implies r \\ge \\frac{3}{7} \\approx 0.42857$$\nA boolean value (True/False) will represent this recommendation.\n\nFinally, for time-domain simulations using explicit methods like the central-difference scheme, the numerical stability is limited by the system's highest frequency. The critical time-step limit for a linear oscillator is:\n$$\\Delta t_{\\text{crit}} = \\frac{2}{\\omega}$$\nwhere $\\omega = \\sqrt{k/m_{\\text{eff}}}$. This value will be computed for each case.\n\nThe algorithmic procedure for each test case $(\\rho_s, \\rho_f, C_a)$ with fixed parameters $k=1.0 \\times 10^5\\,\\mathrm{N/m}$ and $V=1.0\\,\\mathrm{m^3}$ is as follows:\n1.  Calculate the mass ratio: $r = (C_a \\rho_f) / \\rho_s$.\n2.  Determine the regime code:\n    - If $r \\le r_{\\text{negl}} \\approx 0.108033$, code is $0$.\n    - If $r \\ge \\tau_{\\text{dom}} = 10$, code is $2$.\n    - Otherwise, code is $1$.\n3.  Calculate the frequency ratio: $\\omega/\\omega_{\\text{dry}} = 1/\\sqrt{1+r}$.\n4.  Determine the strong coupling recommendation: True if $r \\ge 3/7$, False otherwise.\n5.  Calculate the wet natural frequency: $\\omega = \\sqrt{k / ((\\rho_s + C_a \\rho_f)V)}$.\n6.  Calculate the critical time step: $\\Delta t_{\\text{crit}} = 2/\\omega$.\n7.  Assemble the four results: [regime code, frequency ratio, coupling recommendation, critical time step].\nThis procedure is now implemented for all specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FSI added-mass problem for a set of test cases.\n    \"\"\"\n    \n    # Define fixed parameters and criteria from the problem statement.\n    k = 1.0e5  # Stiffness in N/m\n    V = 1.0    # Characteristic volume in m^3\n\n    epsilon_negl = 0.05\n    tau_dom = 10.0\n    gamma_crit = 0.3\n\n    # Calculate the threshold for the negligible regime.\n    r_negl = 1 / (1 - epsilon_negl)**2 - 1\n\n    # Calculate the mass ratio threshold for strong coupling.\n    # gamma = r / (1 + r) = gamma_crit  = r = gamma_crit / (1 - gamma_crit)\n    r_strong_coupling_threshold = gamma_crit / (1 - gamma_crit)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (rho_s, rho_f, C_a).\n    test_cases = [\n        (10.0, 1000.0, 1.0),                  # Case 1\n        (1000.0, 1000.0, 1.0),                # Case 2\n        (10000.0, 1000.0, 1.0),               # Case 3 (r=0.1)\n        (25000.0/3.0, 1000.0, 1.0),           # Case 4 (r=0.12)\n        (1000.0/9.0, 1000.0, 1.0),            # Case 5 (r=9.0)\n        (50.0, 1000.0, 0.5),                  # Case 6 (r=10.0)\n        (8000.0, 1000.0, 2.0),                # Case 7 (r=0.25)\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_s, rho_f, C_a = case\n\n        # 1. Calculate the mass ratio r.\n        # Ensure rho_s is not zero to avoid division errors, though not expected here.\n        if rho_s == 0:\n            # Handle theoretically infinite mass ratio\n            r = float('inf')\n        else:\n            r = (C_a * rho_f) / rho_s\n        \n        # 2. Determine the regime code.\n        if r = r_negl:\n            regime_code = 0  # Negligible\n        elif r = tau_dom:\n            regime_code = 2  # Dominant\n        else:\n            regime_code = 1  # Comparable\n\n        # 3. Calculate the frequency ratio omega / omega_dry.\n        freq_ratio = 1 / np.sqrt(1 + r)\n\n        # 4. Determine the strong coupling recommendation.\n        # gamma = r / (1 + r)\n        # strong_coupling = gamma = gamma_crit\n        # Using the pre-calculated threshold on r is more direct.\n        strong_coupling = r = r_strong_coupling_threshold\n\n        # 5. Calculate the effective mass and wet natural frequency.\n        m_s = rho_s * V\n        m_a = C_a * rho_f * V\n        m_eff = m_s + m_a\n        \n        # Check for m_eff = 0 to avoid domain errors in sqrt, though physically not expected.\n        if m_eff  0:\n            omega = np.sqrt(k / m_eff)\n            # 6. Calculate the critical explicit time step.\n            dt_crit = 2 / omega\n        else:\n            omega = float('inf')\n            dt_crit = 0.0\n\n        # Assemble the results for the current case.\n        case_result = [regime_code, freq_ratio, strong_coupling, dt_crit]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list of lists matches the required format.\n    # Using \", \".join() to have spaces after commas between inner lists.\n    # Example format: [[c1, f1, b1, t1], [c2, f2, b2, t2], ...]\n    output_str = \"[\" + \", \".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3527931"}, {"introduction": "The previous practices treated the added-mass matrix as a known input. This final exercise delves into the fundamental question of where these coefficients originate by tasking you with their computation from first principles [@problem_id:3528013]. You will implement a Boundary Element Method (BEM) to solve the potential flow equations for an accelerating body, thereby calculating the added-mass matrix directly. This practice provides a deep appreciation for added mass as the macroscopic manifestation of the fluid's inertial reaction to structural motion.", "problem": "Consider a two-dimensional, incompressible, inviscid, irrotational flow around a rigid body undergoing small rigid-body accelerations. The fluid-structure interaction (FSI) added-mass matrix arises from the unsteady pressure field induced by the body's acceleration and can be computed within the linearized potential-flow framework. Assume the flow is governed by a velocity potential that satisfies Laplace's equation and that quadratic velocity terms in the unsteady Bernoulli equation are negligible.\n\nYour task is to derive, discretize, and implement a boundary-element method to compute the added-mass matrix entries for translation in the plane.\n\nFundamental base:\n- Incompressible irrotational flow implies the existence of a scalar potential $\\Phi(\\mathbf{x},t)$ with velocity $\\mathbf{v} = \\nabla \\Phi$, and the governing equation is Laplace's equation:\n$$\n\\nabla^2 \\Phi(\\mathbf{x},t) = 0 \\quad \\text{in the fluid domain.}\n$$\n- Consider small rigid-body accelerations so that the potential can be decomposed as $\\Phi(\\mathbf{x},t) = t\\,\\phi(\\mathbf{x})$ for a unit acceleration scenario in a given direction. The linearized unsteady Bernoulli equation gives the pressure as\n$$\np(\\mathbf{x},t) = -\\rho \\,\\frac{\\partial \\Phi}{\\partial t} = -\\rho\\,\\phi(\\mathbf{x}),\n$$\nwhere $\\rho$ is the fluid density.\n- For a rigid body with outward unit normal $\\mathbf{n}$ on its boundary $\\Gamma$, the normal acceleration boundary condition for the acceleration potential associated to unit acceleration in the $j$-th Cartesian direction (with $j \\in \\{x,y\\}$) is\n$$\n\\frac{\\partial \\phi^{(j)}}{\\partial n} = \\mathbf{n}\\cdot \\mathbf{e}_j \\quad \\text{on } \\Gamma,\n$$\nwhere $\\mathbf{e}_j$ is the unit vector along the $j$ direction, and $\\phi^{(j)}$ denotes the acceleration potential for that unit acceleration.\n- The hydrodynamic force on the body is obtained by integrating the pressure over the boundary, with the force component $F_i$ given by\n$$\nF_i = -\\int_{\\Gamma} p\\, n_i \\, \\mathrm{d}S = \\rho \\int_{\\Gamma} \\phi \\, n_i \\, \\mathrm{d}S,\n$$\nwhere $i \\in \\{x,y\\}$. The added-mass matrix $\\mathbf{M}_a$ satisfies $F_i = - \\sum_{j} M_{a,ij} \\, a_j$ for acceleration components $a_j$. For unit acceleration in the $j$ direction, the component is\n$$\nM_{a,ij} = - \\rho \\int_{\\Gamma} \\phi^{(j)} \\, n_i \\, \\mathrm{d}S.\n$$\n\nDerive a boundary integral equation for the Neumann problem using the free-space two-dimensional Green's function\n$$\nG(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\|\\mathbf{x}-\\mathbf{y}\\|,\n$$\nand obtain a second-kind integral equation for the unknown boundary potential $\\phi$ evaluated on $\\Gamma$:\n$$\n\\frac{1}{2}\\,\\phi(\\mathbf{x}) + \\int_{\\Gamma} \\phi(\\mathbf{y}) \\, \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} \\, \\mathrm{d}S(\\mathbf{y})\n= \\int_{\\Gamma} \\left(\\frac{\\partial \\phi}{\\partial n}\\right) (\\mathbf{y}) \\, G(\\mathbf{x},\\mathbf{y}) \\, \\mathrm{d}S(\\mathbf{y}), \\quad \\mathbf{x} \\in \\Gamma,\n$$\nwith $\\partial G/\\partial n(\\mathbf{y}) = \\nabla_{\\mathbf{y}} G(\\mathbf{x},\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})$.\n\nDiscretize the boundary $\\Gamma$ into $N$ straight, constant elements with mid-point collocation. Let the midpoints be $\\{\\mathbf{x}_k\\}_{k=1}^N$, panel lengths $\\{L_\\ell\\}_{\\ell=1}^N$, and unit outward normals at panels $\\{\\mathbf{n}_\\ell\\}_{\\ell=1}^N$. Approximate the integral operators by:\n- For the single-layer operator on the right-hand side, use\n$$\n\\int_{\\Gamma_\\ell} G(\\mathbf{x}_k,\\mathbf{y})\\, \\mathrm{d}S(\\mathbf{y}) \\approx\n\\begin{cases}\n-\\dfrac{L_\\ell}{2\\pi}\\left[\\ln\\left(\\dfrac{L_\\ell}{2}\\right) - 1\\right],  k=\\ell \\\\\n-\\dfrac{L_\\ell}{2\\pi}\\,\\ln\\|\\mathbf{x}_k - \\mathbf{y}_\\ell\\|,  k\\neq \\ell\n\\end{cases}\n$$\nwhere $\\mathbf{y}_\\ell$ is the midpoint of panel $\\ell$.\n- For the double-layer operator on the left-hand side, use\n$$\n\\int_{\\Gamma_\\ell} \\frac{\\partial G(\\mathbf{x}_k,\\mathbf{y})}{\\partial n(\\mathbf{y})}\\, \\mathrm{d}S(\\mathbf{y}) \\approx\n\\begin{cases}\n0,  k=\\ell \\\\\n-\\dfrac{L_\\ell}{2\\pi}\\,\\dfrac{(\\mathbf{y}_\\ell - \\mathbf{x}_k)\\cdot \\mathbf{n}_\\ell}{\\|\\mathbf{y}_\\ell - \\mathbf{x}_k\\|^2},  k\\neq \\ell\n\\end{cases}\n$$\n\nAssemble the linear system for the unknown nodal values of $\\phi$:\n$$\n\\left(\\frac{1}{2}\\mathbf{I} + \\mathbf{J}\\right) \\boldsymbol{\\phi} = \\mathbf{I}_G \\,\\mathbf{q},\n$$\nwhere $\\mathbf{J}$ contains the double-layer approximations, $\\mathbf{I}_G$ contains the single-layer approximations, $\\mathbf{q}$ is the vector of prescribed Neumann data $q_\\ell = \\mathbf{n}_\\ell \\cdot \\mathbf{e}_j$, and $\\boldsymbol{\\phi}$ is the vector of unknown boundary potentials. Solve this system for $\\boldsymbol{\\phi}^{(j)}$ for $j=x$ and $j=y$, then compute\n$$\nM_{a,ij} \\approx -\\rho \\sum_{\\ell=1}^{N} \\phi^{(j)}_\\ell \\, n_{i,\\ell}\\, L_\\ell.\n$$\n\nImplement this algorithm to compute the diagonal entries $M_{a,xx}$ and $M_{a,yy}$ (per unit thickness in the out-of-plane direction, with units $\\mathrm{kg/m}$) for the following test suite. Use the density $\\rho = 1000\\,\\mathrm{kg/m^3}$ and constant-element mid-point collocation as described above. Discretize each boundary uniformly in the parameter angle $\\theta \\in [0,2\\pi)$ with $N$ panels.\n\nTest suite:\n- Case $1$ (happy path): Circle of radius $R=1\\,\\mathrm{m}$, $N=300$.\n- Case $2$ (moderate anisotropy): Ellipse with semi-axes $a=2\\,\\mathrm{m}$, $b=0.5\\,\\mathrm{m}$, $N=300$.\n- Case $3$ (slender ellipse, edge case): Ellipse with semi-axes $a=3\\,\\mathrm{m}$, $b=0.3\\,\\mathrm{m}$, $N=360$.\n\nGeometric parameterizations:\n- Circle: $\\mathbf{r}(\\theta) = \\big(R\\cos\\theta, R\\sin\\theta\\big)$.\n- Ellipse: $\\mathbf{r}(\\theta) = \\big(a\\cos\\theta, b\\sin\\theta\\big)$.\n\nCompute and output, for each case in order, the two diagonal entries $M_{a,xx}$ and $M_{a,yy}$ in $\\mathrm{kg/m}$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,...]\"). The results must be printed as floating-point numbers in $\\mathrm{kg/m}$ without additional text. It is acceptable if values are not rounded, but they must be valid floating-point literals.", "solution": "The problem requires the computation of the diagonal entries of the added-mass matrix for a two-dimensional rigid body in an ideal fluid. The method specified is the Boundary Element Method (BEM) applied to the linearized potential flow equations.\n\nThe governing physics is described by Laplace's equation for the velocity potential, $\\nabla^2 \\Phi = 0$. For a body undergoing a rigid-body acceleration, the total potential can be decomposed. For a unit acceleration in the $j$-th direction, $\\mathbf{a} = \\mathbf{e}_j$, the potential is $\\Phi(\\mathbf{x},t) = t\\,\\phi^{(j)}(\\mathbf{x})$, where $\\phi^{(j)}$ is the acceleration potential. This potential must satisfy Laplace's equation $\\nabla^2 \\phi^{(j)} = 0$ in the fluid domain and a Neumann boundary condition on the body's surface $\\Gamma$:\n$$\n\\frac{\\partial \\phi^{(j)}}{\\partial n} = \\mathbf{n} \\cdot \\mathbf{e}_j\n$$\nwhere $\\mathbf{n}$ is the outward unit normal vector on $\\Gamma$. The pressure $p$ on the surface is given by the linearized Bernoulli equation as $p = -\\rho\\,\\phi^{(j)}$, with $\\rho$ being the fluid density. The $i$-th component of the hydrodynamic force $F_i$ is the integral of pressure projected onto the $i$-th direction:\n$$\nF_i^{(j)} = -\\int_{\\Gamma} p \\, n_i \\, \\mathrm{d}S = \\rho \\int_{\\Gamma} \\phi^{(j)} n_i \\, \\mathrm{d}S\n$$\nThe added-mass coefficients $M_{a,ij}$ are defined such that this force is $F_i^{(j)} = -M_{a,ij}$. Therefore, the expression for the added-mass coefficient is:\n$$\nM_{a,ij} = - \\rho \\int_{\\Gamma} \\phi^{(j)}(\\mathbf{x}) \\, n_i(\\mathbf{x}) \\, \\mathrm{d}S(\\mathbf{x})\n$$\nTo find the unknown potential $\\phi^{(j)}$ on the boundary, we solve the Laplace equation using a boundary integral equation (BIE) formulation. Applying Green's third identity for an exterior problem and taking the limit as the field point $\\mathbf{x}$ approaches the boundary $\\Gamma$ results in the following second-kind BIE:\n$$\n\\frac{1}{2}\\,\\phi(\\mathbf{x}) + \\int_{\\Gamma} \\phi(\\mathbf{y}) \\, \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} \\, \\mathrm{d}S(\\mathbf{y}) = \\int_{\\Gamma} \\frac{\\partial \\phi}{\\partial n}(\\mathbf{y}) \\, G(\\mathbf{x},\\mathbf{y}) \\, \\mathrm{d}S(\\mathbf{y}), \\quad \\text{for } \\mathbf{x} \\in \\Gamma\n$$\nHere, $\\phi$ is the generic acceleration potential, $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\|\\mathbf{x}-\\mathbf{y}\\|$ is the two-dimensional free-space Green's function for the Laplacian, and $\\frac{\\partial \\phi}{\\partial n}$ is the prescribed Neumann data.\n\nThe BEM discretizes this integral equation. The boundary $\\Gamma$ is partitioned into $N$ straight-line segments (panels), indexed $\\ell = 1, \\dots, N$. The potential $\\phi$ and its normal derivative $\\frac{\\partial\\phi}{\\partial n}$ are assumed to be constant over each panel, with their values evaluated at the panel's midpoint. Let $\\mathbf{x}_k$ be the midpoint (collocation point) of the $k$-th panel, $\\Gamma_k$. The discretized BIE, applied at each collocation point $\\mathbf{x}_k$, becomes:\n$$\n\\frac{1}{2}\\,\\phi_k + \\sum_{\\ell=1}^{N} \\phi_\\ell \\int_{\\Gamma_\\ell} \\frac{\\partial G(\\mathbf{x}_k,\\mathbf{y})}{\\partial n(\\mathbf{y})} \\, \\mathrm{d}S(\\mathbf{y}) = \\sum_{\\ell=1}^{N} q_\\ell \\int_{\\Gamma_\\ell} G(\\mathbf{x}_k,\\mathbf{y}) \\, \\mathrm{d}S(\\mathbf{y})\n$$\nwhere $\\phi_k = \\phi(\\mathbf{x}_k)$ are the unknown potential values and $q_\\ell = \\frac{\\partial \\phi}{\\partial n}(\\mathbf{y}_\\ell)$ are the known Neumann data at the midpoint of panel $\\ell$. This forms a linear system of equations:\n$$\n\\left(\\frac{1}{2}\\mathbf{I} + \\mathbf{J}\\right) \\boldsymbol{\\phi} = \\mathbf{I}_G \\,\\mathbf{q}\n$$\nThe entries of the matrices $\\mathbf{J}$ and $\\mathbf{I}_G$ are the discretized integral operators, whose approximations are provided in the problem statement.\nFor a panel $\\ell$ with midpoint $\\mathbf{y}_\\ell$ and length $L_\\ell$, and a collocation point at panel $k$ with midpoint $\\mathbf{x}_k$:\nThe double-layer matrix $\\mathbf{J}$ has entries $J_{k\\ell}$:\n$$\nJ_{k\\ell} \\approx \\int_{\\Gamma_\\ell} \\frac{\\partial G(\\mathbf{x}_k,\\mathbf{y})}{\\partial n(\\mathbf{y})}\\, \\mathrm{d}S(\\mathbf{y}) =\n\\begin{cases}\n0,  k=\\ell \\\\\n-\\dfrac{L_\\ell}{2\\pi}\\,\\dfrac{(\\mathbf{y}_\\ell - \\mathbf{x}_k)\\cdot \\mathbf{n}_\\ell}{\\|\\mathbf{y}_\\ell - \\mathbf{x}_k\\|^2},  k\\neq \\ell\n\\end{cases}\n$$\nThe single-layer matrix $\\mathbf{I}_G$ has entries $I_{G,k\\ell}$:\n$$\nI_{G,k\\ell} \\approx \\int_{\\Gamma_\\ell} G(\\mathbf{x}_k,\\mathbf{y})\\, \\mathrm{d}S(\\mathbf{y}) =\n\\begin{cases}\n-\\dfrac{L_\\ell}{2\\pi}\\left[\\ln\\left(\\dfrac{L_\\ell}{2}\\right) - 1\\right],  k=\\ell \\\\\n-\\dfrac{L_\\ell}{2\\pi}\\,\\ln\\|\\mathbf{x}_k - \\mathbf{y}_\\ell\\|,  k\\neq \\ell\n\\end{cases}\n$$\nNote that the problem statement uses $\\mathbf{y}_\\ell$ for the integration panel midpoint, so we replace it with $\\mathbf{x}_\\ell$ for consistency in indexing:\n$$\nJ_{k\\ell} \\approx -\\dfrac{L_\\ell}{2\\pi}\\,\\dfrac{(\\mathbf{x}_\\ell - \\mathbf{x}_k)\\cdot \\mathbf{n}_\\ell}{\\|\\mathbf{x}_\\ell - \\mathbf{x}_k\\|^2} \\quad (k \\neq \\ell) \\quad \\text{and} \\quad I_{G,k\\ell} \\approx -\\dfrac{L_\\ell}{2\\pi}\\,\\ln\\|\\mathbf{x}_k - \\mathbf{x}_\\ell\\| \\quad (k \\neq \\ell)\n$$\n\nThe algorithmic procedure to compute the added-mass terms is as follows:\n1.  **Discretize Geometry**: For a given shape (circle or ellipse) and number of panels $N$, generate $N+1$ vertices that define the $N$ panels. For each panel $\\ell = 1, \\dots, N$:\n    -   Calculate its midpoint $\\mathbf{x}_\\ell$.\n    -   Calculate its length $L_\\ell$.\n    -   Calculate its outward unit normal vector $\\mathbf{n}_\\ell = (n_{x,\\ell}, n_{y,\\ell})$.\n2.  **Assemble Matrices**: Construct the $N \\times N$ matrices $\\mathbf{J}$ and $\\mathbf{I}_G$ using the provided approximations for their entries $J_{k\\ell}$ and $I_{G,k\\ell}$.\n3.  **Define Neumann Data**: To compute the potentials $\\boldsymbol{\\phi}^{(x)}$ and $\\boldsymbol{\\phi}^{(y)}$, we need two sets of Neumann data vectors:\n    -   For acceleration in the x-direction ($j=x$): $\\mathbf{q}^{(x)}$, with entries $q_\\ell^{(x)} = \\mathbf{n}_\\ell \\cdot \\mathbf{e}_x = n_{x,\\ell}$.\n    -   For acceleration in the y-direction ($j=y$): $\\mathbf{q}^{(y)}$, with entries $q_\\ell^{(y)} = \\mathbf{n}_\\ell \\cdot \\mathbf{e}_y = n_{y,\\ell}$.\n4.  **Solve Linear Systems**:\n    -   Form the left-hand-side matrix $\\mathbf{A} = \\frac{1}{2}\\mathbf{I} + \\mathbf{J}$, where $\\mathbf{I}$ is the identity matrix.\n    -   Form the right-hand-side vectors $\\mathbf{b}^{(x)} = \\mathbf{I}_G \\, \\mathbf{q}^{(x)}$ and $\\mathbf{b}^{(y)} = \\mathbf{I}_G \\, \\mathbf{q}^{(y)}$.\n    -   Solve the two linear systems $\\mathbf{A} \\boldsymbol{\\phi}^{(x)} = \\mathbf{b}^{(x)}$ and $\\mathbf{A} \\boldsymbol{\\phi}^{(y)} = \\mathbf{b}^{(y)}$ to obtain the vectors of panel potentials $\\boldsymbol{\\phi}^{(x)}$ and $\\boldsymbol{\\phi}^{(y)}$.\n5.  **Compute Added-Mass Coefficients**: The integral for $M_{a,ij}$ is discretized as a sum over the panels:\n    $$\n    M_{a,ij} \\approx - \\rho \\sum_{\\ell=1}^{N} \\phi^{(j)}_\\ell \\, n_{i,\\ell} \\, L_\\ell\n    $$\n    We compute the required diagonal entries:\n    -   $M_{a,xx} = - \\rho \\sum_{\\ell=1}^{N} \\phi^{(x)}_\\ell \\, n_{x,\\ell} \\, L_\\ell$\n    -   $M_{a,yy} = - \\rho \\sum_{\\ell=1}^{N} \\phi^{(y)}_\\ell \\, n_{y,\\ell} \\, L_\\ell$\n\nThis procedure is applied to each of the three test cases specified, using the given fluid density $\\rho = 1000\\,\\mathrm{kg/m^3}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_added_mass(a, b, N, rho):\n    \"\"\"\n    Computes added-mass coefficients for an ellipse using BEM.\n    a: semi-axis in x-direction\n    b: semi-axis in y-direction\n    N: number of panels\n    rho: fluid density\n    \"\"\"\n    # 1. Discretize Geometry\n    theta_nodes = np.linspace(0, 2 * np.pi, N + 1)\n    nodes_x = a * np.cos(theta_nodes)\n    nodes_y = b * np.sin(theta_nodes)\n    nodes = np.stack((nodes_x, nodes_y), axis=1)\n\n    panel_midpoints = 0.5 * (nodes[:-1] + nodes[1:])\n    panel_vectors = nodes[1:] - nodes[:-1]\n    panel_lengths = np.sqrt(np.sum(panel_vectors**2, axis=1))\n    \n    # Outward normals: rotate tangent by -90 degrees and normalize\n    # Tangent (dx, dy) - Normal (dy, -dx)\n    panel_normals = np.stack((panel_vectors[:, 1], -panel_vectors[:, 0]), axis=1)\n    panel_normals /= panel_lengths[:, np.newaxis]\n\n    # 2. Assemble Matrices J and I_G\n    I_G = np.zeros((N, N))\n    J = np.zeros((N, N))\n\n    # Use broadcasting for off-diagonal elements\n    xk = panel_midpoints[:, np.newaxis, :]  # Collocation points (k)\n    xl = panel_midpoints[np.newaxis, :, :]  # Source points (l)\n    diff_kl = xl - xk # Note: problem defines derivation with (y_l - x_k)\n    dist_sq = np.sum(diff_kl**2, axis=2)\n    dist = np.sqrt(dist_sq)\n\n    nl = panel_normals[np.newaxis, :, :] # Normals of source panels (l)\n    L_l = panel_lengths[np.newaxis, :]   # Lengths of source panels (l)\n    \n    # Off-diagonal elements of I_G\n    I_G_off_diag = (-L_l / (2 * np.pi)) * np.log(dist)\n    \n    # Off-diagonal elements of J\n    # Formula: -L_l/(2*pi) * dot(xl - xk, nl) / ||xl - xk||^2\n    dot_prod = np.sum(diff_kl * nl, axis=2)\n    J_off_diag = (-L_l / (2 * np.pi)) * dot_prod / dist_sq\n    \n    np.fill_diagonal(I_G_off_diag, 0)\n    np.fill_diagonal(J_off_diag, 0)\n    I_G += I_G_off_diag\n    J += J_off_diag\n\n    # Diagonal elements\n    diag_indices = np.arange(N)\n    # I_G diagonal part\n    # A ZeroDivisionError can occur if a panel length is zero, but this is unlikely for these geometries\n    # Handle the log(0) case for very small panels by using a small epsilon if needed, although not required here.\n    I_G[diag_indices, diag_indices] = (-panel_lengths / (2 * np.pi)) * (np.log(panel_lengths / 2) - 1)\n    # J diagonal part is 0\n\n    # 3. Define Neumann Data\n    q_x = panel_normals[:, 0]\n    q_y = panel_normals[:, 1]\n\n    # 4. Solve Linear Systems\n    A = 0.5 * np.identity(N) + J\n    \n    # RHS for x-acceleration\n    b_x = I_G @ q_x\n    phi_x = np.linalg.solve(A, b_x)\n\n    # RHS for y-acceleration\n    b_y = I_G @ q_y\n    phi_y = np.linalg.solve(A, b_y)\n\n    # 5. Compute Added-Mass Coefficients\n    # M_aij = -rho * sum(phi_j * n_i * L)\n    M_axx = -rho * np.sum(phi_x * panel_normals[:, 0] * panel_lengths)\n    M_ayy = -rho * np.sum(phi_y * panel_normals[:, 1] * panel_lengths)\n    \n    return M_axx, M_ayy\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    rho_water = 1000.0  # kg/m^3\n\n    test_cases = [\n        # Case 1: Circle (R=1m, N=300)\n        {'a': 1.0, 'b': 1.0, 'N': 300},\n        # Case 2: Ellipse (a=2m, b=0.5m, N=300)\n        {'a': 2.0, 'b': 0.5, 'N': 300},\n        # Case 3: Ellipse (a=3m, b=0.3m, N=360)\n        {'a': 3.0, 'b': 0.3, 'N': 360},\n    ]\n\n    results = []\n    for case in test_cases:\n        M_axx, M_ayy = compute_added_mass(case['a'], case['b'], case['N'], rho_water)\n        results.extend([M_axx, M_ayy])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3528013"}]}