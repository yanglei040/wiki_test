{"hands_on_practices": [{"introduction": "Understanding piezoelectricity begins with the fundamental constitutive equations. This first practice grounds these abstract relations in a tangible scenario: the response of a simple one-dimensional rod acting as an actuator [@problem_id:3522455]. By deriving the strain and charge under both short-circuit and open-circuit electrical boundary conditions, you will gain direct insight into how electrical constraints govern mechanical deformation, a core principle in the design and analysis of piezoelectric actuators and sensors.", "problem": "A One-Dimensional (1D) poled piezoelectric rod is aligned along its polarization axis and has uniform cross-sectional area $A$, length $L$, Young’s modulus $E_Y$, permittivity $\\epsilon$, and the axial piezoelectric coupling coefficient $d_{33}$. The rod is mechanically stress-free in the axial direction. Consider two distinct electrical boundary conditions applied to the same rod:\n\n1. Short-circuit electrical boundary: the end electrodes are connected to an ideal voltage source that establishes a uniform internal electric field $E$ along the rod.\n2. Open-circuit electrical boundary: the end electrodes are electrically isolated so that no free charge can flow to or from the rod.\n\nStarting from the fundamental definitions and laws governing linear piezoelectricity, continuum mechanics, and electrostatics (including generalized Hooke’s law for linear elasticity and Gauss’s law for the electric displacement), derive the axial strain $\\varepsilon$ and the total free charge $Q$ accumulated on one end electrode under each electrical boundary condition. The rod is stress-free in both cases. Express the strain as a dimensionless quantity and the charge in Coulombs (C). Provide the final expressions for the four quantities in the order $(\\varepsilon_{\\text{sc}}, Q_{\\text{sc}}, \\varepsilon_{\\text{oc}}, Q_{\\text{oc}})$, where the subscripts $\\text{sc}$ and $\\text{oc}$ denote short-circuit and open-circuit, respectively. No numerical evaluation is required, and no rounding is needed. Your final answer must be a single closed-form analytic expression.", "solution": "The problem is deemed valid as it is scientifically grounded in the principles of linear piezoelectricity, is well-posed with a unique and meaningful solution, and is expressed in objective, unambiguous language. It does not violate any of the criteria for invalidity. We may therefore proceed with the solution.\n\nThe behavior of a one-dimensional linear piezoelectric material, poled along the axial direction (conventionally the '3' direction), can be described by a set of coupled constitutive equations. We will use the strain-charge form, which relates the mechanical variables of strain ($\\varepsilon$) and stress ($\\sigma$) to the electrical variables of electric field ($E$) and electric displacement ($D$). Dropping the tensor subscripts for this 1D case, the equations are:\n$$ \\varepsilon = s^E \\sigma + d E \\quad (1) $$\n$$ D = d \\sigma + \\epsilon^\\sigma E \\quad (2) $$\nHere, the parameters are defined as:\n- $\\varepsilon$: axial strain (dimensionless).\n- $\\sigma$: axial stress (in Pascals, $Pa$).\n- $E$: axial electric field (in Volts per meter, $V/m$).\n- $D$: axial electric displacement (in Coulombs per square meter, $C/m^2$).\n- $s^E$: elastic compliance at constant electric field. This is the inverse of Young's modulus, $s^E = 1/E_Y$.\n- $d$: piezoelectric coupling coefficient, given as $d_{33}$. It quantifies the strain generated per unit electric field at constant stress, or equivalently, the electric displacement generated per unit stress at constant electric field.\n- $\\epsilon^\\sigma$: permittivity at constant stress, given as $\\epsilon$.\n\nThe total free charge $Q$ accumulated on an electrode with area $A$ is related to the electric displacement $D$ by Gauss's law for dielectrics. For a uniform field normal to the electrode surface, this relationship is:\n$$ Q = D A \\quad (3) $$\n\nA crucial condition provided in the problem statement is that the rod is mechanically stress-free in the axial direction for both scenarios. This implies:\n$$ \\sigma = 0 $$\nApplying this condition to the constitutive equations $(1)$ and $(2)$ simplifies them to:\n$$ \\varepsilon = d E \\quad (4) $$\n$$ D = \\epsilon E \\quad (5) $$\nNote that the permittivity $\\epsilon$ given in the problem corresponds to $\\epsilon^\\sigma$. Similarly, the piezoelectric coefficient $d_{33}$ corresponds to $d$. We now analyze the two specified electrical boundary conditions using these simplified equations.\n\n**1. Short-circuit (sc) electrical boundary condition:**\nIn this case, an ideal voltage source is connected to the end electrodes, establishing a specified uniform internal electric field $E$ along the rod. The mechanical condition is $\\sigma = 0$.\n\nTo find the axial strain $\\varepsilon_{\\text{sc}}$, we use equation $(4)$:\n$$ \\varepsilon_{\\text{sc}} = d_{33} E $$\n\nTo find the total free charge $Q_{\\text{sc}}$ on one electrode, we first find the electric displacement $D_{\\text{sc}}$ using equation $(5)$:\n$$ D_{\\text{sc}} = \\epsilon E $$\nThen, using equation $(3)$, we find the charge:\n$$ Q_{\\text{sc}} = D_{\\text{sc}} A = \\epsilon A E $$\n\n**2. Open-circuit (oc) electrical boundary condition:**\nIn this case, the end electrodes are electrically isolated. This means no free charge can flow to or from the electrodes, which physically implies that the total net free charge on the electrodes must be zero.\n$$ Q_{\\text{oc}} = 0 $$\nFrom the relationship $Q = DA$, a zero total charge implies that the electric displacement must also be zero throughout the rod:\n$$ D_{\\text{oc}} = 0 $$\nThe mechanical condition remains that the rod is stress-free, so $\\sigma = 0$.\n\nWe use the full constitutive equation $(2)$ to relate the variables:\n$$ D_{\\text{oc}} = d_{33} \\sigma + \\epsilon E_{\\text{oc}} $$\nSubstituting the known conditions $D_{\\text{oc}}=0$ and $\\sigma=0$:\n$$ 0 = d_{33}(0) + \\epsilon E_{\\text{oc}} $$\n$$ 0 = \\epsilon E_{\\text{oc}} $$\nSince the permittivity $\\epsilon$ is a non-zero material property ($\\epsilon > 0$), the internal electric field must be zero:\n$$ E_{\\text{oc}} = 0 $$\n\nNow, to find the axial strain $\\varepsilon_{\\text{oc}}$, we use the constitutive equation $(1)$:\n$$ \\varepsilon_{\\text{oc}} = \\frac{1}{E_Y} \\sigma + d_{33} E_{\\text{oc}} $$\nSubstituting the conditions $\\sigma=0$ and $E_{\\text{oc}}=0$:\n$$ \\varepsilon_{\\text{oc}} = \\frac{1}{E_Y}(0) + d_{33}(0) $$\n$$ \\varepsilon_{\\text{oc}} = 0 $$\n\nIn summary, for the open-circuit, stress-free case, all primary field quantities (strain, electric field, electric displacement) and the free charge are zero. This represents the quiescent equilibrium state of the material in the absence of any electro-mechanical stimulus.\n\nThe four requested quantities are:\n- Strain under short-circuit: $\\varepsilon_{\\text{sc}} = d_{33} E$\n- Charge under short-circuit: $Q_{\\text{sc}} = \\epsilon A E$\n- Strain under open-circuit: $\\varepsilon_{\\text{oc}} = 0$\n- Charge under open-circuit: $Q_{\\text{oc}} = 0$", "answer": "$$\\boxed{\\begin{pmatrix} d_{33} E & \\epsilon A E & 0 & 0 \\end{pmatrix}}$$", "id": "3522455"}, {"introduction": "Building on the static analysis, we now explore the dynamic behavior of piezoelectric materials, a concept central to high-frequency applications like resonators, filters, and transducers. This exercise delves into the thickness-mode resonance of a piezoelectric plate, a classic and fundamentally important problem [@problem_id:3522470]. You will derive how the electrical boundary conditions alter the effective stiffness of the material, leading to a measurable shift in its natural frequency, and quantify this effect using the electromechanical coupling factor, $k_t^2$.", "problem": "Consider a poled, transversely isotropic piezoelectric plate of thickness $h$ and electrode area $A$ with its poling axis aligned with the out-of-plane coordinate $z$. Assume one-dimensional thickness-mode motion with displacement field $u_{3}(z,t)$, small strains, and negligible lateral fields. The governing bases are Newton’s second law and Gauss’s law, together with linear piezoelectric constitutive relations. Specifically, use linear momentum balance in the $z$-direction, $\\partial T_{3}/\\partial z = \\rho\\,\\partial^{2} u_{3}/\\partial t^{2}$ (with mass density $\\rho$), and Gauss’s law in the absence of free charge inside the body, $\\partial D_{3}/\\partial z = 0$. The one-dimensional constitutive equations are $T_{3} = c_{33}^{E}\\,S_{3} - e_{33}\\,E_{3}$ and $D_{3} = e_{33}\\,S_{3} + \\epsilon_{33}^{S}\\,E_{3}$, where $S_{3} = \\partial u_{3}/\\partial z$ is the thickness strain, $E_{3}$ is the thickness electric field, $T_{3}$ is the thickness stress, $D_{3}$ is the thickness electric displacement, $c_{33}^{E}$ is the elastic stiffness at constant electric field, $e_{33}$ is the piezoelectric stress coefficient, and $\\epsilon_{33}^{S}$ is the permittivity at constant strain.\n\nAssume perfectly conducting electrodes on the faces $z=0$ and $z=h$, traction-free mechanical boundary conditions $T_{3}(0,t)=T_{3}(h,t)=0$, and two electrical boundary conditions:\n- Short-circuit: the electrode potential difference is zero, implying $E_{3}(z,t)=0$.\n- Open-circuit: the net free charge on the electrodes is zero, implying $D_{3}(z,t)=0$ throughout the thickness.\n\n1. Starting from the stated bases, derive the one-dimensional eigenvalue problem for thickness-mode vibrations $u_{3}(z,t)=\\Re\\{U(z)\\,\\exp(\\mathrm{i}\\,\\omega t)\\}$ under the mechanical boundary conditions. Show how the effective stiffness entering the wave equation differs between short-circuit and open-circuit electrical boundary conditions, and obtain the corresponding eigenfrequencies.\n\n2. Define the thickness electromechanical coupling factor $k_{t}^{2}$ by the material relation $k_{t}^{2} = \\dfrac{c_{33}^{D} - c_{33}^{E}}{c_{33}^{D}}$, where $c_{33}^{D} = c_{33}^{E} + \\dfrac{e_{33}^{2}}{\\epsilon_{33}^{S}}$ is the elastic stiffness at constant electric displacement. Using your eigenfrequency results, compute the normalized resonance frequency shift between open-circuit and short-circuit conditions,\n$$\n\\Delta = \\frac{f_{\\mathrm{oc}} - f_{\\mathrm{sc}}}{f_{\\mathrm{sc}}},\n$$\nexpressed as a closed-form analytic expression in terms of $k_{t}^{2}$ only. No numerical evaluation is required. Provide your final answer as the single closed-form expression for $\\Delta$. Since $\\Delta$ is dimensionless, no unit specification is needed, and no rounding is required.", "solution": "The problem is first subjected to a rigorous validation to ensure its scientific and logical integrity.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- **Geometry and Coordinates**: A piezoelectric plate of thickness $h$ and electrode area $A$. The poling axis is aligned with the $z$-coordinate, and motion is one-dimensional, $u_{3}(z,t)$.\n- **Governing Equations**:\n  - Momentum Balance: $\\partial T_{3}/\\partial z = \\rho\\,\\partial^{2} u_{3}/\\partial t^{2}$\n  - Gauss's Law (in a dielectric): $\\partial D_{3}/\\partial z = 0$\n- **Constitutive Relations (1D linear piezoelectricity)**:\n  - $T_{3} = c_{33}^{E}\\,S_{3} - e_{33}\\,E_{3}$\n  - $D_{3} = e_{33}\\,S_{3} + \\epsilon_{33}^{S}\\,E_{3}$\n- **Variable Definitions**:\n  - $u_3$: displacement in the $z$-direction\n  - $S_{3} = \\partial u_{3}/\\partial z$: thickness strain\n  - $T_{3}$: thickness stress\n  - $E_{3}$: thickness electric field\n  - $D_{3}$: thickness electric displacement\n  - $\\rho$: mass density\n  - $c_{33}^{E}$: elastic stiffness at constant electric field\n  - $e_{33}$: piezoelectric stress coefficient\n  - $\\epsilon_{33}^{S}$: permittivity at constant strain\n- **Harmonic Solution Form**: $u_{3}(z,t)=\\Re\\{U(z)\\,\\exp(\\mathrm{i}\\,\\omega t)\\}$\n- **Mechanical Boundary Conditions**: Traction-free faces, $T_{3}(0,t)=0$ and $T_{3}(h,t)=0$.\n- **Electrical Boundary Conditions (two cases)**:\n  1.  **Short-circuit (SC)**: potential difference is zero, stated to imply $E_{3}(z,t)=0$.\n  2.  **Open-circuit (OC)**: net free charge on electrodes is zero, stated to imply $D_{3}(z,t)=0$.\n- **Definitions for Part 2**:\n  - Stiffness at constant displacement: $c_{33}^{D} = c_{33}^{E} + \\dfrac{e_{33}^{2}}{\\epsilon_{33}^{S}}$\n  - Thickness electromechanical coupling factor: $k_{t}^{2} = \\dfrac{c_{33}^{D} - c_{33}^{E}}{c_{33}^{D}}$\n- **Required Output**: The normalized frequency shift $\\Delta = \\frac{f_{\\mathrm{oc}} - f_{\\mathrm{sc}}}{f_{\\mathrm{sc}}}$ as a closed-form expression in terms of $k_{t}^{2}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the standard linear theory of piezoelectricity, a well-established field within continuum mechanics. The governing equations, constitutive relations, and boundary conditions are standard for modeling the thickness-mode vibration of a piezoelectric plate. The problem is well-posed, providing sufficient conditions to derive a unique solution for the eigenfrequencies in both short-circuit and open-circuit cases. The language is objective and formal.\n\nThe assumption for the short-circuit case, that zero potential difference implies $E_3(z,t) = 0$ everywhere, is a simplification. In a fully dynamic analysis, $\\int_0^h E_3 dz = 0$ does not necessitate $E_3=0$ pointwise. However, the problem explicitly states this as an imposed condition (\"...implying $E_{3}(z,t)=0$\"). As such, it is treated as a given premise for this specific problem, which is a common pedagogical approach to isolate the effect of electromechanical coupling on the effective stiffness. The open-circuit condition, $D_3(z,t)=0$, is a correct consequence of zero net charge on the electrodes combined with Gauss's law for dielectrics.\n\nThe problem is complete, consistent, and solvable using standard mathematical physics techniques. It is a non-trivial but standard exercise in multiphysics.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be derived.\n\n### Solution Derivation\n\nThe derivation proceeds by formulating a one-dimensional wave equation for each electrical boundary condition, solving the corresponding eigenvalue problem, and then using the resulting eigenfrequencies to compute the required normalized shift.\n\nFrom Gauss's law, $\\partial D_{3}/\\partial z = 0$, it follows that the electric displacement $D_3$ is spatially uniform, i.e., $D_3(z,t) = D_3(t)$.\n\n**Part 1: Eigenvalue Problem and Eigenfrequencies**\n\n**Case A: Short-Circuit (SC) Conditions**\nUnder the short-circuit condition as specified, $E_{3}(z,t) = 0$. Substituting this into the constitutive equation for stress $T_3$ yields:\n$$\nT_{3} = c_{33}^{E}\\,S_{3} - e_{33}(0) = c_{33}^{E}\\,S_{3}\n$$\nThe momentum balance equation is $\\partial T_{3}/\\partial z = \\rho\\,\\partial^{2} u_{3}/\\partial t^{2}$. Substituting the expression for $T_3$ and the definition of strain $S_{3} = \\partial u_{3}/\\partial z$, we obtain the wave equation:\n$$\n\\frac{\\partial}{\\partial z} \\left(c_{33}^{E} \\frac{\\partial u_{3}}{\\partial z}\\right) = \\rho\\,\\frac{\\partial^{2} u_{3}}{\\partial t^{2}} \\implies c_{33}^{E} \\frac{\\partial^{2} u_{3}}{\\partial z^{2}} = \\rho\\,\\frac{\\partial^{2} u_{3}}{\\partial t^{2}}\n$$\nFor a harmonic vibration of the form $u_{3}(z,t) = U(z)\\,\\exp(\\mathrm{i}\\,\\omega t)$, the time derivatives become $\\partial^{2} u_{3}/\\partial t^{2} = -\\omega^{2} U(z)\\,\\exp(\\mathrm{i}\\,\\omega t)$. The wave equation reduces to an ordinary differential equation for the mode shape $U(z)$:\n$$\nc_{33}^{E} \\frac{d^{2}U}{dz^{2}} = -\\rho\\,\\omega^{2} U \\implies \\frac{d^{2}U}{dz^{2}} + \\left(\\frac{\\rho\\,\\omega^{2}}{c_{33}^{E}}\\right) U = 0\n$$\nThis is the eigenvalue problem. The effective elastic stiffness is $c_{33}^{E}$. Let the wavenumber be $k_{\\mathrm{sc}}^{2} = \\rho\\,\\omega^{2}/c_{33}^{E}$. The equation is $\\frac{d^{2}U}{dz^{2}} + k_{\\mathrm{sc}}^{2} U = 0$.\n\nThe mechanical boundary conditions are $T_{3}(0,t)=T_{3}(h,t)=0$. Since $T_3 = c_{33}^E S_3 = c_{33}^E \\frac{\\partial u_3}{\\partial z}$, these conditions translate to $\\frac{\\partial u_3}{\\partial z}(0,t) = 0$ and $\\frac{\\partial u_3}{\\partial z}(h,t)=0$. In terms of the mode shape $U(z)$, we have $\\frac{dU}{dz}(0) = 0$ and $\\frac{dU}{dz}(h)=0$.\n\nThe general solution for $U(z)$ is $U(z) = C_1 \\cos(k_{\\mathrm{sc}} z) + C_2 \\sin(k_{\\mathrm{sc}} z)$. Its derivative is $\\frac{dU}{dz} = -C_1 k_{\\mathrm{sc}} \\sin(k_{\\mathrm{sc}} z) + C_2 k_{\\mathrm{sc}} \\cos(k_{\\mathrm{sc}} z)$.\nApplying the first boundary condition at $z=0$: $\\frac{dU}{dz}(0) = C_2 k_{\\mathrm{sc}} = 0$. For a non-trivial vibration, $k_{\\mathrm{sc}} \\neq 0$, so we must have $C_2=0$.\nThe solution simplifies to $U(z) = C_1 \\cos(k_{\\mathrm{sc}} z)$.\nApplying the second boundary condition at $z=h$: $\\frac{dU}{dz}(h) = -C_1 k_{\\mathrm{sc}} \\sin(k_{\\mathrm{sc}} h) = 0$.\nFor a non-trivial solution ($C_1 \\neq 0$), we require $\\sin(k_{\\mathrm{sc}} h) = 0$. This implies $k_{\\mathrm{sc}} h = n\\pi$ for integers $n=1, 2, 3, \\dots$ (where $n=0$ corresponds to rigid body motion).\nSubstituting the definition of $k_{\\mathrm{sc}}$:\n$$\n\\left(\\sqrt{\\frac{\\rho\\,\\omega_{\\mathrm{sc},n}^{2}}{c_{33}^{E}}}\\right)h = n\\pi \\implies \\omega_{\\mathrm{sc},n}^{2} = \\frac{n^{2}\\pi^{2}c_{33}^{E}}{\\rho h^{2}}\n$$\nThe fundamental frequency ($n=1$) is $f_{\\mathrm{sc}} = \\frac{\\omega_{\\mathrm{sc},1}}{2\\pi} = \\frac{1}{2h}\\sqrt{\\frac{c_{33}^{E}}{\\rho}}$.\n\n**Case B: Open-Circuit (OC) Conditions**\nUnder the open-circuit condition, $D_{3}(z,t) = 0$. From the second constitutive relation, $0 = e_{33}S_{3} + \\epsilon_{33}^{S}E_{3}$, we can express the electric field in terms of the strain:\n$$\nE_{3} = -\\frac{e_{33}}{\\epsilon_{33}^{S}} S_{3}\n$$\nSubstitute this into the first constitutive relation for stress $T_3$:\n$$\nT_{3} = c_{33}^{E}S_{3} - e_{33}\\left(-\\frac{e_{33}}{\\epsilon_{33}^{S}}S_{3}\\right) = \\left(c_{33}^{E} + \\frac{e_{33}^{2}}{\\epsilon_{33}^{S}}\\right)S_{3}\n$$\nThe term in parentheses is the \"stiffened\" elastic modulus, which is given in the problem as $c_{33}^{D}$. Thus, $T_3 = c_{33}^{D} S_3$. The effective stiffness for the open-circuit case is $c_{33}^{D}$.\nThe momentum balance equation now becomes:\n$$\n\\frac{\\partial}{\\partial z} \\left(c_{33}^{D} \\frac{\\partial u_{3}}{\\partial z}\\right) = \\rho\\,\\frac{\\partial^{2} u_{3}}{\\partial t^{2}} \\implies c_{33}^{D} \\frac{\\partial^{2} u_{3}}{\\partial z^{2}} = \\rho\\,\\frac{\\partial^{2} u_{3}}{\\partial t^{2}}\n$$\nThis is a wave equation formally identical to the short-circuit case, but with $c_{33}^{E}$ replaced by $c_{33}^{D}$.\nThe eigenvalue problem is $\\frac{d^{2}U}{dz^{2}} + k_{\\mathrm{oc}}^{2} U = 0$, where the wavenumber is now $k_{\\mathrm{oc}}^{2} = \\rho\\,\\omega^{2}/c_{33}^{D}$.\nThe mechanical boundary conditions $T_3=0$ are unchanged. Since $T_3$ is still proportional to $S_3 = \\partial u_3 / \\partial z$, the boundary conditions on $U(z)$ remain $\\frac{dU}{dz}(0)=0$ and $\\frac{dU}{dz}(h)=0$.\nThe entire solution procedure is identical, leading to the condition $k_{\\mathrm{oc}} h = n\\pi$.\nSubstituting the definition of $k_{\\mathrm{oc}}$:\n$$\n\\left(\\sqrt{\\frac{\\rho\\,\\omega_{\\mathrm{oc},n}^{2}}{c_{33}^{D}}}\\right)h = n\\pi \\implies \\omega_{\\mathrm{oc},n}^{2} = \\frac{n^{2}\\pi^{2}c_{33}^{D}}{\\rho h^{2}}\n$$\nThe fundamental frequency ($n=1$) for the open-circuit case is $f_{\\mathrm{oc}} = \\frac{\\omega_{\\mathrm{oc},1}}{2\\pi} = \\frac{1}{2h}\\sqrt{\\frac{c_{33}^{D}}{\\rho}}$.\n\n**Part 2: Normalized Frequency Shift**\nWe are asked to compute $\\Delta = \\frac{f_{\\mathrm{oc}} - f_{\\mathrm{sc}}}{f_{\\mathrm{sc}}}$. This can be rewritten as $\\Delta = \\frac{f_{\\mathrm{oc}}}{f_{\\mathrm{sc}}} - 1$.\nUsing the fundamental frequencies derived above:\n$$\n\\frac{f_{\\mathrm{oc}}}{f_{\\mathrm{sc}}} = \\frac{\\frac{1}{2h}\\sqrt{\\frac{c_{33}^{D}}{\\rho}}}{\\frac{1}{2h}\\sqrt{\\frac{c_{33}^{E}}{\\rho}}} = \\sqrt{\\frac{c_{33}^{D}}{c_{33}^{E}}}\n$$\nTherefore, the normalized frequency shift is:\n$$\n\\Delta = \\sqrt{\\frac{c_{33}^{D}}{c_{33}^{E}}} - 1\n$$\nWe must now express this in terms of the thickness electromechanical coupling factor $k_{t}^{2}$, defined as $k_{t}^{2} = \\dfrac{c_{33}^{D} - c_{33}^{E}}{c_{33}^{D}}$.\nWe can rearrange this definition to find the ratio $c_{33}^{D}/c_{33}^{E}$:\n$$\nk_{t}^{2} = 1 - \\frac{c_{33}^{E}}{c_{33}^{D}} \\implies \\frac{c_{33}^{E}}{c_{33}^{D}} = 1 - k_{t}^{2}\n$$\nInverting this gives the required ratio:\n$$\n\\frac{c_{33}^{D}}{c_{33}^{E}} = \\frac{1}{1 - k_{t}^{2}}\n$$\nSubstituting this result into the expression for $\\Delta$:\n$$\n\\Delta = \\sqrt{\\frac{1}{1 - k_{t}^{2}}} - 1 = \\frac{1}{\\sqrt{1 - k_{t}^{2}}} - 1\n$$\nThis is the final closed-form analytic expression for the normalized frequency shift in terms of $k_{t}^{2}$ only.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{1 - k_{t}^{2}}} - 1}$$", "id": "3522470"}, {"introduction": "The ultimate goal of multiphysics modeling is often numerical simulation. This final practice bridges the gap between analytical theory and computational implementation, challenging you to construct a minimal yet functional code for a piezoelectric element [@problem_id:3522419]. By implementing the constitutive laws and handling various boundary conditions—such as prescribed voltage and prescribed charge—you will solidify your understanding of how these physical concepts translate into a robust computational model, a critical skill for any simulation engineer.", "problem": "Consider a homogeneous piezoelectric unit cube occupying a volume with side length $h$ in meters, with parallel electrodes on the faces normal to the $z$-axis. The material has uniform piezoelectric constant $d_{33}$ in Coulombs per Newton, and uniform permittivity at constant stress $\\epsilon^T_{33}$ in Farads per meter. Assume the mechanical stress is uniform and applied along the $z$-axis with magnitude $\\sigma_{3}$ in Pascals, and that there are no free charges in the bulk. The electrodes cover the entire top and bottom faces, each of area $A$ in square meters. The system is quasi-static, and fields are assumed to be one-dimensional and uniform along the $z$-direction.\n\nStarting from the foundational principles, use Gauss's law for electrostatics in dielectrics ($\\nabla \\cdot \\mathbf{D} = \\rho_f$) and the absence of free charge in the bulk ($\\rho_f = 0$), together with the definition of the electric field as the gradient of potential ($\\mathbf{E} = -\\nabla \\phi$), and the linear piezoelectric constitutive equation for the normal electric displacement component:\n$$\nD_{3} = d_{33} \\, \\sigma_{3} + \\epsilon^T_{33} \\, E_{3},\n$$\nto construct a minimal computational model that, for specified boundary conditions at the electrodes, computes the uniform electric displacement $D_{3}$ in Coulombs per square meter, the uniform electric field $E_{3}$ in Volts per meter, the electrode potential difference $V$ in Volts, and the total electrode free charge $Q$ in Coulombs. For a parallel-plate geometry with uniform fields, the potential difference and electric field satisfy $E_{3} = V/h$, and the total electrode charge satisfies $Q = D_{3} A$.\n\nYour program must accept a test suite of parameter sets specifying boundary conditions as one of the following types:\n\n- Prescribed voltage: type $=$ \"V\", with given $V$ in Volts. Compute $E_{3}$ from $V$ and then determine $D_{3}$ and $Q$ using the constitutive relation and geometry.\n- Prescribed charge: type $=$ \"Q\", with given $Q$ in Coulombs. Compute $D_{3}$ from $Q/A$, then determine $E_{3}$ and $V$ using the constitutive relation and geometry.\n- Mixed boundary condition: type $=$ \"mixed\", with given top electrode potential $V$ in Volts and specified bottom boundary condition as a normal electric displacement $D_{n}$ in Coulombs per square meter. Since the fields are uniform in this model, check consistency by computing $D_{3}$ from the constitutive relation and geometry and compare it to the specified $D_{n}$.\n\nFor each test case, return a result in the form of a list $[D_{3}, E_{3}, V, Q, \\text{is\\_consistent}]$, where $D_{3}$ is in $\\mathrm{C/m^2}$, $E_{3}$ is in $\\mathrm{V/m}$, $V$ is in $\\mathrm{V}$, $Q$ is in $\\mathrm{C}$, and $\\text{is\\_consistent}$ is a boolean indicating whether the constitutive relation $D_{3} = d_{33} \\sigma_{3} + \\epsilon^T_{33} E_{3}$ holds within a small numerical tolerance (for prescribed voltage and charge cases), and for the mixed case, whether the computed $D_{3}$ matches the specified $D_{n}$ within a small numerical tolerance.\n\nUse the following International System of Units (SI) test suite, where all scalars must be interpreted in SI units:\n\n- Common geometric and material parameters: $h = 1.0$ meters, $A = 1.0$ square meters, $d_{33} = 4.0 \\times 10^{-12}$ Coulombs per Newton, $\\epsilon^T_{33} = 1.33 \\times 10^{-8}$ Farads per meter, $\\sigma_{3} = 1.0 \\times 10^{6}$ Pascals.\n- Test case $1$ (happy path, prescribed voltage): type $=$ \"V\", $V = 100.0$ Volts.\n- Test case $2$ (happy path, prescribed charge): type $=$ \"Q\", $Q = 3.0 \\times 10^{-6}$ Coulombs.\n- Test case $3$ (mixed, consistent): type $=$ \"mixed\", $V = 50.0$ Volts, $D_{n} = d_{33} \\sigma_{3} + \\epsilon^T_{33} \\left(\\frac{V}{h}\\right)$.\n- Test case $4$ (mixed, inconsistent): type $=$ \"mixed\", $V = 10.0$ Volts, $D_{n} = 5.0 \\times 10^{-6}$ Coulombs per square meter.\n- Test case $5$ (edge case, zero voltage): type $=$ \"V\", $V = 0.0$ Volts.\n- Test case $6$ (edge case, zero charge): type $=$ \"Q\", $Q = 0.0$ Coulombs.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the per-test-case list $[D_{3}, E_{3}, V, Q, \\text{is\\_consistent}]$. For example, the output format should be like $[ [d_1,e_1,v_1,q_1,b_1],[d_2,e_2,v_2,q_2,b_2], \\dots ]$ with numeric values as floating-point numbers in SI units and boolean values as either $\\text{True}$ or $\\text{False}$.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of linear piezoelectricity and electrostatics, well-posed with a clear path to a unique solution for each case, and objective in its formulation. All necessary parameters and conditions are provided to construct a computational model.\n\nThe physical system under consideration is a piezoelectric material subjected to a uniform mechanical stress $\\sigma_{3}$ and an electric field $E_{3}$, both along the $z$-direction. The analysis begins with the fundamental principles of electrostatics in a dielectric medium.\n\nGauss's law for the electric displacement field $\\mathbf{D}$ is given by $\\nabla \\cdot \\mathbf{D} = \\rho_f$, where $\\rho_f$ is the density of free electric charge. The problem states that there are no free charges in the bulk of the material, so $\\rho_f = 0$. In the one-dimensional case, where $\\mathbf{D} = D_{3}(z)\\hat{\\mathbf{z}}$, Gauss's law simplifies to $\\frac{dD_{3}}{dz} = 0$. This implies that the electric displacement $D_{3}$ is uniform (constant) throughout the material, which is consistent with the problem's assumption.\n\nThe electric field $\\mathbf{E}$ is defined as the negative gradient of the electric potential $\\phi$, i.e., $\\mathbf{E} = -\\nabla \\phi$. For the one-dimensional case, this becomes $E_{3} = -\\frac{d\\phi}{dz}$. Since the problem assumes a uniform electric field $E_{3}$, this means $E_{3}$ is constant. The potential difference $V$ across the material of thickness $h$ is obtained by integrating the electric field from the bottom electrode (at $z=0$) to the top electrode (at $z=h$):\n$$V = \\phi(0) - \\phi(h) = \\int_0^h E_{3} \\, dz = E_{3}h$$\nThis gives the specified relationship $E_{3} = V/h$.\n\nThe core of the electro-mechanical coupling is described by the linear piezoelectric constitutive equation. For the component along the $z$-direction, this is given as:\n$$D_{3} = d_{33} \\sigma_{3} + \\epsilon^T_{33} E_{3}$$\nHere, $D_{3}$ is the electric displacement, $\\sigma_{3}$ is the applied normal stress, $E_{3}$ is the electric field, $d_{33}$ is the piezoelectric constant coupling stress to displacement, and $\\epsilon^T_{33}$ is the permittivity of the material at constant stress. The first term, $d_{33} \\sigma_{3}$, represents the electric displacement generated by the mechanical stress (the direct piezoelectric effect), while the second term, $\\epsilon^T_{33} E_{3}$, is the standard dielectric response to an electric field.\n\nFinally, for a parallel-plate capacitor geometry with uniform displacement $D_3$, the total free charge $Q$ accumulated on an electrode of area $A$ is given by $Q = D_3 A$.\n\nWith these principles, we can construct the computational model for each specified boundary condition.\n\n**Case 1: Prescribed Voltage (type \"V\")**\nWhen the potential difference $V$ across the electrodes is prescribed, the computational steps are as follows:\n1.  Calculate the uniform electric field $E_{3}$ using the relation $E_{3} = V/h$.\n2.  Substitute this $E_{3}$ into the constitutive equation to find the electric displacement $D_{3}$: $D_{3} = d_{33} \\sigma_{3} + \\epsilon^T_{33} (V/h)$.\n3.  Calculate the total electrode charge $Q$ using the relation $Q = D_{3}A$.\n4.  The system is deemed consistent if the computed values satisfy the constitutive relation, which they will by this construction, barring numerical floating-point errors. A numerical check confirms $|D_3 - (d_{33} \\sigma_{3} + \\epsilon^T_{33} E_{3})| \\le \\text{tolerance}$.\n\n**Case 2: Prescribed Charge (type \"Q\")**\nWhen the total free charge $Q$ on the electrodes is prescribed, the steps are:\n1.  Calculate the uniform electric displacement $D_{3}$ from the relation $D_{3} = Q/A$.\n2.  Rearrange the constitutive equation to solve for the electric field $E_{3}$:\n    $$E_{3} = \\frac{D_{3} - d_{33} \\sigma_{3}}{\\epsilon^T_{33}}$$\n3.  Calculate the potential difference $V$ across the electrodes using $V = E_{3}h$.\n4.  As in the previous case, consistency is confirmed by checking the constitutive relation with the computed values.\n\n**Case 3: Mixed Boundary Condition (type \"mixed\")**\nIn this scenario, a potential $V$ at the top electrode is given, along with a specified normal electric displacement $D_{n}$ at the boundary. The task is to check for consistency.\n1.  Using the given potential $V$, compute the electric field $E_{3} = V/h$.\n2.  Using this $E_3$, calculate the electric displacement $D_{3,\\text{computed}}$ that the material *should* have according to the constitutive law: $D_{3,\\text{computed}} = d_{33} \\sigma_{3} + \\epsilon^T_{33} E_{3}$.\n3.  The consistency check involves comparing this computed displacement $D_{3,\\text{computed}}$ with the prescribed boundary displacement $D_{n}$. The condition is consistent if $|D_{3,\\text{computed}} - D_{n}| \\le \\text{tolerance}$.\n4.  The output values $[D_3, E_3, V, Q]$ are based on the model's internal state derived from the given potential $V$. Thus, $D_3 = D_{3,\\text{computed}}$, $E_3 = V/h$, $V$ is the input value, and $Q = D_{3,\\text{computed}}A$. The final boolean value indicates the result of the consistency check.\n\nThe provided test cases will be evaluated according to these models. A numerical tolerance, managed by `numpy.isclose`, will be used for all floating-point comparisons to ensure robustness.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the electro-mechanical state of a piezoelectric cube under\n    various boundary conditions.\n    \"\"\"\n\n    # Common geometric and material parameters in SI units\n    h = 1.0  # meters\n    A = 1.0  # square meters\n    d33 = 4.0e-12  # Coulombs per Newton\n    epsT33 = 1.33e-8  # Farads per meter\n    sigma3 = 1.0e6  # Pascals\n\n    # Define the test suite\n    test_cases = [\n        # type, value\n        # Test case 1: prescribed voltage\n        (\"V\", 100.0),\n        # Test case 2: prescribed charge\n        (\"Q\", 3.0e-6),\n        # Test case 3: mixed, consistent\n        # Dn = d33 * sigma3 + epsT33 * (V/h)\n        # Dn = (4e-12 * 1e6) + (1.33e-8 * (50.0/1.0)) = 4e-6 + 0.665e-6 = 4.665e-6\n        (\"mixed\", (50.0, 4.665e-6)),\n        # Test case 4: mixed, inconsistent\n        (\"mixed\", (10.0, 5.0e-6)),\n        # Test case 5: edge case, zero voltage (short-circuit)\n        (\"V\", 0.0),\n        # Test case 6: edge case, zero charge (open-circuit)\n        (\"Q\", 0.0)\n    ]\n\n    results = []\n\n    for case_type, bc_value in test_cases:\n        D3, E3, V, Q, is_consistent = 0.0, 0.0, 0.0, 0.0, False\n\n        if case_type == \"V\":\n            V = bc_value\n            E3 = V / h\n            D3 = d33 * sigma3 + epsT33 * E3\n            Q = D3 * A\n            # Consistency is by construction, check numerically\n            is_consistent = np.isclose(D3, d33 * sigma3 + epsT33 * E3)\n\n        elif case_type == \"Q\":\n            Q = bc_value\n            D3 = Q / A\n            # Check if epsT33 is non-zero to avoid division by zero\n            if epsT33 != 0:\n                E3 = (D3 - d33 * sigma3) / epsT33\n            else:\n                # If epsT33 is zero, E3 is undefined unless D3 = d33 * sigma3\n                # This is an unlikely physical scenario but handled for robustness\n                E3 = np.inf if not np.isclose(D3, d33 * sigma3) else 0.0\n\n            V = E3 * h\n            # Consistency is by construction, check numerically\n            is_consistent = np.isclose(D3, d33 * sigma3 + epsT33 * E3)\n\n        elif case_type == \"mixed\":\n            V_given, Dn_given = bc_value\n            V = V_given\n            \n            # Compute model-derived values based on V_given\n            E3 = V / h\n            D3_computed = d33 * sigma3 + epsT33 * E3\n            Q = D3_computed * A\n            D3 = D3_computed\n\n            # Check consistency against the provided Dn_given\n            is_consistent = np.isclose(D3_computed, Dn_given)\n\n        results.append([D3, E3, V, Q, is_consistent])\n\n    # Helper function to format a list into the \"[item1,item2,...]\" string format\n    def format_list_as_string(lst):\n        # Python's bool `True` / `False` string representation is correct.\n        # Floats are also represented correctly.\n        return f\"[{','.join(map(str, lst))}]\"\n\n    # Format the final output string as a list of lists\n    output_str = f\"[{','.join([format_list_as_string(r) for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3522419"}]}