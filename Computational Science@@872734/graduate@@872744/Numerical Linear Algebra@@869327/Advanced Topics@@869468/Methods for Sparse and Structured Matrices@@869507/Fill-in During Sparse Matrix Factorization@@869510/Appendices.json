{"hands_on_practices": [{"introduction": "To begin, let's explore the fundamental mechanism of fill-in using the graph-theoretic model of Cholesky factorization. This practice uses a simple 4-vertex graph, the smallest graph that is not already chordal, to provide a tangible example of how fill-in arises. By manually tracing the elimination process for two distinct vertex orderings, you will directly observe how the choice of ordering alters the structure of the resulting factored matrix, even when the total amount of fill remains the same [@problem_id:3545912].", "problem": "Consider the symmetric positive definite (SPD) matrix $A \\in \\mathbb{R}^{4 \\times 4}$ with sparsity pattern corresponding to the $4$-cycle graph on vertices $\\{1,2,3,4\\}$, that is, $a_{ii} \\neq 0$ for all $i$, and $a_{ij} \\neq 0$ if and only if $\\{i,j\\} \\in \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}\\}$, with all other off-diagonal entries zero. Assume generic nonzero values on this pattern so that no accidental numerical cancellation affects the structural fill. We perform Cholesky factorization $A = L L^{\\top}$ without pivoting, and we analyze fill-in purely at the level of the elimination graph induced by a vertex ordering.\n\nUsing only the core definitions of sparse Cholesky factorization and its graph-theoretic interpretation (namely: during the elimination of a vertex, all its as-yet uneliminated neighbors are made into a clique in the filled graph; and the nonzero pattern of the factor $L$ corresponds to edges of this triangulated, or chordally completed, graph), do the following:\n\n- For the two orderings $\\pi_{1} = (1,2,3,4)$ and $\\pi_{2} = (2,3,4,1)$, enumerate exactly which strict lower-triangular positions $(i,j)$ with $i > j$ of $L$ become nonzero as fill-in under each ordering, beyond those implied by the original sparsity of $A$.\n- Explain, using the concepts of chordal completion and perfect elimination orderings, why the two fill-in patterns can differ in their locations even when the original matrix is the same.\n\nLet $f(\\pi)$ denote the total count of strict lower-triangular fill-in entries in $L$ that are not present in the original sparsity of $A$ when using ordering $\\pi$. Compute the single quantity $|f(\\pi_{1}) - f(\\pi_{2})|$. Provide your final answer as an exact integer with no units. No rounding is needed.", "solution": "The problem requires an analysis of fill-in during the Cholesky factorization of a specific sparse symmetric positive definite (SPD) matrix $A \\in \\mathbb{R}^{4 \\times 4}$ for two different orderings. The analysis is to be conducted using the graph-theoretic model of sparse matrix factorization.\n\nFirst, we define the graph $G=(V, E)$ that represents the sparsity pattern of the matrix $A$. The set of vertices is $V = \\{1, 2, 3, 4\\}$. The set of edges $E$ contains an edge $\\{i,j\\}$ if and only if the entry $a_{ij}$ is a specified off-diagonal nonzero. According to the problem statement, $a_{ij} \\neq 0$ if and only if $\\{i,j\\} \\in \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}\\}$. This structure corresponds to a cycle graph of length $4$, often denoted $C_4$. The diagonal entries $a_{ii}$ are also nonzero, which is implicit for a vertex in a graph representation.\n\nThe nonzeros in the strict lower-triangular part of $A$ correspond to the edges in $E$. For an edge $\\{i,j\\}$, the corresponding matrix position is $(\\max(i,j), \\min(i,j))$. The initial nonzero positions in the strict lower-triangular part of $A$ are therefore $(2,1)$, $(3,2)$, $(4,3)$, and $(4,1)$.\n\nFill-in entries are new nonzeros created in the Cholesky factor $L$ in positions that were zero in the original matrix $A$. In the graph model, this corresponds to adding edges to the graph $G$ during the elimination process. The nonzero pattern of $L+L^{\\top}$ is given by the edge set of the final *filled graph* (or *chordally completed graph*), denoted $G^+$.\n\nThe elimination process for an ordering $\\pi$ proceeds by eliminating vertices one by one. When a vertex $v$ is eliminated, all of its neighbors in the current graph that have not yet been eliminated are connected to form a clique. Any edge added in this process that was not in the original graph $G$ represents a fill-in.\n\nLet's analyze the two given orderings.\n\n**Analysis for Ordering $\\pi_{1} = (1, 2, 3, 4)$**\n\nWe start with the graph $G = (V, E)$, with $E = \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}\\}$. We denote the sequence of graphs generated during elimination as $G_0, G_1, G_2, \\dots$, where $G_0=G$.\n\n1.  **Eliminate vertex $1$**: The neighbors of vertex $1$ in $G_0$ are vertices $\\{2,4\\}$. These neighbors are not connected by an edge in $G_0$ (i.e., $\\{2,4\\} \\notin E$). To form a clique, we must add the edge $\\{2,4\\}$. This is a fill-in edge. The new graph is $G_1 = (V, E \\cup \\{\\{2,4\\}\\})$. This fill-in corresponds to a new nonzero entry in the Cholesky factor $L$ at the position $(\\max(2,4), \\min(2,4)) = (4,2)$.\n\n2.  **Eliminate vertex $2$**: We now consider the graph $G_1$. The neighbors of vertex $2$ in $G_1$ are $\\{1,3,4\\}$. The uneliminated neighbors (those appearing after $2$ in $\\pi_1$) are $\\{3,4\\}$. We must ensure these neighbors form a clique. The edge $\\{3,4\\}$ is already present in the original graph $G_0$ (and thus in $G_1$). Therefore, no new edge is added.\n\n3.  **Eliminate vertex $3$**: We consider the current graph. The neighbors of vertex $3$ are $\\{2,4\\}$. The only uneliminated neighbor is vertex $4$. A set with a single vertex is trivially a clique, so no new edges are added.\n\n4.  **Eliminate vertex $4$**: This is the last vertex in the ordering, so there are no uneliminated neighbors to connect. No fill-in occurs.\n\nFor the ordering $\\pi_1$, exactly one fill-in occurs. The filled graph is $G_1^+ = (V, E \\cup \\{\\{2,4\\}\\})$. The set of edges corresponding to strict lower-triangular nonzeros in $L$ are $\\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}, \\{2,4\\}\\}$. These correspond to positions $(2,1), (3,2), (4,3), (4,1), (4,2)$. Comparing with the original nonzeros, the single fill-in entry is at position $(4,2)$.\nThus, the number of fill-in entries is $f(\\pi_1) = 1$.\n\n**Analysis for Ordering $\\pi_{2} = (2, 3, 4, 1)$**\n\nWe again start with the graph $G = (V, E)$.\n\n1.  **Eliminate vertex $2$**: The neighbors of vertex $2$ in $G_0$ are $\\{1,3\\}$. These vertices are not connected by an edge. To form a clique, we add the edge $\\{1,3\\}$. This is a fill-in edge. The new graph is $G_1 = (V, E \\cup \\{\\{1,3\\}\\})$. This fill-in corresponds to a new nonzero entry in $L$ at position $(\\max(1,3), \\min(1,3)) = (3,1)$.\n\n2.  **Eliminate vertex $3$**: In the current graph $G_1$, the neighbors of vertex $3$ are $\\{2,4,1\\}$. The uneliminated neighbors (those appearing after $3$ in $\\pi_2$) are $\\{4,1\\}$. We must check if $\\{4,1\\}$ is an edge. The edge $\\{4,1\\}$ is in the original graph $G_0$, so no new edge is added.\n\n3.  **Eliminate vertex $4$**: The neighbors of vertex $4$ in the current graph are $\\{3,1\\}$, of which only $\\{1\\}$ is uneliminated. No new edges are needed.\n\n4.  **Eliminate vertex $1$**: This is the last vertex. No fill-in occurs.\n\nFor the ordering $\\pi_2$, exactly one fill-in also occurs. The filled graph is $G_2^+ = (V, E \\cup \\{\\{1,3\\}\\})$. The fill-in entry is at position $(3,1)$.\nThus, the number of fill-in entries is $f(\\pi_2) = 1$.\n\n**Explanation of the Difference in Fill-in Patterns**\n\nThe fill-in patterns differ because the elimination ordering determines how the original graph is triangulated. A graph is *chordal* (or *triangulated*) if every cycle of length $4$ or more has a *chord* (an edge connecting two non-consecutive vertices in the cycle). The process of sparse Cholesky factorization implicitly computes a *chordal completion* of the matrix's graph, where the fill-in edges are the added chords.\n\nThe initial graph $G$ is a $4$-cycle, which is the simplest example of a non-chordal graph. Therefore, any elimination ordering will result in at least one fill-in edge to break this $4$-cycle. An ordering that produces no fill-in is called a *perfect elimination ordering* (PEO), and a graph possesses a PEO if and only if it is chordal.\n\n-   For ordering $\\pi_1 = (1,2,3,4)$, the elimination process adds the edge $\\{2,4\\}$. This edge acts as a chord for the cycle $1-2-3-4-1$, breaking it into two $3$-cycles ($1-2-4-1$ and $2-3-4-2$). The resulting filled graph $G_1^+$ is chordal. The location of the fill-in is $(4,2)$.\n\n-   For ordering $\\pi_2 = (2,3,4,1)$, the process adds the edge $\\{1,3\\}$. This edge also acts as a chord for the same $4$-cycle, but it breaks it into two different $3$-cycles ($1-2-3-1$ and $1-3-4-1$). The resulting filled graph $G_2^+$ is also chordal, but it is a different graph from $G_1^+$. The location of the fill-in is $(3,1)$.\n\nThe two different orderings lead to two different valid chordal completions of the original graph $G$. Since the fill-in entries are precisely the matrix positions corresponding to the added chords, different chordal completions result in different fill-in patterns. Although the total *number* of fill-ins is the same ($1$) in this specific symmetric case, their *locations* ($(4,2)$ vs. $(3,1)$) are different.\n\n**Final Computation**\n\nThe problem asks for the value of $|f(\\pi_1) - f(\\pi_2)|$.\nWe found that the number of strict lower-triangular fill-in entries for ordering $\\pi_1$ is $f(\\pi_1) = 1$.\nThe number of strict lower-triangular fill-in entries for ordering $\\pi_2$ is $f(\\pi_2) = 1$.\nTherefore, the required quantity is:\n$$\n|f(\\pi_1) - f(\\pi_2)| = |1 - 1| = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "3545912"}, {"introduction": "Now that we've seen that ordering is critical, the next logical question is how to find a *good* ordering. This exercise examines the Minimum Degree heuristic, a foundational greedy algorithm for minimizing fill-in. You will analyze a specially constructed graph designed to expose the limitations of this simple heuristic, demonstrating that a vertex's degree alone is not always a reliable predictor of the fill it will generate upon elimination [@problem_id:3545929]. This reveals the need for more sophisticated strategies that consider the structure of a vertex's neighborhood.", "problem": "Consider sparse symmetric Cholesky factorization without numerical pivoting of a real symmetric positive definite matrix $A \\in \\mathbb{R}^{n \\times n}$, where the evolution of the sparsity pattern is governed by the standard elimination graph model: eliminating a vertex $v$ adds fill edges to make the neighbor set $N(v)$ into a clique in the current graph.\n\nConstruct the following family of sparse matrices parameterized by an integer $m \\geq 3$. Let the vertex set be partitioned as $\\{x\\} \\cup \\{y\\} \\cup U \\cup V$, where $U = \\{u_1,\\dots,u_m\\}$ and $V = \\{v_1,\\dots,v_m\\}$. Define the structural pattern of $A$ (equivalently, the initial graph $G$) as follows:\n- $U$ is an independent set: for all $1 \\leq i  j \\leq m$, $A_{u_i u_j} = 0$.\n- $V$ is a clique: for all $1 \\leq i  j \\leq m$, $A_{v_i v_j} \\neq 0$.\n- $x$ is adjacent exactly to $U$: for all $1 \\leq i \\leq m$, $A_{x u_i} \\neq 0$ and $A_{x y} = 0$, $A_{x v_j} = 0$ for all $1 \\leq j \\leq m$.\n- $y$ is adjacent exactly to $V$: for all $1 \\leq j \\leq m$, $A_{y v_j} \\neq 0$ and $A_{x y} = 0$, $A_{y u_i} = 0$ for all $1 \\leq i \\leq m$.\n- Diagonal entries $A_{ii}  0$ are chosen large enough to render $A$ symmetric positive definite; no other off-diagonal nonzeros are present among these $2m+2$ vertices.\n\nAssume the minimum degree heuristic is used to select elimination pivots, and that ties are broken arbitrarily among vertices with the same current degree. In the initial graph $G$, note that $\\deg(x) = m$ and $\\deg(y) = m$, while $\\deg(u_i) = 1$ and $\\deg(v_j) = m$. To isolate the behavior of the heuristic when it must choose between $x$ and $y$, restrict attention to the induced subgraph on $\\{x\\} \\cup \\{y\\} \\cup U \\cup V$ at a stage of the elimination where previously eliminated vertices have removed any lower-degree distractions, so that both $x$ and $y$ are among the current minimum-degree candidates. Use only the fundamental rule that eliminating a vertex $v$ adds exactly the missing edges among $N(v)$ to make $N(v)$ a clique.\n\nWhich of the following statements are true about the fill-in behavior in this construction and the structural reason for a potential failure of the minimum degree heuristic?\n\nA. If the heuristic selects $x$ before $y$, then at the very first elimination step it introduces exactly $\\binom{m}{2}$ new fill edges among the vertices of $U$.\n\nB. If the heuristic selects $y$ before $x$, then at the very first elimination step it introduces exactly $\\binom{m}{2}$ new fill edges among the vertices of $V$.\n\nC. There exists an elimination ordering on $\\{x\\} \\cup \\{y\\} \\cup U \\cup V$ that produces zero new fill edges within this induced subgraph.\n\nD. The structural reason the minimum degree heuristic can perform poorly here is that $x$ and $y$ have the same degree $m$, but the densities of the induced subgraphs on their neighbor sets differ drastically: $N(x) = U$ is an independent set while $N(y) = V$ is a clique, so degree alone fails to predict the imminent fill created by eliminating $x$ versus $y$.", "solution": "Let's analyze each option based on the graph structure defined in the problem and the rules of the elimination game. The problem defines a specific graph $G$ on the vertex set $\\{x\\} \\cup \\{y\\} \\cup U \\cup V$. In the initial graph, the degrees are $\\deg(u_i)=1$, $\\deg(v_j)=m$, $\\deg(x)=m$, and $\\deg(y)=m$ for $m \\geq 3$. The number of fill edges generated by eliminating a vertex $v$ is the number of pairs of non-adjacent neighbors of $v$. If the neighbor set $N(v)$ has size $k = \\deg(v)$ and the induced subgraph on $N(v)$ has $e_{N(v)}$ edges, the number of fill edges is $\\binom{k}{2} - e_{N(v)}$.\n\n**Analysis of Option A:**\nThis option considers eliminating vertex $x$.\n- The neighbor set is $N(x) = U = \\{u_1, \\dots, u_m\\}$.\n- The degree is $\\deg(x) = |U| = m$.\n- By definition, $U$ is an independent set, meaning the induced subgraph on $U$ has no edges, so $e_{N(x)} = 0$.\n- To make $N(x)$ a clique, we must add an edge between every pair of its $m$ vertices. The number of edges in a clique of size $m$ is $\\binom{m}{2}$.\n- The number of fill edges generated is $\\binom{m}{2} - e_{N(x)} = \\binom{m}{2} - 0 = \\binom{m}{2}$.\n- The statement claims that eliminating $x$ introduces exactly $\\binom{m}{2}$ new fill edges. This is correct.\n\n**Analysis of Option B:**\nThis option considers eliminating vertex $y$.\n- The neighbor set is $N(y) = V = \\{v_1, \\dots, v_m\\}$.\n- The degree is $\\deg(y) = |V| = m$.\n- By definition, $V$ is a clique. The induced subgraph on $V$ is already fully connected, so it has $e_{N(y)} = \\binom{m}{2}$ edges.\n- Since the neighbor set $N(y)$ is already a clique, no new edges are needed to make it one.\n- The number of fill edges generated is $\\binom{m}{2} - e_{N(y)} = \\binom{m}{2} - \\binom{m}{2} = 0$.\n- The statement claims that eliminating $y$ introduces $\\binom{m}{2}$ new fill edges. Our calculation shows $0$ fill edges. Since $m \\geq 3$, $\\binom{m}{2} \\geq 3$, which is not $0$. This statement is incorrect.\n\n**Analysis of Option C:**\nThis option asks if a zero-fill elimination ordering exists. An ordering causes zero fill if at every step, the neighbors of the eliminated vertex (among the remaining vertices) already form a clique.\nConsider the following ordering:\n1.  Eliminate all vertices in $U = \\{u_1, \\dots, u_m\\}$. For any $u_i \\in U$, its only neighbor is $x$. A neighbor set of size one is trivially a clique, so eliminating any $u_i$ generates $0$ fill.\n2.  After eliminating all of $U$, vertex $x$ becomes isolated. Eliminating $x$ now generates $0$ fill.\n3.  The remaining graph consists of vertex $y$ and the clique $V$, with $y$ adjacent to all of $V$.\n4.  Eliminate vertex $y$. Its neighbor set is $N(y) = V$. By construction, $V$ is a clique. Thus, eliminating $y$ generates $0$ fill.\n5.  The remaining vertices are the clique $V$. Eliminating any vertex from a clique leaves a smaller clique, so eliminating the vertices of $V$ one by one generates no fill.\nAn example of a zero-fill ordering is $(u_1, \\dots, u_m, x, y, v_1, \\dots, v_m)$. Since such an ordering exists, the statement is correct.\n\n**Analysis of Option D:**\nThis option provides an explanation for why the minimum degree heuristic can perform poorly.\n- The heuristic can perform poorly because, if allowed to choose between $x$ and $y$ (which have the same degree $m$), it might pick $x$. Eliminating $x$ generates $\\binom{m}{2}$ fill, while an optimal ordering (found in C) generates $0$ fill. Thus, the heuristic can make a suboptimal choice.\n- The statement correctly notes that $\\deg(x) = \\deg(y) = m$, so the heuristic cannot distinguish between them based on degree alone.\n- It also correctly identifies the crucial difference: the neighborhood of $x$, $N(x)=U$, is an independent set (0% dense), while the neighborhood of $y$, $N(y)=V$, is a clique (100% dense).\n- The conclusion is sound: degree alone is a poor predictor of fill in this case because it does not account for the existing connectivity within the neighborhood. This example demonstrates a key limitation of the basic minimum degree algorithm, which led to refinements like the minimum deficiency algorithm.\nThe entire statement in D is a correct and insightful analysis.\n\nTherefore, options A, C, and D are correct.", "answer": "$$\\boxed{ACD}$$", "id": "3545929"}, {"introduction": "Our final practice moves from the abstract world of graph orderings to the practical realities of numerical computation. While preserving sparsity is a primary goal, we cannot ignore the need for numerical stability. This problem highlights the crucial trade-off between these two objectives by comparing a sparsity-preserving Cholesky factorization with a stability-enforcing LU factorization with partial pivoting on the same matrix. By quantifying the resulting difference in fill-in, you will gain a concrete understanding of how pivoting for numerical stability can sometimes work against our efforts to maintain sparsity [@problem_id:3545917].", "problem": "Consider the symmetric positive definite (SPD) matrix $\\mathbf{A} \\in \\mathbb{R}^{5 \\times 5}$ defined by the Gram construction $\\mathbf{A} = \\mathbf{B}^{\\top}\\mathbf{B} + \\alpha \\mathbf{I}$, where $\\mathbf{B} \\in \\mathbb{R}^{5 \\times 5}$ is sparse and given by\n$$\n\\mathbf{B} = \n\\begin{pmatrix}\n1  10  0  0  0 \\\\\n0  10  10  0  0 \\\\\n0  0  10  10  0 \\\\\n0  0  0  10  10 \\\\\n0  0  0  0  10\n\\end{pmatrix},\n$$\nand $\\alpha = 1$. The matrix $\\mathbf{A}$ is therefore SPD by construction. Define the number of off-diagonal nonzeros in a matrix $\\mathbf{M}$ as the count of entries of $\\mathbf{M}$ that are nonzero and not on its diagonal; denote this quantity as $\\operatorname{nnz}_{\\text{off}}(\\mathbf{M})$.\n\nPerform two factorizations of $\\mathbf{A}$ using exact arithmetic:\n1. Cholesky factorization without any pivoting (i.e., $\\mathbf{A} = \\mathbf{L}_{\\text{chol}} \\mathbf{L}_{\\text{chol}}^{\\top}$ with $\\mathbf{L}_{\\text{chol}}$ lower triangular),\n2. Lower-Upper (LU) factorization with partial pivoting (i.e., $\\mathbf{P}\\mathbf{A} = \\mathbf{L}_{\\text{lu}}\\mathbf{U}_{\\text{lu}}$, with $\\mathbf{P}$ a permutation matrix induced by pivoting).\n\nUsing the standard partial pivoting strategy that selects at each step the largest magnitude pivot in the current column below (and including) the pivot position, determine the exact pivot sequence and the resulting sparsity patterns of $\\mathbf{L}_{\\text{lu}}$ and $\\mathbf{U}_{\\text{lu}}$. Then, compute the ratio\n$$\nR \\;=\\; \\frac{\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{lu}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{U}_{\\text{lu}})}{\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}^{\\top})},\n$$\nwhich quantifies the potential increase in fill attributable to pivoting-induced row swaps when comparing LU with partial pivoting to Cholesky without pivoting on the same SPD matrix. Express the final value of $R$ as a reduced fraction. No rounding is required.", "solution": "The matrix $\\mathbf{A} = \\mathbf{B}^{\\top}\\mathbf{B} + \\alpha \\mathbf{I}$ with $\\alpha = 1$ is symmetric positive definite because for any nonzero $\\mathbf{x} \\in \\mathbb{R}^{5}$,\n$$\n\\mathbf{x}^{\\top}\\mathbf{A}\\mathbf{x} = \\mathbf{x}^{\\top}\\mathbf{B}^{\\top}\\mathbf{B}\\mathbf{x} + \\alpha \\|\\mathbf{x}\\|^{2} = \\|\\mathbf{B}\\mathbf{x}\\|^{2} + \\|\\mathbf{x}\\|^{2} > 0.\n$$\nWe begin by computing $\\mathbf{A}$ explicitly. The entries are $A_{ij} = (\\mathbf{B}^\\top\\mathbf{B})_{ij} + \\delta_{ij} = \\sum_{k=1}^5 B_{ki}B_{kj} + \\delta_{ij}$.\nThe diagonal entries are:\n$A_{11} = B_{11}^2 + 1 = 1^2 + 1 = 2$.\n$A_{22} = B_{12}^2 + B_{22}^2 + 1 = 10^2 + 10^2 + 1 = 201$.\n$A_{33} = B_{23}^2 + B_{33}^2 + 1 = 10^2 + 10^2 + 1 = 201$.\n$A_{44} = B_{34}^2 + B_{44}^2 + 1 = 10^2 + 10^2 + 1 = 201$.\n$A_{55} = B_{45}^2 + B_{55}^2 + 1 = 10^2 + 10^2 + 1 = 201$.\nThe off-diagonal entries are:\n$A_{12} = B_{11}B_{12} = 1 \\cdot 10 = 10$.\n$A_{23} = B_{22}B_{23} = 10 \\cdot 10 = 100$.\n$A_{34} = B_{33}B_{34} = 10 \\cdot 10 = 100$.\n$A_{45} = B_{44}B_{45} = 10 \\cdot 10 = 100$.\nBy symmetry, $A_{ji} = A_{ij}$, and all other off-diagonal entries are zero. Thus,\n$$\n\\mathbf{A} =\n\\begin{pmatrix}\n2  10  0  0  0 \\\\\n10  201  100  0  0 \\\\\n0  100  201  100  0 \\\\\n0  0  100  201  100 \\\\\n0  0  0  100  201\n\\end{pmatrix},\n$$\nwhich is a symmetric tri-diagonal matrix.\n\nFor Cholesky factorization without pivoting, it is a standard result that the Cholesky factor of a symmetric positive definite banded matrix preserves the bandwidth. For a tri-diagonal SPD matrix, $\\mathbf{L}_{\\text{chol}}$ is also banded with one subdiagonal (it is a lower bidiagonal matrix). Consequently, the strictly lower-triangular nonzeros of $\\mathbf{L}_{\\text{chol}}$ occur at positions $(2,1)$, $(3,2)$, $(4,3)$, and $(5,4)$, for a total $\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}) = 4$. Since $\\mathbf{L}_{\\text{chol}}^{\\top}$ has the same number of strictly off-diagonal nonzeros (at $(1,2)$, $(2,3)$, $(3,4)$, $(4,5)$), we obtain\n$$\n\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{chol}}^{\\top}) = 4 + 4 = 8.\n$$\n\nWe now perform LU with partial pivoting. At each step, we select the row with the largest magnitude entry in the current column (on or below the diagonal) and swap it into the pivot position.\nStep $1$ (col 1): $|A_{21}|=10 > |A_{11}|=2$. Swap rows 1 and 2. The pivot row is now $(10, 201, 100, 0, 0)$.\nStep $2$ (col 2): The first update introduces fill. After eliminating the new $(2,1)$ entry, the submatrix update creates a fill-in at position $(2,3)$. The pivot search in column 2 then compares the element at $(2,2)$ with the one at $(3,2)$. The latter, $100$, is larger. Swap rows 2 and 3.\nThis continues for each step. The pivot sequence involves swapping up the large `100` entries from the subdiagonal. This process creates significant fill-in in the $\\mathbf{U}$ factor. Let's trace the final sparsity.\nThe final permutation $\\mathbf{P}$ effectively reorders the rows to $(2, 3, 4, 5, 1)$. The matrix being factored is $\\mathbf{PA}$:\n$$\n\\mathbf{PA} = \\begin{pmatrix}\n10  201  100  0  0 \\\\\n0  100  201  100  0 \\\\\n0  0  100  201  100 \\\\\n0  0  0  100  201 \\\\\n2  10  0  0  0\n\\end{pmatrix}.\n$$\nFactoring this matrix $\\mathbf{PA} = \\mathbf{L}_{\\text{lu}}\\mathbf{U}_{\\text{lu}}$:\nThe $\\mathbf{U}_{\\text{lu}}$ factor will have the same upper-triangular structure as $\\mathbf{PA}$, as no new nonzeros are created above the diagonal during forward elimination.\n$$\n\\mathbf{U}_{\\text{lu}} = \\begin{pmatrix}\n10  201  100  0  0 \\\\\n0  100  201  100  0 \\\\\n0  0  100  201  100 \\\\\n0  0  0  100  201 \\\\\n0  0  0  0  u_{55}\n\\end{pmatrix}.\n$$\nThe off-diagonal nonzeros of $\\mathbf{U}_{\\text{lu}}$ are at positions $(1,2), (1,3), (2,3), (2,4), (3,4), (3,5), (4,5)$. This gives $\\operatorname{nnz}_{\\text{off}}(\\mathbf{U}_{\\text{lu}}) = 7$.\n\nThe $\\mathbf{L}_{\\text{lu}}$ factor stores the multipliers. Eliminating the entries in the last row of $\\mathbf{PA}$ will require multipliers $l_{51}, l_{52}, l_{53}, l_{54}$, creating a dense last row in $\\mathbf{L}_{\\text{lu}}$.\n- $l_{51} = 2/10 = 0.2$. Row 5 update creates nonzeros at $(5,2), (5,3)$.\n- $l_{52} = (\\text{updated } a_{52})/u_{22}$. This will be nonzero.\n- And so on. The final $\\mathbf{L}_{\\text{lu}}$ will have the structure:\n$$\n\\mathbf{L}_{\\text{lu}} = \\begin{pmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0 \\\\\nl_{51}  l_{52}  l_{53}  l_{54}  1\n\\end{pmatrix}.\n$$\nThe off-diagonal nonzeros are at $(5,1), (5,2), (5,3), (5,4)$. This gives $\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{lu}}) = 4$.\n\nTherefore, the total number of off-diagonal nonzeros for the LU factorization is:\n$$\n\\operatorname{nnz}_{\\text{off}}(\\mathbf{L}_{\\text{lu}}) + \\operatorname{nnz}_{\\text{off}}(\\mathbf{U}_{\\text{lu}}) = 4 + 7 = 11.\n$$\n\nBy contrast, for Cholesky factorization without pivoting, we found the total was 8.\nHence, the requested ratio is:\n$$\nR = \\frac{11}{8}.\n$$", "answer": "$$\\boxed{\\frac{11}{8}}$$", "id": "3545917"}]}