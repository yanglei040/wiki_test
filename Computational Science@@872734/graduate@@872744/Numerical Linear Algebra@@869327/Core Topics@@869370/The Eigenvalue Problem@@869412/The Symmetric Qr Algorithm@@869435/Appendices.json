{"hands_on_practices": [{"introduction": "The symmetric QR algorithm is built upon the foundational concept of a QR factorization. Before tackling the full iterative process, it is essential to master the mechanics of decomposing a matrix $A$ into an orthogonal matrix $Q$ and an upper triangular matrix $R$. This practice walks you through this core procedure for a tridiagonal matrix, using a sequence of Givens rotations to systematically eliminate subdiagonal entries. Completing this exercise will solidify your understanding of how orthogonal transformations are used to achieve a desired matrix structure.", "problem": "Let $A \\in \\mathbb{R}^{3 \\times 3}$ be the real symmetric tridiagonal matrix\n$$\nA \\;=\\;\n\\begin{pmatrix}\n5 & 2 & 0 \\\\\n2 & 4 & 3 \\\\\n0 & 3 & 1\n\\end{pmatrix}.\n$$\nThe orthogonal-triangular (QR) factorization of a real matrix $A$ is a representation $A = Q R$ with $Q$ orthogonal (i.e., $Q^{\\top} Q = I$) and $R$ upper triangular. For symmetric tridiagonal matrices, the symmetric QR algorithm applies a sequence of plane Givens rotations to annihilate subdiagonal entries, preserving orthogonality while maintaining upper triangular structure in the transformed matrix.\n\nStarting from the foundational definitions of orthogonality and Givens rotations, construct explicitly the sequence of two Givens rotations that, when left-multiplying $A$, annihilate its subdiagonal entries in columns $1$ and $2$. Denote these rotations by $G_{1}$ (acting on rows $1$ and $2$) and $G_{2}$ (acting on rows $2$ and $3$). Verify from first principles that the resulting matrix $R = G_{2} G_{1} A$ is upper triangular and that the orthogonal factor satisfies $Q = G_{1}^{\\top} G_{2}^{\\top}$. Provide all intermediate quantities symbolically (do not substitute decimal approximations), and use only exact algebraic operations justified by core definitions.\n\nYour final task is to report the exact closed-form value of the $(2,3)$ entry of the upper triangular factor $R$ obtained by this process. Express the final answer as a single analytic expression. No rounding is required.", "solution": "The objective is to compute the $(2,3)$ entry of the matrix $R$, where $R = G_{2} G_{1} A$. This process involves two steps of annihilation using Givens rotations.\n\nA general $2 \\times 2$ Givens rotation matrix has the form:\n$$\nG(\\theta) = \\begin{pmatrix} \\cos(\\theta) & -\\sin(\\theta) \\\\ \\sin(\\theta) & \\cos(\\theta) \\end{pmatrix} = \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n$$\nwhere $c^2 + s^2 = 1$. When applied to a vector $\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$, the result is $\\begin{pmatrix} cx_1 - sx_2 \\\\ sx_1 + cx_2 \\end{pmatrix}$. To annihilate the second component, we require $sx_1 + cx_2 = 0$. A standard choice that satisfies this and $c^2+s^2=1$ is $c = \\frac{x_1}{\\sqrt{x_1^2 + x_2^2}}$ and $s = \\frac{-x_2}{\\sqrt{x_1^2 + x_2^2}}$.\n\n**Step 1: Annihilate the $(2,1)$ entry of $A$**\n\nWe apply a Givens rotation $G_1$ to rows $1$ and $2$ of $A$ to annihilate the entry $A_{21}=2$. The relevant entries are from the first column: $x_1 = A_{11} = 5$ and $x_2 = A_{21} = 2$.\n\nThe parameters $c_1$ and $s_1$ for the rotation are calculated as follows:\n$$\nr_1 = \\sqrt{x_1^2 + x_2^2} = \\sqrt{5^2 + 2^2} = \\sqrt{25 + 4} = \\sqrt{29}\n$$\n$$\nc_1 = \\frac{x_1}{r_1} = \\frac{5}{\\sqrt{29}}, \\quad s_1 = \\frac{-x_2}{r_1} = \\frac{-2}{\\sqrt{29}}\n$$\nThe Givens rotation matrix $G_1$ acts on the plane of the first and second coordinates and is the identity elsewhere.\n$$\nG_1 = \\begin{pmatrix} c_1 & -s_1 & 0 \\\\ s_1 & c_1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{\\sqrt{29}} & \\frac{2}{\\sqrt{29}} & 0 \\\\ \\frac{-2}{\\sqrt{29}} & \\frac{5}{\\sqrt{29}} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nWe now compute the intermediate matrix $A' = G_1 A$:\n$$\nA' = \\begin{pmatrix} \\frac{5}{\\sqrt{29}} & \\frac{2}{\\sqrt{29}} & 0 \\\\ \\frac{-2}{\\sqrt{29}} & \\frac{5}{\\sqrt{29}} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 5 & 2 & 0 \\\\ 2 & 4 & 3 \\\\ 0 & 3 & 1 \\end{pmatrix}\n$$\nThe rows of $A'$ are:\n- Row $1$: $(\\frac{5}{\\sqrt{29}})\\begin{pmatrix} 5 & 2 & 0 \\end{pmatrix} + (\\frac{2}{\\sqrt{29}})\\begin{pmatrix} 2 & 4 & 3 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 25+4 & 10+8 & 0+6 \\end{pmatrix} = \\begin{pmatrix} \\frac{29}{\\sqrt{29}} & \\frac{18}{\\sqrt{29}} & \\frac{6}{\\sqrt{29}} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{29} & \\frac{18}{\\sqrt{29}} & \\frac{6}{\\sqrt{29}} \\end{pmatrix}$\n- Row $2$: $(\\frac{-2}{\\sqrt{29}})\\begin{pmatrix} 5 & 2 & 0 \\end{pmatrix} + (\\frac{5}{\\sqrt{29}})\\begin{pmatrix} 2 & 4 & 3 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} -10+10 & -4+20 & 0+15 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{16}{\\sqrt{29}} & \\frac{15}{\\sqrt{29}} \\end{pmatrix}$\n- Row $3$: This row is unchanged: $\\begin{pmatrix} 0 & 3 & 1 \\end{pmatrix}$.\n\nSo, the intermediate matrix is:\n$$\nA' = \\begin{pmatrix} \\sqrt{29} & \\frac{18}{\\sqrt{29}} & \\frac{6}{\\sqrt{29}} \\\\ 0 & \\frac{16}{\\sqrt{29}} & \\frac{15}{\\sqrt{29}} \\\\ 0 & 3 & 1 \\end{pmatrix}\n$$\nAs required, the $(2,1)$ entry has been annihilated.\n\n**Step 2: Annihilate the $(3,2)$ entry of $A'$**\n\nNext, we apply a Givens rotation $G_2$ to rows $2$ and $3$ of $A'$ to annihilate the entry $A'_{32}=3$. The relevant entries are from the second column of $A'$: $x_1' = A'_{22} = \\frac{16}{\\sqrt{29}}$ and $x_2' = A'_{32} = 3$.\n\nThe parameters $c_2$ and $s_2$ for this rotation are:\n$$\nr_2 = \\sqrt{(x_1')^2 + (x_2')^2} = \\sqrt{\\left(\\frac{16}{\\sqrt{29}}\\right)^2 + 3^2} = \\sqrt{\\frac{256}{29} + 9} = \\sqrt{\\frac{256 + 9 \\cdot 29}{29}} = \\sqrt{\\frac{256 + 261}{29}} = \\sqrt{\\frac{517}{29}}\n$$\n$$\nc_2 = \\frac{x_1'}{r_2} = \\frac{16/\\sqrt{29}}{\\sqrt{517/29}} = \\frac{16}{\\sqrt{517}}, \\quad s_2 = \\frac{-x_2'}{r_2} = \\frac{-3}{\\sqrt{517/29}} = \\frac{-3\\sqrt{29}}{\\sqrt{517}}\n$$\nThe Givens rotation matrix $G_2$ acts on the plane of the second and third coordinates:\n$$\nG_2 = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & c_2 & -s_2 \\\\ 0 & s_2 & c_2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{16}{\\sqrt{517}} & \\frac{3\\sqrt{29}}{\\sqrt{517}} \\\\ 0 & \\frac{-3\\sqrt{29}}{\\sqrt{517}} & \\frac{16}{\\sqrt{517}} \\end{pmatrix}\n$$\n\n**Step 3: Compute the $(2,3)$ entry of $R = G_2 A'$**\n\nThe final upper triangular matrix is $R = G_2 A'$. We are asked for the entry $R_{23}$. This entry is the dot product of the second row of $G_2$ and the third column of $A'$.\n$$\nR_{23} = (G_2)_{21}A'_{13} + (G_2)_{22}A'_{23} + (G_2)_{23}A'_{33}\n$$\nSubstituting the values:\n$$\nR_{23} = (0)A'_{13} + (c_2)A'_{23} + (-s_2)A'_{33} = c_2 A'_{23} - s_2 A'_{33}\n$$\nWe have $A'_{23} = \\frac{15}{\\sqrt{29}}$ and $A'_{33} = 1$. Substituting the values of $c_2$ and $s_2$:\n$$\nR_{23} = \\left(\\frac{16}{\\sqrt{517}}\\right) \\left(\\frac{15}{\\sqrt{29}}\\right) - \\left(\\frac{-3\\sqrt{29}}{\\sqrt{517}}\\right) (1)\n$$\n$$\nR_{23} = \\frac{16 \\cdot 15}{\\sqrt{517}\\sqrt{29}} + \\frac{3\\sqrt{29}}{\\sqrt{517}}\n$$\nTo combine these terms, we find a common denominator, which is $\\sqrt{517}\\sqrt{29} = \\sqrt{517 \\cdot 29} = \\sqrt{14993}$.\n$$\nR_{23} = \\frac{240}{\\sqrt{14993}} + \\frac{3\\sqrt{29} \\cdot \\sqrt{29}}{\\sqrt{517}\\sqrt{29}} = \\frac{240}{\\sqrt{14993}} + \\frac{3 \\cdot 29}{\\sqrt{14993}}\n$$\n$$\nR_{23} = \\frac{240 + 87}{\\sqrt{14993}} = \\frac{327}{\\sqrt{14993}}\n$$\n\nAs a verification, we confirm that $R_{32}$ is zero. This entry is computed from the third row of $G_2$ and the second column of $A'$.\n$$\nR_{32} = s_2 A'_{22} + c_2 A'_{32} = \\left(\\frac{-3\\sqrt{29}}{\\sqrt{517}}\\right)\\left(\\frac{16}{\\sqrt{29}}\\right) + \\left(\\frac{16}{\\sqrt{517}}\\right)(3) = \\frac{-48}{\\sqrt{517}} + \\frac{48}{\\sqrt{517}} = 0\n$$\nThis confirms that $R$ is indeed an upper triangular matrix. The final derived value for $R_{23}$ is analytically exact and based on first principles.", "answer": "$$\\boxed{\\frac{327}{\\sqrt{14993}}}$$", "id": "3597852"}, {"introduction": "While a direct QR factorization is instructive, the practical power of the algorithm lies in the implicit shifted QR step. This ingenious technique applies the equivalent of a shifted QR transformation without ever destroying the valuable tridiagonal structure, a process often visualized as creating and \"chasing\" a bulge down the matrix diagonal. This exercise gives you hands-on experience with the first critical moves in this bulge-chasing dance, building intuition for the algorithm's efficiency and elegance.", "problem": "Consider the symmetric tridiagonal matrix $T \\in \\mathbb{R}^{5 \\times 5}$ with diagonal entries $a_1=6$, $a_2=5$, $a_3=4$, $a_4=5$, $a_5=6$ and off-diagonal entries $b_1=1$, $b_2=2$, $b_3=2$, $b_4=1$, that is,\n$$\nT \\;=\\;\n\\begin{pmatrix}\n6 & 1 & 0 & 0 & 0 \\\\\n1 & 5 & 2 & 0 & 0 \\\\\n0 & 2 & 4 & 2 & 0 \\\\\n0 & 0 & 2 & 5 & 1 \\\\\n0 & 0 & 0 & 1 & 6\n\\end{pmatrix}.\n$$\nPerform the first two bulge-chasing Givens rotations of one implicit shifted orthogonal-triangular (QR) step with the shift $\\mu=5$ as follows:\n\n1. Construct a Givens rotation $G_1$ acting on indices $(1,2)$ so that $G_1^{\\top} (T - \\mu I) e_1$ is a scalar multiple of $e_1$, and update $T^{(1)} = G_1^{\\top} T G_1$.\n\n2. Then construct a Givens rotation $G_2$ acting on indices $(2,3)$ so that premultiplication by $G_2^{\\top}$ annihilates the $(3,1)$ entry of $T^{(1)}$, and update $T^{(2)} = G_2^{\\top} T^{(1)} G_2$.\n\nStarting only from the definitions of orthogonal similarity, Givens rotations, and the implicit shift construction, carry out these two rotations explicitly and compute the updated tridiagonal entries that are affected in the leading $3 \\times 3$ block. Report the single real value of the updated off-diagonal entry between rows $2$ and $3$ after these two rotations, namely $b_2^{(2)} = T^{(2)}_{2,3}$. Give your answer in exact, closed form. Do not round.", "solution": "The process consists of two stages of similarity transformations using Givens rotations.\n\n**Stage 1: First Givens rotation to create the bulge**\n\nThe first step of an implicit QR iteration with shift $\\mu$ is to determine the Givens rotation $G_1$ that would introduce a zero in the first column of the shifted matrix $T - \\mu I$. The first column of $T - \\mu I$ is:\n$$\nx = (T - \\mu I)e_1 = \\begin{pmatrix} 6-5 \\\\ 1 \\\\ 0 \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ \\vdots \\end{pmatrix}\n$$\nWe need to find a rotation $G_1$ acting on the $(1,2)$ plane such that $G_1^\\top x$ has a zero in its second component. The rotation matrix $G_1^\\top$ will have the form $\\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix}$ in the relevant block. To zero out the second component of $x=(1,1)^{\\top}$, we set $c = \\frac{x_1}{r}$ and $s = \\frac{x_2}{r}$, where $r = \\sqrt{x_1^2 + x_2^2}$. With $x_1=1$ and $x_2=1$:\n$r = \\sqrt{1^2 + 1^2} = \\sqrt{2}$, so $c = \\frac{1}{\\sqrt{2}}$ and $s = \\frac{1}{\\sqrt{2}}$.\nThe condition to zero the second component is $-s \\cdot x_1 + c \\cdot x_2 = 0$, which is satisfied by this choice of $c$ and $s$.\n\nThe implicit QR method applies this rotation to the unshifted matrix $T$ as a similarity transformation: $T^{(1)} = G_1^{\\top} T G_1$. This transformation only affects rows and columns 1 and 2, but it creates a non-zero entry at position $(1,3)$ and, by symmetry, at $(3,1)$. This is the \"bulge\". Let's compute the relevant entries of the leading $3 \\times 3$ block of $T^{(1)}$:\n$$\nT^{(1)}_{1:3,1:3} = \\begin{pmatrix} c & s & 0 \\\\ -s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 6 & 1 & 0 \\\\ 1 & 5 & 2 \\\\ 0 & 2 & 4 \\end{pmatrix} \\begin{pmatrix} c & -s & 0 \\\\ s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe entries of the updated matrix are:\n$T^{(1)}_{21} = -s(c \\cdot 6 + s \\cdot 1) + c(-s \\cdot 1 + c \\cdot 5) = (c^2-s^2) T_{12} -cs(T_{11}-T_{22}) = (0)(1) - \\frac{1}{2}(6-5) = -1/2$.\n$T^{(1)}_{31} = (G_1^\\top T G_1)_{31} = (T G_1)_{31} = T_{31}c + T_{32}s = 0 \\cdot c + 2 \\cdot s = \\sqrt{2}$. This is the bulge.\n$T^{(1)}_{22} = s^2 T_{11} + c^2 T_{22} - 2cs T_{12} = \\frac{1}{2}(6) + \\frac{1}{2}(5) - 2(\\frac{1}{2})(1) = 3 + 2.5 - 1 = 4.5 = 9/2$.\n$T^{(1)}_{33} = T_{33} = 4$.\n$T^{(1)}_{23} = (-s) T_{13} + c T_{23} = (-1/\\sqrt{2})(0) + (1/\\sqrt{2})(2) = \\sqrt{2}$.\n\n**Stage 2: Second Givens rotation to chase the bulge**\n\nThe next step is to eliminate the bulge at $T^{(1)}_{31} = \\sqrt{2}$ by applying a rotation $G_2$ on the $(2,3)$ plane. The rotation is chosen to annihilate the $(3,1)$ entry based on the current first column of $T^{(1)}$, which has elements $T^{(1)}_{21}=-1/2$ and $T^{(1)}_{31}=\\sqrt{2}$.\nLet the new rotation parameters be $c'$ and $s'$. We need to rotate the vector $(-1/2, \\sqrt{2})^\\top$ to have a zero in its second component.\n$x'_2 = -1/2$ and $x'_3 = \\sqrt{2}$.\n$r' = \\sqrt{(x'_2)^2 + (x'_3)^2} = \\sqrt{(-\\frac{1}{2})^2 + (\\sqrt{2})^2} = \\sqrt{\\frac{1}{4} + 2} = \\sqrt{\\frac{9}{4}} = \\frac{3}{2}$.\nThe parameters for the rotation $G_2^\\top$ are:\n$c' = \\frac{x'_2}{r'} = \\frac{-1/2}{3/2} = -\\frac{1}{3}$.\n$s' = \\frac{x'_3}{r'} = \\frac{\\sqrt{2}}{3/2} = \\frac{2\\sqrt{2}}{3}$.\n\nNow we compute $T^{(2)} = G_2^{\\top} T^{(1)} G_2$. We are interested in the entry $T^{(2)}_{2,3}$. This is found by applying the similarity transformation to the submatrix $T^{(1)}_{2:3, 2:3}$.\nLet $A = T^{(1)}_{2:3, 2:3} = \\begin{pmatrix} T^{(1)}_{22} & T^{(1)}_{23} \\\\ T^{(1)}_{32} & T^{(1)}_{33} \\end{pmatrix} = \\begin{pmatrix} 9/2 & \\sqrt{2} \\\\ \\sqrt{2} & 4 \\end{pmatrix}$.\nThe updated off-diagonal entry $T^{(2)}_{2,3}$ is given by the formula for a $2 \\times 2$ similarity transformation:\n$T^{(2)}_{2,3} = (c'^2 - s'^2)A_{12} + c's'(A_{22} - A_{11})$.\nWe have the values:\n$c' = -1/3 \\implies c'^2 = 1/9$.\n$s' = 2\\sqrt{2}/3 \\implies s'^2 = 8/9$.\n$A_{11} = T^{(1)}_{22} = 9/2$, $A_{12} = T^{(1)}_{23} = \\sqrt{2}$, $A_{22} = T^{(1)}_{33} = 4$.\n\nSubstituting these into the formula:\n$T^{(2)}_{2,3} = \\left(\\frac{1}{9} - \\frac{8}{9}\\right)(\\sqrt{2}) + \\left(-\\frac{1}{3}\\right)\\left(\\frac{2\\sqrt{2}}{3}\\right)\\left(4 - \\frac{9}{2}\\right)$\n$T^{(2)}_{2,3} = \\left(-\\frac{7}{9}\\right)(\\sqrt{2}) + \\left(-\\frac{2\\sqrt{2}}{9}\\right)\\left(-\\frac{1}{2}\\right)$\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\frac{\\sqrt{2}}{9}$\n$T^{(2)}_{2,3} = -\\frac{6\\sqrt{2}}{9} = -\\frac{2\\sqrt{2}}{3}$.\n\nThe value of the updated off-diagonal entry $b_2^{(2)}$ is $T^{(2)}_{2,3}$.", "answer": "$$\n\\boxed{-\\frac{2\\sqrt{2}}{3}}\n$$", "id": "3597848"}, {"introduction": "An iterative algorithm would be useless without a reliable stopping condition. In the symmetric QR algorithm, this is achieved through deflation, a process that splits the matrix once an eigenvalue has been sufficiently isolated. This practice explores the crucial question of when a subdiagonal entry is \"small enough\" to be considered zero, analyzing the standard deflation criterion from a backward error perspective and connecting the abstract algorithm to the realities of floating-point arithmetic.", "problem": "Consider the symmetric tridiagonal matrix $T \\in \\mathbb{R}^{5 \\times 5}$,\n$$\nT \\;=\\;\n\\begin{pmatrix}\n4 & 0.8 & 0 & 0 & 0 \\\\\n0.8 & 6 & 0.3 & 0 & 0 \\\\\n0 & 0.3 & 5 & 0.4 & 0 \\\\\n0 & 0 & 0.4 & 7 & 1.0 \\times 10^{-16} \\\\\n0 & 0 & 0 & 1.0 \\times 10^{-16} & 9\n\\end{pmatrix}.\n$$\nA single step of the orthogonal-triangular (QR) algorithm with a Wilkinson shift applied to a symmetric tridiagonal matrix performs an orthogonal similarity transformation that preserves symmetry and tridiagonal structure. In floating-point arithmetic following the standard rounding model $\\operatorname{fl}(x \\,\\circ\\, y) = (x \\,\\circ\\, y)(1 + \\delta)$ with $|\\delta| \\leq u$ (where $u$ is the unit roundoff), the computed step is backward stable in the sense that it is exact for a slightly perturbed matrix. Assume the machine model is Institute of Electrical and Electronics Engineers (IEEE) double precision with unit roundoff $u = 2^{-53}$.\n\nStarting from the backward error viewpoint for orthogonal similarity transformations on symmetric tridiagonals and the invariance of eigenvalues under orthogonal similarity, derive a practically justified deflation test for a subdiagonal entry $b_{k}$ at index $k$ that ensures any enforced zero $b_{k} \\leftarrow 0$ is within the backward error of a computed QR step. Apply your derived test to the trailing subdiagonal entry of $T$ and decide whether deflation should be performed at that index. If deflation is performed, write down the resulting block diagonal structure that will be used in subsequent iterations. Your final reported quantity must be the deflation index $k$ where the split occurs. If no deflation is warranted, report $k = 0$.\n\nProvide your final answer as a single integer. No rounding is required. No physical units are involved.", "solution": "Let $T$ be a symmetric tridiagonal matrix of size $n \\times n$ with diagonal entries $a_1, \\dots, a_n$ and subdiagonal entries $b_1, \\dots, b_{n-1}$.\n$$\nT \\;=\\;\n\\begin{pmatrix}\na_1 & b_1 & & & \\\\\nb_1 & a_2 & b_2 & & \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & b_{n-2} & a_{n-1} & b_{n-1} \\\\\n& & & b_{n-1} & a_n\n\\end{pmatrix}\n$$\nThe core principle of the QR algorithm is to generate a sequence of orthogonally similar matrices. Deflation is the process of setting a sufficiently small subdiagonal entry $b_k$ to zero. This is justified from a backward error perspective. Setting $b_k$ to zero introduces a perturbation $\\Delta T_k$ to the matrix $T$, where the only non-zero entries are $(\\Delta T_k)_{k, k+1} = (\\Delta T_k)_{k+1, k} = -b_k$. The error introduced in the eigenvalues is bounded by the norm of this perturbation, $\\|\\Delta T_k\\|_2 = |b_k|$.\n\nThis perturbation is acceptable if it is on the same order of magnitude as the inherent uncertainty in the matrix entries due to round-off errors. A practical and widely used deflation criterion is to declare $b_k$ negligible if its magnitude is on the order of the machine precision relative to the magnitudes of its adjacent diagonal entries. This ensures that the effect of zeroing out $b_k$ is \"lost in the noise\" of the floating-point representation of the diagonal elements. The test is:\n$$|b_k| \\le u (|a_k| + |a_{k+1}|)$$\nwhere $u$ is the unit roundoff. If this condition holds, we can set $b_k \\leftarrow 0$ without introducing an error larger than the backward error inherent in one step of the QR algorithm.\n\nNow, we apply this test to the given matrix $T$. The problem asks to test the trailing subdiagonal entry, which is $b_4$. We set $k=4$. The relevant entries are:\n$b_4 = 1.0 \\times 10^{-16}$\n$a_4 = 7$\n$a_5 = 9$\nThe unit roundoff is given as $u = 2^{-53}$.\n\nWe substitute these values into the deflation inequality:\n$$|b_4| \\le u (|a_4| + |a_5|)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} (|7| + |9|)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} (16)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} \\cdot 2^4$$\n$$1.0 \\times 10^{-16} \\le 2^{-49}$$\nTo verify this inequality, we can approximate the values. We know $2^{10} = 1024 \\approx 10^3$.\nThen $2^{-49} = 2 \\cdot 2^{-50} = 2 \\cdot (2^{10})^{-5} \\approx 2 \\cdot (10^3)^{-5} = 2 \\times 10^{-15}$.\nThe inequality becomes $1.0 \\times 10^{-16} \\le 2 \\times 10^{-15}$, which is true.\nAlternatively, we can compare the base-10 logarithms:\n$\\log_{10}(1.0 \\times 10^{-16}) = -16$.\n$\\log_{10}(2^{-49}) = -49 \\log_{10}(2) \\approx -49 \\times 0.30103 = -14.75047$.\nThe inequality $-16 \\le -14.75047$ is true.\n\nTherefore, the deflation condition is satisfied for $b_4$. Deflation should be performed by setting $b_4$ to $0$. The matrix $T$ is split between the $4$-th and $5$-th rows and columns. The index at which the split occurs is $k=4$.\n\nThe resulting block diagonal matrix would be:\n$$\nT' \\;=\\;\n\\begin{pmatrix}\n4 & 0.8 & 0 & 0 & 0 \\\\\n0.8 & 6 & 0.3 & 0 & 0 \\\\\n0 & 0.3 & 5 & 0.4 & 0 \\\\\n0 & 0 & 0.4 & 7 & 0 \\\\\n0 & 0 & 0 & 0 & 9\n\\end{pmatrix}\n$$\nThe problem is now split into finding the eigenvalues of the leading $4 \\times 4$ submatrix and the trailing $1 \\times 1$ submatrix. The latter immediately yields an eigenvalue of $\\lambda=9$. The algorithm would then proceed on the $4 \\times 4$ subproblem.\n\nThe deflation index $k$ where the split occurs is the index of the subdiagonal entry being set to zero. In this case, $k=4$.", "answer": "$$\\boxed{4}$$", "id": "3597821"}]}