{"hands_on_practices": [{"introduction": "Galerkin orthogonality is not an incidental property but a direct consequence of a consistent numerical formulation. For Discontinuous Galerkin (DG) methods, ensuring consistency across element interfaces requires a careful design of the numerical flux and penalty terms. This exercise [@problem_id:3388538] provides a hands-on opportunity to dissect the symmetric Interior Penalty DG (IPDG) bilinear form and uncover the elegant cancellation mechanism that ensures the method is consistent, thereby establishing the foundation for Galerkin orthogonality.", "problem": "Consider the one-dimensional second-order elliptic model problem on the interval $\\Omega = (0,1)$ with a piecewise constant diffusion coefficient $k(x)$,\n$$\n- \\left(k(x)\\,u'(x)\\right)' = f(x) \\quad \\text{in } \\Omega,\n$$\nand Dirichlet boundary conditions $u(0) = g_{0}$ and $u(1) = g_{1}$, where $f \\in L^{2}(\\Omega)$ and $g_{0}, g_{1} \\in \\mathbb{R}$. Let the mesh consist of two elements $K_{1} = (0,x_{\\star})$ and $K_{2} = (x_{\\star},1)$ with a single interior interface (face) $\\Gamma = \\{x_{\\star}\\}$, and suppose the outward unit normals at $x_{\\star}$ relative to $K_{1}$ and $K_{2}$ are $n_{1} = +1$ and $n_{2} = -1$, respectively. Assume $k(x) = k^{-} > 0$ on $K_{1}$ and $k(x) = k^{+} > 0$ on $K_{2}$.\n\nLet $V_{h}$ be a discontinuous polynomial space on this mesh, and let $u_{h} \\in V_{h}$ be the discrete solution obtained by the symmetric Interior Penalty Discontinuous Galerkin (IPDG) method. The symmetric IPDG bilinear form $a_{h}(\\cdot,\\cdot)$ is defined, for $w,v \\in V_{h}$, by\n$$\na_{h}(w,v) := \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,w'(x)\\,v'(x)\\,\\mathrm{d}x \n\\;-\\; \\int_{\\Gamma} \\big\\{k\\,w'\\big\\}\\,[v]\\,\\mathrm{d}s \n\\;-\\; \\int_{\\Gamma} \\big\\{k\\,v'\\big\\}\\,[w]\\,\\mathrm{d}s \n\\;+\\; \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[w]\\,[v]\\,\\mathrm{d}s,\n$$\nwhere $\\eta > 0$ is the penalty parameter, $h_{\\Gamma} > 0$ is a characteristic length associated with $\\Gamma$, and the standard jump and average operators at $\\Gamma$ are\n$$\n[w] := w^{-} n_{1} + w^{+} n_{2} = w^{-} - w^{+}, \n\\qquad \n\\{q\\} := \\frac{1}{2}\\left(q^{-} + q^{+}\\right),\n$$\nwith $q^{-}$ and $q^{+}$ denoting the traces from $K_{1}$ and $K_{2}$, respectively. Assume the numerical boundary treatment is consistent with the Dirichlet boundary conditions so that the method is consistent for smooth exact solutions.\n\nDefine the error $e := u - u_{h}$ and let $v_{h} \\in V_{h}$ be arbitrary. Your tasks are:\n\n1. Starting from the exact solution $u$ and the elementwise integration-by-parts identity\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,u'\\,v_{h}'\\,\\mathrm{d}x \n= - \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} (k\\,u')'\\,v_{h}\\,\\mathrm{d}x \n+ \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s,\n$$\nderive the explicit interface contribution at $\\Gamma$ and express it using $\\{k\\,u'\\}$, $[v_{h}]$, $\\{v_{h}\\}$, and $[k\\,u']$. Use only the definitions above and do not assume any special structure of $v_{h}$.\n\n2. Write the explicit interior-face part of $a_{h}(u - u_{h}, v_{h})$ at $\\Gamma$ using the symmetric IPDG form and simplify it using the regularity properties of the exact solution $u$, namely $[u] = 0$ and $[k\\,u'] = 0$ at $\\Gamma$.\n\n3. Identify the cancellation mechanisms between the interface term obtained in step 1 and the corresponding terms in the IPDG bilinear form for $u$ that follow from consistency. Conclude the net interior interface contribution to $a_{h}(u - u_{h}, v_{h})$ at $\\Gamma$.\n\nReport the final value of the net interior interface contribution to $a_{h}(u - u_{h}, v_{h})$ at $\\Gamma$ as a single real number. No rounding is needed.", "solution": "The problem is evaluated to be **valid**. It is a well-posed theoretical question in the field of numerical analysis for partial differential equations, specifically concerning the consistency of the symmetric Interior Penalty Discontinuous Galerkin (IPDG) method. All terms and concepts are formally defined, and the problem is grounded in established mathematical principles.\n\nThe core of the problem is to determine the net contribution of the interior interface terms to the Galerkin orthogonality relation for the error $e := u - u_h$. The Galerkin orthogonality relation for a consistent method is $a_h(e, v_h) = 0$ for all test functions $v_h \\in V_h$. This relation arises from the consistency of the scheme, which states that the exact solution $u$ satisfies the discrete equation, i.e., $a_h(u, v_h) = L_h(v_h)$, where $L_h(v_h)$ is the discrete load vector. Since the numerical solution $u_h$ by definition satisfies $a_h(u_h, v_h) = L_h(v_h)$, subtracting these two equations yields $a_h(u, v_h) - a_h(u_h, v_h) = 0$, which is $a_h(u - u_h, v_h) = 0$.\n\nThe \"net interior interface contribution\" is interpreted as the interface part of the consistency error, $a_h(u, v_h) - L_h(v_h)$. We will compute this quantity by following the three steps prescribed in the problem. For notational simplicity, since the interface $\\Gamma$ consists of a single point, integrals of the form $\\int_{\\Gamma} \\phi \\, \\mathrm{d}s$ correspond to the evaluation of the function $\\phi$ at the point $x_{\\star}$.\n\n### Step 1: Interface Contribution from the Weak Form\n\nWe start with the provided elementwise integration-by-parts identity for the exact solution $u$:\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,u'\\,v_{h}'\\,\\mathrm{d}x = - \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} (k\\,u')'\\,v_{h}\\,\\mathrm{d}x + \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s.\n$$\nSince $u$ is the exact solution to $-\\left(k(x)\\,u'(x)\\right)' = f(x)$, the first term on the right-hand side is $\\sum_{K} \\int_{K} f\\,v_{h}\\,\\mathrm{d}x$. We focus on the second term, which contains the boundary and interface contributions. The domain of integration is $\\cup_{K} \\partial K = \\{0\\} \\cup \\{x_{\\star}\\} \\cup \\{x_{\\star}\\} \\cup \\{1\\}$. The problem asks for the contribution at the interior interface $\\Gamma = \\{x_{\\star}\\}$.\n\nThe sum over the element boundaries can be written as:\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s = \\int_{\\partial K_{1}} n_{K_{1}}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s + \\int_{\\partial K_{2}} n_{K_{2}}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s.\n$$\nFor element $K_1=(0, x_\\star)$, the boundary is $\\partial K_1 = \\{0, x_\\star\\}$. The outward normal at $x=0$ is $-1$, and at $x=x_\\star$ it is $n_1=+1$.\nFor element $K_2=(x_\\star, 1)$, the boundary is $\\partial K_2 = \\{x_\\star, 1\\}$. The outward normal at $x=x_\\star$ is $n_2=-1$, and at $x=1$ it is $+1$.\n\nThe contribution from the interior interface $\\Gamma=\\{x_\\star\\}$ is the sum of the evaluations from both elements at this point:\n$$\n(n_{K_{1}}\\,k\\,u'\\,v_{h})|_{x=x_{\\star}} + (n_{K_{2}}\\,k\\,u'\\,v_{h})|_{x=x_{\\star}} = (+1)\\,(k\\,u')^{-}\\,v_{h}^{-} + (-1)\\,(k\\,u')^{+}\\,v_{h}^{+}.\n$$\nThis expression is $(k\\,u')^{-}v_{h}^{-} - (k\\,u')^{+}v_{h}^{+}$. To express this in terms of jump and average operators, we use the identities relating traces to averages and jumps:\nFor a function $w$, $w^{-} = \\{w\\} + \\frac{1}{2}[w]$ and $w^{+} = \\{w\\} - \\frac{1}{2}[w]$.\nFor a flux-like quantity $q$, with jump $[q] = q^- n_1 + q^+ n_2 = q^- - q^+$, we have $q^{-} = \\{q\\} + \\frac{1}{2}[q]$ and $q^{+} = \\{q\\} - \\frac{1}{2}[q]$.\n\nLet $q=k u'$. The interface contribution becomes:\n$$\nq^{-}v_{h}^{-} - q^{+}v_{h}^{+} = \\left(\\{q\\} + \\frac{1}{2}[q]\\right)\\left(\\{v_h\\} + \\frac{1}{2}[v_h]\\right) - \\left(\\{q\\} - \\frac{1}{2}[q]\\right)\\left(\\{v_h\\} - \\frac{1}{2}[v_h]\\right)\n$$\n$$\n= \\left( \\{q\\}\\{v_h\\} + \\frac{1}{2}\\{q\\}[v_h] + \\frac{1}{2}[q]\\{v_h\\} + \\frac{1}{4}[q][v_h] \\right) - \\left( \\{q\\}\\{v_h\\} - \\frac{1}{2}\\{q\\}[v_h] - \\frac{1}{2}[q]\\{v_h\\} + \\frac{1}{4}[q][v_h] \\right)\n$$\n$$\n= \\{q\\}[v_h] + [q]\\{v_h\\}.\n$$\nSubstituting $q=k\\,u'$, the interface contribution from the weak form is $\\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\}$.\n\n### Step 2: Interface Contribution from the IPDG Form\n\nThe interior-face part of the IPDG bilinear form $a_{h}(w,v)$ is given by:\n$$\nI(w,v) := - \\int_{\\Gamma} \\{k\\,w'\\}\\,[v]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v'\\}\\,[w]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[w]\\,[v]\\,\\mathrm{d}s.\n$$\nTo analyze consistency, we evaluate this for the exact solution $u$ and an arbitrary test function $v_h \\in V_h$:\n$$\nI(u,v_h) = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v_h'\\}\\,[u]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_h]\\,\\mathrm{d}s.\n$$\nThe problem provides the regularity properties of the exact solution $u$: its trace is continuous across the interface ($[u] = 0$), and the flux is also continuous ($[k\\,u'] = 0$).\n\nUsing $[u]=0$ at $\\Gamma$, the second and third terms in $I(u,v_h)$ vanish:\n$$\nI(u,v_h) = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s - 0 + 0 = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s.\n$$\nThe problem asks for the interior-face part of $a_{h}(u - u_{h}, v_{h})$, which is $I(u-u_h, v_h) = I(e,v_h)$. By linearity of the operators, this is:\n$$\nI(e,v_h) = - \\int_{\\Gamma} \\{k\\,e'\\}\\,[v_{h}]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v_{h}'\\}\\,[e]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[e]\\,[v_{h}]\\,\\mathrm{d}s.\n$$\n\n### Step 3: Cancellation and Net Contribution\n\nThe consistency error is the residual obtained when the exact solution is inserted into the discrete scheme: $a_h(u,v_h) - L_h(v_h)$. The contribution to this error from the interior interface is the sum of the interface terms that appear in the derivation. This consists of the terms from the weak formulation (Step 1) and the terms from the DG bilinear form (Step 2).\n\nFrom Step 1, the integration by parts of the term $\\int_K k u' v_h' \\mathrm{d}x$ produces an interface term of $+\\left( \\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\} \\right)$.\nFrom Step 2, the interface terms defined in the bilinear form $a_h(u, v_h)$ are $- \\{k\\,u'\\}\\,[v_{h}] - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}]$.\n\nThe net interface contribution to the consistency error is the sum of these parts:\n$$\n\\text{Net Contribution} = \\left( \\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\} \\right) + \\left( -\\{k\\,u'\\}\\,[v_{h}] - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}] \\right).\n$$\nThe term $\\{k\\,u'\\}\\,[v_{h}]$ cancels out. This is the \"cancellation mechanism\" which is fundamental to the design of symmetric DG methods. The remaining terms are:\n$$\n\\text{Net Contribution} = [k\\,u']\\{v_{h}\\} - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}].\n$$\nNow, we apply the regularity properties of the exact solution $u$ at the interface $\\Gamma$:\n1. $[u] = 0$ (continuity of the solution)\n2. $[k\\,u'] = 0$ (continuity of the flux)\n\nSubstituting these into the expression for the net contribution:\n$$\n\\text{Net Contribution} = (0)\\cdot\\{v_{h}\\} - \\{k\\,v_{h}'\\}\\cdot(0) + \\frac{\\eta}{h_{\\Gamma}}\\cdot(0)\\cdot[v_{h}] = 0 - 0 + 0 = 0.\n$$\nThe net contribution from the interior interface to the consistency error $a_h(u, v_h) - L_h(v_h)$, and thus to the Galerkin orthogonality expression $a_h(u-u_h, v_h)$, is zero. This demonstrates that the IPDG formulation is consistent at the interior faces for sufficiently regular solutions.\n\nThe final value of the net interior interface contribution to $a_{h}(u - u_{h}, v_{h})$ at $\\Gamma$ is therefore $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "3388538"}, {"introduction": "While theoretical formulations are often designed for exact orthogonality, real-world implementations rely on numerical quadrature to evaluate integrals, which can introduce errors. The principle of Galerkin orthogonality, $a(u-u_h, v_h)=0$, is only guaranteed if the bilinear form $a(\\cdot, \\cdot)$ is computed exactly. This problem [@problem_id:3388522] demonstrates the practical consequences of violating this condition through \"under-integration,\" where the quadrature rule is not accurate enough for the integrand, leading to a quantifiable loss of orthogonality and a degradation of the solution's accuracy.", "problem": "Consider the one-dimensional reference element $\\Omega = [-1,1]$ and the variable-coefficient diffusion operator defined by the bilinear form\n$$\na(u,v) := \\int_{-1}^{1} a(x)\\, u'(x)\\, v'(x)\\, dx,\n$$\nwith $a(x) = 1 + x^{2}$. Let the approximation space be the nodal polynomial space of degree $p=2$ spanned by Lagrange basis functions associated with the Gauss–Lobatto–Legendre (GLL) nodes. For $p=2$ on $\\Omega$, the GLL nodes are at $x_{0}=-1$, $x_{1}=0$, and $x_{2}=1$, with corresponding GLL quadrature weights $w_{0} = \\tfrac{1}{3}$, $w_{1} = \\tfrac{4}{3}$, and $w_{2} = \\tfrac{1}{3}$. The GLL quadrature with $N$ nodes is exact for polynomials of degree at most $2N-3$.\n\nDefine the discrete stiffness bilinear form assembled with $p=2$ GLL quadrature by\n$$\na_{h}(u,v) := \\sum_{i=0}^{2} w_{i}\\, a(x_{i})\\, u'(x_{i})\\, v'(x_{i}).\n$$\n\nLet the continuous right-hand side functional be assembled exactly as $l(v) := a(u,v)$, so that the exact solution $u$ satisfies $a(u,v)=l(v)$ for all admissible $v$. Consider the specific choices\n$$\nu(x) = x^{3}, \\qquad v_{h}(x) = \\phi_{+1}(x) := \\frac{x(x+1)}{2},\n$$\nwhere $v_{h}$ is the Lagrange nodal basis function associated with the right endpoint node $x=1$.\n\nThe consistency defect that drives the loss of Galerkin orthogonality under underintegration is the residual obtained by testing the exact solution in the underintegrated discrete form,\n$$\nr_{h}(v_{h}) := l(v_{h}) - a_{h}(u, v_{h}) = a(u, v_{h}) - a_{h}(u, v_{h}).\n$$\n\nCompute the value of $r_{h}(v_{h})$ exactly. Your final answer must be a single real number. No rounding is required.", "solution": "The problem is valid. It is a well-posed computational problem within the standard framework of numerical methods for partial differential equations, specifically concerning the analysis of quadrature errors in Galerkin methods. All definitions and data are provided and are mathematically consistent.\n\nThe objective is to compute the consistency defect, $r_{h}(v_{h})$, defined as:\n$$\nr_{h}(v_{h}) := a(u, v_{h}) - a_{h}(u, v_{h})\n$$\nThis requires the computation of two terms: the continuous bilinear form $a(u, v_{h})$ and its discrete approximation $a_{h}(u, v_{h})$.\n\nFirst, we compute the continuous term, $a(u, v_{h})$.\nThe continuous bilinear form is given by:\n$$\na(u,v) = \\int_{-1}^{1} a(x)\\, u'(x)\\, v'(x)\\, dx\n$$\nWe are given the functions:\n- $u(x) = x^{3}$\n- $v_{h}(x) = \\frac{x(x+1)}{2} = \\frac{1}{2}x^{2} + \\frac{1}{2}x$\n- $a(x) = 1 + x^{2}$\n\nWe first find the derivatives of $u(x)$ and $v_{h}(x)$:\n$$\nu'(x) = \\frac{d}{dx}(x^{3}) = 3x^{2}\n$$\n$$\nv_{h}'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}x^{2} + \\frac{1}{2}x\\right) = x + \\frac{1}{2}\n$$\nNext, we form the integrand $a(x) u'(x) v_{h}'(x)$:\n$$\na(x) u'(x) v_{h}'(x) = (1 + x^{2})(3x^{2})\\left(x + \\frac{1}{2}\\right)\n$$\nExpanding this polynomial gives:\n$$\n(3x^{2} + 3x^{4})\\left(x + \\frac{1}{2}\\right) = 3x^{3} + \\frac{3}{2}x^{2} + 3x^{5} + \\frac{3}{2}x^{4}\n$$\nNow, we integrate this polynomial over the domain $\\Omega = [-1,1]$:\n$$\na(u, v_{h}) = \\int_{-1}^{1} \\left(3x^{5} + \\frac{3}{2}x^{4} + 3x^{3} + \\frac{3}{2}x^{2}\\right) dx\n$$\nThe integral of an odd function (like $x^{3}$ and $x^{5}$) over a symmetric interval $[-c, c]$ is zero. Therefore, the terms with odd powers vanish:\n$$\n\\int_{-1}^{1} 3x^{5}\\, dx = 0 \\quad \\text{and} \\quad \\int_{-1}^{1} 3x^{3}\\, dx = 0\n$$\nWe are left with the integral of the even-powered terms:\n$$\na(u, v_{h}) = \\int_{-1}^{1} \\left(\\frac{3}{2}x^{4} + \\frac{3}{2}x^{2}\\right) dx\n$$\nSince the integrand is an even function, we can simplify the integral:\n$$\na(u, v_{h}) = 2 \\int_{0}^{1} \\left(\\frac{3}{2}x^{4} + \\frac{3}{2}x^{2}\\right) dx = 3 \\int_{0}^{1} (x^{4} + x^{2})\\, dx\n$$\nEvaluating the integral:\n$$\na(u, v_{h}) = 3 \\left[ \\frac{x^{5}}{5} + \\frac{x^{3}}{3} \\right]_{0}^{1} = 3 \\left( \\left(\\frac{1^{5}}{5} + \\frac{1^{3}}{3}\\right) - 0 \\right) = 3 \\left( \\frac{1}{5} + \\frac{1}{3} \\right)\n$$\n$$\na(u, v_{h}) = 3 \\left( \\frac{3+5}{15} \\right) = 3 \\left( \\frac{8}{15} \\right) = \\frac{8}{5}\n$$\n\nSecond, we compute the discrete term, $a_{h}(u, v_{h})$, using Gauss–Lobatto–Legendre quadrature.\nThe discrete bilinear form is defined as:\n$$\na_{h}(u,v_{h}) = \\sum_{i=0}^{2} w_{i}\\, a(x_{i})\\, u'(x_{i})\\, v_{h}'(x_{i})\n$$\nThe GLL nodes are $x_{0}=-1$, $x_{1}=0$, $x_{2}=1$. The weights are $w_{0} = \\frac{1}{3}$, $w_{1} = \\frac{4}{3}$, $w_{2} = \\frac{1}{3}$.\n\nWe evaluate the components of the summand at each node:\n- At $x_{0} = -1$:\n  - $a(x_{0}) = 1 + (-1)^{2} = 2$\n  - $u'(x_{0}) = 3(-1)^{2} = 3$\n  - $v_{h}'(x_{0}) = -1 + \\frac{1}{2} = -\\frac{1}{2}$\n  - The term is $w_{0}\\, a(x_{0})\\, u'(x_{0})\\, v_{h}'(x_{0}) = \\frac{1}{3} (2) (3) \\left(-\\frac{1}{2}\\right) = -1$.\n\n- At $x_{1} = 0$:\n  - $a(x_{1}) = 1 + 0^{2} = 1$\n  - $u'(x_{1}) = 3(0)^{2} = 0$\n  - $v_{h}'(x_{1}) = 0 + \\frac{1}{2} = \\frac{1}{2}$\n  - The term is $w_{1}\\, a(x_{1})\\, u'(x_{1})\\, v_{h}'(x_{1}) = \\frac{4}{3} (1) (0) \\left(\\frac{1}{2}\\right) = 0$.\n\n- At $x_{2} = 1$:\n  - $a(x_{2}) = 1 + 1^{2} = 2$\n  - $u'(x_{2}) = 3(1)^{2} = 3$\n  - $v_{h}'(x_{2}) = 1 + \\frac{1}{2} = \\frac{3}{2}$\n  - The term is $w_{2}\\, a(x_{2})\\, u'(x_{2})\\, v_{h}'(x_{2}) = \\frac{1}{3} (2) (3) \\left(\\frac{3}{2}\\right) = 3$.\n\nSumming the three terms gives the value of $a_{h}(u, v_{h})$:\n$$\na_{h}(u, v_{h}) = -1 + 0 + 3 = 2\n$$\nThe problem states that the $p=2$ GLL quadrature, which has $N=p+1=3$ nodes, is exact for polynomials of degree at most $2N-3=2(3)-3=3$. The integrand is a polynomial of degree $5$, so the quadrature is not exact, which is the source of the consistency defect.\n\nFinally, we compute the consistency defect $r_{h}(v_{h})$:\n$$\nr_{h}(v_{h}) = a(u, v_{h}) - a_{h}(u, v_{h}) = \\frac{8}{5} - 2 = \\frac{8}{5} - \\frac{10}{5} = -\\frac{2}{5}\n$$", "answer": "$$\n\\boxed{-\\frac{2}{5}}\n$$", "id": "3388522"}, {"introduction": "The power of Galerkin orthogonality extends far beyond ensuring a \"best fit\" approximation; it is a cornerstone of modern a posteriori error estimation. The property that the error, $u-u_h$, is $a$-orthogonal to the entire test space $V_h$ allows for the derivation of exact error representations for specific quantities of interest. In this practice [@problem_id:3388529], you will use a dual problem to see how Galerkin orthogonality is the critical component that unlocks the ability to compute guaranteed, sharp bounds on the error in a functional output, a vital tool in adaptive meshing and verification.", "problem": "Consider the scalar diffusion model problem on the unit interval $[0,1]$: find $u \\in H_{0}^{1}(0,1)$ such that\n$$\na(u,v) = \\ell(v) \\quad \\text{for all } v \\in H_{0}^{1}(0,1),\n$$\nwhere the bilinear form is $a(w,v) := \\int_{0}^{1} w'(x)\\,v'(x)\\,dx$ and the linear form is $\\ell(v) := \\int_{0}^{1} f(x)\\,v(x)\\,dx$ with $f(x) \\equiv 2$. Let the goal functional be $J(v) := \\int_{0}^{1} v(x)\\,dx$. Let $V_{h}$ be the conforming subspace of $H_{0}^{1}(0,1)$ spanned by the single continuous, piecewise linear hat function $\\varphi$ associated with the mid-point $x=\\tfrac{1}{2}$ on the mesh $0 < \\tfrac{1}{2} < 1$. Let $u_{h}\\in V_{h}$ be the Galerkin approximation, so that $a(u_{h},v_{h})=\\ell(v_{h})$ for all $v_{h} \\in V_{h}$.\n\n1. Starting only from the weak formulation and the definition of the goal functional, formulate the dual problem: find $z \\in H_{0}^{1}(0,1)$ such that $a(v,z)=J(v)$ for all $v \\in H_{0}^{1}(0,1)$. Using Galerkin orthogonality, derive the error representation identity\n$$\nJ(u-u_{h}) \\;=\\; a(u-u_{h},\\,z-z_{h})\n$$\nfor any $z_{h} \\in V_{h}$.\n\n2. In one spatial dimension, define the dual flux $q_{z} := -z'$, which belongs to the space $H^{1}(0,1)$ and thus is $H(\\mathrm{div})$-conforming in one dimension. Construct the equilibrated dual flux reconstruction $\\widehat{q}_{z}$ by taking $\\widehat{q}_{z} := q_{z}$, and verify that it exactly satisfies local equilibration $\\frac{d}{dx}\\widehat{q}_{z} = 1$ in the strong sense. Show that the combination of the identity from part $1$ with an elementwise integration by parts leads to the guaranteed goal error bound that reduces to the exact identity\n$$\nJ(u-u_{h}) \\;=\\; \\int_{0}^{1} (u(x)-u_{h}(x))\\,\\frac{d}{dx}\\widehat{q}_{z}(x)\\,dx,\n$$\nand hence, with the equilibrated choice $\\widehat{q}_{z}=q_{z}$, to\n$$\nJ(u-u_{h}) \\;=\\; \\int_{0}^{1} (u(x)-u_{h}(x))\\,dx.\n$$\n\n3. Compute $u$ and $u_{h}$ explicitly for the given data $f(x)\\equiv 2$ and mesh. Then evaluate the guaranteed bound of part $2$, which is exact in this setting, to obtain a single real number for $J(u-u_{h})$. Express the final answer in exact form (no rounding required).", "solution": "The problem is subjected to validation and is found to be well-posed, scientifically grounded, and self-contained. All necessary definitions and data are provided for a unique solution to be determined.\n\nThe problem is divided into three parts. We will address each in sequence.\n\nPart 1: Derivation of the Error Representation Identity\n\nThe goal is to derive the identity $J(u-u_{h}) = a(u-u_{h}, z-z_{h})$ for any $z_{h} \\in V_{h}$.\n\nThe error in the goal functional is denoted by $J(u-u_{h})$. By the linearity of the functional $J$, we have $J(u-u_{h}) = J(u) - J(u_h)$, but this is not the path indicated. We start from the definition of the dual problem.\n\nThe dual problem is defined as finding $z \\in H_{0}^{1}(0,1)$ such that $a(v,z) = J(v)$ for all $v \\in H_{0}^{1}(0,1)$.\nLet the error in the primal solution be denoted by $e := u-u_h$. Since $u \\in H_{0}^{1}(0,1)$ and $u_h \\in V_h \\subset H_{0}^{1}(0,1)$, the error $e$ is also in $H_{0}^{1}(0,1)$.\nWe can therefore set $v=e=u-u_h$ in the definition of the dual problem:\n$$\nJ(u-u_{h}) = a(u-u_{h}, z)\n$$\nThis is the first step. Next, we introduce an arbitrary function $z_h$ from the discrete space $V_h$. Since $V_h$ is a subspace of $H_0^1(0,1)$, $z_h \\in H_0^1(0,1)$.\n\nGalerkin orthogonality is a property of the Galerkin approximation $u_h$. It states that the error $u-u_h$ is orthogonal to the subspace $V_h$ with respect to the bilinear form $a(\\cdot, \\cdot)$. Mathematically, this is expressed as:\n$$\na(u-u_h, v_h) = 0 \\quad \\text{for all } v_h \\in V_h\n$$\nThis is derived from subtracting the discrete weak form from the continuous one:\n$a(u,v_h) = \\ell(v_h)$ and $a(u_h, v_h) = \\ell(v_h)$. Subtracting gives $a(u,v_h) - a(u_h, v_h) = 0$, and by linearity of $a(\\cdot, \\cdot)$, $a(u-u_h, v_h) = 0$.\n\nSince $z_h$ is an arbitrary element of $V_h$, we can set $v_h = z_h$ in the Galerkin orthogonality condition to get:\n$$\na(u-u_h, z_h) = 0\n$$\nNow, we can subtract this null quantity from our expression for the goal error:\n$$\nJ(u-u_{h}) = a(u-u_{h}, z) - a(u-u_{h}, z_{h})\n$$\nUsing the linearity of the bilinear form $a(\\cdot, \\cdot)$ in its second argument, we can combine the terms on the right-hand side:\n$$\nJ(u-u_{h}) = a(u-u_{h}, z-z_{h})\n$$\nThis holds for any choice of $z_h \\in V_h$. This completes the derivation for the first part.\n\nPart 2: Dual Flux and Error Identity Simplification\n\nFirst, we solve the dual problem to find $z(x)$. The dual problem's weak form is $\\int_{0}^{1} v'(x)z'(x)dx = \\int_{0}^{1} v(x)dx$ for all $v \\in H_0^1(0,1)$. Assuming sufficient regularity for $z$, we can integrate by parts:\n$$\n\\int_{0}^{1} v'(x)z'(x)dx = [v(x)z'(x)]_{0}^{1} - \\int_{0}^{1} v(x)z''(x)dx\n$$\nSince $v \\in H_{0}^{1}(0,1)$, we have $v(0)=v(1)=0$, so the boundary term vanishes. The weak form becomes:\n$$\n-\\int_{0}^{1} v(x)z''(x)dx = \\int_{0}^{1} v(x) \\cdot 1 dx\n$$\nBy the fundamental lemma of the calculus of variations, this implies the strong form of the dual problem: $-z''(x)=1$ for $x \\in (0,1)$, with boundary conditions $z(0)=z(1)=0$.\nIntegrating twice gives $z(x) = -\\frac{x^2}{2} + C_1 x + C_2$.\nApplying the boundary conditions:\n$z(0) = C_2 = 0$.\n$z(1) = -\\frac{1}{2} + C_1 = 0 \\implies C_1 = \\frac{1}{2}$.\nThe exact dual solution is $z(x) = \\frac{x(1-x)}{2}$. This solution is in $H^2(0,1)$, justifying the integration by parts.\n\nThe dual flux is $q_z := -z'$. We compute $z'(x) = -x + \\frac{1}{2}$, so $q_z(x) = x - \\frac{1}{2}$. The problem defines the equilibrated dual flux reconstruction as $\\widehat{q}_z := q_z = x - \\frac{1}{2}$.\nWe verify the local equilibration condition:\n$$\n\\frac{d}{dx}\\widehat{q}_{z}(x) = \\frac{d}{dx}\\left(x - \\frac{1}{2}\\right) = 1\n$$\nThis holds in the strong sense for all $x \\in (0,1)$. The source term on the right hand side ($1$) corresponds to the distributed load in the dual problem, which originates from the definition of the functional $J(v) = \\int_0^1 1 \\cdot v(x) dx$.\n\nNow, we show that the identity from Part 1 leads to the specified integral form. We start with the identity $J(u-u_h) = a(u-u_h, z-z_h)$. From Part 1, we know that Galerkin orthogonality implies $a(u-u_h, z_h) = 0$. Therefore:\n$$\nJ(u-u_h) = a(u-u_h, z-z_h) = a(u-u_h, z) - a(u-u_h, z_h) = a(u-u_h, z)\n$$\nNow we use the definitions of $a(\\cdot,\\cdot)$ and the dual flux:\n$$\nJ(u-u_h) = \\int_{0}^{1} (u-u_h)'(x) z'(x) dx = \\int_{0}^{1} (u-u_h)'(x) (-q_z(x)) dx\n$$\nWith the choice $\\widehat{q}_z = q_z$, this becomes:\n$$\nJ(u-u_h) = -\\int_{0}^{1} (u-u_h)'(x) \\widehat{q}_z(x) dx\n$$\nWe integrate by parts. Let $e(x) = u(x)-u_h(x)$.\n$$\nJ(e) = - \\left( [e(x) \\widehat{q}_z(x)]_{0}^{1} - \\int_{0}^{1} e(x) \\frac{d}{dx}\\widehat{q}_z(x) dx \\right)\n$$\nSince $u, u_h \\in H_0^1(0,1)$, we have $e(0) = u(0)-u_h(0) = 0-0=0$ and $e(1)=u(1)-u_h(1)=0-0=0$. The boundary term $[e(x)\\widehat{q}_z(x)]_0^1$ is zero. This leaves:\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x)-u_h(x)) \\frac{d}{dx}\\widehat{q}_z(x) dx\n$$\nThis is the first identity we were asked to derive.\nFinally, using the equilibration property $\\frac{d}{dx}\\widehat{q}_z(x) = 1$, we substitute this into the identity:\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x)-u_h(x)) \\cdot 1 \\, dx\n$$\nThis final identity, while seemingly tautological because it is the definition of $J(u-u_h)$, has been rigorously derived from the error representation formula $J(u-u_h) = a(u-u_h, z-z_h)$, demonstrating the consistency of the theoretical framework.\n\nPart 3: Explicit Computation\n\nFirst, we compute the exact solution $u(x)$. The strong form of the primal problem is $-u''(x) = f(x) = 2$ on $(0,1)$ with $u(0)=u(1)=0$.\nA first integration gives $u'(x) = -2x + C_1$.\nA second integration gives $u(x) = -x^2 + C_1 x + C_2$.\nApplying the boundary conditions:\n$u(0) = C_2 = 0$.\n$u(1) = -1 + C_1 = 0 \\implies C_1 = 1$.\nThe exact solution is $u(x) = x - x^2$.\n\nNext, we compute the Galerkin approximation $u_h(x) \\in V_h$. The space $V_h$ is spanned by the single basis function $\\varphi(x)$, the piecewise linear hat function satisfying $\\varphi(\\frac{1}{2})=1$ and $\\varphi(0)=\\varphi(1)=0$. Its explicit form is:\n$$\n\\varphi(x) = \\begin{cases} 2x & \\text{if } 0 \\le x \\le 1/2 \\\\ 2(1-x) & \\text{if } 1/2 \\le x \\le 1 \\end{cases}\n$$\nThe solution $u_h(x)$ can be written as $u_h(x) = c_1 \\varphi(x)$ for some coefficient $c_1$. The Galerkin system is $a(u_h, \\varphi) = \\ell(\\varphi)$.\nSubstituting $u_h = c_1 \\varphi$:\n$c_1 a(\\varphi, \\varphi) = \\ell(\\varphi)$.\nWe compute the terms. The derivative of $\\varphi(x)$ is $\\varphi'(x) = 2$ for $x \\in (0, \\frac{1}{2})$ and $\\varphi'(x) = -2$ for $x \\in (\\frac{1}{2}, 1)$.\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} (\\varphi'(x))^2 dx = \\int_{0}^{1/2} 2^2 dx + \\int_{1/2}^{1} (-2)^2 dx = 4 \\cdot \\frac{1}{2} + 4 \\cdot \\frac{1}{2} = 4\n$$\n$$\n\\ell(\\varphi) = \\int_{0}^{1} f(x)\\varphi(x)dx = \\int_{0}^{1} 2 \\varphi(x) dx = 2 \\int_{0}^{1} \\varphi(x)dx\n$$\nThe integral $\\int_{0}^{1} \\varphi(x)dx$ is the area of a triangle with base $1$ and height $1$, which is $\\frac{1}{2}$.\nSo, $\\ell(\\varphi) = 2 \\cdot \\frac{1}{2} = 1$.\nThe equation for $c_1$ is $c_1 \\cdot 4 = 1$, which gives $c_1 = \\frac{1}{4}$.\nThe Galerkin approximation is $u_h(x) = \\frac{1}{4}\\varphi(x)$.\n\nFinally, we compute the value of the error in the goal functional, $J(u-u_h)$. Using the identity from Part 2, which is exact in this case:\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x) - u_h(x)) dx = \\int_{0}^{1} u(x) dx - \\int_{0}^{1} u_h(x) dx\n$$\nWe compute each integral:\n$$\n\\int_{0}^{1} u(x) dx = \\int_{0}^{1} (x - x^2) dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{3-2}{6} = \\frac{1}{6}\n$$\n$$\n\\int_{0}^{1} u_h(x)dx = \\int_{0}^{1} \\frac{1}{4}\\varphi(x)dx = \\frac{1}{4} \\int_{0}^{1} \\varphi(x)dx = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}\n$$\nThe value of the goal error is:\n$$\nJ(u-u_h) = \\frac{1}{6} - \\frac{1}{8} = \\frac{4}{24} - \\frac{3}{24} = \\frac{1}{24}\n$$\nThis is the final numerical result.", "answer": "$$\n\\boxed{\\frac{1}{24}}\n$$", "id": "3388529"}]}