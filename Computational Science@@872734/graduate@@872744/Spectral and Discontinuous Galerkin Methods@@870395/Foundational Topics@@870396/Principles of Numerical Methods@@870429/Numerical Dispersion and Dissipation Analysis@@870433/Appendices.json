{"hands_on_practices": [{"introduction": "To build accurate solvers for wave phenomena, we must understand the errors introduced by each component of the numerical method. This first exercise isolates the contribution of the time-stepping scheme by analyzing it on a simple model problem [@problem_id:3404837]. By applying Fourier analysis to the classical fourth-order Runge-Kutta method, you will practice the fundamental skill of deriving the leading-order temporal dispersion and dissipation errors, providing a quantitative measure of how the scheme impacts wave phase and amplitude.", "problem": "Consider a one-dimensional linear, constant-coefficient hyperbolic partial differential equation discretized in space by a high-order Spectral Discontinuous Galerkin (SDG) scheme on a periodic domain. For a single Fourier mode with wavenumber corresponding to a semi-discrete frequency $\\omega > 0$, the semi-discrete system for the modal amplitude reduces to the linear ordinary differential equation $\\frac{d y}{d t} = i \\omega y$, where $i$ is the imaginary unit. This purely imaginary semi-discrete eigenvalue reflects the non-dissipative character of the underlying spatial discretization for the considered mode.\n\nApply the classical explicit four-stage fourth-order Runge–Kutta (RK) method (RK4) with time step $\\Delta t$ to this semi-discrete system. Let $z = i \\omega \\Delta t$, and denote the one-step numerical amplification factor by $G(z)$. Define the temporal dissipation error as $\\left|G(z)\\right| - 1$ (i.e., the deviation of the amplification factor magnitude from unity), and define the temporal dispersion error as $\\Phi(z) - \\omega \\Delta t$, where $\\Phi(z) = \\arg(G(z))$ is the numerical phase advance per time step measured in radians.\n\nStarting from the definition of the RK4 method and the linear test equation $\\frac{d y}{d t} = \\lambda y$ with $\\lambda = i \\omega$, derive the leading-order terms in the small-parameter expansion in $\\xi = \\omega \\Delta t$ of both the temporal dispersion error and the temporal dissipation error for RK4. Show explicitly the order in $\\Delta t$ of each error.\n\nExpress your final answer as a row matrix whose first entry is the leading-order dispersion error per time step in radians, and whose second entry is the leading-order dissipation error per time step, both written as analytic functions of $\\omega$ and $\\Delta t$. No rounding is required.", "solution": "The problem statement is a well-posed and scientifically grounded exercise in the numerical analysis of ordinary differential equations, specifically the stability and accuracy analysis of the classical fourth-order Runge-Kutta method for oscillatory problems. All provided information is consistent, complete, and standard within the field of numerical methods. The problem is therefore deemed valid.\n\nThe task is to analyze the temporal dispersion and dissipation errors introduced by the classical four-stage fourth-order Runge-Kutta (RK4) method when applied to the linear test equation $\\frac{d y}{d t} = \\lambda y$, where the eigenvalue $\\lambda$ is purely imaginary, $\\lambda = i \\omega$, with $\\omega > 0$. The semi-discrete equation is thus $\\frac{d y}{d t} = i \\omega y$.\n\nThe classical RK4 method for an initial value problem $\\frac{d y}{d t} = f(t, y)$ with time step $\\Delta t$ is given by:\n$$y_{n+1} = y_n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$\nwhere the stages are:\n$$k_1 = f(t_n, y_n)$$\n$$k_2 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_1)$$\n$$k_3 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_2)$$\n$$k_4 = f(t_n + \\Delta t, y_n + \\Delta t k_3)$$\n\nFor the linear test equation, $f(t, y) = \\lambda y$. Let $y_n$ be the approximation at time $t_n$. The one-step update $y_{n+1} = G(z) y_n$ defines the amplification factor $G(z)$ for $z=\\lambda \\Delta t$. A standard derivation shows that for RK4, the amplification factor is the fourth-order Taylor series expansion of the exponential function:\n$$G(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}$$\n\nThe problem specifies $\\lambda = i\\omega$, so we set $z = i\\omega\\Delta t$. Let $\\xi = \\omega\\Delta t$. Thus, $z = i\\xi$.\n$$G(i\\xi) = 1 + i\\xi + \\frac{(i\\xi)^2}{2} + \\frac{(i\\xi)^3}{6} + \\frac{(i\\xi)^4}{24} = 1 + i\\xi - \\frac{\\xi^2}{2} - i\\frac{\\xi^3}{6} + \\frac{\\xi^4}{24}$$\nSeparating real and imaginary parts:\n$$G(i\\xi) = \\left(1 - \\frac{\\xi^2}{2} + \\frac{\\xi^4}{24}\\right) + i\\left(\\xi - \\frac{\\xi^3}{6}\\right)$$\n\n**Temporal Dispersion Error**\n\nThe dispersion error per time step is $\\Phi(z) - \\omega\\Delta t = \\arg(G(i\\xi)) - \\xi$. The numerical phase is $\\Phi(i\\xi) = \\arg(G(i\\xi))$, which can be calculated using $\\arctan$ of the ratio of the imaginary part to the real part.\n$$\\Phi(i\\xi) = \\arctan\\left(\\frac{\\xi - \\xi^3/6}{1 - \\xi^2/2 + \\xi^4/24}\\right)$$\nFor small $\\xi$, we perform a Taylor expansion. First, expand the argument of the $\\arctan$ function:\n$$\\frac{\\xi - \\xi^3/6}{1 - \\xi^2/2 + \\xi^4/24} = \\left(\\xi - \\frac{\\xi^3}{6}\\right)\\left(1 - \\left(\\frac{\\xi^2}{2} - \\frac{\\xi^4}{24})\\right)\\right)^{-1}$$\nUsing $(1-u)^{-1} = 1 + u + u^2 + \\dots$ with $u = \\frac{\\xi^2}{2} - \\frac{\\xi^4}{24}$:\n$$= \\left(\\xi - \\frac{\\xi^3}{6}\\right)\\left(1 + \\left(\\frac{\\xi^2}{2} - \\frac{\\xi^4}{24}\\right) + \\left(\\frac{\\xi^2}{2}\\right)^2 + O(\\xi^6)\\right)$$\n$$= \\left(\\xi - \\frac{\\xi^3}{6}\\right)\\left(1 + \\frac{\\xi^2}{2} - \\frac{\\xi^4}{24} + \\frac{\\xi^4}{4} + O(\\xi^6)\\right) = \\left(\\xi - \\frac{\\xi^3}{6}\\right)\\left(1 + \\frac{\\xi^2}{2} + \\frac{5\\xi^4}{24} + O(\\xi^6)\\right)$$\n$$= \\xi + \\frac{\\xi^3}{2} + \\frac{5\\xi^5}{24} - \\frac{\\xi^3}{6} - \\frac{\\xi^5}{12} + O(\\xi^7) = \\xi + \\frac{\\xi^3}{3} + \\frac{3\\xi^5}{24} + O(\\xi^7) = \\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8} + O(\\xi^7)$$\nNow, use the Taylor series for $\\arctan(x) = x - \\frac{x^3}{3} + \\frac{x^5}{5} - \\dots$:\n$$\\Phi(i\\xi) = \\left(\\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8}\\right) - \\frac{1}{3}\\left(\\xi + \\frac{\\xi^3}{3}\\right)^3 + \\frac{1}{5}\\left(\\xi\\right)^5 + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8} - \\frac{1}{3}\\left(\\xi^3 + \\xi^5 + \\dots\\right) + \\frac{\\xi^5}{5} + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\left(\\frac{1}{3} - \\frac{1}{3}\\right)\\xi^3 + \\left(\\frac{1}{8} - \\frac{1}{3} + \\frac{1}{5}\\right)\\xi^5 + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\left(\\frac{15 - 40 + 24}{120}\\right)\\xi^5 + O(\\xi^7) = \\xi - \\frac{1}{120}\\xi^5 + O(\\xi^7)$$\nThe dispersion error is $\\Phi(i\\xi) - \\xi$. The leading-order term is:\n$$\\text{Dispersion Error} = -\\frac{1}{120}\\xi^5 = -\\frac{1}{120}(\\omega\\Delta t)^5$$\nThis error is of order $O((\\Delta t)^5)$.\n\n**Temporal Dissipation Error**\n\nThe dissipation error is $|G(z)| - 1 = |G(i\\xi)| - 1$. We first compute $|G(i\\xi)|^2$:\n$$|G(i\\xi)|^2 = \\left(1 - \\frac{\\xi^2}{2} + \\frac{\\xi^4}{24}\\right)^2 + \\left(\\xi - \\frac{\\xi^3}{6}\\right)^2$$\nExpanding each term and collecting powers of $\\xi$:\n$$= \\left(1 - \\xi^2 + \\frac{\\xi^4}{3} - \\frac{\\xi^6}{24} + \\frac{\\xi^8}{576}\\right) + \\left(\\xi^2 - \\frac{\\xi^4}{3} + \\frac{\\xi^6}{36}\\right)$$\n$$= 1 + (-\\xi^2 + \\xi^2) + (\\frac{\\xi^4}{3} - \\frac{\\xi^4}{3}) + (-\\frac{\\xi^6}{24} + \\frac{\\xi^6}{36}) + O(\\xi^8)$$\n$$= 1 + \\left(\\frac{-3+2}{72}\\right)\\xi^6 + O(\\xi^8) = 1 - \\frac{\\xi^6}{72} + O(\\xi^8)$$\nNow we find $|G(i\\xi)|$ by taking the square root. Using the binomial expansion $(1+x)^{1/2} = 1 + \\frac{1}{2}x + O(x^2)$:\n$$|G(i\\xi)| = \\left(1 - \\frac{\\xi^6}{72} + O(\\xi^8)\\right)^{1/2} = 1 + \\frac{1}{2}\\left(-\\frac{\\xi^6}{72}\\right) + O(\\xi^8) = 1 - \\frac{\\xi^6}{144} + O(\\xi^8)$$\nThe dissipation error is $|G(i\\xi)| - 1$. The leading-order term is:\n$$\\text{Dissipation Error} = -\\frac{1}{144}\\xi^6 = -\\frac{1}{144}(\\omega\\Delta t)^6$$\nThis error is of order $O((\\Delta t)^6)$.\n\nThe leading-order temporal dispersion error per time step is $-\\frac{(\\omega\\Delta t)^5}{120}$, and the leading-order temporal dissipation error per time step is $-\\frac{(\\omega\\Delta t)^6}{144}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{(\\omega \\Delta t)^5}{120} & -\\frac{(\\omega \\Delta t)^6}{144}\n\\end{pmatrix}\n}\n$$", "id": "3404837"}, {"introduction": "Moving from the temporal to the spatial domain, this practice explores artifacts specific to the Discontinuous Galerkin (DG) formulation [@problem_id:3404800]. You will first investigate how the choice of quadrature rule is intrinsically linked to fundamental conservation properties of the discrete scheme. The exercise then pivots to a nonlinear problem to reveal how inexact integration leads to aliasing error, a common source of instability that must be understood and controlled in high-order methods.", "problem": "Consider the one-dimensional advection of a scalar field on the periodic interval $\\left[-\\pi,\\pi\\right]$. Two problems are posed.\n\nProblem A (Linear advection and spurious dissipation elimination): Let the partial differential equation be the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a \\in \\mathbb{R}$. Discretize using a one-element Discontinuous Galerkin (DG) method with a polynomial approximation of degree $p$ on $\\left[-\\pi,\\pi\\right]$ and central numerical flux at the boundary. The DG weak form uses exact volume and surface quadrature. Assume Gauß–Lobatto quadrature with $N_{q} = p+1$ nodes is used, which is exact for polynomials up to degree $2N_{q}-3 = 2p-1$. Starting from the definitions of the DG mass matrix, stiffness operator, and the energy norm induced by the mass matrix, derive the discrete energy balance for the semidiscrete scheme and show that the discrete energy rate is zero on the periodic interval with central flux under exact quadrature.\n\nProblem B (Nonlinear advection and residual aliasing error under underintegration): Consider the inviscid Burgers equation in conservative form $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$ on the same periodic interval $\\left[-\\pi,\\pi\\right]$. Let the initial condition be $u(x,0) = \\sin(x)$. The continuous energy rate is the time derivative of $\\frac{1}{2}\\int_{-\\pi}^{\\pi}u^{2}(x,t)\\,\\mathrm{d}x$ and is known to be zero for smooth solutions on the periodic domain. In the DG volume term, suppose the nonlinear flux derivative $\\left(\\frac{u^{2}}{2}\\right)_{x}$ is integrated using Gauß–Lobatto quadrature with $N_{q} = 4$ nodes on the physical interval. The $N_{q} = 4$ Gauß–Lobatto nodes on the reference interval $\\left[-1,1\\right]$ are $\\xi_{1}=-1$, $\\xi_{2}=-\\frac{1}{\\sqrt{5}}$, $\\xi_{3}=\\frac{1}{\\sqrt{5}}$, $\\xi_{4}=1$, with corresponding weights $w_{1}=\\frac{1}{6}$, $w_{2}=\\frac{5}{6}$, $w_{3}=\\frac{5}{6}$, $w_{4}=\\frac{1}{6}$. Map to the physical interval by $x = \\pi \\,\\xi$, so the quadrature weights scale by $\\pi$. Define the residual aliasing error $E_{\\mathrm{alias}}$ as the quadrature approximation of the continuous energy rate functional applied at $t=0$, namely the Gauß–Lobatto quadrature of $u^{2}(x,0)\\,u_{x}(x,0)$ over $\\left[-\\pi,\\pi\\right]$, which deviates from the exact value $0$ due to underintegration of the nonlinear integrand. Compute a closed-form analytic expression for $E_{\\mathrm{alias}}$ using the given quadrature nodes and weights.\n\nProvide your final answer as a two-entry row matrix containing:\n- The discrete energy rate for Problem A on the periodic interval with central flux and exact quadrature.\n- The residual aliasing error $E_{\\mathrm{alias}}$ for Problem B under the specified underintegration setup.\n\nNo rounding is required. Express angles in radians implicitly where trigonometric functions appear.", "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and contains a complete and consistent setup for two standard problems in the numerical analysis of partial differential equations.\n\n### Problem A: Linear advection and spurious dissipation elimination\n\nWe are asked to derive the discrete energy balance for a Discontinuous Galerkin (DG) discretization of the linear advection equation $u_t + a\\,u_x = 0$ on the periodic interval $[-\\pi, \\pi]$ and show that the energy rate is zero.\n\nThe DG semi-discrete formulation is obtained by multiplying the PDE by a test function $v_h$ from the polynomial space of degree $p$, and integrating over the single element $\\Omega = [-\\pi, \\pi]$:\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} v_h \\, \\mathrm{d}x + \\int_{-\\pi}^{\\pi} a u_{h,x} v_h \\, \\mathrm{d}x = 0 $$\nHere, $u_h(x,t)$ is the polynomial approximation of degree $p$. Integrating the second term by parts yields:\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} v_h \\, \\mathrm{d}x - \\int_{-\\pi}^{\\pi} a u_h v_{h,x} \\, \\mathrm{d}x + [a u_h v_h]_{x=-\\pi}^{x=\\pi} = 0 $$\nThe boundary term $[a u_h v_h]_{-\\pi}^{\\pi}$ is replaced by contributions from a numerical flux $F^*(u_h^-, u_h^+)$. For a periodic domain, the boundary consists of the point $x=\\pi$ being connected to $x=-\\pi$. The boundary term can be written as $\\oint_{\\partial\\Omega} F^* v_h \\, \\mathrm{d}S$. For our one-dimensional, single-element case, this becomes:\n$$ F^*(u_h(\\pi), u_h(-\\pi)) v_h(\\pi) - F^*(u_h(-\\pi), u_h(\\pi)) v_h(-\\pi) $$\nThe weak formulation is thus:\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} v_h \\, \\mathrm{d}x - \\int_{-\\pi}^{\\pi} a u_h v_{h,x} \\, \\mathrm{d}x + F^*(u_h(\\pi), u_h(-\\pi)) v_h(\\pi) - F^*(u_h(-\\pi), u_h(\\pi)) v_h(-\\pi) = 0 $$\nTo obtain the energy balance, we set the test function to be equal to the solution, $v_h = u_h$:\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} u_h \\, \\mathrm{d}x - \\int_{-\\pi}^{\\pi} a u_h u_{h,x} \\, \\mathrm{d}x + F^*(u_h(\\pi), u_h(-\\pi)) u_h(\\pi) - F^*(u_h(-\\pi), u_h(\\pi)) u_h(-\\pi) = 0 $$\nThe first term is the time derivative of the discrete energy $E(t) = \\frac{1}{2} \\int_{-\\pi}^{\\pi} u_h^2 \\, \\mathrm{d}x$:\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} u_h \\, \\mathrm{d}x = \\frac{1}{2} \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{-\\pi}^{\\pi} u_h^2 \\, \\mathrm{d}x = \\frac{\\mathrm{d}E}{\\mathrm{d}t} $$\nRearranging to find the rate of change of energy:\n$$ \\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int_{-\\pi}^{\\pi} a u_h u_{h,x} \\, \\mathrm{d}x - \\left( F^*(u_h(\\pi), u_h(-\\pi)) u_h(\\pi) - F^*(u_h(-\\pi), u_h(\\pi)) u_h(-\\pi) \\right) $$\nThe problem states that exact quadrature is used. The volume integral term can thus be evaluated exactly:\n$$ \\int_{-\\pi}^{\\pi} a u_h u_{h,x} \\, \\mathrm{d}x = a \\int_{-\\pi}^{\\pi} \\frac{1}{2} \\frac{\\mathrm{d}}{\\mathrm{d}x}(u_h^2) \\, \\mathrm{d}x = \\frac{a}{2} [u_h^2]_{-\\pi}^{\\pi} = \\frac{a}{2} (u_h^2(\\pi) - u_h^2(-\\pi)) $$\nThe problem specifies a central numerical flux, defined as $F^*(u_L, u_R) = a \\frac{u_L+u_R}{2}$.\nAt $x=\\pi$, the interior state is $u_L = u_h(\\pi)$ and the exterior state (from the periodic partner) is $u_R = u_h(-\\pi)$.\nAt $x=-\\pi$, the interior state is $u_L = u_h(-\\pi)$ and the exterior state is $u_R = u_h(\\pi)$.\nThe surface integral term becomes:\n$$ a \\frac{u_h(\\pi)+u_h(-\\pi)}{2} u_h(\\pi) - a \\frac{u_h(-\\pi)+u_h(\\pi)}{2} u_h(-\\pi) $$\n$$ = \\frac{a}{2} \\left( (u_h(\\pi)+u_h(-\\pi))u_h(\\pi) - (u_h(\\pi)+u_h(-\\pi))u_h(-\\pi) \\right) $$\n$$ = \\frac{a}{2} \\left( u_h^2(\\pi) + u_h(\\pi)u_h(-\\pi) - u_h(\\pi)u_h(-\\pi) - u_h^2(-\\pi) \\right) $$\n$$ = \\frac{a}{2} (u_h^2(\\pi) - u_h^2(-\\pi)) $$\nSubstituting the evaluated volume and surface terms back into the energy rate equation:\n$$ \\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{a}{2} (u_h^2(\\pi) - u_h^2(-\\pi)) - \\frac{a}{2} (u_h^2(\\pi) - u_h^2(-\\pi)) = 0 $$\nThus, the discrete energy rate is zero. This scheme is energy-conserving.\n\n### Problem B: Nonlinear advection and residual aliasing error under underintegration\n\nWe are asked to compute the residual aliasing error $E_{\\mathrm{alias}}$ for the inviscid Burgers equation under a specified Gauß–Lobatto quadrature rule.\nThe problem defines $E_{\\mathrm{alias}}$ as the quadrature approximation of the integral of $u^2(x,0) u_x(x,0)$ over $[-\\pi, \\pi]$.\nThe initial condition is $u(x,0) = \\sin(x)$. Its spatial derivative is $u_x(x,0) = \\cos(x)$.\nThe integrand function is $f(x) = u^2(x,0) u_x(x,0) = \\sin^2(x) \\cos(x)$.\nThe quadrature approximation of $\\int_{-\\pi}^{\\pi} f(x) \\, \\mathrm{d}x$ is given by $\\sum_{j=1}^{N_q} f(x_j) w_j^{\\text{phys}}$, where $N_q=4$.\n\nThe quadrature is defined on the reference interval $\\xi \\in [-1,1]$ with nodes and weights:\nNodes: $\\xi_1=-1$, $\\xi_2=-\\frac{1}{\\sqrt{5}}$, $\\xi_3=\\frac{1}{\\sqrt{5}}$, $\\xi_4=1$.\nWeights: $w_1=\\frac{1}{6}$, $w_2=\\frac{5}{6}$, $w_3=\\frac{5}{6}$, $w_4=\\frac{1}{6}$.\nThe mapping to the physical interval $x \\in [-\\pi, \\pi]$ is $x = \\pi \\xi$. The Jacobian of this transformation is $J = \\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} = \\pi$.\nThe physical nodes $x_j = \\pi \\xi_j$ are:\n$x_1 = -\\pi$, $x_2 = -\\frac{\\pi}{\\sqrt{5}}$, $x_3 = \\frac{\\pi}{\\sqrt{5}}$, $x_4 = \\pi$.\nThe physical weights $w_j^{\\text{phys}} = w_j J$ are:\n$w_1^{\\text{phys}} = \\frac{\\pi}{6}$, $w_2^{\\text{phys}} = \\frac{5\\pi}{6}$, $w_3^{\\text{phys}} = \\frac{5\\pi}{6}$, $w_4^{\\text{phys}} = \\frac{\\pi}{6}$.\n\nNow we compute $E_{\\mathrm{alias}}$ by summing the contributions from each node:\n$$ E_{\\mathrm{alias}} = \\sum_{j=1}^{4} \\sin^2(x_j) \\cos(x_j) w_j^{\\text{phys}} $$\nTerm for $j=1$ ($x_1 = -\\pi$):\n$$ \\sin^2(-\\pi) \\cos(-\\pi) \\cdot \\frac{\\pi}{6} = (0)^2 \\cdot (-1) \\cdot \\frac{\\pi}{6} = 0 $$\nTerm for $j=2$ ($x_2 = -\\frac{\\pi}{\\sqrt{5}}$):\n$$ \\sin^2(-\\frac{\\pi}{\\sqrt{5}}) \\cos(-\\frac{\\pi}{\\sqrt{5}}) \\cdot \\frac{5\\pi}{6} = (-\\sin(\\frac{\\pi}{\\sqrt{5}}))^2 \\cos(\\frac{\\pi}{\\sqrt{5}}) \\cdot \\frac{5\\pi}{6} = \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) $$\nTerm for $j=3$ ($x_3 = \\frac{\\pi}{\\sqrt{5}}$):\n$$ \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) \\cdot \\frac{5\\pi}{6} = \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) $$\nTerm for $j=4$ ($x_4 = \\pi$):\n$$ \\sin^2(\\pi) \\cos(\\pi) \\cdot \\frac{\\pi}{6} = (0)^2 \\cdot (-1) \\cdot \\frac{\\pi}{6} = 0 $$\nSumming the terms:\n$$ E_{\\mathrm{alias}} = 0 + \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) + \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) + 0 $$\n$$ E_{\\mathrm{alias}} = 2 \\cdot \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) $$\n$$ E_{\\mathrm{alias}} = \\frac{5\\pi}{3} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) $$\nThis is the closed-form analytic expression for the residual aliasing error. The exact value of the integral is $\\int_{-\\pi}^{\\pi} \\sin^2(x)\\cos(x)\\,\\mathrm{d}x = 0$, so the calculated non-zero value represents the error entirely due to aliasing from the under-resolved quadrature.\n\nFinal results for the two problems are:\n1.  Discrete energy rate for Problem A: $0$.\n2.  Residual aliasing error $E_{\\mathrm{alias}}$ for Problem B: $\\frac{5\\pi}{3} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{5\\pi}{3} \\sin^2\\left(\\frac{\\pi}{\\sqrt{5}}\\right) \\cos\\left(\\frac{\\pi}{\\sqrt{5}}\\right)\n\\end{pmatrix}\n}\n$$", "id": "3404800"}, {"introduction": "Theoretical analysis finds its ultimate value when it informs practical scheme design. This computational exercise challenges you to explore the real-world trade-offs involved in filtering high-order solutions to remove spurious oscillations [@problem_id:3404850]. By implementing a spectral filter and computing quantitative metrics for both phase error and dissipation, you will gain a concrete understanding of the delicate balance between maintaining accuracy and ensuring stability.", "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ on the periodic domain $x \\in [0,2\\pi)$, with wave speed $a$. A Fourier spectral collocation method exactly represents spatial derivatives for individual Fourier modes $u(x,t) = \\hat{u}(t)\\,e^{i k x}$, where $k \\in \\mathbb{Z}$ denotes the integer wavenumber. To reduce Gibbs oscillations near discontinuities while preserving low-wavenumber phase accuracy, a modal filter is applied after each explicit time step. The objective is to quantify the trade-off between suppression of high-wavenumber content (dissipation) and preservation of low-wavenumber phase speed (dispersion).\n\nStarting from the governing equation $u_t + a\\,u_x = 0$, the Fourier symbol of the spectral derivative is $i k$. Using a Strong Stability Preserving Runge–Kutta method of order three (SSP-RK3), specifically the Shu–Osher form of third-order Total Variation Diminishing Runge–Kutta (TVD-RK3), the one-step amplification polynomial for a linear constant-coefficient system $u_t = L u$ is given by the truncated Taylor series of the exponential:\n$$\nG_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3,\n$$\nwhere $\\lambda = \\Delta t\\,L$. For linear advection, $L = -a\\,\\partial_x$ and for a Fourier mode $e^{i k x}$, one has $L \\mapsto -a\\,i k$, so $\\lambda = -i\\,a\\,k\\,\\Delta t$. A tuned exponential modal filter of order $m$ is defined by the transfer function\n$$\n\\sigma(k) = \\exp\\!\\left(-\\alpha\\,\\left(\\frac{|k|}{k_{\\max}}\\right)^{2m}\\right),\n$$\nwhere $k_{\\max}$ is the maximum resolvable wavenumber on the grid, $m \\in \\mathbb{N}$ is the filter order, and $\\alpha > 0$ is chosen to meet a specified attenuation at a cut-off ratio $r_{\\mathrm{cut}} \\in (0,1)$:\n$$\n\\sigma\\!\\left(r_{\\mathrm{cut}}\\,k_{\\max}\\right) = s_{\\mathrm{target}} \\quad \\Rightarrow \\quad \\alpha = -\\frac{\\ln(s_{\\mathrm{target}})}{r_{\\mathrm{cut}}^{2m}}.\n$$\nThe combined one-step amplification for wavenumber $k$ is then\n$$\nG(k) = \\sigma(k)\\,G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t).\n$$\nDefine the numerical angular frequency by the argument (in radians) of $G_{\\text{RK3}}$,\n$$\n\\omega_{\\text{num}}(k) = \\frac{\\arg\\!\\left(G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)\\right)}{\\Delta t},\n$$\nand the numerical phase speed by $c_{\\text{num}}(k) = \\omega_{\\text{num}}(k)/k$. Because $\\sigma(k)$ is real and positive, it does not alter the phase, only the magnitude.\n\nYou must write a complete, runnable program that computes two metrics per test case:\n- Low-wavenumber phase error:\n$$\nE_{\\text{phase,low}} = \\max_{k/k_{\\max} \\in (0,r_{\\text{phase}}]}\\left| \\frac{c_{\\text{num}}(k)}{a} - 1 \\right|,\n$$\nwhich quantifies dispersion at low wavenumbers, expressed as a dimensionless decimal. Angles must be measured in radians.\n- High-wavenumber mean dissipation per step:\n$$\nD_{\\text{high}} = \\frac{1}{\\#\\{k: k/k_{\\max} \\in [r_{\\text{diss}},1]\\}} \\sum_{k/k_{\\max} \\in [r_{\\text{diss}},1]}\\left(1 - |G(k)|\\right),\n$$\nwhich quantifies attenuation due to the filter and time stepping, expressed as a dimensionless decimal.\n\nUse a uniform grid with $N$ points on $[0,2\\pi)$, so the resolvable wavenumbers are integers and $k_{\\max} = N/2$. Take $a = 1$. The program must evaluate the metrics on the set of positive wavenumbers $k = 1,2,\\dots,k_{\\max}$. The low-wavenumber threshold is $r_{\\text{phase}} = 0.2$, and the high-wavenumber threshold is $r_{\\text{diss}} = 0.6$.\n\nImplement the tuned filter by choosing $\\alpha$ from $s_{\\mathrm{target}}$ and $r_{\\mathrm{cut}}$ via the formula above. If $s_{\\mathrm{target}} = 1$, interpret this as the no-filter case with $\\alpha = 0$.\n\nDesign the program to process the following three test cases:\n- Case $1$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;1.0)$.\n- Case $2$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;0.1)$.\n- Case $3$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;16,\\; r_{\\mathrm{cut}}=\\;0.6,\\; s_{\\mathrm{target}}=\\;0.001)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[E_{\\text{phase,low}}^{(1)},D_{\\text{high}}^{(1)},E_{\\text{phase,low}}^{(2)},D_{\\text{high}}^{(2)},E_{\\text{phase,low}}^{(3)},D_{\\text{high}}^{(3)}]$, where the superscript indicates the case number. All angles must be handled in radians, and the outputs are dimensionless decimals.", "solution": "The starting point is the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ on a periodic domain. For a Fourier mode $u(x,t) = \\hat{u}(t)\\,e^{i k x}$, substitution yields\n$$\n\\frac{d\\hat{u}}{dt} + a\\,i\\,k\\,\\hat{u} = 0,\n$$\nwhich is a linear ordinary differential equation with constant coefficient $L = -a\\,i\\,k$. The exact solution over one time step $\\Delta t$ has amplification factor $e^{\\lambda}$ with $\\lambda = \\Delta t\\,L = -i\\,a\\,k\\,\\Delta t$.\n\nWe consider the Shu–Osher third-order Total Variation Diminishing Runge–Kutta method (Strong Stability Preserving Runge–Kutta method of order three). For any linear system $u_t = L u$, the one-step amplification polynomial is the third-order Taylor polynomial of the exponential:\n$$\nG_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3.\n$$\nThis follows directly from the staged updates of the Shu–Osher TVD-RK3 method when applied to the linear ODE $u_t = Lu$, where $\\lambda = \\Delta t L$:\n- First stage: $u^{(1)} = u^n + \\Delta t L u^n = (1+\\lambda) u^n$.\n- Second stage: $u^{(2)} = \\frac{3}{4}u^n + \\frac{1}{4}(u^{(1)} + \\Delta t L u^{(1)}) = \\left[\\frac{3}{4} + \\frac{1}{4}(1+\\lambda)^2\\right] u^n = \\left(1 + \\frac{1}{2}\\lambda + \\frac{1}{4}\\lambda^2\\right)u^n$.\n- Third stage: $u^{n+1} = \\frac{1}{3}u^n + \\frac{2}{3}(u^{(2)} + \\Delta t L u^{(2)}) = \\left[\\frac{1}{3} + \\frac{2}{3}(1+\\lambda)\\left(1 + \\frac{1}{2}\\lambda + \\frac{1}{4}\\lambda^2\\right)\\right]u^n = \\left(1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3\\right)u^n$.\n\nFor the Fourier spectral collocation discretization of the spatial derivative, the symbol is exact: $\\partial_x \\mapsto i k$ for mode $e^{i k x}$. Thus, for advection speed $a$, the semi-discrete operator is $L = -a\\,i\\,k$, and the Runge–Kutta step has amplification $G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)$.\n\nTo mitigate Gibbs oscillations associated with high-wavenumber content, we apply a tuned exponential modal filter after each step. The filter transfer function is\n$$\n\\sigma(k) = \\exp\\!\\left(-\\alpha\\,\\left(\\frac{|k|}{k_{\\max}}\\right)^{2m}\\right),\n$$\nwhere $m$ is the filter order, $k_{\\max} = N/2$ for $N$ equispaced points on $[0,2\\pi)$, and $\\alpha$ is chosen to meet a design constraint at the cut-off ratio $r_{\\mathrm{cut}}$:\n$$\n\\sigma(r_{\\mathrm{cut}}\\,k_{\\max}) = s_{\\mathrm{target}} \\;\\Rightarrow\\; \\alpha = -\\frac{\\ln(s_{\\mathrm{target}})}{r_{\\mathrm{cut}}^{2m}}.\n$$\nWhen $s_{\\mathrm{target}} = 1$, we interpret this as no filtering, so $\\alpha = 0$ and $\\sigma(k) = 1$ for all $k$.\n\nThe combined one-step amplification for wavenumber $k$ is\n$$\nG(k) = \\sigma(k)\\,G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t),\n$$\nwhich is a complex number. Its magnitude $|G(k)|$ reflects dissipation (amplitude attenuation), and its argument $\\arg(G(k))$ would reflect phase advance. However, since $\\sigma(k)$ is real and positive, it does not alter the phase; hence, dispersion is fully controlled by $G_{\\text{RK3}}$.\n\nWe define the numerical angular frequency by\n$$\n\\omega_{\\text{num}}(k) = \\frac{\\arg\\!\\left(G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)\\right)}{\\Delta t},\n$$\nand the numerical phase speed by $c_{\\text{num}}(k) = \\omega_{\\text{num}}(k)/k$. The exact phase speed is $a$. The low-wavenumber phase error metric is then\n$$\nE_{\\text{phase,low}} = \\max_{k/k_{\\max} \\in (0,r_{\\text{phase}}]}\\left| \\frac{c_{\\text{num}}(k)}{a} - 1 \\right|,\n$$\nevaluated over the set of positive wavenumbers $k = 1,2,\\dots,k_{\\max}$ with the ratio $k/k_{\\max}$ lying within $(0,r_{\\text{phase}}]$, where $r_{\\text{phase}}$ is a prescribed threshold. This metric is dimensionless.\n\nThe high-wavenumber mean dissipation per step is defined by\n$$\nD_{\\text{high}} = \\frac{1}{K_{\\text{count}}}\\sum_{k/k_{\\max} \\in [r_{\\text{diss}},1]}\\left(1 - |G(k)|\\right),\n$$\nwhere $K_{\\text{count}}$ is the number of wavenumbers in the specified high-wavenumber range and $|G(k)|$ is the magnitude of the combined amplification. This metric is also dimensionless and reflects the trade-off: larger dissipation suppresses Gibbs oscillations but reduces amplitude of high-frequency content.\n\nAlgorithmic steps for each test case $(N,\\Delta t,m,r_{\\mathrm{cut}},s_{\\mathrm{target}})$ with $a=1$:\n1. Set $k_{\\max} = N/2$ and construct the array of positive integer wavenumbers $k = 1,2,\\dots,k_{\\max}$.\n2. Compute the ratio $r(k) = k/k_{\\max}$ for each $k$.\n3. Compute $\\alpha = -\\ln(s_{\\mathrm{target}})/r_{\\mathrm{cut}}^{2m}$, with the convention that if $s_{\\mathrm{target}} = 1$ then $\\alpha = 0$.\n4. Evaluate the filter $\\sigma(k) = \\exp\\left(-\\alpha\\,r(k)^{2m}\\right)$.\n5. Compute $\\lambda(k) = -i\\,a\\,k\\,\\Delta t$ and the Runge–Kutta amplification $G_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3$.\n6. Form the combined amplification $G(k) = \\sigma(k)\\,G_{\\text{RK3}}(\\lambda)$.\n7. Compute the phase speed using only $G_{\\text{RK3}}$: $c_{\\text{num}}(k) = \\arg(G_{\\text{RK3}}(\\lambda))/(\\Delta t\\,k)$, with angles in radians.\n8. Compute $E_{\\text{phase,low}}$ as the maximum of $\\left|c_{\\text{num}}(k)/a - 1\\right|$ over $k$ with $r(k) \\in (0,r_{\\text{phase}}]$, where $r_{\\text{phase}} = 0.2$.\n9. Compute $D_{\\text{high}}$ as the mean of $1 - |G(k)|$ over $k$ with $r(k) \\in [r_{\\text{diss}},1]$, where $r_{\\text{diss}} = 0.6$.\n10. Output the six results for the three test cases in the specified order and format.\n\nScientific realism and numerical soundness:\n- The Fourier spectral derivative symbol $i k$ is exact for Fourier modes, providing a clean foundation for dispersion analysis without spatial discretization error in the derivative.\n- The TVD-RK3 amplification polynomial is a well-tested formula and represents third-order temporal accuracy.\n- The exponential filter is a standard design in spectral methods; tuning $\\alpha$ via a specified attenuation at a cut-off ratio is widely used to control Gibbs oscillations while minimizing low-wavenumber distortion.\n- The dispersion metric focuses on low wavenumbers where physical fidelity is most critical, and the dissipation metric emphasizes high wavenumbers where Gibbs oscillations occur.\n- Angles are measured in radians, and all outputs are dimensionless decimals, conforming to the requirement on units.\n\nTest suite and final output:\n- Case $1$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;1.0)$.\n- Case $2$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;0.1)$.\n- Case $3$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;16,\\; r_{\\mathrm{cut}}=\\;0.6,\\; s_{\\mathrm{target}}=\\;0.001)$.\nThe program must print a single line: $[E_{\\text{phase,low}}^{(1)},D_{\\text{high}}^{(1)},E_{\\text{phase,low}}^{(2)},D_{\\text{high}}^{(2)},E_{\\text{phase,low}}^{(3)},D_{\\text{high}}^{(3)}]$, where each quantity is a decimal.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef rk3_amplification(lambda_k: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Compute the Shu-Osher TVD-RK3 amplification polynomial G_RK3(lambda)\n    for a given array of lambda values.\n    G_RK3(lambda) = 1 + lambda + 0.5*lambda^2 + (1/6)*lambda^3\n    \"\"\"\n    return 1.0 + lambda_k + 0.5 * (lambda_k ** 2) + (1.0 / 6.0) * (lambda_k ** 3)\n\ndef tuned_exponential_filter(r: np.ndarray, m: int, r_cut: float, s_target: float) -> np.ndarray:\n    \"\"\"\n    Compute the tuned exponential filter sigma(k) = exp(-alpha * r^(2m)),\n    where r = |k|/k_max. Alpha is chosen so that sigma(r_cut) = s_target.\n    If s_target == 1.0, alpha is set to 0 (no filter).\n    \"\"\"\n    if np.isclose(s_target, 1.0):\n        alpha = 0.0\n    else:\n        # alpha = -ln(s_target) / r_cut^(2m)\n        alpha = -np.log(s_target) / (r_cut ** (2 * m))\n    sigma = np.exp(-alpha * (r ** (2 * m)))\n    return sigma\n\ndef compute_metrics(N: int, dt: float, m: int, r_cut: float, s_target: float,\n                    a: float = 1.0, r_phase: float = 0.2, r_diss: float = 0.6) -> tuple[float, float]:\n    \"\"\"\n    Compute E_phase_low and D_high for the given parameters.\n    - N: number of grid points on [0, 2*pi)\n    - dt: time step\n    - m: filter order\n    - r_cut: cut-off ratio for tuning\n    - s_target: target attenuation at r_cut\n    - a: advection speed (default 1.0)\n    - r_phase: threshold for low-wavenumber phase error metric\n    - r_diss: threshold for high-wavenumber dissipation metric\n    Returns (E_phase_low, D_high) as floats.\n    \"\"\"\n    k_max = N // 2\n    # Positive wavenumbers 1..k_max\n    k = np.arange(1, k_max + 1, dtype=float)\n    r = k / k_max\n\n    # Semi-discrete lambda for linear advection with spectral derivative\n    lambda_k = -1j * a * k * dt\n\n    # RK3 amplification (phase carrier)\n    G_rk3 = rk3_amplification(lambda_k)\n\n    # Tuned filter sigma (magnitude-only; real and positive)\n    sigma = tuned_exponential_filter(r, m, r_cut, s_target)\n\n    # Combined amplification per step\n    G_combined = sigma * G_rk3\n\n    # Low-wavenumber phase error metric: use phase of G_rk3 only (filter does not change phase)\n    # angle in radians\n    omega_num = np.angle(G_rk3) / dt\n    c_num = omega_num / k  # numerical phase speed\n\n    # Mask for low-wavenumber band\n    low_mask = (r > 0.0) & (r <= r_phase)\n    if not np.any(low_mask):\n        # Should not happen for provided parameters, but guard anyway\n        E_phase_low = 0.0\n    else:\n        E_phase_low = np.max(np.abs(c_num[low_mask] / a - 1.0))\n\n    # High-wavenumber dissipation: mean(1 - |G|)\n    high_mask = (r >= r_diss) & (r <= 1.0)\n    if not np.any(high_mask):\n        D_high = 0.0\n    else:\n        mag = np.abs(G_combined[high_mask])\n        D_high = float(np.mean(1.0 - mag))\n\n    return float(E_phase_low), float(D_high)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (N, dt, m, r_cut, s_target)\n    test_cases = [\n        (256, 0.05, 8, 0.7, 1.0),     # Case 1: no filter\n        (256, 0.05, 8, 0.7, 0.1),     # Case 2: moderate filter\n        (256, 0.05, 16, 0.6, 0.001),  # Case 3: aggressive filter\n    ]\n\n    results = []\n    for case in test_cases:\n        N, dt, m, r_cut, s_target = case\n        E_phase_low, D_high = compute_metrics(N=N, dt=dt, m=m, r_cut=r_cut, s_target=s_target)\n        # Optionally round for cleaner output; keep sufficient precision\n        results.append(f\"{E_phase_low:.10f}\")\n        results.append(f\"{D_high:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3404850"}]}