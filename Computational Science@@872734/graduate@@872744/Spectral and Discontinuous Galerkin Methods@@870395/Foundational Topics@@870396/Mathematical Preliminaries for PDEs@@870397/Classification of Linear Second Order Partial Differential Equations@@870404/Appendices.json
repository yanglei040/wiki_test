{"hands_on_practices": [{"introduction": "The classification of a partial differential equation as elliptic is a crucial first step, but it doesn't tell the whole story. This exercise explores the vital distinction between pointwise ellipticity and the stronger condition of uniform ellipticity. By analyzing an operator whose ellipticity degenerates at a boundary, you will see how this lack of uniformity directly impacts the stability of the problem, a key insight for designing robust numerical solvers [@problem_id:3371078].", "problem": "Consider the linear second order operator in divergence form on the open set $\\Omega = (0,1)\\times(0,1)$,\n$$\nL u = -\\nabla \\cdot \\big( A(x,y)\\,\\nabla u \\big),\n$$\nwhere the symmetric coefficient matrix is\n$$\nA(x,y) = \\begin{pmatrix} 1  0 \\\\ 0  x \\end{pmatrix}.\n$$\nThe classification of linear second order partial differential equations uses the principal symbol. An operator is elliptic at a point if the principal symbol is positive definite there, and it is uniformly elliptic on $\\Omega$ if there exists a positive constant that uniformly bounds below the smallest eigenvalue of the principal symbol across $\\Omega$.\n\nPart A. Using the principal symbol and the definitions above, justify from first principles that the operator $L$ is elliptic at every point of $\\Omega$ but not uniformly elliptic on $\\Omega$.\n\nPart B. To quantify the impact on a priori estimates relevant to high-order spectral methods and Discontinuous Galerkin (DG) methods, restrict the operator to the truncated domain $\\Omega_{\\varepsilon} = (\\varepsilon,1)\\times(0,1)$ for a fixed parameter $\\varepsilon \\in (0,1)$. Consider the homogeneous Dirichlet problem\n$$\n\\text{find } u \\in H_0^1(\\Omega_{\\varepsilon}) \\text{ such that } \\quad a_{\\varepsilon}(u,v) = \\langle f, v \\rangle \\quad \\text{for all } v \\in H_0^1(\\Omega_{\\varepsilon}),\n$$\nwhere\n$$\na_{\\varepsilon}(u,v) = \\int_{\\Omega_{\\varepsilon}} \\Big( \\partial_x u\\,\\partial_x v + x\\,\\partial_y u\\,\\partial_y v \\Big)\\,dx\\,dy,\n$$\nand $f \\in H^{-1}(\\Omega_{\\varepsilon})$ is a given functional, with $\\langle \\cdot, \\cdot \\rangle$ denoting the duality pairing between $H^{-1}(\\Omega_{\\varepsilon})$ and $H_0^1(\\Omega_{\\varepsilon})$. Derive from first principles (coercivity and continuity of $a_{\\varepsilon}$ together with the Lax–Milgram theorem) the smallest admissible constant $C(\\varepsilon)$ such that the a priori energy estimate\n$$\n\\|\\nabla u\\|_{L^2(\\Omega_{\\varepsilon})} \\leq C(\\varepsilon)\\, \\|f\\|_{H^{-1}(\\Omega_{\\varepsilon})}\n$$\nholds for all solutions $u$ of the weak problem. Express your final answer for $C(\\varepsilon)$ as a closed-form analytic expression in $\\varepsilon$. No rounding is required and no units are involved.", "solution": "The problem is divided into two parts. Part A concerns the classification of the operator, and Part B requires the derivation of a constant in an a priori estimate for a related boundary value problem.\n\n**Part A: Classification of the Operator**\n\nThe given linear second-order operator is $L u = -\\nabla \\cdot \\big( A(x,y)\\,\\nabla u \\big)$, where the coefficient matrix is $A(x,y) = \\begin{pmatrix} 1  0 \\\\ 0  x \\end{pmatrix}$. The domain is $\\Omega = (0,1)\\times(0,1)$.\n\nThe classification of such an operator depends on its principal symbol. For a general divergence-form operator $L u = -\\sum_{i,j=1}^n \\partial_{x_i} (a_{ij}(x) \\partial_{x_j} u)$, the principal symbol at a point $x$ is the quadratic form $p(x, \\xi) = \\sum_{i,j=1}^n a_{ij}(x) \\xi_i \\xi_j$, where $\\xi = (\\xi_1, \\dots, \\xi_n) \\in \\mathbb{R}^n \\setminus \\{0\\}$ is a frequency vector. In our two-dimensional case, with $x = (x,y)$ and $\\xi = (\\xi_1, \\xi_2)$, the principal symbol is given by the quadratic form associated with the matrix $A(x,y)$:\n$$\np(x,y,\\xi) = \\xi^T A(x,y) \\xi = \\begin{pmatrix} \\xi_1  \\xi_2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  x \\end{pmatrix} \\begin{pmatrix} \\xi_1 \\\\ \\xi_2 \\end{pmatrix} = 1 \\cdot \\xi_1^2 + x \\cdot \\xi_2^2.\n$$\n\nAn operator is defined as elliptic at a point if its principal symbol is positive definite at that point. This means $p(x,y,\\xi)  0$ for all $\\xi \\neq 0$. Let's examine this condition for any point $(x,y) \\in \\Omega$. In $\\Omega = (0,1)\\times(0,1)$, we have $x \\in (0,1)$ and thus $x  0$. For any non-zero vector $\\xi = (\\xi_1, \\xi_2)$, at least one of its components is non-zero.\n- If $\\xi_1 \\neq 0$, then $\\xi_1^2  0$, so $p(x,y,\\xi) = \\xi_1^2 + x \\xi_2^2 \\ge \\xi_1^2  0$.\n- If $\\xi_1 = 0$, then it must be that $\\xi_2 \\neq 0$. In this case, $\\xi_2^2  0$. Since $x  0$, we have $p(x,y,\\xi) = x \\xi_2^2  0$.\nIn all cases, for any $(x,y) \\in \\Omega$ and any $\\xi \\neq 0$, the principal symbol is strictly positive. Therefore, the operator $L$ is elliptic at every point of $\\Omega$.\n\nAn operator is uniformly elliptic on $\\Omega$ if there exists a constant $\\alpha_0  0$ such that the principal symbol is uniformly bounded below, i.e., $p(x,y,\\xi) \\ge \\alpha_0 |\\xi|^2$ for all $(x,y) \\in \\Omega$ and all $\\xi \\in \\mathbb{R}^2$, where $|\\xi|^2 = \\xi_1^2 + \\xi_2^2$. This condition is equivalent to the smallest eigenvalue of the coefficient matrix $A(x,y)$ being uniformly bounded below by a positive constant $\\alpha_0$ across the entire domain $\\Omega$.\n\nThe matrix $A(x,y)$ is diagonal, so its eigenvalues are its diagonal entries: $\\lambda_1 = 1$ and $\\lambda_2 = x$. The smallest eigenvalue at a point $(x,y) \\in \\Omega$ is $\\lambda_{\\min}(x,y) = \\min(1, x)$. For uniform ellipticity, we require $\\inf_{(x,y) \\in \\Omega} \\lambda_{\\min}(x,y) \\ge \\alpha_0  0$.\nLet's compute this infimum over the domain $\\Omega = (0,1)\\times(0,1)$:\n$$\n\\inf_{(x,y) \\in (0,1)\\times(0,1)} \\lambda_{\\min}(x,y) = \\inf_{x \\in (0,1)} \\min(1, x).\n$$\nSince $x \\in (0,1)$, we have $x  1$, so $\\min(1, x) = x$. The infimum becomes:\n$$\n\\inf_{x \\in (0,1)} x = 0.\n$$\nSince the infimum of the smallest eigenvalue is $0$, there exists no positive constant $\\alpha_0$ that can act as a uniform lower bound. The ellipticity degenerates as $x$ approaches $0$. Consequently, the operator $L$ is not uniformly elliptic on $\\Omega$.\n\n**Part B: A Priori Estimate**\n\nWe are tasked with finding the smallest admissible constant $C(\\varepsilon)$ in the a priori estimate $\\|\\nabla u\\|_{L^2(\\Omega_{\\varepsilon})} \\leq C(\\varepsilon)\\, \\|f\\|_{H^{-1}(\\Omega_{\\varepsilon})}$. The weak problem is posed on the Hilbert space $V = H_0^1(\\Omega_{\\varepsilon})$ equipped with the norm $\\|v\\|_V = \\|\\nabla v\\|_{L^2(\\Omega_{\\varepsilon})}$. The problem is to find $u \\in V$ such that $a_{\\varepsilon}(u,v) = \\langle f,v \\rangle$ for all $v \\in V$.\n\nThe Lax-Milgram theorem guarantees a unique solution and provides an estimate. From the weak formulation, we have $a_{\\varepsilon}(u,u) = \\langle f, u \\rangle$.\nThe definition of the dual norm $\\|f\\|_{H^{-1}(\\Omega_{\\varepsilon})}$ implies $|\\langle f, u \\rangle| \\le \\|f\\|_{H^{-1}(\\Omega_{\\varepsilon})} \\|\\nabla u\\|_{L^2(\\Omega_{\\varepsilon})}$.\nThe coercivity of the bilinear form states that there exists a constant $\\alpha  0$ such that $a_{\\varepsilon}(v,v) \\ge \\alpha \\|\\nabla v\\|_{L^2(\\Omega_{\\varepsilon})}^2$ for all $v \\in H_0^1(\\Omega_{\\varepsilon})$.\nCombining these, we get:\n$$\n\\alpha \\|\\nabla u\\|_{L^2(\\Omega_{\\varepsilon})}^2 \\le a_{\\varepsilon}(u,u) = \\langle f, u \\rangle \\le \\|f\\|_{H^{-1}(\\Omega_{\\varepsilon})} \\|\\nabla u\\|_{L^2(\\Omega_{\\varepsilon})}.\n$$\nAssuming $u \\neq 0$, we can divide by $\\|\\nabla u\\|_{L^2(\\Omega_{\\varepsilon})}$ to obtain the estimate:\n$$\n\\|\\nabla u\\|_{L^2(\\Omega_{\\varepsilon})} \\le \\frac{1}{\\alpha} \\|f\\|_{H^{-1}(\\Omega_{\\varepsilon})}.\n$$\nTo find the smallest admissible constant $C(\\varepsilon)$, we must use the largest possible coercivity constant, $\\alpha_{\\max}$. The smallest constant is then $C(\\varepsilon) = 1/\\alpha_{\\max}$. The value of $\\alpha_{\\max}$ is determined by the infimum of the Rayleigh quotient for the bilinear form:\n$$\n\\alpha_{\\max} = \\inf_{v \\in H_0^1(\\Omega_{\\varepsilon}), v \\neq 0} \\frac{a_{\\varepsilon}(v,v)}{\\|\\nabla v\\|_{L^2(\\Omega_{\\varepsilon})}^2}.\n$$\nLet's analyze this ratio using the definitions of the bilinear form and the norm:\n$$\na_{\\varepsilon}(v,v) = \\int_{\\Omega_{\\varepsilon}} \\left( (\\partial_x v)^2 + x (\\partial_y v)^2 \\right) dx\\,dy,\n$$\n$$\n\\|\\nabla v\\|_{L^2(\\Omega_{\\varepsilon})}^2 = \\int_{\\Omega_{\\varepsilon}} \\left( (\\partial_x v)^2 + (\\partial_y v)^2 \\right) dx\\,dy.\n$$\nFor the coercivity inequality $a_{\\varepsilon}(v,v) \\ge \\alpha \\|\\nabla v\\|_{L^2(\\Omega_{\\varepsilon})}^2$ to hold for all $v$, it is sufficient that the inequality holds pointwise for the integrands for any potential gradient values. Let $g_1 = \\partial_x v$ and $g_2 = \\partial_y v$. We require:\n$$\ng_1^2 + x g_2^2 \\ge \\alpha (g_1^2 + g_2^2)\n$$\nfor all $(x,y) \\in \\Omega_{\\varepsilon} = (\\varepsilon, 1) \\times (0,1)$ and all $g_1, g_2 \\in \\mathbb{R}$. Rearranging the terms gives:\n$$\n(1-\\alpha)g_1^2 + (x-\\alpha)g_2^2 \\ge 0.\n$$\nFor this quadratic form in $g_1, g_2$ to be non-negative for all choices of $g_1, g_2$, the coefficients must be non-negative. This must hold for all $x$ in the domain $(\\varepsilon, 1)$.\n1.  $1 - \\alpha \\ge 0 \\implies \\alpha \\le 1$.\n2.  $x - \\alpha \\ge 0$ for all $x \\in (\\varepsilon, 1) \\implies \\alpha \\le x$ for all $x \\in (\\varepsilon, 1)$.\n\nThe second condition implies that $\\alpha$ must be less than or equal to the infimum of $x$ over its domain, which is $\\inf_{x \\in (\\varepsilon,1)} x = \\varepsilon$.\nSo, we have two constraints: $\\alpha \\le 1$ and $\\alpha \\le \\varepsilon$. Since the problem states $\\varepsilon \\in (0,1)$, the second constraint $\\alpha \\le \\varepsilon$ is the more restrictive one.\nThe largest possible value of $\\alpha$ that satisfies both conditions is $\\alpha = \\varepsilon$. This gives an upper bound for the coercivity constant: $\\alpha_{\\max} \\le \\varepsilon$.\n\nWe must also show that this value is attainable. The infimum of the Rayleigh quotient is indeed $\\varepsilon$. This can be demonstrated by constructing a sequence of functions for which the quotient approaches $\\varepsilon$. Consider functions that vary predominantly in the $y$-direction and are spatially localized near $x=\\varepsilon$. For such functions, the term $(\\partial_y v)^2$ dominates $(\\partial_x v)^2$, and the factor $x$ in the numerator $a_\\varepsilon(v,v)$ is close to $\\varepsilon$. This confirms that the greatest lower bound, and thus the largest coercivity constant, is $\\alpha_{\\max} = \\varepsilon$.\n\nThe smallest admissible constant $C(\\varepsilon)$ for the a priori estimate is therefore:\n$$\nC(\\varepsilon) = \\frac{1}{\\alpha_{\\max}} = \\frac{1}{\\varepsilon}.\n$$\nThis constant quantifies the stability of the problem. As $\\varepsilon \\to 0$, the operator's ellipticity degenerates, the problem becomes increasingly ill-conditioned, and the constant $C(\\varepsilon)$ blows up, reflecting a loss of stability. This has significant implications for numerical methods like spectral and DG methods, as error estimates often depend on such stability constants.", "answer": "$$\\boxed{\\frac{1}{\\varepsilon}}$$", "id": "3371078"}, {"introduction": "A well-designed numerical scheme should create a discrete system that faithfully inherits the essential properties of the continuous PDE. This practice delves into the Fourier analysis of a Discontinuous Galerkin (DG) discretization to achieve this. You will analyze the scheme's discrete symbol to determine the precise conditions under which it remains \"discretely elliptic,\" ensuring that the numerical method accurately captures the physics and stability of the underlying continuous operator [@problem_id:3371093].", "problem": "Consider the constant-coefficient, linear, second-order operator in two space dimensions given by the quadratic form in spatial derivatives $a\\,\\partial_{xx} u + 2 b\\,\\partial_{xy} u + c\\,\\partial_{yy} u$, where $a0$ and $c0$ are fixed real parameters and $b \\in \\mathbb{R}$ is a coupling parameter. On a uniform Cartesian grid with mesh size $h$ and periodic boundary conditions, a symmetric interior penalty Discontinuous Galerkin (DG) discretization with a uniform choice of parameters leads to a translation-invariant semi-discrete operator whose Fourier symbol for the scalar mode is of the form\n$$\n\\sigma_{h}(\\boldsymbol{\\xi}) \\;=\\; -\\frac{1}{h^{2}} \\left[ \\, 4 a \\,\\sin^{2}\\!\\left(\\frac{\\xi_{x} h}{2}\\right) \\;+\\; 2 b \\,\\sin\\!\\left(\\xi_{x} h\\right)\\,\\sin\\!\\left(\\xi_{y} h\\right) \\;+\\; 4 c \\,\\sin^{2}\\!\\left(\\frac{\\xi_{y} h}{2}\\right) \\,\\right],\n$$\nfor the discrete wavevector $\\boldsymbol{\\xi}=(\\xi_{x},\\xi_{y})$ with $\\xi_{x},\\xi_{y}\\in[-\\pi/h,\\pi/h]$. The semi-discrete system is called discretely elliptic if $\\sigma_{h}(\\boldsymbol{\\xi}) \\le 0$ for all nonzero $\\boldsymbol{\\xi}$ and equals $0$ only at $\\boldsymbol{\\xi}=\\boldsymbol{0}$; it is called discretely hyperbolic if the symbol is indefinite in $\\boldsymbol{\\xi}$, that is, it attains both positive and negative values for different nonzero $\\boldsymbol{\\xi}$.\n\nUsing only the definition of the Fourier symbol, trigonometric identities, and the constant-coefficient classification criterion via definiteness of the quadratic form, determine the sharp threshold $b_{\\max}(a,c)$, expressed as a closed-form analytic function of $a$ and $c$ only, such that for all $|b|\\le b_{\\max}(a,c)$ the semi-discrete operator is discretely elliptic for every grid spacing $h0$, while for any $|b|b_{\\max}(a,c)$ the symbol becomes indefinite for some nonzero $\\boldsymbol{\\xi}$ and sufficiently small $h$. Your final answer must be a single closed-form expression in terms of $a$ and $c$ only.", "solution": "The problem requires determining the sharp threshold $b_{\\max}(a,c)$ for a parameter $b$ that defines the properties of a semi-discrete operator obtained from a Discontinuous Galerkin (DG) discretization. The operator is defined by its Fourier symbol,\n$$\n\\sigma_{h}(\\boldsymbol{\\xi}) \\;=\\; -\\frac{1}{h^{2}} \\left[ \\, 4 a \\,\\sin^{2}\\!\\left(\\frac{\\xi_{x} h}{2}\\right) \\;+\\; 2 b \\,\\sin\\!\\left(\\xi_{x} h\\right)\\,\\sin\\!\\left(\\xi_{y} h\\right) \\;+\\; 4 c \\,\\sin^{2}\\!\\left(\\frac{\\xi_{y} h}{2}\\right) \\,\\right]\n$$\nwhere $a0$, $c0$, $b \\in \\mathbb{R}$, $h0$ is the grid spacing, and $\\boldsymbol{\\xi}=(\\xi_x, \\xi_y)$ is the wavevector.\n\nThe problem states that the semi-discrete system is \"discretely elliptic\" if $\\sigma_{h}(\\boldsymbol{\\xi}) \\le 0$ for all nonzero $\\boldsymbol{\\xi}$ and $\\sigma_{h}(\\boldsymbol{\\xi})=0$ only for $\\boldsymbol{\\xi}=\\boldsymbol{0}$. Since $h^20$, the condition $\\sigma_{h}(\\boldsymbol{\\xi}) \\le 0$ is equivalent to the expression inside the brackets being non-negative. Let us define this expression as $S(\\boldsymbol{\\xi}, h)$:\n$$\nS(\\boldsymbol{\\xi}, h) = 4 a \\,\\sin^{2}\\!\\left(\\frac{\\xi_{x} h}{2}\\right) \\;+\\; 2 b \\,\\sin\\!\\left(\\xi_{x} h\\right)\\,\\sin\\!\\left(\\xi_{y} h\\right) \\;+\\; 4 c \\,\\sin^{2}\\!\\left(\\frac{\\xi_{y} h}{2}\\right)\n$$\nThe condition for discrete ellipticity is that $S(\\boldsymbol{\\xi}, h) \\ge 0$ for all $\\boldsymbol{\\xi}$ and that $S(\\boldsymbol{\\xi}, h) = 0$ only if $\\boldsymbol{\\xi} = \\boldsymbol{0}$.\n\nWe seek the threshold $b_{\\max}(a,c)$ such that for all $|b| \\le b_{\\max}(a,c)$, the operator is discretely elliptic for *every* grid spacing $h0$. This means the condition $S(\\boldsymbol{\\xi}, h) \\ge 0$ must hold for all valid $\\boldsymbol{\\xi}$ and for all $h0$.\n\nTo simplify the analysis, let us introduce non-dimensional wavenumbers $\\theta_x = \\frac{\\xi_x h}{2}$ and $\\theta_y = \\frac{\\xi_y h}{2}$. As $\\xi_x, \\xi_y$ range over $[-\\pi/h, \\pi/h]$, $\\theta_x, \\theta_y$ independently range over $[-\\pi/2, \\pi/2]$. We can use the trigonometric identity $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$ to rewrite the middle term:\n$$\n\\sin(\\xi_x h) = \\sin(2\\theta_x) = 2\\sin\\theta_x\\cos\\theta_x\n$$\n$$\n\\sin(\\xi_y h) = \\sin(2\\theta_y) = 2\\sin\\theta_y\\cos\\theta_y\n$$\nSubstituting these into the expression for $S$ gives:\n$$\nS(\\theta_x, \\theta_y) = 4a\\sin^2\\theta_x + 2b(2\\sin\\theta_x\\cos\\theta_x)(2\\sin\\theta_y\\cos\\theta_y) + 4c\\sin^2\\theta_y\n$$\n$$\nS(\\theta_x, \\theta_y) = 4a\\sin^2\\theta_x + 8b\\sin\\theta_x\\cos\\theta_x\\sin\\theta_y\\cos\\theta_y + 4c\\sin^2\\theta_y\n$$\nThe condition for discrete ellipticity is $S(\\theta_x, \\theta_y) \\ge 0$ for all $(\\theta_x, \\theta_y) \\in [-\\pi/2, \\pi/2]^2$, with equality holding only at $(\\theta_x, \\theta_y) = (0,0)$. For non-zero $\\theta_x, \\theta_y$ where the terms are not identically zero, we can rearrange the inequality to find a condition on $b$:\n$$\n8b\\sin\\theta_x\\cos\\theta_x\\sin\\theta_y\\cos\\theta_y \\ge - (4a\\sin^2\\theta_x + 4c\\sin^2\\theta_y)\n$$\nThe term multiplying $b$ can be positive or negative. To cover both cases, we use the absolute value. For the inequality to hold for any $b$ in the range $|b| \\le b_{\\max}$, $b_{\\max}$ must be less than or equal to the minimum value of the magnitude of the right-hand side divided by the magnitude of the coefficient of $b$.\n$$\n|b| \\le \\frac{4a\\sin^2\\theta_x + 4c\\sin^2\\theta_y}{|8\\sin\\theta_x\\cos\\theta_x\\sin\\theta_y\\cos\\theta_y|}\n$$\nThis inequality must hold for all $(\\theta_x, \\theta_y)$ in the domain where the denominator is non-zero. The sharpest possible threshold $b_{\\max}$ is therefore the global minimum of the right-hand side over this domain.\n$$\nb_{\\max}(a,c) = \\min_{(\\theta_x, \\theta_y) \\in (-\\pi/2, \\pi/2)^2 \\setminus \\{0\\}} \\frac{a\\sin^2\\theta_x + c\\sin^2\\theta_y}{2|\\sin\\theta_x\\cos\\theta_x\\sin\\theta_y\\cos\\theta_y|}\n$$\nLet's analyze the function to be minimized, which we denote as $g(\\theta_x, \\theta_y)$:\n$$\ng(\\theta_x, \\theta_y) = \\frac{a\\sin^2\\theta_x + c\\sin^2\\theta_y}{2|\\sin\\theta_x\\sin\\theta_y||\\cos\\theta_x\\cos\\theta_y|}\n$$\nWe can examine the numerator using the Arithmetic Mean-Geometric Mean (AM-GM) inequality, which states that for non-negative numbers $x$ and $y$, $x+y \\ge 2\\sqrt{xy}$.\n$$\na\\sin^2\\theta_x + c\\sin^2\\theta_y \\ge 2\\sqrt{(a\\sin^2\\theta_x)(c\\sin^2\\theta_y)} = 2\\sqrt{ac}|\\sin\\theta_x\\sin\\theta_y|\n$$\nSubstituting this lower bound for the numerator into the expression for $g(\\theta_x, \\theta_y)$:\n$$\ng(\\theta_x, \\theta_y) \\ge \\frac{2\\sqrt{ac}|\\sin\\theta_x\\sin\\theta_y|}{2|\\sin\\theta_x\\sin\\theta_y||\\cos\\theta_x\\cos\\theta_y|} = \\frac{\\sqrt{ac}}{|\\cos\\theta_x\\cos\\theta_y|}\n$$\nSince $\\theta_x, \\theta_y \\in (-\\pi/2, \\pi/2)$, we have $|\\cos\\theta_x| \\le 1$ and $|\\cos\\theta_y| \\le 1$. Thus, the denominator $|\\cos\\theta_x\\cos\\theta_y| \\le 1$. This leads to a lower bound for $g(\\theta_x, \\theta_y)$:\n$$\ng(\\theta_x, \\theta_y) \\ge \\sqrt{ac}\n$$\nThis shows that for any choice of $(\\theta_x, \\theta_y)$, the value of $g$ cannot be less than $\\sqrt{ac}$. To determine if $\\sqrt{ac}$ is the true minimum (the greatest lower bound), we need to check if this value can be approached.\n\nThe lower bound $\\sqrt{ac}$ is approached when two conditions are met simultaneously (in a limiting sense):\n1. The AM-GM inequality for the numerator approaches an equality. This occurs when $a\\sin^2\\theta_x = c\\sin^2\\theta_y$.\n2. The denominator $|\\cos\\theta_x\\cos\\theta_y|$ approaches its maximum value of $1$. This occurs as $\\theta_x \\to 0$ and $\\theta_y \\to 0$.\n\nLet's examine the limit of $g(\\theta_x, \\theta_y)$ as $(\\theta_x, \\theta_y) \\to (0,0)$. In this limit, $\\sin\\theta \\approx \\theta$ and $\\cos\\theta \\approx 1$.\n$$\n\\lim_{(\\theta_x, \\theta_y) \\to (0,0)} g(\\theta_x, \\theta_y) = \\lim_{(\\theta_x, \\theta_y) \\to (0,0)} \\frac{a\\theta_x^2 + c\\theta_y^2}{2|\\theta_x \\theta_y|}\n$$\nTo make the AM-GM inequality an equality in this limit, we consider the path where $a\\theta_x^2 = c\\theta_y^2$, or $\\sqrt{a}|\\theta_x| = \\sqrt{c}|\\theta_y|$. Taking the limit along this path:\n$$\n\\lim_{\\theta_x \\to 0} \\frac{a\\theta_x^2 + a\\theta_x^2}{2|\\theta_x| \\sqrt{a/c}|\\theta_x|} = \\lim_{\\theta_x \\to 0} \\frac{2a\\theta_x^2}{2\\sqrt{a/c}\\theta_x^2} = \\frac{a}{\\sqrt{a/c}} = \\sqrt{ac}\n$$\nSince we have found a path along which $g(\\theta_x, \\theta_y)$ approaches $\\sqrt{ac}$, and we have proven that $g(\\theta_x, \\theta_y) \\ge \\sqrt{ac}$ everywhere, the global minimum of $g(\\theta_x, \\theta_y)$ is indeed $\\sqrt{ac}$.\n\nTherefore, the sharpest condition that guarantees discrete ellipticity for all $h0$ is $|b| \\le \\sqrt{ac}$. This means the threshold is $b_{\\max}(a,c) = \\sqrt{ac}$.\n\nFinally, we verify the second part of the problem statement: for any $|b|  \\sqrt{ac}$, the symbol becomes indefinite for sufficiently small $h$.\nWhen $h$ is small, $\\xi h$ is small for a fixed wavevector $\\boldsymbol{\\xi}$. We can use Taylor series approximations $\\sin(x) \\approx x$ and $\\sin^2(x/2) \\approx (x/2)^2$.\n$$\nS(\\boldsymbol{\\xi}, h) \\approx 4a\\left(\\frac{\\xi_x h}{2}\\right)^2 + 2b(\\xi_x h)(\\xi_y h) + 4c\\left(\\frac{\\xi_y h}{2}\\right)^2 = h^2(a\\xi_x^2 + 2b\\xi_x\\xi_y + c\\xi_y^2)\n$$\nThe expression $a\\xi_x^2 + 2b\\xi_x\\xi_y + c\\xi_y^2$ is a quadratic form in $(\\xi_x, \\xi_y)$. Its definiteness is determined by the discriminant of the underlying matrix $\\begin{pmatrix} a  b \\\\ b  c \\end{pmatrix}$, which is $ac-b^2$. If $|b|  \\sqrt{ac}$, then $b^2  ac$, so $ac-b^20$. This means the quadratic form is indefinite: it can take both positive and negative values for different choices of $(\\xi_x, \\xi_y)$. Consequently, for sufficiently small $h$, $S(\\boldsymbol{\\xi}, h)$ is indefinite, and so is $\\sigma_h(\\boldsymbol{\\xi})$. This corresponds to a discretely hyperbolic operator.\n\nThe analysis confirms that the boundary between the discretely elliptic and discretely hyperbolic regimes is precisely $|b| = \\sqrt{ac}$. Thus, the sharp threshold is $b_{\\max}(a,c) = \\sqrt{ac}$. This is notably the same condition required for the ellipticity of the original continuous differential operator.", "answer": "$$\n\\boxed{\\sqrt{ac}}\n$$", "id": "3371093"}, {"introduction": "Numerical methods, while powerful, can introduce artifacts that lead to a misinterpretation of the underlying physics. This exercise serves as a cautionary tale, demonstrating how a collocation spectral method can misclassify a degenerate parabolic operator as elliptic due to aliasing errors from inexact quadrature. Understanding this common pitfall is essential for the correct implementation and application of pseudospectral techniques for problems with variable coefficients or nonlinearities [@problem_id:3371120].", "problem": "Consider the linear second-order partial differential equation in two spatial variables,\n$$\\mathcal{L} u = a(x,y)\\,u_{xx} + 2\\,b(x,y)\\,u_{xy} + c(x,y)\\,u_{yy},$$\non the square domain $$\\Omega = [-1,1]^2,$$ with smooth polynomial coefficients chosen in the structured form\n$$a(x,y)=p(x,y)^2,\\qquad b(x,y)=p(x,y)\\,q(x,y),\\qquad c(x,y)=q(x,y)^2,$$\nwhere $$p(x,y)$$ and $$q(x,y)$$ are nontrivial polynomials of total degree $$m\\ge 0.$$ By the standard classification of second-order linear partial differential equations in two variables, the type at a point is determined by the discriminant $$\\Delta(x,y) = b(x,y)^2 - a(x,y)c(x,y),$$ with $$\\Delta=0$$ indicating a parabolic operator, $$\\Delta0$$ an elliptic operator, and $$\\Delta0$$ a hyperbolic operator.\n\nIn this structured case, the principal symbol matrix\n$$\\mathbf{A}(x,y)=\\begin{pmatrix} a(x,y)  b(x,y) \\\\ b(x,y)  c(x,y)\\end{pmatrix}=\\begin{pmatrix} p^2  pq \\\\ pq  q^2 \\end{pmatrix}$$\nis pointwise positive semidefinite and\n$$\\Delta(x,y)=p(x,y)^2 q(x,y)^2 - p(x,y)^2 q(x,y)^2 = 0,$$\nso the operator is degenerate parabolic everywhere on $$\\Omega.$$\n\nNow consider a collocation spectral method on $$\\Omega$$ using a tensor-product polynomial space of total degree at most $$N$$, Legendre–Gauss–Lobatto nodes, exact differentiation matrices for polynomials up to degree $$N$$, and pseudo-spectral multiplication: products such as $$p(x,y)\\,u_x(x,y)$$ are formed pointwise at the collocation nodes and then implicitly represented in the degree-$$N$$ polynomial space through nodal interpolation. Global energy-like characterizations of type may be inferred from the positivity or semidefiniteness of the discrete principal quadratic form\n$$Q(u) = \\int_{\\Omega} \\big(a\\,u_x^2 + 2\\,b\\,u_x u_y + c\\,u_y^2\\big)\\,dx\\,dy = \\int_{\\Omega} \\big(p\\,u_x + q\\,u_y\\big)^2\\,dx\\,dy,$$\nwhich, in practice, is often approximated by Legendre–Gauss–Lobatto quadrature of order $$2N-1$$ applied to the nodal interpolation of the integrand.\n\nInvestigate the borderline case $$\\Delta=0$$ under aliasing: if $$m\\ge 1$$ (variable coefficients), the true integrand $$\\big(p\\,u_x + q\\,u_y\\big)^2$$ has polynomial degree up to $$2m + 2(N-1),$$ which generally exceeds the exactness degree $$2N-1$$ of the Legendre–Gauss–Lobatto rule. In such a setting, can a collocation spectral method misclassify the degenerate parabolic operator as elliptic when type is inferred from the definiteness of the discrete principal quadratic form, due to quadrature exactness and aliasing in pseudo-spectral products?\n\nSelect all statements that are correct:\n\nA. For constant coefficients $$m=0,$$ the collocation spectral method with Legendre–Gauss–Lobatto quadrature preserves the parabolic degeneracy: there exist nontrivial polynomial $$u_N$$ with $$p\\,u_x + q\\,u_y \\equiv 0,$$ and the discrete quadratic form remains semidefinite; however, for variable coefficients $$m\\ge 1,$$ aliasing of $$p\\,u_x$$ and $$q\\,u_y$$ and inexact quadrature can eliminate the discrete kernel and yield a strictly positive discrete principal form, leading to an apparent elliptic classification.\n\nB. Aliasing cannot affect type in a collocation spectral method because the discriminant $$\\Delta=b^2-ac$$ is known to be identically zero analytically, so the numerical procedure necessarily preserves parabolicity regardless of quadrature.\n\nC. Misclassification of a degenerate parabolic operator as elliptic due to quadrature exactness or aliasing is exclusive to the Discontinuous Galerkin (DG) method and cannot happen in a collocation spectral method.\n\nD. Overintegration (choosing a quadrature exact for degrees up to $$2m+2N-2$$ or using the three-halves de-aliasing rule) and coefficient pre-projection (projecting $$p$$ and $$q$$ into a lower-degree space so that $$p\\,u_x$$ and $$q\\,u_y$$ are exactly representable) are effective remedies that restore a semidefinite discrete principal form and preserve the correct parabolic classification.", "solution": "The user wants me to analyze the classification of a linear second-order partial differential equation under a collocation spectral method discretization.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **PDE:** $\\mathcal{L} u = a(x,y)\\,u_{xx} + 2\\,b(x,y)\\,u_{xy} + c(x,y)\\,u_{yy}$ on $\\Omega = [-1,1]^2$.\n-   **Coefficients:** $a(x,y)=p(x,y)^2$, $b(x,y)=p(x,y)\\,q(x,y)$, $c(x,y)=q(x,y)^2$, where $p(x,y)$ and $q(x,y)$ are nontrivial polynomials of total degree $m\\ge 0$.\n-   **Analytical Classification:** The discriminant is $\\Delta(x,y) = b^2 - ac = (pq)^2 - (p^2)(q^2) = 0$. This indicates the operator is degenerate parabolic everywhere.\n-   **Principal Quadratic Form (Continuous):** $Q(u) = \\int_{\\Omega} (p\\,u_x + q\\,u_y)^2\\,dx\\,dy$. This form is positive semidefinite, $Q(u) \\ge 0$. It equals zero if and only if $p\\,u_x + q\\,u_y \\equiv 0$, confirming the parabolic degeneracy.\n-   **Numerical Method:** Collocation spectral method using tensor-product polynomials of total degree up to $N$ ($\\mathcal{P}_N$) on Legendre–Gauss–Lobatto (LGL) nodes.\n-   **Numerical Operations:** Differentiation is exact for polynomials in $\\mathcal{P}_N$. Products like $p(x,y)\\,u_x(x,y)$ are handled pseudospectrally (pointwise multiplication at nodes).\n-   **Discrete Quadratic Form:** The continuous form $Q(u)$ is approximated by LGL quadrature. An LGL rule with $(N+1)$ points in each direction is exact for polynomials of degree up to $2N-1$.\n-   **The Core Issue (Aliasing):** The integrand $(p\\,u_x + q\\,u_y)^2$ is a polynomial. With $u_N \\in \\mathcal{P}_N$, its derivatives $u_{N,x}, u_{N,y}$ are in $\\mathcal{P}_{N-1}$. The coefficients $p,q$ have degree $m$. The term $V = p\\,u_{N,x} + q\\,u_{N,y}$ has degree up to $m+N-1$. The integrand $V^2$ has degree up to $2(m+N-1) = 2m+2N-2$.\n-   **Question:** The problem asks if, due to the quadrature being inexact for $m \\ge 1$ (since $2m+2N-2  2N-1$) and the associated aliasing, the spectral method can misclassify the degenerate parabolic operator as elliptic. An elliptic classification would correspond to the discrete quadratic form being strictly positive definite.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Groundedness:** The problem is firmly established in the theory of numerical analysis for PDEs, specifically spectral methods. All concepts—operator classification, discriminant, quadratic forms, collocation, LGL quadrature, pseudospectral methods, and aliasing—are standard and correctly defined.\n-   **Well-Posedness:** The question is conceptual (\"can...\") and has a definite answer based on the analysis of the discrete system's properties.\n-   **Objectivity:** The formulation is purely technical, using precise mathematical language.\n-   **Completeness and Consistency:** The problem provides all necessary definitions to analyze the situation. The setup is internally consistent.\n-   **Realism and Feasibility:** The scenario described is a classic and practical issue in the implementation of spectral methods for variable-coefficient problems.\n-   **Triviality:** The question is non-trivial; it requires a detailed understanding of how numerical discretization, particularly aliasing, affects the spectral properties of an operator.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the solution derivation.\n\n### Derivation and Option Analysis\n\nThe analytical operator is degenerate parabolic, characterized by the semidefiniteness of the quadratic form $Q(u) = \\int_{\\Omega} (p\\,u_x + q\\,u_y)^2\\,dx\\,dy \\ge 0$. The form is zero for any function $u$ in the kernel of the directional derivative operator $L_d = p\\,\\partial_x + q\\,\\partial_y$.\n\nThe numerical analysis is performed within the finite-dimensional polynomial space $\\mathcal{P}_N$. The discrete quadratic form is given by the application of LGL quadrature to the integrand evaluated at the collocation nodes $\\{\\vec{x}_j\\}$ with weights $\\{w_j\\}$:\n$$Q_h(u_N) = \\sum_j w_j \\left[ (p\\,u_{N,x} + q\\,u_{N,y})(\\vec{x}_j) \\right]^2$$\nfor $u_N \\in \\mathcal{P}_N$. Since the weights $w_j$ are positive, $Q_h(u_N) \\ge 0$. The discrete form is strictly positive definite (implying an elliptic classification) if $Q_h(u_N) = 0$ only for $u_N = \\text{const}$. This requires the expression $(p\\,u_{N,x} + q\\,u_{N,y})(\\vec{x}_j)$ to be zero at all collocation nodes $\\vec{x}_j$ only if $u_N$ is a constant.\n\nLet's analyze the cases based on the coefficient degree $m$.\n\n**Case 1: Constant Coefficients ($m=0$)**\nHere, $p$ and $q$ are constants. The term $V = p\\,u_{N,x} + q\\,u_{N,y}$ is a polynomial of degree at most $N-1$. The integrand $V^2$ is a polynomial of degree at most $2(N-1)$. Since $2(N-1)  2N-1$ (for $N \\ge 1$), the LGL quadrature rule is exact.\n$$Q_h(u_N) = \\int_{\\Omega} (p\\,u_{N,x} + q\\,u_{N,y})^2\\,dx\\,dy$$\nThe discrete form is zero if we can find a non-constant $u_N \\in \\mathcal{P}_N$ such that $p\\,u_{N,x} + q\\,u_{N,y} \\equiv 0$. The general solution to this first-order PDE is $u(x,y)=f(qy-px)$. We can easily choose a function $f$ such that $u_N$ is a non-trivial polynomial in $\\mathcal{P}_N$, for example $u_N(x,y) = (qy-px)^k$ for $1 \\le k \\le N$. For such a $u_N$, $Q_h(u_N) = 0$. Thus, the discrete quadratic form remains semidefinite, and the parabolic degeneracy is correctly preserved.\n\n**Case 2: Variable Coefficients ($m \\ge 1$)**\nThe degree of the integrand is $2m+2N-2$. Since $m \\ge 1$, $2m+2N-2 \\ge 2N$, which exceeds the degree of exactness $2N-1$ of the LGL quadrature. The quadrature is inexact. This inexactness is a manifestation of aliasing in the pseudospectral context.\nThe discrete quadratic form $Q_h(u_N)$ is zero if and only if the polynomial $V = p\\,u_{N,x} + q\\,u_{N,y}$ evaluates to zero at all collocation points $\\vec{x}_j$.\nThe key question is whether this implies $u_N$ must be constant. Let's consider a simple example with $m=1$: let $p(x,y)=x$ and $q(x,y)=y$. The condition for a zero of the quadratic form becomes $(x\\,u_{N,x} + y\\,u_{N,y})(\\vec{x}_j)=0$ for all nodes $\\vec{x}_j$.\nThe polynomial $V = x\\,u_{N,x} + y\\,u_{N,y}$ has degree at most $N$. A polynomial in $\\mathcal{P}_N$ that is zero at all $(N+1)^2$ LGL nodes must be identically zero. Therefore, we require $x\\,u_{N,x} + y\\,u_{N,y} \\equiv 0$. If $u_N = \\sum_{i+j \\le N} c_{ij}x^i y^j$, this condition becomes $\\sum (i+j)c_{ij}x^i y^j \\equiv 0$, which implies $(i+j)c_{ij} = 0$ for all $i,j$. This forces $c_{ij}=0$ for all $i+j \\ge 1$, meaning $u_N$ can only be a constant ($c_{00}$).\nIn this example, for any non-constant $u_N \\in \\mathcal{P}_N$, the polynomial $V$ is not identically zero, meaning $Q_h(u_N)  0$. The discrete quadratic form is positive definite (on the space of non-constant functions). This corresponds to an elliptic classification.\nThe continuous operator was parabolic, but the discrete counterpart is elliptic. The misclassification has occurred. This is a direct result of how the variable coefficients and derivatives are combined and evaluated on the discrete grid, a process fundamentally linked to aliasing effects when the products create polynomials of a degree too high for the grid to represent or the quadrature to integrate exactly.\n\nNow we evaluate the options based on this analysis.\n\n**A. For constant coefficients $m=0,$ the collocation spectral method with Legendre–Gauss–Lobatto quadrature preserves the parabolic degeneracy: there exist nontrivial polynomial $u_N$ with $p\\,u_x + q\\,u_y \\equiv 0,$ and the discrete quadratic form remains semidefinite; however, for variable coefficients $m\\ge 1,$ aliasing of $p\\,u_x$ and $q\\,u_y$ and inexact quadrature can eliminate the discrete kernel and yield a strictly positive discrete principal form, leading to an apparent elliptic classification.**\nThis statement is a perfect summary of our analysis. The $m=0$ case is handled correctly, preserving the semidefinite nature. The $m \\ge 1$ case can, as demonstrated, lead to a positive definite discrete form due to the effects of handling variable-coefficient products on a grid, which is described as \"aliasing and inexact quadrature\". The term \"eliminate the discrete kernel\" precisely describes what happened in our $p=x, q=y$ example, where the only function left in the kernel was the constant function.\n**Verdict: Correct.**\n\n**B. Aliasing cannot affect type in a collocation spectral method because the discriminant $$\\Delta=b^2-ac$$ is known to be identically zero analytically, so the numerical procedure necessarily preserves parabolicity regardless of quadrature.**\nThis statement is fundamentally incorrect. It wrongly assumes that a pointwise analytical property of a continuous operator must be inherited by its discrete approximation. Numerical methods can and often do fail to preserve such properties, and aliasing is a well-known source of such discrepancies. Our analysis of case $m \\ge 1$ provides a direct counterexample.\n**Verdict: Incorrect.**\n\n**C. Misclassification of a degenerate parabolic operator as elliptic due to quadrature exactness or aliasing is exclusive to the Discontinuous Galerkin (DG) method and cannot happen in a collocation spectral method.**\nThis statement is false. The mechanism for misclassification that we have just analyzed occurs squarely within a collocation spectral method. While similar issues can arise in DG methods, the problem is not exclusive to them. Pseudospectral collocation methods are particularly susceptible to aliasing errors from nonlinear or variable-coefficient terms.\n**Verdict: Incorrect.**\n\n**D. Overintegration (choosing a quadrature exact for degrees up to $$2m+2N-2$$ or using the three-halves de-aliasing rule) and coefficient pre-projection (projecting $$p$$ and $$q$$ into a lower-degree space so that $$p\\,u_x$$ and $$q\\,u_y$$ are exactly representable) are effective remedies that restore a semidefinite discrete principal form and preserve the correct parabolic classification.**\nThis statement proposes standard techniques to combat aliasing.\n-   **Overintegration:** Using a quadrature rule exact for the degree of the true integrand, $2m+2N-2$, would compute $Q(u_N) = \\int_{\\Omega} (p u_{N,x} + q u_{N,y})^2 dx dy$ exactly. This removes the error from inexact quadrature. If the problem was that aliasing/inexact quadrature destabilized a truly semidefinite discrete system, this would fix it. It restores the properties of the continuous operator restricted to $\\mathcal{P}_N$. In a context where aliasing is seen as the culprit that removes a kernel, overintegration is the direct remedy to prevent that removal.\n-   **Coefficient Pre-projection:** Projecting the coefficients $p,q$ onto a lower-degree polynomial space (e.g., constants, $k=0$) changes the operator to one that is known to be well-behaved by the discretization (as shown in the $m=0$ case). This is a common practical remedy.\nThese methods are precisely the standard \"de-aliasing\" strategies used to ensure the discrete system better reflects the continuous one. If aliasing causes the spurious elliptic classification as per statement A, then these de-aliasing techniques are the correct remedies to restore the intended semidefinite (parabolic) nature.\n**Verdict: Correct.**", "answer": "$$\\boxed{AD}$$", "id": "3371120"}]}