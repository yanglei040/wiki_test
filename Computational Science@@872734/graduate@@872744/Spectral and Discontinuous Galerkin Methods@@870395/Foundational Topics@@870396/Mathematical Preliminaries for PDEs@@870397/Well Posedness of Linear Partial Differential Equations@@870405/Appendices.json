{"hands_on_practices": [{"introduction": "The well-posedness of many elliptic boundary value problems hinges on the coercivity of an associated bilinear form, a key requirement of the Lax-Milgram theorem. This exercise reveals a profound connection between the spectral theory of differential operators and the functional analytic tools used to establish coercivity. By deriving the optimal Poincaré constant from the first eigenvalue of the Laplacian, you will directly quantify how the semi-norm involving the derivative controls the full $H^1$ norm, providing the critical ingredient for proving the stability of the Poisson problem [@problem_id:3429233].", "problem": "Consider the one-dimensional bounded domain $\\Omega=(0,L)$ with $L0$. Let $H_{0}^{1}(\\Omega)$ denote the Sobolev space of square-integrable functions on $\\Omega$ whose weak derivative is square-integrable and which vanish at the boundary in the sense of traces. The Poincaré inequality states that there exists a constant $C_{P}0$ such that for every $u\\in H_{0}^{1}(\\Omega)$ one has\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}\\,\\|u'\\|_{L^{2}(\\Omega)}.\n$$\nStarting from the spectral characterization of the Dirichlet Laplacian, namely the eigenvalue problem\n$$\n-\\frac{d^{2}}{dx^{2}}\\phi=\\lambda\\,\\phi \\quad \\text{in }(0,L),\\qquad \\phi(0)=\\phi(L)=0,\n$$\nand the variational characterization of the first eigenvalue via the Rayleigh quotient, derive the optimal (best) Poincaré constant $C_{P}$ for this domain. Your derivation must proceed from the foundational facts that the first Dirichlet eigenvalue minimizes the Rayleigh quotient and that the eigenfunctions form a complete orthogonal system in $L^{2}(\\Omega)$. You may, if you wish, use an expansion in the Fourier sine basis to justify optimality.\n\nExplain briefly how the optimal constant controls the coercivity of the energy bilinear form associated with the Poisson problem $-\\frac{d^{2}}{dx^{2}}u=f$ with homogeneous Dirichlet boundary conditions, and why this relates to well-posedness in the sense of the Lax–Milgram theorem. Do not state or assume the value of $C_{P}$ at the outset; compute it from first principles.\n\nProvide your final answer as a closed-form symbolic expression in terms of $L$. No numerical approximation is required.", "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- Domain: $\\Omega=(0,L)$ with $L0$.\n- Function space: $H_{0}^{1}(\\Omega)$, the Sobolev space of functions on $\\Omega$ that are square-integrable with a square-integrable weak derivative and vanish at the boundary.\n- Poincaré inequality: $\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}\\,\\|u'\\|_{L^{2}(\\Omega)}$ for every $u\\in H_{0}^{1}(\\Omega)$.\n- Eigenvalue problem for the Dirichlet Laplacian: $-\\frac{d^{2}}{dx^{2}}\\phi=\\lambda\\,\\phi$ in $(0,L)$, with boundary conditions $\\phi(0)=\\phi(L)=0$.\n- Task: Derive the optimal (best) constant $C_{P}$ from the spectral properties of the Dirichlet Laplacian and the variational characterization of its first eigenvalue.\n- Task: Explain the connection between $C_P$, the coercivity of the bilinear form for the Poisson problem, and well-posedness via the Lax–Milgram theorem.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard exercise in functional analysis and the theory of partial differential equations. The Poincaré inequality, Sobolev spaces, spectral theory of differential operators, and the Lax-Milgram theorem are all fundamental, well-established concepts in mathematics.\n- **Well-Posed:** The goal is to derive a specific, unique mathematical constant (the optimal Poincaré constant for the given domain). The directives are clear, leading to a unique solution.\n- **Objective:** The problem is stated in precise mathematical language, free of any subjectivity or ambiguity.\n- **Completeness:** The problem statement provides all necessary information and context to perform the derivation from first principles as requested.\n- **No other flaws were identified.**\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Optimal Poincaré Constant\n\nThe Poincaré inequality is given by $\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P} \\|u'\\|_{L^{2}(\\Omega)}$ for all $u \\in H_0^1(\\Omega)$. The optimal, or best, constant $C_P$ is the smallest value for which this inequality holds. This is equivalent to finding the supremum of the ratio:\n$$\nC_P = \\sup_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}}{\\|u'\\|_{L^{2}(\\Omega)}}\n$$\nSince all terms are non-negative, this is equivalent to finding the supremum of the squared ratio:\n$$\nC_P^2 = \\sup_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}^2}{\\|u'\\|_{L^{2}(\\Omega)}^2}\n$$\nThe problem requires us to relate this to the eigenvalue problem for the Dirichlet Laplacian, $-\\phi'' = \\lambda \\phi$. The variational characterization of the first (smallest) eigenvalue, $\\lambda_1$, is given by the minimum of the Rayleigh quotient:\n$$\n\\lambda_1 = \\min_{u \\in H_0^1(\\Omega), u \\neq 0} R(u) = \\min_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\langle -u'', u \\rangle_{L^2(\\Omega)}}{\\|u\\|_{L^2(\\Omega)}^2}\n$$\nThe inner product in the numerator can be simplified using integration by parts. For any $u \\in H_0^1(\\Omega)$, we have $u(0)=u(L)=0$.\n$$\n\\langle -u'', u \\rangle_{L^2(\\Omega)} = \\int_0^L \\left(-\\frac{d^2u}{dx^2}\\right) u \\, dx = -\\left[ u'(x)u(x) \\right]_0^L + \\int_0^L u'(x) u'(x) \\, dx = \\|u'\\|_{L^2(\\Omega)}^2\n$$\nThe boundary term vanishes due to the homogeneous Dirichlet conditions. Thus, the Rayleigh quotient is precisely:\n$$\nR(u) = \\frac{\\|u'\\|_{L^2(\\Omega)}^2}{\\|u\\|_{L^2(\\Omega)}^2}\n$$\nThe first eigenvalue $\\lambda_1$ is the infimum of this quotient. This implies that for any $u \\in H_0^1(\\Omega)$:\n$$\n\\lambda_1 \\leq \\frac{\\|u'\\|_{L^2(\\Omega)}^2}{\\|u\\|_{L^2(\\Omega)}^2}\n$$\nRearranging this inequality, we obtain:\n$$\n\\|u\\|_{L^2(\\Omega)}^2 \\leq \\frac{1}{\\lambda_1} \\|u'\\|_{L^2(\\Omega)}^2\n$$\nThis directly relates to the squared Poincaré inequality, suggesting $C_P^2 \\leq 1/\\lambda_1$.\n\nTo confirm that $1/\\lambda_1$ is the optimal value for $C_P^2$, we must show that this upper bound can be attained. The minimum of the Rayleigh quotient is achieved when $u$ is the first eigenfunction, $\\phi_1$. For $u = \\phi_1$, we have:\n$$\n\\frac{\\|\\phi_1'\\|_{L^2(\\Omega)}^2}{\\|\\phi_1\\|_{L^2(\\Omega)}^2} = \\lambda_1\n$$\nThis means that the supremum of the inverse ratio is:\n$$\n\\sup_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^2(\\Omega)}^2}{\\|u'\\|_{L^2(\\Omega)}^2} = \\left( \\inf_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\|u'\\|_{L^2(\\Omega)}^2}{\\|u\\|_{L^2(\\Omega)}^2} \\right)^{-1} = (\\lambda_1)^{-1} = \\frac{1}{\\lambda_1}\n$$\nTherefore, the optimal constant is $C_P^2 = 1/\\lambda_1$, which implies $C_P = 1/\\sqrt{\\lambda_1}$.\n\nTo find the value of $C_P$, we must compute $\\lambda_1$. We solve the eigenvalue problem:\n$$\n-\\frac{d^2\\phi}{dx^2} = \\lambda \\phi, \\quad \\phi(0)=0, \\quad \\phi(L)=0\n$$\nThe general solution to the ordinary differential equation is $\\phi(x) = A \\sin(\\sqrt{\\lambda}x) + B \\cos(\\sqrt{\\lambda}x)$.\nThe condition $\\phi(0)=0$ implies $A \\sin(0) + B \\cos(0) = 0$, so $B=0$.\nThe solution is of the form $\\phi(x) = A \\sin(\\sqrt{\\lambda}x)$.\nThe condition $\\phi(L)=0$ implies $A \\sin(\\sqrt{\\lambda}L) = 0$. For a non-trivial solution ($A \\neq 0$), we must have $\\sin(\\sqrt{\\lambda}L)=0$. This occurs when $\\sqrt{\\lambda}L = k\\pi$ for any integer $k \\ge 1$.\nThe eigenvalues are thus $\\lambda_k = \\left(\\frac{k\\pi}{L}\\right)^2$ for $k=1, 2, 3, \\ldots$.\nThe first and smallest eigenvalue corresponds to $k=1$:\n$$\n\\lambda_1 = \\left(\\frac{\\pi}{L}\\right)^2\n$$\nSubstituting this into our expression for the optimal Poincaré constant:\n$$\nC_P = \\frac{1}{\\sqrt{\\lambda_1}} = \\frac{1}{\\sqrt{(\\pi/L)^2}} = \\frac{1}{\\pi/L} = \\frac{L}{\\pi}\n$$\nThis derivation fulfills the requirement of using the variational characterization of the first eigenvalue. The optimality can be further justified by expanding an arbitrary function $u \\in H_0^1(\\Omega)$ in the Fourier sine basis $\\phi_k(x) = \\sin(k\\pi x/L)$, which are the eigenfunctions. This confirms that the ratio $\\|u\\|_{L^2}^2 / \\|u'\\|_{L^2}^2$ is maximized when $u$ is a multiple of the first eigenfunction $\\phi_1$.\n\n### Connection to Coercivity and Well-Posedness\n\nConsider the Poisson problem $-\\frac{d^2u}{dx^2} = f$ on $\\Omega=(0,L)$ with homogeneous Dirichlet boundary conditions $u(0)=u(L)=0$. Here $f \\in L^2(\\Omega)$ is given and we seek a solution $u \\in H_0^1(\\Omega)$.\nThe weak formulation is obtained by multiplying the PDE by a test function $v \\in H_0^1(\\Omega)$ and integrating over $\\Omega$:\n$$\n\\int_0^L \\left(-\\frac{d^2u}{dx^2}\\right) v \\, dx = \\int_0^L f v \\, dx\n$$\nIntegrating the left-hand side by parts gives:\n$$\n\\int_0^L \\frac{du}{dx}\\frac{dv}{dx} \\, dx - \\left[ \\frac{du}{dx} v \\right]_0^L = \\int_0^L f v \\, dx\n$$\nSince $v \\in H_0^1(\\Omega)$, $v(0)=v(L)=0$, and the boundary term vanishes. The weak formulation is: find $u \\in H_0^1(\\Omega)$ such that for all $v \\in H_0^1(\\Omega)$,\n$$\na(u,v) = F(v)\n$$\nwhere the energy bilinear form is $a(u,v) = \\int_0^L u'(x)v'(x)\\,dx$ and the linear functional is $F(v) = \\int_0^L f(x)v(x)\\,dx$.\n\nThe Lax-Milgram theorem guarantees the existence of a unique solution to this problem if the Hilbert space (here $H_0^1(\\Omega)$) is complete, $F$ is a continuous linear functional, and $a$ is a continuous and coercive bilinear form.\nCoercivity of $a(\\cdot,\\cdot)$ on the space $V=H_0^1(\\Omega)$ means there exists a constant $\\alpha > 0$ such that for all $v \\in V$:\n$$\na(v,v) \\ge \\alpha \\|v\\|_{V}^2\n$$\nThe natural norm on $H_0^1(\\Omega)$ is the $H^1$-norm, $\\|v\\|_{H^1(\\Omega)}^2 = \\|v\\|_{L^2(\\Omega)}^2 + \\|v'\\|_{L^2(\\Omega)}^2$.\nFor our problem, $a(v,v) = \\int_0^L (v')^2 \\, dx = \\|v'\\|_{L^2(\\Omega)}^2$. We need to relate this to $\\|v\\|_{H^1(\\Omega)}^2$. This is where the Poincaré inequality is essential.\n\nFrom the Poincaré inequality, we have $\\|v\\|_{L^2(\\Omega)}^2 \\le C_P^2 \\|v'\\|_{L^2(\\Omega)}^2$. We can then bound the $H^1$-norm:\n$$\n\\|v\\|_{H^1(\\Omega)}^2 = \\|v\\|_{L^2(\\Omega)}^2 + \\|v'\\|_{L^2(\\Omega)}^2 \\le C_P^2 \\|v'\\|_{L^2(\\Omega)}^2 + \\|v'\\|_{L^2(\\Omega)}^2 = (1+C_P^2)\\|v'\\|_{L^2(\\Omega)}^2\n$$\nBy rearranging, we can bound $\\|v'\\|_{L^2(\\Omega)}^2$ from below by the full $H^1$-norm:\n$$\n\\|v'\\|_{L^2(\\Omega)}^2 \\ge \\frac{1}{1+C_P^2} \\|v\\|_{H^1(\\Omega)}^2\n$$\nSubstituting this into the expression for $a(v,v)$:\n$$\na(v,v) = \\|v'\\|_{L^2(\\Omega)}^2 \\ge \\frac{1}{1+C_P^2} \\|v\\|_{H^1(\\Omega)}^2\n$$\nThis demonstrates that the bilinear form is coercive with a coercivity constant $\\alpha = (1+C_P^2)^{-1}$. Since we found the optimal Poincaré constant $C_P = L/\\pi$, the best possible coercivity constant derived this way is $\\alpha = (1+(L/\\pi)^2)^{-1}$.\n\nIn summary, the Poincaré inequality provides the critical estimate that allows the seminorm $\\|v'\\|_{L^2}$ (which appears in the energy bilinear form) to control the full $H^1$-norm on the space $H_0^1(\\Omega)$. This control directly establishes the coercivity of the bilinear form, a key condition for the Lax-Milgram theorem. The value of the Poincaré constant $C_P$ explicitly determines the coercivity constant $\\alpha$, thereby guaranteeing the well-posedness (existence and uniqueness of a stable solution) of the Poisson problem in the variational setting.", "answer": "$$\n\\boxed{\\frac{L}{\\pi}}\n$$", "id": "3429233"}, {"introduction": "When we discretize a partial differential equation, our goal is to create a numerical method that is stable, meaning that errors do not grow uncontrollably; this is the discrete analogue of well-posedness. This practice explores stability for the linear advection equation by examining how the choice of numerical flux—the rule for communicating information between discrete cells—governs the behavior of the scheme [@problem_id:3429165]. Through Fourier analysis, you will quantify the energy evolution for both central and upwind fluxes, revealing the crucial role of numerical dissipation in creating stable methods.", "problem": "Consider the linear advection equation in conservation form on a periodic interval, $u_{t} + a\\,u_{x} = 0,$ with constant advective speed $a0$ and periodic boundary conditions on $[0,L]$. Partition the domain into $N$ uniform cells of width $h=L/N$, and denote by $u_{j}(t)$ the representation of the discrete solution in cell $j$ under a degree-zero Discontinuous Galerkin (DG) method (equivalently, a conservative finite-volume method with exact cell averages). Use a consistent numerical flux at interfaces and consider the two choices:\n- central numerical flux, and\n- upwind numerical flux.\n\nAssume a discrete Fourier mode ansatz of the form \n$$u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta),$$\nwith nondimensional wavenumber $\\theta \\in [0,2\\pi)$, where $i=\\sqrt{-1}$. Let the semi-discrete evolution of this mode be \n$$\\frac{d}{dt}u_{j}(t) = \\lambda(\\theta)\\,u_{j}(t),$$\nwhere $\\lambda(\\theta)$ is the (complex) discrete symbol determined by the flux choice.\n\nDefine the discrete $L^{2}$ energy as \n$$E(t) = \\sum_{j=0}^{N-1} h\\,|u_{j}(t)|^{2},$$\nand the energy growth rate per unit energy as \n$$G(\\theta) := \\frac{1}{E(t)}\\frac{d}{dt}E(t).$$\n\nStarting from the conservation law and its weak form over each cell with numerical fluxes at interfaces, derive the semi-discrete updates for the degree-zero DG method for both central and upwind fluxes on a uniform mesh. Using the Fourier ansatz, obtain $\\lambda(\\theta)$ in each case, then compute $G(\\theta)$ in each case from first principles. Express your final answer as a single closed-form analytic expression for the difference $G_{\\text{up}}(\\theta)-G_{\\text{cen}}(\\theta)$ in terms of $a$, $h$, and $\\theta$. Do not introduce any additional nondimensional parameters. Your final answer must be a single symbolic expression.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard task in the numerical analysis of partial differential equations, specifically the von Neumann stability analysis (or discrete Fourier analysis) of finite volume / Discontinuous Galerkin schemes for the linear advection equation. All necessary information is provided, and the objective is clearly defined. We may therefore proceed with the derivation.\n\nOur starting point is the linear advection equation in one spatial dimension,\n$$\nu_{t} + a\\,u_{x} = 0\n$$\non a periodic domain $[0,L]$, with a constant advection speed $a > 0$. We discretize the domain into $N$ uniform cells $I_j = [x_{j-1/2}, x_{j+1/2}]$ for $j=0, 1, \\dots, N-1$, each of width $h = L/N$.\n\nThe degree-zero Discontinuous Galerkin (DG(0)) method, which is equivalent to a cell-averaged finite volume method, is formulated by integrating the PDE over a cell $I_j$ and multiplying by a constant test function (which is $1$ on $I_j$ and $0$ elsewhere). This yields:\n$$\n\\int_{x_{j-1/2}}^{x_{j+1/2}} u_t \\, dx + \\int_{x_{j-1/2}}^{x_{j+1/2}} a u_x \\, dx = 0\n$$\nLet $u_j(t)$ be the cell average of the solution in cell $I_j$, defined as $u_j(t) = \\frac{1}{h} \\int_{I_j} u(x,t) dx$. For a DG(0) method, the discrete solution is represented by these piecewise constant values. The first term becomes $h \\frac{d u_j}{dt}$. The second term is integrated to give $[a u]_{x_{j-1/2}}^{x_{j+1/2}} = a u(x_{j+1/2}, t) - a u(x_{j-1/2}, t)$. The equation for the cell average is thus:\n$$\n\\frac{d u_j}{dt} + \\frac{1}{h} \\left( a u(x_{j+1/2}, t) - a u(x_{j-1/2}, t) \\right) = 0\n$$\nSince the solution is discontinuous at cell interfaces, the physical flux $f(u) = a u$ must be replaced by a single-valued numerical flux, denoted $f^*(u_L, u_R)$, where $u_L$ and $u_R$ are the solution values to the left and right of an interface. At interface $x_{j+1/2}$, $u_L = u_j$ and $u_R = u_{j+1}$. The semi-discrete scheme becomes:\n$$\n\\frac{d u_j}{dt} = - \\frac{1}{h} \\left( f^*_{j+1/2} - f^*_{j-1/2} \\right)\n$$\nwhere $f^*_{j+1/2} = f^*(u_j, u_{j+1})$ and $f^*_{j-1/2} = f^*(u_{j-1}, u_j)$.\n\nWe now consider the two specified numerical fluxes.\n1.  **Central Flux**: The numerical flux is the average of the physical fluxes from the left and right states.\n    $$f^*_{\\text{cen}}(u_L, u_R) = \\frac{a u_L + a u_R}{2} = a \\frac{u_L + u_R}{2}$$\n    The semi-discrete scheme is:\n    $$\n    \\frac{d u_j}{dt} = - \\frac{1}{h} \\left( a \\frac{u_j + u_{j+1}}{2} - a \\frac{u_{j-1} + u_j}{2} \\right) = - \\frac{a}{2h} (u_{j+1} - u_{j-1})\n    $$\n\n2.  **Upwind Flux**: Since $a0$, the characteristic information propagates from left to right. The upwind flux takes the value from the upwind (left) state.\n    $$f^*_{\\text{up}}(u_L, u_R) = a u_L$$\n    The semi-discrete scheme is:\n    $$\n    \\frac{d u_j}{dt} = - \\frac{1}{h} \\left( a u_j - a u_{j-1} \\right) = - \\frac{a}{h} (u_j - u_{j-1})\n    $$\n\nNext, we analyze the behavior of these schemes by substituting the discrete Fourier mode ansatz, $u_j(t) = \\hat{u}(t)\\exp(i j \\theta)$, where $\\theta$ is the nondimensional wavenumber. The time evolution is given by $\\frac{d u_j}{dt} = \\lambda(\\theta) u_j$. Our goal is to find the symbol $\\lambda(\\theta)$ for each scheme.\n\nFor the **central flux scheme**:\n$$\n\\lambda_{\\text{cen}}(\\theta) u_j = - \\frac{a}{2h} \\left( \\hat{u}(t)\\exp(i(j+1)\\theta) - \\hat{u}(t)\\exp(i(j-1)\\theta) \\right)\n$$\nDividing by $u_j = \\hat{u}(t)\\exp(i j \\theta)$:\n$$\n\\lambda_{\\text{cen}}(\\theta) = - \\frac{a}{2h} \\left( \\exp(i\\theta) - \\exp(-i\\theta) \\right) = - \\frac{a}{2h} (2i\\sin\\theta) = - \\frac{ia}{h} \\sin\\theta\n$$\n\nFor the **upwind flux scheme**:\n$$\n\\lambda_{\\text{up}}(\\theta) u_j = - \\frac{a}{h} \\left( \\hat{u}(t)\\exp(ij\\theta) - \\hat{u}(t)\\exp(i(j-1)\\theta) \\right)\n$$\nDividing by $u_j$:\n$$\n\\lambda_{\\text{up}}(\\theta) = - \\frac{a}{h} \\left( 1 - \\exp(-i\\theta) \\right) = - \\frac{a}{h} \\left( 1 - (\\cos\\theta - i\\sin\\theta) \\right) = - \\frac{a}{h} (1 - \\cos\\theta + i\\sin\\theta)\n$$\n\nNow we derive the expression for the energy growth rate per unit energy, $G(\\theta)$. The discrete $L^2$ energy is $E(t) = \\sum_{j=0}^{N-1} h |u_j(t)|^2$. Its time derivative is:\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} \\left( h \\sum_{j=0}^{N-1} u_j \\bar{u}_j \\right) = h \\sum_{j=0}^{N-1} \\left( \\frac{du_j}{dt} \\bar{u}_j + u_j \\frac{d\\bar{u}_j}{dt} \\right)\n$$\nUsing the evolution equation $\\frac{du_j}{dt} = \\lambda(\\theta) u_j$ and its conjugate $\\frac{d\\bar{u}_j}{dt} = \\overline{\\lambda(\\theta)} \\bar{u}_j$:\n$$\n\\frac{dE}{dt} = h \\sum_{j=0}^{N-1} \\left( \\lambda(\\theta) u_j \\bar{u}_j + u_j \\overline{\\lambda(\\theta)} \\bar{u}_j \\right) = h \\sum_{j=0}^{N-1} (\\lambda(\\theta) + \\overline{\\lambda(\\theta)}) |u_j|^2\n$$\nSince $\\lambda + \\bar{\\lambda} = 2 \\text{Re}(\\lambda)$, we have:\n$$\n\\frac{dE}{dt} = 2 \\text{Re}(\\lambda(\\theta)) \\left( h \\sum_{j=0}^{N-1} |u_j|^2 \\right) = 2 \\text{Re}(\\lambda(\\theta)) E(t)\n$$\nThe energy growth rate per unit energy is therefore:\n$$\nG(\\theta) = \\frac{1}{E(t)}\\frac{dE}{dt} = 2 \\text{Re}(\\lambda(\\theta))\n$$\n\nWe can now compute $G(\\theta)$ for each flux choice.\nFor the **central flux**:\n$$\n\\lambda_{\\text{cen}}(\\theta) = - \\frac{ia}{h} \\sin\\theta\n$$\nThe real part is $\\text{Re}(\\lambda_{\\text{cen}}(\\theta)) = 0$. Thus, the energy growth rate is:\n$$\nG_{\\text{cen}}(\\theta) = 2 \\times 0 = 0\n$$\nThis confirms that the central flux scheme is energy-conserving (neutrally stable).\n\nFor the **upwind flux**:\n$$\n\\lambda_{\\text{up}}(\\theta) = - \\frac{a}{h} (1 - \\cos\\theta) - i\\frac{a}{h}\\sin\\theta\n$$\nThe real part is $\\text{Re}(\\lambda_{\\text{up}}(\\theta)) = - \\frac{a}{h} (1 - \\cos\\theta)$. The energy growth rate is:\n$$\nG_{\\text{up}}(\\theta) = - \\frac{2a}{h} (1 - \\cos\\theta)\n$$\nSince $a0$, $h0$, and $1-\\cos\\theta \\geq 0$, we have $G_{\\text{up}}(\\theta) \\le 0$, which indicates that the upwind scheme is dissipative and hence stable.\n\nFinally, we compute the required difference, $G_{\\text{up}}(\\theta) - G_{\\text{cen}}(\\theta)$:\n$$\nG_{\\text{up}}(\\theta) - G_{\\text{cen}}(\\theta) = \\left( - \\frac{2a}{h} (1 - \\cos\\theta) \\right) - 0 = - \\frac{2a}{h} (1 - \\cos\\theta)\n$$\nThis expression represents the numerical dissipation introduced by the upwind flux relative to the non-dissipative central flux.", "answer": "$$\n\\boxed{- \\frac{2a}{h} (1 - \\cos\\theta)}\n$$", "id": "3429165"}, {"introduction": "Theoretical stability estimates provide a rigorous guarantee that a numerical scheme is well-behaved, but their true power is realized when connected to a working implementation. This hands-on exercise bridges the gap between theory and practice by tasking you with both deriving and computationally verifying a stability bound for a Discontinuous Galerkin (DG) method [@problem_id:3429139]. By solving the steady advection-reaction equation, you will prove that the discrete solution's $L^2$ norm is controlled by the problem's data and then confirm this guarantee with your own DG solver, solidifying your understanding of how well-posedness theory translates into reliable scientific software.", "problem": "Consider the steady one-dimensional advection–reaction boundary value problem on the interval $[0,1]$\n$$ a\\,\\frac{d u}{dx}(x) + c\\,u(x) = f(x), \\quad x\\in(0,1), $$\nwith constant advection speed $a0$, constant reaction coefficient $c0$, and inflow Dirichlet boundary condition\n$$ u(0) = g. $$\nThe goal is to implement an upwind Discontinuous Galerkin (DG) method and then compute a computable upper bound for the discrete solution in terms of the data, using only discrete inflow boundary integrals and the source term. The discrete solution bound must be expressed in terms of the $L^2$ norm (square-integrable norm) of the source data $f$ and an inflow boundary quantity (based on the inflow velocity and the boundary value $g$). The program must verify, for each test case, whether the computed discrete solution satisfies the derived bound.\n\nDefinitions and discretization requirements:\n- Discontinuous Galerkin (DG): Use the space of piecewise polynomials of degree at most one (linear polynomials) on a uniform partition of $[0,1]$ into $N$ elements $\\{K_i\\}_{i=0}^{N-1}$, where $K_i=(x_i,x_{i+1})$ and $x_i=i/N$.\n- Basis functions and mapping: On each element, map the reference interval $\\xi\\in[-1,1]$ to $x\\in[x_i,x_{i+1}]$ by $x(\\xi)=\\frac{h}{2}(\\xi+1)+x_i$, where $h=1/N$. Use the reference basis $\\{\\phi_0(\\xi),\\phi_1(\\xi)\\}=\\{1,\\xi\\}$ and the same basis for testing.\n- Elementwise weak formulation: For each element $K$ with local test function $v$, derive the weak form by integrating the advection term by parts and using the upwind numerical flux for $a0$ at each face. The reaction term remains as an element volume term. The volume source term is $\\int_K f\\,v\\,dx$.\n- Upwind numerical flux: At an interior face located at the right endpoint of element $K$ (which is the left endpoint of element $K+1$), use the upwind value from the upstream side. Since $a0$, the upwind trace is the value from the left (upstream) element. At the inflow boundary $x=0$, the upwind trace is the boundary value $g$. At the outflow boundary $x=1$, the upwind trace is the interior value from the last element.\n- Linear system assembly: Assemble a global linear system $A\\mathbf{u}=\\mathbf{b}$ where $\\mathbf{u}$ contains all local degrees of freedom. Include:\n  - The volume advection term $-\\int_K a\\,u\\,v'\\,dx$,\n  - The reaction term $\\int_K c\\,u\\,v\\,dx$,\n  - The face terms $\\sum_{\\partial K} a\\,u^\\star v$ with upwind flux $u^\\star$,\n  - The source term $\\int_K f\\,v\\,dx$ and the inflow boundary value through the upwind flux at $x=0$.\n- Discrete $L^2$ norm of the solution: Compute $\\|u_h\\|_{L^2(0,1)}$ exactly with respect to the chosen basis as a quadratic form using the element mass matrix with unit weight (no reaction).\n\nBound requirement:\n- Starting from the integrated-by-parts DG formulation with upwind numerical flux and testing with the discrete solution itself, derive a computable bound on the discrete solution’s $L^2$ norm that depends only on the source data $f$, the inflow boundary data $g$, and the parameters $a$ and $c$, using discrete inflow boundary integrals. Implement the bound computation in your program and verify that the discrete solution satisfies the bound for each test case.\n- The inflow boundary integral must be a quantity supported only at the inflow boundary consistent with the upwind flux for $a0$. The source contribution must use the $L^2$ norm of $f$.\n\nNumerical integration:\n- Use accurate numerical quadrature (e.g., Gauss–Legendre) for the element integrals of the source term and for computing $\\|f\\|_{L^2(0,1)}$.\n\nTest suite:\nImplement your program to solve and verify the bound for the following four test cases. For each case, the domain is $[0,1]$, the degree is one (linear polynomials), and the advection speed satisfies $a0$. No physical units are used; all quantities are dimensionless real numbers.\n1. Case A (general “happy path”): $N=20$, $a=1.0$, $c=0.5$, $g=1.0$, $f(x)=1.0$.\n2. Case B (smooth source, zero inflow): $N=50$, $a=2.0$, $c=1.0$, $g=0.0$, $f(x)=\\sin(\\pi x)$, where angles are in radians.\n3. Case C (small reaction, dominant inflow): $N=5$, $a=0.8$, $c=0.1$, $g=2.0$, $f(x)=0.0$.\n4. Case D (single element, strong reaction, mixed-sign inflow): $N=1$, $a=3.0$, $c=5.0$, $g=-1.0$, $f(x)=e^{x}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets. Each boolean should be true if the computed discrete solution norm satisfies the derived bound for the corresponding test case, and false otherwise. For example:\n\"[True,False,True,True]\".", "solution": "The user has requested a solution to a one-dimensional steady advection-reaction boundary value problem using an upwind Discontinuous Galerkin (DG) method, including the derivation and verification of a stability bound on the discrete solution.\n\n### Step 1: Problem Validation\n\nThe provided problem statement is subjected to rigorous validation.\n\n**1.1. Extracted Givens:**\n- **Equation**: $a\\,\\frac{d u}{dx}(x) + c\\,u(x) = f(x)$ on $x\\in(0,1)$, with constant advection speed $a0$ and reaction coefficient $c0$.\n- **Boundary Condition**: Inflow Dirichlet condition $u(0) = g$.\n- **Discretization Method**: Upwind Discontinuous Galerkin (DG) on a uniform partition of $[0,1]$ into $N$ elements $K_i=(x_i,x_{i+1})$, where $x_i=i/N$.\n- **Approximation Space**: Piecewise polynomials of degree at most one ($P^1$).\n- **Basis**: On the reference element $\\xi \\in [-1,1]$, the basis is $\\{\\phi_0(\\xi), \\phi_1(\\xi)\\} = \\{1, \\xi\\}$.\n- **Weak Formulation**: Integrate by parts, use upwind numerical flux for $a0$. $u^\\star$ at an interface is the value from the upstream (left) side. At the inflow $x=0$, $u^\\star=g$.\n- **System Assembly**: Construct and solve the global linear system $A\\mathbf{u}=\\mathbf{b}$.\n- **Solution Bound**: Derive a computable upper bound for the $L^2$ norm of the discrete solution, $\\|u_h\\|_{L^2(0,1)}$, based on $\\|f\\|_{L^2(0,1)}$, $g$, $a$, and $c$. The computed solution must be verified against this bound.\n- **Numerical Integration**: Accurate quadrature is required for integrals involving the source term $f(x)$.\n- **Test Cases**: Four specific cases (A, B, C, D) are provided with parameters $(N, a, c, g)$ and source function $f(x)$. All quantities are dimensionless.\n- **Output**: A list of booleans indicating if the bound is satisfied for each case.\n\n**1.2. Validation Verdict:**\nThe problem is **valid**. It is a well-posed, scientifically sound problem from the field of numerical analysis for partial differential equations. The requirements for the discretization, weak formulation, and stability analysis are standard and clearly defined. The problem is self-contained, with all necessary data provided. It is a non-trivial but feasible task.\n\n### Step 2: DG Formulation\nLet $V_h = \\{ v \\in L^2(0,1) : v|_{K_i} \\in P^1(K_i) \\text{ for } i=0, \\dots, N-1 \\}$ be the space of piecewise linear polynomials on a uniform mesh of size $h=1/N$. The DG formulation for the problem is to find $u_h \\in V_h$ such that for all test functions $v_h \\in V_h$:\n$$ \\sum_{i=0}^{N-1} \\int_{K_i} \\left(a \\frac{du_h}{dx} + c u_h\\right) v_h \\,dx = \\sum_{i=0}^{N-1} \\int_{K_i} f v_h \\,dx $$\nIntegrating the advection term by parts on each element $K_i=(x_i, x_{i+1})$ yields:\n$$ -\\int_{K_i} a u_h \\frac{dv_h}{dx} \\,dx + \\left[ a u_h v_h \\right]_{x_i}^{x_{i+1}} = -\\int_{K_i} a u_h \\frac{dv_h}{dx} \\,dx + a u_h(x_{i+1}^-) v_h(x_{i+1}^-) - a u_h(x_i^+) v_h(x_i^+) $$\nSumming over all elements and replacing the exact solution $u_h$ at interfaces with a numerical flux $u_h^\\star$, we obtain the global weak form:\n$$ B(u_h, v_h) = L(v_h) $$\n$$ \\sum_{i=0}^{N-1} \\left( -\\int_{K_i} a u_h \\frac{dv_h}{dx} \\,dx + \\int_{K_i} c u_h v_h \\,dx \\right) + \\sum_{i=0}^{N-1} \\left( a u_h^\\star(x_{i+1}) v_h(x_{i+1}^-) - a u_h^\\star(x_i) v_h(x_i^+) \\right) = \\int_0^1 f v_h \\,dx $$\nFor $a0$, the upwind flux is defined as $u_h^\\star(x_i) = u_h(x_i^-)$ for interior and outflow faces ($i=1, \\dots, N$), and $u_h^\\star(x_0) = g$ at the inflow boundary.\n\n### Step 3: Derivation of the Stability Bound\nTo derive the stability bound, we set the test function $v_h = u_h$. The equation becomes:\n$$ \\sum_{i=0}^{N-1} \\left( -\\int_{K_i} a u_h \\frac{du_h}{dx} \\,dx + \\int_{K_i} c u_h^2 \\,dx \\right) + \\sum_{i=0}^{N-1} \\left( a u_h^\\star(x_{i+1}) u_h(x_{i+1}^-) - a u_h^\\star(x_i) u_h(x_i^+) \\right) = \\int_0^1 f u_h \\,dx $$\nLet's analyze the advection terms. The volume integral on $K_i$ is $-\\int_{K_i} \\frac{a}{2} \\frac{d}{dx}(u_h^2) \\,dx = -\\frac{a}{2} [u_h^2(x_{i+1}^-) - u_h^2(x_i^+)]$. The full DG form with $v_h = u_h$ simplifies after careful summation of face and volume terms (a standard DG stability analysis step) to:\n$$ c \\|u_h\\|_{L^2(0,1)}^2 + \\frac{a}{2} u_h(x_N^-)^2 + \\frac{a}{2}\\sum_{i=1}^{N-1} \\llbracket u_h \\rrbracket(x_i)^2 + \\frac{a}{2} g^2 = \\int_0^1 f u_h \\,dx + a g u_h(x_0^+) $$\nThe above equation is not quite right. After careful re-derivation, the correct energy balance obtained by testing with $u_h$ and using the upwind flux is:\n$$ c \\|u_h\\|_{L^2(0,1)}^2 + \\frac{a}{2} u_h(x_N^-)^2 + \\frac{a}{2}\\sum_{i=1}^{N-1} \\llbracket u_h \\rrbracket(x_i)^2 + \\frac{a}{2} (u_h(x_0^+) - g)^2 = \\int_0^1 f u_h \\,dx + \\frac{a}{2} g^2 $$\nwhere $\\llbracket u_h \\rrbracket(x_i) = u_h(x_i^+) - u_h(x_i^-)$ is the jump at interior faces. Since $a0$ and $c0$, all terms on the left-hand side are non-negative. Dropping the non-negative jump and boundary terms provides an inequality:\n$$ c \\|u_h\\|_{L^2(0,1)}^2 \\le \\int_0^1 f u_h \\,dx + \\frac{a}{2} g^2 $$\nApplying the Cauchy-Schwarz inequality to the integral, $|\\int f u_h \\,dx| \\le \\|f\\|_{L^2(0,1)} \\|u_h\\|_{L^2(0,1)}$, we get:\n$$ c \\|u_h\\|_{L^2(0,1)}^2 \\le \\|f\\|_{L^2(0,1)} \\|u_h\\|_{L^2(0,1)} + \\frac{a}{2} g^2 $$\nThis is a quadratic inequality of the form $c X^2 - \\|f\\|_{L^2(0,1)} X - \\frac{a}{2} g^2 \\le 0$ for $X = \\|u_h\\|_{L^2(0,1)}$. Solving for the positive root of the corresponding quadratic equation gives the upper bound:\n$$ \\|u_h\\|_{L^2(0,1)} \\le \\frac{\\|f\\|_{L^2(0,1)} + \\sqrt{\\|f\\|_{L^2(0,1)}^2 + 2ac g^2}}{2c} $$\nThis expression provides a computable upper bound for the $L^2$-norm of the discrete solution in terms of the problem data.\n\n### Step 4: Discretization and Implementation\nOn each element $K_i$, the solution is $u_h(x) = u_{i,0}\\phi_0(\\xi) + u_{i,1}\\phi_1(\\xi)$, where $\\xi(x) = 2(x-x_i)/h - 1$. The DG formulation leads to a $2N \\times 2N$ global linear system $A\\mathbf{u}=\\mathbf{b}$. Due to the upwind flux, the system matrix $A$ is block lower bidiagonal. This structure allows for an efficient solution via block forward substitution.\nThe block matrices for element $i$ coupling with element $i-1$ are:\n- $A_{ii} = \\begin{pmatrix} ch+a  a \\\\ -a  ch/3+a \\end{pmatrix}$\n- $A_{i, i-1} = \\begin{pmatrix} -a  -a \\\\ a  a \\end{pmatrix}$\nThe system is solved iteratively for the coefficient vectors $\\mathbf{u}_i$:\n- For $i=0$:\n$$ A_{00} \\mathbf{u}_0 = \\mathbf{f}_0 + a g \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n- For $i0$:\n$$ A_{ii} \\mathbf{u}_i = \\mathbf{f}_i - A_{i, i-1} \\mathbf{u}_{i-1} $$\nwhere $\\mathbf{f}_i$ is the source vector on element $K_i$. Integrals for $\\mathbf{f}_i$ and for the $L^2$ norms are computed using high-order Gauss-Legendre quadrature. The discrete $L^2$ norm is computed exactly from the solution coefficients: $\\|u_h\\|_{L^2(0,1)}^2 = \\sum_{i=0}^{N-1} \\left( h (u_{i,0})^2 + \\frac{h}{3} (u_{i,1})^2 \\right)$. The program will implement this solver, calculate the solution norm and the theoretical bound, and verify the inequality for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve_and_verify(N, a, c, g, f_func):\n    \"\"\"\n    Implements a Discontinuous Galerkin method for the 1D advection-reaction\n    problem, computes the L2 norm of the solution, and verifies it against a\n    derived stability bound.\n\n    Args:\n        N (int): Number of elements in the mesh.\n        a (float): Advection speed (a > 0).\n        c (float): Reaction coefficient (c > 0).\n        g (float): Inflow boundary value at x=0.\n        f_func (callable): Source function f(x).\n\n    Returns:\n        bool: True if the computed norm satisfies the bound, False otherwise.\n    \"\"\"\n    # 1. Setup\n    h = 1.0 / N\n    # Use a sufficiently high order quadrature for general source functions\n    num_quad_points = 10\n    quad_points, quad_weights = roots_legendre(num_quad_points)\n    \n    # Local basis functions on reference element [-1, 1]: phi_0(xi)=1, phi_1(xi)=xi\n    phi = [lambda xi: 1.0 + 0 * xi, lambda xi: xi]\n\n    # 2. Precompute Local Matrices\n    # Diagonal block of the global matrix A\n    A_diag = np.array([\n        [c * h + a, a],\n        [-a, c * h / 3.0 + a]\n    ])\n    \n    # Off-diagonal block of the global matrix A\n    A_offdiag = np.array([\n        [-a, -a],\n        [a, a]\n    ])\n    \n    A_diag_inv = np.linalg.inv(A_diag)\n    b_bc = np.array([a * g, -a * g])\n\n    # 3. Solve system by block forward substitution\n    all_coeffs = np.zeros(2 * N)\n    u_prev = np.zeros(2)\n\n    for i in range(N):\n        # Calculate source vector f_i for element K_i using quadrature\n        f_i = np.zeros(2)\n        xi_to_x = lambda xi: i * h + h / 2.0 * (xi + 1.0)\n        \n        for q_idx in range(num_quad_points):\n            xi_q = quad_points[q_idx]\n            w_q = quad_weights[q_idx]\n            x_q = xi_to_x(xi_q)\n            \n            f_val = f_func(x_q)\n            for j in range(2):\n                f_i[j] += f_val * phi[j](xi_q) * w_q\n        \n        f_i *= h / 2.0\n        \n        # Assemble RHS vector b_i for the current element\n        if i == 0:\n            b_i = f_i + b_bc\n        else:\n            b_i = f_i - A_offdiag @ u_prev\n            \n        # Solve for local coefficients u_i\n        u_i = A_diag_inv @ b_i\n        \n        # Store coefficients and update for next iteration\n        all_coeffs[2 * i : 2 * i + 2] = u_i\n        u_prev = u_i\n\n    # 4. Compute L2 norm of the discrete solution u_h\n    norm_u_sq = 0.0\n    for i in range(N):\n        u_i = all_coeffs[2 * i : 2 * i + 2]\n        # Contribution from element i: u_i^T * M_i * u_i\n        # where M_i is the local mass matrix diag(h, h/3)\n        norm_u_sq += h * u_i[0]**2 + (h / 3.0) * u_i[1]**2\n    norm_u = np.sqrt(norm_u_sq)\n\n    # 5. Compute L2 norm of the source function f\n    norm_f_sq = 0.0\n    for i in range(N):\n        xi_to_x = lambda xi: i * h + h / 2.0 * (xi + 1.0)\n        integral_on_element = 0.0\n        for q_idx in range(num_quad_points):\n            xi_q = quad_points[q_idx]\n            w_q = quad_weights[q_idx]\n            x_q = xi_to_x(xi_q)\n            integral_on_element += f_func(x_q)**2 * w_q\n        norm_f_sq += integral_on_element * (h / 2.0)\n    norm_f = np.sqrt(norm_f_sq)\n\n    # 6. Compute the theoretical stability bound\n    # bound = (norm_f + sqrt(norm_f^2 + 2ac g^2)) / (2c)\n    if c = 0:\n        # Avoid division by zero, though problem states c>0.\n        bound = np.inf \n    else:\n        discriminant = norm_f**2 + 2.0 * a * c * g**2\n        bound = (norm_f + np.sqrt(discriminant)) / (2.0 * c)\n\n    # 7. Verify if the computed norm satisfies the bound\n    # A small tolerance is added to account for floating point inaccuracies.\n    return norm_u = bound + 1e-9\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {'id': 'A', 'N': 20, 'a': 1.0, 'c': 0.5, 'g': 1.0, 'f': lambda x: 1.0},\n        {'id': 'B', 'N': 50, 'a': 2.0, 'c': 1.0, 'g': 0.0, 'f': lambda x: np.sin(np.pi * x)},\n        {'id': 'C', 'N': 5, 'a': 0.8, 'c': 0.1, 'g': 2.0, 'f': lambda x: 0.0},\n        {'id': 'D', 'N': 1, 'a': 3.0, 'c': 5.0, 'g': -1.0, 'f': lambda x: np.exp(x)},\n    ]\n\n    results = []\n    for case in test_cases:\n        is_satisfied = solve_and_verify(\n            case['N'], case['a'], case['c'], case['g'], case['f']\n        )\n        results.append(is_satisfied)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3429139"}]}