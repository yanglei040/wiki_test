{"hands_on_practices": [{"introduction": "A crucial step in applying variational methods is translating the continuous problem into a discrete algebraic system. This practice guides you through the explicit construction of the mass and stiffness matrices for a Legendre spectral Galerkin discretization of the Poisson equation. By analyzing the structure of these matrices, you will uncover one of the key advantages of this approach: the remarkably favorable conditioning of the resulting linear system as the polynomial degree $p$ increases. [@problem_id:3426358]", "problem": "Consider the one-dimensional Poisson Partial Differential Equation (PDE)\n$$\n- u''(x) = f(x), \\quad x \\in (-1,1),\n$$\nwith homogeneous Dirichlet boundary conditions\n$$\nu(-1) = 0, \\quad u(1) = 0.\n$$\nStarting from the classical variational formulation, which seeks $u \\in H_0^1(-1,1)$ such that\n$$\n\\int_{-1}^{1} u'(x) \\, v'(x) \\, dx = \\int_{-1}^{1} f(x) \\, v(x) \\, dx \\quad \\text{for all } v \\in H_0^1(-1,1),\n$$\nconstruct a spectral Galerkin method using the Legendre polynomial basis modified to satisfy the boundary conditions. Let $P_n(x)$ denote the Legendre polynomial of degree $n$, orthogonal with respect to the standard $L^2(-1,1)$ inner product, and define the Dirichlet-admissible Shen basis functions\n$$\n\\phi_k(x) = P_k(x) - P_{k+2}(x),\n$$\nfor $k = 0,1,\\dots,p-2$, which satisfy $\\phi_k(\\pm 1) = 0$.\n\n1. Derive the entries of the mass matrix $M \\in \\mathbb{R}^{(p-1)\\times(p-1)}$, defined by\n$$\nM_{kl} = \\int_{-1}^{1} \\phi_k(x) \\, \\phi_l(x) \\, dx,\n$$\nin terms of the Legendre polynomial orthogonality. Express the resulting structure explicitly in terms of $k$ and $l$.\n\n2. Derive the entries of the stiffness matrix $S \\in \\mathbb{R}^{(p-1)\\times(p-1)}$, defined by\n$$\nS_{kl} = \\int_{-1}^{1} \\phi_k'(x) \\, \\phi_l'(x) \\, dx,\n$$\nusing integration by parts and fundamental properties of Legendre polynomials, including their differential equation. Show the resulting structure explicitly.\n\n3. Using the explicit stiffness matrix derived in part 2, analyze the conditioning of $S$ as the polynomial degree $p$ increases. Provide the exact closed-form expression for the spectral condition number $\\kappa(S_p)$ as a function of $p$, where $\\kappa(S_p)$ is the ratio of the largest to the smallest eigenvalue of $S$.\n\nYour final answer must be a single closed-form analytic expression for $\\kappa(S_p)$, with no units. If you introduce any approximation, justify it and state its asymptotic regime. No rounding is required.", "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n-   **PDE**: $- u''(x) = f(x)$, for $x \\in (-1,1)$.\n-   **Boundary Conditions (BCs)**: Homogeneous Dirichlet, $u(-1) = 0$ and $u(1) = 0$.\n-   **Variational Formulation**: Seek $u \\in H_0^1(-1,1)$ such that $\\int_{-1}^{1} u'(x) v'(x) dx = \\int_{-1}^{1} f(x) v(x) dx$ for all $v \\in H_0^1(-1,1)$.\n-   **Basis Functions**: The Shen basis, $\\phi_k(x) = P_k(x) - P_{k+2}(x)$ for $k = 0, 1, \\dots, p-2$, where $P_n(x)$ is the Legendre polynomial of degree $n$.\n-   **Mass Matrix Definition**: $M_{kl} = \\int_{-1}^{1} \\phi_k(x) \\phi_l(x) dx$, with $k,l \\in \\{0, 1, \\dots, p-2\\}$.\n-   **Stiffness Matrix Definition**: $S_{kl} = \\int_{-1}^{1} \\phi_k'(x) \\phi_l'(x) dx$, with $k,l \\in \\{0, 1, \\dots, p-2\\}$.\n-   **Objective**:\n    1.  Derive the entries $M_{kl}$ of the mass matrix.\n    2.  Derive the entries $S_{kl}$ of the stiffness matrix.\n    3.  Derive the exact closed-form expression for the spectral condition number $\\kappa(S_p)$ of the stiffness matrix.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a standard application of the spectral Galerkin method to a well-known PDE (Poisson's equation). The use of Legendre polynomials and the specific Shen basis is a fundamental topic in the field of spectral methods. All concepts are mathematically rigorous.\n2.  **Well-Posed**: The problem is well-posed. The PDE with the given boundary conditions has a unique solution. The tasks are specific mathematical derivations.\n3.  **Objective**: The problem is stated in precise, objective mathematical language.\n4.  **Self-Contained and Consistent**: All necessary definitions are provided. The basis functions $\\phi_k(x)$ are correctly defined to satisfy the homogeneous Dirichlet boundary conditions, as $P_n(1) = 1$ and $P_n(-1) = (-1)^n$, which implies $\\phi_k(1) = P_k(1) - P_{k+2}(1) = 1 - 1 = 0$ and $\\phi_k(-1) = P_k(-1) - P_{k+2}(-1) = (-1)^k - (-1)^{k+2} = (-1)^k - (-1)^k = 0$.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n---\n\nThe spectral Galerkin method seeks an approximate solution of the form $u_p(x) = \\sum_{k=0}^{p-2} c_k \\phi_k(x)$. Substituting this into the variational formulation and choosing test functions $v(x) = \\phi_l(x)$ for $l=0, 1, \\dots, p-2$ leads to the linear system of equations $\\sum_{k=0}^{p-2} c_k S_{kl} = f_l$, where $S_{kl}$ are the entries of the stiffness matrix and $f_l = \\int_{-1}^{1} f(x) \\phi_l(x) dx$.\n\n### Part 1: Derivation of the Mass Matrix $M$\nThe entries of the mass matrix $M$ are given by $M_{kl} = \\int_{-1}^{1} \\phi_k(x) \\phi_l(x) dx$. We substitute the definition of the basis functions:\n$$\nM_{kl} = \\int_{-1}^{1} (P_k(x) - P_{k+2}(x))(P_l(x) - P_{l+2}(x)) dx\n$$\nExpanding the product, we get:\n$$\nM_{kl} = \\int_{-1}^{1} P_k(x)P_l(x) dx - \\int_{-1}^{1} P_k(x)P_{l+2}(x) dx - \\int_{-1}^{1} P_{k+2}(x)P_l(x) dx + \\int_{-1}^{1} P_{k+2}(x)P_{l+2}(x) dx\n$$\nWe use the orthogonality property of Legendre polynomials: $\\int_{-1}^{1} P_m(x) P_n(x) dx = \\frac{2}{2n+1} \\delta_{mn}$, where $\\delta_{mn}$ is the Kronecker delta. The integrals are non-zero only if the indices of the polynomials are equal. We analyze the non-zero cases for $M_{kl}$:\n\n1.  **Diagonal entries ($l=k$)**:\n    $$\n    M_{kk} = \\int_{-1}^{1} (P_k(x) - P_{k+2}(x))^2 dx = \\int_{-1}^{1} P_k(x)^2 dx + \\int_{-1}^{1} P_{k+2}(x)^2 dx = \\frac{2}{2k+1} + \\frac{2}{2(k+2)+1} = \\frac{2}{2k+1} + \\frac{2}{2k+5}\n    $$\n    The cross-term $\\int_{-1}^{1} -2 P_k(x) P_{k+2}(x) dx$ is zero due to orthogonality.\n\n2.  **Off-diagonal entries**: The integrals are non-zero only if an index from $\\{k, k+2\\}$ matches an index from $\\{l, l+2\\}$, and $k \\neq l$. This confines non-zero entries to $l=k\\pm2$.\n    -   Case $l=k+2$:\n        $$\n        M_{k, k+2} = \\int_{-1}^{1} (P_k(x) - P_{k+2}(x))(P_{k+2}(x) - P_{k+4}(x)) dx\n        $$\n        The only non-zero term from the expansion is $\\int_{-1}^{1} -P_{k+2}(x)^2 dx$:\n        $$\n        M_{k, k+2} = -\\frac{2}{2(k+2)+1} = -\\frac{2}{2k+5}\n        $$\n    -   Case $l=k-2$:\n        $$\n        M_{k, k-2} = \\int_{-1}^{1} (P_k(x) - P_{k+2}(x))(P_{k-2}(x) - P_k(x)) dx\n        $$\n        The only non-zero term is $\\int_{-1}^{1} -P_k(x)^2 dx$:\n        $$\n        M_{k, k-2} = -\\frac{2}{2k+1}\n        $$\n    By symmetry of the matrix ($M_{kl} = M_{lk}$), we can verify that $M_{k-2, k} = -\\frac{2}{2(k-2)+5} = -\\frac{2}{2k+1}$, which matches.\n\nThe mass matrix $M$ is a symmetric pentadiagonal matrix with entries:\n$$\nM_{kl} =\n\\begin{cases}\n\\frac{2}{2k+1} + \\frac{2}{2k+5} & \\text{if } l = k \\\\\n-\\frac{2}{2k+5} & \\text{if } l = k+2 \\\\\n-\\frac{2}{2k+1} & \\text{if } l = k-2 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nfor $k,l \\in \\{0, 1, \\dots, p-2\\}$.\n\n### Part 2: Derivation of the Stiffness Matrix $S$\nThe entries of the stiffness matrix $S$ are given by $S_{kl} = \\int_{-1}^{1} \\phi_k'(x) \\phi_l'(x) dx$.\nFirst, we find an expression for $\\phi_k'(x)$. We use the Legendre polynomial derivative recurrence relation:\n$$\nP'_{n+1}(x) - P'_{n-1}(x) = (2n+1)P_n(x)\n$$\nReplacing $n$ with $n+1$, we get:\n$$\nP'_{n+2}(x) - P'_{n}(x) = (2(n+1)+1)P_{n+1}(x) = (2n+3)P_{n+1}(x)\n$$\nThe derivative of our basis function $\\phi_k(x)$ is $\\phi_k'(x) = P_k'(x) - P_{k+2}'(x)$. Using the identity above with $n=k$:\n$$\n\\phi_k'(x) = P_k'(x) - P_{k+2}'(x) = -(2k+3)P_{k+1}(x)\n$$\nThis is a remarkably simple and powerful result. Now, we can compute the entries $S_{kl}$:\n$$\nS_{kl} = \\int_{-1}^{1} (-(2k+3)P_{k+1}(x)) (-(2l+3)P_{l+1}(x)) dx\n$$\n$$\nS_{kl} = (2k+3)(2l+3) \\int_{-1}^{1} P_{k+1}(x)P_{l+1}(x) dx\n$$\nUsing the orthogonality property of Legendre polynomials again:\n$$\n\\int_{-1}^{1} P_{k+1}(x)P_{l+1}(x) dx = \\frac{2}{2(k+1)+1} \\delta_{k+1, l+1} = \\frac{2}{2k+3} \\delta_{kl}\n$$\nThe Kronecker delta $\\delta_{k+1,l+1}$ is non-zero only if $k+1 = l+1$, which means $k=l$. Therefore, the stiffness matrix $S$ is diagonal.\nFor $k=l$, the diagonal entries are:\n$$\nS_{kk} = (2k+3)(2k+3) \\left(\\frac{2}{2k+3}\\right) = 2(2k+3)\n$$\nFor $k \\neq l$, $S_{kl} = 0$.\nThus, the stiffness matrix $S$ is a diagonal matrix with entries:\n$$\nS_{kl} = 2(2k+3) \\delta_{kl} \\quad \\text{for } k,l \\in \\{0, 1, \\dots, p-2\\}\n$$\nThe explicit diagonal entries are $S_{kk} = 4k+6$.\n\n### Part 3: Derivation of the Condition Number $\\kappa(S_p)$\nThe spectral condition number of a matrix is the ratio of its largest eigenvalue to its smallest eigenvalue, $\\kappa(S_p) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$.\nFor a diagonal matrix, the eigenvalues are simply its diagonal entries. The eigenvalues of $S_p$ are:\n$$\n\\lambda_k = S_{kk} = 2(2k+3) = 4k+6, \\quad \\text{for } k = 0, 1, \\dots, p-2\n$$\nThe eigenvalues form a strictly increasing arithmetic sequence.\nThe smallest eigenvalue, $\\lambda_{\\min}$, corresponds to the smallest index, $k=0$:\n$$\n\\lambda_{\\min} = \\lambda_0 = 4(0) + 6 = 6\n$$\nThe largest eigenvalue, $\\lambda_{\\max}$, corresponds to the largest index, $k=p-2$:\n$$\n\\lambda_{\\max} = \\lambda_{p-2} = 4(p-2) + 6 = 4p - 8 + 6 = 4p - 2\n$$\nThe spectral condition number of the stiffness matrix $S_p$ is therefore:\n$$\n\\kappa(S_p) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{4p - 2}{6} = \\frac{2(2p-1)}{2 \\cdot 3} = \\frac{2p-1}{3}\n$$\nThis expression is exact and does not involve any approximations. The conditioning of the stiffness matrix scales linearly with the polynomial degree $p$, i.e., $\\kappa(S_p) = O(p)$, which is highly favorable compared to standard finite difference or finite element discretizations where conditioning typically scales as $O(p^2)$.", "answer": "$$\n\\boxed{\\frac{2p-1}{3}}\n$$", "id": "3426358"}, {"introduction": "While variational forms are defined by continuous integrals, their practical implementation relies on numerical quadrature. This hands-on exercise requires you to determine the precise level of quadrature accuracy needed to exactly integrate the Symmetric Interior Penalty Galerkin (SIPG) bilinear form for a given polynomial degree $p$. Furthermore, it prompts a deeper analysis of how under-integration, a common practical issue, can compromise the stability of the method by destroying coercivity, even while preserving symmetry. [@problem_id:3426395]", "problem": "Consider the Symmetric Interior Penalty Galerkin (SIPG) method for the scalar Poisson equation on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with homogeneous Dirichlet boundary conditions. Let $\\mathcal{T}_{h}$ be a shape-regular mesh of $\\Omega$ with affine element mappings and faces $\\mathcal{E}_{h}$, and let the discrete trial and test space on each element $K \\in \\mathcal{T}_{h}$ be the space of scalar polynomials of total degree at most $p$, denoted $\\mathbb{P}_{p}(K)$. Assume a constant diffusion coefficient $\\kappa = 1$ and a standard SIPG bilinear form\n$$\na(u,v) \\;=\\; \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x \\;-\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] \\, \\mathrm{d}s \\;-\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![u]\\!] \\, \\mathrm{d}s \\;+\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\frac{\\sigma}{h_{e}} \\,[\\![u]\\!] \\,[\\![v]\\!] \\, \\mathrm{d}s,\n$$\nwhere $\\boldsymbol{n}_{e}$ is a fixed unit normal on the face $e$, $h_{e}$ is a face diameter, $\\sigma>0$ is the penalty parameter, $[\\![\\cdot]\\!]$ denotes the jump across $e$, and $\\{\\!\\{\\cdot\\}\\!\\}$ denotes the average across $e$. All mappings from reference elements are assumed affine so that Jacobians are constant.\n\nSuppose that numerical integration is performed elementwise and facewise using quadrature rules whose polynomial exactness degrees are $q_{\\mathrm{vol}}$ on each volume $K$ and $q_{\\mathrm{face}}$ on each face $e$, respectively. A quadrature rule on a set $D$ has polynomial exactness degree $q$ if it integrates exactly every scalar polynomial on $D$ of total degree at most $q$.\n\nStarting from the definitions of the discrete space $\\mathbb{P}_{p}(K)$, the jump and average operators, and the structure of the SIPG bilinear form, determine the minimal polynomial exactness degrees $q_{\\mathrm{vol}}$ and $q_{\\mathrm{face}}$ required to integrate all terms of $a(u,v)$ exactly for arbitrary $u,v \\in \\mathbb{P}_{p}(K)$ on each element. Report your result as a single row vector $(q_{\\mathrm{vol}},\\, q_{\\mathrm{face}})$.\n\nThen, using first principles of bilinear forms and discrete energy estimates, discuss how under-integration, in the sense $q_{\\mathrm{vol}} < 2p-2$ and/or $q_{\\mathrm{face}} < 2p$, affects the symmetry of the discrete bilinear form and the coercivity (positive definiteness) of $a(\\cdot,\\cdot)$ on the discontinuous Galerkin energy norm. No numerical rounding is required and no physical units are involved in the final answer.", "solution": "The problem is divided into two parts. First, we must determine the minimal polynomial exactness degrees, $q_{\\mathrm{vol}}$ and $q_{\\mathrm{face}}$, required for the exact evaluation of the Symmetric Interior Penalty Galerkin (SIPG) bilinear form using numerical quadrature. Second, we must discuss the qualitative effects of under-integration on the symmetry and coercivity of the resulting discrete system.\n\nLet the discrete space for trial and test functions be $V_{h}$, where for any $w \\in V_{h}$, its restriction to an element $K \\in \\mathcal{T}_{h}$ is a polynomial of total degree at most $p$, i.e., $w|_{K} \\in \\mathbb{P}_{p}(K)$. Let $u, v \\in V_{h}$ be two such functions. The SIPG bilinear form is given by:\n$$\na(u,v) = \\underbrace{\\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x}_{\\text{Term 1}} \\underbrace{- \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} (\\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![u]\\!]) \\, \\mathrm{d}s}_{\\text{Term 2}} \\underbrace{+ \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\frac{\\sigma}{h_{e}} \\,[\\![u]\\!] \\,[\\![v]\\!] \\, \\mathrm{d}s}_{\\text{Term 3}}\n$$\nWe analyze the polynomial degree of the integrand for each term to determine the required quadrature exactness.\n\n**Part 1: Minimal Quadrature Degrees**\n\n**Analysis of Term 1 (Volume Term):**\nThis term consists of an integral over each element $K \\in \\mathcal{T}_{h}$.\n- For a function $u \\in V_{h}$, its restriction to $K$ is $u|_{K} \\in \\mathbb{P}_{p}(K)$.\n- The gradient $\\nabla u$ is a vector whose components are partial derivatives of $u$. The differentiation operator reduces the polynomial degree by $1$. Therefore, the components of $\\nabla u|_{K}$ are polynomials of total degree at most $p-1$.\n- The integrand is the dot product $\\nabla u \\cdot \\nabla v$. This is a sum of products of polynomials of degree at most $p-1$. The product of two polynomials of degree $d_{1}$ and $d_{2}$ is a polynomial of degree $d_{1}+d_{2}$.\n- Thus, the integrand $\\nabla u \\cdot \\nabla v$ is a scalar polynomial on $K$ of total degree at most $(p-1) + (p-1) = 2p-2$.\n- To ensure this integral is computed exactly for any choice of $u, v \\in V_{h}$, the volume quadrature rule must be exact for all polynomials of degree up to $2p-2$.\n- The minimal polynomial exactness degree for the volume integral is therefore $q_{\\mathrm{vol}} = 2p-2$.\n\n**Analysis of Terms 2 and 3 (Face Terms):**\nThese terms involve integrals over the faces $e \\in \\mathcal{E}_{h}$ of the mesh. Since the element mappings are affine, a face $e$ is a flat $(d-1)$-dimensional domain.\n- The restriction of a polynomial $w \\in \\mathbb{P}_{p}(K)$ to a face $e \\subset \\partial K$ is a polynomial on $e$ of degree at most $p$.\n- The jump of a scalar function $v$ across an interior face $e$ between elements $K^{+}$ and $K^{-}$ is defined as $[\\![v]\\!] = v|_{K^{+}} - v|_{K^{-}}$. Since $v|_{K^{+}}$ and $v|_{K^{-}}$ are polynomials of degree at most $p$ on $e$, their difference $[\\![v]\\!]$ is also a polynomial of degree at most $p$ on $e$. For a boundary face, the jump is simply the trace of $v$.\n- The average of a vector function $\\boldsymbol{q}$ is $\\{\\!\\{\\boldsymbol{q}\\}\\} = \\frac{1}{2}(\\boldsymbol{q}|_{K^{+}} + \\boldsymbol{q}|_{K^{-}})$. The gradient $\\nabla u$ has components in $\\mathbb{P}_{p-1}(K)$, so its trace on $e$ gives a vector of polynomials of degree at most $p-1$. Thus, $\\{\\!\\{\\nabla u\\}\\!\\}$ is a vector of polynomials of degree at most $p-1$ on $e$.\n\nNow we analyze the integrands of the face terms:\n- **Term 2 (Symmetry Term):** The integrand is of the form $\\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!]$.\n    - The normal vector $\\boldsymbol{n}_{e}$ is constant for each face since the elements are affine.\n    - $\\{\\!\\{\\nabla u\\}\\!\\}$ is a vector of polynomials of degree at most $p-1$.\n    - $[\\![v]\\!]$ is a scalar polynomial of degree at most $p$.\n    - The product is a scalar polynomial on $e$ of degree at most $(p-1) + p = 2p-1$.\n\n- **Term 3 (Penalty Term):** The integrand is $\\frac{\\sigma}{h_{e}} \\,[\\![u]\\!] \\,[\\![v]\\!]$.\n    - The penalty factor $\\frac{\\sigma}{h_{e}}$ is a constant on each face $e$.\n    - $[\\![u]\\!]$ is a polynomial of degree at most $p$.\n    - $[\\![v]\\!]$ is a polynomial of degree at most $p$.\n    - The product is a scalar polynomial on $e$ of degree at most $p + p = 2p$.\n\n- To guarantee exact integration for all face terms, the quadrature rule must be exact for the highest polynomial degree encountered. Comparing the degrees, we have $2p-1$ from the symmetry term and $2p$ from the penalty term. The maximum is $2p$.\n- The minimal polynomial exactness degree for the face integrals is therefore $q_{\\mathrm{face}} = 2p$.\n\nThe minimal polynomial exactness degrees are $(q_{\\mathrm{vol}}, q_{\\mathrm{face}}) = (2p-2, 2p)$.\n\n**Part 2: Effects of Under-integration**\n\nLet $a_{h}(u,v)$ denote the bilinear form where integrals are replaced by numerical quadrature sums. Under-integration occurs if the quadrature rules have exactness degrees lower than the minimal values derived above, i.e., $q_{\\mathrm{vol}} < 2p-2$ or $q_{\\mathrm{face}} < 2p$.\n\n**Effect on Symmetry:**\nThe exact bilinear form $a(u,v)$ is symmetric by construction. The volume term $\\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x$ and the penalty term $\\int_{e} \\frac{\\sigma}{h_{e}} \\,[\\![u]\\!] \\,[\\![v]\\!] \\, \\mathrm{d}s$ are clearly symmetric in $u$ and $v$. The combination of the two cross terms, $-\\int_{e} (\\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![u]\\!]) \\, \\mathrm{d}s$, is also symmetric.\nWhen numerical quadrature is applied, each integral is replaced by a weighted sum of integrand values at quadrature points. For example, $\\int_D f(x) dx \\approx \\sum_i w_i f(x_i)$.\nEach term in the discrete form $a_{h}(u,v)$ inherits the symmetry of its corresponding integrand.\n- The discrete volume term is $\\sum_{K} \\sum_{i} w_{K,i} (\\nabla u \\cdot \\nabla v)(x_{K,i})$, which is symmetric in $u$ and $v$.\n- The discrete penalty term is $\\sum_{e} \\sum_{j} w_{e,j} \\frac{\\sigma}{h_{e}} [\\![u]\\!](x_{e,j}) [\\![v]\\!](x_{e,j})$, which is symmetric.\n- The discrete symmetry term is $-\\sum_{e} \\sum_{j} w_{e,j} (\\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![u]\\!])(x_{e,j})$, which is also symmetric.\nThus, $a_{h}(u,v) = a_{h}(v,u)$ holds regardless of the exactness degree of the quadrature rules. Under-integration does not affect the symmetry of the bilinear form. The resulting stiffness matrix remains symmetric.\n\n**Effect on Coercivity (Positive Definiteness):**\nCoercivity is the property that $a(v,v) \\ge C \\|v\\|_{\\text{DG}}^2$ for some positive constant $C$ and an appropriate norm $\\|v\\|_{\\text{DG}}$. It is fundamental to the stability and well-posedness of the discrete problem. The coercivity of the SIPG form relies on the positivity of two key terms in $a(v,v)$: the volume term and the penalty term.\n$$\na(v,v) = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} |\\nabla v|^2 \\, \\mathrm{d}x + \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\frac{\\sigma}{h_{e}} |[\\![v]\\!]|^2 \\, \\mathrm{d}s - 2\\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e} \\,[\\![v]\\!] \\, \\mathrm{d}s\n$$\nThe first two terms are positive definite and form the backbone of the DG norm. The third term is controlled by the first two for a sufficiently large penalty parameter $\\sigma$.\n\nWhen under-integration is employed, the discrete bilinear form is\n$$\na_{h}(v,v) = \\sum_{K} (\\nabla v, \\nabla v)_{h,K} + \\sum_{e} \\left\\langle \\frac{\\sigma}{h_{e}} [\\![v]\\!], [\\![v]\\!] \\right\\rangle_{h,e} - 2\\sum_{e} \\langle \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\boldsymbol{n}_{e}, [\\![v]\\!] \\rangle_{h,e}\n$$\nwhere $(\\cdot,\\cdot)_{h,K}$ and $\\langle \\cdot, \\cdot \\rangle_{h,e}$ denote the inner products approximated by quadrature.\n\n1.  **Impact of $q_{\\mathrm{vol}} < 2p-2$:** The integrand $|\\nabla v|^2$ is a polynomial of degree up to $2p-2$. If the quadrature rule is not exact for this degree, the discrete inner product $(\\nabla v, \\nabla v)_{h,K}$ is not guaranteed to be positive. It is possible to construct a non-zero function $v \\in V_{h}$ such that $\\nabla v$ is non-zero, but $\\nabla v$ vanishes at all volume quadrature points. For such a function, $(\\nabla v, \\nabla v)_{h,K} = 0$ while $\\int_K |\\nabla v|^2 \\mathrm{d}x > 0$. This loss of positivity for the principal coercive term can lead to a loss of overall coercivity for $a_h(\\cdot, \\cdot)$.\n\n2.  **Impact of $q_{\\mathrm{face}} < 2p$:** The integrand of the penalty term, $|[\\![v]\\!]|^2$, is a polynomial on the face $e$ of degree up to $2p$. If $q_{\\mathrm{face}} < 2p$, the discrete inner product $\\langle [\\![v]\\!], [\\![v]\\!] \\rangle_{h,e}$ may not be positive. A non-zero jump $[\\![v]\\!] \\in \\mathbb{P}_{p}(e)$ could vanish at all face quadrature points, making the discrete penalty term zero while its exact counterpart is strictly positive. This undermines the role of the penalty parameter $\\sigma$ in enforcing coercivity.\n\nIn both scenarios, the loss of guaranteed positivity in the main diagonal terms of the bilinear form means that the standard proof of coercivity fails. The discrete form $a_{h}(\\cdot, \\cdot)$ may no longer be coercive (positive definite). This can result in a singular or indefinite stiffness matrix, rendering the numerical method unstable and the linear system unsolvable. Therefore, under-integration critically jeopardizes the coercivity and stability of the SIPG method.", "answer": "$$\n\\boxed{\\begin{pmatrix} 2p-2 & 2p \\end{pmatrix}}\n$$", "id": "3426395"}, {"introduction": "Variational formulations are not only for solving partial differential equations but also for building more complex models, such as in PDE-constrained optimization. This problem challenges you to formulate and analyze a linear-quadratic optimal control problem where the state is governed by a Discontinuous Galerkin (DG) discretized Poisson equation. You will apply the method of Lagrange multipliers to derive the Karush-Kuhn-Tucker (KKT) system, revealing the characteristic saddle-point structure of such problems and exploring its solution via Schur complement reduction. [@problem_id:3426340]", "problem": "Consider a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with $d \\in \\{1,2,3\\}$ and homogeneous Dirichlet boundary conditions imposed weakly. Let $\\mathcal{T}_{h}$ be a conforming, shape-regular simplicial mesh of $\\Omega$, and let $V_{h}$ be the finite-dimensional space of discontinuous piecewise polynomials of total degree at most $k \\geq 1$ on $\\mathcal{T}_{h}$. Define the symmetric interior penalty bilinear form $a_{h}(\\cdot,\\cdot)$ that is consistent with the Poisson operator and coercive for sufficiently large penalty parameter, and define the $L^{2}(\\Omega)$ inner product $(\\cdot,\\cdot)$ on $V_{h}$.\n\nYou are to set up and analyze a linear-quadratic optimization problem constrained by a linear partial differential equation: minimize the discrepancy with a given data $u_{d} \\in L^{2}(\\Omega)$ while penalizing the source $f$, subject to the elliptic equation. Specifically, consider the problem\n$$\n\\min_{u \\in V_{h},\\, f \\in V_{h}} \\;\\; \\frac{1}{2}\\,(u - u_{d},\\, u - u_{d}) + \\frac{\\beta}{2}\\,(f,\\, f) \\quad \\text{subject to} \\quad a_{h}(u,\\, v) = (f,\\, v)\\quad \\forall v \\in V_{h},\n$$\nwhere $\\beta > 0$ is a fixed regularization parameter. Introduce a Lagrange multiplier $p \\in V_{h}$ and write the Lagrangian functional. Derive the Karush-Kuhn-Tucker (KKT) variational system corresponding to the first-order optimality conditions. Show that, in a fixed basis of $V_{h}$, the resulting linear system can be written in block operator form in terms of the mass matrix $M$ representing $(\\cdot,\\cdot)$ on $V_{h}$ and the symmetric interior penalty stiffness matrix $S$ representing $a_{h}(\\cdot,\\cdot)$ on $V_{h}$. Describe the saddle-point character of this block system.\n\nThen, eliminate the primal variables $u$ and $f$ to obtain the reduced equation in the Lagrange multiplier variable $p$ and discuss the structure of the exact Schur complement. Based on this, propose a block-diagonal preconditioner that uses the exact Schur complement in the $p$-block and discuss its spectral effect at the operator level, assuming that $M$ and $S$ are symmetric positive definite.\n\nYour final task is to provide the exact analytical expression, in terms of $M$, $S$, and $\\beta$, of the Schur complement operator in the Lagrange multiplier variable $p$ obtained by eliminating $u$ and $f$ from the KKT system. The final answer must be a single closed-form expression. No numerical approximation or rounding is required.", "solution": "The user wants to analyze a PDE-constrained optimization problem, specifically to derive the KKT system, analyze its block structure, find the Schur complement system, and propose a preconditioner.\n\n### Step 1: Problem Validation\n\nThe provided problem statement is a standard exercise in the field of numerical analysis for PDE-constrained optimization.\nThe givens are:\n- A bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$, $d \\in \\{1,2,3\\}$.\n- A conforming, shape-regular simplicial mesh $\\mathcal{T}_{h}$ of $\\Omega$.\n- A finite element space $V_{h}$ of discontinuous piecewise polynomials of degree at most $k \\geq 1$.\n- A symmetric interior penalty (SIPG) bilinear form $a_{h}(\\cdot,\\cdot)$ on $V_{h} \\times V_{h}$, which is consistent and coercive.\n- The $L^{2}(\\Omega)$ inner product $(\\cdot,\\cdot)$.\n- A given data function $u_{d} \\in L^{2}(\\Omega)$ and a regularization parameter $\\beta > 0$.\n- The optimization problem:\n$$\n\\min_{u \\in V_{h},\\, f \\in V_{h}} \\;\\; J(u,f) = \\frac{1}{2}\\,(u - u_{d},\\, u - u_{d}) + \\frac{\\beta}{2}\\,(f,\\, f)\n$$\nsubject to the linear constraint\n$$\na_{h}(u,\\, v) = (f,\\, v)\\quad \\forall v \\in V_{h}.\n$$\n\nValidation against the criteria:\n- **Scientifically Grounded**: The problem is well-established in the theory of optimal control and its numerical solution using finite element methods, specifically Discontinuous Galerkin methods. All concepts (SIPG, KKT conditions, Schur complements) are standard.\n- **Well-Posed**: The objective functional $J(u,f)$ is strictly convex, and the constraint is a linear system. For a given $f$, the coercivity of $a_h(\\cdot,\\cdot)$ guarantees a unique solution $u$. The overall problem is well-posed and has a unique solution.\n- **Objective**: The problem is stated in precise, formal mathematical language with no subjective elements.\n\nThe problem is free of any of the invalidity flaws. It is self-contained, scientifically sound, and formalizable. The verdict is that the problem is **valid**.\n\n### Step 2: Derivation and Solution\n\n**1. Lagrangian and KKT System**\n\nTo find the first-order optimality conditions, we introduce a Lagrange multiplier $p \\in V_{h}$ to enforce the state-equation constraint. The Lagrangian functional $\\mathcal{L}: V_{h} \\times V_{h} \\times V_{h} \\to \\mathbb{R}$ is given by:\n$$\n\\mathcal{L}(u, f, p) = J(u, f) + \\left( a_{h}(u, p) - (f, p) \\right)\n$$\n$$\n\\mathcal{L}(u, f, p) = \\frac{1}{2}\\,(u - u_{d},\\, u - u_{d}) + \\frac{\\beta}{2}\\,(f,\\, f) + a_{h}(u, p) - (f, p)\n$$\nThe sign of the multiplier term is a convention; this choice leads to a symmetric KKT system. The first-order necessary conditions for optimality are that the Gateaux derivatives of $\\mathcal{L}$ with respect to $u$, $f$, and $p$ must vanish for all directions.\n\n- **Derivative with respect to $u$**: For any test function $w \\in V_h$,\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial u}(w) = (u - u_{d}, w) + a_{h}(w, p) = 0.\n$$\nUsing the symmetry of $a_h(\\cdot,\\cdot)$, we get the **adjoint equation**:\n$$\n(u, w) + a_{h}(p, w) = (u_d, w) \\quad \\forall w \\in V_h.\n$$\n\n- **Derivative with respect to $f$**: For any test function $z \\in V_h$,\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial f}(z) = \\beta(f, z) - (p, z) = 0.\n$$\nThis gives the **optimality condition**:\n$$\n\\beta(f, z) = (p, z) \\quad \\forall z \\in V_h.\n$$\n\n- **Derivative with respect to $p$**: For any test function $v \\in V_h$,\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p}(v) = a_{h}(u, v) - (f, v) = 0.\n$$\nThis recovers the original constraint, the **state equation**:\n$$\na_{h}(u, v) = (f, v) \\quad \\forall v \\in V_h.\n$$\n\nThe full KKT system is to find $(u, f, p) \\in V_h \\times V_h \\times V_h$ satisfying these three variational equations.\n\n**2. Block Operator Form**\n\nLet $\\{\\phi_i\\}_{i=1}^{N}$ be a basis of $V_h$. Let $\\mathbf{u}$, $\\mathbf{f}$, and $\\mathbf{p}$ be the corresponding coefficient vectors. We define the mass matrix $M$ with entries $M_{ij} = (\\phi_j, \\phi_i)$ and the symmetric interior penalty stiffness matrix $S$ with entries $S_{ij} = a_h(\\phi_j, \\phi_i)$. Due to the properties of the inner product and the coercivity of $a_h$, both $M$ and $S$ are symmetric positive-definite (SPD). Let $\\mathbf{d}$ be the vector with entries $\\mathbf{d}_i = (u_d, \\phi_i)$.\n\nThe KKT system translates to the following matrix system:\n1. Adjoint eq: $M\\mathbf{u} + S\\mathbf{p} = \\mathbf{d}$\n2. Optimality eq: $\\beta M\\mathbf{f} - M\\mathbf{p} = 0$\n3. State eq: $S\\mathbf{u} - M\\mathbf{f} = 0$\n\nThis can be written in a $3 \\times 3$ block matrix form:\n$$\n\\begin{pmatrix}\nM & 0 & S \\\\\n0 & \\beta M & -M \\\\\nS & -M & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\\n\\mathbf{f} \\\\\n\\mathbf{p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{d} \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\nThis is a symmetric but indefinite linear system. To analyze its saddle-point character, we group the primal variables $(\\mathbf{u}, \\mathbf{f})$ and the dual variable $\\mathbf{p}$:\n$$\n\\begin{pmatrix}\nA & B^T \\\\\nB & C\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{x} \\\\\n\\mathbf{p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{F} \\\\\n\\mathbf{G}\n\\end{pmatrix}\n$$\nwhere $\\mathbf{x} = (\\mathbf{u}^T, \\mathbf{f}^T)^T$ and the blocks are:\n$$\nA = \\begin{pmatrix} M & 0 \\\\ 0 & \\beta M \\end{pmatrix}, \\quad B = \\begin{pmatrix} S & -M \\end{pmatrix}, \\quad C = [0], \\quad \\mathbf{F} = \\begin{pmatrix} \\mathbf{d} \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{G} = [0].\n$$\nThe matrix $A$ is the Hessian of the Lagrangian with respect to the primal variables. Since $M$ is SPD and $\\beta>0$, $A$ is SPD. The $C=0$ block is characteristic of a standard saddle-point problem with equality constraints. The overall KKT matrix is indefinite, possessing both positive and negative eigenvalues, which defines its saddle-point nature.\n\n**3. Schur Complement and Reduced System**\n\nWe eliminate the primal variables $\\mathbf{u}$ and $\\mathbf{f}$ to get a reduced equation for $\\mathbf{p}$. From the KKT system:\nFrom the optimality equation: $\\beta M\\mathbf{f} = M\\mathbf{p} \\implies \\mathbf{f} = \\frac{1}{\\beta}\\mathbf{p}$ since $M$ is invertible.\nFrom the state equation: $S\\mathbf{u} = M\\mathbf{f} = M(\\frac{1}{\\beta}\\mathbf{p}) = \\frac{1}{\\beta}M\\mathbf{p}$. Since $S$ is invertible, $\\mathbf{u} = \\frac{1}{\\beta}S^{-1}M\\mathbf{p}$.\nSubstitute these into the adjoint equation: $M\\mathbf{u} + S\\mathbf{p} = \\mathbf{d}$.\n$M(\\frac{1}{\\beta}S^{-1}M\\mathbf{p}) + S\\mathbf{p} = \\mathbf{d}$, which gives $(\\frac{1}{\\beta}MS^{-1}M + S)\\mathbf{p} = \\mathbf{d}$.\n\nAlternatively, using the formal definition, the Schur complement of the block $A$ in the saddle-point system is given by $\\mathcal{S}_A = C - BA^{-1}B^T$. Here, $A^{-1} = \\begin{pmatrix} M^{-1} & 0 \\\\ 0 & \\frac{1}{\\beta}M^{-1} \\end{pmatrix}$.\n$$\n\\mathcal{S}_A = 0 - \\begin{pmatrix} S & -M \\end{pmatrix} \\begin{pmatrix} M^{-1} & 0 \\\\ 0 & \\frac{1}{\\beta}M^{-1} \\end{pmatrix} \\begin{pmatrix} S \\\\ -M \\end{pmatrix}\n$$\n$$\n= - \\left( \\begin{pmatrix} SM^{-1} & -\\frac{1}{\\beta}I \\end{pmatrix} \\begin{pmatrix} S \\\\ -M \\end{pmatrix} \\right) = - (SM^{-1}S + \\frac{1}{\\beta}M)\n$$\nThe reduced system for $\\mathbf{p}$ is $\\mathcal{S}_A \\mathbf{p} = \\mathbf{G} - BA^{-1}\\mathbf{F}$.\n$BA^{-1}\\mathbf{F} = \\begin{pmatrix} SM^{-1} & -\\frac{1}{\\beta}I \\end{pmatrix} \\begin{pmatrix} \\mathbf{d} \\\\ 0 \\end{pmatrix} = SM^{-1}\\mathbf{d}$.\nSo, $ - (SM^{-1}S + \\frac{1}{\\beta}M) \\mathbf{p} = 0 - SM^{-1}\\mathbf{d}$, which simplifies to:\n$$\n(SM^{-1}S + \\frac{1}{\\beta}M) \\mathbf{p} = SM^{-1}\\mathbf{d}\n$$\nThe two derived reduced systems are equivalent, as one can be obtained from the other by pre-multiplication with the invertible operator $MS^{-1}$. The operator in the second form, $\\mathcal{S} = SM^{-1}S + \\frac{1}{\\beta}M$, is what is conventionally obtained from the block-elimination formula and is referred to as the Schur complement operator (up to a sign). It is symmetric and positive-definite, being a sum of two SPD operators ($S M^{-1} S$ is SPD, and $\\frac{1}{\\beta} M$ is SPD). At the continuous level, this corresponds to a fourth-order elliptic operator of the form $\\Delta^2 + \\text{const}$.\n\n**4. Block-Diagonal Preconditioner**\n\nFor the KKT system $\\begin{pmatrix} A & B^T \\\\ B & 0 \\end{pmatrix}\\begin{pmatrix} \\mathbf{x} \\\\ \\mathbf{p} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{F} \\\\ 0 \\end{pmatrix}$, an effective block-diagonal preconditioner is of the form $\\mathcal{P} = \\begin{pmatrix} A & 0 \\\\ 0 & -\\mathcal{S}_A \\end{pmatrix}$. Using the exact blocks as requested:\n$$\n\\mathcal{P} = \\begin{pmatrix} A & 0 \\\\ 0 & BA^{-1}B^T \\end{pmatrix} = \\begin{pmatrix}\nM & 0 & 0 \\\\\n0 & \\beta M & 0 \\\\\n0 & 0 & SM^{-1}S + \\frac{1}{\\beta}M\n\\end{pmatrix}\n$$\nThe spectral properties of the preconditioned operator $\\mathcal{P}^{-1}\\mathcal{A}$ determine the convergence of Krylov solvers. As shown in the literature on saddle-point preconditioning, the eigenvalues of this operator are clustered at a few values, independent of the mesh size $h$. For this specific problem, a direct calculation shows that the eigenvalues of $\\mathcal{P}^{-1}\\mathcal{A}$ are $\\{1, \\frac{1+\\sqrt{5}}{2}, \\frac{1-\\sqrt{5}}{2}\\}$. The eigenvalue $1$ has multiplicity $N$, while the other two each have multiplicity $N$, where $N=\\dim(V_h)$. Since the eigenvalues are contained in a small set, a Krylov method like GMRES will converge in a small number of iterations (at most 3 in exact arithmetic) regardless of the problem size. This makes the preconditioner highly effective.\n\n**5. Final Answer Formulation**\n\nThe final task is to provide the expression for the Schur complement operator obtained by eliminating $u$ and $f$. As derived, this is the operator acting on $\\mathbf{p}$ in the reduced system. Following the standard block-elimination formula, this operator is $SM^{-1}S + \\frac{1}{\\beta}M$.", "answer": "$$\n\\boxed{S M^{-1} S + \\frac{1}{\\beta} M}\n$$", "id": "3426340"}]}