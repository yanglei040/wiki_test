{"hands_on_practices": [{"introduction": "The simplest, yet most fundamental, transformation is the affine map, which connects a reference simplex to a straight-sided element in the physical mesh. This exercise provides hands-on practice in explicitly constructing this map and its inverse for a specific 3D tetrahedron. By working through the calculations, you will solidify your understanding of the direct link between the element's vertex coordinates and the algebraic form of the transformation, including its Jacobian and conditions for validity [@problem_id:3362693].", "problem": "In the spectral element method and the discontinuous Galerkin method, mappings between a reference element and a physical element are constructed using isoparametric transformations. For a linear simplex (triangle in two dimensions or tetrahedron in three dimensions), the isoparametric mapping is affine, and its Jacobian determines both invertibility and orientation. Consider the canonical reference tetrahedron $\\hat{K}$ with vertices at the origin and the standard basis points in $\\mathbb{R}^{3}$, namely $\\hat{v}_{1}=(0,0,0)$, $\\hat{v}_{2}=(1,0,0)$, $\\hat{v}_{3}=(0,1,0)$, and $\\hat{v}_{4}=(0,0,1)$. Let $K$ be a physical tetrahedron in $\\mathbb{R}^{3}$ with vertices $v_{1}=(2,-1,0)$, $v_{2}=(3,2,1)$, $v_{3}=(1,3,-2)$, and $v_{4}=(0,0,4)$.\n\nStarting from the fundamental definition of the linear isoparametric mapping on a tetrahedron expressed in terms of the linear Lagrange shape functions on $\\hat{K}$, derive the affine form $F(\\hat{\\boldsymbol{x}})=A\\,\\hat{\\boldsymbol{x}}+b$, identify how $A$ and $b$ depend on the vertex coordinates, and construct $A$ and $b$ explicitly for the given $K$. Then compute the inverse mapping $F^{-1}$ and the condition under which $F$ is invertible with positive orientation, describing the domain of validity of $F^{-1}$ in terms of the image tetrahedron $K$.\n\nYour final reported result must be the three component functions of $F^{-1}(x,y,z)$ together with the scalar $\\det(A)$, collected into a single row matrix. No rounding is required. Do not include any units. Express the final answer as a single row matrix in LaTeX as specified.", "solution": "The problem requires the derivation of the affine mapping between a canonical reference tetrahedron $\\hat{K}$ and a physical tetrahedron $K$, the calculation of its inverse, and the evaluation of the Jacobian determinant.\n\nThe canonical reference tetrahedron $\\hat{K}$ is defined by the vertices $\\hat{v}_{1}=(0,0,0)$, $\\hat{v}_{2}=(1,0,0)$, $\\hat{v}_{3}=(0,1,0)$, and $\\hat{v}_{4}=(0,0,1)$. The physical tetrahedron $K$ has vertices $v_{1}=(2,-1,0)$, $v_{2}=(3,2,1)$, $v_{3}=(1,3,-2)$, and $v_{4}=(0,0,4)$. We denote a point in the reference element as $\\hat{\\boldsymbol{x}} = (\\hat{x}, \\hat{y}, \\hat{z})^T$ and a point in the physical element as $\\boldsymbol{x} = (x, y, z)^T$.\n\nThe linear isoparametric mapping $F: \\hat{K} \\to K$ is constructed using the linear Lagrange shape functions $\\hat{L}_i(\\hat{\\boldsymbol{x}})$ associated with the vertices $\\hat{v}_i$ of $\\hat{K}$. These shape functions are defined by the property $\\hat{L}_i(\\hat{v}_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. For the given canonical tetrahedron, these functions are the barycentric coordinates and are found to be:\n$$ \\hat{L}_{1}(\\hat{\\boldsymbol{x}}) = 1 - \\hat{x} - \\hat{y} - \\hat{z} $$\n$$ \\hat{L}_{2}(\\hat{\\boldsymbol{x}}) = \\hat{x} $$\n$$ \\hat{L}_{3}(\\hat{\\boldsymbol{x}}) = \\hat{y} $$\n$$ \\hat{L}_{4}(\\hat{\\boldsymbol{x}}) = \\hat{z} $$\n\nThe mapping $F$ is defined by interpolating the physical vertex coordinates using these shape functions:\n$$ \\boldsymbol{x} = F(\\hat{\\boldsymbol{x}}) = \\sum_{i=1}^{4} v_i \\hat{L}_i(\\hat{\\boldsymbol{x}}) $$\nSubstituting the expressions for $\\hat{L}_i(\\hat{\\boldsymbol{x}})$:\n$$ \\boldsymbol{x} = v_1(1 - \\hat{x} - \\hat{y} - \\hat{z}) + v_2\\hat{x} + v_3\\hat{y} + v_4\\hat{z} $$\nTo express this in the affine form $F(\\hat{\\boldsymbol{x}}) = A\\hat{\\boldsymbol{x}} + b$, we rearrange the equation by grouping terms with $\\hat{x}$, $\\hat{y}$, and $\\hat{z}$:\n$$ \\boldsymbol{x} = v_1 + (v_2 - v_1)\\hat{x} + (v_3 - v_1)\\hat{y} + (v_4 - v_1)\\hat{z} $$\nThis equation can be written in matrix form as:\n$$ \\boldsymbol{x} = \\begin{pmatrix} v_{2x}-v_{1x}  v_{3x}-v_{1x}  v_{4x}-v_{1x} \\\\ v_{2y}-v_{1y}  v_{3y}-v_{1y}  v_{4y}-v_{1y} \\\\ v_{2z}-v_{1z}  v_{3z}-v_{1z}  v_{4z}-v_{1z} \\end{pmatrix} \\begin{pmatrix} \\hat{x} \\\\ \\hat{y} \\\\ \\hat{z} \\end{pmatrix} + \\begin{pmatrix} v_{1x} \\\\ v_{1y} \\\\ v_{1z} \\end{pmatrix} $$\nComparing this to $\\boldsymbol{x} = A\\hat{\\boldsymbol{x}} + b$, we identify the matrix $A$ (the Jacobian of the transformation) and the vector $b$:\n$$ A = \\begin{pmatrix} v_2-v_1  v_3-v_1  v_4-v_1 \\end{pmatrix} \\quad , \\quad b = v_1 $$\nThe columns of $A$ are the vectors forming the edges of the physical tetrahedron originating from vertex $v_1$.\n\nNow, we construct $A$ and $b$ using the given vertex coordinates:\n$v_1 = (2, -1, 0)^T$, $v_2 = (3, 2, 1)^T$, $v_3 = (1, 3, -2)^T$, $v_4 = (0, 0, 4)^T$.\nThe vector $b$ is:\n$$ b = v_1 = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\end{pmatrix} $$\nThe columns of $A$ are:\n$v_2 - v_1 = (3-2, 2-(-1), 1-0)^T = (1, 3, 1)^T$\n$v_3 - v_1 = (1-2, 3-(-1), -2-0)^T = (-1, 4, -2)^T$\n$v_4 - v_1 = (0-2, 0-(-1), 4-0)^T = (-2, 1, 4)^T$\nSo, the matrix $A$ is:\n$$ A = \\begin{pmatrix} 1  -1  -2 \\\\ 3  4  1 \\\\ 1  -2  4 \\end{pmatrix} $$\n\nThe mapping $F$ is invertible if and only if $A$ is an invertible matrix, which is true if $\\det(A) \\neq 0$. The mapping preserves orientation if $\\det(A) > 0$. Let us compute the determinant of $A$:\n$$ \\det(A) = 1(4 \\cdot 4 - 1 \\cdot (-2)) - (-1)(3 \\cdot 4 - 1 \\cdot 1) + (-2)(3 \\cdot (-2) - 4 \\cdot 1) $$\n$$ \\det(A) = 1(16 + 2) + 1(12 - 1) - 2(-6 - 4) = 18 + 11 - 2(-10) = 18 + 11 + 20 = 49 $$\nSince $\\det(A)=49 > 0$, the mapping is invertible and orientation-preserving. The physical vertices form a non-degenerate tetrahedron.\n\nThe inverse mapping $F^{-1}: K \\to \\hat{K}$ is found by solving $\\boldsymbol{x} = A\\hat{\\boldsymbol{x}} + b$ for $\\hat{\\boldsymbol{x}}$:\n$$ A\\hat{\\boldsymbol{x}} = \\boldsymbol{x} - b \\implies \\hat{\\boldsymbol{x}} = A^{-1}(\\boldsymbol{x} - b) $$\nThe domain of validity for $F^{-1}$ is the physical tetrahedron $K$.\nTo find $A^{-1}$, we use the adjugate matrix formula $A^{-1} = \\frac{1}{\\det(A)}\\text{adj}(A)$. The adjugate matrix, $\\text{adj}(A)$, is the transpose of the cofactor matrix $C$.\nThe cofactors $C_{ij}$ of $A$ are:\n$C_{11} = +(16 - (-2)) = 18$\n$C_{12} = -(12 - 1) = -11$\n$C_{13} = +(-6 - 4) = -10$\n$C_{21} = -(-4 - 4) = 8$\n$C_{22} = +(4 - (-2)) = 6$\n$C_{23} = -(-2 - (-1)) = 1$\n$C_{31} = +(-1 - (-8)) = 7$\n$C_{32} = -(1 - (-6)) = -7$\n$C_{33} = +(4 - (-3)) = 7$\nThe cofactor matrix is $C = \\begin{pmatrix} 18  -11  -10 \\\\ 8  6  1 \\\\ 7  -7  7 \\end{pmatrix}$.\nThe adjugate matrix is $\\text{adj}(A) = C^T = \\begin{pmatrix} 18  8  7 \\\\ -11  6  -7 \\\\ -10  1  7 \\end{pmatrix}$.\nThus, the inverse matrix is:\n$$ A^{-1} = \\frac{1}{49} \\begin{pmatrix} 18  8  7 \\\\ -11  6  -7 \\\\ -10  1  7 \\end{pmatrix} $$\nNow we can write the explicit form of the inverse mapping $F^{-1}(\\boldsymbol{x}) = \\hat{\\boldsymbol{x}}$:\n$$ \\begin{pmatrix} \\hat{x} \\\\ \\hat{y} \\\\ \\hat{z} \\end{pmatrix} = \\frac{1}{49} \\begin{pmatrix} 18  8  7 \\\\ -11  6  -7 \\\\ -10  1  7 \\end{pmatrix} \\begin{pmatrix} x - 2 \\\\ y - (-1) \\\\ z - 0 \\end{pmatrix} = \\frac{1}{49} \\begin{pmatrix} 18  8  7 \\\\ -11  6  -7 \\\\ -10  1  7 \\end{pmatrix} \\begin{pmatrix} x - 2 \\\\ y + 1 \\\\ z \\end{pmatrix} $$\nThe three component functions of $F^{-1}(x,y,z)$ are obtained by matrix-vector multiplication:\n$$ \\hat{x}(x,y,z) = \\frac{1}{49} [18(x-2) + 8(y+1) + 7z] = \\frac{1}{49} (18x - 36 + 8y + 8 + 7z) = \\frac{1}{49} (18x + 8y + 7z - 28) $$\n$$ \\hat{y}(x,y,z) = \\frac{1}{49} [-11(x-2) + 6(y+1) - 7z] = \\frac{1}{49} (-11x + 22 + 6y + 6 - 7z) = \\frac{1}{49} (-11x + 6y - 7z + 28) $$\n$$ \\hat{z}(x,y,z) = \\frac{1}{49} [-10(x-2) + 1(y+1) + 7z] = \\frac{1}{49} (-10x + 20 + y + 1 + 7z) = \\frac{1}{49} (-10x + y + 7z + 21) $$\nThe problem asks for these three functions and the value of $\\det(A)$ to be reported.\n$\\det(A) = 49$.\nThe component functions of $F^{-1}$ are $\\hat{x}(x,y,z)$, $\\hat{y}(x,y,z)$, and $\\hat{z}(x,y,z)$ as derived above.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{49} (18x + 8y + 7z - 28)  \\frac{1}{49} (-11x + 6y - 7z + 28)  \\frac{1}{49} (-10x + y + 7z + 21)  49\n\\end{pmatrix}\n}\n$$", "id": "3362693"}, {"introduction": "Real-world domains often feature curved boundaries, which cannot be accurately represented by simple affine elements. This is where isoparametric mappings become essential. This practice guides you through the construction of a quadratic isoparametric transformation that maps a reference square to a physical quadrilateral with one curved edge, demonstrating how to handle non-straight geometries. Calculating the Jacobian determinant at key points will also highlight how the mapping's local distortion is assessed in practice [@problem_id:3362702].", "problem": "Consider the reference square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ with reference coordinates $(\\xi,\\eta)$. Construct a quadratic isoparametric mapping $\\boldsymbol{F} : \\hat{\\Omega} \\to \\Omega \\subset \\mathbb{R}^2$ for a curved quadrilateral used in the spectral element and discontinuous Galerkin methods as follows.\n\nThe physical element $\\Omega$ has:\n- Bottom edge: the straight line segment from $(-1,-1)$ to $(1,-1)$.\n- Left and right edges: the straight line segments from $(-1,-1)$ to $(-1,1)$ and from $(1,-1)$ to $(1,1)$, respectively.\n- Top edge: the circular arc of the circle $x^2 + y^2 = 2$ joining $(-1,1)$ to $(1,1)$.\n\nImpose a quadratic isoparametric geometry using the tensor-product quadratic Lagrange interpolation with nodes at the $3 \\times 3$ grid $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$, where the eight boundary nodes map to the corresponding physical points:\n- Corners: $(-1,-1) \\mapsto (-1,-1)$, $(1,-1) \\mapsto (1,-1)$, $(1,1) \\mapsto (1,1)$, $(-1,1) \\mapsto (-1,1)$,\n- Midpoints on edges: $(0,-1) \\mapsto (0,-1)$, $(1,0) \\mapsto (1,0)$, $(-1,0) \\mapsto (-1,0)$, and $(0,1) \\mapsto (0,\\sqrt{2})$ (top midpoint on the circular arc).\nSet the interior node $(0,0) \\mapsto (0,0)$.\n\n1. Using the definition of isoparametric mapping with tensor-product quadratic Lagrange basis polynomials on $\\{-1,0,1\\}$ in each coordinate, derive explicit formulas for $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$.\n2. From first principles, compute the Jacobian matrix $\\boldsymbol{J}(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$ and its determinant $\\det \\boldsymbol{J}(\\xi,\\eta)$.\n3. Evaluate $\\det \\boldsymbol{J}$ at the two-dimensional Legendre–Gauss–Lobatto (LGL) points of polynomial degree $N=2$, namely at the tensor-product set $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$.\n4. Report the arithmetic mean of these nine values of $\\det \\boldsymbol{J}$ as a single exact closed-form expression. Do not round your answer.", "solution": "The solution proceeds in four stages:\n1.  Derivation of the isoparametric coordinate transformation $\\boldsymbol{F}(\\xi,\\eta) = (x(\\xi,\\eta), y(\\xi,\\eta))$.\n2.  Computation of the Jacobian matrix $\\boldsymbol{J}(\\xi,\\eta)$ and its determinant $\\det\\boldsymbol{J}(\\xi,\\eta)$.\n3.  Evaluation of $\\det\\boldsymbol{J}$ at the nine specified Legendre-Gauss-Lobatto (LGL) points.\n4.  Calculation of the arithmetic mean of these determinant values.\n\n### 1. Isoparametric Mapping\nThe mapping is constructed using tensor-product quadratic Lagrange basis polynomials. The 1D Lagrange basis polynomials on the interval $[-1,1]$ with nodes at $\\{-1, 0, 1\\}$ are:\n$$L_{-1}(\\zeta) = \\frac{(\\zeta-0)(\\zeta-1)}{(-1-0)(-1-1)} = \\frac{1}{2}\\zeta(\\zeta-1)$$\n$$L_0(\\zeta) = \\frac{(\\zeta-(-1))(\\zeta-1)}{(0-(-1))(0-1)} = -(\\zeta+1)(\\zeta-1) = 1-\\zeta^2$$\n$$L_1(\\zeta) = \\frac{(\\zeta-(-1))(\\zeta-0)}{(1-(-1))(1-0)} = \\frac{1}{2}\\zeta(\\zeta+1)$$\nA useful property is that their sum is unity: $\\sum_{i=-1,0,1} L_i(\\zeta) = 1$.\n\nThe isoparametric mapping from the reference coordinates $(\\xi,\\eta)$ to the physical coordinates $(x,y)$ is given by:\n$$x(\\xi,\\eta) = \\sum_{i \\in \\{-1,0,1\\}} \\sum_{j \\in \\{-1,0,1\\}} x_{ij} L_i(\\xi)L_j(\\eta)$$\n$$y(\\xi,\\eta) = \\sum_{i \\in \\{-1,0,1\\}} \\sum_{j \\in \\{-1,0,1\\}} y_{ij} L_i(\\xi)L_j(\\eta)$$\nwhere $(x_{ij}, y_{ij})$ are the physical coordinates of the node corresponding to the reference node $(\\xi_i, \\eta_j)$.\n\n**Derivation of $x(\\xi,\\eta)$:**\nThe physical $x$-coordinates of the nodes are given by $x_{ij} = \\xi_i \\in \\{-1, 0, 1\\}$.\n$$x(\\xi,\\eta) = \\sum_{j} \\left( x_{-1,j}L_{-1}(\\xi)L_j(\\eta) + x_{0,j}L_0(\\xi)L_j(\\eta) + x_{1,j}L_1(\\xi)L_j(\\eta) \\right)$$\n$$x(\\xi,\\eta) = \\sum_{j} \\left( (-1)L_{-1}(\\xi)L_j(\\eta) + (0)L_0(\\xi)L_j(\\eta) + (1)L_1(\\xi)L_j(\\eta) \\right)$$\n$$x(\\xi,\\eta) = \\left( L_1(\\xi)-L_{-1}(\\xi) \\right) \\sum_j L_j(\\eta)$$\nUsing $\\sum_j L_j(\\eta) = 1$:\n$$x(\\xi,\\eta) = L_1(\\xi)-L_{-1}(\\xi) = \\frac{1}{2}\\xi(\\xi+1) - \\frac{1}{2}\\xi(\\xi-1) = \\frac{1}{2}(\\xi^2+\\xi - \\xi^2+\\xi) = \\xi$$\n\n**Derivation of $y(\\xi,\\eta)$:**\nThe physical $y$-coordinates $(y_{ij})$ are provided. A direct summation is possible, but a more insightful approach is to consider the transformation as a baseline affine map plus a non-linear correction. The affine map $y=\\eta$ correctly maps $8$ of the $9$ nodes, with the only deviation being at $(\\xi, \\eta) = (0,1)$, where the physical coordinate is $y_{0,1}=\\sqrt{2}$ instead of $y=1$. The required correction at this node is $\\sqrt{2}-1$. This correction must be zero at all other nodes. This is perfectly described by the basis function corresponding to the node $(0,1)$, which is $L_0(\\xi)L_1(\\eta)$.\nThus, the mapping for $y$ can be expressed as:\n$$y(\\xi,\\eta) = \\eta + (y_{0,1}-1) \\cdot L_0(\\xi)L_1(\\eta)$$\nSubstituting the given values and basis functions:\n$$y(\\xi,\\eta) = \\eta + (\\sqrt{2}-1) (1-\\xi^2) \\left(\\frac{1}{2}\\eta(\\eta+1)\\right)$$\nSo, the explicit formulas for the mapping are:\n$$x(\\xi,\\eta) = \\xi$$\n$$y(\\xi,\\eta) = \\eta + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(\\eta^2+\\eta)$$\n\n### 2. Jacobian Matrix and Determinant\nThe Jacobian matrix of the transformation is $\\boldsymbol{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\partial x/\\partial \\xi  \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi  \\partial y/\\partial \\eta \\end{pmatrix}$.\n\nFirst, we compute the partial derivatives:\n$$\\frac{\\partial x}{\\partial \\xi} = 1$$\n$$\\frac{\\partial x}{\\partial \\eta} = 0$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\eta + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(\\eta^2+\\eta) \\right] = \\frac{\\sqrt{2}-1}{2}(-2\\xi)(\\eta^2+\\eta) = -(\\sqrt{2}-1)\\xi(\\eta^2+\\eta)$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\eta + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(\\eta^2+\\eta) \\right] = 1 + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(2\\eta+1)$$\n\nThe Jacobian matrix is:\n$$\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix} 1  0 \\\\ -(\\sqrt{2}-1)\\xi(\\eta^2+\\eta)  1 + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(2\\eta+1) \\end{pmatrix}$$\n\nThe determinant of the Jacobian is:\n$$\\det\\boldsymbol{J}(\\xi,\\eta) = (1) \\left( 1 + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(2\\eta+1) \\right) - (0) \\left( -(\\sqrt{2}-1)\\xi(\\eta^2+\\eta) \\right)$$\n$$\\det\\boldsymbol{J}(\\xi,\\eta) = 1 + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(2\\eta+1)$$\n\n### 3. Evaluation of the Determinant at LGL points\nWe evaluate $\\det\\boldsymbol{J}$ at the $9$ points $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$.\n\nCase 1: $\\xi = -1$ or $\\xi = 1$.\nFor these values, the term $(1-\\xi^2) = 1 - (\\pm 1)^2 = 0$.\nTherefore, $\\det\\boldsymbol{J} = 1 + 0 = 1$. This applies to $6$ points:\n$\\det\\boldsymbol{J}(-1,-1) = 1$\n$\\det\\boldsymbol{J}(-1,0) = 1$\n$\\det\\boldsymbol{J}(-1,1) = 1$\n$\\det\\boldsymbol{J}(1,-1) = 1$\n$\\det\\boldsymbol{J}(1,0) = 1$\n$\\det\\boldsymbol{J}(1,1) = 1$\n\nCase 2: $\\xi = 0$.\nFor this value, $(1-\\xi^2) = 1 - 0^2 = 1$. The determinant simplifies to $\\det\\boldsymbol{J}(0,\\eta) = 1 + \\frac{\\sqrt{2}-1}{2}(2\\eta+1)$.\nWe evaluate this for $\\eta \\in \\{-1,0,1\\}$:\n- For $(\\xi,\\eta) = (0,-1)$:\n  $$\\det\\boldsymbol{J}(0,-1) = 1 + \\frac{\\sqrt{2}-1}{2}(2(-1)+1) = 1 - \\frac{\\sqrt{2}-1}{2} = \\frac{2 - (\\sqrt{2}-1)}{2} = \\frac{3-\\sqrt{2}}{2}$$\n- For $(\\xi,\\eta) = (0,0)$:\n  $$\\det\\boldsymbol{J}(0,0) = 1 + \\frac{\\sqrt{2}-1}{2}(2(0)+1) = 1 + \\frac{\\sqrt{2}-1}{2} = \\frac{2 + \\sqrt{2}-1}{2} = \\frac{1+\\sqrt{2}}{2}$$\n- For $(\\xi,\\eta) = (0,1)$:\n  $$\\det\\boldsymbol{J}(0,1) = 1 + \\frac{3(\\sqrt{2}-1)}{2} = \\frac{2 + 3\\sqrt{2}-3}{2} = \\frac{3\\sqrt{2}-1}{2}$$\n\nThe nine values of the determinant are: $1, 1, 1, \\frac{3-\\sqrt{2}}{2}, \\frac{1+\\sqrt{2}}{2}, \\frac{3\\sqrt{2}-1}{2}, 1, 1, 1$.\n\n### 4. Arithmetic Mean\nThe arithmetic mean is the sum of the nine values divided by $9$.\n$$\\text{Sum} = (1+1+1) + \\left(\\frac{3-\\sqrt{2}}{2} + \\frac{1+\\sqrt{2}}{2} + \\frac{3\\sqrt{2}-1}{2}\\right) + (1+1+1)$$\n$$\\text{Sum} = 6 + \\frac{(3-\\sqrt{2}) + (1+\\sqrt{2}) + (3\\sqrt{2}-1)}{2}$$\n$$\\text{Sum} = 6 + \\frac{3 - \\sqrt{2} + 1 + \\sqrt{2} + 3\\sqrt{2} - 1}{2}$$\n$$\\text{Sum} = 6 + \\frac{(3+1-1) + (-\\sqrt{2}+\\sqrt{2}+3\\sqrt{2})}{2} = 6 + \\frac{3 + 3\\sqrt{2}}{2}$$\n$$\\text{Sum} = \\frac{12}{2} + \\frac{3 + 3\\sqrt{2}}{2} = \\frac{15 + 3\\sqrt{2}}{2}$$\n\nThe arithmetic mean is $\\frac{1}{9} \\times \\text{Sum}$:\n$$\\text{Mean} = \\frac{1}{9} \\left(\\frac{15 + 3\\sqrt{2}}{2}\\right) = \\frac{15 + 3\\sqrt{2}}{18}$$\nFactoring out a $3$ from the numerator:\n$$\\text{Mean} = \\frac{3(5 + \\sqrt{2})}{18} = \\frac{5 + \\sqrt{2}}{6}$$", "answer": "$$\\boxed{\\frac{5 + \\sqrt{2}}{6}}$$", "id": "3362702"}, {"introduction": "Once a mapping from a reference to a physical element is established, we must understand its geometric implications to correctly transform and solve differential equations. This practice focuses on computing the essential geometric quantities derived from the mapping: the covariant basis vectors $\\boldsymbol{a}_{\\alpha}$ and the metric tensor $G$. This exercise, involving a custom-curved element, reveals how these factors, which are critical for evaluating integrals in spectral and DG methods, are calculated at specific quadrature points within an element [@problem_id:3362711].", "problem": "Consider a single curved quadrilateral element in the Spectral Element Method (SEM) and the Discontinuous Galerkin (DG) method. Let the reference square be $\\widehat{\\Omega} = [-1,1]^{2}$ with local coordinates $(\\xi,\\eta)$, and the physical mapping be the isoparametric bilinear map augmented by a bubble term in the $y$-direction,\n$$\n\\boldsymbol{X}(\\xi,\\eta) = \\begin{pmatrix} x(\\xi,\\eta) \\\\ y(\\xi,\\eta) \\end{pmatrix}\n= \\sum_{i=1}^{4} N_{i}(\\xi,\\eta) \\begin{pmatrix} x_{i} \\\\ y_{i} \\end{pmatrix}\n+ \\begin{pmatrix} 0 \\\\ c\\,(1-\\xi^{2})(1-\\eta^{2}) \\end{pmatrix},\n$$\nwhere the bilinear shape functions associated with the four corners are\n$$\nN_{1}(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta), \\quad\nN_{2}(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta), \\quad\nN_{3}(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta), \\quad\nN_{4}(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\nThe physical coordinates of the corners are\n$$\n(x_{1},y_{1}) = (-1,-1), \\quad (x_{2},y_{2}) = (2,-1), \\quad (x_{3},y_{3}) = (2,1.5), \\quad (x_{4},y_{4}) = (-1,1),\n$$\nand the bubble constant is $c = \\tfrac{1}{2}$.\n\nUsing the fundamental definitions of covariant base vectors and the metric tensor for a parametric surface,\n$$\n\\boldsymbol{a}_{1}(\\xi,\\eta) = \\frac{\\partial \\boldsymbol{X}}{\\partial \\xi}, \\qquad\n\\boldsymbol{a}_{2}(\\xi,\\eta) = \\frac{\\partial \\boldsymbol{X}}{\\partial \\eta}, \\qquad\nG(\\xi,\\eta) = \\begin{pmatrix} g_{11}  g_{12} \\\\ g_{21}  g_{22} \\end{pmatrix} \\text{ with } g_{\\alpha\\beta} = \\boldsymbol{a}_{\\alpha}\\cdot\\boldsymbol{a}_{\\beta},\n$$\nperform the following tasks at the two specified quadrature nodes:\n$$\nQ_{1}: (\\xi,\\eta) = (0,0), \\qquad Q_{2}: (\\xi,\\eta) = \\left(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right).\n$$\n\n1. Compute the covariant base vectors $\\boldsymbol{a}_{1}$ and $\\boldsymbol{a}_{2}$ at $Q_{1}$ and $Q_{2}$.\n2. Compute the metric tensor $G$ at $Q_{1}$ and $Q_{2}$.\n3. Compute the inverse metric $G^{-1}$ at $Q_{1}$ and $Q_{2}$.\n4. Verify at each node that $G$ is symmetric positive definite using the principal minor (Sylvester) criterion.\n\nFinally, let $\\lambda_{\\min}(Q)$ denote the smaller of the two eigenvalues of $G$ at node $Q$. Report the single quantity\n$$\n\\min\\big\\{\\lambda_{\\min}(Q_{1}),\\,\\lambda_{\\min}(Q_{2})\\big\\}\n$$\nrounded to six significant figures. No units are required, and angles (if any arise) must be in radians.", "solution": "The physical mapping $\\boldsymbol{X}(\\xi,\\eta)$ is defined by\n$$\n\\boldsymbol{X}(\\xi,\\eta) = \\begin{pmatrix} x(\\xi,\\eta) \\\\ y(\\xi,\\eta) \\end{pmatrix}\n= \\sum_{i=1}^{4} N_{i}(\\xi,\\eta) \\begin{pmatrix} x_{i} \\\\ y_{i} \\end{pmatrix}\n+ \\begin{pmatrix} 0 \\\\ c\\,(1-\\xi^{2})(1-\\eta^{2}) \\end{pmatrix}.\n$$\nFirst, we determine the explicit form of the mapping components $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$.\n\nThe $x$-component of the mapping is purely bilinear:\n$$\nx(\\xi,\\eta) = \\frac{1}{4} \\left[ x_1(1-\\xi)(1-\\eta) + x_2(1+\\xi)(1-\\eta) + x_3(1+\\xi)(1+\\eta) + x_4(1-\\xi)(1+\\eta) \\right].\n$$\nSubstituting the corner coordinates $(x_1, x_2, x_3, x_4) = (-1, 2, 2, -1)$:\n$$\nx(\\xi,\\eta) = \\frac{1}{4} \\left[ -1(1-\\xi)(1-\\eta) + 2(1+\\xi)(1-\\eta) + 2(1+\\xi)(1+\\eta) - 1(1-\\xi)(1+\\eta) \\right].\n$$\nExpanding and collecting terms for $1$, $\\xi$, $\\eta$, and $\\xi\\eta$:\n$$\nx(\\xi,\\eta) = \\frac{1}{4} \\left[ (-1+2+2-1) + \\xi(1+2+2+1) + \\eta(1-2+2-1) + \\xi\\eta(-1-2+2+1) \\right]\n$$\n$$\nx(\\xi,\\eta) = \\frac{1}{4} [2 + 6\\xi] = \\frac{1}{2} + \\frac{3}{2}\\xi.\n$$\n\nThe $y$-component of the mapping has a bilinear part and a bubble part:\n$y(\\xi,\\eta) = y_{\\text{bilinear}}(\\xi,\\eta) + y_{\\text{bubble}}(\\xi,\\eta)$.\nThe bilinear part with corner coordinates $(y_1, y_2, y_3, y_4) = (-1, -1, 1.5, 1)$ is:\n$$\ny_{\\text{bilinear}}(\\xi,\\eta) = \\frac{1}{4} \\left[ -1(1-\\xi)(1-\\eta) - 1(1+\\xi)(1-\\eta) + 1.5(1+\\xi)(1+\\eta) + 1(1-\\xi)(1+\\eta) \\right].\n$$\nExpanding and collecting terms:\n$$\ny_{\\text{bilinear}}(\\xi,\\eta) = \\frac{1}{4} \\left[ (0.5) + \\xi(0.5) + \\eta(4.5) + \\xi\\eta(0.5) \\right]\n$$\n$$\ny_{\\text{bilinear}}(\\xi,\\eta) = \\frac{1}{8}(1 + \\xi + 9\\eta + \\xi\\eta).\n$$\nThe bubble part with $c=1/2$ is $y_{\\text{bubble}}(\\xi,\\eta) = \\frac{1}{2}(1-\\xi^2)(1-\\eta^2)$.\nThus, the full $y$-component is:\n$$\ny(\\xi,\\eta) = \\frac{1}{8}(1 + \\xi + 9\\eta + \\xi\\eta) + \\frac{1}{2}(1-\\xi^{2})(1-\\eta^{2}).\n$$\n\nThe covariant base vectors $\\boldsymbol{a}_{1}$ and $\\boldsymbol{a}_{2}$ are the partial derivatives of $\\boldsymbol{X}$ with respect to $\\xi$ and $\\eta$:\n$$\n\\boldsymbol{a}_{1}(\\xi,\\eta) = \\frac{\\partial \\boldsymbol{X}}{\\partial \\xi} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} \\\\ \\frac{\\partial y}{\\partial \\xi} \\end{pmatrix}, \\qquad \\boldsymbol{a}_{2}(\\xi,\\eta) = \\frac{\\partial \\boldsymbol{X}}{\\partial \\eta} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}.\n$$\nThe partial derivatives are:\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{3}{2}$\n$\\frac{\\partial x}{\\partial \\eta} = 0$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{8}(1+\\eta) + \\frac{1}{2}(-2\\xi)(1-\\eta^2) = \\frac{1}{8}(1+\\eta) - \\xi(1-\\eta^2)$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{8}(9+\\xi) + \\frac{1}{2}(1-\\xi^2)(-2\\eta) = \\frac{1}{8}(9+\\xi) - \\eta(1-\\xi^2)$\n\nSo the base vectors are:\n$$\n\\boldsymbol{a}_{1}(\\xi,\\eta) = \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{1}{8}(1+\\eta) - \\xi(1-\\eta^2) \\end{pmatrix}, \\qquad\n\\boldsymbol{a}_{2}(\\xi,\\eta) = \\begin{pmatrix} 0 \\\\ \\frac{1}{8}(9+\\xi) - \\eta(1-\\xi^2) \\end{pmatrix}.\n$$\n\nWe now evaluate these quantities at the specified nodes $Q_1$ and $Q_2$.\n\n**Analysis at Node $Q_1: (\\xi,\\eta) = (0,0)$**\n\n1.  **Covariant Base Vectors at $Q_1$**:\n    $$\n    \\boldsymbol{a}_{1}(0,0) = \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{1}{8}(1+0) - 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{1}{8} \\end{pmatrix}\n    $$\n    $$\n    \\boldsymbol{a}_{2}(0,0) = \\begin{pmatrix} 0 \\\\ \\frac{1}{8}(9+0) - 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{9}{8} \\end{pmatrix}\n    $$\n\n2.  **Metric Tensor $G$ at $Q_1$**:\n    $g_{11} = \\boldsymbol{a}_{1} \\cdot \\boldsymbol{a}_{1} = (\\frac{3}{2})^2 + (\\frac{1}{8})^2 = \\frac{9}{4} + \\frac{1}{64} = \\frac{144+1}{64} = \\frac{145}{64}$.\n    $g_{12} = g_{21} = \\boldsymbol{a}_{1} \\cdot \\boldsymbol{a}_{2} = (\\frac{3}{2})(0) + (\\frac{1}{8})(\\frac{9}{8}) = \\frac{9}{64}$.\n    $g_{22} = \\boldsymbol{a}_{2} \\cdot \\boldsymbol{a}_{2} = (0)^2 + (\\frac{9}{8})^2 = \\frac{81}{64}$.\n    $$\n    G(Q_1) = \\begin{pmatrix} \\frac{145}{64}  \\frac{9}{64} \\\\ \\frac{9}{64}  \\frac{81}{64} \\end{pmatrix} = \\frac{1}{64}\\begin{pmatrix} 145  9 \\\\ 9  81 \\end{pmatrix}.\n    $$\n\n3.  **Inverse Metric $G^{-1}$ at $Q_1$**:\n    The determinant of $G(Q_1)$ is $\\det(G(Q_1)) = g_{11}g_{22} - g_{12}^2 = (\\frac{145}{64})(\\frac{81}{64}) - (\\frac{9}{64})^2 = \\frac{11745-81}{4096} = \\frac{11664}{4096} = \\frac{729}{256}$.\n    $$\n    G^{-1}(Q_1) = \\frac{1}{\\det(G(Q_1))} \\begin{pmatrix} g_{22}  -g_{12} \\\\ -g_{21}  g_{11} \\end{pmatrix} = \\frac{256}{729} \\begin{pmatrix} \\frac{81}{64}  -\\frac{9}{64} \\\\ -\\frac{9}{64}  \\frac{145}{64} \\end{pmatrix} = \\frac{4}{729} \\begin{pmatrix} 81  -9 \\\\ -9  145 \\end{pmatrix}.\n    $$\n    $$\n    G^{-1}(Q_1) = \\begin{pmatrix} \\frac{324}{729}  -\\frac{36}{729} \\\\ -\\frac{36}{729}  \\frac{580}{729} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{9}  -\\frac{4}{81} \\\\ -\\frac{4}{81}  \\frac{580}{729} \\end{pmatrix}.\n    $$\n\n4.  **Symmetry and Positive Definiteness of $G(Q_1)$**:\n    $G(Q_1)$ is symmetric by construction. For positive definiteness, we check the leading principal minors:\n    - $g_{11} = \\frac{145}{64}  0$.\n    - $\\det(G(Q_1)) = \\frac{729}{256}  0$.\n    Both minors are positive, so $G(Q_1)$ is symmetric positive definite (SPD).\n\n**Analysis at Node $Q_2: (\\xi,\\eta) = (\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$**\n\nLet $\\xi_0 = 1/\\sqrt{3}$ and $\\eta_0 = -1/\\sqrt{3}$. Note that $\\xi_0^2 = \\eta_0^2 = 1/3$.\n\n1.  **Covariant Base Vectors at $Q_2$**:\n    $y_\\xi = \\frac{1}{8}(1+\\eta_0) - \\xi_0(1-\\eta_0^2) = \\frac{1}{8}(1 - \\frac{1}{\\sqrt{3}}) - \\frac{1}{\\sqrt{3}}(1-\\frac{1}{3}) = \\frac{1}{8} - \\frac{\\sqrt{3}}{24} - \\frac{2\\sqrt{3}}{9} = \\frac{1}{8} - \\sqrt{3}(\\frac{3+16}{72}) = \\frac{9-19\\sqrt{3}}{72}$.\n    $y_\\eta = \\frac{1}{8}(9+\\xi_0) - \\eta_0(1-\\xi_0^2) = \\frac{1}{8}(9+\\frac{1}{\\sqrt{3}}) - (-\\frac{1}{\\sqrt{3}})(1-\\frac{1}{3}) = \\frac{9}{8} + \\frac{\\sqrt{3}}{24} + \\frac{2\\sqrt{3}}{9} = \\frac{9}{8} + \\frac{19\\sqrt{3}}{72} = \\frac{81+19\\sqrt{3}}{72}$.\n    $$\n    \\boldsymbol{a}_{1}(Q_2) = \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{9-19\\sqrt{3}}{72} \\end{pmatrix}, \\qquad\n    \\boldsymbol{a}_{2}(Q_2) = \\begin{pmatrix} 0 \\\\ \\frac{81+19\\sqrt{3}}{72} \\end{pmatrix}.\n    $$\n\n2.  **Metric Tensor $G$ at $Q_2$**:\n    The Jacobian determinant is $\\det(J) = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi} = (\\frac{3}{2})(\\frac{81+19\\sqrt{3}}{72}) - 0 = \\frac{81+19\\sqrt{3}}{48}$. Since $\\det(G) = (\\det(J))^2$, we have $\\det(G(Q_2)) = (\\frac{81+19\\sqrt{3}}{48})^2$. The exact form of the components of $G(Q_2)$ are complex, but can be computed. For eigenvalues, we proceed numerically from the base vectors.\n\n3.  **Inverse Metric $G^{-1}$ at $Q_2$ and SPD check**:\n    Since $\\det(J(Q_2)) = \\frac{81+19\\sqrt{3}}{48} \\approx 2.3725 > 0$, the determinant of $G(Q_2)$ is positive. The component $g_{11}(Q_2) = (\\frac{3}{2})^2 + (\\frac{9-19\\sqrt{3}}{72})^2 > 0$. Since both leading principal minors are positive, $G(Q_2)$ is also SPD.\n\n**Eigenvalue Computation**\n\nThe smaller eigenvalue $\\lambda_{\\min}$ of a $2 \\times 2$ matrix $M$ is given by $\\lambda_{\\min} = \\frac{\\text{tr}(M) - \\sqrt{\\text{tr}(M)^2 - 4\\det(M)}}{2}$.\n\n**For $G(Q_1)$**:\n$\\text{tr}(G(Q_1)) = \\frac{145}{64} + \\frac{81}{64} = \\frac{226}{64} = \\frac{113}{32}$.\n$\\det(G(Q_1)) = \\frac{729}{256}$.\n$\\text{tr}^2 - 4\\det = (\\frac{113}{32})^2 - 4(\\frac{729}{256}) = \\frac{12769}{1024} - \\frac{2916}{256} = \\frac{12769 - 11664}{1024} = \\frac{1105}{1024}$.\n$\\lambda_{\\min}(Q_1) = \\frac{1}{2}\\left( \\frac{113}{32} - \\sqrt{\\frac{1105}{1024}} \\right) = \\frac{1}{2}\\left( \\frac{113 - \\sqrt{1105}}{32} \\right) = \\frac{113 - \\sqrt{1105}}{64}$.\nNumerically, $\\lambda_{\\min}(Q_1) \\approx \\frac{113 - 33.24154}{64} \\approx \\frac{79.75846}{64} \\approx 1.2462259$.\n\n**For $G(Q_2)$**:\n$y_\\xi \\approx -0.33235$, $y_\\eta \\approx 1.57943$.\n$\\boldsymbol{a}_1(Q_2) \\approx (1.5, -0.33235)^T$, $\\boldsymbol{a}_2(Q_2) \\approx (0, 1.57943)^T$.\n$g_{11} \\approx 1.5^2 + (-0.33235)^2 \\approx 2.25 + 0.11046 = 2.36046$.\n$g_{12} \\approx 1.5(0) + (-0.33235)(1.57943) \\approx -0.52504$.\n$g_{22} \\approx 0^2 + 1.57943^2 \\approx 2.49462$.\n$\\text{tr}(G(Q_2)) \\approx 2.36046 + 2.49462 = 4.85508$.\n$\\det(G(Q_2)) = (\\det(J(Q_2)))^2 \\approx (2.3725)^2 \\approx 5.62876$.\n$\\text{tr}^2 - 4\\det \\approx 4.85508^2 - 4(5.62876) \\approx 23.5718 - 22.51504 = 1.05676$.\n$\\lambda_{\\min}(Q_2) \\approx \\frac{4.85508 - \\sqrt{1.05676}}{2} \\approx \\frac{4.85508 - 1.02799}{2} \\approx 1.913545$.\n\n**Final Comparison**\nWe need to find $\\min\\big\\{\\lambda_{\\min}(Q_{1}),\\,\\lambda_{\\min}(Q_{2})\\big\\}$.\n$\\lambda_{\\min}(Q_1) \\approx 1.2462259$\n$\\lambda_{\\min}(Q_2) \\approx 1.913545$\nThe minimum value is $\\lambda_{\\min}(Q_1)$.\n\nThe required value is $\\frac{113 - \\sqrt{1105}}{64}$, rounded to six significant figures.\n$\\frac{113 - \\sqrt{1105}}{64} \\approx 1.246225933 \\dots$\nRounding to six significant figures gives $1.24623$.", "answer": "$$\\boxed{1.24623}$$", "id": "3362711"}]}