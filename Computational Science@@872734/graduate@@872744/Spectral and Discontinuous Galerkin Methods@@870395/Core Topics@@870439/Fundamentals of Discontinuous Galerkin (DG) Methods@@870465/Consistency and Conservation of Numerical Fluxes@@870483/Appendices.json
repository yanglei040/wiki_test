{"hands_on_practices": [{"introduction": "We begin by exploring the mathematical foundation of conservation for equations of the form $\\partial_t u + \\partial_x f(u) = 0$ in the Discontinuous Galerkin (DG) framework. This practice challenges you to derive the fundamental condition for global mass conservation, $\\frac{d}{dt} \\int u_h \\, dx = 0$, by analyzing a hypothetical scenario with mismatched interface fluxes, revealing from first principles why a single-valued numerical flux is the cornerstone of a conservative scheme [@problem_id:3373203].", "problem": "Consider the linear scalar conservation law $u_{t} + a\\,u_{x} = 0$ on a periodic interval $[0,L]$ with $L>0$ and constant speed $a \\in \\mathbb{R}\\setminus\\{0\\}$. Let the domain be partitioned into $N \\geq 2$ non-overlapping elements $\\{K_{j}\\}_{j=1}^{N}$ with interfaces at points $x_{j+\\frac{1}{2}}$. A standard Discontinuous Galerkin (DG) method approximates $u$ by $u_{h}$ in a polynomial space of fixed degree on each element and enforces a conservative weak form using a two-point numerical flux at element interfaces.\n\nYou are tasked with diagnostics and verification of conservation for a perturbed implementation in which the left element and the right element adjacent to an interface $x_{j+\\frac{1}{2}}$ use different two-point numerical fluxes. Specifically, for each interior interface, define the left and right fluxes by\n$$\n\\widehat{f}^{(L)}_{\\theta}(u^-,u^+) \\coloneqq a((1-\\theta)\\,u^- + \\theta\\,u^+), \\qquad\n\\widehat{f}^{(R)}_{\\phi}(u^-,u^+) \\coloneqq a((1-\\phi)\\,u^- + \\phi\\,u^+),\n$$\nwhere $u^{-}$ and $u^{+}$ are the traces of $u_{h}$ from the left and right of the interface, respectively, and $\\theta,\\phi \\in \\mathbb{R}$ are fixed parameters. Assume that at the periodic boundary the same left/right split is applied consistently so that all interfaces are treated uniformly.\n\nDefine the global discrete mass diagnostic\n$$\nM_{h}(t) \\coloneqq \\sum_{j=1}^{N}\\int_{K_{j}} u_{h}(x,t)\\,dx,\n$$\nand let $\\frac{d}{dt}M_{h}(t)$ denote its time rate-of-change predicted by the semidiscrete DG method. Starting only from the conservation law and the defining properties of the Discontinuous Galerkin weak form (namely, elementwise testing and interface coupling through numerical fluxes), perform the following:\n\n- Derive an expression for $\\frac{d}{dt}M_{h}(t)$ in terms of the interface traces $u^{-}$, $u^{+}$ and the parameters $\\theta,\\phi$, under the periodic boundary condition.\n- Impose a verification requirement: the diagnostic must identically vanish, $\\frac{d}{dt}M_{h}(t)\\equiv 0$, for all piecewise-polynomial states $u_{h}$ and all times $t$, thereby certifying global conservation.\n- Suppose the right flux is fixed to the central choice by setting $\\phi=\\tfrac{1}{2}$. Determine the unique value of $\\theta$ that guarantees the diagnostic vanishes for all $u_{h}$.\n\nYour final answer must be the single value of $\\theta$ as a real number. No rounding is required and no units are involved. Express the final answer in exact form.", "solution": "The problem requires us to determine the condition for global mass conservation in a Discontinuous Galerkin (DG) scheme with a non-standard interface flux formulation for the linear advection equation $u_t + a u_x = 0$.\n\nLet the computational domain $[0, L]$ be partitioned into $N$ elements $K_j = [x_{j-1/2}, x_{j+1/2}]$ for $j=1, \\dots, N$. The DG semi-discrete weak formulation for an element $K_j$ is obtained by multiplying the PDE by a test function $v_h$ from the same polynomial space as the approximation $u_h$, integrating over $K_j$, and applying integration by parts to the spatial derivative term:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\,dx - \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx + \\left[ \\widehat{f} v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\nwhere $\\widehat{f}$ represents the numerical flux. The last term expands to $\\widehat{f}_{j+1/2} v_h(x_{j+1/2}^-) - \\widehat{f}_{j-1/2} v_h(x_{j-1/2}^+)$. The problem specifies a peculiar setup where the numerical flux used depends on which side of the interface the element lies. For an element $K_j$, its right boundary is $x_{j+1/2}$ and its left boundary is $x_{j-1/2}$. At interface $x_{j+1/2}$, $K_j$ is the \"left element\". At interface $x_{j-1/2}$, $K_j$ is the \"right element\".\n\nAccording to the problem statement, the flux term for the weak form on element $K_j$ is evaluated using $\\widehat{f}^{(L)}$ at its right boundary $x_{j+1/2}$ and $\\widehat{f}^{(R)}$ at its left boundary $x_{j-1/2}$. Let us denote the traces of $u_h$ at an interface $x_{j+1/2}$ as $u_j^+ = u_h(x_{j+1/2}^-)$ from element $K_j$ and $u_{j+1}^- = u_h(x_{j+1/2}^+)$ from element $K_{j+1}$. The weak form for element $K_j$ is thus:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\,dx = \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx - \\widehat{f}^{(L)}_{\\theta}(u_j^+, u_{j+1}^-) v_h(x_{j+1/2}^-) + \\widehat{f}^{(R)}_{\\phi}(u_{j-1}^+, u_j^-) v_h(x_{j-1/2}^+)\n$$\nwhere indices are understood to be periodic, i.e., $j=0$ is equivalent to $j=N$.\n\nTo find the time rate-of-change of the mass on element $K_j$, we set the test function $v_h(x) = 1$. With this choice, $\\frac{\\partial v_h}{\\partial x} = 0$, and the equation simplifies to:\n$$\n\\frac{d}{dt} \\int_{K_j} u_h \\,dx = \\widehat{f}^{(R)}_{\\phi}(u_{j-1}^+, u_j^-) - \\widehat{f}^{(L)}_{\\theta}(u_j^+, u_{j+1}^-)\n$$\n\nThe global discrete mass is $M_h(t) = \\sum_{j=1}^{N}\\int_{K_j} u_{h}(x,t)\\,dx$. Its time derivative is the sum of the time derivatives of the mass on each element:\n$$\n\\frac{d}{dt}M_{h}(t) = \\sum_{j=1}^{N} \\frac{d}{dt} \\int_{K_j} u_h \\,dx = \\sum_{j=1}^{N} \\left[ \\widehat{f}^{(R)}_{\\phi}(u_{j-1}^+, u_j^-) - \\widehat{f}^{(L)}_{\\theta}(u_j^+, u_{j+1}^-) \\right]\n$$\nWe can re-organize this sum. The terms $\\widehat{f}^{(R)}_{\\phi}(u_{j-1}^+, u_j^-)$ and $\\widehat{f}^{(L)}_{\\theta}(u_{j-1}^+, u_j^-)$ relate to the same interface $x_{j-1/2}$. Let's re-index the sum to be over interfaces instead of elements. Due to periodicity, there are $N$ interfaces. Let's consider the interface $x_{j+1/2}$ for $j=1, \\dots, N$. The traces at this interface are $u_j^+$ (from the left, element $K_j$) and $u_{j+1}^-$ (from the right, element $K_{j+1}$).\nThe term $-\\widehat{f}^{(L)}_{\\theta}(u_j^+, u_{j+1}^-)$ comes from the equation for element $K_j$.\nThe term $+\\widehat{f}^{(R)}_{\\phi}(u_j^+, u_{j+1}^-)$ comes from the equation for element $K_{j+1}$ (at its left boundary).\nSumming over all elements $j=1, \\dots, N$ is thus equivalent to summing over all interfaces the net flux exchange. At each interface, the net effect on the total mass is the flux entering the right element minus the flux leaving the left element.\n$$\n\\frac{d}{dt}M_{h}(t) = \\sum_{j=1}^{N} \\left[ \\widehat{f}^{(R)}_{\\phi}(u_{j}^+, u_{j+1}^-) - \\widehat{f}^{(L)}_{\\theta}(u_{j}^+, u_{j+1}^-) \\right]\n$$\nThis provides the derived expression for $\\frac{d}{dt}M_{h}(t)$. Now, we substitute the given definitions of the numerical fluxes. At a generic interface, let $u^{-}$ be the left trace and $u^{+}$ be the right trace.\n$\\widehat{f}^{(L)}_{\\theta}(u^-, u^+) = a((1-\\theta)u^- + \\theta u^+)$\n$\\widehat{f}^{(R)}_{\\phi}(u^-, u^+) = a((1-\\phi)u^- + \\phi u^+)$\nAt interface $x_{j+1/2}$, we have $u^- \\equiv u_j^+$ and $u^+ \\equiv u_{j+1}^-$.\n$$\n\\frac{d}{dt}M_{h}(t) = \\sum_{j=1}^{N} \\left[ a\\left((1-\\phi)u_j^+ + \\phi u_{j+1}^-\\right) - a\\left((1-\\theta)u_j^+ + \\theta u_{j+1}^-\\right) \\right]\n$$\nCombining terms with the same traces:\n$$\n\\frac{d}{dt}M_{h}(t) = a \\sum_{j=1}^{N} \\left[ (1-\\phi - (1-\\theta)) u_j^+ + (\\phi - \\theta) u_{j+1}^- \\right]\n$$\n$$\n\\frac{d}{dt}M_{h}(t) = a \\sum_{j=1}^{N} \\left[ (\\theta - \\phi) u_j^+ - (\\theta - \\phi) u_{j+1}^- \\right]\n$$\n$$\n\\frac{d}{dt}M_{h}(t) = a(\\theta - \\phi) \\sum_{j=1}^{N} \\left( u_j^+ - u_{j+1}^- \\right)\n$$\nThe conservation requirement is that $\\frac{d}{dt}M_{h}(t) \\equiv 0$ for all valid piecewise-polynomial functions $u_h$.\nThe sum $\\sum_{j=1}^{N} (u_j^+ - u_{j+1}^-)$ can be rewritten. Using periodicity, $\\sum_{j=1}^{N} u_{j+1}^- = \\sum_{j=1}^{N} u_j^-$.\nThus, the sum is $\\sum_{j=1}^{N} (u_j^+ - u_j^-)$.\nThe term $u_j^+ - u_j^-$ is the difference between the trace of the polynomial in element $K_j$ at its right boundary and its left boundary. This is equal to $\\int_{K_j} \\frac{\\partial u_h}{\\partial x} dx$.\nThe total sum is $\\sum_{j=1}^N \\int_{K_j} \\frac{\\partial u_h}{\\partial x} dx$. This sum is not in general zero for an arbitrary discontinuous function $u_h$. For example, if we choose $u_h$ to be a linear polynomial with a non-zero slope on one element $K_k$ and zero on all other elements, the sum will be non-zero.\nTherefore, for the total expression to be identically zero for any $u_h$, the coefficient must vanish. Since $a \\neq 0$, we must have:\n$$\n\\theta - \\phi = 0 \\implies \\theta = \\phi\n$$\nThis result confirms the fundamental principle that to ensure conservation, the numerical flux must be single-valued at each interface; that is, the flux leaving one element must be identical to the flux entering the adjacent element.\n\nThe problem states that the right flux is fixed to the central choice by setting $\\phi=\\frac{1}{2}$. To guarantee conservation, we must have $\\theta=\\phi$.\nTherefore, the unique value of $\\theta$ that guarantees the diagnostic vanishes for all $u_h$ is:\n$$\n\\theta = \\frac{1}{2}\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3373203"}, {"introduction": "Building on the necessity of a single-valued flux, this exercise investigates a critical implementation detail where discrete conservation can unintentionally fail. This problem demonstrates how using different quadrature rules to approximate interface integrals like $\\int_{\\Gamma} F^* \\cdot \\boldsymbol{n} \\, dS$ can create a numerical \"leakage,\" breaking conservation even with a consistent flux formulation [@problem_id:3373214]. You will not only quantify this effect but also analyze the mechanism by which modern split-form discretizations restore exact cancellation.", "problem": "Consider the scalar conservation law $u_{t} + \\nabla \\cdot \\boldsymbol{f}(u) = 0$ in two spatial dimensions, with flux $\\boldsymbol{f}(u) = \\left(\\tfrac{1}{2}u^{2}, 0\\right)$. Focus on a single straight vertical interface segment of physical length $2$, parameterized by $t \\in [-1,1]$. Two adjacent quadrilateral elements $K_{L}$ and $K_{R}$ share this interface. Assume the trace of the solution at the interface is single-valued and given by $u(t) = t^{3} + t$, so that any consistent numerical flux satisfies $F^{*}(u,u) = f(u)$ and, for this problem, $F^{*}(u,u) = \\tfrac{1}{2}u^{2}$. \n\nEach element computes its own contribution to the surface integral along the shared interface using its local quadrature rule:\n- The left element $K_{L}$ uses a Gauss–Legendre quadrature with $N_{L} = 2$ points at $t = \\pm 1/\\sqrt{3}$ and weights $w_{i} = 1$ for $i = 1,2$.\n- The right element $K_{R}$ uses the midpoint rule with $N_{R} = 1$ point at $t = 0$ and weight $w = 2$.\n\nIn a Discontinuous Galerkin (DG) method, discrete conservation across the interface requires that, after accounting for opposite outward normals, the two elements’ surface contributions cancel exactly when evaluated with a consistent numerical flux. Show that flux consistency $F^{*}(u,u) = f(u)$ is insufficient to guarantee discrete conservation when the surface quadrature is under-integrated and non-matching across the two elements.\n\nDefine the aliasing-induced discrete leakage across the interface as \n$$\nL := \\sum_{i=1}^{N_{L}} w_{i}\\, f\\!\\left(u(t_{i})\\right) \\;-\\; \\sum_{j=1}^{N_{R}} w_{j}\\, f\\!\\left(u(\\tau_{j})\\right),\n$$\nwhere $\\{t_{i}\\}$ and $\\{\\tau_{j}\\}$ denote the left and right quadrature nodes, respectively. Compute $L$ explicitly for $u(t) = t^{3} + t$ and $f(u) = \\tfrac{1}{2}u^{2}$, and provide $L$ as a single simplified rational number.\n\nFinally, explain how split-form flux differencing based on a symmetric two-point flux and the Summation-By-Parts (SBP) property, applied on a common interface quadrature, eliminates this leakage for $f(u) = \\tfrac{1}{2}u^{2}$ by restoring exact discrete cancellation of the two elements’ contributions. No numerical value is required for this last part; focus on the mechanistic reason why the split form fixes the mismatch.\n\nExpress the final value of $L$ as a simplified rational number. No rounding is required.", "solution": "The problem investigates the discrete conservation of flux across an interface shared by two elements, $K_L$ and $K_R$. In a DG framework, the sum of the numerical flux contributions from each element at their common interface must be zero for the scheme to be locally and globally conservative. For a vertical interface, the outward unit normal for the left element is $\\boldsymbol{n}_L = (1, 0)$ and for the right element is $\\boldsymbol{n}_R = (-1, 0)$. The total flux exchange across the interface is discretized. The contribution from $K_L$ is an approximation of $\\int_{-1}^{1} F^*_x(u_L, u_R) dt$, and the contribution from $K_R$ is an approximation of $\\int_{-1}^{1} F^*_x(u_R, u_L) dt$ where the roles of interior and exterior solutions are swapped. The total discrete flux across the interface is the sum of contributions from both elements, taking into account the opposite normals.\n\nThe problem states that the solution trace is single-valued, $u(t) = t^3 + t$, implying $u_L = u_R = u(t)$, and a consistent numerical flux is used, meaning $F^*(u,u) = f(u)$. Here, the scalar flux is $f(u) = \\frac{1}{2}u^2$. The discrete surface integral from $K_L$ is $\\sum_{i=1}^{N_L} w_i f(u(t_i)) n_{L,x}$ and from $K_R$ is $\\sum_{j=1}^{N_R} w_j f(u(\\tau_j)) n_{R,x}$. Since $n_{L,x}=1$ and $n_{R,x}=-1$, the net flux across the interface, referred to as the aliasing-induced discrete leakage $L$, is defined as:\n$$\nL := \\sum_{i=1}^{N_{L}} w_{i}\\, f(u(t_{i})) - \\sum_{j=1}^{N_{R}} w_{j}\\, f(u(\\tau_{j}))\n$$\nDiscrete conservation is achieved if and only if $L=0$. We will compute $L$ using the given data.\n\nFirst, we evaluate the function $f(u(t))$:\n$$\nf(u(t)) = \\frac{1}{2} (u(t))^2 = \\frac{1}{2} (t^3 + t)^2 = \\frac{1}{2} (t^6 + 2t^4 + t^2)\n$$\nThis is a polynomial of degree $6$.\n\nNext, we compute the sum for the left element, $S_L$, using the $N_L=2$ point Gauss-Legendre quadrature with nodes $t_1 = -1/\\sqrt{3}$, $t_2 = 1/\\sqrt{3}$ and weights $w_1=1$, $w_2=1$.\nWe evaluate the solution $u(t)$ at the quadrature nodes:\n$$u(t_1) = u\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\left(-\\frac{1}{\\sqrt{3}}\\right)^3 + \\left(-\\frac{1}{\\sqrt{3}}\\right) = -\\frac{1}{3\\sqrt{3}} - \\frac{1}{\\sqrt{3}} = -\\frac{4}{3\\sqrt{3}}$$\n$$u(t_2) = u\\left(\\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{1}{\\sqrt{3}}\\right)^3 + \\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{3\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{4}{3\\sqrt{3}}$$\nNow, we evaluate the flux function $f(u)$ at these values:\n$$f(u(t_1)) = \\frac{1}{2} \\left(-\\frac{4}{3\\sqrt{3}}\\right)^2 = \\frac{1}{2} \\left(\\frac{16}{9 \\cdot 3}\\right) = \\frac{1}{2} \\cdot \\frac{16}{27} = \\frac{8}{27}$$\n$$f(u(t_2)) = \\frac{1}{2} \\left(\\frac{4}{3\\sqrt{3}}\\right)^2 = \\frac{1}{2} \\left(\\frac{16}{9 \\cdot 3}\\right) = \\frac{1}{2} \\cdot \\frac{16}{27} = \\frac{8}{27}$$\nThe quadrature sum for the left element is:\n$$S_L = \\sum_{i=1}^{2} w_i f(u(t_i)) = (1) \\cdot \\frac{8}{27} + (1) \\cdot \\frac{8}{27} = \\frac{16}{27}$$\n\nNext, we compute the sum for the right element, $S_R$, using the $N_R=1$ point midpoint rule with node $\\tau_1 = 0$ and weight $w=2$.\nWe evaluate the solution $u(t)$ at the quadrature node:\n$$u(\\tau_1) = u(0) = 0^3 + 0 = 0$$\nNow, we evaluate the flux function $f(u)$ at this value:\n$$f(u(0)) = \\frac{1}{2} (0)^2 = 0$$\nThe quadrature sum for the right element is:\n$$S_R = \\sum_{j=1}^{1} w_j f(u(\\tau_j)) = (2) \\cdot 0 = 0$$\n\nFinally, we compute the discrete leakage $L$:\n$$L = S_L - S_R = \\frac{16}{27} - 0 = \\frac{16}{27}$$\nSince $L \\neq 0$, the discrete flux contributions from the two elements do not cancel. This demonstrates that flux consistency, $F^*(u,u)=f(u)$, is insufficient to guarantee discrete conservation when adjacent elements use non-matching and under-integrated quadrature rules for their surface integrals. The differing numerical approximations of the same integral $\\int_{-1}^1 f(u(t)) dt$ lead to a leakage of the conserved quantity at the discrete level.\n\nThe final part of the problem asks for an explanation of how split-form flux differencing, combined with the Summation-By-Parts (SBP) property and a common interface quadrature, resolves this issue. The mechanism relies on two key components: the use of a symmetric numerical flux and the obligatory use of a common quadrature rule for both elements on their shared interface.\n\nIn a DG scheme, conservation across an interface $\\Gamma$ between elements $K_L$ and $K_R$ requires the sum of the discrete surface integral approximations to be zero. Let the approximation for $K_L$ be $I_L$ and for $K_R$ be $I_R$. Taking into account the outward normals $\\boldsymbol{n}_R = -\\boldsymbol{n}_L$, we have:\n$I_L = \\sum_{k=1}^{N} c_k F^*(u_L(\\zeta_k), u_R(\\zeta_k)) \\cdot \\boldsymbol{n}_L(\\zeta_k)$\n$I_R = \\sum_{k=1}^{N} c_k F^*(u_R(\\zeta_k), u_L(\\zeta_k)) \\cdot \\boldsymbol{n}_R(\\zeta_k) = -\\sum_{k=1}^{N} c_k F^*(u_R(\\zeta_k), u_L(\\zeta_k)) \\cdot \\boldsymbol{n}_L(\\zeta_k)$\nHere, a crucial change has been made: both elements now use a **common quadrature rule** with nodes $\\{\\zeta_k\\}$ and weights $\\{c_k\\}$. This is a prerequisite for the cancellation. The total flux is $I_L + I_R$. For scalar flux in one direction, this becomes:\n$$I_L + I_R = \\sum_{k=1}^{N} c_k \\left[ F^*_x(u_L(\\zeta_k), u_R(\\zeta_k)) - F^*_x(u_R(\\zeta_k), u_L(\\zeta_k)) \\right] (n_L)_x$$\nThis sum is guaranteed to be zero, term by term, if the numerical flux is **symmetric** with respect to its arguments, i.e., $F^*(a, b) = F^*(b, a)$.\n\nThis is where split-form differencing for the quadratic flux $f(u) = \\frac{1}{2}u^2$ becomes relevant. The \"split form\" refers to rewriting the flux or its divergence in a form that, when discretized, leads to certain desirable properties like stability or conservation. For the quadratic flux, it is possible to construct a consistent two-point flux $F^*(a,b)$ that is also symmetric. A well-known example is the entropy-conservative flux:\n$$F^*(a, b) = \\frac{a^2 + ab + b^2}{6}$$\nThis flux is consistent since $F^*(u,u) = \\frac{u^2+u^2+u^2}{6} = \\frac{3u^2}{6} = \\frac{1}{2}u^2 = f(u)$, and it is symmetric since $F^*(a,b) = F^*(b,a)$.\n\nBy choosing such a symmetric flux and enforcing a common quadrature rule at the interface, the discrete surface terms from adjacent elements become equal and opposite, ensuring exact cancellation. This restores discrete conservation, eliminating the leakage, regardless of whether the common quadrature rule is accurate enough to integrate the flux polynomial exactly. The Summation-By-Parts (SBP) property is the general principle that guides the construction of such discretizations, ensuring that the discrete operators mimic the integration-by-parts formula, which is the foundation for proving conservation in the continuous setting. The combination of a symmetric flux and a common interface grid is the practical realization of the SBP principle at element interfaces in a DG or SBP-SAT context.", "answer": "$$\n\\boxed{\\frac{16}{27}}\n$$", "id": "3373214"}, {"introduction": "Having established the principles of spatial conservation, we now examine how these properties extend to a fully-discrete scheme. This exercise asks you to prove that the crucial property of mass conservation, carefully built into the semi-discretization, is exactly preserved when using a standard implicit time-stepping method like backward Euler [@problem_id:3373186]. Completing this proof solidifies the understanding that a conservative scheme maintains its integrity from the spatial formulation to the final time-marched algorithm.", "problem": "Consider the scalar conservation law $\\,\\partial_{t} u + \\partial_{x} f(u) = 0\\,$ on the periodic interval $\\,[0,L]\\,$ with $\\,L>0\\,$ and periodic boundary identification $\\,x=0\\,$ and $\\,x=L\\,$. Let $\\,\\{I_{j}\\}_{j=1}^{K}\\,$ be a partition of $\\,[0,L]\\,$ into $\\,K\\,$ nonoverlapping cells with interfaces $\\,\\{x_{j+\\tfrac{1}{2}}\\}_{j=0}^{K-1}\\,$ and periodic identification $\\,x_{\\tfrac{1}{2}} \\equiv x_{K+\\tfrac{1}{2}}\\,$. Let $\\,V_{h}\\,$ be the space of discontinuous, piecewise polynomials of degree at most $\\,p \\ge 0\\,$ on this mesh. Assume the constant function $\\,v \\equiv 1\\,$ belongs to $\\,V_{h}\\,$ on each cell.\n\nThe discontinuous Galerkin (DG) semi-discretization is defined as follows: find $\\,u_{h}(t) \\in V_{h}\\,$ such that, for each cell $\\,I_{j}\\,$ and for all test functions $\\,v \\in \\mathbb{P}^{p}(I_{j})\\,$,\n$$\n\\int_{I_{j}} \\partial_{t} u_{h}(x,t)\\, v(x)\\, \\mathrm{d}x \\;-\\; \\int_{I_{j}} f\\!\\big(u_{h}(x,t)\\big)\\, \\partial_{x} v(x)\\, \\mathrm{d}x \\;+\\; \\widehat{f}\\!\\big(u_{h}^{-},u_{h}^{+}\\big)\\big|_{x_{j+\\tfrac{1}{2}},t}\\, v\\!\\big(x_{j+\\tfrac{1}{2}}^{-}\\big) \\;-\\; \\widehat{f}\\!\\big(u_{h}^{-},u_{h}^{+}\\big)\\big|_{x_{j-\\tfrac{1}{2}},t}\\, v\\!\\big(x_{j-\\tfrac{1}{2}}^{+}\\big) \\;=\\; 0.\n$$\nHere $\\,\\widehat{f}:\\mathbb{R}\\times\\mathbb{R}\\to\\mathbb{R}\\,$ is a numerical flux function that is assumed to be both consistent and conservative in the following sense:\n- Consistency: $\\,\\widehat{f}(a,a) = f(a)\\,$ for all $\\,a \\in \\mathbb{R}\\,$.\n- Conservation: on an interior interface $\\,x_{j+\\tfrac{1}{2}}\\,$ shared by cells $\\,I_{j}\\,$ and $\\,I_{j+1}\\,$, the same single value $\\,\\widehat{f}\\!\\big(u_{h}^{-},u_{h}^{+}\\big)\\big|_{x_{j+\\tfrac{1}{2}},t}\\,$ is used in both cell equations with opposite orientation, i.e., it enters $\\,I_{j}\\,$ with a $\\,+\\,$ sign and $\\,I_{j+1}\\,$ with a $-\\,$ sign.\n\nConsider the backward Euler time discretization with time step $\\,\\Delta t>0\\,$. Given $\\,u_{h}^{n} \\in V_{h}\\,$ at time $\\,t^{n} = n \\Delta t\\,$, define $\\,u_{h}^{n+1} \\in V_{h}\\,$ at time $\\,t^{n+1} = (n+1)\\Delta t\\,$ by requiring, for each cell $\\,I_{j}\\,$ and all $\\,v \\in \\mathbb{P}^{p}(I_{j})\\,$,\n$$\n\\frac{1}{\\Delta t}\\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big)\\, v(x)\\, \\mathrm{d}x \\;-\\; \\int_{I_{j}} f\\!\\big(u_{h}^{n+1}(x)\\big)\\, \\partial_{x} v(x)\\, \\mathrm{d}x \\;+\\; \\widehat{f}^{\\,n+1}\\!\\big|_{x_{j+\\tfrac{1}{2}}}\\, v\\!\\big(x_{j+\\tfrac{1}{2}}^{-}\\big) \\;-\\; \\widehat{f}^{\\,n+1}\\!\\big|_{x_{j-\\tfrac{1}{2}}}\\, v\\!\\big(x_{j-\\tfrac{1}{2}}^{+}\\big) \\;=\\; 0,\n$$\nwhere $\\,\\widehat{f}^{\\,n+1}\\!\\big|_{x_{j+\\tfrac{1}{2}}} := \\widehat{f}\\!\\Big(u_{h}^{n+1,-}\\!\\big(x_{j+\\tfrac{1}{2}}\\big),\\, u_{h}^{n+1,+}\\!\\big(x_{j+\\tfrac{1}{2}}\\big)\\Big)\\,$ is the numerical flux evaluated from the left and right traces of $\\,u_{h}^{n+1}\\,$ at the interface $\\,x_{j+\\tfrac{1}{2}}\\,$.\n\nDefine the discrete total mass at time step $\\,n\\,$ by\n$$\nM^{n} \\;:=\\; \\sum_{j=1}^{K} \\int_{I_{j}} u_{h}^{n}(x)\\, \\mathrm{d}x,\n$$\nand define the cumulative mass error after $\\,N\\,$ backward Euler steps by\n$$\nE_{N} \\;:=\\; M^{N} \\;-\\; M^{0}.\n$$\n\nUsing only the stated properties of the numerical flux and the definitions above, compute the exact value of $\\,E_{N}\\,$ for the periodic problem on $\\,[0,L]\\,$. Express your final answer as a single closed-form expression with no unevaluated sums or integrals. No rounding is required.", "solution": "The objective is to compute the exact value of the cumulative mass error, $E_{N} = M^{N} - M^{0}$, after $N$ steps of the specified backward Euler discontinuous Galerkin (DG) scheme. The total discrete mass at time step $n$ is defined as $M^{n} = \\sum_{j=1}^{K} \\int_{I_{j}} u_{h}^{n}(x)\\, \\mathrm{d}x$.\n\nLet us first analyze the change in total mass over a single time step, from $t^n$ to $t^{n+1}$. The change is given by $M^{n+1} - M^{n}$.\nUsing the definition of $M^n$, we can write this change as:\n$$\nM^{n+1} - M^{n} = \\sum_{j=1}^{K} \\int_{I_{j}} u_{h}^{n+1}(x)\\, \\mathrm{d}x - \\sum_{j=1}^{K} \\int_{I_{j}} u_{h}^{n}(x)\\, \\mathrm{d}x = \\sum_{j=1}^{K} \\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big)\\, \\mathrm{d}x.\n$$\nTo evaluate this expression, we turn to the fully discrete DG scheme provided in the problem statement. The scheme holds for each cell $I_{j}$ and for all test functions $v \\in \\mathbb{P}^{p}(I_{j})$. The problem states that the polynomial degree $p \\ge 0$ and that the constant function $v(x) \\equiv 1$ belongs to the approximation space $V_h$ on each cell. Therefore, we can choose the specific test function $v(x) = 1$ for each cell $I_j$.\n\nWith $v(x) = 1$, we have $\\partial_{x} v(x) = 0$. The values of the test function at the cell boundaries are $v(x_{j+\\tfrac{1}{2}}^{-}) = 1$ and $v(x_{j-\\tfrac{1}{2}}^{+}) = 1$. Substituting these into the fully discrete scheme for a cell $I_j$:\n$$\n\\frac{1}{\\Delta t}\\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big) \\cdot 1\\, \\mathrm{d}x - \\int_{I_{j}} f(u_{h}^{n+1}(x)) \\cdot 0\\, \\mathrm{d}x + \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} \\cdot 1 - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\cdot 1 = 0.\n$$\nThe second term vanishes. Rearranging the equation gives an expression for the change in mass within cell $I_j$:\n$$\n\\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big)\\, \\mathrm{d}x = \\Delta t \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right).\n$$\nThis equation is a discrete statement of the fundamental theorem of calculus for cell $I_j$. To find the total change in mass $M^{n+1} - M^{n}$, we sum this relation over all cells $j=1, \\dots, K$:\n$$\nM^{n+1} - M^{n} = \\sum_{j=1}^{K} \\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big)\\, \\mathrm{d}x = \\sum_{j=1}^{K} \\Delta t \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right).\n$$\nLet us analyze the sum of the flux terms:\n$$\n\\sum_{j=1}^{K} \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right) = \\left( \\widehat{f}^{\\,n+1}|_{x_{1+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{1-\\tfrac{1}{2}}} \\right) + \\left( \\widehat{f}^{\\,n+1}|_{x_{2+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{2-\\tfrac{1}{2}}} \\right) + \\dots + \\left( \\widehat{f}^{\\,n+1}|_{x_{K+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{K-\\tfrac{1}{2}}} \\right).\n$$\nThe problem statement specifies that the numerical flux is conservative on interior interfaces. This means that the flux leaving cell $I_j$ at $x_{j+\\tfrac{1}{2}}$, denoted $\\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}}$, is the same value as the flux entering cell $I_{j+1}$ at its left boundary, which is also $x_{j+\\tfrac{1}{2}}$. Our formulation for cell $I_{j+1}$ uses $\\widehat{f}^{\\,n+1}|_{x_{(j+1)-\\tfrac{1}{2}}} = \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}}$. Consequently, the sum is telescoping. The term $-\\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}}$ from the $j$-th summand cancels with the term $+\\widehat{f}^{\\,n+1}|_{x_{(j+1)-\\tfrac{1}{2}}}$ from the $(j+1)$-th summand.\n\nAfter cancellation of all interior flux terms, only the fluxes at the domain boundaries remain:\n$$\n\\sum_{j=1}^{K} \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right) = \\widehat{f}^{\\,n+1}|_{x_{K+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{\\tfrac{1}{2}}}.\n$$\nThe problem is set on a periodic interval $[0,L]$ with periodic boundary identification $x=0$ and $x=L$. The interfaces are indexed from $j=0$ to $K-1$, such that the first interface is $x_{\\tfrac{1}{2}}$ and the last is $x_{K-\\tfrac{1}{2}}$. The interface to the right of the last cell $I_K$ is $x_{K+\\tfrac{1}{2}}$. Due to periodicity, the interface $x_{K+\\tfrac{1}{2}}$ is identified with the first interface $x_{\\tfrac{1}{2}}$. Thus, $x_{K+\\tfrac{1}{2}} \\equiv x_{\\tfrac{1}{2}}$.\nThis implies that the numerical flux value at this identified interface must be a single, unique value:\n$$\n\\widehat{f}^{\\,n+1}|_{x_{K+\\tfrac{1}{2}}} = \\widehat{f}^{\\,n+1}|_{x_{\\tfrac{1}{2}}}.\n$$\nSubstituting this into the expression for the sum of fluxes yields:\n$$\n\\sum_{j=1}^{K} \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right) = \\widehat{f}^{\\,n+1}|_{x_{\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{\\tfrac{1}{2}}} = 0.\n$$\nTherefore, the change in total mass in a single time step is:\n$$\nM^{n+1} - M^{n} = \\Delta t \\cdot 0 = 0.\n$$\nThis demonstrates that the total mass is exactly conserved at each time step of the fully discrete scheme, i.e., $M^{n+1} = M^{n}$ for all $n \\ge 0$.\nThis property is referred to as global mass conservation. It holds due to the conservative formulation of the DG method (via integration by parts), the use of a conservative numerical flux at interfaces, and the periodic boundary conditions. Note that the consistency property of the flux, $\\widehat{f}(a,a)=f(a)$, was not required for this derivation.\n\nThe cumulative mass error after $N$ steps is defined as $E_{N} = M^{N} - M^{0}$. Since mass is conserved at every step, we have:\n$$\nM^{N} = M^{N-1} = M^{N-2} = \\dots = M^{1} = M^{0}.\n$$\nThus, $M^{N} = M^{0}$. The cumulative mass error is therefore:\n$$\nE_{N} = M^{0} - M^{0} = 0.\n$$\nThis result is exact and holds for any number of steps $N$, any time step size $\\Delta t > 0$, any polynomial degree $p \\ge 0$, any number of cells $K$, any valid physical flux function $f(u)$, and any conservative numerical flux function $\\widehat{f}$.", "answer": "$$\\boxed{0}$$", "id": "3373186"}]}