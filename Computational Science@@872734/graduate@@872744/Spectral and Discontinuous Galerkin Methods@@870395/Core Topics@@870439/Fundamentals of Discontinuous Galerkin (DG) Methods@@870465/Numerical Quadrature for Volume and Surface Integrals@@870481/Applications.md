## Applications and Interdisciplinary Connections

Having established the fundamental principles and mechanisms of numerical quadrature, we now turn our attention to its role in the broader context of scientific and engineering simulation. The selection of a quadrature rule is not merely a technical step to approximate an integral; it is a critical design choice that deeply influences the accuracy, stability, conservation properties, and overall performance of a numerical method. This chapter will explore how the principles of quadrature are applied in diverse and complex scenarios, demonstrating that a carefully constructed quadrature strategy is indispensable for the success of modern spectral and discontinuous Galerkin (DG) methods. We will see how these rules are tailored for everything from the basic assembly of discrete operators to the intricate demands of nonlinear stability, complex geometries, and advanced physical models.

### Foundational Applications: Assembling Discrete Operators

The most immediate application of [numerical quadrature](@entry_id:136578) in any finite or [spectral element method](@entry_id:175531) is the assembly of the discrete [linear operators](@entry_id:149003) that constitute the algebraic system to be solved. The [mass and stiffness matrices](@entry_id:751703), which represent the inner products of basis functions and their derivatives, are composed of entries that are themselves integrals over the elements of the [computational mesh](@entry_id:168560). The accuracy of these matrices is paramount, and in many cases, it is desirable to compute them exactly.

For a one-dimensional affine element where the approximation space consists of polynomials of degree at most $p$, the entries of the element mass matrix are of the form $M_{ij} = \int_{K} \phi_i \phi_j \,dx$, where $\phi_i$ and $\phi_j$ are basis functions of degree at most $p$. The integrand, $\phi_i \phi_j$, is therefore a polynomial of degree at most $2p$. To integrate this product exactly, a [quadrature rule](@entry_id:175061) must have a [degree of exactness](@entry_id:175703) of at least $2p$. Similarly, the entries of the [element stiffness matrix](@entry_id:139369), $S_{ij} = \int_{K} \frac{d\phi_i}{dx} \frac{d\phi_j}{dx} \,dx$, involve the product of the derivatives of the basis functions. Since the derivative of a degree-$p$ polynomial has degree at most $p-1$, the integrand $\frac{d\phi_i}{dx} \frac{d\phi_j}{dx}$ is a polynomial of degree at most $2p-2$. Consequently, a [quadrature rule](@entry_id:175061) with a [degree of exactness](@entry_id:175703) of at least $2p-2$ is required for the exact assembly of the stiffness matrix. This fundamental degree analysis forms the baseline for quadrature selection in any DG or spectral method [@problem_id:3406288].

This principle extends directly to higher dimensions. For methods employing tensor-product polynomial bases on logically rectangular or [hexahedral elements](@entry_id:174602), the analysis must be performed in each coordinate direction of the [reference element](@entry_id:168425). Consider a hexahedral element using a basis of tensor-product polynomials of degree at most $p$ in each of the three reference coordinates, $\mathbb{Q}_p(\hat{K})$. To compute the mass matrix entries, one must integrate products $\hat{\phi}_i(\boldsymbol{\xi}) \hat{\phi}_j(\boldsymbol{\xi})$ over the reference cube $\hat{K}=[-1,1]^3$. The integrand, when viewed as a function of any single coordinate (e.g., $\xi_1$), is a polynomial of degree at most $2p$. A one-dimensional $N$-point Gauss-Legendre quadrature rule integrates polynomials of degree up to $2N-1$ exactly. To ensure exact integration of the $2p$-degree polynomial, we must have $2N-1 \ge 2p$, which implies $N \ge p + 1/2$. As $N$ must be an integer, the minimal number of quadrature points required in each direction is $N=p+1$. This ensures that the tensor-product rule is exact for the entire three-dimensional integrand [@problem_id:3406277].

### Quadrature for Problems with Complex Geometries

Real-world applications rarely involve meshes composed entirely of simple, affine elements. The ability to handle curved boundaries and distorted interior elements is crucial. Isoparametric mappings, which use the same polynomial basis to represent both the solution and the geometry, are a common solution. However, this introduces a non-constant Jacobian determinant into the integrands, which must be accounted for by the quadrature rule.

When an element is mapped from a reference domain $\hat{K}$ to a physical domain $K$ via a mapping $\boldsymbol{x}(\boldsymbol{\xi})$, the integral of a function $f$ transforms as $\int_K f(\boldsymbol{x}) \,d\boldsymbol{x} = \int_{\hat{K}} f(\boldsymbol{x}(\boldsymbol{\xi})) J(\boldsymbol{\xi}) \,d\boldsymbol{\xi}$, where $J(\boldsymbol{\xi})$ is the Jacobian determinant. If the mapping is, for example, a [bilinear transformation](@entry_id:266999) from the reference square to a physical quadrilateral, the Jacobian determinant $J(\boldsymbol{\xi})$ is a polynomial of degree one in each reference coordinate. This seemingly small complexity has significant consequences. To compute the mass matrix for a $\mathbb{Q}_p$ basis on such an element, the integrand becomes $\phi_i(\boldsymbol{\xi})\phi_j(\boldsymbol{\xi})J(\boldsymbol{\xi})$. The polynomial degree in each coordinate direction is now $(p+p)+1 = 2p+1$. This requires a Gauss-Legendre rule with $q$ points such that $2q-1 \ge 2p+1$, or $q \ge p+1$. Failing to use a sufficiently accurate quadrature rule—a practice known as under-integration—can have severe consequences beyond simple inaccuracy. For a conservation law, the total mass is expected to be conserved over time. If the test function is chosen as $v=1$, the discrete weak form reveals that the rate of change of total mass is related to the sum of quadrature errors in the mass matrix term. Under-integration of the Jacobian introduces a spurious source or sink term, leading to a violation of the fundamental principle of mass conservation [@problem_id:3406265].

The same principle applies to [surface integrals](@entry_id:144805) over curved faces, which are essential for imposing boundary conditions and coupling elements. If a face is parameterized by a mapping of total degree $p_m$, its surface metric factor, $J_s$, which relates the surface [area element](@entry_id:197167) in physical space to that in reference space, can be shown to be a polynomial of total degree $2p_m-2$. Consequently, to exactly integrate a polynomial of total degree $p$ on this curved face, the quadrature rule on the reference face must be exact for polynomials of total degree up to $p + (2p_m - 2)$ [@problem_id:3406272]. This demonstrates a tight coupling between the geometric representation and the quadrature machinery. In practice, this means that increasing the geometric order of the mesh necessitates a corresponding increase in the quadrature order to maintain the integrity of the discretization. The failure to do so, either by using too few quadrature points or by using a simplified geometric representation (e.g., approximating a curved element as linear), can lead to a loss of discrete conservation properties [@problem_id:3406268].

### Quadrature for Nonlinear Partial Differential Equations

The challenges of numerical quadrature are magnified in the context of nonlinear PDEs, such as those found in fluid dynamics and other areas of physics. Here, the choice of quadrature is not only a matter of accuracy but is fundamentally linked to the stability of the numerical scheme. Nonlinear flux functions can generate arbitrarily high polynomial degrees, making exact integration impractical. The focus thus shifts to designing [quadrature rules](@entry_id:753909) that preserve critical mathematical structures, ensuring that the discrete scheme mimics the stability properties of the continuous PDE.

For a [scalar conservation law](@entry_id:754531) with a physical flux $\boldsymbol{f}(u)$ that is a polynomial of degree $r$ in the solution variable $u$, the integrands in the DG weak form become compositions of polynomials. When the solution $u$ is approximated by a polynomial of degree $p$, the term $\boldsymbol{f}(u)$ becomes a spatial polynomial of degree up to $rp$. Consequently, the volume integrand, which involves products like $\boldsymbol{f}(u) \cdot \nabla v$, has a degree of at most $rp + (p-1)$. The face integrand, involving products like $\widehat{\boldsymbol{f}} \cdot v$, has a degree of at most $rp+p$. A quadrature rule must be exact for these degrees to accurately represent the [weak form](@entry_id:137295), highlighting how the degree of nonlinearity ($r$) directly impacts the required quadrature order [@problem_id:3406308].

More profoundly, quadrature is central to ensuring nonlinear stability. Consider the compressible Euler equations, where the reversible exchange between kinetic and internal energy is a key physical property. Discretely preserving this energy balance is crucial for a stable, non-dissipative scheme. This often relies on formulating the [pressure work](@entry_id:265787) terms in a "skew-symmetric" or conservative split form. For this formulation to be effective, the discrete version of the [divergence theorem](@entry_id:145271) must hold for the relevant polynomial products. This, in turn, imposes minimal exactness requirements on the [quadrature rules](@entry_id:753909): typically, degree $2N-1$ for [volume integrals](@entry_id:183482) and $2N$ for [surface integrals](@entry_id:144805) for a degree-$N$ approximation. Inexact quadrature in this context creates an aliasing defect that manifests as a spurious source or sink of kinetic energy, leading to non-physical behavior and instability [@problem_id:3406282].

This connection between quadrature and stability is a recurring theme. For general hyperbolic problems, $L^2$ stability is often guaranteed by the dissipative nature of the [numerical flux](@entry_id:145174) at element interfaces. For instance, in a flux of the Lax-Friedrichs type, the dissipation is proportional to the square of the jump in the solution, $(u^+-u^-)^2$. To ensure this term provides non-positive energy contribution and thus stabilizes the scheme, its integral must be computed without [aliasing](@entry_id:146322) errors that could change its sign. This requires the quadrature to be exact for the entire dissipative term, which can be a high-degree polynomial. For a flux of degree $q$ and a solution of degree $p$, this can require the face quadrature to be exact for polynomials of degree up to $p(q+1)$ [@problem_id:3406317].

For even stronger stability guarantees, such as [entropy stability](@entry_id:749023) for [nonlinear conservation laws](@entry_id:170694), the connection becomes even more explicit. Many modern, provably entropy-stable DG schemes are built upon the Summation-By-Parts (SBP) property. SBP methods construct discrete operators that mimic the integration-by-parts formula. Enforcing this property at the discrete level is entirely a function of the [quadrature rules](@entry_id:753909). Specifically, it requires a precise relationship between the volume quadrature nodes and weights and those on the surface, ensuring that the discrete [divergence theorem](@entry_id:145271) holds exactly for all polynomials in the approximation space. A common requirement for SBP schemes using degree-$p$ polynomials is that the volume quadrature must be exact for polynomials of degree $2p-1$ and the surface quadrature must be exact for degree $2p$. This strict algebraic structure, enforced by quadrature, is what guarantees the scheme will be nonlinearly stable [@problem_id:3406306] [@problem_id:3406284].

### Advanced and Interdisciplinary Connections

The principles of [numerical quadrature](@entry_id:136578) find application in a vast array of specialized and interdisciplinary contexts, often requiring creative adaptation of the core ideas.

#### Computational Electromagnetics: Maxwell's Equations

In the simulation of electromagnetic waves using Maxwell's equations, a primary concern is the preservation of the divergence constraints, such as $\nabla \cdot \boldsymbol{B} = 0$. In a DG setting, this involves integrals of curl-curl terms, $\int_K (\nabla \times \boldsymbol{E}) \cdot (\nabla \times \boldsymbol{F}) \, d\boldsymbol{x}$. The choice of quadrature for these volume terms must be sufficient to integrate the relevant polynomial products, which can be determined through standard degree analysis. Critically, however, the face quadrature plays an essential role in preserving the discrete divergence constraint. The [numerical flux](@entry_id:145174) across the entire boundary of an element, $\oint_{\partial K} \boldsymbol{E} \cdot \boldsymbol{n} \, dS$, should be numerically zero if the field $\boldsymbol{E}$ is discretely [divergence-free](@entry_id:190991). This requires the face quadrature to be sufficiently accurate to integrate the trace of the field $\boldsymbol{E}$ exactly. Failure to do so can introduce spurious, non-physical modes into the solution, compromising the simulation's physical fidelity [@problem_id:3406267].

#### Non-conforming and Mortar Methods

Practical large-scale simulations often employ [non-conforming meshes](@entry_id:752550), where neighboring elements may not share a complete face (i.e., have "[hanging nodes](@entry_id:750145)") or may use different [polynomial approximation](@entry_id:137391) degrees. To couple such disparate elements while maintaining conservation, [mortar methods](@entry_id:752184) are employed. A "mortar space" of polynomials is defined on the interface, and the solution traces from both sides are projected onto this common space. A single [numerical flux](@entry_id:145174) is computed on the mortar, and the result is distributed back to the adjacent elements. Conservation is guaranteed if this projection and distribution process is performed in a dually-consistent manner. This, in turn, relies on a dedicated mortar quadrature rule that is sufficiently accurate to integrate products of mortar basis functions and traces, often including a non-constant surface Jacobian from curved geometry. For a mortar space of degree $m$ on a face with a geometric mapping of degree $r$, the quadrature must typically be exact for polynomials of degree $2m+r$ [@problem_id:3406240] [@problem_id:3406316].

#### Adjoint-Based Error Estimation and Goal-Oriented Adaptivity

In goal-oriented [adaptive mesh refinement](@entry_id:143852) (AMR), the objective is to efficiently compute a specific quantity of interest, such as the lift or drag on an airfoil, to a desired accuracy. Adjoint-based methods are used to estimate the error in this quantity and to derive sensitivity indicators that guide [mesh refinement](@entry_id:168565). These methods involve computing integrals of the form $\int_\Omega w \, e \, dx$, where $e$ is the error in the solution and $w$ is a weighting function derived from the [adjoint problem](@entry_id:746299). The accuracy of these integrals is paramount, as errors here directly translate to errors in the [mesh adaptation](@entry_id:751899) strategy. Under-integration of these goal-functional integrals can introduce significant [aliasing](@entry_id:146322), leading to oscillating or unreliable error estimates. To combat this, strategies beyond simple quadrature are sometimes employed, such as projecting the integrand onto a lower-dimensional [polynomial space](@entry_id:269905) (modal filtering) before integration or applying smoothing filters to the element-wise [error indicators](@entry_id:173250) (patch averaging) to produce a more robust adaptation field [@problem_id:3406310].

#### Non-local Operators: The Fractional Laplacian

A frontier in scientific computing is the simulation of non-local phenomena, described by operators such as the fractional Laplacian. These operators are defined by hypersingular integrals of the form $\int_K \int_K \frac{u(\boldsymbol{x})-u(\boldsymbol{y})}{|\boldsymbol{x}-\boldsymbol{y}|^{d+2s}} \, d\boldsymbol{x} d\boldsymbol{y}$. The singularity at $\boldsymbol{x}=\boldsymbol{y}$ makes standard [tensor-product quadrature](@entry_id:145940) rules ineffective. Advanced quadrature strategies are required, typically involving a decomposition of the integration domain into a "[far-field](@entry_id:269288)," where the integrand is smooth and standard rules apply, and a "near-field" containing the singularity. Within the [near-field](@entry_id:269780), a specialized change of variables is used to regularize the integrand, often transforming the [hypersingular integral](@entry_id:750482) into a weakly singular one with a known weight function. For example, a Duffy-type transformation can be used, and the resulting integral can be efficiently evaluated with a custom-weighted [quadrature rule](@entry_id:175061), such as Gauss-Jacobi quadrature. This application demonstrates the remarkable flexibility of quadrature theory, which can be adapted to handle even the most challenging non-local and [singular integral](@entry_id:754920) forms arising in modern physics and mathematics [@problem_id:3406303].

In conclusion, the theory and practice of [numerical quadrature](@entry_id:136578) are woven into the very fabric of modern spectral and discontinuous Galerkin methods. Far from being a mere implementation detail, the choice of a [quadrature rule](@entry_id:175061) is a fundamental decision that dictates the accuracy, conservation, stability, and even the scope of problems that can be successfully tackled. As computational science continues to push into more complex physical models and geometric settings, the development of robust, efficient, and tailored quadrature strategies remains a vital and active area of research.