{"hands_on_practices": [{"introduction": "Understanding aliasing begins with the fundamental behavior of Fourier series on a discrete grid. This exercise provides a direct, hands-on calculation to witness the \"wrap-around\" effect, where high-frequency interactions are misinterpreted as low-frequency signals. This process is the very essence of aliasing error in pseudospectral methods and serves as the foundation for why dealiasing techniques are necessary. [@problem_id:3423339]", "problem": "Consider the standard pseudospectral discretization of a $2\\pi$-periodic function on $[0,2\\pi)$ using $N$ equispaced grid points $x_j = 2\\pi j/N$, where $N$ is an even integer. The Discrete Fourier Transform (DFT) on this grid represents Fourier modes with integer wavenumber indices in the principal set $\\{-\\frac{N}{2}+1,\\ldots,-1,0,1,\\ldots,\\frac{N}{2}\\}$, and convolution in spectral space wraps indices modulo $N$. Let $u(x)=\\sin(kx)$ and $v(x)=\\sin(\\ell x)$ with $k=\\frac{N}{2}-1$ and $\\ell=\\frac{N}{2}-2$. The pointwise product $w(x)=u(x)v(x)$ is evaluated on the physical grid and then transformed back to spectral space.\n\nStarting from first principles:\n- The trigonometric product-to-sum identity.\n- The interpretation of Fourier multiplication as convolution of modal coefficients.\n- The wrap-around of convolution modulo $N$ for the DFT, which causes aliasing into the principal index set.\n\nAnswer the following in the context of quadratic aliasing control.\n1) If the product $w(x)$ is computed on the original $N$-point grid without any padding, identify the aliased wavenumber index in the principal set corresponding to the high-frequency sum-harmonic in $w(x)$.\n2) If instead the “three-halves” dealiasing rule is used (that is, zero-pad to a grid of size $P=\\frac{3N}{2}$ in spectral space, transform to physical space, compute the product on the $P$-point grid, transform back, and then truncate to the original $N$-mode band), identify the unaliased high-frequency wavenumber index of the sum-harmonic prior to truncation (that is, the true sum-harmonic index on the integer wavenumber line).\n\nExpress your final answer as a row matrix with two entries $\\big(m_{\\text{alias}},\\,m_{\\text{true}}\\big)$, where $m_{\\text{alias}}$ is the aliased index found in part (1) and $m_{\\text{true}}$ is the true high-frequency sum-harmonic index found in part (2). No rounding is required. Do not include units.", "solution": "The problem requires us to analyze the phenomenon of aliasing in the context of a pseudospectral method. We are given two sinusoidal functions, $u(x)$ and $v(x)$, and we need to determine the wavenumber of the sum-harmonic in their product, $w(x)=u(x)v(x)$, under two different computational scenarios.\n\nThe functions are given by $u(x) = \\sin(kx)$ and $v(x) = \\sin(\\ell x)$, with integer wavenumbers $k=\\frac{N}{2}-1$ and $\\ell=\\frac{N}{2}-2$. Here, $N$ is the number of equispaced grid points on the interval $[0, 2\\pi)$ and is an even integer.\n\nFirst, we establish the analytical form of the product $w(x)$ using the trigonometric product-to-sum identity:\n$$ \\sin(A)\\sin(B) = \\frac{1}{2}\\left[\\cos(A-B) - \\cos(A+B)\\right] $$\nApplying this identity to $w(x)=u(x)v(x)$, we get:\n$$ w(x) = \\sin(kx)\\sin(\\ell x) = \\frac{1}{2}\\left[\\cos((k-\\ell)x) - \\cos((k+\\ell)x)\\right] $$\nThis shows that the product $w(x)$ is a superposition of two cosine waves. The wavenumbers of these components are the difference-harmonic, $m_{\\text{diff}} = k-\\ell$, and the sum-harmonic, $m_{\\text{sum}} = k+\\ell$.\n\nSubstituting the given values for $k$ and $\\ell$:\n$$ m_{\\text{diff}} = k-\\ell = \\left(\\frac{N}{2}-1\\right) - \\left(\\frac{N}{2}-2\\right) = 1 $$\n$$ m_{\\text{sum}} = k+\\ell = \\left(\\frac{N}{2}-1\\right) + \\left(\\frac{N}{2}-2\\right) = N-3 $$\nSo, the exact analytical product is $w(x) = \\frac{1}{2}\\left[\\cos(x) - \\cos((N-3)x)\\right]$. The high-frequency sum-harmonic corresponds to the term $\\cos((N-3)x)$, which is composed of complex exponentials with wavenumbers $\\pm(N-3)$.\n\n**Part 1: Aliased Wavenumber on an $N$-point Grid**\n\nA pseudospectral method on an $N$-point grid can only represent a finite set of wavenumbers without ambiguity. The problem specifies this set, the principal set, as $\\{-\\frac{N}{2}+1, \\ldots, \\frac{N}{2}\\}$. Any wavenumber $m$ outside this set is aliased to a wavenumber $m_{\\text{alias}}$ inside the set, where $m_{\\text{alias}}$ is congruent to $m$ modulo $N$. That is, $m_{\\text{alias}} = m + qN$ for some integer $q$ such that $m_{\\text{alias}}$ is in the principal set.\n\nThe high-frequency sum-harmonic has a true wavenumber of $m = N-3$. We need to find its alias in the principal set. We are looking for an integer $q$ such that $-\\frac{N}{2}+1 \\le (N-3) + qN \\le \\frac{N}{2}$.\nChoosing $q=-1$, we get:\n$$ m_{\\text{alias}} = (N-3) - N = -3 $$\nWe must verify that this aliased wavenumber lies within the principal set $\\{-\\frac{N}{2}+1, \\ldots, \\frac{N}{2}\\}$. The condition is $-\\frac{N}{2}+1 \\le -3$. This simplifies to $4 \\le \\frac{N}{2}$, or $N \\ge 8$. The problem is posed for a general even $N$, and the wavenumbers $k$ and $\\ell$ are chosen to be close to the Nyquist frequency $\\frac{N}{2}$, which is characteristic of scenarios where aliasing is a major concern. For small $N$ (e.g., $N=4$ or $N=6$), the sum-harmonic $N-3$ might fall within the principal set, meaning no aliasing occurs for that specific component. However, the general case, implied by the context of aliasing control rules, is for $N$ sufficiently large that the sum-harmonic falls outside the representable range. Thus, assuming $N \\ge 8$, the aliased wavenumber from the sum-harmonic $k+\\ell=N-3$ is $m_{\\text{alias}} = -3$.\n\n**Part 2: Unaliased Wavenumber using the Three-Halves Rule**\n\nThe second part of the problem asks for the unaliased, true wavenumber of the sum-harmonic. The context provided is the \"three-halves\" dealiasing rule, a procedure designed to compute nonlinear products without aliasing. The procedure involves padding the spectral representation of the functions with zeros to increase the resolution, performing the product on a finer physical grid ($P=\\frac{3N}{2}$ points), and then transforming back.\n\nThe question is: \"identify the unaliased high-frequency wavenumber index of the sum-harmonic prior to truncation (that is, the true sum-harmonic index on the integer wavenumber line)\". The parenthetical part of this question explicitly defines the desired quantity: it is the true wavenumber of the sum-harmonic component as it exists in the analytical product, before any discrete grid effects (like aliasing) are considered. This dealiasing procedure is the tool one would use to attempt to compute this true value numerically. The question asks for the theoretical target of this computation.\n\nAs determined from the product-to-sum identity, the true sum-harmonic is $m_{\\text{sum}} = k+\\ell$.\n$$ m_{\\text{true}} = k+\\ell = \\left(\\frac{N}{2}-1\\right) + \\left(\\frac{N}{2}-2\\right) = N-3 $$\nThis is the wavenumber of the high-frequency component in the exact solution. The purpose of the dealiasing rule is to accurately capture this component. While for the specific high wavenumbers given, the $P=\\frac{3N}{2}$ grid may not be sufficient to prevent aliasing if $N  12$ (since the true wavenumber $N-3$ would exceed the padded grid's Nyquist limit of $P/2 = 3N/4$), the question is asking for the value that this procedure *intends* to find, which is the true analytical wavenumber.\n\nTherefore, the true high-frequency sum-harmonic index is $m_{\\text{true}} = N-3$.\n\n**Summary of Results**\nThe aliased wavenumber index on the $N$-point grid is $m_{\\text{alias}} = -3$.\nThe true high-frequency sum-harmonic index is $m_{\\text{true}} = N-3$.\n\nThe final answer is requested as a row matrix $\\begin{pmatrix} m_{\\text{alias}}  m_{\\text{true}} \\end{pmatrix}$.", "answer": "$$ \\boxed{ \\begin{pmatrix} -3  N-3 \\end{pmatrix} } $$", "id": "3423339"}, {"introduction": "The three-halves rule is a powerful tool, but it is a specific instance of a more general principle for controlling aliasing. This practice challenges you to derive the general dealiasing requirement for arbitrary-order nonlinearities, revealing the origin of the factors $\\frac{3}{2}$, $2$, and so on. By also constructing a counterexample, you will demonstrate the critical importance of matching the dealiasing strategy to the specific nonlinearity of the problem at hand, reinforcing that there is no one-size-fits-all solution. [@problem_id:3423358]", "problem": "Consider a one-dimensional Discontinuous Galerkin (DG) method on the reference element $[-1,1]$ with polynomial approximation degree $p \\geq 1$. The weak form volume contribution for a nonlinear flux $f(u)$ involves integrals of the form $\\int_{-1}^{1} f(u(x)) \\,\\phi(x) \\,\\mathrm{d}x$, where $u \\in \\mathbb{P}_{p}$ and $\\phi \\in \\mathbb{P}_{p}$ are polynomials of degree at most $p$. Suppose numerical quadrature is used to approximate these integrals via Gauss–Legendre rules with $n$ points, which exactly integrate polynomials up to degree $2n-1$. Over-integration by the so-called “three-halves rule” sets $n = \\lceil \\tfrac{3}{2}(p+1) \\rceil$.\n\nYour tasks are:\n\n1) Construct an explicit counterexample demonstrating that for the cubic nonlinearity $f(u)=u^{3}$, the “three-halves rule” quadrature fails to control aliasing in the DG volume integral. Specifically, pick a concrete $p$ and specific $u$ and $\\phi$ in $\\mathbb{P}_{p}$ such that the Gauss–Legendre quadrature with $n = \\lceil \\tfrac{3}{2}(p+1) \\rceil$ does not exactly integrate $\\int_{-1}^{1} u(x)^{3}\\,\\phi(x)\\,\\mathrm{d}x$. You must justify the failure solely from first principles about polynomial degrees and quadrature exactness.\n\n2) In a separate, periodic pseudo-spectral setting on a one-dimensional grid, let the discrete Fourier transform (DFT) be used to represent functions with maximum resolved wavenumber $K$ (so that the truncated spectrum has support in $\\{-K,-K+1,\\dots,K-1,K\\}$). Pointwise multiplication in physical space corresponds to circular convolution of Fourier coefficients modulo the grid length. For an $m$-linear product $u_{1}\\cdots u_{m}$ of $m$ bandlimited fields each supported in $\\{-K,\\dots,K\\}$, derive from first principles the minimal padding factor $\\alpha_{m}$ (as a closed-form analytic expression in $m$) such that zero-padding the spectra to a grid of length $P = \\alpha_{m} N$ (with $N$ the original grid length and $K$ related to $N$ in the usual way) and then truncating back to the original band eliminates all wrap-around contributions to Fourier modes with $|k| \\leq K$. Your derivation must be based on fundamental properties of linear versus circular convolution supports and must produce a single, closed-form analytic expression for $\\alpha_{m}$.\n\nThe final answer should be the expression for the padding factor $\\alpha_{m}$ in terms of $m$. No numerical rounding is needed, and no units are involved. Express the final answer as a single closed-form analytic expression.", "solution": "This problem consists of two independent parts. The first part requires constructing a counterexample for the \"three-halves rule\" in a Discontinuous Galerkin (DG) context. The second part requires deriving a general padding factor for de-aliasing in pseudo-spectral methods.\n\n### Part 1: Counterexample for the Three-Halves Rule\n\nThe problem asks for a counterexample to the sufficiency of the \"three-halves rule\" for numerical quadrature in a DG framework for a specific nonlinear problem.\n\nThe setting is a one-dimensional DG method on the reference element $[-1, 1]$. The approximation space for the solution $u$ and the test function $\\phi$ is the space of polynomials of degree at most $p$, denoted $\\mathbb{P}_{p}$. We are considering the volume integral contribution from a nonlinear flux $f(u) = u^3$. The integral to be computed is\n$$\nI = \\int_{-1}^{1} f(u(x)) \\phi(x) \\, \\mathrm{d}x = \\int_{-1}^{1} (u(x))^3 \\phi(x) \\, \\mathrm{d}x\n$$\nwhere $u, \\phi \\in \\mathbb{P}_{p}$.\n\nThis integral is approximated using an $n$-point Gauss-Legendre quadrature rule. Such a rule is known to be exact for any polynomial integrand of degree at most $2n-1$.\n\nThe \"three-halves rule\" specifies the number of quadrature points $n$ as a function of the polynomial degree $p$:\n$$\nn = \\left\\lceil \\frac{3}{2}(p+1) \\right\\rceil\n$$\nThe degree of exactness of the corresponding quadrature is therefore $D_{exact} = 2n-1 = 2 \\left\\lceil \\frac{3}{2}(p+1) \\right\\rceil - 1$.\n\nTo find a counterexample, we must find a polynomial degree $p \\geq 1$ and specific polynomials $u, \\phi \\in \\mathbb{P}_{p}$ such that the degree of the integrand, $\\deg((u(x))^3 \\phi(x))$, is greater than $D_{exact}$.\n\nThe degree of the integrand can be determined as follows:\nSince $u(x) \\in \\mathbb{P}_{p}$, its degree is at most $p$. Consequently, the degree of $(u(x))^3$ is at most $3p$.\nSince $\\phi(x) \\in \\mathbb{P}_{p}$, its degree is at most $p$.\nThe degree of the product $(u(x))^3 \\phi(x)$ is the sum of the degrees of the factors, so its maximum possible degree is $3p + p = 4p$.\n\nFor the quadrature rule to be exact for all possible choices of $u, \\phi \\in \\mathbb{P}_p$, we would need the degree of exactness to be at least the maximum possible degree of the integrand. That is, we would need $D_{exact} \\ge 4p$.\nThe rule fails if we can find a $p$ such that $4p  D_{exact}$. Let's test for small values of $p \\geq 1$.\n\n- For $p=1$:\n  - Maximum integrand degree is $4p = 4$.\n  - Number of quadrature points: $n = \\lceil \\frac{3}{2}(1+1) \\rceil = \\lceil 3 \\rceil = 3$.\n  - Degree of exactness: $D_{exact} = 2(3)-1 = 5$.\n  - Since $4 \\le 5$, the rule is sufficient. No counterexample exists for $p=1$.\n\n- For $p=2$:\n  - Maximum integrand degree is $4p = 8$.\n  - Number of quadrature points: $n = \\lceil \\frac{3}{2}(2+1) \\rceil = \\lceil 4.5 \\rceil = 5$.\n  - Degree of exactness: $D_{exact} = 2(5)-1 = 9$.\n  - Since $8 \\le 9$, the rule is sufficient. No counterexample exists for $p=2$.\n\n- For $p=3$:\n  - Maximum integrand degree is $4p = 12$.\n  - Number of quadrature points: $n = \\lceil \\frac{3}{2}(3+1) \\rceil = \\lceil 6 \\rceil = 6$.\n  - Degree of exactness: $D_{exact} = 2(6)-1 = 11$.\n  - Here we have $12  11$. This means that there may exist an integrand of degree $12$ that is not integrated exactly by the $6$-point Gauss-Legendre quadrature. This provides the basis for our counterexample.\n\nWe now construct the explicit counterexample for $p=3$.\nLet the polynomial degree be $p=3$. The approximation space is $\\mathbb{P}_{3}$.\nChoose $u(x)$ and $\\phi(x)$ to maximize the degree of the integrand. Let $u(x) = x^3$ and $\\phi(x) = x^3$. Both polynomials are in $\\mathbb{P}_{3}$.\nThe integrand is:\n$$\n(u(x))^3 \\phi(x) = (x^3)^3 (x^3) = x^9 \\cdot x^3 = x^{12}\n$$\nThe degree of this integrand is $12$.\nFor $p=3$, the three-halves rule prescribes $n = 6$ quadrature points. A $6$-point Gauss-Legendre quadrature rule is exact for polynomials of degree up to $2n-1 = 11$.\nSince the degree of our integrand ($12$) is greater than the degree of exactness of the quadrature rule ($11$), the numerical integration will not yield the exact value of the integral in general. The error formula for Gauss-Legendre quadrature confirms that for a function whose $(2n)$-th derivative is non-zero, the error is non-zero. For the integrand $g(x) = x^{12}$ and $n=6$, the $2n=12$-th derivative is $g^{(12)}(x) = 12!$, which is a non-zero constant. Thus, the quadrature approximation is not exact.\n\nThis explicitly demonstrates that for $p=3$, the \"three-halves rule\" fails to control aliasing for the cubic nonlinearity $f(u)=u^3$, as it leads to a quadrature rule that cannot exactly integrate all possible integrands arising from the weak form.\n\n### Part 2: Derivation of the Padding Factor\n\nThe problem asks for the minimal padding factor $\\alpha_m$ required to eliminate aliasing errors when computing an $m$-linear product in a pseudo-spectral method.\n\nThe setting is a one-dimensional periodic domain. We consider $m$ functions, $u_1, \\dots, u_m$, which are bandlimited. Their Fourier spectra $\\hat{u}_j(k)$ are non-zero only for wavenumbers $k$ within the interval $[-K, K]$, for some maximum resolved wavenumber $K$. We want to compute the product $v(x) = u_1(x) \\cdots u_m(x)$.\n\nFrom the convolution theorem, the Fourier transform of the product of functions is the convolution of their individual Fourier transforms. For the exact product $v$, its spectrum $\\hat{v}(k)$ is given by:\n$$\n\\hat{v} = \\hat{u}_1 * \\hat{u}_2 * \\dots * \\hat{u}_m\n$$\nwhere $*$ denotes continuous convolution. The support of a convolution is the Minkowski sum of the supports of the functions being convolved. Since each $\\hat{u}_j$ is supported on $[-K, K]$, the support of $\\hat{v}$ is:\n$$\n\\text{supp}(\\hat{v}) = [-K, K] + [-K, K] + \\dots + [-K, K] \\quad (m \\text{ times}) = [-mK, mK]\n$$\nThus, the exact product $v(x)$ is a bandlimited function with maximum wavenumber $mK$.\n\nIn a pseudo-spectral method, the product is computed by pointwise multiplication on a discrete grid in physical space. If this grid has $P$ points, this operation corresponds to a circular convolution of the discrete Fourier spectra. The resulting discrete Fourier coefficients of the product, denoted $\\hat{v}_k^{\\text{DFT}}$, are related to the true continuous Fourier series coefficients $\\hat{v}_k$ by the aliasing formula:\n$$\n\\hat{v}_k^{\\text{DFT}} = \\sum_{j=-\\infty}^{\\infty} \\hat{v}_{k+jP}\n$$\nThe goal is to choose the padded grid size $P$ such that the computed coefficients are exact for the target wavenumbers, i.e., $\\hat{v}_k^{\\text{DFT}} = \\hat{v}_k$ for all $k \\in [-K, K]$. This requires that all other terms in the aliasing sum vanish for the target range of $k$:\n$$\n\\sum_{j \\neq 0} \\hat{v}_{k+jP} = 0 \\quad \\text{for all } k \\in [-K, K]\n$$\nSince $\\hat{v}$ is supported on $[-mK, mK]$, this condition is met if the aliased wavenumbers $k+jP$ (for $j \\neq 0$) fall outside this support interval for any $k \\in [-K, K]$.\n\nLet's analyze the condition for $j=1$ and $j=-1$, as these provide the tightest constraints.\nFor $j=1$: We need $k+P$ to be outside $[-mK, mK]$ for all $k \\in [-K, K]$. The smallest value of $k+P$ is $-K+P$. To ensure this falls outside the support on the positive side, we need:\n$$\n-K+P  mK \\implies P  (m+1)K\n$$\nFor $j=-1$: We need $k-P$ to be outside $[-mK, mK]$ for all $k \\in [-K, K]$. The largest value of $k-P$ is $K-P$. To ensure this falls outside the support on the negative side, we need:\n$$\nK-P  -mK \\implies P  (m+1)K\n$$\nFor $|j| \\geq 2$, the constraints on $P$ are weaker (e.g., for $j=2$, we need $P  \\frac{1}{2}(m+1)K$). Therefore, the necessary and sufficient condition on the padded grid size $P$ to prevent aliasing into the modes $|k| \\le K$ is $P  (m+1)K$.\n\nThe problem defines a padding factor $\\alpha_m$ such that $P = \\alpha_m N$, where $N$ is the original grid length. The problem also states that $K$ is related to $N$ \"in the usual way\". In spectral methods, an $N$-point grid is used to represent a function that is bandlimited up to a maximum wavenumber $K$. For a real-valued function on a grid with an even number of points $N$, the highest resolvable wavenumber is the Nyquist wavenumber, $K=N/2$. This relation provides a direct link between $K$ and $N$.\n\nSubstituting $P = \\alpha_m N$ and the relation $K = N/2$ into the derived condition $P  (m+1)K$:\n$$\n\\alpha_m N  (m+1) \\left(\\frac{N}{2}\\right)\n$$\nDividing by $N$ (which is positive) yields:\n$$\n\\alpha_m  \\frac{m+1}{2}\n$$\nThe problem asks for the minimal padding factor $\\alpha_m$ that satisfies this condition. This corresponds to the lower bound of the inequality.\n$$\n\\alpha_m = \\frac{m+1}{2}\n$$\nThis result is a closed-form analytic expression in $m$. For the quadratic case ($m=2$), $\\alpha_2 = \\frac{3}{2}$, which is the well-known \"3/2-rule\". For the cubic case ($m=3$), $\\alpha_3 = \\frac{4}{2} = 2$, which is the \"2x-rule\".", "answer": "$$\n\\boxed{\\frac{m+1}{2}}\n$$", "id": "3423358"}, {"introduction": "This practice bridges the gap between the abstract theory of aliasing and the practical stability of numerical simulations. In this coding exercise, you will witness a critical failure mode in a Discontinuous Galerkin (DG) simulation of the Burgers' equation: the violation of a fundamental conservation law due to aliasing errors from a quadratic nonlinearity. By implementing and comparing an underintegrated scheme with one that correctly applies the three-halves rule, you will directly observe the power of dealiasing in preserving the physical fidelity and robustness of the numerical solution. [@problem_id:3423344]", "problem": "Construct a minimal, purely mathematical test that demonstrates how aliasing errors can corrupt a conserved invariant in a Discontinuous Galerkin (DG) method and how the three-halves overintegration rule restores exact discrete conservation under periodic boundary conditions. Consider the one-dimensional inviscid Burgers equation on a periodic domain mapped to the reference interval $[-1,1]$:\n$$\n\\partial_t u + \\partial_x \\left(\\tfrac{1}{2} u^2 \\right) = 0.\n$$\nUse a modal Discontinuous Galerkin (DG) method with a Legendre polynomial basis $\\{P_k(x)\\}_{k=0}^N$ on a single reference element. Assume periodic boundary conditions so that surface contributions vanish identically in the semi-discrete formulation. Work in the weak form so that the semi-discrete equations for the coefficients $\\{\\hat{u}_k(t)\\}_{k=0}^N$ read\n$$\n\\sum_{j=0}^N M_{ij} \\frac{d \\hat{u}_j}{dt} = - \\int_{-1}^1 \\frac{d P_i}{dx}(x)\\, \\tfrac{1}{2} u_h(x)^2 \\, dx, \\quad i=0,\\dots,N,\n$$\nwhere $u_h(x) = \\sum_{k=0}^N \\hat{u}_k P_k(x)$, and $M_{ij} = \\int_{-1}^1 P_i(x) P_j(x) \\, dx$ is the mass matrix. Due to orthogonality of Legendre polynomials, $M_{ij} = 0$ for $i \\neq j$ and $M_{ii} = \\tfrac{2}{2i+1}$.\n\nThe continuous equation conserves the quadratic invariant (energy)\n$$\nE(t) = \\tfrac{1}{2} \\int_{-1}^1 u(x,t)^2 \\, dx\n$$\nfor smooth solutions on a periodic domain. In the DG semi-discretization with exact volume integrals, the discrete energy\n$$\nE_h(t) = \\tfrac{1}{2} \\sum_{i=0}^N \\sum_{j=0}^N \\hat{u}_i(t) \\, M_{ij} \\, \\hat{u}_j(t) = \\tfrac{1}{2} \\sum_{i=0}^N \\tfrac{2}{2i+1} \\, \\hat{u}_i(t)^2\n$$\nis also conserved for smooth solutions. However, if the nonlinear volume integral is evaluated by underintegrated quadrature, aliasing can violate the exact discrete conservation, yielding a nonzero discrete energy derivative at $t=0$. The three-halves overintegration rule prescribes using a Gauss-Legendre quadrature with enough nodes so that polynomial integrals up to degree $3N-1$ are integrated exactly for quadratic nonlinearities, i.e., choose the number of quadrature points $Q$ satisfying $2Q-1 \\ge 3N-1$, which is $Q \\ge \\lceil \\tfrac{3N}{2} \\rceil$.\n\nStarting from the core definitions of the modal DG weak formulation, Gauss-Legendre quadrature, and Legendre polynomial orthogonality, implement the following minimal test.\n\n1. Fix a polynomial degree $N \\in \\mathbb{N}$ and an initial condition in the polynomial subspace\n$$\nu_h(x,0) = \\sum_{k=0}^N \\hat{u}_k(0)\\, P_k(x), \\quad \\hat{u}_k(0) = \\frac{(-1)^k}{k+1}.\n$$\n2. Assemble the right-hand side using Gauss-Legendre quadrature with $Q$ points:\n$$\nK_i(Q) \\approx \\sum_{q=1}^Q w_q \\, \\frac{dP_i}{dx}(x_q)\\, \\tfrac{1}{2} \\left(u_h(x_q,0)\\right)^2,\n$$\nwhere $\\{x_q,w_q\\}_{q=1}^Q$ are Gauss-Legendre nodes and weights. Define the semi-discrete coefficient time derivative by\n$$\n\\frac{d \\hat{u}_i}{dt}(0;Q) = - M_{ii}^{-1} \\, K_i(Q), \\quad i=0,\\dots,N.\n$$\n3. Compute the discrete energy time derivative at $t=0$:\n$$\n\\frac{d E_h}{dt}(0;Q) = \\sum_{i=0}^N \\frac{2}{2i+1} \\, \\hat{u}_i(0) \\, \\frac{d \\hat{u}_i}{dt}(0;Q) = - \\sum_{i=0}^N \\hat{u}_i(0) \\, K_i(Q).\n$$\n4. For each prescribed $N$, evaluate $\\tfrac{d E_h}{dt}(0;Q)$ with two quadrature choices:\n   - Underintegrated: $Q_{\\text{under}} = N+1$.\n   - Three-halves overintegrated: $Q_{3/2} = \\lceil \\tfrac{3N}{2} \\rceil$.\n   Using exact arithmetic, the latter should yield $\\tfrac{d E_h}{dt}(0;Q_{3/2}) = 0$ for smooth data; finite-precision computation should give a value of magnitude near machine precision.\n\n5. Use the following test suite of polynomial degrees:\n   - Case A (general case): $N=3$.\n   - Case B (even degree): $N=4$.\n   - Case C (higher degree stress): $N=7$.\n\nFor each case, produce two boolean results:\n- $b_1$: whether $|\\tfrac{d E_h}{dt}(0;Q_{\\text{under}})|  10^{-10}$ (aliased energy non-conservation detected).\n- $b_2$: whether $|\\tfrac{d E_h}{dt}(0;Q_{3/2})|  10^{-12}$ (energy conservation restored by three-halves overintegration).\n\nYour program should produce a single line of output containing the six boolean results for the three cases, in order $[b_1^{(A)}, b_2^{(A)}, b_1^{(B)}, b_2^{(B)}, b_1^{(C)}, b_2^{(C)}]$, as a comma-separated list enclosed in square brackets, for example, $[{\\rm True},{\\rm True},{\\rm True},{\\rm True},{\\rm True},{\\rm True}]$.\n\nNo physical units are involved in this problem. All computations are purely dimensionless and must use radians implicitly for any angular interpretations within orthogonal polynomial evaluations (although angles are not directly used here).", "solution": "The problem requires the construction of a numerical test to demonstrate aliasing-induced violation of a conserved quantity in a Discontinuous Galerkin (DG) method and its restoration via the three-halves overintegration rule. The model is the one-dimensional inviscid Burgers equation, $\\partial_t u + \\partial_x \\left(\\tfrac{1}{2} u^2 \\right) = 0$, on a single periodic reference element $[-1,1]$.\n\nA modal DG method is employed with a basis of Legendre polynomials, $\\{P_k(x)\\}_{k=0}^N$. The approximate solution is $u_h(x,t) = \\sum_{k=0}^N \\hat{u}_k(t) P_k(x)$. The semi-discrete weak form for the evolution of the modal coefficients $\\hat{u}_i(t)$ is given by:\n$$\nM_{ij} \\frac{d \\hat{u}_j}{dt} = - \\int_{-1}^1 \\frac{d P_i}{dx}(x)\\, \\tfrac{1}{2} u_h(x)^2 \\, dx\n$$\nwhere summation over repeated indices is implied. The mass matrix is $M_{ij} = \\int_{-1}^1 P_i(x) P_j(x) \\, dx$. Due to the orthogonality of Legendre polynomials, $M_{ij} = \\delta_{ij} \\frac{2}{2i+1}$.\n\nThe continuous equation conserves the energy $E(t) = \\tfrac{1}{2} \\int_{-1}^1 u(x,t)^2 \\, dx$. The corresponding discrete energy is:\n$$\nE_h(t) = \\tfrac{1}{2} \\int_{-1}^1 u_h(x,t)^2 \\, dx = \\tfrac{1}{2} \\int_{-1}^1 \\left(\\sum_i \\hat{u}_i P_i\\right) \\left(\\sum_j \\hat{u}_j P_j\\right) dx = \\tfrac{1}{2} \\sum_{i,j} \\hat{u}_i \\hat{u}_j M_{ij} = \\tfrac{1}{2} \\sum_{i=0}^N \\frac{2}{2i+1} \\hat{u}_i(t)^2\n$$\nThe time derivative of the discrete energy is:\n$$\n\\frac{d E_h}{dt} = \\sum_{i=0}^N \\frac{2}{2i+1} \\hat{u}_i \\frac{d \\hat{u}_i}{dt} = \\sum_{i=0}^N \\hat{u}_i \\left( M_{ii} \\frac{d \\hat{u}_i}{dt} \\right)\n$$\nSubstituting the semi-discrete equation:\n$$\n\\frac{d E_h}{dt} = \\sum_{i=0}^N \\hat{u}_i \\left( - \\int_{-1}^1 \\frac{dP_i}{dx} \\frac{1}{2} u_h^2 \\, dx \\right) = - \\int_{-1}^1 \\left( \\sum_{i=0}^N \\hat{u}_i \\frac{dP_i}{dx} \\right) \\frac{1}{2} u_h^2 \\, dx\n$$\nRecognizing that $\\sum_{i=0}^N \\hat{u}_i \\frac{dP_i}{dx} = \\frac{d}{dx} \\left( \\sum_{i=0}^N \\hat{u}_i P_i \\right) = \\frac{du_h}{dx}$, we have:\n$$\n\\frac{d E_h}{dt} = - \\frac{1}{2} \\int_{-1}^1 u_h^2 \\frac{du_h}{dx} \\, dx = - \\frac{1}{2} \\int_{-1}^1 \\frac{d}{dx} \\left(\\frac{1}{3} u_h^3 \\right) dx = - \\frac{1}{6} \\left[ u_h^3(x) \\right]_{-1}^1\n$$\nFor periodic boundary conditions, $u_h(1) = u_h(-1)$, and thus $\\frac{dE_h}{dt} = 0$. This confirms that if the volume integrals are computed exactly, the discrete energy is conserved.\n\nNumerical methods typically approximate integrals using quadrature. The right-hand side integral, which we denote as $R_i = \\int_{-1}^1 \\frac{dP_i}{dx} \\frac{1}{2} u_h^2 \\, dx$, is approximated using Gauss-Legendre quadrature with $Q$ points $\\{x_q, w_q\\}$:\n$$\nK_i(Q) = \\sum_{q=1}^Q w_q \\, \\frac{dP_i}{dx}(x_q)\\, \\tfrac{1}{2} \\left(u_h(x_q)\\right)^2\n$$\nThe integrand is a polynomial. Since $u_h(x)$ is a polynomial of degree $N$, $u_h(x)^2$ is of degree $2N$. The derivative of the Legendre polynomial, $\\frac{dP_i}{dx}$, is a polynomial of degree $i-1$. Thus, the integrand $\\frac{dP_i}{dx} u_h^2$ is a polynomial of degree up to $2N + (i-1)$, with a maximum degree of $3N-1$ for $i=N$.\n\nA Gauss-Legendre quadrature rule with $Q$ points integrates polynomials of degree up to $2Q-1$ exactly. To ensure exact integration for all $i=0,\\dots,N$, we require $2Q-1 \\ge 3N-1$, which simplifies to $Q \\ge \\frac{3N}{2}$. Since $Q$ must be an integer, the condition is $Q \\ge \\lceil \\frac{3N}{2} \\rceil$. This is the \"three-halves rule\" for quadratic nonlinearities.\n\nWhen this rule is not satisfied, for example, by using only $Q=N+1$ points (which is sufficient for linear problems), the quadrature is inexact. This inexactness is called aliasing error. It introduces spurious energy production or dissipation, leading to a non-zero computed value for $\\frac{dE_h}{dt}$.\n\nThe implementation calculates the discrete energy derivative at $t=0$, $\\frac{d E_h}{dt}(0;Q) = - \\sum_{i=0}^N \\hat{u}_i(0) K_i(Q)$, for the given initial condition $\\hat{u}_k(0) = \\frac{(-1)^k}{k+1}$. The algorithm is as follows:\n1.  For a given polynomial degree $N$ and number of quadrature points $Q$, obtain the Gauss-Legendre nodes $x_q$ and weights $w_q$ on $[-1,1]$.\n2.  Define the initial modal coefficient vector $\\hat{\\mathbf{u}}(0)$ of size $N+1$.\n3.  For each node $x_q$, evaluate the basis polynomials $P_k(x_q)$ and their derivatives $\\frac{dP_k}{dx}(x_q)$ for all $k=0,\\dots,N$. Store these in matrices, say $\\mathbf{P}$ of size $(N+1) \\times Q$ and $\\mathbf{P'}$ of size $(N+1) \\times Q$.\n4.  Compute the solution values at the quadrature nodes: $u_h(x_q,0) = \\sum_{k=0}^N \\hat{u}_k(0) P_k(x_q)$. In vector form, this is $\\mathbf{u}_h = \\mathbf{P}^T \\hat{\\mathbf{u}}(0)$.\n5.  Compute the nonlinear flux term at each node: $F_q = \\frac{1}{2} u_h(x_q,0)^2$.\n6.  Assemble the quadrature-approximated integral vector $\\mathbf{K}(Q)$: $K_i(Q) = \\sum_{q=1}^Q w_q P'_{iq} F_q$.\n7.  Finally, compute the energy derivative as the dot product: $\\frac{dE_h}{dt}(0;Q) = - \\hat{\\mathbf{u}}(0)^T \\mathbf{K}(Q)$.\n\nThis procedure is executed for each test case ($N=3, 4, 7$) with two different quadrature rules:\n-   Underintegrated: $Q_{\\text{under}} = N+1$. The test expects to find a significant non-zero energy derivative, $|\\frac{dE_h}{dt}|  10^{-10}$.\n-   Overintegrated: $Q_{3/2} = \\lceil \\frac{3N}{2} \\rceil$. The test expects the energy derivative to be zero up to machine precision, $|\\frac{dE_h}{dt}|  10^{-12}$, demonstrating the restoration of the conservation property.\nThe boolean results from these checks confirm the theoretical predictions about aliasing and its control.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_energy_derivative(N, Q):\n    \"\"\"\n    Calculates the discrete energy time derivative for the DG-discretized\n    Burgers equation using Q-point Gauss-Legendre quadrature.\n\n    Args:\n        N (int): The polynomial degree of the DG basis.\n        Q (int): The number of quadrature points.\n\n    Returns:\n        float: The value of dE_h/dt at t=0.\n    \"\"\"\n    # 1. Get Gauss-Legendre quadrature points and weights for the interval [-1, 1]\n    x_q, w_q = np.polynomial.legendre.leggauss(Q)\n\n    # 2. Get initial modal coefficients u_k(0)\n    u_hat_0 = np.array([((-1.0)**k) / (k + 1.0) for k in range(N + 1)])\n\n    # 3. Evaluate basis polynomials P_k(x_q) and their derivatives dP_k/dx(x_q)\n    # P_mat will store P_k(x_q) in entry (k, q)\n    # P_prime_mat will store dP_k/dx(x_q) in entry (k, q)\n    P_mat = np.zeros((N + 1, Q))\n    P_prime_mat = np.zeros((N + 1, Q))\n\n    for k in range(N + 1):\n        # Create Legendre basis polynomial P_k\n        leg_poly_k = np.polynomial.legendre.Legendre.basis(k)\n        # Evaluate P_k at all quadrature points\n        P_mat[k, :] = leg_poly_k(x_q)\n        \n        # Get the derivative polynomial dP_k/dx\n        leg_poly_k_deriv = leg_poly_k.deriv()\n        # Evaluate dP_k/dx at all quadrature points\n        P_prime_mat[k, :] = leg_poly_k_deriv(x_q)\n\n    # 4. Evaluate u_h(x_q, 0) at each quadrature node\n    # u_h(x_q, 0) = sum_k u_hat_k(0) * P_k(x_q)\n    u_h_at_q = P_mat.T @ u_hat_0\n    \n    # 5. Compute the nonlinear function F(q) = 0.5 * u_h(x_q, 0)^2\n    F_q = 0.5 * u_h_at_q**2\n\n    # 6. Compute K_i(Q) vector using quadrature\n    # K_i = sum_q w_q * dP_i/dx(x_q) * F(q)\n    K = P_prime_mat @ (w_q * F_q)\n\n    # 7. Compute the discrete energy time derivative\n    # dE_h/dt = - sum_i u_hat_i(0) * K_i\n    dE_h_dt = -np.dot(u_hat_0, K)\n\n    return dE_h_dt\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        3,  # Case A: N=3\n        4,  # Case B: N=4\n        7,  # Case C: N=7\n    ]\n\n    results = []\n    for N in test_cases:\n        # Underintegrated case\n        Q_under = N + 1\n        dE_dt_under = calculate_energy_derivative(N, Q_under)\n        b1 = abs(dE_dt_under) > 1e-10\n        results.append(b1)\n        \n        # Three-halves overintegrated case\n        Q_3_2 = int(np.ceil(3.0 * N / 2.0))\n        dE_dt_3_2 = calculate_energy_derivative(N, Q_3_2)\n        b2 = abs(dE_dt_3_2)  1e-12\n        results.append(b2)\n\n    # Final print statement in the exact required format.\n    # The output format for boolean values is 'True' or 'False'.\n    boolean_strings = [str(b) for b in results]\n    print(f\"[{','.join(boolean_strings)}]\")\n\nsolve()\n```", "id": "3423344"}]}