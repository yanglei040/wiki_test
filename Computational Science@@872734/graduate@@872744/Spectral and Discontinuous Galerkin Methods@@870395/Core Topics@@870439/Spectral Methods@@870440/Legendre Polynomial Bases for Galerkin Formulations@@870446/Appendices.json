{"hands_on_practices": [{"introduction": "A key advantage of using orthogonal basis functions, such as Legendre polynomials, in Galerkin methods is the computational efficiency they afford during adaptive refinement. This practice explores how the $L^2$-orthogonality simplifies the process of increasing the polynomial degree of an approximation. By working through this exercise [@problem_id:3395701], you will derive a fundamental result showing that augmenting a solution space with new basis functions does not alter the coefficients of the existing modes, a property that makes p-refinement particularly elegant and efficient.", "problem": "Consider the one-dimensional reference element $\\Omega = [-1,1]$ with the standard Legendre polynomial basis $\\{P_{n}(x)\\}_{n\\geq 0}$, where $P_{n}(1)=1$ and the inner product is defined by $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)\\,g(x)\\,\\mathrm{d}x$. Assume a spectral or discontinuous Galerkin discretization in which the modal approximation uses the non-orthonormal Legendre basis $\\{P_{n}\\}$.\n\nLet the exact target function be $u(x)=\\exp(\\beta x)$ for a fixed parameter $\\beta\\in\\mathbb{R}$. You have an existing modal solution of degree $p$ constructed by least-squares projection in the $L^{2}(\\Omega)$ norm onto $\\operatorname{span}\\{P_{0},P_{1},\\dots,P_{p}\\}$. You are asked to augment the approximation space to degree $p+2$ (i.e., include $P_{p+1}$ and $P_{p+2}$) and determine, using only orthogonality and inner-product relations, the least-squares coefficients of the new modes $P_{p+1}$ and $P_{p+2}$ in closed form.\n\nDerive the expressions for the two augmentation coefficients as analytic functions of $p$ and $\\beta$ and provide your final answer as a single row matrix containing the two coefficients. No numerical rounding is required.", "solution": "The problem requires the determination of the coefficients for the basis functions $P_{p+1}(x)$ and $P_{p+2}(x)$ when a degree-$p$ spectral approximation of the function $u(x) = \\exp(\\beta x)$ is augmented to a degree-$(p+2)$ approximation. The approximation is defined as a least-squares projection in the $L^2(\\Omega)$ norm, where $\\Omega = [-1,1]$.\n\nLet the degree-$N$ approximation of $u(x)$ be denoted by $u_N(x)$, expressed as a linear combination of the Legendre basis polynomials $\\{P_n(x)\\}_{n=0}^N$:\n$$u_N(x) = \\sum_{n=0}^{N} \\hat{u}_n P_n(x)$$\nThe coefficients $\\hat{u}_n$ are determined by the least-squares projection, which is equivalent to the Galerkin condition that the error $u(x) - u_N(x)$ is orthogonal to the approximation space $\\operatorname{span}\\{P_0, \\dots, P_N\\}$. This condition is expressed as:\n$$\\langle u - u_N, v \\rangle = 0, \\quad \\forall v \\in \\operatorname{span}\\{P_0, \\dots, P_N\\}$$\nBy choosing the basis functions $v = P_k(x)$ for $k \\in \\{0, 1, \\dots, N\\}$, we obtain a set of equations:\n$$\\langle u(x) - \\sum_{n=0}^{N} \\hat{u}_n P_n(x), P_k(x) \\rangle = 0$$\n$$\\langle u, P_k \\rangle - \\sum_{n=0}^{N} \\hat{u}_n \\langle P_n, P_k \\rangle = 0$$\nThe standard Legendre polynomials form an orthogonal basis on the interval $[-1,1]$ with respect to the given inner product $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)g(x)\\,\\mathrm{d}x$. Their orthogonality property is:\n$$\\langle P_n, P_k \\rangle = \\int_{-1}^{1} P_n(x) P_k(x) \\,\\mathrm{d}x = \\frac{2}{2n+1} \\delta_{nk}$$\nwhere $\\delta_{nk}$ is the Kronecker delta. The problem states the basis is \"non-orthonormal\", which we interpret as correct in the sense that the basis vectors are not normalized to have a unit norm (i.e., $\\langle P_n, P_n\\rangle \\neq 1$), but they are orthogonal. This orthogonality is crucial and its use is explicitly requested.\n\nSubstituting the orthogonality property into the Galerkin condition, the summation collapses to a single term where $n=k$:\n$$\\langle u, P_k \\rangle - \\hat{u}_k \\langle P_k, P_k \\rangle = 0$$\nThis allows for the direct calculation of each coefficient $\\hat{u}_k$ independently:\n$$\\hat{u}_k = \\frac{\\langle u, P_k \\rangle}{\\langle P_k, P_k \\rangle} = \\frac{\\int_{-1}^{1} u(x) P_k(x) \\,\\mathrm{d}x}{\\frac{2}{2k+1}} = \\frac{2k+1}{2} \\int_{-1}^{1} u(x) P_k(x) \\,\\mathrm{d}x$$\nThis formula is valid for any coefficient $\\hat{u}_k$ in the expansion. A key consequence of orthogonality is that the coefficient $\\hat{u}_k$ depends only on $u(x)$ and $P_k(x)$, not on the dimension of the approximation space. Therefore, when augmenting the approximation from degree $p$ to degree $p+2$, the coefficients $\\hat{u}_0, \\dots, \\hat{u}_p$ remain unchanged. The new coefficients we must find are for the modes $P_{p+1}(x)$ and $P_{p+2}(x)$, which are simply $\\hat{u}_{p+1}$ and $\\hat{u}_{p+2}$.\n\nThe target function is $u(x) = \\exp(\\beta x)$. The coefficients are:\n$$\\hat{u}_{p+1} = \\frac{2(p+1)+1}{2} \\int_{-1}^{1} \\exp(\\beta x) P_{p+1}(x) \\,\\mathrm{d}x = \\frac{2p+3}{2} \\int_{-1}^{1} \\exp(\\beta x) P_{p+1}(x) \\,\\mathrm{d}x$$\n$$\\hat{u}_{p+2} = \\frac{2(p+2)+1}{2} \\int_{-1}^{1} \\exp(\\beta x) P_{p+2}(x) \\,\\mathrm{d}x = \\frac{2p+5}{2} \\int_{-1}^{1} \\exp(\\beta x) P_{p+2}(x) \\,\\mathrm{d}x$$\nTo proceed, we need to evaluate the integral $\\int_{-1}^{1} \\exp(\\beta x) P_n(x) \\,\\mathrm{d}x$. This is a standard integral in the theory of special functions. The result is given in terms of the modified spherical Bessel functions of the first kind, denoted $i_n(z)$:\n$$\\int_{-1}^{1} \\exp(\\beta x) P_n(x) \\,\\mathrm{d}x = 2 i_n(\\beta)$$\nThe functions $i_n(\\beta)$ are analytic functions of $\\beta$ and are expressible in terms of elementary functions (hyperbolic functions and powers of $\\beta$). For example, $i_0(\\beta) = \\frac{\\sinh(\\beta)}{\\beta}$ and $i_1(\\beta) = \\frac{\\cosh(\\beta)}{\\beta} - \\frac{\\sinh(\\beta)}{\\beta^2}$. The problem asks for the coefficients as analytic functions of $p$ and $\\beta$, and expressing them using $i_n(\\beta)$ is the standard and most compact closed form.\n\nSubstituting this identity into the expressions for the coefficients:\nFor the coefficient of $P_{p+1}(x)$:\n$$\\hat{u}_{p+1} = \\frac{2p+3}{2} \\left( 2 i_{p+1}(\\beta) \\right) = (2p+3) i_{p+1}(\\beta)$$\nFor the coefficient of $P_{p+2}(x)$:\n$$\\hat{u}_{p+2} = \\frac{2p+5}{2} \\left( 2 i_{p+2}(\\beta) \\right) = (2p+5) i_{p+2}(\\beta)$$\nThese are the required augmentation coefficients in closed form as analytic functions of $p$ and $\\beta$. The final answer should be presented as a row matrix containing these two expressions.", "answer": "$$ \\boxed{ \\begin{pmatrix} (2p+3) i_{p+1}(\\beta)  (2p+5) i_{p+2}(\\beta) \\end{pmatrix} } $$", "id": "3395701"}, {"introduction": "While Galerkin methods are often viewed from a \"modal\" perspective (working with coefficients), the \"nodal\" or collocation viewpoint provides powerful alternative algorithms. This exercise demonstrates the intimate link between the properties of Legendre polynomials and the construction of optimal nodal sets for spectral collocation [@problem_id:3395725]. You will see how the choice of Legendre-Gauss-Lobatto nodes, whose interior points are the zeros of the derivative of a Legendre polynomial, allows for the exact differentiation of polynomials within the approximation space.", "problem": "Consider a one-dimensional spectral collocation setting on the reference interval $[-1,1]$ using the Legendre-Gauss-Lobatto nodes for polynomial degree $N=5$. Let $x_0=-1$, $x_5=1$, and $x_1,x_2,x_3,x_4\\in(-1,1)$ be the four interior nodes defined as the distinct roots of the derivative of the Legendre polynomial $P_5(x)$, that is, $P_5'(x_j)=0$ for $j=1,2,3,4$. Let $\\{\\ell_j(x)\\}_{j=0}^{5}$ denote the Lagrange cardinal basis associated with these nodes, so that $\\ell_j(x_i)=\\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. Define the differentiation matrix $D\\in\\mathbb{R}^{6\\times 6}$ by $D_{ij}=\\ell_j'(x_i)$.\n\nLet the function be $u(x)=P_5(x)$, where $P_n(x)$ denotes the Legendre polynomial of degree $n$, defined by the Rodrigues formula $P_n(x)=\\frac{1}{2^n n!}\\frac{d^n}{dx^n}\\left(x^2-1\\right)^n$ and satisfying the three-term recurrence $(n+1)P_{n+1}(x)=(2n+1)xP_n(x)-nP_{n-1}(x)$ with $P_0(x)=1$ and $P_1(x)=x$.\n\nUsing only the definitions above, compute the exact nodal derivative vector $D\\,\\boldsymbol{u}$, where $\\boldsymbol{u}=\\big(u(x_0),u(x_1),u(x_2),u(x_3),u(x_4),u(x_5)\\big)^{\\top}$, and verify that it agrees with the analytical derivative evaluated at the nodes, $\\big(u'(x_0),u'(x_1),u'(x_2),u'(x_3),u'(x_4),u'(x_5)\\big)^{\\top}$. Provide your final answer as a single row matrix listing the six entries in increasing node order $x_0x_1x_2x_3x_4x_5$. No rounding is required.", "solution": "The problem requires the computation of the nodal derivative vector $D\\boldsymbol{u}$ for the function $u(x) = P_5(x)$ on the Legendre-Gauss-Lobatto (LGL) nodes for polynomial degree $N=5$. We must then verify that this result matches the vector of the analytical derivative, $u'(x)$, evaluated at the same nodes.\n\nFirst, let us establish the key entities. The function is $u(x) = P_5(x)$, where $P_5(x)$ is the Legendre polynomial of degree $5$. The set of nodes $\\{x_j\\}_{j=0}^{5}$ are the $N=5$ LGL nodes, consisting of the endpoints $x_0=-1$ and $x_5=1$, and the interior nodes $\\{x_j\\}_{j=1}^{4}$, which are the roots of the derivative of the Legendre polynomial $P_5(x)$, i.e., $P_5'(x_j)=0$ for $j=1,2,3,4$.\n\nThe vector $\\boldsymbol{u}$ represents the function values at these nodes: $\\boldsymbol{u} = (u(x_0), u(x_1), u(x_2), u(x_3), u(x_4), u(x_5))^{\\top}$.\nThe Lagrange cardinal basis functions $\\{\\ell_j(x)\\}_{j=0}^{5}$ are polynomials of degree $5$ satisfying the property $\\ell_j(x_i) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. The differentiation matrix $D$ is defined by its entries $D_{ij} = \\ell_j'(x_i)$.\n\nThe product $D\\boldsymbol{u}$ yields a column vector, where the $i$-th entry is given by:\n$$ (D\\boldsymbol{u})_i = \\sum_{j=0}^{5} D_{ij} u_j = \\sum_{j=0}^{5} \\ell_j'(x_i) u(x_j) $$\n\nLet us consider the polynomial interpolant of $u(x)$ passing through the $N+1=6$ nodes $\\{x_j\\}_{j=0}^5$. This interpolant, let's call it $p(x)$, can be written in the Lagrange form as:\n$$ p(x) = \\sum_{j=0}^{5} u(x_j) \\ell_j(x) $$\nSince the function $u(x)=P_5(x)$ is a polynomial of degree $5$, and we are using $6$ distinct nodes, the unique polynomial interpolant of degree at most $5$ is the function $u(x)$ itself. Thus, we have the identity:\n$$ u(x) = p(x) = \\sum_{j=0}^{5} u(x_j) \\ell_j(x) $$\nDifferentiating this exact representation with respect to $x$ gives:\n$$ u'(x) = p'(x) = \\frac{d}{dx} \\left( \\sum_{j=0}^{5} u(x_j) \\ell_j(x) \\right) = \\sum_{j=0}^{5} u(x_j) \\ell_j'(x) $$\nNow, we evaluate this derivative at each of the LGL nodes, $x_i$:\n$$ u'(x_i) = \\sum_{j=0}^{5} u(x_j) \\ell_j'(x_i) $$\nComparing this expression with the definition of the $i$-th component of $D\\boldsymbol{u}$, we see they are identical:\n$$ (D\\boldsymbol{u})_i = u'(x_i) $$\nThis demonstrates that for a polynomial of degree up to $N$, the spectral collocation differentiation process is exact. Computing the vector $D\\boldsymbol{u}$ is therefore equivalent to computing the vector of the analytical derivative values at the nodes, $(u'(x_0), u'(x_1), u'(x_2), u'(x_3), u'(x_4), u'(x_5))^{\\top}$. This constitutes the required verification.\n\nNow we proceed to compute these values. The function is $u(x)=P_5(x)$, so its derivative is $u'(x)=P_5'(x)$. We need to evaluate $P_5'(x)$ at the LGL nodes $\\{x_j\\}_{j=0}^5$.\n\nFor the interior nodes $x_1, x_2, x_3, x_4$, they are defined as the roots of $P_5'(x)$. Therefore, by definition:\n$$ u'(x_j) = P_5'(x_j) = 0 \\quad \\text{for } j=1, 2, 3, 4 $$\n\nFor the boundary nodes, $x_0=-1$ and $x_5=1$, we need to evaluate $P_5'(-1)$ and $P_5'(1)$. A standard property of Legendre polynomials $P_n(x)$ is that their derivatives at the endpoints are given by:\n$$ P_n'(1) = \\frac{n(n+1)}{2} $$\n$$ P_n'(-1) = (-1)^{n-1} \\frac{n(n+1)}{2} $$\nFor our case, $n=5$. Substituting this value into the formulas:\n$$ u'(x_5) = P_5'(1) = \\frac{5(5+1)}{2} = \\frac{5 \\times 6}{2} = 15 $$\n$$ u'(x_0) = P_5'(-1) = (-1)^{5-1} \\frac{5(5+1)}{2} = (-1)^4 \\times 15 = 15 $$\n\nWe can now assemble the complete nodal derivative vector $D\\boldsymbol{u}$:\n$$ D\\boldsymbol{u} = \\begin{pmatrix} u'(x_0) \\\\ u'(x_1) \\\\ u'(x_2) \\\\ u'(x_3) \\\\ u'(x_4) \\\\ u'(x_5) \\end{pmatrix} = \\begin{pmatrix} 15 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 15 \\end{pmatrix} $$\nThe problem asks for the result as a single row matrix. The ordered entries corresponding to the nodes $x_0  x_1  x_2  x_3  x_4  x_5$ are $(15, 0, 0, 0, 0, 15)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 15  0  0  0  0  15 \\end{pmatrix}}\n$$", "id": "3395725"}, {"introduction": "The theoretical properties of polynomial bases have direct and critical consequences for the practical implementation of numerical methods. This practice delves into the Discontinuous Galerkin (DG) method, focusing on the numerical integration required to handle terms on element boundaries, particularly for nonlinear problems [@problem_id:3395757]. You will perform a \"quadrature-exactness\" analysis to determine the minimum number of integration points needed to compute face integrals accurately, a crucial step in designing a stable and accurate DG solver.", "problem": "Consider the Discontinuous Galerkin (DG) semi-discrete formulation of a scalar conservation law on a one-dimensional reference element with coordinate $x \\in [-1,1]$. Let the trial and test spaces be spanned by Legendre polynomials $\\{P_{k}(x)\\}_{k=0}^{p}$, so that the trace of any solution $u_{h}$ or test function $v_{h}$ on a face parameterized by a local coordinate $s \\in [-1,1]$ is a univariate polynomial of degree at most $p$. Assume that the numerical flux is a two-point function $\\widehat{f}(u^{-},u^{+})$ which, when the physical flux $f(u)$ is polynomial of degree at most $r \\in \\mathbb{N}$, is itself a polynomial in its arguments of total degree at most $r$. Along a face, the DG face integral involves the product of a test trace $v_{h}(s)$ and $\\widehat{f}(u_{h}^{-}(s),u_{h}^{+}(s))$.\n\nUsing only first principles about polynomial degree under algebraic operations and the defining property of Legendre polynomial spaces, determine the minimal number of Gaussâ€“Legendre quadrature points $N_{q}$ on a face that guarantees exact evaluation of the face integral for all $u_{h},v_{h} \\in \\mathbb{P}_{p}$ when $\\widehat{f}$ has total polynomial degree at most $r$ in its arguments. Then, specialize your result to the requirement for exact integration of products whose degree is at most $2p$.\n\nProvide your final answer as a two-entry row vector: the first entry is $N_{q}$ as a function of $p$ and $r$, and the second entry is the minimal $N_{q}$ needed to exactly integrate all products up to degree $2p$. No numerical evaluation is required, and no units are involved. The final answer must be a closed-form expression.", "solution": "The fundamental principle governing this problem is the exactness property of Gauss-Legendre quadrature. An $N_q$-point Gauss-Legendre quadrature rule on the interval $[-1,1]$ integrates any polynomial of degree at most $2N_q - 1$ exactly. To find the minimal number of points $N_q$, we must first determine the maximum possible degree of the polynomial integrand.\n\n**Part 1: Face Integral Quadrature**\n\nThe face integral to be evaluated is of the form\n$$\nI = \\int_{-1}^{1} v_{h}(s) \\widehat{f}(u_{h}^{-}(s), u_{h}^{+}(s)) ds\n$$\nLet the integrand be denoted by $g(s) = v_{h}(s) \\widehat{f}(u_{h}^{-}(s), u_{h}^{+}(s))$. We need to find the maximum possible polynomial degree of $g(s)$, denoted $\\deg(g)$.\n\n1.  **Degree of the Test Function Trace**: The test function $v_h$ belongs to the space $\\mathbb{P}_p$, which consists of polynomials of degree at most $p$. Its trace on the face, $v_h(s)$, is therefore a polynomial in the face coordinate $s$ with $\\deg(v_h(s)) \\le p$.\n\n2.  **Degree of the Solution Traces**: Similarly, the solution $u_h$ is in $\\mathbb{P}_p$. Its interior and exterior traces on the face, $u_h^-(s)$ and $u_h^+(s)$, are polynomials in $s$, each with a degree of at most $p$. Thus, $\\deg(u_h^-(s)) \\le p$ and $\\deg(u_h^+(s)) \\le p$.\n\n3.  **Degree of the Numerical Flux Term**: The numerical flux $\\widehat{f}(A,B)$ is given to be a polynomial in its arguments $A$ and $B$ of total degree at most $r$. This means it can be expressed as a sum of terms of the form $c_{ij}A^i B^j$ where $i+j \\le r$.\n    In our case, the arguments are the polynomial traces, $A = u_h^-(s)$ and $B = u_h^+(s)$. The degree of a single term in the expansion of $\\widehat{f}(u_h^-(s), u_h^+(s))$ is:\n    $$\n    \\deg\\left( (u_h^-(s))^i (u_h^+(s))^j \\right) = i \\cdot \\deg(u_h^-(s)) + j \\cdot \\deg(u_h^+(s))\n    $$\n    To find the maximum possible degree, we take the maximum degree for the traces:\n    $$\n    \\deg\\left( (u_h^-(s))^i (u_h^+(s))^j \\right) \\le i \\cdot p + j \\cdot p = (i+j)p\n    $$\n    The degree of the entire numerical flux polynomial $\\widehat{f}(u_h^-(s), u_h^+(s))$ is the maximum of the degrees of its constituent terms. This maximum is achieved when the sum $i+j$ is maximized. According to the problem statement, the maximum value of $i+j$ is $r$.\n    Therefore, the maximum degree of the numerical flux as a polynomial in $s$ is $r \\cdot p$. Let's denote this as $\\deg(\\widehat{f}(\\cdot, \\cdot))_s \\le rp$.\n\n4.  **Degree of the Full Integrand**: The integrand is the product $g(s) = v_h(s) \\cdot \\widehat{f}(u_h^-(s), u_h^+(s))$. The degree of a product of polynomials is the sum of their degrees.\n    $$\n    \\deg(g(s)) = \\deg(v_h(s)) + \\deg(\\widehat{f}(u_h^-(s), u_h^+(s)))_s\n    $$\n    The maximum possible degree of the integrand, $D_{\\text{max}}$, is therefore:\n    $$\n    D_{\\text{max}} \\le p + rp = p(r+1)\n    $$\n\n5.  **Required Number of Quadrature Points**: To guarantee exact integration, the Gauss-Legendre quadrature rule must be exact for any polynomial of degree up to $D_{\\text{max}} = p(r+1)$. We must satisfy the condition:\n    $$\n    2N_q - 1 \\ge p(r+1)\n    $$\n    Solving for $N_q$, we get:\n    $$\n    N_q \\ge \\frac{p(r+1) + 1}{2}\n    $$\n    Since $N_q$ must be an integer, the minimal required number of quadrature points is the smallest integer satisfying this inequality, which is given by the ceiling function:\n    $$\n    N_q = \\left\\lceil \\frac{p(r+1) + 1}{2} \\right\\rceil\n    $$\n\n**Part 2: Specialization for Products of Degree at most $2p$**\n\nThe second part asks for the minimal $N_q$ needed to exactly integrate products whose total polynomial degree is at most $2p$. This is a direct application of the same quadrature principle.\n\n1.  **Maximum Degree of the Integrand**: The maximum degree of the polynomial to be integrated is given as $D = 2p$.\n\n2.  **Required Number of Quadrature Points**: We apply the exactness condition for Gauss-Legendre quadrature directly:\n    $$\n    2N_q - 1 \\ge 2p\n    $$\n    Solving for $N_q$:\n    $$\n    2N_q \\ge 2p+1 \\implies N_q \\ge p + \\frac{1}{2}\n    $$\n    Since $N_q$ must be an integer, the minimal number of points is the smallest integer greater than or equal to $p + 1/2$, which is:\n    $$\n    N_q = p+1\n    $$\nThis result corresponds to the standard requirement for exactly computing volume integrals such as the mass matrix term $\\int u_h v_h dx$ in DG methods, where the integrand is a product of two polynomials from $\\mathbb{P}_p$, resulting in a polynomial of degree at most $2p$.\n\nThe final answer is a two-entry row vector containing the results from Part 1 and Part 2.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left\\lceil \\frac{p(r+1)+1}{2} \\right\\rceil  p+1\n\\end{pmatrix}\n}\n$$", "id": "3395757"}]}