{"hands_on_practices": [{"introduction": "Spectral methods achieve high accuracy by representing solutions as high-degree polynomials. However, when dealing with nonlinear equations, the product of two polynomials results in a higher-degree polynomial that cannot be exactly represented on the original grid. This exercise explores the concept of aliasing, where high-frequency information masquerades as low-frequency information upon interpolation, by comparing the exact product of two Chebyshev polynomials to its aliased representation on a collocation grid. Understanding this phenomenon is critical for developing stable and accurate schemes for nonlinear problems.", "problem": "Consider the Chebyshev polynomials of the first kind defined by $T_{n}(x) = \\cos(n \\arccos x)$ on the interval $[-1,1]$. Let the Chebyshev–Lobatto nodes be $x_{j} = \\cos\\left(\\frac{\\pi j}{N}\\right)$ for $j = 0,1,\\dots,N$, and define the interpolation operator $\\mathcal{I}_{N}$ as the unique polynomial of degree at most $N$ that interpolates a given function at these nodes. Let the weighted inner product be given by\n$$\\langle f,g\\rangle_{w} = \\int_{-1}^{1} f(x)\\,g(x)\\,\\frac{1}{\\sqrt{1-x^{2}}}\\,dx,$$\nwith the associated weighted $L^{2}$ norm $\\|f\\|_{w} = \\sqrt{\\langle f,f\\rangle_{w}}$. Denote by $\\mathcal{P}_{N}$ the orthogonal projection (with respect to $\\langle\\cdot,\\cdot\\rangle_{w}$) onto the space of polynomials of degree at most $N$.\n\nLet $u(x) = T_{6}(x)$ and $v(x) = T_{7}(x)$ on $[-1,1]$, and set $N=8$. Define $w(x)=u(x)v(x)$. Using only fundamental identities and definitions, do the following:\n- Derive an explicit Chebyshev basis representation for $w(x)$.\n- Determine the aliased nodal product $\\mathcal{I}_{8}(w)$ by analyzing the behavior of Chebyshev polynomials sampled on the Chebyshev–Lobatto grid $\\{x_{j}\\}_{j=0}^{8}$.\n- Determine the exact orthogonal projection $\\mathcal{P}_{8}(w)$.\n- Compute the weighted $L^{2}$ norm $\\|\\mathcal{I}_{8}(w) - \\mathcal{P}_{8}(w)\\|_{w}$.\n\nProvide your final answer as a single exact analytic expression. Do not round your answer.", "solution": "The problem requires the computation of the weighted $L^{2}$ norm of the difference between the interpolant and the orthogonal projection of a specific function $w(x)$. We will solve this by determining each required quantity in a step-by-step manner.\n\nFirst, we establish the explicit Chebyshev basis representation for the function $w(x)$. The function is defined as the product of $u(x) = T_{6}(x)$ and $v(x) = T_{7}(x)$, where $T_{n}(x)$ is the Chebyshev polynomial of the first kind of degree $n$.\n$$w(x) = u(x)v(x) = T_{6}(x)T_{7}(x)$$\nWe use the standard product-to-sum identity for Chebyshev polynomials, which states that for any non-negative integers $m$ and $n$:\n$$T_{m}(x)T_{n}(x) = \\frac{1}{2}\\left(T_{m+n}(x) + T_{|m-n|}(x)\\right)$$\nApplying this identity with $m=7$ and $n=6$, we find the expression for $w(x)$:\n$$w(x) = T_{7}(x)T_{6}(x) = \\frac{1}{2}\\left(T_{7+6}(x) + T_{7-6}(x)\\right) = \\frac{1}{2}T_{13}(x) + \\frac{1}{2}T_{1}(x)$$\nThis is the expansion of $w(x)$ in the Chebyshev basis. The degree of $w(x)$ is $13$.\n\nSecond, we determine the aliased nodal product $\\mathcal{I}_{8}(w)$. This is the unique polynomial of degree at most $N=8$ that interpolates $w(x)$ at the $N+1=9$ Chebyshev–Lobatto nodes, given by $x_{j} = \\cos\\left(\\frac{\\pi j}{N}\\right) = \\cos\\left(\\frac{\\pi j}{8}\\right)$ for $j = 0, 1, \\dots, 8$. The interpolation operator $\\mathcal{I}_{N}$ is linear.\n$$\\mathcal{I}_{8}(w) = \\mathcal{I}_{8}\\left(\\frac{1}{2}T_{13}(x) + \\frac{1}{2}T_{1}(x)\\right) = \\frac{1}{2}\\mathcal{I}_{8}(T_{13}) + \\frac{1}{2}\\mathcal{I}_{8}(T_{1})$$\nFor the term $T_{1}(x)$, its degree is $1$, which is less than or equal to $N=8$. A polynomial of degree at most $N$ is its own interpolant of degree at most $N$. Thus, $\\mathcal{I}_{8}(T_{1}) = T_{1}(x)$.\nFor the term $T_{13}(x)$, its degree $13$ is greater than $N=8$, so aliasing occurs. On the Chebyshev-Lobatto grid $\\{x_{j}\\}_{j=0}^{N}$, the values of $T_{k}(x)$ for $k$ in the range $N  k  2N$ are identical to the values of $T_{2N-k}(x)$. For $k=13$ and $N=8$, we have $8  13  16$. The aliasing identity is:\n$$T_{13}(x_{j}) = T_{13}\\left(\\cos\\left(\\frac{\\pi j}{8}\\right)\\right) = \\cos\\left(\\frac{13\\pi j}{8}\\right) = \\cos\\left(\\frac{(16-3)\\pi j}{8}\\right) = \\cos\\left(2\\pi j - \\frac{3\\pi j}{8}\\right) = \\cos\\left(\\frac{3\\pi j}{8}\\right) = T_{3}(x_{j})$$\nThis holds for all $j=0, 1, \\dots, 8$. The unique polynomial of degree at most $8$ that interpolates the nodal values $\\{T_{13}(x_j)\\}_{j=0}^8$ is therefore $T_{3}(x)$, since its degree is $3 \\leq 8$. So, $\\mathcal{I}_{8}(T_{13}) = T_{3}(x)$.\nCombining these results, the aliased product is:\n$$\\mathcal{I}_{8}(w)(x) = \\frac{1}{2}T_{3}(x) + \\frac{1}{2}T_{1}(x)$$\n\nThird, we determine the exact orthogonal projection $\\mathcal{P}_{8}(w)$. This is the best approximation of $w(x)$ in the weighted $L^{2}$ norm from the space of polynomials of degree at most $N=8$, which we denote $\\mathbb{P}_{8}$. A function $f(x)$ with the Chebyshev series expansion $f(x) = \\sum_{k=0}^{\\infty} a_{k}T_{k}(x)$ has its orthogonal projection onto $\\mathbb{P}_{N}$ given by the truncated series $\\mathcal{P}_{N}(f)(x) = \\sum_{k=0}^{N} a_{k}T_{k}(x)$.\nThe Chebyshev expansion for $w(x)$ is $w(x) = \\frac{1}{2}T_{1}(x) + \\frac{1}{2}T_{13}(x)$. Truncating this series at degree $N=8$ means we keep only the terms with index $k \\le 8$.\n$$\\mathcal{P}_{8}(w)(x) = \\frac{1}{2}T_{1}(x)$$\nThe term involving $T_{13}(x)$ is omitted because $13 > 8$. This is a consequence of the orthogonality of Chebyshev polynomials with respect to the inner product $\\langle\\cdot,\\cdot\\rangle_{w}$, which implies $\\langle T_{13}, T_{k} \\rangle_{w} = 0$ for all $k \\leq 12$, and specifically for $k \\leq 8$.\n\nFourth, we compute the norm of the difference $\\|\\mathcal{I}_{8}(w) - \\mathcal{P}_{8}(w)\\|_{w}$. The difference between the interpolant and the projection is:\n$$\\mathcal{I}_{8}(w)(x) - \\mathcal{P}_{8}(w)(x) = \\left(\\frac{1}{2}T_{3}(x) + \\frac{1}{2}T_{1}(x)\\right) - \\frac{1}{2}T_{1}(x) = \\frac{1}{2}T_{3}(x)$$\nThe required norm is $\\|\\frac{1}{2}T_{3}(x)\\|_{w}$. Using the properties of norms, this is $\\frac{1}{2}\\|T_{3}(x)\\|_{w}$. The squared norm $\\|T_{n}\\|_{w}^{2}$ is defined by the inner product $\\langle T_{n}, T_{n} \\rangle_{w}$. We evaluate the integral using the substitution $x=\\cos(\\theta)$:\n$$ \\langle T_{n}, T_{n} \\rangle_{w} = \\int_{-1}^{1} T_{n}(x)^{2}\\,\\frac{1}{\\sqrt{1-x^{2}}}\\,dx = \\int_{\\pi}^{0} \\cos^{2}(n\\theta) \\frac{1}{\\sin(\\theta)} (-\\sin(\\theta)d\\theta) = \\int_{0}^{\\pi} \\cos^{2}(n\\theta) d\\theta$$\nFor $n > 0$, this integral evaluates to:\n$$ \\int_{0}^{\\pi} \\frac{1+\\cos(2n\\theta)}{2} d\\theta = \\left[\\frac{\\theta}{2} + \\frac{\\sin(2n\\theta)}{4n}\\right]_{0}^{\\pi} = \\frac{\\pi}{2} $$\nFor $n=3$, we have $\\|T_{3}\\|_{w}^{2} = \\langle T_{3}, T_{3} \\rangle_{w} = \\frac{\\pi}{2}$.\nThus, the norm is $\\|T_{3}\\|_{w} = \\sqrt{\\frac{\\pi}{2}}$.\nFinally, the norm of the difference is:\n$$\\|\\mathcal{I}_{8}(w) - \\mathcal{P}_{8}(w)\\|_{w} = \\frac{1}{2}\\|T_{3}\\|_{w} = \\frac{1}{2}\\sqrt{\\frac{\\pi}{2}} = \\frac{\\sqrt{\\pi}}{2\\sqrt{2}} = \\frac{\\sqrt{2\\pi}}{4}$$", "answer": "$$\\boxed{\\frac{\\sqrt{2\\pi}}{4}}$$", "id": "3416558"}, {"introduction": "A crucial step in solving differential equations is constructing a discrete operator that faithfully mimics the properties of its continuous counterpart. For second-order operators, one can either directly discretize the expanded strong form or build a weak form based on integration by parts. This practice guides you through implementing both approaches to discover why the weak-form, or conservative, discretization is often superior, as it naturally yields a symmetric positive definite matrix that ensures stability.", "problem": "Consider the one-dimensional second-order elliptic operator in conservative form on the interval $[-1,1]$ with homogeneous Dirichlet boundary conditions, defined by the differential equation\n$$\n-(a(x)\\, u_x)_x = f(x), \\quad x \\in [-1,1], \\quad u(-1)=u(1)=0,\n$$\nwhere $a(x)$ is a strictly positive function on $[-1,1]$ and $u(x)$ is the unknown solution. In spectral collocation using Legendre–Gauss–Lobatto (LGL) points, let $N$ denote the polynomial degree of the global interpolant, $N+1$ the number of LGL nodes, $x_j$ the LGL nodes, $w_j$ the corresponding LGL quadrature weights, and $D$ the LGL differentiation matrix acting on nodal values. The discrete conservative weak form stiffness matrix that respects symmetry under the discrete $L^2$ inner product is\n$$\nK = D_{AI}^\\top W A D_{AI},\n$$\nwhere $A=\\mathrm{diag}(a(x_j))$, $W=\\mathrm{diag}(w_j)$, and $D_{AI}$ denotes the columns of $D$ corresponding to the interior degrees of freedom (excluding the endpoints to enforce homogeneous Dirichlet boundary conditions). The strong-form collocation matrix obtained by differentiating the nodal product $(a u_x)$ is\n$$\nL_c = -\\left[ D\\, A\\, D \\right]_{II},\n$$\nthe interior-interior submatrix of $-D A D$, which enforces the operator at the interior nodes.\n\nStarting from the following fundamental bases:\n- The definition of Lagrange interpolation at LGL points and its exactness properties for polynomials.\n- The property that LGL quadrature with $N+1$ nodes integrates any polynomial of degree up to $2N-1$ exactly.\n- The definition of the Legendre polynomials and their role in constructing LGL nodes.\n- The standard discrete weak form derived from integration by parts, yielding a symmetric positive definite bilinear form when $a(x)>0$.\n\nYour tasks are:\n- Derive, from first principles, the required exactness of the quadrature integrand so that the discrete weak-form collocation stiffness matrix $K$ coincides with the exact Galerkin stiffness matrix and is symmetric positive definite (SPD). Express this exactness as a condition on the polynomial degree of $a(x)$ relative to $N$.\n- Implement a program that constructs the LGL nodes, weights, and differentiation matrix for a given $N$, builds both $K$ and $L_c$ for specified $a(x)$, and checks for symmetry and positive definiteness of each matrix under homogeneous Dirichlet boundary conditions by removing the boundary degrees of freedom.\n- Identify and test failure cases when $a(x)$ is under-resolved by the chosen polynomial degree $N$ in the strong-form collocation $L_c$. Use radian units for any trigonometric function such as $\\cos$.\n\nUse the following test suite of parameter sets $(N, a(x), p)$, where $p$ is the polynomial degree of $a(x)$ when applicable, otherwise set to a special marker indicating nonpolynomial:\n- Case $1$: $N=8$, $a(x)=1.2 + x$, $p=1$.\n- Case $2$: $N=8$, $a(x)=1 + x^2$, $p=2$.\n- Case $3$: $N=12$, $a(x)=1 + 0.5\\cos(10 x)$ (use radians), $p$ is nonpolynomial.\n- Case $4$: $N=8$, $a(x)=1 + 0.9\\cos(20 x)$ (use radians), $p$ is nonpolynomial.\n\nFor each case, your program must compute and return a list of five values:\n- A boolean indicating whether $K$ is symmetric.\n- A boolean indicating whether $K$ is symmetric positive definite (SPD).\n- A boolean indicating whether $L_c$ is symmetric.\n- A boolean indicating whether $L_c$ is symmetric positive definite (SPD).\n- A boolean indicating whether the quadrature exactness condition derived for $K$ is satisfied, i.e., whether the integrand’s degree is at most $2N-1$ (for nonpolynomial $a(x)$, this must be returned as the boolean value for “not satisfied”).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is itself a list of the five boolean values in the same order as described above. For example, an output line with four test cases in the specified order should look like\n$$\n[\\,[b_{11},b_{12},b_{13},b_{14},b_{15}],\\,[b_{21},b_{22},b_{23},b_{24},b_{25}],\\,[b_{31},b_{32},b_{33},b_{34},b_{35}],\\,[b_{41},b_{42},b_{43},b_{44},b_{45}]\\,]\n$$\nwith each $b_{ij}$ being either the literal $\\texttt{True}$ or $\\texttt{False}$.", "solution": "The problem statement is first validated for scientific soundness, self-consistency, and objectivity.\n\n### Step 1: Extract Givens\n- **Differential Equation**: $-(a(x)\\, u_x)_x = f(x)$ for $x \\in [-1,1]$.\n- **Boundary Conditions**: Homogeneous Dirichlet, $u(-1)=u(1)=0$.\n- **Coefficient Function**: $a(x)$ is a strictly positive function on $[-1,1]$.\n- **Discretization**: Spectral collocation using Legendre–Gauss–Lobatto (LGL) points.\n- **Parameters**:\n    - $N$: Polynomial degree of the global interpolant.\n    - $N+1$: Number of LGL nodes.\n    - $x_j$: LGL nodes for $j=0, \\dots, N$.\n    - $w_j$: LGL quadrature weights for $j=0, \\dots, N$.\n    - $D$: $(N+1) \\times (N+1)$ LGL differentiation matrix.\n- **Matrix Definitions**:\n    - **Weak Form Stiffness Matrix**: $K = D_{AI}^\\top W A D_{AI}$.\n        - $A = \\mathrm{diag}(a(x_j))$.\n        - $W = \\mathrm{diag}(w_j)$.\n        - $D_{AI}$: Columns of $D$ corresponding to interior nodes (indices $1, \\dots, N-1$).\n    - **Strong Form Collocation Matrix**: $L_c = -\\left[ D\\, A\\, D \\right]_{II}$.\n        - $II$ denotes the submatrix corresponding to interior-interior indices.\n- **Fundamental Principles**: Lagrange interpolation, LGL quadrature exactness (for polynomials of degree up to $2N-1$), properties of Legendre polynomials, and standard weak form derivation via integration by parts.\n- **Test Cases**:\n    1. $N=8$, $a(x)=1.2 + x$, $p=1$.\n    2. $N=8$, $a(x)=1 + x^2$, $p=2$.\n    3. $N=12$, $a(x)=1 + 0.5\\cos(10 x)$, $p$ is nonpolynomial.\n    4. $N=8$, $a(x)=1 + 0.9\\cos(20 x)$, $p$ is nonpolynomial.\n- **Required Output**: For each test case, a list of five booleans: $[is\\_K\\_symmetric, is\\_K\\_spd, is\\_Lc\\_symmetric, is\\_Lc\\_spd, is\\_quadrature\\_exactness\\_satisfied]$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the well-established field of numerical analysis, specifically spectral methods for differential equations. The definitions of the operators, matrices ($K$ and $L_c$), and LGL discretization are standard and correct. The tasks—derivation of a condition and numerical verification—are objective and well-posed. The provided test cases use functions $a(x)$ that are strictly positive on $[-1,1]$, ensuring the mathematical and physical well-posedness of the underlying continuous problem. The parameters are complete and consistent. For these reasons, the problem is deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution and Derivation\n\n#### Part 1: Derivation of the Quadrature Exactness Condition for $K$\n\nThe continuous weak form of the differential equation is obtained by multiplying by a test function $v(x)$ from a suitable space (here, $H_0^1(-1,1)$) and integrating over the domain $[-1,1]$.\n$$ \\int_{-1}^{1} -(a(x) u_x(x))_x v(x) \\, dx = \\int_{-1}^{1} f(x) v(x) \\, dx $$\nIntegration by parts on the left-hand side yields:\n$$ \\left[-a(x) u_x(x) v(x)\\right]_{-1}^{1} + \\int_{-1}^{1} a(x) u_x(x) v_x(x) \\, dx = \\int_{-1}^{1} f(x) v(x) \\, dx $$\nGiven the homogeneous Dirichlet boundary conditions for the solution space ($u(-1)=u(1)=0$, and we choose test functions $v$ such that $v(-1)=v(1)=0$), the boundary term vanishes. This gives the bilinear form for the Galerkin method:\n$$ B(u, v) = \\int_{-1}^{1} a(x) u_x(x) v_x(x) \\, dx $$\nThe exact Galerkin stiffness matrix entries are $K_{ij}^{\\text{Galerkin}} = B(\\phi_j, \\phi_i)$, where $\\{\\phi_i\\}$ is a set of basis functions. In the collocation context, we use Lagrange polynomials $\\ell_j(x)$ as the basis. Due to the homogeneous boundary conditions, we only consider basis functions corresponding to interior nodes, i.e., $i, j \\in \\{1, \\dots, N-1\\}$.\n$$ K_{ij}^{\\text{Galerkin}} = \\int_{-1}^{1} a(x) \\ell'_j(x) \\ell'_i(x) \\, dx $$\nThe discrete weak-form stiffness matrix $K = D_{AI}^\\top W A D_{AI}$ arises from approximating the integral $B(u,v)$ using LGL quadrature. The quadrature approximation of $B(u,v)$ is:\n$$ B(u,v) \\approx \\sum_{k=0}^{N} w_k a(x_k) u_x(x_k) v_x(x_k) = (\\mathbf{u}_x)^\\top W A \\mathbf{v}_x $$\nwhere $\\mathbf{u}_x$ and $\\mathbf{v}_x$ are vectors of the derivative values at all LGL nodes. These derivatives are obtained from the interior nodal values $\\mathbf{u}_I$ and $\\mathbf{v}_I$ via the differentiation matrix block $D_{AI}$: $\\mathbf{u}_x = D_{AI} \\mathbf{u}_I$ and $\\mathbf{v}_x = D_{AI} \\mathbf{v}_I$. Substituting these into the quadrature sum gives the quadratic form corresponding to the matrix $K$:\n$$ \\mathbf{v}_I^\\top (D_{AI}^\\top W A D_{AI}) \\mathbf{u}_I = \\mathbf{v}_I^\\top K \\mathbf{u}_I $$\nThe discrete matrix $K$ coincides with the exact Galerkin matrix $K^{\\text{Galerkin}}$ if and only if the LGL quadrature rule is exact for the integrand $I(x) = a(x) \\ell'_j(x) \\ell'_i(x)$.\nThe Lagrange basis polynomials $\\ell_j(x)$ associated with $N+1$ LGL nodes are of degree $N$. Their derivatives, $\\ell'_j(x)$, are polynomials of degree $N-1$. The product $\\ell'_j(x) \\ell'_i(x)$ is therefore a polynomial of degree at most $(N-1) + (N-1) = 2N-2$.\nLet $p$ be the polynomial degree of the coefficient function $a(x)$. The total degree of the integrand is $\\deg(I(x)) = p + 2N-2$.\nLGL quadrature with $N+1$ nodes is exact for any polynomial of degree up to $2N-1$. For the quadrature to be exact, we must have:\n$$ \\deg(I(x)) \\le 2N-1 $$\n$$ p + 2N-2 \\le 2N-1 $$\n$$ p \\le 1 $$\nThus, the discrete weak-form matrix $K$ is identical to the exact Galerkin matrix if and only if $a(x)$ is a polynomial of degree at most $1$.\n\n#### Part 2: Properties of $K$ and $L_c$\n\n**Symmetry and Positive Definiteness of $K$**:\nThe matrix $K = D_{AI}^\\top W A D_{AI}$ is always symmetric. The matrices $W$ and $A$ are diagonal and thus symmetric.\n$$ K^\\top = (D_{AI}^\\top W A D_{AI})^\\top = D_{AI}^\\top A^\\top W^\\top (D_{AI}^\\top)^\\top = D_{AI}^\\top A W D_{AI} $$\nSince diagonal matrices commute, $AW=WA$, so $K^\\top = D_{AI}^\\top W A D_{AI} = K$.\nTo check for positive definiteness, consider the quadratic form for any non-zero vector $\\mathbf{v} \\in \\mathbb{R}^{N-1}$:\n$$ \\mathbf{v}^\\top K \\mathbf{v} = \\mathbf{v}^\\top D_{AI}^\\top W A D_{AI} \\mathbf{v} = (D_{AI}\\mathbf{v})^\\top W A (D_{AI}\\mathbf{v}) $$\nLet $\\mathbf{y} = D_{AI}\\mathbf{v}$. This is the vector of derivatives at all nodes of the polynomial that has values $\\mathbf{v}$ at interior nodes and zero at the boundaries. The quadratic form is $\\sum_{j=0}^{N} w_j a(x_j) y_j^2$. Since LGL weights $w_j$ are positive and $a(x)$ is strictly positive, all $a(x_j)>0$. The sum is positive unless all $y_j=0$. If $\\mathbf{y}=0$, the derivative polynomial is zero at all $N+1$ nodes. Since the derivative is of degree $N-1$, it must be identically zero. This implies the polynomial itself is a constant. As it is zero at the boundaries, it must be the zero polynomial. This means its interior nodal values $\\mathbf{v}$ must be zero. Therefore, for $\\mathbf{v} \\neq 0$, $\\mathbf{v}^\\top K \\mathbf{v} > 0$.\nConclusion: $K$ is symmetric positive definite (SPD) for any strictly positive coefficient function $a(x)$, independent of the quadrature exactness condition. The condition $p \\le 1$ ensures equivalence to the *continuous* Galerkin formulation, not the SPD property of the *discrete* system.\n\n**Symmetry and Positive Definiteness of $L_c$**:\nThe strong-form matrix is $L_c = -[DAD]_{II}$. In general, the full LGL differentiation matrix $D$ is not symmetric. The product $DAD$ is therefore not expected to be symmetric, nor is its submatrix $L_c$. A matrix must be symmetric to be classified as symmetric positive definite. Thus, we expect $L_c$ to be neither symmetric nor SPD in general. Non-symmetry is a known drawback of the strong-form collocation method when not constructed carefully. The failure of symmetry for non-constant $a(x)$ is a key distinction from the weak-form matrix $K$. Any under-resolution of $a(x)$, as in Case 4, will lead to a poor approximation of the operator, but the fundamental lack of symmetry is present even for well-resolved, non-constant $a(x)$.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import legendre\n\ndef get_lgl(N):\n    \"\"\"\n    Computes the Legendre-Gauss-Lobatto (LGL) nodes, weights, and \n    differentiation matrix for a given polynomial degree N.\n\n    Args:\n        N (int): The polynomial degree.\n\n    Returns:\n        tuple: A tuple containing:\n            - np.ndarray: The LGL nodes (x).\n            - np.ndarray: The LGL weights (w).\n            - np.ndarray: The LGL differentiation matrix (D).\n    \"\"\"\n    if N  1:\n        raise ValueError(\"N must be at least 1.\")\n    \n    # N+1 points, degree N polynomial\n    # Interior nodes are roots of P_N'(x)\n    PN = legendre(N)\n    PN_deriv = PN.deriv(1)\n    # The .roots method on a scipy orthopoly1d object finds the roots.\n    interior_nodes = np.sort(PN_deriv.roots)\n\n    x = np.concatenate(([-1.0], interior_nodes, [1.0]))\n    \n    # Weights formula: w_j = 2 / (N(N+1) [P_N(x_j)]^2)\n    PN_vals_at_nodes = PN(x)\n    w = 2.0 / (N * (N + 1) * PN_vals_at_nodes**2)\n    \n    # Differentiation matrix D formula\n    N_plus_1 = N + 1\n    D = np.zeros((N_plus_1, N_plus_1))\n\n    # Off-diagonal elements: D_ij = P_N(x_i) / (P_N(x_j) * (x_i - x_j)) for i != j\n    for i in range(N_plus_1):\n        for j in range(N_plus_1):\n            if i != j:\n                D[i, j] = PN_vals_at_nodes[i] / (PN_vals_at_nodes[j] * (x[i] - x[j]))\n    \n    # Diagonal elements\n    D[0, 0] = -N * (N + 1) / 4.0\n    D[N, N] = N * (N + 1) / 4.0\n    for i in range(1, N):\n        D[i, i] = x[i] / (1.0 - x[i]**2)\n        \n    return x, w, D\n\ndef analyze_matrices(N, a_func, p):\n    \"\"\"\n    Constructs and analyzes matrices K and Lc for a given test case.\n\n    Args:\n        N (int): The polynomial degree.\n        a_func (callable): The function a(x).\n        p (int or str): The polynomial degree of a(x) or a nonpolynomial marker.\n\n    Returns:\n        list: A list of five boolean values:\n              [is_K_symmetric, is_K_spd, is_Lc_symmetric, is_Lc_spd, \n               is_quad_exactness_satisfied]\n    \"\"\"\n    x, w, D = get_lgl(N)\n    \n    a_vals = a_func(x)\n    if not np.all(a_vals > 0):\n        # This check is for robustness; problem statement guarantees a(x)>0\n        raise ValueError(\"a(x) must be strictly positive on [-1, 1].\")\n\n    A = np.diag(a_vals)\n    W = np.diag(w)\n    \n    # Interior indices are 1, ..., N-1. In Python slicing, this is 1:N\n    interior_slice = slice(1, N)\n    \n    # K = D_AI' * W * A * D_AI\n    # D_AI is the block of D with all rows and interior columns.\n    D_AI = D[:, interior_slice]\n    K = D_AI.T @ W @ A @ D_AI\n    \n    # Lc = -[D*A*D]_II\n    # [DAD]_II is the interior-interior block of the matrix D*A*D.\n    DAD = D @ A @ D\n    Lc = -DAD[interior_slice, interior_slice]\n    \n    tol = 1e-12\n    \n    # 1. Check if K is symmetric\n    is_K_symmetric = np.allclose(K, K.T, atol=tol)\n    \n    # 2. Check if K is SPD\n    is_K_spd = False\n    if is_K_symmetric:\n        try:\n            eigvals = np.linalg.eigvalsh(K)\n            is_K_spd = np.all(eigvals > tol)\n        except np.linalg.LinAlgError:\n            is_K_spd = False\n            \n    # 3. Check if Lc is symmetric\n    is_Lc_symmetric = np.allclose(Lc, Lc.T, atol=tol)\n    \n    # 4. Check if Lc is SPD (requires symmetry)\n    is_Lc_spd = False\n    if is_Lc_symmetric:\n        try:\n            eigvals = np.linalg.eigvalsh(Lc)\n            is_Lc_spd = np.all(eigvals > tol)\n        except np.linalg.LinAlgError:\n            is_Lc_spd = False\n\n    # 5. Check if quadrature exactness condition (p = 1) is satisfied\n    is_quad_exactness_satisfied = (isinstance(p, int) and p = 1)\n            \n    return [is_K_symmetric, is_K_spd, is_Lc_symmetric, is_Lc_spd, is_quad_exactness_satisfied]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: N=8, a(x)=1.2 + x, p=1\n        (8, lambda x: 1.2 + x, 1),\n        # Case 2: N=8, a(x)=1 + x^2, p=2\n        (8, lambda x: 1.0 + x**2, 2),\n        # Case 3: N=12, a(x)=1 + 0.5cos(10x), p=nonpolynomial\n        (12, lambda x: 1.0 + 0.5 * np.cos(10 * x), \"nonpolynomial\"),\n        # Case 4: N=8, a(x)=1 + 0.9cos(20x), p=nonpolynomial\n        (8, lambda x: 1.0 + 0.9 * np.cos(20 * x), \"nonpolynomial\"),\n    ]\n\n    results = []\n    for N, a_func, p in test_cases:\n        case_results = analyze_matrices(N, a_func, p)\n        results.append(case_results)\n\n    # Format the output as specified\n    # Using str() on Python booleans gives 'True' and 'False' literals,\n    # which is what the problem asks for.\n    result_str = ','.join([str(res).replace(\" \",\"\") for res in results])\n    print(f\"[{result_str}]\")\n\n# The original problem asks to call a `solve()` function. This function will be defined\n# but not called in the final output, as the environment will call it.\n# To generate the answer, we call it locally.\n# solve()\n```", "answer": "```\n[[True,True,True,True,True],[True,True,False,False,False],[True,True,False,False,False],[True,True,False,False,False]]\n```", "id": "3416617"}, {"introduction": "The stability and symmetry of weak-form discretizations stem from a deep structural property known as summation-by-parts, a discrete analogue of the integration-by-parts formula. This exercise will have you derive this fundamental identity and use it to analyze the discrete Poisson operator with Neumann boundary conditions. Through this analysis, you will uncover the discrete solvability (compatibility) condition, mirroring the constraint required in the continuous setting and revealing the null space of the discrete operator.", "problem": "Consider the one-dimensional Poisson boundary value problem on the interval $\\left[-1,1\\right]$ with homogeneous Neumann boundary conditions:\n$$\nu_{xx}(x) = f(x), \\quad x \\in (-1,1), \\qquad u_{x}(-1)=0,\\quad u_{x}(1)=0.\n$$\nUse a Legendre–Gauss–Lobatto spectral collocation discretization with $N+1$ distinct nodes $\\{x_{j}\\}_{j=0}^{N}$, where $x_{0}=-1$, $x_{N}=1$, and the interior nodes are the zeros of $(1-x^{2})P_{N}'(x)$ with $P_{N}(x)$ the degree-$N$ Legendre polynomial. Let $\\{\\ell_{j}(x)\\}_{j=0}^{N}$ denote the Lagrange nodal basis such that $\\ell_{j}(x_{i})=\\delta_{ij}$, and define the spectral differentiation matrix $\\boldsymbol{D}\\in\\mathbb{R}^{(N+1)\\times(N+1)}$ by $D_{ij}=\\ell_{j}'(x_{i})$. Let $\\boldsymbol{W}=\\operatorname{diag}(w_{0},\\dots,w_{N})$ be the diagonal matrix of Legendre–Gauss–Lobatto quadrature weights\n$$\nw_{j}=\\frac{2}{N(N+1)}\\frac{1}{\\left[P_{N}(x_{j})\\right]^{2}},\\qquad j=0,\\dots,N.\n$$\nYou will construct the discrete boundary operator and analyze compatibility and null space for a collocation solve of the Poisson problem under homogeneous Neumann boundary conditions.\n\nTasks:\n1. Starting from the fundamental continuous Green’s identity on $\\left[-1,1\\right]$ and the definitions above, derive the discrete summation-by-parts identity and explicitly construct the discrete boundary operator $\\boldsymbol{B}\\in\\mathbb{R}^{(N+1)\\times(N+1)}$ satisfying\n$$\n\\boldsymbol{W}\\boldsymbol{D} + \\boldsymbol{D}^{\\top}\\boldsymbol{W} = \\boldsymbol{B}.\n$$\nIdentify all nonzero entries of $\\boldsymbol{B}$.\n\n2. Using the matrix $\\boldsymbol{A}=-\\boldsymbol{D}^{\\top}\\boldsymbol{W}\\boldsymbol{D}$ as the discrete Poisson operator corresponding to homogeneous Neumann boundary conditions (in which the Neumann conditions are natural and thus require no explicit boundary rows), analyze the null space of $\\boldsymbol{A}$ and determine its dimension.\n\n3. Using the range–nullspace orthogonality implied by the symmetry of $\\boldsymbol{A}$, derive a necessary and sufficient discrete compatibility condition on the collocated right-hand side $\\boldsymbol{f}=\\left(f(x_{0}),\\dots,f(x_{N})\\right)^{\\top}$ for the solvability of\n$$\n-\\boldsymbol{D}^{\\top}\\boldsymbol{W}\\boldsymbol{D}\\,\\boldsymbol{u}=\\boldsymbol{W}\\boldsymbol{f}.\n$$\nExpress the compatibility condition in the form $\\mathcal{C}(\\boldsymbol{f})=0$, where $\\mathcal{C}(\\boldsymbol{f})$ is a scalar functional of $\\boldsymbol{f}$. \n\nProvide, as your final answer, a single closed-form analytic expression for $\\mathcal{C}(\\boldsymbol{f})$ in terms of $N$, $\\{x_{j}\\}_{j=0}^{N}$, and $\\{f(x_{j})\\}_{j=0}^{N}$. Do not include an equality or units in your final answer. If your expression involves special functions, leave them in exact form.", "solution": "We begin from the continuous identities that underpin spectral collocation with Legendre–Gauss–Lobatto nodes. The fundamental base consists of: (i) the continuous Green’s identity (integration by parts) for sufficiently smooth functions $u$ and $v$ on $\\left[-1,1\\right]$,\n$$\n\\int_{-1}^{1} v(x)\\,u_{x}(x)\\,\\mathrm{d}x=\\left.v(x)u(x)\\right|_{x=-1}^{x=1}-\\int_{-1}^{1} v_{x}(x)\\,u(x)\\,\\mathrm{d}x,\n$$\nand (ii) the exactness of Legendre–Gauss–Lobatto quadrature for polynomials up to degree $2N-1$, together with the fact that for $u$ and $v$ represented in the Lagrange basis at Legendre–Gauss–Lobatto nodes, the discrete inner product with weights $\\{w_{j}\\}_{j=0}^{N}$ approximates the integral.\n\n1. Discrete summation-by-parts and the boundary operator. Let $u$ and $v$ be grid functions with nodal values $\\{u_{j}\\}_{j=0}^{N}$ and $\\{v_{j}\\}_{j=0}^{N}$, and define the polynomial interpolants\n$$\nu_{N}(x)=\\sum_{j=0}^{N}u_{j}\\,\\ell_{j}(x),\\qquad v_{N}(x)=\\sum_{j=0}^{N}v_{j}\\,\\ell_{j}(x).\n$$\nBy definition of $\\boldsymbol{D}$, we have $u_{N}'(x_{i})=\\sum_{j=0}^{N}D_{ij}u_{j}$ and $v_{N}'(x_{i})=\\sum_{j=0}^{N}D_{ij}v_{j}$. Applying the continuous Green’s identity to $u_{N}$ and $v_{N}$ yields\n$$\n\\int_{-1}^{1} v_{N}(x)u_{N}'(x)\\,\\mathrm{d}x=\\left.v_{N}(x)u_{N}(x)\\right|_{x=-1}^{x=1}-\\int_{-1}^{1} v_{N}'(x)u_{N}(x)\\,\\mathrm{d}x.\n$$\nSince $u_{N}$ and $v_{N}$ are polynomials of degrees at most $N$, their product with a derivative has degree at most $2N-1$, so the Legendre–Gauss–Lobatto quadrature is exact:\n$$\n\\sum_{i=0}^{N} w_{i} v_{i} \\left(\\sum_{j=0}^{N} D_{ij} u_{j}\\right)\n= v_{N}(1)u_{N}(1)-v_{N}(-1)u_{N}(-1) - \\sum_{i=0}^{N} w_{i} \\left(\\sum_{j=0}^{N} D_{ij} v_{j}\\right) u_{i}.\n$$\nIn matrix form, with $\\boldsymbol{u}=(u_{0},\\dots,u_{N})^{\\top}$ and $\\boldsymbol{v}=(v_{0},\\dots,v_{N})^{\\top}$, this becomes\n$$\n\\boldsymbol{v}^{\\top}\\boldsymbol{W}\\boldsymbol{D}\\,\\boldsymbol{u} = v_{N}(1)u_{N}(1)-v_{N}(-1)u_{N}(-1) - \\boldsymbol{v}^{\\top}\\boldsymbol{D}^{\\top}\\boldsymbol{W}\\,\\boldsymbol{u}.\n$$\nBecause $u_{N}(x_{0})=u_{0}$ with $x_{0}=-1$, and $u_{N}(x_{N})=u_{N}$ with $x_{N}=1$, we identify the boundary bilinear form as\n$$\nv_{N}(1)u_{N}(1)-v_{N}(-1)u_{N}(-1) = \\boldsymbol{v}^{\\top}\\boldsymbol{B}\\,\\boldsymbol{u},\\qquad \\boldsymbol{B}=\\operatorname{diag}(-1,0,\\dots,0,1).\n$$\nHence, for all grid vectors $\\boldsymbol{u},\\boldsymbol{v}$,\n$$\n\\boldsymbol{v}^{\\top}\\left(\\boldsymbol{W}\\boldsymbol{D}+\\boldsymbol{D}^{\\top}\\boldsymbol{W}\\right)\\boldsymbol{u}=\\boldsymbol{v}^{\\top}\\boldsymbol{B}\\,\\boldsymbol{u},\n$$\nwhich implies the discrete summation-by-parts identity\n$$\n\\boldsymbol{W}\\boldsymbol{D}+\\boldsymbol{D}^{\\top}\\boldsymbol{W}=\\boldsymbol{B},\n$$\nwith nonzero entries $B_{00}=-1$ and $B_{NN}=1$ and all other entries zero.\n\n2. Discrete Poisson operator, Neumann boundary conditions, and null space. Consider the symmetric positive semidefinite operator\n$$\n\\boldsymbol{A}=-\\boldsymbol{D}^{\\top}\\boldsymbol{W}\\boldsymbol{D}.\n$$\nThe discrete weak formulation of the Poisson problem with homogeneous Neumann boundary conditions is\n$$\n-\\boldsymbol{D}^{\\top}\\boldsymbol{W}\\boldsymbol{D}\\,\\boldsymbol{u}=\\boldsymbol{W}\\boldsymbol{f}.\n$$\nNo separate enforcement of $u_{x}(\\pm 1)=0$ is required because the Neumann boundary conditions are natural in the weak form; the boundary bilinear form cancels when the Neumann data are zero. The null space of $\\boldsymbol{A}$ is characterized by $\\boldsymbol{A}\\boldsymbol{u}=\\boldsymbol{0} \\iff \\boldsymbol{D}\\,\\boldsymbol{u}=\\boldsymbol{0}$ (because $\\boldsymbol{W}$ is positive definite), which holds if and only if $\\boldsymbol{u}$ represents a constant polynomial. Therefore,\n$$\n\\operatorname{null}\\left(\\boldsymbol{A}\\right)=\\operatorname{span}\\{\\boldsymbol{1}\\},\\qquad \\dim\\operatorname{null}\\left(\\boldsymbol{A}\\right)=1,\n$$\nwhere $\\boldsymbol{1}=(1,\\dots,1)^{\\top}$.\n\n3. Compatibility condition and left null space. For the linear system\n$$\n\\boldsymbol{A}\\boldsymbol{u}=\\boldsymbol{W}\\boldsymbol{f},\n$$\na solution exists if and only if the right-hand side lies in the range of $\\boldsymbol{A}$. Because $\\boldsymbol{A}$ is symmetric, the range of $\\boldsymbol{A}$ is the orthogonal complement (with respect to the standard Euclidean inner product) of $\\operatorname{null}(\\boldsymbol{A})$. Equivalently, solvability requires that $\\boldsymbol{W}\\boldsymbol{f}$ be orthogonal to every vector in the null space of $\\boldsymbol{A}^{\\top}=\\boldsymbol{A}$. Since $\\operatorname{null}(\\boldsymbol{A})=\\operatorname{span}\\{\\boldsymbol{1}\\}$, the necessary and sufficient compatibility condition is\n$$\n\\boldsymbol{1}^{\\top}\\boldsymbol{W}\\,\\boldsymbol{f}=0.\n$$\nWriting this scalar functional as $\\mathcal{C}(\\boldsymbol{f})$, we obtain\n$$\n\\mathcal{C}(\\boldsymbol{f})=\\sum_{j=0}^{N} w_{j}\\,f(x_{j}).\n$$\nUsing the explicit Legendre–Gauss–Lobatto weights,\n$$\nw_{j}=\\frac{2}{N(N+1)}\\frac{1}{\\left[P_{N}(x_{j})\\right]^{2}},\n$$\nthe compatibility functional can be written in the closed form\n$$\n\\mathcal{C}(\\boldsymbol{f})=\\frac{2}{N(N+1)}\\sum_{j=0}^{N}\\frac{f(x_{j})}{\\left[P_{N}(x_{j})\\right]^{2}}.\n$$\nThis expression must vanish for the discrete Poisson system with homogeneous Neumann boundary conditions to be solvable, and the discrete solution is determined only up to an additive constant because the null space has dimension one.", "answer": "$$\\boxed{\\frac{2}{N(N+1)}\\sum_{j=0}^{N}\\frac{f(x_{j})}{\\left[P_{N}(x_{j})\\right]^{2}}}$$", "id": "3416566"}]}