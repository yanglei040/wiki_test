{"hands_on_practices": [{"introduction": "The accuracy of a Discontinuous Galerkin (DG) method relies on the precise evaluation of integrals over element interiors and faces. Unlike continuous Galerkin methods where integrands are often smoother, the use of discontinuous basis functions and penalty terms in DG formulations leads to integrands of higher polynomial degree on the mesh skeleton. This exercise [@problem_id:3377370] guides you through a fundamental analysis to determine the minimal quadrature accuracy required to integrate the face terms of the Symmetric Interior Penalty Galerkin (SIPG) method exactly, a crucial step to prevent numerical errors known as aliasing.", "problem": "Consider a polygonal or polyhedral domain $\\Omega \\subset \\mathbb{R}^{d}$, $d \\ge 1$, equipped with a conforming, shape-regular mesh $\\mathcal{T}_{h}$ of affine elements. Let $\\mathcal{F}_{h}$ denote the set of $(d-1)$-dimensional faces. Assume an isotropic constant diffusion coefficient $\\alpha > 0$. Let $V_{h}$ be the discontinuous Galerkin finite element space of piecewise polynomials of total degree at most $p \\in \\mathbb{N}$ on $\\mathcal{T}_{h}$.\n\nOn each interior face $F \\in \\mathcal{F}_{h}$ shared by elements $K^{+}$ and $K^{-}$ with unit normal $\\boldsymbol{n}$ (taken fixed on $F$ and pointing from $K^{+}$ to $K^{-}$), the Symmetric Interior Penalty (SIP) discontinuous Galerkin method for a second-order elliptic problem involves the following face integrals: the penalty term $\\int_{F} \\sigma\\,[u_{h}]\\,[v_{h}] \\,\\mathrm{d}s$ and the consistency terms $-\\int_{F} \\{\\alpha \\nabla u_{h}\\}\\cdot \\boldsymbol{n}\\,[v_{h}]\\,\\mathrm{d}s - \\int_{F} \\{\\alpha \\nabla v_{h}\\}\\cdot \\boldsymbol{n}\\,[u_{h}]\\,\\mathrm{d}s$, where $u_{h}, v_{h} \\in V_{h}$ are test and trial functions, $[\\,\\cdot\\,]$ denotes the jump across $F$, $\\{\\,\\cdot\\,\\}$ denotes the average across $F$, and $\\sigma > 0$ is a constant per-face penalty parameter (possibly depending on $p$ and the local mesh size but independent of the face coordinates). On boundary faces, the analogous terms reduce correspondingly, but you may ignore boundary-specific modifications and focus on the worst-case polynomial degrees arising on interior faces.\n\nAssume that each face integral is evaluated by a quadrature rule on $F$ that is exact for all scalar polynomials on $F$ of total degree at most $q$. The mesh is affine so that element and face Jacobians and face normals are constant on each $F$, and thus do not increase polynomial degrees of the integrands.\n\nUsing only fundamental definitions of polynomial degree, product degree, traces, jumps, and averages on faces, determine the minimal total-degree exactness $q$ required on faces to guarantee that, for any $u_{h}, v_{h} \\in V_{h}$, both the penalty term and the consistency terms are integrated exactly on every face $F \\in \\mathcal{F}_{h}$, thereby eliminating quadrature aliasing in these face contributions. Justify your choice by identifying the maximal polynomial degree of each integrand on $F$.\n\nExpress your final answer as an exact symbolic expression in terms of $p$.", "solution": "The problem requires the determination of the minimal total-degree exactness $q$ for a quadrature rule on a face $F$ of the mesh $\\mathcal{T}_h$, such that the face integrals of the Symmetric Interior Penalty (SIP) discontinuous Galerkin (DG) method are computed exactly. The problem is set in a domain $\\Omega \\subset \\mathbb{R}^{d}$ for $d \\ge 1$ with a constant diffusion coefficient $\\alpha > 0$. The DG finite element space $V_h$ consists of piecewise polynomials of total degree at most $p \\in \\mathbb{N}$.\n\nLet $u_h, v_h \\in V_h$ be arbitrary functions from the DG space. We must analyze the polynomial degree of the integrands for both the penalty and consistency terms on an interior face $F \\in \\mathcal{F}_h$. Let $F$ be the interface between two elements $K^+$ and $K^-$. Let $\\mathcal{P}_k(S)$ denote the space of polynomials of total degree at most $k$ on a domain $S$.\n\nBy definition of the space $V_h$, the restrictions $u_h|_{K^+}$ and $u_h|_{K^-}$ are polynomials of total degree at most $p$. The mesh $\\mathcal{T}_h$ is composed of affine elements, which means the mapping from a reference element to any element $K \\in \\mathcal{T}_h$ is affine. A key consequence is that the trace of a polynomial of total degree $p$ on an element $K$ onto one of its flat $(d-1)$-dimensional faces $F$ is a polynomial of total degree at most $p$ on $F$. Therefore, the traces of $u_h$ on $F$ from the adjacent elements, denoted as $u_h^+ = u_h|_{K^+}|_F$ and $u_h^- = u_h|_{K^-}|_F$, are both elements of $\\mathcal{P}_p(F)$.\n\nFirst, let us analyze the penalty term: $\\int_{F} \\sigma\\,[u_{h}]\\,[v_{h}] \\,\\mathrm{d}s$.\nThe integrand is $\\sigma\\,[u_{h}]\\,[v_{h}]$. The scalar penalty parameter $\\sigma$ is given as constant on the face $F$. The jump of a scalar function $w_h$ across $F$ is defined as $[w_h] = w_h^+ - w_h^-$.\nSince $u_h^+, u_h^- \\in \\mathcal{P}_p(F)$, their difference $[u_h] = u_h^+ - u_h^-$ is also a polynomial in $\\mathcal{P}_p(F)$. Similarly, for $v_h \\in V_h$, the jump $[v_h]$ belongs to $\\mathcal{P}_p(F)$.\nThe integrand of the penalty term is the product of $[u_h] \\in \\mathcal{P}_p(F)$ and $[v_h] \\in \\mathcal{P}_p(F)$. The product of two polynomials of total degree at most $p$ is a polynomial of total degree at most $p+p=2p$. Therefore, the integrand $\\sigma\\,[u_{h}]\\,[v_{h}]$ is a polynomial on $F$ of total degree at most $2p$. This maximum degree is attainable, for instance, by choosing $u_h$ and $v_h$ whose traces on $F$ are non-zero polynomials of degree $p$.\n\nNext, we analyze the consistency terms: $-\\int_{F} \\{\\alpha \\nabla u_{h}\\}\\cdot \\boldsymbol{n}\\,[v_{h}]\\,\\mathrm{d}s - \\int_{F} \\{\\alpha \\nabla v_{h}\\}\\cdot \\boldsymbol{n}\\,[u_{h}]\\,\\mathrm{d}s$.\nDue to symmetry, it suffices to analyze the integrand of one of these terms, for example, $\\{\\alpha \\nabla u_{h}\\}\\cdot \\boldsymbol{n}\\,[v_{h}]$.\nAs established, $[v_h]$ is a polynomial in $\\mathcal{P}_p(F)$.\nNow we examine the term $\\{\\alpha \\nabla u_{h}\\}\\cdot \\boldsymbol{n}$. The function $u_h$ on an element $K$ is a polynomial in $\\mathcal{P}_p(K)$. Its gradient, $\\nabla u_h|_K$, is a vector whose components are polynomials of total degree at most $p-1$.\nThe trace of this gradient vector on the face $F$, e.g., $(\\nabla u_h)^+ = (\\nabla u_h)|_{K^+}|_F$, is a vector whose components are polynomials in $\\mathcal{P}_{p-1}(F)$.\nThe average of the vector field $\\alpha \\nabla u_h$ is defined as $\\{\\alpha \\nabla u_h\\} = \\frac{1}{2}(\\alpha (\\nabla u_h)^+ + \\alpha (\\nabla u_h)^-)$. Since $\\alpha$ is a constant, each component of the vector $\\{\\alpha \\nabla u_h\\}$ is a polynomial in $\\mathcal{P}_{p-1}(F)$.\nThe problem states that the mesh is affine, which implies that the unit normal vector $\\boldsymbol{n}$ is constant on each face $F$. The dot product $\\{\\alpha \\nabla u_h\\} \\cdot \\boldsymbol{n}$ is a linear combination of the components of $\\{\\alpha \\nabla u_h\\}$ with the constant components of $\\boldsymbol{n}$ as coefficients. This operation results in a scalar polynomial on $F$ of total degree at most $p-1$.\nThe full integrand for the first consistency term is the product of $\\{\\alpha \\nabla u_{h}\\}\\cdot \\boldsymbol{n} \\in \\mathcal{P}_{p-1}(F)$ and $[v_{h}] \\in \\mathcal{P}_p(F)$. The product of a polynomial of degree at most $p-1$ and a polynomial of degree at most $p$ is a polynomial of degree at most $(p-1)+p = 2p-1$.\nThus, the integrands of both consistency terms are polynomials on $F$ of total degree at most $2p-1$.\n\nTo ensure that the numerical integration is exact, the quadrature rule must be exact for all polynomials up to the highest degree encountered in any of the integrands.\nThe penalty term integrand has a maximal degree of $2p$.\nThe consistency terms' integrands have a maximal degree of $2p-1$.\nThe maximum of these two degrees is $\\max(2p, 2p-1) = 2p$.\nTherefore, to guarantee exact integration of all face contributions for any choice of $u_h, v_h \\in V_h$, the quadrature rule on $F$ must be exact for all scalar polynomials of total degree at most $2p$.\nThe minimal required total-degree exactness is thus $q = 2p$.", "answer": "$$\n\\boxed{2p}\n$$", "id": "3377370"}, {"introduction": "A significant advantage of DG methods is their ability to robustly handle problems with discontinuous material properties, such as in composite materials or multi-physics simulations. This is achieved by designing numerical fluxes at element interfaces that correctly account for jumps in coefficients. This practice problem [@problem_id:3377389] provides a concrete example of calculating such a flux for an elliptic problem with a piecewise anisotropic diffusion tensor, illustrating how DG ensures local conservation and physical consistency across material interfaces.", "problem": "Consider the second-order elliptic model problem $-\\nabla \\cdot (\\boldsymbol{\\kappa} \\nabla u) = f$ on a domain partitioned into two rectangles $K^{-} = (-1,0) \\times (0,1)$ and $K^{+} = (0,1) \\times (0,1)$ with the common interface $e = \\{0\\} \\times (0,1)$. The coefficient tensor is piecewise constant and anisotropic, with $\\boldsymbol{\\kappa}^{-} = \\begin{pmatrix} 3 & 1 \\\\[4pt] 1 & 2 \\end{pmatrix}$ on $K^{-}$ and $\\boldsymbol{\\kappa}^{+} = \\begin{pmatrix} 2 & 0 \\\\[4pt] 0 & 5 \\end{pmatrix}$ on $K^{+}$. Let the outward unit normal of $K^{-}$ on $e$ be $\\boldsymbol{n}_{e} = (1,0)^{\\top}$, so the outward unit normal of $K^{+}$ on $e$ is $-\\boldsymbol{n}_{e}$.\n\nA piecewise affine Discontinuous Galerkin (DG) approximation $u_{h}$ is given by $u_{h}^{-}(x,y) = 1 + 2x + y$ on $K^{-}$ and $u_{h}^{+}(x,y) = -1 - x + y$ on $K^{+}$. Assume the Symmetric Interior Penalty Galerkin (SIPG) interface numerical normal flux from $K^{-}$ to $K^{+}$ across $e$ is taken in a $\\boldsymbol{\\kappa}$-weighted form that enforces correct handling of discontinuous coefficients and local conservation. Specifically, define the normal diffusivities $\\kappa_{n}^{\\pm} = \\boldsymbol{n}_{e}^{\\top} \\boldsymbol{\\kappa}^{\\pm} \\boldsymbol{n}_{e}$, the $\\boldsymbol{\\kappa}$-weighted averaging coefficients $\\omega^{-} = \\dfrac{\\kappa_{n}^{+}}{\\kappa_{n}^{-} + \\kappa_{n}^{+}}$ and $\\omega^{+} = \\dfrac{\\kappa_{n}^{-}}{\\kappa_{n}^{-} + \\kappa_{n}^{+}}$, and the harmonic penalty scaling $\\tau_{e} = \\dfrac{2 \\kappa_{n}^{-} \\kappa_{n}^{+}}{\\kappa_{n}^{-} + \\kappa_{n}^{+}}$ (assume face size $h_{e} = 1$ and stabilization factor $\\alpha = 1$). Then the numerical normal flux through $e$ oriented from $K^{-}$ to $K^{+}$ is\n$$\n\\phi_{e}(u_{h}) \\;=\\; -\\left( \\omega^{-} \\,\\boldsymbol{\\kappa}^{-} \\nabla u_{h}^{-} + \\omega^{+} \\,\\boldsymbol{\\kappa}^{+} \\nabla u_{h}^{+} \\right) \\cdot \\boldsymbol{n}_{e} \\;+\\; \\tau_{e}\\,\\big(u_{h}^{-}|_{e} - u_{h}^{+}|_{e}\\big).\n$$\nHere $u_{h}^{\\pm}|_{e}$ are the traces of $u_{h}^{\\pm}$ on $e$.\n\nCompute the exact value of $\\phi_{e}(u_{h})$. Your final answer must be a single exact value (no rounding).", "solution": "The problem is valid as it is scientifically grounded in the theory of Discontinuous Galerkin methods, well-posed, and all necessary data and definitions are provided in an objective and non-contradictory manner. We proceed to compute the value of the numerical normal flux, $\\phi_{e}(u_{h})$.\n\nThe numerical flux through the interface $e$ from element $K^{-}$ to $K^{+}$ is given by the formula:\n$$\n\\phi_{e}(u_{h}) \\;=\\; -\\left( \\omega^{-} \\,\\boldsymbol{\\kappa}^{-} \\nabla u_{h}^{-} + \\omega^{+} \\,\\boldsymbol{\\kappa}^{+} \\nabla u_{h}^{+} \\right) \\cdot \\boldsymbol{n}_{e} \\;+\\; \\tau_{e}\\,\\big(u_{h}^{-}|_{e} - u_{h}^{+}|_{e}\\big)\n$$\nWe will compute each component of this formula step by step.\n\n$1$. **Gradients of the piecewise affine approximation $u_{h}$**:\nThe DG approximation $u_h$ is given by $u_{h}^{-}(x,y) = 1 + 2x + y$ on $K^{-}$ and $u_{h}^{+}(x,y) = -1 - x + y$ on $K^{+}$. The gradients are constant vectors within each element:\n$$\n\\nabla u_{h}^{-} = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(1 + 2x + y) \\\\ \\frac{\\partial}{\\partial y}(1 + 2x + y) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\nabla u_{h}^{+} = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(-1 - x + y) \\\\ \\frac{\\partial}{\\partial y}(-1 - x + y) \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\n\n$2$. **Traces and jump of $u_{h}$ on the interface $e$**:\nThe interface $e$ is the line segment defined by $\\{ (x,y) \\mid x=0, y \\in (0,1) \\}$. We evaluate the traces of $u_h^{-}$ and $u_h^{+}$ on $e$ by setting $x=0$:\n$$\nu_{h}^{-}|_{e} = u_{h}^{-}(0,y) = 1 + 2(0) + y = 1 + y\n$$\n$$\nu_{h}^{+}|_{e} = u_{h}^{+}(0,y) = -1 - (0) + y = -1 + y\n$$\nThe jump in $u_{h}$ across $e$ is the difference between the trace from $K^{-}$ and the trace from $K^{+}$:\n$$\nu_{h}^{-}|_{e} - u_{h}^{+}|_{e} = (1+y) - (-1+y) = 1 + y + 1 - y = 2\n$$\nThe jump is a constant value of $2$ along the interface $e$.\n\n$3$. **Normal diffusivities $\\kappa_{n}^{\\pm}$**:\nThe outward unit normal for $K^{-}$ on $e$ is $\\boldsymbol{n}_{e} = (1,0)^{\\top}$. The coefficient tensors are $\\boldsymbol{\\kappa}^{-} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}$ and $\\boldsymbol{\\kappa}^{+} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 5 \\end{pmatrix}$.\nThe normal diffusivities are calculated as $\\kappa_{n}^{\\pm} = \\boldsymbol{n}_{e}^{\\top} \\boldsymbol{\\kappa}^{\\pm} \\boldsymbol{n}_{e}$:\n$$\n\\kappa_{n}^{-} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix} = 3\n$$\n$$\n\\kappa_{n}^{+} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} = 2\n$$\n\n$4$. **Averaging coefficients $\\omega^{\\pm}$**:\nThe $\\boldsymbol{\\kappa}$-weighted averaging coefficients are defined as $\\omega^{-} = \\frac{\\kappa_{n}^{+}}{\\kappa_{n}^{-} + \\kappa_{n}^{+}}$ and $\\omega^{+} = \\frac{\\kappa_{n}^{-}}{\\kappa_{n}^{-} + \\kappa_{n}^{+}}$.\n$$\n\\kappa_{n}^{-} + \\kappa_{n}^{+} = 3 + 2 = 5\n$$\n$$\n\\omega^{-} = \\frac{2}{5}\n$$\n$$\n\\omega^{+} = \\frac{3}{5}\n$$\n\n$5$. **Penalty scaling $\\tau_{e}$**:\nThe harmonic penalty scaling is given by $\\tau_{e} = \\frac{2 \\kappa_{n}^{-} \\kappa_{n}^{+}}{\\kappa_{n}^{-} + \\kappa_{n}^{+}}$.\n$$\n\\tau_{e} = \\frac{2 \\cdot 3 \\cdot 2}{3+2} = \\frac{12}{5}\n$$\n\n$6$. **Calculation of the numerical flux $\\phi_{e}(u_{h})$**:\nNow we substitute all the computed quantities into the formula for $\\phi_{e}(u_{h})$. We can compute the two main terms separately.\n\nFirst, the weighted average flux term:\n$$\n-\\left( \\omega^{-} \\,\\boldsymbol{\\kappa}^{-} \\nabla u_{h}^{-} + \\omega^{+} \\,\\boldsymbol{\\kappa}^{+} \\nabla u_{h}^{+} \\right) \\cdot \\boldsymbol{n}_{e}\n$$\nLet's compute the vector inside the parentheses:\n$$\n\\omega^{-} \\,\\boldsymbol{\\kappa}^{-} \\nabla u_{h}^{-} + \\omega^{+} \\,\\boldsymbol{\\kappa}^{+} \\nabla u_{h}^{+} = \\frac{2}{5} \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} + \\frac{3}{5} \\begin{pmatrix} 2 & 0 \\\\ 0 & 5 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n= \\frac{2}{5} \\begin{pmatrix} 3(2) + 1(1) \\\\ 1(2) + 2(1) \\end{pmatrix} + \\frac{3}{5} \\begin{pmatrix} 2(-1) + 0(1) \\\\ 0(-1) + 5(1) \\end{pmatrix} = \\frac{2}{5} \\begin{pmatrix} 7 \\\\ 4 \\end{pmatrix} + \\frac{3}{5} \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 14/5 \\\\ 8/5 \\end{pmatrix} + \\begin{pmatrix} -6/5 \\\\ 15/5 \\end{pmatrix} = \\begin{pmatrix} (14-6)/5 \\\\ (8+15)/5 \\end{pmatrix} = \\begin{pmatrix} 8/5 \\\\ 23/5 \\end{pmatrix}\n$$\nTaking the dot product with $\\boldsymbol{n}_{e} = (1,0)^{\\top}$ and negating:\n$$\n-\\begin{pmatrix} 8/5 \\\\ 23/5 \\end{pmatrix} \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -\\frac{8}{5}\n$$\n\nSecond, the penalty term:\n$$\n\\tau_{e}\\,\\big(u_{h}^{-}|_{e} - u_{h}^{+}|_{e}\\big) = \\frac{12}{5} \\cdot 2 = \\frac{24}{5}\n$$\n\nFinally, we sum the two terms to obtain the total numerical flux:\n$$\n\\phi_{e}(u_{h}) = -\\frac{8}{5} + \\frac{24}{5} = \\frac{16}{5}\n$$\nThe value of the numerical flux is constant along the interface $e$.", "answer": "$$\\boxed{\\frac{16}{5}}$$", "id": "3377389"}, {"introduction": "Moving beyond local mechanics, the true power of high-order DG methods is realized through $hp$-adaptivity, where the mesh size ($h$) and polynomial degree ($p$) are tailored to the local behavior of the solution. For problems with singularities, this means using fine $h$-refinement near the singularity and high $p$-enrichment in regions where the solution is smooth. This exercise [@problem_id:3377380] presents a simplified, yet powerful, optimization model that allows you to explore the trade-offs of this strategy, finding the optimal allocation of degrees of freedom to minimize error under a fixed computational budget.", "problem": "Consider the second-order elliptic model problem on a polygonal domain with one corner at the origin where the exact solution exhibits a corner singularity. The model solution near the corner satisfies the standard singular form $u(r,\\theta) \\sim r^{\\alpha}\\sin(\\alpha \\theta)$ with parameter $\\alpha \\in (0,1)$ for polar coordinates $(r,\\theta)$ centered at the corner. Let the discretization be performed by the Discontinuous Galerkin (DG) method, specifically using a symmetric interior penalty formulation, and consider the DG energy norm, which is equivalent to the broken $H^{1}$-seminorm plus interior penalty terms. Your task is to design an algorithmic $hp$-adaptivity strategy that decides, under a fixed degree-of-freedom (DOF) budget, how to allocate $h$-refinement near the singular corner and $p$-enrichment away from the corner to minimize a rigorous surrogate upper bound of the DG energy error.\n\nBase your derivation on the following well-tested approximation facts for second-order elliptic problems discretized by high-order DG methods:\n\n- For analytic functions on a fixed shape-regular mesh, the best DG energy-norm approximation error decays exponentially in the polynomial degree $p$, i.e., there exist constants $C_{a} \\gt 0$ and $b_{a} \\gt 0$ such that the DG energy error admits a bound of the form $C_{a}\\,\\mathrm{e}^{-b_{a} p}$.\n- Near a corner where $u(r,\\theta)\\sim r^{\\alpha}\\sin(\\alpha\\theta)$ with $\\alpha\\in(0,1)$, the best DG energy-norm approximation error on a radially graded geometric mesh with $N_{r}$ concentric layers and grading ratio $q\\in(0,1)$ with fixed polynomial degree $p_{s}$ in the singular layers can be bounded by $C_{s}\\,q^{\\alpha N_{r}}\\,(p_{s}+1)^{-\\alpha}$, where $C_{s}\\gt 0$ is a constant that absorbs material parameters and domain-shape effects.\n\nAdopt the following simplified mesh and DOF accounting model:\n\n- The corner patch is composed of $N_{r}$ concentric radial layers, each subdivided into $M$ angular elements. All elements in the corner patch use a tensor-product polynomial basis of degree $p_{s}$, contributing $(p_{s}+1)^{2}$ DG DOFs per element. Hence, the corner DOF count is $M\\,N_{r}\\,(p_{s}+1)^{2}$.\n- The analytic outer region is modeled by $E_{\\text{out}}$ shape-regular elements with polynomial degree $p_{a}$, with $(p_{a}+1)^{2}$ DOFs per element, so the outer-region DOF count is $E_{\\text{out}}\\,(p_{a}+1)^{2}$.\n- The total DOF budget is $B$, and any admissible configuration must satisfy $M\\,N_{r}\\,(p_{s}+1)^{2} + E_{\\text{out}}\\,(p_{a}+1)^{2} \\le B$.\n\nUse the following surrogate upper bound for the DG energy error that combines the singular and analytic-region contributions additively:\n$$\n\\mathcal{E}_{\\text{DG}}(N_{r},q,p_{s},p_{a};\\alpha,C_{s},C_{a},b_{a})\n\\;=\\;\nC_{s}\\,q^{\\alpha N_{r}}\\,(p_{s}+1)^{-\\alpha}\n\\;+\\;\nC_{a}\\,\\mathrm{e}^{-b_{a}p_{a}}.\n$$\n\nYour program must, for each test case below, search over integer parameters $N_{r}\\in\\{1,\\dots,N_{r,\\max}\\}$, $p_{s}\\in\\{1,\\dots,p_{s,\\max}\\}$, $p_{a}\\in\\{1,\\dots,p_{a,\\max}\\}$, and discrete grading ratios $q\\in\\mathcal{Q}$, to find the admissible tuple that minimizes $\\mathcal{E}_{\\text{DG}}$ subject to the DOF budget. Break ties by preferring the configuration with the smaller DOF count, and if still tied, the smaller $p_{a}$, then the smaller $p_{s}$, then the smaller $N_{r}$, and finally the larger $q$.\n\nAdopt the following fixed mesh-structure parameters for all test cases:\n- $M = 8$,\n- $E_{\\text{out}} = 8$,\n- $N_{r,\\max} = 20$,\n- $p_{s,\\max} = 12$,\n- $p_{a,\\max} = 20$,\n- $\\mathcal{Q} = \\{0.15,\\,0.25,\\,0.35,\\,0.50\\}$.\n\nTest suite. For each line below, the tuple lists $(\\alpha,B,C_{s},C_{a},b_{a})$:\n- Case $1$: $(0.30,\\,600,\\,1.00,\\,0.10,\\,0.60)$,\n- Case $2$: $(0.70,\\,1200,\\,1.00,\\,0.10,\\,0.60)$,\n- Case $3$: $(0.95,\\,3000,\\,1.00,\\,0.05,\\,0.80)$,\n- Case $4$: $(0.20,\\,200,\\,1.00,\\,0.20,\\,0.50)$,\n- Case $5$: $(0.50,\\,5000,\\,0.80,\\,0.10,\\,0.70)$.\n\nYour program must compute, for each test case, a best configuration $(p_{a}^{\\star},p_{s}^{\\star},N_{r}^{\\star},q^{\\star})$, its predicted surrogate error $\\mathcal{E}_{\\text{DG}}^{\\star}$, and the DOF count used. The final output must be a single line containing a list of results, one per case, where each result is itself a list\n$$\n\\big[p_{a}^{\\star},\\,p_{s}^{\\star},\\,N_{r}^{\\star},\\,q^{\\star},\\,\\mathcal{E}_{\\text{DG}}^{\\star},\\,\\text{DOF}^{\\star}\\big].\n$$\nAll entries are real numbers or integers, as appropriate.\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets (for example, $\"[[1,2,3,0.25,0.1234,64],[\\dots]]\"$). No other text may be printed.", "solution": "The problem has been assessed and validated as a scientifically sound, well-posed, and complete discrete optimization problem.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- **Model Problem**: A second-order elliptic partial differential equation on a polygonal domain featuring a corner singularity. The solution near the origin is described in polar coordinates $(r,\\theta)$ by the asymptotic form $u(r,\\theta) \\sim r^{\\alpha}\\sin(\\alpha \\theta)$ for a singularity parameter $\\alpha \\in (0,1)$.\n- **Numerical Method**: A symmetric interior penalty Discontinuous Galerkin (DG) method.\n- **Error Metric**: The DG energy norm.\n- **Task**: To develop an algorithmic $hp$-adaptivity strategy that minimizes a surrogate for the DG energy error under a fixed degree-of-freedom (DOF) budget.\n- **Approximation Error Models**:\n    - For analytic regions with polynomial degree $p_{a}$: The error is bounded by $C_{a}\\,\\mathrm{e}^{-b_{a} p_{a}}$.\n    - For the singular corner region discretized with a radially graded geometric mesh of $N_{r}$ layers, grading ratio $q \\in (0,1)$, and fixed polynomial degree $p_{s}$: The error is bounded by $C_{s}\\,q^{\\alpha N_{r}}\\,(p_{s}+1)^{-\\alpha}$.\n- **Degrees of Freedom (DOF) Model**:\n    - The corner region consists of $M\\,N_{r}$ elements, each with $(p_{s}+1)^{2}$ DOFs, totaling $\\text{DOF}_{\\text{corner}} = M\\,N_{r}\\,(p_{s}+1)^{2}$.\n    - The outer analytic region consists of $E_{\\text{out}}$ elements, each with $(p_{a}+1)^{2}$ DOFs, totaling $\\text{DOF}_{\\text{out}} = E_{\\text{out}}\\,(p_{a}+1)^{2}$.\n    - The total DOF budget is $B$, leading to the constraint: $M\\,N_{r}\\,(p_{s}+1)^{2} + E_{\\text{out}}\\,(p_{a}+1)^{2} \\le B$.\n- **Surrogate Error Functional**: The total error is modeled as the sum of the regional contributions:\n$$\n\\mathcal{E}_{\\text{DG}}(N_{r},q,p_{s},p_{a};\\alpha,C_{s},C_{a},b_{a}) \\;=\\; C_{s}\\,q^{\\alpha N_{r}}\\,(p_{s}+1)^{-\\alpha} \\;+\\; C_{a}\\,\\mathrm{e}^{-b_{a}p_{a}}\n$$\n- **Search Space for Optimization Parameters**:\n    - Number of radial layers: $N_{r} \\in \\{1, 2, \\dots, N_{r,\\max}\\}$.\n    - Singular region polynomial degree: $p_{s} \\in \\{1, 2, \\dots, p_{s,\\max}\\}$.\n    - Analytic region polynomial degree: $p_{a} \\in \\{1, 2, \\dots, p_{a,\\max}\\}$.\n    - Grading ratio: $q \\in \\mathcal{Q}$.\n- **Tie-Breaking Rule**: In case of multiple configurations yielding the same minimum error, the preference is given in the following order: smaller DOF count, smaller $p_{a}$, smaller $p_{s}$, smaller $N_{r}$, and finally larger $q$.\n- **Fixed Parameters**:\n    - Angular subdivisions in corner patch: $M = 8$.\n    - Number of elements in the outer region: $E_{\\text{out}} = 8$.\n    - Maximum radial layers: $N_{r,\\max} = 20$.\n    - Maximum singular degree: $p_{s,\\max} = 12$.\n    - Maximum analytic degree: $p_{a,\\max} = 20$.\n    - Set of discrete grading ratios: $\\mathcal{Q} = \\{0.15, 0.25, 0.35, 0.50\\}$.\n- **Test Cases**: Five tuples of parameters $(\\alpha, B, C_{s}, C_{a}, b_{a})$ are provided for testing.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is based on established principles of the numerical analysis of partial differential equations, specifically the theory of $hp$-adaptive finite element and discontinuous Galerkin methods. The error estimates for solutions with corner singularities ($r^\\alpha$-type) on geometrically graded meshes and for analytic solutions under $p$-refinement are canonical results in this field. The problem is scientifically valid.\n- **Well-Posed**: The task is a constrained optimization problem over a finite, discrete search space. An optimal solution is guaranteed to exist. The explicit, ordered tie-breaking rules ensure that a unique solution can be identified.\n- **Objective**: The problem is formulated with precise mathematical definitions and quantitative parameters, devoid of any subjective or ambiguous language.\n- **Completeness and Consistency**: All parameters, constraints, and objective functions required to solve the problem are explicitly provided. There are no contradictions in the setup.\n- **Conclusion**: The problem is valid, self-contained, and computationally solvable.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. The solution process will proceed.\n\n### Solution Methodology\n\nThe problem requires finding the optimal set of discrete parameters $(p_{a}^{\\star}, p_{s}^{\\star}, N_{r}^{\\star}, q^{\\star})$ that minimizes the surrogate error functional $\\mathcal{E}_{\\text{DG}}$ while adhering to a total degree-of-freedom budget $B$. This is a discrete, constrained optimization problem.\n\nGiven the finite and manageably small size of the search space (the total number of configurations is $p_{a,\\max} \\times p_{s,\\max} \\times N_{r,\\max} \\times |\\mathcal{Q}| = 20 \\times 12 \\times 20 \\times 4 = 19200$), a direct enumeration or brute-force search is a feasible and robust strategy to find the global minimum.\n\nThe algorithm proceeds as follows for each test case:\n1.  Initialize a variable to store the best configuration found so far, along with its corresponding error and DOF count. The initial minimum error is set to infinity.\n2.  Iterate through every possible combination of the discrete parameters:\n    - $p_{a} \\in \\{1, 2, \\dots, 20\\}$\n    - $p_{s} \\in \\{1, 2, \\dots, 12\\}$\n    - $N_{r} \\in \\{1, 2, \\dots, 20\\}$\n    - $q \\in \\{0.15, 0.25, 0.35, 0.50\\}$\n3.  For each configuration $(p_{a}, p_{s}, N_{r}, q)$, perform the following steps:\n    a. Calculate the total degrees of freedom (DOF):\n    $$\n    \\text{DOF}(p_{a}, p_{s}, N_{r}) = M\\,N_{r}\\,(p_{s}+1)^{2} + E_{\\text{out}}\\,(p_{a}+1)^{2} = 8\\,N_{r}\\,(p_{s}+1)^{2} + 8\\,(p_{a}+1)^{2}\n    $$\n    b. Check if the configuration is admissible by comparing its DOF with the budget $B$:\n    $$\n    \\text{DOF}(p_{a}, p_{s}, N_{r}) \\le B\n    $$\n    c. If the configuration is admissible, calculate the surrogate error:\n    $$\n    \\mathcal{E}_{\\text{DG}} = C_{s}\\,q^{\\alpha N_{r}}\\,(p_{s}+1)^{-\\alpha} + C_{a}\\,\\mathrm{e}^{-b_{a}p_{a}}\n    $$\n    d. Compare the current configuration with the best one found so far. The comparison follows the specified hierarchy of rules. A new configuration is superior if it has a smaller error. If the errors are identical, the tie is broken by preferring lower DOFs, then lower $p_a$, then lower $p_s$, then lower $N_r$, and finally higher $q$. This entire set of ordered criteria can be implemented by performing a lexicographical comparison on a \"score\" tuple for each configuration: $(\\mathcal{E}_{\\text{DG}}, \\text{DOF}, p_a, p_s, N_r, -q)$. The configuration that yields the lexicographically smallest score tuple is the optimal one.\n4.  After checking all possible configurations, the one corresponding to the lexicographically smallest score tuple is the solution $(p_{a}^{\\star}, p_{s}^{\\star}, N_{r}^{\\star}, q^{\\star})$, along with its predicted error $\\mathcal{E}_{\\text{DG}}^{\\star}$ and DOF count $\\text{DOF}^{\\star}$.\n5.  This process is repeated for each of the five test cases, and the results are collected.\n\nThis systematic search guarantees finding the unique optimal configuration as defined by the problem statement. The implementation will follow this logic precisely.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Finds the optimal hp-DG configuration by searching over a discrete parameter\n    space to minimize a surrogate error bound under a DOF budget.\n    \"\"\"\n    \n    # Fixed mesh-structure parameters\n    M = 8\n    E_out = 8\n    Nr_max = 20\n    ps_max = 12\n    pa_max = 20\n    Q_set = [0.15, 0.25, 0.35, 0.50]\n    \n    # Test suite: (alpha, B, Cs, Ca, ba)\n    test_cases = [\n        (0.30, 600, 1.00, 0.10, 0.60),\n        (0.70, 1200, 1.00, 0.10, 0.60),\n        (0.95, 3000, 1.00, 0.05, 0.80),\n        (0.20, 200, 1.00, 0.20, 0.50),\n        (0.50, 5000, 0.80, 0.10, 0.70),\n    ]\n\n    results = []\n    \n    # Parameter ranges for the search\n    pa_range = range(1, pa_max + 1)\n    ps_range = range(1, ps_max + 1)\n    Nr_range = range(1, Nr_max + 1)\n    \n    for case in test_cases:\n        alpha, B, Cs, Ca, ba = case\n        \n        # Initialize with a score that will be beaten by any valid configuration\n        best_score_tuple = (float('inf'),) * 6  # (error, dof, pa, ps, Nr, -q)\n        best_config = None\n        \n        # Brute-force search over the entire parameter space\n        for pa in pa_range:\n            for ps in ps_range:\n                for Nr in Nr_range:\n                    # Calculate DOF contribution from analytic and singular regions\n                    dof_corner = M * Nr * (ps + 1)**2\n                    dof_outer = E_out * (pa + 1)**2\n                    total_dof = dof_corner + dof_outer\n                    \n                    # Check if the configuration is admissible (within DOF budget)\n                    if total_dof <= B:\n                        for q in Q_set:\n                            # Calculate the surrogate error\n                            error_singular = Cs * np.power(q, alpha * Nr) * np.power(ps + 1, -alpha)\n                            error_analytic = Ca * np.exp(-ba * pa)\n                            total_error = error_singular + error_analytic\n\n                            # Create a score tuple for lexicographical comparison.\n                            # This implements the tie-breaking rules:\n                            # 1. Minimize error\n                            # 2. Minimize DOF\n                            # 3. Minimize pa\n                            # 4. Minimize ps\n                            # 5. Minimize Nr\n                            # 6. Maximize q (by minimizing -q)\n                            current_score_tuple = (total_error, total_dof, pa, ps, Nr, -q)\n\n                            if current_score_tuple < best_score_tuple:\n                                best_score_tuple = current_score_tuple\n                                # Store the optimal configuration and its metrics\n                                best_config = [pa, ps, Nr, q, total_error, total_dof]\n\n        results.append(best_config)\n    \n    # Format the final output string exactly as required\n    # e.g., \"[[pa1,ps1,Nr1,q1,err1,dof1],[pa2,ps2,Nr2,q2,err2,dof2]]\"\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3377380"}]}