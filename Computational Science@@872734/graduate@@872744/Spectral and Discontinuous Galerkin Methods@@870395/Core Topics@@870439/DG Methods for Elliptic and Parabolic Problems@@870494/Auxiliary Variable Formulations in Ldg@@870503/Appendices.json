{"hands_on_practices": [{"introduction": "The construction of any Local Discontinuous Galerkin (LDG) method starts with the discretization of the first-order system on a reference element. This exercise [@problem_id:3364989] provides direct practice with this fundamental step, focusing on the auxiliary equation $q = \\nabla u$. By constructing the local mass and gradient matrices from first principles, you will gain a concrete understanding of how polynomial basis functions translate differential operators into a computable algebraic system.", "problem": "Consider the Local Discontinuous Galerkin (LDG) method (Local Discontinuous Galerkin) applied to the first-order auxiliary equation $q = \\nabla u$ in one spatial dimension on the reference interval $[-1,1]$. Let the trial and test spaces be the same modal polynomial space of degree at most $p=3$, spanned by the orthonormal Legendre basis functions $\\{\\varphi_{n}(x)\\}_{n=0}^{3}$, where $\\varphi_{n}(x) = \\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$ and $P_{n}(x)$ are the degree-$n$ Legendre polynomials on $[-1,1]$. The element mass submatrix for the $q$-equation is defined by\n$$\nM^{q}_{ij} = \\int_{-1}^{1} \\varphi_{i}(x)\\,\\varphi_{j}(x)\\,\\mathrm{d}x,\n$$\nand the stiffness-like gradient submatrix that couples $u$ to $q$ is defined by\n$$\nG_{ij} = \\int_{-1}^{1} \\varphi_{i}(x)\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\varphi_{j}(x)\\,\\mathrm{d}x,\n$$\nwith interior-only coupling (i.e., ignoring boundary fluxes for this construction). Using exact quadrature (choose a Gauss–Legendre rule of sufficient order so that all integrals of polynomial products are evaluated exactly), construct $M^{q}$ and $G$ on the reference element for $p=3$, and list all of their nonzero entries symbolically.\n\nFinally, compute the squared Frobenius norm of $G$,\n$$\n\\|G\\|_{F}^{2} = \\sum_{i=0}^{3}\\sum_{j=0}^{3} G_{ij}^{2},\n$$\nand provide this single scalar as your final answer. If your computation yields an exact value, do not round.", "solution": "The user has provided a well-defined computational problem within the domain of numerical analysis for partial differential equations, specifically concerning the Local Discontinuous Galerkin (LDG) method. All definitions, parameters, and objectives are clearly stated and mathematically sound. The problem is self-contained and free of scientific flaws, contradictions, or ambiguities. Therefore, the problem is deemed valid and a full solution is warranted.\n\nThe problem requires the construction of two matrices, the mass submatrix $M^{q}$ and the stiffness-like gradient submatrix $G$, for an LDG formulation on the reference element $[-1,1]$. The polynomial approximation space is of degree at most $p=3$, spanned by an orthonormal Legendre basis. Finally, the squared Frobenius norm of $G$ must be computed.\n\nThe basis functions are the orthonormal Legendre polynomials on $[-1,1]$, given by $\\varphi_{n}(x) = \\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$, where $P_{n}(x)$ is the standard Legendre polynomial of degree $n$. For $p=3$, the basis is $\\{\\varphi_{0}, \\varphi_{1}, \\varphi_{2}, \\varphi_{3}\\}$.\n\nFirst, we construct the mass submatrix $M^{q}$. Its entries are defined as:\n$$\nM^{q}_{ij} = \\int_{-1}^{1} \\varphi_{i}(x)\\,\\varphi_{j}(x)\\,\\mathrm{d}x, \\quad i,j \\in \\{0, 1, 2, 3\\}\n$$\nBy definition, the basis $\\{\\varphi_{n}(x)\\}$ is orthonormal with respect to the $L^2$ inner product on $[-1,1]$. Therefore, the integral is equal to the Kronecker delta, $\\delta_{ij}$.\n$$\nM^{q}_{ij} = \\delta_{ij}\n$$\nThis means that $M^{q}$ is the $4 \\times 4$ identity matrix, $I_4$. The non-zero entries are on the main diagonal:\n$$\nM^{q}_{00} = 1, \\quad M^{q}_{11} = 1, \\quad M^{q}_{22} = 1, \\quad M^{q}_{33} = 1\n$$\n\nNext, we construct the stiffness-like gradient submatrix $G$. Its entries are defined as:\n$$\nG_{ij} = \\int_{-1}^{1} \\varphi_{i}(x)\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\varphi_{j}(x)\\,\\mathrm{d}x, \\quad i,j \\in \\{0, 1, 2, 3\\}\n$$\nTo compute these entries, we use the well-known property for the derivative of Legendre polynomials:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}P_{j}(x) = \\sum_{\\substack{k=0 \\\\ k < j \\\\ j-k \\text{ is odd}}}^{j-1} (2k+1)P_{k}(x)\n$$\nWe can express this relation in terms of the orthonormal basis functions $\\varphi_{n}(x)$ by substituting $P_{n}(x) = \\sqrt{\\frac{2}{2n+1}}\\varphi_{n}(x)$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\sqrt{\\frac{2}{2j+1}}\\varphi_{j}(x)\\right) = \\sum_{\\substack{k=0 \\\\ k < j \\\\ j-k \\text{ is odd}}}^{j-1} (2k+1)\\sqrt{\\frac{2}{2k+1}}\\varphi_{k}(x)\n$$\nMultiplying by $\\sqrt{\\frac{2j+1}{2}}$ gives the expansion for the derivative $\\varphi'_{j}(x)$:\n$$\n\\varphi'_{j}(x) = \\sqrt{\\frac{2j+1}{2}} \\sum_{\\substack{k=0 \\\\ k < j \\\\ j-k \\text{ is odd}}}^{j-1} \\sqrt{2(2k+1)}\\,\\varphi_{k}(x) = \\sum_{\\substack{k=0 \\\\ k < j \\\\ j-k \\text{ is odd}}}^{j-1} \\sqrt{(2j+1)(2k+1)}\\,\\varphi_{k}(x)\n$$\nThe entry $G_{ij}$ is the $L^2$ inner product $(\\varphi_{i}, \\varphi'_{j})$. Substituting the expansion for $\\varphi'_{j}(x)$ yields:\n$$\nG_{ij} = \\int_{-1}^{1} \\varphi_{i}(x) \\left( \\sum_{\\substack{k=0 \\\\ k < j \\\\ j-k \\text{ is odd}}}^{j-1} \\sqrt{(2j+1)(2k+1)}\\,\\varphi_{k}(x) \\right) \\mathrm{d}x\n$$\nDue to the orthonormality of the basis, $\\int_{-1}^{1} \\varphi_{i}(x)\\varphi_{k}(x)\\,\\mathrm{d}x = \\delta_{ik}$, the integral acts to select the coefficient of $\\varphi_{i}(x)$ from the sum. Thus, $G_{ij}$ is non-zero only if $i$ satisfies the conditions on the summation index $k$, namely $i < j$ and $j-i$ is odd.\n$$\nG_{ij} = \\begin{cases} \\sqrt{(2j+1)(2i+1)} & \\text{if } i < j \\text{ and } j-i \\text{ is odd} \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nWe now compute the specific non-zero entries for $i,j \\in \\{0, 1, 2, 3\\}$:\n\\begin{itemize}\n    \\item For $j=0$: $\\varphi'_{0}(x) = 0$, so $G_{i0}=0$ for all $i$.\n    \\item For $j=1$: The only valid $i$ is $i=0$ (since $0<1$ and $1-0=1$ is odd).\n    $$ G_{01} = \\sqrt{(2(1)+1)(2(0)+1)} = \\sqrt{3 \\cdot 1} = \\sqrt{3} $$\n    \\item For $j=2$: The only valid $i$ is $i=1$ (since $1<2$ and $2-1=1$ is odd).\n    $$ G_{12} = \\sqrt{(2(2)+1)(2(1)+1)} = \\sqrt{5 \\cdot 3} = \\sqrt{15} $$\n    \\item For $j=3$: The valid values for $i$ are $i=0$ ($0<3, 3-0=3$ is odd) and $i=2$ ($2<3, 3-2=1$ is odd).\n    $$ G_{03} = \\sqrt{(2(3)+1)(2(0)+1)} = \\sqrt{7 \\cdot 1} = \\sqrt{7} $$\n    $$ G_{23} = \\sqrt{(2(3)+1)(2(2)+1)} = \\sqrt{7 \\cdot 5} = \\sqrt{35} $$\n\\end{itemize}\nAll other entries of $G$ are zero. The non-zero entries of $G$ are: $G_{01} = \\sqrt{3}$, $G_{12} = \\sqrt{15}$, $G_{03} = \\sqrt{7}$, and $G_{23} = \\sqrt{35}$.\n\nFinally, we compute the squared Frobenius norm of $G$:\n$$\n\\|G\\|_{F}^{2} = \\sum_{i=0}^{3}\\sum_{j=0}^{3} G_{ij}^{2}\n$$\nThis is the sum of the squares of all entries of the matrix. We only need to consider the non-zero entries:\n$$\n\\|G\\|_{F}^{2} = G_{01}^{2} + G_{12}^{2} + G_{03}^{2} + G_{23}^{2}\n$$\nSubstituting the computed values:\n$$\n\\|G\\|_{F}^{2} = (\\sqrt{3})^{2} + (\\sqrt{15})^{2} + (\\sqrt{7})^{2} + (\\sqrt{35})^{2}\n$$\n$$\n\\|G\\|_{F}^{2} = 3 + 15 + 7 + 35\n$$\n$$\n\\|G\\|_{F}^{2} = 18 + 42 = 60\n$$\nThe squared Frobenius norm of the matrix $G$ is $60$.", "answer": "$$\\boxed{60}$$", "id": "3364989"}, {"introduction": "While local matrices form the core of the method, the 'discontinuous' nature of the basis requires a mechanism to enforce continuity and boundary conditions: the numerical flux. This problem [@problem_id:3365011] moves from local matrix construction to building a complete element-level system for a 1D diffusion problem, focusing specifically on how alternating fluxes incorporate boundary data. This practice is key to grasping how LDG methods correctly handle information flow at element interfaces.", "problem": "Consider the one-dimensional, steady, second-order diffusion model on the interval $[0,1]$ with constant positive diffusivity $\\kappa>0$,\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) \\;=\\; f(x),\n$$\nsubject to the boundary conditions $u(0)=0$ and $\\kappa\\, u'(1)=1$, with zero source $f(x)\\equiv 0$. Introduce the auxiliary variable $r(x)=\\kappa\\, u'(x)$ so that the system becomes\n$$\nr - \\kappa\\, u' \\;=\\; 0, \\qquad -r' \\;=\\; 0.\n$$\nUsing the Local Discontinuous Galerkin (LDG) method, approximate $u$ and $r$ on the single element $E=[0,1]$ by piecewise polynomials of degree $p=1$:\n$$\nu_h(x) \\;=\\; a_0\\,\\phi_0(x) + a_1\\,\\phi_1(x), \\qquad r_h(x) \\;=\\; b_0\\,\\phi_0(x) + b_1\\,\\phi_1(x),\n$$\nwhere the local basis is chosen as $\\phi_0(x)=1$ and $\\phi_1(x)=x$ on $E$. Let $v,w\\in\\mathrm{span}\\{\\phi_0,\\phi_1\\}$ be test functions for the first and second equations, respectively. Derive the elementwise LDG weak forms by starting from the first-order system and applying integration by parts where appropriate, replacing boundary traces by numerical fluxes. For numerical fluxes, adopt the standard LDG alternating choice at the single element boundaries:\n- At $x=0$ (Dirichlet), set $\\widehat{u}(0)=u_D=0$ and use the interior value for $\\widehat{r}(0)=r_h(0)$.\n- At $x=1$ (Neumann), set $\\widehat{r}(1)=g_N=1$ and use the interior value for $\\widehat{u}(1)=u_h(1)$.\n\nWrite the resulting elementwise LDG system and then compute the boundary contributions explicitly for $p=1$ polynomials. Specifically, extract the boundary-only contribution to the local residual arising solely from the prescribed boundary data $(u_D,g_N)=(0,1)$, evaluated with the two test functions $\\phi_0$ and $\\phi_1$ in each equation. Order the four boundary contributions as the row vector\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big],\n$$\nwhere $B^{(r-\\kappa u')}_{\\phi_j}$ and $B^{(-r')}_{\\phi_j}$ denote the boundary term in the weak form of the first and second equations, respectively, coming only from the imposed boundary data. Provide this row vector as your final answer. No rounding is required. Express the final answer as a closed-form analytic expression.", "solution": "The user wants me to solve a problem based on the Local Discontinuous Galerkin (LDG) method for a one-dimensional diffusion equation.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n-   **Governing Equation**: $- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) = f(x)$ on the interval $[0,1]$.\n-   **Parameters**: Diffusivity $\\kappa > 0$ is a constant. Source term $f(x) \\equiv 0$.\n-   **Boundary Conditions**: $u(0)=u_D=0$ and $\\kappa\\, u'(1)=g_N=1$.\n-   **First-Order System**: The auxiliary variable is $r(x)=\\kappa\\, u'(x)$. The system is:\n    $$\n    r - \\kappa\\, u' = 0\n    $$\n    $$\n    -r' = 0\n    $$\n-   **Discretization**: The domain is a single element $E=[0,1]$. The approximation space consists of polynomials of degree $p=1$.\n-   **Trial and Test Functions**:\n    -   Basis functions: $\\phi_0(x)=1$, $\\phi_1(x)=x$.\n    -   Trial functions: $u_h(x) = a_0\\phi_0(x) + a_1\\phi_1(x)$ and $r_h(x) = b_0\\phi_0(x) + b_1\\phi_1(x)$.\n    -   Test functions: $v,w \\in \\mathrm{span}\\{\\phi_0,\\phi_1\\}$.\n-   **Numerical Fluxes**: The alternating flux choice is specified:\n    -   At $x=0$: $\\widehat{u}(0)=u_D=0$; $\\widehat{r}(0)=r_h(0)$.\n    -   At $x=1$: $\\widehat{r}(1)=g_N=1$; $\\widehat{u}(1)=u_h(1)$.\n-   **Task**: Compute the four boundary contributions to the local residual, ordered as the row vector $\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]$, arising solely from the prescribed boundary data $(u_D,g_N)=(0,1)$.\n\n**1.2. Validate Using Extracted Givens**\n\n-   **Scientific Grounding**: The problem is a standard application of the well-established Local Discontinuous Galerkin (LDG) method to a fundamental second-order elliptic partial differential equation (the diffusion equation). All concepts are standard in numerical analysis and computational science. The problem is scientifically sound.\n-   **Well-Posedness**: The problem is well-posed. It provides a complete set of instructions, including the governing equations, boundary conditions, discretization details (element, basis functions), and the specific choice of numerical fluxes. The task is a specific, unambiguous calculation based on these inputs.\n-   **Objectivity**: The problem statement is formulated in precise mathematical terms, free from any subjective or ambiguous language.\n\n**1.3. Verdict and Action**\n\nThe problem is valid. I will proceed with the solution.\n\n### Step 2: Solution Derivation\n\nThe process begins by deriving the weak formulation for the first-order system on the element $E=[0,1]$.\n\n**Derivation of the Weak Form for the First Equation**\nThe first equation is $r - \\kappa u' = 0$. We multiply by a test function $v$ and integrate over the element $E$:\n$$\n\\int_{E} (r_h - \\kappa u'_h) v \\, dx = 0\n$$\n$$\n\\int_{0}^{1} r_h v \\, dx - \\kappa \\int_{0}^{1} u'_h v \\, dx = 0\n$$\nWe apply integration by parts to the second term:\n$$\n\\int_{0}^{1} u'_h v \\, dx = [u_h v]_{x=0}^{x=1} - \\int_{0}^{1} u_h v' \\, dx = u_h(1)v(1) - u_h(0)v(0) - \\int_{0}^{1} u_h v' \\, dx\n$$\nSubstituting this back into the equation gives:\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa(u_h(1)v(1) - u_h(0)v(0)) = 0\n$$\nIn the Discontinuous Galerkin framework, the traces of the solution at the element boundary are replaced by numerical fluxes, denoted by a hat symbol. The weak form becomes:\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa \\widehat{u}(1)v(1) + \\kappa \\widehat{u}(0)v(0) = 0\n$$\n\n**Derivation of the Weak Form for the Second Equation**\nThe second equation is $-r' = 0$. We multiply by a test function $w$ and integrate over $E$:\n$$\n-\\int_{E} r'_h w \\, dx = 0\n$$\nApplying integration by parts:\n$$\n-[r_h w]_{x=0}^{x=1} + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\n$$\n-(r_h(1)w(1) - r_h(0)w(0)) + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\nReplacing the boundary traces with numerical fluxes $\\widehat{r}(1)$ and $\\widehat{r}(0)$:\n$$\n\\int_{0}^{1} r_h w' \\, dx - \\widehat{r}(1)w(1) + \\widehat{r}(0)w(0) = 0\n$$\n\n**Defining the Local Residual and Identifying Boundary Contributions**\nThe problem asks for the contribution to the local residual arising solely from the prescribed boundary data. The local residual for each equation is the expression that must equal zero. We substitute the specific numerical fluxes given in the problem:\n-   At $x=0$: $\\widehat{u}(0)=u_D=0$, $\\widehat{r}(0)=r_h(0)$ (interior value).\n-   At $x=1$: $\\widehat{r}(1)=g_N=1$, $\\widehat{u}(1)=u_h(1)$ (interior value).\n\nSubstituting these into the weak forms gives the residual equations:\nResidual for the first equation:\n$$\n\\underbrace{\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa u_h(1)v(1)}_{\\text{terms depending on unknown solution}} + \\underbrace{\\kappa u_D v(0)}_{\\text{term from prescribed data}} = 0\n$$\nResidual for the second equation:\n$$\n\\underbrace{\\int_{0}^{1} r_h w' \\, dx + r_h(0)w(0)}_{\\text{terms depending on unknown solution}} \\underbrace{- g_N w(1)}_{\\text{term from prescribed data}} = 0\n$$\nThe contribution to the local residual from the prescribed boundary data is the part of the expression that does not depend on the unknown solution coefficients $(a_0, a_1, b_0, b_1)$.\nFrom the first equation, this contribution is $B^{(r-\\kappa u')}_{v} = \\kappa u_D v(0)$.\nFrom the second equation, this contribution is $B^{(-r')}_{w} = -g_N w(1)$.\n\n**Computing the Contributions for Specific Test Functions**\nWe are given $u_D=0$ and $g_N=1$. The test functions are $\\phi_0(x)=1$ and $\\phi_1(x)=x$.\n\n1.  **Term $B^{(r-\\kappa u')}_{\\phi_0}$**: Here $v = \\phi_0(x)=1$.\n    $B^{(r-\\kappa u')}_{\\phi_0} = \\kappa u_D \\phi_0(0) = \\kappa \\cdot 0 \\cdot 1 = 0$.\n\n2.  **Term $B^{(r-\\kappa u')}_{\\phi_1}$**: Here $v = \\phi_1(x)=x$.\n    $B^{(r-\\kappa u')}_{\\phi_1} = \\kappa u_D \\phi_1(0) = \\kappa \\cdot 0 \\cdot 0 = 0$.\n\n3.  **Term $B^{(-r')}_{\\phi_0}$**: Here $w = \\phi_0(x)=1$.\n    $B^{(-r')}_{\\phi_0} = -g_N \\phi_0(1) = -1 \\cdot 1 = -1$.\n\n4.  **Term $B^{(-r')}_{\\phi_1}$**: Here $w = \\phi_1(x)=x$.\n    $B^{(-r')}_{\\phi_1} = -g_N \\phi_1(1) = -1 \\cdot 1 = -1$.\n\n**Final Assembly of the Vector**\nThe problem requests the row vector of these four contributions in the specified order:\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]\n$$\nSubstituting the computed values, we obtain the final answer.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & -1 & -1\n\\end{pmatrix}\n}\n$$", "id": "3365011"}, {"introduction": "A significant advantage of rewriting PDEs as first-order systems is the ease with which some nonlinear operators can be handled. This advanced problem [@problem_id:3365012] demonstrates this by applying the LDG framework to the nonlinear $p$-Laplacian equation. The exercise guides you through the process of linearizing the weak form using Newton's method, a powerful and widely used technique for solving nonlinear systems in computational science.", "problem": "Consider the nonlinear diffusion problem governed by the $p$-Laplacian on a single element, formulated for the purpose of constructing a Local Discontinuous Galerkin (LDG) method with an auxiliary variable. On a physical element $K = (0,h) \\subset \\mathbb{R}$ with $h > 0$, introduce the auxiliary variable $q = \\nabla u$ and rewrite the $p$-Laplacian equation $- \\nabla \\cdot \\left(|\\nabla u|^{p-2} \\nabla u \\right) = f$ with $p > 1$ as the first-order system\n$q - \\nabla u = 0$ and $- \\nabla \\cdot \\left( a(q) \\right) = f$,\nwhere $a(q) = |q|^{p-2} q$. Let $V_h$ and $W_h$ be discontinuous finite element spaces of degree $1$ on $K$ for scalar and vector fields, respectively. On $K$, use the following local polynomial bases:\n$\\{\\phi_1(x), \\phi_2(x)\\}$ for $V_h$, with $\\phi_1(x) = 1 - x/h$ and $\\phi_2(x) = x/h$, and $\\{\\psi_1(x), \\psi_2(x)\\}$ for $W_h$, chosen so that $\\psi_i = \\phi_i$ on $K$. Assume that the LDG weak form is constructed in the standard way by integration by parts applied to each first-order equation, with consistent numerical fluxes at interfaces. For this problem, you must derive the Newton linearization of the LDG residual and identify the element matrices associated with the linearization of the nonlinear flux $a(q)$, focusing on the volume contribution only and neglecting all face terms involving numerical fluxes.\n\nStarting from the first-order system and the definition of the LDG weak form on $K$, perform a Newton linearization of the residual about a current iterate $(u^k, q^k)$ and derive the Jacobian with respect to $(\\delta u, \\delta q)$, emphasizing the linearization of the nonlinear flux $a(q)$. In particular:\n\n- Derive the Fréchet derivative $D a(q)$ of $a(q) = |q|^{p-2} q$ in an arbitrary spatial dimension $d$, expressed in terms of $q$, $p$, and the identity tensor.\n\n- Using the Newton linearization, write down the general element volume bilinear form that yields the Jacobian block associated with the variation $\\delta q$ entering the second equation $- \\nabla \\cdot (a(q)) = f$, tested against scalar test functions from $V_h$.\n\n- Specialize to the one-dimensional element $K = (0,h)$ with the given bases, and assume that at the current Newton iterate $q^k(x) \\equiv q_0$ is a constant on $K$ with $q_0 > 0$. Under these assumptions, compute the $(1,1)$ entry of the element matrix $B^{(K)}$ corresponding to the volume contribution of the Jacobian block $\\partial R_2 / \\partial q$ (the derivative of the residual of the second equation with respect to $q$), where the row index corresponds to the scalar test basis function $\\phi_1$ and the column index corresponds to the $q$-trial basis function $\\psi_1$.\n\nYour final answer must be a single closed-form analytic expression in terms of $p$ and $q_0$. No numerical approximation is required. Express the final answer without units.", "solution": "The problem asks for the derivation of a specific entry of the Jacobian matrix resulting from the Newton linearization of the Local Discontinuous Galerkin (LDG) formulation of the $p$-Laplacian equation on a single element. We will proceed by first establishing the weak formulation and its linearization, then deriving the general Fréchet derivative of the nonlinear flux, and finally computing the specific matrix entry under the given assumptions.\n\nThe governing equation, $- \\nabla \\cdot (|\\nabla u|^{p-2} \\nabla u) = f$, is rewritten as a first-order system by introducing the auxiliary variable $q = \\nabla u$:\n$$q - \\nabla u = 0$$\n$$-\\nabla \\cdot a(q) = f$$\nwhere $a(q) = |q|^{p-2} q$ and $p > 1$.\n\nThe LDG weak formulation on a single element $K$ is constructed by multiplying each equation by a suitable test function and integrating over $K$. The problem specifies to neglect all face terms arising from integration by parts.\nLet $u_h \\in V_h$ and $q_h \\in W_h$ be the finite element approximations for $u$ and $q$. For test functions $v_h \\in V_h$ and $w_h \\in W_h$, the volume part of the weak formulation is:\n$1$. $\\int_K (q_h - \\nabla u_h) \\cdot w_h \\, dx = 0$\n$2$. $\\int_K a(q_h) \\cdot \\nabla v_h \\, dx = \\int_K f v_h \\, dx$\n\nThe Newton method solves the nonlinear system by iteratively finding corrections $(\\delta u, \\delta q)$ to a current approximation $(u^k, q^k)$. We linearize the system of residual equations around $(u^k, q^k)$. The residual for the second equation is:\n$$R_2(q_h; v_h) = \\int_K a(q_h) \\cdot \\nabla v_h \\, dx - \\int_K f v_h \\, dx = 0$$\nThe linearization of $R_2$ with respect to $q_h$ in the direction of an increment $\\delta q_h$ is given by its Gâteaux derivative:\n$$\\langle D_{q_h} R_2(q_h; v_h), \\delta q_h \\rangle = \\lim_{\\epsilon \\to 0} \\frac{R_2(q_h + \\epsilon \\delta q_h; v_h) - R_2(q_h; v_h)}{\\epsilon}$$\nSubstituting the definition of $R_2$ and taking the limit inside the integral yields:\n$$\\langle D_{q_h} R_2(q_h; v_h), \\delta q_h \\rangle = \\int_K \\left( \\lim_{\\epsilon \\to 0} \\frac{a(q_h + \\epsilon \\delta q_h) - a(q_h)}{\\epsilon} \\right) \\cdot \\nabla v_h \\, dx = \\int_K Da(q_h)[\\delta q_h] \\cdot \\nabla v_h \\, dx$$\nHere, $Da(q_h)[\\delta q_h]$ is the Fréchet derivative of $a$ at $q_h$ applied to the increment $\\delta q_h$.\n\nFirst, we derive the Fréchet derivative $Da(q)$ for $a(q) = |q|^{p-2} q$ in an arbitrary spatial dimension $d$. Let $q \\in \\mathbb{R}^d$. The $i$-th component of $a(q)$ is $a_i(q) = |q|^{p-2} q_i$. We compute the Jacobian matrix with components $(Da(q))_{ij} = \\frac{\\partial a_i}{\\partial q_j}$. Using the product rule and chain rule:\n$$\\frac{\\partial a_i}{\\partial q_j} = \\frac{\\partial}{\\partial q_j} \\left( |q|^{p-2} \\right) q_i + |q|^{p-2} \\frac{\\partial q_i}{\\partial q_j}$$\nThe derivative of $|q|=\\sqrt{q \\cdot q}$ is $\\frac{\\partial |q|}{\\partial q_j} = \\frac{q_j}{|q|}$. Thus, $\\frac{\\partial}{\\partial q_j}(|q|^{p-2}) = (p-2)|q|^{p-3} \\frac{q_j}{|q|} = (p-2)|q|^{p-4} q_j$. Also, $\\frac{\\partial q_i}{\\partial q_j} = \\delta_{ij}$ (the Kronecker delta). Combining these results:\n$$\\frac{\\partial a_i}{\\partial q_j} = (p-2)|q|^{p-4} q_j q_i + |q|^{p-2} \\delta_{ij}$$\nIn coordinate-free tensor notation, this is:\n$$Da(q) = (p-2)|q|^{p-4} (q \\otimes q) + |q|^{p-2} I$$\nwhere $I$ is the identity tensor and $(q \\otimes q)$ is the outer product of $q$ with itself.\n\nThe general element volume bilinear form for the Jacobian block $\\partial R_2 / \\partial q$ is obtained by substituting this derivative into the linearized weak form. Let $q^k$ be the current Newton iterate. The bilinear form acting on an increment $\\delta q$ and a test function $v$ is:\n$$B(q^k; \\delta q, v) = \\int_K Da(q^k)[\\delta q] \\cdot \\nabla v \\, dx = \\int_K \\left( (p-2)|q^k|^{p-4} (q^k \\cdot \\delta q) q^k + |q^k|^{p-2} \\delta q \\right) \\cdot \\nabla v \\, dx$$\n\nNow, we specialize to the one-dimensional element $K = (0,h)$. In $1$D, $q$ is a scalar, and vectors become scalars, dot products become standard multiplication, and the tensor $Da(q)$ becomes the scalar derivative $a'(q)$. For a scalar $q \\neq 0$, $a(q) = |q|^{p-2} q$. The problem states to assume the current iterate is a constant $q^k(x) = q_0 > 0$. For $q > 0$, we have $|q|=q$, so $a(q) = q^{p-1}$. The derivative is:\n$$a'(q) = (p-1)q^{p-2}$$\nThis is consistent with the general $d$-dimensional formula specialized to $d=1$ with $q>0$, as $Da(q)[\\delta q] = ((p-2)q^{p-4}q^2 + q^{p-2})\\delta q = (p-1)q^{p-2}\\delta q$.\nThe Jacobian contribution from the volume integral is thus given by the matrix $B^{(K)}$ with entries:\n$$B^{(K)}_{ij} = \\int_K a'(q^k(x)) \\psi_j(x) \\nabla\\phi_i(x) \\, dx$$\nwhere $\\phi_i$ are the test basis functions from $V_h$ and $\\psi_j$ are the trial basis functions for the increment $\\delta q$ from $W_h$.\n\nWe are asked to compute the entry $B^{(K)}_{11}$. This corresponds to the test function $\\phi_1$ and the trial function $\\psi_1$.\nGiven bases are $\\phi_1(x) = 1 - x/h$ and $\\psi_1(x) = \\phi_1(x) = 1 - x/h$.\nThe derivative of the test function is $\\nabla\\phi_1(x) = \\frac{d}{dx}(1 - x/h) = -1/h$.\nThe derivative of the nonlinear flux, under the assumption $q^k(x) = q_0 > 0$, is the constant $a'(q_0) = (p-1)q_0^{p-2}$.\n\nWe now compute the integral for $B^{(K)}_{11}$:\n$$B^{(K)}_{11} = \\int_0^h a'(q_0) \\psi_1(x) \\nabla\\phi_1(x) \\, dx$$\n$$B^{(K)}_{11} = \\int_0^h (p-1)q_0^{p-2} \\left(1 - \\frac{x}{h}\\right) \\left(-\\frac{1}{h}\\right) \\, dx$$\nSince $(p-1)q_0^{p-2}$ and $-1/h$ are constants, we can factor them out:\n$$B^{(K)}_{11} = -(p-1)q_0^{p-2} \\frac{1}{h} \\int_0^h \\left(1 - \\frac{x}{h}\\right) \\, dx$$\nThe remaining integral evaluates to:\n$$\\int_0^h \\left(1 - \\frac{x}{h}\\right) \\, dx = \\left[x - \\frac{x^2}{2h}\\right]_0^h = \\left(h - \\frac{h^2}{2h}\\right) - (0) = h - \\frac{h}{2} = \\frac{h}{2}$$\nSubstituting this result back into the expression for $B^{(K)}_{11}$:\n$$B^{(K)}_{11} = -(p-1)q_0^{p-2} \\frac{1}{h} \\left(\\frac{h}{2}\\right) = -\\frac{1}{2}(p-1)q_0^{p-2}$$\nThis is the final expression for the $(1,1)$ entry of the element Jacobian matrix contribution from the nonlinear volume term.", "answer": "$$\\boxed{-\\frac{p-1}{2} q_0^{p-2}}$$", "id": "3365012"}]}