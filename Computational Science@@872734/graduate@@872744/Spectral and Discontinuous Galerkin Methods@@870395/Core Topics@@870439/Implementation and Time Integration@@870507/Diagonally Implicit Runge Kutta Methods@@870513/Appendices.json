{"hands_on_practices": [{"introduction": "The order of accuracy of a Runge-Kutta method is a measure of its local truncation error and dictates how quickly the numerical solution converges to the exact solution as the time step shrinks. This is fundamentally determined by how well the method's stability function, $R(z)$, approximates the true exponential solution operator, $\\exp(z)$, for small $z=h\\lambda$. This exercise provides hands-on practice in deriving the stability function for a given Diagonally Implicit Runge-Kutta (DIRK) scheme and using its Taylor series expansion to determine the method's order of accuracy.", "problem": "Consider a semi-discrete system obtained from a Discontinuous Galerkin (DG) spatial discretization of a linear hyperbolic conservation law on a periodic domain, which yields an autonomous linear system of ordinary differential equations (ODEs) of the form $\\,\\frac{d\\mathbf{y}}{dt}=\\mathbf{L}\\mathbf{y}\\,$ with constant matrix $\\,\\mathbf{L}\\,$. A common approach is to advance this system in time using a Diagonally Implicit Runge-Kutta (DIRK) method. For stability and stiffness considerations typical in spectral and Discontinuous Galerkin methods, consider the following singly diagonally implicit Runge-Kutta ($\\,\\text{SDIRK}\\,$) scheme with $\\,2\\,$ stages and a single parameter $\\,\\gamma>0\\,$:\n$$\n\\begin{array}{c|cc}\n\\gamma & \\gamma & 0 \\\\\n1 & 1-\\gamma & \\gamma \\\\\n\\hline\n & 1-\\gamma & \\gamma\n\\end{array}\n$$\nWhen this time integrator is applied to the linear test equation $\\,y'=\\lambda y\\,$, define the non-dimensional variable $\\,z=h\\lambda\\,$, where $\\,h\\,$ is the time step. The one-step update takes the form $\\,y_{n+1}=R(z)\\,y_n\\,$, where $\\,R(z)\\,$ is called the stability function. The order of accuracy $\\,p\\,$ of the method is characterized by the condition that the Taylor series of $\\,R(z)\\,$ matches that of $\\,\\exp(z)\\,$ about $\\,z=0\\,$ up to and including terms of order $\\,z^p\\,$, i.e., $\\,R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})\\,$.\n\nStarting from the stage equations and update formula that define this $\\,\\text{SDIRK}\\,$ method, derive $\\,R(z)\\,$ for the test equation $\\,y'=\\lambda y\\,$, expand it as a Taylor series about $\\,z=0\\,$, and determine the largest integer $\\,p\\,$ such that $\\,R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})\\,$. Express your final answer as a single integer $\\,p\\,$. No rounding is necessary.", "solution": "The semi-discrete system from a Discontinuous Galerkin (DG) discretization is linearized as $\\,\\frac{d\\mathbf{y}}{dt}=\\mathbf{L}\\mathbf{y}\\,$. To assess the time integration accuracy independently of the spatial discretization, one uses the linear test equation $\\,y'=\\lambda y\\,$, for which the exact solution satisfies $\\,y(t+h)=\\exp(h\\lambda)\\,y(t)\\,$. A Runge-Kutta method applied to $\\,y'=\\lambda y\\,$ yields a rational amplification (stability) function $\\,R(z)\\,$ such that $\\,y_{n+1}=R(z)\\,y_n\\,$ with $\\,z=h\\lambda\\,$. The order $\\,p\\,$ is characterized by matching $\\,R(z)\\,$ to $\\,\\exp(z)\\,$ up to $\\,\\mathcal{O}(z^{p+1})\\,$.\n\nFor the given singly diagonally implicit Runge-Kutta ($\\,\\text{SDIRK}\\,$) method with $\\,2\\,$ stages and parameter $\\,\\gamma>0\\,$,\n$$\n\\begin{array}{c|cc}\n\\gamma & \\gamma & 0 \\\\\n1 & 1-\\gamma & \\gamma \\\\\n\\hline\n & 1-\\gamma & \\gamma\n\\end{array}\n$$\nthe stage equations for $\\,y'=\\lambda y\\,$ with $\\,z=h\\lambda\\,$ are\n$$\nY_1 \\;=\\; y_n \\;+\\; z\\,\\gamma\\,Y_1,\\qquad\nY_2 \\;=\\; y_n \\;+\\; z\\Big[(1-\\gamma)\\,Y_1 \\;+\\; \\gamma\\,Y_2\\Big],\n$$\nand the update is\n$$\ny_{n+1} \\;=\\; y_n \\;+\\; z\\Big[(1-\\gamma)\\,Y_1 \\;+\\; \\gamma\\,Y_2\\Big].\n$$\nSolving the linear stage equations:\n$$\n(1 - z\\gamma)\\,Y_1 = y_n \\;\\;\\Longrightarrow\\;\\; Y_1 \\;=\\; \\frac{y_n}{1 - z\\gamma}.\n$$\nSimilarly,\n$$\n(1 - z\\gamma)\\,Y_2 \\;=\\; y_n \\;+\\; z(1-\\gamma)\\,Y_1\n\\;\\;\\Longrightarrow\\;\\;\nY_2 \\;=\\; \\frac{y_n + z(1-\\gamma)Y_1}{1 - z\\gamma}\n\\;=\\; y_n\\,\\frac{1 + z(1-\\gamma)/(1 - z\\gamma)}{1 - z\\gamma}.\n$$\nIt is convenient to denote $\\,D := 1 - z\\gamma\\,$. Then\n$$\nY_1 \\;=\\; \\frac{y_n}{D},\\qquad\nY_2 \\;=\\; \\frac{y_n + z(1-\\gamma)\\,y_n/D}{D}\n\\;=\\; y_n\\left(\\frac{1}{D} \\;+\\; \\frac{z(1-\\gamma)}{D^2}\\right)\n\\;=\\; y_n\\,\\frac{D + z(1-\\gamma)}{D^2}.\n$$\nSince $\\,D + z(1-\\gamma) = 1 - z\\gamma + z(1-\\gamma) = 1 + z(1 - 2\\gamma)\\,$, we have\n$$\nY_2 \\;=\\; y_n\\,\\frac{1 + z(1 - 2\\gamma)}{D^2}.\n$$\nThe update then gives\n$$\n\\frac{y_{n+1}}{y_n}\n\\;=\\;\n1 \\;+\\; z\\Bigg[(1-\\gamma)\\,\\frac{1}{D} \\;+\\; \\gamma\\,\\frac{1 + z(1 - 2\\gamma)}{D^2}\\Bigg]\n\\;=:\\; R(z).\n$$\nThus the exact stability function is the rational function\n$$\nR(z) \\;=\\; 1 \\;+\\; z\\left[\\frac{1-\\gamma}{1 - z\\gamma} \\;+\\; \\gamma\\,\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\\right].\n$$\nTo determine the order, expand $\\,R(z)\\,$ about $\\,z=0\\,$. Use the binomial series\n$$\n\\frac{1}{1 - z\\gamma} \\;=\\; 1 \\;+\\; z\\gamma \\;+\\; z^2\\gamma^2 \\;+\\; z^3\\gamma^3 \\;+\\; \\mathcal{O}(z^4),\n\\qquad\n\\frac{1}{(1 - z\\gamma)^2} \\;=\\; 1 \\;+\\; 2z\\gamma \\;+\\; 3 z^2\\gamma^2 \\;+\\; \\mathcal{O}(z^3).\n$$\nThen\n$$\n\\frac{1-\\gamma}{1 - z\\gamma}\n\\;=\\;\n(1-\\gamma)\\Big(1 + z\\gamma + z^2\\gamma^2 + \\mathcal{O}(z^3)\\Big)\n\\;=\\;\n(1-\\gamma) \\;+\\; z(1-\\gamma)\\gamma \\;+\\; z^2(1-\\gamma)\\gamma^2 \\;+\\; \\mathcal{O}(z^3).\n$$\nAlso,\n$$\n\\gamma\\,\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\n\\;=\\;\n\\gamma\\Big(1 + z(1 - 2\\gamma)\\Big)\\Big(1 + 2z\\gamma + 3 z^2\\gamma^2 + \\mathcal{O}(z^3)\\Big).\n$$\nMultiplying and retaining up to $\\,\\mathcal{O}(z^2)\\,$,\n$$\n\\gamma\\,\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\n\\;=\\;\n\\gamma\\Big[1 \\;+\\; z\\big(2\\gamma + (1 - 2\\gamma)\\big) \\;+\\; z^2\\big(3\\gamma^2 + 2\\gamma(1 - 2\\gamma)\\big) \\;+\\; \\mathcal{O}(z^3)\\Big]\n$$\n$$\n=\\;\n\\gamma\\Big[1 \\;+\\; z \\;+\\; z^2\\big(2\\gamma - \\gamma^2\\big) \\;+\\; \\mathcal{O}(z^3)\\Big]\n\\;=\\;\n\\gamma \\;+\\; z\\,\\gamma \\;+\\; z^2\\big(2\\gamma^2 - \\gamma^3\\big) \\;+\\; \\mathcal{O}(z^3).\n$$\nCollecting terms inside the bracket of $\\,R(z)\\,$,\n$$\n(1-\\gamma)\\,\\frac{1}{1 - z\\gamma} \\;+\\; \\gamma\\,\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\n\\;=\\;\n\\underbrace{(1-\\gamma) + \\gamma}_{C_1}\n\\;+\\;\nz\\,\\underbrace{\\big((1-\\gamma)\\gamma + \\gamma\\big)}_{C_2}\n\\;+\\;\nz^2\\,\\underbrace{\\big((1-\\gamma)\\gamma^2 + 2\\gamma^2 - \\gamma^3\\big)}_{C_3}\n\\;+\\; \\mathcal{O}(z^3).\n$$\nThus the Taylor expansion of $\\,R(z)\\,$ is\n$$\nR(z) \\;=\\; 1 \\;+\\; z\\,C_1 \\;+\\; z^2\\,C_2 \\;+\\; z^3\\,C_3 \\;+\\; \\mathcal{O}(z^4),\n$$\nwith coefficients\n$$\nC_1 \\;=\\; (1-\\gamma) + \\gamma \\;=\\; 1,\n\\qquad\nC_2 \\;=\\; (1-\\gamma)\\gamma + \\gamma \\;=\\; \\gamma(2 - \\gamma),\n\\qquad\nC_3 \\;=\\; (1-\\gamma)\\gamma^2 + 2\\gamma^2 - \\gamma^3 \\;=\\; 3\\gamma^2 - 2\\gamma^3.\n$$\nTo match $\\,\\exp(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\mathcal{O}(z^4)\\,$ up to order $\\,z^p\\,$, we require\n$$\nC_1 = 1,\\quad C_2 = \\frac{1}{2},\\quad C_3 = \\frac{1}{6},\\;\\ldots\n$$\nThe first condition $\\,C_1=1\\,$ holds identically for any $\\,\\gamma\\,$, confirming consistency. The second-order condition demands\n$$\n\\gamma(2 - \\gamma) \\;=\\; \\frac{1}{2}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\gamma^2 - 2\\gamma + \\frac{1}{2} \\;=\\; 0\n\\;\\;\\Longleftrightarrow\\;\\;\n\\gamma \\;=\\; 1 \\pm \\frac{1}{\\sqrt{2}}.\n$$\nThe admissible singly diagonally implicit choice with $\\,\\gamma>0\\,$ and $\\,\\gamma<1\\,$ is\n$$\n\\gamma \\;=\\; 1 - \\frac{1}{\\sqrt{2}}.\n$$\nWith this choice, check the third-order condition:\n$$\nC_3 \\;=\\; 3\\gamma^2 - 2\\gamma^3 \\;=\\; \\frac{1}{\\sqrt{2}} - \\frac{1}{2} \\;\\neq\\; \\frac{1}{6}.\n$$\nTherefore the third-order condition cannot be satisfied, and the largest integer $\\,p\\,$ such that $\\,R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})\\,$ is $\\,p=2\\,$.\n\nHence, the order of accuracy determined by matching the Taylor series of $\\,R(z)\\,$ to $\\,\\exp(z)\\,$ up to $\\,\\mathcal{O}(z^{p+1})\\,$ is $\\,p=2\\,$.", "answer": "$$\\boxed{2}$$", "id": "3378828"}, {"introduction": "While accuracy is essential, for stiff systems commonly arising from Discontinuous Galerkin (DG) discretizations, stability is paramount. L-stability is a highly desirable property that ensures the method is not only stable for all dissipative dynamics but also strongly damps the stiffest, most rapidly decaying components of the solution. This exercise demonstrates the process of *designing* a numerical method by imposing multiple constraints—stiff accuracy, second-order accuracy, and L-stability—to uniquely determine the coefficients of a powerful and widely used Singly Diagonally Implicit Runge-Kutta (SDIRK) integrator [@problem_id:3378920].", "problem": "A semi-discrete Discontinuous Galerkin (DG) spatial discretization of a linear diffusion operator on a bounded domain yields an ordinary differential equation of the form $\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} = \\boldsymbol{L}\\,\\boldsymbol{u}$, where $\\boldsymbol{L}$ has eigenvalues with large negative real parts due to the stiffness induced by the diffusive fluxes. Consider advancing this system in time using a two-stage Singly Diagonally Implicit Runge-Kutta (SDIRK) method with common diagonal coefficient $\\gamma$ and stiff accuracy, meaning that the last stage equals the step solution and the weights equal the last row of the Runge-Kutta matrix.\n\nLet the Butcher matrix be $\\boldsymbol{A} = \\begin{pmatrix}\\gamma & 0 \\\\ a_{21} & \\gamma\\end{pmatrix}$ with weights $\\boldsymbol{b} = \\begin{pmatrix}b_{1} \\\\ b_{2}\\end{pmatrix}$ satisfying stiff accuracy $\\boldsymbol{b}^{\\top} = \\begin{pmatrix}a_{21} & \\gamma\\end{pmatrix}$, and abscissae $\\boldsymbol{c} = \\begin{pmatrix}c_{1} \\\\ c_{2}\\end{pmatrix}$ given by $c_{i} = \\sum_{j} a_{ij}$. Assume the method is exactly second-order accurate.\n\nStarting from the scalar linear test equation $\\frac{\\mathrm{d} u}{\\mathrm{d} t} = \\lambda u$, define the stability function $R(z)$ with $z = h \\lambda$ by applying the two-stage SDIRK update with stiff accuracy. Impose the requirement of $L$-stability for stiff systems, taken here as the combination of $A$-stability (the region $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\le 0\\}$ is contained in the stability region $\\{z : |R(z)| \\le 1\\}$) and $\\lim_{|z|\\to\\infty} R(z) = 0$. Additionally require the abscissae to represent stage times within the step, $0 \\le c_{i} \\le 1$.\n\nDetermine the unique value of $\\gamma$ that satisfies stiff accuracy, second-order accuracy, and $L$-stability under the above constraints. Express your final answer as a closed-form analytic expression for $\\gamma$.", "solution": "The user wants to find a specific parameter of a Singly Diagonally Implicit Runge-Kutta (SDIRK) method.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   The governing Ordinary Differential Equation (ODE) is of the form $\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} = \\boldsymbol{L}\\,\\boldsymbol{u}$.\n-   The time integration method is a two-stage SDIRK method.\n-   The Butcher matrix $\\boldsymbol{A}$ has the structure $\\boldsymbol{A} = \\begin{pmatrix}\\gamma & 0 \\\\ a_{21} & \\gamma\\end{pmatrix}$.\n-   The method has stiff accuracy, which is defined as the weights $\\boldsymbol{b}$ being equal to the last row of the Runge-Kutta matrix. For a two-stage method ($s=2$), this means $\\boldsymbol{b}^{\\top} = \\begin{pmatrix}a_{21} & a_{22}\\end{pmatrix}$. Given the structure of $\\boldsymbol{A}$, this implies $b_1 = a_{21}$ and $b_2 = \\gamma$.\n-   The abscissae $\\boldsymbol{c}$ are given by the row-sum condition $c_i = \\sum_{j} a_{ij}$.\n-   The method is required to be exactly second-order accurate.\n-   The stability analysis is performed on the scalar linear test equation $\\frac{\\mathrm{d} u}{\\mathrm{d} t} = \\lambda u$, with $z = h \\lambda$.\n-   The stability requirement is $L$-stability, which is defined as the combination of:\n    1.  $A$-stability: The stability region $\\{z : |R(z)| \\le 1\\}$ contains the left-half of the complex plane $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\le 0\\}$.\n    2.  Asymptotic behavior: $\\lim_{|z|\\to\\infty} R(z) = 0$.\n-   The abscissae are constrained to lie within the time step interval: $0 \\le c_{i} \\le 1$.\n\n**1.2. Validate Using Extracted Givens**\nThe problem is set within the standard framework of numerical analysis for stiff ODEs. All terms used (SDIRK, Butcher tableau, stiff accuracy, order conditions, L-stability) are well-defined and standard in the field. The problem asks for a unique parameter value based on a set of mathematical constraints. An initial check shows that these constraints are likely to be consistent and sufficient to determine a unique solution. The problem is scientifically grounded, well-posed, objective, and formalizable. There are no apparent violations of the validation criteria.\n\n**1.3. Verdict and Action**\nThe problem is deemed valid. A full, reasoned solution will be provided.\n\n### Step 2: Solution Derivation\n\nThe goal is to determine the unique value of the diagonal coefficient $\\gamma$ by imposing the given constraints.\n\n**2.1. Algebraic Constraints from Method Properties**\nFirst, we translate the properties of the Runge-Kutta method into a system of algebraic equations for its coefficients.\n\n-   **Stiff Accuracy**: The weights $\\boldsymbol{b}$ are given by the second row of $\\boldsymbol{A}$:\n    $b_1 = a_{21}$\n    $b_2 = \\gamma$\n-   **Abscissae**: The abscissae $c_i$ are the row sums of $\\boldsymbol{A}$:\n    $c_1 = a_{11} + a_{12} = \\gamma + 0 = \\gamma$\n    $c_2 = a_{21} + a_{22} = a_{21} + \\gamma$\n\n**2.2. Order of Accuracy Conditions**\nFor a Runge-Kutta method to be of a certain order, its coefficients must satisfy a set of equations known as order conditions.\n\n-   **First-Order Condition**: $\\sum_{i=1}^{2} b_i = 1$.\n    Substituting the expressions for $b_1$ and $b_2$:\n    $a_{21} + \\gamma = 1$\n    This allows us to express $a_{21}$ in terms of $\\gamma$:\n    $a_{21} = 1 - \\gamma$\n    Using this result, we can find a fixed value for $c_2$:\n    $c_2 = a_{21} + \\gamma = (1 - \\gamma) + \\gamma = 1$\n\n-   **Second-Order Condition**: $\\sum_{i=1}^{2} b_i c_i = \\frac{1}{2}$.\n    Substituting the expressions for $b_i$ and $c_i$:\n    $b_1 c_1 + b_2 c_2 = \\frac{1}{2}$\n    $(a_{21})(\\gamma) + (\\gamma)(1) = \\frac{1}{2}$\n    Now, substitute $a_{21} = 1 - \\gamma$:\n    $(1 - \\gamma)\\gamma + \\gamma = \\frac{1}{2}$\n    $\\gamma - \\gamma^2 + \\gamma = \\frac{1}{2}$\n    $2\\gamma - \\gamma^2 = \\frac{1}{2}$\n    Rearranging this gives a quadratic equation for $\\gamma$:\n    $\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0$\n    Multiplying by $2$ gives $2\\gamma^2 - 4\\gamma + 1 = 0$.\n\n**2.3. Solving for $\\gamma$ and Applying Constraints**\nWe solve the quadratic equation for $\\gamma$ using the quadratic formula:\n$\\gamma = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(2)(1)}}{2(2)} = \\frac{4 \\pm \\sqrt{16-8}}{4} = \\frac{4 \\pm 2\\sqrt{2}}{4}$\nThis yields two possible solutions for $\\gamma$:\n$\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2}$\n$\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2}$\n\nNext, we apply the constraint on the abscissae: $0 \\le c_i \\le 1$.\nWe have $c_1 = \\gamma$ and $c_2 = 1$.\nThe constraint $0 \\le c_2 \\le 1$ is satisfied since $c_2=1$.\nThe constraint $0 \\le c_1 \\le 1$ requires $0 \\le \\gamma \\le 1$.\nWe check which of the two solutions for $\\gamma$ satisfies this condition:\n-   For $\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\approx 1 - 0.7071 = 0.2929$. This value lies in the interval $[0, 1]$.\n-   For $\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} \\approx 1 + 0.7071 = 1.7071$. This value does not lie in the interval $[0, 1]$.\n\nTherefore, the only value of $\\gamma$ that satisfies the requirements of second-order accuracy, stiff accuracy, and the constraint on the abscissae is $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$.\n\n**2.4. Verification of L-stability**\nFinally, we must verify that this unique value of $\\gamma$ also yields an $L$-stable method.\nThe stability function $R(z)$ for an $s$-stage SDIRK method is given by $R(z) = 1 + z \\boldsymbol{b}^\\top (\\boldsymbol{I} - z\\boldsymbol{A})^{-1} \\boldsymbol{1}$. For the two-stage, second-order accurate SDIRK method with stiff accuracy, it can be shown that the stability function simplifies to:\n$R(z) = \\frac{1 + z(1-2\\gamma)}{(1-\\gamma z)^2}$\nHere, the condition $2\\gamma - \\gamma^2 = \\frac{1}{2}$ from the second-order accuracy requirement has been used to establish the general form of $R(z)$'s Taylor series matching $e^z$ up to the $z^2$ term.\n\nWe check the two conditions for $L$-stability for $\\gamma=1-\\frac{\\sqrt{2}}{2}$:\n\n1.  **Asymptotic behavior**: We need $\\lim_{|z|\\to\\infty} R(z) = 0$.\n    $R(z)$ is a rational function of $z$. The degree of the numerator is $1$ and the degree of the denominator is $2$. As long as the leading coefficient of the denominator polynomial, $\\gamma^2$, is non-zero, the limit as $|z|\\to\\infty$ will be $0$.\n    Our value is $\\gamma = 1 - \\frac{\\sqrt{2}}{2} \\ne 0$, so this condition is met.\n\n2.  **A-stability**: We need $|R(z)| \\le 1$ for all $z$ with $\\operatorname{Re}(z) \\le 0$. By the maximum modulus principle, it is sufficient to check this on the boundary, i.e., for $z=iy$ where $y \\in \\mathbb{R}$.\n    $|R(iy)|^2 = \\frac{|1 + iy(1-2\\gamma)|^2}{|(1 - iy\\gamma)^2|^2} = \\frac{1^2 + (y(1-2\\gamma))^2}{((1 - iy\\gamma)(1+iy\\gamma))^2} = \\frac{1 + y^2(1-2\\gamma)^2}{(1+y^2\\gamma^2)^2}$\n    The condition $|R(iy)|^2 \\le 1$ becomes:\n    $1 + y^2(1-4\\gamma+4\\gamma^2) \\le 1 + 2y^2\\gamma^2 + y^4\\gamma^4$\n    $y^2(1-4\\gamma+4\\gamma^2) \\le 2y^2\\gamma^2 + y^4\\gamma^4$\n    For $y \\ne 0$, we can divide by $y^2$:\n    $1-4\\gamma+4\\gamma^2 \\le 2\\gamma^2 + y^2\\gamma^4$\n    $2\\gamma^2 - 4\\gamma + 1 \\le y^2\\gamma^4$\n    This inequality must hold for all $y \\in \\mathbb{R}$. Since the right-hand side can be arbitrarily close to $0$ (for small $y$), the left-hand side must be less than or equal to $0$.\n    $2\\gamma^2 - 4\\gamma + 1 \\le 0$\n    The roots of the quadratic $2\\gamma^2 - 4\\gamma + 1 = 0$ are precisely $1 \\pm \\frac{\\sqrt{2}}{2}$. Since the parabola $p(\\gamma)=2\\gamma^2 - 4\\gamma + 1$ opens upwards, the inequality $p(\\gamma) \\le 0$ holds for $\\gamma$ between its roots, i.e., $\\gamma \\in [1 - \\frac{\\sqrt{2}}{2}, 1 + \\frac{\\sqrt{2}}{2}]$.\n    Our selected value $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ lies at the boundary of this interval. For this value, $2\\gamma^2 - 4\\gamma + 1 = 0$, so the inequality becomes $0 \\le y^2\\gamma^4$, which is always true since $y^2 \\ge 0$ and $\\gamma \\ne 0$. Thus, the method is A-stable.\n\nSince both conditions are met, the method is indeed $L$-stable for $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$.\n\nAll conditions specified in the problem statement are satisfied by this unique value of $\\gamma$.", "answer": "$$\\boxed{1 - \\frac{\\sqrt{2}}{2}}$$", "id": "3378920"}, {"introduction": "For numerical methods applied to systems modeling dissipative physical processes, we intuitively expect the numerical solution's energy or norm to also decay over time. This property, known as contractivity, is guaranteed by a strong condition called algebraic stability. This exercise explores a counter-intuitive scenario where a seemingly reasonable DIRK method violates algebraic stability, leading to a surprising loss of contractivity and solution growth even when applied to a simple, dissipative test problem [@problem_id:3378945].", "problem": "Consider the semi-discrete ordinary differential equation obtained from a Discontinuous Galerkin (DG) spatial discretization of a linear convection-diffusion operator, which under standard upwind numerical fluxes and appropriate spectral filtering has a matrix generator with spectrum in the closed left half-plane. For the scalar test equation, this reduces to the linear model problem $u'(t)=\\lambda u(t)$ with $\\operatorname{Re}(\\lambda)\\le 0$. Time integration is performed using a Diagonally Implicit Runge-Kutta (DIRK) method with Butcher tableau\n$$\n\\begin{array}{c|cc}\na & a & 0 \\\\\na+c & c & a \\\\\n\\hline\n & b_1 & b_2\n\\end{array}\n$$\nwhere $A=\\begin{pmatrix} a & 0 \\\\ c & a \\end{pmatrix}$ is lower triangular with identical diagonal entries, and $b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$. Let a specific choice be $a=\\frac{1}{2}$, $c=3$, $b_1=0$, and $b_2=1$, so the stage abscissae are $c_1=a$ and $c_2=a+c$. \n\nStarting from the core definitions of Runge-Kutta methods and algebraic stability, do the following:\n- Explain the notion of algebraic stability via the symmetric matrix condition $M=B A + A^{\\top} B - b b^{\\top}$, where $B=\\operatorname{diag}(b_1,b_2)$, and show that the given DIRK tableau violates algebraic stability.\n- For the linear test equation $u'=\\lambda u$, define the Runge-Kutta stability function $R(z)$ by the amplification relation $u^{n+1}=R(z)\\,u^n$ with $z=h\\lambda$, and derive $R(z)$ symbolically for the given DIRK tableau in terms of $z$.\n- Use $R(z)$ to predict the loss of contractivity along the negative real axis by evaluating the amplification factor at $z=-2$ and determining $|R(-2)|$.\n\nProvide the value of $|R(-2)|$ as an exact number without rounding. No physical units are required.", "solution": "We first recall fundamental properties of Runge-Kutta (RK) methods relevant to contractivity and algebraic stability. A RK method with coefficient matrix $A\\in\\mathbb{R}^{s\\times s}$ and weights $b\\in\\mathbb{R}^s$ is algebraically stable if $b_i\\ge 0$ for all $i$ and the symmetric matrix\n$$\nM \\equiv B A + A^{\\top} B - b b^{\\top}, \\quad B=\\operatorname{diag}(b_1,\\dots,b_s),\n$$\nis positive semidefinite. For a $2$-stage DIRK with\n$$\nA=\\begin{pmatrix} a & 0 \\\\ c & a \\end{pmatrix}, \\quad b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix},\n$$\nwe compute $M$ explicitly for the given numerical values $a=\\frac{1}{2}$, $c=3$, $b_1=0$, $b_2=1$. \n\nCompute $B A$ by left-multiplying $A$ with $B=\\operatorname{diag}(0,1)$, which scales the rows:\n$$\nB A = \\begin{pmatrix} 0 & 0 \\\\ 3 & \\frac{1}{2} \\end{pmatrix}.\n$$\nCompute $A^{\\top} B$ by right-multiplying $A^{\\top}$ with $B$, which scales the columns. Since\n$$\nA^{\\top}=\\begin{pmatrix} \\frac{1}{2} & 3 \\\\ 0 & \\frac{1}{2} \\end{pmatrix},\n$$\nwe have\n$$\nA^{\\top} B = \\begin{pmatrix} \\frac{1}{2}\\cdot 0 & 3\\cdot 1 \\\\ 0\\cdot 0 & \\frac{1}{2}\\cdot 1 \\end{pmatrix}\n= \\begin{pmatrix} 0 & 3 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}.\n$$\nFinally, \n$$\nb b^{\\top} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\begin{pmatrix} 0 & 1 \\end{pmatrix}\n= \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\nTherefore,\n$$\nM = B A + A^{\\top} B - b b^{\\top}\n= \\begin{pmatrix} 0 & 0 \\\\ 3 & \\frac{1}{2} \\end{pmatrix}\n+ \\begin{pmatrix} 0 & 3 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}\n- \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}\n= \\begin{pmatrix} 0 & 3 \\\\ 3 & 0 \\end{pmatrix}.\n$$\nThe eigenvalues of $M$ are the roots of the characteristic polynomial $\\det(M-\\mu I)=\\mu^2-9$, hence $\\mu=\\pm 3$. Since $M$ has a negative eigenvalue, $M$ is not positive semidefinite, and the DIRK tableau violates algebraic stability. This violation implies that, even for dissipative linear problems (such as semi-discrete DG systems with $\\operatorname{Re}(\\lambda)\\le 0$), contractivity can be lost for some step sizes.\n\nNext, we derive the Runge-Kutta stability function $R(z)$ for the linear test equation $u'=\\lambda u$ with $z=h\\lambda$. For a general RK method, the amplification factor is given by the standard formula\n$$\nR(z) = 1 + z\\, b^{\\top} (I - z A)^{-1} e,\n$$\nwhere $e=(1,\\dots,1)^{\\top}$. For our $2$-stage DIRK, $e=\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ and\n$$\nI - z A = \\begin{pmatrix} 1 - z a & 0 \\\\ - z c & 1 - z a \\end{pmatrix}.\n$$\nLet $\\alpha \\equiv 1 - z a$ and $\\beta \\equiv - z c$. The inverse of a lower triangular matrix of the form $\\begin{pmatrix} \\alpha & 0 \\\\ \\beta & \\alpha \\end{pmatrix}$ is\n$$\n\\begin{pmatrix} \\alpha^{-1} & 0 \\\\ -\\beta \\alpha^{-2} & \\alpha^{-1} \\end{pmatrix}.\n$$\nTherefore,\n$$\n(I - z A)^{-1} e\n= \\begin{pmatrix} \\alpha^{-1} & 0 \\\\ -\\beta \\alpha^{-2} & \\alpha^{-1} \\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} \\alpha^{-1} \\\\ -\\beta \\alpha^{-2} + \\alpha^{-1} \\end{pmatrix}\n= \\begin{pmatrix} \\alpha^{-1} \\\\ z c\\, \\alpha^{-2} + \\alpha^{-1} \\end{pmatrix}.\n$$\nWith $b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$, we have\n$$\nb^{\\top} (I - z A)^{-1} e\n= b_1\\, \\alpha^{-1} + b_2\\left( z c\\, \\alpha^{-2} + \\alpha^{-1} \\right)\n= (b_1 + b_2)\\, \\alpha^{-1} + b_2\\, z c\\, \\alpha^{-2}.\n$$\nSubstituting into $R(z)$ gives the symbolic form\n$$\nR(z) = 1 + z\\, \\frac{b_1 + b_2}{1 - z a} + b_2\\, c\\, \\frac{z^{2}}{(1 - z a)^{2}}.\n$$\nFor our specific coefficients $a=\\frac{1}{2}$, $c=3$, $b_1=0$, $b_2=1$, the stability function reduces to\n$$\nR(z) = 1 + \\frac{z}{1 - \\frac{z}{2}} + \\frac{3 z^{2}}{\\left(1 - \\frac{z}{2}\\right)^{2}}.\n$$\nTo quantify the loss of contractivity along the negative real axis, we evaluate at $z=-2$. Then $1 - \\frac{z}{2}=1 - \\left( -1 \\right)=2$, so\n$$\nR(-2) = 1 + \\frac{-2}{2} + \\frac{3\\cdot (-2)^{2}}{2^{2}}\n= 1 - 1 + \\frac{3\\cdot 4}{4}\n= 0 + 3\n= 3.\n$$\nHence $|R(-2)|=3$, which is strictly greater than $1$. This demonstrates the loss of contractivity: for a dissipative mode with $z=-2$, the method amplifies the solution by a factor of $3$ in one time step, consistent with the violation of algebraic stability found above.", "answer": "$$\\boxed{3}$$", "id": "3378945"}]}