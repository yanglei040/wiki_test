{"hands_on_practices": [{"introduction": "In spectral element methods, the choice of nodal points is a critical design decision with far-reaching consequences for the properties of the discrete system. This exercise explores the profound differences between using Gauss-Legendre (GL) nodes, which are interior to an element, and Gauss-Lobatto-Legendre (GLL) nodes, which include the element's endpoints. By analyzing the resulting mass matrix in each case, you will discover why mass lumping emerges as an approximation for GLL elements but not for GL elements, a distinction fundamental to understanding accuracy, stability, and the treatment of boundary fluxes in modern high-order methods [@problem_id:3398337].", "problem": "Consider a one-dimensional (1D) spectral element discretization on the reference interval $[-1,1]$ using a nodal Lagrange basis of polynomial degree $N$ built from $N+1$ distinct nodes $\\{x_i\\}_{i=0}^{N}$, with corresponding Lagrange polynomials $\\{\\ell_i(x)\\}_{i=0}^{N}$ satisfying $\\ell_i(x_j)=\\delta_{ij}$. The element-wise mass matrix is defined by $M_{ij}=\\int_{-1}^{1}\\ell_i(x)\\,\\ell_j(x)\\,\\mathrm{d}x$. In a collocation spectral element formulation, volume integrals are approximated by the same quadrature rule whose nodes coincide with the interpolation nodes. Two choices of nodes are considered:\n\n- Gauss–Legendre (GL) nodes, which do not include the endpoints $x=-1$ and $x=1$.\n- Gauss–Lobatto–Legendre (GLL) nodes, which include the endpoints $x=-1$ and $x=1$.\n\nIt is a well-tested fact that a Gauss–Legendre quadrature rule with $m$ points is exact for integrands that are polynomials of degree up to $2m-1$, while a Gauss–Lobatto–Legendre quadrature rule with $m$ points is exact for integrands that are polynomials of degree up to $2m-3$. In addition, in a Discontinuous Galerkin (DG) formulation, the semi-discrete equations on each element involve both volume integrals and surface integrals of numerical fluxes $f^*$ evaluated on the element boundaries $x=-1$ and $x=1$, with the boundary contributions entering as penalty-like terms that must be represented in the discrete system.\n\nStarting from these foundational facts, compare the mass-diagonalization outcome under collocation when using GL nodes versus GLL nodes, and explain the implications for incorporating boundary fluxes $f^*$ in the DG method. Which of the following statements are correct?\n\nA. With GLL nodes and collocated GLL quadrature, the mass matrix is diagonal under the quadrature-based inner product, but this diagonalization arises from inexact integration of $\\ell_i(x)\\ell_j(x)$ when $N\\geq 1$; because the nodes include the endpoints, numerical fluxes $f^*$ at $x=-1$ and $x=1$ can be imposed directly at nodal points, and the resulting scheme admits discrete energy estimates through a Summation-by-Parts (SBP) norm based on the diagonal quadrature weights.\n\nB. With GL nodes and collocated GL quadrature, the mass matrix is diagonal and equal to the exact continuous inner product because the product $\\ell_i(x)\\ell_j(x)$ has degree at most $2N$ and GL quadrature with $N+1$ points is exact up to degree $2N+1$; since the nodes do not include the endpoints, the surface fluxes $f^*$ must be incorporated via a lifting or extrapolation operator that maps boundary data into the volume degrees of freedom, and when constructed to satisfy a generalized SBP property, this preserves conservation and energy stability.\n\nC. With GL nodes, a diagonal mass matrix cannot be obtained under any collocation quadrature, so any attempt at mass lumping necessarily reduces the formal order of accuracy of the volume discretization.\n\nD. With GLL nodes, the diagonal mass matrix obtained from collocated quadrature coincides with the exact continuous inner product if and only if $N$ is odd; for even $N$ it is inexact, and for odd $N$ it is exact.\n\nE. With GL nodes, boundary fluxes $f^*$ can be incorporated without any lifting operator by simply evaluating $f^*$ at the interior nodes closest to the boundaries, and this preserves high-order accuracy and energy stability in the DG method.", "solution": "The problem statement will first be validated for scientific soundness, consistency, and completeness before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem provides the following definitions, conditions, and facts:\n-   **Discretization**: A one-dimensional (1D) spectral element method on the reference interval $[-1,1]$.\n-   **Basis**: A nodal Lagrange basis of polynomial degree $N$ built from $N+1$ distinct nodes $\\{x_i\\}_{i=0}^{N}$. The basis polynomials $\\{\\ell_i(x)\\}_{i=0}^{N}$ satisfy the cardinality property $\\ell_i(x_j)=\\delta_{ij}$.\n-   **Mass Matrix**: The element-wise continuous mass matrix is defined by the integral $M_{ij}=\\int_{-1}^{1}\\ell_i(x)\\,\\ell_j(x)\\,\\mathrm{d}x$.\n-   **Collocation and Quadrature**: In a collocation formulation, volume integrals are approximated by a quadrature rule whose nodes are identical to the interpolation nodes. The number of quadrature points is therefore $m=N+1$.\n-   **Node Sets**:\n    -   Gauss–Legendre (GL) nodes: These $N+1$ nodes are located in the open interval $(-1,1)$.\n    -   Gauss–Lobatto–Legendre (GLL) nodes: These $N+1$ nodes are located in the closed interval $[-1,1]$ and include the endpoints, $x_0=-1$ and $x_N=1$.\n-   **Quadrature Exactness**:\n    -   A Gauss–Legendre quadrature rule with $m$ points is exact for polynomial integrands of degree up to $2m-1$.\n    -   A Gauss–Lobatto–Legendre quadrature rule with $m$ points is exact for polynomial integrands of degree up to $2m-3$.\n-   **DG Method Context**: For a Discontinuous Galerkin (DG) method, the formulation involves both volume integrals and surface integrals of a numerical flux $f^*$ at the element boundaries $x=-1$ and $x=1$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is scrutinized against the validation criteria:\n\n-   **Scientifically Grounded**: The problem is firmly rooted in the established theory of spectral and discontinuous Galerkin methods, which are advanced topics in numerical analysis for partial differential equations. All definitions provided (Lagrange basis, mass matrix, GL/GLL nodes, quadrature rules, DG method components) are standard and correct. The stated degrees of exactness for GL and GLL quadrature are fundamental, textbook facts in this field.\n-   **Well-Posed**: The problem is structured as a comparative analysis of two standard techniques (GL vs. GLL nodes) within a specified context (collocation spectral elements). It requests an evaluation of several statements based on the provided facts. The question is unambiguous and permits a definitive logical deduction.\n-   **Objective**: The language is technical, precise, and free from subjective or biased phrasing. It presents a standard scenario in computational science.\n\nThe problem statement exhibits none of the invalidating flaws:\n1.  **Scientific or Factual Unsoundness**: The premises are factually correct.\n2.  **Non-Formalizable or Irrelevant**: The problem is a formal exercise in applied mathematics, directly relevant to its stated topic.\n3.  **Incomplete or Contradictory Setup**: The information is sufficient and self-consistent. The relationship $m=N+1$ is implicit in the collocation setup and is a standard convention.\n4.  **Unrealistic or Infeasible**: The methods described are widely used in scientific computing.\n5.  **Ill-Posed or Poorly Structured**: The terminology is standard and the question is clear.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The question requires non-trivial knowledge and reasoning about the interplay between interpolation, quadrature, and boundary conditions in high-order methods.\n7.  **Outside Scientific Verifiability**: The claims are mathematically verifiable.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. A full solution and option analysis will be performed.\n\n### Derivation and Option Analysis\n\nThe core of the problem relates to the properties of the mass matrix under a collocation quadrature scheme. In this scheme, the integral defining the mass matrix is approximated using a quadrature rule whose points $\\{x_k\\}_{k=0}^N$ and weights $\\{w_k\\}_{k=0}^N$ are used to evaluate the integral. The basis functions are the Lagrange polynomials $\\{\\ell_i(x)\\}_{i=0}^N$ associated with these same points.\n\nThe approximated mass matrix, denoted $\\tilde{M}$, has entries:\n$$ \\tilde{M}_{ij} = \\sum_{k=0}^{N} w_k \\, \\ell_i(x_k) \\ell_j(x_k) $$\nBy the definition of the Lagrange basis, $\\ell_i(x_k) = \\delta_{ik}$. Substituting this into the sum gives:\n$$ \\tilde{M}_{ij} = \\sum_{k=0}^{N} w_k \\, \\delta_{ik} \\delta_{jk} $$\nThe sum is non-zero only when $k=i$ and $k=j$. For this to happen, it must be that $i=j$. Thus, the expression simplifies to:\n$$ \\tilde{M}_{ij} = w_i \\delta_{ij} $$\nThis shows that using a quadrature scheme collocated with the nodal basis functions *always* results in a diagonal, or \"lumped\", mass matrix $\\tilde{M} = \\mathrm{diag}(w_0, w_1, \\dots, w_N)$.\n\nThe critical question is whether this diagonal matrix $\\tilde{M}$ is equal to the exact, continuous mass matrix $M$. This equality, $\\tilde{M}_{ij} = M_{ij}$, holds if and only if the quadrature rule is exact for the integrand $\\ell_i(x)\\ell_j(x)$. The degree of the Lagrange polynomial $\\ell_i(x)$ is $N$. Therefore, the product $\\ell_i(x)\\ell_j(x)$ is a polynomial of degree at most $N+N = 2N$.\n\nWe now analyze the two cases based on the choice of nodes and the corresponding quadrature rule. In both cases, the number of points is $m=N+1$.\n\n**Case 1: Gauss–Lobatto–Legendre (GLL) Nodes**\n\n-   **Quadrature Exactness**: With $m=N+1$ points, the GLL quadrature rule is exact for polynomials of degree up to $2m-3 = 2(N+1)-3 = 2N-1$.\n-   **Mass Matrix Integration**: The integrand $\\ell_i(x)\\ell_j(x)$ is a polynomial of degree up to $2N$. For the quadrature to be exact, we would need the degree of the integrand to be less than or equal to the degree of exactness, i.e., $2N \\le 2N-1$. This inequality is false for any non-negative integer $N$. Specifically for $N \\ge 1$, $2N > 2N-1$, so the integration is **inexact**.\n-   **Conclusion**: For GLL nodes, the collocated quadrature produces a diagonal mass matrix, but this is an approximation to the true continuous mass matrix, which is not diagonal. This procedure is known as mass lumping.\n-   **DG Implications**: Since GLL nodes include the endpoints $x=-1$ and $x=1$, degrees of freedom exist at the element boundaries. This allows the numerical fluxes $f^*$ to be incorporated directly into the discrete equations corresponding to the boundary nodes. Furthermore, the combination of the GLL differentiation matrix and the diagonal GLL quadrature weight matrix forms a Summation-by-Parts (SBP) operator, which is a cornerstone for proving numerical stability via discrete energy estimates.\n\n**Case 2: Gauss–Legendre (GL) Nodes**\n\n-   **Quadrature Exactness**: With $m=N+1$ points, the GL quadrature rule is exact for polynomials of degree up to $2m-1 = 2(N+1)-1 = 2N+1$.\n-   **Mass Matrix Integration**: The integrand $\\ell_i(x)\\ell_j(x)$ has a degree of at most $2N$. Since $2N \\le 2N+1$, the GL quadrature integrates the product exactly.\n-   **Conclusion**: For GL nodes, the collocated quadrature not only produces a diagonal matrix $\\tilde{M}_{ij} = w_i \\delta_{ij}$ but also yields the *exact* value of the integral. Therefore, the exact continuous mass matrix $M$ is itself diagonal: $M_{ij} = w_i \\delta_{ij}$. There is no approximation involved; the mass matrix is naturally diagonal.\n-   **DG Implications**: Since GL nodes lie strictly inside the interval $(-1,1)$, there are no degrees of freedom at the element boundaries. The influence of the boundary flux $f^*$ must be communicated to the interior degrees of freedom. This is achieved by evaluating the boundary terms in the weak formulation, $[f^*v_h]_{-1}^{1}$, which act as a source term for the interior equations. This procedure can be formalized through a \"lifting operator\" that maps data from the boundary into the volume. To ensure stability and conservation, this lifting operator must be constructed carefully, often to satisfy a generalized SBP property in conjunction with the interior discretization.\n\nWith this analysis complete, we evaluate each statement.\n\n**A. With GLL nodes and collocated GLL quadrature, the mass matrix is diagonal under the quadrature-based inner product, but this diagonalization arises from inexact integration of $\\ell_i(x)\\ell_j(x)$ when $N\\geq 1$; because the nodes include the endpoints, numerical fluxes $f^*$ at $x=-1$ and $x=1$ can be imposed directly at nodal points, and the resulting scheme admits discrete energy estimates through a Summation-by-Parts (SBP) norm based on the diagonal quadrature weights.**\nThis statement aligns perfectly with our analysis of the GLL case. The diagonalization is a result of inexact quadrature for $N \\ge 1$. The presence of boundary nodes allows for direct imposition of fluxes. The scheme's stability relies on the SBP property where the diagonal quadrature matrix serves as the norm.\n**Verdict: Correct.**\n\n**B. With GL nodes and collocated GL quadrature, the mass matrix is diagonal and equal to the exact continuous inner product because the product $\\ell_i(x)\\ell_j(x)$ has degree at most $2N$ and GL quadrature with $N+1$ points is exact up to degree $2N+1$; since the nodes do not include the endpoints, the surface fluxes $f^*$ must be incorporated via a lifting or extrapolation operator that maps boundary data into the volume degrees of freedom, and when constructed to satisfy a generalized SBP property, this preserves conservation and energy stability.**\nThis statement aligns perfectly with our analysis of the GL case. The mass matrix is naturally and exactly diagonal due to the high precision of GL quadrature. The absence of boundary nodes necessitates a lifting-type operator for fluxes, and stability can be proven through a generalized SBP framework.\n**Verdict: Correct.**\n\n**C. With GL nodes, a diagonal mass matrix cannot be obtained under any collocation quadrature, so any attempt at mass lumping necessarily reduces the formal order of accuracy of the volume discretization.**\nThis statement is false. As shown in our analysis of the GL case and in statement B, using collocated GL quadrature results in a mass matrix that is not only diagonal but also an exact representation of the continuous one. The premise is incorrect.\n**Verdict: Incorrect.**\n\n**D. With GLL nodes, the diagonal mass matrix obtained from collocated quadrature coincides with the exact continuous inner product if and only if $N$ is odd; for even $N$ it is inexact, and for odd $N$ it is exact.**\nThis statement is false. Our analysis showed that for GLL nodes, the collocated quadrature is inexact for the mass matrix integrand whenever $N \\ge 1$, because the integrand degree ($2N$) exceeds the quadrature's exactness degree ($2N-1$). This is true for all integers $N \\ge 1$, irrespective of parity.\n**Verdict: Incorrect.**\n\n**E. With GL nodes, boundary fluxes $f^*$ can be incorporated without any lifting operator by simply evaluating $f^*$ at the interior nodes closest to the boundaries, and this preserves high-order accuracy and energy stability in the DG method.**\nThis statement describes a completely ad-hoc and incorrect method for handling boundary conditions. Applying a flux defined at $x=\\pm 1$ as a source term for an interior node is a violation of the mathematical formulation of the DG method. Such a procedure would destroy the high-order accuracy of the scheme and would not be energy stable, as it breaks the underlying structure (e.g., SBP properties) required for stability proofs.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{AB}$$", "id": "3398337"}, {"introduction": "Having established the theoretical context for mass lumping in GLL-based elements, this practice provides a concrete, hands-on calculation to solidify the concept. You will construct the diagonal lumped mass matrix for a spectral element with polynomial degree $N=4$ from first principles. The exercise guides you through deriving the GLL node locations from the roots of the Legendre polynomial's derivative and then computing the corresponding quadrature weights, which are the essential components of the lumped mass matrix [@problem_id:3398294]. This process demystifies the origin of these critical numerical ingredients.", "problem": "Consider the reference one-dimensional spectral element on the interval $[-1,1]$ with Lagrange interpolation basis functions built on the Gauss–Lobatto–Legendre (GLL) nodes associated with polynomial degree $N=4$. Let $\\{\\phi_i(x)\\}_{i=0}^{N}$ denote the nodal Lagrange basis functions associated with the $N+1$ GLL nodes $\\{\\xi_i\\}_{i=0}^{N}$, where the endpoints $x=-1$ and $x=1$ are included and the interior nodes are the roots of the derivative of the Legendre polynomial of degree $N$. The continuous spectral element mass matrix on the reference element is defined by\n$$\nM_{ij} \\;=\\; \\int_{-1}^{1} \\phi_i(x)\\,\\phi_j(x)\\,\\mathrm{d}x.\n$$\nIn mass-lumped spectral elements and in the Discontinuous Galerkin (DG) method, a common diagonal approximation to $M_{ij}$ is obtained by applying GLL quadrature on the same GLL nodes, yielding diagonal entries that depend on the quadrature weights.\n\nStarting from the defining properties of Legendre polynomials and the GLL construction (endpoints included and interior nodes given by the roots of the derivative of the Legendre polynomial of degree $N$), and using only these fundamental relationships and exact integration requirements for polynomials, do the following for $N=4$ on the reference element $[-1,1]$:\n- determine the $N+1$ GLL nodes $\\{\\xi_i\\}_{i=0}^{N}$,\n- compute the corresponding GLL quadrature weights $\\{w_i\\}_{i=0}^{N}$, and\n- assemble the diagonal entries of the lumped mass matrix, defined by applying the GLL quadrature to $M_{ii}$ on the reference element.\n\nExpress your final answer as a single ordered row vector listing the five diagonal lumped mass entries from the leftmost node ($x=-1$) to the rightmost node ($x=1$). Provide exact rational values; no rounding is required. The final answer must be given as a single analytic expression.", "solution": "The problem requires the determination of the diagonal entries of the lumped mass matrix for a one-dimensional spectral element on the reference interval $[-1, 1]$ using a polynomial basis of degree $N=4$. This task involves three main steps: first, finding the Gauss-Lobatto-Legendre (GLL) nodes; second, computing the corresponding GLL quadrature weights; and third, assembling the lumped mass matrix entries, which, as will be shown, are identical to the quadrature weights.\n\nThe GLL nodes $\\{\\xi_i\\}_{i=0}^N$ for a polynomial of degree $N$ are defined on the interval $[-1, 1]$. The set of nodes includes the endpoints $\\xi_0 = -1$ and $\\xi_N = 1$. The $N-1$ interior nodes are the roots of the first derivative of the Legendre polynomial of degree $N$, denoted as $P'_N(x)$. For this problem, $N=4$.\n\nFirst, we must determine the Legendre polynomial $P_4(x)$. The Legendre polynomials $P_n(x)$ can be generated using the Bonnet recurrence relation:\n$$ (n+1)P_{n+1}(x) = (2n+1)xP_n(x) - nP_{n-1}(x) $$\nwith the starting polynomials $P_0(x) = 1$ and $P_1(x) = x$.\nFor $n=1$:\n$2P_2(x) = 3xP_1(x) - 1P_0(x) = 3x(x) - 1 = 3x^2 - 1 \\implies P_2(x) = \\frac{1}{2}(3x^2 - 1)$.\nFor $n=2$:\n$3P_3(x) = 5xP_2(x) - 2P_1(x) = 5x\\left(\\frac{1}{2}(3x^2 - 1)\\right) - 2x = \\frac{15}{2}x^3 - \\frac{5}{2}x - 2x = \\frac{1}{2}(15x^3 - 9x) \\implies P_3(x) = \\frac{1}{2}(5x^3 - 3x)$.\nFor $n=3$:\n$4P_4(x) = 7xP_3(x) - 3P_2(x) = 7x\\left(\\frac{1}{2}(5x^3 - 3x)\\right) - 3\\left(\\frac{1}{2}(3x^2 - 1)\\right) = \\frac{1}{2}(35x^4 - 21x^2 - 9x^2 + 3) = \\frac{1}{2}(35x^4 - 30x^2 + 3)$.\nThus, the Legendre polynomial of degree $4$ is:\n$$ P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3) $$\nNext, we find its derivative, $P'_4(x)$:\n$$ P'_4(x) = \\frac{d}{dx}\\left[\\frac{1}{8}(35x^4 - 30x^2 + 3)\\right] = \\frac{1}{8}(140x^3 - 60x) = \\frac{20}{8}x(7x^2 - 3) = \\frac{5}{2}x(7x^2 - 3) $$\nThe interior GLL nodes are the roots of $P'_4(x) = 0$. Setting the derivative to zero gives $x=0$ and $7x^2 - 3 = 0$, which yields $x^2 = \\frac{3}{7}$, or $x = \\pm\\sqrt{\\frac{3}{7}}$.\nThe set of $N+1=5$ GLL nodes, ordered from smallest to largest, is:\n$$ \\xi_0 = -1, \\quad \\xi_1 = -\\sqrt{\\frac{3}{7}}, \\quad \\xi_2 = 0, \\quad \\xi_3 = \\sqrt{\\frac{3}{7}}, \\quad \\xi_4 = 1 $$\n\nThe second step is to compute the GLL quadrature weights $\\{w_i\\}_{i=0}^N$. The formula for the weights is given by:\n$$ w_i = \\frac{2}{N(N+1)[P_N(\\xi_i)]^2} $$\nFor $N=4$, this becomes $w_i = \\frac{2}{4(5)[P_4(\\xi_i)]^2} = \\frac{1}{10[P_4(\\xi_i)]^2}$.\nWe evaluate $P_4(x)$ at each of the GLL nodes:\nFor the endpoints $\\xi_0 = -1$ and $\\xi_4 = 1$:\n$P_4(1) = \\frac{1}{8}(35(1)^4 - 30(1)^2 + 3) = \\frac{1}{8}(35 - 30 + 3) = \\frac{8}{8} = 1$.\n$P_4(-1) = \\frac{1}{8}(35(-1)^4 - 30(-1)^2 + 3) = \\frac{1}{8}(35 - 30 + 3) = \\frac{8}{8} = 1$.\nThe weights for the endpoints are:\n$w_0 = w_4 = \\frac{1}{10[1]^2} = \\frac{1}{10}$.\nFor the interior node $\\xi_2 = 0$:\n$P_4(0) = \\frac{1}{8}(3) = \\frac{3}{8}$.\nThe weight for the central node is:\n$w_2 = \\frac{1}{10[3/8]^2} = \\frac{1}{10(9/64)} = \\frac{64}{90} = \\frac{32}{45}$.\nFor the interior nodes $\\xi_1 = -\\sqrt{3/7}$ and $\\xi_3 = \\sqrt{3/7}$, we use $\\xi_{1,3}^2 = 3/7$:\n$P_4(\\pm\\sqrt{3/7}) = \\frac{1}{8}\\left(35\\left(\\frac{3}{7}\\right)^2 - 30\\left(\\frac{3}{7}\\right) + 3\\right) = \\frac{1}{8}\\left(35\\frac{9}{49} - \\frac{90}{7} + 3\\right) = \\frac{1}{8}\\left(\\frac{5 \\cdot 9}{7} - \\frac{90}{7} + \\frac{21}{7}\\right) = \\frac{1}{8}\\left(\\frac{45 - 90 + 21}{7}\\right) = \\frac{1}{8}\\left(\\frac{-24}{7}\\right) = -\\frac{3}{7}$.\nThe weights for these nodes are:\n$w_1 = w_3 = \\frac{1}{10[-3/7]^2} = \\frac{1}{10(9/49)} = \\frac{49}{90}$.\nThe GLL quadrature weights are:\n$w_0 = \\frac{1}{10}$, $w_1 = \\frac{49}{90}$, $w_2 = \\frac{32}{45}$, $w_3 = \\frac{49}{90}$, $w_4 = \\frac{1}{10}$.\nAs a verification, the sum of the weights must equal $\\int_{-1}^1 1 \\, dx = 2$:\n$\\sum_{i=0}^4 w_i = \\frac{1}{10} + \\frac{49}{90} + \\frac{32}{45} + \\frac{49}{90} + \\frac{1}{10} = \\frac{9}{90} + \\frac{49}{90} + \\frac{64}{90} + \\frac{49}{90} + \\frac{9}{90} = \\frac{9+49+64+49+9}{90} = \\frac{180}{90} = 2$. The weights are correct.\n\nThe third and final step is to determine the diagonal entries of the lumped mass matrix. The consistent mass matrix is $M_{ij} = \\int_{-1}^1 \\phi_i(x)\\phi_j(x) dx$, where $\\phi_i(x)$ are the Lagrange basis functions defined on the GLL nodes $\\{\\xi_k\\}$, such that $\\phi_i(\\xi_k) = \\delta_{ik}$. The problem states that the lumped mass matrix is obtained by applying the GLL quadrature rule to the integral for the mass matrix entries. The GLL quadrature approximation of an integral is $\\int_{-1}^1 f(x) dx \\approx \\sum_{k=0}^N w_k f(\\xi_k)$.\nApplying this to the diagonal entries $M_{ii}$ of the mass matrix:\n$$ M_{ii}^{\\text{lumped}} = \\sum_{k=0}^{N} w_k \\phi_i(\\xi_k)\\phi_i(\\xi_k) = \\sum_{k=0}^{N} w_k (\\phi_i(\\xi_k))^2 $$\nUsing the property of Lagrange basis functions, $\\phi_i(\\xi_k) = \\delta_{ik}$ (the Kronecker delta):\n$$ M_{ii}^{\\text{lumped}} = \\sum_{k=0}^{N} w_k (\\delta_{ik})^2 $$\nSince $\\delta_{ik}$ is either $0$ or $1$, $(\\delta_{ik})^2 = \\delta_{ik}$. The sum is non-zero only at the term where $k=i$:\n$$ M_{ii}^{\\text{lumped}} = w_i (\\delta_{ii})^2 = w_i(1) = w_i $$\nThis shows that the diagonal entries of the lumped mass matrix are simply the GLL quadrature weights. Therefore, the ordered list of the five diagonal lumped mass entries, corresponding to the nodes from $\\xi_0=-1$ to $\\xi_4=1$, is the ordered list of the weights $\\{w_i\\}_{i=0}^4$.\n\nThe final answer is the row vector of these weights.\nThe vector is $(w_0, w_1, w_2, w_3, w_4) = (\\frac{1}{10}, \\frac{49}{90}, \\frac{32}{45}, \\frac{49}{90}, \\frac{1}{10})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{10} & \\frac{49}{90} & \\frac{32}{45} & \\frac{49}{90} & \\frac{1}{10}\n\\end{pmatrix}\n}\n$$", "id": "3398294"}, {"introduction": "The primary trade-off of mass lumping is exchanging the complexity of an implicit time-stepping scheme for the efficiency of an explicit one, at the cost of introducing an approximation error. This exercise provides a powerful analytical tool to quantify that error's impact on a physical system. By examining the 1D wave equation, you will derive a closed-form expression for the relative error in the numerical phase speed caused by replacing the consistent mass matrix $M$ with its lumped counterpart $\\tilde{M}$. This reveals how the lumping approximation manifests as numerical dispersion, a crucial concept for anyone simulating wave phenomena [@problem_id:3398334].", "problem": "Consider the one-dimensional scalar wave equation in conservative form on the reference domain $[-1,1]$ with periodic boundary conditions,\n$$\nu_{tt}(x,t) \\;=\\; c^{2}\\,u_{xx}(x,t),\n$$\nwhere $c>0$ is a constant propagation speed. In a single-element spectral element method (SEM), approximate $u(x,t)$ by a polynomial of degree $2$ expressed in the Lagrange nodal basis associated with the Legendre–Gauss–Lobatto (LGL) nodes $x_{1}=-1$, $x_{2}=0$, and $x_{3}=1$. Let $\\{\\ell_{i}(x)\\}_{i=1}^{3}$ denote the corresponding Lagrange basis polynomials satisfying $\\ell_{i}(x_{j})=\\delta_{ij}$. Define the consistent mass matrix $M\\in\\mathbb{R}^{3\\times3}$ and the stiffness matrix $K\\in\\mathbb{R}^{3\\times3}$ by the exact bilinear forms\n$$\nM_{ij} \\;=\\; \\int_{-1}^{1} \\ell_{i}(x)\\,\\ell_{j}(x)\\,dx,\n\\qquad\nK_{ij} \\;=\\; \\int_{-1}^{1} \\ell'_{i}(x)\\,\\ell'_{j}(x)\\,dx.\n$$\nDefine the lumped mass matrix $\\tilde{M}\\in\\mathbb{R}^{3\\times3}$ as the diagonal matrix of LGL quadrature weights on $[-1,1]$, i.e., $\\tilde{M} = \\mathrm{diag}(w_{1},w_{2},w_{3})$ with $w_{1}=\\frac{1}{3}$, $w_{2}=\\frac{4}{3}$, and $w_{3}=\\frac{1}{3}$. The semi-discrete dynamics are governed by\n$$\nM\\,\\ddot{\\mathbf{u}}(t) + c^{2} K\\,\\mathbf{u}(t) = \\mathbf{0}\n\\quad\\text{or}\\quad\n\\tilde{M}\\,\\ddot{\\mathbf{u}}(t) + c^{2} K\\,\\mathbf{u}(t) = \\mathbf{0},\n$$\ndepending on whether $M$ or $\\tilde{M}$ is used. For a given wavenumber $k\\in\\mathbb{R}$, consider the complex-valued nodal vector that samples a plane wave at the LGL nodes,\n$$\n\\mathbf{v}_{k} = \\begin{pmatrix} \\exp(\\mathrm{i}k x_{1}) \\\\ \\exp(\\mathrm{i}k x_{2}) \\\\ \\exp(\\mathrm{i}k x_{3}) \\end{pmatrix}\n= \\begin{pmatrix} \\exp(-\\mathrm{i}k) \\\\ 1 \\\\ \\exp(\\mathrm{i}k) \\end{pmatrix}.\n$$\nThe squared angular frequency associated with $\\mathbf{v}_{k}$ in the consistent and lumped cases can be estimated by the Rayleigh quotients,\n$$\n\\omega_{M}^{2}(k) = c^{2}\\,\\frac{\\mathbf{v}_{k}^{\\ast} K\\,\\mathbf{v}_{k}}{\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k}},\nqquad\n\\omega_{\\tilde{M}}^{2}(k) = c^{2}\\,\\frac{\\mathbf{v}_{k}^{\\ast} K\\,\\mathbf{v}_{k}}{\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k}},\n$$\nwhere the superscript $\\ast$ denotes complex conjugate transpose. Define the phase speed $c_{p}(k) = \\omega(k)/k$. Using only the definitions above and first principles of the Galerkin discretization, construct a counterexample showing that $M$ and $\\tilde{M}$ yield different eigenfrequency estimates for the same $\\mathbf{v}_{k}$, and derive a closed-form expression for the relative phase speed error\n$$\n\\delta(k) \\;=\\; \\frac{c_{p,\\tilde{M}}(k) - c_{p,M}(k)}{c_{p,M}(k)}.\n$$\nYour final answer must be a single closed-form analytic expression for $\\delta(k)$ in terms of $k$. No numerical evaluation or rounding is required.", "solution": "The problem is well-posed and scientifically sound, grounded in the principles of numerical analysis for partial differential equations, specifically the spectral element method. All definitions and conditions are provided, and no contradictions or ambiguities are present. We may proceed with the solution.\n\nThe objective is to find the relative phase speed error, $\\delta(k)$, defined as\n$$\n\\delta(k) = \\frac{c_{p,\\tilde{M}}(k) - c_{p,M}(k)}{c_{p,M}(k)} = \\frac{c_{p,\\tilde{M}}(k)}{c_{p,M}(k)} - 1.\n$$\nThe phase speed is given by $c_p(k) = \\omega(k)/k$. Therefore, the ratio of phase speeds is equal to the ratio of angular frequencies:\n$$\n\\frac{c_{p,\\tilde{M}}(k)}{c_{p,M}(k)} = \\frac{\\omega_{\\tilde{M}}(k)/k}{\\omega_{M}(k)/k} = \\frac{\\omega_{\\tilde{M}}(k)}{\\omega_{M}(k)}.\n$$\nSince $\\omega(k) > 0$ for non-trivial modes, we can write this ratio as the square root of the ratio of squared frequencies:\n$$\n\\frac{\\omega_{\\tilde{M}}(k)}{\\omega_{M}(k)} = \\sqrt{\\frac{\\omega_{\\tilde{M}}^{2}(k)}{\\omega_{M}^{2}(k)}}.\n$$\nUsing the provided definitions of the squared angular frequencies as Rayleigh quotients:\n$$\n\\frac{\\omega_{\\tilde{M}}^{2}(k)}{\\omega_{M}^{2}(k)} = \\frac{c^{2}\\,\\frac{\\mathbf{v}_{k}^{\\ast} K\\,\\mathbf{v}_{k}}{\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k}}}{c^{2}\\,\\frac{\\mathbf{v}_{k}^{\\ast} K\\,\\mathbf{v}_{k}}{\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k}}}.\n$$\nAssuming the mode is not trivial, $\\mathbf{v}_{k}^{\\ast} K\\,\\mathbf{v}_{k} \\neq 0$, and we can cancel this term, which simplifies the expression significantly:\n$$\n\\frac{\\omega_{\\tilde{M}}^{2}(k)}{\\omega_{M}^{2}(k)} = \\frac{\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k}}{\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k}}.\n$$\nThus, the relative error $\\delta(k)$ depends only on the ratio of the denominator terms from the Rayleigh quotients:\n$$\n\\delta(k) = \\sqrt{\\frac{\\mathbfv}_{k}^{\\ast} M\\,\\mathbf{v}_{k}}{\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k}}} - 1.\n$$\nOur task reduces to computing the two quadratic forms in the denominator.\n\nFirst, we compute the term for the lumped mass matrix, $\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k}$. The lumped mass matrix $\\tilde{M}$ is diagonal with entries given by the Legendre-Gauss-Lobatto (LGL) quadrature weights for $3$ points: $\\tilde{M} = \\mathrm{diag}(w_{1}, w_{2}, w_{3}) = \\mathrm{diag}(\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3})$. The test vector is $\\mathbf{v}_{k} = (\\exp(-\\mathrm{i}k), 1, \\exp(\\mathrm{i}k))^T$.\n$$\n\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k} = \\begin{pmatrix} \\exp(\\mathrm{i}k) & 1 & \\exp(-\\mathrm{i}k) \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3} & 0 & 0 \\\\ 0 & \\frac{4}{3} & 0 \\\\ 0 & 0 & \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} \\exp(-\\mathrm{i}k) \\\\ 1 \\\\ \\exp(\\mathrm{i}k) \\end{pmatrix}\n$$\n$$\n\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k} = \\frac{1}{3} \\exp(\\mathrm{i}k)\\exp(-\\mathrm{i}k) + \\frac{4}{3}(1)(1) + \\frac{1}{3}\\exp(-\\mathrm{i}k)\\exp(\\mathrm{i}k) = \\frac{1}{3} + \\frac{4}{3} + \\frac{1}{3} = \\frac{6}{3} = 2.\n$$\nThis term is constant and equal to the sum of the quadrature weights, because all components of $\\mathbf{v}_k$ have unit modulus.\n\nNext, we compute the term for the consistent mass matrix, $\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k}$. By definition, $M_{ij} = \\int_{-1}^{1} \\ell_{i}(x)\\,\\ell_{j}(x)\\,dx$. Let us define the degree-$2$ polynomial interpolant of the plane wave $\\exp(\\mathrm{i}kx)$ at the LGL nodes, $f_k(x) = \\sum_{j=1}^{3} \\exp(\\mathrm{i}k x_j) \\ell_j(x) = \\sum_{j=1}^{3} (\\mathbf{v}_k)_j \\ell_j(x)$. The quadratic form can be written as:\n$$\n\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k} = \\sum_{i=1}^{3}\\sum_{j=1}^{3} \\overline{(\\mathbf{v}_k)_i} M_{ij} (\\mathbf{v}_k)_j = \\sum_{i=1}^{3}\\sum_{j=1}^{3} \\overline{(\\mathbf{v}_k)_i} \\left(\\int_{-1}^{1} \\ell_{i}(x)\\,\\ell_{j}(x)\\,dx \\right) (\\mathbf{v}_k)_j\n= \\int_{-1}^{1} \\left(\\sum_{i=1}^{3} \\overline{(\\mathbf{v}_k)_i} \\ell_i(x)\\right) \\left(\\sum_{j=1}^{3} (\\mathbf{v}_k)_j \\ell_j(x)\\right) dx = \\int_{-1}^{1} \\overline{f_k(x)}f_k(x)\\,dx = \\int_{-1}^{1} |f_k(x)|^2 dx.\n$$\nTo find $f_k(x)$, we construct the Lagrange basis polynomials $\\{\\ell_j(x)\\}_{j=1}^3$ for the nodes $x_1=-1$, $x_2=0$, $x_3=1$:\n$$\n\\ell_1(x) = \\frac{x(x-1)}{(-1)(-2)} = \\frac{1}{2}(x^2-x)\n$$\n$$\n\\ell_2(x) = \\frac{(x+1)(x-1)}{(1)(-1)} = 1-x^2\n$$\n$$\n\\ell_3(x) = \\frac{(x+1)x}{(2)(1)} = \\frac{1}{2}(x^2+x)\n$$\nNow, we construct $f_k(x) = (\\mathbf{v}_k)_1 \\ell_1(x) + (\\mathbf{v}_k)_2 \\ell_2(x) + (\\mathbf{v}_k)_3 \\ell_3(x)$:\n$$\nf_k(x) = \\exp(-\\mathrm{i}k)\\frac{1}{2}(x^2-x) + (1)(1-x^2) + \\exp(\\mathrm{i}k)\\frac{1}{2}(x^2+x)\n$$\n$$\nf_k(x) = \\left(\\frac{\\exp(-\\mathrm{i}k)+\\exp(\\mathrm{i}k)}{2} - 1\\right)x^2 + \\left(\\frac{\\exp(\\mathrm{i}k)-\\exp(-\\mathrm{i}k)}{2}\\right)x + 1\n$$\nUsing Euler's formulas, $\\cos(k) = \\frac{\\exp(\\mathrm{i}k)+\\exp(-\\mathrm{i}k)}{2}$ and $\\sin(k) = \\frac{\\exp(\\mathrm{i}k)-\\exp(-\\mathrm{i}k)}{2\\mathrm{i}}$:\n$$\nf_k(x) = (\\cos k - 1)x^2 + \\mathrm{i}\\sin(k)x + 1\n$$\nNext, we find $|f_k(x)|^2 = f_k(x)\\overline{f_k(x)}$:\n$$\n|f_k(x)|^2 = \\left( (\\cos k - 1)x^2 + 1 \\right)^2 + (\\sin(k)x)^2\n$$\n$$\n|f_k(x)|^2 = (\\cos k - 1)^2 x^4 + 2(\\cos k - 1)x^2 + 1 + \\sin^2(k)x^2\n$$\n$$\n|f_k(x)|^2 = (\\cos k - 1)^2 x^4 + (2\\cos k - 2 + \\sin^2 k)x^2 + 1\n$$\nUsing $\\sin^2(k) = 1-\\cos^2(k)$:\n$$\n|f_k(x)|^2 = (\\cos k - 1)^2 x^4 + (2\\cos k - 2 + 1 - \\cos^2 k)x^2 + 1\n$$\n$$\n|f_k(x)|^2 = (\\cos k - 1)^2 x^4 - (\\cos^2 k - 2\\cos k + 1)x^2 + 1 = (\\cos k - 1)^2 x^4 - (\\cos k - 1)^2 x^2 + 1\n$$\nNow we integrate $|f_k(x)|^2$ over the domain $[-1, 1]$:\n$$\n\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k} = \\int_{-1}^{1} \\left( (\\cos k - 1)^2(x^4 - x^2) + 1 \\right) dx = (\\cos k - 1)^2 \\left[\\frac{x^5}{5} - \\frac{x^3}{3}\\right]_{-1}^{1} + [x]_{-1}^{1}\n$$\n$$\n\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k} = (\\cos k - 1)^2 \\left( 2\\left(\\frac{1}{5} - \\frac{1}{3}\\right) \\right) + 2 = (\\cos k - 1)^2 \\left( 2\\left(\\frac{3-5}{15}\\right) \\right) + 2\n$$\n$$\n\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k} = -\\frac{4}{15}(\\cos k - 1)^2 + 2 = 2 - \\frac{4}{15}(\\cos^2 k - 2\\cos k + 1)\n$$\n$$\n\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k} = \\frac{30 - 4\\cos^2 k + 8\\cos k - 4}{15} = \\frac{26 + 8\\cos k - 4\\cos^2 k}{15} = \\frac{2}{15}(13 + 4\\cos k - 2\\cos^2 k).\n$$\nThe fact that $\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k}$ depends on $k$ while $\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k}$ does not, provides a counterexample. Specifically, $\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k} = \\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k}$ only if $\\frac{2}{15}(13 + 4\\cos k - 2\\cos^2 k) = 2$, which simplifies to $2(\\cos k - 1)^2 = 0$, implying $\\cos k = 1$. For any $k$ not an integer multiple of $2\\pi$, the denominators of the Rayleigh quotients differ, and thus $\\omega_M^2(k) \\ne \\omega_{\\tilde{M}}^2(k)$, demonstrating that the eigenfrequency estimates are different.\n\nNow we can compute the ratio needed for $\\delta(k)$:\n$$\n\\frac{\\mathbf{v}_{k}^{\\ast} M\\,\\mathbf{v}_{k}}{\\mathbf{v}_{k}^{\\ast} \\tilde{M}\\,\\mathbf{v}_{k}} = \\frac{\\frac{2}{15}(13 + 4\\cos k - 2\\cos^2 k)}{2} = \\frac{1}{15}(13 + 4\\cos k - 2\\cos^2 k).\n$$\nFinally, we substitute this into the expression for $\\delta(k)$:\n$$\n\\delta(k) = \\sqrt{\\frac{1}{15}(13 + 4\\cos k - 2\\cos^2 k)} - 1.\n$$\nThis is the closed-form analytic expression for the relative phase speed error.", "answer": "$$ \\boxed{\\sqrt{\\frac{1}{15}(13 + 4\\cos(k) - 2\\cos^{2}(k))} - 1} $$", "id": "3398334"}]}