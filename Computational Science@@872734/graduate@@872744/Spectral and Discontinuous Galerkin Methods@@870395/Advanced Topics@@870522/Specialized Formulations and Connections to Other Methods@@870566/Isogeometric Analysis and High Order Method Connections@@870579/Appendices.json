{"hands_on_practices": [{"introduction": "This practice provides a foundational exercise in manipulating the core components of Isogeometric Analysis: the B-spline basis functions. By applying the Cox-de Boor recursion, you will gain direct experience with evaluating B-splines and their derivatives, which are essential for assembling the matrices used in numerical simulations. This hands-on calculation for a specific knot vector and evaluation point demystifies the abstract definitions and builds a concrete understanding of the local support and polynomial nature of splines [@problem_id:3393174].", "problem": "Consider Isogeometric Analysis (IGA), where open knot vectors and spline bases provide smooth, high-order trial spaces closely connected to spectral and Discontinuous Galerkin methods through their polynomial structure and local support. Let the open knot vector be $\\Xi=\\{0,0,0, \\frac{1}{3}, \\frac{2}{3}, 1,1,1\\}$ and the spline degree be $p=2$, so that there are $n = |\\Xi| - p - 1 = 5$ quadratic $B$-spline basis functions $\\{N_{i,2}(\\xi)\\}_{i=0}^{4}$. Starting from the Cox–de Boor recursion for $B$-splines and the definition of the Greville abscissae $\\xi_{i}^{G} = \\frac{1}{p}\\sum_{j=1}^{p} \\xi_{i+j}$ for $i=0,1,\\dots,4$, perform the following:\n\n- Identify which indices $i$ yield nonzero $N_{i,2}(\\xi)$ at the parametric location $\\xi=\\frac{1}{2}$.\n- Compute the values $N_{i,2}\\!\\left(\\frac{1}{2}\\right)$ for those nonzero basis functions.\n- Compute the first derivatives $N_{i,2}'\\!\\left(\\frac{1}{2}\\right)$ of those nonzero basis functions.\n- Compute the Greville abscissae $\\xi_{i}^{G}$ for those same indices and evaluate $N_{i,2}(\\xi_{i}^{G})$.\n\nExpress your final answer as a single row vector containing, in order:\n$N_{i,2}\\!\\left(\\frac{1}{2}\\right)$ for each nonzero index $i$ in increasing index order, then $N_{i,2}'\\!\\left(\\frac{1}{2}\\right)$ for those same indices in the same order, then $N_{i,2}(\\xi_{i}^{G})$ for those indices in the same order. Provide exact values; no rounding is required.", "solution": "The problem as stated is valid. It is scientifically grounded in the well-established mathematical theory of B-splines, which is the foundation of Isogeometric Analysis. The problem is well-posed, providing all necessary information—the knot vector, spline degree, and explicit definitions—to arrive at a unique, verifiable solution. The terminology is precise and objective. There are no contradictions or ambiguities. We may therefore proceed with the solution.\n\nThe problem requires the calculation of B-spline basis function values, their derivatives, and their values at corresponding Greville abscissae for a specific case.\nThe given spline degree is $p=2$.\nThe open knot vector is $\\Xi = \\{\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5, \\xi_6, \\xi_7\\} = \\{0,0,0, \\frac{1}{3}, \\frac{2}{3}, 1,1,1\\}$.\nThe number of basis functions is $n = |\\Xi| - p - 1 = 8 - 2 - 1 = 5$, indexed from $i=0$ to $i=4$.\n\nThe core formula for B-spline evaluation is the Cox–de Boor recursion relation:\n$$N_{i,p}(\\xi) = \\frac{\\xi - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(\\xi) + \\frac{\\xi_{i+p+1} - \\xi}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(\\xi)$$\nThe recursion starts with degree $p=0$:\n$$N_{i,0}(\\xi) = \\begin{cases} 1  \\text{if } \\xi_i \\le \\xi  \\xi_{i+1} \\\\ 0  \\text{otherwise} \\end{cases}$$\nIf a denominator in the recursion is zero (due to repeated knots), the corresponding term is defined to be zero.\n\nFirst, we identify which basis functions $N_{i,2}(\\xi)$ are nonzero at $\\xi = \\frac{1}{2}$. A B-spline function $N_{i,p}(\\xi)$ has local support, meaning it is nonzero only on the interval $[\\xi_i, \\xi_{i+p+1})$. For our case with $p=2$, the support is $[\\xi_i, \\xi_{i+3})$. We check this condition for each basis function at $\\xi = \\frac{1}{2}$:\n- $i=0$: Support is $[\\xi_0, \\xi_3) = [0, \\frac{1}{3})$. $\\frac{1}{2}$ is not in this interval. $N_{0,2}(\\frac{1}{2}) = 0$.\n- $i=1$: Support is $[\\xi_1, \\xi_4) = [0, \\frac{2}{3})$. $\\frac{1}{2}$ is in this interval. $N_{1,2}(\\frac{1}{2}) \\ne 0$.\n- $i=2$: Support is $[\\xi_2, \\xi_5) = [0, 1)$. $\\frac{1}{2}$ is in this interval. $N_{2,2}(\\frac{1}{2}) \\ne 0$.\n- $i=3$: Support is $[\\xi_3, \\xi_6) = [\\frac{1}{3}, 1)$. $\\frac{1}{2}$ is in this interval. $N_{3,2}(\\frac{1}{2}) \\ne 0$.\n- $i=4$: Support is $[\\xi_4, \\xi_7) = [\\frac{2}{3}, 1)$. $\\frac{1}{2}$ is not in this interval. $N_{4,2}(\\frac{1}{2}) = 0$.\nThe indices yielding nonzero basis functions at $\\xi = \\frac{1}{2}$ are $i=1, 2, 3$.\n\nNext, we compute the values $N_{i,2}(\\frac{1}{2})$ for $i=1, 2, 3$.\nAt $\\xi=\\frac{1}{2}$, we are in the knot interval $[\\frac{1}{3}, \\frac{2}{3}) = [\\xi_3, \\xi_4)$. Thus, for $p=0$, only $N_{3,0}(\\frac{1}{2}) = 1$, and all other $N_{k,0}(\\frac{1}{2}) = 0$.\n\nFor $p=1$:\n$N_{2,1}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_2}{\\xi_3-\\xi_2}N_{2,0}(\\frac{1}{2}) + \\frac{\\xi_4-\\frac{1}{2}}{\\xi_4-\\xi_3}N_{3,0}(\\frac{1}{2}) = 0 + \\frac{\\frac{2}{3}-\\frac{1}{2}}{\\frac{2}{3}-\\frac{1}{3}}(1) = \\frac{1/6}{1/3} = \\frac{1}{2}$.\n$N_{3,1}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_3}{\\xi_4-\\xi_3}N_{3,0}(\\frac{1}{2}) + \\frac{\\xi_5-\\frac{1}{2}}{\\xi_5-\\xi_4}N_{4,0}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\frac{1}{3}}{\\frac{2}{3}-\\frac{1}{3}}(1) + 0 = \\frac{1/6}{1/3} = \\frac{1}{2}$.\nAll other $N_{k,1}(\\frac{1}{2})=0$.\n\nFor $p=2$:\n$N_{1,2}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_1}{\\xi_3-\\xi_1}N_{1,1}(\\frac{1}{2}) + \\frac{\\xi_4-\\frac{1}{2}}{\\xi_4-\\xi_2}N_{2,1}(\\frac{1}{2}) = 0 + \\frac{\\frac{2}{3}-\\frac{1}{2}}{\\frac{2}{3}-0}(\\frac{1}{2}) = \\frac{1/6}{2/3}(\\frac{1}{2}) = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}$.\n$N_{2,2}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_2}{\\xi_4-\\xi_2}N_{2,1}(\\frac{1}{2}) + \\frac{\\xi_5-\\frac{1}{2}}{\\xi_5-\\xi_3}N_{3,1}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-0}{\\frac{2}{3}-0}(\\frac{1}{2}) + \\frac{1-\\frac{1}{2}}{1-\\frac{1}{3}}(\\frac{1}{2}) = \\frac{3}{4}(\\frac{1}{2}) + \\frac{1/2}{2/3}(\\frac{1}{2}) = \\frac{3}{8} + \\frac{3}{4}(\\frac{1}{2}) = \\frac{3}{8} + \\frac{3}{8} = \\frac{6}{8} = \\frac{3}{4}$.\n$N_{3,2}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_3}{\\xi_5-\\xi_3}N_{3,1}(\\frac{1}{2}) + \\frac{\\xi_6-\\frac{1}{2}}{\\xi_6-\\xi_4}N_{4,1}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\frac{1}{3}}{1-\\frac{1}{3}}(\\frac{1}{2}) + 0 = \\frac{1/6}{2/3}(\\frac{1}{2}) = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}$.\nThe partition of unity property is satisfied: $\\frac{1}{8} + \\frac{6}{8} + \\frac{1}{8} = 1$.\n\nThird, we compute the first derivatives $N'_{i,2}(\\frac{1}{2})$ for $i=1, 2, 3$. The formula for the derivative is:\n$$N'_{i,p}(\\xi) = p \\left( \\frac{N_{i,p-1}(\\xi)}{\\xi_{i+p} - \\xi_i} - \\frac{N_{i+1,p-1}(\\xi)}{\\xi_{i+p+1} - \\xi_{i+1}} \\right)$$\nFor $p=2$, we use the previously computed $N_{k,1}(\\frac{1}{2})$ values.\n$N'_{1,2}(\\frac{1}{2}) = 2 \\left( \\frac{N_{1,1}(\\frac{1}{2})}{\\xi_3-\\xi_1} - \\frac{N_{2,1}(\\frac{1}{2})}{\\xi_4-\\xi_2} \\right) = 2 \\left( \\frac{0}{\\frac{1}{3}-0} - \\frac{1/2}{\\frac{2}{3}-0} \\right) = 2 \\left( -\\frac{1/2}{2/3} \\right) = 2(-\\frac{3}{4}) = -\\frac{3}{2}$.\n$N'_{2,2}(\\frac{1}{2}) = 2 \\left( \\frac{N_{2,1}(\\frac{1}{2})}{\\xi_4-\\xi_2} - \\frac{N_{3,1}(\\frac{1}{2})}{\\xi_5-\\xi_3} \\right) = 2 \\left( \\frac{1/2}{\\frac{2}{3}-0} - \\frac{1/2}{1-\\frac{1}{3}} \\right) = 2 \\left( \\frac{1/2}{2/3} - \\frac{1/2}{2/3} \\right) = 0$.\n$N'_{3,2}(\\frac{1}{2}) = 2 \\left( \\frac{N_{3,1}(\\frac{1}{2})}{\\xi_5-\\xi_3} - \\frac{N_{4,1}(\\frac{1}{2})}{\\xi_6-\\xi_4} \\right) = 2 \\left( \\frac{1/2}{1-\\frac{1}{3}} - \\frac{0}{1-\\frac{2}{3}} \\right) = 2 \\left( \\frac{1/2}{2/3} \\right) = 2(\\frac{3}{4}) = \\frac{3}{2}$.\nThe sum of the derivatives is $-\\frac{3}{2} + 0 + \\frac{3}{2} = 0$, as expected.\n\nFinally, we compute the Greville abscissae $\\xi_{i}^{G}$ for $i=1, 2, 3$ and evaluate $N_{i,2}(\\xi_{i}^{G})$. The formula for Greville abscissae is $\\xi_{i}^{G} = \\frac{1}{p} \\sum_{j=1}^{p} \\xi_{i+j}$. For $p=2$, this simplifies to $\\xi_{i}^{G} = \\frac{1}{2}(\\xi_{i+1} + \\xi_{i+2})$.\n- For $i=1$: $\\xi_{1}^{G} = \\frac{1}{2}(\\xi_2 + \\xi_3) = \\frac{1}{2}(0 + \\frac{1}{3}) = \\frac{1}{6}$.\n- For $i=2$: $\\xi_{2}^{G} = \\frac{1}{2}(\\xi_3 + \\xi_4) = \\frac{1}{2}(\\frac{1}{3} + \\frac{2}{3}) = \\frac{1}{2}(1) = \\frac{1}{2}$.\n- For $i=3$: $\\xi_{3}^{G} = \\frac{1}{2}(\\xi_4 + \\xi_5) = \\frac{1}{2}(\\frac{2}{3} + 1) = \\frac{1}{2}(\\frac{5}{3}) = \\frac{5}{6}$.\n\nNow we evaluate $N_{i,2}(\\xi_{i}^{G})$:\n- For $i=2$, we need $N_{2,2}(\\xi_{2}^{G}) = N_{2,2}(\\frac{1}{2})$, which we have already computed as $\\frac{3}{4}$.\n\n- For $i=1$, we need $N_{1,2}(\\xi_1^G) = N_{1,2}(\\frac{1}{6})$. The point $\\xi=\\frac{1}{6}$ is in $[\\xi_2, \\xi_3) = [0, \\frac{1}{3})$, so $N_{2,0}(\\frac{1}{6})=1$.\nFor $p=1$:\n$N_{1,1}(\\frac{1}{6}) = \\frac{\\xi_3-\\frac{1}{6}}{\\xi_3-\\xi_2}N_{2,0}(\\frac{1}{6}) = \\frac{\\frac{1}{3}-\\frac{1}{6}}{\\frac{1}{3}-0}(1) = \\frac{1/6}{1/3} = \\frac{1}{2}$.\n$N_{2,1}(\\frac{1}{6}) = \\frac{\\frac{1}{6}-\\xi_2}{\\xi_3-\\xi_2}N_{2,0}(\\frac{1}{6}) = \\frac{\\frac{1}{6}-0}{\\frac{1}{3}-0}(1) = \\frac{1/6}{1/3} = \\frac{1}{2}$.\nFor $p=2$:\n$N_{1,2}(\\frac{1}{6}) = \\frac{\\frac{1}{6}-\\xi_1}{\\xi_3-\\xi_1}N_{1,1}(\\frac{1}{6}) + \\frac{\\xi_4-\\frac{1}{6}}{\\xi_4-\\xi_2}N_{2,1}(\\frac{1}{6}) = \\frac{\\frac{1}{6}-0}{\\frac{1}{3}-0}(\\frac{1}{2}) + \\frac{\\frac{2}{3}-\\frac{1}{6}}{\\frac{2}{3}-0}(\\frac{1}{2}) = \\frac{1}{2}(\\frac{1}{2}) + \\frac{3/6}{2/3}(\\frac{1}{2}) = \\frac{1}{4} + \\frac{1/2}{2/3}(\\frac{1}{2}) = \\frac{1}{4} + \\frac{3}{4}(\\frac{1}{2}) = \\frac{1}{4} + \\frac{3}{8} = \\frac{5}{8}$.\n\n- For $i=3$, we need $N_{3,2}(\\xi_3^G) = N_{3,2}(\\frac{5}{6})$. The knot vector is symmetric about $\\xi=\\frac{1}{2}$. The basis functions exhibit symmetry: $N_{i,p}(\\xi) = N_{n-1-i,p}(1-\\xi)$, where $n=5$ is the number of basis functions. So, $N_{3,2}(\\frac{5}{6}) = N_{5-1-3,2}(1-\\frac{5}{6}) = N_{1,2}(\\frac{1}{6})$. We have just calculated this value to be $\\frac{5}{8}$.\n\nThe results for $N_{i,2}(\\xi_i^G)$ for $i=1, 2, 3$ are $\\frac{5}{8}$, $\\frac{3}{4}$, and $\\frac{5}{8}$.\n\nWe now assemble the final answer as requested. The vector will contain:\n1. $N_{i,2}(\\frac{1}{2})$ for $i=1,2,3$: $\\frac{1}{8}, \\frac{3}{4}, \\frac{1}{8}$.\n2. $N'_{i,2}(\\frac{1}{2})$ for $i=1,2,3$: $-\\frac{3}{2}, 0, \\frac{3}{2}$.\n3. $N_{i,2}(\\xi_{i}^{G})$ for $i=1,2,3$: $\\frac{5}{8}, \\frac{3}{4}, \\frac{5}{8}$.\n\nThe final row vector concatenates these results in the specified order.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{8}  \\frac{3}{4}  \\frac{1}{8}  -\\frac{3}{2}  0  \\frac{3}{2}  \\frac{5}{8}  \\frac{3}{4}  \\frac{5}{8}\n\\end{pmatrix}\n}\n$$", "id": "3393174"}, {"introduction": "A key advantage of Isogeometric Analysis is its ability to exactly represent complex geometries common in engineering design using the same basis functions used for analysis. This exercise demonstrates this power by constructing a circular arc using Non-Uniform Rational B-Splines (NURBS). You will calculate the rational basis functions and the resulting geometric mapping, and importantly, compute the Jacobian determinant, which quantifies the mapping from the parametric to the physical domain and is fundamental for integrating over the element in an analysis context [@problem_id:3393171].", "problem": "In isogeometric analysis, Non-Uniform Rational B-Splines (NURBS) enable exact representation of conic geometry while providing a direct bridge between spline-based Computer-Aided Design and high-order methods such as the Spectral Element Method and the Discontinuous Galerkin Method (DGM). Consider a quadratic rational Bézier curve (a special case of a NURBS curve) used as a boundary segment in a high-order element. The curve is defined by $3$ control points $\\{(R,0),(R,R),(0,R)\\}$ with corresponding weights $\\{1,\\tfrac{1}{\\sqrt{2}},1\\}$ and radius $R=1$. The parametric coordinate is $\\xi \\in [0,1]$. Starting from the fundamental definitions:\n- the quadratic Bernstein polynomials $B_{0}(\\xi)=(1-\\xi)^{2}$, $B_{1}(\\xi)=2\\xi(1-\\xi)$, $B_{2}(\\xi)=\\xi^{2}$,\n- the rational basis functions $R_{i}(\\xi)=\\dfrac{w_{i}B_{i}(\\xi)}{\\sum_{j=0}^{2}w_{j}B_{j}(\\xi)}$,\n- the geometric map $\\mathbf{C}(\\xi)=\\sum_{i=0}^{2}R_{i}(\\xi)\\mathbf{P}_{i}$,\n- and the one-dimensional Jacobian determinant $J(\\xi)=\\left\\|\\dfrac{d\\mathbf{C}}{d\\xi}(\\xi)\\right\\|$,\ncompute at the parameter value $\\xi=\\tfrac{1}{2}$:\n$1)$ the NURBS basis values $R_{0}(\\tfrac{1}{2})$, $R_{1}(\\tfrac{1}{2})$, $R_{2}(\\tfrac{1}{2})$,\n$2)$ the mapped physical point $\\mathbf{C}(\\tfrac{1}{2})$,\n$3)$ the Jacobian determinant $J(\\tfrac{1}{2})$.\nExpress all results exactly in simplified radical form. Do not provide any decimal approximations. The final answer must be a single row matrix containing, in order, $R_{0}(\\tfrac{1}{2})$, $R_{1}(\\tfrac{1}{2})$, $R_{2}(\\tfrac{1}{2})$, the $x$-coordinate of $\\mathbf{C}(\\tfrac{1}{2})$, the $y$-coordinate of $\\mathbf{C}(\\tfrac{1}{2})$, and $J(\\tfrac{1}{2})$.", "solution": "The problem is well-posed, scientifically grounded in the theory of isogeometric analysis and Non-Uniform Rational B-Splines (NURBS), and provides all necessary information for a unique solution. We proceed with the calculation.\n\nThe given parameters are:\nControl points: $\\mathbf{P}_{0}=\\{R,0\\}$, $\\mathbf{P}_{1}=\\{R,R\\}$, $\\mathbf{P}_{2}=\\{0,R\\}$\nWeights: $w_{0}=1$, $w_{1}=\\tfrac{1}{\\sqrt{2}}$, $w_{2}=1$\nRadius: $R=1$\nParametric coordinate of interest: $\\xi=\\tfrac{1}{2}$\n\nWith $R=1$, the control points become $\\mathbf{P}_{0}=\\{1,0\\}$, $\\mathbf{P}_{1}=\\{1,1\\}$, $\\mathbf{P}_{2}=\\{0,1\\}$.\n\nThe quadratic Bernstein polynomials are defined as:\n$B_{0}(\\xi)=(1-\\xi)^{2}$\n$B_{1}(\\xi)=2\\xi(1-\\xi)$\n$B_{2}(\\xi)=\\xi^{2}$\n\nFirst, we evaluate these basis functions at $\\xi=\\tfrac{1}{2}$:\n$B_{0}(\\tfrac{1}{2})=(1-\\tfrac{1}{2})^{2} = (\\tfrac{1}{2})^{2} = \\tfrac{1}{4}$\n$B_{1}(\\tfrac{1}{2})=2(\\tfrac{1}{2})(1-\\tfrac{1}{2}) = 1 \\cdot \\tfrac{1}{2} = \\tfrac{1}{2}$\n$B_{2}(\\tfrac{1}{2})=(\\tfrac{1}{2})^{2} = \\tfrac{1}{4}$\n\nThe denominator of the rational basis functions, $W(\\xi) = \\sum_{j=0}^{2}w_{j}B_{j}(\\xi)$, is calculated at $\\xi=\\tfrac{1}{2}$:\n$W(\\tfrac{1}{2}) = w_{0}B_{0}(\\tfrac{1}{2}) + w_{1}B_{1}(\\tfrac{1}{2}) + w_{2}B_{2}(\\tfrac{1}{2})$\n$W(\\tfrac{1}{2}) = (1)(\\tfrac{1}{4}) + (\\tfrac{1}{\\sqrt{2}})(\\tfrac{1}{2}) + (1)(\\tfrac{1}{4}) = \\tfrac{1}{4} + \\tfrac{1}{2\\sqrt{2}} + \\tfrac{1}{4} = \\tfrac{1}{2} + \\tfrac{\\sqrt{2}}{4} = \\dfrac{2+\\sqrt{2}}{4}$\n\n1) Now we compute the values of the NURBS basis functions $R_{i}(\\xi)=\\dfrac{w_{i}B_{i}(\\xi)}{W(\\xi)}$ at $\\xi=\\tfrac{1}{2}$.\n\nFor $i=0$:\n$R_{0}(\\tfrac{1}{2}) = \\dfrac{w_{0}B_{0}(\\tfrac{1}{2})}{W(\\tfrac{1}{2})} = \\dfrac{(1)(\\tfrac{1}{4})}{\\tfrac{2+\\sqrt{2}}{4}} = \\dfrac{1}{2+\\sqrt{2}} = \\dfrac{1}{2+\\sqrt{2}} \\cdot \\dfrac{2-\\sqrt{2}}{2-\\sqrt{2}} = \\dfrac{2-\\sqrt{2}}{4-2} = \\dfrac{2-\\sqrt{2}}{2} = 1-\\dfrac{\\sqrt{2}}{2}$\n\nFor $i=1$:\n$R_{1}(\\tfrac{1}{2}) = \\dfrac{w_{1}B_{1}(\\tfrac{1}{2})}{W(\\tfrac{1}{2})} = \\dfrac{(\\tfrac{1}{\\sqrt{2}})(\\tfrac{1}{2})}{\\tfrac{2+\\sqrt{2}}{4}} = \\dfrac{\\tfrac{1}{2\\sqrt{2}}}{\\tfrac{2+\\sqrt{2}}{4}} = \\dfrac{1}{2\\sqrt{2}}\\cdot\\dfrac{4}{2+\\sqrt{2}} = \\dfrac{2}{\\sqrt{2}(2+\\sqrt{2})} = \\dfrac{\\sqrt{2}}{2+\\sqrt{2}}$\nRationalizing the denominator:\n$R_{1}(\\tfrac{1}{2}) = \\dfrac{\\sqrt{2}(2-\\sqrt{2})}{(2+\\sqrt{2})(2-\\sqrt{2})} = \\dfrac{2\\sqrt{2}-2}{4-2} = \\dfrac{2(\\sqrt{2}-1)}{2} = \\sqrt{2}-1$\n\nFor $i=2$:\nDue to symmetry ($w_0=w_2$ and $B_0(1/2)=B_2(1/2)$), we have $R_{2}(\\tfrac{1}{2}) = R_{0}(\\tfrac{1}{2})$.\n$R_{2}(\\tfrac{1}{2}) = \\dfrac{w_{2}B_{2}(\\tfrac{1}{2})}{W(\\tfrac{1}{2})} = \\dfrac{(1)(\\tfrac{1}{4})}{\\tfrac{2+\\sqrt{2}}{4}} = 1-\\dfrac{\\sqrt{2}}{2}$\n\n2) Next, we compute the mapped physical point $\\mathbf{C}(\\xi)=\\sum_{i=0}^{2}R_{i}(\\xi)\\mathbf{P}_{i}$ at $\\xi=\\tfrac{1}{2}$.\n$\\mathbf{C}(\\tfrac{1}{2}) = R_{0}(\\tfrac{1}{2})\\mathbf{P}_{0} + R_{1}(\\tfrac{1}{2})\\mathbf{P}_{1} + R_{2}(\\tfrac{1}{2})\\mathbf{P}_{2}$\n$\\mathbf{C}(\\tfrac{1}{2}) = (1-\\dfrac{\\sqrt{2}}{2})\\{1,0\\} + (\\sqrt{2}-1)\\{1,1\\} + (1-\\dfrac{\\sqrt{2}}{2})\\{0,1\\}$\nThe x-coordinate $C_x$ is:\n$C_x(\\tfrac{1}{2}) = (1-\\dfrac{\\sqrt{2}}{2})(1) + (\\sqrt{2}-1)(1) + (1-\\dfrac{\\sqrt{2}}{2})(0) = 1-\\dfrac{\\sqrt{2}}{2} + \\sqrt{2}-1 = \\dfrac{\\sqrt{2}}{2}$\nThe y-coordinate $C_y$ is:\n$C_y(\\tfrac{1}{2}) = (1-\\dfrac{\\sqrt{2}}{2})(0) + (\\sqrt{2}-1)(1) + (1-\\dfrac{\\sqrt{2}}{2})(1) = \\sqrt{2}-1 + 1-\\dfrac{\\sqrt{2}}{2} = \\dfrac{\\sqrt{2}}{2}$\nSo, the point is $\\mathbf{C}(\\tfrac{1}{2}) = \\{\\dfrac{\\sqrt{2}}{2}, \\dfrac{\\sqrt{2}}{2}\\}$. This point lies on the unit circle, as expected for a NURBS representation of a circular arc.\n\n3) Finally, we compute the Jacobian determinant $J(\\xi)=\\left\\|\\dfrac{d\\mathbf{C}}{d\\xi}(\\xi)\\right\\|$ at $\\xi=\\tfrac{1}{2}$.\nThe geometric map is a rational function $\\mathbf{C}(\\xi) = \\dfrac{\\mathbf{A}(\\xi)}{W(\\xi)}$, where $\\mathbf{A}(\\xi) = \\sum_{i=0}^{2}w_{i}B_{i}(\\xi)\\mathbf{P}_{i}$.\nThe derivative is given by the quotient rule: $\\dfrac{d\\mathbf{C}}{d\\xi} = \\dfrac{\\mathbf{A}'(\\xi)W(\\xi) - \\mathbf{A}(\\xi)W'(\\xi)}{[W(\\xi)]^2}$.\nWe need the derivatives of the Bernstein polynomials:\n$B'_{0}(\\xi) = -2(1-\\xi)$, $B'_{1}(\\xi) = 2-4\\xi$, $B'_{2}(\\xi) = 2\\xi$.\nAt $\\xi=\\tfrac{1}{2}$:\n$B'_{0}(\\tfrac{1}{2}) = -1$, $B'_{1}(\\tfrac{1}{2}) = 0$, $B'_{2}(\\tfrac{1}{2}) = 1$.\n\nNow, we find $W'(\\tfrac{1}{2})$ and $\\mathbf{A}'(\\tfrac{1}{2})$:\n$W'(\\xi) = w_{0}B'_{0}(\\xi) + w_{1}B'_{1}(\\xi) + w_{2}B'_{2}(\\xi) = 1(-2(1-\\xi)) + \\tfrac{1}{\\sqrt{2}}(2-4\\xi) + 1(2\\xi)$\n$W'(\\tfrac{1}{2}) = -2(1-\\tfrac{1}{2}) + \\tfrac{1}{\\sqrt{2}}(2-4(\\tfrac{1}{2})) + 2(\\tfrac{1}{2}) = -1 + \\tfrac{1}{\\sqrt{2}}(0) + 1 = 0$.\nSince $W'(\\tfrac{1}{2})=0$, the derivative simplifies significantly: $\\dfrac{d\\mathbf{C}}{d\\xi}(\\tfrac{1}{2}) = \\dfrac{\\mathbf{A}'(\\tfrac{1}{2})}{W(\\tfrac{1}{2})}$.\n\n$\\mathbf{A}'(\\xi) = \\sum_{i=0}^{2}w_{i}B'_{i}(\\xi)\\mathbf{P}_{i}$\n$\\mathbf{A}'(\\tfrac{1}{2}) = w_{0}B'_{0}(\\tfrac{1}{2})\\mathbf{P}_{0} + w_{1}B'_{1}(\\tfrac{1}{2})\\mathbf{P}_{1} + w_{2}B'_{2}(\\tfrac{1}{2})\\mathbf{P}_{2}$\n$\\mathbf{A}'(\\tfrac{1}{2}) = (1)(-1)\\{1,0\\} + (\\tfrac{1}{\\sqrt{2}})(0)\\{1,1\\} + (1)(1)\\{0,1\\} = \\{-1,0\\} + \\{0,0\\} + \\{0,1\\} = \\{-1,1\\}$.\n\nNow we compute the tangent vector:\n$\\dfrac{d\\mathbf{C}}{d\\xi}(\\tfrac{1}{2}) = \\dfrac{\\{-1,1\\}}{W(\\tfrac{1}{2})} = \\dfrac{\\{-1,1\\}}{\\tfrac{2+\\sqrt{2}}{4}} = \\dfrac{4}{2+\\sqrt{2}}\\{-1,1\\}$.\nSimplifying the scalar factor:\n$\\dfrac{4}{2+\\sqrt{2}} = \\dfrac{4(2-\\sqrt{2})}{(2+\\sqrt{2})(2-\\sqrt{2})} = \\dfrac{4(2-\\sqrt{2})}{4-2} = 2(2-\\sqrt{2}) = 4-2\\sqrt{2}$.\nSo, $\\dfrac{d\\mathbf{C}}{d\\xi}(\\tfrac{1}{2}) = (4-2\\sqrt{2})\\{-1,1\\} = \\{-4+2\\sqrt{2}, 4-2\\sqrt{2}\\}$.\n\nThe Jacobian determinant is the Euclidean norm (magnitude) of this vector:\n$J(\\tfrac{1}{2}) = \\left\\| \\{-4+2\\sqrt{2}, 4-2\\sqrt{2}\\} \\right\\| = \\sqrt{(-4+2\\sqrt{2})^{2} + (4-2\\sqrt{2})^{2}}$.\nSince $(-x)^2 = x^2$, this is:\n$J(\\tfrac{1}{2}) = \\sqrt{2(4-2\\sqrt{2})^{2}} = \\sqrt{2}|4-2\\sqrt{2}|$.\nAs $4 = \\sqrt{16}$ and $2\\sqrt{2} = \\sqrt{8}$, we have $4 > 2\\sqrt{2}$, so the absolute value is positive.\n$J(\\tfrac{1}{2}) = \\sqrt{2}(4-2\\sqrt{2}) = 4\\sqrt{2} - 2(\\sqrt{2})^2 = 4\\sqrt{2}-4$.\n\nThe final results are:\n$R_{0}(\\tfrac{1}{2}) = 1-\\dfrac{\\sqrt{2}}{2}$\n$R_{1}(\\tfrac{1}{2}) = \\sqrt{2}-1$\n$R_{2}(\\tfrac{1}{2}) = 1-\\dfrac{\\sqrt{2}}{2}$\n$\\mathbf{C}(\\tfrac{1}{2}) = \\{\\dfrac{\\sqrt{2}}{2}, \\dfrac{\\sqrt{2}}{2}\\}$\n$J(\\tfrac{1}{2}) = 4\\sqrt{2}-4$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1-\\frac{\\sqrt{2}}{2}  \\sqrt{2}-1  1-\\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{2}  4\\sqrt{2}-4\n\\end{pmatrix}\n}\n$$", "id": "3393171"}, {"introduction": "With an understanding of B-spline basis functions, we can now apply them to solve a differential equation and compare the resulting system to classical methods. This problem guides you through the assembly of a global stiffness matrix for a 1D Poisson problem using quadratic B-splines, a central task in finite element-type methods. By comparing the bandwidth of the resulting IGA matrix to that from a traditional $C^0$ Lagrange finite element method, you will gain insight into the structural properties and computational implications of using higher-continuity splines in analysis [@problem_id:3393185].", "problem": "Consider the symmetric coercive bilinear form for the one-dimensional Poisson operator, defined by $a(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx$, on the interval $[0,1]$. \n\nPart A (Isogeometric Analysis). Use Isogeometric Analysis (IGA) with quadratic B-splines on the uniform open knot vector $U = \\{0,0,0,\\tfrac{1}{2},1,1,1\\}$, corresponding to two equal knot spans on $[0,1]$ and polynomial degree $p=2$ with interior continuity $C^{1}$. Let $\\{N_{i,2}(x)\\}_{i=0}^{3}$ denote the quadratic B-spline basis ordered by nondecreasing knot index. Define the global stiffness matrix $K \\in \\mathbb{R}^{4 \\times 4}$ by \n$$K_{ij} = \\int_{0}^{1} N_{i,2}'(x)\\,N_{j,2}'(x)\\,dx.$$\nCompute all the nonzero entries of $K$ explicitly.\n\nPart B (Classical $C^{0}$ Quadratic Finite Elements). Consider the standard $C^{0}$ quadratic Lagrange Finite Element Method (FEM) on the same partition of $[0,1]$ into two uniform elements with nodes at $x=0$, $x=\\tfrac{1}{2}$, $x=1$ and midpoints $x=\\tfrac{1}{4}$, $x=\\tfrac{3}{4}$, ordered in increasing coordinate as $\\{0,\\tfrac{1}{4},\\tfrac{1}{2},\\tfrac{3}{4},1\\}$. Let $K^{\\mathrm{FEM}} \\in \\mathbb{R}^{5 \\times 5}$ denote the corresponding global stiffness matrix assembled from the elemental matrices for the same bilinear form $a(\\cdot,\\cdot)$.\n\nDefinition of bandwidth. For a symmetric matrix $A \\in \\mathbb{R}^{n\\times n}$, define its bandwidth $B(A)$ as the total number of nonzero diagonals, i.e.,\n$$B(A) = 2\\,\\beta(A) - 1,\\quad \\beta(A) = 1 + \\max\\{\\,i-j \\;:\\; A_{ij} \\neq 0,\\ i \\ge j\\,\\}.$$\n\nPart C (Comparison). Determine $B(K)$ and $B(K^{\\mathrm{FEM}})$ as defined above, and provide the ratio \n$$\\frac{B(K)}{B(K^{\\mathrm{FEM}})}.$$\n\nProvide your final answer as a single real number. No rounding is required and no units are involved.", "solution": "The problem is evaluated as valid, as it is self-contained, scientifically grounded in the field of numerical analysis, and well-posed. We can therefore proceed with a full solution.\n\nThe problem asks for a comparison of the bandwidth of the stiffness matrices resulting from an Isogeometric Analysis (IGA) and a standard Finite Element Method (FEM) for a one-dimensional Poisson problem. The bilinear form is given by $a(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx$.\n\nPart A: Isogeometric Analysis Stiffness Matrix $K$\n\nThe IGA is based on quadratic B-splines ($p=2$) on the open knot vector $U = \\{0,0,0,\\frac{1}{2},1,1,1\\}$. This knot vector has $m+1=7$ knots, so $m=6$. For a polynomial degree $p=2$, the number of basis functions is $n+1$, where $m=n+p+1$. This gives $6=n+2+1$, so $n=3$, which means there are $4$ basis functions, denoted $\\{N_{i,2}(x)\\}_{i=0}^{3}$. The interior knot $\\tfrac{1}{2}$ has multiplicity $1$, which ensures $C^{p-1} = C^1$ continuity.\n\nThe B-spline basis functions $N_{i,2}(x)$ can be derived using the Cox-de Boor recursion formula. For the given knot vector, they are defined piecewise on the knot spans $[0, \\frac{1}{2}]$ and $[\\frac{1}{2}, 1]$.\nThe four basis functions are:\n$N_{0,2}(x) = \\begin{cases} (1-2x)^2  \\text{if } x \\in [0, \\frac{1}{2}] \\\\ 0  \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N_{1,2}(x) = \\begin{cases} 4x-6x^2  \\text{if } x \\in [0, \\frac{1}{2}] \\\\ 2(1-x)^2  \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N_{2,2}(x) = \\begin{cases} 2x^2  \\text{if } x \\in [0, \\frac{1}{2}] \\\\ -6x^2+8x-2  \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N_{3,2}(x) = \\begin{cases} 0  \\text{if } x \\in [0, \\frac{1}{2}] \\\\ (2x-1)^2  \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}$\n\nThe derivatives $N'_{i,2}(x)$ are:\n$N'_{0,2}(x) = \\begin{cases} -4(1-2x)  \\text{if } x \\in [0, \\frac{1}{2}] \\\\ 0  \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N'_{1,2}(x) = \\begin{cases} 4-12x  \\text{if } x \\in [0, \\frac{1}{2}] \\\\ -4(1-x)  \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N'_{2,2}(x) = \\begin{cases} 4x  \\text{if } x \\in [0, \\frac{1}{2}] \\\\ -12x+8  \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N'_{3,2}(x) = \\begin{cases} 0  \\text{if } x \\in [0, \\frac{1}{2}] \\\\ 4(2x-1)  \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}$\n\nThe entries of the stiffness matrix $K_{ij} = \\int_{0}^{1} N'_{i,2}(x)\\,N'_{j,2}(x)\\,dx$ are computed below. The matrix $K$ is symmetric, so we compute entries for $i \\le j$.\n$K_{00} = \\int_0^{1/2} (-4(1-2x))^2 dx = 16 \\int_0^{1/2} (1-4x+4x^2) dx = 16[x-2x^2+\\frac{4}{3}x^3]_0^{1/2} = \\frac{8}{3}$.\n$K_{01} = \\int_0^{1/2} -4(1-2x)(4-12x) dx = -16 \\int_0^{1/2} (1-5x+6x^2)dx = -16[x-\\frac{5}{2}x^2+2x^3]_0^{1/2} = -2$.\n$K_{02} = \\int_0^{1/2} -4(1-2x)(4x) dx = -16 \\int_0^{1/2} (x-2x^2)dx = -16[\\frac{x^2}{2}-\\frac{2x^3}{3}]_0^{1/2} = -16(\\frac{1}{24}) = -\\frac{2}{3}$.\n$K_{03} = \\int_0^1 N'_{0,2}N'_{3,2} dx = 0$, since their supports intersect only at a single point.\n\n$K_{11} = \\int_0^{1/2} (4-12x)^2 dx + \\int_{1/2}^1 (-4(1-x))^2 dx = 2 + \\frac{2}{3} = \\frac{8}{3}$.\n$K_{12} = \\int_0^{1/2} (4-12x)(4x)dx + \\int_{1/2}^1 (-4(1-x))(-12x+8)dx = [8x^2-16x^3]_0^{1/2} + 16[-x^3+\\frac{5}{2}x^2-2x]_{1/2}^1 = 0+0 = 0$.\n$K_{13} = \\int_{1/2}^1 (-4(1-x))(4(2x-1))dx = -16\\int_{1/2}^1(-2x^2+3x-1)dx = -16[-\\frac{2}{3}x^3+\\frac{3}{2}x^2-x]_{1/2}^1 = -16(\\frac{1}{24}) = -\\frac{2}{3}$.\n\n$K_{22} = \\int_0^{1/2} (4x)^2 dx + \\int_{1/2}^1 (-12x+8)^2 dx = \\frac{2}{3} + 2 = \\frac{8}{3}$.\nBy symmetry of the basis functions ($N_{i,2}(x)=N_{n-i,2}(1-x)$ for $n=3$), we have $K_{ij}=K_{n-j,n-i}$.\n$K_{23} = K_{3-3,3-2} = K_{01} = -2$.\n$K_{33} = K_{3-3,3-3} = K_{00} = \\frac{8}{3}$.\n\nThe complete stiffness matrix $K \\in \\mathbb{R}^{4 \\times 4}$ is:\n$$ K = \\begin{pmatrix} \\frac{8}{3}  -2  -\\frac{2}{3}  0 \\\\ -2  \\frac{8}{3}  0  -\\frac{2}{3} \\\\ -\\frac{2}{3}  0  \\frac{8}{3}  -2 \\\\ 0  -\\frac{2}{3}  -2  \\frac{8}{3} \\end{pmatrix} $$\nThe nonzero entries have been explicitly computed.\n\nPart B: Standard $C^0$ Quadratic FEM Stiffness Matrix $K^{\\mathrm{FEM}}$\n\nThe FEM uses $C^0$ quadratic elements on the same partition $[0, \\frac{1}{2}]$ and $[\\frac{1}{2}, 1]$.\nThe global nodes are $\\{0, \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}, 1\\}$, numbered $0$ to $4$. This leads to a $5\\times 5$ matrix $K^{\\mathrm{FEM}}$.\nElement $1$ connects nodes $\\{0,1,2\\}$. Element $2$ connects nodes $\\{2,3,4\\}$.\nAn entry $K^{\\mathrm{FEM}}_{ij}$ is non-zero if and only if nodes $i$ and $j$ belong to the same element.\nThe structure of $K^{\\mathrm{FEM}}$ has non-zero entries in a $3\\times 3$ block for indices $\\{0,1,2\\}$ and another $3 \\times 3$ block for indices $\\{2,3,4\\}$. Schematically:\n$$ K^{\\mathrm{FEM}} = \\begin{pmatrix} *  *  *  0  0 \\\\ *  *  *  0  0 \\\\ *  *  *  *  * \\\\ 0  0  *  *  * \\\\ 0  0  *  *  * \\end{pmatrix} $$\nwhere $*$ denotes a non-zero entry.\n\nPart C: Comparison of Bandwidths\n\nThe bandwidth $B(A)$ is defined as $B(A) = 2\\,\\beta(A) - 1$, where $\\beta(A) = 1 + \\max\\{\\,i-j \\;:\\; A_{ij} \\neq 0,\\ i \\ge j\\,\\}$.\nThe term $b = \\max\\{\\,i-j \\;:\\; A_{ij} \\neq 0,\\ i \\ge j\\,\\}$ is the number of non-zero sub-diagonals.\n\nFor the IGA matrix $K$:\nThe non-zero entries $K_{ij}$ for $i \\ge j$ are at positions $(0,0)$, $(1,0)$, $(1,1)$, $(2,0)$, $(2,2)$, $(3,1)$, $(3,2)$, $(3,3)$. Note that $K_{21}=K_{12}=0$.\nThe differences $i-j$ for these non-zero off-diagonal entries are $1-0=1$, $2-0=2$, $3-1=2$, $3-2=1$.\nThe maximum difference is $\\max\\{1,2\\} = 2$.\nSo, $\\beta(K) = 1 + 2 = 3$.\nThe bandwidth is $B(K) = 2 \\times 3 - 1 = 5$.\n\nFor the FEM matrix $K^{\\mathrm{FEM}}$:\nThe non-zero entries $K^{\\mathrm{FEM}}_{ij}$ for $i \\ge j$ correspond to pairs of nodes within an element.\nFor element $1$: pairs are $(1,0), (2,0), (2,1)$, giving differences $1, 2, 1$.\nFor element $2$: pairs are $(3,2), (4,2), (4,3)$, giving differences $1, 2, 1$.\nThe maximum difference is $\\max\\{1,2\\} = 2$.\nSo, $\\beta(K^{\\mathrm{FEM}}) = 1 + 2 = 3$.\nThe bandwidth is $B(K^{\\mathrm{FEM}}) = 2 \\times 3 - 1 = 5$.\n\nFinally, the ratio of the bandwidths is:\n$$\\frac{B(K)}{B(K^{\\mathrm{FEM}})} = \\frac{5}{5} = 1.$$\nThe bandwidths of the stiffness matrices for this specific IGA and FEM setup are identical.", "answer": "$$\\boxed{1}$$", "id": "3393185"}]}