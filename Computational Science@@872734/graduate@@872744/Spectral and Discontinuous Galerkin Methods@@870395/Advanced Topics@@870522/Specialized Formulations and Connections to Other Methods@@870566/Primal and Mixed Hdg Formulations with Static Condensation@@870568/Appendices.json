{"hands_on_practices": [{"introduction": "The first step in understanding static condensation is to derive the local solver, which expresses element-interior unknowns in terms of the unknown traces on the element's boundary. This practice guides you through this fundamental derivation for the simplest case: a lowest-order ($k=0$) mixed HDG method on a single tetrahedral element. You will see how the local solution $(\\boldsymbol{q}_{h}, u_{h})$ is explicitly determined by the facet data $\\widehat{u}_{h}$ and the source term [@problem_id:3410467].", "problem": "Consider the steady diffusion model in mixed form on a single tetrahedral element $K \\subset \\mathbb{R}^{3}$ with boundary $\\partial K = \\bigcup_{i=1}^{4} F_{i}$ and outward unit normals $\\boldsymbol{n}_{i}$ on faces $F_{i}$:\n$$\n\\kappa^{-1} \\,\\boldsymbol{q} + \\nabla u = \\boldsymbol{0}, \n\\qquad \\nabla \\cdot \\boldsymbol{q} = f \\quad \\text{in } K,\n$$\nwhere the conductivity $\\kappa>0$ is constant on $K$ and $f \\in L^{2}(K)$ is a given source. Let $|K|$ denote the volume of $K$, $|F_{i}|$ the area of face $F_{i}$, and $\\boldsymbol{n}_{i}$ the outward unit normal to $F_{i}$.\n\nAdopt the mixed Hybridizable Discontinuous Galerkin (HDG) method of degree $k=0$ on $K$, namely take the local approximation spaces $\\boldsymbol{V}_{h}(K) = [\\mathcal{P}_{0}(K)]^{3}$ and $W_{h}(K) = \\mathcal{P}_{0}(K)$ for the flux $\\boldsymbol{q}_{h}$ and scalar $u_{h}$, respectively, and the trace space $M_{h}(F_{i}) = \\mathcal{P}_{0}(F_{i})$ for the facet unknown $\\widehat{u}_{i}$ on each face $F_{i}$. Let the stabilization parameters be $\\tau_{i} > 0$, constant on each face $F_{i}$. The numerical normal flux on face $F_{i}$ is defined by\n$$\n\\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} \\;=\\; \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} \\;+\\; \\tau_{i}\\,\\big(u_{h} - \\widehat{u}_{i}\\big).\n$$\nThe local HDG equations on $K$ are: find $(\\boldsymbol{q}_{h}, u_{h}) \\in \\boldsymbol{V}_{h}(K) \\times W_{h}(K)$, given the facet data $\\widehat{u}_{i} \\in M_{h}(F_{i})$ for $i \\in \\{1,2,3,4\\}$, such that for all $\\boldsymbol{r} \\in \\boldsymbol{V}_{h}(K)$ and $w \\in W_{h}(K)$,\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} - \\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} + \\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = 0,\n$$\n$$\n-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} + \\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K},\n$$\nwith $\\widehat{u}_{h}|_{F_{i}} = \\widehat{u}_{i}$ and $\\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}$ as above. Here $(\\cdot,\\cdot)_{K}$ is the $L^{2}(K)$ inner product and $\\langle \\cdot, \\cdot \\rangle_{\\partial K}$ is the $L^{2}(\\partial K)$ duality pairing.\n\nUsing only foundational definitions and identities, derive the explicit local solution operator on $K$ mapping the four facet trace constants $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$ and the source $f$ to the two element unknowns $(\\boldsymbol{q}_{h}, u_{h})$. Express your final result for $(\\boldsymbol{q}_{h}, u_{h})$ solely in terms of $\\kappa$, $|K|$, $\\{|F_{i}|\\}_{i=1}^{4}$, $\\{\\boldsymbol{n}_{i}\\}_{i=1}^{4}$, $\\{\\tau_{i}\\}_{i=1}^{4}$, $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$, and $\\int_{K} f \\, dx$. Your final answer must be a single closed-form analytic expression. Do not perform any numerical evaluation.", "solution": "The problem requires the derivation of the explicit local solution operator for the mixed Hybridizable Discontinuous Galerkin (HDG) method of degree $k=0$ on a single tetrahedral element $K$. This operator maps the constant trace values on each face, $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$, and the source function $f$ to the constant-on-element unknowns $(\\boldsymbol{q}_{h}, u_{h})$.\n\nThe local approximation spaces are $\\boldsymbol{V}_{h}(K) = [\\mathcal{P}_{0}(K)]^{3}$ and $W_{h}(K) = \\mathcal{P}_{0}(K)$. This means that the approximate flux $\\boldsymbol{q}_{h}$ is a constant vector on $K$, and the approximate scalar solution $u_{h}$ is a constant scalar on $K$. Similarly, the test functions $\\boldsymbol{r} \\in \\boldsymbol{V}_{h}(K)$ and $w \\in W_{h}(K)$ are a constant vector and a constant scalar, respectively.\n\nLet's analyze the two local HDG equations provided.\n\nThe first equation is:\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} - \\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} + \\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = 0, \\quad \\forall \\boldsymbol{r} \\in [\\mathcal{P}_{0}(K)]^{3}\n$$\nSince $\\boldsymbol{r}$ is a constant vector on $K$, its divergence is identically zero: $\\nabla \\cdot \\boldsymbol{r} = 0$. Consequently, the second term vanishes: $\\big(u_{h}, \\nabla \\cdot \\boldsymbol{r}\\big)_{K} = 0$.\n\nThe remaining terms can be simplified. Since $\\kappa^{-1}$, $\\boldsymbol{q}_{h}$, and $\\boldsymbol{r}$ are constant on $K$, the first term is:\n$$\n\\big(\\kappa^{-1}\\boldsymbol{q}_{h},\\boldsymbol{r}\\big)_{K} = \\int_{K} \\kappa^{-1} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{r} \\, dx = \\kappa^{-1} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{r}) |K|\n$$\nThe boundary term is a sum over the four faces $F_{i}$ of the tetrahedron:\n$$\n\\langle \\widehat{u}_{h}, \\boldsymbol{r}\\cdot \\boldsymbol{n} \\rangle_{\\partial K} = \\sum_{i=1}^{4} \\int_{F_{i}} \\widehat{u}_{h} (\\boldsymbol{r} \\cdot \\boldsymbol{n}_{i}) \\, dS\n$$\nOn each face $F_{i}$, the trace approximation $\\widehat{u}_{h}$ is a constant $\\widehat{u}_{i} \\in \\mathcal{P}_{0}(F_{i})$. The test function $\\boldsymbol{r}$ and the normal vector $\\boldsymbol{n}_{i}$ are also constant on $F_{i}$. Therefore, the integral becomes:\n$$\n\\sum_{i=1}^{4} \\widehat{u}_{i} (\\boldsymbol{r} \\cdot \\boldsymbol{n}_{i}) |F_{i}| = \\boldsymbol{r} \\cdot \\left( \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right)\n$$\nSubstituting these simplified terms back into the first HDG equation yields:\n$$\n\\kappa^{-1} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{r}) |K| + \\boldsymbol{r} \\cdot \\left( \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right) = 0\n$$\n$$\n\\boldsymbol{r} \\cdot \\left( \\kappa^{-1} |K| \\boldsymbol{q}_{h} + \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} \\right) = 0\n$$\nThis equation must hold for any constant vector $\\boldsymbol{r} \\in [\\mathcal{P}_{0}(K)]^{3}$. This implies that the term in the parenthesis must be the zero vector:\n$$\n\\kappa^{-1} |K| \\boldsymbol{q}_{h} + \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i} = \\boldsymbol{0}\n$$\nSolving for $\\boldsymbol{q}_{h}$ gives the first part of the local solution operator:\n$$\n\\boldsymbol{q}_{h} = - \\frac{\\kappa}{|K|} \\sum_{i=1}^{4} \\widehat{u}_{i} |F_{i}| \\boldsymbol{n}_{i}\n$$\n\nThe second HDG equation is:\n$$\n-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} + \\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K}, \\quad \\forall w \\in \\mathcal{P}_{0}(K)\n$$\nSince the test function $w$ is a constant scalar on $K$, its gradient is identically zero: $\\nabla w = \\boldsymbol{0}$. Thus, the first term vanishes: $-\\big(\\boldsymbol{q}_{h}, \\nabla w\\big)_{K} = 0$.\n\nThe equation simplifies to:\n$$\n\\langle \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n}, w \\rangle_{\\partial K} = (f,w)_{K}\n$$\nSince $w$ is constant, it can be factored out of the integrals:\n$$\nw \\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = w \\int_{K} f \\, dx\n$$\nAssuming $w \\neq 0$, we can divide by $w$ to get a statement of conservation for the numerical flux:\n$$\n\\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = \\int_{K} f \\, dx\n$$\nLet's expand the left-hand side using the definition of the numerical flux, $\\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} = \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})$:\n$$\n\\int_{\\partial K} \\widehat{\\boldsymbol{q}}_{h}\\cdot\\boldsymbol{n} \\, dS = \\sum_{i=1}^{4} \\int_{F_{i}} \\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n}_{i} \\, dS = \\sum_{i=1}^{4} \\int_{F_{i}} \\big(\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})\\big) \\, dS\n$$\nSince $\\boldsymbol{q}_{h}$, $u_{h}$, $\\tau_{i}$, and $\\widehat{u}_{i}$ are constant on their respective domains, the integral becomes:\n$$\n\\sum_{i=1}^{4} \\big(\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i} + \\tau_{i}(u_{h} - \\widehat{u}_{i})\\big) |F_{i}| = \\left( \\sum_{i=1}^{4} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i}) |F_{i}| \\right) + \\left( \\sum_{i=1}^{4} \\tau_{i}(u_{h} - \\widehat{u}_{i}) |F_{i}| \\right)\n$$\nThe first summation term can be rewritten as $\\int_{\\partial K} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n} \\, dS$. Since $\\boldsymbol{q}_{h}$ is a constant vector, we can apply the divergence theorem:\n$$\n\\sum_{i=1}^{4} (\\boldsymbol{q}_{h} \\cdot \\boldsymbol{n}_{i}) |F_{i}| = \\int_{\\partial K} \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n} \\, dS = \\int_{K} \\nabla \\cdot \\boldsymbol{q}_{h} \\, dx\n$$\nAs $\\boldsymbol{q}_{h}$ is constant, $\\nabla \\cdot \\boldsymbol{q}_{h} = 0$, so this term is zero. This is a crucial simplification for $\\mathcal{P}_{0}$ elements.\n\nThe conservation equation thus reduces to:\n$$\n\\sum_{i=1}^{4} \\tau_{i}(u_{h} - \\widehat{u}_{i}) |F_{i}| = \\int_{K} f \\, dx\n$$\nWe can now solve for the constant scalar unknown $u_{h}$:\n$$\n\\sum_{i=1}^{4} \\tau_{i} u_{h} |F_{i}| - \\sum_{i=1}^{4} \\tau_{i} \\widehat{u}_{i} |F_{i}| = \\int_{K} f \\, dx\n$$\n$$\nu_{h} \\left( \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\right) = \\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}\n$$\nSince $\\tau_i > 0$ and $|F_i| > 0$, the sum in the parenthesis is strictly positive. Solving for $u_{h}$ gives the second part of the local solution operator:\n$$\nu_{h} = \\frac{\\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}}{\\sum_{j=1}^{4} \\tau_{j} |F_{j}|}\n$$\n(A different summation index $j$ is used in the denominator for clarity.)\n\nCombining the expressions for $\\boldsymbol{q}_{h}$ and $u_{h}$, we obtain the explicit local solution operator that maps $\\{\\widehat{u}_{i}\\}_{i=1}^{4}$ and $f$ to $(\\boldsymbol{q}_{h}, u_{h})$.", "answer": "$$\n\\boxed{\\left( -\\frac{\\kappa}{|K|} \\sum_{i=1}^{4} |F_{i}| \\widehat{u}_{i} \\boldsymbol{n}_{i}, \\quad \\frac{\\int_{K} f \\, dx + \\sum_{i=1}^{4} \\tau_{i} |F_{i}| \\widehat{u}_{i}}{\\sum_{j=1}^{4} \\tau_{j} |F_{j}|} \\right)}\n$$", "id": "3410467"}, {"introduction": "After deriving the local solver, the next step is to formulate the global problem that involves only the trace variables. This is achieved by constructing a local Dirichlet-to-Neumann (DtN) map, which is the local Schur complement matrix. This exercise simplifies the geometry to one dimension and uses lowest-order polynomials to reveal how the DtN map is formed and how its spectral properties depend critically on the stabilization parameter $\\tau$ [@problem_id:3410511].", "problem": "Consider the scalar Poisson equation in one spatial dimension on a single element $K=[0,1]$, written in first-order form as $q=\\nabla u$ and $-\\nabla\\cdot q=f$, with $f=0$ on $K$. Use the Hybridizable Discontinuous Galerkin (HDG) method in its mixed formulation and apply static condensation to eliminate local unknowns. Assume the following polynomial spaces for the local interior approximations: $u\\in \\mathcal{P}_{0}(K)$ and $q\\in \\mathcal{P}_{0}(K)$, where $\\mathcal{P}_{0}(K)$ denotes the space of constant polynomials on $K$. On the element boundary $\\partial K=\\{0,1\\}$, take the trace unknown $\\hat{u}$ to be constant per face (i.e., one degree of freedom per endpoint), so that the two face values $\\hat{u}(0)$ and $\\hat{u}(1)$ are distinct unknowns. The stabilization parameter is a constant $\\tau>0$.\n\nAdopt the canonical mixed HDG local formulation:\n- For all test functions $r\\in \\mathcal{P}_{0}(K)$, enforce $(q,r)_{K}=-(u,\\nabla\\cdot r)_{K}+\\langle \\hat{u}, r\\,n\\rangle_{\\partial K}$.\n- For all test functions $v\\in \\mathcal{P}_{0}(K)$, enforce $-(\\nabla\\cdot q,v)_{K}+\\langle \\widehat{q}\\,n, v\\rangle_{\\partial K}=(f,v)_{K}$ with the numerical flux $\\widehat{q}\\,n = q\\,n + \\tau\\,(u - \\hat{u})$.\n\nHere $n$ denotes the outward unit normal on $\\partial K$, $(\\cdot,\\cdot)_{K}$ is the standard $L^{2}(K)$ inner product, and $\\langle\\cdot,\\cdot\\rangle_{\\partial K}$ is the boundary duality pairing which, in one dimension for this element, reduces to weighted point evaluations with $n(0)=-1$ and $n(1)=+1$.\n\nDefine the local Dirichlet-to-Neumann map (the Schur complement) $S(\\tau)$ that sends the trace vector $\\begin{pmatrix}\\hat{u}(0)\\\\ \\hat{u}(1)\\end{pmatrix}$ to the vector of numerical fluxes on the left and right faces, $\\begin{pmatrix}\\lambda_{L}\\\\ \\lambda_{R}\\end{pmatrix}=\\begin{pmatrix}-q(0)+\\tau\\,(u(0)-\\hat{u}(0))\\\\ q(1)+\\tau\\,(u(1)-\\hat{u}(1))\\end{pmatrix}$. Starting only from the stated mixed HDG formulation and spaces, derive $S(\\tau)$ by eliminating the interior unknowns $u$ and $q$ and then determine its spectrum. Compute the unique nonzero eigenvalue $\\lambda(\\tau)$ of $S(\\tau)$ exactly, as a closed-form expression in $\\tau$.\n\nIn your derivation, make explicit use of the first-order system and the mixed HDG weak form, the orientation $n(0)=-1$, $n(1)=+1$, and the stabilization $\\tau$. Study the limits $\\tau\\to 0$ and $\\tau\\to\\infty$ to justify invertibility of the local solver on the non-constant trace subspace. Your final answer must be the analytic expression for the unique nonzero eigenvalue $\\lambda(\\tau)$. No rounding is required and no physical units are involved. Express the final answer in exact form.", "solution": "The problem asks for the derivation of the local Dirichlet-to-Neumann (DtN) map, also known as the Schur complement matrix, for a 1D mixed HDG formulation with constant ($ \\mathcal{P}_0 $) basis functions. We then need to find its unique non-zero eigenvalue.\n\n**1. Derivation of the Local Solver**\n\nLet the constant approximations on the element $ K=[0,1] $ be $ u(x) = u_0 $ and $ q(x) = q_0 $. The trace unknowns are two scalars, $ \\hat{u}_0 = \\hat{u}(0) $ and $ \\hat{u}_1 = \\hat{u}(1) $. We use the constant basis functions $ r(x)=1 $ and $ v(x)=1 $ as test functions.\n\nFirst, consider the weak form for the flux equation:\n$$ (q,r)_{K}=-(u,\\nabla\\cdot r)_{K}+\\langle \\hat{u}, r\\,n\\rangle_{\\partial K} $$\nWith $ r=1 $, we have $ \\nabla \\cdot r = r' = 0 $. The equation simplifies to:\n$$ \\int_0^1 q_0 \\cdot 1 \\, dx = 0 + \\left( \\hat{u}(1) r(1) n(1) + \\hat{u}(0) r(0) n(0) \\right) $$\nUsing $ n(1)=1 $ and $ n(0)=-1 $, we get:\n$$ q_0 = \\hat{u}_1 \\cdot 1 \\cdot (+1) + \\hat{u}_0 \\cdot 1 \\cdot (-1) = \\hat{u}_1 - \\hat{u}_0 $$\nThis equation expresses the interior flux unknown $ q_0 $ directly in terms of the trace unknowns.\n\nSecond, consider the weak form for the conservation equation:\n$$ -(\\nabla\\cdot q,v)_{K}+\\langle \\widehat{q}\\,n, v\\rangle_{\\partial K}=(f,v)_{K} $$\nWith $ q(x) = q_0 $ (constant), we have $ \\nabla \\cdot q = q' = 0 $. The problem states $ f=0 $, and we use the test function $ v=1 $. The equation becomes:\n$$ 0 + \\langle \\widehat{q}\\,n, 1\\rangle_{\\partial K} = 0 $$\n$$ \\left( \\widehat{q}\\,n \\right)|_{x=1} + \\left( \\widehat{q}\\,n \\right)|_{x=0} = 0 $$\nThe numerical flux is $ \\widehat{q}\\,n = q\\,n + \\tau(u - \\hat{u}) $.\nAt $ x=1 $, $ n=1 $: $ (\\widehat{q}\\,n)|_1 = q_0 \\cdot 1 + \\tau(u_0 - \\hat{u}_1) = q_0 + \\tau(u_0 - \\hat{u}_1) $.\nAt $ x=0 $, $ n=-1 $: $ (\\widehat{q}\\,n)|_0 = q_0 \\cdot (-1) + \\tau(u_0 - \\hat{u}_0) = -q_0 + \\tau(u_0 - \\hat{u}_0) $.\nSubstituting these into the conservation equation:\n$$ (q_0 + \\tau(u_0 - \\hat{u}_1)) + (-q_0 + \\tau(u_0 - \\hat{u}_0)) = 0 $$\n$$ 2\\tau u_0 - \\tau(\\hat{u}_0 + \\hat{u}_1) = 0 $$\nSince $ \\tau > 0 $, we can solve for the interior scalar unknown $ u_0 $:\n$$ u_0 = \\frac{\\hat{u}_0 + \\hat{u}_1}{2} $$\nThis shows that the interior solution is the average of the trace values, which is expected for a constant approximation of what should be a linear solution for $f=0$.\n\nThe local solver, which maps traces to interior unknowns, is thus:\n$ q_0 = \\hat{u}_1 - \\hat{u}_0 $\n$ u_0 = \\frac{1}{2}(\\hat{u}_0 + \\hat{u}_1) $\nThis mapping is always well-defined and invertible.\n\n**2. Derivation of the Dirichlet-to-Neumann (DtN) Map**\n\nThe DtN map $ S(\\tau) $ relates the trace vector $ \\begin{pmatrix} \\hat{u}_0 \\\\ \\hat{u}_1 \\end{pmatrix} $ to the numerical flux vector $ \\begin{pmatrix} \\lambda_L \\\\ \\lambda_R \\end{pmatrix} $. The problem defines the flux components as:\n$ \\lambda_L = -q(0)+\\tau(u(0)-\\hat{u}(0)) = -q_0 + \\tau(u_0 - \\hat{u}_0) $\n$ \\lambda_R = q(1)+\\tau(u(1)-\\hat{u}(1)) = q_0 + \\tau(u_0 - \\hat{u}_1) $\n\nWe substitute the expressions for $ u_0 $ and $ q_0 $ into these definitions:\n$$\n\\lambda_L = -(\\hat{u}_1 - \\hat{u}_0) + \\tau \\left( \\frac{\\hat{u}_0 + \\hat{u}_1}{2} - \\hat{u}_0 \\right) = \\hat{u}_0 - \\hat{u}_1 + \\tau \\left( \\frac{\\hat{u}_1 - \\hat{u}_0}{2} \\right) = (\\hat{u}_0 - \\hat{u}_1) \\left( 1 - \\frac{\\tau}{2} \\right)\n$$\n$$\n\\lambda_R = (\\hat{u}_1 - \\hat{u}_0) + \\tau \\left( \\frac{\\hat{u}_0 + \\hat{u}_1}{2} - \\hat{u}_1 \\right) = \\hat{u}_1 - \\hat{u}_0 + \\tau \\left( \\frac{\\hat{u}_0 - \\hat{u}_1}{2} \\right) = (\\hat{u}_1 - \\hat{u}_0) \\left( 1 - \\frac{\\tau}{2} \\right)\n$$\nIn matrix form, $ \\begin{pmatrix} \\lambda_L \\\\ \\lambda_R \\end{pmatrix} = S(\\tau) \\begin{pmatrix} \\hat{u}_0 \\\\ \\hat{u}_1 \\end{pmatrix} $, this is:\n$$\n\\begin{pmatrix} \\lambda_L \\\\ \\lambda_R \\end{pmatrix} = \\begin{pmatrix} (1 - \\frac{\\tau}{2}) & -(1 - \\frac{\\tau}{2}) \\\\ -(1 - \\frac{\\tau}{2}) & (1 - \\frac{\\tau}{2}) \\end{pmatrix} \\begin{pmatrix} \\hat{u}_0 \\\\ \\hat{u}_1 \\end{pmatrix}\n$$\nSo, the DtN map is:\n$$\nS(\\tau) = \\left(1 - \\frac{\\tau}{2}\\right) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n\n**3. Spectrum of the DtN Map**\n\nTo find the eigenvalues of $ S(\\tau) $, we solve the characteristic equation $ \\det(S(\\tau) - \\lambda I) = 0 $. Let $ a = 1 - \\frac{\\tau}{2} $. The equation is:\n$$\n\\det \\begin{pmatrix} a-\\lambda & -a \\\\ -a & a-\\lambda \\end{pmatrix} = (a-\\lambda)^2 - (-a)^2 = (a-\\lambda-a)(a-\\lambda+a) = (-\\lambda)(2a-\\lambda) = 0\n$$\nThe eigenvalues are $ \\lambda_1 = 0 $ and $ \\lambda_2 = 2a $.\nSubstituting back $ a = 1 - \\tau/2 $, the eigenvalues are $ 0 $ and $ 2(1 - \\tau/2) = 2 - \\tau $.\n\nThe question asks for the unique non-zero eigenvalue, which is:\n$$ \\lambda(\\tau) = 2 - \\tau $$\n\n**4. Invertibility and Limits**\n\nThe invertibility of the local solver for $ (u_0, q_0) $ is guaranteed for any $ \\tau > 0 $, as the system matrix for the local unknowns is always non-singular. The problem's phrasing likely refers to the invertibility of the DtN map $S(\\tau)$ when restricted to the non-constant trace subspace. The eigenvector for the zero eigenvalue is $ (1,1)^T $, spanning the constant trace subspace. The eigenvector for the non-zero eigenvalue $ \\lambda(\\tau) = 2-\\tau $ is $ (1,-1)^T $, which spans the non-constant trace subspace. The action of $ S(\\tau) $ on this subspace is multiplication by $ 2-\\tau $.\n\n- As $ \\tau \\to 0 $, $ \\lambda(\\tau) \\to 2 \\neq 0 $.\n- As $ \\tau \\to \\infty $, $ \\lambda(\\tau) \\to -\\infty \\neq 0 $.\n\nIn both limits, the DtN map is invertible on the non-constant trace subspace. It is only non-invertible for the specific case $ \\tau=2 $. The fact that the local solver (mapping traces to interior solutions) is well-defined for all $ \\tau > 0 $ while the DtN map can become singular highlights that static condensation is a formal algebraic procedure whose resulting operator properties must be analyzed carefully.", "answer": "$$\\boxed{2-\\tau}$$", "id": "3410511"}, {"introduction": "With a full HDG solution available, a key application is to assess its accuracy and guide computational effort where it is most needed. This practice delves into a powerful technique: a posteriori error estimation. You will construct a residual-based error indicator using the computed local solutions $(\\boldsymbol{q}_{h}, u_{h})$ and the jumps in the numerical flux across element facets, providing a cornerstone for adaptive mesh refinement strategies [@problem_id:3410464].", "problem": "Consider the scalar Poisson problem on a bounded, simply connected, polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with homogeneous Dirichlet boundary condition: find $u \\in H_{0}^{1}(\\Omega)$ such that $-\\Delta u = f$ in $\\Omega$, where $f \\in L^{2}(\\Omega)$. Introduce the first-order system $q + \\nabla u = 0$ and $\\nabla \\cdot q = f$. Let $\\mathcal{T}_{h}$ be a shape-regular conforming triangulation of $\\Omega$ into triangles with element diameters $\\{h_{K}\\}_{K \\in \\mathcal{T}_{h}}$ and edge lengths $\\{h_{F}\\}_{F \\in \\mathcal{F}_{h}}$, where $\\mathcal{F}_{h}$ is the set of all open edges.\n\nOn $\\mathcal{T}_{h}$, consider the Hybridizable Discontinuous Galerkin (HDG) method, with local unknowns $(q_{h},u_{h})$ in piecewise polynomial spaces on each $K \\in \\mathcal{T}_{h}$ and a global hybrid trace $\\hat{u}_{h}$ on the mesh skeleton $\\mathcal{F}_{h}$, and stabilization parameter $\\tau_{F} > 0$ on each $F \\in \\mathcal{F}_{h}$. Assume that static condensation is performed so that the global linear system involves only the hybrid trace degrees of freedom, while the elementwise fields $(q_{h},u_{h})$ are recovered locally.\n\nYour tasks are as follows.\n\n1. Starting from the first-order system and the local HDG equations, construct an elementwise residual-based a posteriori error estimator that uses only:\n   - element residuals of the strong equations, and\n   - facet jumps of the normal component of the discrete flux.\n   The estimator must be defined entirely in terms of computable quantities $(q_{h},u_{h},\\hat{u}_{h})$, the data $f$, and the mesh scales $h_{K}$ and $h_{F}$. Use mesh-dependent weights to ensure that the contributions are balanced and dimensionally consistent. Clearly state the definitions of all residuals and jumps you employ.\n\n2. Under standard assumptions (shape-regular meshes, polynomial degree at least one, and $f \\in L^{2}(\\Omega)$), argue that your estimator is reliable and locally efficient up to data oscillation. Specifically, define a natural energy norm for the error in the HDG mixed setting, and justify, from first principles and standard inequalities, that the global estimator controls the energy error from above, and that each local estimator controls the local error from below up to oscillation. Your argument should identify the role of bubble functions, inverse inequalities, and local stability of the HDG method. Explain why static condensation does not impair computability or the validity of the a posteriori bounds.\n\n3. Now specialize to a single element $K_{0} \\in \\mathcal{T}_{h}$ with diameter $h_{K_{0}} = 0.25$. Suppose $K_{0}$ has three edges $F_{1}$, $F_{2}$, and $F_{3}$ with lengths $h_{F_{1}} = 0.25$, $h_{F_{2}} = 0.25$, and $h_{F_{3}} = 0.3535533906$. Assume that the following elementwise and edgewise $L^{2}$-norms of the relevant quantities in your estimator have been computed:\n   - $\\|f + \\nabla \\cdot q_{h}\\|_{0,K_{0}} = 12$,\n   - $\\|q_{h} + \\nabla u_{h}\\|_{0,K_{0}} = 5$,\n   - $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{1}} = 8$, $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{2}} = 6$, and $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{3}} = 10$,\n   where $\\|\\cdot\\|_{0,D}$ denotes the $L^{2}$-norm on a domain $D$, $n$ is the outward unit normal, and $\\llbracket \\cdot \\rrbracket$ denotes the jump across an interior facet (equal to the trace on $F \\subset \\partial \\Omega$ if $F$ is a boundary facet). Using your estimator from Task 1, evaluate the local indicator for $K_{0}$, denoted $\\eta_{K_{0}}$. Round your final numerical answer to four significant figures. No units are required and your answer must be a single real number.", "solution": "The problem will first be validated against the criteria of scientific soundness, well-posedness, and objectivity.\n\n### Step 1: Extract Givens\nThe givens are as follows:\n- **Problem**: The scalar Poisson equation $-\\Delta u = f$ in a domain $\\Omega \\subset \\mathbb{R}^{2}$ with boundary condition $u = 0$ on $\\partial\\Omega$. The source term is $f \\in L^{2}(\\Omega)$.\n- **First-order system**: $q + \\nabla u = 0$ and $\\nabla \\cdot q = f$.\n- **Discretization**: A shape-regular conforming triangulation $\\mathcal{T}_{h}$ of $\\Omega$.\n- **Method**: A Hybridizable Discontinuous Galerkin (HDG) method with local unknowns $(q_{h}, u_{h})$, global hybrid trace $\\hat{u}_{h}$, and a stabilization parameter $\\tau_{F} > 0$. Static condensation is employed.\n- **Task 1**: Construct a residual-based a posteriori error estimator using element residuals $(f + \\nabla \\cdot q_{h}, q_{h} + \\nabla u_{h})$ and facet jumps of the normal flux, $\\llbracket q_{h} \\cdot n \\rrbracket$.\n- **Task 2**: Argue for the reliability and local efficiency of the estimator and explain the role of static condensation.\n- **Task 3 Data**: For a specific element $K_{0}$:\n    - Element diameter is given as $h_{K_{0}} = 0.25$.\n    - Edge lengths are $h_{F_{1}} = 0.25$, $h_{F_{2}} = 0.25$, and $h_{F_{3}} = 0.3535533906$.\n    - Norm of element residual 1: $\\|f + \\nabla \\cdot q_{h}\\|_{0,K_{0}} = 12$.\n    - Norm of element residual 2: $\\|q_{h} + \\nabla u_{h}\\|_{0,K_{0}} = 5$.\n    - Norms of facet jump residuals: $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{1}} = 8$, $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{2}} = 6$, $\\|\\llbracket q_{h} \\cdot n \\rrbracket\\|_{0,F_{3}} = 10$.\n- **Definition**: The jump operator $\\llbracket \\cdot \\rrbracket$ across an interior facet is the standard jump, and on a boundary facet, it is defined as the trace itself.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It addresses a standard topic in the numerical analysis of partial differential equations, namely a posteriori error estimation for HDG methods. The theoretical and computational tasks are clearly defined and based on established principles.\n\nThere is, however, a minor inconsistency in the provided data for Task $3$. The diameter of a triangle is the length of its longest side. For the element $K_0$, the edge lengths are given as $h_{F_1} = 0.25$, $h_{F_2} = 0.25$, and $h_{F_3} \\approx 0.35355$. The longest side is $F_3$, so the geometric diameter of $K_0$ is $h_{F_3} \\approx 0.35355$. The problem statement, however, explicitly provides \"diameter $h_{K_{0}} = 0.25$\". This is a contradiction. In the context of finite element analysis, $h_K$ is a characteristic length scale for an element $K$, which is often, but not necessarily, its geometric diameter. Since the problem provides an explicit value for the symbol $h_{K_0}$, we shall treat this as a definition for the calculation, despite the terminological inexactitude. This does not render the problem invalid, as a solvable procedure remains. The problem is thus deemed valid and a solution will be provided.\n\n### Solution\n\nThe solution is presented in three parts, corresponding to the tasks in the problem statement.\n\n**1. Construction of the A Posteriori Error Estimator**\n\nAn a posteriori error estimator provides a computable quantity that measures the discretization error. For the given first-order system, we seek an estimator for the error $(e_q, e_u) = (q-q_h, u-u_h)$. The estimator should be constructed from quantities available from the numerical solution $(q_h, u_h, \\hat{u}_h)$. The problem specifies using strong-form residuals and flux jumps.\n\nThe exact solution $(q, u)$ satisfies:\n$$\nq + \\nabla u = 0 \\quad \\text{in } K\n$$\n$$\n\\nabla \\cdot q = f \\quad \\text{in } K\n$$\nfor every element $K \\in \\mathcal{T}_h$. The discrete solution $(q_h, u_h)$ approximates this, but does not satisfy these equations exactly. This gives rise to element-wise residuals. Additionally, the normal component of the exact flux $q$ is continuous across element boundaries, i.e., $\\llbracket q \\cdot n \\rrbracket = 0$, whereas for the discrete flux $q_h$, this is not true. This gives rise to a facet residual.\n\nWe define the following residuals:\n- The interior element residual for the first equation is $R_{K,1} := q_h + \\nabla u_h$.\n- The interior element residual for the second equation is $R_{K,2} := f - \\nabla \\cdot q_h$.\n- The facet residual on an edge $F$ is the jump in the normal component of the flux, $J_F := \\llbracket q_h \\cdot n \\rrbracket$. The problem statement clarifies that for an interior edge $F = \\partial K_1 \\cap \\partial K_2$ with normal $n$ pointing from $K_1$ to $K_2$, $J_F = (q_h|_{K_1} - q_h|_{K_2}) \\cdot n$. For a boundary edge $F \\subset \\partial\\Omega$ belonging to element $K$, $J_F = q_h|_K \\cdot n$.\n\nTo construct the estimator, we must combine these residuals with appropriate weights to ensure dimensional consistency. Let $[u]$ be the physical unit of the solution $u$ and $[L]$ be the unit of length. Then $[f] = [u][L]^{-2}$ and $[q] = [u][L]^{-1}$. The energy norm of the error is dimensionless or has units of energy, but its square has units of $\\|q\\|^2 \\sim [u]^2$.\n- $\\|R_{K,1}\\|_{0,K}^2 = \\|q_h + \\nabla u_h\\|_{0,K}^2$ has units $([u][L]^{-1})^2 [L]^2 = [u]^2$.\n- $\\|R_{K,2}\\|_{0,K}^2 = \\|f - \\nabla \\cdot q_h\\|_{0,K}^2$ has units $([u][L]^{-2})^2 [L]^2 = [u]^2[L]^{-2}$. This must be multiplied by a factor with units $[L]^2$, which is $h_K^2$.\n- $\\|J_F\\|_{0,F}^2 = \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F}^2$ has units $([u][L]^{-1})^2 [L] = [u]^2[L]^{-1}$. This must be multiplied by a factor with units $[L]$, which is $h_F$.\n\nBased on this analysis, we define the local error indicator $\\eta_K$ for each element $K \\in \\mathcal{T}_h$ as:\n$$\n\\eta_{K}^2 := \\|q_h + \\nabla u_h\\|_{0,K}^2 + h_{K}^2 \\|f - \\nabla \\cdot q_h\\|_{0,K}^2 + \\sum_{F \\subset \\partial K} h_{F} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F}^2\n$$\nThe global error estimator $\\eta$ is then the Euclidean sum of the local indicators:\n$$\n\\eta := \\left( \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 \\right)^{1/2}\n$$\nNote that the problem provides the norm of $f + \\nabla \\cdot q_h$, which is equivalent to the norm of our defined residual $R_{K,2}$, as $\\|R_{K,2}\\|_{0,K} = \\|-(f-\\nabla \\cdot q_h)\\|_{0,K} = \\| \\nabla \\cdot q_h-f\\|_{0,K}$. The problem data seems to name the residual $f+\\nabla \\cdot q_h$, but this does not affect the norm. For the purpose of calculation, $\\|f - \\nabla \\cdot q_h\\|_{0,K_0} = \\|f + \\nabla \\cdot q_h\\|_{0,K_0} = 12$.\n\n**2. Reliability, Efficiency, and Static Condensation**\n\nA natural energy norm for the error $(e_q, e_u)=(q-q_h, u-u_h)$ in this mixed setting is given by\n$$\n\\|(e_q, e_u)\\|_{\\text{en}}^2 := \\|q-q_h\\|_{0,\\Omega}^2 + \\sum_{K \\in \\mathcal{T}_h} \\|\\nabla(u-u_h)\\|_{0,K}^2\n$$\nThis combines the $L^2$ error in the flux with the broken $H^1$ semi-norm error in the primal variable.\n\n- **Reliability**: The estimator is reliable if it provides an upper bound on the true error, up to data oscillations. That is,\n$$\n\\|(e_q, e_u)\\|_{\\text{en}} \\le C_{\\text{rel}} \\left( \\eta + \\text{osc} \\right)\n$$\nwhere $C_{\\text{rel}}$ is a constant independent of the mesh size $h$ and $\\text{osc}$ represents data oscillation terms (e.g., $h_K \\|f - \\Pi_k f\\|_{0,K}$ where $\\Pi_k f$ is a polynomial approximation of $f$). The argument for reliability follows from the error equations. By testing the weak form of the error equations with appropriate functions related to the error itself (e.g., interpolants), and using integration by parts (Green's formula), the error norm can be related to the sum of element and facet residuals. Key tools in the proof are the Cauchy-Schwarz inequality, trace inequalities to bound boundary terms, and Poincar√© inequalities on elements. The stability of the HDG formulation, guaranteed by the choice of the parameter $\\tau_F$ (typically $\\tau_F \\sim h_F^{-1}$), is crucial for controlling all terms that arise.\n\n- **Local Efficiency**: The estimator is locally efficient if the local indicator is controlled by the error in a local patch of elements, up to data oscillations. For each element $K$,\n$$\n\\eta_K \\le C_{\\text{eff}} \\left( \\|(e_q, e_u)\\|_{\\text{en}, \\omega_K} + \\text{osc}_K \\right)\n$$\nwhere $\\omega_K$ is a patch of elements including $K$ and its neighbors, and $\\text{osc}_K$ is the local data oscillation. The proof of efficiency relies on bubble functions. For instance, to bound the element residual $h_K \\|f - \\nabla \\cdot q_h\\|_{0,K}$, one constructs a suitable element bubble function $b_K$. By using properties of these bubble functions and inverse inequalities on finite-dimensional spaces (e.g., $\\|v_h\\|_{0,K} \\le C h_K^{-1} \\|v_h\\|_{-1,K}$), one can show that the residual term is bounded by the local error. A similar argument with edge bubble functions applies to the facet jump terms. The local stability of the HDG method ensures that a non-zero residual implies a non-zero local error.\n\n- **Role of Static Condensation**: Static condensation is an algebraic technique for solving the global linear system arising from the HDG formulation. It partitions the degrees of freedom into element-local variables $((q_h)_K, (u_h)_K)$ and globally coupled interface variables $(\\hat{u}_h)_{\\mathcal{F}_h}$. The local variables are expressed in terms of the interface variables and eliminated from the global system, which then only involves $\\hat{u}_h$. After solving this smaller system for $\\hat{u}_h$, the local variables $(q_h, u_h)$ are recovered element-by-element via a local back-substitution process.\n\nCrucially, this procedure is mathematically equivalent to solving the full, un-condensed monolithic system. The resulting discrete solution $(q_h, u_h, \\hat{u}_h)$ is identical. The a posteriori error estimator $\\eta$ is a function of this computed solution. Since the solution itself is unaffected by the choice of solver (condensed vs. monolithic), static condensation does not impair the validity of the a posteriori bounds. In fact, it is the mechanism that allows for the practical computation of the estimator: after the global solve for $\\hat{u}_h$, one *must* recover the local fields $(q_h, u_h)$ to evaluate the residuals that form $\\eta_K$. Static condensation provides the explicit local problems to do precisely this.\n\n**3. Numerical Evaluation**\n\nWe now compute the local error indicator $\\eta_{K_0}$ for the specified element $K_0$. The formula for the squared indicator is:\n$$\n\\eta_{K_0}^2 = \\|q_h + \\nabla u_h\\|_{0,K_0}^2 + h_{K_0}^2 \\|f + \\nabla \\cdot q_h\\|_{0,K_0}^2 + \\sum_{i=1}^{3} h_{F_i} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_i}^2\n$$\nWe are given the following values:\n- $\\|q_h + \\nabla u_h\\|_{0,K_0} = 5$\n- $h_{K_0} = 0.25$\n- $\\|f + \\nabla \\cdot q_h\\|_{0,K_0} = 12$\n- $h_{F_1} = 0.25$ and $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_1} = 8$\n- $h_{F_2} = 0.25$ and $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_2} = 6$\n- $h_{F_3} = 0.3535533906$ and $\\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_3} = 10$\n\nWe substitute these values into the formula.\n\nThe first term (residual of the constitutive relation) squared is:\n$$\n\\|q_h + \\nabla u_h\\|_{0,K_0}^2 = 5^2 = 25\n$$\n\nThe second term (residual of the conservation law) squared is:\n$$\nh_{K_0}^2 \\|f + \\nabla \\cdot q_h\\|_{0,K_0}^2 = (0.25)^2 \\times 12^2 = 0.0625 \\times 144 = 9\n$$\n\nThe third term (sum of weighted facet jump residuals) is calculated as follows:\n- Contribution from edge $F_1$: $h_{F_1} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_1}^2 = 0.25 \\times 8^2 = 0.25 \\times 64 = 16$.\n- Contribution from edge $F_2$: $h_{F_2} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_2}^2 = 0.25 \\times 6^2 = 0.25 \\times 36 = 9$.\n- Contribution from edge $F_3$: $h_{F_3} \\|\\llbracket q_h \\cdot n \\rrbracket\\|_{0,F_3}^2 = 0.3535533906 \\times 10^2 = 35.35533906$.\n\nThe sum of the facet contributions is:\n$$\n16 + 9 + 35.35533906 = 60.35533906\n$$\n\nAdding all three terms gives the squared local indicator:\n$$\n\\eta_{K_0}^2 = 25 + 9 + 60.35533906 = 94.35533906\n$$\nThe local indicator $\\eta_{K_0}$ is the square root of this value:\n$$\n\\eta_{K_0} = \\sqrt{94.35533906} \\approx 9.71366750\n$$\nRounding to four significant figures, we get $9.714$.", "answer": "$$\\boxed{9.714}$$", "id": "3410464"}]}