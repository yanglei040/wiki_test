{"hands_on_practices": [{"introduction": "This exercise provides a foundational look into the mechanics of discontinuous Galerkin methods. By explicitly assembling the matrix entries for a simple patch of elements, you will directly verify the \"compact stencil\" property that defines Compact Discontinuous Galerkin methods. This hands-on calculation reveals how coupling is strictly limited to immediate neighbors, a key departure from other methods.", "problem": "Consider the scalar Poisson problem on a polygonal domain in $\\mathbb{R}^{2}$ with constant diffusion coefficient $a=1$: find $u$ such that\n$$\n-\\nabla \\cdot \\left( \\nabla u \\right) = f \\quad \\text{in } \\Omega,\n$$\nwith suitable boundary conditions away from the interior patch described below. Let $\\mathcal{T}_{h}$ be a conforming triangulation. Focus on an interior patch consisting of three triangles $\\{K_{1},K_{2},K_{3}\\}$ that meet at a single interior vertex $\\mathbf{x}_{\\star} \\in \\Omega$, such that $K_{1}$ and $K_{2}$ share an interior face $f_{12}$ of length $\\ell_{12}>0$, $K_{2}$ and $K_{3}$ share an interior face $f_{23}$ of length $\\ell_{23}>0$, and $K_{1}$ and $K_{3}$ do not share a face (they meet only at the vertex $\\mathbf{x}_{\\star}$). No other elements touch this patch along $f_{12}$ or $f_{23}$. Let $h_{12}>0$ and $h_{23}>0$ be the characteristic face sizes associated with $f_{12}$ and $f_{23}$, respectively. For each interior face $f$, fix an orientation with unit normal $\\mathbf{n}_{f}$ pointing from the minus side $K^{-}$ to the plus side $K^{+}$. Define the jump of a scalar trace $w$ across $f$ by $[w] = w^{-} - w^{+}$, and the average of a vector trace $\\boldsymbol{q}$ by $\\{\\!\\{\\boldsymbol{q}\\}\\!\\} = \\frac{1}{2}\\left( \\boldsymbol{q}^{-} + \\boldsymbol{q}^{+} \\right)$.\n\nDiscretize using piecewise polynomial space of degree $p=0$ (element-wise constants) with one basis function per element,\n$$\n\\varphi_{1} = \\chi_{K_{1}}, \\quad \\varphi_{2} = \\chi_{K_{2}}, \\quad \\varphi_{3} = \\chi_{K_{3}},\n$$\nwhere $\\chi_{K}$ denotes the indicator function of element $K$. Consider the symmetric interior penalty Galerkin (SIPG), a compact discontinuous Galerkin scheme, with bilinear form\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\mathbf{x}\n- \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\left( \\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [v] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [u] \\right) \\, \\mathrm{d}s\n+ \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\, [u] \\, [v] \\, \\mathrm{d}s,\n$$\nwhere $\\mathcal{F}_{h}^{\\circ}$ denotes the set of interior faces and $\\sigma_{f}>0$ is a facewise penalty parameter. On the patch, take $\\sigma_{f_{12}} = \\tau / h_{12}$ and $\\sigma_{f_{23}} = \\tau / h_{23}$ with a fixed constant $\\tau>0$.\n\nAssemble explicitly all face contributions on $f_{12}$ and $f_{23}$ to the local stiffness-like matrix entries $A_{ij} = a(\\varphi_{i},\\varphi_{j})$ for $i,j \\in \\{1,2,3\\}$, using the above definitions and the fact that $\\nabla \\varphi_{i} = \\mathbf{0}$ inside each element for $p=0$. Then, using these assembled expressions, determine the exact value of the off-diagonal entry $A_{13}$ that would represent any coupling between the non-neighboring elements $K_{1}$ and $K_{3}$.\n\nProvide your final answer as a single exact value. No rounding is required. No physical units are involved. The angle unit is not applicable.", "solution": "The problem requires the explicit calculation of the off-diagonal entry $A_{13}$ of the stiffness-like matrix for a symmetric interior penalty Galerkin (SIPG) discretization of the Poisson problem. The matrix entry $A_{ij}$ is defined by the bilinear form $a(\\varphi_i, \\varphi_j)$, where $\\varphi_i$ and $\\varphi_j$ are basis functions. Specifically, we must determine $A_{13} = a(\\varphi_1, \\varphi_3)$.\n\nThe provided bilinear form is:\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\mathbf{x}\n- \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\left( \\{\\!\\{\\nabla u\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [v] + \\{\\!\\{\\nabla v\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [u] \\right) \\, \\mathrm{d}s\n+ \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\, [u] \\, [v] \\, \\mathrm{d}s\n$$\nWe substitute the test and trial functions with the specified basis functions, $u=\\varphi_1$ and $v=\\varphi_3$. This gives:\n$$\nA_{13} = a(\\varphi_1, \\varphi_3) = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla \\varphi_1 \\cdot \\nabla \\varphi_3 \\, \\mathrm{d}\\mathbf{x}\n- \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\left( \\{\\!\\{\\nabla \\varphi_1\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [\\varphi_3] + \\{\\!\\{\\nabla \\varphi_3\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [\\varphi_1] \\right) \\, \\mathrm{d}s\n+ \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\, [\\varphi_1] \\, [\\varphi_3] \\, \\mathrm{d}s\n$$\nThe analysis proceeds by examining each of the three terms in the expression for $A_{13}$. The basis functions are defined for a piecewise polynomial space of degree $p=0$. This means that on each element $K_i$, the basis function $\\varphi_i = \\chi_{K_i}$ is a constant ($1$ on $K_i$ and $0$ elsewhere).\n\n1.  **Volume Integral Term:**\n    The first term is the sum of volume integrals over all elements in the triangulation $\\mathcal{T}_h$.\n    $$\n    \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla \\varphi_1 \\cdot \\nabla \\varphi_3 \\, \\mathrm{d}\\mathbf{x}\n    $$\n    Since $\\varphi_1$ and $\\varphi_3$ are piecewise constant functions, their gradients are zero within the interior of any element $K \\in \\mathcal{T}_h$. That is, for any $K$, $\\nabla \\varphi_1(\\mathbf{x}) = \\mathbf{0}$ and $\\nabla \\varphi_3(\\mathbf{x}) = \\mathbf{0}$ for $\\mathbf{x} \\in K$. Consequently, the integrand $\\nabla \\varphi_1 \\cdot \\nabla \\varphi_3$ is identically zero everywhere. Therefore, the volume integral term is zero.\n\n2.  **Consistency (Gradient) Terms:**\n    The second term involves integrals over the interior faces $\\mathcal{F}_h^\\circ$.\n    $$\n    - \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\left( \\{\\!\\{\\nabla \\varphi_1\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [\\varphi_3] + \\{\\!\\{\\nabla \\varphi_3\\}\\!\\} \\cdot \\mathbf{n}_{f} \\, [\\varphi_1] \\right) \\, \\mathrm{d}s\n    $$\n    The average operator $\\{\\!\\{\\cdot\\}\\!\\}$ applied to a vector trace $\\boldsymbol{q}$ on a face $f$ between elements $K^-$ and $K^+$ is defined as $\\{\\!\\{\\boldsymbol{q}\\}\\!\\} = \\frac{1}{2}(\\boldsymbol{q}|_{K^-} + \\boldsymbol{q}|_{K^+})$. Since $\\nabla\\varphi_1$ and $\\nabla\\varphi_3$ are zero within every element, their traces on any face $f$ from either side are also zero. Thus, for any face $f$, we have $\\{\\!\\{\\nabla \\varphi_1\\}\\!\\} = \\mathbf{0}$ and $\\{\\!\\{\\nabla \\varphi_3\\}\\!\\} = \\mathbf{0}$. The integrand is therefore identically zero for every face. This entire term evaluates to zero.\n\n3.  **Penalty Term:**\n    The third and final term is the penalty term, which also involves an integral over interior faces.\n    $$\n    \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\, [\\varphi_1] \\, [\\varphi_3] \\, \\mathrm{d}s\n    $$\n    This is the only term that could potentially be non-zero. Let us analyze the product of the jumps, $[\\varphi_1] \\, [\\varphi_3]$, on an arbitrary interior face $f$. The jump of a function $\\psi$ across a face $f$ separating elements $K^-$ and $K^+$ is defined as $[\\psi] = \\psi|_{K^-} - \\psi|_{K^+}$.\n\n    The basis function $\\varphi_1 = \\chi_{K_1}$ is $1$ on element $K_1$ and $0$ on all other elements. The jump $[\\varphi_1]$ across a face $f$ is non-zero if and only if $f$ is a face of the element $K_1$. If $f$ is not part of the boundary $\\partial K_1$, then $\\varphi_1$ is $0$ on both sides of $f$, making $[\\varphi_1] = 0$.\n\n    Similarly, the basis function $\\varphi_3 = \\chi_{K_3}$ is $1$ on element $K_3$ and $0$ on all other elements. The jump $[\\varphi_3]$ across a face $f$ is non-zero if and only if $f$ is a face of the element $K_3$.\n\n    For the product $[\\varphi_1] \\, [\\varphi_3]$ to be non-zero on a face $f$, both $[\\varphi_1]$ and $[\\varphi_3]$ must be non-zero on that face. This requires the face $f$ to be simultaneously a face of $K_1$ and a face of $K_3$. In other words, elements $K_1$ and $K_3$ must share the face $f$.\n\n    However, the problem statement explicitly specifies that \"$K_{1}$ and $K_{3}$ do not share a face (they meet only at the vertex $\\mathbf{x}_{\\star}$).\" This means that for any interior face $f \\in \\mathcal{F}_{h}^{\\circ}$, it cannot be a common boundary to both $K_1$ and $K_3$. Therefore, for any given face $f$, at least one of the jumps, $[\\varphi_1]$ or $[\\varphi_3]$, must be zero.\n    \n    Consequently, the product $[\\varphi_1] \\, [\\varphi_3]$ is identically zero on every face $f$ in the mesh.\n    \n    This holds for all faces, including the specifically mentioned faces $f_{12}$ and $f_{23}$.\n    - On face $f_{12}$ (between $K_1$ and $K_2$): $[\\varphi_1] \\neq 0$ but $[\\varphi_3] = 0$. So the contribution is $0$.\n    - On face $f_{23}$ (between $K_2$ and $K_3$): $[\\varphi_1] = 0$ but $[\\varphi_3] \\neq 0$. So the contribution is $0$.\n    \n    Since the integrand $\\sigma_{f} \\, [\\varphi_1] \\, [\\varphi_3]$ is zero for all $f \\in \\mathcal{F}_{h}^{\\circ}$, the penalty term is a sum of zeros:\n    $$\n    \\sum_{f \\in \\mathcal{F}_{h}^{\\circ}} \\int_{f} \\sigma_{f} \\cdot 0 \\, \\mathrm{d}s = 0\n    $$\n\nCombining the results from the three terms, we find:\n$$\nA_{13} = 0 - 0 + 0 = 0\n$$\nThe matrix entry $A_{13}$, which represents the coupling between the basis functions on non-adjacent elements $K_1$ and $K_3$, is exactly zero. This is a fundamental property of Discontinuous Galerkin methods, where the stencil of an element is limited to its immediate face-neighbors, making the resulting system matrix sparse. The term \"compact\" in compact discontinuous Galerkin method refers to this property.", "answer": "$$\\boxed{0}$$", "id": "3371791"}, {"introduction": "Building on the concept of the compact stencil demonstrated in the previous practice [@problem_id:3371791], this exercise asks you to quantify its effect on the global system matrix. You will derive a general formula for the number of non-zero entries in a matrix row corresponding to an interior element. This analysis is crucial for understanding and predicting the computational cost and memory footprint of a CDG-based solver.", "problem": "Consider a conforming tetrahedral mesh of a bounded polyhedral domain in three spatial dimensions. Let the unknown be discretized by a Compact Discontinuous Galerkin (CDG) method for a symmetric, second-order scalar elliptic operator with interior penalty, using on each tetrahedron the polynomial space of total degree at most $p$, denoted by $\\mathbb{P}_{p}(K)$. Assume the following scientifically standard modeling conditions: (i) element-interior bilinear form contributions are supported only on a single tetrahedron $K$; (ii) numerical fluxes and liftings are supported only on faces, so that couplings occur only between pairs of tetrahedra that share a common face; and (iii) the assembled local element block and each face-coupling block are algebraically dense in the chosen local basis. Focus on a typical interior tetrahedron, which in a conforming tetrahedral mesh has $N_{f}$ faces, and disregard boundary-condition-induced reductions in stencil size. Let $N_{p}$ denote the number of local degrees of freedom on a tetrahedron for $\\mathbb{P}_{p}(K)$.\n\nStarting from the fundamental definitions of the discontinuous Galerkin bilinear form and the combinatorial dimension of $\\mathbb{P}_{p}(K)$, derive the exact count of nonzero entries per row in the global stiffness matrix for a row associated with a degree of freedom on an interior tetrahedron. Express your final answer as a closed-form analytic expression in terms of $p$, using the fact that a tetrahedron has $N_{f} = 4$ faces and the standard dimension formula for $\\mathbb{P}_{p}(K)$ on a tetrahedron. Provide the final expression exactly; no rounding is required.", "solution": "The problem asks for the number of nonzero entries per row in the global stiffness matrix for a row associated with a degree of freedom on an interior tetrahedron, using a Compact Discontinuous Galerkin (CDG) method.\n\nLet the global stiffness matrix be denoted by $A$. An entry $A_{ij}$ of this matrix is nonzero if and only if the basis functions $\\phi_i$ and $\\phi_j$ corresponding to the global degrees of freedom $i$ and $j$ have interacting support within the bilinear form of the DG method. We are asked to find the number of nonzero entries in a row corresponding to a basis function $\\phi_i$ supported on an interior tetrahedron, which we shall call $K$. This is equivalent to finding the size of the stencil of $\\phi_i$.\n\nThe structure of the stencil is determined by the contributions to the DG bilinear form. The problem statement specifies two sources of coupling:\n$1$. Element-interior contributions.\n$2$. Face-based contributions (numerical fluxes and liftings).\n\nLet's analyze these contributions for a basis function $\\phi_i$ whose support is the tetrahedron $K$.\n\nFirst, consider the element-interior contributions. The problem states that these are supported only on a single tetrahedron $K$. This means the volume integral part of the bilinear form couples a basis function $\\phi_i$ on $K$ with other basis functions $\\phi_j$ that are also supported on the same tetrahedron $K$. The problem further specifies that \"the assembled local element block ... is algebraically dense in the chosen local basis.\" This is a crucial condition, as it implies that the submatrix corresponding to the degrees of freedom on $K$ is full. Therefore, the basis function $\\phi_i$ couples with *every* basis function supported on $K$, including itself. The number of such basis functions is the number of local degrees of freedom on the tetrahedron, denoted by $N_p$. This self-element coupling contributes $N_p$ nonzero entries to the row of the matrix $A$ associated with the degree of freedom $i$.\n\nSecond, consider the face-based contributions. The problem states that \"numerical fluxes and liftings are supported only on faces, so that couplings occur only between pairs of tetrahedra that share a common face.\" We are considering an interior tetrahedron $K$. In a conforming tetrahedral mesh, a tetrahedron has $N_f = 4$ faces. Since $K$ is an interior element, each of its $4$ faces is shared with a unique neighboring tetrahedron. Let these neighboring tetrahedra be denoted by $K_1, K_2, K_3,$ and $K_4$.\n\nThe face-based terms in the bilinear form generate coupling between the degrees of freedom on $K$ and the degrees of freedom on each of its neighbors $K_j$ for $j \\in \\{1, 2, 3, 4\\}$. The problem provides the final piece of information: \"each face-coupling block is algebraically dense in the chosen local basis.\" This means that for a given degree of freedom on $K$, the face-based terms create a nonzero coupling to *every* degree of freedom on the adjacent tetrahedron across the shared face. Assuming a uniform polynomial degree $p$ across the mesh, each neighboring tetrahedron $K_j$ also has $N_p$ local degrees of freedom. Therefore, for each of the $N_f=4$ neighbors, there are $N_p$ couplings. This contributes an additional $N_f \\times N_p = 4N_p$ nonzero entries to the row.\n\nThe total count of nonzero entries is the sum of the contributions from the central element $K$ and its $N_f$ neighbors.\nTotal nonzero entries per row = (Contribution from self-element) + (Contribution from neighboring elements)\nTotal nonzero entries per row = $N_p + N_f \\times N_p = (1 + N_f) N_p$.\n\nSubstituting the given value $N_f = 4$ for a tetrahedron:\nTotal nonzero entries per row = $(1+4)N_p = 5 N_p$.\n\nThe final step is to determine the expression for $N_p$, the number of local degrees of freedom. This is the dimension of the polynomial space $\\mathbb{P}_{p}(K)$, which consists of polynomials of total degree at most $p$ on a tetrahedron $K$. A tetrahedron is a $3$-dimensional simplex. The dimension of the space of polynomials of total degree at most $p$ in $d$ spatial dimensions, $\\dim(\\mathbb{P}_p(\\mathbb{R}^d))$, is given by the formula:\n$$ N_p = \\binom{p+d}{d} $$\nFor a tetrahedron in three spatial dimensions, we have $d=3$. Thus, the number of degrees of freedom is:\n$$ N_p = \\binom{p+3}{3} $$\nExpanding this binomial coefficient gives:\n$$ N_p = \\frac{(p+3)!}{3!(p+3-3)!} = \\frac{(p+3)!}{3!p!} = \\frac{(p+3)(p+2)(p+1)p!}{6 p!} = \\frac{(p+1)(p+2)(p+3)}{6} $$\nSubstituting this expression for $N_p$ into our formula for the total nonzero entries, we obtain the final result.\nTotal nonzero entries per row = $5 N_p = 5 \\frac{(p+1)(p+2)(p+3)}{6}$.", "answer": "$$\n\\boxed{5 \\frac{(p+1)(p+2)(p+3)}{6}}\n$$", "id": "3371779"}, {"introduction": "The final practice connects the mathematical structure of the CDG operator to its tangible performance benefits. By developing a model for data movement, you will analyze and compare the computational workload of a CDG operator against a non-compact alternative like the Local Discontinuous Galerkin (LDG) method. This exercise illuminates why the compact stencil is highly desirable for modern, memory-bound computer architectures.", "problem": "Consider the matrix-free application of second-order diffusion operators discretized by discontinuous Galerkin methods on a uniform mesh. Two operator constructions are compared: the Compact Discontinuous Galerkin (CDG) operator for diffusion and the standard Local Discontinuous Galerkin (LDG) operator for diffusion. Assume a single scalar unknown field $u$, spatial dimension $d$, polynomial degree $p$, element face count $F$, and that the mesh is composed of shape-homogeneous elements. Adopt the following fundamental bases:\n- For a tensor-product element in spatial dimension $d$, the number of degrees of freedom per element is $N_{e} = (p+1)^{d}$ and the number of degrees of freedom per face trace is $N_{f} = (p+1)^{d-1}$.\n- For a simplex element in spatial dimension $d$, the number of degrees of freedom per element is $N_{e} = \\binom{p+d}{d}$ and the number of degrees of freedom per face trace is $N_{f} = \\binom{p+d-1}{d-1}$.\n- The LDG operator introduces an auxiliary vector field $\\boldsymbol{q}$ with $d$ components, which, in a canonical two-phase implementation, is written to and read from memory within the operator application. The CDG operator eliminates this auxiliary field by using compact face-lifting operations.\n\nModel data movement using the following scientifically realistic assumptions:\n- Each scalar degree of freedom occupies $b$ bytes in memory.\n- Per element, one operator application reads the volume degrees of freedom of $u$ once and writes one residual for $u$ once. The LDG operator also writes and later reads the auxiliary $\\boldsymbol{q}$ field of $d$ components per degree of freedom.\n- Face coupling requires reading neighbor element face trace degrees of freedom. If two adjacent elements are processed back-to-back, face-trace data can be reused across the pair. Model this with a face-cache reuse factor $\\eta \\in [\\frac{1}{2}, 1]$, where $\\eta = \\frac{1}{2}$ represents perfect amortization across the two neighbors and $\\eta = 1$ represents no reuse.\n\nUnder these assumptions:\n- In CDG, face coupling uses only $u$ traces. The total face-trace read per element scales like $\\eta \\, F \\, N_{f}$.\n- In LDG, face coupling uses both $u$ and $\\boldsymbol{q}$ traces. The total face-trace read per element scales like $\\eta \\, F \\, (1+d) \\, N_{f}$.\n- Writes are counted once per field per element.\n\nStarting from these bases, derive closed-form expressions for the bytes moved per degree of freedom by the CDG and LDG operators in terms of $b$, $p$, $F$, $d$, and element shape through $N_{e}$ and $N_{f}$. Then, specialize your result to the CDG operator on a tensor-product element in spatial dimension $d=3$ under perfect face-cache reuse $\\eta = \\frac{1}{2}$, and give the final minimal bytes-moved per degree of freedom as a single closed-form analytic expression in terms of $b$, $p$, and $F$. Express the final answer in units of bytes per degree of freedom. No numerical rounding is required; provide an exact expression.", "solution": "The problem requires the derivation of closed-form expressions for the memory traffic (bytes moved) per degree of freedom for two discontinuous Galerkin operators, Compact Discontinuous Galerkin (CDG) and Local Discontinuous Galerkin (LDG), under a specified data movement model. The final result must then be specialized for the CDG operator under specific conditions.\n\nFirst, we establish a general framework for calculating the bytes moved per degree of freedom. This metric, which we denote as $M$, is defined as the total bytes moved during one operator application on a single element, divided by the number of degrees of freedom ($N_e$) within that element.\n$$M = \\frac{B_{\\text{total}}}{N_e}$$\nThe total bytes moved, $B_{\\text{total}}$, is the sum of bytes read from memory and bytes written to memory.\n$$B_{\\text{total}} = B_{\\text{read}} + B_{\\text{write}}$$\nEach scalar degree of freedom (DOF) is assumed to occupy $b$ bytes.\n\nWe proceed by analyzing each operator separately.\n\n**1. Compact Discontinuous Galerkin (CDG) Operator**\n\nAccording to the problem statement, a single application of the CDG operator on one element involves the following data movements:\n- **Volume Reads**: The $N_e$ degrees of freedom of the solution field $u$ within the element are read once. The bytes read are $b \\cdot N_e$.\n- **Face Reads**: For coupling with neighboring elements, the face-trace data of $u$ is read. The number of DOFs read is given as $\\eta \\, F \\, N_f$, where $F$ is the number of faces on the element and $\\eta$ is the face-cache reuse factor. The bytes read are $b \\cdot \\eta \\, F \\, N_f$.\n- **Volume Writes**: The computed residual for the $u$ field, which has $N_e$ degrees of freedom, is written once. The bytes written are $b \\cdot N_e$.\n\nThe total bytes moved for the CDG operator, $B_{\\text{total}}^{\\text{CDG}}$, is the sum of these quantities:\n$$B_{\\text{total}}^{\\text{CDG}} = (\\text{bytes read}) + (\\text{bytes written})$$\n$$B_{\\text{total}}^{\\text{CDG}} = (b N_e + b \\eta F N_f) + (b N_e) = b(2N_e + \\eta F N_f)$$\nThe bytes moved per degree of freedom for CDG, $M_{\\text{CDG}}$, is therefore:\n$$M_{\\text{CDG}} = \\frac{B_{\\text{total}}^{\\text{CDG}}}{N_e} = \\frac{b(2N_e + \\eta F N_f)}{N_e} = b\\left(2 + \\eta F \\frac{N_f}{N_e}\\right)$$\n\n**2. Local Discontinuous Galerkin (LDG) Operator**\n\nThe LDG operator introduces an auxiliary vector field $\\boldsymbol{q}$ with $d$ components. The problem states that the operator implementation involves writing and then reading this field. This implies a two-phase process.\n- **Data Movement for $u$**: The volume DOFs of $u$ ($N_e$) are read once, and the final residual for $u$ ($N_e$) is written once.\n- **Data Movement for $\\boldsymbol{q}$**: The auxiliary field $\\boldsymbol{q}$ has $d$ components, so it corresponds to $d \\cdot N_e$ volume DOFs. These are written once and read once.\n- **Face Data Movement**: Face coupling requires reading traces for both $u$ and $\\boldsymbol{q}$. The total number of face DOFs read is given as $\\eta \\, F \\, (N_f + d N_f) = \\eta \\, F \\, (1+d) N_f$.\n\nSumming these contributions:\n- **Total Reads**: Reading volume $u$ ($bN_e$), volume $\\boldsymbol{q}$ ($b d N_e$), and face traces for both ($b \\eta F (1+d) N_f$).\n$$B_{\\text{read}}^{\\text{LDG}} = bN_e + b d N_e + b \\eta F (1+d) N_f = b(1+d)N_e + b\\eta F(1+d)N_f$$\n- **Total Writes**: Writing volume $\\boldsymbol{q}$ ($b d N_e$) and the residual for $u$ ($bN_e$).\n$$B_{\\text{write}}^{\\text{LDG}} = b d N_e + bN_e = b(1+d)N_e$$\nThe total bytes moved for the LDG operator, $B_{\\text{total}}^{\\text{LDG}}$, is:\n$$B_{\\text{total}}^{\\text{LDG}} = B_{\\text{read}}^{\\text{LDG}} + B_{\\text{write}}^{\\text{LDG}} = \\left( b(1+d)N_e + b\\eta F(1+d)N_f \\right) + b(1+d)N_e$$\n$$B_{\\text{total}}^{\\text{LDG}} = 2b(1+d)N_e + b\\eta F(1+d)N_f = b(1+d)(2N_e + \\eta F N_f)$$\nThe bytes moved per degree of freedom for LDG, $M_{\\text{LDG}}$, normalized by the primary field's DOFs ($N_e$), is:\n$$M_{\\text{LDG}} = \\frac{B_{\\text{total}}^{\\text{LDG}}}{N_e} = \\frac{b(1+d)(2N_e + \\eta F N_f)}{N_e} = b(1+d)\\left(2 + \\eta F \\frac{N_f}{N_e}\\right)$$\n\n**3. Specialization of the CDG Result**\n\nThe problem asks to specialize the CDG result for a tensor-product element in spatial dimension $d=3$, with perfect face-cache reuse ($\\eta = \\frac{1}{2}$).\n\nFirst, we determine the ratio $\\frac{N_f}{N_e}$ for a tensor-product element. Using the provided definitions:\n- $N_{e} = (p+1)^{d}$\n- $N_{f} = (p+1)^{d-1}$\nThe ratio is:\n$$\\frac{N_f}{N_e} = \\frac{(p+1)^{d-1}}{(p+1)^{d}} = \\frac{1}{p+1}$$\nThis ratio is independent of the spatial dimension $d$.\n\nNow, we substitute this ratio and the value $\\eta = \\frac{1}{2}$ into the general expression for $M_{\\text{CDG}}$:\n$$M_{\\text{CDG}} = b\\left(2 + \\eta F \\frac{N_f}{N_e}\\right)$$\n$$M_{\\text{CDG, specialized}} = b\\left(2 + \\left(\\frac{1}{2}\\right) F \\left(\\frac{1}{p+1}\\right)\\right)$$\nSimplifying the expression gives:\n$$M_{\\text{CDG, specialized}} = b\\left(2 + \\frac{F}{2(p+1)}\\right)$$\nThis expression represents the minimal bytes moved per degree of freedom for the CDG operator under the specified conditions. It is given as a closed-form analytic expression in terms of $b$, $p$, and $F$, as required by the problem statement. The condition $d=3$ for a tensor-product element implies a hexahedral element shape, for which $F=6$, but the problem explicitly requests the answer in terms of $F$.", "answer": "$$\\boxed{b \\left(2 + \\frac{F}{2(p+1)}\\right)}$$", "id": "3371774"}]}