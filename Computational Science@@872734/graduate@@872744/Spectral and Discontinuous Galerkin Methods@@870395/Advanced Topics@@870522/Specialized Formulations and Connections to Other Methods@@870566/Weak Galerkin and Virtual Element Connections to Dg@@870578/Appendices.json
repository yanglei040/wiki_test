{"hands_on_practices": [{"introduction": "While Weak Galerkin (WG) and Discontinuous Galerkin (DG) methods originate from different philosophies, they share deep algebraic connections. This exercise demonstrates one of the most important links by showing that the lowest-order WG method for a diffusion problem is algebraically equivalent to a Hybridizable DG (HDG) method. By deriving the local element matrices and performing static condensation to obtain a global system on the mesh skeleton, you will see firsthand how these two formulations lead to the exact same system of equations, revealing their underlying unity. [@problem_id:3428757]", "problem": "Consider the scalar diffusion model problem on the interval $[0,3]$ with constant diffusion coefficient $\\kappa > 0$ and homogeneous Dirichlet boundary conditions:\n$$\n- (\\kappa u')' = f \\quad \\text{in } (0,3), \\qquad u(0)=0,\\; u(3)=0.\n$$\nLet $\\mathcal{T}_h$ be the uniform mesh with $3$ elements $K_1=[0,1]$, $K_2=[1,2]$, and $K_3=[2,3]$ so that $h=1$. Work with the lowest-order weak Galerkin (WG) method and the first-order hybridizable Discontinuous Galerkin (HDG) method, both with stabilization parameter $\\tau > 0$, and use the following standard definitions.\n\nFor the weak Galerkin method, the local discrete space on each element $K$ is $P_0(K)$ for the element unknown and $P_0(\\partial K)$ for the traces on the endpoints. The discrete weak gradient on $K$ is defined by duality: for any $q\\in P_0(K)$,\n$$\n(\\nabla_w u, q)_K = - (u_0, q')_K + \\langle \\hat{u}, q n \\rangle_{\\partial K},\n$$\nand the bilinear form is the sum over elements of the discrete energy and stabilization,\n$$\na_h(u,v) = \\sum_{K\\in \\mathcal{T}_h} \\left[ (\\kappa \\nabla_w u, \\nabla_w v)_K + s_K(u,v) \\right], \\qquad s_K(u,v)=\\frac{\\tau}{h}\\sum_{s\\subset \\partial K} \\int_s (u_0-\\hat{u})(v_0-\\hat{v}).\n$$\nImpose the Dirichlet boundary condition strongly on the trace at $x=0$ and $x=3$.\n\nTask 1 (WG local matrix and static condensation):\n- On a generic element $K=[x_L,x_R]$ of length $h$, using the above definitions and the lowest-order polynomial choices, derive the $3\\times 3$ local element stiffness matrix $A_K$ in the ordered basis $(u_0,\\hat{u}_L,\\hat{u}_R)$.\n- Perform static condensation (local hybridization) to eliminate the element unknown $u_0$ and obtain the $2\\times 2$ Schur complement $S_K$ acting on $(\\hat{u}_L,\\hat{u}_R)$.\n- Specialize to the three-element mesh with $h=1$ and homogeneous Dirichlet boundary conditions at $x=0$ and $x=3$, and assemble the global condensed WG system on the interior face traces at $x=1$ and $x=2$ (ordered as $\\hat{u}(1)$, $\\hat{u}(2)$). Denote the resulting $2\\times 2$ matrix by $S^{\\mathrm{WG}}$.\n\nFor the hybridizable Discontinuous Galerkin method (first-order formulation with unknowns $q \\approx -\\kappa u'$ and $u$), use on each element $K$ the standard HDG local equations with constant approximations $q_K\\in P_0(K)$, $u_K\\in P_0(K)$, and single-valued face trace $\\hat{u}\\in P_0(\\partial K)$:\n- For any $r\\in P_0(K)$, $(\\kappa^{-1} q_K, r)_K - (u_K, r')_K + \\langle \\hat{u}, r n \\rangle_{\\partial K} = 0$.\n- For any $v\\in P_0(K)$, $-(q_K',v)_K + \\langle q_K n + \\tau (u_K - \\hat{u}), v \\rangle_{\\partial K} = (f,v)_K$.\nEnforce the Dirichlet boundary condition strongly by setting $\\hat{u}(0)=0$ and $\\hat{u}(3)=0$, and impose the global conservativity condition on each interior face $s$:\n$$\n\\sum_{K\\supset s} \\big(q_K n_{K,s} + \\tau (u_K - \\hat{u})\\big)\\big|_{s} = 0.\n$$\n\nTask 2 (HDG local solver and global face system):\n- On a generic element $K=[x_L,x_R]$ with $h$, solve the HDG local equations to express $q_K$ and $u_K$ in terms of the local face traces $(\\hat{u}_L,\\hat{u}_R)$.\n- Assemble the global $2\\times 2$ system on the interior traces $\\hat{u}(1)$ and $\\hat{u}(2)$ using the conservativity conditions, and denote the resulting matrix by $S^{\\mathrm{DG}}$.\n\nTask 3 (sparsity and bandwidth comparison):\n- With the global face unknowns ordered as $(\\hat{u}(1),\\hat{u}(2))$, identify the nonzero pattern of $S^{\\mathrm{WG}}$ and $S^{\\mathrm{DG}}$ and, using the definition that the bandwidth $B$ is $1+\\max\\{|i-j|: (i,j)\\text{ is a nonzero entry}\\}$, compute the bandwidths $B_{\\mathrm{WG}}$ and $B_{\\mathrm{DG}}$.\n- Report the ratio $B_{\\mathrm{WG}}/B_{\\mathrm{DG}}$ as a single real number. No rounding is needed, and no physical units are required in the final answer.", "solution": "The problem asks for a comparison of the global condensed stiffness matrices for the lowest-order Weak Galerkin (WG) and first-order Hybridizable Discontinuous Galerkin (HDG) methods for a one-dimensional diffusion problem. The comparison is to be made in terms of the matrix bandwidth. The solution will proceed in three parts as requested: first, the derivation for the WG method; second, the derivation for the HDG method; and third, the comparison of the resulting matrices.\n\n### Task 1: Weak Galerkin (WG) Method\n\nWe first derive the local stiffness matrix on a generic element $K=[x_L, x_R]$ of length $h = x_R - x_L$. The local unknowns are $u = \\{u_0, \\hat{u}\\}$, where $u_0 \\in P_0(K)$ is a constant on the element, and $\\hat{u} \\in P_0(\\partial K)$ represents the values at the endpoints, which we denote $\\hat{u}_L = \\hat{u}(x_L)$ and $\\hat{u}_R = \\hat{u}(x_R)$. The local degrees of freedom are the triplet $(u_0, \\hat{u}_L, \\hat{u}_R)$.\n\nThe discrete weak gradient, $\\nabla_w u \\in P_0(K)$, is a constant on $K$ defined by the duality relation for any $q \\in P_0(K)$:\n$$(\\nabla_w u, q)_K = - (u_0, q')_K + \\langle \\hat{u}, q n \\rangle_{\\partial K}$$\nSince $q \\in P_0(K)$, $q$ is a constant, so its derivative $q'$ is $0$. The outward normal vectors are $n(x_R)=1$ and $n(x_L)=-1$. The definition simplifies to:\n$$\\int_K (\\nabla_w u) q \\,dx = \\hat{u}(x_R) q(x_R) n(x_R) + \\hat{u}(x_L) q(x_L) n(x_L)$$\nLetting $q=1$ (a basis for $P_0(K)$), we get:\n$$(\\nabla_w u) \\cdot h = \\hat{u}_R \\cdot 1 + \\hat{u}_L \\cdot (-1) = \\hat{u}_R - \\hat{u}_L$$\nThus, the discrete weak gradient is the centered difference:\n$$\\nabla_w u = \\frac{\\hat{u}_R - \\hat{u}_L}{h}$$\nThe local bilinear form is $a_K(u,v) = (\\kappa \\nabla_w u, \\nabla_w v)_K + s_K(u,v)$. We compute each term. For $u=(u_0, \\hat{u}_L, \\hat{u}_R)$ and $v=(v_0, \\hat{v}_L, \\hat{v}_R)$:\nThe first term is:\n$$(\\kappa \\nabla_w u, \\nabla_w v)_K = \\int_K \\kappa \\left(\\frac{\\hat{u}_R - \\hat{u}_L}{h}\\right) \\left(\\frac{\\hat{v}_R - \\hat{v}_L}{h}\\right) dx = \\frac{\\kappa}{h} (\\hat{u}_R - \\hat{u}_L)(\\hat{v}_R - \\hat{v}_L)$$\nThe stabilization term is:\n$$s_K(u,v)=\\frac{\\tau}{h}\\sum_{s\\subset \\partial K} \\int_s (u_0-\\hat{u})(v_0-\\hat{v}) = \\frac{\\tau}{h} \\left[ (u_0 - \\hat{u}_L)(v_0 - \\hat{v}_L) + (u_0 - \\hat{u}_R)(v_0 - \\hat{v}_R) \\right]$$\nCombining these terms, the local bilinear form $a_K(u,v)$ can be expressed as $V^T A_K U$ where $U=(u_0, \\hat{u}_L, \\hat{u}_R)^T$ and $V=(v_0, \\hat{v}_L, \\hat{v}_R)^T$. By identifying coefficients of the products of degrees of freedom, we obtain the $3 \\times 3$ local stiffness matrix $A_K$:\n$$A_K = \\begin{pmatrix} \\frac{2\\tau}{h} & -\\frac{\\tau}{h} & -\\frac{\\tau}{h} \\\\ -\\frac{\\tau}{h} & \\frac{\\kappa}{h} + \\frac{\\tau}{h} & -\\frac{\\kappa}{h} \\\\ -\\frac{\\tau}{h} & -\\frac{\\kappa}{h} & \\frac{\\kappa}{h} + \\frac{\\tau}{h} \\end{pmatrix}$$\nNext, we perform static condensation to eliminate the element-interior unknown $u_0$. We partition $A_K$ corresponding to the unknowns $(u_0)$ and $(\\hat{u}_L, \\hat{u}_R)$:\n$$A_K = \\begin{pmatrix} A_{00} & A_{0\\partial} \\\\ A_{\\partial 0} & A_{\\partial\\partial} \\end{pmatrix} \\quad \\text{where} \\quad A_{00} = \\frac{2\\tau}{h}, \\quad A_{0\\partial} = \\begin{pmatrix} -\\frac{\\tau}{h} & -\\frac{\\tau}{h} \\end{pmatrix}, \\quad A_{\\partial 0} = \\begin{pmatrix} -\\frac{\\tau}{h} \\\\ -\\frac{\\tau}{h} \\end{pmatrix}, \\quad A_{\\partial\\partial} = \\begin{pmatrix} \\frac{\\kappa+\\tau}{h} & -\\frac{\\kappa}{h} \\\\ -\\frac{\\kappa}{h} & \\frac{\\kappa+\\tau}{h} \\end{pmatrix}$$\nThe Schur complement $S_K$ acting on the trace unknowns is given by $S_K = A_{\\partial\\partial} - A_{\\partial 0} A_{00}^{-1} A_{0\\partial}$.\nWe have $A_{00}^{-1} = \\frac{h}{2\\tau}$.\n$$A_{\\partial 0} A_{00}^{-1} A_{0\\partial} = \\begin{pmatrix} -\\frac{\\tau}{h} \\\\ -\\frac{\\tau}{h} \\end{pmatrix} \\left(\\frac{h}{2\\tau}\\right) \\begin{pmatrix} -\\frac{\\tau}{h} & -\\frac{\\tau}{h} \\end{pmatrix} = \\frac{\\tau}{2h} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}$$\nSo, the Schur complement is:\n$$S_K = \\begin{pmatrix} \\frac{\\kappa+\\tau}{h} & -\\frac{\\kappa}{h} \\\\ -\\frac{\\kappa}{h} & \\frac{\\kappa+\\tau}{h} \\end{pmatrix} - \\frac{\\tau}{2h} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\kappa}{h} + \\frac{\\tau}{2h} & -\\frac{\\kappa}{h} - \\frac{\\tau}{2h} \\\\ -\\frac{\\kappa}{h} - \\frac{\\tau}{2h} & \\frac{\\kappa}{h} + \\frac{\\tau}{2h} \\end{pmatrix} = \\left(\\frac{\\kappa}{h} + \\frac{\\tau}{2h}\\right) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\nNow, we assemble the global system for the given mesh with $3$ elements and $h=1$. The interior face unknowns are $\\hat{u}(1)$ and $\\hat{u}(2)$. The boundary conditions are $\\hat{u}(0)=0$ and $\\hat{u}(3)=0$. For $h=1$, the local Schur complement is $S_K = (\\kappa + \\frac{\\tau}{2}) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nThe global matrix $S^{\\mathrm{WG}}$ is assembled by summing the contributions from each element:\n- Element $K_1=[0,1]$ connects nodes $0$ and $1$. Its contribution to the $(\\hat{u}(1), \\hat{u}(1))$ entry is $S_{K_1,22} = \\kappa + \\frac{\\tau}{2}$.\n- Element $K_2=[1,2]$ connects nodes $1$ and $2$. Its matrix contribution is $(\\kappa + \\frac{\\tau}{2}) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$ on DOFs $(\\hat{u}(1),\\hat{u}(2))$.\n- Element $K_3=[2,3]$ connects nodes $2$ and $3$. Its contribution to the $(\\hat{u}(2), \\hat{u}(2))$ entry is $S_{K_3,11} = \\kappa + \\frac{\\tau}{2}$.\nSumming these contributions for the DOFs $(\\hat{u}(1), \\hat{u}(2))$, we get:\n$$S^{\\mathrm{WG}}_{11} = (S_{K_1,22}) + (S_{K_2,11}) = (\\kappa + \\frac{\\tau}{2}) + (\\kappa + \\frac{\\tau}{2}) = 2\\kappa + \\tau$$\n$$S^{\\mathrm{WG}}_{12} = S_{K_2,12} = -(\\kappa + \\frac{\\tau}{2})$$\n$$S^{\\mathrm{WG}}_{21} = S_{K_2,21} = -(\\kappa + \\frac{\\tau}{2})$$\n$$S^{\\mathrm{WG}}_{22} = (S_{K_2,22}) + (S_{K_3,11}) = (\\kappa + \\frac{\\tau}{2}) + (\\kappa + \\frac{\\tau}{2}) = 2\\kappa + \\tau$$\nThe assembled global condensed WG matrix is:\n$$S^{\\mathrm{WG}} = \\begin{pmatrix} 2\\kappa+\\tau & -(\\kappa+\\frac{\\tau}{2}) \\\\ -(\\kappa+\\frac{\\tau}{2}) & 2\\kappa+\\tau \\end{pmatrix}$$\n\n### Task 2: Hybridizable Discontinuous Galerkin (HDG) Method\n\nOn a generic element $K=[x_L, x_R]$ of length $h$, the local unknowns are the constants $q_K, u_K \\in P_0(K)$. The local problem is defined by two equations.\nThe first equation, tested with $r=1 \\in P_0(K)$:\n$$(\\kappa^{-1} q_K, 1)_K - (u_K, 1')_K + \\langle \\hat{u}, 1 \\cdot n \\rangle_{\\partial K} = 0$$\nSince $1' = 0$, this becomes $\\kappa^{-1} q_K h + (\\hat{u}_R \\cdot 1 + \\hat{u}_L \\cdot (-1)) = 0$, which gives:\n$$q_K = -\\kappa \\frac{\\hat{u}_R - \\hat{u}_L}{h}$$\nThe second equation, tested with $v=1 \\in P_0(K)$:\n$$-(q_K', 1)_K + \\langle q_K n + \\tau (u_K - \\hat{u}), 1 \\rangle_{\\partial K} = (f,1)_K$$\nSince $q_K$ is constant, $q_K'=0$. This becomes:\n$$(q_K n(x_R) + \\tau(u_K - \\hat{u}_R)) + (q_K n(x_L) + \\tau(u_K - \\hat{u}_L)) = \\int_K f dx$$\n$$(q_K + \\tau(u_K - \\hat{u}_R)) + (-q_K + \\tau(u_K - \\hat{u}_L)) = \\int_K f dx$$\n$$2\\tau u_K - \\tau(\\hat{u}_L + \\hat{u}_R) = \\int_K f dx$$\n$$u_K = \\frac{\\hat{u}_L + \\hat{u}_R}{2} + \\frac{1}{2\\tau} \\int_K f dx$$\nThe global system is formed by imposing continuity of the numerical flux at each interior face $s$: $\\sum_{K\\supset s} (q_K n_{K,s} + \\tau (u_K - \\hat{u}))|_s = 0$.\nWe assemble the system for DOFs $(\\hat{u}(1), \\hat{u}(2))$ on the mesh with $h=1$ and BCs $\\hat{u}(0)=0, \\hat{u}(3)=0$. Let $f_i = \\int_{K_i} f dx$.\n\nAt interface $x=1$ (between $K_1$ and $K_2$):\n- Flux from $K_1=[0,1]$ (normal $n=+1$):\n  $q_{K_1} = -\\kappa(\\hat{u}(1)-\\hat{u}(0)) = -\\kappa\\hat{u}(1)$.\n  $u_{K_1} = \\frac{\\hat{u}(0)+\\hat{u}(1)}{2} + \\frac{f_1}{2\\tau} = \\frac{\\hat{u}(1)}{2} + \\frac{f_1}{2\\tau}$.\n  Flux trace: $q_{K_1}(1) + \\tau(u_{K_1}-\\hat{u}(1)) = -\\kappa\\hat{u}(1) + \\tau(\\frac{\\hat{u}(1)}{2} - \\hat{u}(1)) + \\frac{f_1}{2} = -(\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + \\frac{f_1}{2}$.\n- Flux from $K_2=[1,2]$ (normal $n=-1$):\n  $q_{K_2} = -\\kappa(\\hat{u}(2)-\\hat{u}(1))$.\n  $u_{K_2} = \\frac{\\hat{u}(1)+\\hat{u}(2)}{2} + \\frac{f_2}{2\\tau}$.\n  Flux trace: $q_{K_2}(-1) + \\tau(u_{K_2}-\\hat{u}(1)) = \\kappa(\\hat{u}(2)-\\hat{u}(1)) + \\tau(\\frac{\\hat{u}(1)+\\hat{u}(2)}{2} - \\hat{u}(1)) + \\frac{f_2}{2} = (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + \\frac{f_2}{2}$.\n- Sum of fluxes is zero: $( -(\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + \\frac{f_1}{2} ) + ( (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + \\frac{f_2}{2} ) = 0$.\nThis gives the first row of the global system: $(2\\kappa+\\tau)\\hat{u}(1) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) = \\frac{1}{2}(f_1+f_2)$.\n\nAt interface $x=2$ (between $K_2$ and $K_3$):\n- Flux from $K_2=[1,2]$ (normal $n=+1$):\n  Flux trace: $q_{K_2}(1) + \\tau(u_{K_2}-\\hat{u}(2)) = -\\kappa(\\hat{u}(2)-\\hat{u}(1)) + \\tau(\\frac{\\hat{u}(1)+\\hat{u}(2)}{2} - \\hat{u}(2)) + \\frac{f_2}{2} = (\\kappa+\\frac{\\tau}{2})\\hat{u}(1) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) + \\frac{f_2}{2}$.\n- Flux from $K_3=[2,3]$ (normal $n=-1$):\n  $q_{K_3} = -\\kappa(\\hat{u}(3)-\\hat{u}(2)) = \\kappa\\hat{u}(2)$.\n  $u_{K_3} = \\frac{\\hat{u}(2)+\\hat{u}(3)}{2} + \\frac{f_3}{2\\tau} = \\frac{\\hat{u}(2)}{2} + \\frac{f_3}{2\\tau}$.\n  Flux trace: $q_{K_3}(-1) + \\tau(u_{K_3}-\\hat{u}(2)) = -\\kappa\\hat{u}(2) + \\tau(\\frac{\\hat{u}(2)}{2} - \\hat{u}(2)) + \\frac{f_3}{2} = -(\\kappa+\\frac{\\tau}{2})\\hat{u}(2) + \\frac{f_3}{2}$.\n- Sum of fluxes is zero: $( (\\kappa+\\frac{\\tau}{2})\\hat{u}(1) - (\\kappa+\\frac{\\tau}{2})\\hat{u}(2) + \\frac{f_2}{2} ) + ( -(\\kappa+\\frac{\\tau}{2})\\hat{u}(2) + \\frac{f_3}{2} ) = 0$.\nThis gives the second row: $-(\\kappa+\\frac{\\tau}{2})\\hat{u}(1) + (2\\kappa+\\tau)\\hat{u}(2) = \\frac{1}{2}(f_2+f_3)$.\n\nExtracting the matrix from the global system, we get:\n$$S^{\\mathrm{DG}} = \\begin{pmatrix} 2\\kappa+\\tau & -(\\kappa+\\frac{\\tau}{2}) \\\\ -(\\kappa+\\frac{\\tau}{2}) & 2\\kappa+\\tau \\end{pmatrix}$$\n\n### Task 3: Sparsity and Bandwidth Comparison\n\nWe have derived the global condensed matrices for the interior trace unknowns $(\\hat{u}(1), \\hat{u}(2))$:\n$$S^{\\mathrm{WG}} = \\begin{pmatrix} 2\\kappa+\\tau & -(\\kappa+\\frac{\\tau}{2}) \\\\ -(\\kappa+\\frac{\\tau}{2}) & 2\\kappa+\\tau \\end{pmatrix}$$\n$$S^{\\mathrm{DG}} = \\begin{pmatrix} 2\\kappa+\\tau & -(\\kappa+\\frac{\\tau}{2}) \\\\ -(\\kappa+\\frac{\\tau}{2}) & 2\\kappa+\\tau \\end{pmatrix}$$\nThe matrices are identical, $S^{\\mathrm{WG}} = S^{\\mathrm{DG}}$.\n\nTo determine the bandwidth, we first identify the nonzero pattern. Since $\\kappa > 0$ and $\\tau > 0$, the diagonal entries $2\\kappa+\\tau$ are positive and the off-diagonal entries $-(\\kappa+\\frac{\\tau}{2})$ are negative. Thus, all four entries of both matrices are non-zero. The matrices are dense.\n\nThe bandwidth $B$ is defined as $B = 1 + \\max\\{|i-j|: (i,j) \\text{ is a nonzero entry}\\}$. The indices $(i,j)$ for the $2 \\times 2$ matrices are $(1,1), (1,2), (2,1), (2,2)$. The corresponding values of $|i-j|$ are $|1-1|=0$, $|1-2|=1$, $|2-1|=1$, and $|2-2|=0$. The maximum value is $1$.\nTherefore, the bandwidth for both matrices is:\n$$B_{\\mathrm{WG}} = 1 + 1 = 2$$\n$$B_{\\mathrm{DG}} = 1 + 1 = 2$$\nThe ratio of the bandwidths is:\n$$\\frac{B_{\\mathrm{WG}}}{B_{\\mathrm{DG}}} = \\frac{2}{2} = 1$$\nThis result demonstrates the known equivalence between this specific lowest-order WG method and the first-order HDG method on this problem.", "answer": "$$\\boxed{1}$$", "id": "3427857"}, {"introduction": "The connections and differences between numerical methods are often most apparent when applied to different classes of partial differential equations. Shifting our focus from diffusion to advection, this practice explores how WG and DG handle convective transport. You will analyze the numerical fluxes and derive the stability constraints for each method, revealing how the specific formulation of the interface terms dictates the maximum allowable time step for a non-oscillatory solution. [@problem_id:3427871]", "problem": "Consider the linear advection equation $u_{t} + \\boldsymbol{\\beta}\\cdot\\nabla u = 0$ on a one-dimensional domain partitioned into a uniform mesh of cells of size $h$, with a constant convection field $\\boldsymbol{\\beta} = \\beta \\mathbf{e}_{x}$ where $\\beta > 0$. On each cell, approximate $u$ by a piecewise constant polynomial ($p=0$). Let $u_{i}(t)$ denote the cell-average on cell $i$, and let $u^{-}$ and $u^{+}$ denote the traces on an interface from the left and right, respectively. Define the average and jump at an interface by $\\{u\\} = \\frac{1}{2}(u^{-}+u^{+})$ and $[u] = u^{+}-u^{-}$.\n\nTwo discrete methods are considered at each interior interface:\n\n- Discontinuous Galerkin (DG) method with the standard upwind numerical flux for advection: for $\\beta > 0$, $\\widehat{F}^{\\mathrm{DG}} = \\beta\\,u^{-}$.\n\n- Weak Galerkin (WG) method with a single-valued numerical trace that induces a Lax–Friedrichs-type interface flux with penalty parameter $\\tau \\ge 0$ (with the same physical units as $\\beta$): $\\widehat{F}^{\\mathrm{WG}} = \\beta\\,\\{u\\} - \\left(\\frac{\\beta}{2} + \\frac{\\tau}{2}\\right)[u]$. This form is consistent, conservative, and reduces to the DG upwind flux when $\\tau=0$.\n\nUsing conservation on each cell, derive the semi-discrete ordinary differential equation for $u_{i}(t)$ in each case and then consider a forward Euler time discretization with time step $\\Delta t$, defining the Courant number $\\nu = \\beta\\,\\Delta t / h$.\n\nImpose the discrete non-oscillatory (monotonicity) condition that the one-step forward Euler update on $u_{i}$ is a convex combination of the neighboring cell values $u_{i-1}^{n}$, $u_{i}^{n}$, and $u_{i+1}^{n}$ with nonnegative coefficients. Under this condition, determine the maximum allowable Courant number, denoted $\\nu_{\\max}$, for each method in terms of $\\beta$ and $\\tau$.\n\nExpress your final answer as a single row matrix containing, in order, $\\nu_{\\max}^{\\mathrm{WG}}$ and $\\nu_{\\max}^{\\mathrm{DG}}$. No units are required for the final, dimensionless result. Do not round; give exact symbolic expressions.", "solution": "The governing partial differential equation is the linear advection equation in one dimension:\n$$ u_{t} + \\beta u_{x} = 0 $$\nwhere $\\beta > 0$ is a constant. The spatial domain is discretized into cells $K_i = [x_{i-1/2}, x_{i+1/2}]$ of uniform size $h = x_{i+1/2} - x_{i-1/2}$. The solution $u$ is approximated by a piecewise constant function, $u(x,t) \\approx u_i(t)$ for $x \\in K_i$.\n\nThe semi-discrete formulation for the cell-average $u_i$ is obtained by integrating the PDE over cell $K_i$ and using a constant test function $v=1$:\n$$ \\int_{K_i} u_t \\,dx + \\int_{K_i} \\beta u_x \\,dx = 0 $$\n$$ \\frac{d}{dt} \\left( \\int_{K_i} u_i(t) \\,dx \\right) + \\beta [u(x,t)]_{x_{i-1/2}}^{x_{i+1/2}} = 0 $$\n$$ h \\frac{du_i}{dt} + \\beta(u(x_{i+1/2}, t) - u(x_{i-1/2}, t)) = 0 $$\nThe exact solution traces $u(x_{i \\pm 1/2}, t)$ are replaced by a numerical flux function $\\widehat{F}(u^-, u^+)$, where $u^-$ and $u^+$ are the approximate solution values to the left and right of the interface, respectively. This gives the conservative finite volume-type scheme:\n$$ h \\frac{du_i}{dt} + \\widehat{F}_{i+1/2} - \\widehat{F}_{i-1/2} = 0 $$\nwhere $\\widehat{F}_{i+1/2}$ is the flux at the interface $x_{i+1/2}$ between cells $i$ and $i+1$, and $\\widehat{F}_{i-1/2}$ is the flux at the interface $x_{i-1/2}$ between cells $i-1$ and $i$.\n\n**Part 1: Discontinuous Galerkin (DG) Method**\n\nFor the DG method, the numerical flux is the upwind flux. Since $\\beta > 0$, the flow is from left to right, so the upwind value is the trace from the left, $u^-$.\n$$ \\widehat{F}^{\\mathrm{DG}}(u^-, u^+) = \\beta u^- $$\nAt interface $x_{i+1/2}$, we have $u^- = u_i$ and $u^+ = u_{i+1}$. The flux is:\n$$ \\widehat{F}_{i+1/2}^{\\mathrm{DG}} = \\beta u_i $$\nAt interface $x_{i-1/2}$, we have $u^- = u_{i-1}$ and $u^+ = u_i$. The flux is:\n$$ \\widehat{F}_{i-1/2}^{\\mathrm{DG}} = \\beta u_{i-1} $$\nSubstituting these fluxes into the conservation law:\n$$ h \\frac{du_i}{dt} + (\\beta u_i) - (\\beta u_{i-1}) = 0 $$\nThe semi-discrete ordinary differential equation (ODE) for the DG method is:\n$$ \\frac{du_i}{dt} = -\\frac{\\beta}{h}(u_i - u_{i-1}) $$\nApplying the forward Euler time discretization, $\\frac{u_i^{n+1}-u_i^n}{\\Delta t} = \\frac{du_i}{dt}\\Big|_{t=t^n}$:\n$$ \\frac{u_i^{n+1}-u_i^n}{\\Delta t} = -\\frac{\\beta}{h}(u_i^n - u_{i-1}^n) $$\n$$ u_i^{n+1} = u_i^n - \\frac{\\beta \\Delta t}{h}(u_i^n - u_{i-1}^n) $$\nUsing the Courant number $\\nu = \\frac{\\beta \\Delta t}{h}$:\n$$ u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n) = (1-\\nu)u_i^n + \\nu u_{i-1}^n $$\nThis is a convex combination of neighboring cell values if the coefficients are non-negative.\n1. Coefficient of $u_{i-1}^n$: $\\nu \\ge 0$. Since $\\beta, \\Delta t, h$ are all positive, this is satisfied.\n2. Coefficient of $u_i^n$: $1 - \\nu \\ge 0 \\implies \\nu \\le 1$.\n3. Coefficient of $u_{i+1}^n$ is $0$, which is non-negative.\n\nThe condition for monotonicity is $0 \\le \\nu \\le 1$. The maximum allowable Courant number is $\\nu_{\\max}^{\\mathrm{DG}} = 1$.\n\n**Part 2: Weak Galerkin (WG) Method**\n\nFor the WG method, the numerical flux is given by:\n$$ \\widehat{F}^{\\mathrm{WG}}(u^-, u^+) = \\beta\\{u\\} - \\left(\\frac{\\beta}{2} + \\frac{\\tau}{2}\\right)[u] = \\beta\\frac{u^-+u^+}{2} - \\frac{\\beta+\\tau}{2}(u^+-u^-) $$\nLet's expand this in terms of $u^-$ and $u^+$:\n$$ \\widehat{F}^{\\mathrm{WG}} = u^-\\left(\\frac{\\beta}{2} + \\frac{\\beta+\\tau}{2}\\right) + u^+\\left(\\frac{\\beta}{2} - \\frac{\\beta+\\tau}{2}\\right) = u^-\\left(\\frac{2\\beta+\\tau}{2}\\right) + u^+\\left(-\\frac{\\tau}{2}\\right) $$\nAt interface $x_{i+1/2}$, we have $u^- = u_i$ and $u^+ = u_{i+1}$:\n$$ \\widehat{F}_{i+1/2}^{\\mathrm{WG}} = u_i\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_{i+1}\\left(\\frac{\\tau}{2}\\right) $$\nAt interface $x_{i-1/2}$, we have $u^- = u_{i-1}$ and $u^+ = u_i$:\n$$ \\widehat{F}_{i-1/2}^{\\mathrm{WG}} = u_{i-1}\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_i\\left(\\frac{\\tau}{2}\\right) $$\nSubstituting these into the conservation law $h \\frac{du_i}{dt} = -(\\widehat{F}_{i+1/2} - \\widehat{F}_{i-1/2})$:\n$$ h \\frac{du_i}{dt} = -\\left[ \\left(u_i\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_{i+1}\\left(\\frac{\\tau}{2}\\right)\\right) - \\left(u_{i-1}\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_i\\left(\\frac{\\tau}{2}\\right)\\right) \\right] $$\n$$ h \\frac{du_i}{dt} = u_{i-1}\\left(\\frac{2\\beta+\\tau}{2}\\right) - u_i\\left(\\frac{2\\beta+\\tau}{2} + \\frac{\\tau}{2}\\right) + u_{i+1}\\left(\\frac{\\tau}{2}\\right) $$\n$$ h \\frac{du_i}{dt} = u_{i-1}\\left(\\beta+\\frac{\\tau}{2}\\right) - u_i(\\beta+\\tau) + u_{i+1}\\left(\\frac{\\tau}{2}\\right) $$\nThe semi-discrete ODE for the WG method is:\n$$ \\frac{du_i}{dt} = \\frac{1}{h}\\left( \\left(\\beta+\\frac{\\tau}{2}\\right)u_{i-1} - (\\beta+\\tau)u_i + \\frac{\\tau}{2}u_{i+1} \\right) $$\nApplying the forward Euler time discretization:\n$$ \\frac{u_i^{n+1}-u_i^n}{\\Delta t} = \\frac{1}{h}\\left( \\left(\\beta+\\frac{\\tau}{2}\\right)u_{i-1}^n - (\\beta+\\tau)u_i^n + \\frac{\\tau}{2}u_{i+1}^n \\right) $$\n$$ u_i^{n+1} = u_i^n + \\frac{\\Delta t}{h}\\left( \\left(\\beta+\\frac{\\tau}{2}\\right)u_{i-1}^n - (\\beta+\\tau)u_i^n + \\frac{\\tau}{2}u_{i+1}^n \\right) $$\nGrouping terms by cell index:\n$$ u_i^{n+1} = \\left(\\frac{\\Delta t}{h}\\left(\\beta+\\frac{\\tau}{2}\\right)\\right)u_{i-1}^n + \\left(1 - \\frac{\\Delta t}{h}(\\beta+\\tau)\\right)u_i^n + \\left(\\frac{\\Delta t}{h}\\frac{\\tau}{2}\\right)u_{i+1}^n $$\nFor this to be a convex combination, all coefficients must be non-negative.\n1. Coefficient of $u_{i-1}^n$: $\\frac{\\Delta t}{h}(\\beta+\\frac{\\tau}{2}) \\ge 0$. As $\\Delta t, h, \\beta > 0$ and $\\tau \\ge 0$, this is satisfied.\n2. Coefficient of $u_{i+1}^n$: $\\frac{\\Delta t}{h}\\frac{\\tau}{2} \\ge 0$. As $\\Delta t, h > 0$ and $\\tau \\ge 0$, this is satisfied.\n3. Coefficient of $u_i^n$: $1 - \\frac{\\Delta t}{h}(\\beta+\\tau) \\ge 0$. This gives the stability constraint:\n$$ 1 \\ge \\frac{\\Delta t}{h}(\\beta+\\tau) $$\n$$ \\Delta t \\le \\frac{h}{\\beta+\\tau} $$\nTo express this in terms of the Courant number $\\nu = \\frac{\\beta \\Delta t}{h}$, we rearrange the inequality:\n$$ \\frac{\\beta \\Delta t}{h} \\le \\frac{\\beta}{\\beta+\\tau} $$\n$$ \\nu \\le \\frac{\\beta}{\\beta+\\tau} $$\nThe maximum allowable Courant number for the WG method is $\\nu_{\\max}^{\\mathrm{WG}} = \\frac{\\beta}{\\beta+\\tau}$.\n\n**Conclusion**\n\nThe maximum allowable Courant number for each method under the monotonicity condition is:\n- For DG with upwind flux: $\\nu_{\\max}^{\\mathrm{DG}} = 1$.\n- For WG with the given Lax-Friedrichs-type flux: $\\nu_{\\max}^{\\mathrm{WG}} = \\frac{\\beta}{\\beta+\\tau}$.\n\nThe final answer is to be provided as a row matrix containing $\\nu_{\\max}^{\\mathrm{WG}}$ and $\\nu_{\\max}^{\\mathrm{DG}}$ in that order.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\beta}{\\beta+\\tau} & 1\n\\end{pmatrix}\n}\n$$", "id": "3427871"}, {"introduction": "Theoretical equivalences and differences between methods have profound consequences for their practical implementation and computational efficiency. This problem moves from analytical derivation to computational thinking, guiding you to compare the degrees of freedom and matrix bandwidth for Symmetric Interior Penalty Galerkin (SIPG), WG, and the Virtual Element Method (VEM). By analyzing the combinatorial structure of the global systems, especially on general polygonal meshes, you will gain insight into the practical trade-offs and architectural advantages of skeleton-based methods like WG and VEM. [@problem_id:3427874]", "problem": "Consider the scalar Poisson model problem on a polygonal mesh in two space dimensions, discretized by three families of methods that are known to be closely related in their algebraic structure: the Symmetric Interior Penalty Galerkin (SIPG) method, the Weak Galerkin (WG) method, and the Virtual Element Method (VEM). Use the following fundamental starting points to derive implementable complexity metrics and program a quantitative comparison on a mesh with mixed polygonal types.\n\nThe fundamental base is:\n- The polynomial space of total degree at most $k$ on a cell $K \\subset \\mathbb{R}^2$, denoted $\\mathbb{P}_k(K)$, has dimension $\\dim \\mathbb{P}_k(K) = \\frac{(k+1)(k+2)}{2}$.\n- For the SIPG method with polynomial degree $k$ and piecewise polynomial unknowns defined on cells, the discrete unknowns reside in $\\mathbb{P}_k(K)$ independently per cell, and the bilinear form couples neighboring cells that share a mesh edge.\n- For the WG method with the discrete weak form that uses $\\mathbb{P}_k(K)$ in the interior and $\\mathbb{P}_k(e)$ on each mesh edge $e$ (this is sometimes denoted WG($k,k$)), static condensation eliminates cell-interior unknowns to produce a Schur complement system posed on the mesh skeleton with $(k+1)$ edge-based unknowns per edge.\n- For the nonconforming VEM of order $k$, the canonical degrees of freedom are edge moments against $\\mathbb{P}_{k-1}(e)$ and interior moments against $\\mathbb{P}_{k-2}(K)$, but static condensation of the interior moments leads to a global system posed on the mesh skeleton with $k$ edge-based unknowns per edge.\n\nYour task is to formalize the counting and sparsity metrics that follow from these definitions and implement a program that, for a fixed set of meshes and polynomial degrees, computes and reports:\n- The total number of global unknowns (degrees of freedom) for the SIPG, WG (after static condensation), and VEM (after static condensation) methods.\n- A bandwidth proxy for the corresponding global stiffness matrix under a canonical ordering. The bandwidth of a sparse matrix $A \\in \\mathbb{R}^{N \\times N}$ is defined as $1 + \\max\\{|i-j| : A_{ij} \\neq 0\\}$, where indices are $0$-based in the program. Use the following canonical orderings:\n  1. For SIPG, order cell blocks by increasing cell index and, within each cell, order its $\\mathbb{P}_k$ basis arbitrarily but consistently; treat each cell block as dense, and include dense coupling between two neighboring cells that share an edge.\n  2. For WG after static condensation, order edges by increasing edge index and, within each edge, order the $(k+1)$ edge-based degrees of freedom arbitrarily but consistently; within each cell, the Schur complement couples all edge unknowns belonging to that cell as a dense block.\n  3. For VEM after static condensation, order edges by increasing edge index and, within each edge, order the $k$ edge-based degrees of freedom; within each cell, the Schur complement couples all edge unknowns belonging to that cell as a dense block.\n\nDerive from first principles the degree-of-freedom counts as functions of the number of cells $N_c$, the number of edges $N_e$, and the polynomial degree $k$. Then, based on the canonical ordering rules above and the coupling structure described, derive an algorithm to compute the matrix sparsity pattern and the resulting bandwidth under the chosen ordering, strictly in terms of the combinatorics of the mesh and the values of $k$.\n\nYour program must construct and analyze a mesh with mixed polygonal types. Use the following two meshes, specified by vertex coordinates and polygonal cells, each understood as a non-overlapping tessellation of a rectangular domain.\n\nMesh $\\mathcal{M}_1$: vertices at coordinates\n$(0,0)$, $(1,0)$, $(2,0)$, $(0,1)$, $(1,1)$, $(2,1)$, $(0,2)$, $(1,2)$, $(2,2)$,\nwith vertex indices $0,\\dots,8$ in that order. The cells are:\n- Triangle $C_0 = [0,1,3]$,\n- Triangle $C_1 = [1,4,3]$,\n- Quadrilateral $C_2 = [1,2,5,4]$,\n- Pentagon $C_3 = [3,4,5,7,6]$,\n- Triangle $C_4 = [5,8,7]$,\nwhere each cell is the polygon with vertices listed in counter-clockwise order by their indices.\n\nMesh $\\mathcal{M}_2$: using the same vertex set, the cells are:\n- Triangle $D_0 = [0,1,3]$,\n- Pentagon $D_1 = [1,2,5,4,3]$.\n\nIn both meshes, an undirected edge is the unordered pair $\\{i,j\\}$ of adjacent vertex indices that appear consecutively in some cell’s vertex list (with wrap-around from last to first).\n\nStarting from the fundamental base above, do the following in your program:\n1. Implement a routine to enumerate edges and adjacency: given the list of cells as vertex-index polygons, produce the set of unique edges, a mapping from each edge to the list of adjacent cell indices, and a mapping from each cell to its ordered list of edges.\n2. For each method and each test case, compute the total number of degrees of freedom and the matrix bandwidth under the canonical ordering, using only the combinatorial coupling rules derived from the fundamental base. You must treat each intra-cell block as dense and, when a pair of cells share an edge, treat the inter-cell block as dense for SIPG. For WG and VEM after static condensation, for each cell couple all degrees of freedom on the edges of that cell as a dense block.\n3. Assemble the sparsity pattern abstractly and compute the bandwidth as specified, using $0$-based indexing.\n\nTest Suite and required outputs:\n- Use the following four test cases defined by $(\\text{mesh}, k)$:\n  1. $(\\mathcal{M}_1, 1)$,\n  2. $(\\mathcal{M}_1, 2)$,\n  3. $(\\mathcal{M}_1, 3)$,\n  4. $(\\mathcal{M}_2, 2)$.\n- For each test case, output a list of six integers in the order\n  $[\\text{dofs\\_SIPG}, \\text{bw\\_SIPG}, \\text{dofs\\_WG}, \\text{bw\\_WG}, \\text{dofs\\_VEM}, \\text{bw\\_VEM}]$,\n  where $\\text{dofs\\_SIPG}$ is the total number of SIPG global unknowns, $\\text{bw\\_SIPG}$ is the SIPG bandwidth, $\\text{dofs\\_WG}$ and $\\text{bw\\_WG}$ are the corresponding WG quantities after static condensation, and $\\text{dofs\\_VEM}$ and $\\text{bw\\_VEM}$ are the corresponding VEM quantities after static condensation.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of the six-integer lists, enclosed in square brackets with no spaces. For example, the output format must match the pattern $[[a_1,a_2,a_3,a_4,a_5,a_6],[b_1,b_2,b_3,b_4,b_5,b_6],\\dots]$.\n\nAll answers are purely numerical and dimensionless; do not use physical units. Angles are not involved. Express all numbers in the output as plain integers as required by the format.", "solution": "The problem requires the calculation of the total number of global unknowns (degrees of freedom, or DOFs) and the global stiffness matrix bandwidth for three numerical methods—SIPG, WG, and VEM—on specified polygonal meshes. The calculations depend on the polynomial degree $k$, the number of cells $N_c$, the number of edges $N_e$, and the mesh connectivity under a specified canonical ordering.\n\nLet $k \\in \\mathbb{N}$ be the polynomial degree. Let the mesh consist of $N_c$ cells, indexed $C_0, C_1, \\ldots, C_{N_c-1}$, and $N_e$ edges, indexed $e_0, e_1, \\ldots, e_{N_e-1}$ based on a canonical ordering (e.g., lexicographical sorting of vertex-pair representations).\n\n### 1. Derivation of Degrees of Freedom (DOFs)\n\nThe total number of global DOFs is determined by the basis functions used by each method after any specified static condensation.\n\n**Symmetric Interior Penalty Galerkin (SIPG)**\nThe unknowns are piecewise polynomials defined on each cell. The space of polynomials of total degree at most $k$ on a cell $K$, $\\mathbb{P}_k(K)$, has dimension $d_k = \\dim \\mathbb{P}_k(K) = \\frac{(k+1)(k+2)}{2}$. Since the DOFs are defined independently for each of the $N_c$ cells, the total number of DOFs is:\n$$\n\\text{dofs}_{\\text{SIPG}} = N_c \\cdot d_k = N_c \\cdot \\frac{(k+1)(k+2)}{2}\n$$\n\n**Weak Galerkin (WG)**\nAfter static condensation of cell-interior unknowns, the WG method is posed on the mesh skeleton. The problem states there are $(k+1)$ unknowns associated with each edge. The total number of DOFs is the sum over all $N_e$ edges:\n$$\n\\text{dofs}_{\\text{WG}} = N_e \\cdot (k+1)\n$$\n\n**Virtual Element Method (VEM)**\nSimilar to WG, after static condensation of cell-interior moments, the nonconforming VEM is posed on the mesh skeleton. The problem states there are $k$ unknowns associated with each edge. The total number of DOFs is:\n$$\n\\text{dofs}_{\\text{VEM}} = N_e \\cdot k\n$$\n\n### 2. Derivation of Matrix Bandwidth\n\nThe bandwidth of a matrix $A$ is defined as $B = 1 + \\max\\{|i-j| : A_{ij} \\neq 0\\}$, where indices $i$ and $j$ are 0-based. To find the bandwidth, we must determine the maximum difference between global indices of any two coupled DOFs under the specified canonical ordering.\n\n**SIPG Bandwidth**\nThe SIPG DOFs are ordered by cell index. All DOFs for cell $C_0$ come first, then all for $C_1$, and so on. The number of DOFs per cell is $d_k = \\frac{(k+1)(k+2)}{2}$. The global indices for DOFs on cell $C_i$ are in the range $[i \\cdot d_k, (i+1) \\cdot d_k - 1]$.\n\nCoupling occurs in two scenarios:\n1.  **Intra-cell:** All DOFs within a cell $C_i$ are coupled, forming a dense block. The maximum index difference is $((i+1)d_k - 1) - (i d_k) = d_k - 1$.\n2.  **Inter-cell:** DOFs on neighboring cells $C_i$ and $C_j$ are coupled. Assuming $i  j$, the DOFs on $C_i$ are in $[i \\cdot d_k, (i+1)d_k - 1]$ and on $C_j$ are in $[j \\cdot d_k, (j+1)d_k - 1]$. The maximum index difference for this pair is the difference between the largest possible index for $C_j$ and the smallest for $C_i$:\n    $$\n    ((j+1)d_k - 1) - (i d_k) = (j-i)d_k + d_k - 1\n    $$\nTo find the global maximum difference, we maximize this expression over all neighboring pairs $(C_i, C_j)$. Let $\\Delta_{\\text{cell}} = \\max \\{|i-j| \\mid C_i \\text{ and } C_j \\text{ are neighbors}\\}$. The maximum index difference is:\n$$\nD_{\\text{SIPG}} = \\Delta_{\\text{cell}} \\cdot d_k + d_k - 1 = (\\Delta_{\\text{cell}} + 1)d_k - 1\n$$\nThe bandwidth is $B_{\\text{SIPG}} = 1 + D_{\\text{SIPG}} = (\\Delta_{\\text{cell}} + 1)d_k$.\n\n**WG and VEM Bandwidth**\nFor WG and VEM, the global DOFs are ordered by edge index. Let $d_k^{\\text{edge}}$ be the number of DOFs per edge ($k+1$ for WG, $k$ for VEM). The global indices for DOFs on edge $e_i$ are in the range $[i \\cdot d_k^{\\text{edge}}, (i+1) \\cdot d_k^{\\text{edge}} - 1]$.\n\nThe coupling rule states that for any cell $C_c$, all DOFs on its boundary edges are coupled. Let the set of indices of edges on the boundary of $C_c$ be $I_c$. Let $i_{\\min, c} = \\min(I_c)$ and $i_{\\max, c} = \\max(I_c)$.\nThe smallest global index associated with $C_c$ is the first an on edge $e_{i_{\\min, c}}$, which is $i_{\\min, c} \\cdot d_k^{\\text{edge}}$.\nThe largest global index associated with $C_c$ is the last one on edge $e_{i_{\\max, c}}$, which is $(i_{\\max, c}+1)d_k^{\\text{edge}} - 1$.\nThe maximum index difference for the coupling block of cell $C_c$ is:\n$$\nD_c = ((i_{\\max, c}+1)d_k^{\\text{edge}} - 1) - (i_{\\min, c} \\cdot d_k^{\\text{edge}}) = (i_{\\max, c} - i_{\\min, c})d_k^{\\text{edge}} + d_k^{\\text{edge}} - 1\n$$\nThe global maximum difference, $D$, is the maximum of $D_c$ over all cells $c=0, \\ldots, N_c-1$. Let $\\Delta_{\\text{edge\\_span}} = \\max_c \\{i_{\\max, c} - i_{\\min, c}\\}$. Then:\n$$\nD_{\\text{WG/VEM}} = \\Delta_{\\text{edge\\_span}} \\cdot d_k^{\\text{edge}} + d_k^{\\text{edge}} - 1 = (\\Delta_{\\text{edge\\_span}} + 1)d_k^{\\text{edge}} - 1\n$$\nThe bandwidth is $B = 1 + D_{\\text{WG/VEM}} = (\\Delta_{\\text{edge\\_span}} + 1)d_k^{\\text{edge}}$.\nThis single formula applies to both WG and VEM, using their respective values for $d_k^{\\text{edge}}$:\n$$\nB_{\\text{WG}} = (\\Delta_{\\text{edge\\_span}} + 1)(k+1)\n$$\n$$\nB_{\\text{VEM}} = (\\Delta_{\\text{edge\\_span}} + 1)k\n$$\n\nThese derived formulas will be implemented in the provided program.", "answer": "```python\nimport numpy as np\n\ndef analyze_mesh(cells):\n    \"\"\"\n    Analyzes mesh topology to extract key combinatorial data.\n    \n    Args:\n        cells (list of lists of int): A list of polygons, where each polygon is\n                                     a list of vertex indices.\n\n    Returns:\n        A tuple containing:\n        - num_cells (int): Total number of cells.\n        - num_edges (int): Total number of unique edges.\n        - cell_neighbors (dict): Mapping from cell index to a set of neighbor cell indices.\n        - cell_to_edge_indices (list of lists): Mapping from cell index to a list of\n                                                 its edge indices.\n    \"\"\"\n    num_cells = len(cells)\n    unique_edges = set()\n    edge_to_cells = {}\n\n    for i, cell_vertices in enumerate(cells):\n        for j in range(len(cell_vertices)):\n            v1 = cell_vertices[j]\n            v2 = cell_vertices[(j + 1) % len(cell_vertices)]\n            # Canonical representation of an edge\n            edge = tuple(sorted((v1, v2)))\n            unique_edges.add(edge)\n            \n            # Record which cells are adjacent to this edge\n            if edge not in edge_to_cells:\n                edge_to_cells[edge] = []\n            if i not in edge_to_cells[edge]:\n                edge_to_cells[edge].append(i)\n\n    # Establish canonical ordering for edges\n    sorted_edges = sorted(list(unique_edges))\n    edge_to_idx = {edge: i for i, edge in enumerate(sorted_edges)}\n    num_edges = len(sorted_edges)\n\n    # Build cell-to-edge index mapping\n    cell_to_edge_indices = [[] for _ in range(num_cells)]\n    for i, cell_vertices in enumerate(cells):\n        for j in range(len(cell_vertices)):\n            v1 = cell_vertices[j]\n            v2 = cell_vertices[(j + 1) % len(cell_vertices)]\n            edge = tuple(sorted((v1, v2)))\n            idx = edge_to_idx[edge]\n            if idx not in cell_to_edge_indices[i]:\n                 cell_to_edge_indices[i].append(idx)\n\n    # Build cell adjacency graph\n    cell_neighbors = {i: set() for i in range(num_cells)}\n    for edge, adj_cells in edge_to_cells.items():\n        if len(adj_cells) > 1:\n            # Assuming an edge is shared by at most 2 cells in a valid tessellation\n            c1, c2 = adj_cells[0], adj_cells[1]\n            cell_neighbors[c1].add(c2)\n            cell_neighbors[c2].add(c1)\n            \n    return num_cells, num_edges, cell_neighbors, cell_to_edge_indices\n\ndef calculate_metrics(k, num_cells, num_edges, cell_neighbors, cell_to_edge_indices):\n    \"\"\"\n    Calculates DOFs and bandwidths for SIPG, WG, and VEM.\n    \"\"\"\n    # --- SIPG ---\n    d_k = (k + 1) * (k + 2) // 2\n    dofs_sipg = num_cells * d_k\n\n    max_cell_diff = 0\n    for i, neighbors in cell_neighbors.items():\n        if neighbors:\n            max_cell_diff = max(max_cell_diff, max(abs(i - j) for j in neighbors))\n    \n    bw_sipg = (max_cell_diff + 1) * d_k\n\n    # --- WG  VEM ---\n    # Find max span of edge indices for any cell\n    max_edge_span = 0\n    for edges_on_cell in cell_to_edge_indices:\n        if edges_on_cell:\n            span = max(edges_on_cell) - min(edges_on_cell)\n            max_edge_span = max(max_edge_span, span)\n\n    # WG\n    d_k_edge_wg = k + 1\n    dofs_wg = num_edges * d_k_edge_wg\n    bw_wg = (max_edge_span + 1) * d_k_edge_wg\n\n    # VEM\n    d_k_edge_vem = k\n    dofs_vem = num_edges * d_k_edge_vem\n    bw_vem = (max_edge_span + 1) * d_k_edge_vem if k > 0 else 0\n\n    return [dofs_sipg, bw_sipg, dofs_wg, bw_wg, dofs_vem, bw_vem]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define meshes and test cases\n    mesh1_cells = [\n        [0, 1, 3],        # C0\n        [1, 4, 3],        # C1\n        [1, 2, 5, 4],     # C2\n        [3, 4, 5, 7, 6],  # C3\n        [5, 8, 7]         # C4\n    ]\n\n    mesh2_cells = [\n        [0, 1, 3],          # D0\n        [1, 2, 5, 4, 3]   # D1\n    ]\n\n    test_cases = [\n        {'mesh_cells': mesh1_cells, 'k': 1},\n        {'mesh_cells': mesh1_cells, 'k': 2},\n        {'mesh_cells': mesh1_cells, 'k': 3},\n        {'mesh_cells': mesh2_cells, 'k': 2},\n    ]\n\n    results = []\n    \n    # Process each test case\n    for case in test_cases:\n        k = case['k']\n        mesh_cells = case['mesh_cells']\n        \n        num_cells, num_edges, cell_neighbors, cell_to_edge_indices = analyze_mesh(mesh_cells)\n        \n        metrics = calculate_metrics(k, num_cells, num_edges, cell_neighbors, cell_to_edge_indices)\n        results.append(metrics)\n\n    # Format output\n    def format_list(lst):\n        return f\"[{','.join(map(str, lst))}]\"\n\n    stringified_results = [format_list(r) for r in results]\n    print(f\"[{','.join(stringified_results)}]\")\n\nsolve()\n```", "id": "3427874"}]}