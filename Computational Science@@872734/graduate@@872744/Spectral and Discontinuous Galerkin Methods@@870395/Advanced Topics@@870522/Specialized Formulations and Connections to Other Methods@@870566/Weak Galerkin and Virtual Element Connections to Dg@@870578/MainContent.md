## Introduction
Modern numerical analysis for [partial differential equations](@entry_id:143134) is characterized by a suite of powerful techniques, among which Discontinuous Galerkin (DG), Weak Galerkin (WG), and Virtual Element (VEM) methods stand out for their flexibility and robustness. While often presented as distinct frameworks, a deeper investigation reveals profound theoretical and practical connections that are essential for the advanced practitioner to master. This article bridges the conceptual gaps between these methods, moving beyond their individual formulations to uncover their shared principles and comparative advantages.

Across three chapters, we will embark on a systematic exploration of this interconnected landscape. The first chapter, "Principles and Mechanisms," deconstructs the core machinery of WG and VEM, explaining concepts like weak functions, discrete weak gradients, and virtual projectors, and demonstrates how their stabilization mechanisms are mathematically equivalent to the penalty terms central to DG methods. The second chapter, "Applications and Interdisciplinary Connections," applies these theoretical insights to challenging problems in wave propagation and [nonlinear systems](@entry_id:168347), analyzing their comparative performance, computational costs, and utility in hybrid schemes. Finally, "Hands-On Practices" will provide opportunities to solidify these concepts through guided problems. This journey will illuminate how WG and VEM can be understood not as rivals to DG, but as its sophisticated and highly versatile extensions, offering a unified perspective on the frontier of numerical methods.

## Principles and Mechanisms

This chapter delves into the foundational principles and core mechanisms that underpin Weak Galerkin (WG) and Virtual Element (VEM) methods. We will deconstruct these modern numerical techniques to reveal their internal machinery, focusing on how they define discrete functions and differential operators, ensure consistency, and maintain stability. A central theme will be the systematic exploration of their deep and often surprising connections to the more established family of Discontinuous Galerkin (DG) methods, demonstrating that WG and VEM can be viewed as sophisticated and highly flexible extensions of DG principles.

### Redefining Functions and Operators in a Weak Setting

A departure from traditional continuous Finite Element Methods (FEM) is the use of [discontinuous functions](@entry_id:139518). While DG methods embrace this discontinuity, WG and VEM methods introduce a novel abstraction: the concept of a "weak" or "virtual" function, which is defined by separate pieces of information in the element interior and on its boundary.

#### The Weak Galerkin Approach

The Weak Galerkin method is built upon the idea of a **weak function**. On any given element $T$, a discrete weak function $v_h$ is not a single entity but a pair of functions, $v_h = \{v_0, v_b\}$. Here, $v_0$ represents the function in the interior of $T$, typically a polynomial in a space $\mathbb{P}_k(T)$, while $v_b$ represents the function on the boundary $\partial T$, residing in a space like $\mathbb{P}_k(\partial T)$. Crucially, there is no a priori requirement that $v_b$ be the trace of $v_0$. This "broken" representation provides immense flexibility, particularly in the choice of basis functions and element geometries. The connection between $v_0$ and $v_b$ is enforced weakly through a [stabilization term](@entry_id:755314), which we will discuss later.

With this redefinition of a function, we must also redefine [differential operators](@entry_id:275037). The cornerstone of the WG method is the **discrete [weak gradient](@entry_id:756667)**, denoted $\nabla_w$. The [weak gradient](@entry_id:756667) $\nabla_w v_h$ of a weak function $v_h=\{v_0, v_b\}$ is a polynomial vector field, say in $[\mathbb{P}_{k-1}(T)]^d$, that is defined not by differentiation but by an equation that mimics [integration by parts](@entry_id:136350). Specifically, $\nabla_w v_h$ is the unique function satisfying the following relation for all vector [test functions](@entry_id:166589) $\boldsymbol{q}$ from a suitable [polynomial space](@entry_id:269905) (e.g., $[\mathbb{P}_{k-1}(T)]^d$):
$$ (\nabla_w v_h, \boldsymbol{q})_T = -(v_0, \nabla \cdot \boldsymbol{q})_T + \langle v_b, \boldsymbol{q} \cdot \boldsymbol{n} \rangle_{\partial T} $$
Here, $(\cdot, \cdot)_T$ is the standard $L^2$ inner product on the element $T$, and $\langle \cdot, \cdot \rangle_{\partial T}$ is the $L^2$ inner product (or duality pairing) on its boundary $\partial T$. This definition is a discrete analogue of Green's first identity. If $v_h$ were a classical [smooth function](@entry_id:158037), where $v_0=v$ and $v_b$ is the trace of $v$, this equation would simply state $(\nabla v, \boldsymbol{q})_T = (\nabla v, \boldsymbol{q})_T$. The WG definition ingeniously uses this identity to define a gradient for functions that lack classical [differentiability](@entry_id:140863).

Let us illustrate the computation of the [weak gradient](@entry_id:756667) with a concrete example. Consider a triangular element $T$ and the lowest-order case where $v_0 \in \mathbb{P}_1(T)$, $v_b$ is piecewise constant on each edge, and the [weak gradient](@entry_id:756667) $\nabla_w v_h$ is sought in the space of constant vectors, $[\mathbb{P}_0(T)]^2$. If the underlying function is a linear polynomial $u(x,y)$, and we define $v_0$ to be its nodal interpolant and $v_b$ to be its average value on each edge, the definition of the [weak gradient](@entry_id:756667) can be applied directly. Since any test function $\boldsymbol{q} \in [\mathbb{P}_0(T)]^2$ is a constant vector, its divergence $\nabla \cdot \boldsymbol{q}$ is zero, simplifying the defining equation to $(\nabla_w v_h, \boldsymbol{q})_T = \langle v_b, \boldsymbol{q} \cdot \boldsymbol{n} \rangle_{\partial T}$. By explicitly calculating the boundary integrals over each edge for a specific linear function like $u(x,y)=2x-3y+1$, one can solve for the components of the constant vector $\nabla_w v_h$. This calculation reveals a fundamental property: the computed [weak gradient](@entry_id:756667) $\nabla_w v_h$ is identical to the true gradient $\nabla u = (2,-3)$. This is not a coincidence; it is a manifestation of the polynomial-consistency of the weak [gradient operator](@entry_id:275922) [@problem_id:3427875].

This principle of defining discrete operators through weak formulations extends to other differential operators, such as the weak divergence and weak Laplacian, forming the complete toolkit for discretizing a wide range of partial differential equations.

#### The Virtual Element Approach

The Virtual Element Method takes the concept of "not knowing the function" a step further. In VEM, the discrete function $v_h$ on an element $K$ is not explicitly defined pointwise inside the element. Instead, it is implicitly defined by a finite set of **degrees of freedom (DoFs)** and by satisfying certain weak differential constraints.

For a standard conforming VEM space of order $k$ on a polygon $K$, the local space $V_h(K)$ is abstractly defined as the set of $H^1(K)$ functions whose trace on each edge is a polynomial in $\mathbb{P}_k(e)$ and whose Laplacian is a polynomial in $\mathbb{P}_{k-2}(K)$. A function $v_h \in V_h(K)$ is uniquely characterized by a set of DoFs, which typically include [@problem_id:3427852]:
- The values of $v_h$ at the vertices of the polygon.
- For each edge $e$, the moments of $v_h|_e$ against a basis of $\mathbb{P}_{k-2}(e)$.
- The moments of $v_h$ against a basis of $\mathbb{P}_{k-2}(K)$ in the element interior.

The critical insight of VEM is that even though we do not have an explicit formula for $v_h$, these DoFs are precisely what is needed to compute its **projection** onto a [polynomial space](@entry_id:269905) $\mathbb{P}_k(K)$. For solving elliptic problems like the Poisson equation, the most natural projector is the **elliptic projector**, $\Pi_k^\nabla: V_h(K) \to \mathbb{P}_k(K)$, which is defined by requiring that the projection $\Pi_k^\nabla v_h$ has the same energetic behavior as $v_h$ when tested against polynomials. Formally, $\Pi_k^\nabla v_h$ is the unique polynomial in $\mathbb{P}_k(K)$ satisfying:
$$ (\nabla (\Pi_k^\nabla v_h), \nabla p)_K = (\nabla v_h, \nabla p)_K \quad \text{for all } p \in \mathbb{P}_k(K) $$
along with a constraint to fix the constant part, such as preserving the mean value, $\int_K \Pi_k^\nabla v_h \, dx = \int_K v_h \, dx$.

The "magic" of VEM lies in the fact that the right-hand side, $(\nabla v_h, \nabla p)_K$, can be computed without knowing $v_h$ itself. Using Green's identity, we have:
$$ (\nabla v_h, \nabla p)_K = -(v_h, \Delta p)_K + \langle v_h, \nabla p \cdot \boldsymbol{n} \rangle_{\partial K} $$
For any polynomial $p \in \mathbb{P}_k(K)$, its Laplacian $\Delta p$ is a polynomial in $\mathbb{P}_{k-2}(K)$. Therefore, the volume integral $-(v_h, \Delta p)_K$ is a linear combination of the known internal DoFs of $v_h$. On the boundary, the term $\nabla p \cdot \boldsymbol{n}$ is a polynomial, and the trace $v_h$ on each edge is also a known polynomial determined by the edge DoFs. Thus, the boundary integral is also computable. With the right-hand side computable, we can solve a small linear system for the coefficients of the polynomial $\Pi_k^\nabla v_h$ [@problem_id:3427852]. A concrete calculation for $k=1$ demonstrates this process, where the gradient of the projected polynomial is determined solely from the vertex values of the VEM function via boundary integrals [@problem_id:3427884]. An alternative to the elliptic projector is the $L^2$ projector, which is defined by matching moments against a [basis of polynomials](@entry_id:148579), a concept that connects VEM to spectral methods [@problem_id:3427854].

### The Role of Stabilization

A crucial component in both WG and VEM formulations is the **stabilization** term. This term is essential for the stability and convergence of the methods.

In Weak Galerkin, the weak function $\{v_0, v_b\}$ is composed of two independently chosen polynomials. The [stabilization term](@entry_id:755314) is what enforces a weak form of agreement between them. A standard stabilizer for an element $T$ takes the form of a scaled $L^2$ norm of the difference between the trace of the interior function, $v_0$, and the boundary function, $v_b$:
$$ s_T(v_h, v_h) = \tau_F \sum_{F \subset \partial T} \|Q_b v_0 - v_b\|_{0,F}^2 $$
where $\tau_F$ is a positive parameter and $Q_b$ is an $L^2$ projection onto the space of boundary functions. This term penalizes any discrepancy between the interior and boundary parts of the weak function.

In the Virtual Element Method, the [bilinear form](@entry_id:140194) is split into a "consistency" part, which operates on the polynomial projection, and a "stability" part. The discrete bilinear form for the [diffusion operator](@entry_id:136699) is:
$$ a_{h,K}(u_h, v_h) = (\kappa \nabla \Pi_k^\nabla u_h, \nabla \Pi_k^\nabla v_h)_K + S_K((I - \Pi_k^\nabla)u_h, (I - \Pi_k^\nabla)v_h) $$
The [stabilization term](@entry_id:755314) $S_K$ acts on the non-polynomial part of the VEM functions, $(I - \Pi_k^\nabla)v_h$. The requirements on $S_K$ are that it must be computable from the VEM degrees of freedom and that it must be spectrally equivalent to the energy semi-norm on the kernel of the projector. That is, $S_K(w,w) \approx a_K(w,w)$ for all $w \in \ker(\Pi_k^\nabla)$ [@problem_id:3427852]. This ensures that the non-polynomial, "virtual" part of the solution is controlled, leading to a stable overall scheme.

A profound insight reveals that these stabilization mechanisms are deeply connected to the penalty terms used in Discontinuous Galerkin methods. Consider an interface $F$ shared by two elements. In the Symmetric Interior Penalty Galerkin (SIPG) method, a penalty term of the form $(\sigma/h_F) \|[u]\|_{0,F}^2$ is added to penalize the jump $[u]$ in the solution. Now consider the WG stabilizer. If one assumes a single-valued face unknown $u_b$ on the interface and then formally eliminates it by minimizing the sum of the stabilizer contributions from the two adjacent elements, the resulting minimized term is [@problem_id:3427869]:
$$ S_{WG}^{\min} = \frac{\tau_F}{2} \|u^+ - u^-\|_{0,F}^2 = \frac{\tau_F}{2} \|[u]\|_{0,F}^2 $$
This is precisely the form of the SIPG penalty term. Equating the two reveals a direct correspondence between the WG [stabilization parameter](@entry_id:755311) $\tau_F$ and the SIPG penalty parameter $\sigma$: $\tau_F = 2\sigma/h_F$. This demonstrates that the WG stabilizer is, in effect, a cleverly designed interior penalty mechanism.

This connection can also be seen through the lens of DG **lifting operators**. A [lifting operator](@entry_id:751273) $R_f([u])$ maps a jump on a face $f$ to a function in the interior of the adjacent elements. For a 1D problem, it can be shown that the energy associated with this lifting, $\int_K |R_f([u])|^2 dx$, is identical to the energy of the SIPG jump penalty term for a specific choice of [penalty parameter](@entry_id:753318) [@problem_id:3427890]. This reinforces the idea that WG, VEM, and DG methods all employ related mechanisms—stabilizers, penalties, or liftings—to control discontinuities and ensure stability.

### Polynomial Consistency and Accuracy

For any numerical method to be convergent, it must be **consistent**, meaning it should be able to exactly reproduce the solution of the PDE if that solution is a [simple function](@entry_id:161332), typically a polynomial of a certain degree. This property is often verified using a "patch test."

Both WG and VEM are designed to be consistent by construction. Their key operators—the [weak gradient](@entry_id:756667) and the VEM projector—are defined to be exact on [polynomial spaces](@entry_id:753582). We saw that $\nabla_w p = \nabla p$ for any linear polynomial $p$ [@problem_id:3427875]. More generally, for a polynomial $p \in \mathbb{P}_k(T)$, if we define the weak function $p_h = \{p, p|_{\partial T}\}$, then it can be shown that $\nabla_w p_h = \nabla p$. Similarly, the VEM elliptic projector satisfies $\Pi_k^\nabla p = p$ for any $p \in \mathbb{P}_k(K)$, which implies that the gradient is also preserved: $\nabla (\Pi_k^\nabla p) = \nabla p$ [@problem_id:3427884].

This inherent [polynomial exactness](@entry_id:753577) ensures that the methods pass the patch test. If the exact solution $u$ to a PDE is a polynomial of degree $k$, and we use WG or VEM approximations of order $k$, the discrete methods will produce a zero residual. By defining the discrete solution $u_h$ from the exact solution $u$ (e.g., $u_0=u, u_b=u|_{\partial E}$ for WG) and substituting it into the [variational formulation](@entry_id:166033), all terms cancel out perfectly. The stabilization terms vanish because there is no discrepancy to penalize ($Q_b u_0 = u_b$ in WG, and $(I-\Pi_k^\nabla)u = 0$ in VEM). The consistency part of the [bilinear form](@entry_id:140194), when integrated by parts, exactly balances the source term, leaving a residual of zero [@problem_id:3427862]. This fundamental property is the theoretical underpinning of the accuracy and convergence of these methods.

### Deeper Connections to DG and Mixed Methods

The relationship between WG, VEM, and DG extends beyond the analogy of stabilization and penalties. At a structural level, they can be seen as different realizations of the same underlying mathematical principles.

#### Structural Equivalences

The VEM formulation, with its reliance on projection, can be interpreted as a DG method where all calculations involving the "virtual" function are replaced by calculations on its polynomial projection. This is most clearly seen by examining the local [stiffness matrix](@entry_id:178659) on the polynomial subspace $\mathbb{P}_k(K)$. For $k=1$, the VEM bilinear form, when restricted to the basis $\{1,x,y\}$, produces a matrix that is identical to the matrix generated by a DG-like scheme where gradients are first projected onto the space of constant vectors before the inner product is taken [@problem_id:3427859]. This shows that, for the polynomial part of the solution, VEM behaves exactly like a specific kind of DG method.

Similarly, WG methods are intimately connected to certain Hybridizable Discontinuous Galerkin (HDG) methods. The WG method can be shown to be equivalent to an HDG scheme with a particular choice of stabilization function. The Local Discontinuous Galerkin (LDG) method is also a special case of HDG. This shared heritage implies deep structural similarities. For instance, when analyzing the first-order [mixed formulation](@entry_id:171379) of the Poisson equation with the lowest-order Raviart-Thomas space $\mathrm{RT}_0$, it becomes apparent that WG mixed schemes and LDG schemes are fundamentally equivalent. Both methods rely on a single, continuous [numerical flux](@entry_id:145174) variable at element interfaces to ensure conservation. This conceptual link means that the degrees of freedom representing the normal flux on an interface are predicted to be the same by both schemes, and their difference is zero [@problem_id:3427868].

#### Conservation and Fluxes

A hallmark of high-quality [numerical methods for conservation laws](@entry_id:752804) is local mass conservation. This property, inherent in DG and [finite volume methods](@entry_id:749402), is also a key feature of WG and VEM. In the WG framework, the discrete [weak gradient](@entry_id:756667) gives rise to a **[numerical flux](@entry_id:145174)**. For a 1D problem, for example, the [weak gradient](@entry_id:756667) on an element $(x_i, x_{i+1})$ simplifies to $(\nabla_w u)_i = (u_b(x_{i+1}) - u_b(x_i))/h$. The WG [variational formulation](@entry_id:166033), in the absence of a [source term](@entry_id:269111), enforces that this quantity is constant across all elements. The numerical flux, defined as $\widehat{\sigma} = - \nabla_w u$, is therefore also constant across all interior interfaces. This ensures that the flux entering one element is the same as the flux exiting the adjacent element, satisfying the [local conservation law](@entry_id:261997) $\widehat{\sigma}_{i+1/2} - \widehat{\sigma}_{i-1/2} = \int_{T_i} f \, dx$ on each element [@problem_id:3427887]. This conservation property is a direct consequence of the way weak operators and inter-element coupling are defined.

In summary, Weak Galerkin and Virtual Element methods, while appearing novel and abstract, are built upon rigorous principles that extend and generalize the core ideas of Discontinuous Galerkin and [mixed methods](@entry_id:163463). By redefining functions and operators in a weak sense, they gain tremendous flexibility in handling complex geometries and arbitrary polynomial orders, while their carefully designed stabilization terms and [projection operators](@entry_id:154142) ensure consistency, stability, and the crucial physical property of [local conservation](@entry_id:751393).