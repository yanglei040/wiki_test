{"hands_on_practices": [{"introduction": "A primary source of suboptimal convergence in spectral methods is aliasing, where unresolved high-frequency information corrupts the representation of resolved, low-frequency modes. This exercise provides a tangible calculation of this effect by quantifying the error induced when a high-degree polynomial is projected onto a lower-degree basis using an inexact quadrature rule, a common scenario in mass-lumped Discontinuous Galerkin (DG) methods [@problem_id:3406691]. Understanding this mechanism is the first step toward diagnosing and mitigating convergence degradation.", "problem": "Consider the reference element $[-1,1]$ with the modal Legendre basis $\\{P_{k}(x)\\}_{k=0}^{p}$ and the nodal basis defined by $N=p+1$ Legendre–Gauss–Lobatto (LGL) nodes. In a Discontinuous Galerkin (DG) method, one common projection from nodal to modal coefficients uses a mass-lumped inner product based on LGL quadrature rather than the exact $L^{2}$ inner product. This induces aliasing when the integrand degree exceeds the quadrature exactness. The goal of this projection test is to quantify the induced aliasing error for a smooth function and to relate it to suboptimal convergence behavior.\n\nWork on the case $p=3$ with $N=4$ LGL nodes. The LGL nodes and weights on $[-1,1]$ are:\n- Nodes: $x_{0}=-1$, $x_{1}=-1/\\sqrt{5}$, $x_{2}=1/\\sqrt{5}$, $x_{3}=1$.\n- Weights: $w_{0}=w_{3}=1/6$, $w_{1}=w_{2}=5/6$.\n\nLet the function be the smooth polynomial $f(x)=P_{6}(x)$, where $P_{n}(x)$ denotes the Legendre polynomial of degree $n$. Use the explicit formulas $P_{2}(x)=\\tfrac{1}{2}(3x^{2}-1)$ and $P_{6}(x)=\\tfrac{1}{16}\\big(231x^{6}-315x^{4}+105x^{2}-5\\big)$. Define the exact continuous $L^{2}$-modal coefficient\n$$\na_{k}=\\frac{\\int_{-1}^{1} f(x)\\,P_{k}(x)\\,dx}{\\int_{-1}^{1} P_{k}(x)^{2}\\,dx},\n$$\nand the mass-lumped LGL-discrete coefficient\n$$\na_{k}^{\\mathrm{LGL}}=\\frac{\\sum_{i=0}^{N-1} w_{i}\\, f(x_{i})\\,P_{k}(x_{i})}{\\sum_{i=0}^{N-1} w_{i}\\, P_{k}(x_{i})^{2}}.\n$$\nBecause $f$ has degree $6$ and the quadrature exactness is $2N-3=5$, an aliasing error arises when using the LGL-based coefficient in place of the exact one.\n\nCompute the aliasing error in the even mode $k=2$,\n$$\nE:=a_{2}^{\\mathrm{LGL}}-a_{2},\n$$\nas a single exact fraction. This error quantifies the spurious coupling of an unresolved high-degree component into a resolved mode when using collocation and mass-lumping, and it is a mechanism for suboptimal convergence in nonlinear spectral and DG formulations. Provide the final value of $E$ in exact form. No rounding is required. Express your answer as a reduced fraction with no units.", "solution": "The user wants me to validate and solve a problem concerning aliasing error in a Discontinuous Galerkin (DG) method framework.\n\n### Step 1: Extract Givens\n-   Reference element: $[-1,1]$\n-   Modal basis: Legendre polynomials $\\{P_{k}(x)\\}_{k=0}^{p}$\n-   Polynomial degree: $p=3$\n-   Number of nodes: $N=p+1=4$\n-   Nodal basis: Legendre–Gauss–Lobatto (LGL) nodes\n-   LGL Nodes for $N=4$: $x_{0}=-1$, $x_{1}=-1/\\sqrt{5}$, $x_{2}=1/\\sqrt{5}$, $x_{3}=1$\n-   LGL Weights for $N=4$: $w_{0}=w_{3}=1/6$, $w_{1}=w_{2}=5/6$\n-   Function to project: $f(x)=P_{6}(x)$, where $P_{n}(x)$ is the Legendre polynomial of degree $n$.\n-   Explicit formulas: $P_{2}(x)=\\tfrac{1}{2}(3x^{2}-1)$ and $P_{6}(x)=\\tfrac{1}{16}(231x^{6}-315x^{4}+105x^{2}-5)$.\n-   Exact continuous $L^{2}$-modal coefficient: $a_{k}=\\frac{\\int_{-1}^{1} f(x)\\,P_{k}(x)\\,dx}{\\int_{-1}^{1} P_{k}(x)^{2}\\,dx}$\n-   Mass-lumped LGL-discrete coefficient: $a_{k}^{\\mathrm{LGL}}=\\frac{\\sum_{i=0}^{N-1} w_{i}\\, f(x_{i})\\,P_{k}(x_{i})}{\\sum_{i=0}^{N-1} w_{i}\\, P_{k}(x_{i})^{2}}$\n-   Target quantity: The aliasing error $E := a_{2}^{\\mathrm{LGL}}-a_{2}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a standard exercise in numerical analysis, specifically concerning spectral methods. The concepts of Legendre polynomials, LGL quadrature, mass-lumping, and aliasing are well-established and fundamental to the field.\n2.  **Well-Posed**: The problem is fully specified. All necessary data (nodes, weights, function definitions, formulas) are provided. The objective is to compute a single, uniquely defined quantity, $E$.\n3.  **Objective**: The problem is stated in precise, technical language with no subjectivity.\n4.  **Completeness and Consistency**: The setup is consistent. For $p=3$, $N=p+1=4$ points are used. The LGL quadrature with $N=4$ nodes is exact for polynomials of degree up to $2N-3=2(4)-3=5$. The function $f(x)=P_6(x)$ has degree $6$, which is greater than $5$, correctly setting up a scenario where the LGL-based quadrature will not be exact and aliasing will occur, as stated in the problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe goal is to compute the aliasing error $E = a_{2}^{\\mathrm{LGL}} - a_{2}$. This will be done by calculating each term, $a_{2}$ and $a_{2}^{\\mathrm{LGL}}$, separately.\n\nFirst, we compute the exact continuous $L^{2}$-modal coefficient, $a_{2}$. The definition is:\n$$a_{k}=\\frac{\\int_{-1}^{1} f(x)\\,P_{k}(x)\\,dx}{\\int_{-1}^{1} P_{k}(x)^{2}\\,dx}$$\nFor $k=2$ and $f(x)=P_{6}(x)$, this becomes:\n$$a_{2}=\\frac{\\int_{-1}^{1} P_{6}(x)\\,P_{2}(x)\\,dx}{\\int_{-1}^{1} P_{2}(x)^{2}\\,dx}$$\nThe Legendre polynomials $\\{P_{n}(x)\\}$ form an orthogonal set on the interval $[-1,1]$. The orthogonality property is given by:\n$$\\int_{-1}^{1} P_{m}(x)P_{n}(x)dx = 0 \\quad \\text{for } m \\neq n$$\nSince the degrees $m=6$ and $n=2$ are not equal, the integral in the numerator is zero:\n$$\\int_{-1}^{1} P_{6}(x)P_{2}(x)dx = 0$$\nTherefore, the exact coefficient $a_{2}$ is:\n$$a_{2} = \\frac{0}{\\int_{-1}^{1} P_{2}(x)^{2}\\,dx} = 0$$\n\nNext, we compute the mass-lumped LGL-discrete coefficient, $a_{2}^{\\mathrm{LGL}}$. The definition is:\n$$a_{2}^{\\mathrm{LGL}}=\\frac{\\sum_{i=0}^{3} w_{i}\\, f(x_{i})\\,P_{2}(x_{i})}{\\sum_{i=0}^{3} w_{i}\\, P_{2}(x_{i})^{2}}$$\nWe must evaluate the numerator and the denominator of this expression using the given LGL nodes and weights for $N=4$.\n\nLet's start with the denominator, $D = \\sum_{i=0}^{3} w_{i}\\, P_{2}(x_{i})^{2}$. We need the values of $P_{2}(x) = \\frac{1}{2}(3x^2 - 1)$ at the LGL nodes $x_{0}=-1$, $x_{1}=-1/\\sqrt{5}$, $x_{2}=1/\\sqrt{5}$, $x_{3}=1$.\n\\begin{itemize}\n    \\item $P_{2}(x_0) = P_{2}(-1) = \\frac{1}{2}(3(-1)^{2}-1) = \\frac{1}{2}(2) = 1$\n    \\item $P_{2}(x_1) = P_{2}(-1/\\sqrt{5}) = \\frac{1}{2}(3(-1/\\sqrt{5})^{2}-1) = \\frac{1}{2}(\\frac{3}{5}-1) = -\\frac{1}{5}$\n    \\item $P_{2}(x_2) = P_{2}(1/\\sqrt{5}) = \\frac{1}{2}(3(1/\\sqrt{5})^{2}-1) = \\frac{1}{2}(\\frac{3}{5}-1) = -\\frac{1}{5}$\n    \\item $P_{2}(x_3) = P_{2}(1) = \\frac{1}{2}(3(1)^{2}-1) = \\frac{1}{2}(2) = 1$\n\\end{itemize}\nThe weights are $w_{0}=w_{3}=1/6$ and $w_{1}=w_{2}=5/6$. The denominator is:\n$$D = w_{0}P_{2}(x_{0})^{2} + w_{1}P_{2}(x_{1})^{2} + w_{2}P_{2}(x_{2})^{2} + w_{3}P_{2}(x_{3})^{2}$$\n$$D = \\frac{1}{6}(1)^{2} + \\frac{5}{6}(-\\frac{1}{5})^{2} + \\frac{5}{6}(-\\frac{1}{5})^{2} + \\frac{1}{6}(1)^{2}$$\n$$D = \\frac{1}{6} + \\frac{5}{6}\\frac{1}{25} + \\frac{5}{6}\\frac{1}{25} + \\frac{1}{6} = \\frac{2}{6} + \\frac{10}{150} = \\frac{1}{3} + \\frac{1}{15} = \\frac{5}{15} + \\frac{1}{15} = \\frac{6}{15} = \\frac{2}{5}$$\nNote that the integrand $P_{2}(x)^{2}$ is a polynomial of degree $4$, and the $N=4$ LGL quadrature is exact for polynomials up to degree $2N-3=5$. Thus, the discrete sum equals the exact integral $\\int_{-1}^{1} P_2(x)^2 dx = \\frac{2}{2(2)+1} = \\frac{2}{5}$, which confirms our calculation.\n\nNow, we evaluate the numerator, $M = \\sum_{i=0}^{3} w_{i}\\, f(x_{i})\\,P_{2}(x_{i})$, with $f(x)=P_{6}(x)$. We need the values of $P_{6}(x) = \\frac{1}{16}(231x^{6}-315x^{4}+105x^{2}-5)$ at the LGL nodes.\n\\begin{itemize}\n    \\item $f(x_{0}) = P_{6}(-1) = (-1)^6 = 1$\n    \\item $f(x_3) = P_{6}(1) = 1$\n    \\item For $x_{1}=-1/\\sqrt{5}$ and $x_{2}=1/\\sqrt{5}$, we have $x^2 = 1/5$, $x^4=1/25$, $x^6=1/125$. Since $P_6(x)$ is an even function, $f(x_1)=f(x_2)$.\n    $$f(\\pm 1/\\sqrt{5}) = P_{6}(\\pm 1/\\sqrt{5}) = \\frac{1}{16}\\left(231\\left(\\frac{1}{125}\\right) - 315\\left(\\frac{1}{25}\\right) + 105\\left(\\frac{1}{5}\\right) - 5\\right)$$\n    $$= \\frac{1}{16}\\left(\\frac{231}{125} - \\frac{1575}{125} + \\frac{2625}{125} - \\frac{625}{125}\\right) = \\frac{1}{16}\\left(\\frac{231 - 1575 + 2625 - 625}{125}\\right)$$\n    $$= \\frac{1}{16}\\left(\\frac{656}{125}\\right) = \\frac{41}{125}$$\n\\end{itemize}\nThe numerator is:\n$$M = w_{0}f(x_{0})P_{2}(x_{0}) + w_{1}f(x_{1})P_{2}(x_{1}) + w_{2}f(x_{2})P_{2}(x_{2}) + w_{3}f(x_{3})P_{2}(x_{3})$$\n$$M = \\frac{1}{6}(1)(1) + \\frac{5}{6}\\left(\\frac{41}{125}\\right)\\left(-\\frac{1}{5}\\right) + \\frac{5}{6}\\left(\\frac{41}{125}\\right)\\left(-\\frac{1}{5}\\right) + \\frac{1}{6}(1)(1)$$\n$$M = \\frac{1}{6} - \\frac{205}{3750} + \\frac{1}{6} - \\frac{205}{3750} = \\frac{2}{6} - 2\\left(\\frac{205}{3750}\\right) = \\frac{1}{3} - \\frac{205}{1875}$$\nLet's simplify the product terms differently to avoid large numbers:\n$$M = \\frac{1}{6} + \\frac{1}{6}(1) - \\frac{5}{6}\\left(\\frac{41}{125}\\frac{1}{5}\\right) - \\frac{5}{6}\\left(\\frac{41}{125}\\frac{1}{5}\\right) = \\frac{2}{6} - 2 \\cdot \\frac{5}{6} \\frac{41}{625} = \\frac{1}{3} - \\frac{5}{3} \\frac{41}{625}$$\n$$M = \\frac{1}{3} - \\frac{1}{3} \\frac{41}{125} = \\frac{1}{3}\\left(1-\\frac{41}{125}\\right) = \\frac{1}{3}\\left(\\frac{125-41}{125}\\right) = \\frac{1}{3}\\left(\\frac{84}{125}\\right) = \\frac{28}{125}$$\nThis non-zero result is a direct consequence of aliasing, as the integral $\\int_{-1}^1 P_6(x)P_2(x) dx$ is zero, but its discrete approximation $\\sum w_i P_6(x_i) P_2(x_i)$ is not.\n\nNow we can compute $a_{2}^{\\mathrm{LGL}}$:\n$$a_{2}^{\\mathrm{LGL}} = \\frac{M}{D} = \\frac{28/125}{2/5} = \\frac{28}{125} \\cdot \\frac{5}{2} = \\frac{14}{25}$$\n\nFinally, we compute the aliasing error $E$:\n$$E = a_{2}^{\\mathrm{LGL}} - a_{2} = \\frac{14}{25} - 0 = \\frac{14}{25}$$\nThis value represents the magnitude of the spurious projection of the unresolved mode $P_6(x)$ onto the resolved mode $P_2(x)$ due to the use of an inexact mass-lumped quadrature rule.", "answer": "$$\\boxed{\\frac{14}{25}}$$", "id": "3406691"}, {"introduction": "The aliasing errors explored previously are particularly detrimental when discretizing nonlinear conservation laws, as they can break the essential Galerkin orthogonality of the scheme. This practice challenges you to derive the minimum number of quadrature points required to integrate a nonlinear flux term exactly, a technique known as overintegration or dealiasing [@problem_id:3406682]. Mastering this analysis is crucial for designing DG methods that retain their optimal convergence properties for a wide range of problems.", "problem": "Consider the one-dimensional scalar conservation law on a periodic domain discretized by a Discontinuous Galerkin (DG) spectral element method with polynomial degree $p$ on each element. On the reference element $[-1,1]$, let the trial function $u_h$ and the test function $v$ belong to the space $\\mathbb{P}_p([-1,1])$ of polynomials of degree at most $p$. Consider the conservative weak-form volume integral of a nonlinear flux $f(u)$ of the form\n$$\n\\int_{-1}^{1} v_x(\\xi)\\, f\\big(u_h(\\xi)\\big)\\, d\\xi,\n$$\nwhere $f(u) = \\frac{u^{m}}{m}$ with an integer $m \\ge 2$, and where subscripts denote differentiation with respect to $\\xi$. Assume that numerical integration is performed using Gauss–Lobatto–Legendre nodes with $N$ quadrature points on $[-1,1]$, and you may use the fact that Gauss–Lobatto–Legendre quadrature with $N$ nodes is exact for polynomials up to degree $2N-3$.\n\nTasks:\n- Starting from the definitions of polynomial degree and differentiation, determine the maximum polynomial degree $K(p,m)$ of the integrand $v_x f(u_h)$ when $u_h \\in \\mathbb{P}_p$ and $v \\in \\mathbb{P}_p$.\n- Using only the stated exactness property of Gauss–Lobatto–Legendre quadrature, derive the minimal integer number of quadrature nodes $N^{\\star}(p,m)$ required so that the above volume integral is integrated exactly by Gauss–Lobatto–Legendre quadrature for all $u_h, v \\in \\mathbb{P}_p$.\n- Briefly justify why, with the common choice $N = p+1$ (collocated Gauss–Lobatto–Legendre nodes used for both interpolation and quadrature), the nonlinear volume term is, in general, underintegrated for $m \\ge 2$, and explain how this loss of exactness breaks Galerkin orthogonality and leads to suboptimal convergence in $h$ unless either overintegration ($N \\ge N^{\\star}(p,m)$) or consistent polynomial projection of $f(u_h)$ to degree $p$ (dealiasing) is employed.\n\nProvide your final answer as a single, closed-form analytic expression for $N^{\\star}(p,m)$ in terms of $p$ and $m$. No numerical approximation is required or permitted for your final answer.", "solution": "The problem statement is evaluated as valid. It is self-contained, mathematically well-posed, scientifically grounded in the principles of numerical analysis for partial differential equations, and free of contradictions or ambiguities. We may therefore proceed with a solution.\n\nThe problem concerns the exactness of numerical quadrature for a nonlinear term arising in the Discontinuous Galerkin (DG) spectral element discretization of a scalar conservation law. We are asked to determine the polynomial degree of the integrand, find the minimum number of quadrature points for exact integration, and discuss the consequences of underintegration.\n\nFirst, we determine the maximum polynomial degree, denoted $K(p,m)$, of the integrand $v_x(\\xi)\\, f\\big(u_h(\\xi)\\big)$.\nThe trial function $u_h$ and the test function $v$ are elements of the space of polynomials of degree at most $p$, denoted $\\mathbb{P}_p$.\nSo, $\\text{deg}(u_h) \\le p$ and $\\text{deg}(v) \\le p$.\n\nThe derivative of the test function, $v_x = \\frac{d v}{d\\xi}$, is a polynomial. By the rules of differentiation, its degree is at most one less than the degree of $v$.\n$$\n\\text{deg}(v_x) \\le \\text{deg}(v) - 1 \\le p-1\n$$\n\nThe nonlinear flux function is given by $f(u) = \\frac{u^{m}}{m}$ for an integer $m \\ge 2$. When applied to the polynomial solution $u_h$, we have $f(u_h) = \\frac{(u_h)^m}{m}$. The degree of a product of polynomials is the sum of their degrees. Therefore, the degree of $(u_h)^m$ is $m$ times the degree of $u_h$.\n$$\n\\text{deg}\\big((u_h)^m\\big) \\le m \\cdot \\text{deg}(u_h) \\le m \\cdot p\n$$\nThe constant scaling factor $1/m$ does not affect the polynomial degree. Thus, $\\text{deg}(f(u_h)) \\le mp$.\n\nThe integrand is the product $v_x f(u_h)$. The degree of this product is the sum of the degrees of its factors. To find the maximum possible degree, we consider the case where the degrees of $v$ and $u_h$ are exactly $p$.\n$$\nK(p,m) = \\max \\text{deg}\\big(v_x f(u_h)\\big) = \\max\\big(\\text{deg}(v_x)\\big) + \\max\\big(\\text{deg}(f(u_h))\\big)\n$$\n$$\nK(p,m) = (p-1) + (m \\cdot p) = mp + p - 1 = (m+1)p - 1\n$$\nThis is the maximum polynomial degree of the integrand.\n\nNext, we derive the minimal number of quadrature nodes, $N^{\\star}(p,m)$, required for the Gauss–Lobatto–Legendre (GLL) quadrature to integrate the volume term exactly.\nThe problem states that GLL quadrature with $N$ nodes is exact for polynomials of degree up to $2N-3$. For the integral to be computed exactly, the degree of exactness of the quadrature rule must be at least the degree of the polynomial being integrated.\nWe must satisfy the condition:\n$$\n2N - 3 \\ge K(p,m)\n$$\nSubstituting the derived expression for $K(p,m)$:\n$$\n2N - 3 \\ge (m+1)p - 1\n$$\nWe solve this inequality for $N$:\n$$\n2N \\ge (m+1)p - 1 + 3\n$$\n$$\n2N \\ge (m+1)p + 2\n$$\n$$\nN \\ge \\frac{(m+1)p + 2}{2}\n$$\nSince the number of quadrature nodes $N$ must be an integer, the minimal required number of nodes, $N^{\\star}(p,m)$, is the smallest integer that satisfies this inequality. This is given by the ceiling of the expression on the right-hand side.\n$$\nN^{\\star}(p,m) = \\left\\lceil \\frac{(m+1)p + 2}{2} \\right\\rceil\n$$\n\nFinally, we justify why the common choice $N = p+1$ leads to underintegration and suboptimal convergence.\nWith the choice $N = p+1$, the GLL quadrature rule is exact for polynomials of degree up to:\n$$\n2(p+1) - 3 = 2p + 2 - 3 = 2p-1\n$$\nUnderintegration occurs if this degree of exactness is less than the actual degree of the integrand, $K(p,m)$. We check the inequality:\n$$\n2p-1  K(p,m)\n$$\n$$\n2p-1  (m+1)p - 1\n$$\n$$\n2p  (m+1)p\n$$\nSince $p$ is a polynomial degree, we can assume $p \\ge 1$. Dividing by $p$ yields:\n$$\n2  m+1 \\quad \\implies \\quad m  1\n$$\nThe problem states that $m$ is an integer and $m \\ge 2$, so this condition is always fulfilled. Therefore, for any $m \\ge 2$ and $p \\ge 1$, the choice $N=p+1$ results in a quadrature rule that cannot exactly integrate the nonlinear volume term. This inexactness is referred to as aliasing, as it causes high-frequency components of $f(u_h)$ to be misrepresented as lower-frequency components, contaminating the solution.\n\nThis loss of exactness breaks a fundamental property of the Galerkin method: the orthogonality of the residual to the test function space. In an exact Galerkin formulation, the error between the true solution and the numerical solution is orthogonal to the space of test functions $\\mathbb{P}_p$. This orthogonality is the cornerstone of proofs for optimal convergence rates (typically $\\mathcal{O}(h^{p+1})$ in the $L^2$-norm for smooth solutions, where $h$ is the element size). The quadrature error introduced by aliasing acts as a perturbation that corrupts this orthogonality, leading to a demonstrable reduction in the order of accuracy. This results in suboptimal convergence, where the observed rate is often reduced, for example to $\\mathcal{O}(h^p)$.\n\nTo restore optimal convergence, one must address this aliasing error. Two common strategies are:\n1.  **Overintegration (or 'dealiasing by quadrature'):** Use a sufficient number of quadrature points to ensure exact integration. This means choosing $N \\ge N^{\\star}(p,m)$. This method is straightforward but increases computational cost, as the expensive nonlinear flux function $f(u)$ must be evaluated at more points per element.\n2.  **Consistent Projection (or 'dealiasing by projection'):** Instead of integrating $v_x f(u_h)$ directly, one first computes a projection of the nonlinear term $f(u_h)$ onto the polynomial space $\\mathbb{P}_p$. Let this projection be $\\tilde{f}_p = \\mathcal{P}_p(f(u_h))$. The new integrand is $v_x \\tilde{f}_p$. The degree of this polynomial is at most $\\text{deg}(v_x) + \\text{deg}(\\tilde{f}_p) \\le (p-1) + p = 2p-1$. An integral of a polynomial of degree $2p-1$ can be computed exactly using GLL quadrature with $N=p+1$ points. This approach maintains the structure of the Galerkin method and restores orthogonality and optimal convergence rates, but it requires the additional computational step of performing the projection.", "answer": "$$\n\\boxed{\\left\\lceil \\frac{(m+1)p + 2}{2} \\right\\rceil}\n$$", "id": "3406682"}, {"introduction": "Optimal convergence is not only threatened by aliasing but is also fundamentally dependent on the stability of the numerical scheme. For discontinuous Galerkin methods like the Symmetric Interior Penalty Galerkin (SIPG) method, stability hinges on the careful selection of penalty parameters, which must be large enough to control jumps across element interfaces [@problem_id:3406665]. This exercise demonstrates how an insufficient penalty can lead to a loss of stability and asks you to determine the precise parameter scaling required to guarantee a robust method, thereby securing the foundation for optimal error estimates.", "problem": "Consider the one-dimensional, constant-coefficient diffusion model problem on the open interval $(0,1)$ with homogeneous Dirichlet boundary conditions. Let $\\mathcal{T}_h$ be a mesh consisting of two elements $K_1 = (0,h)$ and $K_2 = (h,1)$ with $0  h  \\tfrac{1}{2}$, and let $V_h$ denote the space of discontinuous, element-wise polynomials of fixed degree at most $p \\in \\mathbb{N}$ on $\\mathcal{T}_h$. Impose the boundary conditions strongly on $V_h$ by requiring $v_h(0) = v_h(1) = 0$ for all $v_h \\in V_h$.\n\nDefine the Symmetric Interior Penalty Galerkin (SIPG) bilinear form for the diffusion operator $-\\frac{d^2}{dx^2}$ by\n$$\na_h(u_h, v_h)\n=\n\\sum_{K \\in \\mathcal{T}_h} \\int_{K} u_h'(x) v_h'(x)\\,dx\n\\;-\\;\n\\big\\{ u_h' \\big\\} \\big[ v_h \\big]\\Big|_{x=h}\n\\;-\\;\n\\big\\{ v_h' \\big\\} \\big[ u_h \\big]\\Big|_{x=h}\n\\;+\\;\n\\sigma \\, \\big[ u_h \\big] \\big[ v_h \\big]\\Big|_{x=h},\n$$\nwhere for the interior interface at $x=h$, the jump and average are defined by $\\big[ v_h \\big] := v_h(h^-) - v_h(h^+)$ and $\\big\\{ v_h' \\big\\} := \\tfrac{1}{2} \\big(v_h'(h^-) + v_h'(h^+)\\big)$, respectively. The penalty parameter is chosen as\n$$\n\\sigma = C\\,\\frac{p^{m}}{h},\n$$\nwith $C0$ independent of $h$ and $p$, and $m \\in \\mathbb{R}$ to be determined. Let the discrete energy norm be\n$$\n\\| v_h \\|_{E}^2 := \\sum_{K \\in \\mathcal{T}_h} \\int_{K} \\big| v_h'(x) \\big|^2 \\, dx \\;+\\; \\sigma \\, \\big| \\big[ v_h \\big] \\big|^2\\Big|_{x=h}.\n$$\n\nYou may use the following well-tested inverse and trace inequalities for polynomials of degree at most $p$ on an interval $K$ of length $|K| = h_K$, with constants independent of $h_K$ and $p$:\n- For all $w_h \\in \\mathbb{P}_p(K)$, $\\displaystyle |w_h(x_K)|^2 \\le C_{\\mathrm{tr}}\\,\\frac{p^2}{h_K}\\,\\| w_h \\|_{L^2(K)}^2$ for either endpoint $x_K$ of $K$.\n- For all $w_h \\in \\mathbb{P}_p(K)$, $\\displaystyle \\| w_h' \\|_{L^2(K)} \\le C_{\\mathrm{inv}}\\,\\frac{p^2}{h_K}\\, \\| w_h \\|_{L^2(K)}$.\n\nDefine the discrete Gårding inequality as the existence of a constant $c0$, independent of $h$ and $p$, such that\n$$\na_h(v_h, v_h) \\;\\ge\\; c\\, \\| v_h \\|_{E}^2 \\quad \\text{for all } v_h \\in V_h.\n$$\n\nConstruct a counterexample mesh and penalty choice that violates the discrete Gårding inequality in the sense that there exist sequences $h \\to 0$, $p \\to \\infty$, and $v_h \\in V_h$ for which $a_h(v_h, v_h)  0$. Then, by a sharp energy estimate based on the provided inverse and trace inequalities, determine the smallest real number $m$ for which one can guarantee the discrete Gårding inequality holds uniformly with respect to $h$ and $p$. Provide your final answer as this minimal value $m$. The final answer should be a single real number with no units.", "solution": "The problem asks for two main results: first, to construct a counterexample that violates the discrete Gårding inequality for a specific choice of mesh and penalty parameter; and second, to determine the smallest real number $m$ in the definition of the penalty parameter $\\sigma = C\\,p^m/h$ that guarantees the Gårding inequality holds uniformly in $h$ and $p$.\n\nThe discrete Gårding inequality is given by:\n$$ a_h(v_h, v_h) \\ge c\\, \\| v_h \\|_{E}^2 \\quad \\text{for all } v_h \\in V_h, $$\nwhere $c0$ is a constant independent of the mesh size $h$ and the polynomial degree $p$.\nThe bilinear form $a_h(v_h, v_h)$ and the energy norm $\\|v_h\\|_E^2$ are defined as:\n$$ a_h(v_h, v_h) = \\sum_{K \\in \\mathcal{T}_h} \\int_{K} |v_h'(x)|^2 \\,dx - 2 \\big\\{ v_h' \\big\\} \\big[ v_h \\big]\\Big|_{x=h} + \\sigma \\, \\big| \\big[ v_h \\big] \\big|^2\\Big|_{x=h} $$\n$$ \\| v_h \\|_{E}^2 = \\sum_{K \\in \\mathcal{T}_h} \\int_{K} \\big| v_h'(x) \\big|^2 \\, dx \\;+\\; \\sigma \\, \\big| \\big[ v_h \\big] \\big|^2\\Big|_{x=h} $$\nCombining these, the Gårding inequality is equivalent to finding $c \\in (0,1)$ such that:\n$$ (1-c) \\sum_{K \\in \\mathcal{T}_h} \\int_{K} |v_h'(x)|^2 \\,dx - 2 \\big\\{ v_h' \\big\\} \\big[ v_h \\big]\\Big|_{x=h} + (1-c) \\sigma \\, \\big| \\big[ v_h \\big] \\big|^2\\Big|_{x=h} \\ge 0 $$\n\nLet's begin by constructing a counterexample. We consider a function $v_h \\in V_h$ that is non-zero only on the smaller element $K_1 = (0,h)$, i.e., $v_h(x) = 0$ for $x \\in K_2 = (h,1)$. The boundary condition $v_h(1)=0$ is thus trivially satisfied. On $K_1$, let's denote the polynomial by $v_1(x)$. The boundary condition $v_h(0)=0$ implies $v_1(0)=0$. For this choice of $v_h$, the quantities at the interface $x=h$ are:\n- Jump of $v_h$: $\\big[v_h\\big]\\big|_{x=h} = v_h(h^-) - v_h(h^+) = v_1(h) - 0 = v_1(h)$.\n- Average of $v_h'$: $\\big\\{v_h'\\big\\}\\big|_{x=h} = \\frac{1}{2}(v_h'(h^-) + v_h'(h^+)) = \\frac{1}{2}(v_1'(h) + 0) = \\frac{1}{2}v_1'(h)$.\n\nThe bilinear form $a_h(v_h, v_h)$ becomes:\n$$ a_h(v_h, v_h) = \\int_0^h |v_1'(x)|^2 dx - 2 \\left(\\frac{1}{2}v_1'(h)\\right) (v_1(h)) + \\sigma |v_1(h)|^2 = \\|v_1'\\|_{L^2(K_1)}^2 - v_1'(h)v_1(h) + \\sigma|v_1(h)|^2 $$\nTo violate the inequality (i.e., to make $a_h(v_h, v_h)  0$), we need the negative term $-v_1'(h)v_1(h)$ to be dominant and negative, which means we require $v_1'(h)v_1(h)$ to be positive and large.\n\nLet's choose a specific polynomial $v_1(x)$ on $(0,h)$ of degree $p$ that satisfies $v_1(0)=0$. A simple choice is $v_1(x) = (x/h)^p$.\n- $v_1(h) = (h/h)^p = 1$.\n- $v_1'(x) = \\frac{p}{h}(\\frac{x}{h})^{p-1}$, so $v_1'(h) = \\frac{p}{h}$.\nThe product $v_1'(h)v_1(h) = p/h$ is positive.\nNow we compute the integral term:\n$$ \\|v_1'\\|_{L^2(K_1)}^2 = \\int_0^h \\left| \\frac{p}{h} \\left(\\frac{x}{h}\\right)^{p-1} \\right|^2 dx = \\frac{p^2}{h^2} \\int_0^h \\left(\\frac{x}{h}\\right)^{2p-2} dx $$\nLet $z=x/h$, so $dx = h\\,dz$.\n$$ \\|v_1'\\|_{L^2(K_1)}^2 = \\frac{p^2}{h^2} \\int_0^1 z^{2p-2} h\\,dz = \\frac{p^2}{h} \\left[ \\frac{z^{2p-1}}{2p-1} \\right]_0^1 = \\frac{p^2}{h(2p-1)} $$\nSubstituting these into the expression for $a_h(v_h, v_h)$:\n$$ a_h(v_h, v_h) = \\frac{p^2}{h(2p-1)} - \\frac{p}{h} + \\sigma (1)^2 = \\frac{p^2 - p(2p-1)}{h(2p-1)} + \\sigma = \\frac{-p^2+p}{h(2p-1)} + \\sigma $$\nAs $p \\to \\infty$, the first term behaves as $\\frac{-p^2}{2ph} = -p/(2h)$. So, $a_h(v_h, v_h) \\approx -p/(2h) + \\sigma$.\nWith $\\sigma = C p^m/h$, we have $a_h(v_h, v_h) \\approx \\frac{1}{h}(-p/2 + C p^m)$.\nIf we choose any $m  1$, for a fixed $C0$ and $h$, the term $-p/2$ will dominate $C p^m$ for sufficiently large $p$. For instance, if $m=0$, $\\sigma = C/h$, and $a_h(v_h,v_h) \\to -\\infty$ as $p_k \\to \\infty$. This constructs a counterexample sequence for any $m1$. This demonstrates that we must have $m \\ge 1$. However, this particular polynomial choice may not represent the worst-case scenario.\n\nNow, we determine the minimal $m \\in \\mathbb{R}$ to guarantee the Gårding inequality. The critical term is $-2\\{v_h'\\}[v_h]$. We bound its absolute value using Young's inequality: $|-2\\{v_h'\\}[v_h]| \\le \\epsilon|\\{v_h'\\}|^2 + \\frac{1}{\\epsilon}|[v_h]|^2$ for any $\\epsilon  0$.\nThis gives a lower bound on the bilinear form:\n$$ a_h(v_h, v_h) \\ge \\sum_K \\|v_h'\\|_K^2 - \\epsilon|\\{v_h'\\}|^2 - \\frac{1}{\\epsilon}|[v_h]|^2 + \\sigma|[v_h]|^2 $$\nWe need to relate $|\\{v_h'\\}|^2$ to the semi-norm $\\sum_K \\|v_h'\\|_K^2$. The average is $|\\{v_h'\\}|^2 = \\frac{1}{4}|v_h'(h^-)+v_h'(h^+)|^2 \\le \\frac{1}{2}(|v_h'(h^-)|^2 + |v_h'(h^+)|^2)$.\nWe now apply the provided trace inequality to the derivative $v_h'$. On an element $K$, $v_h'$ is a polynomial of degree at most $p-1$. The inequality states that for a polynomial $w_h$ of degree at most $p$, $|w_h(x_K)|^2 \\le C_{\\mathrm{tr}}\\,\\frac{p^2}{h_K}\\,\\| w_h \\|_{L^2(K)}^2$. Applying this to $v_h'$ (a polynomial of degree $\\le p-1  p$) on each element adjacent to the interface:\n$$ |v_h'(h^-)|^2 \\le C_{\\mathrm{tr}} \\frac{(p-1)^2}{h_1} \\| v_h' \\|_{L^2(K_1)}^2 \\le C_{\\mathrm{tr}} \\frac{p^2}{h} \\| v_h' \\|_{L^2(K_1)}^2 \\quad (\\text{since } h_1=h) $$\n$$ |v_h'(h^+)|^2 \\le C_{\\mathrm{tr}} \\frac{(p-1)^2}{h_2} \\| v_h' \\|_{L^2(K_2)}^2 \\le C_{\\mathrm{tr}} \\frac{p^2}{1-h} \\| v_h' \\|_{L^2(K_2)}^2 \\quad (\\text{since } h_2=1-h) $$\nSince $h  1/2$, we have $h  1-h$, so $1/h  1/(1-h)$. The worst scaling is with respect to the smallest element size, $h_{\\min}=h$.\n$$ |\\{v_h'\\}|^2 \\le \\frac{1}{2} C_{\\mathrm{tr}} p^2 \\left( \\frac{1}{h}\\| v_h' \\|_{L^2(K_1)}^2 + \\frac{1}{1-h}\\| v_h' \\|_{L^2(K_2)}^2 \\right) \\le \\frac{C_{\\mathrm{tr}} p^2}{2h} \\sum_{K \\in \\mathcal{T}_h} \\|v_h'\\|_K^2 $$\nLet's call the constant $C_1 = C_{\\mathrm{tr}}/2$. Then we have:\n$$ a_h(v_h, v_h) \\ge \\sum_K \\|v_h'\\|_K^2 - \\epsilon \\frac{C_1 p^2}{h} \\sum_K \\|v_h'\\|_K^2 + (\\sigma - \\frac{1}{\\epsilon})|[v_h]|^2 $$\n$$ a_h(v_h, v_h) \\ge \\left(1 - \\frac{\\epsilon C_1 p^2}{h}\\right)\\sum_K \\|v_h'\\|_K^2 + \\left(\\sigma - \\frac{1}{\\epsilon}\\right)|[v_h]|^2 $$\nFor the Gårding inequality to hold, we need the coefficients of both terms to be positive. Let's aim for them to be a positive fraction of the original terms in the energy norm. We need:\n1. $1 - \\frac{\\epsilon C_1 p^2}{h}  0 \\implies \\epsilon  \\frac{h}{C_1 p^2}$\n2. $\\sigma - \\frac{1}{\\epsilon} \\ge c_0 \\sigma$ for some $c_0 \\in (0,1)$, which implies $(1-c_0)\\sigma \\ge \\frac{1}{\\epsilon}$, or $\\epsilon \\ge \\frac{1}{(1-c_0)\\sigma}$.\n\nCombining these two conditions on $\\epsilon$:\n$$ \\frac{1}{(1-c_0)\\sigma} \\le \\epsilon  \\frac{h}{C_1 p^2} $$\nFor such an $\\epsilon$ to exist, we must have:\n$$ \\frac{1}{(1-c_0)\\sigma}  \\frac{h}{C_1 p^2} \\implies \\sigma  \\frac{C_1 p^2}{(1-c_0)h} $$\nLet $C_2 = C_1 / (1-c_0)$. We need $\\sigma  C_2 \\frac{p^2}{h}$.\nGiven the definition $\\sigma = C \\frac{p^m}{h}$, this requires:\n$$ C \\frac{p^m}{h}  C_2 \\frac{p^2}{h} \\implies C p^m  C_2 p^2 $$\nFor this inequality to hold for all $p$ with a fixed constant $C$, we must have $m \\ge 2$. If we choose $m=2$, we can satisfy the condition by choosing $C  C_2$. If $m  2$, the inequality fails for sufficiently large $p$. Thus, $m=2$ is a sufficient condition.\n\nTo establish that $m=2$ is the minimal value (i.e., necessary), we must confirm that the trace inequality for the derivative is sharp. The condition derived above, $\\sigma \\gtrsim p^2/h$, came from the need to control the term $|\\{v_h'\\}|^2$. The Gårding inequality essentially requires that $\\sigma$ be large enough to absorb terms arising from bounding $\\{v_h'\\}$. The critical part is to establish sharpness of the inequality used:\n$$ \\sup_{v_h \\in V_h, v_h \\ne 0} \\frac{|\\{v_h'\\}|^2}{\\sum_K \\|v_h'\\|_K^2} \\sim \\frac{p^2}{h} $$\nThis is equivalent to finding the supremum of $\\frac{|w(h)|^2}{\\|w\\|_{L^2(0,h)}^2}$ for polynomials $w \\in \\mathbb{P}_{p-1}$. This is a standard result in approximation theory that this supremum scales as $\\frac{(p-1)^2}{h}$ which is $\\sim p^2/h$. A polynomial that achieves this sharp scaling can be constructed from the reproducing kernel for the point evaluation functional. The fact that this ratio is indeed sharp implies that our requirement $\\sigma \\gtrsim p^2/h$ is not an artifact of the proof but a genuine requirement. Therefore, the minimal value for $m$ must be $2$.\n\nTo conclude, while a simple counterexample showed $m \\ge 1$, a more rigorous analysis based on the sharp trace inequality for derivatives demonstrates that one must have $\\sigma \\sim p^2/h$ to ensure stability, making the minimal value for $m$ equal to $2$.", "answer": "$$\\boxed{2}$$", "id": "3406665"}]}