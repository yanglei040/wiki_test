{"hands_on_practices": [{"introduction": "To design methods that prevent spurious oscillations, we must first have a rigorous way to quantify them, which is precisely the role of a function's Total Variation (TV). This first exercise [@problem_id:3424304] solidifies this fundamental concept by guiding you through the computation of the TV for a simple step function. You will calculate it both from its continuous mathematical definition and using the discrete cell-average approximation that forms the basis of many numerical methods.", "problem": "In the context of Total Variation Diminishing (TVD) frameworks for high-order Spectral Element and Discontinuous Galerkin (DG) methods, consider the initial data given by the indicator function $u(x)=\\mathbf{1}_{[0.3,1]}(x)$ on the interval $[0,1]$. Use the fundamental definition of total variation on a closed interval, namely that for $u\\in L^{1}([0,1])$ the total variation $TV(u)$ is the supremum over all finite partitions $\\mathcal{P}=\\{0=x_{0}x_{1}\\dotsx_{n}=1\\}$ of the sums $\\sum_{i=1}^{n}\\left|u(x_{i})-u(x_{i-1})\\right|$. \n\nPart 1. Compute the exact total variation $TV(u)$ on $[0,1]$ from this definition, without invoking any pre-packaged formulas beyond the definition and standard properties of monotone or piecewise constant functions.\n\nPart 2. Consider a uniform mesh of $[0,1]$ with $N\\ge 2$ cells of width $h=1/N$, with cell intervals $I_{i}=[(i-1)h,ih]$, and define the cell averages $\\bar{u}_{i}=\\frac{1}{h}\\int_{I_{i}}u(x)\\,dx$. Using the standard discrete total variation built from cell averages,\n$$\nTV_{h}(u)=\\sum_{i=1}^{N-1}\\left|\\bar{u}_{i+1}-\\bar{u}_{i}\\right|,\n$$\ncompute $TV_{h}(u)$ exactly as a function of the relative position of the discontinuity at $x=0.3$ with respect to the mesh. Then determine the limit of $TV_{h}(u)$ as $N\\to\\infty$.\n\nReport, as your final answer, the single common value that $TV(u)$ and $\\lim_{N\\to\\infty}TV_{h}(u)$ both attain. No rounding is required, and no physical units are involved. Express the final answer as a single exact real number.", "solution": "The problem requires the computation of the total variation of a given function, both in the continuous sense from its fundamental definition and in a discrete sense based on cell averages, and then to find the limit of the discrete total variation.\n\nThe function under consideration is the indicator function $u(x)=\\mathbf{1}_{[0.3,1]}(x)$ on the interval $[0,1]$. This function is defined as:\n$$\nu(x) = \\begin{cases} 0  \\text{for } x \\in [0, 0.3) \\\\ 1  \\text{for } x \\in [0.3, 1] \\end{cases}\n$$\nThis is a piecewise constant function with a single jump discontinuity at $x=0.3$. The magnitude of the jump is $|1-0|=1$.\n\n**Part 1: Computation of the Continuous Total Variation $TV(u)$**\n\nThe total variation of a function $u \\in L^{1}([0,1])$ is defined as the supremum of the sums of absolute differences over all finite partitions of the interval:\n$$\nTV(u) = \\sup_{\\mathcal{P}} \\sum_{i=1}^{n}\\left|u(x_{i})-u(x_{i-1})\\right|\n$$\nwhere $\\mathcal{P}=\\{0=x_{0}x_{1}\\dotsx_{n}=1\\}$ is an arbitrary finite partition of $[0,1]$.\n\nLet's analyze the sum $S(\\mathcal{P}) = \\sum_{i=1}^{n}\\left|u(x_{i})-u(x_{i-1})\\right|$ for an arbitrary partition $\\mathcal{P}$. The function $u(x)$ is constant on the subintervals $[0, 0.3)$ and $[0.3, 1]$.\nLet us consider any partition $\\mathcal{P}=\\{x_{0}, x_{1}, \\dots, x_{n}\\}$. There must be some subinterval $[x_{k-1}, x_k]$ that contains the point of discontinuity $0.3$.\n\nLet's consider two cases for the partition $\\mathcal{P}$.\n\nCase 1: The point $0.3$ is one of the partition points, say $x_k = 0.3$ for some $k \\in \\{1, \\dots, n-1\\}$.\nFor any $i  k$, the interval $[x_{i-1}, x_i]$ is entirely within $[0, 0.3)$, so $u(x_{i-1}) = u(x_i) = 0$. Thus, $|u(x_i) - u(x_{i-1})| = 0$.\nFor any $i  k$, the interval $[x_{i-1}, x_i]$ is entirely within $[0.3, 1]$, so $u(x_{i-1}) = u(x_i) = 1$. Thus, $|u(x_i) - u(x_{i-1})| = 0$.\nThe only non-zero term in the sum can arise from the interval(s) adjacent to $x_k = 0.3$. In this case, the terms are $|u(x_k)-u(x_{k-1})|$ and $|u(x_{k+1})-u(x_k)|$.\nSince $x_{k-1}  x_k = 0.3$, we have $u(x_{k-1})=0$ and $u(x_k)=1$.\nSince $x_{k+1}  x_k = 0.3$, we have $u(x_{k+1})=1$ and $u(x_k)=1$.\nThe sum becomes:\n$$\nS(\\mathcal{P}) = \\left(\\sum_{i=1}^{k-1} 0\\right) + |u(x_k) - u(x_{k-1})| + \\left(\\sum_{i=k+1}^{n} |u(x_i) - u(x_{i-1})|\\right) = |1 - 0| + |1-1| + \\dots = 1\n$$\nActually, let's be more precise with summation split:\n$$\nS(\\mathcal{P}) = \\sum_{i=1}^{k} |u(x_i) - u(x_{i-1})| + \\sum_{i=k+1}^{n} |u(x_i) - u(x_{i-1})| = |u(x_k)-u(x_{k-1})| + 0 = |1-0| = 1\n$$\nSo if the partition includes $0.3$, the sum is exactly $1$.\n\nCase 2: The point $0.3$ is not a partition point. Then it must lie in the interior of some subinterval, say $x_{k-1}  0.3  x_k$.\nFor any $i  k$, the interval $[x_{i-1}, x_i]$ is in $[0, 0.3)$, where $u(x)=0$. So $|u(x_i) - u(x_{i-1})|=0$.\nFor any $i  k$, the interval $[x_{i-1}, x_i]$ is in $(0.3, 1]$, where $u(x)=1$. So $|u(x_i) - u(x_{i-1})|=0$.\nThe only non-zero term is for $i=k$:\n$$\n|u(x_k) - u(x_{k-1})|\n$$\nSince $x_{k-1}  0.3$, we have $u(x_{k-1})=0$. Since $x_k  0.3$, we have $u(x_k)=1$.\nThe term is $|1 - 0| = 1$.\nThus, $S(\\mathcal{P}) = 1$.\n\nIn every possible case, the sum $S(\\mathcal{P})$ is either $0$ (if the partition manages to have all its points on one side of $0.3$, which is impossible for a partition of $[0,1]$), or $1$. More formally, using the triangle inequality:\n$S(\\mathcal{P}) = \\sum_{i=1}^{n} |u(x_i)-u(x_{i-1})| = |u(x_1)-u(x_0)| + \\dots + |u(x_n)-u(x_{n-1})| \\ge |(u(x_1)-u(x_0)) + \\dots + (u(x_n)-u(x_{n-1}))| = |u(x_n)-u(x_0)| = |u(1)-u(0)| = |1-0|=1$. This inequality is not generally true. A better argument is that $TV(u) = TV_{[0,0.3]}(u) + TV_{[0.3,1]}(u)+|u(0.3^+)-u(0.3^-)|$. Within the intervals of continuity, $u$ is constant, so its TV is 0. The jump term is $|1-0|=1$. But the problem asks us to use the sum definition.\n\nFrom the analysis of Case 1 and 2, any partition $\\mathcal{P}$ of $[0,1]$ that \"sees\" the discontinuity will yield a sum of $1$. For any partition $\\mathcal{P}$, we can form a refined partition $\\mathcal{P}' = \\mathcal{P} \\cup \\{0.3\\}$. It is a standard property that $S(\\mathcal{P}') \\ge S(\\mathcal{P})$. As shown in Case 1, $S(\\mathcal{P}')=1$. Therefore, for any partition $\\mathcal{P}$, $S(\\mathcal{P}) \\le 1$.\nSince we can find a partition for which the sum is $1$ (e.g., $\\mathcal{P}=\\{0, 0.5, 1\\}$), the supremum must be at least $1$.\nCombining these, $\\sup_{\\mathcal{P}} S(\\mathcal{P}) = 1$.\n$$\nTV(u) = 1\n$$\n\n**Part 2: Computation of the Discrete Total Variation $TV_h(u)$ and its Limit**\n\nWe are given a uniform mesh of $[0,1]$ with $N \\ge 2$ cells $I_i = [(i-1)h, ih]$ where $h=1/N$. The cell averages are $\\bar{u}_i = \\frac{1}{h}\\int_{I_i} u(x) \\, dx$. The discrete total variation is $TV_h(u) = \\sum_{i=1}^{N-1} |\\bar{u}_{i+1} - \\bar{u}_i|$.\n\nThe calculation of the cell averages $\\bar{u}_i$ depends on the position of the discontinuity at $x=0.3$ relative to the cell boundaries $ih$. Let $j_0 = \\lfloor 0.3N \\rfloor$ and let $\\theta = 0.3N - j_0$ be the fractional part, so $\\theta \\in [0, 1)$. The position of the discontinuity is $x=0.3 = (j_0+\\theta)/N = (j_0+\\theta)h$.\n\nCase A: The discontinuity falls on a cell boundary.\nThis occurs if $0.3N$ is an integer, which means $\\theta=0$. So $0.3 = j_0h$. This is possible if $N$ is a multiple of $10$.\nIn this case, the boundary is between cell $I_{j_0}$ and $I_{j_0+1}$.\nFor any cell $I_i$ with $i \\le j_0$, the interval is $[(i-1)h, ih] \\subseteq [0, j_0h] = [0, 0.3]$. On this interval, $u(x)=0$ (except possibly at $x=0.3$, which does not affect the integral). So, $\\bar{u}_i = 0$ for $i \\le j_0$.\nFor any cell $I_i$ with $i  j_0$, the interval is $[(i-1)h, ih] \\subseteq [j_0h, 1] = [0.3, 1]$. On this interval, $u(x)=1$. So, $\\bar{u}_i = 1$ for $i  j_0$.\nThe sequence of cell averages is $\\{0, \\dots, 0, 1, \\dots, 1\\}$, with the change occurring between $\\bar{u}_{j_0}=0$ and $\\bar{u}_{j_0+1}=1$.\nThe discrete total variation is:\n$$\nTV_h(u) = \\sum_{i=1}^{N-1} |\\bar{u}_{i+1} - \\bar{u}_i| = \\sum_{i=1}^{j_0-1} |0-0| + |\\bar{u}_{j_0+1} - \\bar{u}_{j_0}| + \\sum_{i=j_0+1}^{N-1} |1-1| = |1-0| = 1\n$$\n\nCase B: The discontinuity falls in the interior of a cell.\nThis occurs if $0.3N$ is not an integer, so $\\theta \\in (0,1)$. The discontinuity at $x=0.3=(j_0+\\theta)h$ lies in the interior of cell $I_{j_0+1} = [j_0h, (j_0+1)h]$.\nLet's compute the cell averages:\nFor $i \\le j_0$, $I_i$ is entirely to the left of $0.3$. Thus, $\\bar{u}_i = 0$.\nFor $i  j_0+1$, $I_i$ is entirely to the right of $0.3$. Thus, $\\bar{u}_i = 1$.\nFor the cell $i=j_0+1$, the integral is split:\n$$\n\\bar{u}_{j_0+1} = \\frac{1}{h} \\int_{j_0h}^{(j_0+1)h} u(x) \\, dx = \\frac{1}{h} \\left( \\int_{j_0h}^{0.3} 0 \\, dx + \\int_{0.3}^{(j_0+1)h} 1 \\, dx \\right)\n$$\n$$\n\\bar{u}_{j_0+1} = \\frac{1}{h} \\left( ((j_0+1)h) - 0.3 \\right) = j_0+1 - \\frac{0.3}{h} = j_0+1 - 0.3N\n$$\nSubstituting $0.3N = j_0+\\theta$, we get:\n$$\n\\bar{u}_{j_0+1} = j_0+1 - (j_0+\\theta) = 1-\\theta\n$$\nSince $\\theta \\in (0,1)$, we have $0  \\bar{u}_{j_0+1}  1$.\nThe sequence of cell averages is $\\{0, \\dots, 0, \\bar{u}_{j_0+1}, 1, \\dots, 1\\}$.\nThe only non-zero terms in the sum for $TV_h(u)$ are at the transitions:\n$$\nTV_h(u) = |\\bar{u}_{j_0+1} - \\bar{u}_{j_0}| + |\\bar{u}_{j_0+2} - \\bar{u}_{j_0+1}| = |(1-\\theta) - 0| + |1 - (1-\\theta)|\n$$\nSince $\\theta \\in (0,1)$, both $1-\\theta$ and $\\theta$ are positive.\n$$\nTV_h(u) = (1-\\theta) + \\theta = 1\n$$\n\nIn both cases, regardless of the position of the discontinuity relative to the mesh, the discrete total variation is exactly $1$. Therefore, $TV_h(u)=1$ for all integers $N \\ge 2$.\n\nFinally, we compute the limit as $N \\to \\infty$:\n$$\n\\lim_{N \\to \\infty} TV_h(u) = \\lim_{N \\to \\infty} 1 = 1\n$$\n\nBoth the continuous total variation $TV(u)$ and the limit of the discrete total variation $\\lim_{N\\to\\infty} TV_h(u)$ are equal to $1$. This is expected, as the discrete total variation of cell averages for a function of bounded variation converges to the continuous total variation as the mesh size goes to zero.\n\nThe single common value is $1$.", "answer": "$$\\boxed{1}$$", "id": "3424304"}, {"introduction": "Knowing how to measure total variation is the first step; the next is to ensure our numerical schemes do not allow it to increase, which is achieved through carefully constructed limiters that obey specific constraints. This problem [@problem_id:3424316] provides insight through a powerful counter-example, asking you to use a limiter that intentionally violates the classical Total Variation Diminishing (TVD) conditions. By working through the update, you will observe firsthand how breaking these rules can lead to an undesirable increase in total variation, underscoring the necessity of the TVD constraints.", "problem": "Consider the scalar linear advection equation $u_{t} + a\\,u_{x} = 0$ on a uniform mesh with cell averages $U_{j}^{n}$ at time level $t^{n}$ and grid spacing $\\Delta x$. Use a piecewise-linear, slope-limited reconstruction on each cell $I_{j}$ with slope $s_{j}$ so that the cell-interface traces are\n$$\nU_{j+\\frac{1}{2}}^{-} \\equiv U_{j}^{n} + \\frac{1}{2}s_{j}, \\qquad U_{j+\\frac{1}{2}}^{+} \\equiv U_{j+1}^{n} - \\frac{1}{2}s_{j+1}.\n$$\nFor left-going advection ($a0$), use the standard upwind numerical flux $F_{j+\\frac{1}{2}} = a\\,U_{j+\\frac{1}{2}}^{+}$ and the explicit conservative update for cell averages\n$$\nU_{j}^{n+1} \\;=\\; U_{j}^{n} \\;-\\; \\nu \\left(U_{j+\\frac{1}{2}}^{+} - U_{j-\\frac{1}{2}}^{+}\\right), \\qquad \\nu \\equiv \\frac{|a|\\,\\Delta t}{\\Delta x}.\n$$\nAdopt the canonical flux-limiter form for the slope,\n$$\ns_{j} \\;=\\; \\phi(r_{j})\\left(U_{j}^{n}-U_{j-1}^{n}\\right),\n$$\nwhere for $a0$ you define the ratio\n$$\nr_{j} \\;=\\; \\frac{U_{j+1}^{n}-U_{j}^{n}}{U_{j}^{n}-U_{j-1}^{n}}.\n$$\nLet the initial cell averages be\n$$\nU_{-2}^{0}=10,\\quad U_{-1}^{0}=10,\\quad U_{0}^{0}=2,\\quad U_{1}^{0}=0,\\quad U_{2}^{0}=0,\n$$\nso that at $j=0$ one has $r_{0}=\\frac{U_{1}^{0}-U_{0}^{0}}{U_{0}^{0}-U_{-1}^{0}}=\\frac{-2}{-8}=0.25$. Construct a limiter $\\phi$ that satisfies $\\phi(0.25)=1.5$, and, for the purposes of this three-cell update, take $\\phi(r)=0$ at all ratio values that occur outside $r=0.25$ in the described configuration. Take $a=-1$ and $\\nu=\\frac{1}{2}$.\n\n1) Starting from the definitions above, perform one explicit update for the three cells $j=-1,0,1$. Compute $U_{-1}^{1}$, $U_{0}^{1}$, and $U_{1}^{1}$.\n\n2) Using the definition of total variation over the three-cell set,\n$$\n\\mathrm{TV}^{n} \\;=\\; \\left|U_{0}^{n}-U_{-1}^{n}\\right| \\;+\\; \\left|U_{1}^{n}-U_{0}^{n}\\right|,\n$$\ncompute $\\mathrm{TV}^{0}$ and $\\mathrm{TV}^{1}$ and verify whether the total variation increases in one time step.\n\n3) Briefly justify why the choice $\\phi(0.25)=1.5$ violates the classical sufficient constraints for Total Variation Diminishing (TVD) in the sense of Harten, and thus can lead to an increase in total variation.\n\nReport the value of $\\mathrm{TV}^{1}$ as your final answer. No rounding is needed. Express the final answer as an exact number without units.", "solution": "The problem asks for three tasks: computing one time step of a numerical scheme, evaluating the change in total variation, and justifying why the scheme is not Total Variation Diminishing (TVD).\n\n**Part 1: Single Time Step Update**\n\nThe goal is to compute the cell averages $U_{-1}^{1}$, $U_{0}^{1}$, and $U_{1}^{1}$. The explicit update formula is given by:\n$$U_{j}^{n+1} = U_{j}^{n} - \\nu \\left(U_{j+\\frac{1}{2}}^{+} - U_{j-\\frac{1}{2}}^{+}\\right)$$\nwhere the Courant-Friedrichs-Lewy (CFL) number is $\\nu = \\frac{1}{2}$. The right-side interface value, $U_{j+\\frac{1}{2}}^{+}$, is defined as:\n$$U_{j+\\frac{1}{2}}^{+} = U_{j+1}^{n} - \\frac{1}{2}s_{j+1}$$\nThe slope $s_j$ on cell $I_j$ is given by the flux-limiter form:\n$$s_{j} = \\phi(r_{j})\\left(U_{j}^{n}-U_{j-1}^{n}\\right)$$\nwith the ratio $r_j$ defined for $a0$ as:\n$$r_{j} = \\frac{U_{j+1}^{n}-U_{j}^{n}}{U_{j}^{n}-U_{j-1}^{n}}$$\nThe initial cell averages at time $t^0$ are given as:\n$$U_{-2}^{0}=10,\\quad U_{-1}^{0}=10,\\quad U_{0}^{0}=2,\\quad U_{1}^{0}=0,\\quad U_{2}^{0}=0$$\n\nTo update $U_{-1}^1, U_0^1, U_1^1$, we need the interface values $U_{-3/2}^{+}, U_{-1/2}^{+}, U_{1/2}^{+}, U_{3/2}^{+}$. These in turn require the slopes $s_{-1}, s_0, s_1, s_2$.\n\nFirst, we compute the ratios $r_j$ at $n=0$:\nFor $j=-1$: $r_{-1} = \\frac{U_{0}^{0}-U_{-1}^{0}}{U_{-1}^{0}-U_{-2}^{0}} = \\frac{2-10}{10-10} = \\frac{-8}{0}$. The denominator is zero. In such cases, where the upstream difference is zero, the slope is taken to be zero. Thus, $s_{-1}=0$.\n\nFor $j=0$: $r_{0} = \\frac{U_{1}^{0}-U_{0}^{0}}{U_{0}^{0}-U_{-1}^{0}} = \\frac{0-2}{2-10} = \\frac{-2}{-8} = 0.25$. The problem specifies that $\\phi(0.25)=1.5$.\n\nFor $j=1$: $r_{1} = \\frac{U_{2}^{0}-U_{1}^{0}}{U_{1}^{0}-U_{0}^{0}} = \\frac{0-0}{0-2} = \\frac{0}{-2} = 0$. The problem states to take $\\phi(r)=0$ for $r \\neq 0.25$. Thus, $\\phi(0)=0$.\n\nFor $j=2$: $r_{2} = \\frac{U_{3}^{0}-U_{2}^{0}}{U_{2}^{0}-U_{1}^{0}}$. The value $U_3^0$ is not given. However, the denominator is $U_{2}^{0}-U_{1}^{0} = 0-0=0$. As with $s_{-1}$, this implies $s_2=0$.\n\nNow, we compute the slopes $s_j$:\n$s_{-1} = 0$ (due to zero denominator in $r_{-1}$).\n$s_{0} = \\phi(r_{0})(U_{0}^{0}-U_{-1}^{0}) = \\phi(0.25)(2-10) = 1.5(-8) = -12$.\n$s_{1} = \\phi(r_{1})(U_{1}^{0}-U_{0}^{0}) = \\phi(0)(0-2) = 0 \\cdot (-2) = 0$.\n$s_{2} = 0$ (due to zero denominator in $r_2$).\n\nNext, we compute the necessary interface values $U_{j+1/2}^{+}$:\n$U_{-3/2}^{+} = U_{-1}^{0} - \\frac{1}{2}s_{-1} = 10 - \\frac{1}{2}(0) = 10$.\n$U_{-1/2}^{+} = U_{0}^{0} - \\frac{1}{2}s_{0} = 2 - \\frac{1}{2}(-12) = 2 + 6 = 8$.\n$U_{1/2}^{+} = U_{1}^{0} - \\frac{1}{2}s_{1} = 0 - \\frac{1}{2}(0) = 0$.\n$U_{3/2}^{+} = U_{2}^{0} - \\frac{1}{2}s_{2} = 0 - \\frac{1}{2}(0) = 0$.\n\nFinally, we apply the update formula with $\\nu=1/2$:\nFor $j=-1$: $U_{-1}^{1} = U_{-1}^{0} - \\frac{1}{2}\\left(U_{-1/2}^{+} - U_{-3/2}^{+}\\right) = 10 - \\frac{1}{2}(8-10) = 10 - \\frac{1}{2}(-2) = 11$.\nFor $j=0$: $U_{0}^{1} = U_{0}^{0} - \\frac{1}{2}\\left(U_{1/2}^{+} - U_{-1/2}^{+}\\right) = 2 - \\frac{1}{2}(0-8) = 2 - \\frac{1}{2}(-8) = 6$.\nFor $j=1$: $U_{1}^{1} = U_{1}^{0} - \\frac{1}{2}\\left(U_{3/2}^{+} - U_{1/2}^{+}\\right) = 0 - \\frac{1}{2}(0-0) = 0$.\n\nThe updated cell averages are $U_{-1}^{1}=11$, $U_{0}^{1}=6$, and $U_{1}^{1}=0$.\n\n**Part 2: Total Variation Calculation**\n\nThe total variation over the three-cell set $\\{j=-1, 0, 1\\}$ is defined as:\n$$\\mathrm{TV}^{n} = \\left|U_{0}^{n}-U_{-1}^{n}\\right| + \\left|U_{1}^{n}-U_{0}^{n}\\right|$$\nAt the initial time $n=0$:\n$$\\mathrm{TV}^{0} = |U_{0}^{0}-U_{-1}^{0}| + |U_{1}^{0}-U_{0}^{0}| = |2-10| + |0-2| = |-8| + |-2| = 8 + 2 = 10$$\nAt the next time step $n=1$, using the computed values:\n$$\\mathrm{TV}^{1} = |U_{0}^{1}-U_{-1}^{1}| + |U_{1}^{1}-U_{0}^{1}| = |6-11| + |0-6| = |-5| + |-6| = 5 + 6 = 11$$\nSince $\\mathrm{TV}^{1} = 11  \\mathrm{TV}^{0} = 10$, the total variation increases in one time step.\n\n**Part 3: Justification for TVD Violation**\n\nA numerical scheme is Total Variation Diminishing (TVD) if $\\mathrm{TV}^{n+1} \\leq \\mathrm{TV}^{n}$. The use of a flux limiter $\\phi(r)$ is intended to ensure this property. Harten and others derived sufficient conditions on $\\phi(r)$ for a scheme to be TVD. These conditions, often called Sweby's conditions, define a \"TVD region\" for the function $\\phi(r)$. For any $r0$, the limiter must satisfy:\n$$0 \\le \\phi(r) \\le 2$$\n$$0 \\le \\frac{\\phi(r)}{r} \\le 2$$\nThe problem specifies a limiter function such that at $r_0=0.25$, its value is $\\phi(0.25)=1.5$. We check this choice against the classical sufficient conditions.\n1. The first condition is $0 \\le \\phi(0.25) \\le 2$. Substituting the value, we get $0 \\le 1.5 \\le 2$, which is satisfied.\n2. The second condition is $0 \\le \\frac{\\phi(0.25)}{0.25} \\le 2$. Substituting the value, we get $0 \\le \\frac{1.5}{0.25} \\le 2$, which simplifies to $0 \\le 6 \\le 2$. This inequality is violated, as $6$ is not less than or equal to $2$.\n\nBecause the chosen value of the limiter function at $r=0.25$ falls outside the classical TVD region, the scheme is not guaranteed to be TVD. In fact, limiters that violate the condition $\\phi(r)/r \\le 2$ are known to be overly \"compressive\" and can amplify gradients, potentially introducing new oscillations and increasing the total variation, which is exactly what was observed in Part 2.", "answer": "$$\\boxed{11}$$", "id": "3424316"}, {"introduction": "High-order Discontinuous Galerkin (DG) methods require more sophisticated limiting strategies that respect the rich sub-cell information they contain. This practice [@problem_id:3424321] introduces the Maximum Principle Preserving (MPP) framework, a modern approach that enforces physical bounds by rescaling the solution *inside* each cell. The crucial insight you will uncover is that this type of limiter is designed to be conservative, leaving the cell average—and thus the total variation of the cell averages—unchanged, a key feature distinguishing it from traditional finite volume TVD approaches.", "problem": "Consider the scalar conservation law $u_{t} + f(u)_{x} = 0$ on a one-dimensional uniform mesh, and let a single cell $I_{i}$ be represented in a Discontinuous Galerkin (DG) method of polynomial degree two (denoted $P^{2}$) by its nodal degrees of freedom at the three Gauss–Lobatto points $\\xi_{1}=-1$, $\\xi_{2}=0$, and $\\xi_{3}=1$ on the reference interval $[-1,1]$. The nodal values are $(u_{i,1},u_{i,2},u_{i,3})$ and the cell average $\\bar{u}_{i}$ is defined as the average over the reference element, computed exactly by three-point Gauss–Lobatto quadrature. The Gauss–Lobatto weights for $n=3$ points on $[-1,1]$ are $w_{1}=w_{3}=\\frac{1}{3}$ and $w_{2}=\\frac{4}{3}$, and the reference-element average is $\\bar{u}_{i}=\\frac{1}{2}\\int_{-1}^{1}u_{i}(\\xi)\\,\\mathrm{d}\\xi$. Assume that only the nodal degrees of freedom within cell $I_{i}$ are modified by a bound-enforcing operation, while neighboring cells remain unchanged.\n\nA Maximum Principle Preserving (MPP) rescaling is performed to enforce invariant-region bounds $[m_{i},M_{i}]$ at the DG nodes while preserving the cell average. The rescaling must be a convex contraction about the average so that the post-limited nodal values have the form $u_{i,s}^{\\mathrm{new}}=\\bar{u}_{i}+\\theta_{i}\\left(u_{i,s}-\\bar{u}_{i}\\right)$ with a single scalar $\\theta_{i}\\in[0,1]$ chosen to ensure $m_{i}\\leq u_{i,s}^{\\mathrm{new}}\\leq M_{i}$ for $s\\in\\{1,2,3\\}$ and to preserve the average $\\bar{u}_{i}$.\n\nFor the specific numerical data\n$$\nu_{i,1}=-\\frac{1}{3},\\quad u_{i,2}=\\frac{5}{6},\\quad u_{i,3}=\\frac{7}{6},\\quad m_{i}=0,\\quad M_{i}=1,\n$$\ncarry out one step of MPP rescaling in cell $I_{i}$ by determining the admissible $\\theta_{i}$ from first principles (using only the stated constraints and the definition of the average), computing the new nodal values $u_{i,s}^{\\mathrm{new}}$, and then computing the changes $\\Delta u_{i,s}=u_{i,s}^{\\mathrm{new}}-u_{i,s}$ for $s=1,2,3$. Finally, using the definition of Total Variation (TV) of cell averages on a one-dimensional mesh,\n$$\n\\mathrm{TV}(\\{\\bar{u}_{j}\\})=\\sum_{j}\\left|\\bar{u}_{j+1}-\\bar{u}_{j}\\right|,\n$$\ndetermine the change in TV of cell averages caused by the rescaling in cell $I_{i}$ under the assumption that cell averages in all other cells remain unchanged. Express your final answer as a single row matrix containing $\\Delta u_{i,1}$, $\\Delta u_{i,2}$, $\\Delta u_{i,3}$, and the change in TV of cell averages, in exact fractional form. No rounding is required, and no units are needed.", "solution": "The solution proceeds in four main stages: 1) compute the cell average, 2) determine the rescaling factor $\\theta_i$, 3) compute the updated nodal values and their changes, and 4) determine the change in total variation.\n\nFirst, we calculate the cell average $\\bar{u}_{i}$ using the given nodal values and the 3-point Gauss-Lobatto quadrature formula. The cell average over the reference element is:\n$$\n\\bar{u}_{i} = \\frac{1}{2}\\int_{-1}^{1}u_{i}(\\xi)\\,\\mathrm{d}\\xi = \\frac{1}{2}\\sum_{s=1}^{3} u_{i,s}w_{s}\n$$\nSubstituting the given nodal values $u_{i,1}=-\\frac{1}{3}$, $u_{i,2}=\\frac{5}{6}$, $u_{i,3}=\\frac{7}{6}$ and weights $w_{1}=\\frac{1}{3}$, $w_{2}=\\frac{4}{3}$, $w_{3}=\\frac{1}{3}$:\n$$\n\\bar{u}_{i} = \\frac{1}{2}\\left( \\left(-\\frac{1}{3}\\right)\\left(\\frac{1}{3}\\right) + \\left(\\frac{5}{6}\\right)\\left(\\frac{4}{3}\\right) + \\left(\\frac{7}{6}\\right)\\left(\\frac{1}{3}\\right) \\right)\n= \\frac{1}{2}\\left( -\\frac{1}{9} + \\frac{20}{18} + \\frac{7}{18} \\right)\n$$\nTo sum the fractions, we use a common denominator of $18$:\n$$\n\\bar{u}_{i} = \\frac{1}{2}\\left( -\\frac{2}{18} + \\frac{20}{18} + \\frac{7}{18} \\right) = \\frac{1}{2}\\left( \\frac{-2+20+7}{18} \\right) = \\frac{1}{2}\\left(\\frac{25}{18}\\right) = \\frac{25}{36}\n$$\nNext, we determine the scaling factor $\\theta_{i} \\in [0,1]$. The new nodal values $u_{i,s}^{\\mathrm{new}} = \\bar{u}_{i}+\\theta_{i}(u_{i,s}-\\bar{u}_{i})$ must satisfy the bounds $m_{i} \\leq u_{i,s}^{\\mathrm{new}} \\leq M_{i}$, where $m_{i}=0$ and $M_{i}=1$.\n\nFor each nodal value $u_{i,s}$, we derive a constraint on $\\theta_{i}$:\nIf $u_{i,s}  \\bar{u}_{i}$, the upper bound is active: $\\bar{u}_{i}+\\theta_{i}(u_{i,s}-\\bar{u}_{i}) \\leq M_{i}$. This implies $\\theta_{i}(u_{i,s}-\\bar{u}_{i}) \\leq M_{i} - \\bar{u}_{i}$, so $\\theta_{i} \\leq \\frac{M_{i} - \\bar{u}_{i}}{u_{i,s} - \\bar{u}_{i}}$.\nIf $u_{i,s}  \\bar{u}_{i}$, the lower bound is active: $m_{i} \\leq \\bar{u}_{i}+\\theta_{i}(u_{i,s}-\\bar{u}_{i})$. This implies $\\theta_{i}(u_{i,s}-\\bar{u}_{i}) \\geq m_{i} - \\bar{u}_{i}$. Since $(u_{i,s}-\\bar{u}_{i})$ is negative, dividing by it reverses the inequality: $\\theta_{i} \\leq \\frac{m_{i} - \\bar{u}_{i}}{u_{i,s} - \\bar{u}_{i}}$.\n\nWe need to find the most restrictive $\\theta_{i}$ that satisfies all conditions. First, let's calculate the differences $u_{i,s} - \\bar{u}_{i}$:\n$u_{i,1} - \\bar{u}_{i} = -\\frac{1}{3} - \\frac{25}{36} = -\\frac{12}{36} - \\frac{25}{36} = -\\frac{37}{36}$\n$u_{i,2} - \\bar{u}_{i} = \\frac{5}{6} - \\frac{25}{36} = \\frac{30}{36} - \\frac{25}{36} = \\frac{5}{36}$\n$u_{i,3} - \\bar{u}_{i} = \\frac{7}{6} - \\frac{25}{36} = \\frac{42}{36} - \\frac{25}{36} = \\frac{17}{36}$\n\nThe original nodal values $u_{i,1}=-\\frac{1}{3}$ and $u_{i,3}=\\frac{7}{6}$ are outside the bounds $[0,1]$, so limiting is necessary, which means $\\theta_{i}1$.\nWe compute the upper limits on $\\theta_i$ for the out-of-bounds nodes:\nFor $s=1$, since $u_{i,1}  \\bar{u}_i$:\n$$\n\\theta_{i} \\leq \\frac{m_{i} - \\bar{u}_{i}}{u_{i,1} - \\bar{u}_{i}} = \\frac{0 - \\frac{25}{36}}{-\\frac{37}{36}} = \\frac{25}{37}\n$$\nFor $s=3$, since $u_{i,3}  \\bar{u}_i$:\n$$\n\\theta_{i} \\leq \\frac{M_{i} - \\bar{u}_{i}}{u_{i,3} - \\bar{u}_{i}} = \\frac{1 - \\frac{25}{36}}{\\frac{17}{36}} = \\frac{\\frac{11}{36}}{\\frac{17}{36}} = \\frac{11}{17}\n$$\nThe node $u_{i,2}$ is already within bounds, but we can check its constraint:\nFor $s=2$, since $u_{i,2}  \\bar{u}_i$:\n$$\n\\theta_{i} \\leq \\frac{M_{i} - \\bar{u}_{i}}{u_{i,2} - \\bar{u}_{i}} = \\frac{1 - \\frac{25}{36}}{\\frac{5}{36}} = \\frac{\\frac{11}{36}}{\\frac{5}{36}} = \\frac{11}{5}\n$$\nTo satisfy all constraints, we must choose the minimum of these values:\n$\\theta_{i} = \\min\\left(\\frac{25}{37}, \\frac{11}{17}, \\frac{11}{5}\\right)$.\nComparing $\\frac{25}{37}$ and $\\frac{11}{17}$: $25 \\times 17 = 425$ and $11 \\times 37 = 407$. Since $407  425$, we have $\\frac{11}{17}  \\frac{25}{37}$.\nClearly, $\\frac{11}{17}  1  \\frac{11}{5}$. Thus, the most restrictive value is $\\theta_i = \\frac{11}{17}$.\n\nNow we compute the changes in nodal values, $\\Delta u_{i,s} = u_{i,s}^{\\mathrm{new}} - u_{i,s}$.\nFrom the rescaling formula, $u_{i,s}^{\\mathrm{new}} - u_{i,s} = \\bar{u}_i + \\theta_i(u_{i,s}-\\bar{u}_i) - u_{i,s} = (\\theta_i-1)(u_{i,s}-\\bar{u}_i)$.\nWith $\\theta_{i} = \\frac{11}{17}$, we have $\\theta_{i}-1 = -\\frac{6}{17}$.\n$$\n\\Delta u_{i,1} = \\left(-\\frac{6}{17}\\right) (u_{i,1}-\\bar{u}_{i}) = \\left(-\\frac{6}{17}\\right)\\left(-\\frac{37}{36}\\right) = \\frac{6 \\times 37}{17 \\times 36} = \\frac{37}{17 \\times 6} = \\frac{37}{102}\n$$\n$$\n\\Delta u_{i,2} = \\left(-\\frac{6}{17}\\right) (u_{i,2}-\\bar{u}_{i}) = \\left(-\\frac{6}{17}\\right)\\left(\\frac{5}{36}\\right) = -\\frac{6 \\times 5}{17 \\times 36} = -\\frac{5}{17 \\times 6} = -\\frac{5}{102}\n$$\n$$\n\\Delta u_{i,3} = \\left(-\\frac{6}{17}\\right) (u_{i,3}-\\bar{u}_{i}) = \\left(-\\frac{6}{17}\\right)\\left(\\frac{17}{36}\\right) = -\\frac{6 \\times 17}{17 \\times 36} = -\\frac{6}{36} = -\\frac{1}{6} = -\\frac{17}{102}\n$$\nThe changes in the nodal degrees of freedom are $\\Delta u_{i,1} = \\frac{37}{102}$, $\\Delta u_{i,2} = -\\frac{5}{102}$, and $\\Delta u_{i,3} = -\\frac{17}{102}$.\n\nFinally, we determine the change in the Total Variation (TV) of the cell averages, $\\Delta\\mathrm{TV}(\\{\\bar{u}_{j}\\})$. The TV is defined as $\\mathrm{TV}(\\{\\bar{u}_{j}\\}) = \\sum_{j}|\\bar{u}_{j+1}-\\bar{u}_{j}|$. The change is $\\Delta\\mathrm{TV} = \\mathrm{TV}_{\\text{new}} - \\mathrm{TV}_{\\text{old}}$.\nThe problem states that the rescaling is performed only in cell $I_i$ and the cell average $\\bar{u}_i$ is preserved. The rescaling formula $u_{i,s}^{\\mathrm{new}}=\\bar{u}_{i}+\\theta_{i}(u_{i,s}-\\bar{u}_{i})$ is conservative by design, meaning $\\bar{u}_{i}^{\\mathrm{new}} = \\bar{u}_{i}$. The problem also assumes that cell averages in all other cells remain unchanged, i.e., $\\bar{u}_{j}^{\\mathrm{new}} = \\bar{u}_{j}$ for all $j \\neq i$.\nCombining these facts, we have $\\bar{u}_{j}^{\\mathrm{new}} = \\bar{u}_{j}$ for all cells $j$.\nTherefore, the new TV is:\n$$\n\\mathrm{TV}_{\\text{new}} = \\sum_{j}|\\bar{u}_{j+1}^{\\mathrm{new}}-\\bar{u}_{j}^{\\mathrm{new}}| = \\sum_{j}|\\bar{u}_{j+1}-\\bar{u}_{j}| = \\mathrm{TV}_{\\text{old}}\n$$\nThe change in the total variation of the cell averages is:\n$$\n\\Delta\\mathrm{TV} = \\mathrm{TV}_{\\text{new}} - \\mathrm{TV}_{\\text{old}} = 0\n$$\n\nThe final answer consists of the four required quantities: $\\Delta u_{i,1}$, $\\Delta u_{i,2}$, $\\Delta u_{i,3}$, and $\\Delta\\mathrm{TV}$.\n$\\Delta u_{i,1} = \\frac{37}{102}$\n$\\Delta u_{i,2} = -\\frac{5}{102}$\n$\\Delta u_{i,3} = -\\frac{17}{102}$\n$\\Delta\\mathrm{TV} = 0$\nAssembling these into a single row matrix gives the final answer.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{37}{102}  -\\frac{5}{102}  -\\frac{17}{102}  0\n\\end{pmatrix}\n}\n$$", "id": "3424321"}]}