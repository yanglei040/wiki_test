{"hands_on_practices": [{"introduction": "This practice introduces the classic Total Variation Diminishing (TVD) property, a cornerstone of robust shock-capturing schemes. Here, you will engage with the Monotonized Central (MC) limiter, a widely used tool in finite volume methods. By deriving its explicit form and proving its TVD property [@problem_id:3414647], you will gain a fundamental understanding of how limiters mathematically constrain numerical solutions to prevent the growth of spurious oscillations near discontinuities.", "problem": "Consider the scalar linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$ on a uniform mesh with cell centers $x_{i}$ and cell width $\\Delta x$. Let $u_{i}$ denote the cell average of $u$ over the $i$-th cell. A second-order accurate piecewise linear reconstruction within cell $i$ is given by $u_{i}(x) = u_{i} + \\sigma_{i}\\,\\frac{x - x_{i}}{\\Delta x}$, where $\\sigma_{i}$ is a limited slope to be determined. The left and right interface states reconstructed from cell $i$ are $u_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\sigma_{i}$ and $u_{i-1/2}^{+} = u_{i} - \\frac{1}{2}\\sigma_{i}$. With the upwind numerical flux $F(u) = a\\,u$ (appropriate for $a>0$), the forward Euler finite volume update is\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda \\big(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\big), \\quad \\lambda = \\frac{\\Delta t}{\\Delta x}, \\quad F_{i+1/2}^{n} = a\\,u_{i+1/2}^{-,n},\n$$\nwhere $u_{i+1/2}^{-,n} = u_{i}^{n} + \\frac{1}{2}\\sigma_{i}^{n}$ and similarly for $u_{i-1/2}^{-,n}$. Define the one-sided differences\n$$\nD_{i}^{-} = u_{i} - u_{i-1}, \\qquad D_{i}^{+} = u_{i+1} - u_{i}.\n$$\nA slope limiter is said to be Total Variation Diminishing (TVD) if it yields an update $u_{i}^{n} \\mapsto u_{i}^{n+1}$ such that the discrete total variation\n$$\n\\operatorname{TV}(u^{n}) = \\sum_{i} \\big|u_{i+1}^{n} - u_{i}^{n}\\big|\n$$\ndoes not increase, i.e., $\\operatorname{TV}(u^{n+1}) \\le \\operatorname{TV}(u^{n})$, under a Courant–Friedrichs–Lewy (CFL) condition on $\\lambda a$. The Monotonized Central (MC) limiter is designed to maintain TVD by enforcing the following admissibility conditions on $\\sigma_{i}$:\n1. If $D_{i}^{-} D_{i}^{+} \\le 0$, then $\\sigma_{i} = 0$.\n2. If $D_{i}^{-} D_{i}^{+}  0$, then $\\sigma_{i}$ has the same sign as $D_{i}^{-}$ and $D_{i}^{+}$ and its magnitude is bounded by\n$$\n|\\sigma_{i}| \\le \\min\\!\\left\\{\\, 2|D_{i}^{-}|,\\, 2|D_{i}^{+}|,\\, \\left|\\frac{D_{i}^{-} + D_{i}^{+}}{2}\\right| \\right\\}.\n$$\nStarting from the above finite volume update and the definition of the upwind flux, use the admissibility conditions to show that the scheme constructed with the MC limiter is TVD under the condition $0  \\lambda a \\le 1$. Then, compute the limited slope $\\sigma_{i}$ explicitly in closed form in terms of $D_{i}^{-}$ and $D_{i}^{+}$ for the MC limiter. Your final answer must be a single closed-form analytic expression. No numerical approximation or rounding is required.", "solution": "We begin with the scalar linear advection equation $u_{t} + a\\,u_{x} = 0$ and its finite volume discretization with piecewise linear reconstruction. For $a>0$, the upwind flux is $F(u) = a\\,u$, so the numerical interface flux takes the left state at each interface:\n$$\nF_{i+1/2}^{n} = a\\,u_{i+1/2}^{-,n} = a\\left(u_{i}^{n} + \\frac{1}{2}\\sigma_{i}^{n}\\right), \\qquad F_{i-1/2}^{n} = a\\,u_{i-1/2}^{-,n} = a\\left(u_{i-1}^{n} + \\frac{1}{2}\\sigma_{i-1}^{n}\\right).\n$$\nThe forward Euler update is therefore\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda a \\left[\\left(u_{i}^{n} + \\frac{1}{2}\\sigma_{i}^{n}\\right) - \\left(u_{i-1}^{n} + \\frac{1}{2}\\sigma_{i-1}^{n}\\right)\\right] = (1 - \\lambda a)\\,u_{i}^{n} + \\lambda a\\,u_{i-1}^{n} - \\frac{\\lambda a}{2}\\left(\\sigma_{i}^{n} - \\sigma_{i-1}^{n}\\right).\n$$\nDefine the discrete total variation $\\operatorname{TV}(u^{n}) = \\sum_{i} |u_{i+1}^{n} - u_{i}^{n}|$. To show the scheme is Total Variation Diminishing (TVD), it suffices to show that the update is monotone and does not create new extrema, provided $0  \\lambda a \\le 1$. A classical sufficient condition uses the boundedness of reconstructed interface values by neighboring cell averages. We analyze the interface reconstructions:\n$$\nu_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\sigma_{i}, \\qquad u_{i-1/2}^{-} = u_{i-1} + \\frac{1}{2}\\sigma_{i-1}.\n$$\nThe MC limiter enforces the admissibility conditions:\n1. If $D_{i}^{-} D_{i}^{+} \\le 0$, set $\\sigma_{i} = 0$. Then $u_{i+1/2}^{-} = u_{i}$, which is trivially bounded between $u_{i}$ and $u_{i+1}$. Similarly, $u_{i-1/2}^{-} = u_{i-1}$ is bounded between $u_{i-1}$ and $u_{i}$.\n2. If $D_{i}^{-} D_{i}^{+}  0$, the sign consistency of $\\sigma_{i}$ and the magnitude bounds\n$$\n|\\sigma_{i}| \\le \\min\\!\\left\\{\\, 2|D_{i}^{-}|,\\, 2|D_{i}^{+}|,\\, \\left|\\frac{D_{i}^{-} + D_{i}^{+}}{2}\\right| \\right\\}\n$$\nimply the interface values lie between neighboring cell averages. To see this, suppose $D_{i}^{+}  0$ (the argument for $D_{i}^{+}  0$ is analogous). Then $u_{i+1} = u_{i} + D_{i}^{+}$ and the bound $|\\sigma_{i}| \\le 2|D_{i}^{+}|$ together with the sign of $\\sigma_{i}$ yields\n$$\nu_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\sigma_{i} \\le u_{i} + \\frac{1}{2}\\cdot 2 D_{i}^{+} = u_{i+1}.\n$$\nSimilarly, if $D_{i}^{-}  0$, then $u_{i} = u_{i-1} + D_{i}^{-}$ and $|\\sigma_{i}| \\le 2|D_{i}^{-}|$ ensures\n$$\nu_{i-1/2}^{+} = u_{i} - \\frac{1}{2}\\sigma_{i} \\ge u_{i} - D_{i}^{-} = u_{i-1}.\n$$\nWhen $D_{i}^{-} D_{i}^{+}  0$, the additional bound $|\\sigma_{i}| \\le \\left|\\frac{D_{i}^{-} + D_{i}^{+}}{2}\\right|$ controls the central slope to prevent excessive steepening even when one-sided differences are highly unbalanced, ensuring both $u_{i+1/2}^{-}$ and $u_{i-1/2}^{+}$ remain within their respective neighbor intervals:\n$$\n\\min\\{u_{i}, u_{i+1}\\} \\le u_{i+1/2}^{-} \\le \\max\\{u_{i}, u_{i+1}\\}, \\qquad \\min\\{u_{i-1}, u_{i}\\} \\le u_{i-1/2}^{+} \\le \\max\\{u_{i-1}, u_{i}\\}.\n$$\nTherefore, for all $i$, the reconstructed interface states are bounded by adjacent cell averages. With the upwind flux $F(u) = a\\,u$, which is monotone (non-decreasing) in $u$ for $a>0$, and the forward Euler update with $0  \\lambda a \\le 1$, this bounding implies the scheme is monotone in the sense of discrete maximum principles: no new local extrema are created and interface fluxes interpolate values within neighbor ranges. By the classical Harten–Crandall–Tartar TVD framework for monotone schemes, the discrete total variation does not increase, i.e., $\\operatorname{TV}(u^{n+1}) \\le \\operatorname{TV}(u^{n})$. Hence, under $0  \\lambda a \\le 1$, the scheme with the MC limiter is TVD.\n\nWe now compute the explicit limited slope $\\sigma_{i}$ in terms of the one-sided differences $D_{i}^{-}$ and $D_{i}^{+}$. Introduce the minmod function with multiple arguments,\n$$\n\\operatorname{minmod}(a_{1}, a_{2}, \\dots, a_{m}) = \n\\begin{cases}\n\\operatorname{sign}(a_{1}) \\min\\limits_{1 \\le j \\le m} |a_{j}|  \\text{if } \\operatorname{sign}(a_{1}) = \\operatorname{sign}(a_{2}) = \\cdots = \\operatorname{sign}(a_{m}) \\\\[6pt]\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe MC admissibility requirements can be compactly enforced by choosing $\\sigma_{i}$ as the minmod of three candidate slopes: a central slope and twice the one-sided slopes, all scaled consistently on the uniform mesh. Using $D_{i}^{-}$ and $D_{i}^{+}$, the central slope is $\\frac{D_{i}^{-} + D_{i}^{+}}{2}$, and the scaled one-sided slopes are $2D_{i}^{-}$ and $2D_{i}^{+}$. Therefore, the closed-form expression for the MC-limited slope is\n$$\n\\sigma_{i} = \\operatorname{minmod}\\!\\left( \\frac{D_{i}^{-} + D_{i}^{+}}{2},\\, 2 D_{i}^{-},\\, 2 D_{i}^{+} \\right).\n$$\nThis expression satisfies the sign-consistency and magnitude bounds required by the MC limiter. If $D_{i}^{-} D_{i}^{+} \\le 0$, the arguments have differing signs and $\\sigma_{i} = 0$. If $D_{i}^{-} D_{i}^{+}  0$, all arguments share the same sign and $\\sigma_{i}$ takes the smallest magnitude among the three, enforcing\n$$\n|\\sigma_{i}| \\le \\min\\!\\left\\{\\, \\left|\\frac{D_{i}^{-} + D_{i}^{+}}{2}\\right|,\\, 2|D_{i}^{-}|,\\, 2|D_{i}^{+}| \\right\\}.\n$$\nThus, the explicit MC-limited slope in terms of the one-sided differences has been derived, and the TVD property under $0  \\lambda a \\le 1$ has been established.", "answer": "$$\\boxed{\\operatorname{minmod}\\!\\left(\\frac{D_{i}^{-} + D_{i}^{+}}{2},\\, 2 D_{i}^{-},\\, 2 D_{i}^{+}\\right)}$$", "id": "3414647"}, {"introduction": "Moving from finite volume to high-order Discontinuous Galerkin (DG) methods requires a different perspective on limiting. Instead of cell averages and slopes, we often work with modal coefficients of a polynomial basis. This exercise [@problem_id:3414617] provides hands-on practice with a hierarchical modal limiter, where only the highest-order modes responsible for oscillations are dampened. You will directly calculate how this targeted limiting affects the solution's values at key points within an element, while verifying the crucial property that the cell's average value—and thus its mass—remains conserved.", "problem": "Consider a one-dimensional scalar conservation law discretized by the Discontinuous Galerkin (DG) method, where the local representation in a cell mapped to the reference interval $[-1,1]$ uses a polynomial of degree $P^3$ in the modal Legendre basis. Let the solution be expressed as $u(x) = \\sum_{k=0}^{3} a_k L_k(x)$, where $L_k(x)$ are the standard Legendre polynomials on $[-1,1]$. To capture shocks with minimal spurious oscillations, a hierarchical slope limiter scales only the highest modal coefficient, replacing $a_3$ by $\\lambda a_3$ with a limiter factor $\\lambda \\in [0,1]$, while leaving $a_0$, $a_1$, and $a_2$ unchanged. The Gauss–Lobatto interpolation points for $P^3$ on $[-1,1]$ are $x=-1$, $x=-1/\\sqrt{5}$, $x=1/\\sqrt{5}$, and $x=1$.\n\nStarting from the fundamental properties of Legendre polynomials and their orthogonality with respect to the $L^2([-1,1])$ inner product, derive the nodal values $u(x)$ at the four Gauss–Lobatto points after limiting the $k=3$ mode, and verify from first principles that the cell average is preserved by this limiter. Express your final answer as a single row matrix containing, in order, the four nodal values and the cell average after limiting, in exact symbolic form in terms of $a_0$, $a_1$, $a_2$, $a_3$, and $\\lambda$.", "solution": "The objective is to analyze the effect of a hierarchical slope limiter on a polynomial solution representation within a DG framework. We are given a solution $u(x)$ in a cell, represented on the reference interval $[-1, 1]$ as a degree-$3$ polynomial expressed in a modal Legendre basis:\n$$\nu(x) = \\sum_{k=0}^{3} a_k L_k(x) = a_0 L_0(x) + a_1 L_1(x) + a_2 L_2(x) + a_3 L_3(x)\n$$\nwhere $L_k(x)$ are the standard Legendre polynomials and $a_k$ are the modal coefficients.\n\nThe hierarchical limiter acts by scaling only the highest-order coefficient, $a_3$, by a factor $\\lambda \\in [0,1]$. The limited solution, which we will denote as $u_{lim}(x)$, is therefore:\n$$\nu_{lim}(x) = a_0 L_0(x) + a_1 L_1(x) + a_2 L_2(x) + (\\lambda a_3) L_3(x)\n$$\nWe need to perform two tasks:\n1. Verify from first principles that the cell average of the solution is preserved by this limiter.\n2. Derive the nodal values of the limited solution, $u_{lim}(x)$, at the four specified Gauss-Lobatto points.\n\nFirst, we verify the preservation of the cell average. The cell average of a function $f(x)$ on the reference interval $[-1, 1]$ is defined as:\n$$\n\\bar{f} = \\frac{1}{1 - (-1)} \\int_{-1}^{1} f(x) \\, dx = \\frac{1}{2} \\int_{-1}^{1} f(x) \\, dx\n$$\nThe Legendre polynomials, $L_k(x)$, are orthogonal with respect to the $L^2([-1,1])$ inner product, which is defined as $\\langle f, g \\rangle = \\int_{-1}^{1} f(x)g(x) \\, dx$. The orthogonality relation is:\n$$\n\\int_{-1}^{1} L_k(x) L_j(x) \\, dx = \\frac{2}{2k+1} \\delta_{kj}\n$$\nwhere $\\delta_{kj}$ is the Kronecker delta.\n\nThe first Legendre polynomial is $L_0(x) = 1$. The cell average of the limited solution $u_{lim}(x)$ is:\n$$\n\\bar{u}_{lim} = \\frac{1}{2} \\int_{-1}^{1} u_{lim}(x) \\, dx = \\frac{1}{2} \\int_{-1}^{1} \\left( a_0 L_0(x) + a_1 L_1(x) + a_2 L_2(x) + \\lambda a_3 L_3(x) \\right) dx\n$$\nBy linearity of the integral, we can write this as:\n$$\n\\bar{u}_{lim} = \\frac{1}{2} \\left( a_0 \\int_{-1}^{1} L_0(x) \\, dx + a_1 \\int_{-1}^{1} L_1(x) \\, dx + a_2 \\int_{-1}^{1} L_2(x) \\, dx + \\lambda a_3 \\int_{-1}^{1} L_3(x) \\, dx \\right)\n$$\nWe can express each integral using the orthogonality property by noting that $\\int_{-1}^{1} L_k(x) \\, dx = \\int_{-1}^{1} L_k(x) L_0(x) \\, dx$. Based on the orthogonality relation, this integral is non-zero only for $k=0$:\n$$\n\\int_{-1}^{1} L_k(x) L_0(x) \\, dx = \\frac{2}{2(0)+1} \\delta_{k0} = 2 \\delta_{k0}\n$$\nTherefore, the integrals for $L_1(x)$, $L_2(x)$, and $L_3(x)$ are all zero. The expression for the cell average simplifies to:\n$$\n\\bar{u}_{lim} = \\frac{1}{2} \\left( a_0 (2\\delta_{00}) + a_1 (2\\delta_{10}) + a_2 (2\\delta_{20}) + \\lambda a_3 (2\\delta_{30}) \\right) = \\frac{1}{2} (a_0 \\cdot 2) = a_0\n$$\nThe cell average of the original unlimited solution, $\\bar{u}$, is also $a_0$. Thus, $\\bar{u}_{lim} = \\bar{u} = a_0$. The cell average is preserved and is equal to the first modal coefficient, $a_0$. This fundamental property is a direct consequence of using an orthogonal basis where the first basis function is a constant.\n\nNext, we derive the nodal values of $u_{lim}(x)$ at the specified Gauss-Lobatto points: $x = -1$, $x = -1/\\sqrt{5}$, $x = 1/\\sqrt{5}$, and $x=1$. To do this, we need the expressions for the first four Legendre polynomials:\n$L_0(x) = 1$\n$L_1(x) = x$\n$L_2(x) = \\frac{1}{2}(3x^2 - 1)$\n$L_3(x) = \\frac{1}{2}(5x^3 - 3x)$\n\nWe evaluate these polynomials at each of the four points:\n\n1. At $x = -1$:\n$L_0(-1) = 1$\n$L_1(-1) = -1$\n$L_2(-1) = \\frac{1}{2}(3(-1)^2 - 1) = 1$\n$L_3(-1) = \\frac{1}{2}(5(-1)^3 - 3(-1)) = -1$\n\n2. At $x = -1/\\sqrt{5}$:\n$L_0(-1/\\sqrt{5}) = 1$\n$L_1(-1/\\sqrt{5}) = -1/\\sqrt{5}$\n$L_2(-1/\\sqrt{5}) = \\frac{1}{2}(3(-1/\\sqrt{5})^2 - 1) = \\frac{1}{2}(\\frac{3}{5} - 1) = -\\frac{1}{5}$\n$L_3(-1/\\sqrt{5}) = \\frac{1}{2}(5(-1/\\sqrt{5})^3 - 3(-1/\\sqrt{5})) = \\frac{1}{2}(-\\frac{5}{5\\sqrt{5}} + \\frac{3}{\\sqrt{5}}) = \\frac{1}{2}(\\frac{2}{\\sqrt{5}}) = \\frac{1}{\\sqrt{5}}$\n\n3. At $x = 1/\\sqrt{5}$:\n$L_0(1/\\sqrt{5}) = 1$\n$L_1(1/\\sqrt{5}) = 1/\\sqrt{5}$\n$L_2(1/\\sqrt{5}) = \\frac{1}{2}(3(1/\\sqrt{5})^2 - 1) = \\frac{1}{2}(\\frac{3}{5} - 1) = -\\frac{1}{5}$\n$L_3(1/\\sqrt{5}) = \\frac{1}{2}(5(1/\\sqrt{5})^3 - 3(1/\\sqrt{5})) = \\frac{1}{2}(\\frac{5}{5\\sqrt{5}} - \\frac{3}{\\sqrt{5}}) = \\frac{1}{2}(-\\frac{2}{\\sqrt{5}}) = -\\frac{1}{\\sqrt{5}}$\n\n4. At $x = 1$:\n$L_0(1) = 1$\n$L_1(1) = 1$\n$L_2(1) = \\frac{1}{2}(3(1)^2 - 1) = 1$\n$L_3(1) = \\frac{1}{2}(5(1)^3 - 3(1)) = 1$\n\nNow, we substitute these values into the expression for $u_{lim}(x)$ to find the nodal values.\n\nNodal value at $x=-1$:\n$u_{lim}(-1) = a_0 L_0(-1) + a_1 L_1(-1) + a_2 L_2(-1) + \\lambda a_3 L_3(-1)$\n$u_{lim}(-1) = a_0(1) + a_1(-1) + a_2(1) + \\lambda a_3(-1) = a_0 - a_1 + a_2 - \\lambda a_3$\n\nNodal value at $x=-1/\\sqrt{5}$:\n$u_{lim}(-1/\\sqrt{5}) = a_0 L_0(-1/\\sqrt{5}) + a_1 L_1(-1/\\sqrt{5}) + a_2 L_2(-1/\\sqrt{5}) + \\lambda a_3 L_3(-1/\\sqrt{5})$\n$u_{lim}(-1/\\sqrt{5}) = a_0(1) + a_1(-1/\\sqrt{5}) + a_2(-1/5) + \\lambda a_3(1/\\sqrt{5}) = a_0 - \\frac{a_1}{\\sqrt{5}} - \\frac{a_2}{5} + \\frac{\\lambda a_3}{\\sqrt{5}}$\n\nNodal value at $x=1/\\sqrt{5}$:\n$u_{lim}(1/\\sqrt{5}) = a_0 L_0(1/\\sqrt{5}) + a_1 L_1(1/\\sqrt{5}) + a_2 L_2(1/\\sqrt{5}) + \\lambda a_3 L_3(1/\\sqrt{5})$\n$u_{lim}(1/\\sqrt{5}) = a_0(1) + a_1(1/\\sqrt{5}) + a_2(-1/5) + \\lambda a_3(-1/\\sqrt{5}) = a_0 + \\frac{a_1}{\\sqrt{5}} - \\frac{a_2}{5} - \\frac{\\lambda a_3}{\\sqrt{5}}$\n\nNodal value at $x=1$:\n$u_{lim}(1) = a_0 L_0(1) + a_1 L_1(1) + a_2 L_2(1) + \\lambda a_3 L_3(1)$\n$u_{lim}(1) = a_0(1) + a_1(1) + a_2(1) + \\lambda a_3(1) = a_0 + a_1 + a_2 + \\lambda a_3$\n\nThe final result is a collection of these four nodal values and the conserved cell average, $a_0$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\na_0 - a_1 + a_2 - \\lambda a_3  a_0 - \\frac{a_1}{\\sqrt{5}} - \\frac{a_2}{5} + \\frac{\\lambda a_3}{\\sqrt{5}}  a_0 + \\frac{a_1}{\\sqrt{5}} - \\frac{a_2}{5} - \\frac{\\lambda a_3}{\\sqrt{5}}  a_0 + a_1 + a_2 + \\lambda a_3  a_0\n\\end{pmatrix}\n}\n$$", "id": "3414617"}, {"introduction": "The power of high-order methods is fully realized on complex, curved geometries, but this introduces new challenges for numerical stability. This problem [@problem_id:3414596] explores a critical and often-overlooked pitfall: the danger of applying limiters naively in the computational reference frame instead of the physical frame. By analyzing a simple free-stream flow over a curved element, you will discover how geometric factors can be misinterpreted as physical oscillations, leading a limiter to spuriously activate and destroy the accuracy of the solution. This practice underscores the importance of designing physically consistent numerical algorithms.", "problem": "Consider the one-dimensional linear advection conservation law $\\partial_{t} u + a \\, \\partial_{x} u = 0$ with constant advection speed $a$, discretized by a degree-$1$ Discontinuous Galerkin (DG) method on a single curved isoparametric element. The physical coordinate $x$ is mapped from the reference coordinate $\\xi \\in [-1,1]$ via $x(\\xi) = \\xi + \\alpha \\, \\xi^{2}$, where $\\alpha$ is a nonzero curvature parameter, and the mapping Jacobian is $J(\\xi) = \\frac{dx}{d\\xi} = 1 + 2 \\alpha \\, \\xi$. Assume the exact physical solution is a free stream $u(x) \\equiv u_{0}$ with $u_{0} \\neq 0$ constant. In the weak conservative form on the reference element, the conservative variable represented in the DG polynomial is $q(\\xi) = J(\\xi) \\, u(\\xi)$.\n\nA Total Variation Diminishing (TVD) minmod-type slope limiter is applied in reference coordinates to the conservative variable $q(\\xi)$, using the degree-$1$ polynomial representation $q(\\xi) = c_{0} + c_{1} \\, \\xi$. The limiter reconstructs $q^{L}(\\xi) = \\bar{q} + s^{L} \\, \\xi$, where $\\bar{q}$ is the reference-cell average defined by $\\bar{q} = \\frac{1}{2} \\int_{-1}^{1} q(\\xi) \\, d\\xi$, the prelimited slope is $s = c_{1}$, and a shock sensor triggers if $S = \\frac{|s|}{|\\bar{q}|} > \\kappa$ for a given threshold $\\kappa \\in (0,1)$. When the sensor triggers, the limiter sets $s^{L} = 0$ (otherwise $s^{L} = s$). In contrast, a physically consistent limiter would operate in physical coordinates on $u(\\xi)$ instead of $q(\\xi)$.\n\nStarting from these definitions and the mapping, derive the activation condition in terms of $\\alpha$ and $\\kappa$, explain why limiting in reference coordinates on $q(\\xi)$ can bias the limiter on curved elements and break free-stream preservation, and compute the resulting limited physical solution $u^{L}(\\xi)$ when the sensor triggers and $s^{L} = 0$. Your final answer must be the single closed-form analytic expression for $u^{L}(\\xi)$ using the given $J(\\xi)$. No numerical approximation or rounding is required, and no units are to be reported.", "solution": "The problem considers a one-dimensional linear advection equation, $\\partial_{t} u + a \\, \\partial_{x} u = 0$, with an exact free-stream solution $u(x) = u_{0}$, where $u_{0} \\neq 0$ is a constant. The discretization is performed using a degree-$1$ Discontinuous Galerkin (DG) method on a single curved element. The geometry is defined by the mapping from the reference coordinate $\\xi \\in [-1,1]$ to the physical coordinate $x$ via $x(\\xi) = \\xi + \\alpha \\, \\xi^{2}$. The Jacobian of this mapping is $J(\\xi) = \\frac{dx}{d\\xi} = 1 + 2 \\alpha \\, \\xi$.\n\nThe DG method operates on a polynomial representation of the conservative variable in the reference element, which is defined as $q(\\xi) = J(\\xi) \\, u(\\xi)$. Since the physical solution is a constant $u_{0}$, the corresponding solution in the reference frame is also constant, $u(\\xi) = u_{0}$.\nTherefore, the exact conservative variable is:\n$$q(\\xi) = J(\\xi) u_{0} = (1 + 2 \\alpha \\, \\xi) u_{0} = u_{0} + 2 \\alpha u_{0} \\, \\xi$$\nThis is a linear polynomial in $\\xi$.\n\nThe degree-$1$ DG representation of this variable is given as $q(\\xi) = c_{0} + c_{1} \\, \\xi$. Since the exact expression for $q(\\xi)$ is already a degree-$1$ polynomial, the DG representation is exact, and we can directly identify the coefficients by comparison:\n$$c_{0} = u_{0}$$\n$$c_{1} = 2 \\alpha u_{0}$$\n\nA minmod-type slope limiter is applied to this representation. The limiter operates on the reference-cell average, $\\bar{q}$, and the prelimited slope, $s$.\n\nFirst, we compute the reference-cell average $\\bar{q}$:\n$$\\bar{q} = \\frac{1}{2} \\int_{-1}^{1} q(\\xi) \\, d\\xi = \\frac{1}{2} \\int_{-1}^{1} (u_{0} + 2 \\alpha u_{0} \\, \\xi) \\, d\\xi$$\n$$\\bar{q} = \\frac{u_{0}}{2} \\left[ \\xi + \\alpha \\, \\xi^{2} \\right]_{-1}^{1} = \\frac{u_{0}}{2} \\left( (1 + \\alpha) - (-1 + \\alpha) \\right) = \\frac{u_{0}}{2} (2) = u_{0}$$\nAlternatively, using the polynomial coefficients, the average of $c_{0} + c_{1} \\xi$ over the symmetric interval $[-1,1]$ is simply $c_{0}$. Thus, $\\bar{q} = c_{0} = u_{0}$.\n\nThe prelimited slope, $s$, is given as the coefficient of the linear term, $s = c_{1}$.\n$$s = 2 \\alpha u_{0}$$\n\nThe shock sensor is defined as $S = \\frac{|s|}{|\\bar{q}|}$, and it triggers if $S > \\kappa$ for a given threshold $\\kappa \\in (0,1)$. We can substitute our computed values for $s$ and $\\bar{q}$:\n$$S = \\frac{|2 \\alpha u_{0}|}{|u_{0}|} = 2 |\\alpha| \\frac{|u_{0}|}{|u_{0}|}$$\nSince $u_{0} \\neq 0$, this simplifies to:\n$$S = 2 |\\alpha|$$\nThe activation condition for the limiter is therefore $S > \\kappa$, which translates to:\n$$2 |\\alpha| > \\kappa$$\n\nThis condition reveals why limiting in reference coordinates on $q(\\xi)$ can be problematic and break free-stream preservation. The physical solution $u(x) = u_{0}$ is a constant, representing a perfectly smooth free stream. Any physically consistent numerical method should preserve this solution exactly without modification. However, the limiter is applied to $q(\\xi) = J(\\xi) u(\\xi)$. On a curved element ($\\alpha \\neq 0$), the Jacobian $J(\\xi)$ is not constant. Multiplying the constant physical solution $u_{0}$ by the spatially varying Jacobian $J(\\xi)$ results in a conservative variable $q(\\xi)$ that has a non-zero slope, $s = 2 \\alpha u_{0}$. The limiter misinterprets this slope, which is purely an artifact of the element's curvature, as a physical gradient or oscillation in the solution itself. If the curvature is large enough such that $2|\\alpha| > \\kappa$, the limiter is spuriously activated. This modification of a perfectly smooth solution is the definition of breaking free-stream preservation. A consistent limiter would need to operate on the physical variable $u(\\xi)$, which it would reconstruct as $u(\\xi) = q(\\xi) / J(\\xi) = (u_0 + 2\\alpha u_0 \\xi)/(1+2\\alpha\\xi) = u_0(1+2\\alpha\\xi)/(1+2\\alpha\\xi) = u_0$. The slope of this reconstructed physical variable is zero, so a physically consistent limiter would not trigger.\n\nFinally, we compute the resulting limited physical solution $u^{L}(\\xi)$ when the sensor triggers. According to the problem statement, when the sensor triggers, the limiter sets the new slope to zero, $s^{L} = 0$. The limited conservative variable is then reconstructed as:\n$$q^{L}(\\xi) = \\bar{q} + s^{L} \\, \\xi$$\nSubstituting $\\bar{q} = u_{0}$ and $s^{L} = 0$:\n$$q^{L}(\\xi) = u_{0} + (0) \\xi = u_{0}$$\nThe limiter has effectively flattened the conservative variable representation to its cell average.\n\nTo find the limited physical solution $u^{L}(\\xi)$, we must transform back from the conservative variable in the reference frame by dividing by the Jacobian:\n$$u^{L}(\\xi) = \\frac{q^{L}(\\xi)}{J(\\xi)}$$\nSubstituting $q^{L}(\\xi) = u_{0}$ and $J(\\xi) = 1 + 2 \\alpha \\, \\xi$:\n$$u^{L}(\\xi) = \\frac{u_{0}}{1 + 2 \\alpha \\, \\xi}$$\nThis is the final expression for the physical solution inside the element after the spurious limiting action. It is no longer constant, demonstrating the error introduced by the limiter.", "answer": "$$\\boxed{\\frac{u_{0}}{1 + 2 \\alpha \\, \\xi}}$$", "id": "3414596"}]}