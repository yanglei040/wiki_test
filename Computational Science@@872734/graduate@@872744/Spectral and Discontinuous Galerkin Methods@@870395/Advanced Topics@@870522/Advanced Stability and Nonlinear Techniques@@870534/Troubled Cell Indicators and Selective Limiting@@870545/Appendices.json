{"hands_on_practices": [{"introduction": "We begin by exploring one of the most intuitive ways to detect numerical trouble: monitoring jumps across cell boundaries. The Krivodonova-Xin-Roe-Chang-Friedrichs (KXRCF) indicator formalizes this idea by quantifying the jump at an element's inflow face, providing a robust method for flagging discontinuities like shock waves. This exercise [@problem_id:3425734] provides a foundational calculation of the KXRCF indicator for a classic Riemann problem, illustrating how the indicator's value is directly tied to the strength of the discontinuity entering a cell.", "problem": "Consider the scalar conservation law given by Burgers’ equation, $u_{t} + \\partial_{x}\\!\\left(\\frac{u^{2}}{2}\\right) = 0$, posed on the spatial domain $[-1,1]$ with a two-element partition $K_{L} = [-1,0]$ and $K_{R} = [0,1]$. The initial condition is a Riemann datum,\n$$\nu(x,0) = \\begin{cases}\nu_{L}, & x < 0, \\\\\nu_{R}, & x > 0,\n\\end{cases}\n$$\nwith $u_{L} = -2$ and $u_{R} = 1$. On each element, a discontinuous Galerkin (DG) polynomial reconstruction of degree $p=2$ is obtained by the $L^{2}$ projection of the initial data onto an orthonormal Legendre basis mapped from the reference interval $[-1,1]$. Denote the resulting piecewise polynomial by $u_{h}(x,0^{+})$.\n\nFor selective limiting, use the Krivodonova-Xin-Roe-Chang-Friedrichs (KXRCF) troubled-cell indicator defined here, for a scalar law in one dimension, as the inflow-jump indicator normalized by the element $L^{2}$ norm:\n$$\n\\mathcal{I}_{K} \\equiv \\frac{\\left| \\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}} \\right|}{\\| u_{h} \\|_{L^{2}(K)}},\n$$\nwhere $\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}}$ is the jump across the inflow face $F_{\\mathrm{in}}$ of element $K$, taken as the exterior trace minus the interior trace on that face, and $\\| u_{h} \\|_{L^{2}(K)}$ is the $L^{2}$ norm of $u_{h}$ over element $K$. The inflow face is determined by the sign of the linearized characteristic speed $a(u) = f'(u) = u$ evaluated at the element-mean of $u_{h}$: the left face is inflow if $a(u)>0$, and the right face is inflow if $a(u)<0$.\n\nUsing the projected initial data $u_{h}(x,0^{+})$ and the above definition, compute the KXRCF indicators $\\mathcal{I}_{K_{L}}$ and $\\mathcal{I}_{K_{R}}$ at $t=0^{+}$ in the two elements adjacent to the discontinuity at $x=0$. Provide your final answer as an ordered pair $(\\mathcal{I}_{K_{L}}, \\mathcal{I}_{K_{R}})$ formatted as a row matrix. No rounding is required.", "solution": "The user has provided a problem statement that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Conservation Law**: Scalar Burgers' equation, $u_{t} + \\partial_{x}\\!\\left(\\frac{u^{2}}{2}\\right) = 0$.\n- **Spatial Domain**: $[-1,1]$.\n- **Domain Partition**: Two elements, $K_{L} = [-1,0]$ and $K_{R} = [0,1]$.\n- **Initial Condition**: A Riemann problem, $u(x,0) = \\begin{cases} u_{L}, & x < 0, \\\\ u_{R}, & x > 0, \\end{cases}$ with constant states $u_{L} = -2$ and $u_{R} = 1$.\n- **Numerical Method**: Discontinuous Galerkin (DG) with polynomial degree $p=2$.\n- **Initial Approximation**: $u_{h}(x,0^{+})$ is the $L^{2}$ projection of the initial data $u(x,0)$ onto the space of piecewise quadratic polynomials on the partition. The basis is an orthonormal Legendre basis mapped from the reference interval $[-1,1]$.\n- **Troubled-Cell Indicator**: The Krivodonova-Xin-Roe-Chang-Friedrichs (KXRCF) indicator, defined for an element $K$ as $\\mathcal{I}_{K} \\equiv \\frac{\\left| \\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}} \\right|}{\\| u_{h} \\|_{L^{2}(K)}}$.\n- **Jump Definition**: $\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}}$ is the jump at the inflow face $F_{\\mathrm{in}}$, calculated as the exterior trace minus the interior trace.\n- **Inflow Face Definition**: For Burgers' equation, the characteristic speed is $a(u) = f'(u) = u$. The inflow face for element $K$ is determined by the sign of $a(\\bar{u}_{K})$, where $\\bar{u}_{K}$ is the element-mean of $u_{h}$. If $a(\\bar{u}_{K})>0$, the left face is inflow. If $a(\\bar{u}_{K})<0$, the right face is inflow.\n- **Objective**: Compute the indicators $(\\mathcal{I}_{K_{L}}, \\mathcal{I}_{K_{R}})$ at time $t=0^{+}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It describes a standard procedure in the field of numerical methods for partial differential equations, specifically for shock-capturing in discontinuous Galerkin schemes.\n- **Scientific Grounding**: Burgers' equation is a fundamental model in fluid dynamics. The DG method, $L^{2}$ projection, and KXRCF indicator are all well-established concepts in computational science.\n- **Well-Posedness**: The problem is clearly defined and provides all necessary information to compute the requested quantities uniquely.\n- **Objectivity**: The problem is stated in precise, objective mathematical language.\n- **Completeness and Consistency**: All required data (PDE, initial conditions, discretization parameters, and definitions) are provided and are internally consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe objective is to compute the KXRCF indicators $\\mathcal{I}_{K_{L}}$ and $\\mathcal{I}_{K_{R}}$ for the two elements $K_{L}=[-1,0]$ and $K_{R}=[0,1]$.\n\n**1. Determine the Initial DG Solution $u_{h}(x,0^{+})$**\n\nThe initial DG solution $u_{h}(x,0^{+})$ is the $L^{2}$ projection of the exact initial data $u(x,0)$ onto the space of piecewise polynomials of degree $p=2$. Let $V_h$ be this space. For any element $K$ in the partition, the restriction of $u(x,0)$ to $K$ is a constant function.\n- On $K_{L} = [-1,0]$, the initial data is $u(x,0) = u_{L} = -2$.\n- On $K_{R} = [0,1]$, the initial data is $u(x,0) = u_{R} = 1$.\n\nA constant function is a polynomial of degree $0$. Since the approximation space on each element consists of polynomials up to degree $p=2$, the initial data on each element, being a polynomial of degree $0$, already lies within the approximation space. The $L^{2}$ projection of a function onto a space that already contains the function is the function itself.\nTherefore, the projected initial solution $u_{h}(x,0^{+})$ is identical to the piecewise constant initial data:\n$$\nu_{h}(x,0^{+}) = \\begin{cases}\n-2, & x \\in (-1,0), \\\\\n1, & x \\in (0,1).\n\\end{cases}\n$$\n\n**2. Compute the Denominator: $\\| u_{h} \\|_{L^{2}(K)}$**\n\nWe compute the $L^{2}$ norm of $u_{h}$ on each element.\n- For element $K_{L} = [-1,0]$:\n$$\n\\| u_{h} \\|_{L^{2}(K_{L})}^{2} = \\int_{-1}^{0} (u_{h}(x,0^{+}))^{2} dx = \\int_{-1}^{0} (-2)^{2} dx = \\int_{-1}^{0} 4 dx = 4 [x]_{-1}^{0} = 4(0 - (-1)) = 4.\n$$\nThus, $\\| u_{h} \\|_{L^{2}(K_{L})} = \\sqrt{4} = 2$.\n\n- For element $K_{R} = [0,1]$:\n$$\n\\| u_{h} \\|_{L^{2}(K_{R})}^{2} = \\int_{0}^{1} (u_{h}(x,0^{+}))^{2} dx = \\int_{0}^{1} (1)^{2} dx = \\int_{0}^{1} 1 dx = [x]_{0}^{1} = 1 - 0 = 1.\n$$\nThus, $\\| u_{h} \\|_{L^{2}(K_{R})} = \\sqrt{1} = 1$.\n\n**3. Compute the Numerator: $|\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}}| $**\n\nWe must first identify the inflow face $F_{\\mathrm{in}}$ for each element. This depends on the sign of the characteristic speed $a(u)=u$ evaluated at the element-mean state $\\bar{u}_{K}$.\n\n- **For element $K_{L} = [-1,0]$**:\nThe element-mean is:\n$$\n\\bar{u}_{K_{L}} = \\frac{1}{\\text{meas}(K_{L})} \\int_{-1}^{0} u_{h}(x,0^{+}) dx = \\frac{1}{1} \\int_{-1}^{0} (-2) dx = -2.\n$$\nThe characteristic speed is $a(\\bar{u}_{K_{L}}) = \\bar{u}_{K_{L}} = -2$. Since $a<0$, the right face of the element is the inflow face. So, $F_{\\mathrm{in}} = \\{x=0\\}$.\nThe jump is defined as $\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}} = u_{h}^{\\text{ext}} - u_{h}^{\\text{int}}$. At the face $x=0$ of element $K_L$:\n- The interior trace is the value from within $K_{L}$: $u_{h}^{\\text{int}} = u_{h}(0^{-}, 0^{+}) = -2$.\n- The exterior trace is the value from the neighboring element $K_{R}$: $u_{h}^{\\text{ext}} = u_{h}(0^{+}, 0^{+}) = 1$.\nThe jump is $\\llbracket u_{h} \\rrbracket_{x=0} = 1 - (-2) = 3$. The numerator is $|\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}}| = |3| = 3$.\n\n- **For element $K_{R} = [0,1]$**:\nThe element-mean is:\n$$\n\\bar{u}_{K_{R}} = \\frac{1}{\\text{meas}(K_{R})} \\int_{0}^{1} u_{h}(x,0^{+}) dx = \\frac{1}{1} \\int_{0}^{1} 1 dx = 1.\n$$\nThe characteristic speed is $a(\\bar{u}_{K_{R}}) = \\bar{u}_{K_{R}} = 1$. Since $a>0$, the left face of the element is the inflow face. So, $F_{\\mathrm{in}} = \\{x=0\\}$.\nThe jump is defined as $\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}} = u_{h}^{\\text{ext}} - u_{h}^{\\text{int}}$. At the face $x=0$ of element $K_R$:\n- The interior trace is the value from within $K_{R}$: $u_{h}^{\\text{int}} = u_{h}(0^{+}, 0^{+}) = 1$.\n- The exterior trace is the value from the neighboring element $K_{L}$: $u_{h}^{\\text{ext}} = u_{h}(0^{-}, 0^{+}) = -2$.\nThe jump is $\\llbracket u_{h} \\rrbracket_{x=0} = -2 - 1 = -3$. The numerator is $|\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}}| = |-3| = 3$.\n\n**4. Compute the KXRCF Indicators**\n\nNow we combine the numerators and denominators.\n- For element $K_{L}$:\n$$\n\\mathcal{I}_{K_{L}} = \\frac{|\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}}|}{\\| u_{h} \\|_{L^{2}(K_{L})}} = \\frac{3}{2}.\n$$\n\n- For element $K_{R}$:\n$$\n\\mathcal{I}_{K_{R}} = \\frac{|\\llbracket u_{h} \\rrbracket_{F_{\\mathrm{in}}}|}{\\| u_{h} \\|_{L^{2}(K_{R})}} = \\frac{3}{1} = 3.\n$$\n\nThe final answer is the ordered pair $(\\mathcal{I}_{K_{L}}, \\mathcal{I}_{K_{R}})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2} & 3 \\end{pmatrix}}\n$$", "id": "3425734"}, {"introduction": "Moving from interface-based detection, we now turn to indicators that assess the solution's quality *within* a cell. Spectral decay indicators, like the one pioneered by Persson and Peraire, measure how well a solution is represented by its polynomial basis by comparing the energy in high-frequency modes to the total energy. This practice [@problem_id:3425756] delves into the behavior of such an indicator for a smooth but sharp gradient, revealing through asymptotic analysis how it can be tuned to detect features that are not yet shocks but may still corrupt a high-order solution.", "problem": "Consider a one-dimensional Discontinuous Galerkin (DG) element $K=[-h/2,h/2]$ centered at $x=0$, using a polynomial approximation of degree $p=3$ in a Legendre polynomial modal basis. Map $K$ to the reference interval via $x=(h/2)\\,\\xi$ with $\\xi\\in[-1,1]$. Let the exact solution on $K$ be the smooth internal layer\n$$\nu(x)=\\tanh(\\alpha x),\n$$\nand denote $\\beta=\\alpha h/2$. Let $\\{P_n(\\xi)\\}_{n=0}^{3}$ be the Legendre polynomials on $[-1,1]$. Define the modal coefficients of the $L^2$-projection of $u$ onto $\\mathrm{span}\\{P_0,P_1,P_2,P_3\\}$ by\n$$\na_n=\\frac{2n+1}{2}\\int_{-1}^{1} u\\big((h/2)\\,\\xi\\big)\\,P_n(\\xi)\\,d\\xi,\\quad n=0,1,2,3.\n$$\nAdopt a Persson–Peraire-type spectral decay indicator with selective activation that is robust to parity by aggregating the top two modes:\n$$\ns_K=\\ln\\!\\left(\\frac{a_2^2+a_3^2}{a_0^2+a_1^2+a_2^2+a_3^2}\\right).\n$$\nIn a selective limiting strategy, limiting on $K$ is activated if and only if $s_K > \\ln(\\varepsilon)$ for a prescribed tolerance $\\varepsilon$.\n\nUsing only the orthogonality of Legendre polynomials, known analytic properties of $\\tanh$, and asymptotic expansions valid for small and large $\\beta$, do the following:\n\n1. Derive the small-$\\beta$ asymptotics of $s_K(\\beta)$ to leading order.\n2. Derive the large-$\\beta$ asymptotics of $s_K(\\beta)$ to leading order by relating $\\tanh(\\beta\\xi)$ to its pointwise limit as $\\beta\\to\\infty$ and projecting onto the same modal basis.\n3. Using the small-$\\beta$ asymptotics, determine the leading-order critical value $(\\alpha h)_c$ such that $s_K(\\beta)$ crosses the activation threshold $s_K=\\ln(\\varepsilon)$, i.e., limiting is activated for $\\alpha h>(\\alpha h)_c$ and not activated for $\\alpha h<(\\alpha h)_c$.\n\nAssume the threshold parameter is $\\varepsilon=10^{-4}$. Your final answer must be a single closed-form analytic expression for $(\\alpha h)_c$ with no units. Do not round; provide the exact expression.", "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Discontinuous Galerkin (DG) Element:** $K = [-h/2, h/2]$, centered at $x=0$.\n- **Polynomial Approximation Degree:** $p=3$.\n- **Basis:** Legendre polynomial modal basis on $[-1, 1]$, $\\{P_n(\\xi)\\}_{n=0}^{3}$.\n- **Mapping to Reference Interval:** $x = (h/2)\\xi$ for $\\xi \\in [-1, 1]$.\n- **Exact Solution:** $u(x) = \\tanh(\\alpha x)$.\n- **Parameter:** $\\beta = \\alpha h / 2$.\n- **Modal Coefficients:** $a_n = \\frac{2n+1}{2} \\int_{-1}^{1} u((h/2)\\xi) P_n(\\xi) d\\xi$, for $n=0, 1, 2, 3$.\n- **Spectral Decay Indicator:** $s_K = \\ln\\left(\\frac{a_2^2 + a_3^2}{a_0^2 + a_1^2 + a_2^2 + a_3^2}\\right)$.\n- **Limiting Activation Condition:** $s_K > \\ln(\\varepsilon)$.\n- **Threshold Parameter:** $\\varepsilon = 10^{-4}$.\n- **Tasks:**\n    1. Derive the small-$\\beta$ asymptotics of $s_K(\\beta)$ to leading order.\n    2. Derive the large-$\\beta$ asymptotics of $s_K(\\beta)$ to leading order.\n    3. Determine the leading-order critical value $(\\alpha h)_c$ using the small-$\\beta$ result.\n- **Constraints:** Use only orthogonality of Legendre polynomials, analytic properties of $\\tanh$, and asymptotic expansions.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly rooted in the field of numerical analysis for partial differential equations, specifically concerning spectral and Discontinuous Galerkin methods. The use of Legendre polynomials, $L^2$-projections, and spectral decay indicators for troubled-cell detection (like the Persson-Peraire indicator) are standard concepts. The function $\\tanh(\\alpha x)$ is a canonical representation of a smooth layer.\n- **Well-Posedness:** The problem is mathematically well-defined. All variables, functions, and objectives are specified with precision. The tasks lead to a unique and meaningful solution.\n- **Objectivity:** The problem statement is objective and devoid of any subjective or ambiguous language.\n- **Completeness and Consistency:** The problem is self-contained. All necessary information (definitions, constants, conditions) is provided. There are no contradictions in the setup.\n- **Realism and Feasibility:** The problem describes a standard theoretical analysis exercise in the development or study of numerical methods. The calculations required are feasible.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Solution\n\nThe solution is derived in three parts as requested. First, we note a crucial property stemming from parity. The function to be projected is $u((h/2)\\xi) = \\tanh(\\alpha (h/2) \\xi) = \\tanh(\\beta \\xi)$. This is an odd function of $\\xi$ because $\\tanh(-y) = -\\tanh(y)$. The Legendre polynomials $P_n(\\xi)$ are even functions for even $n$ and odd functions for odd $n$. The integral of an odd function over a symmetric interval like $[-1, 1]$ is zero.\n\nThe modal coefficients are given by $a_n = \\frac{2n+1}{2} \\int_{-1}^{1} \\tanh(\\beta \\xi) P_n(\\xi) d\\xi$.\nFor $n=0$ and $n=2$, the polynomials $P_0(\\xi)=1$ and $P_2(\\xi)=\\frac{1}{2}(3\\xi^2-1)$ are even. Therefore, the integrand $\\tanh(\\beta \\xi) P_n(\\xi)$ is an odd function for $n=0, 2$. Consequently, the integral over $[-1, 1]$ is zero.\n$$ a_0 = 0, \\quad a_2 = 0 $$\nThis holds for all values of $\\beta$. The indicator $s_K$ simplifies to:\n$$ s_K = \\ln\\left(\\frac{a_3^2}{a_1^2 + a_3^2}\\right) $$\n\n**1. Small-$\\beta$ Asymptotics of $s_K(\\beta)$**\n\nFor small values of its argument $y$, the Taylor expansion of $\\tanh(y)$ is $\\tanh(y) = y - \\frac{1}{3}y^3 + O(y^5)$. Thus, for small $\\beta$:\n$$ \\tanh(\\beta \\xi) \\approx \\beta \\xi - \\frac{1}{3}(\\beta \\xi)^3 = \\beta \\xi - \\frac{\\beta^3}{3}\\xi^3 $$\nTo find the coefficients $a_1$ and $a_3$, we project this polynomial onto the Legendre basis. We use the relations:\n$$ P_1(\\xi) = \\xi $$\n$$ P_3(\\xi) = \\frac{1}{2}(5\\xi^3 - 3\\xi) \\implies \\xi^3 = \\frac{2}{5}P_3(\\xi) + \\frac{3}{5}\\xi = \\frac{2}{5}P_3(\\xi) + \\frac{3}{5}P_1(\\xi) $$\nSubstituting these into the expansion for $\\tanh(\\beta \\xi)$:\n$$ \\tanh(\\beta \\xi) \\approx \\beta P_1(\\xi) - \\frac{\\beta^3}{3}\\left(\\frac{2}{5}P_3(\\xi) + \\frac{3}{5}P_1(\\xi)\\right) $$\n$$ \\tanh(\\beta \\xi) \\approx \\left(\\beta - \\frac{\\beta^3}{5}\\right)P_1(\\xi) - \\frac{2\\beta^3}{15}P_3(\\xi) $$\nThe modal coefficients $a_n$ are precisely the coefficients in the Legendre series expansion. Thus, for small $\\beta$:\n$$ a_1 \\approx \\beta - \\frac{\\beta^3}{5} \\implies a_1 = \\beta + O(\\beta^3) $$\n$$ a_3 \\approx -\\frac{2\\beta^3}{15} $$\nTo find the leading-order behavior of $s_K$, we use the leading-order terms of the coefficients: $a_1 \\approx \\beta$ and $a_3 \\approx -2\\beta^3/15$.\n$$ s_K(\\beta) \\approx \\ln\\left(\\frac{(-\\frac{2\\beta^3}{15})^2}{(\\beta)^2 + (-\\frac{2\\beta^3}{15})^2}\\right) = \\ln\\left(\\frac{\\frac{4\\beta^6}{225}}{\\beta^2 + \\frac{4\\beta^6}{225}}\\right) $$\nIn the denominator, for small $\\beta$, $\\beta^2$ is the dominant term.\n$$ s_K(\\beta) \\approx \\ln\\left(\\frac{\\frac{4\\beta^6}{225}}{\\beta^2}\\right) = \\ln\\left(\\frac{4\\beta^4}{225}\\right) $$\nThis is the leading-order small-$\\beta$ asymptotic behavior of $s_K$.\n\n**2. Large-$\\beta$ Asymptotics of $s_K(\\beta)$**\n\nAs $\\beta \\to \\infty$, the function $\\tanh(\\beta \\xi)$ approaches the sign function pointwise for $\\xi \\neq 0$:\n$$ \\lim_{\\beta\\to\\infty} \\tanh(\\beta \\xi) = \\text{sgn}(\\xi) = \\begin{cases} 1 & \\xi > 0 \\\\ 0 & \\xi = 0 \\\\ -1 & \\xi < 0 \\end{cases} $$\nThe asymptotic coefficients, denoted $a_n^{(\\infty)}$, are found by projecting $\\text{sgn}(\\xi)$ onto the Legendre basis. As before, $a_0^{(\\infty)}=a_2^{(\\infty)}=0$ due to parity.\nFor $a_1^{(\\infty)}$:\n$$ a_1^{(\\infty)} = \\frac{3}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)P_1(\\xi)d\\xi = \\frac{3}{2}\\int_{-1}^{1} \\xi\\,\\text{sgn}(\\xi)d\\xi = \\frac{3}{2}\\int_{-1}^{1} |\\xi|d\\xi = \\frac{3}{2} \\left( 2\\int_{0}^{1} \\xi d\\xi \\right) = 3\\left[\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{3}{2} $$\nFor $a_3^{(\\infty)}$:\n$$ a_3^{(\\infty)} = \\frac{7}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)P_3(\\xi)d\\xi = \\frac{7}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)\\frac{1}{2}(5\\xi^3 - 3\\xi)d\\xi $$\nThe integrand is an even function, so we can write:\n$$ a_3^{(\\infty)} = \\frac{7}{2} \\cdot 2 \\int_{0}^{1} \\frac{1}{2}(5\\xi^3 - 3\\xi)d\\xi = \\frac{7}{2}\\left[5\\frac{\\xi^4}{4} - 3\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{7}{2}\\left(\\frac{5}{4}-\\frac{3}{2}\\right) = \\frac{7}{2}\\left(-\\frac{1}{4}\\right) = -\\frac{7}{8} $$\nThe large-$\\beta$ limit of the indicator is:\n$$ s_K^{(\\infty)} = \\ln\\left(\\frac{(a_3^{(\\infty)})^2}{(a_1^{(\\infty)})^2 + (a_3^{(\\infty)})^2}\\right) = \\ln\\left(\\frac{(-\\frac{7}{8})^2}{(\\frac{3}{2})^2 + (-\\frac{7}{8})^2}\\right) = \\ln\\left(\\frac{\\frac{49}{64}}{\\frac{9}{4} + \\frac{49}{64}}\\right) $$\n$$ s_K^{(\\infty)} = \\ln\\left(\\frac{\\frac{49}{64}}{\\frac{144}{64} + \\frac{49}{64}}\\right) = \\ln\\left(\\frac{49}{193}\\right) $$\n\n**3. Critical Value $(\\alpha h)_c$**\n\nThe limiting procedure is activated when $s_K > \\ln(\\varepsilon)$. The critical value corresponds to the threshold $s_K = \\ln(\\varepsilon)$. We use the small-$\\beta$ asymptotics derived in Part 1, as the threshold $\\varepsilon = 10^{-4}$ results in a large negative value for $\\ln(\\varepsilon)$, which is attained for small $\\beta$.\n$$ \\ln\\left(\\frac{4\\beta^4}{225}\\right) = \\ln(\\varepsilon) $$\nTaking the exponential of both sides:\n$$ \\frac{4\\beta^4}{225} = \\varepsilon $$\nSolving for the critical value $\\beta_c$:\n$$ \\beta_c^4 = \\frac{225}{4}\\varepsilon \\implies \\beta_c = \\left(\\frac{225\\varepsilon}{4}\\right)^{1/4} $$\nThe critical value is expressed in terms of $(\\alpha h)_c = 2\\beta_c$:\n$$ (\\alpha h)_c = 2 \\left(\\frac{15^2 \\varepsilon}{2^2}\\right)^{1/4} = 2 \\left(\\frac{15}{2}\\right)^{2/4} \\varepsilon^{1/4} = 2 \\left(\\frac{15}{2}\\right)^{1/2} \\varepsilon^{1/4} = 2 \\frac{\\sqrt{15}}{\\sqrt{2}} \\varepsilon^{1/4} = \\sqrt{2}\\sqrt{15}\\varepsilon^{1/4} = \\sqrt{30}\\varepsilon^{1/4} $$\nSubstituting the given value $\\varepsilon = 10^{-4}$:\n$$ (\\alpha h)_c = \\sqrt{30}(10^{-4})^{1/4} = \\sqrt{30} \\times 10^{-1} = \\frac{\\sqrt{30}}{10} $$\nThis is the final analytical expression for the critical value.", "answer": "$$\\boxed{\\frac{\\sqrt{30}}{10}}$$", "id": "3425756"}, {"introduction": "When applying troubled-cell indicators to systems of conservation laws, such as the Euler equations of gas dynamics, a critical question arises: which physical variable should we monitor? The choice of variable—be it density, pressure, or entropy—can dramatically affect the indicator's selectivity and physical consistency. This exercise [@problem_id:3425758] provides a concrete comparison, challenging you to evaluate the performance of a spectral indicator on different variables for a blast wave problem and to identify which choice leads to the most accurate and efficient application of limiting.", "problem": "A one-dimensional Euler blast wave snapshot is represented in a Discontinuous Galerkin (DG) discretization of polynomial degree $p=2$ on three contiguous elements $E \\in \\{1,2,3\\}$. For three scalar variable sets—density $\\rho$, pressure $p$, and mathematical entropy $s=\\ln(p)-\\gamma \\ln(\\rho)$ with $\\gamma=1.4$—you are given the degree-$2$ modal coefficients of the DG polynomial in each element in an $L^{2}$-orthonormal Legendre basis on the reference element. Denote the modal coefficients by $\\{\\hat{v}_{k}^{(E)}\\}_{k=0}^{2}$ for variable $v \\in \\{\\rho,p,s\\}$. The troubled-cell indicator to be used is the Persson–Peraire high-mode content indicator:\n$$\nI_{E}^{(v)} \\;=\\; \\ln\\!\\left(\\frac{\\left(\\hat{v}_{2}^{(E)}\\right)^{2}}{\\sum_{k=0}^{2}\\left(\\hat{v}_{k}^{(E)}\\right)^{2}}\\right).\n$$\nA cell $E$ is flagged as troubled for variable $v$ if $I_{E}^{(v)} > \\tau$ with threshold $\\tau=-4.5$. The physically consistent target set of cells that genuinely require limiting for this snapshot is $\\mathcal{T}=\\{3\\}$.\n\nThe variable-specific modal coefficients are as follows (each number is a coefficient in the orthonormal Legendre basis):\n\n- For density $v=\\rho$:\n  - $E=1$: $\\left(\\hat{\\rho}_{0}^{(1)},\\hat{\\rho}_{1}^{(1)},\\hat{\\rho}_{2}^{(1)}\\right)=(1.0,\\,0.02,\\,0.01)$.\n  - $E=2$: $\\left(\\hat{\\rho}_{0}^{(2)},\\hat{\\rho}_{1}^{(2)},\\hat{\\rho}_{2}^{(2)}\\right)=(1.1,\\,0.05,\\,0.3)$.\n  - $E=3$: $\\left(\\hat{\\rho}_{0}^{(3)},\\hat{\\rho}_{1}^{(3)},\\hat{\\rho}_{2}^{(3)}\\right)=(3.0,\\,0.5,\\,0.4)$.\n\n- For pressure $v=p$:\n  - $E=1$: $\\left(\\hat{p}_{0}^{(1)},\\hat{p}_{1}^{(1)},\\hat{p}_{2}^{(1)}\\right)=(1.0,\\,0.3,\\,0.2)$.\n  - $E=2$: $\\left(\\hat{p}_{0}^{(2)},\\hat{p}_{1}^{(2)},\\hat{p}_{2}^{(2)}\\right)=(1.05,\\,0.25,\\,0.15)$.\n  - $E=3$: $\\left(\\hat{p}_{0}^{(3)},\\hat{p}_{1}^{(3)},\\hat{p}_{2}^{(3)}\\right)=(2.0,\\,0.6,\\,0.4)$.\n\n- For entropy $v=s$:\n  - $E=1$: $\\left(\\hat{s}_{0}^{(1)},\\hat{s}_{1}^{(1)},\\hat{s}_{2}^{(1)}\\right)=(0.2,\\,0.01,\\,0.001)$.\n  - $E=2$: $\\left(\\hat{s}_{0}^{(2)},\\hat{s}_{1}^{(2)},\\hat{s}_{2}^{(2)}\\right)=(0.25,\\,0.015,\\,0.0015)$.\n  - $E=3$: $\\left(\\hat{s}_{0}^{(3)},\\hat{s}_{1}^{(3)},\\hat{s}_{2}^{(3)}\\right)=(0.9,\\,0.2,\\,0.12)$.\n\nDefine the selectivity and physical consistency score for each variable set $v$ by\n$$\nC(v) \\;=\\; 3\\,N_{\\mathrm{FN}}(v) \\;+\\; N_{\\mathrm{FP}}(v),\n$$\nwhere $N_{\\mathrm{FN}}(v)$ is the number of false negatives (cells in $\\mathcal{T}$ not flagged for $v$) and $N_{\\mathrm{FP}}(v)$ is the number of false positives (cells flagged for $v$ but not in $\\mathcal{T}$). A lower score indicates more selective and physically consistent limiting.\n\nCompute $I_{E}^{(v)}$ for all $v \\in \\{\\rho,p,s\\}$ and $E \\in \\{1,2,3\\}$, determine the flagged cells for each $v$ using the threshold $\\tau=-4.5$, evaluate $C(v)$, and decide which variable set minimizes $C(v)$. Report your final choice by the code: $\\rho \\mapsto 1$, $p \\mapsto 2$, $s \\mapsto 3$. The final answer must be this single integer code. No rounding is required and no units are involved.", "solution": "The user has provided a problem concerning the selection of an optimal variable for a troubled-cell indicator in a Discontinuous Galerkin (DG) simulation. The problem is well-posed, scientifically grounded in the field of numerical methods for conservation laws, and provides all necessary data for a unique solution. I will proceed with the required calculations.\n\nThe core of the problem is to evaluate the Persson–Peraire indicator for three different variables—density ($\\rho$), pressure ($p$), and entropy ($s$)—across three computational elements and determine which variable provides the most accurate set of \"troubled\" cells compared to a given ground truth.\n\nThe Persson–Peraire indicator for a variable $v$ in element $E$ is given by:\n$$\nI_{E}^{(v)} = \\ln\\left(\\frac{\\left(\\hat{v}_{2}^{(E)}\\right)^{2}}{\\sum_{k=0}^{2}\\left(\\hat{v}_{k}^{(E)}\\right)^{2}}\\right)\n$$\nwhere $\\{\\hat{v}_{k}^{(E)}\\}_{k=0}^{2}$ are the modal coefficients of the DG polynomial of degree $p=2$ in an orthonormal basis. An element $E$ is flagged as troubled if $I_{E}^{(v)} > \\tau$, where the threshold is given as $\\tau = -4.5$. The set of cells that are genuinely troubled is $\\mathcal{T}=\\{3\\}$.\n\nFor each variable $v$, we will identify the set of flagged cells $\\mathcal{F}^{(v)}$. We then compute the number of false negatives, $N_{\\mathrm{FN}}(v) = |\\mathcal{T} \\setminus \\mathcal{F}^{(v)}|$, and false positives, $N_{\\mathrm{FP}}(v) = |\\mathcal{F}^{(v)} \\setminus \\mathcal{T}|$. The performance is measured by the cost function $C(v) = 3 N_{\\mathrm{FN}}(v) + N_{\\mathrm{FP}}(v)$. The goal is to find the variable that minimizes $C(v)$.\n\nThe calculations for each variable are as follows:\n\n**1. Density Variable ($v=\\rho$)**\n\n*   **Element $E=1$**: Coefficients are $(\\hat{\\rho}_{0}^{(1)}, \\hat{\\rho}_{1}^{(1)}, \\hat{\\rho}_{2}^{(1)}) = (1.0, 0.02, 0.01)$.\n    $$\n    I_{1}^{(\\rho)} = \\ln\\left(\\frac{(0.01)^2}{(1.0)^2 + (0.02)^2 + (0.01)^2}\\right) = \\ln\\left(\\frac{0.0001}{1.0 + 0.0004 + 0.0001}\\right) = \\ln\\left(\\frac{0.0001}{1.0005}\\right) \\approx -9.2108\n    $$\n    Since $I_{1}^{(\\rho)} \\approx -9.2108 < -4.5$, element $1$ is not flagged.\n\n*   **Element $E=2$**: Coefficients are $(\\hat{\\rho}_{0}^{(2)}, \\hat{\\rho}_{1}^{(2)}, \\hat{\\rho}_{2}^{(2)}) = (1.1, 0.05, 0.3)$.\n    $$\n    I_{2}^{(\\rho)} = \\ln\\left(\\frac{(0.3)^2}{(1.1)^2 + (0.05)^2 + (0.3)^2}\\right) = \\ln\\left(\\frac{0.09}{1.21 + 0.0025 + 0.09}\\right) = \\ln\\left(\\frac{0.09}{1.3025}\\right) \\approx -2.6723\n    $$\n    Since $I_{2}^{(\\rho)} \\approx -2.6723 > -4.5$, element $2$ is flagged.\n\n*   **Element $E=3$**: Coefficients are $(\\hat{\\rho}_{0}^{(3)}, \\hat{\\rho}_{1}^{(3)}, \\hat{\\rho}_{2}^{(3)}) = (3.0, 0.5, 0.4)$.\n    $$\n    I_{3}^{(\\rho)} = \\ln\\left(\\frac{(0.4)^2}{(3.0)^2 + (0.5)^2 + (0.4)^2}\\right) = \\ln\\left(\\frac{0.16}{9.0 + 0.25 + 0.16}\\right) = \\ln\\left(\\frac{0.16}{9.41}\\right) \\approx -4.0743\n    $$\n    Since $I_{3}^{(\\rho)} \\approx -4.0743 > -4.5$, element $3$ is flagged.\n\nThe set of flagged cells for density is $\\mathcal{F}^{(\\rho)} = \\{2, 3\\}$.\n*   False Negatives ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(\\rho)} = \\{3\\} \\setminus \\{2, 3\\} = \\emptyset$. So, $N_{\\mathrm{FN}}(\\rho) = 0$.\n*   False Positives ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(\\rho)} \\setminus \\mathcal{T} = \\{2, 3\\} \\setminus \\{3\\} = \\{2\\}$. So, $N_{\\mathrm{FP}}(\\rho) = 1$.\n*   Cost for density: $C(\\rho) = 3 \\times 0 + 1 = 1$.\n\n**2. Pressure Variable ($v=p$)**\n\n*   **Element $E=1$**: Coefficients are $(\\hat{p}_{0}^{(1)}, \\hat{p}_{1}^{(1)}, \\hat{p}_{2}^{(1)}) = (1.0, 0.3, 0.2)$.\n    $$\n    I_{1}^{(p)} = \\ln\\left(\\frac{(0.2)^2}{(1.0)^2 + (0.3)^2 + (0.2)^2}\\right) = \\ln\\left(\\frac{0.04}{1.0 + 0.09 + 0.04}\\right) = \\ln\\left(\\frac{0.04}{1.13}\\right) \\approx -3.3414\n    $$\n    Since $I_{1}^{(p)} \\approx -3.3414 > -4.5$, element $1$ is flagged.\n\n*   **Element $E=2$**: Coefficients are $(\\hat{p}_{0}^{(2)}, \\hat{p}_{1}^{(2)}, \\hat{p}_{2}^{(2)}) = (1.05, 0.25, 0.15)$.\n    $$\n    I_{2}^{(p)} = \\ln\\left(\\frac{(0.15)^2}{(1.05)^2 + (0.25)^2 + (0.15)^2}\\right) = \\ln\\left(\\frac{0.0225}{1.1025 + 0.0625 + 0.0225}\\right) = \\ln\\left(\\frac{0.0225}{1.1875}\\right) \\approx -3.9655\n    $$\n    Since $I_{2}^{(p)} \\approx -3.9655 > -4.5$, element $2$ is flagged.\n\n*   **Element $E=3$**: Coefficients are $(\\hat{p}_{0}^{(3)}, \\hat{p}_{1}^{(3)}, \\hat{p}_{2}^{(3)}) = (2.0, 0.6, 0.4)$.\n    $$\n    I_{3}^{(p)} = \\ln\\left(\\frac{(0.4)^2}{(2.0)^2 + (0.6)^2 + (0.4)^2}\\right) = \\ln\\left(\\frac{0.16}{4.0 + 0.36 + 0.16}\\right) = \\ln\\left(\\frac{0.16}{4.52}\\right) \\approx -3.3414\n    $$\n    Since $I_{3}^{(p)} \\approx -3.3414 > -4.5$, element $3$ is flagged.\n\nThe set of flagged cells for pressure is $\\mathcal{F}^{(p)} = \\{1, 2, 3\\}$.\n*   False Negatives ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(p)} = \\{3\\} \\setminus \\{1, 2, 3\\} = \\emptyset$. So, $N_{\\mathrm{FN}}(p) = 0$.\n*   False Positives ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(p)} \\setminus \\mathcal{T} = \\{1, 2, 3\\} \\setminus \\{3\\} = \\{1, 2\\}$. So, $N_{\\mathrm{FP}}(p) = 2$.\n*   Cost for pressure: $C(p) = 3 \\times 0 + 2 = 2$.\n\n**3. Entropy Variable ($v=s$)**\n\n*   **Element $E=1$**: Coefficients are $(\\hat{s}_{0}^{(1)}, \\hat{s}_{1}^{(1)}, \\hat{s}_{2}^{(1)}) = (0.2, 0.01, 0.001)$.\n    $$\n    I_{1}^{(s)} = \\ln\\left(\\frac{(0.001)^2}{(0.2)^2 + (0.01)^2 + (0.001)^2}\\right) = \\ln\\left(\\frac{10^{-6}}{0.04 + 0.0001 + 10^{-6}}\\right) = \\ln\\left(\\frac{10^{-6}}{0.040101}\\right) \\approx -10.5991\n    $$\n    Since $I_{1}^{(s)} \\approx -10.5991 < -4.5$, element $1$ is not flagged.\n\n*   **Element $E=2$**: Coefficients are $(\\hat{s}_{0}^{(2)}, \\hat{s}_{1}^{(2)}, \\hat{s}_{2}^{(2)}) = (0.25, 0.015, 0.0015)$.\n    $$\n    I_{2}^{(s)} = \\ln\\left(\\frac{(0.0015)^2}{(0.25)^2 + (0.015)^2 + (0.0015)^2}\\right) = \\ln\\left(\\frac{2.25 \\times 10^{-6}}{0.0625 + 0.000225 + 2.25 \\times 10^{-6}}\\right) = \\ln\\left(\\frac{2.25 \\times 10^{-6}}{0.06272725}\\right) \\approx -10.2364\n    $$\n    Since $I_{2}^{(s)} \\approx -10.2364 < -4.5$, element $2$ is not flagged.\n\n*   **Element $E=3$**: Coefficients are $(\\hat{s}_{0}^{(3)}, \\hat{s}_{1}^{(3)}, \\hat{s}_{2}^{(3)}) = (0.9, 0.2, 0.12)$.\n    $$\n    I_{3}^{(s)} = \\ln\\left(\\frac{(0.12)^2}{(0.9)^2 + (0.2)^2 + (0.12)^2}\\right) = \\ln\\left(\\frac{0.0144}{0.81 + 0.04 + 0.0144}\\right) = \\ln\\left(\\frac{0.0144}{0.8644}\\right) \\approx -4.0954\n    $$\n    Since $I_{3}^{(s)} \\approx -4.0954 > -4.5$, element $3$ is flagged.\n\nThe set of flagged cells for entropy is $\\mathcal{F}^{(s)} = \\{3\\}$.\n*   False Negatives ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(s)} = \\{3\\} \\setminus \\{3\\} = \\emptyset$. So, $N_{\\mathrm{FN}}(s) = 0$.\n*   False Positives ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(s)} \\setminus \\mathcal{T} = \\{3\\} \\setminus \\{3\\} = \\emptyset$. So, $N_{\\mathrm{FP}}(s) = 0$.\n*   Cost for entropy: $C(s) = 3 \\times 0 + 0 = 0$.\n\n**Conclusion**\n\nComparing the costs for the three variables:\n*   $C(\\rho) = 1$\n*   $C(p) = 2$\n*   $C(s) = 0$\n\nThe minimum cost is $0$, achieved when using the entropy variable $s$. The problem specifies the final answer should be a code: $\\rho \\mapsto 1$, $p \\mapsto 2$, $s \\mapsto 3$. Since the optimal variable is $s$, the corresponding code is $3$.", "answer": "$$\\boxed{3}$$", "id": "3425758"}]}