{"hands_on_practices": [{"introduction": "The theoretical elegance of the Huygens' principle is realized in practice through its numerical implementation. This first exercise guides you through the foundational task of discretizing the Huygens boundary integral equation. By approximating the integral with a simple midpoint rule for a canonical 2D radiation problem, you will directly test the validity of the equivalence principle and quantify the convergence of the numerical solution towards the exact analytical field. [@problem_id:3314980]", "problem": "Consider the two-dimensional ($2$D) time-harmonic Transverse Magnetic (TM) polarization in free space, where the scalar electric field component $E_z$ obeys the scalar Helmholtz equation. Let $u(\\mathbf{r})$ denote the scalar field $E_z(\\mathbf{r})$ for a single-frequency solution with angular frequency $\\omega$ and free-space wavenumber $k$ (in radians per meter). In free space, $u(\\mathbf{r})$ satisfies the homogeneous Helmholtz equation $(\\nabla^2 + k^2) u(\\mathbf{r}) = 0$ in regions without sources, and the fundamental solution (the free-space Green's function) for the $2$D Helmholtz equation is the function\n$$\nG(\\mathbf{r}, \\mathbf{r}') = \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, \\lvert \\mathbf{r} - \\mathbf{r}' \\rvert \\big),\n$$\nwhere $H_\\nu^{(1)}$ is the Hankel function of the first kind and order $\\nu$, and $\\mathrm{i}$ denotes the imaginary unit. The Huygens equivalence principle expresses the field in the exterior of a closed contour $\\Gamma$ in terms of equivalent electric and magnetic source distributions on $\\Gamma$, which in the TM scalar setting reduce to a boundary integral representation involving the field and its normal derivative on $\\Gamma$.\n\nLet $\\Gamma$ be the circle of radius $a$ centered at the origin, parameterized by the angle $\\phi \\in [0, 2\\pi)$, with outward unit normal $\\hat{\\mathbf{n}}'(\\phi)$ pointing radially outward (into the exterior domain). Consider a point source located at the origin generating the exact field\n$$\nu(\\mathbf{r}) = \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, r\\big),\n$$\nwhere $r = \\lvert \\mathbf{r} \\rvert$. On the boundary $\\Gamma$, the field and its outward normal derivative are\n$$\nu(a) = \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, a\\big), \\quad \\frac{\\partial u}{\\partial n}\\bigg|_{r=a} = \\frac{\\mathrm{i}}{4} \\left(-k\\right) H_1^{(1)}\\!\\big(k \\, a\\big).\n$$\nThe scalar Huygens boundary integral representation for the exterior field at an observation point $\\mathbf{r}$ outside $\\Gamma$ is\n$$\nu(\\mathbf{r}) = \\int_{\\Gamma} \\left[ G(\\mathbf{r}, \\mathbf{r}') \\, \\frac{\\partial u(\\mathbf{r}')}{\\partial n'} - u(\\mathbf{r}') \\, \\frac{\\partial G(\\mathbf{r}, \\mathbf{r}')}{\\partial n'} \\right] \\, \\mathrm{d}s',\n$$\nwith $\\mathrm{d}s'$ the line element on $\\Gamma$, $\\hat{\\mathbf{n}}'$ the outward normal on $\\Gamma$, and\n$$\n\\frac{\\partial G(\\mathbf{r}, \\mathbf{r}')}{\\partial n'} = \\nabla' G(\\mathbf{r}, \\mathbf{r}') \\cdot \\hat{\\mathbf{n}}' = \\frac{\\mathrm{i} k}{4} H_1^{(1)}\\!\\big(k \\, R\\big) \\, \\left(\\hat{\\mathbf{n}}' \\cdot \\hat{\\mathbf{R}}\\right),\n$$\nwhere $R = \\lvert \\mathbf{r} - \\mathbf{r}' \\rvert$ and $\\hat{\\mathbf{R}} = (\\mathbf{r} - \\mathbf{r}')/R$. This representation embodies the equivalence principle: the exterior field is reproduced by equivalent sources on $\\Gamma$ that encode $u$ and its normal derivative.\n\nTask: Derive, implement, and test a numerical discretization of the Huygens surface integral on $\\Gamma$ using a uniform angular partition of $N$ panels and the midpoint rule. Specifically, parameterize $\\Gamma$ by $\\phi_m = \\left(m + \\frac{1}{2}\\right) \\Delta \\phi$ for $m \\in \\{0, 1, \\dots, N-1\\}$ with $\\Delta \\phi = \\frac{2\\pi}{N}$, source points $\\mathbf{r}'(\\phi_m) = a \\, [\\cos\\phi_m, \\sin\\phi_m]$, outward normals $\\hat{\\mathbf{n}}'(\\phi_m) = [\\cos\\phi_m, \\sin\\phi_m]$, and weights $w = a \\, \\Delta \\phi$. For an observation point specified in polar coordinates $(r_o, \\theta_o)$, compute the numerical approximation\n$$\nu_{\\mathrm{num}}(\\mathbf{r}_o) \\approx \\sum_{m=0}^{N-1} \\left[ G\\big(\\mathbf{r}_o, \\mathbf{r}'(\\phi_m)\\big) \\, \\frac{\\partial u}{\\partial n}\\bigg|_{r=a} - u(a) \\, \\frac{\\partial G\\big(\\mathbf{r}_o, \\mathbf{r}'(\\phi_m)\\big)}{\\partial n'} \\right] \\, w,\n$$\nand compare it to the exact field\n$$\nu_{\\mathrm{exact}}(\\mathbf{r}_o) = \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, r_o\\big).\n$$\nCompute the relative error\n$$\n\\varepsilon = \\frac{\\lvert u_{\\mathrm{num}}(\\mathbf{r}_o) - u_{\\mathrm{exact}}(\\mathbf{r}_o) \\rvert}{\\lvert u_{\\mathrm{exact}}(\\mathbf{r}_o) \\rvert}.\n$$\n\nUse the following test suite, with all distances in meters and angles in radians, and the wavenumber $k$ in radians per meter:\n- Test case $1$ (happy path): $k = 20$, $a = 0.5$, $N = 200$, $r_o = 1.2$, $\\theta_o = 0.7$.\n- Test case $2$ (coarse discretization boundary case): $k = 20$, $a = 0.5$, $N = 16$, $r_o = 1.2$, $\\theta_o = 0.7$.\n- Test case $3$ (near-boundary edge case): $k = 20$, $a = 0.5$, $N = 400$, $r_o = 0.55$, $\\theta_o = 1.3$.\n- Test case $4$ (far-field case): $k = 20$, $a = 0.5$, $N = 200$, $r_o = 3.0$, $\\theta_o = 2.1$.\n\nYour program must compute the relative error $\\varepsilon$ for each test case and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places (e.g., $[0.001234,0.056789,0.000001,0.012345]$). Angles must be interpreted in radians, and the wavenumber must be in radians per meter. The output is dimensionless. No input should be read; all parameters are hard-coded according to the test suite above.", "solution": "The problem requires the numerical verification of the Huygens’ equivalence principle for a two-dimensional time-harmonic scalar field in free space. The field is generated by a line source at the origin, and its value in the exterior of a circular boundary is to be computed using a boundary integral representation. This numerical result will be compared against the known analytical solution to quantify the accuracy of the midpoint rule discretization.\n\nThe scalar field $u(\\mathbf{r})$ satisfies the homogeneous Helmholtz equation, $(\\nabla^2 + k^2) u(\\mathbf{r}) = 0$, for an implicit time-dependence of $e^{-i\\omega t}$, where $k$ is the free-space wavenumber. The exact field produced by a line source at the origin is given by the free-space Green's function centered at the origin:\n$$\nu_{\\mathrm{exact}}(\\mathbf{r}) = \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, r\\big)\n$$\nwhere $r = \\lvert \\mathbf{r} \\rvert$, $H_0^{(1)}$ is the Hankel function of the first kind and zeroth order, and $\\mathrm{i}$ is the imaginary unit.\n\nAccording to the Huygens' principle, the field $u(\\mathbf{r})$ at any observation point $\\mathbf{r}$ in the domain exterior to a closed contour $\\Gamma$ can be reconstructed from the values of the field and its normal derivative on $\\Gamma$. For the two-dimensional scalar problem, this is expressed by the boundary integral equation:\n$$\nu(\\mathbf{r}) = \\int_{\\Gamma} \\left[ G(\\mathbf{r}, \\mathbf{r}') \\, \\frac{\\partial u(\\mathbf{r}')}{\\partial n'} - u(\\mathbf{r}') \\, \\frac{\\partial G(\\mathbf{r}, \\mathbf{r}')}{\\partial n'} \\right] \\, \\mathrm{d}s'\n$$\nHere, $\\mathbf{r}'$ is a point on the contour $\\Gamma$, $\\mathrm{d}s'$ is the differential arc length element, and $\\hat{\\mathbf{n}}'$ is the outward-pointing unit normal vector on $\\Gamma$. The kernel $G(\\mathbf{r}, \\mathbf{r}')$ is the free-space Green's function:\n$$\nG(\\mathbf{r}, \\mathbf{r}') = \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, \\lvert \\mathbf{r} - \\mathbf{r}' \\rvert \\big)\n$$\nThe gradient of $G$ with respect to the source coordinates $\\mathbf{r}'$ is $\\nabla' G(\\mathbf{r}, \\mathbf{r}') = \\frac{\\mathrm{d}G}{\\mathrm{d}R} \\nabla' R$. With $R=|\\mathbf{r}-\\mathbf{r}'|$, we have $\\nabla' R = \\frac{\\mathbf{r}' - \\mathbf{r}}{R}$. The derivative of the Green's function with respect to its argument $z=kR$ is $\\frac{\\mathrm{d}}{\\mathrm{d}z} \\left(\\frac{\\mathrm{i}}{4} H_0^{(1)}(z)\\right) = \\frac{-\\mathrm{i}k}{4}H_1^{(1)}(z)$. Therefore,\n$$\n\\nabla' G(\\mathbf{r}, \\mathbf{r}') = \\frac{-\\mathrm{i}k}{4} H_1^{(1)}(kR)\\frac{\\mathbf{r}' - \\mathbf{r}}{R}\n$$\nThe normal derivative of the Green's function is thus\n$$\n\\frac{\\partial G(\\mathbf{r}, \\mathbf{r}')}{\\partial n'} = \\nabla' G(\\mathbf{r}, \\mathbf{r}') \\cdot \\hat{\\mathbf{n}}' = \\frac{-\\mathrm{i}k}{4} H_1^{(1)}(kR)\\frac{(\\mathbf{r}' - \\mathbf{r})\\cdot\\hat{\\mathbf{n}}'}{R} = \\frac{\\mathrm{i}k}{4} H_1^{(1)}(kR)\\frac{(\\mathbf{r} - \\mathbf{r}')\\cdot\\hat{\\mathbf{n}}'}{R}\n$$\nThis expression matches the formula provided in the problem statement, where $\\hat{\\mathbf{R}} = (\\mathbf{r} - \\mathbf{r}')/R$.\n\nFor this problem, $\\Gamma$ is a circle of radius $a$ centered at the origin. The boundary data required by the integral equation are derived from the known analytical solution:\n$$\nu(\\mathbf{r}')\\big|_{r'=a} = u(a) = \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, a\\big)\n$$\n$$\n\\frac{\\partial u(\\mathbf{r}')}{\\partial n'}\\bigg|_{r'=a} = \\frac{\\partial u}{\\partial r'}\\bigg|_{r'=a} = \\frac{\\mathrm{d}}{\\mathrm{d}r'} \\left[ \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, r'\\big) \\right]_{r'=a} = \\frac{-\\mathrm{i} k}{4} H_1^{(1)}\\!\\big(k \\, a\\big)\n$$\n\nThe task is to approximate the boundary integral using the midpoint rule. We partition the circular contour $\\Gamma$ into $N$ uniform panels. The midpoint of the $m$-th panel is located at an angle $\\phi_m = (m + \\frac{1}{2})\\Delta\\phi$ for $m \\in \\{0, 1, \\dots, N-1\\}$, where $\\Delta\\phi = 2\\pi/N$. The coordinates of the source point are $\\mathbf{r}'_m = (a\\cos\\phi_m, a\\sin\\phi_m)$. The panel length is $w = a\\Delta\\phi$.\n\nThe numerical approximation of the integral becomes the sum:\n$$\nu_{\\mathrm{num}}(\\mathbf{r}_o) = \\sum_{m=0}^{N-1} \\left[ G(\\mathbf{r}_o, \\mathbf{r}'_m) \\left(\\frac{-\\mathrm{i} k}{4} H_1^{(1)}\\!\\big(k \\, a\\big)\\right) - \\left(\\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, a\\big)\\right) \\frac{\\partial G(\\mathbf{r}_o, \\mathbf{r}'_m)}{\\partial n'_m} \\right] w\n$$\nwhere $\\mathbf{r}_o$ is the observation point given in polar coordinates $(r_o, \\theta_o)$.\n\nFor the implementation, we evaluate the geometric terms for each panel $m$. The distance $R_m = \\lvert \\mathbf{r}_o - \\mathbf{r}'_m \\rvert$ is calculated using the law of cosines:\n$$\nR_m = \\sqrt{r_o^2 + a^2 - 2ar_o\\cos(\\theta_o - \\phi_m)}\n$$\nThe outward normal at $\\mathbf{r}'_m$ is $\\hat{\\mathbf{n}}'_m = (\\cos\\phi_m, \\sin\\phi_m)$. The dot product required for the Green's function derivative is $\\hat{\\mathbf{n}}'_m \\cdot \\hat{\\mathbf{R}}_m = (\\hat{\\mathbf{n}}'_m \\cdot (\\mathbf{r}_o - \\mathbf{r}'_m)) / R_m$. The numerator is:\n$$\n\\hat{\\mathbf{n}}'_m \\cdot (\\mathbf{r}_o - \\mathbf{r}'_m) = \\hat{\\mathbf{n}}'_m \\cdot \\mathbf{r}_o - \\hat{\\mathbf{n}}'_m \\cdot \\mathbf{r}'_m = r_o \\cos(\\theta_o - \\phi_m) - a\n$$\nThis gives the term needed for the normal derivative of the Green's function. By substituting these expressions into the summation, we calculate $u_{\\mathrm{num}}(\\mathbf{r}_o)$.\n\nThe final step is to compute the relative error $\\varepsilon$ by comparing the numerical result against the exact analytical solution at the observation point, $u_{\\mathrm{exact}}(\\mathbf{r}_o) = \\frac{\\mathrm{i}}{4} H_0^{(1)}\\!\\big(k \\, r_o\\big)$:\n$$\n\\varepsilon = \\frac{\\lvert u_{\\mathrm{num}}(\\mathbf{r}_o) - u_{\\mathrm{exact}}(\\mathbf{r}_o) \\rvert}{\\lvert u_{\\mathrm{exact}}(\\mathbf{r}_o) \\rvert}\n$$\nThe provided Python code implements this algorithm for each test case. It uses vectorized computations with `NumPy` for efficiency and `SciPy` for the required Hankel functions, $H_0^{(1)}$ and $H_1^{(1)}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special as sp\n\ndef compute_error(k, a, N, r_o, theta_o):\n    \"\"\"\n    Computes the relative error of the numerical Huygens integral\n    approximation for a given set of parameters.\n\n    Args:\n        k (float): Wavenumber in radians/meter.\n        a (float): Radius of the circular contour in meters.\n        N (int): Number of panels for numerical integration.\n        r_o (float): Radial coordinate of the observation point in meters.\n        theta_o (float): Angular coordinate of the observation point in radians.\n\n    Returns:\n        float: The computed relative error.\n    \"\"\"\n    # Numerical constants and discretization parameters\n    i_unit = 1j\n    delta_phi = 2.0 * np.pi / N\n    # Midpoint rule weight (panel arc length)\n    w = a * delta_phi\n\n    # Midpoint angles for all N panels (vectorized)\n    m = np.arange(N)\n    phi_m = (m + 0.5) * delta_phi\n\n    # Observation point in Cartesian coordinates\n    xo = r_o * np.cos(theta_o)\n    yo = r_o * np.sin(theta_o)\n\n    # Source points on the contour in Cartesian coordinates (vectorized)\n    xp_m = a * np.cos(phi_m)\n    yp_m = a * np.sin(phi_m)\n\n    # Distances R_m from each source point to the observation point (vectorized)\n    # Using law of cosines for robustness and simplicity\n    R_m = np.sqrt(r_o**2 + a**2 - 2 * a * r_o * np.cos(theta_o - phi_m))\n\n    # --- Pre-calculate boundary data on the contour r=a ---\n    # Field u(a) on the boundary\n    u_on_a = (i_unit / 4.0) * sp.hankel1(0, k * a)\n    # Normal derivative ∂u/∂n on the boundary\n    du_dn_on_a = (-i_unit * k / 4.0) * sp.hankel1(1, k * a)\n\n    # --- Evaluate kernels of the integral equation (vectorized) ---\n    # Green's function G(r_o, r'_m)\n    G_m = (i_unit / 4.0) * sp.hankel1(0, k * R_m)\n\n    # Dot product (n' · R_hat) for the normal derivative of the Green's function\n    ndotRhat_m = (r_o * np.cos(theta_o - phi_m) - a) / R_m\n    \n    # Normal derivative of Green's function ∂G(r_o, r'_m)/∂n'\n    dGdn_m = (i_unit * k / 4.0) * sp.hankel1(1, k * R_m) * ndotRhat_m\n\n    # --- Compute the numerical integral using the midpoint rule ---\n    # Evaluate the integrand for each panel (vectorized)\n    integrand = G_m * du_dn_on_a - u_on_a * dGdn_m\n    \n    # Sum over all panels and multiply by the panel weight\n    u_num = np.sum(integrand) * w\n\n    # --- Compute the exact solution ---\n    u_exact = (i_unit / 4.0) * sp.hankel1(0, k * r_o)\n\n    # --- Compute the relative error ---\n    relative_error = np.abs(u_num - u_exact) / np.abs(u_exact)\n    \n    return relative_error\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # (k, a, N, r_o, theta_o)\n    test_cases = [\n        (20.0, 0.5, 200, 1.2, 0.7),\n        (20.0, 0.5, 16, 1.2, 0.7),\n        (20.0, 0.5, 400, 0.55, 1.3),\n        (20.0, 0.5, 200, 3.0, 2.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        k, a, N, r_o, theta_o = case\n        error = compute_error(k, a, N, r_o, theta_o)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    # Each value is formatted to six decimal places.\n    print(f\"[{','.join([f'{err:.6f}' for err in results])}]\")\n\nsolve()\n```", "id": "3314980"}, {"introduction": "While direct integration is instructive, practical implementations for planar geometries often leverage the efficiency of the Fast Fourier Transform (FFT) via the angular spectrum method. This shift to a discrete spectral domain introduces the critical concept of sampling and the risk of aliasing. This practice problem challenges you to determine the maximum allowable sampling interval on a Huygens surface, ensuring that even the rapidly decaying evanescent wave spectrum is captured without corruption, a crucial step for accurate near-to-far-field transformations. [@problem_id:3314987]", "problem": "A time-harmonic electromagnetic source distribution confined to the half-space $z0$ is enclosed by a planar Huygens surface coincident with the plane $z=0$ in free space, with outward unit normal $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$. By Huygens' principle and the equivalence principle, the fields in the half-space $z>0$ can be produced by equivalent electric and magnetic surface current densities $\\mathbf{J}_{s}=\\hat{\\mathbf{n}}\\times\\mathbf{H}$ and $\\mathbf{M}_{s}=-\\hat{\\mathbf{n}}\\times\\mathbf{E}$ on the $z=0$ plane, where $\\mathbf{E}$ and $\\mathbf{H}$ are the original fields on the surface. A numerical solver in computational electromagnetics samples these equivalent currents uniformly on the plane $z=0$ with spacing $\\Delta$ along both $x$ and $y$, and uses a two-dimensional Discrete Fourier Transform (DFT) computed via the Fast Fourier Transform (FFT) to implement an angular-spectrum propagation model from $z=0$ to a target plane at $z=d$ in the region $z>0$.\n\nAssume the free-space wavenumber is $k=2\\pi f/c$, where $f$ is the frequency and $c$ is the speed of light in vacuum. In the angular-spectrum representation, a transverse spatial frequency component with magnitude $k_{t}=\\sqrt{k_{x}^{2}+k_{y}^{2}}$ contributes a factor $\\exp(i k_{z} z)$ to the field, with $k_{z}=\\sqrt{k^{2}-k_{t}^{2}}$ for $k_{t}\\leq k$ (propagating spectrum) and $k_{z}=i\\sqrt{k_{t}^{2}-k^{2}}$ for $k_{t}>k$ (evanescent spectrum), so that evanescent components decay as $\\exp\\!\\big(-\\sqrt{k_{t}^{2}-k^{2}}\\,z\\big)$.\n\nTo control aliasing caused by spectral replication introduced by uniform sampling, you decide to choose $\\Delta$ so that the discrete spectrum’s first replicas begin at transverse wavenumber offsets well outside the region of non-negligible spectrum that affects the field at $z=d$. You set a tolerance $\\eta$ for the relative amplitude contribution of evanescent components at $z=d$ and define an effective transverse spectral cutoff $K$ such that evanescent components with $k_{t}\\geq K$ decay to amplitudes less than $\\eta$ at $z=d$. You then require that the uniformly sampled data be free of aliasing for all spectral components with $k_{t}\\leq K$.\n\nGiven $f=10\\,\\mathrm{GHz}$, $d=0.05\\,\\mathrm{m}$, $\\eta=1.0\\times 10^{-4}$, $c=299{,}792{,}458\\,\\mathrm{m/s}$, and free space parameters $\\mu_{0}$ and $\\varepsilon_{0}$ consistent with $c=1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$, determine the maximum allowable uniform sampling spacing $\\Delta$ (identical in $x$ and $y$) that ensures no aliasing of the spectrum up to the effective cutoff $K$ implied by the tolerance at $z=d$. Express your final answer for $\\Delta$ in meters and round your answer to four significant figures.", "solution": "The problem asks for a sampling spacing $\\Delta$ on a planar Huygens surface such that, when using the two-dimensional Discrete Fourier Transform (DFT) and the Fast Fourier Transform (FFT) to propagate fields to $z=d$, the discrete spectrum’s periodic replicas do not overlap the portion of the spectrum that meaningfully contributes at the observation plane. The derivation must begin from the foundational representation of the fields and the equivalence principle.\n\nStart from the time-harmonic Maxwell’s equations in a source-free region in the frequency domain,\n$$\n\\nabla\\times \\mathbf{E} = -i\\omega\\mu_{0}\\mathbf{H}, \\qquad \\nabla\\times \\mathbf{H} = i\\omega\\varepsilon_{0}\\mathbf{E},\n$$\nwith $\\omega=2\\pi f$ and the free-space wavenumber $k=\\omega\\sqrt{\\mu_{0}\\varepsilon_{0}}=\\omega/c=2\\pi f/c$. By the equivalence principle on the closed surface $S$ (here the plane $z=0$), equivalent surface currents\n$$\n\\mathbf{J}_{s}=\\hat{\\mathbf{n}}\\times\\mathbf{H}, \\qquad \\mathbf{M}_{s}=-\\hat{\\mathbf{n}}\\times\\mathbf{E}\n$$\nreproduce the exterior fields in $z>0$ while enforcing that the fields inside $z0$ vanish. The fields in $z>0$ can be represented via the angular spectrum of plane waves. Writing the tangential fields (and hence the equivalent currents) on $z=0$ as functions of $(x,y)$, their two-dimensional Fourier transforms produce spectral coefficients $A(k_{x},k_{y})$ that propagate to $z>0$ with the axial dependence $\\exp(i k_{z} z)$, where\n$$\nk_{t} = \\sqrt{k_{x}^{2}+k_{y}^{2}}, \\qquad\nk_{z} =\n\\begin{cases}\n\\sqrt{k^{2}-k_{t}^{2}},  k_{t}\\leq k \\quad \\text{(propagating)},\\\\[6pt]\ni\\sqrt{k_{t}^{2}-k^{2}},  k_{t}>k \\quad \\text{(evanescent)}.\n\\end{cases}\n$$\nFor $k_{t}>k$, the axial factor is $\\exp(i k_{z} z)=\\exp\\!\\big(-\\sqrt{k_{t}^{2}-k^{2}}\\,z\\big)$, producing exponential decay in $z$.\n\nTo set an effective transverse spectral cutoff $K$ implied by the tolerance $\\eta$ at $z=d$, require that evanescent components at the cutoff have decayed to $\\eta$:\n$$\n\\exp\\!\\big(-\\sqrt{K^{2}-k^{2}}\\,d\\big) = \\eta, \\quad \\text{with } K>k.\n$$\nSolving for $K$ gives\n$$\n\\sqrt{K^{2}-k^{2}} = \\frac{\\ln(1/\\eta)}{d}\n\\quad \\Longrightarrow \\quad\nK = \\sqrt{k^{2} + \\left(\\frac{\\ln(1/\\eta)}{d}\\right)^{2}}.\n$$\nUniform sampling on a rectangular grid with spacing $\\Delta$ in $x$ and $y$ produces periodic replicas of the continuous spectrum with period $2\\pi/\\Delta$ along each spectral axis. To avoid aliasing, the baseband spectrum that we intend to retain must fit within the non-overlapping region, i.e., its extent in $k_{x}$ and $k_{y}$ must lie strictly within half the replication period. A sufficient condition is that the circular support of radius $K$ be contained in the square $\\{|k_{x}|\\leq \\pi/\\Delta,\\,|k_{y}|\\leq \\pi/\\Delta\\}$, which yields the sampling condition\n$$\n\\Delta \\leq \\frac{\\pi}{K}.\n$$\nTherefore, the maximum allowable spacing without aliasing up to the cutoff $K$ is\n$$\n\\Delta_{\\max} = \\frac{\\pi}{K} = \\frac{\\pi}{\\sqrt{k^{2} + \\left(\\dfrac{\\ln(1/\\eta)}{d}\\right)^{2}}}.\n$$\n\nNow compute the numerical value using the given parameters. First, compute the free-space wavenumber at $f=10\\,\\mathrm{GHz}$:\n$$\nk = \\frac{2\\pi f}{c} = \\frac{2\\pi \\times 10^{10}\\,\\mathrm{Hz}}{299{,}792{,}458\\,\\mathrm{m/s}} \\approx 209.4395102393\\,\\mathrm{rad/m}.\n$$\nNext, compute the effective evanescent decay rate parameter at $z=d=0.05\\,\\mathrm{m}$ with tolerance $\\eta=1.0\\times 10^{-4}$:\n$$\n\\frac{\\ln(1/\\eta)}{d} = \\frac{\\ln(10^{4})}{0.05\\,\\mathrm{m}} = \\frac{9.210340371976184}{0.05}\\,\\mathrm{m^{-1}} \\approx 184.2068074395\\,\\mathrm{m^{-1}}.\n$$\nThen,\n$$\nK = \\sqrt{k^{2} + \\left(\\frac{\\ln(1/\\eta)}{d}\\right)^{2}}\n\\approx \\sqrt{(209.4395102393)^{2} + (184.2068074395)^{2}}\\,\\mathrm{m^{-1}}\n\\approx 278.922\\,\\mathrm{m^{-1}}.\n$$\nFinally,\n$$\n\\Delta_{\\max} = \\frac{\\pi}{K} \\approx \\frac{3.141592653589793}{278.922}\\,\\mathrm{m} \\approx 0.011264\\,\\mathrm{m}.\n$$\nRounded to four significant figures and expressed in meters, the required sampling spacing is\n$$\n\\Delta_{\\max} \\approx 0.01126\\,\\mathrm{m}.\n$$", "answer": "$$\\boxed{0.01126}$$", "id": "3314987"}, {"introduction": "Knowing how to discretize the Huygens integral is only part of the challenge; knowing where to place the integration surface is equally critical for robust simulations. This problem explores the numerical stability of the near-to-far-field transformation when the Huygens surface, $\\mathcal{S}$, is positioned in the reactive near field of a complex scatterer. By analyzing a scenario with sharp edges and material interfaces, you will investigate how strong evanescent fields and field singularities can lead to ill-conditioning of the numerical operator, a common pitfall that can corrupt far-field predictions. [@problem_id:3333702]", "problem": "A three-dimensional scatterer consisting of a perfectly electrically conducting (PEC) wedge of interior angle $0\\theta\\pi$ sits atop a lossless dielectric half-space of relative permittivity $\\varepsilon_r1$, with the interface at $z=0$ and the wedge edge oriented along the $z$-axis at $x=y=0$. A Finite-Difference Time-Domain (FDTD) simulation is used to compute the total electromagnetic field generated by a bounded source within a compact region surrounding the wedge, and a Huygens surface $\\mathcal{S}$ is constructed as a closed smooth surface that encloses all sources and scatterers. The near-to-far-field (NTFF) transformation uses the equivalence principle to form equivalent surface electric and magnetic currents on $\\mathcal{S}$, defined by the outward unit normal $\\hat{\\mathbf{n}}$ via $\\,\\mathbf{J}_s=\\hat{\\mathbf{n}}\\times\\mathbf{H}\\,$ and $\\,\\mathbf{M}_s=-\\hat{\\mathbf{n}}\\times\\mathbf{E}\\,$, and then radiates into an exterior homogeneous region using free-space dyadic Green’s functions.\n\nSuppose the Huygens surface $\\mathcal{S}$ is placed at a minimum distance $d$ from both the dielectric interface and the wedge edge, and consider the limit where $d$ is reduced from a few wavelengths to deeply subwavelength values. Assume the fields are sampled on $\\mathcal{S}$ with a uniform tangential discretization of characteristic spacing $\\Delta$ and represented by tangential vector basis functions of order $p\\geq 1$. The NTFF mapping from the discretized equivalent currents to the far-field observation is a linear operator whose conditioning depends on the spectrum of the tangential field on $\\mathcal{S}$ and the radiation kernel.\n\nUsing Maxwell’s equations and the equivalence principle as the base, reason about the spectral content of the tangential field on $\\mathcal{S}$, in particular the partition into propagating components with transverse wavenumber $k_t$ satisfying $k_t\\leq k$ and evanescent components with $k_tk$, where $k$ is the free-space wavenumber. Also use the known edge-field asymptotics near PEC wedges, where the tangential field behaves locally as $E_t\\sim r^{\\beta-1}$ and $H_t\\sim r^{\\beta-1}$ for $r$ the distance to the edge and some $0\\beta1$ determined by $\\theta$. From this base, analyze the effect of decreasing $d$ on the conditioning of the discrete NTFF operator, including the role of evanescent content, edge singularities, and possible aliasing due to finite sampling $\\Delta$ and polynomial order $p$.\n\nSelect all statements that are most consistent with the above principles and provide remedies that are scientifically justified.\n\nA. Placing $\\mathcal{S}$ within a subwavelength distance of a material interface or sharp corner increases the proportion of evanescent and singular near-field components in the sampled tangential fields, which inflates the condition number of the discrete NTFF operator. Remedies include moving $\\mathcal{S}$ into a homogeneous buffer region at a distance on the order of a fraction of a wavelength and applying spatial-spectrum filtering to remove transverse wavenumbers $k_tk$.\n\nB. The equivalence principle guarantees perfect conditioning regardless of placement of $\\mathcal{S}$; therefore, the only necessary remedy is mesh refinement on $\\mathcal{S}$.\n\nC. If $\\mathcal{S}$ intersects a material interface, using free-space Green’s functions in the radiation integral still yields a well-conditioned far-field transform and accurate radiation because the external medium is effectively homogeneous.\n\nD. Corner-induced singularities $E_t\\sim r^{\\beta-1}$ near a PEC wedge lead to large dynamic range in the sampled fields; without appropriate regularization (e.g., Tikhonov or Calderón preconditioning) and smoothing of geometric corners, the discrete operator becomes ill-conditioned.\n\nE. Aliasing of evanescent content into propagating modes due to insufficient sampling on $\\mathcal{S}$ can create spurious far-field artifacts; increasing sampling density alone always eliminates ill-conditioning, independent of distance $d$ to interfaces and corners.\n\nChoose all correct options. Provide no derivations in your choice; only select the letters of the correct statements. The detailed derivation is required in the solution section.", "solution": "The user wants me to validate and solve a problem related to the conditioning of a Near-to-Far-Field (NTFF) transformation in computational electromagnetics.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Scatterer Geometry:** A three-dimensional scatterer consisting of a perfectly electrically conducting (PEC) wedge atop a lossless dielectric half-space.\n-   **Wedge Parameters:** Interior angle $0  \\theta  \\pi$, edge oriented along the $z$-axis at $x=y=0$.\n-   **Dielectric Half-Space:** Relative permittivity $\\varepsilon_r  1$, with the interface at $z=0$.\n-   **Simulation Method:** Finite-Difference Time-Domain (FDTD) is used to compute the total electromagnetic field from a bounded source.\n-   **Huygens Surface:** A closed, smooth surface $\\mathcal{S}$ encloses all sources and scatterers.\n-   **Equivalent Currents:** Defined on $\\mathcal{S}$ with outward unit normal $\\hat{\\mathbf{n}}$ as $\\mathbf{J}_s = \\hat{\\mathbf{n}} \\times \\mathbf{H}$ and $\\mathbf{M}_s = -\\hat{\\mathbf{n}} \\times \\mathbf{E}$.\n-   **NTFF Radiation:** The transformation uses free-space dyadic Green’s functions to radiate into an exterior homogeneous region.\n-   **Scenario Parameters:**\n    -   $\\mathcal{S}$ is at a minimum distance $d$ from the dielectric interface and the wedge edge.\n    -   The limit of decreasing $d$ from a few wavelengths to deeply subwavelength values is considered.\n-   **Discretization:**\n    -   Uniform tangential discretization on $\\mathcal{S}$ with characteristic spacing $\\Delta$.\n    -   Tangential vector basis functions of order $p \\geq 1$.\n-   **Field Properties:**\n    -   Spectral partition into propagating components ($k_t \\leq k$) and evanescent components ($k_t  k$), where $k$ is the free-space wavenumber.\n    -   Edge-field asymptotics near the PEC wedge: tangential fields $E_t \\sim r^{\\beta-1}$ and $H_t \\sim r^{\\beta-1}$, where $r$ is the distance to the edge and $0  \\beta  1$.\n-   **Core Question:** Analyze the effect of decreasing $d$ on the conditioning of the discrete NTFF operator, considering evanescent content, edge singularities, and aliasing.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientific Grounding (Critical):** The problem is fundamentally sound. It is based on established principles of electromagnetism, including Maxwell's equations, the equivalence principle (Huygens' principle), and the theory of wave propagation (evanescent and propagating waves). The asymptotic behavior of fields near a PEC edge is a classic result derived from Meixner's edge conditions. The numerical concepts of discretization, basis functions, operator conditioning, and aliasing are central to computational electromagnetics. The setup is scientifically rigorous.\n2.  **Well-Posed:** The problem is well-posed. It asks for a conceptual analysis of the factors affecting the numerical stability of a standard algorithm under specific, well-defined physical conditions. A meaningful qualitative analysis is possible and leads to a definite set of conclusions.\n3.  **Objective (Critical):** The problem is stated in precise, objective, and technical language. There are no subjective elements.\n4.  **Flaw Checklist:**\n    -   **Scientific/Factual Unsoundness:** None. All premises are consistent with electromagnetic theory and numerical analysis.\n    -   **Non-Formalizable/Irrelevant:** The problem is directly relevant to near-to-far-field transformation theory and highly formalizable.\n    -   **Incomplete/Contradictory Setup:** The setup is complex but complete and self-consistent for the analysis requested. It clearly states the method used (free-space Green's functions), which is a crucial detail for evaluation.\n    -   **Unrealistic/Infeasible:** The physical scenario is a standard, albeit challenging, benchmark problem in electromagnetics. It is entirely realistic.\n    -   **Ill-Posed/Poorly Structured:** The problem is well-structured, guiding the analysis towards specific physical phenomena (evanescent waves, singularities) and their numerical consequences (conditioning, aliasing).\n    -   **Pseudo-Profound/Trivial:** The problem is conceptually non-trivial, touching upon the critical interplay between physical field characteristics and the stability of numerical operators.\n    -   **Outside Scientific Verifiability:** All aspects of the problem are verifiable through theory, simulation, and experiment.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The analysis can proceed.\n\n### Solution Derivation\n\nThe analysis rests on the application of the electromagnetic equivalence principle for a near-to-far-field (NTFF) transformation and its numerical implementation. The far-field $\\mathbf{E}(\\mathbf{r})$ at an observation point $\\mathbf{r}$ is computed from the tangential fields $(\\mathbf{E}, \\mathbf{H})$ on a closed Huygens surface $\\mathcal{S}$ enclosing the sources and scatterers. This is done by defining equivalent surface currents $\\mathbf{J}_s = \\hat{\\mathbf{n}} \\times \\mathbf{H}$ and $\\mathbf{M}_s = -\\hat{\\mathbf{n}} \\times \\mathbf{E}$ on $\\mathcal{S}$. These currents are then used as sources in a radiation integral involving a Green's function for the exterior medium. The problem specifies that a free-space Green's function is used.\n\nThe transformation from the discretized tangential fields on $\\mathcal{S}$ to the far-field values constitutes a linear operator, which can be represented by a matrix $\\mathbf{L}$. The conditioning of this operator is paramount for numerical stability. An ill-conditioned operator (one with a high condition number, $\\kappa(\\mathbf{L})$) is highly sensitive to small errors in the input data (the sampled near-fields), which can be amplified into large, non-physical errors in the computed far-field.\n\nWe analyze the factors affecting conditioning as the distance $d$ of the Huygens surface $\\mathcal{S}$ to the scatterer (wedge and dielectric interface) decreases.\n\n1.  **Evanescent Field Content:** The total electromagnetic field near any object is a superposition of propagating waves and evanescent waves.\n    -   **Propagating waves:** Have a transverse wavenumber $k_t \\leq k$ (where $k$ is the free-space wavenumber) and carry energy to the far-field.\n    -   **Evanescent waves:** Have $k_t  k$ and store reactive energy. Their amplitude decays exponentially with distance from the source structure, e.g., as $e^{-z\\sqrt{k_t^2 - k^2}}$. They do not contribute to the far-field power.\n    When the Huygens surface $\\mathcal{S}$ is placed far from the scatterer (e.g., $d$ is several wavelengths), the evanescent fields have decayed significantly, and the tangential fields on $\\mathcal{S}$ are dominated by propagating components. When $d$ becomes deeply subwavelength, $\\mathcal{S}$ is in the reactive near-field region, and the sampled tangential fields contain a very strong evanescent component. The NTFF radiation operator, which is based on the far-field Green's function, is inherently designed to propagate the $k_t \\leq k$ spectral content and suppress the $k_t  k$ content. When the input data has a large-amplitude evanescent part that must be mapped to a near-zero output, the operator matrix $\\mathbf{L}$ will have very small singular values corresponding to these evanescent modes. The singular values for the propagating modes remain relatively large. The condition number, which is the ratio of the largest to smallest singular value, therefore becomes very large. This makes the numerical process ill-conditioned.\n\n2.  **Field Singularities:** The problem states that near the PEC wedge edge, tangential fields behave as $r^{\\beta-1}$, where $r$ is the radial distance from the edge and $0  \\beta  1$. Since $\\beta - 1$ is negative, the field magnitude diverges as $r \\to 0$.\n    As $d$ decreases, some parts of the Huygens surface $\\mathcal{S}$ get closer to the wedge edge. The sampled fields on $\\mathcal{S}$ will exhibit a very large dynamic range: extremely large values near the edge and moderate values far from it. Representing this singular behavior with a discrete set of finite-order polynomial basis functions is challenging. The vector of coefficients representing the discretized field will have entries spanning many orders of magnitude. A linear operator acting on such a vector is prone to ill-conditioning, as this large dynamic range in the input amplifies numerical precision issues.\n\n3.  **Discretization and Aliasing:** The highly oscillatory nature of evanescent waves (high $k_t$) and the sharp spatial variation of singular fields imply they contain high spatial frequencies. According to the Nyquist-Shannon sampling theorem, to accurately represent spatial variations with a maximum wavenumber $k_{t,max}$, the sampling interval $\\Delta$ must satisfy $\\Delta  \\pi/k_{t,max}$. If the sampling on $\\mathcal{S}$ is too coarse ( $\\Delta$ is too large), the high-frequency content from evanescent and singular fields will be \"aliased\" down into the low-frequency, propagating part of the spectrum ($k_t \\leq k$). Since the NTFF operator radiates propagating content, this aliased information will manifest as spurious, non-physical radiation in the computed far-field pattern, leading to inaccurate results.\n\n### Option-by-Option Analysis\n\n**A. Placing $\\mathcal{S}$ within a subwavelength distance of a material interface or sharp corner increases the proportion of evanescent and singular near-field components in the sampled tangential fields, which inflates the condition number of the discrete NTFF operator. Remedies include moving $\\mathcal{S}$ into a homogeneous buffer region at a distance on the order of a fraction of a wavelength and applying spatial-spectrum filtering to remove transverse wavenumbers $k_tk$.**\n\n-   **Analysis:** This statement accurately summarizes the core issues. Placing $\\mathcal{S}$ closer to the scatterer and interface does increase the evanescent and singular field content. As derived above, this leads to a larger spread in the singular values of the discrete NTFF operator, thus inflating the condition number. The proposed remedies are standard and effective. Moving $\\mathcal{S}$ away allows the problematic evanescent fields to decay naturally. Applying a low-pass spatial filter to the sampled data on $\\mathcal{S}$ to remove components with $k_t  k$ before applying the NTFF operator is a direct way to pre-condition the problem by removing the source of the small singular values.\n-   **Verdict:** **Correct**.\n\n**B. The equivalence principle guarantees perfect conditioning regardless of placement of $\\mathcal{S}$; therefore, the only necessary remedy is mesh refinement on $\\mathcal{S}$.**\n\n-   **Analysis:** This statement is fundamentally flawed. It conflates the exactness of the analytical equivalence principle with the stability of its numerical discretization. While the principle holds for any closed surface $\\mathcal{S}$, the *conditioning* of the resulting *discrete* operator is highly dependent on the properties of the fields on $\\mathcal{S}$, which are determined by its placement. Mesh refinement helps to represent the fields on $\\mathcal{S}$ more accurately and reduce aliasing, but it does not cure the inherent ill-conditioning caused by sampling large-amplitude evanescent or singular fields.\n-   **Verdict:** **Incorrect**.\n\n**C. If $\\mathcal{S}$ intersects a material interface, using free-space Green’s functions in the radiation integral still yields a well-conditioned far-field transform and accurate radiation because the external medium is effectively homogeneous.**\n\n-   **Analysis:** This is incorrect. The equivalence principle requires that the Green's function used for the radiation integral matches the medium *exterior* to the Huygens surface $\\mathcal{S}$. In the given problem, the region exterior to the scatterer includes the dielectric half-space. If $\\mathcal{S}$ intersects the dielectric interface at $z=0$, the region exterior to $\\mathcal{S}$ is inhomogeneous (partly free space, partly dielectric). Using a free-space Green's function in this case is a violation of the principle and will produce an inaccurate result, as it neglects reflections from and propagation within the dielectric. The premise is flawed, and the conclusion of \"accurate radiation\" is false.\n-   **Verdict:** **Incorrect**.\n\n**D. Corner-induced singularities $E_t\\sim r^{\\beta-1}$ near a PEC wedge lead to large dynamic range in the sampled fields; without appropriate regularization (e.g., Tikhonov or Calderón preconditioning) and smoothing of geometric corners, the discrete operator becomes ill-conditioned.**\n\n-   **Analysis:** This statement correctly identifies the problem associated with field singularities. The $r^{\\beta-1}$ behavior creates a large dynamic range in the field data, which is a direct cause of ill-conditioning in numerical operators. The proposed remedies are valid and sophisticated techniques used in computational science to deal with such problems. Tikhonov regularization is a general method for ill-posed problems. Calderón preconditioning is a powerful technique specifically used in boundary element methods (which are conceptually similar to NTFF transforms) to reformulate the integral equations to have operators with clustered spectra, dramatically improving conditioning. Smoothing the geometric corner is a practical way to regularize the problem by removing the source of the mathematical singularity.\n-   **Verdict:** **Correct**.\n\n**E. Aliasing of evanescent content into propagating modes due to insufficient sampling on $\\mathcal{S}$ can create spurious far-field artifacts; increasing sampling density alone always eliminates ill-conditioning, independent of distance $d$ to interfaces and corners.**\n\n-   **Analysis:** The first clause is correct: aliasing of evanescent content does create spurious artifacts. However, the second clause is incorrect. Increasing sampling density (i.e., decreasing $\\Delta$) mitigates aliasing but does not \"eliminate ill-conditioning\". As long as $d$ is small, the sampled fields will have strong evanescent components, and the operator will remain ill-conditioned, even if the fields are sampled accurately. The conditioning problem is fundamentally linked to the physics of the near-field (determined by $d$) and not just the sampling of it. Claiming this is \"independent of distance $d$\" is a critical error, as $d$ is the primary parameter controlling the severity of the issue.\n-   **Verdict:** **Incorrect**.", "answer": "$$\\boxed{AD}$$", "id": "3333702"}]}