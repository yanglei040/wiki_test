{"hands_on_practices": [{"introduction": "Before relying on a complex numerical scheme, it is crucial to verify its correctness. This first practice guides you through a fundamental validation exercise for the hypersingular operator [@problem_id:3316200]. You will compare a numerically stable, regularized formulation against a direct finite difference approximation, providing a clear, hands-on demonstration of why regularization is not just a mathematical convenience, but a computational necessity.", "problem": "You are to validate a regularization of a hypersingular boundary integral operator in two-dimensional electrostatics by comparing a boundary-only regularized formulation to a near-surface “volume-like” evaluation on a very fine mesh along the surface normal. The boundary is the unit circle, and the field is governed by the Laplace equation. Angles must be treated in radians. No physical units are required. The final output must be a single line containing a list of booleans.\n\nStart from the following fundamental base for two-dimensional electrostatics: the Laplace equation and its free-space Green’s function. The free-space Green’s function for the two-dimensional Laplace equation is\n$$\nG(\\mathbf{x},\\mathbf{y}) \\;=\\; -\\frac{1}{2\\pi}\\,\\log\\|\\mathbf{x}-\\mathbf{y}\\|,\n$$\nwhere $\\mathbf{x},\\mathbf{y}\\in\\mathbb{R}^2$. Define the double-layer potential on a smooth, closed curve $\\Gamma$ with density $\\varphi$ as\n$$\n\\big(D\\varphi\\big)(\\mathbf{x}) \\;=\\; \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})}\\, \\varphi(\\mathbf{y}) \\, ds_{\\mathbf{y}},\n$$\nwhere $\\partial/\\partial n(\\mathbf{y})$ denotes the outward normal derivative at $\\mathbf{y}\\in\\Gamma$, and $ds_{\\mathbf{y}}$ is the arclength measure. The hypersingular boundary operator $N$ is defined as the boundary limit of the normal derivative of the double-layer potential:\n$$\n(N\\varphi)(\\mathbf{x}) \\;=\\; \\lim_{\\substack{\\mathbf{x}'\\to\\mathbf{x}\\\\ \\mathbf{x}'\\notin \\Gamma}} \\frac{\\partial}{\\partial n(\\mathbf{x})}\\big(D\\varphi\\big)(\\mathbf{x}'),\n\\qquad \\mathbf{x}\\in \\Gamma.\n$$\nIt is well known (Maue’s formula, a standard regularization identity for the Laplace hypersingular operator on smooth curves) that for the Laplace equation on a smooth closed curve:\n$$\nN\\varphi \\;=\\; -\\frac{\\partial}{\\partial s}\\,\\Big(S\\,\\frac{\\partial\\varphi}{\\partial s}\\Big),\n$$\nwhere $S$ is the single-layer operator given by\n$$\n(S\\psi)(\\mathbf{x}) \\;=\\; \\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y})\\,\\psi(\\mathbf{y})\\,ds_{\\mathbf{y}},\n$$\nand $\\partial/\\partial s$ denotes tangential derivative along $\\Gamma$.\n\nOn the unit circle $\\Gamma=\\{\\mathbf{x}(\\theta)=(\\cos\\theta,\\sin\\theta),\\, \\theta\\in[0,2\\pi)\\}$, the single-layer operator on the boundary diagonalizes in the Fourier basis. If $\\psi(\\theta)=\\sum_{n=-\\infty}^{\\infty}\\hat\\psi_n e^{\\mathrm{i} n\\theta}$, then\n$$\n(S\\psi)(\\theta) \\;=\\; \\sum_{n\\neq 0} \\frac{1}{2|n|}\\,\\hat\\psi_n\\,e^{\\mathrm{i} n\\theta}, \\qquad \\text{and} \\qquad (S\\psi)_0=0.\n$$\nConsequently,\n$$\nN\\varphi(\\theta) \\;=\\; \\sum_{n\\neq 0} \\frac{|n|}{2}\\,\\hat\\varphi_n\\,e^{\\mathrm{i} n\\theta}.\n$$\n\nYour task is to implement and validate two numerical approximations of $N\\varphi$ on the unit circle:\n\n1) Regularized boundary-only method (spectral): Implement $N\\varphi(\\theta)=-\\frac{\\partial}{\\partial s}\\big(S(\\partial\\varphi/\\partial s)\\big)$ using a discrete Fourier transform (on equispaced nodes in $\\theta$). Specifically, use the Fourier multiplier identity above to apply $S$ in the Fourier domain, and use Fourier differentiation to apply $\\partial/\\partial s$, noting that on the unit circle $\\partial/\\partial s=\\partial/\\partial\\theta$.\n\n2) Near-surface “volume-like” method: Define $\\mathbf{x}(\\theta)=(\\cos\\theta,\\sin\\theta)$ and the outward unit normal $\\mathbf{n}(\\theta)=\\mathbf{x}(\\theta)$. For a small offset $\\delta>0$, define the near-surface points $\\mathbf{x}^{\\pm}_\\delta(\\theta) = \\mathbf{x}(\\theta) \\pm \\delta\\,\\mathbf{n}(\\theta) = (1\\pm \\delta)\\,\\mathbf{x}(\\theta)$. Evaluate the double-layer potential $D\\varphi$ at these near-surface points by quadrature over $\\tau\\in[0,2\\pi)$:\n$$\n\\big(D\\varphi\\big)(\\mathbf{x}) \\;\\approx\\; \\sum_{j=0}^{M-1} w \\,\\frac{\\partial G(\\mathbf{x},\\mathbf{y}_j)}{\\partial n(\\mathbf{y}_j)}\\,\\varphi(\\tau_j), \\quad \\mathbf{y}_j=(\\cos\\tau_j,\\sin\\tau_j), \\quad \\mathbf{n}(\\mathbf{y}_j)=\\mathbf{y}_j,\n$$\nwith uniform nodes $\\tau_j = 2\\pi j/M$, weight $w=2\\pi/M$, and\n$$\n\\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} \\;=\\; \\nabla_{\\mathbf{y}} G(\\mathbf{x},\\mathbf{y})\\cdot \\mathbf{n}(\\mathbf{y}) \\;=\\; \\frac{1}{2\\pi}\\,\\frac{(\\mathbf{x}-\\mathbf{y})\\cdot \\mathbf{n}(\\mathbf{y})}{\\|\\mathbf{x}-\\mathbf{y}\\|^2}.\n$$\nFor each boundary node $\\theta_i$, approximate the boundary normal derivative by the centered difference:\n$$\n\\left.\\frac{\\partial}{\\partial n} D\\varphi\\right|_{\\mathbf{x}(\\theta_i)} \\;\\approx\\; \\frac{D\\varphi\\big(\\mathbf{x}^+_\\delta(\\theta_i)\\big)-D\\varphi\\big(\\mathbf{x}^-_\\delta(\\theta_i)\\big)}{2\\delta}.\n$$\n\nCompute and compare the two approximations of $N\\varphi$ pointwise on a set of $N$ equispaced boundary nodes $\\theta_i=2\\pi i/N$, $i=0,\\dots,N-1$. Measure the discrepancy using the absolute $L^2(\\Gamma)$ norm of the difference, discretized by the trapezoidal rule on the circle:\n$$\n\\lVert e\\rVert_{L^2(\\Gamma)} \\;\\approx\\; \\left( \\sum_{i=0}^{N-1} \\big| e(\\theta_i)\\big|^2 \\,\\Delta s \\right)^{1/2}, \\qquad \\Delta s = \\frac{2\\pi}{N}.\n$$\nThe field agreement is considered acceptable if the absolute $L^2(\\Gamma)$ error is less than or equal to a given tolerance $\\epsilon$.\n\nImplement a program that, for each specified test case below, returns a boolean indicating whether the near-surface method agrees with the regularized spectral method within the given $\\epsilon$ in the absolute $L^2(\\Gamma)$ norm. Angles must be in radians throughout. No physical units are required. The final output must be a single line containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True]\").\n\nTest suite (each case specifies the boundary sampling size $N$, the source quadrature size $M$, the offset $\\delta$, the tolerance $\\epsilon$, and the density $\\varphi(\\theta)$):\n\n- Case 1 (happy path): $N=256$, $M=4096$, $\\delta=10^{-3}$, $\\epsilon=10^{-3}$, with $\\varphi(\\theta) = \\sin(3\\theta) + \\tfrac{1}{2}\\cos(2\\theta)$.\n\n- Case 2 (high-frequency density): $N=512$, $M=16384$, $\\delta=7.5\\times 10^{-4}$, $\\epsilon=2\\times 10^{-3}$, with $\\varphi(\\theta) = \\sin(15\\theta)$.\n\n- Case 3 (edge case, constant density): $N=256$, $M=4096$, $\\delta=10^{-3}$, $\\epsilon=10^{-4}$, with $\\varphi(\\theta) = 1$.\n\n- Case 4 (reduced quadrature, mixed modes): $N=256$, $M=1024$, $\\delta=2\\times 10^{-3}$, $\\epsilon=5\\times 10^{-3}$, with $\\varphi(\\theta) = \\sin(9\\theta) + 0.2\\cos(5\\theta)$.\n\nYour program must compute the boolean result for each case in the specified order, and print a single line containing the list of results in the exact required format.", "solution": "The problem requires the validation of a numerical regularization of the two-dimensional Laplace hypersingular boundary integral operator, $N$, on the unit circle. This is achieved by comparing a spectrally-accurate boundary-only method based on Maue's regularization formula against a direct numerical approximation using near-surface potential evaluations and finite differences.\n\nThe hypersingular operator $N$ is defined as the normal derivative of the double-layer potential $D\\varphi$ on the boundary $\\Gamma$:\n$$\n(N\\varphi)(\\mathbf{x}) = \\lim_{\\mathbf{x}' \\to \\mathbf{x}} \\frac{\\partial}{\\partial n(\\mathbf{x})} (D\\varphi)(\\mathbf{x}'), \\quad \\mathbf{x} \\in \\Gamma\n$$\nwhere\n$$\n(D\\varphi)(\\mathbf{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} \\varphi(\\mathbf{y}) ds_{\\mathbf{y}}\n$$\nand $G(\\mathbf{x}, \\mathbf{y}) = -\\frac{1}{2\\pi}\\log\\|\\mathbf{x}-\\mathbf{y}\\|$ is the free-space Green's function for the 2D Laplace equation.\n\nWe will implement and compare two computational methods for $(N\\varphi)(\\mathbf{x})$ on a discrete set of $N$ equispaced points $\\mathbf{x}_i = (\\cos\\theta_i, \\sin\\theta_i)$ on the unit circle, where $\\theta_i = 2\\pi i/N$ for $i=0, \\dots, N-1$.\n\n### Method 1: Regularized Spectral Method\n\nThis method leverages Maue's formula, which regularizes the hypersingular operator $N$ using the single-layer operator $S$:\n$$\nN\\varphi = -\\frac{\\partial}{\\partial s} \\left( S \\frac{\\partial\\varphi}{\\partial s} \\right)\n$$\nOn the unit circle, the arc-length derivative $\\partial/\\partial s$ is equivalent to the angular derivative $\\partial/\\partial\\theta$. For a function $\\psi$ with Fourier series $\\psi(\\theta) = \\sum_{n=-\\infty}^{\\infty} \\hat{\\psi}_n e^{\\mathrm{i}n\\theta}$, the action of the operators $\\partial/\\partial\\theta$ and $S$ can be expressed as multiplication in the Fourier domain:\n-   $\\mathcal{F}\\left(\\frac{\\partial\\psi}{\\partial\\theta}\\right)_n = \\mathrm{i}n\\,\\hat{\\psi}_n$\n-   $\\mathcal{F}(S\\psi)_n = \\frac{1}{2|n|}\\,\\hat{\\psi}_n$ for $n \\neq 0$, and $0$ for $n=0$.\n\nCombining these for $N\\varphi = -\\frac{\\partial}{\\partial\\theta} S \\frac{\\partial\\varphi}{\\partial\\theta}$ gives the Fourier multiplier for the operator $N$:\n$$\n\\mathcal{F}(N\\varphi)_n = -(\\mathrm{i}n) \\left( \\frac{1}{2|n|} (\\mathrm{i}n\\,\\hat{\\varphi}_n) \\right) = \\frac{n^2}{2|n|}\\,\\hat{\\varphi}_n = \\frac{|n|}{2}\\,\\hat{\\varphi}_n \\quad (\\text{for } n \\neq 0)\n$$\nand $\\mathcal{F}(N\\varphi)_0 = 0$. This matches the provided formula.\n\nThe numerical implementation proceeds as follows:\n1.  Discretize the density $\\varphi(\\theta)$ on the $N$ points $\\theta_i$.\n2.  Compute its discrete Fourier transform (DFT) using the Fast Fourier Transform (FFT) algorithm, yielding the coefficients $\\hat{\\varphi}_k$.\n3.  Determine the discrete wavenumbers $k$ corresponding to the DFT frequencies. For a transform of length $N$, these are integers from $0$ up to $\\lfloor N/2 \\rfloor$ and from $-\\lceil N/2 \\rceil+1$ to $-1$.\n4.  Apply the spectral multiplier for $N$ by multiplying each coefficient $\\hat{\\varphi}_k$ by $|k|/2$. The $k=0$ (DC) component is correctly multiplied by $0$.\n5.  Compute the inverse DFT of the resulting coefficients to obtain the values of $(N\\varphi)(\\theta_i)$.\n\n### Method 2: Near-Surface Finite Difference Method\n\nThis method directly approximates the definition of $N\\varphi$ as the normal derivative of $D\\varphi$. The normal derivative at each boundary point $\\mathbf{x}(\\theta_i)$ is approximated by a second-order centered finite difference using values of $D\\varphi$ at points slightly offset from the boundary along the normal direction:\n$$\n(N\\varphi)(\\mathbf{x}_i) \\approx \\frac{(D\\varphi)(\\mathbf{x}^+_\\delta(\\theta_i)) - (D\\varphi)(\\mathbf{x}^-_\\delta(\\theta_i))}{2\\delta}\n$$\nwhere $\\mathbf{x}^{\\pm}_\\delta(\\theta_i) = \\mathbf{x}(\\theta_i) \\pm \\delta \\mathbf{n}(\\theta_i) = (1 \\pm \\delta)\\mathbf{x}(\\theta_i)$ for a small offset $\\delta > 0$.\n\nThe value of the double-layer potential $D\\varphi$ at any off-boundary point $\\mathbf{x}$ is computed by numerical quadrature over the boundary. The integral is discretized using the trapezoidal rule with $M$ uniform source points $\\mathbf{y}_j = (\\cos\\tau_j, \\sin\\tau_j)$, where $\\tau_j = 2\\pi j/M$.\n$$\n(D\\varphi)(\\mathbf{x}) \\approx \\sum_{j=0}^{M-1} \\frac{2\\pi}{M} \\frac{\\partial G(\\mathbf{x}, \\mathbf{y}_j)}{\\partial n(\\mathbf{y}_j)} \\varphi(\\tau_j)\n$$\nThe kernel of the double-layer integral is given by:\n$$\n\\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} = \\nabla_{\\mathbf{y}} G(\\mathbf{x}, \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y}) = \\frac{1}{2\\pi} \\frac{(\\mathbf{x} - \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{\\|\\mathbf{x} - \\mathbf{y}\\|^2}\n$$\nOn the unit circle, with $\\mathbf{y} = (\\cos\\tau, \\sin\\tau)$ and $\\mathbf{n}(\\mathbf{y}) = \\mathbf{y}$, and for an evaluation point $\\mathbf{x} = (1 \\pm \\delta)(\\cos\\theta, \\sin\\theta)$, this simplifies to:\n$$\n\\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} = \\frac{1}{2\\pi} \\frac{(1 \\pm \\delta)\\cos(\\theta - \\tau) - 1}{(1 \\pm \\delta)^2 - 2(1 \\pm \\delta)\\cos(\\theta - \\tau) + 1}\n$$\nThis calculation is performed for each point $\\mathbf{x}_{i, \\delta}^{\\pm}$ to find $(D\\varphi)(\\mathbf{x}_{i, \\delta}^{\\pm})$, which are then used in the finite difference formula.\n\n### Validation and Comparison\n\nFor each test case, we compute the vector of values for $N\\varphi$ at the $N$ nodes using both methods, let's call them $(N\\varphi)_{\\text{spectral}}$ and $(N\\varphi)_{\\text{direct}}$. The error is defined as the difference vector $e_i = (N\\varphi)_{\\text{spectral}}(\\theta_i) - (N\\varphi)_{\\text{direct}}(\\theta_i)$. The agreement between the two methods is quantified by computing the discretized absolute $L^2(\\Gamma)$ norm of this error:\n$$\n\\|e\\|_{L^2(\\Gamma)} \\approx \\left(\\sum_{i=0}^{N-1} |e_i|^2 \\Delta s \\right)^{1/2}\n$$\nwhere $\\Delta s = 2\\pi/N$ is the arc-length spacing between nodes. The near-surface method is considered to agree with the spectral method if $\\|e\\|_{L^2(\\Gamma)} \\le \\epsilon$, where $\\epsilon$ is a given tolerance.\n\nIt is worth noting that for a constant density, e.g., $\\varphi(\\theta)=1$ as in Case 3, the two methods are expected to produce substantially different results. The regularized spectral method correctly yields $(N\\varphi)(\\theta)=0$ since $\\partial\\varphi/\\partial\\theta = 0$. However, the double-layer potential for a constant density is known to be a step function ($0$ outside $\\Gamma$, $-1$ inside $\\Gamma$). The finite difference approximation of its normal derivative at the boundary does not converge and instead yields a large value proportional to $1/\\delta$. This behavior is a known characteristic of the direct finite difference approach and highlights the necessity of regularization. The validation task is to implement the methods as specified and report the resulting agreement, or lack thereof.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_phi_func(phi_str):\n    \"\"\"\n    Returns a lambda function for the given density string.\n    \"\"\"\n    if phi_str == \"sin(3*theta) + 0.5*cos(2*theta)\":\n        return lambda theta: np.sin(3 * theta) + 0.5 * np.cos(2 * theta)\n    elif phi_str == \"sin(15*theta)\":\n        return lambda theta: np.sin(15 * theta)\n    elif phi_str == \"1\":\n        return lambda theta: np.ones_like(theta)\n    elif phi_str == \"sin(9*theta) + 0.2*cos(5*theta)\":\n        return lambda theta: np.sin(9 * theta) + 0.2 * np.cos(5 * theta)\n    else:\n        raise ValueError(f\"Unknown phi function: {phi_str}\")\n\ndef solve_case(N, M, delta, epsilon, phi_func):\n    \"\"\"\n    Solves a single test case for the hypersingular operator validation.\n    \n    Args:\n        N (int): Number of boundary sampling points.\n        M (int): Number of quadrature points for source integration.\n        delta (float): Offset for near-surface evaluation.\n        epsilon (float): Tolerance for L2 error comparison.\n        phi_func (callable): Function for the density phi(theta).\n        \n    Returns:\n        bool: True if L2 error is within tolerance, False otherwise.\n    \"\"\"\n    \n    # === Method 1: Regularized Spectral Method ===\n    # Grid for boundary evaluation (N points)\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    \n    # Evaluate density on the N-point grid\n    phi_on_N = phi_func(theta)\n    \n    # Compute DFT of the density\n    phi_hat = np.fft.fft(phi_on_N)\n    \n    # Get integer wavenumbers for the DFT\n    k = np.fft.fftfreq(N) * N\n    \n    # Spectral multiplier for the hypersingular operator N\n    N_multiplier = 0.5 * np.abs(k)\n    \n    # Apply multiplier in Fourier domain\n    Nphi_hat_spectral = N_multiplier * phi_hat\n    \n    # Inverse DFT to get N(phi) in physical space\n    # The result should be real; take the real part to discard small imag parts from numerical error.\n    Nphi_spectral = np.fft.ifft(Nphi_hat_spectral).real\n\n    # === Method 2: Near-Surface Finite Difference Method ===\n    # Grid for quadrature (M points)\n    tau = np.linspace(0, 2 * np.pi, M, endpoint=False)\n    \n    # Evaluate density on the M-point quadrature grid\n    phi_on_M = phi_func(tau)\n\n    # Use broadcasting to compute kernel matrices efficiently\n    # theta is (N, 1), tau is (1, M), so cos_diff is (N, M)\n    cos_diff = np.cos(theta[:, None] - tau[None, :])\n    \n    # --- Evaluation at x_plus (outside the circle) ---\n    r_plus = 1.0 + delta\n    # Numerator of the double-layer kernel\n    num_plus = r_plus * cos_diff - 1.0\n    # Denominator of the double-layer kernel\n    den_plus = r_plus**2 - 2.0 * r_plus * cos_diff + 1.0\n    # Kernel matrix (N x M)\n    K_plus = (1.0 / (2.0 * np.pi)) * num_plus / den_plus\n    # Quadrature sum for D(phi) at x_plus points\n    Dphi_plus = K_plus @ phi_on_M * (2.0 * np.pi / M)\n\n    # --- Evaluation at x_minus (inside the circle) ---\n    r_minus = 1.0 - delta\n    num_minus = r_minus * cos_diff - 1.0\n    den_minus = r_minus**2 - 2.0 * r_minus * cos_diff + 1.0\n    K_minus = (1.0 / (2.0 * np.pi)) * num_minus / den_minus\n    Dphi_minus = K_minus @ phi_on_M * (2.0 * np.pi / M)\n    \n    # --- Centered finite difference for N(phi) ---\n    Nphi_direct = (Dphi_plus - Dphi_minus) / (2.0 * delta)\n\n    # === Comparison ===\n    error_vec = Nphi_spectral - Nphi_direct\n    \n    # Discretized L2(Gamma) norm of the error\n    delta_s = 2.0 * np.pi / N\n    l2_error = np.sqrt(np.sum(np.abs(error_vec)**2) * delta_s)\n    \n    return l2_error = epsilon\n\ndef solve():\n    # Test suite from the problem description.\n    # Each tuple: (N, M, delta, epsilon, phi_string)\n    test_cases = [\n        (256, 4096, 1e-3, 1e-3, \"sin(3*theta) + 0.5*cos(2*theta)\"),\n        (512, 16384, 7.5e-4, 2e-3, \"sin(15*theta)\"),\n        (256, 4096, 1e-3, 1e-4, \"1\"),\n        (256, 1024, 2e-3, 5e-3, \"sin(9*theta) + 0.2*cos(5*theta)\"),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, M, delta, epsilon, phi_str = case\n        phi_func = get_phi_func(phi_str)\n        result = solve_case(N, M, delta, epsilon, phi_func)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3316200"}, {"introduction": "Regularization often transforms a hypersingular integral into a more manageable form, leaving a weakly singular kernel such as $\\ln \\rho$. This exercise [@problem_id:3316164] introduces the Duffy transformation, a powerful technique that maps the singular integration domain into a simple, regular one, allowing for efficient evaluation with standard quadrature rules. By analyzing the convergence rate, you will gain insight into the effectiveness of this essential Boundary Element Method implementation tool.", "problem": "Consider the regularized hypersingular boundary integral operator for time-harmonic electromagnetics on a single flat triangular surface element $\\Delta \\subset \\mathbb{R}^{3}$ with vertices $\\mathbf{r}_{1}, \\mathbf{r}_{2}, \\mathbf{r}_{3}$. After standard Maue-type integration-by-parts regularization, the operator kernel restricted to the coincident-element contribution has a weakly singular component whose local leading term near $\\mathbf{r} = \\mathbf{r}'$ is proportional to $\\ln \\rho$, where $\\rho = \\|\\mathbf{r} - \\mathbf{r}'\\|$, plus a smooth remainder. Let $\\phi$ and $\\psi$ be smooth test functions on $\\Delta$ (for example, piecewise polynomial basis functions of fixed degree), and consider the model singular double integral\n$$\nI_{\\mathrm{sing}} = \\int_{\\Delta} \\int_{\\Delta} \\ln \\|\\mathbf{r} - \\mathbf{r}'\\| \\, \\phi(\\mathbf{r}) \\, \\psi(\\mathbf{r}') \\, \\mathrm{d}S_{\\mathbf{r}} \\, \\mathrm{d}S_{\\mathbf{r}'} .\n$$\nYou will devise a Duffy-type coordinate transformation tailored to the coincident-element case that converts the local near-diagonal integral into a tensor-product form with an explicit single-variable logarithmic factor, and then estimate the algebraic convergence of a tensor-product Gauss-type quadrature applied to the transformed integral.\n\nTasks:\n- Parametrize the reference triangle $\\widehat{\\Delta} = \\{ (\\lambda_{1}, \\lambda_{2}) \\in \\mathbb{R}^{2} : \\lambda_{1} \\ge 0, \\lambda_{2} \\ge 0, \\lambda_{1} + \\lambda_{2} \\le 1 \\}$ via $\\mathbf{r}(\\lambda_{1}, \\lambda_{2}) = \\mathbf{r}_{1} + \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b}$ with $\\mathbf{a} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$ and $\\mathbf{b} = \\mathbf{r}_{3} - \\mathbf{r}_{1}$, and similarly for $\\mathbf{r}'(\\mu_{1}, \\mu_{2})$. Using only fundamental geometric and measure-theoretic facts, construct a Duffy-type transformation on a representative near-diagonal subdomain where the barycentric coordinates satisfy $\\mu_{i} \\le \\lambda_{i}$ for $i=1,2,3$ (with $\\lambda_{3} = 1 - \\lambda_{1} - \\lambda_{2}$ and $\\mu_{3} = 1 - \\mu_{1} - \\mu_{2}$). In this subdomain, enforce the relation $\\boldsymbol{\\mu} = \\zeta \\boldsymbol{\\lambda}$ with a scalar collapse parameter $\\zeta \\in [0,1]$ and show that the distance behaves as $\\rho \\asymp (1 - \\zeta)$ uniformly in $\\boldsymbol{\\lambda}$ away from the triangle’s edges, while the transformation of the measure introduces a Jacobian factor proportional to $\\zeta^2$. Conclude that, after localization with a smooth partition of unity, the singular contribution reduces to a triple integral on $\\widehat{\\Delta} \\times [0,1]$ of the form\n$$\n\\int_{0}^{1} \\int_{\\widehat{\\Delta}} \\zeta^{2} \\, \\ln(1 - \\zeta) \\, G(\\lambda_{1}, \\lambda_{2}, \\zeta) \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2} \\, \\mathrm{d}\\zeta,\n$$\nwhere $G$ is smooth and strictly positive on the compact domain.\n\nNow suppose you approximate this triple integral using a tensor-product quadrature that consists of:\n- an $n$-point Gauss–Legendre rule in the $\\zeta$-variable on $[0,1]$, and\n- a single symmetric triangle quadrature of order $n$ on $\\widehat{\\Delta}$ using $\\mathcal{O}(n^{2})$ points for the $(\\lambda_{1}, \\lambda_{2})$ variables.\n\nLet $P$ denote the resulting total number of quadrature points required for this coincident-element contribution. By estimating the dominant quadrature error induced by the $\\zeta$-integration of the logarithmic endpoint singularity and using only established results on Gauss–Legendre accuracy for endpoint-logarithmic integrands and smoothness of $G$, determine the algebraic decay exponent $\\alpha$ such that the composite tensor-product quadrature error $E(P)$ satisfies\n$$\nE(P) = \\mathcal{O}\\!\\left( P^{-\\alpha} \\right) \\quad \\text{as} \\quad P \\to \\infty .\n$$\nProvide only the final exponent $\\alpha$ as a reduced fraction. No units are required.", "solution": "We begin from the setting of an integral operator on a flat triangle $\\Delta$ in $\\mathbb{R}^{3}$. Let $\\mathbf{a} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$ and $\\mathbf{b} = \\mathbf{r}_{3} - \\mathbf{r}_{1}$. The affine parametrization of the triangle is $\\mathbf{r}(\\lambda_{1}, \\lambda_{2}) = \\mathbf{r}_{1} + \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b}$ with $(\\lambda_{1}, \\lambda_{2}) \\in \\widehat{\\Delta} = \\{ \\lambda_{1} \\ge 0, \\lambda_{2} \\ge 0, \\lambda_{1} + \\lambda_{2} \\le 1 \\}$. The area element is $\\mathrm{d}S_{\\mathbf{r}} = |\\mathbf{a} \\times \\mathbf{b}| \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2}$. Similarly, parametrize $\\mathbf{r}'(\\mu_{1}, \\mu_{2}) = \\mathbf{r}_{1} + \\mu_{1} \\mathbf{a} + \\mu_{2} \\mathbf{b}$ with $(\\mu_{1}, \\mu_{2}) \\in \\widehat{\\Delta}$ and $\\mathrm{d}S_{\\mathbf{r}'} = |\\mathbf{a} \\times \\mathbf{b}| \\, \\mathrm{d}\\mu_{1} \\, \\mathrm{d}\\mu_{2}$.\n\nAfter Maue-type regularization of the hypersingular operator in computational electromagnetics, the remaining weakly singular kernel along the diagonal $\\{ \\mathbf{r} = \\mathbf{r}' \\}$ can be modeled to leading order as $c \\, \\ln \\rho$ with $\\rho = \\| \\mathbf{r} - \\mathbf{r}' \\|$ and some constant $c \\in \\mathbb{R}$, plus a smooth remainder. Because $\\phi$ and $\\psi$ are smooth on $\\Delta$, the local singular structure is governed by the geometry and the logarithm. We focus on a representative subdomain of $\\widehat{\\Delta} \\times \\widehat{\\Delta}$ in which the barycentric coordinates satisfy the componentwise ordering\n$$\n\\mu_{i} \\le \\lambda_{i} \\quad \\text{for} \\quad i = 1, 2, 3, \\qquad \\text{with} \\quad \\lambda_{3} = 1 - \\lambda_{1} - \\lambda_{2}, \\ \\ \\mu_{3} = 1 - \\mu_{1} - \\mu_{2}.\n$$\nOn this subdomain one may parameterize the inner point by a collapse parameter $\\zeta \\in [0,1]$ via $\\boldsymbol{\\mu} = \\zeta \\boldsymbol{\\lambda}$, i.e.,\n$$\n\\mu_{1} = \\zeta \\lambda_{1}, \\qquad \\mu_{2} = \\zeta \\lambda_{2}, \\qquad \\mu_{3} = \\zeta \\lambda_{3},\n$$\nso that $\\mathbf{r}'$ lies on the line segment between $\\mathbf{r}_{1}$ and $\\mathbf{r}$ in barycentric coordinates. This is a canonical Duffy-type mapping for coincident elements: it collapses the four-dimensional near-diagonal set onto a three-dimensional tensor-product set $\\widehat{\\Delta} \\times [0,1]$, and is paired with an analogous construction on the other five subdomains of $\\widehat{\\Delta} \\times \\widehat{\\Delta}$ defined by the permutations of the componentwise ordering.\n\nDistance scaling. With the above mapping,\n$$\n\\mathbf{r}' - \\mathbf{r} \\, = \\, \\left( \\zeta \\lambda_{1} - \\lambda_{1} \\right) \\mathbf{a} \\, + \\, \\left( \\zeta \\lambda_{2} - \\lambda_{2} \\right) \\mathbf{b} \\, = \\, - (1 - \\zeta) \\left( \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b} \\right),\n$$\nhence\n$$\n\\rho \\, = \\, \\| \\mathbf{r}' - \\mathbf{r} \\| \\, = \\, (1 - \\zeta) \\, \\| \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b} \\|.\n$$\nIn a compact neighborhood that excludes a thin layer near the triangle’s edges (which can be handled by a standard partition of unity and local edge charts), $\\| \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b} \\|$ is bounded above and below by fixed positive constants, so\n$$\n\\rho \\asymp (1 - \\zeta) \\quad \\text{uniformly in} \\quad (\\lambda_{1}, \\lambda_{2}) \\in \\widehat{\\Delta}_{\\mathrm{int}} \\subset \\widehat{\\Delta},\n$$\nand therefore\n$$\n\\ln \\rho \\, = \\, \\ln(1 - \\zeta) \\, + \\, \\ln \\| \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b} \\| .\n$$\nThe second term is smooth in $(\\lambda_{1}, \\lambda_{2})$, so the only non-smooth dependence is the factor $\\ln(1 - \\zeta)$ in the new variable $\\zeta$.\n\nMeasure transformation. The transformation of the 4D integration measure $\\mathrm{d}S_{\\mathbf{r}} \\, \\mathrm{d}S_{\\mathbf{r}'} = |\\mathbf{a} \\times \\mathbf{b}|^2 \\, \\mathrm{d}\\lambda_1 \\, \\mathrm{d}\\lambda_2 \\, \\mathrm{d}\\mu_1 \\, \\mathrm{d}\\mu_2$ introduces a Jacobian. As modeled by the problem, this factor is taken to be $\\zeta^2$, derived conceptually from the two-dimensional scaling $\\boldsymbol{\\mu} = \\zeta \\boldsymbol{\\lambda}$. Thus, after localization and absorbing smooth, strictly positive factors into a smooth integrand, the singular contribution reduces to the triple integral\n$$\n\\int_{0}^{1} \\int_{\\widehat{\\Delta}} \\zeta^{2} \\, \\ln(1 - \\zeta) \\, G(\\lambda_{1}, \\lambda_{2}, \\zeta) \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2} \\, \\mathrm{d}\\zeta,\n$$\nwith $G \\in C^{\\infty}(\\widehat{\\Delta} \\times [0,1])$ and bounded above and below by positive constants on the compact domain.\n\nQuadrature design and error in the $\\zeta$-direction. Consider a tensor-product quadrature consisting of:\n- an $n$-point Gauss–Legendre rule in $\\zeta \\in [0,1]$, and\n- a fixed-order symmetric triangle rule of order $n$ on $\\widehat{\\Delta}$, which uses $\\mathcal{O}(n^{2})$ evaluation points.\n\nThe total number of quadrature points is therefore\n$$\nP \\, = \\, C_{0} \\, n \\, \\times \\, C_{1} \\, n^{2} \\, = \\, C \\, n^{3} ,\n$$\nfor some constants $C_{0}, C_{1}, C  0$ independent of $n$, so that $n \\asymp P^{1/3}$.\n\nSince $G$ is smooth in all variables, the only non-smooth factor is $\\ln(1 - \\zeta)$ multiplied by the smooth weight $\\zeta^{2}$. For integrals of the form\n$$\n\\int_{0}^{1} \\ln(1 - \\zeta) \\, \\widetilde{g}(\\zeta) \\, \\mathrm{d}\\zeta,\n$$\nwith $\\widetilde{g} \\in C^{\\infty}[0,1]$, standard error estimates for Gauss–Legendre quadrature on endpoint-logarithmic singularities (an established fact in numerical analysis of orthogonal polynomial quadrature) yield an algebraic decay\n$$\nE_{\\zeta}(n) \\, = \\, \\mathcal{O}\\!\\left( n^{-2} \\right)\n$$\nfor the $\\zeta$-integration. The smooth $(\\lambda_{1}, \\lambda_{2})$-integration over the triangle yields superalgebraic (or at least high-order algebraic) convergence with respect to the triangle rule order, and thus does not dominate the overall convergence rate. Consequently, the overall error of the tensor-product quadrature is governed by the $\\zeta$-direction and satisfies\n$$\nE(n) \\, = \\, \\mathcal{O}\\!\\left( n^{-2} \\right) .\n$$\n\nExpressing the error in terms of the total number of points $P \\asymp n^{3}$, we obtain\n$$\nE(P) \\, = \\, \\mathcal{O}\\!\\left( \\left( P^{1/3} \\right)^{-2} \\right) \\, = \\, \\mathcal{O}\\!\\left( P^{-2/3} \\right) .\n$$\nTherefore, the requested algebraic decay exponent is\n$$\n\\alpha \\, = \\, \\frac{2}{3} .\n$$\n\nThis conclusion is robust under the inclusion of the other five near-diagonal subdomains (arising from the other permutations of the componentwise ordering of barycentric coordinates), since each contributes the same $\\zeta$-endpoint logarithm and a similar polynomial Jacobian factor, and all constants remain uniformly bounded away from zero and infinity on the compact domains after localization. The smooth remainder of the kernel and the non-coincident element pairs produce smooth integrals whose quadrature errors decay at least as fast as the dominant near-diagonal contribution analyzed here.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3316164"}, {"introduction": "A successful numerical method must not only be accurate but also stable, especially in challenging regimes like the low-frequency limit as the wavenumber $k \\to 0$. This practice explores the crucial concept of inf-sup stability in the context of a mixed discretization of the hypersingular operator [@problem_id:3316178]. Using a minimal but powerful discrete model, you will compute the stability constant and verify why certain function pairings provide the robustness required for reliable real-world simulations.", "problem": "Consider the exterior time-harmonic Maxwell boundary integral formulation for a simply connected, open, planar surface embedded in three-dimensional space. The hypersingular boundary integral operator arises when formulating Neumann-type conditions and is known to be unstable in naive Galerkin discretizations. A standard, physically sound regularization is obtained by integrating by parts on the surface and using a representation in terms of tangential derivatives of the single-layer potential, commonly referred to as Maue-type regularization. In a discrete context, stability as the wavenumber $k \\to 0$ requires a compatible choice of trial and test spaces. A pairing that guarantees stability is the use of Rao–Wilton–Glisson (RWG) trial functions with Buffa–Christiansen (BC) testing functions. Your task is to derive and implement a minimal, self-contained, stable discrete representation of the regularized hypersingular operator with RWG trials and BC tests on the simplest nontrivial triangular mesh, and then analyze the discrete inf-sup constant as $k \\to 0$.\n\nStart from the following well-established, fundamental base:\n- Maxwell equations in the frequency domain with wavenumber $k$ and the associated free-space Green’s function for the Helmholtz equation.\n- The boundary integral representation in terms of single-layer operators on the surface and their tangential differential operators on the surface, which yields a regularized form of the hypersingular operator through integration by parts.\n- The discrete de Rham sequence on a triangle mesh, where RWG functions live on primal edges and BC functions live on dual edges, connected by incidence matrices that represent surface differential operators in a metric-free manner.\n\nTo make the computation explicit and fully reproducible in a single program without external geometry files, use the following minimal model for the mesh and the discrete operators:\n- Geometry and mesh: a unit square in the plane $z=0$ is split into $2$ right triangles sharing one interior edge. The two triangles are the only faces. There is exactly one interior edge, which is the only RWG degree of freedom. The two faces define the BC test space through the dual complex, resulting in exactly one BC degree of freedom paired with the interior edge.\n- Discrete surface curl/incidence: denote by $C \\in \\mathbb{R}^{2 \\times 1}$ the oriented face-edge incidence matrix mapping the single interior primal edge to the two faces. For a consistent orientation, take $C = [1,-1]^\\top$.\n- Discrete single-layer approximation on faces: model the regularized single-layer operator by the inverse of a discrete Helmholtz operator on the face graph. Let $L \\in \\mathbb{R}^{2 \\times 2}$ be the graph Laplacian of the two-face adjacency, $L = \\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$. For $k0$, define $V_k = (L + k^2 I)^{-1}$. For $k=0$, define $V_0$ as the Moore–Penrose pseudoinverse of $L$, which is consistent with the static limit and correctly handles the constant nullspace on the open surface. This choice is a consistent, metric-free surrogate of a mass-lumped Laplace–Beltrami-based regularization of the single-layer operator and preserves the correct nullspace structure as $k \\to 0$.\n- Regularized hypersingular operator in mixed form: using Maue-type regularization and the RWG–BC pairing, the discrete bilinear form can be modeled as the $1 \\times 1$ matrix\n$$\nB_k \\equiv C^{\\top} V_k C \\in \\mathbb{R}^{1 \\times 1}.\n$$\nThis is the graph-Helmholtz surrogate of the continuous regularized hypersingular operator tested with BC and trialed with RWG.\n- Norms and inf-sup constant: to isolate the stability properties of the pairing, use identity mass matrices for both RWG and BC spaces, $M_{\\mathrm{RWG}} = 1$ and $M_{\\mathrm{BC}} = 1$. The discrete inf-sup constant is then the smallest singular value of $M_{\\mathrm{BC}}^{-1/2} B_k M_{\\mathrm{RWG}}^{-1/2}$, which reduces to the absolute value of $B_k$ because the matrix is $1 \\times 1$.\n\nTasks:\n1) From the fundamental base above, argue why a Maue-type regularization leads, at the discrete level, to a representation of the form $B_k = C^{\\top} V_k C$ with the definitions given, and why $V_0$ must be a pseudoinverse to handle the static nullspace. Do not introduce any other unreferenced modeling assumption.\n2) Implement a program that constructs $C$, $L$, and $V_k$ for the given mesh, assembles $B_k = C^{\\top} V_k C$, and computes the discrete inf-sup constant as the minimal singular value of $B_k$.\n3) For the test suite below, compute the discrete inf-sup constant for each $k$ and report the results. All outputs are dimensionless real numbers.\n\nTest suite:\n- Case $1$ (happy path): $k = 1.0$.\n- Case $2$ (moderately small): $k = 0.1$.\n- Case $3$ (very small): $k = 10^{-6}$.\n- Case $4$ (static limit): $k = 0.0$ (use the Moore–Penrose pseudoinverse for $V_0$).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the four cases in the order given, for example, $[r_1,r_2,r_3,r_4]$.", "solution": "### 1. Theoretical Justification of the Discrete Model\n\nThe task is to justify the discrete representation $B_k = C^{\\top} V_k C$ for the regularized hypersingular operator and the use of a pseudoinverse at the static limit $k=0$.\n\n#### 1.1. Maue-type Regularization and the a discrete form $C^{\\top} V_k C$\n\nThe hypersingular operator, often denoted $\\mathcal{K}$, arises in boundary integral formulations of Maxwell's equations. In the context of the electric field integral equation (EFIE), the operator acting on the surface current density $\\mathbf{J}$ is given by $\\mathcal{A}(\\mathbf{J}) = i\\omega\\mu_0 \\mathcal{S}_k(\\mathbf{J}) + \\frac{1}{i\\omega\\epsilon_0} \\mathcal{K}(\\mathbf{J})$, where $\\mathcal{S}_k$ is the single-layer potential operator and $\\mathcal{K}$ is the hypersingular operator. The wavenumber is $k = \\omega\\sqrt{\\mu_0 \\epsilon_0}$.\n\nA naive discretization of $\\mathcal{K}$ is numerically unstable. Maue-type regularization is a standard procedure to overcome this instability. It relies on the identity $\\mathcal{K}(\\mathbf{J}) = (\\nabla_S \\nabla_S \\cdot + k^2 \\mathbf{I}) \\mathcal{S}_k(\\mathbf{J})$, where $\\nabla_S$ and $\\nabla_S \\cdot$ are the surface gradient and divergence, respectively. The weak form of the hypersingular operator, when tested with a function $\\mathbf{g}$, is $\\langle \\mathbf{g}, \\mathcal{K}(\\mathbf{f}) \\rangle$, where $\\mathbf{f}$ is the trial function. Using integration by parts on the surface (the surface vector Green's identity), the problematic $\\nabla_S \\nabla_S \\cdot$ term is regularized:\n$$\n\\langle \\mathbf{g}, \\mathcal{K}(\\mathbf{f}) \\rangle = \\langle \\nabla_S \\cdot \\mathbf{g}, \\mathcal{S}_k(\\nabla_S \\cdot \\mathbf{f}) \\rangle + k^2 \\langle \\mathbf{g}, \\mathcal{S}_k(\\mathbf{f}) \\rangle\n$$\nThis form is stable and is the basis for modern finite element boundary element methods. The low-frequency ($k \\to 0$) stability of this formulation critically depends on the choice of trial space for $\\mathbf{f}$ and test space for $\\mathbf{g}$. The pairing of Rao-Wilton-Glisson (RWG) functions for $\\mathbf{f}$ and Buffa-Christiansen (BC) functions for $\\mathbf{g}$ is known to provide a stable discretization that is robust as $k \\to 0$.\n\nThe problem provides a minimal, metric-free discrete model of this formulation. Let's analyze its components:\n-   **Trial and Test Functions**: The single degree of freedom for the RWG trial function corresponds to a coefficient for the basis function on the single interior edge. The single degree of freedom for the BC test function is associated with this edge via the dual mesh.\n-   **Discrete Surface Divergence $C$**: The RWG basis function associated with an edge has a surface divergence that is piecewise constant, taking opposite values on the two adjacent faces. The problem models this mapping from the edge-based coefficient to the face-based coefficients of the divergence with the matrix $C = [1, -1]^{\\top} \\in \\mathbb{R}^{2 \\times 1}$. This matrix is an oriented face-edge incidence matrix and serves as a discrete, metric-free representation of the surface divergence operator, $\\nabla_S \\cdot$.\n-   **Discrete Single-Layer Operator $V_k$**: The single-layer operator $\\mathcal{S}_k$ is the solution operator for the surface Helmholtz equation, $(-\\Delta_S + k^2) u = \\sigma$, where $\\sigma$ is a surface source density and $u$ is the resulting potential. Its discrete counterpart, $V_k$, maps coefficients of a discrete source on faces to coefficients of a discrete potential on faces. The expression $V_k = (L + k^2 I)^{-1}$ is a canonical model for a discrete Helmholtz operator, where $L$ is the graph Laplacian representing $-\\Delta_S$ and $k^2 I$ is the mass term. The given Laplacian $L = \\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$ is the correct graph Laplacian for a mesh of two faces sharing one edge.\n-   **Adjoint Operator for Testing**: In a Petrov-Galerkin scheme, the operator applied to the test functions in the weak form is the adjoint of the operator applied to the trial functions. In this discrete, metric-free setting with identity mass matrices, the adjoint of the discrete divergence $C$ is its transpose, $C^{\\top}$.\n\nCombining these elements, the dominant term of the regularized bilinear form, $\\langle \\nabla_S \\cdot \\mathbf{g}, \\mathcal{S}_k(\\nabla_S \\cdot \\mathbf{f}) \\rangle$, is discretized as $C^{\\top} V_k C$. The second term, $k^2 \\langle \\mathbf{g}, \\mathcal{S}_k(\\mathbf{f}) \\rangle$, is of higher order in $k$ and its stability is less critical. The chosen model $B_k = C^\\top V_k C$ focuses on the principal structure responsible for low-frequency behavior and is a well-established paradigm in discrete exterior calculus.\n\n#### 1.2. The Static Limit ($k=0$) and the Moore-Penrose Pseudoinverse\n\nWhen the wavenumber $k$ is set to $0$, the discrete operator $V_k$ becomes $V_0 = (L + 0^2 I)^{-1} = L^{-1}$. We must analyze the matrix $L = \\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$. The columns are linearly dependent, and the vector $[1, 1]^\\top$ is in its nullspace, as $L[1, 1]^\\top = [0, 0]^\\top$. Therefore, $L$ is singular and its standard inverse does not exist.\n\nThis singularity has a physical and mathematical basis. The matrix $L$ represents the static Laplace-Beltrami operator, $-\\Delta_S$. On a surface without a boundary (or with natural boundary conditions, as is the case here), the nullspace of the Laplacian consists of constant functions. The vector $[1, 1]^\\top$ represents the constant function on the two faces of the mesh.\n\nHowever, the operator $L$ does not act on an arbitrary vector. It acts on the output of the discrete divergence operator, $C$. For a single RWG coefficient $x \\in \\mathbb{R}^1$, the resulting divergence vector is $Cx = [x, -x]^\\top$. The sum of the elements of this vector is $x - x = 0$. This means the vector $Cx$ is orthogonal to the nullspace of $L$ (since $\\langle [x, -x]^\\top, [1, 1]^\\top \\rangle = x - x = 0$).\n\nTherefore, the vector $Cx$ lies in the range of the operator $L$. The equation $L\\mathbf{y} = Cx$ is consistent and has solutions for $\\mathbf{y}$. The solution is not unique; if $\\mathbf{y}_p$ is a particular solution, the general solution is $\\mathbf{y}_p + \\alpha [1, 1]^\\top$ for any scalar $\\alpha$. To obtain a unique, well-defined operator, we must select a specific solution. The standard choice is the unique solution that is itself orthogonal to the nullspace of $L$. The Moore-Penrose pseudoinverse, $L^+$, provides precisely this solution.\n\nThus, for the static case $k=0$, the correct definition for the single-layer operator is $V_0 = L^+$. This procedure is mathematically sound and corresponds physically to enforcing a zero-mean condition on the potential, which is appropriate for the balanced-charge distributions produced by the divergence of interior RWG functions. The continuity of the limit $\\lim_{k\\to 0} V_k = L^+$ further affirms this choice.\n\n### 2. Computation of the Inf-Sup Constant\n\nThe discrete inf-sup constant $\\gamma_k$ is the smallest singular value of the matrix $B_k = C^{\\top} V_k C$. Since $B_k$ is a $1 \\times 1$ matrix (a scalar), its singular value is simply its absolute value, $\\gamma_k = |B_k|$.\n\n#### Case 1: $k > 0$\nThe operator matrix is $L + k^2 I = \\begin{bmatrix} 1+k^2  -1 \\\\ -1  1+k^2 \\end{bmatrix}$.\nThe determinant is $\\det(L + k^2 I) = (1+k^2)^2 - 1 = 1 + 2k^2 + k^4 - 1 = k^2(2+k^2)$.\nThe inverse is $V_k = (L + k^2 I)^{-1} = \\frac{1}{k^2(2+k^2)} \\begin{bmatrix} 1+k^2  1 \\\\ 1  1+k^2 \\end{bmatrix}$.\n\nWe now assemble $B_k = C^{\\top} V_k C$:\n$$\nB_k = \\begin{bmatrix} 1  -1 \\end{bmatrix} \\left( \\frac{1}{k^2(2+k^2)} \\begin{bmatrix} 1+k^2  1 \\\\ 1  1+k^2 \\end{bmatrix} \\right) \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}\n$$\nFirst, $C^{\\top}V_k$:\n$$\nC^{\\top}V_k = \\frac{1}{k^2(2+k^2)} \\begin{bmatrix} (1+k^2)-1  1-(1+k^2) \\end{bmatrix} = \\frac{1}{k^2(2+k^2)} \\begin{bmatrix} k^2  -k^2 \\end{bmatrix} = \\frac{1}{2+k^2} \\begin{bmatrix} 1  -1 \\end{bmatrix}\n$$\nThen, $(C^{\\top}V_k)C$:\n$$\nB_k = \\left( \\frac{1}{2+k^2} \\begin{bmatrix} 1  -1 \\end{bmatrix} \\right) \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} = \\frac{1}{2+k^2} (1\\cdot 1 + (-1)\\cdot(-1)) = \\frac{2}{2+k^2}\n$$\nThe inf-sup constant is $\\gamma_k = |B_k| = \\frac{2}{2+k^2}$, which is positive for all real $k$.\n\n#### Case 2: $k_0 = 0$\nWe compute the Moore-Penrose pseudoinverse of $L = \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}$. The spectral decomposition of $L$ yields eigenvalues $\\lambda_1 = 2$ and $\\lambda_2=0$. The pseudoinverse is formed by inverting the non-zero eigenvalues.\n$L$ has the spectral decomposition $L = \\lambda_1 \\mathbf{u}_1 \\mathbf{u}_1^\\top + \\lambda_2 \\mathbf{u}_2 \\mathbf{u}_2^\\top$, where $\\mathbf{u}_1 = \\frac{1}{\\sqrt{2}}[1, -1]^\\top$ and $\\mathbf{u}_2 = \\frac{1}{\\sqrt{2}}[1, 1]^\\top$.\nThe pseudoinverse is $V_0 = L^+ = \\frac{1}{\\lambda_1} \\mathbf{u}_1 \\mathbf{u}_1^\\top$:\n$$\nV_0 = \\frac{1}{2} \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1  -1 \\end{bmatrix} \\right) = \\frac{1}{4} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\nNow we assemble $B_0 = C^{\\top} V_0 C$:\n$$\nB_0 = \\begin{bmatrix} 1  -1 \\end{bmatrix} \\left( \\frac{1}{4} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\right) \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} = \\frac{1}{4} \\begin{bmatrix} 2  -2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} = \\frac{1}{4} (2 - (-2)) = \\frac{4}{4} = 1\n$$\nThe inf-sup constant is $\\gamma_0 = |B_0| = 1$. This result is consistent with the limit of the general formula as $k \\to 0$: $\\lim_{k\\to 0} \\frac{2}{2+k^2} = 1$. The stability constant is bounded away from zero, demonstrating the robustness of the formulation.\n\n### 3. Numerical Results for the Test Suite\n-   Case 1 ($k=1.0$): $\\gamma_{1.0} = \\frac{2}{2+1^2} = \\frac{2}{3} \\approx 0.6667$\n-   Case 2 ($k=0.1$): $\\gamma_{0.1} = \\frac{2}{2+0.1^2} = \\frac{2}{2.01} \\approx 0.9950$\n-   Case 3 ($k=10^{-6}$): $\\gamma_{10^{-6}} = \\frac{2}{2+(10^{-6})^2} = \\frac{2}{2+10^{-12}} \\approx 1.0$\n-   Case 4 ($k=0.0$): $\\gamma_0 = 1.0$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the discrete inf-sup constant for a minimal model of a\n    regularized hypersingular operator with RWG-BC basis functions.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        1.0,        # Case 1: happy path\n        0.1,        # Case 2: moderately small k\n        1e-6,       # Case 3: very small k\n        0.0,        # Case 4: static limit\n    ]\n\n    # Define the discrete operators based on the provided minimal model.\n    # C is the discrete surface curl/incidence matrix (2x1).\n    C = np.array([[1.0], [-1.0]])\n    \n    # L is the graph Laplacian for the two-face adjacency (2x2).\n    L = np.array([[1.0, -1.0], [-1.0, 1.0]])\n    \n    # I is the identity matrix (2x2).\n    I = np.eye(2)\n\n    results = []\n    for k in test_cases:\n        # For k  0, the discrete single-layer operator V_k is the inverse of\n        # the discrete Helmholtz operator (L + k^2 * I).\n        if k  0.0:\n            V_k = np.linalg.inv(L + k**2 * I)\n        # For k = 0, the operator L is singular. We use the Moore-Penrose\n        # pseudoinverse, which correctly handles the static nullspace.\n        else:\n            V_k = np.linalg.pinv(L)\n        \n        # Assemble the discrete bilinear form B_k = C^T * V_k * C.\n        # The result is a 1x1 matrix.\n        B_k_matrix = C.T @ V_k @ C\n        \n        # The discrete inf-sup constant is the smallest singular value of B_k.\n        # For a 1x1 matrix [b], this is simply its absolute value |b|.\n        inf_sup_constant = np.abs(B_k_matrix[0, 0])\n        \n        results.append(inf_sup_constant)\n\n    # Final print statement in the exact required format.\n    # e.g., [r_1,r_2,r_3,r_4]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3316178"}]}