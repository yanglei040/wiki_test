{"hands_on_practices": [{"introduction": "A fundamental skill in computational electromagnetics is the ability to derive stability criteria from first principles. This exercise guides you through the complete von Neumann analysis for the 3D Finite-Difference Time-Domain (FDTD) method, starting from Maxwell's equations and the Yee discretization [@problem_id:3360079]. By deriving the numerical dispersion relation, you will uncover the origin of the Courant-Friedrichs-Lewy (CFL) condition and learn how to adapt it for practical scenarios like anisotropic grids.", "problem": "Consider the homogeneous, source-free Maxwell curl equations in vacuum,\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t}=-\\nabla\\times\\mathbf{E},\\qquad \\frac{\\partial \\mathbf{D}}{\\partial t}=\\nabla\\times\\mathbf{H},\n$$\ntogether with the constitutive relations in vacuum, $\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ and $\\mathbf{B}=\\mu_{0}\\mathbf{H}$, where $c=1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$ is the speed of light. Discretize these equations using the canonical second-order centered Yee finite-difference time-domain (FDTD) scheme on a three-dimensional rectilinear grid with spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$ and leapfrog time step $\\Delta t$, with electric and magnetic fields staggered in both space and time in the standard Yee arrangement.\n\n1) By applying a discrete plane-wave ansatz of the form\n$$\n\\mathbf{E}^{n}(\\mathbf{r}_{\\mathbf{m}})=\\mathbf{E}_{0}\\,G^{n}\\,\\exp\\!\\big(i(m_{x}\\theta_{x}+m_{y}\\theta_{y}+m_{z}\\theta_{z})\\big),\\qquad\n\\mathbf{H}^{n+\\frac{1}{2}}(\\mathbf{r}_{\\mathbf{m}+\\frac{1}{2}})=\\mathbf{H}_{0}\\,G^{n+\\frac{1}{2}}\\,\\exp\\!\\big(i(m_{x}\\theta_{x}+m_{y}\\theta_{y}+m_{z}\\theta_{z})\\big),\n$$\nwith $\\theta_{x}=k_{x}\\Delta x$, $\\theta_{y}=k_{y}\\Delta y$, $\\theta_{z}=k_{z}\\Delta z$, derive the discrete numerical dispersion relation linking the discrete angular frequency $\\omega$ and wave numbers $k_{x}$, $k_{y}$, $k_{z}$ through the identification $G=\\exp(-i\\omega\\Delta t)$. Your derivation must start from the Maxwell curl equations and the Yee centered-difference approximations, and proceed through the von Neumann analysis that eliminates the field amplitudes in favor of a scalar relation between $\\omega$, $k_{x}$, $k_{y}$, $k_{z}$, and the spacings.\n\n2) Explain how the obtained numerical dispersion relation implies a stability constraint on the time step in terms of the requirement that the amplification factor have magnitude less than or equal to unity for all resolvable spatial frequencies.\n\n3) Specialize your result to the case of a mesh with $\\Delta x=\\Delta$, $\\Delta y=2\\Delta$, and $\\Delta z=3\\Delta$, and define the Courant number $\\sigma=c\\,\\Delta t/\\Delta$. What is the maximal admissible Courant number $\\sigma_{\\max}$ ensuring stability for all discrete wave numbers? Provide your final answer as a single exact value without units. Do not provide an inequality.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information to derive a unique solution. It represents a standard and fundamental analysis in computational electromagnetics. We may therefore proceed with the solution.\n\nThe solution is divided into three parts as requested by the problem statement.\n\n1) Derivation of the numerical dispersion relation.\n\nWe begin with the source-free Maxwell's curl equations in a vacuum:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t}=-\\nabla\\times\\mathbf{E}\n$$\n$$\n\\frac{\\partial \\mathbf{D}}{\\partial t}=\\nabla\\times\\mathbf{H}\n$$\nUsing the constitutive relations $\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ and $\\mathbf{B}=\\mu_{0}\\mathbf{H}$, these become:\n$$\n\\mu_{0}\\frac{\\partial \\mathbf{H}}{\\partial t}=-\\nabla\\times\\mathbf{E}\n$$\n$$\n\\varepsilon_{0}\\frac{\\partial \\mathbf{E}}{\\partial t}=\\nabla\\times\\mathbf{H}\n$$\nThe Yee FDTD scheme discretizes these equations on a staggered grid. The leapfrog scheme updates the electric and magnetic fields at alternating half-time steps. The centered finite-difference update equations are:\n$$\n\\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^{n}}{\\Delta t} = \\frac{1}{\\varepsilon_{0}} \\hat{\\nabla} \\times \\mathbf{H}^{n+\\frac{1}{2}}\n$$\n$$\n\\frac{\\mathbf{H}^{n+\\frac{1}{2}} - \\mathbf{H}^{n-\\frac{1}{2}}}{\\Delta t} = -\\frac{1}{\\mu_{0}} \\hat{\\nabla} \\times \\mathbf{E}^{n}\n$$\nwhere $\\hat{\\nabla}\\times$ is the discrete curl operator, and the fields are evaluated at their respective staggered locations in space and time.\n\nTo perform the von Neumann stability analysis, we substitute the discrete plane-wave ansatz given in the problem:\n$$\n\\mathbf{E}^{n}(\\mathbf{r}_{\\mathbf{m}}) = \\mathbf{E}_{0}\\,G^{n}\\,\\exp\\!\\big(i(m_{x}k_{x}\\Delta x+m_{y}k_{y}\\Delta y+m_{z}k_{z}\\Delta z)\\big)\n$$\n$$\n\\mathbf{H}^{n+\\frac{1}{2}}(\\mathbf{r}_{\\mathbf{m}+\\frac{1}{2}}) = \\mathbf{H}_{0}\\,G^{n+\\frac{1}{2}}\\,\\exp\\!\\big(i(m_{x}k_{x}\\Delta x+m_{y}k_{y}\\Delta y+m_{z}k_{z}\\Delta z)\\big)\n$$\nThe action of the centered spatial difference operators on this ansatz transforms them into multiplication by complex exponential factors. For example, for the $x$-component of the curl operator acting on the $E_z$ field component to update $H_y$:\n$$\n(\\hat{\\nabla}\\times\\mathbf{E})_y \\propto \\frac{E_x|_{k+1/2}-E_x|_{k-1/2}}{\\Delta z} - \\frac{E_z|_{i+1/2}-E_z|_{i-1/2}}{\\Delta x}\n$$\nSubstituting the ansatz for $E_z$ into the second term gives:\n$$\n\\frac{E_{0,z} G^n e^{i k_x (i+1/2)\\Delta x} \\dots - E_{0,z} G^n e^{i k_x (i-1/2)\\Delta x} \\dots}{\\Delta x} = \\frac{E_z^n}{\\Delta x} \\left( e^{i k_x \\Delta x / 2} - e^{-i k_x \\Delta x / 2} \\right) = \\frac{2i}{\\Delta x}\\sin\\left(\\frac{k_x\\Delta x}{2}\\right)E_z^n\n$$\nThus, the discrete curl operator $\\hat{\\nabla}\\times$ acting on the plane-wave ansatz is equivalent to multiplication by the vector operator $i\\mathbf{k}_{\\text{eff}}$, where $\\mathbf{k}_{\\text{eff}}$ is the effective numerical wave vector with components:\n$$\nk_{\\text{eff},x} = \\frac{2}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right), \\quad k_{\\text{eff},y} = \\frac{2}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right), \\quad k_{\\text{eff},z} = \\frac{2}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\n$$\nThe action of the time-stepping operators on the ansatz is:\n$$\n\\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^{n}}{\\Delta t} \\rightarrow \\frac{G^{n+1}\\mathbf{E}_0 - G^{n}\\mathbf{E}_0}{\\Delta t} \\dots = \\frac{G-1}{\\Delta t} \\mathbf{E}^n\n$$\n$$\n\\frac{\\mathbf{H}^{n+1/2} - \\mathbf{H}^{n-\\frac{1}{2}}}{\\Delta t} \\rightarrow \\frac{G^{n+1/2}\\mathbf{H}_0 - G^{n-1/2}\\mathbf{H}_0}{\\Delta t} \\dots = \\frac{G-1}{\\Delta t} \\mathbf{H}^{n-1/2}\n$$\nA more direct approach is to substitute the ansatz into the full update equations. For the electric field update:\n$$\n\\frac{\\mathbf{E}_{0}G^{n+1} - \\mathbf{E}_{0}G^{n}}{\\Delta t} = \\frac{1}{\\varepsilon_{0}} (i\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0}) G^{n+\\frac{1}{2}}\n$$\nDividing by $G^{n}$ and common spatial terms:\n$$\n\\frac{\\mathbf{E}_{0}(G - 1)}{\\Delta t} = \\frac{i}{\\varepsilon_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0}) G^{\\frac{1}{2}} \\implies \\mathbf{E}_{0}(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}}) = \\frac{i\\Delta t}{\\varepsilon_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0})\n$$\nFor the magnetic field update:\n$$\n\\frac{\\mathbf{H}_{0}G^{n+\\frac{1}{2}} - \\mathbf{H}_{0}G^{n-\\frac{1}{2}}}{\\Delta t} = -\\frac{1}{\\mu_{0}} (i\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) G^{n}\n$$\nDividing by $G^{n-1/2}$:\n$$\n\\frac{\\mathbf{H}_{0}(G - 1)}{\\Delta t} = -\\frac{i}{\\mu_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) G^{\\frac{1}{2}} \\implies \\mathbf{H}_{0}(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}}) = -\\frac{i\\Delta t}{\\mu_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})\n$$\nLet the term $(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}})$ be denoted by $A$. We have a system of two algebraic vector equations:\n$$\n(1) \\quad \\varepsilon_{0} A \\mathbf{E}_{0} = i\\Delta t (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0})\n$$\n$$\n(2) \\quad \\mu_{0} A \\mathbf{H}_{0} = -i\\Delta t (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})\n$$\nWe eliminate $\\mathbf{H}_{0}$ by substituting from $(2)$ into $(1)$. From $(2)$, $\\mathbf{H}_{0} = -\\frac{i\\Delta t}{\\mu_{0}A}(\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})$.\n$$\n\\varepsilon_{0} A \\mathbf{E}_{0} = i\\Delta t \\left( \\mathbf{k}_{\\text{eff}} \\times \\left( -\\frac{i\\Delta t}{\\mu_{0}A}(\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) \\right) \\right) = \\frac{(\\Delta t)^2}{\\mu_0 A} \\left( \\mathbf{k}_{\\text{eff}} \\times (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) \\right)\n$$\nUsing the vector identity $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a} \\cdot \\mathbf{c}) - \\mathbf{c}(\\mathbf{a} \\cdot \\mathbf{b})$ and the fact that for a transverse wave $\\mathbf{k}_{\\text{eff}} \\cdot \\mathbf{E}_{0} = 0$, we have $\\mathbf{k}_{\\text{eff}} \\times (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) = -k_{\\text{eff}}^2 \\mathbf{E}_{0}$.\n$$\n\\varepsilon_{0} A \\mathbf{E}_{0} = -\\frac{(\\Delta t)^2 k_{\\text{eff}}^2}{\\mu_0 A} \\mathbf{E}_{0}\n$$\nSince $\\mathbf{E}_0$ is non-zero, we can cancel it:\n$$\n\\mu_0 \\varepsilon_0 A^2 = -(\\Delta t)^2 k_{\\text{eff}}^2 \\implies \\frac{A^2}{c^2} = -(\\Delta t)^2 k_{\\text{eff}}^2\n$$\nNow, substitute $G = \\exp(-i\\omega\\Delta t)$. The term $A = G^{\\frac{1}{2}} - G^{-\\frac{1}{2}} = \\exp(-i\\omega\\Delta t/2) - \\exp(i\\omega\\Delta t/2) = -2i\\sin(\\omega\\Delta t/2)$.\nSo, $A^2 = -4\\sin^2(\\omega\\Delta t/2)$.\n$$\n\\frac{-4\\sin^2(\\omega\\Delta t/2)}{c^2} = -(\\Delta t)^2 k_{\\text{eff}}^2\n$$\n$$\n\\left(\\frac{2}{c \\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)\\right)^2 = k_{\\text{eff}}^2 = \\left(\\frac{2}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{2}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{2}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2\n$$\nSimplifying, we obtain the numerical dispersion relation:\n$$\n\\left(\\frac{1}{c \\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)\\right)^2 = \\left(\\frac{1}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2\n$$\n\n2) Implication for the stability constraint.\n\nFor the numerical scheme to be stable, the magnitude of the amplification factor $G$ must be less than or equal to one, i.e., $|G| \\le 1$, for all possible modes. If $|G|1$, any numerical error or field component will grow exponentially in time, rendering the simulation useless.\nThe relation $G=\\exp(-i\\omega\\Delta t)$ connects $G$ to the numerical frequency $\\omega$. If $\\omega$ is purely real, then $|G|=|\\exp(-i\\omega\\Delta t)|=1$. If $\\omega$ has an imaginary part, $\\omega = \\omega_R + i\\omega_I$, then $|G|=|\\exp(-i(\\omega_R+i\\omega_I)\\Delta t)| = |\\exp(\\omega_I \\Delta t)\\exp(-i\\omega_R \\Delta t)| = \\exp(\\omega_I \\Delta t)$. For stability ($|G|\\le 1$), we must have $\\omega_I \\le 0$. A solution with $\\omega_I  0$ is a decaying, non-physical mode, but it is stable. An exponentially growing mode ($\\omega_I  0$) corresponds to instability.\n\nThe dispersion relation can be rearranged to solve for $\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)$:\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\pm c\\Delta t \\sqrt{\\left(\\frac{1}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2}\n$$\nFor $\\omega$ to be real, the term $\\sin(\\omega\\Delta t/2)$ must be a real number with a magnitude less than or equal to $1$. The RHS of the equation is always real. Therefore, the stability condition reduces to:\n$$\n\\left| \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right| \\le 1\n$$\nThis implies:\n$$\nc\\Delta t \\sqrt{\\left(\\frac{\\sin(k_x \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}\\right)^2 + \\left(\\frac{\\sin(k_z \\Delta z/2)}{\\Delta z}\\right)^2} \\le 1\n$$\nThis inequality must hold for all spatial frequencies $(k_x, k_y, k_z)$ that the grid can resolve. To ensure this, we must check the \"worst case\" that maximizes the left-hand side. The sine terms are maximized and equal to $1$ at the Nyquist frequencies, where $k_j \\Delta j = \\pi$ for $j \\in \\{x,y,z\\}$. Substituting $\\sin(k_j\\Delta j/2) = \\sin(\\pi/2)=1$ for all components yields the most restrictive condition:\n$$\nc\\Delta t \\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2 + \\left(\\frac{1}{\\Delta z}\\right)^2} \\le 1\n$$\nThis is the well-known Courant-Friedrichs-Lewy (CFL) stability condition for the 3D FDTD method.\n\n3) Maximal Courant number for the specified mesh.\n\nWe are given the mesh spacings $\\Delta x = \\Delta$, $\\Delta y = 2\\Delta$, and $\\Delta z = 3\\Delta$, and the Courant number is defined as $\\sigma = c\\Delta t/\\Delta$. We substitute these into the general stability condition derived in part 2):\n$$\nc\\Delta t \\sqrt{\\frac{1}{(\\Delta)^2} + \\frac{1}{(2\\Delta)^2} + \\frac{1}{(3\\Delta)^2}} \\le 1\n$$\nFactor out $1/\\Delta$ from the square root:\n$$\n\\frac{c\\Delta t}{\\Delta} \\sqrt{1 + \\frac{1}{4} + \\frac{1}{9}} \\le 1\n$$\nSubstitute the definition of the Courant number $\\sigma$:\n$$\n\\sigma \\sqrt{1 + \\frac{1}{4} + \\frac{1}{9}} \\le 1\n$$\nNow, we simplify the expression under the square root:\n$$\n1 + \\frac{1}{4} + \\frac{1}{9} = \\frac{36}{36} + \\frac{9}{36} + \\frac{4}{36} = \\frac{49}{36}\n$$\nThe inequality becomes:\n$$\n\\sigma \\sqrt{\\frac{49}{36}} \\le 1 \\implies \\sigma \\frac{7}{6} \\le 1\n$$\nThis gives the stability constraint on $\\sigma$:\n$$\n\\sigma \\le \\frac{6}{7}\n$$\nThe maximal admissible Courant number, $\\sigma_{\\max}$, is the value at the boundary of this inequality. Therefore,\n$$\n\\sigma_{\\max} = \\frac{6}{7}\n$$", "answer": "$$\\boxed{\\frac{6}{7}}$$", "id": "3360079"}, {"introduction": "Real-world materials often exhibit electrical conductivity, which introduces loss into the system. This practice explores how to extend the von Neumann stability analysis to include conductive media, revealing the relationship between physical loss and numerical stability [@problem_id:3360095]. You will find that the presence of conductivity enhances stability, leading to the important conclusion that the lossless case represents the most stringent stability constraint.", "problem": "Consider the three-dimensional Finite-Difference Time-Domain (FDTD) method (Yee scheme) for Maxwell’s equations in a homogeneous, isotropic, non-magnetic medium with electric permittivity $\\epsilon=\\epsilon_{0}\\epsilon_{r}$, magnetic permeability $\\mu=\\mu_{0}$, and finite electric conductivity $\\sigma \\ge 0$. The governing curl equations with conduction are\n$$\n\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t} + \\sigma \\mathbf{E} = \\nabla \\times \\mathbf{H}, \n\\qquad\n\\mu \\frac{\\partial \\mathbf{H}}{\\partial t} = - \\nabla \\times \\mathbf{E}.\n$$\nOn a uniform Yee grid with spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$, let $\\mathbf{E}$ be sampled at half-integer time steps $t^{n+1/2}$ and $\\mathbf{H}$ at integer time steps $t^{n}$. Use a centered-in-time discretization for the conduction term, i.e., approximate $\\sigma \\mathbf{E}$ at time $t^{n}$ by $\\sigma \\left(\\mathbf{E}^{n+1/2} + \\mathbf{E}^{n-1/2}\\right)/2$. This yields the standard explicit update of the form\n$$\n\\mathbf{E}^{n+1/2} = C_{\\mathrm{ea}}\\, \\mathbf{E}^{n-1/2} + C_{\\mathrm{eb}}\\, \\left(\\nabla_{\\mathrm{d}} \\times \\mathbf{H}^{n}\\right), \n\\qquad\n\\mathbf{H}^{n+1} = \\mathbf{H}^{n} - C_{\\mathrm{hb}}\\, \\left(\\nabla_{\\mathrm{d}} \\times \\mathbf{E}^{n+1/2}\\right),\n$$\nwhere $\\nabla_{\\mathrm{d}} \\times$ denotes the discrete curl and\n$$\n\\gamma \\equiv \\frac{\\sigma \\Delta t}{2 \\epsilon}, \n\\quad\nC_{\\mathrm{ea}} = \\frac{1-\\gamma}{1+\\gamma}, \n\\quad\nC_{\\mathrm{eb}} = \\frac{\\Delta t}{\\epsilon(1+\\gamma)}, \n\\quad\nC_{\\mathrm{hb}} = \\frac{\\Delta t}{\\mu}.\n$$\nPerform a von Neumann stability analysis by assuming discrete plane-wave solutions of the form $\\mathbf{E}^{n+1/2}(\\mathbf{r}) = \\tilde{\\mathbf{E}}\\, G^{n} \\exp(i \\mathbf{k}\\cdot \\mathbf{r})$ and $\\mathbf{H}^{n}(\\mathbf{r}) = \\tilde{\\mathbf{H}}\\, G^{n} \\exp(i \\mathbf{k}\\cdot \\mathbf{r})$, where $G$ is the amplification factor per Yee time step. The discrete curl acting on these modes introduces the factors\n$$\ns_{x} = \\frac{\\sin(k_{x} \\Delta x/2)}{\\Delta x}, \n\\quad\ns_{y} = \\frac{\\sin(k_{y} \\Delta y/2)}{\\Delta y}, \n\\quad\ns_{z} = \\frac{\\sin(k_{z} \\Delta z/2)}{\\Delta z}, \n\\quad\nS^{2} = s_{x}^{2} + s_{y}^{2} + s_{z}^{2}.\n$$\nDerive the scalar quadratic relation for $G$ that governs stability, and determine the value of the Courant number\n$$\n\\nu \\equiv c\\, \\Delta t \\sqrt{\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}} + \\frac{1}{\\Delta z^{2}}}, \n\\qquad c \\equiv \\frac{1}{\\sqrt{\\mu \\epsilon}},\n$$\nat which the boundary of stability is reached, i.e., where $|G|=1$ transitions to $|G|1$ for the worst-case spatial harmonic (the largest possible $S^{2}$ on the grid). Express your final answer for the critical Courant number as a single exact number (no units, no rounding).", "solution": "The problem requires a von Neumann stability analysis of the three-dimensional Finite-Difference Time-Domain (FDTD) method for Maxwell's equations in a lossy medium. We are asked to derive the quadratic relation for the amplification factor $G$ and then determine the critical Courant number $\\nu$.\n\nFirst, we formalize the action of the discrete curl operator, $\\nabla_{\\mathrm{d}} \\times$, on the assumed plane-wave solutions. For a vector field component, e.g., $F_z$, the Yee scheme approximates $\\frac{\\partial F_z}{\\partial y}$ at a point $(i, j, k)$ as $\\frac{F_z(i, j+1/2, k) - F_z(i, j-1/2, k)}{\\Delta y}$. When acting on a plane-wave form $\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) = \\exp(i(k_x x + k_y y + k_z z))$, this finite difference becomes:\n$$\n\\frac{\\exp(ik_y(y+\\Delta y/2)) - \\exp(ik_y(y-\\Delta y/2))}{\\Delta y} = \\frac{\\exp(ik_y y)(\\exp(ik_y\\Delta y/2) - \\exp(-ik_y\\Delta y/2))}{\\Delta y} = \\frac{2i\\sin(k_y\\Delta y/2)}{\\Delta y}\n$$\nThe problem defines $s_y = \\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}$. Therefore, the discrete partial derivative operator $\\delta_y$ corresponds to multiplication by $2is_y$. Generalizing this to three dimensions, the discrete curl operator acting on a plane wave $\\mathbf{F} = \\tilde{\\mathbf{F}} \\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ is equivalent to multiplication by a matrix operator, which for the vector field corresponds to the operation $i(2\\mathbf{s}) \\times \\tilde{\\mathbf{F}}$, where $\\mathbf{s}=(s_x, s_y, s_z)$. This factor of $2$ is crucial and implicit in the standard central-difference scheme.\n\nWe substitute the plane-wave ansatz, $\\mathbf{E}^{n+1/2}(\\mathbf{r}) = \\tilde{\\mathbf{E}}\\, G^{n} \\exp(i \\mathbf{k}\\cdot \\mathbf{r})$ and $\\mathbf{H}^{n}(\\mathbf{r}) = \\tilde{\\mathbf{H}}\\, G^{n} \\exp(i \\mathbf{k}\\cdot \\mathbf{r})$, into the given update equations. From the problem statement's ansatz, the amplification factor $G$ represents the growth over a full time step $\\Delta t$.\n\nThe first update equation is for the electric field:\n$$\n\\mathbf{E}^{n+1/2} = C_{\\mathrm{ea}}\\, \\mathbf{E}^{n-1/2} + C_{\\mathrm{eb}}\\, \\left(\\nabla_{\\mathrm{d}} \\times \\mathbf{H}^{n}\\right)\n$$\nSubstituting the ansatz forms:\n$$\n\\tilde{\\mathbf{E}}G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) = C_{\\mathrm{ea}}\\tilde{\\mathbf{E}}G^{n-1}\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) + C_{\\mathrm{eb}} \\left( i(2\\mathbf{s}) \\times (\\tilde{\\mathbf{H}}G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})) \\right)\n$$\nDividing by $G^{n-1}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ yields:\n$$\n\\tilde{\\mathbf{E}}G = C_{\\mathrm{ea}}\\tilde{\\mathbf{E}} + i2C_{\\mathrm{eb}}G(\\mathbf{s} \\times \\tilde{\\mathbf{H}})\n$$\nRearranging gives our first vector equation:\n$$\n(G - C_{\\mathrm{ea}})\\tilde{\\mathbf{E}} = i2C_{\\mathrm{eb}}G(\\mathbf{s} \\times \\tilde{\\mathbf{H}}) \\quad (1)\n$$\nThe second update equation is for the magnetic field:\n$$\n\\mathbf{H}^{n+1} = \\mathbf{H}^{n} - C_{\\mathrm{hb}}\\, \\left(\\nabla_{\\mathrm{d}} \\times \\mathbf{E}^{n+1/2}\\right)\n$$\nSubstituting the ansatz:\n$$\n\\tilde{\\mathbf{H}}G^{n+1}\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) = \\tilde{\\mathbf{H}}G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) - C_{\\mathrm{hb}} \\left( i(2\\mathbf{s}) \\times (\\tilde{\\mathbf{E}}G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})) \\right)\n$$\nDividing by $G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ gives:\n$$\n\\tilde{\\mathbf{H}}G = \\tilde{\\mathbf{H}} - i2C_{\\mathrm{hb}}(\\mathbf{s} \\times \\tilde{\\mathbf{E}})\n$$\nRearranging gives our second vector equation:\n$$\n(G-1)\\tilde{\\mathbf{H}} = -i2C_{\\mathrm{hb}}(\\mathbf{s} \\times \\tilde{\\mathbf{E}}) \\quad (2)\n$$\nWe now have a system of two coupled equations for the constant vectors $\\tilde{\\mathbf{E}}$ and $\\tilde{\\mathbf{H}}$. To find the dispersion relation, we eliminate one of the vectors. From equation (2), we express $\\tilde{\\mathbf{H}}$ in terms of $\\tilde{\\mathbf{E}}$:\n$$\n\\tilde{\\mathbf{H}} = -\\frac{i2C_{\\mathrm{hb}}}{G-1}(\\mathbf{s} \\times \\tilde{\\mathbf{E}})\n$$\nSubstitute this into equation (1):\n$$\n(G - C_{\\mathrm{ea}})\\tilde{\\mathbf{E}} = i2C_{\\mathrm{eb}}G \\left( \\mathbf{s} \\times \\left( -\\frac{i2C_{\\mathrm{hb}}}{G-1}(\\mathbf{s} \\times \\tilde{\\mathbf{E}}) \\right) \\right)\n$$\nSimplifying the expression:\n$$\n(G - C_{\\mathrm{ea}})\\tilde{\\mathbf{E}} = \\frac{4C_{\\mathrm{eb}}C_{\\mathrm{hb}}G}{G-1} \\left( \\mathbf{s} \\times (\\mathbf{s} \\times \\tilde{\\mathbf{E}}) \\right)\n$$\nWe use the vector triple product identity $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c}) - \\mathbf{c}(\\mathbfa\\cdot\\mathbf{b})$. Here, $\\mathbf{a}=\\mathbf{b}=\\mathbf{s}$ and $\\mathbf{c}=\\tilde{\\mathbf{E}}$.\n$$\n\\mathbf{s} \\times (\\mathbf{s} \\times \\tilde{\\mathbf{E}}) = \\mathbf{s}(\\mathbf{s} \\cdot \\tilde{\\mathbf{E}}) - \\tilde{\\mathbf{E}}(\\mathbf{s} \\cdot \\mathbf{s})\n$$\nFor transverse electromagnetic waves, the wave vector is orthogonal to the electric field vector. The discrete analog is $\\mathbf{s} \\cdot \\tilde{\\mathbf{E}} = 0$. Also, $\\mathbf{s} \\cdot \\mathbf{s} = S^2$. The identity simplifies to:\n$$\n\\mathbf{s} \\times (\\mathbf{s} \\times \\tilde{\\mathbf{E}}) = -S^2 \\tilde{\\mathbf{E}}\n$$\nSubstituting this back into our equation:\n$$\n(G - C_{\\mathrm{ea}})\\tilde{\\mathbf{E}} = \\frac{4C_{\\mathrm{eb}}C_{\\mathrm{hb}}G}{G-1}(-S^2\\tilde{\\mathbf{E}})\n$$\nSince $\\tilde{\\mathbf{E}}$ is a non-zero amplitude vector, we can divide it out to obtain a scalar equation for $G$:\n$$\n(G - C_{\\mathrm{ea}})(G-1) = -4C_{\\mathrm{eb}}C_{\\mathrm{hb}}S^2 G\n$$\nExpanding the left side and rearranging gives the desired quadratic relation for $G$:\n$$\nG^2 - (1+C_{\\mathrm{ea}})G + C_{\\mathrm{ea}} = -4C_{\\mathrm{eb}}C_{\\mathrm{hb}}S^2 G\n$$\n$$\nG^2 + \\left(4C_{\\mathrm{eb}}C_{\\mathrm{hb}}S^2 - (1+C_{\\mathrm{ea}})\\right)G + C_{\\mathrm{ea}} = 0\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must satisfy $|G| \\le 1$ for all possible spatial harmonics (i.e., for all $\\mathbf{k}$). The presence of physical loss ($\\sigma>0$) enhances stability, meaning $|G|$ will be smaller than in the lossless case. Therefore, the boundary of stability is determined by the most restrictive case, which is the lossless medium where $\\sigma=0$.\nIn the lossless case, $\\sigma=0 \\implies \\gamma = \\frac{\\sigma \\Delta t}{2 \\epsilon} = 0$. The coefficients become:\n$C_{\\mathrm{ea}} = \\frac{1-0}{1+0} = 1$\n$C_{\\mathrm{eb}} = \\frac{\\Delta t}{\\epsilon(1+0)} = \\frac{\\Delta t}{\\epsilon}$\n$C_{\\mathrm{hb}} = \\frac{\\Delta t}{\\mu}$\nThe term $C_{\\mathrm{eb}}C_{\\mathrm{hb}} = \\frac{(\\Delta t)^2}{\\mu\\epsilon}$. Using the definition of the speed of light $c=1/\\sqrt{\\mu\\epsilon}$, this becomes $(c\\Delta t)^2$.\nThe quadratic equation for $G$ in the lossless case simplifies to:\n$$\nG^2 + \\left(4(c\\Delta t S)^2 - 2\\right)G + 1 = 0\n$$\nThis is a quadratic equation of the form $G^2 + pG + 1 = 0$. The roots of this equation are $G = \\frac{-p \\pm \\sqrt{p^2-4}}{2}$. For the solutions to be stable ($|G| \\le 1$), the roots must not have a magnitude greater than $1$. If the roots are complex conjugates, their magnitudes are $|G|^2 = 1$, which is on the stability boundary. This occurs when the discriminant is non-positive, i.e., $p^2 - 4 \\le 0$, which implies $p^2 \\le 4$, or $-2 \\le p \\le 2$.\nLet's check this condition on our coefficient $p = 4(c\\Delta t S)^2 - 2$:\n$$\n-2 \\le 4(c\\Delta t S)^2 - 2 \\le 2\n$$\nAdding $2$ to all parts of the inequality gives:\n$$\n0 \\le 4(c\\Delta t S)^2 \\le 4\n$$\nThe left inequality $0 \\le 4(c\\Delta t S)^2$ is always true for real quantities. The right inequality gives the stability condition:\n$$\n4(c\\Delta t S)^2 \\le 4 \\implies (c\\Delta t S)^2 \\le 1 \\implies c\\Delta t S \\le 1\n$$\nThis condition must hold for all spatial wavevectors $\\mathbf{k}$. The most stringent constraint is imposed by the maximum possible value of $S$ on the grid, denoted $S_{\\mathrm{max}}$. The value of $S^2$ is:\n$$\nS^2 = \\left(\\frac{\\sin(k_{x} \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_{y} \\Delta y/2)}{\\Delta y}\\right)^2 + \\left(\\frac{\\sin(k_{z} \\Delta z/2)}{\\Delta z}\\right)^2\n$$\nThe maximum value of the sine function is $1$, which occurs at the Nyquist frequency (e.g., $k_x = \\pi/\\Delta x$, so $k_x\\Delta x/2 = \\pi/2$). Thus, the maximum value of $S^2$ is:\n$$\nS_{\\mathrm{max}}^2 = \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\n$$\nSubstituting this into the stability condition gives the Courant-Friedrichs-Lewy (CFL) stability limit:\n$$\nc \\Delta t \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}} \\le 1\n$$\nThe problem defines the Courant number as $\\nu \\equiv c\\, \\Delta t \\sqrt{\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}} + \\frac{1}{\\Delta z^{2}}}$.\nTherefore, the stability condition is simply $\\nu \\le 1$. The boundary of stability, where $|G|=1$ transitions toward instability for the worst-case mode, is reached when this inequality becomes an equality.\n$$\n\\nu = 1\n$$", "answer": "$$\n\\boxed{1}\n$$", "id": "3360095"}, {"introduction": "Ensuring stability is necessary, but it is not sufficient for an accurate simulation; we must also consider numerical dispersion. This exercise tackles the advanced problem of design optimization, where the goal is to select a Courant number $S$ that not only guarantees stability but also minimizes the numerical phase velocity error across all wave propagation directions [@problem_id:3360115]. This practice demonstrates the critical interplay between stability and accuracy, a central theme in designing high-fidelity FDTD simulations.", "problem": "Consider the standard Yee staggered Finite-Difference Time-Domain (FDTD) scheme for the transverse electric polarization with nonzero $E_{z}$, $H_{x}$, and $H_{y}$ fields in vacuum in two spatial dimensions on a uniform square grid of spacing $h$ and time step $\\Delta t$. Let the material parameters be permittivity $\\varepsilon$, permeability $\\mu$, and wave speed $c = 1/\\sqrt{\\mu \\varepsilon}$. Define the Courant number $S = c\\,\\Delta t / h$. Adopt the von Neumann plane-wave ansatz for the fields with wavevector $\\mathbf{k} = (k_{x}, k_{y})$ and angular frequency $\\omega$, and define the amplification factor $G(\\mathbf{k}; S)$ by the time advance of the field phasor.\n\nUsing a von Neumann stability and dispersion analysis starting from Maxwell’s equations in vacuum and their second-order central-difference Yee discretization, do the following:\n\n- Derive the discrete dispersion relation that connects $\\omega$, $k_{x}$, and $k_{y}$ for the Yee scheme, and use it to express $|G(\\mathbf{k}; S)|$.\n- Impose the stability constraint $|G(\\mathbf{k}; S)| \\le 1$ for all $\\mathbf{k}$ in the first Brillouin zone.\n- With $\\alpha = k_{x} h/2$ and $\\beta = k_{y} h/2$, define the numerical phase velocity $v_{p,\\mathrm{num}}(\\alpha,\\beta; S) = \\omega/\\|\\mathbf{k}\\|$ and the corresponding relative phase error\n$$\n\\mathcal{E}(\\alpha,\\beta; S) \\equiv \\frac{v_{p,\\mathrm{num}}(\\alpha,\\beta; S)}{c} - 1,\n$$\nfor $(\\alpha,\\beta)$ ranging over the Brillouin zone $\\alpha, \\beta \\in [0, \\pi/2]$, excluding the origin where $\\|\\mathbf{k}\\| = 0$.\n- Design the Courant number $S^{\\star}$ that minimizes the peak numerical phase error magnitude\n$$\n\\Phi(S) \\equiv \\sup_{(\\alpha,\\beta)\\in (0,\\pi/2]^{2}} \\left| \\mathcal{E}(\\alpha,\\beta; S) \\right|\n$$\nsubject to the stability constraint you obtained.\n\nProvide your final answer as a single closed-form expression for $S^{\\star}$ (dimensionless). Do not include units. No numerical rounding is required.", "solution": "The user wants to find the optimal Courant number $S^{\\star}$ for the 2D Transverse Electric (TE) Finite-Difference Time-Domain (FDTD) method that minimizes the peak numerical phase error.\n\nThe problem will be solved in the following steps:\n1.  Discretize Maxwell's equations for the 2D TE case using the Yee scheme.\n2.  Apply the von Neumann plane-wave ansatz to derive the numerical dispersion relation.\n3.  From the dispersion relation, determine the stability condition for the Courant number $S$.\n4.  Express the numerical phase velocity $v_{p,\\text{num}}$ and the relative phase error $\\mathcal{E}$.\n5.  Formulate the optimization problem for minimizing the peak phase error magnitude $\\Phi(S)$.\n6.  Solve the optimization problem to find the optimal Courant number $S^{\\star}$.\n\n**Step 1: FDTD Discretization of Maxwell's Equations**\n\nFor a 2D TE polarization with field components $E_z(x,y,t)$, $H_x(x,y,t)$, and $H_y(x,y,t)$ in a vacuum with permittivity $\\varepsilon$ and permeability $\\mu$, Maxwell's curl equations are:\n$$ \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon} \\left( \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y} \\right) $$\n$$ \\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu} \\frac{\\partial E_z}{\\partial y} $$\n$$ \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu} \\frac{\\partial E_z}{\\partial x} $$\n\nUsing the Yee staggered grid with uniform spacing $h$ in both $x$ and $y$ directions and a time step $\\Delta t$, the fields are located at discrete points $(i, j, n)$ corresponding to $(ih, jh, n\\Delta t)$. The second-order central difference discretization is:\n$$ \\frac{E_z^{n+1}_{i,j} - E_z^n_{i,j}}{\\Delta t} = \\frac{1}{\\varepsilon} \\left( \\frac{H_y^{n+1/2}_{i+1/2,j} - H_y^{n+1/2}_{i-1/2,j}}{h} - \\frac{H_x^{n+1/2}_{i,j+1/2} - H_x^{n+1/2}_{i,j-1/2}}{h} \\right) $$\n$$ \\frac{H_x^{n+1/2}_{i,j+1/2} - H_x^{n-1/2}_{i,j+1/2}}{\\Delta t} = -\\frac{1}{\\mu} \\frac{E_z^n_{i,j+1} - E_z^n_{i,j}}{h} $$\n$$ \\frac{H_y^{n+1/2}_{i+1/2,j} - H_y^{n-1/2}_{i+1/2,j}}{\\Delta t} = \\frac{1}{\\mu} \\frac{E_z^n_{i+1,j} - E_z^n_{i,j}}{h} $$\n\n**Step 2: Numerical Dispersion Relation and Amplification Factor**\n\nWe apply the von Neumann ansatz, assuming a plane-wave solution of the form:\n$$ F^{n}_{i,j} = \\tilde{F} \\exp(j(\\omega n \\Delta t - k_x i h - k_y j h)) $$\nwhere $F$ represents any field component $E_z$, $H_x$, or $H_y$, and $\\tilde{F}$ is its complex amplitude. Substituting this ansatz into the FDTD equations and canceling common terms leads to a system of equations for the amplitudes $(\\tilde{E}_z, \\tilde{H}_x, \\tilde{H}_y)$.\n\nFor the $H_x$ equation:\n$$ \\tilde{H}_x \\frac{\\exp(j\\omega\\Delta t/2) - \\exp(-j\\omega\\Delta t/2)}{\\Delta t} = -\\frac{\\tilde{E}_z}{\\mu h} (\\exp(-jk_y h/2) - \\exp(jk_y h/2)) $$\n$$ 2j \\tilde{H}_x \\frac{\\sin(\\omega\\Delta t/2)}{\\Delta t} = -\\frac{\\tilde{E}_z}{\\mu h} (-2j\\sin(k_y h/2)) $$\n$$ (1) \\quad \\tilde{H}_x \\sin(\\omega\\Delta t/2) = \\frac{\\Delta t}{\\mu h} \\tilde{E}_z \\sin(k_y h/2) $$\n\nFor the $H_y$ equation, by symmetry:\n$$ (2) \\quad \\tilde{H}_y \\sin(\\omega\\Delta t/2) = -\\frac{\\Delta t}{\\mu h} \\tilde{E}_z \\sin(k_x h/2) $$\n\nFor the $E_z$ equation:\n$$ \\tilde{E}_z \\frac{\\exp(j\\omega\\Delta t) - 1}{\\Delta t} = \\frac{1}{\\varepsilon h} \\exp(j\\omega\\Delta t/2) \\left[ \\tilde{H}_y(\\exp(-jk_x h/2) - \\exp(jk_x h/2)) - \\tilde{H}_x(\\exp(-jk_y h/2) - \\exp(jk_y h/2)) \\right] $$\nDividing by $\\exp(j\\omega\\Delta t/2)$:\n$$ \\tilde{E}_z \\frac{\\exp(j\\omega\\Delta t/2) - \\exp(-j\\omega\\Delta t/2)}{\\Delta t} = \\frac{1}{\\varepsilon h} \\left[ -2j\\tilde{H}_y\\sin(k_x h/2) + 2j\\tilde{H}_x\\sin(k_y h/2) \\right] $$\n$$ (3) \\quad \\tilde{E}_z \\sin(\\omega\\Delta t/2) = \\frac{\\Delta t}{\\varepsilon h} (\\tilde{H}_x \\sin(k_y h/2) - \\tilde{H}_y \\sin(k_x h/2)) $$\n\nSubstituting (1) and (2) into (3) yields the numerical dispersion relation:\n$$ \\sin^2(\\omega \\Delta t / 2) = \\frac{(\\Delta t)^2}{\\mu\\varepsilon h^2} \\left( \\sin^2(k_x h/2) + \\sin^2(k_y h/2) \\right) $$\nUsing the definitions $c=1/\\sqrt{\\mu\\varepsilon}$ and Courant number $S=c\\Delta t/h$, this becomes:\n$$ \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) = S^2 \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] $$\nThe amplification factor $G$ is defined by the time-advance factor $G=\\exp(j\\omega\\Delta t)$. For the scheme to be stable, $\\omega$ must be real, which makes $|G|=1$. This requires the right-hand side of the dispersion relation to be less than or equal to $1$. If it is greater than $1$, $\\omega$ becomes complex, leading to an amplification factor with magnitude $|G|1$ and thus instability. Thus, for stable operation, $|G(\\mathbf{k}; S)|=1$.\n\n**Step 3: Stability Condition**\n\nFor stability, we require $|G| \\le 1$, which implies $\\omega$ must be real. This requires that the argument of the $\\arcsin$ function derived from the dispersion relation is real and has a magnitude no greater than $1$:\n$$ S^2 \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] \\le 1 $$\nThis inequality must hold for all possible wavevectors $\\mathbf{k}=(k_x, k_y)$. The term in the brackets is maximized when $k_x h/2 = \\pi/2$ and $k_y h/2 = \\pi/2$, which correspond to the highest frequency waves resolvable on the grid (the Nyquist limit). At this point, $\\sin^2(k_x h/2) = 1$ and $\\sin^2(k_y h/2) = 1$. The maximum value of the bracketed term is $1^2+1^2=2$.\nTherefore, the stability condition is:\n$$ S^2 \\cdot 2 \\le 1 \\implies S \\le \\frac{1}{\\sqrt{2}} $$\n\n**Step 4: Numerical Phase Velocity and Error**\n\nThe numerical angular frequency $\\omega$ is obtained from the dispersion relation:\n$$ \\omega = \\frac{2}{\\Delta t} \\arcsin\\left( S \\sqrt{\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)} \\right) $$\nThe magnitude of the wavevector is $\\|\\mathbf{k}\\| = \\sqrt{k_x^2 + k_y^2}$. The numerical phase velocity is $v_{p,\\text{num}} = \\omega / \\|\\mathbf{k}\\|$.\nUsing the normalized wave numbers $\\alpha = k_x h/2$ and $\\beta = k_y h/2$, we have $\\|\\mathbf{k}\\| = \\frac{2}{h}\\sqrt{\\alpha^2+\\beta^2}$.\nThe velocity ratio is:\n$$ \\frac{v_{p,\\text{num}}}{c} = \\frac{\\omega}{c \\|\\mathbf{k}\\|} = \\frac{1}{c \\frac{2}{h}\\sqrt{\\alpha^2+\\beta^2}} \\frac{2}{\\Delta t} \\arcsin\\left(S \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}\\right) $$\n$$ \\frac{v_{p,\\text{num}}}{c} = \\frac{h}{c\\Delta t} \\frac{\\arcsin\\left(S \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}\\right)}{\\sqrt{\\alpha^2 + \\beta^2}} = \\frac{1}{S} \\frac{\\arcsin\\left(S \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}\\right)}{\\sqrt{\\alpha^2 + \\beta^2}} $$\nLet $F(\\alpha, \\beta; S) = v_{p,\\text{num}}/c$. The relative phase error is $\\mathcal{E}(\\alpha, \\beta; S) = F(\\alpha, \\beta; S) - 1$.\nA known property of the 2D Yee scheme is that the numerical phase velocity is always less than or equal to the speed of light $c$ in the stable regime. Thus, $F(\\alpha, \\beta; S) \\le 1$, and the error $\\mathcal{E}$ is always non-positive. This can be proven by showing that $\\arcsin(SA) \\le SB$, where $A=\\sqrt{\\sin^2\\alpha+\\sin^2\\beta}$ and $B=\\sqrt{\\alpha^2+\\beta^2}$. Since $\\mathcal{E} \\le 0$, the error magnitude is $|\\mathcal{E}| = -\\mathcal{E} = 1 - F(\\alpha, \\beta; S)$.\n\n**Step 5  6: Optimization Problem and Solution**\n\nWe want to find $S^{\\star}$ that minimizes the peak error magnitude $\\Phi(S)$:\n$$ S^{\\star} = \\arg \\min_{0  S \\le 1/\\sqrt{2}} \\Phi(S) = \\arg \\min_{0  S \\le 1/\\sqrt{2}} \\left( \\sup_{(\\alpha,\\beta)\\in (0,\\pi/2]^{2}} |\\mathcal{E}(\\alpha,\\beta; S)| \\right) $$\nSince $|\\mathcal{E}| = 1 - F(\\alpha, \\beta; S)$, this is equivalent to:\n$$ S^{\\star} = \\arg \\min_{S} \\left( \\sup_{\\alpha, \\beta} (1 - F(\\alpha, \\beta; S)) \\right) = \\arg \\min_{S} \\left( 1 - \\inf_{\\alpha, \\beta} F(\\alpha, \\beta; S) \\right) $$\nMinimizing this expression is equivalent to maximizing the minimum value of the velocity ratio $F$:\n$$ S^{\\star} = \\arg \\max_{0  S \\le 1/\\sqrt{2}} \\left( \\inf_{(\\alpha, \\beta) \\in (0, \\pi/2]^2} F(\\alpha, \\beta; S) \\right) $$\nLet's analyze the dependence of $F(\\alpha, \\beta; S)$ on $S$. We compute the partial derivative of $F$ with respect to $S$:\n$$ \\frac{\\partial F}{\\partial S} = \\frac{\\partial}{\\partial S} \\left( \\frac{\\arcsin\\left(S \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}\\right)}{S \\sqrt{\\alpha^2 + \\beta^2}} \\right) $$\nLet $A = \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}$ and $B = \\sqrt{\\alpha^2 + \\beta^2}$.\n$$ \\frac{\\partial F}{\\partial S} = \\frac{1}{B} \\frac{\\partial}{\\partial S} \\left( \\frac{\\arcsin(SA)}{S} \\right) = \\frac{1}{B} \\left[ \\frac{\\frac{A}{\\sqrt{1-S^2A^2}} S - \\arcsin(SA)}{S^2} \\right] $$\n$$ \\frac{\\partial F}{\\partial S} = \\frac{1}{B S^2} \\left[ \\frac{SA}{\\sqrt{1-S^2A^2}} - \\arcsin(SA) \\right] $$\nConsider the function $g(u) = u/\\sqrt{1-u^2} - \\arcsin(u)$. Its derivative is $g'(u) = (1-u^2)^{-3/2} - (1-u^2)^{-1/2} = u^2(1-u^2)^{-3/2}$. Since $g'(u)  0$ for $u \\in (0,1)$ and $g(0)=0$, we have $g(u)  0$ for $u0$.\nThe term in the brackets is $g(SA)$, which is positive for $S0$ and $A0$. Since $B0$, it follows that:\n$$ \\frac{\\partial F(\\alpha, \\beta; S)}{\\partial S}  0 $$\nfor any fixed $(\\alpha, \\beta) \\in (0, \\pi/2]^2$ and $S$ in the stable range.\n\nThis means that for any given direction and wavelength, the numerical phase velocity increases as $S$ increases. Consequently, the minimum value of the phase velocity over all directions and wavelengths, $m(S) = \\inf_{\\alpha, \\beta} F(\\alpha, \\beta; S)$, must be a non-decreasing function of $S$.\nTo maximize $m(S)$, we must choose the largest permissible value of $S$. The stability condition dictates that the maximum value is $S=1/\\sqrt{2}$.\n\nTherefore, the Courant number $S^{\\star}$ that minimizes the peak numerical phase error is the one at the stability limit.\n$$ S^{\\star} = \\frac{1}{\\sqrt{2}} $$", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$", "id": "3360115"}]}