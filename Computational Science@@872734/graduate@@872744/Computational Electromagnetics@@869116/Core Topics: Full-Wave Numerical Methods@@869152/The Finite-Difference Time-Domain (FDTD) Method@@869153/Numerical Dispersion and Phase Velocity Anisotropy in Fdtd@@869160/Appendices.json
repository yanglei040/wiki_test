{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will first derive the fundamental numerical dispersion relation for the 3D Yee FDTD scheme from first principles. This exercise demonstrates how the finite-difference approximation introduces a direction-dependent numerical phase velocity, a phenomenon known as anisotropy. By calculating the numerical slowness for waves traveling along the grid's principal, planar-diagonal, and space-diagonal axes, you will directly quantify this effect and build an intuition for its behavior [@problem_id:3335203].", "problem": "A lossless, homogeneous, isotropic medium with speed of light $c$ is discretized by the three-dimensional Finite-Difference Time-Domain (FDTD) method of the Yee scheme using equal spatial steps $\\Delta x=\\Delta y=\\Delta z=\\Delta$ and a uniform time step $\\Delta t$. Consider source-free propagation governed by Maxwell’s curl equations, discretized on the staggered grid, and analyze plane-wave solutions of the form $E,H \\propto \\exp\\!\\big(i(k_x x + k_y y + k_z z - \\omega t)\\big)$ restricted to the discrete spacetime lattice. Let the non-dimensional frequency be fixed at $\\Omega \\equiv \\omega \\Delta t = \\frac{3\\pi}{5}$ (radians), and define the Courant number $S \\equiv \\frac{c\\,\\Delta t}{\\Delta}$. Let the direction of propagation be specified by the unit vector $\\hat{\\boldsymbol{n}}=(n_x,n_y,n_z)$ with $n_x^2+n_y^2+n_z^2=1$. Define the dimensionless slowness (normalized to $1/c$) by $\\sigma(\\hat{\\boldsymbol{n}})\\equiv \\frac{c}{v_p(\\hat{\\boldsymbol{n}})}=\\frac{c\\,k_{\\text{num}}(\\hat{\\boldsymbol{n}})}{\\omega}$, where $k_{\\text{num}}(\\hat{\\boldsymbol{n}})$ is the numerical wavenumber magnitude consistent with the discrete dispersion relation along direction $\\hat{\\boldsymbol{n}}$.\n\nStarting only from the source-free Maxwell curl equations and the Yee-scheme discrete updates on a uniform grid, derive the fully discrete plane-wave dispersion relation. Use it to obtain a closed-form expression for $\\sigma(\\hat{\\boldsymbol{n}})$ in terms of $\\Omega$ and $S$ for propagation constrained to each of the following symmetry directions:\n- $\\langle 100\\rangle$: $\\hat{\\boldsymbol{n}}=(1,0,0)$,\n- $\\langle 110\\rangle$: $\\hat{\\boldsymbol{n}}=\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}},0\\right)$,\n- $\\langle 111\\rangle$: $\\hat{\\boldsymbol{n}}=\\left(\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}}\\right)$.\n\nYour result must be expressed as a single row matrix $\\big[\\sigma_{\\langle 100\\rangle}\\;\\;\\sigma_{\\langle 110\\rangle}\\;\\;\\sigma_{\\langle 111\\rangle}\\big]$ in closed form, using only $\\Omega=\\frac{3\\pi}{5}$, $S$, and standard constants and functions. Do not introduce any numerical rounding. State all angles in radians and express the slowness as dimensionless quantities (no units).", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The givens are a lossless, homogeneous, isotropic medium with speed of light $c$, discretized by the three-dimensional Finite-Difference Time-Domain (FDTD) method using a uniform Yee grid with spatial step $\\Delta$ and time step $\\Delta t$. We are to analyze source-free plane-wave propagation. Key definitions include the non-dimensional frequency $\\Omega \\equiv \\omega \\Delta t = \\frac{3\\pi}{5}$, the Courant number $S \\equiv \\frac{c\\,\\Delta t}{\\Delta}$, the propagation direction unit vector $\\hat{\\boldsymbol{n}}$, and the dimensionless slowness $\\sigma(\\hat{\\boldsymbol{n}})\\equiv \\frac{c}{v_p(\\hat{\\boldsymbol{n}})}=\\frac{c\\,k_{\\text{num}}(\\hat{\\boldsymbol{n}})}{\\omega}$. The problem asks for the derivation of the fully discrete dispersion relation and its use to find $\\sigma$ for the $\\langle 100\\rangle$, $\\langle 110\\rangle$, and $\\langle 111\\rangle$ directions.\n\nThe problem is valid. It is a standard and fundamental exercise in computational electromagnetics, grounded in Maxwell's equations and the principles of finite difference methods. All terms are precisely defined, and the required information is self-contained. The problem is objective and formalizable. We may proceed with the solution.\n\nThe derivation begins with the source-free Maxwell's curl equations in a lossless, homogeneous, isotropic medium characterized by permittivity $\\epsilon$ and permeability $\\mu$:\n$$ \\nabla \\times \\boldsymbol{E} = -\\mu \\frac{\\partial \\boldsymbol{H}}{\\partial t} $$\n$$ \\nabla \\times \\boldsymbol{H} = \\epsilon \\frac{\\partial \\boldsymbol{E}}{\\partial t} $$\nThe speed of light in this medium is $c = \\frac{1}{\\sqrt{\\epsilon\\mu}}$.\n\nThe Yee FDTD scheme discretizes these equations using central-difference approximations for both spatial and temporal derivatives on a staggered grid. For a plane-wave solution of the form $\\boldsymbol{F}(\\boldsymbol{r}, t) = \\boldsymbol{F}_0 \\exp(i(\\boldsymbol{k}_{\\text{num}}\\cdot\\boldsymbol{r} - \\omega t))$, where $\\boldsymbol{F}$ is any field component ($\\boldsymbol{E}$ or $\\boldsymbol{H}$) and $\\boldsymbol{k}_{\\text{num}} = (k_x, k_y, k_z)$ is the numerical wavevector, the action of the discrete operators can be found.\n\nThe central difference in time, staggered by $\\Delta t/2$, on a field component $F$ becomes:\n$$ \\frac{F^{n+1/2} - F^{n-1/2}}{\\Delta t} \\rightarrow \\frac{\\exp(-i\\omega(t_n+\\Delta t/2)) - \\exp(-i\\omega(t_n-\\Delta t/2))}{\\Delta t} F_0 \\exp(i\\boldsymbol{k}_{\\text{num}}\\cdot\\boldsymbol{r}) = \\frac{-2i}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) F $$\nThus, the operator $\\frac{\\partial}{\\partial t}$ is replaced by a multiplicative factor in the Fourier domain:\n$$ \\frac{\\partial}{\\partial t} \\rightarrow \\frac{-2i}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nSimilarly, the central difference in a spatial dimension, e.g., $x$, staggered by $\\Delta/2$:\n$$ \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta} \\rightarrow \\frac{\\exp(ik_x(x_i+\\Delta/2)) - \\exp(ik_x(x_i-\\Delta/2))}{\\Delta} F_0 \\exp(i(k_y y+k_z z - \\omega t)) = \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x\\Delta}{2}\\right) F $$\nThus, the spatial derivative operators are replaced as:\n$$ \\frac{\\partial}{\\partial x_j} \\rightarrow \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\nSubstituting these into Maxwell's equations yields the discretized equations in the Fourier domain:\n$$ i\\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{E} = - \\mu \\left( \\frac{-i\\omega_{\\text{num}}}{\\mu} \\boldsymbol{H} \\right) \\implies \\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{E} = \\omega_{\\text{num}} \\boldsymbol{H} $$\n$$ i\\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{H} = \\epsilon \\left( \\frac{-i\\omega_{\\text{num}}}{\\epsilon} \\boldsymbol{E} \\right) \\implies \\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{H} = -\\omega_{\\text{num}} \\boldsymbol{E} $$\nwhere we have defined effective wavenumber vector components $K_j$ and effective frequency $\\omega_{\\text{eff}}$ for clarity, but it's simpler to directly substitute the full expressions. Let's define the discrete operators acting on the wave as:\n$$ \\omega_d \\equiv \\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n$$ K_j \\equiv \\frac{2}{\\Delta}\\sin\\left(\\frac{k_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\nThe system of equations becomes:\n$$ \\boldsymbol{K} \\times \\boldsymbol{E} = \\mu \\omega_d \\boldsymbol{H} $$\n$$ \\boldsymbol{K} \\times \\boldsymbol{H} = -\\epsilon \\omega_d \\boldsymbol{E} $$\nwhere $\\boldsymbol{K} = (K_x, K_y, K_z)$. Taking the curl of the first equation and substituting the second:\n$$ \\boldsymbol{K} \\times (\\boldsymbol{K} \\times \\boldsymbol{E}) = \\mu \\omega_d (\\boldsymbol{K} \\times \\boldsymbol{H}) = \\mu \\omega_d (-\\epsilon \\omega_d \\boldsymbol{E}) = -\\mu\\epsilon \\omega_d^2 \\boldsymbol{E} $$\nUsing the vector identity $\\boldsymbol{A} \\times (\\boldsymbol{B} \\times \\boldsymbol{C}) = \\boldsymbol{B}(\\boldsymbol{A} \\cdot \\boldsymbol{C}) - \\boldsymbol{C}(\\boldsymbol{A} \\cdot \\boldsymbol{B})$ and assuming a transverse wave for which $\\boldsymbol{K} \\cdot \\boldsymbol{E} = 0$:\n$$ -\\boldsymbol{E}(\\boldsymbol{K} \\cdot \\boldsymbol{K}) = -\\mu\\epsilon \\omega_d^2 \\boldsymbol{E} $$\nThis gives the algebraic relation $|\\boldsymbol{K}|^2 = \\mu\\epsilon \\omega_d^2$. Substituting the definitions of $\\omega_d$ and $K_j$, and $\\mu\\epsilon = 1/c^2$:\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left[ \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right] = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nSimplifying by dividing by $4$ and rearranging terms, we get the FDTD numerical dispersion relation:\n$$ \\frac{1}{(c\\Delta t)^2} \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{1}{\\Delta^2} \\left[ \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right] $$\nUsing the dimensionless Courant number $S = \\frac{c\\Delta t}{\\Delta}$ and non-dimensional frequency $\\Omega = \\omega \\Delta t$:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) $$\nNow, we introduce the dimensionless slowness $\\sigma = \\frac{ck_{\\text{num}}}{\\omega}$. The components of the numerical wavevector are $k_j = k_{\\text{num}}n_j$, where $\\hat{\\boldsymbol{n}}=(n_x,n_y,n_z)$ is the direction of propagation. The argument of the sine functions on the right-hand side can be re-expressed in terms of $\\sigma$, $S$, and $\\Omega$:\n$$ \\frac{k_j\\Delta}{2} = \\frac{(k_{\\text{num}}n_j)\\Delta}{2} = \\frac{(\\omega\\sigma/c)n_j\\Delta}{2} = \\frac{\\omega\\Delta t}{2} \\frac{\\sigma n_j}{c\\Delta t/\\Delta} = \\frac{(\\Omega/2)\\sigma n_j}{S} = \\frac{n_j\\Omega\\sigma}{2S} $$\nSubstituting this into the dispersion relation gives a general equation for $\\sigma(\\hat{\\boldsymbol{n}})$:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sum_{j \\in \\{x,y,z\\}} \\sin^2\\left(\\frac{n_j\\Omega\\sigma}{2S}\\right) $$\nWe are given $\\Omega = \\frac{3\\pi}{5}$, so $\\frac{\\Omega}{2} = \\frac{3\\pi}{10}$. We now solve for $\\sigma$ along the three specified symmetry directions.\n\nCase 1: Axial propagation, $\\langle 100\\rangle$ direction.\nHere, $\\hat{\\boldsymbol{n}} = (1, 0, 0)$. The equation for $\\sigma_{\\langle 100\\rangle}$ becomes:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 100\\rangle}}{2S}\\right) + 0 + 0 $$\nTaking the positive square root:\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sin\\left(\\frac{\\Omega\\sigma_{\\langle 100\\rangle}}{2S}\\right) $$\nSolving for $\\sigma_{\\langle 100\\rangle}$:\n$$ \\sigma_{\\langle 100\\rangle} = \\frac{2S}{\\Omega} \\arcsin\\left(\\frac{1}{S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{2S}{3\\pi/5} \\arcsin\\left(\\frac{1}{S}\\sin\\left(\\frac{3\\pi}{10}\\right)\\right) = \\frac{10S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{S}\\right) $$\n\nCase 2: Planar-diagonal propagation, $\\langle 110\\rangle$ direction.\nHere, $\\hat{\\boldsymbol{n}} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0\\right)$. The equation for $\\sigma_{\\langle 110\\rangle}$ becomes:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) + \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) + 0 = 2\\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) $$\nTaking the positive square root:\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sqrt{2}\\sin\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) $$\n$$ \\sigma_{\\langle 110\\rangle} = \\frac{2\\sqrt{2}S}{\\Omega} \\arcsin\\left(\\frac{1}{\\sqrt{2}S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{10\\sqrt{2}S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{\\sqrt{2}S}\\right) $$\n\nCase 3: Space-diagonal propagation, $\\langle 111\\rangle$ direction.\nHere, $\\hat{\\boldsymbol{n}} = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$. The equation for $\\sigma_{\\langle 111\\rangle}$ becomes:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = 3\\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 111\\rangle}}{2\\sqrt{3}S}\\right) $$\nTaking the positive square root:\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sqrt{3}\\sin\\left(\\frac{\\Omega\\sigma_{\\langle 111\\rangle}}{2\\sqrt{3}S}\\right) $$\n$$ \\sigma_{\\langle 111\\rangle} = \\frac{2\\sqrt{3}S}{\\Omega} \\arcsin\\left(\\frac{1}{\\sqrt{3}S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{10\\sqrt{3}S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{\\sqrt{3}S}\\right) $$\n\nThese three closed-form expressions constitute the final answer. They are assembled into a single row matrix as required.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{10S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{S}\\right) & \\frac{10\\sqrt{2}S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{\\sqrt{2}S}\\right) & \\frac{10\\sqrt{3}S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{\\sqrt{3}S}\\right) \\end{pmatrix} } $$", "id": "3335203"}, {"introduction": "Having established the existence of numerical anisotropy, a practical question arises: how fine must our grid be to keep this error within an acceptable tolerance? This practice introduces a powerful technique, the small-parameter asymptotic expansion, to approximate the dispersion relation and extract a leading-order expression for the anisotropy. By completing this exercise, you will derive a practical design rule that connects the required grid resolution, $\\Delta/\\lambda$, to a target error level, a crucial skill for any FDTD practitioner [@problem_id:3335173].", "problem": "A plane-wave numerical dispersion analysis is performed for the three-dimensional Finite-Difference Time-Domain (FDTD) method, where Finite-Difference Time-Domain (FDTD) denotes the standard Yee staggered-grid scheme in vacuum. Consider a uniform cubic spatial grid with spacing $\\Delta$ in all three directions and a time step $\\Delta t$. Define the Courant number as $S = c\\,\\Delta t/\\Delta$, where $c$ is the speed of light in vacuum. Let the continuous-wave frequency be $f$ with wavelength $\\lambda = c/f$ and wavenumber magnitude $k = 2\\pi/\\lambda$. For a plane wave with propagation direction $\\hat{\\mathbf{k}} = (\\mu_x,\\mu_y,\\mu_z)$ satisfying $\\mu_x^2+\\mu_y^2+\\mu_z^2=1$, denote by $v_p(\\hat{\\mathbf{k}})$ the numerical phase velocity supported by the discrete scheme at fixed $k$.\n\nStarting from Maxwell’s equations in vacuum and the Yee finite-difference discretization, derive the discrete dispersion relation and use a small-parameter asymptotic expansion in $k\\Delta$ (retain terms sufficient to resolve angular dependence) to obtain the leading-order angular dependence of $v_p(\\hat{\\mathbf{k}})$. Define the angular anisotropy at fixed $k$ as\n$$\n\\mathcal{A} \\equiv \\frac{\\max_{\\hat{\\mathbf{k}}} v_p(\\hat{\\mathbf{k}}) - \\min_{\\hat{\\mathbf{k}}} v_p(\\hat{\\mathbf{k}})}{c}.\n$$\nImpose a target tolerance $\\mathcal{A} \\le \\epsilon$ with $\\epsilon = 0.01$ at the given frequency $f$. By bounding the variation of $v_p(\\hat{\\mathbf{k}})$ over all directions, derive a constraint on $\\Delta/\\lambda$ and $S$ that guarantees $\\mathcal{A} \\le \\epsilon$ to leading order in $k\\Delta$. Using your result, determine the maximal allowable ratio $\\Delta/\\lambda$ such that the target is met for some admissible Courant number $S$ in three dimensions. Round your final numerical answer for the maximal $\\Delta/\\lambda$ to four significant figures. Express the final number as a dimensionless quantity with no units.", "solution": "The starting point for the analysis is Maxwell's curl equations in a source-free vacuum:\n$$ \\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\nwhere $\\mathbf{E}$ is the electric field, $\\mathbf{H}$ is the magnetic field, and $\\mu_0$ and $\\epsilon_0$ are the permeability and permittivity of vacuum, respectively, satisfying $\\mu_0\\epsilon_0 = 1/c^2$, with $c$ being the speed of light.\n\nFor the standard Yee FDTD scheme on a uniform cubic grid with spacing $\\Delta$, the central-difference approximations for the spatial and temporal derivatives are used. We assume a discrete plane-wave solution (ansatz) for the fields, sampled at the grid points $(i\\Delta, j\\Delta, k\\Delta)$ and time steps $n\\Delta t$:\n$$ \\mathbf{F}(i\\Delta, j\\Delta, k\\Delta, n\\Delta t) = \\mathbf{F}_0 \\exp\\left[i\\left(\\tilde{k}_x i\\Delta + \\tilde{k}_y j\\Delta + \\tilde{k}_z k\\Delta - \\tilde{\\omega} n\\Delta t\\right)\\right] $$\nwhere $\\mathbf{F}$ represents either $\\mathbf{E}$ or $\\mathbf{H}$, $\\tilde{\\mathbf{k}}=(\\tilde{k}_x, \\tilde{k}_y, \\tilde{k}_z)$ is the numerical wave vector, and $\\tilde{\\omega}$ is the numerical angular frequency.\n\nSubstituting this ansatz into the Yee-discretized Maxwell's equations transforms the differential operators into algebraic factors. A spatial difference, e.g., $\\frac{f(x+\\Delta/2) - f(x-\\Delta/2)}{\\Delta}$, acting on $\\exp(i\\tilde{k}_x x)$ becomes $\\frac{2i}{\\Delta}\\sin(\\frac{\\tilde{k}_x\\Delta}{2})\\exp(i\\tilde{k}_x x)$. Similarly, the temporal difference operator becomes $\\frac{-2i}{\\Delta t}\\sin(\\frac{\\tilde{\\omega}\\Delta t}{2})\\exp(-i\\tilde{\\omega}t)$.\n\nThis procedure leads to a system of algebraic equations that can be compactly written by replacing the continuous operators $(\\nabla, \\frac{\\partial}{\\partial t})$ with their effective numerical counterparts. The system is equivalent to the continuous-wave equations with the substitutions:\n$$ k_j \\rightarrow \\tilde{k}'_j = \\frac{2}{\\Delta} \\sin\\left(\\frac{\\tilde{k}_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\n$$ \\omega \\rightarrow \\tilde{\\omega}' = \\frac{2}{\\Delta t} \\sin\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\nThe continuous-wave dispersion relation in vacuum is $|\\mathbf{k}|^2 = (\\omega/c)^2$. Its numerical counterpart is therefore:\n$$ (\\tilde{k}'_x)^2 + (\\tilde{k}'_y)^2 + (\\tilde{k}'_z)^2 = \\left(\\frac{\\tilde{\\omega}'}{c}\\right)^2 $$\nSubstituting the expressions for $\\tilde{k}'_j$ and $\\tilde{\\omega}'$:\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_z\\Delta}{2}\\right) \\right] = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\nMultiplying by $\\frac{c^2(\\Delta t)^2}{4}$ and using the Courant number definition $S = c\\Delta t/\\Delta$:\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_z\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\nThis is the numerical dispersion relation for the 3D Yee FDTD scheme.\n\nWe are analyzing a continuous wave of a fixed frequency $f$, so we set the numerical frequency to the continuous frequency: $\\tilde{\\omega} = \\omega = 2\\pi f = ck$. The numerical wave vector is $\\tilde{\\mathbf{k}} = \\tilde{k}\\hat{\\mathbf{k}} = \\tilde{k}(\\mu_x, \\mu_y, \\mu_z)$. The dispersion relation becomes:\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}\\mu_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}\\mu_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}\\mu_z\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nTo find the phase velocity $v_p = \\tilde{\\omega}/\\tilde{k} = \\omega/\\tilde{k}$, we perform an asymptotic expansion for small $k\\Delta$. This implies that $\\lambda \\gg \\Delta$, and thus arguments of the sine functions are small. We use the Taylor series $\\sin(x) = x - x^3/6 + O(x^5)$, which gives $\\sin^2(x) = x^2 - x^4/3 + O(x^6)$.\n\nThe right-hand side (RHS) of the dispersion relation becomes:\n$$ \\text{RHS} = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\sin^2\\left(\\frac{ck\\Delta t}{2}\\right) = \\sin^2\\left(\\frac{k\\Delta S}{2}\\right) \\approx \\left(\\frac{k\\Delta S}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{k\\Delta S}{2}\\right)^4 = \\frac{S^2(k\\Delta)^2}{4} - \\frac{S^4(k\\Delta)^4}{48} $$\nThe left-hand side (LHS) becomes:\n$$ \\text{LHS} = S^2 \\sum_{j \\in \\{x,y,z\\}} \\sin^2\\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right) \\approx S^2 \\sum_j \\left[ \\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right)^4 \\right] $$\n$$ \\text{LHS} \\approx S^2 \\left[ \\frac{(\\tilde{k}\\Delta)^2}{4}\\sum_j\\mu_j^2 - \\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 \\right] $$\nSince $\\sum_j\\mu_j^2 = 1$:\n$$ \\text{LHS} \\approx S^2\\frac{(\\tilde{k}\\Delta)^2}{4} - S^2\\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 $$\nEquating the expanded LHS and RHS:\n$$ S^2\\frac{(\\tilde{k}\\Delta)^2}{4} - S^2\\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 \\approx \\frac{S^2(k\\Delta)^2}{4} - \\frac{S^4(k\\Delta)^4}{48} $$\nDividing by $S^2(\\Delta^2/4)$:\n$$ \\tilde{k}^2 - \\frac{\\tilde{k}^4\\Delta^2}{12}\\sum_j\\mu_j^4 \\approx k^2 - \\frac{S^2k^4\\Delta^2}{12} $$\nTo solve for $\\tilde{k}$, we use a perturbative approach. To leading order, $\\tilde{k} \\approx k$. We substitute this into the higher-order terms:\n$$ \\tilde{k}^2 \\approx k^2 - \\frac{S^2k^4\\Delta^2}{12} + \\frac{k^4\\Delta^2}{12}\\sum_j\\mu_j^4 = k^2\\left[1 - \\frac{(k\\Delta)^2}{12}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right] $$\n$$ \\tilde{k} \\approx k\\left[1 - \\frac{(k\\Delta)^2}{12}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right]^{1/2} \\approx k\\left[1 - \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right] $$\nThe normalized numerical phase velocity is $v_p/c = (\\omega/\\tilde{k})/c = k/\\tilde{k}$:\n$$ \\frac{v_p(\\hat{\\mathbf{k}})}{c} = \\frac{k}{\\tilde{k}} \\approx \\left[1 - \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right]^{-1} \\approx 1 + \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right) $$\nThe anisotropy $\\mathcal{A}$ depends on the variation of $v_p$ with the direction $\\hat{\\mathbf{k}}$. This variation is governed by the term $F(\\hat{\\mathbf{k}}) = \\sum_j\\mu_j^4 = \\mu_x^4+\\mu_y^4+\\mu_z^4$. We need to find the minimum and maximum of $F$ subject to the constraint $\\mu_x^2+\\mu_y^2+\\mu_z^2=1$.\nLet $x=\\mu_x^2, y=\\mu_y^2, z=\\mu_z^2$. We seek to extremize $x^2+y^2+z^2$ subject to $x+y+z=1$ and $x,y,z \\ge 0$.\nThe maximum value occurs at the vertices of the constraint domain, e.g., $(x,y,z)=(1,0,0)$. This corresponds to propagation along a grid axis, e.g., $\\hat{\\mathbf{k}} = (1,0,0)$.\n$$ F_{\\max} = 1^4+0^4+0^4 = 1 $$\nThe minimum value occurs when $x=y=z=1/3$. This corresponds to propagation along a space diagonal, e.g., $\\hat{\\mathbf{k}} = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$.\n$$ F_{\\min} = 3 \\times (1/\\sqrt{3})^4 = 3 \\times (1/9) = 1/3 $$\nThe phase velocity is maximized when $\\sum_j \\mu_j^4$ is minimized and minimized when it is maximized, due to the negative sign in its formula:\n$$ \\frac{v_{p,\\max}}{c} \\approx 1 + \\frac{(k\\Delta)^2}{24}(S^2 - F_{\\min}) = 1 + \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\frac{1}{3}\\right) $$\n$$ \\frac{v_{p,\\min}}{c} \\approx 1 + \\frac{(k\\Delta)^2}{24}(S^2 - F_{\\max}) = 1 + \\frac{(k\\Delta)^2}{24}(S^2 - 1) $$\nThe anisotropy is defined as $\\mathcal{A} \\equiv (\\max v_p - \\min v_p)/c$:\n$$ \\mathcal{A} = \\frac{v_{p,\\max}}{c} - \\frac{v_{p,\\min}}{c} \\approx \\frac{(k\\Delta)^2}{24}\\left[\\left(S^2 - \\frac{1}{3}\\right) - (S^2 - 1)\\right] = \\frac{(k\\Delta)^2}{24}\\left(1 - \\frac{1}{3}\\right) = \\frac{(k\\Delta)^2}{24}\\left(\\frac{2}{3}\\right) $$\n$$ \\mathcal{A} \\approx \\frac{(k\\Delta)^2}{36} $$\nThis leading-order result for anisotropy is independent of the Courant number $S$. The problem requires this to be satisfied for *some* admissible $S$. For the 3D Yee scheme, the stability condition is $S \\le 1/\\sqrt{3}$. Since our result for $\\mathcal{A}$ is independent of $S$, any stable $S$ can be chosen without affecting the anisotropy constraint.\n\nWe are given the tolerance $\\mathcal{A} \\le \\epsilon$, where $\\epsilon=0.01$. Substituting $k = 2\\pi/\\lambda$:\n$$ \\frac{((2\\pi/\\lambda)\\Delta)^2}{36} \\le \\epsilon $$\n$$ \\frac{4\\pi^2(\\Delta/\\lambda)^2}{36} \\le \\epsilon $$\n$$ \\frac{\\pi^2}{9}\\left(\\frac{\\Delta}{\\lambda}\\right)^2 \\le \\epsilon $$\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)^2 \\le \\frac{9\\epsilon}{\\pi^2} $$\nThe maximal allowable ratio $\\Delta/\\lambda$ is therefore:\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} = \\sqrt{\\frac{9\\epsilon}{\\pi^2}} = \\frac{3\\sqrt{\\epsilon}}{\\pi} $$\nSubstituting $\\epsilon = 0.01$:\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} = \\frac{3\\sqrt{0.01}}{\\pi} = \\frac{3 \\times 0.1}{\\pi} = \\frac{0.3}{\\pi} $$\nNow, we compute the numerical value and round to four significant figures:\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} \\approx \\frac{0.3}{3.14159265...} \\approx 0.0954929658... $$\nRounding to four significant figures gives $0.09549$.", "answer": "$$\\boxed{0.09549}$$", "id": "3335173"}, {"introduction": "While analytical approximations provide valuable guidelines, computational exploration allows for precise optimization of simulation parameters. This exercise transitions from pure analysis to computational practice, where you will implement the 2D dispersion relation in code to perform a parametric sweep. By mapping the anisotropy over the parameter space of the Courant number $S$ and grid resolution $\\alpha = k\\Delta$, you will learn to computationally identify iso-error contours and optimal operating points to minimize numerical artifacts in your simulations [@problem_id:3335136].", "problem": "Consider a two-dimensional electromagnetic wave in vacuum discretized by the Finite-Difference Time-Domain (FDTD) method on a uniform orthogonal Yee grid with equal spatial steps $\\Delta x = \\Delta y = \\Delta$ and time step $\\Delta t$. Define the dimensionless Courant number $S = c \\, \\Delta t / \\Delta$, where $c$ is the vacuum speed of light. Assume a plane-wave solution propagating at wavenumber vector $\\mathbf{k} = (k_x, k_y)$ with magnitude $k = \\|\\mathbf{k}\\|$, direction unit vector $\\hat{\\mathbf{k}} = (\\cos \\theta, \\sin \\theta)$, angular frequency $\\omega$, and define the dimensionless spatial sampling parameter $\\alpha = k \\Delta$. All angles must be specified and used in radians.\n\nStarting from the macroscopic Maxwell’s equations in vacuum and the Yee staggered-grid discretization, derive the numerical dispersion relation for two-dimensional propagation with equal spatial steps. From this result, derive a formula for the numerical phase velocity $v_p(\\theta; S, \\alpha)$ and the directional relative phase velocity error\n$$\nE(\\theta; S, \\alpha) = \\left| \\frac{v_p(\\theta; S, \\alpha) - c}{c} \\right|.\n$$\nDefine the anisotropy metric as the worst-case angular error over propagation directions\n$$\nA(S,\\alpha) = \\max_{\\theta \\in [0,\\pi/2]} E(\\theta; S, \\alpha),\n$$\nwhere it is sufficient to restrict to $\\theta \\in [0,\\pi/2]$ due to symmetry. The numerical stability condition mandates $S \\le 1/\\sqrt{2}$ for the two-dimensional equal-step Yee grid; restrict $S$ to the closed interval $[0.1, 0.705]$.\n\nWrite a complete program that:\n- Implements the derived expression for $v_p(\\theta; S, \\alpha)$ using only fundamental constants and the dimensionless parameters $S$ and $\\alpha$, and computes $E(\\theta; S, \\alpha)$.\n- Computes $A(S,\\alpha)$ by numerically maximizing over $\\theta \\in [0,\\pi/2]$ sampled uniformly with $N_\\theta = 1441$ points.\n- Performs a parametric sweep over $S \\in \\{ 0.100, 0.101, \\ldots, 0.705 \\}$ to evaluate $A(S,\\alpha)$ on a grid.\n- For a specified error level $\\varepsilon > 0$, defines an iso-anisotropy contour point at a given $\\alpha$ as any $S$ minimizing $\\left|A(S,\\alpha) - \\varepsilon\\right|$ over the sweep. Report both the $S$ value found and the achieved anisotropy level at that $S$.\n- Defines an operating point for minimal angular error at a given $\\alpha$ as any $S$ minimizing $A(S,\\alpha)$ over the sweep. Report both the $S$ value found and the minimal anisotropy level.\n\nAll quantities are dimensionless, and all angles must be treated in radians. Your program must use the above definitions and carry out the numerical maximizations via uniform sampling as specified.\n\nTest Suite and Answer Specification:\n- Use the following four test cases, each returning a pair of floats for the requested values, in the order listed below. For each returned pair, report values rounded to six decimal places.\n  1. For $\\alpha_1 = 1.0$, return the operating point for minimal angular error as $[S_{\\text{opt}}(\\alpha_1), A_{\\min}(\\alpha_1)]$, where $S_{\\text{opt}}(\\alpha_1) = \\arg\\min_{S \\in [0.1,0.705]} A(S,\\alpha_1)$ and $A_{\\min}(\\alpha_1) = \\min_{S \\in [0.1,0.705]} A(S,\\alpha_1)$.\n  2. For $\\alpha_2 = 1.5$ and iso-level $\\varepsilon_2 = 0.02$, return the iso-anisotropy contour point as $[S_{\\varepsilon_2}(\\alpha_2), A(S_{\\varepsilon_2}(\\alpha_2), \\alpha_2)]$, where $S_{\\varepsilon_2}(\\alpha_2) = \\arg\\min_{S \\in [0.1,0.705]} |A(S,\\alpha_2)-\\varepsilon_2|$.\n  3. For $\\alpha_3 = 0.5$ and iso-level $\\varepsilon_3 = 0.005$, return the iso-anisotropy contour point as $[S_{\\varepsilon_3}(\\alpha_3), A(S_{\\varepsilon_3}(\\alpha_3), \\alpha_3)]$ with the same definition.\n  4. For boundary testing at higher spatial frequency, for $\\alpha_4 = 2.5$, return the operating point for minimal angular error as $[S_{\\text{opt}}(\\alpha_4), A_{\\min}(\\alpha_4)]$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a two-element list for one test case. The order must match the four test cases above. For example, the printed line must look like\n$[\\,[S_1,A_1],[S_2,A_2],[S_3,A_3],[S_4,A_4]\\,]$\nwith all floats rounded to six decimal places.", "solution": "The user-provided problem is assessed to be valid as it is scientifically grounded in the principles of computational electromagnetics, well-posed, objective, and contains a complete and consistent set of definitions and constraints. The tasks are standard in the analysis of numerical methods and are non-trivial. Thus, a full solution is warranted.\n\nThe core of the problem is to derive and analyze the numerical dispersion relation for the two-dimensional (2D) Finite-Difference Time-Domain (FDTD) method on a Yee grid with equal spatial steps.\n\n### Derivation of the Numerical Dispersion Relation\n\nWe begin with Maxwell's curl equations in a source-free vacuum for a Transverse Magnetic ($\\text{TM}_z$) wave, which has field components $E_z$, $H_x$, and $H_y$:\n$$ \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon_0} \\left( \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y} \\right) $$\n$$ \\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu_0} \\frac{\\partial E_z}{\\partial y} $$\n$$ \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu_0} \\frac{\\partial E_z}{\\partial x} $$\n\nThe FDTD method discretizes these equations on a Yee grid. With uniform spatial steps $\\Delta x = \\Delta y = \\Delta$ and time step $\\Delta t$, the partial derivatives are approximated by second-order accurate central finite differences. For a harmonic plane-wave solution of the form $F(x,y,t) = F_0 e^{i(k_x x + k_y y - \\omega t)}$, where $F$ is any field component, the continuous differential operators $(\\frac{\\partial}{\\partial t}, \\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$ are transformed into multiplicative factors in the spectral domain. For the standard Yee scheme, this transformation is:\n$$ \\frac{\\partial}{\\partial t} \\rightarrow \\frac{2i}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n$$ \\frac{\\partial}{\\partial x} \\rightarrow \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) $$\n$$ \\frac{\\partial}{\\partial y} \\rightarrow \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) $$\nHere, $\\omega$ is the numerical angular frequency, and $k_x$, $k_y$ are the numerical wavenumbers, which are assumed to be identical to their continuous counterparts for the incident wave.\n\nSubstituting these into Maxwell's equations yields a system of algebraic equations for the field amplitudes $E_{z0}, H_{x0}, H_{y0}$:\n$$ \\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) E_{z0} = \\frac{1}{\\varepsilon_0} \\left( \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x \\Delta}{2}\\right) H_{y0} - \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_y \\Delta}{2}\\right) H_{x0} \\right) $$\n$$ \\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) H_{x0} = -\\frac{1}{\\mu_0} \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_y \\Delta}{2}\\right) E_{z0} $$\n$$ \\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) H_{y0} = \\frac{1}{\\mu_0} \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x \\Delta}{2}\\right) E_{z0} $$\n\nFrom the latter two equations, we express $H_{x0}$ and $H_{y0}$ in terms of $E_{z0}$:\n$$ H_{x0} = -\\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(k_y \\Delta / 2)}{\\sin(\\omega \\Delta t / 2)} E_{z0} $$\n$$ H_{y0} = \\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(k_x \\Delta / 2)}{\\sin(\\omega \\Delta t / 2)} E_{z0} $$\n\nSubstituting these into the equation for $E_{z0}$ and simplifying cancels the field amplitudes, yielding the numerical dispersion relation:\n$$ \\left( \\frac{1}{c\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right)^2 = \\left( \\frac{1}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) \\right)^2 + \\left( \\frac{1}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) \\right)^2 $$\nwhere $c = 1/\\sqrt{\\varepsilon_0\\mu_0}$ is the vacuum speed of light.\n\n### Numerical Phase Velocity and Anisotropy\n\nTo analyze this relation, we introduce the dimensionless parameters specified: the Courant number $S = c\\Delta t/\\Delta$, the spatial sampling parameter $\\alpha = k\\Delta$, and the propagation angle $\\theta$ where $k_x = k\\cos\\theta$ and $k_y = k\\sin\\theta$. The numerical dispersion relation becomes:\n$$ \\left( \\frac{1}{S} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right)^2 = \\sin^2\\left(\\frac{k\\Delta\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{k\\Delta\\sin\\theta}{2}\\right) $$\n$$ \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} $$\n\nThe numerical phase velocity is defined as $v_p = \\omega/k$. We can solve for $\\omega$ from the above relation:\n$$ \\omega = \\frac{2}{\\Delta t} \\arcsin\\left( S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} \\right) $$\nThen, we find the phase velocity normalized to $c$:\n$$ \\frac{v_p(\\theta; S, \\alpha)}{c} = \\frac{\\omega}{ck} = \\frac{\\omega \\Delta}{ck\\Delta} = \\frac{\\omega \\Delta}{c\\alpha} = \\frac{\\Delta}{c\\alpha} \\frac{2}{\\Delta t} \\arcsin(\\dots) = \\frac{2}{\\alpha S} \\arcsin(\\dots) $$\nThis gives the final formula for the normalized numerical phase velocity:\n$$ \\frac{v_p(\\theta; S, \\alpha)}{c} = \\frac{2}{\\alpha S} \\arcsin\\left( S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} \\right) $$\n\nThe directional relative phase velocity error $E$ is then:\n$$ E(\\theta; S, \\alpha) = \\left| \\frac{v_p(\\theta; S, \\alpha)}{c} - 1 \\right| $$\nThe anisotropy metric $A(S, \\alpha)$ is the maximum value of this error over the propagation angles $\\theta \\in [0, \\pi/2]$:\n$$ A(S,\\alpha) = \\max_{\\theta \\in [0,\\pi/2]} E(\\theta; S, \\alpha) $$\n\n### Numerical Implementation\nThe program will implement the derived formula for $E(\\theta; S, \\alpha)$ and perform the numerical tasks as specified.\n1. A function for $E(\\theta; S, \\alpha)$ is implemented based on the derived expression.\n2. The anisotropy $A(S,\\alpha)$ is calculated by numerically evaluating $E$ on a uniform grid of $N_\\theta = 1441$ points in $\\theta \\in [0, \\pi/2]$ and finding the maximum value.\n3. A parametric sweep is performed for $S \\in [0.100, 0.705]$ with a step of $0.001$. For a given $\\alpha$ from a test case, $A(S,\\alpha)$ is computed for each $S$ in the sweep.\n4. To find the operating point for minimal angular error, the program finds the minimum value of the computed $A(S,\\alpha)$ array and the corresponding $S$.\n5. To find an iso-anisotropy contour point for a given $\\varepsilon$, the program finds the $S$ value that minimizes the absolute difference $|A(S,\\alpha) - \\varepsilon|$.\n6. The results for the four specified test cases are calculated and formatted into the required output string.\n\nThe implementation uses `numpy` for efficient vectorized computation of $E$ over grids of $S$ and $\\theta$ values, ensuring correctness and performance.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FDTD numerical dispersion problem by deriving and implementing\n    the formulas for phase velocity error and anisotropy, and then performing\n    parametric sweeps to find optimal operating points as specified.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, kind, parameter)\n        (1.0, 'min', None),     # Case 1: Minimal error for alpha=1.0\n        (1.5, 'iso', 0.02),     # Case 2: Iso-contour for alpha=1.5, epsilon=0.02\n        (0.5, 'iso', 0.005),    # Case 3: Iso-contour for alpha=0.5, epsilon=0.005\n        (2.5, 'min', None)      # Case 4: Minimal error for alpha=2.5\n    ]\n\n    # Set up numerical grids as per the problem description.\n    # Grid for maximizing over theta\n    N_theta = 1441\n    theta_grid = np.linspace(0, np.pi / 2, N_theta)\n\n    # Grid for sweeping the Courant number S\n    # S ranges from 0.100 to 0.705 in steps of 0.001\n    s_start, s_end, s_step = 0.100, 0.705, 0.001\n    num_s_points = int(round((s_end - s_start) / s_step)) + 1\n    S_sweep = np.linspace(s_start, s_end, num_s_points)\n\n    final_results = []\n\n    for alpha, kind, epsilon in test_cases:\n        # Use broadcasting for efficient vectorized computation over S and theta grids.\n        # S_b will have shape (num_s_points, 1)\n        # theta_b will have shape (1, N_theta)\n        S_b = S_sweep[:, np.newaxis]\n        theta_b = theta_grid[np.newaxis, :]\n\n        # Calculate the argument for the arcsin function in the dispersion relation.\n        # This part of the calculation depends on both S and theta.\n        arg_sin_x = alpha * np.cos(theta_b) / 2\n        arg_sin_y = alpha * np.sin(theta_b) / 2\n        \n        sqrt_term = np.sqrt(np.sin(arg_sin_x)**2 + np.sin(arg_sin_y)**2)\n        \n        # The argument of arcsin must be <= 1. This is guaranteed by the stability\n        # condition S <= 1/sqrt(2), which our sweep range respects.\n        arcsin_arg = S_b * sqrt_term\n        \n        # Calculate normalized phase velocity vp/c.\n        vp_over_c = (2 / (alpha * S_b)) * np.arcsin(arcsin_arg)\n        \n        # Calculate the directional relative phase velocity error E.\n        # E_matrix has shape (num_s_points, N_theta).\n        E_matrix = np.abs(vp_over_c - 1)\n        \n        # Calculate the anisotropy metric A(S, alpha) by maximizing E over theta for each S.\n        # A_values is an array of shape (num_s_points,).\n        A_values = np.max(E_matrix, axis=1)\n\n        # Process the results based on the test case type ('min' or 'iso').\n        if kind == 'min':\n            # Find the index of the minimum anisotropy value.\n            idx = np.argmin(A_values)\n            s_opt = S_sweep[idx]\n            a_min = A_values[idx]\n            final_results.append([s_opt, a_min])\n        elif kind == 'iso':\n            # Find the index where A is closest to the target epsilon.\n            diffs = np.abs(A_values - epsilon)\n            idx = np.argmin(diffs)\n            s_iso = S_sweep[idx]\n            a_at_s_iso = A_values[idx]\n            final_results.append([s_iso, a_at_s_iso])\n\n    # Format the final output string as specified.\n    # Each number is rounded to six decimal places.\n    formatted_pairs = [f\"[{s:.6f},{a:.6f}]\" for s, a in final_results]\n    output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "3335136"}]}