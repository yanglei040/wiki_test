{"hands_on_practices": [{"introduction": "A correct simulation begins with consistent initial conditions. This practice explores how the fundamental physical principles of causality and passivity dictate the initial state of a dispersive medium. By analyzing the implications of starting from a quiescent state, where fields are initially zero, you will determine the only valid initialization for both the electromagnetic fields and the internal auxiliary variables of the ADE model [@problem_id:3289844].", "problem": "A three-dimensional Finite-Difference Time-Domain (FDTD) simulation is to be initialized in a linear, passive, causal dispersive medium whose electric response is implemented using the Auxiliary Differential Equation (ADE) method. The electromagnetic field is initially quiescent, with $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ and $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$. There are no free charges or currents at $t=0$, so $\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$ and $\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$. The electric flux density satisfies $\\mathbf{D}=\\epsilon_0 \\mathbf{E}+\\mathbf{P}$, where $\\mathbf{P}$ is the polarization vector, and the polarization current density is $\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$. The ADE representation of dispersion consists of a set of stable linear ordinary differential equations for internal material states that produce $\\mathbf{P}$ when driven by $\\mathbf{E}$, and is integrated in time with the same leapfrog staggering used for the Yee field update, with $\\mathbf{E}$ at integer times $t^n=n\\Delta t$ and $\\mathbf{H}$ at half-integer times $t^{n+\\frac{1}{2}}$.\n\nStarting from the macroscopic Maxwell equations in differential form,\n$$\n\\nabla\\times\\mathbf{H}=\\mathbf{J}_{\\mathrm{f}}+\\frac{\\partial \\mathbf{D}}{\\partial t},\\quad\n\\nabla\\cdot\\mathbf{D}=\\rho_{\\mathrm{f}},\\quad\n\\nabla\\times\\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t},\\quad\n\\nabla\\cdot\\mathbf{B}=0,\n$$\nwith $\\mathbf{D}=\\epsilon_0\\mathbf{E}+\\mathbf{P}$ and $\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$, and assuming the ADE internal dynamics correspond to a passive stable equilibrium when $\\mathbf{E}=\\mathbf{0}$, determine which of the following prescriptions yields consistent initial conditions for the ADE variables $\\mathbf{P}$ and $\\dot{\\mathbf{P}}$ that do not violate Maxwell’s equations or the material’s state equations when the simulation starts from $\\mathbf{E}=\\mathbf{H}=\\mathbf{0}$.\n\nA. Set $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$ and $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ everywhere. For any first-order ADE internal state variables $\\mathbf{q}_m$ associated with dispersive poles, initialize $\\mathbf{q}_m$ to the equilibrium value corresponding to $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, which is $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$ in a linear passive medium.\n\nB. Pre-load the material with “static” polarization by setting $\\mathbf{P}(\\mathbf{r},0)$ equal to the zero-frequency susceptibility response and enforce damping by taking $\\dot{\\mathbf{P}}(\\mathbf{r},0)=-\\gamma\\,\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$, even though $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, so that relaxation begins immediately.\n\nC. Choose any nonzero divergence-free polarization field, $\\nabla\\cdot\\mathbf{P}(\\mathbf{r},0)=0$ with $\\mathbf{P}(\\mathbf{r},0)\\not\\equiv\\mathbf{0}$, and set $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$. This guarantees $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$ without introducing initial polarization current.\n\nD. Respect the Yee time staggering by setting $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ and $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$, and choose $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ and the polarization current $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\dot{\\mathbf{P}}^{1/2}(\\mathbf{r})=\\mathbf{0}$. Initialize any ADE first-order internal states at their equilibrium values given $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$, which is $\\mathbf{0}$ in a linear passive medium.\n\nSelect all options that are correct.", "solution": "The problem asks for consistent initial conditions for the state variables of a dispersive medium, described by the Auxiliary Differential Equation (ADE) method, within a Finite-Difference Time-Domain (FDTD) simulation. The simulation starts from an \"initially quiescent\" state, meaning the electromagnetic fields are zero at time $t=0$, and there are no free charges or currents.\n\nThe validation of the problem statement is performed first.\n\n**Step 1: Extract Givens**\n- Simulation: Three-dimensional FDTD.\n- Medium: Linear, passive, causal, dispersive.\n- Method: Auxiliary Differential Equation (ADE).\n- Initial EM Fields: $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$.\n- Initial Free Sources: $\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$, $\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$.\n- Constitutive Relation: $\\mathbf{D}=\\epsilon_0 \\mathbf{E}+\\mathbf{P}$.\n- Polarization Current: $\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$.\n- ADE Dynamics: Stable linear ODEs for internal states, producing $\\mathbf{P}$ from driver $\\mathbf{E}$. Corresponds to a passive stable equilibrium when $\\mathbf{E}=\\mathbf{0}$.\n- Yee Time Staggering: $\\mathbf{E}$ at integer times $t^n=n\\Delta t$, $\\mathbf{H}$ at half-integer times $t^{n+1/2}$.\n- Governing Equations: Macroscopic Maxwell's equations.\n$$\n\\nabla\\times\\mathbf{H}=\\mathbf{J}_{\\mathrm{f}}+\\frac{\\partial \\mathbf{D}}{\\partial t} \\quad (1)\n$$\n$$\n\\nabla\\cdot\\mathbf{D}=\\rho_{\\mathrm{f}} \\quad (2)\n$$\n$$\n\\nabla\\times\\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t} \\quad (3)\n$$\n$$\n\\nabla\\cdot\\mathbf{B}=0 \\quad (4)\n$$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically well-grounded, representing a standard scenario in computational electromagnetics. The concepts of linear, passive, causal dispersive media, the FDTD method, the ADE formulation, Maxwell's equations, and quiescent initial conditions are all standard and well-defined in physics and engineering. The problem is self-contained and presents no internal contradictions. The data provided are sufficient to determine the consistency of the proposed initial conditions. The language is objective and precise. The problem is therefore valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed to the solution.\n\n**Derivation of Consistent Initial Conditions**\n\nThe core principle is that the initial conditions for the material state variables ($\\mathbf{P}$, $\\dot{\\mathbf{P}}$, and any internal ADE states) must be consistent with both Maxwell's equations and the constitutive nature of the medium at the initial time $t=0$.\n\n1.  **Implications of a Linear, Passive, Causal Medium:**\n    The medium is specified as causal. Causality dictates that the response of a system cannot precede its cause. Here, the electric field $\\mathbf{E}$ is the cause (or driver), and the polarization $\\mathbf{P}$ is the effect (or response). The problem states the system is \"initially quiescent\" with $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$. This implies that for all times $t \\le 0$, the electric field has been zero. In a causal system, if $\\mathbf{E}(\\mathbf{r},t)=\\mathbf{0}$ for all $t \\le 0$, then the polarization must also be zero, $\\mathbf{P}(\\mathbf{r},t)=\\mathbf{0}$, for all $t \\le 0$. This leads to two direct conclusions:\n    -   The initial polarization must be zero: $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$.\n    -   The initial time derivative of polarization must also be zero: $\\dot{\\mathbf{P}}(\\mathbf{r},0) = \\frac{\\partial\\mathbf{P}}{\\partial t}\\Big|_{t=0} = \\mathbf{0}$.\n\n2.  **Implications of a Stable Equilibrium:**\n    The problem states that the ADE dynamics have a \"passive stable equilibrium when $\\mathbf{E}=\\mathbf{0}$.\" For a linear system, this unique stable equilibrium point is the zero state. Since the driving field is $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, the material must be at this equilibrium. This confirms that not only must $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$, but any internal state variables of the ADE model, let us call them $\\mathbf{q}_m$, must also be at their equilibrium values, which are $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$.\n\n3.  **Consistency with Maxwell's Equations at $t=0$:**\n    Let us verify that these conditions are consistent with Maxwell's equations at $t=0$, given the initial fields and sources.\n    -   **Gauss's Law for $\\mathbf{D}$ (Eq. 2):** We must satisfy $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0) = \\rho_{\\mathrm{f}}(\\mathbf{r},0)$.\n        With $\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$, this requires $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$.\n        Substituting the constitutive relation: $\\nabla\\cdot(\\epsilon_0 \\mathbf{E}(\\mathbf{r},0) + \\mathbf{P}(\\mathbf{r},0))=0$.\n        Using the given $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ and our derived $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$, we have $\\nabla\\cdot(\\mathbf{0}+\\mathbf{0})=0$, which is satisfied.\n\n    -   **Ampere's Law (Eq. 1):** We must satisfy $\\nabla\\times\\mathbf{H}(\\mathbf{r},0) = \\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0) + \\frac{\\partial \\mathbf{D}}{\\partial t}\\Big|_{t=0}$.\n        With $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$ and $\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$, this requires $\\frac{\\partial \\mathbf{D}}{\\partial t}\\Big|_{t=0} = \\mathbf{0}$.\n        Expanding the time derivative of $\\mathbf{D}$: $\\frac{\\partial}{\\partial t}(\\epsilon_0 \\mathbf{E} + \\mathbf{P})\\Big|_{t=0} = \\epsilon_0 \\dot{\\mathbf{E}}(\\mathbf{r},0) + \\dot{\\mathbf{P}}(\\mathbf{r},0) = \\mathbf{0}$.\n        Our derived condition $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ makes this equation simplify to $\\epsilon_0 \\dot{\\mathbf{E}}(\\mathbf{r},0) = \\mathbf{0}$, or $\\dot{\\mathbf{E}}(\\mathbf{r},0)=\\mathbf{0}$. This condition is self-consistent; in the absence of any driving sources that turn on at $t=0$, the fields should indeed have a zero initial time derivative and remain zero.\n\nThe only consistent set of initial conditions for a quiescent, linear, passive, and causal dispersive medium is that all field and material state variables are zero.\n\n**Option-by-Option Analysis**\n\nA. **Set $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$ and $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ everywhere. For any first-order ADE internal state variables $\\mathbf{q}_m$ associated with dispersive poles, initialize $\\mathbf{q}_m$ to the equilibrium value corresponding to $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, which is $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$ in a linear passive medium.**\nThis statement is a direct and precise consequence of our derivation from first principles. It correctly identifies that in a linear, causal, passive system starting from a quiescent state ($\\mathbf{E}=\\mathbf{0}, \\mathbf{H}=\\mathbf{0}$), all internal material states must also be at their zero equilibrium. This includes the polarization $\\mathbf{P}$, its time derivative $\\dot{\\mathbf{P}}$, and any underlying ADE state variables $\\mathbf{q}_m$. As shown above, this set of conditions is fully consistent with Maxwell's equations.\nVerdict: **Correct**.\n\nB. **Pre-load the material with “static” polarization by setting $\\mathbf{P}(\\mathbf{r},0)$ equal to the zero-frequency susceptibility response and enforce damping by taking $\\dot{\\mathbf{P}}(\\mathbf{r},0)=-\\gamma\\,\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$, even though $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, so that relaxation begins immediately.**\nThis prescription violates the fundamental assumptions. Setting $\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$ contradicts the \"initially quiescent\" condition for a causal medium where $\\mathbf{E}(t)=\\mathbf{0}$ for $t\\le 0$. Such an initial state represents a medium with stored potential energy, which is not a quiescent state. This describes preparing the system in an excited state and observing its relaxation, which is a different physical problem.\nVerdict: **Incorrect**.\n\nC. **Choose any nonzero divergence-free polarization field, $\\nabla\\cdot\\mathbf{P}(\\mathbf{r},0)=0$ with $\\mathbf{P}(\\mathbf{r},0)\\not\\equiv\\mathbf{0}$, and set $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$. This guarantees $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$ without introducing initial polarization current.**\nThis option contains multiple inconsistencies. First, like option B, it proposes $\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$, which violates the quiescent and causal nature of the system. Second, it suggests setting $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ while the material is in a non-equilibrium state ($\\mathbf{P}\\neq\\mathbf{0}$ while the equilibrium value for $\\mathbf{E}=\\mathbf{0}$ is $\\mathbf{P}=\\mathbf{0}$). A passive system in a non-equilibrium state will inherently begin to relax toward equilibrium, a process which implies $\\dot{\\mathbf{P}}\\neq\\mathbf{0}$. For a typical linear passive model (e.g., Debye), having $\\mathbf{P}\\neq\\mathbf{0}$ and $\\mathbf{E}=\\mathbf{0}$ forces $\\dot{\\mathbf{P}}\\neq\\mathbf{0}$. Therefore, setting both $\\mathbf{P}\\neq\\mathbf{0}$ and $\\dot{\\mathbf{P}}=\\mathbf{0}$ is inconsistent with the material's own state equations.\nVerdict: **Incorrect**.\n\nD. **Respect the Yee time staggering by setting $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ and $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$, and choose $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ and the polarization current $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\dot{\\mathbf{P}}^{1/2}(\\mathbf{r})=\\mathbf{0}$. Initialize any ADE first-order internal states at their equilibrium values given $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$, which is $\\mathbf{0}$ in a linear passive medium.**\nThis option presents the same physical principles as option A but translated into the specific notation of the Yee FDTD algorithm.\n-   $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ is the discrete form of $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$.\n-   $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$ is the standard initialization for the magnetic field at the first half-time step in a leapfrog scheme to represent $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$.\n-   $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ and initializing ADE states to $\\mathbf{0}$ are the discrete versions of setting the initial material state to its zero equilibrium, consistent with $\\mathbf{E}^0=\\mathbf{0}$.\n-   $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\mathbf{0}$ specifies that the polarization current at the first half-time step is zero. This is a necessary consequence of the other initial conditions. Since the system starts at equilibrium ($\\mathbf{E}^0=\\mathbf{0}$, $\\mathbf{P}^0=\\mathbf{0}$, ADE states are $\\mathbf{0}$), there is no driver to induce a polarization current in the first time interval.\nThis option provides a complete and correct prescription for initializing the FDTD simulation in discrete time and space, fully consistent with the continuous-time physics.\nVerdict: **Correct**.", "answer": "$$\\boxed{AD}$$", "id": "3289844"}, {"introduction": "Once a simulation is initialized, its dynamic evolution must remain stable. This exercise transitions from static conditions to the dynamics of the time-stepping algorithm, addressing the critical issue of numerical instability. Through a hands-on coding task, you will investigate the stability of a discretized Drude model by finding the poles of its discrete-time system, a cornerstone technique for analyzing any linear time-domain numerical method [@problem_id:3289843].", "problem": "Consider a nonmagnetic, isotropic Drude medium characterized by free-electron polarization. Starting from Maxwell’s equations and the classical equation of motion for the free-electron polarization, the constitutive relation can be written in the time domain as the second-order linear ordinary differential equation\n$$\n\\frac{d^2 P(t)}{dt^2} + \\gamma \\frac{d P(t)}{dt} + \\omega_p^2 P(t) = \\varepsilon_0 \\,\\omega_p^2 E(t),\n$$\nwhere $P(t)$ is the electric polarization density, $E(t)$ is the electric field, $\\varepsilon_0$ is the vacuum permittivity, $\\omega_p$ is the plasma angular frequency (in rad/s), and $\\gamma$ is the collision frequency (in s$^{-1}$). In auxiliary differential equation (ADE) methods for dispersion in finite-difference time-domain (FDTD) algorithms, a common time discretization uses central differences at time index $n$ with a uniform time step $\\Delta t$ (in s). Applying the centered second-order difference to the polarization equation yields a discrete ADE update of the form\n$$\n\\frac{P^{n+1} - 2P^n + P^{n-1}}{\\Delta t^2} + \\gamma \\frac{P^{n+1} - P^{n-1}}{2 \\Delta t} + \\omega_p^2 P^n = \\varepsilon_0 \\,\\omega_p^2 E^n.\n$$\nThe discrete-time pole locations that govern the stability of this recursion are the roots of the homogeneous characteristic polynomial obtained by setting $E^n \\equiv 0$. Let $r$ denote the discrete-time growth factor so that $P^n \\propto r^n$. The corresponding characteristic polynomial is\n$$\na r^2 + b r + c = 0,\n$$\nwith\n$$\na = 1 + \\frac{\\gamma \\Delta t}{2}, \\quad b = -2 + \\omega_p^2 \\Delta t^2, \\quad c = 1 - \\frac{\\gamma \\Delta t}{2}.\n$$\nIn this problem, you will:\n- Derive the above homogeneous characteristic polynomial from first principles.\n- Determine the discrete-time poles and use them to assess stability: the discrete ADE is numerically unstable if and only if at least one pole satisfies $|r| > 1$.\n- Relate the instability threshold to the location of the discrete-time poles on the unit circle and compare with the continuous-time Drude poles $s_{1,2}$ mapped to discrete time via $z = e^{s \\Delta t}$.\n\nYour task is to write a complete, runnable program that:\n1. Implements the homogeneous discrete ADE characteristic polynomial as stated above.\n2. For each test case $(\\omega_p,\\gamma,\\Delta t)$, computes the two roots $r_1$ and $r_2$ and decides instability using the criterion $\\max(|r_1|,|r_2|) > 1$.\n3. Produces a single line of output containing a comma-separated list of booleans enclosed in square brackets, indicating instability for each test case in order.\n\nAll inputs are in the International System of Units: $\\omega_p$ in rad/s, $\\gamma$ in s$^{-1}$, and $\\Delta t$ in s. No angles are required. The output is dimensionless booleans.\n\nTest suite:\n- Case A (happy path, stable): $(\\omega_p, \\gamma, \\Delta t) = (1.0\\times 10^9, 0.0, 1.0\\times 10^{-9})$.\n- Case B (boundary, marginal): $(\\omega_p, \\gamma, \\Delta t) = (1.0\\times 10^9, 0.0, 2.0\\times 10^{-9})$.\n- Case C (unstable): $(\\omega_p, \\gamma, \\Delta t) = (1.0\\times 10^9, 0.0, 3.0\\times 10^{-9})$.\n- Case D (unstable with damping): $(\\omega_p, \\gamma, \\Delta t) = (1.0\\times 10^9, 5.0\\times 10^8, 3.0\\times 10^{-9})$.\n- Case E (stable with damping): $(\\omega_p, \\gamma, \\Delta t) = (5.0\\times 10^9, 1.0\\times 10^9, 2.5\\times 10^{-10})$.\n- Case F (unstable with damping): $(\\omega_p, \\gamma, \\Delta t) = (5.0\\times 10^9, 1.0\\times 10^9, 5.0\\times 10^{-10})$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC,resultD,resultE,resultF]\"), where each result is a boolean indicating instability for the corresponding test case.", "solution": "The problem requires an analysis of the numerical stability of a centered finite-difference time-domain (FDTD) discretization of the second-order ordinary differential equation (ODE) governing free-electron polarization in a Drude medium. The stability is determined by the locations of the roots of the system's characteristic polynomial, also known as the poles of the discrete-time system.\n\nFirst, we derive the homogeneous characteristic polynomial from the discrete auxiliary differential equation (ADE). The given discrete ADE is:\n$$\n\\frac{P^{n+1} - 2P^n + P^{n-1}}{\\Delta t^2} + \\gamma \\frac{P^{n+1} - P^{n-1}}{2 \\Delta t} + \\omega_p^2 P^n = \\varepsilon_0 \\,\\omega_p^2 E^n\n$$\nTo find the characteristic polynomial, we consider the homogeneous case where the driving term is zero, i.e., $E^n \\equiv 0$. The equation becomes:\n$$\n\\frac{P^{n+1} - 2P^n + P^{n-1}}{\\Delta t^2} + \\gamma \\frac{P^{n+1} - P^{n-1}}{2 \\Delta t} + \\omega_p^2 P^n = 0\n$$\nWe seek a solution of the form $P^n \\propto r^n$, where $r$ is the discrete-time growth factor. Substituting $P^n = C r^n$ for some constant $C$ into the homogeneous equation yields:\n$$\n\\frac{C r^{n+1} - 2 C r^n + C r^{n-1}}{\\Delta t^2} + \\gamma \\frac{C r^{n+1} - C r^{n-1}}{2 \\Delta t} + \\omega_p^2 C r^n = 0\n$$\nAssuming a non-trivial solution ($C \\neq 0$), we can divide the entire equation by $C r^{n-1}$:\n$$\n\\frac{r^2 - 2r + 1}{\\Delta t^2} + \\gamma \\frac{r^2 - 1}{2 \\Delta t} + \\omega_p^2 r = 0\n$$\nTo eliminate the denominators, we multiply by $\\Delta t^2$:\n$$\n(r^2 - 2r + 1) + \\frac{\\gamma \\Delta t}{2} (r^2 - 1) + (\\omega_p \\Delta t)^2 r = 0\n$$\nWe then group the terms by powers of $r$:\n$$\nr^2 \\left(1 + \\frac{\\gamma \\Delta t}{2}\\right) + r \\left(-2 + (\\omega_p \\Delta t)^2\\right) + \\left(1 - \\frac{\\gamma \\Delta t}{2}\\right) = 0\n$$\nThis is the characteristic polynomial of the form $ar^2 + br + c = 0$, with coefficients exactly as given in the problem statement:\n$$\na = 1 + \\frac{\\gamma \\Delta t}{2}, \\quad b = -2 + (\\omega_p \\Delta t)^2, \\quad c = 1 - \\frac{\\gamma \\Delta t}{2}\n$$\n\nNext, we determine the discrete-time poles and assess stability. The poles, $r_1$ and $r_2$, are the roots of this quadratic polynomial, given by the quadratic formula:\n$$\nr_{1,2} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}\n$$\nThe discrete system is numerically stable if and only if all its poles lie within or on the unit circle in the complex plane, i.e., $|r_k| \\le 1$ for $k=1,2$. The system is unstable if any pole has a magnitude greater than $1$, i.e., $|r_k| > 1$. The problem defines instability by the strict inequality $\\max(|r_1|, |r_2|) > 1$.\n\nLet's analyze the properties of the roots. The product of the roots is given by $r_1 r_2 = c/a$. Substituting the expressions for $a$ and $c$:\n$$\nr_1 r_2 = \\frac{1 - \\frac{\\gamma \\Delta t}{2}}{1 + \\frac{\\gamma \\Delta t}{2}}\n$$\nSince the collision frequency $\\gamma \\ge 0$ and the time step $\\Delta t > 0$, the denominator is greater than or equal to the numerator. Therefore, the magnitude of the product of the roots is always less than or equal to $1$:\n$$\n|r_1 r_2| \\le 1\n$$\nIf the roots are complex conjugates, $r_2 = r_1^*$, then $|r_1 r_2| = |r_1|^2$. In this case, $|r_1|^2 \\le 1$, which implies $|r_1| \\le 1$ and $|r_2| \\le 1$. A sufficient condition for the roots to be complex is for the discriminant $D = b^2 - 4ac$ to be negative. Thus, if $D < 0$, the system is stable.\n\nInstability, defined by $|r_k| > 1$, can therefore only occur if the discriminant is non-negative ($D \\ge 0$), meaning the roots are real. If the roots $r_1$ and $r_2$ are real, the condition $|r_1 r_2| \\le 1$ implies that it is not possible for both roots to have magnitudes greater than $1$. If one root has magnitude greater than $1$, the other must have a magnitude less than or equal to $1$. The instability is governed by the root with the larger magnitude.\n\nFinally, we relate this to the continuous-time system. The continuous-time Drude model's homogeneous ODE is $\\frac{d^2 P}{dt^2} + \\gamma \\frac{d P}{dt} + \\omega_p^2 P = 0$. Its characteristic equation is $s^2 + \\gamma s + \\omega_p^2 = 0$. The roots, or continuous-time poles, are $s_{1,2} = \\frac{-\\gamma \\pm \\sqrt{\\gamma^2 - 4\\omega_p^2}}{2}$. Since $\\gamma \\ge 0$, the real part of these poles is always non-positive, $\\text{Re}(s_{1,2}) \\le 0$. A physical system with such poles is inherently stable or marginally stable. When we map these poles to the discrete-time domain using the Z-transform, $z = e^{s \\Delta t}$, their magnitudes are $|z| = |e^{(\\text{Re}(s) + i\\text{Im}(s)) \\Delta t}| = e^{\\text{Re}(s) \\Delta t}$. Since $\\text{Re}(s) \\le 0$, it follows that $|z| \\le 1$. The poles of the exact discrete equivalent of the continuous system lie inside or on the unit circle. The numerical discretization, however, yields poles $r_{1,2}$ that are only an approximation of $z_{1,2}$. Numerical instability occurs when the approximation error is large enough to push one of the numerical poles $r_k$ outside the unit circle, i.e., $|r_k| > 1$, even though the underlying physical system is stable. This typically happens when the time step $\\Delta t$ is too large relative to the characteristic time scales of the system, such as $1/\\omega_p$. For the special case $\\gamma=0$, instability occurs when $\\omega_p \\Delta t > 2$.\n\nThe computational task is to, for each given set of parameters $(\\omega_p, \\gamma, \\Delta t)$:\n1.  Calculate the coefficients $a$, $b$, and $c$.\n2.  Solve the quadratic equation $ar^2 + br + c = 0$ for its roots $r_1, r_2$.\n3.  Compute the absolute values $|r_1|$ and $|r_2|$.\n4.  Determine if the system is unstable by checking if $\\max(|r_1|, |r_2|) > 1$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the stability of a discretized Drude model ADE for\n    several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (omega_p, gamma, delta_t)\n    test_cases = [\n        # Case A (happy path, stable)\n        (1.0e9, 0.0, 1.0e-9),\n        # Case B (boundary, marginal)\n        (1.0e9, 0.0, 2.0e-9),\n        # Case C (unstable)\n        (1.0e9, 0.0, 3.0e-9),\n        # Case D (unstable with damping)\n        (1.0e9, 5.0e8, 3.0e-9),\n        # Case E (stable with damping)\n        (5.0e9, 1.0e9, 2.5e-10),\n        # Case F (unstable with damping)\n        (5.0e9, 1.0e9, 5.0e-10),\n    ]\n\n    results = []\n    # Machine epsilon to handle floating point comparisons near 1.0\n    # A tolerance is generally good practice, but the problem's strict > 1\n    # criterion for instability is unambiguous. A small tolerance\n    # might be useful if the problem intended to classify marginal stability\n    # as unstable, but here |r|=1 is stable. We will use a strict > 1 check.\n    \n    for case in test_cases:\n        wp, gamma, dt = case\n\n        # Calculate the coefficients of the characteristic polynomial ar^2 + br + c = 0\n        a = 1.0 + (gamma * dt) / 2.0\n        b = (wp * dt)**2 - 2.0\n        c = 1.0 - (gamma * dt) / 2.0\n\n        # The coefficients for numpy.roots must be in descending order of power.\n        coefficients = [a, b, c]\n\n        # Compute the two roots (poles) of the characteristic polynomial.\n        # numpy.roots handles both real and complex roots.\n        roots = np.roots(coefficients)\n        \n        # Calculate the magnitudes (absolute values) of the roots.\n        amplitudes = np.abs(roots)\n        \n        # The discrete ADE is unstable if and only if at least one pole \n        # has a magnitude greater than 1.\n        is_unstable = np.max(amplitudes) > 1.0\n        \n        results.append(is_unstable)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts Python booleans (True, False) to strings.\n    # The problem asks for boolean output. In many contexts, Python's\n    # default `True` and `False` are fine, but some environments might\n    # expect lowercase `true` and `false`. The example `[resultA,resultB,...]`\n    # does not specify case, so we use Python's default.\n    print(f\"[{','.join(map(lambda x: str(x).lower(), results))}]\")\n```", "id": "3289843"}, {"introduction": "Beyond correctness and stability, computational efficiency is paramount, especially when modeling complex materials with multiple dispersion poles. This final practice bridges mathematical formulation with high-performance computing. You will derive the state-space representation for a multi-pole Lorentz model and discover how its inherently block-diagonal structure enables massive parallelism, making the algorithm a perfect fit for modern Single Instruction, Multiple Data (SIMD) architectures [@problem_id:3289886].", "problem": "Consider a linear, homogeneous, isotropic dispersive dielectric characterized in the frequency domain by a susceptibility that is a sum of $N$ Lorentz oscillator poles. In the time domain, this model can be represented by a set of $N$ coupled constitutive relations between the electric flux density $\\mathbf{D}$, the electric field $\\mathbf{E}$, and $N$ auxiliary polarization densities $\\{\\mathbf{P}_{m}\\}_{m=1}^{N}$, where for each pole $m$,\n$$\n\\mathbf{D}(t) = \\epsilon_{0}\\epsilon_{\\infty}\\mathbf{E}(t) + \\sum_{m=1}^{N} \\mathbf{P}_{m}(t),\n$$\nand each $\\mathbf{P}_{m}$ obeys the second-order ordinary differential equation\n$$\n\\ddot{\\mathbf{P}}_{m}(t) + \\gamma_{m}\\dot{\\mathbf{P}}_{m}(t) + \\omega_{0,m}^{2} \\mathbf{P}_{m}(t) = \\omega_{p,m}^{2} \\mathbf{E}(t),\n$$\nwith $\\epsilon_{0}$ the vacuum permittivity, $\\epsilon_{\\infty}$ the high-frequency relative permittivity, and, for each pole $m$, $\\gamma_{m}$ the damping rate, $\\omega_{0,m}$ the resonance frequency, and $\\omega_{p,m}$ the plasma frequency. Maxwell’s curl equations relate $\\mathbf{E}$ and the magnetic flux density $\\mathbf{B}$ as usual.\n\nDefine the auxiliary current $\\mathbf{J}_{m}(t) \\equiv \\dot{\\mathbf{P}}_{m}(t)$ and introduce the per-pole state vector for each component, $x_{m}(t) \\equiv \\begin{pmatrix} P_{m}(t) \\\\ J_{m}(t) \\end{pmatrix}$. Using this state, the per-pole constitutive dynamics can be written in first-order form,\n$$\n\\dot{x}_{m}(t) = F_{m}\\,x_{m}(t) + G_{m}\\,E(t),\n$$\nwhere $F_{m}$ and $G_{m}$ are constant matrices depending only on $\\gamma_{m}$, $\\omega_{0,m}$, and $\\omega_{p,m}$. Consider a uniform time step $\\Delta t$, and discretize the above first-order per-pole system using the trapezoidal rule (also known as the Crank–Nicolson method) to obtain a linear implicit time-update for $x_{m}^{n} \\equiv x_{m}(n\\Delta t)$ in terms of $x_{m}^{n+1}$, $x_{m}^{n}$, $E^{n+1}$, and $E^{n}$. Assemble the global state for each component $X^{n} \\equiv \\begin{pmatrix} x_{1}^{n} \\\\ \\vdots \\\\ x_{N}^{n} \\end{pmatrix}$ and write the resulting $N$-pole auxiliary differential equation (ADE) update as a compact vector-matrix recursion in block-diagonal state-space form. Then, based on the derived structure, explain from first principles why the block-diagonal form enables Single Instruction Multiple Data (SIMD) updates across poles without data hazards.\n\nAnswer the following:\n\n- Starting from Maxwell’s equations and the given Lorentz pole constitutive law, derive the trapezoidal-rule time-discrete per-pole update and express the global $N$-pole recursion in the compact block-diagonal state-space form $X^{n+1} = \\mathcal{A}\\,X^{n} + \\mathcal{B}\\,\\mathbf{E}^{n+1} + \\mathcal{B}\\,\\mathbf{E}^{n}$, where $\\mathcal{A}$ and $\\mathcal{B}$ do not depend on time.\n- Provide, in closed form, the block-diagonal update matrix $\\mathcal{A}$ explicitly in terms of $\\Delta t$, $\\{\\gamma_{m}\\}$, and $\\{\\omega_{0,m}\\}$.\n- Explain how the block-diagonal structure and per-pole independence enable Single Instruction Multiple Data (SIMD) updates across the $N$ poles.\n\nYour final answer must be the single closed-form analytical expression for the matrix $\\mathcal{A}$, expressed only in terms of $\\Delta t$, $\\{\\gamma_{m}\\}$, and $\\{\\omega_{0,m}\\}$. Do not include any equality sign or additional commentary in the final answer. No numerical evaluation is required.", "solution": "The problem asks for the derivation of the trapezoidal-rule-based time-domain update equations for a multi-pole Lorentz dispersion model using the auxiliary differential equation (ADE) method, and an analysis of the resulting structure for parallel computation.\n\nFirst, we must formalize the state-space representation. The governing second-order ordinary differential equation (ODE) for each polarization density pole $m$ is given as:\n$$\n\\ddot{\\mathbf{P}}_{m}(t) + \\gamma_{m}\\dot{\\mathbf{P}}_{m}(t) + \\omega_{0,m}^{2} \\mathbf{P}_{m}(t) = \\omega_{p,m}^{2} \\mathbf{E}(t)\n$$\nFor a linear, isotropic medium, the vector components of the polarization depend only on the corresponding vector components of the electric field. For instance, the $x$-component ODE would be $\\ddot{P}_{m,x}(t) + \\gamma_{m}\\dot{P}_{m,x}(t) + \\omega_{0,m}^{2} P_{m,x}(t) = \\omega_{p,m}^{2} E_x(t)$. The equations for the $y$ and $z$ components are identical in form. Therefore, we can perform the derivation for a single scalar component, and the resulting update coefficients will be the same for all three spatial components. Let the scalar variables $P_m(t)$, $J_m(t)$, and $E(t)$ represent one such component.\n\nThe state vector for each pole $m$ is defined as $x_{m}(t) = \\begin{pmatrix} P_{m}(t) \\\\ J_{m}(t) \\end{pmatrix}$, where $J_{m}(t) = \\dot{P}_{m}(t)$. The first derivative of the state vector is $\\dot{x}_{m}(t) = \\begin{pmatrix} \\dot{P}_{m}(t) \\\\ \\ddot{P}_{m}(t) \\end{pmatrix}$. Using the definitions and the governing ODE, we can write:\n$$\n\\dot{x}_{m}(t) = \\begin{pmatrix} J_{m}(t) \\\\ -\\omega_{0,m}^{2} P_{m}(t) - \\gamma_{m} J_{m}(t) + \\omega_{p,m}^{2} E(t) \\end{pmatrix}\n$$\nThis can be expressed in the first-order matrix form $\\dot{x}_{m}(t) = F_{m}x_{m}(t) + G_{m}E(t)$ by identifying the constant matrices $F_m$ and $G_m$:\n$$\nF_{m} = \\begin{pmatrix} 0 & 1 \\\\ -\\omega_{0,m}^{2} & -\\gamma_{m} \\end{pmatrix}, \\quad G_{m} = \\begin{pmatrix} 0 \\\\ \\omega_{p,m}^{2} \\end{pmatrix}\n$$\nNext, we discretize this system using the trapezoidal rule (Crank-Nicolson method) over a time step $\\Delta t$. For a general first-order ODE $\\dot{y} = f(y,t)$, the rule is $y^{n+1} - y^{n} = \\frac{\\Delta t}{2} \\left[ f(y^{n+1}, t^{n+1}) + f(y^{n}, t^{n}) \\right]$. Applying this to our linear system:\n$$\nx_{m}^{n+1} - x_{m}^{n} = \\frac{\\Delta t}{2} \\left[ (F_{m}x_{m}^{n+1} + G_{m}E^{n+1}) + (F_{m}x_{m}^{n} + G_{m}E^{n}) \\right]\n$$\nTo find an explicit update rule for $x_{m}^{n+1}$, we rearrange the equation to group terms involving $x_{m}^{n+1}$ on the left-hand side and all other terms on the right-hand side:\n$$\n\\left(I - \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n+1} = \\left(I + \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n} + \\frac{\\Delta t}{2}G_{m} \\left(E^{n+1} + E^{n}\\right)\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix. Solving for $x_{m}^{n+1}$ yields:\n$$\nx_{m}^{n+1} = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n} + \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\frac{\\Delta t}{2}G_{m} \\left(E^{n+1} + E^{n}\\right)\n$$\nThis is the per-pole update equation. We can now identify the per-pole update matrices. Let $A_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right)$ and $B_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\frac{\\Delta t}{2}G_{m}$. The update is $x_m^{n+1} = A_m x_m^n + B_m(E^{n+1} + E^n)$, which can be assembled into the global state-space form prescribed.\n\nThe global state vector is $X^n = \\begin{pmatrix} x_1^n \\\\ \\vdots \\\\ x_N^n \\end{pmatrix}$. Since the dynamics of each pole $m$ depend only on its own state $x_m$ and the common field $E$, the updates are uncoupled across poles. The global recursion is:\n$$\nX^{n+1} = \\mathcal{A} X^n + \\mathcal{B} (E^{n+1} + E^n)\n$$\nwhere the problem asks for the form $X^{n+1} = \\mathcal{A}X^{n} + \\mathcal{B}E^{n+1} + \\mathcal{B}E^{n}$.\nThe matrices $\\mathcal{A}$ and $\\mathcal{B}$ have the block structures:\n$$\n\\mathcal{A} = \\begin{pmatrix} A_1 & 0 & \\cdots & 0 \\\\ 0 & A_2 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\cdots & A_N \\end{pmatrix}, \\quad \\mathcal{B} = \\begin{pmatrix} B_1 \\\\ B_2 \\\\ \\vdots \\\\ B_N \\end{pmatrix}\n$$\nThe problem requires the closed-form expression for $\\mathcal{A}$. To find this, we must compute the matrix $A_m$. First, we find the matrices to be multiplied and inverted:\n$$\nI - \\frac{\\Delta t}{2}F_{m} = \\begin{pmatrix} 1 & -\\frac{\\Delta t}{2} \\\\ \\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 + \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\n$$\nI + \\frac{\\Delta t}{2}F_{m} = \\begin{pmatrix} 1 & \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\nThe determinant of $\\left(I - \\frac{\\Delta t}{2}F_{m}\\right)$ is:\n$$\n\\det\\left(I - \\frac{\\Delta t}{2}F_{m}\\right) = (1)\\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right) - \\left(-\\frac{\\Delta t}{2}\\right)\\left(\\frac{\\Delta t}{2}\\omega_{0,m}^{2}\\right) = 1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2}\n$$\nLet's denote this determinant as $D_m$. The inverse is:\n$$\n\\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} = \\frac{1}{D_m} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} & \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 \\end{pmatrix}\n$$\nNow we compute $A_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right)$:\n$$\nA_m = \\frac{1}{D_m} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} & \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\nPerforming the matrix multiplication gives the components of the numerator matrix:\n$$\n(A_m)_{11} = \\frac{1}{D_m} \\left[ \\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right) - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right] = \\frac{1}{D_m} \\left[ 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right]\n$$\n$$\n(A_m)_{12} = \\frac{1}{D_m} \\left[ \\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right)\\frac{\\Delta t}{2} + \\frac{\\Delta t}{2}\\left(1 - \\frac{\\Delta t}{2}\\gamma_{m}\\right) \\right] = \\frac{1}{D_m} \\left[ \\Delta t \\right]\n$$\n$$\n(A_m)_{21} = \\frac{1}{D_m} \\left[ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} - \\frac{\\Delta t}{2}\\omega_{0,m}^{2} \\right] = \\frac{1}{D_m} \\left[ -\\Delta t \\, \\omega_{0,m}^{2} \\right]\n$$\n$$\n(A_m)_{22} = \\frac{1}{D_m} \\left[ -\\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} + \\left(1 - \\frac{\\Delta t}{2}\\gamma_{m}\\right) \\right] = \\frac{1}{D_m} \\left[ 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right]\n$$\nSo the block $A_m$ is:\n$$\nA_m = \\frac{1}{1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} & \\Delta t \\\\ -\\Delta t \\, \\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} \\end{pmatrix}\n$$\nThe global matrix $\\mathcal{A}$ is the block-diagonal matrix formed by these $A_m$ blocks.\n\nFinally, we explain why this structure enables SIMD updates. SIMD stands for Single Instruction, Multiple Data, a parallel processing paradigm where the same operation is performed on multiple data points simultaneously.\nThe derived global update equation is $X^{n+1} = \\mathcal{A}X^{n} + \\mathcal{B}(E^{n+1} + E^{n})$. The crucial feature is that the matrix $\\mathcal{A}$ is block-diagonal. This structure mathematically represents the physical independence of the Lorentz poles. The update for the state of a single pole, $x_m^{n+1} = A_m x_m^n + B_m(E^{n+1} + E^n)$, depends only on its own previous state $x_m^n$ and the common driving field $E$. It does not depend on the state of any other pole, $x_k^n$ for $k \\neq m$.\nThis independence is the key to SIMD parallelization.\n1.  **Single Instruction**: The sequence of arithmetic operations required to compute $A_m x_m^n$ and add the field term is the same for every pole $m$. This sequence constitutes the \"single instruction\". Although the coefficients in $A_m$ (derived from $\\gamma_m$, $\\omega_{0,m}$) are different for each pole, the structure of the calculation is identical.\n2.  **Multiple Data**: The state vectors $\\{x_1^n, x_2^n, ..., x_N^n\\}$ for the $N$ different poles constitute the \"multiple data\".\nIn a SIMD architecture (e.g., using AVX instructions on a CPU or on a GPU), one can load the components of the state vectors for several poles into wide vector registers. For example, one register could hold the $P_m$ values for a set of different poles $m$, and another could hold the $J_m$ values. The same floating-point multiplications and additions defined by the update algorithm are then applied to all data lanes in the registers in parallel.\nBecause the update for pole $m$ does not require any information from pole $k$, there are no **data hazards** between the pole updates. All $N$ poles can be updated concurrently without waiting for results from each other. This lack of inter-pole data dependency makes the ADE-FDTD algorithm with a block-diagonal update matrix exceptionally efficient on modern parallel hardware.\nThe final answer is the closed-form expression for the matrix $\\mathcal{A}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} A_1 & & & \\mathbf{0} \\\\ & A_2 & & \\\\ & & \\ddots & \\\\ \\mathbf{0} & & & A_N \\end{pmatrix} \\text{ where } A_m = \\frac{1}{1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} & \\Delta t \\\\ -\\Delta t \\, \\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} \\end{pmatrix}\n}\n$$", "id": "3289886"}]}