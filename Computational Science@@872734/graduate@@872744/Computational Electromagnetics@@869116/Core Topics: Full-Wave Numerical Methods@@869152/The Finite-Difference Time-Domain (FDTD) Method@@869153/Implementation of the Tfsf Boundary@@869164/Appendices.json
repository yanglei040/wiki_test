{"hands_on_practices": [{"introduction": "The Total-Field/Scattered-Field (TFSF) technique is built upon the foundational field equivalence principle. This principle allows us to replace a source in one region with a set of equivalent electric and magnetic surface currents on a closed boundary. This practice [@problem_id:3318213] challenges you to apply this principle to a standard cubic TFSF box, deriving the essential sign conventions for the correction terms on each face. Mastering this conceptual step is crucial, as these signs determine whether the boundary correctly generates the incident wave or produces non-physical artifacts.", "problem": "A cubic Total-Field/Scattered-Field (TFSF) boundary separates a total-field region from a scattered-field region in a three-dimensional Finite-Difference Time-Domain (FDTD) simulation of a homogeneous, isotropic, source-free medium with permittivity $\\varepsilon$, permeability $\\mu$, wave impedance $\\eta=\\sqrt{\\mu/\\varepsilon}$, and phase velocity $v=\\frac{1}{\\sqrt{\\mu \\varepsilon}}$. The cube is aligned with the Cartesian axes and has faces at $x=x_{\\min}$, $x=x_{\\max}$, $y=y_{\\min}$, $y=y_{\\max}$, $z=z_{\\min}$, and $z=z_{\\max}$. The unit normal $\\hat{\\mathbf{n}}$ on each face points outward from the total-field region into the scattered-field region.\n\nAn incident plane wave in this medium is specified by a wavevector $\\mathbf{k}=k\\,\\hat{\\mathbf{k}}$ with $k=\\omega/v$, a unit polarization vector $\\hat{\\mathbf{p}}$ satisfying $\\hat{\\mathbf{p}}\\cdot \\hat{\\mathbf{k}}=0$, and a scalar waveform $g(\\cdot)$ with amplitude $E_{0}$. The time-domain fields are\n$$\n\\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t)=E_{0}\\,\\hat{\\mathbf{p}}\\,g\\!\\left(t-\\frac{\\hat{\\mathbf{k}}\\cdot \\mathbf{r}}{v}\\right), \\qquad\n\\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t)=\\frac{1}{\\eta}\\,\\hat{\\mathbf{k}}\\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t).\n$$\n\nStarting from Maxwell’s equations and the field equivalence principle, derive the equivalent surface electric and magnetic current densities on the TFSF interface required to produce the total field inside and only the scattered field outside. Then, for each of the $6$ faces, write the correction expressions to be applied on that face in terms of $\\mathbf{E}^{\\mathrm{inc}}$ and $\\mathbf{H}^{\\mathrm{inc}}$ evaluated on the face. Adopt the convention that the equivalent surface currents on a face with outward normal $\\hat{\\mathbf{n}}$ are\n$$\n\\mathbf{J}_{s}(\\mathbf{r},t)=\\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t), \\qquad\n\\mathbf{M}_{s}(\\mathbf{r},t)=-\\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t).\n$$\nFor the six axis-aligned faces, let $\\hat{\\mathbf{a}}_{x}=\\hat{\\mathbf{x}}$, $\\hat{\\mathbf{a}}_{y}=\\hat{\\mathbf{y}}$, and $\\hat{\\mathbf{a}}_{z}=\\hat{\\mathbf{z}}$. Define the sign $s_{i}\\in\\{-1,+1\\}$ for face $i$ by $\\hat{\\mathbf{n}}_{i}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}$, where $\\alpha(i)\\in\\{x,y,z\\}$ selects the axis normal to face $i$ and $s_{i}=-1$ for the $x_{\\min}$, $y_{\\min}$, $z_{\\min}$ faces and $s_{i}=+1$ for the $x_{\\max}$, $y_{\\max}$, $z_{\\max}$ faces. Express each face’s corrections in the form\n$$\n\\mathbf{J}_{s}^{(i)}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{H}^{\\mathrm{inc}}, \\qquad\n\\mathbf{M}_{s}^{(i)}=-s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{E}^{\\mathrm{inc}}.\n$$\n\nFinally, compute the $12$-entry sign pattern for the pair $\\left(s_{J}^{(i)},s_{M}^{(i)}\\right)$ on the ordered list of faces $\\left[x_{\\min},x_{\\max},y_{\\min},y_{\\max},z_{\\min},z_{\\max}\\right]$, where $s_{J}^{(i)}$ and $s_{M}^{(i)}$ are defined by\n$$\n\\mathbf{J}_{s}^{(i)}=s_{J}^{(i)}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{H}^{\\mathrm{inc}}, \\qquad\n\\mathbf{M}_{s}^{(i)}=s_{M}^{(i)}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{E}^{\\mathrm{inc}}.\n$$\nReport the final sign pattern as a single $1\\times 12$ row matrix in the order $\\left[s_{J}^{(x_{\\min})},s_{M}^{(x_{\\min})},s_{J}^{(x_{\\max})},s_{M}^{(x_{\\max})},s_{J}^{(y_{\\min})},s_{M}^{(y_{\\min})},s_{J}^{(y_{\\max})},s_{M}^{(y_{\\max})},s_{J}^{(z_{\\min})},s_{M}^{(z_{\\min})},s_{J}^{(z_{\\max})},s_{M}^{(z_{\\max})}\\right]$. No numerical rounding is required. Do not include units in the final answer.", "solution": "The problem statement has been meticulously validated and is determined to be a well-posed, scientifically sound, and internally consistent problem in computational electromagnetics. It requires the application of the field equivalence principle to the Total-Field/Scattered-Field (TFSF) method in the context of the Finite-Difference Time-Domain (FDTD) algorithm.\n\nThe TFSF formulation divides the computational domain into two regions separated by a closed boundary, $\\mathcal{S}$. Inside $\\mathcal{S}$ is the total-field region, where the fields are the sum of incident and scattered components: $\\mathbf{E}^{\\mathrm{tot}} = \\mathbf{E}^{\\mathrm{inc}} + \\mathbf{E}^{\\mathrm{scat}}$ and $\\mathbf{H}^{\\mathrm{tot}} = \\mathbf{H}^{\\mathrm{inc}} + \\mathbf{H}^{\\mathrm{scat}}$. Outside $\\mathcal{S}$ is the scattered-field region, where only the scattered fields $(\\mathbf{E}^{\\mathrm{scat}}, \\mathbf{H}^{\\mathrm{scat}})$ are computed.\n\nThis partitioning is achieved by introducing equivalent surface currents on $\\mathcal{S}$ that act as sources. These sources are designed to produce the incident field $(\\mathbf{E}^{\\mathrm{inc}}, \\mathbf{H}^{\\mathrm{inc}})$ inside the total-field region and a null field outside. When these generated fields are superimposed onto the scattered-field simulation (which, by linearity, extends over the entire domain), the result is the total field inside $\\mathcal{S}$ and the scattered field outside, as desired.\n\nAccording to the field equivalence principle, the surface electric current density $\\mathbf{J}_s$ and magnetic current density $\\mathbf{M}_s$ on a closed surface $\\mathcal{S}$ that generate a field $(\\mathbf{E}, \\mathbf{H})$ inside $\\mathcal{S}$ and zero field outside are given by:\n$$\n\\mathbf{J}_{s}(\\mathbf{r},t) = \\hat{\\mathbf{n}} \\times \\mathbf{H}(\\mathbf{r},t)\n$$\n$$\n\\mathbf{M}_{s}(\\mathbf{r},t) = -\\hat{\\mathbf{n}} \\times \\mathbf{E}(\\mathbf{r},t)\n$$\nwhere $\\hat{\\mathbf{n}}$ is the unit normal vector pointing outward from the volume enclosed by $\\mathcal{S}$. In our case, the fields to be generated are the incident fields $(\\mathbf{E}^{\\mathrm{inc}}, \\mathbf{H}^{\\mathrm{inc}})$, and the volume is the total-field region. The problem statement provides these exact definitions, which we adopt for our derivation.\n\nThe problem asks for a sign pattern for correction terms related to these currents on the six faces of a cubic TFSF boundary. Let face $i$ be one of the six faces. The outward unit normal for this face is denoted by $\\hat{\\mathbf{n}}_i$. The problem defines the relationship $\\hat{\\mathbf{n}}_{i}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}$, where $\\hat{\\mathbf{a}}_{\\alpha(i)}$ is the Cartesian unit vector along the axis normal to the face ($\\hat{\\mathbf{x}}$, $\\hat{\\mathbf{y}}$, or $\\hat{\\mathbf{z}}$), and $s_i$ is a sign. For faces at the minimum coordinates ($x_{\\min}$, $y_{\\min}$, $z_{\\min}$), the outward normal points in the negative axis direction, so $s_i = -1$. For faces at the maximum coordinates ($x_{\\max}$, $y_{\\max}$, $z_{\\max}$), the outward normal points in the positive axis direction, so $s_i = +1$.\n\nOur task is to determine the signs $s_J^{(i)}$ and $s_M^{(i)}$ by comparing the fundamental definitions of the currents with the target forms given in the problem.\n\nFirst, let's analyze the electric surface current, $\\mathbf{J}_s^{(i)}$.\nThe fundamental definition applied to face $i$ is:\n$$\n\\mathbf{J}_{s}^{(i)} = \\hat{\\mathbf{n}}_i \\times \\mathbf{H}^{\\mathrm{inc}}\n$$\nSubstituting $\\hat{\\mathbf{n}}_i = s_i \\hat{\\mathbf{a}}_{\\alpha(i)}$:\n$$\n\\mathbf{J}_{s}^{(i)} = (s_i \\hat{\\mathbf{a}}_{\\alpha(i)}) \\times \\mathbf{H}^{\\mathrm{inc}} = s_i (\\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{H}^{\\mathrm{inc}})\n$$\nThe problem specifies the target form:\n$$\n\\mathbf{J}_{s}^{(i)} = s_{J}^{(i)} \\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{H}^{\\mathrm{inc}}\n$$\nBy direct comparison of these two expressions, we deduce that:\n$$\ns_{J}^{(i)} = s_i\n$$\n\nNext, we analyze the magnetic surface current, $\\mathbf{M}_s^{(i)}$.\nThe fundamental definition applied to face $i$ is:\n$$\n\\mathbf{M}_{s}^{(i)} = -\\hat{\\mathbf{n}}_i \\times \\mathbf{E}^{\\mathrm{inc}}\n$$\nSubstituting $\\hat{\\mathbf{n}}_i = s_i \\hat{\\mathbf{a}}_{\\alpha(i)}$:\n$$\n\\mathbf{M}_{s}^{(i)} = -(s_i \\hat{\\mathbf{a}}_{\\alpha(i)}) \\times \\mathbf{E}^{\\mathrm{inc}} = -s_i (\\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{E}^{\\mathrm{inc}})\n$$\nThe problem specifies the target form:\n$$\n\\mathbf{M}_{s}^{(i)} = s_{M}^{(i)} \\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{E}^{\\mathrm{inc}}\n$$\nBy comparing these two expressions, we deduce that:\n$$\ns_{M}^{(i)} = -s_i\n$$\n\nWe now have the general relationship for the sign pair on any face $i$: $(s_{J}^{(i)}, s_{M}^{(i)}) = (s_i, -s_i)$. We can now apply this to each of the six faces in the specified order.\n\n1.  Face $x_{\\min}$: The normal is $\\hat{\\mathbf{n}}_{x_{\\min}} = -\\hat{\\mathbf{x}}$. Thus, $\\alpha(i)=x$ and $s_{x_{\\min}} = -1$.\n    The sign pair is $(s_{J}^{(x_{\\min})}, s_{M}^{(x_{\\min})}) = (s_{x_{\\min}}, -s_{x_{\\min}}) = (-1, -(-1)) = (-1, 1)$.\n\n2.  Face $x_{\\max}$: The normal is $\\hat{\\mathbf{n}}_{x_{\\max}} = +\\hat{\\mathbf{x}}$. Thus, $\\alpha(i)=x$ and $s_{x_{\\max}} = +1$.\n    The sign pair is $(s_{J}^{(x_{\\max})}, s_{M}^{(x_{\\max})}) = (s_{x_{\\max}}, -s_{x_{\\max}}) = (1, -1)$.\n\n3.  Face $y_{\\min}$: The normal is $\\hat{\\mathbf{n}}_{y_{\\min}} = -\\hat{\\mathbf{y}}$. Thus, $\\alpha(i)=y$ and $s_{y_{\\min}} = -1$.\n    The sign pair is $(s_{J}^{(y_{\\min})}, s_{M}^{(y_{\\min})}) = (s_{y_{\\min}}, -s_{y_{\\min}}) = (-1, -(-1)) = (-1, 1)$.\n\n4.  Face $y_{\\max}$: The normal is $\\hat{\\mathbf{n}}_{y_{\\max}} = +\\hat{\\mathbf{y}}$. Thus, $\\alpha(i)=y$ and $s_{y_{\\max}} = +1$.\n    The sign pair is $(s_{J}^{(y_{\\max})}, s_{M}^{(y_{\\max})}) = (s_{y_{\\max}}, -s_{y_{\\max}}) = (1, -1)$.\n\n5.  Face $z_{\\min}$: The normal is $\\hat{\\mathbf{n}}_{z_{\\min}} = -\\hat{\\mathbf{z}}$. Thus, $\\alpha(i)=z$ and $s_{z_{\\min}} = -1$.\n    The sign pair is $(s_{J}^{(z_{\\min})}, s_{M}^{(z_{\\min})}) = (s_{z_{\\min}}, -s_{z_{\\min}}) = (-1, -(-1)) = (-1, 1)$.\n\n6.  Face $z_{\\max}$: The normal is $\\hat{\\mathbf{n}}_{z_{\\max}} = +\\hat{\\mathbf{z}}$. Thus, $\\alpha(i)=z$ and $s_{z_{\\max}} = +1$.\n    The sign pair is $(s_{J}^{(z_{\\max})}, s_{M}^{(z_{\\max})}) = (s_{z_{\\max}}, -s_{z_{\\max}}) = (1, -1)$.\n\nFinally, we assemble the $12$-entry sign pattern by concatenating these pairs in the specified order:\n$\\left[s_{J}^{(x_{\\min})},s_{M}^{(x_{\\min})},s_{J}^{(x_{\\max})},s_{M}^{(x_{\\max})},s_{J}^{(y_{\\min})},s_{M}^{(y_{\\min})},s_{J}^{(y_{\\max})},s_{M}^{(y_{\\max})},s_{J}^{(z_{\\min})},s_{M}^{(z_{\\min})},s_{J}^{(z_{\\max})},s_{M}^{(z_{\\max})}\\right]$\nSubstituting the values we computed:\n$\\left[-1, 1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1\\right]$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1 & 1 & 1 & -1 & -1 & 1 & 1 & -1 & -1 & 1 & 1 & -1\n\\end{pmatrix}\n}\n$$", "id": "3318213"}, {"introduction": "After establishing the theoretical framework, the next step is to implement it on a discrete grid. The Finite-Difference Time-Domain (FDTD) method uses the Yee lattice, where electric and magnetic field components are staggered in both space and time. This exercise [@problem_id:3318287] provides essential hands-on practice in calculating the phase of an incident plane wave at the precise, offset locations required for the TFSF correction terms. This calculation is a fundamental building block for writing an accurate TFSF update routine in any FDTD code.", "problem": "A three-dimensional Finite-Difference Time-Domain (FDTD) simulation employs a Total-Field/Scattered-Field (TFSF) boundary to inject a monochromatic plane wave into a homogeneous, isotropic, source-free, non-dispersive medium (free space). The TFSF boundary separates the total-field region from the scattered-field region and requires correction terms on its faces to ensure that only the incident plane wave exists in the total-field domain while only the scattered field exists in the scattered-field domain. The plane wave is characterized by its wave vector $\\mathbf{k}$, polarization unit vector $\\hat{p}$, and angular frequency $\\omega$. The discretization uses the staggered Yee lattice for the electromagnetic field components and leapfrog time stepping.\n\nThe physical setting is free space with speed of light $c$, permittivity $\\epsilon_{0}$, and permeability $\\mu_{0}$, obeying Maxwell's equations. The incident plane wave is a solution to these equations in the form of a transverse electromagnetic wave with electric field\n$$\\mathbf{E}_{\\mathrm{inc}}(\\mathbf{r},t)=\\Re\\left\\{E_{0}\\,\\hat{p}\\,\\exp\\!\\left(i\\big(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t\\big)\\right)\\right\\},$$\nand magnetic field\n$$\\mathbf{H}_{\\mathrm{inc}}(\\mathbf{r},t)=\\Re\\left\\{H_{0}\\,\\hat{h}\\,\\exp\\!\\left(i\\big(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t\\big)\\right)\\right\\},$$\nwhere $E_{0}$ and $H_{0}$ are real amplitudes satisfying the plane-wave relations in free space, $\\hat{h}=\\hat{k}\\times\\hat{p}/\\eta_{0}$ with $\\hat{k}=\\mathbf{k}/|\\mathbf{k}|$ and $\\eta_{0}=\\sqrt{\\mu_{0}/\\epsilon_{0}}$, and the phase of $\\mathbf{E}_{\\mathrm{inc}}$ and $\\mathbf{H}_{\\mathrm{inc}}$ is identical. The numerical grid uses spatial steps $\\Delta x$, $\\Delta y$, $\\Delta z$ and time step $\\Delta t$. On the Yee lattice, the field component sampling locations are staggered within each cell and the electric field is sampled at integer time indices $n$ while the magnetic field is sampled at half-integer time indices $n+\\tfrac{1}{2}$.\n\nConsider the $+x$ TFSF face located at the plane $x=x_{b}$ defined by the index $i=i_{b}$ in the Yee grid. The correction terms required for this face involve the incident field phase factors evaluated at the following component locations:\n- For the electric field at time index $n$: $E_{y}$ at $\\big(i_{b},\\,j+\\tfrac{1}{2},\\,k\\big)$ and $E_{z}$ at $\\big(i_{b},\\,j,\\,k+\\tfrac{1}{2}\\big)$.\n- For the magnetic field at time index $n+\\tfrac{1}{2}$: $H_{y}$ at $\\big(i_{b}-\\tfrac{1}{2},\\,j,\\,k+\\tfrac{1}{2}\\big)$ and $H_{z}$ at $\\big(i_{b}-\\tfrac{1}{2},\\,j+\\tfrac{1}{2},\\,k\\big)$.\n\nAll positions correspond to physical coordinates $\\mathbf{r}=\\big(x,\\,y,\\,z\\big)$ given by $x=i\\Delta x$, $y=j\\Delta y$, and $z=k\\Delta z$, with half-index offsets interpreted accordingly. The phase factor for the incident field at a field-sampling location $\\mathbf{r}$ and time $t$ is the complex quantity\n$$\\Phi(\\mathbf{r},t)=\\exp\\!\\left(i\\big(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t\\big)\\right).$$\n\nGiven the following parameters:\n- Free-space speed of light $c=3.0\\times 10^{8}\\,\\mathrm{m/s}$.\n- Frequency $f=3.0\\times 10^{9}\\,\\mathrm{Hz}$ and angular frequency $\\omega=2\\pi f$.\n- Wavelength $\\lambda=c/f$, and uniform spatial step sizes $\\Delta x=\\Delta y=\\Delta z=\\lambda/10$.\n- Time step $\\Delta t=\\Delta x/(c\\sqrt{3})=1/(10 f\\sqrt{3})$, consistent with the Courant–Friedrichs–Lewy stability limit in three dimensions.\n- Wave vector $\\mathbf{k}=k_{0}\\,\\hat{k}$ with $k_{0}=\\omega/c$, and propagation direction unit vector $\\hat{k}=\\frac{1}{\\sqrt{3}}\\big(1,\\,1,\\,1\\big)$.\n- Polarization unit vector $\\hat{p}=\\frac{1}{\\sqrt{2}}\\big(1,\\,-1,\\,0\\big)$.\n- TFSF face index and correction indices: $i_{b}=12$, $j=5$, $k=8$.\n- Time index $n=30$.\n\nUsing the Yee lattice sampling conventions described above and the given parameters, compute the four complex phase factors for the incident fields at the correction nodes on the $+x$ TFSF face:\n$$\\Phi_{E_{y}}=\\Phi\\!\\left(\\mathbf{r}_{E_{y}},\\,t_{E}\\right),\\quad \\Phi_{E_{z}}=\\Phi\\!\\left(\\mathbf{r}_{E_{z}},\\,t_{E}\\right),\\quad \\Phi_{H_{y}}=\\Phi\\!\\left(\\mathbf{r}_{H_{y}},\\,t_{H}\\right),\\quad \\Phi_{H_{z}}=\\Phi\\!\\left(\\mathbf{r}_{H_{z}},\\,t_{H}\\right),$$\nwhere $\\mathbf{r}_{E_{y}}=\\big(i_{b}\\Delta x,\\,(j+\\tfrac{1}{2})\\Delta y,\\,k\\Delta z\\big)$, $\\mathbf{r}_{E_{z}}=\\big(i_{b}\\Delta x,\\,j\\Delta y,\\,(k+\\tfrac{1}{2})\\Delta z\\big)$, $\\mathbf{r}_{H_{y}}=\\big((i_{b}-\\tfrac{1}{2})\\Delta x,\\,j\\Delta y,\\,(k+\\tfrac{1}{2})\\Delta z\\big)$, $\\mathbf{r}_{H_{z}}=\\big((i_{b}-\\tfrac{1}{2})\\Delta x,\\,(j+\\tfrac{1}{2})\\Delta y,\\,k\\Delta z\\big)$, and $t_{E}=n\\Delta t$, $t_{H}=(n+\\tfrac{1}{2})\\Delta t$.\n\nExpress your final answer as exact analytic expressions in radian measure, without numerical rounding, and present the four phase factors in a single row matrix using the prescribed format.", "solution": "The problem requires the computation of four complex phase factors, $\\Phi_{E_{y}}$, $\\Phi_{E_{z}}$, $\\Phi_{H_{y}}$, and $\\Phi_{H_{z}}$, for an incident plane wave at specific locations and times on a Yee lattice. These factors are essential for the implementation of the Total-Field/Scattered-Field (TFSF) boundary condition in a Finite-Difference Time-Domain (FDTD) simulation.\n\nThe complex phase factor is defined as $\\Phi(\\mathbf{r},t)=\\exp\\!\\left(i\\big(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t\\big)\\right)$. The argument of the exponential, $\\phi(\\mathbf{r},t) = \\mathbf{k}\\cdot\\mathbf{r}-\\omega t$, is the phase of the wave. Our primary task is to evaluate this phase for each of the four specified field components.\n\nFirst, let's establish the key numerical parameters based on the given information.\nThe frequency is $f=3.0\\times 10^{9}\\,\\mathrm{Hz}$.\nThe angular frequency is $\\omega=2\\pi f$.\nThe speed of light is $c=3.0\\times 10^{8}\\,\\mathrm{m/s}$.\nThe wavelength is $\\lambda=c/f$.\nThe spatial discretization steps are uniform: $\\Delta x=\\Delta y=\\Delta z=\\frac{\\lambda}{10} = \\frac{c}{10f}$.\nThe time step is $\\Delta t=\\frac{\\Delta x}{c\\sqrt{3}} = \\frac{c/(10f)}{c\\sqrt{3}} = \\frac{1}{10f\\sqrt{3}}$.\n\nThe wave vector is $\\mathbf{k} = k_0 \\hat{k}$, where the wave number is $k_0 = \\frac{\\omega}{c} = \\frac{2\\pi f}{c} = \\frac{2\\pi}{\\lambda}$.\nThe direction of propagation is $\\hat{k}=\\frac{1}{\\sqrt{3}}\\big(1,\\,1,\\,1\\big)$.\nThus, the components of the wave vector are $k_x = k_y = k_z = k_0 \\frac{1}{\\sqrt{3}} = \\frac{2\\pi}{\\lambda\\sqrt{3}}$.\n\nWe can now find the numerical phase shifts per grid step and per time step.\nThe phase shift per spatial step in each direction is:\n$$k_x \\Delta x = k_y \\Delta y = k_z \\Delta z = \\left(\\frac{2\\pi}{\\lambda\\sqrt{3}}\\right)\\left(\\frac{\\lambda}{10}\\right) = \\frac{2\\pi}{10\\sqrt{3}} = \\frac{\\pi}{5\\sqrt{3}}$$\nThe phase shift per time step is:\n$$\\omega \\Delta t = (2\\pi f)\\left(\\frac{1}{10f\\sqrt{3}}\\right) = \\frac{2\\pi}{10\\sqrt{3}} = \\frac{\\pi}{5\\sqrt{3}}$$\nNotably, these values are identical. Let's denote this common phase increment by $\\alpha$:\n$$\\alpha = \\frac{\\pi}{5\\sqrt{3}}$$\nRationalizing the denominator gives $\\alpha = \\frac{\\pi\\sqrt{3}}{15}$. However, we will proceed with the first form.\n\nThe phase at a general grid point $(i\\Delta x, j\\Delta y, k\\Delta z)$ at time $n\\Delta t$ can be expressed as:\n$\\phi = k_x(i\\Delta x) + k_y(j\\Delta y) + k_z(k\\Delta z) - \\omega(n\\Delta t) = i(k_x\\Delta x) + j(k_y\\Delta y) + k(k_z\\Delta z) - n(\\omega\\Delta t) = \\alpha(i+j+k-n)$.\nWe will use this simplified structure, accounting for the half-step offsets in space and time for each component. The given indices are $i_b=12$, $j=5$, $k=8$, and $n=30$.\n\n1.  **Phase factor for $E_y$ component ($\\Phi_{E_{y}}$):**\n    The $E_y$ component is located at $\\mathbf{r}_{E_{y}}=\\big(i_{b}\\Delta x,\\,(j+\\tfrac{1}{2})\\Delta y,\\,k\\Delta z\\big)$ and sampled at time $t_{E}=n\\Delta t$.\n    The phase is:\n    $$\\phi_{E_{y}} = \\mathbf{k}\\cdot\\mathbf{r}_{E_{y}} - \\omega t_{E} = k_x(i_b\\Delta x) + k_y\\left(\\left(j+\\tfrac{1}{2}\\right)\\Delta y\\right) + k_z(k\\Delta z) - \\omega(n\\Delta t)$$\n    $$\\phi_{E_{y}} = i_b(k_x\\Delta x) + \\left(j+\\tfrac{1}{2}\\right)(k_y\\Delta y) + k(k_z\\Delta z) - n(\\omega\\Delta t)$$\n    $$\\phi_{E_{y}} = \\alpha\\left(i_b + j + \\tfrac{1}{2} + k - n\\right)$$\n    Substituting the given index values:\n    $$\\phi_{E_{y}} = \\alpha\\left(12 + 5 + \\tfrac{1}{2} + 8 - 30\\right) = \\alpha\\left(25 + \\tfrac{1}{2} - 30\\right) = \\alpha\\left(-5 + \\tfrac{1}{2}\\right) = -\\frac{9}{2}\\alpha$$\n    $$\\phi_{E_{y}} = -\\frac{9}{2} \\left(\\frac{\\pi}{5\\sqrt{3}}\\right) = -\\frac{9\\pi}{10\\sqrt{3}} = -\\frac{9\\pi\\sqrt{3}}{30} = -\\frac{3\\pi\\sqrt{3}}{10}$$\n    So, the phase factor is $\\Phi_{E_{y}} = \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)$.\n\n2.  **Phase factor for $E_z$ component ($\\Phi_{E_{z}}$):**\n    The $E_z$ component is at $\\mathbf{r}_{E_{z}}=\\big(i_{b}\\Delta x,\\,j\\Delta y,\\,(k+\\tfrac{1}{2})\\Delta z\\big)$ and sampled at time $t_{E}=n\\Delta t$.\n    The phase is:\n    $$\\phi_{E_{z}} = \\mathbf{k}\\cdot\\mathbf{r}_{E_{z}} - \\omega t_{E} = k_x(i_b\\Delta x) + k_y(j\\Delta y) + k_z\\left(\\left(k+\\tfrac{1}{2}\\right)\\Delta z\\right) - \\omega(n\\Delta t)$$\n    $$\\phi_{E_{z}} = \\alpha\\left(i_b + j + k + \\tfrac{1}{2} - n\\right)$$\n    This is identical to the phase expression for $E_y$.\n    $$\\phi_{E_{z}} = \\alpha\\left(12 + 5 + 8 + \\tfrac{1}{2} - 30\\right) = -\\frac{9}{2}\\alpha = -\\frac{3\\pi\\sqrt{3}}{10}$$\n    Thus, the phase factor is also identical: $\\Phi_{E_{z}} = \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)$.\n\n3.  **Phase factor for $H_y$ component ($\\Phi_{H_{y}}$):**\n    The $H_y$ component is at $\\mathbf{r}_{H_{y}}=\\big((i_{b}-\\tfrac{1}{2})\\Delta x,\\,j\\Delta y,\\,(k+\\tfrac{1}{2})\\Delta z\\big)$ and sampled at time $t_{H}=(n+\\tfrac{1}{2})\\Delta t$.\n    The phase is:\n    $$\\phi_{H_{y}} = \\mathbf{k}\\cdot\\mathbf{r}_{H_{y}} - \\omega t_{H} = k_x\\left(\\left(i_b-\\tfrac{1}{2}\\right)\\Delta x\\right) + k_y(j\\Delta y) + k_z\\left(\\left(k+\\tfrac{1}{2}\\right)\\Delta z\\right) - \\omega\\left(\\left(n+\\tfrac{1}{2}\\right)\\Delta t\\right)$$\n    $$\\phi_{H_{y}} = \\alpha\\left(\\left(i_b-\\tfrac{1}{2}\\right) + j + \\left(k+\\tfrac{1}{2}\\right) - \\left(n+\\tfrac{1}{2}\\right)\\right)$$\n    $$\\phi_{H_{y}} = \\alpha\\left(i_b + j + k - n - \\tfrac{1}{2}\\right)$$\n    Substituting the index values:\n    $$\\phi_{H_{y}} = \\alpha\\left(12 + 5 + 8 - 30 - \\tfrac{1}{2}\\right) = \\alpha\\left(25 - 30 - \\tfrac{1}{2}\\right) = \\alpha\\left(-5 - \\tfrac{1}{2}\\right) = -\\frac{11}{2}\\alpha$$\n    $$\\phi_{H_{y}} = -\\frac{11}{2}\\left(\\frac{\\pi}{5\\sqrt{3}}\\right) = -\\frac{11\\pi}{10\\sqrt{3}} = -\\frac{11\\pi\\sqrt{3}}{30}$$\n    The corresponding phase factor is $\\Phi_{H_{y}} = \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)$.\n\n4.  **Phase factor for $H_z$ component ($\\Phi_{H_{z}}$):**\n    The $H_z$ component is at $\\mathbf{r}_{H_{z}}=\\big((i_{b}-\\tfrac{1}{2})\\Delta x,\\,(j+\\tfrac{1}{2})\\Delta y,\\,k\\Delta z\\big)$ and sampled at time $t_{H}=(n+\\tfrac{1}{2})\\Delta t$.\n    The phase is:\n    $$\\phi_{H_{z}} = \\mathbf{k}\\cdot\\mathbf{r}_{H_{z}} - \\omega t_{H} = k_x\\left(\\left(i_b-\\tfrac{1}{2}\\right)\\Delta x\\right) + k_y\\left(\\left(j+\\tfrac{1}{2}\\right)\\Delta y\\right) + k_z(k\\Delta z) - \\omega\\left(\\left(n+\\tfrac{1}{2}\\right)\\Delta t\\right)$$\n    $$\\phi_{H_{z}} = \\alpha\\left(\\left(i_b-\\tfrac{1}{2}\\right) + \\left(j+\\tfrac{1}{2}\\right) + k - \\left(n+\\tfrac{1}{2}\\right)\\right)$$\n    $$\\phi_{H_{z}} = \\alpha\\left(i_b + j + k - n - \\tfrac{1}{2}\\right)$$\n    This expression is identical to the phase for $H_y$.\n    $$\\phi_{H_{z}} = \\alpha\\left(12 + 5 + 8 - 30 - \\tfrac{1}{2}\\right) = -\\frac{11}{2}\\alpha = -\\frac{11\\pi\\sqrt{3}}{30}$$\n    Therefore, the phase factor is $\\Phi_{H_{z}} = \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)$.\n\nThe four required complex phase factors are:\n$\\Phi_{E_{y}} = \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)$\n$\\Phi_{E_{z}} = \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)$\n$\\Phi_{H_{y}} = \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)$\n$\\Phi_{H_{z}} = \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)$\n\nThese results are to be presented in a single row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right) & \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right) & \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right) & \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right) \\end{pmatrix}\n}\n$$", "id": "3318287"}, {"introduction": "Numerical accuracy is paramount in computational modeling, and implementing a TFSF boundary is no exception. A common practical issue arises because the incident waveform is typically known at discrete integer time steps, while the FDTD algorithm requires its value at staggered half-time steps and delayed by propagation. This exercise [@problem_id:3318288] guides you through the derivation of a higher-order interpolation scheme to bridge this temporal gap, and more importantly, to analyze its error. Understanding this process is key to minimizing numerical dispersion and maintaining the fidelity of your simulation.", "problem": "Consider a one-dimensional plane wave injected into a Finite-Difference Time-Domain (FDTD) grid through a Total-Field/Scattered-Field (TFSF) boundary (Total-Field/Scattered-Field (TFSF), Finite-Difference Time-Domain (FDTD)). The medium in the total-field region is homogeneous with wave impedance $\\,\\eta\\,=\\,\\sqrt{\\mu/\\varepsilon}\\,$ and wave speed $\\,c\\,=\\,1/\\sqrt{\\mu\\varepsilon}\\,$ where $\\,\\mu\\,$ and $\\,\\varepsilon\\,$ are the permeability and permittivity, respectively. The incident field is a right-going plane wave with electric field $\\,E^{\\text{inc}}(x,t)=s(t-x/c)\\,$ and magnetic field $\\,H^{\\text{inc}}(x,t)=s(t-x/c)/\\eta\\,$ for a smooth waveform $\\,s(t)\\,$. An auxiliary one-dimensional source provides uniform samples $\\,s^{n}=s(n\\Delta t)\\,$ at time steps $\\,t^{n}=n\\Delta t\\,$, where $\\,\\Delta t>0\\,$ is fixed.\n\nLet the TFSF boundary be located at a position $\\,x_{b}\\,$ from the auxiliary source plane, and define the retarded time $\\,\\tau=x_{b}/c\\,$. Write $\\,\\tau/\\Delta t = m + \\theta\\,$ with $\\,m\\in\\mathbb{Z}_{\\ge 0}\\,$ and $\\,\\theta\\in[0,1)\\,$. At FDTD time step $\\,n\\,$, the TFSF correction requires $\\,H^{\\text{inc}}(x_{b},t^{n+1/2})=s\\!\\big((n+\\tfrac{1}{2})\\Delta t-\\tau\\big)/\\eta\\,$ and $\\,E^{\\text{inc}}(x_{b},t^{n+1})=s\\!\\big((n+1)\\Delta t-\\tau\\big)\\,$.\n\nStarting from first principles of polynomial interpolation and Taylor’s theorem with remainder, do the following:\n\n1. Derive a quadratic Lagrange interpolation scheme to approximate $\\,s\\!\\big((n+\\alpha)\\Delta t-\\tau\\big)\\,$ for a generic offset $\\,\\alpha\\in\\{\\tfrac{1}{2},\\,1\\}\\,$ using the three neighboring uniform samples $\\,\\{s^{n-m-1},\\,s^{n-m},\\,s^{n-m+1}\\}\\,$ and express the approximation explicitly in terms of $\\,\\theta\\,$. Then specialize it to obtain formulas for $\\,H^{\\text{inc}}(x_{b},t^{n+1/2})\\,$ and $\\,E^{\\text{inc}}(x_{b},t^{n+1})\\,$.\n\n2. Using the exact Lagrange remainder, analyze the local interpolation error for $\\,H^{\\text{inc}}(x_{b},t^{n+1/2})\\,$ and show that it is $\\,\\mathcal{O}(\\Delta t^{3})\\,$. Express the leading-order error in the form\n$$\n\\big|H^{\\text{inc}}(x_{b},t^{n+1/2}) - H^{\\text{interp}}(x_{b},t^{n+1/2})\\big|\\;\\le\\;\\frac{C}{\\eta}\\,\\Delta t^{3}\\,\\sup_{t\\in I}\\big|s^{(3)}(t)\\big|,\n$$\nfor an appropriate interpolation interval $\\,I\\,$ that you must identify and justify.\n\n3. Determine the smallest constant $\\,C\\,$ (independent of $\\,\\Delta t\\,$, $\\,n\\,$, and the waveform $\\,s\\,$, but possibly dependent on the fractional delay $\\,\\theta\\in[0,1)\\,$ through the worst case over $\\,\\theta\\,$) such that the above inequality holds for all $\\,\\theta\\in[0,1)\\,$. Report this sharp worst-case constant $\\,C\\,$ as a single exact real number.\n\nProvide your final answer as the value of $\\,C\\,$. No units are required, and no rounding is needed. Your derivation must proceed from fundamental definitions of polynomial interpolation and the Lagrange remainder; do not assume or quote pre-derived interpolation coefficients.", "solution": "The problem is valid as it is scientifically grounded in computational electromagnetics and numerical analysis, is well-posed, objective, and self-contained. We proceed with the solution.\n\nThe task is to derive a quadratic interpolation scheme for a time-dependent signal, analyze its error, and find the worst-case error constant. The foundation of this analysis is Lagrange polynomial interpolation. For a function $s(t)$ sampled at three distinct times $t_0, t_1, t_2$, the unique quadratic polynomial $P_2(t)$ that passes through the points $(t_0, s(t_0)), (t_1, s(t_1)), (t_2, s(t_2))$ is given by\n$$\nP_2(t) = s(t_0) L_0(t) + s(t_1) L_1(t) + s(t_2) L_2(t),\n$$\nwhere $L_i(t)$ are the Lagrange basis polynomials.\n\nTo simplify the algebra, we define a normalized, dimensionless time coordinate $u$. The interpolation is based on the grid samples $s^{n-m-1}, s^{n-m}, s^{n-m+1}$, which are values of $s(t)$ at times $t_{n-m-1} = (n-m-1)\\Delta t$, $t_{n-m} = (n-m)\\Delta t$, and $t_{n-m+1} = (n-m+1)\\Delta t$. Let us define the relative time origin at $t_{n-m} = (n-m)\\Delta t$ and normalize by $\\Delta t$:\n$$\nu = \\frac{t - (n-m)\\Delta t}{\\Delta t}\n$$\nIn this coordinate system, the interpolation nodes are $u_{-1} = -1$, $u_0 = 0$, and $u_1 = 1$. The corresponding function values are $s((n-m-1)\\Delta t) = s^{n-m-1}$, $s((n-m)\\Delta t) = s^{n-m}$, and $s((n-m+1)\\Delta t) = s^{n-m+1}$.\n\nThe Lagrange basis polynomials for the nodes $\\{-1, 0, 1\\}$ are:\n$$\nL_{-1}(u) = \\frac{(u-0)(u-1)}{(-1-0)(-1-1)} = \\frac{u(u-1)}{2}\n$$\n$$\nL_0(u) = \\frac{(u-(-1))(u-1)}{(0-(-1))(0-1)} = \\frac{(u+1)(u-1)}{-1} = 1-u^2\n$$\n$$\nL_1(u) = \\frac{(u-(-1))(u-0)}{(1-(-1))(1-0)} = \\frac{u(u+1)}{2}\n$$\nThe interpolating polynomial for $s$ in terms of $u$ is then:\n$$\nP(u) = s^{n-m-1} \\frac{u(u-1)}{2} + s^{n-m} (1-u^2) + s^{n-m+1} \\frac{u(u+1)}{2}\n$$\n\n**1. Derivation of the Interpolation Scheme**\n\nWe need to approximate $s\\big((n+\\alpha)\\Delta t-\\tau\\big)$. First, we find the target evaluation point in the $u$ coordinate. The target time is $t_{\\text{target}} = (n+\\alpha)\\Delta t - \\tau$. We are given $\\tau = (m+\\theta)\\Delta t$.\n$$\nt_{\\text{target}} = (n+\\alpha)\\Delta t - (m+\\theta)\\Delta t = (n-m+\\alpha-\\theta)\\Delta t\n$$\nIn the $u$ coordinate, this corresponds to:\n$$\nu_{\\text{target}} = \\frac{t_{\\text{target}} - (n-m)\\Delta t}{\\Delta t} = \\frac{(n-m+\\alpha-\\theta)\\Delta t - (n-m)\\Delta t}{\\Delta t} = \\alpha-\\theta\n$$\nThe interpolated value, which approximates $s(t_{\\text{target}})$, is $P(\\alpha-\\theta)$.\n$$\ns_{\\text{interp}} = s^{n-m-1} \\frac{(\\alpha-\\theta)(\\alpha-\\theta-1)}{2} + s^{n-m} \\big(1-(\\alpha-\\theta)^2\\big) + s^{n-m+1} \\frac{(\\alpha-\\theta)(\\alpha-\\theta+1)}{2}\n$$\nThis is the general quadratic interpolation formula. We now specialize it for the two required cases.\n\nCase (a): $H^{\\text{inc}}(x_{b},t^{n+1/2})$ requires approximation of $s\\big((n+\\tfrac{1}{2})\\Delta t-\\tau\\big)$. Here, $\\alpha=\\frac{1}{2}$. The evaluation point is $u=\\frac{1}{2}-\\theta$.\nThe interpolated value for the magnetic field is $H^{\\text{interp}}(x_b, t^{n+1/2}) = s_{\\text{interp}}/\\eta$.\n$$\nH^{\\text{interp}}(x_{b},t^{n+1/2}) = \\frac{1}{\\eta} \\left[ s^{n-m-1} \\frac{(\\frac{1}{2}-\\theta)(\\frac{1}{2}-\\theta-1)}{2} + s^{n-m} \\left(1-\\left(\\frac{1}{2}-\\theta\\right)^2\\right) + s^{n-m+1} \\frac{(\\frac{1}{2}-\\theta)(\\frac{1}{2}-\\theta+1)}{2} \\right]\n$$\nSimplifying the coefficients:\n$$\nH^{\\text{interp}}(x_{b},t^{n+1/2}) = \\frac{1}{\\eta} \\left[ s^{n-m-1} \\frac{\\theta^2-\\frac{1}{4}}{2} + s^{n-m} \\left(\\frac{3}{4}+\\theta-\\theta^2\\right) + s^{n-m+1} \\frac{\\theta^2-2\\theta+\\frac{3}{4}}{2} \\right]\n$$\n\nCase (b): $E^{\\text{inc}}(x_{b},t^{n+1})$ requires approximation of $s\\big((n+1)\\Delta t-\\tau\\big)$. Here, $\\alpha=1$. The evaluation point is $u=1-\\theta$.\nThe interpolated value for the electric field is $E^{\\text{interp}}(x_b, t^{n+1}) = s_{\\text{interp}}$.\n$$\nE^{\\text{interp}}(x_{b}, t^{n+1}) = s^{n-m-1} \\frac{(1-\\theta)(1-\\theta-1)}{2} + s^{n-m} \\left(1-(1-\\theta)^2\\right) + s^{n-m+1} \\frac{(1-\\theta)(1-\\theta+1)}{2}\n$$\nSimplifying the coefficients:\n$$\nE^{\\text{interp}}(x_{b}, t^{n+1}) = s^{n-m-1} \\frac{\\theta(\\theta-1)}{2} + s^{n-m} (2\\theta-\\theta^2) + s^{n-m+1} \\frac{(1-\\theta)(2-\\theta)}{2}\n$$\n\n**2. Error Analysis**\n\nThe error for Lagrange interpolation of a function $s(t)$ at a point $t$ using three nodes $t_0, t_1, t_2$ is given by the remainder theorem:\n$$\ns(t) - P_2(t) = \\frac{s^{(3)}(\\xi)}{3!} (t-t_0)(t-t_1)(t-t_2)\n$$\nfor some $\\xi$ in the interval containing $t_0, t_1, t_2$ and $t$.\n\nFor the interpolation of $H^{\\text{inc}}$, the function is $s(t)$, the nodes are $t_{n-m-1}, t_{n-m}, t_{n-m+1}$, and the evaluation point is $t_{\\text{target}} = (n - m + \\frac{1}{2} - \\theta)\\Delta t$. Since $\\theta \\in [0,1)$, we have $-\\frac{1}{2} < \\frac{1}{2}-\\theta \\le \\frac{1}{2}$. Thus, the evaluation point $t_{\\text{target}}$ lies between $(n-m-\\frac{1}{2})\\Delta t$ and $(n-m+\\frac{1}{2})\\Delta t$. This range is situated between the outer interpolation nodes $t_{n-m-1}=(n-m-1)\\Delta t$ and $t_{n-m+1}=(n-m+1)\\Delta t$. Therefore, the point $\\xi$ must lie in the interval spanned by the nodes, $I = [t_{n-m-1}, t_{n-m+1}] = [(n-m-1)\\Delta t, (n-m+1)\\Delta t]$.\n\nThe error in approximating $s(t_{\\text{target}})$ is:\n$$\nE_s = s(t_{\\text{target}}) - P_2(t_{\\text{target}}) = \\frac{s^{(3)}(\\xi)}{6} (t_{\\text{target}}-t_{n-m-1})(t_{\\text{target}}-t_{n-m})(t_{\\text{target}}-t_{n-m+1})\n$$\nThe product term can be written in terms of $\\Delta t$ and $\\theta$:\n\\begin{align*}\n\\prod_{i=-1}^{1} (t_{\\text{target}} - t_{n-m+i}) &= \\left((n-m+\\tfrac{1}{2}-\\theta)\\Delta t - (n-m-1)\\Delta t\\right) \\left((n-m+\\tfrac{1}{2}-\\theta)\\Delta t - (n-m)\\Delta t\\right) \\left((n-m+\\tfrac{1}{2}-\\theta)\\Delta t - (n-m+1)\\Delta t\\right) \\\\\n&= \\Delta t^3 (\\tfrac{3}{2}-\\theta)(\\tfrac{1}{2}-\\theta)(-\\tfrac{1}{2}-\\theta)\n\\end{align*}\nThe error in the magnetic field is $E_H = E_s/\\eta$. Taking the absolute value, we get:\n$$\n|H^{\\text{inc}}(x_{b},t^{n+1/2}) - H^{\\text{interp}}(x_{b},t^{n+1/2})| = \\frac{|s^{(3)}(\\xi)|}{6\\eta} \\Delta t^3 |(\\tfrac{3}{2}-\\theta)(\\tfrac{1}{2}-\\theta)(-\\tfrac{1}{2}-\\theta)|\n$$\nTaking the supremum of $|s^{(3)}(\\cdot)|$ over the interval $I$:\n$$\n|H^{\\text{inc}} - H^{\\text{interp}}| \\le \\frac{\\Delta t^3}{6\\eta} \\sup_{t\\in I}\\big|s^{(3)}(t)\\big| \\cdot |(\\tfrac{3}{2}-\\theta)(\\tfrac{1}{2}-\\theta)(-\\tfrac{1}{2}-\\theta)|\n$$\nSince all terms except $\\Delta t^3$ are bounded, the error is of order $\\mathcal{O}(\\Delta t^3)$.\n\n**3. Determination of the Constant C**\n\nWe are asked to find the smallest constant $C$ such that the inequality holds for all $\\theta \\in [0,1)$:\n$$\n|H^{\\text{inc}} - H^{\\text{interp}}| \\le \\frac{C}{\\eta} \\Delta t^3 \\sup_{t\\in I}\\big|s^{(3)}(t)\\big|\n$$\nComparing with our error expression, the constant $C$ is given by:\n$$\nC = \\sup_{\\theta \\in [0,1)} \\frac{1}{6} |(\\tfrac{3}{2}-\\theta)(\\tfrac{1}{2}-\\theta)(-\\tfrac{1}{2}-\\theta)|\n$$\nLet's define the function $g(\\theta) = (\\tfrac{3}{2}-\\theta)(\\tfrac{1}{2}-\\theta)(-\\tfrac{1}{2}-\\theta) = (\\tfrac{3}{2}-\\theta)(\\theta^2-\\tfrac{1}{4})$. We need to find $\\frac{1}{6}\\sup_{\\theta \\in [0,1)}|g(\\theta)|$.\nExpanding $g(\\theta)$, we get:\n$$\ng(\\theta) = \\tfrac{3}{2}\\theta^2 - \\tfrac{3}{8} - \\theta^3 + \\tfrac{1}{4}\\theta = -\\theta^3 + \\tfrac{3}{2}\\theta^2 + \\tfrac{1}{4}\\theta - \\tfrac{3}{8}\n$$\nTo find the extrema of $g(\\theta)$, we compute its derivative with respect to $\\theta$:\n$$\ng'(\\theta) = -3\\theta^2 + 3\\theta + \\tfrac{1}{4}\n$$\nThe critical points are the roots of $g'(\\theta)=0$, which is equivalent to $12\\theta^2 - 12\\theta - 1 = 0$. Using the quadratic formula:\n$$\n\\theta = \\frac{12 \\pm \\sqrt{(-12)^2 - 4(12)(-1)}}{2(12)} = \\frac{12 \\pm \\sqrt{144+48}}{24} = \\frac{12 \\pm 8\\sqrt{3}}{24} = \\frac{3 \\pm 2\\sqrt{3}}{6}\n$$\nThe two roots are $\\theta_1 = \\frac{1}{2}-\\frac{\\sqrt{3}}{3} \\approx -0.077$ and $\\theta_2 = \\frac{1}{2}+\\frac{\\sqrt{3}}{3} \\approx 1.077$.\nNeither of these critical points lies within the interval $[0,1)$. This implies that $g(\\theta)$ is monotonic on $[0,1)$. Since $g'(0)=\\frac{1}{4}>0$, $g(\\theta)$ is strictly increasing on $[0,1)$.\n\nThe function $|g(\\theta)|$ will have its supremum at the boundaries of the domain $\\theta \\in [0,1)$. We also check any points where $g(\\theta)=0$.\nThe roots of $g(\\theta)$ are $\\theta = \\frac{3}{2}, \\frac{1}{2}, -\\frac{1}{2}$. Only $\\theta=\\frac{1}{2}$ is in the domain.\n- At $\\theta=0$: $g(0) = -\\frac{3}{8}$. So $|g(0)| = \\frac{3}{8}$.\n- At $\\theta=1/2$: $g(1/2) = 0$.\n- In the limit $\\theta \\to 1$: $g(1) = -1 + \\frac{3}{2} + \\frac{1}{4} - \\frac{3}{8} = \\frac{-8+12+2-3}{8} = \\frac{3}{8}$. So $\\lim_{\\theta \\to 1^{-}}|g(\\theta)| = \\frac{3}{8}$.\n\nThe function $|g(\\theta)|$ decreases from $\\frac{3}{8}$ at $\\theta=0$ to $0$ at $\\theta=1/2$, and then increases from $0$ back to $\\frac{3}{8}$ as $\\theta$ approaches $1$. The supremum of $|g(\\theta)|$ over $\\theta \\in [0,1)$ is therefore $\\frac{3}{8}$.\n\nFinally, we calculate the sharp worst-case constant $C$:\n$$\nC = \\frac{1}{6} \\sup_{\\theta \\in [0,1)} |g(\\theta)| = \\frac{1}{6} \\cdot \\frac{3}{8} = \\frac{3}{48} = \\frac{1}{16}\n$$\nThis is the smallest constant that satisfies the inequality for all valid waveforms and all fractional delays $\\theta\\in[0,1)$.", "answer": "$$\\boxed{\\frac{1}{16}}$$", "id": "3318288"}]}