{"hands_on_practices": [{"introduction": "This first exercise provides a foundational experience in deriving discrete operators on a staggered grid. Starting from the integral form of Gauss's law, you will see how the geometric arrangement of the Yee grid naturally leads to a finite-difference approximation of the divergence operator. This practice reinforces the connection between the continuous physical law and its discrete counterpart, a core skill in computational physics [@problem_id:3349279].", "problem": "Consider a three-dimensional uniform Cartesian grid with spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$, using a staggered-grid (Yee) placement of electromagnetic field components. The electric flux density components $D_x$, $D_y$, and $D_z$ are collocated on the faces normal to the $x$, $y$, and $z$ directions, respectively, so that $D_x$ is defined at face centers at positions $(i+\\tfrac{1}{2},j,k)$, $D_y$ at $(i,j+\\tfrac{1}{2},k)$, and $D_z$ at $(i,j,k+\\tfrac{1}{2})$, where $(i,j,k)$ indexes the grid cells. For a synthetic face-centered field, suppose\n$$\nD_x\\bigl(i+\\tfrac{1}{2},j,k\\bigr) = \\alpha\\, i\\, \\Delta x, \\qquad D_y\\bigl(i,j+\\tfrac{1}{2},k\\bigr)=0,\\qquad D_z\\bigl(i,j,k+\\tfrac{1}{2}\\bigr)=0,\n$$\nwith $\\alpha$ a real constant and $i\\in\\mathbb{Z}$ denoting the cell index along the $x$-direction. Assume interior cells so that all needed face values are available and ignore boundary effects.\n\nStarting from the integral form of Gauss’s law for the electric flux density, $\\displaystyle \\iiint_{V}\\nabla\\cdot \\mathbf{D}\\, \\mathrm{d}V=\\iint_{\\partial V} \\mathbf{D}\\cdot \\mathbf{\\hat{n}}\\, \\mathrm{d}A$, derive the discrete divergence operator at the cell center $(i,j,k)$ in terms of the face-centered values on the staggered grid. Then, apply it to the synthetic field above to obtain the discrete charge density $\\rho(i,j,k)$ such that $\\nabla\\cdot \\mathbf{D}=\\rho$ at $(i,j,k)$. Express the final charge density in coulombs per cubic meter (C/m$^3$) as a single symbolic expression in terms of $\\alpha$. No rounding is required.", "solution": "The problem requires the derivation of the discrete divergence operator for the electric flux density $\\mathbf{D}$ on a staggered Cartesian grid (Yee grid) and its application to a given synthetic field to find the corresponding charge density $\\rho$.\n\nThe validation process confirms that the problem is scientifically grounded, well-posed, objective, and contains no fatal flaws. It is a standard problem in computational electromagnetics. We may therefore proceed with the solution.\n\nThe derivation begins with the integral form of Gauss's law for the electric flux density $\\mathbf{D}$:\n$$\n\\iiint_{V} (\\nabla \\cdot \\mathbf{D}) \\, \\mathrm{d}V = \\iint_{\\partial V} \\mathbf{D} \\cdot \\mathbf{\\hat{n}} \\, \\mathrm{d}A\n$$\nwhere $V$ is a control volume and $\\partial V$ is its bounding surface with outward unit normal $\\mathbf{\\hat{n}}$.\n\nIn the context of a Yee grid, we apply this law to a single grid cell. Let the cell be indexed by $(i,j,k)$ and centered at the coordinate origin for notational convenience, although the result is general. The control volume $V$ is a rectangular prism defined by the spatial extents $x \\in [-\\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$, $y \\in [-\\frac{\\Delta y}{2}, \\frac{\\Delta y}{2}]$, and $z \\in [-\\frac{\\Delta z}{2}, \\frac{\\Delta z}{2}]$. The volume of this cell is $\\Delta V = \\Delta x \\Delta y \\Delta z$. The charge density $\\rho$ and the divergence $\\nabla \\cdot \\mathbf{D}$ are evaluated at the cell center $(i,j,k)$.\n\nThe left-hand side of Gauss's law is approximated by assuming $\\nabla \\cdot \\mathbf{D}$ is constant over the small volume $\\Delta V$:\n$$\n\\iiint_{V} (\\nabla \\cdot \\mathbf{D}) \\, \\mathrm{d}V \\approx \\left. (\\nabla \\cdot \\mathbf{D}) \\right|_{(i,j,k)} \\Delta V = \\rho(i,j,k) \\Delta x \\Delta y \\Delta z\n$$\n\nThe right-hand side, the total flux out of the cell, is the sum of the fluxes through its six faces. On a staggered grid, the field components normal to each face are defined at the center of that face.\n1. Flux through faces normal to the $x$-axis:\nThe face at $x = \\frac{\\Delta x}{2}$ (the \"right\" face, corresponding to grid index $i+\\frac{1}{2}$) has area $\\Delta A_x = \\Delta y \\Delta z$ and outward normal $\\mathbf{\\hat{n}} = \\mathbf{\\hat{x}}$. The flux is approximately $D_x(i+\\frac{1}{2},j,k) \\Delta y \\Delta z$.\nThe face at $x = -\\frac{\\Delta x}{2}$ (the \"left\" face, corresponding to grid index $i-\\frac{1}{2}$) has area $\\Delta A_x = \\Delta y \\Delta z$ and outward normal $\\mathbf{\\hat{n}} = -\\mathbf{\\hat{x}}$. The flux is approximately $-D_x(i-\\frac{1}{2},j,k) \\Delta y \\Delta z$.\nThe net flux in the $x$-direction is $\\left[ D_x(i+\\frac{1}{2},j,k) - D_x(i-\\frac{1}{2},j,k) \\right] \\Delta y \\Delta z$.\n\n2. Flux through faces normal to the $y$-axis:\nBy similar reasoning, the net flux in the $y$-direction is $\\left[ D_y(i,j+\\frac{1}{2},k) - D_y(i,j-\\frac{1}{2},k) \\right] \\Delta x \\Delta z$.\n\n3. Flux through faces normal to the $z$-axis:\nThe net flux in the $z$-direction is $\\left[ D_z(i,j,k+\\frac{1}{2}) - D_z(i,j,k-\\frac{1}{2}) \\right] \\Delta x \\Delta y$.\n\nSumming the fluxes from all six faces gives the total flux:\n$$\n\\iint_{\\partial V} \\mathbf{D} \\cdot \\mathbf{\\hat{n}} \\, \\mathrm{d}A \\approx \\left[ D_x(i+\\tfrac{1}{2},j,k) - D_x(i-\\tfrac{1}{2},j,k) \\right] \\Delta y \\Delta z + \\left[ D_y(i,j+\\tfrac{1}{2},k) - D_y(i,j-\\tfrac{1}{2},k) \\right] \\Delta x \\Delta z + \\left[ D_z(i,j,k+\\tfrac{1}{2}) - D_z(i,j,k-\\tfrac{1}{2}) \\right] \\Delta x \\Delta y\n$$\n\nEquating the discretized left and right sides of Gauss's law gives:\n$$\n\\left. (\\nabla \\cdot \\mathbf{D}) \\right|_{(i,j,k)} \\Delta x \\Delta y \\Delta z \\approx \\left[ D_x(i+\\tfrac{1}{2},j,k) - D_x(i-\\tfrac{1}{2},j,k) \\right] \\Delta y \\Delta z + \\dots\n$$\nDividing by the cell volume $\\Delta V = \\Delta x \\Delta y \\Delta z$, we obtain the discrete divergence operator at cell $(i,j,k)$:\n$$\n\\left. (\\nabla \\cdot \\mathbf{D}) \\right|_{(i,j,k)} = \\frac{D_x(i+\\frac{1}{2},j,k) - D_x(i-\\frac{1}{2},j,k)}{\\Delta x} + \\frac{D_y(i,j+\\frac{1}{2},k) - D_y(i,j-\\frac{1}{2},k)}{\\Delta y} + \\frac{D_z(i,j,k+\\frac{1}{2}) - D_z(i,j,k-\\frac{1}{2})}{\\Delta z}\n$$\nThis expression is a second-order accurate central difference approximation of the divergence operator on the staggered grid.\n\nNext, we apply this operator to the given synthetic field:\n$$\nD_x\\bigl(i+\\tfrac{1}{2},j,k\\bigr) = \\alpha\\, i\\, \\Delta x, \\qquad D_y\\bigl(i,j+\\tfrac{1}{2},k\\bigr)=0,\\qquad D_z\\bigl(i,j,k+\\tfrac{1}{2}\\bigr)=0\n$$\nWe compute each term of the discrete divergence.\n\nFor the $x$-term, we need $D_x$ at $(i+\\frac{1}{2},j,k)$ and $(i-\\frac{1}{2},j,k)$.\nThe value at $(i+\\frac{1}{2},j,k)$ is given directly: $D_x(i+\\frac{1}{2},j,k) = \\alpha\\, i\\, \\Delta x$.\nTo find the value at $(i-\\frac{1}{2},j,k)$, we note that the grid location can be written as $((i-1)+\\frac{1}{2},j,k)$. We substitute the index $(i-1)$ into the formula for $D_x$:\n$D_x(i-\\frac{1}{2},j,k) = D_x((i-1)+\\frac{1}{2},j,k) = \\alpha (i-1) \\Delta x$.\nThe $x$-component of the discrete divergence is thus:\n$$\n\\frac{D_x(i+\\frac{1}{2},j,k) - D_x(i-\\frac{1}{2},j,k)}{\\Delta x} = \\frac{\\alpha\\, i\\, \\Delta x - \\alpha (i-1) \\Delta x}{\\Delta x} = \\frac{\\alpha\\, i\\, \\Delta x - \\alpha\\, i\\, \\Delta x + \\alpha\\, \\Delta x}{\\Delta x} = \\frac{\\alpha\\, \\Delta x}{\\Delta x} = \\alpha\n$$\n\nFor the $y$-term, the field is given as $D_y(i,j+\\frac{1}{2},k)=0$. This holds for all indices. Therefore, $D_y(i,j-\\frac{1}{2},k)=0$ as well.\nThe $y$-component of the discrete divergence is:\n$$\n\\frac{D_y(i,j+\\frac{1}{2},k) - D_y(i,j-\\frac{1}{2},k)}{\\Delta y} = \\frac{0 - 0}{\\Delta y} = 0\n$$\n\nFor the $z$-term, similarly, $D_z(i,j,k+\\frac{1}{2})=0$ and $D_z(i,j,k-\\frac{1}{2})=0$.\nThe $z$-component of the discrete divergence is:\n$$\n\\frac{D_z(i,j,k+\\frac{1}{2}) - D_z(i,j,k-\\frac{1}{2})}{\\Delta z} = \\frac{0-0}{\\Delta z} = 0\n$$\n\nThe total discrete divergence at cell $(i,j,k)$ is the sum of these components:\n$$\n\\left. (\\nabla \\cdot \\mathbf{D}) \\right|_{(i,j,k)} = \\alpha + 0 + 0 = \\alpha\n$$\nFrom Maxwell's equations, $\\nabla \\cdot \\mathbf{D} = \\rho$. Therefore, the discrete charge density $\\rho(i,j,k)$ is:\n$$\n\\rho(i,j,k) = \\alpha\n$$\nThe charge density is constant across all cells, independent of the indices $(i,j,k)$. The dimensional consistency is verified, as the given expression $D_x = \\alpha\\, i\\, \\Delta x$ requires $\\alpha$ to have units of $\\text{C}/\\text{m}^3$ for $D_x$ to be in $\\text{C}/\\text{m}^2$.", "answer": "$$\\boxed{\\alpha}$$", "id": "3349279"}, {"introduction": "Discretizing spacetime introduces numerical artifacts that cause simulated waves to behave differently from their continuum counterparts. This exercise delves into the crucial concept of numerical dispersion by having you derive and analyze the group velocity of a plane wave in an FDTD simulation. By quantifying the deviation from the physical speed of light $c$, you will gain a concrete understanding of the accuracy limitations inherent in the Yee scheme [@problem_id:3349258].", "problem": "Consider electromagnetic wave propagation in vacuum governed by Maxwell’s equations, with constitutive relations $\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ and $\\mathbf{B}=\\mu_{0}\\mathbf{H}$, so that $c=1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$. The fields are discretized using the standard three-dimensional staggered Yee grid of the Finite-Difference Time-Domain (FDTD) method (electric field components on cell edges, magnetic field components on cell faces, leapfrog time staggering by half a time step), on a uniform Cartesian grid with spacing $h$ in all directions and time step $\\Delta t$. The Courant number is specified as $S=c\\,\\Delta t/h=1/2$, which is below the three-dimensional stability limit.\n\nAssume a monochromatic plane wave with wave vector $\\mathbf{k}=(k_{x},0,0)$ aligned with the $x$ axis, and consider the component $k_{x}=\\pi/(3h)$. Starting from Maxwell’s equations and the Yee FDTD discrete update equations, derive the discrete numerical dispersion relation for such a wave on this staggered grid. From the dispersion relation, compute the group velocity along the direction of propagation, defined as $v_{g}=\\partial\\omega/\\partial k_{x}$, evaluated at $k_{x}=\\pi/(3h)$.\n\nQuantify the deviation of $v_{g}$ from the continuum speed $c$ by reporting the fractional deviation $\\delta=(v_{g}/c)-1$. Express your final answer as an exact analytic expression. No numerical rounding is required, and no physical units should be included in the final reported value.", "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Governing equations: Maxwell’s equations for electromagnetic wave propagation in vacuum.\n- Constitutive relations: $\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ and $\\mathbf{B}=\\mu_{0}\\mathbf{H}$.\n- Speed of light in vacuum: $c=1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$.\n- Discretization method: Standard three-dimensional staggered Yee grid for the Finite-Difference Time-Domain (FDTD) method, with electric field components on cell edges and magnetic field components on cell faces. Time integration is performed using a leapfrog scheme with a time staggering of $\\Delta t/2$.\n- Grid parameters: Uniform Cartesian grid with spacing $h$ in all three directions.\n- Time step: $\\Delta t$.\n- Courant number: $S=c\\,\\Delta t/h=1/2$.\n- Wave type: Monochromatic plane wave.\n- Wave vector: $\\mathbf{k}=(k_{x},0,0)$, aligned with the $x$-axis.\n- Specific wavenumber component: $k_{x}=\\pi/(3h)$.\n- Quantity to find: The fractional deviation of the group velocity from the speed of light, $\\delta=(v_{g}/c)-1$, where $v_{g}=\\partial\\omega/\\partial k_{x}$ is evaluated at the given $k_x$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on Maxwell's equations and the FDTD method, which are cornerstone principles in classical electromagnetism and computational physics. The analysis of numerical dispersion is a standard and critical topic in this field.\n- **Well-Posed:** The problem provides a complete set of parameters and asks for a specific, derivable quantity. A unique solution exists.\n- **Objective:** The problem statement is quantitative and free of subjective or ambiguous language.\n- **Consistency and Completeness:** All necessary information is provided. The given Courant number $S=1/2$ is less than the 3D stability limit for a uniform cubic grid, $S_{\\text{max}}=1/\\sqrt{3} \\approx 0.577$, so the numerical scheme is stable as stated. The problem is self-contained and consistent.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe propagation of electromagnetic waves in a source-free vacuum is described by Maxwell's curl equations:\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t} = \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\n\nThe problem specifies a plane wave propagating along the $x$-axis, with a wave vector $\\mathbf{k}=(k_{x},0,0)$. This implies that the fields have no spatial variation in the $y$ and $z$ directions, i.e., $\\partial/\\partial y = 0$ and $\\partial/\\partial z = 0$. For a transverse electromagnetic (TEM) wave, we can, without loss of generality, align the fields such that $\\mathbf{E} = E_y(x,t)\\hat{\\mathbf{y}}$ and $\\mathbf{H} = H_z(x,t)\\hat{\\mathbf{z}}$. Under these conditions, the curl equations simplify to a one-dimensional system:\n$$ \\frac{\\partial E_y}{\\partial x} = -\\mu_0 \\frac{\\partial H_z}{\\partial t} $$\n$$ \\frac{\\partial H_z}{\\partial x} = -\\varepsilon_0 \\frac{\\partial E_y}{\\partial t} $$\n\nIn the FDTD method with a Yee grid, these equations are discretized using central differences in both space and time. The electric field component $E_y$ and the magnetic field component $H_z$ are staggered. Let the grid index in space be $i$ and in time be $n$. We can define $E_y$ at spatial locations $(i+1/2)h$ and time steps $(n+1/2)\\Delta t$, and $H_z$ at spatial locations $ih$ and time steps $n\\Delta t$. The update equations are:\n$$ \\frac{E_y^{n+1/2}(i+1/2) - E_y^{n+1/2}(i-1/2)}{h} = -\\mu_0 \\frac{H_z^{n+1}(i) - H_z^n(i)}{\\Delta t} $$\n$$ \\frac{H_z^n(i+1) - H_z^n(i)}{h} = -\\varepsilon_0 \\frac{E_y^{n+1/2}(i+1/2) - E_y^{n-1/2}(i+1/2)}{\\Delta t} $$\n\nTo find the numerical dispersion relation, we substitute a discrete plane wave solution of the form:\n$$ E_y^{n+1/2}(i+1/2) = E_{y0} \\exp[j(\\omega(n+1/2)\\Delta t - k_x(i+1/2)h)] $$\n$$ H_z^n(i) = H_{z0} \\exp[j(\\omega n\\Delta t - k_x i h)] $$\nwhere $\\omega$ is the numerical angular frequency and $k_x$ is the wavenumber.\n\nSubstituting these into the second update equation:\n$$ \\frac{H_{z0} \\exp[j(\\omega n\\Delta t - k_x(i+1)h)] - H_{z0} \\exp[j(\\omega n\\Delta t - k_x i h)]}{h} = -\\varepsilon_0 \\frac{E_{y0} \\exp[j(\\omega(n+1/2)\\Delta t - k_x(i+1/2)h)] - E_{y0} \\exp[j(\\omega(n-1/2)\\Delta t - k_x(i+1/2)h)]}{\\Delta t} $$\nDividing by the common factor $\\exp[j(\\omega n\\Delta t - k_x(i+1/2)h)]$:\n$$ \\frac{H_{z0}}{h} (\\exp[-jk_xh/2] - \\exp[+jk_xh/2]) = -\\frac{\\varepsilon_0 E_{y0}}{\\Delta t} (\\exp[+j\\omega\\Delta t/2] - \\exp[-j\\omega\\Delta t/2]) $$\nUsing Euler's formula, $2j\\sin\\theta = \\exp(j\\theta) - \\exp(-j\\theta)$:\n$$ \\frac{H_{z0}}{h}(-2j\\sin(\\frac{k_x h}{2})) = -\\frac{\\varepsilon_0 E_{y0}}{\\Delta t}(2j\\sin(\\frac{\\omega\\Delta t}{2})) $$\n$$ \\frac{H_{z0}}{h}\\sin(\\frac{k_x h}{2}) = \\frac{\\varepsilon_0 E_{y0}}{\\Delta t}\\sin(\\frac{\\omega\\Delta t}{2}) \\quad (1) $$\n\nSimilarly, substituting into the first update equation leads to:\n$$ \\frac{E_{y0}}{h}\\sin(\\frac{k_x h}{2}) = \\frac{\\mu_0 H_{z0}}{\\Delta t}\\sin(\\frac{\\omega\\Delta t}{2}) \\quad (2) $$\nNote the sign change comes from the equation $\\frac{\\partial E_y}{\\partial x} = -\\mu_0 \\frac{\\partial H_z}{\\partial t}$. Let's re-verify the first equation: $\\frac{E_{y0} \\exp(...(i+1/2)...) - E_{y0} \\exp(...(i-1/2)...)}{h}$. This becomes $\\frac{E_{y0}}{h}(\\exp(jk_xh/2)-\\exp(-jk_xh/2)) \\exp(...) = \\frac{E_{y0}}{h}(2j\\sin(k_xh/2))\\exp(...)$. The RHS is $-\\mu_0 \\frac{H_{z0}\\exp(...n+1...) - H_{z0}\\exp(...n...)}{\\Delta t}$, which is $-\\mu_0 \\frac{H_{z0}}{\\Delta t}(\\exp(j\\omega\\Delta t)-1)\\exp(...) = -\\mu_0 \\frac{H_{z0}}{\\Delta t}\\exp(j\\omega\\Delta t/2)(2j\\sin(\\omega\\Delta t/2))\\exp(...)$. By matching temporal and spatial phases, there's a delicate placement of terms. A more direct method is to combine (1) and (2) as a linear system for $(E_{y0}, H_{z0})$.\nFrom (1): $H_{z0} \\frac{\\sin(k_x h / 2)}{h} - E_{y0} \\frac{\\varepsilon_0 \\sin(\\omega \\Delta t / 2)}{\\Delta t} = 0$\nFrom (2): $H_{z0} \\frac{\\mu_0 \\sin(\\omega \\Delta t / 2)}{\\Delta t} - E_{y0} \\frac{\\sin(k_x h / 2)}{h} = 0$\nFor a non-trivial solution, the determinant of the coefficients must be zero:\n$$ \\left( \\frac{\\sin(k_x h / 2)}{h} \\right)^2 - \\left( \\frac{\\varepsilon_0 \\sin(\\omega \\Delta t / 2)}{\\Delta t} \\right) \\left( \\frac{\\mu_0 \\sin(\\omega \\Delta t / 2)}{\\Delta t} \\right) = 0 $$\n$$ \\frac{1}{h^2}\\sin^2(\\frac{k_x h}{2}) = \\frac{\\mu_0\\varepsilon_0}{(\\Delta t)^2}\\sin^2(\\frac{\\omega\\Delta t}{2}) $$\nUsing $c=1/\\sqrt{\\mu_0\\varepsilon_0}$, this becomes:\n$$ \\frac{1}{h^2}\\sin^2(\\frac{k_x h}{2}) = \\frac{1}{c^2(\\Delta t)^2}\\sin^2(\\frac{\\omega\\Delta t}{2}) $$\nRearranging and introducing the Courant number $S = c\\Delta t/h$:\n$$ \\sin^2(\\frac{\\omega\\Delta t}{2}) = \\left(\\frac{c\\Delta t}{h}\\right)^2 \\sin^2(\\frac{k_x h}{2}) = S^2 \\sin^2(\\frac{k_x h}{2}) $$\nTaking the positive square root for forward-propagating waves gives the numerical dispersion relation for propagation along a grid axis:\n$$ \\sin(\\frac{\\omega\\Delta t}{2}) = S \\sin(\\frac{k_x h}{2}) $$\nThis result is consistent with specializing the general 3D FDTD dispersion relation for $\\mathbf{k}=(k_x, 0, 0)$.\n\nThe group velocity $v_g$ is defined as $v_g = \\partial\\omega/\\partial k_x$. We differentiate the dispersion relation implicitly with respect to $k_x$:\n$$ \\frac{\\partial}{\\partial k_x} \\left[ \\sin(\\frac{\\omega\\Delta t}{2}) \\right] = \\frac{\\partial}{\\partial k_x} \\left[ S \\sin(\\frac{k_x h}{2}) \\right] $$\n$$ \\cos(\\frac{\\omega\\Delta t}{2}) \\cdot \\frac{\\Delta t}{2} \\cdot \\frac{\\partial\\omega}{\\partial k_x} = S \\cdot \\cos(\\frac{k_x h}{2}) \\cdot \\frac{h}{2} $$\n$$ v_g = \\frac{\\partial\\omega}{\\partial k_x} = \\frac{S h}{\\Delta t} \\frac{\\cos(k_x h / 2)}{\\cos(\\omega\\Delta t / 2)} $$\nSince $S=c\\Delta t/h$, we have $Sh/\\Delta t = c$. Thus:\n$$ v_g = c \\frac{\\cos(k_x h / 2)}{\\cos(\\omega\\Delta t / 2)} $$\nTo express $v_g$ solely in terms of $k_x$, we use the identity $\\cos\\theta = \\sqrt{1-\\sin^2\\theta}$ and substitute the dispersion relation into the denominator:\n$$ \\cos(\\frac{\\omega\\Delta t}{2}) = \\sqrt{1 - \\sin^2(\\frac{\\omega\\Delta t}{2})} = \\sqrt{1 - S^2 \\sin^2(\\frac{k_x h}{2})} $$\nSo, the group velocity is:\n$$ v_g(k_x) = c \\frac{\\cos(k_x h / 2)}{\\sqrt{1 - S^2 \\sin^2(k_x h / 2)}} $$\n\nNow we evaluate this expression for the given values: $S=1/2$ and $k_x = \\pi/(3h)$.\nThe argument of the trigonometric functions is:\n$$ \\frac{k_x h}{2} = \\frac{(\\pi / (3h)) \\cdot h}{2} = \\frac{\\pi}{6} $$\nWe have:\n$$ \\cos(\\frac{\\pi}{6}) = \\frac{\\sqrt{3}}{2} $$\n$$ \\sin(\\frac{\\pi}{6}) = \\frac{1}{2} $$\nSubstituting these values into the expression for $v_g$:\n$$ v_g = c \\frac{\\cos(\\pi/6)}{\\sqrt{1 - S^2 \\sin^2(\\pi/6)}} = c \\frac{\\sqrt{3}/2}{\\sqrt{1 - (1/2)^2 (1/2)^2}} $$\n$$ v_g = c \\frac{\\sqrt{3}/2}{\\sqrt{1 - (1/4)(1/4)}} = c \\frac{\\sqrt{3}/2}{\\sqrt{1 - 1/16}} = c \\frac{\\sqrt{3}/2}{\\sqrt{15/16}} $$\n$$ v_g = c \\frac{\\sqrt{3}/2}{\\sqrt{15}/4} = c \\left( \\frac{\\sqrt{3}}{2} \\cdot \\frac{4}{\\sqrt{15}} \\right) = c \\frac{2\\sqrt{3}}{\\sqrt{15}} $$\nSimplifying the fraction:\n$$ v_g = c \\frac{2\\sqrt{3}}{\\sqrt{3}\\sqrt{5}} = c \\frac{2}{\\sqrt{5}} $$\n\nThe final step is to compute the fractional deviation $\\delta = (v_g/c) - 1$:\n$$ \\frac{v_g}{c} = \\frac{2}{\\sqrt{5}} $$\n$$ \\delta = \\frac{2}{\\sqrt{5}} - 1 $$\nTo write this as a single fraction:\n$$ \\delta = \\frac{2 - \\sqrt{5}}{\\sqrt{5}} $$", "answer": "$$\\boxed{\\frac{2 - \\sqrt{5}}{\\sqrt{5}}}$$", "id": "3349258"}, {"introduction": "One of the most elegant features of the Yee scheme is its ability to exactly preserve fundamental conservation laws at the discrete level. This problem demonstrates this by exploring the charge continuity equation, $\\partial_t \\rho + \\nabla \\cdot \\mathbf{J} = 0$. You will determine the precise value of current density on an edge required to account for the movement of charge between two cells, illustrating how the spatio-temporal staggering of $\\rho$ and $\\mathbf{J}$ ensures that charge is perfectly conserved within the simulation [@problem_id:3349287].", "problem": "A single charged particle with charge $q$ moves in a uniform Cartesian Yee staggered-grid used for Finite-Difference Time-Domain (FDTD) computational electromagnetics. The grid spacings are $\\Delta x$, $\\Delta y$, and $\\Delta z$. Charge density $\\rho$ is stored at cell centers at integer time levels $n$, and current density components $J_x$, $J_y$, and $J_z$ are stored at the centers of edges aligned with the corresponding coordinate axes at half time levels $n+\\tfrac{1}{2}$. Consider a finite-volume form of the discrete continuity equation on this staggered grid, applied to each cell control volume:\n$$\n\\frac{\\rho^{n+1}_{i,j,k}-\\rho^{n}_{i,j,k}}{\\Delta t}\n+\\frac{J^{n+1/2}_{x,i+1/2,j,k}-J^{n+1/2}_{x,i-1/2,j,k}}{\\Delta x}\n+\\frac{J^{n+1/2}_{y,i,j+1/2,k}-J^{n+1/2}_{y,i,j-1/2,k}}{\\Delta y}\n+\\frac{J^{n+1/2}_{z,i,j,k+1/2}-J^{n+1/2}_{z,i,j,k-1/2}}{\\Delta z}\n=0.\n$$\nAt time $n$, the particle is located exactly at the center of cell $(i,j,k)$, and at time $n+1$ it is located exactly at the center of cell $(i+1,j,k)$, having moved a distance $\\Delta x$ purely along the $+x$ direction during a single time step $\\Delta t$. There are no other particles or sources in the domain. Use a nearest-cell-centered (zero-order) shape function for charge deposition, so that at time $n$ the cell-centered density is $\\rho^n_{i,j,k}=q/(\\Delta x\\,\\Delta y\\,\\Delta z)$ and zero elsewhere, while at time $n+1$ the density is $\\rho^{n+1}_{i+1,j,k}=q/(\\Delta x\\,\\Delta y\\,\\Delta z)$ and zero elsewhere. Assume that the only nonzero current component arises from this crossing event, is aligned with $x$, and is deposited only on the unique $x$-edge-centered location between the two cells, namely $J^{n+1/2}_{x,i+1/2,j,k}$; take all other components and edge locations to be zero. Starting from the finite-volume discrete continuity equation above and conservation of charge, derive the unique value of the required edge current $J^{n+1/2}_{x,i+1/2,j,k}$ and the updated cell-centered densities $\\rho^{n+1}_{i,j,k}$ and $\\rho^{n+1}_{i+1,j,k}$ that ensure the discrete continuity equation is satisfied exactly in both adjacent cells.\n\nProvide your final answer as a single row matrix in the order $\\big[J^{n+1/2}_{x,i+1/2,j,k},\\ \\rho^{n+1}_{i,j,k},\\ \\rho^{n+1}_{i+1,j,k}\\big]$. Express $J_x$ in $\\mathrm{A\\,m^{-2}}$ and $\\rho$ in $\\mathrm{C\\,m^{-3}}$. No numerical rounding is required; give a closed-form symbolic expression in terms of $q$, $\\Delta x$, $\\Delta y$, $\\Delta z$, and $\\Delta t$.", "solution": "The problem requires the derivation of the current density $J^{n+1/2}_{x,i+1/2,j,k}$ and the updated charge densities $\\rho^{n+1}_{i,j,k}$ and $\\rho^{n+1}_{i+1,j,k}$ that ensure the discrete continuity equation is satisfied for a particle moving between two adjacent cells on a Yee grid.\n\nFirst, we must formalize the charge densities at the initial time step $n$ and the final time step $n+1$ based on the problem statement. The problem specifies a zero-order (nearest-cell-centered) shape function for charge deposition. The volume of a grid cell is $V_{cell} = \\Delta x \\Delta y \\Delta z$.\n\nAt time $t=n\\Delta t$, the particle with charge $q$ is located at the center of cell $(i,j,k)$. According to the deposition scheme, the entire charge is assigned to the density at that cell's center. Thus, the charge density is:\n$$\n\\rho^{n}_{i,j,k} = \\frac{q}{V_{cell}} = \\frac{q}{\\Delta x \\Delta y \\Delta z}\n$$\nSince the particle is not in any other cell, the charge density is zero everywhere else. Specifically, for the adjacent cell $(i+1,j,k)$:\n$$\n\\rho^{n}_{i+1,j,k} = 0\n$$\n\nAt time $t=(n+1)\\Delta t$, the particle has moved to the center of cell $(i+1,j,k)$. Applying the same deposition rule, the charge is now assigned to the center of this new cell. This yields the updated charge densities, which are part of the solution to be derived from the physical description:\n$$\n\\rho^{n+1}_{i+1,j,k} = \\frac{q}{V_{cell}} = \\frac{q}{\\Delta x \\Delta y \\Delta z}\n$$\nThe particle has left cell $(i,j,k)$, so the updated density there is:\n$$\n\\rho^{n+1}_{i,j,k} = 0\n$$\n\nNext, we apply the given finite-volume discrete continuity equation to the two cells involved in this event: cell $(i,j,k)$ and cell $(i+1,j,k)$. The problem states that the only nonzero current component is $J^{n+1/2}_{x,i+1/2,j,k}$, which is located on the interface between these two cells.\n\nLet's analyze cell $(i,j,k)$. The general discrete continuity equation is:\n$$\n\\frac{\\rho^{n+1}_{i,j,k}-\\rho^{n}_{i,j,k}}{\\Delta t}\n+\\frac{J^{n+1/2}_{x,i+1/2,j,k}-J^{n+1/2}_{x,i-1/2,j,k}}{\\Delta x}\n+\\frac{J^{n+1/2}_{y,i,j+1/2,k}-J^{n+1/2}_{y,i,j-1/2,k}}{\\Delta y}\n+\\frac{J^{n+1/2}_{z,i,j,k+1/2}-J^{n+1/2}_{z,i,j,k-1/2}}{\\Delta z}\n=0\n$$\nAccording to the problem statement, all current density components are zero except for $J^{n+1/2}_{x,i+1/2,j,k}$. Therefore, $J^{n+1/2}_{x,i-1/2,j,k}=0$, and all $J_y$ and $J_z$ terms are zero. The equation for cell $(i,j,k)$ simplifies to:\n$$\n\\frac{\\rho^{n+1}_{i,j,k}-\\rho^{n}_{i,j,k}}{\\Delta t} + \\frac{J^{n+1/2}_{x,i+1/2,j,k} - 0}{\\Delta x} = 0\n$$\nSubstituting the values of the charge densities we determined:\n$$\n\\frac{0 - \\frac{q}{\\Delta x \\Delta y \\Delta z}}{\\Delta t} + \\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\n$$\n-\\frac{q}{\\Delta t \\Delta x \\Delta y \\Delta z} + \\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\nSolving for the unknown current density $J^{n+1/2}_{x,i+1/2,j,k}$:\n$$\n\\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = \\frac{q}{\\Delta t \\Delta x \\Delta y \\Delta z}\n$$\n$$\nJ^{n+1/2}_{x,i+1/2,j,k} = \\frac{q \\Delta x}{\\Delta t \\Delta x \\Delta y \\Delta z} = \\frac{q}{\\Delta t \\Delta y \\Delta z}\n$$\n\nNow, we perform the same analysis for cell $(i+1,j,k)$ to verify consistency. The general equation applied to this cell is:\n$$\n\\frac{\\rho^{n+1}_{i+1,j,k}-\\rho^{n}_{i+1,j,k}}{\\Delta t}\n+\\frac{J^{n+1/2}_{x,i+3/2,j,k}-J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x}\n+\\frac{J^{n+1/2}_{y,i+1,j+1/2,k}-J^{n+1/2}_{y,i+1,j-1/2,k}}{\\Delta y}\n+\\frac{J^{n+1/2}_{z,i+1,j,k+1/2}-J^{n+1/2}_{z,i+1,j,k-1/2}}{\\Delta z}\n=0\n$$\nAgain, all current components are zero except $J^{n+1/2}_{x,i+1/2,j,k}$. In particular, $J^{n+1/2}_{x,i+3/2,j,k}=0$. The equation simplifies to:\n$$\n\\frac{\\rho^{n+1}_{i+1,j,k}-\\rho^{n}_{i+1,j,k}}{\\Delta t} + \\frac{0 - J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\nSubstituting the values of the charge densities:\n$$\n\\frac{\\frac{q}{\\Delta x \\Delta y \\Delta z} - 0}{\\Delta t} - \\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\n$$\n\\frac{q}{\\Delta t \\Delta x \\Delta y \\Delta z} - \\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\nSolving for $J^{n+1/2}_{x,i+1/2,j,k}$:\n$$\n\\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = \\frac{q}{\\Delta t \\Delta x \\Delta y \\Delta z}\n$$\n$$\nJ^{n+1/2}_{x,i+1/2,j,k} = \\frac{q \\Delta x}{\\Delta t \\Delta x \\Delta y \\Delta z} = \\frac{q}{\\Delta t \\Delta y \\Delta z}\n$$\nBoth calculations yield the identical expression for the current density. This confirms that the scheme is consistent and that charge is conserved discretely. The total charge leaving cell $(i,j,k)$ equals the total charge entering cell $(i+1,j,k)$, mediated by the current on the shared face.\n\nThe derived quantities are:\n1. Current density: $J^{n+1/2}_{x,i+1/2,j,k} = \\frac{q}{\\Delta t \\Delta y \\Delta z}$\n2. Updated density in the initial cell: $\\rho^{n+1}_{i,j,k} = 0$\n3. Updated density in the final cell: $\\rho^{n+1}_{i+1,j,k} = \\frac{q}{\\Delta x \\Delta y \\Delta z}$\n\nThese are the unique values that satisfy the discrete continuity equation under the given conditions.\nThe final answer must be provided as a single row matrix in the order $\\big[J^{n+1/2}_{x,i+1/2,j,k},\\ \\rho^{n+1}_{i,j,k},\\ \\rho^{n+1}_{i+1,j,k}\\big]$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{q}{\\Delta t \\Delta y \\Delta z} & 0 & \\frac{q}{\\Delta x \\Delta y \\Delta z}\n\\end{pmatrix}\n}\n$$", "id": "3349287"}]}