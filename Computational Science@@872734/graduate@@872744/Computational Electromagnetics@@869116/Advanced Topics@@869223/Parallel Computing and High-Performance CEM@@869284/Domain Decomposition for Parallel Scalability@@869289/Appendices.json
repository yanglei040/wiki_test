{"hands_on_practices": [{"introduction": "The foundation of parallelizing explicit solvers like the Finite-Difference Time-Domain (FDTD) method lies in correctly partitioning the computational domain. This practice explores the interplay between the algorithm's inherent stability, governed by the Courant–Friedrichs–Lewy (CFL) condition, and the communication required by domain decomposition. By deriving the CFL limit and analyzing the synchronization needs, you will gain a fundamental understanding of what makes a parallel time-domain simulation both stable and correct. [@problem_id:3302072]", "problem": "Consider electromagnetic wave propagation in vacuum governed by Maxwell’s equations, discretized in three dimensions using the staggered-grid Finite-Difference Time-Domain (FDTD) method introduced by Kane Yee (the Yee scheme). The computational domain is partitioned into $P$ Cartesian subdomains for parallel execution under the Message Passing Interface (MPI), with one-cell ghost layers exchanged across subdomain interfaces. Assume perfectly electric conducting (PEC) boundaries at the outer perimeter of the global domain and no sources inside the domain. The spatial grid is uniform with spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$ in the $x$, $y$, and $z$ directions, respectively. The vacuum material parameters satisfy $c = 1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$, where $c$ is the speed of light, $\\mu_{0}$ is the vacuum permeability, and $\\varepsilon_{0}$ is the vacuum permittivity.\n\nStarting from Maxwell’s curl equations and their explicit leapfrog-in-time Yee discretization, perform a von Neumann stability analysis with a plane-wave ansatz to derive the Courant–Friedrichs–Lewy (CFL) stability restriction on the time step $\\Delta t$ for the three-dimensional scheme on this partitioned domain. Explain clearly how domain decomposition and the ghost-layer exchanges affect the stability condition and what synchronization requirements are necessary across MPI ranks to ensure that the discrete curl computations at subdomain interfaces use field values at consistent time levels.\n\nThen, for a specific uniform grid and vacuum, compute the maximum stable time step implied by your derived CFL restriction. Use\n- $\\Delta x = 5.0 \\times 10^{-4}\\ \\text{m}$,\n- $\\Delta y = 1.0 \\times 10^{-3}\\ \\text{m}$,\n- $\\Delta z = 2.0 \\times 10^{-3}\\ \\text{m}$,\n- $c = 2.99792458 \\times 10^{8}\\ \\text{m/s}$.\n\nRound your numerical answer to four significant figures. Express the final time step in picoseconds.", "solution": "The problem asks for the derivation of the Courant–Friedrichs–Lewy (CFL) stability condition for the three-dimensional Finite-Difference Time-Domain (FDTD) method, an explanation of its interaction with parallel domain decomposition, and a numerical calculation of the maximum stable time step $\\Delta t$.\n\nThe analysis begins with Maxwell's curl equations in a source-free vacuum:\n$$ \\nabla \\times \\vec{E} = -\\mu_0 \\frac{\\partial \\vec{H}}{\\partial t} $$\n$$ \\nabla \\times \\vec{H} = \\varepsilon_0 \\frac{\\partial \\vec{E}}{\\partial t} $$\nwhere $\\vec{E}$ is the electric field, $\\vec{H}$ is the magnetic field, $\\mu_0$ is the vacuum permeability, and $\\varepsilon_0$ is the vacuum permittivity.\n\nThese vector equations are discretized using the Yee scheme on a staggered Cartesian grid. The electric field components are evaluated at integer time steps ($n \\Delta t$), and the magnetic field components are evaluated at half-integer time steps ($(n+1/2)\\Delta t$). The spatial components are also staggered. For instance, the update equation for the $x$-component of the electric field is obtained by applying a central difference approximation in both space and time:\n$$ \\frac{E_x\\Big|^{n+1}_{i, j+1/2, k+1/2} - E_x\\Big|^n_{i, j+1/2, k+1/2}}{\\Delta t} = \\frac{1}{\\varepsilon_0} \\left( \\frac{H_z\\Big|^{n+1/2}_{i, j+1, k+1/2} - H_z\\Big|^{n+1/2}_{i, j, k+1/2}}{\\Delta y} - \\frac{H_y\\Big|^{n+1/2}_{i, j+1/2, k+1} - H_y\\Big|^{n+1/2}_{i, j+1/2, k}}{\\Delta z} \\right) $$\nThe complete set of six scalar update equations is derived similarly.\n\nTo perform the von Neumann stability analysis, we introduce a plane-wave ansatz for each field component. For a generic field component $F$, this takes the form:\n$$ F^{n}_{i,j,k} = F_0 \\, \\xi^n \\, \\exp[-j(k_x i \\Delta x + k_y j \\Delta y + k_z k \\Delta z)] $$\nwhere $F_0$ is the complex amplitude, $\\xi$ is the amplification factor per time step, $j = \\sqrt{-1}$, and $(k_x, k_y, k_z)$ is the wave vector. For a stable scheme, the magnitude of the amplification factor must satisfy $|\\xi| \\le 1$ for all possible wave vectors.\n\nSubstituting this ansatz into the six FDTD update equations transforms the system of finite-difference equations into a system of algebraic equations for the field amplitudes. For the $E_x$ update equation, this procedure yields:\n$$ (\\xi - 1) E_{x0} = \\frac{\\Delta t}{\\varepsilon_0} \\xi^{1/2} \\left[ \\frac{H_{z0}}{\\Delta y} (e^{-jk_y \\Delta y/2} - e^{jk_y \\Delta y/2}) - \\frac{H_{y0}}{\\Delta z} (e^{-jk_z \\Delta z/2} - e^{jk_z \\Delta z/2}) \\right] $$\nUsing Euler's identity, $\\sin(\\theta) = (e^{j\\theta} - e^{-j\\theta})/(2j)$, this simplifies. Applying this to all six equations and using the leapfrog property $\\xi^{1/2} - \\xi^{-1/2} = 2j \\sin(\\omega \\Delta t / 2)$ where $\\xi = e^{j\\omega \\Delta t}$, we obtain:\n$$ \\frac{2j}{\\Delta t} \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\vec{E}_0 = \\frac{j}{\\varepsilon_0} (\\vec{k}_{num} \\times \\vec{H}_0) $$\n$$ \\frac{2j}{\\Delta t} \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\vec{H}_0 = -\\frac{j}{\\mu_0} (\\vec{k}_{num} \\times \\vec{E}_0) $$\nwhere $\\vec{E}_0$ and $\\vec{H}_0$ are the vector amplitudes and $\\vec{k}_{num}$ is the effective numerical wave vector, defined by its components:\n$$ k_{num,x} = \\frac{2}{\\Delta x} \\sin\\left(\\frac{k_x \\Delta x}{2}\\right) $$\n$$ k_{num,y} = \\frac{2}{\\Delta y} \\sin\\left(\\frac{k_y \\Delta y}{2}\\right) $$\n$$ k_{num,z} = \\frac{2}{\\Delta z} \\sin\\left(\\frac{k_z \\Delta z}{2}\\right) $$\nCombining the two algebraic vector equations to eliminate $\\vec{H}_0$ and assuming a transverse wave ($\\vec{k}_{num} \\cdot \\vec{E}_0 = 0$), we arrive at the numerical dispersion relation for the 3D Yee scheme:\n$$ \\left[\\frac{2}{c \\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right)\\right]^2 = \\left[\\frac{2}{\\Delta x} \\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right]^2 + \\left[\\frac{2}{\\Delta y} \\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right]^2 + \\left[\\frac{2}{\\Delta z} \\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right]^2 $$\nwhere $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$. This simplifies to:\n$$ \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) = (c \\Delta t)^2 \\left[ \\frac{\\sin^2(k_x \\Delta x/2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y/2)}{\\Delta y^2} + \\frac{\\sin^2(k_z \\Delta z/2)}{\\Delta z^2} \\right] $$\nFor stability, $\\omega$ must be real, which requires $|\\sin(\\omega \\Delta t/2)| \\le 1$. This condition must hold for all possible wave numbers $k_x, k_y, k_z$. The right-hand side is maximized for the highest frequency (Nyquist) mode supportable by the grid, where $k_x\\Delta x = \\pi$, $k_y\\Delta y = \\pi$, and $k_z\\Delta z = \\pi$. In this worst-case scenario, $\\sin^2(...) = 1$. The stability condition thus becomes:\n$$ (c \\Delta t)^2 \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2} \\right) \\le 1 $$\nRearranging gives the CFL stability restriction on the time step $\\Delta t$:\n$$ \\Delta t \\le \\frac{1}{c\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}} $$\n\nThe use of domain decomposition for parallel execution does not alter this fundamental stability condition. The von Neumann analysis is local; it depends only on the numerical stencil of the update equations. The purpose of exchanging ghost-cell data between adjacent subdomains (MPI ranks) is precisely to ensure that the field updates at the boundaries of a subdomain are computed using the identical numerical stencil as the updates in the interior. In effect, the ghost-cell exchange mechanism perfectly reconstructs the data environment of a monolithic (serial) simulation at the subdomain interfaces. Therefore, the stability limit for the parallel simulation is the same as for a serial simulation on the same global grid.\n\nHowever, domain decomposition imposes strict synchronization requirements. The FDTD algorithm proceeds in a leapfrog manner: E-fields are updated using H-fields, and then H-fields are updated using the newly computed E-fields.\n1. To update H-fields from time step $n+1/2$ to $n+3/2$, all necessary E-field values at time step $n+1$ must be available. For H-nodes near a subdomain boundary, this requires E-field values from the neighboring subdomain. Thus, all MPI ranks must first exchange boundary values of their E-fields at time $n+1$ before proceeding with the H-field update.\n2. Similarly, to update E-fields from time step $n+1$ to $n+2$, all necessary H-field values at time step $n+3/2$ must be available. This again requires an exchange of the newly computed H-field boundary values among ranks.\nThis lock-step process, with two communication/synchronization events per time step, is mandatory. It ensures that the curl computations at subdomain interfaces use field values at consistent time levels across the distributed domain, thereby preserving the integrity and stability of the numerical scheme.\n\nNow, we compute the maximum stable time step for the given parameters:\n- $\\Delta x = 5.0 \\times 10^{-4}\\ \\text{m}$\n- $\\Delta y = 1.0 \\times 10^{-3}\\ \\text{m}$\n- $\\Delta z = 2.0 \\times 10^{-3}\\ \\text{m}$\n- $c = 2.99792458 \\times 10^{8}\\ \\text{m/s}$\n\nFirst, we calculate the terms inside the square root:\n$$ \\frac{1}{\\Delta x^2} = \\frac{1}{(5.0 \\times 10^{-4})^2} = \\frac{1}{25 \\times 10^{-8}} = 4.0 \\times 10^6\\ \\text{m}^{-2} $$\n$$ \\frac{1}{\\Delta y^2} = \\frac{1}{(1.0 \\times 10^{-3})^2} = \\frac{1}{1.0 \\times 10^{-6}} = 1.0 \\times 10^6\\ \\text{m}^{-2} $$\n$$ \\frac{1}{\\Delta z^2} = \\frac{1}{(2.0 \\times 10^{-3})^2} = \\frac{1}{4.0 \\times 10^{-6}} = 0.25 \\times 10^6\\ \\text{m}^{-2} $$\nThe sum is:\n$$ S = \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2} = (4.0 + 1.0 + 0.25) \\times 10^6 = 5.25 \\times 10^6\\ \\text{m}^{-2} $$\nThe square root is:\n$$ \\sqrt{S} = \\sqrt{5.25 \\times 10^6} = \\sqrt{5.25} \\times 10^3 \\approx 2.2912878 \\times 10^3\\ \\text{m}^{-1} $$\nThe maximum stable time step is:\n$$ \\Delta t_{max} = \\frac{1}{c\\sqrt{S}} = \\frac{1}{(2.99792458 \\times 10^8) \\times (2.2912878 \\times 10^3)} $$\n$$ \\Delta t_{max} \\approx \\frac{1}{6.869090 \\times 10^{11}}\\ \\text{s} \\approx 1.45580 \\times 10^{-12}\\ \\text{s} $$\nConverting to picoseconds ($1\\ \\text{ps} = 10^{-12}\\ \\text{s}$):\n$$ \\Delta t_{max} \\approx 1.45580\\ \\text{ps} $$\nRounding to four significant figures gives $1.456\\ \\text{ps}$.", "answer": "$$\\boxed{1.456}$$", "id": "3302072"}, {"introduction": "A correct parallel algorithm is only the first step; achieving scalability requires minimizing communication overhead. This exercise delves into performance modeling, a critical skill for any computational scientist, using the classic $\\alpha$-$\\beta$ model to quantify communication costs. You will explore temporal blocking as a strategy to reduce communication frequency and learn how to balance trade-offs by overlapping communication with computation to find an optimal execution strategy. [@problem_id:3302053]", "problem": "A three-dimensional Finite-Difference Time-Domain (FDTD) electromagnetic simulation of size $N_x \\times N_y \\times N_z$ is decomposed over a Message Passing Interface (MPI) process grid of size $P_x \\times P_y \\times P_z$, so that each MPI rank owns a subdomain of size $n_x \\times n_y \\times n_z$ with $n_x = N_x/P_x$, $n_y = N_y/P_y$, and $n_z = N_z/P_z$. Each time step requires nearest-neighbor halo exchange of a one-cell stencil in all three directions to advance the staggered Yee updates. Assume a standard $\\alpha$–$\\beta$ communication cost model where a point-to-point message of size $m$ bytes costs $T_{\\mathrm{msg}} = \\alpha + \\beta m$, with latency $\\alpha$ and inverse bandwidth $\\beta$.\n\nTo reduce communication frequency, consider an $s$-step blocking strategy: perform $s$ time steps locally while exchanging a halo of thickness $s$ cells only once per $s$ steps. Assume that per-cell, per-time-step computation time is $\\gamma$ seconds and that each halo cell requires $n_v$ double-precision values ($8$ bytes each) to be communicated per face. You may assume that the six face exchanges are executed as six separate messages per $s$-step block, one per face, and that all faces are exchanged once per $s$ steps.\n\n1. Starting from the $\\alpha$–$\\beta$ model and the geometric size of the faces of the local subdomain, derive a formula for the total halo exchange time per MPI rank per $s$ steps, $T_{\\mathrm{comm}}(s)$, in terms of $\\alpha$, $\\beta$, $s$, $n_x$, $n_y$, $n_z$, and $b = n_v \\times 8$ (bytes per halo cell).\n2. Using only the data dependency radius of the Yee stencil, derive the amount of computation that can be overlapped with communication in an $s$-step block, and write the overlappable compute time $T_{\\mathrm{int}}(s)$ and the total compute time per $s$ steps $T_{\\mathrm{comp}}(s)$ on one rank in terms of $\\gamma$, $s$, $n_x$, $n_y$, and $n_z$.\n3. Combine the above to obtain the per-time-step iteration time on one MPI rank under optimal overlap as\n$$\nT_{\\mathrm{step}}(s) \\;=\\; \\frac{T_{\\mathrm{comp}}(s) + \\max\\!\\big(0,\\, T_{\\mathrm{comm}}(s) - T_{\\mathrm{int}}(s)\\big)}{s}.\n$$\n4. For the specific simulation and machine parameters\n$N_x = 512$, $N_y = 256$, $N_z = 256$, $P_x = 8$, $P_y = 4$, $P_z = 4$ (so that $n_x = n_y = n_z$),\n$n_v = 6$ (three electric and three magnetic field components),\n$\\alpha = 1.0 \\times 10^{-6}$ s, $\\beta = 1.0 \\times 10^{-10}$ s/byte, and $\\gamma = 5.0 \\times 10^{-10}$ s per cell per time step,\ndetermine the integer $s \\in \\{1,2,3,\\dots\\}$ that minimizes $T_{\\mathrm{step}}(s)$ and then compute the corresponding minimal per-step iteration time on one rank.\n\nRound your final numerical answer to four significant figures and express it in milliseconds.", "solution": "The problem requires the derivation of a performance model for a parallel Finite-Difference Time-Domain (FDTD) simulation and the optimization of a temporal blocking parameter, $s$. The solution proceeds by validating the problem statement, deriving the component models for computation and communication, combining them, and then optimizing the resulting cost function for the given parameters.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Global simulation size: $N_x \\times N_y \\times N_z$ grid cells.\n-   MPI process grid size: $P_x \\times P_y \\times P_z$ processes.\n-   Local subdomain size: $n_x \\times n_y \\times n_z$, where $n_x = N_x/P_x$, $n_y = N_y/P_y$, $n_z = N_z/P_z$.\n-   Stencil requirement: Nearest-neighbor halo exchange for the Yee stencil.\n-   Communication cost model: $T_{\\mathrm{msg}} = \\alpha + \\beta m$ for a message of size $m$ bytes.\n-   Latency: $\\alpha$.\n-   Inverse bandwidth: $\\beta$.\n-   Temporal blocking strategy: $s$-step blocking, exchanging a halo of thickness $s$ cells once per $s$ steps.\n-   Computation cost: $\\gamma$ seconds per cell, per time step.\n-   Halo cell data size: $n_v$ double-precision values ($8$ bytes each). Let $b = 8n_v$ bytes per halo cell.\n-   Communication protocol: Six separate face exchanges per $s$-step block.\n-   Provided objective function: $T_{\\mathrm{step}}(s) = \\frac{T_{\\mathrm{comp}}(s) + \\max(0, T_{\\mathrm{comm}}(s) - T_{\\mathrm{int}}(s))}{s}$.\n-   Specific parameters:\n    -   $N_x = 512$, $N_y = 256$, $N_z = 256$.\n    -   $P_x = 8$, $P_y = 4$, $P_z = 4$.\n    -   $n_v = 6$.\n    -   $\\alpha = 1.0 \\times 10^{-6}$ s.\n    -   $\\beta = 1.0 \\times 10^{-10}$ s/byte.\n    -   $\\gamma = 5.0 \\times 10^{-10}$ s per cell per time step.\n-   Task: Find the integer $s \\in \\{1, 2, 3, \\ldots\\}$ that minimizes $T_{\\mathrm{step}}(s)$ and compute this minimal time.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically sound, well-posed, and objective.\n-   **Scientifically Grounded**: The FDTD method, Yee's staggered grid, domain decomposition for parallelization, the $\\alpha$-$\\beta$ communication model, and temporal blocking for communication optimization are all standard and fundamental concepts in computational electromagnetics and high-performance computing. The provided model for overlapping computation and communication is a well-established representation.\n-   **Well-Posed**: The problem is fully specified with all necessary parameters and a clear objective function to minimize. As will be demonstrated, a unique minimum exists for the specified domain of $s$.\n-   **Objective**: The problem is stated in precise mathematical and computational terms, free of ambiguity or subjective language. All parameters are given as concrete values.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\n**1. Total Halo Exchange Time, $T_{\\mathrm{comm}}(s)$**\n\nThe local subdomain on each MPI rank is a rectangular prism of size $n_x \\times n_y \\times n_z$. For an $s$-step blocking strategy, a halo of thickness $s$ cells must be exchanged with each of the six nearest neighbors once per block of $s$ time steps. The problem states this occurs via six separate messages.\n\nThe areas of the faces of the subdomain are $n_y n_z$ (for faces in the $\\pm x$ direction), $n_x n_z$ (for faces in the $\\pm y$ direction), and $n_x n_y$ (for faces in the $\\pm z$ direction). The volume of a halo of thickness $s$ for each face is $s \\times (\\text{face area})$. The amount of data per cell to be communicated is $b = 8n_v$ bytes.\n\nThe message sizes in bytes for each face are:\n-   $m_{yz} = s \\cdot n_y n_z \\cdot b$ (for the two faces perpendicular to the $x$-axis)\n-   $m_{xz} = s \\cdot n_x n_z \\cdot b$ (for the two faces perpendicular to the $y$-axis)\n-   $m_{xy} = s \\cdot n_x n_y \\cdot b$ (for the two faces perpendicular to the $z$-axis)\n\nUsing the $\\alpha$-$\\beta$ model, the cost for one message of size $m$ is $\\alpha + \\beta m$. Since there are two faces of each size, the total communication time per $s$ steps is the sum of the costs for the six messages:\n$$T_{\\mathrm{comm}}(s) = 2(\\alpha + \\beta m_{yz}) + 2(\\alpha + \\beta m_{xz}) + 2(\\alpha + \\beta m_{xy})$$\n$$T_{\\mathrm{comm}}(s) = 6\\alpha + 2\\beta(m_{yz} + m_{xz} + m_{xy})$$\nSubstituting the expressions for the message sizes:\n$$T_{\\mathrm{comm}}(s) = 6\\alpha + 2\\beta s b (n_y n_z + n_x n_z + n_x n_y)$$\n\n**2. Computation Times, $T_{\\mathrm{comp}}(s)$ and $T_{\\mathrm{int}}(s)$**\n\nThe total computation time, $T_{\\mathrm{comp}}(s)$, for $s$ time steps on a subdomain of volume $n_x n_y n_z$ cells, with a computational cost of $\\gamma$ per cell per step, is:\n$$T_{\\mathrm{comp}}(s) = \\gamma \\cdot s \\cdot (n_x n_y n_z)$$\n\nThe overlappable compute time, $T_{\\mathrm{int}}(s)$, corresponds to the computation on cells that do not depend on the halo data within the $s$-step block. The Yee stencil has a data dependency radius of one cell. After $k$ time steps, the computation for cells up to a distance $k$ from the boundary depends on the initial halo data. Thus, after $s$ time steps, any cell within a shell of thickness $s$ from the boundary will have its computation dependent on the halo data.\n\nThe \"interior\" part of the domain, whose computation is independent of the halo data across all $s$ steps, is a smaller prism of size $(n_x - 2s) \\times (n_y - 2s) \\times (n_z - 2s)$. The computation on this volume can be overlapped with the communication. The volume is non-zero only if $n_x, n_y, n_z > 2s$.\nThe overlappable compute time is the time spent on this interior core for all $s$ steps:\n$$T_{\\mathrm{int}}(s) = \\gamma \\cdot s \\cdot \\max(0, n_x - 2s) \\cdot \\max(0, n_y - 2s) \\cdot \\max(0, n_z - 2s)$$\n\n**3. Per-Time-Step Iteration Time, $T_{\\mathrm{step}}(s)$**\n\nSubstituting the derived expressions for $T_{\\mathrm{comp}}(s)$, $T_{\\mathrm{comm}}(s)$, and $T_{\\mathrm{int}}(s)$ into the provided formula gives the per-step time:\n$$T_{\\mathrm{step}}(s) = \\frac{\\gamma s n_x n_y n_z + \\max\\!\\Big(0,\\, 6\\alpha + 2\\beta s b (n_y n_z + n_x n_z + n_x n_y) - \\gamma s \\prod_{i \\in \\{x,y,z\\}} \\max(0, n_i - 2s)\\Big)}{s}$$\nThis can be rewritten as:\n$$T_{\\mathrm{step}}(s) = \\gamma n_x n_y n_z + \\frac{1}{s} \\max\\!\\Big(0,\\, 6\\alpha + 2\\beta s b (n_y n_z + n_x n_z + n_x n_y) - \\gamma s \\prod_{i \\in \\{x,y,z\\}} \\max(0, n_i - 2s)\\Big)$$\n\n**4. Numerical Optimization**\n\nFirst, we compute the problem-specific constants:\n-   $n_x = N_x/P_x = 512/8 = 64$\n-   $n_y = N_y/P_y = 256/4 = 64$\n-   $n_z = N_z/P_z = 256/4 = 64$. Let $n = 64$.\n-   $b = n_v \\times 8 = 6 \\times 8 = 48$ bytes.\n\nThe formulas simplify for the cubic subdomain ($n_x = n_y = n_z = n$):\n-   $T_{\\mathrm{comm}}(s) = 6\\alpha + 6\\beta s b n^2$\n-   $T_{\\mathrm{comp}}(s) = \\gamma s n^3$\n-   $T_{\\mathrm{int}}(s) = \\gamma s (\\max(0, n-2s))^3$\n\nThe per-step time becomes:\n$$T_{\\mathrm{step}}(s) = \\gamma n^3 + \\frac{1}{s}\\max\\Big(0,\\, 6\\alpha + 6\\beta s b n^2 - \\gamma s (\\max(0, n-2s))^3 \\Big)$$\n\nWe must find the integer $s \\ge 1$ that minimizes this function. We analyze two regimes based on the value of $s$ relative to $n/2 = 32$.\n\n**Case 1: $1 \\le s < 32$**\nIn this regime, $n-2s > 0$. The expression simplifies to:\n$$T_{\\mathrm{step}}(s) = \\gamma n^3 + \\frac{1}{s}\\max\\Big(0, 6\\alpha + 6\\beta s b n^2 - \\gamma s (n - 2s)^3\\Big)$$\nLet $O_1(s) = \\frac{1}{s} \\left( 6\\alpha + 6\\beta s b n^2 - \\gamma s (n - 2s)^3 \\right) = \\frac{6\\alpha}{s} + 6\\beta b n^2 - \\gamma(n - 2s)^3$. This is the overhead term, assuming it is positive. We want to find the minimum of $T_{\\mathrm{step}}(s)$, which is equivalent to minimizing $O_1(s)$.\nThe derivative is $O_1'(s) = -\\frac{6\\alpha}{s^2} + 6\\gamma(n-2s)^2$.\nLet's check the sign of the derivative at $s=1$: $O_1'(1) = -6 \\times 10^{-6} + 6(5 \\times 10^{-10})(64-2)^2 = -6 \\times 10^{-6} + 30 \\times 10^{-10} \\times 62^2 = -6 \\times 10^{-6} + 1.1532 \\times 10^{-5} = 5.532 \\times 10^{-6} > 0$.\nSince the derivative of the overhead term is positive at $s=1$, the function is increasing for integer values $s \\ge 1$ in this regime. Thus, the minimum value in this range occurs at $s=1$.\n\nLet's compute $T_{\\mathrm{step}}(1)$:\n$T_{\\mathrm{comp}}(1) = (5 \\times 10^{-10})(1)(64^3) = 1.31072 \\times 10^{-4}$ s.\n$T_{\\mathrm{comm}}(1) = 6(10^{-6}) + 6(10^{-10})(48)(1)(64^2) = 6 \\times 10^{-6} + 1.179648 \\times 10^{-4} = 1.239648 \\times 10^{-4}$ s.\n$T_{\\mathrm{int}}(1) = (5 \\times 10^{-10})(1)(64-2)^3 = (5 \\times 10^{-10})(62^3) = 1.19164 \\times 10^{-4}$ s.\nThe term inside the $\\max$ is $T_{\\mathrm{comm}}(1) - T_{\\mathrm{int}}(1) = 4.8008 \\times 10^{-6} > 0$.\n$T_{\\mathrm{step}}(1) = \\frac{T_{\\mathrm{comp}}(1) + (T_{\\mathrm{comm}}(1) - T_{\\mathrm{int}}(1))}{1} = 1.31072 \\times 10^{-4} + 4.8008 \\times 10^{-6} = 1.358728 \\times 10^{-4}$ s.\n\n**Case 2: $s \\ge 32$**\nIn this regime, $n-2s \\le 0$, so $T_{\\mathrm{int}}(s) = 0$. $T_{\\mathrm{comm}}(s)$ is always positive.\n$$T_{\\mathrm{step}}(s) = \\frac{T_{\\mathrm{comp}}(s) + T_{\\mathrm{comm}}(s)}{s} = \\frac{\\gamma s n^3 + 6\\alpha + 6\\beta s b n^2}{s}$$\n$$T_{\\mathrm{step}}(s) = \\gamma n^3 + 6\\beta b n^2 + \\frac{6\\alpha}{s}$$\nThis function is strictly decreasing for increasing $s$. The infimum is approached as $s \\to \\infty$:\n$$T_{\\mathrm{step}}(\\infty) = \\gamma n^3 + 6\\beta b n^2 = 1.31072 \\times 10^{-4} + 1.179648 \\times 10^{-4} = 2.490368 \\times 10^{-4} \\text{ s}.$$\nAny finite $s$ in this regime will yield a time greater than this infimum. For example, at $s=32$:\n$$T_{\\mathrm{step}}(32) = 2.490368 \\times 10^{-4} + \\frac{6 \\times 10^{-6}}{32} = 2.490368 \\times 10^{-4} + 1.875 \\times 10^{-7} = 2.492243 \\times 10^{-4} \\text{ s}.$$\n\n**Conclusion**\nComparing the optimal value from Case 1 with the values in Case 2:\n-   $T_{\\mathrm{step}}(1) = 1.358728 \\times 10^{-4}$ s.\n-   The infimum for Case 2 is $2.490368 \\times 10^{-4}$ s.\n\nSince $T_{\\mathrm{step}}(1)$ is significantly smaller than the infimum for the regime $s \\ge 32$, the global minimum for integer $s \\ge 1$ occurs at $s=1$.\n\nThe minimal per-step iteration time is $T_{\\mathrm{step}}(1) = 1.358728 \\times 10^{-4}$ s.\nConverting to milliseconds: $1.358728 \\times 10^{-4} \\text{ s} \\times 1000 \\text{ ms/s} = 0.1358728$ ms.\nRounding to four significant figures gives $0.1359$ ms.", "answer": "$$\\boxed{0.1359}$$", "id": "3302053"}, {"introduction": "While explicit methods march in time, frequency-domain and implicit solvers rely on iterative techniques like the Schwarz method to converge to a solution across subdomains. This practice reveals the beautiful connection between the convergence rate of such a numerical algorithm and a physical wave propagation phenomenon. By analyzing the reflection of a plane wave at a model interface, you will learn to predict and quantify the efficiency of the domain decomposition method, a key concept in designing optimized transmission conditions. [@problem_id:3302015]", "problem": "Consider a non-overlapping two-subdomain decomposition of a homogeneous, lossless electromagnetic medium characterized by permittivity $\\epsilon$ and permeability $\\mu$. A time-harmonic plane wave of angular frequency $\\omega$ propagates in the $+x$ direction and is normally incident on the planar subdomain interface at $x=0$. Let the intrinsic wave impedance of the medium be $Z_0 = \\sqrt{\\mu / \\epsilon}$. The Schwarz domain decomposition method uses an impedance-type transmission condition at the interface that enforces a proportionality between the tangential electric and magnetic fields with a real, positive boundary impedance $Z_{\\mathrm{bc}}$.\n\nAssume the incident plane wave has tangential electric field amplitude $E_{\\mathrm{i}}$ and that the corresponding reflected wave amplitude is $E_{\\mathrm{r}}$. The total tangential electric and magnetic fields at the interface are the superposition of the incident and reflected fields. Using only the macroscopic Maxwell equations and the impedance transmission condition at $x=0$, derive the reflection coefficient for normal incidence as a function of $Z_0$ and $Z_{\\mathrm{bc}}$, then use it to compute the ratio of reflected to incident time-averaged energy flux carried by the plane wave at the interface. Interpret this ratio as the residual error energy fraction left on the originating subdomain after one Schwarz iteration, and from it predict the asymptotic energy convergence rate of the Schwarz iteration.\n\nTake $Z_0 = 377\\,\\mathrm{\\Omega}$ and $Z_{\\mathrm{bc}} = 200\\,\\mathrm{\\Omega}$. Report two quantities:\n1. The residual error energy fraction after one Schwarz iteration (dimensionless).\n2. The predicted asymptotic energy convergence rate per iteration (dimensionless).\n\nRound your answers to four significant figures. Express both answers as dimensionless numbers.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **System:** A non-overlapping two-subdomain decomposition of a homogeneous, lossless electromagnetic medium.\n- **Medium Properties:** Permittivity $\\epsilon$, permeability $\\mu$.\n- **Intrinsic Impedance:** $Z_0 = \\sqrt{\\mu / \\epsilon}$.\n- **Wave:** Time-harmonic plane wave, angular frequency $\\omega$.\n- **Propagation:** In the $+x$ direction, normally incident on a planar subdomain interface at $x=0$.\n- **Boundary Condition:** At $x=0$, an impedance-type transmission condition with a real, positive boundary impedance $Z_{\\mathrm{bc}}$ relates the tangential electric and magnetic fields.\n- **Field Amplitudes:** Incident tangential electric field amplitude is $E_{\\mathrm{i}}$; reflected wave amplitude is $E_{\\mathrm{r}}$.\n- **Total Fields:** The total tangential fields at the interface are the superposition of incident and reflected fields.\n- **Given Values:** $Z_0 = 377\\,\\mathrm{\\Omega}$, $Z_{\\mathrm{bc}} = 200\\,\\mathrm{\\Omega}$.\n- **Tasks:**\n    1. Derive the reflection coefficient $\\Gamma = E_{\\mathrm{r}} / E_{\\mathrm{i}}$ as a function of $Z_0$ and $Z_{\\mathrm{bc}}$.\n    2. Compute the ratio of reflected to incident time-averaged energy flux.\n    3. Interpret this ratio as the residual error energy fraction after one Schwarz iteration.\n    4. Predict the asymptotic energy convergence rate of the Schwarz iteration from this ratio.\n    5. Report two numerical quantities: the residual error energy fraction and the asymptotic energy convergence rate, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it is based on Maxwell's equations, plane wave theory, and the Schwarz domain decomposition method, all standard topics in computational electromagnetics. It is well-posed, providing sufficient information to derive a unique solution. The language is objective and the parameters are physically realistic. The connection between the reflection coefficient in a model 1D problem and the convergence rate of an iterative method is a standard analysis technique for domain decomposition methods. The problem is therefore deemed valid.\n\n### Step 3: Derivation and Solution\nLet us model the time-harmonic plane wave propagating in the $+x$ direction. Without loss of generality, we assume the electric field is polarized along the $y$-axis, $\\vec{E} = E_y(x) \\hat{y}$, and the magnetic field is consequently polarized along the $z$-axis, $\\vec{H} = H_z(x) \\hat{z}$. Using complex phasor notation $f(x,t) = \\Re\\{\\tilde{F}(x) \\exp(j\\omega t)\\}$, the fields can be described by their spatial parts.\n\nThe incident wave propagates in the $+x$ direction. The relationship between the electric and magnetic fields is given by the intrinsic impedance $Z_0 = \\sqrt{\\mu/\\epsilon}$.\n$$ \\tilde{E}_y^{\\mathrm{i}}(x) = E_{\\mathrm{i}} \\exp(-jkx) $$\n$$ \\tilde{H}_z^{\\mathrm{i}}(x) = \\frac{1}{Z_0} E_{\\mathrm{i}} \\exp(-jkx) $$\nwhere $k = \\omega\\sqrt{\\mu\\epsilon}$ is the wavenumber and $E_{\\mathrm{i}}$ is the complex amplitude of the incident electric field at $x=0$.\n\nThe reflected wave propagates in the $-x$ direction. Its fields are:\n$$ \\tilde{E}_y^{\\mathrm{r}}(x) = E_{\\mathrm{r}} \\exp(+jkx) $$\n$$ \\tilde{H}_z^{\\mathrm{r}}(x) = -\\frac{1}{Z_0} E_{\\mathrm{r}} \\exp(+jkx) $$\nwhere $E_{\\mathrm{r}}$ is the complex amplitude of the reflected electric field at $x=0$. The negative sign in $\\tilde{H}_z^{\\mathrm{r}}$ ensures that the Poynting vector $\\vec{S}_{\\mathrm{r}} \\sim \\vec{E}_{\\mathrm{r}} \\times \\vec{H}_{\\mathrm{r}}$ points in the $-x$ direction.\n\nAt the interface $x=0$, the total tangential fields are the superposition of the incident and reflected components:\n$$ \\tilde{E}_y^{\\mathrm{tot}}(0) = \\tilde{E}_y^{\\mathrm{i}}(0) + \\tilde{E}_y^{\\mathrm{r}}(0) = E_{\\mathrm{i}} + E_{\\mathrm{r}} $$\n$$ \\tilde{H}_z^{\\mathrm{tot}}(0) = \\tilde{H}_z^{\\mathrm{i}}(0) + \\tilde{H}_z^{\\mathrm{r}}(0) = \\frac{E_{\\mathrm{i}}}{Z_0} - \\frac{E_{\\mathrm{r}}}{Z_0} $$\n\nThe problem specifies an impedance-type transmission condition at the boundary $x=0$. For the domain $x<0$, the outward normal is $\\hat{n} = \\hat{x}$. The impedance condition is generally of the form $\\vec{E}_{\\mathrm{tan}} = -Z_{\\mathrm{bc}}(\\hat{n} \\times \\vec{H}_{\\mathrm{tan}})$.\n$$ \\tilde{E}_y^{\\mathrm{tot}}(0)\\hat{y} = -Z_{\\mathrm{bc}}(\\hat{x} \\times (\\tilde{H}_z^{\\mathrm{tot}}(0)\\hat{z})) = -Z_{\\mathrm{bc}}\\tilde{H}_z^{\\mathrm{tot}}(0)(-\\hat{y}) = Z_{\\mathrm{bc}}\\tilde{H}_z^{\\mathrm{tot}}(0)\\hat{y} $$\nThis simplifies to a scalar relationship between the tangential field components at $x=0$:\n$$ \\tilde{E}_y^{\\mathrm{tot}}(0) = Z_{\\mathrm{bc}} \\tilde{H}_z^{\\mathrm{tot}}(0) $$\nSubstituting the expressions for the total fields:\n$$ E_{\\mathrm{i}} + E_{\\mathrm{r}} = Z_{\\mathrm{bc}} \\left(\\frac{E_{\\mathrm{i}}}{Z_0} - \\frac{E_{\\mathrm{r}}}{Z_0}\\right) $$\nTo find the reflection coefficient $\\Gamma = E_{\\mathrm{r}}/E_{\\mathrm{i}}$, we rearrange the equation to solve for this ratio:\n$$ E_{\\mathrm{i}}Z_0 + E_{\\mathrm{r}}Z_0 = Z_{\\mathrm{bc}}E_{\\mathrm{i}} - Z_{\\mathrm{bc}}E_{\\mathrm{r}} $$\n$$ E_{\\mathrm{r}}(Z_0 + Z_{\\mathrm{bc}}) = E_{\\mathrm{i}}(Z_{\\mathrm{bc}} - Z_0) $$\n$$ \\Gamma = \\frac{E_{\\mathrm{r}}}{E_{\\mathrm{i}}} = \\frac{Z_{\\mathrm{bc}} - Z_0}{Z_{\\mathrm{bc}} + Z_0} $$\n\nNext, we calculate the ratio of the reflected to incident time-averaged energy flux (Poynting vector magnitude). The time-averaged Poynting vector is $\\langle\\vec{S}\\rangle = \\frac{1}{2}\\Re\\{\\tilde{\\vec{E}} \\times \\tilde{\\vec{H}}^*\\}$.\nFor the incident wave, the energy flux is in the $+x$ direction:\n$$ \\langle S_{\\mathrm{i}} \\rangle = \\frac{1}{2}\\Re\\{\\tilde{E}_y^{\\mathrm{i}} (\\tilde{H}_z^{\\mathrm{i}})^*\\} = \\frac{1}{2}\\Re\\left\\{E_{\\mathrm{i}} \\left(\\frac{E_{\\mathrm{i}}}{Z_0}\\right)^*\\right\\} = \\frac{1}{2Z_0^*}|E_{\\mathrm{i}}|^2 $$\nFor the reflected wave, the energy flux is in the $-x$ direction:\n$$ \\langle S_{\\mathrm{r}} \\rangle = \\frac{1}{2}\\Re\\{\\tilde{E}_y^{\\mathrm{r}} (\\tilde{H}_z^{\\mathrm{r}})^*\\} = \\frac{1}{2}\\Re\\left\\{E_{\\mathrm{r}} \\left(-\\frac{E_{\\mathrm{r}}}{Z_0}\\right)^*\\right\\} = \\frac{1}{2Z_0^*}|E_{\\mathrm{r}}|^2 $$\nSince the medium is lossless, $Z_0$ is real ($Z_0^*=Z_0$). The ratio of the magnitudes of the energy fluxes is:\n$$ \\frac{\\langle S_{\\mathrm{r}} \\rangle}{\\langle S_{\\mathrm{i}} \\rangle} = \\frac{\\frac{1}{2Z_0}|E_{\\mathrm{r}}|^2}{\\frac{1}{2Z_0}|E_{\\mathrm{i}}|^2} = \\left|\\frac{E_{\\mathrm{r}}}{E_{\\mathrm{i}}}\\right|^2 = |\\Gamma|^2 $$\n\nThe problem asks to interpret this ratio as the residual error energy fraction after one Schwarz iteration. In the context of the Schwarz method, the incident wave can be viewed as an \"error\" propagating from a neighboring subdomain towards the artificial boundary. The impedance condition models the absorption of this error. The reflected wave represents the part of the error that is not absorbed and is sent back, i.e., the residual error. Thus, the ratio of reflected energy to incident energy, $|\\Gamma|^2$, is indeed the fraction of error energy remaining after one iteration.\n1. The residual error energy fraction is $|\\Gamma|^2$.\n\nThe asymptotic energy convergence rate of an iterative method is the factor by which the energy of the error is reduced at each iteration in the limit of many iterations. For this 1D model problem, the convergence behavior is the same at every step, so the asymptotic rate is equal to the single-step reduction factor.\nTherefore, the predicted asymptotic energy convergence rate is also $|\\Gamma|^2$.\n2. The predicted asymptotic energy convergence rate is $|\\Gamma|^2$.\n\nNow, we substitute the given numerical values $Z_0 = 377\\,\\mathrm{\\Omega}$ and $Z_{\\mathrm{bc}} = 200\\,\\mathrm{\\Omega}$:\n$$ \\Gamma = \\frac{200 - 377}{200 + 377} = \\frac{-177}{577} $$\nBoth required quantities are equal to $|\\Gamma|^2$:\n$$ |\\Gamma|^2 = \\left(\\frac{-177}{577}\\right)^2 = \\left(\\frac{177}{577}\\right)^2 \\approx 0.094099913... $$\nRounding to four significant figures, we get $0.09410$. The trailing zero is significant.\n\nBoth the residual error energy fraction and the predicted asymptotic energy convergence rate are equal to this value.\n- Residual error energy fraction: $0.09410$\n- Predicted asymptotic energy convergence rate: $0.09410$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.09410 & 0.09410\n\\end{pmatrix}\n}\n$$", "id": "3302015"}]}