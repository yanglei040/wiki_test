{"hands_on_practices": [{"introduction": "The fundamental goal of an absorbing boundary condition (ABC) is to allow outgoing waves to leave the computational domain without reflection, effectively simulating an infinitely large space. The ideal relationship for a normally incident plane wave is captured by the Silver-Müller condition, which provides a local relation between the tangential electric and magnetic fields. This first exercise guides you through a foundational analysis to derive the reflection coefficient at a boundary that enforces an impedance condition, revealing the critical principle of impedance matching for achieving perfect absorption [@problem_id:3324491].", "problem": "Consider time-domain Maxwell equations in a homogeneous, isotropic, and non-dispersive medium with permittivity $\\varepsilon$ and permeability $\\mu$,\n$$\n\\nabla \\times \\mathbf{E}(\\mathbf{r},t) = - \\mu \\, \\frac{\\partial \\mathbf{H}(\\mathbf{r},t)}{\\partial t}, \\qquad\n\\nabla \\times \\mathbf{H}(\\mathbf{r},t) = \\varepsilon \\, \\frac{\\partial \\mathbf{E}(\\mathbf{r},t)}{\\partial t},\n$$\nwhere $\\mathbf{E}$ and $\\mathbf{H}$ are the electric and magnetic fields, respectively. The medium has intrinsic impedance $\\eta = \\sqrt{\\mu/\\varepsilon}$ and wave speed $c = 1/\\sqrt{\\mu \\varepsilon}$. A computational domain is truncated by a planar boundary at $z = 0$ with outward unit normal $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$. On this boundary, a local Silver–Müller-based absorbing boundary condition (ABC) is applied in the time domain, written as\n$$\n\\mathbf{E}_{t}(\\mathbf{r},t) = - \\eta_{b} \\, \\hat{\\mathbf{n}} \\times \\mathbf{H}_{t}(\\mathbf{r},t) \\quad \\text{for} \\quad z=0,\n$$\nwhere $\\eta_{b}0$ is a prescribed boundary impedance parameter, and the subscript ${t}$ denotes the tangential component of the field to the boundary.\n\nA linearly polarized plane wave of angular frequency $\\omega$ is normally incident on the boundary from within the computational domain, propagating in the $+\\hat{\\mathbf{z}}$ direction. Its electric field is\n$$\n\\mathbf{E}_{\\text{i}}(\\mathbf{r},t) = \\Re\\!\\left\\{\\mathbf{E}_{0} \\exp\\!\\big(-\\mathrm{i}\\omega t + \\mathrm{i} k z\\big)\\right\\}, \\quad \\mathbf{E}_{0} = E_{0}\\,\\hat{\\mathbf{x}}, \\quad k = \\frac{\\omega}{c},\n$$\nand the corresponding magnetic field satisfies the plane-wave relation $\\mathbf{H}_{\\text{i}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}} \\times \\mathbf{E}_{\\text{i}}$, where $\\hat{\\mathbf{k}} = \\hat{\\mathbf{z}}$ is the unit propagation direction.\n\nAssuming a specular reflected plane wave is generated by the boundary, let $\\Gamma$ denote the complex reflection coefficient (ratio of the reflected to incident electric-field phasor amplitudes at $z=0$). Using only the governing equations and the boundary condition above, derive a closed-form expression for $\\Gamma$ in terms of $\\eta$ and $\\eta_{b}$. Express the final reflection coefficient as a dimensionless complex amplitude. No numerical rounding is required, and no physical units should be included in the final answer.", "solution": "The problem is well-posed and scientifically sound, based on fundamental principles of electromagnetism and standard practices in computational electromagnetics. We may proceed with the solution.\n\nThe problem asks for the complex reflection coefficient $\\Gamma$ for a normally incident plane wave on a boundary defined by a Silver-Müller-type absorbing boundary condition (ABC). The analysis is best performed in the frequency domain using complex phasors.\n\nFirst, we represent the incident and reflected waves in phasor form. The time-domain fields are related to their phasor counterparts $\\tilde{\\mathbf{E}}(\\mathbf{r})$ and $\\tilde{\\mathbf{H}}(\\mathbf{r})$ by $\\mathbf{E}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{E}}(\\mathbf{r}) \\exp(-\\mathrm{i}\\omega t)\\}$ and $\\mathbf{H}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{H}}(\\mathbf{r}) \\exp(-\\mathrm{i}\\omega t)\\}$, where $\\mathrm{i}$ is the imaginary unit.\n\nThe incident electric field phasor, propagating in the $+\\hat{\\mathbf{z}}$ direction, is given by\n$$\n\\tilde{\\mathbf{E}}_{\\text{i}}(\\mathbf{r}) = \\mathbf{E}_{0} \\exp(\\mathrm{i} k z) = E_{0} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{x}}\n$$\nwhere $k = \\omega/c$ is the wavenumber. The corresponding incident magnetic field phasor is found using the plane-wave relationship $\\tilde{\\mathbf{H}}_{\\text{i}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}} \\times \\tilde{\\mathbf{E}}_{\\text{i}}$, where $\\hat{\\mathbf{k}} = \\hat{\\mathbf{z}}$ is the direction of propagation and $\\eta = \\sqrt{\\mu/\\varepsilon}$ is the intrinsic impedance of the medium.\n$$\n\\tilde{\\mathbf{H}}_{\\text{i}}(\\mathbf{r}) = \\frac{1}{\\eta} \\hat{\\mathbf{z}} \\times \\big( E_{0} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{x}} \\big) = \\frac{E_{0}}{\\eta} \\exp(\\mathrm{i} k z) (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = \\frac{E_{0}}{\\eta} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{y}}\n$$\n\nNext, we define the reflected wave, which is assumed to be a specular plane wave. For normal incidence on a planar boundary at $z=0$, the reflected wave propagates in the $-\\hat{\\mathbf{z}}$ direction. The reflection coefficient $\\Gamma$ is the ratio of the reflected electric field phasor amplitude to the incident electric field phasor amplitude at the boundary $z=0$. The reflected electric field phasor is thus\n$$\n\\tilde{\\mathbf{E}}_{\\text{r}}(\\mathbf{r}) = \\Gamma E_{0} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{x}}\n$$\nWe have assumed the polarization of the reflected electric field is the same as the incident one, which is expected for this isotropic boundary condition. The corresponding reflected magnetic field phasor is found using the plane-wave relationship for a wave propagating in the $\\hat{\\mathbf{k}}_\\text{r} = -\\hat{\\mathbf{z}}$ direction: $\\tilde{\\mathbf{H}}_{\\text{r}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}}_\\text{r} \\times \\tilde{\\mathbf{E}}_{\\text{r}}$.\n$$\n\\tilde{\\mathbf{H}}_{\\text{r}}(\\mathbf{r}) = \\frac{1}{\\eta} (-\\hat{\\mathbf{z}}) \\times \\big( \\Gamma E_{0} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{x}} \\big) = -\\frac{\\Gamma E_{0}}{\\eta} \\exp(-\\mathrm{i} k z) (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = -\\frac{\\Gamma E_{0}}{\\eta} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{y}}\n$$\n\nThe total electric and magnetic fields are the superposition of the incident and reflected fields:\n$$\n\\tilde{\\mathbf{E}}(\\mathbf{r}) = \\tilde{\\mathbf{E}}_{\\text{i}}(\\mathbf{r}) + \\tilde{\\mathbf{E}}_{\\text{r}}(\\mathbf{r}) = E_{0} \\big( \\exp(\\mathrm{i} k z) + \\Gamma \\exp(-\\mathrm{i} k z) \\big) \\hat{\\mathbf{x}}\n$$\n$$\n\\tilde{\\mathbf{H}}(\\mathbf{r}) = \\tilde{\\mathbf{H}}_{\\text{i}}(\\mathbf{r}) + \\tilde{\\mathbf{H}}_{\\text{r}}(\\mathbf{r}) = \\frac{E_{0}}{\\eta} \\big( \\exp(\\mathrm{i} k z) - \\Gamma \\exp(-\\mathrm{i} k z) \\big) \\hat{\\mathbf{y}}\n$$\n\nNow, we apply the absorbing boundary condition at the plane $z=0$. The ABC is given in the time domain as\n$$\n\\mathbf{E}_{t}(\\mathbf{r},t) = - \\eta_{b} \\hat{\\mathbf{n}} \\times \\mathbf{H}_{t}(\\mathbf{r},t) \\quad \\text{for} \\quad z=0\n$$\nwhere the subscript $t$ denotes components tangential to the boundary. For a harmonic time dependence $\\exp(-\\mathrm{i}\\omega t)$, this ABC transforms directly to the frequency domain as\n$$\n\\tilde{\\mathbf{E}}_{t}(\\mathbf{r}) = - \\eta_{b} \\hat{\\mathbf{n}} \\times \\tilde{\\mathbf{H}}_{t}(\\mathbf{r}) \\quad \\text{for} \\quad z=0\n$$\nThe outward unit normal is $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$. At the boundary $z=0$, the total fields are\n$$\n\\tilde{\\mathbf{E}}(z=0) = E_{0} (1+\\Gamma) \\hat{\\mathbf{x}}\n$$\n$$\n\\tilde{\\mathbf{H}}(z=0) = \\frac{E_{0}}{\\eta} (1-\\Gamma) \\hat{\\mathbf{y}}\n$$\nSince both $\\tilde{\\mathbf{E}}(z=0)$ and $\\tilde{\\mathbf{H}}(z=0)$ are entirely in the $xy$-plane, they are equal to their tangential components, $\\tilde{\\mathbf{E}}_{t}(z=0)$ and $\\tilde{\\mathbf{H}}_{t}(z=0)$, respectively.\n\nSubstituting these into the phasor-domain ABC:\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = - \\eta_{b} \\, \\hat{\\mathbf{z}} \\times \\left( \\frac{E_{0}}{\\eta} (1-\\Gamma) \\hat{\\mathbf{y}} \\right)\n$$\nWe evaluate the cross product: $\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{y}} = -\\hat{\\mathbf{x}}$.\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = - \\eta_{b} \\frac{E_{0}}{\\eta} (1-\\Gamma) (-\\hat{\\mathbf{x}})\n$$\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = \\frac{\\eta_{b}}{\\eta} E_{0} (1-\\Gamma) \\hat{\\mathbf{x}}\n$$\nSince $E_{0}$ is non-zero, we can cancel the vector term $E_{0}\\hat{\\mathbf{x}}$ from both sides, yielding a scalar equation for $\\Gamma$:\n$$\n1+\\Gamma = \\frac{\\eta_{b}}{\\eta} (1-\\Gamma)\n$$\nWe now solve for $\\Gamma$. Multiplying by $\\eta$:\n$$\n\\eta(1+\\Gamma) = \\eta_{b}(1-\\Gamma)\n$$\n$$\n\\eta + \\eta\\Gamma = \\eta_{b} - \\eta_{b}\\Gamma\n$$\nRearranging the terms to group those with $\\Gamma$:\n$$\n\\eta\\Gamma + \\eta_{b}\\Gamma = \\eta_{b} - \\eta\n$$\n$$\n\\Gamma (\\eta + \\eta_{b}) = \\eta_{b} - \\eta\n$$\nFinally, dividing by $(\\eta + \\eta_{b})$ gives the closed-form expression for the reflection coefficient:\n$$\n\\Gamma = \\frac{\\eta_{b} - \\eta}{\\eta_{b} + \\eta}\n$$\nThis expression is dimensionless and given in terms of the specified parameters $\\eta$ and $\\eta_{b}$. This is the well-known formula for reflection at a boundary with surface impedance $\\eta_b$. The ideal Silver-Müller ABC for perfect absorption of normally incident waves would set $\\eta_b = \\eta$, resulting in $\\Gamma=0$.", "answer": "$$\\boxed{\\frac{\\eta_{b} - \\eta}{\\eta_{b} + \\eta}}$$", "id": "3324491"}, {"introduction": "While perfect impedance matching works for normally incident waves, waves in realistic simulations often strike the boundary from a wide range of angles. This practice explores what happens to the performance of a simple, first-order ABC when the wave is obliquely incident. By analyzing the reflection from a one-way wave operator, you will derive the angle-dependent reflection coefficient and see why its performance degrades significantly at grazing incidence, a key limitation that necessitates the development of more advanced, higher-order ABCs [@problem_id:3324557].", "problem": "Consider a two-dimensional, homogeneous, isotropic, source-free electromagnetic medium with permittivity $\\varepsilon$ and permeability $\\mu$, so that the wave speed is $c = (\\varepsilon \\mu)^{-1/2}$. In such a medium, each Cartesian component of the electric field obeys the scalar wave equation $u_{tt} = c^{2}(u_{xx} + u_{yy})$, where $u(x,y,t)$ denotes a single component of the electric field. Let the computational domain be the half-space $x \\ge 0$ with a planar artificial boundary at $x = 0$, and consider implementing a local Absorbing Boundary Condition (ABC) that enforces the one-way operator on the boundary,\n$$\n(\\partial_{t} - c\\,\\partial_{x})\\,u\\big|_{x=0} = 0.\n$$\nAssume a time-harmonic plane wave of angular frequency $\\omega$ propagates in the interior toward the boundary, with phasor representation and time dependence $\\exp(-\\mathrm{i}\\,\\omega t)$, so that the incident field is\n$$\nu_{i}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(k_{x}x + k_{y}y - \\omega t)\\big),\n$$\nwhere the dispersion relation holds, $k^{2} = k_{x}^{2} + k_{y}^{2} = (\\omega/c)^{2}$. Let the incidence angle $\\theta \\in [0,\\pi/2)$ be measured in radians with respect to the boundary normal (the $+x$ axis), so that $k_{x} = -k\\cos\\theta$ and $k_{y} = k\\sin\\theta$ with $k = \\omega/c$. The total field near the boundary is the superposition $u_{t} = u_{i} + R\\,u_{r}$ of the incident field and a specularly reflected field $u_{r}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(+k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big)$, with reflection coefficient $R(\\theta)$.\n\nStarting from the wave equation and the plane-wave dispersion relation, and using only the boundary operator $(\\partial_{t} - c\\,\\partial_{x})$ at $x=0$, derive the exact closed-form expression for the induced reflection coefficient $R(\\theta)$ solely in terms of $\\sin\\theta$. Then, by asymptotic analysis of your result, determine the leading-order scaling of the reflection magnitude in the grazing-incidence limit $\\theta \\to \\pi/2$ and explain why this behavior exposes a limitation of the one-way operator for local ABCs at grazing incidence.\n\nProvide your final answer as a single closed-form analytic expression for $R(\\theta)$ depending only on $\\sin\\theta$. No numerical approximation is required. Angles must be treated in radians.", "solution": "The electromagnetic field components in a homogeneous isotropic medium satisfy Maxwell's equations. In the absence of sources and with constant material parameters, each Cartesian component of the electric field obeys the scalar wave equation\n$$\nu_{tt} = c^{2}(u_{xx} + u_{yy}),\n$$\nwhere $c = (\\varepsilon \\mu)^{-1/2}$ is the wave speed. A time-harmonic plane wave solution has the form\n$$\nu(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(k_{x}x + k_{y}y - \\omega t)\\big),\n$$\nwith the dispersion relation\n$$\nk^{2} = k_{x}^{2} + k_{y}^{2} = \\left(\\frac{\\omega}{c}\\right)^{2}.\n$$\nLet the planar artificial boundary be at $x=0$ and the computational domain $x \\ge 0$. A local Absorbing Boundary Condition (ABC) derived via one-way operator factorization of the wave operator enforces\n$$\n(\\partial_{t} - c\\,\\partial_{x})\\,u\\big|_{x=0} = 0.\n$$\nThis operator annihilates waves that propagate toward decreasing $x$ (left-moving waves) and is first-order accurate for waves normal to the boundary. To examine reflection for oblique incidence, consider an incident plane wave approaching the boundary from within the domain. The incidence angle $\\theta \\in [0,\\pi/2)$ is defined with respect to the boundary normal ($+x$ axis), and the wavenumber components are\n$$\nk_{x} = -k\\cos\\theta,\\quad k_{y} = k\\sin\\theta,\\quad k = \\frac{\\omega}{c}.\n$$\nThe incident field is\n$$\nu_{i}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(-k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big),\n$$\nand the reflected field, by specular symmetry, is\n$$\nu_{r}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(+k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big).\n$$\nThe total field near the boundary is $u_{t} = u_{i} + R\\,u_{r}$, where $R(\\theta)$ is the complex reflection coefficient we aim to compute. Applying the boundary operator to the total field at $x=0$ yields\n$$\n\\left[(\\partial_{t} - c\\,\\partial_{x})(u_{i} + R\\,u_{r})\\right]_{x=0} = 0.\n$$\nWe compute the derivatives. For the time derivative,\n$$\n\\partial_{t} u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i},\\qquad \\partial_{t} u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r}.\n$$\nFor the spatial derivative along $x$,\n$$\n\\partial_{x} u_{i} = \\mathrm{i}\\,(-k\\cos\\theta)\\,u_{i},\\qquad \\partial_{x} u_{r} = \\mathrm{i}\\,(+k\\cos\\theta)\\,u_{r}.\n$$\nTherefore,\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i} - c\\,\\mathrm{i}\\,(-k\\cos\\theta)\\,u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i} + \\mathrm{i}\\,c\\,k\\cos\\theta\\,u_{i}.\n$$\nSimilarly,\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r} - c\\,\\mathrm{i}\\,(+k\\cos\\theta)\\,u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r} - \\mathrm{i}\\,c\\,k\\cos\\theta\\,u_{r}.\n$$\nUsing $c\\,k = \\omega$, these simplify to\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{i} = -\\mathrm{i}\\,\\omega\\,(1 - \\cos\\theta)\\,u_{i},\\qquad\n(\\partial_{t} - c\\,\\partial_{x})u_{r} = -\\mathrm{i}\\,\\omega\\,(1 + \\cos\\theta)\\,u_{r}.\n$$\nAt $x=0$, the incident and reflected fields share the same phase factor in $y$ and $t$ and have unit amplitude in $x$ since $\\exp(\\mathrm{i}\\,(\\pm k\\cos\\theta\\,x))\\big|_{x=0} = 1$. Denoting $U_{0} = \\exp\\!\\big(\\mathrm{i}\\,(k\\sin\\theta\\,y - \\omega t)\\big)$, we have $u_{i}\\big|_{x=0} = U_{0}$ and $u_{r}\\big|_{x=0} = U_{0}$. The boundary condition becomes\n$$\n-\\mathrm{i}\\,\\omega\\,(1 - \\cos\\theta)\\,U_{0} + R\\,\\big(-\\mathrm{i}\\,\\omega\\,(1 + \\cos\\theta)\\,U_{0}\\big) = 0.\n$$\nDividing by $-\\mathrm{i}\\,\\omega\\,U_{0}$ yields\n$$\n(1 - \\cos\\theta) + R\\,(1 + \\cos\\theta) = 0,\n$$\nso the reflection coefficient is\n$$\nR(\\theta) = -\\,\\frac{1 - \\cos\\theta}{1 + \\cos\\theta}.\n$$\nTo express $R(\\theta)$ solely in terms of $\\sin\\theta$, note that for $\\theta \\in [0,\\pi/2)$, $\\cos\\theta = \\sqrt{1 - \\sin^{2}\\theta}$. Substituting this identity gives\n$$\nR(\\theta) = -\\,\\frac{1 - \\sqrt{1 - \\sin^{2}\\theta}}{1 + \\sqrt{1 - \\sin^{2}\\theta}}.\n$$\nThis is the requested closed-form analytic expression depending only on $\\sin\\theta$.\n\nFor grazing incidence, $\\theta \\to \\pi/2$, so $\\sin\\theta \\to 1$ and hence $\\cos\\theta \\to 0$. From the exact formula,\n$$\nR(\\theta) \\xrightarrow[\\theta \\to \\pi/2]{} -\\,\\frac{1 - 0}{1 + 0} = -1,\n$$\nindicating total reflection in the limit. The leading-order deviation from $-1$ can be obtained by expanding the numerator and denominator for small $\\cos\\theta$,\n$$\n1 + R(\\theta) = \\frac{2\\,\\cos\\theta}{1 + \\cos\\theta} \\sim 2\\,\\cos\\theta \\quad \\text{as} \\quad \\cos\\theta \\to 0.\n$$\nIn terms of $\\sin\\theta$, using $\\cos\\theta = \\sqrt{1 - \\sin^{2}\\theta}$ yields\n$$\n1 + R(\\theta) \\sim 2\\,\\sqrt{1 - \\sin^{2}\\theta} \\quad \\text{as} \\quad \\sin\\theta \\to 1.\n$$\nThus the induced reflection approaches unity for grazing incidence, with the departure from $-1$ scaling like the square root of $1 - \\sin^{2}\\theta$. This exposes a limitation of the local one-way operator ABC: it is exact for normal incidence ($\\theta = 0$ yields $R = 0$), but it becomes highly reflective as the incidence becomes grazing, which is a known deficiency of low-order local ABCs for waves with large tangential wavenumber.", "answer": "$$\\boxed{-\\frac{1 - \\sqrt{1 - \\sin^{2}\\theta}}{1 + \\sqrt{1 - \\sin^{2}\\theta}}}$$", "id": "3324557"}, {"introduction": "Having established the theoretical limitations of simple ABCs in the continuum, we now move to the discrete world of the Finite-Difference Time-Domain (FDTD) method. This hands-on problem allows you to numerically quantify the performance improvement offered by a higher-order boundary condition. By applying the provided discrete update schemes for both a first-order and a second-order Mur ABC, you will calculate and compare their reflection coefficients for an obliquely incident wave, bridging the gap between continuous theory and practical computational results [@problem_id:3324495].", "problem": "Consider a two-dimensional finite-difference time-domain method (FDTD) formulation for the transverse magnetic to $z$-axis polarization ($\\mathrm{TM}_z$), where the nonzero field components are $E_z$, $H_x$, and $H_y$. Let the Yee grid spacings satisfy $\\Delta x = \\Delta y$ and define the Courant number $S$ as $S = c \\Delta t / \\Delta x$, where $c$ is the speed of light. Assume the domain is discretely homogeneous, isotropic, and lossless. Assume a monochromatic discrete plane wave solution in the bulk medium of the form $E_z(m, j, n) = \\Re\\{ \\tilde{E} \\exp(\\mathrm{i} (n \\, \\omega \\Delta t - m \\, k_x \\Delta x - j \\, k_y \\Delta y)) \\}$, where $m, j, n$ are integer indices for $x$, $y$, and time, respectively, and $k_x$, $k_y$, and $\\omega$ denote the discrete wavenumber components and angular frequency. The discrete dispersion relation for the two-dimensional Yee scheme for $\\mathrm{TM}_z$ is the well-tested formula\n$$\n\\sin^2\\!\\left(\\frac{\\omega \\Delta t}{2}\\right) \\;=\\; S^2 \\left[ \\sin^2\\!\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\!\\left(\\frac{k_y \\Delta y}{2}\\right) \\right],\n$$\nwhich you may take as a fundamental base.\n\nWe place a local absorbing boundary normal to the $x$-direction at the plane $m=0$. A discrete plane wave at incidence angle $\\theta$ (defined as the angle between the propagation direction and the boundary normal, i.e., the $+x$-axis) has the phase direction determined by $(k_x, k_y)$, and we define the dimensionless phase components $\\kappa_x = k_x \\Delta x$ and $\\kappa_y = k_y \\Delta y$. For a prescribed angle $\\theta$, choose a dimensionless total wavenumber magnitude $\\kappa$ and set $\\kappa_x = \\kappa \\cos \\theta$ and $\\kappa_y = \\kappa \\sin \\theta$. The discrete angular frequency is then determined by the dispersion via\n$$\n\\sin\\!\\left(\\frac{u}{2}\\right) \\;=\\; S \\,\\sqrt{ \\sin^2\\!\\left(\\frac{\\kappa_x}{2}\\right) + \\sin^2\\!\\left(\\frac{\\kappa_y}{2}\\right) }, \\quad \\text{with } u = \\omega \\Delta t,\n$$\nwith the principal branch $u \\in [0,\\pi]$.\n\nWe consider two local absorbing boundary conditions (ABCs) applied at $m=0$ to the discrete field $E_z$ only:\n\n1) First-order Mur absorbing boundary condition (Mur-1), written in a fully discrete form using only fields at $m=0$ and $m=1$:\n$$\nE_z^{n+1}(0,j) \\;=\\; E_z^{n}(1,j) \\;+\\; r \\left[ E_z^{n+1}(1,j) - E_z^{n}(0,j) \\right],\n$$\nwhere $r = \\dfrac{S - 1}{S + 1}$.\n\n2) A second-order local Mur-type absorbing boundary condition (Mur-2) derived by second-order approximation of the exact one-way operator in the time domain and trapezoidal time integration of the tangential-curvature term, yielding the following explicit boundary update:\n$$\n(1 - \\tfrac{S}{2}) \\, E_z^{n+1}(0,j) \\;+\\; \\tfrac{S}{2} \\, E_z^{n+1}(1,j) \\;=\\; \\left(\\tfrac{S^2}{2}\\right)\\!\\left[E_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1)\\right] \\;+\\; \\left(1 + \\tfrac{S}{2}\\right) E_z^{n}(0,j) \\;-\\; \\tfrac{S}{2} \\, E_z^{n}(1,j).\n$$\nThis update uses only current and immediately previous time-step fields and the nearest tangential neighbors at the boundary.\n\nAssume an obliquely incident discrete plane wave propagating toward the boundary from the interior:\n$$\nE_{z,\\text{inc}}^{n}(m,j) = \\exp\\!\\left( \\mathrm{i} \\left[n u - m \\kappa_x - j \\kappa_y \\right] \\right),\n$$\nand a reflected wave\n$$\nE_{z,\\text{ref}}^{n}(m,j) = R \\,\\exp\\!\\left( \\mathrm{i} \\left[n u + m \\kappa_x - j \\kappa_y \\right] \\right),\n$$\nwith complex reflection coefficient $R$. The total field is $E_z^n = E_{z,\\text{inc}}^n + E_{z,\\text{ref}}^n$. Substitution of this total field into each boundary update at $m=0$ yields a single complex linear equation for $R$ at each angular frequency $u$ and phase components $(\\kappa_x,\\kappa_y)$.\n\nTask. For the incidence angle $\\theta = 60$ degrees (angles must be used in degrees), and fixed dimensionless spatial wavenumber magnitude $\\kappa = \\pi/2$, compute the numerical reflection coefficient magnitudes $\\lvert R \\rvert$ for both Mur-2 and Mur-1 ABCs for several Courant numbers $S$ under the constraint $\\Delta x = \\Delta y$. Use the dispersion relation stated above to determine $u$ from $(S,\\kappa_x,\\kappa_y)$. For each test case, report the pair of floating-point values $[\\lvert R_{\\mathrm{Mur2}}\\rvert, \\lvert R_{\\mathrm{Mur1}}\\rvert]$.\n\nAngle unit specification. Use degrees for $\\theta$.\n\nUnits. No physical units are needed for the final outputs; report all numbers as unitless floating-point values.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a two-element list corresponding to a test case, in the order given below and without spaces. For example: \"[[0.1,0.2],[0.3,0.4]]\".\n\nTest suite. Use the following test cases to ensure coverage across stability-relevant Courant numbers:\n- Case 1 (happy path): $S = 0.5$, $\\theta = 60$ degrees, $\\kappa = \\pi/2$.\n- Case 2 (near-stability edge): $S = 0.7$, $\\theta = 60$ degrees, $\\kappa = \\pi/2$.\n- Case 3 (small time step): $S = 0.3$, $\\theta = 60$ degrees, $\\kappa = \\pi/2$.\n\nAnswer specification. The output must be a single list with three entries, each entry a list of two floats in the order $[\\lvert R_{\\mathrm{Mur2}}\\rvert, \\lvert R_{\\mathrm{Mur1}}\\rvert]$, corresponding to the three cases listed above.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of computational electromagnetics, specifically the finite-difference time-domain (FDTD) method and the analysis of absorbing boundary conditions (ABCs). The problem is well-posed, self-contained, and objective, providing all necessary equations, parameters, and a clear task. The premises are consistent with established theory, and the required calculations are non-trivial but mathematically sound.\n\nThe objective is to determine the magnitude of the complex reflection coefficient $\\lvert R \\rvert$ for two different local absorbing boundary conditions, Mur-$1$ and Mur-$2$, when a discrete plane wave is incident upon them. The analysis is performed by substituting the analytical form of the total field (incident plus reflected waves) into the discrete equations for each ABC. This process yields a complex linear equation for $R$, which can then be solved.\n\nFirst, we define the parameters for a given test case: the Courant number $S$, the incidence angle $\\theta$, and the dimensionless wavenumber magnitude $\\kappa$.\nThe angle $\\theta$ is given in degrees and must be converted to radians for trigonometric functions: $\\theta_{\\text{rad}} = \\theta \\cdot \\pi / 180$.\nThe dimensionless wavenumber components are given by $\\kappa_x = \\kappa \\cos \\theta_{\\text{rad}}$ and $\\kappa_y = \\kappa \\sin \\theta_{\\text{rad}}$.\nThe dimensionless angular frequency $u = \\omega \\Delta t$ is determined from the discrete dispersion relation:\n$$\nu = 2 \\arcsin\\left( S \\sqrt{ \\sin^2\\left(\\frac{\\kappa_x}{2}\\right) + \\sin^2\\left(\\frac{\\kappa_y}{2}\\right) } \\right)\n$$\n\nThe total field $E_z$ is the sum of the incident and reflected waves:\n$$\nE_z^n(m, j) = E_{z,\\text{inc}}^{n}(m,j) + E_{z,\\text{ref}}^{n}(m,j) = \\exp\\left( \\mathrm{i} \\left[n u - m \\kappa_x - j \\kappa_y \\right] \\right) + R \\exp\\left( \\mathrm{i} \\left[n u + m \\kappa_x - j \\kappa_y \\right] \\right)\n$$\nWe can factor out the common temporal and tangential phase term:\n$$\nE_z^n(m, j) = \\exp(\\mathrm{i}(nu - j\\kappa_y)) \\left[ \\exp(-\\mathrm{i}m\\kappa_x) + R \\exp(\\mathrm{i}m\\kappa_x) \\right]\n$$\nLet's define a spatial-dependent part $Z_m = \\exp(-\\mathrm{i}m\\kappa_x) + R \\exp(\\mathrm{i}m\\kappa_x)$. The ABCs are applied at the boundary $m=0$, so we will need the field at $m=0$ and $m=1$:\n$Z_0 = 1 + R$\n$Z_1 = \\exp(-\\mathrm{i}\\kappa_x) + R \\exp(\\mathrm{i}\\kappa_x)$\n\nThe following relations will be used to handle time steps and tangential spatial-shifts:\n$E_z^{n+1}(m, j) = E_z^n(m, j) \\exp(\\mathrm{i}u)$\n$E_z^{n}(m, j \\pm 1) = E_z^n(m, j) \\exp(\\mp \\mathrm{i}\\kappa_y)$\n\n**1. Derivation of Reflection Coefficient for Mur-1 ABC**\n\nThe first-order Mur ABC is given by:\n$$\nE_z^{n+1}(0,j) = E_z^{n}(1,j) + r \\left[ E_z^{n+1}(1,j) - E_z^{n}(0,j) \\right], \\quad \\text{with } r = \\frac{S - 1}{S + 1}\n$$\nRearranging for a more symmetric form:\n$$\n(S+1)E_z^{n+1}(0,j) + (S-1)E_z^{n}(0,j) = (S-1)E_z^{n+1}(1,j) + (S+1)E_z^{n}(1,j)\n$$\nSubstitute the plane wave forms. After dividing by the common phase factor $\\exp(\\mathrm{i}(nu - j\\kappa_y))$, we get an equation in terms of $Z_0$ and $Z_1$:\n$$\n(S+1)Z_0\\exp(\\mathrm{i}u) + (S-1)Z_0 = (S-1)Z_1\\exp(\\mathrm{i}u) + (S+1)Z_1\n$$\n$$\nZ_0 \\left[ (S+1)\\exp(\\mathrm{i}u) + (S-1) \\right] = Z_1 \\left[ (S-1)\\exp(\\mathrm{i}u) + (S+1) \\right]\n$$\nLet $A = (S+1)\\exp(\\mathrm{i}u) + (S-1)$ and $B = (S+1) + (S-1)\\exp(\\mathrm{i}u)$. The equation is $Z_0 A = Z_1 B$.\nSubstitute the expressions for $Z_0$ and $Z_1$:\n$$\n(1+R)A = (\\exp(-\\mathrm{i}\\kappa_x) + R\\exp(\\mathrm{i}\\kappa_x)) B\n$$\nSolving for $R$ gives:\n$$\nA + RA = B\\exp(-\\mathrm{i}\\kappa_x) + RB\\exp(\\mathrm{i}\\kappa_x) \\implies R(A - B\\exp(\\mathrm{i}\\kappa_x)) = B\\exp(-\\mathrm{i}\\kappa_x) - A\n$$\n$$\nR_{\\text{Mur1}} = \\frac{B\\exp(-\\mathrm{i}\\kappa_x) - A}{A - B\\exp(\\mathrm{i}\\kappa_x)}\n$$\n\n**2. Derivation of Reflection Coefficient for Mur-2 ABC**\n\nThe second-order Mur-type ABC is given by:\n$$\n(1 - \\tfrac{S}{2}) E_z^{n+1}(0,j) + \\tfrac{S}{2} E_z^{n+1}(1,j) = \\left(\\tfrac{S^2}{2}\\right)\\!\\left[E_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1)\\right] + \\left(1 + \\tfrac{S}{2}\\right) E_z^{n}(0,j) - \\tfrac{S}{2} E_z^{n}(1,j)\n$$\nFirst, simplify the tangential finite difference term:\n$$\nE_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1) = E_z^n(0,j) (\\exp(-\\mathrm{i}\\kappa_y) - 2 + \\exp(\\mathrm{i}\\kappa_y)) = E_z^n(0,j) (2\\cos\\kappa_y - 2) = -4\\sin^2(\\kappa_y/2)E_z^n(0,j)\n$$\nSubstitute this and the plane wave forms into the ABC. After dividing by $\\exp(\\mathrm{i}(nu-j\\kappa_y))$, we obtain:\n$$\n(1 - \\tfrac{S}{2})Z_0\\exp(\\mathrm{i}u) + \\tfrac{S}{2}Z_1\\exp(\\mathrm{i}u) = \\left(\\tfrac{S^2}{2}\\right)Z_0(-4\\sin^2(\\kappa_y/2)) + \\left(1 + \\tfrac{S}{2}\\right)Z_0 - \\tfrac{S}{2}Z_1\n$$\nCollect terms with $Z_0$ and $Z_1$:\n$$\nZ_1 \\left( \\tfrac{S}{2}\\exp(\\mathrm{i}u) + \\tfrac{S}{2} \\right) = Z_0 \\left[ -2S^2\\sin^2(\\kappa_y/2) + \\left(1 + \\tfrac{S}{2}\\right) - \\left(1 - \\tfrac{S}{2}\\right)\\exp(\\mathrm{i}u) \\right]\n$$\nLet $C = \\tfrac{S}{2}(1 + \\exp(\\mathrm{i}u))$ and $D = -2S^2\\sin^2(\\kappa_y/2) + (1 + \\tfrac{S}{2}) - (1 - \\tfrac{S}{2})\\exp(\\mathrm{i}u)$. The equation is $Z_1 C = Z_0 D$.\nSubstitute the expressions for $Z_0$ and $Z_1$:\n$$\n(\\exp(-\\mathrm{i}\\kappa_x) + R\\exp(\\mathrm{i}\\kappa_x)) C = (1+R) D\n$$\nSolving for $R$ gives:\n$$\nC\\exp(-\\mathrm{i}\\kappa_x) + RC\\exp(\\mathrm{i}\\kappa_x) = D + RD \\implies R(C\\exp(\\mathrm{i}\\kappa_x) - D) = D - C\\exp(-\\mathrm{i}\\kappa_x)\n$$\n$$\nR_{\\text{Mur2}} = \\frac{D - C\\exp(-\\mathrm{i}\\kappa_x)}{C\\exp(\\mathrm{i}\\kappa_x) - D}\n$$\nFor each test case, the parameters $S$, $\\theta$, and $\\kappa$ are used to compute $\\kappa_x$, $\\kappa_y$, and $u$. These are then substituted into the expressions for $R_{\\text{Mur1}}$ and $R_{\\text{Mur2}}$ to find the complex reflection coefficients. The final result is their magnitudes, $\\lvert R_{\\text{Mur1}} \\rvert$ and $\\lvert R_{\\text{Mur2}} \\rvert$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the reflection coefficient magnitudes for Mur-1 and Mur-2 ABCs\n    for specified test cases in a 2D FDTD TMz grid.\n    \"\"\"\n    # Test cases: (S, theta_deg, kappa)\n    test_cases = [\n        (0.5, 60.0, np.pi / 2.0),\n        (0.7, 60.0, np.pi / 2.0),\n        (0.3, 60.0, np.pi / 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        S, theta_deg, kappa = case\n        \n        # Convert angle to radians\n        theta_rad = np.deg2rad(theta_deg)\n        \n        # Calculate dimensionless wavenumber components\n        kappa_x = kappa * np.cos(theta_rad)\n        kappa_y = kappa * np.sin(theta_rad)\n        \n        # Calculate dimensionless angular frequency u from the dispersion relation\n        # Check for stability, although given cases are stable\n        arg_asin = S * np.sqrt(np.sin(kappa_x / 2.0)**2 + np.sin(kappa_y / 2.0)**2)\n        if arg_asin > 1.0:\n            # This should not happen for the given test cases\n            # which are within the FDTD stability limit S = 1/sqrt(2)\n            results.append([np.nan, np.nan]) # Indicate instability\n            continue\n        \n        u = 2.0 * np.arcsin(arg_asin)\n        \n        exp_iu = np.exp(1j * u)\n        exp_i_kx = np.exp(1j * kappa_x)\n        exp_mi_kx = np.exp(-1j * kappa_x)\n\n        # --- Calculate R_Mur1 ---\n        # A = (S+1)exp(iu) + (S-1)\n        # B = (S+1) + (S-1)exp(iu)\n        # R_Mur1 = (B * exp(-i*kappa_x) - A) / (A - B * exp(i*kappa_x))\n        A_mur1 = (S + 1.0) * exp_iu + (S - 1.0)\n        B_mur1 = (S + 1.0) + (S - 1.0) * exp_iu\n        \n        num_mur1 = B_mur1 * exp_mi_kx - A_mur1\n        den_mur1 = A_mur1 - B_mur1 * exp_i_kx\n        \n        R_mur1 = num_mur1 / den_mur1\n        R_mur1_mag = np.abs(R_mur1)\n        \n        # --- Calculate R_Mur2 ---\n        # C = S/2 * (1 + exp(iu))\n        # D = -2*S^2*sin^2(kappa_y/2) + (1 + S/2) - (1 - S/2)*exp(iu)\n        # R_Mur2 = (D - C * exp(-i*kappa_x)) / (C * exp(i*kappa_x) - D)\n        C_mur2 = (S / 2.0) * (1.0 + exp_iu)\n        D_mur2 = -2.0 * S**2 * np.sin(kappa_y / 2.0)**2 + (1.0 + S / 2.0) - (1.0 - S / 2.0) * exp_iu\n\n        num_mur2 = D_mur2 - C_mur2 * exp_mi_kx\n        den_mur2 = C_mur2 * exp_i_kx - D_mur2\n        \n        R_mur2 = num_mur2 / den_mur2\n        R_mur2_mag = np.abs(R_mur2)\n\n        # Append results in the specified order: [|R_Mur2|, |R_Mur1|]\n        results.append([R_mur2_mag, R_mur1_mag])\n\n    # Format the final output string as requested\n    # e.g., \"[[0.1,0.2],[0.3,0.4]]\"\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3324495"}]}