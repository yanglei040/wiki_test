{"hands_on_practices": [{"introduction": "Before we can numerically model a complex material, we must first establish the mathematical form of its constitutive relations. This foundational exercise guides you through deriving the structure of the second-order nonlinear susceptibility tensor, $\\bar{\\bar{\\bar{\\chi}}}^{(2)}$, for a crystal with a specific symmetry group ([@problem_id:3331971]). By applying Neumann's principle, you will see how the macroscopic symmetry of a crystal drastically simplifies its underlying tensor description, a critical skill for building physically accurate and efficient models of nonlinear anisotropic media.", "problem": "A uniaxial crystal belonging to the trigonal point group with threefold rotation and mirror symmetry, denoted $3m$ (also known as $C_{3v}$), is used for frequency doubling (second-harmonic generation). Let the crystallographic (optical) axis coincide with the Cartesian axis $z$, and let $(x,y)$ span the basal plane. In the frequency-domain, the second-order nonlinear polarization $\\mathbf{P}^{(2)}(2\\omega)$ is defined by the second-order electric susceptibility tensor $\\bar{\\bar{\\bar{\\chi}}}^{(2)}$ via the constitutive relation\n$$\nP^{(2)}_{i}(2\\omega) \\;=\\; \\varepsilon_{0}\\,\\chi^{(2)}_{ijk}(-2\\omega;\\omega,\\omega)\\,E_{j}(\\omega)\\,E_{k}(\\omega),\n$$\nwhere $i,j,k\\in\\{x,y,z\\}$ and the Einstein summation convention is used. Assume the nonresonant Kleinman symmetry holds so that $\\chi^{(2)}_{ijk}=\\chi^{(2)}_{ikj}$.\n\n1) Starting from Neumann’s principle (“the symmetry elements of any physical property of a crystal must include the symmetry elements of the crystal’s point group”), impose invariance of $\\chi^{(2)}_{ijk}$ under the generators of $3m$: a rotation by $120^{\\circ}$ about the $z$-axis and a mirror reflection through a vertical plane containing the $z$-axis. Use the tensor transformation law\n$$\n\\chi^{(2)}_{ijk} \\;=\\; R_{ii'}\\,R_{jj'}\\,R_{kk'}\\,\\chi^{(2)}_{i'j'k'}\n$$\nfor each generator with orthogonal matrix $\\bar{\\bar{R}}$, and the intrinsic permutation symmetry in the last two indices, to determine which Cartesian components $\\chi^{(2)}_{ijk}$ can be nonzero and to identify the minimal set of independent coefficients together with any equalities among them. Do not refer to tabulated results; justify each elimination or equality by symmetry.\n\n2) Introduce the contracted notation in which the quadratic field combinations are collected as\n$$\nS \\;=\\; \\big(E_{x}^{2},\\,E_{y}^{2},\\,E_{z}^{2},\\,2E_{y}E_{z},\\,2E_{x}E_{z},\\,2E_{x}E_{y}\\big),\n$$\nand the $3\\times 6$ matrix $\\bar{\\bar{d}}$ is defined by\n$$\nP^{(2)}_{i}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,\\sum_{\\ell=1}^{6} d_{i\\ell}\\,S_{\\ell}.\n$$\nExpress $\\bar{\\bar{\\bar{\\chi}}}^{(2)}$ for the $3m$ crystal in this contracted $d$-tensor form using the conventional crystallographic orientation for class $3m$, explicitly writing the $3\\times 6$ matrix $\\bar{\\bar{d}}$ in terms of its independent coefficients.\n\n3) Now consider a monochromatic plane wave at frequency $\\omega$ propagating along the $+z$-axis with electric field\n$$\n\\mathbf{E}(\\omega) \\;=\\; E_{0}\\,\\big(\\cos\\phi\\,\\hat{\\mathbf{x}} \\;+\\; \\sin\\phi\\,\\hat{\\mathbf{y}}\\big),\n$$\nwith $E_{0}0$ and angle $\\phi\\in[0,2\\pi)$ measured from the $x$-axis in the basal plane. Using your result from part 2, compute the normalized longitudinal second-harmonic polarization\n$$\n\\frac{P^{(2)}_{z}(2\\omega)}{\\varepsilon_{0}\\,E_{0}^{2}}\n$$\nas a single closed-form analytic expression in terms of the independent coefficients of $\\bar{\\bar{d}}$ and the angle $\\phi$, and simplify fully. Provide this normalized scalar as your final answer. No numerical evaluation is required, and no units should be included in your final answer.", "solution": "The problem is well-posed, scientifically grounded, and internally consistent. It is a standard problem in nonlinear optics concerning the application of crystal symmetry to determine the form of the second-order susceptibility tensor.\n\nThe solution is divided into three parts as requested by the problem statement.\n\n### Part 1: Determination of the $\\chi^{(2)}$ Tensor Form for Group $3m$\n\nThe point group $3m$ ($C_{3v}$) is characterized by a threefold rotation axis and a mirror plane parallel to that axis. We align the Cartesian $z$-axis with the threefold rotation axis. For the mirror plane, we choose the $xz$-plane, which is a conventional choice. The generators for the group are thus a rotation $C_3$ by $\\theta = 2\\pi/3$ about the $z$-axis and a reflection $\\sigma_v$ across the $xz$-plane.\n\nAccording to Neumann's principle, the susceptibility tensor $\\bar{\\bar{\\bar{\\chi}}}^{(2)}$ must be invariant under these symmetry operations. The tensor transformation law is given by $\\chi^{(2)}_{ijk} = R_{ii'}R_{jj'}R_{kk'}\\chi^{(2)}_{i'j'k'}$, where $\\bar{\\bar{R}}$ is the matrix representing the symmetry operation.\n\n**A. Invariance under Reflection $\\sigma_v$ (in the $xz$-plane)**\n\nThe reflection operation transforms coordinates as $(x, y, z) \\to (x, -y, z)$. The corresponding transformation matrix is:\n$$\n\\bar{\\bar{R}}_{\\sigma_v} = \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe invariance condition is $\\chi^{(2)}_{ijk} = (R_{\\sigma_v})_{ii'}(R_{\\sigma_v})_{jj'}(R_{\\sigma_v})_{kk'}\\chi^{(2)}_{i'j'k'}$. Since $\\bar{\\bar{R}}_{\\sigma_v}$ is diagonal, this simplifies to $\\chi^{(2)}_{ijk} = (R_{\\sigma_v})_{ii}(R_{\\sigma_v})_{jj}(R_{\\sigma_v})_{kk}\\chi^{(2)}_{ijk}$ (no summation). For a component $\\chi^{(2)}_{ijk}$ to be non-zero, we must have $(R_{\\sigma_v})_{ii}(R_{\\sigma_v})_{jj}(R_{\\sigma_v})_{kk} = 1$.\nThe product is equal to $(-1)^{N_y}$, where $N_y$ is the number of times the index $y$ appears in $(i,j,k)$. Therefore, for $\\chi^{(2)}_{ijk}$ to be non-zero, $N_y$ must be an even number ($0$ or $2$).\n\nThis eliminates all components with an odd number of $y$ indices. For instance:\n- $N_y=1$: $\\chi_{yxx}$, $\\chi_{xxy}$, $\\chi_{xyz}$, etc., must all be zero.\n- $N_y=3$: $\\chi_{yyy}$ must be zero.\n\nThe surviving components (prior to applying $C_3$ symmetry and considering Kleinman symmetry $\\chi^{(2)}_{ijk}=\\chi^{(2)}_{ikj}$) are those with $N_y=0$ or $N_y=2$.\n- $N_y=0$: all indices are from $\\{x, z\\}$, e.g., $\\chi_{xxx}, \\chi_{xxz}, \\chi_{zxz}, \\chi_{zzz}$.\n- $N_y=2$: two indices are $y$, one is from $\\{x, z\\}$, e.g., $\\chi_{xyy}, \\chi_{yxy}, \\chi_{yyx}, \\chi_{zyy}$.\n\n**B. Invariance under Rotation $C_3$ (by $120^\\circ$ about $z$-axis)**\n\nThe rotation matrix for a passive transformation (rotation of the coordinate system) by $\\theta = 2\\pi/3$ is specified as:\n$$\n\\bar{\\bar{R}}_{C_3} = \\begin{pmatrix} \\cos\\theta  \\sin\\theta  0 \\\\ -\\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} -1/2  \\sqrt{3}/2  0 \\\\ -\\sqrt{3}/2  -1/2  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nLet $c = \\cos\\theta = -1/2$ and $s = \\sin\\theta = \\sqrt{3}/2$. We apply the invariance condition $\\chi^{(2)}_{ijk} = R_{ii'}R_{jj'}R_{kk'}\\chi^{(2)}_{i'j'k'}$ to the components that survived the $\\sigma_v$ reflection symmetry.\n\n1.  **Components involving only $z$:**\n    $\\chi'_{zzz} = R_{zz}R_{zz}R_{zz}\\chi_{zzz} = (1)^3 \\chi_{zzz} = \\chi_{zzz}$. So $\\chi_{zzz}$ is an independent, non-zero component.\n\n2.  **Components relating $\\{x,y\\}$ to $z$:**\n    Consider $\\chi_{zxx}$. The transformed component is $\\chi'_{zxx} = R_{zi'} R_{xj'} R_{xk'} \\chi_{i'j'k'}$. Since $R_{zi'}=\\delta_{zi'}$, this is $\\chi'_{zxx} = R_{xj'} R_{xk'} \\chi_{zj'k'}$. Expanding over $j', k' \\in \\{x,y\\}$ (as $z$ components do not mix with $xy$ under this rotation):\n    $\\chi'_{zxx} = R_{xx}^2 \\chi_{zxx} + R_{xy}^2 \\chi_{zyy} + R_{xx}R_{xy}(\\chi_{zxy}+\\chi_{zyx})$.\n    From $\\sigma_v$ symmetry, $\\chi_{zxy}$ and $\\chi_{zyx}$ are zero ($N_y=1$).\n    $\\chi'_{zxx} = c^2 \\chi_{zxx} + s^2 \\chi_{zyy}$. Invariance requires $\\chi_{zxx} = c^2 \\chi_{zxx} + s^2 \\chi_{zyy}$, which gives $\\chi_{zxx}(1-c^2) = s^2 \\chi_{zyy}$. Since $s^2=1-c^2$, this simplifies to $\\chi_{zxx} = \\chi_{zyy}$.\n    A similar calculation for $\\chi'_{zyy}$ confirms this relationship.\n\n    Consider $\\chi_{xxz}$. Due to Kleinman symmetry, $\\chi_{xxz} = \\chi_{xzx}$.\n    $\\chi'_{xxz} = R_{xi'}R_{xj'}R_{zk'} \\chi_{i'j'k'} = R_{xi'}R_{xj'} \\chi_{i'j'z}$.\n    $\\chi'_{xxz} = R_{xx}^2 \\chi_{xxz} + R_{xy}^2 \\chi_{yyz} + R_{xx}R_{xy}(\\chi_{xyz}+\\chi_{yxz})$. Components with one $y$ are zero, so $\\chi'_{xxz} = c^2 \\chi_{xxz} + s^2 \\chi_{yyz}$. Invariance gives $\\chi_{xxz} = \\chi_{yyz}$.\n\n    Consider $\\chi_{xzz}$. $\\chi'_{xzz} = R_{xi'}R_{zj'}R_{zk'} \\chi_{i'zz} = R_{xi'} \\chi_{i'zz} = c\\chi_{xzz} + s\\chi_{yzz}$. From $\\sigma_v$, $\\chi_{yzz}=0$ ($N_y=1$). So $\\chi'_{xzz} = c\\chi_{xzz}$. Since $c \\ne 1$, this requires $\\chi_{xzz}=0$.\n\n    Consider $\\chi_{zxz}$. $\\chi'_{zxz} = R_{zi'}R_{xj'}R_{zk'} \\chi_{i'j'k'} = R_{xj'} \\chi_{zj'z} = c\\chi_{zxz} + s\\chi_{zyz}$. From $\\sigma_v$, $\\chi_{zyz}=0$ ($N_y=1$). So $\\chi'_{zxz} = c\\chi_{zxz}$, which implies $\\chi_{zxz}=0$.\n\n3.  **Components involving only $x, y$:**\n    Consider the system for $\\chi_{xxx}, \\chi_{xyy}, \\chi_{yyx}$ (note $\\chi_{yxy}=\\chi_{yyx}$ by Kleinman, and others like $\\chi_{xxy}$ are zero from $\\sigma_v$).\n    $\\chi'_{xxx} = c^3 \\chi_{xxx} + cs^2(\\chi_{xyy} + 2\\chi_{yyx})$. Invariance gives $\\chi_{xxx}(1-c^3) = cs^2(\\chi_{xyy} + 2\\chi_{yyx})$. With $c=-1/2, s^2=3/4$, this becomes $3\\chi_{xxx} = -(\\chi_{xyy} + 2\\chi_{yyx})$.\n    $\\chi'_{xyy} = cs^2\\chi_{xxx} + c^3\\chi_{xyy} - 2cs^2\\chi_{yyx}$. Invariance gives $\\chi_{xyy}(1-c^3) = cs^2\\chi_{xxx} - 2cs^2\\chi_{yyx}$, which becomes $3\\chi_{xyy} = -\\chi_{xxx} + 2\\chi_{yyx}$.\n    Solving this system of two linear equations:\n    From the second equation, $\\chi_{xxx} = 2\\chi_{yyx} - 3\\chi_{xyy}$. Substituting into the first:\n    $3(2\\chi_{yyx} - 3\\chi_{xyy}) = -\\chi_{xyy} - 2\\chi_{yyx} \\implies 6\\chi_{yyx} - 9\\chi_{xyy} = -\\chi_{xyy} - 2\\chi_{yyx}$.\n    $8\\chi_{yyx} = 8\\chi_{xyy} \\implies \\chi_{yyx} = \\chi_{xyy}$.\n    Substituting this back: $\\chi_{xxx} = 2\\chi_{xyy} - 3\\chi_{xyy} = -\\chi_{xyy}$.\n\n**Summary of independent non-zero components of $\\chi^{(2)}$:**\nWe choose the set of independent coefficients to be $\\chi_{xxx}$, $\\chi_{xxz}$, $\\chi_{zxx}$, and $\\chi_{zzz}$. All other non-zero components are related to these:\n- $\\chi_{xyy} = -\\chi_{xxx}$\n- $\\chi_{yyx} = \\chi_{yxy} = \\chi_{xyy} = -\\chi_{xxx}$\n- $\\chi_{yyz} = \\chi_{yzy} = \\chi_{xxz}$\n- $\\chi_{zyy} = \\chi_{zxx}$\n- All other components are zero, including $\\chi_{xzz}=0$, $\\chi_{zxz}=0$.\n\n### Part 2: Contracted $d$-Tensor Form\n\nThe relation between the $\\chi^{(2)}_{ijk}$ tensor and the $d_{i\\ell}$ matrix is given by comparing the two forms of the constitutive relation, respecting Kleinman symmetry.\n$P_i = \\varepsilon_{0} \\sum_{j,k} \\chi_{ijk} E_j E_k = \\varepsilon_0 (\\chi_{ixx}E_x^2 + \\chi_{iyy}E_y^2 + \\chi_{izz}E_z^2 + 2\\chi_{iyz}E_yE_z + 2\\chi_{ixz}E_xE_z + 2\\chi_{ixy}E_xE_y)$\n$P_i = 2\\varepsilon_{0} \\sum_{\\ell} d_{i\\ell} S_{\\ell} = 2\\varepsilon_0 (d_{i1}E_x^2 + d_{i2}E_y^2 + d_{i3}E_z^2 + 2d_{i4}E_yE_z + 2d_{i5}E_xE_z + 2d_{i6}E_xE_y)$\nComparing coefficients gives the mapping:\n$\\chi_{ixx}=2d_{i1}$, $\\chi_{iyy}=2d_{i2}$, $\\chi_{izz}=2d_{i3}$\n$\\chi_{iyz}=2d_{i4}$, $\\chi_{ixz}=2d_{i5}$, $\\chi_{ixy}=2d_{i6}$\n\nUsing the relationships derived in Part 1 for $\\chi^{(2)}_{ijk}$:\n- $\\chi_{xxx} = 2d_{11}$\n- $\\chi_{xyy} = 2d_{12} \\implies 2d_{12} = -\\chi_{xxx} = -2d_{11} \\implies d_{12}=-d_{11}$.\n- $\\chi_{xzz} = 2d_{13} \\implies 2d_{13} = 0 \\implies d_{13}=0$.\n- $\\chi_{yyz} = 2d_{24}$ and $\\chi_{xxz} = 2d_{15}$. The relation $\\chi_{xxz}=\\chi_{yyz}$ implies $d_{15}=d_{24}$.\n- $\\chi_{ixy} = 2d_{i6}$. So $\\chi_{yxy} = 2d_{26}$. We have $\\chi_{yxy} = -\\chi_{xxx}$, so $2d_{26} = -2d_{11} \\implies d_{26}=-d_{11}$.\n- $\\chi_{zxx} = 2d_{31}$ and $\\chi_{zyy} = 2d_{32}$. The relation $\\chi_{zxx}=\\chi_{zyy}$ implies $d_{31}=d_{32}$.\n- $\\chi_{zxz} = 2d_{35}$ (via Kleinman $\\chi_{zxz}=\\chi_{zzx}$). We found $\\chi_{zxz}=0$, so $d_{35}=0$.\n- $\\chi_{zzz}=2d_{33}$ is an independent coefficient.\n- All other coefficients are zero based on the $\\sigma_v$ symmetry zeros. For example, $d_{14} \\propto \\chi_{xyz}=0$, $d_{21} \\propto \\chi_{yxx}=0$, $d_{22} \\propto \\chi_{yyy}=0$.\n\nAssembling these results into the $3 \\times 6$ matrix $\\bar{\\bar{d}}$:\n$$\n\\bar{\\bar{d}} = \\begin{pmatrix} d_{11}  d_{12}  d_{13}  d_{14}  d_{15}  d_{16} \\\\ d_{21}  d_{22}  d_{23}  d_{24}  d_{25}  d_{26} \\\\ d_{31}  d_{32}  d_{33}  d_{34}  d_{35}  d_{36} \\end{pmatrix} = \\begin{pmatrix} d_{11}  -d_{11}  0  0  d_{15}  0 \\\\ 0  0  0  d_{15}  0  -d_{11} \\\\ d_{31}  d_{31}  d_{33}  0  0  0 \\end{pmatrix}\n$$\nThe minimal set of independent coefficients can be denoted as $d_{11}$, $d_{15}$, $d_{31}$, and $d_{33}$.\n\n### Part 3: Calculation of Normalized Longitudinal Polarization\n\nThe incident electric field is given as $\\mathbf{E}(\\omega) = E_{0}(\\cos\\phi\\,\\hat{\\mathbf{x}} + \\sin\\phi\\,\\hat{\\mathbf{y}})$. The field components are:\n$E_x=E_0\\cos\\phi$, $E_y=E_0\\sin\\phi$, $E_z=0$.\n\nThe quadratic field combinations vector $\\bar{S}$ is:\n$S_1 = E_x^2 = E_0^2 \\cos^2\\phi$\n$S_2 = E_y^2 = E_0^2 \\sin^2\\phi$\n$S_3 = E_z^2 = 0$\n$S_4 = 2E_yE_z = 0$\n$S_5 = 2E_xE_z = 0$\n$S_6 = 2E_xE_y = 2E_0^2\\cos\\phi\\sin\\phi = E_0^2\\sin(2\\phi)$\n\nWe need to compute the longitudinal second-harmonic polarization, $P^{(2)}_z(2\\omega)$. The formula is:\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,\\sum_{\\ell=1}^{6} d_{3\\ell}\\,S_{\\ell}\n$$\nUsing the third row of the derived $\\bar{\\bar{d}}$ matrix, which is $(d_{31}, d_{31}, d_{33}, 0, 0, 0)$:\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,(d_{31}S_1 + d_{31}S_2 + d_{33}S_3 + 0\\cdot S_4 + 0\\cdot S_5 + 0\\cdot S_6)\n$$\nSubstituting the expressions for $S_\\ell$:\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,\\left(d_{31}(E_0^2 \\cos^2\\phi) + d_{31}(E_0^2 \\sin^2\\phi) + d_{33}(0)\\right)\n$$\nFactoring out common terms:\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,d_{31}E_0^2 (\\cos^2\\phi + \\sin^2\\phi)\n$$\nUsing the trigonometric identity $\\cos^2\\phi+\\sin^2\\phi=1$:\n$$\nP^{(2)}_{z}(2\\omega) \\;=\\; 2\\,\\varepsilon_{0}\\,d_{31}E_0^2\n$$\nThe result is independent of the polarization angle $\\phi$. This is a direct consequence of the threefold symmetry about the $z$-axis, which requires the coefficients for $E_x^2$ ($d_{31}$) and $E_y^2$ ($d_{32}$) to be equal in the generation of $P_z^{(2)}$.\n\nFinally, we compute the required normalized quantity:\n$$\n\\frac{P^{(2)}_{z}(2\\omega)}{\\varepsilon_{0}\\,E_{0}^{2}} = \\frac{2\\,\\varepsilon_{0}\\,d_{31}E_0^2}{\\varepsilon_{0}\\,E_{0}^{2}} = 2d_{31}\n$$", "answer": "$$\n\\boxed{2d_{31}}\n$$", "id": "3331971"}, {"introduction": "Translating a tensor model into a predictive, time-domain simulation requires robust numerical implementation. This practice focuses on the Kerr effect, a common intensity-dependent nonlinearity, and challenges you to construct a complete Finite-Difference Time-Domain (FDTD) scheme ([@problem_id:3331925]). You will tackle the core difficulty of implicit constitutive relations by implementing a Newton-Raphson solver within the FDTD loop and analyze the scheme's stability, providing a practical blueprint for simulating nonlinear wave phenomena.", "problem": "Consider a one-dimensional transverse electric configuration in computational electromagnetics with periodic boundary conditions, where the electric field component $E_y(x,t)$ is coupled to the magnetic field component $H_z(x,t)$. The material is Kerr-type anisotropic in the sense that its electric displacement $\\mathbf{D}$ depends nonlinearly and componentwise on $\\mathbf{E}$ through a tensor-valued permittivity $\\boldsymbol{\\epsilon}(\\mathbf{E})=\\boldsymbol{\\epsilon}_0+\\alpha\\,\\mathrm{diag}(E_x^2,E_y^2,E_z^2)$. In the present one-dimensional transverse electric configuration, assume $E_x=0$ and $E_z=0$ so that the only nonzero displacement component is $D_y(x,t)$, with the constitutive relation $D_y=\\epsilon_y(E_y)\\,E_y$ and\n$$\n\\epsilon_y(E_y)=\\epsilon_y+\\alpha E_y^2,\n$$\nwhere $\\epsilon_y$ is the constant baseline permittivity along the $y$ axis (a component of the anisotropic baseline tensor $\\boldsymbol{\\epsilon}_0$) and $\\alpha$ is the Kerr nonlinearity coefficient. The magnetic response is linear and isotropic with $B_z=\\mu_0 H_z$, where $\\mu_0$ is the vacuum permeability.\n\nStarting from Maxwell’s equations in differential form,\n$$\n\\nabla \\times \\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t},\\qquad \\nabla \\times \\mathbf{H}=\\frac{\\partial \\mathbf{D}}{\\partial t},\n$$\nderive a Yee-like finite-difference time-domain scheme for the pair $(E_y,H_z)$ on a uniform grid of $N_x$ points over a domain of length $L$ with periodic boundary conditions. Use a leapfrog staggering in time so that $H_z$ is updated at half time-steps and $D_y$ at integer time-steps. Specifically:\n\n- Express the discrete updates for $H_z$ and $D_y$ in terms of spatial finite differences with spacing $\\Delta x=L/N_x$ and time step $\\Delta t$, ensuring consistency with the curl relations in one spatial dimension.\n\n- Because the constitutive relation $D_y=\\epsilon_y(E_y) E_y=\\epsilon_y E_y + \\alpha E_y^3$ is nonlinear in $E_y$, formulate and implement a Newton predictor-corrector step at each grid point to compute $E_y^{n+1}$ from the updated $D_y^{n+1}$. That is, for each node, solve the scalar nonlinear equation\n$$\nf(E)=\\alpha E^3+\\epsilon_y E - D_y^{n+1}=0\n$$\nusing:\n  1. A predictor obtained by one Newton iteration starting from the previous electric field iterate $E_y^n$, and\n  2. A corrector obtained by continuing Newton iterations until a prescribed tolerance is met.\n\nPresent a stability analysis for this Yee-like scheme with the nonlinear update, by linearizing the constitutive relation about a nonzero operating field amplitude $E_0$ to define an effective permittivity\n$$\n\\epsilon_{\\mathrm{eff}}(E_0)=\\epsilon_y+3\\alpha E_0^2,\n$$\nand then deriving a Courant–Friedrichs–Lewy (CFL) bound on $\\Delta t$ such that the discrete energy\n$$\n\\mathcal{E}^n=\\sum_{i=0}^{N_x-1}\\frac{1}{2}\\left(E_{y,i}^n D_{y,i}^n+\\mu_0 H_{z,i}^{n+\\frac{1}{2}} H_{z,i}^{n+\\frac{1}{2}}\\right)\\Delta x\n$$\nremains bounded. Provide the reasoning from Maxwell’s equations and the discrete update structure to argue the appropriate time-step restriction in terms of $\\Delta x$, $\\mu_0$, and an admissible bound on $\\epsilon_{\\mathrm{eff}}$.\n\nImplement the above scheme as a runnable program that performs the following numerical experiment for a set of test cases. For each test case, initialize $E_y(x,0)$ as a Gaussian pulse centered at $x=L/2$ with amplitude $A$ and width $w=L/10$, that is,\n$$\nE_y(x,0)=A\\exp\\left(-\\frac{(x-L/2)^2}{w^2}\\right),\n$$\nand set $H_z(x,-\\Delta t/2)=0$. Initialize $D_y(x,0)=\\epsilon_y E_y(x,0)+\\alpha E_y(x,0)^3$. Advance the solution for $N_{\\mathrm{steps}}$ steps using the Yee-like updates with the Newton predictor-corrector rule. Define stability for each run as follows: the run is stable if all field values remain finite and the maximum discrete energy over all time steps is less than $1.5$ times the initial energy, and unstable otherwise.\n\nUse the International System of Units, with $\\Delta x$ expressed in meters, $\\Delta t$ in seconds, field amplitudes in volts per meter, permittivities in farads per meter, and permeabilities in henries per meter. The vacuum constants are $\\epsilon_0=8.854187817\\times10^{-12}\\,\\mathrm{F/m}$ and $\\mu_0=4\\pi\\times10^{-7}\\,\\mathrm{H/m}$. The baseline anisotropic permittivity component $\\epsilon_y$ is given by $\\epsilon_y=\\epsilon_0 \\epsilon_{r,y}$, where $\\epsilon_{r,y}$ is a dimensionless relative permittivity along $y$.\n\nTest Suite:\nFor each test case, the program must construct $\\Delta t$ from a specified scaling factor $s$ relative to the linear CFL bound based on $\\epsilon_y$, namely\n$$\n\\Delta t = s\\frac{\\Delta x}{v_{\\mathrm{base}}},\\qquad v_{\\mathrm{base}}=\\frac{1}{\\sqrt{\\mu_0 \\epsilon_y}}.\n$$\nRun each case for the specified number of steps $N_{\\mathrm{steps}}$ and report stability.\n\n- Case 1 (happy path): $N_x=400$, $L=1.0$ m, $\\epsilon_{r,y}=2.25$, $\\alpha=+1.0\\times 10^{-24}\\,\\mathrm{F\\cdot m/V^2}$, $A=1.0\\times 10^{6}\\,\\mathrm{V/m}$, $s=0.90$, $N_{\\mathrm{steps}}=800$.\n\n- Case 2 (violated CFL, expect instability): $N_x=400$, $L=1.0$ m, $\\epsilon_{r,y}=2.25$, $\\alpha=+1.0\\times 10^{-24}\\,\\mathrm{F\\cdot m/V^2}$, $A=1.0\\times 10^{6}\\,\\mathrm{V/m}$, $s=1.10$, $N_{\\mathrm{steps}}=600$.\n\n- Case 3 (negative nonlinearity, conservative step): $N_x=400$, $L=1.0$ m, $\\epsilon_{r,y}=2.25$, $\\alpha=-5.0\\times 10^{-25}\\,\\mathrm{F\\cdot m/V^2}$, $A=4.0\\times 10^{6}\\,\\mathrm{V/m}$, $s=0.50$, $N_{\\mathrm{steps}}=800$.\n\n- Case 4 (negative nonlinearity, aggressive step, expect instability): $N_x=400$, $L=1.0$ m, $\\epsilon_{r,y}=2.25$, $\\alpha=-5.0\\times 10^{-25}\\,\\mathrm{F\\cdot m/V^2}$, $A=4.0\\times 10^{6}\\,\\mathrm{V/m}$, $s=0.95$, $N_{\\mathrm{steps}}=800$.\n\nYour program should produce a single line of output containing the stability results for the four test cases as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,False]\").", "solution": "The problem is scientifically grounded, well-posed, and objective. It specifies a standard numerical experiment in computational electromagnetics, involving the simulation of a nonlinear, anisotropic medium using the Finite-Difference Time-Domain (FDTD) method. All parameters, equations, and conditions are clearly defined. I will proceed with a full solution.\n\nThe solution is presented in three parts: first, the derivation of the FDTD update equations from Maxwell's equations; second, a stability analysis of the resulting scheme; and third, an explanation of the numerical implementation.\n\n### 1. Derivation of the FDTD Scheme\n\nWe begin with Maxwell's curl equations in a source-free medium:\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\nThe problem specifies a one-dimensional transverse electric (TE) configuration, where fields vary only in the $x$ direction. The nonzero field components are $E_y(x,t)$ and $H_z(x,t)$, so $\\mathbf{E} = E_y \\hat{\\mathbf{y}}$ and $\\mathbf{H} = H_z \\hat{\\mathbf{z}}$. The constitutive relations are given as $B_z = \\mu_0 H_z$ and $D_y = (\\epsilon_y + \\alpha E_y^2) E_y$.\n\nUnder these conditions, the curl operators simplify.\nFor the first equation (Faraday's Law):\n$$\n\\nabla \\times \\mathbf{E} =\n\\begin{vmatrix}\n\\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\\n\\partial_x  \\partial_y  \\partial_z \\\\\n0  E_y  0\n\\end{vmatrix}\n= -\\frac{\\partial E_y}{\\partial x} \\hat{\\mathbf{z}}\n$$\nEquating the $\\hat{\\mathbf{z}}$ components and substituting $B_z = \\mu_0 H_z$, we get:\n$$\n-\\frac{\\partial E_y}{\\partial x} = -\\mu_0 \\frac{\\partial H_z}{\\partial t} \\implies \\mu_0 \\frac{\\partial H_z}{\\partial t} = \\frac{\\partial E_y}{\\partial x}\n$$\nFor the second equation (Ampere's Law):\n$$\n\\nabla \\times \\mathbf{H} =\n\\begin{vmatrix}\n\\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\\n\\partial_x  \\partial_y  \\partial_z \\\\\n0  0  H_z\n\\end{vmatrix}\n= -\\frac{\\partial H_z}{\\partial x} \\hat{\\mathbf{y}}\n$$\nEquating the $\\hat{\\mathbf{y}}$ components, we get:\n$$\n\\frac{\\partial D_y}{\\partial t} = -\\frac{\\partial H_z}{\\partial x}\n$$\nWe now discretize these two coupled partial differential equations on a uniform grid. Following the Yee-like leapfrog scheme, we evaluate $E_y$ and $D_y$ at integer spatial-grid points $i$ and integer time-steps $n$, denoted $E_{y,i}^n$ and $D_{y,i}^n$. The magnetic field $H_z$ is evaluated at half-integer spatial points $i+1/2$ and half-integer time-steps $n+1/2$, denoted $H_{z,i+1/2}^{n+1/2}$. The grid spacing is $\\Delta x=L/N_x$ and the time step is $\\Delta t$.\n\nUsing central difference approximations:\nThe $H_z$ update equation is derived by evaluating Faraday's Law at $(i+1/2, n)$:\n$$\n\\mu_0 \\frac{H_{z,i+1/2}^{n+1/2} - H_{z,i+1/2}^{n-1/2}}{\\Delta t} = \\frac{E_{y,i+1}^n - E_{y,i}^n}{\\Delta x}\n$$\nThis yields the update rule for $H_z$:\n$$\nH_{z,i+1/2}^{n+1/2} = H_{z,i+1/2}^{n-1/2} + \\frac{\\Delta t}{\\mu_0 \\Delta x} (E_{y,i+1}^n - E_{y,i}^n)\n$$\nThe $D_y$ update equation is derived by evaluating Ampere's Law at $(i, n+1/2)$:\n$$\n\\frac{D_{y,i}^{n+1} - D_{y,i}^n}{\\Delta t} = - \\frac{H_{z,i+1/2}^{n+1/2} - H_{z,i-1/2}^{n+1/2}}{\\Delta x}\n$$\nThis yields the update rule for $D_y$:\n$$\nD_{y,i}^{n+1} = D_{y,i}^n - \\frac{\\Delta t}{\\Delta x} (H_{z,i+1/2}^{n+1/2} - H_{z,i-1/2}^{n+1/2})\n$$\nAfter obtaining $D_{y,i}^{n+1}$, we must find the corresponding $E_{y,i}^{n+1}$ by solving the nonlinear scalar cubic equation:\n$$\nf(E) = \\alpha E^3 + \\epsilon_y E - D_{y,i}^{n+1} = 0\n$$\nThis is done using Newton's method, which iteratively refines a guess $E_k$ for the root:\n$$\nE_{k+1} = E_k - \\frac{f(E_k)}{f'(E_k)} = E_k - \\frac{\\alpha E_k^3 + \\epsilon_y E_k - D_{y,i}^{n+1}}{3\\alpha E_k^2 + \\epsilon_y}\n$$\nAs required, the scheme uses a predictor-corrector approach. The predictor is the first iteration, starting with $E_k = E_{y,i}^n$. The corrector consists of subsequent iterations until the change $|E_{k+1} - E_k|$ falls below a specified tolerance.\n\n### 2. Stability Analysis\n\nTo derive the Courant–Friedrichs–Lewy (CFL) condition, we linearize the system's response around a constant operating field amplitude $E_0$. The constitutive relation is $D_y = \\epsilon_y E_y + \\alpha E_y^3$. The small-signal (differential) permittivity is:\n$$\n\\epsilon_{\\mathrm{eff}} = \\frac{dD_y}{dE_y} \\bigg|_{E_0} = \\epsilon_y + 3\\alpha E_0^2\n$$\nThis $\\epsilon_{\\mathrm{eff}}$ governs the propagation speed of small perturbations, $v_{\\mathrm{eff}} = 1/\\sqrt{\\mu_0 \\epsilon_{\\mathrm{eff}}}$.\nFor the FDTD scheme to be stable, the numerical propagation speed, $\\Delta x / \\Delta t$, must be at least as great as the physical propagation speed of any wave in the system. The stability is dictated by the highest possible wave speed, which corresponds to the minimum positive value of $\\epsilon_{\\mathrm{eff}}$.\n$$\n\\frac{\\Delta x}{\\Delta t} \\ge \\max(v_{\\mathrm{eff}}) = \\frac{1}{\\sqrt{\\mu_0 \\min(\\epsilon_{\\mathrm{eff}})}}\n$$\nThis implies the CFL condition on the time step:\n$$\n\\Delta t \\le \\Delta x \\sqrt{\\mu_0 \\min(\\epsilon_{\\mathrm{eff}})}\n$$\nThe value of $\\min(\\epsilon_{\\mathrm{eff}})$ depends on the sign of the nonlinearity coefficient $\\alpha$:\n- If $\\alpha > 0$, $\\epsilon_{\\mathrm{eff}}(E_y) = \\epsilon_y + 3\\alpha E_y^2$ is always greater than or equal to $\\epsilon_y$. The minimum is $\\epsilon_{\\mathrm{eff}}(0) = \\epsilon_y$. The CFL condition becomes $\\Delta t \\le \\Delta x \\sqrt{\\mu_0 \\epsilon_y}$. The time step is given as $\\Delta t = s \\Delta x \\sqrt{\\mu_0 \\epsilon_y}$, so stability requires $s \\le 1$.\n- If $\\alpha  0$, $\\epsilon_{\\mathrm{eff}}(E_y)$ decreases as $|E_y|$ increases. The minimum value of $\\epsilon_{\\mathrm{eff}}$ will occur at the peak field amplitude, $E_{\\max}$. The stability condition is $\\Delta t \\le \\Delta x \\sqrt{\\mu_0 (\\epsilon_y + 3\\alpha E_{\\max}^2)}$. This can be rewritten in terms of the scaling factor $s$:\n$$\ns \\le \\sqrt{1 + \\frac{3\\alpha E_{\\max}^2}{\\epsilon_y}}\n$$\nA crucial consequence is that if the field amplitude $E_y$ is large enough such that $\\epsilon_y + 3\\alpha E_y^2 \\le 0$, the effective permittivity becomes non-positive. This corresponds to the physical phenomenon of modulational instability, where the medium itself becomes unstable. In this regime, the linearized CFL condition cannot be satisfied for any real $\\Delta t$, and we expect the simulation to become unstable, regardless of the time step.\n\nThe discrete energy $\\mathcal{E}^n = \\sum_i \\frac{1}{2} (E_{y,i}^n D_{y,i}^n + \\mu_0 H_{z,i}^{n+1/2} H_{z,i}^{n+1/2}) \\Delta x$ is not strictly conserved in a nonlinear scheme. However, boundedness of this energy is a practical indicator of numerical stability. The CFL condition derived above ensures that errors do not grow exponentially, which in turn keeps the discrete energy bounded. Violation of this condition leads to numerical instability, where field values grow without bound, causing the energy to diverge.\n\n### 3. Implementation Details\n\nThe FDTD scheme is implemented in a Python program using the `numpy` library for efficient array operations. The main simulation loop iterates through the test cases. For each case:\n1.  Simulation parameters ($\\Delta x, \\epsilon_y, \\Delta t$, etc.) are calculated from the given inputs.\n2.  Arrays for $E_y$, $H_z$, and $D_y$ are initialized. The initial condition for $H_z$ is $H_z(x, -\\Delta t/2)=0$.\n3.  The initial energy $\\mathcal{E}^0$ is calculated according to the problem's formula, which requires a pre-step calculation of $H_z(x, \\Delta t/2)$ from $E_y(x,0)$. This value is stored as `E_initial`, and a running maximum `E_max` is initialized.\n4.  The main FDTD loop executes for $N_{\\mathrm{steps}}$. In each iteration $n$:\n    -   $H_z$ is updated from time $n-1/2$ to $n+1/2$ using $E_y$ at time $n$. Periodic boundary conditions are handled using `numpy.roll`.\n    -   The discrete energy $\\mathcal{E}^n$ is computed and `E_max` is updated. A stability check is performed against the $1.5 \\times \\mathcal{E}^0$ criterion.\n    -   $D_y$ is updated from time $n$ to $n+1$ using $H_z$ at time $n+1/2$.\n    -   $E_y$ is updated from time $n$ to $n+1$ by numerically solving the nonlinear cubic equation for each grid point using the vectorized Newton's method. The value $E_y^n$ serves as the initial guess.\n    -   A check for `NaN` or `inf` values is performed after each update to detect catastrophic divergence.\n5.  If the loop completes without the energy exceeding the threshold or a numerical overflow, the run is deemed stable (`True`); otherwise, it is unstable (`False`).\n6.  The stability results for all test cases are collected and printed in the specified list format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the FDTD simulations for a suite of test cases.\n    \"\"\"\n    # Physical Constants\n    EPSILON_0 = 8.854187817e-12  # F/m\n    MU_0 = 4 * np.pi * 1e-7      # H/m\n    \n    # Test cases from the problem statement\n    test_cases = [\n        # (Nx, L, eps_r_y, alpha, A, s, N_steps)\n        (400, 1.0, 2.25, 1.0e-24, 1.0e6, 0.90, 800), # Case 1\n        (400, 1.0, 2.25, 1.0e-24, 1.0e6, 1.10, 600), # Case 2\n        (400, 1.0, 2.25, -5.0e-25, 4.0e6, 0.50, 800), # Case 3\n        (400, 1.0, 2.25, -5.0e-25, 4.0e6, 0.95, 800), # Case 4\n    ]\n\n    results = []\n    for params in test_cases:\n        is_stable = run_simulation(params, EPSILON_0, MU_0)\n        results.append(is_stable)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_newton(Dy, Ey_guess, epsilon_y, alpha, tol=1e-9, max_iter=10):\n    \"\"\"\n    Solves for Ey from Dy using Newton's method.\n    The equation to solve is f(Ey) = alpha * Ey^3 + epsilon_y * Ey - Dy = 0.\n    This is performed element-wise for all grid points.\n    \n    Args:\n        Dy (np.ndarray): Array of electric displacement values D_y^{n+1}.\n        Ey_guess (np.ndarray): Initial guess for E_y^{n+1}, typically E_y^n.\n        epsilon_y (float): Linear permittivity.\n        alpha (float): Kerr nonlinearity coefficient.\n        tol (float): Convergence tolerance.\n        max_iter (int): Maximum number of iterations.\n\n    Returns:\n        np.ndarray: The solved electric field E_y^{n+1}.\n    \"\"\"\n    Ey = Ey_guess.copy()\n    for _ in range(max_iter):\n        f = alpha * Ey**3 + epsilon_y * Ey - Dy\n        f_prime = 3 * alpha * Ey**2 + epsilon_y\n        \n        # Add a small stabilization term to prevent division by zero,\n        # although this is extremely unlikely to be exactly zero.\n        # If f_prime is negative, it's a sign of potential physical instability,\n        # but Newton's method can still converge.\n        update = f / (f_prime + 1e-99)\n        Ey -= update\n        \n        if np.max(np.abs(update))  tol:\n            break\n            \n    return Ey\n\ndef run_simulation(params, epsilon_0, mu_0):\n    \"\"\"\n    Runs a single FDTD simulation case and determines its stability.\n    \n    Args:\n        params (tuple): A tuple containing simulation parameters\n                        (Nx, L, eps_r_y, alpha, A, s, N_steps).\n        epsilon_0 (float): Vacuum permittivity.\n        mu_0 (float): Vacuum permeability.\n\n    Returns:\n        bool: True if the simulation is stable, False otherwise.\n    \"\"\"\n    Nx, L, eps_r_y, alpha, A, s, N_steps = params\n    \n    # Derived parameters\n    dx = L / Nx\n    epsilon_y = eps_r_y * epsilon_0\n    v_base = 1.0 / np.sqrt(mu_0 * epsilon_y)\n    dt = s * dx / v_base\n\n    # Spatial grid\n    # x = np.linspace(0, L, Nx, endpoint=False)\n    # The explicit x-grid is not strictly needed for the updates, but for ICs\n    x_coords = dx * np.arange(Nx)\n\n    # Initial conditions\n    Ey = A * np.exp(-((x_coords - L / 2)**2) / (L / 10)**2)  # Ey at t=0\n    Hz = np.zeros(Nx)                                     # Hz at t=-dt/2\n    Dy = epsilon_y * Ey + alpha * Ey**3                   # Dy at t=0\n\n    # For the energy calculation at n=0, we need H at t=dt/2.\n    # Perform the first half-step update for H.\n    Hz_half = Hz + (dt / (mu_0 * dx)) * (np.roll(Ey, -1) - Ey)\n    \n    # Initial energy calculation as per problem statement: E^n uses E^n, D^n, H^{n+1/2}\n    # For n=0, we use E_0, D_0, H_{1/2}\n    E_initial = 0.5 * np.sum(Ey * Dy + mu_0 * Hz_half**2) * dx\n    if E_initial == 0: E_initial = 1e-30 # Avoid division by zero if initial energy is zero\n    E_max = E_initial\n    \n    # Set the state for the main FDTD loop. The H-field is a half-step behind.\n    H = Hz \n    \n    for _ in range(N_steps):\n        # State at loop start: Ey is E^n, Dy is D^n, H is H^{n-1/2}\n        \n        # --- Update H-field to H^{n+1/2} ---\n        H = H + (dt / (mu_0 * dx)) * (np.roll(Ey, -1) - Ey)\n\n        # Check for immediate numerical instability\n        if not np.all(np.isfinite(H)):\n            return False\n\n        # --- Energy check and stability criterion ---\n        # Calculate energy at step n, using E^n, D^n, and the newly computed H^{n+1/2}\n        current_energy = 0.5 * np.sum(Ey * Dy + mu_0 * H**2) * dx\n        E_max = max(E_max, current_energy)\n\n        if E_max  1.5 * E_initial:\n            return False\n        \n        # --- Update D-field to D^{n+1} ---\n        Dy = Dy - (dt / dx) * (H - np.roll(H, 1))\n\n        # --- Update E-field to E^{n+1} ---\n        Ey = solve_newton(Dy, Ey, epsilon_y, alpha)\n\n        # Check for numerical instability from the nonlinear solve\n        if not np.all(np.isfinite(Ey)):\n            return False\n            \n    return True\n\nsolve()\n\n```", "id": "3331925"}, {"introduction": "Expanding our scope to bianisotropic materials, where electric and magnetic fields are cross-coupled, introduces new complexities in simulation, particularly concerning numerical stability. This exercise focuses on isotropic chiral media, a canonical example of bianisotropy, and requires the derivation of a Courant–Friedrichs–Lewy (CFL) stability condition for a split-field FDTD algorithm ([@problem_id:3331893]). The analysis reveals how the two circularly polarized eigenmodes dictate the maximum stable time step, providing essential insights for ensuring the validity of simulations in these advanced materials.", "problem": "Consider the numerical stability of a split-field Finite-Difference Time-Domain (FDTD) scheme for homogeneous isotropic chiral (Pasteur) media, formulated in terms of circularly polarized fields. Start from Maxwell’s equations in the time domain for linear, source-free media,\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}, \\qquad \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t},\n$$\ntogether with the isotropic chiral (Pasteur) constitutive relations,\n$$\n\\mathbf{D} = \\varepsilon \\mathbf{E} + i \\kappa \\sqrt{\\varepsilon \\mu}\\, \\mathbf{H}, \\qquad \\mathbf{B} = \\mu \\mathbf{H} - i \\kappa \\sqrt{\\varepsilon \\mu}\\, \\mathbf{E},\n$$\nwhere $\\varepsilon = \\varepsilon_0 \\varepsilon_r$, $\\mu = \\mu_0 \\mu_r$, $\\kappa$ is a dimensionless chirality parameter, and $i^2 = -1$. Define circularly polarized fields $\\mathbf{E}^\\pm$ via an appropriate split-field decoupling so that, in the isotropic case, the two helicity modes propagate independently with refractive indices $n_\\pm$ and phase speeds $c_\\pm$. Then, extend the stability analysis to weakly anisotropic, diagonal media where $\\varepsilon$ and $\\mu$ are replaced by\n$$\n\\boldsymbol{\\varepsilon} = \\varepsilon_0\\, \\mathrm{diag}\\big(\\varepsilon_r(1+a_x),\\, \\varepsilon_r(1+a_y),\\, \\varepsilon_r(1+a_z)\\big), \\\\\n\\boldsymbol{\\mu} = \\mu_0\\, \\mathrm{diag}\\big(\\mu_r(1+b_x),\\, \\mu_r(1+b_y),\\, \\mu_r(1+b_z)\\big),\n$$\nwith small anisotropy ratios $a_i$ and $b_i$ satisfying $|a_i| \\ll 1$ and $|b_i| \\ll 1$ for $i \\in \\{x,y,z\\}$, and an isotropic chirality $\\kappa$ retained. Assume a standard staggered Yee grid in $3$ dimensions with spacings $\\Delta x$, $\\Delta y$, $\\Delta z$.\n\nYour tasks are:\n- From the fundamental equations above, derive a Courant–Friedrichs–Lewy (CFL) stability condition for the split-field FDTD update that depends on the wave speeds of the circular polarizations in the isotropic chiral case, and then furnish a conservative extension to the weakly anisotropic case in which the stability bound depends on $\\kappa$ and on the anisotropy ratios through the principal-axis effective refractive indices.\n- Design an algorithm that, given $\\Delta x$, $\\Delta y$, $\\Delta z$, $\\varepsilon_r$, $\\mu_r$, $\\kappa$, $a_x$, $a_y$, $a_z$, $b_x$, $b_y$, $b_z$, computes the maximum stable time step $\\Delta t_{\\max}$ in seconds for the homogeneous medium, using the derived CFL condition. Use the speed of light in vacuum $c_0 = 299792458\\,\\mathrm{m/s}$.\n\nScientific realism requirements:\n- For isotropic chiral media, use the circular polarization eigenmode refractive indices $n_\\pm$ and corresponding phase speeds $c_\\pm$ obtained from a correct decoupling of Maxwell’s equations with the Pasteur constitutive relations.\n- For weak anisotropy, your conservative CFL bound must reduce to the isotropic result when $a_x = a_y = a_z = 0$ and $b_x = b_y = b_z = 0$, and must explicitly depend on the axis-wise effective refractive indices influenced by the anisotropy ratios and $\\kappa$.\n\nProgramming requirements and output:\n- Implement a complete program that computes $\\Delta t_{\\max}$ for each of the following test cases. Express each $\\Delta t_{\\max}$ in seconds, formatted in scientific notation with $10$ significant digits.\n- Test suite (homogeneous media, all quantities dimensionless unless units indicated):\n    1. Case A (baseline non-chiral, isotropic): $\\Delta x = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta y = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta z = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\varepsilon_r = 4.0$, $\\mu_r = 1.0$, $\\kappa = 0.0$, $a_x = a_y = a_z = 0.0$, $b_x = b_y = b_z = 0.0$.\n    2. Case B (moderate chirality, isotropic): $\\Delta x = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta y = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta z = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\varepsilon_r = 2.25$, $\\mu_r = 1.0$, $\\kappa = 0.3$, $a_x = a_y = a_z = 0.0$, $b_x = b_y = b_z = 0.0$.\n    3. Case C (near-strong chirality, isotropic): $\\Delta x = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta y = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta z = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\varepsilon_r = 2.25$, $\\mu_r = 1.0$, $\\kappa = 1.4$, $a_x = a_y = a_z = 0.0$, $b_x = b_y = b_z = 0.0$.\n    4. Case D (weak anisotropy, unequal grid): $\\Delta x = 0.5 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta y = 0.8 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta z = 1.2 \\times 10^{-3}\\,\\mathrm{m}$, $\\varepsilon_r = 4.0$, $\\mu_r = 1.0$, $\\kappa = 0.2$, $a_x = 0.1$, $a_y = -0.05$, $a_z = 0.0$, $b_x = 0.0$, $b_y = 0.05$, $b_z = -0.05$.\n    5. Case E (weak anisotropy with magnetic contrast, highly non-uniform grid): $\\Delta x = 0.2 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta y = 2.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\Delta z = 3.0 \\times 10^{-3}\\,\\mathrm{m}$, $\\varepsilon_r = 1.0$, $\\mu_r = 1.5$, $\\kappa = 0.1$, $a_x = -0.1$, $a_y = 0.2$, $a_z = 0.0$, $b_x = 0.1$, $b_y = -0.05$, $b_z = 0.05$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\texttt{[result1,result2,result3,result4,result5]}$), where each result is the corresponding $\\Delta t_{\\max}$ in seconds in scientific notation with $10$ significant digits.\n\nAnswer in units of seconds for all cases, with each float formatted in scientific notation with $10$ significant digits. Angles, if any appear, must be in radians, but this task does not require angles. Express any fractions or ratios numerically as decimals if they appear in the output. The final output must be a single line as specified above, with no additional text.", "solution": "We begin from Maxwell’s equations for linear, source-free media,\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}, \\qquad \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}.\n$$\nFor an isotropic chiral (Pasteur) medium, the constitutive relations are\n$$\n\\mathbf{D} = \\varepsilon \\mathbf{E} + i \\kappa \\sqrt{\\varepsilon \\mu}\\, \\mathbf{H}, \\qquad\n\\mathbf{B} = \\mu \\mathbf{H} - i \\kappa \\sqrt{\\varepsilon \\mu}\\, \\mathbf{E},\n$$\nwhere $\\varepsilon = \\varepsilon_0 \\varepsilon_r$, $\\mu = \\mu_0 \\mu_r$, $\\kappa$ is dimensionless, and $i^2 = -1$. It is classical that this medium supports circularly polarized eigenmodes. A compact way to reveal the decoupling is to form helicity fields\n$$\n\\mathbf{Q}^{\\pm} = \\mathbf{E} \\pm i Z\\, \\mathbf{H},\n$$\nwith $Z = \\sqrt{\\mu/\\varepsilon}$ the medium impedance in the absence of chirality. Eliminating $\\mathbf{D}$ and $\\mathbf{B}$ in frequency domain ($\\partial/\\partial t \\mapsto -i\\omega$) and combining the curl equations yields two independent vector Helmholtz equations for $\\mathbf{Q}^{\\pm}$ with wavenumbers $k_{\\pm}$ satisfying\n$$\nk_{\\pm} = \\frac{\\omega}{c_0} \\left(\\sqrt{\\varepsilon_r \\mu_r} \\pm \\kappa\\right) \\equiv \\frac{\\omega}{c_0} n_{\\pm},\n$$\nwhere $c_0 = 1/\\sqrt{\\varepsilon_0 \\mu_0}$ is the speed of light in vacuum, $n_{\\pm} = \\sqrt{\\varepsilon_r \\mu_r} \\pm \\kappa$ are the refractive indices for right- and left-handed circularly polarized eigenmodes, and the associated phase speeds are\n$$\nc_{\\pm} = \\frac{\\omega}{|k_{\\pm}|} = \\frac{c_0}{|n_{\\pm}|}.\n$$\nThus, in an isotropic chiral medium, a split-field FDTD implemented in the circular polarization basis $\\mathbf{Q}^{\\pm}$ updates two decoupled wave systems with characteristic speeds $c_{\\pm}$. A standard von Neumann analysis of the $3$-dimensional staggered Yee scheme for a homogeneous isotropic medium shows that stability requires\n$$\n\\Delta t \\le \\frac{1}{\\sqrt{\\left(\\frac{c}{\\Delta x}\\right)^2 + \\left(\\frac{c}{\\Delta y}\\right)^2 + \\left(\\frac{c}{\\Delta z}\\right)^2}},\n$$\nfor a scalar wave speed $c$. In the split-field chiral case, each decoupled subsystem is stable if\n$$\n\\Delta t \\le \\frac{1}{\\sqrt{\\left(\\frac{c_{\\pm}}{\\Delta x}\\right)^2 + \\left(\\frac{c_{\\pm}}{\\Delta y}\\right)^2 + \\left(\\frac{c_{\\pm}}{\\Delta z}\\right)^2}}.\n$$\nTo guarantee stability of the composite update, we must satisfy the more restrictive of the two, which is governed by the larger speed magnitude. Hence, for isotropic chiral media,\n$$\n\\Delta t_{\\max}^{\\text{iso}} = \\frac{1}{\\sqrt{\\left(\\frac{c_{\\max}}{\\Delta x}\\right)^2 + \\left(\\frac{c_{\\max}}{\\Delta y}\\right)^2 + \\left(\\frac{c_{\\max}}{\\Delta z}\\right)^2}}, \\quad c_{\\max} = \\max\\{c_{+}, c_{-}\\} = \\frac{c_0}{\\min\\{|n_{+}|, |n_{-}|\\}}.\n$$\n\nWe now extend this to weakly anisotropic, diagonal $\\boldsymbol{\\varepsilon}$ and $\\boldsymbol{\\mu}$ with the same isotropic $\\kappa$. Let\n$$\n\\varepsilon_x = \\varepsilon_0 \\varepsilon_r (1 + a_x), \\quad \\varepsilon_y = \\varepsilon_0 \\varepsilon_r (1 + a_y), \\quad \\varepsilon_z = \\varepsilon_0 \\varepsilon_r (1 + a_z),\n$$\n$$\n\\mu_x = \\mu_0 \\mu_r (1 + b_x), \\quad \\mu_y = \\mu_0 \\mu_r (1 + b_y), \\quad \\mu_z = \\mu_0 \\mu_r (1 + b_z).\n$$\nWhen $|a_i|, |b_i| \\ll 1$, the circular basis no longer perfectly diagonalizes the system, but the wave operator remains close to its isotropic counterpart. A conservative stability bound can be built by bounding the axis-wise characteristic speeds entering the discrete curl operators. For a wave primarily varying along coordinate $i \\in \\{x,y,z\\}$, the relevant effective refractive indices for the two helicities are well approximated by\n$$\nn_{\\pm,i} \\approx \\sqrt{\\varepsilon_r (1 + a_i)\\, \\mu_r (1 + b_i)} \\pm \\kappa,\n$$\nso that the corresponding phase speeds are\n$$\nc_{\\pm,i} = \\frac{c_0}{|n_{\\pm,i}|}.\n$$\nIn a Yee update, the stability-limiting contribution of each spatial derivative can be conservatively bounded by the largest magnitude speed associated with that axis. Therefore, letting\n$$\nc_i = \\max\\{c_{+,i}, c_{-,i}\\} = \\frac{c_0}{\\min\\{|n_{+,i}|, |n_{-,i}|\\}},\n$$\na sufficient and conservative CFL condition for weak anisotropy is\n$$\n\\Delta t_{\\max}^{\\text{aniso}} = \\frac{1}{\\sqrt{\\left(\\frac{c_x}{\\Delta x}\\right)^2 + \\left(\\frac{c_y}{\\Delta y}\\right)^2 + \\left(\\frac{c_z}{\\Delta z}\\right)^2}}.\n$$\nThis bound reduces to the isotropic result when $a_x = a_y = a_z = 0$ and $b_x = b_y = b_z = 0$, in which case $c_x = c_y = c_z = \\max\\{c_{+}, c_{-}\\}$. It is also robust if $n_{-,i}$ becomes small (approaching a backward-wave regime), because the absolute value ensures we use the largest magnitude speed. If for some $i$, $\\min\\{|n_{+,i}|, |n_{-,i}|\\} \\to 0$, then $c_i \\to \\infty$ and the bound drives $\\Delta t_{\\max} \\to 0$, correctly indicating the need for vanishingly small time steps near such extreme parameters.\n\nAlgorithm to compute $\\Delta t_{\\max}$:\n1. Given $\\Delta x$, $\\Delta y$, $\\Delta z$, $\\varepsilon_r$, $\\mu_r$, $\\kappa$, $a_i$, $b_i$, compute for each axis $i \\in \\{x,y,z\\}$ the relative effective axial refractive indices\n$$\nn_{\\pm,i} = \\sqrt{\\varepsilon_r (1 + a_i)\\, \\mu_r (1 + b_i)} \\pm \\kappa.\n$$\n2. Compute the axial speeds\n$$\nc_{\\pm,i} = \\frac{c_0}{|n_{\\pm,i}|}, \\quad c_i = \\max\\{c_{+,i}, c_{-,i}\\}.\n$$\n3. Return\n$$\n\\Delta t_{\\max} = \\frac{1}{\\sqrt{\\left(\\frac{c_x}{\\Delta x}\\right)^2 + \\left(\\frac{c_y}{\\Delta y}\\right)^2 + \\left(\\frac{c_z}{\\Delta z}\\right)^2}}.\n$$\n\nConsistency checks:\n- If $\\kappa = 0$ and $a_i = b_i = 0$ for all $i$, then $n_{\\pm} = \\sqrt{\\varepsilon_r \\mu_r}$ and $c_{+} = c_{-} = c_0/\\sqrt{\\varepsilon_r \\mu_r}$, leading to the standard Yee bound\n$$\n\\Delta t_{\\max} = \\frac{1}{c_0/\\sqrt{\\varepsilon_r \\mu_r}} \\cdot \\frac{1}{\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}} = \\frac{1}{\\sqrt{\\left(\\frac{c}{\\Delta x}\\right)^2 + \\left(\\frac{c}{\\Delta y}\\right)^2 + \\left(\\frac{c}{\\Delta z}\\right)^2}},\n$$\nwith $c = c_0/\\sqrt{\\varepsilon_r \\mu_r}$.\n- If $\\kappa \\neq 0$ but isotropic, then $c_x = c_y = c_z = \\max\\{c_{+}, c_{-}\\}$, giving the isotropic chiral result governed by the faster helicity.\n- For weak anisotropy, the axis-wise bound smoothly perturbs the isotropic result and remains conservative.\n\nImplementation details:\n- Use $c_0 = 299792458\\,\\mathrm{m/s}$.\n- For numerical robustness, use absolute values $|n_{\\pm,i}|$ when computing speeds.\n- The output must be a single line containing a Python-style list of the $\\Delta t_{\\max}$ values for the test suite in the order specified, each formatted in scientific notation with $10$ significant digits.\n\nApplying the algorithm to the five test cases yields a set of five floating-point values in seconds, which the program will compute and print in the required single-line format.", "answer": "```python\nimport numpy as np\n\n# Compute maximum stable time step for split-field FDTD in an isotropic chiral,\n# extended conservatively to weakly anisotropic diagonal media.\n# Uses axis-wise bound with speeds from circular polarization refractive indices.\n\ndef dt_max_from_params(dx, dy, dz, eps_r, mu_r, kappa, ax, ay, az, bx, by, bz):\n    c0 = 299792458.0  # m/s\n\n    # Axis-wise relative refractive indices for the two circular polarizations\n    a = {'x': ax, 'y': ay, 'z': az}\n    b = {'x': bx, 'y': by, 'z': bz}\n    d = {'x': dx, 'y': dy, 'z': dz}\n\n    c_axis = {}\n    for i in ['x', 'y', 'z']:\n        # Effective relative index base\n        base = eps_r * (1.0 + a[i]) * mu_r * (1.0 + b[i])\n        if base  0:\n            # Non-physical; but to keep stability bound conservative, treat as zero to avoid NaNs\n            base = 0.0\n        n_base = np.sqrt(base)\n        n_plus = n_base + kappa\n        n_minus = n_base - kappa\n        # Use absolute refractive index magnitude for speed\n        # Guard division by zero: if |n| == 0, speed is effectively infinite - dt - 0\n        c_plus = c0 / (abs(n_plus) if abs(n_plus)  0.0 else np.inf)\n        c_minus = c0 / (abs(n_minus) if abs(n_minus)  0.0 else np.inf)\n        # Axis-wise maximum speed\n        c_axis[i] = max(c_plus, c_minus)\n\n    # Compute CFL bound: dt = 1 / sqrt( (cx/dx)^2 + (cy/dy)^2 + (cz/dz)^2 )\n    term = (c_axis['x'] / d['x'])**2 + (c_axis['y'] / d['y'])**2 + (c_axis['z'] / d['z'])**2\n    if term = 0.0 or not np.isfinite(term):\n        return 0.0\n    dt = 1.0 / np.sqrt(term)\n    return dt\n\ndef solve():\n    test_cases = [\n        # Case A: baseline non-chiral, isotropic\n        {\n            'dx': 1.0e-3, 'dy': 1.0e-3, 'dz': 1.0e-3,\n            'eps_r': 4.0, 'mu_r': 1.0, 'kappa': 0.0,\n            'ax': 0.0, 'ay': 0.0, 'az': 0.0,\n            'bx': 0.0, 'by': 0.0, 'bz': 0.0\n        },\n        # Case B: moderate chirality, isotropic\n        {\n            'dx': 1.0e-3, 'dy': 1.0e-3, 'dz': 1.0e-3,\n            'eps_r': 2.25, 'mu_r': 1.0, 'kappa': 0.3,\n            'ax': 0.0, 'ay': 0.0, 'az': 0.0,\n            'bx': 0.0, 'by': 0.0, 'bz': 0.0\n        },\n        # Case C: near-strong chirality, isotropic\n        {\n            'dx': 1.0e-3, 'dy': 1.0e-3, 'dz': 1.0e-3,\n            'eps_r': 2.25, 'mu_r': 1.0, 'kappa': 1.4,\n            'ax': 0.0, 'ay': 0.0, 'az': 0.0,\n            'bx': 0.0, 'by': 0.0, 'bz': 0.0\n        },\n        # Case D: weak anisotropy, unequal grid\n        {\n            'dx': 0.5e-3, 'dy': 0.8e-3, 'dz': 1.2e-3,\n            'eps_r': 4.0, 'mu_r': 1.0, 'kappa': 0.2,\n            'ax': 0.1, 'ay': -0.05, 'az': 0.0,\n            'bx': 0.0, 'by': 0.05, 'bz': -0.05\n        },\n        # Case E: weak anisotropy with magnetic contrast, highly non-uniform grid\n        {\n            'dx': 0.2e-3, 'dy': 2.0e-3, 'dz': 3.0e-3,\n            'eps_r': 1.0, 'mu_r': 1.5, 'kappa': 0.1,\n            'ax': -0.1, 'ay': 0.2, 'az': 0.0,\n            'bx': 0.1, 'by': -0.05, 'bz': 0.05\n        },\n    ]\n\n    results = []\n    for tc in test_cases:\n        dt = dt_max_from_params(\n            dx=tc['dx'], dy=tc['dy'], dz=tc['dz'],\n            eps_r=tc['eps_r'], mu_r=tc['mu_r'], kappa=tc['kappa'],\n            ax=tc['ax'], ay=tc['ay'], az=tc['az'],\n            bx=tc['bx'], by=tc['by'], bz=tc['bz']\n        )\n        results.append(dt)\n\n    # Format each result in scientific notation with 10 significant digits\n    formatted = [f\"{r:.10e}\" for r in results]\n    print(f\"[{','.join(formatted)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3331893"}]}