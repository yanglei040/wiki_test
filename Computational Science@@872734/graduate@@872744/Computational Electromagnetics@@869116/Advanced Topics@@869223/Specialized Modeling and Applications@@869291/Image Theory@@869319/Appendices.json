{"hands_on_practices": [{"introduction": "The method of images is most famously introduced with the case of a charge near a perfect conducting plane. This exercise expands upon that foundation by tackling the more general problem of a planar interface between two arbitrary dielectric media. By applying the fundamental boundary conditions of electrostatics, you will derive the image charge required to solve this problem, revealing a beautifully simple dependence on the permittivities of the media. This practice is crucial for understanding how the familiar rules for perfect electric and magnetic conductors are simply limiting cases of a more powerful, unified theory. [@problem_id:3316430]", "problem": "Consider a planar interface at $z=0$ separating two homogeneous, isotropic, non-magnetic media with electric permittivities $\\epsilon_{1}$ (for $z0$) and $\\epsilon_{2}$ (for $z0$). A point electric charge $q$ is located at $(0,0,d)$ with $d0$ in the upper medium $z0$. In the upper region, seek an electrostatic potential representation built from the superposition of the potential of the actual charge at $(0,0,d)$ and a single unknown image charge $q'$ located at $(0,0,-d)$. In the lower region, assume an electrostatic potential representation that is sourced only by an effective equivalent source of unknown strength located at $(0,0,d)$, with no singularity in $z0$.\n\nUsing Maxwell’s equations specialized to electrostatics, the constitutive relation $\\mathbf{D}=\\epsilon \\mathbf{E}$, and the electromagnetic boundary conditions at a charge-free planar interface, determine the image-charge ratio $q'/q$ in terms of $\\epsilon_{1}$ and $\\epsilon_{2}$ without invoking any previously known image-theory formulas. Then, analyze the limiting cases $\\epsilon_{2}\\to\\infty$ and $\\epsilon_{2}\\to 0$ to recover the Perfect Electric Conductor (PEC) and Perfect Magnetic Conductor (PMC) image limits, respectively.\n\nExpress your final answer as a row matrix containing the two limiting values of $q'/q$ in the order $\\left(\\lim_{\\epsilon_{2}\\to\\infty} q'/q,\\ \\lim_{\\epsilon_{2}\\to 0} q'/q\\right)$. No rounding is required. The final answer is dimensionless.", "solution": "We begin by establishing the electrostatic potential in the two regions as prescribed by the problem. We use cylindrical coordinates $(\\rho, \\phi, z)$ due to the azimuthal symmetry, where $\\rho = \\sqrt{x^2 + y^2}$.\n\nA point charge $q$ is located at $(0,0,d)$ in region 1 ($z>0$, permittivity $\\epsilon_1$). Region 2 ($z0$) has permittivity $\\epsilon_2$.\n\nThe potential $V_1$ in region 1 is the superposition of the potential from the original charge $q$ at $(0,0,d)$ and an image charge $q'$ at $(0,0,-d)$. The distance from an observation point $(\\rho, \\phi, z)$ to the charge $q$ is $R_s = \\sqrt{\\rho^2 + (z-d)^2}$. The distance to the image charge $q'$ is $R_i = \\sqrt{\\rho^2 + (z+d)^2}$. The potential in region 1 is:\n$$V_1(\\rho, z) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{R_s} + \\frac{q'}{R_i} \\right) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{\\rho^2 + (z-d)^2}} + \\frac{q'}{\\sqrt{\\rho^2 + (z+d)^2}} \\right)$$\n\nThe potential $V_2$ in region 2 ($z0$) is constructed as if it originates from a single effective \"transmitted\" charge $q_t$ located at the position of the original charge, $(0,0,d)$, in a medium of permittivity $\\epsilon_2$. This ensures no sources (singularities) exist within region 2.\n$$V_2(\\rho, z) = \\frac{1}{4\\pi\\epsilon_2} \\frac{q_t}{R_s} = \\frac{1}{4\\pi\\epsilon_2} \\frac{q_t}{\\sqrt{\\rho^2 + (z-d)^2}}$$\n\nThe unknown charges $q'$ and $q_t$ are determined by applying the boundary conditions at the charge-free interface $z=0$:\n1.  Continuity of potential $V$: $V_1(\\rho, z=0) = V_2(\\rho, z=0)$.\n2.  Continuity of the normal component of the electric displacement field $\\mathbf{D}$: $\\mathbf{\\hat{n}} \\cdot (\\mathbf{D}_1 - \\mathbf{D}_2) = 0$. At $z=0$, this becomes $\\epsilon_1 E_{1z} = \\epsilon_2 E_{2z}$, or $\\epsilon_1 \\left(-\\frac{\\partial V_1}{\\partial z}\\right)\\bigg|_{z=0} = \\epsilon_2 \\left(-\\frac{\\partial V_2}{\\partial z}\\right)\\bigg|_{z=0}$.\n\nLet's apply the first boundary condition. At $z=0$, $R_s = R_i = \\sqrt{\\rho^2 + d^2}$.\n$$V_1(\\rho, 0) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{\\rho^2 + d^2}} + \\frac{q'}{\\sqrt{\\rho^2 + d^2}} \\right) = \\frac{q+q'}{4\\pi\\epsilon_1\\sqrt{\\rho^2 + d^2}}$$\n$$V_2(\\rho, 0) = \\frac{1}{4\\pi\\epsilon_2} \\frac{q_t}{\\sqrt{\\rho^2 + d^2}}$$\nEquating these gives our first relation:\n$$\\frac{q+q'}{\\epsilon_1} = \\frac{q_t}{\\epsilon_2}$$\n\nNow, let's apply the second boundary condition. We first need the $z$-derivatives of the potentials.\n$$\\frac{\\partial V_1}{\\partial z} = \\frac{1}{4\\pi\\epsilon_1} \\left[ q \\left( -\\frac{z-d}{R_s^3} \\right) + q' \\left( -\\frac{z+d}{R_i^3} \\right) \\right]$$\n$$\\frac{\\partial V_2}{\\partial z} = \\frac{1}{4\\pi\\epsilon_2} \\left[ q_t \\left( -\\frac{z-d}{R_s^3} \\right) \\right]$$\nEvaluating at $z=0$:\n$$-\\frac{\\partial V_1}{\\partial z}\\bigg|_{z=0} = -\\frac{1}{4\\pi\\epsilon_1} \\left[ \\frac{-qd}{(\\rho^2 + d^2)^{3/2}} - \\frac{q'd}{(\\rho^2 + d^2)^{3/2}} \\right] = \\frac{d(q-q')}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}}$$\n$$-\\frac{\\partial V_2}{\\partial z}\\bigg|_{z=0} = -\\frac{1}{4\\pi\\epsilon_2} \\left[ \\frac{-q_t d}{(\\rho^2 + d^2)^{3/2}} \\right] = \\frac{dq_t}{4\\pi\\epsilon_2(\\rho^2 + d^2)^{3/2}}$$\nThe boundary condition $\\epsilon_1 E_{1z} = \\epsilon_2 E_{2z}$ becomes:\n$$\\epsilon_1 \\left( \\frac{d(q-q')}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}} \\right) = \\epsilon_2 \\left( \\frac{dq_t}{4\\pi\\epsilon_2(\\rho^2 + d^2)^{3/2}} \\right)$$\nThis simplifies to our second relation:\n$$q-q' = q_t$$\n\nWe now have a system of two linear equations for $q'$ and $q_t$:\n$$(1) \\quad \\epsilon_2(q+q') = \\epsilon_1 q_t$$\n$$(2) \\quad q-q' = q_t$$\nSubstitute $(2)$ into $(1)$ to eliminate $q_t$:\n$$\\epsilon_2(q+q') = \\epsilon_1(q-q')$$\nWe need to find the ratio $q'/q$. Rearrange to group terms with $q$ and $q'$:\n$$\\epsilon_2 q - \\epsilon_1 q = -\\epsilon_1 q' - \\epsilon_2 q'$$\n$$q(\\epsilon_2 - \\epsilon_1) = -q'(\\epsilon_1 + \\epsilon_2)$$\nSolving for the ratio $q'/q$:\n$$\\frac{q'}{q} = -\\frac{\\epsilon_2 - \\epsilon_1}{\\epsilon_1 + \\epsilon_2} = \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\n\nNext, we analyze the two specified limiting cases.\n\nCase 1: Perfect Electric Conductor (PEC) limit, $\\epsilon_2 \\to \\infty$.\n$$\\lim_{\\epsilon_2 \\to \\infty} \\frac{q'}{q} = \\lim_{\\epsilon_2 \\to \\infty} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\nTo evaluate the limit, we divide the numerator and denominator by $\\epsilon_2$:\n$$\\lim_{\\epsilon_2 \\to \\infty} \\frac{\\frac{\\epsilon_1}{\\epsilon_2} - 1}{\\frac{\\epsilon_1}{\\epsilon_2} + 1} = \\frac{0-1}{0+1} = -1$$\nIn this limit, $q' = -q$, the well-known result for an image charge opposite a grounded conducting plane.\n\nCase 2: Perfect Magnetic Conductor (PMC) limit, $\\epsilon_2 \\to 0$.\nA PMC is a theoretical dual to a PEC. In electrostatics, the condition on a PMC boundary is that the normal component of the electric field is zero. This corresponds to the limit $\\epsilon_2 \\to 0$.\n$$\\lim_{\\epsilon_2 \\to 0} \\frac{q'}{q} = \\lim_{\\epsilon_2 \\to 0} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\nSubstituting $\\epsilon_2 = 0$ directly into the expression:\n$$\\frac{\\epsilon_1 - 0}{\\epsilon_1 + 0} = \\frac{\\epsilon_1}{\\epsilon_1} = 1$$\nIn this limit, $q' = q$, the known result for an image charge opposite a PMC surface.\n\nThe final answer requires a row matrix containing these two limiting values in the specified order: PEC limit, then PMC limit.\nThe row matrix is therefore $(-1, 1)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -1  1 \\end{pmatrix}}\n$$", "id": "3316430"}, {"introduction": "Moving from planar to curved geometries presents a new level of challenge, with the conducting sphere being a canonical example. While the image solution for this problem is well-known, a critical question for any physicist or engineer is whether the mathematical trick corresponds to physical reality. This practice provides a direct answer by guiding you to calculate the physical surface charge density $\\sigma(\\theta)$ induced on the sphere and integrate it, demonstrating that the total induced charge is precisely equal to the image charge. It also illuminates the crucial role of grounding in electrostatic systems. [@problem_id:3316422]", "problem": "A point charge of magnitude $q$ is located on the $z$-axis at $z=r_{0}$ with $r_{0}a$, outside a grounded perfectly electrically conducting (PEC) sphere of radius $a$ centered at the origin. The grounded connection fixes the conductor’s potential to $V=0$ on the spherical surface $r=a$, and the potential vanishes at spatial infinity. Using only Coulomb’s law, the electrostatic boundary conditions for a PEC, and the uniqueness theorem for electrostatics, proceed as follows:\n\n- Justify the replacement of the conducting sphere by an appropriate image configuration and determine the magnitude $q'$ and the location $r'$ (measured from the center along the $z$-axis) of a single image charge that enforces $V=0$ on $r=a$ for all polar angles $\\theta$.\n- From the resulting external potential, derive the induced surface charge density $\\sigma(\\theta)$ on the sphere via the normal-electric-field boundary condition on a PEC, and then integrate $\\sigma(\\theta)$ over the sphere to obtain the total induced charge $Q_{\\mathrm{ind}}$.\n- Your result must demonstrate that $Q_{\\mathrm{ind}}$ is not equal to $-q$, and must be expressed in closed form in terms of $q$, $a$, and $r_{0}$. Briefly explain, using first principles, why grounding leads to this value rather than $-q$.\n\nExpress the final total induced charge $Q_{\\mathrm{ind}}$ as a symbolic expression in terms of $q$, $a$, and $r_0$ (in Coulombs if evaluated numerically). No rounding is required.", "solution": "The problem is valid as it is a standard, well-posed problem in electrostatics, grounded in fundamental principles (Coulomb's Law, properties of conductors, uniqueness theorem) and uses clear, objective language. All necessary information is provided, and the setup is physically and mathematically consistent.\n\nThe problem asks for the total charge induced on a grounded conducting sphere. We will solve this using the method of images. In the region outside the sphere ($ra$), we must solve Poisson's equation, $\\nabla^2 V = -q\\delta(\\mathbf{r} - r_0\\mathbf{\\hat{z}})/\\epsilon_0$, subject to the boundary conditions $V(r=a) = 0$ and $V(r\\to\\infty) = 0$. The uniqueness theorem guarantees that if we find such a solution, it is the only correct one.\n\nThe method of images replaces the sphere with an \"image\" charge $q'$ at a location $z=r'$ (with $r'a$) inside the sphere. If we can choose $q'$ and $r'$ such that the potential from $q$ and $q'$ is zero on the surface $r=a$, we have found the unique solution for $ra$.\n\nThe potential at an arbitrary point $P$ on the spherical surface $r=a$ (with polar angle $\\theta$) is:\n$$V(a, \\theta) = \\frac{1}{4\\pi\\epsilon_0} \\left( \\frac{q}{\\sqrt{a^2 + r_0^2 - 2ar_0\\cos\\theta}} + \\frac{q'}{\\sqrt{a^2 + r'^2 - 2ar'\\cos\\theta}} \\right)$$\nFor this potential to be zero for all $\\theta$, the terms in the parenthesis must cancel. This requires $q$ and $q'$ to have opposite signs, and their magnitudes to satisfy:\n$$q^2 (a^2 + r'^2 - 2ar'\\cos\\theta) = q'^2 (a^2 + r_0^2 - 2ar_0\\cos\\theta)$$\nSince this must hold for any $\\theta$, we equate the constant terms and the coefficients of $\\cos\\theta$:\n1. $q^2(a^2 + r'^2) = q'^2(a^2 + r_0^2)$\n2. $q^2(2ar') = q'^2(2ar_0) \\implies q^2 r' = q'^2 r_0$\n\nFrom (2), we get $q'^2 = q^2 (r'/r_0)$. Substitute this into (1):\n$$q^2(a^2 + r'^2) = q^2 \\frac{r'}{r_0} (a^2 + r_0^2)$$\n$$a^2 + r'^2 = \\frac{r' a^2}{r_0} + r' r_0 \\implies a^2 - r' r_0 = \\frac{r' a^2}{r_0} - r'^2 = \\frac{r'}{r_0} (a^2 - r' r_0)$$\nThis implies either $a^2 - r'r_0 = 0$ or $1 = r'/r_0$. The latter is impossible as the image must be inside the sphere ($r'ar_0$). Thus, we must have $a^2 - r'r_0 = 0$, giving the location:\n$$r' = \\frac{a^2}{r_0}$$\nFrom $q'^2 = q^2 (r'/r_0)$, we find the magnitude $q'^2 = q^2 (a^2/r_0^2)$. Since $q$ and $q'$ have opposite signs:\n$$q' = -q \\frac{a}{r_0}$$\n\nNow we find the induced surface charge density $\\sigma(\\theta)$ on the sphere. The normal electric field just outside the conductor is $E_n = \\sigma/\\epsilon_0$. Here, $E_n = E_r = -\\frac{\\partial V}{\\partial r}|_{r=a}$.\nThe potential for $r>a$ is:\n$$V(r, \\theta) = \\frac{1}{4\\pi\\epsilon_0} \\left( \\frac{q}{\\sqrt{r^2 + r_0^2 - 2rr_0\\cos\\theta}} + \\frac{q'}{\\sqrt{r^2 + r'^2 - 2rr'\\cos\\theta}} \\right)$$\nCalculating $E_r = -\\frac{\\partial V}{\\partial r}$ and evaluating at $r=a$:\n$$E_r(a,\\theta) = \\frac{1}{4\\pi\\epsilon_0} \\left[ \\frac{q(a - r_0\\cos\\theta)}{(a^2 + r_0^2 - 2ar_0\\cos\\theta)^{3/2}} + \\frac{q'(a - r'\\cos\\theta)}{(a^2 + r'^2 - 2ar'\\cos\\theta)^{3/2}} \\right]$$\nWe know that at $r=a$, the denominator of the second term is related to the first: $(a^2 + r'^2 - 2ar'\\cos\\theta) = (a/r_0)^2 (a^2 + r_0^2 - 2ar_0\\cos\\theta)$.\nLet $D^2 = a^2 + r_0^2 - 2ar_0\\cos\\theta$. Then the denominator of the second term is $(a/r_0)^3 D^3$.\n$$E_r(a,\\theta) = \\frac{1}{4\\pi\\epsilon_0 D^3} \\left[ q(a - r_0\\cos\\theta) + \\frac{q'(a - r'\\cos\\theta)}{(a/r_0)^3} \\right]$$\nSubstitute $q'=-q(a/r_0)$ and $r'=a^2/r_0$:\n$$E_r(a,\\theta) = \\frac{q}{4\\pi\\epsilon_0 D^3} \\left[ (a - r_0\\cos\\theta) - \\frac{(a/r_0)(a - (a^2/r_0)\\cos\\theta)}{(a/r_0)^3} \\right]$$\n$$E_r(a,\\theta) = \\frac{q}{4\\pi\\epsilon_0 D^3} \\left[ (a - r_0\\cos\\theta) - \\frac{r_0^2}{a^2} \\left(a - \\frac{a^2}{r_0}\\cos\\theta\\right) \\right]$$\n$$E_r(a,\\theta) = \\frac{q}{4\\pi\\epsilon_0 D^3} \\left[ a - r_0\\cos\\theta - \\frac{r_0^2}{a} + r_0\\cos\\theta \\right] = \\frac{q}{4\\pi\\epsilon_0 D^3} \\left( a - \\frac{r_0^2}{a} \\right)$$\nSo, $\\sigma(\\theta) = \\epsilon_0 E_r(a,\\theta)$:\n$$\\sigma(\\theta) = \\frac{q(a^2-r_0^2)}{4\\pi a(a^2+r_0^2-2ar_0\\cos\\theta)^{3/2}}$$\n\nTo find the total induced charge $Q_{\\mathrm{ind}}$, we integrate $\\sigma(\\theta)$ over the sphere's surface ($dS = a^2 \\sin\\theta d\\theta d\\phi$):\n$$Q_{\\mathrm{ind}} = \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sigma(\\theta) a^2 \\sin\\theta d\\theta = 2\\pi a^2 \\frac{q(a^2-r_0^2)}{4\\pi a} \\int_0^\\pi \\frac{\\sin\\theta}{(a^2+r_0^2-2ar_0\\cos\\theta)^{3/2}} d\\theta$$\nLet $u = \\cos\\theta$, so $du = -\\sin\\theta d\\theta$. Limits change from $[0, \\pi]$ to $[1, -1]$.\n$$Q_{\\mathrm{ind}} = \\frac{q a (a^2-r_0^2)}{2} \\int_1^{-1} \\frac{-du}{(a^2+r_0^2-2ar_0 u)^{3/2}} = \\frac{q a (a^2-r_0^2)}{2} \\int_{-1}^{1} (a^2+r_0^2-2ar_0 u)^{-3/2} du$$\nThe antiderivative is $\\frac{1}{ar_0\\sqrt{a^2+r_0^2-2ar_0 u}}$. Evaluating at the limits:\n$$\\left[ \\frac{1}{ar_0\\sqrt{a^2+r_0^2-2ar_0 u}} \\right]_{-1}^{1} = \\frac{1}{ar_0} \\left( \\frac{1}{\\sqrt{(r_0-a)^2}} - \\frac{1}{\\sqrt{(r_0+a)^2}} \\right)$$\nSince $r_0>a$, this becomes:\n$$= \\frac{1}{ar_0} \\left( \\frac{1}{r_0-a} - \\frac{1}{r_0+a} \\right) = \\frac{1}{ar_0} \\left( \\frac{(r_0+a)-(r_0-a)}{r_0^2-a^2} \\right) = \\frac{2}{r_0(r_0^2-a^2)}$$\nSubstituting this back into the expression for $Q_{\\mathrm{ind}}$:\n$$Q_{\\mathrm{ind}} = \\frac{q a (a^2-r_0^2)}{2} \\left(\\frac{2}{r_0(r_0^2-a^2)}\\right) = \\frac{q a (-(r_0^2-a^2))}{r_0(r_0^2-a^2)} = -q \\frac{a}{r_0}$$\nThis proves that the total induced charge is equal to the image charge $q'$.\n\nSince the charge $q$ is outside the sphere, $r_0 > a$, which implies $a/r_0  1$. Consequently, $|Q_{\\mathrm{ind}}| = |q|(a/r_0)  |q|$, so $Q_{\\mathrm{ind}} \\neq -q$.\n\nThe reason $Q_{\\mathrm{ind}}$ is not $-q$ is due to grounding. An isolated, uncharged conducting sphere would remain neutral overall. Grounding connects the sphere to an infinite charge reservoir (the Earth) at $V=0$. When the positive charge $q$ is brought near, it attracts electrons from the ground onto the sphere until the sphere's potential is also zero. Not all electric field lines from $q$ terminate on the sphere; some extend to infinity, where the potential is also zero. Gauss's Law states that the net electric flux through a closed surface is proportional to the enclosed charge. For a surface enclosing the sphere, the net flux is $Q_{\\mathrm{ind}}/\\epsilon_0$. Since this is only a fraction of the total flux emanating from $q$ (which is $q/\\epsilon_0$), it follows that $|Q_{\\mathrm{ind}}|  |q|$.", "answer": "$$ \\boxed{-q \\frac{a}{r_0}} $$", "id": "3316422"}, {"introduction": "An analytical solution is only as good as its numerical implementation. In computational science, a theoretically correct formula can fail spectacularly due to the limitations of finite-precision arithmetic. This exercise confronts this reality by examining the case of a source very close to a conducting plane, where the direct evaluation of the image-theory solution suffers from catastrophic subtractive cancellation. Your task is to analyze this numerical instability and critically evaluate different strategies for reformulating the problem to ensure an accurate and robust computation, a core skill for any computational scientist. [@problem_id:3316475]", "problem": "Consider a time-harmonic source above a planar Perfect Electric Conductor (PEC) plane at $z=0$ in free space. In frequency domain, the electric field $\\mathbf{E}$ is governed by Maxwell’s equations, which can be expressed using the dyadic Green’s function. To isolate and analyze a specific numerical stability issue intrinsic to image theory, consider the scalar Helmholtz Green’s function $G(\\mathbf{r},\\mathbf{r}') = \\dfrac{e^{i k |\\mathbf{r}-\\mathbf{r}'|}}{4 \\pi |\\mathbf{r}-\\mathbf{r}'|}$ as a proxy kernel for the relevant components of the dyadic Green’s function, where $k$ is the free-space wavenumber.\n\nLet a point source be located at $\\mathbf{r}_{s}=(0,0,h)$ with $h0$ small, and let $\\mathbf{r}=(\\rho,0,z)$ denote an observation point with $z0$. Using the PEC boundary condition, image theory leads to a representation of the scalar potential proxy at $\\mathbf{r}$ as a superposition of the direct and image contributions, of the form\n$$\n\\Phi(\\mathbf{r}) = G(\\mathbf{r},\\mathbf{r}_{s}) - G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}}),\n$$\nwhere $\\mathbf{r}_{s}^{\\mathrm{im}}=(0,0,-h)$ is the mirror image of the source with respect to the plane $z=0$.\n\nFor small source heights $h \\to 0^{+}$, the two Green’s function terms become nearly equal over a wide region in the upper half-space $z0$, so that the difference can be orders of magnitude smaller than the magnitude of each term. In finite-precision arithmetic with machine unit roundoff $\\epsilon_{\\mathrm{mach}}$, this leads to severe subtractive cancellation if the difference is formed naively term-by-term.\n\nStarting from the fundamental definitions above and the chain rule, analyze the asymptotic behavior of the difference $G(\\mathbf{r},\\mathbf{r}_{s}) - G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ as $h \\to 0^{+}$, and deduce the conditioning of the naive subtraction in terms of $h$, $z$, $\\rho$, $k$, and $\\epsilon_{\\mathrm{mach}}$. Then, focusing strictly on fixed-precision arithmetic (i.e., $\\epsilon_{\\mathrm{mach}}$ is fixed and no extended precision is allowed), determine which of the following strategies will maintain $\\mathcal{O}(1)$ relative accuracy of $\\Phi(\\mathbf{r})$ uniformly as $h \\to 0^{+}$ by analytic rescaling, regrouping, or reformulation, and which will not.\n\nChoose all that apply.\n\nA. Compute $\\Phi(\\mathbf{r})$ by directly evaluating $G(\\mathbf{r},\\mathbf{r}_{s})$ and $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ in double precision and subtracting them, summing any additional image terms (if present) in straightforward forward order from largest to smallest magnitude.\n\nB. For each symmetric image pair contributing a difference of the form $G(\\mathbf{r},\\mathbf{r}_{+})-G(\\mathbf{r},\\mathbf{r}_{-})$ with $\\mathbf{r}_{\\pm}$ mirrored about $z=0$, algebraically factor common terms and evaluate the small differences using identities that avoid catastrophic cancellation, such as expressing $R_{+}-R_{-}$ via a difference-of-squares formula and evaluating $e^{i k (R_{-}-R_{+})}-1$ with a numerically stable routine for small arguments; more generally, replace the small-height difference by its first nonvanishing term obtained from a Taylor expansion in $h$.\n\nC. Use Kahan compensated summation over the list of image terms without any analytic regrouping or rescaling; this reduces rounding error of the summation and therefore guarantees $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$ relative error even when the exact result is $\\mathcal{O}(h)$.\n\nD. Reformulate the half-space Green’s function using its spectral (Sommerfeld) integral representation, and evaluate it via Ewald splitting or Poisson summation into a rapidly convergent sum of a real-space near-field and a spectral or modal far-field, each computed with matched accuracy; this avoids subtractive cancellation between nearly equal image contributions.\n\nE. Normalize each term $G(\\mathbf{r},\\mathbf{r}_{s})$ and $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ by its own magnitude before subtraction (i.e., rescale terms individually), then subtract and unscale the result; this prevents loss of significance in the subtraction of nearly equal terms.\n\nAnswer by selecting the correct option(s).", "solution": "The problem statement is critically validated as follows.\n\n**Step 1: Extract Givens**\n\n- **System:** A time-harmonic source above a planar Perfect Electric Counductor (PEC) plane at $z=0$ in free space.\n- **Governing Equations:** Maxwell's equations in the frequency domain, represented via a dyadic Green's function.\n- **Proxy Kernel:** The scalar Helmholtz Green's function, $G(\\mathbf{r},\\mathbf{r}') = \\dfrac{e^{i k |\\mathbf{r}-\\mathbf{r}'|}}{4 \\pi |\\mathbf{r}-\\mathbf{r}'|}$, where $k$ is the free-space wavenumber.\n- **Source Location:** $\\mathbf{r}_{s}=(0,0,h)$ with $h0$ being small.\n- **Image Source Location:** $\\mathbf{r}_{s}^{\\mathrm{im}}=(0,0,-h)$, the mirror image of the source.\n- **Observation Point:** $\\mathbf{r}=(\\rho,0,z)$ with $z0$.\n- **Potential Representation:** The scalar potential proxy is given by image theory as $\\Phi(\\mathbf{r}) = G(\\mathbf{r},\\mathbf{r}_{s}) - G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$.\n- **Numerical Issue:** For small $h \\to 0^{+}$, the terms $G(\\mathbf{r},\\mathbf{r}_{s})$ and $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ are nearly equal, leading to subtractive cancellation in finite-precision arithmetic with machine unit roundoff $\\epsilon_{\\mathrm{mach}}$.\n- **Task:** Analyze the asymptotic behavior of the difference as $h \\to 0^{+}$ and determine which of the provided strategies maintain $\\mathcal{O}(1)$ relative accuracy for $\\Phi(\\mathbf{r})$ uniformly as $h \\to 0^{+}$ in fixed-precision arithmetic.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem is firmly rooted in computational electromagnetics and numerical analysis. The use of a scalar Green's function as a proxy for the full dyadic Green's function to study a specific numerical pathology is a standard and valid simplification. The method of images for a PEC plane is a fundamental concept. The problem of subtractive cancellation is a canonical issue in numerical methods. The setup is scientifically and mathematically sound.\n- **Well-Posed:** The problem is well-posed. It asks for an evaluation of several well-defined numerical strategies against a clear criterion: maintaining bounded relative error as a parameter ($h$) goes to zero. A definite answer can be derived for each strategy.\n- **Objective:** The problem is stated in precise, technical language, free from subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is self-contained, scientifically sound, and well-posed. The analysis can proceed.\n\n### Derivation and Analysis\n\nThe scalar potential $\\Phi(\\mathbf{r})$ is given by the difference of two Green's function terms:\n$$\n\\Phi(\\mathbf{r}) = G(\\mathbf{r},\\mathbf{r}_{s}) - G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})\n$$\nThe distances from the source and image source to the observation point are:\n$$\nR_{s} = |\\mathbf{r} - \\mathbf{r}_{s}| = \\sqrt{\\rho^2 + (z-h)^2}\n$$\n$$\nR_{im} = |\\mathbf{r} - \\mathbf{r}_{s}^{\\mathrm{im}}| = \\sqrt{\\rho^2 + (z+h)^2}\n$$\nAs the source height $h$ approaches $0$, $R_s \\approx R_{im}$, which leads to $G(\\mathbf{r},\\mathbf{r}_{s}) \\approx G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$. A direct numerical evaluation of this difference involves subtracting two nearly identical floating-point numbers, a classic case of catastrophic subtractive cancellation.\n\nTo analyze the severity, we find the asymptotic behavior of $\\Phi(\\mathbf{r})$ for small $h$. We can view $\\Phi(\\mathbf{r})$ as $f(h) - f(-h)$, where $f(h) = G(\\mathbf{r}, (0,0,h))$. A Taylor expansion around $h=0$ gives:\n$$\n\\Phi(\\mathbf{r}) = (f(0) + f'(0)h + \\mathcal{O}(h^2)) - (f(0) - f'(0)h + \\mathcal{O}(h^2)) = 2 f'(0) h + \\mathcal{O}(h^3)\n$$\nThe leading-order behavior is linear in $h$. The derivative $f'(0)$ corresponds to $\\left. \\frac{\\partial G(\\mathbf{r}, \\mathbf{r}')}{\\partial z'} \\right|_{z'=0}$, where $\\mathbf{r}'=(0,0,z')$.\nThe magnitude of the individual terms $G(\\mathbf{r},\\mathbf{r}_{s})$ is $\\mathcal{O}(1)$, while the magnitude of their difference $\\Phi(\\mathbf{r})$ is $\\mathcal{O}(h)$.\nIn floating-point arithmetic, the absolute error in computing $G(\\mathbf{r},\\mathbf{r}_{s})$ is approximately $\\epsilon_{\\mathrm{mach}} |G(\\mathbf{r},\\mathbf{r}_{s})|$. The absolute error of the difference is thus on the order of $\\epsilon_{\\mathrm{mach}}$. The relative error in the computed $\\Phi(\\mathbf{r})$ is:\n$$\n\\text{Relative Error} = \\frac{\\text{Absolute Error}}{|\\Phi(\\mathbf{r})|} \\approx \\frac{\\mathcal{O}(\\epsilon_{\\mathrm{mach}})}{\\mathcal{O}(h)} = \\mathcal{O}\\left(\\frac{\\epsilon_{\\mathrm{mach}}}{h}\\right)\n$$\nAs $h \\to 0^{+}$, this relative error grows without bound. To maintain $\\mathcal{O}(1)$ relative accuracy, a strategy must avoid this $1/h$ scaling.\n\n### Option-by-Option Analysis\n\n**A. Compute $\\Phi(\\mathbf{r})$ by directly evaluating $G(\\mathbf{r},\\mathbf{r}_{s})$ and $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ in double precision and subtracting them, summing any additional image terms (if present) in straightforward forward order from largest to smallest magnitude.**\nThis option describes the naive subtraction that was analyzed above. As derived, this method suffers from catastrophic cancellation, leading to a relative error that scales as $\\mathcal{O}(1/h)$. It therefore fails to maintain $\\mathcal{O}(1)$ relative accuracy as $h \\to 0^{+}$.\n**Verdict: Incorrect.**\n\n**B. For each symmetric image pair contributing a difference of the form $G(\\mathbf{r},\\mathbf{r}_{+})-G(\\mathbf{r},\\mathbf{r}_{-})$ with $\\mathbf{r}_{\\pm}$ mirrored about $z=0$, algebraically factor common terms and evaluate the small differences using identities that avoid catastrophic cancellation, such as expressing $R_{+}-R_{-}$ via a difference-of-squares formula and evaluating $e^{i k (R_{-}-R_{+})}-1$ with a numerically stable routine for small arguments; more generally, replace the small-height difference by its first nonvanishing term obtained from a Taylor expansion in $h$.**\nThis option proposes valid analytical reformulations.\n1.  **Algebraic regrouping:** Small differences like $R_{im} - R_s = \\frac{R_{im}^2 - R_s^2}{R_{im} + R_s} = \\frac{4zh}{R_{im} + R_s}$ can be computed accurately. The term $e^{ikR_s} - e^{ikR_{im}}$ can be factored as $e^{ikR_{im}}(e^{ik(R_s - R_{im})} - 1)$, where the complex exponential of a small argument minus 1 can be computed accurately. This avoids the subtraction of nearly equal numbers.\n2.  **Taylor expansion:** Using the first nonvanishing term of the Taylor series, $\\Phi(\\mathbf{r}) \\approx 2h \\left. \\frac{\\partial G}{\\partial z'} \\right|_{z'=0}$, directly computes the $\\mathcal{O}(h)$ result without subtraction.\nBoth approaches are standard, effective techniques for this exact problem and will maintain a relative error of $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$.\n**Verdict: Correct.**\n\n**C. Use Kahan compensated summation over the list of image terms without any analytic regrouping or rescaling; this reduces rounding error of the summation and therefore guarantees $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$ relative error even when the exact result is $\\mathcal{O}(h)$.**\nKahan summation is an algorithm to mitigate the accumulation of round-off error when summing a long sequence of floating-point numbers. It cannot address subtractive cancellation in the difference of two nearly equal numbers, which is where the loss of significance occurs. For just two terms, Kahan summation is equivalent to direct subtraction. The claim that it \"guarantees $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$ relative error\" is false in this context.\n**Verdict: Incorrect.**\n\n**D. Reformulate the half-space Green’s function using its spectral (Sommerfeld) integral representation, and evaluate it via Ewald splitting or Poisson summation into a rapidly convergent sum of a real-space near-field and a spectral or modal far-field, each computed with matched accuracy; this avoids subtractive cancellation between nearly equal image contributions.**\nThis option proposes transforming the problem from the spatial domain to the spectral domain. The half-space Green's function can be written as a Sommerfeld integral. The term in the integrand responsible for the cancellation, $e^{-u_0|z-h|} - e^{-u_0(z+h)}$, can be analytically rewritten as $2e^{-u_0 z} \\sinh(u_0 h)$. For small $h$, $\\sinh(u_0h) \\approx u_0h$, making the $h$-dependence explicit and removing the numerical subtraction. The subsequent numerical integration is well-conditioned. This general class of methods successfully avoids the cancellation problem.\n**Verdict: Correct.**\n\n**E. Normalize each term $G(\\mathbf{r},\\mathbf{r}_{s})$ and $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ by its own magnitude before subtraction (i.e., rescale terms individually), then subtract and unscale the result; this prevents loss of significance in the subtraction of nearly equal terms.**\nThis strategy is ineffective. Let $G_s = G(\\mathbf{r},\\mathbf{r}_{s})$ and $G_{im} = G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$. As $h \\to 0^{+}$, we have $G_s \\approx G_{im}$, which means their magnitudes and phases are nearly equal. The proposed procedure calculates the difference of the normalized terms, $\\hat{G}_s - \\hat{G}_{im} = G_s/|G_s| - G_{im}/|G_{im}|$. Since $G_s \\approx G_{im}$, the unit-norm complex numbers $\\hat{G}_s$ and $\\hat{G}_{im}$ are also nearly equal. Subtracting them will result in the same catastrophic cancellation of significant digits.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{B, D}$$", "id": "3316475"}]}