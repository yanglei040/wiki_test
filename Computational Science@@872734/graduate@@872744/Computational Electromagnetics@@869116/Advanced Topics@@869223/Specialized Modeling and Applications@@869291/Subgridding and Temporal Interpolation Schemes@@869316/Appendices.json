{"hands_on_practices": [{"introduction": "A primary challenge in subgridding is the creation of spurious, non-physical reflections at the interface between coarse and fine grids. This exercise explores the fundamental origin of these reflections by extending the familiar concept of wave impedance from continuous media to the discrete domain. By defining a *numerical impedance* for each grid, you will derive the reflection and transmission coefficients at the interface, demonstrating analytically how a mismatch in the numerical properties of the schemes, rather than the physical media, governs interface performance [@problem_id:3351855].", "problem": "Consider a one-dimensional subgridding interface at $z=0$ between two Finite-Difference Time-Domain (FDTD) regions implementing the Yee scheme in lossless, identical media with permittivity $\\epsilon$ and permeability $\\mu$. The region $z0$ is a coarse grid with spatial step $\\Delta_c$ and time step $\\Delta t_c$; the region $z>0$ is a fine grid with spatial step $\\Delta_f$ and time step $\\Delta t_f$. Field exchange across the interface uses linear temporal interpolation on the fine-grid side to satisfy the coupling at the staggered Yee time levels. A normally incident Transverse Electric (TE) plane wave of angular frequency $\\omega$ propagates from $z0$ toward $z>0$. Let $E_i$ and $H_i$ denote the incident tangential electric and magnetic field phasor amplitudes in the coarse region, $E_r$ and $H_r$ the reflected amplitudes in the coarse region, and $E_t$ and $H_t$ the transmitted amplitudes in the fine region. Assume time-harmonic dependence $\\exp(-\\mathrm{i}\\omega t)$ and neglect sources beyond the incident wave.\n\nDefine the numerical impedance $Z(\\omega)$ in each region as the ratio of the tangential electric to magnetic field phasor amplitudes for a forward-traveling discrete plane wave that satisfies the local discrete dispersion relation and the local update scheme, including any modification induced by the linear temporal interpolation at the interface. Denote these impedances by $Z_c(\\omega)$ for the coarse region and $Z_f(\\omega)$ for the fine region. At $z=0$, the tangential electric and magnetic fields are continuous.\n\nUsing only the boundary conditions implied by Maxwell’s equations and the definition of numerical impedance for forward- and backward-traveling waves, derive the discrete reflection coefficient $R(\\omega)=E_r/E_i$ and transmission coefficient $T(\\omega)=E_t/E_i$ for the tangential electric field at the subgrid interface. Express $R(\\omega)$ explicitly in terms of the mismatch between $Z_c(\\omega)$ and $Z_f(\\omega)$, and give $T(\\omega)$ in closed form. The final answer must be a single closed-form analytic expression containing $R(\\omega)$ and $T(\\omega)$; no numerical evaluation is required. Both $R(\\omega)$ and $T(\\omega)$ are dimensionless. Do not round; provide exact expressions.", "solution": "The derivation is based on the principle of continuity for tangential electric and magnetic fields at the interface $z=0$. The relationship between the tangential electric and magnetic field phasors for forward- and backward-propagating waves is given by the numerical impedance of the respective grids.\n\nLet the tangential electric field be $E$ and the tangential magnetic field be $H$. In the coarse grid region ($z0$), the total field is the superposition of the incident and reflected waves.\nThe total tangential electric field at the interface is:\n$$\nE_{total, c} = E_{i} + E_{r}\n$$\nThe total tangential magnetic field is the sum of the magnetic fields associated with the incident and reflected waves. The numerical impedance $Z_{c}(\\omega)$ is defined for a forward-propagating wave (incident wave):\n$$\nH_{i} = \\frac{E_{i}}{Z_{c}(\\omega)}\n$$\nFor a backward-propagating wave (reflected wave), the relationship between the field components is inverted relative to the direction of propagation. For a plane wave, the sign of the ratio of tangential E to H fields depends on the direction of power flow. For a backward wave (propagating in the $-z$ direction), the relationship is:\n$$\nH_{r} = -\\frac{E_{r}}{Z_{c}(\\omega)}\n$$\nThus, the total tangential magnetic field in the coarse region at the interface is:\n$$\nH_{total, c} = H_{i} + H_{r} = \\frac{E_{i}}{Z_{c}(\\omega)} - \\frac{E_{r}}{Z_{c}(\\omega)}\n$$\n\nIn the fine grid region ($z>0$), there is only a forward-propagating transmitted wave.\nThe total tangential electric field at the interface is:\n$$\nE_{total, f} = E_{t}\n$$\nThe corresponding tangential magnetic field is determined by the numerical impedance of the fine grid, $Z_{f}(\\omega)$, which is defined to include the effects of the temporal interpolation scheme at the interface:\n$$\nH_{total, f} = H_{t} = \\frac{E_{t}}{Z_{f}(\\omega)}\n$$\n\nMaxwell's equations require that the tangential components of the electric and magnetic fields be continuous across the interface at $z=0$, assuming no surface currents or charge densities.\nThe continuity of the tangential electric field yields:\n$$\nE_{total, c} = E_{total, f} \\implies E_{i} + E_{r} = E_{t} \\quad \\quad (1)\n$$\nThe continuity of the tangential magnetic field yields:\n$$\nH_{total, c} = H_{total, f} \\implies \\frac{E_{i}}{Z_{c}(\\omega)} - \\frac{E_{r}}{Z_{c}(\\omega)} = \\frac{E_{t}}{Z_{f}(\\omega)} \\quad \\quad (2)\n$$\n\nWe now have a system of two linear equations for the amplitudes $E_r$ and $E_t$ in terms of the incident amplitude $E_i$. Our goal is to find the ratios $R(\\omega) = E_{r}/E_{i}$ and $T(\\omega) = E_{t}/E_{i}$.\n\nFirst, we solve for the reflection coefficient $R(\\omega)$. We can eliminate $E_t$ by substituting equation $(1)$ into equation $(2)$:\n$$\n\\frac{1}{Z_{c}(\\omega)} (E_{i} - E_{r}) = \\frac{E_{i} + E_{r}}{Z_{f}(\\omega)}\n$$\nTo solve for the ratio $E_r/E_i$, we rearrange the equation to group terms with $E_i$ and $E_r$:\n$$\nZ_{f}(\\omega) (E_{i} - E_{r}) = Z_{c}(\\omega) (E_{i} + E_{r})\n$$\n$$\nE_{i} Z_{f}(\\omega) - E_{r} Z_{f}(\\omega) = E_{i} Z_{c}(\\omega) + E_{r} Z_{c}(\\omega)\n$$\n$$\nE_{i} (Z_{f}(\\omega) - Z_{c}(\\omega)) = E_{r} (Z_{f}(\\omega) + Z_{c}(\\omega))\n$$\nThe reflection coefficient $R(\\omega)$ is then:\n$$\nR(\\omega) = \\frac{E_{r}}{E_{i}} = \\frac{Z_{f}(\\omega) - Z_{c}(\\omega)}{Z_{f}(\\omega) + Z_{c}(\\omega)}\n$$\nThis expression gives the reflection coefficient in terms of the mismatch between the numerical impedances of the two regions, as required.\n\nNext, we solve for the transmission coefficient $T(\\omega) = E_{t}/E_{i}$. From equation $(1)$, we can write:\n$$\n\\frac{E_{t}}{E_{i}} = \\frac{E_{i} + E_{r}}{E_{i}} = 1 + \\frac{E_{r}}{E_{i}}\n$$\nSubstituting the derived expression for $R(\\omega) = E_r/E_i$:\n$$\nT(\\omega) = 1 + R(\\omega) = 1 + \\frac{Z_{f}(\\omega) - Z_{c}(\\omega)}{Z_{f}(\\omega) + Z_{c}(\\omega)}\n$$\nTo obtain a closed form, we combine the terms over a common denominator:\n$$\nT(\\omega) = \\frac{(Z_{f}(\\omega) + Z_{c}(\\omega)) + (Z_{f}(\\omega) - Z_{c}(\\omega))}{Z_{f}(\\omega) + Z_{c}(\\omega)}\n$$\n$$\nT(\\omega) = \\frac{2 Z_{f}(\\omega)}{Z_{f}(\\omega) + Z_{c}(\\omega)}\n$$\nThis is the closed-form expression for the transmission coefficient. The two expressions for $R(\\omega)$ and $T(\\omega)$ constitute the complete solution.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nR(\\omega) = \\frac{Z_{f}(\\omega) - Z_{c}(\\omega)}{Z_{f}(\\omega) + Z_{c}(\\omega)}  T(\\omega) = \\frac{2 Z_{f}(\\omega)}{Z_{f}(\\omega) + Z_{c}(\\omega)}\n\\end{pmatrix}\n}\n$$", "id": "3351855"}, {"introduction": "Beyond generating spurious reflections, simple interpolation schemes can violate fundamental conservation laws, introducing numerical artifacts that compromise the physical realism of a simulation. This practice focuses on one of the most critical laws: the conservation of energy. You will quantify the \"energy defect\" introduced by a standard linear temporal interpolation scheme over a single coarse time step, revealing how this seemingly intuitive approach fails to preserve the discrete energy balance of the system [@problem_id:3351891].", "problem": "A one-dimensional transverse electromagnetic plane wave of angular frequency $\\omega$ and electric-field amplitude $E_0$ propagates from a coarse uniform grid into a fine uniform grid in a finite-difference time-domain (FDTD) subgridding interface. The coarse grid uses a time step $\\Delta t_c$ and the fine grid uses a time step $\\Delta t_f$, with $\\Delta t_f$ an integer subdivision of $\\Delta t_c$. The tangential electric and magnetic fields at the interface on the fine side are supplied at the fine time instants by linear temporal interpolation of the coarse-grid field samples taken at times $t_k = k \\Delta t_c$. Assume normal incidence and neglect spatial staggering at the interface.\n\nLet the discrete impedances (the ratio of the numerically supported plane-wave tangential electric field to magnetic field for the propagating mode at angular frequency $\\omega$) of the coarse and fine grids be $Z_c(\\omega)$ and $Z_f(\\omega)$, respectively. On the coarse grid, the fields of the incident wave satisfy $H_c(t) = E_c(t)/Z_c(\\omega)$, and on the fine grid, an ideally transmitted wave would satisfy $H_f(t) = E_f(t)/Z_f(\\omega)$. Consider a single coarse time interval $t \\in [0,\\Delta t_c]$, and assume the incident electric field is $E_c(t) = E_0 \\cos(\\omega t)$ over this interval, so that the coarse samples at $t=0$ and $t=\\Delta t_c$ are $E_0$ and $E_0 \\cos(\\omega \\Delta t_c)$, respectively.\n\nDefine the instantaneous energy flux density crossing the interface as the scalar Poynting product $S(t) = E(t) H(t)$, and define the fractional energy defect over one coarse time step as\n$$\n\\delta \\equiv \\frac{\\displaystyle \\int_{0}^{\\Delta t_c} E_{\\mathrm{interp}}(t)\\, H_{\\mathrm{interp}}(t)\\, dt - \\int_{0}^{\\Delta t_c} \\frac{E_{\\mathrm{exact}}(t)^2}{Z_f(\\omega)}\\, dt}{\\displaystyle \\int_{0}^{\\Delta t_c} \\frac{E_{\\mathrm{exact}}(t)^2}{Z_f(\\omega)}\\, dt},\n$$\nwhere $E_{\\mathrm{interp}}(t)$ and $H_{\\mathrm{interp}}(t)$ are the linearly time-interpolated fields on the fine side constructed from the coarse samples, and $E_{\\mathrm{exact}}(t) = E_0 \\cos(\\omega t)$ is the exact harmonic field. Starting from Maxwell’s equations and the definition of the Poynting flux, derive and provide a closed-form analytic expression for $\\delta$ in terms of $\\omega \\Delta t_c$ and the impedance mismatch quantified by $Z_f(\\omega)/Z_c(\\omega)$. Express your final answer as a single analytical expression; no numerical approximation or rounding is required.", "solution": "The fractional energy defect $\\delta$ is defined as:\n$$\n\\delta = \\frac{\\displaystyle \\int_{0}^{\\Delta t_c} E_{\\mathrm{interp}}(t)\\, H_{\\mathrm{interp}}(t)\\, dt}{\\displaystyle \\int_{0}^{\\Delta t_c} \\frac{E_{\\mathrm{exact}}(t)^2}{Z_f(\\omega)}\\, dt} - 1\n$$\nLet us denote the numerator of this fraction as $I_{\\mathrm{interp}}$ and the denominator as $I_{\\mathrm{exact}}$.\n\n**1. Formulation of Interpolated Fields**\n\nThe coarse-grid electric field samples at the boundaries of the time interval $[0, \\Delta t_c]$ are:\n$$\nE_1 = E_c(0) = E_0 \\cos(0) = E_0\n$$\n$$\nE_2 = E_c(\\Delta t_c) = E_0 \\cos(\\omega \\Delta t_c)\n$$\nLinear interpolation over $t \\in [0, \\Delta t_c]$ gives the interpolated electric field $E_{\\mathrm{interp}}(t)$:\n$$\nE_{\\mathrm{interp}}(t) = E_1 + \\frac{t - 0}{\\Delta t_c - 0}(E_2 - E_1) = E_0 + \\frac{t}{\\Delta t_c}(E_0 \\cos(\\omega \\Delta t_c) - E_0)\n$$\n$$\nE_{\\mathrm{interp}}(t) = E_0\\left(1 - \\frac{t}{\\Delta t_c}(1 - \\cos(\\omega \\Delta t_c))\\right)\n$$\nThe coarse-grid magnetic field samples are derived from the electric field samples using the coarse-grid impedance $Z_c(\\omega)$:\n$$\nH_1 = \\frac{E_1}{Z_c(\\omega)} = \\frac{E_0}{Z_c(\\omega)}\n$$\n$$\nH_2 = \\frac{E_2}{Z_c(\\omega)} = \\frac{E_0 \\cos(\\omega \\Delta t_c)}{Z_c(\\omega)}\n$$\nLinearly interpolating these magnetic field samples gives $H_{\\mathrm{interp}}(t)$:\n$$\nH_{\\mathrm{interp}}(t) = H_1 + \\frac{t}{\\Delta t_c}(H_2 - H_1) = \\frac{E_0}{Z_c(\\omega)}\\left(1 - \\frac{t}{\\Delta t_c}(1 - \\cos(\\omega \\Delta t_c))\\right)\n$$\nFrom these expressions, we observe that $H_{\\mathrm{interp}}(t) = E_{\\mathrm{interp}}(t)/Z_c(\\omega)$.\n\n**2. Calculation of the Interpolated Energy Flux Integral ($I_{\\mathrm{interp}}$)**\n\nThe integral of the interpolated Poynting flux is:\n$$\nI_{\\mathrm{interp}} = \\int_{0}^{\\Delta t_c} E_{\\mathrm{interp}}(t) H_{\\mathrm{interp}}(t) dt = \\int_{0}^{\\Delta t_c} \\frac{E_{\\mathrm{interp}}(t)^2}{Z_c(\\omega)} dt\n$$\nTo simplify the calculation, let $\\theta = \\omega \\Delta t_c$.\n$$\nI_{\\mathrm{interp}} = \\frac{E_0^2}{Z_c(\\omega)} \\int_{0}^{\\Delta t_c} \\left(1 - \\frac{t}{\\Delta t_c}(1 - \\cos\\theta)\\right)^2 dt\n$$\nLet's use the substitution $u = t/\\Delta t_c$, so $dt = \\Delta t_c du$. The limits of integration become $0$ to $1$.\n$$\nI_{\\mathrm{interp}} = \\frac{E_0^2 \\Delta t_c}{Z_c(\\omega)} \\int_{0}^{1} \\left(1 - u(1 - \\cos\\theta)\\right)^2 du\n$$\n$$\nI_{\\mathrm{interp}} = \\frac{E_0^2 \\Delta t_c}{Z_c(\\omega)} \\int_{0}^{1} \\left(1 - 2u(1 - \\cos\\theta) + u^2(1 - \\cos\\theta)^2\\right) du\n$$\n$$\nI_{\\mathrm{interp}} = \\frac{E_0^2 \\Delta t_c}{Z_c(\\omega)} \\left[u - u^2(1 - \\cos\\theta) + \\frac{u^3}{3}(1 - \\cos\\theta)^2\\right]_0^1\n$$\n$$\nI_{\\mathrm{interp}} = \\frac{E_0^2 \\Delta t_c}{Z_c(\\omega)} \\left(1 - (1 - \\cos\\theta) + \\frac{1}{3}(1 - \\cos\\theta)^2\\right)\n$$\n$$\nI_{\\mathrm{interp}} = \\frac{E_0^2 \\Delta t_c}{Z_c(\\omega)} \\left(\\cos\\theta + \\frac{1}{3}(1 - 2\\cos\\theta + \\cos^2\\theta)\\right)\n$$\n$$\nI_{\\mathrm{interp}} = \\frac{E_0^2 \\Delta t_c}{Z_c(\\omega)} \\left(\\frac{3\\cos\\theta + 1 - 2\\cos\\theta + \\cos^2\\theta}{3}\\right)\n$$\n$$\nI_{\\mathrm{interp}} = \\frac{E_0^2 \\Delta t_c}{3Z_c(\\omega)} (1 + \\cos\\theta + \\cos^2\\theta)\n$$\n\n**3. Calculation of the Exact Energy Flux Integral ($I_{\\mathrm{exact}}$)**\n\nThe integral of the ideal energy flux, which corresponds to perfect transmission into the fine grid medium, is:\n$$\nI_{\\mathrm{exact}} = \\int_{0}^{\\Delta t_c} \\frac{E_{\\mathrm{exact}}(t)^2}{Z_f(\\omega)} dt = \\frac{E_0^2}{Z_f(\\omega)} \\int_{0}^{\\Delta t_c} \\cos^2(\\omega t) dt\n$$\nUsing the identity $\\cos^2(x) = \\frac{1}{2}(1 + \\cos(2x))$:\n$$\nI_{\\mathrm{exact}} = \\frac{E_0^2}{Z_f(\\omega)} \\int_{0}^{\\Delta t_c} \\frac{1}{2}(1 + \\cos(2\\omega t)) dt\n$$\n$$\nI_{\\mathrm{exact}} = \\frac{E_0^2}{2Z_f(\\omega)} \\left[t + \\frac{\\sin(2\\omega t)}{2\\omega}\\right]_0^{\\Delta t_c}\n$$\n$$\nI_{\\mathrm{exact}} = \\frac{E_0^2}{2Z_f(\\omega)} \\left(\\Delta t_c + \\frac{\\sin(2\\omega \\Delta t_c)}{2\\omega}\\right) = \\frac{E_0^2 \\Delta t_c}{2Z_f(\\omega)} \\left(1 + \\frac{\\sin(2\\omega \\Delta t_c)}{2\\omega \\Delta t_c}\\right)\n$$\nSubstituting $\\theta = \\omega \\Delta t_c$:\n$$\nI_{\\mathrm{exact}} = \\frac{E_0^2 \\Delta t_c}{2Z_f(\\omega)} \\left(1 + \\frac{\\sin(2\\theta)}{2\\theta}\\right)\n$$\n\n**4. Derivation of the Fractional Energy Defect ($\\delta$)**\n\nNow, we compute $\\delta$ using its definition:\n$$\n\\delta = \\frac{I_{\\mathrm{interp}}}{I_{\\mathrm{exact}}} - 1\n$$\n$$\n\\frac{I_{\\mathrm{interp}}}{I_{\\mathrm{exact}}} = \\frac{\\frac{E_0^2 \\Delta t_c}{3Z_c(\\omega)} (1 + \\cos\\theta + \\cos^2\\theta)}{\\frac{E_0^2 \\Delta t_c}{2Z_f(\\omega)} \\left(1 + \\frac{\\sin(2\\theta)}{2\\theta}\\right)}\n$$\nThe term $E_0^2 \\Delta t_c$ cancels out.\n$$\n\\frac{I_{\\mathrm{interp}}}{I_{\\mathrm{exact}}} = \\frac{Z_f(\\omega)}{Z_c(\\omega)} \\cdot \\frac{2}{3} \\cdot \\frac{1 + \\cos\\theta + \\cos^2\\theta}{1 + \\frac{\\sin(2\\theta)}{2\\theta}}\n$$\nUsing the identity $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$, the denominator becomes $1 + \\frac{\\sin\\theta\\cos\\theta}{\\theta} = \\frac{\\theta + \\sin\\theta\\cos\\theta}{\\theta}$.\n$$\n\\frac{I_{\\mathrm{interp}}}{I_{\\mathrm{exact}}} = \\frac{Z_f(\\omega)}{Z_c(\\omega)} \\cdot \\frac{2 (1 + \\cos\\theta + \\cos^2\\theta)}{3 \\left(\\frac{\\theta + \\sin\\theta\\cos\\theta}{\\theta}\\right)} = \\frac{Z_f(\\omega)}{Z_c(\\omega)} \\cdot \\frac{2\\theta(1 + \\cos\\theta + \\cos^2\\theta)}{3(\\theta + \\sin\\theta\\cos\\theta)}\n$$\nSubstituting this back into the expression for $\\delta$ and replacing $\\theta$ with $\\omega \\Delta t_c$:\n$$\n\\delta = \\frac{2\\omega \\Delta t_c \\frac{Z_f(\\omega)}{Z_c(\\omega)} (1 + \\cos(\\omega \\Delta t_c) + \\cos^2(\\omega \\Delta t_c))}{3(\\omega \\Delta t_c + \\sin(\\omega \\Delta t_c)\\cos(\\omega \\Delta t_c))} - 1\n$$\nThis is the final closed-form analytic expression for the fractional energy defect.", "answer": "$$\n\\boxed{\\frac{2\\omega \\Delta t_c \\frac{Z_f(\\omega)}{Z_c(\\omega)}\\left(1 + \\cos(\\omega \\Delta t_c) + \\cos^2(\\omega \\Delta t_c)\\right)}{3\\left(\\omega \\Delta t_c + \\sin(\\omega \\Delta t_c)\\cos(\\omega \\Delta t_c)\\right)} - 1}\n$$", "id": "3351891"}, {"introduction": "Having analyzed the flaws of basic interpolation, we now transition to the proactive design of superior schemes. This exercise reframes the challenge of choosing interpolation weights as a formal constrained optimization problem, a powerful technique in modern algorithm development. You will minimize a multi-objective cost function that balances competing error metrics—related to reflection, dispersion, and divergence—subject to an essential constraint for numerical stability, thereby deriving an optimal set of weights from first principles [@problem_id:3351870].", "problem": "Consider one-dimensional, lossless Transverse Electromagnetic (TEM) wave propagation governed by Maxwell's equations,\n$$\\frac{\\partial E}{\\partial t}=\\frac{1}{\\varepsilon}\\frac{\\partial H}{\\partial x},\\qquad \\frac{\\partial H}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E}{\\partial x},$$\ndiscretized by the leapfrog Yee scheme in a uniform medium with permittivity $\\varepsilon$ and permeability $\\mu$. A subgridded region with a fine time step $\\Delta t_f$ is embedded in a coarse grid with time step $\\Delta t_c=3\\,\\Delta t_f$. To couple the coarse-grid magnetic field $H$ into the fine-grid update, suppose the temporal interpolation on the fine substeps $j\\in\\{0,1,2\\}$ within the coarse step from time index $n$ to $n+1$ is defined by\n$$H^{n+j/3}=\\alpha_j\\,H^n+(1-\\alpha_j)H^{n+1},$$\nwhere the interpolation weights $\\alpha_j$ are to be chosen.\n\nDefine three error proxies that quantify interface quality:\n- A reflection proxy $r(\\boldsymbol{\\alpha})= \\boldsymbol{u}^{\\top}\\boldsymbol{\\alpha}$ with $\\boldsymbol{u}=\\begin{pmatrix}1\\\\-2\\\\1\\end{pmatrix}$, representing discrete impedance asymmetry.\n- A dispersion proxy $d(\\boldsymbol{\\alpha})=\\boldsymbol{v}^{\\top}\\boldsymbol{\\alpha}-\\frac{3}{2}$ with $\\boldsymbol{v}=\\begin{pmatrix}0\\\\1\\\\2\\end{pmatrix}$, representing first temporal-moment matching across the substeps.\n- A discrete divergence proxy $g(\\boldsymbol{\\alpha})=\\boldsymbol{\\delta}^{\\top}\\boldsymbol{\\alpha}$ with $\\boldsymbol{\\delta}=\\begin{pmatrix}1\\\\1\\\\-2\\end{pmatrix}$, representing co-location consistency of staggered fields near the interface.\n\nAggregate these into the multi-objective cost\n$$J(\\boldsymbol{\\alpha})=w_{r}\\,r(\\boldsymbol{\\alpha})^{2}+w_{d}\\,d(\\boldsymbol{\\alpha})^{2}+w_{g}\\,g(\\boldsymbol{\\alpha})^{2},$$\nwith weights $w_{r}=1$, $w_{d}=2$, and $w_{g}=3$.\n\nFor the leapfrog update across the interface, the one-step amplification matrix that maps the interface state $\\boldsymbol{s}^{n}$ to $\\boldsymbol{s}^{n+1}$ is energy-non-increasing to first order in $\\Delta t_{c}$ if and only if the integrated coarse-field influence equals one-half of the total coarse-to-fine exchange over the three substeps. Under the interpolation model above, this reduces to the linear stability constraint\n$$\\alpha_0+\\alpha_1+\\alpha_2=\\frac{3}{2}.$$\n\nStarting from Maxwell's equations and the discrete leapfrog energy balance for the Yee scheme, motivate the stability constraint as stated, and then formulate and solve the constrained optimization problem\n$$\\min_{\\boldsymbol{\\alpha}\\in\\mathbb{R}^{3}} J(\\boldsymbol{\\alpha})\\quad \\text{subject to}\\quad \\alpha_0+\\alpha_1+\\alpha_2=\\frac{3}{2}.$$\n\nExpress your final answer as the exact weights $\\alpha_0$, $\\alpha_1$, and $\\alpha_2$ in simplest fractional form. No rounding is required. The weights are dimensionless; do not attach any physical units to the answer.", "solution": "The problem presents two tasks: first, to motivate a given stability constraint for a temporal subgridding scheme in the context of the Finite-Difference Time-Domain (FDTD) method; and second, to solve a constrained optimization problem to find the optimal temporal interpolation weights.\n\nThe one-dimensional, lossless TEM wave propagation is described by Maxwell's equations:\n$$\n\\frac{\\partial E}{\\partial t} = \\frac{1}{\\varepsilon}\\frac{\\partial H}{\\partial x}\n$$\n$$\n\\frac{\\partial H}{\\partial t} = \\frac{1}{\\mu}\\frac{\\partial E}{\\partial x}\n$$\nThe leapfrog Yee scheme is a second-order accurate, explicit time-marching method for these equations. In a uniform grid, it is known to be stable under the Courant-Friedrichs-Lewy (CFL) condition, and it conserves a discrete energy quantity, which is a discrete analogue of the continuous electromagnetic energy. This property ensures that the numerical solution does not grow spuriously in time.\n\nThe problem describes a subgridding scenario where a fine grid with time step $\\Delta t_{f}$ is embedded within a coarse grid with time step $\\Delta t_{c} = 3\\,\\Delta t_{f}$. At the interface, information must be passed from the coarse grid to the fine grid. The problem specifies an interpolation scheme for the coarse-grid magnetic field $H$ to provide boundary conditions for the fine-grid updates:\n$$\nH^{n+\\frac{j}{3}} = \\alpha_{j}\\,H^{n} + (1-\\alpha_{j})\\,H^{n+1} \\quad \\text{for } j \\in \\{0, 1, 2\\}\n$$\nHere, $H^{n}$ and $H^{n+1}$ are the known coarse-grid field values at the beginning and end of a coarse time step. The values $H^{n+j/3}$ are the interpolated fields used during the three fine substeps.\n\nFor the overall scheme to remain stable, the interpolation must not introduce artificial energy into the system. A key requirement for stability and second-order accuracy of leapfrog-type schemes at interfaces is that the numerical scheme, including the interpolation, remains consistent with the centered nature of the underlying algorithm. Over the duration of one coarse time step, from $t^n$ to $t^{n+1}$, the time-averaged value of the interpolated field should match the trapezoidal rule approximation of the integral of the field over that interval, which is centered at time $t^{n+1/2}$.\n\nThe time-averaged value of the interpolated $H$ field over the coarse step $\\Delta t_c$ is the average of its values at the three substeps:\n$$\n\\bar{H} = \\frac{1}{3} \\sum_{j=0}^{2} H^{n+\\frac{j}{3}}\n$$\nSubstituting the interpolation formula:\n$$\n\\bar{H} = \\frac{1}{3} \\sum_{j=0}^{2} \\left[ \\alpha_{j}\\,H^{n} + (1-\\alpha_{j})\\,H^{n+1} \\right]\n$$\n$$\n\\bar{H} = \\frac{1}{3} \\left[ (\\alpha_{0}+\\alpha_{1}+\\alpha_{2}) H^{n} + ( (1-\\alpha_{0}) + (1-\\alpha_{1}) + (1-\\alpha_{2}) ) H^{n+1} \\right]\n$$\n$$\n\\bar{H} = \\left( \\frac{1}{3} \\sum_{j=0}^{2} \\alpha_{j} \\right) H^{n} + \\left( 1 - \\frac{1}{3} \\sum_{j=0}^{2} \\alpha_{j} \\right) H^{n+1}\n$$\nA second-order accurate, centered approximation for the average value of $H$ over the interval $[t^n, t^{n+1}]$ is simply the average of its endpoint values:\n$$\n\\bar{H}_{centered} = \\frac{H^n + H^{n+1}}{2}\n$$\nFor the interpolation to be consistent with the centered-difference nature of the leapfrog scheme and to maintain stability, these two expressions for the average field must be equivalent. Equating the coefficients of $H^n$ (or $H^{n+1}$):\n$$\n\\frac{1}{3} \\sum_{j=0}^{2} \\alpha_{j} = \\frac{1}{2}\n$$\nMultiplying by $3$ gives the linear stability constraint:\n$$\n\\alpha_{0}+\\alpha_{1}+\\alpha_{2}=\\frac{3}{2}\n$$\nThis condition ensures that, on average, the interpolated field behaves like a simple centered average, which is crucial for preventing the artificial growth of numerical energy at the coarse-fine grid interface. This corresponds to the problem statement's condition that \"the integrated coarse-field influence equals one-half of the total coarse-to-fine exchange\".\n\nThe second task is to find the vector of weights $\\boldsymbol{\\alpha} = \\begin{pmatrix} \\alpha_{0}  \\alpha_{1}  \\alpha_{2} \\end{pmatrix}^{\\top}$ that minimizes the cost function $J(\\boldsymbol{\\alpha})$ subject to the stability constraint derived above. The cost function $J(\\boldsymbol{\\alpha})$ is a sum of squared terms, with positive weights $w_r, w_d, w_g > 0$. Therefore, $J(\\boldsymbol{\\alpha}) \\ge 0$ for all $\\boldsymbol{\\alpha} \\in \\mathbb{R}^3$. The absolute minimum value of $J(\\boldsymbol{\\alpha})$ is $0$, which is achieved if and only if all three error proxies are simultaneously zero. If we can find a vector $\\boldsymbol{\\alpha}$ that satisfies these three equations and also satisfies the stability constraint, this vector will be the solution to the constrained optimization problem, as it achieves the global minimum of the cost function while respecting the constraint.\n\nLet's solve the system of linear equations arising from setting the proxies to zero:\n1. $\\alpha_{0} - 2\\alpha_{1} + \\alpha_{2} = 0$\n2. $\\alpha_{1} + 2\\alpha_{2} - \\frac{3}{2} = 0$\n3. $\\alpha_{0} + \\alpha_{1} - 2\\alpha_{2} = 0$\n\nFrom equation (2), we can express $\\alpha_{1}$ in terms of $\\alpha_{2}$:\n$$\n\\alpha_{1} = \\frac{3}{2} - 2\\alpha_{2}\n$$\nFrom equation (3), we can express $\\alpha_{0}$ in terms of $\\alpha_{1}$ and $\\alpha_{2}$:\n$$\n\\alpha_{0} = 2\\alpha_{2} - \\alpha_{1}\n$$\nSubstitute the expression for $\\alpha_{1}$ into this equation for $\\alpha_{0}$:\n$$\n\\alpha_{0} = 2\\alpha_{2} - \\left(\\frac{3}{2} - 2\\alpha_{2}\\right) = 4\\alpha_{2} - \\frac{3}{2}\n$$\nNow we have expressions for both $\\alpha_{0}$ and $\\alpha_{1}$ in terms of $\\alpha_{2}$. Substitute these into equation (1):\n$$\n\\left(4\\alpha_{2} - \\frac{3}{2}\\right) - 2\\left(\\frac{3}{2} - 2\\alpha_{2}\\right) + \\alpha_{2} = 0\n$$\n$$\n4\\alpha_{2} - \\frac{3}{2} - 3 + 4\\alpha_{2} + \\alpha_{2} = 0\n$$\n$$\n9\\alpha_{2} - \\frac{9}{2} = 0\n$$\n$$\n9\\alpha_{2} = \\frac{9}{2} \\implies \\alpha_{2} = \\frac{1}{2}\n$$\nNow, back-substitute to find $\\alpha_{0}$ and $\\alpha_{1}$:\n$$\n\\alpha_{1} = \\frac{3}{2} - 2\\alpha_{2} = \\frac{3}{2} - 2\\left(\\frac{1}{2}\\right) = \\frac{3}{2} - 1 = \\frac{1}{2}\n$$\n$$\n\\alpha_{0} = 4\\alpha_{2} - \\frac{3}{2} = 4\\left(\\frac{1}{2}\\right) - \\frac{3}{2} = 2 - \\frac{3}{2} = \\frac{1}{2}\n$$\nThe unique solution that makes all error proxies zero is $\\alpha_{0} = \\frac{1}{2}$, $\\alpha_{1} = \\frac{1}{2}$, and $\\alpha_{2} = \\frac{1}{2}$.\n\nFinally, we must verify if this solution satisfies the stability constraint:\n$$\n\\alpha_{0}+\\alpha_{1}+\\alpha_{2} = \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} = \\frac{3}{2}\n$$\nThe constraint is satisfied. Since this set of weights makes the cost function $J(\\boldsymbol{\\alpha})$ attain its absolute minimum value of $0$ while also satisfying the constraint, this is the solution to the constrained optimization problem.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha_0 = \\frac{1}{2}  \\alpha_1 = \\frac{1}{2}  \\alpha_2 = \\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "3351870"}]}