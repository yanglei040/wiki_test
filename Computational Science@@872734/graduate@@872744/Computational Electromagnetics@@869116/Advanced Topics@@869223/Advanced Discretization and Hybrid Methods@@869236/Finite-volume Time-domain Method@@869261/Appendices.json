{"hands_on_practices": [{"introduction": "At the heart of the Finite-Volume Time-Domain (FVTD) method lies the direct application of Maxwell's equations in their integral form. This first practice takes you back to this fundamental principle, using a deliberately simplified scenario to strip away complexity and reveal the core mechanism of the FVTD update [@problem_id:3307958]. By considering a single cell with uniform fields, you will analytically confirm that the temporal evolution of fields within a volume is driven exclusively by the spatial variations of the fields at its boundary, a concept embodied by the surface flux integrals.", "problem": "Consider a single cubic control volume used in the Finite-Volume Time-Domain (FVTD) method for computational electromagnetics. The cube has side length $\\Delta$ and its boundary $\\partial V$ consists of six planar faces with outward unit normals $\\mathbf{n}_{f}$. Inside the cube there are no sources, so the free current density is $\\mathbf{J}=\\mathbf{0}$ and there are no impressed magnetic monopoles. At an instant of time, the electric field and magnetic field are uniform within the cube and equal to $\\mathbf{E}=(E_{0},0,0)$ and $\\mathbf{H}=(0,H_{0},0)$, respectively. \n\nStarting from first principles (Maxwell’s equations in their local differential form) and using volume integration and appropriate vector integral identities consistent with the FVTD framework, compute:\n1. The net surface-integrated flux vectors \n$$\\mathbf{F}_{E}\\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{E}\\, \\mathrm{d}S \\quad \\text{and} \\quad \\mathbf{F}_{H}\\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{H}\\, \\mathrm{d}S.$$\n2. The instantaneous time derivatives of the cell-averaged magnetic flux density and electric flux density,\n$$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle \\quad \\text{and} \\quad \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle,$$\nwhere $\\langle \\mathbf{B}\\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{B}\\,\\mathrm{d}V$, $\\langle \\mathbf{D}\\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{D}\\,\\mathrm{d}V$, and $V=\\Delta^{3}$ is the cube volume.\n\nExpress $\\mathbf{F}_{E}$ in units of volt-meter, $\\mathbf{F}_{H}$ in ampere-meter, $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$ in tesla per second, and $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$ in coulomb per square meter per second. Provide your final answer as a single row matrix containing, in this order,\n$$\\left[F_{E,x},\\,F_{E,y},\\,F_{E,z},\\,F_{H,x},\\,F_{H,y},\\,F_{H,z},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{x},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{y},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{z},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{x},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{y},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{z}\\right].$$\n\nNo rounding is required. The final answer must be a single analytical expression as specified above.", "solution": "The analysis of the problem begins with Maxwell's equations in their local, differential form, within a source-free region where the free current density is $\\mathbf{J}=\\mathbf{0}$ and there are no magnetic monopoles. The two relevant equations are Faraday's law of induction and the Ampere-Maxwell law:\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t} = \\frac{\\partial \\mathbf{D}}{\\partial t} $$\nHere, $\\mathbf{E}$ is the electric field, $\\mathbf{H}$ is the magnetic field, $\\mathbf{B}$ is the magnetic flux density, and $\\mathbf{D}$ is the electric flux density.\n\nThe problem requires the calculation of two types of quantities: surface-integrated flux vectors and time derivatives of cell-averaged fields. Both calculations rely on a general vector integral identity that relates a volume integral of the curl of a vector field to a surface integral over the boundary of the volume. For any continuously differentiable vector field $\\mathbf{A}$ and a volume $V$ with boundary surface $\\partial V$, this identity is:\n$$ \\int_{V} (\\nabla \\times \\mathbf{A}) \\, \\mathrm{d}V = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{A} \\, \\mathrm{d}S $$\nwhere $\\mathbf{n}$ is the outward unit normal to the surface element $\\mathrm{d}S$.\n\nThe problem states that at the instant of consideration, the electric and magnetic fields are uniform within the cubic control volume. Specifically, $\\mathbf{E}=(E_{0},0,0)$ and $\\mathbf{H}=(0,H_{0},0)$, where $E_{0}$ and $H_{0}$ are constants. A critical consequence of a vector field being uniform (i.e., constant in space) is that its curl is zero everywhere.\nFor the electric field $\\mathbf{E}$:\n$$ \\nabla \\times \\mathbf{E} = \\nabla \\times (E_{0}\\hat{\\mathbf{x}}) = \\mathbf{0} $$\nFor the magnetic field $\\mathbf{H}$:\n$$ \\nabla \\times \\mathbf{H} = \\nabla \\times (H_{0}\\hat{\\mathbf{y}}) = \\mathbf{0} $$\n\nFirst, we compute the net surface-integrated flux vectors $\\mathbf{F}_{E}$ and $\\mathbf{F}_{H}$.\n\nFor $\\mathbf{F}_{E}$:\nThe definition is $\\mathbf{F}_{E} \\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{E}\\, \\mathrm{d}S$, which is equivalent to the closed surface integral $\\oint_{\\partial V}\\mathbf{n}\\times \\mathbf{E}\\, \\mathrm{d}S$. Applying the vector integral identity mentioned above:\n$$ \\mathbf{F}_{E} = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{E} \\, \\mathrm{d}S = \\int_{V} (\\nabla \\times \\mathbf{E}) \\, \\mathrm{d}V $$\nSince $\\mathbf{E}$ is uniform, $\\nabla \\times \\mathbf{E} = \\mathbf{0}$ everywhere within the volume $V$. Therefore, the integral becomes:\n$$ \\mathbf{F}_{E} = \\int_{V} \\mathbf{0} \\, \\mathrm{d}V = \\mathbf{0} $$\nThus, the vector $\\mathbf{F}_{E}$ is the zero vector, $(0,0,0)$, with units of volt-meter.\n\nFor $\\mathbf{F}_{H}$:\nThe same logic applies. The definition is $\\mathbf{F}_{H} \\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{H}\\, \\mathrm{d}S$. Applying the vector integral identity:\n$$ \\mathbf{F}_{H} = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{H} \\, \\mathrm{d}S = \\int_{V} (\\nabla \\times \\mathbf{H}) \\, \\mathrm{d}V $$\nSince $\\mathbf{H}$ is uniform, $\\nabla \\times \\mathbf{H} = \\mathbf{0}$ everywhere within the volume $V$. Therefore:\n$$ \\mathbf{F}_{H} = \\int_{V} \\mathbf{0} \\, \\mathrm{d}V = \\mathbf{0} $$\nThus, the vector $\\mathbf{F}_{H}$ is also the zero vector, $(0,0,0)$, with units of ampere-meter.\n\nNext, we compute the instantaneous time derivatives of the cell-averaged flux densities, $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$ and $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$. This embodies the core principle of the Finite-Volume Time-Domain (FVTD) method, which relates the time-evolution of a cell-averaged field to the flux through the cell's boundary.\n\nFor $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$:\nWe start by integrating Faraday's law, $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$, over the control volume $V$:\n$$ \\int_{V} (\\nabla \\times \\mathbf{E}) \\, \\mathrm{d}V = - \\int_{V} \\frac{\\partial \\mathbf{B}}{\\partial t} \\, \\mathrm{d}V $$\nThe left-hand side is, by definition, $\\mathbf{F}_{E}$. For the right-hand side, since the volume $V$ is constant in time, the time derivative can be moved outside the integral:\n$$ - \\int_{V} \\frac{\\partial \\mathbf{B}}{\\partial t} \\, \\mathrm{d}V = - \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} \\mathbf{B} \\, \\mathrm{d}V $$\nThe cell-averaged magnetic flux density is $\\langle \\mathbf{B} \\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{B}\\,\\mathrm{d}V$, so $\\int_{V}\\mathbf{B}\\,\\mathrm{d}V = V\\langle \\mathbf{B} \\rangle$. Substituting this in:\n$$ - \\frac{\\mathrm{d}}{\\mathrm{d}t} (V\\langle \\mathbf{B} \\rangle) = -V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle $$\nEquating the transformed left and right sides of the integrated Faraday's law gives the semi-discrete FVTD update equation:\n$$ \\mathbf{F}_{E} = -V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle $$\nWe have already determined that $\\mathbf{F}_{E} = \\mathbf{0}$. Since the volume $V = \\Delta^3$ is non-zero, we must have:\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle = \\mathbf{0} $$\nThe components of this vector are $(0,0,0)$, with units of tesla per second.\n\nFor $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$:\nA parallel procedure is followed for the Ampere-Maxwell law, $\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}$ (since $\\mathbf{J}=\\mathbf{0}$). Integrating over the volume $V$:\n$$ \\int_{V} (\\nabla \\times \\mathbf{H}) \\, \\mathrm{d}V = \\int_{V} \\frac{\\partial \\mathbf{D}}{\\partial t} \\, \\mathrm{d}V $$\nThe left-hand side is, by definition, $\\mathbf{F}_{H}$. The right-hand side is transformed similarly:\n$$ \\int_{V} \\frac{\\partial \\mathbf{D}}{\\partial t} \\, \\mathrm{d}V = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} \\mathbf{D} \\, \\mathrm{d}V = V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle $$\nwhere $\\langle \\mathbf{D} \\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{D}\\,\\mathrm{d}V$. This gives the second FVTD update equation:\n$$ \\mathbf{F}_{H} = V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle $$\nWe have already established that $\\mathbf{F}_{H} = \\mathbf{0}$. Therefore:\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle = \\mathbf{0} $$\nThe components of this vector are $(0,0,0)$, with units of coulomb per square meter per second.\n\nIn summary, the spatial uniformity of the fields $\\mathbf{E}$ and $\\mathbf{H}$ at the given instant implies that their curls are zero. This immediately leads to the conclusion that the surface flux integrals $\\mathbf{F}_{E}$ and $\\mathbf{F}_{H}$ are zero. Through the integral form of Maxwell's equations, this in turn implies that the time derivatives of the corresponding cell-averaged flux densities, $\\langle \\mathbf{B} \\rangle$ and $\\langle \\mathbf{D} \\rangle$, are also zero at that instant.\n\nThe final answer is a row matrix containing the $x, y, z$ components of $\\mathbf{F}_E$, $\\mathbf{F}_H$, $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$, and $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$ in order. All $12$ components are zero.\n$$ [F_{E,x}, F_{E,y}, F_{E,z}] = [0, 0, 0] $$\n$$ [F_{H,x}, F_{H,y}, F_{H,z}] = [0, 0, 0] $$\n$$ [\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{x}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{y}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{z}] = [0, 0, 0] $$\n$$ [\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{x}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{y}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{z}] = [0, 0, 0] $$\nThe resulting row matrix is composed entirely of zeros.", "answer": "$$ \\boxed{\n\\begin{pmatrix}\n0  0  0  0  0  0  0  0  0  0  0  0\n\\end{pmatrix}\n} $$", "id": "3307958"}, {"introduction": "While the previous exercise established that surface fluxes drive the field updates, a crucial question remains: how do we determine the flux at an interface separating two discrete cells, especially when they represent different materials? This practice introduces a powerful and physically-grounded approach using a Riemann solver, which calculates the exact solution to a localized, one-dimensional discontinuity problem [@problem_id:3307955]. Working through this problem will equip you with the tools to construct a Godunov-type numerical flux, a cornerstone of modern, high-fidelity FVTD schemes capable of accurately modeling wave interactions at material interfaces.", "problem": "Consider the one-dimensional transverse-electric configuration for Maxwell’s equations in a heterogeneous, lossless, source-free medium with a planar interface at $x=0$. The materials occupy half-spaces: medium $1$ for $x0$ with permittivity $\\varepsilon_1$ and permeability $\\mu_1$, and medium $2$ for $x0$ with permittivity $\\varepsilon_2$ and permeability $\\mu_2$. The tangential field components are $E_y(x,t)$ and $H_z(x,t)$. The governing equations are the Maxwell curl equations specialized to one dimension,\n$$\n\\frac{\\partial D_y}{\\partial t} + \\frac{\\partial H_z}{\\partial x} = 0, \n\\qquad\n\\frac{\\partial B_z}{\\partial t} + \\frac{\\partial E_y}{\\partial x} = 0,\n$$\ntogether with the constitutive relations $D_y=\\varepsilon(x) E_y$ and $B_z=\\mu(x) H_z$, where $\\varepsilon(x)=\\varepsilon_1$ for $x0$ and $\\varepsilon(x)=\\varepsilon_2$ for $x0$, and similarly for $\\mu(x)$. Assume there are no free surface currents or charges at $x=0$, so the tangential fields are continuous at the interface.\n\nIn a finite-volume time-domain method, one can cast the system in conservation form for the conserved variables $\\boldsymbol{Q}=(D_y, B_z)^{\\top}$ with flux $\\boldsymbol{F}(\\boldsymbol{Q})=(H_z, E_y)^{\\top}$, and use the exact interfacial Riemann solution at $x=0$ to define the Godunov numerical flux $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$.\n\nAssume the left medium has parameters $\\varepsilon_1=\\varepsilon_0$, $\\mu_1=\\mu_0$ and the right medium has parameters $\\varepsilon_2=4\\varepsilon_0$, $\\mu_2=\\mu_0$. Let the initial data at $t=0^+$ be a right-going plane wave incident from the left with left state $(E_y,H_z)=(1, 1/Z_1)$ in medium $1$ and a quiescent right state $(E_y,H_z)=(0,0)$ in medium $2$, where the wave impedances are $Z_i=\\sqrt{\\mu_i/\\varepsilon_i}$ and $Z_0=\\sqrt{\\mu_0/\\varepsilon_0}$. \n\nStarting from Maxwell’s equations and the interfacial continuity of tangential fields, derive the exact interfacial Riemann solution in terms of the characteristic variables appropriate to each medium, and from it determine:\n- the Godunov numerical flux $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$ at $x=0$, and\n- the transmitted electric field amplitude $E_y$ into medium $2$.\n\nExpress your final answer as a single row vector whose entries are, in order, $H_z^{\\ast}$, $E_y^{\\ast}$, and the transmitted $E_y$ amplitude, as closed-form analytic expressions in terms of $Z_0$. Do not insert a numerical value for $Z_0$. Do not append units in your final answer; it is understood that the first entry has the units of $H_z$ and the second and third have the units of $E_y$. No rounding is required.", "solution": "The problem requires the determination of the Godunov numerical flux and the transmitted electric field amplitude at a planar interface between two dielectric media. This is a classic Riemann problem for a linear hyperbolic system of equations, namely the one-dimensional Maxwell's equations.\n\nThe governing equations in a homogeneous medium $i$ (with permittivity $\\varepsilon_i$ and permeability $\\mu_i$) are:\n$$\n\\varepsilon_i \\frac{\\partial E_y}{\\partial t} + \\frac{\\partial H_z}{\\partial x} = 0\n$$\n$$\n\\mu_i \\frac{\\partial H_z}{\\partial t} + \\frac{\\partial E_y}{\\partial x} = 0\n$$\nThis system can be written in matrix form as $\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\boldsymbol{A}_i \\frac{\\partial \\boldsymbol{U}}{\\partial x} = \\boldsymbol{0}$, where $\\boldsymbol{U} = (E_y, H_z)^{\\top}$ and the system matrix is $\\boldsymbol{A}_i = \\begin{pmatrix} 0  1/\\varepsilon_i \\\\ 1/\\mu_i  0 \\end{pmatrix}$.\n\nTo solve the Riemann problem, we perform a characteristic analysis. The eigenvalues of $\\boldsymbol{A}_i$ are found from $\\det(\\boldsymbol{A}_i - \\lambda\\boldsymbol{I}) = \\lambda^2 - 1/(\\varepsilon_i\\mu_i) = 0$, which gives the characteristic speeds $\\lambda = \\pm v_i$, where $v_i = 1/\\sqrt{\\varepsilon_i\\mu_i}$ is the speed of light in medium $i$.\n\nThe corresponding left eigenvectors $\\boldsymbol{l}$ are found by solving $\\boldsymbol{l}^{\\top}(\\boldsymbol{A}_i - \\lambda\\boldsymbol{I}) = \\boldsymbol{0}$.\nFor $\\lambda = +v_i$: $\\boldsymbol{l}_1^{\\top} = (1, Z_i)$, where $Z_i = \\sqrt{\\mu_i/\\varepsilon_i}$ is the wave impedance of medium $i$.\nFor $\\lambda = -v_i$: $\\boldsymbol{l}_2^{\\top} = (1, -Z_i)$.\n\nThe characteristic variables (or Riemann invariants) are found by taking the dot product of the left eigenvectors with the state vector $\\boldsymbol{U}$.\n$1$. The quantity $w_1 = \\boldsymbol{l}_1^{\\top}\\boldsymbol{U} = E_y + Z_i H_z$ is constant along characteristics moving to the left, i.e., lines with slope $dx/dt = -v_i$.\n$2$. The quantity $w_2 = \\boldsymbol{l}_2^{\\top}\\boldsymbol{U} = E_y - Z_i H_z$ is constant along characteristics moving to the right, i.e., lines with slope $dx/dt = +v_i$.\n\nThe initial condition specifies a discontinuity at $x=0$ at time $t=0$, separating a left state $(E_{y,L}, H_{z,L})$ in medium $1$ from a right state $(E_{y,R}, H_{z,R})$ in medium $2$. For $t0$, the solution at the interface $x=0$ is a constant state, the so-called star state, $(E_y^{\\ast}, H_z^{\\ast})$. This state is the solution to the Riemann problem at the interface and provides the values for the Godunov flux, $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$.\n\nThis star state must be connected to the initial states by waves propagating away from the interface.\n- The star state $(E_y^{\\ast}, H_z^{\\ast})$ is connected to the left state $(E_{y,L}, H_{z,L})$ by a left-propagating wave in medium $1$. Across this wave, the characteristic variable $E_y + Z_1 H_z$ is conserved.\n$$ E_y^{\\ast} + Z_1 H_z^{\\ast} = E_{y,L} + Z_1 H_{z,L} $$\n- The star state $(E_y^{\\ast}, H_z^{\\ast})$ is connected to the right state $(E_{y,R}, H_{z,R})$ by a right-propagating wave in medium $2$. Across this wave, the characteristic variable $E_y - Z_2 H_z$ is conserved.\n$$ E_y^{\\ast} - Z_2 H_z^{\\ast} = E_{y,R} - Z_2 H_{z,R} $$\n\nWe now substitute the specific parameters given in the problem.\nFor medium $1$ ($x0$): $\\varepsilon_1 = \\varepsilon_0$, $\\mu_1 = \\mu_0$. The impedance is $Z_1 = \\sqrt{\\mu_1/\\varepsilon_1} = \\sqrt{\\mu_0/\\varepsilon_0} = Z_0$.\nFor medium $2$ ($x0$): $\\varepsilon_2 = 4\\varepsilon_0$, $\\mu_2 = \\mu_0$. The impedance is $Z_2 = \\sqrt{\\mu_2/\\varepsilon_2} = \\sqrt{\\mu_0/(4\\varepsilon_0)} = \\frac{1}{2}\\sqrt{\\mu_0/\\varepsilon_0} = \\frac{1}{2}Z_0$.\n\nThe initial states are:\n- Left state $(L)$: A right-going wave with $E_y=1$. For such a wave, $H_z = E_y/Z_1$. So, $(E_{y,L}, H_{z,L}) = (1, 1/Z_1) = (1, 1/Z_0)$.\n- Right state $(R)$: Quiescent medium. $(E_{y,R}, H_{z,R}) = (0, 0)$.\n\nSubstituting these into the two conservation equations for the characteristic variables:\nFrom the left-propagating wave in medium $1$:\n$$ E_y^{\\ast} + Z_0 H_z^{\\ast} = 1 + Z_0 \\left(\\frac{1}{Z_0}\\right) = 1+1=2 $$\nFrom the right-propagating wave in medium $2$:\n$$ E_y^{\\ast} - \\frac{1}{2}Z_0 H_z^{\\ast} = 0 - \\frac{1}{2}Z_0(0) = 0 $$\n\nWe have a system of two linear equations for $E_y^{\\ast}$ and $H_z^{\\ast}$:\n$1$. $E_y^{\\ast} + Z_0 H_z^{\\ast} = 2$\n$2$. $E_y^{\\ast} - \\frac{1}{2}Z_0 H_z^{\\ast} = 0$\n\nFrom equation $(2)$, we find $E_y^{\\ast} = \\frac{1}{2}Z_0 H_z^{\\ast}$.\nSubstituting this into equation $(1)$:\n$$ \\left(\\frac{1}{2}Z_0 H_z^{\\ast}\\right) + Z_0 H_z^{\\ast} = 2 $$\n$$ \\frac{3}{2}Z_0 H_z^{\\ast} = 2 $$\n$$ H_z^{\\ast} = \\frac{4}{3Z_0} $$\n\nNow, we find $E_y^{\\ast}$:\n$$ E_y^{\\ast} = \\frac{1}{2}Z_0 H_z^{\\ast} = \\frac{1}{2}Z_0 \\left(\\frac{4}{3Z_0}\\right) = \\frac{4}{6} = \\frac{2}{3} $$\n\nThe Godunov numerical flux at the interface is $\\boldsymbol{F}^{\\ast} = (H_z^{\\ast}, E_y^{\\ast})^{\\top}$. The components are:\n$$ H_z^{\\ast} = \\frac{4}{3Z_0} $$\n$$ E_y^{\\ast} = \\frac{2}{3} $$\n\nThe final quantity to determine is the transmitted electric field amplitude into medium $2$. The wave transmitted into medium $2$ is the right-propagating wave that connects the initial right state $(0,0)$ to the star state $(E_y^{\\ast}, H_z^{\\ast})$. The fields in the region $0  x  v_2 t$ are constant and equal to $(E_y^{\\ast}, H_z^{\\ast})$. Therefore, the amplitude of the transmitted electric field is precisely $E_y^{\\ast}$.\n$$ E_{y, \\text{transmitted}} = E_y^{\\ast} = \\frac{2}{3} $$\n\nThe problem asks for the three values ($H_z^{\\ast}$, $E_y^{\\ast}$, and the transmitted $E_y$ amplitude) as a single row vector. These are, in order: $\\frac{4}{3Z_0}$, $\\frac{2}{3}$, and $\\frac{2}{3}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4}{3Z_0}  \\frac{2}{3}  \\frac{2}{3} \\end{pmatrix}}\n$$", "id": "3307955"}, {"introduction": "Having established the mechanics of the FVTD update and the computation of numerical fluxes, we now turn to the critical issue of numerical accuracy. Since finite-volume methods store cell-averaged quantities, we must reconstruct field values at cell faces to compute fluxes, a step that inevitably introduces errors. This exercise provides a direct analytical window into one of the most significant sources of error in wave simulations: numerical dispersion [@problem_id:3307959]. By deriving the phase error for first- and second-order reconstruction schemes, you will gain a concrete understanding of how the choice of numerical method affects the propagation speed of simulated waves, a key factor in assessing simulation fidelity.", "problem": "Consider one-dimensional propagation of a Transverse Electric (TE) mode in free space governed by Maxwell’s equations. For fields varying only along the spatial coordinate $x$, the relevant components satisfy\n$$\n\\frac{\\partial E_{y}}{\\partial t} = -\\frac{1}{\\varepsilon_{0}}\\frac{\\partial H_{z}}{\\partial x}, \\quad \\frac{\\partial H_{z}}{\\partial t} = -\\frac{1}{\\mu_{0}}\\frac{\\partial E_{y}}{\\partial x},\n$$\nwhere $E_{y}(x,t)$ and $H_{z}(x,t)$ denote the transverse electric and magnetic fields, respectively, and $\\varepsilon_{0}$ and $\\mu_{0}$ are the permittivity and permeability of free space. Consider a monochromatic plane wave with sinusoidal spatial dependence at a fixed time $t$ so that the complex representation of the electric field is\n$$\nE_{y}(x) = E_{0}\\exp(i k x),\n$$\nwhere $E_{0}\\in\\mathbb{C}$ is a constant amplitude and $k0$ is the real wavenumber.\n\nIn a Finite-Volume Time-Domain (FVTD) discretization on a uniform grid of spacing $\\Delta x$, the primary unknowns are cell averages. Let cell $i$ be centered at $x_{i}$ and bounded by faces at $x_{i\\pm\\frac{1}{2}} = x_{i} \\pm \\frac{\\Delta x}{2}$. The cell-average electric field is defined as\n$$\n\\overline{E}_{i} \\equiv \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} E_{y}(x)\\,dx.\n$$\nSuppose one reconstructs the pointwise field at the right face $x_{i+\\frac{1}{2}}$ from the cell averages by two spatial reconstructions:\n- First-order (piecewise constant) reconstruction:\n$$\nE_{i+\\frac{1}{2},L}^{(1)} = \\overline{E}_{i},\n$$\ni.e., the left state at the face is taken to be the cell-average in cell $i$.\n- Second-order (piecewise linear) reconstruction without limiting (MUSCL-type) using a centered slope from cell averages:\n$$\ns_{i} = \\frac{\\overline{E}_{i+1} - \\overline{E}_{i-1}}{2\\,\\Delta x}, \\quad E_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}\\,s_{i}.\n$$\n\nDefine the phase error of the reconstruction at the face $x_{i+\\frac{1}{2}}$ as the argument (in radians) of the complex ratio of the reconstructed value to the exact field value at that face:\n$$\n\\phi^{(m)} \\equiv \\arg\\!\\left(\\frac{E_{i+\\frac{1}{2},L}^{(m)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right), \\quad m\\in\\{1,2\\}.\n$$\nStarting from the above definitions and the sinusoidal field $E_{y}(x)=E_{0}\\exp(i k x)$, derive closed-form expressions for $\\phi^{(1)}$ and $\\phi^{(2)}$ as functions of $k$ and $\\Delta x$. Express the final phase errors in radians. The final answer must be the pair $\\phi^{(1)}$ and $\\phi^{(2)}$ written as a single row matrix using the LaTeX $pmatrix$ environment.", "solution": "The objective is to derive closed-form expressions for the phase errors, $\\phi^{(1)}$ and $\\phi^{(2)}$, associated with first-order and second-order spatial reconstructions of a sinusoidal electric field in a Finite-Volume Time-Domain (FVTD) context.\n\nFirst, we calculate the cell average $\\overline{E}_{i}$ for cell $i$. The cell $i$ is centered at $x_i$ and has width $\\Delta x$, covering the interval $[x_i - \\frac{\\Delta x}{2}, x_i + \\frac{\\Delta x}{2}]$. The electric field is given by its complex representation $E_y(x) = E_{0}\\exp(i k x)$.\n\nThe cell average $\\overline{E}_{i}$ is defined as:\n$$\n\\overline{E}_{i} = \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} E_{y}(x)\\,dx = \\frac{1}{\\Delta x}\\int_{x_{i} - \\frac{\\Delta x}{2}}^{x_{i} + \\frac{\\Delta x}{2}} E_{0}\\exp(i k x)\\,dx\n$$\nWe perform the integration:\n$$\n\\overline{E}_{i} = \\frac{E_{0}}{\\Delta x} \\left[ \\frac{\\exp(i k x)}{i k} \\right]_{x_{i} - \\frac{\\Delta x}{2}}^{x_{i} + \\frac{\\Delta x}{2}} = \\frac{E_{0}}{i k \\Delta x} \\left[ \\exp\\left(ik\\left(x_i + \\frac{\\Delta x}{2}\\right)\\right) - \\exp\\left(ik\\left(x_i - \\frac{\\Delta x}{2}\\right)\\right) \\right]\n$$\nFactoring out the term $\\exp(i k x_i)$:\n$$\n\\overline{E}_{i} = \\frac{E_{0}\\exp(i k x_i)}{i k \\Delta x} \\left[ \\exp\\left(i k\\frac{\\Delta x}{2}\\right) - \\exp\\left(-i k\\frac{\\Delta x}{2}\\right) \\right]\n$$\nUsing Euler's identity $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, the term in the brackets becomes $2i \\sin(k\\frac{\\Delta x}{2})$.\n$$\n\\overline{E}_{i} = \\frac{E_{0}\\exp(i k x_i)}{i k \\Delta x} \\left( 2i \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right) = E_{0}\\exp(i k x_i) \\frac{2\\sin(k \\Delta x / 2)}{k \\Delta x}\n$$\nTo simplify notation, we can write this as:\n$$\n\\overline{E}_{i} = E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\n\nNow, we derive the phase error for the first-order reconstruction, $\\phi^{(1)}$.\nThe first-order reconstruction at the left of the face $x_{i+\\frac{1}{2}}$ is given by $E_{i+\\frac{1}{2},L}^{(1)} = \\overline{E}_{i}$.\n$$\nE_{i+\\frac{1}{2},L}^{(1)} = E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\nThe exact value of the field at this face is:\n$$\nE_{y}(x_{i+\\frac{1}{2}}) = E_{y}\\left(x_i + \\frac{\\Delta x}{2}\\right) = E_{0}\\exp\\left(ik\\left(x_i + \\frac{\\Delta x}{2}\\right)\\right) = E_{0}\\exp(i k x_i)\\exp\\left(i\\frac{k \\Delta x}{2}\\right)\n$$\nThe phase error $\\phi^{(1)}$ is the argument of the ratio of the reconstructed value to the exact value:\n$$\n\\phi^{(1)} = \\arg\\left(\\frac{E_{i+\\frac{1}{2},L}^{(1)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right) = \\arg\\left( \\frac{E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}}{E_{0}\\exp(i k x_i)\\exp(i k \\Delta x / 2)} \\right)\n$$\n$$\n\\phi^{(1)} = \\arg\\left( \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\exp\\left(-i\\frac{k \\Delta x}{2}\\right) \\right)\n$$\nFor a numerically well-resolved wave, the number of points per wavelength is greater than $2$, which implies $k \\Delta x  \\pi$. In this regime, $k\\Delta x/2  \\pi/2$, and the term $\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}$ is a positive real number. The argument of the complex ratio is therefore determined solely by the exponential term.\n$$\n\\phi^{(1)} = -\\frac{k \\Delta x}{2}\n$$\n\nNext, we derive the phase error for the second-order reconstruction, $\\phi^{(2)}$.\nThe reconstruction is $E_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}s_{i}$, with the slope $s_{i} = \\frac{\\overline{E}_{i+1} - \\overline{E}_{i-1}}{2\\Delta x}$.\nFirst, we compute the slope $s_i$:\n$$\n\\overline{E}_{i\\pm 1} = E_{y}(x_{i\\pm 1}) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} = E_{y}(x_i)\\exp(\\pm i k \\Delta x) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\n$$\ns_i = \\frac{1}{2\\Delta x} \\left( \\overline{E}_{i+1} - \\overline{E}_{i-1} \\right) = \\frac{E_{y}(x_i)}{2\\Delta x} \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left[ \\exp(i k \\Delta x) - \\exp(-i k \\Delta x) \\right]\n$$\nUsing $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$, we get:\n$$\ns_i = \\frac{E_{y}(x_i)}{2\\Delta x} \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} [2i \\sin(k\\Delta x)] = \\frac{i \\sin(k\\Delta x)}{\\Delta x} E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\nNow, substitute this into the expression for $E_{i+\\frac{1}{2},L}^{(2)}$:\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}s_{i} = E_{y}(x_i)\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} + \\frac{\\Delta x}{2} \\left( \\frac{i \\sin(k\\Delta x)}{\\Delta x} E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\right)\n$$\nFactor out the common terms:\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)\n$$\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)\n$$\nWe form the ratio for $\\phi^{(2)}$:\n$$\n\\phi^{(2)} = \\arg\\left(\\frac{E_{i+\\frac{1}{2},L}^{(2)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right) = \\arg\\left( \\frac{E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)}{E_{0}\\exp(i k x_i)\\exp(i k \\Delta x / 2)} \\right)\n$$\n$$\n\\phi^{(2)} = \\arg\\left( \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\exp\\left(-i\\frac{k \\Delta x}{2}\\right) \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right) \\right)\n$$\nThe argument of a product of complex numbers is the sum of their arguments. Let's analyze each term. As before, we assume $k\\Delta x  \\pi$, so $\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}$ is a positive real number and its argument is $0$. The argument of $\\exp(-i k \\Delta x / 2)$ is $-k \\Delta x / 2$. The third term is $1 + \\frac{i}{2}\\sin(k\\Delta x)$; its real part is $1$ (positive), so its argument is $\\arctan(\\frac{1}{2}\\sin(k\\Delta x))$.\nSumming the arguments:\n$$\n\\phi^{(2)} = 0 - \\frac{k\\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k\\Delta x)\\right)\n$$\nSo, the second phase error is:\n$$\n\\phi^{(2)} = -\\frac{k\\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right)\n$$\n\nThe final closed-form expressions for the phase errors are:\n$\\phi^{(1)} = -\\frac{k \\Delta x}{2}$\n$\\phi^{(2)} = -\\frac{k \\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right)$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{k \\Delta x}{2}  -\\frac{k \\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right) \\end{pmatrix}}\n$$", "id": "3307959"}]}