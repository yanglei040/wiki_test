{"hands_on_practices": [{"introduction": "A foundational step in analyzing electromagnetic structures is understanding how boundary conditions dictate wave propagation. This exercise provides direct practice by requiring the derivation of the dispersion relation for a waveguide with mixed Perfect Electric Conductor (PEC) and Perfect Magnetic Conductor (PMC) walls [@problem_id:3338766]. By translating the physical definitions of PEC and PMC boundaries into their corresponding mathematical forms—Dirichlet and Neumann conditions—you will build the essential analytical skills needed to model complex guiding structures.", "problem": "A lossless, source-free, homogeneous, isotropic rectangular waveguide occupies the region $0 \\le x \\le a$, $0 \\le y \\le b$, and extends infinitely along $z$. The walls at $x=0$ and $y=0$ are Perfect Electric Conductor (PEC), and the opposite walls at $x=a$ and $y=b$ are Perfect Magnetic Conductor (PMC), forming four line junctions between PEC and PMC at the corners. Assume time-harmonic fields with phasor convention $\\exp(j \\omega t)$ and free-space material parameters $\\epsilon_0$ and $\\mu_0$. Consider transverse magnetic to $z$ (TM$_z$) modes, wherein $H_z=0$ and $E_z \\neq 0$.\n\nStarting from Maxwell’s equations and the PEC/PMC boundary conditions, derive the scalar boundary-value problem for $E_z(x,y)$ on the cross-section and show that the dispersion relation for TM$_z$ modes in this mixed-boundary waveguide has the form\n$$\\beta^2 \\;=\\; k^2 \\;-\\; \\lambda_x^2 \\;-\\; \\lambda_y^2,$$\nwith transverse separation constants $\\lambda_x$ and $\\lambda_y$ determined by the mixed Dirichlet–Neumann boundary conditions implied by the PEC/PMC walls. Then, for the lowest-order TM$_z$ mode corresponding to the smallest positive $\\lambda_x$ and $\\lambda_y$, compute the propagation constant $\\beta$ at frequency $f = 15.0 \\times 10^9$ Hz in vacuum when $a = 1.00 \\times 10^{-2}$ m and $b = 2.00 \\times 10^{-2}$ m. Express the final $\\beta$ in radians per meter and round your answer to four significant figures.", "solution": "The problem asks for the derivation of the dispersion relation for TM$_z$ modes in a rectangular waveguide with mixed Perfect Electric Conductor (PEC) and Perfect Magnetic Conductor (PMC) walls, and for the computation of the propagation constant $\\beta$ for the lowest-order mode under specific conditions.\n\nThe analysis begins with the time-harmonic Maxwell's equations in a source-free, homogeneous, and isotropic medium ($\\epsilon_0$, $\\mu_0$):\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu_0 \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega\\epsilon_0 \\mathbf{E} $$\nFor wave propagation along the $z$-axis, the fields are assumed to have a phasor dependence of the form $\\exp(-j\\beta z)$, where $\\beta$ is the propagation constant. This implies that the partial derivative with respect to $z$ can be replaced by multiplication with $-j\\beta$.\n\nFor Transverse Magnetic to $z$ (TM$_z$) modes, the axial magnetic field component is zero, $H_z = 0$, while the axial electric field component $E_z$ is non-zero. The wave equation for the electric field is $(\\nabla^2 + k^2)\\mathbf{E} = 0$, where $k^2 = \\omega^2 \\mu_0 \\epsilon_0$. The $z$-component of this vector wave equation gives a scalar Helmholtz equation for $E_z$:\n$$ (\\nabla^2 + k^2) E_z = 0 $$\nExpanding the Laplacian operator $\\nabla^2 = \\nabla_t^2 + \\frac{\\partial^2}{\\partial z^2}$, where $\\nabla_t^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ is the transverse Laplacian, and using $\\frac{\\partial^2}{\\partial z^2} = (-j\\beta)^2 = -\\beta^2$, we obtain the governing partial differential equation (PDE) for $E_z(x,y)$ on the waveguide's cross-section:\n$$ \\frac{\\partial^2 E_z}{\\partial x^2} + \\frac{\\partial^2 E_z}{\\partial y^2} + (k^2 - \\beta^2) E_z = 0 $$\nThis is a 2D scalar Helmholtz equation. We solve it using the method of separation of variables, letting $E_z(x,y) = X(x)Y(y)$. Substituting this into the PDE yields:\n$$ Y(y)\\frac{d^2X}{dx^2} + X(x)\\frac{d^2Y}{dy^2} + (k^2 - \\beta^2)X(x)Y(y) = 0 $$\nDividing by $X(x)Y(y)$ allows separation of the variables:\n$$ \\frac{1}{X}\\frac{d^2X}{dx^2} + \\frac{1}{Y}\\frac{d^2Y}{dy^2} = -(k^2 - \\beta^2) $$\nThe left side consists of a term depending only on $x$ and a term depending only on $y$. For their sum to be constant, each term must be a constant. We define the separation constants $-\\lambda_x^2$ and $-\\lambda_y^2$:\n$$ \\frac{1}{X}\\frac{d^2X}{dx^2} = -\\lambda_x^2 \\implies \\frac{d^2X}{dx^2} + \\lambda_x^2 X = 0 $$\n$$ \\frac{1}{Y}\\frac{d^2Y}{dy^2} = -\\lambda_y^2 \\implies \\frac{d^2Y}{dy^2} + \\lambda_y^2 Y = 0 $$\nSubstituting these into the separated equation gives $-\\lambda_x^2 - \\lambda_y^2 = -(k^2 - \\beta^2)$. Rearranging, we obtain the dispersion relation:\n$$ \\beta^2 = k^2 - \\lambda_x^2 - \\lambda_y^2 $$\nThis confirms the first part of the problem statement. The values of $\\lambda_x$ and $\\lambda_y$ are determined by the boundary conditions.\n\nNext, we establish the boundary conditions for $E_z(x,y)$.\n1.  **PEC walls** ($x=0$, $y=0$): The tangential component of the electric field must vanish. The axial field $E_z$ is tangential to all four walls.\n    -   At $x=0$: $E_z(0, y) = 0$. This is a Dirichlet condition.\n    -   At $y=0$: $E_z(x, 0) = 0$. This is a Dirichlet condition.\n2.  **PMC walls** ($x=a$, $y=b$): The tangential component of the magnetic field must vanish. For TM$_z$ modes, the transverse fields can be expressed in terms of $E_z$:\n    $$ \\mathbf{H}_t = \\frac{j\\omega\\epsilon_0}{k_c^2} (\\hat{z} \\times \\nabla_t E_z) $$\n    where $k_c^2 = k^2 - \\beta^2 = \\lambda_x^2 + \\lambda_y^2$. Expanding $\\mathbf{H}_t = H_x\\hat{x} + H_y\\hat{y}$ and $\\nabla_t E_z = \\frac{\\partial E_z}{\\partial x}\\hat{x} + \\frac{\\partial E_z}{\\partial y}\\hat{y}$:\n    $$ \\mathbf{H}_t = \\frac{j\\omega\\epsilon_0}{k_c^2} \\left( \\hat{z} \\times \\left( \\frac{\\partial E_z}{\\partial x}\\hat{x} + \\frac{\\partial E_z}{\\partial y}\\hat{y} \\right) \\right) = \\frac{j\\omega\\epsilon_0}{k_c^2} \\left( \\frac{\\partial E_z}{\\partial x}\\hat{y} - \\frac{\\partial E_z}{\\partial y}\\hat{x} \\right) $$\n    -   At $x=a$: The tangential component of $\\mathbf{H}$ is $H_y$. The PMC condition is $H_y(a, y) = 0$. From the expression for $\\mathbf{H}_t$, this implies $\\frac{\\partial E_z}{\\partial x}(a, y) = 0$. This is a Neumann condition.\n    -   At $y=b$: The tangential component of $\\mathbf{H}$ is $H_x$. The PMC condition is $H_x(x, b) = 0$. This implies $\\frac{\\partial E_z}{\\partial y}(x, b) = 0$. This is a Neumann condition.\n\nNow, we solve the ODEs for $X(x)$ and $Y(y)$ with these mixed boundary conditions.\nFor $X(x)$: The general solution is $X(x) = C_1 \\cos(\\lambda_x x) + C_2 \\sin(\\lambda_x x)$.\n-   $X(0) = 0 \\implies C_1 = 0$, so $X(x) = C_2 \\sin(\\lambda_x x)$.\n-   $\\frac{dX}{dx}(a) = 0 \\implies C_2 \\lambda_x \\cos(\\lambda_x a) = 0$. For non-trivial solutions ($C_2 \\neq 0, \\lambda_x \\neq 0$), we must have $\\cos(\\lambda_x a) = 0$.\n-   This yields $\\lambda_x a = \\frac{(2m-1)\\pi}{2}$ for $m = 1, 2, 3, \\ldots$. Thus, $\\lambda_x = \\frac{(2m-1)\\pi}{2a}$.\n\nFor $Y(y)$: The general solution is $Y(y) = D_1 \\cos(\\lambda_y y) + D_2 \\sin(\\lambda_y y)$.\n-   $Y(0) = 0 \\implies D_1 = 0$, so $Y(y) = D_2 \\sin(\\lambda_y y)$.\n-   $\\frac{dY}{dy}(b) = 0 \\implies D_2 \\lambda_y \\cos(\\lambda_y b) = 0$. For non-trivial solutions ($D_2 \\neq 0, \\lambda_y \\neq 0$), we must have $\\cos(\\lambda_y b) = 0$.\n-   This yields $\\lambda_y b = \\frac{(2n-1)\\pi}{2}$ for $n = 1, 2, 3, \\ldots$. Thus, $\\lambda_y = \\frac{(2n-1)\\pi}{2b}$.\n\nThe lowest-order TM$_z$ mode corresponds to the smallest positive values for $\\lambda_x$ and $\\lambda_y$, which occurs for $m=1$ and $n=1$.\n$$ \\lambda_x = \\frac{\\pi}{2a} \\quad \\text{and} \\quad \\lambda_y = \\frac{\\pi}{2b} $$\nThe propagation constant $\\beta$ is given by:\n$$ \\beta = \\sqrt{k^2 - \\lambda_x^2 - \\lambda_y^2} = \\sqrt{\\left(\\frac{2\\pi f}{c_0}\\right)^2 - \\left(\\frac{\\pi}{2a}\\right)^2 - \\left(\\frac{\\pi}{2b}\\right)^2} $$\nwhere $c_0 = 1/\\sqrt{\\mu_0\\epsilon_0}$ is the speed of light in vacuum.\n\nNow, we compute the numerical value of $\\beta$ with the given parameters:\n-   Frequency $f = 15.0 \\times 10^9$ Hz\n-   Dimension $a = 1.00 \\times 10^{-2}$ m\n-   Dimension $b = 2.00 \\times 10^{-2}$ m\n-   Speed of light $c_0 = 299792458$ m/s\n\nFirst, we calculate the terms inside the square root:\n$$ k^2 = \\left(\\frac{2\\pi f}{c_0}\\right)^2 = \\left(\\frac{2\\pi \\times 15.0 \\times 10^9}{299792458}\\right)^2 \\approx 98836.36 \\text{ rad}^2/\\text{m}^2 $$\n$$ \\lambda_x^2 = \\left(\\frac{\\pi}{2a}\\right)^2 = \\left(\\frac{\\pi}{2 \\times 1.00 \\times 10^{-2}}\\right)^2 = (50\\pi)^2 \\approx 24674.01 \\text{ rad}^2/\\text{m}^2 $$\n$$ \\lambda_y^2 = \\left(\\frac{\\pi}{2b}\\right)^2 = \\left(\\frac{\\pi}{2 \\times 2.00 \\times 10^{-2}}\\right)^2 = (25\\pi)^2 \\approx 6168.50 \\text{ rad}^2/\\text{m}^2 $$\nThe squared cutoff wavenumber is $k_c^2 = \\lambda_x^2 + \\lambda_y^2 \\approx 24674.01 + 6168.50 = 30842.51 \\text{ rad}^2/\\text{m}^2$.\nSince $k^2 > k_c^2$, the mode is propagating.\n\nNow, we calculate $\\beta^2$:\n$$ \\beta^2 = k^2 - k_c^2 \\approx 98836.36 - 30842.51 = 67993.85 \\text{ rad}^2/\\text{m}^2 $$\nFinally, we compute $\\beta$ by taking the square root:\n$$ \\beta = \\sqrt{67993.85} \\approx 260.7563 \\text{ rad/m} $$\nRounding the result to four significant figures gives $260.8$.", "answer": "$$\\boxed{260.8}$$", "id": "3338766"}, {"introduction": "Moving from continuous-wave analysis to transient phenomena, this practice explores how a pulse reflects from PEC and PMC boundaries in the time domain [@problem_id:3338736]. You will implement a Finite-Difference Time-Domain (FDTD) simulation to model wave propagation in a one-dimensional cavity terminated by one PEC and one PMC wall. This hands-on coding challenge solidifies your understanding of how to implement these ideal boundaries in a numerical grid and allows you to validate your simulation against the analytical predictions of electromagnetic image theory.", "problem": "Consider a one-dimensional time-domain electromagnetic propagation problem in a lossless, source-excited line segment along the spatial coordinate $x \\in [0,L]$, bounded on the left at $x=0$ by a perfect electric conductor (PEC) and on the right at $x=L$ by a perfect magnetic conductor (PMC). The medium is free space with permittivity $\\epsilon_0$ and permeability $\\mu_0$, so the phase velocity is $v = c_0 = 1/\\sqrt{\\epsilon_0 \\mu_0}$. Use the Finite-Difference Time-Domain (FDTD) method to advance the coupled fields for a transverse electromagnetic (TEM) configuration: an electric field component $E_y(x,t)$ and a magnetic field component $H_z(x,t)$ varying only in $x$ and $t$. Enforce the boundary conditions $E_y(0,t) = 0$ (PEC) and $H_z(L,t) = 0$ (PMC).\n\nStart from Maxwell’s equations in differential form for a source-free, linear, isotropic, homogeneous medium,\n$$\\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}, \\quad \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t},$$\nspecialized to the one-dimensional case with $E_y$ and $H_z$ nonzero and functions of $x$ and $t$, and derive a staggered-grid (Yee-type) update. Implement a soft source injection by adding a time-dependent excitation $s(t)$ to the electric field at a single grid location $x=x_s$ each time step. Let the excitation be the Ricker wavelet\n$$s(t) = \\left(1 - 2\\pi^2 f_0^2 (t - t_0)^2\\right) \\exp\\left(-\\pi^2 f_0^2 (t - t_0)^2\\right),$$\nwhere $f_0$ is the central frequency in $\\mathrm{Hz}$ and $t_0$ is the center time in $\\mathrm{s}$. Use a Courant-stable time step $ \\Delta t = S \\, \\Delta x / c_0$ with Courant factor $S \\in (0,1]$ and uniform spatial step $\\Delta x$.\n\nConnect the observed transient field patterns to virtual mirror sources via electromagnetic image theory. In one dimension with mixed PEC/PMC terminations, the set of virtual source positions is generated by mirroring the physical source $x_s$ across the boundaries repeatedly, resulting in the infinite set\n$$x_{\\text{img}} = 2 m L \\pm x_s, \\quad m \\in \\mathbb{Z},$$\nand the corresponding arrival times at an observation point $x=x_o$ are\n$$t_{\\text{arr}} = t_0 + \\frac{|x_o - x_{\\text{img}}|}{c_0}.$$\nAlthough the reflection signs at PEC and PMC alter amplitudes and polarities, arrivals in time are governed purely by path lengths in this one-dimensional setting.\n\nYour program must:\n- Construct the one-dimensional Yee lattice for $E_y$ and $H_z$, implement the FDTD time stepping consistent with Maxwell’s curl equations and the specified PEC and PMC boundary conditions, and inject $s(t)$ at $x=x_s$.\n- Record the electric field $E_y(x_o,t)$ at the observation coordinate $x_o$ over the full simulation.\n- Extract the first $K$ arrival times from the recorded trace as the earliest $K$ local maxima of $|E_y(x_o,t)|$ above a data-adaptive threshold, expressed in seconds.\n- Compute the analytical arrival times from image theory as the earliest $K$ values of $t_{\\text{arr}}$ that do not exceed the total simulated time window.\n\nFor comparison, declare the result for each test case to be a boolean computed as follows: it is true if and only if the number of detected arrivals is at least $K$ and the absolute difference between each simulated arrival time and its analytical counterpart (paired in ascending order) is less than a specified tolerance $\\delta_t$. Set the tolerance to $\\delta_t = 5 \\Delta t$. Express all computed times in seconds, and base all tolerances on seconds.\n\nImplement the program with free-space values $\\epsilon_0$ and $\\mu_0$, and use the following test suite of parameter sets. All spatial quantities must be in meters ($\\mathrm{m}$), times in seconds ($\\mathrm{s}$), and frequencies in hertz ($\\mathrm{Hz}$). For each case, use Courant factor $S = 0.99$.\n\n- Case A (general check): $L = 1.0\\,\\mathrm{m}$, $N = 401$ grid points for $E_y$, $x_s = 0.22\\,\\mathrm{m}$, $x_o = 0.77\\,\\mathrm{m}$, $f_0 = 1.2 \\times 10^8\\,\\mathrm{Hz}$, $t_0 = 5.0 \\times 10^{-9}\\,\\mathrm{s}$, total simulated time $T = 3.5 \\times 10^{-8}\\,\\mathrm{s}$, $K = 6$ arrivals.\n- Case B (shorter line, off-center observation): $L = 0.5\\,\\mathrm{m}$, $N = 401$, $x_s = 0.10\\,\\mathrm{m}$, $x_o = 0.45\\,\\mathrm{m}$, $f_0 = 8.0 \\times 10^7\\,\\mathrm{Hz}$, $t_0 = 3.0 \\times 10^{-9}\\,\\mathrm{s}$, $T = 2.5 \\times 10^{-8}\\,\\mathrm{s}$, $K = 6$.\n- Case C (moderate length, observation left of source): $L = 0.8\\,\\mathrm{m}$, $N = 301$, $x_s = 0.30\\,\\mathrm{m}$, $x_o = 0.20\\,\\mathrm{m}$, $f_0 = 1.0 \\times 10^8\\,\\mathrm{Hz}$, $t_0 = 4.0 \\times 10^{-9}\\,\\mathrm{s}$, $T = 3.0 \\times 10^{-8}\\,\\mathrm{s}$, $K = 5$.\n\nYour program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets, for example $[r_A,r_B,r_C]$ where each $r_\\cdot$ is a boolean indicating whether the simulation arrivals are consistent with the analytical arrivals under the stated tolerance. The final output must be exactly of the form $[result1,result2,result3]$.", "solution": "The problem requires the validation of simulated electromagnetic wave arrival times in a one-dimensional cavity against an analytical model based on image theory. The simulation will be performed using the Finite-Difference Time-Domain (FDTD) method for Maxwell's equations.\n\n### Problem Validation\nThe problem statement has been critically examined and is determined to be **valid**. It is scientifically grounded in Maxwell's theory and standard computational electromagnetic techniques (FDTD, Yee grid). It is well-posed, providing all necessary physical parameters, boundary conditions, source definitions, and a clear criterion for validation. The specified constants ($\\epsilon_0$, $\\mu_0$), parameters ($L$, $N$, $f_0$, etc.), and boundary conditions (PEC at $x=0$, PMC at $x=L$) are self-consistent and physically reasonable. While one test case (Case C) has a source coordinate that does not perfectly align with a grid point, this is a common scenario in practice and can be handled by placing the source at the nearest grid point. The resulting positional error is small and its effect on arrival times is well within the specified tolerance, thus not invalidating the problem.\n\n### FDTD Formulation\nThe simulation addresses a one-dimensional Transverse Electromagnetic (TEM) wave propagating along the $x$-axis, with field components $E_y(x,t)$ and $H_z(x,t)$. The governing Maxwell's equations in a source-free, lossless medium reduce to:\n$$ \\frac{\\partial E_y}{\\partial x} = -\\mu_0 \\frac{\\partial H_z}{\\partial t} $$\n$$ \\frac{\\partial H_z}{\\partial x} = -\\epsilon_0 \\frac{\\partial E_y}{\\partial t} $$\nWe employ the Yee-staggered grid, where $E_y$ and $H_z$ are offset in both space and time. Let the domain $x \\in [0,L]$ be discretized into cells of width $\\Delta x$.\n- The electric field $E_y$ is sampled at spatial locations $x_i = i \\Delta x$ for $i=0, 1, \\dots, N-1$, where $L=(N-1)\\Delta x$. It is sampled at integer time steps $t_n = n \\Delta t$. We denote this as $E_y^n[i]$.\n- The magnetic field $H_z$ is sampled at spatial locations $x_{i+1/2} = (i+0.5) \\Delta x$ for $i=0, 1, \\dots, N-2$. It is sampled at half-integer time steps $t_{n+1/2} = (n+0.5) \\Delta t$. We denote this as $H_z^{n+1/2}[i]$.\n\nApplying central-difference approximations to the derivatives yields the FDTD update equations:\n1.  **Magnetic Field ($H_z$) Update**:\n    $$ H_z^{n+1/2}[i] = H_z^{n-1/2}[i] - \\frac{\\Delta t}{\\mu_0 \\Delta x} \\left( E_y^n[i+1] - E_y^n[i] \\right) $$\n    This equation updates the $H_z$ field from time step $n-1/2$ to $n+1/2$ using the $E_y$ field at time step $n$. This is applied for all $H_z$ nodes, i.e., $i = 0, \\dots, N-2$.\n\n2.  **Electric Field ($E_y$) Update**:\n    $$ E_y^{n+1}[i] = E_y^n[i] - \\frac{\\Delta t}{\\epsilon_0 \\Delta x} \\left( H_z^{n+1/2}[i] - H_z^{n+1/2}[i-1] \\right) $$\n    This equation updates the $E_y$ field from time step $n$ to $n+1$ using the just-computed $H_z$ field at time step $n+1/2$. This is applied for the interior $E_y$ nodes, i.e., $i=1, \\dots, N-2$.\n\nThe stability of this scheme is ensured by the Courant-Friedrichs-Lewy (CFL) condition, $\\Delta t \\le \\frac{\\Delta x}{c_0}$. The problem specifies a Courant factor $S=0.99$, so $\\Delta t = S \\frac{\\Delta x}{c_0}$, which guarantees stability.\n\n### Boundary and Source Conditions\n1.  **Perfect Electric Conductor (PEC) at $x=0$**: The condition $E_y(0,t)=0$ is enforced by setting $E_y^n[0] = 0$ for all time steps $n$.\n\n2.  **Perfect Magnetic Conductor (PMC) at $x=L$**: The condition $H_z(L,t)=0$ implies that the tangential magnetic field is zero. The update for $E_y$ at the boundary node $i=N-1$ requires $H_z$ values at $x_{N-1.5}$ (index $N-2$) and a \"ghost\" point at $x_{N-0.5} = L+0.5\\Delta x$. By image theory, the tangential $H_z$ field is anti-symmetric with respect to the PMC boundary. In discrete terms, the ghost value $H_{z, \\text{ghost}}^{n+1/2} = -H_z^{n+1/2}[N-2]$.\n    The update for $E_y[N-1]$ becomes:\n    $$ E_y^{n+1}[N-1] = E_y^n[N-1] - \\frac{\\Delta t}{\\epsilon_0 \\Delta x} \\left( H_{z, \\text{ghost}}^{n+1/2} - H_z^{n+1/2}[N-2] \\right) $$\n    $$ E_y^{n+1}[N-1] = E_y^n[N-1] - \\frac{\\Delta t}{\\epsilon_0 \\Delta x} \\left( -H_z^{n+1/2}[N-2] - H_z^{n+1/2}[N-2] \\right) = E_y^n[N-1] + \\frac{2 \\Delta t}{\\epsilon_0 \\Delta x} H_z^{n+1/2}[N-2] $$\n\n3.  **Soft Source Injection**: The Ricker wavelet $s(t)$ is added to the electric field at the grid location $k_s = \\mathrm{round}(x_s/\\Delta x)$ after the main $E_y$ update step at each time-step.\n    $$ E_y^{n+1}[k_s] \\leftarrow E_y^{n+1}[k_s] + s((n+1)\\Delta t) $$\n\n### Analytical Arrival Times and Validation\nThe analytical model uses image theory. For a cavity bounded by a PEC at $x=0$ and a PMC at $x=L$, the infinite set of image sources for a physical source at $x_s$ is located at positions $x_{\\text{img}} = 2 m L \\pm x_s$ for all integers $m \\in \\mathbb{Z}$. The arrival time of a pulse from an image source at an observer location $x_o$ is $t_{\\text{arr}} = t_0 + \\frac{|x_o - x_{\\text{img}}|}{c_0}$, where $t_0$ is the peak time of the source wavelet.\n\nThe validation procedure involves:\n1.  Running the FDTD simulation for the total time $T$ and recording $E_y$ at the observer node $k_o = \\mathrm{round}(x_o/\\Delta x)$.\n2.  Finding the first $K$ arrival times from the simulated signal by identifying the first $K$ local maxima in $|E_y(x_o,t)|$ that exceed a data-adaptive threshold. `scipy.signal.find_peaks` with a prominence threshold relative to the maximum signal amplitude is a robust method.\n3.  Calculating the first $K$ theoretical arrival times using the image theory formula, sorted in ascending order.\n4.  Comparing the two sets of times. The validation is `True` if at least $K$ arrivals are detected in the simulation and the absolute difference between each simulated arrival and its corresponding analytical counterpart is less than the tolerance $\\delta_t = 5 \\Delta t$.\n\nThis methodology provides a rigorous comparison between the numerical simulation and the underlying physical theory.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\nfrom scipy.signal import find_peaks\n\ndef ricker_wavelet(t, t0, f0):\n    \"\"\"\n    Computes the Ricker wavelet s(t) at time t.\n\n    Args:\n        t (float or np.ndarray): Time(s) in seconds.\n        t0 (float): Center time of the wavelet in seconds.\n        f0 (float): Central frequency of the wavelet in Hz.\n\n    Returns:\n        float or np.ndarray: The value of the Ricker wavelet.\n    \"\"\"\n    arg = (np.pi**2) * (f0**2) * ((t - t0)**2)\n    return (1.0 - 2.0 * arg) * np.exp(-arg)\n\ndef calculate_analytical_arrivals(L, xs, xo, t0, c0, T_total, K):\n    \"\"\"\n    Calculates analytical arrival times using image theory for a PEC-PMC cavity.\n\n    Args:\n        L (float): Length of the cavity in meters.\n        xs (float): Source position in meters.\n        xo (float): Observer position in meters.\n        t0 (float): Center time of the source wavelet in seconds.\n        c0 (float): Speed of light in meters per second.\n        T_total (float): Total simulation time in seconds.\n        K (int): Number of arrivals to compute.\n\n    Returns:\n        list: A sorted list of the first K analytical arrival times.\n    \"\"\"\n    arrivals = []\n    # A sufficiently large range for m to find all arrivals within T_total\n    m_range = int(T_total * c0 / (2.0 * L)) + 5\n\n    for m in range(-m_range, m_range + 1):\n        # Image sources at 2*m*L +/- xs\n        x_img1 = 2.0 * m * L + xs\n        x_img2 = 2.0 * m * L - xs\n        \n        t_arr1 = t0 + np.abs(xo - x_img1) / c0\n        t_arr2 = t0 + np.abs(xo - x_img2) / c0\n        \n        if t_arr1 = T_total:\n            arrivals.append(t_arr1)\n        if t_arr2 = T_total:\n            arrivals.append(t_arr2)\n    \n    # Remove duplicates, sort, and take the first K\n    unique_arrivals = sorted(list(set(arrivals)))\n    return unique_arrivals[:K]\n\ndef run_fdtd_simulation(L, N, xs, xo, f0, t0, T, K):\n    \"\"\"\n    Runs a single 1D FDTD simulation case and validates the results against theory.\n    \"\"\"\n    # Physical constants\n    epsilon0 = constants.epsilon_0\n    mu0 = constants.mu_0\n    c0 = constants.c\n\n    # Grid parameters\n    S = 0.99  # Courant factor\n    dx = L / (N - 1)\n    dt = S * dx / c0\n    num_steps = int(np.ceil(T / dt))\n\n    # Field arrays\n    Ey = np.zeros(N, dtype=np.float64)\n    Hz = np.zeros(N - 1, dtype=np.float64)\n    \n    # Source and observer grid indices\n    ks = int(round(xs / dx))\n    ko = int(round(xo / dx))\n\n    # FDTD update coefficients\n    ce = dt / (epsilon0 * dx)\n    ch = dt / (mu0 * dx)\n\n    # Store observed field\n    Ey_observed = np.zeros(num_steps, dtype=np.float64)\n    time_vec = np.arange(num_steps) * dt\n\n    # FDTD time-stepping loop\n    for n in range(num_steps):\n        # Update H-field from E-field (indices 0 to N-2)\n        Hz[:] = Hz[:] - ch * (Ey[1:] - Ey[:-1])\n\n        # Update E-field from H-field (bulk nodes, indices 1 to N-2)\n        Ey[1:-1] = Ey[1:-1] - ce * (Hz[1:] - Hz[:-1])\n\n        # PEC boundary at x=0 (Ey[0]) is kept at 0\n        \n        # PMC boundary at x=L (Ey[N-1])\n        Ey[-1] = Ey[-1] + 2.0 * ce * Hz[-1]\n\n        # Inject source\n        t_current = (n + 1) * dt\n        source_val = ricker_wavelet(t_current, t0, f0)\n        Ey[ks] += source_val\n        \n        # Record field at observer\n        Ey_observed[n] = Ey[ko]\n\n    # Post-processing: Find simulated arrivals from recorded data\n    Ey_abs = np.abs(Ey_observed)\n    # Data-adaptive threshold for peak finding based on signal prominence.\n    max_amp = np.max(Ey_abs)\n    peak_prominence = 0.05 * max_amp if max_amp > 0 else 1.0\n\n    sim_peak_indices, _ = find_peaks(Ey_abs, prominence=peak_prominence)\n    sim_arrivals = sim_peak_indices * dt\n    \n    # Calculate analytical arrivals using the actual discretized grid positions\n    xs_actual = ks * dx\n    xo_actual = ko * dx\n    ana_arrivals = calculate_analytical_arrivals(L, xs_actual, xo_actual, t0, c0, T, K)\n\n    # Validation check\n    if len(sim_arrivals)  K or len(ana_arrivals)  K:\n        return False\n        \n    tolerance = 5.0 * dt\n    \n    for i in range(K):\n        if np.abs(sim_arrivals[i] - ana_arrivals[i]) > tolerance:\n            return False\n\n    return True\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'L': 1.0, 'N': 401, 'xs': 0.22, 'xo': 0.77, 'f0': 1.2e8, 't0': 5.0e-9, 'T': 3.5e-8, 'K': 6},\n        # Case B\n        {'L': 0.5, 'N': 401, 'xs': 0.10, 'xo': 0.45, 'f0': 8.0e7, 't0': 3.0e-9, 'T': 2.5e-8, 'K': 6},\n        # Case C\n        {'L': 0.8, 'N': 301, 'xs': 0.30, 'xo': 0.20, 'f0': 1.0e8, 't0': 4.0e-9, 'T': 3.0e-8, 'K': 5},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = run_fdtd_simulation(**case_params)\n        results.append(str(result).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3338736"}, {"introduction": "This final practice investigates the profound impact of boundary conditions on the resonant spectrum and fundamental symmetries of an electromagnetic system [@problem_id:3338758]. By computing the eigenfrequencies of a two-dimensional cavity, you will observe how replacing a symmetric, all-PEC configuration with a mixed PEC/PMC arrangement breaks the geometric symmetry and lifts mode degeneracies. This exercise culminates in using the powerful principle of electromagnetic duality to connect the TM-mode spectrum of the cavity to the TE-mode spectrum of its dual, providing a sophisticated validation of your results.", "problem": "Consider a two-dimensional rectangular electromagnetic cavity with dimensions $a$ (along $x$) and $b$ (along $y$), filled with homogeneous, isotropic vacuum characterized by permittivity $\\varepsilon_0$ and permeability $\\mu_0$. Assume time-harmonic fields with angular frequency $\\omega$, using the engineering phasor convention $e^{j \\omega t}$. The cavity walls enforce idealized boundary conditions either as Perfect Electric Conductor (PEC) or Perfect Magnetic Conductor (PMC). By definition, at a PEC the tangential component of the electric field is zero, and at a PMC the tangential component of the magnetic field is zero. Within the transverse electromagnetic decomposition for rectangular geometries, define the Transverse Magnetic with respect to $z$ (TM$_z$) polarization as the case with nonzero longitudinal electric field $E_z$ and zero longitudinal magnetic field $H_z$, and the Transverse Electric with respect to $z$ (TE$_z$) polarization as the case with nonzero longitudinal magnetic field $H_z$ and zero longitudinal electric field $E_z$.\n\nStarting from Maxwell’s equations in the frequency domain and appropriate boundary conditions, the longitudinal field component satisfies a scalar Helmholtz equation in the transverse coordinates with boundary conditions that map to either Dirichlet or Neumann type on the longitudinal scalar potential, depending on polarization and wall type. Your tasks are:\n\n- Derive from first principles which boundary type (Dirichlet or Neumann) applies to the longitudinal scalar potential at each wall for TM$_z$ and TE$_z$ polarizations, starting from the frequency-domain Maxwell’s equations, constitutive relations, and PEC and PMC definitions, without relying on shortcut formulas.\n- Using separation of variables on the scalar Helmholtz equation, construct the spectrum of allowed transverse wavenumbers in the $x$ and $y$ directions for all wall-type combinations that arise in the test suite below. Combine these to obtain the resonant angular frequencies $\\omega$ and the corresponding linear frequencies $f = \\omega/(2\\pi)$ in Hertz. Use $c = \\frac{1}{\\sqrt{\\varepsilon_0 \\mu_0}} = 299\\,792\\,458\\,\\mathrm{m/s}$.\n- Implement a program that, for each geometry in the test suite, computes the lowest $K$ distinct linear frequencies $f$ for TM$_z$ and TE$_z$ polarizations in ascending order. Distinctness must be determined by clustering frequencies that lie within an absolute tolerance $\\tau$; the representative of each cluster can be taken as the smallest element in the cluster.\n- Define a degeneracy group as a cluster having multiplicity greater than $1$. For each geometry in the test suite, compute the number of degeneracy groups among the lowest $K$ distinct TM$_z$ frequencies for:\n  1. A baseline cavity with both $x$ walls and both $y$ walls being PEC.\n  2. A mixed cavity with one $x$ wall PEC and the opposite $x$ wall PMC, while both $y$ walls are PEC.\n- Identify degeneracy lifting by comparing the count of degeneracy groups in the baseline and mixed cavities; a reduction in the count indicates degeneracy lifting caused by the mixed-wall configuration.\n- Verify electromagnetic duality by constructing the dual geometry in which all wall types are swapped (PEC $\\leftrightarrow$ PMC) and comparing spectra: numerically confirm that the TM$_z$ spectrum of the original mixed-wall cavity equals the TE$_z$ spectrum of its dual cavity within the tolerance $\\tau$, for the lowest $K$ distinct frequencies. Report a boolean that is $true$ if the equality holds for all $K$ values and $false$ otherwise.\n\nYour program should output, for each test case, a list of three values: the integer count of degeneracy groups among the lowest $K$ distinct TM$_z$ frequencies for the baseline cavity, the integer count of degeneracy groups among the lowest $K$ distinct TM$_z$ frequencies for the mixed cavity, and a boolean indicating whether the duality equality holds for the lowest $K$ distinct frequencies. Aggregate the results for all test cases into a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nUse the following test suite, with all dimensions in meters and frequencies in Hertz:\n\n- Test case $1$: $a = 0.20$, $b = 0.20$, $K = 10$, $\\tau = 1\\times 10^{-9}$. Mixed cavity walls: at $x=0$ use PEC, at $x=a$ use PMC, at $y=0$ and $y=b$ use PEC. The baseline cavity uses PEC at all four walls.\n- Test case $2$: $a = 0.30$, $b = 0.50$, $K = 10$, $\\tau = 1\\times 10^{-9}$. Mixed cavity walls: at $x=0$ use PEC, at $x=a$ use PMC, at $y=0$ and $y=b$ use PEC. The baseline cavity uses PEC at all four walls.\n- Test case $3$: $a = 0.25$, $b = 0.25$, $K = 12$, $\\tau = 1\\times 10^{-9}$. Mixed cavity walls: at $x=0$ use PEC, at $x=a$ use PMC, at $y=0$ and $y=b$ use PEC. The baseline cavity uses PEC at all four walls.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test-case result is itself a list of the form $[d_{\\mathrm{baseline}}, d_{\\mathrm{mixed}}, \\mathrm{duality\\_ok}]$, for example $[[2,1,true],[0,0,true],[3,1,true]]$.", "solution": "### Problem Validation\nThe problem is scientifically valid and well-posed. It correctly frames a standard analysis of electromagnetic resonant cavities, focusing on the distinct physical consequences of Perfect Electric Conductor (PEC) and Perfect Magnetic Conductor (PMC) boundary conditions. The tasks, including derivation of boundary condition types, calculation of resonant spectra, analysis of degeneracy, and verification of electromagnetic duality, are self-consistent and grounded in fundamental Maxwellian theory. All necessary parameters and a clear validation procedure are provided.\n\n### Part 1: Derivation of Boundary Condition Types\nThe analysis begins with the time-harmonic Maxwell's equations in a source-free, lossless medium:\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu_0 \\mathbf{H} \\quad \\text{and} \\quad \\nabla \\times \\mathbf{H} = j\\omega\\epsilon_0 \\mathbf{E} $$\nThe longitudinal field component ($E_z$ for TM$_z$, $H_z$ for TE$_z$), denoted by $\\Psi$, satisfies the scalar Helmholtz equation $(\\nabla_t^2 + k_c^2)\\Psi = 0$, where $k_c^2 = \\omega^2/c^2$ is the cutoff wavenumber for a 2D cavity. The transverse fields are derived from $\\Psi$.\n\n**Case 1: Transverse Magnetic (TM$_z$) Polarization ($H_z=0$, $\\Psi=E_z$)**\n-   **PEC Boundary**: By definition, the tangential electric field is zero ($\\mathbf{E}_{\\text{tan}} = \\mathbf{0}$). Since the longitudinal field $E_z$ is tangential to all four walls of the rectangular cavity, the condition at a PEC wall is directly:\n    $$ E_z = 0 \\quad (\\text{Dirichlet condition}) $$\n-   **PMC Boundary**: By definition, the tangential magnetic field is zero ($\\mathbf{H}_{\\text{tan}} = \\mathbf{0}$). The transverse magnetic field $\\mathbf{H}_t$ is derived from $E_z$ as:\n    $$ \\mathbf{H}_t = \\frac{j\\omega\\epsilon_0}{k_c^2} (\\hat{\\mathbf{z}} \\times \\nabla_t E_z) = \\frac{j\\omega\\epsilon_0}{k_c^2} \\left( \\frac{\\partial E_z}{\\partial y}\\hat{\\mathbf{x}} - \\frac{\\partial E_z}{\\partial x}\\hat{\\mathbf{y}} \\right) $$\n    At a wall with normal $\\hat{\\mathbf{n}}$, the tangential magnetic field component is zero. For a wall at $x=a$ ($\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}$), the tangential direction is $\\hat{\\mathbf{y}}$. The condition is $H_y(a,y)=0$. From the expression for $\\mathbf{H}_t$, this requires $\\frac{\\partial E_z}{\\partial x}(a,y) = 0$. In general, this corresponds to a condition on the normal derivative:\n    $$ \\frac{\\partial E_z}{\\partial n} = 0 \\quad (\\text{Neumann condition}) $$\n\n**Case 2: Transverse Electric (TE$_z$) Polarization ($E_z=0$, $\\Psi=H_z$)**\n-   **PEC Boundary**: The tangential electric field is zero ($\\mathbf{E}_{\\text{tan}} = \\mathbf{0}$). The transverse electric field $\\mathbf{E}_t$ is derived from $H_z$ as:\n    $$ \\mathbf{E}_t = -\\frac{j\\omega\\mu_0}{k_c^2} (\\hat{\\mathbf{z}} \\times \\nabla_t H_z) = -\\frac{j\\omega\\mu_0}{k_c^2} \\left( \\frac{\\partial H_z}{\\partial y}\\hat{\\mathbf{x}} - \\frac{\\partial H_z}{\\partial x}\\hat{\\mathbf{y}} \\right) $$\n    At a wall with normal $\\hat{\\mathbf{n}}$ (e.g., at $x=a$), the tangential electric field component (e.g., $E_y$) must be zero. This requires $\\frac{\\partial H_z}{\\partial x}(a,y) = 0$, which is a condition on the normal derivative:\n    $$ \\frac{\\partial H_z}{\\partial n} = 0 \\quad (\\text{Neumann condition}) $$\n-   **PMC Boundary**: The tangential magnetic field is zero ($\\mathbf{H}_{\\text{tan}} = \\mathbf{0}$). Since the longitudinal field $H_z$ is tangential to all four walls, the condition at a PMC wall is directly:\n    $$ H_z = 0 \\quad (\\text{Dirichlet condition}) $$\n\n### Part 2: Spectrum from Separation of Variables\nSolving the scalar Helmholtz equation $(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + k_c^2)\\Psi = 0$ with separation of variables $\\Psi(x,y) = X(x)Y(y)$ yields $X''/X + Y''/Y = -k_c^2$. This separates into two ordinary differential equations, $X'' + k_x^2 X = 0$ and $Y'' + k_y^2 Y = 0$, with $k_c^2 = k_x^2 + k_y^2$. The boundary conditions determine the allowed eigenvalues $k_x$ and $k_y$.\n-   **Dirichlet-Dirichlet (DD)** on $[0, L]$: $X(0)=0, X(L)=0 \\implies k_L = \\frac{m\\pi}{L}, \\; m=1, 2, 3, \\dots$\n-   **Neumann-Neumann (NN)** on $[0, L]$: $X'(0)=0, X'(L)=0 \\implies k_L = \\frac{m\\pi}{L}, \\; m=0, 1, 2, \\dots$\n-   **Dirichlet-Neumann (DN)** on $[0, L]$: $X(0)=0, X'(L)=0 \\implies k_L = \\frac{(m-1/2)\\pi}{L} = \\frac{(2m-1)\\pi}{2L}, \\; m=1, 2, 3, \\dots$\n\nThe resonant angular frequency is $\\omega_{mn} = c \\sqrt{k_x^2 + k_y^2}$, and the linear frequency is $f_{mn} = \\frac{\\omega_{mn}}{2\\pi}$. For TM modes, we require $k_c^2 > 0$, so we exclude cases where both mode indices are zero. For TE modes, we also require $k_c^2 > 0$.\n\n### Part 3: Algorithmic Design and Duality Verification\nThe computational procedure follows these steps:\n1.  **Spectrum Calculation:** For each cavity configuration (baseline TM, mixed TM, dual TE), identify the boundary condition type for the $x$ and $y$ dimensions (e.g., mixed TM is 'DN' on $x$ and 'DD' on $y$).\n2.  **Mode Generation:** Generate a grid of mode indices $(m, n)$ over a sufficiently large range to ensure at least $K$ distinct frequencies are found.\n3.  **Frequency Computation:** For each $(m,n)$ pair, calculate the resonant frequency $f_{mn}$ using the appropriate formulas for $k_x(m)$ and $k_y(n)$.\n4.  **Clustering and Degeneracy:** Sort all computed frequencies. Iterate through the sorted list, grouping frequencies that are within a tolerance $\\tau$ of each other into clusters. The first frequency in each cluster is its representative distinct frequency. A cluster with more than one member constitutes a degeneracy group. Count the number of such groups among the first $K$ distinct frequencies.\n5.  **Degeneracy Lifting:** Compare the number of degeneracy groups for the baseline (all-PEC) cavity with the mixed-boundary cavity. A reduction in this count signifies that the broken symmetry has lifted the degeneracies.\n6.  **Duality Verification:** The dual of the mixed-wall cavity (PEC/PMC on $x$, PEC/PEC on $y$) is a cavity with (PMC/PEC on $x$, PMC/PMC on $y$). As derived in Part 1, the TE$_z$ spectrum of this dual cavity requires solving for $H_z$ with a Dirichlet condition at a PMC wall and a Neumann condition at a PEC wall. This results in a 'DN' problem on $x$ and a 'DD' problem on $y$. This is mathematically identical to the scalar problem for $E_z$ in the original mixed TM$_z$ cavity. Therefore, their spectra must be identical. The algorithm computes both spectra independently and compares the first $K$ distinct frequencies. If they match element-wise within the tolerance $\\tau$, the duality principle is numerically verified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_spectrum_stats(a, b, x_bc_type, y_bc_type, K, tau):\n    \"\"\"\n    Computes the K lowest distinct frequencies and degeneracy count for a given cavity configuration.\n\n    Args:\n        a (float): Cavity dimension along x.\n        b (float): Cavity dimension along y.\n        x_bc_type (str): Boundary condition type on x-walls ('DD', 'DN', etc.).\n        y_bc_type (str): Boundary condition type on y-walls.\n        K (int): Number of lowest distinct frequencies to find.\n        tau (float): Absolute tolerance for clustering frequencies.\n\n    Returns:\n        tuple: A tuple containing:\n            - list: The K lowest distinct frequencies.\n            - int: The number of degeneracy groups among these K frequencies.\n    \"\"\"\n    c = 299792458.0  # Speed of light in m/s\n\n    kx_func, m_min = None, 0\n    if x_bc_type == 'DD':\n        kx_func = lambda m_val: m_val * np.pi / a\n        m_min = 1\n    elif x_bc_type == 'DN':\n        kx_func = lambda m_val: (m_val - 0.5) * np.pi / a\n        m_min = 1\n\n    ky_func, n_min = None, 0\n    if y_bc_type == 'DD':\n        ky_func = lambda n_val: n_val * np.pi / b\n        n_min = 1\n    elif y_bc_type == 'DN':\n        ky_func = lambda n_val: (n_val - 0.5) * np.pi / b\n        n_min = 1\n\n    # Generate frequencies using an expanding grid of (m, n) indices\n    # to ensure we capture at least K distinct frequencies.\n    # An index range up to 3*K is a safe upper bound for typical mode densities.\n    max_idx = int(3 * K)\n    m_range = np.arange(m_min, max_idx)\n    n_range = np.arange(n_min, max_idx)\n    \n    m_grid, n_grid = np.meshgrid(m_range, n_range)\n\n    kx_grid = kx_func(m_grid)\n    ky_grid = ky_func(n_grid)\n\n    kc_sq_grid = kx_grid**2 + ky_grid**2\n    # Exclude non-resonant modes (k_c = 0)\n    valid_indices = kc_sq_grid > 1e-12 \n    \n    freqs = (c / (2 * np.pi)) * np.sqrt(kc_sq_grid[valid_indices])\n    sorted_freqs = np.sort(freqs)\n\n    # Cluster frequencies\n    if len(sorted_freqs) == 0:\n        return [], 0\n    \n    clusters = []\n    current_cluster = [sorted_freqs[0]]\n    for f in sorted_freqs[1:]:\n        if f - current_cluster[0] = tau:\n            current_cluster.append(f)\n        else:\n            clusters.append(current_cluster)\n            current_cluster = [f]\n    clusters.append(current_cluster)\n\n    k_clusters = clusters[:K]\n    \n    distinct_freqs = [cl[0] for cl in k_clusters]\n    degeneracy_count = sum(1 for cl in k_clusters if len(cl) > 1)\n\n    return distinct_freqs, degeneracy_count\n\ndef solve():\n    \"\"\"\n    Main solver function to process test cases and generate final output.\n    \"\"\"\n    test_cases = [\n        {'a': 0.20, 'b': 0.20, 'K': 10, 'tau': 1e-9},\n        {'a': 0.30, 'b': 0.50, 'K': 10, 'tau': 1e-9},\n        {'a': 0.25, 'b': 0.25, 'K': 12, 'tau': 1e-9}\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        a, b, K, tau = case['a'], case['b'], case['K'], case['tau']\n\n        # 1. Baseline cavity: all PEC, TMz polarization\n        # PEC -> E_tan = 0 -> E_z = 0 (Dirichlet)\n        # So, BCs are D-D for x-walls and D-D for y-walls.\n        _, d_baseline = get_spectrum_stats(a, b, 'DD', 'DD', K, tau)\n\n        # 2. Mixed cavity: PEC at x=0, PMC at x=a, PEC at y=0,b. TMz polarization.\n        # x-walls: PEC at x=0 (Dirichlet), PMC at x=a (Neumann) -> D-N\n        # y-walls: PEC at y=0,b (Dirichlet) -> D-D\n        distinct_freqs_mixed_tm, d_mixed = get_spectrum_stats(a, b, 'DN', 'DD', K, tau)\n        \n        # 3. Duality check: Dual of mixed cavity, TEz polarization.\n        # Dual cavity walls: PMC at x=0, PEC at x=a, PMC at y=0,b.\n        # TEz polarization on dual cavity:\n        # x-walls: PMC at x=0 (H_z=0, Dirichlet), PEC at x=a (d(H_z)/dn=0, Neumann) -> D-N\n        # y-walls: PMC at y=0,b (H_z=0, Dirichlet) -> D-D\n        # The formulation is identical to the mixed cavity TMz case.\n        distinct_freqs_dual_te, _ = get_spectrum_stats(a, b, 'DN', 'DD', K, tau)\n\n        # Compare spectra for duality\n        duality_ok = False\n        if len(distinct_freqs_mixed_tm) == K and len(distinct_freqs_dual_te) == K:\n            duality_ok = np.allclose(distinct_freqs_mixed_tm, distinct_freqs_dual_te, rtol=0, atol=tau)\n\n        all_results.append([d_baseline, d_mixed, duality_ok])\n\n    # Format the final output string exactly as required\n    str_results = []\n    for r in all_results:\n        str_results.append(f\"[{r[0]},{r[1]},{str(r[2]).lower()}]\")\n    \n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```", "id": "3338758"}]}