{"hands_on_practices": [{"introduction": "The choice between numerical methods like the Finite Element Method (FEM) and the Method of Moments (MoM) has profound implications for computational resource requirements. This practice provides a concrete, quantitative comparison by tasking you to derive the memory needed to store the sparse matrix from an FEM discretization versus the dense matrix from a MoM model. Completing this exercise will make the abstract concept of \"computational scaling\" tangible, demonstrating why exploiting sparsity is not just an optimization but a necessity for solving large-scale electromagnetic problems [@problem_id:3329223].", "problem": "In frequency-domain computational electromagnetics, the curl-curl formulation of Maxwell’s equations with appropriate constitutive relations and boundary conditions yields a linear system of the form $A x = b$, where $A$ is the system matrix and $x$ collects the expansion coefficients of the chosen basis functions. Consider two standard discretizations of this problem: the Finite Element Method (FEM) in a three-dimensional inhomogeneous domain and the Method of Moments (MoM) for a surface integral equation.\n\nFor the Finite Element Method, assume a conforming Galerkin discretization with nodal or edge basis functions whose supports are localized to elements, producing a symmetric sparse stiffness matrix $A \\in \\mathbb{C}^{n \\times n}$ due to reciprocity and the locality of the bilinear form. Let $n$ denote the total number of unknowns and suppose the mesh connectivity is such that, on average, each degree of freedom is directly coupled to $d$ others through element adjacency. You are to store $A$ using the Compressed Sparse Row (CSR) format, but you exploit symmetry to store only the upper triangular part (including the diagonal). In CSR, you must store three arrays: the numerical values (one per stored nonzero), the column indices (one per stored nonzero), and the row-pointer array of length $n+1$. Assume each complex numerical value occupies $b_{c}$ bytes and each integer index occupies $b_{i}$ bytes. Derive, from these definitions and the locality of FEM interactions, an exact symbolic expression in terms of $n$, $d$, $b_{c}$, and $b_{i}$ for the total memory in bytes required to store the symmetric sparse FEM matrix in upper-triangular CSR.\n\nFor the Method of Moments, assume a standard Galerkin discretization of a boundary integral operator built from the free-space Green’s function. The resulting impedance matrix $Z \\in \\mathbb{C}^{n \\times n}$ is dense because every degree of freedom interacts with all others through the nonlocal kernel. Assume the dense matrix is stored as a contiguous two-dimensional array of complex values without any additional index arrays, and that each complex value occupies $b_{c}$ bytes. Derive, from these definitions and the nonlocality of the MoM interactions, an exact symbolic expression in terms of $n$ and $b_{c}$ for the total memory in bytes required to store the dense MoM matrix.\n\nDo not assume any Toeplitz structure in either matrix; treat the general case. Present your final answer as a single row matrix with two entries using the LaTeX $\\mathrm{pmatrix}$ environment, where the first entry is the total memory for the symmetric sparse FEM matrix in upper-triangular Compressed Sparse Row (CSR), and the second entry is the total memory for the dense Method of Moments (MoM) matrix. Express your results purely symbolically in terms of $n$, $d$, $b_{c}$, and $b_{i}$, and do not include any units inside the final answer.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of computational electromagnetics and numerical linear algebra, well-posed with sufficient and consistent information, and objectively formulated. The task is to derive symbolic expressions for the memory required to store matrices arising from two different discretization methods: the Finite Element Method (FEM) and the Method of Moments (MoM).\n\nFirst, we derive the expression for the memory required for the symmetric sparse FEM matrix.\nThe matrix $A$ is of size $n \\times n$ and is symmetric. The storage scheme is Compressed Sparse Row (CSR) for only the upper triangular part of the matrix, including the main diagonal. This symmetric CSR format consists of three arrays:\n$1$. A `values` array containing the complex non-zero matrix entries that are stored.\n$2$. A `col_indices` array containing the column index for each corresponding value.\n$3$. A `row_ptr` array of length $n+1$ indicating the start of each row's data in the other two arrays.\n\nTo calculate the total memory, we must first determine the number of non-zero entries, $N_{nz}$, being stored. We are storing the entries $A_{ij}$ where $i \\le j$ and $A_{ij} \\neq 0$.\nThe problem states that, on average, each degree of freedom is coupled to $d$ others. This corresponds to the average number of off-diagonal non-zero entries per row in the full matrix $A$.\nThe total number of off-diagonal non-zero entries in the entire symmetric matrix $A$ is $n \\times d$. Since for every non-zero entry $A_{ij}$ with $i \\neq j$, there is a corresponding non-zero entry $A_{ji}$, counting $n \\times d$ double-counts the connections. The number of unique off-diagonal interacting pairs $(i, j)$ is therefore $\\frac{n \\times d}{2}$.\nThe upper triangular part of the matrix contains all these unique off-diagonal interactions. Thus, the number of stored off-diagonal non-zero entries is $\\frac{nd}{2}$.\nAdditionally, we must store the $n$ entries on the main diagonal. We assume all diagonal elements are non-zero, a standard assumption for such systems.\nThe total number of stored non-zero entries, $N_{nz}$, is the sum of the diagonal and upper-triangular off-diagonal entries:\n$$N_{nz} = n + \\frac{nd}{2} = n\\left(1 + \\frac{d}{2}\\right)$$\nNow we calculate the memory required for each of the three CSR arrays.\nThe `values` array stores $N_{nz}$ complex numbers. Each complex value occupies $b_c$ bytes. The memory required for this array is:\n$$M_{\\text{values}} = N_{nz} \\times b_c = n\\left(1 + \\frac{d}{2}\\right) b_c$$\nThe `col_indices` array stores $N_{nz}$ integers. Each integer index occupies $b_i$ bytes. The memory required for this array is:\n$$M_{\\text{col\\_indices}} = N_{nz} \\times b_i = n\\left(1 + \\frac{d}{2}\\right) b_i$$\nThe `row_ptr` array has a fixed length of $n+1$. Each entry is an integer index occupying $b_i$ bytes. The memory required for this array is:\n$$M_{\\text{row\\_ptr}} = (n+1) b_i$$\nThe total memory for the FEM matrix, $M_{FEM}$, is the sum of the memory for these three arrays:\n$$M_{FEM} = M_{\\text{values}} + M_{\\text{col\\_indices}} + M_{\\text{row\\_ptr}}$$\n$$M_{FEM} = n\\left(1 + \\frac{d}{2}\\right) b_c + n\\left(1 + \\frac{d}{2}\\right) b_i + (n+1) b_i$$\nCombining the terms with $b_i$:\n$$M_{FEM} = n\\left(1 + \\frac{d}{2}\\right) b_c + \\left[ n\\left(1 + \\frac{d}{2}\\right) + n + 1 \\right] b_i$$\n$$M_{FEM} = n\\left(1 + \\frac{d}{2}\\right) b_c + \\left( n + \\frac{nd}{2} + n + 1 \\right) b_i$$\n$$M_{FEM} = n\\left(1 + \\frac{d}{2}\\right) b_c + \\left( 2n + \\frac{nd}{2} + 1 \\right) b_i$$\n\nNext, we derive the expression for the memory required for the dense MoM matrix.\nThe impedance matrix $Z$ is of size $n \\times n$ and is dense. This means all of its entries are considered non-zero and must be stored.\nThe total number of entries in the matrix is $n \\times n = n^2$.\nThe matrix is stored as a contiguous two-dimensional array. Each entry is a complex value that occupies $b_c$ bytes. No additional index arrays are used for a dense matrix.\nThe total memory for the MoM matrix, $M_{MoM}$, is the total number of entries multiplied by the size of each entry:\n$$M_{MoM} = n^2 \\times b_c = n^2 b_c$$\nThis provides the two required symbolic expressions.", "answer": "$$ \\boxed{ \\begin{pmatrix} n \\left(1 + \\frac{d}{2}\\right) b_c + \\left( 2n + \\frac{nd}{2} + 1 \\right) b_i  n^2 b_c \\end{pmatrix} } $$", "id": "3329223"}, {"introduction": "A key skill in computational science is understanding how the structure of a continuous partial differential equation (PDE) translates into the structure of a discrete matrix. This exercise guides you through a finite-difference discretization of the vector curl-curl equation, forcing you to trace how each derivative term creates specific couplings between degrees of freedom. By determining the resulting matrix stencil, you will gain a deeper intuition for the connection between the physics of wave propagation and the sparse patterns that numerical solvers must handle [@problem_id:3329230].", "problem": "Consider the time-harmonic Maxwell curl-curl equation in a homogeneous, isotropic medium with constant wavenumber $k$:\n$$\\nabla \\times \\nabla \\times \\mathbf{E} - k^{2} \\mathbf{E} = \\mathbf{f},$$\nwhere $\\mathbf{E}(\\mathbf{x}) \\in \\mathbb{R}^{3}$ is the electric field and $\\mathbf{f}$ is a given source. Work on a three-dimensional, uniform, structured grid with grid spacings $h_{x}$, $h_{y}$, and $h_{z}$ in the $x$, $y$, and $z$ directions, respectively. Use a collocated discretization in the Finite-Difference Frequency-Domain (FDFD) method, placing all three components of $\\mathbf{E}$ at the same grid nodes. Discretize all first and second derivatives with second-order central differences. Assume interior nodes only (ignore boundary conditions) and constant coefficients throughout. Use block-lexicographic ordering of unknowns, with the three components $(E_{x}, E_{y}, E_{z})$ at each node grouped together in the global vector.\n\nStarting from the vector calculus identity\n$$\\nabla \\times \\nabla \\times \\mathbf{E} = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^{2} \\mathbf{E},$$\nand using second-order central differences for each derivative, construct the adjacency pattern (graph) of the sparse system matrix row associated with an interior degree of freedom corresponding to the $x$-component $E_{x}$ at a representative interior node $(i,j,k)$. In your construction, clearly identify which neighboring nodes and which field components at those nodes couple into the row for $E_{x}(i,j,k)$ under this discretization.\n\nDefine the stencil width as follows: for the set of grid offsets $(\\Delta i, \\Delta j, \\Delta k)$ appearing in the row’s nonzero couplings, the stencil width is the maximum Chebyshev distance $w = \\max\\{|\\Delta i|, |\\Delta j|, |\\Delta k|\\}$ over all such offsets. The number of nonzeros per row is the total count of distinct couplings (including the diagonal) for the interior $E_{x}$ row under the assumptions above.\n\nCompute the stencil width and the number of nonzeros per row. Express your final answer as a two-entry row matrix $\\begin{pmatrix} w  \\text{nnz} \\end{pmatrix}$. No rounding is required.", "solution": "The problem is scientifically grounded, well-posed, and objective, based on fundamental principles of electromagnetism and standard numerical methods. All information required to determine the stencil properties for an interior node is provided. The problem is therefore valid.\n\nWe begin with the time-harmonic Maxwell curl-curl equation provided:\n$$ \\nabla \\times \\nabla \\times \\mathbf{E} - k^{2} \\mathbf{E} = \\mathbf{f} $$\nThe problem instructs us to use the vector calculus identity $\\nabla \\times \\nabla \\times \\mathbf{E} = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^{2} \\mathbf{E}$. Substituting this into the equation gives:\n$$ \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^{2} \\mathbf{E} - k^{2} \\mathbf{E} = \\mathbf{f} $$\nWe are required to analyze the row of the system matrix corresponding to the $x$-component of the electric field, $E_{x}$, at a representative interior grid node $(i,j,k)$. Let us write the $x$-component of the vector equation:\n$$ (\\nabla(\\nabla \\cdot \\mathbf{E}))_{x} - (\\nabla^{2} \\mathbf{E})_{x} - k^{2} E_{x} = f_{x} $$\nFirst, we expand the vector operators. The divergence of $\\mathbf{E}$ is:\n$$ \\nabla \\cdot \\mathbf{E} = \\frac{\\partial E_{x}}{\\partial x} + \\frac{\\partial E_{y}}{\\partial y} + \\frac{\\partial E_{z}}{\\partial z} $$\nThe $x$-component of the gradient of this scalar field is:\n$$ (\\nabla(\\nabla \\cdot \\mathbf{E}))_{x} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial E_{x}}{\\partial x} + \\frac{\\partial E_{y}}{\\partial y} + \\frac{\\partial E_{z}}{\\partial z} \\right) = \\frac{\\partial^{2} E_{x}}{\\partial x^{2}} + \\frac{\\partial^{2} E_{y}}{\\partial x \\partial y} + \\frac{\\partial^{2} E_{z}}{\\partial x \\partial z} $$\nThe $x$-component of the vector Laplacian $\\nabla^2 \\mathbf{E}$ is simply the scalar Laplacian applied to $E_x$:\n$$ (\\nabla^{2} \\mathbf{E})_{x} = \\nabla^{2} E_{x} = \\frac{\\partial^{2} E_{x}}{\\partial x^{2}} + \\frac{\\partial^{2} E_{x}}{\\partial y^{2}} + \\frac{\\partial^{2} E_{x}}{\\partial z^{2}} $$\nSubstituting these expansions into the $x$-component equation for the field:\n$$ \\left( \\frac{\\partial^{2} E_{x}}{\\partial x^{2}} + \\frac{\\partial^{2} E_{y}}{\\partial x \\partial y} + \\frac{\\partial^{2} E_{z}}{\\partial x \\partial z} \\right) - \\left( \\frac{\\partial^{2} E_{x}}{\\partial x^{2}} + \\frac{\\partial^{2} E_{x}}{\\partial y^{2}} + \\frac{\\partial^{2} E_{x}}{\\partial z^{2}} \\right) - k^{2} E_{x} = f_{x} $$\nThe term $\\frac{\\partial^{2} E_{x}}{\\partial x^{2}}$ cancels out, yielding the simplified partial differential equation for $E_x$:\n$$ - \\frac{\\partial^{2} E_{x}}{\\partial y^{2}} - \\frac{\\partial^{2} E_{x}}{\\partial z^{2}} + \\frac{\\partial^{2} E_{y}}{\\partial x \\partial y} + \\frac{\\partial^{2} E_{z}}{\\partial x \\partial z} - k^{2} E_{x} = f_{x} $$\nNext, we discretize each derivative using second-order central differences on a uniform grid with spacings $h_x, h_y, h_z$. Let $E_c(i,j,k)$ denote the value of the component $c \\in \\{x,y,z\\}$ at grid node $(x_i, y_j, z_k)$.\n\nThe second partial derivatives of $E_x$ are approximated as:\n$$ \\frac{\\partial^{2} E_{x}}{\\partial y^{2}} \\bigg|_{(i,j,k)} \\approx \\frac{E_{x}(i,j+1,k) - 2E_{x}(i,j,k) + E_{x}(i,j-1,k)}{h_{y}^{2}} $$\n$$ \\frac{\\partial^{2} E_{x}}{\\partial z^{2}} \\bigg|_{(i,j,k)} \\approx \\frac{E_{x}(i,j,k+1) - 2E_{x}(i,j,k) + E_{x}(i,j,k-1)}{h_{z}^{2}} $$\nThe mixed partial derivatives are approximated by applying central differences sequentially:\n$$ \\frac{\\partial^{2} E_{y}}{\\partial x \\partial y} \\bigg|_{(i,j,k)} \\approx \\frac{1}{4h_{x}h_{y}} [E_{y}(i+1,j+1,k) - E_{y}(i-1,j+1,k) - E_{y}(i+1,j-1,k) + E_{y}(i-1,j-1,k)] $$\n$$ \\frac{\\partial^{2} E_{z}}{\\partial x \\partial z} \\bigg|_{(i,j,k)} \\approx \\frac{1}{4h_{x}h_{z}} [E_{z}(i+1,j,k+1) - E_{z}(i-1,j,k+1) - E_{z}(i+1,j,k-1) + E_{z}(i-1,j,k-1)] $$\nSubstituting these finite difference approximations into the simplified PDE for $E_x$ gives the discrete equation for the unknown $E_x(i,j,k)$. This equation reveals the couplings, which constitute the adjacency pattern for the corresponding matrix row.\n\nThe matrix row for the degree of freedom $E_x(i,j,k)$ is coupled to the following unknowns:\n1.  **Couplings to the $E_x$ component:**\n    - From the discretization of $-\\frac{\\partial^2 E_x}{\\partial y^2}$: $E_x(i,j-1,k)$, $E_x(i,j,k)$, $E_x(i,j+1,k)$.\n    - From the discretization of $-\\frac{\\partial^2 E_x}{\\partial z^2}$: $E_x(i,j,k-1)$, $E_x(i,j,k)$, $E_x(i,j,k+1)$.\n    - From the $-k^2 E_x$ term: $E_x(i,j,k)$.\n    Combining these, the unknowns are $E_x(i,j,k)$ (the diagonal), $E_x(i,j-1,k)$, $E_x(i,j+1,k)$, $E_x(i,j,k-1)$, and $E_x(i,j,k+1)$.\n    This amounts to $5$ distinct couplings involving the $E_x$ component.\n\n2.  **Couplings to the $E_y$ component:**\n    - From the discretization of $\\frac{\\partial^2 E_y}{\\partial x \\partial y}$: $E_y(i+1,j+1,k)$, $E_y(i-1,j+1,k)$, $E_y(i+1,j-1,k)$, and $E_y(i-1,j-1,k)$.\n    This amounts to $4$ distinct couplings involving the $E_y$ component.\n\n3.  **Couplings to the $E_z$ component:**\n    - From the discretization of $\\frac{\\partial^2 E_z}{\\partial x \\partial z}$: $E_z(i+1,j,k+1)$, $E_z(i-1,j,k+1)$, $E_z(i+1,j,k-1)$, and $E_z(i-1,j,k-1)$.\n    This amounts to $4$ distinct couplings involving the $E_z$ component.\n\nThe number of nonzeros per row, denoted $\\text{nnz}$, is the total number of distinct couplings.\n$$ \\text{nnz} = (\\text{couplings to } E_x) + (\\text{couplings to } E_y) + (\\text{couplings to } E_z) $$\n$$ \\text{nnz} = 5 + 4 + 4 = 13 $$\n\nTo find the stencil width, $w$, we examine the grid offsets $(\\Delta i, \\Delta j, \\Delta k)$ for all coupled nodes relative to the central node $(i,j,k)$. The set of offsets is:\n- For $E_x$: $\\{(0,0,0), (0,1,0), (0,-1,0), (0,0,1), (0,0,-1)\\}$\n- For $E_y$: $\\{(1,1,0), (-1,1,0), (1,-1,0), (-1,-1,0)\\}$\n- For $E_z$: $\\{(1,0,1), (-1,0,1), (1,0,-1), (-1,0,-1)\\}$\n\nThe stencil width $w$ is the maximum Chebyshev distance over all these offsets:\n$w = \\max \\{ |\\Delta i|, |\\Delta j|, |\\Delta k| \\}$ for all $(\\Delta i, \\Delta j, \\Delta k)$ in the set of offsets.\nFor all offsets listed above, the maximum absolute value of any component is $1$. For example, for the offset $(1,1,0)$, the Chebyshev distance is $\\max\\{|1|,|1|,|0|\\} = 1$. For the offset $(0,0,-1)$, the distance is $\\max\\{|0|,|0|,|-1|\\} = 1$. The maximum over the entire set is therefore $1$.\n$$ w = 1 $$\nThe stencil width is $w=1$ and the number of nonzeros per row is $\\text{nnz}=13$.", "answer": "$$\\boxed{\\begin{pmatrix} 1  13 \\end{pmatrix}}$$", "id": "3329230"}, {"introduction": "Beyond general sparsity, many problems in electromagnetics exhibit even more specialized structures that can be exploited for tremendous computational advantage. This practice introduces the Toeplitz matrix, a structure that naturally arises from discretizing translation-invariant systems, such as wave propagation in a uniform medium. By deriving this matrix for a 1D problem and then analyzing its properties under periodic boundary conditions, you will discover its eigenvalues through Fourier analysis, a foundational step toward understanding powerful FFT-based solution methods [@problem_id:3329193].", "problem": "Consider the one-dimensional time-harmonic scalar Helmholtz operator on a uniform line, with constant wavenumber $k$ and a uniform grid spacing $h0$. Define the discrete unknowns $u_i \\approx u(x_i)$ on grid points $x_i = x_0 + i h$, and consider the linear differential operator $L u = -\\frac{d^2 u}{dx^2} + k^2 u$ acting on sufficiently smooth functions $u$. \n\n(a) Starting from the centered second-order finite-difference approximation for the second derivative and the uniform grid, construct the linear system $A \\mathbf{u} = \\mathbf{b}$ that results from discretizing $L u = f$ at interior nodes with homogeneous Dirichlet boundary conditions. Using only the uniformity of the grid and the constancy of the coefficients, determine and justify the qualitative matrix properties of $A$ in terms of density, bandwidth, symmetry, and Toeplitz structure.\n\n(b) In computational electromagnetics, convolution-type volume integral formulations for homogeneous backgrounds yield discrete linear systems whose entries depend only on grid-point separations, that is, $A_{ij} = w_{i-j}$ for some sequence $\\{w_m\\}$ determined by sampling a translation-invariant kernel. Explain, from first principles, why such a system is Toeplitz and when it is dense versus sparse.\n\n(c) Impose periodic boundary conditions on the discretization from part (a) so that the resulting matrix is circulant Toeplitz. Using discrete translational invariance and the fact that discrete complex exponentials are eigenvectors of circulant operators, derive the Fourier symbol $a(\\theta)$, defined as the eigenvalue associated with the discrete Fourier mode $u_i = \\exp(\\mathrm{i} \\theta i)$, with $\\theta \\in [0, 2\\pi)$. Express $a(\\theta)$ in closed form in terms of $\\alpha = (k h)^2$ and $\\theta$.\n\nGive your final answer as the single analytic expression for $a(\\theta)$. No rounding is required and no units are needed.", "solution": "The problem is validated as scientifically sound, well-posed, objective, and self-contained, with no identifiable flaws. We may proceed with the solution.\n\nThe problem is divided into three parts. We will address each in sequence.\n\n**(a) Finite-Difference Discretization with Homogeneous Dirichlet Boundary Conditions**\n\nThe given linear differential operator is $L u = -\\frac{d^2 u}{dx^2} + k^2 u$. We are asked to discretize the equation $L u = f$ on a uniform grid with spacing $h  0$. The grid points are $x_i = x_0 + i h$, and the discrete unknowns are $u_i \\approx u(x_i)$.\n\nWe use the centered second-order finite-difference approximation for the second derivative at an interior grid point $x_i$:\n$$\n\\frac{d^2 u}{dx^2}\\bigg|_{x_i} \\approx \\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\nSubstituting this into the differential equation $L u = f$ at the point $x_i$, we obtain the discrete equation:\n$$\n-\\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + k^2 u_i = f_i\n$$\nTo form the linear system $A \\mathbf{u} = \\mathbf{b}$, we multiply by $h^2$ and rearrange the terms:\n$$\n-(u_{i+1} - 2u_i + u_{i-1}) + (kh)^2 u_i = h^2 f_i\n$$\n$$\n-u_{i-1} + (2 + (kh)^2) u_i - u_{i+1} = h^2 f_i\n$$\nThis equation holds for the interior nodes of the domain. Let the domain be defined for $i \\in \\{0, 1, \\dots, N\\}$. The homogeneous Dirichlet boundary conditions imply $u_0 = 0$ and $u_N = 0$. The unknown vector $\\mathbf{u}$ consists of the values at the interior nodes, $\\mathbf{u} = [u_1, u_2, \\dots, u_{N-1}]^T$. The right-hand side vector is $\\mathbf{b} = h^2 [f_1, f_2, \\dots, f_{N-1}]^T$.\n\nThe linear system $A \\mathbf{u} = \\mathbf{b}$ has an $(N-1) \\times (N-1)$ matrix $A$. Let us write the equations for the first, a general interior, and the last node:\nFor $i=1$: $-u_0 + (2 + (kh)^2)u_1 - u_2 = h^2 f_1$. Since $u_0 = 0$, this becomes $(2 + (kh)^2)u_1 - u_2 = h^2 f_1$.\nFor $i \\in \\{2, \\dots, N-2\\}$: $-u_{i-1} + (2 + (kh)^2)u_i - u_{i+1} = h^2 f_i$.\nFor $i=N-1$: $-u_{N-2} + (2 + (kh)^2)u_{N-1} - u_N = h^2 f_{N-1}$. Since $u_N = 0$, this becomes $-u_{N-2} + (2 + (kh)^2)u_{N-1} = h^2 f_{N-1}$.\n\nThe resulting matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n2 + (kh)^2  -1  0  \\dots  0 \\\\\n-1  2 + (kh)^2  -1  \\ddots  \\vdots \\\\\n0  -1  \\ddots  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  2 + (kh)^2  -1 \\\\\n0  \\dots  0  -1  2 + (kh)^2\n\\end{pmatrix}\n$$\nNow we analyze the properties of $A$:\n1.  **Density**: The matrix $A$ has non-zero entries only on its main diagonal and the first sub-diagonal and super-diagonal. For an $M \\times M$ matrix where $M = N-1$, the number of non-zero entries is $M$ on the diagonal and $M-1$ on each of the two off-diagonals, totaling $3M-2$ non-zero entries. The total number of entries is $M^2$. The ratio of non-zero to total entries, $\\frac{3M-2}{M^2}$, approaches $0$ as $M \\to \\infty$. Therefore, the matrix is **sparse**.\n2.  **Bandwidth**: As established, the non-zero elements are confined to three central diagonals. Such a matrix is called **tridiagonal**. A tridiagonal matrix is a specific type of banded matrix with a half-bandwidth of $1$.\n3.  **Symmetry**: A matrix $A$ is symmetric if $A_{ij} = A_{ji}$ for all $i, j$. For our matrix, the diagonal elements are all $2 + (kh)^2$. The off-diagonal entries are $A_{i,i+1} = -1$ and $A_{i+1,i} = -1$. All other off-diagonal entries are $0$. Thus, $A_{ij} = A_{ji}$, and the matrix is **symmetric**.\n4.  **Toeplitz structure**: A matrix $T$ is a Toeplitz matrix if its entries are constant along each diagonal, i.e., $T_{ij} = t_{i-j}$ for some sequence $\\{t_k\\}$. In our matrix $A$, all elements on the main diagonal ($i-j=0$) are $2+(kh)^2$, all elements on the first super-diagonal ($i-j=-1$) are $-1$, and all elements on the first sub-diagonal ($i-j=1$) are $-1$. All other diagonals contain only zeros. This structure is consistent for all rows and columns. Thus, the matrix is a **Toeplitz matrix**.\n\n**(b) Convolution-Type Integral Equations**\n\nWe are given that a discrete linear system has matrix entries $A_{ij} = w_{i-j}$ for some sequence $\\{w_m\\}$.\n1.  **Toeplitz Structure**: The definition of a Toeplitz matrix is that the element at row $i$ and column $j$, denoted $A_{ij}$, depends only on the difference $i-j$. The given form $A_{ij} = w_{i-j}$ perfectly matches this definition. Therefore, such a matrix is, **by definition, a Toeplitz matrix**. This structure naturally arises from discretizing a convolution integral of the form $\\int K(x-y)u(y)dy = f(x)$, where the kernel $K$ is translation-invariant. The sequence $\\{w_m\\}$ represents the sampled values of this kernel. The matrix-vector product $A\\mathbf{u}$ represents a discrete convolution.\n\n2.  **Dense vs. Sparse**: The density of the matrix $A$ is determined by the properties of the sequence $\\{w_m\\}$, which in turn depend on the decay properties of the underlying physical kernel (e.g., a Green's function).\n    *   The matrix is **dense** if the kernel has a long-range influence, meaning it decays slowly. For example, kernels that decay polynomially, such as $1/r$ in three-dimensional space, result in a sequence $\\{w_m\\}$ where most elements are non-negligible in magnitude. Consequently, most entries $A_{ij} = w_{i-j}$ will be non-zero, leading to a dense matrix.\n    *   The matrix is **sparse** if the kernel has a short-range influence, meaning it has compact support or decays very rapidly (e.g., exponentially). In this case, the values $w_m$ will be effectively zero for $|m|$ greater than some small integer $M$. This implies that $A_{ij} = w_{i-j}$ will be zero for $|i-j|  M$. The resulting matrix is a banded matrix with a finite half-bandwidth $M$, which is a classic example of a sparse matrix.\n\n**(c) Periodic Boundary Conditions and Fourier Symbol**\n\nWe now modify the discretization from part (a) by imposing periodic boundary conditions on a grid of $N$ points, indexed $i = 0, 1, \\dots, N-1$. The periodicity implies $u_{i+N} = u_i$, so $u_N = u_0$ and $u_{-1} = u_{N-1}$. The discrete equation remains:\n$$\n-u_{i-1} + (2 + (kh)^2)u_i - u_{i+1} = h^2 f_i\n$$\nApplying this for $i=0, \\dots, N-1$ using the periodicity rules yields an $N \\times N$ matrix. For example, at $i=0$, the equation is $-u_{-1} + (2 + (kh)^2)u_0 - u_1 = h^2 f_0$, which becomes $-u_{N-1} + (2 + (kh)^2)u_0 - u_1 = h^2 f_0$ due to $u_{-1} = u_{N-1}$. This introduces a non-zero element in the top-right corner of the matrix. Similarly, the equation at $i=N-1$ introduces a non-zero element in the bottom-left corner. The resulting matrix, let's call it $A_p$, is:\n$$\nA_p = \\begin{pmatrix}\nd  -1  0  \\dots  -1 \\\\\n-1  d  -1   0 \\\\\n0  -1  d  \\ddots  \\vdots \\\\\n\\vdots   \\ddots  \\ddots  -1 \\\\\n-1  0  \\dots  -1  d\n\\end{pmatrix}\n$$\nwhere $d = 2 + (kh)^2$. This is a **circulant Toeplitz matrix**.\n\nWe are asked to find the Fourier symbol $a(\\theta)$, which is the eigenvalue corresponding to the discrete Fourier mode eigenvector $u_i = \\exp(\\mathrm{i} \\theta i)$. The eigenvalue equation is $(A_p \\mathbf{u})_i = a(\\theta) u_i$. Let's compute the $i$-th component of the left-hand side:\n$$\n(A_p \\mathbf{u})_i = -u_{i-1} + d u_i - u_{i+1}\n$$\nSubstitute $u_i = \\exp(\\mathrm{i} \\theta i)$:\n$$\n(A_p \\mathbf{u})_i = - \\exp(\\mathrm{i} \\theta (i-1)) + d \\exp(\\mathrm{i} \\theta i) - \\exp(\\mathrm{i} \\theta (i+1))\n$$\nFactor out the common term $\\exp(\\mathrm{i} \\theta i) = u_i$:\n$$\n(A_p \\mathbf{u})_i = \\left[ -\\exp(-\\mathrm{i} \\theta) + d - \\exp(\\mathrm{i} \\theta) \\right] \\exp(\\mathrm{i} \\theta i)\n$$\n$$\n(A_p \\mathbf{u})_i = \\left[ d - (\\exp(\\mathrm{i} \\theta) + \\exp(-\\mathrm{i} \\theta)) \\right] u_i\n$$\nUsing Euler's formula, $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i} \\theta) + \\exp(-\\mathrm{i} \\theta)}{2}$, we have $\\exp(\\mathrm{i} \\theta) + \\exp(-\\mathrm{i} \\theta) = 2\\cos(\\theta)$.\n$$\n(A_p \\mathbf{u})_i = [d - 2\\cos(\\theta)] u_i\n$$\nThe eigenvalue, or Fourier symbol $a(\\theta)$, is the expression in the brackets:\n$$\na(\\theta) = d - 2\\cos(\\theta)\n$$\nThe problem asks for this expression in terms of $\\alpha = (kh)^2$ and $\\theta$. We substitute $d = 2 + (kh)^2 = 2 + \\alpha$:\n$$\na(\\theta) = (2 + \\alpha) - 2\\cos(\\theta)\n$$\nThus, the final expression for the Fourier symbol is $a(\\theta) = 2 + \\alpha - 2\\cos(\\theta)$.", "answer": "$$\n\\boxed{2 + \\alpha - 2\\cos(\\theta)}\n$$", "id": "3329193"}]}