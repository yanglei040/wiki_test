{"hands_on_practices": [{"introduction": "Many critical cellular processes, such as receptor internalization and degradation, are not directly observable. This practice demonstrates a fundamental strategy for their quantification: using a mathematical model to devise an experiment that makes these hidden parameters identifiable. By preparing the system in two distinct initial states and measuring the resulting signal attenuation, you will derive a system of linear equations that can be inverted to solve for the individual rates of internalization ($k_{\\mathrm{int}}$) and degradation ($k_{\\mathrm{deg}}$) [@problem_id:3343816].", "problem": "A single-pass transmembrane receptor bound to ligand undergoes trafficking between two compartments: the plasma membrane and the endosomal/lysosomal interior. Let $S(t)$ denote the concentration of ligand-bound receptor complexes at the cell surface, and $I(t)$ denote the concentration of internalized ligand-bound receptor complexes. Over the time window of interest, assume recycling back to the surface and de novo receptor synthesis are negligible. Internalization occurs with first-order rate constant $k_{\\mathrm{int}}$, and degradation of internalized complexes occurs with first-order rate constant $k_{\\mathrm{deg}}$. The dynamics are governed by mass-action kinetics and can be written as ordinary differential equations (ODEs):\n$$\n\\frac{dS}{dt} = - k_{\\mathrm{int}} S, \\qquad \\frac{dI}{dt} = k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I.\n$$\nLigand-induced signaling activity is recorded as an instantaneous, linear readout\n$$\nY(t) = \\alpha\\, S(t) + \\beta\\, I(t),\n$$\nwhere $\\alpha$ and $\\beta$ are known per-complex signaling efficacies for the surface and internal compartments, respectively, with $\\alpha  \\beta$ reflecting attenuated signaling in the endosomal compartment.\n\nYou are asked to formalize a two-condition experiment that yields identifiable linear combinations of $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$, and then invert them to obtain the individual rates. In each condition $i \\in \\{A,B\\}$, the system is prepared to a distinct distribution $(S_i, I_i)$, measured by acid-wash quantification of surface-accessible complexes and protected (internal) complexes. Immediately thereafter, the instantaneous signaling attenuation rate\n$$\nr_i \\equiv -\\frac{1}{Y_i}\\left.\\frac{dY}{dt}\\right|_{t_i}\n$$\nis computed from the measured slope $\\left.\\frac{dY}{dt}\\right|_{t_i}$ and the value $Y_i = \\alpha S_i + \\beta I_i$ at that same time point. Under the stated assumptions, show that $r_i$ can be expressed as a linear combination $r_i = w_{1,i}\\, k_{\\mathrm{int}} + w_{2,i}\\, k_{\\mathrm{deg}}$, where $w_{1,i}$ and $w_{2,i}$ depend only on $(\\alpha,\\beta,S_i,I_i)$, and derive the algebraic inversion formulas to obtain $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$ from $(r_A,r_B)$.\n\nThen, using the numerical data below, compute $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$:\n- Known signaling efficacies: $\\alpha = 1.0$ (arbitrary units per complex), $\\beta = 0.5$ (arbitrary units per complex).\n- Condition $A$: $S_A = 0.60$ (nanomolar), $I_A = 0.40$ (nanomolar), and $\\left.\\frac{dY}{dt}\\right|_{t_A} = -0.28$ (arbitrary units per minute).\n- Condition $B$: $S_B = 0.30$ (nanomolar), $I_B = 0.70$ (nanomolar), and $\\left.\\frac{dY}{dt}\\right|_{t_B} = -0.19$ (arbitrary units per minute).\n\nExpress both $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$ in $\\mathrm{min}^{-1}$ and round your answers to four significant figures. Provide the two numbers as a single row matrix in the final answer.", "solution": "The problem statement is a valid exercise in parameter identification for a system of ordinary differential equations (ODEs) modeling receptor trafficking and signaling, a common topic in computational systems biology. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution.\n\nFirst, we will formalize the relationship between the measurable signaling attenuation rate, $r_i$, and the unknown kinetic parameters, $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$. The signaling output is given as a linear combination of the surface and internal receptor complex concentrations, $S(t)$ and $I(t)$, respectively:\n$$\nY(t) = \\alpha S(t) + \\beta I(t)\n$$\nwhere $\\alpha$ and $\\beta$ are the per-complex signaling efficacies.\n\nTo find the rate of change of the signal, $\\frac{dY}{dt}$, we differentiate $Y(t)$ with respect to time $t$ using the chain rule:\n$$\n\\frac{dY}{dt} = \\alpha \\frac{dS}{dt} + \\beta \\frac{dI}{dt}\n$$\nThe problem provides the ODEs governing the dynamics of $S(t)$ and $I(t)$:\n$$\n\\frac{dS}{dt} = -k_{\\mathrm{int}} S, \\qquad \\frac{dI}{dt} = k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I\n$$\nSubstituting these expressions into the equation for $\\frac{dY}{dt}$ yields:\n$$\n\\frac{dY}{dt} = \\alpha (-k_{\\mathrm{int}} S) + \\beta (k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I)\n$$\nWe can rearrange this expression by grouping terms associated with $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$:\n$$\n\\frac{dY}{dt} = (\\beta S - \\alpha S)k_{\\mathrm{int}} - (\\beta I)k_{\\mathrm{deg}}\n$$\n$$\n\\frac{dY}{dt} = -(\\alpha - \\beta) S k_{\\mathrm{int}} - \\beta I k_{\\mathrm{deg}}\n$$\nThe instantaneous signaling attenuation rate, $r_i$, is defined at a specific time point $t_i$ where the state of the system is $(S_i, I_i)$. The definition is:\n$$\nr_i \\equiv -\\frac{1}{Y_i}\\left.\\frac{dY}{dt}\\right|_{t_i}\n$$\nwhere $Y_i = \\alpha S_i + \\beta I_i$, and $\\left.\\frac{dY}{dt}\\right|_{t_i}$ is the value of the time derivative at that state. Substituting our expression for the derivative gives:\n$$\nr_i = -\\frac{1}{\\alpha S_i + \\beta I_i} \\left[ -(\\alpha - \\beta) S_i k_{\\mathrm{int}} - \\beta I_i k_{\\mathrm{deg}} \\right]\n$$\nSimplifying this expression, we obtain the desired linear form:\n$$\nr_i = \\left( \\frac{(\\alpha - \\beta) S_i}{\\alpha S_i + \\beta I_i} \\right) k_{\\mathrm{int}} + \\left( \\frac{\\beta I_i}{\\alpha S_i + \\beta I_i} \\right) k_{\\mathrm{deg}}\n$$\nThis equation is in the form $r_i = w_{1,i} k_{\\mathrm{int}} + w_{2,i} k_{\\mathrm{deg}}$, where the weights $w_{1,i}$ and $w_{2,i}$ are given by:\n$$\nw_{1,i} = \\frac{(\\alpha - \\beta) S_i}{\\alpha S_i + \\beta I_i}, \\qquad w_{2,i} = \\frac{\\beta I_i}{\\alpha S_i + \\beta I_i}\n$$\nAs required, these weights depend only on the known parameters $(\\alpha, \\beta)$ and the measured state $(S_i, I_i)$.\n\nNext, we derive the algebraic inversion formulas. The two-condition experiment provides a system of two linear equations in the two unknowns, $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$:\n$$\n\\begin{cases} r_A = w_{1,A} k_{\\mathrm{int}} + w_{2,A} k_{\\mathrm{deg}} \\\\ r_B = w_{1,B} k_{\\mathrm{int}} + w_{2,B} k_{\\mathrm{deg}} \\end{cases}\n$$\nThis system can be written in matrix form as $R = W K$, where:\n$$\nR = \\begin{pmatrix} r_A \\\\ r_B \\end{pmatrix}, \\quad W = \\begin{pmatrix} w_{1,A}  w_{2,A} \\\\ w_{1,B}  w_{2,B} \\end{pmatrix}, \\quad K = \\begin{pmatrix} k_{\\mathrm{int}} \\\\ k_{\\mathrm{deg}} \\end{pmatrix}\n$$\nThe solution for $K$ is obtained by inverting the matrix $W$: $K = W^{-1}R$. The inverse of the $2 \\times 2$ matrix $W$ is:\n$$\nW^{-1} = \\frac{1}{\\det(W)} \\begin{pmatrix} w_{2,B}  -w_{2,A} \\\\ -w_{1,B}  w_{1,A} \\end{pmatrix}\n$$\nwhere the determinant is $\\det(W) = w_{1,A} w_{2,B} - w_{2,A} w_{1,B}$. The solution for the individual rate constants is then given by Cramer's rule:\n$$\nk_{\\mathrm{int}} = \\frac{w_{2,B} r_A - w_{2,A} r_B}{w_{1,A} w_{2,B} - w_{2,A} w_{1,B}}\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{w_{1,A} r_B - w_{1,B} r_A}{w_{1,A} w_{2,B} - w_{2,A} w_{1,B}}\n$$\nA unique solution exists if and only if $\\det(W) \\neq 0$. Substituting the expressions for the weights, we find that $\\det(W) = \\frac{\\beta(\\alpha-\\beta)(S_A I_B - I_A S_B)}{(\\alpha S_A + \\beta I_A)(\\alpha S_B + \\beta I_B)}$. Given $\\alpha  \\beta$ and $\\beta  0$, this requires $S_A I_B - I_A S_B \\neq 0$, or equivalently $\\frac{S_A}{I_A} \\neq \\frac{S_B}{I_B}$. The two experimental conditions must correspond to different ratios of surface to internal complexes.\n\nNow, we apply these formulas to the provided numerical data.\nThe parameters are $\\alpha = 1.0$ and $\\beta = 0.5$.\n\nFor Condition A: $S_A = 0.60$, $I_A = 0.40$, and $\\left.\\frac{dY}{dt}\\right|_{t_A} = -0.28$.\nFirst, calculate the total signal $Y_A$ and the attenuation rate $r_A$:\n$$\nY_A = \\alpha S_A + \\beta I_A = (1.0)(0.60) + (0.5)(0.40) = 0.60 + 0.20 = 0.80\n$$\n$$\nr_A = -\\frac{1}{Y_A} \\left.\\frac{dY}{dt}\\right|_{t_A} = -\\frac{1}{0.80}(-0.28) = \\frac{0.28}{0.80} = 0.35\n$$\nNext, calculate the weights $w_{1,A}$ and $w_{2,A}$:\n$$\nw_{1,A} = \\frac{(\\alpha - \\beta) S_A}{Y_A} = \\frac{(1.0 - 0.5)(0.60)}{0.80} = \\frac{0.30}{0.80} = \\frac{3}{8} = 0.375\n$$\n$$\nw_{2,A} = \\frac{\\beta I_A}{Y_A} = \\frac{(0.5)(0.40)}{0.80} = \\frac{0.20}{0.80} = \\frac{1}{4} = 0.25\n$$\n\nFor Condition B: $S_B = 0.30$, $I_B = 0.70$, and $\\left.\\frac{dY}{dt}\\right|_{t_B} = -0.19$.\nCalculate $Y_B$ and $r_B$:\n$$\nY_B = \\alpha S_B + \\beta I_B = (1.0)(0.30) + (0.5)(0.70) = 0.30 + 0.35 = 0.65\n$$\n$$\nr_B = -\\frac{1}{Y_B} \\left.\\frac{dY}{dt}\\right|_{t_B} = -\\frac{1}{0.65}(-0.19) = \\frac{0.19}{0.65} = \\frac{19}{65}\n$$\nCalculate the weights $w_{1,B}$ and $w_{2,B}$:\n$$\nw_{1,B} = \\frac{(\\alpha - \\beta) S_B}{Y_B} = \\frac{(0.5)(0.30)}{0.65} = \\frac{0.15}{0.65} = \\frac{15}{65} = \\frac{3}{13}\n$$\n$$\nw_{2,B} = \\frac{\\beta I_B}{Y_B} = \\frac{(0.5)(0.70)}{0.65} = \\frac{0.35}{0.65} = \\frac{35}{65} = \\frac{7}{13}\n$$\n\nThe ratio condition is satisfied: $\\frac{S_A}{I_A} = \\frac{0.60}{0.40} = 1.5$ and $\\frac{S_B}{I_B} = \\frac{0.30}{0.70} \\approx 0.4286$.\n\nNow, we solve for $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$. First, compute the determinant of the weight matrix:\n$$\n\\det(W) = w_{1,A} w_{2,B} - w_{2,A} w_{1,B} = \\left(\\frac{3}{8}\\right)\\left(\\frac{7}{13}\\right) - \\left(\\frac{1}{4}\\right)\\left(\\frac{3}{13}\\right) = \\frac{21}{104} - \\frac{3 \\cdot 2}{52 \\cdot 2} = \\frac{21 - 6}{104} = \\frac{15}{104}\n$$\nUsing the inversion formulas:\n$$\nk_{\\mathrm{int}} = \\frac{w_{2,B} r_A - w_{2,A} r_B}{\\det(W)} = \\frac{(\\frac{7}{13})(0.35) - (\\frac{1}{4})(\\frac{19}{65})}{15/104} = \\frac{(\\frac{7}{13})(\\frac{7}{20}) - \\frac{19}{260}}{15/104} = \\frac{\\frac{49}{260} - \\frac{19}{260}}{15/104} = \\frac{30/260}{15/104} = \\frac{3/26}{15/104}\n$$\n$$\nk_{\\mathrm{int}} = \\frac{3}{26} \\times \\frac{104}{15} = \\frac{3}{15} \\times \\frac{104}{26} = \\frac{1}{5} \\times 4 = \\frac{4}{5} = 0.8\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{w_{1,A} r_B - w_{1,B} r_A}{\\det(W)} = \\frac{(\\frac{3}{8})(\\frac{19}{65}) - (\\frac{3}{13})(0.35)}{15/104} = \\frac{\\frac{57}{520} - (\\frac{3}{13})(\\frac{7}{20})}{15/104} = \\frac{\\frac{57}{520} - \\frac{21}{260}}{15/104} = \\frac{\\frac{57-42}{520}}{15/104} = \\frac{15/520}{15/104}\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{15}{520} \\times \\frac{104}{15} = \\frac{104}{520} = \\frac{1}{5} = 0.2\n$$\nThe units of the rates $r_i$ are $(\\text{signal units} \\cdot \\mathrm{min}^{-1}) / (\\text{signal units}) = \\mathrm{min}^{-1}$. Since the weights $w$ are dimensionless, the units of $k_{\\mathrm{int}}$ and $k_{\\mathrm{deg}}$ must be $\\mathrm{min}^{-1}$.\n\nThe calculated values are $k_{\\mathrm{int}} = 0.8 \\, \\mathrm{min}^{-1}$ and $k_{\\mathrm{deg}} = 0.2 \\, \\mathrm{min}^{-1}$. Rounding to four significant figures gives $0.8000$ and $0.2000$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8000  0.2000\n\\end{pmatrix}\n}\n$$", "id": "3343816"}, {"introduction": "While the previous exercise demonstrated a case of perfect parameter identifiability, more realistic models often exhibit a property known as \"sloppiness,\" where different combinations of parameters produce nearly identical outputs. This exercise delves into this critical concept by analyzing how changes in the internalization rate ($k_{\\mathrm{int}}$) can be compensated by changes in the recycling rate ($k_{\\mathrm{rec}}$) to maintain a constant steady-state signal [@problem_id:3343898]. By deriving the mathematical constraint that defines this compensation, you will gain a deeper understanding of the structural properties that make parameter estimation a non-trivial challenge.", "problem": "A single-cell receptor system is stimulated by a constant extracellular ligand at concentration $L$ and signals through the surface ligand-bound receptor population. Consider a trafficking model with the following compartments: surface unbound receptors $R_{s}$, surface ligand-bound receptors $R_{\\ell}$, and internalized receptors $R_{i}$. The following assumptions hold:\n- Constant ligand concentration $L$ and mass-action binding with association rate $k_{\\mathrm{on}}$ and dissociation rate $k_{\\mathrm{off}}$ govern the interconversion between $R_{s}$ and $R_{\\ell}$.\n- Only $R_{\\ell}$ internalizes at rate $k_{\\mathrm{int}}$.\n- Internalized receptors $R_{i}$ either recycle to the surface as $R_{s}$ at rate $k_{\\mathrm{rec}}$ or are degraded at rate $k_{\\mathrm{deg}}$.\n- Surface receptors (both $R_{s}$ and $R_{\\ell}$) are lost by surface degradation at rate $k_{\\mathrm{sdeg}}$.\n- New receptors are synthesized at a constant rate $k_{\\mathrm{syn}}$ directly into the $R_{s}$ pool.\n\nUnder these assumptions, the receptor pools obey the ordinary differential equations (ODE, ordinary differential equation):\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}R_{s}}{\\mathrm{d}t} = k_{\\mathrm{syn}} + k_{\\mathrm{rec}} R_{i} - k_{\\mathrm{on}} L R_{s} + k_{\\mathrm{off}} R_{\\ell} - k_{\\mathrm{sdeg}} R_{s} \\\\\n\\frac{\\mathrm{d}R_{\\ell}}{\\mathrm{d}t} = k_{\\mathrm{on}} L R_{s} - k_{\\mathrm{off}} R_{\\ell} - k_{\\mathrm{int}} R_{\\ell} - k_{\\mathrm{sdeg}} R_{\\ell} \\\\\n\\frac{\\mathrm{d}R_{i}}{\\mathrm{d}t} = k_{\\mathrm{int}} R_{\\ell} - (k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) R_{i}\n\\end{aligned}\n$$\n\nDefine the steady-state signaling output to be proportional to the steady-state surface ligand-bound receptor level $R_{\\ell}^{\\ast}$; preserving signaling output means holding $R_{\\ell}^{\\ast}$ fixed at the value achieved by a nominal parameter set. All parameters other than $k_{\\mathrm{int}}$ and $k_{\\mathrm{rec}}$ are held fixed.\n\nUsing fundamental mass-action kinetics and steady-state flux balance, derive the steady-state expression for $R_{\\ell}^{\\ast}$ as a function of the parameters. Then, by enforcing that $R_{\\ell}^{\\ast}$ remains constant while varying $k_{\\mathrm{int}}$ and $k_{\\mathrm{rec}}$, derive the implicit constraint that defines the compensation manifold in the $(k_{\\mathrm{int}}, k_{\\mathrm{rec}})$-plane. Finally, compute the local slope $\\mathrm{d}k_{\\mathrm{rec}}/\\mathrm{d}k_{\\mathrm{int}}$ of this manifold at the nominal parameter values given below, with all other parameters fixed.\n\nNominal parameter values and units:\n- $k_{\\mathrm{on}} \\;=\\; 5.0 \\times 10^{-3}$ $\\mathrm{nM}^{-1}\\,\\mathrm{min}^{-1}$,\n- $k_{\\mathrm{off}} \\;=\\; 0.10$ $\\mathrm{min}^{-1}$,\n- $L \\;=\\; 50$ $\\mathrm{nM}$,\n- $k_{\\mathrm{int}} \\;=\\; 0.050$ $\\mathrm{min}^{-1}$,\n- $k_{\\mathrm{rec}} \\;=\\; 0.020$ $\\mathrm{min}^{-1}$,\n- $k_{\\mathrm{deg}} \\;=\\; 0.010$ $\\mathrm{min}^{-1}$,\n- $k_{\\mathrm{sdeg}} \\;=\\; 0.0020$ $\\mathrm{min}^{-1}$,\n- $k_{\\mathrm{syn}} \\;=\\; 100$ $\\mathrm{nM}\\,\\mathrm{min}^{-1}$.\n\nReport the numerical value of the slope $\\mathrm{d}k_{\\mathrm{rec}}/\\mathrm{d}k_{\\mathrm{int}}$ at the nominal point. Round your answer to four significant figures. The slope is dimensionless; report your answer without units.", "solution": "We begin from steady-state mass-action balances, setting all time derivatives to zero. The internalized pool at steady state satisfies\n$$\n0 \\;=\\; k_{\\mathrm{int}} R_{\\ell}^{\\ast} \\;-\\; (k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) R_{i}^{\\ast} \\;\\;\\Longrightarrow\\;\\; R_{i}^{\\ast} \\;=\\; \\frac{k_{\\mathrm{int}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}} \\, R_{\\ell}^{\\ast}.\n$$\nThe surface-bound pool at steady state satisfies\n$$\n0 \\;=\\; k_{\\mathrm{on}} L R_{s}^{\\ast} \\;-\\; (k_{\\mathrm{off}} + k_{\\mathrm{int}} + k_{\\mathrm{sdeg}}) R_{\\ell}^{\\ast} \\;\\;\\Longrightarrow\\;\\; R_{s}^{\\ast} \\;=\\; \\frac{k_{\\mathrm{off}} + k_{\\mathrm{int}} + k_{\\mathrm{sdeg}}}{k_{\\mathrm{on}} L} \\, R_{\\ell}^{\\ast}.\n$$\nSubstitute these relationships into the steady-state balance for $R_{s}$:\n$$\n0 \\;=\\; k_{\\mathrm{syn}} \\;+\\; k_{\\mathrm{rec}} R_{i}^{\\ast} \\;-\\; k_{\\mathrm{on}} L R_{s}^{\\ast} \\;+\\; k_{\\mathrm{off}} R_{\\ell}^{\\ast} \\;-\\; k_{\\mathrm{sdeg}} R_{s}^{\\ast}.\n$$\nUsing $R_{i}^{\\ast}$ and $R_{s}^{\\ast}$ expressed in terms of $R_{\\ell}^{\\ast}$:\n$$\n0 \\;=\\; k_{\\mathrm{syn}} \\;+\\; k_{\\mathrm{rec}} \\left(\\frac{k_{\\mathrm{int}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}}\\right) R_{\\ell}^{\\ast} \\;-\\; k_{\\mathrm{on}} L \\left(\\frac{k_{\\mathrm{off}} + k_{\\mathrm{int}} + k_{\\mathrm{sdeg}}}{k_{\\mathrm{on}} L}\\right) R_{\\ell}^{\\ast} \\;+\\; k_{\\mathrm{off}} R_{\\ell}^{\\ast} \\;-\\; k_{\\mathrm{sdeg}} \\left(\\frac{k_{\\mathrm{off}} + k_{\\mathrm{int}} + k_{\\mathrm{sdeg}}}{k_{\\mathrm{on}} L}\\right) R_{\\ell}^{\\ast}.\n$$\nCanceling terms and collecting like terms gives\n$$\n0 \\;=\\; k_{\\mathrm{syn}} \\;+\\; \\left[\\frac{k_{\\mathrm{rec}}\\,k_{\\mathrm{int}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}} \\;-\\; (k_{\\mathrm{int}} + k_{\\mathrm{sdeg}}) \\;-\\; \\frac{k_{\\mathrm{sdeg}}(k_{\\mathrm{off}} + k_{\\mathrm{int}} + k_{\\mathrm{sdeg}})}{k_{\\mathrm{on}} L}\\right] R_{\\ell}^{\\ast}.\n$$\nTherefore,\n$$\nR_{\\ell}^{\\ast} \\;=\\; \\frac{k_{\\mathrm{syn}}}{D(k_{\\mathrm{int}}, k_{\\mathrm{rec}})},\n$$\nwhere\n$$\nD(k_{\\mathrm{int}}, k_{\\mathrm{rec}}) \\;=\\; (k_{\\mathrm{int}} + k_{\\mathrm{sdeg}}) \\;+\\; \\frac{k_{\\mathrm{sdeg}}(k_{\\mathrm{off}} + k_{\\mathrm{int}} + k_{\\mathrm{sdeg}})}{k_{\\mathrm{on}} L} \\;-\\; \\frac{k_{\\mathrm{rec}}\\,k_{\\mathrm{int}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}}.\n$$\nTo preserve signaling output, we require $R_{\\ell}^{\\ast}$ to remain constant as $k_{\\mathrm{int}}$ and $k_{\\mathrm{rec}}$ vary, with all other parameters fixed. Since $k_{\\mathrm{syn}}$ is fixed, this is equivalent to holding $D(k_{\\mathrm{int}}, k_{\\mathrm{rec}})$ constant along the compensation manifold. Define the constant\n$$\nA \\;=\\; 1 \\;+\\; \\frac{k_{\\mathrm{sdeg}}}{k_{\\mathrm{on}} L},\n$$\nand\n$$\nC_{0} \\;=\\; k_{\\mathrm{sdeg}} \\;+\\; \\frac{k_{\\mathrm{sdeg}}(k_{\\mathrm{off}} + k_{\\mathrm{sdeg}})}{k_{\\mathrm{on}} L}.\n$$\nThen $D$ can be written as\n$$\nD(k_{\\mathrm{int}}, k_{\\mathrm{rec}}) \\;=\\; A\\,k_{\\mathrm{int}} \\;+\\; C_{0} \\;-\\; \\frac{k_{\\mathrm{rec}}\\,k_{\\mathrm{int}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}}.\n$$\nThus, along the compensation manifold,\n$$\nF(k_{\\mathrm{int}}, k_{\\mathrm{rec}}) \\;\\equiv\\; A\\,k_{\\mathrm{int}} \\;-\\; \\frac{k_{\\mathrm{rec}}\\,k_{\\mathrm{int}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}} \\;=\\; D^{\\ast} \\;-\\; C_{0} \\;\\;\\text{(constant)}.\n$$\nImplicit differentiation of $F(k_{\\mathrm{int}}, k_{\\mathrm{rec}})$ at fixed value yields the local slope:\n$$\n\\frac{\\mathrm{d}k_{\\mathrm{rec}}}{\\mathrm{d}k_{\\mathrm{int}}} \\;=\\; -\\,\\frac{\\partial F/\\partial k_{\\mathrm{int}}}{\\partial F/\\partial k_{\\mathrm{rec}}}.\n$$\nCompute the partial derivatives:\n$$\n\\frac{\\partial F}{\\partial k_{\\mathrm{int}}} \\;=\\; A \\;-\\; \\frac{k_{\\mathrm{rec}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}},\n$$\n$$\n\\frac{\\partial F}{\\partial k_{\\mathrm{rec}}} \\;=\\; k_{\\mathrm{int}} \\cdot \\frac{\\partial}{\\partial k_{\\mathrm{rec}}}\\!\\left(-\\,\\frac{k_{\\mathrm{rec}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}}\\right) \\;=\\; k_{\\mathrm{int}} \\left(-\\,\\frac{k_{\\mathrm{deg}}}{(k_{\\mathrm{rec}} + k_{\\mathrm{deg}})^{2}}\\right).\n$$\nTherefore,\n$$\n\\frac{\\mathrm{d}k_{\\mathrm{rec}}}{\\mathrm{d}k_{\\mathrm{int}}} \\;=\\; \\left(A \\;-\\; \\frac{k_{\\mathrm{rec}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}}\\right)\\,\\frac{(k_{\\mathrm{rec}} + k_{\\mathrm{deg}})^{2}}{k_{\\mathrm{int}}\\,k_{\\mathrm{deg}}}.\n$$\nEvaluate at the nominal parameter values. First compute $A$:\n$$\nA \\;=\\; 1 \\;+\\; \\frac{k_{\\mathrm{sdeg}}}{k_{\\mathrm{on}} L} \\;=\\; 1 \\;+\\; \\frac{0.0020}{(5.0 \\times 10^{-3})\\cdot 50} \\;=\\; 1 \\;+\\; \\frac{0.0020}{0.25} \\;=\\; 1.008.\n$$\nNext compute the fraction\n$$\n\\frac{k_{\\mathrm{rec}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}} \\;=\\; \\frac{0.020}{0.020 + 0.010} \\;=\\; \\frac{0.020}{0.030} \\;=\\; \\frac{2}{3} \\;=\\; 0.666666\\ldots\n$$\nThus,\n$$\nA \\;-\\; \\frac{k_{\\mathrm{rec}}}{k_{\\mathrm{rec}} + k_{\\mathrm{deg}}} \\;=\\; 1.008 \\;-\\; 0.666666\\ldots \\;=\\; 0.341333\\ldots\n$$\nCompute the remaining factors:\n$$\nk_{\\mathrm{rec}} + k_{\\mathrm{deg}} \\;=\\; 0.030,\\quad (k_{\\mathrm{rec}} + k_{\\mathrm{deg}})^{2} \\;=\\; 0.0009,\n$$\n$$\nk_{\\mathrm{int}}\\,k_{\\mathrm{deg}} \\;=\\; 0.050 \\times 0.010 \\;=\\; 0.0005.\n$$\nPutting these together,\n$$\n\\frac{\\mathrm{d}k_{\\mathrm{rec}}}{\\mathrm{d}k_{\\mathrm{int}}} \\;=\\; 0.341333\\ldots \\times \\frac{0.0009}{0.0005} \\;=\\; 0.341333\\ldots \\times 1.8 \\;=\\; 0.6144\\ldots\n$$\nRounded to four significant figures, the slope is $0.6144$. This positive slope quantifies parameter compensation: an increase in $k_{\\mathrm{int}}$ can be offset by an increase in $k_{\\mathrm{rec}}$ along the manifold that preserves $R_{\\ell}^{\\ast}$.", "answer": "$$\\boxed{0.6144}$$", "id": "3343898"}, {"introduction": "The ultimate goal of a modeler is not just to analyze existing data, but to guide future experiments to be maximally informative. This practice introduces the powerful framework of Optimal Experimental Design (OED), using the Fisher Information Matrix (FIM) to quantify the precision with which parameters can be estimated from a proposed experiment [@problem_id:3343891]. You will implement a D-optimal design strategy, systematically searching for the combination of sampling times and ligand doses that maximizes the FIM's determinant, thereby ensuring the most reliable estimation of the trafficking parameters $k_{\\mathrm{int}}$ and $k_{\\mathrm{rec}}$.", "problem": "Consider a receptor trafficking experiment in which a population of cell-surface receptors is exposed at time $t=0$ to a constant extracellular ligand concentration. A minimal, well-tested receptor trafficking model with binding-dependent endocytosis and recycling is as follows. Let $S(t)$ denote the number of receptors at the cell surface and $I(t)$ denote the number of internalized receptors. Assume total receptor conservation $R_{\\text{tot}} = S(t) + I(t)$ (no synthesis or degradation on the experimental timescale), a constant ligand concentration $L$ per replicate well, and mass-action binding at quasi-equilibrium with dissociation constant $K_D$. Internalization is proportional to the ligand-bound surface fraction. The dynamics are:\n$$\n\\frac{dS}{dt} = k_{\\text{rec}}\\,I - k_{\\text{int}}\\,S\\,\\frac{L}{K_D + L}, \\quad\n\\frac{dI}{dt} = k_{\\text{int}}\\,S\\,\\frac{L}{K_D + L} - k_{\\text{rec}}\\,I,\n$$\nwith initial condition $S(0)=R_{\\text{tot}}$ and $I(0)=0$. Here $k_{\\text{int}}$ is the internalization rate constant (units: $\\text{min}^{-1}$) and $k_{\\text{rec}}$ is the recycling rate constant (units: $\\text{min}^{-1}$). The ligand concentration $L$ is in nanomolar (units: $\\text{nM}$), and time $t$ is in minutes (units: $\\text{min}$).\n\nMeasurements are made by sampling replicate wells at specified times. For a sample taken at time $t_j$ from a well that has been exposed to a constant dose $L_j$ since $t=0$, the measured quantity (for example, normalized surface receptor abundance) is modeled as\n$$\ny_j = \\frac{S(t_j)}{R_{\\text{tot}}} + \\varepsilon_j,\n$$\nwhere $\\varepsilon_j$ are independent, identically distributed Gaussian noise terms with zero mean and variance $\\sigma^2$ (units: dimensionless squared). Under the assumption of Gaussian measurement noise, the Fisher Information Matrix (FIM) quantifies the information about parameters $k_{\\text{int}}$ and $k_{\\text{rec}}$ contained in the measurements.\n\nYour task is to write a program that, for each test case described below, selects a set of $n$ distinct sampling times $\\{t_1,\\dots,t_n\\}$ from a provided time grid and, independently for each selected time, selects a ligand dose $L_j$ from a provided dose set, so as to maximize the determinant of the Fisher Information Matrix (FIM) for the parameter vector $(k_{\\text{int}}, k_{\\text{rec}})$ under the above model and noise assumption. The program must evaluate all admissible designs that satisfy the constraints, compute the determinant of the FIM for each design, and return the design that maximizes the determinant. If multiple designs achieve the same maximal determinant, you may return any one of them.\n\nFundamental base and assumptions to be used:\n- Receptor trafficking follows the above linear two-compartment model.\n- Binding equilibrium fraction is $\\frac{L}{K_D + L}$.\n- Measurement noise is Gaussian and independent with variance $\\sigma^2$.\n- The Fisher Information Matrix (FIM) for parameters under Gaussian noise aggregates the sensitivity of the measurement with respect to parameters across samples.\n\nDesign constraints:\n- Sampling times must be chosen as $n$ distinct elements from the provided discrete time grid (no duplicates; order is irrelevant). Times are in minutes and must be expressed in minutes.\n- For each chosen sampling time $t_j$, a single dose $L_j$ must be selected from the provided discrete dose set. Doses are in nanomolar and must be expressed in nanomolar.\n- The dose is constant in each replicate well from $t=0$ until the sampling time $t_j$.\n\nOutput requirements:\n- For each test case, output a list of the form $[d^{\\ast}, [t_1,\\dots,t_n], [L_1,\\dots,L_n]]$, where $d^{\\ast}$ is the maximal determinant of the Fisher Information Matrix (FIM) found for that test case (rounded to six decimal places), $[t_1,\\dots,t_n]$ is the chosen set of sampling times in minutes, and $[L_1,\\dots,L_n]$ is the corresponding set of doses in nanomolar for those times.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[[d^{\\ast}_1,[\\dots],[\\dots]],[d^{\\ast}_2,[\\dots],[\\dots]],\\dots]$.\n- All times must be expressed in minutes, and all doses must be in nanomolar. Numerical outputs must be floats or lists of floats; do not include unit symbols in the output.\n\nTest suite:\n- Test case $1$ (general case; moderate internalization and recycling):\n    - $R_{\\text{tot}} = 1.0$\n    - $K_D = 10.0$ $\\text{nM}$\n    - $\\sigma = 0.05$\n    - $k_{\\text{int}} = 0.2$ $\\text{min}^{-1}$\n    - $k_{\\text{rec}} = 0.1$ $\\text{min}^{-1}$\n    - $n = 3$\n    - Time grid (minutes): $\\{1.0, 3.0, 5.0, 10.0, 20.0, 30.0\\}$\n    - Dose set (nanomolar): $\\{0.1, 1.0, 10.0, 100.0\\}$\n- Test case $2$ (slow recycling regime):\n    - $R_{\\text{tot}} = 1.0$\n    - $K_D = 10.0$ $\\text{nM}$\n    - $\\sigma = 0.05$\n    - $k_{\\text{int}} = 0.2$ $\\text{min}^{-1}$\n    - $k_{\\text{rec}} = 0.01$ $\\text{min}^{-1}$\n    - $n = 3$\n    - Time grid (minutes): $\\{2.0, 4.0, 8.0, 16.0, 32.0\\}$\n    - Dose set (nanomolar): $\\{0.5, 5.0, 50.0\\}$\n- Test case $3$ (weak internalization; higher noise; includes zero dose option):\n    - $R_{\\text{tot}} = 1.0$\n    - $K_D = 10.0$ $\\text{nM}$\n    - $\\sigma = 0.1$\n    - $k_{\\text{int}} = 0.005$ $\\text{min}^{-1}$\n    - $k_{\\text{rec}} = 0.05$ $\\text{min}^{-1}$\n    - $n = 3$\n    - Time grid (minutes): $\\{5.0, 10.0, 20.0, 40.0\\}$\n    - Dose set (nanomolar): $\\{0.0, 0.5, 5.0, 50.0\\}$\n- Test case $4$ (boundary case; very early sampling and near-zero dose option):\n    - $R_{\\text{tot}} = 1.0$\n    - $K_D = 1.0$ $\\text{nM}$\n    - $\\sigma = 0.02$\n    - $k_{\\text{int}} = 0.05$ $\\text{min}^{-1}$\n    - $k_{\\text{rec}} = 0.05$ $\\text{min}^{-1}$\n    - $n = 2$\n    - Time grid (minutes): $\\{0.5, 1.0, 2.0, 4.0\\}$\n    - Dose set (nanomolar): $\\{0.0, 0.001, 1.0\\}$\n\nYour program must solve each test case independently and print a single line of output with the four results in order, as a comma-separated list enclosed in square brackets, where each result is of the form specified above: $[d^{\\ast}, [t_1,\\dots,t_n], [L_1,\\dots,L_n]]$.", "solution": "The user-provided problem statement has been meticulously validated and is deemed **valid**. It is scientifically grounded in the principles of chemical kinetics and statistical inference, well-posed as a discrete optimization problem, and its parameters are within a scientifically plausible range. We may, therefore, proceed with the derivation and solution.\n\nThe objective is to determine an optimal experimental design for estimating the parameters $\\theta = (k_{\\text{int}}, k_{\\text{rec}})$ of a receptor trafficking model. An optimal design is one that maximizes the information content of the experimental data. For models with additive Gaussian noise, this corresponds to maximizing the determinant of the Fisher Information Matrix (FIM), a criterion known as D-optimality.\n\nThe solution process involves four main steps:\n1.  Solving the model's system of ordinary differential equations (ODEs) to obtain an analytical expression for the measured quantity.\n2.  Deriving the Fisher Information Matrix (FIM) based on the analytical model solution. This requires calculating the sensitivities (partial derivatives) of the model output with respect to the parameters $k_{\\text{int}}$ and $k_{\\text{rec}}$.\n3.  Defining the discrete search space of all possible experimental designs permitted by the given constraints.\n4.  Implementing an exhaustive search algorithm to evaluate the FIM determinant for every possible design and identify the one that yields the maximum value.\n\n**1. Analytical Solution of the Model Dynamics**\n\nThe system is described by two coupled linear ODEs for the number of surface receptors $S(t)$ and internalized receptors $I(t)$:\n$$\n\\frac{dS}{dt} = k_{\\text{rec}}\\,I - k_{\\text{int}}\\,S\\,\\frac{L}{K_D + L}\n$$\n$$\n\\frac{dI}{dt} = k_{\\text{int}}\\,S\\,\\frac{L}{K_D + L} - k_{\\text{rec}}\\,I\n$$\nThe total number of receptors is conserved, $S(t) + I(t) = R_{\\text{tot}}$. We can use this to express $I(t) = R_{\\text{tot}} - S(t)$ and substitute it into the first equation, yielding a single ODE for $S(t)$:\n$$\n\\frac{dS}{dt} = k_{\\text{rec}}(R_{\\text{tot}} - S(t)) - k_{\\text{int}}S(t)\\frac{L}{K_D + L}\n$$\nRearranging terms gives a standard first-order linear non-homogeneous ODE:\n$$\n\\frac{dS}{dt} + \\left(k_{\\text{rec}} + k_{\\text{int}}\\frac{L}{K_D + L}\\right)S(t) = k_{\\text{rec}}R_{\\text{tot}}\n$$\nLet us define an effective rate constant, $k_{\\text{eff}}(L) = k_{\\text{rec}} + k_{\\text{int}}\\frac{L}{K_D + L}$. The equation simplifies to:\n$$\n\\frac{dS}{dt} + k_{\\text{eff}}(L)S(t) = k_{\\text{rec}}R_{\\text{tot}}\n$$\nThe solution to this ODE with the initial condition $S(0) = R_{\\text{tot}}$ is:\n$$\nS(t) = S_{\\text{ss}} + (S(0) - S_{\\text{ss}})e^{-k_{\\text{eff}}(L)t}\n$$\nwhere the steady-state surface level $S_{\\text{ss}}$ is given by $S_{\\text{ss}} = \\frac{k_{\\text{rec}}R_{\\text{tot}}}{k_{\\text{eff}}(L)}$.\nThe measured quantity is the normalized surface receptor abundance, $\\hat{S}(t) = S(t)/R_{\\text{tot}}$. Dividing the solution by $R_{\\text{tot}}$ gives the model prediction function:\n$$\n\\hat{S}(t; L, \\theta) = \\frac{k_{\\text{rec}}}{k_{\\text{eff}}(L)} + \\left(1 - \\frac{k_{\\text{rec}}}{k_{\\text{eff}}(L)}\\right)e^{-k_{\\text{eff}}(L)t}\n$$\nThis analytical expression for the observable is the core of our analysis.\n\n**2. The Fisher Information Matrix (FIM)**\n\nFor a set of $n$ independent measurements $\\{y_1, \\dots, y_n\\}$, where $y_j = \\hat{S}(t_j; L_j, \\theta) + \\varepsilon_j$ and the noise terms $\\varepsilon_j$ are independent and identically distributed as $\\mathcal{N}(0, \\sigma^2)$, the Fisher Information Matrix for the parameter vector $\\theta = (k_{\\text{int}}, k_{\\text{rec}})$ is a $2 \\times 2$ matrix with elements:\n$$\nF_{ij} = \\frac{1}{\\sigma^2} \\sum_{k=1}^{n} \\left(\\frac{\\partial \\hat{S}(t_k; L_k, \\theta)}{\\partial \\theta_i}\\right) \\left(\\frac{\\partial \\hat{S}(t_k; L_k, \\theta)}{\\partial \\theta_j}\\right)\n$$\nThe FIM is the sum of contributions from each measurement point. For a single measurement at $(t, L)$, the FIM contribution is:\n$$\n\\text{FIM}_{(t,L)} = \\frac{1}{\\sigma^2}\n\\begin{pmatrix}\n(\\frac{\\partial \\hat{S}}{\\partial k_{\\text{int}}})^2  \\frac{\\partial \\hat{S}}{\\partial k_{\\text{int}}}\\frac{\\partial \\hat{S}}{\\partial k_{\\text{rec}}} \\\\\n\\frac{\\partial \\hat{S}}{\\partial k_{\\text{int}}}\\frac{\\partial \\hat{S}}{\\partial k_{\\text{rec}}}  (\\frac{\\partial \\hat{S}}{\\partial k_{\\text{rec}}})^2\n\\end{pmatrix}\n= \\frac{1}{\\sigma^2} \\nabla_{\\theta}\\hat{S} (\\nabla_{\\theta}\\hat{S})^T\n$$\nwhere $\\nabla_{\\theta}\\hat{S}$ is the gradient (sensitivity) vector of the model output with respect to the parameters. Our goal is to choose a set of $n$ pairs $(t_k, L_k)$ to maximize $\\det(\\sum_{k=1}^n \\text{FIM}_{(t_k, L_k)})$.\n\n**3. Sensitivity Analysis**\n\nTo construct the FIM, we must compute the partial derivatives of $\\hat{S}(t; L, \\theta)$ with respect to $k_{\\text{int}}$ and $k_{\\text{rec}}$. Using the chain and quotient rules on the analytical solution derived above, we obtain the following expressions for the sensitivities. Let $g(L) = L/(K_D+L)$.\n\nThe sensitivity with respect to the internalization rate, $k_{\\text{int}}$:\n$$\n\\frac{\\partial \\hat{S}}{\\partial k_{\\text{int}}} = g(L) \\left[ -\\frac{k_{\\text{rec}}}{k_{\\text{eff}}^2} (1 - e^{-k_{\\text{eff}}t}) + \\left(\\frac{k_{\\text{rec}}}{k_{\\text{eff}}} - 1\\right) t e^{-k_{\\text{eff}}t} \\right]\n$$\nThe sensitivity with respect to the recycling rate, $k_{\\text{rec}}$:\n$$\n\\frac{\\partial \\hat{S}}{\\partial k_{\\text{rec}}} = \\frac{1 - k_{\\text{int}} g(L) \\frac{k_{\\text{rec}}}{k_{\\text{eff}}^2}}{k_{\\text{eff}}} (1 - e^{-k_{\\text{eff}}t}) + \\left(\\frac{k_{\\text{rec}}}{k_{\\text{eff}}} - 1\\right) t e^{-k_{\\text{eff}}t}\n$$\nThese formulas allow us to compute the sensitivity vector for any given experimental condition $(t, L)$ and set of model parameters. A specific case arises when $L=0$. In this scenario, $g(0)=0$ and $k_{eff}=k_{rec}$. The surface receptor level $\\hat{S}(t)=1$ for all $t$, and both sensitivities become zero. Consequently, a measurement at zero ligand concentration provides no information about the kinetic parameters $k_{\\text{int}}$ and $k_{\\text{rec}}$.\n\n**4. Computational Strategy for Optimal Design**\n\nThe problem requires selecting $n$ distinct time points from a discrete grid and, for each time, a ligand dose from a discrete set. This defines a finite combinatorial search space of all possible experimental designs. Given the small size of the grids and sets provided in the test cases, an exhaustive search is computationally feasible and guarantees identification of the globally optimal design.\n\nThe algorithm proceeds as follows for each test case:\n1.  Define the parameter set $\\{k_{\\text{int}}, k_{\\text{rec}}, K_D, \\sigma\\}$, number of samples $n$, time grid, and dose set.\n2.  Generate all unique combinations of $n$ time points from the provided time grid.\n3.  For each combination of time points $\\{t_1, \\dots, t_n\\}$, generate all possible corresponding dose assignments $\\{L_1, \\dots, L_n\\}$, where each $L_j$ is drawn from the dose set. This forms the complete set of candidate designs.\n4.  For each candidate design:\n    a. Initialize a $2 \\times 2$ FIM to a zero matrix.\n    b. For each measurement point $(t_j, L_j)$, calculate the sensitivity vector $\\nabla_{\\theta}\\hat{S}$ using the derived formulas.\n    c. Compute the FIM contribution $\\frac{1}{\\sigma^2} \\nabla_{\\theta}\\hat{S} (\\nabla_{\\theta}\\hat{S})^T$ and add it to the total FIM.\n    d. After summing contributions from all $n$ points, compute the determinant of the total FIM.\n5.  Maintain a record of the maximum determinant found so far and the design that produced it.\n6.  After evaluating all possible designs, the one yielding the highest FIM determinant is the D-optimal design. The final output is formatted to present this maximum determinant, the corresponding set of sorted time points, and the associated doses.", "answer": "```python\n# The final answer must be a single, complete, standalone program.\nimport numpy as np\nfrom itertools import combinations, product\n\ndef solve():\n    \"\"\"\n    Solves the optimal experimental design problem for all specified test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            'K_D': 10.0, 'sigma': 0.05, 'k_int': 0.2, 'k_rec': 0.1, 'n': 3,\n            'time_grid': [1.0, 3.0, 5.0, 10.0, 20.0, 30.0],\n            'dose_set': [0.1, 1.0, 10.0, 100.0]\n        },\n        # Test case 2\n        {\n            'K_D': 10.0, 'sigma': 0.05, 'k_int': 0.2, 'k_rec': 0.01, 'n': 3,\n            'time_grid': [2.0, 4.0, 8.0, 16.0, 32.0],\n            'dose_set': [0.5, 5.0, 50.0]\n        },\n        # Test case 3\n        {\n            'K_D': 10.0, 'sigma': 0.1, 'k_int': 0.005, 'k_rec': 0.05, 'n': 3,\n            'time_grid': [5.0, 10.0, 20.0, 40.0],\n            'dose_set': [0.0, 0.5, 5.0, 50.0]\n        },\n        # Test case 4\n        {\n            'K_D': 1.0, 'sigma': 0.02, 'k_int': 0.05, 'k_rec': 0.05, 'n': 2,\n            'time_grid': [0.5, 1.0, 2.0, 4.0],\n            'dose_set': [0.0, 0.001, 1.0]\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = find_optimal_design(case_params)\n        results.append(str(result).replace(\"'\", \"\"))\n\n    # The final print statement must match the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_sensitivities(t, L, params):\n    \"\"\"\n    Calculates the sensitivities of the normalized surface receptor level\n    with respect to k_int and k_rec.\n    \"\"\"\n    k_int, k_rec, K_D = params['k_int'], params['k_rec'], params['K_D']\n\n    if L == 0.0:\n        return 0.0, 0.0\n    \n    g = L / (K_D + L)\n    k_eff = k_rec + k_int * g\n\n    if k_eff == 0: return 0.0, 0.0\n\n    exp_term = np.exp(-k_eff * t)\n\n    # dS/dk_int\n    dS_dk_int_term1 = -g * k_rec / (k_eff**2)\n    dS_dk_int_term2 = g * (-1 + k_rec/k_eff) * (-t) * exp_term\n    dS_dk_int_term3 = -g * k_rec / (k_eff**2) * (-exp_term)\n    dS_dk_int = dS_dk_int_term1 + dS_dk_int_term2 + dS_dk_int_term3\n    \n    # dS/dk_rec\n    dS_dk_rec_term1 = (k_eff - k_rec) / (k_eff**2)\n    dS_dk_rec_term2 = (-1 + k_rec/k_eff) * (-t) * exp_term\n    dS_dk_rec_term3 = -(k_eff - k_rec) / (k_eff**2) * (-exp_term)\n    dS_dk_rec = dS_dk_rec_term1 + dS_dk_rec_term2 + dS_dk_rec_term3\n    \n    return dS_dk_int, dS_dk_rec\n\n\ndef find_optimal_design(params):\n    \"\"\"\n    Finds the D-optimal design for a single test case by exhaustive search.\n    \"\"\"\n    time_grid = params['time_grid']\n    dose_set = params['dose_set']\n    n = params['n']\n    sigma = params['sigma']\n\n    max_det = -1.0\n    best_design = ([], [])\n\n    time_combos = combinations(time_grid, n)\n\n    for times in time_combos:\n        dose_assignments = product(dose_set, repeat=n)\n        \n        for doses in dose_assignments:\n            \n            FIM = np.zeros((2, 2))\n            \n            for i in range(n):\n                t = times[i]\n                L = doses[i]\n                \n                dS_dk_int, dS_dk_rec = calculate_sensitivities(t, L, params)\n                \n                grad = np.array([dS_dk_int, dS_dk_rec])\n                FIM_contribution = np.outer(grad, grad)\n                FIM += FIM_contribution\n            \n            FIM /= sigma**2\n            \n            current_det = np.linalg.det(FIM)\n\n            if current_det  max_det:\n                max_det = current_det\n                best_design = (list(times), list(doses))\n    \n    final_times, final_doses = best_design\n    \n    if final_times:\n        sorted_pairs = sorted(zip(final_times, final_doses))\n        sorted_times = [p[0] for p in sorted_pairs]\n        sorted_doses = [p[1] for p in sorted_pairs]\n        return [round(max_det, 6), sorted_times, sorted_doses]\n    else:\n        return [0.0, [], []]\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3343891"}]}