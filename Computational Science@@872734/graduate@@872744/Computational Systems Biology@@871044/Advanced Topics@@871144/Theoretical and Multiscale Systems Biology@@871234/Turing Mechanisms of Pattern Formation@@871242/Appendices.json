{"hands_on_practices": [{"introduction": "A cornerstone of understanding Turing patterns is connecting the theoretical prediction of an instability to the concrete pattern observed in a finite system. This exercise guides you through this fundamental process. By performing a linear stability analysis, you will first derive the dispersion relation that reveals the intrinsic, preferred wavelength of the pattern, and then see how the finite size of a simple one-dimensional domain quantizes the available modes, forcing the system to select the one that best matches its preference [@problem_id:3356946].", "problem": "Consider the one-dimensional two-species reaction–diffusion system on a spatial domain of length $L$ with periodic boundary conditions (defined once here as the requirement that $u(0,t) = u(L,t)$ and $v(0,t) = v(L,t)$ for all time $t$), a canonical setting for the Turing mechanism in computational systems biology:\n$$\n\\frac{\\partial u}{\\partial t} = f(u,v) + D_u \\frac{\\partial^2 u}{\\partial x^2}, \\qquad \\frac{\\partial v}{\\partial t} = g(u,v) + D_v \\frac{\\partial^2 v}{\\partial x^2}.\n$$\nAssume a spatially uniform steady state $(u_0,v_0)$ with Jacobian matrix of reaction kinetics at the steady state given by\n$$\nJ = \\begin{pmatrix}\nf_u  f_v \\\\\ng_u  g_v\n\\end{pmatrix}\n= \\begin{pmatrix}\n1.0  -1.8 \\\\\n1.4  -2.2\n\\end{pmatrix},\n$$\nand diffusion coefficients $D_u = 1$ and $D_v = 20$. The steady state is linearly stable in the absence of diffusion.\n\nStarting from first principles, namely linearization about $(u_0,v_0)$ and spectral decomposition of the Laplacian under periodic boundary conditions, carry out the following:\n\n1. Derive the dispersion relation that gives the growth rate $\\sigma(k)$ of an infinitesimal Fourier mode of wavenumber $k$ for the linearized system. Explain how the fastest-growing wavenumber (in the continuum) $k_\\ast$ is determined by maximizing the largest branch of $\\sigma(k)$ with respect to $k$.\n\n2. Explain how domain size $L$ and boundary conditions quantize admissible spatial wavenumbers into a discrete set $k_n$, and establish how the selected pattern wavelength on a finite periodic domain relates to $L$. Use this to justify how the number of peaks scales with $L$ for periodic boundary conditions.\n\n3. With the parameters specified above, take an initial domain length $L = 10$. Predict the number of peaks by selecting the admissible discrete mode closest to the continuum $k_\\ast$, and then predict the number of peaks after doubling the domain length to $L = 20$ under the same parameters. Compute the change in the number of peaks when $L$ is doubled.\n\nProvide only the integer change in the number of peaks as your final answer. No units are required for the final answer, and no rounding instructions are needed beyond the discrete mode selection implied by periodic boundary conditions.", "solution": "The problem is valid as it is scientifically grounded in the established theory of reaction-diffusion systems and Turing pattern formation, is well-posed with all necessary parameters provided, and is free of contradictions or ambiguities. The premises, such as the stability of the steady state in the absence of diffusion, are internally consistent with the provided data.\n\nWe begin by carrying out the linear stability analysis of the given reaction-diffusion system with respect to a spatially uniform steady state $(u_0, v_0)$.\n\n1. Derivation of the Dispersion Relation and the Fastest-Growing Wavenumber\n\nThe governing equations are:\n$$\n\\frac{\\partial u}{\\partial t} = f(u,v) + D_u \\frac{\\partial^2 u}{\\partial x^2} \\\\\n\\frac{\\partial v}{\\partial t} = g(u,v) + D_v \\frac{\\partial^2 v}{\\partial x^2}\n$$\nWe consider small perturbations $(\\tilde{u}, \\tilde{v})$ around the steady state $(u_0, v_0)$, such that $u(x,t) = u_0 + \\tilde{u}(x,t)$ and $v(x,t) = v_0 + \\tilde{v}(x,t)$. Substituting these into the system and performing a Taylor expansion of the reaction terms $f(u,v)$ and $g(u,v)$ around $(u_0, v_0)$ up to the first order, we obtain the linearized system for the perturbations:\n$$\n\\frac{\\partial \\tilde{u}}{\\partial t} = f_u \\tilde{u} + f_v \\tilde{v} + D_u \\frac{\\partial^2 \\tilde{u}}{\\partial x^2} \\\\\n\\frac{\\partial \\tilde{v}}{\\partial t} = g_u \\tilde{u} + g_v \\tilde{v} + D_v \\frac{\\partial^2 \\tilde{v}}{\\partial x^2}\n$$\nwhere the partial derivatives $f_u, f_v, g_u, g_v$ are evaluated at the steady state $(u_0, v_0)$ and constitute the elements of the Jacobian matrix $J$. In vector form, this is:\n$$\n\\frac{\\partial}{\\partial t} \\begin{pmatrix} \\tilde{u} \\\\ \\tilde{v} \\end{pmatrix} = J \\begin{pmatrix} \\tilde{u} \\\\ \\tilde{v} \\end{pmatrix} + \\begin{pmatrix} D_u  0 \\\\ 0  D_v \\end{pmatrix} \\frac{\\partial^2}{\\partial x^2} \\begin{pmatrix} \\tilde{u} \\\\ \\tilde{v} \\end{pmatrix}\n$$\nDue to the periodic boundary conditions on the domain of length $L$, the solutions can be decomposed into a sum of Fourier modes. We investigate the stability of a single mode with wavenumber $k$ by postulating a solution of the form:\n$$\n\\begin{pmatrix} \\tilde{u}(x,t) \\\\ \\tilde{v}(x,t) \\end{pmatrix} = \\begin{pmatrix} c_u \\\\ c_v \\end{pmatrix} \\exp(\\sigma t + ikx)\n$$\nHere, $\\sigma$ is the temporal growth rate (a complex number, in general) and $k$ is the spatial wavenumber. Substituting this ansatz into the linearized system, the time derivative $\\frac{\\partial}{\\partial t}$ becomes multiplication by $\\sigma$, and the spatial derivative $\\frac{\\partial^2}{\\partial x^2}$ becomes multiplication by $(ik)^2 = -k^2$. This transforms the system of partial differential equations into a system of algebraic equations:\n$$\n\\sigma \\begin{pmatrix} c_u \\\\ c_v \\end{pmatrix} = J \\begin{pmatrix} c_u \\\\ c_v \\end{pmatrix} - k^2 \\begin{pmatrix} D_u  0 \\\\ 0  D_v \\end{pmatrix} \\begin{pmatrix} c_u \\\\ c_v \\end{pmatrix}\n$$\nThis is an eigenvalue problem for the growth rate $\\sigma$, where $\\sigma$ is an eigenvalue of the matrix $J_k = J - k^2 D$, with $D$ being the diagonal matrix of diffusion coefficients.\n$$\nJ_k = \\begin{pmatrix} f_u - D_u k^2  f_v \\\\ g_u  g_v - D_v k^2 \\end{pmatrix}\n$$\nThe eigenvalues $\\sigma$ are found by solving the characteristic equation $\\det(J_k - \\sigma I) = 0$:\n$$\n\\det \\begin{pmatrix} f_u - D_u k^2 - \\sigma  f_v \\\\ g_u  g_v - D_v k^2 - \\sigma \\end{pmatrix} = 0\n$$\nThis expands to the quadratic equation:\n$$\n\\sigma^2 - \\text{tr}(J_k) \\sigma + \\det(J_k) = 0\n$$\nwhere\n$$\n\\text{tr}(J_k) = f_u - D_u k^2 + g_v - D_v k^2 = (f_u + g_v) - (D_u + D_v)k^2\n$$\n$$\n\\det(J_k) = (f_u - D_u k^2)(g_v - D_v k^2) - f_v g_u = (f_u g_v - f_v g_u) - (f_u D_v + g_v D_u)k^2 + D_u D_v k^4\n$$\nThe solution to the characteristic equation gives the dispersion relation $\\sigma(k)$:\n$$\n\\sigma(k) = \\frac{\\text{tr}(J_k) \\pm \\sqrt{\\text{tr}(J_k)^2 - 4\\det(J_k)}}{2}\n$$\nA pattern-forming instability (Turing instability) occurs if the real part of at least one eigenvalue $\\sigma$ becomes positive for some wavenumber $k  0$, while being negative for $k=0$ (the condition for stability in the absence of diffusion). The instability is driven by the eigenvalue with the largest real part, $\\sigma_+(k)$, which corresponds to the '$+$' sign in the formula. A mode with wavenumber $k$ will grow if $\\text{Re}(\\sigma_+(k))  0$.\n\nThe fastest-growing wavenumber, $k_\\ast$, is the value of $k$ that maximizes the growth rate $\\sigma_+(k)$. This is found by solving $\\frac{d\\sigma_+}{dk}(k) = 0$. A standard and effective method to determine $k_\\ast$, particularly near the onset of instability, is to find the wavenumber that corresponds to the minimum of $\\det(J_k)$. Let $K = k^2$. The expression for $\\det(J_k)$ is a quadratic in $K$:\n$$\nH(K) = \\det(J_k) = (D_u D_v)K^2 - (f_u D_v + g_v D_u)K + (f_u g_v - f_v g_u)\n$$\nTo find the minimum of this function, we take the derivative with respect to $K$ and set it to zero:\n$$\n\\frac{dH}{dK} = 2(D_u D_v)K - (f_u D_v + g_v D_u) = 0\n$$\nSolving for $K$ gives the square of the critical wavenumber, which we take as $k_\\ast^2$:\n$$\nk_\\ast^2 = K_\\ast = \\frac{f_u D_v + g_v D_u}{2 D_u D_v}\n$$\n\n2. Quantization of Wavenumbers and Scaling with Domain Size\n\nOn a finite domain of length $L$ with periodic boundary conditions, the allowed spatial functions must satisfy $\\phi(x) = \\phi(x+L)$. For a Fourier mode $\\exp(ikx)$, this implies $\\exp(ikx) = \\exp(ik(x+L)) = \\exp(ikx)\\exp(ikL)$, which requires $\\exp(ikL) = 1$. This condition is only met for a discrete set of wavenumbers $k_n$:\n$$\nk_n L = 2\\pi n, \\quad \\text{for integer } n = 0, 1, 2, \\dots\n$$\nThus, the admissible wavenumbers are quantized: $k_n = \\frac{2\\pi n}{L}$.\nThe wavelength of the $n$-th mode is $\\lambda_n = \\frac{2\\pi}{k_n} = \\frac{L}{n}$. This means that the mode $n$ corresponds to a pattern with exactly $n$ repeating units (peaks) over the domain length $L$.\nThe system tends to select the pattern corresponding to the fastest-growing mode. On a finite domain, this will be the admissible discrete mode $k_n$ that is closest to the continuum's most unstable mode, $k_\\ast$. The selected mode number, $n_{sel}$, is therefore the integer $n$ that minimizes $|k_n - k_\\ast|$, or $|\\frac{2\\pi n}{L} - k_\\ast|$. From this, we can approximate the selected mode number as:\n$$\nn_{sel} \\approx \\frac{k_\\ast L}{2\\pi}\n$$\nSince the number of peaks in the pattern is equal to $n_{sel}$, this relationship shows that the number of peaks scales approximately linearly with the domain length $L$.\n\n3. Calculation of the Change in the Number of Peaks\n\nWe are given the parameters: $D_u=1$, $D_v=20$, and the Jacobian $J = \\begin{pmatrix} 1.0  -1.8 \\\\ 1.4  -2.2 \\end{pmatrix}$. Thus, $f_u=1.0$, $f_v=-1.8$, $g_u=1.4$, and $g_v=-2.2$.\nFirst, we compute the fastest-growing wavenumber $k_\\ast$ for the continuous system:\n$$\nk_\\ast^2 = \\frac{f_u D_v + g_v D_u}{2 D_u D_v} = \\frac{(1.0)(20) + (-2.2)(1)}{2(1)(20)} = \\frac{20 - 2.2}{40} = \\frac{17.8}{40} = 0.445\n$$\nSo, $k_\\ast = \\sqrt{0.445}$.\n\nCase 1: Initial domain length $L = 10$.\nThe admissible wavenumbers are $k_n = \\frac{2\\pi n}{10} = \\frac{\\pi n}{5}$. We need to find the integer $n$ that minimizes $|k_n - k_\\ast| = |\\frac{\\pi n}{5} - \\sqrt{0.445}|$. This is equivalent to finding the integer $n$ closest to the value $\\frac{k_\\ast L}{2\\pi}$.\n$$\nn_{target,1} = \\frac{10 \\sqrt{0.445}}{2\\pi} = \\frac{5\\sqrt{0.445}}{\\pi} \\approx \\frac{5 \\times 0.66708}{3.14159} \\approx 1.0617\n$$\nThe integer closest to $1.0617$ is $1$. Therefore, for $L=10$, the predicted number of peaks is $N_1 = 1$.\n\nCase 2: Doubled domain length $L = 20$.\nThe admissible wavenumbers are now $k_n = \\frac{2\\pi n}{20} = \\frac{\\pi n}{10}$. We find the integer $n$ closest to the new target value:\n$$\nn_{target,2} = \\frac{20 \\sqrt{0.445}}{2\\pi} = \\frac{10\\sqrt{0.445}}{\\pi} \\approx \\frac{10 \\times 0.66708}{3.14159} \\approx 2.1234\n$$\nThe integer closest to $2.1234$ is $2$. Therefore, for $L=20$, the predicted number of peaks is $N_2 = 2$.\n\nThe change in the number of peaks when the domain length is doubled is the difference between $N_2$ and $N_1$:\n$$\n\\Delta N = N_2 - N_1 = 2 - 1 = 1\n$$", "answer": "$$\\boxed{1}$$", "id": "3356946"}, {"introduction": "While periodic domains are mathematically convenient, real biological systems have boundaries that can influence pattern formation in nontrivial ways. This practice moves beyond idealized scenarios to explore how different boundary conditions shape the final pattern. By comparing standard no-flux (Neumann) conditions to more general Robin conditions, you will analytically determine how boundary permeability can shift both the wavelength and phase of the pattern, demonstrating that boundaries are active participants in organizing spatial structure [@problem_id:3356952].", "problem": "Consider a two-species reaction–diffusion partial differential equation (PDE) model for concentrations $u(x,t)$ and $v(x,t)$ on a one-dimensional domain $x \\in [0,L]$ with outward unit normals $n(0) = -1$ and $n(L) = +1$:\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\nu \\\\\nv\n\\end{pmatrix}\n=\nJ\n\\begin{pmatrix}\nu \\\\\nv\n\\end{pmatrix}\n+\n\\begin{pmatrix}\nD_u  0 \\\\\n0  D_v\n\\end{pmatrix}\n\\frac{\\partial^2}{\\partial x^2}\n\\begin{pmatrix}\nu \\\\\nv\n\\end{pmatrix},\n$$\nwhere $J$ is the Jacobian matrix of reaction kinetics evaluated at a homogeneous steady state and $D_u, D_v  0$ are diffusion coefficients. Assume that the homogeneous steady state is linearly stable in the absence of diffusion and that diffusion induces instability in a band of spatial wavenumbers, yielding a Turing mechanism of pattern formation. Compare Neumann boundary conditions, defined by $\\nabla u \\cdot n = 0$ and $\\nabla v \\cdot n = 0$ at $x=0$ and $x=L$, to Robin boundary conditions, defined by $\\nabla u \\cdot n + \\kappa u = 0$ and $\\nabla v \\cdot n + \\kappa v = 0$ at $x=0$ and $x=L$, where $\\kappa \\ge 0$ is a boundary exchange parameter. \n\nYour tasks are:\n1. Starting from separation of variables and eigenfunction expansion of the Laplacian on $[0,L]$ with the given Neumann and Robin boundary conditions, derive the wavenumber quantization conditions $k$ that determine the spatial eigenvalue spectrum for the Laplacian under each type of boundary condition. Carefully account for the outward normal directions at $x=0$ and $x=L$ when writing the Robin boundary conditions.\n2. Assuming $\\kappa L$ is small and focusing on the lowest nontrivial spatial mode $n=1$ that typically dominates the Turing instability band, expand the Robin quantization condition to first order in $\\kappa$ and obtain the leading-order correction $\\delta k$ to the Neumann wavenumber $k_{1}^{(N)} = \\pi/L$.\n3. Represent the dominant $u$-component of the pattern near onset as $u(x,t) \\propto \\cos(k x + \\phi)$ times a slowly growing amplitude (consistent with linearization and mode dominance). Using only the Robin boundary condition for $u$ at $x=0$ and your expansion for $k$, derive the boundary phase $\\phi$ as a function of $\\kappa$ and $L$ to leading order in $\\kappa L$. \n\nProvide your final result as a single closed-form analytic expression for $\\phi$ in terms of $\\kappa$ and $L$, valid to first order in $\\kappa L$. Express the phase in radians. No numerical values are given; keep parameters symbolic and do not introduce new approximations beyond those stated. The final answer must be a single analytic expression.", "solution": "The problem requires an analysis of the spatial eigenvalues and eigenfunctions of the Laplacian operator on a one-dimensional domain, subject to Neumann and Robin boundary conditions, in the context of a Turing pattern-forming system. The solution is found by following the three specified tasks.\n\nFirst, we consider the spatial part of the linearized reaction-diffusion equation. A solution of the form $\\begin{pmatrix} u(x,t) \\\\ v(x,t) \\end{pmatrix} = \\exp(\\lambda t) \\psi(x) \\mathbf{c}$, where $\\mathbf{c}$ is a constant vector, reduces the PDE system to a set of eigenvalue problems. The spatial part, $\\psi(x)$, must be an eigenfunction of the Laplacian operator, $\\frac{d^2}{dx^2}$, on the domain $x \\in [0, L]$. The eigenvalue equation is $\\frac{d^2\\psi}{dx^2} = -k^2\\psi$, where $k$ is the spatial wavenumber. The general solution to this ordinary differential equation is $\\psi(x) = A \\cos(kx) + B \\sin(kx)$ for constants $A$ and $B$. The specific form of the eigenfunctions and the allowed (quantized) values of $k$ are determined by the boundary conditions.\n\n**Task 1: Wavenumber Quantization Conditions**\n\n**Neumann Boundary Conditions:**\nThe Neumann boundary conditions are $\\nabla u \\cdot n = 0$ at the boundaries $x=0$ and $x=L$. Given the outward normals $n(0) = -1$ and $n(L) = +1$, this translates to:\nAt $x=0$: $\\frac{\\partial u}{\\partial x}\\big|_{x=0} \\cdot n(0) = -\\frac{d\\psi}{dx}\\big|_{x=0} = 0 \\implies \\frac{d\\psi}{dx}\\big|_{x=0} = 0$.\nAt $x=L$: $\\frac{\\partial u}{\\partial x}\\big|_{x=L} \\cdot n(L) = +\\frac{d\\psi}{dx}\\big|_{x=L} = 0 \\implies \\frac{d\\psi}{dx}\\big|_{x=L} = 0$.\nThe derivative of the general solution is $\\psi'(x) = -Ak\\sin(kx) + Bk\\cos(kx)$.\nApplying the condition at $x=0$: $\\psi'(0) = B k = 0$. For a non-trivial pattern, we require $k \\ne 0$, which implies $B=0$. The solution must be of the form $\\psi(x) = A \\cos(kx)$.\nApplying the condition at $x=L$: $\\psi'(L) = -Ak\\sin(kL) = 0$. For a non-trivial solution ($A \\ne 0$, $k \\ne 0$), we must have $\\sin(kL)=0$.\nThis leads to the quantization condition $kL = n\\pi$ for integers $n \\ge 0$.\nThe Neumann wavenumbers are thus given by:\n$$\nk_{n}^{(N)} = \\frac{n\\pi}{L}, \\quad n \\in \\{0, 1, 2, \\dots\\}\n$$\nThe mode $n=0$ corresponds to the spatially homogeneous steady state. The lowest non-trivial wavenumber is for $n=1$, which is $k_{1}^{(N)} = \\pi/L$.\n\n**Robin Boundary Conditions:**\nThe Robin boundary conditions are $\\nabla u \\cdot n + \\kappa u = 0$ at $x=0$ and $x=L$, with $\\kappa \\ge 0$.\nAt $x=0$: $-\\frac{d\\psi}{dx}\\big|_{x=0} + \\kappa \\psi(0) = 0$.\nAt $x=L$: $+\\frac{d\\psi}{dx}\\big|_{x=L} + \\kappa \\psi(L) = 0$.\nApplying these to the general solution $\\psi(x) = A \\cos(kx) + B \\sin(kx)$:\nFrom the condition at $x=0$: $-(-Ak\\sin(0) + Bk\\cos(0)) + \\kappa(A\\cos(0) + B\\sin(0)) = 0 \\implies -Bk + \\kappa A = 0$.\nFrom the condition at $x=L$: $(-Ak\\sin(kL) + Bk\\cos(kL)) + \\kappa(A\\cos(kL) + B\\sin(kL)) = 0$.\nThis is a homogeneous linear system for $A$ and $B$:\n$$\n\\begin{pmatrix}\n\\kappa  -k \\\\\n\\kappa\\cos(kL) - k\\sin(kL)  \\kappa\\sin(kL) + k\\cos(kL)\n\\end{pmatrix}\n\\begin{pmatrix}\nA \\\\\nB\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nFor a non-trivial solution, the determinant of the coefficient matrix must be zero:\n$\\kappa(\\kappa\\sin(kL) + k\\cos(kL)) - (-k)(\\kappa\\cos(kL) - k\\sin(kL)) = 0$.\n$\\kappa^2\\sin(kL) + \\kappa k\\cos(kL) + \\kappa k\\cos(kL) - k^2\\sin(kL) = 0$.\nThis simplifies to the quantization condition for Robin wavenumbers:\n$$\n(\\kappa^2 - k^2)\\sin(kL) + 2\\kappa k\\cos(kL) = 0\n$$\n\n**Task 2: Leading-Order Correction to the Wavenumber**\n\nWe seek the deviation of the Robin wavenumber $k$ from the Neumann wavenumber $k_{1}^{(N)} = \\pi/L$ for small $\\kappa L$. Let $k = k_{1}^{(N)} + \\delta k = \\frac{\\pi}{L} + \\delta k$, where $\\delta k$ is a small correction. We substitute this into the Robin quantization condition and expand to first order in the small parameters $\\kappa$ and $\\delta k$.\nFirst, we expand the trigonometric terms:\n$kL = (\\frac{\\pi}{L} + \\delta k)L = \\pi + \\delta k L$.\n$\\sin(kL) = \\sin(\\pi + \\delta k L) = -\\sin(\\delta k L) \\approx -\\delta k L$.\n$\\cos(kL) = \\cos(\\pi + \\delta k L) = -\\cos(\\delta k L) \\approx -1$.\nThe terms $k$ and $k^2$ are expanded as:\n$k \\approx \\frac{\\pi}{L}$.\n$k^2 \\approx (\\frac{\\pi}{L})^2$.\nSubstituting these into the quantization condition:\n$(\\kappa^2 - (\\frac{\\pi}{L})^2)(-\\delta k L) + 2\\kappa(\\frac{\\pi}{L})(-1) + O(\\kappa^2, (\\delta k)^2, \\kappa\\delta k) = 0$.\nRetaining only the leading-order terms (terms linear in $\\kappa$ or $\\delta k$):\n$( - (\\frac{\\pi}{L})^2)(-\\delta k L) - 2\\kappa(\\frac{\\pi}{L}) = 0$.\n$\\frac{\\pi^2}{L} \\delta k = \\frac{2\\pi\\kappa}{L}$.\nSolving for the correction $\\delta k$:\n$\\pi \\delta k = 2\\kappa \\implies \\delta k = \\frac{2\\kappa}{\\pi}$.\nThus, the Robin wavenumber for the lowest non-trivial mode, to leading order, is $k \\approx \\frac{\\pi}{L} + \\frac{2\\kappa}{\\pi}$.\n\n**Task 3: Boundary Phase $\\phi$**\n\nThe dominant spatial pattern is given as $u(x,t) \\propto \\cos(kx+\\phi)$. Let the spatial eigenfunction be $\\psi(x) = C \\cos(kx+\\phi)$ for some amplitude $C$. We use the Robin boundary condition at $x=0$ to determine the phase $\\phi$.\nThe condition is $-\\frac{d\\psi}{dx}\\big|_{x=0} + \\kappa \\psi(0) = 0$.\nThe components are:\n$\\psi(0) = C\\cos(\\phi)$.\n$\\psi'(x) = -Ck\\sin(kx+\\phi)$, so $\\psi'(0) = -Ck\\sin(\\phi)$.\nSubstituting into the boundary condition:\n$-(-Ck\\sin(\\phi)) + \\kappa(C\\cos(\\phi)) = 0$.\n$Ck\\sin(\\phi) + C\\kappa\\cos(\\phi) = 0$.\nFor a non-trivial pattern ($C \\neq 0$), we have $k\\sin(\\phi) + \\kappa\\cos(\\phi) = 0$.\nAssuming $\\cos(\\phi) \\ne 0$, we can write $\\tan(\\phi) = -\\frac{\\kappa}{k}$.\nTo find $\\phi$ to leading order in $\\kappa L$, we substitute our first-order approximation for $k$:\n$k \\approx \\frac{\\pi}{L} + \\frac{2\\kappa}{\\pi}$.\n$\\tan(\\phi) = -\\frac{\\kappa}{\\frac{\\pi}{L} + \\frac{2\\kappa}{\\pi}} = -\\frac{\\kappa L}{\\pi(1 + \\frac{2\\kappa L}{\\pi^2})}$.\nFor small $\\kappa L$, we can expand the denominator using $(1+x)^{-1} \\approx 1-x$:\n$\\tan(\\phi) = -\\frac{\\kappa L}{\\pi}\\left(1 - \\frac{2\\kappa L}{\\pi^2} + \\dots\\right) = -\\frac{\\kappa L}{\\pi} + O((\\kappa L)^2)$.\nSince $\\kappa L$ is small, the argument of the tangent, $\\phi$, must also be small. For small angles, $\\tan(\\phi) \\approx \\phi$ (in radians).\nTherefore, the boundary phase $\\phi$ to leading order in $\\kappa L$ is:\n$\\phi \\approx -\\frac{\\kappa L}{\\pi}$.\nThis expression represents the phase shift of the cosine pattern at the boundary, induced by the Robin condition.", "answer": "$$\\boxed{-\\frac{\\kappa L}{\\pi}}$$", "id": "3356952"}, {"introduction": "Many biological patterns emerge on curved surfaces, where the geometry of the domain itself plays a critical role in pattern selection. This computational practice extends the theory of reaction-diffusion systems to non-Euclidean manifolds like spheres and tori. You will replace the standard Laplacian with the Laplace-Beltrami operator, whose eigenvalues are dictated by the surface's curvature, and implement a program to predict how geometry biases the selection between different pattern morphologies, such as spots and stripes [@problem_id:3356956].", "problem": "Consider a two-species reaction–diffusion system on a smooth two-dimensional manifold $\\mathcal{M}$ defined by the equations\n$$\n\\frac{\\partial u}{\\partial t} = D_u \\,\\Delta_{\\mathcal{M}} u + f(u,v), \\qquad \\frac{\\partial v}{\\partial t} = D_v \\,\\Delta_{\\mathcal{M}} v + g(u,v),\n$$\nwhere $u$ and $v$ are concentrations, $D_u$ and $D_v$ are diffusion coefficients, and $\\Delta_{\\mathcal{M}}$ is the Laplace–Beltrami operator on the manifold $\\mathcal{M}$. The kinetics are given by the Schnakenberg model,\n$$\nf(u,v) = a - u + u^2 v, \\qquad g(u,v) = b - u^2 v,\n$$\nwith parameters $a0$ and $b0$. Assume there exists a homogeneous steady state $(u^\\ast, v^\\ast)$ satisfying $f(u^\\ast,v^\\ast) = 0$ and $g(u^\\ast,v^\\ast) = 0$.\n\nStarting from the foundational base of linear stability analysis around the homogeneous steady state and spectral decomposition of the Laplace–Beltrami operator, perform the following tasks.\n\n1. Derive the homogeneous steady state $(u^\\ast, v^\\ast)$ in terms of $a$ and $b$. Compute the Jacobian matrix $J$ of the reaction terms evaluated at $(u^\\ast, v^\\ast)$, where\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial f}{\\partial u}  \\frac{\\partial f}{\\partial v} \\\\\n\\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial v}\n\\end{pmatrix}\\bigg|_{(u^\\ast,v^\\ast)}.\n$$\n\n2. For an eigenfunction of the Laplace–Beltrami operator with eigenvalue $-\\kappa$ (so that $\\Delta_{\\mathcal{M}} \\phi = -\\kappa \\phi$), show that the linearized dynamics of the mode amplitude is governed by the $2\\times 2$ matrix\n$$\nA(\\kappa) = \\begin{pmatrix}\nf_u - D_u \\kappa  f_v \\\\\ng_u  g_v - D_v \\kappa\n\\end{pmatrix}\\bigg|_{(u^\\ast,v^\\ast)},\n$$\nand that the instantaneous growth rate of the perturbation is the maximum real part among the eigenvalues of $A(\\kappa)$.\n\n3. Sphere case: Let $\\mathcal{M}$ be a sphere of radius $R$. The eigenfunctions of $\\Delta_{\\mathcal{M}}$ are the spherical harmonics $Y_\\ell^m$ with integer degree $\\ell \\ge 0$ and order $m$ satisfying $-\\ell \\le m \\le \\ell$, and the corresponding eigenvalues are\n$$\n\\Delta_{\\mathcal{M}} Y_\\ell^m = - \\frac{\\ell(\\ell+1)}{R^2} Y_\\ell^m,\n$$\nso that $\\kappa = \\frac{\\ell(\\ell+1)}{R^2}$ depends only on $\\ell$. For each integer $\\ell$ in a prescribed search range, compute the growth rate and find the degree $\\ell^\\ast$ that maximizes the growth rate among unstable modes (those having positive maximum real part). Report the degeneracy $2\\ell^\\ast+1$. For classification of pattern type, use the following operational rule grounded in the geometry of $Y_\\ell^m$: predict “stripes” if $\\ell^\\ast = 1$ (dominant zonal banding), and predict “spots” if $\\ell^\\ast \\ge 2$ (multi-directional degeneracy conducive to localized peaks). If no unstable mode exists in the search range, report no selection.\n\n4. Torus case under thin-torus approximation: Consider a torus of revolution with major radius $R$ and minor radius $r$ satisfying the thin-torus regime $r \\ll R$. In this approximation, treat the spectrum as separable over the toroidal angle (with integer index $n$) and the poloidal angle (with integer index $m$), and approximate the Laplace–Beltrami eigenvalues by\n$$\n\\kappa \\approx \\frac{m^2}{r^2} + \\frac{n^2}{R^2},\n$$\nfor integers $m \\ge 0$ and $n \\ge 0$, excluding $(m,n) = (0,0)$. For all integer pairs $(m,n)$ in a prescribed search range, compute the growth rate and find $(m^\\ast,n^\\ast)$ that maximizes the growth rate among unstable modes. For classification, predict “stripes” if exactly one of $m^\\ast$ or $n^\\ast$ is zero (variation in a single angular direction), and predict “spots” if both are nonzero (two-dimensional variation). If no unstable mode exists in the search range, report no selection.\n\n5. Curvature bias via spherical harmonics: Using the results of the sphere case, articulate how the radius $R$ (through $\\kappa = \\ell(\\ell+1)/R^2$) biases the selection of $\\ell^\\ast$ and hence the pattern type. Operationalize this by computing $\\ell^\\ast$ for different $R$ values under fixed kinetics and diffusion, and report the changes in $\\ell^\\ast$ and degeneracy.\n\nImplement a complete, runnable program that carries out the above analyses and produces numeric predictions for the following test suite. All quantities are dimensionless, and no physical units are required.\n\nTest Suite:\n- Case S1 (sphere, baseline curvature): $a=0.2$, $b=1.3$, $D_u=10^{-4}$, $D_v=10^{-2}$, $R=1.0$, search $\\ell \\in \\{1,2,\\dots,40\\}$.\n- Case S2 (sphere, higher curvature): same as S1 but $R=0.6$, search $\\ell \\in \\{1,2,\\dots,40\\}$.\n- Case T1 (torus, thin-torus stripes bias): $a=0.2$, $b=1.3$, $D_u=10^{-4}$, $D_v=10^{-2}$, $R=2.0$, $r=0.3$, search $(m,n)$ with $m\\in\\{0,1,\\dots,40\\}$, $n\\in\\{0,1,\\dots,40\\}$ excluding $(0,0)$.\n- Case T2 (torus, near-isotropic cross-section): same kinetics and diffusion as T1, $R=0.8$, $r=0.8$, search $(m,n)$ with $m\\in\\{0,1,\\dots,40\\}$, $n\\in\\{0,1,\\dots,40\\}$ excluding $(0,0)$.\n- Case S3 (sphere, no Turing instability): $a=0.2$, $b=1.3$, $D_u=10^{-4}$, $D_v=10^{-4}$, $R=1.0$, search $\\ell \\in \\{1,2,\\dots,40\\}$.\n\nFor each sphere case, output a list of three integers $[\\ell^\\ast, 2\\ell^\\ast+1, \\sigma]$, where $\\sigma=1$ encodes “stripes”, $\\sigma=0$ encodes “spots”, and if no unstable mode is found then output $[-1,0,-1]$. For each torus case, output a list of three integers $[m^\\ast, n^\\ast, \\sigma]$, where $\\sigma=1$ encodes “stripes” (exactly one index zero), $\\sigma=0$ encodes “spots” (both indices nonzero), and if no unstable mode is found then output $[-1,-1,-1]$.\n\nYour program should produce a single line of output containing the results for the five cases as a comma-separated list enclosed in square brackets, where each case result is itself a bracket-enclosed comma-separated list. For example, the output format must be\n$$\n[\\,[\\ell^\\ast,2\\ell^\\ast+1,\\sigma],\\,[\\ell^\\ast,2\\ell^\\ast+1,\\sigma],\\,[m^\\ast,n^\\ast,\\sigma],\\,[m^\\ast,n^\\ast,\\sigma],\\,[\\ell^\\ast,2\\ell^\\ast+1,\\sigma]\\,].\n$$", "solution": "The user has provided a well-posed problem in computational systems biology, specifically on the topic of Turing pattern formation. The problem is scientifically grounded, requires the application of linear stability analysis to a reaction-diffusion system on curved manifolds, and provides all necessary parameters and definitions for a complete solution. The problem is deemed valid.\n\nThe solution will be developed by following the steps outlined in the problem statement.\n\n### Step 1: Homogeneous Steady State and Jacobian Matrix\n\nThe reaction-diffusion system is given by:\n$$\n\\frac{\\partial u}{\\partial t} = D_u \\,\\Delta_{\\mathcal{M}} u + f(u,v) \\\\\n\\frac{\\partial v}{\\partial t} = D_v \\,\\Delta_{\\mathcal{M}} v + g(u,v)\n$$\nwith the Schnakenberg kinetics:\n$$\nf(u,v) = a - u + u^2 v \\\\\ng(u,v) = b - u^2 v\n$$\nThe homogeneous steady state $(u^*, v^*)$ is found by setting the reaction terms to zero, $f(u^*,v^*) = 0$ and $g(u^*,v^*) = 0$.\nFrom $g(u^*,v^*) = 0$, we have $b - (u^*)^2 v^* = 0$, which implies $(u^*)^2 v^* = b$.\nSubstituting this into $f(u^*,v^*) = 0$:\n$$\na - u^* + b = 0 \\implies u^* = a+b\n$$\nNow, we substitute $u^*$ back to find $v^*$:\n$$\n(a+b)^2 v^* = b \\implies v^* = \\frac{b}{(a+b)^2}\n$$\nThus, the homogeneous steady state is $(u^*, v^*) = \\left(a+b, \\frac{b}{(a+b)^2}\\right)$.\n\nNext, we compute the Jacobian matrix $J$ of the reaction kinetics evaluated at this steady state. The partial derivatives are:\n$$\n\\frac{\\partial f}{\\partial u} = -1 + 2uv, \\qquad \\frac{\\partial f}{\\partial v} = u^2 \\\\\n\\frac{\\partial g}{\\partial u} = -2uv, \\qquad \\frac{\\partial g}{\\partial v} = -u^2\n$$\nEvaluating these at $(u^*, v^*)$, we find the terms $u^* v^* = (a+b) \\frac{b}{(a+b)^2} = \\frac{b}{a+b}$. Let $f_u, f_v, g_u, g_v$ denote the partial derivatives evaluated at the steady state.\n$$\nf_u = -1 + 2u^*v^* = -1 + \\frac{2b}{a+b} = \\frac{-a-b+2b}{a+b} = \\frac{b-a}{a+b} \\\\\nf_v = (u^*)^2 = (a+b)^2 \\\\\ng_u = -2u^*v^* = -\\frac{2b}{a+b} \\\\\ng_v = -(u^*)^2 = -(a+b)^2\n$$\nThe Jacobian matrix is therefore:\n$$\nJ = \\begin{pmatrix} f_u  f_v \\\\ g_u  g_v \\end{pmatrix} = \\begin{pmatrix}\n\\frac{b-a}{a+b}  (a+b)^2 \\\\\n-\\frac{2b}{a+b}  -(a+b)^2\n\\end{pmatrix}\n$$\n\n### Step 2: Linearized Dynamics and Growth Rate\n\nWe consider small perturbations around the steady state: $u(\\mathbf{x}, t) = u^* + \\tilde{u}(\\mathbf{x}, t)$ and $v(\\mathbf{x}, t) = v^* + \\tilde{v}(\\mathbf{x}, t)$. The linearized system for the perturbations is:\n$$\n\\frac{\\partial \\tilde{u}}{\\partial t} = D_u \\Delta_{\\mathcal{M}} \\tilde{u} + f_u \\tilde{u} + f_v \\tilde{v} \\\\\n\\frac{\\partial \\tilde{v}}{\\partial t} = D_v \\Delta_{\\mathcal{M}} \\tilde{v} + g_u \\tilde{u} + g_v \\tilde{v}\n$$\nThe perturbations can be expanded in the basis of eigenfunctions $\\phi_k$ of the Laplace-Beltrami operator, where $\\Delta_{\\mathcal{M}} \\phi_k = -\\kappa_k \\phi_k$. For a single mode with eigenvalue $-\\kappa$, we can write $\\tilde{u}(\\mathbf{x},t) = c_u(t) \\phi(\\mathbf{x})$ and $\\tilde{v}(\\mathbf{x},t) = c_v(t) \\phi(\\mathbf{x})$. Substituting these into the linearized equations and dividing by $\\phi(\\mathbf{x})$ yields a system of ODEs for the amplitudes $(c_u, c_v)$:\n$$\n\\frac{d}{dt} \\begin{pmatrix} c_u \\\\ c_v \\end{pmatrix} = \\begin{pmatrix} f_u - D_u \\kappa  f_v \\\\ g_u  g_v - D_v \\kappa \\end{pmatrix} \\begin{pmatrix} c_u \\\\ c_v \\end{pmatrix}\n$$\nThis confirms the stability matrix $A(\\kappa)$ given in the problem statement. The solutions are of the form $e^{\\lambda t}$, where $\\lambda$ are the eigenvalues of $A(\\kappa)$. A mode with wavenumber $\\kappa$ is unstable if any of the eigenvalues of $A(\\kappa)$ has a positive real part. The growth rate of the mode is the maximum real part of the eigenvalues of $A(\\kappa)$.\n\n### Step 3, 4, and 5: Implementation for Specific Geometries and Test Cases\n\n**Sphere Case:** The wavenumber squared is $\\kappa = \\frac{\\ell(\\ell+1)}{R^2}$ for integer mode numbers $\\ell \\geq 1$. We search over the given range of $\\ell$ to find $\\ell^*$ that maximizes the growth rate. The degeneracy (number of distinct spherical harmonics for a given $\\ell$) is $2\\ell^*+1$. The pattern is classified as \"stripes\" if $\\ell^*=1$ ($\\sigma=1$) and \"spots\" if $\\ell^* \\ge 2$ ($\\sigma=0$). This analysis also addresses the curvature bias requested in task 5, as the radius $R$ directly influences $\\kappa$ and thus the selection of $\\ell^*$.\n\n**Torus Case:** Using the thin-torus approximation, the wavenumber squared is $\\kappa \\approx \\frac{m^2}{r^2} + \\frac{n^2}{R^2}$ for integer mode numbers $(m,n)$, excluding $(0,0)$. We perform a 2D search over the given ranges of $m$ and $n$ to find the pair $(m^*, n^*)$ that maximizes the growth rate. The pattern is \"stripes\" if exactly one of $m^*$ or $n^*$ is zero ($\\sigma=1$), and \"spots\" if both are non-zero ($\\sigma=0$).\n\nFor all cases, if no mode with a positive growth rate is found within the search range, the result is \"no selection\" (represented by $[-1,0,-1]$ for the sphere and $[-1,-1,-1]$ for the torus).\n\nThe provided code will implement this logic for each test case listed in the problem statement.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases for Turing pattern formation.\n    \"\"\"\n\n    test_cases = [\n        # Case S1: Sphere, baseline\n        {'type': 'sphere', 'a': 0.2, 'b': 1.3, 'Du': 1e-4, 'Dv': 1e-2, 'R': 1.0, 'l_range': range(1, 41)},\n        # Case S2: Sphere, higher curvature\n        {'type': 'sphere', 'a': 0.2, 'b': 1.3, 'Du': 1e-4, 'Dv': 1e-2, 'R': 0.6, 'l_range': range(1, 41)},\n        # Case T1: Torus, stripes bias\n        {'type': 'torus',  'a': 0.2, 'b': 1.3, 'Du': 1e-4, 'Dv': 1e-2, 'R': 2.0, 'r': 0.3, 'm_range': range(0, 41), 'n_range': range(0, 41)},\n        # Case T2: Torus, near-isotropic\n        {'type': 'torus',  'a': 0.2, 'b': 1.3, 'Du': 1e-4, 'Dv': 1e-2, 'R': 0.8, 'r': 0.8, 'm_range': range(0, 41), 'n_range': range(0, 41)},\n        # Case S3: Sphere, no Turing instability\n        {'type': 'sphere', 'a': 0.2, 'b': 1.3, 'Du': 1e-4, 'Dv': 1e-4, 'R': 1.0, 'l_range': range(1, 41)},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate steady state and Jacobian elements based on kinetics.\n        a, b = case['a'], case['b']\n        u_star = a + b\n        \n        # Jacobian elements at the steady state (u*, v*)\n        # fu = (b-a)/(a+b), fv = (a+b)^2\n        # gu = -2b/(a+b),  gv = -(a+b)^2\n        fu = (b - a) / u_star\n        fv = u_star**2\n        gu = -2 * b / u_star\n        gv = -u_star**2\n\n        # Package parameters for the growth rate calculation function\n        params = {\n            'fu': fu, 'fv': fv, 'gu': gu, 'gv': gv,\n            'Du': case['Du'], 'Dv': case['Dv']\n        }\n\n        if case['type'] == 'sphere':\n            result = process_sphere(case, params)\n        elif case['type'] == 'torus':\n            result = process_torus(case, params)\n        results.append(result)\n\n    # Format and print the final output as a single line\n    result_str = \",\".join([f\"[{','.join(map(str, res))}]\" for res in results])\n    print(f\"[{result_str}]\")\n\ndef compute_growth_rate(kappa, fu, fv, gu, gv, Du, Dv):\n    \"\"\"\n    Computes the maximum real part of the eigenvalues of the stability matrix A(kappa).\n    \"\"\"\n    # Construct the stability matrix A(kappa) for a given mode kappa\n    A = np.array([\n        [fu - Du * kappa, fv],\n        [gu, gv - Dv * kappa]\n    ])\n    # Compute eigenvalues using numpy\n    eigenvalues = np.linalg.eigvals(A)\n    # The growth rate is the maximum of the real parts of the eigenvalues\n    return np.max(np.real(eigenvalues))\n\ndef process_sphere(case, params):\n    \"\"\"\n    Finds the dominant unstable mode for a spherical geometry.\n    \"\"\"\n    R = case['R']\n    max_growth_rate = -np.inf\n    l_star = -1\n\n    # Search over the integer mode number l\n    for l in case['l_range']:\n        # Calculate the wavenumber squared for the spherical mode l\n        kappa = l * (l + 1) / (R**2)\n        growth_rate = compute_growth_rate(kappa, **params)\n        \n        # Update if a larger growth rate is found\n        if growth_rate  max_growth_rate:\n            max_growth_rate = growth_rate\n            l_star = l\n\n    # If an unstable mode was found (max growth rate  0)\n    if max_growth_rate  1e-9: # Use a small tolerance for floating point  0 check\n        degeneracy = 2 * l_star + 1\n        # Classify pattern: 1 for stripes (l=1), 0 for spots (l=2)\n        sigma = 1 if l_star == 1 else 0\n        return [l_star, degeneracy, sigma]\n    else:\n        # No unstable mode found\n        return [-1, 0, -1]\n\ndef process_torus(case, params):\n    \"\"\"\n    Finds the dominant unstable mode for a toroidal geometry.\n    \"\"\"\n    R, r = case['R'], case['r']\n    max_growth_rate = -np.inf\n    m_star, n_star = -1, -1\n\n    # Search over integer mode numbers (m, n)\n    for m in case['m_range']:\n        for n in case['n_range']:\n            # The mode (0,0) corresponds to the homogeneous state and is excluded\n            if m == 0 and n == 0:\n                continue\n            \n            # Calculate the wavenumber squared using the thin-torus approximation\n            kappa = (m**2 / r**2) + (n**2 / R**2)\n            growth_rate = compute_growth_rate(kappa, **params)\n\n            # Update if a larger growth rate is found\n            if growth_rate  max_growth_rate:\n                max_growth_rate = growth_rate\n                m_star, n_star = m, n\n\n    # If an unstable mode was found\n    if max_growth_rate  1e-9: # Use a small tolerance\n        # Classify pattern: 1 for stripes (one index is zero), 0 for spots (both non-zero)\n        sigma = 1 if (m_star == 0 or n_star == 0) else 0\n        return [m_star, n_star, sigma]\n    else:\n        # No unstable mode found\n        return [-1, -1, -1]\n\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3356956"}]}