{"hands_on_practices": [{"introduction": "To truly grasp persistent homology, it's essential to first understand the mechanics of ordinary homology. This foundational exercise guides you through the core algebraic calculations that underpin all of topological data analysis. By manually constructing boundary matrices and computing Betti numbers for a simple, hypothetical simplicial complex, you will build a concrete understanding of how topological features are formally defined and counted.", "problem": "A small-scale Topological Data Analysis (TDA) task arises when modeling cell–cell similarity at a fixed scale in computational systems biology. Consider a Vietoris–Rips (VR) complex $K$ constructed over the finite field with two elements ($\\mathbb{F}_{2}$) from $5$ single-cell profiles embedded in a latent space, using a biologically plausible similarity threshold that produces the following simplices. The $0$-simplices (vertices) are $v_{1}, v_{2}, v_{3}, v_{4}, v_{5}$. The $1$-simplices (edges) are $e_{12}, e_{23}, e_{34}, e_{45}, e_{15}, e_{25}, e_{35}$. The $2$-simplices (triangles) are $\\tau_{125}, \\tau_{345}$. Assume no higher-dimensional simplices are present. Work over $\\mathbb{F}_{2}$ throughout.\n\nStarting only from the core definitions of simplicial homology, construct the boundary matrices for the boundary operators $\\partial_{1} : C_{1}(K;\\mathbb{F}_{2}) \\to C_{0}(K;\\mathbb{F}_{2})$ and $\\partial_{2} : C_{2}(K;\\mathbb{F}_{2}) \\to C_{1}(K;\\mathbb{F}_{2})$ with respect to the ordered bases $\\{v_{1}, v_{2}, v_{3}, v_{4}, v_{5}\\}$ for $C_{0}(K;\\mathbb{F}_{2})$, $\\{e_{12}, e_{23}, e_{34}, e_{45}, e_{15}, e_{25}, e_{35}\\}$ for $C_{1}(K;\\mathbb{F}_{2})$, and $\\{\\tau_{125}, \\tau_{345}\\}$ for $C_{2}(K;\\mathbb{F}_{2})$. Using only these matrices and the standard definitions of homology over $\\mathbb{F}_{2}$, verify the ranks needed to determine the first homology group $H_{1}(K;\\mathbb{F}_{2})$.\n\nReport the Betti number $\\beta_{1} = \\operatorname{rank} H_{1}(K;\\mathbb{F}_{2})$ as a single integer. No rounding is required.", "solution": "The problem requires the computation of the first Betti number, $\\beta_{1}$, for a given simplicial complex $K$ over the finite field $\\mathbb{F}_{2}$. The first homology group $H_{1}(K; \\mathbb{F}_{2})$ is defined as the quotient of the vector space of $1$-cycles, $Z_{1}(K; \\mathbb{F}_{2})$, by the vector space of $1$-boundaries, $B_{1}(K; \\mathbb{F}_{2})$.\n$$H_{1}(K; \\mathbb{F}_{2}) = Z_{1}(K; \\mathbb{F}_{2}) / B_{1}(K; \\mathbb{F}_{2})$$\nThe Betti number $\\beta_{1}$ is the dimension of this quotient space:\n$$\\beta_{1} = \\dim(H_{1}(K; \\mathbb{F}_{2})) = \\dim(Z_{1}(K; \\mathbb{F}_{2})) - \\dim(B_{1}(K; \\mathbb{F}_{2}))$$\n\nThe space of $1$-cycles, $Z_{1}$, is the kernel of the boundary operator $\\partial_{1}: C_{1}(K; \\mathbb{F}_{2}) \\to C_{0}(K; \\mathbb{F}_{2})$, and the space of $1$-boundaries, $B_{1}$, is the image of the boundary operator $\\partial_{2}: C_{2}(K; \\mathbb{F}_{2}) \\to C_{1}(K; \\mathbb{F}_{2})$.\nThus, we have:\n$\\dim(Z_{1}(K; \\mathbb{F}_{2})) = \\dim(\\ker \\partial_{1})$\n$\\dim(B_{1}(K; \\mathbb{F}_{2})) = \\dim(\\operatorname{im} \\partial_{2})$\n\nUsing the rank-nullity theorem for the linear map $\\partial_{1}$, we have $\\dim(C_{1}) = \\dim(\\ker \\partial_{1}) + \\dim(\\operatorname{im} \\partial_{1})$. Therefore, $\\dim(\\ker \\partial_{1}) = \\dim(C_{1}) - \\operatorname{rank}(\\partial_{1})$. The rank of an operator is the dimension of its image.\nSubstituting these into the expression for $\\beta_{1}$:\n$$\\beta_{1} = (\\dim(C_{1}) - \\operatorname{rank}(\\partial_{1})) - \\operatorname{rank}(\\partial_{2})$$\nThe problem specifies the bases for the chain groups, so their dimensions are known. $\\dim(C_{2}) = 2$, $\\dim(C_{1}) = 7$, and $\\dim(C_{0}) = 5$. Our task reduces to constructing the matrix representations of $\\partial_{2}$ and $\\partial_{1}$ and finding their ranks.\n\nFirst, we construct the matrix for $\\partial_{2} : C_{2}(K;\\mathbb{F}_{2}) \\to C_{1}(K;\\mathbb{F}_{2})$. The basis for $C_{2}$ is $\\{\\tau_{125}, \\tau_{345}\\}$ and for $C_{1}$ is $\\{e_{12}, e_{23}, e_{34}, e_{45}, e_{15}, e_{25}, e_{35}\\}$. The boundary of a $p$-simplex $[v_{i_{0}}, \\dots, v_{i_{p}}]$ is $\\sum_{j=0}^{p} (-1)^{j} [v_{i_{0}}, \\dots, \\widehat{v_{i_{j}}}, \\dots, v_{i_{p}}]$. Working in $\\mathbb{F}_{2}$, this simplifies to the sum of all $(p-1)$-faces, since $-1 \\equiv 1 \\pmod 2$.\n\nThe boundary of the first basis element of $C_{2}$ is:\n$\\partial_{2}(\\tau_{125}) = \\partial_{2}([v_{1}, v_{2}, v_{5}]) = [v_{2}, v_{5}] + [v_{1}, v_{5}] + [v_{1}, v_{2}] = e_{25} + e_{15} + e_{12}$.\nThe boundary of the second basis element of $C_{2}$ is:\n$\\partial_{2}(\\tau_{345}) = \\partial_{2}([v_{3}, v_{4}, v_{5}]) = [v_{4}, v_{5}] + [v_{3}, v_{5}] + [v_{3}, v_{4}] = e_{45} + e_{35} + e_{34}$.\n\nThe matrix representation of $\\partial_2$, denoted $D_2$, has columns corresponding to the images of the $C_2$ basis vectors. Its dimensions are $\\dim(C_1) \\times \\dim(C_2) = 7 \\times 2$.\n$$D_{2} =\n\\begin{pmatrix}\n1  0 \\\\\n0  0 \\\\\n0  1 \\\\\n0  1 \\\\\n1  0 \\\\\n1  0 \\\\\n0  1\n\\end{pmatrix}\n\\begin{matrix} \\\n\\leftarrow e_{12} \\\\ \\leftarrow e_{23} \\\\ \\leftarrow e_{34} \\\\ \\leftarrow e_{45} \\\\ \\leftarrow e_{15} \\\\ \\leftarrow e_{25} \\\\ \\leftarrow e_{35} \\end{matrix}\n$$\nThe two columns are linearly independent over $\\mathbb{F}_{2}$ because they have non-zero entries in disjoint sets of rows for rows $1, 5, 6$ versus rows $3, 4, 7$. Therefore, the rank of this matrix is $2$.\n$\\operatorname{rank}(\\partial_{2}) = \\operatorname{rank}(D_{2}) = 2$.\n\nNext, we construct the matrix for $\\partial_{1} : C_{1}(K;\\mathbb{F}_{2}) \\to C_{0}(K;\\mathbb{F}_{2})$. The basis for $C_{1}$ is $\\{e_{12}, e_{23}, e_{34}, e_{45}, e_{15}, e_{25}, e_{35}\\}$ and for $C_{0}$ is $\\{v_{1}, v_{2}, v_{3}, v_{4}, v_{5}\\}$.\nThe boundary of an edge $[v_{i}, v_{j}]$ is $v_{j} + v_{i}$ (in $\\mathbb{F}_{2}$).\n$\\partial_{1}(e_{12}) = v_{1} + v_{2}$\n$\\partial_{1}(e_{23}) = v_{2} + v_{3}$\n$\\partial_{1}(e_{34}) = v_{3} + v_{4}$\n$\\partial_{1}(e_{45}) = v_{4} + v_{5}$\n$\\partial_{1}(e_{15}) = v_{1} + v_{5}$\n$\\partial_{1}(e_{25}) = v_{2} + v_{5}$\n$\\partial_{1}(e_{35}) = v_{3} + v_{5}$\n\nThe matrix representation of $\\partial_1$, denoted $D_1$, has dimensions $\\dim(C_0) \\times \\dim(C_1) = 5 \\times 7$.\n$$D_{1} =\n\\begin{pmatrix}\n1  0  0  0  1  0  0 \\\\\n1  1  0  0  0  1  0 \\\\\n0  1  1  0  0  0  1 \\\\\n0  0  1  1  0  0  0 \\\\\n0  0  0  1  1  1  1\n\\end{pmatrix}$$\nTo find the rank of $D_{1}$, we perform Gaussian elimination over $\\mathbb{F}_{2}$ to bring it to row echelon form. Let $R_{i}$ denote the $i$-th row.\n$$\n\\begin{pmatrix}\n1  0  0  0  1  0  0 \\\\\n1  1  0  0  0  1  0 \\\\\n0  1  1  0  0  0  1 \\\\\n0  0  1  1  0  0  0 \\\\\n0  0  0  1  1  1  1\n\\end{pmatrix}\n\\xrightarrow{R_{2} \\leftarrow R_{2} + R_{1}}\n\\begin{pmatrix}\n1  0  0  0  1  0  0 \\\\\n0  1  0  0  1  1  0 \\\\\n0  1  1  0  0  0  1 \\\\\n0  0  1  1  0  0  0 \\\\\n0  0  0  1  1  1  1\n\\end{pmatrix}\n$$\n$$\n\\xrightarrow{R_{3} \\leftarrow R_{3} + R_{2}}\n\\begin{pmatrix}\n1  0  0  0  1  0  0 \\\\\n0  1  0  0  1  1  0 \\\\\n0  0  1  0  1  1  1 \\\\\n0  0  1  1  0  0  0 \\\\\n0  0  0  1  1  1  1\n\\end{pmatrix}\n\\xrightarrow{R_{4} \\leftarrow R_{4} + R_{3}}\n\\begin{pmatrix}\n1  0  0  0  1  0  0 \\\\\n0  1  0  0  1  1  0 \\\\\n0  0  1  0  1  1  1 \\\\\n0  0  0  1  1  1  1 \\\\\n0  0  0  1  1  1  1\n\\end{pmatrix}\n$$\n$$\n\\xrightarrow{R_{5} \\leftarrow R_{5} + R_{4}}\n\\begin{pmatrix}\n1  0  0  0  1  0  0 \\\\\n0  1  0  0  1  1  0 \\\\\n0  0  1  0  1  1  1 \\\\\n0  0  0  1  1  1  1 \\\\\n0  0  0  0  0  0  0\n\\end{pmatrix}\n$$\nThe resulting matrix in row echelon form has $4$ non-zero rows, so its rank is $4$.\n$\\operatorname{rank}(\\partial_{1}) = \\operatorname{rank}(D_{1}) = 4$.\n\nNow we have all the necessary components to calculate $\\beta_{1}$.\n$\\dim(C_{1}) = 7$\n$\\operatorname{rank}(\\partial_{1}) = 4$\n$\\operatorname{rank}(\\partial_{2}) = 2$\n\nSubstituting these values into the formula for the Betti number:\n$$\\beta_{1} = \\dim(C_{1}) - \\operatorname{rank}(\\partial_{1}) - \\operatorname{rank}(\\partial_{2}) = 7 - 4 - 2 = 1$$\n\nThe first Betti number is $1$. This indicates the presence of one independent $1$-dimensional \"hole\" in the simplicial complex $K$.", "answer": "$$\n\\boxed{1}\n$$", "id": "3355925"}, {"introduction": "After computing topological summaries like persistence diagrams, the next critical step is to quantify the differences between them. This practice explores two of the most important metrics used for this purpose: the bottleneck distance ($d_B$) and the Wasserstein distance ($W_1$). Working through a small, illustrative example of comparing features from two hypothetical experimental conditions will provide you with practical intuition about how these distances work and help you reason about which metric is best suited for distinguishing meaningful biological signals from noise.", "problem": "Two experimental conditions in spatial transcriptomics produce two sets of one-dimensional homological features derived from a Vietoris–Rips filtration on cell-to-cell distances, analyzed using Topological Data Analysis (TDA). The resulting persistence diagrams record birth–death pairs of loop-like structures that reflect stable tissue domains (long-lived features) and transient measurement fluctuations (short-lived features). Consider the two persistence diagrams\n$$D_A = \\{(0.05,\\,0.70),\\,(0.30,\\,0.35)\\} \\quad \\text{and} \\quad D_B = \\{(0.06,\\,0.71),\\,(0.48,\\,0.50)\\}.$$\nUse the $L^{\\infty}$ ground metric for matching: the cost to match two off-diagonal points $(b,\\,d)$ and $(b',\\,d')$ is $\\max\\!\\big(|b-b'|,\\,|d-d'|\\big)$, and the cost to match an off-diagonal point $(b,\\,d)$ to the diagonal is $(d-b)/2$. The bottleneck distance $d_B$ is defined as the infimum of the maximum matching cost over bijections between the two diagrams augmented by infinitely many diagonal points; the $1$-Wasserstein distance $W_1$ is the infimum of the sum of matching costs over such bijections.\n\nCompute $d_B(D_A,D_B)$ and $W_1(D_A,D_B)$ exactly by solving the matching problem. Then, using the biological interpretation that the long-lived feature corresponds to a stable tissue domain while the short-lived features are noise-like, justify which metric better reflects meaningful biological variation in this example.\n\nExpress the final numerical results as a row matrix $\\big[d_B,\\,W_1\\big]$ with no rounding.", "solution": "To compute the bottleneck distance ($d_B$) and the 1-Wasserstein distance ($W_1$) between the persistence diagrams $D_A$ and $D_B$, we must find the optimal bijection (matching) between their points, allowing points to be matched to the diagonal $\\Delta$. The cost of the matching is determined by the $L^\\infty$ ground metric.\n\nFirst, we identify the points in each persistence diagram.\nFor diagram $D_A = \\{p_1, p_2\\}$:\n-   $p_1 = (0.05, 0.70)$: a long-lived feature (signal).\n-   $p_2 = (0.30, 0.35)$: a short-lived feature (noise).\n\nFor diagram $D_B = \\{q_1, q_2\\}$:\n-   $q_1 = (0.06, 0.71)$: a long-lived feature (signal).\n-   $q_2 = (0.48, 0.50)$: a short-lived feature (noise).\n\nNext, we compute the costs of all possible pairings between points and with the diagonal. The cost of matching a point $(b,d)$ to the diagonal is $C((b,d), \\Delta) = (d-b)/2$.\n-   $C(p_1, \\Delta) = (0.70 - 0.05)/2 = 0.325$.\n-   $C(p_2, \\Delta) = (0.35 - 0.30)/2 = 0.025$.\n-   $C(q_1, \\Delta) = (0.71 - 0.06)/2 = 0.325$.\n-   $C(q_2, \\Delta) = (0.50 - 0.48)/2 = 0.01$.\n\nThe cost of matching two off-diagonal points is their $L^{\\infty}$ distance, $C((b,d), (b',d')) = \\max(|b-b'|, |d-d'|)$.\n-   $C(p_1, q_1) = \\max(|0.05 - 0.06|, |0.70 - 0.71|) = \\max(0.01, 0.01) = 0.01$.\n-   $C(p_1, q_2) = \\max(|0.05 - 0.48|, |0.70 - 0.50|) = \\max(0.43, 0.20) = 0.43$.\n-   $C(p_2, q_1) = \\max(|0.30 - 0.06|, |0.35 - 0.71|) = \\max(0.24, 0.36) = 0.36$.\n-   $C(p_2, q_2) = \\max(|0.30 - 0.48|, |0.35 - 0.50|) = \\max(0.18, 0.15) = 0.18$.\n\nWe now find the optimal bijection. By inspection, the lowest-cost matching pairs the two signal points ($p_1, q_1$) and treats the two noise points ($p_2, q_2$) as unmatched by pairing them with the diagonal. Let's call this matching $\\gamma_{\\text{opt}} = \\{(p_1, q_1), (p_2, \\Delta), (\\Delta, q_2)\\}$. The set of costs for this matching is $\\{C(p_1, q_1), C(p_2, \\Delta), C(q_2, \\Delta)\\} = \\{0.01, 0.025, 0.01\\}$. Any other matching would involve a much higher cost, such as $C(p_2, q_2) = 0.18$ or $C(p_1, \\Delta) = 0.325$. Thus, $\\gamma_{\\text{opt}}$ is the optimal matching for both bottleneck and Wasserstein distances.\n\nNow, we compute the distances based on this optimal matching:\n-   **Bottleneck distance ($d_B$)**: This is the maximum cost in the optimal matching.\n    $$d_B(D_A, D_B) = \\max(0.01, 0.025, 0.01) = 0.025$$\n-   **1-Wasserstein distance ($W_1$)**: This is the sum of costs in the optimal matching.\n    $$W_1(D_A, D_B) = 0.01 + 0.025 + 0.01 = 0.045$$\n\nFinally, we justify which metric better reflects meaningful biological variation.\nMeaningful variation corresponds to changes in the stable features (signal), while changes in transient features are considered noise. In our optimal matching, the cost associated with the meaningful signal variation is $C(p_1, q_1) = 0.01$. The costs associated with ignoring the noise are $C(p_2, \\Delta) = 0.025$ and $C(q_2, \\Delta) = 0.01$.\n\nThe bottleneck distance $d_B = 0.025$ is determined solely by the cost of removing the noisiest feature in $D_A$. It is insensitive to the small change in the stable feature ($0.01$) because that cost is smaller. This means $d_B$ is dominated by noise in this case.\n\nThe 1-Wasserstein distance $W_1 = 0.045$, being a sum, incorporates contributions from all parts of the optimal matching: the change in the stable feature ($0.01$) and the costs of removing both noise features ($0.025$ and $0.01$). It provides a more holistic measure of the difference.\n\nTherefore, the $W_1$ distance better reflects the meaningful biological variation in this scenario because its value is influenced by the change in the stable feature, whereas the $d_B$ distance is determined entirely by a noise feature and is blind to the change in the signal.\n\nThe final numerical results are $d_B = 0.025$ and $W_1 = 0.045$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.025  0.045 \\end{pmatrix} } $$", "id": "3355848"}, {"introduction": "A single TDA result is insightful, but robust biological conclusions require statistical evidence across multiple replicates. This final practice bridges the gap from individual topological summaries to rigorous group-level statistical inference. You will learn to convert persistence barcodes into persistence landscapes, a stable functional representation, and then perform a functional $t$-test to assess the statistical significance of differences between two groups of samples, completing the full TDA workflow.", "problem": "You are given two groups of barcodes representing intervals from persistent homology computed on biological datasets in a Topological Data Analysis (TDA) workflow. Each barcode is a multiset of birth-death intervals, which are the output of a filtration applied to a point cloud or network derived from biological measurements. Define the persistence landscape functions for each replicate, estimate group-wise mean landscape functions, and perform a functional two-sample $t$-test with variance regularization. Return three quantifiable metrics per test case as floats.\n\nFundamental base and definitions:\n- Topological Data Analysis (TDA) uses filtrations to produce a sequence of simplicial complexes capturing structure across a scale parameter; Persistent Homology computes homology groups across the filtration, yielding barcodes as multisets of intervals $(b_i, d_i)$ where $b_i$ and $d_i$ denote the birth and death scale values of a topological feature.\n- For a barcode $\\mathcal{B} = \\{(b_i, d_i)\\}_{i=1}^m$ with $b_i  d_i$, define the piecewise-linear \"tent\" function for each interval $i$ by\n$$\nf_i(t) = \\max\\left(0, \\min\\left(t - b_i, d_i - t\\right)\\right).\n$$\n- The $k$-th persistence landscape function $\\lambda_k(t)$ is defined pointwise as the $k$-th largest value among the collection $\\{f_i(t)\\}_{i=1}^m$. If fewer than $k$ tents are nonzero at $t$, then $\\lambda_k(t) = 0$.\n- Given $n$ replicates in a group, with landscapes $\\lambda_{k}^{(j)}(t)$ for replicate $j \\in \\{1,\\dots,n\\}$, the group mean for landscape level $k$ is\n$$\n\\bar{\\lambda}_k(t) = \\frac{1}{n} \\sum_{j=1}^n \\lambda_{k}^{(j)}(t).\n$$\n- For a functional $t$-test comparing two groups with sizes $n_1$ and $n_2$ at each grid point $t$, define the pointwise difference for the first landscape level as\n$$\n\\delta(t) = \\bar{\\lambda}^{(2)}_1(t) - \\bar{\\lambda}^{(1)}_1(t),\n$$\nand the regularized pooled standard error\n$$\ns_{\\text{pool}}(t) = \\sqrt{ \\frac{s_1^2(t)}{n_1} + \\frac{s_2^2(t)}{n_2} + \\epsilon^2 },\n$$\nwhere $s_g^2(t)$ is the unbiased sample variance across replicates of group $g$ at time $t$, and $\\epsilon$ is a variance regularization floor chosen as\n$$\n\\epsilon = \\gamma \\cdot \\mathrm{median}\\left( \\sqrt{ \\frac{s_1^2(t)}{n_1} + \\frac{s_2^2(t)}{n_2} } \\right),\n$$\nwith $\\gamma = 0.1$, and if the median equals $0$, use the fallback $\\epsilon = 10^{-8}$. The pointwise $t$-statistic is\n$$\nt(t) = \\frac{\\delta(t)}{s_{\\text{pool}}(t)}.\n$$\n- Aggregate the pointwise statistic into a global metric by the $L^2$ norm over the grid:\n$$\nT_{\\text{global}} = \\left( \\int t(t)^2 \\, dt \\right)^{1/2}.\n$$\n- Also compute the $L^2$ norms of the group mean differences for $k = 1$ and $k = 2$:\n$$\n\\|\\delta_k\\|_2 = \\left( \\int \\left( \\bar{\\lambda}^{(2)}_k(t) - \\bar{\\lambda}^{(1)}_k(t) \\right)^2 dt \\right)^{1/2}.\n$$\n\nNumerical implementation requirements:\n- Approximate all functions on a uniform grid $t$ spanning the union of supports of all intervals across both groups. Choose $M = 401$ equally spaced points between $T_{\\min}$ and $T_{\\max}$, where $T_{\\min}$ is the minimum birth across all intervals and $T_{\\max}$ is the maximum death across all intervals; if no intervals exist in a test case, set $T_{\\min} = 0$ and $T_{\\max} = 1$. Expand the interval by a margin of $5\\%$ of the range on each side (if the range is $0$, use a margin of $0.05$). Use $K = 2$ landscape levels. Use $\\gamma = 0.1$ for regularization as defined above.\n- Use trapezoidal numerical integration to approximate all integrals.\n- Handle boundary cases: empty barcodes, single replicate per group (in which case set $s_g^2(t) = 0$), and fewer than $K$ intervals (pad landscapes with zeros).\n- Express all outputs in unitless floats. No physical units are involved.\n\nTest suite:\nFor each test case, you are given two groups: control and treated. Each group consists of replicates, and each replicate is a list of intervals $(b, d)$.\n\n- Test case $1$ (general case with treated having longer lifetimes):\n  - Control replicates:\n    - Replicate $1$: $(0.1, 0.9)$, $(0.2, 1.0)$, $(0.5, 1.4)$\n    - Replicate $2$: $(0.05, 0.8)$, $(0.3, 1.1)$\n    - Replicate $3$: $(0.2, 0.95)$, $(0.6, 1.3)$, $(0.7, 1.5)$\n  - Treated replicates:\n    - Replicate $1$: $(0.1, 1.2)$, $(0.25, 1.3)$, $(0.5, 1.7)$\n    - Replicate $2$: $(0.05, 1.0)$, $(0.3, 1.4)$\n    - Replicate $3$: $(0.2, 1.05)$, $(0.6, 1.6)$, $(0.7, 1.9)$\n\n- Test case $2$ (boundary case with empty and identical barcodes):\n  - Control replicates:\n    - Replicate $1$: no intervals\n    - Replicate $2$: $(0.4, 0.45)$\n  - Treated replicates:\n    - Replicate $1$: no intervals\n    - Replicate $2$: $(0.4, 0.45)$\n\n- Test case $3$ (edge case with many short control intervals and a long treated interval):\n  - Control replicates:\n    - Replicate $1$: $(0.1, 0.15)$, $(0.2, 0.25)$, $(0.3, 0.35)$\n    - Replicate $2$: $(0.12, 0.2)$, $(0.22, 0.28)$\n  - Treated replicates:\n    - Replicate $1$: $(0.1, 1.2)$, $(0.2, 0.25)$\n    - Replicate $2$: $(0.05, 1.0)$\n\nRequired outputs per test case:\n- Compute three floats:\n  $[\\|\\delta_1\\|_2, \\|\\delta_2\\|_2, T_{\\text{global}}]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes an inner list. For example, print\n$[[\\|\\delta_1\\|_2^{(1)},\\|\\delta_2\\|_2^{(1)},T_{\\text{global}}^{(1)},{\\dots}],[\\dots],[\\dots]]$\nwith no spaces in the printed list.", "solution": "The problem requires the implementation of a statistical comparison between two groups of persistence barcodes derived from biological data. The methodology is based on persistence landscapes, a stable vector representation of persistence diagrams, and a functional two-sample $t$-test. The procedure involves several computational steps, from vectorizing the barcodes to calculating final statistical metrics. The process is deterministic and founded on established principles of Topological Data Analysis (TDA).\n\nThe solution is implemented by following these sequential steps:\n\n1.  **Grid Discretization**: All functions are approximated on a discrete grid. For each test case, we first collect all birth times $b_i$ and death times $d_i$ from all intervals across all replicates of both groups. We find the global minimum birth time, $T_{\\min}$, and the global maximum death time, $T_{\\max}$. If no intervals exist in the entire dataset, we use the default range $[0, 1]$. The range of the grid is $R = T_{\\max} - T_{\\min}$. A margin of $5\\%$ of the range is added to each end to avoid boundary effects. If the range $R=0$, a fixed margin of $0.05$ is used. A uniform grid of $M=401$ points, denoted by $\\{t_j\\}_{j=1}^{M}$, is constructed over this expanded interval $[T_{\\min} - 0.05R, T_{\\max} + 0.05R]$. The step size is $dt = t_{j+1} - t_j$.\n\n2.  **Persistence Landscape Generation**: For each replicate within each group, we compute its persistence landscapes. A replicate's barcode is a multiset of intervals $\\mathcal{B} = \\{(b_i, d_i)\\}_{i=1}^m$.\n    *   For each interval $(b_i, d_i)$, we calculate its corresponding \"tent\" function, $f_i(t) = \\max(0, \\min(t - b_i, d_i - t))$, over the discrete grid $\\{t_j\\}$. This results in a set of $m$ vectors, one for each interval.\n    *   The $k$-th persistence landscape function, $\\lambda_k(t)$, is defined as the $k$-th largest value among the set of tent function values $\\{f_i(t)\\}_{i=1}^m$ at each point $t$ on the grid. To compute this, for each grid point $t_j$, we sort the values $\\{f_i(t_j)\\}_{i=1}^m$ in descending order. The $k$-th value in this sorted list is $\\lambda_k(t_j)$. If there are fewer than $k$ intervals (i.e., $mk$), then $\\lambda_k(t)$ is zero for all $t$. We compute landscapes for $k=1, \\dots, K$, where $K=2$.\n    *   If a replicate contains no intervals, its landscapes $\\lambda_k(t)$ are identically zero for all $k$ and $t$.\n\n3.  **Group-Level Statistics Calculation**: After generating landscapes for all replicates, we compute group-level statistics. Let group $g \\in \\{1, 2\\}$ have $n_g$ replicates, with landscapes $\\lambda_{k}^{(g,j)}(t)$ for replicate $j \\in \\{1, \\dots, n_g\\}$.\n    *   The group mean landscape for level $k$ is calculated pointwise as the average over the replicates:\n        $$\n        \\bar{\\lambda}_k^{(g)}(t) = \\frac{1}{n_g} \\sum_{j=1}^{n_g} \\lambda_k^{(g,j)}(t).\n        $$\n    *   The unbiased sample variance of the landscapes at level $k$ is also computed pointwise:\n        $$\n        s_g^2(t; k) = \\frac{1}{n_g-1} \\sum_{j=1}^{n_g} \\left( \\lambda_k^{(g,j)}(t) - \\bar{\\lambda}_k^{(g)}(t) \\right)^2.\n        $$\n        If a group has only one replicate ($n_g=1$), the variance is defined to be $0$ for all $t$. For the $t$-test, we only need the variance for the first landscape, $s_g^2(t; 1)$.\n\n4.  **Computation of Output Metrics**: Three metrics are required: the $L^2$ norms of the mean differences for the first two landscapes, and a global $t$-statistic.\n    *   **$L^2$ Norms of Mean Differences**: For $k=1$ and $k=2$, we compute the difference between the group mean landscapes, $\\delta_k(t) = \\bar{\\lambda}^{(2)}_k(t) - \\bar{\\lambda}^{(1)}_k(t)$. The $L^2$ norm is then approximated using the trapezoidal rule for numerical integration:\n        $$\n        \\|\\delta_k\\|_2 = \\left( \\int \\left( \\delta_k(t) \\right)^2 dt \\right)^{1/2} \\approx \\left( \\sum_{j=1}^{M-1} \\frac{(\\delta_k(t_j))^2 + (\\delta_k(t_{j+1}))^2}{2} \\cdot dt \\right)^{1/2}.\n        $$\n    *   **Global $t$-statistic $T_{\\text{global}}$**: This metric is derived from a functional two-sample $t$-test on the first landscape ($k=1$).\n        1.  The pointwise difference is $\\delta_1(t) = \\bar{\\lambda}^{(2)}_1(t) - \\bar{\\lambda}^{(1)}_1(t)$.\n        2.  The regularized pooled standard error, $s_{\\text{pool}}(t)$, is calculated. First, we compute the unregularized term $\\sqrt{ \\frac{s_1^2(t; 1)}{n_1} + \\frac{s_2^2(t; 1)}{n_2} }$. Let this be $s_{\\text{unreg}}(t)$.\n        3.  The regularization parameter $\\epsilon$ is determined: $\\epsilon = \\gamma \\cdot \\mathrm{median}\\{s_{\\text{unreg}}(t_j)\\}_{j=1}^M$, with $\\gamma=0.1$. A fallback of $\\epsilon=10^{-8}$ is used if the median is zero.\n        4.  The regularized standard error is then $s_{\\text{pool}}(t) = \\sqrt{ \\frac{s_1^2(t; 1)}{n_1} + \\frac{s_2^2(t; 1)}{n_2} + \\epsilon^2 }$. The inclusion of $\\epsilon$ prevents division by zero in regions of low variance.\n        5.  The pointwise $t$-statistic is $t(t) = \\frac{\\delta_1(t)}{s_{\\text{pool}}(t)}$.\n        6.  Finally, the global statistic $T_{\\text{global}}$ is the $L^2$ norm of the $t(t)$ function, again approximated with the trapezoidal rule:\n            $$\n            T_{\\text{global}} = \\left( \\int (t(t))^2 \\, dt \\right)^{1/2}.\n            $$\n\nThis entire procedure is applied to each test case, yielding the three specified floating-point values.", "answer": "[[0.2227192997,0.1804300300,5.7749005952],[0.0000000000,0.0000000000,0.0000000000],[0.4907955513,0.0898495039,7.4423087364]]", "id": "3355833"}]}