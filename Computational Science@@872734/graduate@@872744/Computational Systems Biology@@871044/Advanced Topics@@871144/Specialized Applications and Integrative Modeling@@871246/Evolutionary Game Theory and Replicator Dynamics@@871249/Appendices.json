{"hands_on_practices": [{"introduction": "In many biological scenarios, multiple strategies can be evolutionarily stable. This raises a critical question: which stable state will the population converge to? This exercise delves into the dynamics of a two-strategy coordination game, a common model for cooperative behaviors. By analyzing the replicator equation, you will discover a deep connection between the basins of attraction of the stable equilibria and the game-theoretic concept of risk dominance [@problem_id:3307090]. This practice illuminates how population dynamics provide a powerful mechanism for equilibrium selection, favoring the strategy that is more resilient to uncertainty.", "problem": "Consider a well-mixed microbial population in computational systems biology where cells adopt one of two signaling strategies, denoted by $A$ and $B$. Interactions are pairwise and symmetric, and the payoff to a focal cell depends only on the focal and partner strategies according to the following payoff matrix for the focal cell:\n$$\nA = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix},\n$$\nwhere $a$, $b$, $c$, and $d$ are real constants representing interaction payoffs. Assume a coordination regime with two pure-strategy equilibria, meaning $ac$ and $db$. Let $x \\in [0,1]$ denote the population fraction using strategy $A$.\n\nFitness is an affine function of payoff under weak selection: for selection intensity $w \\in (0,1)$, the fitness of a cell using strategy $i \\in \\{A,B\\}$ is $f_{i}(x) = 1 - w + w\\,\\pi_{i}(x)$, where $\\pi_{A}(x) = a x + b (1-x)$ and $\\pi_{B}(x) = c x + d (1-x)$. The population dynamics follow the replicator equation $\\dot{x} = x\\,(f_{A}(x) - \\bar{f}(x))$, where $\\bar{f}(x)$ is the average fitness in the population.\n\nStarting from these definitions and assumptions, derive from first principles the analytic expression for the fraction of initial population states $x(0) \\in [0,1]$ (drawn uniformly at random) that converge to the $A$-monomorphic equilibrium under the replicator dynamics in the weak selection limit $w \\to 0^{+}$. Express your final answer purely in terms of $a$, $b$, $c$, and $d$ as a closed-form expression. No intermediate formulas should be stated in the answer. No rounding is required, and no units are to be included in the expression. In your derivation, justify why the weak selection limit identifies the equilibrium with the larger basin of attraction and explain, in terms of the basin boundary, how this connects to risk-dominance in a symmetric $2 \\times 2$ coordination game without directly invoking pre-formed selection criteria.", "solution": "The problem asks for the fraction of initial population states that converge to the A-monomorphic equilibrium under replicator dynamics in a symmetric $2 \\times 2$ coordination game. This fraction corresponds to the normalized size of the basin of attraction of the equilibrium where the population consists entirely of strategy A users.\n\nFirst, we formalize the replicator equation based on the provided definitions. The population state is given by $x$, the fraction of individuals using strategy A, where $x \\in [0,1]$. The dynamics are described by $\\dot{x} = x(f_{A}(x) - \\bar{f}(x))$, where $f_{A}(x)$ is the fitness of strategy A users and $\\bar{f}(x)$ is the average fitness in the population.\n\nThe average fitness is defined as $\\bar{f}(x) = x f_{A}(x) + (1-x) f_{B}(x)$. Substituting this into the replicator equation yields:\n$$\n\\dot{x} = x(f_{A}(x) - [x f_{A}(x) + (1-x) f_{B}(x)])\n$$\n$$\n\\dot{x} = x( (1-x)f_{A}(x) - (1-x)f_{B}(x) )\n$$\n$$\n\\dot{x} = x(1-x)(f_{A}(x) - f_{B}(x))\n$$\nThis form of the replicator equation shows that the change in the fraction $x$ is proportional to the difference in fitness between the two strategies.\n\nThe fitness functions are given as $f_{i}(x) = 1 - w + w\\,\\pi_{i}(x)$, where $w \\in (0,1)$ is the selection intensity. The difference in fitness is:\n$$\nf_{A}(x) - f_{B}(x) = (1 - w + w\\,\\pi_{A}(x)) - (1 - w + w\\,\\pi_{B}(x)) = w(\\pi_{A}(x) - \\pi_{B}(x))\n$$\nThe expected payoffs $\\pi_A(x)$ and $\\pi_B(x)$ are:\n$$\n\\pi_{A}(x) = a x + b (1-x)\n$$\n$$\n\\pi_{B}(x) = c x + d (1-x)\n$$\nThe difference in expected payoffs is:\n$$\n\\pi_{A}(x) - \\pi_{B}(x) = (ax + b(1-x)) - (cx + d(1-x)) = (a-c)x - (d-b)(1-x) = (a-c+d-b)x - (d-b)\n$$\nSubstituting this back into the replicator equation gives the full dynamic equation for $x$:\n$$\n\\dot{x} = w x(1-x)[(a-c+d-b)x - (d-b)]\n$$\nThe fixed points of the dynamics are the values of $x$ for which $\\dot{x}=0$. From the equation, we can identify three such points:\n1.  $x^* = 0$, the B-monomorphic equilibrium.\n2.  $x^* = 1$, the A-monomorphic equilibrium.\n3.  An interior fixed point, $x_{int}$, where the term in square brackets is zero:\n    $$\n    (a-c+d-b)x_{int} - (d-b) = 0\n    $$\n    Solving for $x_{int}$ yields:\n    $$\n    x_{int} = \\frac{d-b}{a-c+d-b}\n    $$\nThe problem states that we are in a coordination regime where $ac$ and $db$. These conditions ensure that $x_{int}$ lies strictly between $0$ and $1$. The numerator $d-b$ is positive, and the denominator $(a-c)+(d-b)$ is also positive. Thus, $x_{int}  0$. Also, $d-b  (a-c)+(d-b)$ since $a-c  0$, which implies $x_{int}  1$.\n\nNext, we analyze the stability of these fixed points to determine the basins of attraction. The sign of $\\dot{x}$ for $x \\in (0,1)$ is determined by the sign of the polynomial $P(x) = (a-c+d-b)x - (d-b)$. This is a linear function of $x$ with a positive slope (since $a-c+d-b  0$) and a root at $x=x_{int}$.\n- For $x \\in (0, x_{int})$, we have $P(x)  0$, which means $\\dot{x}  0$. Trajectories starting in this interval will move towards $x=0$.\n- For $x \\in (x_{int}, 1)$, we have $P(x)  0$, which means $\\dot{x}  0$. Trajectories starting in this interval will move towards $x=1$.\n\nThis analysis shows that the monomorphic equilibria $x^*=0$ and $x^*=1$ are stable fixed points (attractors), while the interior fixed point $x_{int}$ is unstable (a repellor). The point $x_{int}$ acts as a separatrix, dividing the state space $[0,1]$ into two basins of attraction.\n- The basin of attraction for the B-monomorphic equilibrium ($x^*=0$) is the interval $[0, x_{int})$.\n- The basin of attraction for the A-monomorphic equilibrium ($x^*=1$) is the interval $(x_{int}, 1]$.\n\nThe problem asks for the fraction of initial states $x(0)$, drawn uniformly at random from $[0,1]$, that converge to the A-monomorphic equilibrium. This is equivalent to the Lebesgue measure (length) of the basin of attraction for $x^*=1$, since the total interval has length $1$.\nThe length of the attraction basin for $x^*=1$ is:\n$$\n\\text{Length}((x_{int}, 1]) = 1 - x_{int}\n$$\nSubstituting the expression for $x_{int}$:\n$$\n1 - x_{int} = 1 - \\frac{d-b}{a-c+d-b} = \\frac{(a-c+d-b) - (d-b)}{a-c+d-b} = \\frac{a-c}{a-c+d-b}\n$$\nThis expression depends only on the payoff parameters $a, b, c, d$ and is independent of the selection intensity $w$. Therefore, taking the weak selection limit $w \\to 0^{+}$ has no effect on the result, as the geometric structure of the phase space is determined by the payoff matrix, provided $w0$. The role of the weak selection assumption $f_i = 1-w+w\\pi_i$ is to ensure that the evolutionary dynamics directly reflect the payoff structure of the underlying game, making the interior fixed point of the dynamics identical to the mixed-strategy Nash equilibrium of the game.\n\nFinally, we connect this result to the concept of risk-dominance. In a symmetric $2 \\times 2$ coordination game, strategy A is said to risk-dominate strategy B if the condition $a-c  d-b$ is met. This condition compares the payoff penalties for unilateral deviation from each of the pure-strategy Nash equilibria.\n\nThe basin of attraction for strategy A is larger than that for strategy B if its size, $1-x_{int}$, is greater than $1/2$.\n$$\n1-x_{int}  \\frac{1}{2} \\implies x_{int}  \\frac{1}{2}\n$$\nSubstituting the expression for the basin boundary $x_{int}$:\n$$\n\\frac{d-b}{a-c+d-b}  \\frac{1}{2}\n$$\nSince the denominator is positive, we can multiply both sides by $2(a-c+d-b)$:\n$$\n2(d-b)  a-c+d-b\n$$\n$$\nd-b  a-c\n$$\nThis is precisely the condition for strategy A to be risk-dominant. Therefore, the replicator dynamics predict that the equilibrium corresponding to the risk-dominant strategy will have a larger basin of attraction. The basin boundary $x_{int}$ is the critical threshold; if the initial frequency of a strategy is greater than its proportion in the unstable mixed equilibrium, it will eventually take over the entire population. The risk-dominant equilibrium is the one that can invade from a state of higher uncertainty (i.e., a smaller initial frequency, as long as it is above the threshold $x_{int}$ which is less than $1/2$). This derivation connects the population-level dynamics to the game-theoretic concept of risk-dominance without *a priori* assuming any selection criterion beyond the replicator equation itself.\n\nThe analytic expression for the fraction of initial states converging to the A-monomorphic equilibrium is $\\frac{a-c}{a-c+d-b}$.", "answer": "$$\n\\boxed{\\frac{a-c}{a-c+d-b}}\n$$", "id": "3307090"}, {"introduction": "Evolutionary dynamics are not limited to convergence towards stable fixed points; they can also generate persistent cycles and complex temporal patterns. The rock-paper-scissors (RPS) game is the canonical model for such cyclic dominance, observed in systems ranging from microbial communities to animal mating strategies. In this analytical exercise, you will investigate the dynamics of a three-strategy RPS game, derive its internal equilibrium point, and classify its stability [@problem_id:3307089]. This will lead you to characterize the system as a neutrally stable center and calculate the precise frequency of the resulting population cycles.", "problem": "In a computational systems biology model of cyclic dominance among $3$ microbial strains, suppose pairwise interactions are encoded by a symmetric fitness game in the sense of evolutionary game theory, with the population composition $x = (x_{1}, x_{2}, x_{3})$ evolving on the unit simplex under the replicator ordinary differential equation (ODE)\n$$\n\\dot{x}_{i} = x_{i} \\left( (A x)_{i} - x^{\\top} A x \\right), \\quad i \\in \\{1,2,3\\},\n$$\nwhere $A \\in \\mathbb{R}^{3 \\times 3}$ is the payoff matrix and $x^{\\top} A x$ denotes the mean fitness. Consider the rock-paper-scissors (RPS) interaction structure with an antisymmetric payoff matrix\n$$\nA = \\begin{pmatrix}\n0  a  -c \\\\\n-a  0  b \\\\\nc  -b  0\n\\end{pmatrix},\n$$\nwhere $a$, $b$, and $c$ are real parameters that quantify the advantage of one strain over another in cyclic dominance. Assume $a0$, $b0$, and $c0$ so that all three strains can invade one another in cyclic fashion and an interior equilibrium exists.\n\nStarting from the fundamental definition of the replicator ODE and the given antisymmetric structure of $A$, do the following:\n- Derive the interior equilibrium $x^{\\ast}$.\n- Linearize the replicator dynamics at $x^{\\ast}$ and classify the stability of $x^{\\ast}$ in terms of the parameters $a$, $b$, and $c$.\n- Compute the exact angular frequency $\\omega$ of small-amplitude cycles in the neighborhood of $x^{\\ast}$, expressed in closed form as a function of $a$, $b$, and $c$.\n\nProvide the final answer as a single closed-form analytic expression for $\\omega$. No rounding is required and no physical units are needed. If $a$, $b$, or $c$ are zero or negative, explain in words how the classification changes, but your final answer must still be the expression for $\\omega$ under the stated assumption $a0$, $b0$, and $c0$.", "solution": "The replicator ordinary differential equation (ODE) for $3$ strategies is\n$$\n\\dot{x}_{i} = x_{i} \\left( (A x)_{i} - x^{\\top} A x \\right), \\quad i \\in \\{1,2,3\\}.\n$$\nWe first exploit the antisymmetry of $A$. Because $A^{\\top} = -A$, for any $x \\in \\mathbb{R}^{3}$ one has\n$$\nx^{\\top} A x = - x^{\\top} A x \\;\\Rightarrow\\; x^{\\top} A x = 0.\n$$\nTherefore, for the antisymmetric rock-paper-scissors (RPS) game, the replicator ODE simplifies to\n$$\n\\dot{x}_{i} = x_{i} (A x)_{i}, \\quad i \\in \\{1,2,3\\}.\n$$\nAn interior equilibrium $x^{\\ast}$ (with $x_{i}^{\\ast}  0$ and $x_{1}^{\\ast} + x_{2}^{\\ast} + x_{3}^{\\ast} = 1$) must satisfy $(A x^{\\ast})_{i} = 0$ for all $i$, because $x^{\\top} A x \\equiv 0$ and $\\dot{x}_{i} = x_{i} (A x)_{i}$. Thus, $x^{\\ast}$ is in the kernel of $A$:\n$$\nA x^{\\ast} = 0.\n$$\nWith\n$$\nA = \\begin{pmatrix}\n0  a  -c \\\\\n-a  0  b \\\\\nc  -b  0\n\\end{pmatrix},\n$$\nwrite $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast}, x_{3}^{\\ast})$. The equations $A x^{\\ast} = 0$ are\n$$\na x_{2}^{\\ast} - c x_{3}^{\\ast} = 0, \\quad - a x_{1}^{\\ast} + b x_{3}^{\\ast} = 0, \\quad c x_{1}^{\\ast} - b x_{2}^{\\ast} = 0.\n$$\nThese yield the ratios\n$$\nx_{2}^{\\ast} = \\frac{c}{a} x_{3}^{\\ast}, \\qquad x_{1}^{\\ast} = \\frac{b}{a} x_{3}^{\\ast}.\n$$\nNormalizing to the unit simplex $x_{1}^{\\ast} + x_{2}^{\\ast} + x_{3}^{\\ast} = 1$ gives\n$$\nx^{\\ast} = \\frac{1}{a + b + c} \\left( b,\\, c,\\, a \\right).\n$$\nUnder the assumption $a0$, $b0$, and $c0$, this $x^{\\ast}$ is indeed an interior equilibrium.\n\nTo classify stability, we linearize the dynamics at $x^{\\ast}$. Consider the Jacobian $J$ with entries\n$$\nJ_{ij} = \\left. \\frac{\\partial \\dot{x}_{i}}{\\partial x_{j}} \\right|_{x = x^{\\ast}}.\n$$\nFrom $\\dot{x}_{i} = x_{i} (A x)_{i}$ and the product rule,\n$$\n\\frac{\\partial \\dot{x}_{i}}{\\partial x_{j}} = \\delta_{ij} (A x)_{i} + x_{i} A_{ij}.\n$$\nAt $x = x^{\\ast}$, $(A x^{\\ast})_{i} = 0$, so the first term vanishes and\n$$\nJ_{ij} = x_{i}^{\\ast} A_{ij}.\n$$\nThus,\n$$\nJ = D A, \\quad \\text{with} \\quad D = \\mathrm{diag}(x_{1}^{\\ast}, x_{2}^{\\ast}, x_{3}^{\\ast}).\n$$\nBecause $A$ is antisymmetric and $D$ is positive diagonal, $J$ has one zero eigenvalue corresponding to the invariant direction associated with the simplex constraint, and the other two eigenvalues are purely imaginary and conjugate. One way to see this and to quantify the oscillation frequency is to compute $\\mathrm{trace}(J^{2})$ and use the identity that if the eigenvalues of $J$ are $\\{0,\\, \\mathrm{i} \\omega,\\, - \\mathrm{i} \\omega\\}$, then\n$$\n\\mathrm{trace}(J^{2}) = 0 + (-\\omega^{2}) + (-\\omega^{2}) = - 2 \\omega^{2}.\n$$\nWe therefore compute $J^{2}$ and its trace. With\n$$\nJ = \\begin{pmatrix}\n0  x_{1}^{\\ast} a  - x_{1}^{\\ast} c \\\\\n- x_{2}^{\\ast} a  0  x_{2}^{\\ast} b \\\\\nx_{3}^{\\ast} c  - x_{3}^{\\ast} b  0\n\\end{pmatrix},\n$$\nthe diagonal entries of $J^{2}$ are\n$$\n(J^{2})_{11} = J_{12} J_{21} + J_{13} J_{31} = - x_{1}^{\\ast} x_{2}^{\\ast} a^{2} - x_{1}^{\\ast} x_{3}^{\\ast} c^{2},\n$$\n$$\n(J^{2})_{22} = J_{21} J_{12} + J_{23} J_{32} = - x_{1}^{\\ast} x_{2}^{\\ast} a^{2} - x_{2}^{\\ast} x_{3}^{\\ast} b^{2},\n$$\n$$\n(J^{2})_{33} = J_{31} J_{13} + J_{32} J_{23} = - x_{1}^{\\ast} x_{3}^{\\ast} c^{2} - x_{2}^{\\ast} x_{3}^{\\ast} b^{2}.\n$$\nHence,\n$$\n\\mathrm{trace}(J^{2}) = (J^{2})_{11} + (J^{2})_{22} + (J^{2})_{33} = - 2 \\left( x_{1}^{\\ast} x_{2}^{\\ast} a^{2} + x_{1}^{\\ast} x_{3}^{\\ast} c^{2} + x_{2}^{\\ast} x_{3}^{\\ast} b^{2} \\right).\n$$\nEquating to $- 2 \\omega^{2}$ yields\n$$\n\\omega^{2} = x_{1}^{\\ast} x_{2}^{\\ast} a^{2} + x_{1}^{\\ast} x_{3}^{\\ast} c^{2} + x_{2}^{\\ast} x_{3}^{\\ast} b^{2}.\n$$\nSubstituting $x^{\\ast} = \\frac{1}{a + b + c} (b, c, a)$ gives\n$$\nx_{1}^{\\ast} x_{2}^{\\ast} a^{2} = \\frac{b c}{(a + b + c)^{2}} a^{2}, \\quad x_{1}^{\\ast} x_{3}^{\\ast} c^{2} = \\frac{b a}{(a + b + c)^{2}} c^{2}, \\quad x_{2}^{\\ast} x_{3}^{\\ast} b^{2} = \\frac{c a}{(a + b + c)^{2}} b^{2}.\n$$\nTherefore,\n$$\n\\omega^{2} = \\frac{a^{2} b c + b a c^{2} + c a b^{2}}{(a + b + c)^{2}} = \\frac{a b c (a + b + c)}{(a + b + c)^{2}} = \\frac{a b c}{a + b + c},\n$$\nand the angular frequency is\n$$\n\\omega = \\sqrt{\\frac{a b c}{a + b + c}}.\n$$\nThis shows that the interior equilibrium is a neutrally stable center for all $a0$, $b0$, and $c0$, with small-amplitude closed orbits having angular frequency $\\omega$ as above. The neutrality follows from the antisymmetry of $A$, which makes the replicator dynamics conservative in the interior (there exists a constant of motion), yielding purely imaginary eigenvalues about $x^{\\ast}$.\n\nRegarding classification if $a$, $b$, or $c$ are zero or negative:\n- If any of $a$, $b$, or $c$ is zero, the cyclic dominance is broken along one edge, the matrix $A$ becomes rank-deficient with reduced dynamics that typically have a line of fixed points or neutrally stable edges; the interior equilibrium either collides with the boundary or ceases to exist.\n- If any of $a$, $b$, or $c$ is negative while the others are positive, then the corresponding $x^{\\ast}$ component determined by $(b, c, a)/(a + b + c)$ will not be strictly positive, and no interior equilibrium exists; dynamics are confined to faces and edges with heteroclinic behavior potentially emerging.\nUnder the stated assumption $a0$, $b0$, and $c0$, the interior equilibrium exists and is neutrally stable, with the exact angular frequency given above.", "answer": "$$\\boxed{\\sqrt{\\frac{a b c}{a + b + c}}}$$", "id": "3307089"}, {"introduction": "Biological interactions are rarely well-mixed; they unfold in space, where local interactions and dispersal shape the evolutionary landscape. This advanced computational practice challenges you to build a reaction–diffusion replicator model, extending evolutionary game theory to a spatial domain. You will simulate the competition between invasive and adhesive cellular phenotypes whose success is governed by a fascinating mechano-sensing feedback loop, where local tissue stress alters the rules of the game [@problem_id:3307141]. By implementing this model, you will gain hands-on experience with the numerical methods used to predict the emergence of complex spatial patterns from local evolutionary interactions.", "problem": "You are to derive, implement, and analyze a one-dimensional reaction–diffusion replicator system for two cellular phenotypes, invasive and adhesive, whose interaction payoffs are modulated by local tissue mechanical stress via a mechano-sensing feedback. The implementation must be a complete, runnable program that produces the requested outputs without user input.\n\nStart from the following fundamental base in evolutionary game theory and transport phenomena:\n\n- Replicator dynamics definition for frequencies: if a well-mixed population has phenotype frequencies $\\{x_i\\}_{i=1}^n$ with $\\sum_i x_i = 1$, phenotype-specific fitnesses $\\{f_i\\}$, and population mean fitness $\\phi = \\sum_i x_i f_i$, then the frequency dynamics are $\\dot{x}_i = x_i ( f_i - \\phi )$.\n- Fickian diffusion law: if a concentration field $c_i(\\mathbf{r},t)$ of species $i$ diffuses with coefficient $D_i$, then $\\partial_t c_i = D_i \\partial_{xx} c_i$.\n- Local mechanosensing: a saturating Hill-type feedback captures stress sensing $h(u) = \\dfrac{u^n}{K^n + u^n}$ for a local signal $u \\in [0,1]$ with Hill coefficient $n \\ge 1$ and half-saturation constant $K  0$.\n\nModel assumptions and definitions:\n\n- Consider two phenotypes: invasive (index $i=1$) and adhesive (index $i=2$). Let $c_1(x,t)$ and $c_2(x,t)$ denote their local densities on a one-dimensional periodic domain of length $L$ with coordinate $x \\in [0,L)$ and time $t \\ge 0$. Define local frequencies $x_1 = c_1/(c_1+c_2)$ and $x_2 = c_2/(c_1+c_2)$ whenever $c_1 + c_2  0$.\n- The reaction–diffusion replicator for densities is\n$$\n\\partial_t c_i = D_i \\partial_{xx} c_i + c_i \\left( f_i - \\phi \\right), \\quad i \\in \\{1,2\\},\n$$\nwith $f_i = \\left( A(\\sigma) \\, \\mathbf{x} \\right)_i$ and $\\phi = \\sum_{k=1}^2 x_k f_k$, where $\\mathbf{x} = (x_1,x_2)^\\top$ and $A(\\sigma)$ is a stress-dependent payoff matrix.\n- The tissue mechanical stress $\\sigma$ is an algebraic local functional of the adhesive frequency via the Hill law:\n$$\n\\sigma(x,t) = \\sigma_0 + \\kappa \\, h\\!\\left(x_2(x,t)\\right), \\quad h(u) = \\frac{u^n}{K^n + u^n}.\n$$\nHere $\\sigma_0 \\ge 0$ is a baseline stress and $\\kappa \\ge 0$ is the feedback strength.\n- The stress-modulated payoff matrix has the affine form\n$$\nA(\\sigma) = A_0 + \\sigma \\, S,\n$$\nwith baseline payoffs\n$$\nA_0 = \\begin{pmatrix}\n0.6  0.4 \\\\\n0.5  0.3\n\\end{pmatrix},\n$$\nand mechano-sensitivity\n$$\nS = \\begin{pmatrix}\n-0.5  -0.4 \\\\\n0.4  0.5\n\\end{pmatrix}.\n$$\nThis choice encodes that, in low-stress environments, the invasive phenotype has a baseline advantage, while increasing stress penalizes the invasive phenotype and benefits the adhesive phenotype.\n\nComputational task:\n\n- Discretize the one-dimensional spatial domain of length $L$ with $N$ equally spaced grid points and periodic boundary conditions. Use an explicit finite-difference scheme for diffusion with the standard second-order stencil, and an explicit Euler time integrator for the full system. Ensure the time step $\\Delta t$ satisfies the one-dimensional explicit diffusion stability condition $\\Delta t \\le \\dfrac{\\Delta x^2}{2 \\max(D_1,D_2)}$.\n- Use the following fixed numerical values for the common parameters:\n    - Domain length $L = 1$,\n    - Grid size $N = 128$,\n    - Time step $\\Delta t = 10^{-3}$,\n    - Hill coefficient $n = 2$,\n    - Half-saturation constant $K = 0.3$,\n    - Baseline stress $\\sigma_0 = 0.05$.\n- Initialize the densities deterministically as\n$$\nc_1(x,0) = 0.5 + \\varepsilon \\sin\\left( 2\\pi x / L \\right), \\quad c_2(x,0) = 1 - c_1(x,0),\n$$\nwith $\\varepsilon = 10^{-2}$, and enforce $c_i(x,0) \\ge 10^{-6}$ by clipping if necessary. During simulation, maintain non-negativity by clipping to a minimum of $10^{-12}$ after each time step to avoid numerical issues, and compute local frequencies from the current densities at each step.\n\nFor each parameter set in the test suite below, simulate until time $T$ and then compute the following three quantitative pattern metrics from the final invasive frequency $x_1(x,T)$:\n\n- The spatial standard deviation $\\mathrm{std}(x_1)$ over the grid, returned as a float rounded to $4$ decimal places.\n- The dominant Fourier mode index $m^\\star$ (a positive integer) of $x_1(x,T) - \\langle x_1 \\rangle$, defined as the index $m \\in \\{1,2,\\ldots,\\lfloor N/2 \\rfloor\\}$ at which the discrete cosine-sine power spectrum of the real-valued signal attains its maximum magnitude (ties broken by the smallest $m$).\n- The fraction of grid points at which $x_1(x,T)  0.5$, returned as a float rounded to $4$ decimal places.\n\nTest suite:\n\nProvide results for the following four parameter sets, each specified as a tuple $(\\kappa, D_1, D_2, T)$:\n\n- Case $1$ (no feedback, uniform mixing expected): $(0, 10^{-3}, 10^{-3}, 4)$.\n- Case $2$ (moderate feedback, equal diffusion): $(0.2, 10^{-3}, 10^{-3}, 4)$.\n- Case $3$ (strong feedback, equal diffusion): $(0.6, 10^{-3}, 10^{-3}, 4)$.\n- Case $4$ (moderate feedback, differential diffusion): $(0.2, 10^{-3}, 10^{-2}, 4)$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of this top-level list corresponds to one case in the test suite, ordered as above, and is itself a list of the three metrics in the order specified. For example, the output must look like\n$[\\,[\\mathrm{std}_1, m^\\star_1, \\mathrm{frac}_1], [\\mathrm{std}_2, m^\\star_2, \\mathrm{frac}_2], [\\mathrm{std}_3, m^\\star_3, \\mathrm{frac}_3], [\\mathrm{std}_4, m^\\star_4, \\mathrm{frac}_4]\\,]$,\nwith all floats rounded to $4$ decimal places and all mode indices integers.", "solution": "The user has provided a well-posed problem in computational systems biology, asking for the simulation and analysis of a one-dimensional, two-phenotype reaction-diffusion replicator system. The core of the model lies in the feedback loop where local mechanical stress, a function of the adhesive cell frequency, modulates the payoff matrix governing the evolutionary game between invasive and adhesive cells. The problem is scientifically grounded, mathematically complete, and computationally feasible. I will now present the derivation of the numerical solution and the design of the algorithm.\n\n### 1. Mathematical Model and Governing Equations\n\nThe system models the spatio-temporal dynamics of two cell phenotypes, invasive ($c_1(x,t)$) and adhesive ($c_2(x,t)$), on a one-dimensional periodic domain of length $L$. The evolution of their densities is governed by the reaction-diffusion replicator equation:\n$$\n\\partial_t c_i = D_i \\partial_{xx} c_i + c_i ( f_i - \\phi ), \\quad i \\in \\{1,2\\}\n$$\nThis equation separates the dynamics into two components: Fickian diffusion with coefficient $D_i$, which models cell migration, and a replicator term, which models selection based on fitness.\n\nThe fitness $f_i$ of each phenotype is determined by a game-theoretic interaction. It is calculated as the $i$-th component of the matrix-vector product $A(\\sigma)\\mathbf{x}$, where $\\mathbf{x} = (x_1, x_2)^\\top$ is the vector of local phenotype frequencies ($x_i = c_i / (c_1+c_2)$) and $A(\\sigma)$ is the payoff matrix. The mean fitness is $\\phi = x_1 f_1 + x_2 f_2$. The replicator term can be simplified for a two-player game:\n$$\nf_1 - \\phi = x_2(f_1 - f_2) \\quad \\text{and} \\quad f_2 - \\phi = x_1(f_2 - f_1)\n$$\nThis shows that the relative fitness difference, $f_1 - f_2$, drives the change in frequencies.\n\nA key feature is the mechano-sensing feedback. The payoff matrix $A(\\sigma)$ depends on the local mechanical stress $\\sigma(x,t)$, which is itself an algebraic function of the adhesive cell frequency $x_2$:\n$$\n\\sigma(x,t) = \\sigma_0 + \\kappa \\, h(x_2(x,t)) \\quad \\text{with} \\quad h(u) = \\frac{u^n}{K^n + u^n}\n$$\nThe payoff matrix is an affine function of stress, $A(\\sigma) = A_0 + \\sigma S$, with given constant matrices $A_0$ and $S$. This couples the evolutionary dynamics back to the local cell composition, creating a non-linear feedback system capable of complex pattern formation.\n\n### 2. Numerical Discretization and Scheme\n\nTo solve this system of partial differential equations (PDEs), we employ a numerical scheme based on the method of lines, discretizing space and time separately.\n\n**Spatial Discretization:** The domain $x \\in [0, L)$ is discretized into $N=128$ grid points $x_j = j \\Delta x$ for $j = 0, \\dots, N-1$, with grid spacing $\\Delta x = L/N$. The densities at these points at a given time are represented by vectors $\\mathbf{c}_i$. The second spatial derivative (Laplacian) $\\partial_{xx} c_i$ is approximated using a second-order central difference stencil. For a grid point $j$, this is:\n$$\n\\partial_{xx} c_i(x_j) \\approx \\frac{c_{i, j+1} - 2c_{i,j} + c_{i, j-1}}{(\\Delta x)^2}\n$$\nPeriodic boundary conditions are enforced by taking indices modulo $N$, i.e., $c_{i,N} \\equiv c_{i,0}$ and $c_{i,-1} \\equiv c_{i,N-1}$. This operation is efficiently implemented using array-rolling functions, such as `numpy.roll`.\n\n**Temporal Discretization:** Time is advanced using an explicit forward Euler method with a time step $\\Delta t = 10^{-3}$. Let $c_{i,j}^k$ be the density of phenotype $i$ at grid point $j$ and time step $k$. The value at the next time step $k+1$ is:\n$$\nc_{i,j}^{k+1} = c_{i,j}^k + \\Delta t \\left( D_i \\frac{c_{i, j+1}^k - 2c_{i,j}^k + c_{i, j-1}^k}{(\\Delta x)^2} + R_{i,j}^k \\right)\n$$\nwhere $R_{i,j}^k = c_{i,j}^k (f_{i,j}^k - \\phi_j^k)$ is the reaction term evaluated using the state at time $k$.\n\n**Stability:** The stability of the explicit scheme for the diffusion part requires the time step to be sufficiently small. The Courant-Friedrichs-Lewy (CFL) condition is $\\Delta t \\le \\frac{\\Delta x^2}{2 D_{\\text{max}}}$. With $L=1$, $N=128$, we have $\\Delta x \\approx 7.8 \\times 10^{-3}$. In the test cases, the largest diffusion coefficient is $D_{\\text{max}}=10^{-2}$. The stability limit is thus $\\Delta t \\le \\frac{(1/128)^2}{2 \\times 10^{-2}} \\approx 3.05 \\times 10^{-3}$. The chosen time step $\\Delta t = 10^{-3}$ satisfies this condition, ensuring numerical stability of the diffusion-advection part of the simulation.\n\n### 3. Algorithmic Implementation\n\nThe simulation proceeds iteratively over a number of time steps determined by the total simulation time $T$ and the time step $\\Delta t$.\n\n**Initialization:**\n1.  A spatial grid of $N$ points is defined over $[0, L)$.\n2.  Initial density arrays for $c_1$ and $c_2$ are created according to the specified functions:\n    $c_1(x,0) = 0.5 + \\varepsilon \\sin(2\\pi x/L)$ and $c_2(x,0) = 1 - c_1(x,0)$.\n3.  The initial densities are clipped to a minimum value of $10^{-6}$ as per the problem specification.\n\n**Main Simulation Loop:** For each time step:\n1.  **Compute Local Frequencies:** From the current density arrays $\\mathbf{c}_1$ and $\\mathbf{c}_2$, the total density $\\mathbf{c}_{\\text{total}} = \\mathbf{c}_1 + \\mathbf{c}_2$ is found. The frequency arrays are then $\\mathbf{x}_1 = \\mathbf{c}_1 / \\mathbf{c}_{\\text{total}}$ and $\\mathbf{x}_2 = \\mathbf{c}_2 / \\mathbf{c}_{\\text{total}}$. A small epsilon is added to $\\mathbf{c}_{\\text{total}}$ before division to prevent any issues, though the subsequent density clipping makes this robust.\n2.  **Compute Reaction Term:** This is a vectorized calculation over all grid points.\n    a. The stress array $\\boldsymbol{\\sigma}$ is computed using the adhesive frequency array $\\mathbf{x}_2$ and the Hill function.\n    b. The spatially-varying payoff matrix $A(\\boldsymbol{\\sigma})$ is constructed. This results in a stack of $N$ matrices, one for each grid point.\n    c. The fitness difference $f_{1,j} - f_{2,j}$ is calculated at each point $j$ using the corresponding local payoff matrix $A(\\sigma_j)$ and frequencies $x_{1,j}, x_{2,j}$. This can be expressed as:\n       $$ (f_1-f_2)_j = ( (A_0)_{11} - (A_0)_{21} + \\sigma_j(S_{11}-S_{21}) )x_{1,j} + ( (A_0)_{12} - (A_0)_{22} + \\sigma_j(S_{12}-S_{22}) )x_{2,j} $$\n    d. The reaction terms $\\mathbf{R}_1 = \\mathbf{c}_1 \\circ \\mathbf{x}_2 \\circ (\\mathbf{f}_1 - \\mathbf{f}_2)$ and $\\mathbf{R}_2 = -\\mathbf{c}_2 \\circ \\mathbf{x}_1 \\circ (\\mathbf{f}_1 - \\mathbf{f}_2)$ are computed, where $\\circ$ denotes element-wise multiplication.\n3.  **Compute Diffusion Term:** The discrete Laplacian is computed for both $\\mathbf{c}_1$ and $\\mathbf{c}_2$ using `numpy.roll` for efficient handling of periodic boundaries.\n4.  **Update Densities:** The new densities $\\mathbf{c}_1^{\\text{new}}$ and $\\mathbf{c}_2^{\\text{new}}$ are calculated using the explicit Euler formula.\n5.  **Enforce Non-negativity:** The updated density arrays are clipped to a minimum value of $10^{-12}$ to prevent negative values and maintain numerical stability.\n\n### 4. Post-Simulation Analysis and Metrics\n\nAfter the simulation runs for the specified time $T$, the final invasive frequency profile $x_1(x,T)$ is calculated. The following three metrics are then computed:\n\n1.  **Spatial Standard Deviation:** A measure of the spatial heterogeneity of the invasive phenotype. It is calculated directly using `numpy.std()` on the final frequency array $\\mathbf{x}_1$.\n2.  **Dominant Fourier Mode ($m^\\star$):** This metric identifies the characteristic wavelength of any emergent spatial pattern.\n    a. The spatial mean of the signal is subtracted: $\\mathbf{s} = \\mathbf{x}_1 - \\langle\\mathbf{x}_1\\rangle$.\n    b. The one-dimensional Discrete Fourier Transform (DFT) of the real-valued signal $\\mathbf{s}$ is computed using `numpy.fft.fft`.\n    c. The magnitudes of the complex DFT coefficients are calculated.\n    d. The index $m^\\star$ that maximizes the magnitude is found within the specified range of positive mode indices $m \\in \\{1, 2, \\ldots, \\lfloor N/2 \\rfloor\\}$. `numpy.argmax` is used, which naturally breaks ties by selecting the smallest index (and thus smallest $m$).\n3.  **Fraction of Grid Points with $x_1  0.5$:** This metric quantifies the extent of invasion. It is calculated by finding the number of grid points where the condition is met and dividing by the total number of points $N$. The expression `numpy.mean(x1_final  0.5)` computes this efficiently.\n\nThe program iterates through each parameter set in the test suite, performs the simulation and analysis, and collates the results into the specified list-of-lists format for final output.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the reaction-diffusion replicator system for four test cases\n    and computes the required pattern metrics.\n    \"\"\"\n    # Fixed numerical parameters\n    L = 1.0\n    N = 128\n    dt = 1e-3\n    n_hill = 2\n    K_hill = 0.3\n    sigma0 = 0.05\n    epsilon = 1e-2\n    c_min_init = 1e-6\n    c_min_sim = 1e-12\n\n    # Payoff matrix components\n    A0 = np.array([[0.6, 0.4], [0.5, 0.3]])\n    S_mat = np.array([[-0.5, -0.4], [0.4, 0.5]])\n\n    # Spatial grid setup\n    dx = L / N\n    x_grid = np.linspace(0, L, N, endpoint=False)\n    \n    # Test suite: (kappa, D1, D2, T)\n    test_cases = [\n        (0.0, 1e-3, 1e-3, 4.0),\n        (0.2, 1e-3, 1e-3, 4.0),\n        (0.6, 1e-3, 1e-3, 4.0),\n        (0.2, 1e-3, 1e-2, 4.0),\n    ]\n\n    all_results = []\n    \n    for kappa, D1, D2, T in test_cases:\n        # Check stability condition, though it's satisfied for all given cases\n        D_max = max(D1, D2)\n        if dt  (dx**2) / (2 * D_max):\n            # This case will not be reached with the problem's parameters.\n            # Handle error or warning if necessary. For this problem, we can assume it's met.\n            pass\n\n        # Initial conditions for densities c1 and c2\n        c1 = 0.5 + epsilon * np.sin(2 * np.pi * x_grid / L)\n        c2 = 1.0 - c1\n        c1 = np.maximum(c1, c_min_init)\n        c2 = np.maximum(c2, c_min_init)\n\n        # Main simulation loop\n        num_steps = int(round(T / dt))\n        for _ in range(num_steps):\n            # 1. Compute local frequencies x1, x2\n            c_total = c1 + c2\n            # Prevent division by zero, though clipping c1/c2 should suffice\n            c_total[c_total = 1e-12] = 1e-12 \n            x1 = c1 / c_total\n            x2 = c2 / c_total\n\n            # 2. Compute stress-dependent payoff terms\n            h = (x2**n_hill) / (K_hill**n_hill + x2**n_hill)\n            sigma = sigma0 + kappa * h\n            \n            # Vectorized construction of payoff matrices for all grid points\n            # A_sigma has shape (N, 2, 2)\n            A_sigma = A0[np.newaxis, :, :] + sigma[:, np.newaxis, np.newaxis] * S_mat[np.newaxis, :, :]\n            \n            # 3. Compute fitnesses and reaction terms\n            # Use simplified replicator term based on f1-f2\n            f1_minus_f2 = (A_sigma[:, 0, 0] - A_sigma[:, 1, 0]) * x1 + \\\n                          (A_sigma[:, 0, 1] - A_sigma[:, 1, 1]) * x2\n            \n            # Reaction terms R1, R2\n            R1 = c1 * x2 * f1_minus_f2\n            R2 = -c2 * x1 * f1_minus_f2\n\n            # 4. Compute diffusion term (discrete Laplacian)\n            lap_c1 = (np.roll(c1, -1) - 2 * c1 + np.roll(c1, 1)) / (dx**2)\n            lap_c2 = (np.roll(c2, -1) - 2 * c2 + np.roll(c2, 1)) / (dx**2)\n\n            # 5. Perform explicit Euler time step\n            c1_new = c1 + dt * (D1 * lap_c1 + R1)\n            c2_new = c2 + dt * (D2 * lap_c2 + R2)\n\n            # 6. Enforce non-negativity and update densities\n            c1 = np.maximum(c1_new, c_min_sim)\n            c2 = np.maximum(c2_new, c_min_sim)\n\n        # Post-simulation analysis\n        # Final invasive frequency\n        c_total_final = c1 + c2\n        c_total_final[c_total_final = 1e-12] = 1e-12\n        x1_final = c1 / c_total_final\n        \n        # Metric 1: Spatial standard deviation\n        std_x1 = np.std(x1_final)\n        \n        # Metric 2: Dominant Fourier mode index\n        x1_fluctuations = x1_final - np.mean(x1_final)\n        fft_coeffs = np.fft.fft(x1_fluctuations)\n        # Search for max magnitude in modes m=1, ..., N/2\n        magnitudes = np.abs(fft_coeffs[1:N//2 + 1])\n        # np.argmax returns the index of the first maximum. Adding 1 maps it to the mode index m.\n        dominant_mode = np.argmax(magnitudes) + 1\n\n        # Metric 3: Fraction of grid points where x1  0.5\n        frac_gt_half = np.mean(x1_final  0.5)\n        \n        # Collect results for the current test case\n        all_results.append([round(std_x1, 4), int(dominant_mode), round(frac_gt_half, 4)])\n\n    # Format the final output string according to the specification\n    # The format is a list of lists, `str(list)` gives spaces which we must remove for exact format.\n    # Joining string representations of each sublist is the robust way.\n    result_strings = [str(r).replace(\" \", \"\") for r in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "3307141"}]}