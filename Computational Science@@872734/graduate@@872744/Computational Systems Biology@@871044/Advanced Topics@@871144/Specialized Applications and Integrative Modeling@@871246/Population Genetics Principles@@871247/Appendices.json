{"hands_on_practices": [{"introduction": "The Hardy-Weinberg Equilibrium (HWE) principle serves as the fundamental null model in population genetics, describing a state of stable allele and genotype frequencies in the absence of evolutionary influences. This first exercise provides practical experience in applying this model by calculating allele frequencies from observed genotype counts and using the chi-square goodness-of-fit test to assess whether a population sample deviates significantly from HWE expectations. Mastering this test is a crucial skill, often employed as a quality control step in modern genomic studies to identify potential issues like genotyping errors or population stratification [@problem_id:3338784].", "problem": "A high-throughput variant-calling pipeline in computational systems biology is performing quality control on an autosomal biallelic single-nucleotide polymorphism in a panmictic diploid population. After filtering out low-quality genotype calls, a total of $N = 500$ individuals remain with confident genotypes, with observed genotype counts: $n_{AA} = 210$, $n_{Aa} = 230$, and $n_{aa} = 60$. Assume random mating, large population size, no selection, no mutation, and no migration so that Hardy–Weinberg Equilibrium (HWE) is the appropriate null model.\n\nUsing only foundational definitions from population genetics, compute the allele frequencies for allele $A$ and allele $a$ from these counts, then compute the expected genotype counts under the HWE null model, and finally compute the classical Pearson chi-square test statistic for deviation from HWE using the observed and expected genotype counts, without any continuity correction or small-sample adjustments.\n\nReport the chi-square statistic as a single real-valued number, rounded to four significant figures. Do not report any other quantity. No units are required.", "solution": "The problem statement has been evaluated and is deemed valid. It is scientifically grounded in the principles of population genetics, specifically the Hardy–Weinberg Equilibrium (HWE) model and chi-square goodness-of-fit testing. The problem is well-posed, with all necessary data provided and internally consistent, allowing for the calculation of a unique solution. The language is objective and precise.\n\nThe task is to compute the Pearson chi-square test statistic for deviation from HWE, given observed genotype counts for a biallelic locus in a diploid population. The solution proceeds in three stages: first, calculating the allele frequencies from the observed data; second, calculating the expected genotype counts under the HWE null model; and third, calculating the chi-square statistic based on the observed and expected counts.\n\nThe provided data are the observed genotype counts for a total sample of $N=500$ individuals:\n-   Number of individuals with genotype $AA$: $n_{AA} = 210$\n-   Number of individuals with genotype $Aa$: $n_{Aa} = 230$\n-   Number of individuals with genotype $aa$: $n_{aa} = 60$\n\nThe total number of individuals is confirmed by the sum of the counts: $n_{AA} + n_{Aa} + n_{aa} = 210 + 230 + 60 = 500 = N$.\n\n**1. Calculation of Allele Frequencies**\n\nThe frequencies of the alleles $A$ and $a$, denoted by $p$ and $q$ respectively, are calculated from the observed genotype counts. Since the population is diploid, the total number of alleles in the sample is $2N = 2 \\times 500 = 1000$.\n\nThe number of $A$ alleles is derived from the homozygotes ($AA$) and heterozygotes ($Aa$). Each $AA$ individual carries two $A$ alleles, and each $Aa$ individual carries one $A$ allele.\nThe total count of allele $A$ is:\n$$ \\text{Count}(A) = 2 \\times n_{AA} + 1 \\times n_{Aa} = 2 \\times 210 + 230 = 420 + 230 = 650 $$\nThe frequency of allele $A$, $p$, is the ratio of the count of $A$ alleles to the total number of alleles:\n$$ p = \\frac{2 n_{AA} + n_{Aa}}{2N} = \\frac{650}{1000} = 0.65 $$\n\nSimilarly, the frequency of allele $a$, $q$, is calculated. Each $aa$ individual carries two $a$ alleles, and each $Aa$ individual carries one $a$ allele.\nThe total count of allele $a$ is:\n$$ \\text{Count}(a) = 2 \\times n_{aa} + 1 \\times n_{Aa} = 2 \\times 60 + 230 = 120 + 230 = 350 $$\nThe frequency of allele $a$, $q$, is:\n$$ q = \\frac{2 n_{aa} + n_{Aa}}{2N} = \\frac{350}{1000} = 0.35 $$\nAs a check, the sum of the allele frequencies must be $1$: $p + q = 0.65 + 0.35 = 1.00$.\n\n**2. Calculation of Expected Genotype Counts under HWE**\n\nThe HWE principle states that for a population under the specified assumptions, the expected genotype frequencies are given by the terms of the binomial expansion $(p+q)^2 = p^2 + 2pq + q^2$.\n-   Expected frequency of genotype $AA$: $f_E(AA) = p^2 = (0.65)^2 = 0.4225$\n-   Expected frequency of genotype $Aa$: $f_E(Aa) = 2pq = 2 \\times 0.65 \\times 0.35 = 0.4550$\n-   Expected frequency of genotype $aa$: $f_E(aa) = q^2 = (0.35)^2 = 0.1225$\n\nTo find the expected genotype counts ($E_i$), we multiply these expected frequencies by the total sample size, $N=500$.\n-   Expected count of $AA$: $E_{AA} = N \\times p^2 = 500 \\times 0.4225 = 211.25$\n-   Expected count of $Aa$: $E_{Aa} = N \\times 2pq = 500 \\times 0.4550 = 227.5$\n-   Expected count of $aa$: $E_{aa} = N \\times q^2 = 500 \\times 0.1225 = 61.25$\n\nThe sum of expected counts must equal the total sample size: $211.25 + 227.5 + 61.25 = 500$.\n\n**3. Calculation of the Pearson Chi-Square Statistic**\n\nThe Pearson chi-square ($\\chi^2$) statistic is used to measure the discrepancy between observed ($O_i$) and expected ($E_i$) counts. The formula is:\n$$ \\chi^2 = \\sum_{i} \\frac{(O_i - E_i)^2}{E_i} $$\nThe three categories are the genotypes $AA$, $Aa$, and $aa$. Let $O_{AA}=n_{AA}$, $O_{Aa}=n_{Aa}$, and $O_{aa}=n_{aa}$.\n\nThe calculation proceeds as follows:\n$$ \\chi^2 = \\frac{(O_{AA} - E_{AA})^2}{E_{AA}} + \\frac{(O_{Aa} - E_{Aa})^2}{E_{Aa}} + \\frac{(O_{aa} - E_{aa})^2}{E_{aa}} $$\nSubstituting the observed and expected values:\n$$ \\chi^2 = \\frac{(210 - 211.25)^2}{211.25} + \\frac{(230 - 227.5)^2}{227.5} + \\frac{(60 - 61.25)^2}{61.25} $$\nCalculating the terms:\n$$ \\chi^2 = \\frac{(-1.25)^2}{211.25} + \\frac{(2.5)^2}{227.5} + \\frac{(-1.25)^2}{61.25} $$\n$$ \\chi^2 = \\frac{1.5625}{211.25} + \\frac{6.25}{227.5} + \\frac{1.5625}{61.25} $$\n$$ \\chi^2 \\approx 0.007396213 + 0.027472527 + 0.025510204 $$\n$$ \\chi^2 \\approx 0.060378944 $$\n\nThe problem requires the result to be rounded to four significant figures. The first significant figure is the $6$ in the hundredths place. The four significant figures are $0.06037$. The fifth significant digit is $8$, so we round up the fourth digit.\n$$ \\chi^2 \\approx 0.06038 $$\nThis is the final value for the chi-square statistic.", "answer": "$$\\boxed{0.06038}$$", "id": "3338784"}, {"introduction": "While the HWE model assumes a single, randomly mating population, most species exhibit some degree of population structure, where genetic variation is partitioned among subpopulations. This exercise moves beyond the single-deme model to explore the consequences of this structuring. You will learn to calculate Wright's fixation index, $F_{ST}$, a cornerstone metric that quantifies genetic differentiation, and see how it relates the reduction in heterozygosity to the variance in allele frequencies among demes, allowing for inferences about the balance between genetic drift and gene flow [@problem_id:3338795].", "problem": "A single biallelic locus with alleles $A$ and $a$ has been sampled in $K=5$ demes of a structured population at migration–drift equilibrium. You are given the allele counts (gene copies) for each deme $i$ as $(c_{i}^{A}, c_{i}^{a})$ with total $C_{i} = c_{i}^{A} + c_{i}^{a}$:\n- Deme $1$: $(83, 117)$ with $C_{1} = 200$\n- Deme $2$: $(30, 70)$ with $C_{2} = 100$\n- Deme $3$: $(160, 40)$ with $C_{3} = 200$\n- Deme $4$: $(55, 45)$ with $C_{4} = 100$\n- Deme $5$: $(24, 76)$ with $C_{5} = 100$\n\nStarting from the fundamental definitions in population genetics, treat each deme as obeying Hardy–Weinberg equilibrium (HWE), use the sample-size weights $w_{i} = C_{i} \\big/ \\sum_{j=1}^{K} C_{j}$, and compute:\n1. The weighted mean allele frequency $\\bar{p}$ of allele $A$ across demes.\n2. The within-deme expected heterozygosity $H_{i} = 2 p_{i} (1 - p_{i})$ for each deme $i$, where $p_{i} = c_{i}^{A} / C_{i}$, and the sample-size weighted average within-deme heterozygosity $H_{S} = \\sum_{i=1}^{K} w_{i} H_{i}$.\n3. The total expected heterozygosity $H_{T} = 2 \\bar{p} (1 - \\bar{p})$.\n4. The fixation index $F_{ST}$ defined by $F_{ST} = \\frac{H_{T} - H_{S}}{H_{T}}$.\n\nThen, under the classical Wright island model assumptions (neutrality, equal deme sizes, symmetric migration, and migration–drift equilibrium), interpret the inferred level of gene flow in terms of the number of migrants per generation $Nm$ using the well-tested relationship $F_{ST} \\approx \\frac{1}{4Nm + 1}$.\n\nRound all reported quantities ($\\bar{p}$, $H_{S}$, $H_{T}$, $F_{ST}$, and $Nm$) to five significant figures. Express the final answer as a sequence in the order $\\bar{p}$, $H_{S}$, $H_{T}$, $F_{ST}$, $Nm$.", "solution": "The problem is valid as it is scientifically grounded in standard population genetics theory, is well-posed with sufficient data and clear definitions, and is stated objectively. All conditions for a valid problem are met.\n\nThe solution proceeds by systematically calculating the required quantities as defined in the problem statement.\n\nFirst, we determine the total number of gene copies sampled across all demes, denoted by $C_{\\text{total}}$.\n$$ C_{\\text{total}} = \\sum_{j=1}^{K} C_{j} = C_{1} + C_{2} + C_{3} + C_{4} + C_{5} $$\n$$ C_{\\text{total}} = 200 + 100 + 200 + 100 + 100 = 700 $$\nThe sample-size weights $w_{i} = C_{i} / C_{\\text{total}}$ are:\n$$ w_{1} = \\frac{200}{700} = \\frac{2}{7} $$\n$$ w_{2} = \\frac{100}{700} = \\frac{1}{7} $$\n$$ w_{3} = \\frac{200}{700} = \\frac{2}{7} $$\n$$ w_{4} = \\frac{100}{700} = \\frac{1}{7} $$\n$$ w_{5} = \\frac{100}{700} = \\frac{1}{7} $$\nNext, we calculate the frequency of allele $A$, $p_{i}$, for each deme $i$ using the formula $p_{i} = c_{i}^{A} / C_{i}$.\n$$ p_{1} = \\frac{83}{200} = 0.415 $$\n$$ p_{2} = \\frac{30}{100} = 0.3 $$\n$$ p_{3} = \\frac{160}{200} = 0.8 $$\n$$ p_{4} = \\frac{55}{100} = 0.55 $$\n$$ p_{5} = \\frac{24}{100} = 0.24 $$\n\n1.  **Compute the weighted mean allele frequency $\\bar{p}$**.\n    This can be calculated as the weighted average of the deme frequencies, $\\bar{p} = \\sum_{i=1}^{K} w_{i} p_{i}$, or more directly as the total number of $A$ alleles divided by the total number of all alleles.\n    $$ \\bar{p} = \\frac{\\sum_{i=1}^{K} c_{i}^{A}}{\\sum_{i=1}^{K} C_{i}} = \\frac{83 + 30 + 160 + 55 + 24}{700} = \\frac{352}{700} \\approx 0.50285714 $$\n    Rounding to five significant figures, $\\bar{p} \\approx 0.50286$.\n\n2.  **Compute the within-deme heterozygosities $H_{i}$ and the average $H_{S}$**.\n    The expected heterozygosity for each deme is $H_{i} = 2 p_{i} (1 - p_{i})$.\n    $$ H_{1} = 2 \\times 0.415 \\times (1 - 0.415) = 2 \\times 0.415 \\times 0.585 = 0.48555 $$\n    $$ H_{2} = 2 \\times 0.3 \\times (1 - 0.3) = 2 \\times 0.3 \\times 0.7 = 0.42 $$\n    $$ H_{3} = 2 \\times 0.8 \\times (1 - 0.8) = 2 \\times 0.8 \\times 0.2 = 0.32 $$\n    $$ H_{4} = 2 \\times 0.55 \\times (1 - 0.55) = 2 \\times 0.55 \\times 0.45 = 0.495 $$\n    $$ H_{5} = 2 \\times 0.24 \\times (1 - 0.24) = 2 \\times 0.24 \\times 0.76 = 0.3648 $$\n    The average within-deme heterozygosity, $H_{S}$, is the weighted average of the $H_{i}$ values.\n    $$ H_{S} = \\sum_{i=1}^{K} w_{i} H_{i} = \\frac{2}{7}(0.48555) + \\frac{1}{7}(0.42) + \\frac{2}{7}(0.32) + \\frac{1}{7}(0.495) + \\frac{1}{7}(0.3648) $$\n    $$ H_{S} = \\frac{2 \\times 0.48555 + 0.42 + 2 \\times 0.32 + 0.495 + 0.3648}{7} = \\frac{0.9711 + 0.42 + 0.64 + 0.495 + 0.3648}{7} $$\n    $$ H_{S} = \\frac{2.8909}{7} \\approx 0.41298571 $$\n    Rounding to five significant figures, $H_{S} \\approx 0.41299$.\n\n3.  **Compute the total expected heterozygosity $H_{T}$**.\n    This is the expected heterozygosity if the entire collection of demes were a single panmictic population, $H_{T} = 2 \\bar{p} (1 - \\bar{p})$.\n    Using the unrounded value $\\bar{p} = 352/700$:\n    $$ H_{T} = 2 \\times \\frac{352}{700} \\times \\left(1 - \\frac{352}{700}\\right) = 2 \\times \\frac{352}{700} \\times \\frac{348}{700} = \\frac{245088}{490000} \\approx 0.49997551 $$\n    *Correction*: Using the previously calculated decimal for $\\bar{p} \\approx 0.50285714$:\n    $$ H_T = 2 \\times 0.50285714 \\times (1 - 0.50285714) = 2 \\times 0.50285714 \\times 0.49714286 \\approx 0.49998367 $$\n    The calculation with fractions is more accurate. Let's re-verify the fraction multiplication: $2 \\times 352 \\times 348 / (700^2) = 245088 / 490000$. This is correct. The decimal approximation was slightly off. My apologies. Let's use the correct value: $245088/490000 = 0.49997551...$\n    Rounding to five significant figures, $H_{T} \\approx 0.49998$. The initial rounding was correct despite a slight intermediate error.\n\n4.  **Compute the fixation index $F_{ST}$**.\n    The fixation index measures the deficit of heterozygotes in the total population due to substructuring. It is defined as $F_{ST} = (H_{T} - H_{S}) / H_{T}$.\n    Using the unrounded values for $H_{T}$ and $H_{S}$:\n    $$ F_{ST} = \\frac{0.49997551 - 0.41298571}{0.49997551} = \\frac{0.0869898}{0.49997551} \\approx 0.17400190 $$\n    Rounding to five significant figures, $F_{ST} \\approx 0.17400$.\n\n5.  **Infer the number of migrants per generation, $Nm$**.\n    Under the Wright island model at equilibrium, $F_{ST}$ is related to $Nm$ by the approximation $F_{ST} \\approx \\frac{1}{4Nm + 1}$. We can solve for $Nm$:\n    $$ 4Nm + 1 = \\frac{1}{F_{ST}} $$\n    $$ 4Nm = \\frac{1}{F_{ST}} - 1 $$\n    $$ Nm = \\frac{1}{4} \\left( \\frac{1}{F_{ST}} - 1 \\right) $$\n    Using the unrounded value $F_{ST} \\approx 0.17400190$:\n    $$ Nm = \\frac{1}{4} \\left( \\frac{1}{0.17400190} - 1 \\right) = \\frac{1}{4} (5.7470588 - 1) = \\frac{4.7470588}{4} \\approx 1.1867647 $$\n    Rounding to five significant figures, $Nm \\approx 1.1868$.\n\nThe final sequence of results, rounded to five significant figures, is:\n$\\bar{p} \\approx 0.50286$\n$H_{S} \\approx 0.41299$\n$H_{T} \\approx 0.49998$\n$F_{ST} \\approx 0.17400$\n$Nm \\approx 1.1868$", "answer": "$$ \\boxed{\\begin{pmatrix} 0.50286  0.41299  0.49998  0.17400  1.1868 \\end{pmatrix}} $$", "id": "3338795"}, {"introduction": "Our focus now shifts from the organization of individuals into populations to the organization of alleles along a chromosome. This practice addresses the concept of linkage disequilibrium (LD), the non-random association of alleles at different loci. Through a hands-on coding task, you will implement the calculation of standard LD measures ($D$ and $r^2$) and model the predictable decay of LD over generations due to meiotic recombination, a dynamic central to genetic mapping and genome-wide association studies [@problem_id:3338808].", "problem": "Consider two biallelic loci with alleles denoted by $A/a$ and $B/b$. In a randomly mating population with no selection, migration, or mutation, assume that gamete formation has a recombination fraction $r$ between the loci. For a sample taken at generation $0$ and again at generation $t$, suppose you observe haplotype counts for $AB$, $Ab$, $aB$, and $ab$. Starting from the core definitions of haplotype frequencies and allele frequencies, define the linkage disequilibrium measure $D$ and the squared correlation between loci $r^2$, and derive the generational recursion for $D$ under recombination alone. Then, implement these derivations to compute $D$ and $r^2$ at generation $0$ and generation $t$, and test whether the observed decay of $D$ from generation $0$ to generation $t$ is consistent with the factor $(1 - r)^t$ under random mating.\n\nYour program must:\n- Convert observed haplotype counts at generation $0$ and generation $t$ into haplotype frequencies, and from these, compute $D_0$ and $D_t$ using the definition of linkage disequilibrium based on haplotype and allele frequencies.\n- Compute $r^2$ for generation $0$ and generation $t$ using the definition based on $D$ and the marginal allele frequencies.\n- Using the provided recombination fraction $r$ and number of generations $t$, compute the predicted $D_t$ under recombination alone from the recursion you derive.\n- Compare the observed $D_t$ and the predicted $D_t$ by computing the absolute difference $\\delta = |D_t - D_0 (1 - r)^t|$. Declare a match if $\\delta \\le \\epsilon$, where $\\epsilon$ is a fixed tolerance equal to $10^{-3}$.\n- If either locus is monomorphic so that the variance term in the denominator of $r^2$ is zero, define $r^2$ to be $0$ for that generation for the purpose of the computation.\n\nUse the following test suite. Each test case is a tuple consisting of the generation $0$ haplotype counts $(n_{AB}^{(0)}, n_{Ab}^{(0)}, n_{aB}^{(0)}, n_{ab}^{(0)})$, the generation $t$ haplotype counts $(n_{AB}^{(t)}, n_{Ab}^{(t)}, n_{aB}^{(t)}, n_{ab}^{(t)})$, the number of generations $t$, and the recombination fraction $r$:\n- Test case $1$ (general case with moderate recombination and nonzero $D$): $((3000, 3000, 1000, 3000), (2754, 3246, 1246, 2754), 5, 0.1)$.\n- Test case $2$ (boundary case with $r = 0$, so no decay of $D$): $((700, 300, 300, 700), (700, 300, 300, 700), 7, 0.0)$.\n- Test case $3$ (near maximal recombination with $r \\approx 0.5$, fast decay): $((2080, 3520, 320, 2080), (1705, 3895, 695, 1705), 4, 0.5)$.\n- Test case $4$ (initial $D \\approx 0$ at linkage equilibrium): $((1200, 800, 1800, 1200), (1200, 800, 1800, 1200), 10, 0.2)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to a test case and is a boolean indicating whether the observed decay of $D$ matches the predicted $(1 - r)^t$ within the tolerance $\\epsilon = 10^{-3}$. The exact output format must be $[b_1,b_2,b_3,b_4]$, where each $b_i$ is either $True$ or $False$ in plain text with no additional characters or whitespace.", "solution": "The problem requires the derivation and application of the fundamental equations of recombination's effect on linkage disequilibrium ($D$) in a simplified population genetics model. We are asked to validate whether observed changes in haplotype frequencies between two time points, generation $0$ and generation $t$, are consistent with the theoretical decay of $D$.\n\nFirst, we establish the necessary definitions. Let the frequencies of the four possible haplotypes for two biallelic loci ($A/a$ and $B/b$) be denoted by $p_{AB}$, $p_{Ab}$, $p_{aB}$, and $p_{ab}$. These are estimated from the sample counts ($n_{AB}$, $n_{Ab}$, $n_{aB}$, $n_{ab}$) by dividing by the total sample size $N = n_{AB} + n_{Ab} + n_{aB} + n_{ab}$. The sum of these frequencies is unity: $p_{AB} + p_{Ab} + p_{aB} + p_{ab} = 1$.\n\nFrom these haplotype frequencies, we can define the marginal allele frequencies for allele $A$ ($p_A$), allele $a$ ($p_a$), allele $B$ ($p_B$), and allele $b$ ($p_b$):\n$$ p_A = p_{AB} + p_{Ab} $$\n$$ p_a = p_{aB} + p_{ab} = 1 - p_A $$\n$$ p_B = p_{AB} + p_{aB} $$\n$$ p_b = p_{Ab} + p_{ab} = 1 - p_B $$\nUnder the specified model (random mating, no selection, mutation, or migration), these allele frequencies remain constant across generations in an infinitely large population.\n\nLinkage disequilibrium, $D$, quantifies the non-random association of alleles at the two loci. It is defined as the deviation of the frequency of a given haplotype (e.g., $AB$) from the frequency expected under random association (linkage equilibrium), which would be the product of the corresponding allele frequencies.\n$$ D = p_{AB} - p_A p_B $$\nUsing the relationships between haplotype and allele frequencies, we can show that this definition leads to equivalent expressions for the other haplotypes:\n$p_{Ab} = p_A(1-p_B) - D = p_A p_b - D$\n$p_{aB} = (1-p_A)p_B - D = p_a p_B - D$\n$p_{ab} = (1-p_A)(1-p_B) + D = p_a p_b + D$\nA symmetric and commonly used form for calculating $D$ is $D = p_{AB}p_{ab} - p_{Ab}p_{aB}$. This can be derived from the primary definition:\n$p_{AB}p_{ab} - p_{Ab}p_{aB} = (p_A p_B + D)(p_a p_b + D) - (p_A p_b - D)(p_a p_B - D)$\n$= (p_A p_B p_a p_b + D(p_A p_B + p_a p_b) + D^2) - (p_A p_b p_a p_B - D(p_A p_b + p_a p_B) + D^2)$\n$= D(p_A p_B + p_a p_b + p_A p_b + p_a p_B) = D(p_A(p_B+p_b) + p_a(p_b+p_B)) = D(p_A + p_a) = D$.\n\nThe squared correlation coefficient, $r^2$, is a normalized measure of $D$ that is less dependent on allele frequencies:\n$$ r^2 = \\frac{D^2}{p_A p_a p_B p_b} $$\nThe denominator, $p_A p_a p_B p_b$, is the product of the variances of the two loci, assuming a binary encoding for the alleles (e.g., $A=1, a=0$). If either locus is monomorphic (e.g., $p_A=1$ or $p_A=0$), this denominator becomes zero, and $r^2$ is defined as $0$.\n\nNext, we derive the recursion for $D$ across generations. In a randomly mating population, the haplotype frequencies in the gamete pool for the next generation are determined by the frequencies in the current generation and the recombination fraction, $r$. A fraction $(1-r)$ of haplotypes are non-recombinant, while a fraction $r$ are recombinant. The frequency of the $AB$ haplotype at generation $t+1$, denoted $p_{AB, t+1}$, is given by:\n$$ p_{AB, t+1} = (1-r) p_{AB, t} + r p_{A,t} p_{B,t} $$\nThe first term represents the $AB$ haplotypes from generation $t$ that did not undergo recombination. The second term represents new $AB$ haplotypes formed by recombination events, which bring together an $A$ allele and a $B$ allele from homologous chromosomes. In a randomly mating pool, the frequency of such recombinant pairings is proportional to the product of the allele frequencies. Since allele frequencies $p_A$ and $p_B$ are constant over time, we can drop the subscript $t$.\n\nNow we can write the recursion for $D_{t+1}$:\n$$ D_{t+1} = p_{AB, t+1} - p_A p_B $$\nSubstituting the expression for $p_{AB, t+1}$:\n$$ D_{t+1} = \\left( (1-r) p_{AB, t} + r p_A p_B \\right) - p_A p_B $$\n$$ D_{t+1} = (1-r) p_{AB, t} - p_A p_B (1-r) $$\n$$ D_{t+1} = (1-r) (p_{AB, t} - p_A p_B) $$\n$$ D_{t+1} = (1-r) D_t $$\nThis simple recurrence relation shows that linkage disequilibrium decays geometrically by a factor of $(1-r)$ each generation. By unrolling the recursion, we obtain the value of $D$ at generation $t$ as a function of its initial value $D_0$:\n$$ D_t = (1-r)^t D_0 $$\n\nThe computational procedure to solve the problem for each test case is as follows:\n1.  For the generation $0$ data $(n_{AB}^{(0)}, n_{Ab}^{(0)}, n_{aB}^{(0)}, n_{ab}^{(0)})$, calculate the total count $N_0$ and the corresponding haplotype frequencies $p_{AB,0}, p_{Ab,0}, p_{aB,0}, p_{ab,0}$.\n2.  From these frequencies, compute the allele frequencies $p_{A,0}$ and $p_{B,0}$.\n3.  Calculate the initial linkage disequilibrium $D_0 = p_{AB,0} - p_{A,0} p_{B,0}$.\n4.  Repeat steps $1$ and $2$ for the generation $t$ data to find the observed haplotype and allele frequencies, and then compute the observed linkage disequilibrium $D_t^{obs} = p_{AB,t} - p_{A,t} p_{B,t}$. The problem setup ensures that allele frequencies are constant between the samples.\n5.  Calculate the predicted linkage disequilibrium at generation $t$ using the derived formula: $D_t^{pred} = D_0 (1-r)^t$.\n6.  Compute the absolute difference $\\delta = |D_t^{obs} - D_t^{pred}|$.\n7.  Compare $\\delta$ to the tolerance $\\epsilon = 10^{-3}$. If $\\delta \\le \\epsilon$, the observed decay is consistent with the model, and the result is `True`; otherwise, it is `False`.\nThe calculation of $r^2$ for both generations is also performed as per the definition, handling the case of monomorphic loci.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the population genetics problem for a suite of test cases.\n    \"\"\"\n\n    # Test suite as defined in the problem description.\n    test_cases = [\n        # ((n_AB0, n_Ab0, n_aB0, n_ab0), (n_ABt, n_Abt, n_aBt, n_abt), t, r)\n        ((3000, 3000, 1000, 3000), (2754, 3246, 1246, 2754), 5, 0.1),\n        ((700, 300, 300, 700), (700, 300, 300, 700), 7, 0.0),\n        ((2080, 3520, 320, 2080), (1705, 3895, 695, 1705), 4, 0.5),\n        ((1200, 800, 1800, 1200), (1200, 800, 1800, 1200), 10, 0.2),\n    ]\n\n    tolerance = 1e-3\n    results = []\n\n    for case in test_cases:\n        counts_0, counts_t, t, r = case\n        \n        # --- Analyze Generation 0 ---\n        # Convert counts to numpy array for vectorized operations\n        counts_0_arr = np.array(counts_0, dtype=float)\n        N_0 = counts_0_arr.sum()\n        \n        if N_0 == 0:\n            # If there's no sample, the state is undefined.\n            # For this problem, we can assume N > 0 based on test cases.\n            # Continue to the next case or handle as an error.\n            results.append(False) # Or some other error indicator\n            continue\n            \n        # Haplotype frequencies: p_AB, p_Ab, p_aB, p_ab\n        freqs_0 = counts_0_arr / N_0\n        p_AB_0, p_Ab_0, p_aB_0, p_ab_0 = freqs_0\n\n        # Allele frequencies\n        p_A_0 = p_AB_0 + p_Ab_0\n        p_a_0 = 1.0 - p_A_0\n        p_B_0 = p_AB_0 + p_aB_0\n        p_b_0 = 1.0 - p_B_0\n\n        # Linkage Disequilibrium D_0\n        D_0 = p_AB_0 - p_A_0 * p_B_0\n        \n        # Squared correlation r^2_0\n        r2_denom_0 = p_A_0 * p_a_0 * p_B_0 * p_b_0\n        r_sq_0 = (D_0**2 / r2_denom_0) if r2_denom_0 > 0 else 0.0\n\n        # --- Analyze Generation t ---\n        counts_t_arr = np.array(counts_t, dtype=float)\n        N_t = counts_t_arr.sum()\n\n        if N_t == 0:\n            results.append(False)\n            continue\n        \n        # Haplotype frequencies: p_AB, p_Ab, p_aB, p_ab\n        freqs_t = counts_t_arr / N_t\n        p_AB_t, p_Ab_t, p_aB_t, p_ab_t = freqs_t\n\n        # Allele frequencies\n        p_A_t = p_AB_t + p_Ab_t\n        p_a_t = 1.0 - p_A_t\n        p_B_t = p_AB_t + p_aB_t\n        p_b_t = 1.0 - p_B_t\n\n        # Observed Linkage Disequilibrium D_t_obs\n        D_t_obs = p_AB_t - p_A_t * p_B_t\n\n        # Squared correlation r^2_t\n        r2_denom_t = p_A_t * p_a_t * p_B_t * p_b_t\n        r_sq_t = (D_t_obs**2 / r2_denom_t) if r2_denom_t > 0 else 0.0\n\n        # --- Prediction and Comparison ---\n        # Predicted D at generation t based on theory\n        D_t_pred = D_0 * (1.0 - r)**t\n\n        # Absolute difference between observed and predicted D_t\n        delta = abs(D_t_obs - D_t_pred)\n\n        # Check if the difference is within the specified tolerance\n        match = delta = tolerance\n        results.append(match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3338808"}]}