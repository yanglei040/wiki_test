{"hands_on_practices": [{"introduction": "In single-cell analysis, raw proximity in a latent space can be misleading due to noise and variable cell density. The Shared Nearest Neighbor (SNN) method addresses this by defining similarity based on the overlap in the local neighborhoods of two cells, effectively denoising the graph to highlight more robust connections. This exercise [@problem_id:3318020] asks you to formalize this concept by using the Jaccard similarity to derive and compute an SNN edge weight, solidifying your understanding of how meaningful cell-cell similarity graphs are constructed.", "problem": "In single-cell ribonucleic acid sequencing (scRNA-seq) analysis for cell type identification, cells are embedded in a latent space and connected via a $k$-nearest-neighbor (kNN) graph. A widely used strategy assigns edge weights based on the overlap of neighborhood sets, often referred to as the Shared Nearest Neighbor (SNN) graph. Using only the set-theoretic definition of the Jaccard similarity between two finite sets and the core definitions of a $k$-nearest-neighbor graph, derive an explicit expression for the SNN edge weight $w_{ij}$ in terms of the neighborhoods $N_{k}(i)$ and $N_{k}(j)$ of cells $i$ and $j$ in the kNN graph. Then evaluate this weight for a concrete example.\n\nAssume a dataset with $8$ cells labeled $\\{1,2,3,4,5,6,7,8\\}$ and a kNN graph with $k=5$, where neighborhoods exclude the cell itself. Consider cells $i=1$ and $j=2$ with neighborhoods\n$$\nN_{k}(1)=\\{2,3,4,5,7\\},\\quad N_{k}(2)=\\{1,3,4,6,7\\}.\n$$\nUsing the set-theoretic definition of the Jaccard similarity and only the above information, first derive the closed-form expression for $w_{ij}$ and then compute its value for the specified $N_{k}(1)$ and $N_{k}(2)$. Express your final numerical value as a reduced fraction.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the established methods of computational systems biology, specifically the use of Shared Nearest Neighbor (SNN) graphs for clustering single-cell data. The problem is well-posed, providing all necessary definitions and data for a unique solution. The language is objective and the setup is self-contained and consistent.\n\nThe task is to first derive a general expression for the Shared Nearest Neighbor (SNN) edge weight, $w_{ij}$, and then to compute its value for a specific pair of cells. The problem explicitly states that the edge weight is to be defined by the Jaccard similarity of the neighborhood sets.\n\nFirst, let us formalize the derivation. The Jaccard similarity index, $J(A, B)$, between two finite, non-empty sets $A$ and $B$ is defined as the ratio of the cardinality of their intersection to the cardinality of their union:\n$$\nJ(A, B) = \\frac{|A \\cap B|}{|A \\cup B|}\n$$\nThe problem specifies that the edge weight $w_{ij}$ between two cells, $i$ and $j$, in the SNN graph is given by the Jaccard similarity of their respective $k$-nearest-neighbor sets, $N_{k}(i)$ and $N_{k}(j)$. Therefore, we substitute $A = N_{k}(i)$ and $B = N_{k}(j)$ into the Jaccard index formula:\n$$\nw_{ij} = J(N_{k}(i), N_{k}(j)) = \\frac{|N_{k}(i) \\cap N_{k}(j)|}{|N_{k}(i) \\cup N_{k}(j)|}\n$$\nThis is the explicit expression for the SNN edge weight in terms of the neighborhood sets. Using the principle of inclusion-exclusion for set cardinalities, the denominator can be re-expressed as $|A \\cup B| = |A| + |B| - |A \\cap B|$. Applying this, we obtain an alternative and equally valid form of the expression:\n$$\nw_{ij} = \\frac{|N_{k}(i) \\cap N_{k}(j)|}{|N_{k}(i)| + |N_{k}(j)| - |N_{k}(i) \\cap N_{k}(j)|}\n$$\nThis completes the first part of the task.\n\nNext, we evaluate this weight for the given concrete example. The parameters and data are:\n- The cells of interest are $i=1$ and $j=2$.\n- The number of nearest neighbors is $k=5$.\n- The neighborhood for cell $1$ is $N_{k}(1) = \\{2, 3, 4, 5, 7\\}$.\n- The neighborhood for cell $2$ is $N_{k}(2) = \\{1, 3, 4, 6, 7\\}$.\n\nWe must compute the cardinalities of the intersection and union of these two sets.\n\nFirst, we find the intersection of the two neighborhood sets:\n$$\nN_{k}(1) \\cap N_{k}(2) = \\{2, 3, 4, 5, 7\\} \\cap \\{1, 3, 4, 6, 7\\}\n$$\nThe elements common to both sets are $3$, $4$, and $7$. Thus,\n$$\nN_{k}(1) \\cap N_{k}(2) = \\{3, 4, 7\\}\n$$\nThe cardinality of the intersection is the number of elements in this set:\n$$\n|N_{k}(1) \\cap N_{k}(2)| = 3\n$$\nThis value represents the number of shared nearest neighbors between cell $1$ and cell $2$.\n\nNext, we find the union of the two neighborhood sets:\n$$\nN_{k}(1) \\cup N_{k}(2) = \\{2, 3, 4, 5, 7\\} \\cup \\{1, 3, 4, 6, 7\\}\n$$\nThe union is the set of all unique elements present in either set:\n$$\nN_{k}(1) \\cup N_{k}(2) = \\{1, 2, 3, 4, 5, 6, 7\\}\n$$\nThe cardinality of the union is the number of elements in this set:\n$$\n|N_{k}(1) \\cup N_{k}(2)| = 7\n$$\nAs a verification, we can use the inclusion-exclusion principle. The cardinalities of the individual neighborhood sets are $|N_{k}(1)| = 5$ and $|N_{k}(2)| = 5$, consistent with $k=5$.\n$$\n|N_{k}(1) \\cup N_{k}(2)| = |N_{k}(1)| + |N_{k}(2)| - |N_{k}(1) \\cap N_{k}(2)| = 5 + 5 - 3 = 7\n$$\nThe result is consistent.\n\nFinally, we compute the edge weight $w_{12}$ by substituting the calculated cardinalities into the Jaccard similarity formula:\n$$\nw_{12} = \\frac{|N_{k}(1) \\cap N_{k}(2)|}{|N_{k}(1) \\cup N_{k}(2)|} = \\frac{3}{7}\n$$\nThe problem requests the final value as a reduced fraction. The fraction $\\frac{3}{7}$ is already in its simplest form, as $3$ and $7$ are prime numbers.", "answer": "$$\\boxed{\\frac{3}{7}}$$", "id": "3318020"}, {"introduction": "Once a cell-cell graph is built, we need a principled method to evaluate whether a proposed grouping of cells into types, or communities, is statistically significant. The Newman-Girvan modularity, $Q$, provides such a metric by comparing the density of connections within a community to what would be expected by random chance under a null model. In this practice [@problem_id:3317980], you will calculate the modularity gain for a given partition, providing a hands-on grasp of how this fundamental quality score validates the existence of a distinct cell cluster.", "problem": "A single-cell ribonucleic acid sequencing (scRNA-seq) experiment yields a cell-cell similarity graph built by $k$-Nearest Neighbors ($k$-NN) followed by symmetrization into an undirected, unweighted graph. You suspect a rare cell state forming a small, dense subgraph that is connected to a larger, more heterogeneous community. Consider the following abstracted graph-level summary, which is consistent with this scenario and derived from quality-controlled data:\n\n- The graph is undirected with a total of $m = 100$ edges.\n- A candidate rare subgraph $S$ contains $l_{S} = 30$ edges internal to $S$.\n- The large community $L$ contains $l_{L} = 60$ edges internal to $L$.\n- There are $e_{SL} = 10$ edges that connect nodes in $S$ to nodes in $L$.\n\nAssume the Newman–Girvan modularity under the configuration-model null for undirected graphs. Compute the modularity gain $\\Delta Q$ when partitioning the graph into two communities $\\{S, L\\}$ compared to treating all nodes as a single community. Based on the sign of $\\Delta Q$, briefly decide whether the rare subgraph $S$ forms its own cluster under modularity maximization. Express your final answer for $\\Delta Q$ as an exact fraction with no rounding and no units.", "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- The graph is undirected and unweighted.\n- Total number of edges: $m = 100$.\n- The graph is partitioned into two communities, a candidate rare subgraph $S$ and a large community $L$.\n- Number of edges internal to community $S$: $l_{S} = 30$.\n- Number of edges internal to community $L$: $l_{L} = 60$.\n- Number of edges connecting community $S$ to community $L$: $e_{SL} = 10$.\n- The null model is the configuration model for undirected graphs.\n- The task is to compute the modularity gain $\\Delta Q$ for the partition $\\{S, L\\}$ relative to a single community.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Groundedness**: The problem is well-grounded in computational systems biology and network science. Modularity, as defined by Newman and Girvan, is a standard metric for community detection, and the configuration model is a standard null model. The scenario described is a common problem in the analysis of scRNA-seq data.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary information to calculate the modularity for the specified partition. The question is unambiguous.\n- **Consistency**: The problem's givens are internally consistent. The total number of edges $m$ must be the sum of edges internal to each community and the edges connecting them. We can verify this: $l_{S} + l_{L} + e_{SL} = 30 + 60 + 10 = 100$, which matches the given total $m=100$.\n- **Objectivity**: The problem is stated in precise, objective language.\n- **Conclusion**: The problem is valid, as it is scientifically sound, self-contained, consistent, and well-posed.\n\n### Solution Derivation\nThe modularity, $Q$, of a partitioned graph is defined as the fraction of edges that fall within the given communities minus the expected value of the same fraction in a randomized graph with the same degree sequence (the configuration model). The formula for a partition into a set of communities $\\{c\\}$ is:\n$$Q = \\sum_{c} \\left[ \\frac{l_c}{m} - \\left(\\frac{d_c}{2m}\\right)^2 \\right]$$\nwhere:\n- $m$ is the total number of edges in the graph.\n- $l_c$ is the number of edges completely within community $c$.\n- $d_c$ is the sum of the degrees of all nodes in community $c$.\n\nThe problem asks for the modularity gain, $\\Delta Q$, when partitioning the graph into two communities, $\\{S, L\\}$, compared to the baseline of treating all nodes as a single community, $\\{U\\}$.\n$$\\Delta Q = Q_{\\{S,L\\}} - Q_{\\{U\\}}$$\nFirst, we consider the case of a single community $U$ containing all nodes. In this case, all edges are internal, so $l_U = m$. The sum of degrees for all nodes is $d_U = 2m$. The modularity is:\n$$Q_{\\{U\\}} = \\frac{l_U}{m} - \\left(\\frac{d_U}{2m}\\right)^2 = \\frac{m}{m} - \\left(\\frac{2m}{2m}\\right)^2 = 1 - 1^2 = 0$$\nThe modularity of an unpartitioned graph is always $0$. Therefore, the modularity gain is simply the modularity of the proposed partition:\n$$\\Delta Q = Q_{\\{S,L\\}} - 0 = Q_{\\{S,L\\}}$$\nNow, we calculate $Q_{\\{S,L\\}}$. The formula expands to:\n$$Q_{\\{S,L\\}} = \\left[ \\frac{l_S}{m} - \\left(\\frac{d_S}{2m}\\right)^2 \\right] + \\left[ \\frac{l_L}{m} - \\left(\\frac{d_L}{2m}\\right)^2 \\right]$$\nWe are given $m=100$, $l_S=30$, and $l_L=60$. We need to find $d_S$ and $d_L$. The sum of degrees for a community's nodes, $d_c$, can be calculated by summing the degrees of its member nodes. This sum is equal to twice the number of internal edges plus the number of a community's edges that connect to other communities.\n\nFor community $S$:\nThe number of internal edges is $l_S = 30$. The number of external edges is $e_{SL} = 10$.\nThe sum of degrees is $d_S = 2l_S + e_{SL} = 2(30) + 10 = 60 + 10 = 70$.\n\nFor community $L$:\nThe number of internal edges is $l_L = 60$. The number of external edges is also $e_{SL} = 10$.\nThe sum of degrees is $d_L = 2l_L + e_{SL} = 2(60) + 10 = 120 + 10 = 130$.\n\nAs a consistency check, the total sum of degrees in the graph must be $d_S + d_L = 70 + 130 = 200$. This is equal to $2m = 2(100) = 200$, so our calculations are correct.\n\nNow, we substitute these values into the modularity formula:\n$$\\Delta Q = Q_{\\{S,L\\}} = \\left[ \\frac{30}{100} - \\left(\\frac{70}{2 \\cdot 100}\\right)^2 \\right] + \\left[ \\frac{60}{100} - \\left(\\frac{130}{2 \\cdot 100}\\right)^2 \\right]$$\n$$\\Delta Q = \\left[ \\frac{3}{10} - \\left(\\frac{70}{200}\\right)^2 \\right] + \\left[ \\frac{6}{10} - \\left(\\frac{130}{200}\\right)^2 \\right]$$\n$$\\Delta Q = \\left[ \\frac{3}{10} - \\left(\\frac{7}{20}\\right)^2 \\right] + \\left[ \\frac{6}{10} - \\left(\\frac{13}{20}\\right)^2 \\right]$$\n$$\\Delta Q = \\left[ \\frac{3}{10} - \\frac{49}{400} \\right] + \\left[ \\frac{6}{10} - \\frac{169}{400} \\right]$$\nCombine terms:\n$$\\Delta Q = \\frac{3}{10} + \\frac{6}{10} - \\frac{49}{400} - \\frac{169}{400}$$\n$$\\Delta Q = \\frac{9}{10} - \\frac{49 + 169}{400}$$\n$$\\Delta Q = \\frac{9}{10} - \\frac{218}{400}$$\nTo subtract, we find a common denominator, which is $400$:\n$$\\Delta Q = \\frac{9 \\cdot 40}{10 \\cdot 40} - \\frac{218}{400} = \\frac{360}{400} - \\frac{218}{400}$$\n$$\\Delta Q = \\frac{360 - 218}{400} = \\frac{142}{400}$$\nFinally, we simplify the fraction by dividing the numerator and denominator by their greatest common divisor, which is $2$:\n$$\\Delta Q = \\frac{71}{200}$$\nThe problem also asks to decide whether $S$ forms its own cluster based on the sign of $\\Delta Q$. Since $\\Delta Q = \\frac{71}{200} > 0$, the modularity of the partition $\\{S, L\\}$ is positive. This means that the density of edges within communities $S$ and $L$ is greater than what would be expected by random chance under the configuration model. Modularity maximization algorithms seek partitions with high positive $Q$ values. A positive $\\Delta Q$ relative to the unpartitioned state indicates that the proposed partition is a structurally meaningful improvement. Therefore, based on this metric, the subgraph $S$ does form its own distinct cluster.", "answer": "$$\\boxed{\\frac{71}{200}}$$", "id": "3317980"}, {"introduction": "A well-known challenge with standard modularity is its \"resolution limit,\" which can cause algorithms to overlook small but tightly connected communities, such as those representing a rare cell type. To overcome this, a resolution parameter, $\\gamma$, is introduced to tune the size of communities the algorithm seeks. This problem [@problem_id:3317960] challenges you to derive the critical resolution value $\\gamma_c$ required to resolve a small, distinct clique, demonstrating mathematically how to adapt community detection for structures of different scales.", "problem": "A common approach to cell type identification in Single-cell Ribonucleic Acid sequencing (scRNA-seq) is to construct a cell-cell similarity graph and then perform community detection using modularity maximization with a tunable resolution parameter $\\gamma$. Consider an undirected, unweighted toy graph modeling a scRNA-seq k-nearest neighbor similarity: a larger component is a complete graph (clique) of size $L$ and a rare component is a smaller complete graph of size $S$. These two components are connected by exactly one inter-component edge between a single node in the large clique and a single node in the small clique. Let $L=12$ and $S=4$. Let $A_{ij}$ be the adjacency matrix, $k_{i}$ the degree of node $i$, $m$ the total number of edges, and $\\delta(c_{i},c_{j})$ the Kronecker delta indicating whether nodes $i$ and $j$ belong to the same community. The generalized Newman–Girvan modularity with resolution parameter $\\gamma$ is defined by\n$$\nQ(\\gamma)=\\frac{1}{2m}\\sum_{i}\\sum_{j}\\left(A_{ij}-\\gamma\\frac{k_i k_j}{2m}\\right)\\delta(c_i,c_j).\n$$\nAssume no self-loops and symmetry $A_{ij}=A_{ji}$. Using only the definition above and first principles about degrees and edge counts in cliques, compute $Q(\\gamma)$ for two partitions: (i) all $L+S$ nodes in a single community, and (ii) two communities where the rare $S$-node clique is separated from the $L$-node clique. Derive the exact critical resolution value $\\gamma_{c}$ at which the two-community partition has strictly larger modularity than the single-community partition. Provide your final answer for $\\gamma_{c}$ as a single exact rational expression. State clearly the inequality that characterizes the range of $\\gamma$ that separates the rare clique, but report only $\\gamma_{c}$ in your final answer.", "solution": "The problem statement is a valid, well-posed question in the domain of graph theory as applied to computational systems biology. It is scientifically grounded, objective, and provides all necessary information to derive a unique solution.\n\nThe problem asks for the critical resolution parameter $\\gamma_c$ at which a two-community partition of a specific graph becomes more favorable (i.e., has a higher modularity score) than a single-community partition. The graph consists of a complete graph (clique) of size $L=12$ and a smaller clique of size $S=4$, connected by a single edge.\n\nFirst, we characterize the graph's properties.\nLet the large clique be $C_L'$ and the small clique be $C_S'$.\nThe number of nodes is $N = L+S = 12+4=16$.\nThe number of edges within the $L$-clique is $\\frac{L(L-1)}{2} = \\frac{12(11)}{2} = 66$.\nThe number of edges within the $S$-clique is $\\frac{S(S-1)}{2} = \\frac{4(3)}{2} = 6$.\nThere is one inter-component edge connecting the two cliques.\nThe total number of edges, $m$, in the graph is the sum of these, so $m = 66 + 6 + 1 = 73$.\n\nNext, we determine the degrees $k_i$ of all nodes $i$.\nFor the nodes in the larger clique of size $L$:\n- $L-1 = 11$ nodes are connected only to other nodes within the clique. Their degree is $k_i = L-1 = 11$.\n- One node is connected to the other $L-1$ nodes in its clique and also to one node in the smaller clique. Its degree is $k_i = (L-1) + 1 = L = 12$.\n\nFor the nodes in the smaller clique of size $S$:\n- $S-1 = 3$ nodes are connected only to other nodes within the clique. Their degree is $k_i = S-1 = 3$.\n- One node is connected to the other $S-1$ nodes in its clique and also to the node in the larger clique. Its degree is $k_i = (S-1) + 1 = S = 4$.\n\nThe sum of all degrees is $\\sum_i k_i = (11 \\times 11) + (1 \\times 12) + (3 \\times 3) + (1 \\times 4) = 121 + 12 + 9 + 4 = 146$. This matches $2m = 2 \\times 73 = 146$, as expected.\n\nThe modularity $Q(\\gamma)$ is given by:\n$$Q(\\gamma)=\\frac{1}{2m}\\sum_{i}\\sum_{j}\\left(A_{ij}-\\gamma\\frac{k_i k_j}{2m}\\right)\\delta(c_i,c_j)$$\nThis can be rewritten by summing over communities $c$:\n$$Q(\\gamma) = \\sum_c \\left[ \\frac{e_c}{m} - \\gamma \\left(\\frac{d_c}{2m}\\right)^2 \\right]$$\nwhere $e_c$ is the number of edges within community $c$, and $d_c = \\sum_{i \\in c} k_i$ is the sum of the degrees of the nodes in community $c$.\n\nWe will now compute the modularity for the two specified partitions.\n\nCase (i): All $L+S$ nodes in a single community.\nLet this partition be $P_1$. There is only one community, $c_1$, which is the entire graph.\n- The number of edges within this community is the total number of edges, so $e_1 = m = 73$.\n- The sum of degrees of nodes in this community is the sum of all degrees, so $d_1 = \\sum_i k_i = 2m = 146$.\n\nThe modularity $Q_1(\\gamma)$ for this partition is:\n$$Q_1(\\gamma) = \\frac{e_1}{m} - \\gamma \\left(\\frac{d_1}{2m}\\right)^2 = \\frac{m}{m} - \\gamma \\left(\\frac{2m}{2m}\\right)^2 = 1 - \\gamma$$\n\nCase (ii): Two communities, one for the $L$-node clique ($C_L$) and one for the $S$-node clique ($C_S$).\nLet this partition be $P_2$. The single inter-component edge is cut by this partition.\n- Community $C_L$ consists of the $L=12$ nodes of the larger clique. The number of edges entirely within this community, $e_L$, is the number of edges in a complete graph of size $L$.\n$e_L = \\frac{L(L-1)}{2} = \\frac{12(11)}{2} = 66$.\n- Community $C_S$ consists of the $S=4$ nodes of the smaller clique. The number of edges entirely within this community, $e_S$, is the number of edges in a complete graph of size $S$.\n$e_S = \\frac{S(S-1)}{2} = \\frac{4(3)}{2} = 6$.\n\nThe sum of degrees for each community, $d_L$ and $d_S$, uses the degrees $k_i$ from the full graph.\n- For $C_L$: $d_L = \\sum_{i \\in C_L} k_i = (L-1)(L-1) + L = (11)(11) + 12 = 121 + 12 = 133$.\n- For $C_S$: $d_S = \\sum_{i \\in C_S} k_i = (S-1)(S-1) + S = (3)(3) + 4 = 9 + 4 = 13$.\nAs a check, $d_L + d_S = 133 + 13 = 146 = 2m$.\n\nThe modularity $Q_2(\\gamma)$ for this partition is the sum of contributions from each community:\n$$Q_2(\\gamma) = \\left[ \\frac{e_L}{m} - \\gamma \\left(\\frac{d_L}{2m}\\right)^2 \\right] + \\left[ \\frac{e_S}{m} - \\gamma \\left(\\frac{d_S}{2m}\\right)^2 \\right]$$\n$$Q_2(\\gamma) = \\frac{e_L + e_S}{m} - \\gamma \\left[ \\left(\\frac{d_L}{2m}\\right)^2 + \\left(\\frac{d_S}{2m}\\right)^2 \\right]$$\nSubstituting the values we calculated:\n$e_L + e_S = 66 + 6 = 72$.\n$m=73$.\n$d_L = 133$.\n$d_S = 13$.\n$2m = 146$.\n$$Q_2(\\gamma) = \\frac{72}{73} - \\gamma \\left[ \\frac{133^2 + 13^2}{146^2} \\right]$$\n\nThe two-community partition is preferred when $Q_2(\\gamma) > Q_1(\\gamma)$. The critical resolution $\\gamma_c$ is the value where the two modularities are equal, i.e., $Q_2(\\gamma_c) = Q_1(\\gamma_c)$.\n$$ \\frac{e_L + e_S}{m} - \\gamma_c \\frac{d_L^2 + d_S^2}{(2m)^2} = 1 - \\gamma_c $$\nRearranging to solve for $\\gamma_c$:\n$$ \\gamma_c \\left( 1 - \\frac{d_L^2 + d_S^2}{(2m)^2} \\right) = 1 - \\frac{e_L + e_S}{m} $$\nThe left side term in the parenthesis can be simplified using $2m = d_L + d_S$:\n$$ 1 - \\frac{d_L^2 + d_S^2}{(d_L+d_S)^2} = \\frac{(d_L+d_S)^2 - (d_L^2 + d_S^2)}{(d_L+d_S)^2} = \\frac{2d_L d_S}{(d_L+d_S)^2} = \\frac{2d_L d_S}{(2m)^2} $$\nThe right side of the equation is:\n$$ 1 - \\frac{e_L + e_S}{m} = \\frac{m - (e_L + e_S)}{m} $$\nSince $e_L+e_S$ represents all edges except the one connecting edge, $m = (e_L+e_S)+1$, so $m - (e_L+e_S) = 1$. The right side is $\\frac{1}{m}$.\nSubstituting these back into the equation for $\\gamma_c$:\n$$ \\gamma_c \\left( \\frac{2d_L d_S}{(2m)^2} \\right) = \\frac{1}{m} $$\n$$ \\gamma_c = \\frac{1}{m} \\frac{(2m)^2}{2d_L d_S} = \\frac{4m^2}{2m d_L d_S} = \\frac{2m}{d_L d_S} $$\nThis provides a general formula for the critical resolution in this graph topology. The condition to separate the rare clique is $\\gamma > \\gamma_c = \\frac{2m}{d_L d_S}$.\n\nNow, we substitute the numerical values:\n$m=73$, $d_L=133$, $d_S=13$.\n$$ \\gamma_c = \\frac{2 \\times 73}{133 \\times 13} = \\frac{146}{1729} $$\nThe numerator is $2 \\times 73$. The denominator is not divisible by $2$. For $73$, $1729 \\div 73 = 23.68...$. $133 \\times 13 = 1729$. Neither 133 nor 13 are divisible by 73. Therefore, the fraction is irreducible.\n\nThe range of $\\gamma$ for which the two-community partition has strictly larger modularity is $\\gamma > \\frac{146}{1729}$. The critical value is $\\gamma_c$.", "answer": "$$\\boxed{\\frac{146}{1729}}$$", "id": "3317960"}]}