{"hands_on_practices": [{"introduction": "The hallmark of the genetic toggle switch is its capacity for bistability—the ability to exist in two distinct stable states. This practice guides you through the fundamental analysis of this behavior by computationally constructing a bifurcation diagram. You will explore how a control parameter can switch the system between its states and quantify the resulting hysteresis, a key memory-like property of the circuit [@problem_id:3328029].", "problem": "Consider a deterministic model for a two-gene toggle switch with mutual repression, in which each gene product represses the transcription of the other via a cooperative binding mechanism. Begin from a minimal gene regulation framework grounded in the Central Dogma of Molecular Biology (DNA to RNA to Protein) and standard chemical kinetics for synthesis and degradation: the time-evolution of the concentration of a gene product is given by synthesis minus degradation, and transcriptional repression is represented by a decreasing Hill function that arises from equilibrium occupancy of a promoter with $n$-cooperative repressor binding sites. Specifically, derive a coupled ordinary differential equation system for the concentrations $x$ and $y$ of the two gene products, justify the choice of a Hill repression function on scientific grounds, and define a control parameter $u$ that biases the two synthesis rates in opposite directions while keeping all rates nonnegative. Use these equations to compute steady states, assess their linear stability via the Jacobian, and construct a bifurcation diagram by scanning the control parameter $u$. Quantify hysteresis width as the difference between the high and low control parameter values delimiting the region of bistability (two distinct linearly stable steady states separated by an unstable one).\n\nLet $x$ and $y$ denote concentrations, with synthesis rates modulated by a control parameter $u$ that tilts the system: let $\\alpha_{1}(u) = \\alpha\\,(1+u)$ and $\\alpha_{2}(u) = \\alpha\\,(1-u)$, with $u \\in [-u_{\\max}, u_{\\max}]$ and $0 \\le \\alpha_{i}(u)$ for all admissible $u$. Let degradation be linear with a rate constant $\\delta > 0$. Let repression have a Hill-form dependence with half-saturation $K > 0$ and Hill coefficient $n \\ge 1$. The task is to implement the system\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}} - \\delta\\,x,\\qquad\n\\frac{dy}{dt} = \\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}} - \\delta\\,y,\n$$\nand rigorously analyze it. For each fixed $u$, compute all nonnegative steady states $(x^{\\ast}, y^{\\ast})$ that solve\n$$\n0 = \\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}} - \\delta\\,x,\\qquad\n0 = \\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}} - \\delta\\,y.\n$$\nEstablish linear stability by evaluating the Jacobian matrix\n$$\nJ(x,y;u) =\n\\begin{pmatrix}\n-\\delta & \\frac{\\partial}{\\partial y}\\left[\\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}}\\right] \\\\\n\\frac{\\partial}{\\partial x}\\left[\\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}}\\right] & -\\delta\n\\end{pmatrix},\n$$\nand determining the eigenvalues of $J$ at the steady state; a steady state is linearly stable if and only if all eigenvalues of $J$ have strictly negative real parts. Construct the bifurcation diagram by scanning $u \\in [-u_{\\max}, u_{\\max}]$ over a uniform grid, and for each $u$ computing the number of distinct linearly stable steady states. Define the hysteresis width $W$ as $W = u_{\\text{high}} - u_{\\text{low}}$, where $u_{\\text{low}}$ is the smallest value of $u$ for which the system exhibits two linearly stable steady states, and $u_{\\text{high}}$ is the largest value of $u$ for which the system exhibits two linearly stable steady states. If no bistability is present for any $u$ in the scan, report $W = 0$ and set $u_{\\text{low}} = 0$ and $u_{\\text{high}} = 0$.\n\nUse the following test suite of parameter values to ensure coverage of different regimes:\n- Case $1$ (strong cooperativity, expected bistability): $\\alpha = 12$, $\\delta = 1$, $K = 1$, $n = 3$, $u_{\\max} = 0.9$.\n- Case $2$ (no cooperativity, expected monostability): $\\alpha = 4$, $\\delta = 1$, $K = 1$, $n = 1$, $u_{\\max} = 0.9$.\n- Case $3$ (moderate cooperativity, near boundary): $\\alpha = 8$, $\\delta = 1$, $K = 1$, $n = 2$, $u_{\\max} = 0.9$.\n\nFor each case, scan $u$ uniformly over the interval $[-u_{\\max}, u_{\\max}]$ using a grid of at least $M = 161$ points. For each $u$, compute all distinct nonnegative steady states and classify them by linear stability. Then, compute and return a list of four values per case: $[W, u_{\\text{low}}, u_{\\text{high}}, B]$, where $W$ is the hysteresis width as a real number, $u_{\\text{low}}$ and $u_{\\text{high}}$ are the lowest and highest $u$ values (real numbers) at which two linearly stable steady states are found, and $B$ is a boolean indicating whether bistability was found anywhere in the scan. If no bistability occurs, return $[0.0, 0.0, 0.0, \\text{False}]$.\n\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets and arranged in order Case $1$, Case $2$, Case $3$. For example, the output should look like $[[W_{1},u_{\\text{low},1},u_{\\text{high},1},B_{1}],[W_{2},u_{\\text{low},2},u_{\\text{high},2},B_{2}],[W_{3},u_{\\text{low},3},u_{\\text{high},3},B_{3}]]$. No physical units are involved; all quantities are dimensionless real numbers.", "solution": "The problem presents a deterministic model of a genetic toggle switch, a foundational synthetic biology circuit. The task is to analyze its dynamics, specifically its steady states and their stability, as a function of a control parameter $u$. The analysis begins with a justification of the model's form, followed by a computational procedure to determine the region of bistability and the associated hysteresis width.\n\n**1. Scientific Justification of the Hill Repression Function**\n\nThe model employs a Hill function to describe transcriptional repression. This functional form is not arbitrary but arises from the physical chemistry of transcription factor binding to DNA. Consider one of the genes in the switch, say the gene producing protein $X$, which is repressed by protein $Y$. The rate of synthesis of $X$ is proportional to the fraction of its promoters that are not bound by the repressor $Y$.\n\nLet $P$ be the promoter region of the gene for $X$, and let $R$ be the repressor protein $Y$. The binding of $n$ molecules of the repressor to the promoter occurs via a cooperative reaction:\n$$\nP + nR \\rightleftharpoons PR_n\n$$\nwhere $PR_n$ is the inactive promoter-repressor complex. At chemical equilibrium, the law of mass action gives the dissociation constant $K_d$ as:\n$$\nK_d = \\frac{[P][R]^n}{[PR_n]}\n$$\nHere, $[P]$ is the concentration of free promoters, $[R]$ is the concentration of the repressor (denoted by $y$ in the problem), and $[PR_n]$ is the concentration of the bound complex. The total concentration of promoters, $[P]_{\\text{total}}$, is the sum of free and bound promoters: $[P]_{\\text{total}} = [P] + [PR_n]$.\n\nThe rate of transcription is assumed to be proportional to the fraction of promoters that are free (active), which we denote by $\\theta_{\\text{active}}$:\n$$\n\\theta_{\\text{active}} = \\frac{[P]}{[P]_{\\text{total}}} = \\frac{[P]}{[P] + [PR_n]}\n$$\nBy rearranging the equilibrium equation, we have $[PR_n] = \\frac{[P][R]^n}{K_d}$. Substituting this into the expression for $\\theta_{\\text{active}}$ yields:\n$$\n\\theta_{\\text{active}} = \\frac{[P]}{[P] + \\frac{[P][R]^n}{K_d}} = \\frac{1}{1 + \\frac{[R]^n}{K_d}}\n$$\nBy defining a constant $K = K_d^{1/n}$, known as the half-saturation constant or Hill constant, this expression takes the canonical Hill form:\n$$\n\\theta_{\\text{active}} = \\frac{1}{1 + \\left(\\frac{[R]}{K}\\right)^n}\n$$\nThe synthesis rate of protein $X$ is the maximal synthesis rate, $\\alpha_1(u)$, multiplied by this fraction of active promoters. This justifies the synthesis term in the first differential equation. An analogous argument applies to the repression of gene $Y$ by protein $X$. The integer $n$ is the Hill coefficient, representing the degree of cooperativity in repressor binding. A value of $n>1$ signifies cooperative binding, leading to a steeper, switch-like response.\n\n**2. Steady-State Analysis**\n\nThe steady states $(x^{\\ast}, y^{\\ast})$ of the system are the non-negative solutions to the coupled algebraic equations where the time derivatives are zero:\n$$\n\\frac{dx}{dt} = 0 \\implies \\delta x^{\\ast} = \\frac{\\alpha_1(u)}{1 + (y^{\\ast}/K)^n}\n$$\n$$\n\\frac{dy}{dt} = 0 \\implies \\delta y^{\\ast} = \\frac{\\alpha_2(u)}{1 + (x^{\\ast}/K)^n}\n$$\nThese equations define the nullclines of the system. The steady states are the intersection points of these two nullclines in the $x,y$-plane. To find these points, we can express one variable in terms of the other from one equation and substitute it into the second. From the second equation, we solve for $y^{\\ast}$:\n$$\ny^{\\ast} = \\frac{\\alpha_2(u)/\\delta}{1 + (x^{\\ast}/K)^n}\n$$\nSubstituting this into the first equation gives a single equation for $x^{\\ast}$:\n$$\nx^{\\ast} = \\frac{\\alpha_1(u)/\\delta}{1 + \\left( \\frac{1}{K} \\left( \\frac{\\alpha_2(u)/\\delta}{1 + (x^{\\ast}/K)^n} \\right) \\right)^n}\n$$\nThis is a highly nonlinear equation in $x^{\\ast}$. For a given set of parameters $(u, \\alpha, \\delta, K, n)$, the roots of this equation correspond to the $x$-coordinates of the steady states. Due to the sigmoidal nature of the right-hand side as a function of $x^{\\ast}$, there can be one or three positive solutions, corresponding to monostability or bistability, respectively. These roots are found numerically.\n\n**3. Linear Stability Analysis**\n\nTo determine the stability of each steady state $(x^{\\ast}, y^{\\ast})$, we linearize the system by evaluating the Jacobian matrix $J$ at that state:\n$$\nJ(x^{\\ast}, y^{\\ast}) =\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x}(\\dot{x}) & \\frac{\\partial}{\\partial y}(\\dot{x}) \\\\\n\\frac{\\partial}{\\partial x}(\\dot{y}) & \\frac{\\partial}{\\partial y}(\\dot{y})\n\\end{pmatrix}_{(x^{\\ast}, y^{\\ast})}\n=\n\\begin{pmatrix}\n-\\delta & J_{12} \\\\\nJ_{21} & -\\delta\n\\end{pmatrix}\n$$\nThe off-diagonal elements are:\n$$\nJ_{12} = \\frac{\\partial}{\\partial y}\\left[\\frac{\\alpha_{1}(u)}{1 + (y/K)^n}\\right]\\bigg|_{y=y^{\\ast}} = -\\frac{n \\alpha_{1}(u) (y^{\\ast})^{n-1}}{K^n (1 + (y^{\\ast}/K)^n)^2}\n$$\n$$\nJ_{21} = \\frac{\\partial}{\\partial x}\\left[\\frac{\\alpha_{2}(u)}{1 + (x/K)^n}\\right]\\bigg|_{x=x^{\\ast}} = -\\frac{n \\alpha_{2}(u) (x^{\\ast})^{n-1}}{K^n (1 + (x^{\\ast}/K)^n)^2}\n$$\nThe eigenvalues $\\lambda$ of the Jacobian are given by the characteristic equation $\\det(J - \\lambda I) = 0$, which simplifies to $(-\\delta - \\lambda)^2 - J_{12}J_{21} = 0$. The solutions are $\\lambda = -\\delta \\pm \\sqrt{J_{12}J_{21}}$. Since $\\alpha_i(u) \\ge 0$, $n \\ge 1$, and $K > 0$, both $J_{12}$ and $J_{21}$ are non-positive, making their product $J_{12}J_{21}$ non-negative. Thus, the eigenvalues are always real. A steady state is linearly stable if and only if all eigenvalues have strictly negative real parts. The eigenvalue $\\lambda_2 = -\\delta - \\sqrt{J_{12}J_{21}}$ is always negative because $\\delta > 0$. Stability is therefore determined by the sign of $\\lambda_1 = -\\delta + \\sqrt{J_{12}J_{21}}$. For stability, we require $\\lambda_1 < 0$, which implies $\\sqrt{J_{12}J_{21}} < \\delta$, or $J_{12}J_{21} < \\delta^2$.\n\nThis condition can be simplified. Using the steady-state equations, the Jacobian elements can be rewritten as:\n$$\nJ_{12} = -n \\frac{\\delta x^{\\ast}}{y^{\\ast}} \\frac{(y^{\\ast}/K)^n}{1+(y^{\\ast}/K)^n} \\quad \\text{and} \\quad J_{21} = -n \\frac{\\delta y^{\\ast}}{x^{\\ast}} \\frac{(x^{\\ast}/K)^n}{1+(x^{\\ast}/K)^n}\n$$\nTheir product is $J_{12}J_{21} = n^2 \\delta^2 A_x A_y$, where $A_x = \\frac{(x^{\\ast}/K)^n}{1+(x^{\\ast}/K)^n}$ and $A_y = \\frac{(y^{\\ast}/K)^n}{1+(y^{\\ast}/K)^n}$. The stability criterion becomes $n^2 \\delta^2 A_x A_y < \\delta^2$, which simplifies to:\n$$\nn^2 A_x A_y < 1\n$$\nThis elegant condition, relating the Hill coefficient and the saturation levels of the repressors, is used to classify each steady state.\n\n**4. Numerical Algorithm for Hysteresis Analysis**\n\nThe final task is to compute the hysteresis width $W$ for the given parameter sets. This is achieved through the following numerical procedure:\n1.  Discretize the control parameter range $[-u_{\\max}, u_{\\max}]$ into a uniform grid of $M \\ge 161$ points, denoted $\\{u_i\\}$.\n2.  For each value $u_i$ in the grid:\n    a.  Numerically find all non-negative roots $x^{\\ast}$ of the steady-state equation $x - F(x; u_i) = 0$, where $F(x; u_i) = \\frac{\\alpha_1(u_i)/\\delta}{1 + \\left( \\frac{\\alpha_2(u_i)/(\\delta K)}{1 + (x/K)^n} \\right)^n}$. This is accomplished by scanning a fine grid of $x$ values for sign changes in $x - F(x; u_i)$ to bracket the roots, followed by a precise root-finding algorithm like the Brent-Dekker method for each bracketed interval.\n    b.  For each root $x^{\\ast}$, calculate the corresponding $y^{\\ast} = \\frac{\\alpha_2(u_i)/\\delta}{1+(x^{\\ast}/K)^n}$.\n    c.  Evaluate the stability of each steady state $(x^{\\ast}, y^{\\ast})$ using the condition $n^2 A_x A_y < 1$.\n    d.  Count the number of distinct, linearly stable steady states.\n3.  Identify the set of all $u_i$ values for which exactly two stable steady states were found.\n4.  If this set is empty, no bistability exists in the scanned range. Report $W=0.0$, $u_{\\text{low}}=0.0$, $u_{\\text{high}}=0.0$, and a boolean flag for bistability as False.\n5.  If the set is non-empty, determine $u_{\\text{low}}$ as the minimum value and $u_{\\text{high}}$ as the maximum value in the set. The hysteresis width is then $W = u_{\\text{high}} - u_{\\text{low}}$. Report $[W, u_{\\text{low}}, u_{\\text{high}}, \\text{True}]$.\nThis algorithm robustly determines the bistable region and quantifies the hysteresis width as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef compute_hysteresis(alpha, delta, K, n, u_max):\n    \"\"\"\n    Computes the hysteresis width for the genetic toggle switch model.\n\n    Args:\n        alpha (float): Basal synthesis rate parameter.\n        delta (float): Degradation rate constant.\n        K (float): Half-saturation constant (Hill constant).\n        n (float): Hill coefficient.\n        u_max (float): Maximum value of the control parameter u.\n\n    Returns:\n        list: A list containing [W, u_low, u_high, B], where W is the\n              hysteresis width, u_low and u_high are the boundaries of the\n              bistable region, and B is a boolean indicating if bistability\n              was found.\n    \"\"\"\n    \n    # Define the steady state function whose roots we need to find.\n    # We solve x - F(x) = 0.\n    def F(x, u, alpha, delta, K, n):\n        alpha1_u = alpha * (1 + u)\n        alpha2_u = alpha * (1 - u)\n        \n        # Avoid division by zero or invalid operations if x is negative, though we only search x >= 0.\n        if isinstance(x, np.ndarray):\n            x[x<0] = 0\n        elif x < 0:\n            x = 0\n\n        y_val_term = (alpha2_u / delta) / (1 + (x / K)**n)\n        return (alpha1_u / delta) / (1 + (y_val_term / K)**n)\n\n    M = 161\n    u_grid = np.linspace(-u_max, u_max, M)\n    bistable_u_points = []\n\n    # Define a safe upper bound for the root search range of x.\n    # The max possible value of x is alpha * (1 + u_max) / delta. Add a margin.\n    x_search_max = alpha * (1 + u_max) / delta + 5.0\n    x_search_grid_size = 10000\n    x_grid = np.linspace(0, x_search_max, x_search_grid_size)\n\n    for u in u_grid:\n        \n        # Function for root finding: g(x) = x - F(x) = 0\n        g = lambda x: x - F(x, u, alpha, delta, K, n)\n        \n        roots = set()\n        \n        # Scan for sign changes to bracket roots\n        g_vals = g(x_grid)\n        for i in range(len(x_grid) - 1):\n            if np.sign(g_vals[i]) != np.sign(g_vals[i+1]):\n                try:\n                    root = brentq(g, x_grid[i], x_grid[i+1])\n                    # Add root rounded to a certain precision to avoid duplicates\n                    roots.add(round(root, 8)) \n                except (RuntimeError, ValueError):\n                    # brentq can fail if the signs are not different at endpoints,\n                    # which can happen with floating point inaccuracies.\n                    pass\n        \n        n_stable_states = 0\n        for x_star in roots:\n            if x_star < 0: continue\n            \n            alpha2_u = alpha * (1 - u)\n            y_star = (alpha2_u / delta) / (1 + (x_star / K)**n)\n            \n            if y_star < 0: continue\n\n            # Stability condition: n^2 * Ax * Ay < 1\n            # Handle potential division by zero if K=0 (not in test cases) or x_star/y_star= -1 (not possible)\n            Ax_num = (x_star / K)**n\n            Ax = Ax_num / (1 + Ax_num)\n\n            Ay_num = (y_star / K)**n\n            Ay = Ay_num / (1 + Ay_num)\n            \n            if (n**2) * Ax * Ay < 1:\n                n_stable_states += 1\n        \n        if n_stable_states == 2:\n            bistable_u_points.append(u)\n\n    if not bistable_u_points:\n        return [0.0, 0.0, 0.0, False]\n    else:\n        u_low = min(bistable_u_points)\n        u_high = max(bistable_u_points)\n        W = u_high - u_low\n        return [W, u_low, u_high, True]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (strong cooperativity, expected bistability)\n        (12.0, 1.0, 1.0, 3.0, 0.9),\n        # Case 2 (no cooperativity, expected monostability)\n        (4.0, 1.0, 1.0, 1.0, 0.9),\n        # Case 3 (moderate cooperativity, near boundary)\n        (8.0, 1.0, 1.0, 2.0, 0.9)\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = compute_hysteresis(*case_params)\n        results.append(result)\n\n    # Format output to be a single-line list of lists with no spaces\n    # e.g., [[W1,ulow1,uhigh1,B1],[W2,ulow2,uhigh2,B2],...]\n    result_strings = []\n    for res in results:\n        # Format boolean as required (True/False)\n        bool_str = str(res[3])\n        # Manually construct string for each inner list to control spacing\n        res_str = f\"[{res[0]},{res[1]},{res[2]},{bool_str}]\"\n        result_strings.append(res_str)\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3328029"}, {"introduction": "While knowing that a system is bistable is crucial, understanding its global behavior is equally important for predicting its response in a biological context. This exercise moves beyond local stability to the concept of basins of attraction, challenging you to numerically map which initial conditions lead to which final state. By quantifying the size of these basins, you will develop a concrete measure of the system's robustness to perturbations, a critical concept in synthetic circuit design [@problem_id:3328034].", "problem": "You are to model a symmetric genetic toggle switch in which two repressor proteins mutually inhibit each other’s expression. The dynamical system is represented in nondimensional form by two ordinary differential equations based on the Hill repression form for transcriptional regulation and linear first-order degradation. The model state is the pair of protein concentrations $\\left(x(t), y(t)\\right)$, where $x(t) \\ge 0$ and $y(t) \\ge 0$ for all $t \\ge 0$. The parameter $n$ is the Hill coefficient (cooperativity), $K$ is the repression threshold, and $\\alpha$ is the maximal nondimensional production rate (identical for both genes). The state evolution is given by\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{y}{K}\\right)^{n}} \\;-\\; x, \n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{x}{K}\\right)^{n}} \\;-\\; y.\n$$\nThe biological justification of the right-hand side uses two well-tested facts: transcriptional repression can be modeled by a Hill function with exponent $n$ and half-effect concentration $K$, and protein degradation/dilution is often well approximated by a first-order linear process after nondimensionalization.\n\nYour task is to compute the basins of attraction for the two asymmetric steady states typically present in a bistable genetic toggle switch (“$x$-high, $y$-low” and “$y$-high, $x$-low”), quantify a global robustness metric for a target state, and study how this metric varies with $(n, K)$. The following principles must be used for design and justification:\n- Start from the above dynamical model and the monotone systems perspective for competitive systems to argue the absence of periodic or chaotic attractors; equivalently, justify that almost all trajectories converge to equilibria by appealing to order-preserving properties and the consequent structure of $\\omega$-limit sets. You may use as a Lyapunov-like surrogate the fact that, for such systems under boundedness and inward-pointing vector fields on a compact positively invariant set, $\\omega$-limit sets consist of equilibria.\n- Use this to justify that the numerical classification of initial conditions by long-time integration is a valid method to approximate basin volumes, since trajectories converge to equilibria and do not exhibit persistent oscillations.\n\nTo define a computable, dimensionless global robustness metric, let the target be the “$x$-high” attractor. For a given parameter pair $(n, K)$, define the robustness $R(n, K)$ as the fraction (area measure on a uniform grid) of initial conditions $(x(0), y(0))$ in a compact domain $\\mathcal{D}$ that converge to the “$x$-high” attractor. Because the system is symmetric and $\\alpha$ is fixed, choose the square domain $\\mathcal{D} = [0,\\alpha] \\times [0,\\alpha]$, which contains all equilibria for the model specified above. Let $\\alpha$ be fixed to $\\alpha = 10$.\n\nNumerically approximate $R(n, K)$ as follows:\n- Use a uniform grid of $M \\times M$ initial conditions over $\\mathcal{D}$ with $M = 25$.\n- For each initial condition, integrate the system from $t = 0$ to $t = T_{\\max}$ with $T_{\\max} = 100$. Use a relative tolerance of $\\mathrm{rtol} = 10^{-8}$ and an absolute tolerance of $\\mathrm{atol} = 10^{-10}$ for numerical integration.\n- Classify a trajectory as converging to the “$x$-high” attractor if its terminal state at $t = T_{\\max}$ satisfies $x(T_{\\max}) - y(T_{\\max}) \\ge \\varepsilon$, and as converging to the “$y$-high” attractor if $y(T_{\\max}) - x(T_{\\max}) \\ge \\varepsilon$, where $\\varepsilon = 10^{-3}$. Trajectories with $|x(T_{\\max}) - y(T_{\\max})| < \\varepsilon$ are considered convergent to a symmetric equilibrium and do not contribute to $R(n, K)$.\n- The approximation of $R(n, K)$ is then the count of initial conditions classified as “$x$-high” divided by $M^2$.\n\nTest suite and required output:\n- Fix $\\alpha = 10$ and $M = 25$, $T_{\\max} = 100$, $\\varepsilon = 10^{-3}$, $\\mathrm{rtol} = 10^{-8}$, $\\mathrm{atol} = 10^{-10}$.\n- Compute $R(n, K)$ for the following $(n, K)$ test cases:\n  1. $(n, K) = (1.0, 1.0)$, a low-cooperativity case expected to be monostable.\n  2. $(n, K) = (2.0, 10.0)$, weak repression (large $K$) expected to be monostable.\n  3. $(n, K) = (3.5, 1.0)$, moderate cooperativity with moderate threshold, typically bistable.\n  4. $(n, K) = (4.0, 0.2)$, strong cooperativity and low threshold, typically bistable.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as above, with each entry being the decimal fraction $R(n, K)$ rounded to four digits after the decimal point. For example, a syntactically valid output would be of the form $[0.0000,0.0000,0.5000,0.5000]$ (this is just an example, not necessarily the correct values).\n\nAll mathematical symbols and numbers in this problem statement are presented in LaTeX notation. No physical units are involved; all quantities are nondimensional. Angles are not used. Percentages must be given as decimal fractions as specified.", "solution": "### Principle-Based Solution\nThe task is to compute a robustness metric, $R(n, K)$, for a genetic toggle switch model by numerically approximating the area of a basin of attraction. The validity of this numerical approach rests on the theoretical properties of the underlying dynamical system.\n\n**Theoretical Foundation**\n\nThe system is given by the equations:\n$$\n\\frac{dx}{dt} = f_1(x, y) = \\frac{\\alpha}{1 + (y/K)^n} - x\n$$\n$$\n\\frac{dy}{dt} = f_2(x, y) = \\frac{\\alpha}{1 + (x/K)^n} - y\n$$\nThis system is a **competitive dynamical system**. This can be formally established by examining the Jacobian matrix of the vector field, $J(x, y)$:\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x} & \\frac{\\partial f_1}{\\partial y} \\\\ \\frac{\\partial f_2}{\\partial x} & \\frac{\\partial f_2}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} -1 & -\\frac{\\alpha n y^{n-1}}{K^n(1 + (y/K)^n)^2} \\\\ -\\frac{\\alpha n x^{n-1}}{K^n(1 + (x/K)^n)^2} & -1 \\end{pmatrix}\n$$\nSince $x, y \\ge 0$ and all parameters are positive, the off-diagonal elements $\\frac{\\partial f_1}{\\partial y}$ and $\\frac{\\partial f_2}{\\partial x}$ are non-positive for all $(x, y)$ in the domain. A system with a Jacobian matrix having non-positive off-diagonal entries is, by definition, a competitive system.\n\nFor such systems, powerful theoretical results constrain the possible long-term behaviors. The domain $\\mathcal{D} = [0, \\alpha] \\times [0, \\alpha]$ is a compact and positively invariant set for the flow. This is because on its boundaries, the vector field points inwards or is tangent to the boundary. For instance, if $x=0$, $\\frac{dx}{dt} = \\frac{\\alpha}{1+(y/K)^n} > 0$. If $x=\\alpha$, $\\frac{dx}{dt} = \\frac{\\alpha}{1+(y/K)^n} - \\alpha \\le 0$. Similar logic holds for the boundaries $y=0$ and $y=\\alpha$.\n\nAccording to the theory of monotone dynamical systems (specifically, results by M.W. Hirsch), for a competitive system on a compact, convex, positively invariant set, the $\\omega$-limit set (the set of accumulation points) of any trajectory is simple. It cannot contain stable periodic orbits or chaotic attractors. For almost all initial conditions, trajectories converge to a stable equilibrium point (a steady state of the system).\n\nThis theoretical guarantee is crucial: it validates the proposed numerical method. By integrating the ODEs for a sufficiently long time $T_{\\max}$, we can be confident that the state of the system $(x(T_{\\max}), y(T_{\\max}))$ will be arbitrarily close to one of the stable equilibria. Therefore, classifying initial conditions based on their final state after a long integration is a sound method for approximating their basins of attraction. The specified integration time $T_{\\max} = 100$ is much larger than the system's characteristic timescale of $\\tau=1$ (from the linear degradation terms), ensuring convergence.\n\n**Numerical Strategy**\n\nThe robustness metric $R(n, K)$ is the fractional area of the basin of attraction for the \"$x$-high\" state within the domain $\\mathcal{D}$. We approximate this using a grid-based Monte Carlo approach.\n\n$1$. **Discretize Domain**: A uniform grid of $M \\times M$ initial conditions $(x_0, y_0)$ is constructed over the domain $\\mathcal{D} = [0, \\alpha] \\times [0, \\alpha]$, with $M=25$ and $\\alpha=10$.\n\n$2$. **Numerical Integration**: For each initial condition $(x_0, y_0)$ from the grid, the system of ODEs is numerically integrated from $t=0$ to $t=T_{\\max}=100$. We use a high-precision ODE solver with the specified relative tolerance $\\mathrm{rtol}=10^{-8}$ and absolute tolerance $\\mathrm{atol}=10^{-10}$ to ensure accuracy.\n\n$3$. **Classification**: The final state of each trajectory, $(x(T_{\\max}), y(T_{\\max}))$, is classified. If $x(T_{\\max}) - y(T_{\\max}) \\ge \\varepsilon$ (with $\\varepsilon=10^{-3}$), the initial condition is considered to belong to the basin of the \"$x$-high\" attractor. A counter for such trajectories is incremented.\n\n$4$. **Robustness Calculation**: After simulating all $M^2$ initial conditions, the robustness $R(n, K)$ is calculated as the ratio of the number of trajectories that converged to the \"$x$-high\" state to the total number of initial conditions, $M^2$.\n\nThis procedure is systematically applied to the four specified $(n, K)$ test cases to analyze how cooperativity and repression strength affect the system's bistability and the size of its basins. For the bistable cases, the system's symmetry implies that the basins for the \"$x$-high\" and \"$y$-high\" states should be approximately equal in size, separated by the basin of the unstable symmetric state. The separatrix should lie close to the diagonal $y=x$. Given a grid of $25 \\times 25 = 625$ points, $25$ lie on the diagonal, and $300$ lie on either side. Thus, for strongly bistable cases, we expect $R(n, K) \\approx 300 / 625 = 0.48$. For monostable cases, where only a symmetric equilibrium exists, we expect $R(n, K) = 0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Models a symmetric genetic toggle switch, computes a robustness metric for its\n    bistable behavior, and evaluates this metric for several parameter sets.\n    \"\"\"\n    \n    # Define the fixed parameters from the problem statement.\n    alpha = 10.0\n    M = 25\n    T_max = 100.0\n    epsilon = 1e-3\n    rtol = 1e-8\n    atol = 1e-10\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 1.0),   # Low cooperativity, expected monostable\n        (2.0, 10.0),  # Weak repression, expected monostable\n        (3.5, 1.0),   # Moderate cooperativity, expected bistable\n        (4.0, 0.2)    # Strong cooperativity, expected bistable\n    ]\n\n    def toggle_switch_ode(t, state, n, K):\n        \"\"\"\n        Defines the system of ordinary differential equations for the genetic toggle switch.\n        \n        Args:\n            t (float): Time (required by solve_ivp, but not used in this autonomous system).\n            state (list or np.ndarray): A list [x, y] representing the protein concentrations.\n            n (float): The Hill coefficient.\n            K (float): The repression threshold.\n        \n        Returns:\n            list: A list [dx/dt, dy/dt] of the rates of change.\n        \"\"\"\n        x, y = state\n        dx_dt = alpha / (1.0 + (y / K)**n) - x\n        dy_dt = alpha / (1.0 + (x / K)**n) - y\n        return [dx_dt, dy_dt]\n\n    results = []\n    \n    # Generate the grid of initial conditions over the domain D = [0, alpha] x [0, alpha]\n    initial_conditions_x = np.linspace(0, alpha, M)\n    initial_conditions_y = np.linspace(0, alpha, M)\n\n    # Iterate through each parameter set (n, K)\n    for n, K in test_cases:\n        x_high_count = 0\n        \n        # Iterate through each initial condition on the grid\n        for x0 in initial_conditions_x:\n            for y0 in initial_conditions_y:\n                # Numerically integrate the ODE from t=0 to t=T_max\n                solution = solve_ivp(\n                    toggle_switch_ode,\n                    [0, T_max],\n                    [x0, y0],\n                    args=(n, K),\n                    rtol=rtol,\n                    atol=atol,\n                    dense_output=False  # We only need the final point\n                )\n                \n                # Extract the final state at t=T_max\n                x_final, y_final = solution.y[:, -1]\n                \n                # Classify the trajectory based on the final state\n                # If it converges to the \"x-high\" attractor, increment the counter.\n                if x_final - y_final >= epsilon:\n                    x_high_count += 1\n        \n        # Calculate the robustness metric R(n, K)\n        total_points = M * M\n        robustness = x_high_count / total_points\n        \n        # Append the formatted result to the list\n        results.append(f\"{robustness:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3328034"}, {"introduction": "Simple Ordinary Differential Equation (ODE) models often neglect the inherent time delays in biological processes like transcription and translation, yet these delays can dramatically alter a system's dynamics. This advanced practice introduces a time delay into the toggle switch model, transforming it into a system of delay differential equations (DDEs). You will perform a stability analysis to discover how delay can destabilize a steady state and give rise to oscillations through a Hopf bifurcation, a phenomenon commonly observed in genetic circuits [@problem_id:3328017].", "problem": "Consider a canonical mutual-repression genetic toggle switch with explicit transcription–translation delay. Let $x(t)$ and $y(t)$ denote the concentrations of the two repressor proteins. Assume each protein represses the synthesis of the other via a Hill-type repression function and degrades with a first-order rate constant. The delayed dynamical system is\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{y(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\,x(t),\n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{x(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\,y(t),\n$$\nwhere $\\beta$ is the maximal synthesis rate, $K$ is the repression threshold, $n$ is the Hill coefficient, $\\gamma$ is the degradation rate constant, and $\\tau$ is the effective delay capturing transcription and translation times.\n\nAssume parameters are such that the system admits a symmetric steady state $x^{*} = y^{*} > 0$ defined implicitly by\n$$\n\\gamma\\,x^{*} \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{x^{*}}{K}\\right)^{n}}.\n$$\nStarting from the fundamental facts that delays enter gene expression due to finite transcription and translation times, negative feedback can yield complex eigenvalues in delayed systems, and linear stability is determined by the roots of the characteristic equation of the linearized delayed system, analyze the local stability of the symmetric steady state $x^{*}=y^{*}$ as a function of the delay $\\tau$. In particular, determine whether increasing $\\tau$ can destabilize the steady state and produce oscillatory transients, and, under the regime where an oscillatory instability occurs, compute the smallest positive delay $\\tau_{c}$ at which a pair of purely imaginary eigenvalues appears (the critical delay for a Hopf bifurcation). Express your final result for $\\tau_{c}$ as a single closed-form analytic expression in terms of $\\gamma$ and the local slope $b$ of the repressive production term at the steady state, where\n$$\nb \\;=\\; -\\left.\\frac{d}{dy}\\left(\\frac{\\beta}{1 + \\left(\\frac{y}{K}\\right)^{n}}\\right)\\right|_{y = x^{*}}\n\\;=\\;\n\\frac{\\beta\\,n}{K}\\,\\frac{\\left(\\frac{x^{*}}{K}\\right)^{n-1}}{\\left(1 + \\left(\\frac{x^{*}}{K}\\right)^{n}\\right)^{2}}.\n$$\nNo numerical evaluation is required; provide the exact symbolic expression for $\\tau_{c}$ only if the oscillatory instability condition is satisfied. No units are required in the final expression, and no rounding is needed.", "solution": "### Solution\nTo analyze the local stability of the symmetric steady state $(x^{*}, y^{*})$, we linearize the system of delayed differential equations. Let $u(t) = x(t) - x^{*}$ and $v(t) = y(t) - y^{*}$ be small perturbations from the steady state. The linearized system is given by:\n$$\n\\frac{d}{dt}\\begin{pmatrix} u(t) \\\\ v(t) \\end{pmatrix} = J_0 \\begin{pmatrix} u(t) \\\\ v(t) \\end{pmatrix} + J_{\\tau} \\begin{pmatrix} u(t-\\tau) \\\\ v(t-\\tau) \\end{pmatrix}\n$$\nwhere $J_0$ and $J_{\\tau}$ are the Jacobian matrices of the system with respect to the non-delayed and delayed variables, respectively, evaluated at the steady state $(x^{*}, y^{*})$.\n\nThe components of the Jacobians are:\n$$\n\\left(J_0\\right)_{11} = \\left.\\frac{\\partial}{\\partial x}\\left( -\\gamma x \\right)\\right|_{x=x^{*}} = -\\gamma\n$$\n$$\n\\left(J_0\\right)_{22} = \\left.\\frac{\\partial}{\\partial y}\\left( -\\gamma y \\right)\\right|_{y=y^{*}} = -\\gamma\n$$\nThe off-diagonal terms of $J_0$ are $0$. For the delayed Jacobian $J_{\\tau}$:\n$$\n\\left(J_{\\tau}\\right)_{12} = \\left.\\frac{\\partial}{\\partial y(t-\\tau)}\\left( \\frac{\\beta}{1 + \\left(\\frac{y(t-\\tau)}{K}\\right)^{n}} \\right)\\right|_{y=y^{*}} = -\\left(-\\left.\\frac{d}{dy}\\left(\\frac{\\beta}{1 + \\left(\\frac{y}{K}\\right)^{n}}\\right)\\right|_{y = x^{*}}\\right) = -b\n$$\nBy symmetry,\n$$\n\\left(J_{\\tau}\\right)_{21} = \\left.\\frac{\\partial}{\\partial x(t-\\tau)}\\left( \\frac{\\beta}{1 + \\left(\\frac{x(t-\\tau)}{K}\\right)^{n}} \\right)\\right|_{x=x^{*}} = -b\n$$\nThe diagonal terms of $J_{\\tau}$ are $0$. Thus, the linearized system is:\n$$\n\\frac{du}{dt} = -\\gamma u(t) - b v(t-\\tau)\n$$\n$$\n\\frac{dv}{dt} = -\\gamma v(t) - b u(t-\\tau)\n$$\nWe seek solutions of the form $(u(t), v(t)) = (u_0, v_0) e^{\\lambda t}$. Substituting this ansatz into the linearized system yields the eigenvalue problem:\n$$\n\\lambda u_0 e^{\\lambda t} = -\\gamma u_0 e^{\\lambda t} - b v_0 e^{\\lambda (t-\\tau)}\n$$\n$$\n\\lambda v_0 e^{\\lambda t} = -\\gamma v_0 e^{\\lambda t} - b u_0 e^{\\lambda (t-\\tau)}\n$$\nDividing by $e^{\\lambda t}$, we obtain a linear system for $(u_0, v_0)$:\n$$\n(\\lambda + \\gamma) u_0 + b e^{-\\lambda \\tau} v_0 = 0\n$$\n$$\nb e^{-\\lambda \\tau} u_0 + (\\lambda + \\gamma) v_0 = 0\n$$\nFor a non-trivial solution to exist, the determinant of the coefficient matrix must be zero. This gives the characteristic equation for the eigenvalues $\\lambda$:\n$$\n(\\lambda + \\gamma)^2 - (b e^{-\\lambda \\tau})^2 = 0\n$$\n$$\n(\\lambda + \\gamma)^2 - b^2 e^{-2\\lambda \\tau} = 0\n$$\nThis equation can be factored into two separate transcendental equations:\n1. $\\lambda + \\gamma - b e^{-\\lambda \\tau} = 0$\n2. $\\lambda + \\gamma + b e^{-\\lambda \\tau} = 0$\nThese correspond to the characteristic equations for the anti-symmetric ($u-v$) and symmetric ($u+v$) modes of perturbation, respectively. A Hopf bifurcation occurs when a pair of complex conjugate eigenvalues crosses the imaginary axis. We seek the smallest positive delay $\\tau = \\tau_c$ for which there exists a purely imaginary eigenvalue $\\lambda = i\\omega$ with $\\omega > 0$.\n\nCase 1: $\\lambda + \\gamma - b e^{-\\lambda \\tau} = 0$\nSubstitute $\\lambda = i\\omega$:\n$$\ni\\omega + \\gamma - b e^{-i\\omega \\tau} = 0 \\implies i\\omega + \\gamma = b(\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\nSeparating real and imaginary parts:\n$$\n\\gamma = b \\cos(\\omega\\tau) \\implies \\cos(\\omega\\tau) = \\frac{\\gamma}{b}\n$$\n$$\n\\omega = -b \\sin(\\omega\\tau) \\implies \\sin(\\omega\\tau) = -\\frac{\\omega}{b}\n$$\nUsing the identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$:\n$$\n\\left(\\frac{\\gamma}{b}\\right)^2 + \\left(-\\frac{\\omega}{b}\\right)^2 = 1 \\implies \\frac{\\gamma^2 + \\omega^2}{b^2} = 1 \\implies \\omega^2 = b^2 - \\gamma^2\n$$\nFor a real oscillation frequency $\\omega > 0$ to exist, we must have $b^2 > \\gamma^2$. Since $b > 0$ and $\\gamma > 0$, this requires $b > \\gamma$. Under this condition, $\\omega = \\sqrt{b^2 - \\gamma^2}$.\nFor a solution for $\\tau$ to exist, we need $\\cos(\\omega\\tau) > 0$ and $\\sin(\\omega\\tau) < 0$, which places the angle $\\omega\\tau$ in the fourth quadrant. The smallest positive angle is given by $\\omega\\tau = 2\\pi k + \\theta$ where $\\theta \\in(3\\pi/2, 2\\pi)$. Or more simply, $\\omega\\tau_k = 2\\pi - \\arccos(\\gamma/b) + 2k\\pi$ for $k=0, 1, \\dots$. The smallest positive delay from this branch is for $k=0$:\n$$\n\\tau_{c,1} = \\frac{1}{\\omega} \\left(2\\pi - \\arccos\\left(\\frac{\\gamma}{b}\\right)\\right)\n$$\n\nCase 2: $\\lambda + \\gamma + b e^{-\\lambda \\tau} = 0$\nSubstitute $\\lambda = i\\omega$:\n$$\ni\\omega + \\gamma + b e^{-i\\omega \\tau} = 0 \\implies i\\omega + \\gamma = -b(\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\nSeparating real and imaginary parts:\n$$\n\\gamma = -b \\cos(\\omega\\tau) \\implies \\cos(\\omega\\tau) = -\\frac{\\gamma}{b}\n$$\n$$\n\\omega = b \\sin(\\omega\\tau) \\implies \\sin(\\omega\\tau) = \\frac{\\omega}{b}\n$$\nThe condition on $\\omega$ is the same: $\\omega^2 = b^2 - \\gamma^2$, requiring $b > \\gamma$.\nHere, $\\cos(\\omega\\tau) < 0$ and $\\sin(\\omega\\tau) > 0$. This places the angle $\\omega\\tau$ in the second quadrant. The set of solutions for $\\omega\\tau$ is $\\omega\\tau_k = \\arccos(-\\gamma/b) + 2k\\pi$ for $k=0, 1, \\dots$. The smallest positive delay from this branch is for $k=0$:\n$$\n\\tau_{c,2} = \\frac{1}{\\omega} \\arccos\\left(-\\frac{\\gamma}{b}\\right)\n$$\nThe overall critical delay $\\tau_c$ is the minimum of the smallest positive delays from both cases, i.e., $\\tau_c = \\min(\\tau_{c,1}, \\tau_{c,2})$. We can use the identity $\\arccos(-z) = \\pi - \\arccos(z)$ for $z \\in [-1, 1]$.\n$$\n\\tau_{c,2} = \\frac{1}{\\omega} \\left(\\pi - \\arccos\\left(\\frac{\\gamma}{b}\\right)\\right)\n$$\nSince $b > \\gamma > 0$, $0 < \\gamma/b < 1$, so $0 < \\arccos(\\gamma/b) < \\pi/2$.\nTherefore, $\\pi - \\arccos(\\gamma/b)$ lies in $(\\pi/2, \\pi)$, while $2\\pi - \\arccos(\\gamma/b)$ lies in $(3\\pi/2, 2\\pi)$.\nClearly, $\\tau_{c,2} < \\tau_{c,1}$.\nThe smallest positive delay that induces an oscillatory instability (Hopf bifurcation) is thus $\\tau_c = \\tau_{c,2}$. Substituting $\\omega = \\sqrt{b^2 - \\gamma^2}$, we obtain the final expression for the critical delay. This instability occurs via the symmetric perturbation mode.\n\nIncreasing $\\tau$ beyond $0$ can indeed destabilize the steady state, provided the feedback is strong enough ($b > \\gamma$). The destabilization leads to an oscillatory transient, characteristic of a Hopf bifurcation. The critical delay $\\tau_c$ is the threshold for this instability.\nThe result is:\n$$\n\\tau_c = \\frac{1}{\\sqrt{b^2 - \\gamma^2}} \\arccos\\left(-\\frac{\\gamma}{b}\\right)\n$$", "answer": "$$\\boxed{\\frac{\\arccos\\left(-\\frac{\\gamma}{b}\\right)}{\\sqrt{b^{2} - \\gamma^{2}}}}$$", "id": "3328017"}]}