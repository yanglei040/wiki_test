{"hands_on_practices": [{"introduction": "This first practice is about building the essential components of the heat diffusion model from scratch. By constructing the adjacency, degree, and Laplacian matrices for a small network, you will gain a concrete understanding of these objects. You will then use them to derive a fundamental conservation law of the diffusion process from first principles, connecting the mathematical formalism to an intuitive physical property [@problem_id:3332495].", "problem": "Consider a weighted, undirected protein-protein interaction (PPI) network with node set $\\{p_{1}, p_{2}, p_{3}, p_{4}\\}$, where an edge between $p_{i}$ and $p_{j}$ carries a nonnegative weight $w_{ij}$ indicating interaction strength. Assume there are no self-loops. The nonzero interaction weights are:\n- $w_{12} = 0.7$,\n- $w_{13} = 0.1$,\n- $w_{23} = 0.4$,\n- $w_{24} = 0.5$,\n- $w_{34} = 0.2$.\n\nUsing the node ordering $(p_{1}, p_{2}, p_{3}, p_{4})$:\n1. Construct the adjacency matrix $A \\in \\mathbb{R}^{4 \\times 4}$, where $A_{ij} = w_{ij}$ for $i \\neq j$ if the edge exists and $A_{ii} = 0$.\n2. Construct the degree matrix $D \\in \\mathbb{R}^{4 \\times 4}$, which is diagonal with entries $D_{ii} = \\sum_{j=1}^{4} A_{ij}$, and the degree vector $d \\in \\mathbb{R}^{4}$ with entries $d_{i} = D_{ii}$.\n3. Verify explicitly for each $i \\in \\{1,2,3,4\\}$ that $\\sum_{j=1}^{4} A_{ij} = D_{ii}$.\n\nDefine the combinatorial graph Laplacian $L = D - A$. Consider continuous-time heat diffusion on this network governed by the ordinary differential equation\n$\\frac{d}{dt} x(t) = - L \\, x(t)$\nwith the initial condition\n$x(0) = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix}$.\nUsing only fundamental definitions of $A$, $D$, and $L$, and the dynamical equation above (do not use any pre-stated conservation laws), derive from first principles whether the total heat $S(t) = \\mathbf{1}^{\\top} x(t)$ is conserved in time, where $\\mathbf{1} \\in \\mathbb{R}^{4}$ is the vector of all ones. Then, compute the constant value of $S(t)$ implied by your derivation.\n\nGive your final answer as a single real number with no units. Do not round; provide the exact value implied by the data above.", "solution": "The problem asks us to determine if the total heat $S(t)$ is conserved for a diffusion process on a given protein-protein interaction (PPI) network and to compute its value if it is constant.\n\nFirst, we construct the adjacency matrix $A$ and the degree matrix $D$ based on the provided interaction weights and node ordering $(p_{1}, p_{2}, p_{3}, p_{4})$. The network is undirected, which implies that the adjacency matrix $A$ is symmetric, i.e., $A_{ij} = A_{ji}$. The nonzero weights are given as $w_{12} = 0.7$, $w_{13} = 0.1$, $w_{23} = 0.4$, $w_{24} = 0.5$, and $w_{34} = 0.2$. All diagonal elements $A_{ii}$ are zero.\n\nThe adjacency matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n0 & w_{12} & w_{13} & w_{14} \\\\\nw_{21} & 0 & w_{23} & w_{24} \\\\\nw_{31} & w_{32} & 0 & w_{34} \\\\\nw_{41} & w_{42} & w_{43} & 0\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 & 0.7 & 0.1 & 0 \\\\\n0.7 & 0 & 0.4 & 0.5 \\\\\n0.1 & 0.4 & 0 & 0.2 \\\\\n0 & 0.5 & 0.2 & 0\n\\end{pmatrix}\n$$\nNext, we construct the degree matrix $D$, which is a diagonal matrix where each diagonal element $D_{ii}$ is the sum of the weights of all edges connected to node $i$. This is equivalent to the sum of the entries in the $i$-th row of $A$. The problem asks for explicit verification of this definition.\n\nFor node $p_1$: $D_{11} = \\sum_{j=1}^{4} A_{1j} = A_{11} + A_{12} + A_{13} + A_{14} = 0 + 0.7 + 0.1 + 0 = 0.8$.\nFor node $p_2$: $D_{22} = \\sum_{j=1}^{4} A_{2j} = A_{21} + A_{22} + A_{23} + A_{24} = 0.7 + 0 + 0.4 + 0.5 = 1.6$.\nFor node $p_3$: $D_{33} = \\sum_{j=1}^{4} A_{3j} = A_{31} + A_{32} + A_{33} + A_{34} = 0.1 + 0.4 + 0 + 0.2 = 0.7$.\nFor node $p_4$: $D_{44} = \\sum_{j=1}^{4} A_{4j} = A_{41} + A_{42} + A_{43} + A_{44} = 0 + 0.5 + 0.2 + 0 = 0.7$.\n\nThis verifies the condition $\\sum_{j=1}^{4} A_{ij} = D_{ii}$ for each $i \\in \\{1,2,3,4\\}$. The degree vector is $d = \\begin{pmatrix} 0.8 & 1.6 & 0.7 & 0.7 \\end{pmatrix}^{\\top}$. The degree matrix $D$ is:\n$$\nD = \\begin{pmatrix}\n0.8 & 0 & 0 & 0 \\\\\n0 & 1.6 & 0 & 0 \\\\\n0 & 0 & 0.7 & 0 \\\\\n0 & 0 & 0 & 0.7\n\\end{pmatrix}\n$$\nThe combinatorial graph Laplacian is defined as $L = D - A$.\n\nThe total heat in the system at time $t$ is given by $S(t) = \\mathbf{1}^{\\top} x(t)$, where $\\mathbf{1} = \\begin{pmatrix} 1 & 1 & 1 & 1 \\end{pmatrix}^{\\top}$ is the vector of all ones and $x(t)$ is the vector of heat at each node. To determine if $S(t)$ is conserved, we must evaluate its time derivative, $\\frac{d}{dt}S(t)$. If the derivative is zero, the quantity is conserved.\n\nWe start by differentiating $S(t)$ with respect to time $t$:\n$$\n\\frac{d S(t)}{dt} = \\frac{d}{dt} \\left( \\mathbf{1}^{\\top} x(t) \\right)\n$$\nSince $\\mathbf{1}$ is a constant vector, we can move the differentiation operator inside:\n$$\n\\frac{d S(t)}{dt} = \\mathbf{1}^{\\top} \\frac{d x(t)}{dt}\n$$\nThe problem provides the governing differential equation for heat diffusion: $\\frac{d x(t)}{dt} = -L x(t)$. Substituting this into our expression for the derivative of $S(t)$:\n$$\n\\frac{d S(t)}{dt} = \\mathbf{1}^{\\top} \\left( -L x(t) \\right) = - ( \\mathbf{1}^{\\top} L ) x(t)\n$$\nTo proceed, we must evaluate the term $\\mathbf{1}^{\\top} L$. This is a row vector whose $j$-th component is the sum of the elements in the $j$-th column of the Laplacian matrix $L$.\nLet's analyze the sum of an arbitrary column $j$ of $L$:\n$$\n\\sum_{i=1}^{4} L_{ij} = \\sum_{i=1}^{4} (D_{ij} - A_{ij}) = \\sum_{i=1}^{4} D_{ij} - \\sum_{i=1}^{4} A_{ij}\n$$\nThe matrix $D$ is diagonal, so the sum over its $j$-th column, $\\sum_{i=1}^{4} D_{ij}$, has only one non-zero term, which is $D_{jj}$. By definition, $D_{jj} = \\sum_{k=1}^{4} A_{jk}$, which is the degree of node $j$.\nThe second term, $\\sum_{i=1}^{4} A_{ij}$, is the sum of the elements in the $j$-th column of the adjacency matrix $A$. Since the network is undirected, $A$ is a symmetric matrix ($A = A^{\\top}$), meaning $A_{ij} = A_{ji}$. Therefore, the sum of the elements in column $j$ is equal to the sum of the elements in row $j$:\n$$\n\\sum_{i=1}^{4} A_{ij} = \\sum_{i=1}^{4} A_{ji}\n$$\nThe sum of the elements in row $j$, $\\sum_{i=1}^{4} A_{ji}$, is precisely the definition of the degree of node $j$, which is $D_{jj}$.\nSubstituting these results back into the expression for the column sum of $L$:\n$$\n\\sum_{i=1}^{4} L_{ij} = D_{jj} - D_{jj} = 0\n$$\nThis holds for every column $j \\in \\{1,2,3,4\\}$. Therefore, each entry in the row vector $\\mathbf{1}^{\\top}L$ is zero, which means $\\mathbf{1}^{\\top}L = \\mathbf{0}^{\\top}$, the zero row vector.\n\nNow we can complete the evaluation of the time derivative of $S(t)$:\n$$\n\\frac{d S(t)}{dt} = - ( \\mathbf{1}^{\\top} L ) x(t) = - \\mathbf{0}^{\\top} x(t) = 0\n$$\nSince the time derivative of $S(t)$ is zero for all $t$, the total heat $S(t)$ is a conserved quantity. Its value is constant over time and is equal to its initial value, $S(0)$.\n\nWe compute this constant value using the given initial condition $x(0)$:\n$$\nx(0) = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix}\n$$\nThe total heat at $t=0$ is:\n$$\nS(0) = \\mathbf{1}^{\\top} x(0) = \\begin{pmatrix} 1 & 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix} = 1(1) + 1(2) + 1(0.5) + 1(1.5)\n$$\n$$\nS(0) = 1 + 2 + 0.5 + 1.5 = 5\n$$\nThus, the total heat $S(t)$ is conserved, and its constant value is $5$.", "answer": "$$\\boxed{5}$$", "id": "3332495"}, {"introduction": "Having set up the model, the next step is to solve it. This exercise guides you through finding an exact solution to the heat diffusion equation using the spectral decomposition of the graph Laplacian. This is a powerful and general technique for analyzing linear dynamical systems on networks, and mastering it will allow you to predict the system's state at any point in time [@problem_id:3332507].", "problem": "Consider the undirected path graph on $3$ nodes labeled $1 \\text{--} 2 \\text{--} 3$ with unit edge weights. Let $L$ be its combinatorial graph Laplacian and let $f \\in \\mathbb{R}^{3}$ denote the initial heat distribution. The canonical diffusion dynamics on a network are given by the discrete heat equation $\\frac{d}{dt} u(t) = - L u(t)$ with $u(0) = f$. Work in exact arithmetic.\n\nYou are given the explicit matrices and vectors:\n$$\nL = \\begin{pmatrix}\n1 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}, \n\\quad\nf = \\begin{pmatrix}\n1 \\\\\n0 \\\\\n0\n\\end{pmatrix}.\n$$\n\nTasks:\n1. Using the spectral properties of symmetric matrices and diagonalization, derive an explicit expression for $u(t)$ by solving the ordinary differential equation (ODE) $\\frac{d}{dt} u(t) = - L u(t)$ with $u(0)=f$.\n2. Evaluate the second component $u_{2}(t)$ at time $t = \\ln 2$.\n3. Verify mass conservation numerically at $t = \\ln 2$ by computing $\\mathbf{1}^{\\top} u(t)$ and comparing it to $\\mathbf{1}^{\\top} f$, where $\\mathbf{1} = (1,1,1)^{\\top}$. Include this verification in your working, but your final reported answer should be only the numerical value of $u_{2}(\\ln 2)$.\n\nExpress the final answer as an exact fraction. Do not round.", "solution": "The system of ordinary differential equations is given by $\\frac{d}{dt} u(t) = -L u(t)$, with the initial condition $u(0) = f$. The formal solution is $u(t) = \\exp(-Lt) f$. To compute the matrix exponential, we use the spectral decomposition of the symmetric matrix $L$. Let $L = V \\Lambda V^{\\top}$, where $\\Lambda$ is the diagonal matrix of eigenvalues and $V$ is the orthogonal matrix whose columns are the corresponding orthonormal eigenvectors. The solution can then be written as $u(t) = V \\exp(-\\Lambda t) V^{\\top} f$.\n\nFirst, we find the eigenvalues and eigenvectors of $L$. The characteristic equation is $\\det(L - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} 1-\\lambda & -1 & 0 \\\\ -1 & 2-\\lambda & -1 \\\\ 0 & -1 & 1-\\lambda \\end{pmatrix} = (1-\\lambda)((2-\\lambda)(1-\\lambda) - 1) + 1(-(1-\\lambda)) = (1-\\lambda)(\\lambda^2 - 3\\lambda + 1) - (1-\\lambda) = (1-\\lambda)(\\lambda^2 - 3\\lambda) = \\lambda(1-\\lambda)(\\lambda-3) = 0\n$$\nThe eigenvalues are $\\lambda_1 = 0$, $\\lambda_2 = 1$, and $\\lambda_3 = 3$.\n\nNext, we find the corresponding orthonormal eigenvectors.\nFor $\\lambda_1 = 0$: $(L-0I)v_1 = 0 \\implies \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} v_1 = 0$. This gives $x_1=x_2=x_3$. The normalized eigenvector is $v_1 = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$.\nFor $\\lambda_2 = 1$: $(L-1I)v_2 = 0 \\implies \\begin{pmatrix} 0 & -1 & 0 \\\\ -1 & 1 & -1 \\\\ 0 & -1 & 0 \\end{pmatrix} v_2 = 0$. This gives $x_2=0$ and $x_1=-x_3$. The normalized eigenvector is $v_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$.\nFor $\\lambda_3 = 3$: $(L-3I)v_3 = 0 \\implies \\begin{pmatrix} -2 & -1 & 0 \\\\ -1 & -1 & -1 \\\\ 0 & -1 & -2 \\end{pmatrix} v_3 = 0$. This gives $y=-2x$ and $y=-2z$, implying $x=z$. The normalized eigenvector is $v_3 = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ -2 \\\\ 1 \\end{pmatrix}$.\n\nThe solution $u(t)$ can be expressed as a linear combination of the eigenvectors, evolving according to their eigenvalues:\n$u(t) = \\sum_{i=1}^{3} (v_i^{\\top}f) \\exp(-\\lambda_i t) v_i$.\n\nLet's calculate the coefficients, which are the projections of the initial condition $f$ onto the eigenvectors:\n$c_1 = v_1^{\\top}f = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{3}}$.\n$c_2 = v_2^{\\top}f = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}$.\n$c_3 = v_3^{\\top}f = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 & -2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{6}}$.\n\nThe solution is given by:\n$u(t) = (v_1^{\\top}f) \\exp(-\\lambda_1 t) v_1 + (v_2^{\\top}f) \\exp(-\\lambda_2 t) v_2 + (v_3^{\\top}f) \\exp(-\\lambda_3 t) v_3$\n$u(t) = \\frac{1}{\\sqrt{3}} \\exp(0) \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) + \\frac{1}{\\sqrt{2}} \\exp(-t) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} \\right) + \\frac{1}{\\sqrt{6}} \\exp(-3t) \\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ -2 \\\\ 1 \\end{pmatrix} \\right)$\n$u(t) = \\frac{1}{3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} + \\frac{1}{2} \\exp(-t) \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} + \\frac{1}{6} \\exp(-3t) \\begin{pmatrix} 1 \\\\ -2 \\\\ 1 \\end{pmatrix}$\n\nThis gives the explicit expression for $u(t)$ for Task 1. We can write it component-wise:\n$$\nu(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\\\ u_3(t) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} + \\frac{1}{2}\\exp(-t) + \\frac{1}{6}\\exp(-3t) \\\\ \\frac{1}{3} - \\frac{2}{6}\\exp(-3t) \\\\ \\frac{1}{3} - \\frac{1}{2}\\exp(-t) + \\frac{1}{6}\\exp(-3t) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} + \\frac{1}{2}\\exp(-t) + \\frac{1}{6}\\exp(-3t) \\\\ \\frac{1}{3} - \\frac{1}{3}\\exp(-3t) \\\\ \\frac{1}{3} - \\frac{1}{2}\\exp(-t) + \\frac{1}{6}\\exp(-3t) \\end{pmatrix}\n$$\n\nFor Task 2, we evaluate $u_2(t)$ at $t=\\ln 2$:\n$u_2(t) = \\frac{1}{3} - \\frac{1}{3}\\exp(-3t)$.\nAt $t = \\ln 2$:\n$u_2(\\ln 2) = \\frac{1}{3} - \\frac{1}{3}\\exp(-3\\ln 2) = \\frac{1}{3} - \\frac{1}{3}\\exp(\\ln(2^{-3})) = \\frac{1}{3} - \\frac{1}{3}(2^{-3}) = \\frac{1}{3} - \\frac{1}{3}\\left(\\frac{1}{8}\\right)$.\n$u_2(\\ln 2) = \\frac{1}{3} - \\frac{1}{24} = \\frac{8}{24} - \\frac{1}{24} = \\frac{7}{24}$.\n\nFor Task 3, we verify mass conservation. The initial total mass is $\\mathbf{1}^{\\top} f = (1,1,1)\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1$.\nThe total mass at time $t$ is $\\mathbf{1}^{\\top} u(t)$. Let's verify this numerically at $t = \\ln 2$.\nWe need to calculate $\\mathbf{1}^{\\top} u(\\ln 2) = u_1(\\ln 2) + u_2(\\ln 2) + u_3(\\ln 2)$.\nWe have $u_2(\\ln 2) = \\frac{7}{24} = \\frac{14}{48}$.\nLet's calculate the other components:\n$\\exp(-\\ln 2) = \\frac{1}{2}$ and $\\exp(-3\\ln 2) = \\frac{1}{8}$.\n$u_1(\\ln 2) = \\frac{1}{3} + \\frac{1}{2}\\exp(-\\ln 2) + \\frac{1}{6}\\exp(-3\\ln 2) = \\frac{1}{3} + \\frac{1}{2}\\left(\\frac{1}{2}\\right) + \\frac{1}{6}\\left(\\frac{1}{8}\\right) = \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{48} = \\frac{16}{48} + \\frac{12}{48} + \\frac{1}{48} = \\frac{29}{48}$.\n$u_3(\\ln 2) = \\frac{1}{3} - \\frac{1}{2}\\exp(-\\ln 2) + \\frac{1}{6}\\exp(-3\\ln 2) = \\frac{1}{3} - \\frac{1}{2}\\left(\\frac{1}{2}\\right) + \\frac{1}{6}\\left(\\frac{1}{8}\\right) = \\frac{1}{3} - \\frac{1}{4} + \\frac{1}{48} = \\frac{16}{48} - \\frac{12}{48} + \\frac{1}{48} = \\frac{5}{48}$.\nThe total mass at $t = \\ln 2$ is:\n$\\mathbf{1}^{\\top} u(\\ln 2) = \\frac{29}{48} + \\frac{14}{48} + \\frac{5}{48} = \\frac{29+14+5}{48} = \\frac{48}{48} = 1$.\nThis matches the initial mass $\\mathbf{1}^{\\top} f = 1$, verifying mass conservation.\n\nThe final answer required is the numerical value of $u_2(\\ln 2)$.", "answer": "$$\n\\boxed{\\frac{7}{24}}\n$$", "id": "3332507"}, {"introduction": "This final practice explores the critical relationship between network topology and diffusion dynamics. By analyzing a network with disconnected components, you will see precisely how the graph's structure constrains the flow of information. This exercise provides a clear mathematical justification for how biological modularity, such as distinct protein complexes, can lead to functional separation and insulation of processes within a cell [@problem_id:3332574].", "problem": "In a proteinâ€“protein interaction (PPI) network representing two disconnected protein complexes, heat diffusion is used to model the propagation of an initial perturbation from a single seed protein. The network has four proteins labeled $1,2,3,4$. Proteins $1$ and $2$ form one complex with a single interaction, and proteins $3$ and $4$ form another complex with a single interaction. There are no interactions between the two complexes. The unweighted adjacency matrix is\n$$\nA \\;=\\; \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix},\n$$\nand the degree matrix is\n$$\nD \\;=\\; \\operatorname{diag}(1,1,1,1).\n$$\nLet the combinatorial graph Laplacian be $L = D - A$. Consider a heat diffusion dynamics on the network under the following assumptions:\n- The total heat is conserved in the absence of sources and sinks.\n- The net flux between two interacting proteins is proportional to the difference in their heat levels.\n- The diffusion constant is scaled to $1$.\n- The initial heat is concentrated at the seed protein $1$, so the initial condition is the vector $u(0) = s$, where $s_1 = 1$ and $s_i = 0$ for $i \\neq 1$.\n\nStarting from these assumptions and definitions only, derive the linear dynamical system governing the evolution of the node-wise heat $u(t)$ on this network, solve it exactly, and use this solution to justify from first principles whether nodes $3$ and $4$ are affected by the seed at any time $t \\ge 0$. Then, compute explicitly the function $u_2(t)$ for all $t \\ge 0$ as a closed-form analytic expression. Report $u_2(t)$ as your final answer. Do not include any units in your final answer.", "solution": "Let $u_i(t)$ be the heat level at node $i$ at time $t$. The vector of heat levels is $u(t) = \\begin{pmatrix} u_1(t) & u_2(t) & u_3(t) & u_4(t) \\end{pmatrix}^T$.\nThe assumption that the net flux between two interacting proteins is proportional to the difference in their heat levels, with a diffusion constant of $1$, means the rate of change of heat at node $i$, $\\frac{du_i}{dt}$, is the sum of fluxes from all its neighbors. For a general network with adjacency matrix $A$, this is expressed as:\n$$ \\frac{du_i}{dt} = \\sum_{j=1}^{4} A_{ij} (u_j(t) - u_i(t)) $$\nThis can be expanded as:\n$$ \\frac{du_i}{dt} = \\sum_{j=1}^{4} A_{ij} u_j(t) - u_i(t) \\sum_{j=1}^{4} A_{ij} $$\nThe first term is the $i$-th component of the vector product $A u(t)$. The second term contains the sum $\\sum_{j=1}^{4} A_{ij}$, which is the degree of node $i$, denoted $d_i$. With $D$ as the diagonal matrix of node degrees, the term $u_i(t) d_i$ is the $i$-th component of $D u(t)$.\nWriting this for all nodes in vector form gives the linear dynamical system:\n$$ \\frac{du(t)}{dt} = A u(t) - D u(t) = (A - D) u(t) $$\nThe combinatorial graph Laplacian is defined as $L = D - A$. Therefore, the system is the heat equation on the graph:\n$$ \\frac{du(t)}{dt} = -L u(t) $$\nThe solution to this linear system with the initial condition $u(0) = s$ is given by the matrix exponential: $u(t) = \\exp(-Lt) s$.\n\nFirst, we compute the Laplacian matrix $L$:\n$$ L = D - A = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & 0 & 0 \\\\ -1 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & -1 \\\\ 0 & 0 & -1 & 1 \\end{pmatrix} $$\nThe Laplacian $L$ is a block-diagonal matrix: $L = \\begin{pmatrix} L_c & 0 \\\\ 0 & L_c \\end{pmatrix}$, where $L_c = \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$. This block structure reflects the fact that the network consists of two disconnected components: $\\{1, 2\\}$ and $\\{3, 4\\}$.\n\nThe block-diagonal nature of $L$ decouples the system of differential equations. Let $u_{12}(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix}$ and $u_{34}(t) = \\begin{pmatrix} u_3(t) \\\\ u_4(t) \\end{pmatrix}$. The system $\\frac{du}{dt} = -Lu$ can be written as two independent systems:\n$$ \\frac{du_{12}(t)}{dt} = -L_c u_{12}(t) \\quad\\text{and}\\quad \\frac{du_{34}(t)}{dt} = -L_c u_{34}(t) $$\nThe initial condition is $u(0) = \\begin{pmatrix} 1 & 0 & 0 & 0 \\end{pmatrix}^T$. This means $u_{12}(0) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ and $u_{34}(0) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$. The system for nodes $3$ and $4$ is $\\frac{du_{34}(t)}{dt} = -L_c u_{34}(t)$ with the initial condition $u_{34}(0) = 0$. The unique solution to this homogeneous initial value problem is the trivial solution $u_{34}(t) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ for all $t \\ge 0$.\nTherefore, $u_3(t) = 0$ and $u_4(t) = 0$ for all $t \\ge 0$. The initial heat at node $1$ never reaches nodes $3$ and $4$ because there is no path in the network connecting component $\\{1, 2\\}$ to component $\\{3, 4\\}$.\n\nTo find $u_2(t)$, we solve the first system for $u_{12}(t)$: $\\frac{du_{12}(t)}{dt} = -L_c u_{12}(t)$ with $u_{12}(0) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The solution is $u_{12}(t) = \\exp(-L_c t) u_{12}(0)$. We compute the matrix exponential $\\exp(-L_c t)$ by diagonalizing $L_c = \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$. The characteristic equation is $\\det(L_c - \\lambda I) = (1-\\lambda)^2 - 1 = \\lambda^2 - 2\\lambda = 0$, which gives eigenvalues $\\lambda_1 = 0$ and $\\lambda_2 = 2$.\nThe matrix exponential is $\\exp(-L_c t) = P \\exp(-\\Lambda t) P^T$, where $P$ is the matrix of eigenvectors and $\\Lambda$ is the diagonal matrix of eigenvalues. The orthonormal eigenvectors are $v_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ for $\\lambda_1=0$, and $v_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ for $\\lambda_2=2$.\nSo, $P = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$ and $\\Lambda = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix}$.\n$$ \\exp(-L_c t) = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} e^0 & 0 \\\\ 0 & e^{-2t} \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} $$\n$$ = \\frac{1}{2} \\begin{pmatrix} 1 & e^{-2t} \\\\ 1 & -e^{-2t} \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 + e^{-2t} & 1 - e^{-2t} \\\\ 1 - e^{-2t} & 1 + e^{-2t} \\end{pmatrix} $$\nFinally, we compute $u_{12}(t)$:\n$$ u_{12}(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix} = \\exp(-L_c t) u_{12}(0) = \\frac{1}{2} \\begin{pmatrix} 1 + e^{-2t} & 1 - e^{-2t} \\\\ 1 - e^{-2t} & 1 + e^{-2t} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n$$ = \\frac{1}{2} \\begin{pmatrix} 1 + e^{-2t} \\\\ 1 - e^{-2t} \\end{pmatrix} $$\nThe function for the heat at node $2$ is the second component of this vector:\n$$ u_2(t) = \\frac{1}{2} (1 - \\exp(-2t)) $$\nThis solution shows that as $t \\to 0$, $u_2(t) \\to \\frac{1}{2}(1-1) = 0$, matching the initial condition. As $t \\to \\infty$, heat diffuses completely within the component, so $u_2(t) \\to \\frac{1}{2}$. This is expected, as the total initial heat of $1$ is conserved within the component $\\{1, 2\\}$, and at equilibrium it is distributed evenly between the two nodes.", "answer": "$$\\boxed{\\frac{1}{2}(1 - \\exp(-2t))}$$", "id": "3332574"}]}