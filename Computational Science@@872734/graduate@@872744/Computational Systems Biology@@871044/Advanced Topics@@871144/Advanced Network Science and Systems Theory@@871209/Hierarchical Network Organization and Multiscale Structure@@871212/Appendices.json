{"hands_on_practices": [{"introduction": "A fundamental task in systems biology is to uncover the organizational principles of a system from experimental data. Often, this data comes in the form of a similarity matrix, where entries quantify the relatedness of different components. This exercise provides hands-on practice with single-linkage hierarchical agglomerative clustering, a foundational algorithm for converting pairwise similarities into a nested, hierarchical structure known as a dendrogram [@problem_id:3318635]. Mastering this technique is essential for identifying modules and sub-modules in complex biological networks.", "problem": "In computational systems biology, hierarchical network organization and multiscale structure can be inferred by clustering a node similarity matrix to reveal modules across scales. Consider a system with $5$ molecular subsystems labeled $1,2,3,4,5$. You are given the symmetric similarity matrix $S \\in \\mathbb{R}^{5 \\times 5}$ with entries $s_{ij}$, where $s_{ii} = 1$ for all $i$ and $s_{ij} \\in [0,1]$ for $i \\neq j$:\n$$\nS = \\begin{pmatrix}\n1.00 & 0.95 & 0.67 & 0.69 & 0.90 \\\\\n0.95 & 1.00 & 0.66 & 0.70 & 0.88 \\\\\n0.67 & 0.66 & 1.00 & 0.92 & 0.72 \\\\\n0.69 & 0.70 & 0.92 & 1.00 & 0.71 \\\\\n0.90 & 0.88 & 0.72 & 0.71 & 1.00\n\\end{pmatrix}.\n$$\nStarting from the definitions that (i) a dissimilarity can be obtained from a similarity by $d_{ij} = 1 - s_{ij}$, (ii) single-linkage hierarchical agglomerative clustering (HAC) merges at each step the two clusters with the smallest inter-cluster dissimilarity, where the distance between clusters $A$ and $B$ is $\\min_{i \\in A, j \\in B} d_{ij}$, and (iii) the ultrametric (cophenetic) distance $u_{ij}$ between two leaves $i$ and $j$ equals the merge height at which $i$ and $j$ first belong to a common cluster in the dendrogram, perform the following:\n\n- Apply single-linkage HAC to $S$ by first forming the dissimilarity matrix $D$ and then merging clusters until a single cluster remains. If any ties occur in selecting which clusters to merge, break ties by choosing the lexicographically smallest ordered pair of cluster labels, where clusters are labeled by their sorted member sets.\n- From the resulting dendrogram, determine all ultrametric distances $u_{ij}$ for $1 \\leq i < j \\leq 5$.\n\nFinally, compute the scalar\n$$\nU_{\\mathrm{sum}} = \\sum_{1 \\leq i < j \\leq 5} u_{ij}.\n$$\nExpress your final answer as a dimensionless real number rounded to $4$ significant figures.", "solution": "The problem has been validated and is deemed sound, well-posed, objective, and scientifically grounded in the field of computational systems biology. It presents a complete and consistent set of data and definitions, allowing for a unique solution via a standard algorithmic procedure.\n\nThe solution proceeds in four main steps:\n1.  Transformation of the similarity matrix $S$ into a dissimilarity matrix $D$.\n2.  Application of single-linkage hierarchical agglomerative clustering (HAC) to $D$.\n3.  Determination of the ultrametric (cophenetic) distances $u_{ij}$ from the resulting dendrogram.\n4.  Computation of the final sum $U_{\\mathrm{sum}}$.\n\n**Step 1: Compute the Dissimilarity Matrix**\n\nThe dissimilarity $d_{ij}$ is defined as $d_{ij} = 1 - s_{ij}$. Using the given similarity matrix $S$:\n$$\nS = \\begin{pmatrix}\n1.00 & 0.95 & 0.67 & 0.69 & 0.90 \\\\\n0.95 & 1.00 & 0.66 & 0.70 & 0.88 \\\\\n0.67 & 0.66 & 1.00 & 0.92 & 0.72 \\\\\n0.69 & 0.70 & 0.92 & 1.00 & 0.71 \\\\\n0.90 & 0.88 & 0.72 & 0.71 & 1.00\n\\end{pmatrix}\n$$\nThe resulting dissimilarity matrix $D$ is:\n$$\nD = 1 - S = \\begin{pmatrix}\n0.00 & 0.05 & 0.33 & 0.31 & 0.10 \\\\\n0.05 & 0.00 & 0.34 & 0.30 & 0.12 \\\\\n0.33 & 0.34 & 0.00 & 0.08 & 0.28 \\\\\n0.31 & 0.30 & 0.08 & 0.00 & 0.29 \\\\\n0.10 & 0.12 & 0.28 & 0.29 & 0.00\n\\end{pmatrix}\n$$\nThe diagonal entries are $d_{ii} = 1 - 1 = 0$, as expected.\n\n**Step 2: Perform Single-Linkage Hierarchical Agglomerative Clustering (HAC)**\n\nThe clustering process starts with each of the $5$ subsystems as its own cluster: $\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}$. At each step, we merge the two clusters with the minimum inter-cluster dissimilarity. For single-linkage, the distance between two clusters $A$ and $B$ is given by $d(A, B) = \\min_{i \\in A, j \\in B} d_{ij}$.\n\n**Iteration 1:**\nThe initial inter-cluster distances are the entries of the matrix $D$. The minimum off-diagonal entry is $d_{12} = 0.05$.\n- Merge clusters $\\{1\\}$ and $\\{2\\}$ to form a new cluster $\\{1, 2\\}$.\n- The merge height (dissimilarity) is $0.05$.\n- Current clusters: $\\{1, 2\\}, \\{3\\}, \\{4\\}, \\{5\\}$.\n\n**Iteration 2:**\nWe compute the dissimilarities between the new cluster $\\{1, 2\\}$ and the remaining clusters:\n- $d(\\{1, 2\\}, \\{3\\}) = \\min(d_{13}, d_{23}) = \\min(0.33, 0.34) = 0.33$.\n- $d(\\{1, 2\\}, \\{4\\}) = \\min(d_{14}, d_{24}) = \\min(0.31, 0.30) = 0.30$.\n- $d(\\{1, 2\\}, \\{5\\}) = \\min(d_{15}, d_{25}) = \\min(0.10, 0.12) = 0.10$.\nThe other distances remain unchanged: $d_{34} = 0.08$, $d_{35} = 0.28$, $d_{45} = 0.29$.\nThe set of current inter-cluster dissimilarities is $\\{0.33, 0.30, 0.10, 0.08, 0.28, 0.29\\}$. The minimum is $d_{34} = 0.08$.\n- Merge clusters $\\{3\\}$ and $\\{4\\}$ to form a new cluster $\\{3, 4\\}$.\n- The merge height is $0.08$.\n- Current clusters: $\\{1, 2\\}, \\{3, 4\\}, \\{5\\}$.\n\n**Iteration 3:**\nWe compute the dissimilarities between the current clusters:\n- $d(\\{1, 2\\}, \\{5\\}) = 0.10$ (from previous step).\n- $d(\\{3, 4\\}, \\{5\\}) = \\min(d_{35}, d_{45}) = \\min(0.28, 0.29) = 0.28$.\n- $d(\\{1, 2\\}, \\{3, 4\\}) = \\min(d_{13}, d_{14}, d_{23}, d_{24}) = \\min(0.33, 0.31, 0.34, 0.30) = 0.30$.\nThe set of current inter-cluster dissimilarities is $\\{0.10, 0.28, 0.30\\}$. The minimum is $0.10$.\n- Merge clusters $\\{1, 2\\}$ and $\\{5\\}$ to form a new cluster $\\{1, 2, 5\\}$.\n- The merge height is $0.10$.\n- Current clusters: $\\{1, 2, 5\\}, \\{3, 4\\}$.\n\n**Iteration 4:**\nOnly two clusters remain. We compute their dissimilarity:\n- $d(\\{1, 2, 5\\}, \\{3, 4\\}) = \\min(d(\\{1, 2\\}, \\{3, 4\\}), d(\\{5\\}, \\{3, 4\\})) = \\min(0.30, 0.28) = 0.28$.\n- Merge clusters $\\{1, 2, 5\\}$ and $\\{3, 4\\}$ to form the final cluster $\\{1, 2, 3, 4, 5\\}$.\n- The merge height is $0.28$.\nThe clustering process is complete.\n\n**Step 3: Determine Ultrametric (Cophenetic) Distances**\n\nThe ultrametric distance $u_{ij}$ between two initial items $i$ and $j$ is the height of the merge at which they first appear in the same cluster. Based on the HAC steps:\n- The merge of $\\{1\\}$ and $\\{2\\}$ occurred at height $0.05$. So, $u_{12} = 0.05$.\n- The merge of $\\{3\\}$ and $\\{4\\}$ occurred at height $0.08$. So, $u_{34} = 0.08$.\n- The merge of $\\{1, 2\\}$ and $\\{5\\}$ occurred at height $0.10$. This is the first time elements from $\\{1, 2\\}$ are clustered with $5$. Thus, $u_{15} = 0.10$ and $u_{25} = 0.10$.\n- The merge of $\\{1, 2, 5\\}$ and $\\{3, 4\\}$ occurred at height $0.28$. This is the first time elements from $\\{1, 2, 5\\}$ are clustered with elements from $\\{3, 4\\}$. This applies to $3 \\times 2 = 6$ pairs.\n  - $u_{13} = u_{14} = 0.28$.\n  - $u_{23} = u_{24} = 0.28$.\n  - $u_{35} = u_{45} = 0.28$. (Note that $u_{35} = u_{53}$ and $u_{45}=u_{54}$)\n\nIn summary, the $\\binom{5}{2} = 10$ unique ultrametric distances are:\n- $u_{12} = 0.05$\n- $u_{13} = 0.28$\n- $u_{14} = 0.28$\n- $u_{15} = 0.10$\n- $u_{23} = 0.28$\n- $u_{24} = 0.28$\n- $u_{25} = 0.10$\n- $u_{34} = 0.08$\n- $u_{35} = 0.28$\n- $u_{45} = 0.28$\n\n**Step 4: Compute the Sum**\n\nWe now compute the sum $U_{\\mathrm{sum}} = \\sum_{1 \\leq i < j \\leq 5} u_{ij}$.\n$$\nU_{\\mathrm{sum}} = u_{12} + u_{13} + u_{14} + u_{15} + u_{23} + u_{24} + u_{25} + u_{34} + u_{35} + u_{45}\n$$\nGrouping the values:\n$$\nU_{\\mathrm{sum}} = (u_{12}) + (u_{34}) + (u_{15} + u_{25}) + (u_{13} + u_{14} + u_{23} + u_{24} + u_{35} + u_{45})\n$$\n$$\nU_{\\mathrm{sum}} = (0.05) + (0.08) + 2 \\times (0.10) + 6 \\times (0.28)\n$$\n$$\nU_{\\mathrm{sum}} = 0.05 + 0.08 + 0.20 + 1.68\n$$\n$$\nU_{\\mathrm{sum}} = 0.13 + 0.20 + 1.68\n$$\n$$\nU_{\\mathrm{sum}} = 0.33 + 1.68\n$$\n$$\nU_{\\mathrm{sum}} = 2.01\n$$\nThe problem requires the answer to be rounded to $4$ significant figures. The exact answer $2.01$ has three significant figures. To express it with four, we append a zero.\n$$\nU_{\\mathrm{sum}} \\approx 2.010\n$$", "answer": "$$\\boxed{2.010}$$", "id": "3318635"}, {"introduction": "Beyond detecting hierarchy in data, it is insightful to understand how such structures can emerge from simple growth rules. This practice shifts our perspective from descriptive analysis to a generative model, exploring how a specific recursive rule gives rise to a network with clear hierarchical features [@problem_id:3318640]. By simulating the network's growth and deriving its properties, you will develop an intuition for the topological signatures of hierarchical organization, such as the characteristic relationship between a node's degree and its local clustering coefficient.", "problem": "Consider a deterministic hierarchical triadic-closure growth model used as a stylized representation of multiscale modular organization in Proteinâ€“Protein Interaction (PPI) networks. The initiator graph $G_0$ is a simple triangle with $3$ nodes and $3$ edges. The recursion rule is: from step $t$ to step $t+1$, for every existing edge in $G_t$, introduce a new node connected to both endpoints of that edge (this adds $2$ new edges per previously existing edge). All previously existing edges persist; no edges are removed.\n\nUsing only core graph-theoretic definitions (degree, local clustering coefficient) and the recursion rule above:\n\n- Simulate by hand the growth from $G_0$ to $G_1$ and then to $G_2$, explicitly identifying the nodes introduced at each step, their degrees $k_i$, and their local clustering coefficients $C_i$ defined by $C_i = \\dfrac{\\text{number of edges among the neighbors of node } i}{\\binom{k_i}{2}}$.\n- Starting from first principles and the recursion rule, derive a general expression for the local clustering coefficient $C(k)$ of a node as a function of its degree $k$ at an arbitrary step $t$. Use this expression to verify the values you computed for all nodes in $G_2$.\n- Finally, compute the exact average clustering coefficient $\\overline{C}(G_2)$ by averaging $C_i$ over all nodes in $G_2$.\n\nExpress your final answer for $\\overline{C}(G_2)$ as an exact fraction in lowest terms. No rounding is required. Provide no units.", "solution": "The problem statement is a valid exercise in graph theory and network science. It is scientifically grounded, well-posed, and objective. It provides a clear, deterministic rule for network growth and asks for the derivation and calculation of standard graph-theoretic metrics. No flaws are identified.\n\nLet $G_t=(V_t, E_t)$ be the graph at step $t$, with $N_t = |V_t|$ nodes and $M_t = |E_t|$ edges.\n\n**Step 1: Simulation of Graph Growth to $G_2$**\n\n**The Initiator Graph $G_0$ ($t=0$):**\nThe graph $G_0$ is a triangle.\n- Nodes: $V_0 = \\{v_{0,1}, v_{0,2}, v_{0,3}\\}$. Number of nodes $N_0 = 3$.\n- Edges: $E_0 = \\{(v_{0,1}, v_{0,2}), (v_{0,2}, v_{0,3}), (v_{0,3}, v_{0,1})\\}$. Number of edges $M_0 = 3$.\n- For any node $v_i \\in V_0$, its degree is $k_i = 2$.\n- The two neighbors of any node $v_i$ are connected. The number of edges between its neighbors is $1$.\n- The local clustering coefficient for each node is $C_i = \\dfrac{1}{\\binom{2}{2}} = 1$.\n\n**The Graph $G_1$ ($t=1$):**\nTo construct $G_1$ from $G_0$, we add one new node for each of the $M_0=3$ edges in $G_0$.\n- Let the new nodes be $v_{1,1}, v_{1,2}, v_{1,3}$, introduced on edges $(v_{0,1}, v_{0,2})$, $(v_{0,2}, v_{0,3})$, and $(v_{0,3}, v_{0,1})$ respectively.\n- Number of nodes: $N_1 = N_0 + M_0 = 3 + 3 = 6$.\n- Number of edges: $M_1 = M_0 + 2 M_0 = 3 + 2(3) = 9$.\n\nWe analyze the properties of the nodes in $G_1$:\n1.  **Original Nodes (Generation 0, 3 nodes):** These are the nodes from $V_0$.\n    - Degree: Each node $v \\in V_0$ had degree $k=2$ in $G_0$. For each of its 2 incident edges, a new node is added and connected to $v$. This adds 2 new edges to $v$. The total degree becomes $k = 2 + 2 = 4$.\n    - Clustering Coefficient: Let's consider $v_{0,1}$. Its neighbors in $G_0$ were $\\{v_{0,2}, v_{0,3}\\}$. In $G_1$, its neighbors are $\\{v_{0,2}, v_{0,3}, v_{1,1}, v_{1,3}\\}$. The degree is $k=4$. The edges between these 4 neighbors are:\n        - $(v_{0,2}, v_{0,3})$ (an edge from $G_0$)\n        - $(v_{0,2}, v_{1,1})$ (node $v_{1,1}$ is connected to $v_{0,2}$)\n        - $(v_{0,3}, v_{1,3})$ (node $v_{1,3}$ is connected to $v_{0,3}$)\n        There are $3$ such edges.\n        $C(v_{0,1}) = \\dfrac{3}{\\binom{4}{2}} = \\dfrac{3}{6} = \\dfrac{1}{2}$. By symmetry, this holds for all 3 original nodes.\n2.  **New Nodes (Generation 1, 3 nodes):** These are the nodes introduced at $t=1$.\n    - Degree: By construction, each new node is connected to the two endpoints of a single edge from $G_0$. Thus, their degree is $k=2$.\n    - Clustering Coefficient: The 2 neighbors of any new node are connected by the original edge from $G_0$. The number of edges between neighbors is $1$.\n    - $C(v_{1,j}) = \\dfrac{1}{\\binom{2}{2}} = \\dfrac{1}{1} = 1$.\n\n**The Graph $G_2$ ($t=2$):**\nTo construct $G_2$ from $G_1$, we add one new node for each of the $M_1=9$ edges in $G_1$.\n- Number of nodes: $N_2 = N_1 + M_1 = 6 + 9 = 15$.\n- Number of edges: $M_2 = M_1 + 2 M_1 = 9 + 2(9) = 27$.\n\nWe analyze the properties of the nodes in $G_2$, categorized by their generation:\n1.  **Generation 0 Nodes (3 nodes):**\n    - Degree: These nodes had degree $k=4$ in $G_1$. At step $t=2$, for each of the 4 incident edges, a new node is attached. Their degree doubles to $k = 4 + 4 = 8$.\n    - Clustering Coefficient: Consider an arbitrary gen-0 node $v$. In $G_1$, it had $k=4$ neighbors and there were $3$ edges among them. In $G_2$, its degree is $k=8$. The neighborhood consists of the 4 old neighbors and 4 new neighbors. The number of edges among the neighbors is the sum of:\n        - Edges between old neighbors: $3$ (persisting from $G_1$).\n        - Edges between an old and a new neighbor: Each of the 4 new neighbors is connected to exactly one of the old neighbors by construction. This adds $4$ edges.\n        - Edges between new neighbors: $0$, as new neighbors attached to $v$ are formed from distinct edges and share no other connections.\n        Total edges between neighbors = $3 + 4 = 7$.\n        $C_i = \\dfrac{7}{\\binom{8}{2}} = \\dfrac{7}{28} = \\dfrac{1}{4}$.\n2.  **Generation 1 Nodes (3 nodes):**\n    - Degree: These nodes had degree $k=2$ in $G_1$. Their degree doubles to $k = 2 + 2 = 4$.\n    - Clustering Coefficient: Consider an arbitrary gen-1 node $v$. In $G_1$, it had $k=2$ neighbors that were connected, so there was $1$ edge between them. In $G_2$, its degree is $k=4$. The number of edges among its 4 neighbors is:\n        - Edges between the 2 old neighbors: $1$ (persisting from $G_1$).\n        - Edges between old and new neighbors: Each of the 2 new neighbors is connected to one of the 2 old neighbors. This adds $2$ edges.\n        Total edges between neighbors = $1+2=3$.\n        $C_i = \\dfrac{3}{\\binom{4}{2}} = \\dfrac{3}{6} = \\dfrac{1}{2}$.\n3.  **Generation 2 Nodes (9 nodes):**\n    - Degree: These are the newly introduced nodes. By construction, their degree is $k=2$.\n    - Clustering Coefficient: The 2 neighbors of any new node are connected by the $G_1$ edge on which the new node was formed.\n    - $C_i = \\dfrac{1}{\\binom{2}{2}} = 1$.\n\n**Summary for $G_2$:**\n- $3$ nodes of generation 0 with $(k, C) = (8, 1/4)$.\n- $3$ nodes of generation 1 with $(k, C) = (4, 1/2)$.\n- $9$ nodes of generation 2 with $(k, C) = (2, 1)$.\n\n**Step 2: Derivation of the General Expression for $C(k)$**\n\nLet's analyze a node $v$ of generation $g$, created at step $t=g$.\nAt its creation (step $t=g$), its degree is $k_{g}(v) = 2$.\nFor any node $v$ existing at step $t$, its degree at step $t+1$ becomes $k_{t+1}(v) = k_t(v) + k_t(v) = 2k_t(v)$.\nThus, for a node of generation $g$, its degree at a future step $t \\ge g$ follows the recurrence $k_{t}(v) = 2k_{t-1}(v)$. This yields $k_{g,t}(v) = 2^{t-g} k_g(v) = 2^{t-g} \\cdot 2 = 2^{t-g+1}$.\n\nLet $T_t(v)$ be the number of edges among the neighbors of node $v$ at step $t$. The clustering coefficient is $C_t(v) = T_t(v) / \\binom{k_t(v)}{2}$.\nAt its creation (step $t=g$), node $v$ is part of one triangle, so $T_g(v) = 1$.\nAt step $t+1$, the new triangles involving $v$ can be formed by one old neighbor and one new neighbor. For each of the $k_t(v)$ edges incident to $v$ in $G_t$, a new node is created that is connected to $v$ and one of its old neighbors. This creates exactly $k_t(v)$ new triangles through $v$.\nThe number of triangles follows the recurrence: $T_{t+1}(v) = T_t(v) + k_t(v)$.\nWe solve this recurrence with the initial condition $T_g(v)=1$:\n$T_t(v) = T_g(v) + \\sum_{j=g}^{t-1} k_j(v) = 1 + \\sum_{j=g}^{t-1} 2^{j-g+1}$\nLet the index of summation be $i = j-g$. The sum runs from $i=0$ to $i=t-g-1$:\n$T_t(v) = 1 + \\sum_{i=0}^{t-g-1} 2^{i+1} = 1 + 2 \\sum_{i=0}^{t-g-1} 2^i = 1 + 2\\left(\\frac{2^{t-g}-1}{2-1}\\right) = 1 + 2(2^{t-g}-1) = 1 + 2^{t-g+1} - 2 = 2^{t-g+1} - 1$.\nWe recognize that $k_{g,t}(v) = 2^{t-g+1}$.\nTherefore, for any node $v$ that has existed for at least one step, its number of triangles is $T_t(v) = k_t(v) - 1$.\nFor a brand new node (where $t=g$), $k_g(v)=2$ and $T_g(v)=1$, so the relation $T=k-1$ also holds.\n\nThe local clustering coefficient as a function of degree $k$ is:\n$$C(k) = \\dfrac{T(k)}{\\binom{k}{2}} = \\dfrac{k-1}{\\frac{k(k-1)}{2}} = \\dfrac{2}{k}$$\nThis expression is valid for any node at any step $t$.\n\n**Verification for $G_2$:**\n- For gen-0 nodes in $G_2$, $k=8$. Formula: $C(8) = \\frac{2}{8} = \\frac{1}{4}$. Matches simulation.\n- For gen-1 nodes in $G_2$, $k=4$. Formula: $C(4) = \\frac{2}{4} = \\frac{1}{2}$. Matches simulation.\n- For gen-2 nodes in $G_2$, $k=2$. Formula: $C(2) = \\frac{2}{2} = 1$. Matches simulation.\n\n**Step 3: Calculation of Average Clustering Coefficient $\\overline{C}(G_2)$**\n\nThe average clustering coefficient of $G_2$ is the mean of the individual coefficients over all $N_2=15$ nodes.\n$$\\overline{C}(G_2) = \\frac{1}{N_2} \\sum_{i \\in V_2} C_i$$\nUsing the summarized properties for nodes in $G_2$:\n$$\\overline{C}(G_2) = \\frac{1}{15} \\left( 3 \\times C(k=8) + 3 \\times C(k=4) + 9 \\times C(k=2) \\right)$$\n$$\\overline{C}(G_2) = \\frac{1}{15} \\left( 3 \\times \\frac{1}{4} + 3 \\times \\frac{1}{2} + 9 \\times 1 \\right)$$\n$$\\overline{C}(G_2) = \\frac{1}{15} \\left( \\frac{3}{4} + \\frac{3}{2} + 9 \\right)$$\nTo sum the terms in the parenthesis, we use a common denominator of $4$:\n$$\\overline{C}(G_2) = \\frac{1}{15} \\left( \\frac{3}{4} + \\frac{6}{4} + \\frac{36}{4} \\right) = \\frac{1}{15} \\left( \\frac{3+6+36}{4} \\right) = \\frac{1}{15} \\left( \\frac{45}{4} \\right)$$\n$$\\overline{C}(G_2) = \\frac{45}{15 \\times 4} = \\frac{3 \\times 15}{15 \\times 4} = \\frac{3}{4}$$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "3318640"}, {"introduction": "The structural hierarchy of a biological network often has profound implications for its dynamics, enabling complex behaviors to emerge from interactions across multiple scales. This exercise delves into the connection between static structure and dynamic function by exploring the concept of model reduction for a continuous-time Markov chain (CTMC) [@problem_id:3318660]. You will test the condition of \"strong lumpability\", a rigorous mathematical criterion that determines whether a partition of a system's microstates into macrostates yields a valid and exact coarse-grained dynamical model, a cornerstone of multiscale modeling.", "problem": "A biochemical signaling motif exhibits four fast microstates due to phosphorylation and adaptor binding configurations. Over longer times, the system is hypothesized to admit a coarse-grained two-macrostate description corresponding to low-output and high-output activity. The microstate dynamics are modeled as a continuous-time Markov chain (CTMC) with generator matrix $Q \\in \\mathbb{R}^{4 \\times 4}$ (units $\\mathrm{min}^{-1}$), with state labels $1,2,3,4$ representing distinct micro-configurations. The generator is\n$$\nQ \\;=\\;\n\\begin{pmatrix}\n-0.9 & 0.4 & 0.3 & 0.2 \\\\\n0.7 & -1.2 & 0.3 & 0.2 \\\\\n0.25 & 0.15 & -0.9 & 0.5 \\\\\n0.25 & 0.15 & 0.6 & -1.0\n\\end{pmatrix}.\n$$\nYou are given the proposed two-block partition $\\mathcal{B} = \\{B_{1}, B_{2}\\}$ with $B_{1}=\\{1,2\\}$ (low-output) and $B_{2}=\\{3,4\\}$ (high-output). Using only the definitions of a CTMC generator and the concept of strong lumpability for continuous-time Markov chains (CTMCs), determine whether the partition $\\mathcal{B}$ yields a valid strongly lumpable coarse-graining at the CTMC level. If it does, compute the aggregated $2 \\times 2$ generator $\\tilde{Q}$ (units $\\mathrm{min}^{-1}$) governing the macrostate process on $\\{B_{1},B_{2}\\}$.\n\nExpress the final $2 \\times 2$ matrix in $\\mathrm{min}^{-1}$ using exact decimals (no rounding). Do not include any additional commentary with the final matrix.", "solution": "The problem requires us to determine if a given partition of the state space of a continuous-time Markov chain (CTMC) is strongly lumpable and, if so, to compute the generator matrix for the aggregated (lumped) process.\n\nFirst, we must validate that the provided matrix $Q$ is a valid generator for a CTMC. A matrix $Q = (Q_{ij})$ is a generator if and only if its off-diagonal elements are non-negative ($Q_{ij} \\ge 0$ for $i \\ne j$) and each row sums to zero ($\\sum_{j} Q_{ij} = 0$ for all $i$). Let's verify this for the given matrix:\n$$\nQ \\;=\\;\n\\begin{pmatrix}\n-0.9 & 0.4 & 0.3 & 0.2 \\\\\n0.7 & -1.2 & 0.3 & 0.2 \\\\\n0.25 & 0.15 & -0.9 & 0.5 \\\\\n0.25 & 0.15 & 0.6 & -1.0\n\\end{pmatrix}\n$$\nAll off-diagonal entries are clearly non-negative. We check the row sums:\nRow 1: $-0.9 + 0.4 + 0.3 + 0.2 = -0.9 + 0.9 = 0$.\nRow 2: $0.7 - 1.2 + 0.3 + 0.2 = 1.2 - 1.2 = 0$.\nRow 3: $0.25 + 0.15 - 0.9 + 0.5 = 0.9 - 0.9 = 0$.\nRow 4: $0.25 + 0.15 + 0.6 - 1.0 = 1.0 - 1.0 = 0$.\nSince all conditions are met, $Q$ is a valid generator matrix. The problem is well-defined.\n\nThe core of the problem lies in the definition of strong lumpability for a CTMC. Let the state space be $S = \\{1, 2, 3, 4\\}$, and let the partition be $\\mathcal{B} = \\{B_1, B_2, \\dots, B_M\\}$. A partition is strongly lumpable with respect to the generator $Q$ if, for any two blocks (macrostates) $B_I, B_J \\in \\mathcal{B}$, the sum of transition rates from any microstate $i \\in B_I$ to the block $B_J$ is constant. That is, for all $i, k \\in B_I$, the following condition must hold:\n$$\n\\sum_{j \\in B_J} Q_{ij} = \\sum_{j \\in B_J} Q_{kj}\n$$\nIf this condition holds, the aggregated process is also a CTMC with a generator $\\tilde{Q}$ on the macrostates $\\{B_1, \\dots, B_M\\}$, where the element $\\tilde{Q}_{IJ}$ is given by this common sum.\n\nThe given partition is $\\mathcal{B} = \\{B_1, B_2\\}$ where $B_1 = \\{1,2\\}$ and $B_2 = \\{3,4\\}$. We must check the lumpability condition for all pairs of macrostates $(B_I, B_J)$.\n\n1.  **Transitions originating from macrostate $B_1 = \\{1,2\\}$:**\n    We need to check if the sum of rates from microstates $1$ and $2$ to each macrostate ($B_1$ and $B_2$) are equal.\n\n    a.  **Rate from $B_1$ to $B_1$**: Check if $\\sum_{j \\in B_1} Q_{1j} = \\sum_{j \\in B_1} Q_{2j}$.\n        For microstate $i=1$: $\\sum_{j \\in \\{1,2\\}} Q_{1j} = Q_{11} + Q_{12} = -0.9 + 0.4 = -0.5$.\n        For microstate $i=2$: $\\sum_{j \\in \\{1,2\\}} Q_{2j} = Q_{21} + Q_{22} = 0.7 + (-1.2) = -0.5$.\n        The sums are equal. This condition is satisfied.\n\n    b.  **Rate from $B_1$ to $B_2$**: Check if $\\sum_{j \\in B_2} Q_{1j} = \\sum_{j \\in B_2} Q_{2j}$.\n        For microstate $i=1$: $\\sum_{j \\in \\{3,4\\}} Q_{1j} = Q_{13} + Q_{14} = 0.3 + 0.2 = 0.5$.\n        For microstate $i=2$: $\\sum_{j \\in \\{3,4\\}} Q_{2j} = Q_{23} + Q_{24} = 0.3 + 0.2 = 0.5$.\n        The sums are equal. This condition is also satisfied.\n\n2.  **Transitions originating from macrostate $B_2 = \\{3,4\\}$:**\n    We need to check if the sum of rates from microstates $3$ and $4$ to each macrostate ($B_1$ and $B_2$) are equal.\n\n    a.  **Rate from $B_2$ to $B_1$**: Check if $\\sum_{j \\in B_1} Q_{3j} = \\sum_{j \\in B_1} Q_{4j}$.\n        For microstate $i=3$: $\\sum_{j \\in \\{1,2\\}} Q_{3j} = Q_{31} + Q_{32} = 0.25 + 0.15 = 0.4$.\n        For microstate $i=4$: $\\sum_{j \\in \\{1,2\\}} Q_{4j} = Q_{41} + Q_{42} = 0.25 + 0.15 = 0.4$.\n        The sums are equal. This condition is satisfied.\n\n    b.  **Rate from $B_2$ to $B_2$**: Check if $\\sum_{j \\in B_2} Q_{3j} = \\sum_{j \\in B_2} Q_{4j}$.\n        For microstate $i=3$: $\\sum_{j \\in \\{3,4\\}} Q_{3j} = Q_{33} + Q_{34} = -0.9 + 0.5 = -0.4$.\n        For microstate $i=4$: $\\sum_{j \\in \\{3,4\\}} Q_{4j} = Q_{43} + Q_{44} = 0.6 + (-1.0) = -0.4$.\n        The sums are equal. This condition is also satisfied.\n\nSince all four conditions for strong lumpability are met, the partition $\\mathcal{B} = \\{\\{1,2\\}, \\{3,4\\}\\}$ is a valid strong lumpability. We can now construct the $2 \\times 2$ aggregated generator matrix $\\tilde{Q}$, where the states correspond to $B_1$ (low-output) and $B_2$ (high-output). The entries $\\tilde{Q}_{IJ}$ are the common sums we calculated.\n\n$\\tilde{Q}_{11} = (\\text{Rate from } B_1 \\text{ to } B_1) = -0.5 \\, \\mathrm{min}^{-1}$.\n$\\tilde{Q}_{12} = (\\text{Rate from } B_1 \\text{ to } B_2) = 0.5 \\, \\mathrm{min}^{-1}$.\n$\\tilde{Q}_{21} = (\\text{Rate from } B_2 \\text{ to } B_1) = 0.4 \\, \\mathrm{min}^{-1}$.\n$\\tilde{Q}_{22} = (\\text{Rate from } B_2 \\text{ to } B_2) = -0.4 \\, \\mathrm{min}^{-1}$.\n\nAs a final check, the rows of $\\tilde{Q}$ must sum to zero:\nRow 1: $\\tilde{Q}_{11} + \\tilde{Q}_{12} = -0.5 + 0.5 = 0$.\nRow 2: $\\tilde{Q}_{21} + \\tilde{Q}_{22} = 0.4 + (-0.4) = 0$.\nThe resulting matrix is a valid generator.\n\nThe aggregated generator matrix is:\n$$\n\\tilde{Q} =\n\\begin{pmatrix}\n-0.5 & 0.5 \\\\\n0.4 & -0.4\n\\end{pmatrix}\n$$\nThe units are $\\mathrm{min}^{-1}$ as inherited from the original generator $Q$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.5 & 0.5 \\\\\n0.4 & -0.4\n\\end{pmatrix}\n}\n$$", "id": "3318660"}]}