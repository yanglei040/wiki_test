{"hands_on_practices": [{"introduction": "Effective rule-based modeling begins with a precise definition of the molecular components. In languages like the BioNetGen Language (BNGL), this is achieved by declaring molecule types, their sites, and the states those sites can adopt. This foundational exercise [@problem_id:3347082] challenges you to apply these core semantic rules to enumerate the complete set of possibilities for a site's internal state and its binding state, reinforcing the crucial distinction between the logical state of being 'bound' versus the arbitrary labels used to notate specific bonds.", "problem": "In the BioNetGen Language (BNGL), a molecule type declaration specifies the set of sites on a molecule, which sites can carry internal states, and which sites can participate in bonds. Internal states are enumerated using the tilde symbol $\\,\\sim\\,$, and bonds are indicated by matching numeric labels introduced with the exclamation mark symbol $\\,!\\,$. According to BNGL’s well-established semantics: a site declared with an internal state enumeration has exactly those internal states available; a site declared without an internal state enumeration has no internal states; each site can participate in at most one bond at a time; and numeric bond labels have no intrinsic identity other than pairing the two sites that share the same label within a pattern. Consider the molecule types `A(s1~U~P, s2)` and `B(b)`, where `A` has two sites `s1` and `s2` with `s1` having internal states `U` and `P`, and `B` has one site `b`.\n\nFrom these definitions and constraints alone, determine which option correctly enumerates both the possible bond states specifically between `A.s2` and `B.b`, and the internal states available to `A.s1`. Choose the single best option that lists all and only the permitted possibilities implied by the molecule type declarations and BNGL bonding rules.\n\nA. Bond states between `A.s2` and `B.b`: exactly $2$ possibilities — unbound (no shared bond label, e.g., `A(s2)` and `B(b)` without any `!n` linking them) and singly bound (e.g., `A(s2!1).B(b!1)`). Internal states available to `A.s1`: exactly $2$ possibilities — `A(s1~U)` and `A(s1~P)`.\n\nB. Bond states between `A.s2` and `B.b`: countably many possibilities distinguished by bond labels `!n` with $n\\in\\mathbb{N}$ (e.g., `A(s2!1).B(b!1)`, `A(s2!2).B(b!2)`, etc.). Internal states available to `A.s1`: exactly $2$ possibilities — `A(s1~U)` and `A(s1~P)`.\n\nC. Bond states between `A.s2` and `B.b`: $3$ possibilities — unbound, singly bound, or bound through two distinct bonds simultaneously (double bond). Internal states available to `A.s1`: exactly $2$ possibilities — `A(s1~U)` and `A(s1~P)`.\n\nD. Bond states between `A.s2` and `B.b`: exactly $2$ possibilities — unbound and singly bound. Internal states available to `A.s1`: $3$ possibilities — `A(s1~U)`, `A(s1~P)`, and a wildcard `A(s1~?)` representing an additional unspecified state.\n\nE. Bond states between `A.s2` and `B.b`: exactly $2$ possibilities — unbound and singly bound. Internal states available to `A.s1`: none, because `A(s1~U~P)` only constrains rule matching but does not define actual internal states for `s1`.", "solution": "The problem requires a determination of two distinct sets of possibilities based on the provided BNGL rules: (1) the internal states of site `A.s1`, and (2) the bond states between sites `A.s2` and `B.b`.\n\n#### 1. Internal States Available to `A.s1`\n\nThe molecule type declaration for `A` is given as `A(s1~U~P, s2)`. The problem explicitly states the semantic rule: \"a site declared with an internal state enumeration has exactly those internal states available\".\n\n- The site `s1` is declared with the enumeration `~U~P`.\n- According to the rule, this means the set of all possible internal states for `s1` is precisely `{U, P}`.\n- Therefore, there are exactly $2$ possible internal states for `A.s1`. In BNGL patterns, these would be represented as `A(s1~U)` and `A(s1~P)`.\n\n#### 2. Bond States Between `A.s2` and `B.b`\n\nThe analysis of bond states concerns the relationship between two specific sites, `A.s2` and `B.b`. We must consider all possible connection statuses between them.\n\n- The first relevant rule is: \"each site can participate in at most one bond at a time\".\n- This rule immediately imposes a strong constraint. Any given site, such as `A.s2` or `B.b`, can be in one of two conditions: unbound, or bound to exactly one partner site. The possibility of being bound to multiple partners simultaneously (e.g., a \"double bond\" to the same partner, or bonds to two different partners) is explicitly forbidden.\n\nLet's enumerate the possibilities for the pair of sites (`A.s2`, `B.b`):\n\n- **Possibility 1: Unbound.** The sites `A.s2` and `B.b` are not connected by a bond. This is a valid state. In BNGL, this would be represented by the absence of a shared bond label, for example, `A(s2), B(b)` existing as separate species or parts of a larger complex without a direct link between these sites. This constitutes one distinct \"bond state\" (the state of being unbound).\n\n- **Possibility 2: Bound.** The site `A.s2` is connected to the site `B.b` by a bond.\n    - The rule \"each site can participate in at most one bond at a time\" means that if they are bound, it must be via a single bond.\n    - Now we must consider the second rule for bonds: \"numeric bond labels have no intrinsic identity other than pairing the two sites that share the same label within a pattern\". This is a critical semantic point. While one can write the bond using different labels, such as `A(s2!1).B(b!1)` or `A(s2!5).B(b!5)`, these are not different *types* of bonds or different *states* of connectivity. They all represent the same logical state: `A.s2` is bound to `B.b`. The number is merely an index for correctly pairing partners within a complex pattern, not a property of the bond itself.\n    - Therefore, there is only one \"bound\" state between `A.s2` and `B.b`.\n\nCombining these findings, there are exactly $2$ possible bond states between `A.s2` and `B.b`: unbound and singly bound.\n\n#### Summary of Results\n- **Internal states of `A.s1`**: Exactly $2$ possibilities (`U` and `P`).\n- **Bond states between `A.s2` and `B.b`**: Exactly $2$ possibilities (unbound and singly bound).\n\n### Option-by-Option Analysis\n\n**A. Bond states between `A.s2` and `B.b`: exactly $2$ possibilities — unbound (no shared bond label, e.g., `A(s2)` and `B(b)` without any `!n` linking them) and singly bound (e.g., `A(s2!1).B(b!1)`). Internal states available to `A.s1`: exactly $2$ possibilities — `A(s1~U)` and `A(s1~P)`.**\n- The analysis of bond states is correct. There are exactly two: unbound and singly bound.\n- The analysis of internal states is correct. There are exactly two: `U` and `P`.\n- **Verdict: Correct.**\n\n**B. Bond states between `A.s2` and `B.b`: countably many possibilities distinguished by bond labels `!n` with $n\\in\\mathbb{N}$ (e.g., `A(s2!1).B(b!1)`, `A(s2!2).B(b!2)`, etc.). Internal states available to `A.s1`: exactly $2$ possibilities — `A(s1~U)` and `A(s1~P)`.**\n- The analysis of bond states is incorrect. It misinterprets the role of bond labels. The problem explicitly states that \"numeric bond labels have no intrinsic identity\". Different labels `!1, !2, \\ldots` do not create different states of being bound.\n- **Verdict: Incorrect.**\n\n**C. Bond states between `A.s2` and `B.b`: $3$ possibilities — unbound, singly bound, or bound through two distinct bonds simultaneously (double bond). Internal states available to `A.s1`: exactly $2$ possibilities — `A(s1~U)` and `A(s1~P)`.**\n- The analysis of bond states is incorrect. A \"double bond\" would require each site to participate in two bonds, which is explicitly forbidden by the rule \"each site can participate in at most one bond at a time\".\n- **Verdict: Incorrect.**\n\n**D. Bond states between `A.s2` and `B.b`: exactly $2$ possibilities — unbound and singly bound. Internal states available to `A.s1`: $3$ possibilities — `A(s1~U)`, `A(s1~P)`, and a wildcard `A(s1~?)` representing an additional unspecified state.**\n- The analysis of internal states is incorrect. The problem states that the declared enumeration is exact: \"a site declared with an internal state enumeration has exactly those internal states available\". The wildcard `?` is a feature for matching patterns in rules, not a concrete state that a molecule can adopt. The set of available states is `{U, P}`, which has cardinality $2$.\n- **Verdict: Incorrect.**\n\n**E. Bond states between `A.s2` and `B.b`: exactly $2$ possibilities — unbound and singly bound. Internal states available to `A.s1`: none, because `A(s1~U~P)` only constrains rule matching but does not define actual internal states for `s1`.**\n- The analysis of internal states is incorrect. This statement directly contradicts the given rule: \"a site declared with an internal state enumeration has exactly those internal states available\". The declaration `s1~U~P` is what *defines* the available states.\n- **Verdict: Incorrect.**\n\nBased on the rigorous application of the provided semantic rules, only option A accurately describes both the possible bond states and internal states.", "answer": "$$\\boxed{A}$$", "id": "3347082"}, {"introduction": "The primary motivation for rule-based modeling is to manage the immense 'combinatorial complexity' inherent in molecular systems. Even a few components with a handful of states can combine to form a staggering number of distinct molecular species, or microstates. This practice problem [@problem_id:3347101] asks you to quantify this phenomenon directly by calculating the total number of species for a receptor that can dimerize, revealing how quickly the state space grows and underscoring the need for a compact, rule-based representation.", "problem": "Consider a receptor species in a rule-based model of molecular interactions. A single monomeric receptor has $n$ independent binary internal sites (for example, phosphorylation sites), each of which can be in state $0$ or $1$. The receptor can optionally homodimerize via a single unique dimerization interface, producing a complex consisting of two indistinguishable copies of the same monomer. The dimerization interface does not itself contribute an internal binary site; it only determines whether the receptor exists as a monomeric complex or as a dimeric complex. Assume that all $n$ internal sites are labeled at the level of a monomer, and that in a dimer, the two subunits are indistinguishable copies of the same monomer so that exchanging the two subunits does not produce a distinct microstate. Ignore all spatial orientation and geometry beyond the statement that a dimer consists of exactly two subunits joined by the unique interface, and no higher-order oligomers are permitted.\n\nUsing only elementary counting principles and definitions (for example, independence of binary site states, the notion of indistinguishable subunits as an exchange symmetry, and the definition of a microstate as a distinct species under the symmetry), derive a closed-form expression in $n$ for the total number of distinct microstates (rule-based species) when both monomeric and dimeric complexes are allowed. Then, justify the leading-order asymptotic growth rate of this count as $n \\to \\infty$ by providing a single dominant-term expression.\n\nProvide your final answer as a row matrix $\\bigl(T(n)\\ \\ L(n)\\bigr)$, where $T(n)$ is the exact total number of distinct microstates as a function of $n$, and $L(n)$ is a single leading-order asymptotic expression for $T(n)$ as $n \\to \\infty$. No rounding is required and no units are involved.", "solution": "The problem requires the derivation of a closed-form expression for the total number of distinct microstates, $T(n)$, in a system that allows for both monomeric and dimeric species, and a determination of the leading-order asymptotic growth of this count, $L(n)$. A microstate is defined as a distinct molecular species, accounting for the specified symmetries.\n\nThe total number of microstates is the sum of the number of unique monomeric states, $M(n)$, and the number of unique dimeric states, $D(n)$:\n$$T(n) = M(n) + D(n)$$\n\nFirst, we determine the number of distinct monomeric microstates, $M(n)$.\nA monomer has $n$ independent internal sites, each of which can be in one of two states ($0$ or $1$). The state of a monomer is therefore completely specified by a binary vector of length $n$. The total number of such unique vectors is $2^n$.\n$$M(n) = 2^n$$\n\nNext, we determine the number of distinct dimeric microstates, $D(n)$.\nA dimer is composed of two monomer subunits. The problem states that these two subunits are \"indistinguishable,\" which implies an exchange symmetry: a dimer composed of subunit $s_1$ and subunit $s_2$ is the same as one composed of $s_2$ and $s_1$.\nLet $S$ be the set of all possible monomeric states, where $|S| = M(n) = 2^n$. A dimer corresponds to an unordered selection of two states from the set $S$, with replacement allowed (as the two subunits can be in the identical state). This is a classic combinatorial problem of counting combinations with repetition.\n\nThe number of ways to choose a multiset of size $k$ from a set of size $m$ is given by the multiset coefficient, $\\binom{m+k-1}{k}$.\nIn our case, we are choosing $k=2$ subunits from a set of $m = 2^n$ possible monomer states.\n$$D(n) = \\binom{2^n + 2 - 1}{2} = \\binom{2^n + 1}{2}$$\nExpanding the binomial coefficient:\n$$D(n) = \\frac{(2^n + 1)!}{2! (2^n + 1 - 2)!} = \\frac{(2^n + 1)(2^n)}{2}$$\n$$D(n) = \\frac{2^{2n} + 2^n}{2} = 2^{2n-1} + 2^{n-1}$$\n\nNow, we can find the total number of microstates, $T(n)$, by summing the monomeric and dimeric counts.\n$$T(n) = M(n) + D(n) = 2^n + (2^{2n-1} + 2^{n-1})$$\nTo simplify this expression, we can write $2^n$ as $2 \\cdot 2^{n-1}$:\n$$T(n) = 2^{2n-1} + (2 \\cdot 2^{n-1} + 2^{n-1})$$\n$$T(n) = 2^{2n-1} + 3 \\cdot 2^{n-1}$$\nThis is the exact closed-form expression for the total number of distinct microstates.\n\nFinally, we must find the leading-order asymptotic growth rate of $T(n)$ as $n \\to \\infty$. The expression for $T(n)$ has two terms: $2^{2n-1}$ and $3 \\cdot 2^{n-1}$. Let's analyze their behavior for large $n$:\nThe first term is $2^{2n-1} = \\frac{1}{2}(2^2)^n = \\frac{1}{2} \\cdot 4^n$.\nThe second term is $3 \\cdot 2^{n-1} = \\frac{3}{2} \\cdot 2^n$.\nThe expression is $T(n) = \\frac{1}{2} \\cdot 4^n + \\frac{3}{2} \\cdot 2^n$.\nAs $n \\to \\infty$, the term with the largest base in the exponentiation will dominate the sum. Comparing the bases $4$ and $2$, the term involving $4^n$ grows much faster than the term involving $2^n$.\nTo formally verify this, we examine the ratio of the second term to the first term in the limit $n \\to \\infty$:\n$$\\lim_{n\\to\\infty} \\frac{3 \\cdot 2^{n-1}}{2^{2n-1}} = \\lim_{n\\to\\infty} \\frac{3 \\cdot 2^n / 2}{2^{2n} / 2} = \\lim_{n\\to\\infty} 3 \\cdot \\frac{2^n}{4^n} = \\lim_{n\\to\\infty} 3 \\left(\\frac{1}{2}\\right)^n = 0$$\nSince the limit is $0$, the denominator, $2^{2n-1}$, is the dominant term.\nTherefore, the leading-order asymptotic expression for $T(n)$ is:\n$$L(n) = 2^{2n-1}$$\n\nThe solution consists of the exact count $T(n)$ and the leading-order asymptotic expression $L(n)$.", "answer": "$$\\boxed{\\begin{pmatrix} 2^{2n-1} + 3 \\cdot 2^{n-1}  2^{2n-1} \\end{pmatrix}}$$", "id": "3347101"}, {"introduction": "Rules create dynamics by matching patterns within the molecular mixture, and the number of ways a pattern can be matched, or 'embedded', determines a reaction's propensity. This process, however, contains subtleties, especially when patterns themselves possess symmetry. This exercise [@problem_id:3347061] challenges you to count the unique embeddings of a symmetric homodimer pattern, forcing you to account for pattern automorphisms—a critical concept for correctly calculating reaction rates in a quantitative model.", "problem": "In rule-based modeling of molecular interactions, molecular species are represented as site-graphs and interaction rules are specified as patterns that are matched to mixtures. Consider a single agent type $A$ with one binding site $x$. A mixture consists of $m$ isolated monomeric agents $A(x)$ whose site $x$ is unbound, and $d$ dimeric complexes $A(x!1).A(x!1)$ in which two $A$ agents are connected by a single bond through site $x$. Assume there are no other complexes present, all agents are indistinguishable, there are no internal states, and there is no labeling that distinguishes the two agents within a dimer.\n\nA pattern is the site-graph $P = A(x!1).A(x!1)$, which requires two $A$ agents whose sites $x$ are bound to each other by a single bond. A pattern embedding is an injective site-graph homomorphism from $P$ into the mixture that preserves agent type, site identity, and bond incidence. Two embeddings are considered the same if they differ only by an automorphism of the pattern $P$ (that is, we quotient by the automorphism group of $P$ when counting embeddings).\n\nStarting from the above definitions and first principles of graph embeddings and symmetry in rule-based modeling, derive a closed-form expression, in terms of $m$ and $d$, for the number of unique embeddings of the pattern $P$ into the mixture, with symmetry taken into account as stated.\n\nProvide your final answer as a single analytic expression in terms of $m$ and $d$. No rounding is required. The answer is unitless.", "solution": "The problem asks for the number of unique embeddings of a pattern $P$ into a mixture $M$. This is calculated by first finding the total number of injective homomorphisms from the pattern to the mixture, and then dividing by the number of symmetries (automorphisms) in the pattern itself.\n\n### Step 1: Characterize the Pattern and Mixture\n\n- **Pattern $P$**: The pattern is $P = A(x!1).A(x!1)$. This is a graph of two indistinguishable agents of type $A$ connected by a bond at their respective $x$ sites.\n- **Mixture $M$**: The mixture consists of two types of species:\n    1.  $m$ monomers, $A(x)$, which are single agents with an unbound site.\n    2.  $d$ dimers, $A(x!1).A(x!1)$, which are complexes of two agents connected by a bond.\n\n### Step 2: Count the Total Number of Injective Homomorphisms\n\nAn injective homomorphism is a one-to-one mapping of the pattern's agents into the mixture's agents that preserves all specified properties (agent type, site identity, and connectivity).\n\n- The pattern $P$ specifies two agents connected by a bond.\n- Such a structure can only be found within the $d$ dimers in the mixture. It cannot be mapped to the monomers, as they are not bonded.\n- Therefore, any valid embedding must map the pattern $P$ onto one of the $d$ existing dimers.\n\nLet's consider mapping the pattern to a single target dimer in the mixture.\n- Let the agents in the pattern be $p_1$ and $p_2$.\n- Let the agents in a chosen target dimer be $a_1$ and $a_2$.\n- Since the mapping must be injective (one-to-one), we can map the pattern agents to the target agents in two ways:\n    1.  Mapping 1: $p_1 \\to a_1$ and $p_2 \\to a_2$.\n    2.  Mapping 2: $p_1 \\to a_2$ and $p_2 \\to a_1$.\n- Both of these mappings are valid injective homomorphisms because they preserve the agent types and the bond between them.\n\nSince there are $d$ identical dimers to choose from as the target, and each choice provides 2 possible injective homomorphisms, the total number of injective homomorphisms is:\n$$|E| = d \\times 2 = 2d$$\n\n### Step 3: Account for Pattern Symmetry\n\nThe problem states that embeddings are counted \"modulo the automorphism group of $P$.\" This means we need to find the size of the automorphism group of the pattern, $|Aut(P)|$. An automorphism is a symmetry of the pattern, i.e., a permutation of the pattern's agents that leaves the pattern's structure unchanged.\n\n- The pattern $P = A(x!1).A(x!1)$ consists of two identical agents connected symmetrically.\n- The agents within the pattern, $p_1$ and $p_2$, are indistinguishable.\n- The possible permutations of these two agents are:\n    1.  The identity: $(p_1 \\to p_1, p_2 \\to p_2)$. This is always an automorphism.\n    2.  The swap: $(p_1 \\to p_2, p_2 \\to p_1)$. Since both agents are of type $A$ and are connected in the same way, swapping them results in the identical pattern structure. This is also a valid automorphism.\n\nTherefore, the automorphism group of the pattern $P$ has 2 elements.\n$$|Aut(P)| = 2$$\n\n### Step 4: Calculate the Number of Unique Embeddings\n\nThe number of unique embeddings is the total number of injective homomorphisms divided by the size of the pattern's automorphism group.\n$$ \\text{Number of unique embeddings} = \\frac{|E|}{|Aut(P)|} = \\frac{2d}{2} = d $$\n\nThe number of monomers, $m$, is irrelevant to the calculation because the pattern specifies a bond, a feature that is absent in the monomers. The final expression depends only on the number of dimers, $d$.", "answer": "$$\n\\boxed{d}\n$$", "id": "3347061"}]}