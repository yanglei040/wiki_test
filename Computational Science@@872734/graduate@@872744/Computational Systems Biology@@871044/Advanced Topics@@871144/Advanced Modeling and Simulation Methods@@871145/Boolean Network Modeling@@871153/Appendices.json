{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will start with the most fundamental task in Boolean network analysis: mapping the complete dynamics of a small system. This practice involves constructing the State Transition Graph (STG), which serves as a complete map of how the network evolves from any possible state. By systematically applying the synchronous update rules and identifying the resulting attractors—such as fixed points and limit cycles—you will gain a concrete understanding of how local interaction rules give rise to stable, global patterns of activity, which are often interpreted as cellular phenotypes. [@problem_id:3292409]", "problem": "Consider a deterministic Boolean network (BN) with $3$ nodes representing a simplified gene regulatory module. In a Boolean network (BN), each node $x_{i} \\in \\{0,1\\}$ updates synchronously by applying its Boolean update function $f_{i}$ to the current network state $\\mathbf{x} = (x_{1}, x_{2}, x_{3}) \\in \\{0,1\\}^{3}$. The synchronous update induces a global update map $\\mathbf{f} : \\{0,1\\}^{3} \\to \\{0,1\\}^{3}$ defined by $\\mathbf{f}(\\mathbf{x}) = (f_{1}(\\mathbf{x}), f_{2}(\\mathbf{x}), f_{3}(\\mathbf{x}))$. The State Transition Graph (STG) is the directed graph whose vertices are all $2^{3}$ states and whose edges are the ordered pairs $(\\mathbf{x}, \\mathbf{f}(\\mathbf{x}))$. An attractor is a minimal nonempty set $\\mathcal{A} \\subseteq \\{0,1\\}^{3}$ that is closed under $\\mathbf{f}$; fixed points are attractors of period $1$, and cyclic attractors have period greater than $1$.\n\nYou are given the node update rules\n$$\nf_{1} = x_{2} \\land \\neg x_{3}, \\quad f_{2} = x_{1} \\lor x_{3}, \\quad f_{3} = \\neg x_{1}.\n$$\nTasks:\n- Construct the full transition relation under synchronous updating by computing $\\mathbf{f}(\\mathbf{x})$ for all $2^{3}$ states $\\mathbf{x} \\in \\{0,1\\}^{3}$.\n- Using first principles, verify determinism of trajectories for this synchronous BN by arguing from the definition of the global update map and the STG.\n- Identify all attractors in the STG (including fixed points and cycles). Then, report the total number of distinct attractors.\n\nProvide your final answer as a single integer. No rounding is needed; no units are required.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in the analysis of Boolean networks, a well-established topic in computational systems biology. All required definitions and functions are provided, and there are no contradictions or ambiguities.\n\nThe Boolean network (BN) consists of $3$ nodes, with states $x_1, x_2, x_3 \\in \\{0,1\\}$. The network state is a vector $\\mathbf{x} = (x_1, x_2, x_3) \\in \\{0,1\\}^3$. The synchronous update functions are given as:\n$$\nf_1(\\mathbf{x}) = x_2 \\land \\neg x_3\n$$\n$$\nf_2(\\mathbf{x}) = x_1 \\lor x_3\n$$\n$$\nf_3(\\mathbf{x}) = \\neg x_1\n$$\nwhere we interpret logical TRUE as $1$ and FALSE as $0$. The global update map is $\\mathbf{f}(\\mathbf{x}) = (f_1(\\mathbf{x}), f_2(\\mathbf{x}), f_3(\\mathbf{x}))$.\n\n**Task 1: Construct the full transition relation**\n\nWe compute the next state $\\mathbf{f}(\\mathbf{x})$ for each of the $2^3 = 8$ possible current states $\\mathbf{x}$. The results are compiled into the State Transition Table below.\n\n1.  For $\\mathbf{x} = (0,0,0)$:\n    $f_1 = 0 \\land \\neg 0 = 0 \\land 1 = 0$\n    $f_2 = 0 \\lor 0 = 0$\n    $f_3 = \\neg 0 = 1$\n    $\\mathbf{f}(0,0,0) = (0,0,1)$\n\n2.  For $\\mathbf{x} = (0,0,1)$:\n    $f_1 = 0 \\land \\neg 1 = 0 \\land 0 = 0$\n    $f_2 = 0 \\lor 1 = 1$\n    $f_3 = \\neg 0 = 1$\n    $\\mathbf{f}(0,0,1) = (0,1,1)$\n\n3.  For $\\mathbf{x} = (0,1,0)$:\n    $f_1 = 1 \\land \\neg 0 = 1 \\land 1 = 1$\n    $f_2 = 0 \\lor 0 = 0$\n    $f_3 = \\neg 0 = 1$\n    $\\mathbf{f}(0,1,0) = (1,0,1)$\n\n4.  For $\\mathbf{x} = (0,1,1)$:\n    $f_1 = 1 \\land \\neg 1 = 1 \\land 0 = 0$\n    $f_2 = 0 \\lor 1 = 1$\n    $f_3 = \\neg 0 = 1$\n    $\\mathbf{f}(0,1,1) = (0,1,1)$\n\n5.  For $\\mathbf{x} = (1,0,0)$:\n    $f_1 = 0 \\land \\neg 0 = 0 \\land 1 = 0$\n    $f_2 = 1 \\lor 0 = 1$\n    $f_3 = \\neg 1 = 0$\n    $\\mathbf{f}(1,0,0) = (0,1,0)$\n\n6.  For $\\mathbf{x} = (1,0,1)$:\n    $f_1 = 0 \\land \\neg 1 = 0 \\land 0 = 0$\n    $f_2 = 1 \\lor 1 = 1$\n    $f_3 = \\neg 1 = 0$\n    $\\mathbf{f}(1,0,1) = (0,1,0)$\n\n7.  For $\\mathbf{x} = (1,1,0)$:\n    $f_1 = 1 \\land \\neg 0 = 1 \\land 1 = 1$\n    $f_2 = 1 \\lor 0 = 1$\n    $f_3 = \\neg 1 = 0$\n    $\\mathbf{f}(1,1,0) = (1,1,0)$\n\n8.  For $\\mathbf{x} = (1,1,1)$:\n    $f_1 = 1 \\land \\neg 1 = 1 \\land 0 = 0$\n    $f_2 = 1 \\lor 1 = 1$\n    $f_3 = \\neg 1 = 0$\n    $\\mathbf{f}(1,1,1) = (0,1,0)$\n\nThe full state transition relation is:\n$$(0,0,0) \\to (0,0,1)$$\n$$(0,0,1) \\to (0,1,1)$$\n$$(0,1,0) \\to (1,0,1)$$\n$$(0,1,1) \\to (0,1,1)$$\n$$(1,0,0) \\to (0,1,0)$$\n$$(1,0,1) \\to (0,1,0)$$\n$$(1,1,0) \\to (1,1,0)$$\n$$(1,1,1) \\to (0,1,0)$$\n\n**Task 2: Verify determinism of trajectories**\n\nThe system is deterministic by definition. The global update map $\\mathbf{f}: \\{0,1\\}^3 \\to \\{0,1\\}^3$ is a mathematical function. A core property of a function is that for any given input $\\mathbf{x}$ in its domain, it produces a single, unique output $\\mathbf{f}(\\mathbf{x})$. The State Transition Graph (STG) is constructed with vertices representing the states and directed edges given by $(\\mathbf{x}, \\mathbf{f}(\\mathbf{x}))$. Because $\\mathbf{f}$ is a function, every vertex (state) in the STG has exactly one outgoing edge. A trajectory starting from an initial state $\\mathbf{x}(0)$ is the sequence of states $\\mathbf{x}(t)$ generated by the iterative application of $\\mathbf{f}$, i.e., $\\mathbf{x}(t+1) = \\mathbf{f}(\\mathbf{x}(t))$. Since each step from $\\mathbf{x}(t)$ to $\\mathbf{x}(t+1)$ is uniquely determined, the entire trajectory is uniquely determined by its initial state. This is the definition of a deterministic dynamical system.\n\n**Task 3: Identify all attractors**\n\nAn attractor is a minimal set of states from which the system cannot escape. In a finite deterministic system, all trajectories must lead to an attractor, which will be either a fixed point or a limit cycle. We analyze the state transitions to find these minimal closed sets.\n\nFrom the transition table:\n- We can immediately identify two fixed-point attractors, where $\\mathbf{f}(\\mathbf{x}) = \\mathbf{x}$:\n  - $\\mathbf{f}(0,1,1) = (0,1,1)$. This is a fixed point. Let's call this attractor $\\mathcal{A}_1 = \\{(0,1,1)\\}$.\n  - $\\mathbf{f}(1,1,0) = (1,1,0)$. This is also a fixed point. Let's call this attractor $\\mathcal{A}_2 = \\{(1,1,0)\\}$.\n\n- Next, we trace the trajectories of the remaining states to see where they lead. Let's start with a state not already in an attractor, for example, $(0,1,0)$:\n  - $(0,1,0) \\to (1,0,1)$\n  - Now we trace $(1,0,1)$: $(1,0,1) \\to (0,1,0)$.\n  This forms a 2-cycle: $(0,1,0) \\leftrightarrows (1,0,1)$. This is a cyclic attractor of period $2$. Let's call this attractor $\\mathcal{A}_3 = \\{(0,1,0), (1,0,1)\\}$.\n\n- We must check that all other states lead to one of these three attractors.\n  - $(0,0,0) \\to (0,0,1) \\to (0,1,1)$. This trajectory enters the fixed point $\\mathcal{A}_1$.\n  - $(1,0,0) \\to (0,1,0)$. This trajectory enters the 2-cycle $\\mathcal{A}_3$.\n  - $(1,1,1) \\to (0,1,0)$. This trajectory also enters the 2-cycle $\\mathcal{A}_3$.\n\nAll $8$ states have been accounted for. The state space is partitioned into the basins of attraction of these three attractors. The distinct attractors are:\n1. A fixed point: $\\mathcal{A}_1 = \\{(0,1,1)\\}$\n2. A fixed point: $\\mathcal{A}_2 = \\{(1,1,0)\\}$\n3. A 2-cycle: $\\mathcal{A}_3 = \\{(0,1,0), (1,0,1)\\}$\n\nThe total number of distinct attractors is $3$.", "answer": "$$\\boxed{3}$$", "id": "3292409"}, {"introduction": "Real biological processes rarely march in lockstep, yet the standard synchronous Boolean network model assumes they do. This exercise challenges that idealization by exploring how network behavior changes under more realistic asynchronous update schemes. You will implement and compare the dynamics of a simple regulatory motif under synchronous, fixed-order asynchronous, and random-order asynchronous updates, directly observing how some stable patterns, or attractors, can be artifacts of the chosen update timing. This practice is crucial for developing a critical perspective on model assumptions and understanding which predicted behaviors are robust and which are fragile. [@problem_id:3292480]", "problem": "Consider a Boolean network with $3$ nodes representing a regulatory motif with mutual inhibition and self-retention. Let the state be $x = (x_1, x_2, x_3) \\in \\{0,1\\}^3$, where $0$ represents \"off\" and $1$ represents \"on\". The local update functions are defined by the following logical rules that map the current state $x$ to the next state:\n$$\nf_1(x) = \\neg x_2, \\quad f_2(x) = \\neg x_1, \\quad f_3(x) = x_3,\n$$\nwhere $\\neg$ is logical negation, and logical values are identified with integers $0$ for false and $1$ for true. The global synchronous update operator $F: \\{0,1\\}^3 \\to \\{0,1\\}^3$ updates all nodes simultaneously according to\n$$\nF(x) = (f_1(x), f_2(x), f_3(x)).\n$$\nDefine the local single-node update operator $U_i: \\{0,1\\}^3 \\to \\{0,1\\}^3$ by\n$$\nU_i(x)_j = \n\\begin{cases}\nf_i(x),  \\text{if } j = i, \\\\\nx_j,  \\text{if } j \\neq i,\n\\end{cases}\n$$\nwhich updates only node $i$ using the current values of all nodes while leaving other nodes unchanged. For a permutation $\\pi$ of $\\{1,2,3\\}$, the asynchronous fixed-order update $F_{\\pi}: \\{0,1\\}^3 \\to \\{0,1\\}^3$ is the sequential composition\n$$\nF_{\\pi}(x) = U_{\\pi(3)}\\big(U_{\\pi(2)}\\big(U_{\\pi(1)}(x)\\big)\\big),\n$$\nthat is, apply $U_{\\pi(1)}$, then $U_{\\pi(2)}$, then $U_{\\pi(3)}$, each using the most recently updated state. In the random-order asynchronous regime, at macro-step $t$, independently sample a permutation $\\pi_t$ uniformly at random from all permutations of $\\{1,2,3\\}$ using a pseudorandom number generator with a specified seed, and apply $F_{\\pi_t}$ to obtain the next macro-state.\n\nAn attractor is a recurrent set of states under the given update regime. For deterministic regimes (synchronous and fixed-order asynchronous), this reduces to cycles of length $L \\ge 1$ under repeated application of the corresponding global update operator, with $L=1$ representing a fixed point. For the random-order asynchronous regime under a fixed pseudorandom seed, a macro-dynamics is induced by the seeded sequence of permutations; detect recurrent states by tracking visits and report the cycle lengths observed for that induced dynamic. The goal is to compute all attractor lengths encountered from all $8$ possible initial states $x \\in \\{0,1\\}^3$ for each regime, and to highlight how cycles present under synchronous updates can disappear under asynchronous updates.\n\nStarting from the foundational definitions above, implement a program that:\n1. Enumerates all $8$ initial states $x \\in \\{0,1\\}^3$.\n2. For the synchronous regime, applies $F$ repeatedly from each initial state and detects the attractor length by first-repeat detection.\n3. For the asynchronous fixed-order regime with $\\pi = (1,2,3)$, applies $F_{\\pi}$ repeatedly and detects attractor lengths similarly.\n4. For the asynchronous fixed-order regime with $\\pi = (3,2,1)$, applies $F_{\\pi}$ repeatedly and detects attractor lengths similarly.\n5. For the random-order asynchronous regime, for each initial state, uses a pseudorandom generator seeded with $s = 2025 + i$, where $i$ is the integer index of the initial state in lexicographic order of $\\{0,1\\}^3$, to generate up to $T = 30$ permutations $\\pi_t$, applies their corresponding $F_{\\pi_t}$ sequentially, and detects the first recurrence to determine the attractor length; if no recurrence is found within $T$ macro-steps, assume no cycle was detected and exclude that initial state from the reported lengths.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the sorted list of distinct attractor lengths for the corresponding regime, aggregated across all $8$ initial states. The four regimes are evaluated in the following order: synchronous, asynchronous with $\\pi=(1,2,3)$, asynchronous with $\\pi=(3,2,1)$, random-order asynchronous with seed rule described above and $T=30$. For example, the output format must be\n$$\n[\\,[L_{sync}],\\,[L_{123}],\\,[L_{321}],\\,[L_{rand}]\\,],\n$$\nwhere each bracketed item is a Python list literal of integers such as $[1,2]$.\n\nTest Suite and Answer Specification:\n- Regime $1$ (synchronous): compute and return the sorted list of distinct cycle lengths $[L_{sync}]$ across all $8$ initial states.\n- Regime $2$ (asynchronous fixed order with $\\pi=(1,2,3)$): compute and return $[L_{123}]$.\n- Regime $3$ (asynchronous fixed order with $\\pi=(3,2,1)$): compute and return $[L_{321}]$.\n- Regime $4$ (random-order asynchronous with the seed rule $s = 2025 + i$ and horizon $T=30$): compute and return $[L_{rand}]$.\n\nThe final program output must be a single line in the exact format: a comma-separated list of the four lists enclosed in a single pair of square brackets. No physical units are involved. Angles are not involved. Percentages are not involved. All answers for each test case are lists of integers.", "solution": "The user-provided problem is a well-defined exercise in the analysis of Boolean network dynamics under different update schemes. The problem statement is scientifically sound, self-contained, and algorithmically solvable. It will be addressed by implementing the specified update rules and attractor detection algorithms for each of the four regimes.\n\n### 1. Formalization of the System\n\nThe Boolean network consists of $N=3$ nodes. A state of the network is a vector $x = (x_1, x_2, x_3)$, where each $x_i \\in \\{0, 1\\}$. The state space is thus $\\{0, 1\\}^3$, containing $2^3 = 8$ possible states.\n\nThe local update functions are given as:\n$f_1(x) = \\neg x_2 = 1 - x_2$\n$f_2(x) = \\neg x_1 = 1 - x_1$\n$f_3(x) = x_3$\n\nThese functions define how each node's next state is determined based on the current state of the network. We will now analyze the dynamics under four different update regimes. For attractor detection, since the state space is finite, any trajectory must eventually repeat a state. If a state $x$ reappears after $L$ steps, a cycle of length $L$ has been found.\n\n### 2. Regime 1: Synchronous Update\n\nIn the synchronous regime, all nodes are updated simultaneously. The global update operator $F: \\{0,1\\}^3 \\to \\{0,1\\}^3$ is:\n$$\nF(x_1, x_2, x_3) = (f_1(x), f_2(x), f_3(x)) = (1-x_2, 1-x_1, x_3)\n$$\nTo find the attractors, we will start from each of the $8$ initial states and repeatedly apply $F$. We will record the sequence of states and detect the first repetition.\n\nFor example, starting with $x_0 = (0,0,0)$:\n$x_1 = F(0,0,0) = (1-0, 1-0, 0) = (1,1,0)$\n$x_2 = F(1,1,0) = (1-1, 1-1, 0) = (0,0,0)$\nSince $x_2 = x_0$, we have found a cycle of length $L = 2-0 = 2$.\n\nBy analyzing all $8$ initial states, we identify all attractors. The set of distinct cycle lengths found constitutes the result for this regime. Fixed points are cycles of length $L=1$.\n\n### 3. Regime 2: Asynchronous Fixed-Order Update $\\pi=(1,2,3)$\n\nIn this regime, nodes are updated sequentially in the fixed order $1, 2, 3$. The update operator $F_{(1,2,3)}$ is the composition $U_3 \\circ U_2 \\circ U_1$. Given a state $x^{(0)} = (x_1, x_2, x_3)$:\n1. Update node 1: $x^{(1)} = U_1(x^{(0)}) = (f_1(x^{(0)}), x_2, x_3) = (1-x_2, x_2, x_3)$.\n2. Update node 2: $x^{(2)} = U_2(x^{(1)}) = (x^{(1)}_1, f_2(x^{(1)}), x^{(1)}_3) = (1-x_2, 1-x^{(1)}_1, x_3) = (1-x_2, 1-(1-x_2), x_3) = (1-x_2, x_2, x_3)$.\n3. Update node 3: $x^{(3)} = U_3(x^{(2)}) = (x^{(2)}_1, x^{(2)}_2, f_3(x^{(2)})) = (1-x_2, x_2, x^{(2)}_3) = (1-x_2, x_2, x_3)$.\n\nSo, the overall update function is $F_{(1,2,3)}(x_1, x_2, x_3) = (1-x_2, x_2, x_3)$.\nAn attractor is a fixed point if $F_{(1,2,3)}(x) = x$, which implies $(x_1, x_2, x_3) = (1-x_2, x_2, x_3)$. This requires $x_1 = 1-x_2$. Any state satisfying this condition is a fixed point. These are $(1,0,0)$, $(1,0,1)$, $(0,1,0)$, and $(0,1,1)$.\nFor any state not satisfying this condition, e.g., $x=(0,0,0)$, one application of $F_{(1,2,3)}$ yields $F_{(1,2,3)}(0,0,0) = (1,0,0)$, which is a fixed point. All trajectories thus converge to a fixed point within one step. Consequently, the only attractor length is $1$.\n\n### 4. Regime 3: Asynchronous Fixed-Order Update $\\pi=(3,2,1)$\n\nHere, nodes are updated in the order $3, 2, 1$. The operator is $F_{(3,2,1)} = U_1 \\circ U_2 \\circ U_3$. Given $x^{(0)} = (x_1, x_2, x_3)$:\n1. Update node 3: $x^{(1)} = U_3(x^{(0)}) = (x_1, x_2, f_3(x^{(0)})) = (x_1, x_2, x_3) = x^{(0)}$.\n2. Update node 2: $x^{(2)} = U_2(x^{(1)}) = (x_1, f_2(x^{(1)}), x_3) = (x_1, 1-x_1, x_3)$.\n3. Update node 1: $x^{(3)} = U_1(x^{(2)}) = (f_1(x^{(2)}), x^{(2)}_2, x^{(2)}_3) = (1-x^{(2)}_2, 1-x_1, x_3) = (1-(1-x_1), 1-x_1, x_3) = (x_1, 1-x_1, x_3)$.\n\nThe update function is $F_{(3,2,1)}(x_1, x_2, x_3) = (x_1, 1-x_1, x_3)$.\nSimilar to the previous regime, fixed points must satisfy $x_2 = 1-x_1$, which is the same condition as before. The set of fixed points is identical: $\\{(1,0,0), (1,0,1), (0,1,0), (0,1,1)\\}$. All other states transition to one of these fixed points in a single step. For instance, $F_{(3,2,1)}(0,0,0) = (0,1,0)$. Again, all attractors are fixed points, and the only attractor length is $1$.\n\n### 5. Regime 4: Random-Order Asynchronous Update\n\nIn this stochastic regime, for each initial state $x_i$ (where $i \\in \\{0, \\dots, 7\\}$ is the lexicographical index), a deterministic sequence of states is generated by applying updates $F_{\\pi_t}$. The sequence of permutations $\\pi_t$ is determined by a pseudorandom number generator (PRNG) seeded with $s = 2025 + i$.\nThe algorithm for each initial state is:\n1. Initialize the PRNG with seed $s = 2025 + i$.\n2. Start with the initial state $x(0) = x_i$. Maintain a history of visited states and the step at which they first appeared, e.g., `history = {x(0): 0}`.\n3. For each macro-step $t = 0, 1, \\dots, T-1$ (where $T=30$):\n    a. Generate a permutation $\\pi_t$ of $\\{1,2,3\\}$ uniformly at random using the seeded PRNG.\n    b. Compute the next state $x(t+1) = F_{\\pi_t}(x(t))$.\n    c. If $x(t+1)$ has been seen before at step $k = \\text{history}[x(t+1)]$, a cycle of length $L = (t+1) - k$ is found. This length is recorded, and the process for this initial state terminates.\n    d. Otherwise, record the new state: `history[x(t+1)] = t+1`.\n4. If no cycle is found within $T=30$ steps, no length is recorded for this initial state.\n5. The final result for this regime is the sorted list of unique attractor lengths found across all $8$ initial states.\n\nThe implementation will follow these steps precisely to compute the required lists of attractor lengths. The comparison of results across regimes demonstrates the critical role of the update scheme in shaping the long-term behavior of the network, with asynchronous updates tending to eliminate the cycles present in the synchronous case.", "answer": "[[1, 2],[1],[1],[1]]", "id": "3292480"}, {"introduction": "Beyond predicting a network's natural behavior, a key goal in systems biology is to control it, for instance, to steer a diseased cell towards a healthy state. This advanced practice introduces the concept of network control through node pinning, where we fix the states of a few key nodes to guide the entire system to a desired target attractor. You will implement algorithms to find both an optimal, minimal control set and a heuristic set based on the network's Feedback Vertex Set (FVS), providing a hands-on introduction to the strategies used to identify therapeutic targets and engineer biological circuits. [@problem_id:3292470]", "problem": "You are given three finite, synchronous, deterministic Boolean networks used in computational systems biology. Each network consists of a finite set of nodes $V=\\{0,1,\\dots,n-1\\}$, a vector of node-update functions $F=(f_0,\\dots,f_{n-1})$ with $f_i:\\{0,1\\}^n\\to\\{0,1\\}$, and a designated target attractor $\\alpha^*\\in\\{0,1\\}^n$ which is a fixed point of the unpinned dynamics. The synchronous update is $x(t+1)=F\\big(x(t)\\big)$ with $x(0)\\in\\{0,1\\}^n$. A pinning control chooses a subset $S\\subseteq V$ and forces $x_i(t)=\\alpha^*_i$ for all $i\\in S$ and all $t\\ge 0$; all other nodes update by their $f_i$ using the current state $x(t)$ that includes the pinned values. We say that a control set $S$ is valid if for every initial state $x(0)\\in\\{0,1\\}^n$ the pinned dynamics converges to the target fixed point $\\alpha^*$ in finite time.\n\nFundamental base for this exercise:\n- A Boolean network is a directed graph on $V$ with edges $j\\to i$ whenever $f_i$ depends on $x_j$; the dynamics are given by $x_i(t+1)=f_i\\big(x(t)\\big)$.\n- A fixed point $\\alpha^*\\in\\{0,1\\}^n$ satisfies $\\alpha^*_i=f_i(\\alpha^*)$ for all $i\\in V$.\n- A feedback vertex set (FVS) is a subset $S\\subseteq V$ that intersects every directed cycle of the dependency graph. Pinning any FVS to target values eliminates all directed cycles and yields a directed acyclic graph; in a directed acyclic graph, synchronous updates propagate information forward, and after at most the length of the longest directed path, the state becomes uniquely determined by the pinned values, hence converges to the fixed point consistent with those pinned values.\n\nYour task is to compute, for each test network below:\n1. An optimal minimal-cardinality control set $S_{\\mathrm{opt}}$ such that pinning $x_S$ to $x_S^*=\\alpha^*_S$ drives the network to $\\alpha^*$ from all initial states. Among all sets of minimal cardinality, choose the lexicographically smallest one when nodes are ordered by their indices.\n2. A heuristic control set $S_{\\mathrm{heu}}$ produced by a greedy feedback vertex set algorithm that repeatedly detects a directed cycle via depth-first search (DFS) and removes the current node where the back-edge is discovered, until the remaining graph is acyclic. The DFS explores nodes and out-edges in increasing index order. The set $S_{\\mathrm{heu}}$ is then pinned to $\\alpha^*$.\n\nYou must verify the validity of a candidate control set $S$ by exhaustive simulation over all initial conditions $x(0)\\in\\{0,1\\}^n$ with synchronous updates under pinning, for a time horizon $T_{\\max}=2^n$, which is sufficient to detect convergence in a finite deterministic Boolean network. A candidate $S$ is valid if and only if every trajectory reaches $\\alpha^*$ within $T_{\\max}$ steps.\n\nFormulate the optimal control problem as an Integer Linear Program (ILP) based on the following principles, without using a solver in your program:\n- Introduce binary decision variables $y_i\\in\\{0,1\\}$ indicating whether node $i$ is pinned ($y_i=1$) or free ($y_i=0$), and, for each initial condition $s\\in\\{0,1\\}^n$ and time $t=0,\\dots,T$, introduce state variables $z_i^{(t,s)}\\in\\{0,1\\}$ that represent $x_i(t)$ along the trajectory initialized at $x(0)=s$. Choose $T$ large enough so that when cycles are eliminated (by the chosen $S$), $T$ bounds the longest directed path length; a safe choice is $T=n$ for a directed acyclic graph on $n$ nodes.\n- For each initial condition $s$, enforce $z_i^{(0,s)}=s_i$.\n- For each node $i$, time $t$ and initial condition $s$, enforce pinning and dynamics via big-$M$ constraints for binary variables:\n  - If $y_i=1$ then $z_i^{(t+1,s)}=\\alpha^*_i$, encoded by\n    $$z_i^{(t+1,s)}-\\alpha^*_i\\le 1-y_i,\\quad \\alpha^*_i-z_i^{(t+1,s)}\\le 1-y_i.$$\n  - If $y_i=0$ then $z_i^{(t+1,s)}=f_i\\big(z^{(t,s)}\\big)$, encoded by\n    $$z_i^{(t+1,s)}-f_i\\big(z^{(t,s)}\\big)\\le y_i,\\quad f_i\\big(z^{(t,s)}\\big)-z_i^{(t+1,s)}\\le y_i.$$\n- Linearize the Boolean functions using standard binary linear constraints:\n  - For $y=\\bigwedge_{j\\in P} x_j$: impose $y\\le x_j$ for all $j\\in P$ and $y\\ge \\sum_{j\\in P} x_j-|P|+1$.\n  - For $y=\\bigvee_{j\\in P} x_j$: impose $y\\ge x_j$ for all $j\\in P$ and $y\\le \\sum_{j\\in P} x_j$.\n  - For $y=\\neg x$: impose $y=1-x$.\n  - For $y=x$: impose $y=x$.\n- Enforce terminal constraints $z_i^{(T,s)}=\\alpha^*_i$ for all $i$ and all initial conditions $s$.\n- Minimize $\\sum_{i=0}^{n-1} y_i$.\n\nAlthough you shall not call an external solver, the optimal solution to the ILP above is exactly the minimal-cardinality valid control set. You will compute it by exhaustive enumeration of subsets $S$ and checking the validity constraint, which is equivalent for the given small test suite.\n\nTest suite specification. For each case, the network is given through explicit node-update formulas and a target fixed point. The dependency graph edge $j\\to i$ exists if and only if $f_i$ depends on $x_j$.\n\n- Case A: Three-node ring with copies. Nodes $V=\\{0,1,2\\}$, synchronous update\n  $$f_0(x)=x_2,\\quad f_1(x)=x_0,\\quad f_2(x)=x_1,$$\n  and target fixed point\n  $$\\alpha^*=(1,1,1).$$\n\n- Case B: Two three-cycles sharing one node. Nodes $V=\\{0,1,2,3,4\\}$, synchronous update\n  $$f_0(x)=x_2\\wedge x_4,\\quad f_1(x)=x_0,\\quad f_2(x)=x_1,\\quad f_3(x)=x_0,\\quad f_4(x)=x_3,$$\n  and target fixed point\n  $$\\alpha^*=(1,1,1,1,1).$$\n  The dependency graph has cycles $0\\to 1\\to 2\\to 0$ and $0\\to 3\\to 4\\to 0$.\n\n- Case C: Directed acyclic graph (no cycles). Nodes $V=\\{0,1,2,3\\}$, synchronous update\n  $$f_0(x)=1,\\quad f_1(x)=\\neg x_0,\\quad f_2(x)=x_0\\wedge x_1,\\quad f_3(x)=x_2,$$\n  and target fixed point\n  $$\\alpha^*=(1,0,0,0).$$\n\nAlgorithmic tasks to implement for each test case:\n- Compute $S_{\\mathrm{opt}}$ by exhaustive search over $S\\subseteq V$, increasing by $|S|$, and verifying validity by simulating all $2^n$ initial conditions under pinning for $T_{\\max}=2^n$ steps.\n- Compute $S_{\\mathrm{heu}}$ by the greedy FVS heuristic described above (DFS cycle detection removing the current node where a back-edge is discovered, exploring nodes and adjacency lists in increasing index order). Pin the nodes in $S_{\\mathrm{heu}}$ to $\\alpha^*$.\n- Verify validity of $S_{\\mathrm{heu}}$ by simulation as above.\n\nFinal output format:\n- Your program must produce a single line containing a list of results, one per test case, where each result is a list\n  $$\\big[|S_{\\mathrm{opt}}|,\\ |S_{\\mathrm{heu}}|,\\ \\text{is\\_equal},\\ S_{\\mathrm{opt}},\\ S_{\\mathrm{heu}}\\big],$$\n  with $|S_{\\mathrm{opt}}|$ and $|S_{\\mathrm{heu}}|$ as integers, $\\text{is\\_equal}$ a boolean indicating whether the sizes are equal, and $S_{\\mathrm{opt}}$ and $S_{\\mathrm{heu}}$ given as sorted lists of $0$-based node indices. The entire line must be printed exactly in a Python list literal format, for example\n  $$\\big[\\,[1,2,\\mathrm{False},[0],[1,3]]\\,\\big].$$\nThere are no physical units, angle units, or percentages in this task. All returned numbers are unitless integers or booleans, and lists of such.", "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of Boolean network modeling and control theory, a subfield of computational systems biology. The problem is well-posed, with all necessary data, functions, and objectives clearly and objectively defined. The computational tasks, while intensive, are feasible for the small network sizes specified in the test suite. The problem asks for the implementation of algorithms for finding optimal and heuristic control sets for Boolean networks, a standard and non-trivial task.\n\nThe solution proceeds by first representing each Boolean network, including its update functions and dependency graph. Then, two distinct algorithms are implemented to find the required control sets: one for the optimal control set ($S_{\\mathrm{opt}}$) and one for the heuristic control set ($S_{\\mathrm{heu}}$).\n\n### 1. Network Representation\nFor each test case, the network is defined by its number of nodes $n$, its vector of update functions $F=(f_0, \\dots, f_{n-1})$, its target fixed point $\\alpha^*$, and its dependency graph. The functions $f_i$ are implemented as Python functions that take a state vector (tuple of $0$s and $1$s) and return a binary value. The dependency graph, where an edge $j \\to i$ exists if $f_i$ depends on $x_j$, is pre-computed and stored as an adjacency list.\n\n### 2. Core Function: Validity Check\nA crucial component is the function to verify if a candidate control set $S$ is valid. A set $S$ is valid if, for all $2^n$ possible initial states, the network dynamics, under pinning of the nodes in $S$ to their corresponding values in $\\alpha^*$, converge to the target state $\\alpha^*$.\n\nThe verification proceeds as follows:\n- For each of the $2^n$ initial states $x(0) \\in \\{0, 1\\}^n$:\n  - Simulate the pinned network dynamics synchronously for a maximum of $T_{\\max} = 2^n$ steps. The state at step $t+1$ is computed from the state at step $t$ as:\n    $$\n    x_i(t+1) = \\begin{cases} \\alpha^*_i  \\text{if } i \\in S \\\\ f_i(x(t))  \\text{if } i \\notin S \\end{cases}\n    $$\n  - If the state $x(t)$ becomes equal to $\\alpha^*$ at any time $t \\le T_{\\max}$, the trajectory from this initial condition is successful.\n  - If any trajectory fails to reach $\\alpha^*$ within $T_{\\max}$ steps, the set $S$ is deemed invalid, and the process for this set terminates early.\n- If all $2^n$ trajectories converge to $\\alpha^*$, the set $S$ is valid.\n\nThe time horizon $T_{\\max}=2^n$ is a guaranteed upper bound for convergence in a finite deterministic system state space of size $2^n$.\n\n### 3. Optimal Control Set ($S_{\\mathrm{opt}}$)\nThe optimal control set $S_{\\mathrm{opt}}$ is the valid control set with the minimum possible number of nodes. Among all sets of this minimal size, we must select the one that is lexicographically smallest.\n\nThis is found via an exhaustive search:\n1. Iterate through possible set sizes $k$, starting from $k=0$ up to $n$.\n2. For each size $k$, generate all possible subsets $S \\subseteq V$ of cardinality $k$. The subsets are generated in lexicographical order of their elements.\n3. For each generated subset $S$, check its validity using the function described above.\n4. The first valid set found is guaranteed to be minimal in size (due to the loop on $k$) and lexicographically smallest among all sets of that minimal size (due to the ordered generation of subsets). This set is $S_{\\mathrm{opt}}$.\n\n### 4. Heuristic Control Set ($S_{\\mathrm{heu}}$)\nThe heuristic control set $S_{\\mathrm{heu}}$ is determined by applying a greedy algorithm to find a Feedback Vertex Set (FVS) of the network's dependency graph. An FVS is a set of nodes whose removal renders the graph acyclic. The specific algorithm is as follows:\n\n1. Initialize $S_{\\mathrm{heu}}$ as an empty set.\n2. Repeatedly search for a directed cycle in the current graph (the original graph minus nodes already in $S_{\\mathrm{heu}}$).\n3. The cycle detection is performed using a Depth-First Search (DFS). The DFS traversal prioritizes nodes with smaller indices first, and for each node, explores its outgoing edges in increasing order of the neighbor's index.\n4. When a back-edge is found (from a node `u` to an ancestor `v` in the DFS tree), a cycle is detected. The problem specifies that the \"current node where the back-edge is discovered\" (which is `u`) is added to $S_{\\mathrm{heu}}$.\n5. After adding a node to $S_{\\mathrm{heu}}$, the search for a cycle restarts from the beginning.\n6. This process continues until a full DFS traversal of the remaining graph reveals no more cycles.\n7. The resulting set $S_{\\mathrm{heu}}$ is the heuristic FVS. The nodes in this set are then pinned. The problem also requires verifying the validity of $S_{\\mathrm{heu}}$ using the same simulation-based method as for $S_{\\mathrm{opt}}$. Based on the theory provided in the problem description, any FVS is a valid control set for these types of dynamics, so this check serves primarily as a confirmation of the algorithm's correctness.\n\nFinally, for each test case, the sizes and contents of $S_{\\mathrm{opt}}$ and $S_{\\mathrm{heu}}$ are collected and formatted into the required output structure.", "answer": "[[1, 1, True, [0], [2]],[1, 2, False, [0], [2, 4]],[0, 0, True, [], []]]", "id": "3292470"}]}