{"hands_on_practices": [{"introduction": "To build a solid understanding of polar decomposition, we begin with a foundational exercise. This problem [@problem_id:2886394] examines a pure uniaxial stretch, the simplest form of deformation, allowing you to apply the core definitions of the right Cauchy-Green tensor ($\\mathbf{C}$), the right stretch tensor ($\\mathbf{U}$), and the rotation tensor ($\\mathbf{R}$) in a controlled setting. By working through this case, you will see directly how the decomposition isolates pure stretch and confirm that no rotation is involved.", "problem": "A homogeneous deformation is applied to a body so that the deformation gradient in a fixed orthonormal basis of the reference configuration is $\\mathbf{F}=\\operatorname{diag}(\\lambda,1,1)$ with $\\lambda0$. Starting only from the definitions of the right Cauchy–Green deformation tensor, the right polar decomposition of the deformation gradient, and the notion of principal stretches and principal directions as eigenpairs of the right stretch tensor, determine the following quantities:\n- the right Cauchy–Green deformation tensor $\\mathbf{C}$,\n- the unique symmetric positive-definite right stretch tensor $\\mathbf{U}$,\n- the proper orthogonal rotation $\\mathbf{R}$,\n- the principal stretches, and\n- the corresponding orthonormal principal directions in the reference configuration.\n\nReport your final result as a single composite expression consisting, in order, of $\\mathbf{C}$, $\\mathbf{U}$, $\\mathbf{R}$, the column vector of principal stretches, and the $3\\times 3$ matrix whose columns are the principal directions in the reference basis. No numerical evaluation or rounding is required. Angles, if any arise, must be in radians; however, your final result should contain no angles.", "solution": "The problem presents a valid, well-posed question within the established framework of continuum mechanics. We will proceed with its solution by rigorously applying the fundamental definitions as stipulated.\n\nThe deformation gradient tensor $\\mathbf{F}$ is provided in a fixed orthonormal basis $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$ of the reference configuration. Its matrix representation is:\n$$\n[F] = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nwhere $\\lambda  0$ is a scalar stretch ratio.\n\nFirst, we determine the right Cauchy–Green deformation tensor, $\\mathbf{C}$. By definition, $\\mathbf{C}$ is given by the product $\\mathbf{C} = \\mathbf{F}^T \\mathbf{F}$. Since the matrix representation of $\\mathbf{F}$ is diagonal, it is identical to its transpose, $[F]^T = [F]$. The calculation is elementary:\n$$\n[C] = [F]^T [F] = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\lambda^2  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThus, $\\mathbf{C} = \\lambda^2 \\mathbf{e}_1 \\otimes \\mathbf{e}_1 + \\mathbf{e}_2 \\otimes \\mathbf{e}_2 + \\mathbf{e}_3 \\otimes \\mathbf{e}_3$.\n\nNext, we address the right polar decomposition of the deformation gradient, $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$, where $\\mathbf{R}$ is a proper orthogonal tensor representing rotation and $\\mathbf{U}$ is the symmetric positive-definite right stretch tensor. From this decomposition, it follows that $\\mathbf{C} = \\mathbf{F}^T \\mathbf{F} = (\\mathbf{R}\\mathbf{U})^T (\\mathbf{R}\\mathbf{U}) = \\mathbf{U}^T \\mathbf{R}^T \\mathbf{R} \\mathbf{U}$. Since $\\mathbf{R}$ is orthogonal, $\\mathbf{R}^T\\mathbf{R} = \\mathbf{I}$, and since $\\mathbf{U}$ is symmetric, $\\mathbf{U}^T = \\mathbf{U}$. This simplifies to $\\mathbf{C} = \\mathbf{U}^2$. The right stretch tensor $\\mathbf{U}$ is therefore the unique positive-definite square root of $\\mathbf{C}$.\n\nGiven that $[C]$ is a diagonal matrix with positive entries ($\\lambda^2  0$, $1  0$), its principal square root is found by taking the square root of each diagonal element:\n$$\n[U] = \\sqrt{[C]} = \\begin{pmatrix} \\sqrt{\\lambda^2}  0  0 \\\\ 0  \\sqrt{1}  0 \\\\ 0  0  \\sqrt{1} \\end{pmatrix} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nWe used the fact that $\\lambda  0$ to write $\\sqrt{\\lambda^2} = \\lambda$. The tensor $\\mathbf{U}$ is symmetric. Its eigenvalues are $\\lambda$, $1$, and $1$. As $\\lambda0$, all eigenvalues are positive, confirming that $\\mathbf{U}$ is positive-definite. It is evident from inspection that $[U] = [F]$ in this specific case.\n\nWith $\\mathbf{U}$ determined, we find the rotation tensor $\\mathbf{R}$ from the decomposition $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$. Since $\\mathbf{U}$ is invertible (its determinant is $\\lambda  0$), we can write $\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}$. The inverse of the diagonal matrix $[U]$ is trivial to compute:\n$$\n[U]^{-1} = \\begin{pmatrix} 1/\\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nNow, we perform the matrix multiplication for $[R]$:\n$$\n[R] = [F] [U]^{-1} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1/\\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThis is the identity matrix, $[I]$. Thus, $\\mathbf{R} = \\mathbf{I}$. This result is physically logical: a pure stretch along a coordinate axis without any shear component involves no rotation. The tensor $\\mathbf{I}$ is indeed proper orthogonal, as $\\mathbf{I}^T\\mathbf{I} = \\mathbf{I}$ and $\\det(\\mathbf{I}) = 1$.\n\nFinally, we determine the principal stretches and their corresponding directions. By definition, these are the eigenvalues and normalized eigenvectors, respectively, of the right stretch tensor $\\mathbf{U}$. Since $[U]$ is a diagonal matrix, its eigenvalues are its diagonal entries. The principal stretches are therefore $\\lambda_1 = \\lambda$, $\\lambda_2 = 1$, and $\\lambda_3 = 1$.\n\nThe corresponding principal directions $\\mathbf{N}_i$ are found by solving the eigenvalue problem $(\\mathbf{U} - \\lambda_i \\mathbf{I})\\mathbf{N}_i = \\mathbf{0}$.\nFor $\\lambda_1 = \\lambda$:\nThe eigenvectors are the basis vectors of the null space of $(\\mathbf{U} - \\lambda\\mathbf{I})$.\n$$\n[U] - \\lambda[I] = \\begin{pmatrix} 0  0  0 \\\\ 0  1-\\lambda  0 \\\\ 0  0  1-\\lambda \\end{pmatrix}\n$$\nIf $\\lambda \\neq 1$, this matrix maps any vector $(N_1, N_2, N_3)^T$ to $(0, (1-\\lambda)N_2, (1-\\lambda)N_3)^T$. For this to be the zero vector, $N_2=0$ and $N_3=0$. $N_1$ is arbitrary. The normalized eigenvector is $\\mathbf{N}_1 = (1, 0, 0)^T$, which corresponds to the basis vector $\\mathbf{e}_1$.\n\nFor the repeated eigenvalue $\\lambda_2 = \\lambda_3 = 1$:\nThe eigenvectors are the basis vectors of the null space of $(\\mathbf{U} - 1 \\cdot \\mathbf{I})$.\n$$\n[U] - 1[I] = \\begin{pmatrix} \\lambda-1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nIf $\\lambda \\neq 1$, this matrix maps $(N_1, N_2, N_3)^T$ to $((\\lambda-1)N_1, 0, 0)^T$. For this to be the zero vector, $N_1=0$. $N_2$ and $N_3$ are arbitrary. This defines a two-dimensional eigenspace, the plane spanned by $\\mathbf{e}_2$ and $\\mathbf{e}_3$. Any vector in this plane is a principal direction with stretch $1$. We must choose an orthonormal basis for this space. The canonical choice is $\\mathbf{N}_2 = (0, 1, 0)^T = \\mathbf{e}_2$ and $\\mathbf{N}_3 = (0, 0, 1)^T = \\mathbf{e}_3$.\n\nIf $\\lambda=1$, then $\\mathbf{F}=\\mathbf{U}=\\mathbf{I}$ and $\\mathbf{C}=\\mathbf{I}$. This corresponds to no deformation. All stretches are $1$, and any direction is a principal direction. The choice of $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$ as the set of orthonormal principal directions remains valid.\n\nTherefore, the principal stretches are $\\{\\lambda, 1, 1\\}$, and a corresponding set of orthonormal principal directions in the reference configuration is $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$. The matrix whose columns are these directions is the identity matrix $\\mathbf{I}$.\n\nWe compile the results in the required order: $\\mathbf{C}$, $\\mathbf{U}$, $\\mathbf{R}$, the column vector of principal stretches, and the matrix of principal directions.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} \\lambda^{2}  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n\n\\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n\n\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n\n\\begin{pmatrix} \\lambda \\\\ 1 \\\\ 1 \\end{pmatrix}\n\n\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$", "id": "2886394"}, {"introduction": "Having mastered the basics, we now move to a more complex and common scenario in geomechanics: simple shear. This practice [@problem_id:3516613] requires you to analyze the finite strain that results from this deformation, revealing non-intuitive effects that are absent in infinitesimal strain theory. This exercise is crucial for understanding how polar decomposition helps disentangle the coupled effects of pure material straining and rigid body rotation that occur in shear flows.", "problem": "Consider a homogeneous simple shear of a rectangular soil specimen commonly used in computational geomechanics to model direct shear, defined by the deformation mapping from the reference configuration coordinates $\\{X_{1}, X_{2}, X_{3}\\}$ to the current configuration coordinates $\\{x_{1}, x_{2}, x_{3}\\}$:\n$$x_{1} = X_{1} + \\gamma X_{2}, \\quad x_{2} = X_{2}, \\quad x_{3} = X_{3},$$\nwhere $\\gamma \\geq 0$ is the imposed shear amplitude. Using only fundamental definitions from finite deformation kinematics, compute the deformation gradient tensor, the right Cauchy–Green deformation tensor, the left Cauchy–Green deformation tensor, and the Green–Lagrange strain tensor associated with this mapping. Based on the polar decomposition of the deformation gradient tensor, interpret the physical meaning of the nonzero strain components you obtained, clarifying the roles of rotation and stretch in the shear. Then, determine the principal values (eigenvalues) of the Green–Lagrange strain tensor and identify the maximum principal Green–Lagrange strain as a function of $\\gamma$. Express your final answer as a single closed-form analytic expression in terms of $\\gamma$. No rounding is required, and since strain is dimensionless, no units are needed in the final answer.", "solution": "The problem is valid as it is scientifically grounded in continuum mechanics, well-posed, objective, and contains all necessary information for a unique solution.\n\nThe deformation mapping is given by:\n$$x_{1} = X_{1} + \\gamma X_{2}$$\n$$x_{2} = X_{2}$$\n$$x_{3} = X_{3}$$\nwhere $\\{X_{1}, X_{2}, X_{3}\\}$ are coordinates in the reference configuration and $\\{x_{1}, x_{2}, x_{3}\\}$ are coordinates in the current configuration. The parameter $\\gamma \\ge 0$ represents the shear amplitude.\n\nFirst, we compute the deformation gradient tensor $\\mathbf{F}$, whose components are defined as $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$.\nThe components are:\n$F_{11} = \\frac{\\partial}{\\partial X_1}(X_{1} + \\gamma X_{2}) = 1$\n$F_{12} = \\frac{\\partial}{\\partial X_2}(X_{1} + \\gamma X_{2}) = \\gamma$\n$F_{13} = \\frac{\\partial}{\\partial X_3}(X_{1} + \\gamma X_{2}) = 0$\n$F_{21} = \\frac{\\partial}{\\partial X_1}(X_{2}) = 0$\n$F_{22} = \\frac{\\partial}{\\partial X_2}(X_{2}) = 1$\n$F_{23} = \\frac{\\partial}{\\partial X_3}(X_{2}) = 0$\n$F_{31} = \\frac{\\partial}{\\partial X_1}(X_{3}) = 0$\n$F_{32} = \\frac{\\partial}{\\partial X_2}(X_{3}) = 0$\n$F_{33} = \\frac{\\partial}{\\partial X_3}(X_{3}) = 1$\n\nIn matrix form, the deformation gradient tensor $\\mathbf{F}$ is:\n$$\n\\mathbf{F} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\nNext, we compute the right Cauchy–Green deformation tensor $\\mathbf{C}$, defined as $\\mathbf{C} = \\mathbf{F}^T \\mathbf{F}$.\n$$\n\\mathbf{C} = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\nThe left Cauchy–Green deformation tensor $\\mathbf{B}$ is defined as $\\mathbf{B} = \\mathbf{F} \\mathbf{F}^T$.\n$$\n\\mathbf{B} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\gamma^2 + 1  \\gamma  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\nThe Green–Lagrange strain tensor $\\mathbf{E}$ is defined as $\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})$, where $\\mathbf{I}$ is the identity tensor.\n$$\n\\mathbf{E} = \\frac{1}{2} \\left( \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  \\gamma^2  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\gamma}{2}  0 \\\\ \\frac{\\gamma}{2}  \\frac{\\gamma^2}{2}  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n\nFor the physical interpretation, we use the polar decomposition theorem, which states that any invertible deformation gradient $\\mathbf{F}$ can be uniquely decomposed into a rotation tensor $\\mathbf{R}$ and a symmetric positive-definite right stretch tensor $\\mathbf{U}$, such that $\\mathbf{F} = \\mathbf{R} \\mathbf{U}$. The tensor $\\mathbf{U}$ describes the pure deformation (stretching and shearing) of the material, while $\\mathbf{R}$ describes the rigid body rotation of the material element. The Green–Lagrange strain tensor $\\mathbf{E}$ is a measure of pure strain, as it is related to $\\mathbf{U}$ by $\\mathbf{E} = \\frac{1}{2}(\\mathbf{U}^2 - \\mathbf{I})$. For the given simple shear, $\\mathbf{F}$ is not symmetric for $\\gamma  0$, which implies that the rotation tensor $\\mathbf{R}$ is not the identity tensor, so the deformation includes a rotational component. The nonzero components of $\\mathbf{E}$ elucidate the nature of the pure strain:\n$E_{12} = \\frac{\\gamma}{2}$ represents the shear strain component, quantifying the change in angle between material lines originally parallel to the $X_1$ and $X_2$ axes.\n$E_{22} = \\frac{\\gamma^2}{2}$ is a normal strain component along the $X_2$ direction. This is a finite deformation effect (often called the Poynting effect), which demonstrates that simple shear is accompanied by elongation or contraction in certain directions. This term is of second order in $\\gamma$ and is negligible in linearized, infinitesimal strain theory. Thus, the polar decomposition reveals that simple shear is not a \"pure shear\" but a combination of pure deformation (itself a mix of shearing and extension, measured by $\\mathbf{E}$) and a rigid body rotation.\n\nTo find the principal values of the Green–Lagrange strain tensor $\\mathbf{E}$, we solve the eigenvalue problem $\\det(\\mathbf{E} - \\lambda \\mathbf{I}) = 0$. The deformation is planar, so we analyze the upper-left $2 \\times 2$ submatrix. The third principal strain is evidently $0$.\n$$\n\\det \\begin{pmatrix} 0 - \\lambda  \\frac{\\gamma}{2} \\\\ \\frac{\\gamma}{2}  \\frac{\\gamma^2}{2} - \\lambda \\end{pmatrix} = 0\n$$\nThis gives the characteristic equation:\n$$\n(-\\lambda)\\left(\\frac{\\gamma^2}{2} - \\lambda\\right) - \\left(\\frac{\\gamma}{2}\\right)^2 = 0\n$$\n$$\n\\lambda^2 - \\frac{\\gamma^2}{2}\\lambda - \\frac{\\gamma^2}{4} = 0\n$$\nSolving this quadratic equation for $\\lambda$:\n$$\n\\lambda = \\frac{-(-\\frac{\\gamma^2}{2}) \\pm \\sqrt{(-\\frac{\\gamma^2}{2})^2 - 4(1)(-\\frac{\\gamma^2}{4})}}{2(1)}\n$$\n$$\n\\lambda = \\frac{\\frac{\\gamma^2}{2} \\pm \\sqrt{\\frac{\\gamma^4}{4} + \\gamma^2}}{2} = \\frac{\\frac{\\gamma^2}{2} \\pm \\sqrt{\\gamma^2(\\frac{\\gamma^2}{4} + 1)}}{2}\n$$\nSince $\\gamma \\ge 0$, we have $\\sqrt{\\gamma^2} = \\gamma$.\n$$\n\\lambda = \\frac{\\frac{\\gamma^2}{2} \\pm \\gamma \\sqrt{\\frac{\\gamma^2+4}{4}}}{2} = \\frac{\\frac{\\gamma^2}{2} \\pm \\frac{\\gamma}{2}\\sqrt{\\gamma^2+4}}{2}\n$$\n$$\n\\lambda = \\frac{\\gamma^2 \\pm \\gamma\\sqrt{\\gamma^2+4}}{4}\n$$\nThe three principal Green–Lagrange strains are:\n$$\n\\lambda_1 = \\frac{\\gamma^2 + \\gamma\\sqrt{\\gamma^2+4}}{4}\n$$\n$$\n\\lambda_2 = \\frac{\\gamma^2 - \\gamma\\sqrt{\\gamma^2+4}}{4}\n$$\n$$\n\\lambda_3 = 0\n$$\nTo find the maximum principal strain, we compare these values. Since $\\gamma \\ge 0$, the term $\\gamma\\sqrt{\\gamma^2+4}$ is non-negative.\nTherefore, $\\lambda_1 \\ge \\lambda_2$.\nAlso, for $\\gamma  0$, we have $\\gamma^2  \\gamma\\sqrt{\\gamma^2+4}$ because $\\gamma^4  \\gamma^2(\\gamma^2+4) = \\gamma^4 + 4\\gamma^2$. This means $\\lambda_2  0$.\nClearly, $\\lambda_1  0$ for $\\gamma  0$.\nTherefore, the maximum principal Green–Lagrange strain is $\\lambda_1$.\n\n$$\nE_{\\text{max}} = \\frac{\\gamma^2 + \\gamma\\sqrt{\\gamma^2+4}}{4}\n$$", "answer": "$$\n\\boxed{\\frac{\\gamma^2 + \\gamma\\sqrt{\\gamma^2+4}}{4}}\n$$", "id": "3516613"}, {"introduction": "The final practice bridges the gap between analytical theory and the practical demands of computational implementation. This task [@problem_id:3516660] challenges you to design a robust algorithm for computing the polar decomposition, a cornerstone of many finite-element codes. You will develop a primary method based on spectral decomposition and a crucial fallback using Singular Value Decomposition (SVD) to handle the ill-conditioned and near-singular cases that inevitably arise in real simulations.", "problem": "You are given the task of designing and implementing a robust computational algorithm to compute the polar decomposition of a three-dimensional deformation gradient tensor. In computational geomechanics, the deformation gradient tensor $\\mathbf{F}$ is defined as $\\mathbf{F} = \\partial \\mathbf{x} / \\partial \\mathbf{X}$, where $\\mathbf{x}$ denotes the spatial coordinates and $\\mathbf{X}$ denotes the reference coordinates. The Jacobian determinant is $J = \\det(\\mathbf{F})$. The right Cauchy–Green deformation tensor is $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$. The right polar decomposition expresses $\\mathbf{F}$ as $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$, where $\\mathbf{R}$ is orthogonal (i.e., $\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$) and $\\mathbf{U}$ is symmetric positive-definite.\n\nStarting from these fundamental definitions, you must derive a principle-based algorithm that:\n- Computes the right polar decomposition $(\\mathbf{R}, \\mathbf{U})$ for a given $3 \\times 3$ matrix $\\mathbf{F}$.\n- Includes conditioning checks based on the Jacobian determinant $J$ and the singular value conditioning of $\\mathbf{F}$ in order to decide whether to use a primary spectral method (via the spectral properties of $\\mathbf{C}$) or to fall back to Singular Value Decomposition (SVD).\n- Ensures numerical robustness by symmetrizing $\\mathbf{U}$ when necessary and by avoiding division by near-zero quantities.\n- Verifies the computed factors by quantifying:\n  1. The reconstruction residual $\\|\\mathbf{F} - \\mathbf{R}\\mathbf{U}\\|_F$,\n  2. The orthogonality defect $\\|\\mathbf{R}^\\mathsf{T}\\mathbf{R} - \\mathbf{I}\\|_F$,\n  3. The symmetry defect $\\|\\mathbf{U} - \\mathbf{U}^\\mathsf{T}\\|_F$,\n  4. The minimum eigenvalue of the symmetrized $\\mathbf{U}$,\n  5. The determinant $\\det(\\mathbf{R})$,\n  6. Whether the fallback to SVD was used (boolean).\n\nThe angle unit in all constructions is radians. No physical units are required for this problem, and all quantities are dimensionless.\n\nPrimary algorithm requirement:\n- For well-conditioned cases, use the spectral properties of $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$ to construct the symmetric positive-definite right stretch $\\mathbf{U}$ and then obtain $\\mathbf{R}$ accordingly. Do not use any shortcut formulas; derive from the properties implicit in the definitions.\n\nFallback requirement:\n- When the Jacobian determinant $J$ is near zero or the condition number of $\\mathbf{F}$ (based on the ratio of its largest to smallest singular values) is large, fall back to Singular Value Decomposition to compute the polar decomposition. The SVD decomposition for a real matrix is $\\mathbf{F} = \\mathbf{U}_s \\mathbf{\\Sigma} \\mathbf{V}^\\mathsf{T}$, where $\\mathbf{U}_s$ and $\\mathbf{V}$ are orthogonal and $\\mathbf{\\Sigma}$ is diagonal with nonnegative entries.\n\nConditioning thresholds:\n- Use the thresholds $|J|  \\tau_J$, where $\\tau_J = 1 \\times 10^{-7}$, and a condition-number threshold $\\kappa(\\mathbf{F})  \\tau_\\kappa$, where $\\tau_\\kappa = 1 \\times 10^{12}$. Also, if the minimum principal value used in the primary method would cause division by a quantity smaller than $\\tau_\\sigma = 1 \\times 10^{-7}$, you must use the fallback to SVD.\n\nTest suite:\n- Construct the following five test cases for $\\mathbf{F}$, using rotations built from axis-angle data (Rodrigues’ representation) and diagonal right-stretch tensors. All angles are in radians.\n  1. Case A (well-conditioned “happy path”): axis $\\mathbf{a} = [0, 0, 1]$, angle $\\theta = 0.5$, right-stretch diagonal $\\operatorname{diag}([1.2, 0.9, 1.1])$. Define $\\mathbf{F} = \\mathbf{R}(\\mathbf{a}, \\theta)\\operatorname{diag}([1.2, 0.9, 1.1])$.\n  2. Case B (near-singular $J$): axis $\\mathbf{a} = [1, 0, 0]$, angle $\\theta = 0.4$, right-stretch diagonal $\\operatorname{diag}([1 \\times 10^{-8}, 1.0, 1.0])$. Define $\\mathbf{F} = \\mathbf{R}(\\mathbf{a}, \\theta)\\operatorname{diag}([1 \\times 10^{-8}, 1.0, 1.0])$.\n  3. Case C (orientation-reversing orthogonal factor): axis $\\mathbf{a} = [0, 1, 0]$, angle $\\theta = 0.6$, right-stretch diagonal $\\operatorname{diag}([1.3, 0.7, 1.0])$, and apply a reflection to the orthogonal part by composing with $\\operatorname{diag}([-1, 1, 1])$. Define $\\mathbf{F} = \\left(\\mathbf{R}(\\mathbf{a}, \\theta)\\operatorname{diag}([-1, 1, 1])\\right)\\operatorname{diag}([1.3, 0.7, 1.0])$.\n  4. Case D (pure symmetric positive-definite input): angle $\\theta = 0.0$ with any axis (e.g., $\\mathbf{a} = [0, 0, 1]$), right-stretch diagonal $\\operatorname{diag}([2.0, 0.5, 1.5])$. Define $\\mathbf{F} = \\mathbf{I}\\operatorname{diag}([2.0, 0.5, 1.5]) = \\operatorname{diag}([2.0, 0.5, 1.5])$.\n  5. Case E (extremely ill-conditioned): axis $\\mathbf{a} = [1, 1, 0]$, angle $\\theta = 0.3$, right-stretch diagonal $\\operatorname{diag}([1 \\times 10^{-12}, 1.0, 1 \\times 10^{8}])$. Define $\\mathbf{F} = \\mathbf{R}(\\mathbf{a}, \\theta)\\operatorname{diag}([1 \\times 10^{-12}, 1.0, 1 \\times 10^{8}])$.\n\nOutput specification:\n- For each test case, compute and return the list $[\\|\\mathbf{F} - \\mathbf{R}\\mathbf{U}\\|_F, \\|\\mathbf{R}^\\mathsf{T}\\mathbf{R} - \\mathbf{I}\\|_F, \\|\\mathbf{U} - \\mathbf{U}^\\mathsf{T}\\|_F, \\lambda_{\\min}((\\mathbf{U} + \\mathbf{U}^\\mathsf{T})/2), \\det(\\mathbf{R}), \\text{fallback\\_used}]$, where $\\lambda_{\\min}(\\cdot)$ denotes the minimum eigenvalue of the indicated symmetric tensor and $\\text{fallback\\_used}$ is a boolean indicating whether the SVD fallback was triggered. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3},\\text{result4},\\text{result5}]$), where each $\\text{result}$ is itself the list described above for one test case.", "solution": "The problem requires the design and implementation of a robust algorithm for the right polar decomposition of a $3 \\times 3$ deformation gradient tensor $\\mathbf{F}$. The decomposition is given by $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$, where $\\mathbf{R}$ is an orthogonal tensor ($\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$) and $\\mathbf{U}$ is a symmetric positive-definite tensor, known as the right stretch tensor. The algorithm must be derived from fundamental principles and incorporate conditioning checks to switch between a primary spectral method and a more robust fallback method based on Singular Value Decomposition (SVD).\n\nFirst, we establish the theoretical foundation for the spectral method. From the polar decomposition $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ and the properties of $\\mathbf{R}$ and $\\mathbf{U}$ ($\\mathbf{R}^\\mathsf{T} = \\mathbf{R}^{-1}$, $\\mathbf{U}^\\mathsf{T} = \\mathbf{U}$), we can express the right Cauchy-Green deformation tensor $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$ as follows:\n$$\n\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F} = (\\mathbf{R}\\mathbf{U})^\\mathsf{T}(\\mathbf{R}\\mathbf{U}) = \\mathbf{U}^\\mathsf{T}\\mathbf{R}^\\mathsf{T}\\mathbf{R}\\mathbf{U} = \\mathbf{U}(\\mathbf{R}^\\mathsf{T}\\mathbf{R})\\mathbf{U} = \\mathbf{U}\\mathbf{I}\\mathbf{U} = \\mathbf{U}^2\n$$\nThis fundamental relationship, $\\mathbf{C} = \\mathbf{U}^2$, indicates that the right stretch tensor $\\mathbf{U}$ is the principal square root of the right Cauchy-Green tensor $\\mathbf{C}$. Since $\\mathbf{F}$ is a real tensor, $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$ is symmetric and positive semi-definite. If $\\mathbf{F}$ is invertible (i.e., $\\det(\\mathbf{F}) \\neq 0$), then $\\mathbf{C}$ is positive-definite.\n\nThe primary algorithm, applicable to well-conditioned tensors $\\mathbf{F}$, leverages the spectral decomposition of $\\mathbf{C}$:\n1.  Compute the right Cauchy-Green tensor $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$. To ensure numerical symmetry, it is prudent to compute it as $\\mathbf{C} = \\frac{1}{2}((\\mathbf{F}^\\mathsf{T}\\mathbf{F}) + (\\mathbf{F}^\\mathsf{T}\\mathbf{F})^\\mathsf{T})$.\n2.  Since $\\mathbf{C}$ is symmetric, it admits a spectral decomposition $\\mathbf{C} = \\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^\\mathsf{T}$, where $\\mathbf{Q}$ is an orthogonal matrix whose columns are the eigenvectors of $\\mathbf{C}$, and $\\mathbf{\\Lambda}$ is a diagonal matrix containing the corresponding non-negative eigenvalues $\\lambda_i$.\n3.  The stretch tensor $\\mathbf{U} = \\mathbf{C}^{1/2}$ can then be constructed as $\\mathbf{U} = \\mathbf{Q}\\mathbf{\\Lambda}^{1/2}\\mathbf{Q}^\\mathsf{T}$, where $\\mathbf{\\Lambda}^{1/2} = \\operatorname{diag}(\\sqrt{\\lambda_1}, \\sqrt{\\lambda_2}, \\sqrt{\\lambda_3})$. This construction guarantees that $\\mathbf{U}$ is symmetric and, for a positive-definite $\\mathbf{C}$, positive-definite.\n4.  Once $\\mathbf{U}$ is known, the rotation tensor $\\mathbf{R}$ is found by inverting $\\mathbf{U}$ in the original decomposition: $\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}$. The inverse $\\mathbf{U}^{-1}$ is computed via the spectral decomposition as $\\mathbf{U}^{-1} = \\mathbf{Q}\\mathbf{\\Lambda}^{-1/2}\\mathbf{Q}^\\mathsf{T}$, where $\\mathbf{\\Lambda}^{-1/2} = \\operatorname{diag}(1/\\sqrt{\\lambda_1}, 1/\\sqrt{\\lambda_2}, 1/\\sqrt{\\lambda_3})$. This step is numerically sensitive if any eigenvalue $\\lambda_i$ is close to zero.\n\nFor ill-conditioned or singular tensors $\\mathbf{F}$, a more stable fallback method using Singular Value Decomposition (SVD) is required. The SVD of $\\mathbf{F}$ is given by $\\mathbf{F} = \\mathbf{U}_s\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T}$, where $\\mathbf{U}_s$ and $\\mathbf{V}$ are orthogonal matrices and $\\mathbf{\\Sigma}$ is a diagonal matrix of non-negative singular values $\\sigma_i$. We can rearrange this to match the polar decomposition form $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$:\n$$\n\\mathbf{F} = (\\mathbf{U}_s\\mathbf{V}^\\mathsf{T})(\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T})\n$$\nWe identify the factors as:\n-   $\\mathbf{R} = \\mathbf{U}_s\\mathbf{V}^\\mathsf{T}$. This is a product of two orthogonal matrices, which is itself orthogonal.\n-   $\\mathbf{U} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T}$. This tensor is symmetric by construction ($\\mathbf{U}^\\mathsf{T} = (\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T})^\\mathsf{T} = \\mathbf{V}\\mathbf{\\Sigma}^\\mathsf{T}\\mathbf{V}^\\mathsf{T} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T} = \\mathbf{U}$). Its eigenvalues are the singular values $\\sigma_i$ of $\\mathbf{F}$, which are non-negative, so $\\mathbf{U}$ is positive semi-definite. This method avoids matrix inversion, making it robust.\n\nThe decision to use the fallback SVD method is based on three conditions:\n1.  The Jacobian determinant $J = \\det(\\mathbf{F})$ is near-zero: $|J|  \\tau_J = 1 \\times 10^{-7}$. This indicates that $\\mathbf{F}$ is singular or nearly so.\n2.  The condition number of $\\mathbf{F}$, $\\kappa(\\mathbf{F}) = \\sigma_{\\max}/\\sigma_{\\min}$, is excessively large: $\\kappa(\\mathbf{F})  \\tau_\\kappa = 1 \\times 10^{12}$. This signals extreme sensitivity to numerical errors. The singular values $\\sigma_i$ are the square roots of the eigenvalues of $\\mathbf{C}$.\n3.  The spectral method would involve division by a small number. This occurs if any principal stretch, $\\sigma_i = \\sqrt{\\lambda_i}$, is smaller than a tolerance $\\tau_\\sigma = 1 \\times 10^{-7}$.\n\nTo construct the test cases, rotation matrices $\\mathbf{R}$ are generated from an axis-angle representation $(\\mathbf{a}, \\theta)$ using Rodrigues' formula: $\\mathbf{R} = \\mathbf{I} + \\sin(\\theta)[\\mathbf{a}]_\\times + (1-\\cos(\\theta))[\\mathbf{a}]_\\times^2$, where $[\\mathbf{a}]_\\times$ is the skew-symmetric cross-product matrix of the unit axis vector $\\mathbf{a}$.\n\nFinally, the computed factors $(\\mathbf{R}, \\mathbf{U})$ are verified by calculating a set of six metrics:\n1.  Reconstruction residual: $\\|\\mathbf{F} - \\mathbf{R}\\mathbf{U}\\|_F$, measuring the accuracy of the decomposition.\n2.  Orthogonality defect: $\\|\\mathbf{R}^\\mathsf{T}\\mathbf{R} - \\mathbf{I}\\|_F$, measuring how close $\\mathbf{R}$ is to being perfectly orthogonal.\n3.  Symmetry defect: $\\|\\mathbf{U} - \\mathbf{U}^\\mathsf{T}\\|_F$, measuring the numerical asymmetry of the computed stretch tensor $\\mathbf{U}$.\n4.  Minimum eigenvalue of symmetrized $\\mathbf{U}$: $\\lambda_{\\min}((\\mathbf{U} + \\mathbf{U}^\\mathsf{T})/2)$, checking for the positive-definiteness of $\\mathbf{U}$.\n5.  Determinant of $\\mathbf{R}$: $\\det(\\mathbf{R})$, which should be $\\pm 1$. A value of $+1$ indicates a proper rotation, while $-1$ indicates an orientation-reversing transformation (a rotation plus a reflection).\n6.  Fallback flag: a boolean indicating whether the SVD fallback was triggered.", "answer": "[[2.285871110750438e-16, 2.220446049250313e-16, 0.0, 0.9, 1.0, False], [1.3322676295501878e-16, 1.1102230246251565e-16, 1.1102230246251565e-16, 1e-08, 1.0, True], [2.8251213454316226e-16, 4.440892098500626e-16, 0.0, 0.7, -1.0, False], [0.0, 0.0, 0.0, 0.5, 1.0, False], [1.221516945348852e-15, 0.0, 0.0, 1e-12, 1.0, True]]", "id": "3516660"}]}