{"hands_on_practices": [{"introduction": "Understanding the behavior of a rock joint often begins with its response to normal compression. This practice focuses on deriving the widely used hyperbolic normal closure law from its fundamental mechanical properties: the initial stiffness and the maximum possible closure. By recasting this relationship into a universal, dimensionless form, you will develop essential skills in mathematical modeling and dimensional analysis, techniques that are crucial for generalizing experimental data and simplifying complex problems for computational analysis.", "problem": "A rough rock joint subjected to monotonic normal compression is modeled using the hyperbolic form of the Barton–Bandis normal closure law. Let the normal closure be denoted by $u_{n}$ and the corresponding normal stress by $\\sigma_{n}$. The initial tangent normal stiffness at vanishing closure is $k_{n0}$, and the asymptotic maximum achievable closure under compression is $u_{\\max}$. Assume that the hyperbolic normal closure relation is such that the initial tangent stiffness satisfies $\\left.\\frac{d \\sigma_{n}}{d u_{n}}\\right|_{u_{n}=0}=k_{n0}$ and that the law asymptotically approaches a finite closure $u_{\\max}$ as $\\sigma_{n} \\to \\infty$.\n\nUsing only the two characteristic scales $u_{\\max}$ for closure and $k_{n0} u_{\\max}$ for stress, nondimensionalize the hyperbolic normal closure law by introducing a dimensionless closure $\\hat{u}$ and a dimensionless stress $\\hat{\\sigma}$. Rewrite the constitutive relation in fully nondimensional form and identify the key dimensionless groups governing the normal response. Express your final dimensionless constitutive relation as a single closed-form analytic expression. No numerical approximation or rounding is required, and no physical units should be included in the final expression.", "solution": "### Problem Validation\n\nThe problem is scientifically sound, well-posed, and objective. It describes a standard procedure in continuum mechanics and geomechanics: deriving a specific constitutive law from its fundamental properties and then rendering it in dimensionless form. The Barton–Bandis model is a cornerstone of rock joint mechanics, and the hyperbolic formulation described is a common representation. The provided conditions (initial stiffness and asymptotic behavior) are sufficient to uniquely determine the mathematical form of the law. The problem is self-contained and free of contradictions. The problem is valid and a full solution will be provided.\n\n### Solution Derivation\n\nThe primary task is to derive the specific form of the dimensional hyperbolic constitutive law from its stated properties and subsequently to nondimensionalize it using the provided characteristic scales.\n\n**1. Establish the Dimensional Constitutive Law**\n\nWe seek a hyperbolic function $\\sigma_{n}(u_{n})$ that satisfies the given conditions. A general hyperbolic function that passes through the origin ($\\sigma_n=0$ at $u_n=0$) and has a vertical asymptote at $u_{n} = u_{\\max}$ can be written as:\n$$ \\sigma_{n} = \\frac{A u_{n}}{u_{\\max} - u_{n}} $$\nwhere $A$ is a constant to be determined. This form correctly captures the asymptotic condition that $\\sigma_{n} \\to \\infty$ as $u_{n} \\to u_{\\max}$.\n\nNext, we use the condition on the initial tangent normal stiffness, $k_{n0}$. The stiffness is the derivative of the stress with respect to the closure:\n$$ \\frac{d\\sigma_{n}}{du_{n}} = \\frac{d}{du_{n}} \\left( \\frac{A u_{n}}{u_{\\max} - u_{n}} \\right) $$\nApplying the quotient rule for differentiation, we obtain:\n$$ \\frac{d\\sigma_{n}}{du_{n}} = \\frac{A(u_{\\max} - u_{n}) - A u_{n} (-1)}{(u_{\\max} - u_{n})^{2}} = \\frac{A u_{\\max}}{(u_{\\max} - u_{n})^{2}} $$\nThe initial tangent stiffness is this derivative evaluated at $u_{n}=0$:\n$$ k_{n0} = \\left.\\frac{d\\sigma_{n}}{du_{n}}\\right|_{u_{n}=0} = \\frac{A u_{\\max}}{(u_{\\max} - 0)^{2}} = \\frac{A}{u_{\\max}} $$\nSolving for the constant $A$, we find:\n$$ A = k_{n0} u_{\\max} $$\nSubstituting this back into the hyperbolic function gives the complete dimensional constitutive law:\n$$ \\sigma_{n} = \\frac{k_{n0} u_{\\max} u_{n}}{u_{\\max} - u_{n}} $$\n\n**2. Nondimensionalize the Law**\n\nWe introduce the dimensionless variables as defined by the problem's characteristic scales:\n- Dimensionless closure: $\\hat{u} = \\frac{u_{n}}{u_{\\max}}$\n- Dimensionless stress: $\\hat{\\sigma} = \\frac{\\sigma_{n}}{k_{n0} u_{\\max}}$\n\nWe express the dimensional variables in terms of their dimensionless counterparts:\n- $u_{n} = \\hat{u} u_{\\max}$\n- $\\sigma_{n} = \\hat{\\sigma} k_{n0} u_{\\max}$\n\nSubstitute these expressions into the dimensional constitutive equation:\n$$ \\hat{\\sigma} k_{n0} u_{\\max} = \\frac{k_{n0} u_{\\max} (\\hat{u} u_{\\max})}{u_{\\max} - (\\hat{u} u_{\\max})} $$\nAssuming $k_{n0} \\neq 0$ and $u_{\\max} \\neq 0$ for a physically meaningful problem, we can divide both sides by $k_{n0} u_{\\max}$:\n$$ \\hat{\\sigma} = \\frac{\\hat{u} u_{\\max}}{u_{\\max} - \\hat{u} u_{\\max}} $$\nFactor out $u_{\\max}$ from the denominator on the right-hand side:\n$$ \\hat{\\sigma} = \\frac{\\hat{u} u_{\\max}}{u_{\\max}(1 - \\hat{u})} $$\nCanceling the $u_{\\max}$ term from the numerator and denominator yields the final dimensionless constitutive relation:\n$$ \\hat{\\sigma} = \\frac{\\hat{u}}{1 - \\hat{u}} $$\nThis is the required closed-form analytic expression. The key dimensionless groups are the normalized stress $\\hat{\\sigma}$ and the normalized closure $\\hat{u}$.", "answer": "$$\n\\boxed{\\hat{\\sigma} = \\frac{\\hat{u}}{1 - \\hat{u}}}\n$$", "id": "3537115"}, {"introduction": "After characterizing the normal response, the next critical step is to model the joint's shear strength. This exercise delves into the influential Barton-Bandis shear strength criterion, which masterfully captures the interplay between residual friction and surface roughness. Through this derivation, you will gain a deeper appreciation for how parameters like the Joint Roughness Coefficient ($JRC$) and Joint Wall Compressive Strength ($JCS$) define the non-linear strength envelope that governs the onset of slip.", "problem": "A rock joint in a numerical model is represented by a frictional interface whose shear resistance increases with contact roughness at low normal stress and approaches a residual friction response at high normal stress. Let the shear stress be denoted by $\\tau$ and the applied effective normal stress by $\\sigma_{n}$. The Joint Wall Compressive Strength (JCS) is a material strength scale for the joint surfaces, and the Joint Roughness Coefficient (JRC) is a dimensionless descriptor of surface roughness calibrated so that its contribution to the apparent friction angle enters additively, in $\\text{radians}$, through a base-$10$ logarithm of a stress ratio constructed from $JCS$ and $\\sigma_{n}$. The residual friction angle is $\\phi_{r}$, measured in $\\text{radians}$. Starting from the fundamental frictional form in which shear strength scales with normal stress and the tangent of a mobilized friction angle, introduce an appropriate nondimensionalization using $JCS$ as the stress scale. Derive a closed-form expression for the dimensionless shear strength $\\tau/JCS$ in terms of the dimensionless ratio $\\sigma_{n}/JCS$, the residual friction angle $\\phi_{r}$, and the roughness term $JRC \\log_{10}(JCS/\\sigma_{n})$. Express any angles in $\\text{radians}$. Provide the final analytic expression for $\\tau/JCS$; no numerical evaluation is required.", "solution": "### Problem Validation\n\nThe problem is scientifically grounded, well-posed, objective, and complete. It accurately describes the formulation of the Barton-Bandis shear strength criterion, a standard empirical model in rock mechanics. All necessary parameters and relationships are provided to derive a unique analytical expression. The problem is deemed valid and the solution will be derived.\n\n### Solution Derivation\n\nThe derivation proceeds by systematically assembling the components described in the problem statement.\n\n**1. Formulate the Mobilized Friction Angle**\n\nThe fundamental relationship for shear strength is given as a Mohr-Coulomb type law where shear stress $\\tau$ is proportional to the normal stress $\\sigma_{n}$ and the tangent of a mobilized friction angle, $\\phi_{mob}$:\n$$\n\\tau = \\sigma_{n} \\tan(\\phi_{mob})\n$$\nThe problem states that the mobilized friction angle, $\\phi_{mob}$, is the sum of the residual friction angle, $\\phi_{r}$, and a contribution from joint roughness. This roughness term is explicitly given as $JRC \\log_{10}(JCS/\\sigma_{n})$. Therefore, the expression for the mobilized friction angle is:\n$$\n\\phi_{mob} = \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right)\n$$\nAll angles in this expression are specified to be in radians.\n\n**2. Construct the Dimensional Shear Strength Equation**\n\nSubstituting the expression for $\\phi_{mob}$ into the shear strength equation yields the full dimensional expression for the shear strength according to the Barton-Bandis model:\n$$\n\\tau = \\sigma_{n} \\tan\\left( \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right) \\right)\n$$\n\n**3. Nondimensionalize the Equation**\n\nThe final requirement is to express the shear strength in a dimensionless form by normalizing all stress quantities with respect to the Joint Wall Compressive Strength, $JCS$. To achieve this, we divide both sides of the equation by $JCS$:\n$$\n\\frac{\\tau}{JCS} = \\frac{\\sigma_{n}}{JCS} \\tan\\left( \\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right) \\right)\n$$\nThis equation represents the dimensionless shear strength, $\\tau/JCS$, as a function of the dimensionless normal stress, $\\sigma_{n}/JCS$, and the model parameters, as requested. This is the final closed-form expression.", "answer": "$$\n\\boxed{\\frac{\\tau}{JCS} = \\frac{\\sigma_{n}}{JCS} \\tan\\left(\\phi_{r} + JRC \\log_{10}\\left(\\frac{JCS}{\\sigma_{n}}\\right)\\right)}\n$$", "id": "3537020"}, {"introduction": "The ultimate test of a constitutive model lies in its successful implementation within a numerical solver. This advanced practice bridges the gap between theory and code by tasking you with deriving the consistent tangent stiffness for a regularized Barton-Bandis model. This is a crucial step for achieving the quadratic convergence of Newton-Raphson schemes used in modern geomechanical software, and this exercise will provide invaluable hands-on experience in preparing complex material laws for computational analysis.", "problem": "Consider a zero-thickness interface element representing a rock joint modeled with the Barton-Bandis (BB) joint constitutive law under mixed-mode normal-shear loading. Let the interface relative displacement vector be $\\boldsymbol{\\delta} = (\\delta_n, \\delta_s)$, where $\\delta_n$ is the normal closure (positive in compression, negative in opening) and $\\delta_s$ is the shear slip (positive along the local tangential direction). Let the corresponding traction vector be $\\mathbf{t} = (t_n, t_s)$, where $t_n$ is the normal traction and $t_s$ is the shear traction (both expressed as stress). You will derive and implement the consistent tangent components $\\partial t_n / \\partial \\delta_n$ and $\\partial t_s / \\partial \\delta_s$ required for quadratic convergence in a Newton-Raphson scheme for solving the nonlinear interface equilibrium.\n\nUse the following scientifically accepted constitutive ingredients as the foundational base:\n\n- Normal stress-closure relation inspired by the Barton-Bandis hyperbolic law: for $\\delta_n \\le 0$ (opening), the joint carries no compressive normal traction, i.e., $t_n = 0$. For $\\delta_n > 0$ (compression), the normal traction is given by\n$$\nt_n(\\delta_n) = \\frac{k_{n0}\\,\\delta_n}{1 + \\delta_n / \\delta_m},\n$$\nwhere $k_{n0}$ is the initial normal stiffness and $\\delta_m$ is a characteristic closure scale. This produces a physically realistic nonlinearly softening tangent stiffness and an asymptotic saturation of normal traction for large closures.\n\n- Shear traction evolution regularized to be smooth while anchored to the Barton peak shear strength envelope. The peak shear strength $\\tau_p(\\sigma_n)$ as a function of the effective normal stress $\\sigma_n$ is given by\n$$\n\\tau_p(\\sigma_n) = \n\\begin{cases}\n\\sigma_n \\,\\tan\\!\\left(\\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\dfrac{\\mathrm{JCS}}{\\sigma_n}\\right)\\right), & \\sigma_n > 0, \\\\\n0, & \\sigma_n \\le 0,\n\\end{cases}\n$$\nwhere $\\phi_r$ is the residual friction angle, $\\mathrm{JRC}$ is the Joint Roughness Coefficient, and $\\mathrm{JCS}$ is the Joint Wall Compressive Strength. Angles in $\\tan(\\cdot)$ must be supplied in radians. The shear traction is regularized by a smooth slip function\n$$\nt_s(\\delta_s, \\sigma_n) = \\tau_p(\\sigma_n)\\,\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\nwhere $d_s$ is a characteristic slip length that controls the transition from initial elastic-like response to the asymptotic frictional strength. This regularization ensures differentiability of $t_s$ with respect to $\\delta_s$ and enables consistent tangents for a Newton-Raphson scheme. In mixed-mode, use $\\sigma_n = t_n(\\delta_n)$.\n\nTask:\n1. Starting strictly from the above base, derive explicit expressions for the consistent tangent components $\\partial t_n / \\partial \\delta_n$ and $\\partial t_s / \\partial \\delta_s$ appropriate for a Newton-Raphson scheme under mixed-mode loading. In the derivation, clearly state any piecewise conditions required for physical realism, and consistently treat $\\partial t_s / \\partial \\delta_s$ as the partial derivative with respect to $\\delta_s$ at fixed $\\delta_n$.\n2. Implement these expressions in a program that computes, for a given set of parameters and $(\\delta_n, \\delta_s)$, the pair of tangent components $\\left(\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s\\right)$.\n\nUnits and angle specification:\n- All displacements $\\delta_n$ and $\\delta_s$ must be in millimeters ($\\mathrm{mm}$).\n- All stresses and tractions $t_n$, $t_s$, $\\sigma_n$, $\\mathrm{JCS}$ must be in megapascals ($\\mathrm{MPa}$).\n- Stiffness $k_{n0}$ and tangents $\\partial t_n / \\partial \\delta_n$, $\\partial t_s / \\partial \\delta_s$ must be in $\\mathrm{MPa}/\\mathrm{mm}$.\n- Angles must be supplied in degrees but converted to radians for use in $\\tan(\\cdot)$.\n\nTest suite:\nUse the following five test cases, each specified by $(\\delta_n, \\delta_s, k_{n0}, \\delta_m, \\mathrm{JRC}, \\mathrm{JCS}, \\phi_r, d_s)$:\n- Case $1$ (general mixed-mode, moderate compression and slip): $(\\delta_n, \\delta_s) = (0.5, 0.2)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n- Case $2$ (opening in normal, zero shear): $(\\delta_n, \\delta_s) = (-0.1, 0.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n- Case $3$ (high compression, large slip): $(\\delta_n, \\delta_s) = (20.0, 2.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n- Case $4$ (small compression, zero slip): $(\\delta_n, \\delta_s) = (0.05, 0.0)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 10$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n- Case $5$ (no roughness, moderate compression and slip): $(\\delta_n, \\delta_s) = (1.0, 0.1)$, $k_{n0} = 50$, $\\delta_m = 2.0$, $\\mathrm{JRC} = 0$, $\\mathrm{JCS} = 100$, $\\phi_r = 30$, $d_s = 0.5$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the pair $[\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s]$ for one case, formatted as nested lists with each float value printed to six decimal places, for example: $[[a_1,b_1],[a_2,b_2],\\dots]$. All tangent results must be expressed in $\\mathrm{MPa}/\\mathrm{mm}$.", "solution": "We derive the consistent tangent components from the constitutive definitions, which are well-tested formulas used in computational geomechanics for rock joints. The goal in a Newton-Raphson scheme is to compute the Jacobian of the residual with respect to the displacement increments. For a zero-thickness interface, the residual contribution from the constitutive law involves the tractions $\\mathbf{t}(\\boldsymbol{\\delta})$. Therefore, the consistent tangent components required are the partial derivatives of the traction components with respect to their corresponding displacement components, evaluated at the current state.\n\nNormal direction derivation:\nFor $\\delta_n \\le 0$, the joint is open and carries no compressive normal traction, so $t_n(\\delta_n) = 0$ and the tangent is $\\partial t_n / \\partial \\delta_n = 0$. For $\\delta_n > 0$, the normal traction is\n$$\nt_n(\\delta_n) = \\frac{k_{n0}\\,\\delta_n}{1 + \\delta_n / \\delta_m}.\n$$\nLet $k_{n0}$ and $\\delta_m$ be constants with $k_{n0} > 0$ and $\\delta_m > 0$. Using the quotient rule, we find the derivative:\n$$\n\\frac{\\partial t_n}{\\partial \\delta_n} = \\frac{k_{n0}(1 + \\delta_n / \\delta_m) - k_{n0}\\delta_n(1/\\delta_m)}{(1 + \\delta_n / \\delta_m)^2} = \\frac{k_{n0} + k_{n0}\\delta_n/\\delta_m - k_{n0}\\delta_n/\\delta_m}{(1 + \\delta_n / \\delta_m)^2} = \\frac{k_{n0}}{(1 + \\delta_n / \\delta_m)^2}.\n$$\nTherefore, the consistent tangent in the normal direction is\n$$\n\\frac{\\partial t_n}{\\partial \\delta_n} =\n\\begin{cases}\n0, & \\delta_n \\le 0, \\\\\n\\dfrac{k_{n0}}{\\left(1 + \\delta_n / \\delta_m\\right)^2}, & \\delta_n > 0.\n\\end{cases}\n$$\n\nShear direction derivation:\nThe shear traction is regularized by anchoring it to the Barton peak shear strength envelope and using a smooth slip function. The peak shear strength as a function of the effective normal stress $\\sigma_n$ is\n$$\n\\tau_p(\\sigma_n) =\n\\begin{cases}\n\\sigma_n \\,\\tan\\!\\left(\\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\dfrac{\\mathrm{JCS}}{\\sigma_n}\\right)\\right), & \\sigma_n > 0, \\\\\n0, & \\sigma_n \\le 0,\n\\end{cases}\n$$\nwhere the argument of $\\tan(\\cdot)$ is in radians. Under mixed-mode, $\\sigma_n = t_n(\\delta_n)$. The shear traction is defined as\n$$\nt_s(\\delta_s, \\sigma_n) = \\tau_p(\\sigma_n)\\,\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\nwith $d_s > 0$. For the consistent tangent with respect to $\\delta_s$, we consider the partial derivative at fixed $\\delta_n$, which implies $\\sigma_n$ is held constant when differentiating $t_s$ with respect to $\\delta_s$. Thus,\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s}\\bigg|_{\\delta_n} = \\tau_p(\\sigma_n) \\cdot \\frac{\\partial}{\\partial \\delta_s}\\left[\\tanh\\!\\left(\\frac{\\delta_s}{d_s}\\right)\\right] = \\tau_p(\\sigma_n) \\cdot \\frac{1}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\frac{\\delta_s}{d_s}\\right),\n$$\nwhere $\\mathrm{sech}(x) = 1/\\cosh(x)$. Accounting for the physical piecewise condition in $\\tau_p(\\sigma_n)$, we have\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s} =\n\\begin{cases}\n0, & \\sigma_n \\le 0, \\\\\n\\dfrac{\\tau_p(\\sigma_n)}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\dfrac{\\delta_s}{d_s}\\right), & \\sigma_n > 0.\n\\end{cases}\n$$\n\nUnits and angles:\n- $\\delta_n$ and $\\delta_s$ are in $\\mathrm{mm}$.\n- $t_n$, $t_s$, $\\sigma_n$, $\\mathrm{JCS}$ are in $\\mathrm{MPa}$.\n- $k_{n0}$ and the tangent components $\\partial t_n / \\partial \\delta_n$, $\\partial t_s / \\partial \\delta_s$ are in $\\mathrm{MPa}/\\mathrm{mm}$.\n- $\\phi_r$ is provided in degrees and must be converted to radians in the argument of $\\tan(\\cdot)$ via $\\phi_r^{\\mathrm{rad}} = \\phi_r^{\\circ}\\,\\pi/180$.\n- The $\\log_{10}(\\cdot)$ is the base-$10$ logarithm, consistent with the Barton formulation.\n\nAlgorithmic design for implementation:\n1. For each test case, read $\\delta_n$, $\\delta_s$, $k_{n0}$, $\\delta_m$, $\\mathrm{JRC}$, $\\mathrm{JCS}$, $\\phi_r$, $d_s$.\n2. Compute $t_n$ using the piecewise BB-inspired hyperbolic law. Then compute $\\partial t_n / \\partial \\delta_n$ using the derived closed-form expression.\n3. Set $\\sigma_n = t_n$. If $\\sigma_n \\le 0$, then set $\\tau_p = 0$ and $\\partial t_s / \\partial \\delta_s = 0$. Otherwise, compute the Barton peak strength\n$$\n\\theta^{\\circ} = \\phi_r + \\mathrm{JRC}\\,\\log_{10}\\!\\left(\\frac{\\mathrm{JCS}}{\\sigma_n}\\right),\\quad \\theta^{\\mathrm{rad}} = \\theta^{\\circ}\\,\\frac{\\pi}{180},\n$$\n$$\n\\tau_p = \\sigma_n \\tan(\\theta^{\\mathrm{rad}}),\n$$\nand then compute\n$$\n\\frac{\\partial t_s}{\\partial \\delta_s} = \\frac{\\tau_p}{d_s}\\,\\mathrm{sech}^2\\!\\left(\\frac{\\delta_s}{d_s}\\right) = \\frac{\\tau_p}{d_s}\\,\\frac{1}{\\cosh^2\\!\\left(\\frac{\\delta_s}{d_s}\\right)}.\n$$\n4. Collect the pair $\\left(\\partial t_n / \\partial \\delta_n, \\partial t_s / \\partial \\delta_s\\right)$ for each case.\n5. Print the results as a single line, formatted as a list of lists with each float to six decimal places: $[[a_1,b_1],[a_2,b_2],\\dots]$.\n\nThis procedure provides the consistent tangents needed for quadratic convergence in a Newton-Raphson solver, as they are the exact partial derivatives of the constitutive tractions with respect to the displacement components under mixed-mode conditions, respecting the physically motivated piecewise behavior in the normal direction and ensuring smoothness in the shear direction.", "answer": "```python\nimport numpy as np\n\ndef barton_peak_tau(sigma_n, JRC, JCS, phi_r_deg):\n    \"\"\"\n    Compute Barton peak shear strength tau_p(sigma_n).\n    Angles input in degrees; converted to radians for tan().\n    If sigma_n <= 0, return 0.\n    Units: sigma_n, JCS in MPa; tau_p in MPa.\n    \"\"\"\n    if sigma_n <= 0.0 or JCS <= sigma_n: # JCS must be > sigma_n for log\n        return 0.0\n    # Angle in degrees per Barton formula\n    theta_deg = phi_r_deg + JRC * np.log10(JCS / sigma_n)\n    theta_rad = np.deg2rad(theta_deg)\n    return sigma_n * np.tan(theta_rad)\n\ndef normal_traction_and_tangent(delta_n, k_n0, delta_m):\n    \"\"\"\n    Compute normal traction t_n and its consistent tangent dt_n/d(delta_n).\n    Piecewise: opening (delta_n <= 0) -> t_n = 0, tangent = 0.\n    Compression (delta_n > 0) -> hyperbolic law.\n    Units: delta_n in mm; k_n0 in MPa/mm; delta_m in mm.\n    Returns (t_n in MPa, tangent in MPa/mm).\n    \"\"\"\n    if delta_n <= 0.0:\n        return 0.0, 0.0\n    v = 1.0 + delta_n / delta_m\n    t_n = k_n0 * delta_n / v\n    dtangent = k_n0 / (v * v)\n    return t_n, dtangent\n\ndef shear_tangent(delta_s, sigma_n, d_s, JRC, JCS, phi_r_deg):\n    \"\"\"\n    Compute the consistent shear tangent dt_s/d(delta_s) at fixed delta_n.\n    Uses regularized tanh slip law anchored to Barton peak strength.\n    Units: delta_s, d_s in mm; sigma_n, JCS in MPa; tangent in MPa/mm.\n    \"\"\"\n    tau_p = barton_peak_tau(sigma_n, JRC, JCS, phi_r_deg)\n    if tau_p <= 0.0:\n        return 0.0\n    x = delta_s / d_s\n    sech2 = 1.0 / (np.cosh(x) ** 2)\n    return (tau_p / d_s) * sech2\n\ndef solve():\n    # Define the test cases as tuples:\n    # (delta_n, delta_s, k_n0, delta_m, JRC, JCS, phi_r_deg, d_s)\n    test_cases = [\n        (0.5, 0.2, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),   # Case 1\n        (-0.1, 0.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 2\n        (20.0, 2.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 3\n        (0.05, 0.0, 50.0, 2.0, 10.0, 100.0, 30.0, 0.5),  # Case 4\n        (1.0, 0.1, 50.0, 2.0, 0.0, 100.0, 30.0, 0.5),    # Case 5 (JRC=0)\n    ]\n\n    results = []\n    for (delta_n, delta_s, k_n0, delta_m, JRC, JCS, phi_r_deg, d_s) in test_cases:\n        # Normal traction and tangent\n        t_n, dtn_ddn = normal_traction_and_tangent(delta_n, k_n0, delta_m)\n        sigma_n = t_n  # effective normal stress equals normal traction\n\n        # Shear tangent\n        dts_dds = shear_tangent(delta_s, sigma_n, d_s, JRC, JCS, phi_r_deg)\n\n        results.append((dtn_ddn, dts_dds))\n\n    # Format results with six decimals, nested list, no spaces\n    formatted_pairs = []\n    for a, b in results:\n        formatted_pairs.append(f\"[{a:.6f},{b:.6f}]\")\n    output = \"[\" + \",\".join(formatted_pairs) + \"]\"\n    print(output)\n\nsolve()\n```", "id": "3537116"}]}