{"hands_on_practices": [{"introduction": "This practice focuses on the geometric foundation of all contact analyses: determining the separation between two bodies. Before any forces or stresses can be calculated, we must first quantify the gap or penetration. This exercise provides a concrete, hands-on calculation of the normal and tangential gap between two simple triangular finite elements, reinforcing the core principles of master-slave contact kinematics and closest point projection. [@problem_id:3534212]", "problem": "A pair of discretized surfaces in three-dimensional space are represented by two linear triangular surface elements in the Finite Element Method (FEM). The first triangle is designated the master surface and the second the slave surface. Each triangle is defined by three nodes with initial positions and known nodal displacements, and both surfaces undergo small deformations over a single time step. Use the standard isoparametric interpolation for linear triangles and the definition of the centroidal Gauss point in area (barycentric) coordinates. The master triangle nodes are ordered $\\boldsymbol{X}_{M1} \\rightarrow \\boldsymbol{X}_{M2} \\rightarrow \\boldsymbol{X}_{M3}$ to define the outward unit normal by the right-hand rule.\n\nGiven the initial coordinates and displacements:\n- Master triangle initial nodal coordinates: $\\boldsymbol{X}_{M1} = (0,\\,0,\\,0)$, $\\boldsymbol{X}_{M2} = (1,\\,0,\\,0)$, $\\boldsymbol{X}_{M3} = (0,\\,1,\\,0.1)$.\n- Master triangle nodal displacements: $\\boldsymbol{u}_{M1} = (0,\\,0,\\,0)$, $\\boldsymbol{u}_{M2} = (0,\\,0,\\,0.02)$, $\\boldsymbol{u}_{M3} = (0,\\,0,\\,0)$.\n- Slave triangle initial nodal coordinates: $\\boldsymbol{X}_{S1} = (0.2,\\,0.2,\\,0.15)$, $\\boldsymbol{X}_{S2} = (1.05,\\,0.1,\\,0.12)$, $\\boldsymbol{X}_{S3} = (0.1,\\,0.9,\\,0.25)$.\n- Slave triangle nodal displacements: $\\boldsymbol{u}_{S1} = (0.01,\\,-0.005,\\,-0.02)$, $\\boldsymbol{u}_{S2} = (0,\\,0,\\,-0.03)$, $\\boldsymbol{u}_{S3} = (-0.005,\\,0.005,\\,-0.01)$.\n\nAssume small strains and compute all quantities in the current (deformed) configuration. At the slave triangle’s centroidal Gauss point with barycentric coordinates $(\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$, perform a closest point projection onto the current master triangle. Using first principles of interface contact kinematics:\n1. Construct the current coordinates of the slave Gauss point from the deformed slave nodes.\n2. Construct the current outward unit normal of the master triangle from its deformed nodes.\n3. Compute the orthogonal closest point projection of the slave Gauss point onto the master triangle’s plane, and verify that the projected point lies inside the triangle by barycentric coordinates.\n4. From the relative position vector $\\boldsymbol{g} = \\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M}^{\\text{proj}}$, extract the normal gap $g_n$ and the tangential gap vector $\\boldsymbol{g}_t$ by decomposing $\\boldsymbol{g}$ into normal and tangential components with respect to the master surface at the projection point. Use the sign convention that $g_n  0$ indicates separation along the outward normal of the master surface and $g_n  0$ indicates penetration.\n\nRound your final numerical values to four significant figures. Express $g_n$ and each component of $\\boldsymbol{g}_t$ in meters. Provide the final answer as a single row matrix containing $g_n$ followed by the three Cartesian components of $\\boldsymbol{g}_t$ in the global coordinate frame.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and all necessary information is provided.\n\n### Step 1: Extract Givens\n- Master triangle initial nodal coordinates: $\\boldsymbol{X}_{M1} = (0,\\,0,\\,0)$, $\\boldsymbol{X}_{M2} = (1,\\,0,\\,0)$, $\\boldsymbol{X}_{M3} = (0,\\,1,\\,0.1)$.\n- Master triangle nodal displacements: $\\boldsymbol{u}_{M1} = (0,\\,0,\\,0)$, $\\boldsymbol{u}_{M2} = (0,\\,0,\\,0.02)$, $\\boldsymbol{u}_{M3} = (0,\\,0,\\,0)$.\n- Slave triangle initial nodal coordinates: $\\boldsymbol{X}_{S1} = (0.2,\\,0.2,\\,0.15)$, $\\boldsymbol{X}_{S2} = (1.05,\\,0.1,\\,0.12)$, $\\boldsymbol{X}_{S3} = (0.1,\\,0.9,\\,0.25)$.\n- Slave triangle nodal displacements: $\\boldsymbol{u}_{S1} = (0.01,\\,-0.005,\\,-0.02)$, $\\boldsymbol{u}_{S2} = (0,\\,0,\\,-0.03)$, $\\boldsymbol{u}_{S3} = (-0.005,\\,0.005,\\,-0.01)$.\n- Slave point: Centroidal Gauss point with barycentric coordinates $(\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$.\n- Master normal orientation: Defined by the ordering $\\boldsymbol{X}_{M1} \\rightarrow \\boldsymbol{X}_{M2} \\rightarrow \\boldsymbol{X}_{M3}$ and the right-hand rule.\n- Kinematic assumption: Small deformations, calculations in the current configuration.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem uses standard concepts from computational contact mechanics within the Finite Element Method (FEM), such as isoparametric interpolation, master-slave contact pairs, and closest point projection for gap calculation. These are established and fundamental principles.\n- **Well-Posed:** All necessary data (nodal coordinates and displacements) are provided. The tasks are clearly defined and lead to a unique, computable solution.\n- **Objective:** The problem is stated in precise, quantitative terms without subjective or ambiguous language.\n- **Conclusion:** The problem is deemed valid as it is self-contained, consistent, and grounded in established scientific principles of computational mechanics.\n\n### Solution Derivation\nThe solution proceeds by following the four steps outlined in the problem statement. First, we compute the nodal coordinates in the current (deformed) configuration. The current coordinate vector $\\boldsymbol{x}$ is the sum of the initial coordinate vector $\\boldsymbol{X}$ and the displacement vector $\\boldsymbol{u}$, i.e., $\\boldsymbol{x} = \\boldsymbol{X} + \\boldsymbol{u}$.\n\nDeformed master node coordinates:\n$\\boldsymbol{x}_{M1} = \\boldsymbol{X}_{M1} + \\boldsymbol{u}_{M1} = (0,\\,0,\\,0) + (0,\\,0,\\,0) = (0,\\,0,\\,0)$\n$\\boldsymbol{x}_{M2} = \\boldsymbol{X}_{M2} + \\boldsymbol{u}_{M2} = (1,\\,0,\\,0) + (0,\\,0,\\,0.02) = (1,\\,0,\\,0.02)$\n$\\boldsymbol{x}_{M3} = \\boldsymbol{X}_{M3} + \\boldsymbol{u}_{M3} = (0,\\,1,\\,0.1) + (0,\\,0,\\,0) = (0,\\,1,\\,0.1)$\n\nDeformed slave node coordinates:\n$\\boldsymbol{x}_{S1} = \\boldsymbol{X}_{S1} + \\boldsymbol{u}_{S1} = (0.2,\\,0.2,\\,0.15) + (0.01,\\,-0.005,\\,-0.02) = (0.21,\\,0.195,\\,0.13)$\n$\\boldsymbol{x}_{S2} = \\boldsymbol{X}_{S2} + \\boldsymbol{u}_{S2} = (1.05,\\,0.1,\\,0.12) + (0,\\,0,\\,-0.03) = (1.05,\\,0.1,\\,0.09)$\n$\\boldsymbol{x}_{S3} = \\boldsymbol{X}_{S3} + \\boldsymbol{u}_{S3} = (0.1,\\,0.9,\\,0.25) + (-0.005,\\,0.005,\\,-0.01) = (0.095,\\,0.905,\\,0.24)$\n\n**1. Construct the current coordinates of the slave Gauss point ($\\boldsymbol{x}_{S}^{\\text{GP}}$)**\nThe position of the centroidal Gauss point is the average of the nodal coordinates, corresponding to barycentric coordinates $(\\xi_1, \\xi_2, \\xi_3) = (\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$.\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3}\\boldsymbol{x}_{S1} + \\frac{1}{3}\\boldsymbol{x}_{S2} + \\frac{1}{3}\\boldsymbol{x}_{S3} = \\frac{1}{3}(\\boldsymbol{x}_{S1} + \\boldsymbol{x}_{S2} + \\boldsymbol{x}_{S3}) $$\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3} \\left( (0.21+1.05+0.095),\\,(0.195+0.1+0.905),\\,(0.13+0.09+0.24) \\right) $$\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3} (1.355,\\,1.2,\\,0.46) = (0.45166\\dots,\\,0.4,\\,0.15333\\dots) $$\n\n**2. Construct the current outward unit normal of the master triangle ($\\boldsymbol{n}$)**\nThe normal vector $\\boldsymbol{N}$ is found from the cross product of two edge vectors originating from a common node, consistent with the right-hand rule. We use edge vectors $\\boldsymbol{v}_{12} = \\boldsymbol{x}_{M2}-\\boldsymbol{x}_{M1}$ and $\\boldsymbol{v}_{13} = \\boldsymbol{x}_{M3}-\\boldsymbol{x}_{M1}$.\n$$ \\boldsymbol{v}_{12} = (1,\\,0,\\,0.02) - (0,\\,0,\\,0) = (1,\\,0,\\,0.02) $$\n$$ \\boldsymbol{v}_{13} = (0,\\,1,\\,0.1) - (0,\\,0,\\,0) = (0,\\,1,\\,0.1) $$\n$$ \\boldsymbol{N} = \\boldsymbol{v}_{12} \\times \\boldsymbol{v}_{13} = \\begin{vmatrix} \\boldsymbol{i}  \\boldsymbol{j}  \\boldsymbol{k} \\\\ 1  0  0.02 \\\\ 0  1  0.1 \\end{vmatrix} = (-0.02, -0.1, 1) $$\nThe magnitude of the normal vector is:\n$$ ||\\boldsymbol{N}|| = \\sqrt{(-0.02)^2 + (-0.1)^2 + 1^2} = \\sqrt{0.0004 + 0.01 + 1} = \\sqrt{1.0104} \\approx 1.0051865 $$\nThe unit normal vector $\\boldsymbol{n}$ is:\n$$ \\boldsymbol{n} = \\frac{\\boldsymbol{N}}{||\\boldsymbol{N}||} = \\frac{1}{\\sqrt{1.0104}}(-0.02,\\,-0.1,\\,1) \\approx (-0.01990,\\, -0.09949,\\, 0.99494) $$\n\n**3. Compute the orthogonal closest point projection ($\\boldsymbol{x}_{M}^{\\text{proj}}$) and verify**\nThe master surface is a plane defined by $\\boldsymbol{n} \\cdot (\\boldsymbol{x} - \\boldsymbol{x}_{M1}) = 0$. Since $\\boldsymbol{x}_{M1} = (0,0,0)$, the plane equation is $\\boldsymbol{n} \\cdot \\boldsymbol{x} = 0$.\nThe projected point $\\boldsymbol{x}_{M}^{\\text{proj}}$ is found by moving from $\\boldsymbol{x}_{S}^{\\text{GP}}$ along the direction $-\\boldsymbol{n}$ by a distance equal to the orthogonal separation $d = (\\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M1}) \\cdot \\boldsymbol{n}$.\n$$ d = \\boldsymbol{x}_{S}^{\\text{GP}} \\cdot \\boldsymbol{n} = \\frac{1}{3}(1.355,\\,1.2,\\,0.46) \\cdot \\frac{1}{\\sqrt{1.0104}}(-0.02,\\,-0.1,\\,1) $$\n$$ d = \\frac{1}{3\\sqrt{1.0104}} \\left(1.355(-0.02) + 1.2(-0.1) + 0.46(1) \\right) $$\n$$ d = \\frac{1}{3\\sqrt{1.0104}} (-0.0271 - 0.12 + 0.46) = \\frac{0.3129}{3\\sqrt{1.0104}} = \\frac{0.1043}{\\sqrt{1.0104}} \\approx 0.103762 $$\nThe projected point is $\\boldsymbol{x}_{M}^{\\text{proj}} = \\boldsymbol{x}_{S}^{\\text{GP}} - d \\boldsymbol{n}$.\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.451667,\\,0.4,\\,0.153333) - 0.103762 \\cdot (-0.01990,\\, -0.09949,\\, 0.99494) $$\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.451667+0.002065,\\, 0.4+0.010323,\\, 0.153333-0.103234) $$\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.45373,\\, 0.41032,\\, 0.05010) $$\nTo verify this point is inside the master triangle, we find its barycentric coordinates $(\\xi_1, \\xi_2, \\xi_3)$ such that $\\boldsymbol{x}_{M}^{\\text{proj}} = \\xi_1\\boldsymbol{x}_{M1} + \\xi_2\\boldsymbol{x}_{M2} + \\xi_3\\boldsymbol{x}_{M3}$ and $\\xi_1+\\xi_2+\\xi_3=1$.\nSince $\\boldsymbol{x}_{M1} = (0,0,0)$, this simplifies to $\\boldsymbol{x}_{M}^{\\text{proj}} = \\xi_2\\boldsymbol{x}_{M2} + \\xi_3\\boldsymbol{x}_{M3}$.\n$$ (0.45373,\\, 0.41032,\\, 0.05010) = \\xi_2(1,\\,0,\\,0.02) + \\xi_3(0,\\,1,\\,0.1) $$\nFrom the $x$ and $y$ components:\n$\\xi_2 = 0.45373$\n$\\xi_3 = 0.41032$\nThen $\\xi_1 = 1 - \\xi_2 - \\xi_3 = 1 - 0.45373 - 0.41032 = 0.13595$.\nSince $\\xi_1, \\xi_2, \\xi_3$ are all positive and sum to $1$, the projected point lies within the master triangle. The verification is successful.\n\n**4. Compute the normal gap ($g_n$) and tangential gap vector ($\\boldsymbol{g}_t$)**\nThe relative position vector (gap vector) is $\\boldsymbol{g} = \\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M}^{\\text{proj}}$. Based on the definition of orthogonal projection, this vector is by construction parallel to the normal vector $\\boldsymbol{n}$, with its length equal to the distance $d$.\n$$ \\boldsymbol{g} = d \\boldsymbol{n} $$\nThe normal gap $g_n$ is the component of $\\boldsymbol{g}$ along $\\boldsymbol{n}$. With the sign convention that $g_n  0$ for separation, this is:\n$$ g_n = \\boldsymbol{g} \\cdot \\boldsymbol{n} = (d \\boldsymbol{n}) \\cdot \\boldsymbol{n} = d (\\boldsymbol{n} \\cdot \\boldsymbol{n}) = d $$\n$$ g_n = d \\approx 0.103762 $$\nRounding to four significant figures, $g_n = 0.1038$ m. Since $g_n  0$, the surfaces are separated at this point.\n\nThe tangential gap vector $\\boldsymbol{g}_t$ is the component of $\\boldsymbol{g}$ in the plane of the master surface. It is obtained by subtracting the normal component from $\\boldsymbol{g}$:\n$$ \\boldsymbol{g}_t = \\boldsymbol{g} - g_n \\boldsymbol{n} $$\nSubstituting $\\boldsymbol{g} = d \\boldsymbol{n}$ and $g_n = d$:\n$$ \\boldsymbol{g}_t = d \\boldsymbol{n} - d \\boldsymbol{n} = \\boldsymbol{0} $$\nThe tangential gap vector is zero because the projection was defined as being orthogonal to the master surface. Therefore, the vector from the slave point to its projection has no tangential component by definition.\nThe components of the tangential gap vector are $\\boldsymbol{g}_t = (g_{tx}, g_{ty}, g_{tz}) = (0, 0, 0)$.\n\nFinal values rounded to four significant figures:\n$g_n = 0.1038$\n$\\boldsymbol{g}_t = (0, 0, 0)$\nExpressing these as a single row matrix $[g_n, g_{tx}, g_{ty}, g_{tz}]$:\n$[0.1038,\\, 0,\\, 0,\\, 0]$.\nNote that problem asks to round the final numerical values, so the $0$ components remain exactly $0$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1038  0  0  0 \\end{pmatrix} } $$", "id": "3534212"}, {"introduction": "Understanding friction involves more than just knowing the force limit; it requires appreciating its role as a dissipative process. This exercise delves into the energetics of a frictional interface by modeling a complete stick-slip loading cycle. By calculating the work input, you will explicitly partition the energy into its recoverable elastic component and its irrecoverable dissipated component, providing a tangible illustration of the first law of thermodynamics in the context of interface mechanics. [@problem_id:3534277]", "problem": "A planar rock joint is idealized as a zero-thickness interface between two deformable bodies. The interface is subjected to a prescribed monotonically increasing tangential relative displacement jump $g_t$ under a constant compressive normal stress $p_n$, such that contact remains closed with no separation throughout the loading. The tangential constitutive response is elastic before sliding with stiffness $k_t$ per unit area, and follows the classical Coulomb friction law after the onset of sliding: the magnitude of the shear traction $|\\tau|$ cannot exceed the friction limit defined by the coefficient of friction $\\mu$ times the imposed normal stress $p_n$, and during sliding the magnitude of $|\\tau|$ remains equal to the friction limit. The interface area is $A$. The loading path produces stick up to the onset of sliding, followed by steady slip at the friction limit, reaching a final tangential displacement jump $D_f$.\n\nUsing only first principles, namely the kinematic definition of the tangential displacement jump, the elastic constitutive relation prior to sliding, the Coulomb friction limit, and the mechanical power/work definition at an interface, derive the partition of the total external work into recoverable elastic energy stored at the end of loading and irrecoverable frictional dissipation accumulated over the loading path. Then evaluate these two energies for the following scientifically realistic parameters:\n- Interface area $A = 0.50\\,\\mathrm{m}^2$,\n- Constant compressive normal stress $p_n = 10\\,\\mathrm{MPa}$,\n- Coefficient of friction $\\mu = 0.60$,\n- Tangential stiffness per unit area $k_t = 2.0\\,\\mathrm{GPa/m}$,\n- Final tangential displacement jump $D_f = 8.0\\,\\mathrm{mm}$.\n\nExpress the final energies in Joules. Round your answer to four significant figures. Report your final answer as a row matrix with the first entry equal to the recoverable elastic energy and the second entry equal to the irrecoverable frictional dissipation.", "solution": "The problem is valid as it is scientifically grounded in the principles of contact mechanics and continuum mechanics, is well-posed with a complete and consistent set of data and constitutive laws, and is expressed in objective, formal language. We proceed with the solution.\n\nThe problem asks for the partition of the total external work into recoverable elastic energy and irrecoverable frictional dissipation for a planar interface under shear loading. Let us define the relevant quantities. The interface has an area $A$. It is subjected to a constant compressive normal stress $p_n$ and a monotonically increasing tangential relative displacement jump $g_t$. The shear traction is denoted by $\\tau$.\n\nThe constitutive behavior of the interface is described by two regimes:\n1.  **Elastic (Stick) Regime**: Before sliding commences, the shear traction is linearly proportional to the tangential displacement jump. The stiffness per unit area is $k_t$. The relationship is given by:\n    $$ \\tau = k_t g_t $$\n    This regime holds as long as the shear traction is below the frictional strength.\n2.  **Plastic (Slip) Regime**: Sliding occurs when the shear traction reaches the limit defined by the Coulomb friction law. The frictional strength is $\\mu p_n$, where $\\mu$ is the coefficient of friction. During sliding, the magnitude of the shear traction is constant and equal to this limit:\n    $$ |\\tau| = \\mu p_n $$\n\nThe transition from the stick to the slip regime occurs at a specific tangential displacement jump, which we will call the yield displacement, $g_{t, \\text{yield}}$. This is the point where the elastic traction equals the frictional strength:\n$$ k_t g_{t, \\text{yield}} = \\mu p_n $$\nSolving for the yield displacement gives:\n$$ g_{t, \\text{yield}} = \\frac{\\mu p_n}{k_t} $$\nThe loading path consists of an initial elastic phase for $0 \\le g_t \\le g_{t, \\text{yield}}$, followed by a steady slip phase for $g_{t, \\text{yield}}  g_t \\le D_f$, where $D_f$ is the final prescribed tangential displacement jump. We must first verify that $D_f  g_{t, \\text{yield}}$ to confirm that the slip phase is indeed reached.\n\nThe total external work, $W_{\\text{total}}$, done on the interface is the integral of the total tangential force, $F_t = \\tau A$, over the total tangential displacement jump, from $g_t=0$ to $g_t=D_f$.\n$$ W_{\\text{total}} = \\int_0^{D_f} F_t(g_t) \\, dg_t = A \\int_0^{D_f} \\tau(g_t) \\, dg_t $$\nWe must split this integral according to the two phases of the loading path:\n$$ W_{\\text{total}} = A \\left( \\int_0^{g_{t, \\text{yield}}} \\tau(g_t) \\, dg_t + \\int_{g_{t, \\text{yield}}}^{D_f} \\tau(g_t) \\, dg_t \\right) $$\nSubstituting the constitutive relations for $\\tau(g_t)$ in each phase:\n$$ W_{\\text{total}} = A \\left( \\int_0^{g_{t, \\text{yield}}} (k_t g_t) \\, dg_t + \\int_{g_{t, \\text{yield}}}^{D_f} (\\mu p_n) \\, dg_t \\right) $$\nEvaluating the integrals:\n$$ W_{\\text{total}} = A \\left( \\left[ \\frac{1}{2} k_t g_t^2 \\right]_0^{g_{t, \\text{yield}}} + \\left[ \\mu p_n g_t \\right]_{g_{t, \\text{yield}}}^{D_f} \\right) $$\n$$ W_{\\text{total}} = A \\left( \\frac{1}{2} k_t g_{t, \\text{yield}}^2 + \\mu p_n (D_f - g_{t, \\text{yield}}) \\right) $$\n\nThis total work is partitioned into recoverable stored elastic energy, $U_e$, and irrecoverable dissipated energy, $W_d$.\n$$ W_{\\text{total}} = U_e + W_d $$\n\nThe recoverable elastic energy, $U_e$, is the energy stored in the interface at the final state, corresponding to the displacement $D_f$. At this final state, the interface is sliding, so the shear traction is $\\tau_f = \\mu p_n$. The elastic part of the displacement, $g_t^e$, is related to this traction by the elastic law: $\\tau_f = k_t g_t^e$. Thus, at the final state:\n$$ g_{t,f}^e = \\frac{\\tau_f}{k_t} = \\frac{\\mu p_n}{k_t} = g_{t, \\text{yield}} $$\nThe elastic energy stored per unit area is $u_e = \\frac{1}{2} k_t (g_{t,f}^e)^2 = \\frac{1}{2} \\frac{\\tau_f^2}{k_t}$. The total recoverable elastic energy for the entire interface is:\n$$ U_e = A \\cdot u_e = A \\left( \\frac{1}{2} \\frac{(\\mu p_n)^2}{k_t} \\right) $$\n\nThe irrecoverable frictional dissipation, $W_d$, is the work done by the friction force over the plastic (slip) part of the displacement, $g_t^p = g_t - g_t^e$. Dissipation occurs only during the slip phase, where $g_t  g_{t, \\text{yield}}$ and $|\\tau| = \\mu p_n$. The amount of slip is $\\Delta g_t^p = D_f - g_{t,f}^e = D_f - g_{t, \\text{yield}}$. The dissipation is the product of the constant total friction force, $F_f = A \\mu p_n$, and the total slip distance:\n$$ W_d = (A \\mu p_n) (D_f - g_{t, \\text{yield}}) $$\nSubstituting the expression for $g_{t, \\text{yield}}$:\n$$ W_d = A \\mu p_n \\left( D_f - \\frac{\\mu p_n}{k_t} \\right) = A \\left( \\mu p_n D_f - \\frac{(\\mu p_n)^2}{k_t} \\right) $$\n\nNow we substitute the given numerical values, ensuring all are in base SI units.\n- Interface area: $A = 0.50\\,\\mathrm{m}^2$\n- Normal stress: $p_n = 10\\,\\mathrm{MPa} = 10 \\times 10^6\\,\\mathrm{Pa}$\n- Coefficient of friction: $\\mu = 0.60$\n- Tangential stiffness: $k_t = 2.0\\,\\mathrm{GPa/m} = 2.0 \\times 10^9\\,\\mathrm{N/m^3}$\n- Final displacement: $D_f = 8.0\\,\\mathrm{mm} = 8.0 \\times 10^{-3}\\,\\mathrm{m}$\n\nFirst, we calculate the yield displacement, $g_{t, \\text{yield}}$:\n$$ g_{t, \\text{yield}} = \\frac{\\mu p_n}{k_t} = \\frac{0.60 \\times (10 \\times 10^6\\,\\mathrm{Pa})}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} = \\frac{6.0 \\times 10^6\\,\\mathrm{N/m^2}}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} = 3.0 \\times 10^{-3}\\,\\mathrm{m} $$\nSince $D_f = 8.0 \\times 10^{-3}\\,\\mathrm{m}  g_{t, \\text{yield}} = 3.0 \\times 10^{-3}\\,\\mathrm{m}$, the interface does indeed undergo a period of steady slip, and our derived formulas are applicable.\n\nNext, we calculate the recoverable elastic energy, $U_e$:\n$$ U_e = A \\left( \\frac{1}{2} \\frac{(\\mu p_n)^2}{k_t} \\right) = (0.50\\,\\mathrm{m}^2) \\left( \\frac{1}{2} \\frac{(0.60 \\times 10 \\times 10^6\\,\\mathrm{Pa})^2}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} \\right) $$\n$$ U_e = 0.50 \\left( \\frac{1}{2} \\frac{(6.0 \\times 10^6)^2}{2.0 \\times 10^9} \\right) \\,\\mathrm{J} = 0.50 \\left( \\frac{36 \\times 10^{12}}{4.0 \\times 10^9} \\right) \\,\\mathrm{J} $$\n$$ U_e = 0.50 \\times (9.0 \\times 10^3) \\,\\mathrm{J} = 4500\\,\\mathrm{J} $$\n\nFinally, we calculate the irrecoverable frictional dissipation, $W_d$:\n$$ W_d = A \\mu p_n (D_f - g_{t, \\text{yield}}) = (0.50\\,\\mathrm{m}^2)(0.60)(10 \\times 10^6\\,\\mathrm{Pa})(8.0 \\times 10^{-3}\\,\\mathrm{m} - 3.0 \\times 10^{-3}\\,\\mathrm{m}) $$\nThe total friction force is $F_f = A \\mu p_n = (0.50\\,\\mathrm{m}^2)(6.0 \\times 10^6\\,\\mathrm{N/m^2}) = 3.0 \\times 10^6\\,\\mathrm{N}$.\nThe total slip distance is $\\Delta g_t^p = (8.0 - 3.0) \\times 10^{-3}\\,\\mathrm{m} = 5.0 \\times 10^{-3}\\,\\mathrm{m}$.\n$$ W_d = (3.0 \\times 10^6\\,\\mathrm{N}) (5.0 \\times 10^{-3}\\,\\mathrm{m}) = 15.0 \\times 10^3\\,\\mathrm{J} = 15000\\,\\mathrm{J} $$\n\nThe problem requires rounding to four significant figures.\nRecoverable elastic energy: $U_e = 4500\\,\\mathrm{J} = 4.500 \\times 10^3\\,\\mathrm{J}$.\nIrrecoverable frictional dissipation: $W_d = 15000\\,\\mathrm{J} = 1.500 \\times 10^4\\,\\mathrm{J}$.\n\nThe final answer is a row matrix containing these two values in Joules.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.500 \\times 10^3  1.500 \\times 10^4\n\\end{pmatrix}\n}\n$$", "id": "3534277"}, {"introduction": "The physical laws of friction must be translated into robust numerical procedures to be used in computer simulations. This practice guides you through the implementation of the radial return algorithm, a fundamental technique in computational plasticity for enforcing such laws. By writing the code to project a \"trial\" stress state that violates the friction criterion back onto the admissible yield surface, you will gain direct experience with a core algorithm used in virtually all modern geomechanics software. [@problem_id:3534224]", "problem": "Consider a planar frictional contact interface in computational geomechanics, in which the normal traction $p_n$ is taken as positive in compression. The tangential traction is represented by the two-dimensional vector $\\boldsymbol{\\tau} \\in \\mathbb{R}^2$. The frictional strength is modeled by the classical Coulomb law with friction coefficient $\\mu \\ge 0$, which implies the admissible set is defined by the yield function\n$$\n\\phi(\\boldsymbol{\\tau},p_n) = \\|\\boldsymbol{\\tau}\\| - \\mu\\,p_n \\le 0,\n$$\nwhere $\\|\\cdot\\|$ denotes the Euclidean norm. The interface is regularized by a tangential penalty stiffness $k_t  0$ (units: pascal per meter) so that the purely elastic predictor provides a trial tangential traction $\\boldsymbol{\\tau}^{\\text{trial}} \\in \\mathbb{R}^2$ (units: pascal). If sliding occurs, introduce a plastic slip increment vector $\\Delta \\boldsymbol{\\xi} \\in \\mathbb{R}^2$ (units: meter) to correct the trial state to one satisfying the friction law.\n\nStarting from first principles of the frictional admissible set $\\phi(\\boldsymbol{\\tau},p_n) \\le 0$, the Karush–Kuhn–Tucker (KKT) conditions for contact and friction, and the penalty-based elastic predictor, implement the radial return algorithm that maps the trial tangential traction $\\boldsymbol{\\tau}^{\\text{trial}}$ to the return-mapped tangential traction $\\boldsymbol{\\tau}$ and the plastic slip increment $\\Delta \\boldsymbol{\\xi}$. Your implementation must respect the following physically consistent cases:\n- If $p_n \\le 0$ (open contact), set $\\boldsymbol{\\tau} = \\boldsymbol{0}$ and $\\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}$.\n- If $p_n  0$ and $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n) \\le 0$ (stick), set $\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}}$ and $\\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}$.\n- If $p_n  0$ and $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n)  0$ (sliding), perform a radial return such that the final traction satisfies $\\|\\boldsymbol{\\tau}\\| = \\mu\\,p_n$ and is colinear with $\\boldsymbol{\\tau}^{\\text{trial}}$, and compute the corresponding plastic slip increment that is consistent with the tangential penalty stiffness $k_t$.\n\nAll quantities in the algorithm must be handled in the following units:\n- Normal traction $p_n$ in pascal (Pa).\n- Tangential traction vectors $\\boldsymbol{\\tau}^{\\text{trial}}$ and $\\boldsymbol{\\tau}$ in pascal (Pa).\n- Tangential penalty stiffness $k_t$ in pascal per meter (Pa/m).\n- Plastic slip increment $\\Delta \\boldsymbol{\\xi}$ in meter (m).\n\nUse the following test suite comprising seven cases, each given as $(p_n,\\mu,\\boldsymbol{\\tau}^{\\text{trial}},k_t)$:\n1. $p_n = 1.0\\times 10^5$ Pa, $\\mu = 0.3$, $\\boldsymbol{\\tau}^{\\text{trial}} = [5.0\\times 10^4,\\,6.0\\times 10^4]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n2. $p_n = 2.0\\times 10^5$ Pa, $\\mu = 0.5$, $\\boldsymbol{\\tau}^{\\text{trial}} = [5.0\\times 10^4,\\,6.0\\times 10^4]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n3. $p_n = 2.6034\\times 10^5$ Pa, $\\mu = 0.3$, $\\boldsymbol{\\tau}^{\\text{trial}} = [5.0\\times 10^4,\\,6.0\\times 10^4]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n4. $p_n = 1.0\\times 10^5$ Pa, $\\mu = 0.0$, $\\boldsymbol{\\tau}^{\\text{trial}} = [1.0\\times 10^4,\\,0.0]$ Pa, $k_t = 1.0\\times 10^8$ Pa/m.\n5. $p_n = -1.0\\times 10^4$ Pa, $\\mu = 0.3$, $\\boldsymbol{\\tau}^{\\text{trial}} = [2.0\\times 10^4,\\,0.0]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n6. $p_n = 5.0\\times 10^4$ Pa, $\\mu = 0.6$, $\\boldsymbol{\\tau}^{\\text{trial}} = [0.0,\\,0.0]$ Pa, $k_t = 1.0\\times 10^9$ Pa/m.\n7. $p_n = 1.0\\times 10^5$ Pa, $\\mu = 0.3$, $\\boldsymbol{\\tau}^{\\text{trial}} = [5.0\\times 10^4,\\,6.0\\times 10^4]$ Pa, $k_t = 1.0\\times 10^{12}$ Pa/m.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result must be a list of four real numbers $[\\tau_x,\\tau_y,\\Delta \\xi_x,\\Delta \\xi_y]$, where $[\\tau_x,\\tau_y]$ is the return-mapped tangential traction (in pascal) and $[\\Delta \\xi_x,\\Delta \\xi_y]$ is the plastic slip increment (in meter) for the corresponding case. For example, the final output format must be of the form\n$$\n[\\,[\\tau_x^{(1)},\\tau_y^{(1)},\\Delta \\xi_x^{(1)},\\Delta \\xi_y^{(1)}],\\,[\\tau_x^{(2)},\\tau_y^{(2)},\\Delta \\xi_x^{(2)},\\Delta \\xi_y^{(2)}],\\,\\dots\\,].\n$$", "solution": "The starting point is the friction admissibility condition from the Coulomb law, expressed by the yield function\n$$\n\\phi(\\boldsymbol{\\tau},p_n) = \\|\\boldsymbol{\\tau}\\| - \\mu\\,p_n \\le 0,\n$$\nwith $\\mu \\ge 0$ and $p_n$ taken positive in compression. The Karush–Kuhn–Tucker (KKT) structure for friction indicates three regimes: open contact ($p_n \\le 0$), stick ($p_n  0$ and $\\phi \\le 0$), and sliding ($p_n  0$ and $\\phi = 0$ with nonzero slip increment). In a penalty-based discretization, a purely elastic predictor delivers a trial traction $\\boldsymbol{\\tau}^{\\text{trial}}$ resulting from a trial slip increment through the tangential stiffness $k_t$. If the trial state violates $\\phi \\le 0$, a plastic correction is applied.\n\nIn the open-contact regime where $p_n \\le 0$, no compressive normal traction can be sustained and tangential traction must vanish:\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{0}, \\quad \\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}.\n$$\n\nIn the stick regime for $p_n  0$ and $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n) \\le 0$, the trial state is admissible, meaning no plastic slip increment is needed:\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}}, \\quad \\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}.\n$$\n\nIn the sliding regime for $p_n  0$ and $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n)  0$, the return mapping seeks a corrected traction that lies on the friction boundary, is colinear with the trial traction, and is consistent with the penalty stiffness. Denote the unit direction of the trial traction by\n$$\n\\boldsymbol{m} = \\frac{\\boldsymbol{\\tau}^{\\text{trial}}}{\\|\\boldsymbol{\\tau}^{\\text{trial}}\\|}.\n$$\nThe radial return enforces colinearity and boundary admissibility by\n$$\n\\boldsymbol{\\tau} = \\mu\\,p_n\\,\\boldsymbol{m}.\n$$\nTo compute the plastic slip increment, we use the penalty relation that the plastic correction reduces the trial traction:\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}} - k_t\\,\\Delta \\boldsymbol{\\xi}.\n$$\nUnder radial return, take $\\Delta \\boldsymbol{\\xi}$ aligned with $\\boldsymbol{m}$ as $\\Delta \\boldsymbol{\\xi} = \\Delta \\gamma\\,\\boldsymbol{m}$, where $\\Delta \\gamma$ is a scalar with units of meter. Projecting the penalty relation onto $\\boldsymbol{m}$ yields\n$$\n\\mu\\,p_n = \\|\\boldsymbol{\\tau}^{\\text{trial}}\\| - k_t\\,\\Delta \\gamma \\quad \\Rightarrow \\quad \\Delta \\gamma = \\frac{\\|\\boldsymbol{\\tau}^{\\text{trial}}\\| - \\mu\\,p_n}{k_t}.\n$$\nTherefore, the plastic slip increment vector is\n$$\n\\Delta \\boldsymbol{\\xi} = \\Delta \\gamma\\,\\boldsymbol{m} = \\frac{\\|\\boldsymbol{\\tau}^{\\text{trial}}\\| - \\mu\\,p_n}{k_t}\\,\\frac{\\boldsymbol{\\tau}^{\\text{trial}}}{\\|\\boldsymbol{\\tau}^{\\text{trial}}\\|}.\n$$\nThis expression is physically consistent: when $\\mu = 0$ and $p_n  0$, the return-mapped traction vanishes and the slip increment magnitude reduces to $\\|\\boldsymbol{\\tau}^{\\text{trial}}\\|/k_t$ in the direction of $\\boldsymbol{\\tau}^{\\text{trial}}$; when $\\phi(\\boldsymbol{\\tau}^{\\text{trial}},p_n) = 0$ exactly, $\\Delta \\gamma = 0$ and $\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}}$ as a boundary stick state; when $\\boldsymbol{\\tau}^{\\text{trial}} = \\boldsymbol{0}$, both the traction and the slip increment are zero.\n\nAlgorithmic steps to implement for each test case $(p_n,\\mu,\\boldsymbol{\\tau}^{\\text{trial}},k_t)$ are:\n1. Compute $s = \\|\\boldsymbol{\\tau}^{\\text{trial}}\\|$.\n2. If $p_n \\le 0$, set $\\boldsymbol{\\tau} = \\boldsymbol{0}$ and $\\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}$.\n3. Else, compute $\\phi^{\\text{trial}} = s - \\mu\\,p_n$.\n4. If $\\phi^{\\text{trial}} \\le 0$, set $\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{\\text{trial}}$ and $\\Delta \\boldsymbol{\\xi} = \\boldsymbol{0}$.\n5. If $\\phi^{\\text{trial}}  0$, set $\\boldsymbol{m} = \\boldsymbol{\\tau}^{\\text{trial}}/s$, $\\boldsymbol{\\tau} = \\mu\\,p_n\\,\\boldsymbol{m}$, and $\\Delta \\boldsymbol{\\xi} = \\left(\\phi^{\\text{trial}}/k_t\\right)\\,\\boldsymbol{m}$.\n\nApplying the above to the specified test suite yields, for each case, the ordered list $[\\tau_x,\\tau_y,\\Delta \\xi_x,\\Delta \\xi_y]$ with $\\boldsymbol{\\tau}$ in pascal and $\\Delta \\boldsymbol{\\xi}$ in meter, which the program outputs as a single line containing the list of these lists for all seven cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef radial_return(p_n: float, mu: float, kt: float, tau_trial: np.ndarray):\n    \"\"\"\n    Perform radial return mapping for planar Coulomb friction with tangential penalty stiffness.\n\n    Parameters\n    ----------\n    p_n : float\n        Normal traction (Pa), positive in compression.\n    mu : float\n        Friction coefficient (dimensionless).\n    kt : float\n        Tangential penalty stiffness (Pa/m).\n    tau_trial : np.ndarray\n        Trial tangential traction vector (Pa), shape (2,).\n\n    Returns\n    -------\n    tau : np.ndarray\n        Return-mapped tangential traction vector (Pa), shape (2,).\n    dxi : np.ndarray\n        Plastic slip increment vector (m), shape (2,).\n    \"\"\"\n    # Ensure tau_trial is a numpy array\n    t_trial = np.asarray(tau_trial, dtype=float)\n    s = np.linalg.norm(t_trial)\n\n    # Open contact: no traction, no slip increment\n    if p_n = 0.0:\n        return np.array([0.0, 0.0], dtype=float), np.array([0.0, 0.0], dtype=float)\n\n    # Trial yield function\n    phi_trial = s - mu * p_n\n\n    # Stick: admissible trial state\n    if phi_trial = 0.0 or s == 0.0:\n        return t_trial.copy(), np.array([0.0, 0.0], dtype=float)\n\n    # Sliding: radial return to yield surface\n    m = t_trial / s  # unit direction\n    tau = (mu * p_n) * m\n    # Plastic consistency parameter magnitude\n    delta_gamma = phi_trial / kt\n    dxi = delta_gamma * m\n    return tau, dxi\n\ndef solve():\n    # Define the test cases from the problem statement: (p_n, mu, tau_trial, k_t)\n    test_cases = [\n        (1.0e5, 0.3, np.array([5.0e4, 6.0e4]), 1.0e9),\n        (2.0e5, 0.5, np.array([5.0e4, 6.0e4]), 1.0e9),\n        (2.6034e5, 0.3, np.array([5.0e4, 6.0e4]), 1.0e9),\n        (1.0e5, 0.0, np.array([1.0e4, 0.0]), 1.0e8),\n        (-1.0e4, 0.3, np.array([2.0e4, 0.0]), 1.0e9),\n        (5.0e4, 0.6, np.array([0.0, 0.0]), 1.0e9),\n        (1.0e5, 0.3, np.array([5.0e4, 6.0e4]), 1.0e12),\n    ]\n\n    results = []\n    for p_n, mu, tau_trial, kt in test_cases:\n        tau, dxi = radial_return(p_n, mu, kt, tau_trial)\n        # Prepare list [tau_x, tau_y, dxi_x, dxi_y]\n        result = [float(tau[0]), float(tau[1]), float(dxi[0]), float(dxi[1])]\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Single line: list of lists\n    def fmt(x):\n        # Use default str for floats; ensure no extraneous spaces\n        return str(x)\n\n    inner = []\n    for r in results:\n        inner.append(f\"[{','.join(fmt(x) for x in r)}]\")\n    print(f\"[{','.join(inner)}]\")\n\nsolve()\n```", "id": "3534224"}]}