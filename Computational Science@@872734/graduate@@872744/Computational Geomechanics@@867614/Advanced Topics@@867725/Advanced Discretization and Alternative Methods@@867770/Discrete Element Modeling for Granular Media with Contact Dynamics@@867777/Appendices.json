{"hands_on_practices": [{"introduction": "Before diving into complex multi-particle simulations, it is essential to master the fundamental physics governing a single contact. This exercise challenges you to apply Newton's laws and the principles of Coulomb friction to a canonical problem: a particle on an inclined plane. By deriving the conditions for sticking versus sliding from first principles, you will build a solid intuition for the local rules that form the foundation of all discrete element models. [@problem_id:3518751]", "problem": "Consider a single spherical particle of mass $m$ modeled with the Discrete Element Method (DEM) in unilateral contact with a rigid, fixed plane. The plane has unit normal $\\mathbf{n}$ and a unit downslope tangent $\\mathbf{t}$ such that $\\{\\mathbf{n},\\mathbf{t}\\}$ is an orthonormal basis of the plane’s local frame. The particle is initially at rest and subject to a constant gravitational acceleration vector $\\mathbf{g}$ of magnitude $g$, oriented at an angle $\\alpha \\in [0,\\pi/2)$ with respect to $\\mathbf{n}$ so that $\\mathbf{g} = -g\\left(\\cos\\alpha\\,\\mathbf{n} + \\sin\\alpha\\,\\mathbf{t}\\right)$. The contact obeys the Signorini non-penetration condition in the normal direction and dry Coulomb friction in the tangential direction with friction coefficient $\\mu  0$. The unknown normal contact force $F_{n} \\ge 0$ acts along $\\mathbf{n}$, and the unknown tangential contact force $\\mathbf{F}_{t}$ acts along $\\mathbf{t}$ with the bound $|\\mathbf{F}_{t}| \\le \\mu F_{n}$.\n\nStarting from Newton’s laws and the Signorini–Coulomb contact conditions, derive the particle’s acceleration $\\mathbf{a}$ under sticking and under sliding. Then, determine the onset-of-sliding condition for the particle starting from rest under gravity. Finally, provide the critical tilt angle $\\alpha_{c}$ at which sliding initiates for the first time, expressed as a closed-form analytic expression in terms of $\\mu$. Express the final angle in radians. No numerical evaluation is required and no rounding is permitted.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. We can proceed with the derivation.\n\nThe motion of the particle is governed by Newton's second law, $\\sum \\mathbf{F} = m\\mathbf{a}$, where $m$ is the mass of the particle and $\\mathbf{a}$ is its acceleration. The forces acting on the particle are the gravitational force $\\mathbf{F}_g$, the normal contact force $\\mathbf{F}_N$, and the tangential friction force $\\mathbf{F}_T$.\n\nThe gravitational acceleration vector is given as $\\mathbf{g} = -g\\left(\\cos\\alpha\\,\\mathbf{n} + \\sin\\alpha\\,\\mathbf{t}\\right)$. Therefore, the gravitational force is $\\mathbf{F}_g = m\\mathbf{g} = -mg\\left(\\cos\\alpha\\,\\mathbf{n} + \\sin\\alpha\\,\\mathbf{t}\\right)$. The angle $\\alpha$ is in the range $[0, \\frac{\\pi}{2})$, which ensures $\\cos\\alpha > 0$ and $\\sin\\alpha \\ge 0$. The normal component of the gravitational force, $-mg\\cos\\alpha\\,\\mathbf{n}$, pushes the particle into the plane. The tangential component, $-mg\\sin\\alpha\\,\\mathbf{t}$, acts in the direction opposite to the downslope tangent $\\mathbf{t}$, i.e., it pushes the particle upslope.\n\nThe normal contact force $\\mathbf{F}_N$ acts along the outward normal $\\mathbf{n}$, so $\\mathbf{F}_N = F_n \\mathbf{n}$, where $F_n \\ge 0$ according to the Signorini condition.\n\nThe tangential friction force $\\mathbf{F}_T$ opposes the tendency of motion. Since the gravitational force has a component pushing the particle upslope (in the $-\\mathbf{t}$ direction), the friction force will act downslope to oppose this tendency. Thus, $\\mathbf{F}_T$ acts along the $+\\mathbf{t}$ direction. We can write $\\mathbf{F}_T = F_{t,mag} \\mathbf{t}$, where $F_{t,mag} \\ge 0$ is the magnitude of the friction force. The Coulomb friction law states that $F_{t,mag} \\le \\mu F_n$.\n\nThe total force on the particle is the sum of these forces:\n$$ \\sum \\mathbf{F} = \\mathbf{F}_g + \\mathbf{F}_N + \\mathbf{F}_T $$\n$$ \\sum \\mathbf{F} = \\left(-mg\\cos\\alpha\\,\\mathbf{n} - mg\\sin\\alpha\\,\\mathbf{t}\\right) + \\left(F_n \\mathbf{n}\\right) + \\left(F_{t,mag} \\mathbf{t}\\right) $$\nGrouping the components along the orthonormal basis vectors $\\mathbf{n}$ and $\\mathbf{t}$:\n$$ \\sum \\mathbf{F} = \\left(F_n - mg\\cos\\alpha\\right)\\mathbf{n} + \\left(F_{t,mag} - mg\\sin\\alpha\\right)\\mathbf{t} $$\nThe acceleration vector can also be decomposed in this basis: $\\mathbf{a} = a_n \\mathbf{n} + a_t \\mathbf{t}$.\nSubstituting into Newton's second law, $m(a_n \\mathbf{n} + a_t \\mathbf{t}) = \\sum \\mathbf{F}$, and equating components gives two scalar equations of motion:\n$1$. Normal direction: $m a_n = F_n - mg\\cos\\alpha$\n$2$. Tangential direction: $m a_t = F_{t,mag} - mg\\sin\\alpha$\n\nWe now analyze the two possible states of contact: sticking and sliding.\n\nFirst, consider the sticking case. If the particle is sticking, it has zero acceleration, since it starts from rest. Thus, $\\mathbf{a} = \\mathbf{0}$, which implies $a_n = 0$ and $a_t = 0$.\nSubstituting $a_n=0$ into Equation $1$:\n$$ 0 = F_n - mg\\cos\\alpha \\implies F_n = mg\\cos\\alpha $$\nSince $m>0$, $g>0$, and $\\cos\\alpha > 0$ for $\\alpha \\in [0, \\frac{\\pi}{2})$, we have $F_n > 0$, which is consistent with the particle being in contact.\nSubstituting $a_t=0$ into Equation $2$:\n$$ 0 = F_{t,mag} - mg\\sin\\alpha \\implies F_{t,mag} = mg\\sin\\alpha $$\nThis is the magnitude of the friction force required to maintain equilibrium. The sticking condition is only valid if this required force is less than or equal to the maximum available friction force, as per the Coulomb model: $F_{t,mag} \\le \\mu F_n$.\nSubstituting the expressions for $F_n$ and $F_{t,mag}$:\n$$ mg\\sin\\alpha \\le \\mu (mg\\cos\\alpha) $$\nSince $mg > 0$, we can divide by it:\n$$ \\sin\\alpha \\le \\mu\\cos\\alpha $$\nAs $\\cos\\alpha > 0$ in the given range, we can divide by $\\cos\\alpha$ without changing the inequality's direction:\n$$ \\tan\\alpha \\le \\mu $$\nThis is the condition for the particle to remain in a sticking state. The acceleration under sticking is $\\mathbf{a} = \\mathbf{0}$.\n\nNext, consider the sliding case. Sliding occurs when the condition for sticking is violated, i.e., when $\\tan\\alpha > \\mu$. In this regime, the friction force reaches its maximum possible magnitude, which is defined by the equality in the Coulomb law: $F_{t,mag} = \\mu F_n$.\nThe particle is in contact with the plane and does not accelerate in the normal direction (it doesn't lift off or penetrate). Therefore, we set $a_n = 0$. From Equation $1$, this gives the same result for the normal force as in the sticking case:\n$$ F_n = mg\\cos\\alpha $$\nNow, we can determine the magnitude of the friction force:\n$$ F_{t,mag} = \\mu F_n = \\mu mg\\cos\\alpha $$\nWe substitute this into the tangential equation of motion (Equation $2$) to find the tangential acceleration $a_t$:\n$$ m a_t = (\\mu mg\\cos\\alpha) - mg\\sin\\alpha $$\nDividing by the mass $m$:\n$$ a_t = g(\\mu\\cos\\alpha - \\sin\\alpha) $$\nThe total acceleration vector during sliding is $\\mathbf{a} = a_n \\mathbf{n} + a_t \\mathbf{t} = 0 \\cdot \\mathbf{n} + g(\\mu\\cos\\alpha - \\sin\\alpha) \\mathbf{t}$.\nSo, the acceleration under sliding is $\\mathbf{a} = g(\\mu\\cos\\alpha - \\sin\\alpha)\\mathbf{t}$. For sliding to occur, we have $\\tan\\alpha > \\mu$, which is equivalent to $\\sin\\alpha > \\mu\\cos\\alpha$, or $\\mu\\cos\\alpha - \\sin\\alpha  0$. This means $a_t  0$, so the acceleration is directed upslope (in the $-\\mathbf{t}$ direction), which is physically consistent as the upslope gravitational component has overcome the maximal downslope friction force.\n\nThe problem asks for the onset-of-sliding condition. This occurs at the transition point between the sticking and sliding regimes. The particle, starting from rest, will begin to slide when the angle $\\alpha$ is increased to a critical value $\\alpha_c$ such that the sticking condition is just violated. This corresponds to the equality:\n$$ \\tan\\alpha_c = \\mu $$\nFinally, to find the critical tilt angle $\\alpha_c$, we solve this equation for $\\alpha_c$:\n$$ \\alpha_c = \\arctan(\\mu) $$\nSince $\\mu > 0$ is given, the arctangent function yields a unique value for $\\alpha_c$ in the interval $(0, \\frac{\\pi}{2})$, which is consistent with the problem's constraints. The expression is in the required closed-form and is independent of any other parameters.", "answer": "$$\\boxed{\\arctan(\\mu)}$$", "id": "3518751"}, {"introduction": "Moving from continuous physics to computational practice, this problem simulates the core of a DEM time step for a single contact. You will implement the widely used Cundall-Strack model, updating the tangential force by accounting for both translational and rotational increments. This hands-on calculation illuminates how DEM codes track contact history and robustly handle the transition from sticking to sliding by projecting a 'trial' force onto the friction cone. [@problem_id:3518796]", "problem": "Consider two identical spherical particles in a Discrete Element Method (DEM) contact modeled with a linear normal spring and a linear tangential spring with Coulomb friction. Let the particles have radii $R_A$ and $R_B$, with $R_A = R_B = 0.05$ m. The normal contact stiffness is $k_n = 1.0 \\times 10^{5}$ N/m and the tangential stiffness is $k_t = \\beta k_n$ with $\\beta = 0.5$. The coefficient of friction is $\\mu = 0.4$. At time $t^n$ there is an established contact with unit normal $\\boldsymbol{n}$ and a stored elastic tangential displacement vector $\\boldsymbol{s}_t^n$ lying in the contact plane, with magnitude $s_0 = 1.0 \\times 10^{-4}$ m directed along the first in-plane orthonormal basis vector $\\boldsymbol{t}_1$. Over a single explicit time step $\\Delta t = 1.0 \\times 10^{-4}$ s, the relative translational displacement increment in the contact plane is $\\Delta \\boldsymbol{u}_t = \\Delta u \\, \\boldsymbol{t}_1$ with $\\Delta u = 3.0 \\times 10^{-5}$ m, and the relative spin about the contact normal is constant with value $\\omega_{\\text{rel},n} = 200$ rad/s (positive corresponding to a right-handed rotation about $\\boldsymbol{n}$). Assume the normal overlap at this step is $\\delta_n = 1.2 \\times 10^{-4}$ m, and that damping and adhesion are absent.\n\nAdopt the standard Cundall–Strack tangential spring update with a co-rotational frame: the stored tangential spring is rotated in the contact plane by angle $\\theta = \\omega_{\\text{rel},n} \\Delta t$, yielding the trial elastic displacement $\\boldsymbol{s}_t^{\\text{trial}} = \\mathbf{R}(\\theta) \\, \\boldsymbol{s}_t^n + \\Delta \\boldsymbol{u}_t$, where $\\mathbf{R}(\\theta)$ is the in-plane rotation by angle $\\theta$ about $\\boldsymbol{n}$. The trial tangential force is $\\boldsymbol{f}_t^{\\text{trial}} = - k_t \\boldsymbol{s}_t^{\\text{trial}}$. Impose the Coulomb friction law with yield function $|\\boldsymbol{f}_t| \\le \\mu f_n$, where $f_n = k_n \\delta_n$ is the compressive normal force. If $|\\boldsymbol{f}_t^{\\text{trial}}| \\le \\mu f_n$, the step is sticking and $\\boldsymbol{f}_t = \\boldsymbol{f}_t^{\\text{trial}}$; otherwise the step is sliding and $\\boldsymbol{f}_t = - \\mu f_n \\, \\boldsymbol{s}_t^{\\text{trial}} / \\|\\boldsymbol{s}_t^{\\text{trial}}\\|$. The torque magnitude on particle $A$ about its center due to $\\boldsymbol{f}_t$ is $\\tau_A = R_A \\, \\|\\boldsymbol{f}_t\\|$.\n\nUsing only these definitions and fundamental laws (Newton’s laws and Coulomb friction), compute:\n- the magnitude of the tangential force $\\|\\boldsymbol{f}_t\\|$ at time $t^{n+1}$ (express in N),\n- the magnitude of the torque $\\tau_A$ on particle $A$ about its center at time $t^{n+1}$ (express in N·m),\n- and a binary indicator $s$ with $s=0$ if the contact is sticking and $s=1$ if the contact is sliding at this time step.\n\nProvide your final answer as a single row matrix $\\begin{pmatrix} \\|\\boldsymbol{f}_t\\|  \\tau_A  s \\end{pmatrix}$, where the first two entries are rounded to four significant figures. The angle is in radians.", "solution": "The problem statement is assessed to be valid. It is a well-posed problem grounded in the established principles of computational geomechanics, specifically the Discrete Element Method (DEM). All necessary data and definitions for the Cundall-Strack contact model are provided, and the problem is free of scientific inaccuracies, contradictions, or ambiguities.\n\nThe solution proceeds by following the explicit steps defined in the problem for updating the tangential contact force over a single time step.\n\nFirst, we calculate the necessary contact parameters from the given values.\nThe tangential stiffness, $k_t$, is proportional to the normal stiffness, $k_n$:\n$$k_t = \\beta k_n = (0.5) \\times (1.0 \\times 10^5 \\text{ N/m}) = 5.0 \\times 10^4 \\text{ N/m}$$\n\nThe normal force, $f_n$, is determined by the normal overlap, $\\delta_n$, and the normal stiffness, $k_n$:\n$$f_n = k_n \\delta_n = (1.0 \\times 10^5 \\text{ N/m}) \\times (1.2 \\times 10^{-4} \\text{ m}) = 12.0 \\text{ N}$$\n\nThe maximum allowable tangential force due to Coulomb friction, the yield force $f_{\\text{yield}}$, is proportional to the normal force:\n$$f_{\\text{yield}} = \\mu f_n = (0.4) \\times (12.0 \\text{ N}) = 4.8 \\text{ N}$$\n\nNext, we calculate the angle of rotation, $\\theta$, of the contact plane due to the relative spin, $\\omega_{\\text{rel},n}$, over the time step, $\\Delta t$:\n$$\\theta = \\omega_{\\text{rel},n} \\Delta t = (200 \\text{ rad/s}) \\times (1.0 \\times 10^{-4} \\text{ s}) = 0.02 \\text{ rad}$$\n\nWe now determine the trial elastic tangential displacement, $\\boldsymbol{s}_t^{\\text{trial}}$. We define an orthonormal basis $(\\boldsymbol{t}_1, \\boldsymbol{t}_2)$ in the contact plane. The initial tangential displacement vector is $\\boldsymbol{s}_t^n = s_0 \\boldsymbol{t}_1$, where $s_0 = 1.0 \\times 10^{-4}$ m. Its rotation by $\\theta$ is $\\mathbf{R}(\\theta)\\boldsymbol{s}_t^n = (s_0 \\cos\\theta) \\boldsymbol{t}_1 + (s_0 \\sin\\theta) \\boldsymbol{t}_2$. The relative translational displacement increment is $\\Delta \\boldsymbol{u}_t = \\Delta u \\, \\boldsymbol{t}_1$, with $\\Delta u = 3.0 \\times 10^{-5}$ m.\n\nThe trial displacement is the sum:\n$$\\boldsymbol{s}_t^{\\text{trial}} = \\mathbf{R}(\\theta) \\, \\boldsymbol{s}_t^n + \\Delta \\boldsymbol{u}_t = ((s_0 \\cos\\theta) + \\Delta u) \\boldsymbol{t}_1 + (s_0 \\sin\\theta) \\boldsymbol{t}_2$$\n\nTo check the friction criterion, we need the magnitude of $\\boldsymbol{s}_t^{\\text{trial}}$, which is $\\|\\boldsymbol{s}_t^{\\text{trial}}\\| = \\sqrt{((s_0 \\cos\\theta) + \\Delta u)^2 + (s_0 \\sin\\theta)^2}$. Expanding this expression:\n$$\n\\begin{aligned}\n\\|\\boldsymbol{s}_t^{\\text{trial}}\\|^2 = (s_0^2 \\cos^2\\theta + 2 s_0 \\Delta u \\cos\\theta + (\\Delta u)^2) + (s_0^2 \\sin^2\\theta) \\\\\n= s_0^2 (\\cos^2\\theta + \\sin^2\\theta) + (\\Delta u)^2 + 2 s_0 \\Delta u \\cos\\theta \\\\\n= s_0^2 + (\\Delta u)^2 + 2 s_0 \\Delta u \\cos\\theta\n\\end{aligned}\n$$\nSubstituting the numerical values:\n$$\n\\begin{aligned}\n\\|\\boldsymbol{s}_t^{\\text{trial}}\\|^2 = (1.0 \\times 10^{-4})^2 + (3.0 \\times 10^{-5})^2 + 2(1.0 \\times 10^{-4})(3.0 \\times 10^{-5})\\cos(0.02) \\\\\n= 1.0 \\times 10^{-8} + 0.09 \\times 10^{-8} + (0.6 \\times 10^{-8}) \\cos(0.02) \\\\\n= (1.09 + 0.6 \\cos(0.02)) \\times 10^{-8} \\text{ m}^2 \\\\\n\\approx (1.09 + 0.6 \\times 0.9998000067) \\times 10^{-8} \\text{ m}^2 \\\\\n\\approx 1.689880004 \\times 10^{-8} \\text{ m}^2\n\\end{aligned}\n$$\nTaking the square root gives the magnitude of the trial displacement:\n$$\\|\\boldsymbol{s}_t^{\\text{trial}}\\| \\approx \\sqrt{1.689880004 \\times 10^{-8}} \\text{ m} \\approx 1.2999538 \\times 10^{-4} \\text{ m}$$\n\nThe magnitude of the trial tangential force, $\\|\\boldsymbol{f}_t^{\\text{trial}}\\|$, is:\n$$\\|\\boldsymbol{f}_t^{\\text{trial}}\\| = k_t \\|\\boldsymbol{s}_t^{\\text{trial}}\\| \\approx (5.0 \\times 10^4 \\text{ N/m}) \\times (1.2999538 \\times 10^{-4} \\text{ m}) \\approx 6.499769 \\text{ N}$$\n\nWe now compare the trial force magnitude with the yield force:\n$$\\|\\boldsymbol{f}_t^{\\text{trial}}\\| \\approx 6.499769 \\text{ N} > f_{\\text{yield}} = 4.8 \\text{ N}$$\nSince the trial force exceeds the friction limit, the contact is sliding. Therefore, the binary indicator is $s=1$.\n\nFor a sliding contact, the magnitude of the tangential force is capped at the yield value:\n$$\\|\\boldsymbol{f}_t\\| = f_{\\text{yield}} = 4.8 \\text{ N}$$\n\nFinally, we compute the magnitude of the torque, $\\tau_A$, on particle $A$ about its center:\n$$\\tau_A = R_A \\|\\boldsymbol{f}_t\\| = (0.05 \\text{ m}) \\times (4.8 \\text{ N}) = 0.24 \\text{ N·m}$$\n\nThe required quantities, with the first two rounded to four significant figures, are:\n- Magnitude of the tangential force: $\\|\\boldsymbol{f}_t\\| = 4.800 \\text{ N}$\n- Magnitude of the torque: $\\tau_A = 0.2400 \\text{ N·m}$\n- Sliding indicator: $s = 1$\n\nThese values are presented in the requested matrix format.", "answer": "$$ \\boxed{ \\begin{pmatrix} 4.800  0.2400  1 \\end{pmatrix} } $$", "id": "3518796"}, {"introduction": "The ultimate goal of many DEM simulations is to predict macroscopic mechanical behavior from particle-scale interactions. This practice bridges that micro-macro gap by introducing the concept of stress homogenization. You will use the fundamental Love-Weber formula to calculate the average stress tensor from a given set of contact forces and then verify the physical consistency of the entire simulation by checking for global force equilibrium. [@problem_id:3518737]", "problem": "Consider a three-dimensional granular assembly modeled with the Discrete Element Method (DEM). The domain is a rectangular box of dimensions $L_x$, $L_y$, $L_z$ (in $\\mathrm{m}$), containing a set of discrete contacts. Each contact $c$ is characterized by a contact force vector $\\mathbf{f}_c$ (in $\\mathrm{N}$) acting on a particle and a branch vector $\\mathbf{l}_c$ (in $\\mathrm{m}$) measured from the particle center to the contact point. Assume quasi-static equilibrium with possible body force due to gravity represented as a total gravity force vector $\\mathbf{W}$ (in $\\mathrm{N}$), acting on the particles. The box has six planar walls orthogonal to the coordinate axes; the walls exert forces on the particles denoted by $\\mathbf{F}_{x+}$, $\\mathbf{F}_{x-}$, $\\mathbf{F}_{y+}$, $\\mathbf{F}_{y-}$, $\\mathbf{F}_{z+}$, $\\mathbf{F}_{z-}$ (all in $\\mathrm{N}$). The unit inward normals to the internal volume for the faces are $\\mathbf{n}_{x+} = (-1,0,0)$, $\\mathbf{n}_{x-} = (1,0,0)$, $\\mathbf{n}_{y+} = (0,-1,0)$, $\\mathbf{n}_{y-} = (0,1,0)$, $\\mathbf{n}_{z+} = (0,0,-1)$, $\\mathbf{n}_{z-} = (0,0,1)$.\n\nStarting from fundamental principles, use Newton’s laws and the Love–Weber micromechanical definition of the macroscopic Cauchy stress tensor to compute the mean stress $p$ (compression taken as positive) from the contact data. Specifically, the macroscopic stress tensor $\\boldsymbol{\\sigma}$ is defined by\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{V} \\sum_{c} \\mathbf{f}_c \\otimes \\mathbf{l}_c,\n$$\nwhere $V = L_x L_y L_z$ is the control volume in $\\mathrm{m}^3$, and $\\otimes$ denotes the dyadic (outer) product. Adopt the geomechanics sign convention that the mean stress is\n$$\np = -\\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma}),\n$$\nso that hydrostatic compression yields $p  0$.\n\nTo verify consistency with boundary reactions and gravity, perform the following checks:\n- Compute the face pressures from wall forces as\n$$\np_{x+} = \\frac{\\mathbf{F}_{x+} \\cdot \\mathbf{n}_{x+}}{A_{x}},\\quad p_{x-} = \\frac{\\mathbf{F}_{x-} \\cdot \\mathbf{n}_{x-}}{A_{x}},\\quad\np_{y+} = \\frac{\\mathbf{F}_{y+} \\cdot \\mathbf{n}_{y+}}{A_{y}},\\quad p_{y-} = \\frac{\\mathbf{F}_{y-} \\cdot \\mathbf{n}_{y-}}{A_{y}},\\quad\np_{z+} = \\frac{\\mathbf{F}_{z+} \\cdot \\mathbf{n}_{z+}}{A_{z}},\\quad p_{z-} = \\frac{\\mathbf{F}_{z-} \\cdot \\mathbf{n}_{z-}}{A_{z}},\n$$\nwith $A_x = L_y L_z$, $A_y = L_x L_z$, $A_z = L_x L_y$ in $\\mathrm{m}^2$. Define the average wall pressure\n$$\n\\overline{p}_\\mathrm{wall} = \\frac{1}{6}\\left(p_{x+} + p_{x-} + p_{y+} + p_{y-} + p_{z+} + p_{z-}\\right).\n$$\n- Check global force balance at equilibrium using Newton's second law (static case), requiring\n$$\n\\mathbf{F}_{x+} + \\mathbf{F}_{x-} + \\mathbf{F}_{y+} + \\mathbf{F}_{y-} + \\mathbf{F}_{z+} + \\mathbf{F}_{z-} + \\mathbf{W} = \\mathbf{0}.\n$$\n\nYou must:\n- Compute $p$ from the contact data in $\\mathrm{Pa}$.\n- Verify that $|p - \\overline{p}_\\mathrm{wall}| \\le \\tau_p$ (in $\\mathrm{Pa}$), where $\\tau_p$ is a prescribed tolerance.\n- Verify that the Euclidean norm of the residual external force $\\left\\|\\mathbf{F}_{x+} + \\mathbf{F}_{x-} + \\mathbf{F}_{y+} + \\mathbf{F}_{y-} + \\mathbf{F}_{z+} + \\mathbf{F}_{z-} + \\mathbf{W}\\right\\|_2 \\le \\tau_f$ (in $\\mathrm{N}$), where $\\tau_f$ is a prescribed tolerance.\n\nExpress $p$ in $\\mathrm{Pa}$ as a floating-point number. For each test case, output a two-element list $[p, \\mathrm{check}]$, where $\\mathrm{check}$ is a boolean that is true if and only if both verifications pass.\n\nTest suite. Use the following three cases. All vectors are ordered as $(x,y,z)$. All forces are the forces exerted by the walls on the particles. Angles are not involved. No percentages are involved.\n- Case A (happy path, zero gravity):\n  - Dimensions: $L_x = 1$, $L_y = 1$, $L_z = 1$ (all in $\\mathrm{m}$), so $V = 1$.\n  - Contacts (six contacts):\n    - $\\mathbf{f}_1 = (-1000,0,0)$, $\\mathbf{l}_1 = (0.5,0,0)$.\n    - $\\mathbf{f}_2 = (1000,0,0)$, $\\mathbf{l}_2 = (-0.5,0,0)$.\n    - $\\mathbf{f}_3 = (0,-1000,0)$, $\\mathbf{l}_3 = (0,0.5,0)$.\n    - $\\mathbf{f}_4 = (0,1000,0)$, $\\mathbf{l}_4 = (0,-0.5,0)$.\n    - $\\mathbf{f}_5 = (0,0,-1000)$, $\\mathbf{l}_5 = (0,0,0.5)$.\n    - $\\mathbf{f}_6 = (0,0,1000)$, $\\mathbf{l}_6 = (0,0,-0.5)$.\n  - Wall forces:\n    - $\\mathbf{F}_{x+} = (-1000,0,0)$, $\\mathbf{F}_{x-} = (1000,0,0)$.\n    - $\\mathbf{F}_{y+} = (0,-1000,0)$, $\\mathbf{F}_{y-} = (0,1000,0)$.\n    - $\\mathbf{F}_{z+} = (0,0,-1000)$, $\\mathbf{F}_{z-} = (0,0,1000)$.\n  - Gravity: $\\mathbf{W} = (0,0,0)$.\n  - Tolerances: $\\tau_p = 10^{-8}$, $\\tau_f = 10^{-8}$.\n- Case B (happy path, nonzero gravity, rectangular box):\n  - Dimensions: $L_x = 2$, $L_y = 1$, $L_z = 1$ (in $\\mathrm{m}$), so $V = 2$.\n  - Contacts (six contacts):\n    - $\\mathbf{f}_1 = (-500,0,0)$, $\\mathbf{l}_1 = (1.0,0,0)$.\n    - $\\mathbf{f}_2 = (500,0,0)$, $\\mathbf{l}_2 = (-1.0,0,0)$.\n    - $\\mathbf{f}_3 = (0,-1000,0)$, $\\mathbf{l}_3 = (0,0.5,0)$.\n    - $\\mathbf{f}_4 = (0,1000,0)$, $\\mathbf{l}_4 = (0,-0.5,0)$.\n    - $\\mathbf{f}_5 = (0,0,-1000)$, $\\mathbf{l}_5 = (0,0,0.5)$.\n    - $\\mathbf{f}_6 = (0,0,1000)$, $\\mathbf{l}_6 = (0,0,-0.5)$.\n  - Wall forces:\n    - $\\mathbf{F}_{x+} = (-500,0,0)$, $\\mathbf{F}_{x-} = (500,0,0)$.\n    - $\\mathbf{F}_{y+} = (0,-1000,0)$, $\\mathbf{F}_{y-} = (0,1000,0)$.\n    - $\\mathbf{F}_{z+} = (0,0,-995)$, $\\mathbf{F}_{z-} = (0,0,1005)$.\n  - Gravity: $\\mathbf{W} = (0,0,-10)$.\n  - Tolerances: $\\tau_p = 10^{-8}$, $\\tau_f = 10^{-8}$.\n- Case C (edge case, intentionally inconsistent walls; zero gravity):\n  - Dimensions: $L_x = 1$, $L_y = 1$, $L_z = 1$ (in $\\mathrm{m}$), so $V = 1$.\n  - Contacts (six contacts):\n    - $\\mathbf{f}_1 = (-500,0,0)$, $\\mathbf{l}_1 = (0.5,0,0)$.\n    - $\\mathbf{f}_2 = (500,0,0)$, $\\mathbf{l}_2 = (-0.5,0,0)$.\n    - $\\mathbf{f}_3 = (0,-500,0)$, $\\mathbf{l}_3 = (0,0.5,0)$.\n    - $\\mathbf{f}_4 = (0,500,0)$, $\\mathbf{l}_4 = (0,-0.5,0)$.\n    - $\\mathbf{f}_5 = (0,0,-500)$, $\\mathbf{l}_5 = (0,0,0.5)$.\n    - $\\mathbf{f}_6 = (0,0,500)$, $\\mathbf{l}_6 = (0,0,-0.5)$.\n  - Wall forces:\n    - $\\mathbf{F}_{x+} = (-500,0,0)$, $\\mathbf{F}_{x-} = (500,0,0)$.\n    - $\\mathbf{F}_{y+} = (0,-500,0)$, $\\mathbf{F}_{y-} = (0,500,0)$.\n    - $\\mathbf{F}_{z+} = (0,0,-480)$, $\\mathbf{F}_{z-} = (0,0,480)$.\n  - Gravity: $\\mathbf{W} = (0,0,0)$.\n  - Tolerances: $\\tau_p = 10^{-8}$, $\\tau_f = 10^{-8}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list $[p,\\mathrm{check}]$ with $p$ in $\\mathrm{Pa}$ and $\\mathrm{check}$ a boolean. For example, the output format must be of the form $[[p_A,\\mathrm{check}_A],[p_B,\\mathrm{check}_B],[p_C,\\mathrm{check}_C]]$.", "solution": "The problem requires the calculation of the mean stress in a three-dimensional granular assembly and the verification of this result against boundary conditions and global equilibrium. The analysis is founded on the principles of computational geomechanics, specifically the Discrete Element Method (DEM).\n\nFirst, we address the computation of the mean stress, $p$. The macroscopic Cauchy stress tensor, $\\boldsymbol{\\sigma}$, for a granular medium is given by the Love-Weber formula, which homogenizes the discrete contact forces over a representative volume, $V$. The formula is:\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{V} \\sum_{c} \\mathbf{f}_c \\otimes \\mathbf{l}_c\n$$\nIn this expression, the sum is over all contacts $c$ within the volume $V = L_x L_y L_z$. For each contact, $\\mathbf{f}_c$ is the force vector acting on a particle, and $\\mathbf{l}_c$ is the corresponding branch vector from the particle's center to the point of contact. The symbol $\\otimes$ denotes the dyadic or outer product. For vectors $\\mathbf{a} = (a_1, a_2, a_3)$ and $\\mathbf{b} = (b_1, b_2, b_3)$, their dyadic product is a second-order tensor (a $3 \\times 3$ matrix):\n$$\n\\mathbf{a} \\otimes \\mathbf{b} =\n\\begin{pmatrix}\na_1 b_1  a_1 b_2  a_1 b_3 \\\\\na_2 b_1  a_2 b_2  a_2 b_3 \\\\\na_3 b_1  a_3 b_2  a_3 b_3\n\\end{pmatrix}\n$$\nThe components of the stress tensor $\\boldsymbol{\\sigma}$ are therefore given by:\n$$\n\\sigma_{ij} = \\frac{1}{V} \\sum_{c} f_{c,i} l_{c,j}\n$$\nwhere $i, j \\in \\{x, y, z\\}$. The mean stress, $p$, is defined using the geomechanics sign convention (compression positive) as one-third of the negative trace of the stress tensor:\n$$\np = -\\frac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}) = -\\frac{1}{3} (\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz})\n$$\nThe trace of $\\boldsymbol{\\sigma}$ can be expressed as:\n$$\n\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz} = \\frac{1}{V} \\sum_{c} (f_{c,x}l_{c,x} + f_{c,y}l_{c,y} + f_{c,z}l_{c,z})\n$$\nThis sum is simply the sum of the dot products of the force and branch vectors.\n$$\n\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{V} \\sum_{c} \\mathbf{f}_c \\cdot \\mathbf{l}_c\n$$\nThus, the formula for the mean stress becomes:\n$$\np = -\\frac{1}{3V} \\sum_{c} \\mathbf{f}_c \\cdot \\mathbf{l}_c\n$$\nThis equation provides a direct method to compute $p$ from the provided contact data. The result will be in Pascals ($\\mathrm{Pa}$), since forces are in Newtons ($\\mathrm{N}$), lengths in meters ($\\mathrm{m}$), and volume in cubic meters ($\\mathrm{m}^3$), giving units of $\\mathrm{N}/\\mathrm{m}^2$.\n\nNext, we perform two verification checks to ensure the consistency of the simulation data.\n\nThe first check is the global force balance. For a system in quasi-static equilibrium, Newton's second law dictates that the vector sum of all external forces must be zero. The external forces acting on the granular assembly are the reaction forces from the six boundary walls ($\\mathbf{F}_{x+}$, $\\mathbf{F}_{x-}$, etc.) and the total body force due to gravity ($\\mathbf{W}$). The equilibrium condition is:\n$$\n\\sum \\mathbf{F}_{\\mathrm{ext}} = \\mathbf{F}_{x+} + \\mathbf{F}_{x-} + \\mathbf{F}_{y+} + \\mathbf{F}_{y-} + \\mathbf{F}_{z+} + \\mathbf{F}_{z-} + \\mathbf{W} = \\mathbf{0}\n$$\nDue to numerical precision limits, this sum may not be exactly zero. Therefore, we verify that the Euclidean norm of the residual force vector is less than or equal to a prescribed tolerance, $\\tau_f$:\n$$\n\\left\\| \\sum \\mathbf{F}_{\\mathrm{ext}} \\right\\|_2 \\le \\tau_f\n$$\n\nThe second check verifies the consistency between the internally computed mean stress $p$ and the pressures exerted by the walls. The pressure on each face is the normal component of the total force on that face divided by its area. For example, the pressure on the face at the positive $x$ boundary is:\n$$\np_{x+} = \\frac{\\mathbf{F}_{x+} \\cdot \\mathbf{n}_{x+}}{A_{x}}\n$$\nwhere $\\mathbf{F}_{x+}$ is the force exerted by the wall on the particles, $\\mathbf{n}_{x+} = (-1,0,0)$ is the inward-pointing unit normal vector for that face, and $A_x = L_y L_z$ is the face area. This definition ensures that compressive forces yield positive pressures. We compute the six face pressures ($p_{x+}$, $p_{x-}$, $p_{y+}$, $p_{y-}$, $p_{z+}$, $p_{z-}$) and then their arithmetic mean, the average wall pressure $\\overline{p}_\\mathrm{wall}$:\n$$\n\\overline{p}_\\mathrm{wall} = \\frac{1}{6}\\left(p_{x+} + p_{x-} + p_{y+} + p_{y-} + p_{z+} + p_{z-}\\right)\n$$\nFor a homogeneous stress state in the absence of body forces, the principle of virtual work implies that the micromechanical mean stress $p$ should be equal to the average wall pressure $\\overline{p}_\\mathrm{wall}$. Even with body forces or stress gradients, this relationship often holds approximately. The verification requires checking if the absolute difference between these two quantities is within a specified tolerance $\\tau_p$:\n$$\n|p - \\overline{p}_\\mathrm{wall}| \\le \\tau_p\n$$\n\nA final boolean check result, $\\mathrm{check}$, is determined by the logical conjunction of the outcomes of these two verification steps. It is `true` if and only if both the force balance and pressure consistency checks pass. The calculations are then performed for each test case provided.", "answer": "$$ \\boxed{[[1000.0, True], [500.0, True], [500.0, False]]} $$", "id": "3518737"}]}