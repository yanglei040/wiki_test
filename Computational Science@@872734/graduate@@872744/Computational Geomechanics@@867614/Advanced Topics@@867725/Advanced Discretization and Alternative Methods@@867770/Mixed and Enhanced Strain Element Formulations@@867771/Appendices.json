{"hands_on_practices": [{"introduction": "Volumetric locking is a primary challenge in simulating near-incompressible materials like saturated clays or rubbers, where standard finite elements can become artificially stiff and produce inaccurate results. This practice provides a direct and quantitative look at the root cause of this numerical artifact. By analytically calculating the spurious strain energy generated by a standard bilinear element for a specific deformation mode, you will see precisely how locking manifests and why methods that modify the volumetric strain field, such as the $\\bar{B}$ or EAS approaches, are essential for obtaining physically meaningful solutions [@problem_id:3543469].", "problem": "Consider a two-dimensional bilinear quadrilateral finite element occupying the square region $\\{(x,y)\\,|\\,0 \\le x \\le L,\\,0 \\le y \\le L\\}$ under the plane strain assumption. The material is isotropic, linear elastic, and nearly incompressible, characterized by the Lamé parameters $\\lambda$ and $\\mu$ with small-strain kinematics. A displacement field consistent with the element’s bilinear interpolation is imposed:\n$$u_{x}(x,y) = \\gamma x y,\\qquad u_{y}(x,y) = -\\gamma x y,$$\nwhere $\\gamma$ is a constant amplitude. This kinematic mode has spatially varying dilatation that integrates to zero over the element, a situation in which a purely displacement-based formulation is known to exhibit volumetric locking while a mixed or enhanced strain formulation mitigates it.\n\nStarting from the fundamental definitions of small-strain kinematics and the linear elastic constitutive law, and using the strain energy density definition $W$ derived from these principles, compute the element-level volumetric internal energy difference $\\Delta E_{\\mathrm{vol}}$ between:\n- the standard displacement-based formulation (which penalizes the pointwise volumetric strain), and\n- the volumetric mitigation obtained by the Enhanced Assumed Strain (EAS) or $\\bar{B}$ method (which replaces the volumetric strain by its element-wise average before forming the volumetric contribution to $W$).\n\nAssume the mitigation modifies only the volumetric part of $W$ and leaves the deviatoric part unchanged. Express $\\Delta E_{\\mathrm{vol}}$ as a single closed-form analytic expression in terms of $\\lambda$, $\\gamma$, and $L$. Do not include units in your final answer. No numerical evaluation or rounding is required.", "solution": "The user wants to compute the difference in volumetric internal energy, $\\Delta E_{vol}$, between a standard displacement-based formulation and a mixed formulation ($\\bar{B}$ or EAS) for a specific case.\n\n### Step 1: Extract Givens\n- **Element Geometry**: A two-dimensional bilinear quadrilateral finite element occupying the square region $\\{(x,y)\\,|\\,0 \\le x \\le L,\\,0 \\le y \\le L\\}$.\n- **Physical Assumption**: Plane strain.\n- **Material Properties**: Isotropic, linear elastic, and nearly incompressible, characterized by Lamé parameters $\\lambda$ and $\\mu$.\n- **Kinematics**: Small-strain.\n- **Displacement Field**: $u_{x}(x,y) = \\gamma x y$, $u_{y}(x,y) = -\\gamma x y$, where $\\gamma$ is a constant.\n- **Formulation Definitions**:\n    - **Standard Displacement-Based Formulation**: Penalizes the pointwise volumetric strain.\n    - **Mitigated Formulation (EAS/$\\bar{B}$)**: Replaces the volumetric strain with its element-wise average. This modification applies only to the volumetric part of the strain energy density, $W$.\n- **Quantity to Compute**: The element-level volumetric internal energy difference, $\\Delta E_{\\mathrm{vol}}$, between the two formulations, expressed in terms of $\\lambda$, $\\gamma$, and $L$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in the theory of solid mechanics and the finite element method. It addresses the well-known phenomenon of volumetric locking in nearly incompressible materials and standard mitigation techniques like the $\\bar{B}$ method or Enhanced Assumed Strain (EAS) methods. All concepts (plane strain, Lamé parameters, strain energy, bilinear elements) are standard in the field.\n- **Well-Posed**: The problem is well-posed. The geometry, material behavior, and kinematic field are explicitly defined. The quantities to be calculated are clearly specified, and a unique solution can be determined from the given information.\n- **Objective**: The problem statement is written in precise, objective, and formal language, free of any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, solvable problem in computational mechanics. I will proceed with the solution.\n\n***\n\nThe solution proceeds by first deriving the strain field from the given displacement field. Then, the volumetric strain energy is computed for both the standard and the mitigated formulations. The difference between these two energies provides the final answer.\n\n**1. Strain Field Computation**\n\nThe small-strain tensor components, $\\epsilon_{ij}$, are derived from the given displacement field $\\mathbf{u} = (u_x, u_y)$. For a 2D problem, the relevant components are:\n$$ \\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} $$\n$$ \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} $$\n$$ \\gamma_{xy} = 2\\epsilon_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} $$\n\nSubstituting the given displacement field, $u_{x}(x,y) = \\gamma x y$ and $u_{y}(x,y) = -\\gamma x y$:\n$$ \\epsilon_{xx}(x,y) = \\frac{\\partial}{\\partial x}(\\gamma x y) = \\gamma y $$\n$$ \\epsilon_{yy}(x,y) = \\frac{\\partial}{\\partial y}(-\\gamma x y) = -\\gamma x $$\n$$ \\gamma_{xy}(x,y) = \\frac{\\partial}{\\partial y}(\\gamma x y) + \\frac{\\partial}{\\partial x}(-\\gamma x y) = \\gamma x - \\gamma y = \\gamma(x - y) $$\n\nThe volumetric strain, or dilatation, $\\epsilon_v$, is the trace of the strain tensor. For a 2D plane strain case, this is defined as:\n$$ \\epsilon_v(x,y) = \\epsilon_{xx}(x,y) + \\epsilon_{yy}(x,y) = \\gamma y - \\gamma x = \\gamma(y-x) $$\nThis shows that the volumetric strain varies linearly across the element.\n\n**2. Volumetric Strain Energy in the Standard Formulation**\n\nFor an isotropic linear elastic material, the strain energy density, $W$, can be decomposed into volumetric and deviatoric parts. The volumetric part, which is penalized in the standard formulation for nearly incompressible materials, is given by:\n$$ W_{\\mathrm{vol}} = \\frac{1}{2} \\lambda \\epsilon_v^2 $$\nwhere $\\lambda$ is the Lamé first parameter, which becomes very large for nearly incompressible materials, thus penalizing non-zero volumetric strains.\n\nThe total volumetric internal energy for the standard formulation, $E_{\\mathrm{vol}}^{\\mathrm{std}}$, is the integral of the volumetric strain energy density over the element's area, $A$:\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\int_A W_{\\mathrm{vol}}(x,y) \\,dA = \\int_0^L \\int_0^L \\frac{1}{2} \\lambda [\\epsilon_v(x,y)]^2 \\,dx\\,dy $$\nSubstituting $\\epsilon_v(x,y) = \\gamma(y-x)$:\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\frac{1}{2} \\lambda \\gamma^2 \\int_0^L \\int_0^L (y-x)^2 \\,dx\\,dy $$\nWe evaluate the double integral:\n$$ \\int_0^L \\int_0^L (y-x)^2 \\,dx\\,dy = \\int_0^L \\int_0^L (y^2 - 2xy + x^2) \\,dx\\,dy $$\nFirst, integrate with respect to $x$:\n$$ \\int_0^L (y^2 - 2xy + x^2) \\,dx = \\left[ y^2x - x^2y + \\frac{x^3}{3} \\right]_0^L = Ly^2 - L^2y + \\frac{L^3}{3} $$\nNext, integrate the result with respect to $y$:\n$$ \\int_0^L \\left( Ly^2 - L^2y + \\frac{L^3}{3} \\right) \\,dy = \\left[ \\frac{Ly^3}{3} - \\frac{L^2y^2}{2} + \\frac{L^3y}{3} \\right]_0^L = \\frac{L^4}{3} - \\frac{L^4}{2} + \\frac{L^4}{3} = \\frac{2L^4}{3} - \\frac{L^4}{2} = \\frac{L^4}{6} $$\nSubstituting this result back into the expression for $E_{\\mathrm{vol}}^{\\mathrm{std}}$:\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\frac{1}{2} \\lambda \\gamma^2 \\left( \\frac{L^4}{6} \\right) = \\frac{\\lambda\\gamma^2L^4}{12} $$\n\n**3. Volumetric Strain Energy in the Mitigated Formulation**\n\nThe EAS or $\\bar{B}$ method mitigates volumetric locking by replacing the pointwise volumetric strain $\\epsilon_v$ with its element-wise average, $\\bar{\\epsilon}_v$, in the energy calculation.\n$$ \\bar{\\epsilon}_v = \\frac{1}{A} \\int_A \\epsilon_v(x,y) \\,dA $$\nThe area of the element is $A = L \\times L = L^2$.\n$$ \\bar{\\epsilon}_v = \\frac{1}{L^2} \\int_0^L \\int_0^L \\gamma(y-x) \\,dx\\,dy $$\nWe evaluate this integral:\n$$ \\int_0^L \\int_0^L \\gamma(y-x) \\,dx\\,dy = \\gamma \\int_0^L \\left[ yx - \\frac{x^2}{2} \\right]_0^L \\,dy = \\gamma \\int_0^L \\left( Ly - \\frac{L^2}{2} \\right) \\,dy $$\n$$ = \\gamma \\left[ \\frac{Ly^2}{2} - \\frac{L^2y}{2} \\right]_0^L = \\gamma \\left( \\frac{L^3}{2} - \\frac{L^3}{2} \\right) = 0 $$\nTherefore, the average volumetric strain for this specific deformation mode is zero:\n$$ \\bar{\\epsilon}_v = 0 $$\nThe volumetric strain energy density in the mitigated formulation is $W_{\\mathrm{vol}}^{\\mathrm{mit}} = \\frac{1}{2} \\lambda \\bar{\\epsilon}_v^2$. Since $\\bar{\\epsilon}_v = 0$, $W_{\\mathrm{vol}}^{\\mathrm{mit}} = 0$ throughout the element.\n\nThe total volumetric internal energy for the mitigated formulation, $E_{\\mathrm{vol}}^{\\mathrm{mit}}$, is:\n$$ E_{\\mathrm{vol}}^{\\mathrm{mit}} = \\int_A W_{\\mathrm{vol}}^{\\mathrm{mit}} \\,dA = \\int_A 0 \\,dA = 0 $$\n\n**4. Energy Difference Calculation**\n\nThe problem asks for the difference $\\Delta E_{\\mathrm{vol}}$ between the standard and mitigated volumetric internal energies.\n$$ \\Delta E_{\\mathrm{vol}} = E_{\\mathrm{vol}}^{\\mathrm{std}} - E_{\\mathrm{vol}}^{\\mathrm{mit}} $$\n$$ \\Delta E_{\\mathrm{vol}} = \\frac{\\lambda\\gamma^2L^4}{12} - 0 = \\frac{\\lambda\\gamma^2L^4}{12} $$\nThis result represents the spurious energy penalty that the standard displacement-based formulation assigns to a valid, zero-volume-change deformation mode, a characteristic symptom of volumetric locking. The mitigated formulation correctly assigns zero energy to this mode, thus avoiding locking.", "answer": "$$\\boxed{\\frac{\\lambda\\gamma^{2}L^{4}}{12}}$$", "id": "3543469"}, {"introduction": "Enhanced Assumed Strain (EAS) methods overcome locking by enriching the element's kinematics with internal \"bubble\" functions. This exercise guides you through the fundamental process of designing such an enrichment mode for a hexahedral element from scratch [@problem_id:3543518]. By constructing a function that is non-zero within the element but vanishes on its boundaries, you will gain a concrete understanding of how EAS formulations enhance strain representation locally while maintaining global compatibility.", "problem": "Consider a standard trilinear hexahedral element ($Q_1$) in isoparametric coordinates on the reference domain $\\widehat{\\Omega} = [-1,1]^3$ with local coordinates $(\\xi,\\eta,\\zeta)$. In mixed and Enhanced Assumed Strain (EAS) finite element formulations for computational geomechanics, displacement-based bubble enrichments are often introduced to improve performance while preserving conformity and avoiding spurious boundary contributions. Work on the reference element and use only the following fundamental facts: the principle of virtual work at the element level states that the external boundary virtual work term is an integral of the traction times the virtual displacement trace over the element boundary, and the trace of a function on the boundary controls whether it contributes to that boundary integral; an interior bubble enrichment should have zero trace on $\\partial\\widehat{\\Omega}$; and an $L^2$-normalization is defined by the square-integral of the function over $\\widehat{\\Omega}$. \n\nYour tasks are as follows. First, construct a single scalar bubble enrichment $\\widehat{b}(\\xi,\\eta,\\zeta)$ on $\\widehat{\\Omega}$ that is a lowest-degree nontrivial trivariate polynomial, separable in $(\\xi,\\eta,\\zeta)$, even in each coordinate, strictly positive in the open interior, and whose trace vanishes on $\\partial\\widehat{\\Omega}$. Justify that your choice satisfies these properties, and compute its gradient $\\nabla_{\\xi\\eta\\zeta}\\widehat{b}$. Then explain, using the element-level principle of virtual work and the trace property, why the added mode does not contribute to element boundary terms. Finally, introduce a positive normalization constant $\\alpha$ and define the normalized bubble $\\widehat{b}_N(\\xi,\\eta,\\zeta) = \\alpha\\,\\widehat{b}(\\xi,\\eta,\\zeta)$, and determine the unique positive $\\alpha$ such that\n$$\n\\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left(\\widehat{b}_N(\\xi,\\eta,\\zeta)\\right)^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta \\;=\\; 1.\n$$\nProvide your final answer for $\\alpha$ as a closed-form exact expression with no units. Do not round.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is a standard problem in the context of finite element theory, specifically concerning the construction of enrichment functions for Enhanced Assumed Strain (EAS) methods. All required information is provided, and the problem is free of contradictions or ambiguities.\n\nThe problem is addressed in four parts as requested.\n\nFirst, we construct the scalar bubble enrichment $\\widehat{b}(\\xi,\\eta,\\zeta)$ on the reference domain $\\widehat{\\Omega} = [-1,1]^3$. The function must satisfy several properties:\n1.  **Trace vanishes on $\\partial\\widehat{\\Omega}$**: The boundary $\\partial\\widehat{\\Omega}$ of the cube consists of the planes where $\\xi = \\pm 1$, $\\eta = \\pm 1$, or $\\zeta = \\pm 1$. A function's trace vanishes on the boundary if the function evaluates to $0$ for any point on the boundary.\n2.  **Separable in $(\\xi,\\eta,\\zeta)$**: The function can be written as a product of three univariate functions, i.e., $\\widehat{b}(\\xi,\\eta,\\zeta) = f(\\xi)g(\\eta)h(\\zeta)$. For the trace of this product to be zero on $\\partial\\widehat{\\Omega}$, it is sufficient that each component function vanishes at the endpoints of its domain, i.e., $f(\\pm 1) = 0$, $g(\\pm 1) = 0$, and $h(\\pm 1) = 0$.\n3.  **Lowest-degree nontrivial trivariate polynomial**: To satisfy $f(\\pm 1) = 0$, the univariate polynomial $f(\\xi)$ must have roots at $\\xi=1$ and $\\xi=-1$. The lowest-degree non-trivial polynomial with these roots is a quadratic of the form $c(\\xi-1)(\\xi+1) = c(\\xi^2-1)$ for a non-zero constant $c$.\n4.  **Even in each coordinate**: The polynomial $\\xi^2-1$ is an even function of $\\xi$. To satisfy this property for $\\widehat{b}$, we choose $f$, $g$, and $h$ to be even functions. The form $c(\\xi^2-1)$ meets this requirement.\n5.  **Strictly positive in the open interior**: The interior of the domain is $(\\xi,\\eta,\\zeta) \\in (-1,1)^3$. For $\\xi \\in (-1,1)$, the term $\\xi^2-1$ is negative. To ensure the bubble function is positive in the interior, we can choose the univariate function to be $1-\\xi^2$, which is positive for $\\xi \\in (-1,1)$.\n\nCombining these requirements, the simplest separable polynomial that vanishes on all faces of the cube is the product of the simplest (quadratic) polynomials that vanish at the ends of each coordinate's interval. We define the function as:\n$$\n\\widehat{b}(\\xi,\\eta,\\zeta) = (1-\\xi^2)(1-\\eta^2)(1-\\zeta^2)\n$$\nThis function is a polynomial of degree $6$. As argued above, any separable polynomial $\\widehat{b}=fgh$ with a vanishing trace on $\\partial\\widehat{\\Omega}$ requires $f, g, h$ to be at least of degree $2$, making the total degree of $\\widehat{b}$ at least $6$. Therefore, our choice represents a lowest-degree polynomial satisfying all the stated conditions. It is even in each coordinate since each factor $(1-x^2)$ is even. It is strictly positive in the interior since each factor is strictly positive for coordinates in $(-1,1)$.\n\nSecond, we compute the gradient of $\\widehat{b}(\\xi,\\eta,\\zeta)$. Using the product rule for differentiation:\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\xi} = \\frac{\\partial}{\\partial\\xi}\\left[(1-\\xi^2)(1-\\eta^2)(1-\\zeta^2)\\right] = (-2\\xi)(1-\\eta^2)(1-\\zeta^2)\n$$\nBy symmetry, the other partial derivatives are:\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\eta} = (-2\\eta)(1-\\xi^2)(1-\\zeta^2)\n$$\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\zeta} = (-2\\zeta)(1-\\xi^2)(1-\\eta^2)\n$$\nThe gradient vector is therefore:\n$$\n\\nabla_{\\xi\\eta\\zeta}\\widehat{b} = \\begin{pmatrix} -2\\xi(1-\\eta^2)(1-\\zeta^2) \\\\ -2\\eta(1-\\xi^2)(1-\\zeta^2) \\\\ -2\\zeta(1-\\xi^2)(1-\\eta^2) \\end{pmatrix}\n$$\n\nThird, we explain why this bubble mode does not contribute to the element boundary virtual work. The principle of virtual work states that the virtual work done by external tractions $\\mathbf{t}$ on an element boundary $\\partial\\Omega_e$ is given by the integral $W_{ext}^{bnd} = \\int_{\\partial\\Omega_e} \\mathbf{t}\\cdot\\delta\\mathbf{u}\\,\\mathrm{d}S$, where $\\delta\\mathbf{u}$ is the virtual displacement field. An enhanced formulation adds an internal displacement mode based on the bubble function, so the virtual displacement can be written as $\\delta\\mathbf{u} = \\delta\\mathbf{u}_{std} + \\delta\\mathbf{u}_{bubble}$, where $\\delta\\mathbf{u}_{std}$ is the standard part from the nodal degrees of freedom and $\\delta\\mathbf{u}_{bubble}$ is the enrichment. For a vector displacement field, a typical enrichment is $\\delta\\mathbf{u}_{bubble} = \\widehat{b} \\delta\\mathbf{a}$, where $\\delta\\mathbf{a}$ is a vector of virtual coefficients. The contribution of the bubble mode to the boundary virtual work is $\\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\delta\\mathbf{u}_{bubble}\\,\\mathrm{d}S$. The isoparametric mapping relates the physical element boundary $\\partial\\Omega_e$ to the reference element boundary $\\partial\\widehat{\\Omega}$. By construction, the trace of our bubble function $\\widehat{b}$ is zero on $\\partial\\widehat{\\Omega}$. This means $\\widehat{b}(\\xi,\\eta,\\zeta)=0$ for any point $(\\xi,\\eta,\\zeta) \\in \\partial\\widehat{\\Omega}$. Consequently, the virtual displacement enrichment $\\delta\\mathbf{u}_{bubble}$ is identically zero on the physical element boundary $\\partial\\Omega_e$. Therefore, the integral evaluates to zero:\n$$\n\\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\delta\\mathbf{u}_{bubble}\\,\\mathrm{d}S = \\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\mathbf{0}\\,\\mathrm{d}S = 0\n$$\nThus, the added mode is a true \"bubble\" or \"internal\" mode that enhances the strain field inside the element but does not contribute to the work done on the boundary, preserving C0-continuity and not interfering with applied traction boundary conditions.\n\nFinally, we determine the positive normalization constant $\\alpha$ for the normalized bubble function $\\widehat{b}_N(\\xi,\\eta,\\zeta) = \\alpha\\,\\widehat{b}(\\xi,\\eta,\\zeta)$ such that its $L^2$-norm over the reference element is unity. The normalization condition is:\n$$\n\\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left(\\widehat{b}_N(\\xi,\\eta,\\zeta)\\right)^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta = 1\n$$\nSubstituting the expressions for $\\widehat{b}_N$ and $\\widehat{b}$:\n$$\n\\alpha^2 \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left[ (1-\\xi^2)(1-\\eta^2)(1-\\zeta^2) \\right]^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta = 1\n$$\nThe integral is separable:\n$$\n\\alpha^2 \\left(\\int_{-1}^{1} (1-\\xi^2)^2\\,\\mathrm{d}\\xi\\right) \\left(\\int_{-1}^{1} (1-\\eta^2)^2\\,\\mathrm{d}\\eta\\right) \\left(\\int_{-1}^{1} (1-\\zeta^2)^2\\,\\mathrm{d}\\zeta\\right) = 1\n$$\nLet $I = \\int_{-1}^{1} (1-x^2)^2\\,\\mathrm{d}x$. The equation becomes $\\alpha^2 I^3 = 1$. We first compute the value of $I$:\n$$\nI = \\int_{-1}^{1} (1 - 2x^2 + x^4)\\,\\mathrm{d}x\n$$\nSince the integrand is an even function, we can compute the integral as:\n$$\nI = 2 \\int_{0}^{1} (1 - 2x^2 + x^4)\\,\\mathrm{d}x = 2 \\left[ x - \\frac{2}{3}x^3 + \\frac{1}{5}x^5 \\right]_0^1\n$$\n$$\nI = 2 \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) = 2 \\left( \\frac{15-10+3}{15} \\right) = 2 \\left( \\frac{8}{15} \\right) = \\frac{16}{15}\n$$\nNow we solve for $\\alpha$. Since $\\alpha$ must be positive:\n$$\n\\alpha^2 \\left(\\frac{16}{15}\\right)^3 = 1 \\implies \\alpha = \\sqrt{\\left(\\frac{15}{16}\\right)^3} = \\left(\\frac{15}{16}\\right)^{3/2}\n$$\n$$\n\\alpha = \\frac{15^{3/2}}{16^{3/2}} = \\frac{15\\sqrt{15}}{(\\sqrt{16})^3} = \\frac{15\\sqrt{15}}{4^3} = \\frac{15\\sqrt{15}}{64}\n$$\nThis is the unique positive value for the normalization constant $\\alpha$.", "answer": "$$\\boxed{\\frac{15\\sqrt{15}}{64}}$$", "id": "3543518"}, {"introduction": "After deciding to use an enhanced formulation, a key choice is how to enforce the incompressibility constraint. This practice explores the numerical trade-offs between two dominant strategies: the mixed method, which uses a pressure Lagrange multiplier, and the penalty method. By analyzing a simplified algebraic system that models an EAS element, you will compare how each approach impacts solution accuracy and the conditioning of the system's tangent matrix, providing insight into the practical challenges of implementing these advanced formulations [@problem_id:3543495].", "problem": "Consider a single constant-volumetric-strain two-dimensional quadrilateral finite element under plane strain with an Enhanced Assumed Strain (EAS) volumetric mode. Let the geometric volumetric strain induced by nodal displacements be represented by a single scalar degree of freedom $\\epsilon$, and let the EAS volumetric mode be represented by a single internal scalar parameter $\\alpha$. Under the small-strain volumetric approximation, the Jacobian determinant of the deformation gradient satisfies $J \\approx 1 + \\epsilon + \\alpha$. Near-incompressibility is enforced either by a pressure Lagrange multiplier (mixed method) or by a penalty term. You will compare the weak enforcement of incompressibility via a pressure Lagrange multiplier with a penalty $\\frac{\\lambda}{2}(J-1)^2$, both in the presence of a volumetric EAS mode, and quantify differences in $J$ and in the condition numbers of the element-level tangent matrices.\n\nFundamental base:\n- The incompressibility constraint for finite strain is $\\det(\\mathbf{F}) = 1$. In the small-strain volumetric approximation appropriate for near-incompressible response with a constant volumetric mode, this is represented as $J - 1 \\approx \\epsilon + \\alpha$.\n- The stationary condition of the total potential energy yields the algebraic equilibrium (first-order optimality) conditions. The tangent matrices are the Hessians of the total potential with respect to the discrete unknowns.\n- Enhanced Assumed Strain (EAS) augments the strain field with internal parameters to improve stability and alleviate locking; here it is represented as a single internal mode $\\alpha$ with stabilization stiffness $k_{\\text{eas}}$.\n\nModel:\n- Let a volumetric load be imposed through a quadratic penalty on the deviation of the geometric volumetric strain $\\epsilon$ from a target $\\epsilon_0$, with stiffness $k_u > 0$: total energy contribution $\\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2$.\n- Let the EAS mode be stabilized by $\\frac{k_{\\text{eas}}}{2}\\alpha^2$ with $k_{\\text{eas}} > 0$.\n- Mixed formulation (pressure Lagrange multiplier): enforce $J-1 \\approx \\epsilon + \\alpha = 0$ via a pressure-like Lagrange multiplier $p$. The total energy is $\\Pi_{\\text{mix}}(\\epsilon,\\alpha,p) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + p(\\epsilon + \\alpha)$. The algebraic tangent matrix is the Hessian\n$$\n\\mathbf{K}_{\\text{mix}} = \n\\begin{bmatrix}\nk_u & 0 & 1 \\\\\n0 & k_{\\text{eas}} & 1 \\\\\n1 & 1 & 0\n\\end{bmatrix}\n$$\nwith respect to the ordering $[\\epsilon,\\alpha,p]$.\n- Penalty formulation: replace the Lagrange multiplier by a penalty term $\\frac{\\lambda}{2}(J-1)^2 \\approx \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2$, with $\\lambda > 0$. The total energy is $\\Pi_{\\text{pen}}(\\epsilon,\\alpha) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2$. The algebraic tangent matrix (Hessian) is\n$$\n\\mathbf{K}_{\\text{pen}} =\n\\begin{bmatrix}\nk_u + \\lambda & \\lambda \\\\\n\\lambda & k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n$$\nwith respect to the ordering $[\\epsilon,\\alpha]$.\n\nTasks:\n- For each specified parameter set $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda)$, compute:\n    1. The mixed solution $(\\epsilon_{\\text{mix}},\\alpha_{\\text{mix}},p_{\\text{mix}})$ by solving the first-order optimality conditions of $\\Pi_{\\text{mix}}$. Then compute $J_{\\text{mix}} \\approx 1 + \\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}}$.\n    2. The penalty solution $(\\epsilon_{\\text{pen}},\\alpha_{\\text{pen}})$ by solving the first-order optimality conditions of $\\Pi_{\\text{pen}}$. Then compute $J_{\\text{pen}} \\approx 1 + \\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}}$.\n    3. The absolute difference $|J_{\\text{pen}} - J_{\\text{mix}}|$.\n    4. The condition number (in the spectral $2$-norm) of $\\mathbf{K}_{\\text{pen}}$ and of $\\mathbf{K}_{\\text{mix}}$. Use singular-value-based condition numbers to handle indefiniteness in the mixed matrix. Both condition numbers are dimensionless.\n\n- Express all results as dimensionless floats. Angles are not involved.\n\nTest suite:\n- Case $1$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.02, 1000, 10, 10000)$.\n- Case $2$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.05, 500, 1000, 100)$.\n- Case $3$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.0, 200, 5, 1000000)$.\n- Case $4$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (-0.03, 1500, 50, 100000)$.\n- Case $5$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.02, 1000, 10000, 1)$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results aggregated across all test cases as a comma-separated flat list enclosed in square brackets. For each test case, append the three floats in the order $[|J_{\\text{pen}} - J_{\\text{mix}}|,\\ \\text{cond}(\\mathbf{K}_{\\text{pen}}),\\ \\text{cond}(\\mathbf{K}_{\\text{mix}})]$ to the output list. For example, the overall output format for $N$ cases is $[d_1,c_{\\text{pen},1},c_{\\text{mix},1},\\dots,d_N,c_{\\text{pen},N},c_{\\text{mix},N}]$.", "solution": "The problem requires a comparative analysis of two common methods for enforcing near-incompressibility in a simplified finite element context: a mixed formulation using a Lagrange multiplier and a penalty formulation. The analysis focuses on the resulting change in volume and the conditioning of the associated element-level tangent matrices. We will first derive the analytical solutions for the state variables for each formulation and then establish the expressions for the quantities to be computed.\n\nFirst, we analyze the mixed formulation. The total potential energy for the mixed formulation is given by\n$$\n\\Pi_{\\text{mix}}(\\epsilon,\\alpha,p) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + p(\\epsilon + \\alpha)\n$$\nwhere $\\epsilon$ is the geometric volumetric strain, $\\alpha$ is the enhanced assumed strain (EAS) mode, and $p$ is the pressure-like Lagrange multiplier. The parameters $k_u$ and $k_{\\text{eas}}$ are stiffness coefficients for the volumetric loading and EAS stabilization, respectively, and $\\epsilon_0$ is a target volumetric strain.\n\nThe equilibrium state $(\\epsilon_{\\text{mix}}, \\alpha_{\\text{mix}}, p_{\\text{mix}})$ is found at the stationary point of $\\Pi_{\\text{mix}}$, where the first partial derivatives with respect to all variables are zero.\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial \\epsilon} = k_u(\\epsilon - \\epsilon_0) + p = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial \\alpha} = k_{\\text{eas}}\\alpha + p = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial p} = \\epsilon + \\alpha = 0\n$$\nThis system of linear equations can be written in matrix form as:\n$$\n\\begin{bmatrix}\nk_u & 0 & 1 \\\\\n0 & k_{\\text{eas}} & 1 \\\\\n1 & 1 & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\epsilon \\\\\n\\alpha \\\\\np\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0 \\\\\n0\n\\end{bmatrix}\n$$\nFrom the third equation, we have $\\alpha = -\\epsilon$. Substituting this into the second equation yields $p = k_{\\text{eas}}\\epsilon$. Substituting both relations into the first equation gives:\n$$\nk_u(\\epsilon - \\epsilon_0) + k_{\\text{eas}}\\epsilon = 0 \\implies (k_u + k_{\\text{eas}})\\epsilon = k_u \\epsilon_0\n$$\nSolving for $\\epsilon_{\\text{mix}}$, $\\alpha_{\\text{mix}}$, and $p_{\\text{mix}}$ yields:\n$$\n\\epsilon_{\\text{mix}} = \\frac{k_u}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\n$$\n\\alpha_{\\text{mix}} = -\\epsilon_{\\text{mix}} = -\\frac{k_u}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\n$$\np_{\\text{mix}} = k_{\\text{eas}}\\epsilon_{\\text{mix}} = \\frac{k_u k_{\\text{eas}}}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\nThe Jacobian determinant approximation for the mixed formulation is $J_{\\text{mix}} \\approx 1 + \\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}}$. Since $\\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}} = 0$, the constraint is satisfied exactly, and thus $J_{\\text{mix}} = 1$. The tangent matrix is the Hessian, which for this linear system is the matrix of coefficients:\n$$\n\\mathbf{K}_{\\text{mix}} =\n\\begin{bmatrix}\nk_u & 0 & 1 \\\\\n0 & k_{\\text{eas}} & 1 \\\\\n1 & 1 & 0\n\\end{bmatrix}\n$$\n\nNext, we analyze the penalty formulation. The total potential energy is\n$$\n\\Pi_{\\text{pen}}(\\epsilon,\\alpha) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2\n$$\nwhere $\\lambda$ is the penalty parameter. The equilibrium state $(\\epsilon_{\\text{pen}}, \\alpha_{\\text{pen}})$ is found at the stationary point of $\\Pi_{\\text{pen}}$.\n$$\n\\frac{\\partial \\Pi_{\\text{pen}}}{\\partial \\epsilon} = k_u(\\epsilon - \\epsilon_0) + \\lambda(\\epsilon + \\alpha) = (k_u + \\lambda)\\epsilon + \\lambda\\alpha - k_u\\epsilon_0 = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{pen}}}{\\partial \\alpha} = k_{\\text{eas}}\\alpha + \\lambda(\\epsilon + \\alpha) = \\lambda\\epsilon + (k_{\\text{eas}} + \\lambda)\\alpha = 0\n$$\nThis system of equations is:\n$$\n\\begin{bmatrix}\nk_u + \\lambda & \\lambda \\\\\n\\lambda & k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n\\begin{bmatrix}\n\\epsilon \\\\\n\\alpha\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0\n\\end{bmatrix}\n$$\nSolving this $2 \\times 2$ system, for instance by inverting the matrix, yields the solution. The determinant of the matrix is $D = (k_u + \\lambda)(k_{\\text{eas}} + \\lambda) - \\lambda^2 = k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})$. The solution is:\n$$\n\\begin{bmatrix}\n\\epsilon_{\\text{pen}} \\\\\n\\alpha_{\\text{pen}}\n\\end{bmatrix}\n= \\frac{1}{D}\n\\begin{bmatrix}\nk_{\\text{eas}} + \\lambda & -\\lambda \\\\\n-\\lambda & k_u + \\lambda\n\\end{bmatrix}\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\frac{k_u(k_{\\text{eas}} + \\lambda)}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\\\\n\\frac{-k_u \\lambda}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n\\end{bmatrix}\n$$\nThe volumetric strain term in the Jacobian for the penalty method is:\n$$\n\\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}} = \\frac{k_u(k_{\\text{eas}} + \\lambda) - k_u \\lambda}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 = \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n$$\nThe Jacobian determinant approximation is then $J_{\\text{pen}} \\approx 1 + \\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}}$, so\n$$\nJ_{\\text{pen}} = 1 + \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n$$\nThe tangent matrix for the penalty formulation is the Hessian of $\\Pi_{\\text{pen}}$:\n$$\n\\mathbf{K}_{\\text{pen}} =\n\\begin{bmatrix}\nk_u + \\lambda & \\lambda \\\\\n\\lambda & k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n$$\n\nWe can now define the quantities to be computed for each parameter set $(\\epsilon_0, k_u, k_{\\text{eas}}, \\lambda)$.\n$1$. The absolute difference in the Jacobian determinants is:\n$$\n|J_{\\text{pen}} - J_{\\text{mix}}| = \\left| \\left(1 + \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\right) - 1 \\right| = \\left| \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\right|\n$$\n$2$. The condition number of $\\mathbf{K}_{\\text{pen}}$, denoted $\\text{cond}(\\mathbf{K}_{\\text{pen}})$, is computed using the spectral $2$-norm. As $\\mathbf{K}_{\\text{pen}}$ is symmetric positive-definite, this equals the ratio of its largest to its smallest eigenvalue, $\\lambda_{\\text{max}}/\\lambda_{\\text{min}}$.\n$3$. The condition number of $\\mathbf{K}_{\\text{mix}}$, denoted $\\text{cond}(\\mathbf{K}_{\\text{mix}})$, is computed based on its singular values as $\\sigma_{\\text{max}}/\\sigma_{\\text{min}}$, which is appropriate for the indefinite symmetric matrix $\\mathbf{K}_{\\text{mix}}$.\nThese quantities will be calculated programmatically for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem for a set of test cases.\n\n    For each case, it compares a mixed formulation and a penalty formulation\n    for enforcing near-incompressibility in a simplified finite element model.\n    It calculates the difference in the resulting volume change (Jacobian) and\n    the condition numbers of the respective tangent matrices.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (epsilon_0, k_u, k_eas, lambda)\n        (0.02, 1000, 10, 10000),      # Case 1\n        (0.05, 500, 1000, 100),       # Case 2\n        (0.0, 200, 5, 1000000),      # Case 3\n        (-0.03, 1500, 50, 100000),    # Case 4\n        (0.02, 1000, 10000, 1),       # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        epsilon_0, k_u, k_eas, lambd = case\n\n        # --- Mixed Formulation ---\n        # The Jacobian for the mixed formulation is exactly 1, as the constraint\n        # epsilon_mix + alpha_mix = 0 is enforced strongly by the Lagrange multiplier.\n        J_mix = 1.0\n\n        # --- Penalty Formulation ---\n        # Analytically derived solution for J_pen = 1 + epsilon_pen + alpha_pen\n        # This avoids numerical errors from solving the linear system.\n        vol_strain_pen_numerator = k_u * k_eas * epsilon_0\n        vol_strain_pen_denominator = k_u * k_eas + lambd * (k_u + k_eas)\n        \n        # Handle the case where the denominator might be zero, although constraints\n        # k_u > 0, k_eas > 0, lambda > 0 prevent this.\n        if vol_strain_pen_denominator == 0:\n            # This case is not expected under problem constraints\n            vol_strain_pen = 0.0\n        else:\n            vol_strain_pen = vol_strain_pen_numerator / vol_strain_pen_denominator\n            \n        J_pen = 1.0 + vol_strain_pen\n\n        # --- Task 1: Absolute difference in Jacobian ---\n        diff_J = np.abs(J_pen - J_mix)\n\n        # --- Task 2  3: Condition numbers ----\n        \n        # Tangent matrix for the mixed formulation\n        K_mix = np.array([\n            [k_u, 0.0, 1.0],\n            [0.0, k_eas, 1.0],\n            [1.0, 1.0, 0.0]\n        ], dtype=float)\n\n        # Tangent matrix for the penalty formulation\n        K_pen = np.array([\n            [k_u + lambd, lambd],\n            [lambd, k_eas + lambd]\n        ], dtype=float)\n\n        # Compute condition numbers using the 2-norm (spectral norm).\n        # np.linalg.cond uses SVD, which is appropriate for both matrices\n        # as per the problem description.\n        cond_mix = np.linalg.cond(K_mix)\n        cond_pen = np.linalg.cond(K_pen)\n        \n        # Append results for the current case\n        results.extend([diff_J, cond_pen, cond_mix])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3543495"}]}