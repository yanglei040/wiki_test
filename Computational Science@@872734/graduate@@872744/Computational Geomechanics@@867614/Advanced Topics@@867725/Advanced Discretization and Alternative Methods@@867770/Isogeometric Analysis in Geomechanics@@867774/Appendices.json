{"hands_on_practices": [{"introduction": "Isogeometric analysis is built upon the rich mathematical structure of B-spline and NURBS basis functions. A crucial skill for leveraging the full potential of IGA is the ability to manipulate this basis, for example, to increase the polynomial degree for $p$-refinement. This exercise provides hands-on practice with degree elevation, a fundamental algorithm that increases the dimension of the basis while preserving the exact geometric description. [@problem_id:3535326]", "problem": "Consider an isogeometric mapping used to describe a one-dimensional boundary curve in a plane-strain geomechanics model. The curve is represented by a clamped B-spline of degree $p=2$ on the parameter domain $[0,1]$ with the open knot vector $\\{0,0,0,1,1,1\\}$ and control points $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, $\\mathbf{P}_2=(2,0)$. Assume a non-rational setting with unit weights, so the mapping is\n$$\n\\mathbf{x}(u)=\\sum_{i=0}^{2} N_{i,2}(u)\\,\\mathbf{P}_i,\\quad u\\in[0,1],\n$$\nwhere $N_{i,2}(u)$ are the quadratic B-spline basis functions. Because the knot vector has a single nontrivial span, the basis reduces to the degree-$p$ Bernstein polynomials on $[0,1]$, and the curve is a single Bézier segment.\n\nPerform degree elevation from degree $p$ to degree $p+1$ to obtain a new control polygon $\\{\\mathbf{Q}_i\\}_{i=0}^{3}$ and a cubic mapping\n$$\n\\tilde{\\mathbf{x}}(u)=\\sum_{i=0}^{3} \\tilde{N}_{i,3}(u)\\,\\mathbf{Q}_i,\n$$\nwith the same clamped knot vector structure for a single span, so that the cubic basis reduces to the degree-$p+1$ Bernstein polynomials on $[0,1]$. Using only fundamental properties of B-spline/Bernstein bases (partition of unity, non-negativity, and linearity of the geometric map), derive the necessary relations to determine the elevated control points $\\{\\mathbf{Q}_i\\}$ such that the geometric mapping remains invariant, i.e., $\\tilde{\\mathbf{x}}(u)=\\mathbf{x}(u)$ for all $u\\in[0,1]$.\n\nThen evaluate both mappings at $u=\\tfrac{1}{2}$ and compute the Euclidean norm of their difference, that is,\n$$\n\\left\\|\\mathbf{x}\\!\\left(\\tfrac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\tfrac{1}{2}\\right)\\right\\|.\n$$\nReport this real number as your final answer. Assume all coordinates are dimensionless; report the final answer with no units. No rounding is required for the final answer.", "solution": "The problem requires the derivation of the degree elevation relations for a quadratic Bézier curve and the subsequent calculation of the norm of the difference between the original and elevated curve mappings at a specific parameter value.\n\nThe initial curve is a quadratic B-spline with a knot vector $\\{0,0,0,1,1,1\\}$. This configuration, with multiplicity $p+1=3$ for the start and end knots, makes the B-spline basis functions $N_{i,2}(u)$ identical to the quadratic Bernstein polynomials $B_{i,2}(u)$ on the domain $u \\in [0,1]$. The curve is thus a quadratic Bézier curve:\n$$\n\\mathbf{x}(u) = \\sum_{i=0}^{2} B_{i,2}(u) \\mathbf{P}_i\n$$\nwhere the Bernstein polynomials of degree $p=2$ are:\n$$\nB_{0,2}(u) = \\binom{2}{0}(1-u)^2 u^0 = (1-u)^2 \\\\\nB_{1,2}(u) = \\binom{2}{1}(1-u)^1 u^1 = 2u(1-u) \\\\\nB_{2,2}(u) = \\binom{2}{2}(1-u)^0 u^2 = u^2\n$$\nThe control points are given as $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, and $\\mathbf{P}_2=(2,0)$.\n\nThe process of degree elevation seeks a new set of control points $\\{\\mathbf{Q}_i\\}_{i=0}^3$ for a cubic Bézier curve $\\tilde{\\mathbf{x}}(u)$ such that the geometry is identical to the original curve, i.e., $\\tilde{\\mathbf{x}}(u) = \\mathbf{x}(u)$ for all $u \\in [0,1]$.\n$$\n\\tilde{\\mathbf{x}}(u) = \\sum_{i=0}^{3} B_{i,3}(u) \\mathbf{Q}_i\n$$\nTo find the relationship between $\\{\\mathbf{P}_i\\}$ and $\\{\\mathbf{Q}_i\\}$, we can elevate the degree of the basis functions of the original curve. We use the property that the basis functions form a partition of unity, $\\sum B_{i,p}(u) = 1$, which can be expressed for the simplest case as $(1-u)+u=1$. We multiply the expression for $\\mathbf{x}(u)$ by $1$:\n$$\n\\mathbf{x}(u) = ((1-u) + u) \\sum_{j=0}^{2} B_{j,2}(u) \\mathbf{P}_j = \\sum_{j=0}^{2} (1-u)B_{j,2}(u)\\mathbf{P}_j + \\sum_{j=0}^{2} uB_{j,2}(u)\\mathbf{P}_j\n$$\nWe use the definitions $B_{j,p}(u) = \\binom{p}{j}u^j(1-u)^{p-j}$ to analyze the products:\n$$\n(1-u)B_{j,p}(u) = (1-u)\\binom{p}{j}u^j(1-u)^{p-j} = \\frac{\\binom{p}{j}}{\\binom{p+1}{j}} \\binom{p+1}{j}u^j(1-u)^{p+1-j} = \\frac{p+1-j}{p+1} B_{j,p+1}(u)\n$$\n$$\nuB_{j,p}(u) = u\\binom{p}{j}u^j(1-u)^{p-j} = \\frac{\\binom{p}{j}}{\\binom{p+1}{j+1}} \\binom{p+1}{j+1}u^{j+1}(1-u)^{p-j} = \\frac{j+1}{p+1} B_{j+1,p+1}(u)\n$$\nSubstituting these identities with $p=2$ into the expression for $\\mathbf{x}(u)$:\n$$\n\\mathbf{x}(u) = \\sum_{j=0}^{2} \\frac{3-j}{3}B_{j,3}(u)\\mathbf{P}_j + \\sum_{j=0}^{2} \\frac{j+1}{3}B_{j+1,3}(u)\\mathbf{P}_j\n$$\nLet's expand and collect terms based on the cubic Bernstein basis functions $B_{i,3}(u)$:\nThe first sum gives:\n$$\n\\frac{3}{3}B_{0,3}(u)\\mathbf{P}_0 + \\frac{2}{3}B_{1,3}(u)\\mathbf{P}_1 + \\frac{1}{3}B_{2,3}(u)\\mathbf{P}_2\n$$\nThe second sum gives (index shifted):\n$$\n\\frac{1}{3}B_{1,3}(u)\\mathbf{P}_0 + \\frac{2}{3}B_{2,3}(u)\\mathbf{P}_1 + \\frac{3}{3}B_{3,3}(u)\\mathbf{P}_2\n$$\nCombining and grouping terms by $B_{i,3}(u)$:\n$$\n\\mathbf{x}(u) = B_{0,3}(u)[\\mathbf{P}_0] + B_{1,3}(u)[\\frac{1}{3}\\mathbf{P}_0 + \\frac{2}{3}\\mathbf{P}_1] + B_{2,3}(u)[\\frac{2}{3}\\mathbf{P}_1 + \\frac{1}{3}\\mathbf{P}_2] + B_{3,3}(u)[\\mathbf{P}_2]\n$$\nBy comparing this with $\\tilde{\\mathbf{x}}(u) = \\sum_{i=0}^{3} B_{i,3}(u) \\mathbf{Q}_i$, we obtain the new control points $\\{\\mathbf{Q}_i\\}$:\n$$\n\\mathbf{Q}_0 = \\mathbf{P}_0 \\\\\n\\mathbf{Q}_1 = \\frac{1}{3}\\mathbf{P}_0 + \\frac{2}{3}\\mathbf{P}_1 \\\\\n\\mathbf{Q}_2 = \\frac{2}{3}\\mathbf{P}_1 + \\frac{1}{3}\\mathbf{P}_2 \\\\\n\\mathbf{Q}_3 = \\mathbf{P}_2\n$$\nThe general formula for degree elevation from $p$ to $p+1$ is $\\mathbf{Q}_i = \\frac{i}{p+1}\\mathbf{P}_{i-1} + (1-\\frac{i}{p+1})\\mathbf{P}_i$ for $i=1,\\ldots,p$, with $\\mathbf{Q}_0 = \\mathbf{P}_0$ and $\\mathbf{Q}_{p+1} = \\mathbf{P}_p$. Our derivation for $p=2$ matches this general result.\n\nNow, we apply these relations to the given control points $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, $\\mathbf{P}_2=(2,0)$:\n$$\n\\mathbf{Q}_0 = (0,0) \\\\\n\\mathbf{Q}_1 = \\frac{1}{3}(0,0) + \\frac{2}{3}(1,2) = \\left(\\frac{2}{3}, \\frac{4}{3}\\right) \\\\\n\\mathbf{Q}_2 = \\frac{2}{3}(1,2) + \\frac{1}{3}(2,0) = \\left(\\frac{2}{3}+\\frac{2}{3}, \\frac{4}{3}+0\\right) = \\left(\\frac{4}{3}, \\frac{4}{3}\\right) \\\\\n\\mathbf{Q}_3 = (2,0)\n$$\nThe problem asks for the evaluation of $\\left\\|\\mathbf{x}\\!\\left(\\tfrac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\tfrac{1}{2}\\right)\\right\\|$. By our derivation, the geometric mapping is invariant under degree elevation, meaning $\\mathbf{x}(u) = \\tilde{\\mathbf{x}}(u)$ for all $u \\in [0,1]$. Consequently, the difference vector $\\mathbf{x}(u) - \\tilde{\\mathbf{x}}(u)$ is the zero vector, $\\mathbf{0}$, for any value of $u$.\n\nFor completeness, we can explicitly verify this at $u=\\frac{1}{2}$.\nFor the original quadratic curve:\n$$\n\\mathbf{x}\\left(\\frac{1}{2}\\right) = B_{0,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_0 + B_{1,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_1 + B_{2,2}\\left(\\frac{1}{2}\\right)\\mathbf{P}_2 \\\\\n= \\left(1-\\frac{1}{2}\\right)^2 \\mathbf{P}_0 + 2\\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right)\\mathbf{P}_1 + \\left(\\frac{1}{2}\\right)^2 \\mathbf{P}_2 \\\\\n= \\frac{1}{4}(0,0) + \\frac{1}{2}(1,2) + \\frac{1}{4}(2,0) = \\left(0+\\frac{1}{2}+\\frac{2}{4}, 0+1+0\\right) = (1,1)\n$$\nFor the degree-elevated cubic curve:\n$$\n\\tilde{\\mathbf{x}}\\left(\\frac{1}{2}\\right) = B_{0,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_0 + B_{1,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_1 + B_{2,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_2 + B_{3,3}\\left(\\frac{1}{2}\\right)\\mathbf{Q}_3\n$$\nThe cubic Bernstein values at $u=\\frac{1}{2}$ are $B_{0,3}=\\frac{1}{8}$, $B_{1,3}=\\frac{3}{8}$, $B_{2,3}=\\frac{3}{8}$, $B_{3,3}=\\frac{1}{8}$.\n$$\n\\tilde{\\mathbf{x}}\\left(\\frac{1}{2}\\right) = \\frac{1}{8}(0,0) + \\frac{3}{8}\\left(\\frac{2}{3}, \\frac{4}{3}\\right) + \\frac{3}{8}\\left(\\frac{4}{3}, \\frac{4}{3}\\right) + \\frac{1}{8}(2,0) \\\\\n= \\left(0 + \\frac{6}{24} + \\frac{12}{24} + \\frac{2}{8}, 0 + \\frac{12}{24} + \\frac{12}{24} + 0\\right) \\\\\n= \\left(\\frac{1}{4} + \\frac{1}{2} + \\frac{1}{4}, \\frac{1}{2} + \\frac{1}{2}\\right) = (1,1)\n$$\nThe verification confirms that $\\mathbf{x}(\\frac{1}{2})=\\tilde{\\mathbf{x}}(\\frac{1}{2})=(1,1)$. The difference is:\n$$\n\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right) = (1,1) - (1,1) = (0,0)\n$$\nFinally, we compute the Euclidean norm of this difference vector:\n$$\n\\left\\|\\mathbf{x}\\!\\left(\\frac{1}{2}\\right)-\\tilde{\\mathbf{x}}\\!\\left(\\frac{1}{2}\\right)\\right\\| = \\|(0,0)\\| = \\sqrt{0^2 + 0^2} = 0\n$$\nThe result is a direct consequence of the geometric invariance of a curve under degree elevation.", "answer": "$$\n\\boxed{0}\n$$", "id": "3535326"}, {"introduction": "Having explored the geometric foundations, we now turn to the 'analysis' in isogeometric analysis. This practice delves into the core of an IGA simulation by examining the construction of the stiffness matrix and how it is influenced by the geometric definition. By numerically calculating the sensitivity of a stiffness matrix entry to a NURBS weight, you will gain a concrete understanding of the powerful, direct link between geometry and the discrete physical system. [@problem_id:3535319]", "problem": "Consider a two-dimensional Non-Uniform Rational B-Spline (NURBS) patch used for an isogeometric Galerkin discretization of a scalar diffusion problem in computational geomechanics. All quantities in this problem are nondimensional so that the final numerical values are dimensionless. The parametric domain is the closed square $[0,1]\\times[0,1]$ with tensor-product, open, clamped knot vectors $U = [0,0,0,1,1,1]$ in the $\\xi$-direction and $V = [0,0,0,1,1,1]$ in the $\\eta$-direction, and polynomial degrees $p = 2$ and $q = 2$. Let the bivariate B-spline basis be constructed from univariate basis functions via tensor products. The NURBS basis functions are defined by the rationalization of the tensor-product B-splines with positive weights.\n\nThe geometry mapping $\\boldsymbol{X}(\\xi,\\eta)$ from the parametric domain to the physical domain is given by the isogeometric concept using the same NURBS basis functions used for the field approximation. Specifically, define a set of $n = 9$ control points and $n$ positive weights. Let the control points be arranged in a $3\\times 3$ grid and flattened in row-major order by the index map $i = i_\\xi + 3\\,i_\\eta$ where $i_\\xi \\in \\{0,1,2\\}$ and $i_\\eta \\in \\{0,1,2\\}$. The control point coordinates $\\boldsymbol{P}_i = (X_i,Y_i)$ are:\n- $i=0$: $(0,0)$,\n- $i=1$: $(0.5,-0.05)$,\n- $i=2$: $(1,0)$,\n- $i=3$: $(0,0.5)$,\n- $i=4$: $(0.5,0.6)$,\n- $i=5$: $(1,0.5)$,\n- $i=6$: $(0,1)$,\n- $i=7$: $(0.5,1.05)$,\n- $i=8$: $(1,1)$.\n\nLet the base (unperturbed) weights be the vector $\\boldsymbol{w} \\in \\mathbb{R}^9$ with entries\n- $w_0 = 1$, $w_1 = 1$, $w_2 = 1$,\n- $w_3 = 1$, $w_4 = 1.8$, $w_5 = 1$,\n- $w_6 = 1$, $w_7 = 1$, $w_8 = 1$.\n\nFor $(\\xi,\\eta) \\in [0,1]\\times[0,1]$, let $B_i(\\xi,\\eta)$ denote the tensor-product B-spline basis functions (non-rational), and let $W(\\xi,\\eta) = \\sum_{j=0}^{8} w_j B_j(\\xi,\\eta)$ denote the NURBS weight function. The rational NURBS basis functions are $R_i(\\xi,\\eta) = \\dfrac{w_i B_i(\\xi,\\eta)}{W(\\xi,\\eta)}$. The geometry map is $\\boldsymbol{X}(\\xi,\\eta) = \\sum_{i=0}^{8} R_i(\\xi,\\eta)\\,\\boldsymbol{P}_i$. The Jacobian of the map is the $2\\times 2$ matrix $\\boldsymbol{J}(\\xi,\\eta) = \\left[\\dfrac{\\partial \\boldsymbol{X}}{\\partial \\xi} \\ \\ \\dfrac{\\partial \\boldsymbol{X}}{\\partial \\eta}\\right]$, the metric tensor is $\\boldsymbol{G}(\\xi,\\eta) = \\boldsymbol{J}^\\top(\\xi,\\eta)\\,\\boldsymbol{J}(\\xi,\\eta)$, and the physical gradients of basis functions are obtained by the covariant transformation $\\nabla_{\\boldsymbol{x}} R_i(\\xi,\\eta) = \\boldsymbol{J}^{-\\top}(\\xi,\\eta)\\, \\begin{bmatrix} \\dfrac{\\partial R_i}{\\partial \\xi}(\\xi,\\eta) \\\\ \\dfrac{\\partial R_i}{\\partial \\eta}(\\xi,\\eta) \\end{bmatrix}$.\n\nIn a scalar diffusion model problem with unit, isotropic conductivity, the representative stiffness matrix entry corresponding to basis indices $a$ and $b$ is the bilinear form evaluated over the physical patch,\n$$\nK_{ab} = \\int_{\\Omega} \\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b \\, d\\Omega = \\int_{0}^{1} \\int_{0}^{1} \\left( \\nabla_{\\boldsymbol{x}} R_a(\\xi,\\eta) \\cdot \\nabla_{\\boldsymbol{x}} R_b(\\xi,\\eta) \\right) \\, \\left|\\det \\boldsymbol{J}(\\xi,\\eta)\\right| \\, d\\xi \\, d\\eta,\n$$\nwhere $\\Omega$ is the physical image of the patch under $\\boldsymbol{X}(\\xi,\\eta)$.\n\nYour task is to quantify how changing a single weight $w_k$ affects the metric and the shape function gradients through its impact on the stiffness matrix entry $K_{ab}$. Starting from the foundational definitions above (B-splines, rational NURBS, geometry map, Jacobian, metric tensor, and covariant gradient transformation), construct a numerical procedure that, for a given index $k$ and a small perturbation $\\varepsilon  0$, computes a central finite-difference estimate of the sensitivity of a representative stiffness entry $K_{ab}$ with respect to $w_k$,\n$$\n\\frac{\\partial K_{ab}}{\\partial w_k} \\approx \\frac{K_{ab}(w_k + \\varepsilon) - K_{ab}(w_k - \\varepsilon)}{2\\,\\varepsilon}.\n$$\nIn all evaluations, take the representative indices $a = 4$ and $b = 0$ fixed. Perform the parametric-domain integration using tensor-product Gaussian quadrature of order $3$ in each parametric direction, mapped from $[-1,1]$ to $[0,1]$.\n\nImplement the following test suite, each test being a tuple $(k,\\varepsilon)$ indicating which single weight index to perturb and the perturbation magnitude:\n- Test $1$: $(k,\\varepsilon) = (4, 10^{-4})$,\n- Test $2$: $(k,\\varepsilon) = (1, 10^{-6})$,\n- Test $3$: $(k,\\varepsilon) = (8, 10^{-2})$.\n\nFor each test, compute the finite-difference estimate of $\\dfrac{\\partial K_{ab}}{\\partial w_k}$ using the above central difference formula. If needed to preserve positivity of the perturbed weight, ensure that both $w_k + \\varepsilon$ and $w_k - \\varepsilon$ remain strictly positive; the given tests satisfy this requirement.\n\nYour program must output a single line containing a list of three floating-point numbers, each being the central-difference estimate for the corresponding test in the order listed above. The output must be printed as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3]$. The three reported values are dimensionless real numbers.", "solution": "The problem requires the computation of the sensitivity of a stiffness matrix entry with respect to a specific NURBS weight in an isogeometric analysis framework. This will be accomplished by constructing a numerical procedure based on foundational isogeometric principles and applying a central finite-difference scheme. The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution.\n\n\\textbf{1. B-Spline and NURBS Basis Functions}\n\nThe foundation of the isogeometric model lies in its basis functions. We begin with univariate B-spline basis functions, which for the given open, clamped knot vectors $U=V=[0,0,0,1,1,1]$ and polynomial degrees $p=q=2$, simplify to the standard Bernstein polynomials of degree $2$ over the interval $[0,1]$. For a parametric coordinate $\\xi \\in [0,1]$, the three non-zero basis functions $N_{i_\\xi, 2}(\\xi)$ are:\n$$\n\\begin{aligned}\nN_{0,2}(\\xi) = (1-\\xi)^2 \\\\\nN_{1,2}(\\xi) = 2\\xi(1-\\xi) \\\\\nN_{2,2}(\\xi) = \\xi^2\n\\end{aligned}\n$$\nTheir first derivatives with respect to $\\xi$ are:\n$$\n\\begin{aligned}\n\\frac{d N_{0,2}}{d\\xi}(\\xi) = -2(1-\\xi) \\\\\n\\frac{d N_{1,2}}{d\\xi}(\\xi) = 2(1-2\\xi) \\\\\n\\frac{d N_{2,2}}{d\\xi}(\\xi) = 2\\xi\n\\end{aligned}\n$$\nThe bivariate B-spline basis functions $B_i(\\xi, \\eta)$ for $i \\in \\{0, 1, ..., 8\\}$ are formed by a tensor product of the univariate functions. Using the row-major index mapping $i = i_\\xi + 3i_\\eta$ where $i_\\xi, i_\\eta \\in \\{0,1,2\\}$, we have:\n$$\nB_i(\\xi, \\eta) = N_{i_\\xi, 2}(\\xi) N_{i_\\eta, 2}(\\eta)\n$$\nThe partial derivatives are computed accordingly:\n$$\n\\frac{\\partial B_i}{\\partial \\xi}(\\xi, \\eta) = \\frac{d N_{i_\\xi, 2}}{d\\xi}(\\xi) N_{i_\\eta, 2}(\\eta) \\quad \\text{and} \\quad \\frac{\\partial B_i}{\\partial \\eta}(\\xi, \\eta) = N_{i_\\xi, 2}(\\xi) \\frac{d N_{i_\\eta, 2}}{d\\eta}(\\eta)\n$$\nThe rational NURBS basis functions $R_i(\\xi, \\eta)$ are constructed by introducing weights $w_i  0$ and a denominator function $W(\\xi, \\eta) = \\sum_{j=0}^{8} w_j B_j(\\xi, \\eta)$.\n$$\nR_i(\\xi, \\eta) = \\frac{w_i B_i(\\xi, \\eta)}{W(\\xi, \\eta)}\n$$\nThe parametric derivatives of the NURBS basis functions are found using the quotient rule. For instance, the derivative with respect to $\\xi$ is:\n$$\n\\frac{\\partial R_i}{\\partial \\xi} = \\frac{w_i \\frac{\\partial B_i}{\\partial \\xi} W - w_i B_i \\frac{\\partial W}{\\partial \\xi}}{W^2}, \\quad \\text{where} \\quad \\frac{\\partial W}{\\partial \\xi} = \\sum_{j=0}^{8} w_j \\frac{\\partial B_j}{\\partial \\xi}\n$$\nAn analogous expression holds for the derivative with respect to $\\eta$.\n\n\\textbf{2. Isogeometric Mapping and Stiffness Formulation}\n\nThe geometry of the physical domain $\\Omega$ is described by the isogeometric mapping $\\boldsymbol{X}(\\xi, \\eta)$, which uses the same NURBS basis functions:\n$$\n\\boldsymbol{X}(\\xi, \\eta) = \\sum_{i=0}^{8} R_i(\\xi, \\eta) \\boldsymbol{P}_i\n$$\nwhere $\\boldsymbol{P}_i$ are the control point coordinates. The transformation from the parametric domain to the physical domain is characterized by the Jacobian matrix $\\boldsymbol{J}(\\xi, \\eta)$:\n$$\n\\boldsymbol{J} = \\begin{bmatrix} \\frac{\\partial \\boldsymbol{X}}{\\partial \\xi}  \\frac{\\partial \\boldsymbol{X}}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\sum_{i=0}^{8} \\frac{\\partial R_i}{\\partial \\xi} X_i  \\sum_{i=0}^{8} \\frac{\\partial R_i}{\\partial \\eta} X_i \\\\ \\sum_{i=0}^{8} \\frac{\\partial R_i}{\\partial \\xi} Y_i  \\sum_{i=0}^{8} \\frac{\\partial R_i}{\\partial \\eta} Y_i \\end{bmatrix}\n$$\nFor a scalar field variable approximated using the same basis, $u(\\boldsymbol{x}) = \\sum_a u_a R_a(\\boldsymbol{x})$, the gradient of a basis function in physical coordinates $\\nabla_{\\boldsymbol{x}} R_a$ is found from its parametric gradient $\\nabla_{\\boldsymbol{\\xi}} R_a = \\begin{bmatrix} \\partial R_a/\\partial \\xi  \\partial R_a/\\partial \\eta \\end{bmatrix}^\\top$ via the inverse transpose of the Jacobian:\n$$\n\\nabla_{\\boldsymbol{x}} R_a = \\boldsymbol{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}} R_a\n$$\nThe stiffness matrix entry $K_{ab}$ for a unit-conductivity diffusion problem is given by the integral of the dot product of physical gradients over the physical domain $\\Omega$:\n$$\nK_{ab} = \\int_{\\Omega} \\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b \\, d\\Omega\n$$\nChanging variables to the parametric domain $[0,1] \\times [0,1]$, the integral becomes:\n$$\nK_{ab} = \\int_{0}^{1} \\int_{0}^{1} (\\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b) |\\det(\\boldsymbol{J})| \\, d\\xi d\\eta\n$$\n\n\\textbf{3. Numerical Procedure}\n\nThe integral for $K_{ab}$ is evaluated numerically using a tensor-product Gaussian quadrature rule. The problem specifies an order of $3$ in each direction.\n\n\\textbf{Quadrature Scheme:} For a one-dimensional integral over $[-1,1]$, $3$-point Gauss-Legendre quadrature uses points $\\hat{t}_k = \\{-\\sqrt{3/5}, 0, \\sqrt{3/5}\\}$ and weights $\\hat{w}_k = \\{5/9, 8/9, 5/9\\}$. To integrate over $[0,1]$, we use the linear mapping $\\xi = (\\hat{t}+1)/2$. The quadrature points in $[0,1]$ are $\\xi_k = \\{(1-\\sqrt{3/5})/2, 1/2, (1+\\sqrt{3/5})/2\\}$, and the weights are $w_k = \\hat{w}_k/2 = \\{5/18, 8/18, 5/18\\}$. The integral is then approximated by the sum:\n$$\nK_{ab} \\approx \\sum_{k=1}^{3} \\sum_{l=1}^{3} w_k w_l \\left[ (\\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b) |\\det(\\boldsymbol{J})| \\right]_{(\\xi_k, \\eta_l)}\n$$\n\n\\textbf{Algorithm for Stiffness Entry Calculation:} For a given vector of weights $\\boldsymbol{w}$, the value of $K_{ab}$ is computed as follows:\n1.  Initialize $K_{ab} = 0$.\n2.  Define the sets of quadrature points $\\{\\xi_k\\}$ and weights $\\{w_k\\}$ for the $[0,1]$ interval.\n3.  Loop over each quadrature point pair $(\\xi_k, \\eta_l)$:\n    a. Evaluate the univariate Bernstein basis functions $N_{i,2}(\\xi_k)$, $N_{i,2}(\\eta_l)$ and their derivatives.\n    b. Compute the values of all $9$ bivariate B-spline basis functions $B_i(\\xi_k, \\eta_l)$ and their partial derivatives $\\partial B_i/\\partial \\xi$, $\\partial B_i/\\partial \\eta$.\n    c. Compute the denominator function $W(\\xi_k, \\eta_l)$ and its derivatives $\\partial W/\\partial \\xi$, $\\partial W/\\partial \\eta$.\n    d. For all $i=0,\\dots,8$, compute the parametric derivatives $\\partial R_i/\\partial \\xi$ and $\\partial R_i/\\partial \\eta$ at $(\\xi_k, \\eta_l)$.\n    e. Assemble the Jacobian matrix $\\boldsymbol{J}$ using these derivatives and the control point coordinates $\\boldsymbol{P}_i$.\n    f. Calculate the determinant $\\det(\\boldsymbol{J})$ and the inverse-transpose matrix $\\boldsymbol{J}^{-\\top}$.\n    g. For the specified indices $a=4$ and $b=0$, form the parametric gradient vectors $\\nabla_{\\boldsymbol{\\xi}} R_a$ and $\\nabla_{\\boldsymbol{\\xi}} R_b$.\n    h. Transform these to physical gradients: $\\nabla_{\\boldsymbol{x}} R_a = \\boldsymbol{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}} R_a$ and $\\nabla_{\\boldsymbol{x}} R_b = \\boldsymbol{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}} R_b$.\n    i. Compute the integrand value: $f(\\xi_k, \\eta_l) = (\\nabla_{\\boldsymbol{x}} R_a \\cdot \\nabla_{\\boldsymbol{x}} R_b) |\\det(\\boldsymbol{J})|$.\n    j. Add the contribution to the total: $K_{ab} = K_{ab} + w_k w_l f(\\xi_k, \\eta_l)$.\n4.  Return the final value of $K_{ab}$.\n\n\\textbf{4. Sensitivity Analysis}\n\nThe sensitivity of $K_{ab}$ with respect to a weight $w_k$ is estimated using a second-order central finite-difference formula:\n$$\n\\frac{\\partial K_{ab}}{\\partial w_k} \\approx \\frac{K_{ab}(\\boldsymbol{w}^+) - K_{ab}(\\boldsymbol{w}^-)}{2\\varepsilon}\n$$\nHere, $\\varepsilon$ is a small perturbation. The vectors $\\boldsymbol{w}^+$ and $\\boldsymbol{w}^-$ are the base weight vector $\\boldsymbol{w}$ with the $k$-th component perturbed to $w_k+\\varepsilon$ and $w_k-\\varepsilon$, respectively. The numerical procedure involves two calls to the stiffness calculation algorithm described above, one for each perturbed weight vector. The results are then used to evaluate the finite-difference expression. This process is repeated for each test case provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the isogeometric sensitivity analysis problem.\n    \"\"\"\n    # Define problem data from the statement\n    control_points_list = [\n        (0,0), (0.5,-0.05), (1,0),\n        (0,0.5), (0.5,0.6), (1,0.5),\n        (0,1), (0.5,1.05), (1,1)\n    ]\n    control_points = np.array(control_points_list, dtype=float)\n\n    base_weights_list = [\n        1, 1, 1,\n        1, 1.8, 1,\n        1, 1, 1\n    ]\n    base_weights = np.array(base_weights_list, dtype=float)\n\n    # Indices for the stiffness matrix entry K_ab\n    a, b = 4, 0\n\n    # Gaussian quadrature of order 3 for interval [0, 1]\n    # Mapped from standard [-1, 1] points and weights\n    gauss_pts_std = np.array([-np.sqrt(3.0/5.0), 0.0, np.sqrt(3.0/5.0)])\n    gauss_wts_std = np.array([5.0/9.0, 8.0/9.0, 5.0/9.0])\n    \n    gauss_points = 0.5 * (gauss_pts_std + 1.0)\n    gauss_weights = 0.5 * gauss_wts_std\n\n    def calculate_stiffness_entry(weights_vec):\n        \"\"\"\n        Calculates the stiffness matrix entry K_ab for a given set of weights.\n        \"\"\"\n        stiffness_val = 0.0\n\n        for i in range(len(gauss_points)):\n            xi = gauss_points[i]\n            w_xi = gauss_weights[i]\n            for j in range(len(gauss_points)):\n                eta = gauss_points[j]\n                w_eta = gauss_weights[j]\n                \n                # Evaluate integrand at the current quadrature point (xi, eta)\n                \n                # 1. Univariate Bernstein basis functions (p=2) and their derivatives\n                N_xi = np.array([(1-xi)**2, 2*xi*(1-xi), xi**2])\n                dN_xi = np.array([-2*(1-xi), 2 - 4*xi, 2*xi])\n                \n                N_eta = np.array([(1-eta)**2, 2*eta*(1-eta), eta**2])\n                dN_eta = np.array([-2*(1-eta), 2 - 4*eta, 2*eta])\n\n                # 2. Tensor-product B-spline basis and derivatives\n                B = np.zeros(9)\n                dB_dxi = np.zeros(9)\n                dB_deta = np.zeros(9)\n                for i_eta in range(3):\n                    for i_xi in range(3):\n                        idx = i_xi + 3 * i_eta\n                        B[idx] = N_xi[i_xi] * N_eta[i_eta]\n                        dB_dxi[idx] = dN_xi[i_xi] * N_eta[i_eta]\n                        dB_deta[idx] = N_xi[i_xi] * dN_eta[i_eta]\n                \n                # 3. NURBS denominator W and its derivatives\n                W_val = np.dot(weights_vec, B)\n                dW_dxi = np.dot(weights_vec, dB_dxi)\n                dW_deta = np.dot(weights_vec, dB_deta)\n\n                # 4. Parametric derivatives of all NURBS basis functions\n                dR_dxi = (weights_vec * dB_dxi * W_val - weights_vec * B * dW_dxi) / (W_val**2)\n                dR_deta = (weights_vec * dB_deta * W_val - weights_vec * B * dW_deta) / (W_val**2)\n\n                # 5. Jacobian matrix of the geometric map\n                # dX/dxi = sum(dRi/dxi * Pi)\n                dX_dxi = dR_dxi @ control_points # shape (2,)\n                dX_deta = dR_deta @ control_points # shape (2,)\n                J = np.array([[dX_dxi[0], dX_deta[0]], [dX_dxi[1], dX_deta[1]]])\n                \n                # 6. Jacobian determinant and inverse transpose\n                detJ = np.linalg.det(J)\n                if abs(detJ)  1e-12: continue  # Avoid singularity\n                invJ_T = np.linalg.inv(J).T\n                \n                # 7. Physical gradients of basis functions a and b\n                grad_param_Ra = np.array([dR_dxi[a], dR_deta[a]])\n                grad_param_Rb = np.array([dR_dxi[b], dR_deta[b]])\n\n                grad_phys_Ra = invJ_T @ grad_param_Ra\n                grad_phys_Rb = invJ_T @ grad_param_Rb\n                \n                # 8. Integrand value: (grad(Ra) . grad(Rb)) * |det(J)|\n                dot_product = np.dot(grad_phys_Ra, grad_phys_Rb)\n                integrand = dot_product * np.abs(detJ)\n                \n                # Accumulate weighted integrand value\n                stiffness_val += integrand * w_xi * w_eta\n        \n        return stiffness_val\n\n    # Test suite from the problem statement\n    test_cases = [\n        (4, 1e-4),\n        (1, 1e-6),\n        (8, 1e-2),\n    ]\n\n    results = []\n    for k, epsilon in test_cases:\n        # Perturb weights for central difference\n        weights_plus = base_weights.copy()\n        weights_plus[k] += epsilon\n        \n        weights_minus = base_weights.copy()\n        weights_minus[k] -= epsilon\n        \n        # Calculate stiffness for perturbed weights\n        K_plus = calculate_stiffness_entry(weights_plus)\n        K_minus = calculate_stiffness_entry(weights_minus)\n        \n        # Compute central difference sensitivity\n        sensitivity = (K_plus - K_minus) / (2.0 * epsilon)\n        results.append(sensitivity)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3535319"}, {"introduction": "Advanced geomechanical models, such as those for poroelasticity or near-incompressibility, often rely on mixed formulations that must satisfy critical stability conditions. This exercise tackles the discrete Ladyzhenskaya–Babuška–Brezzi (LBB) or inf-sup condition within an isogeometric framework. By deriving the inf-sup constant for a specific pairing of displacement and pressure spaces, you will investigate the mathematical underpinnings of a stable and accurate mixed IGA method. [@problem_id:3535320]", "problem": "Consider the mixed displacement–pressure formulation for a one-dimensional, nearly incompressible solid in small strain geomechanics on the parametric domain $\\Omega = [0,1]$. Let the displacement space be the isogeometric space built from a quadratic ($p = 2$) open knot vector with a single element, and the pressure space be the isogeometric space built from a linear ($p-1 = 1$) open knot vector with the same single element. Assume the geometry mapping is the identity and impose the homogeneous essential boundary condition $u(0) = 0$ to eliminate the rigid body mode.\n\nLet the bilinear form associated with volumetric coupling be\n$$\nb(u,q) = \\int_{0}^{1} q(x)\\,\\frac{d u(x)}{dx}\\,dx,\n$$\nand equip the discrete displacement and pressure spaces with the norms\n$$\n\\|u\\|_{V} = \\left(\\int_{0}^{1} \\left|\\frac{d u(x)}{dx}\\right|^{2} dx\\right)^{\\frac{1}{2}}, \n\\qquad\n\\|q\\|_{Q} = \\left(\\int_{0}^{1} |q(x)|^{2} dx\\right)^{\\frac{1}{2}}.\n$$\nThe discrete inf–sup (Ladyzhenskaya–Babuška–Brezzi) constant is defined as\n$$\n\\beta_{h} = \\inf_{0 \\neq q_{h} \\in Q_{h}} \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}}.\n$$\n\nUsing the above setting:\n- Construct the basis functions for $V_{h}$ and $Q_{h}$ induced by the open knot vectors on the single element.\n- Enforce $u(0)=0$ consistently in the discrete setting.\n- Starting from the definition of $\\beta_{h}$, derive a computable expression for the discrete inf–sup constant in terms of the discrete operators and evaluate it exactly for this mesh and these isogeometric spaces.\n\nFinally, explain how the value you obtain relates to the knot configuration and continuity; in particular, discuss qualitatively how inserting an interior knot (thus introducing multiple elements and reducing continuity) would be expected to affect the discrete inf–sup constant. Provide as your final result the exact value of $\\beta_{h}$ for the single-element open-knot configuration described above. The constant is dimensionless, so no units are required, and no rounding is necessary.", "solution": "The problem requires the calculation of the discrete inf-sup constant $\\beta_h$ for a specific one-dimensional isogeometric element pairing and a subsequent discussion on the result.\n\nThe validation of the problem statement is performed first.\n\n**Step 1: Extract Givens**\n- Formulation: Mixed displacement–pressure formulation.\n- Domain: $\\Omega = [0,1]$.\n- Displacement space ($V_h$): Isogeometric space from a quadratic ($p=2$) open knot vector, single element.\n- Pressure space ($Q_h$): Isogeometric space from a linear ($p-1=1$) open knot vector, single element.\n- Geometry mapping: Identity, $x(\\xi) = \\xi$.\n- Boundary condition: Homogeneous essential boundary condition $u(0) = 0$.\n- Bilinear form: $b(u,q) = \\int_{0}^{1} q(x)\\,\\frac{d u(x)}{dx}\\,dx$.\n- Displacement norm: $\\|u\\|_{V} = \\left(\\int_{0}^{1} \\left|\\frac{d u(x)}{dx}\\right|^{2} dx\\right)^{\\frac{1}{2}}$.\n- Pressure norm: $\\|q\\|_{Q} = \\left(\\int_{0}^{1} |q(x)|^{2} dx\\right)^{\\frac{1}{2}}$.\n- Definition of the discrete inf-sup constant: $\\beta_{h} = \\inf_{0 \\neq q_{h} \\in Q_{h}} \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{b(u_{h}, q_{h})}{\\|u_{h}\\|_{V}\\,\\|q_{h}\\|_{Q}}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It poses a standard, non-trivial question in the theory of mixed finite element methods, specifically within the framework of isogeometric analysis. The formulation, definitions, and spaces are standard in the field. The problem is self-contained and free of contradictions, ambiguities, or unsound premises.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\n**Part 1: Construction of Basis Functions**\nFor a single element on the domain $[0,1]$ with an open knot vector, the B-spline basis functions reduce to the Bernstein polynomials.\n\n- **Displacement Space $V_h$ ($p=2$):**\nThe open knot vector for a single quadratic element is $\\Xi_u = \\{0, 0, 0, 1, 1, 1\\}$. The basis functions are the quadratic Bernstein polynomials:\n$$\n\\begin{aligned}\nN_{1,2}(x) = (1-x)^2 = 1 - 2x + x^2 \\\\\nN_{2,2}(x) = 2x(1-x) = 2x - 2x^2 \\\\\nN_{3,2}(x) = x^2\n\\end{aligned}\n$$\nA discrete displacement field $u_h(x)$ is represented as $u_h(x) = \\sum_{i=1}^{3} c_i N_{i,2}(x)$.\n\n- **Pressure Space $Q_h$ ($p=1$):**\nThe open knot vector for a single linear element is $\\Xi_q = \\{0, 0, 1, 1\\}$. The basis functions are the linear Bernstein polynomials:\n$$\n\\begin{aligned}\nQ_{1,1}(x) = 1-x \\\\\nQ_{2,1}(x) = x\n\\end{aligned}\n$$\nA discrete pressure field $q_h(x)$ is represented as $q_h(x) = \\sum_{k=1}^{2} d_k Q_{k,1}(x)$.\n\n**Part 2: Enforcement of Boundary Condition $u(0)=0$**\nThe condition $u(0)=0$ must be imposed on the discrete displacement space. At $x=0$, the basis functions evaluate to:\n$N_{1,2}(0) = 1$, $N_{2,2}(0) = 0$, $N_{3,2}(0) = 0$.\nThus, $u_h(0) = c_1 N_{1,2}(0) + c_2 N_{2,2}(0) + c_3 N_{3,2}(0) = c_1$.\nThe condition $u_h(0)=0$ implies $c_1=0$. The constrained displacement space is therefore spanned by $\\{N_{2,2}(x), N_{3,2}(x)\\}$. Let $\\mathbf{c} = \\begin{pmatrix} c_2  c_3 \\end{pmatrix}^T$ be the vector of active degrees of freedom.\n\n**Part 3: Matrix Formulation of the inf-sup Constant**\nWe express the terms in the definition of $\\beta_h$ in matrix form. Let $\\mathbf{d} = \\begin{pmatrix} d_1  d_2 \\end{{pmatrix}^T$.\n- $b(u_h, q_h) = \\int_{0}^{1} (\\mathbf{d}^T \\mathbf{Q}(x)) (\\mathbf{N}'(x)^T \\mathbf{c}) dx = \\mathbf{d}^T \\mathbf{B} \\mathbf{c}$, where $\\mathbf{B}_{kj} = \\int_0^1 Q_{k,1}(x) N'_{j+1,2}(x) dx$.\n- $\\|u_h\\|_V^2 = \\int_{0}^{1} |\\frac{du_h}{dx}|^2 dx = \\mathbf{c}^T \\mathbf{K} \\mathbf{c}$, where $\\mathbf{K}_{ij} = \\int_0^1 N'_{i+1,2}(x) N'_{j+1,2}(x) dx$.\n- $\\|q_h\\|_Q^2 = \\int_{0}^{1} |q_h|^2 dx = \\mathbf{d}^T \\mathbf{M} \\mathbf{d}$, where $\\mathbf{M}_{kl} = \\int_0^1 Q_{k,1}(x) Q_{l,1}(x) dx$.\n\nThe discrete inf-sup constant is given by $\\beta_h^2 = \\lambda_{\\min}$, where $\\lambda$ are the eigenvalues of the generalized eigenvalue problem:\n$$\n(\\mathbf{B} \\mathbf{K}^{-1} \\mathbf{B}^T) \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d}\n$$\n\n**Part 4: Computation of Matrices**\nThe required derivatives of the displacement basis functions are:\n$N'_{2,2}(x) = 2 - 4x$\n$N'_{3,2}(x) = 2x$\n\n- **Stiffness Matrix $\\mathbf{K}$** (for the constrained space):\n$K_{11} = \\int_0^1 (2-4x)^2 dx = \\int_0^1 (4 - 16x + 16x^2) dx = \\left[4x - 8x^2 + \\frac{16}{3}x^3\\right]_0^1 = 4-8+\\frac{16}{3} = \\frac{4}{3}$.\n$K_{12} = K_{21} = \\int_0^1 (2-4x)(2x) dx = \\int_0^1 (4x - 8x^2) dx = \\left[2x^2 - \\frac{8}{3}x^3\\right]_0^1 = 2-\\frac{8}{3} = -\\frac{2}{3}$.\n$K_{22} = \\int_0^1 (2x)^2 dx = \\int_0^1 4x^2 dx = \\left[\\frac{4}{3}x^3\\right]_0^1 = \\frac{4}{3}$.\n$$ \\mathbf{K} = \\begin{pmatrix} \\frac{4}{3}  -\\frac{2}{3} \\\\ -\\frac{2}{3}  \\frac{4}{3} \\end{pmatrix} = \\frac{2}{3}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} $$\n\n- **Pressure Mass Matrix $\\mathbf{M}$**:\n$M_{11} = \\int_0^1 (1-x)^2 dx = \\left[-\\frac{(1-x)^3}{3}\\right]_0^1 = \\frac{1}{3}$.\n$M_{12} = M_{21} = \\int_0^1 x(1-x) dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_0^1 = \\frac{1}{2}-\\frac{1}{3} = \\frac{1}{6}$.\n$M_{22} = \\int_0^1 x^2 dx = \\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{1}{3}$.\n$$ \\mathbf{M} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{6} \\\\ \\frac{1}{6}  \\frac{1}{3} \\end{pmatrix} = \\frac{1}{6}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n- **Coupling Matrix $\\mathbf{B}$**:\n$B_{11} = \\int_0^1 (1-x)(2-4x) dx = \\int_0^1 (2-6x+4x^2) dx = \\left[2x - 3x^2 + \\frac{4}{3}x^3\\right]_0^1 = 2-3+\\frac{4}{3} = \\frac{1}{3}$.\n$B_{12} = \\int_0^1 (1-x)(2x) dx = \\int_0^1 (2x-2x^2) dx = \\left[x^2 - \\frac{2}{3}x^3\\right]_0^1 = 1-\\frac{2}{3} = \\frac{1}{3}$.\n$B_{21} = \\int_0^1 x(2-4x) dx = \\int_0^1 (2x-4x^2) dx = \\left[x^2 - \\frac{4}{3}x^3\\right]_0^1 = 1-\\frac{4}{3} = -\\frac{1}{3}$.\n$B_{22} = \\int_0^1 x(2x) dx = \\int_0^1 2x^2 dx = \\left[\\frac{2}{3}x^3\\right]_0^1 = \\frac{2}{3}$.\n$$ \\mathbf{B} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{3} \\\\ -\\frac{1}{3}  \\frac{2}{3} \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1  1 \\\\ -1  2 \\end{pmatrix} $$\n\n**Part 5: Solving the Eigenvalue Problem**\nFirst, we find $\\mathbf{K}^{-1}$:\n$\\det(\\mathbf{K}) = (\\frac{2}{3})^2(2 \\cdot 2 - (-1)(-1)) = \\frac{4}{9}(3) = \\frac{4}{3}$.\n$$ \\mathbf{K}^{-1} = \\frac{1}{4/3} \\begin{pmatrix} \\frac{4}{3}  \\frac{2}{3} \\\\ \\frac{2}{3}  \\frac{4}{3} \\end{pmatrix} = \\frac{3}{4} \\frac{2}{3} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} $$\nNext, we compute the matrix $\\mathbf{S} = \\mathbf{B} \\mathbf{K}^{-1} \\mathbf{B}^T$.\n$$ \\mathbf{B} \\mathbf{K}^{-1} = \\frac{1}{3}\\begin{pmatrix} 1  1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1+\\frac{1}{2}  \\frac{1}{2}+1 \\\\ -1+1  -\\frac{1}{2}+2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} \\frac{3}{2}  \\frac{3}{2} \\\\ 0  \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ 0  \\frac{1}{2} \\end{pmatrix} $$\n$$ \\mathbf{S} = (\\mathbf{B} \\mathbf{K}^{-1})\\mathbf{B}^T = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ 0  \\frac{1}{2} \\end{pmatrix} \\frac{1}{3}\\begin{pmatrix} 1  -1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} \\frac{1}{2}+\\frac{1}{2}  -\\frac{1}{2}+1 \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\frac{1}{3}\\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{2}  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}  \\frac{1}{6} \\\\ \\frac{1}{6}  \\frac{1}{3} \\end{pmatrix} $$\nWe observe that $\\mathbf{S} = \\mathbf{M}$. The generalized eigenvalue problem $\\mathbf{S} \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d}$ thus becomes:\n$$ \\mathbf{M} \\mathbf{d} = \\lambda \\mathbf{M} \\mathbf{d} $$\nSince $\\mathbf{M}$ is invertible (as $\\det(\\mathbf{M}) = \\frac{1}{9}-\\frac{1}{36} \\neq 0$), we can multiply by $\\mathbf{M}^{-1}$ to get $\\mathbf{I} \\mathbf{d} = \\lambda \\mathbf{d}$. The eigenvalues are the eigenvalues of the identity matrix, so $\\lambda_1 = \\lambda_2 = 1$. The minimum eigenvalue is $\\lambda_{\\min} = 1$.\nThe discrete inf-sup constant is $\\beta_h = \\sqrt{\\lambda_{\\min}} = \\sqrt{1} = 1$.\n\n**Part 6: Discussion**\nThe calculated value $\\beta_h = 1$ is the maximum possible value for an inf-sup constant and indicates a perfectly stable element pairing. This optimal result is a direct consequence of the specific isogeometric spaces chosen for a single element. For Bernstein polynomials, the space spanned by the derivatives of degree-$p$ polynomials is identical to the space of polynomials of degree-$(p-1)$. In our case, after applying the boundary condition, the space of derivatives of the constrained quadratic displacement basis functions, $V'_h = \\text{span}\\{2-4x, 2x\\}$, is precisely the space of all linear polynomials. The linear pressure basis, $Q_h = \\text{span}\\{1-x, x\\}$, also spans the space of all linear polynomials. Thus, $V'_h = Q_h$.\n\nThis means for any discrete pressure $q_h \\in Q_h$, there exists a unique discrete displacement $u_h \\in V_h$ such that $\\frac{du_h}{dx} = q_h$. Choosing this particular $u_h$ in the supremum of the definition of $\\beta_h$ yields:\n$$ \\sup_{0 \\neq u_{h} \\in V_{h}} \\frac{\\int q_h \\frac{du_h}{dx} dx}{\\|u_h\\|_V \\|q_h\\|_Q} \\ge \\frac{\\int q_h \\cdot q_h dx}{\\|q_h\\|_V \\|q_h\\|_Q} = \\frac{\\|q_h\\|_Q^2}{\\|q_h\\|_Q \\|q_h\\|_Q} = 1 $$\nSince the ratio can never exceed $1$ by the Cauchy-Schwarz inequality, the supremum for any $q_h$ is exactly $1$. The infimum over all $q_h$ is therefore also $1$.\n\nIf an interior knot were inserted (e.g., at $x=1/2$), a multi-element mesh would be created. The displacement basis functions would become $C^1$-continuous quadratic splines, and the pressure basis would be $C^0$-continuous linear splines. While the derivative of a $C^1$ quadratic spline space is a $C^0$ linear spline space, and the dimensions of the derivative space $V'_h$ and the pressure space $Q_h$ would remain equal, the spaces are no longer identical in their functional form due to the differences in the underlying knot vectors used in the derivative formula versus the basis function definition. This loss of the $V'_h=Q_h$ property means the supremum part of the calculation will yield a value strictly less than $1$ for some pressure modes $q_h$. Consequently, inserting an interior knot and reducing the global continuity of the basis would be expected to decrease the discrete inf-sup constant from its perfect value of $1$. The element pair would remain stable ($\\beta_h > 0$), but it would no longer be \"perfectly\" stable.", "answer": "$$\n\\boxed{1}\n$$", "id": "3535320"}]}