{"hands_on_practices": [{"introduction": "Robust geomechanical models rely on parameters that accurately reflect the material's behavior. This exercise bridges the gap between experimental data and the theoretical framework of poroelasticity by showing how to derive fundamental constitutive constants. You will practice relating directly measurable quantities, like the drained and undrained bulk moduli ($K_d$ and $K_u$), to the core parameters of Biot's theory, namely the Biot coefficient $b$ and Biot modulus $M$. [@problem_id:3567756]", "problem": "A fully saturated, homogeneous, isotropic rock specimen is tested in a triaxial cell under isothermal conditions so that thermal effects can be neglected. The material is modeled within the framework of small-strain linear poroelasticity (Biot theory). Under an isotropic total stress increment $d\\sigma_{m}$ and pore pressure increment $dp$, the volumetric strain increment is $d\\varepsilon_{v}$. The poroelastic constitutive description introduces the drained bulk modulus $K_{d}$, the Biot coefficient $b$, and the Biot modulus $M$. The undrained response is defined by the condition of no change in fluid content. The Skempton coefficient $B$ is defined as the ratio $B = \\left(\\partial p / \\partial \\sigma_{m}\\right)_{d\\zeta = 0,\\, T}$ measured under undrained and isothermal conditions.\n\nFrom fundamental balance and constitutive relations for linear isotropic poroelasticity, derive the expressions relating the undrained bulk modulus $K_{u}$ and the Skempton coefficient $B$ to the drained bulk modulus $K_{d}$, the Biot coefficient $b$, and the Biot modulus $M$. Then, using the measured values $K_{d} = 5.0$ GPa, $K_{u} = 15.0$ GPa, $B = 0.70$, and fluid bulk modulus $K_{f} = 2.20$ GPa, compute $b$ and $M$ in closed form and evaluate them numerically. Express the final value of $M$ in gigapascals (GPa). Round both $b$ and $M$ to four significant figures.\n\nThe measurements have the following one-standard-deviation uncertainties: $K_{d}$ has $\\pm 0.10$ GPa, $K_{u}$ has $\\pm 0.20$ GPa, $B$ has $\\pm 0.02$, and $K_{f}$ has $\\pm 0.05$ GPa. Briefly comment on how experimental uncertainty propagates to $b$ and $M$ under the stated assumptions, identifying which measurements dominate the uncertainty in $b$ and $M$ and whether the uncertainty in $K_{f}$ affects the computed $b$ and $M$ through these relations.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   **Framework**: Small-strain linear poroelasticity (Biot theory).\n-   **Specimen**: Fully saturated, homogeneous, isotropic rock.\n-   **Conditions**: Isothermal.\n-   **State variables**: Isotropic total stress increment $d\\sigma_{m}$, pore pressure increment $dp$, volumetric strain increment $d\\varepsilon_{v}$.\n-   **Poroelastic parameters**: Drained bulk modulus $K_{d}$, Biot coefficient $b$, Biot modulus $M$.\n-   **Undrained response**: Defined by no change in fluid content, $d\\zeta = 0$.\n-   **Skempton coefficient**: Defined as $B = \\left(\\partial p / \\partial \\sigma_{m}\\right)_{d\\zeta = 0,\\, T}$.\n-   **Undrained bulk modulus**: $K_{u}$.\n-   **Measured values**: $K_{d} = 5.0$ GPa, $K_{u} = 15.0$ GPa, $B = 0.70$, fluid bulk modulus $K_{f} = 2.20$ GPa.\n-   **Uncertainties**: $\\sigma_{K_d} = 0.10$ GPa, $\\sigma_{K_u} = 0.20$ GPa, $\\sigma_B = 0.02$, $\\sigma_{K_f} = 0.05$ GPa.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it is based on the well-established theory of linear poroelasticity by Biot. The parameters and definitions, such as $K_d$, $K_u$, $b$, $B$, and $M$, are standard in geomechanics and porous media physics. The problem is well-posed, providing sufficient information to derive the requested relationships and compute the unknown parameters. The language is objective and precise. The provided numerical values are physically plausible for a rock: the undrained modulus $K_u$ is greater than the drained modulus $K_d$, and the Skempton's coefficient $B$ is between $0$ and $1$. The problem statement is self-contained and free of contradictions. The question regarding the uncertainty of $K_f$ is subtle but answerable within the context of the problem's formulation.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\n### Derivation of Poroelastic Relations\n\nThe constitutive relations for a linear, isotropic poroelastic material under isothermal conditions can be expressed by choosing the volumetric strain increment, $d\\varepsilon_v$, and the pore pressure increment, $dp$, as state variables. Adopting the standard sign convention in geomechanics where compressive stress and strain are positive, the relations are:\n1.  The volumetric stress-strain relation:\n    $$ d\\sigma_m = K_d d\\varepsilon_v + b dp $$\n2.  The fluid storage relation, linking the increment of fluid content $d\\zeta$ (volume of fluid per unit reference volume) to strain and pressure:\n    $$ d\\zeta = b d\\varepsilon_v + \\frac{1}{M} dp $$\nThese two equations form the basis of our derivations. An alternative, and often more convenient, formulation for the fluid behavior is:\n    $$ dp = M(b d\\varepsilon_v - d\\zeta) $$\nThis is derived by rearranging the storage relation. We will use the set:\n$$ d\\sigma_m = K_d d\\varepsilon_v + b dp \\quad (1) $$\n$$ dp = M(b d\\varepsilon_v - d\\zeta) \\quad (2) $$\n\n**Undrained Bulk Modulus, $K_u$**\nThe undrained bulk modulus, $K_u$, is defined as the ratio of the change in isotropic total stress to the change in volumetric strain under the undrained condition, where there is no change in the fluid content ($d\\zeta = 0$).\n$$ K_u \\equiv \\left(\\frac{\\partial \\sigma_m}{\\partial \\varepsilon_v}\\right)_{d\\zeta=0} $$\nSetting $d\\zeta = 0$ in equation $(2)$:\n$$ dp = M b d\\varepsilon_v \\quad (3) $$\nThis equation relates the pore pressure change to the volumetric strain under undrained conditions. Substituting this expression for $dp$ into equation $(1)$:\n$$ d\\sigma_m = K_d d\\varepsilon_v + b (M b d\\varepsilon_v) $$\n$$ d\\sigma_m = (K_d + b^2 M) d\\varepsilon_v $$\nFrom the definition of $K_u$, we obtain the first required relation:\n$$ K_u = K_d + b^2 M $$\n\n**Skempton's Coefficient, $B$**\nThe Skempton coefficient, $B$, is defined as the ratio of the change in pore pressure to the change in isotropic total stress under undrained conditions ($d\\zeta = 0$).\n$$ B \\equiv \\left(\\frac{\\partial p}{\\partial \\sigma_m}\\right)_{d\\zeta=0} $$\nWe have already derived expressions for $dp$ and $d\\sigma_m$ under undrained conditions. From equation $(3)$, we have $dp = M b d\\varepsilon_v$. And from the derivation for $K_u$, we have $d\\sigma_m = K_u d\\varepsilon_v$. Taking the ratio of these two expressions:\n$$ B = \\frac{dp}{d\\sigma_m} = \\frac{M b d\\varepsilon_v}{K_u d\\varepsilon_v} $$\nThis gives the second required relation:\n$$ B = \\frac{b M}{K_u} $$\n\n### Computation of $b$ and $M$\n\nWe now have a system of two equations with two unknowns, $b$ and $M$:\n$$ K_u = K_d + b^2 M \\quad (I) $$\n$$ B = \\frac{b M}{K_u} \\quad (II) $$\nWe are given the values for $K_u$, $K_d$, and $B$. We solve for $b$ and $M$.\n\nFrom equation $(I)$, we can write:\n$$ b^2 M = K_u - K_d $$\nThis can be written as $b(bM) = K_u - K_d$.\nFrom equation $(II)$, we can express the product $bM$ as:\n$$ bM = B K_u $$\nSubstituting this into the rearranged equation $(I)$:\n$$ b (B K_u) = K_u - K_d $$\nSolving for $b$ gives the closed-form expression:\n$$ b = \\frac{K_u - K_d}{B K_u} $$\nNow, we can find $M$ by substituting this expression for $b$ back into the relation $M = BK_u/b$:\n$$ M = \\frac{B K_u}{\\frac{K_u - K_d}{B K_u}} = \\frac{(B K_u)^2}{K_u - K_d} $$\n\n**Numerical Evaluation**\nGiven values: $K_{d} = 5.0$ GPa, $K_{u} = 15.0$ GPa, $B = 0.70$.\n$$ b = \\frac{15.0 - 5.0}{0.70 \\times 15.0} = \\frac{10.0}{10.5} \\approx 0.95238... $$\nRounding to four significant figures, $b = 0.9524$.\n\n$$ M = \\frac{(0.70 \\times 15.0)^2}{15.0 - 5.0} = \\frac{(10.5)^2}{10.0} = \\frac{110.25}{10.0} = 11.025 \\text{ GPa} $$\nRounding to four significant figures, $M = 11.03$ GPa.\n\n### Comments on Uncertainty Propagation\n\nThe propagation of experimental uncertainty affects the reliability of the computed values for $b$ and $M$.\n\nFor the Biot coefficient $b = \\frac{K_u - K_d}{B K_u}$:\nThe value of $b$ is computed from three measured quantities: $K_u$, $K_d$, and $B$. The uncertainty in $b$ is therefore a combination of the uncertainties in these measurements. The calculation involves the difference $K_u - K_d$ in the numerator. The relative uncertainty of a difference of two nearly equal numbers can be very large. In our case, $K_u$ is significantly larger than $K_d$, so this effect is mitigated but still present. The dominant source of relative uncertainty among the inputs is for $B$, where a $\\pm0.02$ uncertainty on a value of $0.70$ corresponds to a relative uncertainty of $\\frac{0.02}{0.70} \\approx 2.9\\%$. The relative uncertainty for $K_u$ is $\\frac{0.20}{15.0} \\approx 1.3\\%$. The uncertainty in $B$ is thus a dominant factor in the uncertainty of the calculation of $b$.\n\nFor the Biot modulus $M = \\frac{(B K_u)^2}{K_u - K_d}$:\nThe uncertainty in $M$ also depends on the uncertainties in $K_u$, $K_d$, and $B$. In this expression, the term $B K_u$ is squared. In standard error propagation, the relative uncertainty of a product is the quadrature sum of the relative uncertainties of its factors, and the exponent acts as a multiplier on the relative uncertainty. Therefore, the relative uncertainty of $(B K_u)^2$ is approximately twice the relative uncertainty of $B K_u$. As with $b$, the uncertainty in $B$ significantly influences the uncertainty in the product $B K_u$. This amplified uncertainty, combined with the uncertainty from the difference term in the denominator, means that the uncertainty in $M$ is also dominated by the measurement uncertainty of $B$.\n\nRegarding the fluid bulk modulus $K_f$:\nThe expressions used to compute $b$ and $M$ are $b = \\frac{K_u - K_d}{B K_u}$ and $M = \\frac{(B K_u)^2}{K_u - K_d}$. Neither of these relations contains $K_f$. Therefore, in the context of this specific calculation path, the uncertainty in the measurement of $K_f$ does not propagate to the computed values of $b$ and $M$. It is important to note that the poroelastic parameters are not all independent. The Biot modulus $M$, for instance, has a physical definition that involves $K_f$, the solid grain bulk modulus $K_s$, and the porosity $\\phi$. If a different set of measurements were provided and a different computational path were used (e.g., one that explicitly used the definition of $M$ to find another parameter), then the uncertainty in $K_f$ would indeed have an effect. However, based on the calculation requested and performed, the uncertainty in $K_f$ is irrelevant.", "answer": "$$\\boxed{\\begin{pmatrix} 0.9524 & 11.03 \\end{pmatrix}}$$", "id": "3567756"}, {"introduction": "Once material properties are defined, we must understand the dominant physical processes at play. This practice explores the competition between heat transport by fluid flow (advection) and by diffusion (conduction), a central theme in THM analysis. By deriving and calculating the dimensionless Péclet number, you will learn to quantitatively assess which transport mechanism governs the system's thermal response and appreciate the critical implications for designing stable and accurate numerical simulations. [@problem_id:3567770]", "problem": "A fully saturated, rigid, homogeneous porous column of length $L$ is subjected to steady, uniform single-phase flow in the axial direction with constant seepage (Darcy) velocity magnitude $\\|\\boldsymbol{w}\\|$. The pore fluid is incompressible with density $\\rho_f$ and specific heat capacity at constant pressure $c_f$. Heat conduction in the saturated porous medium is characterized by an effective thermal conductivity $\\lambda$. Volumetric heat sources are negligible, thermal properties are constant, and mechanical work and viscous dissipation are ignored.\n\nStarting from conservation of energy for a saturated porous medium in one spatial dimension, nondimensionalize the governing equation to obtain a dimensionless group that quantifies the ratio of advective to conductive heat transport. Then, using the provided data, compute the value of this dimensionless group for the column. Finally, based on first principles, explain the physical and computational implications of the two limiting transport regimes corresponding to this group being much smaller than one and much larger than one. Report the computed value as a pure number (dimensionless).\n\nUse the following data:\n- Column length: $L = 10 \\ \\mathrm{m}$.\n- Seepage (Darcy) velocity magnitude: $\\|\\boldsymbol{w}\\| = 1.0 \\times 10^{-7} \\ \\mathrm{m/s}$.\n- Fluid density: $\\rho_f = 1000 \\ \\mathrm{kg/m^3}$.\n- Fluid specific heat capacity: $c_f = 4180 \\ \\mathrm{J/(kg \\cdot K)}$.\n- Effective thermal conductivity: $\\lambda = 2.5 \\ \\mathrm{W/(m \\cdot K)}$.\n\nRound your final numerical answer to four significant figures and express it as a dimensionless number with no units. The interpretation should be included in your reasoning, but the final reported answer must be only the computed number.", "solution": "The problem requires the derivation and calculation of a dimensionless group governing heat transport in a saturated porous medium, followed by an interpretation of its physical and computational significance.\n\nThe first step is to establish the governing equation for heat transport based on the principle of conservation of energy. For a saturated porous medium, considering heat transport by conduction and advection, and neglecting heat sources, mechanical work, and viscous dissipation, the energy balance equation in one spatial dimension (let's denote the axial direction by $x$) is:\n$$\n(\\rho c)_m \\frac{\\partial T}{\\partial t} = -\\frac{\\partial q_c}{\\partial x} - \\frac{\\partial q_a}{\\partial x}\n$$\nwhere $T$ is the temperature, $t$ is time, and $(\\rho c)_m$ is the effective volumetric heat capacity of the saturated porous medium. The term $q_c$ represents the conductive heat flux, and $q_a$ represents the advective heat flux.\n\nThe conductive heat flux is described by Fourier's law:\n$$\nq_c = -\\lambda \\frac{\\partial T}{\\partial x}\n$$\nwhere $\\lambda$ is the effective thermal conductivity of the saturated medium.\n\nThe advective heat flux is due to the flow of the pore fluid, which carries thermal energy. It is given by:\n$$\nq_a = (\\rho_f c_f T) w_x\n$$\nwhere $\\rho_f$ is the fluid density, $c_f$ is the fluid specific heat capacity, and $w_x$ is the Darcy (seepage) velocity in the $x$ direction.\n\nSubstituting these flux definitions into the conservation equation yields:\n$$\n(\\rho c)_m \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(\\lambda \\frac{\\partial T}{\\partial x}\\right) - \\frac{\\partial}{\\partial x}(\\rho_f c_f w_x T)\n$$\nThe problem specifies steady flow, and we are interested in the transport regime, which is characterized by the steady-state temperature distribution. Therefore, we set the time-derivative term to zero, $\\frac{\\partial T}{\\partial t} = 0$. The properties $\\lambda$, $\\rho_f$, $c_f$, and the velocity $w_x$ are given as constant. The seepage velocity magnitude $\\|\\boldsymbol{w}\\|$ is given, and since the flow is uniform and axial, we have $w_x = \\|\\boldsymbol{w}\\|$. The steady-state governing equation simplifies to:\n$$\n0 = \\lambda \\frac{d^2T}{dx^2} - \\rho_f c_f w_x \\frac{dT}{dx}\n$$\nThis is the one-dimensional, steady-state advection-conduction equation for temperature.\n\nTo identify the relevant dimensionless group, we nondimensionalize this equation. Let us introduce a dimensionless coordinate $\\xi$ and a dimensionless temperature $\\theta$. A natural choice for the characteristic length is the column length $L$. For temperature, we can define a dimensionless form based on two reference temperatures, for instance, the temperatures at the boundaries $T(x=0) = T_0$ and $T(x=L) = T_L$.\n$$\n\\xi = \\frac{x}{L}\n$$\n$$\n\\theta(\\xi) = \\frac{T(x) - T_L}{T_0 - T_L}\n$$\nThe derivatives transform according to the chain rule:\n$$\n\\frac{d T}{d x} = \\frac{d T}{d \\theta} \\frac{d \\theta}{d \\xi} \\frac{d \\xi}{d x} = (T_0 - T_L) \\frac{d\\theta}{d\\xi} \\frac{1}{L}\n$$\n$$\n\\frac{d^2 T}{d x^2} = \\frac{d}{dx}\\left( \\frac{T_0 - T_L}{L} \\frac{d\\theta}{d\\xi} \\right) = \\frac{T_0 - T_L}{L^2} \\frac{d^2\\theta}{d\\xi^2}\n$$\nSubstituting these into the governing equation gives:\n$$\n\\lambda \\frac{T_0 - T_L}{L^2} \\frac{d^2\\theta}{d\\xi^2} - \\rho_f c_f w_x \\frac{T_0 - T_L}{L} \\frac{d\\theta}{d\\xi} = 0\n$$\nAssuming a non-trivial temperature difference ($T_0 \\neq T_L$), we can divide the equation by the term $\\lambda \\frac{T_0 - T_L}{L^2}$:\n$$\n\\frac{d^2\\theta}{d\\xi^2} - \\left(\\frac{\\rho_f c_f w_x L}{\\lambda}\\right) \\frac{d\\theta}{d\\xi} = 0\n$$\nThe dimensionless group that quantifies the ratio of advective to conductive heat transport is the coefficient of the first-derivative term. This is the Péclet number, $Pe$:\n$$\nPe = \\frac{\\rho_f c_f w_x L}{\\lambda}\n$$\nThis number represents the ratio of the characteristic rate of heat advection, $\\sim \\rho_f c_f w_x \\Delta T / L$, to the characteristic rate of heat conduction, $\\sim \\lambda \\Delta T / L^2$.\n\nNext, we compute the value of the Péclet number using the provided data:\n- Column length: $L = 10 \\ \\mathrm{m}$\n- Seepage velocity magnitude: $w_x = \\|\\boldsymbol{w}\\| = 1.0 \\times 10^{-7} \\ \\mathrm{m/s}$\n- Fluid density: $\\rho_f = 1000 \\ \\mathrm{kg/m^3}$\n- Fluid specific heat capacity: $c_f = 4180 \\ \\mathrm{J/(kg \\cdot K)}$\n- Effective thermal conductivity: $\\lambda = 2.5 \\ \\mathrm{W/(m \\cdot K)}$\n\nSubstituting these values into the expression for $Pe$:\n$$\nPe = \\frac{(1000 \\ \\mathrm{kg/m^3}) \\times (4180 \\ \\mathrm{J/(kg \\cdot K)}) \\times (1.0 \\times 10^{-7} \\ \\mathrm{m/s}) \\times (10 \\ \\mathrm{m})}{2.5 \\ \\mathrm{W/(m \\cdot K)}}\n$$\nRecalling that $1 \\ \\mathrm{W} = 1 \\ \\mathrm{J/s}$, the units cancel out, confirming that $Pe$ is dimensionless.\n$$\nPe = \\frac{1000 \\times 4180 \\times 1.0 \\times 10^{-7} \\times 10}{2.5} = \\frac{4.180 \\times 10^0}{2.5} = 1.672\n$$\nRounding to four significant figures as requested, the value is $1.672$.\n\nFinally, we explain the physical and computational implications of the two limiting transport regimes based on the Péclet number.\n\n1.  **Conduction-Dominated Regime ($Pe \\ll 1$)**:\n    *   **Physical Implications**: When the Péclet number is much less than one, heat transport by conduction dominates over transport by advection. The slow-moving fluid has a negligible effect on the temperature distribution. The temperature profile across the column approaches the linear profile characteristic of pure conduction in a stationary medium. Heat diffuses efficiently through the solid and fluid matrix, smoothing out temperature gradients rapidly.\n    *   **Computational Implications**: In this regime, the governing differential equation is dominated by the second-order diffusion term ($\\frac{d^2\\theta}{d\\xi^2}$). Such diffusion-dominated problems are numerically stable and can be solved accurately using standard discretization methods like the central difference scheme for finite differences or standard Galerkin methods for finite elements. The solutions are smooth, and relatively coarse computational meshes can yield accurate results.\n\n2.  **Advection-Dominated Regime ($Pe \\gg 1$)**:\n    *   **Physical Implications**: When the Péclet number is much larger than one, heat transport by advection (fluid flow) dominates over transport by conduction. The fluid effectively carries its thermal energy along its flow path, with very little heat diffusing into the surrounding medium. This leads to the formation of sharp temperature fronts. The temperature profile will exhibit a steep gradient near the upstream boundary and will be relatively flat downstream, as the temperature is advected with the flow.\n    *   **Computational Implications**: Computationally, this regime is far more challenging. The governing equation is dominated by the first-order advection term ($Pe \\frac{d\\theta}{d\\xi}$), making it resemble a hyperbolic partial differential equation. Standard numerical schemes like central differences are prone to severe, non-physical oscillations (numerical dispersion or \"wiggles\") unless the mesh is extremely fine, such that the mesh Péclet number (a cell-level equivalent, $Pe_m = Pe \\frac{\\Delta x}{L}$) is kept below a critical value (typically around $2$). To overcome this instability on practical meshes, specialized numerical techniques are required, such as upwind schemes (which introduce numerical diffusion to stabilize the solution), flux-limiting methods, or stabilized finite element formulations (e.g., Streamline-Upwind Petrov-Galerkin, SUPG). These methods are essential for capturing sharp fronts accurately without spurious oscillations.", "answer": "$$\\boxed{1.672}$$", "id": "3567770"}, {"introduction": "This final exercise takes you to the core of computational implementation in geomechanics. Starting from a thermodynamically consistent potential—the Helmholtz Free Energy—you will construct the discrete building blocks of a fully coupled Thermo-Hydro-Mechanical (THM) finite element. This practice illuminates how the abstract governing equations are translated into a concrete numerical system, and in doing so, reveals the elegant symmetry inherent in the coupled problem when derived from a variational framework. [@problem_id:3567769]", "problem": "Consider a one-dimensional small-strain Thermo-Hydro-Mechanical (THM) porothermoelastic bar element with two nodes, occupying the interval $\\left[0,L\\right]$ with constant cross-sectional area $A$. The unknown fields are the displacement $u(x)$, the pore pressure $p(x)$, and the temperature $T(x)$. Use linear shape functions $N_1(x)=1-\\dfrac{x}{L}$ and $N_2(x)=\\dfrac{x}{L}$ to approximate all fields, that is $u(x)=N_1(x)u_1+N_2(x)u_2$, $p(x)=N_1(x)p_1+N_2(x)p_2$, and $T(x)=N_1(x)T_1+N_2(x)T_2$. Let the strain be $\\varepsilon(x)=\\dfrac{du}{dx}$, and define the constant strain-displacement operator $B=\\left[-\\dfrac{1}{L},\\dfrac{1}{L}\\right]$ such that $\\varepsilon(x)=B\\boldsymbol{u}$ with $\\boldsymbol{u}=\\left[u_1,u_2\\right]^T$.\n\nAssume a quadratic Helmholtz Free Energy (HFE) density $\\psi$ per unit volume for a linearly porothermoelastic medium,\n$$\n\\psi(\\varepsilon,p,\\theta)=\\dfrac{1}{2}E\\,\\varepsilon^2 - E\\,\\alpha_s\\,\\theta\\,\\varepsilon - b\\,p\\,\\varepsilon - \\dfrac{1}{2}M\\,p^2 - \\beta\\,p\\,\\theta - \\dfrac{1}{2}H\\,\\theta^2\n$$\nwhere $E$ is the Young's modulus, $b$ is the Biot coefficient, $M$ is the storage modulus, $\\alpha_s$ is the linear thermal expansion coefficient, $\\beta$ is the thermal pressurization coupling coefficient, $H$ is the volumetric heat capacity, and $\\theta:=T-T_0$ is the temperature increment relative to a fixed reference $T_0$. All coefficients are constants. By construction, the stress $\\sigma$, the fluid content $m$, and the entropy $s$ follow from thermodynamic conjugacy as\n$$\n\\sigma=\\dfrac{\\partial\\psi}{\\partial\\varepsilon},\\quad m=-\\dfrac{\\partial\\psi}{\\partial p},\\quad s=-\\dfrac{\\partial\\psi}{\\partial T}.\n$$\n\nFor an implicit backward Euler time increment of size $\\Delta t$, define the discrete incremental potential functional for one element,\n$$\n\\mathcal{F}(\\boldsymbol{u},\\boldsymbol{p},\\boldsymbol{T})=\\int_0^L A\\,\\psi\\big(\\varepsilon(x),p(x),\\theta(x)\\big)\\,dx + \\dfrac{\\Delta t}{2}\\int_0^L A\\,\\kappa_p\\,\\left(\\dfrac{dp}{dx}\\right)^2\\,dx + \\dfrac{\\Delta t}{2}\\int_0^L A\\,\\kappa_T\\,\\left(\\dfrac{dT}{dx}\\right)^2\\,dx,\n$$\nwhere $\\boldsymbol{p}=\\left[p_1,p_2\\right]^T$, $\\boldsymbol{T}=\\left[T_1,T_2\\right]^T$, $\\kappa_p\\ge 0$ is a hydraulic diffusion-like coefficient and $\\kappa_T\\ge 0$ is a thermal conductivity-like coefficient. The monolithic tangent matrix blocks for the coupled system are defined as the Hessian of $\\mathcal{F}$ with respect to the nodal unknowns,\n$$\n\\boldsymbol{K}_{uu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{u}},\\quad\n\\boldsymbol{K}_{pp}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{p}},\\quad\n\\boldsymbol{K}_{TT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{T}},\n$$\nand the off-diagonal couplings,\n$$\n\\boldsymbol{K}_{up}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{p}},\\quad\n\\boldsymbol{K}_{uT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{T}},\\quad\n\\boldsymbol{K}_{pT}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{T}},\n$$\nwith transpose relations $\\boldsymbol{K}_{pu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p}\\,\\partial \\boldsymbol{u}}$, $\\boldsymbol{K}_{Tu}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{u}}$, and $\\boldsymbol{K}_{Tp}=\\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T}\\,\\partial \\boldsymbol{p}}$.\n\nTask: Starting from the above functional, assemble all tangent blocks for a single $2$-node element using the specified linear shape functions and constant $B$. Then, verify the symmetry of the off-diagonal couplings implied by the potential by testing whether $\\boldsymbol{K}_{up}=\\boldsymbol{K}_{pu}^T$, $\\boldsymbol{K}_{uT}=\\boldsymbol{K}_{Tu}^T$, and $\\boldsymbol{K}_{pT}=\\boldsymbol{K}_{Tp}^T$ hold numerically within a tolerance of $\\varepsilon_{\\text{tol}}=10^{-12}$ under the standard Euclidean norm for matrices. Produce a boolean for each checked equality.\n\nUnits: Use $L$ in meters, $A$ in square meters, $\\Delta t$ in seconds, $E$ and $M$ in pascals, $b$ dimensionless, $\\alpha_s$ in reciprocal kelvin, $\\beta$ in pascal per kelvin, $H$ in joules per cubic meter per kelvin, $\\kappa_p$ in meter per second times a compressibility factor such that $A\\,\\kappa_p\\,\\left(\\dfrac{dp}{dx}\\right)^2$ has units of energy per unit length, and $\\kappa_T$ in watt per meter per kelvin.\n\nTest Suite: Use the following three parameter sets to exercise typical, decoupled, and sign-changed coupling cases.\n\n- Case $1$ (typical): $L=1.0$, $A=1.0$, $\\Delta t=1.0$, $E=3.0\\times 10^9$, $b=0.6$, $M=2.5\\times 10^8$, $\\alpha_s=1.2\\times 10^{-5}$, $\\beta=1.0\\times 10^6$, $H=2.0\\times 10^6$, $\\kappa_p=1.0\\times 10^{-12}$, $\\kappa_T=10.0$.\n- Case $2$ (decoupled edge): $L=2.0$, $A=0.5$, $\\Delta t=0.1$, $E=1.0\\times 10^9$, $b=0.0$, $M=1.0\\times 10^8$, $\\alpha_s=0.0$, $\\beta=0.0$, $H=1.0\\times 10^6$, $\\kappa_p=5.0\\times 10^{-13}$, $\\kappa_T=1.0$.\n- Case $3$ (sign-changed thermal pressurization): $L=0.75$, $A=1.5$, $\\Delta t=5.0$, $E=2.2\\times 10^9$, $b=0.95$, $M=5.0\\times 10^8$, $\\alpha_s=2.5\\times 10^{-5}$, $\\beta=-5.0\\times 10^5$, $H=3.5\\times 10^6$, $\\kappa_p=2.0\\times 10^{-12}$, $\\kappa_T=20.0$.\n\nOutput Specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output the booleans for the three symmetry checks in the order $\\left[\\boldsymbol{K}_{up}\\stackrel{?}{=}\\boldsymbol{K}_{pu}^T,\\ \\boldsymbol{K}_{uT}\\stackrel{?}{=}\\boldsymbol{K}_{Tu}^T,\\ \\boldsymbol{K}_{pT}\\stackrel{?}{=}\\boldsymbol{K}_{Tp}^T\\right]$, flattened across the three cases, resulting in a list of length $9$.", "solution": "The user provides a problem in the field of computational geomechanics, specifically concerning Thermo-Hydro-Mechanical (THM) coupling in a one-dimensional porothermoelastic medium.\n\n### Problem Validation\n\n1.  **Extract Givens**:\n    -   **Geometry and Discretization**: A 1D bar element of length $L$ and constant area $A$ with two nodes. Linear shape functions $N_1(x)=1-x/L$ and $N_2(x)=x/L$ are used for displacement $u$, pore pressure $p$, and temperature $T$. The nodal unknowns are $\\boldsymbol{u}=[u_1, u_2]^T$, $\\boldsymbol{p}=[p_1, p_2]^T$, and $\\boldsymbol{T}=[T_1, T_2]^T$.\n    -   **Kinematics**: Strain $\\varepsilon(x) = du/dx = \\boldsymbol{B}\\boldsymbol{u}$, with constant strain-displacement operator $\\boldsymbol{B} = [-1/L, 1/L]$.\n    -   **Thermodynamics**: A quadratic Helmholtz Free Energy (HFE) density is given: $\\psi(\\varepsilon,p,\\theta)=\\dfrac{1}{2}E\\,\\varepsilon^2 - E\\,\\alpha_s\\,\\theta\\,\\varepsilon - b\\,p\\,\\varepsilon - \\dfrac{1}{2}M\\,p^2 - \\beta\\,p\\,\\theta - \\dfrac{1}{2}H\\,\\theta^2$, where $\\theta=T-T_0$.\n    -   **Constitutive Relations**: $\\sigma=\\partial\\psi/\\partial\\varepsilon$, $m=-\\partial\\psi/\\partial p$, $s=-\\partial\\psi/\\partial T$.\n    -   **Potential Functional**: An incremental potential $\\mathcal{F}$ for an implicit backward Euler time step $\\Delta t$ is defined as $\\mathcal{F}(\\boldsymbol{u},\\boldsymbol{p},\\boldsymbol{T})=\\int_0^L A\\,\\psi\\,dx + \\frac{\\Delta t}{2}\\int_0^L A\\,\\kappa_p\\,(dp/dx)^2\\,dx + \\frac{\\Delta t}{2}\\int_0^L A\\,\\kappa_T\\,(dT/dx)^2\\,dx$.\n    -   **Tangent Matrices**: Defined as the Hessian blocks of $\\mathcal{F}$ with respect to nodal unknowns, e.g., $\\boldsymbol{K}_{uu}=\\partial^2 \\mathcal{F}/(\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{u})$, $\\boldsymbol{K}_{up}=\\partial^2 \\mathcal{F}/(\\partial \\boldsymbol{u}\\,\\partial \\boldsymbol{p})$, etc.\n    -   **Task**: Assemble all tangent blocks and numerically verify the symmetry relations $\\boldsymbol{K}_{up}=\\boldsymbol{K}_{pu}^T$, $\\boldsymbol{K}_{uT}=\\boldsymbol{K}_{Tu}^T$, and $\\boldsymbol{K}_{pT}=\\boldsymbol{K}_{Tp}^T$ using a tolerance $\\varepsilon_{\\text{tol}}=10^{-12}$.\n    -   ** Test Cases**: Three distinct sets of material and geometric parameters are provided.\n\n2.  **Validate**:\n    -   The problem is **scientifically grounded**. It employs the standard Finite Element Method (FEM) framework for coupled problems in continuum mechanics, derived from a valid thermodynamic potential (Helmholtz Free Energy).\n    -   The problem is **well-posed**. All necessary information is provided, and the task is specific and achievable. A potential-based formulation guarantees a symmetric Hessian, so the symmetry check is a valid verification exercise.\n    -   The problem is **objective**. It uses precise mathematical and scientific language.\n    -   The problem is **complete and consistent**. All parameters are defined, and there are no contradictions.\n    -   The parameter values are **realistic** for geological materials.\n\n3.  **Verdict**: The problem is **valid**.\n\n### Solution Derivation\n\nThe solution requires deriving the tangent stiffness matrices by taking the second partial derivatives of the potential functional $\\mathcal{F}$ with respect to the nodal unknown vectors $\\boldsymbol{u}$, $\\boldsymbol{p}$, and $\\boldsymbol{T}$.\n\nFirst, we express the fields and their gradients using the shape functions $\\boldsymbol{N}(x) = [N_1(x), N_2(x)]$ and the strain-displacement operator $\\boldsymbol{B} = [-1/L, 1/L]$:\n-   $p(x) = \\boldsymbol{N}(x)\\boldsymbol{p}$ and $T(x) = \\boldsymbol{N}(x)\\boldsymbol{T}$ (we can work with temperature increment $\\theta$ as a variable, as the reference $T_0$ is constant).\n-   $\\varepsilon(x) = \\boldsymbol{B}\\boldsymbol{u}$, $dp/dx = \\boldsymbol{B}\\boldsymbol{p}$, $dT/dx = \\boldsymbol{B}\\boldsymbol{T}$.\n\nThe potential functional $\\mathcal{F}$ can be expressed in a quadratic matrix form. We first evaluate the necessary integral matrices over the element length $L$:\n-   $\\boldsymbol{M}_{BB} = \\int_0^L \\boldsymbol{B}^T \\boldsymbol{B} \\,dx = \\int_0^L \\begin{bmatrix} 1/L^2 & -1/L^2 \\\\ -1/L^2 & 1/L^2 \\end{bmatrix} dx = \\dfrac{1}{L}\\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$\n-   $\\boldsymbol{M}_{NN} = \\int_0^L \\boldsymbol{N}^T \\boldsymbol{N} \\,dx = \\int_0^L \\begin{bmatrix} (1-x/L)^2 & (1-x/L)(x/L) \\\\ (1-x/L)(x/L) & (x/L)^2 \\end{bmatrix} dx = \\dfrac{L}{6}\\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$\n-   $\\boldsymbol{M}_{BN} = \\int_0^L \\boldsymbol{B}^T \\boldsymbol{N} \\,dx = \\int_0^L \\begin{bmatrix} -1/L \\\\ 1/L \\end{bmatrix}[1-x/L, x/L] dx = \\begin{bmatrix} -1/2 & -1/2 \\\\ 1/2 & 1/2 \\end{bmatrix}$\n\nSubstituting these into the functional $\\mathcal{F}$, we get a quadratic form in terms of $\\boldsymbol{u}$, $\\boldsymbol{p}$, and $\\boldsymbol{T}$. The tangent matrices are the Hessians of this quadratic form. Using matrix calculus rules ($\\frac{\\partial^2}{\\partial \\boldsymbol{x} \\partial \\boldsymbol{y}} (\\boldsymbol{x}^T \\boldsymbol{A} \\boldsymbol{y}) = \\boldsymbol{A}^T$ and $\\frac{\\partial^2}{\\partial \\boldsymbol{y} \\partial \\boldsymbol{x}} (\\boldsymbol{x}^T \\boldsymbol{A} \\boldsymbol{y}) = \\boldsymbol{A}$), we derive the off-diagonal coupling blocks:\n\n1.  **Mechanical-Hydraulic Coupling ($\\boldsymbol{u}-\\boldsymbol{p}$)**:\n    -   The corresponding term in $\\mathcal{F}$ is $-A b \\int_0^L (\\boldsymbol{B}\\boldsymbol{u}) (\\boldsymbol{N}\\boldsymbol{p}) dx = -A b\\, \\boldsymbol{u}^T \\boldsymbol{M}_{BN} \\boldsymbol{p}$.\n    -   $\\boldsymbol{K}_{up} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u} \\partial \\boldsymbol{p}} = -A b\\, \\boldsymbol{M}_{BN}^T$\n    -   $\\boldsymbol{K}_{pu} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p} \\partial \\boldsymbol{u}} = -A b\\, \\boldsymbol{M}_{BN}$\n    -   The symmetry check is $\\boldsymbol{K}_{up} = \\boldsymbol{K}_{pu}^T$, which simplifies to $-A b\\, \\boldsymbol{M}_{BN}^T = (-A b\\, \\boldsymbol{M}_{BN})^T$, an identity.\n\n2.  **Thermo-Mechanical Coupling ($\\boldsymbol{u}-\\boldsymbol{T}$)**:\n    -   The term is $-A E \\alpha_s \\int_0^L (\\boldsymbol{B}\\boldsymbol{u}) (\\boldsymbol{N}\\boldsymbol{T}) dx = -A E \\alpha_s \\boldsymbol{u}^T \\boldsymbol{M}_{BN} \\boldsymbol{T}$.\n    -   $\\boldsymbol{K}_{uT} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{u} \\partial \\boldsymbol{T}} = -A E \\alpha_s \\boldsymbol{M}_{BN}^T$\n    -   $\\boldsymbol{K}_{Tu} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T} \\partial \\boldsymbol{u}} = -A E \\alpha_s \\boldsymbol{M}_{BN}$\n    -   The symmetry check is $\\boldsymbol{K}_{uT} = \\boldsymbol{K}_{Tu}^T$, which simplifies to $-A E \\alpha_s \\boldsymbol{M}_{BN}^T = (-A E \\alpha_s \\boldsymbol{M}_{BN})^T$, also an identity.\n\n3.  **Thermo-Hydraulic Coupling ($\\boldsymbol{p}-\\boldsymbol{T}$)**:\n    -   The term is $-A \\beta \\int_0^L (\\boldsymbol{N}\\boldsymbol{p}) (\\boldsymbol{N}\\boldsymbol{T}) dx = -A \\beta\\, \\boldsymbol{p}^T \\boldsymbol{M}_{NN} \\boldsymbol{T}$.\n    -   $\\boldsymbol{K}_{pT} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{p} \\partial \\boldsymbol{T}} = -A \\beta\\, \\boldsymbol{M}_{NN}^T = -A \\beta\\, \\boldsymbol{M}_{NN}$ (since $\\boldsymbol{M}_{NN}$ is symmetric).\n    -   $\\boldsymbol{K}_{Tp} = \\dfrac{\\partial^2 \\mathcal{F}}{\\partial \\boldsymbol{T} \\partial \\boldsymbol{p}} = -A \\beta\\, \\boldsymbol{M}_{NN}$\n    -   The symmetry check is $\\boldsymbol{K}_{pT} = \\boldsymbol{K}_{Tp}^T$. Since $\\boldsymbol{K}_{pT}$ and $\\boldsymbol{K}_{Tp}$ are equal and symmetric, the relation holds.\n\nThe numerical implementation will compute these matrices for each test case and verify the symmetry relations hold within the specified floating-point tolerance. As the symmetry is analytically guaranteed by the potential formulation, all checks are expected to pass.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the THM tangent matrix blocks and verifies the symmetry\n    of the off-diagonal coupling blocks.\n    \"\"\"\n\n    # Test cases parameters in the order:\n    # L, A, dt, E, b, M, alpha_s, beta, H, kappa_p, kappa_T\n    test_cases = [\n        # Case 1 (typical)\n        (\n            1.0, 1.0, 1.0, 3.0e9, 0.6, 2.5e8,\n            1.2e-5, 1.0e6, 2.0e6,\n            1.0e-12, 10.0\n        ),\n        # Case 2 (decoupled edge)\n        (\n            2.0, 0.5, 0.1, 1.0e9, 0.0, 1.0e8,\n            0.0, 0.0, 1.0e6,\n            5.0e-13, 1.0\n        ),\n        # Case 3 (sign-changed thermal pressurization)\n        (\n            0.75, 1.5, 5.0, 2.2e9, 0.95, 5.0e8,\n            2.5e-5, -5.0e5, 3.5e6,\n            2.0e-12, 20.0\n        ),\n    ]\n\n    tol = 1e-12\n    all_results = []\n\n    for case in test_cases:\n        L, A, dt, E, b, M, alpha_s, beta, H, kappa_p, kappa_T = case\n        \n        # Integral matrices based on linear shape functions for a 2-node element\n        # M_BN = integral(B^T * N) dx from 0 to L\n        M_BN = np.array([[-0.5, -0.5], [0.5, 0.5]])\n        \n        # M_NN = integral(N^T * N) dx from 0 to L\n        M_NN = (L / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n\n        # The Hessian of a potential is always symmetric, so K_XY = (K_YX)^T.\n        # This is what we will verify. The derivations are based on the second\n        # partial derivatives of the potential functional F.\n\n        # 1. Mechanical-Hydraulic Coupling (u-p)\n        # Term: -A*b * u^T * M_BN * p\n        # K_up = d^2(F)/du/dp = -A * b * M_BN^T\n        # K_pu = d^2(F)/dp/du = -A * b * M_BN\n        \n        K_up = -A * b * M_BN.T\n        K_pu = -A * b * M_BN\n\n        # 2. Thermo-Mechanical Coupling (u-T)\n        # Term: -A*E*alpha_s * u^T * M_BN * T\n        # K_uT = d^2(F)/du/dT = -A * E * alpha_s * M_BN^T\n        # K_Tu = d^2(F)/dT/du = -A * E * alpha_s * M_BN\n\n        K_uT = -A * E * alpha_s * M_BN.T\n        K_Tu = -A * E * alpha_s * M_BN\n        \n        # 3. Thermo-Hydraulic Coupling (p-T)\n        # Term: -A*beta * p^T * M_NN * T\n        # K_pT = d^2(F)/dp/dT = -A * beta * M_NN^T = -A * beta * M_NN (as M_NN is symmetric)\n        # K_Tp = d^2(F)/dT/dp = -A * beta * M_NN\n\n        K_pT = -A * beta * M_NN\n        K_Tp = -A * beta * M_NN\n\n        # Perform symmetry checks using the Frobenius norm of the difference\n        check_up_pu = np.linalg.norm(K_up - K_pu.T)  tol\n        check_uT_Tu = np.linalg.norm(K_uT - K_Tu.T)  tol\n        check_pT_Tp = np.linalg.norm(K_pT - K_Tp.T)  tol\n        \n        all_results.extend([check_up_pu, check_uT_Tu, check_pT_Tp])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3567769"}]}