{"hands_on_practices": [{"introduction": "We begin with the most direct application of wave propagation theory to create an absorbing boundary. This exercise guides you through deriving the classic Lysmer-Kuhlemeyer dashpot coefficients by relating traction to particle velocity for normally incident plane waves, a concept known as wave impedance. Understanding this derivation is crucial for appreciating both the power and the inherent limitations of simple, local radiation damping models [@problem_id:3533144].", "problem": "Consider a homogeneous, isotropic, linear elastic half-space characterized by mass density $\\rho$ and Lamé parameters $\\lambda$ and $\\mu$. Let a planar artificial boundary segment of area $A$ be introduced in a Finite Element (FE) model to truncate the computational domain while attempting to reproduce radiation damping by absorbing outgoing waves. The goal is to derive local, velocity-proportional boundary forces $F_{n}$ and $F_{t}$ in the normal and tangential directions, respectively, so that outgoing Primary (P) and Secondary (S) plane waves pass through the boundary without reflection. Starting from the linear momentum balance, Hooke’s law for an isotropic solid, and the plane wave form of elastodynamic solutions, use wave impedance arguments to obtain the expressions for the dashpot coefficients $c_{n}$ and $c_{t}$ defined by $F_{n}=c_{n} v_{n}$ and $F_{t}=c_{t} v_{t}$, where $v_{n}$ and $v_{t}$ are the normal and tangential particle velocities at the boundary. Express your final answer in terms of $\\rho$, the compressional wave speed $c_{p}$, the shear wave speed $c_{s}$, and the area $A$. You may assume $c_{p}=\\sqrt{(\\lambda+2\\mu)/\\rho}$ and $c_{s}=\\sqrt{\\mu/\\rho}$, and that the boundary is locally planar relative to the wavelengths of interest.\n\nThen, discuss in words the validity limits of these local dashpot coefficients with respect to frequency content and angle of incidence of the impinging waves, making explicit any assumptions required for their accuracy. When referring to angles, use radians. If you choose to present numerical values, express the dashpot coefficients in Newton-second per meter (N·s/m). The final answer must be the closed-form analytic expressions for $c_{n}$ and $c_{t}$.", "solution": "The problem as stated is valid. It is a well-posed problem in computational elastodynamics, grounded in the fundamental principles of wave propagation in elastic solids. It provides sufficient information to derive the expressions for the viscous dashpot coefficients under the standard assumptions of plane waves at normal incidence.\n\nThe objective is to find boundary forces, proportional to velocity, that absorb outgoing waves perfectly. This is equivalent to finding the relationship between traction and particle velocity for a plane wave traveling in an infinite medium. This relationship defines the impedance of the medium. An artificial boundary condition that enforces this relationship will not reflect energy back into the computational domain, thus simulating an infinite medium.\n\nLet the artificial boundary be a plane, for instance, $x_1=0$, with the finite element domain in the region $x_1 < 0$. The outgoing waves travel in the positive $x_1$-direction. The traction vector on this boundary plane is given by $\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\mathbf{n}=(1, 0, 0)$ is the outward normal vector. The components of the traction vector are $t_1 = \\sigma_{11}$ (normal traction) and $t_2 = \\sigma_{12}$, $t_3 = \\sigma_{13}$ (tangential tractions). We will analyze the cases of pure compressional (P) waves and pure shear (S) waves arriving at normal incidence to the boundary.\n\n**1. Compressional (P) Wave at Normal Incidence**\n\nConsider a plane P-wave propagating in the positive $x_1$-direction. The displacement field is given by $\\mathbf{u} = (u_1, 0, 0)$, where $u_1$ is a function of $(x_1, t)$. For a wave traveling in the $+x_1$ direction with speed $c_p$, the displacement can be written as:\n$$\nu_1(x_1, t) = f(t - \\frac{x_1}{c_p})\n$$\nThe particle velocity in the normal direction, $v_n = v_1$, is:\n$$\nv_n = \\frac{\\partial u_1}{\\partial t} = f'(t - \\frac{x_1}{c_p})\n$$\nThe only non-zero strain component is the normal strain $\\epsilon_{11}$:\n$$\n\\epsilon_{11} = \\frac{\\partial u_1}{\\partial x_1} = f'(t - \\frac{x_1}{c_p}) \\cdot \\left(-\\frac{1}{c_p}\\right)\n$$\nBy comparing the expressions for velocity and strain, we establish the key relationship:\n$$\n\\epsilon_{11} = -\\frac{1}{c_p} v_n\n$$\nFor a linear isotropic elastic material, the normal stress $\\sigma_{11}$ is given by Hooke's law. For a plane wave condition ($\\epsilon_{22} = \\epsilon_{33} = 0$), this is:\n$$\n\\sigma_{11} = (\\lambda + 2\\mu)\\epsilon_{11}\n$$\nThe compressional wave speed $c_p$ is defined as $c_p = \\sqrt{(\\lambda+2\\mu)/\\rho}$, which gives $(\\lambda+2\\mu) = \\rho c_p^2$. Substituting this and the strain-velocity relationship into the stress equation yields:\n$$\n\\sigma_{11} = (\\rho c_p^2) \\left(-\\frac{1}{c_p} v_n\\right) = -\\rho c_p v_n\n$$\nThis equation relates the stress required to sustain a P-wave to the particle velocity. The term $\\rho c_p$ is the mechanical impedance for P-waves.\nThe boundary condition at the artificial boundary must replicate this stress. The traction normal to the boundary is $t_n = \\sigma_{11}$. So, $t_n = -\\rho c_p v_n$.\nThe problem defines the boundary force as $F_n = c_n v_n$. This force, applied by the dashpot to the nodes of the finite element mesh, must counteract the traction from the internal medium. If the traction on the boundary face is $t_n$, the force exerted by the continuum on the area $A$ is $t_n A$. To absorb the wave, the dashpot must apply an equal and opposite force, $F_n = -t_n A$.\n$$\nF_n = -(-\\rho c_p v_n) A = (\\rho c_p A) v_n\n$$\nBy comparing this with the definition $F_n = c_n v_n$, we identify the normal dashpot coefficient:\n$$\nc_n = \\rho c_p A\n$$\n\n**2. Shear (S) Wave at Normal Incidence**\n\nConsider a plane S-wave propagating in the positive $x_1$-direction, polarized in the $x_2$-direction. The displacement field is $\\mathbf{u} = (0, u_2, 0)$, where $u_2$ is a function of $(x_1, t)$. For a wave traveling in the $+x_1$ direction with speed $c_s$:\n$$\nu_2(x_1, t) = g(t - \\frac{x_1}{c_s})\n$$\nThe particle velocity in the tangential direction, $v_t = v_2$, is:\n$$\nv_t = \\frac{\\partial u_2}{\\partial t} = g'(t - \\frac{x_1}{c_s})\n$$\nThe only non-zero strain component is the shear strain $\\epsilon_{12}$:\n$$\n\\epsilon_{12} = \\frac{1}{2} \\left(\\frac{\\partial u_1}{\\partial x_2} + \\frac{\\partial u_2}{\\partial x_1}\\right) = \\frac{1}{2} \\frac{\\partial u_2}{\\partial x_1} = \\frac{1}{2} g'(t - \\frac{x_1}{c_s}) \\cdot \\left(-\\frac{1}{c_s}\\right)\n$$\nThis gives the relationship for the spatial derivative of displacement:\n$$\n\\frac{\\partial u_2}{\\partial x_1} = -\\frac{1}{c_s} \\frac{\\partial u_2}{\\partial t} = -\\frac{1}{c_s} v_t\n$$\nAccording to Hooke's law, the shear stress $\\sigma_{12}$ is:\n$$\n\\sigma_{12} = 2\\mu \\epsilon_{12} = \\mu \\frac{\\partial u_2}{\\partial x_1}\n$$\nThe shear wave speed $c_s$ is defined as $c_s = \\sqrt{\\mu/\\rho}$, which gives $\\mu = \\rho c_s^2$. Substituting this and the displacement-velocity relationship into the stress equation yields:\n$$\n\\sigma_{12} = (\\rho c_s^2) \\left(-\\frac{1}{c_s} v_t\\right) = -\\rho c_s v_t\n$$\nThe term $\\rho c_s$ is the mechanical impedance for S-waves. The tangential traction on the boundary is $t_t = \\sigma_{12}$. So, $t_t = -\\rho c_s v_t$.\nThe tangential boundary force is defined as $F_t = c_t v_t$. Following the same logic as for the P-wave, this force must be $F_t = -t_t A$.\n$$\nF_t = -(-\\rho c_s v_t) A = (\\rho c_s A) v_t\n$$\nBy comparing this with the definition $F_t = c_t v_t$, we identify the tangential dashpot coefficient:\n$$\nc_t = \\rho c_s A\n$$\nAn identical result would be obtained for an S-wave polarized in the $x_3$-direction. Thus, the derived coefficient applies to any tangential motion.\n\n**Discussion on Validity Limits**\n\nThe derived viscous dashpot coefficients, often called Lysmer-Kuhlemeyer dashpots, provide a \"local\" absorbing boundary condition. They relate the stress at a point on the boundary to the velocity at that same point in time and space. While simple and computationally inexpensive, their effectiveness is limited by the assumptions made in the derivation.\n\nThe fundamental assumption is that all outgoing energy approaches the artificial boundary as **plane waves at normal incidence**. Any deviation from this condition leads to spurious reflections.\n\n1.  **Angle of Incidence**: The derived impedance terms $\\rho c_p$ and $\\rho c_s$ are correct only for waves whose propagation vector is normal to the boundary (angle of incidence $\\theta=0$ radians). For a plane wave arriving at an angle $\\theta > 0$, the relationship between tractions and velocities at the boundary becomes more complex. An obliquely incident P-wave, for instance, generates both reflected P- and S-waves (mode conversion), and the simple velocity-proportional boundary condition cannot correctly absorb both. The efficiency of these dashpots decreases as the angle of incidence increases. They are generally considered reasonably effective for angles up to approximately $\\pi/6$ radians ($30$ degrees) but perform poorly for larger angles, especially near grazing incidence ($\\theta \\to \\pi/2$ radians).\n2.  **Frequency Content**: The derived boundary condition is local in time (i.e., non-convolutional), which means the coefficients $c_n$ and $c_t$ are independent of frequency $\\omega$. This is an advantage in time-domain analysis as it makes implementation straightforward. In theory, they absorb normally incident plane waves perfectly across all frequencies. However, the problem of wave front curvature is frequency-dependent.\n3.  **Wavefront Curvature (Source Proximity)**: The plane wave assumption is only valid for sources located far from the artificial boundary. Sources within the finite element domain generate curved wavefronts (e.g., cylindrical or spherical). A curved wavefront can be viewed as a superposition of plane waves traveling in a spectrum of directions. Therefore, except for the single ray path normal to the boundary, all other energy will strike the boundary at an oblique angle, violating the core assumption. This effect is more pronounced for low frequencies (long wavelengths) relative to the source-boundary distance. As a rule-of-thumb, the boundary should be placed many wavelengths away from significant sources of radiation for the plane-wave approximation to be acceptable.\n4.  **Surface Waves**: These dashpots are particularly ineffective at absorbing surface waves (e.g., Rayleigh waves). A Rayleigh wave propagates along the free surface, parallel to the boundary, and involves coupled horizontal and vertical motion that decays with depth. The viscous boundary cannot absorb it because it is designed for body waves propagating into the boundary, not waves travelling along it.\n\nIn summary, the accuracy of these local dashpot coefficients is contingent upon the outgoing wavefield being dominated by body waves (P and S) at near-normal incidence. Their performance degrades significantly with increasing angle of incidence and for non-planar wavefronts originating from nearby sources.\n\nThe units of the dashpot coefficients $c_n$ and $c_t$ are force divided by velocity, which in the SI system is Newtons divided by meters per second, or $\\text{N}\\cdot\\text{s}/\\text{m}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} c_n = \\rho c_p A & c_t = \\rho c_s A \\end{pmatrix}\n}\n$$", "id": "3533144"}, {"introduction": "After establishing a basic model, we need a method to measure its effectiveness. This practice introduces the concept of a \"patch test\" to quantify spurious reflections from an artificial boundary by deriving the reflection coefficient $R$ from impedance mismatch. By applying this test to various boundary conditions, you will develop a quantitative understanding of what makes a radiation boundary successful or unsuccessful [@problem_id:3533158].", "problem": "Implement a frequency-domain patch test for a one-dimensional infinite element intended to model radiation damping at the truncation of a homogeneous elastic bar. Start from first principles: linear momentum balance, linear elasticity, and harmonic wave propagation. Model the bar as a one-dimensional continuum with cross-sectional area $A$, Young’s modulus $E$, and mass density $\\rho$. Assume time-harmonic motion with angular frequency $\\omega$ and the complex exponential convention $\\exp(-i \\omega t)$. Derive, from these fundamentals, a formula for the reflection coefficient at a truncation boundary where an infinite element is represented by a linear force–displacement relation that enforces outgoing-wave behavior. The reflection coefficient must be defined by superposing an incident and a reflected plane wave in the interior medium, enforcing continuity of displacement and force equilibrium at the boundary, and expressing the resulting ratio of reflected to incident wave amplitude purely in terms of material and boundary parameters. Define the quantitative measure of spurious reflection as the magnitude of this complex reflection coefficient. The test is passed for exact transmission if and only if this magnitude is identically zero under parameter matching.\n\nUse only the following fundamental bases and well-tested facts as starting points in your derivation:\n- The one-dimensional balance of linear momentum: $\\rho \\, \\ddot{u}(x,t) = \\partial_x \\sigma(x,t)$.\n- Linear elasticity (Hooke’s law): $\\sigma(x,t) = E \\, \\partial_x u(x,t)$.\n- Time-harmonic motion: if $u(x,t) = \\Re\\{\\hat{u}(x) \\exp(-i \\omega t)\\}$, then $\\dot{u}(x,t) = \\Re\\{-i \\omega \\hat{u}(x) \\exp(-i \\omega t)\\}$ and $\\ddot{u}(x,t) = \\Re\\{-\\omega^2 \\hat{u}(x) \\exp(-i \\omega t)\\}$.\n- Plane wave solutions in a homogeneous medium: $\\hat{u}(x) = U_I \\exp(-i k x) + U_R \\exp(i k x)$ with wave number $k = \\omega / c$ and wave speed $c = \\sqrt{E/\\rho}$.\n\nModel the infinite element attached at the truncation boundary at $x=0$ as an exact radiation law of the form $F = -i \\omega Z_{ie} \\, \\hat{u}(0)$ in the frequency domain, where $F$ is the boundary force, $\\hat{u}(0)$ is the boundary displacement amplitude, and $Z_{ie}$ is a real, nonnegative mechanical impedance specified by the infinite element’s target medium parameters $E_{ie}$ and $\\rho_{ie}$ through the same form as the interior medium. When the infinite element matches the host medium, the patch test must yield zero spurious reflection. When it is mismatched, the magnitude of the reflection coefficient quantifies spurious reflection produced by the discretized boundary. Do not assume any specific shortcut formula for the reflection coefficient; instead, derive it from the stated foundations by enforcing the boundary relation and the form of the plane wave solution.\n\nYour program must:\n- Implement the derived formula for the magnitude of the reflection coefficient at $x=0$ as a function of $E$, $\\rho$, $A$, $E_{ie}$, $\\rho_{ie}$, and the boundary type.\n- Treat three boundary types:\n  - An “impedance infinite element” with finite $Z_{ie}$ defined by $E_{ie}$ and $\\rho_{ie}$.\n  - A “fixed boundary” corresponding to $|\\hat{u}(0)| = 0$, which is the limit $Z_{ie} \\to \\infty$.\n  - A “free boundary” corresponding to zero boundary force, which is the limit $Z_{ie} \\to 0$.\n- Output, for each test case, the magnitude of the reflection coefficient. This measure is dimensionless and must be reported as real-valued floats.\n\nUse the following test suite (all parameters are to be interpreted in the International System of Units, but the required outputs are dimensionless):\n- Common interior medium parameters for all cases: $E = 1.0 \\times 10^8$, $\\rho = 1.8 \\times 10^3$, $A = 1.0$. You may assume a single representative angular frequency $\\omega = 2 \\pi f$ with $f = 5$ for context; the final result must be independent of $\\omega$ for the models considered.\n- Test cases:\n  - Case $1$ (happy path, exact transmission): boundary type “impedance,” $E_{ie} = E$, $\\rho_{ie} = \\rho$.\n  - Case $2$ (moderate stiffness mismatch only): boundary type “impedance,” $E_{ie} = 1.44 \\, E$, $\\rho_{ie} = \\rho$.\n  - Case $3$ (perfectly fixed boundary): boundary type “fixed.”\n  - Case $4$ (perfectly free boundary): boundary type “free.”\n  - Case $5$ (moderate density mismatch only): boundary type “impedance,” $E_{ie} = E$, $\\rho_{ie} = 0.81 \\, \\rho$.\n  - Case $6$ (combined mismatch): boundary type “impedance,” $E_{ie} = 0.64 \\, E$, $\\rho_{ie} = 1.21 \\, \\rho$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5,r_6]$, where each $r_j$ is the computed magnitude of the reflection coefficient for case $j$.", "solution": "The user has provided a valid problem statement. The problem is scientifically grounded in the principles of continuum mechanics and wave propagation, is well-posed, and is expressed in objective, formal language. We proceed with the derivation and solution.\n\nThe objective is to derive the reflection coefficient for a one-dimensional elastic bar terminated by an infinite element. The derivation must start from first principles.\n\nThe first principle is the balance of linear momentum in one dimension, given as:\n$$ \\rho \\, \\ddot{u}(x,t) = \\frac{\\partial \\sigma(x,t)}{\\partial x} $$\nHere, $\\rho$ is the mass density, $u(x,t)$ is the axial displacement, and $\\sigma(x,t)$ is the axial stress. A dot denotes differentiation with respect to time $t$, and $\\partial_x$ denotes differentiation with respect to the spatial coordinate $x$.\n\nThe second principle is the constitutive relation for linear elasticity (Hooke's law):\n$$ \\sigma(x,t) = E \\, \\frac{\\partial u(x,t)}{\\partial x} $$\nwhere $E$ is Young's modulus.\n\nCombining these two equations for a homogeneous medium where $E$ and $\\rho$ are constant yields the one-dimensional wave equation:\n$$ \\rho \\, \\frac{\\partial^2 u}{\\partial t^2} = E \\, \\frac{\\partial^2 u}{\\partial x^2} \\implies \\frac{\\partial^2 u}{\\partial x^2} - \\frac{1}{c^2} \\frac{\\partial^2 u}{\\partial t^2} = 0 $$\nwhere $c = \\sqrt{E/\\rho}$ is the elastic wave speed.\n\nWe assume time-harmonic motion, where physical quantities vary sinusoidally in time with an angular frequency $\\omega$. Using the complex exponential convention, the displacement is written as $u(x,t) = \\Re\\{\\hat{u}(x) \\exp(-i \\omega t)\\}$, where $\\hat{u}(x)$ is the complex displacement amplitude. The time derivatives are $\\ddot{u}(x,t) = \\Re\\{-\\omega^2 \\hat{u}(x) \\exp(-i \\omega t)\\}$. Substituting this into the wave equation gives the time-independent Helmholtz equation for $\\hat{u}(x)$:\n$$ \\frac{d^2 \\hat{u}}{dx^2} + \\frac{\\omega^2}{c^2} \\hat{u}(x) = 0 \\implies \\frac{d^2 \\hat{u}}{dx^2} + k^2 \\hat{u}(x) = 0 $$\nwhere $k = \\omega/c = \\omega \\sqrt{\\rho/E}$ is the wave number.\n\nThe problem specifies a general solution in the form of plane waves. For a bar occupying $x \\ge 0$ with a boundary at $x=0$:\n$$ \\hat{u}(x) = U_I \\exp(-ikx) + U_R \\exp(ikx) $$\nWith the time factor $\\exp(-i\\omega t)$, the term $U_I \\exp(-i(kx+\\omega t))$ represents a wave traveling in the negative $x$ direction (incident), and the term $U_R \\exp(i(kx-\\omega t))$ represents a wave traveling in the positive $x$ direction (reflected away from the boundary).\n\nWe must enforce continuity and force equilibrium at the boundary $x=0$. The displacement amplitude at the boundary is:\n$$ \\hat{u}(0) = U_I e^0 + U_R e^0 = U_I + U_R $$\n\nThe stress amplitude is derived from the displacement:\n$$ \\hat{\\sigma}(x) = E \\, \\frac{d\\hat{u}}{dx} = E (-ik U_I \\exp(-ikx) + ik U_R \\exp(ikx)) $$\nAt the boundary $x=0$, the stress amplitude is:\n$$ \\hat{\\sigma}(0) = ikE(-U_I + U_R) $$\n\nThe force exerted by the bar on an external element at $x=0$ is given by the stress and area, $A$. For a domain $x \\ge 0$, the outward normal at $x=0$ points in the $-x$ direction. The traction force is $T = -A\\sigma(0)$. The force $F$ in the boundary condition is the external force applied by the infinite element *on the bar*. By Newton's third law, this force balances the internal force from the bar, so $F = A\\hat{\\sigma}(0)$.\n\nThe infinite element is modeled by the radiation boundary condition relating force to displacement:\n$$ F = -i \\omega Z_{ie} \\hat{u}(0) $$\nwhere $Z_{ie}$ is the mechanical impedance of the infinite element. This corresponds to the physical relation $F = Z_{ie} \\dot{u}(0)$, since $\\dot{u}(0) = -i\\omega \\hat{u}(0)$.\n\nEquating the two expressions for the boundary force $F$:\n$$ A \\hat{\\sigma}(0) = -i \\omega Z_{ie} \\hat{u}(0) $$\nSubstituting the expressions for $\\hat{\\sigma}(0)$ and $\\hat{u}(0)$:\n$$ A [ikE(-U_I + U_R)] = -i \\omega Z_{ie} (U_I + U_R) $$\nThe imaginary unit $i$ cancels from both sides:\n$$ AkE(-U_I + U_R) = -\\omega Z_{ie} (U_I + U_R) $$\nSince $k = \\omega/c = \\omega\\sqrt{\\rho/E}$, we substitute for $k$:\n$$ A \\left(\\omega\\sqrt{\\frac{\\rho}{E}}\\right) E(-U_I + U_R) = -\\omega Z_{ie} (U_I + U_R) $$\nThe angular frequency $\\omega$ cancels, confirming the frequency-independence of the reflection for this model:\n$$ A \\sqrt{\\rho E} (-U_I + U_R) = -Z_{ie} (U_I + U_R) $$\nWe identify the term $Z_{int} = A\\sqrt{E\\rho}$ as the characteristic mechanical impedance of the interior medium (the bar). The equation becomes:\n$$ Z_{int} (-U_I + U_R) = -Z_{ie} (U_I + U_R) $$\nWe seek the reflection coefficient, defined as $R = U_R/U_I$. Dividing by $U_I$:\n$$ Z_{int} (-1 + R) = -Z_{ie} (1 + R) $$\n$$ -Z_{int} + Z_{int}R = -Z_{ie} - Z_{ie}R $$\n$$ R(Z_{int} + Z_{ie}) = Z_{int} - Z_{ie} $$\nThis yields the formula for the reflection coefficient:\n$$ R = \\frac{Z_{int} - Z_{ie}}{Z_{int} + Z_{ie}} $$\nThe problem states that the impedance of the infinite element, $Z_{ie}$, is defined by its material parameters $E_{ie}$ and $\\rho_{ie}$ in the same manner as the interior medium. Thus:\n$$ Z_{ie} = A\\sqrt{E_{ie}\\rho_{ie}} $$\nSubstituting this into the expression for $R$:\n$$ R = \\frac{A\\sqrt{E\\rho} - A\\sqrt{E_{ie}\\rho_{ie}}}{A\\sqrt{E\\rho} + A\\sqrt{E_{ie}\\rho_{ie}}} = \\frac{\\sqrt{E\\rho} - \\sqrt{E_{ie}\\rho_{ie}}}{\\sqrt{E\\rho} + \\sqrt{E_{ie}\\rho_{ie}}} $$\nThe cross-sectional area $A$ cancels. Let $z = \\sqrt{E\\rho}$ be the specific impedance. Then $R = (z_{int} - z_{ie})/(z_{int} + z_{ie})$. The measure of spurious reflection is the magnitude $|R|$. Since all material parameters are real and non-negative, $z_{int}$ and $z_{ie}$ are real, and thus $R$ is real. The magnitude is $|R| = |(z_{int} - z_{ie})/(z_{int} + z_{ie})|$.\n\nNow we analyze the specific boundary types:\n1.  **Impedance-matched infinite element**: For this case, $E_{ie} = E$ and $\\rho_{ie} = \\rho$. This implies $z_{ie} = \\sqrt{E_{ie}\\rho_{ie}} = \\sqrt{E\\rho} = z_{int}$. The reflection coefficient is $R = (z_{int} - z_{int})/(z_{int} + z_{int}) = 0$. The magnitude is $|R|=0$, indicating perfect transmission, which passes the patch test.\n\n2.  **Fixed boundary**: This condition is $\\hat{u}(0)=0$. From $\\hat{u}(0) = U_I + U_R$, we get $U_I + U_R = 0$, so $U_R = -U_I$ and $R=-1$. The magnitude is $|R|=1$. In the impedance formulation, a fixed boundary has infinite impedance, $Z_{ie} \\to \\infty$. In this limit, $R = \\lim_{Z_{ie} \\to \\infty} \\frac{Z_{int} - Z_{ie}}{Z_{int} + Z_{ie}} = \\lim_{Z_{ie} \\to \\infty} \\frac{Z_{int}/Z_{ie} - 1}{Z_{int}/Z_{ie} + 1} = -1$. The magnitude is $|-1|=1$.\n\n3.  **Free boundary**: This condition is zero force, $F=0$. This implies $\\hat{\\sigma}(0) = 0$. From $\\hat{\\sigma}(0)=ikE(-U_I + U_R)$, we get $-U_I + U_R = 0$, so $U_R = U_I$ and $R=1$. The magnitude is $|R|=1$. In the impedance formulation, a free boundary has zero impedance, $Z_{ie} = 0$. In this case, $R = \\frac{Z_{int} - 0}{Z_{int} + 0} = 1$. The magnitude is $|1|=1$.\n\nThe formulas are now ready to be implemented for the specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a frequency-domain patch test for a 1D infinite element.\n    It calculates the magnitude of the reflection coefficient at a boundary\n    based on the material properties of the interior medium and the boundary condition.\n    \"\"\"\n\n    # Common interior medium parameters (SI units)\n    E_int = 1.0e8  # Young's modulus\n    rho_int = 1.8e3  # Mass density\n    # Note: Cross-sectional area A and frequency omega are not needed as they\n    # cancel out in the final reflection coefficient formula for this model.\n\n    test_cases = [\n        # Case 1: happy path, exact transmission\n        {'type': 'impedance', 'E_ie': E_int, 'rho_ie': rho_int},\n        # Case 2: moderate stiffness mismatch only\n        {'type': 'impedance', 'E_ie': 1.44 * E_int, 'rho_ie': rho_int},\n        # Case 3: perfectly fixed boundary\n        {'type': 'fixed'},\n        # Case 4: perfectly free boundary\n        {'type': 'free'},\n        # Case 5: moderate density mismatch only\n        {'type': 'impedance', 'E_ie': E_int, 'rho_ie': 0.81 * rho_int},\n        # Case 6: combined mismatch\n        {'type': 'impedance', 'E_ie': 0.64 * E_int, 'rho_ie': 1.21 * rho_int},\n    ]\n\n    results = []\n    \n    # Calculate the specific impedance of the interior medium\n    z_int = np.sqrt(E_int * rho_int)\n\n    for case in test_cases:\n        boundary_type = case['type']\n        \n        if boundary_type == 'impedance':\n            # For an impedance boundary, calculate the specific impedance of the\n            # infinite element's target medium.\n            E_ie = case['E_ie']\n            rho_ie = case['rho_ie']\n            z_ie = np.sqrt(E_ie * rho_ie)\n            \n            # The reflection coefficient R is (z_int - z_ie) / (z_int + z_ie).\n            # The magnitude is the absolute value of R, since impedances are real.\n            if z_int + z_ie == 0:\n                # Avoid division by zero, although physically z_int and z_ie are non-negative.\n                reflection_magnitude = 1.0 if z_int != z_ie else 0.0\n            else:\n                reflection_magnitude = np.abs((z_int - z_ie) / (z_int + z_ie))\n        \n        elif boundary_type == 'fixed':\n            # A fixed boundary corresponds to total reflection with a phase shift.\n            # The magnitude of the reflection coefficient is 1.\n            reflection_magnitude = 1.0\n            \n        elif boundary_type == 'free':\n            # A free boundary corresponds to total reflection with no phase shift.\n            # The magnitude of the reflection coefficient is 1.\n            reflection_magnitude = 1.0\n        \n        else:\n            # Should not happen with the defined test cases.\n            raise ValueError(f\"Unknown boundary type: {boundary_type}\")\n            \n        results.append(reflection_magnitude)\n\n    # Format the output as a comma-separated list of floats in brackets.\n    # The map(str, ...) is used to handle potential nuances in float formatting.\n    formatted_results = [f'{r:.17f}'.rstrip('0').rstrip('.') if '.' in f'{r:.17f}' else str(r) for r in results]\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3533158"}, {"introduction": "True infinite elements go beyond simple impedance matching at a boundary by modeling the semi-infinite domain itself. A critical component is the geometric mapping from the physical domain $r \\in [r_b, \\infty)$ to a reference coordinate $\\xi$. This final exercise explores how to design this mapping to correctly represent the $1/r$ decay of spherical wave amplitudes, a key step in preventing numerical issues like volumetric locking in advanced simulations [@problem_id:3533178].", "problem": "Consider a three-dimensional spherically symmetric time-harmonic elastodynamic problem in an unbounded soil domain, modeled as a linear elastic continuum with Lamé parameters $\\lambda$ and $\\mu$, Poisson ratio $\\nu$, and mass density $\\rho$. Let the displacement field be radial, $\\mathbf{u}(r,t) = u_{r}(r)\\,\\hat{\\mathbf{e}}_{r}\\,\\exp(i \\omega t)$, where $r$ is the radial coordinate, $\\hat{\\mathbf{e}}_{r}$ is the radial unit vector, $\\omega$ is the angular frequency, and $i$ is the imaginary unit. Assume that for outgoing dilatational (pressure) waves, the large-$r$ asymptotic amplitude is proportional to $1/r$, i.e., $u_{r}(r) \\sim \\frac{A}{r} \\exp(i k_{p} r)$, where $k_{p} = \\omega / c_{p}$ and $c_{p} = \\sqrt{(\\lambda + 2\\mu)/\\rho}$ is the pressure wave speed. The unbounded domain is truncated at a finite radius $r_{b} > 0$ and discretized beyond $r_{b}$ using an infinite element that maps a semi-infinite region $r \\in [r_{b}, \\infty)$ onto a finite reference coordinate $\\xi \\in [-1,1)$ via a monotonic radial mapping $r(\\xi)$, with $r(-1) = r_{b}$ and $\\lim_{\\xi \\to 1^{-}} r(\\xi) = +\\infty$. The infinite element uses standard polynomial displacement interpolation in $\\xi$.\n\nIn a displacement-only formulation, volumetric locking in the nearly incompressible limit $\\nu \\to 0.5$ (bulk modulus $K = \\lambda + \\tfrac{2}{3}\\mu \\to \\infty$) manifests as an artificial over-stiffness arising from the volumetric strain term in the weak form. In spherical symmetry, the volumetric strain is $\\varepsilon_{v} = \\nabla \\cdot \\mathbf{u} = \\frac{1}{r^{2}} \\frac{d}{dr}(r^{2} u_{r})$, and under the mapping, the chain rule gives $\\frac{d}{dr} = \\frac{1}{r'(\\xi)} \\frac{d}{d\\xi}$, where $r'(\\xi) = \\frac{dr}{d\\xi}$. Thus, $\\varepsilon_{v}(\\xi) = \\frac{2\\,u_{r}}{r(\\xi)} + \\frac{1}{r'(\\xi)} \\frac{d u_{r}}{d\\xi}$. The volumetric contribution to the weak form integrates over the infinite element with the spherical volume factor, producing the weight $r^{2}(\\xi)\\,r'(\\xi)$ in the $\\xi$-integral.\n\nStarting from the spherical divergence identity and the outgoing-wave amplitude behavior, derive a condition on the radial mapping $r(\\xi)$ that ensures polynomial displacement interpolation in $\\xi$ can represent the asymptotic $1/r$ amplitude exactly in the mapped coordinate, thereby preventing spurious constraints on $\\varepsilon_{v}$ as $\\nu \\to 0.5$ and mitigating numerical locking for dynamic radiation problems. Then, enforce the boundary condition $r(-1) = r_{b}$ to obtain the simplest explicit mapping $r(\\xi)$ satisfying this condition across the entire infinite element. Express your final answer as a single analytic expression for $r(\\xi)$ in terms of $r_{b}$ and $\\xi$. No numerical evaluation is required.", "solution": "The problem is first assessed for validity. All provided data, definitions, and conditions are extracted verbatim.\n\nGivens:\n- A three-dimensional spherically symmetric time-harmonic elastodynamic problem.\n- Material properties: Lamé parameters $\\lambda$ and $\\mu$, Poisson's ratio $\\nu$, mass density $\\rho$.\n- Displacement field: $\\mathbf{u}(r,t) = u_{r}(r)\\,\\hat{\\mathbf{e}}_{r}\\,\\exp(i \\omega t)$.\n- Asymptotic displacement amplitude: $u_{r}(r) \\sim \\frac{A}{r} \\exp(i k_{p} r)$ for large $r$.\n- Pressure wave number and speed: $k_{p} = \\omega / c_{p}$, $c_{p} = \\sqrt{(\\lambda + 2\\mu)/\\rho}$.\n- Infinite element mapping: A monotonic function $r(\\xi)$ maps the semi-infinite domain $r \\in [r_{b}, \\infty)$ to the finite reference domain $\\xi \\in [-1,1)$.\n- Mapping boundary conditions: $r(-1) = r_{b}$ and $\\lim_{\\xi \\to 1^{-}} r(\\xi) = +\\infty$.\n- Interpolation scheme: Standard polynomial displacement interpolation in the coordinate $\\xi$.\n- Volumetric strain in spherical coordinates: $\\varepsilon_{v} = \\frac{1}{r^{2}} \\frac{d}{dr}(r^{2} u_{r})$.\n\nValidation:\nThe problem is scientifically grounded in the established theory of elastodynamics and computational mechanics, specifically concerning the use of infinite elements for modeling wave radiation in unbounded domains. It addresses the well-known issue of volumetric locking in nearly incompressible materials. The physical and mathematical relationships provided are standard and correct. The problem is well-posed, objective, and contains sufficient information to derive the requested mapping function. It does not violate any of the invalidity criteria. Therefore, the problem is deemed valid and a solution will be furnished.\n\nSolution Derivation:\nThe central issue is the mitigation of volumetric locking in the nearly incompressible limit, where the Poisson ratio $\\nu \\to 0.5$ and the bulk modulus $K = \\lambda + \\frac{2}{3}\\mu \\to \\infty$. In the weak form of the equilibrium equations, the volumetric energy term is proportional to $K \\int \\varepsilon_{v}^{2} dV$. For the energy to remain bounded as $K \\to \\infty$, the volumetric strain $\\varepsilon_{v}$ must be representable as approaching zero by the element's interpolation functions. An inability to do so results in a spurious stiffening of the model, known as locking.\n\nThe problem specifies that for outgoing waves, the displacement amplitude has an asymptotic behavior proportional to $1/r$. The problem statement explicitly directs us to find a condition on the mapping $r(\\xi)$ that allows a \"standard polynomial displacement interpolation in $\\xi$\" to \"represent the asymptotic $1/r$ amplitude exactly\". This implies that the function defining the spatial decay of the amplitude, $f(r) = 1/r$, must transform into a polynomial function of $\\xi$ under the coordinate mapping $r = r(\\xi)$.\n\nLet the displacement field in the infinite element be interpolated using polynomials in the mapped coordinate $\\xi$. This means that the displacement as a function of $\\xi$ is expressed as $u_r(\\xi) = P(\\xi)$, where $P(\\xi)$ is a polynomial. To exactly represent the asymptotic amplitude decay, we require that the functional form $u_r(r) \\propto 1/r$ can be written as a polynomial in $\\xi$. This imposes a direct constraint on the mapping function $r(\\xi)$. That is, the function $1/r(\\xi)$ must be a polynomial in $\\xi$.\n\nTo derive the simplest possible mapping, we choose the simplest non-constant polynomial form for $1/r(\\xi)$, which is a linear function:\n$$ \\frac{1}{r(\\xi)} = a\\xi + b $$\nwhere $a$ and $b$ are constants to be determined. The mapping function is therefore:\n$$ r(\\xi) = \\frac{1}{a\\xi + b} $$\nThis establishes the general form of the mapping that satisfies the problem's primary condition.\n\nNext, we apply the boundary conditions provided for the mapping. The first condition is that the radius approaches infinity as the mapped coordinate approaches the endpoint of its interval:\n$$ \\lim_{\\xi \\to 1^{-}} r(\\xi) = +\\infty $$\nFor $r(\\xi)$ to diverge to $+\\infty$, its denominator must approach zero. Therefore, we must have:\n$$ a(1) + b = 0 \\implies b = -a $$\nSubstituting this result back into the mapping function gives:\n$$ r(\\xi) = \\frac{1}{a\\xi - a} = \\frac{1}{a(\\xi - 1)} $$\nThe problem describes a physical domain where the radius $r$ must be positive. Since $\\xi \\in [-1, 1)$, the term $(\\xi - 1)$ is always negative. For $r(\\xi)$ to be positive, the constant $a$ must also be negative.\n\nThe second boundary condition connects the start of the infinite element to the finite truncation radius $r_b$:\n$$ r(-1) = r_{b} $$\nApplying this condition to our current form of the mapping function:\n$$ r_{b} = r(-1) = \\frac{1}{a(-1 - 1)} = \\frac{1}{-2a} $$\nWe can now solve for the constant $a$:\n$$ a = -\\frac{1}{2r_{b}} $$\nThis value of $a$ is indeed negative, as required for a positive radius.\n\nFinally, we substitute the determined value of $a$ back into the expression for $r(\\xi)$ to obtain the final, explicit form of the mapping function:\n$$ r(\\xi) = \\frac{1}{-\\frac{1}{2r_{b}}(\\xi - 1)} = \\frac{-2r_{b}}{\\xi - 1} $$\nThis can be written in a more conventional form by multiplying the numerator and denominator by $-1$:\n$$ r(\\xi) = \\frac{2r_{b}}{1 - \\xi} $$\nThis function represents the simplest radial mapping that satisfies all the stated requirements. It correctly maps $\\xi = -1$ to $r = r_b$, causes $r \\to +\\infty$ as $\\xi \\to 1^{-}$, and ensures that the asymptotic displacement amplitude decay of $1/r$ is transformed into a linear function of $\\xi$, specifically $1/r(\\xi) = (1-\\xi)/(2r_b)$, which can be represented exactly by standard linear or higher-order polynomial shape functions within the infinite element, thereby mitigating spurious volumetric locking.", "answer": "$$\\boxed{\\frac{2r_{b}}{1-\\xi}}$$", "id": "3533178"}]}