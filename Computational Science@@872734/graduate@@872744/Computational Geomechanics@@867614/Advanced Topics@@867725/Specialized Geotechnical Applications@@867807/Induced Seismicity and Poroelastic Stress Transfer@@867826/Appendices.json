{"hands_on_practices": [{"introduction": "This first exercise provides a practical application of the effective stress principle to assess seismic risk. You will calculate the change in Coulomb Failure Stress ($\\Delta \\text{CFS}$) at a specific location by superimposing the effects of multiple injection wells, isolating the direct role of pore pressure in bringing a fault closer to failure. This hands-on calculation is fundamental for a first-order hazard screening in areas of fluid injection.", "problem": "A homogeneous, isotropic, linear poroelastic crust is subjected to fluid injection from three spatially separated wells. At a target hypocenter located on a planar fault, the pore pressure perturbation due to each well is known as a function of time and is denoted by $\\Delta p_i(t)$ for $i \\in \\{1,2,3\\}$. Assume small perturbations and that the superposition principle applies. The change in Coulomb Failure Stress (CFS), defined as $\\Delta \\mathrm{CFS}(t) = \\Delta \\tau(t) - \\mu' \\Delta \\sigma_n'(t)$ with compression taken as positive for $\\Delta \\sigma_n'(t)$, is to be computed on the fault plane at the hypocenter. Here, $\\Delta \\tau(t)$ is the resolved shear stress change in the slip direction, $\\mu'$ is the effective friction coefficient, and $\\Delta \\sigma_n'(t)$ is the change in effective normal stress on the fault.\n\nUse the effective stress principle from linear poroelasticity, $\\sigma'_{ij} = \\sigma_{ij} - \\alpha p \\delta_{ij}$, where $\\alpha$ is the Biot coefficient and $\\delta_{ij}$ is the Kronecker delta. Under the assumptions of isotropic pore-pressure perturbations and negligible poroelastic shear stress production at the hypocenter, take $\\Delta \\tau(t) \\approx 0$ and the total stress perturbation to be negligible, so that changes in effective normal stress on the fault are controlled by the pore pressure perturbation via $\\Delta \\sigma_n'(t) = - \\alpha \\Delta p(t)$, with $\\Delta p(t) = \\sum_{i=1}^{3} \\Delta p_i(t)$.\n\nThe three wells produce the following pore-pressure histories at the hypocenter (time $t$ in days, pressures in megapascals, and the exponential arguments are dimensionless):\n- $\\Delta p_1(t) = 0.4 \\,\\text{MPa} \\left(1 - \\exp\\!\\left(-\\frac{t}{100 \\,\\text{d}}\\right)\\right)$,\n- $\\Delta p_2(t) = 0.25 \\,\\text{MPa} \\,\\exp\\!\\left(-\\frac{t}{200 \\,\\text{d}}\\right)$,\n- $\\Delta p_3(t) = 0.6 \\,\\text{MPa} \\,\\exp\\!\\left(-\\frac{\\left(t - 300 \\,\\text{d}\\right)^{2}}{2 \\left(50 \\,\\text{d}\\right)^{2}}\\right)$.\n\nGiven $\\alpha = 0.8$, $\\mu' = 0.6$, and a triggering threshold $\\Delta \\mathrm{CFS}_c = 0.05 \\,\\text{MPa}$, compute the cumulative $\\Delta \\mathrm{CFS}(t^*)$ at $t^* = 365 \\,\\text{d}$ and assess whether it exceeds $\\Delta \\mathrm{CFS}_c$ by reporting the ratio $R = \\Delta \\mathrm{CFS}(t^*) / \\Delta \\mathrm{CFS}_c$. Round your final ratio $R$ to four significant figures. Express intermediate values of $\\Delta \\mathrm{CFS}$ in megapascals (MPa), but the final ratio $R$ must be dimensionless.", "solution": "The derivation begins from linear poroelasticity and the effective stress principle. The effective stress tensor is given by $\\sigma'_{ij} = \\sigma_{ij} - \\alpha p \\delta_{ij}$, where $\\alpha$ is the Biot coefficient and $p$ is pore pressure. For small perturbations, the changes satisfy $\\Delta \\sigma'_{ij} = \\Delta \\sigma_{ij} - \\alpha \\Delta p \\delta_{ij}$. With the assumption that the total stress perturbation at the hypocenter is negligible, $\\Delta \\sigma_{ij} \\approx 0$, the effective stress change reduces to $\\Delta \\sigma'_{ij} \\approx - \\alpha \\Delta p \\delta_{ij}$. Projected onto the fault normal with unit normal vector $n_i$, the change in effective normal stress on the fault is\n$$\n\\Delta \\sigma_n'(t) = n_i \\Delta \\sigma'_{ij} n_j = - \\alpha \\Delta p(t),\n$$\nwhere $\\Delta p(t)$ is the cumulative pore pressure change at the hypocenter.\n\nThe Coulomb Failure Stress (CFS) change is defined by\n$$\n\\Delta \\mathrm{CFS}(t) = \\Delta \\tau(t) - \\mu' \\Delta \\sigma_n'(t),\n$$\nwith compression taken as positive for $\\Delta \\sigma_n'(t)$. Under the stated assumptions of negligible poroelastic shear stress production at the hypocenter, $\\Delta \\tau(t) \\approx 0$, hence\n$$\n\\Delta \\mathrm{CFS}(t) \\approx - \\mu' \\Delta \\sigma_n'(t) = - \\mu' \\left(- \\alpha \\Delta p(t)\\right) = \\mu' \\alpha \\,\\Delta p(t).\n$$\nBecause the system is linear and the superposition principle applies, the cumulative pore-pressure change is the sum of contributions from each well:\n$$\n\\Delta p(t) = \\sum_{i=1}^{3} \\Delta p_i(t).\n$$\nTherefore,\n$$\n\\Delta \\mathrm{CFS}(t) = \\mu' \\alpha \\sum_{i=1}^{3} \\Delta p_i(t).\n$$\n\nWe now evaluate at $t^* = 365 \\,\\text{d}$. Compute each $\\Delta p_i(t^*)$:\n\n1. For the first well,\n$$\n\\Delta p_1(365) = 0.4 \\left(1 - \\exp\\!\\left(-\\frac{365}{100}\\right)\\right) = 0.4 \\left(1 - \\exp(-3.65)\\right).\n$$\nCompute $\\exp(-3.65) \\approx 0.0259911$, hence\n$$\n\\Delta p_1(365) \\approx 0.4 \\times (1 - 0.0259911) = 0.4 \\times 0.9740089 = 0.3896036 \\,\\text{MPa}.\n$$\n\n2. For the second well,\n$$\n\\Delta p_2(365) = 0.25 \\,\\exp\\!\\left(-\\frac{365}{200}\\right) = 0.25 \\,\\exp(-1.825).\n$$\nCompute $\\exp(-1.825) \\approx 0.161218$, hence\n$$\n\\Delta p_2(365) \\approx 0.25 \\times 0.161218 = 0.0403045 \\,\\text{MPa}.\n$$\n\n3. For the third well,\n$$\n\\Delta p_3(365) = 0.6 \\,\\exp\\!\\left(-\\frac{(365 - 300)^{2}}{2 \\times 50^{2}}\\right) = 0.6 \\,\\exp\\!\\left(-\\frac{65^{2}}{2 \\times 50^{2}}\\right) = 0.6 \\,\\exp\\!\\left(-\\frac{4225}{5000}\\right) = 0.6 \\,\\exp(-0.845).\n$$\nCompute $\\exp(-0.845) \\approx 0.429564$, hence\n$$\n\\Delta p_3(365) \\approx 0.6 \\times 0.429564 = 0.2577384 \\,\\text{MPa}.\n$$\n\nSum the pore-pressure changes:\n$$\n\\Delta p(365) = \\Delta p_1(365) + \\Delta p_2(365) + \\Delta p_3(365) \\approx 0.3896036 + 0.0403045 + 0.2577384 = 0.6876465 \\,\\text{MPa}.\n$$\n\nCompute the cumulative Coulomb Failure Stress change using $\\mu' = 0.6$ and $\\alpha = 0.8$:\n$$\n\\Delta \\mathrm{CFS}(365) = \\mu' \\alpha \\,\\Delta p(365) = 0.6 \\times 0.8 \\times 0.6876465 = 0.3300703 \\,\\text{MPa}.\n$$\n\nForm the ratio to the threshold $\\Delta \\mathrm{CFS}_c = 0.05 \\,\\text{MPa}$:\n$$\nR = \\frac{\\Delta \\mathrm{CFS}(365)}{\\Delta \\mathrm{CFS}_c} = \\frac{0.3300703}{0.05} = 6.601406.\n$$\n\nRounded to four significant figures, the ratio is $R \\approx 6.601$. Since $R > 1$, the cumulative $\\Delta \\mathrm{CFS}(t^*)$ exceeds the triggering threshold $\\Delta \\mathrm{CFS}_c$.", "answer": "$$\\boxed{6.601}$$", "id": "3532803"}, {"introduction": "While the direct pore pressure effect is critical, the solid framework's elastic response also transfers stress, a phenomenon known as poroelastic stress transfer. This problem challenges you to move beyond the scalar approximation used in the previous exercise ([@problem_id:3532803]) by deriving the full stress tensor change under geologically relevant constraints. By deriving and implementing a tight bound on the modeling error, you will gain a quantitative understanding of when simpler models are sufficient and when a full tensorial analysis is required.", "problem": "Consider a homogeneous, isotropic, linear poroelastic solid characterized by Biot’s coefficient $\\alpha$ and the elastic Lamé parameters $\\lambda$ and $G$. The total Cauchy stress tensor $\\boldsymbol{\\sigma}$ (compression positive) under quasi-static, small-strain conditions obeys the linear Biot constitutive law\n$$\n\\boldsymbol{\\sigma} \\;=\\; \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I} \\;+\\; 2G\\,\\boldsymbol{\\varepsilon} \\;-\\; \\alpha\\,p\\,\\mathbf{I},\n$$\nwhere $\\boldsymbol{\\varepsilon}$ is the infinitesimal strain tensor, $p$ is pore pressure, and $\\mathbf{I}$ is the second-order identity tensor. The Lamé parameters relate to Young’s modulus $E$ and Poisson’s ratio $\\nu$ via $G = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{2G\\nu}{1-2\\nu}$. The Biot effective stress is $\\boldsymbol{\\sigma}'=\\boldsymbol{\\sigma}-\\alpha p \\mathbf{I}$.\n\nA uniform pore-pressure increment $\\Delta p$ is applied. Assume an idealized constraint representing plane strain in the out-of-plane direction with zero out-of-plane strain, $\\varepsilon_{yy}=0$, and take the in-plane directions as $x$ and $z$ with $\\varepsilon_{xx}=0$ (lateral confinement) and zero traction in the vertical direction $\\Delta\\sigma_{zz}=0$. Under these homogeneous constraints, the pore-pressure increment induces a uniform elastic stress change $\\Delta\\boldsymbol{\\sigma}$ through the coupling in the constitutive law.\n\nFor a fault plane with unit normal $\\mathbf{n}$ and in-plane unit slip direction $\\mathbf{s}$ (with $\\mathbf{s}\\cdot\\mathbf{n}=0$), the change in Coulomb Failure Stress (CFS) is defined (compression positive) as\n$$\n\\Delta CFS \\;=\\; \\Delta \\tau \\;-\\; \\mu\\,\\Delta \\sigma_n',\n$$\nwhere $\\mu$ is the friction coefficient, $\\Delta \\tau = \\mathbf{s}^\\top \\Delta\\boldsymbol{t}$ is the resolved shear traction change in the slip direction, $\\Delta \\sigma_n'=\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}' \\mathbf{n}$ is the effective normal stress change on the plane, and $\\Delta\\boldsymbol{t}=\\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}$ is the traction change vector. Using the effective stress definition, one has $\\Delta \\sigma_n' = \\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} - \\alpha \\Delta p$.\n\nIn a commonly used scalar poroelastic approximation, elastic stress transfer is neglected and only the direct pore pressure effect on effective normal stress is retained, so that\n$$\n\\Delta CFS_{\\mathrm{scalar}} \\;=\\; \\mu\\,\\alpha\\,\\Delta p.\n$$\nIn contrast, the full tensorial solution under the stated constraints retains the elastic stress transfer term, yielding\n$$\n\\Delta CFS_{\\mathrm{full}} \\;=\\; \\underbrace{\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}}_{\\Delta \\tau_{\\mathrm{elastic}}} \\;-\\; \\mu\\left(\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} - \\alpha \\Delta p\\right).\n$$\n\nYour tasks are:\n\n- Starting from the linear Biot constitutive law, the stated kinematic constraints $\\varepsilon_{xx}=0$, $\\varepsilon_{yy}=0$, and the traction condition $\\Delta\\sigma_{zz}=0$, derive the uniform stress increment tensor $\\Delta\\boldsymbol{\\sigma}$ induced by a uniform pore-pressure increment $\\Delta p$ in terms of the material parameters and $\\Delta p$. Express your result using Poisson’s ratio $\\nu$ and Biot’s coefficient $\\alpha$, and identify a material-contrast factor $r(\\nu)$ that multiplies $\\alpha\\,\\Delta p$ in the nonzero components of $\\Delta\\boldsymbol{\\sigma}$. You must not assume any pretabulated poroelastic coefficients; derive them from the stated fundamentals.\n\n- Specialize to fault planes whose unit normals lie in the $x$–$z$ plane, parameterized by an angle $\\theta$ measured from the $x$-axis so that $\\mathbf{n} = [\\cos\\theta,\\,0,\\,\\sin\\theta]^\\top$ and choose the in-plane unit slip direction $\\mathbf{s}=[-\\sin\\theta,\\,0,\\,\\cos\\theta]^\\top$.\n\n- Compute the absolute modeling error in Coulomb Failure Stress change,\n$$\n\\varepsilon_{\\mathrm{CFS}} \\;=\\; \\left|\\Delta CFS_{\\mathrm{full}} \\;-\\; \\Delta CFS_{\\mathrm{scalar}}\\right| \\;=\\; \\left|\\,\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} \\;-\\; \\mu\\,\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}\\,\\right|.\n$$\n\n- Prove and implement a tight, orientation-independent upper bound of the form\n$$\n\\varepsilon_{\\mathrm{CFS}} \\;\\le\\; \\left| \\alpha\\,\\Delta p \\right|\\,r(\\nu)\\,c(\\mu),\n$$\nwhere $r(\\nu)$ is a material-contrast ratio depending only on $\\nu$ that arises from your tensorial solution, and $c(\\mu)$ is a function depending only on $\\mu$ that you must obtain as the supremum over all $\\theta$ of a trigonometric expression derived from the traction resolution. Your $c(\\mu)$ must be exact for the stated class of tensors and orientations.\n\n- Implement a program that, for each test case below, computes the absolute error $\\varepsilon_{\\mathrm{CFS}}$ and the bound $\\left| \\alpha\\,\\Delta p \\right|\\,r(\\nu)\\,c(\\mu)$, and returns a boolean indicating whether the inequality holds (with a numerical tolerance of $10^{-12}$ in Pascals). All stresses must be expressed in Pascals (Pa). All angles are provided in degrees and must be converted to radians internally via $\\theta_{\\mathrm{rad}} = \\pi\\,\\theta_{\\mathrm{deg}}/180$.\n\nTest suite (each tuple is $(\\Delta p\\ \\mathrm{[Pa]},\\,\\alpha,\\,\\nu,\\,\\mu,\\,\\theta\\ \\mathrm{[deg]})$):\n\n- Case A (typical parameters): $(\\,1.0\\times 10^{6},\\;0.8,\\;0.25,\\;0.6,\\;30\\,)$\n- Case B (nearly incompressible): $(\\,5.0\\times 10^{6},\\;1.0,\\;0.49,\\;0.6,\\;45\\,)$\n- Case C (low Poisson ratio, high friction): $(\\,2.0\\times 10^{6},\\;0.9,\\;0.15,\\;1.2,\\;75\\,)$\n- Case D (moderate Poisson ratio, frictionless): $(\\,3.0\\times 10^{5},\\;0.7,\\;1/3,\\;0.0,\\;15\\,)$\n- Case E (depletion, negative pore-pressure change): $(\\,-1.5\\times 10^{6},\\;0.85,\\;0.30,\\;0.5,\\;60\\,)$\n- Case F (near worst-case orientation for small friction): $(\\,4.0\\times 10^{6},\\;1.0,\\;0.20,\\;0.2,\\;39.345\\,)$\n\nYour program should produce a single line of output containing the results as a comma-separated list of Python booleans enclosed in square brackets (e.g., $[{\\rm True},{\\rm False},\\dots]$), in the same order as the test cases.", "solution": "The objective is to derive an orientation-independent upper bound for the modeling error incurred by a scalar approximation of poroelastic stress transfer effects on fault stability and to verify this bound numerically. The derivation proceeds in three main steps: 1) determining the poroelastic stress change tensor $\\Delta\\boldsymbol{\\sigma}$ under the given constraints, 2) calculating the exact modeling error $\\varepsilon_{\\mathrm{CFS}}$ as a function of fault orientation, and 3) finding a tight upper bound on this error by maximizing its orientation-dependent part.\n\nFirst, we derive the stress change tensor $\\Delta\\boldsymbol{\\sigma}$ resulting from a uniform pore pressure change $\\Delta p$. The linear Biot constitutive law is given as:\n$$\n\\Delta\\boldsymbol{\\sigma} \\;=\\; \\lambda \\,\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon})\\,\\mathbf{I} \\;+\\; 2G\\,\\Delta\\boldsymbol{\\varepsilon} \\;-\\; \\alpha\\,\\Delta p\\,\\mathbf{I}\n$$\nwhere $\\Delta\\boldsymbol{\\sigma}$ is the change in the total stress tensor, $\\Delta\\boldsymbol{\\varepsilon}$ is the change in the infinitesimal strain tensor, $\\lambda$ and $G$ are the Lamé parameters, $\\alpha$ is the Biot coefficient, $\\Delta p$ is the pore pressure change, and $\\mathbf{I}$ is the identity tensor. The problem assumes homogeneous conditions, so we can neglect shear strains and stresses, meaning $\\Delta\\boldsymbol{\\sigma}$ and $\\Delta\\boldsymbol{\\varepsilon}$ are diagonal tensors. The given constraints are no strain in the $x$ and $y$ directions, and no stress change in the $z$ direction:\n$$\n\\Delta\\varepsilon_{xx} = 0, \\quad \\Delta\\varepsilon_{yy} = 0, \\quad \\Delta\\sigma_{zz} = 0\n$$\nThe diagonal components of the constitutive law are:\n$$\n\\Delta\\sigma_{ii} = \\lambda(\\Delta\\varepsilon_{xx}+\\Delta\\varepsilon_{yy}+\\Delta\\varepsilon_{zz}) + 2G\\Delta\\varepsilon_{ii} - \\alpha\\Delta p\n$$\nApplying the strain constraints $\\Delta\\varepsilon_{xx}=0$ and $\\Delta\\varepsilon_{yy}=0$, the equations simplify to:\n$$\n\\Delta\\sigma_{xx} = \\lambda\\Delta\\varepsilon_{zz} - \\alpha\\Delta p \\quad (1)\n$$\n$$\n\\Delta\\sigma_{yy} = \\lambda\\Delta\\varepsilon_{zz} - \\alpha\\Delta p \\quad (2)\n$$\n$$\n\\Delta\\sigma_{zz} = (\\lambda+2G)\\Delta\\varepsilon_{zz} - \\alpha\\Delta p \\quad (3)\n$$\nUsing the stress constraint $\\Delta\\sigma_{zz}=0$ in equation ($3$), we solve for the unknown vertical strain change $\\Delta\\varepsilon_{zz}$:\n$$\n0 = (\\lambda+2G)\\Delta\\varepsilon_{zz} - \\alpha\\Delta p \\quad \\implies \\quad \\Delta\\varepsilon_{zz} = \\frac{\\alpha\\Delta p}{\\lambda+2G}\n$$\nSubstituting this result back into equations ($1$) and ($2$) yields the horizontal stress changes:\n$$\n\\Delta\\sigma_{xx} = \\Delta\\sigma_{yy} = \\lambda\\left(\\frac{\\alpha\\Delta p}{\\lambda+2G}\\right) - \\alpha\\Delta p = \\left(\\frac{\\lambda}{\\lambda+2G} - 1\\right)\\alpha\\Delta p = -\\frac{2G}{\\lambda+2G}\\alpha\\Delta p\n$$\nTo express this in terms of Poisson's ratio $\\nu$, we use the relation $\\lambda = \\frac{2G\\nu}{1-2\\nu}$. The denominator becomes $\\lambda+2G = \\frac{2G\\nu}{1-2\\nu} + 2G = 2G\\left(\\frac{\\nu}{1-2\\nu}+1\\right) = 2G\\frac{1-\\nu}{1-2\\nu}$. The ratio is thus:\n$$\n\\frac{2G}{\\lambda+2G} = \\frac{2G}{2G\\frac{1-\\nu}{1-2\\nu}} = \\frac{1-2\\nu}{1-\\nu}\n$$\nThe problem defines this material-contrast factor as $r(\\nu)$. Therefore, $r(\\nu) = \\frac{1-2\\nu}{1-\\nu}$. The non-zero stress changes are $\\Delta\\sigma_{xx} = \\Delta\\sigma_{yy} = -r(\\nu)\\alpha\\Delta p$. The full stress change tensor is:\n$$\n\\Delta\\boldsymbol{\\sigma} = \\begin{pmatrix} -r(\\nu)\\alpha\\Delta p  0  0 \\\\ 0  -r(\\nu)\\alpha\\Delta p  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n\nSecond, we compute the absolute modeling error, $\\varepsilon_{\\mathrm{CFS}} = \\left|\\,\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} \\;-\\; \\mu\\,\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}\\,\\right|$. The fault normal and slip vectors are $\\mathbf{n} = [\\cos\\theta, 0, \\sin\\theta]^\\top$ and $\\mathbf{s} = [-\\sin\\theta, 0, \\cos\\theta]^\\top$. Let $C = -r(\\nu)\\alpha\\Delta p$ for brevity.\nThe traction change term is $\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}$:\n$$\n\\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} = \\begin{pmatrix} C  0  0 \\\\ 0  C  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ 0 \\\\ \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} C\\cos\\theta \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{s}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} = \\begin{pmatrix} -\\sin\\theta  0  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} C\\cos\\theta \\\\ 0 \\\\ 0 \\end{pmatrix} = -C\\sin\\theta\\cos\\theta = r(\\nu)\\alpha\\Delta p \\sin\\theta\\cos\\theta\n$$\nThe normal stress change term is $\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n}$:\n$$\n\\mathbf{n}^\\top \\Delta\\boldsymbol{\\sigma}\\,\\mathbf{n} = \\begin{pmatrix} \\cos\\theta  0  \\sin\\theta \\end{pmatrix} \\begin{pmatrix} C\\cos\\theta \\\\ 0 \\\\ 0 \\end{pmatrix} = C\\cos^2\\theta = -r(\\nu)\\alpha\\Delta p \\cos^2\\theta\n$$\nCombining these into the expression for $\\varepsilon_{\\mathrm{CFS}}$:\n$$\n\\varepsilon_{\\mathrm{CFS}} = \\left| r(\\nu)\\alpha\\Delta p \\sin\\theta\\cos\\theta - \\mu(-r(\\nu)\\alpha\\Delta p \\cos^2\\theta) \\right| = \\left| r(\\nu)\\alpha\\Delta p (\\sin\\theta\\cos\\theta + \\mu\\cos^2\\theta) \\right|\n$$\nSince $\\alpha \\ge 0$ and $r(\\nu) = \\frac{1-2\\nu}{1-\\nu} \\ge 0$ for typical material properties ($0 \\le \\nu  0.5$), this simplifies to:\n$$\n\\varepsilon_{\\mathrm{CFS}} = |\\alpha\\Delta p| r(\\nu) \\left| \\sin\\theta\\cos\\theta + \\mu\\cos^2\\theta \\right|\n$$\n\nThird, we derive the orientation-independent upper bound by finding the supremum of the trigonometric term. Let $f(\\theta) = \\sin\\theta\\cos\\theta + \\mu\\cos^2\\theta$. We want to find $c(\\mu) = \\sup_{\\theta} |f(\\theta)|$. Using double-angle identities $\\sin\\theta\\cos\\theta = \\frac{1}{2}\\sin(2\\theta)$ and $\\cos^2\\theta = \\frac{1+\\cos(2\\theta)}{2}$:\n$$\nf(\\theta) = \\frac{1}{2}\\sin(2\\theta) + \\mu\\frac{1+\\cos(2\\theta)}{2} = \\frac{1}{2}\\left( \\sin(2\\theta) + \\mu\\cos(2\\theta) + \\mu \\right)\n$$\nThe term $\\sin(2\\theta) + \\mu\\cos(2\\theta)$ can be expressed in harmonic form $A\\cos(2\\theta-\\phi)$, where the amplitude is $A = \\sqrt{1^2+\\mu^2}$. So, $f(\\theta)$ becomes:\n$$\nf(\\theta) = \\frac{1}{2}\\left( \\sqrt{1+\\mu^2}\\cos(2\\theta-\\phi) + \\mu \\right)\n$$\nThe value of $f(\\theta)$ is therefore bounded by its extrema, which occur when $\\cos(2\\theta-\\phi)=\\pm 1$:\n$$\nf_{\\max} = \\frac{1}{2}(\\sqrt{1+\\mu^2} + \\mu), \\quad f_{\\min} = \\frac{1}{2}(-\\sqrt{1+\\mu^2} + \\mu)\n$$\nWe need to find the maximum of their absolute values. For a non-negative friction coefficient $\\mu \\ge 0$, we have $\\sqrt{1+\\mu^2} \\ge \\mu$. It follows that $f_{\\max} > 0$ and $f_{\\min} \\le 0$. Comparing magnitudes gives $|f_{\\max}| = \\frac{1}{2}(\\mu+\\sqrt{1+\\mu^2})$ and $|f_{\\min}| = \\frac{1}{2}(\\sqrt{1+\\mu^2}-\\mu)$. Clearly, $|f_{\\max}| \\ge |f_{\\min}|$.\nThus, the supremum is $c(\\mu) = |f_{\\max}| = \\frac{1}{2}\\left(\\mu + \\sqrt{1+\\mu^2}\\right)$.\n\nThe final, tight, orientation-independent upper bound is:\n$$\n\\varepsilon_{\\mathrm{CFS}} \\le |\\alpha\\Delta p| r(\\nu) c(\\mu) = |\\alpha\\Delta p| \\left(\\frac{1-2\\nu}{1-\\nu}\\right) \\frac{1}{2}\\left(\\mu + \\sqrt{1+\\mu^2}\\right)\n$$\nThis inequality is implemented in the following code to verify its validity for the given test cases. The code calculates both the exact error $\\varepsilon_{\\mathrm{CFS}}$ and the bound, then checks if the inequality holds subject to a numerical tolerance of $10^{-12}$ Pa.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poroelastic stress modeling error problem.\n\n    For a set of geomechanical scenarios, this function calculates the absolute error\n    between a full tensorial and a simplified scalar model for Coulomb Failure\n    Stress (CFS) change due to a pore pressure increment. It also calculates a\n    derived tight, orientation-independent upper bound for this error and verifies\n    that the error does not exceed the bound.\n    \"\"\"\n    \n    # Test suite: (delta_p [Pa], alpha, nu, mu, theta [deg])\n    test_cases = [\n        (1.0e6, 0.8, 0.25, 0.6, 30.0),      # Case A\n        (5.0e6, 1.0, 0.49, 0.6, 45.0),      # Case B\n        (2.0e6, 0.9, 0.15, 1.2, 75.0),      # Case C\n        (3.0e5, 0.7, 1/3, 0.0, 15.0),       # Case D\n        (-1.5e6, 0.85, 0.3, 0.5, 60.0),     # Case E\n        (4.0e6, 1.0, 0.2, 0.2, 39.345),     # Case F\n    ]\n\n    results = []\n    # Numerical tolerance in Pascals, as specified in the problem.\n    TOLERANCE = 1e-12\n\n    for case in test_cases:\n        delta_p, alpha, nu, mu, theta_deg = case\n\n        # Convert fault orientation angle from degrees to radians\n        theta_rad = np.pi * theta_deg / 180.0\n\n        # Calculate the material-contrast factor r(nu)\n        # This factor arises from the poro-thermo-elastic analogy under plane strain constraints\n        # r(nu) = (1 - 2*nu) / (1 - nu)\n        if nu == 1.0:\n            # Physical limit for nu is  0.5 for isotropic materials.\n            # nu=1 would cause a division by zero.\n            # The limit as nu - 0.5 is 0, which correctly represents an incompressible solid.\n            r_nu = 0.0\n        else:\n            r_nu = (1.0 - 2.0 * nu) / (1.0 - nu)\n\n        # Calculate the absolute modeling error in Coulomb Failure Stress, eps_CFS.\n        # eps_CFS = | alpha * delta_p * r_nu * (sin(theta)cos(theta) + mu*cos^2(theta)) |\n        cos_theta = np.cos(theta_rad)\n        sin_theta = np.sin(theta_rad)\n        \n        trig_term = sin_theta * cos_theta + mu * cos_theta**2\n        \n        eps_CFS = np.abs(alpha * delta_p * r_nu * trig_term)\n\n        # Calculate the orientation-independent bounding function c(mu).\n        # c(mu) is the supremum of |sin(theta)cos(theta) + mu*cos^2(theta)| over all theta.\n        # c(mu) = (mu + sqrt(1 + mu^2)) / 2\n        c_mu = 0.5 * (mu + np.sqrt(1.0 + mu**2))\n\n        # Calculate the tight, orientation-independent upper bound for the error.\n        # Bound = |alpha * delta_p| * r(nu) * c(mu)\n        bound = np.abs(alpha * delta_p) * r_nu * c_mu\n\n        # Verify that the calculated error is less than or equal to the derived bound,\n        # with the specified numerical tolerance.\n        is_valid = eps_CFS = bound + TOLERANCE\n        results.append(is_valid)\n\n    # Convert boolean results to lowercase strings for printing\n    # in compliance with Python's default string representation of booleans.\n    # e.g., True - \"True\"\n    # This step is implicitly handled by map(str, ...).\n    \n    # Final print statement in the exact required format: [True,True,False,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3532842"}, {"introduction": "Induced seismicity is not limited to fluid injection; reservoir depletion can also reactivate faults by altering the stress field in complex ways. This practice explores how reservoir compaction can lead to a rotation of the principal stresses, a critical mechanism for fault failure. By transforming stresses and applying the Mohr-Coulomb criterion, you will analyze how previously stable faults can be reoriented into a critical state, providing insight into a different class of induced seismic events.", "problem": "Consider a two-dimensional plane strain slice of a poroelastic reservoir subject to depletion. Let the far-field initial effective principal stresses be aligned with the Cartesian axes, with $x$ bearing the maximum principal effective stress and $y$ the minimum principal effective stress. Denote the initial effective principal stresses by $\\sigma_1$ and $\\sigma_2$ as positive numbers in megapascals (MPa), assuming the geomechanics sign convention in which compression is positive.\n\nReservoir depletion produces a compaction bowl and poroelastic stress transfer. Model the depletion-induced pore-pressure drop as a time-dependent function\n$$\n\\Delta p(t) = \\Delta p_{\\max}\\left(1 - e^{-t/t_c}\\right),\n$$\nwhere $\\Delta p_{\\max}$ is the maximum pore-pressure drop in MPa, $t$ is time in years, and $t_c$ is a characteristic depletion time in years. Approximate the axisymmetric compaction-induced effective stress perturbations in polar coordinates $(r,\\theta)$ on the horizontal plane by\n$$\n\\Delta \\sigma_r(r,t) = c_r \\,\\Delta p(t)\\,\\frac{a^2}{r^2 + a^2},\\quad\n\\Delta \\sigma_\\theta(r,t) = c_\\theta \\,\\Delta p(t)\\,\\frac{a^2}{r^2 + a^2},\n$$\nwith $a$ a length scale (in kilometers) capturing the bowl radius, $r$ the radial distance from the compaction center (in kilometers), $\\theta$ the polar angle (in degrees) measured from the $x$-axis, and $c_r,c_\\theta$ dimensionless coefficients representing anisotropy of the poroelastic stress transfer between radial and hoop directions.\n\nTransform these perturbations to Cartesian components to obtain the total effective stress tensor at time $t$,\n$$\n\\boldsymbol{\\sigma}(t) = \n\\begin{bmatrix}\n\\sigma_{xx}(t)  \\sigma_{xy}(t) \\\\\n\\sigma_{xy}(t)  \\sigma_{yy}(t)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\sigma_1  0\\\\\n0  \\sigma_2\n\\end{bmatrix}\n+\n\\begin{bmatrix}\n\\Delta \\sigma_{xx}(t)  \\Delta \\sigma_{xy}(t) \\\\\n\\Delta \\sigma_{xy}(t)  \\Delta \\sigma_{yy}(t)\n\\end{bmatrix},\n$$\nwhere the perturbation components are obtained by transforming $\\Delta \\sigma_r$ and $\\Delta \\sigma_\\theta$ from polar to Cartesian coordinates.\n\nYour tasks are:\n- Derive the principal stress rotation $\\Delta \\phi(t)$, defined as the angle in degrees between the initial maximum principal stress direction (the $x$-axis) and the instantaneous maximum principal direction of $\\boldsymbol{\\sigma}(t)$.\n- Evaluate, at a specified final time $t_{\\mathrm{end}}$, which preexisting fault families of specified orientations (angles in degrees measured from the $x$-axis) cross the frictional failure envelope under the rotated and perturbed stress state. Assume zero cohesion and a Mohr–Coulomb-type frictional failure criterion: failure occurs when the resolved shear stress magnitude $\\tau$ on the plane is greater than or equal to $\\mu\\,\\sigma_n$, where $\\mu$ is the friction coefficient (dimensionless), $\\sigma_n$ is the compressive effective normal stress on the plane (in MPa), and $\\tau$ is the shear stress magnitude (in MPa) on that plane.\n\nYou must implement a complete program that:\n1. Uses the fundamental laws of linear elasticity and stress transformation to compute the Cartesian stress components from the given polar perturbations and the initial stress state.\n2. Computes the principal stress rotation $\\Delta \\phi(t_{\\mathrm{end}})$ in degrees.\n3. Resolves the traction on each specified fault orientation and computes the effective normal stress $\\sigma_n$ and shear stress magnitude $\\tau$.\n4. Determines a boolean result for each fault family indicating whether $\\tau \\ge \\mu\\,\\sigma_n$ at $t_{\\mathrm{end}}$.\n\nUse the following test suite of parameter values. Each test case is independent and includes the parameters $(\\sigma_1,\\sigma_2,a,r,\\theta,c_r,c_\\theta,\\Delta p_{\\max},t_c,t_{\\mathrm{end}},\\mu,\\text{fault\\_angles})$ with units and meanings as defined above:\n- Test Case 1 (general case, moderate anisotropy, happy path):\n    - $\\sigma_1 = 40$ MPa, $\\sigma_2 = 30$ MPa, $a = 1.0$ km, $r = 1.0$ km, $\\theta = 45$ degrees,\n    - $c_r = 1.0$, $c_\\theta = 0.6$, $\\Delta p_{\\max} = 8$ MPa, $t_c = 0.4$ years, $t_{\\mathrm{end}} = 1.0$ years,\n    - $\\mu = 0.6$, $\\text{fault\\_angles} = [20,35,60]$ degrees.\n- Test Case 2 (strong anisotropy, near-critical, low friction to test failure crossing):\n    - $\\sigma_1 = 35$ MPa, $\\sigma_2 = 34$ MPa, $a = 2.0$ km, $r = 1.0$ km, $\\theta = 30$ degrees,\n    - $c_r = 1.5$, $c_\\theta = 0.1$, $\\Delta p_{\\max} = 15$ MPa, $t_c = 0.2$ years, $t_{\\mathrm{end}} = 1.0$ years,\n    - $\\mu = 0.15$, $\\text{fault\\_angles} = [30,60,75]$ degrees.\n- Test Case 3 (far-field point, boundary case with negligible perturbation):\n    - $\\sigma_1 = 45$ MPa, $\\sigma_2 = 35$ MPa, $a = 1.0$ km, $r = 10.0$ km, $\\theta = 30$ degrees,\n    - $c_r = 1.0$, $c_\\theta = 0.7$, $\\Delta p_{\\max} = 5$ MPa, $t_c = 0.5$ years, $t_{\\mathrm{end}} = 1.0$ years,\n    - $\\mu = 0.6$, $\\text{fault\\_angles} = [30,60]$ degrees.\n- Test Case 4 (isotropic perturbation, edge case yielding no principal rotation):\n    - $\\sigma_1 = 50$ MPa, $\\sigma_2 = 20$ MPa, $a = 1.5$ km, $r = 0.7$ km, $\\theta = 75$ degrees,\n    - $c_r = 0.9$, $c_\\theta = 0.9$, $\\Delta p_{\\max} = 12$ MPa, $t_c = 0.3$ years, $t_{\\mathrm{end}} = 1.0$ years,\n    - $\\mu = 0.6$, $\\text{fault\\_angles} = [45,60,90]$ degrees.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and is itself a two-element list. The first element is the final principal stress rotation $\\Delta \\phi(t_{\\mathrm{end}})$ in degrees rounded to three decimal places. The second element is a list of boolean values indicating, for each listed fault family, whether it crosses the frictional failure envelope at $t_{\\mathrm{end}}$. For example: \"[[rotation1,[bool1,bool2,...]],[rotation2,[...]],...]\".", "solution": "The problem requires a multi-step analysis of the stress state in a poroelastic medium undergoing depletion. We must first determine the stress state at a final time $t_{\\mathrm{end}}$ and then assess the stability of pre-existing faults. The solution is developed by following the principles of continuum mechanics for stress transformation and failure analysis.\n\n**Step 1: Time-Dependent Pore Pressure Change**\nThe depletion process is modeled by a time-dependent drop in pore pressure, $\\Delta p(t)$. The problem provides the functional form:\n$$\n\\Delta p(t) = \\Delta p_{\\max}\\left(1 - e^{-t/t_c}\\right)\n$$\nHere, $\\Delta p_{\\max}$ is the maximum possible pressure drop in megapascals (MPa), $t$ is the time in years, and $t_c$ is a characteristic time constant, also in years. For each test case, we first evaluate this function at the specified final time, $t = t_{\\mathrm{end}}$, to find the total pore pressure change $\\Delta p(t_{\\mathrm{end}})$ that has occurred.\n\n**Step 2: Poroelastic Stress Perturbation**\nThe pore pressure drop induces a change in the effective stress state. The problem supplies a simplified model for these stress perturbations in a polar coordinate system $(r,\\theta)$. The radial, $\\Delta \\sigma_r$, and hoop (tangential), $\\Delta \\sigma_\\theta$, stress changes are given by:\n$$\n\\Delta \\sigma_r(r,t) = c_r \\,\\Delta p(t)\\,\\frac{a^2}{r^2 + a^2}\n$$\n$$\n\\Delta \\sigma_\\theta(r,t) = c_\\theta \\,\\Delta p(t)\\,\\frac{a^2}{r^2 + a^2}\n$$\nwhere $a$ is a characteristic radius of the compaction bowl in kilometers, $r$ is the radial distance from the center in kilometers, and $c_r$ and $c_\\theta$ are dimensionless anisotropy coefficients. We calculate these two values at the point of interest $(r, \\theta)$ using the previously computed $\\Delta p(t_{\\mathrm{end}})$.\n\n**Step 3: Stress Transformation to Cartesian Coordinates**\nThe initial stress state is given in a fixed Cartesian coordinate system $(x,y)$, so the polar stress perturbations must be transformed into this same system to be combined. The standard tensor transformation equations are used. For a point at angle $\\theta$ (measured from the $x$-axis), the Cartesian components of the stress perturbation tensor, $\\Delta \\boldsymbol{\\sigma}$, are:\n$$\n\\Delta \\sigma_{xx} = \\Delta \\sigma_r \\cos^2\\theta + \\Delta \\sigma_\\theta \\sin^2\\theta\n$$\n$$\n\\Delta \\sigma_{yy} = \\Delta \\sigma_r \\sin^2\\theta + \\Delta \\sigma_\\theta \\cos^2\\theta\n$$\n$$\n\\Delta \\sigma_{xy} = (\\Delta \\sigma_r - \\Delta \\sigma_\\theta) \\sin\\theta \\cos\\theta\n$$\nNote that the input angle $\\theta$ is in degrees and must be converted to radians for use in trigonometric functions.\n\n**Step 4: Total Effective Stress Tensor**\nThe total effective stress tensor at time $t_{\\mathrm{end}}$, denoted $\\boldsymbol{\\sigma}(t_{\\mathrm{end}})$, is the sum of the initial stress tensor and the perturbation tensor. The initial state is diagonal, with $\\sigma_{xx}(0) = \\sigma_1$ and $\\sigma_{yy}(0) = \\sigma_2$, and $\\sigma_{xy}(0) = 0$. Thus, the components of the total stress tensor are:\n$$\n\\sigma_{xx}(t_{\\mathrm{end}}) = \\sigma_1 + \\Delta \\sigma_{xx}(t_{\\mathrm{end}})\n$$\n$$\n\\sigma_{yy}(t_{\\mathrm{end}}) = \\sigma_2 + \\Delta \\sigma_{yy}(t_{\\mathrm{end}})\n$$\n$$\n\\sigma_{xy}(t_{\\mathrm{end}}) = 0 + \\Delta \\sigma_{xy}(t_{\\mathrm{end}})\n$$\n\n**Step 5: Principal Stress Rotation**\nThe introduction of the shear component $\\sigma_{xy}(t_{\\mathrm{end}})$ causes the principal stress axes to rotate. The initial maximum principal stress was aligned with the $x$-axis (an angle of $0^\\circ$). The angle of the new maximum principal stress, $\\phi_p$, relative to the $x$-axis, is found from the components of the total stress tensor. The formula for the orientation of the principal planes is:\n$$\n\\tan(2\\phi_p) = \\frac{2\\sigma_{xy}}{\\sigma_{xx} - \\sigma_{yy}}\n$$\nThe principal stress rotation, $\\Delta \\phi$, is simply $\\phi_p$, since the initial orientation was $0^\\circ$. To avoid ambiguity in the angle, we use the two-argument arctangent function, $\\arctan2(y, x)$. The rotation in radians is:\n$$\n\\Delta \\phi = \\frac{1}{2} \\arctan2(2\\sigma_{xy}, \\sigma_{xx} - \\sigma_{yy})\n$$\nThis result is then converted from radians to degrees for the final output, as requested.\n\n**Step 6: Fault Stability Analysis**\nThe final task is to determine if pre-existing faults at specified orientations become critically stressed. We use the Mohr-Coulomb failure criterion with zero cohesion, which states that failure occurs when the magnitude of the shear stress, $\\tau$, on a plane is greater than or equal to the frictional resistance, $\\mu \\sigma_n$, where $\\mu$ is the coefficient of friction and $\\sigma_n$ is the effective normal stress on that same plane. For a fault plane oriented at an angle $\\beta$ with respect to the $x$-axis, the normal stress $\\sigma_n$ and shear stress $\\tau_s$ resolved on that plane are given by:\n$$\n\\sigma_n = \\frac{\\sigma_{xx} + \\sigma_{yy}}{2} + \\frac{\\sigma_{xx} - \\sigma_{yy}}{2} \\cos(2\\beta) + \\sigma_{xy} \\sin(2\\beta)\n$$\n$$\n\\tau_s = -\\frac{\\sigma_{xx} - \\sigma_{yy}}{2} \\sin(2\\beta) + \\sigma_{xy} \\cos(2\\beta)\n$$\nThe magnitude of the shear stress is $\\tau = |\\tau_s|$. For each fault angle in the input list, we compute $\\sigma_n$ and $\\tau$ using the total stress components $\\sigma_{xx}(t_{\\mathrm{end}})$, $\\sigma_{yy}(t_{\\mathrm{end}})$, and $\\sigma_{xy}(t_{\\mathrm{end}})$. We then evaluate the boolean condition:\n$$\n\\tau \\ge \\mu \\sigma_n\n$$\nAs with other angles, the fault orientation $\\beta$ is given in degrees and must be converted to radians for these calculations. The results for all specified fault families are collected into a list of booleans.\n\nThis sequence of calculations is performed for each test case, and the results—the principal stress rotation and the list of fault failure booleans—are formatted into the final specified output string. The implementation will use the `numpy` library for efficient numerical and trigonometric operations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        (40.0, 30.0, 1.0, 1.0, 45.0, 1.0, 0.6, 8.0, 0.4, 1.0, 0.6, [20, 35, 60]),\n        # Test Case 2\n        (35.0, 34.0, 2.0, 1.0, 30.0, 1.5, 0.1, 15.0, 0.2, 1.0, 0.15, [30, 60, 75]),\n        # Test Case 3\n        (45.0, 35.0, 1.0, 10.0, 30.0, 1.0, 0.7, 5.0, 0.5, 1.0, 0.6, [30, 60]),\n        # Test Case 4\n        (50.0, 20.0, 1.5, 0.7, 75.0, 0.9, 0.9, 12.0, 0.3, 1.0, 0.6, [45, 60, 90]),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string with no spaces.\n    def format_result(res_list):\n        outer_parts = []\n        for item in res_list:\n            rotation = item[0]\n            bools = item[1]\n            bool_str = '[' + ','.join(map(str, bools)).replace(\"True\", \"true\").replace(\"False\", \"false\") + ']'\n            outer_parts.append(f'[{rotation},{bool_str}]')\n        return '[' + ','.join(outer_parts) + ']'\n\n    print(format_result(results))\n\ndef _solve_case(sigma1, sigma2, a, r, theta_deg, cr, ctheta, dp_max, tc, t_end, mu, fault_angles_deg):\n    \"\"\"\n    Solves a single test case for the poroelastic stress problem.\n    \"\"\"\n    # Convert angles from degrees to radians for trigonometric functions\n    theta_rad = np.deg2rad(theta_deg)\n    fault_angles_rad = np.deg2rad(np.array(fault_angles_deg))\n\n    # Step 1: Calculate pore pressure drop at t_end\n    dp_t_end = dp_max * (1.0 - np.exp(-t_end / tc))\n\n    # Step 2: Calculate stress perturbations in polar coordinates\n    common_factor = dp_t_end * (a**2 / (r**2 + a**2))\n    delta_sigma_r = cr * common_factor\n    delta_sigma_theta = ctheta * common_factor\n\n    # Step 3: Transform perturbations to Cartesian coordinates\n    cos_theta = np.cos(theta_rad)\n    sin_theta = np.sin(theta_rad)\n    \n    delta_sigma_xx = delta_sigma_r * cos_theta**2 + delta_sigma_theta * sin_theta**2\n    delta_sigma_yy = delta_sigma_r * sin_theta**2 + delta_sigma_theta * cos_theta**2\n    delta_sigma_xy = (delta_sigma_r - delta_sigma_theta) * sin_theta * cos_theta\n\n    # Step 4: Calculate total stress tensor components\n    sigma_xx = sigma1 + delta_sigma_xx\n    sigma_yy = sigma2 + delta_sigma_yy\n    sigma_xy = 0.0 + delta_sigma_xy\n\n    # Step 5: Calculate principal stress rotation\n    # The angle of the new max principal stress relative to the x-axis is given by\n    # 0.5 * arctan2(2*sigma_xy, sigma_xx - sigma_yy). This is the rotation angle.\n    delta_phi_rad = 0.5 * np.arctan2(2.0 * sigma_xy, sigma_xx - sigma_yy)\n    delta_phi_deg = np.rad2deg(delta_phi_rad)\n\n    # Step 6: Analyze fault stability for each fault orientation\n    fault_failure_bools = []\n    for beta_rad in fault_angles_rad:\n        # Use stable double-angle formulas for stress on the fault plane\n        cos_2beta = np.cos(2.0 * beta_rad)\n        sin_2beta = np.sin(2.0 * beta_rad)\n\n        sigma_n = (sigma_xx + sigma_yy) / 2.0 + (sigma_xx - sigma_yy) / 2.0 * cos_2beta + sigma_xy * sin_2beta\n        tau_s = -(sigma_xx - sigma_yy) / 2.0 * sin_2beta + sigma_xy * cos_2beta\n        \n        # Shear stress magnitude\n        tau_mag = np.abs(tau_s)\n\n        # Apply Mohr-Coulomb failure criterion: tau = mu * sigma_n\n        is_failing = tau_mag = mu * sigma_n if sigma_n  0 else False\n        fault_failure_bools.append(bool(is_failing))\n        \n    # Format the result for this case as per the requirements\n    return [f\"{delta_phi_deg:.3f}\", fault_failure_bools]\n\nsolve()\n```", "id": "3532835"}]}