{"hands_on_practices": [{"introduction": "Before diving into complex numerical codes, it is crucial to grasp the fundamental physics of dynamic soil response. This exercise [@problem_id:3521440] guides you through deriving the governing equation for pore pressure diffusion from first principles. By calculating the hydraulic diffusivity and a key dimensionless parameter, the drainage number ($N_d$), you will develop an intuition for whether a soil layer will behave as a drained or undrained material under cyclic loading—a cornerstone concept in effective stress analysis.", "problem": "A horizontally extensive, fully saturated sand layer of thickness $H=5\\,\\text{m}$ overlies a rigid substratum. The layer is subjected to a vertically uniform, cyclic shear loading of period $T=0.5\\,\\text{s}$ such that the deformation is one-dimensional in the vertical direction and representative of plane-strain conditions at large lateral extent. The soil-fluid system follows linear poroelasticity. The intrinsic permeability of the sand is $k=5\\times 10^{-12}\\,\\text{m}^{2}$, the pore fluid dynamic viscosity is $\\mu=1\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$, and the Biot modulus (often denoted $M$) characterizing the storage of the coupled medium is $M=0.8\\,\\text{GPa}$. Assume small strains and small pore pressure gradients.\n\nStarting from fundamental relations appropriate to effective stress-based dynamic soil analysis, namely Darcy’s law for fluid flow and mass conservation for the fluid-solid mixture, together with a linear compressibility relation linking pore pressure to volumetric fluid content through the Biot modulus, derive the governing diffusion equation for the pore pressure $p$ and from it identify the hydraulic diffusivity $c$ as a material parameter. Then, by dimensional analysis of the derived diffusion equation, define a dimensionless drainage number $N_{d}$ as the square of the ratio of the characteristic diffusion length over one load period to the layer thickness. Evaluate $c$ and $N_{d}$ for the given properties and $T=0.5\\,\\text{s}$, and briefly conclude whether the dynamic response over one cycle is closer to drained or undrained.\n\nRound $c$ and $N_{d}$ to three significant figures. Express $c$ in $\\text{m}^{2}/\\text{s}$. Report $N_{d}$ as dimensionless. Do not include units in the final boxed answer.", "solution": "The problem is first validated and found to be scientifically grounded, well-posed, and objective, based on the established principles of linear poroelasticity. All required data are provided, and the parameters are physically realistic. We may therefore proceed with the solution.\n\nThe derivation of the governing diffusion equation for pore pressure $p$ begins with three fundamental relations: mass conservation of the pore fluid, Darcy's law for fluid flow, and a storage relation for the fluid-solid mixture.\n\n1.  **Mass Conservation**: For one-dimensional vertical flow, the conservation of fluid mass requires that the rate of change of the volumetric fluid content, $\\zeta$, is balanced by the spatial gradient of the specific discharge, $q_z$.\n    $$\n    \\frac{\\partial \\zeta}{\\partial t} = -\\frac{\\partial q_z}{\\partial z}\n    $$\n    Here, $t$ is time and $z$ is the vertical coordinate.\n\n2.  **Darcy's Law**: The specific discharge, $q_z$, is linearly related to the gradient of the excess pore pressure, $p$. This relationship is given by Darcy's law:\n    $$\n    q_z = -\\frac{k}{\\mu} \\frac{\\partial p}{\\partial z}\n    $$\n    where $k$ is the intrinsic permeability of the sand and $\\mu$ is the dynamic viscosity of the pore fluid.\n\n3.  **Compressibility Relation (Storage Law)**: The problem specifies a linear compressibility relation linking the pore pressure $p$ to the volumetric fluid content $\\zeta$ through the Biot modulus, $M$. The rate of change of $\\zeta$ is proportional to the rate of change of $p$:\n    $$\n    \\frac{\\partial \\zeta}{\\partial t} = \\frac{1}{M} \\frac{\\partial p}{\\partial t}\n    $$\n    This equation describes the storage of fluid in the porous medium due to the compressibility of the fluid and the solid matrix.\n\nTo derive the diffusion equation, we combine these three principles. First, substitute the storage law into the mass conservation equation:\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = -\\frac{\\partial q_z}{\\partial z}\n$$\nNext, substitute Darcy's law into the resulting equation:\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial z} \\left( -\\frac{k}{\\mu} \\frac{\\partial p}{\\partial z} \\right)\n$$\nAssuming the material properties ($k$, $\\mu$, and $M$) are homogeneous throughout the layer and thus spatially constant, we can simplify the right-hand side:\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = \\frac{k}{\\mu} \\frac{\\partial^2 p}{\\partial z^2}\n$$\nRearranging this to the standard form of a diffusion equation, we obtain:\n$$\n\\frac{\\partial p}{\\partial t} = \\left(\\frac{kM}{\\mu}\\right) \\frac{\\partial^2 p}{\\partial z^2}\n$$\nThis is the governing diffusion equation for the pore pressure $p$.\n\nThe general form of a one-dimensional diffusion equation is $\\frac{\\partial \\phi}{\\partial t} = c \\frac{\\partial^2 \\phi}{\\partial z^2}$. By comparing our derived equation to this general form, we can identify the hydraulic diffusivity, $c$, as:\n$$\nc = \\frac{kM}{\\mu}\n$$\nWe now evaluate $c$ using the given parameter values: $k=5 \\times 10^{-12}\\,\\text{m}^{2}$, $M=0.8\\,\\text{GPa} = 0.8 \\times 10^9\\,\\text{Pa}$, and $\\mu=1 \\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$.\n$$\nc = \\frac{(5 \\times 10^{-12}\\,\\text{m}^2) \\times (0.8 \\times 10^9\\,\\text{Pa})}{1 \\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}} = \\frac{4.0 \\times 10^{-3}}{1 \\times 10^{-3}} \\, \\frac{\\text{m}^2}{\\text{s}} = 4.0 \\, \\frac{\\text{m}^2}{\\text{s}}\n$$\nRounding to three significant figures, a requirement of the problem, we have $c = 4.00\\,\\text{m}^2/\\text{s}$.\n\nNext, we define and evaluate the dimensionless drainage number, $N_d$. The problem specifies that $N_d$ is the square of the ratio of the characteristic diffusion length over one load period to the layer thickness.\nThe characteristic time is the load period, $T = 0.5\\,\\text{s}$.\nThe characteristic diffusion length, $L_d$, is the distance over which significant diffusion occurs in time $T$. From dimensional analysis of the diffusion equation, $L_d$ is proportional to $\\sqrt{cT}$.\nThe layer thickness is $H = 5\\,\\text{m}$.\nThe drainage number $N_d$ is therefore defined as:\n$$\nN_d = \\left( \\frac{L_d}{H} \\right)^2 = \\left( \\frac{\\sqrt{cT}}{H} \\right)^2 = \\frac{cT}{H^2}\n$$\nSubstituting the values for $c$, $T$, and $H$:\n$$\nN_d = \\frac{(4.00\\,\\text{m}^2/\\text{s}) \\times (0.5\\,\\text{s})}{(5\\,\\text{m})^2} = \\frac{2.00}{25} = 0.08\n$$\nRounding to three significant figures, $N_d = 0.0800$.\n\nFinally, we use $N_d$ to assess the drainage condition. The drainage number $N_d = \\frac{cT}{H^2}$ compares the timescale of loading, $T$, to the timescale of pore pressure diffusion across the layer, $\\tau_{\\text{diff}} = \\frac{H^2}{c}$. A small value of $N_d$ ($N_d \\ll 1$) signifies that the loading is rapid compared to the time required for fluid to drain, leading to an 'undrained' response where pore pressures build up. A large value of $N_d$ ($N_d \\gg 1$) signifies a slow loading that allows pore pressures to dissipate, leading to a 'drained' response.\nOur calculated value is $N_d = 0.0800$. Since this value is much less than $1$, the dynamic response of the soil layer over one cycle is much closer to undrained than to drained. The pore fluid does not have sufficient time to flow and dissipate the generated pressures within the duration of a single load cycle.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.00  0.0800\n\\end{pmatrix}\n}\n$$", "id": "3521440"}, {"introduction": "Effective stress analysis hinges on accurately modeling how pore pressure evolves, which is often driven by irreversible plastic deformation in the soil skeleton. This practice [@problem_id:3521372] moves beyond simple linear elasticity to explore a more advanced viscoplastic material model, linking the rate of shearing to the generation of plastic volumetric strain and, consequently, changes in pore pressure. By implementing a Perzyna-type overstress model, you will gain hands-on experience with the constitutive relationships that form the heart of modern liquefaction and soil dynamics simulations.", "problem": "A saturated silt specimen is modeled under small strains using the effective stress principle and poromechanical coupling. Adopt the sign convention that volumetric strain is positive in extension. The total Cauchy stress is decomposed into effective stress and pore pressure using the Biot theory as follows: $\\boldsymbol{\\sigma}^{\\prime} = \\boldsymbol{\\sigma} - \\alpha\\,p\\,\\mathbf{I}$, where $\\alpha$ is the Biot coefficient and $p$ is the pore pressure. Under undrained plastic volumetric straining, assume the linearized fluid-skeleton compressibility coupling yields the pore pressure increment\n$$\n\\Delta p = -\\,\\alpha\\,M\\,\\Delta \\varepsilon_v^p,\n$$\nwhere $M$ is the Biot modulus and $\\varepsilon_v^p$ is the plastic volumetric strain. The deviatoric loading is applied as a simple shear stress history characterized by the scalar shear stress $q(t)$, taken as a linear ramp in time:\n$$\nq(t) = q_{\\max}\\,\\frac{t}{T}, \\quad t \\in [0,T],\n$$\nwith $q_{\\max}$ the terminal shear stress at time $T$. The material exhibits time-dependent viscoplasticity following a Perzyna-type overstress law. Let the overstress be defined by\n$$\nf(t) = q(t) - q_y,\n$$\nwhere $q_y$ is a rate-independent shear strength threshold. The Macaulay bracket is denoted by $\\langle x \\rangle = \\max(x,0)$. The viscoplastic multiplier rate is modeled as\n$$\n\\dot{\\lambda}(t) = \\left(\\frac{\\langle f(t)\\rangle}{k}\\right)^{m}\\frac{1}{t_0},\n$$\nwhere $k$ and $m$ are material parameters and $t_0$ is a characteristic time scale. The viscoplastic strain rate tensor is $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\mathbf{N}$, where $\\mathbf{N}$ is the flow direction. Only the volumetric component of the flow direction is needed for the pore pressure response, and it is specified by the scalar $\\operatorname{tr}(\\mathbf{N}) = n_v$, a constant. Thus, the plastic volumetric strain rate is\n$$\n\\dot{\\varepsilon}_v^p(t) = \\dot{\\lambda}(t)\\,n_v.\n$$\nAssume that initially $\\varepsilon_v^p(0)=0$, that the material remains fully saturated, and that $\\alpha=1$. All physical quantities in this problem are to be expressed in kilopascal ($\\mathrm{kPa}$) for stresses, and seconds ($\\mathrm{s}$) for time. The final answers for pore pressure increments must be reported in $\\mathrm{kPa}$.\n\nTask: For each test case below, compute the final pore pressure increment $\\Delta p(T)$ generated by the ramp loading, using the definitions above. You must use the given sign convention, the linear ramp loading, and the rate dependence as stated. You may assume that $q(t)$ acts without affecting the mean total stress directly, and that all pore pressure change arises from plastic volumetric strain via the stated coupling. Use $\\alpha = 1$, $M = 100{,}000\\,\\text{kPa}$, and $t_0 = 1\\,\\mathrm{s}$ for all cases. Take $n_v$ to be a constant for each case as given. Report each result in $\\text{kPa}$, rounded to $6$ decimal places.\n\nTest suite (each case is a tuple $(q_{\\max},T,q_y,k,m,n_v)$ using the units above):\n- Case $1$: $(100,\\,1,\\,60,\\,50,\\,2,\\,-0.001)$\n- Case $2$: $(50,\\,1,\\,60,\\,50,\\,2,\\,-0.001)$\n- Case $3$: $(100,\\,1,\\,60,\\,25,\\,1,\\,-0.001)$\n- Case $4$: $(100,\\,1,\\,60,\\,50,\\,2,\\,-0.0002)$\n- Case $5$: $(100,\\,2,\\,60,\\,50,\\,2,\\,-0.001)$\n- Case $6$: $(60,\\,1,\\,60,\\,50,\\,2,\\,-0.001)$\n\nAdditional requirements:\n- Angle units are not required in this problem.\n- The program must output a single line containing a comma-separated list of the results for Cases $1$ through $6$ in order, enclosed in square brackets, with each value rounded to $6$ decimal places in $\\text{kPa}$. For example: $[r_1,r_2,r_3,r_4,r_5,r_6]$ where each $r_i$ is a decimal number in $\\text{kPa}$.", "solution": "The problem is well-posed, scientifically grounded in the principles of continuum mechanics and poromechanics, and contains all necessary information for a unique solution. Therefore, it is deemed valid.\n\nThe objective is to compute the final pore pressure increment, $\\Delta p(T)$, at the end of a linear shear stress ramp. The calculation proceeds by integrating the rate of viscoplastic strain over the duration of loading.\n\nThe pore pressure increment, $\\Delta p$, is coupled to the plastic volumetric strain, $\\Delta \\varepsilon_v^p$, via the linearized fluid-skeleton compressibility relation:\n$$\n\\Delta p = -\\alpha M \\Delta \\varepsilon_v^p\n$$\nGiven the initial condition $\\varepsilon_v^p(0) = 0$, the total increment over the time interval $[0, T]$ is $\\Delta \\varepsilon_v^p(T) = \\varepsilon_v^p(T) - \\varepsilon_v^p(0) = \\varepsilon_v^p(T)$. Thus, the final pore pressure increment is:\n$$\n\\Delta p(T) = -\\alpha M \\varepsilon_v^p(T)\n$$\nThe quantity $\\varepsilon_v^p(T)$ is the total plastic volumetric strain at time $T$, which is obtained by integrating the plastic volumetric strain rate, $\\dot{\\varepsilon}_v^p(t)$, from $t=0$ to $t=T$:\n$$\n\\varepsilon_v^p(T) = \\int_0^T \\dot{\\varepsilon}_v^p(t) \\, dt\n$$\nThe plastic volumetric strain rate is defined by the flow rule $\\dot{\\varepsilon}_v^p(t) = \\dot{\\lambda}(t) n_v$, where $\\dot{\\lambda}(t)$ is the viscoplastic multiplier rate and $n_v$ is the volumetric component of the flow direction tensor. Substituting this into the integral gives:\n$$\n\\varepsilon_v^p(T) = n_v \\int_0^T \\dot{\\lambda}(t) \\, dt\n$$\nThe viscoplastic multiplier rate, $\\dot{\\lambda}(t)$, is governed by a Perzyna-type overstress model:\n$$\n\\dot{\\lambda}(t) = \\left(\\frac{\\langle f(t)\\rangle}{k}\\right)^{m}\\frac{1}{t_0}\n$$\nHere, $f(t)$ is the overstress, defined as the difference between the current deviatoric stress $q(t)$ and the yield strength $q_y$:\n$$\nf(t) = q(t) - q_y\n$$\nThe deviatoric stress $q(t)$ is applied as a linear ramp:\n$$\nq(t) = q_{\\max}\\,\\frac{t}{T}\n$$\nSubstituting this into the overstress function yields:\n$$\nf(t) = q_{\\max}\\,\\frac{t}{T} - q_y\n$$\nThe Macaulay bracket, $\\langle f(t) \\rangle$, ensures that viscoplastic flow only occurs when the overstress is positive, i.e., $f(t) > 0$. This condition $q_{\\max}\\frac{t}{T} - q_y > 0$ holds for $t > t_y$, where $t_y$ is the time at which yielding begins:\n$$\nt_y = T \\frac{q_y}{q_{\\max}}\n$$\nIf $q_{\\max} \\le q_y$, then $t_y \\ge T$, meaning no plastic yielding occurs within the loading interval $[0,T]$. In this situation, $\\langle f(t) \\rangle = 0$ for all $t \\in [0,T]$, which results in $\\dot{\\lambda}(t) = 0$, $\\varepsilon_v^p(T) = 0$, and consequently $\\Delta p(T) = 0$.\n\nFor the case where $q_{\\max} > q_y$, the integral for $\\varepsilon_v^p(T)$ becomes non-zero and is evaluated over the interval $[t_y, T]$:\n$$\n\\varepsilon_v^p(T) = n_v \\int_{t_y}^T \\frac{1}{t_0} \\left(\\frac{q_{\\max}\\frac{t}{T} - q_y}{k}\\right)^{m} dt = \\frac{n_v}{t_0 k^m} \\int_{t_y}^T \\left(q_{\\max}\\frac{t}{T} - q_y\\right)^{m} dt\n$$\nTo solve this integral, we perform a change of variables. Let $u = q_{\\max}\\frac{t}{T} - q_y$. The differential is $du = \\frac{q_{\\max}}{T} dt$, so $dt = \\frac{T}{q_{\\max}} du$. The limits of integration become:\n- For $t = t_y$, $u = q_{\\max}\\frac{t_y}{T} - q_y = q_{\\max}\\frac{q_y/q_{\\max} \\cdot T}{T} - q_y = 0$.\n- For $t = T$, $u = q_{\\max}\\frac{T}{T} - q_y = q_{\\max} - q_y$.\n\nThe integral in terms of $u$ is:\n$$\n\\int_0^{q_{\\max} - q_y} u^m \\left(\\frac{T}{q_{\\max}}\\right) du = \\frac{T}{q_{\\max}} \\left[ \\frac{u^{m+1}}{m+1} \\right]_0^{q_{\\max} - q_y} = \\frac{T}{q_{\\max}} \\frac{(q_{\\max} - q_y)^{m+1}}{m+1}\n$$\nSubstituting this result back into the expression for $\\varepsilon_v^p(T)$:\n$$\n\\varepsilon_v^p(T) = \\frac{n_v}{t_0 k^m} \\frac{T}{q_{\\max}} \\frac{(q_{\\max} - q_y)^{m+1}}{m+1}\n$$\nFinally, we obtain the expression for the pore pressure increment $\\Delta p(T)$:\n$$\n\\Delta p(T) = -\\alpha M \\varepsilon_v^p(T) = -\\alpha M \\left( \\frac{n_v}{t_0 k^m} \\frac{T}{q_{\\max}} \\frac{(q_{\\max} - q_y)^{m+1}}{m+1} \\right)\n$$\nFor all test cases, the constants are $\\alpha = 1$, $M = 100{,}000\\,\\text{kPa}$, and $t_0 = 1\\,\\mathrm{s}$. The formula simplifies to:\n$$\n\\Delta p(T) = -M \\frac{n_v T}{k^m q_{\\max}} \\frac{(q_{\\max} - q_y)^{m+1}}{m+1} \\quad \\text{for } q_{\\max} > q_y\n$$\nIf $q_{\\max} \\le q_y$, then $\\Delta p(T) = 0$. The following Python program implements this derived formula to compute the results for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the final pore pressure increment for a series of test cases based on a\n    Perzyna-type viscoplastic model coupled with poromechanics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (q_max, T, q_y, k, m, n_v)\n    test_cases = [\n        (100.0, 1.0, 60.0, 50.0, 2.0, -0.001),    # Case 1\n        (50.0, 1.0, 60.0, 50.0, 2.0, -0.001),     # Case 2\n        (100.0, 1.0, 60.0, 25.0, 1.0, -0.001),    # Case 3\n        (100.0, 1.0, 60.0, 50.0, 2.0, -0.0002),   # Case 4\n        (100.0, 2.0, 60.0, 50.0, 2.0, -0.001),    # Case 5\n        (60.0, 1.0, 60.0, 50.0, 2.0, -0.001),     # Case 6\n    ]\n\n    # Global constants\n    M = 100000.0  # Biot modulus in kPa\n    alpha = 1.0     # Biot coefficient\n    t_0 = 1.0       # Characteristic time scale in s\n\n    results = []\n    for case in test_cases:\n        q_max, T, q_y, k, m, n_v = case\n\n        # If the maximum shear stress does not exceed the yield strength,\n        # there is no viscoplastic strain and thus no pore pressure change.\n        if q_max = q_y:\n            delta_p_T = 0.0\n        else:\n            # Analytical formula for the pore pressure increment derived from the\n            # integration of the viscoplastic rate equations.\n            #\n            # delta_p(T) = -alpha * M * epsilon_v_p(T)\n            # epsilon_v_p(T) = n_v * integral from 0 to T of lambda_dot(t) dt\n            # lambda_dot(t) = (1/t_0) * ((q_max*t/T - q_y) / k>)^m\n            #\n            # After integration:\n            # delta_p(T) = -alpha * M * n_v / (t_0 * k^m) * (T / q_max) * (q_max - q_y)^(m+1) / (m+1)\n\n            term1 = -alpha * M * n_v\n            term2 = T / q_max\n            term3 = (q_max - q_y)**(m + 1.0) / (m + 1.0)\n            term4 = 1.0 / (k**m)\n            \n            delta_p_T = term1 * term2 * term3 * term4\n\n        results.append(delta_p_T)\n\n    # Format the results to 6 decimal places as required by the problem statement.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3521372"}, {"introduction": "Bridging the gap between theory and a functional simulation requires assembling the discrete governing equations into a solvable system. This capstone exercise [@problem_id:3521435] challenges you to construct the global Jacobian matrix for a fully coupled displacement-pressure ($u-p$) finite element model. You will tackle the practical details of applying boundary conditions and discover how the spectral radius of the system matrix provides vital insight into the convergence behavior of the numerical solver, a critical skill for any computational mechanician.", "problem": "Consider the one-dimensional linear poroelastic (Biot) continuum in the effective stress framework under small strains, with displacement field $u(x,t)$ and pore pressure field $p(x,t)$. The total stress is given by the Terzaghi effective stress relation $\\sigma(x,t) = \\sigma'(x,t) - \\alpha p(x,t)$, where $\\sigma'(x,t) = E \\, \\varepsilon(x,t)$ with strain $\\varepsilon(x,t) = \\partial u / \\partial x$, Young's modulus $E$, and Biot coefficient $\\alpha$. The momentum balance (including inertia and optional Rayleigh damping) and fluid mass balance are governed by the following fundamental statements:\n\n- Momentum balance: $ \\rho \\, \\ddot{u} + c_d \\, \\dot{u} - \\frac{\\partial}{\\partial x}\\left( E \\, \\frac{\\partial u}{\\partial x} - \\alpha p \\right) = b_u $, where $ \\rho $ is the mixture density, $ c_d $ is a phenomenological damping proportional to velocity, and $ b_u $ is a prescribed body force per unit volume.\n- Fluid mass balance with compressible fluid and Darcy flow: $ n \\beta_f \\, \\dot{p} + \\alpha \\, \\dot{\\varepsilon} - \\frac{\\partial}{\\partial x}\\left( \\frac{k}{\\mu} \\, \\frac{\\partial p}{\\partial x} \\right) = b_p $, where $ n $ is porosity, $ \\beta_f $ is fluid compressibility, $ k $ is intrinsic permeability, $ \\mu $ is dynamic viscosity, and $ b_p $ is a volumetric source term.\n\nYou will discretize the above equations in space using two linear finite elements over a uniform bar of total length $L$ and cross-sectional area $A$, resulting in three nodes at positions $ x_0 = 0 $, $ x_1 = L/2 $, and $ x_2 = L $. Each node carries both displacement $u$ and pressure $p$ degrees of freedom. For the cyclic loading context, a traction $T(t) = T_0 \\sin(2 \\pi f t)$ is applied at the right end ($x = L$), where $T_0$ is a specified amplitude and $f$ is a specified frequency. Use Rayleigh damping for the solid with $C = a_R M + b_R K$ where $M$ is the consistent mass matrix, $K$ is the elastic stiffness matrix, and $a_R$, $b_R$ are Rayleigh coefficients. For the mixture density, use $\\rho = (1-n) \\rho_s + n \\rho_f$, where $\\rho_s$ and $\\rho_f$ are the solid grain density and fluid density, respectively.\n\nTime integration over a single dynamic step from time $ t_n $ to time $ t_{n+1} = t_n + \\Delta t $ must be formulated using the Newmark family for the solid displacement with parameters $ \\beta $ and $ \\gamma $, and a backward Euler update for the pore pressure:\n- Newmark kinematics give $ \\ddot{u}^{n+1} $ and $ \\dot{u}^{n+1} $ in terms of $ u^{n+1} $ with coefficients $ a_0 = 1 / (\\beta \\Delta t^2) $ and $ a_3 = \\gamma / (\\beta \\Delta t) $ for the Jacobian.\n- Backward Euler for pore pressure gives $ \\dot{p}^{n+1} = (p^{n+1} - p^n)/\\Delta t $.\n\nImpose the following essential boundary conditions: fix the displacement at the left end, $ u(x_0) = 0 $, and prescribe drained pore pressure at both ends, $ p(x_0) = 0 $ and $ p(x_2) = 0 $. Assemble the global block Jacobian of the residual for the unknowns at time $ t_{n+1} $, ordered as $ [u^{n+1}, p^{n+1}] $, accounting for $u$–$p$ coupling. After applying the boundary conditions by eliminating constrained rows and columns, compute the spectral radius (the maximum absolute value among the eigenvalues) of a nondimensionalized Jacobian defined as follows. Let the unknown scaling vector be $ s_x = [L_0, \\dots, L_0, P_0, \\dots, P_0] $, where $ L_0 $ is a characteristic length and $ P_0 $ is a characteristic pressure, applied to the displacement and pressure unknowns respectively. Let the residual scaling vector be $ s_r = [E A / L_0, \\dots, E A / L_0, P_0 / \\Delta t, \\dots, P_0 / \\Delta t] $, applied to the momentum and mass residuals respectively. The nondimensional Jacobian $ J_d $ is defined by $ J_d = S_r^{-1} J S_x $, where $ S_x $ and $ S_r $ are diagonal matrices containing the entries of $ s_x $ and $ s_r $. The spectral radius is then $ \\rho(J_d) = \\max_i | \\lambda_i(J_d) | $, a dimensionless quantity.\n\nImplement the above in a complete, runnable program that:\n- Uses a one-dimensional two-element linear finite element mesh with uniform properties and shape functions $ N_1 = 1 - \\xi $, $ N_2 = \\xi $ on each element ($ \\xi $ is the local coordinate), $ B_u = [ -1/\\ell_e, 1/\\ell_e ] $ and $ B_p = [ -1/\\ell_e, 1/\\ell_e ] $ with element length $ \\ell_e = L/2 $. The consistent element matrices are:\n  - Solid stiffness $ K_{uu}^e = (E A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $,\n  - Solid mass $ M^e = ( \\rho A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $,\n  - Solid Rayleigh damping $ C^e = a_R M^e + b_R K_{uu}^e $,\n  - Coupling from pressure to momentum $ K_{up}^e = (\\alpha A / 2) \\begin{bmatrix} 1  1 \\\\ -1  -1 \\end{bmatrix} $,\n  - Coupling from solid velocity to mass balance $ C_{pu}^e = (\\alpha A / 2) \\begin{bmatrix} -1  1 \\\\ -1  1 \\end{bmatrix} $,\n  - Fluid diffusion $ K_{pp}^e = ((k/\\mu) A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $,\n  - Fluid storage $ S_{pp}^e = ( n \\beta_f A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $.\n- Assembles the global matrices, applies the essential boundary conditions by eliminating associated rows and columns, and forms the time-discrete Jacobian blocks:\n  - $ J_{uu} = K_{uu} + a_0 M + a_3 C $,\n  - $ J_{up} = K_{up} $,\n  - $ J_{pu} = a_3 C_{pu} $,\n  - $ J_{pp} = K_{pp} + (1/\\Delta t) S_{pp} $.\n- Constructs $ J $ from the above blocks, nondimensionalizes to $ J_d $ using $ S_x $ and $ S_r $, and computes $ \\rho(J_d) $.\n\nUse the following test suite, each item given as a tuple of parameters $ (L, A, E, \\alpha, n, \\beta_f, k, \\mu, \\rho_s, \\rho_f, a_R, b_R, \\Delta t, \\gamma, \\beta, L_0, P_0, T_0, f) $. The cyclic load parameters $ T_0 $ and $ f $ are provided for completeness of the physical setting; the Jacobian for the linear system is independent of $ T_0 $ and $ f $ in this formulation.\n\n- Test case $1$ (general moderate coupling, moderate permeability): $ (10, 1, 50 \\times 10^6, 0.8, 0.35, 4.5 \\times 10^{-10}, 10^{-9}, 10^{-3}, 2650, 1000, 0.01, 10^{-4}, 0.1, 0.5, 0.25, 10, 100 \\times 10^3, 100 \\times 10^3, 1) $.\n- Test case $2$ (near-undrained, very low permeability): $ (10, 1, 50 \\times 10^6, 0.8, 0.35, 4.5 \\times 10^{-10}, 10^{-12}, 10^{-3}, 2650, 1000, 0.01, 10^{-4}, 0.1, 0.5, 0.25, 10, 100 \\times 10^3, 100 \\times 10^3, 1) $.\n- Test case $3$ (high fluid compressibility, no damping, small time step): $ (10, 1, 80 \\times 10^6, 1.0, 0.35, 10^{-8}, 10^{-10}, 10^{-3}, 2650, 1000, 0, 0, 0.01, 0.5, 0.25, 10, 100 \\times 10^3, 50 \\times 10^3, 2) $.\n- Test case $4$ (alternative Newmark parameters, zero cyclic amplitude): $ (10, 1, 30 \\times 10^6, 0.9, 0.4, 4.5 \\times 10^{-10}, 10^{-10}, 10^{-3}, 2650, 1000, 0.005, 5 \\times 10^{-5}, 0.05, 0.6, 0.3025, 10, 100 \\times 10^3, 0, 0.5) $.\n\nYour program should produce a single line of output containing the spectral radii for the four test cases as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$). The spectral radius is dimensionless due to the stated nondimensionalization; do not include any physical units in the output.", "solution": "The user has provided a problem in the field of computational geomechanics, specifically concerning the one-dimensional dynamic analysis of a poroelastic medium using the finite element method. The problem is to calculate the spectral radius of a nondimensionalized system Jacobian matrix for several test cases.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing Equations**:\n    1.  Momentum balance: $ \\rho \\, \\ddot{u} + c_d \\, \\dot{u} - \\frac{\\partial}{\\partial x}\\left( E \\, \\frac{\\partial u}{\\partial x} - \\alpha p \\right) = b_u $\n    2.  Fluid mass balance: $ n \\beta_f \\, \\dot{p} + \\alpha \\, \\dot{\\varepsilon} - \\frac{\\partial}{\\partial x}\\left( \\frac{k}{\\mu} \\, \\frac{\\partial p}{\\partial x} \\right) = b_p $\n- **Constitutive  Kinematic Relations**:\n    - Strain: $ \\varepsilon(x,t) = \\partial u / \\partial x $\n    - Effective Stress: $ \\sigma(x,t) = \\sigma'(x,t) - \\alpha p(x,t) $, with $ \\sigma'(x,t) = E \\, \\varepsilon(x,t) $\n    - Mixture Density: $ \\rho = (1-n) \\rho_s + n \\rho_f $\n- **Discretization**:\n    - Spatial: Two linear finite elements over a bar of length $L$. Three nodes at $x_0=0, x_1=L/2, x_2=L$.\n    - Shape Functions: $N_1 = 1 - \\xi$, $N_2 = \\xi$. Strain-Displacement matrix $B_u = [-1/\\ell_e, 1/\\ell_e]$.\n    - Time Integration: Newmark method for displacement ($\\beta, \\gamma$), Backward Euler for pressure.\n- **Boundary Conditions**:\n    - Displacement: $u(x_0) = 0$\n    - Pore Pressure: $p(x_0) = 0$, $p(x_2) = 0$\n- **Loading**: Traction $T(t) = T_0 \\sin(2 \\pi f t)$ at $x=L$.\n- **Element Matrices**:\n    - $ K_{uu}^e = (E A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $\n    - $ M^e = ( \\rho A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $\n    - $ C^e = a_R M^e + b_R K_{uu}^e $\n    - $ K_{up}^e = (\\alpha A / 2) \\begin{bmatrix} 1  1 \\\\ -1  -1 \\end{bmatrix} $\n    - $ C_{pu}^e = (\\alpha A / 2) \\begin{bmatrix} -1  1 \\\\ -1  1 \\end{bmatrix} $\n    - $ K_{pp}^e = ((k/\\mu) A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $\n    - $ S_{pp}^e = ( n \\beta_f A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $\n- **System Jacobian Blocks**:\n    - $ J_{uu} = K_{uu} + a_0 M + a_3 C $, with $ a_0 = 1 / (\\beta \\Delta t^2) $, $ a_3 = \\gamma / (\\beta \\Delta t) $\n    - $ J_{up} = K_{up} $\n    - $ J_{pu} = a_3 C_{pu} $\n    - $ J_{pp} = K_{pp} + (1/\\Delta t) S_{pp} $\n- **Nondimensionalization**:\n    - $ J_d = S_r^{-1} J S_x $\n    - Unknown scaling vector: $ s_x = [L_0, \\dots, L_0, P_0, \\dots, P_0] $\n    - Residual scaling vector: $ s_r = [E A / L_0, \\dots, E A / L_0, P_0 / \\Delta t, \\dots, P_0 / \\Delta t] $\n- **Target Quantity**: Spectral radius $ \\rho(J_d) $.\n- **Test Cases**: Four sets of parameters are provided.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientific Grounding**: The problem is founded on the well-established Biot theory of poroelasticity. The governing equations for momentum and mass balance are standard representations of coupled fluid flow and solid deformation. The use of finite elements for spatial discretization and Newmark/Backward Euler methods for time integration are standard, robust techniques in computational mechanics. The provided element matrices are correct for linear elements and the specified governing equations. The Rayleigh damping formulation is also a standard practice. All aspects are scientifically sound.\n\n2.  **Well-Posedness**: The task is to compute the spectral radius of a matrix derived from a clearly specified procedure. Given the inputs (material parameters, geometry, boundary conditions), the global matrices and the resulting Jacobian are uniquely determined. Applying boundary conditions by eliminating rows/columns is a standard procedure that leads to a unique reduced matrix. The subsequent nondimensionalization and spectral radius calculation are well-defined mathematical operations. Thus, the problem is well-posed.\n\n3.  **Objectivity**: The problem statement is composed entirely of quantitative, objective definitions and instructions. There is no subjective language.\n\n4.  **Flaw Analysis**:\n    - **Incompleteness/Contradiction**: All necessary data, including material properties, geometric parameters, discretization choices, boundary conditions, and time integration parameters, are provided for each test case. A careful check of the signs in the governing equations versus the provided element matrices and Jacobian definitions confirms their internal consistency. Specifically, the definition of $K_{up}^e$ is consistent with a weak form where the pressure term in the momentum balance is integrated by parts. The problem is self-consistent.\n    - **Other Flaws**: The problem is not trivial, unrealistic, ill-posed, or unscientific. It represents a standard, albeit complex, numerical analysis task in its domain.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is scientifically grounded, internally consistent, well-posed, and provides all necessary information to proceed with a solution.\n\n### Solution\n\nThe solution involves implementing the specified finite element procedure to compute the spectral radius of the nondimensionalized Jacobian for each given test case. The overall process is as follows:\n\n1.  **Parameter Initialization**: For each test case, define all physical and numerical parameters provided in the problem statement.\n2.  **Element Matrix Formulation**: Based on the parameters, calculate the seven element-level matrices ($K_{uu}^e$, $M^e$, $C^e$, $K_{up}^e$, $C_{pu}^e$, $K_{pp}^e$, $S_{pp}^e$) for a single linear element of length $\\ell_e = L/2$. The Rayleigh damping matrix $C^e$ is formed from $M^e$ and $K_{uu}^e$.\n3.  **Global Matrix Assembly**: Assemble the global system matrices for the three-node, two-element mesh. The global matrices for the displacement field ($K_{uu}$, $M$, $C$) and the pressure field ($K_{pp}$, $S_{pp}$) are $3 \\times 3$. The coupling matrices ($K_{up}$, $C_{pu}$) that link the two fields are also $3 \\times 3$. Assembly is performed by iterating through the two elements and adding their contributions to the appropriate entries of the global matrices.\n4.  **Jacobian Formation**: Construct the time-discrete Jacobian blocks ($J_{uu}$, $J_{up}$, $J_{pu}$, $J_{pp}$) using the assembled global matrices and the time integration coefficients ($a_0$, $a_3$). These blocks are then arranged into the full $6 \\times 6$ system Jacobian, $J$. The degrees of freedom are ordered as $[u_0, u_1, u_2, p_0, p_1, p_2]$.\n5.  **Application of Boundary Conditions**: The essential boundary conditions $u_0=0$, $p_0=0$, and $p_2=0$ correspond to the 0th, 3rd, and 5th degrees of freedom in the global system. The problem specifies that these constraints are applied by eliminating the corresponding rows and columns from the Jacobian matrix $J$. This reduces the system to the free degrees of freedom: $[u_1, u_2, p_1]$. The resulting reduced Jacobian, $J_{reduced}$, is a $3 \\times 3$ matrix.\n6.  **Nondimensionalization**: The reduced Jacobian is nondimensionalized according to the formula $J_d = S_r^{-1} J_{reduced} S_x$. The diagonal scaling matrices $S_x$ and $S_r$ are constructed from the scaling vectors $s_x$ and $s_r$, which are defined based on the characteristic length $L_0$, characteristic pressure $P_0$, and other system parameters. For the reduced $3 \\times 3$ system, the scaling vectors are $s_x = [L_0, L_0, P_0]$ and $s_r = [E A / L_0, E A / L_0, P_0 / \\Delta t]$.\n7.  **Spectral Radius Calculation**: Finally, the eigenvalues of the resulting $3 \\times 3$ nondimensionalized Jacobian matrix $J_d$ are computed. The spectral radius, $\\rho(J_d)$, is the maximum absolute value among these eigenvalues.\n\nThis entire procedure is repeated for each of the four test cases provided in the problem statement. The final output is a list of the four computed spectral radii.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the poroelasticity problem for all test cases.\n    \"\"\"\n    \n    # (L, A, E, alpha, n, beta_f, k, mu, rho_s, rho_f, a_R, b_R, dt, gamma, beta, L0, P0, T0, f)\n    test_cases = [\n        (10, 1, 50e6, 0.8, 0.35, 4.5e-10, 1e-9, 1e-3, 2650, 1000, 0.01, 1e-4, 0.1, 0.5, 0.25, 10, 100e3, 100e3, 1),\n        (10, 1, 50e6, 0.8, 0.35, 4.5e-10, 1e-12, 1e-3, 2650, 1000, 0.01, 1e-4, 0.1, 0.5, 0.25, 10, 100e3, 100e3, 1),\n        (10, 1, 80e6, 1.0, 0.35, 1e-8, 1e-10, 1e-3, 2650, 1000, 0, 0, 0.01, 0.5, 0.25, 10, 100e3, 50e3, 2),\n        (10, 1, 30e6, 0.9, 0.4, 4.5e-10, 1e-10, 1e-3, 2650, 1000, 0.005, 5e-5, 0.05, 0.6, 0.3025, 10, 100e3, 0, 0.5),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_spectral_radius(params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_spectral_radius(params):\n    \"\"\"\n    Computes the spectral radius of the nondimensionalized Jacobian for a single test case.\n    \"\"\"\n    # 1. Unpack parameters and define mesh properties\n    L, A, E, alpha, n, beta_f, k, mu, rho_s, rho_f, a_R, b_R, dt, gamma, beta, L0, P0, _, _ = params\n    \n    num_elements = 2\n    num_nodes = 3\n    ell_e = L / num_elements\n\n    # 2. Calculate derived parameters\n    mixture_density = (1 - n) * rho_s + n * rho_f\n    a0 = 1 / (beta * dt**2)\n    a3 = gamma / (beta * dt)\n\n    # 3. Formulate element matrices\n    K_uu_e = (E * A / ell_e) * np.array([[1., -1.], [-1., 1.]])\n    M_e = (mixture_density * A * ell_e / 6.) * np.array([[2., 1.], [1., 2.]])\n    C_e = a_R * M_e + b_R * K_uu_e\n    K_up_e = (alpha * A / 2.) * np.array([[1., 1.], [-1., -1.]])\n    C_pu_e = (alpha * A / 2.) * np.array([[-1., 1.], [-1., 1.]])\n    K_pp_e = ((k / mu) * A / ell_e) * np.array([[1., -1.], [-1., 1.]])\n    S_pp_e = (n * beta_f * A * ell_e / 6.) * np.array([[2., 1.], [1., 2.]])\n    \n    element_matrices = {\n        \"Kuu\": K_uu_e, \"M\": M_e, \"C\": C_e,\n        \"Kup\": K_up_e, \"Cpu\": C_pu_e,\n        \"Kpp\": K_pp_e, \"Spp\": S_pp_e\n    }\n\n    # 4. Assemble global matrices\n    global_matrices = {key: np.zeros((num_nodes, num_nodes)) for key in element_matrices}\n    \n    element_node_map = [[0, 1], [1, 2]]\n    for nodes in element_node_map:\n        idx = np.ix_(nodes, nodes)\n        for key, mat_e in element_matrices.items():\n            global_matrices[key][idx] += mat_e\n\n    # 5. Form global Jacobian blocks\n    J_uu = global_matrices[\"Kuu\"] + a0 * global_matrices[\"M\"] + a3 * global_matrices[\"C\"]\n    J_up = global_matrices[\"Kup\"]\n    J_pu = a3 * global_matrices[\"Cpu\"]\n    J_pp = global_matrices[\"Kpp\"] + (1 / dt) * global_matrices[\"Spp\"]\n\n    # 6. Form full 6x6 Jacobian matrix\n    J = np.block([\n        [J_uu, J_up],\n        [J_pu, J_pp]\n    ])\n\n    # 7. Apply boundary conditions by eliminating rows and columns\n    # DOFs: [u0, u1, u2, p0, p1, p2] -> indices [0, 1, 2, 3, 4, 5]\n    # BCs: u0=0, p0=0, p2=0 -> constrained DOFs at indices 0, 3, 5\n    # Free DOFs: [u1, u2, p1] -> indices [1, 2, 4]\n    free_dofs = [1, 2, 4]\n    J_reduced = J[np.ix_(free_dofs, free_dofs)]\n    \n    # 8. Define scaling matrices for nondimensionalization\n    # Reduced unknown vector: [u1, u2, p1]\n    # Reduced residual vector corresponds to: mom_eq_node1, mom_eq_node2, mass_eq_node1\n    s_x_vec = np.array([L0, L0, P0])\n    s_r_vec = np.array([E * A / L0, E * A / L0, P0 / dt])\n    \n    S_x = np.diag(s_x_vec)\n    S_r_inv = np.diag(1.0 / s_r_vec)\n\n    # 9. Compute the nondimensional Jacobian\n    J_d = S_r_inv @ J_reduced @ S_x\n\n    # 10. Compute and return the spectral radius\n    eigenvalues = np.linalg.eigvals(J_d)\n    spectral_radius = np.max(np.abs(eigenvalues))\n    \n    return spectral_radius\n\nsolve()\n```", "id": "3521435"}]}