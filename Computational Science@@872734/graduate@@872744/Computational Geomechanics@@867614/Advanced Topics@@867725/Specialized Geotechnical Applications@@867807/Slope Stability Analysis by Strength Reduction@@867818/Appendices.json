{"hands_on_practices": [{"introduction": "Before applying the Strength Reduction Method (SRM) in complex software, it is crucial to grasp its mathematical underpinnings. This foundational exercise guides you through the derivation of the relationship between the trial Factor of Safety, $F_s$, and the resulting reduction in the soil's friction angle. By analyzing this relationship for different angle regimes, you will develop a deeper appreciation for the non-linear nature of strength reduction, a critical insight for correctly interpreting numerical results and understanding the method's inherent assumptions [@problem_id:3560645].", "problem": "Consider a homogeneous, isotropic slope analyzed using the Shear Strength Reduction (SSR) procedure within the Finite Element Method (FEM). The soil obeys the Mohr–Coulomb failure criterion with effective cohesion $c'$ and effective friction angle $\\phi'$, so that the mobilized shear strength on a plane with effective normal stress $\\sigma_n'$ is given by $\\tau = c' + \\sigma_n' \\tan\\phi'$. In SSR, the strength parameters are systematically reduced by a trial Factor of Safety $F_s > 1$ until global failure within the numerical model is detected. The standard SSR scaling applies $c' \\mapsto c_r' = c'/F_s$ and $\\tan\\phi' \\mapsto \\tan\\phi_r' = \\tan\\phi'/F_s$.\n\nStarting from the Mohr–Coulomb failure condition and the SSR scaling stated above, derive a single reduced friction angle $\\phi_r$ such that the reduced stress–strength relation can be written in the same functional form as the original, namely $\\tau_r = c_r' + \\sigma_n' \\tan\\phi_r$. Express $\\phi_r$ explicitly as a closed-form analytic expression in terms of $\\phi'$ and $F_s$, and specify the angle in radians.\n\nThen, using first-principles properties of the tangent and arctangent functions, analyze how $\\phi_r$ depends on $F_s$ for two regimes:\n- small angles $0 < \\phi' \\ll 1$ (in radians), and\n- moderate-to-large angles, for example $\\phi'$ in the range $0.5 \\lesssim \\phi' \\lesssim \\pi/3$.\n\nIn your analysis, justify the limiting behavior and sensitivity of $\\phi_r$ to $F_s$ by appropriate series expansions and monotonicity arguments. Do not assume or cite any pre-derived strength reduction formulas beyond the Mohr–Coulomb criterion and the SSR scaling stated. Provide the final answer as the requested closed-form analytic expression for $\\phi_r$ in radians. No rounding is required.", "solution": "The problem requires the derivation of the reduced friction angle in the context of the Shear Strength Reduction (SSR) method and an analysis of its properties. The problem is scientifically grounded, well-posed, and objective, and therefore deemed valid.\n\nThe analysis begins with the Mohr–Coulomb failure criterion for the soil's shear strength, $\\tau$. The effective shear strength is given by the sum of a cohesive component and a frictional component. For a given plane with effective normal stress $\\sigma_n'$, the shear strength is:\n$$\n\\tau = c' + \\sigma_n' \\tan\\phi'\n$$\nHere, $c'$ is the effective cohesion and $\\phi'$ is the effective angle of internal friction.\n\nThe Shear Strength Reduction (SSR) method involves finding a factor of safety, denoted $F_s$, which when applied to the soil's strength parameters, brings the soil mass to a state of limit equilibrium (i.e., failure). The problem specifies the standard SSR scaling for the Mohr–Coulomb parameters: the cohesion $c'$ and the tangent of the friction angle $\\tan\\phi'$ are both reduced by the factor $F_s$.\n\nLet the reduced strength parameters be denoted $c_r'$ and $\\phi_r$. According to the problem statement, the new, reduced cohesion is:\n$$\nc_r' = \\frac{c'}{F_s}\n$$\nThe problem states that the reduction is also applied to the tangent of the friction angle. This means that the tangent of the new, reduced friction angle, $\\tan\\phi_r$, is defined by scaling the original tangent of the friction angle:\n$$\n\\tan\\phi_r = \\frac{\\tan\\phi'}{F_s}\n$$\nThe resulting reduced shear strength, $\\tau_r$, which represents the mobilized shear strength at the point of failure, is written in the same functional form as the original criterion but with the reduced parameters:\n$$\n\\tau_r = c_r' + \\sigma_n' \\tan\\phi_r\n$$\nThe question asks for a closed-form analytic expression for the reduced friction angle $\\phi_r$ in terms of the original friction angle $\\phi'$ and the factor of safety $F_s$. From the definition of the scaling for the frictional component, we can directly solve for $\\phi_r$. Since $\\phi_r$ is the angle whose tangent is $\\frac{\\tan\\phi'}{F_s}$, we can express $\\phi_r$ using the arctangent function. Assuming that the angles $\\phi'$ and $\\phi_r$ are in the principal range $(-\\pi/2, \\pi/2)$, which is physically required for friction angles, we have:\n$$\n\\phi_r = \\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right)\n$$\nThis is the required closed-form expression for the reduced friction angle in radians.\n\nNext, we analyze the dependence of $\\phi_r$ on $F_s$ for two different regimes of $\\phi'$.\n\nCase 1: Small angles ($0 < \\phi' \\ll 1$ in radians)\n\nFor small angles $x$, the Maclaurin series for $\\tan(x)$ and $\\arctan(x)$ are:\n$$\n\\tan(x) = x + \\frac{x^3}{3} + O(x^5)\n$$\n$$\n\\arctan(y) = y - \\frac{y^3}{3} + O(y^5)\n$$\nGiven $\\phi'$ is small, we can approximate $\\tan\\phi'$:\n$$\n\\tan\\phi' \\approx \\phi'\n$$\nThe argument of the arctangent function in our expression for $\\phi_r$ becomes $\\frac{\\tan\\phi'}{F_s} \\approx \\frac{\\phi'}{F_s}$. Since $F_s > 1$, this argument is also small. Therefore, the reduced angle $\\phi_r$ is also small, which allows us to use the small-angle approximation for the arctangent function:\n$$\n\\phi_r = \\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right) \\approx \\frac{\\tan\\phi'}{F_s} \\approx \\frac{\\phi'}{F_s}\n$$\nThis shows that for small friction angles, the reduced angle $\\phi_r$ is approximately equal to the original angle $\\phi'$ scaled down by the factor of safety $F_s$. The relationship is nearly linear.\n\nTo be more rigorous, let us expand the expression for $\\phi_r$ in powers of $\\phi'$. Let $x = \\phi'$.\n$$\n\\frac{\\tan(x)}{F_s} = \\frac{x + x^3/3 + O(x^5)}{F_s} = \\frac{x}{F_s} + \\frac{x^3}{3F_s} + O(x^5)\n$$\nNow, we substitute this into the series for $\\arctan(y)$, with $y = \\frac{\\tan(x)}{F_s}$:\n$$\n\\phi_r = \\left(\\frac{x}{F_s} + \\frac{x^3}{3F_s}\\right) - \\frac{1}{3}\\left(\\frac{x}{F_s}\\right)^3 + O(x^5)\n$$\n$$\n\\phi_r = \\frac{x}{F_s} + \\left(\\frac{1}{3F_s} - \\frac{1}{3F_s^3}\\right)x^3 + O(x^5)\n$$\nSubstituting $x = \\phi'$ back gives:\n$$\n\\phi_r = \\frac{\\phi'}{F_s} + \\frac{F_s^2 - 1}{3F_s^3}(\\phi')^3 + O((\\phi')^5)\n$$\nSince $F_s > 1$, the coefficient of the $(\\phi')^3$ term, $\\frac{F_s^2 - 1}{3F_s^3}$, is positive. This rigorously demonstrates that $\\phi_r$ is slightly larger than the linear approximation $\\phi'/F_s$. This means that the standard SSR scaling of $\\tan\\phi'$ results in a less severe reduction of the friction angle itself compared to a hypothetical direct scaling of the angle, $\\phi' \\mapsto \\phi'/F_s$.\n\nCase 2: Moderate-to-large angles ($0.5 \\lesssim \\phi' \\lesssim \\pi/3$)\n\nIn this range, the small-angle approximations are no longer valid, and the relationship $\\phi_r = \\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right)$ is highly non-linear. To analyze the sensitivity of $\\phi_r$ to $F_s$, we examine the partial derivative $\\frac{\\partial\\phi_r}{\\partial F_s}$. Using the chain rule for differentiation, where $u = \\frac{\\tan\\phi'}{F_s}$:\n$$\n\\frac{\\partial\\phi_r}{\\partial F_s} = \\frac{\\partial}{\\partial F_s} \\arctan(u) = \\frac{1}{1+u^2} \\frac{\\partial u}{\\partial F_s}\n$$\nThe derivative of $u$ with respect to $F_s$ is:\n$$\n\\frac{\\partial u}{\\partial F_s} = \\tan\\phi' \\left(-\\frac{1}{F_s^2}\\right) = -\\frac{\\tan\\phi'}{F_s^2}\n$$\nSubstituting this back, we obtain:\n$$\n\\frac{\\partial\\phi_r}{\\partial F_s} = \\frac{1}{1 + \\left(\\frac{\\tan\\phi'}{F_s}\\right)^2} \\left(-\\frac{\\tan\\phi'}{F_s^2}\\right) = -\\frac{\\tan\\phi'}{F_s^2 + (\\tan\\phi')^2}\n$$\nSince $\\phi' \\in (0, \\pi/2)$, $\\tan\\phi' > 0$. As $F_s > 1$, the denominator is always positive. Therefore, $\\frac{\\partial\\phi_r}{\\partial F_s} < 0$, which confirms that $\\phi_r$ is a monotonically decreasing function of $F_s$. This is physically intuitive: a larger factor of safety requires a greater reduction in strength, hence a smaller reduced friction angle.\n\nThe non-linearity of the reduction can be further demonstrated by proving the inequality $\\phi_r > \\phi'/F_s$ for all $\\phi' \\in (0, \\pi/2)$ and $F_s > 1$. Let us define two functions of a variable $x$: $f(x) = \\arctan\\left(\\frac{\\tan x}{F_s}\\right)$ and $g(x) = \\frac{x}{F_s}$. We note that $f(0) = g(0) = 0$. Now we compare their derivatives:\n$$\ng'(x) = \\frac{1}{F_s}\n$$\n$$\nf'(x) = \\frac{d}{dx}\\arctan\\left(\\frac{\\tan x}{F_s}\\right) = \\frac{1}{1+\\left(\\frac{\\tan x}{F_s}\\right)^2} \\cdot \\frac{\\sec^2 x}{F_s} = \\frac{F_s \\sec^2 x}{F_s^2 + \\tan^2 x}\n$$\nWe want to check if $f'(x) > g'(x)$:\n$$\n\\frac{F_s \\sec^2 x}{F_s^2 + \\tan^2 x} > \\frac{1}{F_s}\n$$\n$$\nF_s^2 \\sec^2 x > F_s^2 + \\tan^2 x\n$$\nUsing the identity $\\sec^2 x = 1 + \\tan^2 x$:\n$$\nF_s^2 (1 + \\tan^2 x) > F_s^2 + \\tan^2 x\n$$\n$$\nF_s^2 + F_s^2 \\tan^2 x > F_s^2 + \\tan^2 x\n$$\n$$\n(F_s^2 - 1) \\tan^2 x > 0\n$$\nSince $F_s > 1$, $F_s^2 - 1 > 0$. For $x \\in (0, \\pi/2)$, $\\tan^2 x > 0$. Thus, the inequality holds. Because $f(0) = g(0)$ and $f'(x) > g'(x)$ for $x > 0$, it follows from the Mean Value Theorem that $f(x) > g(x)$ for all $x > 0$. Substituting $x = \\phi'$, we have definitively shown that:\n$$\n\\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right) > \\frac{\\phi'}{F_s}\n$$\nThis inequality confirms that the standard SSR scaling method is less conservative (i.e., results in a higher reduced friction angle) than a direct scaling of the angle $\\phi'$ itself. The deviation from linearity, $\\phi_r - \\phi'/F_s$, increases as $\\phi'$ moves from the small-angle regime to the moderate-to-large angle regime. This non-linear behavior is an intrinsic property of the Mohr–Coulomb criterion and the standard SSR scaling procedure.", "answer": "$$\\boxed{\\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right)}$$", "id": "3560645"}, {"introduction": "The core of any automated SRM analysis is the numerical search for the critical strength reduction factor, the precise point at which the slope model reaches the brink of failure. This practice challenges you to implement a robust search algorithm, combining adaptive stepping with a bracketing and bisection method to efficiently pinpoint this critical factor. Mastering this computational logic provides a transparent view into the engine of geotechnical software and builds skills essential for developing or validating numerical tools [@problem_id:3560694].", "problem": "Design and implement a complete, runnable program that computes, for each of several prescribed slope configurations, the critical strength reduction factor $F_s^\\star$ that triggers failure in a Strength Reduction Method (SRM) analysis with adaptive step-size control and rigorous bracketing of the collapse multiplier. The analysis must be grounded in the following fundamental base.\n\nFundamental base:\n- Equilibrium of forces requires that internal mobilized shear traction balances external driving shear demand.\n- The Mohr–Coulomb shear strength in effective stress terms is $ \\tau_\\mathrm{s} = c' + \\sigma_n' \\tan \\phi'$, where $c'$ is the effective cohesion and $\\phi'$ is the effective internal friction angle.\n- In the strength reduction approach, strength parameters are reduced by the factor of safety $F_s$, i.e., $c'_r = c'/F_s$ and $\\tan \\phi'_r = \\tan \\phi'/F_s$.\n- For a dry infinite slope at depth $z$, the driving shear stress and normal stress on a plane parallel to the slope surface are, respectively, $ \\tau_\\mathrm{d}(z) = \\gamma z \\sin\\beta \\cos\\beta$ and $ \\sigma_n(z) = \\gamma z \\cos^2 \\beta$, where $\\gamma$ is the unit weight and $\\beta$ is the slope angle. Here, take $z = H$ (characteristic depth equal to slope height $H$). Angles must be provided in degrees and converted to radians for computation.\n- Failure is indicated when no solution of the nonlinear equilibrium can be found that satisfies admissibility with the reduced strength, i.e., when the mobilized shear traction required by equilibrium exceeds the reduced strength.\n\nYou must formulate the computational problem in purely mathematical terms as follows.\n\n1) Nonlinear equilibrium problem per trial $F_s$:\n- Introduce a scalar slip displacement $w \\ge 0$ at a representative interface with elastic stiffness $k_t$ (per unit area) obeying an elastoplastic law with a Mohr–Coulomb cap:\n  - Elastic trial traction: $t_\\mathrm{trial} = k_t w$.\n  - Yield strength with reduction: $t_\\mathrm{y}(F_s) = c'/F_s + \\sigma_n \\tan\\phi'/F_s$.\n  - Admissible traction: $t(w;F_s) = \\min\\{t_\\mathrm{trial}, t_\\mathrm{y}(F_s)\\}$.\n- The equilibrium residual is $r(w;F_s) = t(w;F_s) - \\tau_\\mathrm{d}$, where $\\tau_\\mathrm{d} = \\gamma H \\sin\\beta \\cos\\beta$ and $\\sigma_n = \\gamma H \\cos^2 \\beta$.\n- For a given $F_s$, solve the nonlinear equation $r(w;F_s)=0$ for $w \\ge 0$. Declare “failure” for that $F_s$ if no $w$ satisfies $r(w;F_s)=0$ (i.e., if $\\tau_\\mathrm{d} > t_\\mathrm{y}(F_s)$). Angles must be interpreted in radians during computation. Stresses must be computed consistently in $\\mathrm{kPa}$, with $\\gamma$ in $\\mathrm{kN/m^3}$ and $H$ in $\\mathrm{m}$, so that $\\gamma H$ yields $\\mathrm{kPa}$.\n\n2) Outer algorithm: adaptive step-size control and bracketing of $F_s^\\star$:\n- Start from $F_s = 1$.\n- Increase $F_s$ iteratively with an adaptive step size $\\Delta F_s$ based on the signed stability margin $g(F_s) = t_\\mathrm{y}(F_s) - \\tau_\\mathrm{d}$:\n  - If $g(F_s) \\ge 0$, the system is stable at this $F_s$; increase $F_s$ by a positive step. Make $\\Delta F_s$ larger when $g(F_s)$ is strongly positive and smaller when $g(F_s)$ is near zero, subject to lower and upper bounds for numerical robustness.\n  - If $g(F_s) &lt; 0$, the system is unstable at this $F_s$; you have bracketed the collapse multiplier. Record the last stable $F_s$ as the lower bound and the current unstable $F_s$ as the upper bound.\n- If the initial configuration at $F_s = 1$ is already unstable, adaptively reduce $F_s$ (e.g., by halving) until stability is achieved to obtain a lower bound, thereby bracketing $F_s^\\star$ from below.\n- Once a bracket $[F_s^\\mathrm{L}, F_s^\\mathrm{U}]$ is identified with $g(F_s^\\mathrm{L}) \\ge 0$ and $g(F_s^\\mathrm{U}) &lt; 0$, refine $F_s^\\star$ by bisection on $g(F_s)$ until a tolerance criterion is satisfied. Use a convergence tolerance of $10^{-8}$ on $F_s$.\n- The final reported $F_s^\\star$ is the smallest $F_s$ such that the nonlinear equilibrium fails (collapse multiplier for strength reduction), i.e., the root of $g(F_s) = 0$ found by bracketing and bisection.\n\n3) Numerical requirements:\n- All angles in the input are in degrees and must be converted to radians for computation.\n- Use $k_t = 10^3\\,\\mathrm{kPa}$ as the interface elastic stiffness per unit area. This parameter ensures a well-defined elastic predictor in the equilibrium solver; the final $F_s^\\star$ must not depend on $k_t$ because the failure indicator is governed by admissibility.\n- Implement robust adaptive step size control with safeguards: enforce $\\Delta F_s \\in [10^{-2}, 2]$ and a maximum of $10^4$ outer iterations to guarantee termination.\n\nTest suite:\nProvide $F_s^\\star$ for the following four cases. Use $H$ in $\\mathrm{m}$, $\\gamma$ in $\\mathrm{kN/m^3}$, $c'$ in $\\mathrm{kPa}$, and angles in degrees. Report the final answers as dimensionless floats. The program must compute all four, in order, and print the final results on a single line as a comma-separated list enclosed in square brackets, with each value rounded to exactly six digits after the decimal point.\n\n- Case A (general stable case):\n  - $\\gamma = 20\\,\\mathrm{kN/m^3}$,\n  - $H = 10\\,\\mathrm{m}$,\n  - $\\beta = 30^\\circ$,\n  - $c' = 5\\,\\mathrm{kPa}$,\n  - $\\phi' = 30^\\circ$.\n- Case B (initially unstable at $F_s=1$):\n  - $\\gamma = 18\\,\\mathrm{kN/m^3}$,\n  - $H = 12\\,\\mathrm{m}$,\n  - $\\beta = 35^\\circ$,\n  - $c' = 0\\,\\mathrm{kPa}$,\n  - $\\phi' = 28^\\circ$.\n- Case C (stable with larger collapse multiplier):\n  - $\\gamma = 18\\,\\mathrm{kN/m^3}$,\n  - $H = 5\\,\\mathrm{m}$,\n  - $\\beta = 25^\\circ$,\n  - $c' = 2\\,\\mathrm{kPa}$,\n  - $\\phi' = 35^\\circ$.\n- Case D (boundary case):\n  - $\\gamma = 21\\,\\mathrm{kN/m^3}$,\n  - $H = 8\\,\\mathrm{m}$,\n  - $\\beta = 26^\\circ$,\n  - $c' = 0\\,\\mathrm{kPa}$,\n  - $\\phi' = 26^\\circ$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4]$), with each $x_i$ rounded to exactly six digits after the decimal point. Each output entry is the computed $F_s^\\star$ for the corresponding case, and it is dimensionless. No other text must be printed.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of soil mechanics, well-posed, and provides a complete and consistent set of requirements for a numerical solution. The problem asks for the design and implementation of an algorithm to find the critical strength reduction factor, $F_s^\\star$, for several infinite slope configurations. Although the problem can be solved analytically, the core task is to implement the specified numerical scheme involving an adaptive search and bisection, which is a common and practical task in computational engineering.\n\nThe solution proceeds as follows: First, the governing physical and mathematical equations are established. Second, the specified numerical algorithm for locating the critical factor of safety is detailed. Finally, this algorithm is implemented in a Python program to solve the given test cases.\n\n**1. Theoretical Formulation**\n\nThe stability of an infinite, dry, cohesionless-frictional slope is analyzed. The fundamental inputs are the soil's unit weight $\\gamma$, the slope height $H$ (at which stresses are evaluated), the slope angle $\\beta$, the effective cohesion $c'$, and the effective angle of internal friction $\\phi'$.\n\nFor a point at depth $H$ on a potential failure plane parallel to the slope surface, the driving shear stress $\\tau_\\mathrm{d}$ and the normal stress $\\sigma_n$ are given by:\n$$\n\\tau_\\mathrm{d} = \\gamma H \\sin\\beta \\cos\\beta\n$$\n$$\n\\sigma_n = \\gamma H \\cos^2\\beta\n$$\nThe problem specifies a dry slope, so effective normal stress $\\sigma_n'$ is equal to the total normal stress $\\sigma_n$. The available shear strength of the soil is described by the Mohr-Coulomb failure criterion:\n$$\n\\tau_s = c' + \\sigma_n \\tan\\phi'\n$$\nThe Strength Reduction Method (SRM) involves finding a factor of safety, $F_s$, by which the strength parameters must be divided to bring the slope to a state of limit equilibrium. The reduced strength parameters, $c'_r$ and $\\phi'_r$, are:\n$$\nc'_r = \\frac{c'}{F_s}\n$$\n$$\n\\tan\\phi'_r = \\frac{\\tan\\phi'}{F_s}\n$$\nThe reduced shear strength, denoted as $t_y(F_s)$, is therefore:\n$$\nt_y(F_s) = \\frac{c'}{F_s} + \\sigma_n \\frac{\\tan\\phi'}{F_s} = \\frac{c' + \\sigma_n \\tan\\phi'}{F_s}\n$$\nThe problem introduces a fictitious elastoplastic interface model to formalize the equilibrium condition. However, the failure condition simplifies to the moment when the driving shear stress exceeds the available reduced strength. A state of equilibrium is possible only if $\\tau_\\mathrm{d} \\le t_y(F_s)$. The critical state, or failure, occurs at the smallest value of $F_s$, denoted $F_s^\\star$, for which equilibrium cannot be maintained. This corresponds to the limit equilibrium condition $\\tau_\\mathrm{d} = t_y(F_s^\\star)$.\n\nTo facilitate a numerical search, we define a stability margin function, $g(F_s)$:\n$$\ng(F_s) = t_y(F_s) - \\tau_\\mathrm{d} = \\frac{c' + \\sigma_n \\tan\\phi'}{F_s} - \\tau_\\mathrm{d}\n$$\n- If $g(F_s) > 0$, the slope is stable for the given $F_s$.\n- If $g(F_s) < 0$, the slope is unstable for the given $F_s$.\n- If $g(F_s) = 0$, the slope is at the limit of equilibrium.\n\nThe problem is thus reduced to finding the root of the equation $g(F_s) = 0$. Solving for $F_s$ gives the analytical solution for the factor of safety:\n$$\nF_s^\\star = \\frac{c' + \\sigma_n \\tan\\phi'}{\\tau_\\mathrm{d}} = \\frac{c' + \\gamma H \\cos^2\\beta \\tan\\phi'}{\\gamma H \\sin\\beta \\cos\\beta} = \\frac{c'}{\\gamma H \\sin\\beta \\cos\\beta} + \\frac{\\tan\\phi'}{\\tan\\beta}\n$$\nWhile this analytical formula exists and can be used for verification, the problem requires implementing a specific numerical algorithm to find $F_s^\\star$.\n\n**2. Algorithmic Design**\n\nThe core of the task is to implement a root-finding algorithm for $g(F_s)=0$ that follows the prescribed three-phase process: adaptive bracketing search, bisection refinement, and final reporting. All angles must be converted from degrees to radians for trigonometric calculations.\n\n**Phase 1: Bracketing Search**\nThe goal is to find a lower bound $F_s^\\mathrm{L}$ and an upper bound $F_s^\\mathrm{U}$ such that $g(F_s^\\mathrm{L}) \\ge 0$ and $g(F_s^\\mathrm{U}) < 0$. The search starts at $F_s=1$.\n\n- **Case 1: Initially Stable Slope ($g(1) \\ge 0$)**\n  The initial value $F_s=1$ serves as the lower bound, $F_s^\\mathrm{L} = 1$. We must search for an upper bound by iteratively increasing $F_s$.\n  An adaptive step-size rule is employed. The step $\\Delta F_s$ should decrease as $g(F_s)$ approaches zero. A suitable rule, based on the normalized stability margin, is:\n  $$\n  \\Delta F_s = \\alpha \\cdot F_s \\cdot \\frac{g(F_s)}{\\tau_\\mathrm{d}}\n  $$\n  where $\\alpha$ is a damping factor (e.g., $\\alpha=0.5$). To ensure robustness and progress, this step is clipped to a prescribed range $[\\Delta F_{s, \\min}, \\Delta F_{s, \\max}]$, which are given as $[10^{-2}, 2]$. The iteration proceeds as $F_{s, i+1} = F_{s, i} + \\Delta F_s$ until $g(F_{s, i+1}) < 0$. At this point, $F_s^\\mathrm{U} = F_{s, i+1}$ and the bracket is established.\n\n- **Case 2: Initially Unstable Slope ($g(1) < 0$)**\n  The initial value $F_s=1$ serves as the upper bound, $F_s^\\mathrm{U} = 1$. We must search for a lower bound by iteratively decreasing $F_s$. As suggested, a simple and robust method is to repeatedly halve $F_s$, i.e., $F_{s, i+1} = F_{s, i} / 2$, until $g(F_{s, i+1}) \\ge 0$. At this point, $F_s^\\mathrm{L} = F_{s, i+1}$ and the bracket is established.\n\nA maximum number of iterations ($10^4$) is used as a safeguard against an infinite loop in this phase.\n\n**Phase 2: Bisection Refinement**\nOnce the bracket $[F_s^\\mathrm{L}, F_s^\\mathrm{U}]$ is found, the bisection method is applied to refine the root $F_s^\\star$ with high precision. The algorithm is as follows:\n1. Calculate the midpoint: $F_s^\\mathrm{mid} = (F_s^\\mathrm{L} + F_s^\\mathrm{U}) / 2$.\n2. Evaluate the stability margin at the midpoint, $g(F_s^\\mathrm{mid})$.\n3. Update the bracket:\n   - If $g(F_s^\\mathrm{mid}) \\ge 0$, the root is in the upper half, so set $F_s^\\mathrm{L} = F_s^\\mathrm{mid}$.\n   - If $g(F_s^\\mathrm{mid})< 0$, the root is in the lower half, so set $F_s^\\mathrm{U} = F_s^\\mathrm{mid}$.\n4. Repeat steps 1-3 until the width of the bracket, $(F_s^\\mathrm{U} - F_s^\\mathrm{L})$, is smaller than the specified tolerance of $10^{-8}$.\n\n**Phase 3: Final Result**\nThe final estimate for the critical factor of safety, $F_s^\\star$, is taken as the midpoint of the final bracket, $(F_s^\\mathrm{L} + F_s^\\mathrm{U}) / 2$. This value is then formatted as required for output.\n\nThis comprehensive algorithm ensures a robust and accurate determination of $F_s^\\star$ according to the problem's specifications.", "answer": "```python\nimport numpy as np\n\ndef compute_fs_star(gamma, H, beta_deg, c_prime, phi_prime_deg):\n    \"\"\"\n    Computes the critical strength reduction factor (Fs_star) for an infinite slope.\n\n    The function implements a numerical scheme involving an adaptive search to\n    bracket the solution, followed by bisection to refine it to a high tolerance.\n\n    Args:\n        gamma (float): Unit weight of the soil (kN/m^3).\n        H (float): Characteristic depth/height (m).\n        beta_deg (float): Slope angle (degrees).\n        c_prime (float): Effective cohesion (kPa).\n        phi_prime_deg (float): Effective internal friction angle (degrees).\n\n    Returns:\n        float: The computed critical strength reduction factor, Fs_star.\n    \"\"\"\n    # Numerical parameters and tolerances from the problem statement\n    TOL = 1e-8\n    MAX_ITER_OUTER = 10000\n    MIN_DFs = 0.01\n    MAX_DFs = 2.0\n    # k_t is not needed for the simplified failure condition g(Fs)=0\n\n    # Convert angles from degrees to radians for computation\n    beta_rad = np.deg2rad(beta_deg)\n    phi_rad = np.deg2rad(phi_prime_deg)\n\n    # Calculate driving shear stress (tau_d) and normal stress (sigma_n)\n    tau_d = gamma * H * np.sin(beta_rad) * np.cos(beta_rad)\n    sigma_n = gamma * H * np.cos(beta_rad)**2\n    \n    # Handle the edge case where tau_d is zero or negative (e.g., beta >= 90 deg)\n    # The analytical Fs would be infinite. The numerical search might fail.\n    # For this problem's context, tau_d will be positive.\n    if tau_d <= 0:\n        return np.inf # Practically stable for any Fs\n\n    # Define the stability margin function g(Fs)\n    # g(Fs) = t_y(Fs) - tau_d\n    strength_term = c_prime + sigma_n * np.tan(phi_rad)\n    \n    # If the strength term is zero or negative, the slope is unconditionally unstable\n    if strength_term <= 0:\n        return 0.0\n        \n    g = lambda Fs: strength_term / Fs - tau_d\n\n    # --- Phase 1: Bracketing Search ---\n    fs_lower = None\n    fs_upper = None\n    \n    fs_current = 1.0\n    margin = g(fs_current)\n\n    if margin >= 0:  # Initially stable case (g(1) >= 0)\n        fs_lower = fs_current\n        # Search for an upper bound by increasing Fs\n        for _ in range(MAX_ITER_OUTER):\n            # Adaptive step size calculation\n            # Proportional to the normalized margin, damped by a factor 0.5\n            # This makes the step larger when far from failure, smaller when close\n            if tau_d > 0:\n                delta_fs_calc = 0.5 * fs_current * (g(fs_current) / tau_d)\n            else: # Should not happen with valid inputs\n                delta_fs_calc = MIN_DFs\n            \n            delta_fs = np.clip(delta_fs_calc, MIN_DFs, MAX_DFs)\n            \n            fs_next = fs_current + delta_fs\n            margin_next = g(fs_next)\n\n            if margin_next < 0:\n                fs_upper = fs_next\n                break\n            else:\n                fs_current = fs_next\n        else: # Loop finished without finding an upper bound\n            raise RuntimeError(\"Bracketing failed: could not find an upper bound.\")\n\n    else:  # Initially unstable case (g(1) < 0)\n        fs_upper = fs_current\n        # Search for a lower bound by decreasing Fs (halving)\n        for _ in range(MAX_ITER_OUTER):\n            fs_next = fs_current / 2.0\n            margin_next = g(fs_next)\n            \n            if margin_next >= 0:\n                fs_lower = fs_next\n                break\n            else:\n                fs_current = fs_next\n        else: # Loop finished without finding a lower bound\n             raise RuntimeError(\"Bracketing failed: could not find a lower bound.\")\n\n    if fs_lower is None or fs_upper is None:\n        raise RuntimeError(\"Bracketing failed unexpectedly.\")\n\n    # --- Phase 2: Bisection Refinement ---\n    while (fs_upper - fs_lower) > TOL:\n        fs_mid = (fs_lower + fs_upper) / 2.0\n        if fs_mid == fs_lower or fs_mid == fs_upper: # Reached precision limit\n            break\n        \n        margin_mid = g(fs_mid)\n\n        if margin_mid >= 0:\n            fs_lower = fs_mid\n        else:\n            fs_upper = fs_mid\n            \n    # --- Phase 3: Final Result ---\n    fs_star = (fs_lower + fs_upper) / 2.0\n    return fs_star\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test cases as defined in the problem statement\n    test_cases = [\n        # Case A (general stable case)\n        {'gamma': 20.0, 'H': 10.0, 'beta_deg': 30.0, 'c_prime': 5.0, 'phi_prime_deg': 30.0},\n        # Case B (initially unstable at Fs=1)\n        {'gamma': 18.0, 'H': 12.0, 'beta_deg': 35.0, 'c_prime': 0.0, 'phi_prime_deg': 28.0},\n        # Case C (stable with larger collapse multiplier)\n        {'gamma': 18.0, 'H': 5.0, 'beta_deg': 25.0, 'c_prime': 2.0, 'phi_prime_deg': 35.0},\n        # Case D (boundary case)\n        {'gamma': 21.0, 'H': 8.0, 'beta_deg': 26.0, 'c_prime': 0.0, 'phi_prime_deg': 26.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        fs_star = compute_fs_star(**case)\n        results.append(fs_star)\n\n    # Format the final output according to the specified format\n    # Comma-separated list, in brackets, with each value rounded to 6 decimal places.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```", "id": "3560694"}, {"introduction": "A key advantage of the Strength Reduction Method is its versatility in handling various loading scenarios beyond simple gravity. This practice extends the framework to assess slope stability under seismic conditions using the pseudo-static approach, where inertial forces from an earthquake are incorporated as additional loads. By solving for the critical strength reduction factor, $\\lambda_{\\mathrm{crit}}$, under these combined static and dynamic effects, you will learn a standard procedure for quantifying the impact of seismicity on slope safety [@problem_id:3560705].", "problem": "A soil slope is analyzed using the Mohr-Coulomb failure criterion and the strength reduction method under earthquake-induced inertial loads represented by pseudo-static acceleration coefficients. The objective is to couple horizontal and vertical pseudo-static coefficients, denoted by $k_h$ and $k_v$ respectively, as load multipliers while reducing the shear strength by a Strength Reduction Factor (SRF), denoted by $\\lambda$, and to map failure to a surface $F(\\lambda,k_h,k_v)=0$. The slope is modeled as an infinite slope with a failure plane parallel to the ground surface at depth $z$, so that closed-form stress projections onto the plane are admissible.\n\nStart from first principles: (i) equilibrium of body forces under gravity and pseudo-static inertial forces, and (ii) the Mohr-Coulomb failure criterion. The Mohr-Coulomb shear strength is $ \\tau_f = c' + \\sigma_n' \\tan(\\phi') $, where $c'$ is cohesion, $\\phi'$ is the friction angle, and $\\sigma_n'$ is the total normal stress (assuming dry conditions and ignoring pore pressure). In the strength reduction method, the reduced parameters are $c' = c / \\lambda$ and $\\tan(\\phi') = \\tan(\\phi) / \\lambda$.\n\nFor an infinite slope of inclination angle $\\beta$ relative to the horizontal, of unit thickness and unit width, and with soil unit weight $\\gamma$, the gravitational components on the failure plane yield static tangential shear stress $ \\tau_0 = \\gamma z \\sin(\\beta) \\cos(\\beta) $ and normal stress $ \\sigma_{n0} = \\gamma z \\cos^2(\\beta) $. When pseudo-static inertial loads are applied, the equivalent horizontal inertial body force of magnitude $k_h \\gamma z$ acts downslope and the vertical inertial body force of magnitude $k_v \\gamma z$ acts upward. Resolve these body forces onto the plane tangent and normal directions to obtain the total tangential and normal stresses on the plane:\n$$\n\\tau(\\beta,k_h,k_v) = \\gamma z \\left[\\sin(\\beta)\\cos(\\beta) + k_h \\cos^2(\\beta) - k_v \\sin(\\beta)\\cos(\\beta)\\right],\n$$\n$$\n\\sigma_n(\\beta,k_h,k_v) = \\gamma z \\left[\\cos^2(\\beta) + k_h \\sin(\\beta)\\cos(\\beta) - k_v \\cos^2(\\beta)\\right].\n$$\nUnder strength reduction, failure occurs when the reduced shear strength equals the applied shear stress on the plane:\n$$\n\\tau(\\beta,k_h,k_v) = \\frac{c}{\\lambda} + \\frac{\\sigma_n(\\beta,k_h,k_v)\\tan(\\phi)}{\\lambda}.\n$$\nDefine the failure surface by\n$$\nF(\\lambda,k_h,k_v) = \\lambda - \\frac{c + \\sigma_n(\\beta,k_h,k_v)\\tan(\\phi)}{\\tau(\\beta,k_h,k_v)} = 0,\n$$\nso that the critical Strength Reduction Factor is\n$$\n\\lambda_{\\mathrm{crit}}(k_h,k_v) = \\frac{c + \\sigma_n(\\beta,k_h,k_v)\\tan(\\phi)}{\\tau(\\beta,k_h,k_v)}.\n$$\nAll angles must be provided in degrees but converted to radians for trigonometric evaluation. All stresses must be computed in kilopascals, achieved by taking the unit weight $ \\gamma $ in $\\mathrm{kN/m^3}$ and the depth $ z $ in $\\mathrm{m}$ so that $ \\gamma z $ has units $\\mathrm{kN/m^2} = \\mathrm{kPa}$. The cohesion $ c $ must be provided in $\\mathrm{kPa}$. The final outputs, $\\lambda_{\\mathrm{crit}}(k_h,k_v)$, are dimensionless.\n\nImplement a program that, for a given set of parameters $(\\gamma,z,\\beta,c,\\phi,k_h,k_v)$, computes $ \\lambda_{\\mathrm{crit}}(k_h,k_v) $ using the equations above. Use degrees for $ \\beta $ and $ \\phi $ in the input and convert to radians internally. The program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each float rounded to six decimal places.\n\nTest Suite:\n- Case $1$: $ \\gamma=18\\,\\mathrm{kN/m^3} $, $ z=10\\,\\mathrm{m} $, $ \\beta=30^\\circ $, $ c=5\\,\\mathrm{kPa} $, $ \\phi=35^\\circ $, $ k_h=0.0 $, $ k_v=0.0 $.\n- Case $2$: $ \\gamma=18\\,\\mathrm{kN/m^3} $, $ z=10\\,\\mathrm{m} $, $ \\beta=30^\\circ $, $ c=5\\,\\mathrm{kPa} $, $ \\phi=35^\\circ $, $ k_h=0.2 $, $ k_v=0.0 $.\n- Case $3$: $ \\gamma=18\\,\\mathrm{kN/m^3} $, $ z=10\\,\\mathrm{m} $, $ \\beta=30^\\circ $, $ c=5\\,\\mathrm{kPa} $, $ \\phi=35^\\circ $, $ k_h=0.3 $, $ k_v=0.1 $.\n- Case $4$: $ \\gamma=18\\,\\mathrm{kN/m^3} $, $ z=10\\,\\mathrm{m} $, $ \\beta=30^\\circ $, $ c=5\\,\\mathrm{kPa} $, $ \\phi=35^\\circ $, $ k_h=0.25 $, $ k_v=-0.2 $.\n- Case $5$: $ \\gamma=20\\,\\mathrm{kN/m^3} $, $ z=8\\,\\mathrm{m} $, $ \\beta=40^\\circ $, $ c=0\\,\\mathrm{kPa} $, $ \\phi=28^\\circ $, $ k_h=0.15 $, $ k_v=0.0 $.\n- Case $6$: $ \\gamma=18\\,\\mathrm{kN/m^3} $, $ z=5\\,\\mathrm{m} $, $ \\beta=10^\\circ $, $ c=3\\,\\mathrm{kPa} $, $ \\phi=30^\\circ $, $ k_h=0.4 $, $ k_v=0.3 $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\lambda_1,\\lambda_2,\\dots]$), where each $ \\lambda_i $ is rounded to six decimal places.", "solution": "The problem requires the computation of the critical Strength Reduction Factor, $\\lambda_{\\mathrm{crit}}$, for an infinite slope subjected to gravitational and pseudo-static inertial loads. This factor represents the scalar multiplier by which the soil's shear strength parameters, cohesion $c$ and friction angle $\\phi$, must be reduced to bring the slope to a state of limit equilibrium. The analysis is based on the Mohr-Coulomb failure criterion.\n\nThe problem provides the definitive equation for the critical Strength Reduction Factor, derived from the limit equilibrium condition where the mobilized shear stress equals the reduced shear strength:\n$$\n\\lambda_{\\mathrm{crit}}(k_h, k_v) = \\frac{c + \\sigma_n(\\beta, k_h, k_v) \\tan(\\phi)}{\\tau(\\beta, k_h, k_v)}\n$$\nTo evaluate $\\lambda_{\\mathrm{crit}}$, we must first compute the total normal stress, $\\sigma_n$, and the total tangential shear stress, $\\tau$, acting on the potential failure plane. The failure plane is assumed to be parallel to the slope surface at a depth $z$.\n\nThe input parameters are the soil unit weight $\\gamma$ (in $\\mathrm{kN/m^3}$), the failure plane depth $z$ (in $\\mathrm{m}$), the slope angle $\\beta$ (in degrees), the soil cohesion $c$ (in $\\mathrm{kPa}$), the soil friction angle $\\phi$ (in degrees), and the horizontal and vertical pseudo-static acceleration coefficients, $k_h$ and $k_v$ (dimensionless), respectively.\n\nThe procedural steps for the calculation are as follows:\n\n1.  **Angle Conversion**: The input angles $\\beta$ and $\\phi$ are given in degrees. For use in trigonometric functions, they must be converted to radians.\n    $$\n    \\beta_{\\mathrm{rad}} = \\beta_{\\mathrm{deg}} \\cdot \\frac{\\pi}{180}\n    $$\n    $$\n    \\phi_{\\mathrm{rad}} = \\phi_{\\mathrm{deg}} \\cdot \\frac{\\pi}{180}\n    $$\n\n2.  **Stress Calculation**: The total tangential shear stress $\\tau$ and total normal stress $\\sigma_n$ on the failure plane are calculated using the provided equations. These equations account for the components of the soil weight and the inertial forces due to horizontal and vertical accelerations.\n    The total tangential shear stress, which drives the failure, is given by:\n    $$\n    \\tau(\\beta, k_h, k_v) = \\gamma z \\left[\\sin(\\beta_{\\mathrm{rad}})\\cos(\\beta_{\\mathrm{rad}}) + k_h \\cos^2(\\beta_{\\mathrm{rad}}) - k_v \\sin(\\beta_{\\mathrm{rad}})\\cos(\\beta_{\\mathrm{rad}})\\right]\n    $$\n    This expression can be factored for computational efficiency:\n    $$\n    \\tau(\\beta, k_h, k_v) = \\gamma z \\cos(\\beta_{\\mathrm{rad}}) \\left[(1-k_v)\\sin(\\beta_{\\mathrm{rad}}) + k_h\\cos(\\beta_{\\mathrm{rad}})\\right]\n    $$\n    The total normal stress, which contributes to the frictional resistance, is given by:\n    $$\n    \\sigma_n(\\beta, k_h, k_v) = \\gamma z \\left[\\cos^2(\\beta_{\\mathrm{rad}}) + k_h \\sin(\\beta_{\\mathrm{rad}})\\cos(\\beta_{\\mathrm{rad}}) - k_v \\cos^2(\\beta_{\\mathrm{rad}})\\right]\n    $$\n    Similarly, this can be factored:\n    $$\n    \\sigma_n(\\beta, k_h, k_v) = \\gamma z \\cos(\\beta_{\\mathrm{rad}}) \\left[(1-k_v)\\cos(\\beta_{\\mathrm{rad}}) + k_h\\sin(\\beta_{\\mathrm{rad}})\\right]\n    $$\n    A positive $k_v$ corresponds to an upward inertial force, which reduces both the normal stress and the gravitational component of the shear stress. A negative $k_v$ (downward inertial force) would increase them.\n\n3.  **Strength Reduction Factor Calculation**: With $\\tau$ and $\\sigma_n$ determined, the critical Strength Reduction Factor $\\lambda_{\\mathrm{crit}}$ is calculated by substituting these values, along with the unreduced strength parameters $c$ and $\\tan(\\phi_{\\mathrm{rad}})$, into the main formula. The numerator $c + \\sigma_n \\tan(\\phi)$ represents the total available shear strength on the plane, while the denominator $\\tau$ represents the total driving shear stress. Their ratio defines the factor of safety, which in this formulation is equivalent to $\\lambda_{\\mathrm{crit}}$ at failure.\n\nThe implementation will process a series of test cases, applying these steps for each given set of parameters. The final results are formatted as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the critical Strength Reduction Factor (SRF) for an infinite slope\n    under pseudo-static seismic loading for a set of test cases.\n    \"\"\"\n\n    # Test Suite: (gamma, z, beta_deg, c, phi_deg, k_h, k_v)\n    # gamma: unit weight (kN/m^3)\n    # z: depth (m)\n    # beta_deg: slope angle (degrees)\n    # c: cohesion (kPa)\n    # phi_deg: friction angle (degrees)\n    # k_h: horizontal pseudo-static coefficient\n    # k_v: vertical pseudo-static coefficient\n    test_cases = [\n        (18.0, 10.0, 30.0, 5.0, 35.0, 0.0, 0.0),\n        (18.0, 10.0, 30.0, 5.0, 35.0, 0.2, 0.0),\n        (18.0, 10.0, 30.0, 5.0, 35.0, 0.3, 0.1),\n        (18.0, 10.0, 30.0, 5.0, 35.0, 0.25, -0.2),\n        (20.0, 8.0, 40.0, 0.0, 28.0, 0.15, 0.0),\n        (18.0, 5.0, 10.0, 3.0, 30.0, 0.4, 0.3)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        gamma, z, beta_deg, c, phi_deg, k_h, k_v = case\n\n        # Convert angles from degrees to radians\n        beta_rad = np.deg2rad(beta_deg)\n        phi_rad = np.deg2rad(phi_deg)\n\n        # Pre-calculate trigonometric values for efficiency\n        sin_beta = np.sin(beta_rad)\n        cos_beta = np.cos(beta_rad)\n        cos2_beta = cos_beta**2\n        sin_beta_cos_beta = sin_beta * cos_beta\n        tan_phi = np.tan(phi_rad)\n        \n        # Calculate gamma * z\n        gamma_z = gamma * z\n\n        # Calculate total tangential shear stress (tau)\n        tau = gamma_z * (sin_beta_cos_beta + k_h * cos2_beta - k_v * sin_beta_cos_beta)\n\n        # Calculate total normal stress (sigma_n)\n        sigma_n = gamma_z * (cos2_beta + k_h * sin_beta_cos_beta - k_v * cos2_beta)\n        \n        # Guard against non-physical conditions where shear stress is non-positive\n        # or normal stress becomes tensile (negative), although test cases are valid.\n        if tau <= 0:\n            # Physically, this implies infinite stability for downslope failure.\n            # Lambda would be infinite or undefined.\n            # This case is not expected based on the problem's test suite.\n            lambda_crit = float('inf') \n        elif sigma_n < 0:\n            # If normal stress is tensile, the Mohr-Coulomb model is often\n            # considered invalid as it doesn't account for tension cracks.\n            # Assuming frictional resistance is zero if sigma_n is negative.\n            lambda_crit = c / tau\n        else:\n            # Calculate the critical Strength Reduction Factor (lambda_crit)\n            # lambda_crit = (Resisting Forces / Driving Forces)\n            resisting_strength = c + sigma_n * tan_phi\n            lambda_crit = resisting_strength / tau\n        \n        results.append(lambda_crit)\n\n    # Format output as a comma-separated list of strings, each rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3560705"}]}