{"hands_on_practices": [{"introduction": "The first step in using viscous boundaries in a numerical simulation is to translate the continuous physical law into discrete forces that can be applied at the nodes of a mesh. This practice guides you through the fundamental derivation of nodal dashpot forces for a standard Lysmer-Kuhlemeyer (LK) boundary. By starting from the principle of mechanical impedance and applying it to velocity components, you will develop a concrete algorithm for calculating these forces, a cornerstone for implementing absorbing boundaries in methods like the Finite Element Method. [@problem_id:3570002]", "problem": "Consider a linear elastic, homogeneous, isotropic half-space truncated by an artificial boundary where non-reflecting dashpots are applied according to the Lysmer-Kuhlemeyer viscous boundary model. Let $\\rho$ denote the mass density, $c_p$ the compressional wave speed, and $c_s$ the shear wave speed. For small-strain linear elasticity and one-way traveling waves, the impedance relations equate boundary tractions to particle velocities along the outward unit normal and tangential directions. A quadrilateral boundary element with nodal tributary areas distributes these tractions to nodal forces without coupling between nodes. Assume a three-dimensional setting with nodal outward normal vectors and nodal velocity vectors available at each time step from a computational scheme such as the Finite Element Method (FEM).\n\nYour task is to derive, from fundamental principles, the expressions needed to compute the nodal dashpot force vectors at each node of a quadrilateral boundary element and then implement a program that carries out these computations for a specified test suite. The derivation must start from the principle that a traction is the force per unit area acting on a surface and that, for a plane wave normally incident on a boundary of a linear elastic half-space, the traction is proportional to velocity via mechanical impedance. You must use only the following fundamental bases:\n\n- Newton’s second law stating that force equals mass times acceleration, and the definition that traction is force per unit area.\n- The well-tested impedance concept for one-dimensional wave propagation in an elastic medium, with mechanical impedance defined as the ratio of traction to particle velocity for planar waves.\n\nFrom this base, obtain the expressions for the normal and tangential traction components based on velocity projections, then assemble nodal forces using nodal tributary areas. Do not invoke any additional shortcut formulas not grounded in these bases.\n\nImplementation requirements:\n\n- For each node $i$ with outward normal vector $\\mathbf{n}_i$ (not necessarily of unit length) and velocity vector $\\mathbf{v}_i$, compute the unit normal $\\hat{\\mathbf{n}}_i$ by normalizing $\\mathbf{n}_i$. Compute the scalar normal velocity $v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i$, the normal velocity vector $\\mathbf{v}_{n,i} = v_{n,i}\\,\\hat{\\mathbf{n}}_i$, and the tangential velocity vector $\\mathbf{v}_{t,i} = \\mathbf{v}_i - \\mathbf{v}_{n,i}$.\n- From the impedance relations, obtain the traction vector $\\mathbf{t}_i$ and assemble the nodal dashpot force $\\mathbf{f}_i$ using the nodal tributary area $A_i$.\n- If $\\|\\mathbf{n}_i\\|=0$, treat $\\hat{\\mathbf{n}}_i$ as undefined and set $\\mathbf{f}_i=\\mathbf{0}$ for that node, as the boundary orientation is ill-posed.\n\nUnits and formatting:\n\n- Express all forces in Newtons (N). Velocities must be in meters per second (m/s), density in kilograms per cubic meter (kg/m$^3$), areas in square meters (m$^2$), and wave speeds in meters per second (m/s).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces. Each test case result must be a list of four nodal force vectors, where each nodal force vector is a list of three floats $[f_{x},f_{y},f_{z}]$ rounded to six decimal places. For example, a single test case result would look like $[[f_{x,1},f_{y,1},f_{z,1}],[f_{x,2},f_{y,2},f_{z,2}],[f_{x,3},f_{y,3},f_{z,3}],[f_{x,4},f_{y,4},f_{z,4}]]$, and the overall output is $[$case1$,$case2$,$\\dots]$.\n\nTest suite specifications:\n\n- Case $1$ (general case, unit normals):\n  - $\\rho = 2000$ kg/m$^3$, $c_p = 3000$ m/s, $c_s = 1500$ m/s.\n  - $A_1=A_2=A_3=A_4=1.5$ m$^2$.\n  - $\\mathbf{n}_1=\\mathbf{n}_2=\\mathbf{n}_3=\\mathbf{n}_4=(0,0,1)$.\n  - $\\mathbf{v}_1=(0.2,0.0,-0.1)$ m/s, $\\mathbf{v}_2=(0.0,0.1,0.0)$ m/s, $\\mathbf{v}_3=(-0.1,-0.2,0.3)$ m/s, $\\mathbf{v}_4=(0.05,0.05,0.0)$ m/s.\n- Case $2$ (zero velocities, mixed normals and areas):\n  - $\\rho = 1800$ kg/m$^3$, $c_p = 2500$ m/s, $c_s = 1200$ m/s.\n  - $(A_1,A_2,A_3,A_4)=(0.8,1.2,1.0,0.9)$ m$^2$.\n  - $\\mathbf{n}_1=(1,0,0)$, $\\mathbf{n}_2=(0,1,0)$, $\\mathbf{n}_3=(0,0,1)$, $\\mathbf{n}_4=(1,1,0)$.\n  - $\\mathbf{v}_1=\\mathbf{v}_2=\\mathbf{v}_3=\\mathbf{v}_4=(0.0,0.0,0.0)$ m/s.\n- Case $3$ (non-unit normals, one zero area):\n  - $\\rho = 2200$ kg/m$^3$, $c_p = 3200$ m/s, $c_s = 1600$ m/s.\n  - $(A_1,A_2,A_3,A_4)=(2.0,1.0,0.0,3.2)$ m$^2$.\n  - $\\mathbf{n}_1=(0,0,2)$, $\\mathbf{n}_2=(0,-3,0)$, $\\mathbf{n}_3=(1,0,1)$, $\\mathbf{n}_4=(-1,0,0)$.\n  - $\\mathbf{v}_1=(0.3,-0.1,0.4)$ m/s, $\\mathbf{v}_2=(-0.2,0.6,-0.1)$ m/s, $\\mathbf{v}_3=(0.0,0.0,0.5)$ m/s, $\\mathbf{v}_4=(-1.0,0.0,0.0)$ m/s.\n- Case $4$ (high impedance, oblique normals):\n  - $\\rho = 2500$ kg/m$^3$, $c_p = 5000$ m/s, $c_s = 3000$ m/s.\n  - $A_1=A_2=A_3=A_4=0.1$ m$^2$.\n  - $\\mathbf{n}_1=(1,1,1)$, $\\mathbf{n}_2=(1,0,1)$, $\\mathbf{n}_3=(0,1,1)$, $\\mathbf{n}_4=(-1,1,0)$.\n  - $\\mathbf{v}_1=(2.0,-1.0,0.5)$ m/s, $\\mathbf{v}_2=(0.0,2.0,-2.0)$ m/s, $\\mathbf{v}_3=(-1.5,0.5,1.0)$ m/s, $\\mathbf{v}_4=(0.0,-0.5,0.5)$ m/s.\n\nYour program must compute the nodal dashpot forces $\\mathbf{f}_i$ for each test case, at a single instant corresponding to one time step, and produce the single required output line in the specified format. No user input is permitted; all parameters from the test suite must be defined within the program.", "solution": "The problem requires the derivation and implementation of the nodal dashpot forces for a Lysmer-Kuhlemeyer viscous boundary in a three-dimensional, linear elastic, homogeneous, isotropic medium. The derivation must be based on fundamental principles as specified.\n\nThe fundamental principles provided are:\n$1$. The definition of traction as force per unit area.\n$2$. The one-dimensional mechanical impedance concept, which relates traction to particle velocity for planar waves propagating in an elastic medium.\n\nLet's begin the derivation. A dashpot is a dissipative element; the force it exerts on a body is proportional to the body's velocity and acts in the opposite direction. For a nodal dashpot representing the far-field medium, the force $\\mathbf{f}_i$ exerted on a node $i$ of a computational mesh is designed to absorb energy that would otherwise reflect off the artificial boundary. This force is related to the traction $\\mathbf{t}_i$ at that node.\n\nTraction, by definition, is the limit of force per unit area, $\\mathbf{t} = d\\mathbf{F}/dA$. In a discretized numerical model such as the Finite Element Method, we consider a finite nodal tributary area $A_i$ associated with node $i$. The total force on this area is approximated by lumping it at the node. The dashpot force $\\mathbf{f}_i$ on node $i$ is therefore related to the traction $\\mathbf{t}_i$ that the dashpot must generate to simulate an infinite medium. This traction must oppose the local particle velocity $\\mathbf{v}_i$. The force exerted *by the dashpot on the node* is thus:\n$$ \\mathbf{f}_i = - A_i \\mathbf{t}_i $$\nHere, $\\mathbf{t}_i$ is the traction that would exist in the infinite medium due to the velocity $\\mathbf{v}_i$. Our task reduces to finding the expression for this traction vector $\\mathbf{t}_i$.\n\nThe Lysmer-Kuhlemeyer model approximates the outgoing wave field as a superposition of plane compressional (P) waves and plane shear (S) waves propagating normal to the boundary. For one-dimensional wave propagation, the ratio of traction to particle velocity is the mechanical impedance, $I$. For a P-wave, the impedance is $I_p = \\rho c_p$, and for an S-wave, it is $I_s = \\rho c_s$, where $\\rho$ is the mass density, $c_p$ is the P-wave speed, and $c_s$ is the S-wave speed.\n\nTo apply this one-dimensional concept to a general three-dimensional boundary, we resolve the particle velocity vector $\\mathbf{v}_i$ at node $i$ into components normal and tangential to the boundary surface. Let the outward unit normal vector at node $i$ be $\\hat{\\mathbf{n}}_i$. This is obtained by normalizing the given normal vector $\\mathbf{n}_i$:\n$$ \\hat{\\mathbf{n}}_i = \\frac{\\mathbf{n}_i}{\\|\\mathbf{n}_i\\|} \\quad \\text{for } \\|\\mathbf{n}_i\\| \\neq 0 $$\nIf $\\|\\mathbf{n}_i\\| = 0$, the normal is undefined, and the problem specifies that the force $\\mathbf{f}_i$ should be the zero vector, $\\mathbf{f}_i = \\mathbf{0}$.\n\nThe scalar normal velocity $v_{n,i}$ is the projection of $\\mathbf{v}_i$ onto $\\hat{\\mathbf{n}}_i$:\n$$ v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i $$\nThe normal velocity vector $\\mathbf{v}_{n,i}$ is then:\n$$ \\mathbf{v}_{n,i} = v_{n,i} \\hat{\\mathbf{n}}_i = (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i $$\nThe tangential velocity vector $\\mathbf{v}_{t,i}$ is the remaining part of $\\mathbf{v}_i$:\n$$ \\mathbf{v}_{t,i} = \\mathbf{v}_i - \\mathbf{v}_{n,i} $$\n\nAccording to the Lysmer-Kuhlemeyer model, the normal component of velocity, $\\mathbf{v}_{n,i}$, generates a P-wave that gives rise to a normal traction $\\mathbf{t}_{n,i}$. The tangential component of velocity, $\\mathbf{v}_{t,i}$, generates S-waves that give rise to a tangential traction $\\mathbf{t}_{t,i}$. We apply the impedance relations to each component:\n- The normal traction $\\mathbf{t}_{n,i}$ is related to the normal velocity $\\mathbf{v}_{n,i}$ via the P-wave impedance $I_p$:\n  $$ \\mathbf{t}_{n,i} = (\\rho c_p) \\mathbf{v}_{n,i} $$\n- The tangential traction $\\mathbf{t}_{t,i}$ is related to the tangential velocity $\\mathbf{v}_{t,i}$ via the S-wave impedance $I_s$:\n  $$ \\mathbf{t}_{t,i} = (\\rho c_s) \\mathbf{v}_{t,i} $$\n\nThe total traction vector $\\mathbf{t}_i$ at node $i$ is the vector sum of its normal and tangential components:\n$$ \\mathbf{t}_i = \\mathbf{t}_{n,i} + \\mathbf{t}_{t,i} = (\\rho c_p) \\mathbf{v}_{n,i} + (\\rho c_s) \\mathbf{v}_{t,i} $$\n\nSubstituting the expressions for $\\mathbf{v}_{n,i}$ and $\\mathbf{v}_{t,i}$ into the equation for $\\mathbf{t}_i$:\n$$ \\mathbf{t}_i = (\\rho c_p) ((\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) + (\\rho c_s) (\\mathbf{v}_i - (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) $$\n\nFinally, we substitute this expression for the traction $\\mathbf{t}_i$ into the equation for the nodal dashpot force $\\mathbf{f}_i$:\n$$ \\mathbf{f}_i = -A_i \\mathbf{t}_i = -A_i \\left[ (\\rho c_p) ((\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) + (\\rho c_s) (\\mathbf{v}_i - (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) \\right] $$\nThis equation can be rearranged for more efficient computation by collecting terms with $\\mathbf{v}_i$ and $(\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i$:\n$$ \\mathbf{f}_i = -A_i \\left[ (\\rho c_s) \\mathbf{v}_i + (\\rho c_p - \\rho c_s) (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i \\right] $$\nThis is the final expression used for implementation.\n\nThe algorithm to compute the nodal dashpot force vector $\\mathbf{f}_i$ for a given node $i$ is as follows:\n$1$. Obtain the input parameters for the node: material properties $\\rho$, $c_p$, $c_s$; nodal tributary area $A_i$; nodal outward normal vector $\\mathbf{n}_i$; and nodal velocity vector $\\mathbf{v}_i$.\n$2$. Calculate the magnitude of the normal vector, $N_i = \\|\\mathbf{n}_i\\|$.\n$3$. If $N_i$ is equal to $0$, the orientation is ill-posed. Set the nodal force $\\mathbf{f}_i = (0, 0, 0)$ and stop.\n$4$. Otherwise, compute the unit normal vector: $\\hat{\\mathbf{n}}_i = \\mathbf{n}_i / N_i$.\n$5$. Compute the scalar projection of the velocity onto the unit normal: $v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i$.\n$6$. Compute the nodal force vector using the derived expression:\n    $$ \\mathbf{f}_i = -A_i \\rho \\left[ c_s \\mathbf{v}_i + (c_p - c_s) v_{n,i} \\hat{\\mathbf{n}}_i \\right] $$\n$7$. The resulting vector $\\mathbf{f}_i$ has units of force (Newtons), provided all input quantities are in consistent SI units as specified in the problem statement. The process is repeated for all nodes of the boundary element.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nodal dashpot forces for a Lysmer-Kuhlemeyer viscous boundary\n    based on a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"rho\": 2000.0, \"cp\": 3000.0, \"cs\": 1500.0,\n            \"areas\": [1.5, 1.5, 1.5, 1.5],\n            \"normals\": [(0.0, 0.0, 1.0), (0.0, 0.0, 1.0), (0.0, 0.0, 1.0), (0.0, 0.0, 1.0)],\n            \"velocities\": [(0.2, 0.0, -0.1), (0.0, 0.1, 0.0), (-0.1, -0.2, 0.3), (0.05, 0.05, 0.0)],\n        },\n        {\n            \"rho\": 1800.0, \"cp\": 2500.0, \"cs\": 1200.0,\n            \"areas\": [0.8, 1.2, 1.0, 0.9],\n            \"normals\": [(1.0, 0.0, 0.0), (0.0, 1.0, 0.0), (0.0, 0.0, 1.0), (1.0, 1.0, 0.0)],\n            \"velocities\": [(0.0, 0.0, 0.0), (0.0, 0.0, 0.0), (0.0, 0.0, 0.0), (0.0, 0.0, 0.0)],\n        },\n        {\n            \"rho\": 2200.0, \"cp\": 3200.0, \"cs\": 1600.0,\n            \"areas\": [2.0, 1.0, 0.0, 3.2],\n            \"normals\": [(0.0, 0.0, 2.0), (0.0, -3.0, 0.0), (1.0, 0.0, 1.0), (-1.0, 0.0, 0.0)],\n            \"velocities\": [(0.3, -0.1, 0.4), (-0.2, 0.6, -0.1), (0.0, 0.0, 0.5), (-1.0, 0.0, 0.0)],\n        },\n        {\n            \"rho\": 2500.0, \"cp\": 5000.0, \"cs\": 3000.0,\n            \"areas\": [0.1, 0.1, 0.1, 0.1],\n            \"normals\": [(1.0, 1.0, 1.0), (1.0, 0.0, 1.0), (0.0, 1.0, 1.0), (-1.0, 1.0, 0.0)],\n            \"velocities\": [(2.0, -1.0, 0.5), (0.0, 2.0, -2.0), (-1.5, 0.5, 1.0), (0.0, -0.5, 0.5)],\n        }\n    ]\n\n    all_results_str = []\n    \n    for case_data in test_cases:\n        rho = case_data[\"rho\"]\n        cp = case_data[\"cp\"]\n        cs = case_data[\"cs\"]\n        \n        areas = np.array(case_data[\"areas\"], dtype=float)\n        normals = np.array(case_data[\"normals\"], dtype=float)\n        velocities = np.array(case_data[\"velocities\"], dtype=float)\n        \n        case_forces = []\n        for i in range(4): # Loop over the 4 nodes of the quadrilateral element\n            A_i = areas[i]\n            n_i = normals[i]\n            v_i = velocities[i]\n            \n            # If area is zero, force is zero.\n            if A_i == 0.0:\n                f_i = np.array([0.0, 0.0, 0.0])\n                case_forces.append(f_i)\n                continue\n                \n            norm_n = np.linalg.norm(n_i)\n            \n            # Handle ill-posed normal vector.\n            if norm_n == 0.0:\n                f_i = np.array([0.0, 0.0, 0.0])\n            else:\n                n_hat_i = n_i / norm_n\n                \n                # Calculate scalar normal velocity\n                v_n_i_scalar = np.dot(v_i, n_hat_i)\n                \n                # Calculate nodal force using the derived formula:\n                # f_i = -A_i * (rho * cs * v_i + rho * (cp - cs) * v_n_i_scalar * n_hat_i)\n                term1 = cs * v_i\n                term2 = (cp - cs) * v_n_i_scalar * n_hat_i\n                f_i = -A_i * rho * (term1 + term2)\n\n            case_forces.append(f_i)\n\n        # Format the result for the current test case according to output specifications.\n        # This involves creating a string representation without spaces.\n        node_force_strs = []\n        for force_vec in case_forces:\n            # Round each component to 6 decimal places\n            force_vec_rounded = np.round(force_vec, 6)\n            # Format as [fx,fy,fz]\n            force_str = f'[{\",\".join(map(str, force_vec_rounded))}]'\n            node_force_strs.append(force_str)\n        \n        # Format as [[...],[...],[...],[...]]\n        case_str = f'[{\",\".join(node_force_strs)}]'\n        all_results_str.append(case_str)\n    \n    # Final print statement in the exact required format: [case1_str,case2_str,...]\n    final_output = f'[{\",\".join(all_results_str)}]'\n    print(final_output)\n\nsolve()\n```", "id": "3570002"}, {"introduction": "A robust numerical model must adhere to fundamental physical laws, with the conservation of energy being paramount. This hands-on exercise focuses on verifying the energy balance of the Lysmer-Kuhlemeyer viscous boundary. You will prove, both analytically and through a numerical simulation, that the power dissipated by the boundary dashpots is exactly equal to the net energy flux of waves being absorbed, confirming the physical consistency of your implementation. [@problem_id:3570020]", "problem": "Consider a linear elastic half-space occupying $x \\ge 0$ with a straight boundary $\\Gamma$ at $x=0$ of length $L$ (in meters). The medium has mass density $\\rho$ (in $\\mathrm{kg/m^3}$), compressional (primary) wave speed $c_p$ (in $\\mathrm{m/s}$), and shear (secondary) wave speed $c_s$ (in $\\mathrm{m/s}$). The boundary at $x=0$ is equipped with Lysmer-Kuhlemeyer (LK) viscous dashpots with normal coefficient $k_n$ (in $\\mathrm{Pa \\cdot s/m}$) and tangential coefficient $k_t$ (in $\\mathrm{Pa \\cdot s/m}$). The LK boundary models energy absorption by applying viscous tractions proportional to the boundary velocity components. Define the normal and tangential particle velocities at the boundary as $v_n(t)$ and $v_t(t)$ (in $\\mathrm{m/s}$), respectively.\n\nStart from first principles in elastodynamics: the instantaneous mechanical power flux across $\\Gamma$ equals the integral over $\\Gamma$ of traction times velocity. For plane waves in a homogeneous, isotropic linear elastic medium, use the well-tested fact that mechanical impedances for compressional and shear waves are $Z_n = \\rho c_p$ and $Z_t = \\rho c_s$, respectively, and that superposition of right-traveling (outgoing) and left-traveling (reflected) waves at the boundary gives traction-velocity relations consistent with these impedances. Do not assume any pre-derived energy balance formulas; instead, derive the energy flux leaving the domain through $\\Gamma$ in terms of incident and reflected velocities and compute the dissipated power in the LK dashpots from their viscous law.\n\nYour task is to implement a program that, for each specified test case, computes the instantaneous energy flux through $\\Gamma$ and the instantaneous viscous dissipation by the LK dashpots, and then verifies their equality up to numerical loss due to discrete time sampling. For each test case, define incident normal and tangential velocity signals $v_{n}^{\\mathrm{inc}}(t)$ and $v_{t}^{\\mathrm{inc}}(t)$ as smooth, finite-duration Gaussian-modulated sinusoids:\n$$\nv_{n}^{\\mathrm{inc}}(t) = A_n \\sin(2\\pi f_n t + \\phi_n)\\,\\exp\\!\\left(-\\frac{(t-t_{0,n})^2}{2\\sigma_n^2}\\right), \\quad\nv_{t}^{\\mathrm{inc}}(t) = A_t \\sin(2\\pi f_t t + \\phi_t)\\,\\exp\\!\\left(-\\frac{(t-t_{0,t})^2}{2\\sigma_t^2}\\right),\n$$\nwith amplitudes $A_n$ and $A_t$ (in $\\mathrm{m/s}$), frequencies $f_n$ and $f_t$ (in $\\mathrm{Hz}$), phases $\\phi_n$ and $\\phi_t$ (in radians), centers $t_{0,n}$ and $t_{0,t}$ (in $\\mathrm{s}$), and widths $\\sigma_n$ and $\\sigma_t$ (in $\\mathrm{s}$). The reflected velocities $v_{n}^{\\mathrm{ref}}(t)$ and $v_{t}^{\\mathrm{ref}}(t)$ occur due to impedance mismatch at the LK boundary. From traction continuity and the dashpot law, derive the instantaneous reflection relations and use them to compute the boundary velocities $v_n(t)$ and $v_t(t)$ and the power balance.\n\nTime-discretize the interval $[0,T]$ using a uniform step $\\Delta t$ and evaluate the following at each time:\n- The instantaneous power dissipated by LK dashpots:\n$$\n\\dot{W}_{\\mathrm{diss}}(t) = \\int_{\\Gamma} \\big(k_n\\,v_n(t)^2 + k_t\\,v_t(t)^2\\big)\\,ds,\n$$\n- The instantaneous outgoing energy flux from the medium minus the reflected energy flux:\n$$\n\\dot{W}_{\\mathrm{flux}}(t) = \\int_{\\Gamma} \\Big(Z_n\\big((v_{n}^{\\mathrm{inc}}(t))^2 - (v_{n}^{\\mathrm{ref}}(t))^2\\big) + Z_t\\big((v_{t}^{\\mathrm{inc}}(t))^2 - (v_{t}^{\\mathrm{ref}}(t))^2\\big)\\Big)\\,ds.\n$$\n\nFor each test case, report the maximum absolute imbalance over time:\n$$\n\\epsilon_{\\max} = \\max_{t \\in [0,T]} \\big|\\dot{W}_{\\mathrm{diss}}(t) - \\dot{W}_{\\mathrm{flux}}(t)\\big|,\n$$\nexpressed in watts ($\\mathrm{W}$), rounded by the default behavior of the programming language's floating-point formatting.\n\nUse the following test suite. In all cases, take $L$ equal to the boundary length and assume velocities are uniform along $\\Gamma$ so that $\\int_{\\Gamma}(\\cdot)\\,ds = L\\,(\\cdot)$.\n\n- Test Case $1$ (matched LK, pure absorption, happy path):\n  - $\\rho = 2000\\,\\mathrm{kg/m^3}$, $c_p = 1500\\,\\mathrm{m/s}$, $c_s = 800\\,\\mathrm{m/s}$, $L = 1\\,\\mathrm{m}$.\n  - $k_n = \\alpha_n \\rho c_p$ with $\\alpha_n = 1$, $k_t = \\alpha_t \\rho c_s$ with $\\alpha_t = 1$.\n  - $A_n = 0.01\\,\\mathrm{m/s}$, $f_n = 10\\,\\mathrm{Hz}$, $\\phi_n = 0\\,\\mathrm{rad}$, $t_{0,n} = 0.30\\,\\mathrm{s}$, $\\sigma_n = 0.05\\,\\mathrm{s}$.\n  - $A_t = 0\\,\\mathrm{m/s}$ (no tangential motion).\n  - $T = 1.00\\,\\mathrm{s}$, $\\Delta t = 0.00005\\,\\mathrm{s}$.\n\n- Test Case $2$ (mismatched LK, mixed normal and tangential):\n  - $\\rho = 1800\\,\\mathrm{kg/m^3}$, $c_p = 1700\\,\\mathrm{m/s}$, $c_s = 900\\,\\mathrm{m/s}$, $L = 1\\,\\mathrm{m}$.\n  - $\\alpha_n = 0.5$ so $k_n = 0.5\\,\\rho c_p$, $\\alpha_t = 1.5$ so $k_t = 1.5\\,\\rho c_s$.\n  - $A_n = 0.02\\,\\mathrm{m/s}$, $f_n = 15\\,\\mathrm{Hz}$, $\\phi_n = 0\\,\\mathrm{rad}$, $t_{0,n} = 0.40\\,\\mathrm{s}$, $\\sigma_n = 0.07\\,\\mathrm{s}$.\n  - $A_t = 0.015\\,\\mathrm{m/s}$, $f_t = 20\\,\\mathrm{Hz}$, $\\phi_t = \\pi/4\\,\\mathrm{rad}$, $t_{0,t} = 0.35\\,\\mathrm{s}$, $\\sigma_t = 0.06\\,\\mathrm{s}$.\n  - $T = 1.00\\,\\mathrm{s}$, $\\Delta t = 0.00005\\,\\mathrm{s}$.\n\n- Test Case $3$ (edge case, zero input velocities):\n  - $\\rho = 2200\\,\\mathrm{kg/m^3}$, $c_p = 2000\\,\\mathrm{m/s}$, $c_s = 1200\\,\\mathrm{m/s}$, $L = 1\\,\\mathrm{m}$.\n  - $\\alpha_n = 1$, $\\alpha_t = 1$ so $k_n = \\rho c_p$, $k_t = \\rho c_s$.\n  - $A_n = 0\\,\\mathrm{m/s}$, $A_t = 0\\,\\mathrm{m/s}$ (all other signal parameters may be selected consistently but have no effect).\n  - $T = 1.00\\,\\mathrm{s}$, $\\Delta t = 0.00005\\,\\mathrm{s}$.\n\n- Test Case $4$ (strong mismatch and larger boundary):\n  - $\\rho = 2000\\,\\mathrm{kg/m^3}$, $c_p = 1600\\,\\mathrm{m/s}$, $c_s = 700\\,\\mathrm{m/s}$, $L = 2\\,\\mathrm{m}$.\n  - $\\alpha_n = 5.0$ so $k_n = 5.0\\,\\rho c_p$, $\\alpha_t = 0.2$ so $k_t = 0.2\\,\\rho c_s$.\n  - $A_n = 0.012\\,\\mathrm{m/s}$, $f_n = 12\\,\\mathrm{Hz}$, $\\phi_n = \\pi/6\\,\\mathrm{rad}$, $t_{0,n} = 0.50\\,\\mathrm{s}$, $\\sigma_n = 0.08\\,\\mathrm{s}$.\n  - $A_t = 0.010\\,\\mathrm{m/s}$, $f_t = 18\\,\\mathrm{Hz}$, $\\phi_t = -\\pi/3\\,\\mathrm{rad}$, $t_{0,t} = 0.45\\,\\mathrm{s}$, $\\sigma_t = 0.07\\,\\mathrm{s}$.\n  - $T = 1.20\\,\\mathrm{s}$, $\\Delta t = 0.00005\\,\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\epsilon_1,\\epsilon_2,\\epsilon_3,\\epsilon_4]$, where each $\\epsilon_i$ is the maximum absolute imbalance in $\\mathrm{W}$ for the corresponding test case, computed as specified above.", "solution": "The problem requires verifying the energy conservation principle at a Lysmer-Kuhlemeyer (LK) viscous boundary for a linear elastic half-space. This task involves two main steps: first, deriving the relationship between incident and reflected waves at the boundary from first principles, and second, using this relationship to demonstrate analytically that the power dissipated by the viscous dashpots is equal to the net energy flux leaving the medium. The final implementation will be a numerical verification of this analytical identity.\n\nThe problem considers a half-space for $x \\ge 0$. Waves are decomposed into incident and reflected components at the boundary $x=0$. An incident wave travels from within the medium towards the boundary, which corresponds to a left-traveling wave in the $-x$ direction, described by functions of $(t+x/c)$. A reflected wave travels from the boundary back into the medium, which corresponds to a right-traveling wave in the $+x$ direction, described by functions of $(t-x/c)$. The analysis is identical for normal and tangential components, so we will omit the subscripts $n$ and $t$ for clarity in this derivation.\n\nStep 1: Derivation of the Velocity Reflection Coefficient\n\nThe total particle velocity $v(x,t)$ at any point is the superposition of the incident and reflected wave velocities:\n$$\nv(x,t) = v_{\\mathrm{inc}}(t+x/c) + v_{\\mathrm{ref}}(t-x/c)\n$$\nAt the boundary $x=0$, the velocity is:\n$$\nv(t) = v(0,t) = v_{\\mathrm{inc}}(t) + v_{\\mathrm{ref}}(t)\n$$\nIn a linear elastic medium, the stress $\\sigma$ associated with a plane wave is related to the particle velocity $v$ through the mechanical impedance $Z = \\rho c$. The sign of the relationship depends on the direction of propagation. For a right-traveling wave (in the $+x$ direction, a function of $t-x/c$), the stress is $\\sigma = Zv$. For a left-traveling wave (in the $-x$ direction, a function of $t+x/c$), the stress is $\\sigma = -Zv$.\nApplying this to our case:\n\\begin{itemize}\n    \\item The incident wave is left-traveling, so its associated stress is $\\sigma_{\\mathrm{inc}}(x,t) = -Z v_{\\mathrm{inc}}(t+x/c)$.\n    \\item The reflected wave is right-traveling, so its associated stress is $\\sigma_{\\mathrm{ref}}(x,t) = Z v_{\\mathrm{ref}}(t-x/c)$.\n\\end{itemize}\nThe total stress in the medium at the boundary $x=0$ is the sum of the stresses from both waves:\n$$\n\\sigma_{\\mathrm{total}}(t) = \\sigma_{\\mathrm{inc}}(0,t) + \\sigma_{\\mathrm{ref}}(0,t) = -Z v_{\\mathrm{inc}}(t) + Z v_{\\mathrm{ref}}(t)\n$$\nThis stress is the traction exerted by the medium on the boundary. The LK viscous boundary condition states that the traction exerted *by the boundary on the medium* is equal to $-kv(t)$, where $k$ is the dashpot coefficient and $v(t)$ is the total velocity at the boundary. By Newton's third law, the force the medium exerts *on the boundary* is equal and opposite to the force the boundary exerts *on the medium*. So, $\\sigma_{\\mathrm{total}}(t) = -(-kv(t)) = kv(t)$. Historically, the boundary traction is defined as the force the external element applies to the continua, so we write the boundary condition as:\n$$\n\\sigma_{\\mathrm{total}}(t) = -k v(t)\n$$\nEquating the two expressions for the total stress at the boundary:\n$$\n-Z v_{\\mathrm{inc}}(t) + Z v_{\\mathrm{ref}}(t) = -k \\big(v_{\\mathrm{inc}}(t) + v_{\\mathrm{ref}}(t)\\big)\n$$\nWe can now solve for the reflected velocity $v_{\\mathrm{ref}}(t)$ in terms of the incident velocity $v_{\\mathrm{inc}}(t)$:\n$$\nv_{\\mathrm{ref}}(t) (Z+k) = v_{\\mathrm{inc}}(t) (Z-k)\n$$\n$$\nv_{\\mathrm{ref}}(t) = \\left(\\frac{Z-k}{Z+k}\\right) v_{\\mathrm{inc}}(t)\n$$\nThis defines the velocity reflection coefficient, $R_v$:\n$$\nR_v = \\frac{Z-k}{Z+k}\n$$\nThis relation holds independently for the normal and tangential components, so we have $R_{v,n} = \\frac{Z_n-k_n}{Z_n+k_n}$ and $R_{v,t} = \\frac{Z_t-k_t}{Z_t+k_t}$.\n\nStep 2: Verification of the Energy Balance\n\nThe problem requires us to verify that the power dissipated by the dashpots, $\\dot{W}_{\\mathrm{diss}}$, equals the net energy flux out of the medium, $\\dot{W}_{\\mathrm{flux}}$. These quantities are given by:\n$$\n\\dot{W}_{\\mathrm{diss}}(t) = L \\big(k_n\\,v_n(t)^2 + k_t\\,v_t(t)^2\\big)\n$$\n$$\n\\dot{W}_{\\mathrm{flux}}(t) = L \\Big(Z_n\\big((v_{n}^{\\mathrm{inc}}(t))^2 - (v_{n}^{\\mathrm{ref}}(t))^2\\big) + Z_t\\big((v_{t}^{\\mathrm{inc}}(t))^2 - (v_{t}^{\\mathrm{ref}}(t))^2\\big)\\Big)\n$$\nwhere the assumption of uniform velocity along the boundary of length $L$ has been used to evaluate the integral $\\int_\\Gamma (\\cdot) ds = L (\\cdot)$. Since the normal and tangential components are uncoupled, we can verify the equality for a single component. We must show that $k v^2 = Z( (v^{\\mathrm{inc}})^2 - (v^{\\mathrm{ref}})^2 )$.\n\nLet's analyze the left-hand side (LHS), representing dissipated power density:\n$$\n\\text{LHS} = k v^2 = k (v^{\\mathrm{inc}} + v^{\\mathrm{ref}})^2 = k (v^{\\mathrm{inc}} + R_v v^{\\mathrm{inc}})^2 = k (v^{\\mathrm{inc}})^2 (1+R_v)^2\n$$\nSubstituting the expression for $R_v$:\n$$\n1+R_v = 1 + \\frac{Z-k}{Z+k} = \\frac{(Z+k)+(Z-k)}{Z+k} = \\frac{2Z}{Z+k}\n$$\nSo, the LHS becomes:\n$$\n\\text{LHS} = k (v^{\\mathrm{inc}})^2 \\left(\\frac{2Z}{Z+k}\\right)^2 = \\frac{4kZ^2}{(Z+k)^2} (v^{\\mathrm{inc}})^2\n$$\nNow, let's analyze the right-hand side (RHS), representing the net power flux density:\n$$\n\\text{RHS} = Z((v^{\\mathrm{inc}})^2 - (v^{\\mathrm{ref}})^2) = Z((v^{\\mathrm{inc}})^2 - (R_v v^{\\mathrm{inc}})^2) = Z(v^{\\mathrm{inc}})^2 (1-R_v^2)\n$$\nWe can factor $1-R_v^2 = (1-R_v)(1+R_v)$. We already have $(1+R_v)$:\n$$\n1-R_v = 1 - \\frac{Z-k}{Z+k} = \\frac{(Z+k)-(Z-k)}{Z+k} = \\frac{2k}{Z+k}\n$$\nSo, the RHS becomes:\n$$\n\\text{RHS} = Z(v^{\\mathrm{inc}})^2 \\left(\\frac{2k}{Z+k}\\right)\\left(\\frac{2Z}{Z+k}\\right) = \\frac{4kZ^2}{(Z+k)^2} (v^{\\mathrm{inc}})^2\n$$\nSince LHS = RHS, the equality $k v^2 = Z( (v^{\\mathrm{inc}})^2 - (v^{\\mathrm{ref}})^2 )$ is analytically proven. The equality $\\dot{W}_{\\mathrm{diss}}(t) = \\dot{W}_{\\mathrm{flux}}(t)$ must therefore hold at every instant in time.\n\nStep 3: Numerical Implementation\n\nThe program will implement a numerical check of this analytical identity for the given test cases. For each case, the algorithm proceeds as follows:\n\\begin{enumerate}\n    \\item A discrete time vector $t$ is created spanning the interval $[0, T]$ with step $\\Delta t$.\n    \\item The incident normal and tangential velocity signals, $v_{n}^{\\mathrm{inc}}(t)$ and $v_{t}^{\\mathrm{inc}}(t)$, are computed at each time step using their given Gaussian-modulated sinusoid definitions.\n    \\item The material impedances $Z_n = \\rho c_p$ and $Z_t = \\rho c_s$, and the dashpot coefficients $k_n = \\alpha_n Z_n$ and $k_t = \\alpha_t Z_t$, are calculated.\n    \\item The velocity reflection coefficients $R_{v,n}$ and $R_{v,t}$ are computed from $Z_n, k_n$ and $Z_t, k_t$.\n    \\item The reflected velocity time series, $v_{n}^{\\mathrm{ref}}(t)$ and $v_{t}^{\\mathrm{ref}}(t)$, are calculated by multiplying the incident velocities by their respective reflection coefficients.\n    \\item The total boundary velocities, $v_n(t) = v_{n}^{\\mathrm{inc}}(t) + v_{n}^{\\mathrm{ref}}(t)$ and $v_t(t) = v_{t}^{\\mathrm{inc}}(t) + v_{t}^{\\mathrm{ref}}(t)$, are determined.\n    \\item The instantaneous dissipated power $\\dot{W}_{\\mathrm{diss}}(t)$ and net energy flux $\\dot{W}_{\\mathrm{flux}}(t)$ are calculated for all time steps using the formulas provided in the problem statement.\n    \\item The absolute difference $|\\dot{W}_{\\mathrm{diss}}(t) - \\dot{W}_{\\mathrm{flux}}(t)|$ is computed. The maximum value of this difference over the entire time interval, $\\epsilon_{\\max}$, is found.\n\\end{enumerate}\nDue to the analytical proof above, any non-zero value for $\\epsilon_{\\max}$ will be attributable solely to floating-point arithmetic precision errors, not to the physics or the discretization method.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        # Test Case 1: Matched LK\n        {\n            \"medium\": {\"rho\": 2000.0, \"cp\": 1500.0, \"cs\": 800.0, \"L\": 1.0},\n            \"coeffs\": {\"alpha_n\": 1.0, \"alpha_t\": 1.0},\n            \"signal_n\": {\"A\": 0.01, \"f\": 10.0, \"phi\": 0.0, \"t0\": 0.30, \"sigma\": 0.05},\n            \"signal_t\": {\"A\": 0.0, \"f\": 0.0, \"phi\": 0.0, \"t0\": 0.0, \"sigma\": 1.0},\n            \"time\": {\"T\": 1.00, \"dt\": 0.00005},\n        },\n        # Test Case 2: Mismatched LK\n        {\n            \"medium\": {\"rho\": 1800.0, \"cp\": 1700.0, \"cs\": 900.0, \"L\": 1.0},\n            \"coeffs\": {\"alpha_n\": 0.5, \"alpha_t\": 1.5},\n            \"signal_n\": {\"A\": 0.02, \"f\": 15.0, \"phi\": 0.0, \"t0\": 0.40, \"sigma\": 0.07},\n            \"signal_t\": {\"A\": 0.015, \"f\": 20.0, \"phi\": np.pi / 4, \"t0\": 0.35, \"sigma\": 0.06},\n            \"time\": {\"T\": 1.00, \"dt\": 0.00005},\n        },\n        # Test Case 3: Zero input velocities\n        {\n            \"medium\": {\"rho\": 2200.0, \"cp\": 2000.0, \"cs\": 1200.0, \"L\": 1.0},\n            \"coeffs\": {\"alpha_n\": 1.0, \"alpha_t\": 1.0},\n            \"signal_n\": {\"A\": 0.0, \"f\": 1.0, \"phi\": 0.0, \"t0\": 0.5, \"sigma\": 0.1},\n            \"signal_t\": {\"A\": 0.0, \"f\": 1.0, \"phi\": 0.0, \"t0\": 0.5, \"sigma\": 0.1},\n            \"time\": {\"T\": 1.00, \"dt\": 0.00005},\n        },\n        # Test Case 4: Strong mismatch and larger boundary\n        {\n            \"medium\": {\"rho\": 2000.0, \"cp\": 1600.0, \"cs\": 700.0, \"L\": 2.0},\n            \"coeffs\": {\"alpha_n\": 5.0, \"alpha_t\": 0.2},\n            \"signal_n\": {\"A\": 0.012, \"f\": 12.0, \"phi\": np.pi / 6, \"t0\": 0.50, \"sigma\": 0.08},\n            \"signal_t\": {\"A\": 0.010, \"f\": 18.0, \"phi\": -np.pi / 3, \"t0\": 0.45, \"sigma\": 0.07},\n            \"time\": {\"T\": 1.20, \"dt\": 0.00005},\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_max_imbalance(case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef incident_velocity_signal(t, A, f, phi, t0, sigma):\n    \"\"\"\n    Computes the Gaussian-modulated sinusoid incident velocity signal at times t.\n    \"\"\"\n    if A == 0:\n        return np.zeros_like(t)\n    return A * np.sin(2 * np.pi * f * t + phi) * np.exp(-((t - t0)**2) / (2 * sigma**2))\n\ndef calculate_max_imbalance(case):\n    \"\"\"\n    Calculates the maximum absolute power imbalance for a single test case.\n    \"\"\"\n    # Unpack parameters from the case dictionary\n    rho = case[\"medium\"][\"rho\"]\n    cp = case[\"medium\"][\"cp\"]\n    cs = case[\"medium\"][\"cs\"]\n    L = case[\"medium\"][\"L\"]\n    \n    alpha_n = case[\"coeffs\"][\"alpha_n\"]\n    alpha_t = case[\"coeffs\"][\"alpha_t\"]\n    \n    params_n = case[\"signal_n\"]\n    params_t = case[\"signal_t\"]\n    \n    T = case[\"time\"][\"T\"]\n    dt = case[\"time\"][\"dt\"]\n\n    # Create the time vector\n    t = np.arange(0, T, dt)\n\n    # Generate incident velocity signals\n    v_n_inc = incident_velocity_signal(t, **params_n)\n    v_t_inc = incident_velocity_signal(t, **params_t)\n\n    # Calculate mechanical impedances\n    Z_n = rho * cp\n    Z_t = rho * cs\n\n    # Calculate viscous dashpot coefficients\n    k_n = alpha_n * Z_n\n    k_t = alpha_t * Z_t\n\n    # Calculate velocity reflection coefficients\n    # Denominators (Z+k) are non-zero for all physical parameters.\n    R_n = (Z_n - k_n) / (Z_n + k_n)\n    R_t = (Z_t - k_t) / (Z_t + k_t)\n\n    # Calculate reflected velocities\n    v_n_ref = R_n * v_n_inc\n    v_t_ref = R_t * v_t_inc\n\n    # Calculate total boundary velocities\n    v_n = v_n_inc + v_n_ref\n    v_t = v_t_inc + v_t_ref\n\n    # Calculate instantaneous power dissipated by LK dashpots\n    W_diss = L * (k_n * v_n**2 + k_t * v_t**2)\n\n    # Calculate instantaneous outgoing energy flux from the medium\n    W_flux = L * (Z_n * (v_n_inc**2 - v_n_ref**2) + Z_t * (v_t_inc**2 - v_t_ref**2))\n\n    # Calculate the absolute difference (imbalance)\n    imbalance = np.abs(W_diss - W_flux)\n    \n    # Find the maximum imbalance over the time interval\n    max_imbalance = np.max(imbalance) if imbalance.size > 0 else 0.0\n\n    return max_imbalance\n\nsolve()\n```", "id": "3570020"}, {"introduction": "While viscous boundaries are effective, they are based on an approximation that is only perfect for normally incident plane waves. To use them responsibly in engineering practice, we must understand and quantify their limitations. This exercise challenges you to analyze the performance of the LK boundary by comparing it against an exact analytical solution for waves arriving at different angles, allowing you to measure the inherent model error and appreciate the conditions under which it performs best. [@problem_id:3569961]", "problem": "You are to construct and evaluate analytical benchmarks for Viscous Boundaries as introduced by Lysmer and Kuhlemeyer (Lysmer-Kuhlemeyer (LK)) in computational geomechanics. Consider linear elastodynamics with small strains. The focus is on standing-wave fields within finite domains of length $L$ that impinge upon a boundary where a viscous traction of the form $t = -Z u_t$ (impedance times velocity, where $u_t$ denotes the time derivative of displacement) is applied. Your task is to compute, for each benchmark, a dimensionless error that quantifies the mismatch between the continuum traction and the LK viscous boundary traction at the boundary.\n\nFundamental base and definitions:\n- The one-dimensional ($1\\mathrm{D}$) elastic bar satisfies the wave equation $u_{tt} = c^2 u_{xx}$ with longitudinal wave speed $c = \\sqrt{E/\\rho}$, where $E$ is Young’s modulus and $\\rho$ is mass density.\n- For plane strain in two dimensions ($2\\mathrm{D}$), the elastic constitutive law is $\\sigma = \\lambda \\, \\mathrm{tr}(\\varepsilon) \\, I + 2 \\mu \\varepsilon$, where $\\lambda$ and $\\mu$ are Lamé parameters, $\\varepsilon$ is the symmetric gradient of displacement $u$, $\\sigma$ is the stress tensor, and $I$ is the identity tensor. The compressional and shear wave speeds are $c_p = \\sqrt{(\\lambda + 2 \\mu)/\\rho}$ and $c_s = \\sqrt{\\mu/\\rho}$, respectively.\n- The LK boundary model applies local dashpot tractions that, for a boundary with outward unit normal $n$, are proportional to the normal and tangential components of velocity: the traction vector is constructed from the normal velocity component $v_n = v \\cdot n$ and the tangential velocity $v_t = v - v_n n$ with impedance-like coefficients derived from $\\rho c_p$ and $\\rho c_s$.\n\nBenchmark fields to be evaluated at the boundary $x = 0$:\n- For $1\\mathrm{D}$, use a standing-wave superposition\n$$\nu(x,t) = A \\left[\\cos(\\omega t - k x) + \\cos(\\omega t + k x + \\delta)\\right],\n$$\nwith $k = n \\pi / L$, $\\omega = c k$, amplitude $A > 0$, phase offset $\\delta \\in [0, \\pi)$, integer mode index $n \\ge 1$, and $L > 0$.\n- For $2\\mathrm{D}$ plane strain, use a standing-wave superposition of two counter-propagating plane waves at incidence angle $\\theta$ (measured from the $x$-axis) with propagation coordinate $s = x \\cos\\theta + y \\sin\\theta$:\n    - Compressional ($P$-wave) displacement field\n    $$\n    u(x,y,t) = A \\left[\\cos(\\omega t - k s) + \\cos(\\omega t + k s + \\delta)\\right] \\, p,\n    $$\n    with $p = (\\cos\\theta, \\sin\\theta)$, $k = n \\pi / L$, $\\omega = c_p k$, amplitude $A > 0$, phase offset $\\delta$, and incidence angle $\\theta$.\n    - Shear ($S$-wave) displacement field\n    $$\n    u(x,y,t) = A \\left[\\cos(\\omega t - k s) + \\cos(\\omega t + k s + \\delta)\\right] \\, s,\n    $$\n    with $s = (-\\sin\\theta, \\cos\\theta)$, $k = n \\pi / L$, $\\omega = c_s k$, amplitude $A > 0$, phase offset $\\delta$, and incidence angle $\\theta$.\n\nTractions and error definition:\n- Continuum traction vector at the boundary $x = 0$ is $t = \\sigma \\, n$, where $n = (1, 0)$ is the outward normal of the boundary.\n- Velocity is $v = u_t$. The LK traction vector at the boundary is constructed as\n$$\nt_{\\mathrm{LK}} = -\\rho c_p (v \\cdot n) n - \\rho c_s \\left(v - (v \\cdot n) n \\right).\n$$\n- Define the residual vector as $r = t - t_{\\mathrm{LK}}$. The dimensionless LK error is the ratio of the root-mean-square (RMS) norm of the residual to the RMS norm of the reference LK traction over one temporal period and, for the $2\\mathrm{D}$ cases, over one spatial period along $y$:\n    - For $1\\mathrm{D}$:\n    $$\n    \\varepsilon_{1\\mathrm{D}} = \\frac{\\left(\\int_0^{T} \\left|E u_x(0,t) + \\rho c u_t(0,t)\\right|^2 \\, dt \\right)^{1/2}}{\\left(\\int_0^{T} \\left|\\rho c u_t(0,t)\\right|^2 \\, dt \\right)^{1/2}},\n    \\quad T = \\frac{2\\pi}{\\omega}.\n    $$\n    - For $2\\mathrm{D}$:\n    $$\n    \\varepsilon_{2\\mathrm{D}} = \\frac{\\left(\\int_0^{T} \\int_0^{Y_{\\mathrm{per}}} \\| r(0, y, t)\\|^2 \\, dy \\, dt \\right)^{1/2}}{\\left(\\int_0^{T} \\int_0^{Y_{\\mathrm{per}}} \\| t_{\\mathrm{LK}}(0, y, t)\\|^2 \\, dy \\, dt \\right)^{1/2}},\n    \\quad T = \\frac{2\\pi}{\\omega}, \\quad Y_{\\mathrm{per}} = \\frac{2\\pi}{k \\sin\\theta},\n    $$\n    where $\\|\\cdot\\|$ denotes the Euclidean norm of a vector. In all cases, report the error as a dimensionless float.\n\nAngle specification and units:\n- Use angles $\\theta$ in degrees.\n- Physical units must be consistent: $L$ in meters, $\\rho$ in kilograms per cubic meter, $E$, $\\lambda$, and $\\mu$ in pascals, $A$ in meters, time in seconds.\n- Express all final answers as dimensionless floats rounded to six decimal places.\n\nTest suite:\nCompute the LK error for the following five parameter sets.\n- Case $1$ ($1\\mathrm{D}$, happy path): $\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = 0$.\n- Case $2$ ($1\\mathrm{D}$, phase-shifted standing wave): $\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = \\pi/2$.\n- Case $3$ ($1\\mathrm{D}$, near-node misfit): $\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = 0.9\\pi$.\n- Case $4$ ($2\\mathrm{D}$, $P$-wave oblique incidence): $\\rho = 2000$, $\\lambda = 2\\times 10^9$, $\\mu = 1\\times 10^9$, $L = 100$, $A = 0.001$, $n = 1$, $\\delta = \\pi/3$, $\\theta = 30$ degrees.\n- Case $5$ ($2\\mathrm{D}$, $S$-wave near-grazing incidence): $\\rho = 2000$, $\\lambda = 2\\times 10^9$, $\\mu = 1\\times 10^9$, $L = 100$, $A = 0.001$, $n = 1$, $\\delta = 0.8\\pi$, $\\theta = 75$ degrees.\n\nFinal output specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite above, each value rounded to six decimal places (e.g., $[0.123456,1.234567,2.345678,3.456789,4.567890]$). No additional text should be printed.", "solution": "The general approach involves deriving the expressions for the continuum traction vector, $t$, and the LK traction vector, $t_{\\mathrm{LK}}$, at the boundary $x=0$. The residual vector is defined as $r = t - t_{\\mathrm{LK}}$ in the problem's context via the error formula specification, which uses $E u_x + \\rho c u_t$ for the $1\\mathrm{D}$ residual. For a boundary at $x=0$ with outward normal $n=(1,0)$ on a domain in $x<0$, the continuum traction is $t=\\sigma n|_{x=0}$ and the LK traction is $t_{\\mathrm{LK}} = -\\rho c_p (v \\cdot n) n - \\rho c_s (v - (v \\cdot n) n)|_{x=0}$. For a $1\\mathrm{D}$ bar, this simplifies to $t=E u_x|_{x=0}$ and $t_{\\mathrm{LK}} = -\\rho c u_t|_{x=0}$. The specified residual in the $1\\mathrm{D}$ error formula, $E u_x + \\rho c u_t$, is precisely $t - t_{\\mathrm{LK}}$. The dimensionless error, $\\varepsilon$, is the ratio of the root-mean-square (RMS) norm of the residual to the RMS norm of the reference LK traction.\n\n**1. Analysis for the $1\\mathrm{D}$ Case**\n\nThe displacement field is $u(x,t) = A \\left[\\cos(\\omega t - k x) + \\cos(\\omega t + k x + \\delta)\\right]$. We evaluate the required terms at the boundary $x=0$.\nThe velocity is $u_t(x,t) = -A\\omega\\left[\\sin(\\omega t - k x) + \\sin(\\omega t + k x + \\delta)\\right]$.\nAt $x=0$, $u_t(0,t) = -A\\omega\\left[\\sin(\\omega t) + \\sin(\\omega t + \\delta)\\right]$.\nThe spatial derivative is $u_x(x,t) = Ak\\left[\\sin(\\omega t - k x) - \\sin(\\omega t + k x + \\delta)\\right]$.\nAt $x=0$, $u_x(0,t) = Ak\\left[\\sin(\\omega t) - \\sin(\\omega t + \\delta)\\right]$.\n\nThe numerator of the error expression involves the term $R_{1\\mathrm{D}}(t) = E u_x(0,t) + \\rho c u_t(0,t)$.\nUsing $E = \\rho c^2$ and $\\omega = ck$, we find that $E k = \\rho c \\omega$.\n$R_{1\\mathrm{D}}(t) = (EAk)[\\sin(\\omega t) - \\sin(\\omega t + \\delta)] - (\\rho c A \\omega)[\\sin(\\omega t) + \\sin(\\omega t + \\delta)]$\n$R_{1\\mathrm{D}}(t) = EAk \\left\\{ [\\sin(\\omega t) - \\sin(\\omega t+\\delta)] - [\\sin(\\omega t) + \\sin(\\omega t+\\delta)] \\right\\}$\n$R_{1\\mathrm{D}}(t) = EAk [-2\\sin(\\omega t+\\delta)] = -2EAk \\sin(\\omega t+\\delta)$.\n\nThe denominator involves the reference term $T_{\\mathrm{ref}}(t) = \\rho c u_t(0,t) = -\\rho c A\\omega[\\sin(\\omega t) + \\sin(\\omega t+\\delta)]$.\n$T_{\\mathrm{ref}}(t) = -EAk[\\sin(\\omega t) + \\sin(\\omega t) \\cos\\delta + \\cos(\\omega t) \\sin\\delta]$\n$T_{\\mathrm{ref}}(t) = -EAk[(1+\\cos\\delta)\\sin(\\omega t) + \\sin\\delta \\cos(\\omega t)]$.\n\nThe error is $\\varepsilon_{1\\mathrm{D}} = \\left( \\int_0^T R_{1\\mathrm{D}}(t)^2 dt / \\int_0^T T_{\\mathrm{ref}}(t)^2 dt \\right)^{1/2}$, where $T=2\\pi/\\omega$.\nThe integral of the squared residual numerator is:\n$\\int_0^T R_{1\\mathrm{D}}(t)^2 dt = \\int_0^T (-2EAk)^2 \\sin^2(\\omega t+\\delta) dt = 4(EAk)^2 (T/2) = 2T(EAk)^2$.\nThe integral of the squared reference term is found using the identity $\\int_0^T (C\\cos\\omega t+S\\sin\\omega t)^2 dt = (C^2+S^2)T/2$:\n$\\int_0^T T_{\\mathrm{ref}}(t)^2 dt = (-EAk)^2 \\frac{T}{2} [(1+\\cos\\delta)^2 + (\\sin\\delta)^2] = (EAk)^2 \\frac{T}{2} [1+2\\cos\\delta+\\cos^2\\delta+\\sin^2\\delta]$\n$= (EAk)^2 \\frac{T}{2} [2+2\\cos\\delta] = T(EAk)^2(1+\\cos\\delta)$.\n\nThe squared error is the ratio of these integrated quantities:\n$\\varepsilon_{1\\mathrm{D}}^2 = \\frac{2T(EAk)^2}{T(EAk)^2(1+\\cos\\delta)} = \\frac{2}{1+\\cos\\delta}$.\nUsing the half-angle identity $1+\\cos\\delta = 2\\cos^2(\\delta/2)$, we get:\n$\\varepsilon_{1\\mathrm{D}}^2 = \\frac{2}{2\\cos^2(\\delta/2)} = \\sec^2(\\delta/2)$.\nSince $\\delta \\in [0, \\pi)$, $\\delta/2 \\in [0, \\pi/2)$, where cosine is non-negative, the error is:\n$\\varepsilon_{1\\mathrm{D}} = \\frac{1}{\\cos(\\delta/2)}$.\nThis result is independent of all physical parameters $A, \\rho, E, L, n$ and depends only on the phase shift $\\delta$.\n\n**2. Analysis for the $2\\mathrm{D}$ Cases**\n\nThe displacement field is a superposition of two counter-propagating plane waves, expressed as $u(x,y,t) = A \\left[ \\cos(\\Psi_{in}) + \\cos(\\Psi_{out}) \\right] d$, where $\\Psi_{in} = \\omega t - k s$, $\\Psi_{out} = \\omega t + k s + \\delta$, $s = x\\cos\\theta + y\\sin\\theta$, and $d$ is the polarization vector. At the boundary $x=0$, $s=y\\sin\\theta$.\n\nWe define functions $S(t,y) = \\sin(\\omega t - ky\\sin\\theta) + \\sin(\\omega t + ky\\sin\\theta + \\delta)$ and $D(t,y) = \\sin(\\omega t - ky\\sin\\theta) - \\sin(\\omega t + ky\\sin\\theta + \\delta)$.\nThe velocity and spatial derivatives at $x=0$ are:\n$v(0,y,t) = u_t = -A\\omega S(t,y) d$\n$\\frac{\\partial u}{\\partial x}(0,y,t) = Ak\\cos\\theta D(t,y) d$\n$\\frac{\\partial u}{\\partial y}(0,y,t) = Ak\\sin\\theta D(t,y) d$\n\nThe functions $S$ and $D$ are orthogonal over one temporal period $T=2\\pi/\\omega$ and one spatial period $Y_{\\mathrm{per}}=2\\pi/(k\\sin\\theta)$, i.e., $\\int_0^T \\int_0^{Y_{\\mathrm{per}}} S(t,y)D(t,y) dy dt = 0$. The integrals of their squares are $\\int\\int S^2 dy dt = \\int\\int D^2 dy dt = T Y_{\\mathrm{per}}$. Because of this orthogonality, the integrated norm of a residual of the form $r = D(t,y) V_1 - S(t,y) V_2$ simplifies to $\\int\\int \\|r\\|^2 dy dt = (\\|V_1\\|^2 + \\|V_2\\|^2) T Y_{\\mathrm{per}}$.\n\n**2.1. 2D P-wave Analysis**\nPolarization $d=p=(\\cos\\theta, \\sin\\theta)$. Required strain components at $x=0$:\n$\\varepsilon_{xx} = Ak D(t,y)\\cos^2\\theta$, $\\varepsilon_{yy} = Ak D(t,y)\\sin^2\\theta$, $\\varepsilon_{xy} = Ak D(t,y)\\sin\\theta\\cos\\theta$.\nThe continuum traction $t = (\\sigma_{xx}, \\sigma_{xy})$ is:\n$\\sigma_{xx} = (\\lambda+2\\mu)\\varepsilon_{xx}+\\lambda\\varepsilon_{yy} = AkD(t,y)[(\\lambda+2\\mu)\\cos^2\\theta+\\lambda\\sin^2\\theta]$.\n$\\sigma_{xy} = 2\\mu\\varepsilon_{xy} = AkD(t,y)[2\\mu\\sin\\theta\\cos\\theta]$.\nUsing $\\lambda+2\\mu=\\rho c_p^2$ and $\\mu=\\rho c_s^2$, $t=AkD(t,y) V_t$ where $V_t = \\rho \\begin{pmatrix} c_p^2\\cos^2\\theta + (\\frac{\\lambda}{\\rho})\\sin^2\\theta \\\\ c_s^2 \\sin(2\\theta) \\end{pmatrix}$.\nThe velocity components are $v_x = -A\\omega S(t,y)\\cos\\theta$ and $v_y = -A\\omega S(t,y)\\sin\\theta$. With $\\omega=c_p k$, the LK traction $t_{\\mathrm{LK}}=(-\\rho c_p v_x, -\\rho c_s v_y)$ becomes $t_{\\mathrm{LK}} = AkS(t,y) V_{\\mathrm{LK}}$ where $V_{\\mathrm{LK}} = \\rho\\begin{pmatrix} c_p^2\\cos\\theta \\\\ c_p c_s \\sin\\theta \\end{pmatrix}$.\nThe residual is $r=t-t_{\\mathrm{LK}} = Ak[D(t,y)V_t - S(t,y)V_{\\mathrm{LK}}]$.\nThe squared error becomes:\n$\\varepsilon_{2\\mathrm{D},P}^2 = \\frac{\\int\\int \\|r\\|^2 dy dt}{\\int\\int \\|t_{\\mathrm{LK}}\\|^2 dy dt} = \\frac{(Ak)^2 T Y_{\\mathrm{per}}(\\|V_t\\|^2+\\|V_{\\mathrm{LK}}\\|^2)}{(Ak)^2 T Y_{\\mathrm{per}} \\|V_{\\mathrm{LK}}\\|^2} = 1 + \\frac{\\|V_t\\|^2}{\\|V_{\\mathrm{LK}}\\|^2}$.\n\n**2.2. 2D S-wave Analysis**\nPolarization $d=s=(-\\sin\\theta, \\cos\\theta)$. Required strain components at $x=0$:\n$\\varepsilon_{xx} = -Ak D(t,y)\\sin\\theta\\cos\\theta$, $\\varepsilon_{yy} = Ak D(t,y)\\sin\\theta\\cos\\theta$, so $\\mathrm{tr}(\\varepsilon)=0$.\n$\\varepsilon_{xy} = \\frac{1}{2}Ak D(t,y) (\\cos^2\\theta-\\sin^2\\theta) = \\frac{1}{2}AkD(t,y)\\cos(2\\theta)$.\nContinuum traction $t=(\\sigma_{xx}, \\sigma_{xy})$ becomes $t = AkD(t,y) W_t$ where $W_t = \\rho c_s^2 \\begin{pmatrix} -\\sin(2\\theta) \\\\ \\cos(2\\theta) \\end{pmatrix}$.\nVelocity components are $v_x = A\\omega S(t,y)\\sin\\theta$ and $v_y = -A\\omega S(t,y)\\cos\\theta$. With $\\omega=c_s k$, the LK traction $t_{\\mathrm{LK}}$ becomes $t_{\\mathrm{LK}} = AkS(t,y) W_{\\mathrm{LK}}$ where $W_{\\mathrm{LK}} = \\rho\\begin{pmatrix} -c_p c_s \\sin\\theta \\\\ c_s^2 \\cos\\theta \\end{pmatrix}$.\nThe error expression has the same form: $\\varepsilon_{2\\mathrm{D},S}^2 = 1+\\frac{\\|W_t\\|^2}{\\|W_{\\mathrm{LK}}\\|^2}$.\nThe norm $\\|W_t\\|^2 = (\\rho c_s^2)^2$. The final expression for the squared error is:\n$\\varepsilon_{2\\mathrm{D},S}^2 = 1 + \\frac{(\\rho c_s^2)^2}{\\rho^2(c_p^2 c_s^2 \\sin^2\\theta + c_s^4 \\cos^2\\theta)} = 1 + \\frac{c_s^2}{c_p^2\\sin^2\\theta + c_s^2\\cos^2\\theta}$.\n\n**Numerical Evaluation**\n- Case $1$: $1\\mathrm{D}$, $\\delta=0$. $\\varepsilon_{1\\mathrm{D}} = 1/\\cos(0) = 1$.\n- Case $2$: $1\\mathrm{D}$, $\\delta=\\pi/2$. $\\varepsilon_{1\\mathrm{D}} = 1/\\cos(\\pi/4) = \\sqrt{2} \\approx 1.414214$.\n- Case $3$: $1\\mathrm{D}$, $\\delta=0.9\\pi$. $\\varepsilon_{1\\mathrm{D}} = 1/\\cos(0.45\\pi) \\approx 6.392453$.\n- Case $4$: $2\\mathrm{D}$ P-wave. $\\rho=2000$, $\\lambda=2\\cdot 10^9$, $\\mu=1\\cdot 10^9$, $\\theta=30^\\circ$. This gives $c_p^2 = 2\\cdot 10^6$ and $c_s^2 = 0.5\\cdot 10^6$, so $c_p^2=4c_s^2$. For this specific material property, it can be proven that $\\|V_t\\|^2 = \\|V_{\\mathrm{LK}}\\|^2$ for any angle $\\theta$. Thus $\\varepsilon_{2\\mathrm{D},P}^2 = 1+1=2$, which gives $\\varepsilon_{2\\mathrm{D},P}=\\sqrt{2} \\approx 1.414214$.\n- Case $5$: $2\\mathrm{D}$ S-wave. Same material properties, $\\theta=75^\\circ$.\n$\\varepsilon_{2\\mathrm{D},S}^2 = 1 + \\frac{1}{(c_p^2/c_s^2)\\sin^2\\theta+\\cos^2\\theta} = 1 + \\frac{1}{4\\sin^2(75^\\circ)+\\cos^2(75^\\circ)} = 1+\\frac{1}{1+3\\sin^2(75^\\circ)}$.\nThis evaluates to $\\varepsilon_{2\\mathrm{D},S} \\approx 1.123932$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_1d_error(delta):\n    \"\"\"\n    Computes the dimensionless LK error for the 1D case.\n    The error is analytically found to be 1 / cos(delta/2).\n    \"\"\"\n    if np.cos(delta / 2.0) == 0:\n        return np.inf\n    return 1.0 / np.cos(delta / 2.0)\n\ndef calculate_2d_p_wave_error(rho, lam, mu, theta_deg):\n    \"\"\"\n    Computes the dimensionless LK error for the 2D P-wave case.\n    \"\"\"\n    cp2 = (lam + 2.0 * mu) / rho\n    cs2 = mu / rho\n    cp = np.sqrt(cp2)\n    cs = np.sqrt(cs2)\n    \n    theta_rad = np.radians(theta_deg)\n    s = np.sin(theta_rad)\n    c = np.cos(theta_rad)\n    s2t = np.sin(2.0 * theta_rad)\n\n    # Vector V_t (proportional to continuum traction) components\n    vt_x = cp2 - 2.0 * cs2 * s**2\n    vt_y = cs2 * s2t\n    norm_vt_sq = vt_x**2 + vt_y**2\n\n    # Vector V_LK (proportional to LK traction) components\n    vlk_x = cp2 * c\n    vlk_y = cp * cs * s\n    norm_vlk_sq = vlk_x**2 + vlk_y**2\n\n    if norm_vlk_sq == 0:\n        return np.inf\n\n    err_sq = 1.0 + norm_vt_sq / norm_vlk_sq\n    return np.sqrt(err_sq)\n\ndef calculate_2d_s_wave_error(rho, lam, mu, theta_deg):\n    \"\"\"\n    Computes the dimensionless LK error for the 2D S-wave case.\n    \"\"\"\n    cp2 = (lam + 2.0 * mu) / rho\n    cs2 = mu / rho\n    \n    theta_rad = np.radians(theta_deg)\n    s_sq = np.sin(theta_rad)**2\n    c_sq = np.cos(theta_rad)**2\n    \n    denominator = cp2 * s_sq + cs2 * c_sq\n    if denominator == 0:\n        return np.inf\n\n    err_sq = 1.0 + cs2 / denominator\n    return np.sqrt(err_sq)\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': 0}},\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': np.pi/2}},\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': 0.9*np.pi}},\n        {'type': '2D_P', 'params': {'rho': 2000, 'lambda': 2e9, 'mu': 1e9, 'L': 100, 'A': 0.001, 'n': 1, 'delta': np.pi/3, 'theta': 30}},\n        {'type': '2D_S', 'params': {'rho': 2000, 'lambda': 2e9, 'mu': 1e9, 'L': 100, 'A': 0.001, 'n': 1, 'delta': 0.8*np.pi, 'theta': 75}},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == '1D':\n            result = calculate_1d_error(case['params']['delta'])\n        elif case['type'] == '2D_P':\n            p = case['params']\n            result = calculate_2d_p_wave_error(p['rho'], p['lambda'], p['mu'], p['theta'])\n        elif case['type'] == '2D_S':\n            p = case['params']\n            result = calculate_2d_s_wave_error(p['rho'], p['lambda'], p['mu'], p['theta'])\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n        \n        results.append(result)\n\n    # Format results to six decimal places for the final output.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3569961"}]}