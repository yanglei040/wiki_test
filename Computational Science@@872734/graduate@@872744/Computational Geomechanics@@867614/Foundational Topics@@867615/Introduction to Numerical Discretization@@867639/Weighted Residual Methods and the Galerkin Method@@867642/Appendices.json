{"hands_on_practices": [{"introduction": "The Galerkin method transforms governing differential equations into integral forms that must be evaluated over each element. This first exercise focuses on a fundamental step in this process: numerical integration. By analyzing the polynomial degree of the terms within an element stiffness matrix, you will determine the minimum required order for Gaussian quadrature to compute the integral exactly, a crucial skill for implementing accurate and efficient finite element models [@problem_id:3571272].", "problem": "A homogeneous plane strain soil specimen with elastic behavior is modeled by a single isoparametric $Q_2$ (biquadratic) quadrilateral finite element using the Galerkin method within the Finite Element Method (FEM). The specimen occupies a subdomain $\\Omega_e \\subset \\mathbb{R}^2$, and the constitutive matrix for linear elasticity in plane strain, denoted by $\\boldsymbol{D}$, is constant throughout $\\Omega_e$. The weak form of equilibrium leads to the element stiffness matrix with entries\n$$\nK_{ij} = \\int_{\\Omega_e} \\boldsymbol{B}_i^{T} \\boldsymbol{D} \\boldsymbol{B}_j \\,\\mathrm{d}\\Omega,\n$$\nwhere $\\boldsymbol{B}_i$ are the strain-displacement matrices associated with the shape functions.\n\nAssume an affine mapping from the parent square $[-1,1]\\times[-1,1]$ in the natural coordinates $(\\xi,\\eta)$ to the physical element, so that the Jacobian matrix $\\boldsymbol{J}$ and its determinant $\\det\\boldsymbol{J}$ are constant over the element. The $Q_2$ shape functions are the standard tensor-product quadratic Lagrange polynomials in $(\\xi,\\eta)$, and the Gaussian quadrature employed is the tensor-product Gauss–Legendre rule with $n$ points in each parametric direction.\n\nUsing the Galerkin method and the polynomial degree of the integrand in the natural coordinates under the stated assumptions, determine the minimal integer $n$ (the Gaussian quadrature order per direction) required to exactly integrate all entries of the stiffness matrix $K_{ij}$. Provide a justification that identifies the highest polynomial degree present in each parametric direction of the integrand and uses the exactness property of Gauss–Legendre quadrature. Express your final answer as the integer $n$.", "solution": "The starting point is the strong form of linear elasticity in plane strain for a homogeneous body with no body forces,\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0},\n$$\ntogether with the constitutive law and kinematic relations\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{D}\\,\\boldsymbol{\\epsilon}, \\qquad \\boldsymbol{\\epsilon} = \\boldsymbol{L}\\,\\boldsymbol{u},\n$$\nwhere $\\boldsymbol{\\sigma}$ is the stress vector, $\\boldsymbol{\\epsilon}$ is the strain vector, $\\boldsymbol{u}$ is the displacement vector, $\\boldsymbol{D}$ is the constant constitutive matrix for plane strain, and $\\boldsymbol{L}$ is the differential operator mapping displacements to strains. In the weighted residual framework with the Galerkin choice (test functions equal to trial shape functions), the weak form over an element $\\Omega_e$ yields the element stiffness matrix\n$$\nK_{ij} = \\int_{\\Omega_e} \\boldsymbol{B}_i^{T} \\boldsymbol{D} \\boldsymbol{B}_j \\,\\mathrm{d}\\Omega,\n$$\nwhere $\\boldsymbol{B}_i$ is the strain-displacement matrix associated with the $i$-th shape function.\n\nIntroduce the isoparametric mapping from the parent domain $(\\xi,\\eta) \\in [-1,1]\\times[-1,1]$ to the physical coordinates $(x,y)$ by\n$$\nx(\\xi,\\eta) = \\sum_{a=1}^{n_n} N_a(\\xi,\\eta)\\, x_a, \\qquad y(\\xi,\\eta) = \\sum_{a=1}^{n_n} N_a(\\xi,\\eta)\\, y_a,\n$$\nwhere $N_a(\\xi,\\eta)$ are the $Q_2$ shape functions and $n_n=9$ is the number of nodes of a biquadratic quadrilateral. Under the affine mapping assumption, the Jacobian matrix\n$$\n\\boldsymbol{J}(\\xi,\\eta) = \n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n$$\nand its determinant $\\det\\boldsymbol{J}$ are constant over the element. The chain rule relates derivatives with respect to physical coordinates $(x,y)$ to those with respect to natural coordinates $(\\xi,\\eta)$ via\n$$\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x} \\\\\n\\frac{\\partial}{\\partial y}\n\\end{pmatrix}\n=\n\\boldsymbol{J}^{-1}\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial \\xi} \\\\\n\\frac{\\partial}{\\partial \\eta}\n\\end{pmatrix},\n$$\nso that the strain-displacement matrices satisfy\n$$\n\\boldsymbol{B}_i = \\boldsymbol{T}\\,\\boldsymbol{J}^{-1}\\,\\boldsymbol{G}_i(\\xi,\\eta),\n$$\nwhere $\\boldsymbol{T}$ is a constant matrix assembling the Cartesian derivatives into the strain components, and $\\boldsymbol{G}_i(\\xi,\\eta)$ collects the natural derivatives $\\frac{\\partial N_i}{\\partial \\xi}$ and $\\frac{\\partial N_i}{\\partial \\eta}$ in the appropriate positions.\n\nTransforming the stiffness integral to the parent domain gives\n$$\nK_{ij} = \\int_{-1}^{1}\\int_{-1}^{1} \n\\left(\\boldsymbol{T}\\,\\boldsymbol{J}^{-1}\\,\\boldsymbol{G}_i(\\xi,\\eta)\\right)^{T}\n\\boldsymbol{D}\n\\left(\\boldsymbol{T}\\,\\boldsymbol{J}^{-1}\\,\\boldsymbol{G}_j(\\xi,\\eta)\\right)\n\\,\\det\\boldsymbol{J}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\nUnder the affine mapping assumption, $\\boldsymbol{J}$, $\\boldsymbol{J}^{-1}$, $\\det\\boldsymbol{J}$, $\\boldsymbol{T}$, and $\\boldsymbol{D}$ are constant, so the integrand reduces to a constant matrix sandwiched around products of the natural derivatives of shape functions:\n$$\nK_{ij} = \\det\\boldsymbol{J}\\,\n\\int_{-1}^{1}\\int_{-1}^{1} \n\\boldsymbol{G}_i(\\xi,\\eta)^{T}\n\\left(\\boldsymbol{J}^{-T}\\boldsymbol{T}^{T}\\boldsymbol{D}\\,\\boldsymbol{T}\\,\\boldsymbol{J}^{-1}\\right)\n\\boldsymbol{G}_j(\\xi,\\eta)\\,\n\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\nTherefore, the polynomial degree of the integrand in $(\\xi,\\eta)$ is governed solely by the degrees of the components of $\\boldsymbol{G}_i(\\xi,\\eta)$ and $\\boldsymbol{G}_j(\\xi,\\eta)$, i.e., the natural derivatives of the $Q_2$ shape functions.\n\nFor the tensor-product $Q_2$ basis, each shape function is of the form\n$$\nN(\\xi,\\eta) = L_p(\\xi)\\,L_q(\\eta),\n$$\nwhere $L_p(\\xi)$ and $L_q(\\eta)$ are one-dimensional quadratic Lagrange polynomials. Hence,\n$$\n\\frac{\\partial N}{\\partial \\xi} = L_p'(\\xi)\\,L_q(\\eta), \\qquad\n\\frac{\\partial N}{\\partial \\eta} = L_p(\\xi)\\,L_q'(\\eta).\n$$\nSince $L_p'(\\xi)$ is linear in $\\xi$ (degree $1$) and $L_q(\\eta)$ is quadratic in $\\eta$ (degree $2$), it follows that\n$$\n\\frac{\\partial N}{\\partial \\xi} \\in \\mathcal{P}_1(\\xi)\\otimes \\mathcal{P}_2(\\eta),\n$$\nand similarly\n$$\n\\frac{\\partial N}{\\partial \\eta} \\in \\mathcal{P}_2(\\xi)\\otimes \\mathcal{P}_1(\\eta),\n$$\nwhere $\\mathcal{P}_k$ denotes polynomials of degree at most $k$ in the indicated variable. The integrand $\\boldsymbol{G}_i^{T}(\\cdot)\\,(\\cdot)\\,\\boldsymbol{G}_j(\\cdot)$ is a sum of products of these components. The possible products and their degrees in each variable are:\n- Terms involving $\\left(\\frac{\\partial N}{\\partial \\xi}\\right)^2$: degree $2$ in $\\xi$ (since $1+1=2$) and degree $4$ in $\\eta$ (since $2+2=4$).\n- Terms involving $\\left(\\frac{\\partial N}{\\partial \\eta}\\right)^2$: degree $4$ in $\\xi$ and degree $2$ in $\\eta$.\n- Mixed terms $\\frac{\\partial N}{\\partial \\xi}\\,\\frac{\\partial N}{\\partial \\eta}$: degree $3$ in $\\xi$ (since $1+2=3$) and degree $3$ in $\\eta$ (since $2+1=3$).\n\nThus, the highest polynomial degree appearing in either parametric direction within the integrand is $4$. Because $\\det\\boldsymbol{J}$ and the matrices are constant under the affine mapping, this maximal degree is not altered by the constant factors.\n\nThe two-dimensional tensor-product Gauss–Legendre quadrature with $n$ points per direction is exact for polynomials up to degree $2n-1$ in each variable separately. To integrate polynomials of degree up to $4$ in both $\\xi$ and $\\eta$, we require\n$$\n2n - 1 \\geq 4 \\quad \\Longrightarrow \\quad n \\geq 3.\n$$\nTherefore, the minimal integer $n$ that guarantees exact integration of all stiffness matrix entries under the stated assumptions is $n=3$.", "answer": "$$\\boxed{3}$$", "id": "3571272"}, {"introduction": "While exact integration is ideal, reduced integration is often employed to improve computational efficiency and element performance. This practice explores the potential dangers of this technique, specifically the creation of non-physical, zero-energy deformation modes known as \"hourglass\" modes. You will analyze how using a single Gauss point for a bilinear quadrilateral element leads to a rank-deficient stiffness matrix, providing critical insight into the numerical stability of finite element formulations [@problem_id:3571287].", "problem": "Consider a homogeneous, linear-elastic, plane-strain body discretized by a single isoparametric bilinear quadrilateral element ($Q_1$) with nodes labeled counterclockwise as $1$–$4$ in the parent domain $\\left[-1,1\\right]^2$. Using the Galerkin weighted residual method (Finite Element Method (FEM) with the Galerkin choice of weight functions equal to the trial shape functions), the element stiffness matrix $K_e$ is obtained from the weak form of equilibrium as\n$$\nK_e \\;=\\; \\int_{\\Omega_e} B^T D B \\, \\mathrm{d}\\Omega,\n$$\nwhere $B$ is the strain-displacement matrix, $D$ is the plane-strain elastic constitutive matrix (positive-definite for a stable material), and $\\Omega_e$ is the element domain. In reduced (one-point) Gauss integration, the integral is approximated at the element center $\\left(\\xi,\\eta\\right)=\\left(0,0\\right)$ as\n$$\nK_e^{(RI)} \\;\\approx\\; w\\,\\det J(0,0)\\, B(0,0)^T\\, D\\, B(0,0),\n$$\nwhere $J$ is the isoparametric Jacobian and $w>0$ is the quadrature weight. For a non-degenerate element (i.e., $\\det J(0,0) \\neq 0$), analyze the effect of this reduced integration on the $Q_1$ plane-strain element by identifying the hourglass modes and explaining their relation to the rank deficiency of $K_e^{(RI)}$. Assume small strains and linear kinematics.\n\nWhich of the following statements are correct? Select all that apply.\n\nA. For a generic non-degenerate isoparametric $Q_1$ plane-strain element with one-point reduced integration, the element stiffness matrix $K_e^{(RI)}$ has rank $3$, implying exactly $2$ linearly independent hourglass modes in addition to the $3$ rigid-body modes.\n\nB. On an affine-mapped (parallelogram) $Q_1$ element, one-point reduced integration eliminates hourglass modes because the strain field is constant, so $K_e^{(RI)}$ is full rank.\n\nC. A basis for the hourglass subspace can be taken as nodal displacement patterns proportional to $\\left[+1,\\,-1,\\,+1,\\,-1\\right]$ applied to $u_x$ (with $u_y=0$) and independently to $u_y$ (with $u_x=0$); each produces zero strain at the Gauss point for any element shape with $\\det J(0,0)\\neq 0$.\n\nD. The hourglass modes arise because the Galerkin weak form evaluated with one Gauss point mis-integrates nonzero constant-strain fields; the spurious modes correspond to constant-strain mechanisms.\n\nE. In plane strain, because the strain vector has dimension $3$, the product $K_e^{(RI)} = B(0,0)^T D B(0,0)$ has rank at most $3$. For a generic non-degenerate element, this explains the rank deficiency and the existence of non-rigid zero-energy modes.", "solution": "The user has provided a problem statement regarding the numerical properties of a single isoparametric bilinear quadrilateral element ($Q_1$) in plane strain, specifically when using one-point reduced integration. The task is to validate the problem and then analyze the provided statements.\n\n### Problem Validation\n\nThe problem statement is valid. It is scientifically grounded in the well-established theory of the Finite Element Method (FEM) as applied to computational solid mechanics. All terms, such as \"isoparametric bilinear quadrilateral element,\" \"plane strain,\" \"Galerkin weighted residual method,\" \"element stiffness matrix,\" \"reduced integration,\" and \"hourglass modes,\" are standard and unambiguously defined within this field. The provided equations for the exact and reduced-integration stiffness matrices are correct. The problem is well-posed, asking for a standard analysis of a known numerical artifact (hourglassing) under clearly specified conditions. It is objective and self-contained, providing sufficient information for a rigorous mathematical derivation.\n\n### Derivation\n\nA plane-strain bilinear quadrilateral element ($Q_1$) has $4$ nodes, with $2$ degrees of freedom (DOFs) per node ($u_x, u_y$). The element thus has a total of $4 \\times 2 = 8$ DOFs. The nodal displacement vector $\\mathbf{u}_e$ is an $8 \\times 1$ vector. The element stiffness matrix, $K_e$, is an $8 \\times 8$ matrix.\n\nFor a linear elastic material in plane strain, the strain vector is $\\boldsymbol{\\epsilon} = [\\epsilon_x, \\epsilon_y, \\gamma_{xy}]^T$, which has dimension $3$. The constitutive matrix $D$ is a $3 \\times 3$ symmetric, positive-definite matrix. The strain-displacement relationship is given by $\\boldsymbol{\\epsilon} = B \\mathbf{u}_e$, where $B$ is the $3 \\times 8$ strain-displacement matrix. The entries of $B$ are functions of the derivatives of the shape functions $N_i$ with respect to the physical coordinates $(x,y)$.\n\nThe element stiffness matrix under one-point (reduced) Gaussian integration is approximated at the center of the parent element, $(\\xi, \\eta) = (0,0)$:\n$$\nK_e^{(RI)} = w\\,\\det J(0,0)\\, B(0,0)^T\\, D\\, B(0,0)\n$$\nHere, $w$ is the positive quadrature weight (for one-point integration in a $[-1,1]^2$ domain, $w=4$), and $J(0,0)$ is the Jacobian of the isoparametric mapping evaluated at the center. For a non-degenerate element, $\\det J(0,0) > 0$. Let $c = w\\,\\det J(0,0)$. Since $c > 0$, the rank of $K_e^{(RI)}$ is determined by the rank of the matrix product $B(0,0)^T D B(0,0)$.\n\nThe rank of $K_e^{(RI)}$ can be analyzed as follows:\n$\\text{rank}(K_e^{(RI)}) = \\text{rank}(B(0,0)^T D B(0,0))$. Since $D$ is a $3 \\times 3$ positive-definite matrix, it is full rank, and we can write $D = L L^T$ where $L$ is a nonsingular $3 \\times 3$ matrix (e.g., from Cholesky decomposition). Then,\n$$\n\\text{rank}(K_e^{(RI)}) = \\text rank(B(0,0)^T L L^T B(0,0)) = \\text{rank}((L^T B(0,0))^T (L^T B(0,0))) = \\text{rank}(L^T B(0,0))\n$$\nBecause $L^T$ is nonsingular (rank $3$), the rank is further simplified to:\n$$\n\\text{rank}(K_e^{(RI)}) = \\text{rank}(B(0,0))\n$$\nThe matrix $B(0,0)$ is a $3 \\times 8$ matrix. The rank of any matrix is at most the minimum of its number of rows and columns. Therefore, $\\text{rank}(B(0,0)) \\le \\min(3, 8) = 3$. For a generic (non-pathological) element geometry, the three rows of $B(0,0)$ are linearly independent. Thus, for a generic element, $\\text{rank}(K_e^{(RI)}) = 3$.\n\nThe number of zero-energy modes of the element is the dimension of the null space of $K_e^{(RI)}$. By the rank-nullity theorem, for the $8 \\times 8$ matrix $K_e^{(RI)}$:\n$$\n\\dim(\\text{null}(K_e^{(RI)})) = \\text{Total DOFs} - \\text{rank}(K_e^{(RI)}) = 8 - 3 = 5.\n$$\nThese 5 modes are displacement patterns $\\mathbf{u}_e$ for which the strain energy, as computed by reduced integration, is zero.\n\nThe zero-energy modes consist of rigid-body modes and spurious (hourglass) modes. For a 2D body, there are always $3$ rigid-body modes (two translations and one in-plane rotation) which produce zero strain everywhere and thus have zero strain energy.\n$$\n\\text{Number of hourglass modes} = (\\text{Total zero-energy modes}) - (\\text{Rigid-body modes}) = 5 - 3 = 2.\n$$\nA stable element (after accounting for rigid-body motion) should have a stiffness matrix of rank $8 - 3 = 5$. The rank of $3$ indicates a rank deficiency of $5-3=2$, corresponding to the two spurious hourglass modes.\n\n### Option-by-Option Analysis\n\n**A. For a generic non-degenerate isoparametric $Q_1$ plane-strain element with one-point reduced integration, the element stiffness matrix $K_e^{(RI)}$ has rank $3$, implying exactly $2$ linearly independent hourglass modes in addition to the $3$ rigid-body modes.**\nThis statement is a direct consequence of the derivation above. The rank of $K_e^{(RI)}$ is $3$. The null space has dimension $8-3=5$. This null space is spanned by $3$ rigid-body modes and $2$ additional, spurious, linearly independent modes, which are the hourglass modes. The statement is entirely correct.\n**Verdict: Correct**\n\n**B. On an affine-mapped (parallelogram) $Q_1$ element, one-point reduced integration eliminates hourglass modes because the strain field is constant, so $K_e^{(RI)}$ is full rank.**\nThis statement contains several falsehoods. First, for a $Q_1$ element, even with an affine map (constant Jacobian $J$), the strain field is not constant. The derivatives of the bilinear shape functions are linear functions of the parent coordinates, so the strains are also linear. Second, one-point integration does not eliminate hourglassing for any non-degenerate $Q_1$ element, affine-mapped or not. The mechanism analyzed above, which leads to rank deficiency, is independent of whether the Jacobian is constant. Third, as a result, $K_e^{(RI)}$ is not full rank (i.e., rank $5$ after removing rigid-body modes); its rank is $3$.\n**Verdict: Incorrect**\n\n**C. A basis for the hourglass subspace can be taken as nodal displacement patterns proportional to $\\left[+1,\\,-1,\\,+1,\\,-1\\right]$ applied to $u_x$ (with $u_y=0$) and independently to $u_y$ (with $u_x=0$); each produces zero strain at the Gauss point for any element shape with $\\det J(0,0)\\neq 0$.**\nLet the nodal vector be $\\boldsymbol{\\psi} = [1, -1, 1, -1]^T$ for nodes $1,2,3,4$.\nConsider the mode $\\mathbf{u}_e$ where $u_{xi} = c \\psi_i$ and $u_{yi}=0$. The strain at the center $(\\xi, \\eta)=(0,0)$ is $\\boldsymbol{\\epsilon}(0,0) = B(0,0) \\mathbf{u}_e$. We must check if this product is zero. The strain components are:\n$\\epsilon_x(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial x}|_{(0,0)} u_{xi} = c \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial x}|_{(0,0)} \\psi_i$.\n$\\epsilon_y(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial y}|_{(0,0)} u_{yi} = 0$.\n$\\gamma_{xy}(0,0) = \\sum_{i=1}^4 \\left(\\frac{\\partial N_i}{\\partial y}|_{(0,0)} u_{xi} + \\frac{\\partial N_i}{\\partial x}|_{(0,0)} u_{yi}\\right) = c \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial y}|_{(0,0)} \\psi_i$.\nThe derivatives of the shape functions at the center are $\\frac{\\partial N_i}{\\partial \\xi}|_{(0,0)} = \\frac{1}{4}\\xi_i$ and $\\frac{\\partial N_i}{\\partial \\eta}|_{(0,0)} = \\frac{1}{4}\\eta_i$. Using the inverse Jacobian rule, $\\frac{\\partial N_i}{\\partial x}|_{(0,0)}$ is a linear combination of $\\xi_i$ and $\\eta_i$, and so is $\\frac{\\partial N_i}{\\partial y}|_{(0,0)}$. The sums $\\sum_{i=1}^4 \\xi_i \\psi_i$ and $\\sum_{i=1}^4 \\eta_i \\psi_i$ are:\n$\\sum \\xi_i \\psi_i = (-1)(1) + (1)(-1) + (1)(1) + (-1)(-1) = -1 - 1 + 1 + 1 = 0$.\n$\\sum \\eta_i \\psi_i = (-1)(1) + (-1)(-1) + (1)(1) + (1)(-1) = -1 + 1 + 1 - 1 = 0$.\nSince these sums are zero, any linear combination of them is also zero. Thus, all strain components at $(0,0)$ are zero. The same logic applies to the mode with $u_{xi}=0$ and $u_{yi} = c\\psi_i$. These two modes are not rigid-body motions and are linearly independent. As we found there are exactly two hourglass modes, these two patterns form a valid basis for the hourglass subspace. This holds for any non-degenerate element.\n**Verdict: Correct**\n\n**D. The hourglass modes arise because the Galerkin weak form evaluated with one Gauss point mis-integrates nonzero constant-strain fields; the spurious modes correspond to constant-strain mechanisms.**\nThis statement mischaracterizes the phenomenon. One-point quadrature correctly evaluates the energy of constant strain fields. The rank $3$ of $K_e^{(RI)}$ corresponds to its ability to represent the three-dimensional space of constant plane-strain states. Hourglass modes are not constant-strain mechanisms. They are higher-order deformation patterns (e.g., for a rectangular element, the hourglass displacement field is proportional to $\\xi\\eta$) whose corresponding strain fields are non-zero but happen to be exactly zero at the single quadrature point. The integration rule thus estimates their strain energy as zero, which is incorrect.\n**Verdict: Incorrect**\n\n**E. In plane strain, because the strain vector has dimension $3$, the product $K_e^{(RI)} = B(0,0)^T D B(0,0)$ has rank at most $3$. For a generic non-degenerate element, this explains the rank deficiency and the existence of non-rigid zero-energy modes.**\nThis statement correctly identifies the fundamental source of the rank limitation. The stiffness matrix is formed by a product involving the $3 \\times 8$ matrix $B(0,0)$. The mapping from the $8$-dimensional nodal displacement space to the $3$-dimensional strain space at the Gauss point, represented by $B(0,0)$, inherently limits the rank of any subsequent matrix product to at most $3$. A stable element (without spurious modes) would require a rank of $8-3=5$. Since the rank is at most $3$, the matrix is necessarily rank-deficient. This deficiency is the mathematical cause for the existence of zero-energy modes beyond the rigid-body modes. The reasoning is sound. (Note: the problem omits the scalar factor $w \\det J(0,0)$, but this does not affect the rank).\n**Verdict: Correct**", "answer": "$$\\boxed{ACE}$$", "id": "3571287"}, {"introduction": "The power of the Galerkin method relies on selecting appropriate approximation spaces, especially for constrained problems like nearly incompressible elasticity, where a poor choice can lead to \"locking.\" This numerical artifact causes the element to become excessively stiff, yielding non-physical results. This exercise provides a hands-on demonstration of volumetric locking, showing how an apparently reasonable choice of linear elements imposes an overly restrictive constraint on the discrete solution and highlighting the critical need for stable element formulations in geomechanics [@problem_id:3571246].", "problem": "Consider a static, small-strain, plane-strain linear elasticity problem for a nearly incompressible geomaterial on the square domain $\\Omega = [0,1]\\times[0,1]$. The strong form consists of balance of linear momentum and linear elastic constitutive equations: find the displacement field $\\boldsymbol{u}:\\Omega\\rightarrow\\mathbb{R}^2$ such that $-\\nabla\\cdot\\boldsymbol{\\sigma}=\\boldsymbol{f}$ in $\\Omega$, with homogeneous Dirichlet boundary conditions $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\partial\\Omega$. The Cauchy stress is $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,\\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}))\\,\\boldsymbol{I}$, where $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$ is the small-strain tensor, $\\mu>0$ is the shear modulus, and $\\lambda\\gg\\mu$ is the first Lamé parameter (bulk-related modulus) modeling near-incompressibility.\n\nUsing the weighted residual method in the standard Galerkin sense, the weak form is: find $\\boldsymbol{u}\\in \\boldsymbol{V}=\\{\\boldsymbol{v}\\in [H^{1}(\\Omega)]^{2}:\\boldsymbol{v}=\\boldsymbol{0}\\text{ on }\\partial\\Omega\\}$ such that\n$$\na(\\boldsymbol{u},\\boldsymbol{v}) = \\ell(\\boldsymbol{v})\\quad \\text{for all }\\boldsymbol{v}\\in \\boldsymbol{V},\n$$\nwhere\n$$\na(\\boldsymbol{u},\\boldsymbol{v})=\\int_{\\Omega}\\big(2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{v})+\\lambda\\,(\\nabla\\cdot\\boldsymbol{u})(\\nabla\\cdot\\boldsymbol{v})\\big)\\,{\\mathrm d}\\Omega,\\quad\n\\ell(\\boldsymbol{v})=\\int_{\\Omega}\\boldsymbol{f}\\cdot\\boldsymbol{v}\\,{\\mathrm d}\\Omega.\n$$\n\nDiscretize $\\Omega$ with the conforming triangulation obtained by connecting the square’s center $(\\tfrac{1}{2},\\tfrac{1}{2})$ to its four vertices $(0,0)$, $(1,0)$, $(1,1)$, and $(0,1)$, yielding four triangles. Let the approximation space be the continuous, piecewise-linear Lagrange space for both displacement components (equal-order $P_{1}$ for the two components), that is, $\\boldsymbol{V}_{h}=[V_{h}]^{2}$ with $V_{h}=\\{v_{h}\\in C^{0}(\\overline{\\Omega})\\mid v_{h}|_{T}\\in \\mathbb{P}_{1}(T)\\ \\forall T\\}\\cap H^{1}_{0}(\\Omega)$. Impose homogeneous Dirichlet conditions at all four boundary vertices, so the only nonzero nodal displacement is at the interior node $(\\tfrac{1}{2},\\tfrac{1}{2})$.\n\nStarting from the above fundamental definitions, apply the Galerkin method to derive the discrete volumetric term and the discrete constraint on the volumetric strain for this mesh. In the limit $\\lambda\\to\\infty$ (nearly incompressible limit), the discrete solution must satisfy a vanishing volumetric strain in the $L^{2}$ sense element-wise. By examining the resulting element-wise constraints induced on the interior nodal displacement, determine the dimension of the discrete divergence-free subspace\n$$\n\\boldsymbol{Z}_{h}=\\{\\boldsymbol{u}_{h}\\in \\boldsymbol{V}_{h}\\mid (\\nabla\\cdot \\boldsymbol{u}_{h})|_{T}=0\\ \\text{for each triangle }T\\}.\n$$\n\nYour final answer must be the single integer equal to $\\dim(\\boldsymbol{Z}_{h})$. No intermediate results or derivations should be reported there. The answer is dimensionless and requires no rounding.", "solution": "The user wants me to critically validate a given problem and, if it is valid, provide a complete, reasoned solution.\n\n### Step 1: Extract Givens\n- **Problem Type**: Static, small-strain, plane-strain linear elasticity.\n- **Domain**: $\\Omega = [0,1]\\times[0,1]$.\n- **Governing Equation**: $-\\nabla\\cdot\\boldsymbol{\\sigma}=\\boldsymbol{f}$ in $\\Omega$.\n- **Boundary Conditions**: Homogeneous Dirichlet, $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\partial\\Omega$.\n- **Constitutive Law**: Cauchy stress $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,\\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}))\\,\\boldsymbol{I}$.\n- **Strain Tensor**: $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$.\n- **Material Parameters**: Shear modulus $\\mu>0$, first Lamé parameter $\\lambda\\gg\\mu$ (near-incompressibility).\n- **Weak Form**: Find $\\boldsymbol{u}\\in \\boldsymbol{V}$ such that $a(\\boldsymbol{u},\\boldsymbol{v}) = \\ell(\\boldsymbol{v})$ for all $\\boldsymbol{v}\\in \\boldsymbol{V}$.\n- **Function Space**: $\\boldsymbol{V}=\\{\\boldsymbol{v}\\in [H^{1}(\\Omega)]^{2}:\\boldsymbol{v}=\\boldsymbol{0}\\text{ on }\\partial\\Omega\\}$.\n- **Bilinear Form**: $a(\\boldsymbol{u},\\boldsymbol{v})=\\int_{\\Omega}\\big(2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{v})+\\lambda\\,(\\nabla\\cdot\\boldsymbol{u})(\\nabla\\cdot\\boldsymbol{v})\\big)\\,{\\mathrm d}\\Omega$.\n- **Linear Functional**: $\\ell(\\boldsymbol{v})=\\int_{\\Omega}\\boldsymbol{f}\\cdot\\boldsymbol{v}\\,{\\mathrm d}\\Omega$.\n- **Discretization**: Conforming triangulation of the square domain by connecting the center $(\\tfrac{1}{2},\\tfrac{1}{2})$ to the four vertices $(0,0)$, $(1,0)$, $(1,1)$, and $(0,1)$, creating four triangles.\n- **Approximation Space**: $\\boldsymbol{V}_{h}=[V_{h}]^{2}$ with $V_{h}=\\{v_{h}\\in C^{0}(\\overline{\\Omega})\\mid v_{h}|_{T}\\in \\mathbb{P}_{1}(T)\\ \\forall T\\}\\cap H^{1}_{0}(\\Omega)$. This is the space of continuous, piecewise-linear vector functions satisfying the homogeneous boundary conditions.\n- **Nodal DOFs**: Homogeneous Dirichlet conditions are imposed on the four boundary vertices. The only non-zero nodal displacement is at the interior node $(\\tfrac{1}{2},\\tfrac{1}{2})$.\n- **Objective**: Determine the dimension of the discrete divergence-free subspace $\\boldsymbol{Z}_{h}=\\{\\boldsymbol{u}_{h}\\in \\boldsymbol{V}_{h}\\mid (\\nabla\\cdot \\boldsymbol{u}_{h})|_{T}=0\\ \\text{for each triangle }T\\}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard textbook exercise in the finite element analysis of nearly incompressible elasticity.\n- **Scientifically Grounded**: The problem is based on the well-established theory of linear elasticity and the finite element method (specifically the Galerkin method). The concept of \"locking\" for low-order elements in the incompressible limit is a canonical topic in computational mechanics. All principles are sound.\n- **Well-Posed**: The problem is clearly stated and asks for a specific, calculable quantity (the dimension of a vector subspace). A unique solution exists.\n- **Objective**: The language is precise and mathematical. There are no subjective or opinion-based statements.\n- **Complete and Consistent**: All necessary information is provided. The domain, mesh, boundary conditions, and finite element space are fully specified. There are no contradictions.\n- **Realistic and Feasible**: The setup is a simplified but standard model used for instructional purposes. It is entirely feasible to analyze.\n- **Properly Structured**: The question is direct and unambiguous. It asks for the dimension of a well-defined subspace.\n\nThe problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\nThe problem asks for the dimension of the discrete divergence-free subspace $\\boldsymbol{Z}_{h}$. This subspace consists of all vector fields $\\boldsymbol{u}_{h}$ in the discrete finite element space $\\boldsymbol{V}_{h}$ that have zero divergence on each element of the mesh.\n\nThe domain $\\Omega = [0,1]\\times[0,1]$ is meshed into four triangles by connecting the vertices $N_1=(0,0)$, $N_2=(1,0)$, $N_3=(1,1)$, $N_4=(0,1)$ to the central point $N_5=(\\frac{1}{2},\\frac{1}{2})$. The four triangles are:\n- $T_1$: with vertices $N_1$, $N_2$, $N_5$.\n- $T_2$: with vertices $N_2$, $N_3$, $N_5$.\n- $T_3$: with vertices $N_3$, $N_4$, $N_5$.\n- $T_4$: with vertices $N_4$, $N_1$, $N_5$.\n\nThe finite element space $\\boldsymbol{V}_{h}$ consists of continuous, piecewise-linear vector functions. The homogeneous Dirichlet boundary conditions $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\partial\\Omega$ mean that the nodal displacements at the boundary nodes $N_1, N_2, N_3, N_4$ are all zero:\n$$\n\\boldsymbol{u}(N_1) = \\boldsymbol{u}(N_2) = \\boldsymbol{u}(N_3) = \\boldsymbol{u}(N_4) = \\boldsymbol{0}.\n$$\nThe only non-zero degrees of freedom are the two components of the displacement vector at the interior node $N_5$. Let $\\boldsymbol{u}_5 = (u_{x,5}, u_{y,5})$ denote this nodal displacement vector.\n\nAny function $\\boldsymbol{u}_h \\in \\boldsymbol{V}_h$ can be expressed in terms of the basis functions. Let $\\phi_i(x,y)$ be the standard piecewise-linear (P1) basis function associated with node $N_i$, defined by $\\phi_i(N_j) = \\delta_{ij}$. Given the boundary conditions, the displacement field $\\boldsymbol{u}_h(x,y)$ is given by:\n$$\n\\boldsymbol{u}_h(x,y) = \\boldsymbol{u}_5 \\phi_5(x,y) = (u_{x,5}\\phi_5(x,y), u_{y,5}\\phi_5(x,y)).\n$$\nThe dimension of the space $\\boldsymbol{V}_h$ is the number of degrees of freedom, which is $2$.\n\nWe are looking for the subspace $\\boldsymbol{Z}_h \\subset \\boldsymbol{V}_h$ such that for any $\\boldsymbol{u}_h \\in \\boldsymbol{Z}_h$, the condition $(\\nabla\\cdot \\boldsymbol{u}_{h})|_{T_k}=0$ holds for each triangle $T_k$, for $k=1,2,3,4$.\n\nThe divergence of $\\boldsymbol{u}_h$ is:\n$$\n\\nabla\\cdot\\boldsymbol{u}_h = \\frac{\\partial}{\\partial x}(u_{x,5}\\phi_5) + \\frac{\\partial}{\\partial y}(u_{y,5}\\phi_5) = u_{x,5}\\frac{\\partial\\phi_5}{\\partial x} + u_{y,5}\\frac{\\partial\\phi_5}{\\partial y}.\n$$\nSince $\\phi_5$ is a piecewise-linear function, its gradient, $\\nabla\\phi_5 = (\\frac{\\partial\\phi_5}{\\partial x}, \\frac{\\partial\\phi_5}{\\partial y})$, is constant on each triangle $T_k$. Let's compute this gradient on each of the four triangles.\n\nOn any triangle, a linear function $f(x,y) = ax+by+c$ has a constant gradient $(a,b)$. The coefficients can be found from the function's values at the three vertices. The basis function $\\phi_5$ is $1$ at $N_5=(\\frac{1}{2},\\frac{1}{2})$ and $0$ at all other nodes.\n\n1.  **Triangle $T_1$**: Vertices are $N_1(0,0)$, $N_2(1,0)$, and $N_5(\\frac{1}{2},\\frac{1}{2})$.\n    The function $\\phi_5(x,y)$ on $T_1$ is defined by $\\phi_5(0,0)=0$, $\\phi_5(1,0)=0$, and $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1$.\n    Let $\\phi_5(x,y)|_{T_1} = a_1 x + b_1 y + c_1$.\n    $\\phi_5(0,0)=0 \\implies c_1=0$.\n    $\\phi_5(1,0)=0 \\implies a_1(1)+b_1(0)+c_1=0 \\implies a_1=0$.\n    $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1 \\implies a_1(\\frac{1}{2})+b_1(\\frac{1}{2})+c_1=1 \\implies \\frac{1}{2}b_1 = 1 \\implies b_1=2$.\n    So, on $T_1$, $\\nabla\\phi_5 = (0, 2)$.\n\n2.  **Triangle $T_2$**: Vertices are $N_2(1,0)$, $N_3(1,1)$, and $N_5(\\frac{1}{2},\\frac{1}{2})$.\n    Let $\\phi_5(x,y)|_{T_2} = a_2 x + b_2 y + c_2$.\n    $\\phi_5(1,0)=0 \\implies a_2+c_2=0$.\n    $\\phi_5(1,1)=0 \\implies a_2+b_2+c_2=0 \\implies b_2=0$.\n    $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1 \\implies \\frac{1}{2}a_2+\\frac{1}{2}b_2+c_2=1 \\implies \\frac{1}{2}a_2-a_2=1 \\implies -\\frac{1}{2}a_2 = 1 \\implies a_2=-2$.\n    So, on $T_2$, $\\nabla\\phi_5 = (-2, 0)$.\n\n3.  **Triangle $T_3$**: Vertices are $N_3(1,1)$, $N_4(0,1)$, and $N_5(\\frac{1}{2},\\frac{1}{2})$.\n    By symmetry with $T_1$ (reflection across $y=x$), one might infer the gradient. More formally, let $\\phi_5(x,y)|_{T_3} = a_3 x + b_3 y + c_3$.\n    $\\phi_5(0,1)=0 \\implies b_3+c_3=0$.\n    $\\phi_5(1,1)=0 \\implies a_3+b_3+c_3=0 \\implies a_3=0$.\n    $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1 \\implies \\frac{1}{2}a_3+\\frac{1}{2}b_3+c_3=1 \\implies \\frac{1}{2}b_3-b_3=1 \\implies -\\frac{1}{2}b_3 = 1 \\implies b_3=-2$.\n    So, on $T_3$, $\\nabla\\phi_5 = (0, -2)$.\n\n4.  **Triangle $T_4$**: Vertices are $N_4(0,1)$, $N_1(0,0)$, and $N_5(\\frac{1}{2},\\frac{1}{2})$.\n    By symmetry with $T_2$ (reflection across $y=x$), one might infer the gradient. Formally, let $\\phi_5(x,y)|_{T_4} = a_4 x + b_4 y + c_4$.\n    $\\phi_5(0,0)=0 \\implies c_4=0$.\n    $\\phi_5(0,1)=0 \\implies b_4+c_4=0 \\implies b_4=0$.\n    $\\phi_5(\\frac{1}{2},\\frac{1}{2})=1 \\implies \\frac{1}{2}a_4+\\frac{1}{2}b_4+c_4=1 \\implies \\frac{1}{2}a_4=1 \\implies a_4=2$.\n    So, on $T_4$, $\\nabla\\phi_5 = (2, 0)$.\n\nNow we apply the constraint $(\\nabla\\cdot \\boldsymbol{u}_{h})|_{T_k}=0$ for each triangle, using the expression $\\nabla\\cdot\\boldsymbol{u}_h = u_{x,5}\\frac{\\partial\\phi_5}{\\partial x} + u_{y,5}\\frac{\\partial\\phi_5}{\\partial y}$:\n\n- On $T_1$: $u_{x,5}(0) + u_{y,5}(2) = 2u_{y,5} = 0$.\n- On $T_2$: $u_{x,5}(-2) + u_{y,5}(0) = -2u_{x,5} = 0$.\n- On $T_3$: $u_{x,5}(0) + u_{y,5}(-2) = -2u_{y,5} = 0$.\n- On $T_4$: $u_{x,5}(2) + u_{y,5}(0) = 2u_{x,5} = 0$.\n\nThis system of four linear equations for the two unknowns $u_{x,5}$ and $u_{y,5}$ must be satisfied for $\\boldsymbol{u}_h$ to be in $\\boldsymbol{Z}_h$.\nThe first equation gives $u_{y,5}=0$. The second equation gives $u_{x,5}=0$.\nThe remaining two equations are consistent with this solution.\nThe only solution to this system is $(u_{x,5}, u_{y,5}) = (0,0)$.\n\nThis implies that the only displacement field $\\boldsymbol{u}_h \\in \\boldsymbol{V}_h$ that satisfies the element-wise zero divergence constraint is the zero field, $\\boldsymbol{u}_h(x,y) = \\boldsymbol{0}$.\nTherefore, the subspace $\\boldsymbol{Z}_h$ contains only the zero vector:\n$$\n\\boldsymbol{Z}_h = \\{\\boldsymbol{0}\\}.\n$$\nThe dimension of a vector space containing only the zero vector is $0$.\nThis result exemplifies volumetric locking, where for this specific choice of mesh and low-order P1 elements, the incompressibility constraint is so restrictive that it eliminates all non-trivial solutions.", "answer": "$$\\boxed{0}$$", "id": "3571246"}]}