{"hands_on_practices": [{"introduction": "A robust understanding of any physical model begins with its derivation from first principles. This exercise moves beyond simply accepting the consolidation equation, tasking you with constructing it from the fundamental pillars of soil mechanics: mass conservation, Darcy's law, and the stress-strain relationship. By applying this derivation to a layer with mixed drainage conditions, you will develop a versatile solution and translate it into a computational algorithm, reinforcing the direct link between physical laws and numerical implementation. [@problem_id:3547322]", "problem": "Consider a fully saturated, laterally confined, one-dimensional soil layer of thickness $H$ with vertical coordinate $z$ measured downward from the top surface at $z=0$ to the bottom surface at $z=H$. A uniform increment of total vertical stress is suddenly applied at $t=0$, producing an initial uniform excess pore water pressure $u(z,0)=u_0$ throughout the layer. The top boundary at $z=0$ is impermeable (no vertical flow), and the bottom boundary at $z=H$ is perfectly permeable (zero excess pore pressure). The fluid and solid are individually incompressible, but the soil skeleton is compressible. \n\nStarting only from the following fundamental base:\n- Mass conservation of the fluid phase in one dimension, \n- Darcy’s law for vertical specific discharge, and\n- The linear relation linking volumetric strain rate of the skeleton to the excess pore pressure rate via one-dimensional constrained modulus (or, equivalently, the one-dimensional coefficient of volume compressibility),\n\nderive the appropriate diffusion-type governing equation for the excess pore pressure $u(z,t)$ with the above initial and boundary conditions. Identify the one-dimensional coefficient of consolidation $c_v$ in terms of measurable soil parameters. Then, construct a mathematically correct solution method that respects the mixed boundary conditions (impermeable top and permeable bottom) and the uniform initial condition. Your derivation must justify the choice of spatial eigenfunctions compatible with the mixed boundary conditions, and must express $u(z,t)$ and the spatial average of $u(z,t)$ over the layer. Define the average degree of consolidation $U(t)$ as the relative dissipation of the spatial average excess pore pressure, and provide a numerically stable and verifiably convergent algorithm to evaluate $u(z,t)$ at a given depth and time, and $U(t)$ at a given time.\n\nYour program must implement the resulting formulas and compute requested values for a test suite. Use the following common parameters for all test cases:\n- Layer thickness $H = 2.0\\,\\mathrm{m}$,\n- One-dimensional coefficient of consolidation $c_v = 1.0\\times 10^{-7}\\,\\mathrm{m^2/s}$,\n- Initial uniform excess pore pressure $u_0 = 100.0\\,\\mathrm{kPa}$,\n- Coordinate origin at the top surface with $z$ measured downward.\n\nFor the impermeable top boundary at $z=0$, enforce zero vertical flux, and for the permeable bottom boundary at $z=H$, enforce zero excess pore pressure. For the initial condition at $t=0$, enforce $u(z,0)=u_0$ for $0 \\le z \\le H$. Ensure that any algorithm you implement for $t>0$ reflects the zero excess pore pressure at $z=H$ and zero flux at $z=0$.\n\nImplement a numerically stable evaluation of the series solution that:\n- Truncates when an absolute term-wise contribution to $u(z,t)$ or to the spatial average of $u(z,t)$ falls below a prescribed tolerance,\n- Handles the boundary and initial-time edge cases in a scientifically consistent way,\n- Uses only dimensionally consistent inputs in International System of Units.\n\nTest suite. Using the common parameters above, compute the following six outputs:\n- Test $1$: $u(z,t)$ at $z=0.0\\,\\mathrm{m}$ and $t=0.0\\,\\mathrm{s}$, expressed in $\\mathrm{kPa}$.\n- Test $2$: $u(z,t)$ at $z=2.0\\,\\mathrm{m}$ and $t=1.0\\,\\mathrm{s}$, expressed in $\\mathrm{kPa}$.\n- Test $3$: $u(z,t)$ at $z=1.0\\,\\mathrm{m}$ and $t=3.6\\times 10^{6}\\,\\mathrm{s}$, expressed in $\\mathrm{kPa}$.\n- Test $4$: $U(t)$ at $t=0.0\\,\\mathrm{s}$, expressed as a decimal in $[0,1]$.\n- Test $5$: $U(t)$ at $t=3.6\\times 10^{6}\\,\\mathrm{s}$, expressed as a decimal in $[0,1]$.\n- Test $6$: $U(t)$ at $t=1.0\\times 10^{8}\\,\\mathrm{s}$, expressed as a decimal in $[0,1]$.\n\nUnits and numerical output specification:\n- All depths $z$ are in $\\mathrm{m}$, all times $t$ are in $\\mathrm{s}$, the coefficient $c_v$ is in $\\mathrm{m^2/s}$, the layer thickness $H$ is in $\\mathrm{m}$, and the excess pore pressure $u$ is in $\\mathrm{kPa}$.\n- The average degree of consolidation $U$ is unitless.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each number rounded to exactly six decimal places, in the following order: $[\\text{Test 1}, \\text{Test 2}, \\text{Test 3}, \\text{Test 4}, \\text{Test 5}, \\text{Test 6}]$.\n\nThe goal of this exercise is to demonstrate, from first principles, how one-dimensional consolidation with mixed boundary conditions leads to a well-posed diffusion problem, how the one-dimensional coefficient of consolidation enters the governing equation, and how the evolution of $u(z,t)$ and $U(t)$ can be computed robustly and accurately for scientifically realistic parameters and edge cases.", "solution": "The problem requires the derivation of the governing partial differential equation for one-dimensional consolidation, its solution under mixed boundary conditions, and the subsequent numerical evaluation of the excess pore water pressure $u(z,t)$ and the average degree of consolidation $U(t)$. The derivation must originate from fundamental principles of soil mechanics.\n\nThe physical system is a laterally-confined, saturated soil layer of thickness $H$. The vertical coordinate $z$ is measured downwards from an impermeable top surface at $z=0$ to a permeable bottom surface at $z=H$. At time $t=0$, a uniform total stress increment is applied, generating a uniform initial excess pore water pressure $u(z,0) = u_0$.\n\nThe derivation proceeds from three foundational principles:\n\n1.  **Continuity of Flow (Mass Conservation):** We consider a differential soil element of height $dz$ and horizontal area $A$. The fluid (water) is assumed to be incompressible. The rate of change of the volume of the element must equal the net rate of fluid outflow. Assuming extensional strains are positive, the one-dimensional rate of volume change of the element is $A \\frac{\\partial \\epsilon_z}{\\partial t} dz$. The net rate of fluid outflow is the difference between the outflow at $z+dz$ and the inflow at $z$, which is $(A v_z)|_{z+dz} - (A v_z)|_z \\approx A \\frac{\\partial v_z}{\\partial z} dz$, where $v_z$ is the vertical specific discharge (Darcy velocity). Equating these gives $\\frac{\\partial v_z}{\\partial z} = \\frac{\\partial \\epsilon_z}{\\partial t}$.\n\n2.  **Darcy's Law:** The flow of water through the porous soil medium is governed by Darcy's law. In the context of consolidation, the flow is driven by the gradient of the excess pore water pressure $u(z,t)$, as the hydrostatic component is in equilibrium. The law states $v_z = -k_v i$, where $k_v$ is the coefficient of permeability and $i$ is the hydraulic gradient. The hydraulic gradient is the rate of change of total head with position. For flow driven by excess pore pressure, this gradient is $i = \\frac{1}{\\gamma_w} \\frac{\\partial u}{\\partial z}$, where $\\gamma_w$ is the unit weight of water. Thus, Darcy's Law is expressed as:\n    $$v_z = -\\frac{k_v}{\\gamma_w} \\frac{\\partial u}{\\partial z}$$\n\n3.  **Stress-Strain Relationship:** The change in strain is related to the change in effective stress, $\\sigma'$. The total vertical stress $\\sigma$ is constant for $t>0$. The effective stress principle states $\\sigma' = \\sigma - u$. Therefore, a change in excess pore pressure $du$ causes an equal and opposite change in effective stress, $d\\sigma' = -du$. The rate of volumetric strain is related to the rate of change of effective stress via the coefficient of volume compressibility, $m_v$: $\\frac{\\partial \\epsilon_z}{\\partial t} = m_v \\frac{\\partial \\sigma'}{\\partial t}$. Combining these gives the relationship between strain rate and pore pressure rate:\n    $$\\frac{\\partial \\epsilon_z}{\\partial t} = -m_v \\frac{\\partial u}{\\partial t}$$\n\nCombining these principles, we substitute the stress-strain relationship into the continuity equation:\n$$-m_v \\frac{\\partial u}{\\partial t} = \\frac{\\partial v_z}{\\partial z}$$\nNext, we substitute Darcy's Law into this combined equation:\n$$-m_v \\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial z} \\left( -\\frac{k_v}{\\gamma_w} \\frac{\\partial u}{\\partial z} \\right)$$\nAssuming the soil parameters $k_v$ and $m_v$ are constant throughout the layer, we obtain the one-dimensional consolidation equation by canceling the negative signs:\n$$\\frac{\\partial u}{\\partial t} = \\frac{k_v}{m_v \\gamma_w} \\frac{\\partial^2 u}{\\partial z^2}$$\nThis is a diffusion-type equation. We identify the **one-dimensional coefficient of consolidation, $c_v$**, as the collection of material constants:\n$$c_v = \\frac{k_v}{m_v \\gamma_w}$$\nThe governing equation is thus:\n$$\\frac{\\partial u}{\\partial t} = c_v \\frac{\\partial^2 u}{\\partial z^2}$$\nThis equation is to be solved subject to the specified initial and boundary conditions:\n-   Initial Condition (IC): $u(z, 0) = u_0$ for $0 \\le z \\le H$.\n-   Boundary Conditions (BCs):\n    1.  Impermeable top at $z=0$: no flow, $v_z(0,t)=0$. From Darcy's law, this implies a zero-gradient (Neumann) condition: $\\frac{\\partial u}{\\partial z}(0,t) = 0$ for $t > 0$.\n    2.  Permeable bottom at $z=H$: zero excess pore pressure (Dirichlet) condition: $u(H,t) = 0$ for $t > 0$.\n\nWe solve this initial-boundary value problem using the method of separation of variables. Let $u(z,t) = Z(z)T(t)$. Substituting into the PDE yields $\\frac{T'(t)}{c_v T(t)} = \\frac{Z''(z)}{Z(z)} = -\\lambda^2$, where $-\\lambda^2$ is the separation constant. This leads to two ordinary differential equations:\n$$T'(t) + \\lambda^2 c_v T(t) = 0 \\implies T(t) = C e^{-\\lambda^2 c_v t}$$\n$$Z''(z) + \\lambda^2 Z(z) = 0 \\implies Z(z) = C_1 \\cos(\\lambda z) + C_2 \\sin(\\lambda z)$$\nThe spatial eigenfunctions $Z(z)$ must satisfy the boundary conditions.\n1.  From $\\frac{\\partial u}{\\partial z}(0,t) = 0$, we require $Z'(0)=0$. Differentiating $Z(z)$ gives $Z'(z) = -\\lambda C_1 \\sin(\\lambda z) + \\lambda C_2 \\cos(\\lambda z)$. At $z=0$, $Z'(0) = \\lambda C_2 = 0$. For a non-trivial solution, $\\lambda \\neq 0$, so we must have $C_2=0$. The eigenfunction is reduced to $Z(z) = C_1 \\cos(\\lambda z)$.\n2.  From $u(H,t)=0$, we require $Z(H)=0$. This implies $C_1 \\cos(\\lambda H) = 0$. For a non-trivial solution, $C_1 \\neq 0$, so we must have $\\cos(\\lambda H)=0$. This condition is satisfied only if $\\lambda H$ is an odd multiple of $\\pi/2$.\n\nThis quantizes the separation constant $\\lambda$ into a discrete set of eigenvalues $\\lambda_m$:\n$$\\lambda_m H = \\frac{(2m+1)\\pi}{2}, \\quad m = 0, 1, 2, \\dots$$\nThe corresponding spatial eigenfunctions are $Z_m(z) = \\cos(\\lambda_m z) = \\cos\\left(\\frac{(2m+1)\\pi z}{2H}\\right)$. These are the justified eigenfunctions compatible with the mixed boundary conditions.\n\nThe general solution is a superposition (series) of all product solutions:\n$$u(z,t) = \\sum_{m=0}^{\\infty} B_m \\cos\\left(\\frac{(2m+1)\\pi z}{2H}\\right) \\exp\\left[-c_v \\left(\\frac{(2m+1)\\pi}{2H}\\right)^2 t\\right]$$\nThe coefficients $B_m$ are determined by the initial condition $u(z,0) = u_0$. This requires expanding the constant function $u_0$ as a Fourier series in terms of the orthogonal eigenfunctions $\\cos(\\lambda_m z)$ on the interval $[0, H]$.\n$$B_m = \\frac{\\int_0^H u_0 \\cos(\\lambda_m z) dz}{\\int_0^H \\cos^2(\\lambda_m z) dz} = \\frac{u_0 [\\frac{1}{\\lambda_m}\\sin(\\lambda_m z)]_0^H}{H/2} = \\frac{2u_0}{H\\lambda_m} \\sin(\\lambda_m H)$$\nSince $\\lambda_m H = (2m+1)\\pi/2$, we have $\\sin(\\lambda_m H) = \\sin((2m+1)\\pi/2) = (-1)^m$.\n$$B_m = \\frac{2u_0 (-1)^m}{(2m+1)\\pi/2} = \\frac{4u_0 (-1)^m}{(2m+1)\\pi}$$\nSubstituting $B_m$ yields the final solution for the excess pore pressure:\n$$u(z,t) = \\frac{4u_0}{\\pi} \\sum_{m=0}^{\\infty} \\frac{(-1)^m}{2m+1} \\cos\\left(\\frac{(2m+1)\\pi z}{2H}\\right) \\exp\\left[-\\left(\\frac{(2m+1)\\pi}{2}\\right)^2 \\frac{c_v t}{H^2}\\right]$$\n\nThe spatial average of the excess pore pressure is $\\bar{u}(t) = \\frac{1}{H}\\int_0^H u(z,t) dz$.\n$$\\bar{u}(t) = \\frac{1}{H} \\sum_{m=0}^{\\infty} B_m \\exp(-\\lambda_m^2 c_v t) \\int_0^H \\cos(\\lambda_m z) dz$$\nThe integral is $\\int_0^H \\cos(\\lambda_m z) dz = \\frac{(-1)^m}{\\lambda_m}$.\n$$\\bar{u}(t) = \\frac{1}{H} \\sum_{m=0}^{\\infty} \\frac{4u_0 (-1)^m}{(2m+1)\\pi} \\exp(-\\lambda_m^2 c_v t) \\frac{H(-1)^m}{(2m+1)\\pi/2} = \\frac{8u_0}{\\pi^2} \\sum_{m=0}^{\\infty} \\frac{1}{(2m+1)^2} \\exp(-\\lambda_m^2 c_v t)$$\nThe average degree of consolidation, $U(t)$, is the fractional dissipation of average pore pressure:\n$$U(t) = \\frac{\\bar{u}(0) - \\bar{u}(t)}{\\bar{u}(0)} = 1 - \\frac{\\bar{u}(t)}{u_0}$$\nwhere $\\bar{u}(0) = u_0$.\n$$U(t) = 1 - \\frac{8}{\\pi^2} \\sum_{m=0}^{\\infty} \\frac{1}{(2m+1)^2} \\exp\\left[-\\left(\\frac{(2m+1)\\pi}{2}\\right)^2 \\frac{c_v t}{H^2}\\right]$$\n\nFor numerical evaluation, we define the dimensionless time factor $T_v = \\frac{c_v t}{H^2}$.\nThe algorithms are as follows:\n-   To compute $u(z,t)$: For $t=0$, $u(z,0)=u_0$. For $z=H$ and $t>0$, $u(H,t)=0$. Otherwise, the series for $u(z,t)$ is summed term-by-term. The summation for $m=0,1,2,\\dots$ is truncated when the absolute value of the term being added is less than a prescribed tolerance $\\epsilon$.\n-   To compute $U(t)$: For $t=0$, $U(0)=0$. For $t>0$, the series for $U(t)$ is summed. Truncation occurs when the absolute value of the term $\\frac{8}{\\pi^2(2m+1)^2}\\exp(\\dots)$ is less than $\\epsilon$. The exponential terms ensure rapid, verifiable convergence for any $t>0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the consolidation problem for the given test cases.\n    \"\"\"\n    # Common parameters\n    H = 2.0  # Layer thickness in m\n    c_v = 1.0e-7  # Coefficient of consolidation in m^2/s\n    u_0 = 100.0  # Initial excess pore pressure in kPa\n\n    # Numerical tolerance for series truncation\n    TOLERANCE = 1e-15\n\n    def calculate_u(z, t, H_val, cv_val, u0_val):\n        \"\"\"\n        Calculates the excess pore pressure u(z,t) in kPa.\n\n        Args:\n            z (float): Depth in m.\n            t (float): Time in s.\n            H_val (float): Layer thickness in m.\n            cv_val (float): Coefficient of consolidation in m^2/s.\n            u0_val (float): Initial excess pore pressure in kPa.\n\n        Returns:\n            float: Excess pore pressure u(z,t) in kPa.\n        \"\"\"\n        # Handle edge cases based on the problem's initial and boundary conditions.\n        if t == 0.0:\n            # At t=0, the initial condition u(z,0) = u_0 applies everywhere.\n            return u0_val\n        \n        if z == H_val:\n            # At z=H, for any t>0, the permeable boundary condition u(H,t) = 0 applies.\n            return 0.0\n\n        # Calculate dimensionless time factor\n        Tv = cv_val * t / (H_val**2)\n\n        total_u = 0.0\n        m = 0\n        while True:\n            # M_m = (2m+1)*pi/2\n            M_m = (2 * m + 1) * np.pi / 2\n            \n            # Calculate the m-th term of the series\n            # Coefficient B_m component: (4 * u0 / pi) * ((-1)^m / (2m+1))\n            # Spacial component: cos(M_m * z / H)\n            # Temporal component: exp(-M_m^2 * Tv)\n            term = (4 * u0_val / np.pi) * ((-1)**m / (2 * m + 1)) * \\\n                   np.cos(M_m * z / H_val) * np.exp(-M_m**2 * Tv)\n\n            total_u += term\n\n            # Truncate series when the absolute term contribution is below tolerance\n            if abs(term) < TOLERANCE:\n                break\n            \n            m += 1\n            # Safety break for unforeseen convergence issues\n            if m > 1000:\n                break\n                \n        return total_u\n\n    def calculate_U(t, H_val, cv_val):\n        \"\"\"\n        Calculates the average degree of consolidation U(t).\n\n        Args:\n            t (float): Time in s.\n            H_val (float): Layer thickness in m.\n            cv_val (float): Coefficient of consolidation in m^2/s.\n\n        Returns:\n            float: Average degree of consolidation U(t) (dimensionless).\n        \"\"\"\n        # Handle edge case: At t=0, no consolidation has occurred.\n        if t == 0.0:\n            return 0.0\n\n        # Calculate dimensionless time factor\n        Tv = cv_val * t / (H_val**2)\n\n        sum_part = 0.0\n        m = 0\n        while True:\n            # M_m = (2m+1)*pi/2\n            M_m = (2 * m + 1) * np.pi / 2\n            \n            # Calculate the m-th term of the series for 1 - U(t)\n            # Coefficient: 2 / M_m^2\n            # Temporal component: exp(-M_m^2 * Tv)\n            term = (8.0 / (np.pi**2 * (2 * m + 1)**2)) * np.exp(-M_m**2 * Tv)\n\n\n            sum_part += term\n\n            # Truncate series when the absolute term contribution is below tolerance\n            if abs(term) < TOLERANCE:\n                break\n            \n            m += 1\n            # Safety break\n            if m > 1000:\n                break\n        \n        # U(t) = 1 - sum_part\n        return 1.0 - sum_part\n\n    # Test suite as defined in the problem statement\n    test_cases = [\n        {'type': 'u', 'z': 0.0, 't': 0.0},       # Test 1\n        {'type': 'u', 'z': 2.0, 't': 1.0},       # Test 2\n        {'type': 'u', 'z': 1.0, 't': 3.6e6},     # Test 3\n        {'type': 'U', 't': 0.0},                 # Test 4\n        {'type': 'U', 't': 3.6e6},               # Test 5\n        {'type': 'U', 't': 1.0e8},               # Test 6\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'u':\n            result = calculate_u(case['z'], case['t'], H, c_v, u_0)\n        elif case['type'] == 'U':\n            result = calculate_U(case['t'], H, c_v)\n        results.append(result)\n\n    # Format output as a comma-separated list of numbers rounded to 6 decimal places,\n    # enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3547322"}, {"introduction": "Analytical solutions in engineering often manifest as infinite series, which, for practical computation, must be truncated. This practice focuses on the crucial task of quantifying the error introduced by this necessary approximation in the context of settlement prediction. You will derive the settlement history for a classic double-drainage scenario and, more importantly, develop a rigorous strategy to determine the minimum number of series terms required to achieve a specified level of accuracy. [@problem_id:3547310]", "problem": "A laterally extensive, homogeneous clay layer of thickness $H = 6.0\\,\\mathrm{m}$ is confined between two highly permeable sand layers, so that drainage occurs at both the top and bottom boundaries (double drainage). At time $t=0$, an instantaneous and sustained vertical effective stress increment $\\Delta \\sigma' = 150\\,\\mathrm{kPa}$ is applied at the ground surface. Assume one-dimensional (1D) conditions, small strains, constant soil properties, and incompressible pore fluid. The coefficient of consolidation $c_v$ (Coefficient of Consolidation) is $c_v = 3.0 \\times 10^{-8}\\,\\mathrm{m^2/s}$ and the coefficient of volume compressibility $m_v$ (Coefficient of Volume Compressibility) is $m_v = 1.2 \\times 10^{-4}\\,\\mathrm{m^2/kN}$, both taken as constants over the stress range.\n\nStarting from Terzaghi’s 1D consolidation governing equation for excess pore pressure $u(z,t)$ and its boundary and initial conditions appropriate to double drainage, derive the settlement history $s(t)$ by:\n- Expressing the spatially averaged excess pore pressure in terms of the standard eigenfunction series for double drainage.\n- Introducing the average degree of consolidation $U(t)$ and relating $s(t)$ to $U(t)$ and the ultimate settlement $s_{\\infty}$.\n- Constructing a truncation strategy for the eigenfunction series that guarantees a prescribed absolute accuracy in settlement, $|s(t) - s_M(t)| \\leq \\varepsilon_s$, when the series is truncated after a finite number of terms $M$. Your strategy must produce a computable inequality for selecting the minimal $M$ in terms of $t$, $c_v$, $H$, and $\\varepsilon_s$.\n\nThen, for the specific time $t^{\\star} = 2.00\\,\\mathrm{years}$ (take $1\\,\\mathrm{year} = 365\\,\\mathrm{days}$), determine the settlement $s(t^{\\star})$ that satisfies the absolute accuracy tolerance $\\varepsilon_s = 0.05\\,\\mathrm{mm}$. Round your final numerical answer for $s(t^{\\star})$ to four significant figures and express it in $\\mathrm{mm}$.", "solution": "### Solution Derivation\n\n**1. Governing Equation and Boundary Conditions**\nTerzaghi's one-dimensional consolidation equation governs the dissipation of excess pore pressure, $u$, with time, $t$, and depth, $z$:\n$$ \\frac{\\partial u}{\\partial t} = c_v \\frac{\\partial^2 u}{\\partial z^2} $$\nFor a layer of thickness $H$ with double drainage, the maximum drainage path length is $H_d = H/2$. We set up a coordinate system with $z=0$ at the center of the clay layer and drainage boundaries at $z = \\pm H_d$. Due to symmetry, the problem can be solved over the domain $z \\in [0, H_d]$.\n\nThe initial and boundary conditions are:\n- Initial condition (at $t=0$): The applied stress is carried entirely by the pore fluid. $u(z, 0) = u_0 = \\Delta \\sigma'$.\n- Boundary conditions (for $t>0$):\n    - No flow at the center of the layer (by symmetry): $\\frac{\\partial u}{\\partial z}(0, t) = 0$.\n    - Full drainage at the boundary: $u(H_d, t) = 0$.\n\n**2. Eigenfunction Series Solution for $u(z,t)$**\nUsing the method of separation of variables, the solution for $u(z,t)$ is an eigenfunction series (a Fourier series):\n$$ u(z,t) = \\sum_{m=1}^{\\infty} C_m \\cos\\left(\\frac{M_m z}{H_d}\\right) \\exp(-M_m^2 T_v) $$\nwhere $M_m = \\frac{(2m-1)\\pi}{2}$ are the eigenvalues, and $T_v = \\frac{c_v t}{H_d^2}$ is the dimensionless time factor.\nThe coefficients $C_m$ are found from the initial condition $u(z,0) = u_0$:\n$$ C_m = \\frac{\\int_0^{H_d} u_0 \\cos\\left(\\frac{M_m z}{H_d}\\right) dz}{\\int_0^{H_d} \\cos^2\\left(\\frac{M_m z}{H_d}\\right) dz} = \\frac{u_0 \\left[\\frac{H_d}{M_m} \\sin\\left(\\frac{M_m z}{H_d}\\right)\\right]_0^{H_d}}{H_d/2} = \\frac{2u_0}{M_m} \\sin(M_m) $$\nSince $M_m = (m-\\frac{1}{2})\\pi$, $\\sin(M_m) = (-1)^{m-1}$.\n$$ C_m = \\frac{2u_0 (-1)^{m-1}}{M_m} = \\frac{4u_0 (-1)^{m-1}}{(2m-1)\\pi} $$\nSubstituting $C_m$ back, the excess pore pressure is:\n$$ u(z,t) = \\frac{4u_0}{\\pi} \\sum_{m=1}^{\\infty} \\frac{(-1)^{m-1}}{2m-1} \\cos\\left(\\frac{(2m-1)\\pi z}{2H_d}\\right) \\exp\\left(-\\left(\\frac{(2m-1)\\pi}{2}\\right)^2 T_v\\right) $$\n\n**3. Spatially Averaged Excess Pore Pressure and Degree of Consolidation**\nThe spatially averaged excess pore pressure, $\\bar{u}(t)$, over the full thickness $H=2H_d$ is:\n$$ \\bar{u}(t) = \\frac{1}{H_d} \\int_0^{H_d} u(z,t) dz $$\nIntegrating the series term-by-term:\n$$ \\int_0^{H_d} \\cos\\left(\\frac{M_m z}{H_d}\\right) dz = \\left[\\frac{H_d}{M_m} \\sin\\left(\\frac{M_m z}{H_d}\\right)\\right]_0^{H_d} = \\frac{H_d}{M_m} \\sin(M_m) = \\frac{H_d}{M_m}(-1)^{m-1} $$\nThus,\n$$ \\bar{u}(t) = \\frac{1}{H_d} \\sum_{m=1}^{\\infty} C_m \\left(\\frac{H_d}{M_m}(-1)^{m-1}\\right) \\exp(-M_m^2 T_v) = \\sum_{m=1}^{\\infty} \\frac{C_m (-1)^{m-1}}{M_m} \\exp(-M_m^2 T_v) $$\n$$ \\bar{u}(t) = \\sum_{m=1}^{\\infty} \\frac{2u_0 (-1)^{m-1}}{M_m} \\frac{(-1)^{m-1}}{M_m} \\exp(-M_m^2 T_v) = \\sum_{m=1}^{\\infty} \\frac{2u_0}{M_m^2} \\exp(-M_m^2 T_v) $$\nSubstituting $M_m = \\frac{(2m-1)\\pi}{2}$:\n$$ \\bar{u}(t) = \\frac{8u_0}{\\pi^2} \\sum_{m=1}^{\\infty} \\frac{1}{(2m-1)^2} \\exp\\left(-\\left(\\frac{(2m-1)\\pi}{2}\\right)^2 T_v\\right) $$\nThe average degree of consolidation, $U(t)$, is the ratio of consolidation settlement at time $t$ to the ultimate settlement. It is also given by the dissipation of average excess pore pressure:\n$$ U(t) = \\frac{s(t)}{s_{\\infty}} = 1 - \\frac{\\bar{u}(t)}{u_0} = 1 - \\frac{8}{\\pi^2} \\sum_{m=1}^{\\infty} \\frac{1}{(2m-1)^2} \\exp\\left(-M_m^2 T_v\\right) $$\n\n**4. Settlement History $s(t)$**\nThe ultimate primary consolidation settlement, $s_{\\infty}$, is $s_{\\infty} = m_v H \\Delta\\sigma'$. The settlement at time $t$ is $s(t) = U(t) s_{\\infty}$.\n$$ s(t) = s_{\\infty} \\left(1 - \\frac{8}{\\pi^2} \\sum_{m=1}^{\\infty} \\frac{1}{(2m-1)^2} \\exp\\left(-\\left(\\frac{(2m-1)\\pi}{2}\\right)^2 \\frac{c_v t}{(H/2)^2}\\right)\\right) $$\nThis expression gives the complete settlement history.\n\n**5. Truncation Strategy**\nLet $s_M(t)$ be the settlement calculated by truncating the series after $M$ terms. The most direct interpretation is to truncate the series for $\\bar{u}(t)$:\n$$ \\bar{u}_M(t) = \\frac{8u_0}{\\pi^2} \\sum_{m=1}^{M} \\frac{1}{(2m-1)^2} \\exp(-M_m^2 T_v) $$\nThen $U_M(t) = 1 - \\bar{u}_M(t)/u_0$, and $s_M(t) = s_{\\infty} U_M(t)$. The absolute error is:\n$$ |s(t) - s_M(t)| = |s_{\\infty}(U(t) - U_M(t))| = | -s_{\\infty}(\\bar{u}(t) - \\bar{u}_M(t))/u_0 | $$\n$$ |s(t) - s_M(t)| = s_{\\infty} \\frac{8}{\\pi^2} \\sum_{m=M+1}^{\\infty} \\frac{1}{(2m-1)^2} \\exp(-M_m^2 T_v) $$\nTo guarantee that this error is less than a tolerance $\\varepsilon_s$, we bound the tail of the series. The ratio of successive terms in the tail sum is $r_m = \\left(\\frac{2m-1}{2m+1}\\right)^2 \\exp(-2\\pi^2 m T_v)$. For $m \\ge M+1$, this ratio is bounded by $\\rho = r_{M+1}$. The sum of the tail is bounded by a geometric series:\n$$ \\sum_{m=M+1}^{\\infty} \\dots < \\text{(first term)} \\times \\frac{1}{1-\\rho} $$\nThe resulting inequality for selecting the minimal integer $M$ is:\n$$ s_{\\infty} \\frac{8}{\\pi^2} \\frac{1}{(2M+1)^2} \\exp\\left(-M_{M+1}^2 T_v\\right) \\frac{1}{1-\\rho_M} \\le \\varepsilon_s $$\nwhere $M_{M+1} = \\frac{(2M+1)\\pi}{2}$, $T_v = \\frac{c_v t}{H_d^2}$, and $\\rho_M = \\left(\\frac{2M+1}{2M+3}\\right)^2 \\exp(-2\\pi^2(M+1)T_v)$. This inequality depends on $t, c_v, H,$ and $\\varepsilon_s$.\n\n### Numerical Calculation\n\n**Parameters:**\n- $H = 6.0\\,\\mathrm{m}$, so $H_d = H/2 = 3.0\\,\\mathrm{m}$.\n- $\\Delta \\sigma' = 150\\,\\mathrm{kPa} = 1.5 \\times 10^5\\,\\mathrm{N/m^2}$.\n- $m_v = 1.2 \\times 10^{-4}\\,\\mathrm{m^2/kN} = 1.2 \\times 10^{-7}\\,\\mathrm{m^2/N}$.\n- $c_v = 3.0 \\times 10^{-8}\\,\\mathrm{m^2/s}$.\n- $t^{\\star} = 2.00\\,\\mathrm{years} = 2.00 \\times 365 \\times 24 \\times 3600\\,\\mathrm{s} = 6.3072 \\times 10^7\\,\\mathrm{s}$.\n- $\\varepsilon_s = 0.05\\,\\mathrm{mm} = 5 \\times 10^{-5}\\,\\mathrm{m}$.\n\n**Calculations:**\n1.  **Ultimate Settlement ($s_{\\infty}$):**\n    $$ s_{\\infty} = m_v H \\Delta\\sigma' = (1.2 \\times 10^{-7}\\,\\mathrm{m^2/N}) \\times (6.0\\,\\mathrm{m}) \\times (1.5 \\times 10^5\\,\\mathrm{N/m^2}) = 0.108\\,\\mathrm{m} = 108\\,\\mathrm{mm} $$\n2.  **Time Factor ($T_v$):**\n    $$ T_v = \\frac{c_v t^{\\star}}{H_d^2} = \\frac{(3.0 \\times 10^{-8}\\,\\mathrm{m^2/s}) \\times (6.3072 \\times 10^7\\,\\mathrm{s})}{(3.0\\,\\mathrm{m})^2} = \\frac{1.89216}{9.0} = 0.21024 $$\n3.  **Determine minimal number of terms ($M$):**\n    We need to find the smallest integer $M$ satisfying the error inequality. For $T_v > 0$, the exponential term causes rapid convergence, so $\\rho_M \\ll 1$ and the term $1/(1-\\rho_M)$ is very close to $1$. We can test values of $M$.\n    - For $M=1$: The error is dominated by the $m=2$ term.\n    $M_{2} = 3\\pi/2$. Error $\\approx s_{\\infty} \\frac{8}{\\pi^2} \\frac{\\exp(-M_2^2 T_v)}{3^2} = (0.108) \\frac{8}{\\pi^2} \\frac{\\exp(-(22.207)(0.21024))}{9} = (0.108) \\frac{8}{9\\pi^2}\\exp(-4.6687) \\approx 9.0 \\times 10^{-5}\\,\\mathrm{m} = 0.09\\,\\mathrm{mm}$.\n    This error ($0.09\\,\\mathrm{mm}$) is greater than $\\varepsilon_s=0.05\\,\\mathrm{mm}$. So, $M=1$ is not sufficient.\n    - For $M=2$: The error is dominated by the $m=3$ term.\n    $M_{3} = 5\\pi/2$. Error $\\approx s_{\\infty} \\frac{8}{\\pi^2} \\frac{\\exp(-M_3^2 T_v)}{5^2} = (0.108) \\frac{8}{\\pi^2} \\frac{\\exp(-(61.685)(0.21024))}{25} = (0.108) \\frac{8}{25\\pi^2}\\exp(-12.969) \\approx 8.2 \\times 10^{-9}\\,\\mathrm{m} = 0.0000082\\,\\mathrm{mm}$.\n    This error is far below $\\varepsilon_s=0.05\\,\\mathrm{mm}$. Thus, $M=2$ is sufficient.\n\n4.  **Calculate Settlement $s(t^{\\star})$ with $M=2$:**\n    $$ s_2(t^{\\star}) = s_{\\infty} \\left(1 - \\frac{8}{\\pi^2} \\left[ \\frac{\\exp(-M_1^2 T_v)}{1^2} + \\frac{\\exp(-M_2^2 T_v)}{3^2} \\right]\\right) $$\n    where $M_1=\\pi/2$.\n    - $M_1^2 T_v = (\\pi/2)^2 (0.21024) = (2.4674)(0.21024) \\approx 0.51875$.\n    - $M_2^2 T_v = (3\\pi/2)^2 (0.21024) = (22.2066)(0.21024) \\approx 4.6687$.\n    - $\\exp(-0.51875) \\approx 0.59526$.\n    - $\\exp(-4.6687) \\approx 0.009385$.\n    $$ s_2(t^{\\star}) = 108\\,\\mathrm{mm} \\times \\left(1 - \\frac{8}{\\pi^2} \\left[ 0.59526 + \\frac{0.009385}{9} \\right]\\right) $$\n    $$ s_2(t^{\\star}) = 108\\,\\mathrm{mm} \\times \\left(1 - 0.81057 \\times [0.59526 + 0.001043]\\right) $$\n    $$ s_2(t^{\\star}) = 108\\,\\mathrm{mm} \\times \\left(1 - 0.81057 \\times 0.596303\\right) = 108\\,\\mathrm{mm} \\times (1 - 0.48336) $$\n    $$ s_2(t^{\\star}) = 108\\,\\mathrm{mm} \\times 0.51664 = 55.79712\\,\\mathrm{mm} $$\n    The calculated error $|s(t^\\star) - s_2(t^\\star)| \\approx 0.0000082\\,\\mathrm{mm}$ is less than $\\varepsilon_s = 0.05\\,\\mathrm{mm}$, confirming the accuracy of $s_2(t^{\\star})$.\n    Rounding the result to four significant figures gives $55.80\\,\\mathrm{mm}$.", "answer": "$$\\boxed{55.80}$$", "id": "3547310"}, {"introduction": "Classical consolidation theory provides an invaluable framework, but its assumption of constant material properties can be a significant limitation. This advanced practice explores a more realistic non-linear scenario where the coefficient of consolidation, $c_v$, evolves as the soil compresses. You will implement a powerful analytical technique, time reparameterization, to linearize the governing equation and compare its accuracy against a direct numerical solution, offering a glimpse into the sophisticated methods used to model complex material behavior. [@problem_id:3547324]", "problem": "Consider the one-dimensional consolidation of a saturated soil layer with two-way drainage. Let the spatial coordinate be non-dimensionalized as $y \\in [0,1]$ by the drainage path length $H_{dr}$ (in $\\mathrm{m}$). The excess pore water pressure field is $u(y,t)$ (in $\\mathrm{kPa}$), where $t$ is time (in $\\mathrm{s}$). Assume a uniform initial excess pore pressure $u(y,0) = u_0$ and homogeneous Dirichlet boundary conditions $u(0,t) = 0$ and $u(1,t) = 0$ for all $t \\ge 0$.\n\nStarting from mass conservation of the fluid and solid phases, together with Darcy’s law and one-dimensional kinematics for small strains, the classical Terzaghi-type governing equation emerges in the linear constant-coefficient case. In this problem we consider a coefficient of consolidation that is a function of the void ratio $e(t)$ evolving in time only (spatially uniform), such that the governing equation is\n$$\n\\frac{\\partial u}{\\partial t}(y,t) = \\frac{c_v\\!\\left(e(t)\\right)}{H_{dr}^2}\\,\\frac{\\partial^2 u}{\\partial y^2}(y,t),\n$$\nwith $u(0,t)=u(1,t)=0$ and $u(y,0)=u_0$. Assume the void ratio evolution is prescribed and monotone decreasing\n$$\ne(t) = e_0 - \\Delta e \\left(1 - \\exp\\!\\left(-\\left(\\frac{t}{t_{\\mathrm{char}}}\\right)^{p}\\right)\\right),\n$$\nand the coefficient of consolidation depends on $e(t)$ via the constitutive law\n$$\nc_v\\!\\left(e(t)\\right) = c_{v0}\\,\\exp\\!\\left(\\alpha\\left(e(t)-e_0\\right)\\right),\n$$\nwhere $H_{dr}>0$ (in $\\mathrm{m}$), $u_0>0$ (in $\\mathrm{kPa}$), $c_{v0}>0$ (in $\\mathrm{m}^2/\\mathrm{s}$), $e_0>0$, $\\Delta e \\in (0,e_0)$, $t_{\\mathrm{char}}>0$ (in $\\mathrm{s}$), $p>0$, and $\\alpha$ (in $\\text{per unit void ratio}$) are specified parameters.\n\nDefine the nonlinear time reparameterization\n$$\n\\tau(t) = \\int_0^t \\frac{c_v\\!\\left(e(t')\\right)}{H_{dr}^2}\\,\\mathrm{d}t'.\n$$\nYour tasks are:\n- Using only fundamental principles and transformations, derive how the change of variables $t \\mapsto \\tau(t)$ can be used to obtain a linear constant-coefficient diffusion equation in the new time variable $\\tau$ and determine a mathematically valid solution method for $u(y,t)$ from this transformation and the given initial-boundary value problem data.\n- Implement a numerical method that evaluates the accuracy of this time reparameterization approach for strongly evolving void ratio $e(t)$ by comparing:\n  1. A solution obtained by solving the transformed constant-coefficient diffusion problem in $\\tau$ with homogeneous Dirichlet boundary conditions and uniform initial condition, and mapping back to $t$ via $\\tau(t)$, and\n  2. A direct numerical reference solution of the original time-dependent coefficient problem in $t$.\n\nNumerical implementation requirements:\n- For the direct numerical reference in $t$, use the Crank–Nicolson (CN) method in time with the coefficient $c_v\\!\\left(e(t)\\right)$ evaluated at the midpoint of each time step for second-order temporal accuracy, and a standard second-order centered finite difference in space on a uniform grid for $y \\in [0,1]$ with homogeneous Dirichlet boundary conditions. Use $N_y$ interior nodes in space and $N_t$ time steps to reach a specified final time $t_{\\mathrm{end}}$.\n- For the transformed constant-coefficient problem in $\\tau$, solve the homogeneous Dirichlet heat equation on $y \\in [0,1]$ with uniform initial condition using a mathematically correct spectral representation or an equivalently accurate method; then evaluate it at $\\tau(t)$ constructed by numerical quadrature over $t \\in [0,t_{\\mathrm{end}}]$.\n- Use $N_y = 200$ interior spatial nodes and $N_t = 2000$ time steps for all test cases. For the spectral evaluation in the transformed problem, truncate the series (or equivalently achieve an accuracy) consistent with $M = 400$ nonzero sine modes.\n- Report accuracy as the relative Euclidean norm error at selected observation times. For any time $t$, let $\\lVert \\cdot \\rVert_2$ denote the discrete Euclidean norm on the $N_y$ interior nodes with uniform quadrature weight. Define the relative error as\n$$\n\\varepsilon_{\\mathrm{rel}}(t) = \\frac{\\left\\lVert u_{\\mathrm{trans}}(\\cdot,t) - u_{\\mathrm{num}}(\\cdot,t)\\right\\rVert_2}{\\max\\!\\left(\\left\\lVert u_{\\mathrm{num}}(\\cdot,t)\\right\\rVert_2,\\ \\varepsilon_{\\mathrm{floor}}\\right)},\n$$\nwith $\\varepsilon_{\\mathrm{floor}} = 10^{-12}$.\n- Evaluate $\\varepsilon_{\\mathrm{rel}}(t)$ at observation times $t \\in \\{0.2\\,t_{\\mathrm{end}},\\,0.5\\,t_{\\mathrm{end}},\\,0.8\\,t_{\\mathrm{end}},\\,t_{\\mathrm{end}}\\}$, and report for each test case:\n  1. The relative error at $t_{\\mathrm{end}}$ as a float, and\n  2. The maximum relative error over the observation set as a float.\n\nTest suite specifications (three test cases):\n- Case A (moderate evolution): $H_{dr} = 1.0\\ \\mathrm{m}$, $u_0 = 100.0\\ \\mathrm{kPa}$, $c_{v0} = 1.0\\times 10^{-7}\\ \\mathrm{m}^2/\\mathrm{s}$, $e_0 = 1.0$, $\\Delta e = 0.2$, $t_{\\mathrm{char}} = 1.0\\times 10^{5}\\ \\mathrm{s}$, $p = 1.0$, $\\alpha = 1.0\\ \\text{per unit void ratio}$, $t_{\\mathrm{end}} = 3.0\\times 10^{5}\\ \\mathrm{s}$.\n- Case B (strong evolution, faster early change): $H_{dr} = 0.5\\ \\mathrm{m}$, $u_0 = 50.0\\ \\mathrm{kPa}$, $c_{v0} = 5.0\\times 10^{-8}\\ \\mathrm{m}^2/\\mathrm{s}$, $e_0 = 1.2$, $\\Delta e = 0.6$, $t_{\\mathrm{char}} = 5.0\\times 10^{4}\\ \\mathrm{s}$, $p = 2.0$, $\\alpha = 3.0\\ \\text{per unit void ratio}$, $t_{\\mathrm{end}} = 1.0\\times 10^{5}\\ \\mathrm{s}$.\n- Case C (very strong evolution, front-loaded change): $H_{dr} = 2.0\\ \\mathrm{m}$, $u_0 = 80.0\\ \\mathrm{kPa}$, $c_{v0} = 2.0\\times 10^{-7}\\ \\mathrm{m}^2/\\mathrm{s}$, $e_0 = 1.5$, $\\Delta e = 0.8$, $t_{\\mathrm{char}} = 2.0\\times 10^{5}\\ \\mathrm{s}$, $p = 0.5$, $\\alpha = 2.5\\ \\text{per unit void ratio}$, $t_{\\mathrm{end}} = 6.0\\times 10^{5}\\ \\mathrm{s}$.\n\nAngle units are not used in this problem. All physical quantities must be handled in the units stated above. The final reported errors are dimensionless and must be expressed as decimal numbers.\n\nFinal output format:\n- Your program should produce a single line of output containing a Python-style list of three elements, one per test case. Each element is a two-element list of floats $[\\varepsilon_{\\mathrm{rel}}(t_{\\mathrm{end}}),\\ \\max\\{\\varepsilon_{\\mathrm{rel}}(0.2\\,t_{\\mathrm{end}}),\\varepsilon_{\\mathrm{rel}}(0.5\\,t_{\\mathrm{end}}),\\varepsilon_{\\mathrm{rel}}(0.8\\,t_{\\mathrm{end}}),\\varepsilon_{\\mathrm{rel}}(t_{\\mathrm{end}})\\}]$. For example: \"[[x_A,y_A],[x_B,y_B],[x_C,y_C]]\".", "solution": "### Analytical Derivation and Solution Methodology\n\nThe problem describes the one-dimensional consolidation of a saturated soil layer, governed by a diffusion-type equation with a time-dependent coefficient of consolidation, $c_v(e(t))$. The governing equation in non-dimensional spatial coordinates $y \\in [0,1]$ is:\n$$\n\\frac{\\partial u}{\\partial t}(y,t) = \\frac{c_v(e(t))}{H_{dr}^2}\\,\\frac{\\partial^2 u}{\\partial y^2}(y,t)\n$$\nThe problem is subject to a uniform initial condition $u(y,0) = u_0$ and homogeneous Dirichlet boundary conditions $u(0,t) = 0$ and $u(1,t) = 0$.\n\nThe coefficient of consolidation $c_v$ is a function of the void ratio $e$, which itself is a prescribed function of time $t$ only. This functional dependence on time, but not on the spatial coordinate $y$, is a crucial feature that permits a simplification via a change of time variable.\n\nWe introduce the nonlinear time reparameterization $\\tau(t)$ as defined in the problem:\n$$\n\\tau(t) = \\int_0^t \\frac{c_v(e(t'))}{H_{dr}^2}\\,\\mathrm{d}t'\n$$\nBy the Fundamental Theorem of Calculus, the derivative of $\\tau$ with respect to $t$ is:\n$$\n\\frac{\\mathrm{d}\\tau}{\\mathrm{d}t} = \\frac{c_v(e(t))}{H_{dr}^2}\n$$\nLet us define a new function $\\tilde{u}(y, \\tau) = u(y, t(\\tau))$, where $t(\\tau)$ is the inverse of the strictly monotonic function $\\tau(t)$ (since $c_v > 0$ and $H_{dr}^2 > 0$, $\\mathrm{d}\\tau/\\mathrm{d}t > 0$). Using the chain rule for the time derivative of $u$:\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial \\tilde{u}}{\\partial \\tau} \\frac{\\mathrm{d}\\tau}{\\mathrm{d}t} = \\frac{\\partial \\tilde{u}}{\\partial \\tau} \\left(\\frac{c_v(e(t))}{H_{dr}^2}\\right)\n$$\nThe spatial derivatives are unaffected by the change of time variable, so $\\frac{\\partial^2 u}{\\partial y^2} = \\frac{\\partial^2 \\tilde{u}}{\\partial y^2}$. Substituting the transformed time derivative into the original governing equation yields:\n$$\n\\frac{\\partial \\tilde{u}}{\\partial \\tau} \\left(\\frac{c_v(e(t))}{H_{dr}^2}\\right) = \\frac{c_v(e(t))}{H_{dr}^2}\\,\\frac{\\partial^2 \\tilde{u}}{\\partial y^2}\n$$\nSince the term $c_v(e(t))/H_{dr}^2$ is strictly positive, it can be cancelled from both sides, leading to the linear, constant-coefficient diffusion equation (the heat equation):\n$$\n\\frac{\\partial \\tilde{u}}{\\partial \\tau} = \\frac{\\partial^2 \\tilde{u}}{\\partial y^2}\n$$\nThe initial and boundary conditions must also be transformed. At $t=0$, $\\tau(0) = \\int_0^0 (\\dots) \\mathrm{d}t' = 0$. The initial condition $u(y,0) = u_0$ thus becomes $\\tilde{u}(y,0) = u_0$. The boundary conditions $u(0,t) = 0$ and $u(1,t) = 0$ become $\\tilde{u}(0,\\tau) = 0$ and $\\tilde{u}(1,\\tau) = 0$ for all $\\tau \\ge 0$.\n\nThe transformed problem is the classic initial-boundary value problem for the heat equation on a finite domain:\n$$\n\\frac{\\partial \\tilde{u}}{\\partial \\tau} = \\frac{\\partial^2 \\tilde{u}}{\\partial y^2}, \\quad y \\in (0,1), \\tau > 0\n$$\n$$\n\\tilde{u}(0, \\tau) = 0, \\quad \\tilde{u}(1, \\tau) = 0\n$$\n$$\n\\tilde{u}(y, 0) = u_0\n$$\nThis problem is solved using the method of separation of variables, which yields a Fourier series solution. The solution is constructed as a superposition of eigenfunctions $\\sin(n\\pi y)$ for $n=1, 2, 3, \\ldots$:\n$$\n\\tilde{u}(y, \\tau) = \\sum_{n=1}^{\\infty} B_n \\exp(-(n\\pi)^2 \\tau) \\sin(n\\pi y)\n$$\nThe coefficients $B_n$ are determined from the initial condition $\\tilde{u}(y,0) = u_0$ via Fourier series expansion:\n$$\nB_n = \\frac{\\int_0^1 u_0 \\sin(n\\pi y) \\mathrm{d}y}{\\int_0^1 \\sin^2(n\\pi y) \\mathrm{d}y} = \\frac{u_0[-\\cos(n\\pi y)/(n\\pi)]_0^1}{1/2} = \\frac{2u_0}{n\\pi}(1 - (-1)^n)\n$$\nThe coefficient $B_n$ is zero for even $n$ and $B_n = \\frac{4u_0}{n\\pi}$ for odd $n$. We can write $n = 2k-1$ for $k=1, 2, 3, \\ldots$ to sum over odd integers only:\n$$\n\\tilde{u}(y, \\tau) = \\sum_{k=1}^{\\infty} \\frac{4 u_0}{(2k-1)\\pi} \\sin((2k-1)\\pi y) \\exp\\left(-((2k-1)\\pi)^2 \\tau\\right)\n$$\nA valid solution method for $u(y,t)$ is to first compute the value of the pseudo-time $\\tau(t)$ at a desired time $t$ via numerical integration and then evaluate the above series for $\\tilde{u}(y, \\tau(t))$.\n\n### Numerical Implementation Strategy\n\nTo evaluate the accuracy of the reparameterization, we compare two numerical solutions at specified observation times.\n\n1.  **Direct Numerical Reference Solution ($u_{\\mathrm{num}}$)**: We solve the original PDE with a time-dependent coefficient using the Crank–Nicolson (CN) method. The spatial domain $y \\in [0,1]$ is discretized into $N_y+1$ intervals of width $\\Delta y = 1/(N_y+1)$, yielding $N_y$ interior nodes. The time domain $[0, t_{\\mathrm{end}}]$ is discretized into $N_t$ steps of size $\\Delta t = t_{\\mathrm{end}}/N_t$. The CN scheme, centered at time $t_{k+1/2} = t_k + \\Delta t/2$, is:\n    $$\n    \\frac{U^{k+1} - U^k}{\\Delta t} = \\frac{D(t_{k+1/2})}{2} \\left( \\mathcal{L} U^{k+1} + \\mathcal{L} U^k \\right)\n    $$\n    where $U^k$ is the vector of nodal values at time $t_k$, $D(t) = c_v(e(t))/H_{dr}^2$, and $\\mathcal{L}$ is the finite difference operator for the second spatial derivative. This rearranges into a linear system for each time step:\n    $$\n    \\left(I - \\frac{\\Delta t D(t_{k+1/2})}{2} \\mathcal{L}\\right) U^{k+1} = \\left(I + \\frac{\\Delta t D(t_{k+1/2})}{2} \\mathcal{L}\\right) U^k\n    $$\n    The matrices on both sides are tridiagonal. The system is solved at each step from $k=0$ to $N_t-1$, starting with the initial condition $U^0 = u_0$. The solution vectors at specified observation times are stored.\n\n2.  **Transformed Solution ($u_{\\mathrm{trans}}$)**: This solution is calculated by leveraging the analytical result. At each specified observation time $t_{\\mathrm{obs}}$, we perform two steps:\n    a. We compute the pseudo-time $\\tau(t_{\\mathrm{obs}})$ by numerically integrating its definition:\n    $$\n    \\tau(t_{\\mathrm{obs}}) = \\int_0^{t_{\\mathrm{obs}}} \\frac{c_v(e(t'))}{H_{dr}^2}\\,\\mathrm{d}t'\n    $$\n    This integral is evaluated using a high-precision adaptive quadrature routine provided by `scipy.integrate.quad`.\n    b. We evaluate the truncated Fourier series solution for $\\tilde{u}(y, \\tau(t_{\\mathrm{obs}}))$ across all spatial nodes $y_j$. The series is truncated to $M=400$ terms, as specified.\n\n3.  **Error Calculation**: The relative error $\\varepsilon_{\\mathrm{rel}}(t)$ is computed at each observation time $t \\in \\{0.2\\,t_{\\mathrm{end}},\\,0.5\\,t_{\\mathrm{end}},\\,0.8\\,t_{\\mathrm{end}},\\,t_{\\mathrm{end}}\\}$ using the provided formula:\n    $$\n    \\varepsilon_{\\mathrm{rel}}(t) = \\frac{\\left\\lVert u_{\\mathrm{trans}}(\\cdot,t) - u_{\\mathrm{num}}(\\cdot,t)\\right\\rVert_2}{\\max\\!\\left(\\left\\lVert u_{\\mathrm{num}}(\\cdot,t)\\right\\rVert_2,\\ \\varepsilon_{\\mathrm{floor}}\\right)}\n    $$\n    where $\\lVert \\cdot \\rVert_2$ is the standard discrete Euclidean norm of the solution vectors at the $N_y$ interior nodes. The final output for each test case consists of the error at the final time, $\\varepsilon_{\\mathrm{rel}}(t_{\\mathrm{end}})$, and the maximum error observed over the set of observation times.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the one-dimensional consolidation problem for three test cases,\n    comparing a direct Crank-Nicolson method with a time-transformed spectral method.\n    \"\"\"\n    \n    test_cases = [\n        # Case A (moderate evolution)\n        {'Hdr': 1.0, 'u0': 100.0, 'cv0': 1.0e-7, 'e0': 1.0, 'de': 0.2, \n         'tchar': 1.0e5, 'p': 1.0, 'alpha': 1.0, 'tend': 3.0e5},\n        # Case B (strong evolution, faster early change)\n        {'Hdr': 0.5, 'u0': 50.0, 'cv0': 5.0e-8, 'e0': 1.2, 'de': 0.6, \n         'tchar': 5.0e4, 'p': 2.0, 'alpha': 3.0, 'tend': 1.0e5},\n        # Case C (very strong evolution, front-loaded change)\n        {'Hdr': 2.0, 'u0': 80.0, 'cv0': 2.0e-7, 'e0': 1.5, 'de': 0.8, \n         'tchar': 2.0e5, 'p': 0.5, 'alpha': 2.5, 'tend': 6.0e5}\n    ]\n\n    Ny = 200\n    Nt = 2000\n    M = 400\n    epsilon_floor = 1e-12\n    \n    final_results = []\n\n    for case_params in test_cases:\n        case_results = solve_case(case_params, Ny, Nt, M, epsilon_floor)\n        final_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"{final_results}\")\n\n\ndef solve_case(params, Ny, Nt, M, epsilon_floor):\n    \"\"\"\n    Solves a single test case for the consolidation problem.\n    \"\"\"\n    Hdr = params['Hdr']\n    u0 = params['u0']\n    cv0 = params['cv0']\n    e0 = params['e0']\n    de = params['de']\n    tchar = params['tchar']\n    p = params['p']\n    alpha = params['alpha']\n    tend = params['tend']\n    \n    # Helper functions for material properties\n    def e_func(t):\n        if t = 0: return e0\n        return e0 - de * (1.0 - np.exp(-(t / tchar)**p))\n\n    def D_func(t):\n        return (cv0 / Hdr**2) * np.exp(alpha * (e_func(t) - e0))\n\n    # --- 1. Direct Numerical Solution (Crank-Nicolson) ---\n    dy = 1.0 / (Ny + 1)\n    dt = tend / Nt\n    y_nodes = np.linspace(dy, 1.0 - dy, Ny)\n    \n    u_num_current = np.full(Ny, u0, dtype=float)\n    \n    obs_indices = np.round(np.array([0.2, 0.5, 0.8, 1.0]) * Nt).astype(int)\n    t_steps = np.linspace(0, tend, Nt + 1)\n    obs_times = t_steps[obs_indices]\n    \n    u_num_results = {}\n    \n    ab_A = np.zeros((3, Ny), dtype=float)\n\n    for k in range(Nt):\n        t_mid = (k + 0.5) * dt\n        D_mid = D_func(t_mid)\n        r_k = (D_mid * dt) / (2.0 * dy**2)\n        \n        # Build RHS vector V = B_k * u_num_current\n        V = np.zeros(Ny, dtype=float)\n        # Sliced operation for interior\n        V[1:-1] = r_k * u_num_current[:-2] + (1.0 - 2.0 * r_k) * u_num_current[1:-1] + r_k * u_num_current[2:]\n        # Boundary-adjacent nodes\n        V[0] = (1.0 - 2.0 * r_k) * u_num_current[0] + r_k * u_num_current[1]\n        V[-1] = r_k * u_num_current[-2] + (1.0 - 2.0 * r_k) * u_num_current[-1]\n        \n        # Build LHS matrix A_k in banded format\n        ab_A[0, 1:] = -r_k\n        ab_A[1, :] = 1.0 + 2.0 * r_k\n        ab_A[2, :-1] = -r_k\n\n        u_num_current = solve_banded((1, 1), ab_A, V, check_finite=False)\n        \n        if (k + 1) in obs_indices:\n            u_num_results[k + 1] = u_num_current.copy()\n\n    # --- 2. Transformed Solution (Spectral Method)  Error Calculation ---\n    \n    # Pre-compute Fourier series terms that are constant in time\n    k_modes = np.arange(1, M + 1)\n    n_modes = 2 * k_modes - 1\n    sin_terms = np.sin(np.pi * np.outer(n_modes, y_nodes))\n    \n    rel_errors = []\n\n    for idx, t_obs in zip(obs_indices, obs_times):\n        # Calculate tau(t_obs) via numerical quadrature\n        tau_t, _ = integrate.quad(D_func, 0, t_obs, epsabs=1e-12, epsrel=1e-12)\n        \n        # Evaluate spectral solution u_trans at tau_t\n        Bn_exp_terms = (4.0 * u0 / (n_modes * np.pi)) * np.exp(-(n_modes * np.pi)**2 * tau_t)\n        u_trans = Bn_exp_terms @ sin_terms\n        \n        # Retrieve corresponding CN solution\n        u_num = u_num_results[idx]\n        \n        # Calculate relative error\n        diff_norm = np.linalg.norm(u_trans - u_num)\n        num_norm = np.linalg.norm(u_num)\n        \n        rel_error = diff_norm / max(num_norm, epsilon_floor)\n        rel_errors.append(rel_error)\n\n    err_at_tend = rel_errors[-1]\n    max_err_over_obs = max(rel_errors)\n    \n    return [err_at_tend, max_err_over_obs]\n\n\nsolve()\n```", "id": "3547324"}]}