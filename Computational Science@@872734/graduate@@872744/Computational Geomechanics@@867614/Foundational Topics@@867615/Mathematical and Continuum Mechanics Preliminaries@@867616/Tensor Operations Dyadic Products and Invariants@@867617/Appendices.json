{"hands_on_practices": [{"introduction": "In geomechanics, the behavior of materials like soil and rock is often described by constitutive models that must be independent of the observer's coordinate system. This is achieved by formulating these models in terms of scalar invariants of the stress tensor. This first practice focuses on computing the three principal invariants ($I_1, I_2, I_3$), which form the fundamental basis for all other stress invariants. By deriving these quantities from the characteristic equation of a stress tensor and then calculating them for a given example, you will build a core skill for analyzing stress states [@problem_id:3567001].", "problem": "In computational geomechanics, isotropic constitutive models and yield functions often depend on scalar invariants of the Cauchy stress tensor. Consider a non-dimensionalized symmetric second-order tensor $T$ that represents the stress state of a soil element obtained from a finite element computation under quasi-static loading. The principal invariants are the scalar coefficients of the characteristic polynomial of $T$, defined by\n$$\np(\\lambda) = \\det(\\lambda I - T) = \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3}\n$$\nwhere $I$ is the second-order identity tensor. Starting from this definition and standard tensor operations, derive expressions for $I_{1}$, $I_{2}$, and $I_{3}$ in terms of the trace, the determinant, and the trace of the square of $T$. Your derivation must rely only on the spectral representation of $T$, properties of the trace operator, the dyadic product, and the Frobenius inner product.\n\nThen, compute the invariants for\n$$\nT=\\begin{bmatrix}3&-1&0\\\\-1&2&1\\\\0&1&1\\end{bmatrix}\n$$\nExpress the final triplet $(I_{1},I_{2},I_{3})$ as a row matrix using the LaTeX pmatrix environment. No rounding is necessary and no physical units are required.", "solution": "The problem is assessed to be valid. It is scientifically grounded in tensor algebra and continuum mechanics, well-posed, objective, and contains all necessary information for a unique solution.\n\nThe problem consists of two parts: first, a derivation of the principal invariants $I_{1}$, $I_{2}$, and $I_{3}$ of a symmetric second-order tensor $T$ in terms of its trace, determinant, and the trace of its square; second, a computation of these invariants for a specific tensor.\n\n### Part 1: Derivation of the Invariants\n\nWe are given the characteristic polynomial of a second-order tensor $T$ in a $3$-dimensional space:\n$$\np(\\lambda) = \\det(\\lambda I - T) = \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3}\n$$\nThe roots of this polynomial, $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$, are the eigenvalues of $T$. The characteristic polynomial can therefore be written in its factored form:\n$$\np(\\lambda) = (\\lambda - \\lambda_{1})(\\lambda - \\lambda_{2})(\\lambda - \\lambda_{3})\n$$\nExpanding this factored form yields:\n$$\np(\\lambda) = (\\lambda^{2} - (\\lambda_{1} + \\lambda_{2})\\lambda + \\lambda_{1}\\lambda_{2})(\\lambda - \\lambda_{3})\n$$\n$$\np(\\lambda) = \\lambda^{3} - \\lambda_{3}\\lambda^{2} - (\\lambda_{1} + \\lambda_{2})\\lambda^{2} + (\\lambda_{1} + \\lambda_{2})\\lambda_{3}\\lambda + \\lambda_{1}\\lambda_{2}\\lambda - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\n$$\np(\\lambda) = \\lambda^{3} - (\\lambda_{1} + \\lambda_{2} + \\lambda_{3})\\lambda^{2} + (\\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1})\\lambda - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\nBy comparing the coefficients of this expanded polynomial with the given definition, we identify the principal invariants in terms of the eigenvalues:\n$$\nI_{1} = \\lambda_{1} + \\lambda_{2} + \\lambda_{3}\n$$\n$$\nI_{2} = \\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1}\n$$\n$$\nI_{3} = \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\nThe next step is to relate these expressions to the specified tensor operations. The tensor $T$ is stated to be symmetric, which guarantees that it has real eigenvalues and an orthonormal basis of eigenvectors $\\{n_{1}, n_{2}, n_{3}\\}$. This allows for the spectral representation of $T$:\n$$\nT = \\sum_{i=1}^{3} \\lambda_{i} (n_{i} \\otimes n_{i})\n$$\nwhere $\\otimes$ denotes the dyadic product.\n\n**Derivation of $I_{1}$:**\nThe first invariant, $I_{1}$, is the sum of the eigenvalues. This is, by definition, the trace of the tensor $T$, denoted $\\operatorname{tr}(T)$. We can demonstrate this using the spectral representation and properties of the trace operator. The trace is a linear operator, so:\n$$\n\\operatorname{tr}(T) = \\operatorname{tr}\\left(\\sum_{i=1}^{3} \\lambda_{i} (n_{i} \\otimes n_{i})\\right) = \\sum_{i=1}^{3} \\lambda_{i} \\operatorname{tr}(n_{i} \\otimes n_{i})\n$$\nThe trace of a dyadic product $u \\otimes v$ is their scalar product, $\\operatorname{tr}(u \\otimes v) = u \\cdot v$. Since the eigenvectors $\\{n_{i}\\}$ form an orthonormal basis, $n_{i} \\cdot n_{i} = \\|n_{i}\\|^{2} = 1$. Thus, $\\operatorname{tr}(n_{i} \\otimes n_{i}) = 1$.\n$$\n\\operatorname{tr}(T) = \\sum_{i=1}^{3} \\lambda_{i} (1) = \\lambda_{1} + \\lambda_{2} + \\lambda_{3}\n$$\nTherefore, the first invariant is the trace of the tensor:\n$$\nI_{1} = \\operatorname{tr}(T)\n$$\n\n**Derivation of $I_{3}$:**\nThe third invariant, $I_{3}$, is the product of the eigenvalues. This is a fundamental property of the determinant of a tensor.\n$$\nI_{3} = \\lambda_{1}\\lambda_{2}\\lambda_{3} = \\det(T)\n$$\n\n**Derivation of $I_{2}$:**\nThe derivation for the second invariant, $I_{2}$, requires more algebraic manipulation. We start by considering the square of the first invariant:\n$$\nI_{1}^{2} = (\\lambda_{1} + \\lambda_{2} + \\lambda_{3})^{2} = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2} + 2(\\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1})\n$$\nRecognizing the expressions for $I_{2}$ and the sum of squared eigenvalues, we can write:\n$$\nI_{1}^{2} = \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) + 2I_{2}\n$$\nRearranging for $I_{2}$:\n$$\nI_{2} = \\frac{1}{2} \\left[ I_{1}^{2} - \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) \\right] = \\frac{1}{2} \\left[ (\\operatorname{tr}(T))^{2} - \\left(\\sum_{i=1}^{3} \\lambda_{i}^{2}\\right) \\right]\n$$\nNow we must relate the sum of squared eigenvalues, $\\sum_{i=1}^{3} \\lambda_{i}^{2}$, to a tensor operation. Let's consider the tensor $T^{2} = T \\cdot T$. The eigenvalues of $T^{2}$ are the squares of the eigenvalues of $T$, i.e., $\\lambda_{1}^{2}, \\lambda_{2}^{2}, \\lambda_{3}^{2}$. Consequently, the trace of $T^{2}$ is the sum of its eigenvalues:\n$$\n\\operatorname{tr}(T^{2}) = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2}\n$$\nThis can be shown more formally using the Frobenius inner product ($A:B = \\operatorname{tr}(A^{T}B)$), as requested. For the symmetric tensor $T$, $\\operatorname{tr}(T^{2}) = \\operatorname{tr}(T^{T}T) = T:T$. The Frobenius inner product is invariant under an orthonormal change of basis. In the principal basis of eigenvectors $\\{n_i\\}$, the tensor $T$ is represented by a diagonal matrix with entries $\\lambda_1, \\lambda_2, \\lambda_3$. The Frobenius inner product in this basis is simply the sum of squares of the diagonal entries:\n$$\n\\operatorname{tr}(T^{2}) = T:T = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2}\n$$\nSubstituting this result into the expression for $I_{2}$:\n$$\nI_{2} = \\frac{1}{2} [(\\operatorname{tr}(T))^{2} - \\operatorname{tr}(T^{2})]\n$$\nThe derivations are now complete.\n\n### Part 2: Computation for the specific tensor\n\nWe are given the tensor:\n$$\nT=\\begin{bmatrix}3&-1&0\\\\-1&2&1\\\\0&1&1\\end{bmatrix}\n$$\nWe compute the invariants using the derived formulas.\n\n**Compute $I_{1}$:**\nThe first invariant is the trace of $T$.\n$$\nI_{1} = \\operatorname{tr}(T) = 3 + 2 + 1 = 6\n$$\n\n**Compute $I_{3}$:**\nThe third invariant is the determinant of $T$.\n$$\nI_{3} = 3\\begin{vmatrix} 2 & 1 \\\\ 1 & 1 \\end{vmatrix} - (-1)\\begin{vmatrix} -1 & 1 \\\\ 0 & 1 \\end{vmatrix} + 0\\begin{vmatrix} -1 & 2 \\\\ 0 & 1 \\end{vmatrix}\n$$\n$$\nI_{3} = 3(2 \\cdot 1 - 1 \\cdot 1) + 1(-1 \\cdot 1 - 0 \\cdot 1) + 0 = 3(1) + 1(-1) = 3 - 1 = 2\n$$\n\n**Compute $I_{2}$:**\nTo compute $I_{2}$, we first need to find $T^{2}$ and its trace.\n$$\nT^{2} = T \\cdot T = \\begin{bmatrix}3&-1&0\\\\-1&2&1\\\\0&1&1\\end{bmatrix} \\begin{bmatrix}3&-1&0\\\\-1&2&1\\\\0&1&1\\end{bmatrix}\n$$\n$$\nT^{2} = \\begin{bmatrix} (3)(3)+(-1)(-1)+(0)(0) & (3)(-1)+(-1)(2)+(0)(1) & (3)(0)+(-1)(1)+(0)(1) \\\\ (-1)(3)+(2)(-1)+(1)(0) & (-1)(-1)+(2)(2)+(1)(1) & (-1)(0)+(2)(1)+(1)(1) \\\\ (0)(3)+(1)(-1)+(1)(0) & (0)(-1)+(1)(2)+(1)(1) & (0)(0)+(1)(1)+(1)(1) \\end{bmatrix}\n$$\n$$\nT^{2} = \\begin{bmatrix} 9+1 & -3-2 & -1 \\\\ -3-2 & 1+4+1 & 2+1 \\\\ -1 & 2+1 & 1+1 \\end{bmatrix} = \\begin{bmatrix} 10 & -5 & -1 \\\\ -5 & 6 & 3 \\\\ -1 & 3 & 2 \\end{bmatrix}\n$$\nThe trace of $T^{2}$ is:\n$$\n\\operatorname{tr}(T^{2}) = 10 + 6 + 2 = 18\n$$\nNow we can compute $I_{2}$:\n$$\nI_{2} = \\frac{1}{2} [(\\operatorname{tr}(T))^{2} - \\operatorname{tr}(T^{2})] = \\frac{1}{2} [6^{2} - 18] = \\frac{1}{2} [36 - 18] = \\frac{1}{2} [18] = 9\n$$\nThe principal invariants are $I_{1}=6$, $I_{2}=9$, and $I_{3}=2$.\n\nThe final result is the triplet $(I_{1}, I_{2}, I_{3})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 6 & 9 & 2 \\end{pmatrix}}\n$$", "id": "3567001"}, {"introduction": "While the principal invariants are mathematically fundamental, engineering practice often requires quantities with more direct physical meaning. A crucial concept in continuum mechanics is the decomposition of stress into a part that causes volume change (hydrostatic stress) and a part that causes shape change or distortion (deviatoric stress). This exercise bridges the gap between abstract invariants and physical interpretation by tasking you with calculating the mean stress, $p$, and a common measure of the magnitude of the deviatoric stress, $q$. Mastering this decomposition is essential for applying plasticity theories, such as critical state soil mechanics, to predict material failure [@problem_id:3567039].", "problem": "A point within a geomaterial element in a three-dimensional continuum has the Cauchy stress tensor $\\boldsymbol{\\sigma}$ (in megapascals (MPa)) given by\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix}\n50 & 5 & 0\\\\\n5 & 45 & -4\\\\\n0 & -4 & 40\n\\end{bmatrix}\n$$\nStarting from first principles in tensor analysis used in computational geomechanics, do the following:\n- Use the definition of the mean (hydrostatic) stress $p$ as one-third of the first invariant of the Cauchy stress, that is, $p=\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$.\n- Define the deviatoric stress tensor as $\\boldsymbol{s}=\\boldsymbol{\\sigma}-p\\,\\boldsymbol{I}$, where $\\boldsymbol{I}$ is the second-order identity tensor, and the second invariant of the deviatoric stress as $J_{2}=\\frac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$.\n- Define the commonly used deviatoric stress measure in critical state soil mechanics as $q=\\sqrt{3\\,J_{2}}$.\n\nDerive, from these definitions and the properties of tensor contractions and dyadic products, the expressions necessary to compute $p$ and $q$ for the given $\\boldsymbol{\\sigma}$, and then evaluate $p$ and $q$. Express your final result as the ordered pair $(p,q)$ in megapascals (MPa). Provide $p$ exactly and $q$ in exact analytic form (do not round). State your final answer as a single row vector.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard exercise in continuum mechanics, specifically in the field of computational geomechanics, involving the decomposition of the Cauchy stress tensor and the calculation of its invariants. All provided data and definitions are standard and consistent. We may therefore proceed with the solution.\n\nThe problem requires the computation of two stress invariants, the mean (hydrostatic) stress $p$ and the von Mises equivalent stress $q$, for a given Cauchy stress tensor $\\boldsymbol{\\sigma}$. The procedure will follow the definitions provided in the problem statement.\n\nThe given Cauchy stress tensor is:\n$$\n\\boldsymbol{\\sigma} = \\begin{bmatrix}\n50 & 5 & 0\\\\\n5 & 45 & -4\\\\\n0 & -4 & 40\n\\end{bmatrix} \\text{ MPa}\n$$\nThe components of this tensor are $\\sigma_{ij}$ in a Cartesian coordinate system.\n\nFirst, we compute the mean stress, $p$. It is defined as one-third of the first invariant of the Cauchy stress tensor, which is its trace. The trace of a second-order tensor $\\boldsymbol{A}$, denoted $\\operatorname{tr}(\\boldsymbol{A})$, is the sum of its diagonal components, $A_{ii} = A_{11} + A_{22} + A_{33}$.\nAccording to the definition provided:\n$$\np = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3} (\\sigma_{11} + \\sigma_{22} + \\sigma_{33})\n$$\nSubstituting the diagonal components from the given stress tensor:\n$$\np = \\frac{1}{3} (50 + 45 + 40) = \\frac{1}{3} (135) = 45 \\text{ MPa}\n$$\n\nNext, we determine the deviatoric stress tensor, $\\boldsymbol{s}$. The deviatoric stress represents the part of the stress tensor that causes shape distortion (shear). It is defined as the total stress tensor minus the hydrostatic stress component:\n$$\n\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}\n$$\nwhere $\\boldsymbol{I}$ is the second-order identity tensor, whose components are given by the Kronecker delta, $\\delta_{ij}$.\n$$\n\\boldsymbol{I} = \\begin{bmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{bmatrix}\n$$\nUsing the calculated value of $p=45$, we have:\n$$\np\\,\\boldsymbol{I} = 45 \\begin{bmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{bmatrix} = \\begin{bmatrix}\n45 & 0 & 0\\\\\n0 & 45 & 0\\\\\n0 & 0 & 45\n\\end{bmatrix}\n$$\nNow, we subtract this from the Cauchy stress tensor $\\boldsymbol{\\sigma}$:\n$$\n\\boldsymbol{s} = \\begin{bmatrix}\n50 & 5 & 0\\\\\n5 & 45 & -4\\\\\n0 & -4 & 40\n\\end{bmatrix} - \\begin{bmatrix}\n45 & 0 & 0\\\\\n0 & 45 & 0\\\\\n0 & 0 & 45\n\\end{bmatrix} = \\begin{bmatrix}\n50-45 & 5-0 & 0-0\\\\\n5-0 & 45-45 & -4-0\\\\\n0-0 & -4-0 & 40-45\n\\end{bmatrix}\n$$\nThis results in the deviatoric stress tensor:\n$$\n\\boldsymbol{s} = \\begin{bmatrix}\n5 & 5 & 0\\\\\n5 & 0 & -4\\\\\n0 & -4 & -5\n\\end{bmatrix} \\text{ MPa}\n$$\nAs a verification, the trace of the deviatoric stress tensor must be zero: $\\operatorname{tr}(\\boldsymbol{s}) = 5 + 0 + (-5) = 0$. This is consistent with its definition.\n\nThe next step is to compute the second invariant of the deviatoric stress tensor, $J_2$. The problem defines this as:\n$$\nJ_2 = \\frac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}\n$$\nThe double dot product of a tensor with itself, $\\boldsymbol{s}:\\boldsymbol{s}$, is the sum of the squares of all its components: $\\boldsymbol{s}:\\boldsymbol{s} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} s_{ij}s_{ij}$.\nUsing the components of $\\boldsymbol{s}$:\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = s_{11}^2 + s_{12}^2 + s_{13}^2 + s_{21}^2 + s_{22}^2 + s_{23}^2 + s_{31}^2 + s_{32}^2 + s_{33}^2\n$$\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = (5)^2 + (5)^2 + (0)^2 + (5)^2 + (0)^2 + (-4)^2 + (0)^2 + (-4)^2 + (-5)^2\n$$\n$$\n\\boldsymbol{s}:\\boldsymbol{s} = 25 + 25 + 0 + 25 + 0 + 16 + 0 + 16 + 25 = 132\n$$\nThe units of $\\boldsymbol{s}:\\boldsymbol{s}$ are $\\text{MPa}^2$.\nNow, we can compute $J_2$:\n$$\nJ_2 = \\frac{1}{2} (132) = 66 \\text{ MPa}^2\n$$\n\nFinally, we compute the deviatoric stress measure $q$, which is proportional to the square root of $J_2$ and is a common measure of shear stress magnitude in plasticity theories. It is defined as:\n$$\nq = \\sqrt{3 J_2}\n$$\nSubstituting the value of $J_2=66$:\n$$\nq = \\sqrt{3 \\times 66} = \\sqrt{198}\n$$\nTo express this in exact analytic form, we simplify the radical. The prime factorization of $198$ is $2 \\times 99 = 2 \\times 9 \\times 11 = 2 \\times 3^2 \\times 11$:\n$$\nq = \\sqrt{3^2 \\times 22} = 3\\sqrt{22} \\text{ MPa}\n$$\n\nThe required computations are complete. The ordered pair $(p, q)$ is $(45, 3\\sqrt{22})$, with both values in units of megapascals (MPa).", "answer": "$$\n\\boxed{\\begin{pmatrix} 45 & 3\\sqrt{22} \\end{pmatrix}}\n$$", "id": "3567039"}, {"introduction": "Having learned to calculate various stress invariants, the final and most critical step is to confirm their defining characteristic: invariance. A quantity is an invariant if its value does not change under a rotation of the coordinate axes. This computational practice challenges you to move beyond simple calculation and into verification, by building a unit test to demonstrate that quantities like $p$, $q$, and the Lode angle $\\theta$ remain constant when the stress tensor is subjected to arbitrary rotations. Successfully completing this exercise will provide you with a robust, practical understanding of why invariants are indispensable in computational geomechanics [@problem_id:3567010].", "problem": "Construct a complete, runnable program that implements a deterministic unit-test suite to verify the rotational invariance of stress tensor invariants in three-dimensional computational geomechanics. Let $Q \\in \\mathrm{SO}(3)$ be a rotation and let the Cauchy stress tensor be a real symmetric second-order tensor $\\sigma \\in \\mathbb{R}^{3 \\times 3}$. Under a change of basis by $Q$, the stress transforms as $\\sigma \\mapsto \\sigma' = Q \\,\\sigma\\, Q^\\top$. From first principles, invariants are basis-independent quantities constructed from the eigenvalues of $\\sigma$, and therefore they should remain unchanged by such a transformation.\n\nYour program must:\n- Implement the principal invariants of a second-order tensor $\\sigma$:\n  - $I_1 = \\mathrm{tr}(\\sigma)$,\n  - $I_2 = \\tfrac{1}{2}\\big(\\mathrm{tr}(\\sigma)^2 - \\mathrm{tr}(\\sigma^2)\\big)$,\n  - $I_3 = \\det(\\sigma)$.\n- Implement the mean stress $p$, the second invariant of the deviatoric stress $J_2$, the stress measure $q$, and the Lode angle $\\theta$:\n  - $p = \\tfrac{1}{3} I_1$,\n  - $s = \\sigma - p\\,\\mathbf{I}$ with $\\mathbf{I}$ the identity tensor,\n  - $J_2 = \\tfrac{1}{2} s:s = \\tfrac{1}{2}\\mathrm{tr}(s^2)$,\n  - $q = \\sqrt{3 J_{2}}$,\n  - $\\theta = \\tfrac{1}{3}\\arccos\\!\\Big( \\tfrac{3\\sqrt{3}}{2} \\dfrac{J_3}{J_2^{3/2}} \\Big)$ with $J_3 = \\det(s)$, using the convention that if $J_2$ is below a small positive threshold then set $q=0$ and $\\theta=0$. The Lode angle must be computed in radians.\n\nYou must verify numerically, for multiple test cases, that $I_1$, $I_2$, $I_3$, $p$, $q$, and $\\theta$ are invariant under the transformation $\\sigma \\mapsto Q \\sigma Q^\\top$ for randomly sampled $Q \\in \\mathrm{SO}(3)$. Random rotations $Q$ must be sampled to be uniformly distributed with respect to the Haar measure on $\\mathrm{SO}(3)$. A numerically stable approach is to draw a random matrix with independent and identically distributed standard normal entries, compute its orthogonal-triangular factorization (often referred to as the orthogonal-triangular or $QR$ decomposition), and then enforce $\\det(Q)=+1$ by flipping the sign of one column if necessary.\n\nUse a relative tolerance $r_{\\text{tol}} = 10^{-10}$ and an absolute tolerance $a_{\\text{tol}} = 10^{-12}$ when comparing floating-point quantities. Angles must be compared in radians using the same tolerances. All random samplings must be deterministic via given seeds.\n\nTest suite specification:\n- Each test case must return a boolean indicating whether all invariance checks passed for that case.\n- The test suite consists of the following five cases. In each case, use the provided rotation seed and number of rotations; for cases that generate random stresses, use the provided stress seed. For any case using hydrostatic or constructed stresses, only the rotation sampling is random.\n\nCase A (general random symmetric stresses, “happy path”):\n- Type: random symmetric.\n- Stress seed: $42$.\n- Rotation seed: $31415$.\n- Number of stresses: $4$.\n- Number of rotations per stress: $8$.\n- Stress scale: $1.0$.\n\nCase B (purely hydrostatic stresses, $q=0$ and $\\theta=0$ by convention):\n- Type: hydrostatic.\n- Hydrostatic pressures $p$ (in the sense of $p=\\tfrac{1}{3}I_1$): $[-3.0,\\,0.0,\\,5.5]$.\n- Rotation seed: $27182$.\n- Number of rotations per stress: $8$.\n\nCase C (pure shear stresses, with $J_3=0$):\n- Type: pure shear with $\\sigma = \\begin{bmatrix}0 & \\tau & 0\\\\ \\tau & 0 & 0\\\\ 0 & 0 & 0\\end{bmatrix}$ for each $\\tau$ listed.\n- Shear values $\\tau$: $[0.7,\\,-2.3]$.\n- Rotation seed: $16180$.\n- Number of rotations per stress: $8$.\n\nCase D (nearly hydrostatic stresses with very small deviatoric part, to probe numerical stability near $J_2 \\approx 0$):\n- Type: near-hydrostatic random.\n- Stress seed: $123$.\n- Rotation seed: $14142$.\n- Number of stresses: $3$.\n- Number of rotations per stress: $8$.\n- Deviatoric magnitude scale $\\varepsilon = 10^{-8}$.\n- Hydrostatic pressure magnitude bound: draw $p$ uniformly from $[-10.0,\\,10.0]$.\n\nCase E (fixed diagonal anisotropic stresses):\n- Type: diagonal.\n- Diagonals: $\\{(9.0,\\,-4.0,\\,2.0),\\,(100.0,\\,0.01,\\,-1.0)\\}$.\n- Rotation seed: $17320$.\n- Number of rotations per stress: $8$.\n\nFor each test case, do the following: construct the specified set of stresses, sample the specified number of random rotations $Q \\in \\mathrm{SO}(3)$, transform each stress as $\\sigma' = Q \\sigma Q^\\top$, and compare the pre- and post-rotation values of $I_1$, $I_2$, $I_3$, $p$, $q$, and $\\theta$ using the tolerances $r_{\\text{tol}}$ and $a_{\\text{tol}}$. A test case passes if and only if all comparisons pass for all stresses and all rotations in that case.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$, where each $\\text{result}_k$ is a boolean for the corresponding case in the order A, B, C, D, E.\n- Angles must be handled in radians. There are no physical units to report in the output.", "solution": "The user-provided problem statement is assessed to be **valid**. It is scientifically grounded in the principles of continuum mechanics, specifically tensor analysis as applied to computational geomechanics. The problem is well-posed, providing all necessary definitions, constants, and parameters for a deterministic and verifiable solution. The language is objective and unambiguous. It falls squarely within the specified topic of tensor operations and their invariants.\n\nThe task is to construct a unit-test suite in Python to numerically verify that specific scalar invariants of the Cauchy stress tensor $\\sigma$ are unchanged under a proper orthogonal transformation (rotation) of the coordinate system. The transformation rule for a second-order tensor is given by $\\sigma' = Q \\sigma Q^\\top$, where $Q$ is a rotation matrix, i.e., $Q \\in \\mathrm{SO}(3)$ meaning $Q Q^\\top = Q^\\top Q = \\mathbf{I}$ and $\\det(Q) = +1$.\n\nThe solution is implemented by following these steps:\n1.  **Implementation of Invariant Calculations**: A function is designed to compute the six specified invariants for any given $3 \\times 3$ symmetric stress tensor $\\sigma$.\n    - The principal invariants $I_1(\\sigma)$, $I_2(\\sigma)$, and $I_3(\\sigma)$ are computed directly from their definitions involving the trace and determinant:\n        $$ I_1 = \\mathrm{tr}(\\sigma) $$\n        $$ I_2 = \\frac{1}{2}\\left( (\\mathrm{tr}(\\sigma))^2 - \\mathrm{tr}(\\sigma^2) \\right) $$\n        $$ I_3 = \\det(\\sigma) $$\n    - The remaining quantities are derived from these and the deviatoric stress tensor, $s = \\sigma - p\\mathbf{I}$, where $p = \\frac{1}{3}I_1$ is the mean stress.\n        - The second invariant of the deviatoric stress, $J_2$, is given by:\n          $$ J_2 = \\frac{1}{2} s:s = \\frac{1}{2} \\mathrm{tr}(s^2) $$\n        - The von Mises equivalent stress, $q$, is defined as:\n          $$ q = \\sqrt{3 J_2} $$\n        - The Lode angle, $\\theta$, is defined in terms of $J_2$ and the third deviatoric invariant $J_3 = \\det(s)$:\n          $$ \\theta = \\frac{1}{3}\\arccos\\left( \\frac{3\\sqrt{3}}{2} \\frac{J_3}{J_2^{3/2}} \\right) $$\n    - A critical part of the implementation is handling the numerical stability for $q$ and $\\theta$ when $J_2$ is close to zero (i.e., for nearly hydrostatic stress states). As specified, if $J_2$ falls below a small positive threshold, both $q$ and $\\theta$ are set to zero. A suitable choice for this threshold is the absolute tolerance $a_{\\text{tol}} = 10^{-12}$ used for comparisons. Additionally, the argument of the $\\arccos$ function is clipped to the interval $[-1, 1]$ to prevent domain errors arising from floating-point inaccuracies.\n\n2.  **Generation of Random Rotation Matrices**: To test the invariance, we need to generate random rotation matrices $Q \\in \\mathrm{SO}(3)$ that are uniformly distributed with respect to the Haar measure. The problem specifies a standard and numerically stable method:\n    - Generate a $3 \\times 3$ matrix $A$ with entries drawn from an independent and identically distributed standard normal distribution.\n    - Compute the QR decomposition of $A$, which yields $A = QR$, where $Q$ is an orthogonal matrix and $R$ is an upper triangular matrix.\n    - The determinant of an orthogonal matrix is either $+1$ or $-1$. To ensure $Q$ is a proper rotation (i.e., $\\det(Q) = +1$), we check its determinant. If $\\det(Q) < 0$, we multiply one of its columns (e.g., the last one) by $-1$. This flips the sign of the determinant while preserving orthogonality, resulting in a matrix $Q \\in \\mathrm{SO}(3)$.\n    - This process is repeated for the required number of rotations, using a specified random seed for deterministic reproducibility.\n\n3.  **Generation of Stress Tensors**: For each test case, a specific set of stress tensors is constructed. This involves:\n    - **Random Symmetric Tensors (Case A)**: A random $3 \\times 3$ matrix $M$ is generated, and a symmetric tensor is formed via $\\sigma = \\frac{1}{2}(M + M^\\top)$, then scaled.\n    - **Hydrostatic Tensors (Case B)**: For a given pressure $p$, the tensor is $\\sigma = p \\mathbf{I}$.\n    - **Pure Shear Tensors (Case C)**: These are constructed directly as $\\sigma = \\begin{pmatrix} 0 & \\tau & 0 \\\\ \\tau & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$.\n    - **Near-Hydrostatic Tensors (Case D)**: A stress tensor is formed as $\\sigma = p\\mathbf{I} + s_{\\text{dev}}$, where $p$ is a random hydrostatic pressure and $s_{\\text{dev}}$ is a deviatoric tensor with a very small magnitude, controlled by a scale factor $\\varepsilon = 10^{-8}$. This probes the numerical behavior near $J_2=0$.\n    - **Diagonal Tensors (Case E)**: These are directly constructed from a given set of principal stresses, $\\sigma = \\mathrm{diag}(\\sigma_1, \\sigma_2, \\sigma_3)$.\n\n4.  **Verification Logic**: The core of the test suite is a loop that iterates through each specified stress tensor and each generated rotation matrix. For each pair $(\\sigma, Q)$:\n    - The six invariants are calculated for the original stress tensor $\\sigma$.\n    - The stress tensor is transformed: $\\sigma' = Q \\sigma Q^\\top$.\n    - The six invariants are calculated for the transformed tensor $\\sigma'$.\n    - Each original invariant is compared to its transformed counterpart. The comparison uses `numpy.allclose` with the specified relative tolerance $r_{\\text{tol}} = 10^{-10}$ and absolute tolerance $a_{\\text{tol}} = 10^{-12}$.\n    - A test case is marked as passed (`True`) only if all invariant comparisons are successful for all stress tensors and all rotations within that case. If any single comparison fails, the entire test case fails (`False`).\n\n5.  **Final Output**: The boolean results from the five test cases (A, B, C, D, E) are collected into a list and printed to standard output in the specified format: `[result_A,result_B,result_C,result_D,result_E]`.\n\nThis systematic approach ensures that all requirements of the problem are met, providing a robust and deterministic verification of the fundamental principle of rotational invariance for stress invariants.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a deterministic unit-test suite to verify the rotational\n    invariance of stress tensor invariants.\n    \"\"\"\n    \n    TOL_REL = 1e-10\n    TOL_ABS = 1e-12\n    J2_THRESHOLD = TOL_ABS\n\n    def generate_random_rotations(num_rotations, seed):\n        \"\"\"\n        Generates random rotation matrices Q in SO(3) using the QR decomposition method.\n        The distribution is uniform with respect to the Haar measure.\n        \"\"\"\n        rng = np.random.default_rng(seed)\n        rotations = []\n        for _ in range(num_rotations):\n            A = rng.normal(size=(3, 3))\n            Q, _ = np.linalg.qr(A)\n            # Ensure Q is a proper rotation matrix (det(Q) = +1)\n            if np.linalg.det(Q) < 0:\n                Q[:, -1] *= -1\n            rotations.append(Q)\n        return rotations\n\n    def create_invariants_calculator(j2_threshold):\n        \"\"\"\n        Creates a callable function that calculates the six stress invariants.\n        The j2_threshold is captured by the closure.\n        \"\"\"\n        def calculate_invariants(sigma):\n            \"\"\"\n            Calculates the principal invariants (I1, I2, I3) and derived\n            invariants (p, q, theta) for a given stress tensor.\n            \"\"\"\n            # Principal invariants\n            I1 = np.trace(sigma)\n            I2 = 0.5 * (I1**2 - np.trace(sigma @ sigma))\n            I3 = np.linalg.det(sigma)\n\n            # Mean stress and deviatoric stress tensor\n            p = I1 / 3.0\n            s = sigma - p * np.identity(3)\n\n            # Deviatoric invariants and related quantities\n            J2 = 0.5 * np.trace(s @ s)\n\n            if J2 < j2_threshold:\n                q = 0.0\n                theta = 0.0\n            else:\n                q = np.sqrt(3.0 * J2)\n                J3 = np.linalg.det(s)\n                \n                # Argument for arccos, can be slightly outside [-1, 1] due to float errors\n                arg = (3.0 * np.sqrt(3.0) / 2.0) * J3 / (J2**1.5)\n                arg = np.clip(arg, -1.0, 1.0)\n                \n                theta = (1.0 / 3.0) * np.arccos(arg)\n            \n            return (I1, I2, I3, p, q, theta)\n        return calculate_invariants\n\n    invariants_calculator = create_invariants_calculator(J2_THRESHOLD)\n\n    def generate_stresses(params):\n        \"\"\"\n        Generates a list of stress tensors based on the test case parameters.\n        \"\"\"\n        stresses = []\n        case_type = params['type']\n        \n        if case_type == 'random_symmetric':\n            rng = np.random.default_rng(params['stress_seed'])\n            for _ in range(params['num_stresses']):\n                M = rng.normal(size=(3, 3))\n                sigma = 0.5 * (M + M.T) * params['stress_scale']\n                stresses.append(sigma)\n        elif case_type == 'hydrostatic':\n            for p_val in params['pressures']:\n                stresses.append(p_val * np.identity(3))\n        elif case_type == 'pure_shear':\n            for tau in params['shear_values']:\n                sigma = np.array([[0.0, tau, 0.0], [tau, 0.0, 0.0], [0.0, 0.0, 0.0]])\n                stresses.append(sigma)\n        elif case_type == 'near_hydrostatic':\n            rng = np.random.default_rng(params['stress_seed'])\n            epsilon = params['dev_scale']\n            p_bound = params['p_bound']\n            for _ in range(params['num_stresses']):\n                p_val = rng.uniform(-p_bound, p_bound)\n                \n                # Generate a random deviatoric tensor and scale it\n                S_rand = rng.normal(size=(3, 3))\n                S_rand = 0.5 * (S_rand + S_rand.T) \n                s_dev_unscaled = S_rand - (np.trace(S_rand) / 3.0) * np.identity(3)\n                \n                norm = np.linalg.norm(s_dev_unscaled)\n                if norm < 1e-15:  # Avoid division by zero if tensor is accidentally zero\n                    s_dev_unscaled = np.array([[1.0, 0.0, 0.0], [0.0, -1.0, 0.0], [0.0, 0.0, 0.0]])\n                    norm = np.linalg.norm(s_dev_unscaled)\n                    \n                s_dev = epsilon * s_dev_unscaled / norm\n                sigma = p_val * np.identity(3) + s_dev\n                stresses.append(sigma)\n        elif case_type == 'diagonal':\n            for d in params['diagonals']:\n                stresses.append(np.diag(d))\n                \n        return stresses\n\n    def run_test_case(params):\n        \"\"\"\n        Runs a single test case and returns True if all checks pass, False otherwise.\n        \"\"\"\n        stresses = generate_stresses(params)\n        rotations = generate_random_rotations(params['num_rotations'], params['rotation_seed'])\n\n        for sigma in stresses:\n            original_invariants = invariants_calculator(sigma)\n            for Q in rotations:\n                sigma_prime = Q @ sigma @ Q.T\n                transformed_invariants = invariants_calculator(sigma_prime)\n\n                for orig_inv, trans_inv in zip(original_invariants, transformed_invariants):\n                    if not np.allclose(orig_inv, trans_inv, rtol=TOL_REL, atol=TOL_ABS):\n                        return False\n        return True\n\n    test_cases_spec = [\n        # Case A\n        {'type': 'random_symmetric', 'stress_seed': 42, 'rotation_seed': 31415,\n         'num_stresses': 4, 'num_rotations': 8, 'stress_scale': 1.0},\n        # Case B\n        {'type': 'hydrostatic', 'pressures': [-3.0, 0.0, 5.5],\n         'rotation_seed': 27182, 'num_rotations': 8},\n        # Case C\n        {'type': 'pure_shear', 'shear_values': [0.7, -2.3],\n         'rotation_seed': 16180, 'num_rotations': 8},\n        # Case D\n        {'type': 'near_hydrostatic', 'stress_seed': 123, 'rotation_seed': 14142,\n         'num_stresses': 3, 'num_rotations': 8, 'dev_scale': 1e-8, 'p_bound': 10.0},\n        # Case E\n        {'type': 'diagonal', 'diagonals': [(9.0, -4.0, 2.0), (100.0, 0.01, -1.0)],\n         'rotation_seed': 17320, 'num_rotations': 8}\n    ]\n\n    results = [run_test_case(params) for params in test_cases_spec]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3567010"}]}