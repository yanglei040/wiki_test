{"hands_on_practices": [{"introduction": "The abstract definition of the material derivative is powerful, but for practical problem-solving, it must be expressed in a specific coordinate system. This exercise ([@problem_id:3542145]) provides rigorous practice in deriving the material derivative's component form in spherical coordinates, a common setting for geomechanical problems like radial flow to a well or expansion of a spherical cavity. By working from first principles, you will solidify your understanding of the chain rule's role and see how symmetry assumptions reduce a complex three-dimensional expression to a familiar one-dimensional form.", "problem": "Consider a saturated porous solid with a spherically symmetric radially directed seepage flow in three dimensions, in which the pore fluid velocity field is purely radial, given by $\\mathbf{v}(\\mathbf{x},t)=v_{r}(r,t)\\,\\mathbf{e}_{r}$, where $(r,\\theta,\\varphi)$ are the spherical coordinates, $\\mathbf{e}_{r}$ is the radial unit vector, and $r=|\\mathbf{x}|$. Let $\\phi(\\mathbf{x},t)$ be a scalar material property of the pore fluid (e.g., a dissolved tracer concentration) that is transported with the fluid. Assume spherical symmetry of the scalar field, so that $\\phi(\\mathbf{x},t)=\\phi(r,t)$.\n\nStarting only from the definition of the material (or substantial) time derivative as the time rate of change following a material particle,\n$$\n\\frac{D\\phi}{Dt} \\equiv \\frac{d}{dt}\\,\\phi(\\mathbf{x}(t),t),\n$$\nand from the kinematics of a particle trajectory written in spherical coordinates $\\mathbf{x}(t)\\leftrightarrow\\big(r(t),\\theta(t),\\varphi(t)\\big)$, carry out the following:\n\n1. Use the chain rule with the spherical coordinates $\\big(r,\\theta,\\varphi\\big)$ to express $\\frac{D\\phi}{Dt}$ in terms of $\\frac{\\partial \\phi}{\\partial t}$ and the partial derivatives of $\\phi$ with respect to $r$, $\\theta$, and $\\varphi$, together with the coordinate time rates $\\dot{r}$, $\\dot{\\theta}$, and $\\dot{\\varphi}$.\n\n2. Specialize your expression to the given spherically symmetric setting with purely radial flow, and argue kinematically which coordinate time rates vanish along a trajectory. Then, obtain an explicit closed-form expression for $\\frac{D\\phi}{Dt}$ in terms of $\\frac{\\partial \\phi}{\\partial t}$, $v_{r}(r,t)$, and $\\frac{\\partial \\phi}{\\partial r}$.\n\n3. Introduce the one-dimensional Cartesian coordinate mapping $s=r$, the one-dimensional velocity $u(s,t)=v_{r}(r,t)$, and the scalar field $\\psi(s,t)=\\phi(r,t)$ along a radial line. Using these definitions, demonstrate that the expression you obtained in step 2 coincides in form with the standard one-dimensional Cartesian material derivative of a scalar field.\n\nExpress your final answer as a single closed-form analytic expression for $\\frac{D\\phi}{Dt}$ in terms of $\\frac{\\partial \\phi}{\\partial t}$, $v_{r}$, and $\\frac{\\partial \\phi}{\\partial r}$. No units are required, and no numerical evaluation is needed.", "solution": "The problem is valid as it is scientifically grounded in continuum mechanics, well-posed, objective, and internally consistent. It presents a standard derivation exercise concerning the material time derivative in a specific curvilinear coordinate system under symmetry constraints. I will proceed with the solution by addressing the three tasks in sequence.\n\nThe first task is to derive a general expression for the material (or substantial) time derivative, $\\frac{D\\phi}{Dt}$, in spherical coordinates. The definition is given as the total time derivative of a scalar field $\\phi$ following a material particle trajectory $\\mathbf{x}(t)$:\n$$\n\\frac{D\\phi}{Dt} \\equiv \\frac{d}{dt}\\,\\phi(\\mathbf{x}(t),t)\n$$\nIn spherical coordinates $(r, \\theta, \\varphi)$, the position of a particle is described by functions of time, $\\mathbf{x}(t) \\leftrightarrow \\big(r(t), \\theta(t), \\varphi(t)\\big)$. The scalar field $\\phi$ is generally a function of these coordinates and time, $\\phi = \\phi(r, \\theta, \\varphi, t)$. To find the total derivative of $\\phi\\big(r(t), \\theta(t), \\varphi(t), t\\big)$ with respect to time $t$, we apply the multivariate chain rule:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t}\\frac{dt}{dt} + \\frac{\\partial \\phi}{\\partial r}\\frac{dr}{dt} + \\frac{\\partial \\phi}{\\partial \\theta}\\frac{d\\theta}{dt} + \\frac{\\partial \\phi}{\\partial \\varphi}\\frac{d\\varphi}{dt}\n$$\nGiven that $\\frac{dt}{dt}=1$, and using the dot notation for the time derivatives of the coordinates, $\\dot{r} \\equiv \\frac{dr}{dt}$, $\\dot{\\theta} \\equiv \\frac{d\\theta}{dt}$, and $\\dot{\\varphi} \\equiv \\frac{d\\varphi}{dt}$, the expression becomes:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\dot{r}\\frac{\\partial \\phi}{\\partial r} + \\dot{\\theta}\\frac{\\partial \\phi}{\\partial \\theta} + \\dot{\\varphi}\\frac{\\partial \\phi}{\\partial \\varphi}\n$$\nThis is the general expression for the material derivative in spherical coordinates, which completes the first task.\n\nThe second task requires specializing this expression for the given spherically symmetric setting with purely radial flow. The fluid velocity vector $\\mathbf{v}$ is, by definition, the time derivative of the particle's position vector, $\\mathbf{v} = \\frac{d\\mathbf{x}}{dt}$. In spherical coordinates, the velocity vector is related to the coordinate time rates by:\n$$\n\\mathbf{v} = \\dot{r}\\,\\mathbf{e}_{r} + (r\\dot{\\theta})\\,\\mathbf{e}_{\\theta} + (r\\sin\\theta\\,\\dot{\\varphi})\\,\\mathbf{e}_{\\varphi}\n$$\nwhere $\\mathbf{e}_{r}$, $\\mathbf{e}_{\\theta}$, and $\\mathbf{e}_{\\varphi}$ are the orthonormal basis vectors. The problem states that the flow is purely radial, given by $\\mathbf{v}(\\mathbf{x}, t) = v_{r}(r,t)\\mathbf{e}_{r}$. To kinematically satisfy this condition, we must equate the components of the general velocity expression with the given one:\n\\begin{itemize}\n    \\item Radial component: $\\dot{r} = v_{r}(r,t)$.\n    \\item Polar component: $r\\dot{\\theta} = 0$.\n    \\item Azimuthal component: $r\\sin\\theta\\,\\dot{\\varphi} = 0$.\n\\end{itemize}\nFor a particle not located at the origin ($r > 0$), the condition $r\\dot{\\theta} = 0$ implies that $\\dot{\\theta} = 0$. For a particle not on the polar axis ($z$-axis, where $\\sin\\theta = 0$), the condition $r\\sin\\theta\\,\\dot{\\varphi} = 0$ implies that $\\dot{\\varphi} = 0$. Thus, a purely radial flow kinematically requires that the angular coordinates of a moving fluid particle remain constant, so their time rates of change, $\\dot{\\theta}$ and $\\dot{\\varphi}$, are zero.\n\nFurthermore, the scalar field $\\phi$ is also spherically symmetric, $\\phi(\\mathbf{x},t) = \\phi(r,t)$, which means it is independent of $\\theta$ and $\\varphi$. Consequently, its partial derivatives with respect to the angular coordinates vanish: $\\frac{\\partial\\phi}{\\partial\\theta} = 0$ and $\\frac{\\partial\\phi}{\\partial\\varphi} = 0$.\n\nSubstituting the kinematic results $\\dot{r} = v_{r}$, $\\dot{\\theta} = 0$, and $\\dot{\\varphi} = 0$ into the general expression for $\\frac{D\\phi}{Dt}$:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t)\\frac{\\partial \\phi}{\\partial r} + (0)\\frac{\\partial \\phi}{\\partial \\theta} + (0)\\frac{\\partial \\phi}{\\partial \\varphi}\n$$\nThe expression simplifies to the required closed form:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t)\\frac{\\partial \\phi}{\\partial r}\n$$\n\nThe third task is to show that this result is equivalent in form to the one-dimensional Cartesian material derivative using the provided mappings: $s=r$, $u(s,t)=v_{r}(r,t)$, and $\\psi(s,t)=\\phi(r,t)$. The material derivative of a scalar field $\\psi(s,t)$ in a one-dimensional Cartesian system with coordinate $s$ and velocity $u(s,t)$ is:\n$$\n\\frac{D\\psi}{Dt} = \\frac{\\partial \\psi}{\\partial t} + u(s,t) \\frac{\\partial \\psi}{\\partial s}\n$$\nThis form arises from the general definition $\\frac{D\\psi}{Dt} = \\frac{\\partial \\psi}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\psi$, where in one dimension $\\mathbf{v} = u(s,t)\\mathbf{e}_{s}$ and $\\nabla = \\mathbf{e}_{s}\\frac{\\partial}{\\partial s}$. Now, we apply the given mappings to this equation:\n\\begin{itemize}\n    \\item Since $\\psi(s,t) = \\phi(r(s),t)$ and $r=s$, holding $s$ constant is the same as holding $r$ constant, so $\\frac{\\partial \\psi}{\\partial t} = \\frac{\\partial \\phi}{\\partial t}$.\n    \\item By definition, $u(s,t) = v_{r}(r,t)$.\n    \\item By the chain rule, $\\frac{\\partial \\psi}{\\partial s} = \\frac{\\partial \\phi}{\\partial r}\\frac{dr}{ds}$. Since $s=r$, $\\frac{dr}{ds}=1$, so $\\frac{\\partial \\psi}{\\partial s} = \\frac{\\partial \\phi}{\\partial r}$.\n\\end{itemize}\nSubstituting these equivalences back into the one-dimensional Cartesian expression for $\\frac{D\\psi}{Dt}$ yields:\n$$\n\\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t) \\frac{\\partial \\phi}{\\partial r}\n$$\nThis result is identical to the expression for $\\frac{D\\phi}{Dt}$ derived in the second task. This demonstrates that the advection of a spherically symmetric field by a purely radial flow is mathematically analogous to a one-dimensional advection problem along a line. The final requested expression is the result from the second task.", "answer": "$$\n\\boxed{\\frac{\\partial \\phi}{\\partial t} + v_{r} \\frac{\\partial \\phi}{\\partial r}}\n$$", "id": "3542145"}, {"introduction": "Translating the continuum equations of mechanics into a stable and accurate computer algorithm is a central challenge in computational geomechanics. This practice ([@problem_id:3542201]) focuses on the advective part of the material derivative, exploring the critical concept of numerical stability for an explicit time-integration scheme. By performing a von Neumann stability analysis, you will derive the celebrated Courant-Friedrichs-Lewy (CFL) condition, a fundamental constraint that governs the maximum allowable time step in many simulations involving advective transport.", "problem": "Consider a one-dimensional advection-dominated transport of a scalar field $\\phi(x,t)$, representative of a kinematic pore-scale quantity in computational geomechanics (for example, a dye concentration moving with the seepage velocity in a saturated soil column). The material time derivative is defined by $D\\phi/Dt = \\partial \\phi/\\partial t + v\\,\\partial \\phi/\\partial x$, where the velocity $v$ is taken to be spatially uniform and positive over the domain. Neglect diffusion and sources so that the governing balance reduces to pure advection, and adopt a uniform grid of spacing $h$ over a periodic domain. Discretize time with the forward Euler method applied to $\\partial \\phi/\\partial t$ and discretize space with a first-order upwind difference applied to $v\\,\\partial \\phi/\\partial x$. Assume that the discrete field is represented at cell centers $\\{x_i\\}$.\n\nStarting from the governing balance and these discretization choices, derive the stability requirement for this explicit scheme by analyzing the evolution of discrete Fourier modes under periodic boundary conditions. Then specialize your result to compute the maximum stable time step $\\Delta t_{\\max}$ for the parameter values $h = 0.05\\,\\text{m}$ and $v = 1.2 \\times 10^{-4}\\,\\text{m}/\\text{s}$. Express the final answer in seconds and round your numerical result to four significant figures. Your final answer must be a single real number.", "solution": "### Step 1: Extract Givens\n- **Governing Equation**: The material time derivative is $D\\phi/Dt = \\partial \\phi/\\partial t + v\\,\\partial \\phi/\\partial x$. The governing balance is pure advection, so $D\\phi/Dt=0$. This gives the one-dimensional linear advection equation: $\\partial \\phi/\\partial t + v\\,\\partial \\phi/\\partial x = 0$.\n- **Scalar Field**: $\\phi(x,t)$ is a scalar field.\n- **Velocity**: $v$ is a spatially uniform and positive constant.\n- **Domain**: A uniform grid with spacing $h$ over a periodic domain. The discrete field is represented at cell centers $\\{x_i\\}$.\n- **Discretization Method**:\n    - **Time**: Forward Euler method for the term $\\partial \\phi/\\partial t$.\n    - **Space**: First-order upwind difference for the term $v\\,\\partial \\phi/\\partial x$.\n- **Method of Analysis**: Stability is to be analyzed using discrete Fourier modes under periodic boundary conditions (von Neumann stability analysis).\n- **Parameter Values**:\n    - Grid spacing, $h = 0.05\\,\\text{m}$.\n    - Velocity, $v = 1.2 \\times 10^{-4}\\,\\text{m}/\\text{s}$.\n- **Objective**:\n    1. Derive the stability requirement for the specified explicit scheme.\n    2. Compute the maximum stable time step, $\\Delta t_{\\max}$, for the given parameters.\n    3. Round the numerical result to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against the specified criteria.\n- **Scientifically Grounded**: The problem is based on the linear advection equation, a fundamental model in physics and engineering. The discretization methods (Forward Euler, First-Order Upwind) and the method of analysis (von Neumann stability) are standard, well-established techniques in numerical analysis for partial differential equations. The physical parameters are plausible for geomechanical applications. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a clear governing equation, well-defined discretization rules, boundary conditions (periodic), initial conditions (implicit in the Fourier mode analysis), and a specific, unambiguous objective. A unique and meaningful solution exists.\n- **Objective**: The problem is stated in precise, formal language, free of subjectivity or ambiguity.\n- **Completeness**: All necessary information to derive the stability condition and compute the numerical answer is provided. The assumption $v  0$ is crucial and is stated, making the choice of the upwind stencil unambiguous. The periodic boundary conditions are explicitly mentioned, which is the prerequisite for the specified von Neumann analysis.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-posed, scientifically grounded, and standard problem in computational methods. The solution process will now proceed.\n\n### Solution Derivation\nThe governing partial differential equation (PDE) for one-dimensional linear advection is:\n$$\n\\frac{\\partial \\phi}{\\partial t} + v \\frac{\\partial \\phi}{\\partial x} = 0\n$$\nWe discretize this equation on a uniform grid where $x_i = i h$ and $t_n = n \\Delta t$. The solution $\\phi(x_i, t_n)$ is approximated by the discrete variable $\\phi_i^n$.\n\nThe time derivative $\\partial \\phi/\\partial t$ is discretized using the forward Euler method:\n$$\n\\frac{\\partial \\phi}{\\partial t} \\bigg|_{i,n} \\approx \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t}\n$$\nThe spatial derivative $\\partial \\phi/\\partial x$ is discretized using the first-order upwind scheme. Since the velocity $v$ is given as positive ($v  0$), the \"upwind\" direction is the negative $x$-direction, so the scheme uses nodes $i$ and $i-1$:\n$$\n\\frac{\\partial \\phi}{\\partial x} \\bigg|_{i,n} \\approx \\frac{\\phi_i^n - \\phi_{i-1}^n}{h}\n$$\nSubstituting these discrete approximations into the governing PDE yields the finite difference equation (FDE):\n$$\n\\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} + v \\left(\\frac{\\phi_i^n - \\phi_{i-1}^n}{h}\\right) = 0\n$$\nTo analyze the stability, we first rearrange the FDE to express $\\phi_i^{n+1}$ in terms of values at the previous time step $n$:\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{v \\Delta t}{h} (\\phi_i^n - \\phi_{i-1}^n)\n$$\nWe define the Courant number, $C$, as the dimensionless parameter $C = \\frac{v \\Delta t}{h}$. The FDE becomes:\n$$\n\\phi_i^{n+1} = \\phi_i^n - C(\\phi_i^n - \\phi_{i-1}^n)\n$$\n$$\n\\phi_i^{n+1} = (1 - C)\\phi_i^n + C\\phi_{i-1}^n\n$$\nFor the von Neumann stability analysis, we consider a single Fourier mode as a solution to the FDE:\n$$\n\\phi_i^n = \\hat{\\phi}^n(k) e^{I k x_i} = \\hat{\\phi}^n(k) e^{I k i h}\n$$\nwhere $\\hat{\\phi}^n(k)$ is the amplitude of the mode with wavenumber $k$ at time step $n$, and $I = \\sqrt{-1}$ is the imaginary unit. Substituting this into the FDE:\n$$\n\\hat{\\phi}^{n+1} e^{I k i h} = (1 - C) \\hat{\\phi}^n e^{I k i h} + C \\hat{\\phi}^n e^{I k (i-1) h}\n$$\nWe can divide the entire equation by $e^{I k i h}$:\n$$\n\\hat{\\phi}^{n+1} = (1 - C) \\hat{\\phi}^n + C \\hat{\\phi}^n e^{-I k h}\n$$\nThe amplification factor, $G(k)$, is defined by the relation $\\hat{\\phi}^{n+1} = G(k) \\hat{\\phi}^n$. From the equation above, we can identify $G(k)$ as:\n$$\nG(k) = 1 - C + C e^{-I k h}\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must not exceed unity for all possible wavenumbers $k$, i.e., $|G(k)| \\le 1$. We analyze the magnitude squared, $|G(k)|^2$. Using Euler's formula, $e^{-I \\theta} = \\cos(\\theta) - I \\sin(\\theta)$, we have:\n$$\nG(k) = 1 - C + C(\\cos(kh) - I \\sin(kh)) = (1 - C + C\\cos(kh)) - I(C\\sin(kh))\n$$\nThe magnitude squared is the sum of the squares of the real and imaginary parts:\n$$\n|G(k)|^2 = (1 - C + C\\cos(kh))^2 + (-C\\sin(kh))^2\n$$\n$$\n|G(k)|^2 = (1 - C(1-\\cos(kh)))^2 + C^2\\sin^2(kh)\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + C^2(1-\\cos(kh))^2 + C^2\\sin^2(kh)\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + C^2(1 - 2\\cos(kh) + \\cos^2(kh)) + C^2\\sin^2(kh)\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + C^2(1 - 2\\cos(kh) + \\cos^2(kh) + \\sin^2(kh))\n$$\nUsing the identity $\\cos^2(kh) + \\sin^2(kh) = 1$:\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + C^2(2 - 2\\cos(kh))\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + 2C^2(1-\\cos(kh))\n$$\n$$\n|G(k)|^2 = 1 + (2C^2 - 2C)(1-\\cos(kh)) = 1 + 2C(C-1)(1-\\cos(kh))\n$$\nThe stability condition $|G(k)|^2 \\le 1$ becomes:\n$$\n1 + 2C(C-1)(1-\\cos(kh)) \\le 1\n$$\n$$\n2C(C-1)(1-\\cos(kh)) \\le 0\n$$\nLet's analyze the terms in this inequality.\n- The Courant number $C = \\frac{v \\Delta t}{h}$ is positive since $v  0$, $\\Delta t  0$, and $h  0$.\n- The term $(1 - \\cos(kh))$ is always non-negative, as $\\cos(kh)$ is always between $-1$ and $1$. Specifically, $0 \\le 1-\\cos(kh) \\le 2$.\nSince $C  0$ and $(1-\\cos(kh)) \\ge 0$, the inequality holds if and only if the term $(C-1)$ is non-positive:\n$$\nC - 1 \\le 0 \\implies C \\le 1\n$$\nThis is the celebrated Courant-Friedrichs-Lewy (CFL) stability condition for the first-order upwind scheme. The stability requirement is that the Courant number must be less than or equal to $1$.\n$$\n\\frac{v \\Delta t}{h} \\le 1\n$$\nTo find the maximum stable time step, $\\Delta t_{\\max}$, we set the Courant number to its maximum allowed value of $1$:\n$$\n\\Delta t \\le \\frac{h}{v} \\implies \\Delta t_{\\max} = \\frac{h}{v}\n$$\nNow we substitute the given numerical values: $h = 0.05\\,\\text{m}$ and $v = 1.2 \\times 10^{-4}\\,\\text{m}/\\text{s}$.\n$$\n\\Delta t_{\\max} = \\frac{0.05}{1.2 \\times 10^{-4}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{5 \\times 10^{-2}}{1.2 \\times 10^{-4}} = \\frac{5}{1.2} \\times 10^{2} = \\frac{50}{12} \\times 100 = \\frac{25}{6} \\times 100\n$$\n$$\n\\Delta t_{\\max} = 4.1666... \\times 100 = 416.666... \\,\\text{s}\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\n\\Delta t_{\\max} \\approx 416.7 \\,\\text{s}\n$$", "answer": "$$\n\\boxed{416.7}\n$$", "id": "3542201"}, {"introduction": "In advanced computational methods like the Arbitrary Lagrangian-Eulerian (ALE) formulation, the computational mesh moves independently of the material, offering great flexibility for modeling large deformations. This introduces a challenge: ensuring that computed physical quantities are not corrupted by the non-physical mesh motion. This exercise ([@problem_id:3542191]) tasks you with verifying the objectivity of the material time derivative with respect to the grid's motion, demonstrating that its computed value is independent of the computational grid's velocity by deriving and verifying two equivalent formulas.", "problem": "Consider an Arbitrary Lagrangian–Eulerian (ALE) setting for large deformation in computational geomechanics. Let the spatial coordinates be denoted by $x = (x_1, x_2) \\in \\mathbb{R}^2$ and time by $t \\in \\mathbb{R}$. A smooth spatial second-order tensor field $T(x,t) \\in \\mathbb{R}^{2 \\times 2}$ is given component-wise by\n$$\nT_{11}(x,t) = \\sin(\\alpha\\, t) + x_1^2 + x_2,\\quad\nT_{12}(x,t) = T_{21}(x,t) = \\tfrac{1}{2}\\cos(\\beta\\, t)\\, x_1 - \\tfrac{1}{4} x_2^2,\\quad\nT_{22}(x,t) = \\mathrm{e}^{\\mu\\, t} + x_1 x_2,\n$$\nwhere $\\alpha, \\beta, \\mu \\in \\mathbb{R}$ are given constants.\n\nThe physical motion is described by a spatial velocity field $v^{m}(x,t) \\in \\mathbb{R}^2$ that is affine in space,\n$$\nv^{m}(x,t) = B\\, x + c,\n$$\nwhere $B \\in \\mathbb{R}^{2 \\times 2}$ and $c \\in \\mathbb{R}^2$ are time-independent constants. The computational mesh undergoes a rigid rotation about the origin with angular velocity $\\omega_g \\in \\mathbb{R}$, so that the mesh velocity is\n$$\nv^{g}(x,t) = W_g\\, x,\\quad\\text{with}\\quad W_g = \\omega_g \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix}.\n$$\n\nStarting only from fundamental definitions, namely that the material time derivative of a spatial tensor field along the physical motion is the time derivative taken along particle trajectories and that a change of variables between descriptions introduces a chain rule with the appropriate transport velocity, do the following:\n\n1. Derive a component-wise expression for the material time derivative of $T(x,t)$ along the physical motion, using the temporal rate at fixed spatial point and the physical convective transport. Express this entirely in terms of $x$, $t$, $\\partial T/\\partial t$ at fixed $x$, spatial gradients of $T$, and $v^{m}(x,t)$.\n\n2. Derive a component-wise expression for the same material time derivative using the temporal rate at fixed mesh coordinates and the relative convective transport. Express this entirely in terms of $x$, $t$, the temporal rate at fixed mesh coordinates, spatial gradients of $T$, and the relative velocity $v^{r}(x,t) = v^{m}(x,t) - v^{g}(x,t)$.\n\n3. Implement both expressions and verify, for each test case below, that they are equal up to a numerical tolerance $\\delta = 10^{-10}$, even when the mesh undergoes rigid rotation. This verification constitutes an objectivity check of the computed material time derivative with respect to rigid mesh motion for the given physical motion.\n\nUse the following parameter values:\n- Field parameters: $\\alpha = 0.8$, $\\beta = 1.3$, $\\mu = 0.4$.\n- Default physical velocity parameters (used unless overridden in a test case): $B = \\begin{bmatrix} d  s \\\\ -s  d \\end{bmatrix}$ with $d = 0.15$, $s = 0.35$, and $c = \\begin{bmatrix} 0.1 \\\\ -0.2 \\end{bmatrix}$.\n\nTest suite:\n- Case $1$: $x = (0.3, -0.5)$, $t = 0.7$, $\\omega_g = 1.2$, use default $B$ and $c$.\n- Case $2$: $x = (-1.0, 2.0)$, $t = 0.25$, $\\omega_g = 0.0$, use default $B$ and $c$.\n- Case $3$: $x = (2.0, 2.0)$, $t = 1.5$, $\\omega_g = 50.0$, use default $B$ and $c$.\n- Case $4$: $x = (0.0, 0.0)$, $t = 1.0$, $\\omega_g = -3.5$, use default $B$ and $c$.\n- Case $5$ (pure rigid physical motion): $x = (1.2, -0.7)$, $t = 0.9$, $\\omega_g = 4.0$, $B = \\begin{bmatrix} 0  s_0 \\\\ -s_0  0 \\end{bmatrix}$ with $s_0 = 2.0$, and $c = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$.\n\nFor each case, compute the maximum absolute component-wise difference between the two implementations of the material time derivative of $T$ and return a boolean indicating whether this difference is strictly less than $\\delta$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases specified above, for example, $[r_1,r_2,r_3,r_4,r_5]$, where each $r_k$ is a boolean.", "solution": "The problem requires the derivation and implementation of two distinct but equivalent expressions for the material time derivative of a spatial tensor field in an Arbitrary Lagrangian–Eulerian (ALE) framework. The equivalence of these two expressions must then be numerically verified.\n\nA spatial tensor field, denoted by $T(x,t)$, is a function of the spatial coordinates $x \\in \\mathbb{R}^2$ and time $t \\in \\mathbb{R}$. The material time derivative, $\\frac{DT}{Dt}$, measures the rate of change of this field as experienced by an observer moving with a material particle. The path of a particle is given by $x = \\chi_p(X, t)$, where $X$ is a label identifying the particle (e.g., its position at $t=0$). The velocity of the material is thus $v^m = \\frac{d\\chi_p}{dt}$.\n\n**1. Derivation in the Eulerian Description**\n\nThe first formulation is based on a purely Eulerian description, where the observer is fixed in space. By definition, the material time derivative is the total derivative of $T(x,t)$ along a particle path:\n$$\n\\frac{DT}{Dt} = \\frac{d}{dt} T(\\chi_p(X, t), t)\n$$\nApplying the multivariable chain rule, we obtain:\n$$\n\\frac{DT}{Dt} = \\frac{\\partial T}{\\partial t}\\bigg|_x + \\sum_{k=1}^{2} \\frac{\\partial T}{\\partial x_k} \\frac{dx_k}{dt} = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^m\n$$\nHere, $\\frac{\\partial T}{\\partial t}|_x$ is the local or spatial time derivative at a fixed point $x$, and $(\\nabla_x T) \\cdot v^m$ is the convective term, representing the change in $T$ due to the particle moving to a new location with a different value of $T$. In component notation, for a second-order tensor $T$, this is:\n$$\n\\left(\\frac{DT}{Dt}\\right)_{ij} = \\frac{\\partial T_{ij}}{\\partial t}\\bigg|_x + \\sum_{k=1}^{2} \\frac{\\partial T_{ij}}{\\partial x_k} v_k^m\n$$\nWe compute the necessary terms for the given tensor field $T(x,t)$:\n$T_{11}(x,t) = \\sin(\\alpha t) + x_1^2 + x_2$\n$T_{12}(x,t) = T_{21}(x,t) = \\frac{1}{2}\\cos(\\beta t) x_1 - \\frac{1}{4} x_2^2$\n$T_{22}(x,t) = \\mathrm{e}^{\\mu t} + x_1 x_2$\n\nThe partial time derivatives at a fixed spatial point $x$ are:\n$$\n\\frac{\\partial T_{11}}{\\partial t} = \\alpha \\cos(\\alpha t) \\quad ; \\quad\n\\frac{\\partial T_{12}}{\\partial t} = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 \\quad ; \\quad\n\\frac{\\partial T_{22}}{\\partial t} = \\mu \\mathrm{e}^{\\mu t}\n$$\nThe spatial gradients are:\n$$\n\\nabla_x T_{11} = \\begin{pmatrix} 2x_1 \\\\ 1 \\end{pmatrix} \\quad ; \\quad\n\\nabla_x T_{12} = \\begin{pmatrix} \\frac{1}{2}\\cos(\\beta t) \\\\ -\\frac{1}{2}x_2 \\end{pmatrix} \\quad ; \\quad\n\\nabla_x T_{22} = \\begin{pmatrix} x_2 \\\\ x_1 \\end{pmatrix}\n$$\nThe physical velocity field is $v^m(x,t) = Bx + c$. Let $v^m = (v_1^m, v_2^m)^T$. The components of the first formulation, which we denote $\\dot{T}^{(E)}$, are:\n$$\n\\dot{T}^{(E)}_{11} = \\alpha \\cos(\\alpha t) + 2x_1 v_1^m + v_2^m\n$$\n$$\n\\dot{T}^{(E)}_{12} = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 + \\frac{1}{2}\\cos(\\beta t) v_1^m - \\frac{1}{2}x_2 v_2^m\n$$\n$$\n\\dot{T}^{(E)}_{22} = \\mu \\mathrm{e}^{\\mu t} + x_2 v_1^m + x_1 v_2^m\n$$\nSymmetry holds, so $\\dot{T}^{(E)}_{21} = \\dot{T}^{(E)}_{12}$.\n\n**2. Derivation in the Arbitrary Lagrangian–Eulerian (ALE) Description**\n\nThe ALE description introduces a computational mesh that can move independently of the material. The mesh motion is described by a map $x = \\chi_g(\\xi, t)$, where $\\xi$ are fixed coordinates on the mesh. The mesh velocity is $v^g = \\frac{\\partial\\chi_g}{\\partial t}|_\\xi$.\n\nThe time derivative of the field $T$ at a fixed mesh coordinate $\\xi$ is:\n$$\n\\frac{\\partial T}{\\partial t}\\bigg|_\\xi = \\frac{d}{dt} T(\\chi_g(\\xi, t), t) = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot \\frac{\\partial \\chi_g}{\\partial t}\\bigg|_\\xi = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g\n$$\nThis fundamental relation allows us to express the local time derivative $\\frac{\\partial T}{\\partial t}|_x$ in terms of the mesh-based derivative:\n$$\n\\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi - (\\nabla_x T) \\cdot v^g\n$$\nSubstituting this into the Eulerian expression for the material derivative:\n$$\n\\frac{DT}{Dt} = \\left( \\frac{\\partial T}{\\partial t}\\bigg|_\\xi - (\\nabla_x T) \\cdot v^g \\right) + (\\nabla_x T) \\cdot v^m = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot (v^m - v^g)\n$$\nDefining the relative velocity between the material and the mesh as $v^r = v^m - v^g$, we arrive at the ALE formulation of the material derivative:\n$$\n\\frac{DT}{Dt} = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot v^r\n$$\nThis expression constitutes the second formulation. To implement it, we must first compute the term $\\frac{\\partial T}{\\partial t}|_\\xi$ and the relative velocity $v^r$. For the given mesh velocity $v^g(x,t) = W_g x$, with $W_g = \\omega_g \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix}$, we have $v^g = (-\\omega_g x_2, \\omega_g x_1)^T$. The components of $\\frac{\\partial T}{\\partial t}|_\\xi$ are:\n$$\n\\left(\\frac{\\partial T_{11}}{\\partial t}\\right)_\\xi = \\alpha \\cos(\\alpha t) + (2x_1)(-\\omega_g x_2) + (1)(\\omega_g x_1) = \\alpha \\cos(\\alpha t) + \\omega_g(x_1 - 2x_1x_2)\n$$\n$$\n\\left(\\frac{\\partial T_{12}}{\\partial t}\\right)_\\xi = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 + (\\frac{1}{2}\\cos(\\beta t))(-\\omega_g x_2) + (-\\frac{1}{2}x_2)(\\omega_g x_1) = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 - \\frac{1}{2}\\omega_g(x_2\\cos(\\beta t) + x_1x_2)\n$$\n$$\n\\left(\\frac{\\partial T_{22}}{\\partial t}\\right)_\\xi = \\mu \\mathrm{e}^{\\mu t} + (x_2)(-\\omega_g x_2) + (x_1)(\\omega_g x_1) = \\mu \\mathrm{e}^{\\mu t} + \\omega_g(x_1^2 - x_2^2)\n$$\nThe components of the second formulation, denoted $\\dot{T}^{(ALE)}$, are then calculated by adding the relative convective term, $(\\nabla_x T_{ij}) \\cdot v^r$, to these expressions.\n\n**3. Verification of Equivalence**\nThe algebraic identity of the two formulations, $\\dot{T}^{(E)} = \\dot{T}^{(ALE)}$, is shown by starting from the ALE form and substituting the definitions of $\\frac{\\partial T}{\\partial t}|_\\xi$ and $v^r$:\n$$\n\\dot{T}^{(ALE)} = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot v^r = \\left(\\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g \\right) + (\\nabla_x T) \\cdot (v^m - v^g)\n$$\n$$\n= \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g + (\\nabla_x T) \\cdot v^m - (\\nabla_x T) \\cdot v^g = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^m = \\dot{T}^{(E)}\n$$\nThe two expressions are mathematically identical. This confirms that the material time derivative is an objective quantity whose value does not depend on the motion of the underlying computational grid. The numerical part of the problem serves as a verification of the correct implementation of these two distinct computational paths. The difference between their numerical results should be zero, subject to floating-point precision limits.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and verifies two formulations of the material time derivative\n    for a given tensor field in an ALE setting.\n    \"\"\"\n    \n    # Field parameters\n    alpha = 0.8\n    beta = 1.3\n    mu = 0.4\n    \n    # Numerical tolerance\n    delta = 1e-10\n\n    # Default physical velocity parameters\n    d_def = 0.15\n    s_def = 0.35\n    B_def = np.array([[d_def, s_def], [-s_def, d_def]])\n    c_def = np.array([0.1, -0.2])\n\n    test_cases = [\n        {'x': np.array([0.3, -0.5]), 't': 0.7, 'omega_g': 1.2, 'B': B_def, 'c': c_def},\n        {'x': np.array([-1.0, 2.0]), 't': 0.25, 'omega_g': 0.0, 'B': B_def, 'c': c_def},\n        {'x': np.array([2.0, 2.0]), 't': 1.5, 'omega_g': 50.0, 'B': B_def, 'c': c_def},\n        {'x': np.array([0.0, 0.0]), 't': 1.0, 'omega_g': -3.5, 'B': B_def, 'c': c_def},\n        {'x': np.array([1.2, -0.7]), 't': 0.9, 'omega_g': 4.0, \n         'B': np.array([[0.0, 2.0], [-2.0, 0.0]]), 'c': np.array([0.0, 0.0])},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        x, t, omega_g, B, c = case['x'], case['t'], case['omega_g'], case['B'], case['c']\n        x1, x2 = x[0], x[1]\n\n        # --- Calculate velocities ---\n        # Physical velocity: v^m = Bx + c\n        v_m = B @ x + c\n        \n        # Grid velocity: v^g = W_g * x\n        W_g = omega_g * np.array([[0, -1], [1, 0]])\n        v_g = W_g @ x\n        \n        # Relative velocity: v^r = v^m - v^g\n        v_r = v_m - v_g\n\n        # --- Calculate partial derivatives and gradients ---\n        # Partial time derivatives at fixed x\n        dT_dt = np.zeros((2, 2))\n        dT_dt[0, 0] = alpha * np.cos(alpha * t)\n        dT_dt[0, 1] = dT_dt[1, 0] = -0.5 * beta * np.sin(beta * t) * x1\n        dT_dt[1, 1] = mu * np.exp(mu * t)\n\n        # Spatial gradients\n        grad_T11 = np.array([2 * x1, 1.0])\n        grad_T12 = np.array([0.5 * np.cos(beta * t), -0.5 * x2])\n        grad_T22 = np.array([x2, x1])\n\n        # --- Formulation 1: Eulerian ---\n        # DT/Dt = dT/dt|_x + (grad_T) . v_m\n        DT_Dt_E = np.zeros((2, 2))\n        DT_Dt_E[0, 0] = dT_dt[0, 0] + np.dot(grad_T11, v_m)\n        DT_Dt_E[0, 1] = DT_Dt_E[1, 0] = dT_dt[0, 1] + np.dot(grad_T12, v_m)\n        DT_Dt_E[1, 1] = dT_dt[1, 1] + np.dot(grad_T22, v_m)\n\n        # --- Formulation 2: ALE ---\n        # DT/Dt = dT/dt|_xi + (grad_T) . v_r\n        # First, find dT/dt|_xi = dT/dt|_x + (grad_T) . v_g\n        dT_dt_xi = np.zeros((2, 2))\n        dT_dt_xi[0, 0] = dT_dt[0, 0] + np.dot(grad_T11, v_g)\n        dT_dt_xi[0, 1] = dT_dt_xi[1, 0] = dT_dt[0, 1] + np.dot(grad_T12, v_g)\n        dT_dt_xi[1, 1] = dT_dt[1, 1] + np.dot(grad_T22, v_g)\n        \n        # Now, compute the full ALE derivative\n        DT_Dt_ALE = np.zeros((2, 2))\n        DT_Dt_ALE[0, 0] = dT_dt_xi[0, 0] + np.dot(grad_T11, v_r)\n        DT_Dt_ALE[0, 1] = DT_Dt_ALE[1, 0] = dT_dt_xi[0, 1] + np.dot(grad_T12, v_r)\n        DT_Dt_ALE[1, 1] = dT_dt_xi[1, 1] + np.dot(grad_T22, v_r)\n\n        # --- Verification ---\n        # Compute maximum absolute component-wise difference\n        max_abs_diff = np.max(np.abs(DT_Dt_E - DT_Dt_ALE))\n        \n        results.append(max_abs_diff  delta)\n\n    # Print the results in the required format\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\nsolve()\n```", "id": "3542191"}]}