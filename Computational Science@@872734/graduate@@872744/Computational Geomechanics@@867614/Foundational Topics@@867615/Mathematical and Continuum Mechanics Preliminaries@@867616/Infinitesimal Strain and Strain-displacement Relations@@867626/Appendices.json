{"hands_on_practices": [{"introduction": "The journey into computational geomechanics begins with a firm grasp of the fundamental relationship between a material's displacement and its resulting strain. This exercise challenges you to apply the core definition of the infinitesimal strain tensor, $\\boldsymbol{\\varepsilon}$, as the symmetric part of the displacement gradient, $\\nabla\\boldsymbol{u}$. By calculating the strain components from a general linear displacement field, you will directly connect the mathematical formalism to physical interpretations of stretching, shearing, and volumetric change [@problem_id:3533545].", "problem": "A homogeneous plane-strain deformation of a saturated soil layer is idealized by the displacement field $u_{x}=\\alpha x+\\beta y$, $u_{y}=\\gamma x+\\delta y$, $u_{z}=0$, where $\\alpha$, $\\beta$, $\\gamma$, and $\\delta$ are uniform constants and $(x,y,z)$ are Cartesian coordinates. Assuming small (infinitesimal) strains and starting from the definition of infinitesimal strain in terms of the displacement gradient, derive all components of the small-strain tensor $\\boldsymbol{\\varepsilon}$ for this deformation. Then, interpret the physical meaning of each nonzero component in terms of uniform normal strain, shear distortion of material line elements, volumetric strain, and any rigid-body motion that does not contribute to $\\boldsymbol{\\varepsilon}$.\n\nProvide your final answer as the full $3\\times 3$ tensor $\\boldsymbol{\\varepsilon}$ with entries expressed symbolically in terms of $\\alpha$, $\\beta$, $\\gamma$, and $\\delta$. Do not round; express the result exactly and without units.", "solution": "The problem statement is evaluated as scientifically sound, well-posed, and objective. It presents a standard exercise in continuum mechanics, specifically in the theory of infinitesimal strain. All necessary information is provided, and the problem is free of contradictions or ambiguities. Therefore, we may proceed with the derivation and analysis.\n\nThe relationship between the infinitesimal strain tensor $\\varepsilon_{ij}$ and the displacement vector field $u_i$ in Cartesian coordinates $(x_1, x_2, x_3)$ is given by the strain-displacement relations:\n$$\n\\varepsilon_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right)\n$$\nwhere $i, j \\in \\{1, 2, 3\\}$.\n\nThe given displacement field is:\n$u_x = u_1 = \\alpha x + \\beta y$\n$u_y = u_2 = \\gamma x + \\delta y$\n$u_z = u_3 = 0$\n\nHere, we associate the coordinates $(x,y,z)$ with $(x_1, x_2, x_3)$ respectively. First, we compute the components of the displacement gradient tensor, $H_{ij} = \\frac{\\partial u_i}{\\partial x_j}$:\n\n$\\frac{\\partial u_x}{\\partial x} = \\alpha$\n$\\frac{\\partial u_x}{\\partial y} = \\beta$\n$\\frac{\\partial u_x}{\\partial z} = 0$\n\n$\\frac{\\partial u_y}{\\partial x} = \\gamma$\n$\\frac{\\partial u_y}{\\partial y} = \\delta$\n$\\frac{\\partial u_y}{\\partial z} = 0$\n\n$\\frac{\\partial u_z}{\\partial x} = 0$\n$\\frac{\\partial u_z}{\\partial y} = 0$\n$\\frac{\\partial u_z}{\\partial z} = 0$\n\nThe displacement gradient tensor, $\\nabla \\mathbf{u}$, is thus:\n$$\n\\nabla \\mathbf{u} =\n\\begin{pmatrix}\n\\frac{\\partial u_x}{\\partial x}  \\frac{\\partial u_x}{\\partial y}  \\frac{\\partial u_x}{\\partial z} \\\\\n\\frac{\\partial u_y}{\\partial x}  \\frac{\\partial u_y}{\\partial y}  \\frac{\\partial u_y}{\\partial z} \\\\\n\\frac{\\partial u_z}{\\partial x}  \\frac{\\partial u_z}{\\partial y}  \\frac{\\partial u_z}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\alpha  \\beta  0 \\\\\n\\gamma  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\nThe infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ is the symmetric part of the displacement gradient tensor, $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$. We now compute its components explicitly.\n\nThe diagonal components (normal strains) are:\n$\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\alpha$\n$\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\delta$\n$\\varepsilon_{zz} = \\frac{\\partial u_z}{\\partial z} = 0$\n\nThe off-diagonal components (shear strains) are:\n$\\varepsilon_{xy} = \\varepsilon_{yx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) = \\frac{1}{2} (\\beta + \\gamma)$\n$\\varepsilon_{xz} = \\varepsilon_{zx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial z} + \\frac{\\partial u_z}{\\partial x} \\right) = \\frac{1}{2} (0 + 0) = 0$\n$\\varepsilon_{yz} = \\varepsilon_{zy} = \\frac{1}{2} \\left( \\frac{\\partial u_y}{\\partial z} + \\frac{\\partial u_z}{\\partial y} \\right) = \\frac{1}{2} (0 + 0) = 0$\n\nAssembling these components into a $3 \\times 3$ matrix, the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ is:\n$$\n\\boldsymbol{\\varepsilon} =\n\\begin{pmatrix}\n\\alpha  \\frac{1}{2}(\\beta+\\gamma)  0 \\\\\n\\frac{1}{2}(\\beta+\\gamma)  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n\nNext, we interpret the physical meaning of the components and related quantities.\n\n**Physical Interpretation of Nonzero Strain Components:**\n- $\\varepsilon_{xx} = \\alpha$: This is the normal strain along the $x$-axis. It represents the fractional change in length of a material line element originally oriented parallel to the $x$-axis.\n- $\\varepsilon_{yy} = \\delta$: This is the normal strain along the $y$-axis, representing the fractional change in length of a material line element originally oriented parallel to the $y$-axis.\n- $\\varepsilon_{xy} = \\frac{1}{2}(\\beta+\\gamma)$: This is the tensorial shear strain component in the $x-y$ plane. The engineering shear strain, $\\gamma_{xy}$, which measures the change in the angle between two initially perpendicular line elements along the $x$ and $y$ axes, is given by $\\gamma_{xy} = 2 \\varepsilon_{xy} = \\beta + \\gamma$. This component quantifies the shear distortion of the material in the $x-y$ plane.\n\nThe zero-valued components ($\\varepsilon_{zz}$, $\\varepsilon_{xz}$, $\\varepsilon_{yz}$) are consistent with the \"plane-strain\" condition, which stipulates that there is no deformation in the $z$-direction or in planes containing the $z$-axis.\n\n**Volumetric Strain:**\nThe volumetric strain, or dilatation $\\varepsilon_V$, is the trace of the strain tensor, $\\varepsilon_V = \\text{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$. It measures the fractional change in volume. For this deformation:\n$$\n\\varepsilon_V = \\alpha + \\delta + 0 = \\alpha + \\delta\n$$\nThis indicates that the volume of a material element changes unless $\\alpha = -\\delta$, which corresponds to an isochoric (volume-preserving) deformation in the $x-y$ plane.\n\n**Rigid-Body Motion:**\nThe displacement gradient tensor $\\nabla \\mathbf{u}$ can be decomposed into a symmetric strain tensor $\\boldsymbol{\\varepsilon}$ and an anti-symmetric (or skew-symmetric) spin (or rotation) tensor $\\Omega$: $\\nabla \\mathbf{u} = \\boldsymbol{\\varepsilon} + \\Omega$. The spin tensor $\\Omega$ describes the local infinitesimal rigid-body rotation of the material, which does not contribute to strain. It is calculated as $\\Omega = \\frac{1}{2}(\\nabla \\mathbf{u} - (\\nabla \\mathbf{u})^T)$.\n$$\n\\Omega = \\frac{1}{2} \\left[\n\\begin{pmatrix}\n\\alpha  \\beta  0 \\\\\n\\gamma  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n\\alpha  \\gamma  0 \\\\\n\\beta  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n\\right]\n=\n\\frac{1}{2}\n\\begin{pmatrix}\n0  \\beta - \\gamma  0 \\\\\n\\gamma - \\beta  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  \\frac{1}{2}(\\beta - \\gamma)  0 \\\\\n-\\frac{1}{2}(\\beta - \\gamma)  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\nThe nonzero component $\\Omega_{xy} = \\frac{1}{2}(\\beta - \\gamma)$ represents the rate of infinitesimal rigid-body rotation about the $z$-axis. If $\\beta = \\gamma$, the flow is irrotational, and the shear is said to be \"pure.\" If $\\beta \\neq \\gamma$, the deformation includes a rotational component. This rigid-body rotation is part of the overall motion but, by definition, does not cause any straining of the material.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha  \\frac{1}{2}(\\beta+\\gamma)  0 \\\\\n\\frac{1}{2}(\\beta+\\gamma)  \\delta  0 \\\\\n0  0  0\n\\end{pmatrix}\n}\n$$", "id": "3533545"}, {"introduction": "Moving beyond simple analysis, a deeper understanding comes from the ability to design and control deformation. This practice inverts the typical problem by asking you to engineer a displacement field that produces a specific, uniform state of pure volumetric strain, a condition analogous to hydrostatic compression. This exercise illuminates the powerful concept of strain decomposition into volumetric (size-changing) and deviatoric (shape-changing) parts and highlights the role of boundary conditions in prescribing motion while preventing unwanted rigid-body effects [@problem_id:3533597].", "problem": "A homogeneous, isotropic cubic specimen of side length $L$ occupies the reference domain $\\Omega = [0,L] \\times [0,L] \\times [0,L]$ with coordinates $(x,y,z)$. Assume the kinematics are governed by the infinitesimal strain regime, where the displacement field is $\\boldsymbol{u}(x,y,z) = \\left(u_{x}(x,y,z), u_{y}(x,y,z), u_{z}(x,y,z)\\right)$ and the infinitesimal strain tensor is defined by the symmetric part of the displacement gradient,\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\left(\\nabla \\boldsymbol{u}\\right)^{\\mathsf{T}}\\right).\n$$\nThe volumetric strain is defined as the first invariant (trace) of the strain tensor,\n$$\n\\varepsilon_{v} = \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz},\n$$\nand the deviatoric strain tensor is\n$$\n\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\varepsilon_{v}\\,\\boldsymbol{I}.\n$$\n\nYou are asked to design displacement boundary conditions on the boundary $\\partial\\Omega$ that impose a uniform pure volumetric strain $\\varepsilon_{v}$ with zero deviatoric strain everywhere in $\\Omega$. Work from the definitions above and the kinematics of infinitesimal deformations. Your design must eliminate rigid-body rotation and translation. Then, derive a single closed-form displacement field $\\boldsymbol{u}(x,y,z)$ in terms of $(x,y,z)$, $L$, and $\\varepsilon_{v}$ that is consistent with your boundary conditions and produces the required uniform strain state. Finally, verify from first principles that the resulting strain field satisfies $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{v}$ and $\\boldsymbol{\\varepsilon}' = \\boldsymbol{0}$ everywhere in $\\Omega$.\n\nExpress the displacement components in meters. No numerical evaluation is required; provide the final displacement field as a single analytic expression. Do not include units in your boxed final answer.", "solution": "The user wants to find a displacement field that generates a specified uniform strain state within a cubic domain.\n\n### Step 1: Extract Givens\n-   **Domain**: A cubic specimen occupying the reference domain $\\Omega = [0,L] \\times [0,L] \\times [0,L]$.\n-   **Coordinates**: $(x,y,z)$.\n-   **Kinematics**: Infinitesimal strain regime.\n-   **Displacement field**: $\\boldsymbol{u}(x,y,z) = \\left(u_{x}(x,y,z), u_{y}(x,y,z), u_{z}(x,y,z)\\right)$.\n-   **Infinitesimal strain tensor definition**: $\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\left(\\nabla \\boldsymbol{u}\\right)^{\\mathsf{T}}\\right)$.\n-   **Volumetric strain definition**: $\\varepsilon_{v} = \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$.\n-   **Deviatoric strain tensor definition**: $\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\varepsilon_{v}\\,\\boldsymbol{I}$.\n-   **Required Strain State**: Uniform pure volumetric strain $\\varepsilon_{v}$ with zero deviatoric strain everywhere in $\\Omega$. This means $\\varepsilon_{v}$ is a constant and $\\boldsymbol{\\varepsilon}' = \\boldsymbol{0}$ for all $(x,y,z) \\in \\Omega$.\n-   **Constraints**: The designed displacement boundary conditions must eliminate rigid-body rotation and translation.\n-   **Required Output**: A single closed-form displacement field $\\boldsymbol{u}(x,y,z)$ and verification of the resulting strain state.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it uses standard definitions from continuum mechanics and infinitesimal strain theory. It is well-posed; the requirements of a specific uniform strain state, combined with the elimination of rigid-body motion, are sufficient to determine a unique displacement field. The problem statement is objective and uses precise mathematical language. It is a standard, non-trivial exercise in kinematics and does not contain any of the invalidating flaws listed in the instructions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Displacement Field\n\nThe problem requires a strain state characterized by a uniform volumetric strain $\\varepsilon_v$ and zero deviatoric strain $\\boldsymbol{\\varepsilon}'$. The condition $\\boldsymbol{\\varepsilon}' = \\boldsymbol{0}$ provides a direct relationship for the strain tensor $\\boldsymbol{\\varepsilon}$. From the definition of deviatoric strain:\n$$\n\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\varepsilon_{v}\\,\\boldsymbol{I} = \\boldsymbol{0}\n$$\nThis implies that the strain tensor must be spherical (or dilatational):\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{3}\\varepsilon_{v}\\,\\boldsymbol{I}\n$$\nwhere $\\boldsymbol{I}$ is the second-order identity tensor. In matrix form, with respect to the Cartesian coordinate system $(x,y,z)$, this is:\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx}  \\varepsilon_{xy}  \\varepsilon_{xz} \\\\ \\varepsilon_{yx}  \\varepsilon_{yy}  \\varepsilon_{yz} \\\\ \\varepsilon_{zx}  \\varepsilon_{zy}  \\varepsilon_{zz} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}\\varepsilon_{v}  0  0 \\\\ 0  \\frac{1}{3}\\varepsilon_{v}  0 \\\\ 0  0  \\frac{1}{3}\\varepsilon_{v} \\end{pmatrix}\n$$\nThe components of the strain tensor are therefore:\n$$\n\\varepsilon_{xx} = \\varepsilon_{yy} = \\varepsilon_{zz} = \\frac{1}{3}\\varepsilon_{v}\n$$\n$$\n\\varepsilon_{xy} = \\varepsilon_{yz} = \\varepsilon_{zx} = 0\n$$\nNow, we relate these strain components to the displacement field $\\boldsymbol{u}$ using the infinitesimal strain-displacement relations:\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{1}{3}\\varepsilon_{v} \\quad (1)\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{1}{3}\\varepsilon_{v} \\quad (2)\n$$\n$$\n\\varepsilon_{zz} = \\frac{\\partial u_z}{\\partial z} = \\frac{1}{3}\\varepsilon_{v} \\quad (3)\n$$\nAnd for the shear components:\n$$\n2\\varepsilon_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = 0 \\quad (4)\n$$\n$$\n2\\varepsilon_{yz} = \\frac{\\partial u_y}{\\partial z} + \\frac{\\partial u_z}{\\partial y} = 0 \\quad (5)\n$$\n$$\n2\\varepsilon_{zx} = \\frac{\\partial u_z}{\\partial x} + \\frac{\\partial u_x}{\\partial z} = 0 \\quad (6)\n$$\nWe integrate equations $(1)$, $(2)$, and $(3)$ with respect to $x$, $y$, and $z$ respectively to find the general form of the displacement components:\n$$\nu_x(x,y,z) = \\frac{1}{3}\\varepsilon_{v}x + f(y,z)\n$$\n$$\nu_y(x,y,z) = \\frac{1}{3}\\varepsilon_{v}y + g(x,z)\n$$\n$$\nu_z(x,y,z) = \\frac{1}{3}\\varepsilon_{v}z + h(x,y)\n$$\nwhere $f$, $g$, and $h$ are arbitrary functions of integration. Substituting these forms into the shear strain relations gives:\n$$\n\\frac{\\partial f}{\\partial y} + \\frac{\\partial g}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial g}{\\partial z} + \\frac{\\partial h}{\\partial y} = 0\n$$\n$$\n\\frac{\\partial h}{\\partial x} + \\frac{\\partial f}{\\partial z} = 0\n$$\nThese are the compatibility equations for a zero strain field. The general solution for the field $(f,g,h)$ corresponds to a rigid-body motion, which can be expressed as a superposition of a constant translation vector $\\boldsymbol{d} = (d_x, d_y, d_z)$ and an infinitesimal rotation $\\boldsymbol{\\omega} \\times \\boldsymbol{x}$, where $\\boldsymbol{\\omega} = (\\omega_x, \\omega_y, \\omega_z)$ is the infinitesimal rotation vector and $\\boldsymbol{x}=(x,y,z)$.\nSo, the most general displacement field is:\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) = \\frac{1}{3}\\varepsilon_v \\boldsymbol{x} + \\boldsymbol{d} + \\boldsymbol{\\omega} \\times \\boldsymbol{x}\n$$\nIn component form:\n$$\nu_x = \\frac{1}{3}\\varepsilon_{v}x + d_x + \\omega_y z - \\omega_z y\n$$\n$$\nu_y = \\frac{1}{3}\\varepsilon_{v}y + d_y + \\omega_z x - \\omega_x z\n$$\n$$\nu_z = \\frac{1}{3}\\varepsilon_{v}z + d_z + \\omega_x y - \\omega_y x\n$$\nThe problem requires that we design boundary conditions to eliminate rigid-body motion. This means we must enforce constraints that set $\\boldsymbol{d} = \\boldsymbol{0}$ and $\\boldsymbol{\\omega} = \\boldsymbol{0}$.\nTo eliminate translation ($\\boldsymbol{d}$), we can fix the displacement at a single point. A convenient choice is the origin $(0,0,0)$:\n$$\n\\boldsymbol{u}(0,0,0) = \\boldsymbol{0}\n$$\nSubstituting $(x,y,z)=(0,0,0)$ into the general solution yields $\\boldsymbol{u}(0,0,0) = \\boldsymbol{d}$. Thus, this condition forces $\\boldsymbol{d} = \\boldsymbol{0}$.\n\nTo eliminate rotation ($\\boldsymbol{\\omega}$), we must constrain the rotational degrees of freedom. This can be achieved by fixing the displacement of other points. For example, by fixing two components of displacement at a point on the $x$-axis, say $(L,0,0)$, we can determine two rotation components:\nWith $\\boldsymbol{d}=\\boldsymbol{0}$, we have $u_y(L,0,0) = \\omega_z L$ and $u_z(L,0,0) = -\\omega_y L$. Setting $u_y(L,0,0)=0$ and $u_z(L,0,0)=0$ forces $\\omega_z=0$ and $\\omega_y=0$ (since $L \\neq 0$).\nTo find the last component, we can fix one component at a point on the $y$-axis, say $(0,L,0)$:\nWith $\\omega_y=\\omega_z=0$, we have $u_z(0,L,0) = \\omega_x L$. Setting $u_z(0,L,0)=0$ forces $\\omega_x=0$.\n\nWith $\\boldsymbol{d}=\\boldsymbol{0}$ and $\\boldsymbol{\\omega}=\\boldsymbol{0}$, the unique displacement field that produces the desired strain state without rigid-body motion is:\n$$\n\\boldsymbol{u}(x,y,z) = \\frac{1}{3}\\varepsilon_{v}\\boldsymbol{x}\n$$\nThe components are:\n$$\nu_x(x,y,z) = \\frac{1}{3}\\varepsilon_{v}x\n$$\n$$\nu_y(x,y,z) = \\frac{1}{3}\\varepsilon_{v}y\n$$\n$$\nu_z(x,y,z) = \\frac{1}{3}\\varepsilon_{v}z\n$$\nThe boundary conditions that produce this field are Dirichlet boundary conditions where the displacement is prescribed over the entire boundary $\\partial\\Omega$ according to this formula:\n$$\n\\boldsymbol{u}(\\boldsymbol{x})|_{\\partial\\Omega} = \\frac{1}{3}\\varepsilon_v \\boldsymbol{x}|_{\\partial\\Omega}\n$$\nThese boundary conditions uniquely determine the displacement field inside the domain and inherently satisfy the constraints required to eliminate rigid-body motion. The side length $L$ of the cube defines the boundary `\\partial\\Omega` but does not appear in the expression for the displacement field at a generic point $(x,y,z)$.\n\n### Verification\n\nFinally, we must verify from first principles that this displacement field yields the required strain state.\nThe displacement field is $\\boldsymbol{u}(x,y,z) = \\left(\\frac{1}{3}\\varepsilon_{v}x, \\frac{1}{3}\\varepsilon_{v}y, \\frac{1}{3}\\varepsilon_{v}z\\right)$.\nFirst, we compute the displacement gradient tensor $\\nabla \\boldsymbol{u}$:\n$$\n\\nabla \\boldsymbol{u} = \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x}  \\frac{\\partial u_x}{\\partial y}  \\frac{\\partial u_x}{\\partial z} \\\\ \\frac{\\partial u_y}{\\partial x}  \\frac{\\partial u_y}{\\partial y}  \\frac{\\partial u_y}{\\partial z} \\\\ \\frac{\\partial u_z}{\\partial x}  \\frac{\\partial u_z}{\\partial y}  \\frac{\\partial u_z}{\\partial z} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}\\varepsilon_{v}  0  0 \\\\ 0  \\frac{1}{3}\\varepsilon_{v}  0 \\\\ 0  0  \\frac{1}{3}\\varepsilon_{v} \\end{pmatrix} = \\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I}\n$$\nThe infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ is the symmetric part of $\\nabla \\boldsymbol{u}$:\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}}\\right) = \\frac{1}{2}\\left(\\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I} + \\left(\\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I}\\right)^{\\mathsf{T}}\\right)\n$$\nSince the identity tensor is symmetric, $(\\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I})^{\\mathsf{T}} = \\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I}$. Therefore:\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I} + \\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I}\\right) = \\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I}\n$$\nNow, we verify the two conditions on the strain state:\n1.  **Volumetric Strain:**\n    The volumetric strain is the trace of $\\boldsymbol{\\varepsilon}$:\n    $$\n    \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\operatorname{tr}\\left(\\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I}\\right) = \\frac{1}{3}\\varepsilon_{v} \\operatorname{tr}(\\boldsymbol{I}) = \\frac{1}{3}\\varepsilon_{v}(1+1+1) = \\varepsilon_{v}\n    $$\n    This holds everywhere in $\\Omega$, as required.\n\n2.  **Deviatoric Strain:**\n    The deviatoric strain tensor is $\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\varepsilon})\\boldsymbol{I}$. Substituting our results:\n    $$\n    \\boldsymbol{\\varepsilon}' = \\left(\\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I}\\right) - \\frac{1}{3}(\\varepsilon_{v})\\boldsymbol{I} = \\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I} - \\frac{1}{3}\\varepsilon_{v}\\boldsymbol{I} = \\boldsymbol{0}\n    $$\n    This also holds everywhere in $\\Omega$, as required.\n\nThe derived displacement field is correct and satisfies all conditions of the problem.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3} \\varepsilon_{v} x  \\frac{1}{3} \\varepsilon_{v} y  \\frac{1}{3} \\varepsilon_{v} z\n\\end{pmatrix}\n}\n$$", "id": "3533597"}, {"introduction": "The theoretical concepts of strain and displacement find their practical application in numerical tools like the Finite Element Method (FEM). However, how can we be sure our computational model is correct? This hands-on practice introduces the patch test, a fundamental benchmark for verifying the correctness of a finite element formulation. By implementing a patch test for a pair of simple linear triangular elements, you will confirm their ability to exactly reproduce a constant strain state, a non-negotiable requirement for any reliable element used in computational analysis [@problem_id:3533534].", "problem": "Consider a two-dimensional small-strain patch test within the Finite Element Method (FEM) using linear triangular elements. The infinitesimal strain tensor at a point with displacement field components $u(x,y)$ and $v(x,y)$ is defined by the symmetric gradient: \n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right),\n$$\nwhere the displacement vector is $\\boldsymbol{u} = [u,v]^{\\mathsf{T}}$, and the strain components are $ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\ \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\ \\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right)$. The Constant Strain Triangle (CST) is a linear triangular element whose shape functions produce a constant strain field within each element under a linear displacement field.\n\nYou must demonstrate the patch test for a mesh composed of $2$ linear triangular elements covering the unit square. The nodal coordinates (in meters) are:\n- Node $1$: $(0,0)$,\n- Node $2$: $(1,0)$,\n- Node $3$: $(1,1)$,\n- Node $4$: $(0,1)$.\n\nThe element connectivity is:\n- Element $1$: $(1,2,3)$,\n- Element $2$: $(1,3,4)$.\n\nFor a uniform target small-strain field with components $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$, a rigid-body translation $\\boldsymbol{t} = (t_x, t_y)$ in meters, and a small rigid-body rotation with angle $\\theta$ in radians, define the nodal displacement field by superposition of these kinematic contributions as\n$$\nu(x,y) = \\varepsilon_{xx}\\,x + \\varepsilon_{xy}\\,y - \\theta\\,y + t_x, \\quad v(x,y) = \\varepsilon_{xy}\\,x + \\varepsilon_{yy}\\,y + \\theta\\,x + t_y.\n$$\nThis field isolates the symmetric strain from the rigid-body parts (translation and rotation). Under the infinitesimal strain assumption, the rigid-body parts must not contribute to $\\boldsymbol{\\varepsilon}$.\n\nYour program must:\n- Compute the strain in each element using the strain-displacement relation derived from the elementâ€™s linear shape functions.\n- Verify, for each test case, that the computed element strains equal the target uniform strain components $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ within an absolute tolerance $\\tau = 10^{-12}$ for each strain component in each element.\n- Return one boolean per test case indicating whether both elements in the patch pass the test (i.e., all component-wise comparisons within tolerance are satisfied).\n\nDesign the test suite with the following four parameter sets:\n- Test case $1$ (general constant strain, no rigid-body motion): $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-2}, -2\\times 10^{-2}, 5\\times 10^{-3})$, $\\boldsymbol{t} = (0,0)$, $\\theta = 0$.\n- Test case $2$ (general constant strain plus rigid-body translation): $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-2}, -2\\times 10^{-2}, 5\\times 10^{-3})$, $\\boldsymbol{t} = (3\\times 10^{-1}, -10^{-1})$, $\\theta = 0$.\n- Test case $3$ (pure rigid-body rotation, zero strain): $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (0,0,0)$, $\\boldsymbol{t} = (0,0)$, $\\theta = 2\\times 10^{-2}$.\n- Test case $4$ (extremely small constant strain, no rigid-body motion): $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-12}, -10^{-12}, 5\\times 10^{-13})$, $\\boldsymbol{t} = (0,0)$, $\\theta = 0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_i$ is a boolean indicating whether the patch test passed for test case $i$.", "solution": "The problem requires performing a patch test for a two-dimensional mesh composed of two linear triangular elements. The patch test is a fundamental verification tool in the Finite Element Method (FEM) to ensure that an element formulation can exactly reproduce a constant strain state, a necessary condition for convergence.\n\nThe core principle of the test is to prescribe a linear displacement field across a \"patch\" of elements. A linear displacement field corresponds to a constant strain field. The FEM procedure is then used to compute the strain within each element from the prescribed nodal displacements. If the element formulation is correct, the computed strain in each element must equal the constant strain from which the displacements were derived. This must hold true irrespective of the mesh geometry and any superimposed rigid-body motion (translation and rotation), provided the motion is consistent with the underlying small strain/small rotation assumptions.\n\nThe problem defines a linear displacement field $(\\boldsymbol{u})$ as a superposition of a constant strain state $(\\boldsymbol{\\varepsilon})$ and a small rigid-body motion (translation $\\boldsymbol{t}$ and rotation angle $\\theta$). The displacement components $u(x,y)$ and $v(x,y)$ at a point $(x,y)$ are given by:\n$$ u(x,y) = \\varepsilon_{xx}\\,x + \\varepsilon_{xy}\\,y - \\theta\\,y + t_x $$\n$$ v(x,y) = \\varepsilon_{xy}\\,x + \\varepsilon_{yy}\\,y + \\theta\\,x + t_y $$\nHere, $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ are the components of the target constant strain tensor, $(t_x, t_y)$ are the components of the rigid-body translation vector, and $\\theta$ is the small rigid-body rotation angle. Analytically, the infinitesimal strain components derived from this displacement field are indeed $\\varepsilon_{xx}$, $\\varepsilon_{yy}$, and $\\varepsilon_{xy}$, as the rigid-body motion terms do not contribute to strain.\n\nThe solution proceeds by implementing the standard FEM strain calculation for a Constant Strain Triangle (CST), also known as a linear triangular element. For a CST element with nodes $i, j, k$ at coordinates $(x_i, y_i)$, $(x_j, y_j)$, and $(x_k, y_k)$, the displacement field within the element is interpolated linearly from the nodal displacements. This linear interpolation results in a constant strain field throughout the element.\n\nThe relationship between the element's strain vector $\\boldsymbol{\\varepsilon}^e$ and its nodal displacement vector $\\boldsymbol{d}^e$ is given by the matrix equation:\n$$ \\boldsymbol{\\varepsilon}^e = \\boldsymbol{B} \\boldsymbol{d}^e $$\nIn our two-dimensional case, the nodal displacement vector for a three-noded element is $\\boldsymbol{d}^e = [u_i, v_i, u_j, v_j, u_k, v_k]^{\\mathsf{T}}$. The strain vector, using the engineering shear strain definition $\\gamma_{xy} = 2\\varepsilon_{xy}$, is $\\boldsymbol{\\varepsilon}^e = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$. The strain-displacement matrix $\\boldsymbol{B}$ is a function of the nodal coordinates:\n$$\n\\boldsymbol{B} = \\frac{1}{2A}\n\\begin{bmatrix}\ny_j-y_k  0  y_k-y_i  0  y_i-y_j  0 \\\\\n0  x_k-x_j  0  x_i-x_k  0  x_j-x_i \\\\\nx_k-x_j  y_j-y_k  x_i-x_k  y_k-y_i  x_j-x_i  y_i-y_j\n\\end{bmatrix}\n$$\nwhere $A$ is the area of the element, calculated as $2A = x_i(y_j - y_k) + x_j(y_k - y_i) + x_k(y_i - y_j)$. For the formula to be correct, the nodes $i, j, k$ must be ordered counter-clockwise.\n\nThe algorithm to solve the problem is as follows:\n1.  Define the mesh geometry: The nodal coordinates for nodes $1, 2, 3, 4$ and the element connectivity for elements $1$ and $2$ are stored. The given connectivity, $(1,2,3)$ for element $1$ and $(1,3,4)$ for element $2$, is counter-clockwise, ensuring a positive area calculation.\n2.  Iterate through each of the four test cases provided. For each case:\n    a. The parameters for the target strain $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$, translation $(t_x, t_y)$, and rotation $\\theta$ are defined.\n    b. The analytical displacement field equations are used to compute the exact nodal displacements ($u_i, v_i$) for each of the four nodes in the mesh.\n    c. For each of the two elements in the patch:\n        i. The coordinates of its three nodes are retrieved.\n        ii. The strain-displacement matrix $\\boldsymbol{B}$ is constructed using these coordinates. The area $A$ for both elements is $0.5$ m$^2$.\n        iii. The element's nodal displacement vector $\\boldsymbol{d}^e$ is assembled from the pre-calculated global nodal displacements.\n        iv. The constant strain vector within the element is computed by the matrix-vector product $\\boldsymbol{B} \\boldsymbol{d}^e$. This yields the engineering strain components $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})$. The engineering shear strain $\\gamma_{xy}$ is converted to the tensor shear strain $\\varepsilon_{xy}$ by dividing by $2$.\n        v. The three computed strain components $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ are compared to their respective target values for the current test case. The comparison is made using an absolute tolerance $\\tau = 10^{-12}$.\n3.  A test case is considered \"passed\" (True) only if all three strain components in *both* elements match their target values within the specified tolerance. If any comparison fails, the test case is marked as \"failed\" (False).\n4.  The boolean results for all four test cases are collected and formatted into the required output string.\n\nThis procedure rigorously verifies that the CST element formulation correctly reproduces the constant strain part of the displacement field while being insensitive to rigid-body motion, a key property known as C0-completeness, which is essential for the element to pass the patch test. The implementation uses the `numpy` library for efficient handling of matrix and vector operations.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a 2D patch test for a mesh of two linear triangular elements.\n    \"\"\"\n    # Global definitions for the mesh\n    nodal_coords = {\n        1: (0.0, 0.0),\n        2: (1.0, 0.0),\n        3: (1.0, 1.0),\n        4: (0.0, 1.0)\n    }\n\n    element_connectivity = {\n        1: (1, 2, 3),  # CCW order\n        2: (1, 3, 4)   # CCW order\n    }\n\n    # Test cases: (eps_xx, eps_yy, eps_xy, t_x, t_y, theta)\n    test_cases = [\n        (1e-2, -2e-2, 5e-3, 0.0, 0.0, 0.0),\n        (1e-2, -2e-2, 5e-3, 3e-1, -1e-1, 0.0),\n        (0.0, 0.0, 0.0, 0.0, 0.0, 2e-2),\n        (1e-12, -1e-12, 5e-13, 0.0, 0.0, 0.0)\n    ]\n\n    tolerance = 1e-12\n    results = []\n\n    def calculate_element_strain(element_node_ids, all_coords, all_displacements):\n        \"\"\"\n        Calculates the constant strain tensor for a single linear triangular element.\n        \"\"\"\n        # 1. Get nodal coordinates for the element\n        n_i, n_j, n_k = element_node_ids\n        (xi, yi), (xj, yj), (xk, yk) = all_coords[n_i], all_coords[n_j], all_coords[n_k]\n\n        # 2. Calculate 2 * Area. Given connectivity is CCW, so area is positive.\n        two_A = xi * (yj - yk) + xj * (yk - yi) + xk * (yi - yj)\n        if abs(two_A)  1e-15:\n            raise ValueError(\"Degenerate element with zero area.\")\n        \n        # 3. Form the strain-displacement matrix B\n        B_matrix = (1.0 / two_A) * np.array([\n            [yj - yk, 0, yk - yi, 0, yi - yj, 0],\n            [0, xk - xj, 0, xi - xk, 0, xj - xi],\n            [xk - xj, yj - yk, xi - xk, yk - yi, xj - xi, yi - yj]\n        ])\n\n        # 4. Form the element nodal displacement vector d_e\n        (ui, vi), (uj, vj), (uk, vk) = all_displacements[n_i], all_displacements[n_j], all_displacements[n_k]\n        d_e = np.array([ui, vi, uj, vj, uk, vk])\n\n        # 5. Calculate engineering strain vector [exx, eyy, gxy]\n        eng_strain = B_matrix @ d_e\n\n        # 6. Convert to tensor strain [exx, eyy, exy] and return\n        tensor_strain = np.array([eng_strain[0], eng_strain[1], eng_strain[2] / 2.0])\n        return tensor_strain\n\n    for case in test_cases:\n        eps_xx_target, eps_yy_target, eps_xy_target, tx, ty, theta = case\n        target_strain = np.array([eps_xx_target, eps_yy_target, eps_xy_target])\n\n        # Calculate displacements for all nodes based on the analytical field\n        all_nodal_displacements = {}\n        for node_id, (x, y) in nodal_coords.items():\n            u = eps_xx_target * x + eps_xy_target * y - theta * y + tx\n            v = eps_xy_target * x + eps_yy_target * y + theta * x + ty\n            all_nodal_displacements[node_id] = (u, v)\n\n        case_passed = True\n        for elem_id, node_ids in element_connectivity.items():\n            # Compute strain for the current element\n            computed_strain = calculate_element_strain(\n                node_ids, nodal_coords, all_nodal_displacements\n            )\n            \n            # Verify if computed strain matches target strain within tolerance\n            # Use rtol=0 because target strains can be zero.\n            if not np.allclose(computed_strain, target_strain, rtol=0, atol=tolerance):\n                case_passed = False\n                break  # If one element fails, the whole patch test case fails\n\n        results.append(case_passed)\n\n    # Format and print the final results as a single line\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3533534"}]}