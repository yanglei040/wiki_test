{"hands_on_practices": [{"introduction": "The power of isoparametric elements like the eight-node brick lies in their ability to map from a simple parent shape to a distorted physical geometry. This flexibility, however, is not without its costs. This practice delves into the core mechanics of this mapping to reveal how element distortion, quantified by the Jacobian matrix, directly impacts the accuracy of numerical integration [@problem_id:3567421]. By analytically calculating the integration error for a skewed element, you will gain a tangible understanding of how an element's shape influences its numerical performance.", "problem": "Consider an eight-node first-order trilinear hexahedral element (Q1) used in the Finite Element Method (FEM) in computational geomechanics. Let the parent (reference) domain be the cube $\\{(\\xi,\\eta,\\zeta)\\,|\\,\\xi,\\eta,\\zeta\\in[-1,1]\\}$. The isoparametric mapping to the physical coordinates $(x,y,z)$ is defined by prescribing the nodal physical coordinates as follows. For each node with parent coordinates $(\\xi_i,\\eta_i,\\zeta_i)\\in\\{\\pm 1\\}^{3}$, assign\n$$\nx_i \\;=\\; L\\,\\xi_i \\;+\\; \\varepsilon\\,L\\,\\xi_i\\,\\eta_i,\\qquad\ny_i \\;=\\; L\\,\\eta_i,\\qquad\nz_i \\;=\\; L\\,\\zeta_i,\n$$\nwhere $L0$ is a length scale and $\\varepsilon$ is a small, dimensionless skewness parameter with $|\\varepsilon|\\ll 1$. The isoparametric interpolation with standard trilinear shape functions then induces a trilinear mapping $(\\xi,\\eta,\\zeta)\\mapsto(x(\\xi,\\eta,\\zeta),y(\\xi,\\eta,\\zeta),z(\\xi,\\eta,\\zeta))$ and its Jacobian matrix $\\mathbf{J}(\\xi,\\eta,\\zeta)=\\partial(x,y,z)/\\partial(\\xi,\\eta,\\zeta)$ with determinant $\\det \\mathbf{J}(\\xi,\\eta,\\zeta)$.\n\nLet the scalar stress field in physical space be the polynomial\n$$\n\\sigma(x,y,z)\\;=\\;\\beta\\,y,\n$$\nwith $\\beta$ a constant. Consider the element volume integral of the stress over the physical element,\n$$\nI \\;=\\; \\int_{\\Omega_e} \\sigma(x,y,z)\\,\\mathrm{d}\\Omega \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\sigma\\!\\bigl(x(\\xi,\\eta,\\zeta),y(\\xi,\\eta,\\zeta),z(\\xi,\\eta,\\zeta)\\bigr)\\,\\det\\mathbf{J}(\\xi,\\eta,\\zeta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta,\n$$\nand approximate it by the one-point Gauss rule in the parent space,\n$$\nI_G \\;=\\; 8\\,\\sigma\\!\\bigl(x(0,0,0),y(0,0,0),z(0,0,0)\\bigr)\\,\\det\\mathbf{J}(0,0,0).\n$$\n\nStarting only from the isoparametric mapping definition, the Jacobian determinant and change-of-variables formula for volume integrals, and the one-point Gauss rule, derive the leading-order (in $\\varepsilon$) absolute integration error\n$$\nE \\;=\\; I - I_G,\n$$\nby explicitly analyzing the variation of $\\det\\mathbf{J}$ across the element induced by the given skewness. Assume $|\\varepsilon|\\ll 1$ and neglect terms of order $\\varepsilon^{2}$ and higher. Express your final result as a closed-form analytic expression in terms of $\\beta$, $L$, and $\\varepsilon$. Do not include units in your final expression. No numerical rounding is required.", "solution": "The problem is to determine the leading-order integration error when approximating a volume integral of a linear stress field over a specific skewed hexahedral finite element using a one-point Gauss quadrature rule. The solution proceeds by first deriving the isoparametric coordinate mapping, then computing the Jacobian determinant of this mapping, and finally evaluating the exact and approximate integrals to find their difference.\n\nFirst, we establish the isoparametric mapping from the parent coordinates $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$ to the physical coordinates $(x, y, z)$. The mapping is defined by the standard trilinear shape functions $N_i(\\xi, \\eta, \\zeta)$ and the given nodal coordinates $(x_i, y_i, z_i)$. The physical coordinates are given by:\n$$x(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) x_i$$\n$$y(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) y_i$$\n$$z(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) z_i$$\nThe nodal coordinates are prescribed as $x_i = L\\,\\xi_i + \\varepsilon\\,L\\,\\xi_i\\,\\eta_i$, $y_i = L\\,\\eta_i$, and $z_i = L\\,\\zeta_i$, where $(\\xi_i, \\eta_i, \\zeta_i)$ are the parent coordinates of node $i$.\n\nDue to the properties of trilinear interpolation, expressions of the form $\\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) f(\\xi_i, \\eta_i, \\zeta_i)$ interpolate the function $f$ exactly if $f$ is a linear combination of terms like $1, \\xi, \\eta, \\zeta, \\xi\\eta, \\eta\\zeta, \\zeta\\xi, \\xi\\eta\\zeta$. The nodal coordinate definitions fall into this category.\nFor the $y$ and $z$ coordinates, we have:\n$$y(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) (L\\,\\eta_i) = L \\left(\\sum_{i=1}^{8} N_i \\eta_i\\right) = L\\,\\eta$$\n$$z(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) (L\\,\\zeta_i) = L \\left(\\sum_{i=1}^{8} N_i \\zeta_i\\right) = L\\,\\zeta$$\nFor the $x$ coordinate, the mapping is:\n$$x(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i (L\\,\\xi_i + \\varepsilon L\\,\\xi_i\\eta_i) = L \\left(\\sum_{i=1}^{8} N_i \\xi_i\\right) + \\varepsilon L \\left(\\sum_{i=1}^{8} N_i \\xi_i\\eta_i\\right) = L\\xi + \\varepsilon L\\xi\\eta$$\nThus, the complete coordinate mapping is:\n$$x(\\xi, \\eta, \\zeta) = L(\\xi + \\varepsilon\\xi\\eta)$$\n$$y(\\xi, \\eta, \\zeta) = L\\eta$$\n$$z(\\xi, \\eta, \\zeta) = L\\zeta$$\n\nNext, we calculate the Jacobian matrix $\\mathbf{J} = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)}$. Its components are the partial derivatives of the physical coordinates with respect to the parent coordinates:\n$$J_{11} = \\frac{\\partial x}{\\partial \\xi} = L(1 + \\varepsilon\\eta), \\quad J_{12} = \\frac{\\partial x}{\\partial \\eta} = L\\varepsilon\\xi, \\quad J_{13} = \\frac{\\partial x}{\\partial \\zeta} = 0$$\n$$J_{21} = \\frac{\\partial y}{\\partial \\xi} = 0, \\quad J_{22} = \\frac{\\partial y}{\\partial \\eta} = L, \\quad J_{23} = \\frac{\\partial y}{\\partial \\zeta} = 0$$\n$$J_{31} = \\frac{\\partial z}{\\partial \\xi} = 0, \\quad J_{32} = \\frac{\\partial z}{\\partial \\eta} = 0, \\quad J_{33} = \\frac{\\partial z}{\\partial \\zeta} = L$$\nThe Jacobian matrix is:\n$$\\mathbf{J}(\\xi, \\eta, \\zeta) = \\begin{pmatrix} L(1 + \\varepsilon\\eta)  L\\varepsilon\\xi  0 \\\\ 0  L  0 \\\\ 0  0  L \\end{pmatrix}$$\nThe determinant of the Jacobian matrix, $\\det\\mathbf{J}$, is:\n$$\\det\\mathbf{J}(\\xi, \\eta, \\zeta) = L(1 + \\varepsilon\\eta) \\cdot (L \\cdot L - 0 \\cdot 0) - L\\varepsilon\\xi \\cdot (0 \\cdot L - 0 \\cdot 0) = L^3(1 + \\varepsilon\\eta)$$\n\nNow, we can evaluate the exact integral $I$. The stress field is $\\sigma(x, y, z) = \\beta y$. In parent coordinates, this becomes $\\sigma = \\beta y(\\xi, \\eta, \\zeta) = \\beta L\\eta$. The integrand is $\\sigma \\det\\mathbf{J}$:\n$$\\sigma \\det\\mathbf{J} = (\\beta L\\eta) \\cdot (L^3(1 + \\varepsilon\\eta)) = \\beta L^4 (\\eta + \\varepsilon\\eta^2)$$\nThe exact integral $I$ is:\n$$I = \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\beta L^4 (\\eta + \\varepsilon\\eta^2) \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta$$\nWe can separate the integrals:\n$$I = \\beta L^4 \\left(\\int_{-1}^{1} \\mathrm{d}\\xi\\right) \\left(\\int_{-1}^{1} \\mathrm{d}\\zeta\\right) \\left(\\int_{-1}^{1} (\\eta + \\varepsilon\\eta^2) \\, \\mathrm{d}\\eta\\right)$$\nThe integrals with respect to $\\xi$ and $\\zeta$ are $\\int_{-1}^{1} \\mathrm{d}\\xi = 2$ and $\\int_{-1}^{1} \\mathrm{d}\\zeta = 2$.\nThe integral with respect to $\\eta$ is:\n$$\\int_{-1}^{1} (\\eta + \\varepsilon\\eta^2) \\, \\mathrm{d}\\eta = \\left[ \\frac{\\eta^2}{2} + \\varepsilon\\frac{\\eta^3}{3} \\right]_{-1}^{1} = \\left(\\frac{1}{2} + \\frac{\\varepsilon}{3}\\right) - \\left(\\frac{(-1)^2}{2} + \\varepsilon\\frac{(-1)^3}{3}\\right) = \\left(\\frac{1}{2} + \\frac{\\varepsilon}{3}\\right) - \\left(\\frac{1}{2} - \\frac{\\varepsilon}{3}\\right) = \\frac{2\\varepsilon}{3}$$\nSubstituting these results back into the expression for $I$:\n$$I = \\beta L^4 \\cdot (2) \\cdot (2) \\cdot \\left(\\frac{2\\varepsilon}{3}\\right) = \\frac{8}{3}\\beta L^4 \\varepsilon$$\n\nNext, we evaluate the approximate integral $I_G$ using the one-point Gauss rule. This rule evaluates the integrand at the center of the parent domain $(\\xi, \\eta, \\zeta)=(0, 0, 0)$ and multiplies by the volume of the domain, which is $8$.\n$$I_G = 8\\,\\sigma\\bigl(x(0,0,0),y(0,0,0),z(0,0,0)\\bigr)\\,\\det\\mathbf{J}(0,0,0)$$\nFirst, evaluate the arguments at $(\\xi, \\eta, \\zeta)=(0, 0, 0)$:\n$$y(0,0,0) = L \\cdot 0 = 0$$\nThe stress at the element center is therefore:\n$$\\sigma\\bigl(x(0,0,0),y(0,0,0),z(0,0,0)\\bigr) = \\beta \\cdot y(0,0,0) = 0$$\nThe Jacobian determinant at the center is:\n$$\\det\\mathbf{J}(0,0,0) = L^3(1 + \\varepsilon \\cdot 0) = L^3$$\nSubstituting these into the formula for $I_G$:\n$$I_G = 8 \\cdot (0) \\cdot (L^3) = 0$$\n\nFinally, the integration error $E$ is the difference $I - I_G$.\n$$E = I - I_G = \\frac{8}{3}\\beta L^4 \\varepsilon - 0 = \\frac{8}{3}\\beta L^4 \\varepsilon$$\nThis expression is linear in $\\varepsilon$, so it represents the leading-order error, and no terms of order $\\varepsilon^2$ or higher appear or need to be neglected.", "answer": "$$\\boxed{\\frac{8}{3}\\beta L^4 \\varepsilon}$$", "id": "3567421"}, {"introduction": "Once the geometric framework of an element is established, the next critical step is to correctly implement the material's physical behavior. This exercise focuses on the application of the three-dimensional isotropic linear elastic constitutive law, a fundamental relationship in computational geomechanics. By calculating the stress state from a given strain tensor, and then comparing this correct result to one obtained using a flawed two-dimensional assumption, you will reinforce your understanding of stress-strain coupling in 3D and learn to identify a common but significant source of error in finite element analysis [@problem_id:3567423].", "problem": "A single eight-node trilinear brick element is used to model a small soil specimen in a three-dimensional Finite Element Method (FEM) analysis under small strains. The material is an isotropic linear elastic solid with Young’s modulus $E = 30$ MPa and Poisson’s ratio $\\nu = 0.3$. At the element centroid, the engineering strain vector (Voigt order with engineering shear strains) is measured as\n$[\\varepsilon_{xx},\\, \\varepsilon_{yy},\\, \\varepsilon_{zz},\\, \\gamma_{yz},\\, \\gamma_{zx},\\, \\gamma_{xy}]^{\\mathsf{T}} = [1.0\\times 10^{-3},\\, 5.0\\times 10^{-4},\\, -2.0\\times 10^{-4},\\, 4.0\\times 10^{-4},\\, -1.0\\times 10^{-4},\\, 3.0\\times 10^{-4}]^{\\mathsf{T}}$.\n\nAssume small deformations and use the three-dimensional isotropic linear elastic stress–strain law to compute the stress vector $[\\sigma_{xx},\\, \\sigma_{yy},\\, \\sigma_{zz},\\, \\tau_{yz},\\, \\tau_{zx},\\, \\tau_{xy}]^{\\mathsf{T}}$ at the centroid. Now, suppose an inexperienced analyst mistakenly chooses a two-dimensional plane strain constitutive matrix for the normal components while still assembling a three-dimensional brick element, specifically:\n- they compute $\\sigma_{xx}$ and $\\sigma_{yy}$ from in-plane strains as if $\\varepsilon_{zz} = 0$ (thus ignoring the coupling of $\\varepsilon_{zz}$ into $\\sigma_{xx}$ and $\\sigma_{yy}$),\n- they set $\\sigma_{zz} = 0$,\n- they compute the shear components with the three-dimensional shear modulus as $\\tau_{ij} = G\\,\\gamma_{ij}$ for all three shear components.\n\nWhich statement best characterizes the effect of this inappropriate constitutive choice on the computed stresses at the centroid, both qualitatively and quantitatively?\n\nA. The incorrectly computed $\\sigma_{xx}$ and $\\sigma_{yy}$ are each higher than the correct three-dimensional values by exactly $-\\lambda\\,\\varepsilon_{zz}$, while $\\sigma_{zz}$ is spuriously zero; the shear components are unchanged. For the given data, the normal-stress errors are $\\Delta \\sigma_{xx} = \\Delta \\sigma_{yy} = 3.461538462\\times 10^{-3}$ MPa and the incorrect out-of-plane normal stress is $\\sigma_{zz}^{\\text{wrong}} = 0$ MPa.\n\nB. The incorrectly computed $\\sigma_{xx}$ equals the correct three-dimensional $\\sigma_{xx}$, but $\\sigma_{yy}$ is lower than the correct three-dimensional $\\sigma_{yy}$ by $\\lambda\\,\\varepsilon_{zz}$; $\\sigma_{zz}$ remains correctly computed.\n\nC. The shear stresses are also affected: the incorrectly computed $\\tau_{xy}$ is exactly twice the correct three-dimensional value, whereas $\\tau_{yz}$ and $\\tau_{zx}$ remain correct.\n\nD. The mean (hydrostatic) stress $p = (\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz})/3$ is unchanged by using the plane strain constitutive matrix, even when $\\varepsilon_{zz} \\neq 0$, so the trace of the stress tensor is preserved.", "solution": "### Derivation and Analysis\n\nThe core of the problem is to compare the stress vector computed using the correct 3D isotropic linear elastic law with that computed using the analyst's flawed procedure.\n\n**1. Material Constants**\n\nFirst, we calculate the necessary elastic constants from the given Young's modulus $E = 30$ MPa and Poisson’s ratio $\\nu = 0.3$.\n\nThe shear modulus, $G$, is:\n$$ G = \\frac{E}{2(1+\\nu)} = \\frac{30 \\text{ MPa}}{2(1+0.3)} = \\frac{30}{2.6} \\text{ MPa} \\approx 11.53846 \\text{ MPa} $$\n\nLamé's first parameter, $\\lambda$, is:\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} = \\frac{(30 \\text{ MPa})(0.3)}{(1+0.3)(1 - 2(0.3))} = \\frac{9}{1.3 \\times 0.4} = \\frac{9}{0.52} \\text{ MPa} \\approx 17.30769 \\text{ MPa} $$\n\n**2. Correct Stress Calculation (3D Elasticity)**\n\nThe stress-strain relationship for a 3D isotropic linear elastic material can be written using $\\lambda$ and $G$ as:\n$$ \\sigma_{ij} = \\lambda \\delta_{ij} \\varepsilon_v + 2G \\varepsilon_{ij} $$\nwhere $\\varepsilon_v = \\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$ is the volumetric strain, $\\delta_{ij}$ is the Kronecker delta, and $\\varepsilon_{ij}$ are the components of the tensor strain. In terms of engineering strains, the equations for the stress components are:\n\n$$ \\sigma_{xx}^{\\text{corr}} = \\lambda \\varepsilon_v + 2G \\varepsilon_{xx} $$\n$$ \\sigma_{yy}^{\\text{corr}} = \\lambda \\varepsilon_v + 2G \\varepsilon_{yy} $$\n$$ \\sigma_{zz}^{\\text{corr}} = \\lambda \\varepsilon_v + 2G \\varepsilon_{zz} $$\n$$ \\tau_{yz}^{\\text{corr}} = G \\gamma_{yz} $$\n$$ \\tau_{zx}^{\\text{corr}} = G \\gamma_{zx} $$\n$$ \\tau_{xy}^{\\text{corr}} = G \\gamma_{xy} $$\n\nFirst, we calculate the volumetric strain from the given data:\n$$ \\varepsilon_v = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz} = (1.0\\times 10^{-3}) + (5.0\\times 10^{-4}) + (-2.0\\times 10^{-4}) = (10 \\times 10^{-4}) + (5 \\times 10^{-4}) - (2 \\times 10^{-4}) = 13.0\\times 10^{-4} $$\n\nNow, we compute the correct stress components:\n$$ \\sigma_{xx}^{\\text{corr}} = (17.30769 \\text{ MPa})(13.0\\times 10^{-4}) + 2(11.53846 \\text{ MPa})(1.0\\times 10^{-3}) = 0.022500 + 0.023077 = 0.045577 \\text{ MPa} $$\n$$ \\sigma_{yy}^{\\text{corr}} = (17.30769 \\text{ MPa})(13.0\\times 10^{-4}) + 2(11.53846 \\text{ MPa})(5.0\\times 10^{-4}) = 0.022500 + 0.011538 = 0.034038 \\text{ MPa} $$\n$$ \\sigma_{zz}^{\\text{corr}} = (17.30769 \\text{ MPa})(13.0\\times 10^{-4}) + 2(11.53846 \\text{ MPa})(-2.0\\times 10^{-4}) = 0.022500 - 0.004615 = 0.017885 \\text{ MPa} $$\n$$ \\tau_{yz}^{\\text{corr}} = (11.53846 \\text{ MPa})(4.0\\times 10^{-4}) = 0.004615 \\text{ MPa} $$\n$$ \\tau_{zx}^{\\text{corr}} = (11.53846 \\text{ MPa})(-1.0\\times 10^{-4}) = -0.001154 \\text{ MPa} $$\n$$ \\tau_{xy}^{\\text{corr}} = (11.53846 \\text{ MPa})(3.0\\times 10^{-4}) = 0.003462 \\text{ MPa} $$\n\n**3. Incorrect Stress Calculation (Analyst's Method)**\n\nThe analyst's procedure is as follows:\n1.  **In-plane normal stresses:** Use the 2D plane strain constitutive law, which relates in-plane stresses to in-plane strains under the assumption that $\\varepsilon_{zz}=0$. The equations are:\n    $$ \\sigma_{xx} = (\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} $$\n    $$ \\sigma_{yy} = \\lambda\\varepsilon_{xx} + (\\lambda+2G)\\varepsilon_{yy} $$\n    The analyst applies these equations to the given $\\varepsilon_{xx}$ and $\\varepsilon_{yy}$ values.\n    $$ \\lambda+2G = 17.30769 + 2(11.53846) = 40.38461 \\text{ MPa} $$\n    $$ \\sigma_{xx}^{\\text{wrong}} = (40.38461)(1.0\\times 10^{-3}) + (17.30769)(5.0\\times 10^{-4}) = 0.040385 + 0.008654 = 0.049039 \\text{ MPa} $$\n    $$ \\sigma_{yy}^{\\text{wrong}} = (17.30769)(1.0\\times 10^{-3}) + (40.38461)(5.0\\times 10^{-4}) = 0.017308 + 0.020192 = 0.037500 \\text{ MPa} $$\n\n2.  **Out-of-plane normal stress:** Set it to zero.\n    $$ \\sigma_{zz}^{\\text{wrong}} = 0 \\text{ MPa} $$\n\n3.  **Shear stresses:** Compute all three shear components using the 3D shear modulus.\n    $$ \\tau_{yz}^{\\text{wrong}} = G \\gamma_{yz} = (11.53846 \\text{ MPa})(4.0\\times 10^{-4}) = 0.004615 \\text{ MPa} $$\n    $$ \\tau_{zx}^{\\text{wrong}} = G \\gamma_{zx} = (11.53846 \\text{ MPa})(-1.0\\times 10^{-4}) = -0.001154 \\text{ MPa} $$\n    $$ \\tau_{xy}^{\\text{wrong}} = G \\gamma_{xy} = (11.53846 \\text{ MPa})(3.0\\times 10^{-4}) = 0.003462 \\text{ MPa} $$\n\n**4. Comparison and Error Analysis**\n\nLet's compare the correct and incorrect stress vectors.\n\n-   **Shear Stresses:** The analyst's procedure for shear stresses ($\\tau_{ij} = G\\gamma_{ij}$) is identical to the correct 3D formulation. Therefore, all shear stress components are computed correctly: $\\tau_{ij}^{\\text{wrong}} = \\tau_{ij}^{\\text{corr}}$.\n\n-   **Normal Stresses:**\n    -   Let's find the error in $\\sigma_{xx}$ and $\\sigma_{yy}$ algebraically.\n    The correct expression for $\\sigma_{xx}$ can be rewritten as:\n    $$ \\sigma_{xx}^{\\text{corr}} = \\lambda(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz}) + 2G\\varepsilon_{xx} = (\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + \\lambda\\varepsilon_{zz} $$\n    The incorrect expression is:\n    $$ \\sigma_{xx}^{\\text{wrong}} = (\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} $$\n    The error, $\\Delta\\sigma_{xx} = \\sigma_{xx}^{\\text{wrong}} - \\sigma_{xx}^{\\text{corr}}$, is therefore:\n    $$ \\Delta\\sigma_{xx} = [(\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy}] - [(\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + \\lambda\\varepsilon_{zz}] = -\\lambda\\varepsilon_{zz} $$\n    Similarly, for $\\sigma_{yy}$:\n    $$ \\sigma_{yy}^{\\text{corr}} = \\lambda\\varepsilon_{xx} + (\\lambda+2G)\\varepsilon_{yy} + \\lambda\\varepsilon_{zz} $$\n    $$ \\sigma_{yy}^{\\text{wrong}} = \\lambda\\varepsilon_{xx} + (\\lambda+2G)\\varepsilon_{yy} $$\n    The error, $\\Delta\\sigma_{yy} = \\sigma_{yy}^{\\text{wrong}} - \\sigma_{yy}^{\\text{corr}}$, is:\n    $$ \\Delta\\sigma_{yy} = -\\lambda\\varepsilon_{zz} $$\n    The error in both in-plane normal stresses is identical and equal to $-\\lambda\\varepsilon_{zz}$.\n\n    -   Let's compute the numerical value of this error:\n    $$ \\text{Error} = -\\lambda\\varepsilon_{zz} = -(17.30769 \\text{ MPa})(-2.0\\times 10^{-4}) = 3.461538\\times 10^{-3} \\text{ MPa} $$\n    This positive error means the incorrectly computed stresses are *higher* than the correct ones.\n    Let's check this with our full calculations:\n    $\\Delta\\sigma_{xx} = 0.049039 - 0.045577 = 0.003462 \\approx 3.46 \\times 10^{-3}$ MPa.\n    $\\Delta\\sigma_{yy} = 0.037500 - 0.034038 = 0.003462 \\approx 3.46 \\times 10^{-3}$ MPa.\n    The numerical results confirm the algebraic derivation.\n\n    -   For the out-of-plane normal stress, the error is:\n    $$ \\Delta\\sigma_{zz} = \\sigma_{zz}^{\\text{wrong}} - \\sigma_{zz}^{\\text{corr}} = 0 - 0.017885 = -0.017885 \\text{ MPa} $$\n    The analyst's method spuriously sets this stress to zero.\n\n### Option-by-Option Analysis\n\n**A. The incorrectly computed $\\sigma_{xx}$ and $\\sigma_{yy}$ are each higher than the correct three-dimensional values by exactly $-\\lambda\\,\\varepsilon_{zz}$, while $\\sigma_{zz}$ is spuriously zero; the shear components are unchanged. For the given data, the normal-stress errors are $\\Delta \\sigma_{xx} = \\Delta \\sigma_{yy} = 3.461538462\\times 10^{-3}$ MPa and the incorrect out-of-plane normal stress is $\\sigma_{zz}^{\\text{wrong}} = 0$ MPa.**\n- The error in $\\sigma_{xx}$ and $\\sigma_{yy}$ is indeed $\\Delta\\sigma = \\sigma^{\\text{wrong}} - \\sigma^{\\text{corr}} = -\\lambda\\varepsilon_{zz}$. Since $\\lambda  0$ and $\\varepsilon_{zz}  0$, the error term $-\\lambda\\varepsilon_{zz}$ is positive, meaning the incorrect values are higher. This is correctly stated.\n- The algebraic form of the error, $-\\lambda\\varepsilon_{zz}$, is correct.\n- The shear components are unchanged, which is correct.\n- $\\sigma_{zz}$ is spuriously zero, which is correct.\n- The numerical value of the error, $-\\lambda\\varepsilon_{zz} = 3.461538...\\times 10^{-3}$ MPa, is correct.\n- The incorrect value $\\sigma_{zz}^{\\text{wrong}} = 0$ MPa is correct.\nEvery part of this statement is consistent with our derivation.\n**Verdict: Correct**\n\n**B. The incorrectly computed $\\sigma_{xx}$ equals the correct three-dimensional $\\sigma_{xx}$, but $\\sigma_{yy}$ is lower than the correct three-dimensional $\\sigma_{yy}$ by $\\lambda\\,\\varepsilon_{zz}$; $\\sigma_{zz}$ remains correctly computed.**\n- Incorrect. $\\sigma_{xx}$ is not equal to the correct value; its error is $-\\lambda\\varepsilon_{zz} \\neq 0$.\n- Incorrect. $\\sigma_{yy}$ is higher, not lower, and the error amount is $-\\lambda\\varepsilon_{zz}$, not $\\lambda\\varepsilon_{zz}$.\n- Incorrect. $\\sigma_{zz}$ is incorrectly set to $0$.\n**Verdict: Incorrect**\n\n**C. The shear stresses are also affected: the incorrectly computed $\\tau_{xy}$ is exactly twice the correct three-dimensional value, whereas $\\tau_{yz}$ and $\\tau_{zx}$ remain correct.**\n- Incorrect. The problem statement specifies that all three shear components are computed using $\\tau_{ij} = G\\gamma_{ij}$, which is the correct 3D formula. Therefore, all shear stresses are computed correctly and are unchanged.\n**Verdict: Incorrect**\n\n**D. The mean (hydrostatic) stress $p = (\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz})/3$ is unchanged by using the plane strain constitutive matrix, even when $\\varepsilon_{zz} \\neq 0$, so the trace of the stress tensor is preserved.**\n- Let's check the trace of the stress tensor, $\\text{tr}(\\sigma) = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}$.\n- Correct trace: $\\text{tr}(\\sigma^{\\text{corr}}) = \\sigma_{xx}^{\\text{corr}} + \\sigma_{yy}^{\\text{corr}} + \\sigma_{zz}^{\\text{corr}}$. We know from elasticity theory that $\\text{tr}(\\sigma) = (3\\lambda+2G)\\varepsilon_v$. With our data, $\\text{tr}(\\sigma^{\\text{corr}}) = (0.045577 + 0.034038 + 0.017885) \\text{ MPa} = 0.0975 \\text{ MPa}$.\n- Incorrect trace: $\\text{tr}(\\sigma^{\\text{wrong}}) = \\sigma_{xx}^{\\text{wrong}} + \\sigma_{yy}^{\\text{wrong}} + \\sigma_{zz}^{\\text{wrong}} = (0.049039 + 0.037500 + 0) \\text{ MPa} = 0.086539 \\text{ MPa}$.\n- Since $0.0975 \\neq 0.086539$, the trace is not preserved, and the mean stress is not unchanged.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "3567423"}, {"introduction": "While brick elements are robust, tetrahedral elements provide superior flexibility for meshing highly complex geological domains. Standard linear tetrahedral elements, however, are notoriously prone to being overly stiff, a phenomenon known as locking. This practice introduces an advanced technique, the Edge-based Smoothed Finite Element Method (ES-FEM), designed to mitigate this issue [@problem_id:3567369]. By deriving and comparing the discrete energy of a standard Galerkin formulation against its smoothed counterpart, you will explore how modifying the strain field definition can dramatically improve element accuracy and stability.", "problem": "Consider steady scalar diffusion as a surrogate for small-strain, linear kinematics in computational geomechanics. Let the governing strong form be $-\\nabla \\cdot \\left(k \\nabla u \\right)=0$ in a bounded domain, with $k$ being a positive constant. The standard Galerkin Finite Element Method (FEM) uses the discrete field $u_{h}$ built from linear shape functions on tetrahedra, and the discrete energy functional $E_{\\mathrm{std}}(u_{h})=\\frac{1}{2}\\int_{\\Omega} k \\, |\\nabla u_{h}|^{2}\\, \\mathrm{d}V$. An Edge-based Smoothed Finite Element Method (ES-FEM) replaces the elemental gradient by a smoothed gradient over edge-based smoothing cells. For any smoothing domain $\\Omega^{(s)}$ associated with an edge, the smoothed gradient operator is defined via a domain average of the field gradient.\n\nWork on the two-tetrahedron patch $\\Omega=\\mathrm{T}_{1}\\cup \\mathrm{T}_{2}$ with nodes\n- $\\mathbf{x}_{1}=(0,0,0)$, $\\mathbf{x}_{2}=(1,0,0)$, $\\mathbf{x}_{3}=(0,1,0)$, $\\mathbf{x}_{4}=(0,0,1)$ defining $\\mathrm{T}_{1}=\\mathrm{conv}\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3},\\mathbf{x}_{4}\\}$, and\n- $\\mathbf{x}_{5}=(0,0,-1)$ together with $\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3}$ defining $\\mathrm{T}_{2}=\\mathrm{conv}\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3},\\mathbf{x}_{5}\\}$,\n\nso that $\\mathrm{T}_{1}$ and $\\mathrm{T}_{2}$ share the face $\\mathrm{conv}\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3}\\}$ and the three internal edges $\\overline{\\mathbf{x}_{1}\\mathbf{x}_{2}}$, $\\overline{\\mathbf{x}_{1}\\mathbf{x}_{3}}$, and $\\overline{\\mathbf{x}_{2}\\mathbf{x}_{3}}$. Take $k=1$. Use linear shape functions on each tetrahedron, with the usual nodal interpolation. Define the ES-FEM edge-based smoothing cells $\\Omega^{(e)}$ as follows: for each mesh edge $e$, and for each tetrahedron $\\mathrm{T}$ incident to $e$, form the convex hull of four points: the element centroid $\\mathbf{C}_{\\mathrm{T}}$, the two face centroids of faces of $\\mathrm{T}$ that are incident to $e$, and the edge midpoint of $e$. The edge-based smoothing cell $\\Omega^{(e)}$ is the union of these convex hulls taken over all tetrahedra incident to $e$. Assume this construction partitions each tetrahedron $\\mathrm{T}$ exactly into six edge-contributed subcells, each of volume $V_{\\mathrm{T}}/6$, where $V_{\\mathrm{T}}$ is the volume of $\\mathrm{T}$.\n\nTasks:\n- (i) Starting from the divergence theorem, derive the expression of the smoothed gradient operator $\\tilde{\\nabla} N_{I}$ of a linear shape function $N_{I}$ over a generic smoothing domain $\\Omega^{(s)}$ in terms of a volume average of $\\nabla N_{I}$.\n- (ii) For the nodal vector $u$ with $u(\\mathbf{x}_{4})=1$ and $u(\\mathbf{x}_{i})=0$ for all $i\\in\\{1,2,3,5\\}$, compute the standard FEM discrete energy $E_{\\mathrm{std}}(u)$ over $\\Omega$.\n- (iii) Using the edge-based smoothing construction and the result of part (i), compute the ES-FEM discrete energy $E_{\\mathrm{ES}}(u)=\\frac{1}{2}\\sum_{e} \\int_{\\Omega^{(e)}} |\\tilde{\\nabla} u|^{2} \\, \\mathrm{d}V$, where the sum runs over all edges in the two-tetrahedron patch. Then compute the ratio $R=\\frac{E_{\\mathrm{ES}}(u)}{E_{\\mathrm{std}}(u)}$.\n\nExpress your final answer for $R$ as a single exact number. No rounding is required. No units are required.", "solution": "### Solution\nThe solution addresses the three tasks in sequence.\n\n**(i) Derivation of the Smoothed Gradient Operator**\nThe smoothed gradient $\\tilde{\\nabla} u$ over a smoothing domain $\\Omega^{(s)}$ with volume $V^{(s)} = \\int_{\\Omega^{(s)}} \\mathrm{d}V$ is defined as the constant vector that satisfies the equivalence in weak form:\n$$ \\int_{\\Omega^{(s)}} \\mathbf{v} \\cdot \\tilde{\\nabla} u \\, \\mathrm{d}V = \\int_{\\Omega^{(s)}} \\mathbf{v} \\cdot \\nabla u \\, \\mathrm{d}V $$\nfor any arbitrary constant test vector $\\mathbf{v}$.\nSince $\\mathbf{v}$ and $\\tilde{\\nabla} u$ are constant over the domain $\\Omega^{(s)}$, the left side becomes:\n$$ \\mathbf{v} \\cdot (\\tilde{\\nabla} u) V^{(s)} = \\int_{\\Omega^{(s)}} \\mathbf{v} \\cdot \\nabla u \\, \\mathrm{d}V = \\mathbf{v} \\cdot \\left( \\int_{\\Omega^{(s)}} \\nabla u \\, \\mathrm{d}V \\right) $$\nThis equality must hold for any constant vector $\\mathbf{v}$, which implies the expression for the smoothed gradient as a volume average of the conventional gradient:\n$$ \\tilde{\\nabla} u = \\frac{1}{V^{(s)}} \\int_{\\Omega^{(s)}} \\nabla u \\, \\mathrm{d}V $$\nThe problem asks for a derivation starting from the divergence theorem, which relates a volume integral of a divergence of a vector field $\\mathbf{F}$ to a surface integral of the field over the boundary $\\partial\\Omega^{(s)}$: $\\int_{\\Omega^{(s)}} \\nabla \\cdot \\mathbf{F} \\, \\mathrm{d}V = \\int_{\\partial\\Omega^{(s)}} \\mathbf{F} \\cdot \\mathbf{n} \\, \\mathrm{d}A$, where $\\mathbf{n}$ is the outward unit normal vector to the surface.\nLet $\\mathbf{F} = u \\mathbf{c}$, where $\\mathbf{c}$ is an arbitrary constant vector. The divergence of $\\mathbf{F}$ is $\\nabla \\cdot (u\\mathbf{c}) = (\\nabla u) \\cdot \\mathbf{c} + u (\\nabla \\cdot \\mathbf{c})$. Since $\\mathbf{c}$ is constant, $\\nabla \\cdot \\mathbf{c} = 0$, so $\\nabla \\cdot (u\\mathbf{c}) = (\\nabla u) \\cdot \\mathbf{c}$.\nApplying the divergence theorem:\n$$ \\int_{\\Omega^{(s)}} (\\nabla u) \\cdot \\mathbf{c} \\, \\mathrm{d}V = \\int_{\\partial\\Omega^{(s)}} (u\\mathbf{c}) \\cdot \\mathbf{n} \\, \\mathrm{d}A $$\n$$ \\left( \\int_{\\Omega^{(s)}} \\nabla u \\, \\mathrm{d}V \\right) \\cdot \\mathbf{c} = \\left( \\int_{\\partial\\Omega^{(s)}} u\\mathbf{n} \\, \\mathrm{d}A \\right) \\cdot \\mathbf{c} $$\nAs this holds for any constant vector $\\mathbf{c}$, we obtain the gradient theorem:\n$$ \\int_{\\Omega^{(s)}} \\nabla u \\, \\mathrm{d}V = \\int_{\\partial\\Omega^{(s)}} u\\mathbf{n} \\, \\mathrm{d}A $$\nSubstituting this into the definition of the smoothed gradient yields an alternative expression based on a surface integral:\n$$ \\tilde{\\nabla} u = \\frac{1}{V^{(s)}} \\int_{\\partial\\Omega^{(s)}} u\\mathbf{n} \\, \\mathrm{d}A $$\nFor a linear shape function $N_I$, the expressions are:\n$$ \\tilde{\\nabla} N_I = \\frac{1}{V^{(s)}} \\int_{\\Omega^{(s)}} \\nabla N_I \\, \\mathrm{d}V = \\frac{1}{V^{(s)}} \\int_{\\partial\\Omega^{(s)}} N_I\\mathbf{n} \\, \\mathrm{d}A $$\n\n**(ii) Computation of the Standard FEM Discrete Energy**\nThe standard FEM energy is $E_{\\mathrm{std}}(u) = \\frac{1}{2}\\int_{\\Omega} k |\\nabla u_h|^2 \\mathrm{d}V$. With $k=1$, this is $E_{\\mathrm{std}}(u) = \\frac{1}{2}\\int_{\\Omega} |\\nabla u_h|^2 \\mathrm{d}V$.\nThe discrete field is $u_h(\\mathbf{x}) = \\sum_{I} u_I N_I(\\mathbf{x})$. Given the nodal values $u_4=1$ and $u_i=0$ for $i \\in \\{1,2,3,5\\}$, the field is $u_h(\\mathbf{x}) = N_4(\\mathbf{x})$.\nThe shape function $N_4(\\mathbf{x})$ is non-zero only on the tetrahedron $\\mathrm{T}_1$ to which node $4$ belongs. Thus, $u_h(\\mathbf{x})$ is non-zero on $\\mathrm{T}_1$ and identically zero on $\\mathrm{T}_2$. The integral for the energy is therefore confined to $\\mathrm{T}_1$:\n$$ E_{\\mathrm{std}}(u) = \\frac{1}{2}\\int_{\\mathrm{T}_1} |\\nabla N_4|^2 \\mathrm{d}V $$\nFor a linear tetrahedral element, the gradient of a shape function is constant throughout the element. Thus, the integral becomes:\n$$ E_{\\mathrm{std}}(u) = \\frac{1}{2} |\\nabla N_4|^2 V_{\\mathrm{T}_1} $$\nwhere $V_{\\mathrm{T}_1}$ is the volume of tetrahedron $\\mathrm{T}_1$. The nodes of $\\mathrm{T}_1$ are $\\mathbf{x}_{1}=(0,0,0)$, $\\mathbf{x}_{2}=(1,0,0)$, $\\mathbf{x}_{3}=(0,1,0)$, and $\\mathbf{x}_{4}=(0,0,1)$. The volume is given by:\n$$ V_{\\mathrm{T}_1} = \\frac{1}{6} |(\\mathbf{x}_2 - \\mathbf{x}_1) \\cdot ((\\mathbf{x}_3 - \\mathbf{x}_1) \\times (\\mathbf{x}_4 - \\mathbf{x}_1))| = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right| = \\frac{1}{6} $$\nThe linear shape function $N_4(\\mathbf{x})$ for $\\mathbf{x}=(x,y,z) \\in \\mathrm{T}_1$ must satisfy $N_4(\\mathbf{x}_I) = \\delta_{4I}$. A linear function $N_4(x,y,z) = a+bx+cy+dz$ must satisfy $N_4(\\mathbf{x}_1)=a=0$, $N_4(\\mathbf{x}_2)=a+b=0 \\implies b=0$, $N_4(\\mathbf{x}_3)=a+c=0 \\implies c=0$, and $N_4(\\mathbf{x}_4)=a+d=1 \\implies d=1$. So, $N_4(x,y,z) = z$.\nThe gradient is $\\nabla N_4 = (0,0,1)$, and its squared magnitude is $|\\nabla N_4|^2 = 1^2 = 1$.\nThe standard FEM energy is:\n$$ E_{\\mathrm{std}}(u) = \\frac{1}{2} (1) \\left(\\frac{1}{6}\\right) = \\frac{1}{12} $$\n\n**(iii) Computation of the ES-FEM Discrete Energy and the Ratio R**\nThe ES-FEM energy is $E_{\\mathrm{ES}}(u) = \\frac{1}{2}\\sum_{e} \\int_{\\Omega^{(e)}} |\\tilde{\\nabla} u_h|^2 \\mathrm{d}V$. Since $\\tilde{\\nabla} u_h$ is constant on each smoothing cell $\\Omega^{(e)}$, this simplifies to:\n$$ E_{\\mathrm{ES}}(u) = \\frac{1}{2}\\sum_{e} V^{(e)} |\\tilde{\\nabla} u_h|_{\\Omega^{(e)}}|^2 $$\nwhere $u_h = N_4$. The smoothed gradient on edge $e$ is $\\tilde{\\nabla} N_4|_{\\Omega^{(e)}} = \\frac{1}{V^{(e)}} \\int_{\\Omega^{(e)}} \\nabla N_4 \\, \\mathrm{d}V$.\nThe mesh has $9$ unique edges:\n- $3$ internal edges common to $\\mathrm{T}_1$ and $\\mathrm{T}_2$: $e_{\\text{int}} \\in \\{\\overline{\\mathbf{x}_1\\mathbf{x}_2}, \\overline{\\mathbf{x}_1\\mathbf{x}_3}, \\overline{\\mathbf{x}_2\\mathbf{x}_3}\\}$.\n- $3$ boundary edges belonging only to $\\mathrm{T}_1$: $e_{\\text{b,1}} \\in \\{\\overline{\\mathbf{x}_1\\mathbf{x}_4}, \\overline{\\mathbf{x}_2\\mathbf{x}_4}, \\overline{\\mathbf{x}_3\\mathbf{x}_4}\\}$.\n- $3$ boundary edges belonging only to $\\mathrm{T}_2$: $e_{\\text{b,2}} \\in \\{\\overline{\\mathbf{x}_1\\mathbf{x}_5}, \\overline{\\mathbf{x}_2\\mathbf{x}_5}, \\overline{\\mathbf{x}_3\\mathbf{x}_5}\\}$.\n\nThe volume of $\\mathrm{T}_2$ with nodes $\\mathbf{x}_{1}(0,0,0), \\mathbf{x}_{2}(1,0,0), \\mathbf{x}_{3}(0,1,0), \\mathbf{x}_{5}(0,0,-1)$ is $V_{\\mathrm{T}_2} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  -1 \\end{pmatrix} \\right| = \\frac{1}{6}$.\nThe volume of each edge-based smoothing cell $V^{(e)}$ is the sum of contributions from its incident tetrahedra. Each tetrahedron $\\mathrm{T}$ contributes a volume of $V_{\\mathrm{T}}/6$ to each of its $6$ edges.\n- For an internal edge $e_{\\text{int}}$, $V^{(e_{\\text{int}})} = V_{\\mathrm{T}_1}/6 + V_{\\mathrm{T}_2}/6 = (1/6)/6 + (1/6)/6 = 1/18$.\n- For a boundary edge $e_{\\text{b,1}}$, $V^{(e_{\\text{b,1}})} = V_{\\mathrm{T}_1}/6 = 1/36$.\n- For a boundary edge $e_{\\text{b,2}}$, $V^{(e_{\\text{b,2}})} = V_{\\mathrm{T}_2}/6 = 1/36$.\n\nThe gradient $\\nabla N_4$ is constant on each tetrahedron: $\\nabla N_4|_{\\mathrm{T}_1} = (0,0,1)$ and $\\nabla N_4|_{\\mathrm{T}_2} = \\mathbf{0}$ (since $N_4$ is zero at all nodes of $\\mathrm{T}_2$).\nThe integral for the smoothed gradient becomes a sum over subcells: $\\int_{\\Omega^{(e)}} \\nabla N_4 \\, \\mathrm{d}V = \\sum_{\\mathrm{T} \\ni e} (\\nabla N_4|_\\mathrm{T}) (V_\\mathrm{T}/6)$.\n\n- For the $3$ internal edges $e_{\\text{int}}$:\n$\\int_{\\Omega^{(e_{\\text{int}})}} \\nabla N_4 \\mathrm{d}V = (\\nabla N_4|_{\\mathrm{T}_1}) (V_{\\mathrm{T}_1}/6) + (\\nabla N_4|_{\\mathrm{T}_2}) (V_{\\mathrm{T}_2}/6) = (0,0,1)(1/36) + \\mathbf{0}(1/36) = (0,0,1/36)$.\n$\\tilde{\\nabla} N_4|_{\\Omega^{(e_{\\text{int}})}} = \\frac{(0,0,1/36)}{1/18} = (0,0,1/2)$.\n$|\\tilde{\\nabla} N_4|^2 = (1/2)^2 = 1/4$.\nEnergy contribution: $3 \\times \\frac{1}{2} V^{(e_{\\text{int}})} |\\tilde{\\nabla} N_4|^2 = 3 \\times \\frac{1}{2} \\times \\frac{1}{18} \\times \\frac{1}{4} = \\frac{3}{144} = \\frac{1}{48}$.\n\n- For the $3$ boundary edges $e_{\\text{b,1}}$:\n$\\int_{\\Omega^{(e_{\\text{b,1}})}} \\nabla N_4 \\mathrm{d}V = (\\nabla N_4|_{\\mathrm{T}_1}) (V_{\\mathrm{T}_1}/6) = (0,0,1)(1/36)$.\n$\\tilde{\\nabla} N_4|_{\\Omega^{(e_{\\text{b,1}})}} = \\frac{(0,0,1/36)}{1/36} = (0,0,1)$.\n$|\\tilde{\\nabla} N_4|^2 = 1^2 = 1$.\nEnergy contribution: $3 \\times \\frac{1}{2} V^{(e_{\\text{b,1}})} |\\tilde{\\nabla} N_4|^2 = 3 \\times \\frac{1}{2} \\times \\frac{1}{36} \\times 1 = \\frac{3}{72} = \\frac{1}{24}$.\n\n- For the $3$ boundary edges $e_{\\text{b,2}}$:\n$\\int_{\\Omega^{(e_{\\text{b,2}})}} \\nabla N_4 \\mathrm{d}V = (\\nabla N_4|_{\\mathrm{T}_2}) (V_{\\mathrm{T}_2}/6) = \\mathbf{0}(1/36) = \\mathbf{0}$.\n$\\tilde{\\nabla} N_4|_{\\Omega^{(e_{\\text{b,2}})}} = \\mathbf{0}$, so the energy contribution is $0$.\n\nThe total ES-FEM energy is the sum of these contributions:\n$$ E_{\\mathrm{ES}}(u) = \\frac{1}{48} + \\frac{1}{24} + 0 = \\frac{1+2}{48} = \\frac{3}{48} = \\frac{1}{16} $$\nFinally, the ratio $R$ is:\n$$ R = \\frac{E_{\\mathrm{ES}}(u)}{E_{\\mathrm{std}}(u)} = \\frac{1/16}{1/12} = \\frac{12}{16} = \\frac{3}{4} $$\nThe final answer is an exact number as required.", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "3567369"}]}