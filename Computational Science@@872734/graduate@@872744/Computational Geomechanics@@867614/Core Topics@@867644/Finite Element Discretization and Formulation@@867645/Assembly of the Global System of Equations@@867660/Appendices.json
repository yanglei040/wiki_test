{"hands_on_practices": [{"introduction": "Before we can assemble a global system, we must first understand where its fundamental building blocks—the element stiffness matrix and force vector—originate. This foundational exercise guides you through this derivation for a simple one-dimensional bar element, starting directly from the Principle of Virtual Work [@problem_id:3501532]. By completing this practice, you will solidify the connection between the continuous physics of a problem and its discrete algebraic representation, which is the cornerstone of the Finite Element Method.", "problem": "Consider a two-node linear finite element in one-dimensional axial deformation of a prismatic bar segment. The bar segment has constant Young's modulus $E$, constant cross-sectional area $A$, and length $L$. Let the axial displacement field be $u(x)$ along the bar axis $x \\in [0,L]$. A uniform body force per unit volume $b$ acts along the positive axial direction. At the right end $x=L$, a prescribed outward axial traction $\\bar{t}$ (with units of stress) acts on the end cross-section, while no external traction acts at $x=0$. Assume small strains and linear elasticity, with stress $\\sigma = E \\,\\varepsilon$ and axial strain $\\varepsilon = du/dx$.\n\nStarting from the strong form of linear momentum balance in one dimension and the Principle of Virtual Work, derive the consistent two-by-two element stiffness matrix $K_{e}$ and the consistent two-component element external force vector $f_{\\mathrm{ext},e}$ using exact integration over the element domain and boundary. Use a standard two-node isoparametric linear interpolation for $u(x)$ and its virtual variation over the parent domain, but perform all integrations exactly in the physical coordinate $x$.\n\nThen, using your derived $K_{e}$ and $f_{\\mathrm{ext},e}$, write the element potential energy functional\n$$\n\\Pi_{e}(u_{1},u_{2}) \\;=\\; \\tfrac{1}{2}\\, \\begin{bmatrix} u_{1}  u_{2} \\end{bmatrix} K_{e} \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix} \\;-\\; \\begin{bmatrix} u_{1}  u_{2} \\end{bmatrix} f_{\\mathrm{ext},e},\n$$\nas a closed-form analytic expression in terms of $E$, $A$, $L$, $b$, $\\bar{t}$, $u_{1}$, and $u_{2}$.\n\nYour final answer must be a single closed-form analytic expression for $\\Pi_{e}(u_{1},u_{2})$. Do not provide intermediate matrices or vectors as the final answer. No numerical evaluation is required. Express your final answer without units.", "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, complete, and mathematically verifiable. It represents a standard derivation within the finite element method for linear elastostatics. All provided data and definitions ($E$, $A$, $L$, $b$, $\\bar{t}$) are consistent and sufficient for the derivation of the requested potential energy functional. There are no contradictions, ambiguities, or violations of physical principles.\n\nWe begin with the principle of virtual work (PVW) for a one-dimensional elastic body, which equates the internal virtual work to the external virtual work. For the given element of volume $V_e$ and boundary surface $\\partial V_e$, the PVW is:\n$$\n\\int_{V_e} \\delta\\varepsilon \\, \\sigma \\, \\mathrm{d}V = \\int_{V_e} \\delta u \\, b \\, \\mathrm{d}V + \\int_{\\partial V_e} \\delta u \\, t \\, \\mathrm{d}S\n$$\nwhere $\\sigma$ is the axial stress, $\\varepsilon$ is the axial strain, $\\delta\\varepsilon$ and $\\delta u$ are the virtual strain and virtual displacement, respectively, $b$ is the body force per unit volume, and $t$ is the surface traction.\n\nFor the one-dimensional prismatic bar of length $L$ and constant cross-section $A$, this simplifies. We use the physical coordinate $x$ from $0$ to $L$. The volume element is $\\mathrm{d}V = A \\, \\mathrm{d}x$. The PVW becomes:\n$$\n\\int_0^L \\delta\\varepsilon(x) \\, \\sigma(x) \\, A \\, \\mathrm{d}x = \\int_0^L \\delta u(x) \\, b \\, A \\, \\mathrm{d}x + \\left[ \\delta u(x) \\, t(x) \\, A \\right]_{x=0}^{x=L}\n$$\nThe problem specifies a prescribed outward traction $\\bar{t}$ at $x=L$ and no external traction at $x=0$. Thus, $t(L) = \\bar{t}$ and the traction force from the external world at $x=0$ is zero. The boundary term becomes $A \\, \\bar{t} \\, \\delta u(L)$. Using the linear constitutive law $\\sigma = E\\varepsilon$, the PVW is:\n$$\n\\int_0^L \\delta\\varepsilon \\, A E \\varepsilon \\, \\mathrm{d}x = \\int_0^L \\delta u \\, A b \\, \\mathrm{d}x + A \\bar{t} \\, \\delta u(L)\n$$\nNext, we introduce the finite element approximation for the displacement field $u(x)$ and its variation $\\delta u(x)$ over the two-node element. The nodes are at $x_1=0$ and $x_2=L$, with corresponding nodal displacements $u_1$ and $u_2$. The linear interpolation is given by:\n$$\nu(x) = N_1(x) u_1 + N_2(x) u_2\n$$\nwhere $N_1(x)$ and $N_2(x)$ are the linear shape functions. These must satisfy $N_1(0)=1$, $N_1(L)=0$, $N_2(0)=0$, and $N_2(L)=1$. The unique linear functions are:\n$$\nN_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L}\n$$\nIn matrix notation, $u(x) = \\mathbf{N}(x) \\mathbf{u}_e$, where $\\mathbf{N}(x) = \\begin{bmatrix} N_1(x)  N_2(x) \\end{bmatrix}$ and $\\mathbf{u}_e = \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix}$. The virtual displacement follows the same interpolation: $\\delta u(x) = \\mathbf{N}(x) \\delta\\mathbf{u}_e$.\n\nThe strain $\\varepsilon = \\mathrm{d}u/\\mathrm{d}x$ is found by differentiating the shape functions:\n$$\n\\varepsilon(x) = \\frac{\\mathrm{d}N_1}{\\mathrm{d}x} u_1 + \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} u_2 = \\left(-\\frac{1}{L}\\right) u_1 + \\left(\\frac{1}{L}\\right) u_2 = \\frac{u_2 - u_1}{L}\n$$\nIn matrix form, $\\varepsilon(x) = \\mathbf{B} \\mathbf{u}_e$, where the strain-displacement matrix $\\mathbf{B}$ is:\n$$\n\\mathbf{B} = \\begin{bmatrix} \\frac{\\mathrm{d}N_1}{\\mathrm{d}x}  \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{bmatrix}\n$$\nThe virtual strain is $\\delta\\varepsilon = \\mathbf{B} \\delta\\mathbf{u}_e$. Substituting these discretizations into the PVW:\n$$\n\\int_0^L (\\mathbf{B} \\delta\\mathbf{u}_e)^T A E (\\mathbf{B} \\mathbf{u}_e) \\, \\mathrm{d}x = \\int_0^L (\\mathbf{N} \\delta\\mathbf{u}_e)^T A b \\, \\mathrm{d}x + (\\mathbf{N}(L) \\delta\\mathbf{u}_e)^T A \\bar{t}\n$$\nUsing matrix transpose properties and factoring out the constant nodal displacement vectors $\\mathbf{u}_e$ and $\\delta\\mathbf{u}_e$:\n$$\n\\delta\\mathbf{u}_e^T \\left( \\int_0^L \\mathbf{B}^T A E \\mathbf{B} \\, \\mathrm{d}x \\right) \\mathbf{u}_e = \\delta\\mathbf{u}_e^T \\left( \\int_0^L \\mathbf{N}^T A b \\, \\mathrm{d}x + \\mathbf{N}(L)^T A \\bar{t} \\right)\n$$\nSince this must hold for any arbitrary $\\delta\\mathbf{u}_e$, we obtain the element system of equations $K_e \\mathbf{u}_e = \\mathbf{f}_{\\mathrm{ext},e}$, where:\n$$\nK_e = \\int_0^L A E \\mathbf{B}^T \\mathbf{B} \\, \\mathrm{d}x \\quad \\text{and} \\quad \\mathbf{f}_{\\mathrm{ext},e} = \\int_0^L A b \\mathbf{N}^T \\, \\mathrm{d}x + A \\bar{t} \\mathbf{N}(L)^T\n$$\nWe now compute these integrals exactly. For the stiffness matrix $K_e$:\n$$\n\\mathbf{B}^T \\mathbf{B} = \\begin{bmatrix} -1/L \\\\ 1/L \\end{bmatrix} \\begin{bmatrix} -1/L  1/L \\end{bmatrix} = \\frac{1}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\nSince $A$, $E$, $L$ are constants, the integrand is constant:\n$$\nK_e = A E \\left( \\frac{1}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\right) \\int_0^L \\mathrm{d}x = \\frac{AE}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} L = \\frac{AE}{L} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\nFor the external force vector $\\mathbf{f}_{\\mathrm{ext},e}$, we compute the body force and traction components.\nThe body force vector $\\mathbf{f}_{b,e}$ is:\n$$\n\\mathbf{f}_{b,e} = \\int_0^L A b \\mathbf{N}^T \\, \\mathrm{d}x = A b \\int_0^L \\begin{bmatrix} 1 - x/L \\\\ x/L \\end{bmatrix} \\mathrm{d}x = Ab \\begin{bmatrix} [x - x^2/(2L)]_0^L \\\\ [x^2/(2L)]_0^L \\end{bmatrix} = Ab \\begin{bmatrix} L - L/2 \\\\ L/2 \\end{bmatrix} = \\frac{ALb}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nThe traction force vector $\\mathbf{f}_{t,e}$ is:\n$$\n\\mathbf{f}_{t,e} = A \\bar{t} \\mathbf{N}(L)^T = A \\bar{t} \\begin{bmatrix} N_1(L) \\\\ N_2(L) \\end{bmatrix} = A \\bar{t} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\nThe total external force vector is the sum:\n$$\n\\mathbf{f}_{\\mathrm{ext},e} = \\mathbf{f}_{b,e} + \\mathbf{f}_{t,e} = \\begin{bmatrix} \\frac{ALb}{2} \\\\ \\frac{ALb}{2} + A\\bar{t} \\end{bmatrix}\n$$\nFinally, we assemble the element potential energy functional $\\Pi_{e}(u_{1},u_{2})$, which is given by:\n$$\n\\Pi_{e}(u_{1},u_{2}) = \\frac{1}{2} \\mathbf{u}_e^T K_e \\mathbf{u}_e - \\mathbf{u}_e^T \\mathbf{f}_{\\mathrm{ext},e}\n$$\nSubstituting the derived matrices and vectors:\n$$\n\\Pi_{e}(u_1, u_2) = \\frac{1}{2} \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\left( \\frac{AE}{L} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\right) \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix} - \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\begin{bmatrix} \\frac{ALb}{2} \\\\ \\frac{ALb}{2} + A\\bar{t} \\end{bmatrix}\n$$\nWe evaluate the two terms separately. The first term (strain energy) is:\n$$\n\\frac{1}{2} \\mathbf{u}_e^T K_e \\mathbf{u}_e = \\frac{1}{2} \\frac{AE}{L} \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\begin{bmatrix} u_1 - u_2 \\\\ -u_1 + u_2 \\end{bmatrix} = \\frac{AE}{2L} (u_1(u_1 - u_2) + u_2(-u_1 + u_2)) = \\frac{AE}{2L} (u_1^2 - 2u_1u_2 + u_2^2) = \\frac{AE}{2L}(u_2 - u_1)^2\n$$\nThe second term (work potential of external forces) is:\n$$\n\\mathbf{u}_e^T \\mathbf{f}_{\\mathrm{ext},e} = u_1\\left(\\frac{ALb}{2}\\right) + u_2\\left(\\frac{ALb}{2} + A\\bar{t}\\right)\n$$\nCombining these results gives the final closed-form expression for the element potential energy:\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_2-u_1)^2 - \\left[ u_1 \\frac{ALb}{2} + u_2 \\left(\\frac{ALb}{2} + A\\bar{t}\\right) \\right]\n$$\nThis expression can be rewritten by distributing the terms:\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_2-u_1)^2 - \\frac{ALb}{2}(u_1+u_2) - A\\bar{t}u_2\n$$\nBoth forms are equivalent. The first form highlights the contribution from the derived force vector. We will present the final answer in expanded form for clarity.\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_1^2 - 2 u_1 u_2 + u_2^2) - \\frac{ALb}{2}u_1 - \\left(\\frac{ALb}{2} + A\\bar{t}\\right)u_2\n$$", "answer": "$$\n\\boxed{\\frac{AE}{2L}(u_2 - u_1)^2 - \\frac{ALb}{2}(u_1 + u_2) - A\\bar{t}u_2}\n$$", "id": "3501532"}, {"introduction": "The core of the assembly process is the \"scatter-add\" operation, where contributions from individual element matrices are mapped and summed into a single global matrix that represents the entire structure. This exercise provides a concrete example using a small two-element mesh, allowing you to practice the crucial bookkeeping required to map local degrees of freedom to their global counterparts [@problem_id:3501567]. Mastering this procedure is essential for understanding how a collection of disconnected element descriptions is transformed into a coherent system of equations.", "problem": "Consider a quasi-static small-strain linear elasticity problem in two spatial dimensions governed by the balance of linear momentum and the constitutive law for a linear elastic solid. The global linear system arises from the Galerkin weak form, where the element stiffness matrix is defined by the bilinear form involving the kinematic matrix and the elasticity tensor, and the element load vector is defined by the linear form involving the body force. The Finite Element Method (FEM) assembles the global stiffness matrix and load vector by summing contributions from each element via a scatter-add procedure based on the mesh connectivity.\n\nA small mesh consists of $4$ nodes connected by $2$ three-node triangular elements. Each node carries $2$ displacement degrees of freedom (DOF), the horizontal displacement $u_{x}$ and the vertical displacement $u_{y}$. The global DOFs are numbered so that node $i$ corresponds to global DOFs $\\left(2i-1,\\,2i\\right)$. The elements share an edge, with the following nodal connectivity:\n- Element $1$: nodes $\\left(1,\\,2,\\,3\\right)$,\n- Element $2$: nodes $\\left(2,\\,4,\\,3\\right)$.\n\nThe local DOF ordering for each element is $\\left(u_{x}(n_{1}),\\,u_{y}(n_{1}),\\,u_{x}(n_{2}),\\,u_{y}(n_{2}),\\,u_{x}(n_{3}),\\,u_{y}(n_{3})\\right)$, where $\\left(n_{1},\\,n_{2},\\,n_{3}\\right)$ are the element’s node labels.\n\nYou are given the following element stiffness matrices and element load vectors, already evaluated through appropriate numerical quadrature of the weak form integrals:\n$$\n\\mathbf{K}^{(1)} \\;=\\;\n\\begin{pmatrix}\n6  0  -3  0  -3  0 \\\\\n0  6  0  -3  0  -3 \\\\\n-3  0  6  0  -3  0 \\\\\n0  -3  0  6  0  -3 \\\\\n-3  0  -3  0  6  0 \\\\\n0  -3  0  -3  0  6\n\\end{pmatrix},\n\\quad\n\\mathbf{f}^{(1)} \\;=\\;\n\\begin{pmatrix}\n2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 3 \\\\ 2\n\\end{pmatrix},\n$$\n$$\n\\mathbf{K}^{(2)} \\;=\\;\n\\begin{pmatrix}\n7  0  -2  0  -5  0 \\\\\n0  7  0  -2  0  -5 \\\\\n-2  0  5  0  -3  0 \\\\\n0  -2  0  5  0  -3 \\\\\n-5  0  -3  0  8  0 \\\\\n0  -5  0  -3  0  8\n\\end{pmatrix},\n\\quad\n\\mathbf{f}^{(2)} \\;=\\;\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ -2 \\\\ 1 \\\\ 4 \\\\ -1\n\\end{pmatrix}.\n$$\n\nPerform the assembly of the global stiffness matrix $\\mathbf{K}$ of size $8 \\times 8$ and the global load vector $\\mathbf{f}$ of size $8$ by scatter-adding the element contributions according to the connectivity and DOF ordering provided. As part of your work, verify the row and column index pairs that define the nonzero pattern induced by each element’s connectivity and confirm the symmetry of the global stiffness matrix. Then, determine the single global stiffness entry $K_{7,5}$.\n\nReport only the numerical value of $K_{7,5}$ obtained after assembly. Express your final answer in kilo-Newton per meter $\\left(\\mathrm{kN/m}\\right)$. No rounding is required; provide the exact value.", "solution": "The problem requires the assembly of a global stiffness matrix, $\\mathbf{K}$, from element stiffness matrices, $\\mathbf{K}^{(e)}$, in the context of the Finite Element Method (FEM) for a two-dimensional linear elasticity problem. The specific task is to determine the value of the entry $K_{7,5}$ of the global matrix.\n\nThe assembly process is based on the principle of superposition. The global stiffness matrix $\\mathbf{K}$ is initialized as a zero matrix of the appropriate size. Then, for each element $e$, its local stiffness matrix $\\mathbf{K}^{(e)}$ is added to the corresponding entries in the global matrix. The mapping between local and global degrees of freedom (DOFs) dictates where each entry of $\\mathbf{K}^{(e)}$ is placed. The value of a global entry $K_{I,J}$ is the sum of contributions from all elements that are connected to both global DOF $I$ and global DOF $J$.\n$$ K_{I,J} = \\sum_{e} K_{g^{(e)}(i), g^{(e)}(j)}^{(e)} = \\sum_{e} K_{i,j}^{(e)} \\quad \\text{where } I=g^{(e)}(i) \\text{ and } J=g^{(e)}(j) $$\nHere, $g^{(e)}$ is the local-to-global DOF mapping vector for element $e$.\n\nFirst, we must establish the local-to-global DOF mapping for each of the two elements. The problem states that there are $4$ nodes in total, and each node has $2$ DOFs ($u_x, u_y$). The global DOFs for node $i$ are given by $(2i-1, 2i)$.\n- Node $1$: Global DOFs $(1, 2)$.\n- Node $2$: Global DOFs $(3, 4)$.\n- Node $3$: Global DOFs $(5, 6)$.\n- Node $4$: Global DOFs $(7, 8)$.\nThe total number of global DOFs is $2 \\times 4 = 8$, so the global stiffness matrix $\\mathbf{K}$ is of size $8 \\times 8$.\n\nThe local DOF ordering for a three-node element with nodes $(n_1, n_2, n_3)$ is given as $\\left(u_{x}(n_{1}),\\,u_{y}(n_{1}),\\,u_{x}(n_{2}),\\,u_{y}(n_{2}),\\,u_{x}(n_{3}),\\,u_{y}(n_{3})\\right)$, which correspond to local DOF indices $(1, 2, 3, 4, 5, 6)$.\n\nFor Element $1$, the connectivity is given as nodes $(1, 2, 3)$.\n- Local DOFs $1, 2$ (from node $1$) map to global DOFs $1, 2$.\n- Local DOFs $3, 4$ (from node $2$) map to global DOFs $3, 4$.\n- Local DOFs $5, 6$ (from node $3$) map to global DOFs $5, 6$.\nThe local-to-global mapping vector for Element $1$ is $g^{(1)} = (1, 2, 3, 4, 5, 6)$.\n\nFor Element $2$, the connectivity is given as nodes $(2, 4, 3)$.\n- Local DOFs $1, 2$ (from node $2$) map to global DOFs $3, 4$.\n- Local DOFs $3, 4$ (from node $4$) map to global DOFs $7, 8$.\n- Local DOFs $5, 6$ (from node $3$) map to global DOFs $5, 6$.\nThe local-to-global mapping vector for Element $2$ is $g^{(2)} = (3, 4, 7, 8, 5, 6)$.\n\nWe need to find the value of the global stiffness entry $K_{7,5}$. This is the sum of contributions from both elements:\n$$ K_{7,5} = K_{7,5}^{\\text{from (1)}} + K_{7,5}^{\\text{from (2)}} $$\n\nContribution from Element $1$:\nThe global DOFs associated with Element $1$ are $(1, 2, 3, 4, 5, 6)$ according to its mapping vector $g^{(1)}$. The global DOF $7$ is not associated with Element $1$. Therefore, Element $1$ makes no contribution to any entry in the $7$-th row or $7$-th column of the global matrix $\\mathbf{K}$.\n$$ K_{7,5}^{\\text{from (1)}} = 0 $$\n\nContribution from Element $2$:\nThe global DOFs associated with Element $2$ are $(3, 4, 7, 8, 5, 6)$ according to its mapping vector $g^{(2)}$. To find the contribution to $K_{7,5}$, we must identify the local indices $i$ and $j$ in Element $2$ that correspond to the global indices $I=7$ and $J=5$.\n- For the global row index $I=7$, we search for $7$ in the mapping vector $g^{(2)} = (3, 4, 7, 8, 5, 6)$. It is the $3$-rd entry. Thus, the local row index is $i=3$.\n- For the global column index $J=5$, we search for $5$ in the mapping vector $g^{(2)}$. It is the $5$-th entry. Thus, the local column index is $j=5$.\nThe contribution from Element $2$ is the entry $K_{i,j}^{(2)} = K_{3,5}^{(2)}$ from the element stiffness matrix $\\mathbf{K}^{(2)}$.\nGiven:\n$$ \\mathbf{K}^{(2)} \\;=\\;\n\\begin{pmatrix}\n7  0  -2  0  -5  0 \\\\\n0  7  0  -2  0  -5 \\\\\n-2  0  5  0  -3  0 \\\\\n0  -2  0  5  0  -3 \\\\\n-5  0  -3  0  8  0 \\\\\n0  -5  0  -3  0  8\n\\end{pmatrix}\n$$\nThe value at row $3$, column $5$ is $K_{3,5}^{(2)} = -3$.\nTherefore, $K_{7,5}^{\\text{from (2)}} = -3$.\n\nThe total value of $K_{7,5}$ is the sum of the contributions:\n$$ K_{7,5} = 0 + (-3) = -3 $$\n\nAs a verification of the method and to confirm the symmetry of the assembled matrix, we can compute the entry $K_{5,7}$.\n$$ K_{5,7} = K_{5,7}^{\\text{from (1)}} + K_{5,7}^{\\text{from (2)}} $$\nThe contribution from Element $1$ is again $0$, as global DOF $7$ is not in its map.\nFor the contribution from Element $2$, we find the local indices corresponding to global indices $I=5$ and $J=7$.\n- For $I=5$, we find $5$ in $g^{(2)} = (3, 4, 7, 8, 5, 6)$ at the $5$-th position, so local row index is $i=5$.\n- For $J=7$, we find $7$ in $g^{(2)}$ at the $3$-rd position, so local column index is $j=3$.\nThe contribution is $K_{5,3}^{(2)}$. From the matrix $\\mathbf{K}^{(2)}$, the value is $K_{5,3}^{(2)} = -3$.\nSo, $K_{5,7} = 0 + (-3) = -3$.\nSince $K_{7,5} = K_{5,7} = -3$, the assembled matrix is symmetric for this pair of indices, which is consistent with the fact that the element stiffness matrices are symmetric and the assembly operation preserves symmetry.\n\nThe problem asks for the final answer to be expressed in kilo-Newton per meter $(\\mathrm{kN/m})$. The numerical values for the stiffness matrices are provided without units. It is assumed that these values are already in the desired units of $\\mathrm{kN/m}$.\n\nThus, the numerical value of the global stiffness entry $K_{7,5}$ is $-3$.", "answer": "$$ \\boxed{-3} $$", "id": "3501567"}, {"introduction": "An assembled global system is rarely ready to be solved directly, as it typically needs to be modified to incorporate physical or kinematic constraints. This advanced practice explores two powerful techniques—the elimination and penalty methods—for enforcing Multi-Point Constraints (MPCs) on a pre-existing system [@problem_id:3501515]. Working through this problem will illuminate how the algebraic structure of the global equations is altered to ensure the solution adheres to specified relationships between degrees of freedom.", "problem": "A linear elastic discrete system arising from the Finite Element Method (FEM) discretization of a small-strain geomechanics problem is modeled at the global level by the symmetric positive definite (SPD) stiffness matrix $K \\in \\mathbb{R}^{3 \\times 3}$ and the global force vector $f \\in \\mathbb{R}^{3}$ given by\n$$\nK \\;=\\; \\begin{bmatrix}\n10  -2  0\\\\\n-2  5  -1\\\\\n0  -1  3\n\\end{bmatrix}, \n\\qquad\nf \\;=\\; \\begin{bmatrix}\n1\\\\\n0\\\\\n0\n\\end{bmatrix}.\n$$\nLet the global displacement vector be $u = [\\,u_{1},\\,u_{2},\\,u_{3}\\,]^{\\mathsf{T}}$. A Multi-Point Constraint (MPC) is to be enforced that ties the two displacement degrees of freedom (DOFs) $u_{2}$ and $u_{3}$ via $u_{2} - u_{3} = 0$.\n\nUsing only fundamental variational principles (principle of minimum potential energy) and without resorting to any shortcut formulas, perform the following.\n\n1. Starting from the unconstrained total potential energy \n$$\n\\Pi(u) \\;=\\; \\tfrac{1}{2}\\,u^{\\mathsf{T}} K\\, u \\;-\\; f^{\\mathsf{T}}u,\n$$\nwrite down the stationarity condition and the corresponding unconstrained linear system.\n\n2. Enforce the MPC $u_{2} - u_{3} = 0$ using the elimination approach. Do this by introducing a reduced vector $\\hat{u} \\in \\mathbb{R}^{2}$ and a transformation $u = T\\,\\hat{u}$ that satisfies the MPC identically. Assemble the reduced system by explicit transformation of $K$ and $f$, and solve the reduced system for $\\hat{u}$. Report the resulting constrained solution $u^{\\mathrm{elim}}$.\n\n3. Enforce the MPC using a penalty formulation by augmenting the total potential energy with a quadratic penalty term of the form \n$$\n\\frac{\\gamma}{2}\\,\\big(u_{2} - u_{3}\\big)^{2},\n$$\nwhere $\\gamma  0$ is the penalty parameter. Derive the modified stationarity condition and the corresponding penalized linear system, and then solve this system symbolically to obtain the first component $u_{1}(\\gamma)$ as a closed-form function of $\\gamma$.\n\n4. Briefly compare, in terms of assembly and operator properties, how the elimination and penalty approaches modify the global system matrix (e.g., size, sparsity pattern, symmetry, and positive definiteness), referring to the specific matrices obtained in this problem.\n\nYour final answer must be the closed-form analytic expression for $u_{1}(\\gamma)$ from the penalty method in item $3$. Express the final result as a simplified rational function of $\\gamma$. No numerical rounding is required, and no units are needed in the final expression.", "solution": "The problem is analyzed in four parts as requested, starting from the principle of minimum potential energy.\n\n1. Starting from the unconstrained total potential energy \n$$\n\\Pi(u) \\;=\\; \\tfrac{1}{2}\\,u^{\\mathsf{T}} K\\, u \\;-\\; f^{\\mathsf{T}}u,\n$$\nthe equilibrium configuration is found where the potential energy is stationary. The stationarity condition requires the first variation of $\\Pi(u)$ with respect to the displacement vector $u$ to be zero, which is equivalent to setting the gradient of $\\Pi(u)$ with respect to $u$ to zero:\n$$\n\\frac{\\partial \\Pi}{\\partial u} = 0.\n$$\nUsing the symmetry of the stiffness matrix $K$, the gradient is computed as:\n$$\n\\frac{\\partial \\Pi}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( \\frac{1}{2} u^{\\mathsf{T}} K u \\right) - \\frac{\\partial}{\\partial u} \\left( f^{\\mathsf{T}} u \\right) = K u - f.\n$$\nSetting the gradient to zero gives the stationarity condition, which is the unconstrained global linear system of equations:\n$$\nK u = f.\n$$\n\n2. The Multi-Point Constraint (MPC) $u_{2} - u_{3} = 0$, or $u_{2} = u_{3}$, is enforced using the elimination approach. We select a reduced set of independent degrees of freedom (DOFs). Let the independent DOFs be $u_{1}$ and $u_{2}$, and let $u_{3}$ be the dependent DOF. The reduced displacement vector is $\\hat{u} \\in \\mathbb{R}^{2}$, defined as $\\hat{u} = [\\,u_{1}, u_{2}\\,]^{\\mathsf{T}}$. The original displacement vector $u$ can be expressed in terms of $\\hat{u}$ via a transformation matrix $T$:\n$$\nu = \\begin{bmatrix} u_{1} \\\\ u_{2} \\\\ u_{3} \\end{bmatrix} = \\begin{bmatrix} u_{1} \\\\ u_{2} \\\\ u_{2} \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix} = T \\hat{u}.\n$$\nSubstituting $u=T\\hat{u}$ into the potential energy expression yields the reduced potential energy $\\Pi(\\hat{u})$:\n$$\n\\Pi(\\hat{u}) = \\frac{1}{2} (T\\hat{u})^{\\mathsf{T}} K (T\\hat{u}) - f^{\\mathsf{T}} (T\\hat{u}) = \\frac{1}{2}\\hat{u}^{\\mathsf{T}} (T^{\\mathsf{T}} K T) \\hat{u} - (T^{\\mathsf{T}} f)^{\\mathsf{T}} \\hat{u}.\n$$\nThis corresponds to a reduced system $\\hat{K}\\hat{u} = \\hat{f}$, with $\\hat{K} = T^{\\mathsf{T}} K T$ and $\\hat{f} = T^{\\mathsf{T}} f$. We compute the reduced matrix and vector:\n$$\n\\hat{K} = T^{\\mathsf{T}} K T = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 10  -2  0\\\\ -2  5  -1\\\\ 0  -1  3 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 10  -2 \\\\ -2  6 \\end{bmatrix}.\n$$\n$$\n\\hat{f} = T^{\\mathsf{T}} f = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\nThe reduced system is:\n$$\n\\begin{bmatrix} 10  -2 \\\\ -2  6 \\end{bmatrix} \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\nFrom the second equation, $-2u_{1} + 6u_{2} = 0$, we find $u_{1} = 3u_{2}$. Substituting this into the first equation gives $10(3u_{2}) - 2u_{2} = 1$, which simplifies to $28u_{2} = 1$, so $u_{2} = \\frac{1}{28}$. Consequently, $u_{1} = 3(\\frac{1}{28}) = \\frac{3}{28}$. The solution for the reduced system is $\\hat{u} = [\\,\\frac{3}{28}, \\frac{1}{28}\\,]^{\\mathsf{T}}$. The full constrained solution $u^{\\mathrm{elim}}$ is found by back-substituting:\n$$\nu^{\\mathrm{elim}} = T\\hat{u} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 3/28 \\\\ 1/28 \\end{bmatrix} = \\begin{bmatrix} 3/28 \\\\ 1/28 \\\\ 1/28 \\end{bmatrix}.\n$$\n\n3. For the penalty formulation, the total potential energy is augmented with a penalty term:\n$$\n\\Pi_{\\gamma}(u) = \\Pi(u) + \\frac{\\gamma}{2}(u_{2} - u_{3})^{2} = \\frac{1}{2}u^{\\mathsf{T}} K u - f^{\\mathsf{T}}u + \\frac{\\gamma}{2} (u_{2} - u_{3})^{2},\n$$\nwhere $\\gamma  0$. The penalty term can be expressed in a quadratic matrix form, $\\frac{1}{2} u^{\\mathsf{T}} (\\gamma K_p) u$, where $K_p = \\begin{bmatrix} 0  0  0 \\\\ 0  1  -1 \\\\ 0  -1  1 \\end{bmatrix}$. The augmented energy is:\n$$\n\\Pi_{\\gamma}(u) = \\frac{1}{2}u^{\\mathsf{T}}(K + \\gamma K_p)u - f^{\\mathsf{T}}u.\n$$\nThe stationarity condition $\\frac{\\partial \\Pi_{\\gamma}}{\\partial u} = 0$ leads to the penalized linear system $(K+\\gamma K_p)u(\\gamma) = f$. The penalized stiffness matrix $K_{\\gamma} = K + \\gamma K_p$ is:\n$$\nK_{\\gamma} = \\begin{bmatrix} 10  -2  0\\\\ -2  5  -1\\\\ 0  -1  3 \\end{bmatrix} + \\gamma \\begin{bmatrix} 0  0  0 \\\\ 0  1  -1 \\\\ 0  -1  1 \\end{bmatrix} = \\begin{bmatrix} 10  -2  0 \\\\ -2  5+\\gamma  -1-\\gamma \\\\ 0  -1-\\gamma  3+\\gamma \\end{bmatrix}.\n$$\nThe system to solve is:\n$$\n\\begin{bmatrix} 10  -2  0 \\\\ -2  5+\\gamma  -1-\\gamma \\\\ 0  -1-\\gamma  3+\\gamma \\end{bmatrix} \\begin{bmatrix} u_{1} \\\\ u_{2} \\\\ u_{3} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\nWe solve for $u_{1}(\\gamma)$ using Cramer's rule: $u_{1}(\\gamma) = \\frac{\\det(K_{\\gamma,1})}{\\det(K_{\\gamma})}$. The determinant of $K_{\\gamma}$ is:\n$$\n\\det(K_{\\gamma}) = 10\\big((5+\\gamma)(3+\\gamma) - (-1-\\gamma)^{2}\\big) - (-2)\\big((-2)(3+\\gamma)\\big)\n$$\n$$\n= 10\\big(15+8\\gamma+\\gamma^{2} - (1+2\\gamma+\\gamma^{2})\\big) -4(3+\\gamma) = 10(14+6\\gamma) - 12 - 4\\gamma = 128 + 56\\gamma.\n$$\nThe matrix $K_{\\gamma,1}$ is formed by replacing the first column of $K_{\\gamma}$ with $f$:\n$$\nK_{\\gamma,1} = \\begin{bmatrix} 1  -2  0 \\\\ 0  5+\\gamma  -1-\\gamma \\\\ 0  -1-\\gamma  3+\\gamma \\end{bmatrix}.\n$$\nIts determinant is $\\det(K_{\\gamma,1}) = 1 \\cdot \\big((5+\\gamma)(3+\\gamma) - (-1-\\gamma)^{2}\\big) = 14+6\\gamma$.\nThus, the expression for $u_{1}(\\gamma)$ is:\n$$\nu_{1}(\\gamma) = \\frac{14+6\\gamma}{128+56\\gamma} = \\frac{2(7+3\\gamma)}{8(16+7\\gamma)} = \\frac{7+3\\gamma}{4(16+7\\gamma)} = \\frac{3\\gamma+7}{28\\gamma+64}.\n$$\n\n4. The elimination and penalty approaches modify the global system matrix in distinct ways.\n\n**Elimination Approach**:\n- **Size**: The system size is reduced. In this problem, the $3 \\times 3$ matrix $K$ is transformed into the $2 \\times 2$ matrix $\\hat{K}$.\n- **Assembly**: This method requires a non-trivial symbolic manipulation to define the transformation $T$ and then performs matrix multiplications to obtain the reduced system, which can be complex for intricate constraints.\n- **Sparsity**: The original sparsity pattern is not necessarily preserved. In this case, $\\hat{K} = \\begin{bmatrix} 10  -2 \\\\ -2  6 \\end{bmatrix}$ is a dense matrix, and the structure of $K$ is lost.\n- **Symmetry and Positive Definiteness**: These properties are preserved. Since $K$ is symmetric and positive definite (SPD), $\\hat{K} = T^{\\mathsf{T}} K T$ is also SPD. The constraint is satisfied exactly.\n\n**Penalty Approach**:\n- **Size**: The system size remains unchanged ($3 \\times 3$). The penalized matrix is $K_{\\gamma} = \\begin{bmatrix} 10  -2  0 \\\\ -2  5+\\gamma  -1-\\gamma \\\\ 0  -1-\\gamma  3+\\gamma \\end{bmatrix}$.\n- **Assembly**: The process is straightforward, involving only the addition of the scaled penalty matrix $\\gamma K_p$ to $K$. This is a significant advantage in terms of implementation simplicity.\n- **Sparsity**: The sparsity pattern can be altered. In this specific problem, the locations of non-zero entries in $K_p$ already correspond to non-zero entries in $K$, so the sparsity pattern of $K_{\\gamma}$ is identical to that of $K$.\n- **Symmetry and Positive Definiteness**: These properties are preserved. $K_{\\gamma}$ is SPD for $\\gamma  0$. However, as $\\gamma \\to \\infty$, the condition number of $K_{\\gamma}$ also tends to infinity, which can cause severe numerical difficulties for solvers. The constraint is met only approximately, with an error that decreases as $\\gamma$ increases.", "answer": "$$\n\\boxed{\\frac{3\\gamma+7}{28\\gamma+64}}\n$$", "id": "3501515"}]}