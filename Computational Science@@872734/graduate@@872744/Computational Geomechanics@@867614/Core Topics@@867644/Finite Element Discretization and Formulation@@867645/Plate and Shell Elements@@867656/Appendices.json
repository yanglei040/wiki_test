{"hands_on_practices": [{"introduction": "Before we can model the complex bending of plates, we must have a solid grasp of what \"bending\" fundamentally means. This exercise provides a crucial conceptual check by connecting the mathematical definition of curvature in Kirchhoff-Love theory to the physical behavior of a plate. By analyzing a simple linear displacement field, you will demonstrate why rigid-body motions, such as tilting, do not induce any curvature or internal stresses, reinforcing the core principles of deformation [@problem_id:3551389].", "problem": "Consider a thin, homogeneous rectangular plate occupying the planar domain $\\Omega = [0,L_{x}] \\times [0,L_{y}]$ with Cartesian coordinates $(x,y)$, thickness $h$, and mid-surface transverse displacement field $w(x,y)$. Assume the kinematics of the Kirchhoff–Love theory for thin plates: normals to the mid-surface remain straight, normal to the mid-surface, and inextensible, and all strains and rotations are small. Let the deflection field be linear, $w(x,y) = a x + b y$, where $a$ and $b$ are constant slopes with respect to $x$ and $y$, respectively. Using only the Kirchhoff–Love assumptions and small-strain kinematics, derive the bending curvatures $\\kappa_{xx}$, $\\kappa_{yy}$, and $\\kappa_{xy}$ associated with the mid-surface. Determine their explicit values for the given $w(x,y)$, and state which curvatures vanish and why under these kinematics. Express the final numerical values in units of inverse meters.", "solution": "The user wants me to solve the problem by following these steps:\n1.  First, validate the problem statement.\n2.  If it is valid, provide a complete and reasoned solution using LaTeX for all mathematical entities.\n3.  If it is invalid, explain the flaws and terminate.\n\n### Step 1: Extract Givens\n-   **Domain**: A thin, homogeneous rectangular plate in the plane $\\Omega = [0,L_{x}] \\times [0,L_{y}]$.\n-   **Coordinates**: Cartesian coordinates $(x,y)$.\n-   **Thickness**: $h$.\n-   **Mid-surface transverse displacement**: $w(x,y)$.\n-   **Governing Theory**: Kirchhoff–Love theory for thin plates.\n-   **Kinematic Assumptions**:\n    1.  Normals to the mid-surface remain straight.\n    2.  Normals to the mid-surface remain normal to the mid-surface.\n    3.  Normals to the mid-surface are inextensible.\n    4.  All strains and rotations are small.\n-   **Specified Displacement Field**: $w(x,y) = a x + b y$, where $a$ and $b$ are constants.\n-   **Task**:\n    1.  Derive the bending curvatures $\\kappa_{xx}$, $\\kappa_{yy}$, and $\\kappa_{xy}$ based on the given theory.\n    2.  Determine their explicit values for the given $w(x,y)$.\n    3.  Explain which curvatures vanish and why.\n    4.  Express the final values in units of inverse meters.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the classical and well-established Kirchhoff–Love plate theory, a fundamental concept in structural mechanics. The assumptions and definitions are standard. The problem is scientifically sound.\n-   **Well-Posed**: The problem provides a specific displacement field and asks for the corresponding curvatures using a standard theory. The definitions within the theory are unambiguous, leading to a unique solution.\n-   **Objective**: The problem is stated in precise, mathematical language, free of subjective or opinion-based claims.\n-   **Incompleteness/Contradiction**: The problem is self-contained. While it asks for \"numerical values\" and to express them in units, it does not provide numerical values for the constants $a$ and $b$. This is not a fatal flaw. The \"explicit values\" can be correctly interpreted as the expressions that result from applying the formulas to the given function, which in this case are constant numbers (zero). The value of zero is unit-independent, so the instruction regarding units can still be addressed.\n-   **Other Flaws**: The problem might appear trivial because the linear displacement field leads to zero curvatures. However, it explicitly requires a derivation from first principles (\"Using only the Kirchhoff–Love assumptions\") and an explanation. This structure tests the fundamental understanding of how curvatures are defined and what they physically represent, rather than being a simple calculation. It is a valid conceptual problem.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard exercise in the mechanics of plates. I will now proceed with the solution.\n\n### Solution Derivation\n\nThe problem requires the derivation of the curvature components for a thin plate under the Kirchhoff–Love assumptions and then their evaluation for a specific linear displacement field.\n\n**1. General Derivation of Curvatures from Kinematics**\n\nThe Kirchhoff–Love theory describes the kinematics of a thin plate. Let the Cartesian coordinates be $(x, y, z)$, where the $x$-$y$ plane coincides with the plate's mid-surface before deformation, and the $z$-axis is normal to it. The displacement of any point in the plate is described by the displacement of the corresponding point on the mid-surface.\n\nThe core assumptions are that lines normal to the mid-surface before deformation remain straight, normal to the deformed mid-surface, and do not change in length. For small rotations, the displacement vector $\\mathbf{v} = (v_x, v_y, v_z)$ for a point at an initial position $(x, y, z)$ can be expressed in terms of the mid-surface displacements. Let the mid-surface displacement in the $z$-direction be $w(x,y)$, and let the in-plane displacements of the mid-surface be $u(x,y)$ and $v(x,y)$. Under the Kirchhoff-Love assumptions and considering only bending effects (ignoring $u$ and $v$ as they relate to membrane action, which is uncoupled from pure bending in linear theory), the displacement components are:\n$$\nv_x(x,y,z) = -z \\frac{\\partial w(x,y)}{\\partial x}\n$$\n$$\nv_y(x,y,z) = -z \\frac{\\partial w(x,y)}{\\partial y}\n$$\n$$\nv_z(x,y,z) = w(x,y)\n$$\nThese equations state that a plane section perpendicular to the mid-surface rotates by angles equal to the slopes of the deflected mid-surface.\n\nThe components of the linear strain tensor $\\epsilon$ are given by the partial derivatives of the displacement vector. We are interested in the in-plane strains $\\epsilon_{xx}$, $\\epsilon_{yy}$, and the shear strain $\\gamma_{xy} = 2\\epsilon_{xy}$.\n$$\n\\epsilon_{xx} = \\frac{\\partial v_x}{\\partial x} = \\frac{\\partial}{\\partial x} \\left(-z \\frac{\\partial w}{\\partial x}\\right) = -z \\frac{\\partial^2 w}{\\partial x^2}\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial v_y}{\\partial y} = \\frac{\\partial}{\\partial y} \\left(-z \\frac{\\partial w}{\\partial y}\\right) = -z \\frac{\\partial^2 w}{\\partial y^2}\n$$\nThe engineering shear strain is:\n$$\n\\gamma_{xy} = \\frac{\\partial v_x}{\\partial y} + \\frac{\\partial v_y}{\\partial x} = \\frac{\\partial}{\\partial y} \\left(-z \\frac{\\partial w}{\\partial x}\\right) + \\frac{\\partial}{\\partial x} \\left(-z \\frac{\\partial w}{\\partial y}\\right) = -z \\frac{\\partial^2 w}{\\partial y \\partial x} - z \\frac{\\partial^2 w}{\\partial x \\partial y}\n$$\nAssuming $w(x,y)$ is sufficiently smooth, the order of differentiation does not matter (Clairaut's theorem), so $\\frac{\\partial^2 w}{\\partial y \\partial x} = \\frac{\\partial^2 w}{\\partial x \\partial y}$.\n$$\n\\gamma_{xy} = -2z \\frac{\\partial^2 w}{\\partial x \\partial y}\n$$\nThese strain components vary linearly through the thickness of the plate (i.e., with $z$). The curvature of the plate is defined by the terms that determine this linear variation. The standard definitions for the bending curvature ($\\kappa_{xx}$, $\\kappa_{yy}$) and twisting curvature ($\\kappa_{xy}$) are:\n$$\n\\kappa_{xx} = -\\frac{\\partial^2 w}{\\partial x^2}\n$$\n$$\n\\kappa_{yy} = -\\frac{\\partial^2 w}{\\partial y^2}\n$$\n$$\n\\kappa_{xy} = -\\frac{\\partial^2 w}{\\partial x \\partial y}\n$$\nThis sign convention is common in structural mechanics. Using these definitions, the strains can be written compactly as $\\epsilon_{xx} = z \\kappa_{xx}$, $\\epsilon_{yy} = z \\kappa_{yy}$, and $\\gamma_{xy} = 2z \\kappa_{xy}$.\n\n**2. Evaluation for the Given Displacement Field**\n\nThe problem provides a linear transverse displacement field:\n$$\nw(x,y) = ax + by\n$$\nwhere $a$ and $b$ are specified as constant slopes. To find the curvatures, we must compute the second partial derivatives of this function.\n\nFirst, we compute the first partial derivatives (the slopes):\n$$\n\\frac{\\partial w}{\\partial x} = \\frac{\\partial}{\\partial x}(ax + by) = a\n$$\n$$\n\\frac{\\partial w}{\\partial y} = \\frac{\\partial}{\\partial y}(ax + by) = b\n$$\nNext, we compute the second partial derivatives:\n$$\n\\frac{\\partial^2 w}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial w}{\\partial x} \\right) = \\frac{\\partial}{\\partial x}(a) = 0\n$$\nSince $a$ is a constant, its derivative with respect to $x$ is zero.\n$$\n\\frac{\\partial^2 w}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left( \\frac{\\partial w}{\\partial y} \\right) = \\frac{\\partial}{\\partial y}(b) = 0\n$$\nSince $b$ is a constant, its derivative with respect to $y$ is zero.\n$$\n\\frac{\\partial^2 w}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial w}{\\partial y} \\right) = \\frac{\\partial}{\\partial x}(b) = 0\n$$\nSince $b$ is a constant, its derivative with respect to $x$ is zero.\n\nNow, we substitute these results into the expressions for curvature:\n$$\n\\kappa_{xx} = -\\frac{\\partial^2 w}{\\partial x^2} = -0 = 0\n$$\n$$\n\\kappa_{yy} = -\\frac{\\partial^2 w}{\\partial y^2} = -0 = 0\n$$\n$$\n\\kappa_{xy} = -\\frac{\\partial^2 w}{\\partial x \\partial y} = -0 = 0\n$$\n\n**3. Explanation for Vanishing Curvatures**\n\nAll three curvature components, $\\kappa_{xx}$, $\\kappa_{yy}$, and $\\kappa_{xy}$, are identically zero for the given displacement field. The reason is both mathematical and physical.\n\n*   **Mathematical Reason**: As derived above, the curvatures in Kirchhoff–Love plate theory are directly proportional to the second partial derivatives of the transverse displacement field, $w(x,y)$. The given field, $w(x,y) = ax + by$, is a linear function of the coordinates $x$ and $y$. The second derivative of any linear function is always zero.\n\n*   **Physical Reason**: The curvature of a surface measures its deviation from being flat. A displacement field of the form $w(x,y) = ax + by$ describes a surface that is a plane. Geometrically, this means the initially flat plate is simply tilted or rotated as a rigid body, without any bending or twisting. For example, $w=ax$ represents a rigid rotation about the $y$-axis by a small angle $a$, and $w=by$ represents a rigid rotation about the $x$-axis by a small angle $-b$. The superposition of these two is also a rigid rotation about an axis in the $x-y$ plane. Rigid-body motions do not induce any internal strains or stresses, and therefore, they do not cause any deformation-related curvatures. Bending and twisting inherently require the surface to be curved, which is only possible if the displacement field $w(x,y)$ contains terms of order two or higher (e.g., $x^2$, $y^2$, $xy$). Since the given field is purely linear, no part of the plate is bent or twisted, and all curvatures must be zero.\n\nThe problem asks for the values in units of inverse meters. Since all values are exactly $0$, they can be written as $0 \\text{ m}^{-1}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}}\n$$", "id": "3551389"}, {"introduction": "Translating continuous physical theories into discrete computational models is the essence of the Finite Element Method. For thin plates governed by Kirchhoff-Love theory, ensuring that adjacent elements connect smoothly ($C^1$ continuity) is a primary challenge that dictates the element's design. This practice guides you through the construction of the required interpolation functions, starting from a 1D beam and extending the logic to a 2D plate, revealing why specific rotational degrees of freedom are essential for a conforming plate element [@problem_id:3551396].", "problem": "Consider a small-deflection Euler–Bernoulli beam and a thin plate modeled under the Kirchhoff–Love assumptions, both within the Finite Element Method (FEM) framework in computational geomechanics. \n\nPart A (beam): Let a single straight $2$-node Euler–Bernoulli beam element of length $L$ be parameterized by the parent coordinate $\\xi \\in [-1,1]$ via the isoparametric mapping $x = x_{c} + \\frac{L}{2}\\,\\xi$, where $x_{c}$ is the element center. The kinematic assumption relates the cross-section rotation to slope, $\\theta = \\frac{\\mathrm{d}w}{\\mathrm{d}x}$, where $w(x)$ is the transverse displacement. Seek a cubic Hermite interpolation for $w(\\xi)$ of the form\n$$\nw(\\xi) = N_{1}(\\xi)\\,w_{1} + N_{2}(\\xi)\\,L\\,\\theta_{1} + N_{3}(\\xi)\\,w_{2} + N_{4}(\\xi)\\,L\\,\\theta_{2},\n$$\nwith nodal degrees of freedom $w_{1}$, $\\theta_{1}$ at $\\xi=-1$ and $w_{2}$, $\\theta_{2}$ at $\\xi=+1$. Enforce the interpolation conditions for $C^{1}$ continuity in the physical coordinate $x$: exact nodal values $w(-1)=w_{1}$, $w(1)=w_{2}$ and exact nodal slopes $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=-1}=\\theta_{1}$, $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=1}=\\theta_{2}$, taking into account the chain rule $\\frac{\\mathrm{d}}{\\mathrm{d}x}=\\frac{2}{L}\\frac{\\mathrm{d}}{\\mathrm{d}\\xi}$. Starting from these principles, construct the cubic Hermite shape functions $N_{1}(\\xi)$, $N_{2}(\\xi)$, $N_{3}(\\xi)$, and $N_{4}(\\xi)$ as explicit polynomials in $\\xi$.\n\nPart B (plate): For a rectangular thin plate element under Kirchhoff–Love theory, the bending strains depend on second derivatives of the transverse displacement field $w(x,y)$, specifically $\\kappa_{xx} = -\\frac{\\partial^{2} w}{\\partial x^{2}}$, $\\kappa_{yy} = -\\frac{\\partial^{2} w}{\\partial y^{2}}$, and $\\kappa_{xy} = -\\frac{\\partial^{2} w}{\\partial x \\partial y}$. To achieve $C^{1}$ continuity across inter-element boundaries, the displacement $w$ and its first derivatives must be continuous along shared edges. Using a tensor-product rationale consistent with the Hermite cubic construction in Part A, deduce the minimal nodal parameter set required at each corner node of a $4$-node rectangular plate element to ensure $C^{1}$ continuity and bicubic completeness, and state the number of degrees of freedom per node.\n\nExpress your final answer as the row matrix of the four shape functions $N_{1}(\\xi)$, $N_{2}(\\xi)$, $N_{3}(\\xi)$, $N_{4}(\\xi)$ followed by the number of degrees of freedom per node for the plate element. No rounding is needed.", "solution": "This problem consists of two parts. Part A requires the explicit construction of cubic Hermite shape functions for a 2-node Euler-Bernoulli beam element. Part B requires the deduction of the nodal degrees of freedom for a $C^{1}$-continuous rectangular Kirchhoff-Love plate element.\n\n### Part A: Beam Element Shape Functions\n\nThe transverse displacement field $w(\\xi)$ is interpolated using four cubic Hermite shape functions $N_{i}(\\xi)$ over the parent domain $\\xi \\in [-1, 1]$. The interpolation is given as:\n$$w(\\xi) = N_{1}(\\xi)w_{1} + N_{2}(\\xi)L\\theta_{1} + N_{3}(\\xi)w_{2} + N_{4}(\\xi)L\\theta_{2}$$\nwhere $\\{w_{1}, \\theta_{1}\\}$ are the displacement and rotation at node $1$ ($\\xi=-1$) and $\\{w_{2}, \\theta_{2}\\}$ are the displacement and rotation at node $2$ ($\\xi=1$). The length of the element is $L$.\n\nThe problem states the enforcement of four conditions corresponding to the nodal degrees of freedom:\n1.  $w(-1) = w_{1}$\n2.  $w(1) = w_{2}$\n3.  $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=-1} = \\theta_{1}$\n4.  $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=1} = \\theta_{2}$\n\nThe relationship between derivatives in the physical coordinate $x$ and the parent coordinate $\\xi$ is given by the chain rule and the isoparametric mapping $x = x_{c} + \\frac{L}{2}\\xi$:\n$$\\frac{\\mathrm{d}}{\\mathrm{d}x} = \\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} = \\frac{2}{L} \\frac{\\mathrm{d}}{\\mathrm{d}\\xi}$$\nApplying this, the slope conditions become:\n3. $\\frac{2}{L} \\left.\\frac{\\mathrm{d}w}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = \\theta_{1}$\n4. $\\frac{2}{L} \\left.\\frac{\\mathrm{d}w}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = \\theta_{2}$\n\nBy substituting the interpolation expression for $w(\\xi)$ into these four conditions and requiring them to hold for arbitrary nodal values $\\{w_{1}, \\theta_{1}, w_{2}, \\theta_{2}\\}$, we obtain the conditions that each shape function $N_{i}(\\xi)$ must satisfy. Each $N_{i}(\\xi)$ is a cubic polynomial of the form $a\\xi^3+b\\xi^2+c\\xi+d$.\n\n**For $N_1(\\xi)$:**\nThis function is associated with $w_{1}$. Setting $w_{1}=1$ and all other DOFs to zero gives $w(\\xi)=N_1(\\xi)$.\n1.  $N_{1}(-1) = 1$\n2.  $N_{1}(1) = 0$\n3.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}\\xi}\\right|_{\\xi=-1}=0 \\implies N_{1}'(-1)=0$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}\\xi}\\right|_{\\xi=1}=0 \\implies N_{1}'(1)=0$\n\n**For $N_2(\\xi)$:**\nThis function is associated with $L\\theta_{1}$. Setting $L\\theta_{1}=1$ (i.e., $\\theta_1=1/L$) and all other DOFs to zero gives $w(\\xi)=N_2(\\xi)$.\n1.  $N_{2}(-1) = 0$\n2.  $N_{2}(1) = 0$\n3.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = \\frac{1}{L} \\implies N_{2}'(-1) = \\frac{1}{2}$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = 0 \\implies N_{2}'(1) = 0$\n\n**For $N_3(\\xi)$:**\nThis function is associated with $w_{2}$.\n1.  $N_{3}(-1) = 0$\n2.  $N_{3}(1) = 1$\n3.  $N_{3}'(-1) = 0$\n4.  $N_{3}'(1) = 0$\n\n**For $N_4(\\xi)$:**\nThis function is associated with $L\\theta_{2}$.\n1.  $N_{4}(-1) = 0$\n2.  $N_{4}(1) = 0$\n3.  $N_{4}'(-1) = 0$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{4}}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = \\frac{1}{L} \\implies N_{4}'(1) = \\frac{1}{2}$\n\nWe now solve for the polynomial coefficients for each shape function.\nLet $N(\\xi) = a\\xi^{3} + b\\xi^{2} + c\\xi + d$. Then $N'(\\xi) = 3a\\xi^{2} + 2b\\xi + c$.\n\n**Derivation of $N_{1}(\\xi)$:** The conditions yield the system:\n1.  $-a + b - c + d = 1$\n2.  $a + b + c + d = 0$\n3.  $3a - 2b + c = 0$\n4.  $3a + 2b + c = 0$\nFrom (3) and (4), $4b=0 \\implies b=0$, which gives $c=-3a$. From (1) and (2), $2b+2d=1 \\implies d=1/2$, and $2a+2c=-1$. Substituting $c=-3a$ yields $2a-6a=-1 \\implies -4a=-1 \\implies a=1/4$. Thus, $c=-3/4$.\nSo, $N_{1}(\\xi) = \\frac{1}{4}\\xi^{3} - \\frac{3}{4}\\xi + \\frac{1}{2}$.\n\n**Derivation of $N_{3}(\\xi)$:** From the conditions, we can observe that $N_{3}(\\xi)$ is related to $N_{1}(\\xi)$ by the transformation $\\xi \\to -\\xi$. Thus, $N_{3}(\\xi) = N_{1}(-\\xi)$.\n$N_{3}(\\xi) = \\frac{1}{4}(-\\xi)^{3} - \\frac{3}{4}(-\\xi) + \\frac{1}{2} = -\\frac{1}{4}\\xi^{3} + \\frac{3}{4}\\xi + \\frac{1}{2}$.\n\n**Derivation of $N_{2}(\\xi)$:** The conditions yield the system:\n1.  $-a + b - c + d = 0$\n2.  $a + b + c + d = 0$\n3.  $3a - 2b + c = 1/2$\n4.  $3a + 2b + c = 0$\nFrom (1) and (2), $b+d=0 \\implies d=-b$ and $a+c=0 \\implies c=-a$. Substituting into (3) and (4):\n3. $3a-2b-a = 1/2 \\implies 2a-2b=1/2$\n4. $3a+2b-a = 0 \\implies 2a+2b=0 \\implies a=-b$.\nSubstituting $a=-b$ into $2a-2b=1/2$ gives $2(-b)-2b=1/2 \\implies -4b=1/2 \\implies b=-1/8$. Then $a=1/8$, $c=-1/8$, and $d=1/8$.\nSo, $N_{2}(\\xi) = \\frac{1}{8}\\xi^{3} - \\frac{1}{8}\\xi^{2} - \\frac{1}{8}\\xi + \\frac{1}{8}$.\n\n**Derivation of $N_{4}(\\xi)$:** The conditions on $N_{4}(\\xi)$ can be related to those on $N_{2}(\\xi)$. Let $g(\\xi) = -N_{2}(-\\xi)$. Then $g(-1) = -N_{2}(1) = 0$, $g(1) = -N_{2}(-1) = 0$. The derivative is $g'(\\xi) = -(-1)N_{2}'(-\\xi) = N_{2}'(-\\xi)$. So $g'(-1) = N_{2}'(1) = 0$ and $g'(1) = N_{2}'(-1) = 1/2$. These are precisely the conditions for $N_{4}(\\xi)$. Thus, $N_{4}(\\xi) = -N_{2}(-\\xi)$.\n$N_{4}(\\xi) = -(\\frac{1}{8}(-\\xi)^{3} - \\frac{1}{8}(-\\xi)^{2} - \\frac{1}{8}(-\\xi) + \\frac{1}{8}) = -(-\\frac{1}{8}\\xi^{3} - \\frac{1}{8}\\xi^{2} + \\frac{1}{8}\\xi + \\frac{1}{8}) = \\frac{1}{8}\\xi^{3} + \\frac{1}{8}\\xi^{2} - \\frac{1}{8}\\xi - \\frac{1}{8}$.\n\nThe four shape functions as explicit polynomials in $\\xi$ are:\n$N_{1}(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{3}{4}\\xi + \\frac{1}{2}$\n$N_{2}(\\xi) = \\frac{1}{8}\\xi^3 - \\frac{1}{8}\\xi^2 - \\frac{1}{8}\\xi + \\frac{1}{8}$\n$N_{3}(\\xi) = -\\frac{1}{4}\\xi^3 + \\frac{3}{4}\\xi + \\frac{1}{2}$\n$N_{4}(\\xi) = \\frac{1}{8}\\xi^3 + \\frac{1}{8}\\xi^2 - \\frac{1}{8}\\xi - \\frac{1}{8}$\n\n### Part B: Plate Element Degrees of Freedom\n\nFor a thin plate governed by Kirchhoff-Love theory, the strain energy involves second derivatives of the transverse displacement $w(x, y)$. To formulate a conforming (or $C^{1}$-continuous) finite element, both the displacement $w$ and its normal derivative $\\frac{\\partial w}{\\partial n}$ must be continuous across inter-element boundaries. For a rectangular element with sides parallel to the $x$ and $y$ axes, this implies that $w$, $\\frac{\\partial w}{\\partial x}$, and $\\frac{\\partial w}{\\partial y}$ must be continuous across element edges.\n\nThe problem suggests a tensor-product construction based on the 1D Hermite cubics from Part A. The 1D interpolation guarantees continuity of value and first derivative at the nodes. Extending this to 2D via a tensor product results in a bicubic polynomial space for $w(x, y)$, which can be expressed in parent coordinates $(\\xi, \\eta)$ as:\n$$w(\\xi, \\eta) = \\sum_{i=0}^{3} \\sum_{j=0}^{3} c_{ij} \\xi^{i} \\eta^{j}$$\nThis polynomial has $16$ coefficients, so the element must have a total of $16$ degrees of freedom (DOFs). For a $4$-node rectangular element, this requires $16/4 = 4$ DOFs per node.\n\nWe must deduce the specific set of nodal parameters (DOFs) that ensures $C^{1}$ continuity. Let's analyze the continuity along an edge, for example, an edge where $\\eta = \\text{constant}$.\n1.  **Continuity of $w$**: Along this edge, $w$ is a cubic polynomial in $\\xi$. A cubic polynomial is uniquely determined by four parameters. To ensure its continuity is solely dependent on the two nodes on that edge, we can specify the value $w$ and the tangential slope $\\frac{\\partial w}{\\partial \\xi}$ at each of the two nodes. This accounts for $2+2=4$ parameters. So, $w$ and $\\frac{\\partial w}{\\partial x}$ (which is proportional to $\\frac{\\partial w}{\\partial \\xi}$) must be nodal DOFs.\n2.  **Continuity of the normal derivative $\\frac{\\partial w}{\\partial \\eta}$**: Along the same edge, $\\frac{\\partial w}{\\partial \\eta}$ is also a cubic polynomial in $\\xi$. To define it uniquely by the DOFs of the two nodes on the edge, we can again specify its value and its tangential derivative at each node. The required parameters are $\\frac{\\partial w}{\\partial \\eta}$ and $\\frac{\\partial}{\\partial \\xi}(\\frac{\\partial w}{\\partial \\eta}) = \\frac{\\partial^{2} w}{\\partial \\xi \\partial \\eta}$ at each of the two nodes.\n\nCombining the requirements from analyzing edges parallel to both axes, the minimal set of nodal parameters at each corner node to ensure full $C^{1}$ continuity of a bicubic field is:\n1.  The displacement: $w$\n2.  The slope about the $y$-axis: $\\frac{\\partial w}{\\partial x}$\n3.  The slope about the $x$-axis: $\\frac{\\partial w}{\\partial y}$\n4.  The mixed partial derivative (twist): $\\frac{\\partial^{2} w}{\\partial x \\partial y}$\n\nThis set comprises four parameters. Thus, the number of degrees of freedom per node is $4$. This set allows for unique definition of the cubic variation of both $w$ and its normal derivative along any edge, based only on the parameters at the edge's two endpoints, thereby guaranteeing inter-element $C^{1}$ continuity.\n\nThe number of degrees of freedom per node for the plate element is $4$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} - \\frac{3}{4}\\xi + \\frac{1}{4}\\xi^3 & \\frac{1}{8} - \\frac{1}{8}\\xi - \\frac{1}{8}\\xi^2 + \\frac{1}{8}\\xi^3 & \\frac{1}{2} + \\frac{3}{4}\\xi - \\frac{1}{4}\\xi^3 & -\\frac{1}{8} - \\frac{1}{8}\\xi + \\frac{1}{8}\\xi^2 + \\frac{1}{8}\\xi^3 & 4 \\end{pmatrix}}\n$$", "id": "3551396"}, {"introduction": "While classical thin plate theory requires complex $C^1$ elements, many modern codes use simpler $C^0$ elements based on Reissner-Mindlin theory, which introduces a notorious numerical pathology known as \"shear locking.\" This hands-on numerical experiment challenges you to implement a benchmark test to diagnose this issue, where an element becomes artificially stiff and yields inaccurate results, especially for thin plates. You will compare a locking-prone element with one stabilized by selective reduced integration, a widely used technique, to gain practical insight into element behavior and validation [@problem_id:3551332].", "problem": "You are asked to design and implement a self-contained numerical benchmark that exposes shear locking in Reissner–Mindlin plate elements for soil-like materials by driving the effective shear stiffness to zero while resting on a soft Winkler foundation. Starting from the principle of virtual work, discretize the governing equations for a clamped, uniformly loaded square plate using bilinear quadrilateral elements and compare two element families whose only difference is the treatment of the transverse shear terms: full Gauss integration versus selective reduced integration. Quantify the locking by the ratio of central deflection between the two formulations over a sweep of shear-modulus scaling parameters and mesh densities.\n\nThe fundamental starting point must be the following. The Reissner–Mindlin plate kinematics assume a transverse displacement field $w(x,y)$ and independent rotations $\\theta_x(x,y)$ and $\\theta_y(x,y)$. The curvature strains are $\\kappa_x = \\partial \\theta_x / \\partial x$, $\\kappa_y = \\partial \\theta_y / \\partial y$, and $\\kappa_{xy} = \\partial \\theta_x / \\partial y + \\partial \\theta_y / \\partial x$. The transverse shear strains are $\\gamma_{xz} = \\theta_x + \\partial w / \\partial x$ and $\\gamma_{yz} = \\theta_y + \\partial w / \\partial y$. The strain energy density is a sum of bending and shear contributions, and the potential of a Winkler foundation with stiffness $k$ adds a local penalty on $w$. The virtual work statement equates the internal virtual work to the external virtual work from a uniform load $q$.\n\nYou must discretize this problem using bilinear quadrilateral ($\\mathrm{Q}4$) isoparametric elements on a structured mesh over a square domain of side length $L$. Use a clamped boundary condition ($w=\\theta_x=\\theta_y=0$) on all edges. Construct the element bending stiffness by integrating the curvature terms with the exact same quadrature across all formulations. Construct the element shear stiffness in two different ways:\n- Formulation A (Full): integrate the shear energy with a standard $2\\times 2$ Gauss rule.\n- Formulation B (Selective Reduced Integration, SRI): integrate the shear energy with a single Gauss point at the element center.\n\nKeep the bending stiffness unchanged between A and B so that only the shear treatment differs.\n\nTo model soil-like behavior, introduce a scalar factor $\\alpha \\in (0,1]$ that scales the effective shear modulus as $G_{\\mathrm{eff}} = \\alpha \\, G_0$, where $G_0$ is the shear modulus computed from Young’s modulus $E$ and Poisson’s ratio $\\nu$ through $G_0 = E / (2(1+\\nu))$. The bending stiffness must remain tied to $E$ and $\\nu$ without scaling, while the shear stiffness uses $G_{\\mathrm{eff}}$. This separation mimics a material with bending rigidity controlled by $E$ and $\\nu$ but with independently tunable transverse shear softness, which is a standard device in Reissner–Mindlin benchmarking.\n\nStart from the virtual work principle and the standard isoparametric finite element method to derive your element matrices. Do not use any shortcut formulas for Mindlin elements. Carry the Winkler foundation contribution by adding a consistent $w$–$w$ stiffness term at the element level. Assemble the global system, apply clamped boundary conditions on all boundary nodes, and solve the linear system to obtain nodal values of $w$, $\\theta_x$, and $\\theta_y$.\n\nUse the following physically plausible and self-consistent parameters and units, and keep them fixed for all test cases unless explicitly varied:\n- Geometry: square plate with side length $L = 1\\,\\mathrm{m}$ and thickness $t = 0.01\\,\\mathrm{m}$.\n- Material for bending: Young’s modulus $E = 30\\times 10^9\\,\\mathrm{Pa}$ and Poisson’s ratio $\\nu = 0.3$.\n- Shear correction factor: $\\kappa_s = 5/6$ applied to the shear stiffness.\n- Uniform transverse load: $q = 1000\\,\\mathrm{N/m^2}$, applied over the entire plate.\n- Winkler foundation: stiffness $k = 1000\\,\\mathrm{N/m^3}$ (soft foundation).\n- Angle quantities are not directly requested; there is no angle unit to report.\n- All displacements that appear internally must be in $\\mathrm{m}$, loads in $\\mathrm{N/m^2}$, stiffnesses in appropriate SI units as consistent above.\n\nDefine the locking indicator for each test case as the ratio\n$$\nR = \\frac{w_{\\mathrm{center}}^{\\mathrm{Full}}}{w_{\\mathrm{center}}^{\\mathrm{SRI}}},\n$$\nwhere $w_{\\mathrm{center}}^{\\mathrm{Full}}$ and $w_{\\mathrm{center}}^{\\mathrm{SRI}}$ are the computed transverse displacements at the geometric center of the plate for Formulations A and B, respectively. Interpret $R<1$ as an underprediction due to shear locking in the fully integrated shear formulation relative to the selective reduced integration formulation.\n\nYour program must implement the above and evaluate the following test suite of parameter combinations, chosen to exercise a normal case, a near-shear-free limit, and mesh sensitivity under a soft Winkler foundation:\n- Case $1$: $(\\alpha, n_x, n_y) = (1.0, 4, 4)$.\n- Case $2$: $(\\alpha, n_x, n_y) = (10^{-3}, 4, 4)$.\n- Case $3$: $(\\alpha, n_x, n_y) = (10^{-6}, 4, 4)$.\n- Case $4$: $(\\alpha, n_x, n_y) = (1.0, 2, 2)$.\n- Case $5$: $(\\alpha, n_x, n_y) = (10^{-6}, 2, 2)$.\n- Case $6$: $(\\alpha, n_x, n_y) = (10^{-6}, 8, 8)$.\n\nHere, $n_x$ and $n_y$ are the number of elements in the $x$ and $y$ directions, respectively. For each case, compute the single scalar $R$ as defined above. The final output from your program must be a single line containing all six $R$ values as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5,r_6]$. Each $r_i$ is a floating-point number without units. No other text must be printed.\n\nNote: All mathematical symbols and numbers inside this statement are given in the International System of Units (SI), and any requested outputs are dimensionless ratios, so no unit conversion is required for the final results.", "solution": "The user's problem statement is critically evaluated as a mandatory prerequisite.\n\n### Step 1: Extract Givens\n- **Problem Domain**: A square plate of side length $L = 1\\,\\mathrm{m}$ and thickness $t = 0.01\\,\\mathrm{m}$, resting on a Winkler foundation of stiffness $k = 1000\\,\\mathrm{N/m^3}$.\n- **Material Properties**: Young’s modulus $E = 30\\times 10^9\\,\\mathrm{Pa}$, Poisson’s ratio $\\nu = 0.3$.\n- **Loading**: Uniformly distributed transverse load $q = 1000\\,\\mathrm{N/m^2}$.\n- **Boundary Conditions**: Clamped on all four edges ($w = \\theta_x = \\theta_y = 0$).\n- **Kinematic Theory**: Reissner–Mindlin plate theory.\n  - Displacement fields: $w(x,y)$, $\\theta_x(x,y)$, $\\theta_y(x,y)$.\n  - Curvature strains: $\\kappa_x = \\partial \\theta_x / \\partial x$, $\\kappa_y = \\partial \\theta_y / \\partial y$, $\\kappa_{xy} = \\partial \\theta_x / \\partial y + \\partial \\theta_y / \\partial x$.\n  - Transverse shear strains: $\\gamma_{xz} = \\theta_x + \\partial w / \\partial x$, $\\gamma_{yz} = \\theta_y + \\partial w / \\partial y$.\n- **Finite Element Model**:\n  - Element type: Bilinear quadrilateral ($\\mathrm{Q}4$) isoparametric elements.\n  - Meshes: Structured grids of $n_x \\times n_y$ elements.\n- **Shear Modeling**:\n  - Shear correction factor: $\\kappa_s = 5/6$.\n  - Effective shear modulus: $G_{\\mathrm{eff}} = \\alpha \\, G_0$, where $G_0 = E / (2(1+\\nu))$ and $\\alpha \\in (0,1]$.\n- **Formulations for Comparison**:\n  - Bending stiffness: Integrated using a $2\\times 2$ Gauss rule in all cases.\n  - Formulation A (Full): Shear stiffness integrated using a $2\\times 2$ Gauss rule.\n  - Formulation B (SRI): Shear stiffness integrated using a single ($1\\times 1$) Gauss point.\n- **Locking Indicator**: $R = w_{\\mathrm{center}}^{\\mathrm{Full}} / w_{\\mathrm{center}}^{\\mathrm{SRI}}$, the ratio of central transverse deflections.\n- **Test Cases**:\n  - Case 1: $(\\alpha, n_x, n_y) = (1.0, 4, 4)$.\n  - Case 2: $(\\alpha, n_x, n_y) = (10^{-3}, 4, 4)$.\n  - Case 3: $(\\alpha, n_x, n_y) = (10^{-6}, 4, 4)$.\n  - Case 4: $(\\alpha, n_x, n_y) = (1.0, 2, 2)$.\n  - Case 5: $(\\alpha, n_x, n_y) = (10^{-6}, 2, 2)$.\n  - Case 6: $(\\alpha, n_x, n_y) = (10^{-6}, 8, 8)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is firmly rooted in the theory of elasticity and computational solid mechanics. Reissner-Mindlin plate theory, the finite element method, and the concept of shear locking are all standard, well-established topics.\n- **Well-Posed**: The problem describes a static analysis of a plate with well-defined geometry, material properties, loading, and boundary conditions. This constitutes a standard boundary value problem that admits a unique solution.\n- **Objective**: All parameters and procedures are specified quantitatively and unambiguously. The goal is to compute a numerical ratio, which is an objective measure.\n- **Completeness and Consistency**: The problem is self-contained. All constants and governing equations required for the derivation and implementation are provided. The units (SI) are consistent throughout.\n- **Feasibility and Realism**: The specified parameters are physically plausible. The task of implementing this FEM benchmark is computationally feasible. The use of the parameter $\\alpha$ to induce shear locking is a standard technique in numerical analysis of plate elements.\n- **Structure and Triviality**: The problem is well-structured and non-trivial. It requires a correct derivation from the principle of virtual work and a careful implementation of the finite element method, including numerical quadrature, matrix assembly, and application of boundary conditions.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is a well-posed, scientifically sound, and complete problem in computational mechanics. A solution will be provided.\n\n### Principle-Based Derivation and Solution Methodology\n\nThe solution is derived from the principle of virtual work, which states that for a body in equilibrium, the internal virtual work equals the external virtual work for any kinematically admissible virtual displacement. For the given system, this is expressed as:\n$$\n\\delta U_b + \\delta U_s + \\delta U_w = \\delta W_{ext}\n$$\nwhere $\\delta U_b$ is the virtual work of bending, $\\delta U_s$ is the virtual work of transverse shear, $\\delta U_w$ is the virtual work done on the Winkler foundation, and $\\delta W_{ext}$ is the virtual work of the external load.\n\nThe individual terms are:\n$$\n\\delta U_b = \\int_A \\delta\\boldsymbol{\\kappa}^T \\mathbf{M} \\, dA \\quad , \\quad \\delta U_s = \\int_A \\delta\\boldsymbol{\\gamma}^T \\mathbf{Q} \\, dA \\quad , \\quad \\delta U_w = \\int_A \\delta w \\, (k w) \\, dA \\quad , \\quad \\delta W_{ext} = \\int_A \\delta w \\, q \\, dA\n$$\nHere, $\\boldsymbol{\\kappa} = [\\kappa_x, \\kappa_y, \\kappa_{xy}]^T$ is the vector of curvatures, $\\boldsymbol{\\gamma} = [\\gamma_{xz}, \\gamma_{yz}]^T$ is the vector of transverse shear strains, $\\mathbf{M}$ is the vector of bending moments, $\\mathbf{Q}$ is the vector of shear forces, $k$ is the Winkler stiffness, and $q$ is the distributed load.\n\nThe constitutive relations for an isotropic material are $\\mathbf{M} = \\mathbf{C}_b \\boldsymbol{\\kappa}$ and $\\mathbf{Q} = \\mathbf{C}_s \\boldsymbol{\\gamma}$.\nThe bending rigidity matrix $\\mathbf{C}_b$ is:\n$$\n\\mathbf{C}_b = \\frac{E t^3}{12(1-\\nu^2)} \\begin{pmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{pmatrix}\n$$\nThe shear rigidity matrix $\\mathbf{C}_s$ is:\n$$\n\\mathbf{C}_s = \\kappa_s G_{\\mathrm{eff}} t \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\kappa_s \\left( \\alpha \\frac{E}{2(1+\\nu)} \\right) t \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe factor $\\alpha$ directly scales the shear stiffness, allowing the simulation of thin-plate behavior (where shear locking is prominent) as $\\alpha \\to 0$.\n\nWe discretize the domain using bilinear quadrilateral ($\\mathrm{Q}4$) elements. Within each element, the displacement and rotation fields are interpolated from the nodal degrees of freedom $\\mathbf{d}^e = [w_1, \\theta_{x1}, \\theta_{y1}, \\dots, w_4, \\theta_{x4}, \\theta_{y4}]^T$ using isoparametric shape functions $N_i(\\xi, \\eta)$:\n$$\nw(\\xi, \\eta) = \\sum_{i=1}^{4} N_i w_i \\quad , \\quad \\theta_x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i \\theta_{xi} \\quad , \\quad \\theta_y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i \\theta_{yi}\n$$\nwhere $(\\xi, \\eta)$ are the natural coordinates of the element. The shape function for node $i$ is $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i \\xi)(1+\\eta_i \\eta)$.\n\nThe strain fields are related to the nodal DOFs through strain-displacement matrices, $\\mathbf{B}_b$ and $\\mathbf{B}_s$:\n$$\n\\boldsymbol{\\kappa} = \\mathbf{B}_b \\mathbf{d}^e \\quad , \\quad \\boldsymbol{\\gamma} = \\mathbf{B}_s \\mathbf{d}^e\n$$\nAnd the transverse displacement is interpolated as $w = \\mathbf{N}_w \\mathbf{d}^e$. The matrices $\\mathbf{B}_b$ and $\\mathbf{B}_s$ contain spatial derivatives of the shape functions. These derivatives are computed with respect to the global coordinates $(x,y)$ using the Jacobian of the isoparametric mapping.\n\nSubstituting the discretized fields into the principle of virtual work yields the element-level system of equations. For an arbitrary virtual displacement $(\\delta \\mathbf{d}^e)^T$, we obtain the element stiffness matrix $\\mathbf{k}^e$ and force vector $\\mathbf{f}^e$:\n$$\n(\\mathbf{k}_b^e + \\mathbf{k}_s^e + \\mathbf{k}_w^e) \\mathbf{d}^e = \\mathbf{f}^e\n$$\nThe individual element stiffness matrices are computed by numerical integration over the element domain $A^e$:\n$$\n\\mathbf{k}_b^e = \\int_{A^e} \\mathbf{B}_b^T \\mathbf{C}_b \\mathbf{B}_b \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}_b^T \\mathbf{C}_b \\mathbf{B}_b \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\n$$\n\\mathbf{k}_s^e = \\int_{A^e} \\mathbf{B}_s^T \\mathbf{C}_s \\mathbf{B}_s \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}_s^T \\mathbf{C}_s \\mathbf{B}_s \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\n$$\n\\mathbf{k}_w^e = \\int_{A^e} k \\mathbf{N}_w^T \\mathbf{N}_w \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} k \\mathbf{N}_w^T \\mathbf{N}_w \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\nThe element force vector is:\n$$\n\\mathbf{f}^e = \\int_{A^e} q \\mathbf{N}_w^T \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} q \\mathbf{N}_w^T \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\nThe core of the benchmark lies in the numerical quadrature used for $\\mathbf{k}_s^e$. For both formulations, $\\mathbf{k}_b^e$, $\\mathbf{k}_w^e$, and $\\mathbf{f}^e$ are computed with a standard $2\\times 2$ Gauss quadrature rule.\n- **Formulation A (Full Integration)**: $\\mathbf{k}_s^e$ is computed using a $2\\times 2$ Gauss quadrature rule. This rule over-constrains the element in the thin-plate limit, leading to shear locking.\n- **Formulation B (Selective Reduced Integration - SRI)**: $\\mathbf{k}_s^e$ is computed using a single Gauss point ($1\\times 1$ rule) at the element center ($\\xi=0, \\eta=0$). This softens the shear response and alleviates locking.\n\nThe element matrices and vectors are assembled into a global system of linear equations $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$. Clamped boundary conditions ($w=\\theta_x=\\theta_y=0$) are enforced for all nodes on the plate's perimeter by eliminating the corresponding rows and columns from the global system. The resulting reduced system is solved for the unknown nodal displacements and rotations $\\mathbf{d}$.\n\nFinally, the transverse displacement $w_{\\mathrm{center}}$ at the geometric center of the plate is identified. Since all specified meshes ($2\\times 2$, $4\\times 4$, $8\\times 8$) have an even number of elements, the plate's center coincides with a node. The locking indicator $R$ is computed for each test case by running the simulation for both Formulation A and Formulation B and taking the ratio of the central deflections, $R = w_{\\mathrm{center}}^{\\mathrm{Full}} / w_{\\mathrm{center}}^{\\mathrm{SRI}}$. A value of $R < 1$ indicates the presence of shear locking in the fully integrated element, as its artificially high stiffness results in a smaller predicted displacement.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main solver function to execute the benchmark for Reissner-Mindlin plates.\n    It iterates through a set of predefined test cases, computes the locking\n    indicator for each, and prints the results in the specified format.\n    \"\"\"\n\n    # Define physical and geometric parameters as per the problem statement.\n    L = 1.0  # m\n    t = 0.01  # m\n    E = 30e9  # Pa\n    nu = 0.3  # Poisson's ratio\n    kappa_s = 5.0 / 6.0  # Shear correction factor\n    q_load = 1000.0  # N/m^2\n    k_winkler = 1000.0  # N/m^3\n\n    params = {\n        'L': L, 't': t, 'E': E, 'nu': nu, 'kappa_s': kappa_s, \n        'q': q_load, 'k': k_winkler\n    }\n\n    # Test cases: (alpha, nx, ny)\n    test_cases = [\n        (1.0, 4, 4),\n        (1e-3, 4, 4),\n        (1e-6, 4, 4),\n        (1.0, 2, 2),\n        (1e-6, 2, 2),\n        (1e-6, 8, 8),\n    ]\n\n    results = []\n    for alpha, nx, ny in test_cases:\n        # Run simulation for Formulation A (Full Integration)\n        w_center_full = run_fem_analysis(nx, ny, alpha, 'full', params)\n        # Run simulation for Formulation B (Selective Reduced Integration)\n        w_center_sri = run_fem_analysis(nx, ny, alpha, 'sri', params)\n\n        if w_center_sri == 0:\n            locking_ratio = np.nan # Avoid division by zero\n        else:\n            # The problem text implies w is positive down, but solvers often give negative.\n            # Ratios of displacements are the same regardless of sign convention.\n            locking_ratio = w_center_full / w_center_sri\n        results.append(locking_ratio)\n\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\n\ndef run_fem_analysis(nx, ny, alpha, shear_integration_rule, params):\n    \"\"\"\n    Performs a single Finite Element Analysis for a given mesh, alpha, and integration rule.\n    \n    Args:\n        nx (int): Number of elements in the x-direction.\n        ny (int): Number of elements in the y-direction.\n        alpha (float): Scaling factor for the effective shear modulus.\n        shear_integration_rule (str): 'full' for 2x2 or 'sri' for 1x1 Gauss quadrature.\n        params (dict): Dictionary of physical and geometric parameters.\n    \n    Returns:\n        float: The transverse displacement 'w' at the center of the plate.\n    \"\"\"\n    # Unpack parameters\n    L, t, E, nu, kappa_s, q, k_winkler = params['L'], params['t'], params['E'], params['nu'], params['kappa_s'], params['q'], params['k']\n\n    # --- Mesh Generation ---\n    num_nodes_x = nx + 1\n    num_nodes_y = ny + 1\n    num_nodes = num_nodes_x * num_nodes_y\n    num_dofs = 3 * num_nodes\n    hx, hy = L / nx, L / ny\n\n    node_coords = np.zeros((num_nodes, 2))\n    for i in range(num_nodes_y):\n        for j in range(num_nodes_x):\n            node_idx = i * num_nodes_x + j\n            node_coords[node_idx] = [j * hx, i * hy]\n\n    elements = np.zeros((nx * ny, 4), dtype=int)\n    for i in range(ny):\n        for j in range(nx):\n            el_idx = i * nx + j\n            n1 = i * num_nodes_x + j\n            n2 = i * num_nodes_x + j + 1\n            n3 = (i + 1) * num_nodes_x + j + 1\n            n4 = (i + 1) * num_nodes_x + j\n            elements[el_idx] = [n1, n2, n3, n4]\n\n    # --- Constitutive Matrices ---\n    # Bending\n    C_b = (E * t**3) / (12 * (1 - nu**2)) * np.array([\n        [1, nu, 0],\n        [nu, 1, 0],\n        [0, 0, (1 - nu) / 2]\n    ])\n    # Shear\n    G_eff = alpha * E / (2 * (1 + nu))\n    C_s = kappa_s * G_eff * t * np.identity(2)\n\n    # --- Gauss Quadrature Points and Weights ---\n    gauss_pts_1d = { 1: [(0.0, 2.0)], 2: [(-1/np.sqrt(3), 1.0), (1/np.sqrt(3), 1.0)] }\n\n    # --- FEM Assembly ---\n    K_global = np.zeros((num_dofs, num_dofs))\n    F_global = np.zeros(num_dofs)\n\n    # Nodal coordinates for a unit square element [-1,1] x [-1,1]\n    xi_eta_nodes = np.array([[-1, -1], [1, -1], [1, 1], [-1, 1]])\n\n    for el_nodes in elements:\n        k_elem = np.zeros((12, 12))\n        f_elem = np.zeros(12)\n\n        det_J = hx * hy / 4.0\n\n        # Function to get shape functions and their derivatives in natural coords\n        def shape_functions(xi, eta):\n            N = 0.25 * (1 + xi_eta_nodes[:, 0] * xi) * (1 + xi_eta_nodes[:, 1] * eta)\n            dNdxi = 0.25 * xi_eta_nodes[:, 0] * (1 + xi_eta_nodes[:, 1] * eta)\n            dNdeta = 0.25 * xi_eta_nodes[:, 1] * (1 + xi_eta_nodes[:, 0] * xi)\n            return N, dNdxi, dNdeta\n\n        # --- Bending, Winkler, and Force contributions (always 2x2 integration) ---\n        n_gp_full = 2\n        for xi_gp, w_xi in gauss_pts_1d[n_gp_full]:\n            for eta_gp, w_eta in gauss_pts_1d[n_gp_full]:\n                N, dNdxi, dNdeta = shape_functions(xi_gp, eta_gp)\n                \n                # Derivatives w.r.t x, y for rectangular element\n                dNdx = dNdxi * (2.0 / hx)\n                dNdy = dNdeta * (2.0 / hy)\n\n                B_b = np.zeros((3, 12))\n                N_w = np.zeros((1, 12))\n                for i in range(4):\n                    B_b[0, 3 * i + 1] = dNdx[i]\n                    B_b[1, 3 * i + 2] = dNdy[i]\n                    B_b[2, 3 * i + 1] = dNdy[i]\n                    B_b[2, 3 * i + 2] = dNdx[i]\n                    f_elem[3 * i] += N[i] * q * det_J * w_xi * w_eta\n                    N_w[0, 3 * i] = N[i]\n\n                k_elem += B_b.T @ C_b @ B_b * det_J * w_xi * w_eta\n                k_elem += k_winkler * N_w.T @ N_w * det_J * w_xi * w_eta\n        \n        # --- Shear contribution (full or SRI) ---\n        n_gp_shear = 2 if shear_integration_rule == 'full' else 1\n        for xi_gp, w_xi in gauss_pts_1d[n_gp_shear]:\n            for eta_gp, w_eta in gauss_pts_1d[n_gp_shear]:\n                N, dNdxi, dNdeta = shape_functions(xi_gp, eta_gp)\n                dNdx = dNdxi * (2.0 / hx)\n                dNdy = dNdeta * (2.0 / hy)\n                \n                B_s = np.zeros((2, 12))\n                for i in range(4):\n                    B_s[0, 3 * i] = dNdx[i]\n                    B_s[0, 3 * i + 1] = N[i]\n                    B_s[1, 3 * i] = dNdy[i]\n                    B_s[1, 3 * i + 2] = N[i]\n                \n                k_elem += B_s.T @ C_s @ B_s * det_J * w_xi * w_eta\n\n        # Assemble into global matrices\n        dof_map = np.array([3*n for n in el_nodes]).reshape(-1,1) + np.arange(3)\n        dof_map = dof_map.flatten()\n        K_global[np.ix_(dof_map, dof_map)] += k_elem\n        F_global[dof_map] += f_elem\n\n    # --- Apply Boundary Conditions (Clamped) ---\n    boundary_nodes = []\n    for i in range(num_nodes_y):\n        for j in range(num_nodes_x):\n            if i == 0 or i == num_nodes_y - 1 or j == 0 or j == num_nodes_x - 1:\n                boundary_nodes.append(i * num_nodes_x + j)\n    \n    boundary_dofs = []\n    for node_idx in boundary_nodes:\n        boundary_dofs.extend([3 * node_idx, 3 * node_idx + 1, 3 * node_idx + 2])\n    \n    all_dofs = np.arange(num_dofs)\n    free_dofs = np.setdiff1d(all_dofs, boundary_dofs)\n\n    K_reduced = K_global[np.ix_(free_dofs, free_dofs)]\n    F_reduced = F_global[free_dofs]\n\n    # --- Solve System and Extract Result ---\n    try:\n        sol_reduced = linalg.solve(K_reduced, F_reduced)\n    except linalg.LinAlgError:\n        return np.nan # Return NaN if system is singular\n\n    d_global = np.zeros(num_dofs)\n    d_global[free_dofs] = sol_reduced\n    \n    # Find central node displacement 'w'\n    # For even nx, ny, center is at a node.\n    center_node_idx_x = nx // 2\n    center_node_idx_y = ny // 2\n    center_node_global_idx = center_node_idx_y * num_nodes_x + center_node_idx_x\n    center_w_dof_idx = 3 * center_node_global_idx\n    \n    w_center = d_global[center_w_dof_idx]\n    \n    return w_center\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3551332"}]}