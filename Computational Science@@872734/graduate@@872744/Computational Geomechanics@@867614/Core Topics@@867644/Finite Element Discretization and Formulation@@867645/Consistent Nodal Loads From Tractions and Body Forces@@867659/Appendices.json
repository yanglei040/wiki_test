{"hands_on_practices": [{"introduction": "Before diving into complex calculations, it is crucial to ensure our fundamental equations make physical sense. This first practice provides a vital sanity check by using dimensional analysis to verify that the mathematical expressions for consistent nodal loads, such as $\\int_{\\Omega_e} \\boldsymbol{N}^{T}\\boldsymbol{b}\\,d\\Omega$, indeed result in units of force. This exercise reinforces the physical meaning of terms like body force and traction and confirms that the principle of virtual work is dimensionally consistent, grounding the numerical method in physical reality.", "problem": "Consider a three-dimensional, small-strain solid discretized by the Finite Element Method (FEM). Let the element external nodal load vector be denoted by $\\boldsymbol{f}_e \\in \\mathbb{R}^{n_e}$, where $n_e$ is the number of nodal degrees of freedom for the element. The consistent contributions to $\\boldsymbol{f}_e$ from body force density and prescribed tractions are represented by the volume and surface integrals of the interpolated fields, in which the interpolation is performed by the element shape functions collected in the matrix $\\boldsymbol{N}(\\boldsymbol{x})$. Assume that the shape functions satisfy partition of unity and have no physical units. Let $\\boldsymbol{b}(\\boldsymbol{x})$ denote the body force per unit volume, and $\\boldsymbol{t}(\\boldsymbol{x})$ denote the traction (force per unit area) prescribed on the portion $\\Gamma_t$ of the element boundary. The element domain is $\\Omega_e \\subset \\mathbb{R}^3$. Let the element nodal displacement vector be $\\boldsymbol{d}_e \\in \\mathbb{R}^{n_e}$, with entries having the dimension of length.\n\nStarting from the principle of virtual work for external forces, which states that the virtual work equals the product of virtual nodal displacements and the element nodal force vector, i.e., $\\delta W_{\\mathrm{ext},e} = \\delta \\boldsymbol{d}_e^{T}\\,\\boldsymbol{f}_e$, and using only:\n- the fact that $\\boldsymbol{N}$ is constructed from dimensionless shape functions,\n- the definitions that $\\boldsymbol{b}$ is force per unit volume and $\\boldsymbol{t}$ is force per unit area,\n- the geometric measures $d\\Omega$ (volume) and $d\\Gamma$ (area),\n\nperform a dimensional consistency check of the expressions $\\int_{\\Omega_e} \\boldsymbol{N}^{T}\\,\\boldsymbol{b}\\,d\\Omega$ and $\\int_{\\Gamma_t} \\boldsymbol{N}^{T}\\,\\boldsymbol{t}\\,d\\Gamma$ as contributors to $\\boldsymbol{f}_e$. Confirm that the resulting $\\boldsymbol{f}_e$ is dimensionally consistent with the work term $\\delta \\boldsymbol{d}_e^{T}\\,\\boldsymbol{f}_e$.\n\nAnswer specification:\n- Express the final result as the ordered triple of base-dimension exponents $(\\alpha_M,\\alpha_L,\\alpha_T)$ such that $[\\boldsymbol{f}_e] = M^{\\alpha_M} L^{\\alpha_L} T^{\\alpha_T}$.\n- Provide your final answer as a single row matrix containing the three integers $(\\alpha_M,\\alpha_L,\\alpha_T)$.", "solution": "The problem is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n- Element external nodal load vector: $\\boldsymbol{f}_e \\in \\mathbb{R}^{n_e}$.\n- Element nodal displacement vector: $\\boldsymbol{d}_e \\in \\mathbb{R}^{n_e}$, with entries having the dimension of length.\n- Virtual work of external forces: $\\delta W_{\\mathrm{ext},e} = \\delta \\boldsymbol{d}_e^{T}\\,\\boldsymbol{f}_e$.\n- Shape function matrix: $\\boldsymbol{N}(\\boldsymbol{x})$, constructed from dimensionless shape functions.\n- Body force density (force per unit volume): $\\boldsymbol{b}(\\boldsymbol{x})$.\n- Traction (force per unit area): $\\boldsymbol{t}(\\boldsymbol{x})$.\n- Element volume domain: $\\Omega_e$. Differential volume element: $d\\Omega$.\n- Element traction boundary: $\\Gamma_t$. Differential area element: $d\\Gamma$.\n- Expressions for contributions to $\\boldsymbol{f}_e$: $\\int_{\\Omega_e} \\boldsymbol{N}^{T}\\,\\boldsymbol{b}\\,d\\Omega$ and $\\int_{\\Gamma_t} \\boldsymbol{N}^{T}\\,\\boldsymbol{t}\\,d\\Gamma$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the standard formulation of the Finite Element Method (FEM) within solid mechanics, specifically the principle of virtual work and the derivation of consistent nodal loads. All terms and principles are standard and correct.\n- **Well-Posed:** The problem provides all necessary definitions and relationships to perform a dimensional analysis. The question is unambiguous and asks for a unique set of dimensional exponents.\n- **Objective:** The problem is stated using precise, objective, and formal mathematical language.\n\n**Step 3: Verdict and Action**\n- **Verdict:** The problem is valid. It is a well-posed, scientifically sound question from the field of computational mechanics.\n- **Action:** Proceed with the solution.\n\nWe will perform the dimensional analysis using the base dimensions of Mass ($M$), Length ($L$), and Time ($T$). The dimension of a quantity $Q$ is denoted by $[Q]$.\n\nFirst, we establish the dimensions of fundamental physical quantities involved:\n- Force, $[F] = [mass \\times acceleration] = M L T^{-2}$.\n- Work or Energy, $[W] = [force \\times length] = (M L T^{-2}) L = M L^2 T^{-2}$.\n- Area, $[A] = L^2$.\n- Volume, $[V] = L^3$.\n\nThe problem states the expression for the virtual work of external forces on an element, $\\delta W_{\\mathrm{ext},e} = \\delta \\boldsymbol{d}_e^{T}\\,\\boldsymbol{f}_e$. The quantity $\\delta W_{\\mathrm{ext},e}$ is a scalar representing work, so its dimension is $[W]$.\n$$[\\delta W_{\\mathrm{ext},e}] = M L^2 T^{-2}$$\nThe vector $\\delta \\boldsymbol{d}_e$ represents virtual nodal displacements. Since the entries of $\\boldsymbol{d}_e$ have dimensions of length, the entries of $\\delta \\boldsymbol{d}_e$ likewise have dimensions of length, $[L]$. The term $\\delta \\boldsymbol{d}_e^{T}\\,\\boldsymbol{f}_e$ represents a scalar product (a sum of products of corresponding vector components). For any component $i$, the dimensional relationship is:\n$$[\\delta W_{\\mathrm{ext},e}] = [\\delta d_{e,i}] [f_{e,i}]$$\nHere, $[f_{e,i}]$ denotes the dimension of a component of the nodal force vector $\\boldsymbol{f}_e$. Substituting the known dimensions:\n$$M L^2 T^{-2} = L \\cdot [f_{e,i}]$$\nSolving for $[f_{e,i}]$, we find the dimensions of an individual nodal force component:\n$$[f_{e,i}] = \\frac{M L^2 T^{-2}}{L} = M L T^{-2}$$\nThis is the dimension of force, which is consistent with the physical meaning of a nodal force vector. When referring to the dimension of the vector $\\boldsymbol{f}_e$, we refer to the dimension of its components. Thus, $[\\boldsymbol{f}_e] = M L T^{-2}$.\n\nNext, we must verify that the given integral expressions for the contributions to $\\boldsymbol{f}_e$ are dimensionally consistent with this result.\n\nFirst, consider the contribution from the body force, $\\boldsymbol{f}_{e,b} = \\int_{\\Omega_e} \\boldsymbol{N}^{T}\\,\\boldsymbol{b}\\,d\\Omega$. We analyze the dimensions of the integrand.\n- The shape function matrix $\\boldsymbol{N}$ is given as dimensionless, so $[\\boldsymbol{N}] = [\\boldsymbol{N}^T] = 1$.\n- The body force $\\boldsymbol{b}$ is defined as force per unit volume.\n$$[\\boldsymbol{b}] = \\frac{[F]}{[V]} = \\frac{M L T^{-2}}{L^3} = M L^{-2} T^{-2}$$\n- The differential volume element $d\\Omega$ has dimensions of volume, $[d\\Omega] = L^3$.\n\nThe dimension of the term inside the integral is the product of the dimensions of its factors:\n$$[\\boldsymbol{N}^{T}\\,\\boldsymbol{b}\\,d\\Omega] = [\\boldsymbol{N}^T] \\cdot [\\boldsymbol{b}] \\cdot [d\\Omega] = 1 \\cdot (M L^{-2} T^{-2}) \\cdot L^3 = M L T^{-2}$$\nThe integration operator sums these quantities over the volume, so the dimension of the resulting vector $\\boldsymbol{f}_{e,b}$ is the same as the dimension of the integrand quantity itself.\n$$[\\boldsymbol{f}_{e,b}] = M L T^{-2}$$\nThis is the dimension of force, which is consistent.\n\nSecond, consider the contribution from prescribed tractions, $\\boldsymbol{f}_{e,t} = \\int_{\\Gamma_t} \\boldsymbol{N}^{T}\\,\\boldsymbol{t}\\,d\\Gamma$. We analyze the dimensions of this integrand.\n- As before, $[\\boldsymbol{N}^T] = 1$.\n- The traction $\\boldsymbol{t}$ is defined as force per unit area.\n$$[\\boldsymbol{t}] = \\frac{[F]}{[A]} = \\frac{M L T^{-2}}{L^2} = M L^{-1} T^{-2}$$\n- The differential area element $d\\Gamma$ has dimensions of area, $[d\\Gamma] = L^2$.\n\nThe dimension of the term inside the integral is:\n$$[\\boldsymbol{N}^{T}\\,\\boldsymbol{t}\\,d\\Gamma] = [\\boldsymbol{N}^T] \\cdot [\\boldsymbol{t}] \\cdot [d\\Gamma] = 1 \\cdot (M L^{-1} T^{-2}) \\cdot L^2 = M L T^{-2}$$\nThe dimension of the resulting vector $\\boldsymbol{f}_{e,t}$ is therefore:\n$$[\\boldsymbol{f}_{e,t}] = M L T^{-2}$$\nThis is also the dimension of force, which is consistent.\n\nThe total element nodal load vector $\\boldsymbol{f}_e$ is formed by the sum of these contributions, $\\boldsymbol{f}_e = \\boldsymbol{f}_{e,b} + \\boldsymbol{f}_{e,t}$. Since both terms have the dimensions of force ($M L T^{-2}$), their sum must also have the dimensions of force. This confirms the complete dimensional consistency of the formulation.\n\nThe final task is to express the dimension of $\\boldsymbol{f}_e$ in the form $M^{\\alpha_M} L^{\\alpha_L} T^{\\alpha_T}$. Based on our analysis, we have:\n$$[\\boldsymbol{f}_e] = M^1 L^1 T^{-2}$$\nTherefore, the ordered triple of base-dimension exponents is $(\\alpha_M, \\alpha_L, \\alpha_T) = (1, 1, -2)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & -2\n\\end{pmatrix}\n}\n$$", "id": "3508279"}, {"introduction": "While consistent loads are theoretically rigorous, simpler \"lumped\" methods are often used in practice for their convenience. This exercise moves beyond theory to provide a direct, analytical comparison between these two approaches for a linearly varying traction field. By deriving the explicit difference between the resulting nodal force vectors, you will gain a quantitative understanding of the error introduced by lumping and see how it relates to the element size $a$ and the traction gradient $g$.", "problem": "In computational geomechanics, consistent nodal load vectors are derived from the Principle of Virtual Work (PVW), which states that for arbitrary virtual displacements the external virtual work equals the internal virtual work. Under traction boundary conditions, the external virtual work contributes a boundary integral of the traction field projected through the displacement interpolation. Consider a single bilinear quadrilateral element denoted as a $Q4$ element, occupying a square in the physical plane with side length $a$, whose nodes are ordered counterclockwise as node $\\left(1\\right)$ at $\\left(-a/2,-a/2\\right)$, node $\\left(2\\right)$ at $\\left(a/2,-a/2\\right)$, node $\\left(3\\right)$ at $\\left(a/2,a/2\\right)$, and node $\\left(4\\right)$ at $\\left(-a/2,a/2\\right)$. Assume plane strain kinematics, but note that no constitutive properties are required for this boundary-loading computation.\n\nA line traction acts only on the right edge $x=a/2$. The traction vector is aligned with the global $x$-axis and varies linearly along the edge coordinate $y$ as\n$$\n\\mathbf{t}\\left(y\\right)=\\left(t_{0}+g\\,y\\right)\\,\\mathbf{e}_{x},\n$$\nwhere $t_{0}$ is a constant baseline traction, $g$ is the constant gradient of traction along $y$, and $\\mathbf{e}_{x}$ is the unit vector in the $x$-direction. There are no body forces.\n\nUsing the PVW and the bilinear finite element interpolation for the $Q4$ element, the edge-consistent nodal load vector is obtained from the boundary integral of the traction field multiplied by the shape functions restricted to the boundary. The commonly used lumped alternative for boundary loads distributes the total resultant of the traction over the edge equally to the two nodes on that edge.\n\nStarting from the PVW and the $Q4$ shape functions, perform the following:\n\n- Derive the consistent nodal load contributions at nodes $\\left(2\\right)$ and $\\left(3\\right)$ due to the given traction field.\n- Derive the lumped nodal loads at nodes $\\left(2\\right)$ and $\\left(3\\right)$ by equally distributing the total edge resultant.\n- Form the difference vector between the consistent and lumped nodal load vectors restricted to these nonzero $x$-components.\n- Define the induced error norm as the Euclidean norm of this difference vector, and simplify it explicitly in terms of the element size $a$ and the traction gradient $g$.\n\nProvide your final answer as a single closed-form analytic expression for the Euclidean norm of the difference between the consistent and lumped load vectors, expressed in terms of $a$ and $g$. No numerical substitution is required, and no units are needed in the final expression. The final answer must be a single expression only.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, complete, consistent, and non-trivial. It is a standard problem in computational mechanics, specifically the finite element method. We may proceed with the solution.\n\nThe external virtual work $\\delta W_{ext}$ done by a surface traction field $\\mathbf{t}$ over a boundary $\\Gamma_t$ is given by the integral of the traction vector dotted with the virtual displacement vector $\\delta\\mathbf{u}$:\n$$\n\\delta W_{ext} = \\int_{\\Gamma_t} \\delta\\mathbf{u}^T \\mathbf{t} \\, d\\Gamma\n$$\nWithin the finite element framework, the displacement field $\\mathbf{u}$ is interpolated from the nodal displacements $\\mathbf{d}$ using shape functions organized in a matrix $\\mathbf{N}$, such that $\\mathbf{u} = \\mathbf{N}\\mathbf{d}$. The virtual displacements are thus $\\delta\\mathbf{u} = \\mathbf{N}\\delta\\mathbf{d}$. Substituting this into the virtual work expression yields:\n$$\n\\delta W_{ext} = \\int_{\\Gamma_t} (\\mathbf{N}\\delta\\mathbf{d})^T \\mathbf{t} \\, d\\Gamma = \\delta\\mathbf{d}^T \\int_{\\Gamma_t} \\mathbf{N}^T \\mathbf{t} \\, d\\Gamma\n$$\nBy definition, $\\delta W_{ext} = \\delta\\mathbf{d}^T \\mathbf{f}^c$, where $\\mathbf{f}^c$ is the consistent nodal load vector. Therefore, the consistent nodal loads are computed via the integral:\n$$\n\\mathbf{f}^c = \\int_{\\Gamma_t} \\mathbf{N}^T \\mathbf{t} \\, d\\Gamma\n$$\nThe problem considers a single bilinear quadrilateral ($Q4$) element. The element resides in a natural coordinate system $(\\xi, \\eta)$, where $\\xi, \\eta \\in [-1, 1]$. The shape functions are:\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe physical coordinates $(x, y)$ are given by the isoparametric mapping:\n$x = \\sum_{i=1}^{4} N_i x_i$ and $y = \\sum_{i=1}^{4} N_i y_i$.\nUsing the given nodal coordinates: node $\\left(1\\right)$ at $(-a/2, -a/2)$, node $\\left(2\\right)$ at $(a/2, -a/2)$, node $\\left(3\\right)$ at $(a/2, a/2)$, and node $\\left(4\\right)$ at $(-a/2, a/2)$, the mapping simplifies to:\n$x(\\xi, \\eta) = \\frac{a}{2}\\xi$\n$y(\\xi, \\eta) = \\frac{a}{2}\\eta$\n\nThe traction is applied on the right edge, defined by $x=a/2$. From the mapping, this corresponds to the edge $\\xi=1$, where $\\eta$ varies from $-1$ to $1$. On this edge, the only non-zero shape functions are for nodes $\\left(2\\right)$ and $\\left(3\\right)$:\n$N_2(1, \\eta) = \\frac{1}{4}(1+1)(1-\\eta) = \\frac{1}{2}(1-\\eta)$\n$N_3(1, \\eta) = \\frac{1}{4}(1+1)(1+\\eta) = \\frac{1}{2}(1+\\eta)$\nThe shape functions for nodes $\\left(1\\right)$ and $\\left(4\\right)$ are zero on this edge, so their nodal loads from this traction are zero.\n\nThe traction vector is given as $\\mathbf{t}(y) = (t_0 + g\\,y)\\,\\mathbf{e}_x$. Its components are $t_x = t_0 + g\\,y$ and $t_y=0$. The differential line element on the edge is $d\\Gamma = dy$. Using the mapping $y = a\\eta/2$, we find $dy = (a/2)d\\eta$.\n\nThe $x$-component of the consistent nodal load at node $i$ is $f_{ix}^c = \\int_{\\Gamma_t} N_i t_x \\, d\\Gamma$. We now compute these for nodes $\\left(2\\right)$ and $\\left(3\\right)$.\n\nFor node $\\left(2\\right)$:\n$f_{2x}^c = \\int_{-1}^{1} N_2(1, \\eta) \\left(t_0 + g\\,y(\\eta)\\right) \\frac{a}{2} d\\eta$\n$f_{2x}^c = \\int_{-1}^{1} \\frac{1}{2}(1-\\eta) \\left(t_0 + g\\frac{a}{2}\\eta\\right) \\frac{a}{2} d\\eta = \\frac{a}{4} \\int_{-1}^{1} (t_0 - t_0\\eta + \\frac{ga}{2}\\eta - \\frac{ga}{2}\\eta^2) d\\eta$\n$f_{2x}^c = \\frac{a}{4} \\left[ t_0\\eta - \\frac{t_0}{2}\\eta^2 + \\frac{ga}{4}\\eta^2 - \\frac{ga}{6}\\eta^3 \\right]_{-1}^{1}$\n$f_{2x}^c = \\frac{a}{4} \\left( \\left(t_0 - \\frac{t_0}{2} + \\frac{ga}{4} - \\frac{ga}{6}\\right) - \\left(-t_0 - \\frac{t_0}{2} + \\frac{ga}{4} + \\frac{ga}{6}\\right) \\right)$\n$f_{2x}^c = \\frac{a}{4} \\left( 2t_0 - \\frac{2ga}{6} \\right) = \\frac{at_0}{2} - \\frac{ga^2}{12}$\n\nFor node $\\left(3\\right)$:\n$f_{3x}^c = \\int_{-1}^{1} N_3(1, \\eta) \\left(t_0 + g\\,y(\\eta)\\right) \\frac{a}{2} d\\eta$\n$f_{3x}^c = \\int_{-1}^{1} \\frac{1}{2}(1+\\eta) \\left(t_0 + g\\frac{a}{2}\\eta\\right) \\frac{a}{2} d\\eta = \\frac{a}{4} \\int_{-1}^{1} (t_0 + t_0\\eta + \\frac{ga}{2}\\eta + \\frac{ga}{2}\\eta^2) d\\eta$\n$f_{3x}^c = \\frac{a}{4} \\left[ t_0\\eta + \\frac{t_0}{2}\\eta^2 + \\frac{ga}{4}\\eta^2 + \\frac{ga}{6}\\eta^3 \\right]_{-1}^{1}$\n$f_{3x}^c = \\frac{a}{4} \\left( \\left(t_0 + \\frac{t_0}{2} + \\frac{ga}{4} + \\frac{ga}{6}\\right) - \\left(-t_0 + \\frac{t_0}{2} + \\frac{ga}{4} - \\frac{ga}{6}\\right) \\right)$\n$f_{3x}^c = \\frac{a}{4} \\left( 2t_0 + \\frac{2ga}{6} \\right) = \\frac{at_0}{2} + \\frac{ga^2}{12}$\n\nThe consistent load vector, restricted to the non-zero $x$-components, is:\n$$\n\\mathbf{f}^c_{23x} = \\begin{pmatrix} f_{2x}^c \\\\ f_{3x}^c \\end{pmatrix} = \\begin{pmatrix} \\frac{at_0}{2} - \\frac{ga^2}{12} \\\\ \\frac{at_0}{2} + \\frac{ga^2}{12} \\end{pmatrix}\n$$\nNext, we derive the lumped nodal loads. First, we find the total resultant force $F_x$ by integrating the traction over the edge length, which runs from $y=-a/2$ to $y=a/2$.\n$$\nF_x = \\int_{-a/2}^{a/2} t_x(y) \\, dy = \\int_{-a/2}^{a/2} (t_0 + gy) \\, dy = \\left[ t_0 y + \\frac{g}{2}y^2 \\right]_{-a/2}^{a/2}\n$$\n$$\nF_x = \\left(t_0\\frac{a}{2} + \\frac{g}{2}\\left(\\frac{a}{2}\\right)^2\\right) - \\left(t_0\\left(-\\frac{a}{2}\\right) + \\frac{g}{2}\\left(-\\frac{a}{2}\\right)^2\\right) = t_0\\frac{a}{2} - \\left(-t_0\\frac{a}{2}\\right) = at_0\n$$\nThe lumped load model distributes this total force equally to the two nodes on the edge:\n$f_{2x}^l = f_{3x}^l = \\frac{F_x}{2} = \\frac{at_0}{2}$\n\nThe lumped load vector is:\n$$\n\\mathbf{f}^l_{23x} = \\begin{pmatrix} f_{2x}^l \\\\ f_{3x}^l \\end{pmatrix} = \\begin{pmatrix} \\frac{at_0}{2} \\\\ \\frac{at_0}{2} \\end{pmatrix}\n$$\nThe difference vector $\\mathbf{e}$ between the consistent and lumped load vectors is:\n$$\n\\mathbf{e} = \\mathbf{f}^c_{23x} - \\mathbf{f}^l_{23x} = \\begin{pmatrix} \\left(\\frac{at_0}{2} - \\frac{ga^2}{12}\\right) - \\frac{at_0}{2} \\\\ \\left(\\frac{at_0}{2} + \\frac{ga^2}{12}\\right) - \\frac{at_0}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{ga^2}{12} \\\\ \\frac{ga^2}{12} \\end{pmatrix}\n$$\nThe \"induced error norm\" is the Euclidean norm of this difference vector:\n$$\n\\|\\mathbf{e}\\| = \\sqrt{\\left(-\\frac{ga^2}{12}\\right)^2 + \\left(\\frac{ga^2}{12}\\right)^2} = \\sqrt{2\\left(\\frac{ga^2}{12}\\right)^2} = \\sqrt{2} \\left|\\frac{ga^2}{12}\\right|\n$$\nSince the side length $a$ must be positive ($a>0$), we can write this as:\n$$\n\\|\\mathbf{e}\\| = \\frac{\\sqrt{2}}{12}|g|a^2\n$$\nThis expression quantifies the discrepancy between the two loading methods, showing it is dependent only on the traction gradient $g$ and the element size $a$. For a constant traction ($g=0$), the error is zero, as expected.", "answer": "$$\n\\boxed{\\frac{\\sqrt{2}}{12}|g|a^{2}}\n$$", "id": "3508341"}, {"introduction": "The true power of consistent loads, derived from the principle of virtual work, lies in their ability to preserve global equilibrium for the discretized system. This computational practice challenges you to demonstrate this property by assembling global force vectors for a simple mesh under both consistent and naive lumped loading schemes. By comparing the discrete resultant force and moment to the exact continuous values, you will verify that only the consistent approach guarantees that the discretized model accurately reflects the overall static equilibrium of the continuous problem.", "problem": "Consider a two-dimensional domain with area $\\Omega$ equal to the unit square with corners at $(0,0)$, $(1,0)$, $(0,1)$, and $(1,1)$. The mesh is defined by two linear triangular elements: element $\\mathcal{T}_0$ with vertices at $(0,0)$, $(1,0)$, $(0,1)$ and element $\\mathcal{T}_1$ with vertices at $(1,1)$, $(1,0)$, $(0,1)$. The top boundary segment $\\Gamma_t$ is the line from $(0,1)$ to $(1,1)$ and is discretized as a single linear edge with two nodes at $(0,1)$ and $(1,1)$.\n\nThe objective is to rigorously explore the consequence of using inconsistent nodal loads versus consistent nodal loads for both body forces and boundary tractions in the Finite Element Method (FEM), and to quantify the resulting violation of global equilibrium. You must derive, implement, and compare:\n- Consistent nodal loads for body forces and tractions based on shape function weighting.\n- A commonly used inconsistent (lumped) approach that assigns to each node an equal share of element-wise total loads obtained by single-point evaluation (centroid for area elements and midpoint for the boundary segment).\n\nStarting point and assumptions must be grounded in the Principle of Virtual Work and equilibrium in the weak form. Specifically, use that the external nodal force vector associated with a shape function $N_i$ satisfies\n$$\n\\mathbf{F}_i \\;=\\; \\int_{\\Omega} N_i\\, \\mathbf{b}\\, \\mathrm{d}\\Omega \\;+\\; \\int_{\\Gamma_t} N_i\\, \\mathbf{t}\\, \\mathrm{d}\\Gamma,\n$$\nwhere $\\mathbf{b}$ is the body force density (force per unit area in the two-dimensional setting) and $\\mathbf{t}$ is the traction density (force per unit length) prescribed on $\\Gamma_t$. You must not introduce any untested or ad hoc formulas; all expressions must follow from fundamental definitions and exact integration over the given linear elements.\n\nDefine the body force and traction fields as linear polynomials:\n- $\\mathbf{b}(x,y) = \\big(a_x x + b_x y + c_x,\\; a_y x + b_y y + c_y\\big)$ on $\\Omega$,\n- $\\mathbf{t}(x) = \\big(p_x x + q_x,\\; p_y x + q_y\\big)$ on $\\Gamma_t$ with $x \\in [0,1]$ and $y=1$.\n\nFor the mesh and load definitions above, do the following for each test case:\n1. Assemble the global nodal force vector $\\mathbf{F}^{\\text{cons}}$ using consistent loads, i.e., exact integrals of $N_i \\mathbf{b}$ over each triangle and $N_i \\mathbf{t}$ over the top boundary edge. Assemble the global nodal force vector $\\mathbf{F}^{\\text{naive}}$ using the inconsistent lumped approach, i.e., for each triangle, evaluate $\\mathbf{b}$ at the triangle centroid and distribute $\\frac{A}{3}\\mathbf{b}(\\text{centroid})$ to its three nodes; for the top edge, evaluate $\\mathbf{t}$ at the edge midpoint and distribute $\\frac{L}{2}\\mathbf{t}(\\text{midpoint})$ to its two nodes, where $A$ and $L$ denote the element area and edge length, respectively.\n2. Compute the exact continuous resultant vector $\\mathbf{R}^{\\text{exact}}$ and the exact out-of-plane moment about the origin $M_z^{\\text{exact}}$:\n   $$\n   \\mathbf{R}^{\\text{exact}} = \\int_{\\Omega} \\mathbf{b}\\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\mathbf{t}\\, \\mathrm{d}\\Gamma,\n   $$\n   $$\n   M_z^{\\text{exact}} = \\int_{\\Omega} \\big(x\\, b_y - y\\, b_x\\big)\\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\big(x\\, t_y - y\\, t_x\\big)\\, \\mathrm{d}\\Gamma,\n   $$\n   where $b_x$ and $b_y$ denote the components of $\\mathbf{b}$ and $t_x$ and $t_y$ denote the components of $\\mathbf{t}$.\n3. Compute the discrete assembled resultant $\\mathbf{R}^{\\text{cons}} = \\sum_i \\mathbf{F}^{\\text{cons}}_i$ and $\\mathbf{R}^{\\text{naive}} = \\sum_i \\mathbf{F}^{\\text{naive}}_i$, and the discrete assembled moments $M_z^{\\text{cons}} = \\sum_i \\big(x_i F^{\\text{cons}}_{i,y} - y_i F^{\\text{cons}}_{i,x}\\big)$ and $M_z^{\\text{naive}} = \\sum_i \\big(x_i F^{\\text{naive}}_{i,y} - y_i F^{\\text{naive}}_{i,x}\\big)$, where $(x_i,y_i)$ are the nodal coordinates and $F_{i,x}$, $F_{i,y}$ are the components of the nodal force at node $i$.\n4. For each assembly method, evaluate equilibrium residuals with respect to the exact continuous quantities:\n   $$\n   r_R^{\\text{cons}} = \\left\\| \\mathbf{R}^{\\text{cons}} - \\mathbf{R}^{\\text{exact}} \\right\\|_2,\\quad\n   r_R^{\\text{naive}} = \\left\\| \\mathbf{R}^{\\text{naive}} - \\mathbf{R}^{\\text{exact}} \\right\\|_2,\n   $$\n   $$\n   r_M^{\\text{cons}} = \\left| M_z^{\\text{cons}} - M_z^{\\text{exact}} \\right|,\\quad\n   r_M^{\\text{naive}} = \\left| M_z^{\\text{naive}} - M_z^{\\text{exact}} \\right|.\n   $$\n   Use a tolerance $\\varepsilon = 10^{-12}$ to classify equilibrium satisfaction.\n5. Report, for each test case, the pair of booleans $\\big[\\text{naive\\_violates},\\text{consistent\\_satisfies}\\big]$ where\n   $\\text{naive\\_violates}$ is $\\text{True}$ if $r_R^{\\text{naive}} > \\varepsilon$ or $r_M^{\\text{naive}} > \\varepsilon$, and $\\text{False}$ otherwise, and\n   $\\text{consistent\\_satisfies}$ is $\\text{True}$ if $r_R^{\\text{cons}} \\le \\varepsilon$ and $r_M^{\\text{cons}} \\le \\varepsilon$, and $\\text{False}$ otherwise.\n   These outputs are unitless booleans.\n\nUse the following test suite to probe different behaviors:\n- Case $1$ (general constant loads): $a_x=0$, $b_x=0$, $c_x=0$, $a_y=0$, $b_y=0$, $c_y=3$, $p_x=0$, $q_x=0$, $p_y=0$, $q_y=2$.\n- Case $2$ (linearly varying body force in $x$): $a_x=0$, $b_x=0$, $c_x=0$, $a_y=1$, $b_y=0$, $c_y=2$, $p_x=0$, $q_x=0$, $p_y=0$, $q_y=3$.\n- Case $3$ (linearly varying traction in $x$): $a_x=0$, $b_x=0$, $c_x=0$, $a_y=0$, $b_y=0$, $c_y=0$, $p_x=0$, $q_x=0$, $p_y=1$, $q_y=3$.\n- Case $4$ (zero loads): $a_x=0$, $b_x=0$, $c_x=0$, $a_y=0$, $b_y=0$, $c_y=0$, $p_x=0$, $q_x=0$, $p_y=0$, $q_y=0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and with no spaces. Each test case contributes its pair of booleans, so the final output is a list of pairs in the form $[[\\text{b}_{11},\\text{b}_{12}],[\\text{b}_{21},\\text{b}_{22}],\\dots]$ with no spaces, for example, $[[\\text{True},\\text{False}],[\\text{False},\\text{True}]]$.", "solution": "The derivation begins from the Principle of Virtual Work and the weak form of equilibrium in the Finite Element Method (FEM). For a shape function $N_i$ associated with node $i$, the externally applied nodal force vector is given by\n$$\n\\mathbf{F}_i \\;=\\; \\int_{\\Omega} N_i\\, \\mathbf{b}\\, \\mathrm{d}\\Omega \\;+\\; \\int_{\\Gamma_t} N_i\\, \\mathbf{t}\\, \\mathrm{d}\\Gamma,\n$$\nwhere $\\Omega$ is the domain, $\\Gamma_t$ the traction boundary, $\\mathbf{b}$ the body force density, and $\\mathbf{t}$ the traction density. This expression is fundamental: it follows directly from the weak form by choosing a virtual displacement field that equals $N_i$ in the direction of the applied load and zero elsewhere.\n\nConsistent nodal loads are obtained by evaluating these integrals exactly over the element geometry using the actual shape functions. For linear triangles, the shape functions coincide with barycentric coordinates and are linear. The discretization employed here uses two linear triangles covering the unit square:\n- $\\mathcal{T}_0$ with vertices $\\mathbf{r}_0=(0,0)$, $\\mathbf{r}_1=(1,0)$, $\\mathbf{r}_2=(0,1)$,\n- $\\mathcal{T}_1$ with vertices $\\mathbf{r}_3=(1,1)$, $\\mathbf{r}_1=(1,0)$, $\\mathbf{r}_2=(0,1)$.\n\nFor each triangle $\\mathcal{T}$ with area $A$, the following exact integrals of shape functions are standard results derived from the properties of linear barycentric coordinates:\n$$\n\\int_{\\mathcal{T}} N_i\\, \\mathrm{d}\\Omega \\;=\\; \\frac{A}{3},\n\\qquad\n\\int_{\\mathcal{T}} N_i N_j\\, \\mathrm{d}\\Omega \\;=\\;\n\\begin{cases}\n\\frac{A}{6}, & i=j,\n\\\\\n\\frac{A}{12}, & i\\ne j.\n\\end{cases}\n$$\nThese follow by integrating the polynomial basis on the triangle using, for example, exact area coordinates identities or by direct symbolic integration. For a position vector $\\mathbf{r}(x,y)=(x,y)$ and the node coordinates $\\mathbf{r}_k=(x_k,y_k)$, the linearity yields\n$$\nx \\;=\\; \\sum_{k} N_k x_k,\\qquad\ny \\;=\\; \\sum_{k} N_k y_k,\n$$\nand hence, for each local node $i$,\n$$\n\\int_{\\mathcal{T}} N_i\\, x\\, \\mathrm{d}\\Omega \\;=\\; \\sum_{k} x_k \\int_{\\mathcal{T}} N_i N_k\\, \\mathrm{d}\\Omega,\n\\qquad\n\\int_{\\mathcal{T}} N_i\\, y\\, \\mathrm{d}\\Omega \\;=\\; \\sum_{k} y_k \\int_{\\mathcal{T}} N_i N_k\\, \\mathrm{d}\\Omega.\n$$\n\nGiven the body force field $\\mathbf{b}(x,y) = \\big(a_x x + b_x y + c_x,\\; a_y x + b_y y + c_y\\big)$, the consistent element nodal load components for node $i$ in triangle $\\mathcal{T}$ are\n$$\nF^{\\mathcal{T}}_{i,x} \\;=\\; a_x \\int_{\\mathcal{T}} N_i x\\, \\mathrm{d}\\Omega \\;+\\; b_x \\int_{\\mathcal{T}} N_i y\\, \\mathrm{d}\\Omega \\;+\\; c_x \\int_{\\mathcal{T}} N_i\\, \\mathrm{d}\\Omega,\n$$\n$$\nF^{\\mathcal{T}}_{i,y} \\;=\\; a_y \\int_{\\mathcal{T}} N_i x\\, \\mathrm{d}\\Omega \\;+\\; b_y \\int_{\\mathcal{T}} N_i y\\, \\mathrm{d}\\Omega \\;+\\; c_y \\int_{\\mathcal{T}} N_i\\, \\mathrm{d}\\Omega.\n$$\nThese are exact for any linear body force, because the integrands are at most quadratic and the above shape function product integrals capture the necessary terms precisely.\n\nFor the traction on the top edge $\\Gamma_t$ between $(0,1)$ and $(1,1)$, the local coordinate is $x\\in[0,1]$ with $y=1$, and the linear edge shape functions are $N_{(0,1)}(x)=1-x$ and $N_{(1,1)}(x)=x$. With $\\mathbf{t}(x) = \\big(p_x x + q_x,\\; p_y x + q_y\\big)$, the consistent nodal traction loads are\n$$\n\\mathbf{F}_{(0,1)}^{\\Gamma_t} \\;=\\; \\int_{0}^{1} (1-x)\\, \\mathbf{t}(x)\\, \\mathrm{d}x,\n\\qquad\n\\mathbf{F}_{(1,1)}^{\\Gamma_t} \\;=\\; \\int_{0}^{1} x\\, \\mathbf{t}(x)\\, \\mathrm{d}x,\n$$\nwhich can be evaluated component-wise in closed form, since the integrands are polynomials.\n\nIn contrast, the inconsistent (lumped) approach considered here approximates the element contributions by single-point sampling:\n- For each triangle $\\mathcal{T}$, evaluate $\\mathbf{b}$ at the triangle centroid $\\mathbf{r}_c$ and distribute $\\frac{A}{3}\\mathbf{b}(\\mathbf{r}_c)$ to each of the three nodes.\n- For the top edge, evaluate $\\mathbf{t}$ at the edge midpoint $x=\\frac{1}{2}$ and distribute $\\frac{L}{2}\\mathbf{t}(1/2)$ to each of its two nodes, with $L=1$.\n\nThese lumped rules are exact for constant fields and for integrals where the integrand is linear in the integration variable, but they fail whenever the exact integrand becomes quadratic or higher — notably for the out-of-plane moment about the origin, which involves products of position and load components. The consistent assembly satisfies\n$$\n\\sum_i \\mathbf{F}_i^{\\text{cons}} \\;=\\; \\int_{\\Omega} \\mathbf{b}\\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\mathbf{t}\\, \\mathrm{d}\\Gamma,\n$$\n$$\n\\sum_i \\big( x_i F^{\\text{cons}}_{i,y} - y_i F^{\\text{cons}}_{i,x} \\big) \\;=\\; \\int_{\\Omega} \\big( x b_y - y b_x \\big)\\, \\mathrm{d}\\Omega + \\int_{\\Gamma_t} \\big( x t_y - y t_x \\big)\\, \\mathrm{d}\\Gamma,\n$$\nexactly, because $\\sum_i N_i \\mathbf{r}_i=\\mathbf{r}$ inside each element and linear edge, so exchanging the sum with the integral reproduces the continuous expressions. The lumped method, by replacing $\\mathbf{r}$ with averaged nodal positions and replacing fields by single-point values, reduces these integrals to one-point quadrature, which is not exact for quadratic integrands and breaks global moment equilibrium.\n\nTo quantify equilibrium, compute the exact continuous resultant and moment by direct integration over $\\Omega=[0,1]\\times[0,1]$ and $\\Gamma_t=[0,1]$:\n$$\n\\mathbf{R}^{\\text{exact}} = \\left(\n\\int_{0}^{1}\\int_{0}^{1} a_x x + b_x y + c_x \\,\\mathrm{d}x\\,\\mathrm{d}y \\;+\\; \\int_{0}^{1} p_x x + q_x \\,\\mathrm{d}x,\n\\;\n\\int_{0}^{1}\\int_{0}^{1} a_y x + b_y y + c_y \\,\\mathrm{d}x\\,\\mathrm{d}y \\;+\\; \\int_{0}^{1} p_y x + q_y \\,\\mathrm{d}x\n\\right),\n$$\n$$\nM_z^{\\text{exact}} = \\int_{0}^{1}\\int_{0}^{1} \\big( x\\,(a_y x + b_y y + c_y) - y\\,(a_x x + b_x y + c_x) \\big)\\,\\mathrm{d}x\\,\\mathrm{d}y\n\\;+\\; \\int_{0}^{1} \\big( x\\,(p_y x + q_y) - 1\\cdot(p_x x + q_x) \\big)\\,\\mathrm{d}x,\n$$\nwhich reduce to combinations of standard polynomial integrals:\n$$\n\\int_{0}^{1} x\\, \\mathrm{d}x = \\frac{1}{2},\\quad\n\\int_{0}^{1} x^2\\, \\mathrm{d}x = \\frac{1}{3},\\quad\n\\int_{0}^{1}\\int_{0}^{1} x\\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{1}{2},\\quad\n\\int_{0}^{1}\\int_{0}^{1} y\\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{1}{2},\\quad\n\\int_{0}^{1}\\int_{0}^{1} x^2\\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{1}{3},\\quad\n\\int_{0}^{1}\\int_{0}^{1} y^2\\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{1}{3},\\quad\n\\int_{0}^{1}\\int_{0}^{1} x y\\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{1}{4}.\n$$\n\nDefine the discrete assembled resultant and moment from the nodal forces and positions:\n$$\n\\mathbf{R}^{\\text{cons}} = \\sum_i \\mathbf{F}_i^{\\text{cons}},\\quad\n\\mathbf{R}^{\\text{naive}} = \\sum_i \\mathbf{F}_i^{\\text{naive}},\n$$\n$$\nM_z^{\\text{cons}} = \\sum_i \\left( x_i F^{\\text{cons}}_{i,y} - y_i F^{\\text{cons}}_{i,x} \\right),\\quad\nM_z^{\\text{naive}} = \\sum_i \\left( x_i F^{\\text{naive}}_{i,y} - y_i F^{\\text{naive}}_{i,x} \\right).\n$$\n\nFinally, compute the equilibrium residuals\n$$\nr_R^{\\text{cons}} = \\left\\| \\mathbf{R}^{\\text{cons}} - \\mathbf{R}^{\\text{exact}} \\right\\|_2,\\quad\nr_R^{\\text{naive}} = \\left\\| \\mathbf{R}^{\\text{naive}} - \\mathbf{R}^{\\text{exact}} \\right\\|_2,\n$$\n$$\nr_M^{\\text{cons}} = \\left| M_z^{\\text{cons}} - M_z^{\\text{exact}} \\right|,\\quad\nr_M^{\\text{naive}} = \\left| M_z^{\\text{naive}} - M_z^{\\text{exact}} \\right|,\n$$\nwith tolerance $\\varepsilon = 10^{-12}$. The expected qualitative outcomes for the provided test suite are:\n- Case $1$ (constant $\\mathbf{b}$ and constant $\\mathbf{t}$): the lumped method satisfies equilibrium for both resultant and moment because the integrands are at most linear, so one-point rules are exact; the consistent method is exact by construction. Output pair should be $[\\text{False},\\text{True}]$.\n- Case $2$ (linear $\\mathbf{b}$ in $x$, constant $\\mathbf{t}$): the exact moment integrand over $\\Omega$ contains $x^2$ terms, so the lumped method, which reduces to centroid one-point quadrature for moment, fails; the consistent method reproduces the exact equilibrium. Output pair should be $[\\text{True},\\text{True}]$.\n- Case $3$ (linear $\\mathbf{t}$ in $x$, zero $\\mathbf{b}$): the exact moment integrand over $\\Gamma_t$ contains $x^2$, so midpoint lumping fails for moment, while consistent edge integration is exact. Output pair should be $[\\text{True},\\text{True}]$.\n- Case $4$ (zero loads): both methods yield zero resultant and moment; the consistent method trivially satisfies, and the lumped method does not violate. Output pair should be $[\\text{False},\\text{True}]$.\n\nThe discrepancy when using inconsistent loads arises because consistent loads weight the distributed fields by the shape functions $N_i$, ensuring exact reproduction of the continuous resultant and moment through the identities $\\sum_i N_i \\mathbf{r}_i = \\mathbf{r}$ and linear completeness. In contrast, the lumped approach ignores this weighting, effectively replacing the integrand by its value at a single point and replacing $\\mathbf{r}$ by an average nodal position, which breaks exactness once the integrand involves products like $x\\,b_y$ or $x\\,t_y$ that are quadratic. This manifests as a violation of global moment equilibrium in the assembled force vector, even though the resultant force may still be correct for linear distributions.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef triangle_area(coords):\n    # coords: array of shape (3,2) with (x,y)\n    x0, y0 = coords[0]\n    x1, y1 = coords[1]\n    x2, y2 = coords[2]\n    return 0.5 * abs((x1 - x0) * (y2 - y0) - (x2 - x0) * (y1 - y0))\n\ndef triangle_centroid(coords):\n    return np.mean(coords, axis=0)\n\ndef consistent_body_element_forces(coords, ax, bx, cx, ay, by, cy):\n    \"\"\"\n    Compute consistent nodal loads for a linear triangle with body force\n    b(x,y) = (ax*x + bx*y + cx, ay*x + by*y + cy).\n    Returns array of shape (3,2) for the three local nodes.\n    \"\"\"\n    A = triangle_area(coords)\n    # Integrals of N_i N_j over triangle:\n    # diag: A/6, off-diag: A/12\n    I_diag = A / 6.0\n    I_off = A / 12.0\n\n    # Precompute integrals: for each local node i,\n    # ∫ N_i dΩ = A/3\n    IN = np.full(3, A / 3.0)\n\n    # ∫ N_i x dΩ = sum_j x_j ∫ N_i N_j\n    # ∫ N_i y dΩ = sum_j y_j ∫ N_i N_j\n    x = coords[:, 0]\n    y = coords[:, 1]\n    forces = np.zeros((3, 2))\n    for i in range(3):\n        # integrals of N_i N_j\n        INNj = np.full(3, I_off)\n        INNj[i] = I_diag\n        INx = np.dot(INNj, x)\n        INy = np.dot(INNj, y)\n        Fx = ax * INx + bx * INy + cx * IN[i]\n        Fy = ay * INx + by * INy + cy * IN[i]\n        forces[i, 0] = Fx\n        forces[i, 1] = Fy\n    return forces\n\ndef naive_body_element_forces(coords, ax, bx, cx, ay, by, cy):\n    \"\"\"\n    Lumped nodal loads: evaluate b at triangle centroid and distribute A/3 * b(c) to each node.\n    \"\"\"\n    A = triangle_area(coords)\n    c = triangle_centroid(coords)\n    x, y = c\n    bx_comp = ax * x + bx * y + cx\n    by_comp = ay * x + by * y + cy\n    contrib = np.array([bx_comp, by_comp]) * (A / 3.0)\n    return np.tile(contrib, (3, 1))\n\ndef consistent_edge_forces_top(px, qx, py, qy):\n    \"\"\"\n    Consistent traction nodal loads on top edge from (0,1) to (1,1), shape functions N0=1-x, N1=x.\n    Returns array of shape (2,2): forces at nodes (0,1) and (1,1).\n    \"\"\"\n    # Compute integrals:\n    # F_(0,1) = ∫_0^1 (1-x) * t(x) dx\n    # F_(1,1) = ∫_0^1 x * t(x) dx\n    # Component-wise:\n    # For t_x = px*x + qx:\n    # ∫ (1-x) * (px*x + qx) dx = px*(∫ x - ∫ x^2) + qx*(∫ 1 - ∫ x) = px*(1/2 - 1/3) + qx*(1 - 1/2)\n    # ∫ x * (px*x + qx) dx = px*∫ x^2 + qx*∫ x = px*(1/3) + qx*(1/2)\n    I1 = 1.0\n    Ix = 0.5\n    Ix2 = 1.0 / 3.0\n    # Node (0,1)\n    Fx0 = px * (Ix - Ix2) + qx * (I1 - Ix)\n    Fy0 = py * (Ix - Ix2) + qy * (I1 - Ix)\n    # Node (1,1)\n    Fx1 = px * Ix2 + qx * Ix\n    Fy1 = py * Ix2 + qy * Ix\n    return np.array([[Fx0, Fy0], [Fx1, Fy1]])\n\ndef naive_edge_forces_top(px, qx, py, qy):\n    \"\"\"\n    Lumped traction nodal loads on top edge: evaluate at midpoint x=0.5, length L=1, split equally.\n    \"\"\"\n    xm = 0.5\n    txm = np.array([px * xm + qx, py * xm + qy])\n    contrib = 0.5 * txm  # L/2 = 0.5\n    return np.vstack([contrib, contrib])\n\ndef assemble_global(nodal_count, elements, nodes, body_params, traction_params, method=\"consistent\"):\n    \"\"\"\n    Assemble global nodal force vector for given method: \"consistent\" or \"naive\".\n    nodes: array of shape (4,2)\n    elements: list of arrays of local node indices\n    body_params: (ax, bx, cx, ay, by, cy)\n    traction_params: (px, qx, py, qy)\n    Returns array of shape (4,2)\n    \"\"\"\n    ax, bx, cx, ay, by, cy = body_params\n    px, qx, py, qy = traction_params\n    F = np.zeros((nodal_count, 2))\n    # Body forces per triangle\n    for elem in elements:\n        coords = nodes[elem]\n        if method == \"consistent\":\n            Fe = consistent_body_element_forces(coords, ax, bx, cx, ay, by, cy)\n        else:\n            Fe = naive_body_element_forces(coords, ax, bx, cx, ay, by, cy)\n        for loc_i, glob_i in enumerate(elem):\n            F[glob_i] += Fe[loc_i]\n    # Traction on top edge between node 2 (0,1) and node 3 (1,1)\n    # global indices: 2 and 3\n    if method == \"consistent\":\n        Ft = consistent_edge_forces_top(px, qx, py, qy)\n    else:\n        Ft = naive_edge_forces_top(px, qx, py, qy)\n    F[2] += Ft[0]\n    F[3] += Ft[1]\n    return F\n\ndef exact_resultant_and_moment(body_params, traction_params):\n    \"\"\"\n    Compute exact continuous resultant and out-of-plane moment about origin.\n    \"\"\"\n    ax, bx, cx, ay, by, cy = body_params\n    px, qx, py, qy = traction_params\n    # Exact resultant:\n    # R_area_x = ∫∫ (ax*x + bx*y + cx) dx dy = ax*(1/2) + bx*(1/2) + cx*(1)\n    # R_area_y = ay*(1/2) + by*(1/2) + cy*(1)\n    Rx_area = ax * 0.5 + bx * 0.5 + cx * 1.0\n    Ry_area = ay * 0.5 + by * 0.5 + cy * 1.0\n    # Edge resultant:\n    # ∫_0^1 (px*x + qx) dx = px*(1/2) + qx*(1)\n    # ∫_0^1 (py*x + qy) dx = py*(1/2) + qy*(1)\n    Rx_edge = px * 0.5 + qx * 1.0\n    Ry_edge = py * 0.5 + qy * 1.0\n    R_exact = np.array([Rx_area + Rx_edge, Ry_area + Ry_edge])\n\n    # Exact moment:\n    # Mz_area = ∫∫ [ x*(ay*x + by*y + cy) - y*(ax*x + bx*y + cx) ] dx dy\n    # Terms:\n    Ix = 0.5\n    Iy = 0.5\n    Ix2 = 1.0 / 3.0\n    Iy2 = 1.0 / 3.0\n    Ixy = 0.25\n    Mz_area = (ay * Ix2 + by * Ixy + cy * Ix) - (ax * Ixy + bx * Iy2 + cx * Iy)\n    # Mz_edge = ∫_0^1 [ x*(py*x + qy) - 1*(px*x + qx) ] dx = py*(1/3) + qy*(1/2) - px*(1/2) - qx*(1)\n    Mz_edge = py * (1.0 / 3.0) + qy * 0.5 - px * 0.5 - qx * 1.0\n    Mz_exact = Mz_area + Mz_edge\n    return R_exact, Mz_exact\n\ndef resultant_and_moment_from_nodal(F, nodes):\n    \"\"\"\n    Compute discrete resultant and out-of-plane moment from nodal forces.\n    \"\"\"\n    R = F.sum(axis=0)\n    # Mz = sum_i (x_i * F_i_y - y_i * F_i_x)\n    x = nodes[:, 0]\n    y = nodes[:, 1]\n    Mz = np.sum(x * F[:, 1] - y * F[:, 0])\n    return R, Mz\n\ndef format_results_no_spaces(results):\n    # results: list of [bool, bool]\n    # Produce string like [[True,True],[False,True],...]\n    inner = []\n    for pair in results:\n        inner.append(f\"[{str(pair[0])},{str(pair[1])}]\")\n    return f\"[{','.join(inner)}]\"\n\ndef solve():\n    # Nodes: index 0:(0,0), 1:(1,0), 2:(0,1), 3:(1,1)\n    nodes = np.array([[0.0, 0.0],\n                      [1.0, 0.0],\n                      [0.0, 1.0],\n                      [1.0, 1.0]])\n    # Elements: triangles\n    elements = [np.array([0, 1, 2]),  # T0\n                np.array([3, 1, 2])]  # T1\n\n    # Test cases: (ax, bx, cx, ay, by, cy, px, qx, py, qy)\n    test_cases = [\n        # Case 1: constant body (c_y=3), constant traction (q_y=2)\n        (0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 2.0),\n        # Case 2: linear body in x (a_y=1, c_y=2), constant traction (q_y=3)\n        (0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0),\n        # Case 3: linear traction in x (p_y=1, q_y=3), zero body\n        (0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0),\n        # Case 4: zero loads\n        (0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0),\n    ]\n\n    tol = 1e-12\n    results = []\n\n    for case in test_cases:\n        ax, bx, cx, ay, by, cy, px, qx, py, qy = case\n        body_params = (ax, bx, cx, ay, by, cy)\n        traction_params = (px, qx, py, qy)\n\n        # Assemble\n        F_cons = assemble_global(nodal_count=4, elements=elements, nodes=nodes,\n                                 body_params=body_params, traction_params=traction_params,\n                                 method=\"consistent\")\n        F_naive = assemble_global(nodal_count=4, elements=elements, nodes=nodes,\n                                  body_params=body_params, traction_params=traction_params,\n                                  method=\"naive\")\n\n        # Exact\n        R_exact, Mz_exact = exact_resultant_and_moment(body_params, traction_params)\n\n        # Discrete\n        R_cons, Mz_cons = resultant_and_moment_from_nodal(F_cons, nodes)\n        R_naive, Mz_naive = resultant_and_moment_from_nodal(F_naive, nodes)\n\n        # Residuals\n        rR_cons = np.linalg.norm(R_cons - R_exact)\n        rR_naive = np.linalg.norm(R_naive - R_exact)\n        rM_cons = abs(Mz_cons - Mz_exact)\n        rM_naive = abs(Mz_naive - Mz_exact)\n\n        naive_violates = (rR_naive > tol) or (rM_naive > tol)\n        consistent_satisfies = (rR_cons = tol) and (rM_cons = tol)\n\n        results.append([naive_violates, consistent_satisfies])\n\n    # Final print statement in the exact required format: no spaces\n    print(format_results_no_spaces(results))\n\nsolve()\n```", "id": "3508328"}]}