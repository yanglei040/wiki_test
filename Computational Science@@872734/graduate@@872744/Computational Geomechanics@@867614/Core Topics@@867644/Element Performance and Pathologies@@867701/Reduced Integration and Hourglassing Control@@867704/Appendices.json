{"hands_on_practices": [{"introduction": "Reduced integration is a powerful technique used in computational geomechanics to overcome numerical issues like shear locking in isoparametric elements. However, this method can introduce a new challenge: the failure to detect certain deformation patterns. This first exercise provides a foundational, hands-on demonstration of these so-called \"hourglass\" or zero-energy modes by having you construct a specific nodal displacement pattern for a bilinear quadrilateral element and verify that it results in zero strain energy, making the abstract concept tangible [@problem_id:3555206].", "problem": "Consider a single four-node bilinear isoparametric quadrilateral finite element in plane strain, used in computational geomechanics. The element is a square of side length $2L$ and thickness $t$, with nodes located at physical coordinates $(x,y)$: node $1$ at $(-L,-L)$, node $2$ at $(L,-L)$, node $3$ at $(L,L)$, and node $4$ at $(-L,L)$. The material is linear elastic, homogeneous, and isotropic with Young’s modulus $E$ and Poisson’s ratio $\\nu$ under plane strain conditions. The stiffness matrix is formed using one-point Gaussian quadrature (i.e., reduced integration) at the element center $(\\xi,\\eta)=(0,0)$ in the natural coordinate system.\n\nAdopt the standard bilinear shape functions in terms of natural coordinates $(\\xi,\\eta)$, and the standard isoparametric mapping $x=L\\xi$, $y=L\\eta$. Let the nodal displacement vector be ordered as\n$$\n\\boldsymbol{u}=\\begin{pmatrix}u_1 & v_1 & u_2 & v_2 & u_3 & v_3 & u_4 & v_4\\end{pmatrix}^{\\mathsf{T}},\n$$\nwhere $u_i$ and $v_i$ are, respectively, the $x$- and $y$-displacements of node $i$.\n\nUsing only the one-point Gaussian quadrature at the element center and without any hourglass control stabilization, determine one nontrivial hourglass mode by finding a specific nodal displacement vector $\\boldsymbol{u}$ (normalized to have Euclidean norm $1$) such that the strain vector evaluated at the center is identically zero. Then, using the one-point finite element approximation of internal energy, verify and compute the internal energy\n$$\nU=\\frac{1}{2}\\,\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\,\\boldsymbol{u},\n$$\nwhere $\\boldsymbol{K}$ is the element stiffness matrix obtained by the one-point quadrature without stabilization.\n\nProvide:\n- The components of the normalized hourglass nodal displacement vector $\\boldsymbol{u}$.\n- The corresponding internal energy $U$.\n\nExpress the internal energy in Joules. No numerical rounding is required. Return your final answer as a single row matrix containing the eight components of $\\boldsymbol{u}$ followed by $U$.", "solution": "The user wants me to solve a problem in computational geomechanics, specifically related to finite element analysis.\n\nHere's my plan:\n1.  **Validate the problem statement:** Check for scientific soundness, well-posedness, and completeness.\n    *   **Givens:**\n        *   Element: 4-node bilinear isoparametric quadrilateral, plane strain.\n        *   Geometry: Square, side length $2L$, thickness $t$.\n        *   Nodes (physical coordinates): $1(-L,-L)$, $2(L,-L)$, $3(L,L)$, $4(-L,L)$.\n        *   Material: Linear elastic, homogeneous, isotropic (Young's modulus $E$, Poisson's ratio $\\nu$).\n        *   Integration: One-point Gaussian quadrature at $(\\xi, \\eta) = (0,0)$.\n        *   Mapping: $x=L\\xi$, $y=L\\eta$ from natural coords $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$.\n        *   Displacements: $\\boldsymbol{u}=\\begin{pmatrix}u_1 & v_1 & u_2 & v_2 & u_3 & v_3 & u_4 & v_4\\end{pmatrix}^{\\mathsf{T}}$.\n        *   Task 1: Find one nontrivial, normalized hourglass mode $\\boldsymbol{u}$ (Euclidean norm = 1) for which the strain at the center is zero.\n        *   Task 2: Compute the internal energy $U=\\frac{1}{2}\\,\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\,\\boldsymbol{u}$ for this mode, where $\\boldsymbol{K}$ is the unstabilized, one-point integrated stiffness matrix.\n        *   Special instructions: \"Express the internal energy in Joules.\" and \"No numerical rounding is required.\"\n    *   **Validation:**\n        *   The problem is scientifically grounded in the theory of the Finite Element Method (FEM).\n        *   The setup is standard for demonstrating hourglassing in under-integrated elements.\n        *   The initial concern is the instruction to provide energy in \"Joules\" for a problem with symbolic parameters ($E, L, t, \\nu$). This suggests a potential contradiction, as units cannot be assigned without numerical values.\n        *   However, let's analyze the core of the problem. An \"hourglass mode\" for a reduced-integration element is, by definition, a nodal displacement pattern that produces zero strain at the integration point(s). The internal energy, as approximated by the FEM quadrature rule, is a function of the strain at these integration points.\n        *   Specifically, the element internal energy is $U \\approx \\frac{1}{2} (\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c))^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c)) \\times V_{eff}$, where $\\boldsymbol{x}_c$ is the integration point and $V_{eff}$ is an effective volume.\n        *   If $\\boldsymbol{\\varepsilon}(\\boldsymbol{x}_c) = \\boldsymbol{0}$ by the definition of the mode being investigated, then the calculated internal energy $U$ must be exactly $0$.\n        *   The value $0$ is independent of the unit system. \"0 Joules\" is a perfectly valid and unambiguous statement.\n        *   Therefore, the problem is not contradictory but is a well-designed question to test the fundamental understanding of hourglass modes. It is valid.\n\n2.  **Proceed with the solution:**\n    *   Define the bilinear shape functions $N_i(\\xi, \\eta)$.\n    *   Define the isoparametric mapping and compute the Jacobian matrix $\\boldsymbol{J}$.\n    *   Derive the strain-displacement matrix $\\boldsymbol{B}$ which relates the strain vector $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_x & \\varepsilon_y & \\gamma_{xy} \\end{pmatrix}^{\\mathsf{T}}$ to the nodal displacement vector $\\boldsymbol{u}$ via $\\boldsymbol{\\varepsilon} = \\boldsymbol{B}\\boldsymbol{u}$.\n    *   Evaluate $\\boldsymbol{B}$ at the integration point $(\\xi, \\eta) = (0,0)$.\n    *   Find a non-trivial vector $\\boldsymbol{u}$ in the null space of $\\boldsymbol{B}(0,0)$. This vector represents an hourglass mode. A standard choice is the \"bow-tie\" mode.\n    *   Normalize this vector to have a Euclidean norm of 1.\n    *   Formally write the expression for the element stiffness matrix $\\boldsymbol{K}$ using one-point quadrature.\n    *   Substitute this into the internal energy expression $U = \\frac{1}{2}\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{u}$.\n    *   Show that because $\\boldsymbol{u}$ is an hourglass mode, the energy $U$ evaluates to zero.\n    *   Assemble the final answer as a row matrix.\n\n**Step-by-step Execution:**\n\n*   **Shape Functions:**\n    $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n*   **Jacobian:**\n    $x = \\sum N_i x_i = L\\xi$, $y = \\sum N_i y_i = L\\eta$.\n    $\\boldsymbol{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} L & 0 \\\\ 0 & L \\end{pmatrix}$.\n    $\\boldsymbol{J}^{-1} = \\begin{pmatrix} 1/L & 0 \\\\ 0 & 1/L \\end{pmatrix}$. $\\det(\\boldsymbol{J}) = L^2$.\n*   **B-matrix at center:**\n    At $(\\xi, \\eta) = (0,0)$:\n    $\\frac{\\partial N_1}{\\partial \\xi}=-\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\xi}=\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\xi}=\\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\xi}=-\\frac{1}{4}$.\n    $\\frac{\\partial N_1}{\\partial \\eta}=-\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\eta}=-\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\eta}=\\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\eta}=\\frac{1}{4}$.\n    The B-matrix relates strains to displacements: $\\begin{pmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{pmatrix} = \\sum_{i=1}^4 \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{pmatrix} \\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}$.\n    Using $\\frac{\\partial N_i}{\\partial x} = \\frac{1}{L}\\frac{\\partial N_i}{\\partial \\xi}$ and $\\frac{\\partial N_i}{\\partial y} = \\frac{1}{L}\\frac{\\partial N_i}{\\partial \\eta}$:\n    $\\boldsymbol{B}(0,0) = \\frac{1}{4L} \\begin{pmatrix} -1 & 0 & 1 & 0 & 1 & 0 & -1 & 0 \\\\ 0 & -1 & 0 & -1 & 0 & 1 & 0 & 1 \\\\ -1 & -1 & -1 & 1 & 1 & 1 & 1 & -1 \\end{pmatrix}$.\n*   **Hourglass Mode:**\n    We need $\\boldsymbol{B}(0,0)\\boldsymbol{u} = \\boldsymbol{0}$.\n    Let's test the classic mode: $\\boldsymbol{u}_{raw} = \\begin{pmatrix} 1 & -1 & -1 & 1 & 1 & -1 & -1 & 1 \\end{pmatrix}^{\\mathsf{T}}$ (this is not it).\n    Let's use the mode $\\boldsymbol{h} = \\begin{pmatrix} 1, -1, 1, -1 \\end{pmatrix}^{\\mathsf{T}}$ for the $u$ components, and zero for $v$.\n    $\\boldsymbol{u}_{raw} = \\begin{pmatrix} 1 & 0 & -1 & 0 & 1 & 0 & -1 & 0 \\end{pmatrix}^{\\mathsf{T}}$.\n    Check: $\\boldsymbol{B}(0,0)\\boldsymbol{u}_{raw} = \\frac{1}{4L} \\begin{pmatrix} -1(1)+1(-1)+1(1)-1(-1) \\\\ 0 \\\\ -1(1)-1(-1)+1(1)+1(-1) \\end{pmatrix} = \\frac{1}{4L} \\begin{pmatrix} -1-1+1+1 \\\\ 0 \\\\ -1+1+1-1 \\end{pmatrix} = \\boldsymbol{0}$. This mode works.\n*   **Normalization:**\n    $||\\boldsymbol{u}_{raw}||_2 = \\sqrt{1^2 + (-1)^2 + 1^2 + (-1)^2} = \\sqrt{4} = 2$.\n    $\\boldsymbol{u} = \\frac{1}{2} \\boldsymbol{u}_{raw} = \\begin{pmatrix} \\frac{1}{2} & 0 & -\\frac{1}{2} & 0 & \\frac{1}{2} & 0 & -\\frac{1}{2} & 0 \\end{pmatrix}^{\\mathsf{T}}$.\n*   **Internal Energy:**\n    $U = \\frac{1}{2}\\boldsymbol{u}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{u}$.\n    With one-point quadrature, the stiffness matrix is $\\boldsymbol{K} = V_q \\boldsymbol{B}(0,0)^{\\mathsf{T}} \\boldsymbol{D} \\boldsymbol{B}(0,0)$, where $V_q = w \\det(\\boldsymbol{J}) t = 4 L^2 t$.\n    $U = \\frac{1}{2} \\boldsymbol{u}^{\\mathsf{T}} (4 L^2 t \\boldsymbol{B}(0,0)^{\\mathsf{T}} \\boldsymbol{D} \\boldsymbol{B}(0,0)) \\boldsymbol{u}$\n    $U = 2 L^2 t (\\boldsymbol{B}(0,0)\\boldsymbol{u})^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{B}(0,0)\\boldsymbol{u})$.\n    By construction, the chosen $\\boldsymbol{u}$ is an hourglass mode, so $\\boldsymbol{B}(0,0)\\boldsymbol{u} = \\boldsymbol{0}$.\n    $U = 2 L^2 t (\\boldsymbol{0})^{\\mathsf{T}} \\boldsymbol{D} (\\boldsymbol{0}) = 0$.\n*   **Final Answer:**\n    The vector components are $\\frac{1}{2}, 0, -\\frac{1}{2}, 0, \\frac{1}{2}, 0, -\\frac{1}{2}, 0$.\n    The energy is $U=0$.\n    The final answer is a row matrix: $\\begin{pmatrix} \\frac{1}{2} & 0 & -\\frac{1}{2} & 0 & \\frac{1}{2} & 0 & -\\frac{1}{2} & 0 & 0 \\end{pmatrix}$.\n\nThe logic holds. I'll write the solution formally now.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & 0 & -\\frac{1}{2} & 0 & \\frac{1}{2} & 0 & -\\frac{1}{2} & 0 & 0 \\end{pmatrix}}\n$$", "id": "3555206"}, {"introduction": "Before implementing methods to suppress hourglassing, it is essential to ensure that the underlying element formulation is consistent. Any valid finite element must be able to exactly reproduce a state of constant strain, a property verified by the classic \"patch test.\" This practice guides you through performing a patch test on a small assembly of elements to prove that the one-point quadrature scheme is exact for linear displacement fields, a fundamental property that any hourglass stabilization technique must preserve [@problem_id:3555182].", "problem": "Consider a homogeneous, isotropic, linear elastic medium in small-strain, two-dimensional plane strain. The constitutive relation is given by a constant elasticity tensor, and the Cauchy stress field is computed from the strain through the usual linear mapping. A mesh patch consists of a $2 \\times 2$ array of undistorted, axis-aligned bilinear quadrilateral elements (bilinear quadrilateral element (Q1)) that tile the square region $\\Omega = [-a,a] \\times [-a,a]$. Each element is a square of side length $a$, so the four elements occupy the quadrants $(-a,0) \\times (-a,0)$, $(0,a) \\times (-a,0)$, $(-a,0) \\times (0,a)$, and $(0,a) \\times (0,a)$. Let the global nodal matrix include the $3 \\times 3$ grid of nodes at the coordinates $(x,y) \\in \\{-a,0,a\\} \\times \\{-a,0,a\\}$, and label the central interior node at $(0,0)$ as node $I$.\n\nImpose the exact linear displacement field\n$$\nu(x,y) = \\alpha_{0} + \\alpha_{1} x + \\alpha_{2} y, \\qquad v(x,y) = \\beta_{0} + \\beta_{1} x + \\beta_{2} y,\n$$\nwith constants $\\alpha_{0}, \\alpha_{1}, \\alpha_{2}, \\beta_{0}, \\beta_{1}, \\beta_{2} \\in \\mathbb{R}$. There are no body forces, and boundary tractions are assumed to be such that the patch is in equilibrium with the constant stress field induced by the imposed displacement. Use one-point reduced Gaussian integration per element, with the parent-space integration point at $(\\xi,\\eta) = (0,0)$ and its associated weight, and an affine isoparametric mapping for each element from the parent square $[-1,1] \\times [-1,1]$ to the physical element.\n\nFor each of the four elements adjacent to node $I$, assemble the internal nodal force contribution at node $I$ using the weak form of linear elasticity with the standard bilinear shape functions and the small-strain definition. Then sum these four contributions to obtain the residual internal nodal force vector at node $I$ over the patch. Assume an hourglass control scheme whose stabilization force contribution vanishes for any displacement field that is at most linear in the physical coordinates, and include it in the assessment.\n\nCompute the Euclidean norm of the residual internal nodal force vector at node $I$ over the patch (including the hourglass control contribution). Express your final answer as a single real number in Newtons. If the value is nonzero, round your answer to four significant figures; otherwise, report the exact value.", "solution": "The user wants me to solve a problem related to computational geomechanics.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Medium and Mechanics**: A homogeneous, isotropic, linear elastic medium in small-strain, two-dimensional plane strain. The constitutive relation is a constant elasticity tensor.\n*   **Mesh Geometry**: A $2 \\times 2$ array of undistorted, axis-aligned bilinear quadrilateral elements (Q1) tiling the square region $\\Omega = [-a,a] \\times [-a,a]$.\n*   **Elements**: Four square elements of side length $a$.\n*   **Nodal Layout**: A $3 \\times 3$ grid of nodes at coordinates $(x,y) \\in \\{-a,0,a\\} \\times \\{-a,0,a\\}$. The central interior node at $(0,0)$ is labeled node $I$.\n*   **Displacement Field**: An imposed exact linear displacement field:\n    $$ u(x,y) = \\alpha_{0} + \\alpha_{1} x + \\alpha_{2} y $$\n    $$ v(x,y) = \\beta_{0} + \\beta_{1} x + \\beta_{2} y $$\n    where $\\alpha_{0}, \\alpha_{1}, \\alpha_{2}, \\beta_{0}, \\beta_{1}, \\beta_{2}$ are real constants.\n*   **Loading**: No body forces. Boundary tractions are consistent with the imposed field and ensure equilibrium.\n*   **Numerical Integration**: One-point reduced Gaussian integration per element at the parent-space point $(\\xi,\\eta) = (0,0)$.\n*   **Element Formulation**: Affine isoparametric mapping from the parent square $[-1,1] \\times [-1,1]$.\n*   **Hourglass Control**: An hourglass control scheme is assumed, with the property that its stabilization force contribution vanishes for any displacement field that is at most linear in physical coordinates.\n*   **Objective**: Compute the Euclidean norm of the residual internal nodal force vector at node $I$ (including the hourglass control contribution).\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding**: The problem is located squarely within the established theory of the Finite Element Method (FEM) as applied to linear elasticity. Concepts such as bilinear quadrilateral elements, reduced integration, isoparametric mapping, and hourglass control are standard in computational mechanics. The scenario described is a classic \"patch test,\" a fundamental verification procedure for finite element formulations. The problem is scientifically sound.\n*   **Well-Posedness**: The problem is well-posed. It provides all necessary information (geometry, element type, integration rule, displacement field) to calculate the requested quantity. The existence of a unique, meaningful solution is guaranteed.\n*   **Objectivity**: The problem is stated in precise, objective, and technical language, free from any subjectivity or ambiguity.\n*   **Consistency and Completeness**: The problem setup is self-contained and consistent. The specified linear displacement field induces a constant strain and stress state. The task is to verify if the chosen numerical method (Q1 element with 1-point integration) can exactly represent this state, which manifests as zero residual forces at internal nodes. The mention of \"Newtons\" for the unit of the final answer is slightly superfluous given the symbolic nature of the material properties and displacement coefficients, but it does not create a contradiction, as a result of zero is unit-independent.\n\n**Step 3: Verdict and Action**\n\n*   **Verdict**: The problem is **valid**.\n*   **Action**: Proceed with the detailed solution.\n\n### Solution\n\nThe problem asks for the calculation of the residual internal nodal force at the central node of a $2 \\times 2$ patch of bilinear quadrilateral elements subjected to a linear displacement field. This is a classic patch test, designed to verify an element's ability to exactly reproduce a state of constant strain.\n\nFirst, let's analyze the strain state resulting from the imposed linear displacement field:\n$$ u(x,y) = \\alpha_{0} + \\alpha_{1} x + \\alpha_{2} y $$\n$$ v(x,y) = \\beta_{0} + \\beta_{1} x + \\beta_{2} y $$\nThe components of the small-strain tensor $\\boldsymbol{\\epsilon}$ are:\n$$ \\epsilon_{xx} = \\frac{\\partial u}{\\partial x} = \\alpha_{1} $$\n$$ \\epsilon_{yy} = \\frac{\\partial v}{\\partial y} = \\beta_{2} $$\n$$ \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = \\alpha_{2} + \\beta_{1} $$\nSince $\\alpha_{1}, \\alpha_{2}, \\beta_{1}, \\beta_{2}$ are constants, the strain field is uniform throughout the domain $\\Omega$. Because the material is homogeneous and linear elastic, the Cauchy stress field $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\epsilon}$ (where $\\mathbf{D}$ is the constant elasticity tensor) is also uniform throughout the patch. Let this constant stress vector be denoted by $\\boldsymbol{\\sigma}_{0}$.\n\nThe internal force vector for a single finite element $(e)$ is computed by integrating the stress against the derivatives of the shape functions over the element's domain:\n$$ \\mathbf{f}_{\\text{int}}^{(e)} = \\int_{\\Omega^{(e)}} \\mathbf{B}^{T} \\boldsymbol{\\sigma} \\, d\\Omega $$\nHere, $\\mathbf{B}$ is the strain-displacement matrix, which relates nodal displacements to strains. Using an isoparametric mapping from the parent element domain $\\Omega_{p} = [-1,1] \\times [-1,1]$, this integral becomes:\n$$ \\mathbf{f}_{\\text{int}}^{(e)} = \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}^{T}(\\xi, \\eta) \\boldsymbol{\\sigma}(\\xi, \\eta) \\det(\\mathbf{J}) \\, d\\xi \\, d\\eta $$\nThe problem specifies one-point Gaussian quadrature. This approximates the integral by evaluating the integrand at the center of the parent element, $(\\xi, \\eta) = (0,0)$, and multiplying by the area of the integration domain, which is $2 \\times 2 = 4$.\n$$ \\mathbf{f}_{\\text{int}}^{(e)} \\approx \\left[ \\mathbf{B}^{T}(0,0) \\boldsymbol{\\sigma}(0,0) \\det(\\mathbf{J}(0,0)) \\right] \\times 4 $$\nSince the stress field $\\boldsymbol{\\sigma}$ is constant, $\\boldsymbol{\\sigma}(0,0) = \\boldsymbol{\\sigma}_{0}$. For the undistorted square elements of side $a$, the Jacobian matrix $\\mathbf{J}$ is constant and diagonal, $\\mathbf{J} = \\text{diag}(a/2, a/2)$, so its determinant is $\\det(\\mathbf{J}) = a^2/4$. The element area is $A^{(e)} = a^2$. The approximation is thus:\n$$ \\mathbf{f}_{\\text{int}}^{(e)} = \\mathbf{B}^{T}(0,0) \\boldsymbol{\\sigma}_{0} \\left(\\frac{a^2}{4}\\right) (4) = a^2 \\mathbf{B}^{T}(0,0) \\boldsymbol{\\sigma}_{0} $$\nThis result is exact because the integrand is constant.\n\nThe strain-displacement matrix $\\mathbf{B}$ for a four-node element is an assembly of matrices $\\mathbf{B}_j$ for each node $j=1,2,3,4$: $\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]$. The matrix for node $j$ is:\n$$ \\mathbf{B}_j = \\begin{pmatrix} \\frac{\\partial N_j}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_j}{\\partial y} \\\\ \\frac{\\partial N_j}{\\partial y} & \\frac{\\partial N_j}{\\partial x} \\end{pmatrix} $$\nThe spatial derivatives of the shape functions $N_j$ are found via the chain rule using the inverse Jacobian $\\mathbf{J}^{-1} = \\text{diag}(2/a, 2/a)$:\n$$ \\begin{Bmatrix} \\frac{\\partial N_j}{\\partial x} \\\\ \\frac{\\partial N_j}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_j}{\\partial \\xi} \\\\ \\frac{\\partial N_j}{\\partial \\eta} \\end{Bmatrix} $$\nThe shape functions are $N_j(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_j \\xi)(1+\\eta_j \\eta)$. Their derivatives at $(\\xi, \\eta)=(0,0)$ are:\n$$ \\left. \\frac{\\partial N_j}{\\partial \\xi} \\right|_{(0,0)} = \\frac{\\xi_j}{4}, \\quad \\left. \\frac{\\partial N_j}{\\partial \\eta} \\right|_{(0,0)} = \\frac{\\eta_j}{4} $$\nwhere $(\\xi_j, \\eta_j)$ are the coordinates of node $j$ in the parent element. Thus, at the integration point:\n$$ \\left. \\frac{\\partial N_j}{\\partial x} \\right|_{(0,0)} = \\frac{2}{a} \\left(\\frac{\\xi_j}{4}\\right) = \\frac{\\xi_j}{2a}, \\quad \\left. \\frac{\\partial N_j}{\\partial y} \\right|_{(0,0)} = \\frac{2}{a} \\left(\\frac{\\eta_j}{4}\\right) = \\frac{\\eta_j}{2a} $$\nThe internal force contribution from element $(e)$ to its local node $j$ is $\\mathbf{f}_{j, \\text{int}}^{(e)} = a^2 \\mathbf{B}_j^{T}(0,0) \\boldsymbol{\\sigma}_{0}$.\n\nThe central global node $I$ at $(0,0)$ is shared by all four elements. We must sum the force contributions from each element at this node. We identify the local node number corresponding to node $I$ for each of the four elements (using a counter-clockwise local numbering starting from the parent element's $(-\\!1,-\\!1)$ corner):\n*   Element 1 (top-right, $[0,a]\\!\\times\\![0,a]$): Node $I$ at $(0,0)$ is local node 1, with parent coordinates $(\\xi_1, \\eta_1)=(-1,-1)$.\n*   Element 2 (top-left, $[-a,0]\\!\\times\\![0,a]$): Node $I$ at $(0,0)$ is local node 2, with parent coordinates $(\\xi_2, \\eta_2)=(1,-1)$.\n*   Element 3 (bottom-left, $[-a,0]\\!\\times\\![-a,0]$): Node $I$ at $(0,0)$ is local node 3, with parent coordinates $(\\xi_3, \\eta_3)=(1,1)$.\n*   Element 4 (bottom-right, $[0,a]\\!\\times\\![-a,0]$): Node $I$ at $(0,0)$ is local node 4, with parent coordinates $(\\xi_4, \\eta_4)=(-1,1)$.\n\nThe total internal force vector at node $I$ is the sum of these contributions:\n$$ \\mathbf{F}_{I, \\text{int}} = \\mathbf{f}_{1, \\text{int}}^{(1)} + \\mathbf{f}_{2, \\text{int}}^{(2)} + \\mathbf{f}_{3, \\text{int}}^{(3)} + \\mathbf{f}_{4, \\text{int}}^{(4)} $$\n$$ \\mathbf{F}_{I, \\text{int}} = a^2 \\left( \\mathbf{B}_1^{(1)T}(0,0) + \\mathbf{B}_2^{(2)T}(0,0) + \\mathbf{B}_3^{(3)T}(0,0) + \\mathbf{B}_4^{(4)T}(0,0) \\right) \\boldsymbol{\\sigma}_{0} $$\nThe term in parentheses is the sum of the transposed $\\mathbf{B}_j$ matrices:\n$$ \\sum_{\\text{elements}} \\mathbf{B}_j^{T} = \\sum_j \\begin{pmatrix} \\frac{\\partial N_j}{\\partial x} & \\frac{\\partial N_j}{\\partial y} & \\frac{\\partial N_j}{\\partial y} \\\\ 0 & 0 & \\frac{\\partial N_j}{\\partial x} \\end{pmatrix} \\rightarrow \\text{transposed seems wrong, let's recheck.} $$\nAh, wait. The structure of $\\mathbf{B}_j$ is for a vector of displacements. The contribution to the force vector $\\mathbf{f}_j = (f_{jx}, f_{jy})^T$ from a stress vector $\\boldsymbol{\\sigma} = (\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy})^T$ is through $\\mathbf{B}_j^T \\boldsymbol{\\sigma}$. Let's write $\\mathbf{B}_j^T$:\n$$ \\mathbf{B}_j^T(0,0) = \\begin{pmatrix} \\frac{\\partial N_j}{\\partial x} & 0 & \\frac{\\partial N_j}{\\partial y} \\\\ 0 & \\frac{\\partial N_j}{\\partial y} & \\frac{\\partial N_j}{\\partial x} \\end{pmatrix}_{(0,0)} = \\frac{1}{2a} \\begin{pmatrix} \\xi_j & 0 & \\eta_j \\\\ 0 & \\eta_j & \\xi_j \\end{pmatrix} $$\nNow we sum this matrix for the four local nodes corresponding to node $I$:\n$$ \\sum_{j \\in \\{1,2,3,4\\}} \\mathbf{B}_j^T(0,0) = \\frac{1}{2a} \\left[ \\begin{pmatrix} -1 & 0 & -1 \\\\ 0 & -1 & -1 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix} + \\begin{pmatrix} -1 & 0 & 1 \\\\ 0 & 1 & -1 \\end{pmatrix} \\right] $$\nSumming the components of the matrices:\n*   Entry (1,1): $(-1)+1+1+(-1)=0$\n*   Entry (1,2): $0+0+0+0=0$\n*   Entry (1,3): $(-1)+(-1)+1+1=0$\n*   Entry (2,1): $0+0+0+0=0$\n*   Entry (2,2): $(-1)+(-1)+1+1=0$\n*   Entry (2,3): $(-1)+1+1+(-1)=0$\nThe sum is the zero matrix:\n$$ \\sum_{j \\in \\{1,2,3,4\\}} \\mathbf{B}_j^{T}(0,0) = \\frac{1}{2a} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\mathbf{0}^{2 \\times 3} $$\nTherefore, the total internal force from the element stiffness is zero:\n$$ \\mathbf{F}_{I, \\text{int}} = a^2 (\\mathbf{0}^{2 \\times 3}) \\boldsymbol{\\sigma}_{0} = \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} $$\nNext, we consider the hourglass stabilization force, $\\mathbf{F}_{I, \\text{stab}}$. The problem states that the hourglass control scheme is designed such that its force contribution \"vanishes for any displacement field that is at most linear in the physical coordinates\". The imposed displacement field is linear, so by definition:\n$$ \\mathbf{F}_{I, \\text{stab}} = \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} $$\nThe total residual internal nodal force vector at node $I$ is the sum of the standard contribution and the stabilization contribution:\n$$ \\mathbf{F}_{I, \\text{residual}} = \\mathbf{F}_{I, \\text{int}} + \\mathbf{F}_{I, \\text{stab}} = \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} + \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} = \\begin{Bmatrix} 0 \\\\ 0 \\end{Bmatrix} $$\nThe problem asks for the Euclidean norm of this vector:\n$$ ||\\mathbf{F}_{I, \\text{residual}}||_2 = \\sqrt{0^2 + 0^2} = 0 $$\nThe result is exactly zero, which confirms that this element formulation passes the patch test. The result is independent of the material properties, the element size $a$, and the specific coefficients of the linear displacement field.", "answer": "$$\n\\boxed{0}\n$$", "id": "3555182"}, {"introduction": "Having identified zero-energy modes and established the crucial consistency requirement, we now advance to a more realistic three-dimensional scenario. This comprehensive problem synthesizes the core concepts of the topic by extending the analysis to a distorted 8-node brick element, which features a richer family of hourglass modes. You will not only derive the mathematical basis for these 3D modes but also engage with a practical stabilization scheme, bridging the gap between theory and quantitative application in geomechanics [@problem_id:3555190].", "problem": "Consider a three-dimensional eight-node trilinear isoparametric brick element ($Q_1$) used in the Finite Element Method (FEM) for a geomechanics application. The parent coordinates are $(\\xi,\\eta,\\zeta) \\in [-1,1]^3$, and the nodal parent-coordinate signs are $\\xi_a,\\eta_a,\\zeta_a \\in \\{-1,+1\\}$ for node index $a=1,\\dots,8$, following the conventional $Q_1$ vertex layout. The trilinear shape functions are\n$$\nN_a(\\xi,\\eta,\\zeta) = \\frac{1}{8}(1+\\xi_a \\xi)(1+\\eta_a \\eta)(1+\\zeta_a \\zeta).\n$$\nThe isoparametric mapping to physical coordinates is defined by the nodal positions $\\boldsymbol{x}_a$; its Jacobian at the element center $(\\xi,\\eta,\\zeta)=(0,0,0)$ is the $3 \\times 3$ matrix $\\boldsymbol{J}$ with entries in meters given by\n$$\n\\boldsymbol{J} = \\begin{pmatrix}\n1.2 & 0.3 & 0 \\\\\n0.1 & 0.9 & 0.2 \\\\\n0 & 0.25 & 1.1\n\\end{pmatrix}.\n$$\nThis element employs reduced integration with a single Gauss point at the center. The symmetric gradient operator in physical coordinates is\n$$\n\\nabla^s \\boldsymbol{u} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}),\n$$\nwhere $\\boldsymbol{u}$ is the displacement field.\n\nStarting from the definitions above and only fundamental finite element identities such as $\\nabla N_a = \\boldsymbol{J}^{-T} \\nabla_{\\widehat{\\boldsymbol{x}}} N_a$ at the Gauss point, and the trilinear shape function derivatives at the center $\\frac{\\partial N_a}{\\partial \\xi}\\big|_{0} = \\xi_a/8$, $\\frac{\\partial N_a}{\\partial \\eta}\\big|_{0} = \\eta_a/8$, $\\frac{\\partial N_a}{\\partial \\zeta}\\big|_{0} = \\zeta_a/8$, do the following:\n\n1. Derive the complete set of scalar hourglass basis patterns $h^{\\alpha}_a \\in \\{-1,+1\\}$ for $\\alpha=1,2,3,4$ that yield zero gradient at the Gauss point in the parent coordinate space, i.e., satisfy $\\sum_{a=1}^{8} h^{\\alpha}_a\\,\\xi_a = \\sum_{a=1}^{8} h^{\\alpha}_a\\,\\eta_a = \\sum_{a=1}^{8} h^{\\alpha}_a\\,\\zeta_a = 0$. Explain why these patterns still produce $\\nabla^s \\boldsymbol{u}=\\boldsymbol{0}$ at the reduced integration point in the physical space under the given isoparametric distortion $\\boldsymbol{J}$.\n\n2. Extend these scalar patterns to the vector-valued displacement setting to enumerate the $12$ zero-energy hourglass vectors for the $Q_1$ brick under reduced integration, by assigning each scalar pattern to exactly one Cartesian component of displacement at a time.\n\n3. Design an explicit displacement field $\\boldsymbol{u}(\\xi,\\eta,\\zeta)$ that excites exactly one of the $12$ vector hourglass modes while ensuring $\\nabla^s \\boldsymbol{u}=\\boldsymbol{0}$ at the reduced integration point. Let the chosen mode be the Cartesian $x$-component with the scalar pattern $h^{4}_a = \\xi_a \\eta_a \\zeta_a$. Represent $\\boldsymbol{u}$ in terms of a single amplitude parameter $\\alpha$ and the scalar pattern, and write the corresponding nodal displacement values $\\boldsymbol{u}_a$.\n\n4. Consider a Flanagan–Belytschko-type hourglass control penalty with energy\n$$\nE_{h} \\,=\\, \\beta\\, G\\, \\frac{V}{\\ell^{2}}\\, q^{2},\n$$\nwhere $G$ is the shear modulus, $V$ is the element volume approximated by $V \\approx 8\\,\\det(\\boldsymbol{J})$, $\\ell$ is a characteristic length defined by $\\ell^{2} = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{J}^{T}\\boldsymbol{J})$, $\\beta$ is a dimensionless stabilization parameter, and $q$ is the scalar hourglass measure for the chosen mode defined by\n$$\nq \\,=\\, \\frac{1}{8}\\sum_{a=1}^{8} h^{4}_a\\, u_{a,x},\n$$\nwith $u_{a,x}$ the $x$-component of the nodal displacement at node $a$. Assume $G = 25 \\times 10^{6}\\,\\text{Pa}$ and $\\beta = 0.25$.\n\nImpose a target hourglass control energy $E_h^{\\star} = 1.5\\,\\text{kJ}$ for the chosen single mode and compute the required amplitude $\\alpha$ so that $E_h = E_h^{\\star}$. Use the given $\\boldsymbol{J}$. Express the final amplitude in meters and round your answer to four significant figures.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, objective, and internally consistent, containing all necessary information for a unique solution. The definitions and parameter values are standard and physically realistic within the context of computational geomechanics. We may therefore proceed with a full solution.\n\nThe solution is presented in four parts, corresponding to the four tasks in the problem statement.\n\n**Part 1: Derivation of Scalar Hourglass Patterns and Strain-Free Condition**\n\nAn hourglass mode is a nodal displacement pattern that results in zero strain at the single Gauss point located at the element center $(\\xi,\\eta,\\zeta)=(0,0,0)$. The displacement field $\\boldsymbol{u}$ is interpolated from nodal displacements $\\boldsymbol{u}_a$ via the shape functions $N_a$: $\\boldsymbol{u}(\\xi,\\eta,\\zeta) = \\sum_{a=1}^{8} N_a(\\xi,\\eta,\\zeta) \\boldsymbol{u}_a$.\nFirst, consider a scalar field $u(\\xi,\\eta,\\zeta) = \\sum_{a=1}^{8} N_a(\\xi,\\eta,\\zeta) u_a$. Its gradient with respect to the parent coordinates $(\\xi, \\eta, \\zeta)$ is $\\nabla_{\\boldsymbol{\\xi}} u = \\sum_{a=1}^{8} u_a \\nabla_{\\boldsymbol{\\xi}} N_a$. At the element center, the gradient of the shape function for node $a$ is given by the problem statement as $\\nabla_{\\boldsymbol{\\xi}} N_a \\rvert_{(0,0,0)} = \\frac{1}{8}(\\xi_a, \\eta_a, \\zeta_a)^{\\top}$.\nTherefore, the gradient of the scalar field at the center is:\n$$\n\\nabla_{\\boldsymbol{\\xi}} u \\bigg|_{(0,0,0)} = \\sum_{a=1}^{8} u_a \\left(\\frac{1}{8}(\\xi_a, \\eta_a, \\zeta_a)^{\\top}\\right) = \\frac{1}{8} \\begin{pmatrix} \\sum_{a=1}^{8} u_a \\xi_a \\\\ \\sum_{a=1}^{8} u_a \\eta_a \\\\ \\sum_{a=1}^{8} u_a \\zeta_a \\end{pmatrix}\n$$\nFor this gradient to be the zero vector, the nodal displacement pattern $\\{u_a\\}_{a=1}^8$ must be orthogonal to the three nodal vectors defined by the parent coordinates, $\\{\\xi_a\\}$, $\\{\\eta_a\\}$, and $\\{\\zeta_a\\}$. The problem seeks four such patterns, denoted $h^{\\alpha}_a \\in \\{-1,+1\\}$ for $\\alpha=1,2,3,4$, satisfying:\n$$\n\\sum_{a=1}^{8} h^{\\alpha}_a\\,\\xi_a = 0, \\quad \\sum_{a=1}^{8} h^{\\alpha}_a\\,\\eta_a = 0, \\quad \\sum_{a=1}^{8} h^{\\alpha}_a\\,\\zeta_a = 0\n$$\nThese conditions define the hourglass patterns. The space of nodal vectors in $\\mathbb{R}^8$ that are orthogonal to the three vectors $\\{\\xi_a\\}$, $\\{\\eta_a\\}$, and $\\{\\zeta_a\\}$ is of dimension $8-3=5$. A basis for this space also includes the constant vector $\\{1,1, ..., 1\\}$, which corresponds to rigid body translation and yields a zero gradient. The remaining four basis vectors constitute the hourglass modes. A standard, mutually orthogonal set of such patterns with entries in $\\{-1,+1\\}$ is constructed from products of the coordinate signs:\n$$\nh^{1}_a = \\xi_a \\eta_a \\\\\nh^{2}_a = \\eta_a \\zeta_a \\\\\nh^{3}_a = \\zeta_a \\xi_a \\\\\nh^{4}_a = \\xi_a \\eta_a \\zeta_a\n$$\nTo verify, take $h^{1}_a = \\xi_a \\eta_a$ as an example. The orthogonality conditions are checked:\n$\\sum_{a=1}^{8} (\\xi_a \\eta_a) \\xi_a = \\sum_{a=1}^{8} \\xi_a^2 \\eta_a = \\sum_{a=1}^{8} \\eta_a = 0$, since there are four nodes with $\\eta_a=+1$ and four nodes with $\\eta_a=-1$. Similarly, $\\sum_{a=1}^{8} (\\xi_a \\eta_a) \\eta_a = \\sum_{a=1}^{8} \\xi_a \\eta_a^2 = \\sum_{a=1}^{8} \\xi_a = 0$. Finally, $\\sum_{a=1}^{8} (\\xi_a \\eta_a) \\zeta_a=0$, because for each pair of $(\\xi_a, \\eta_a)$ values, there is one node with $\\zeta_a=+1$ and one with $\\zeta_a=-1$, causing the terms to cancel in pairs. Similar arguments hold for $h^2_a$, $h^3_a$, and $h^4_a$. This completes the derivation of the four scalar patterns.\n\nNext, we explain why these patterns produce a zero symmetric gradient, $\\nabla^s \\boldsymbol{u}=\\boldsymbol{0}$, in the physical space.\nLet the displacement field be a vector field $\\boldsymbol{u}$. The gradient of $\\boldsymbol{u}$ with respect to parent coordinates, $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}$, is related to the gradient with respect to physical coordinates, $\\nabla \\boldsymbol{u}$, by the chain rule: $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = (\\nabla \\boldsymbol{u}) \\boldsymbol{J}$.\nThis implies $\\nabla \\boldsymbol{u} = (\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}) \\boldsymbol{J}^{-1}$, provided the Jacobian $\\boldsymbol{J}$ is invertible.\nAn hourglass displacement mode is formed by setting the nodal displacements of one Cartesian component, say $u_x$, to a scalar hourglass pattern, e.g., $u_{a,x} = c\\,h^{\\alpha}_a$, and other components to zero.\nAt the center, the gradient of this component with respect to parent coordinates vanishes, as shown above: $\\nabla_{\\boldsymbol{\\xi}} u_x \\rvert_0 = \\boldsymbol{0}^{\\top}$. If all three components of displacement follow some scalar hourglass pattern (not necessarily the same one), then each row of the matrix $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}$ will be a zero vector at the center. Thus, $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}\\rvert_0 = \\boldsymbol{0}_{3\\times3}$.\nConsequently, the gradient in physical coordinates at the center is also the zero matrix:\n$$\n\\nabla \\boldsymbol{u} \\bigg|_{(0,0,0)} = (\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} \\rvert_{(0,0,0)}) \\boldsymbol{J}^{-1} = \\boldsymbol{0}_{3\\times3} \\cdot \\boldsymbol{J}^{-1} = \\boldsymbol{0}_{3\\times3}\n$$\nThe symmetric gradient operator is $\\nabla^s \\boldsymbol{u} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})$. If $\\nabla \\boldsymbol{u}\\rvert_0 = \\boldsymbol{0}$, it immediately follows that $\\nabla^s \\boldsymbol{u}\\rvert_0 = \\boldsymbol{0}$. This result is independent of the specific distortion matrix $\\boldsymbol{J}$, as long as it is non-singular.\n\n**Part 2: Enumeration of Vector Hourglass Modes**\n\nThe element has $8$ nodes with $3$ displacement degrees of freedom (DOFs) each, totaling $24$ DOFs. The state at the single integration point is described by the $3 \\times 3 = 9$ components of the displacement gradient tensor $\\nabla \\boldsymbol{u}$. The number of deformation modes that are not \"seen\" by the integration point is $24 - 9 = 15$. These are the zero-energy modes under reduced integration. These $15$ modes comprise $3$ rigid-body translations and $12$ internal kinematic modes, which are the hourglass modes.\n\nThe $12$ vector-valued hourglass modes can be systematically enumerated from the $4$ scalar patterns derived in Part 1. Each scalar pattern can be applied to any of the three Cartesian displacement components ($x$, $y$, or $z$), with the other two components being zero for all nodes.\nLet $\\boldsymbol{e}_x, \\boldsymbol{e}_y, \\boldsymbol{e}_z$ be the standard Cartesian basis vectors. The $12$ vector hourglass modes, described by their nodal displacement vectors $\\boldsymbol{u}_a$, are:\n\\begin{enumerate}\n    \\item 4 modes for the $x$-component: $\\{\\boldsymbol{u}_a = h^{\\alpha}_a \\boldsymbol{e}_x\\}_{a=1}^8$ for $\\alpha \\in \\{1,2,3,4\\}$.\n    \\item 4 modes for the $y$-component: $\\{\\boldsymbol{u}_a = h^{\\alpha}_a \\boldsymbol{e}_y\\}_{a=1}^8$ for $\\alpha \\in \\{1,2,3,4\\}$.\n    \\item 4 modes for the $z$-component: $\\{\\boldsymbol{u}_a = h^{\\alpha}_a \\boldsymbol{e}_z\\}_{a=1}^8$ for $\\alpha \\in \\{1,2,3,4\\}$.\n\\end{enumerate}\nThis constitutes a basis of $4 \\times 3 = 12$ linearly independent vectors for the hourglass mode subspace.\n\n**Part 3: Displacement Field for a Specific Hourglass Mode**\n\nWe are asked to construct the displacement field for the mode corresponding to the Cartesian $x$-component with the scalar pattern $h^{4}_a = \\xi_a \\eta_a \\zeta_a$. The nodal displacements are given by $\\boldsymbol{u}_a = (\\alpha h^4_a, 0, 0) = (\\alpha \\xi_a \\eta_a \\zeta_a, 0, 0)$, where $\\alpha$ is a scalar amplitude.\nThe displacement field $\\boldsymbol{u}(\\xi,\\eta,\\zeta)$ is found by interpolation:\n$$\n\\boldsymbol{u}(\\xi,\\eta,\\zeta) = \\sum_{a=1}^{8} N_a(\\xi,\\eta,\\zeta) \\boldsymbol{u}_a\n$$\nThe $y$- and $z$-components are zero. The $x$-component is:\n$$\nu_x(\\xi,\\eta,\\zeta) = \\sum_{a=1}^{8} N_a(\\xi,\\eta,\\zeta) (\\alpha \\xi_a \\eta_a \\zeta_a) = \\alpha \\sum_{a=1}^{8} \\frac{1}{8}(1+\\xi_a \\xi)(1+\\eta_a \\eta)(1+\\zeta_a \\zeta) (\\xi_a \\eta_a \\zeta_a)\n$$\nExpanding the product and using $\\xi_a^2=\\eta_a^2=\\zeta_a^2=1$:\n$$\nu_x(\\xi,\\eta,\\zeta) = \\frac{\\alpha}{8} \\sum_{a=1}^{8} (\\xi_a\\eta_a\\zeta_a + \\eta_a\\zeta_a \\xi + \\xi_a\\zeta_a \\eta + \\xi_a\\eta_a \\zeta + \\zeta_a \\xi\\eta + \\xi_a \\eta\\zeta + \\eta_a \\xi\\zeta + \\xi\\eta\\zeta)\n$$\nUpon summing over all $8$ nodes ($a=1, \\dots, 8$), all terms involving products of one or two distinct coordinate signs sum to zero (e.g., $\\sum_a \\xi_a = 0$, $\\sum_a \\xi_a\\eta_a = 0$). Even the term $\\sum_a \\xi_a\\eta_a\\zeta_a$ is zero. The only term whose sum is non-zero is the final term, $\\xi\\eta\\zeta$, which is constant with respect to the summation index $a$:\n$$\n\\sum_{a=1}^{8} \\xi\\eta\\zeta = 8\\xi\\eta\\zeta\n$$\nSubstituting this into the expression for $u_x$:\n$$\nu_x(\\xi,\\eta,\\zeta) = \\frac{\\alpha}{8} (8 \\xi\\eta\\zeta) = \\alpha \\xi\\eta\\zeta\n$$\nThus, the displacement field that excites this single hourglass mode is $\\boldsymbol{u}(\\xi,\\eta,\\zeta) = (\\alpha \\xi\\eta\\zeta, 0, 0)$.\nThe corresponding nodal displacements are $\\boldsymbol{u}_a = (\\alpha \\xi_a\\eta_a\\zeta_a, 0, 0)$.\n\n**Part 4: Calculation of Amplitude $\\alpha$**\n\nWe must find the amplitude $\\alpha$ such that the hourglass energy $E_h$ equals a target value $E_h^{\\star} = 1.5\\,\\text{kJ} = 1500\\,\\text{J}$.\nThe hourglass energy is given by $E_{h} = \\beta\\, G\\, \\frac{V}{\\ell^{2}}\\, q^{2}$.\nThe parameters are $\\beta = 0.25$ and $G = 25 \\times 10^{6}\\,\\text{Pa}$.\nWe need to calculate the element volume $V$, the characteristic length squared $\\ell^2$, and the hourglass measure $q$.\n\nThe Jacobian matrix is $\\boldsymbol{J} = \\begin{pmatrix} 1.2 & 0.3 & 0 \\\\ 0.1 & 0.9 & 0.2 \\\\ 0 & 0.25 & 1.1 \\end{pmatrix}$.\nThe element volume $V$ is approximated by $V \\approx 8\\,\\det(\\boldsymbol{J})$.\n$$\n\\det(\\boldsymbol{J}) = 1.2(0.9 \\cdot 1.1 - 0.2 \\cdot 0.25) - 0.3(0.1 \\cdot 1.1 - 0.2 \\cdot 0) = 1.2(0.99 - 0.05) - 0.3(0.11) = 1.2(0.94) - 0.033 = 1.128 - 0.033 = 1.095\n$$\nSo, $V = 8 \\times 1.095 = 8.76\\,\\text{m}^3$.\n\nThe characteristic length squared $\\ell^2$ is $\\ell^{2} = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{J}^{T}\\boldsymbol{J})$. The trace of $\\boldsymbol{J}^{T}\\boldsymbol{J}$ is the sum of the squared norms of the columns of $\\boldsymbol{J}$.\n\\begin{align*}\n\\operatorname{tr}(\\boldsymbol{J}^{T}\\boldsymbol{J}) &= \\sum_{j=1}^{3} \\sum_{i=1}^{3} (J_{ij})^2 \\\\\n&= (1.2^2 + 0.1^2 + 0^2) + (0.3^2 + 0.9^2 + 0.25^2) + (0^2 + 0.2^2 + 1.1^2) \\\\\n&= (1.44 + 0.01) + (0.09 + 0.81 + 0.0625) + (0.04 + 1.21) \\\\\n&= 1.45 + 0.9625 + 1.25 = 3.6625 \\,\\text{m}^2\n\\end{align*}\nSo, $\\ell^2 = \\frac{3.6625}{3} \\,\\text{m}^2 \\approx 1.22083\\,\\text{m}^2$.\n\nThe hourglass measure $q$ is $q = \\frac{1}{8}\\sum_{a=1}^{8} h^{4}_a\\, u_{a,x}$. For the chosen mode, $u_{a,x} = \\alpha h^4_a$.\n$$\nq = \\frac{1}{8}\\sum_{a=1}^{8} h^{4}_a (\\alpha h^4_a) = \\frac{\\alpha}{8}\\sum_{a=1}^{8} (h^{4}_a)^2\n$$\nSince $h^4_a \\in \\{-1, +1\\}$, $(h^4_a)^2 = 1$. Thus, $\\sum_{a=1}^{8} (h^4_a)^2 = 8$.\nThis simplifies to $q = \\frac{\\alpha}{8} \\cdot 8 = \\alpha$.\n\nNow we set the energy equation to the target value and solve for $\\alpha$:\n$$\nE_h^{\\star} = \\beta\\, G\\, \\frac{V}{\\ell^{2}}\\, \\alpha^{2}\n$$\n$$\n1500 = 0.25 \\times (25 \\times 10^6) \\times \\frac{8.76}{3.6625/3} \\times \\alpha^{2}\n$$\n$$\n1500 = (6.25 \\times 10^6) \\times \\frac{8.76 \\times 3}{3.6625} \\times \\alpha^{2}\n$$\n$$\n1500 \\approx (6.25 \\times 10^6) \\times (7.175426) \\times \\alpha^{2}\n$$\n$$\n1500 \\approx (4.484641 \\times 10^7) \\times \\alpha^{2}\n$$\nSolving for $\\alpha^2$:\n$$\n\\alpha^2 = \\frac{1500}{4.484641 \\times 10^7} \\approx 3.344734 \\times 10^{-5} \\,\\text{m}^2\n$$\nTaking the square root to find the amplitude $\\alpha$:\n$$\n\\alpha = \\sqrt{3.344734 \\times 10^{-5}} \\approx 0.00578336\\,\\text{m}\n$$\nRounding to four significant figures, the required amplitude is $\\alpha = 0.005783\\,\\text{m}$.", "answer": "$$\n\\boxed{0.005783}\n$$", "id": "3555190"}]}