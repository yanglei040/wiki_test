{"hands_on_practices": [{"introduction": "Before building a complex numerical model, it's essential to understand the physical scales governing the process. This exercise uses dimensional analysis, a powerful physics-based tool, to derive the characteristic time scale for poroelastic consolidation from first principles. By relating the fundamental parameters of permeability $\\kappa$, fluid viscosity $\\mu_{f}$, storage modulus $M$, and geometry $H_{d}$ to time, you will build intuition for the coupled process and validate your result against the classical Terzaghi solution [@problem_id:3526898].", "problem": "A saturated, homogeneous, isotropic poroelastic layer is modeled using the fully coupled displacement–pressure formulation (commonly called the $u$–$p$ formulation) at small strain. The pore fluid is Newtonian. The governing ingredients are:\n- Linear momentum balance for the solid skeleton, with total stress split into effective stress and pore pressure through Biot’s framework.\n- Mass conservation of fluid with storage described by Biot’s modulus $M$ (defined by the linearized fluid-content relation $\\dot{\\zeta} = \\alpha \\dot{\\varepsilon}_{v} + \\dot{p}/M$, where $\\zeta$ is the fluid content, $\\alpha$ is Biot’s coefficient, $\\varepsilon_{v}$ is the volumetric strain of the skeleton, and $p$ is the pore pressure).\n- Darcy’s law with intrinsic permeability $\\kappa$ and fluid dynamic viscosity $\\mu_{f}$.\n\nConsider one-dimensional primary consolidation of a layer with a characteristic drainage path length $H_{d}$, under double drainage and quasi-static mechanical equilibrium (no inertia). Assume that the material response is linear and that $M$ is the storage modulus relevant for the poroelastic coupling in this setting, so that, for the purpose of dimensional analysis, the only material parameters governing the consolidation time scale are the intrinsic permeability $\\kappa$, the fluid dynamic viscosity $\\mu_{f}$, and Biot’s modulus $M$, along with the sole geometric length scale $H_{d}$.\n\nTasks:\n1) Using Buckingham’s Pi theorem and the above physical setting, derive a characteristic consolidation time scale $t_{c}$ as a function of $\\kappa$, $\\mu_{f}$, $M$, and $H_{d}$. Your derivation must start from the dimensional content of the $u$–$p$ governing equations and should not invoke any pre-assembled consolidation formulas.\n2) Terzaghi’s one-dimensional consolidation theory introduces a dimensionless time factor $T_{v}$ that, for double drainage, tabulates to $T_{v,50} = 0.197$ at the state of $50\\%$ average degree of consolidation (i.e., $U=0.5$). Use this fact to express the time to $50\\%$ consolidation, $t_{50}$, in terms of $\\kappa$, $\\mu_{f}$, $M$, and $H_{d}$, by requiring consistency between your time scale from part (1) and the classical $T_{v}$-based description.\n\nProvide your final answer as a single closed-form algebraic expression for $t_{50}$ in seconds. No numerical substitution is required and no rounding is needed. All symbols must be defined as above; do not introduce new dimensional parameters beyond $\\kappa$, $\\mu_{f}$, $M$, and $H_{d}$ for the final expression.", "solution": "We begin from the coupled structure of the fully coupled displacement–pressure ($u$–$p$) formulation for linear poroelasticity under small strain, quasi-static conditions:\n- Linear momentum balance for the skeleton reads $\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{b} = \\boldsymbol{0}$, with the total stress $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\prime} - \\alpha p \\boldsymbol{I}$, where $\\boldsymbol{\\sigma}^{\\prime}$ is the effective stress and $\\alpha$ is Biot’s coefficient. The effective stress is linearly related to the symmetric strain of displacement, e.g., $\\boldsymbol{\\sigma}^{\\prime} = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ for an elastic tensor $\\mathbb{C}$.\n- Fluid mass conservation employs the fluid content $\\zeta = \\alpha \\varepsilon_{v} + p/M$ so that, in the absence of sources, $\\dot{\\zeta} + \\nabla \\cdot \\boldsymbol{q} = 0$, i.e.,\n$$\n\\alpha \\dot{\\varepsilon}_{v} + \\frac{\\dot{p}}{M} + \\nabla \\cdot \\boldsymbol{q} = 0 .\n$$\n- Darcy’s law for a Newtonian fluid in an isotropic porous medium is $\\boldsymbol{q} = - \\dfrac{\\kappa}{\\mu_{f}} \\nabla p$, where $\\kappa$ is the intrinsic permeability and $\\mu_{f}$ is the fluid dynamic viscosity.\n\nUnder quasi-static conditions, the mechanical equilibrium provides an instantaneous relation between $p$ and the elastic fields; the time dependence in consolidation consequently arises from the diffusion of $p$ through Darcy flow and storage via $M$ and the elastic coupling. For dimensional analysis, the relevant dimensional inputs for the characteristic consolidation time scale are the intrinsic permeability $\\kappa$, the fluid dynamic viscosity $\\mu_{f}$, the storage modulus $M$, and a characteristic length $H_{d}$ associated with the drainage path.\n\nWe apply Buckingham’s Pi theorem. First, list the variables and their dimensions in terms of mass $M$, length $L$, and time $T$:\n- The target time scale $t_{c}$ has dimensions $[t_{c}] = T$.\n- Intrinsic permeability has dimensions $[\\kappa] = L^{2}$.\n- Dynamic viscosity has dimensions $[\\mu_{f}] = M L^{-1} T^{-1}$ (since $\\mathrm{Pa \\cdot s} = \\mathrm{N \\cdot s/m^{2}} = M L^{-1} T^{-1}$).\n- Biot’s modulus has dimensions $[M] = \\mathrm{Pa} = M L^{-1} T^{-2}$.\n- The geometric length has dimensions $[H_{d}] = L$.\n\nWe seek a monomial combination\n$$\nt_{c} \\propto \\kappa^{a} \\, \\mu_{f}^{b} \\, M^{c} \\, H_{d}^{d}\n$$\nsuch that the resulting dimensions are $T$. Write the dimensional equation:\n$$\n[\\kappa]^{a} [\\mu_{f}]^{b} [M]^{c} [H_{d}]^{d} = \\left(L^{2}\\right)^{a} \\left(M L^{-1} T^{-1}\\right)^{b} \\left(M L^{-1} T^{-2}\\right)^{c} \\left(L\\right)^{d} = M^{b+c} \\, L^{2a - b - c + d} \\, T^{-b - 2c}.\n$$\nWe require this to match $T^{1}$, i.e., $M^{0} L^{0} T^{1}$. Hence, we solve\n$$\n\\begin{cases}\nb + c = 0, \\\\\n2a - b - c + d = 0, \\\\\n-b - 2c = 1.\n\\end{cases}\n$$\nFrom $b + c = 0$ we have $b = -c$. The third equation gives $-(-c) - 2c = 1 \\Rightarrow c - 2c = 1 \\Rightarrow -c = 1 \\Rightarrow c = -1$. Therefore $b = 1$. The second equation gives $2a - b - c + d = 0 \\Rightarrow 2a - 1 - (-1) + d = 0 \\Rightarrow 2a + d = 0 \\Rightarrow d = -2a$. One free parameter remains. We choose $a = -1$ to eliminate a negative exponent on time (the conventional choice to place $\\kappa$ in the denominator of the prefactor). Then $d = -2(-1) = 2$. Thus one admissible representation is\n$$\nt_{c} \\sim \\frac{\\mu_{f}}{\\kappa \\, M} \\, H_{d}^{2}.\n$$\nBy Buckingham’s theorem, any other representation equivalent under the single remaining dimensionless group differs by a dimensionless multiplicative constant, which is determined by geometry and boundary conditions. We therefore write\n$$\nt_{c} = C_{g} \\, \\frac{\\mu_{f}}{\\kappa \\, M} \\, H_{d}^{2},\n$$\nwhere $C_{g}$ is a dimensionless geometric factor that depends on drainage configuration and the degree of consolidation chosen to define the characteristic time.\n\nTo connect this to Terzaghi’s one-dimensional consolidation theory, recall that Terzaghi introduces a dimensionless time factor $T_{v}$ (for one-dimensional primary consolidation under linear response and double drainage), and that at $50\\%$ average degree of consolidation the tabulated value is $T_{v,50} = 0.197$. In Terzaghi’s framework, the consolidation time and drainage path enter only through the dimensionless group $T_{v}$, so consistency with the above scaling requires\n$$\nt = \\frac{T_{v}}{c_{v}} \\, H_{d}^{2},\n$$\nwhere $c_{v}$ is the consolidation diffusivity that dimensional analysis predicts must scale as\n$$\nc_{v} \\sim \\frac{\\kappa \\, M}{\\mu_{f}}.\n$$\nIdentifying the constant to match the canonical one-dimensional solution fixes the geometric factor for the chosen consolidation state. Specifically, for $U = 0.5$ under double drainage, $T_{v,50} = 0.197$, so the time to $50\\%$ consolidation is\n$$\nt_{50} = \\frac{T_{v,50} \\, H_{d}^{2}}{c_{v}} = 0.197 \\, \\frac{\\mu_{f}}{\\kappa \\, M} \\, H_{d}^{2}.\n$$\n\nThis expression displays the requested dependence: the time grows linearly with fluid viscosity $\\mu_{f}$ and with the square of the drainage path $H_{d}^{2}$, and it decreases with intrinsic permeability $\\kappa$ and Biot’s modulus $M$. The dimensionless factor $0.197$ encapsulates the geometry, boundary conditions, and the chosen average degree of consolidation. The units are seconds when $\\mu_{f}$ is in $\\mathrm{Pa \\cdot s}$, $\\kappa$ in $\\mathrm{m^{2}}$, $M$ in $\\mathrm{Pa}$, and $H_{d}$ in $\\mathrm{m}$.", "answer": "$$\\boxed{0.197\\,\\frac{\\mu_{f}}{\\kappa\\,M}\\,H_{d}^{2}}$$", "id": "3526898"}, {"introduction": "A common pitfall in transient simulations of coupled systems is the introduction of non-physical artifacts from inconsistent initial conditions. This practice explores a critical subtlety of the $u$-$p$ formulation: the initial displacement and pressure fields, $u_0(x)$ and $p_0(x)$, must satisfy a compatibility criterion to represent a valid physical state. You will derive this criterion from the governing equations and implement a numerical test to witness how incompatibility generates spurious pressure waves, a crucial lesson for developing robust numerical models [@problem_id:3526928].", "problem": "Consider a one-dimensional poroelastic rod of length $L$ subjected to small strains, with displacement field $u(x,t)$ and pore pressure field $p(x,t)$. The rod has spatial coordinate $x \\in [0,L]$ and time $t \\ge 0$. The material is linear isotropic elastic with Lamé moduli $\\lambda$ and $G$, Biot coefficient $\\alpha$, and Biot modulus $M$. The pore fluid obeys Darcy's law with intrinsic permeability $\\kappa$ and dynamic viscosity $\\mu$. The governing statements are as follows, taken as the fundamental starting point:\n\n- Linear momentum balance (quasi-static): $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$.\n- Linear elastic stress with pore pressure coupling: $\\boldsymbol{\\sigma} = 2G\\,\\boldsymbol{\\varepsilon} + \\lambda\\,\\varepsilon_v\\,\\boldsymbol{I} - \\alpha\\,p\\,\\boldsymbol{I}$.\n- Fluid mass conservation: $\\dfrac{\\partial \\zeta}{\\partial t} + \\nabla \\cdot \\boldsymbol{q} = s$, with fluid content $\\zeta = \\alpha\\,\\varepsilon_v + \\dfrac{p}{M}$ and Darcy flux $\\boldsymbol{q} = -\\dfrac{\\kappa}{\\mu}\\,\\nabla p$.\n- Kinematics: $\\boldsymbol{\\varepsilon} = \\dfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^\\top\\right)$ and $\\varepsilon_v = \\nabla \\cdot \\boldsymbol{u}$.\n\nIn one dimension along $x$, assume zero body forces and plane strain with $\\varepsilon_v = \\dfrac{\\partial u}{\\partial x}$. The mechanical boundary conditions are $u(0,t) = 0$ and $u(L,t) = 0$ for all $t$. The hydraulic boundary conditions are no-flow, i.e., $\\dfrac{\\partial p}{\\partial x}(0,t) = 0$ and $\\dfrac{\\partial p}{\\partial x}(L,t) = 0$ for all $t$. There are no volumetric sources, so $s=0$.\n\nLet $p_0(x)$ and $u_0(x)$ denote the initial conditions at $t=0$. It is known that if $p_0(x)$ and $u_0(x)$ are incompatible with the constitutive and balance equations, spurious pore pressure transients can occur at early times that are artifacts of the inconsistency rather than physical diffusion.\n\nYour tasks:\n\n1. Using only the fundamental statements listed above, derive a compatibility criterion that $p_0(x)$ and $u_0(x)$ must satisfy to avoid non-physical transients at $t=0^+$ under the stated boundary conditions. Express the criterion in terms of the volumetric strain $\\varepsilon_0(x) = \\dfrac{\\partial u_0}{\\partial x}$ and the spatial average $\\overline{p_0} = \\dfrac{1}{L}\\int_0^L p_0(x)\\,dx$.\n\n2. Based on your derivation, define a local spurious-mismatch indicator $\\delta\\zeta(x)$ that quantifies the incompatibility of $(p_0,u_0)$ at $t=0$. Then define a single scalar metric as the root-mean-square (RMS) of $\\delta\\zeta(x)$ over $x \\in [0,L]$.\n\n3. Derive the reduced evolution equation for $p(x,t)$ under the given boundary conditions and constitutive coupling, and implement a short-time implicit time-stepping scheme to compute the maximum absolute pore pressure change $\\max_x |p(x,t_{\\mathrm{end}}) - p_0(x)|$ over a brief time interval $[0,t_{\\mathrm{end}}]$.\n\nPhysical units and reporting requirements:\n\n- Length must be in meters (m), pressure in pascals (Pa), time in seconds (s), permeability in square meters ($\\mathrm{m}^2$), viscosity in pascal-seconds (Pa·s), moduli in pascals (Pa), and the RMS mismatch is dimensionless.\n- Your program must evaluate a specified test suite and output, for each test case, the triple $[\\text{compatibility\\_boolean}, \\text{RMS\\_mismatch}, \\text{max\\_pressure\\_change}]$, where the boolean is $1$ if the compatibility criterion is satisfied exactly to numerical tolerance and $0$ otherwise, the RMS mismatch is a float (dimensionless), and the maximum pressure change is a float in $\\mathrm{Pa}$.\n\nNumerical implementation details:\n\n- Discretize the spatial interval with $N$ equally spaced nodes and enforce the no-flow boundary conditions via a discrete Neumann operator.\n- Use an implicit Euler step for the pressure diffusion-type evolution you derive, with a uniform time step $\\Delta t$ and a total of $n_{\\mathrm{steps}}$ steps, i.e., $t_{\\mathrm{end}} = n_{\\mathrm{steps}}\\,\\Delta t$.\n- For the compatibility boolean, use a strict numerical tolerance of $10^{-10}$ on the pointwise difference between the derived compatible strain and $\\varepsilon_0(x)$.\n\nTest suite and parameters:\n\nUse the following five cases. In all cases, take $L = 10\\,\\mathrm{m}$, $N = 201$, $\\mu = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\Delta t = 1\\,\\mathrm{s}$, and $n_{\\mathrm{steps}} = 5$.\n\n- Case $1$ (compatible sinusoidal pair):\n  - $\\alpha = 0.9$, $\\lambda = 7\\times 10^9\\,\\mathrm{Pa}$, $G = 5\\times 10^9\\,\\mathrm{Pa}$, $M = 10^{10}\\,\\mathrm{Pa}$, $\\kappa = 10^{-18}\\,\\mathrm{m}^2$.\n  - Define $\\varepsilon_0(x) = A_\\varepsilon \\sin\\left(\\dfrac{2\\pi x}{L}\\right)$ with $A_\\varepsilon = 2\\times 10^{-5}$ and choose $u_0(x)$ accordingly to satisfy $u(0)=u(L)=0$.\n  - Let $\\overline{p_0} = P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$ and set $p_0(x)$ to satisfy the compatibility you derive using the given $\\varepsilon_0(x)$ and $P_{\\mathrm{avg}}$.\n\n- Case $2$ (incompatible pressure gradient, zero initial strain):\n  - Same $\\alpha$, $\\lambda$, $G$, $M$, $\\kappa$ as Case $1$.\n  - $u_0(x) \\equiv 0$ so $\\varepsilon_0(x) \\equiv 0$.\n  - $p_0(x) = P_{\\mathrm{avg}} + P_{\\mathrm{amp}}\\sin\\left(\\dfrac{2\\pi x}{L}\\right)$ with $P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$ and $P_{\\mathrm{amp}} = 3\\times 10^5\\,\\mathrm{Pa}$.\n\n- Case $3$ (incompatible strain, uniform initial pressure):\n  - Same $\\alpha$, $\\lambda$, $G$, $M$, $\\kappa$ as Case $1$.\n  - $\\varepsilon_0(x) = A_\\varepsilon \\sin\\left(\\dfrac{2\\pi x}{L}\\right)$ with $A_\\varepsilon = 2\\times 10^{-5}$ and $u_0(x)$ chosen to satisfy $u(0)=u(L)=0$.\n  - $p_0(x) \\equiv P_{\\mathrm{avg}}$ with $P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$.\n\n- Case $4$ (edge case: very low permeability):\n  - Same $\\alpha$, $\\lambda$, $G$, $M$ as Case $1$, but $\\kappa = 10^{-20}\\,\\mathrm{m}^2$.\n  - $u_0(x) \\equiv 0$, $p_0(x) = P_{\\mathrm{avg}} + P_{\\mathrm{amp}}\\sin\\left(\\dfrac{2\\pi x}{L}\\right)$ with $P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$ and $P_{\\mathrm{amp}} = 3\\times 10^5\\,\\mathrm{Pa}$.\n\n- Case $5$ (edge case: much stiffer skeleton):\n  - $\\alpha = 0.9$, $\\lambda = 8\\times 10^{10}\\,\\mathrm{Pa}$, $G = 5\\times 10^{10}\\,\\mathrm{Pa}$, $M = 10^{10}\\,\\mathrm{Pa}$, $\\kappa = 10^{-18}\\,\\mathrm{m}^2$.\n  - $u_0(x) \\equiv 0$, $p_0(x) = P_{\\mathrm{avg}} + P_{\\mathrm{amp}}\\sin\\left(\\dfrac{2\\pi x}{L}\\right)$ with $P_{\\mathrm{avg}} = 10^6\\,\\mathrm{Pa}$ and $P_{\\mathrm{amp}} = 3\\times 10^5\\,\\mathrm{Pa}$.\n\nFinal output format:\n\nYour program should produce a single line of output containing a list of the five case results, where each result is the triple $[\\text{compatibility\\_boolean}, \\text{RMS\\_mismatch}, \\text{max\\_pressure\\_change}]$. The entire output must be a single comma-separated list enclosed in square brackets, for example, $[\\,[1,0.0,0.0],\\,[0,0.123,456.0],\\,\\dots\\,]$. The RMS mismatch is dimensionless and the maximum pressure change must be reported in $\\mathrm{Pa}$ as a float.", "solution": "The problem statement is valid. It is scientifically grounded in the theory of linear poroelasticity, is well-posed, objective, and provides a complete set of information for a rigorous mathematical and numerical analysis. We proceed with the solution.\n\nThe analysis is based on the provided one-dimensional governing equations for a poroelastic medium, under quasi-static conditions, with specific boundary and initial conditions.\n\n**Task 1: Derivation of the Compatibility Criterion**\n\nThe fundamental equations provided for the one-dimensional case, assuming zero body forces ($\\boldsymbol{b}=\\boldsymbol{0}$), are:\n1.  Linear momentum balance: $\\dfrac{d \\sigma_{xx}}{dx} = 0$.\n2.  Linear elastic stress-pressure coupling: $\\sigma_{xx} = (\\lambda + 2G)\\varepsilon_v - \\alpha p$. The term $\\lambda + 2G$ is the plane strain P-wave modulus, hereafter denoted as $P_v$.\n3.  Volumetric strain: $\\varepsilon_v = \\dfrac{du}{dx}$.\n\nFrom the momentum balance, we deduce that the total stress $\\sigma_{xx}$ must be constant in space, though it may vary in time: $\\sigma_{xx}(x,t) = C(t)$. Substituting the constitutive relation, we have:\n$$P_v \\dfrac{du}{dx}(x,t) - \\alpha p(x,t) = C(t)$$\nThis relation must hold for all time $t \\ge 0$ and for all $x \\in [0, L]$. To determine the function $C(t)$, we integrate this equation over the spatial domain $[0, L]$:\n$$\\int_0^L \\left( P_v \\dfrac{du}{dx} - \\alpha p \\right) dx = \\int_0^L C(t) dx$$\n$$P_v \\int_0^L \\dfrac{du}{dx} dx - \\alpha \\int_0^L p(x,t) dx = C(t)L$$\nThe mechanical boundary conditions are $u(0,t) = 0$ and $u(L,t) = 0$. This implies that the integral of the strain over the domain is zero:\n$$\\int_0^L \\dfrac{du}{dx} dx = u(L,t) - u(0,t) = 0 - 0 = 0$$\nUsing this result in the integrated equation yields:\n$$0 - \\alpha (L \\cdot \\overline{p}(t)) = C(t)L$$\nwhere $\\overline{p}(t) = \\frac{1}{L}\\int_0^L p(x,t) dx$ is the spatial average of the pore pressure. We find that $C(t) = -\\alpha \\overline{p}(t)$.\n\nSubstituting this expression for $C(t)$ back into the stress balance equation gives a general relationship between strain and pressure that must hold at all times for a compatible state:\n$$P_v \\dfrac{du}{dx}(x,t) = \\alpha (p(x,t) - \\overline{p}(t))$$\nFor an initial state $(u_0(x), p_0(x))$ to be compatible with the governing equations and boundary conditions at $t=0$, it must satisfy this relationship. Letting $\\varepsilon_0(x) = \\frac{du_0}{dx}$ and $\\overline{p_0} = \\frac{1}{L}\\int_0^L p_0(x)dx$, the compatibility criterion is:\n$$P_v \\varepsilon_0(x) = \\alpha (p_0(x) - \\overline{p_0})$$\nThis criterion establishes a direct link between the initial volumetric strain field and the deviation of the initial pore pressure from its spatial average.\n\n**Task 2: Spurious Mismatch Indicator and RMS Metric**\n\nAn incompatibility between the initial fields $(\\varepsilon_0(x), p_0(x))$ leads to non-physical, instantaneous adjustments at $t=0^+$. This can be quantified by examining the fluid content, $\\zeta = \\alpha \\varepsilon_v + \\frac{p}{M}$. The incompatibility represents a disequilibrium that the numerical model will attempt to resolve, manifesting as spurious pressure transients.\n\nWe define a local spurious-mismatch indicator, $\\delta\\zeta(x)$, as the part of the initial fluid content variation that does not satisfy the compatibility-derived relationship. It is the difference between the actual initial fluid content fluctuation and what it *should* be in a compatible state.\n\nFrom the compatibility criterion, a compatible strain $\\varepsilon_{c,0}(x)$ for a given pressure field $p_0(x)$ would be $\\varepsilon_{c,0}(x) = \\frac{\\alpha}{P_v}(p_0(x) - \\overline{p_0})$. The corresponding compatible fluid content is $\\zeta_{c,0}(x) = \\alpha \\varepsilon_{c,0}(x) + \\frac{p_0(x)}{M}$. The actual initial fluid content is $\\zeta_0(x) = \\alpha \\varepsilon_0(x) + \\frac{p_0(x)}{M}$. The difference is:\n$$\\delta\\zeta(x) = \\zeta_0(x) - \\zeta_{c,0}(x) = \\alpha(\\varepsilon_0(x) - \\varepsilon_{c,0}(x))$$\n$$\\delta\\zeta(x) = \\alpha \\varepsilon_0(x) - \\alpha \\left( \\frac{\\alpha}{P_v}(p_0(x) - \\overline{p_0}) \\right) = \\frac{\\alpha}{P_v} \\left( P_v \\varepsilon_0(x) - \\alpha(p_0(x) - \\overline{p_0}) \\right)$$\nThis indicator $\\delta\\zeta(x)$ is directly proportional to the residual of the compatibility criterion and is zero if and only if the initial state is compatible. As $\\alpha$, $\\varepsilon_v$, $p$, $M$, and $P_v$ are dimensionless or have dimensions of pressure, $\\zeta$ and $\\delta\\zeta$ are dimensionless.\n\nThe scalar metric for the total mismatch is the root-mean-square (RMS) of $\\delta\\zeta(x)$ over the domain:\n$$\\text{RMS Mismatch} = \\sqrt{\\frac{1}{L} \\int_0^L [\\delta\\zeta(x)]^2 dx}$$\n\n**Task 3: Reduced Evolution Equation and Numerical Scheme**\n\nTo derive the evolution equation for pressure, we start with the fluid mass conservation equation, with no source term ($s=0$):\n$$\\dfrac{\\partial \\zeta}{\\partial t} + \\nabla \\cdot \\boldsymbol{q} = 0$$\nIn one dimension, with $\\zeta = \\alpha \\varepsilon_v + \\frac{p}{M}$ and Darcy flux $q_x = -\\frac{\\kappa}{\\mu}\\frac{\\partial p}{\\partial x}$, this becomes:\n$$\\dfrac{\\partial}{\\partial t}\\left(\\alpha \\varepsilon_v + \\frac{p}{M}\\right) - \\dfrac{\\partial}{\\partial x}\\left(\\frac{\\kappa}{\\mu}\\frac{\\partial p}{\\partial x}\\right) = 0$$\nWe substitute the compatibility relation for strain, $\\varepsilon_v(x,t) = \\frac{\\alpha}{P_v} (p(x,t) - \\overline{p}(t))$, into the conservation equation:\n$$\\dfrac{\\partial}{\\partial t}\\left[\\alpha \\left(\\frac{\\alpha}{P_v}(p - \\overline{p})\\right) + \\frac{p}{M}\\right] - \\frac{\\kappa}{\\mu} \\frac{\\partial^2 p}{\\partial x^2} = 0$$\n$$\\dfrac{\\partial}{\\partial t}\\left[\\left(\\frac{\\alpha^2}{P_v} + \\frac{1}{M}\\right)p - \\frac{\\alpha^2}{P_v}\\overline{p}\\right] - \\frac{\\kappa}{\\mu} \\frac{\\partial^2 p}{\\partial x^2} = 0$$\nLet $1/M' = \\frac{\\alpha^2}{P_v} + \\frac{1}{M}$, where $M'$ is the constrained drained modulus. The equation becomes:\n$$\\frac{1}{M'}\\frac{\\partial p}{\\partial t} - \\frac{\\alpha^2}{P_v}\\frac{d\\overline{p}}{dt} - \\frac{\\kappa}{\\mu} \\frac{\\partial^2 p}{\\partial x^2} = 0$$\nIntegrating this equation over $[0, L]$ and applying the no-flow boundary conditions ($\\frac{\\partial p}{\\partial x} = 0$ at $x=0,L$) shows that $\\frac{1}{M}\\frac{d\\overline{p}}{dt} = 0$, which implies that the average pressure $\\overline{p}(t)$ is constant in time, i.e., $\\overline{p}(t) = \\overline{p_0}$.\nTherefore, the term $\\frac{d\\overline{p}}{dt}$ vanishes, and we obtain a standard diffusion equation for pressure:\n$$\\frac{1}{M'}\\frac{\\partial p}{\\partial t} = \\frac{\\kappa}{\\mu}\\frac{\\partial^2 p}{\\partial x^2} \\quad \\implies \\quad \\frac{\\partial p}{\\partial t} = c \\frac{\\partial^2 p}{\\partial x^2}$$\nwhere $c = \\frac{\\kappa M'}{\\mu}$ is the hydraulic diffusivity.\n\nThis equation is solved numerically using an implicit Euler time-stepping scheme on a uniform grid of $N$ nodes. The spatial domain $x \\in [0,L]$ is discretized into $N-1$ intervals of size $\\Delta x = L/(N-1)$. The second spatial derivative is approximated using a central finite difference scheme. The no-flow Neumann boundary conditions are implemented using ghost nodes, resulting in the following discrete system to be solved at each time step from $t_n$ to $t_{n+1}=t_n+\\Delta t$:\n$$(\\boldsymbol{I} - c \\Delta t \\boldsymbol{D}) \\boldsymbol{p}^{n+1} = \\boldsymbol{p}^{n}$$\nwhere $\\boldsymbol{p}^n$ is the vector of nodal pressures at time $t_n$, $\\boldsymbol{I}$ is the identity matrix, and $\\boldsymbol{D}$ is the discrete Laplacian operator matrix incorporating the boundary conditions. This linear system is solved for $\\boldsymbol{p}^{n+1}$ repeatedly for $n_{\\mathrm{steps}}$. The simulation starts with the given initial pressure profile $p_0(x)$. The maximum absolute pressure change is then computed as $\\max_{i} |\\boldsymbol{p}^{\\text{final}}_i - \\boldsymbol{p}^0_i|$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the poroelastic compatibility and transient problem for a suite of test cases.\n    \"\"\"\n\n    def process_case(params):\n        \"\"\"\n        Processes a single test case.\n        \"\"\"\n        # Unpack parameters\n        L, N, mu, dt, n_steps = params['geom']['L'], params['geom']['N'], params['geom']['mu'], params['geom']['dt'], params['geom']['n_steps']\n        alpha, lam, G, M, k = params['material']['alpha'], params['material']['lam'], params['material']['G'], params['material']['M'], params['material']['k']\n        eps0_func, p0_func = params['initial']['eps0_func'], params['initial']['p0_func']\n\n        # 1. Setup grid and derived constants\n        Pv = lam + 2 * G\n        M_prime = 1.0 / (alpha**2 / Pv + 1.0 / M)\n        c_diff = k * M_prime / mu\n        dx = L / (N - 1)\n        x = np.linspace(0, L, N)\n\n        # 2. Define initial fields\n        eps0 = eps0_func(x=x, L=L, A_eps=params.get('A_eps', 0))\n        p0 = p0_func(x=x, L=L, Pv=Pv, alpha=alpha, P_avg=params.get('P_avg', 0), P_amp=params.get('P_amp', 0), A_eps=params.get('A_eps', 0))\n\n        # 3. Compatibility check\n        p0_bar = np.mean(p0)\n        eps_c = (alpha / Pv) * (p0 - p0_bar)\n        is_compatible = np.all(np.abs(eps0 - eps_c)  1e-10)\n\n        # 4. RMS mismatch calculation\n        delta_zeta = alpha * eps0 - (alpha**2 / Pv) * (p0 - p0_bar)\n        rms_mismatch = np.sqrt(np.mean(delta_zeta**2))\n\n        # 5. Time evolution via implicit Euler\n        beta = c_diff * dt / dx**2\n        \n        # Assemble the system matrix A for (I - c*dt*D)p_next = p_current\n        A = np.zeros((N, N))\n        \n        # Main diagonal\n        A.flat[::N + 1] = 1 + 2 * beta\n        # Off-diagonals for interior points\n        A.flat[1::N + 1] = -beta\n        A.flat[N::N + 1] = -beta\n        \n        # Correct for Neumann boundary conditions\n        A[0, 1] = -2 * beta\n        A[N - 1, N - 2] = -2 * beta\n        \n        p_current = np.copy(p0)\n        for _ in range(n_steps):\n            p_next = np.linalg.solve(A, p_current)\n            p_current = p_next\n        \n        p_final = p_current\n\n        # 6. Calculate maximum pressure change\n        max_p_change = np.max(np.abs(p_final - p0))\n\n        return [int(is_compatible), rms_mismatch, max_p_change]\n\n    # Define test suite parameters\n    common_geom = {'L': 10.0, 'N': 201, 'mu': 1e-3, 'dt': 1.0, 'n_steps': 5}\n    P_avg_val = 1.0e6\n    A_eps_val = 2.0e-5\n    P_amp_val = 3.0e5\n\n    # Initial condition lambda functions\n    eps0_sin = lambda x, L, A_eps, **kwargs: A_eps * np.sin(2 * np.pi * x / L)\n    eps0_zero = lambda x, **kwargs: np.zeros_like(x)\n    p0_compat = lambda x, L, Pv, alpha, P_avg, A_eps, **kwargs: P_avg + (Pv / alpha) * A_eps * np.sin(2 * np.pi * x / L)\n    p0_sin = lambda x, L, P_avg, P_amp, **kwargs: P_avg + P_amp * np.sin(2 * np.pi * x / L)\n    p0_uniform = lambda x, P_avg, **kwargs: P_avg * np.ones_like(x)\n\n    test_cases_defs = [\n        { # Case 1\n            'material': {'alpha': 0.9, 'lam': 7e9, 'G': 5e9, 'M': 1e10, 'k': 1e-18},\n            'initial': {'eps0_func': eps0_sin, 'p0_func': p0_compat},\n            'P_avg': P_avg_val, 'A_eps': A_eps_val\n        },\n        { # Case 2\n            'material': {'alpha': 0.9, 'lam': 7e9, 'G': 5e9, 'M': 1e10, 'k': 1e-18},\n            'initial': {'eps0_func': eps0_zero, 'p0_func': p0_sin},\n            'P_avg': P_avg_val, 'P_amp': P_amp_val\n        },\n        { # Case 3\n            'material': {'alpha': 0.9, 'lam': 7e9, 'G': 5e9, 'M': 1e10, 'k': 1e-18},\n            'initial': {'eps0_func': eps0_sin, 'p0_func': p0_uniform},\n            'P_avg': P_avg_val, 'A_eps': A_eps_val\n        },\n        { # Case 4\n            'material': {'alpha': 0.9, 'lam': 7e9, 'G': 5e9, 'M': 1e10, 'k': 1e-20},\n            'initial': {'eps0_func': eps0_zero, 'p0_func': p0_sin},\n            'P_avg': P_avg_val, 'P_amp': P_amp_val\n        },\n        { # Case 5\n            'material': {'alpha': 0.9, 'lam': 8e10, 'G': 5e10, 'M': 1e10, 'k': 1e-18},\n            'initial': {'eps0_func': eps0_zero, 'p0_func': p0_sin},\n            'P_avg': P_avg_val, 'P_amp': P_amp_val\n        }\n    ]\n\n    results = []\n    for case_def in test_cases_defs:\n        # Add common geometry to each case definition\n        case_def['geom'] = common_geom\n        # Run the simulation for the case\n        result = process_case(case_def)\n        results.append(result)\n\n    # Format the final output string\n    # E.g., [[1, 0.0, 0.0], [0, 0.1, 100.0]] -> \"[[1, 0.0, 0.0],[0, 0.1, 100.0]]\"\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3526928"}, {"introduction": "Solving the fully coupled displacement-pressure equations in time requires a choice between different algorithmic strategies, each with distinct trade-offs. This exercise provides hands-on experience comparing two workhorses of computational mechanics: monolithic (fully coupled) and staggered (sequential) schemes. By implementing both and testing them against a challenging injection problem with high permeability contrasts, you will directly quantify and observe their differences in accuracy, stability (e.g., pressure overshoot), and overall robustness [@problem_id:3526900].", "problem": "Consider a one-dimensional saturated porous bar of length $L$ subjected to rapid fluid injection at the left boundary $x=0$ and drained at the right boundary $x=L$. The bar is modeled using the fully coupled displacement-pressure formulation (denoted as $u$–$p$), based on the quasi-static Biot poroelasticity theory. The goal is to compare staggered and monolithic $u$–$p$ schemes under rapid injection; quantify pressure overshoot, displacement error norms $\\|u\\|$, and robustness across permeability contrasts.\n\nFoundational base and modeling assumptions:\n- Conservation of linear momentum in quasi-static conditions: $\\dfrac{\\partial \\sigma}{\\partial x} = 0$.\n- Linear poroelastic constitutive relation for the total stress: $\\sigma = K_s \\dfrac{\\partial u}{\\partial x} - \\alpha p$, where $K_s$ is the drained stiffness of the skeleton, $\\alpha$ is the Biot coefficient, $u$ is the displacement, and $p$ is the pore pressure.\n- Fluid mass conservation: $\\alpha \\dfrac{\\partial \\varepsilon}{\\partial t} + S \\dfrac{\\partial p}{\\partial t} - \\dfrac{\\partial}{\\partial x}\\!\\left( \\dfrac{\\kappa(x)}{\\mu} \\dfrac{\\partial p}{\\partial x} \\right) = 0$, where $\\varepsilon = \\dfrac{\\partial u}{\\partial x}$ is the volumetric strain in one dimension, $S$ is the storage coefficient, $\\kappa(x)$ is the spatially varying intrinsic permeability, and $\\mu$ is the dynamic viscosity.\n- Darcy’s law for fluid flux: $q(x,t) = -\\dfrac{\\kappa(x)}{\\mu} \\dfrac{\\partial p}{\\partial x}$.\n- Mechanical boundary conditions: $u(0,t)=0$ (fixed left end) and $\\sigma(L,t)=0$ (traction-free right end).\n- Hydraulic boundary conditions: prescribed injection flux at $x=0$ equal to $q_0$ (constant in time after a step at $t=0$) and drained boundary $p(L,t)=0$.\n\nUnder these assumptions, the spatially uniform traction-free state implies $\\sigma(x,t) \\equiv 0$, which enforces $K_s \\dfrac{\\partial u}{\\partial x} = \\alpha p$. The exact steady-state pressure profile with $p(L)=0$ and constant flux $q_0$ satisfies $\\kappa(x) \\dfrac{\\partial p}{\\partial x} = - \\mu q_0$, yielding $p(x) = \\mu q_0 \\int_x^L \\dfrac{1}{\\kappa(s)} \\, ds$. This steady reference is used to define pressure overshoot.\n\nYou must implement and compare these two time-integration schemes:\n- Monolithic scheme: a fully coupled implicit update that consistently incorporates the coupling into the transient mass balance. Under $\\sigma \\equiv 0$, the effective storage becomes $S_{\\text{eff}} = S + \\dfrac{\\alpha^2}{K_s}$, and one implicit step advances $p$ using $S_{\\text{eff}}$.\n- Staggered scheme: a sequential update that advances $p$ using only $S$ (i.e., lagging the mechanical coupling in the transient), and updates $u$ subsequently from the new $p$ via $K_s \\dfrac{\\partial u}{\\partial x} = \\alpha p$.\n\nDiscretization requirements:\n- Discretize the bar into $N$ uniform cells of size $\\Delta x = L/N$, with permeability $\\kappa(x)$ piecewise constant per cell. Use a conservative spatial discretization for $-\\dfrac{\\partial}{\\partial x}\\!\\left( \\dfrac{\\kappa(x)}{\\mu} \\dfrac{\\partial p}{\\partial x} \\right)$ that is consistent with variable $\\kappa(x)$ across cell interfaces. Use backward Euler in time with time step $\\Delta t$.\n- Enforce the injection flux at $x=0$ as a Neumann boundary condition contributing a constant inflow $q_0$ to the leftmost control volume. Enforce the drained boundary at $x=L$ with $p(L,t)=0$.\n- After computing $p^{n+1}$, obtain $u^{n+1}$ from $K_s \\dfrac{\\partial u}{\\partial x} = \\alpha p^{n+1}$ by integrating from $u(0)=0$.\n\nMetrics to compute for each test case:\n1. Pressure overshoot magnitude in Pascals: the maximum positive value over space and time of $p(x,t) - p_{\\text{steady}}(x)$, where $p_{\\text{steady}}(x) = \\mu q_0 \\int_x^L \\dfrac{1}{\\kappa(s)} \\, ds$.\n2. Displacement error norm $\\|u\\|$ in meters: the $L^2$ norm of the difference between staggered and monolithic displacements at the final time, computed over the bar as a spatial integral norm.\n3. Robustness indicators (boolean) for each scheme: define robustness as the absence of excessive overshoot relative to the steady-state scale; specifically, a scheme is robust if $\\dfrac{\\text{overshoot}}{\\max_x p_{\\text{steady}}(x)} \\le 0.1$ and all computed fields remain finite.\n\nPhysical units:\n- Pressure must be expressed in Pascals (Pa).\n- Displacement must be expressed in meters (m).\n- Time must be expressed in seconds (s).\n- Permeability in square meters ($\\text{m}^2$).\n- Dynamic viscosity in Pascal-seconds (Pa·s).\n- Injection flux in meters per second (m/s).\n\nTest suite and parameters:\nUse the following three cases to probe different permeability contrasts. All other parameters are identical across cases unless specified.\n\n- Common parameters: $L=10\\,\\text{m}$, $N=100$, $\\Delta t=2.5\\,\\text{s}$, number of steps $N_t=400$ (final time $T=1000\\,\\text{s}$), $q_0=1\\times 10^{-7}\\,\\text{m/s}$, $\\mu=1\\times 10^{-3}\\,\\text{Pa·s}$, $S=1\\times 10^{-9}\\,\\text{Pa}^{-1}$, $\\alpha=0.9$, $K_s=5\\times 10^{8}\\,\\text{Pa}$.\n\n- Case A (uniform, moderate permeability): $\\kappa(x) \\equiv 1\\times 10^{-14}\\,\\text{m}^2$.\n- Case B (two-layer contrast): $\\kappa(x)=1\\times 10^{-12}\\,\\text{m}^2$ for $x \\in [0,L/2)$ and $\\kappa(x)=1\\times 10^{-16}\\,\\text{m}^2$ for $x \\in [L/2,L]$.\n- Case C (uniform, very low permeability): $\\kappa(x) \\equiv 1\\times 10^{-18}\\,\\text{m}^2$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of results for the three test cases. Each test case’s result is a list with five entries in the following order:\n- Pressure overshoot for the staggered scheme in Pa (float).\n- Pressure overshoot for the monolithic scheme in Pa (float).\n- Displacement $L^2$ error norm at the final time in m (float).\n- Robustness of the staggered scheme (boolean).\n- Robustness of the monolithic scheme (boolean).\n\nFor example, the output should look like:\n[[overshoot_staggered_caseA,overshoot_monolithic_caseA,u_error_caseA,robust_staggered_caseA,robust_monolithic_caseA],[...caseB...],[...caseC...]]", "solution": "The user-provided problem is a well-defined exercise in computational geomechanics, requiring the implementation and comparison of two numerical schemes for a 1D poroelasticity problem. The problem is scientifically grounded in the quasi-static Biot theory, is mathematically consistent, and provides all necessary parameters, equations, and boundary conditions. Therefore, the problem is determined to be valid.\n\nThe solution proceeds as follows:\n\nFirst, we establish the governing partial differential equation (PDE) for the pore pressure, $p$. The problem states the quasi-static momentum balance $\\frac{\\partial \\sigma}{\\partial x} = 0$, where the total stress is $\\sigma = K_s \\frac{\\partial u}{\\partial x} - \\alpha p$. The boundary condition $\\sigma(L,t) = 0$ implies that the total stress is identically zero throughout the domain, $\\sigma(x,t) \\equiv 0$. This simplifies the constitutive relation to $K_s \\frac{\\partial u}{\\partial x} = \\alpha p$, which means the strain $\\varepsilon = \\frac{\\partial u}{\\partial x}$ is directly proportional to the pressure, $\\varepsilon = \\frac{\\alpha}{K_s} p$.\n\nSubstituting this relationship into the fluid mass conservation equation, $\\alpha \\frac{\\partial \\varepsilon}{\\partial t} + S \\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x}\\!\\left( \\frac{\\kappa(x)}{\\mu} \\frac{\\partial p}{\\partial x} \\right) = 0$, yields:\n$$\n\\alpha \\frac{\\partial}{\\partial t}\\left(\\frac{\\alpha p}{K_s}\\right) + S \\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x}\\!\\left( \\frac{\\kappa(x)}{\\mu} \\frac{\\partial p}{\\partial x} \\right) = 0\n$$\n$$\n\\left(S + \\frac{\\alpha^2}{K_s}\\right) \\frac{\\partial p}{\\partial t} - \\frac{\\partial}{\\partial x}\\!\\left( \\frac{\\kappa(x)}{\\mu} \\frac{\\partial p}{\\partial x} \\right) = 0\n$$\nThis is a parabolic diffusion equation for pressure $p(x,t)$. The term $C = S + \\frac{\\alpha^2}{K_s}$ is the effective storage coefficient, $S_{\\text{eff}}$, which accounts for both fluid and solid skeleton compressibility under the simplified stress condition. The monolithic scheme uses this complete coefficient $C = S_{\\text{eff}}$. The staggered scheme, by definition, lags the mechanical coupling term, meaning it uses only the fluid storage coefficient, $C = S$, in the time-derivative term.\n\nNext, we discretize this PDE. We use a cell-centered finite volume method on a uniform grid of $N$ cells, each of size $\\Delta x = L/N$. The pressure $p_i$ is located at the center of cell $i$. We employ the backward Euler method for time integration with a time step $\\Delta t$.\n\nThe discretized equation for an interior cell $i$ (for $i=1, \\dots, N-2$) at time step $n+1$ is:\n$$\nC \\Delta x \\frac{p_i^{n+1} - p_i^n}{\\Delta t} + q_{i+1/2} - q_{i-1/2} = 0\n$$\nwhere $p_i^n = p(x_i, t^n)$. The flux $q$ between cells is approximated using a two-point flux approximation, with a harmonic mean for the inter-cell hydraulic conductivity to handle the piecewise-constant permeability $\\kappa(x)$. The flux between cell $i$ and cell $i+1$ is:\n$$\nq_{i+1/2} = -D_{i+1/2} \\frac{p_{i+1}^{n+1} - p_i^{n+1}}{\\Delta x}, \\quad \\text{where } D_{i+1/2} = \\frac{2 (\\kappa_i/\\mu)(\\kappa_{i+1}/\\mu)}{(\\kappa_i/\\mu)+(\\kappa_{i+1}/\\mu)}\n$$\nBoundary conditions are incorporated as follows:\n1.  At the left boundary ($x=0$), a constant injection flux $q_0$ is prescribed. This becomes a source term for cell $0$: $q_{-1/2} = q_0$.\n2.  At the right boundary ($x=L$), a drained condition $p(L,t)=0$ is imposed. This sets the pressure at the rightmost node to zero and affects the flux calculation for the last cell, $N-1$. The outflow flux is approximated as $q_{N-1/2} \\approx -\\frac{\\kappa_{N-1}}{\\mu} \\frac{p(L,t) - p_{N-1}^{n+1}}{\\Delta x / 2} = \\frac{2 \\kappa_{N-1}}{\\mu \\Delta x} p_{N-1}^{n+1}$.\n\nThese discrete equations form a tridiagonal linear system of equations for the unknown pressure vector $p^{n+1}$ at each time step: $A p^{n+1} = b$. The matrix $A$ depends on the geometry, material properties, and the storage coefficient $C$, while the vector $b$ contains the pressure from the previous time step $p^n$ and the boundary source term $q_0$. This system is solved efficiently using a tridiagonal solver, specifically `scipy.linalg.solve_banded`.\n\nThe simulation proceeds by iteratively solving for $p^{n+1}$ for both monolithic ($C=S_{\\text{eff}}$) and staggered ($C=S$) schemes from $t=0$ to the final time $T = N_t \\Delta t$.\n\nAfter the time-stepping loop, the required metrics are computed:\n1.  **Pressure Overshoot**: During the simulation, we track the maximum value of $p(x_i, t^n) - p_{\\text{steady}}(x_i)$ over all cells $i$ and time steps $n$. The steady-state pressure profile $p_{\\text{steady}}(x)$ is pre-computed by integrating the steady-state relation $\\frac{dp}{dx} = -\\frac{\\mu q_0}{\\kappa(x)}$ with the boundary condition $p(L)=0$.\n2.  **Displacement Error Norm**: The final displacements for both schemes, $u_{\\text{staggered}}$ and $u_{\\text{monolithic}}$, are calculated by spatially integrating the relation $\\frac{\\partial u}{\\partial x} = \\frac{\\alpha}{K_s} p$ using the final pressure fields and the condition $u(0)=0$. The $L^2$ norm of the difference, $\\|u_{\\text{staggered}} - u_{\\text{monolithic}}\\|$, is then computed using the trapezoidal rule on the nodal displacement differences.\n3.  **Robustness**: For each scheme, robustness is determined by two conditions: whether the maximum pressure overshoot is less than or equal to $10\\%$ of the maximum steady-state pressure, and whether the solution remained numerically stable (i.e., no `NaN` or `inf` values were produced).\n\nThis procedure is applied to each of the three test cases, which probe the schemes' behaviors under varying permeability contrasts. The collected metrics for all cases are then formatted into the required final output string.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the final result.\n    \"\"\"\n    # Common parameters for all test cases\n    common_params = {\n        'L': 10.0,              # m\n        'N': 100,               # number of cells\n        'dt': 2.5,              # s\n        'Nt': 400,              # number of time steps\n        'q0': 1.0e-7,           # m/s\n        'mu': 1.0e-3,           # Pa.s\n        'S': 1.0e-9,            # Pa^-1\n        'alpha': 0.9,\n        'Ks': 5.0e8             # Pa\n    }\n\n    # Definition of the three test cases with varying permeability\n    test_cases = [\n        {'case_id': 'A', 'k_profile': 'uniform', 'k_values': [1.0e-14]},\n        {'case_id': 'B', 'k_profile': 'layered', 'k_values': [1.0e-12, 1.0e-16]},\n        {'case_id': 'C', 'k_profile': 'uniform', 'k_values': [1.0e-18]},\n    ]\n    \n    final_results = []\n\n    for case in test_cases:\n        # Merge common and case-specific parameters\n        params = {**common_params, **case}\n        \n        # Setup grid and material properties\n        N = params['N']\n        L = params['L']\n        dx = L / N\n        x_nodes = np.linspace(0, L, N + 1)\n        x_centers = x_nodes[:-1] + dx / 2\n\n        k_vals = np.zeros(N)\n        if params['k_profile'] == 'uniform':\n            k_vals[:] = params['k_values'][0]\n        elif params['k_profile'] == 'layered':\n            k_high, k_low = params['k_values']\n            k_vals[x_centers  L / 2] = k_high\n            k_vals[x_centers = L / 2] = k_low\n\n        # Calculate steady-state pressure profile\n        p_steady_nodes = np.zeros(N + 1)\n        # Integrate from right (p(L)=0) to left\n        for j in range(N - 1, -1, -1):\n            p_steady_nodes[j] = p_steady_nodes[j + 1] + params['q0'] * params['mu'] * dx / k_vals[j]\n        \n        # Cell-centered steady pressure for comparison with computed values\n        p_steady_cell = (p_steady_nodes[:-1] + p_steady_nodes[1:]) / 2\n        max_p_steady = p_steady_nodes[0]\n        if max_p_steady == 0:  # Avoid division by zero\n             max_p_steady = 1.0\n\n        # Define effective storage coefficients for each scheme\n        C_mono = params['S'] + params['alpha']**2 / params['Ks']\n        C_stag = params['S']\n\n        results_per_scheme = {}\n        for scheme_name, C_eff in [('staggered', C_stag), ('monolithic', C_mono)]:\n            \n            # Assemble the tridiagonal matrix (constant in time)\n            beta = k_vals / params['mu']\n            # Harmonic mean for interface hydraulic conductivity\n            beta_interface = 2 * beta[:-1] * beta[1:] / (beta[:-1] + beta[1:])\n            \n            # Matrix in banded format for scipy.linalg.solve_banded\n            # ab[0,:] = super-diagonal, ab[1,:] = main-diagonal, ab[2,:] = sub-diagonal\n            ab = np.zeros((3, N))\n            gamma = C_eff * dx / params['dt']\n\n            # Super-diagonal (u)\n            ab[0, 1:] = -beta_interface / dx\n            # Sub-diagonal (l)\n            ab[2, :-1] = -beta_interface / dx\n            # Main diagonal (d)\n            ab[1, 0] = gamma + beta_interface[0] / dx\n            if N  1:\n                ab[1, 1:-1] = gamma + (beta_interface[:-1] + beta_interface[1:]) / dx\n                ab[1, -1] = gamma + beta_interface[-1] / dx + 2 * beta[-1] / dx\n            \n            # Time stepping loop\n            p = np.zeros(N) # Initial condition p(x,0)=0\n            max_overshoot = 0.0\n            is_finite = True\n            \n            for _ in range(params['Nt']):\n                # Construct Right-Hand-Side vector\n                b = gamma * p\n                b[0] += params['q0']\n                \n                p_new = solve_banded((1, 1), ab, b)\n                \n                if not np.all(np.isfinite(p_new)):\n                    is_finite = False\n                    break\n                \n                p = p_new\n                \n                # Update max overshoot (max positive value of p - p_steady)\n                current_overshoot = np.max(p - p_steady_cell)\n                if current_overshoot  max_overshoot:\n                    max_overshoot = current_overshoot\n            \n            results_per_scheme[scheme_name] = {\n                'p_final': p,\n                'max_overshoot': max(0.0, max_overshoot), # Ensure non-negative\n                'is_finite': is_finite\n            }\n\n        # Compute Final Metrics\n        overshoot_stag = results_per_scheme['staggered']['max_overshoot']\n        overshoot_mono = results_per_scheme['monolithic']['max_overshoot']\n\n        p_final_stag = results_per_scheme['staggered']['p_final']\n        p_final_mono = results_per_scheme['monolithic']['p_final']\n        \n        u_stag = np.zeros(N + 1)\n        u_mono = np.zeros(N + 1)\n        \n        const = dx * params['alpha'] / params['Ks']\n        for j in range(N):\n            u_stag[j+1] = u_stag[j] + const * p_final_stag[j]\n            u_mono[j+1] = u_mono[j] + const * p_final_mono[j]\n            \n        u_diff_sq = (u_stag - u_mono)**2\n        # Compute L2 norm of displacement difference using trapezoidal rule\n        u_error_norm = np.sqrt(np.trapz(u_diff_sq, x=x_nodes))\n        \n        robust_stag = (overshoot_stag / max_p_steady = 0.1) and results_per_scheme['staggered']['is_finite']\n        robust_mono = (overshoot_mono / max_p_steady = 0.1) and results_per_scheme['monolithic']['is_finite']\n\n        final_results.append([\n            overshoot_stag,\n            overshoot_mono,\n            u_error_norm,\n            robust_stag,\n            robust_mono\n        ])\n\n    # Format the results into the required single-line string\n    formatted_results = []\n    for res_list in final_results:\n        str_list = [f\"{v:.6e}\" if isinstance(v, float) else str(v).lower() for v in res_list]\n        formatted_results.append(f\"[{','.join(str_list)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3526900"}]}