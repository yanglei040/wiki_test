{"hands_on_practices": [{"introduction": "The foundation of modern computational plasticity lies in the return-mapping algorithm, which ensures that the stress state correctly returns to the yield surface after an elastic trial step predicts an inadmissible state. This first exercise guides you through the complete derivation for the classic Drucker-Prager model, a cornerstone of geomechanics. By starting from the geometric concept of a closest-point projection and deriving the consistent algorithmic tangent modulus, $\\mathbb{C}^{\\text{alg}}$, you will build the essential analytical machinery required for robust nonlinear finite element simulations [@problem_id:3508082].", "problem": "Consider a small-strain, rate-independent, isotropic elastoplastic model for a geomaterial governed by the Drucker–Prager (DP) yield condition with associative flow. The elastic response is linear and isotropic, with bulk modulus $K$ and shear modulus $G$, and the additive strain decomposition $\\boldsymbol{\\epsilon} = \\boldsymbol{\\epsilon}^{e} + \\boldsymbol{\\epsilon}^{p}$ holds. Let the Cauchy stress be denoted by $\\boldsymbol{\\sigma}$, with hydrostatic pressure $ p = \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) $ and deviatoric stress $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the second-order identity tensor. The second invariant of the deviatoric stress is represented by $ q = \\sqrt{\\tfrac{3}{2} \\boldsymbol{s} : \\boldsymbol{s}} $. The Drucker–Prager yield function is \n$$\nf(\\boldsymbol{\\sigma}) = q + \\alpha p - k,\n$$\nwith constant material parameters $\\alpha > 0$ and $k > 0$, and the associative plastic flow is defined by $ \\dot{\\boldsymbol{\\epsilon}}^{p} = \\dot{\\lambda}\\, \\partial f / \\partial \\boldsymbol{\\sigma} $ with plastic multiplier $\\dot{\\lambda} \\ge 0$. Assume perfect plasticity (no hardening).\n\nYou are to work entirely in stress space and use the closest-point projection (in the metric induced by the elastic compliance tensor) to return an elastic trial stress to the yield surface when plastic loading occurs. Start from the fundamental definitions above and from linear elasticity. Do not assume any formula not derivable from these bases.\n\nData for this problem:\n- Elastic moduli: $K = 100$ MPa, $G = 40$ MPa.\n- Drucker–Prager parameters: $\\alpha = 0.2$, $k = 2$ MPa.\n- Elastic trial stress at the end of a load increment: \n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\begin{pmatrix} 10 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\text{ MPa}.\n$$\n\nTasks:\n1. Formulate the closest-point projection problem in stress space for this model as a constrained minimization and derive the first-order optimality conditions that define the return mapping. Use these to express the updated stress $ \\boldsymbol{\\sigma}_{n+1} $ in terms of $ \\boldsymbol{\\sigma}^{\\mathrm{tr}} $ and the plastic multiplier increment $ \\Delta \\lambda $, and also to obtain a scalar nonlinear equation for $ \\Delta \\lambda $ by enforcing consistency $ f(\\boldsymbol{\\sigma}_{n+1}) = 0 $.\n2. Solve the consistency equation to obtain a closed-form expression for $ \\Delta \\lambda $ in terms of the invariants $ p^{\\mathrm{tr}} $ and $ q^{\\mathrm{tr}} $, and then compute the updated invariants $ p_{n+1} $ and $ q_{n+1} $ explicitly for the given data.\n3. Compute the linearization (consistent algorithmic tangent) of the return mapping to obtain the fourth-order algorithmic modulus tensor $ \\mathbb{C}^{\\mathrm{alg}} $ at the updated state. Work from the linearization of the optimality system you derived, and express $ \\mathbb{C}^{\\mathrm{alg}} $ in terms of the elastic tensor, the flow direction, and appropriate contractions. Then, define the algorithmic bulk modulus $ K^{\\mathrm{alg}} $ as the scalar mapping $ K^{\\mathrm{alg}} = \\mathrm{d}p / \\mathrm{d}\\varepsilon_{v} $ for an incremental purely volumetric strain perturbation (with $ \\varepsilon_{v} = \\operatorname{tr}(\\boldsymbol{\\epsilon}) $), and evaluate $ K^{\\mathrm{alg}} $ in closed form for the Drucker–Prager model at the updated state.\n4. Using the provided numerical data, evaluate $ K^{\\mathrm{alg}} $ numerically. Round your answer to four significant figures. Express the final result in MPa.", "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard problem in computational plasticity. Therefore, the problem is deemed valid. We proceed with the solution.\n\n### Task 1: Closest-Point Projection Formulation\n\nThe problem is to find the updated stress state $\\boldsymbol{\\sigma}_{n+1}$ that is closest to the elastic trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ while satisfying the yield condition $f(\\boldsymbol{\\sigma}_{n+1}) \\le 0$. The \"distance\" is measured in the energy norm defined by the inverse of the elastic stiffness tensor, $\\mathbb{M}^e = (\\mathbb{C}^e)^{-1}$. This is a constrained optimization problem:\n$$\n\\text{Minimize} \\quad \\frac{1}{2} (\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) : \\mathbb{M}^e : (\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) \\quad \\text{subject to} \\quad f(\\boldsymbol{\\sigma}_{n+1}) \\le 0.\n$$\nFor a plastic step, the constraint is active, $f(\\boldsymbol{\\sigma}_{n+1}) = 0$. The Lagrangian for this problem is:\n$$\n\\mathcal{L}(\\boldsymbol{\\sigma}_{n+1}, \\Delta\\lambda) = \\frac{1}{2} (\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) : \\mathbb{M}^e : (\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) + \\Delta\\lambda f(\\boldsymbol{\\sigma}_{n+1})\n$$\nwhere $\\Delta\\lambda \\ge 0$ is the Lagrange multiplier, identifiable as the consistent plastic multiplier increment. The first-order optimality conditions are:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\boldsymbol{\\sigma}_{n+1}} = \\mathbb{M}^e : (\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) + \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}_{n+1}} = \\mathbf{0}\n$$\n$$\nf(\\boldsymbol{\\sigma}_{n+1}) = 0\n$$\nFrom the first condition, we obtain the return mapping algorithm:\n$$\n\\boldsymbol{\\sigma}_{n+1} - \\boldsymbol{\\sigma}^{\\mathrm{tr}} = - \\Delta\\lambda (\\mathbb{M}^e)^{-1} : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}_{n+1}} \\implies \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\lambda \\mathbb{C}^e : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}_{n+1}}\n$$\nThis structure is identical to the one derived from the discrete flow rule $\\Delta\\boldsymbol{\\epsilon}^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}_{n+1}}$ and the stress update $\\boldsymbol{\\sigma}_{n+1} = \\mathbb{C}^e : (\\boldsymbol{\\epsilon}_{n+1} - \\boldsymbol{\\epsilon}^p_{n+1}) = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbb{C}^e : \\Delta\\boldsymbol{\\epsilon}^p$.\n\nTo proceed, we need the gradient of the yield function $f(\\boldsymbol{\\sigma}) = q + \\alpha p - k$. The derivatives of the invariants are:\n$$\n\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} \\left(\\frac{1}{3} \\boldsymbol{I}:\\boldsymbol{\\sigma}\\right) = \\frac{1}{3} \\boldsymbol{I}\n$$\n$$\n\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} \\left(\\sqrt{\\frac{3}{2} \\boldsymbol{s}:\\boldsymbol{s}}\\right) = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}} = \\frac{3}{2} \\frac{\\boldsymbol{s}}{q}\n$$\nThe gradient of the yield function, which defines the direction of plastic flow $\\boldsymbol{R}$, is:\n$$\n\\boldsymbol{R} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2} \\frac{\\boldsymbol{s}}{q} + \\frac{\\alpha}{3} \\boldsymbol{I}\n$$\nThe isotropic elastic tensor is $\\mathbb{C}^e = K \\boldsymbol{I} \\otimes \\boldsymbol{I} + 2G \\mathbb{P}_{\\mathrm{dev}}$, where $\\mathbb{P}_{\\mathrm{dev}} = \\mathbb{I} - \\frac{1}{3}\\boldsymbol{I} \\otimes \\boldsymbol{I}$ is the deviatoric projection tensor and $\\mathbb{I}$ is the fourth-order identity tensor. Applying this tensor to $\\boldsymbol{R}$:\n$$\n\\mathbb{C}^e : \\boldsymbol{R} = \\mathbb{C}^e : \\left(\\frac{3}{2} \\frac{\\boldsymbol{s}}{q}\\right) + \\mathbb{C}^e : \\left(\\frac{\\alpha}{3} \\boldsymbol{I}\\right)\n$$\nSince $\\frac{\\boldsymbol{s}}{q}$ is deviatoric and $\\boldsymbol{I}$ is volumetric, we get:\n$$\n\\mathbb{C}^e : \\boldsymbol{R} = 2G \\left(\\frac{3}{2} \\frac{\\boldsymbol{s}}{q}\\right) + K (\\boldsymbol{I} \\otimes \\boldsymbol{I}) : \\left(\\frac{\\alpha}{3} \\boldsymbol{I}\\right) = 3G \\frac{\\boldsymbol{s}}{q} + \\alpha K \\boldsymbol{I}\n$$\nSubstituting this into the return mapping equation, evaluated at $\\boldsymbol{\\sigma}_{n+1}$:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\lambda \\left( 3G \\frac{\\boldsymbol{s}_{n+1}}{q_{n+1}} + \\alpha K \\boldsymbol{I} \\right)\n$$\nDecomposing into hydrostatic and deviatoric parts ($\\boldsymbol{s}_{n+1} = \\boldsymbol{\\sigma}_{n+1} - p_{n+1}\\boldsymbol{I}$):\n$$\np_{n+1}\\boldsymbol{I} + \\boldsymbol{s}_{n+1} = p^{\\mathrm{tr}}\\boldsymbol{I} + \\boldsymbol{s}^{\\mathrm{tr}} - \\Delta\\lambda (\\alpha K \\boldsymbol{I}) - \\Delta\\lambda \\left( 3G \\frac{\\boldsymbol{s}_{n+1}}{q_{n+1}} \\right)\n$$\nEquating the respective parts gives the update rules for the invariants:\nHydrostatic: $p_{n+1} = p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda$\nDeviatoric: $\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 3G \\Delta\\lambda \\frac{\\boldsymbol{s}_{n+1}}{q_{n+1}} \\implies \\boldsymbol{s}_{n+1}\\left(1 + \\frac{3G \\Delta\\lambda}{q_{n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}}$.\nThis implies $\\boldsymbol{s}_{n+1}$ and $\\boldsymbol{s}^{\\mathrm{tr}}$ are coaxial. Taking the norm $\\sqrt{\\frac{3}{2} \\cdot:\\cdot}$ of the deviatoric equation gives:\n$q_{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$.\n\nThe scalar equation for $\\Delta\\lambda$ is obtained by enforcing the consistency condition $f(\\boldsymbol{\\sigma}_{n+1}) = 0$:\n$$\nq_{n+1} + \\alpha p_{n+1} - k = 0\n$$\n$$\n(q^{\\mathrm{tr}} - 3G \\Delta\\lambda) + \\alpha (p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda) - k = 0\n$$\n$$\n(q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k) - (3G + \\alpha^2 K) \\Delta\\lambda = 0\n$$\nThis simplifies to $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) - (3G + \\alpha^2 K) \\Delta\\lambda = 0$.\n\n### Task 2: Solve for $\\Delta\\lambda$ and Compute Updated Invariants\n\nFrom the consistency equation, if plastic loading occurs ($f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) > 0$), the plastic multiplier increment is:\n$$\n\\Delta\\lambda = \\frac{f(\\boldsymbol{\\sigma}^{\\mathrm{tr}})}{3G + \\alpha^2 K} = \\frac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha^2 K}\n$$\nFirst, we compute the invariants of the trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\begin{pmatrix} 10 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$ MPa.\nTrial pressure: $p^{\\mathrm{tr}} = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = \\frac{1}{3}(10+0+0) = \\frac{10}{3}$ MPa.\nTrial deviatoric stress: $\\boldsymbol{s}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - p^{\\mathrm{tr}}\\boldsymbol{I} = \\begin{pmatrix} 20/3 & 0 & 0 \\\\ 0 & -10/3 & 0 \\\\ 0 & 0 & -10/3 \\end{pmatrix}$ MPa.\nTrial deviatoric stress invariant:\n$q^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2}\\left[\\left(\\frac{20}{3}\\right)^2 + \\left(-\\frac{10}{3}\\right)^2 + \\left(-\\frac{10}{3}\\right)^2\\right]} = \\sqrt{\\frac{3}{2}\\frac{600}{9}} = \\sqrt{100} = 10$ MPa.\n\nNext, we check the yield condition with the material parameters $\\alpha=0.2$ and $k=2$ MPa:\n$f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k = 10 + 0.2 \\left(\\frac{10}{3}\\right) - 2 = 8 + \\frac{2}{3} = \\frac{26}{3}$ MPa.\nSince $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) > 0$, plastic loading occurs.\n\nWe compute the denominator $3G + \\alpha^2 K$ with $G=40$ MPa and $K=100$ MPa:\n$3G + \\alpha^2 K = 3(40) + (0.2)^2(100) = 120 + 0.04(100) = 120 + 4 = 124$ MPa.\nThe plastic multiplier is:\n$\\Delta\\lambda = \\frac{26/3}{124} = \\frac{26}{3 \\cdot 124} = \\frac{13}{186}$.\n\nFinally, we compute the updated invariants $p_{n+1}$ and $q_{n+1}$:\n$p_{n+1} = p^{\\mathrm{tr}} - \\alpha K \\Delta\\lambda = \\frac{10}{3} - (0.2)(100)\\left(\\frac{13}{186}\\right) = \\frac{10}{3} - \\frac{260}{186} = \\frac{620 - 260}{186} = \\frac{360}{186} = \\frac{60}{31}$ MPa.\n$q_{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda = 10 - 3(40)\\left(\\frac{13}{186}\\right) = 10 - \\frac{1560}{186} = \\frac{1860 - 1560}{186} = \\frac{300}{186} = \\frac{50}{31}$ MPa.\nWe can check consistency: $q_{n+1} + \\alpha p_{n+1} - k = \\frac{50}{31} + 0.2\\left(\\frac{60}{31}\\right) - 2 = \\frac{50+12}{31} - 2 = \\frac{62}{31} - 2 = 2 - 2 = 0$.\n\n### Task 3: Algorithmic Tangent and Algorithmic Bulk Modulus\n\nThe consistent algorithmic tangent modulus is $\\mathbb{C}^{\\mathrm{alg}} = \\frac{\\mathrm{d}\\boldsymbol{\\sigma}_{n+1}}{\\mathrm{d}\\boldsymbol{\\epsilon}_{n+1}}$. For a total strain-driven problem, the trial stress is $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}^e : (\\boldsymbol{\\epsilon}_{n+1}-\\boldsymbol{\\epsilon}^{p}_n)$, so $\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}^e : \\mathrm{d}\\boldsymbol{\\epsilon}_{n+1}$. Thus, $\\mathbb{C}^{\\mathrm{alg}} = \\frac{\\mathrm{d}\\boldsymbol{\\sigma}_{n+1}}{\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}}} : \\mathbb{C}^e$.\n\nFor plastic loading, the state is governed by the system:\n$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\lambda \\mathbb{C}^e : \\boldsymbol{R}$\n$f(\\boldsymbol{\\sigma}_{n+1}) = 0$.\nwhere $\\boldsymbol{R} = \\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}$. For a radial return algorithm (as derived for DP), the direction of the deviatoric part of the flow vector is constant during the iteration, so we can use $\\boldsymbol{R} \\approx \\boldsymbol{R}^{\\mathrm{tr}} = \\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}^{\\mathrm{tr}}}$.\nUpon differentiation, maintaining consistency $d f(\\boldsymbol{\\sigma}_{n+1}) = \\boldsymbol{R} : d\\boldsymbol{\\sigma}_{n+1} = 0$:\n$\\boldsymbol{R} : (\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathrm{d}(\\Delta\\lambda) \\mathbb{C}^e : \\boldsymbol{R}) = 0 \\implies \\mathrm{d}(\\Delta\\lambda) = \\frac{\\boldsymbol{R}:\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}}}{\\boldsymbol{R}:\\mathbb{C}^e:\\boldsymbol{R}}$.\nWe calculated $\\boldsymbol{R}:\\mathbb{C}^e:\\boldsymbol{R} = 3G + \\alpha^2 K$.\nSubstituting $\\mathrm{d}(\\Delta\\lambda)$ back into the linearized return map $\\mathrm{d}\\boldsymbol{\\sigma}_{n+1} = \\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathrm{d}(\\Delta\\lambda) \\mathbb{C}^e:\\boldsymbol{R}$:\n$$\n\\mathrm{d}\\boldsymbol{\\sigma}_{n+1} = \\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\frac{\\boldsymbol{R}:\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}}}{3G+\\alpha^2K} (\\mathbb{C}^e:\\boldsymbol{R}) = \\left( \\mathbb{I} - \\frac{(\\mathbb{C}^e:\\boldsymbol{R}) \\otimes \\boldsymbol{R}}{3G+\\alpha^2K} \\right) : \\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}}\n$$\nFrom this, $\\frac{\\mathrm{d}\\boldsymbol{\\sigma}_{n+1}}{\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}}}$ is identified. The algorithmic tangent is:\n$$\n\\mathbb{C}^{\\mathrm{alg}} = \\left( \\mathbb{I} - \\frac{(\\mathbb{C}^e:\\boldsymbol{R}) \\otimes \\boldsymbol{R}}{3G+\\alpha^2K} \\right) : \\mathbb{C}^e = \\mathbb{C}^e - \\frac{(\\mathbb{C}^e:\\boldsymbol{R}) \\otimes (\\mathbb{C}^e:\\boldsymbol{R})}{3G+\\alpha^2K}\n$$\n\nThe algorithmic bulk modulus is $K^{\\mathrm{alg}} = \\mathrm{d}p / \\mathrm{d}\\varepsilon_{v}$ for a purely volumetric strain increment $\\mathrm{d}\\boldsymbol{\\epsilon} = \\mathrm{d}\\varepsilon_v \\frac{1}{3}\\boldsymbol{I}$. This corresponds to a trial stress increment $\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}^e : (\\mathrm{d}\\varepsilon_v \\frac{1}{3}\\boldsymbol{I}) = K \\mathrm{d}\\varepsilon_v \\boldsymbol{I} = \\mathrm{d}p^{\\mathrm{tr}} \\boldsymbol{I}$.\nThe change in pressure is $\\mathrm{d}p_{n+1} = \\frac{1}{3} \\boldsymbol{I} : \\mathrm{d}\\boldsymbol{\\sigma}_{n+1}$. Using the expression for $\\mathrm{d}\\boldsymbol{\\sigma}_{n+1}$:\n$$\n\\mathrm{d}p_{n+1} = \\frac{1}{3}\\boldsymbol{I} : \\left( \\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\frac{\\boldsymbol{R}:\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}}}{3G+\\alpha^2K} (\\mathbb{C}^e:\\boldsymbol{R}) \\right)\n$$\nWith $\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} = K \\mathrm{d}\\varepsilon_v \\boldsymbol{I}$:\n$\\frac{1}{3}\\boldsymbol{I}:\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\frac{1}{3}\\boldsymbol{I}:(K\\mathrm{d}\\varepsilon_v \\boldsymbol{I}) = K\\mathrm{d}\\varepsilon_v$.\n$\\boldsymbol{R}:\\mathrm{d}\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\left(\\frac{3}{2}\\frac{\\boldsymbol{s}^{\\mathrm{tr}}}{q^{\\mathrm{tr}}} + \\frac{\\alpha}{3} \\boldsymbol{I}\\right) : (K\\mathrm{d}\\varepsilon_v \\boldsymbol{I}) = 0 + \\frac{\\alpha}{3}K\\mathrm{d}\\varepsilon_v (\\boldsymbol{I}:\\boldsymbol{I}) = \\alpha K \\mathrm{d}\\varepsilon_v$.\n$\\frac{1}{3}\\boldsymbol{I}:(\\mathbb{C}^e:\\boldsymbol{R}) = \\frac{1}{3}\\boldsymbol{I}:\\left(3G\\frac{\\boldsymbol{s}^{\\mathrm{tr}}}{q^{\\mathrm{tr}}} + \\alpha K \\boldsymbol{I}\\right) = 0 + \\frac{1}{3}\\alpha K (\\boldsymbol{I}:\\boldsymbol{I}) = \\alpha K$.\nSubstituting these parts back:\n$$\n\\mathrm{d}p_{n+1} = K\\mathrm{d}\\varepsilon_v - \\frac{\\alpha K \\mathrm{d}\\varepsilon_v}{3G+\\alpha^2K}(\\alpha K) = K\\mathrm{d}\\varepsilon_v \\left(1 - \\frac{\\alpha^2 K}{3G+\\alpha^2K}\\right)\n$$\n$$\n\\mathrm{d}p_{n+1} = K\\mathrm{d}\\varepsilon_v \\left(\\frac{3G+\\alpha^2K - \\alpha^2 K}{3G+\\alpha^2K}\\right) = K \\frac{3G}{3G+\\alpha^2K} \\mathrm{d}\\varepsilon_v\n$$\nThus, the algorithmic bulk modulus is:\n$$\nK^{\\mathrm{alg}} = \\frac{\\mathrm{d}p_{n+1}}{\\mathrm{d}\\varepsilon_v} = K \\frac{3G}{3G+\\alpha^2K}\n$$\n\n### Task 4: Numerical Evaluation of Algorithmic Bulk Modulus\n\nUsing the given data: $K = 100$ MPa, $G = 40$ MPa, $\\alpha=0.2$.\n$$\nK^{\\mathrm{alg}} = 100 \\frac{3(40)}{3(40) + (0.2)^2(100)} = 100 \\frac{120}{120 + 0.04(100)} = 100 \\frac{120}{120+4}\n$$\n$$\nK^{\\mathrm{alg}} = 100 \\frac{120}{124} = 100 \\frac{30}{31} = \\frac{3000}{31} \\approx 96.77419... \\text{ MPa}\n$$\nRounding to four significant figures, the result is $96.77$ MPa.", "answer": "$$\n\\boxed{96.77}\n$$", "id": "3508082"}, {"introduction": "After deriving the algorithmic tangent $\\mathbb{C}^{\\text{alg}}$, it is crucial to understand what makes it \"consistent\" and how it differs from the perhaps more intuitive continuum elastoplastic tangent $\\mathbb{C}^{\\text{ep}}$. This practice illuminates this key distinction by having you derive both tangents for a special loading case and compare them directly. This exercise demonstrates that the consistent tangent is the exact linearization of the *numerical algorithm* itself, which is not generally the same as the tangent of the underlying continuum theory, a fundamental insight for understanding why it is the key to quadratic convergence in a Newton-Raphson scheme [@problem_id:3508098].", "problem": "Consider a small-strain, isotropic, elastoplastic soil following the Drucker–Prager model with associated flow in three spatial dimensions. Let the Cauchy stress be denoted by $\\boldsymbol{\\sigma}$, the linear elastic moduli by $K$ (bulk modulus) and $G$ (shear modulus), and define the hydrostatic pressure $p = \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$ (compression positive) and the second invariant measure $q = \\sqrt{\\tfrac{3}{2} \\, \\boldsymbol{s}:\\boldsymbol{s}}$, where $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\, \\boldsymbol{I}$ is the deviatoric stress and $\\boldsymbol{I}$ is the second-order identity tensor. The Drucker–Prager yield function is\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = q + \\eta \\, p - c(\\kappa),\n$$\nwith friction parameter $\\eta > 0$ and cohesion $c(\\kappa) = c_{0} + H \\, \\kappa$, where $H \\ge 0$ is a linear isotropic hardening modulus and $\\kappa$ is a scalar internal variable. The flow is associated, so the plastic potential equals the yield function. The elastic law is $\\boldsymbol{\\sigma} = 2 G \\, \\boldsymbol{\\varepsilon}^{e}_{\\text{dev}} + K \\, \\varepsilon^{e}_{v} \\, \\boldsymbol{I}$ with $\\varepsilon^{e}_{v} = \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e})$ and $\\boldsymbol{\\varepsilon}^{e}_{\\text{dev}} = \\boldsymbol{\\varepsilon}^{e} - \\tfrac{1}{3} \\varepsilon^{e}_{v} \\boldsymbol{I}$.\n\nYou are given a single backward-Euler constitutive update from step $n$ to step $n+1$ under a prescribed purely volumetric strain increment\n$$\n\\Delta \\boldsymbol{\\varepsilon} = \\frac{\\Delta \\varepsilon_{v}}{3} \\, \\boldsymbol{I},\n$$\nwith $\\Delta \\varepsilon_{v}$ a constant. Assume the deviatoric flow direction\n$$\n\\boldsymbol{n} := \\frac{\\boldsymbol{s}}{q}\n$$\nis well-defined at step $n$ (i.e., $q_{n} > 0$) and remains fixed during the increment. The algorithm uses the standard elastic predictor/plastic corrector with plastic multiplier increment $\\Delta \\gamma$ and updates $c_{n+1} = c_{n} + H \\, \\Delta \\gamma$.\n\n1. Starting from these definitions and the backward-Euler update, derive the algorithmic consistent tangent $\\mathbb{C}^{\\text{alg}}$, and from it extract the scalar volumetric projection\n$$\nK^{\\text{alg}} := \\frac{1}{9} \\, \\boldsymbol{I} : \\mathbb{C}^{\\text{alg}} : \\boldsymbol{I} = \\frac{\\mathrm{d} p_{n+1}}{\\mathrm{d} (\\Delta \\varepsilon_{v})}.\n$$\n\n2. Independently, linearize the rate equations in the continuum (without time discretization) to obtain the continuum elastoplastic tangent $\\mathbb{C}^{\\text{ep}}$ at the same state, and compute its volumetric projection\n$$\nK^{\\text{cont}} := \\frac{1}{9} \\, \\boldsymbol{I} : \\mathbb{C}^{\\text{ep}} : \\boldsymbol{I}.\n$$\n\n3. Compute the quantitative comparison\n$$\nr := \\frac{K^{\\text{alg}}}{K^{\\text{cont}}}.\n$$\n\nExpress your final answer as a single real number. No rounding is required. No units are required because $r$ is dimensionless. All assumptions and steps must be justified from the given model definitions and standard small-strain elastoplasticity principles, without invoking any unintroduced shortcut formulas.", "solution": "The problem asks for the ratio of the algorithmic and continuum tangent bulk moduli, $r = \\frac{K^{\\text{alg}}}{K^{\\text{cont}}}$, for a Drucker-Prager material under a purely volumetric strain increment. We will derive each quantity in turn and then compute their ratio.\n\nPart 1: Derivation of the Algorithmic Bulk Modulus, $K^{\\text{alg}}$\n\nThe algorithmic update follows an elastic predictor/plastic corrector scheme. The total strain increment is given as purely volumetric: $\\Delta \\boldsymbol{\\varepsilon} = \\frac{\\Delta \\varepsilon_{v}}{3} \\boldsymbol{I}$.\n\nElastic Predictor:\nThe trial stress state, assuming a purely elastic increment, is:\n$$\n\\boldsymbol{\\sigma}^{\\text{trial}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta\\boldsymbol{\\varepsilon}\n$$\nwhere $\\mathbb{C}^{e} = 2 G \\mathbb{I}^{\\text{dev}} + K \\boldsymbol{I} \\otimes \\boldsymbol{I}$ is the isotropic elastic stiffness tensor. For the given strain increment, the stress increment is purely hydrostatic:\n$$\n\\mathbb{C}^{e} : \\Delta\\boldsymbol{\\varepsilon} = (2 G \\mathbb{I}^{\\text{dev}} + K \\boldsymbol{I} \\otimes \\boldsymbol{I}) : (\\frac{\\Delta \\varepsilon_{v}}{3} \\boldsymbol{I}) = \\frac{K \\Delta \\varepsilon_{v}}{3} (\\boldsymbol{I}:\\boldsymbol{I}) = K \\Delta \\varepsilon_{v} \\boldsymbol{I}\n$$\nThe trial stress is therefore:\n$$\n\\boldsymbol{\\sigma}^{\\text{trial}} = \\boldsymbol{\\sigma}_{n} + K \\Delta \\varepsilon_{v} \\boldsymbol{I}\n$$\nWe decompose this into trial pressure $p^{\\text{trial}}$ and trial deviatoric stress $\\boldsymbol{s}^{\\text{trial}}$:\n$$\np^{\\text{trial}} = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}^{\\text{trial}}) = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}_{n}) + \\frac{1}{3} \\operatorname{tr}(K \\Delta \\varepsilon_{v} \\boldsymbol{I}) = p_{n} + K \\Delta \\varepsilon_{v}\n$$\n$$\n\\boldsymbol{s}^{\\text{trial}} = \\boldsymbol{\\sigma}^{\\text{trial}} - p^{\\text{trial}} \\boldsymbol{I} = (\\boldsymbol{\\sigma}_{n} - p_{n}\\boldsymbol{I}) + (K \\Delta \\varepsilon_{v} \\boldsymbol{I} - K \\Delta \\varepsilon_{v} \\boldsymbol{I}) = \\boldsymbol{s}_{n}\n$$\nConsequently, the trial second invariant measure $q^{\\text{trial}}$ is:\n$$\nq^{\\text{trial}} = \\sqrt{\\frac{3}{2} \\boldsymbol{s}^{\\text{trial}}:\\boldsymbol{s}^{\\text{trial}}} = \\sqrt{\\frac{3}{2} \\boldsymbol{s}_{n}:\\boldsymbol{s}_{n}} = q_{n}\n$$\nThe yield function is evaluated at the trial state, using the cohesion from step $n$, $c_n$:\n$$\nf^{\\text{trial}} = q^{\\text{trial}} + \\eta \\, p^{\\text{trial}} - c_{n} = q_{n} + \\eta (p_{n} + K \\Delta \\varepsilon_{v}) - c_{n} = (q_{n} + \\eta p_{n} - c_{n}) + \\eta K \\Delta \\varepsilon_{v}\n$$\nAssuming the state at step $n$ is on the yield surface, $f_{n} = q_{n} + \\eta p_{n} - c_{n} = 0$. This simplifies the trial yield value to:\n$$\nf^{\\text{trial}} = \\eta K \\Delta \\varepsilon_{v}\n$$\nPlastic loading occurs if $f^{\\text{trial}} > 0$. Since $\\eta > 0$ and $K > 0$, this requires $\\Delta \\varepsilon_{v} > 0$ (volumetric compression). We proceed assuming a plastic step.\n\nPlastic Corrector (Return Mapping):\nThe backward-Euler update rules are:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{trial}} - \\Delta\\gamma \\, \\mathbb{C}^{e} : \\boldsymbol{m}_{n+1}\n$$\n$$\nc_{n+1} = c_{n} + H \\Delta\\gamma\n$$\nsubject to the consistency condition $f(\\boldsymbol{\\sigma}_{n+1}, c_{n+1}) = 0$. The plastic flow direction $\\boldsymbol{m}$ is given by the derivative of the yield function (associated flow):\n$$\n\\boldsymbol{m} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\eta \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}}\n$$\nThe derivatives are $\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3} \\boldsymbol{I}$ and $\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2} \\frac{\\boldsymbol{s}}{q} = \\frac{3}{2} \\boldsymbol{n}$. Thus:\n$$\n\\boldsymbol{m} = \\frac{3}{2} \\boldsymbol{n} + \\frac{\\eta}{3} \\boldsymbol{I}\n$$\nThe problem states that $\\boldsymbol{n}$ is fixed during the increment. This is consistent with our finding that $\\boldsymbol{s}^{\\text{trial}}=\\boldsymbol{s}_{n}$, which means the return mapping for the deviatoric stress must be collinear with $\\boldsymbol{s}_{n}$ and hence $\\boldsymbol{n}_n$, yielding $\\boldsymbol{n}_{n+1}=\\boldsymbol{n}_n=\\boldsymbol{n}$.\nWe use $\\boldsymbol{m}_{n+1} = \\frac{3}{2} \\boldsymbol{n} + \\frac{\\eta}{3} \\boldsymbol{I}$. The stress correction term is:\n$$\n\\mathbb{C}^{e} : \\boldsymbol{m}_{n+1} = (2 G \\mathbb{I}^{\\text{dev}} + K \\boldsymbol{I} \\otimes \\boldsymbol{I}) : \\left(\\frac{3}{2}\\boldsymbol{n} + \\frac{\\eta}{3}\\boldsymbol{I}\\right) = 2G\\left(\\frac{3}{2}\\boldsymbol{n}\\right) + K\\left(\\frac{\\eta}{3}\\right)(\\boldsymbol{I}:\\boldsymbol{I}) = 3G\\boldsymbol{n} + K\\eta\\boldsymbol{I}\n$$\nThe updated stress is:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{trial}} - \\Delta\\gamma (3G\\boldsymbol{n} + K\\eta\\boldsymbol{I})\n$$\nDecomposing this gives the updated pressure and deviatoric stress:\n$$\np_{n+1} = p^{\\text{trial}} - \\Delta\\gamma K\\eta = p_{n} + K\\Delta\\varepsilon_{v} - K\\eta\\Delta\\gamma\n$$\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}} - \\Delta\\gamma (3G\\boldsymbol{n}) = \\boldsymbol{s}_{n} - 3G\\Delta\\gamma \\boldsymbol{n} = (q_{n} - 3G\\Delta\\gamma)\\boldsymbol{n}\n$$\nFrom the expression for $\\boldsymbol{s}_{n+1}$, we find $q_{n+1} = q_{n} - 3G\\Delta\\gamma$, assuming $q_{n} > 3G\\Delta\\gamma$.\nNow, we enforce the consistency condition $q_{n+1} + \\eta p_{n+1} - c_{n+1} = 0$:\n$$\n(q_{n} - 3G\\Delta\\gamma) + \\eta(p_{n} + K\\Delta\\varepsilon_{v} - K\\eta\\Delta\\gamma) - (c_{n} + H\\Delta\\gamma) = 0\n$$\nRearranging and using $f_{n} = q_{n} + \\eta p_{n} - c_{n} = 0$:\n$$\n\\eta K \\Delta\\varepsilon_{v} = \\Delta\\gamma (3G + K\\eta^{2} + H)\n$$\nSolving for the plastic multiplier increment $\\Delta\\gamma$:\n$$\n\\Delta\\gamma = \\frac{\\eta K \\Delta\\varepsilon_{v}}{3G + K\\eta^{2} + H}\n$$\nSubstitute this back into the equation for $p_{n+1}$:\n$$\np_{n+1} = p_{n} + K\\Delta\\varepsilon_{v} - K\\eta \\left( \\frac{\\eta K \\Delta\\varepsilon_{v}}{3G + K\\eta^{2} + H} \\right) = p_{n} + \\left( K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H} \\right) \\Delta\\varepsilon_{v}\n$$\nThe algorithmic bulk modulus is the derivative of $p_{n+1}$ with respect to $\\Delta\\varepsilon_{v}$:\n$$\nK^{\\text{alg}} = \\frac{\\mathrm{d} p_{n+1}}{\\mathrm{d} (\\Delta \\varepsilon_{v})} = K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\n\nPart 2: Derivation of the Continuum Tangent Bulk Modulus $K^{\\text{cont}}$\n\nThe continuum tangent relates stress rates to strain rates, $\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C}^{\\text{ep}} : \\dot{\\boldsymbol{\\varepsilon}}$. It is derived from the consistency condition $\\dot{f}=0$. The rate equations for a plastic state are:\n$\\dot{\\boldsymbol{\\varepsilon}} = \\dot{\\boldsymbol{\\varepsilon}}^{e} + \\dot{\\boldsymbol{\\varepsilon}}^{p}$, with $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\gamma} \\boldsymbol{m}$.\n$\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C}^{e} : \\dot{\\boldsymbol{\\varepsilon}}^{e} = \\mathbb{C}^{e} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\gamma}\\boldsymbol{m})$.\n$\\dot{f} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} : \\dot{\\boldsymbol{\\sigma}} + \\frac{\\partial f}{\\partial c} \\dot{c} = \\boldsymbol{m} : \\dot{\\boldsymbol{\\sigma}} - \\dot{c} = 0$.\nWith linear hardening, $\\dot{c}=H\\dot{\\kappa}=H\\dot{\\gamma}$. So, $\\boldsymbol{m} : \\dot{\\boldsymbol{\\sigma}} - H\\dot{\\gamma} = 0$.\n\nSubstitute the stress rate into the consistency condition:\n$$\n\\boldsymbol{m} : [\\mathbb{C}^{e} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\gamma}\\boldsymbol{m})] - H\\dot{\\gamma} = 0\n$$\n$$\n\\boldsymbol{m} : \\mathbb{C}^{e} : \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\gamma} (\\boldsymbol{m} : \\mathbb{C}^{e} : \\boldsymbol{m}) - H\\dot{\\gamma} = 0\n$$\nSolving for the plastic multiplier rate $\\dot{\\gamma}$:\n$$\n\\dot{\\gamma} = \\frac{\\boldsymbol{m} : \\mathbb{C}^{e} : \\dot{\\boldsymbol{\\varepsilon}}}{\\boldsymbol{m} : \\mathbb{C}^{e} : \\boldsymbol{m} + H}\n$$\nThe term $\\boldsymbol{m} : \\mathbb{C}^{e} : \\boldsymbol{m}$ is evaluated as:\n$$\n\\boldsymbol{m} : \\mathbb{C}^{e} : \\boldsymbol{m} = \\left(\\frac{3}{2}\\boldsymbol{n} + \\frac{\\eta}{3}\\boldsymbol{I}\\right) : \\left(3G\\boldsymbol{n} + K\\eta\\boldsymbol{I}\\right) = \\frac{9}{2}G(\\boldsymbol{n}:\\boldsymbol{n}) + \\frac{K\\eta^{2}}{3}(\\boldsymbol{I}:\\boldsymbol{I}) = \\frac{9}{2}G\\left(\\frac{2}{3}\\right) + \\frac{K\\eta^{2}}{3}(3) = 3G + K\\eta^{2}\n$$\nSubstituting back to find $\\dot{\\boldsymbol{\\sigma}}$ in terms of $\\dot{\\boldsymbol{\\varepsilon}}$:\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C}^{e} : \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\gamma} (\\mathbb{C}^{e} : \\boldsymbol{m}) = \\mathbb{C}^{e} : \\dot{\\boldsymbol{\\varepsilon}} - \\frac{(\\mathbb{C}^{e} : \\boldsymbol{m}) \\otimes (\\boldsymbol{m} : \\mathbb{C}^{e})}{\\boldsymbol{m} : \\mathbb{C}^{e} : \\boldsymbol{m}+H} : \\dot{\\boldsymbol{\\varepsilon}}\n$$\nThe continuum elastoplastic tangent $\\mathbb{C}^{\\text{ep}}$ is identified as:\n$$\n\\mathbb{C}^{\\text{ep}} = \\mathbb{C}^{e} - \\frac{(\\mathbb{C}^{e} : \\boldsymbol{m}) \\otimes (\\boldsymbol{m} : \\mathbb{C}^{e})}{\\boldsymbol{m} : \\mathbb{C}^{e} : \\boldsymbol{m} + H} = \\mathbb{C}^{e} - \\frac{(3G\\boldsymbol{n} + K\\eta\\boldsymbol{I}) \\otimes (3G\\boldsymbol{n} + K\\eta\\boldsymbol{I})}{3G + K\\eta^{2} + H}\n$$\nThe continuum tangent bulk modulus is $K^{\\text{cont}} = \\frac{1}{9} \\boldsymbol{I} : \\mathbb{C}^{\\text{ep}} : \\boldsymbol{I}$.\n$$\n\\boldsymbol{I} : \\mathbb{C}^{\\text{ep}} : \\boldsymbol{I} = \\boldsymbol{I} : \\mathbb{C}^{e} : \\boldsymbol{I} - \\frac{[\\boldsymbol{I} : (3G\\boldsymbol{n} + K\\eta\\boldsymbol{I})] \\otimes [(3G\\boldsymbol{n} + K\\eta\\boldsymbol{I}) : \\boldsymbol{I}]}{3G + K\\eta^{2} + H}\n$$\nWe evaluate the projected terms:\n$\\boldsymbol{I} : \\mathbb{C}^{e} : \\boldsymbol{I} = \\boldsymbol{I} : (3K\\boldsymbol{I}) = 3K(\\boldsymbol{I}:\\boldsymbol{I}) = 9K$.\n$\\boldsymbol{I} : (3G\\boldsymbol{n} + K\\eta\\boldsymbol{I}) = 3G(\\boldsymbol{I}:\\boldsymbol{n}) + K\\eta(\\boldsymbol{I}:\\boldsymbol{I}) = 3G(0) + K\\eta(3) = 3K\\eta$.\nSubstituting these into the expression for $\\boldsymbol{I} : \\mathbb{C}^{\\text{ep}} : \\boldsymbol{I}$:\n$$\n\\boldsymbol{I} : \\mathbb{C}^{\\text{ep}} : \\boldsymbol{I} = 9K - \\frac{(3K\\eta)(3K\\eta)}{3G + K\\eta^{2} + H} = 9K - \\frac{9K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\nFinally, we find $K^{\\text{cont}}$:\n$$\nK^{\\text{cont}} = \\frac{1}{9}(\\boldsymbol{I} : \\mathbb{C}^{\\text{ep}} : \\boldsymbol{I}) = K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\n\nPart 3: Quantitative Comparison\n\nWe now compare the two derived quantities:\n$$\nK^{\\text{alg}} = K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\n$$\nK^{\\text{cont}} = K - \\frac{K^{2}\\eta^{2}}{3G + K\\eta^{2} + H}\n$$\nThe expressions are identical. This is a special result due to the purely volumetric nature of the strain increment, which ensures that the deviatoric stress direction $\\boldsymbol{n}$ does not change during the increment (since $\\boldsymbol{s}^{\\text{trial}} = \\boldsymbol{s}_{n}$). In this specific case, the exact linearization of the algorithm (algorithmic tangent) coincides with the continuum tangent for the volumetric projection.\nThe ratio is therefore:\n$$\nr = \\frac{K^{\\text{alg}}}{K^{\\text{cont}}} = 1\n$$", "answer": "$$\\boxed{1}$$", "id": "3508098"}, {"introduction": "The theoretical elegance of the consistent tangent finds its ultimate justification in its practical performance. This final hands-on practice transitions from analytical derivation to numerical implementation to provide a tangible demonstration of its power. By setting up a coupled poromechanics problem and comparing the convergence speed of a Newton's solver using the exact consistent tangent versus a simplified, inconsistent one, you will witness the dramatic difference in efficiency. This exercise solidifies the connection between theory and practice, proving that the rigorous derivation of $\\mathbb{C}^{\\text{alg}}$ is not merely an academic pursuit but a practical necessity for creating fast and reliable computational tools [@problem_id:3508087].", "problem": "Consider a one-dimensional confined compression test with drainage of a saturated porous medium governed by Biot's theory of poromechanics. Let the unknowns at the end of a time step be the volumetric strain $e$ of the solid skeleton and the pore pressure $p$ of the pore fluid. Work under the small-strain, quasi-static, isothermal, single-phase fluid assumptions. Let the total Cauchy stress in the axial loading direction be given by $\\sigma = \\sigma^{\\prime} - \\alpha\\,p$, where $\\sigma^{\\prime}$ is the effective stress of the skeleton and $\\alpha$ is the Biot coefficient. Adopt a nonlinear elastic volumetric effective stress law $\\sigma^{\\prime}(e) = K_0\\,e + \\beta\\,e^3$ with $K_0 > 0$ and $\\beta \\ge 0$. Assume backward Euler time discretization of the fluid mass balance with storage coefficient $S$ and a lumped hydraulic conductance term $\\ell$ to represent drainage to an external reservoir at zero external pressure. All physical quantities are scalar in this setting.\n\nFrom first principles, derive the coupled nonlinear residual vector $\\boldsymbol{r}(e,p)$, based on:\n- Total stress equilibrium with an applied axial total stress at the end of step $\\sigma_{\\text{app}}$,\n- Backward Euler discretization of the fluid mass balance with storage and a linearized drainage term proportional to $p$.\n\nHere, $e^n$ and $p^n$ denote the converged values at the previous time step, and $\\Delta t$ is the time step.\n\nThen, derive the consistent tangent (Jacobian) matrix $\\boldsymbol{K}_{\\text{cons}}(e,p)$ as the exact derivative of $\\boldsymbol{r}(e,p)$ with respect to the unknowns $(e,p)$. Define also an inconsistent solid tangent $\\boldsymbol{K}_{\\text{incons}}(e,p)$ obtained by replacing the derivative $\\mathrm{d}\\sigma^{\\prime}/\\mathrm{d}e$ in the momentum block with the constant $K_0$ (i.e., ignoring the contribution from the nonlinear term $\\beta\\,e^3$), while keeping all other Jacobian entries exact.\n\nYour program must:\n- Implement Newton's method to solve $\\boldsymbol{r}(e,p) = \\boldsymbol{0}$ with both the consistent tangent and the inconsistent tangent. Use the same initial guess $(e^0,p^0) = (e^n,p^n)$ for both solves.\n- Use a backtracking line search on the Newton update to ensure robust convergence, with a sufficient decrease criterion on the Euclidean norm of the residual.\n- Terminate when the ratio $\\lVert \\boldsymbol{r}_k \\rVert_2 / \\lVert \\boldsymbol{r}_0 \\rVert_2 \\le \\varepsilon$ with tolerance $\\varepsilon$, or when a maximum number of iterations is reached. If the initial residual is zero, return zero iterations.\n- Report, for each test case, two integers: the number of Newton iterations for the consistent tangent and for the inconsistent tangent, each being the number of nonlinear iterations performed to reach the specified tolerance. If the method fails to converge within the iteration cap, return the cap value plus one for that method.\n\nBase your derivation on the following foundational relations:\n- Effective stress principle: $\\sigma = \\sigma^{\\prime} - \\alpha\\,p$,\n- Volumetric nonlinear elastic law: $\\sigma^{\\prime}(e) = K_0\\,e + \\beta\\,e^3$ with tangent $\\mathrm{d}\\sigma^{\\prime}/\\mathrm{d}e = K_0 + 3\\,\\beta\\,e^2$,\n- Backward Euler fluid mass balance for a lumped system exchanging mass with an external reservoir at zero pressure: $\\alpha\\,(e - e^n) + S\\,(p - p^n) + \\Delta t\\,\\ell\\,p = 0$.\n\nUse the following units and numerical requirements:\n- Express stress-related quantities in megapascals (MPa), time in seconds (s), and strains as dimensionless.\n- The storage $S$ must be in $\\text{MPa}^{-1}$, the conductance $\\ell$ in $\\text{MPa}^{-1}\\,\\text{s}^{-1}$, and the Biot coefficient $\\alpha$ is dimensionless.\n- Use a convergence tolerance $\\varepsilon = 10^{-10}$, a maximum of $N_{\\max} = 50$ Newton iterations, an Armijo parameter $c = 10^{-4}$, and a backtracking factor $\\gamma = 0.5$.\n\nTest suite:\n- Case A (near-linear, happy path): $K_0 = 1000$, $\\beta = 0$, $\\alpha = 1.0$, $S = 10^{-3}$, $\\Delta t = 1.0$, \\,$\\ell = 10^{-2}$, $\\sigma_{\\text{app}} = 10$, $e^n = 0$, $p^n = 0$.\n- Case B (moderate nonlinearity, moderate coupling): $K_0 = 1000$, $\\beta = 5\\times 10^{5}$, $\\alpha = 0.9$, $S = 10^{-3}$, $\\Delta t = 1.0$, \\,$\\ell = 10^{-2}$, $\\sigma_{\\text{app}} = 100$, $e^n = 0$, $p^n = 0$.\n- Case C (strong nonlinearity, stiff coupling): $K_0 = 1000$, $\\beta = 10^{6}$, $\\alpha = 0.9$, $S = 10^{-6}$, $\\Delta t = 5.0$, \\,$\\ell = 10^{-1}$, $\\sigma_{\\text{app}} = 100$, $e^n = 0$, $p^n = 0$.\n\nAll numerical values above are in their specified units. For example, $K_0$ and $\\beta$ are in megapascals, $\\Delta t$ is in seconds.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as:\n$[\\text{it}_{\\text{cons},A}, \\text{it}_{\\text{incons},A}, \\text{it}_{\\text{cons},B}, \\text{it}_{\\text{incons},B}, \\text{it}_{\\text{cons},C}, \\text{it}_{\\text{incons},C}]$,\nwhere each entry is an integer equal to the number of iterations used by the corresponding Newton solve. If a solve fails to converge in at most $N_{\\max}$ iterations, report $N_{\\max} + 1$ for that entry.", "solution": "The problem requires the derivation of the governing equations and the implementation of a numerical solution for a one-dimensional, quasi-static, poromechanical system. The state of the system at the end of a time step is described by two scalar unknowns: the volumetric strain of the solid skeleton, $e$, and the pore fluid pressure, $p$. We assemble these into a state vector $\\boldsymbol{x} = [e, p]^T$. The problem is to find $\\boldsymbol{x}$ that solves the nonlinear system of equations $\\boldsymbol{r}(\\boldsymbol{x}) = \\boldsymbol{0}$, where $\\boldsymbol{r}$ is the residual vector.\n\nThe residual vector is derived from two fundamental physical principles: the balance of momentum (stress equilibrium) and the balance of fluid mass.\n\nFirst, we establish the residual component from the momentum balance equation. In this quasi-static, one-dimensional setting, the total stress $\\sigma$ must be in equilibrium with the externally applied stress, $\\sigma_{\\text{app}}$. The first residual equation, $r_1$, expresses this balance:\n$$r_1(e,p) = \\sigma - \\sigma_{\\text{app}} = 0$$\nThe problem provides the effective stress principle, $\\sigma = \\sigma^{\\prime} - \\alpha p$, where $\\sigma^{\\prime}$ is the effective stress and $\\alpha$ is the Biot coefficient. The constitutive law for the solid skeleton is a nonlinear elastic relation between effective stress and volumetric strain: $\\sigma^{\\prime}(e) = K_0 e + \\beta e^3$. Substituting these relationships into the equilibrium equation gives the first component of the residual vector:\n$$r_1(e,p) = (K_0 e + \\beta e^3) - \\alpha p - \\sigma_{\\text{app}}$$\n\nSecond, we establish the residual component from the fluid mass balance. The problem provides the time-discretized form of this balance equation using the backward Euler method. This equation relates the change in strain, the change in pressure, and the drainage of pore fluid over a time step $\\Delta t$. Let $e^n$ and $p^n$ be the converged values from the previous time step. The fluid mass balance is given as:\n$$\\alpha(e - e^n) + S(p - p^n) + \\Delta t \\, \\ell \\, p = 0$$\nwhere $S$ is the storage coefficient and $\\ell$ is the hydraulic conductance. The second residual component, $r_2$, is simply this equation rearranged:\n$$r_2(e,p) = \\alpha(e - e^n) + S(p - p^n) + \\Delta t \\, \\ell \\, p$$\nWe can group terms related to the current unknowns $(e, p)$ to write it as:\n$$r_2(e,p) = \\alpha e + (S + \\Delta t \\, \\ell)p - (\\alpha e^n + S p^n)$$\n\nCombining these two components, the full residual vector $\\boldsymbol{r}(e,p)$ is:\n$$\\boldsymbol{r}(e,p) = \\begin{pmatrix} r_1(e,p) \\\\ r_2(e,p) \\end{pmatrix} = \\begin{pmatrix} K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}} \\\\ \\alpha(e - e^n) + (S + \\Delta t \\, \\ell)p - S p^n \\end{pmatrix}$$\n\nTo solve the nonlinear system $\\boldsymbol{r}(\\boldsymbol{x}) = \\boldsymbol{0}$, we use Newton's method. This iterative method requires the consistent tangent matrix, which is the Jacobian of the residual vector with respect to the state variables, $\\boldsymbol{K}_{\\text{cons}} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\boldsymbol{x}}$. The matrix components are the partial derivatives of the residual components:\n$$\\boldsymbol{K}_{\\text{cons}}(e,p) = \\begin{pmatrix} \\frac{\\partial r_1}{\\partial e} & \\frac{\\partial r_1}{\\partial p} \\\\ \\frac{\\partial r_2}{\\partial e} & \\frac{\\partial r_2}{\\partial p} \\end{pmatrix}$$\n\nThe individual components are calculated as follows:\n$\\frac{\\partial r_1}{\\partial e} = \\frac{\\mathrm{d}}{\\mathrm{d}e} (K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}}) = K_0 + 3\\beta e^2$. This term is the tangent bulk modulus of the solid skeleton, $K_T(e)$.\n$\\frac{\\partial r_1}{\\partial p} = \\frac{\\mathrm{d}}{\\mathrm{d}p} (K_0 e + \\beta e^3 - \\alpha p - \\sigma_{\\text{app}}) = -\\alpha$.\n$\\frac{\\partial r_2}{\\partial e} = \\frac{\\mathrm{d}}{\\mathrm{d}e} (\\alpha e + (S + \\Delta t \\, \\ell)p - \\alpha e^n - S p^n) = \\alpha$.\n$\\frac{\\partial r_2}{\\partial p} = \\frac{\\mathrm{d}}{\\mathrm{d}p} (\\alpha e + (S + \\Delta t \\, \\ell)p - \\alpha e^n - S p^n) = S + \\Delta t \\, \\ell$.\n\nAssembling these gives the consistent tangent matrix:\n$$\\boldsymbol{K}_{\\text{cons}}(e,p) = \\begin{pmatrix} K_0 + 3\\beta e^2 & -\\alpha \\\\ \\alpha & S + \\Delta t \\, \\ell \\end{pmatrix}$$\n\nThe problem also defines an inconsistent tangent matrix, $\\boldsymbol{K}_{\\text{incons}}$, which is formed by approximating the tangent modulus of the solid skeleton, $\\frac{\\mathrm{d}\\sigma^{\\prime}}{\\mathrm{d}e}$, by its initial value, $K_0$. This means we replace the entry $\\frac{\\partial r_1}{\\partial e}$ in the consistent Jacobian with $K_0$:\n$$\\boldsymbol{K}_{\\text{incons}}(e,p) = \\begin{pmatrix} K_0 & -\\alpha \\\\ \\alpha & S + \\Delta t \\, \\ell \\end{pmatrix}$$\nThis tangent is exact only if the material response is linear ($\\beta=0$) or if the strain $e$ is zero. Using an inconsistent tangent typically degrades the convergence rate of Newton's method from quadratic to linear.\n\nThe Newton-Raphson update step for an iteration $k$ involves solving the linear system $\\boldsymbol{K}(\\boldsymbol{x}_k) \\Delta \\boldsymbol{x}_k = -\\boldsymbol{r}(\\boldsymbol{x}_k)$ for the update vector $\\Delta \\boldsymbol{x}_k = [\\Delta e_k, \\Delta p_k]^T$. The solution is then updated as $\\boldsymbol{x}_{k+1} = \\boldsymbol{x}_k + \\eta_k \\Delta \\boldsymbol{x}_k$. The step length $\\eta_k$ is determined by a backtracking line search to ensure a sufficient decrease in the residual norm, preventing divergence. The specific Armijo condition is $\\lVert \\boldsymbol{r}(\\boldsymbol{x}_k + \\eta_k \\Delta \\boldsymbol{x}_k) \\rVert_2 \\le (1 - c \\eta_k) \\lVert \\boldsymbol{r}(\\boldsymbol{x}_k) \\rVert_2$, with constants $c=10^{-4}$ and backtracking factor $\\gamma=0.5$. The iteration starts with an initial guess $\\boldsymbol{x}_0 = [e^n, p^n]^T$ and terminates when the relative residual norm $\\lVert \\boldsymbol{r}_k \\rVert_2 / \\lVert \\boldsymbol{r}_0 \\rVert_2$ falls below a tolerance $\\varepsilon=10^{-10}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef newton_solver(problem_params, initial_state, use_consistent_tangent):\n    \"\"\"\n    Solves the coupled nonlinear poromechanics problem using Newton's method.\n\n    Args:\n        problem_params (tuple): Physical and discretization parameters.\n        initial_state (tuple): Converged state from the previous step (e^n, p^n).\n        use_consistent_tangent (bool): Flag to use consistent or inconsistent tangent.\n\n    Returns:\n        int: Number of iterations to converge, or max_iter + 1 if failed.\n    \"\"\"\n    # Unpack parameters\n    K0, beta, alpha, S, dt, ell, sigma_app = problem_params\n    e_n, p_n = initial_state\n\n    # Numerical solver settings\n    tol = 1e-10\n    max_iter = 50\n    c_armijo = 1e-4\n    gamma_bt = 0.5\n\n    # Initial guess for the state vector x = [e, p]\n    x = np.array([e_n, p_n], dtype=np.float64)\n\n    def compute_residual(x_vec):\n        \"\"\"Computes the residual vector r(x).\"\"\"\n        e, p = x_vec\n        r1 = K0 * e + beta * e**3 - alpha * p - sigma_app\n        r2 = alpha * (e - e_n) + S * (p - p_n) + dt * ell * p\n        return np.array([r1, r2])\n\n    # Initial residual calculation\n    r0 = compute_residual(x)\n    norm_r0 = np.linalg.norm(r0)\n\n    # If initial guess is already the solution\n    if norm_r0 == 0.0:\n        return 0\n\n    # Main Newton iteration loop\n    for k in range(max_iter):\n        e_k, p_k = x\n        \n        # Calculate current residual and check for convergence\n        r_k = compute_residual(x)\n        norm_r_k = np.linalg.norm(r_k)\n        \n        if norm_r_k / norm_r0 = tol:\n            return k\n\n        # Compute the tangent matrix K\n        if use_consistent_tangent:\n            # Consistent tangent modulus\n            K11 = K0 + 3.0 * beta * e_k**2\n        else:\n            # Inconsistent (initial) tangent modulus\n            K11 = K0\n        \n        K = np.array([\n            [K11, -alpha],\n            [alpha, S + dt * ell]\n        ], dtype=np.float64)\n\n        # Solve the linear system K * dx = -r for the update dx\n        try:\n            dx = np.linalg.solve(K, -r_k)\n        except np.linalg.LinAlgError:\n            # Matrix is singular, cannot proceed\n            return max_iter + 1\n\n        # Backtracking line search to find optimal step length eta\n        eta = 1.0\n        # Armijo condition: ||r(x + eta*dx)|| = (1 - c*eta) * ||r(x)||\n        # We perform a limited number of backtrackings to avoid infinite loops\n        max_backtrack_steps = 20\n        for _ in range(max_backtrack_steps):\n            x_trial = x + eta * dx\n            r_trial = compute_residual(x_trial)\n            norm_r_trial = np.linalg.norm(r_trial)\n            \n            if norm_r_trial = (1.0 - c_armijo * eta) * norm_r_k:\n                break  # Sufficient decrease, step is accepted\n            \n            eta *= gamma_bt\n        else:\n            # Line search failed to find a suitable step\n            return max_iter + 1\n\n        # Update the solution vector\n        x += eta * dx\n\n    # Final check after the loop completes (for convergence on the last iteration)\n    r_final = compute_residual(x)\n    if np.linalg.norm(r_final) / norm_r0 = tol:\n        return max_iter\n\n    # If loop finishes without convergence\n    return max_iter + 1\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A: (K0, beta, alpha, S, dt, ell, sigma_app, e_n, p_n)\n        (1000.0, 0.0, 1.0, 1e-3, 1.0, 1e-2, 10.0, 0.0, 0.0),\n        # Case B\n        (1000.0, 5e5, 0.9, 1e-3, 1.0, 1e-2, 100.0, 0.0, 0.0),\n        # Case C\n        (1000.0, 1e6, 0.9, 1e-6, 5.0, 1e-1, 100.0, 0.0, 0.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        # Extract problem parameters and initial state from the case tuple\n        problem_params = params[:7]\n        initial_state = params[7:]\n\n        # Solve with the consistent tangent\n        iters_cons = newton_solver(problem_params, initial_state, use_consistent_tangent=True)\n        results.append(iters_cons)\n\n        # Solve with the inconsistent tangent\n        iters_incons = newton_solver(problem_params, initial_state, use_consistent_tangent=False)\n        results.append(iters_incons)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3508087"}]}