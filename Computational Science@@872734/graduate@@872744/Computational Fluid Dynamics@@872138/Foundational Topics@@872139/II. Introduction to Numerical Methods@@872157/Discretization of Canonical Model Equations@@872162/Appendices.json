{"hands_on_practices": [{"introduction": "Achieving high accuracy is a central goal in computational fluid dynamics, often requiring higher-order numerical schemes to resolve complex flow features without excessively fine grids. This practice provides the foundational skill of constructing such a scheme from first principles. By systematically using Taylor series expansions, you will derive the coefficients for a fourth-order accurate stencil for the second derivative, a key component in discretizing diffusive terms, and determine its leading error. [@problem_id:3310241]", "problem": "In computational fluid dynamics (CFD), high-order spatial discretizations of diffusive operators are used to control numerical dispersion and dissipation without excessive grid refinement. Consider a smooth scalar field $u(x)$ sampled on a uniform one-dimensional grid with points $x_i = x_0 + i h$, where $h > 0$ is the constant grid spacing and $i \\in \\mathbb{Z}$ indexes interior points. Starting only from Taylor series expansions about the point $x_i$ and the definition of consistency for a discrete approximation to the second derivative, construct a symmetric five-point stencil that approximates $u_{xx}(x_i)$ with fourth-order accuracy. Determine the weights of the stencil in terms of $h$ by enforcing that the discrete operator matches the continuous second derivative and eliminates the lower-order error terms required to achieve fourth-order accuracy. Then, compute the leading truncation error term of this approximation and express it explicitly in terms of $h$ and the sixth derivative $u^{(6)}(x_i)$.\n\nProvide your final result as two closed-form analytic expressions: first, the five-point stencil formula for the approximation to $u_{xx}(x_i)$ normalized by $h^2$, written in terms of the nodal values $u_{i-2}$, $u_{i-1}$, $u_i$, $u_{i+1}$, and $u_{i+2}$; second, the leading truncation error term written as a multiple of $h^4 u^{(6)}(x_i)$. No numerical rounding is required.", "solution": "The user wants to derive a fourth-order accurate, symmetric, five-point finite difference stencil for the second derivative $u_{xx}(x_i)$ and determine its leading truncation error term. The derivation must be based on Taylor series expansions.\n\nLet the approximation of the second derivative $u_{xx}(x_i) = u_i''$ be denoted by $\\delta_{xx} u_i$. For a symmetric five-point stencil centered at $x_i$, the general form of the approximation is given by:\n$$ \\delta_{xx} u_i = c_{-2} u_{i-2} + c_{-1} u_{i-1} + c_0 u_i + c_1 u_{i+1} + c_2 u_{i+2} $$\nwhere $u_{i+j} = u(x_i + j h)$. For a symmetric stencil, the weights must satisfy $c_{-j} = c_j$. Therefore, we have $c_{-1}=c_1$ and $c_{-2}=c_2$. Let's rename the independent coefficients as $A = c_2$, $B = c_1$, and $C = c_0$. The stencil becomes:\n$$ \\delta_{xx} u_i = A u_{i-2} + B u_{i-1} + C u_i + B u_{i+1} + A u_{i+2} $$\n\nTo determine the coefficients $A$, $B$, and $C$, we expand each term $u_{i+j}$ in a Taylor series around the point $x_i$. We denote $u^{(k)}(x_i)$ as $u_i^{(k)}$.\n$$ u_{i+1} = u(x_i+h) = u_i + h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} + \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} + \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i-1} = u(x_i-h) = u_i - h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} - \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} - \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i+2} = u(x_i+2h) = u_i + (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} + \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} + \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i-2} = u(x_i-2h) = u_i - (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} - \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} - \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + O(h^7) $$\n\nSubstitute these expansions into the stencil formula:\n$$ \\delta_{xx} u_i = A(u_{i-2} + u_{i+2}) + B(u_{i-1} + u_{i+1}) + C u_i $$\nBy summing the Taylor series in pairs, the odd-order derivative terms cancel out due to symmetry:\n$$ u_{i+1} + u_{i-1} = 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12} u_i^{(4)} + \\frac{h^6}{360} u_i^{(6)} + O(h^8) $$\n$$ u_{i+2} + u_{i-2} = 2u_i + 4h^2 u_i^{(2)} + \\frac{16h^4}{12} u_i^{(4)} + \\frac{64h^6}{360} u_i^{(6)} + O(h^8) = 2u_i + 4h^2 u_i^{(2)} + \\frac{4h^4}{3} u_i^{(4)} + \\frac{8h^6}{45} u_i^{(6)} + O(h^8) $$\nSubstituting these sums into the expression for $\\delta_{xx} u_i$:\n$$ \\delta_{xx} u_i = A \\left( 2u_i + 4h^2 u_i^{(2)} + \\frac{4h^4}{3} u_i^{(4)} + \\dots \\right) + B \\left( 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12} u_i^{(4)} + \\dots \\right) + C u_i $$\nCollect terms by the order of the derivative of $u_i$:\n$$ \\delta_{xx} u_i = (2A+2B+C) u_i + (4A+B)h^2 u_i^{(2)} + \\left(\\frac{4A}{3} + \\frac{B}{12}\\right)h^4 u_i^{(4)} + O(h^6) $$\n\nFor this operator to be a consistent, fourth-order approximation of $u_i^{(2)}$, we must match the coefficients of the derivatives in the expansion to those of the target operator, $u_i^{(2)}$.\n1.  The coefficient of $u_i$ must be zero: $2A+2B+C = 0$.\n2.  The coefficient of $u_i^{(2)}$ must be one: $(4A+B)h^2 = 1 \\implies 4A+B = \\frac{1}{h^2}$.\n3.  To achieve fourth-order accuracy, the $O(h^2)$ error term must be eliminated. The coefficient of the leading error term, which involves $u_i^{(4)}$, must be zero: $(\\frac{4A}{3} + \\frac{B}{12})h^4 = 0 \\implies \\frac{4A}{3} + \\frac{B}{12} = 0$.\n\nWe solve this system of three linear equations for $A$, $B$, and $C$.\nFrom equation (3):\n$$ \\frac{B}{12} = -\\frac{4A}{3} \\implies B = -16A $$\nSubstitute this into equation (2):\n$$ 4A + (-16A) = \\frac{1}{h^2} \\implies -12A = \\frac{1}{h^2} \\implies A = -\\frac{1}{12h^2} $$\nNow we find $B$:\n$$ B = -16A = -16\\left(-\\frac{1}{12h^2}\\right) = \\frac{16}{12h^2} = \\frac{4}{3h^2} $$\nFinally, from equation (1), we find $C$:\n$$ C = -2A - 2B = -2\\left(-\\frac{1}{12h^2}\\right) - 2\\left(\\frac{4}{3h^2}\\right) = \\frac{1}{6h^2} - \\frac{8}{3h^2} = \\frac{1-16}{6h^2} = -\\frac{15}{6h^2} = -\\frac{5}{2h^2} $$\nThe coefficients are $c_{-2}=c_2=A=-\\frac{1}{12h^2}$, $c_{-1}=c_1=B=\\frac{16}{12h^2}$, and $c_0=C=-\\frac{30}{12h^2}$.\nSubstituting these coefficients into the stencil formula yields the approximation for $u_{xx}(x_i)$:\n$$ u_{xx}(x_i) \\approx \\frac{1}{12h^2} (-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}) $$\nThis is the desired fourth-order stencil formula.\n\nNext, we compute the leading truncation error term. The truncation error $T$ is defined as $T = \\delta_{xx}u_i - u_{xx}(x_i)$. The leading term of $T$ is the first non-zero term in the Taylor expansion of this difference. Since we eliminated the $u_i^{(4)}$ term, the next term is proportional to $u_i^{(6)}$.\nThe full expansion of $\\delta_{xx} u_i$ is:\n$$ \\delta_{xx} u_i = (2A+2B+C) u_i + (4A+B)h^2 u_i^{(2)} + \\left(\\frac{4A}{3} + \\frac{B}{12}\\right)h^4 u_i^{(4)} + \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} + O(h^8) $$\nBy construction, this simplifies to:\n$$ \\delta_{xx} u_i = u_i^{(2)} + \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} + O(h^8) $$\nThe leading truncation error term is therefore:\n$$ T_{\\text{lead}} = \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} $$\nSubstitute the values for $A$ and $B$:\n$A = -\\frac{1}{12h^2}$ and $B = \\frac{16}{12h^2}$.\n$$ T_{\\text{lead}} = \\left(\\frac{8}{45}\\left(-\\frac{1}{12h^2}\\right) + \\frac{1}{360}\\left(\\frac{16}{12h^2}\\right)\\right)h^6 u_i^{(6)} $$\n$$ T_{\\text{lead}} = \\left(-\\frac{8}{540h^2} + \\frac{16}{4320h^2}\\right)h^6 u_i^{(6)} $$\nLet's use a common denominator of $4320$:\n$$ T_{\\text{lead}} = \\left(-\\frac{8 \\times 8}{4320h^2} + \\frac{16}{4320h^2}\\right)h^6 u_i^{(6)} = \\left(\\frac{-64+16}{4320h^2}\\right)h^6 u_i^{(6)} $$\n$$ T_{\\text{lead}} = \\left(\\frac{-48}{4320h^2}\\right)h^6 u_i^{(6)} = -\\frac{48}{4320} h^4 u_i^{(6)} $$\nSimplify the fraction:\n$$ -\\frac{48}{4320} = -\\frac{48}{48 \\times 90} = -\\frac{1}{90} $$\nSo, the leading truncation error term is:\n$$ T_{\\text{lead}} = -\\frac{1}{90}h^4 u_i^{(6)} $$\nThis confirms that the stencil is indeed fourth-order accurate, as the error is proportional to $h^4$.\n\nThe two requested results are the stencil formula and the leading truncation error term.\n1. Stencil formula: $\\delta_{xx} u_i = \\frac{-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}}{12h^2}$\n2. Leading truncation error term: $-\\frac{1}{90}h^4 u^{(6)}(x_i)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}}{12h^2} & -\\frac{1}{90}h^4 u^{(6)}(x_i)\n\\end{pmatrix}\n}\n$$", "id": "3310241"}, {"introduction": "A consistent discretization is only useful if it is also stable, and a stable scheme is only physically meaningful if it preserves fundamental properties of the underlying physics. This exercise bridges the gap between stencil derivation and practical application by analyzing a complete scheme for the heat equation. You will investigate crucial properties like positivity and monotonicity to derive the famous time-step restriction for an explicit scheme, revealing the conditions under which a numerical solution remains physically plausible. [@problem_id:3310197]", "problem": "Consider the one-dimensional heat equation (also called the diffusion equation) in conservation form for a scalar field $u(x,t)$,\n$$\nu_t \\;=\\; \\alpha\\,u_{xx} \\;=\\; -\\,\\partial_x q, \\qquad q \\;=\\; -\\,\\alpha\\,u_x,\n$$\non a periodic domain with uniform spatial grid spacing $\\Delta x$ and time step $\\Delta t$. Suppose you are asked to design a finite volume method (FVM) that evolves cell averages $u_i^n$ of $u(x,t)$ using:\n- a piecewise-constant reconstruction of $u(x,t)$ within each control volume,\n- a centered two-point flux approximation for the diffusive flux $q$ at cell faces, and\n- forward Euler time integration.\n\nYou must ensure nonnegativity (positivity-preserving property) of $u_i^n$ for nonnegative initial data $u_i^0 \\ge 0$ under an explicit time-step restriction. You must also assess the monotonicity of the resulting scheme (in the sense that the update at each cell is a nondecreasing function of each argument in its stencil) and the nonexpansiveness in the $L^\\infty$ norm (that is, $\\|u^{n+1}\\|_\\infty \\le \\|u^n\\|_\\infty$) under the same or related time-step restriction. Finally, compare your FVM with the standard Forward-Time Centered-Space (FTCS) finite difference method for the same equation and grid.\n\nWhich of the following statements is correct?\n\nA. The explicit FVM with centered two-point diffusive flux yields an update of the form $u_i^{n+1} \\,=\\, (1-2\\mu)\\,u_i^n \\,+\\, \\mu\\,u_{i-1}^n \\,+\\, \\mu\\,u_{i+1}^n$, where $\\mu \\,=\\, \\alpha\\,\\Delta t/\\Delta x^2$. For nonnegative data, this scheme is positivity-preserving, monotone, and nonexpansive in $L^\\infty$ if and only if $0 \\le \\mu \\le \\tfrac{1}{2}$. Moreover, this FVM update coincides with the FTCS finite difference method for the heat equation on the same grid.\n\nB. The explicit FVM with centered two-point diffusive flux is positivity-preserving and nonexpansive in $L^\\infty$ for any $0 \\le \\mu \\le 1$, because diffusion is dissipative and conservation alone guarantees nonnegativity.\n\nC. The explicit FVM with centered two-point diffusive flux is conservative and therefore always monotone and positivity-preserving for any $\\Delta t>0$, regardless of the value of $\\mu$.\n\nD. The FTCS finite difference method for the heat equation is unconditionally monotone and nonexpansive in $L^\\infty$ because parabolic equations smooth out oscillations for any $\\Delta t>0$, whereas the FVM requires $0 \\le \\mu \\le \\tfrac{1}{2}$ to be positivity-preserving.", "solution": "The user-provided problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The one-dimensional heat equation in conservation form is $u_t = \\alpha\\,u_{xx} = -\\partial_x q$, with diffusive flux $q = -\\alpha\\,u_x$.\n- **Field:** $u(x,t)$ is a scalar field.\n- **Domain:** The domain is periodic.\n- **Grid:** A uniform spatial grid with spacing $\\Delta x$ and a uniform time step $\\Delta t$.\n- **Numerical Method:** A finite volume method (FVM) is specified with the following characteristics:\n    1. **Variables:** Cell averages, denoted $u_i^n$, where $i$ is the spatial index and $n$ is the time index. A cell $C_i$ is centered at $x_i$ and has boundaries at $x_{i-1/2}$ and $x_{i+1/2}$, with width $\\Delta x = x_{i+1/2} - x_{i-1/2}$.\n    2. **Reconstruction:** Piecewise-constant reconstruction of $u(x,t)$ within each control volume.\n    3. **Flux Approximation:** A centered two-point flux approximation for $q$ at cell faces.\n    4. **Time Integration:** Forward Euler method.\n- **Properties to Analyze:**\n    1. **Nonnegativity (Positivity-Preserving):** Ensuring $u_i^n \\ge 0$ for all $n$ if the initial data $u_i^0 \\ge 0$.\n    2. **Monotonicity:** The update for each cell, $u_i^{n+1}$, must be a nondecreasing function of each of its stencil arguments ($u_{j}^n$).\n    3. **Nonexpansiveness in $L^\\infty$ norm:** $\\|u^{n+1}\\|_\\infty \\le \\|u^n\\|_\\infty$.\n- **Comparison Task:** The derived FVM is to be compared with the standard Forward-Time Centered-Space (FTCS) finite difference method.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It describes a standard exercise in the field of numerical analysis for partial differential equations, specifically for computational fluid dynamics. The governing equation is fundamental, and the specified numerical method (FVM with explicit time stepping) is a well-established technique. The concepts of positivity, monotonicity, and $L^\\infty$ stability are standard criteria for evaluating numerical schemes. The problem is well-posed, objective, and contains all necessary information to derive a unique solution and perform the required analysis. There are no contradictions, ambiguities, or factual errors.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. The solution process will now proceed.\n\n### Derivation and Analysis\n\nWe begin by deriving the finite volume scheme as specified. The conservation law $u_t + \\partial_x q = 0$ is integrated over the control volume $C_i = [x_{i-1/2}, x_{i+1/2}]$:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial u}{\\partial t} \\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial q}{\\partial x} \\,dx = 0\n$$\nDefining the cell average as $u_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\,dx$, the first term becomes $\\Delta x \\frac{d u_i}{dt}$. The second term, by the fundamental theorem of calculus, becomes $q(x_{i+1/2}, t) - q(x_{i-1/2}, t)$. The semi-discretized equation is thus:\n$$\n\\frac{d u_i}{dt} = - \\frac{q_{i+1/2} - q_{i-1/2}}{\\Delta x}\n$$\nwhere $q_{i \\pm 1/2}$ are the fluxes at the cell faces.\n\nThe problem specifies a piecewise-constant reconstruction, meaning we assume $u(x,t) \\approx u_i(t)$ for $x \\in C_i$. The flux is $q = -\\alpha u_x$. We use a \"centered two-point flux approximation\" at the cell face $x_{i+1/2}$, which involves the values from the adjacent cells $i$ and $i+1$. The spatial derivative $u_x$ is approximated by a centered difference based on the cell-average values:\n$$\n(u_x)_{i+1/2} \\approx \\frac{u_{i+1} - u_i}{\\Delta x}\n$$\nThe numerical flux at the face $x_{i+1/2}$ is then:\n$$\nq_{i+1/2} = -\\alpha \\left( \\frac{u_{i+1} - u_i}{\\Delta x} \\right)\n$$\nSimilarly, the flux at the face $x_{i-1/2}$ is:\n$$\nq_{i-1/2} = -\\alpha \\left( \\frac{u_i - u_{i-1}}{\\Delta x} \\right)\n$$\nSubstituting these flux approximations into the semi-discretized equation:\n$$\n\\frac{d u_i}{dt} = - \\frac{1}{\\Delta x} \\left[ -\\alpha \\left( \\frac{u_{i+1} - u_i}{\\Delta x} \\right) - \\left( -\\alpha \\left( \\frac{u_i - u_{i-1}}{\\Delta x} \\right) \\right) \\right] = \\frac{\\alpha}{\\Delta x^2} (u_{i+1} - 2u_i + u_{i-1})\n$$\nApplying the Forward Euler method for time integration, where $\\frac{du_i}{dt} \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}$:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\frac{\\alpha}{\\Delta x^2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\nLet's define the dimensionless diffusion number $\\mu = \\frac{\\alpha \\Delta t}{\\Delta x^2}$. Rearranging the equation gives the final update formula for the FVM scheme:\n$$\nu_i^{n+1} = u_i^n + \\mu (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\n$$\nu_i^{n+1} = (1 - 2\\mu) u_i^n + \\mu u_{i-1}^n + \\mu u_{i+1}^n\n$$\nThis is the explicit FVM scheme.\n\nNext, we compare this to the standard FTCS (Forward-Time Centered-Space) finite difference method for $u_t = \\alpha u_{xx}$. The FTCS discretization is:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\alpha \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{\\Delta x^2}\n$$\nThis is algebraically identical to the equation derived for the FVM. Thus, the resulting update formula is the same. The specified FVM coincides exactly with the FTCS scheme.\n\nNow we analyze the properties of the scheme $u_i^{n+1} = (1 - 2\\mu) u_i^n + \\mu u_{i-1}^n + \\mu u_{i+1}^n$.\n\n1.  **Positivity-Preserving:** For the scheme to be positivity-preserving, we require that if $u_j^n \\ge 0$ for all $j$, then $u_i^{n+1} \\ge 0$. Since $u_i^{n+1}$ is a linear combination of $u_j^n$, a sufficient condition is that all coefficients in the combination are non-negative.\n    - The coefficient $\\mu = \\frac{\\alpha \\Delta t}{\\Delta x^2}$ is non-negative by definition (assuming $\\alpha, \\Delta t, \\Delta x$ are positive).\n    - We must also have the coefficient of $u_i^n$ be non-negative: $1 - 2\\mu \\ge 0$, which implies $2\\mu \\le 1$, or $\\mu \\le \\frac{1}{2}$.\n    This condition is also necessary. If $\\mu > 1/2$, we can construct initial data, e.g., $u_i^0 = 1$ and $u_j^0 = 0$ for $j \\neq i$, which gives $u_i^1 = 1 - 2\\mu < 0$. Thus, the scheme is positivity-preserving if and only if $0 \\le \\mu \\le \\frac{1}{2}$.\n\n2.  **Monotonicity:** A scheme is monotone if the update function is a non-decreasing function of each of its arguments. For our linear scheme, this means the partial derivatives with respect to the stencil values must be non-negative:\n    - $\\frac{\\partial u_i^{n+1}}{\\partial u_{i-1}^n} = \\mu \\ge 0$.\n    - $\\frac{\\partial u_i^{n+1}}{\\partial u_{i+1}^n} = \\mu \\ge 0$.\n    - $\\frac{\\partial u_i^{n+1}}{\\partial u_i^n} = 1 - 2\\mu \\ge 0 \\implies \\mu \\le \\frac{1}{2}$.\n    The condition for monotonicity is identical to that for positivity: $0 \\le \\mu \\le \\frac{1}{2}$.\n\n3.  **Nonexpansiveness in $L^\\infty$ norm:** We require $\\|u^{n+1}\\|_\\infty \\le \\|u^n\\|_\\infty$. Let $M^n = \\|u^n\\|_\\infty = \\sup_j |u_j^n|$.\n    $$\n    |u_i^{n+1}| = |(1 - 2\\mu) u_i^n + \\mu u_{i-1}^n + \\mu u_{i+1}^n|\n    $$\n    Using the triangle inequality:\n    $$\n    |u_i^{n+1}| \\le |1 - 2\\mu| |u_i^n| + |\\mu| |u_{i-1}^n| + |\\mu| |u_{i+1}^n|\n    $$\n    If we enforce the condition $0 \\le \\mu \\le \\frac{1}{2}$, then all coefficients are non-negative, so $|1 - 2\\mu| = 1 - 2\\mu$ and $|\\mu| = \\mu$.\n    $$\n    |u_i^{n+1}| \\le (1 - 2\\mu) |u_i^n| + \\mu |u_{i-1}^n| + \\mu |u_{i+1}^n| \\le (1 - 2\\mu) M^n + \\mu M^n + \\mu M^n = (1 - 2\\mu + 2\\mu) M^n = M^n\n    $$\n    Since $|u_i^{n+1}| \\le M^n$ for all $i$, we have $\\|u^{n+1}\\|_\\infty \\le M^n = \\|u^n\\|_\\infty$. The condition $0 \\le \\mu \\le \\frac{1}{2}$ is sufficient for the scheme to be non-expansive in the $L^\\infty$ norm. This condition is also known to be necessary for stability in this norm (von Neumann stability analysis yields the same condition).\n\n### Evaluation of Options\n\n**A. The explicit FVM with centered two-point diffusive flux yields an update of the form $u_i^{n+1} \\,=\\, (1-2\\mu)\\,u_i^n \\,+\\, \\mu\\,u_{i-1}^n \\,+\\, \\mu\\,u_{i+1}^n$, where $\\mu \\,=\\, \\alpha\\,\\Delta t/\\Delta x^2$. For nonnegative data, this scheme is positivity-preserving, monotone, and nonexpansive in $L^\\infty$ if and only if $0 \\le \\mu \\le \\tfrac{1}{2}$. Moreover, this FVM update coincides with the FTCS finite difference method for the heat equation on the same grid.**\n- The derived update formula matches the one given.\n- The analysis of positivity, monotonicity, and $L^\\infty$ nonexpansiveness confirms the condition $0 \\le \\mu \\le \\frac{1}{2}$.\n- The equivalence of this specific FVM and the standard FTCS method was also demonstrated.\nAll claims in this statement are accurate.\n**Verdict: Correct**\n\n**B. The explicit FVM with centered two-point diffusive flux is positivity-preserving and nonexpansive in $L^\\infty$ for any $0 \\le \\mu \\le 1$, because diffusion is dissipative and conservation alone guarantees nonnegativity.**\n- The condition $0 \\le \\mu \\le 1$ is incorrect. For example, if $\\mu = 0.75$, the coefficient $1 - 2\\mu = -0.5$ is negative, which violates positivity.\n- The reasoning is flawed. Conservation is a global property (the sum of cell values is constant) and does not guarantee local properties like positivity. While physical diffusion is dissipative, numerical schemes can become unstable and fail to be positivity-preserving if the time-step restriction is violated.\n**Verdict: Incorrect**\n\n**C. The explicit FVM with centered two-point diffusive flux is conservative and therefore always monotone and positivity-preserving for any $\\Delta t>0$, regardless of the value of $\\mu$.**\n- The scheme is indeed conservative by its FVM construction. However, the implication that conservation guarantees unconditional monotonicity and positivity is false.\n- As shown, the scheme is only monotone and positivity-preserving under the condition $0 \\le \\mu \\le \\frac{1}{2}$. It is not unconditional.\n**Verdict: Incorrect**\n\n**D. The FTCS finite difference method for the heat equation is unconditionally monotone and nonexpansive in $L^\\infty$ because parabolic equations smooth out oscillations for any $\\Delta t>0$, whereas the FVM requires $0 \\le \\mu \\le \\tfrac{1}{2}$ to be positivity-preserving.**\n- This statement falsely claims that the FTCS method is unconditionally stable, monotone, and non-expansive. The FTCS scheme is the canonical example of a conditionally stable explicit method, requiring $\\mu \\le \\frac{1}{2}$.\n- The reasoning about parabolic equations smoothing oscillations refers to the continuous PDE, not necessarily its discrete approximation.\n- It creates a false distinction between the FTCS method and the FVM, which, under the given specifications, are identical schemes with the identical stability condition.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "3310197"}, {"introduction": "While diffusion smooths solutions, wave propagation preserves information, making numerical simulations susceptible to a different kind of error: dispersion. This practice introduces Fourier analysis as a powerful tool to quantify how accurately a scheme propagates waves of different wavelengths. By comparing two different second-order accurate schemes for the wave equation, you will learn to characterize their phase error and understand why truncation error alone does not tell the whole story for hyperbolic problems. [@problem_id:3310226]", "problem": "Consider the one-dimensional linear wave equation $u_{tt} = c^{2} u_{xx}$ on a uniform spatial grid with spacing $\\Delta x$ and time step $\\Delta t$, and define the Courant number $\\nu = c \\Delta t / \\Delta x$. Analyze phase dispersion for a single Fourier mode with wavenumber $k$ and nondimensional wavenumber $\\kappa = k \\Delta x$ under the following two explicit, second-order accurate discretizations.\n\nScheme A (standard centered-in-time and centered-in-space discretization of the second-order equation): for grid index $j \\in \\mathbb{Z}$ and time level $n \\in \\mathbb{Z}$,\n$$\nu_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1} = \\nu^{2} \\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right).\n$$\n\nScheme B (characteristic-based evolution of traveling components by Lax–Wendroff for one-way advection): decompose the solution into right- and left-traveling components, each satisfying a one-way wave equation of the form $w_{t} \\pm c w_{x} = 0$. Discretize each one-way equation by the Lax–Wendroff method,\n$$\nw_{j}^{n+1} = w_{j}^{n} \\mp \\frac{\\nu}{2} \\left(w_{j+1}^{n} - w_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2} \\left(w_{j+1}^{n} - 2 w_{j}^{n} + w_{j-1}^{n}\\right),\n$$\nand interpret the phase dispersion for a single right-traveling Fourier mode of the full wave equation by the dispersion of the corresponding one-way component.\n\nFor each scheme, perform a discrete Fourier (von Neumann) analysis on a single Fourier mode $u_{j}^{n} = \\exp\\!\\left(i \\left(j \\kappa - n \\theta\\right)\\right)$ to obtain the numerical phase $\\theta(\\kappa,\\nu)$ per time step. Define the numerical phase speed $c_{\\text{num}} = (\\theta/\\Delta t) / k = (c/\\nu)\\, \\theta/\\kappa$, and consider the small-wavenumber expansion\n$$\n\\frac{c_{\\text{num}}}{c} = 1 + \\alpha(\\nu)\\, \\kappa^{2} + \\mathcal{O}(\\kappa^{4}).\n$$\nLet $\\alpha_{A}(\\nu)$ and $\\alpha_{B}(\\nu)$ denote the coefficients for Scheme A and Scheme B, respectively.\n\nDerive $\\alpha_{A}(\\nu)$ and $\\alpha_{B}(\\nu)$ from first principles and report the analytic expression for the difference\n$$\n\\Delta \\alpha(\\nu) = \\alpha_{B}(\\nu) - \\alpha_{A}(\\nu).\n$$\nYour final answer must be a single closed-form expression in terms of $\\nu$ only. No numerical rounding is required, and no physical units are to be included in the final expression.", "solution": "The problem requires the derivation of the leading-order phase dispersion error coefficients, $\\alpha_A(\\nu)$ and $\\alpha_B(\\nu)$, for two numerical schemes for the one-dimensional wave equation, and to compute their difference $\\Delta \\alpha(\\nu) = \\alpha_{B}(\\nu) - \\alpha_{A}(\\nu)$.\n\nThe analysis is performed on a single Fourier mode of the form $u_{j}^{n} = \\exp(i (j \\kappa - n \\theta))$, where $\\kappa = k \\Delta x$ is the nondimensional wavenumber and $\\theta$ is the numerical phase shift per time step. The amplification factor is $G = u_j^{n+1}/u_j^n = \\exp(-i\\theta)$. The ratio of the numerical phase speed $c_{\\text{num}}$ to the true phase speed $c$ is given by\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta / (k \\Delta t)}{c} = \\frac{\\theta}{(k \\Delta x)(c \\Delta t / \\Delta x)} = \\frac{\\theta}{\\kappa \\nu}\n$$\nThe leading-order dispersion error coefficient $\\alpha(\\nu)$ is defined by the small-$\\kappa$ expansion\n$$\n\\frac{c_{\\text{num}}}{c} = 1 + \\alpha(\\nu) \\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\n\nFirst, we analyze Scheme A:\n$$\nu_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1} = \\nu^{2} \\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\nSubstituting the Fourier mode $u_j^n = G^n \\exp(ij\\kappa)$ into the scheme yields:\n$$\n(G - 2 + G^{-1}) G^n \\exp(ij\\kappa) = \\nu^2 (\\exp(i\\kappa) - 2 + \\exp(-i\\kappa)) G^n \\exp(ij\\kappa)\n$$\nDividing by the common factor $G^n \\exp(ij\\kappa)$ and using Euler's identity $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$, we get:\n$$\n2\\cos(\\theta) - 2 = \\nu^2(2\\cos(\\kappa) - 2)\n$$\nUsing the half-angle identity $1-\\cos(\\phi) = 2\\sin^2(\\phi/2)$:\n$$\n-4\\sin^2(\\frac{\\theta}{2}) = -2\\nu^2(1-\\cos(\\kappa)) = -4\\nu^2\\sin^2(\\frac{\\kappa}{2})\n$$\nThis gives the numerical dispersion relation for Scheme A:\n$$\n\\sin\\left(\\frac{\\theta}{2}\\right) = \\nu \\sin\\left(\\frac{\\kappa}{2}\\right)\n$$\nwhere we select the positive root corresponding to the forward-propagating wave. From this, we have $\\theta = 2\\arcsin(\\nu\\sin(\\kappa/2))$. To find $\\alpha_A(\\nu)$, we expand $\\theta$ for small $\\kappa$:\n$$\n\\sin\\left(\\frac{\\kappa}{2}\\right) = \\frac{\\kappa}{2} - \\frac{1}{3!}\\left(\\frac{\\kappa}{2}\\right)^3 + \\mathcal{O}(\\kappa^5) = \\frac{\\kappa}{2} - \\frac{\\kappa^3}{48} + \\mathcal{O}(\\kappa^5)\n$$\nLet $X = \\nu\\sin(\\kappa/2) = \\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48} + \\mathcal{O}(\\kappa^5)$. Using $\\arcsin(X) = X + \\frac{X^3}{6} + \\mathcal{O}(X^5)$:\n$$\n\\frac{\\theta}{2} = \\arcsin\\left(\\nu\\sin\\left(\\frac{\\kappa}{2}\\right)\\right) = \\left(\\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48}\\right) + \\frac{1}{6}\\left(\\frac{\\nu\\kappa}{2}\\right)^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\frac{\\theta}{2} = \\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48} + \\frac{\\nu^3\\kappa^3}{48} + \\mathcal{O}(\\kappa^5) = \\frac{\\nu\\kappa}{2} + \\frac{\\nu^3-\\nu}{48}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\theta = \\nu\\kappa + \\frac{\\nu^3-\\nu}{24}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\nNow, we find the phase speed ratio:\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta}{\\nu\\kappa} = \\frac{1}{\\nu\\kappa}\\left(\\nu\\kappa + \\frac{\\nu(\\nu^2-1)}{24}\\kappa^3 + \\mathcal{O}(\\kappa^5)\\right) = 1 + \\frac{\\nu^2-1}{24}\\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\nBy comparing with the definition, we identify the coefficient for Scheme A:\n$$\n\\alpha_A(\\nu) = \\frac{\\nu^2-1}{24}\n$$\n\nNext, we analyze Scheme B for a right-traveling wave, which satisfies $w_t+cw_x=0$. The problem states this corresponds to the Lax-Wendroff discretization:\n$$\nw_{j}^{n+1} = w_{j}^{n} - \\frac{\\nu}{2} \\left(w_{j+1}^{n} - w_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2} \\left(w_{j+1}^{n} - 2 w_{j}^{n} + w_{j-1}^{n}\\right)\n$$\nSubstituting the Fourier mode $w_j^n = G^n \\exp(ij\\kappa)$ gives the amplification factor $G$:\n$$\nG = 1 - \\frac{\\nu}{2}(\\exp(i\\kappa) - \\exp(-i\\kappa)) + \\frac{\\nu^2}{2}(\\exp(i\\kappa) - 2 + \\exp(-i\\kappa))\n$$\n$$\nG = 1 - i\\nu\\sin(\\kappa) + \\nu^2(\\cos(\\kappa)-1) = 1 - i\\nu\\sin(\\kappa) - 2\\nu^2\\sin^2\\left(\\frac{\\kappa}{2}\\right)\n$$\nThe numerical phase is $\\theta = -\\arg(G)$.\n$$\n\\theta = -\\arctan\\left(\\frac{\\text{Im}(G)}{\\text{Re}(G)}\\right) = -\\arctan\\left(\\frac{-\\nu\\sin(\\kappa)}{1-2\\nu^2\\sin^2(\\kappa/2)}\\right) = \\arctan\\left(\\frac{\\nu\\sin(\\kappa)}{1-2\\nu^2\\sin^2(\\kappa/2)}\\right)\n$$\nTo find $\\alpha_B(\\nu)$, we expand $\\theta$ for small $\\kappa$. Let $Y$ be the argument of the arctangent function.\nNumerator: $\\nu\\sin(\\kappa) = \\nu\\left(\\kappa - \\frac{\\kappa^3}{6} + \\mathcal{O}(\\kappa^5)\\right)$.\nDenominator: $1 - 2\\nu^2\\sin^2(\\kappa/2) = 1 - 2\\nu^2\\left(\\frac{\\kappa}{2} - \\frac{\\kappa^3}{48} + \\dots\\right)^2 = 1 - 2\\nu^2\\left(\\frac{\\kappa^2}{4} - \\frac{\\kappa^4}{48} + \\dots\\right) = 1 - \\frac{\\nu^2\\kappa^2}{2} + \\frac{\\nu^2\\kappa^4}{24} + \\dots$.\nPerforming the division:\n$$\nY = \\frac{\\nu\\kappa - \\frac{\\nu}{6}\\kappa^3 + \\dots}{1 - \\frac{\\nu^2}{2}\\kappa^2 + \\dots} = \\left(\\nu\\kappa - \\frac{\\nu}{6}\\kappa^3 + \\dots\\right)\\left(1 + \\frac{\\nu^2}{2}\\kappa^2 + \\dots\\right) = \\nu\\kappa + \\frac{\\nu^3}{2}\\kappa^3 - \\frac{\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\frac{3\\nu^3-\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\nNow, expand $\\theta = \\arctan(Y) = Y - \\frac{Y^3}{3} + \\mathcal{O}(Y^5)$:\n$$\n\\theta = \\left(\\nu\\kappa + \\frac{3\\nu^3-\\nu}{6}\\kappa^3\\right) - \\frac{1}{3}(\\nu\\kappa)^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\left(\\frac{3\\nu^3-\\nu}{6} - \\frac{\\nu^3}{3}\\right)\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\theta = \\nu\\kappa + \\frac{3\\nu^3 - \\nu - 2\\nu^3}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\frac{\\nu^3-\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\nThe phase speed ratio is:\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta}{\\nu\\kappa} = \\frac{1}{\\nu\\kappa}\\left(\\nu\\kappa + \\frac{\\nu(\\nu^2-1)}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\\right) = 1 + \\frac{\\nu^2-1}{6}\\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\nThus, the coefficient for Scheme B is:\n$$\n\\alpha_B(\\nu) = \\frac{\\nu^2-1}{6}\n$$\nFinally, we compute the difference $\\Delta\\alpha(\\nu) = \\alpha_B(\\nu) - \\alpha_A(\\nu)$:\n$$\n\\Delta\\alpha(\\nu) = \\frac{\\nu^2-1}{6} - \\frac{\\nu^2-1}{24} = (\\nu^2-1)\\left(\\frac{1}{6} - \\frac{1}{24}\\right) = (\\nu^2-1)\\left(\\frac{4-1}{24}\\right) = (\\nu^2-1)\\left(\\frac{3}{24}\\right)\n$$\n$$\n\\Delta\\alpha(\\nu) = \\frac{\\nu^2-1}{8}\n$$", "answer": "$$\\boxed{\\frac{\\nu^2 - 1}{8}}$$", "id": "3310226"}]}