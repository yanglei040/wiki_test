{"hands_on_practices": [{"introduction": "Understanding the material derivative begins with dissecting its two key components: the local rate of change and the convective rate of change. This first exercise provides a concrete setting to calculate these terms and interpret their physical significance. By analyzing a simple one-dimensional flow, you will explore how a fluid particle's experience of a changing scalar field is a combination of the field evolving in time at a fixed point and the particle moving through a spatially varying field [@problem_id:3376233].", "problem": "In Computational Fluid Dynamics (CFD), the material derivative measures the time rate of change of a transported quantity as experienced by a fluid particle that follows the flow. Consider a one-dimensional, incompressible, inviscid kinematic setting in which the velocity field and a transported scalar field are given by the Eulerian fields $u(x,t)$ and $\\phi(x,t)$, respectively. Let the velocity field be $u(x,t)=a\\,x$, where $a$ is a real constant, and let the scalar field be $\\phi(x,t)=x^{2}\\,t$. A fluid particle trajectory $x(t)$ is defined by the kinematic relation $\\mathrm{d}x/\\mathrm{d}t=u(x,t)$, and the material derivative of $\\phi$ at an Eulerian point $(x,t)$ is the particle’s time rate of change of $\\phi$ when it passes through $(x,t)$.\n\nUsing only the fundamental kinematic definition of a particle path and the chain rule applied to the composite function $\\phi(x(t),t)$, derive an explicit expression for the material derivative of $\\phi$ evaluated at a generic Eulerian point $(x,t)$. Then, interpret the sign and structure of your result in terms of what a moving fluid particle experiences in this flow.\n\nProvide your final expression as a single closed-form analytic expression in $x$, $t$, and $a$. No numerical approximation or rounding is required.", "solution": "The problem requires the derivation and interpretation of the material derivative for a specified scalar field in a given one-dimensional velocity field. The process begins with validating the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Physical Setting**: A one-dimensional, incompressible, inviscid kinematic setting.\n-   **Eulerian Velocity Field**: $u(x,t) = a\\,x$, where $a$ is a real constant.\n-   **Eulerian Scalar Field**: $\\phi(x,t) = x^{2}\\,t$.\n-   **Particle Path Definition**: The trajectory of a fluid particle, denoted by $x(t)$, is governed by the ordinary differential equation $\\frac{\\mathrm{d}x}{\\mathrm{d}t} = u(x(t),t)$.\n-   **Primary Task**: Derive the material derivative of $\\phi$ at an Eulerian point $(x,t)$ by applying the chain rule to the composite function $\\phi(x(t),t)$.\n-   **Secondary Task**: Interpret the sign and structure of the resulting expression.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the principles of continuum mechanics and fluid dynamics. The concepts of Eulerian fields, particle paths, and the material derivative are fundamental to these disciplines. The provided functions are well-behaved and allow for a straightforward derivation.\n\nA minor point of contention is the simultaneous specification of a \"one-dimensional\" and \"incompressible\" flow with the velocity field $u(x,t) = ax$. For a one-dimensional flow, the incompressibility condition $\\nabla \\cdot \\mathbf{u} = 0$ reduces to $\\frac{\\partial u}{\\partial x} = 0$. For the given field, $\\frac{\\partial u}{\\partial x} = a$. Thus, strict incompressibility in one dimension requires $a=0$, which would make the convective aspect of the problem trivial. However, the designation \"kinematic setting\" implies that the velocity field is prescribed, and the objective is to study the transport properties within this flow, irrespective of whether the field satisfies all dynamic and conservation laws. Furthermore, $u(x,t) = ax$ can represent one component of a higher-dimensional incompressible flow. This subtle inconsistency does not impede the mathematical task, which is the core of the problem. Therefore, the problem is well-posed and valid for a kinematic analysis.\n\n**Verdict**: The problem is valid.\n\n### Derivation of the Material Derivative\n\nThe material derivative, denoted as $\\frac{D\\phi}{Dt}$, measures the total rate of change of the scalar quantity $\\phi$ as experienced by a fluid particle moving with the flow. The problem instructs us to derive this by considering $\\phi$ as a composite function of time, $\\phi(x(t),t)$, where $x(t)$ is the particle's trajectory. Using the multivariate chain rule, the total time derivative of this composite function is:\n$$\n\\frac{d}{dt}\\phi(x(t), t) = \\frac{\\partial \\phi}{\\partial x} \\frac{dx}{dt} + \\frac{\\partial \\phi}{\\partial t} \\frac{dt}{dt}\n$$\nBy definition, a fluid particle's velocity is given by $\\frac{dx}{dt} = u(x(t),t)$. Substituting this into the chain rule expression, and noting that $\\frac{dt}{dt} = 1$, we obtain the standard Eulerian form of the material derivative operator applied to $\\phi$:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + u(x,t) \\frac{\\partial \\phi}{\\partial x}\n$$\nThis expression is evaluated at the Eulerian point $(x,t)$ through which the particle is passing at time $t$.\n\nWe are given the scalar field $\\phi(x,t) = x^{2}t$. We compute its partial derivatives:\n1.  The local (or unsteady) time derivative:\n    $$\n    \\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial t}(x^{2}t) = x^{2}\n    $$\n2.  The spatial gradient:\n    $$\n    \\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x}(x^{2}t) = 2xt\n    $$\nWe are also given the velocity field $u(x,t) = ax$.\n\nNow, we substitute these expressions into the formula for the material derivative:\n$$\n\\frac{D\\phi}{Dt} = (x^{2}) + (ax)(2xt)\n$$\nSimplifying the second term gives:\n$$\n\\frac{D\\phi}{Dt} = x^{2} + 2ax^{2}t\n$$\nFactoring out the common term $x^{2}$ yields the final closed-form expression for the material derivative at the Eulerian point $(x,t)$:\n$$\n\\frac{D\\phi}{Dt} = x^{2}(1 + 2at)\n$$\n\n### Interpretation of the Result\n\nThe expression for the material derivative, $\\frac{D\\phi}{Dt} = x^{2} + 2ax^{2}t$, consists of two distinct physical contributions:\n\n1.  **Local Rate of Change**: The first term, $\\frac{\\partial \\phi}{\\partial t} = x^{2}$, represents the rate of change of $\\phi$ at a fixed spatial position $x$. Since $x^{2} \\ge 0$, the scalar field value is non-decreasing with time at every point in space. An observer fixed at any location $x \\neq 0$ would see the value of $\\phi$ increase over time.\n\n2.  **Convective Rate of Change**: The second term, $u \\frac{\\partial \\phi}{\\partial x} = 2ax^{2}t$, represents the change in $\\phi$ experienced by a fluid particle due to its motion through a spatially non-uniform field.\n    -   The spatial gradient of the field is $\\frac{\\partial \\phi}{\\partial x} = 2xt$. For $t>0$, the value of $\\phi$ increases as one moves away from the origin $x=0$.\n    -   The velocity is $u=ax$. The nature of the flow depends on the sign of the constant $a$.\n        -   If $a > 0$, the flow is a stretching flow diverging from the origin ($u > 0$ for $x > 0$ and $u < 0$ for $x < 0$). Particles are moving away from the origin into regions of higher $\\phi$ (for $t > 0$). Consequently, the convective term $2ax^{2}t$ is positive for $t>0$, contributing to an increase in the $\\phi$ value experienced by the particle.\n        -   If $a < 0$, the flow is a compressive flow converging toward the origin. Particles move toward the origin into regions of lower $\\phi$ (for $t>0$). The convective term $2ax^{2}t$ is therefore negative for $t > 0$, contributing to a decrease in the $\\phi$ value experienced by the particle.\n\n**Total Change Experienced by a Particle**: The net rate of change, $\\frac{D\\phi}{Dt} = x^{2}(1 + 2at)$, is the sum of these two effects. The sign of the total change depends on the factor $(1 + 2at)$.\n\n-   If $a > 0$ (stretching flow), then for $t \\ge 0$, both the local and convective terms are non-negative. A fluid particle experiences an increase in $\\phi$ due to both the local field evolution and its movement into regions of higher $\\phi$.\n-   If $a < 0$ (compressive flow), the two effects are in opposition for $t > 0$. The local term $x^2$ is positive, while the convective term $2ax^2t$ is negative.\n    -   If $1 + 2at > 0$ (i.e., for $t < \\frac{-1}{2a}$), the local increase dominates, and the particle experiences a net increase in $\\phi$.\n    -   If $1 + 2at < 0$ (i.e., for $t > \\frac{-1}{2a}$), the convective decrease dominates, and the particle experiences a net decrease in $\\phi$.\n    -   At the specific time $t = \\frac{-1}{2a}$, the local increase is perfectly balanced by the convective decrease, and the material derivative is zero. The particle experiences no instantaneous change in $\\phi$.\n\nIn summary, the derived expression elegantly captures the competition between the local, time-dependent evolution of the scalar field and the convective transport of the scalar quantity by the moving fluid particle.", "answer": "$$\\boxed{x^{2}(1 + 2at)}$$", "id": "3376233"}, {"introduction": "The material derivative can be viewed from two perspectives: the Eulerian viewpoint of a fixed observer, and the Lagrangian viewpoint of an observer moving with the fluid. This practice problem solidifies the connection between these two crucial frameworks [@problem_id:3376241]. You will solve for the evolution of a scalar field by tracing fluid particles back to their origin—a technique known as the method of characteristics—and then verify that this Lagrangian solution satisfies the Eulerian material derivative equation, demonstrating their fundamental equivalence.", "problem": "In computational fluid dynamics (CFD), consider a two-dimensional incompressible rigid-body rotation with angular speed $\\omega>0$ described by the velocity field $\\boldsymbol{u}(x,y,t)=\\left(\\omega y,\\,-\\omega x\\right)$. A passive scalar field $\\phi(x,y,t)$ is materially conserved along fluid trajectories, with the initial condition $\\phi(x,y,0)=x$. Using only the definition of a Lagrangian fluid trajectory $\\boldsymbol{X}(t)$ satisfying $\\dot{\\boldsymbol{X}}(t)=\\boldsymbol{u}(\\boldsymbol{X}(t),t)$ and the principle that a materially conserved scalar remains constant when following the motion, derive an explicit analytic expression for $\\phi(x,y,t)$ valid for all $t\\ge 0$ and all $(x,y)\\in\\mathbb{R}^{2}$. Then, from first principles, verify that the material time rate of change $D\\phi/Dt$ vanishes identically at every $(x,y,t)$. Express your final answer as a single closed-form analytical expression for $\\phi(x,y,t)$. No rounding is required, and no units are needed.", "solution": "The problem is valid. It presents a well-defined, scientifically grounded problem in fluid mechanics concerning the advection of a passive scalar in a rigid-body rotation flow. All necessary data and conditions are provided, and the problem is self-contained and consistent.\n\nThe core task is to determine the passive scalar field $\\phi(x,y,t)$ given its initial state $\\phi(x,y,0)$ and the velocity field $\\boldsymbol{u}(x,y,t)$ that advects it. The principle of material conservation states that the value of $\\phi$ associated with a specific fluid particle remains constant as that particle moves. Let $\\boldsymbol{X}(t_0; t)$ be the position at time $t$ of a fluid particle that was at position $\\boldsymbol{x}_0$ at time $t_0$. Material conservation implies $\\phi(\\boldsymbol{X}(t_0; t), t) = \\phi(\\boldsymbol{x}_0, t_0)$.\n\nIn this problem, we want to find $\\phi(x,y,t)$ at an arbitrary Eulerian point $(x,y)$ and time $t$. Let the fluid particle currently at $(x,y)$ have originated from the position $(x_0, y_0)$ at time $t=0$. The material conservation principle gives:\n$$\n\\phi(x,y,t) = \\phi(x_0, y_0, 0)\n$$\nThe problem provides the initial condition $\\phi(x,y,0) = x$. Applying this to the initial position $(x_0, y_0)$, we get:\n$$\n\\phi(x_0, y_0, 0) = x_0\n$$\nTherefore, our expression for the scalar field becomes:\n$$\n\\phi(x,y,t) = x_0\n$$\nTo find an explicit expression for $\\phi(x,y,t)$, we must find the initial position $x_0$ as a function of the current position $(x,y)$ and time $t$. This is achieved by solving for the Lagrangian fluid trajectories. A trajectory $\\boldsymbol{X}(t) = (X(t), Y(t))$ is governed by the differential equation $\\dot{\\boldsymbol{X}}(t) = \\boldsymbol{u}(\\boldsymbol{X}(t),t)$. The given velocity field is $\\boldsymbol{u}(x,y,t) = (\\omega y, -\\omega x)$. The system of ordinary differential equations (ODEs) for a trajectory is:\n$$\n\\frac{dX}{dt} = \\omega Y\n$$\n$$\n\\frac{dY}{dt} = -\\omega X\n$$\nThis is a system of linear first-order ODEs. We can solve it by differentiating the first equation with respect to $t$ and substituting the second equation:\n$$\n\\frac{d^2X}{dt^2} = \\omega \\frac{dY}{dt} = \\omega (-\\omega X) = -\\omega^2 X\n$$\nThis gives the second-order ODE for $X(t)$:\n$$\n\\frac{d^2X}{dt^2} + \\omega^2 X = 0\n$$\nThe general solution is $X(t) = C_1 \\cos(\\omega t) + C_2 \\sin(\\omega t)$. We can find $Y(t)$ from the first ODE: $Y(t) = \\frac{1}{\\omega} \\frac{dX}{dt} = \\frac{1}{\\omega} (-C_1 \\omega \\sin(\\omega t) + C_2 \\omega \\cos(\\omega t)) = -C_1 \\sin(\\omega t) + C_2 \\cos(\\omega t)$.\n\nThe constants $C_1$ and $C_2$ are determined by the initial position of the particle at $t=0$, which we have denoted as $(x_0, y_0)$.\nAt $t=0$:\n$X(0) = x_0 \\implies C_1 \\cos(0) + C_2 \\sin(0) = C_1 = x_0$.\n$Y(0) = y_0 \\implies -C_1 \\sin(0) + C_2 \\cos(0) = C_2 = y_0$.\n\nSo, the trajectory of a particle starting at $(x_0, y_0)$ is given by:\n$$\nX(t) = x_0 \\cos(\\omega t) + y_0 \\sin(\\omega t)\n$$\n$$\nY(t) = -x_0 \\sin(\\omega t) + y_0 \\cos(\\omega t)\n$$\nWe are interested in the particle that is at position $(x,y)$ at time $t$. Thus, we set $X(t)=x$ and $Y(t)=y$ and solve the system for $(x_0, y_0)$:\n$$\nx = x_0 \\cos(\\omega t) + y_0 \\sin(\\omega t) \\quad (1)\n$$\n$$\ny = -x_0 \\sin(\\omega t) + y_0 \\cos(\\omega t) \\quad (2)\n$$\nTo solve for $x_0$, we can multiply equation (1) by $\\cos(\\omega t)$ and equation (2) by $-\\sin(\\omega t)$ and add them:\n$$\nx \\cos(\\omega t) - y \\sin(\\omega t) = (x_0 \\cos^2(\\omega t) + y_0 \\sin(\\omega t)\\cos(\\omega t)) - (-x_0 \\sin^2(\\omega t) + y_0 \\cos(\\omega t)\\sin(\\omega t))\n$$\n$$\nx \\cos(\\omega t) - y \\sin(\\omega t) = x_0 (\\cos^2(\\omega t) + \\sin^2(\\omega t)) + y_0 (\\sin(\\omega t)\\cos(\\omega t) - \\cos(\\omega t)\\sin(\\omega t))\n$$\nUsing the identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$, we find:\n$$\nx_0 = x \\cos(\\omega t) - y \\sin(\\omega t)\n$$\nSubstituting this back into our expression for $\\phi(x,y,t)$, we obtain the explicit analytic expression:\n$$\n\\phi(x,y,t) = x \\cos(\\omega t) - y \\sin(\\omega t)\n$$\nNext, we must verify from first principles that the material time rate of change, $D\\phi/Dt$, vanishes identically. The material derivative is defined as:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla\\phi = \\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} + v \\frac{\\partial \\phi}{\\partial y}\n$$\nwhere the velocity components are $u = \\omega y$ and $v = -\\omega x$.\nWe compute the partial derivatives of our derived expression for $\\phi$:\n1.  Partial derivative with respect to time $t$:\n    $$\n    \\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial t} (x \\cos(\\omega t) - y \\sin(\\omega t)) = -x \\omega \\sin(\\omega t) - y \\omega \\cos(\\omega t)\n    $$\n2.  Partial derivative with respect to spatial coordinate $x$:\n    $$\n    \\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x} (x \\cos(\\omega t) - y \\sin(\\omega t)) = \\cos(\\omega t)\n    $$\n3.  Partial derivative with respect to spatial coordinate $y$:\n    $$\n    \\frac{\\partial \\phi}{\\partial y} = \\frac{\\partial}{\\partial y} (x \\cos(\\omega t) - y \\sin(\\omega t)) = -\\sin(\\omega t)\n    $$\nNow, substitute these derivatives and the velocity components into the material derivative formula:\n$$\n\\frac{D\\phi}{Dt} = (-x \\omega \\sin(\\omega t) - y \\omega \\cos(\\omega t)) + (\\omega y)(\\cos(\\omega t)) + (-\\omega x)(-\\sin(\\omega t))\n$$\n$$\n\\frac{D\\phi}{Dt} = -x \\omega \\sin(\\omega t) - y \\omega \\cos(\\omega t) + \\omega y \\cos(\\omega t) + \\omega x \\sin(\\omega t)\n$$\nCombining terms, we see that they cancel out:\n$$\n\\frac{D\\phi}{Dt} = (-x \\omega \\sin(\\omega t) + \\omega x \\sin(\\omega t)) + (-y \\omega \\cos(\\omega t) + \\omega y \\cos(\\omega t)) = 0 + 0 = 0\n$$\nThis confirms that $D\\phi/Dt = 0$ for all $(x,y,t)$, as required for a materially conserved scalar. The derived expression is correct.\nThe final answer is the explicit expression for $\\phi(x,y,t)$.", "answer": "$$\n\\boxed{x \\cos(\\omega t) - y \\sin(\\omega t)}\n$$", "id": "3376241"}, {"introduction": "Moving from analytical theory to computational practice, we must confront the challenge of representing continuous derivatives on a discrete grid. This exercise bridges that gap by exploring the numerical approximation of the convective term, a core component of the material derivative [@problem_id:3376237]. By deriving a first-order upwind scheme and analyzing its truncation error, you will uncover the concept of 'numerical diffusion'—an artificial dissipative effect that is a critical consideration in the design and analysis of CFD algorithms.", "problem": "Consider a passive scalar field $\\phi(x,t)$ advected by a constant velocity $u$ along a uniform one-dimensional grid with spacing $\\Delta x$. The material derivative is $D \\phi / D t = \\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x$. Focus on the convective component $u \\, \\partial \\phi / \\partial x$ and assume that $\\phi$ is sufficiently smooth for Taylor series expansions to be valid.\n\nStarting from first principles and without invoking any pre-derived discretizations, construct a first-order upwind semi-discrete approximation for $u \\, \\partial \\phi / \\partial x$ at a node $x_i$ on the uniform grid. Your expression must be valid for arbitrary sign of $u$ and be written in a single formula that does not branch on the sign explicitly. Then, perform a leading-order truncation error analysis using Taylor series expansions about $x_i$ to rewrite your discrete convective operator as the exact convective operator plus a sequence of higher-derivative correction terms. Use this to identify the coefficient $\\kappa_{\\mathrm{num}}$ of the equivalent leading-order numerical diffusion term $\\kappa_{\\mathrm{num}} \\, \\partial^2 \\phi / \\partial x^2$ that would need to be added to the continuous equation to match the leading truncation effect of the upwind discretization.\n\nProvide your final answer as a single closed-form analytic expression for $\\kappa_{\\mathrm{num}}$ in terms of $u$ and $\\Delta x$. Do not include units in your final answer. No numerical rounding is required.", "solution": "The user wants me to solve the problem by following these steps:\n1.  **Validate the problem**: Check for scientific soundness, self-consistency, and well-posedness.\n2.  If valid, **solve the problem**:\n    a.  Construct a first-order upwind semi-discrete approximation for $u \\, \\partial \\phi / \\partial x$ at a node $x_i$. The formula must be a single expression valid for any sign of $u$.\n    b.  Perform a leading-order truncation error analysis using Taylor series expansions.\n    c.  Identify the numerical diffusion coefficient $\\kappa_{\\mathrm{num}}$ from the leading error term.\n3.  Format the output according to the specified rules, including mandatory LaTeX and specific XML tags.\n\n### Step 1: Extract Givens\n\n-   Scalar field: $\\phi(x,t)$\n-   Velocity: $u$, constant\n-   Grid: Uniform one-dimensional with spacing $\\Delta x$\n-   Material derivative: $D \\phi / D t = \\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x$\n-   Term to discretize: $u \\, \\partial \\phi / \\partial x$\n-   Assumption: $\\phi$ is sufficiently smooth for Taylor series expansions.\n-   Evaluation point: node $x_i$\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is a fundamental exercise in the field of computational fluid dynamics (CFD) and numerical analysis. It deals with standard, well-established concepts: the advection equation, upwind discretization, Taylor series analysis, truncation error, and numerical diffusion. All principles are sound.\n-   **Well-Posed**: The problem is clearly stated, with all necessary information provided. The goal is to derive a specific analytical expression, which is a well-defined task. A unique solution exists.\n-   **Objective**: The language is precise, technical, and free of any subjectivity or ambiguity. The terms used are standard in the field.\n-   **Other Flaws**: The problem is self-contained, consistent, and scientifically feasible. It does not suffer from any of the listed invalidity criteria. It is a standard, non-trivial problem that tests core understanding of numerical methods.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. I will proceed with the solution.\n\nThe problem asks for the construction of a first-order upwind discretization for the convective term $u \\frac{\\partial \\phi}{\\partial x}$ and the subsequent identification of the leading-order numerical diffusion coefficient through truncation error analysis. Let $\\phi_i(t)$ denote the value of the scalar field at the grid node $x_i$, i.e., $\\phi_i(t) = \\phi(x_i, t)$.\n\nThe principle of upwinding is to use information from the direction from which the flow arrives. We consider two cases based on the sign of the velocity $u$.\n\nCase 1: $u > 0$. The flow is from left to right. The \"upwind\" node relative to $x_i$ is $x_{i-1}$. A first-order approximation of the spatial derivative $\\frac{\\partial \\phi}{\\partial x}$ at $x_i$ is given by the first-order backward difference formula:\n$$ \\left. \\frac{\\partial \\phi}{\\partial x} \\right|_i \\approx \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\nThe discretized convective term is therefore:\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx u \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n\nCase 2: $u < 0$. The flow is from right to left. The \"upwind\" node relative to $x_i$ is $x_{i+1}$. A first-order approximation of the spatial derivative is given by the first-order forward difference formula:\n$$ \\left. \\frac{\\partial \\phi}{\\partial x} \\right|_i \\approx \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\nThe discretized convective term is therefore:\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx u \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\n\nTo combine these two cases into a single formula without explicit branching, we can express the upwind scheme as a sum of a central difference scheme and an artificial diffusion term. The second-order central difference approximation for the first derivative is $u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x}$, and the second-order central difference for the second derivative is $\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2}$. A suitable single-formula representation for the first-order upwind scheme is:\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x} - \\frac{|u|\\Delta x}{2} \\left( \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} \\right) $$\nLet's verify this form.\nIf $u > 0$, then $|u| = u$. The expression becomes:\n$$ u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x} - \\frac{u\\Delta x}{2} \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = \\frac{u}{2\\Delta x} (\\phi_{i+1} - \\phi_{i-1} - (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1})) = \\frac{u}{2\\Delta x}(2\\phi_i - 2\\phi_{i-1}) = u \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\nThis matches the backward difference scheme for $u>0$.\nIf $u < 0$, then $|u| = -u$. The expression becomes:\n$$ u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x} + \\frac{u\\Delta x}{2} \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = \\frac{u}{2\\Delta x} (\\phi_{i+1} - \\phi_{i-1} + (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1})) = \\frac{u}{2\\Delta x}(2\\phi_{i+1} - 2\\phi_i) = u \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\nThis matches the forward difference scheme for $u<0$. The single formula is thus validated.\n\nNext, we perform a truncation error analysis. We use Taylor series expansions for $\\phi_{i+1}$ and $\\phi_{i-1}$ around the point $x_i$. For brevity, we denote $\\left. \\frac{\\partial^n \\phi}{\\partial x^n} \\right|_{x_i}$ as $\\phi_x^{(n)}$.\n$$ \\phi_{i+1} = \\phi(x_i + \\Delta x) = \\phi_i + \\Delta x \\phi_x^{(1)} + \\frac{(\\Delta x)^2}{2} \\phi_x^{(2)} + \\frac{(\\Delta x)^3}{6} \\phi_x^{(3)} + O((\\Delta x)^4) $$\n$$ \\phi_{i-1} = \\phi(x_i - \\Delta x) = \\phi_i - \\Delta x \\phi_x^{(1)} + \\frac{(\\Delta x)^2}{2} \\phi_x^{(2)} - \\frac{(\\Delta x)^3}{6} \\phi_x^{(3)} + O((\\Delta x)^4) $$\nWe substitute these expansions into the terms of our discrete operator.\n\nFor the central difference part:\n$$ \\phi_{i+1} - \\phi_{i-1} = 2\\Delta x \\phi_x^{(1)} + \\frac{(\\Delta x)^3}{3} \\phi_x^{(3)} + O((\\Delta x)^5) $$\n$$ u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x} = u \\left( \\phi_x^{(1)} + \\frac{(\\Delta x)^2}{6} \\phi_x^{(3)} + O((\\Delta x)^4) \\right) = u \\frac{\\partial \\phi}{\\partial x} + u \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 \\phi}{\\partial x^3} + O((\\Delta x)^4) $$\n\nFor the artificial diffusion part:\n$$ \\phi_{i+1} - 2\\phi_i + \\phi_{i-1} = (\\Delta x)^2 \\phi_x^{(2)} + \\frac{(\\Delta x)^4}{12} \\phi_x^{(4)} + O((\\Delta x)^6) $$\n$$ \\frac{|u|\\Delta x}{2} \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = \\frac{|u|\\Delta x}{2} \\left( \\phi_x^{(2)} + \\frac{(\\Delta x)^2}{12} \\phi_x^{(4)} + O((\\Delta x)^4) \\right) = \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{|u|(\\Delta x)^3}{24} \\frac{\\partial^4 \\phi}{\\partial x^4} + O((\\Delta x)^5) $$\n\nCombining these results, the discrete operator becomes:\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx \\left( u \\frac{\\partial \\phi}{\\partial x} + u \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 \\phi}{\\partial x^3} + \\dots \\right) - \\left( \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{|u|(\\Delta x)^3}{24} \\frac{\\partial^4 \\phi}{\\partial x^4} + \\dots \\right) $$\nRearranging the terms in order of derivatives:\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx u \\frac{\\partial \\phi}{\\partial x} - \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + O((\\Delta x)^2) $$\nThe truncation error $\\tau$ is the difference between the discrete operator and the exact operator:\n$$ \\tau = \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i - u \\frac{\\partial \\phi}{\\partial x} = - \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + O((\\Delta x)^2) $$\nThe leading-order term of the truncation error is $- \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2}$. This term is of order $O(\\Delta x)$, confirming that the upwind scheme is first-order accurate.\n\nThe semi-discrete form of the pure advection equation is $\\frac{d\\phi_i}{dt} + \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i = 0$. Substituting our expansion for the discrete operator, we obtain the modified differential equation that is effectively being solved:\n$$ \\frac{d\\phi_i}{dt} + \\left( u \\frac{\\partial \\phi}{\\partial x} - \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + O((\\Delta x)^2) \\right) = 0 $$\n$$ \\left( \\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} \\right) = \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + O((\\Delta x)^2) $$\nThe term on the left is the material derivative, $\\frac{D\\phi}{Dt}$. The leading-order truncation error introduces a term on the right-hand side that has the form of a diffusion term. The continuous equation with an added physical diffusion term is written as $\\frac{D\\phi}{Dt} = \\kappa \\frac{\\partial^2 \\phi}{\\partial x^2}$. By comparing this with the modified equation, we can identify the equivalent numerical diffusion coefficient $\\kappa_{\\mathrm{num}}$ as the coefficient of the leading-order error term.\n$$ \\kappa_{\\mathrm{num}} = \\frac{|u|\\Delta x}{2} $$\nThis numerical diffusion is an artifact of the first-order upwind discretization and is responsible for the dissipative nature of the scheme.", "answer": "$$\n\\boxed{\\frac{|u|\\Delta x}{2}}\n$$", "id": "3376237"}]}