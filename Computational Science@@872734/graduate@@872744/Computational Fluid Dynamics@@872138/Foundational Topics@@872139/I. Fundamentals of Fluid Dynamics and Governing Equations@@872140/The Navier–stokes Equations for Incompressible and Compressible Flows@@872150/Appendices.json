{"hands_on_practices": [{"introduction": "The full Navier-Stokes equations are formidable, but for many canonical flows, a careful application of physical assumptions can simplify them dramatically. This exercise demonstrates this fundamental skill by deriving the velocity profile for steady, pressure-driven flow between parallel plates, a classic case known as planar Poiseuille flow [@problem_id:3377200]. By systematically reducing the governing equations, you will see how a complex partial differential system can become a solvable ordinary differential equation that captures the essence of viscous internal flow.", "problem": "Consider a steady, laminar, fully developed, planar pressure-driven flow of an incompressible, Newtonian fluid between two infinite, parallel plates located at $y=-h$ and $y=+h$. The streamwise direction is $x$, the wall-normal direction is $y$, and the spanwise direction is $z$. The fluid has constant dynamic viscosity $\\mu$ and constant density $\\rho$. Gravity is neglected. The imposed streamwise pressure gradient $\\partial p/\\partial x$ is spatially uniform. Starting from the incompressible mass conservation and the Navier–Stokes equations (NSE), impose the no-slip boundary condition at both plates and the symmetry condition about $y=0$ to obtain the streamwise velocity profile $u(y)$. Then compute the volumetric flow rate per unit span in the $z$-direction,\n$$\nq \\;=\\; \\int_{-h}^{+h} u(y)\\,dy \\, .\n$$\nExpress your final answer for $q$ as a single closed-form analytic expression in terms of $\\mu$, $h$, and $\\frac{\\partial p}{\\partial x}$. Do not substitute numerical values and do not report intermediate results; provide only the final analytic expression as your answer.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n-   **Flow conditions**: Steady, laminar, fully developed, planar, pressure-driven.\n-   **Fluid properties**: Incompressible, Newtonian, constant dynamic viscosity $\\mu$, constant density $\\rho$.\n-   **Geometry**: Flow between two infinite, parallel plates located at $y=-h$ and $y=+h$.\n-   **Coordinate system**: Streamwise direction $x$, wall-normal direction $y$, spanwise direction $z$.\n-   **External fields**: Gravity is neglected.\n-   **Driving force**: Spatially uniform streamwise pressure gradient, $\\frac{\\partial p}{\\partial x}$.\n-   **Boundary conditions**: No-slip at $y=\\pm h$.\n-   **Symmetry condition**: Symmetry about $y=0$.\n-   **Required output**: Volumetric flow rate per unit span, $q = \\int_{-h}^{+h} u(y)\\,dy$, expressed in terms of $\\mu$, $h$, and $\\frac{\\partial p}{\\partial x}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem describes the canonical case of planar Poiseuille flow. It is a fundamental, well-established problem in fluid dynamics derived directly from first principles.\n-   **Scientifically Grounded**: The problem is based on the Navier–Stokes equations for an incompressible, Newtonian fluid, which are fundamental principles of fluid mechanics.\n-   **Well-Posed**: The problem provides the governing equations (implied), domain geometry, and sufficient boundary conditions (no-slip) to determine a unique and stable velocity profile. The mention of a symmetry condition is consistent with the symmetric geometry and boundary conditions and can be used to simplify the solution.\n-   **Objective**: The problem is stated using precise, unambiguous mathematical and physical terminology.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived from the governing equations of fluid motion.\n\n**Derivation of the Solution**\n\nThe governing equations for an incompressible, Newtonian fluid are the continuity equation and the Navier–Stokes equations. In Cartesian coordinates $(x, y, z)$ with corresponding velocity components $(u, v, w)$, they are:\n\nContinuity:\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\n\nNavier–Stokes (momentum equations):\n$$ \\rho \\left( \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} + w \\frac{\\partial u}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial x} + \\mu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + \\frac{\\partial^2 u}{\\partial z^2} \\right) $$\n$$ \\rho \\left( \\frac{\\partial v}{\\partial t} + u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} + w \\frac{\\partial v}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial y} + \\mu \\left( \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} + \\frac{\\partial^2 v}{\\partial z^2} \\right) $$\n$$ \\rho \\left( \\frac{\\partial w}{\\partial t} + u \\frac{\\partial w}{\\partial x} + v \\frac{\\partial w}{\\partial y} + w \\frac{\\partial w}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left( \\frac{\\partial^2 w}{\\partial x^2} + \\frac{\\partial^2 w}{\\partial y^2} + \\frac{\\partial^2 w}{\\partial z^2} \\right) $$\nHere, $p$ is the pressure. We neglect the body force term as gravity is ignored.\n\nWe apply the simplifying assumptions given in the problem statement:\n1.  **Steady flow**: All time derivatives are zero, $\\frac{\\partial}{\\partial t}(\\cdot) = 0$.\n2.  **Planar flow between infinite plates**: There is no flow in the spanwise ($z$) direction, so $w=0$. The \"infinite\" extent implies that there are no variations in the $z$-direction, so $\\frac{\\partial}{\\partial z}(\\cdot) = 0$.\n3.  **Fully developed flow**: The velocity profile does not change in the streamwise ($x$) direction. This means $\\frac{\\partial u}{\\partial x} = 0$. Since $w=0$, it also implies $\\frac{\\partial v}{\\partial x} = 0$ and $\\frac{\\partial w}{\\partial x} = 0$.\n\nApplying these simplifications to the continuity equation:\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 \\quad \\implies \\quad 0 + \\frac{\\partial v}{\\partial y} + 0 = 0 \\quad \\implies \\quad \\frac{\\partial v}{\\partial y} = 0 $$\nThis implies that $v$ is a function of $x$ and $z$ only. However, the no-slip condition at the walls requires $v=0$ at $y = \\pm h$. Combined with $\\frac{\\partial v}{\\partial y} = 0$, this means $v$ must be zero everywhere in the flow. So, $v=0$.\n\nNow, we simplify the momentum equations:\n-   **z-momentum equation**: With $w=0$ everywhere, all terms on the left-hand side and all viscous terms on the right-hand side are zero. The equation reduces to:\n    $$ 0 = -\\frac{\\partial p}{\\partial z} $$\n    This shows that the pressure $p$ does not vary in the $z$-direction.\n\n-   **y-momentum equation**: With $v=0$ everywhere, all terms on the left-hand side and all viscous terms on the right-hand side are zero. The equation reduces to:\n    $$ 0 = -\\frac{\\partial p}{\\partial y} $$\n    This shows that the pressure $p$ does not vary in the $y$-direction.\n\n-   **x-momentum equation**: With $\\frac{\\partial}{\\partial t}=0$, $v=0$, $w=0$, $\\frac{\\partial u}{\\partial x}=0$, and $\\frac{\\partial u}{\\partial z}=0$, the equation simplifies significantly. The left-hand side (advection term) becomes zero.\n    $$ \\rho \\left( 0 + u(0) + 0 + 0 \\right) = -\\frac{\\partial p}{\\partial x} + \\mu \\left( 0 + \\frac{\\partial^2 u}{\\partial y^2} + 0 \\right) $$\n    This yields:\n    $$ 0 = -\\frac{\\partial p}{\\partial x} + \\mu \\frac{d^2 u}{d y^2} $$\n    Since we found that $p$ is only a function of $x$ and $u$ is only a function of $y$, we can write this equation with ordinary derivatives:\n    $$ \\frac{d^2 u}{dy^2} = \\frac{1}{\\mu} \\frac{dp}{dx} $$\n    The problem states that $\\frac{\\partial p}{\\partial x}$ is spatially uniform (i.e., a constant). Let's denote this constant as $G = \\frac{dp}{dx}$.\n\nWe now solve this second-order ordinary differential equation for $u(y)$ by integrating twice with respect to $y$:\n$$ \\frac{du}{dy} = \\int \\frac{G}{\\mu} dy = \\frac{G}{\\mu} y + C_1 $$\n$$ u(y) = \\int \\left( \\frac{G}{\\mu} y + C_1 \\right) dy = \\frac{G}{2\\mu} y^2 + C_1 y + C_2 $$\nwhere $C_1$ and $C_2$ are integration constants determined by the boundary conditions.\n\nThe problem provides three conditions: no-slip at both walls and symmetry. We need two to find the constants.\n1.  Symmetry condition about $y=0$: $\\left. \\frac{du}{dy} \\right|_{y=0} = 0$.\n    Applying this to the first integral:\n    $$ \\frac{G}{\\mu} (0) + C_1 = 0 \\quad \\implies \\quad C_1 = 0 $$\n2.  No-slip condition at the upper wall $y=h$: $u(h)=0$.\n    Applying this to the solution for $u(y)$ with $C_1=0$:\n    $$ u(h) = \\frac{G}{2\\mu} h^2 + C_2 = 0 \\quad \\implies \\quad C_2 = -\\frac{G}{2\\mu} h^2 $$\n\nSubstituting the constants back into the expression for $u(y)$:\n$$ u(y) = \\frac{G}{2\\mu} y^2 - \\frac{G}{2\\mu} h^2 = \\frac{G}{2\\mu} (y^2 - h^2) $$\nReplacing $G$ with $\\frac{dp}{dx}$ (or $\\frac{\\partial p}{\\partial x}$ as per the problem's notation), we get the parabolic velocity profile:\n$$ u(y) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} (y^2 - h^2) $$\nNote that for flow to occur in the positive $x$-direction ($u>0$), the pressure gradient $\\frac{\\partial p}{\\partial x}$ must be negative, as expected for a pressure-driven flow.\n\nFinally, we compute the volumetric flow rate per unit span, $q$:\n$$ q = \\int_{-h}^{+h} u(y) \\, dy = \\int_{-h}^{+h} \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} (y^2 - h^2) \\, dy $$\nSince $\\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}$ is a constant, we can take it out of the integral:\n$$ q = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\int_{-h}^{+h} (y^2 - h^2) \\, dy $$\nWe evaluate the definite integral:\n$$ \\int_{-h}^{+h} (y^2 - h^2) \\, dy = \\left[ \\frac{y^3}{3} - h^2 y \\right]_{-h}^{+h} $$\n$$ = \\left( \\frac{h^3}{3} - h^2(h) \\right) - \\left( \\frac{(-h)^3}{3} - h^2(-h) \\right) $$\n$$ = \\left( \\frac{h^3}{3} - h^3 \\right) - \\left( -\\frac{h^3}{3} + h^3 \\right) $$\n$$ = \\left( -\\frac{2h^3}{3} \\right) - \\left( \\frac{2h^3}{3} \\right) = -\\frac{4h^3}{3} $$\nSubstituting this result back into the expression for $q$:\n$$ q = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left( -\\frac{4h^3}{3} \\right) $$\nSimplifying the expression gives the final answer:\n$$ q = -\\frac{2h^3}{3\\mu} \\frac{\\partial p}{\\partial x} $$\nThis is the required closed-form analytic expression for the volumetric flow rate per unit span.", "answer": "$$ \\boxed{-\\frac{2h^3}{3\\mu} \\frac{\\partial p}{\\partial x}} $$", "id": "3377200"}, {"introduction": "Beyond steady-state solutions, it is crucial to understand how fluid structures evolve and dissipate energy over time. The Taylor-Green vortex provides a canonical example of viscous decay in a closed system, allowing for an analytical treatment of the rate of change of kinetic energy [@problem_id:3377151]. This practice provides deep insight into the role of viscous dissipation, a fundamental mechanism that governs the dynamics of turbulence and the decay of coherent structures in a fluid.", "problem": "Consider an incompressible, constant-density fluid of density $\\rho$ and kinematic viscosity $\\nu$ evolving in a square periodic domain $\\Omega = [0, 2\\pi/k] \\times [0, 2\\pi/k]$ under the Navier–Stokes equations. The initial velocity field is the Taylor–Green vortex\n$$\nu_x(x,y,0) = U_0 \\cos(k x)\\,\\sin(k y), \\quad\nu_y(x,y,0) = -U_0 \\sin(k x)\\,\\cos(k y), \\quad\nu_z(x,y,0) = 0,\n$$\nwhich satisfies $\\nabla \\cdot \\boldsymbol{u} = 0$. Let the domain-averaged kinetic energy per unit mass be defined by\n$$\nE(t) = \\frac{1}{2|\\Omega|} \\int_{\\Omega} |\\boldsymbol{u}(x,y,t)|^2 \\,\\mathrm{d}\\Omega.\n$$\nThere is no external body force.\n\nUsing only fundamental balance laws and standard properties of periodic boundary conditions, perform the following:\n\n1. Starting from the incompressible Navier–Stokes equations and the above definition of $E(t)$, derive the instantaneous decay rate of $E(t)$ at $t = 0$ due solely to viscous dissipation. Express your result in terms of $\\nu$, $k$, and $U_0$, and write it as $\\left.\\frac{\\mathrm{d}E}{\\mathrm{d}t}\\right|_{t=0}$.\n\n2. Independently, assume that for early times the flow preserves the spatial structure of the initial Taylor–Green vortex and can be represented by the separable ansatz\n$$\n\\boldsymbol{u}(x,y,t) = U_0\\,A(t)\\,\\Big(\\cos(k x)\\,\\sin(k y),\\, -\\sin(k x)\\,\\cos(k y),\\, 0\\Big),\n$$\nfor some scalar amplitude $A(t)$ with $A(0) = 1$. Determine the ordinary differential equation satisfied by $A(t)$ from the incompressible Navier–Stokes equations and obtain the early-time expansion of the energy ratio,\n$$\n\\frac{E(t)}{E(0)} = 1 + a_1\\,t + \\mathcal{O}(t^2),\n$$\nidentifying the coefficient $a_1$.\n\nReport as your final answer the single simplified analytic expression for $a_1$ in terms of $\\nu$ and $k$ only. Do not include any units in your final answer. If you find multiple intermediate expressions, your submitted final answer must be only the single value of $a_1$.", "solution": "The user-provided problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in theoretical fluid dynamics with a clear and unambiguous formulation. All necessary information is provided, and the requested tasks are mathematically tractable.\n\nThe solution is presented in two parts as requested by the problem statement.\n\nPart 1: Derivation of the instantaneous energy decay rate at $t = 0$.\n\nThe domain-averaged kinetic energy per unit mass is defined as:\n$$\nE(t) = \\frac{1}{2|\\Omega|} \\int_{\\Omega} |\\boldsymbol{u}(x,y,t)|^2 \\,\\mathrm{d}\\Omega\n$$\nwhere $|\\Omega| = (2\\pi/k)^2$ is the area of the domain. Differentiating $E(t)$ with respect to time $t$ yields:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{1}{2|\\Omega|} \\int_{\\Omega} \\frac{\\partial}{\\partial t}(\\boldsymbol{u} \\cdot \\boldsymbol{u}) \\,\\mathrm{d}\\Omega = \\frac{1}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot \\frac{\\partial \\boldsymbol{u}}{\\partial t} \\,\\mathrm{d}\\Omega\n$$\nThe incompressible Navier-Stokes equation for momentum conservation without external forces is:\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\boldsymbol{u}\n$$\nSubstituting $\\frac{\\partial \\boldsymbol{u}}{\\partial t}$ into the expression for $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{1}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot \\left( -\\frac{1}{\\rho}\\nabla p - (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\nu \\nabla^2 \\boldsymbol{u} \\right) \\,\\mathrm{d}\\Omega\n$$\nWe analyze each term in the integral:\n1.  Pressure term: $-\\frac{1}{\\rho|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot \\nabla p \\, \\mathrm{d}\\Omega$. Using the vector identity $\\nabla \\cdot (p\\boldsymbol{u}) = (\\nabla p) \\cdot \\boldsymbol{u} + p(\\nabla \\cdot \\boldsymbol{u})$ and the incompressibility condition $\\nabla \\cdot \\boldsymbol{u} = 0$, we have $\\boldsymbol{u} \\cdot \\nabla p = \\nabla \\cdot (p \\boldsymbol{u})$. By the divergence theorem and periodic boundary conditions, $\\int_{\\Omega} \\nabla \\cdot (p \\boldsymbol{u}) \\, \\mathrm{d}\\Omega = \\int_{\\partial \\Omega} p \\boldsymbol{u} \\cdot \\boldsymbol{n} \\, \\mathrm{d}S = 0$.\n2.  Advection term: $-\\frac{1}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot ((\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}) \\, \\mathrm{d}\\Omega$. The integrand can be written as $u_j \\frac{\\partial}{\\partial x_j} (\\frac{1}{2} u_i u_i) = \\nabla \\cdot (\\frac{1}{2}|\\boldsymbol{u}|^2 \\boldsymbol{u})$. Again, the integral of this divergence vanishes due to periodic boundary conditions.\n3.  Viscous term: $\\frac{\\nu}{|\\Omega|} \\int_{\\Omega} \\boldsymbol{u} \\cdot (\\nabla^2 \\boldsymbol{u}) \\, \\mathrm{d}\\Omega$. Using integration by parts (tantamount to a vector identity and the divergence theorem) on a periodic domain, for each component $u_i$: $\\int_{\\Omega} u_i \\nabla^2 u_i \\, \\mathrm{d}\\Omega = -\\int_{\\Omega} |\\nabla u_i|^2 \\, \\mathrm{d}\\Omega$. Summing over all components, $\\int_{\\Omega} \\boldsymbol{u} \\cdot \\nabla^2 \\boldsymbol{u} \\, \\mathrm{d}\\Omega = -\\int_{\\Omega} |\\nabla \\boldsymbol{u}|^2 \\, \\mathrm{d}\\Omega$, where $|\\nabla \\boldsymbol{u}|^2 = \\sum_{i,j} (\\partial u_i/\\partial x_j)^2$.\n\nThus, the rate of change of kinetic energy is governed by viscous dissipation:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = - \\frac{\\nu}{|\\Omega|} \\int_{\\Omega} |\\nabla \\boldsymbol{u}|^2 \\, \\mathrm{d}\\Omega\n$$\nWe evaluate this at $t=0$ using the initial velocity field $\\boldsymbol{u}(x,y,0)$:\n$u_x(0) = U_0 \\cos(kx)\\sin(ky)$, $u_y(0) = -U_0 \\sin(kx)\\cos(ky)$, $u_z(0) = 0$.\nThe required partial derivatives are:\n$\\frac{\\partial u_x}{\\partial x} = -U_0 k \\sin(kx)\\sin(ky)$, $\\frac{\\partial u_x}{\\partial y} = U_0 k \\cos(kx)\\cos(ky)$.\n$\\frac{\\partial u_y}{\\partial x} = -U_0 k \\cos(kx)\\cos(ky)$, $\\frac{\\partial u_y}{\\partial y} = U_0 k \\sin(kx)\\sin(ky)$.\nAll derivatives involving $u_z$ or $\\partial/\\partial z$ are zero.\nThe integrand $|\\nabla \\boldsymbol{u}(x,y,0)|^2$ is:\n$$\n|\\nabla \\boldsymbol{u}|^2 = \\left(\\frac{\\partial u_x}{\\partial x}\\right)^2 + \\left(\\frac{\\partial u_x}{\\partial y}\\right)^2 + \\left(\\frac{\\partial u_y}{\\partial x}\\right)^2 + \\left(\\frac{\\partial u_y}{\\partial y}\\right)^2\n$$\n$$\n|\\nabla \\boldsymbol{u}|^2 = U_0^2 k^2 \\sin^2(kx)\\sin^2(ky) + U_0^2 k^2 \\cos^2(kx)\\cos^2(ky) + U_0^2 k^2 \\cos^2(kx)\\cos^2(ky) + U_0^2 k^2 \\sin^2(kx)\\sin^2(ky)\n$$\n$$\n|\\nabla \\boldsymbol{u}|^2 = 2 U_0^2 k^2 \\left( \\sin^2(kx)\\sin^2(ky) + \\cos^2(kx)\\cos^2(ky) \\right)\n$$\nTo perform the integral, we use the property that the average of $\\sin^2(\\theta)$ or $\\cos^2(\\theta)$ over a full period is $1/2$. For functions $f(x)$ and $g(y)$ over the rectangular domain $\\Omega$, the average of their product is the product of their averages.\n$$\n\\frac{1}{|\\Omega|} \\int_{\\Omega} |\\nabla \\boldsymbol{u}|^2\\mathrm{d}\\Omega = 2 U_0^2 k^2 \\left( \\langle\\sin^2(kx)\\rangle\\langle\\sin^2(ky)\\rangle + \\langle\\cos^2(kx)\\rangle\\langle\\cos^2(ky)\\rangle \\right)\n$$\n$$\n= 2 U_0^2 k^2 \\left( \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) \\right) = 2 U_0^2 k^2 \\left(\\frac{1}{4} + \\frac{1}{4}\\right) = U_0^2 k^2\n$$\nFinally, substituting this back into the expression for the energy decay rate at $t=0$:\n$$\n\\left.\\frac{\\mathrm{d}E}{\\mathrm{d}t}\\right|_{t=0} = -\\nu (U_0^2 k^2) = -U_0^2 k^2 \\nu\n$$\n\nPart 2: Determination of $a_1$ using the separable ansatz.\n\nThe assumed form of the velocity field is $\\boldsymbol{u}(x,y,t) = U_0 A(t) \\boldsymbol{u}_{sp}(x,y)$, where $\\boldsymbol{u}_{sp}(x,y) = (\\cos(kx)\\sin(ky), -\\sin(kx)\\cos(ky), 0)$ and $A(0)=1$. To find the ODE for $A(t)$, we substitute this ansatz into the Navier-Stokes equation and project the equation onto the mode $\\boldsymbol{u}_{sp}$ using a spatial integral inner product over $\\Omega$, denoted by $\\langle \\boldsymbol{f}, \\boldsymbol{g} \\rangle = \\int_\\Omega \\boldsymbol{f}\\cdot\\boldsymbol{g}\\,\\mathrm{d}\\Omega$.\nThe projected equation is:\n$$\n\\langle \\boldsymbol{u}_{sp}, \\frac{\\partial \\boldsymbol{u}}{\\partial t} \\rangle = \\langle \\boldsymbol{u}_{sp}, -(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} \\rangle - \\langle \\boldsymbol{u}_{sp}, \\frac{1}{\\rho}\\nabla p \\rangle + \\langle \\boldsymbol{u}_{sp}, \\nu\\nabla^2\\boldsymbol{u} \\rangle\n$$\nInserting the ansatz:\n$$\nU_0 \\frac{\\mathrm{d}A}{\\mathrm{d}t} \\langle \\boldsymbol{u}_{sp}, \\boldsymbol{u}_{sp} \\rangle = - (U_0 A)^2 \\langle \\boldsymbol{u}_{sp}, (\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp} \\rangle - 0 + \\nu U_0 A \\langle \\boldsymbol{u}_{sp}, \\nabla^2\\boldsymbol{u}_{sp} \\rangle\n$$\nThe pressure term vanishes due to $\\nabla\\cdot\\boldsymbol{u}_{sp}=0$ and periodic boundary conditions. Let's evaluate the inner products:\n- $\\langle \\boldsymbol{u}_{sp}, \\boldsymbol{u}_{sp} \\rangle = \\int_\\Omega |\\boldsymbol{u}_{sp}|^2 d\\Omega = \\int_\\Omega (\\cos^2(kx)\\sin^2(ky) + \\sin^2(kx)\\cos^2(ky)) d\\Omega$. The average of the integrand is $1/4 + 1/4 = 1/2$. So, $\\langle \\boldsymbol{u}_{sp}, \\boldsymbol{u}_{sp} \\rangle = \\frac{1}{2}|\\Omega|$.\n- $\\langle \\boldsymbol{u}_{sp}, \\nabla^2\\boldsymbol{u}_{sp} \\rangle = -\\int_\\Omega |\\nabla\\boldsymbol{u}_{sp}|^2 d\\Omega$. We found in Part 1 that $\\frac{1}{|\\Omega|}\\int|\\nabla(U_0\\boldsymbol{u}_{sp})|^2 d\\Omega = U_0^2k^2$, which implies $\\frac{1}{|\\Omega|}\\int|\\nabla\\boldsymbol{u}_{sp}|^2 d\\Omega = k^2$. So, $\\langle \\boldsymbol{u}_{sp}, \\nabla^2\\boldsymbol{u}_{sp} \\rangle = -|\\Omega|k^2$.\n- The advection term requires computing $(\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp}$. A calculation shows this term is $(\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp} = -\\frac{k}{2}(\\sin(2kx), \\sin(2ky), 0)$. The inner product is then $\\langle \\boldsymbol{u}_{sp}, (\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp} \\rangle = -\\frac{k}{2} \\int_\\Omega (\\cos(kx)\\sin(ky)\\sin(2kx) - \\sin(kx)\\cos(ky)\\sin(2ky)) d\\Omega$. Due to the trigonometric identities $\\sin(2\\theta)=2\\sin\\theta\\cos\\theta$ and the orthogonality of sines and cosines, both terms in the integral evaluate to zero over the periodic domain. For example, $\\int_0^{2\\pi/k}\\cos(kx)\\sin(2kx)dx = 0$. Therefore, $\\langle \\boldsymbol{u}_{sp}, (\\boldsymbol{u}_{sp}\\cdot\\nabla)\\boldsymbol{u}_{sp} \\rangle = 0$.\n\nThe projected equation simplifies to:\n$$\nU_0 \\frac{\\mathrm{d}A}{\\mathrm{d}t} \\left(\\frac{1}{2}|\\Omega|\\right) = \\nu U_0 A (-|\\Omega| k^2)\n$$\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = -2\\nu k^2 A\n$$\nWith the initial condition $A(0)=1$, the solution is $A(t) = \\exp(-2\\nu k^2 t)$.\n\nNow, we compute the energy ratio $E(t)/E(0)$.\n$$\nE(t) = \\frac{1}{2|\\Omega|} \\int_{\\Omega} |U_0 A(t) \\boldsymbol{u}_{sp}|^2 d\\Omega = U_0^2 A(t)^2 \\left(\\frac{1}{2|\\Omega|} \\int_{\\Omega} |\\boldsymbolu_{sp}|^2 d\\Omega\\right)\n$$\nThe term in the parenthesis is the initial energy $E(0)$ divided by $U_0^2$ (since $A(0)=1$). Specifically, $E(0) = \\frac{U_0^2}{2|\\Omega|}\\int|\\boldsymbol{u}_{sp}|^2d\\Omega = \\frac{U_0^2}{2|\\Omega|}(\\frac{|\\Omega|}{2}) = \\frac{U_0^2}{4}$.\nSo, $E(t) = E(0) A(t)^2$. The ratio is:\n$$\n\\frac{E(t)}{E(0)} = A(t)^2 = \\left(\\exp(-2\\nu k^2 t)\\right)^2 = \\exp(-4\\nu k^2 t)\n$$\nFor early times ($t \\ll 1$), we use the Taylor expansion $\\exp(x) \\approx 1+x$ for small $x$:\n$$\n\\frac{E(t)}{E(0)} \\approx 1 - 4\\nu k^2 t + \\mathcal{O}(t^2)\n$$\nComparing this to the specified form $\\frac{E(t)}{E(0)} = 1 + a_1 t + \\mathcal{O}(t^2)$, we identify the coefficient $a_1$:\n$$\na_1 = -4\\nu k^2\n$$\nThis result is independent of $U_0$, as required.", "answer": "$$\\boxed{-4\\nu k^{2}}$$", "id": "3377151"}, {"introduction": "While analytical solutions provide invaluable insight, most practical problems in fluid dynamics require numerical methods. This practice moves into the realm of compressible flows and computational fluid dynamics, tasking you with building a finite volume solver from first principles [@problem_id:3377190]. The core challenge is to design numerical fluxes that guarantee exact conservation of mass, momentum, and energy—a cornerstone of any robust CFD code—and to verify this property through direct simulation.", "problem": "You are tasked with deriving and implementing a one-dimensional finite volume method for the compressible Navier–Stokes equations that is exactly conservative for mass, momentum, and total energy by construction through shared face fluxes. The derivation must start from the integral conservation laws and use constitutive relations for a Newtonian fluid with Fourier heat conduction and an ideal gas equation of state. Your program will carry out a single explicit time step on a uniform structured grid with periodic boundary conditions and report machine-level conservation diagnostics. All quantities are nondimensional, so no physical units are required.\n\nThe fundamental base you must start from consists of:\n- The integral conservation laws over a control volume for mass, momentum, and total energy. Let the conserved variable vector be $U = [\\rho, \\rho u, \\rho E]^{\\top}$, where $\\rho$ is density, $u$ is velocity, and $E$ is total specific energy. Let the inviscid (convective) flux be $F^{\\mathrm{c}}(U)$ and the viscous flux be $F^{\\mathrm{v}}(\\nabla W)$, where $W$ denotes primitive variables. The integral form over a control volume of width $\\Delta x$ centered at cell index $j$ on the domain $x \\in [0, L]$ is\n$$\n\\frac{d}{dt}\\int_{V_j} U\\, dx + \\left.F^{\\mathrm{c}}\\right|_{x_{j+\\frac{1}{2}}} - \\left.F^{\\mathrm{c}}\\right|_{x_{j-\\frac{1}{2}}} = \\left.F^{\\mathrm{v}}\\right|_{x_{j+\\frac{1}{2}}} - \\left.F^{\\mathrm{v}}\\right|_{x_{j-\\frac{1}{2}}}.\n$$\n- The ideal gas equation of state $p = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^{2}\\right)$, where $p$ is pressure and $\\gamma$ is the ratio of specific heats. The temperature is $T = p/(\\rho R)$ with gas constant $R$.\n- Newtonian viscous stress with Stokes hypothesis in one dimension: $\\tau_{xx} = \\frac{4}{3}\\mu \\frac{\\partial u}{\\partial x}$, with dynamic viscosity $\\mu$. Fourier heat conduction: $q_x = -\\kappa \\frac{\\partial T}{\\partial x}$ with thermal conductivity $\\kappa$. The specific heat at constant pressure is $c_p = \\frac{\\gamma R}{\\gamma - 1}$ and $\\kappa = \\frac{\\mu c_p}{\\mathrm{Pr}}$, where $\\mathrm{Pr}$ is the Prandtl number.\n- The inviscid flux in one spatial dimension:\n$$\nF^{\\mathrm{c}}(U) = \n\\begin{bmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(\\rho E + p)\n\\end{bmatrix}.\n$$\nThe viscous flux in one spatial dimension:\n$$\nF^{\\mathrm{v}} = \n\\begin{bmatrix}\n0 \\\\\n\\tau_{xx} \\\\\nu\\,\\tau_{xx} - q_x\n\\end{bmatrix}.\n$$\n\nRequirements for your discrete design and implementation:\n- Use a uniform grid with $N$ finite volumes covering $[0, L]$ with periodic boundary conditions, so that each interior face flux used to update adjacent cells is equal and opposite, guaranteeing exact telescoping cancellation of interior contributions.\n- Construct a two-point, consistent, symmetric numerical interface flux for the inviscid part that adds dissipation proportional to an upper bound on the local characteristic speed. In the implementation, use as penalization speed at each face the maximum over the two adjacent states of $|u| + a$, where $a = \\sqrt{\\gamma p/\\rho}$ is the local speed of sound. This choice must be applied in such a way that face contributions are equal and opposite for the two adjacent cells.\n- Discretize viscous terms by centered face gradients computed from adjacent cell values to form face-centered $\\tau_{xx}$ and $q_x$, and use the same face viscous flux vector for both cells sharing that face, so that viscous fluxes are also equal and opposite across interior faces.\n- Advance the solution by a single forward Euler time step, $U^{n+1}_j = U^n_j - \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{c}}_{j-\\frac{1}{2}}\\right) + \\frac{\\Delta t}{\\Delta x} \\left(F^{\\mathrm{v}}_{j+\\frac{1}{2}} - F^{\\mathrm{v}}_{j-\\frac{1}{2}}\\right)$, where hats denote numerical inviscid fluxes at faces. Choose the time step using a Courant–Friedrichs–Lewy number $\\mathrm{CFL}$ as $\\Delta t = \\mathrm{CFL}\\, \\Delta x / \\max_i \\left(|u_i| + a_i\\right)$.\n- All computations are nondimensional. You must implement all formulas needed; no external data is provided.\n\nTest suite and initial data:\n- Use domain length $L = 1$. For each test, initialize $(\\rho, u, p)$ as follows at cell centers $x_i = \\left(i + \\frac{1}{2}\\right)\\Delta x$, $i = 0,\\dots,N-1$.\n- Test A (smooth periodic): $N = 100$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0.01$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.1$. Initialize $\\rho(x) = 1 + 0.1\\sin(2\\pi x)$, $u(x) = 0.3$, $p(x) = 1$.\n- Test B (uniform equilibrium): $N = 64$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.2$. Initialize $\\rho(x) = 1$, $u(x) = 0$, $p(x) = 1$.\n- Test C (Riemann-type step): $N = 200$, $\\gamma = 1.4$, $R = 1$, $\\mu = 0.001$, $\\mathrm{Pr} = 0.72$, $\\mathrm{CFL} = 0.05$. Initialize left state on $x < 0.5$: $(\\rho, u, p) = (1, 0, 1)$; right state on $x \\ge 0.5$: $(\\rho, u, p) = (0.125, 0, 0.1)$.\n\nRequired outputs:\n- For each test, compute the global integrals before and after one time step: $M = \\int_0^L \\rho\\, dx$, $P = \\int_0^L \\rho u\\, dx$, $E_{\\mathrm{tot}} = \\int_0^L \\rho E\\, dx$. Use the midpoint rule consistent with cell averages, i.e., $\\sum_j U_{j} \\Delta x$.\n- Report, for each test, the absolute changes $\\left(|\\Delta M|, |\\Delta P|, |\\Delta E_{\\mathrm{tot}}|\\right)$ after one time step, rounded to $10^{-12}$ in decimal representation.\n- Your program should produce a single line of output containing the results as a comma-separated Python-style list enclosed in square brackets, with one three-element list per test in the order A, B, C. For example, a valid shape is $[[m_A,p_A,e_A],[m_B,p_B,e_B],[m_C,p_C,e_C]]$, where each entry is a decimal float.\n\nYour submission must be a complete, runnable program that performs these computations and prints the single required line. No user input is allowed, and no external files may be accessed.", "solution": "The user has provided a well-defined problem in computational fluid dynamics. The task is to derive and implement a one-dimensional finite volume method for the compressible Navier-Stokes equations, verify its conservation properties, and report the results for a given set of test cases. The problem is scientifically sound, self-contained, and all necessary parameters and equations are specified.\n\nThe derivation and implementation will proceed as follows. First, the governing equations and constitutive relations are discretized on a uniform, periodic grid. The final algorithm will then be implemented in Python using the NumPy library for vectorized computations.\n\n**1. Governing Equations and State Variables**\n\nThe system is governed by the 1D compressible Navier-Stokes equations in conservation form. The vector of conserved variables is $U = [\\rho, \\rho u, \\rho E]^{\\top}$, where $\\rho$ is the fluid density, $u$ is the velocity, and $E$ is the total specific energy. The integral form of the conservation law for a control volume $V_j$ of width $\\Delta x$ is:\n$$\n\\frac{d}{dt}\\int_{V_j} U\\, dx + F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}} = 0\n$$\nwhere $F = F^{\\mathrm{c}} - F^{\\mathrm{v}}$ is the total flux, composed of an inviscid (convective) part $F^{\\mathrm{c}}$ and a viscous part $F^{\\mathrm{v}}$.\n\nThe ideal gas equation of state relates pressure $p$ to the conserved quantities:\n$$\np = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right) = (\\gamma - 1)\\left(U_3 - \\frac{U_2^2}{2U_1}\\right)\n$$\nwhere $\\gamma$ is the ratio of specific heats. To convert from primitive variables $(\\rho, u, p)$ back to conserved variables, we use:\n$$\nU = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2 \\end{bmatrix}\n$$\n\n**2. Finite Volume Discretization**\n\nWe use a finite volume method, where $U_j$ represents the cell-average of the conserved quantities in cell $j$. The semi-discrete form of the governing equations is:\n$$\n\\frac{dU_j}{dt} = -\\frac{1}{\\Delta x} \\left(\\widehat{F}_{j+\\frac{1}{2}} - \\widehat{F}_{j-\\frac{1}{2}}\\right)\n$$\nHere, $\\widehat{F}_{j+\\frac{1}{2}}$ is the numerical flux at the interface between cell $j$ and cell $j+1$. This flux approximates the physical flux and is composed of numerical inviscid and viscous components: $\\widehat{F} = \\widehat{F}^{\\mathrm{c}} - \\widehat{F}^{\\mathrm{v}}$.\n\n**3. Numerical Inviscid Flux**\n\nThe problem specifies a symmetric, two-point flux with dissipation, characteristic of a Rusanov (or local Lax-Friedrichs) scheme. The numerical flux at the interface $j+\\frac{1}{2}$ between states $U_L = U_j$ and $U_R = U_{j+1}$ is:\n$$\n\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} = \\frac{1}{2} \\left[ F^{\\mathrm{c}}(U_L) + F^{\\mathrm{c}}(U_R) \\right] - \\frac{1}{2} S_{j+\\frac{1}{2}} (U_R - U_L)\n$$\nThe physical flux $F^{\\mathrm{c}}(U)$ is given by:\n$$\nF^{\\mathrm{c}}(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{bmatrix}\n$$\nThe dissipation term $S_{j+\\frac{1}{2}}$ is a numerical wave speed, specified as the maximum characteristic speed at the interface:\n$$\nS_{j+\\frac{1}{2}} = \\max\\left( |u_L| + a_L, |u_R| + a_R \\right)\n$$\nwhere $a = \\sqrt{\\gamma p / \\rho}$ is the local speed of sound. This formulation ensures that the flux contribution is equal and opposite for the two cells sharing the interface, leading to a conservative scheme.\n\n**4. Numerical Viscous Flux**\n\nThe viscous flux is discretized using centered differences at the cell interface $j+\\frac{1}{2}$. The physical viscous flux is:\n$$\nF^{\\mathrm{v}} = \\begin{bmatrix} 0 \\\\ \\tau_{xx} \\\\ u\\,\\tau_{xx} - q_x \\end{bmatrix}\n$$\nThe shear stress $\\tau_{xx}$ and heat flux $q_x$ are approximated at the face:\n$$\n\\tau_{xx, j+\\frac{1}{2}} = \\frac{4}{3}\\mu \\left(\\frac{\\partial u}{\\partial x}\\right)_{j+\\frac{1}{2}} \\approx \\frac{4}{3}\\mu \\frac{u_{j+1} - u_j}{\\Delta x}\n$$\n$$\nq_{x, j+\\frac{1}{2}} = -\\kappa \\left(\\frac{\\partial T}{\\partial x}\\right)_{j+\\frac{1}{2}} \\approx -\\kappa \\frac{T_{j+1} - T_j}{\\Delta x}\n$$\nThe temperature $T$ is derived from the ideal gas law, $T = p/(\\rho R)$, where $R$ is the gas constant. The thermal conductivity $\\kappa$ is related to the dynamic viscosity $\\mu$ via the Prandtl number $\\mathrm{Pr}$: $\\kappa = \\frac{\\mu c_p}{\\mathrm{Pr}}$, with $c_p = \\frac{\\gamma R}{\\gamma - 1}$. The velocity $u$ in the energy flux term is averaged at the face: $u_{j+\\frac{1}{2}} = \\frac{1}{2}(u_j + u_{j+1})$. This centered formulation is also conservative by construction.\n\n**5. Time Integration and Conservation**\n\nThe system is advanced by a single forward Euler step:\n$$\nU^{n+1}_j = U^n_j - \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{c}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{c}}_{j-\\frac{1}{2}}\\right) + \\frac{\\Delta t}{\\Delta x} \\left(\\widehat{F}^{\\mathrm{v}}_{j+\\frac{1}{2}} - \\widehat{F}^{\\mathrm{v}}_{j-\\frac{1}{2}}\\right)\n$$\nThe time step $\\Delta t$ is determined by the Courant-Friedrichs-Lewy (CFL) condition:\n$$\n\\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{\\max_j(|u_j| + a_j)}\n$$\nTo check for conservation, we compute the total mass $M$, momentum $P$, and energy $E_{\\mathrm{tot}}$ over the domain by summing the cell-averaged quantities:\n$$\n\\sum_j U_j \\Delta x = \\begin{bmatrix} M \\\\ P \\\\ E_{\\mathrm{tot}} \\end{bmatrix}\n$$\nDue to the periodic boundary conditions and the conservative flux formulation, the sum of all flux differences across the domain forms a telescoping sum that evaluates to zero. Therefore, $\\sum_j (U^{n+1}_j - U^n_j) = 0$. The total conserved quantities should remain constant up to floating-point precision errors. The problem asks to calculate the absolute change in these total quantities to verify this property.\n\nThe implementation will be fully vectorized using NumPy. Left and right states for all interfaces will be generated using `numpy.roll` to handle the periodic boundaries efficiently. The algorithm will loop through the specified test cases, perform one time step for each, and calculate the conservation diagnostics.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a 1D finite volume method for compressible Navier-Stokes\n    and carries out a single explicit time step to report conservation diagnostics.\n    \"\"\"\n\n    test_cases = [\n        # Test A: Smooth periodic wave\n        {\n            \"name\": \"A\",\n            \"N\": 100, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.01, \"Pr\": 0.72, \"CFL\": 0.1,\n            \"ic_type\": \"function\",\n            \"ic_func\": lambda x: (1.0 + 0.1 * np.sin(2 * np.pi * x), 0.3, 1.0)\n        },\n        # Test B: Uniform equilibrium\n        {\n            \"name\": \"B\",\n            \"N\": 64, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.0, \"Pr\": 0.72, \"CFL\": 0.2,\n            \"ic_type\": \"function\",\n            \"ic_func\": lambda x: (1.0, 0.0, 1.0)\n        },\n        # Test C: Riemann-type step\n        {\n            \"name\": \"C\",\n            \"N\": 200, \"L\": 1.0, \"gamma\": 1.4, \"R\": 1.0,\n            \"mu\": 0.001, \"Pr\": 0.72, \"CFL\": 0.05,\n            \"ic_type\": \"riemann\",\n            \"ic_states\": {\"L\": (1.0, 0.0, 1.0), \"R\": (0.125, 0.0, 0.1), \"split\": 0.5}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack parameters\n        N, L, gamma, R = case[\"N\"], case[\"L\"], case[\"gamma\"], case[\"R\"]\n        mu, Pr, CFL = case[\"mu\"], case[\"Pr\"], case[\"CFL\"]\n\n        # Grid setup\n        dx = L / N\n        x = (np.arange(N) + 0.5) * dx\n\n        # Initial conditions\n        rho, u, p = np.zeros(N), np.zeros(N), np.zeros(N)\n        if case[\"ic_type\"] == \"function\":\n            rho_vals, u_vals, p_vals = case[\"ic_func\"](x)\n            rho = rho_vals if isinstance(rho_vals, np.ndarray) else np.full(N, rho_vals)\n            u = u_vals if isinstance(u_vals, np.ndarray) else np.full(N, u_vals)\n            p = p_vals if isinstance(p_vals, np.ndarray) else np.full(N, p_vals)\n        elif case[\"ic_type\"] == \"riemann\":\n            split_pos = case[\"ic_states\"][\"split\"]\n            mask_L = x < split_pos\n            mask_R = x >= split_pos\n            rho[mask_L], u[mask_L], p[mask_L] = case[\"ic_states\"][\"L\"]\n            rho[mask_R], u[mask_R], p[mask_R] = case[\"ic_states\"][\"R\"]\n            \n        # Helper functions\n        def primitives_to_conserved(rho, u, p, gamma):\n            rho_u = rho * u\n            rho_E = p / (gamma - 1.0) + 0.5 * rho * u**2\n            return np.array([rho, rho_u, rho_E])\n\n        def conserved_to_primitives(U, gamma, R):\n            rho = U[0]\n            # Add a small epsilon to rho to prevent division by zero in vacuum-like states\n            u = U[1] / (rho + 1e-100)\n            rho_E = U[2]\n            # Ensure internal energy is non-negative\n            internal_energy_density = rho_E - 0.5 * rho * u**2\n            internal_energy_density = np.maximum(internal_energy_density, 1e-100)\n            p = (gamma - 1.0) * internal_energy_density\n            T = p / ((rho + 1e-100) * R)\n            a = np.sqrt(gamma * p / (rho + 1e-100))\n            return rho, u, p, T, a\n\n        # Initial state and total quantities\n        U = primitives_to_conserved(rho, u, p, gamma)\n        total_initial = np.sum(U, axis=1) * dx\n\n        # --- Single Time Step Calculation ---\n        \n        # 1. Decode primitives from conserved state U\n        rho, u, p, T, a = conserved_to_primitives(U, gamma, R)\n        \n        # 2. Calculate time step dt\n        max_wave_speed = np.max(np.abs(u) + a)\n        dt = CFL * dx / max_wave_speed\n        \n        # 3. Prepare left and right states at interfaces using periodic boundaries\n        U_L = U\n        U_R = np.roll(U, -1, axis=1)\n        rho_L, u_L, p_L, T_L, a_L = conserved_to_primitives(U_L, gamma, R)\n        rho_R, u_R, p_R, T_R, a_R = conserved_to_primitives(U_R, gamma, R)\n        \n        # 4. Compute numerical inviscid flux (Rusanov)\n        def get_inviscid_flux(rho, u, p, U):\n            rho_u = U[1]\n            rho_E = U[2]\n            return np.array([rho_u, rho_u * u + p, u * (rho_E + p)])\n\n        Fc_L = get_inviscid_flux(rho_L, u_L, p_L, U_L)\n        Fc_R = get_inviscid_flux(rho_R, u_R, p_R, U_R)\n        \n        S = np.maximum(np.abs(u_L) + a_L, np.abs(u_R) + a_R)\n        Fc_num = 0.5 * (Fc_L + Fc_R) - 0.5 * S[np.newaxis, :] * (U_R - U_L)\n        \n        # 5. Compute numerical viscous flux\n        Fv_num = np.zeros_like(U)\n        if mu > 0:\n            cp = gamma * R / (gamma - 1.0)\n            kappa = mu * cp / Pr\n            dudx = (u_R - u_L) / dx\n            dTdx = (T_R - T_L) / dx\n            tau_xx = (4.0/3.0) * mu * dudx\n            q_x = -kappa * dTdx\n            u_face = 0.5 * (u_L + u_R)\n            Fv_num[1, :] = tau_xx\n            Fv_num[2, :] = u_face * tau_xx - q_x\n\n        # 6. Total numerical flux and RHS computation\n        F_total_num = Fc_num - Fv_num\n        F_total_num_shifted = np.roll(F_total_num, 1, axis=1) # Fluxes at j-1/2 faces\n        RHS = -(1.0 / dx) * (F_total_num - F_total_num_shifted)\n        \n        # 7. Update solution with Forward Euler\n        U_final = U + dt * RHS\n        \n        # --- End of time step ---\n\n        # Final total quantities and conservation check\n        total_final = np.sum(U_final, axis=1) * dx\n        changes = np.abs(total_final - total_initial)\n        rounded_changes = [round(c, 12) for c in changes]\n        all_results.append(rounded_changes)\n        \n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "3377190"}]}