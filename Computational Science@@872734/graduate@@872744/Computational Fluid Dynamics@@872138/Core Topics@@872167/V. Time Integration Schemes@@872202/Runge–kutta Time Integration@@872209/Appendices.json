{"hands_on_practices": [{"introduction": "The coefficients defining a Runge-Kutta method, often presented in a Butcher tableau, are not arbitrary; they are the result of rigorous mathematical constraints. This first practice invites you to explore the origin of these constraints by connecting the method's order of accuracy to the principles of numerical quadrature [@problem_id:3359935]. By analyzing a simplified Ordinary Differential Equation (ODE), you will derive the fundamental conditions on the method's weights and nodes that ensure high-order accuracy, providing a clear insight into the design of RK schemes.", "problem": "Consider the semi-discrete system that arises from the Method of Lines (MOL) applied to a spatial discretization of the compressible Navier–Stokes equations, yielding an initial-value problem of the form $y'(t) = F(t,y(t))$ with $y(t) \\in \\mathbb{R}^{m}$ and explicit time dependence in $F$. An $s$-stage explicit Runge–Kutta (RK) method is defined by stage abscissae $c_{i}$, weights $b_{i}$, and coefficients $a_{ij}$ as follows: for a time step size $h0$ and time nodes $t_{n}$, the internal stages are\n$$\nk_{i} \\equiv F\\!\\left(t_{n} + c_{i} h,\\; y_{n} + h \\sum_{j=1}^{i-1} a_{ij} k_{j}\\right), \\quad i=1,\\dots,s,\n$$\nand the update is\n$$\ny_{n+1} = y_{n} + h \\sum_{i=1}^{s} b_{i} k_{i}.\n$$\nAssume $F$ is sufficiently smooth.\n\nYour task is to derive, from first principles and without the use of pre-stated RK order conditions, the subset of order conditions that involve only the stage abscissae $c_{i}$ and weights $b_{i}$ required to ensure accuracy when $F$ has explicit time dependence. Specifically:\n\n- Using the Fundamental Theorem of Calculus and polynomial exactness, restrict attention to the subcase $y'(t) = \\phi(t)$ where $\\phi$ depends only on $t$ (no dependence on $y$). From this subcase, derive the set of conditions on $\\{b_{i}\\}_{i=1}^{s}$ and $\\{c_{i}\\}_{i=1}^{s}$ that must hold for the method to be of order $p$ with respect to integrating $\\phi(t)$ over a single time step, for $p = 4$. Express these conditions explicitly as equations that relate moments of the $c_{i}$ with the $b_{i}$. Do not assume any known order conditions; derive them from the requirement of exactness for polynomial $\\phi$.\n\n- For the classical $4$-stage, $4$-th order explicit Runge–Kutta method (often called “RK4”), take the stage abscissae and weights\n$$\nc_{1} = 0, \\quad c_{2} = \\frac{1}{2}, \\quad c_{3} = \\frac{1}{2}, \\quad c_{4} = 1,\n$$\n$$\nb_{1} = \\frac{1}{6}, \\quad b_{2} = \\frac{1}{3}, \\quad b_{3} = \\frac{1}{3}, \\quad b_{4} = \\frac{1}{6}.\n$$\nVerify the derived conditions by computing the sums\n$$\nS_{q} \\equiv \\sum_{i=1}^{4} b_{i} c_{i}^{q}, \\quad q = 0,1,2,3.\n$$\nProvide your final answer as the single row vector $\\left(S_{0},\\, S_{1},\\, S_{2},\\, S_{3}\\right)$.\n\nNo numerical rounding is required; report exact rational values. No physical units are involved.", "solution": "The problem statement is first validated according to the specified criteria.\n\n**Step 1: Extract Givens**\n- The initial-value problem is of the form $y'(t) = F(t,y(t))$ with $y(t) \\in \\mathbb{R}^{m}$.\n- An $s$-stage explicit Runge–Kutta (RK) method is given by:\n  - Internal stages: $k_{i} \\equiv F(t_{n} + c_{i} h, y_{n} + h \\sum_{j=1}^{i-1} a_{ij} k_{j})$, for $i=1,\\dots,s$.\n  - Update rule: $y_{n+1} = y_{n} + h \\sum_{i=1}^{s} b_{i} k_{i}$.\n- Parameters are stage abscissae $c_{i}$, weights $b_{i}$, and coefficients $a_{ij}$.\n- The task is to analyze the subcase $y'(t) = \\phi(t)$, where $\\phi$ is independent of $y$.\n- From this subcase, derive the conditions on $\\{b_{i}\\}$ and $\\{c_{i}\\}$ for the method to be of order $p=4$.\n- The derivation must be from first principles (Fundamental Theorem of Calculus and polynomial exactness).\n- For a specific $4$-stage, $4$-th order RK method, the coefficients are given:\n  - Stage abscissae: $c_{1} = 0$, $c_{2} = \\frac{1}{2}$, $c_{3} = \\frac{1}{2}$, $c_{4} = 1$.\n  - Weights: $b_{1} = \\frac{1}{6}$, $b_{2} = \\frac{1}{3}$, $b_{3} = \\frac{1}{3}$, $b_{4} = \\frac{1}{6}$.\n- The final task is to compute the sums $S_{q} \\equiv \\sum_{i=1}^{4} b_{i} c_{i}^{q}$ for $q = 0,1,2,3$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in the theory of numerical methods for ordinary differential equations, specifically Runge-Kutta methods. All definitions and concepts are standard in numerical analysis.\n- **Well-Posed:** The problem is clearly stated, providing all necessary information for a unique solution. The derivation path is specified, and the final calculation is unambiguous.\n- **Objective:** The problem is stated using precise mathematical language, free from any subjectivity or bias.\n- **Conclusion:** The problem does not violate any of the invalidity criteria. It is a scientifically sound, well-posed, and objective problem from the field of numerical analysis.\n\n**Verdict and Action**\nThe problem is valid. A complete solution is provided below.\n\n**Derivation of Order Conditions**\n\nWe consider the special case of the ordinary differential equation (ODE) $y'(t) = F(t,y(t))$ where the right-hand side is independent of $y$. This gives the ODE $y'(t) = \\phi(t)$.\n\nThe exact solution for $y(t)$ over a single time step from $t_{n}$ to $t_{n+1} = t_{n} + h$ is given by the Fundamental Theorem of Calculus:\n$$\ny(t_{n+1}) - y(t_n) = \\int_{t_n}^{t_{n+1}} y'(t) \\, dt = \\int_{t_n}^{t_n+h} \\phi(t) \\, dt.\n$$\nTo analyze the integral over a standard interval, we perform a change of variables. Let $t = t_{n} + \\tau h$, so that $dt = h \\, d\\tau$. The integration limits change from $t=t_n$ to $\\tau=0$ and from $t=t_{n+1}$ to $\\tau=1$. The exact increment is then:\n$$\ny(t_{n+1}) - y(t_n) = h \\int_{0}^{1} \\phi(t_{n} + \\tau h) \\, d\\tau.\n$$\nNow, we apply the explicit Runge-Kutta method to this simplified ODE. The stage vectors $k_{i}$ are given by:\n$$\nk_{i} = F(t_{n} + c_{i} h, y_{n} + h \\sum_{j=1}^{i-1} a_{ij} k_{j}).\n$$\nSince $F(t,y) = \\phi(t)$ and has no dependence on $y$, the stage calculation simplifies to:\n$$\nk_{i} = \\phi(t_{n} + c_{i} h).\n$$\nThe numerical solution at time $t_{n+1}$ is then given by the update formula:\n$$\ny_{n+1} = y_{n} + h \\sum_{i=1}^{s} b_{i} k_{i} = y_{n} + h \\sum_{i=1}^{s} b_{i} \\phi(t_{n} + c_{i} h).\n$$\nThe numerical increment is $y_{n+1} - y_n = h \\sum_{i=1}^{s} b_{i} \\phi(t_{n} + c_{i} h)$.\n\nFor the numerical method to be accurate, the numerical increment must provide a good approximation to the exact integral. The expression $\\sum_{i=1}^{s} b_{i} \\phi(t_{n} + c_{i} h)$ is a quadrature rule that approximates the integral $\\int_{0}^{1} \\phi(t_{n} + \\tau h) \\, d\\tau$. The points $c_i$ in $[0,1]$ are the quadrature nodes and $b_i$ are the quadrature weights.\n\nFor a method to be of order $p$ for this subproblem, the numerical quadrature must be exact for all polynomials up to degree $p-1$. This requirement arises from matching the Taylor series expansion of the numerical solution with that of the exact solution. Let's test this with a basis of polynomials. We can set $\\phi(t_n+\\tau h) = \\tau^q$ for some non-negative integer $q$.\n\nThe exact integral becomes:\n$$\n\\int_{0}^{1} \\tau^q \\, d\\tau = \\left[ \\frac{\\tau^{q+1}}{q+1} \\right]_{0}^{1} = \\frac{1}{q+1}.\n$$\nThe numerical approximation of this integral is:\n$$\n\\sum_{i=1}^{s} b_{i} (c_{i})^q.\n$$\nFor the quadrature to be exact for $\\tau^q$, these two expressions must be equal. For the method to be order $p$ (in this context), this equality must hold for $q = 0, 1, \\dots, p-1$.\nThe problem requires order $p=4$, so we must satisfy the conditions for $q=0, 1, 2, 3$:\n\\begin{itemize}\n    \\item For $q=0$: $\\sum_{i=1}^{s} b_{i} c_{i}^{0} = \\sum_{i=1}^{s} b_{i} = \\frac{1}{0+1} = 1$.\n    \\item For $q=1$: $\\sum_{i=1}^{s} b_{i} c_{i}^{1} = \\frac{1}{1+1} = \\frac{1}{2}$.\n    \\item For $q=2$: $\\sum_{i=1}^{s} b_{i} c_{i}^{2} = \\frac{1}{2+1} = \\frac{1}{3}$.\n    \\item For $q=3$: $\\sum_{i=1}^{s} b_{i} c_{i}^{3} = \\frac{1}{3+1} = \\frac{1}{4}$.\n\\end{itemize}\nThese are the four order conditions for $p=4$ that involve only the stage abscissae $c_i$ and weights $b_i$.\n\n**Verification for the Classical RK4 Method**\n\nWe are given the coefficients for the classical $4$-stage, $4$-th order Runge-Kutta method:\n- $c_1 = 0$, $c_2 = \\frac{1}{2}$, $c_3 = \\frac{1}{2}$, $c_4 = 1$.\n- $b_1 = \\frac{1}{6}$, $b_2 = \\frac{1}{3}$, $b_3 = \\frac{1}{3}$, $b_4 = \\frac{1}{6}$.\nWe need to calculate the sums $S_{q} = \\sum_{i=1}^{4} b_{i} c_{i}^{q}$ for $q=0, 1, 2, 3$.\n\nFor $q=0$:\n$$\nS_{0} = \\sum_{i=1}^{4} b_{i} c_{i}^{0} = b_{1} + b_{2} + b_{3} + b_{4} = \\frac{1}{6} + \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{6} = \\frac{1}{6} + \\frac{2}{6} + \\frac{2}{6} + \\frac{1}{6} = \\frac{6}{6} = 1.\n$$\n\nFor $q=1$:\n$$\nS_{1} = \\sum_{i=1}^{4} b_{i} c_{i}^{1} = b_{1}c_{1} + b_{2}c_{2} + b_{3}c_{3} + b_{4}c_{4} = \\frac{1}{6}(0) + \\frac{1}{3}\\left(\\frac{1}{2}\\right) + \\frac{1}{3}\\left(\\frac{1}{2}\\right) + \\frac{1}{6}(1) = 0 + \\frac{1}{6} + \\frac{1}{6} + \\frac{1}{6} = \\frac{3}{6} = \\frac{1}{2}.\n$$\n\nFor $q=2$:\n$$\nS_{2} = \\sum_{i=1}^{4} b_{i} c_{i}^{2} = b_{1}c_{1}^{2} + b_{2}c_{2}^{2} + b_{3}c_{3}^{2} + b_{4}c_{4}^{2} = \\frac{1}{6}(0)^{2} + \\frac{1}{3}\\left(\\frac{1}{2}\\right)^{2} + \\frac{1}{3}\\left(\\frac{1}{2}\\right)^{2} + \\frac{1}{6}(1)^{2} \\\\\n= 0 + \\frac{1}{3}\\left(\\frac{1}{4}\\right) + \\frac{1}{3}\\left(\\frac{1}{4}\\right) + \\frac{1}{6} = \\frac{1}{12} + \\frac{1}{12} + \\frac{2}{12} = \\frac{4}{12} = \\frac{1}{3}.\n$$\n\nFor $q=3$:\n$$\nS_{3} = \\sum_{i=1}^{4} b_{i} c_{i}^{3} = b_{1}c_{1}^{3} + b_{2}c_{2}^{3} + b_{3}c_{3}^{3} + b_{4}c_{4}^{3} = \\frac{1}{6}(0)^{3} + \\frac{1}{3}\\left(\\frac{1}{2}\\right)^{3} + \\frac{1}{3}\\left(\\frac{1}{2}\\right)^{3} + \\frac{1}{6}(1)^{3} \\\\\n= 0 + \\frac{1}{3}\\left(\\frac{1}{8}\\right) + \\frac{1}{3}\\left(\\frac{1}{8}\\right) + \\frac{1}{6} = \\frac{1}{24} + \\frac{1}{24} + \\frac{4}{24} = \\frac{6}{24} = \\frac{1}{4}.\n$$\nThe computed values are $S_0=1$, $S_1=\\frac{1}{2}$, $S_2=\\frac{1}{3}$, and $S_3=\\frac{1}{4}$, which precisely match the required values for order $p=4$ derived above. The final answer is the row vector $(S_0, S_1, S_2, S_3)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\frac{1}{2}  \\frac{1}{3}  \\frac{1}{4}\n\\end{pmatrix}\n}\n$$", "id": "3359935"}, {"introduction": "Once we have an accurate time integrator, how do we ensure it remains stable when applied to the large systems of ODEs that arise from discretizing a Partial Differential Equation (PDE)? This practice guides you through the canonical method of lines stability analysis for an advection-diffusion problem [@problem_id:3359928]. You will discretize the spatial domain, find the eigenvalues of the resulting operator using Fourier analysis, and then determine the maximum stable time step by ensuring these eigenvalues, when scaled by $\\Delta t$, lie within the stability region of the classical fourth-order Runge-Kutta method.", "problem": "Consider the one-dimensional linear advection–diffusion Partial Differential Equation (PDE) in Computational Fluid Dynamics (CFD)\n$$\nu_{t}(x,t) + a\\,u_{x}(x,t) = \\nu\\,u_{xx}(x,t),\n$$\nwith constant advection speed $a0$ and kinematic viscosity $\\nu0$, on the periodic domain $x \\in [0,L]$. Discretize space on a uniform grid $x_{j} = j h$ for $j=0,1,\\ldots,N-1$ with spacing $h = L/N$, and denote by $y_{j}(t) \\equiv u(x_{j},t)$ the nodal solution. Use second-order centered finite differences for $u_{x}$ and $u_{xx}$, and impose periodic boundary conditions. \n\n1. Derive the semi-discrete Ordinary Differential Equation (ODE) system in matrix form $y'(t) = A\\,y(t)$, identifying explicitly the discrete operators that contribute to advection and diffusion. \n\n2. Show that, due to periodicity and uniform spacing, the discrete Fourier modes \n$$\n\\phi_{j}(\\theta) = \\exp(i j \\theta), \\quad \\theta \\in [-\\pi,\\pi],\n$$\nare eigenvectors of the matrix $A$, and derive the corresponding eigenvalues $\\lambda(\\theta)$ as functions of $\\theta$, highlighting the separate advection and diffusion contributions to the real and imaginary parts of $\\lambda(\\theta)$.\n\n3. Consider time integration by the classical explicit fourth-order Runge–Kutta (RK) method. Let the one-step amplification factor be $R(z)$ when applied to the scalar test equation $y'=\\lambda y$. Determine the largest stable timestep $\\Delta t_{\\max}$ such that \n$$\n\\max_{\\theta \\in [-\\pi,\\pi]} \\left| R\\!\\left(\\Delta t\\,\\lambda(\\theta)\\right) \\right| \\leq 1.\n$$\nUse the following physical and numerical parameters: $L = 1$ (meters), $N = 128$, $a = 0.2$ (meters per second), and $\\nu = 10^{-3}$ (square meters per second). \n\nRound your final answer for $\\Delta t_{\\max}$ to four significant figures and express it in seconds.", "solution": "The user-provided problem is evaluated as valid based on the specified criteria. It is scientifically grounded in computational fluid dynamics, well-posed, objective, and contains all necessary information for a complete solution.\n\n### Part 1: Derivation of the Semi-Discrete ODE System\n\nThe given one-dimensional linear advection–diffusion equation is:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\nWe discretize the spatial domain $x \\in [0,L]$ using a uniform grid with $N$ points $x_j = j h$ for $j=0, 1, \\ldots, N-1$, where the grid spacing is $h=L/N$. The solution at these grid points is denoted by $y_j(t) = u(x_j, t)$. The semi-discrete form of the PDE is obtained by replacing the spatial derivatives with finite difference approximations.\n\nFor the first spatial derivative, the second-order centered difference is:\n$$\n\\left. \\frac{\\partial u}{\\partial x} \\right|_{x_j} \\approx \\frac{u(x_{j+1}, t) - u(x_{j-1}, t)}{2h} = \\frac{y_{j+1}(t) - y_{j-1}(t)}{2h}\n$$\nFor the second spatial derivative, the second-order centered difference is:\n$$\n\\left. \\frac{\\partial^2 u}{\\partial x^2} \\right|_{x_j} \\approx \\frac{u(x_{j+1}, t) - 2u(x_j, t) + u(x_{j-1}, t)}{h^2} = \\frac{y_{j+1}(t) - 2y_j(t) + y_{j-1}(t)}{h^2}\n$$\nDue to the periodic domain, the indices are taken modulo $N$, meaning $y_{j+N} = y_j$. For example, $y_{-1} = y_{N-1}$ and $y_N = y_0$.\n\nSubstituting these approximations into the PDE gives a system of ordinary differential equations (ODEs), one for each grid point $j$:\n$$\n\\frac{d y_j}{d t} = -a \\left( \\frac{y_{j+1} - y_{j-1}}{2h} \\right) + \\nu \\left( \\frac{y_{j+1} - 2y_j + y_{j-1}}{h^2} \\right)\n$$\nLet $y(t) = [y_0(t), y_1(t), \\ldots, y_{N-1}(t)]^T$ be the vector of solutions. The system can be written in matrix form as $y'(t) = A y(t)$. We can identify the contributions from advection and diffusion. Let $A = A_{adv} + A_{diff}$.\n\nThe advection operator $A_{adv}$ corresponds to the term $-a u_x$:\n$$\n(A_{adv} y)_j = -\\frac{a}{2h} (y_{j+1} - y_{j-1})\n$$\nThe diffusion operator $A_{diff}$ corresponds to the term $\\nu u_{xx}$:\n$$\n(A_{diff} y)_j = \\frac{\\nu}{h^2} (y_{j+1} - 2y_j + y_{j-1})\n$$\nThe combined operator $A = A_{adv} + A_{diff}$ acts on $y_j$ as:\n$$\n(A y)_j = \\left(\\frac{\\nu}{h^2} - \\frac{a}{2h}\\right) y_{j+1} - \\frac{2\\nu}{h^2} y_j + \\left(\\frac{\\nu}{h^2} + \\frac{a}{2h}\\right) y_{j-1}\n$$\nThe matrix $A$ is an $N \\times N$ circulant matrix due to the periodic boundary conditions.\n\n### Part 2: Eigenvalue Analysis\n\nWe test if the discrete Fourier modes $\\phi_j(\\theta) = \\exp(ij\\theta)$ are eigenvectors of the matrix $A$. Let the vector $\\phi(\\theta)$ have components $[\\phi_j(\\theta)]_j = \\exp(ij\\theta)$. We apply the operator $A$ to this vector. The $j$-th component of the result is:\n$$\n(A \\phi(\\theta))_j = \\left(\\frac{\\nu}{h^2} - \\frac{a}{2h}\\right) \\exp(i(j+1)\\theta) - \\frac{2\\nu}{h^2} \\exp(ij\\theta) + \\left(\\frac{\\nu}{h^2} + \\frac{a}{2h}\\right) \\exp(i(j-1)\\theta)\n$$\nFactor out the term $\\exp(ij\\theta)$:\n$$\n(A \\phi(\\theta))_j = \\exp(ij\\theta) \\left[ \\left(\\frac{\\nu}{h^2} - \\frac{a}{2h}\\right) \\exp(i\\theta) - \\frac{2\\nu}{h^2} + \\left(\\frac{\\nu}{h^2} + \\frac{a}{2h}\\right) \\exp(-i\\theta) \\right]\n$$\nThis shows that $(A \\phi(\\theta))_j = \\lambda(\\theta) \\phi_j(\\theta)$, which confirms that $\\phi(\\theta)$ is an eigenvector of $A$. The corresponding eigenvalue $\\lambda(\\theta)$ is the expression in the brackets:\n$$\n\\lambda(\\theta) = \\frac{\\nu}{h^2} (\\exp(i\\theta) - 2 + \\exp(-i\\theta)) - \\frac{a}{2h} (\\exp(i\\theta) - \\exp(-i\\theta))\n$$\nUsing Euler's identities, $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$ and $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$, we can simplify $\\lambda(\\theta)$:\n$$\n\\lambda(\\theta) = \\frac{\\nu}{h^2} (2\\cos(\\theta) - 2) - \\frac{a}{2h} (2i\\sin(\\theta))\n$$\n$$\n\\lambda(\\theta) = \\frac{2\\nu}{h^2}(\\cos(\\theta) - 1) - i\\frac{a}{h}\\sin(\\theta)\n$$\nThis expression separates the eigenvalue into its real and imaginary parts.\nThe real part of the eigenvalue arises from the diffusion term:\n$$\n\\text{Re}(\\lambda(\\theta)) = \\frac{2\\nu}{h^2}(\\cos(\\theta) - 1)\n$$\nSince $\\nu  0$ and $\\cos(\\theta) - 1 \\le 0$, the real part is always non-positive, reflecting the dissipative nature of the diffusion operator.\n\nThe imaginary part of the eigenvalue arises from the advection term:\n$$\n\\text{Im}(\\lambda(\\theta)) = -\\frac{a}{h}\\sin(\\theta)\n$$\nThis is characteristic of the dispersive nature of the centered difference approximation to the advection operator.\n\n### Part 3: Maximum Stable Timestep\n\nThe classical fourth-order Runge-Kutta (RK4) method, when applied to the scalar test equation $y'=\\lambda y$, has an amplification factor given by the Taylor series expansion of the exponential function truncated to the fourth order:\n$$\nR(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}\n$$\nwhere $z = \\Delta t \\lambda$. For numerical stability, the magnitude of the amplification factor must be no greater than $1$ for all eigenvalues of the system. This gives the condition:\n$$\n\\max_{\\theta \\in [-\\pi,\\pi]} |R(\\Delta t \\lambda(\\theta))| \\le 1\n$$\nThis means that for all $\\theta$, the complex number $z(\\theta) = \\Delta t \\lambda(\\theta)$ must lie within the stability region of the RK4 method. The stability region is the set $S = \\{z \\in \\mathbb{C} : |R(z)| \\le 1\\}$.\n\nThe locus of eigenvalues $\\lambda(\\theta)$ for $\\theta \\in [-\\pi, \\pi]$ forms an ellipse in the complex plane, centered at $(-\\frac{2\\nu}{h^2}, 0)$, with semi-axes $\\frac{2\\nu}{h^2}$ (real) and $\\frac{a}{h}$ (imaginary). The locus of $z(\\theta)$ is a scaled version of this ellipse.\n\nThe stability region of the RK4 method intersects the negative real axis at approximately $[-2.785, 0]$ and the imaginary axis at approximately $[-2.828i, 2.828i]$ (more precisely, $[-2\\sqrt{2}i, 2\\sqrt{2}i]$). The stability region is \"pinched\" near the origin along the negative real axis. The eigenvalue ellipse $\\lambda(\\theta)$ is always tangent to the origin at $\\theta=0$. As $\\Delta t$ increases, the scaled ellipse $z(\\theta)$ expands. The first point of this ellipse to exit the stability region will be its leftmost point, which lies on the negative real axis. This point corresponds to the Fourier mode $\\theta = \\pi$.\n\nAt $\\theta = \\pi$, the eigenvalue is purely real:\n$$\n\\lambda(\\pi) = \\frac{2\\nu}{h^2}(\\cos(\\pi) - 1) - i\\frac{a}{h}\\sin(\\pi) = \\frac{2\\nu}{h^2}(-1 - 1) - 0 = -\\frac{4\\nu}{h^2}\n$$\nThis is the eigenvalue with the largest magnitude. The stability condition for this mode is:\n$$\n|\\Delta t \\lambda(\\pi)| \\le S_R\n$$\nwhere $S_R \\approx 2.78529$ is the length of the stability interval of RK4 on the negative real axis. This value is the positive root of $|R(-x)|=1$, specifically $R(-x) = -1$.\n$$\n\\Delta t \\frac{4\\nu}{h^2} \\le S_R\n$$\nThe maximum stable timestep is therefore:\n$$\n\\Delta t_{\\max} = \\frac{S_R h^2}{4\\nu}\n$$\nNow, we substitute the given numerical parameters:\n$L = 1$, $N = 128$, so the grid spacing is $h = L/N = 1/128$.\n$\\nu = 10^{-3}$.\n$S_R \\approx 2.78529$.\n$$\n\\Delta t_{\\max} = \\frac{2.78529 \\times (1/128)^2}{4 \\times 10^{-3}} = \\frac{2.78529}{16384 \\times 4 \\times 10^{-3}} = \\frac{2.78529}{65.536}\n$$\n$$\n\\Delta t_{\\max} \\approx 0.04250333...\n$$\nRounding to four significant figures, we get $\\Delta t_{\\max} = 0.04250$.", "answer": "$$\n\\boxed{0.04250}\n$$", "id": "3359928"}, {"introduction": "High-order accuracy and linear stability are not the only metrics for a good time integrator in Computational Fluid Dynamics (CFD); qualitative properties are often just as important. This hands-on coding practice demonstrates a crucial limitation of classical high-order methods: the failure to preserve solution bounds, which can lead to non-physical oscillations [@problem_id:3359952]. By comparing the celebrated fourth-order Runge-Kutta method against a Strong Stability Preserving (SSP) scheme, you will see firsthand why specialized integrators are essential for problems where maintaining physical constraints like positivity is paramount.", "problem": "Consider the scalar linear parabolic conservation law often used in computational fluid dynamics to model diffusion, given by the partial differential equation $u_t = \\kappa u_{xx}$, where $u(t,x)$ is a scalar field, $t$ is time in seconds, $x$ is space in meters, and $\\kappa$ is the diffusivity in $\\mathrm{m}^2/\\mathrm{s}$. A standard semi-discretization in space on a uniform grid with spacing $\\Delta x$ and Dirichlet boundary conditions uses the second-order central difference approximation of the Laplacian. Let $u_i(t)$ denote the approximation of $u(t,x)$ at grid point $x_i$, and define the semi-discrete operator $L(u)$ component-wise by\n$$\nL(u)_i = \\frac{\\kappa}{\\Delta x^2}\\left(u_{i-1} - 2 u_i + u_{i+1}\\right)\n$$\nfor all interior indices $i$, with boundary indices held fixed to $u_0(t)=0$ and $u_{N-1}(t)=0$ for all time (Dirichlet boundary conditions at the domain endpoints). The explicit Forward Euler method $u^{n+1} = u^n + \\Delta t\\, L(u^n)$ is known to be monotone in the sense of preserving the minimum and maximum bounds of $u$ for sufficiently small time step $\\Delta t$, specifically when the nondimensional parameter $\\mu = \\kappa \\Delta t / \\Delta x^2$ satisfies $\\mu \\leq 1/2$. In contrast, high-order Runge–Kutta methods that are not Strong Stability Preserving (SSP), such as the classical fourth-order Runge–Kutta method, can fail to preserve such bounds even when the spatial discretization is monotone and $\\Delta t$ lies within the Forward Euler monotonicity limit.\n\nYour task is to construct an explicit counterexample that demonstrates the failure of bound preservation when using a non-SSP Runge–Kutta time integrator on a monotone spatial discretization. Use the semi-discrete diffusion operator $L(u)$ above, and implement three time integrators for a single time step of size $\\Delta t$: Forward Euler, classical fourth-order Runge–Kutta, and the third-order SSP Runge–Kutta (Shu–Osher form). Start from an initial condition that is nonnegative and bounded by $1$, given by a unit spike at the center of the grid:\n$$\nu_i^0 = \\begin{cases}\n1  \\text{if } i = \\lfloor (N-1)/2 \\rfloor, \\\\\n0  \\text{otherwise.}\n\\end{cases}\n$$\nThe domain endpoints satisfy Dirichlet boundary conditions $u_0^n = 0$ and $u_{N-1}^n = 0$ for all $n$.\n\nYou must produce a program that, for each specified test case, performs exactly one time step using the indicated integrator and then checks whether any component of the updated solution $u^{1}$ lies outside the convex hull of the initial data $[ \\min_i u^0_i, \\max_i u^0_i ] = [0,1]$. That is, detect whether there exists any index $i$ such that $u^{1}_i  0$ or $u^{1}_i  1$. If such a violation occurs, this indicates that a “new extremum” has been generated by the time integrator coupled with the spatial discretization, and the boolean answer for that test case should be $true$. Otherwise, the boolean answer should be $false$.\n\nUse the following test suite, which varies method and time step to illustrate the phenomenon:\n\n- Test case $1$: Forward Euler, $N = 51$, $\\Delta x = 1\\,\\mathrm{m}$, $\\kappa = 1\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t = 0.5\\,\\mathrm{s}$ (so $\\mu = 0.5$). Report whether a new extremum is generated.\n- Test case $2$: Classical fourth-order Runge–Kutta (non-SSP), $N = 51$, $\\Delta x = 1\\,\\mathrm{m}$, $\\kappa = 1\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t = 0.5\\,\\mathrm{s}$ (so $\\mu = 0.5$). Report whether a new extremum is generated.\n- Test case $3$: Third-order Strong Stability Preserving Runge–Kutta (Shu–Osher form), $N = 51$, $\\Delta x = 1\\,\\mathrm{m}$, $\\kappa = 1\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t = 0.5\\,\\mathrm{s}$ (so $\\mu = 0.5$). Report whether a new extremum is generated.\n- Test case $4$: Classical fourth-order Runge–Kutta (non-SSP), $N = 51$, $\\Delta x = 1\\,\\mathrm{m}$, $\\kappa = 1\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t = 0.05\\,\\mathrm{s}$ (so $\\mu = 0.05$). Report whether a new extremum is generated.\n\nAll angles, if any appear, must be expressed in radians. All physical quantities must be treated with the specified units. Your program should produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets, for example, $[true,false,true,false]$.\n\nThe underlying foundational basis to be used in reasoning is as follows:\n\n- The semi-discrete central difference Laplacian is an $M$-matrix spatial discretization that is monotone under Forward Euler when $\\mu \\leq 1/2$.\n- The classical fourth-order Runge–Kutta method is not Strong Stability Preserving, meaning it does not admit a nonzero coefficient $C$ such that it can be represented as a convex combination of Forward Euler steps, and therefore bound-preserving properties of Forward Euler need not be inherited by this method.\n- The third-order Strong Stability Preserving Runge–Kutta method is designed to preserve monotonicity properties under the same Forward Euler time step restriction.\n\nYour implementation must follow these principles to construct the counterexample and return the booleans for the test suite in the exact output format described.", "solution": "The problem requires the construction of a numerical counterexample to demonstrate that a non-Strong Stability Preserving (SSP) time integration method, specifically the classical fourth-order Runge–Kutta (RK4) method, can fail to preserve the bounds of a solution (i.e., generate new extrema) even when coupled with a monotone spatial discretization and using a time step that is within the monotonicity limit of the simpler Forward Euler method. We will compare this behavior to the Forward Euler method itself and to a third-order SSP Runge–Kutta method, which are expected to preserve the solution bounds under the given conditions.\n\nThe governing partial differential equation is the scalar linear diffusion equation:\n$$\nu_t = \\kappa u_{xx}\n$$\nwhere $u(t,x)$ is the scalar field, $t$ is time, $x$ is the spatial coordinate, and $\\kappa$ is the diffusivity.\n\nThe spatial domain is discretized on a uniform grid with $N$ points and grid spacing $\\Delta x$. The semi-discrete form of the equation is $\\frac{du}{dt} = L(u)$, where $u(t)$ is a vector representing the solution at the grid points $u_i(t)$, and $L$ is the spatial operator. The problem specifies a second-order central difference approximation for the Laplacian, which defines the operator $L(u)$ for interior grid points $i=1, \\dots, N-2$:\n$$\nL(u)_i = \\frac{\\kappa}{\\Delta x^2}\\left(u_{i-1} - 2 u_i + u_{i+1}\\right)\n$$\nThe boundary conditions are of Dirichlet type, with $u_0(t) = 0$ and $u_{N-1}(t) = 0$ for all time.\n\nThe initial condition is a unit spike at the center of the grid, which for a grid with $N$ points is at index $i_c = \\lfloor (N-1)/2 \\rfloor$:\n$$\nu_i^0 = \\begin{cases}\n1  \\text{if } i = i_c, \\\\\n0  \\text{otherwise.}\n\\end{cases}\n$$\nThis initial condition is non-negative and its values are bounded within the convex hull $[0, 1]$. A method is said to be bound-preserving if the solution after one time step, $u^1$, remains within this convex hull, i.e., $0 \\leq u_i^1 \\leq 1$ for all $i$.\n\nWe will implement and test three explicit time integration schemes for taking a single time step of size $\\Delta t$:\n\n1.  **Forward Euler (FE)**: This is the simplest explicit method, given by:\n    $$\n    u^{n+1} = u^n + \\Delta t L(u^n)\n    $$\n    For the given spatial discretization, this method is known to be monotone, and therefore bound-preserving, if the time step $\\Delta t$ satisfies the condition $\\mu = \\frac{\\kappa \\Delta t}{\\Delta x^2} \\leq \\frac{1}{2}$.\n\n2.  **Classical Fourth-Order Runge–Kutta (RK4)**: This is a high-order method defined by the following stages:\n    $$\n    \\begin{aligned}\n    k_1 = L(u^n) \\\\\n    k_2 = L(u^n + \\frac{\\Delta t}{2} k_1) \\\\\n    k_3 = L(u^n + \\frac{\\Delta t}{2} k_2) \\\\\n    k_4 = L(u^n + \\Delta t k_3) \\\\\n    u^{n+1} = u^n + \\frac{\\Delta t}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n    \\end{aligned}\n    $$\n    This method is not Strong Stability Preserving. It cannot be written as a convex combination of Forward Euler steps. As a result, even if the Forward Euler step is bound-preserving (i.e., $\\mu \\leq 1/2$), the RK4 method is not guaranteed to be, and can produce new extrema (undershoots or overshoots).\n\n3.  **Third-Order Strong Stability Preserving Runge–Kutta (SSP-RK3)**: This method is specifically designed to preserve monotonicity properties. The Shu–Osher form is given by:\n    $$\n    \\begin{aligned}\n    u^{(1)} = u^n + \\Delta t L(u^n) \\\\\n    u^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4} \\left(u^{(1)} + \\Delta t L(u^{(1)})\\right) \\\\\n    u^{n+1} = \\frac{1}{3} u^n + \\frac{2}{3} \\left(u^{(2)} + \\Delta t L(u^{(2)})\\right)\n    \\end{aligned}\n    $$\n    Each stage of this method is a convex combination of previous stages and a Forward Euler step. This structure ensures that if the Forward Euler step is bound-preserving under a given time step restriction, the entire SSP-RK3 method is also bound-preserving under the same restriction.\n\nThe implementation will proceed by defining the spatial operator $L$ as a function that operates on a NumPy array representing the solution vector $u$. For each test case, we will initialize the solution vector $u^0$, apply one step of the specified integrator to obtain $u^1$, and then check if any component of $u^1$ lies outside the initial range $[0, 1]$.\n\n**Analysis of Test Cases**:\n- **Test case 1**: Forward Euler with $\\mu = 0.5$. This is at the limit of the monotonicity condition. The method should be bound-preserving. We expect the result to be `false`.\n- **Test case 2**: Classical RK4 with $\\mu = 0.5$. Although $\\Delta t$ satisfies the FE monotonicity condition, the RK4 method is not SSP. We expect it to fail to preserve bounds, generating a negative undershoot near the initial spike. The result should be `true`. This is the central demonstration.\n- **Test case 3**: SSP-RK3 with $\\mu = 0.5$. Since the method is SSP and $\\Delta t$ satisfies the FE condition, it will inherit the bound-preserving property. We expect the result to be `false`.\n- **Test case 4**: Classical RK4 with a much smaller time step, $\\mu = 0.05$. For sufficiently small time steps, the non-SSP effects of RK4 become negligible, as the method better approximates the true solution. At this small $\\mu$, it is not expected to generate new extrema. The result should be `false`.\n\nThe program will execute these four tests and report a boolean value for each, indicating whether a new extremum was generated.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs a counterexample for non-SSP Runge-Kutta methods.\n    \"\"\"\n\n    def L_operator(u, kappa_div_dx2):\n        \"\"\"\n        Applies the semi-discrete spatial operator L(u) for the diffusion equation.\n        L(u)_i = (kappa/dx^2) * (u_{i-1} - 2u_i + u_{i+1})\n        Dirichlet boundary conditions u_0=0, u_{N-1}=0 are handled by keeping\n        the first and last elements of the output vector as 0.\n        \"\"\"\n        N = u.shape[0]\n        Lu = np.zeros(N)\n        \n        # Vectorized calculation for interior points\n        u_left = u[:-2]   # u[0]...u[N-3]\n        u_mid = u[1:-1]  # u[1]...u[N-2]\n        u_right = u[2:]    # u[2]...u[N-1]\n        \n        Lu[1:-1] = kappa_div_dx2 * (u_left - 2 * u_mid + u_right)\n        \n        return Lu\n\n    def run_simulation(method, N, dx, kappa, dt):\n        \"\"\"\n        Runs a single time step for a given method and parameters.\n        Returns True if a new extremum is generated, False otherwise.\n        \"\"\"\n        # Initial condition: unit spike at the center\n        u0 = np.zeros(N)\n        center_idx = (N - 1) // 2\n        u0[center_idx] = 1.0\n\n        kappa_div_dx2 = kappa / (dx**2)\n\n        # Apply one time step of the selected integrator\n        if method == 'FE':\n            # Forward Euler\n            u1 = u0 + dt * L_operator(u0, kappa_div_dx2)\n        \n        elif method == 'RK4':\n            # Classical Fourth-Order Runge-Kutta\n            k1 = L_operator(u0, kappa_div_dx2)\n            k2 = L_operator(u0 + 0.5 * dt * k1, kappa_div_dx2)\n            k3 = L_operator(u0 + 0.5 * dt * k2, kappa_div_dx2)\n            k4 = L_operator(u0 + dt * k3, kappa_div_dx2)\n            u1 = u0 + (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n\n        elif method == 'SSP3':\n            # Third-Order SSP Runge-Kutta (Shu-Osher)\n            u_stage1 = u0 + dt * L_operator(u0, kappa_div_dx2)\n            u_stage2 = 0.75 * u0 + 0.25 * (u_stage1 + dt * L_operator(u_stage1, kappa_div_dx2))\n            u1 = (1.0 / 3.0) * u0 + (2.0 / 3.0) * (u_stage2 + dt * L_operator(u_stage2, kappa_div_dx2))\n        \n        else:\n            raise ValueError(\"Unknown method specified\")\n\n        # Check if the solution is outside the initial bounds [0, 1]\n        # The convex hull of the initial data is [min(u0), max(u0)] = [0, 1]\n        min_u1 = np.min(u1)\n        max_u1 = np.max(u1)\n        \n        # Per problem, check for strict violation. Floating point tolerance is not\n        # necessary here as the expected violation for RK4 is significant.\n        is_violated = (min_u1  0.0) or (max_u1 > 1.0)\n        \n        return is_violated\n\n    # Define the test cases from the problem statement.\n    # (method, N, dx, kappa, dt)\n    test_cases = [\n        ('FE', 51, 1.0, 1.0, 0.5),    # Case 1: FE, mu=0.5\n        ('RK4', 51, 1.0, 1.0, 0.5),   # Case 2: RK4, mu=0.5\n        ('SSP3', 51, 1.0, 1.0, 0.5),  # Case 3: SSP3, mu=0.5\n        ('RK4', 51, 1.0, 1.0, 0.05),  # Case 4: RK4, mu=0.05\n    ]\n\n    results = []\n    for case in test_cases:\n        method, N, dx, kappa, dt = case\n        result = run_simulation(method, N, dx, kappa, dt)\n        results.append(str(result).lower()) # Convert boolean to lowercase string\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3359952"}]}