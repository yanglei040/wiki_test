{"hands_on_practices": [{"introduction": "Mastering the Courant–Friedrichs–Lewy (CFL) condition begins with its derivation in the simplest, most fundamental context. This exercise guides you through a first-principles derivation for the 1D linear advection equation using Fourier (von Neumann) stability analysis. By analyzing how different wave components are amplified by the numerical scheme, you will establish the canonical stability limit $C \\le 1$ for the first-order upwind method, providing a solid foundation for all subsequent analysis [@problem_id:3372287].", "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) $\\partial_t u + a\\,\\partial_x u = 0$ with constant wave speed $a  0$ discretized on a uniform spatial grid with spacing $\\Delta x$ and advanced in time with step $\\Delta t$ by the explicit first-order upwind scheme for $a0$. Using Fourier (von Neumann) stability analysis from first principles, derive the modulus of the amplification factor for a Fourier mode and from it deduce the admissible range of the nondimensional Courant–Friedrichs–Lewy (CFL) number (defined as $C = a\\,\\Delta t/\\Delta x$) that ensures $\\ell^2$-stability of this scheme. Then, for $a = 2$ m/s, $\\Delta x = 0.01$ m, and a target Courant number $C_{\\mathrm{target}} = 0.8$, choose a time step $\\Delta t_{\\mathrm{adopt}}$ that both achieves the target Courant number when admissible and otherwise equals the maximum admissible time step imposed by your stability criterion. Compute the value of $\\Delta t_{\\mathrm{adopt}}$ and express your final result in seconds, rounded to four significant figures.", "solution": "The problem statement is evaluated as valid, being scientifically grounded, well-posed, objective, and self-contained. We shall proceed with the solution.\n\nThe one-dimensional linear advection partial differential equation is given by:\n$$\n\\partial_t u + a\\,\\partial_x u = 0\n$$\nwhere the wave speed $a$ is a positive constant ($a  0$).\n\nWe discretize this equation on a uniform grid where $x_j = j\\Delta x$ and $t_n = n\\Delta t$. Let $u_j^n$ denote the numerical approximation of the solution $u(x_j, t_n)$. The explicit first-order upwind scheme is constructed by using a forward difference in time and a backward difference in space, which is the \"upwind\" direction for $a0$:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nTo perform the Fourier (von Neumann) stability analysis, we consider a single Fourier mode as a solution to the finite difference equation:\n$$\nu_j^n = \\hat{u}^n(k) e^{i k x_j} = \\hat{u}^n(k) e^{i k j \\Delta x}\n$$\nHere, $k$ is the wavenumber and $i = \\sqrt{-1}$. The solution at the next time step is related to the current one through an amplification factor $G(k)$, such that $\\hat{u}^{n+1}(k) = G(k) \\hat{u}^n(k)$. Therefore, $u_j^{n+1} = G(k) u_j^n$.\n\nSubstituting the Fourier mode into the discretized equation:\n$$\n\\frac{G(k) \\hat{u}^n(k) e^{i k j \\Delta x} - \\hat{u}^n(k) e^{i k j \\Delta x}}{\\Delta t} + a \\frac{\\hat{u}^n(k) e^{i k j \\Delta x} - \\hat{u}^n(k) e^{i k (j-1) \\Delta x}}{\\Delta x} = 0\n$$\nThe term $\\hat{u}^n(k) e^{i k j \\Delta x}$ is a common factor and can be divided out, as it is non-zero:\n$$\n\\frac{G(k) - 1}{\\Delta t} + a \\frac{1 - e^{-i k \\Delta x}}{\\Delta x} = 0\n$$\nSolving for the amplification factor $G(k)$:\n$$\nG(k) - 1 = - \\frac{a \\Delta t}{\\Delta x} (1 - e^{-i k \\Delta x})\n$$\nWe introduce the nondimensional Courant–Friedrichs–Lewy (CFL) number, $C = \\frac{a \\Delta t}{\\Delta x}$.\n$$\nG(k) = 1 - C (1 - e^{-i k \\Delta x})\n$$\nFor $\\ell^2$-stability, the modulus of the amplification factor must be less than or equal to one for all wavenumbers $k$: $|G(k)| \\le 1$. Let us define the nondimensional wavenumber $\\theta = k \\Delta x$. Then,\n$$\nG(\\theta) = 1 - C (1 - e^{-i \\theta}) = 1 - C (1 - (\\cos\\theta - i\\sin\\theta)) = (1 - C(1 - \\cos\\theta)) + i C\\sin\\theta\n$$\nThe modulus squared, $|G(\\theta)|^2$, is the sum of the squares of the real and imaginary parts:\n$$\n|G(\\theta)|^2 = (1 - C(1 - \\cos\\theta))^2 + (C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1 - \\cos\\theta) + C^2(1 - \\cos\\theta)^2 + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1 - \\cos\\theta) + C^2(1 - 2\\cos\\theta + \\cos^2\\theta + \\sin^2\\theta)\n$$\nUsing the identity $\\cos^2\\theta + \\sin^2\\theta = 1$:\n$$\n|G(\\theta)|^2 = 1 - 2C(1 - \\cos\\theta) + C^2(1 - 2\\cos\\theta + 1) = 1 - 2C(1 - \\cos\\theta) + C^2(2 - 2\\cos\\theta)\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1 - \\cos\\theta) + 2C^2(1 - \\cos\\theta)\n$$\n$$\n|G(\\theta)|^2 = 1 + (2C^2 - 2C)(1 - \\cos\\theta) = 1 + 2C(C - 1)(1 - \\cos\\theta)\n$$\nThe stability condition is $|G(\\theta)|^2 \\le 1$:\n$$\n1 + 2C(C - 1)(1 - \\cos\\theta) \\le 1\n$$\n$$\n2C(C - 1)(1 - \\cos\\theta) \\le 0\n$$\nThe parameters $a$, $\\Delta t$, and $\\Delta x$ are all positive, so the CFL number $C$ is positive. The term $(1 - \\cos\\theta)$ is always non-negative, as $-1 \\le \\cos\\theta \\le 1$. For the inequality to hold for all possible values of $\\theta$, the term $2C(C-1)$ must be non-positive. Since $C0$, this requires:\n$$\nC - 1 \\le 0 \\implies C \\le 1\n$$\nCombining with the physical constraint $C \\ge 0$, the admissible range for the CFL number that ensures stability is:\n$$\n0 \\le C \\le 1\n$$\nNow, we apply this result to the specific case provided. The given parameters are:\n$a = 2$ m/s\n$\\Delta x = 0.01$ m\n$C_{\\mathrm{target}} = 0.8$\n\nThe derived stability criterion is $0 \\le C \\le 1$. The target Courant number $C_{\\mathrm{target}} = 0.8$ lies within this admissible range. According to the problem statement, we should choose a time step $\\Delta t_{\\mathrm{adopt}}$ that achieves this target Courant number.\n\nThe definition of the Courant number is $C = \\frac{a \\Delta t}{\\Delta x}$. We set $C = C_{\\mathrm{target}}$ and solve for $\\Delta t = \\Delta t_{\\mathrm{adopt}}$:\n$$\nC_{\\mathrm{target}} = \\frac{a \\Delta t_{\\mathrm{adopt}}}{\\Delta x}\n$$\n$$\n\\Delta t_{\\mathrm{adopt}} = \\frac{C_{\\mathrm{target}} \\Delta x}{a}\n$$\nSubstituting the numerical values:\n$$\n\\Delta t_{\\mathrm{adopt}} = \\frac{(0.8)(0.01\\ \\text{m})}{2\\ \\text{m/s}} = \\frac{0.008}{2}\\ \\text{s} = 0.004\\ \\text{s}\n$$\nThe problem requires the result to be rounded to four significant figures. To express $0.004$ with four significant figures, we write it in scientific notation as $4.000 \\times 10^{-3}$.", "answer": "$$\n\\boxed{4.000 \\times 10^{-3}}\n$$", "id": "3372287"}, {"introduction": "Building on the one-dimensional case, we now explore how the CFL condition generalizes to higher dimensions, a necessary step for tackling realistic fluid dynamics problems. This practice examines the 2D linear advection equation and requires deriving the stability constraint for an unsplit, upwind finite volume method. The analysis reveals how the time step becomes constrained by the combined advection speeds in all spatial directions, leading to the multi-dimensional form of the CFL condition [@problem_id:3372303].", "problem": "Consider the two-dimensional constant-coefficient linear advection equation\n$$\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} + b\\,\\frac{\\partial u}{\\partial y} = 0,$$\nposed on a uniform Cartesian grid with spacings $\\Delta x$ and $\\Delta y$, and advanced in time with an explicit forward Euler step of size $\\Delta t$. The spatial discretization is the first-order, dimensionally unsplit, upwind finite volume method. Assume the velocity components $a$ and $b$ are constant and known. The Courant–Friedrichs–Lewy (CFL) condition guarantees stability by ensuring that the numerical domain of dependence contains the partial differential equation domain of dependence.\n\nStarting from the discrete conservation update obtained by applying upwind differencing consistent with the signs of $a$ and $b$ on a cell $(i,j)$, derive the condition that guarantees all update coefficients are nonnegative and form a convex combination of neighboring values. Use this to obtain the maximal stable time step $\\Delta t$ in terms of $a$, $b$, $\\Delta x$, and $\\Delta y$ for the unsplit upwind method.\n\nThen, for the specific values $a=1$ m/s, $b=-0.5$ m/s, $\\Delta x=0.01$ m, and $\\Delta y=0.005$ m, compute the maximal stable $\\Delta t$. Round your final numerical answer to $3$ significant figures and express $\\Delta t$ in seconds.", "solution": "The problem is to derive the stability condition for a first-order upwind, dimensionally unsplit finite volume method applied to the two-dimensional linear advection equation, and then to calculate the maximal stable time step for a given set of parameters.\n\n### Step 1: Extract Givens\n- **PDE**: $\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} + b\\,\\frac{\\partial u}{\\partial y} = 0$\n- **Grid**: Uniform Cartesian grid with spacings $\\Delta x$ and $\\Delta y$.\n- **Time Discretization**: Explicit forward Euler with step size $\\Delta t$.\n- **Spatial Discretization**: First-order, dimensionally unsplit, upwind finite volume method.\n- **Velocity**: $a$ and $b$ are constant.\n- **Stability Criterion**: The numerical update coefficients must be nonnegative and form a convex combination.\n- **Numerical Values**: $a=1$ m/s, $b=-0.5$ m/s, $\\Delta x=0.01$ m, $\\Delta y=0.005$ m.\n- **Output Requirement**: Compute the maximal stable $\\Delta t$ and round to $3$ significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in the numerical analysis of partial differential equations, specifically within computational fluidynamics. It is:\n- **Scientifically Grounded**: The problem deals with the well-established Courant-Friedrichs-Lewy (CFL) condition for a hyperbolic PDE, which is a fundamental concept in numerical methods.\n- **Well-Posed**: It asks for the derivation of a stability condition and a subsequent calculation, which has a unique, well-defined answer.\n- **Objective**: The problem is stated using precise mathematical and computational terminology.\n- **Self-Contained and Consistent**: All necessary information is provided.\n\nThe problem is valid.\n\n### Step 3: Formal Derivation\nThe given PDE can be written in conservative form as:\n$$ \\frac{\\partial u}{\\partial t} + \\frac{\\partial F}{\\partial x} + \\frac{\\partial G}{\\partial y} = 0 $$\nwhere the fluxes are $F = au$ and $G = bu$, since $a$ and $b$ are constants.\n\nWe apply the finite volume method by integrating this equation over a control volume (cell) $V_{i,j}$ centered at $(x_i, y_j)$ with dimensions $\\Delta x \\times \\Delta y$. Let $u_{i,j}(t)$ be the cell-averaged value of $u$ in cell $(i,j)$ at time $t$. The semi-discrete form of the conservation law is:\n$$ \\frac{du_{i,j}}{dt} + \\frac{F_{i+1/2,j} - F_{i-1/2,j}}{\\Delta x} + \\frac{G_{i,j+1/2} - G_{i,j-1/2}}{\\Delta y} = 0 $$\nHere, $F_{i+1/2,j}$ and $G_{i,j+1/2}$ are the numerical fluxes at the cell interfaces.\n\nFor a first-order upwind scheme, the flux at an interface is determined by the value in the \"upwind\" cell. The direction of the wind is given by the sign of the advection velocities $a$ and $b$.\nThe numerical flux functions are:\n$$ F_{i+1/2,j} = \\begin{cases} a u_{i,j}  \\text{if } a  0 \\\\ a u_{i+1,j}  \\text{if } a  0 \\end{cases} $$\n$$ G_{i,j+1/2} = \\begin{cases} b u_{i,j}  \\text{if } b  0 \\\\ b u_{i,j+1}  \\text{if } b  0 \\end{cases} $$\nWe can express this more generally using the definitions $v^+ = \\frac{1}{2}(v+|v|) = \\max(v,0)$ and $v^- = \\frac{1}{2}(v-|v|) = \\min(v,0)$. Note that $v = v^+ + v^-$.\nThe numerical flux $F_{i+1/2,j}$ is given by:\n$$ F_{i+1/2,j} = a^+ u_{i,j} + a^- u_{i+1,j} $$\nSimilarly, the flux $G_{i,j+1/2}$ is:\n$$ G_{i,j+1/2} = b^+ u_{i,j} + b^- u_{i,j+1} $$\nThe flux differences across cell $(i,j)$ are:\n$$ F_{i+1/2,j} - F_{i-1/2,j} = (a^+ u_{i,j} + a^- u_{i+1,j}) - (a^+ u_{i-1,j} + a^- u_{i,j}) = a^+(u_{i,j} - u_{i-1,j}) + a^-(u_{i+1,j} - u_{i,j}) $$\n$$ G_{i,j+1/2} - G_{i,j-1/2} = (b^+ u_{i,j} + b^- u_{i,j+1}) - (b^+ u_{i,j-1} + b^- u_{i,j}) = b^+(u_{i,j} - u_{i,j-1}) + b^-(u_{i,j+1} - u_{i,j}) $$\nSubstituting these into the semi-discrete equation:\n$$ \\frac{du_{i,j}}{dt} = -\\frac{1}{\\Delta x} \\left[ a^+(u_{i,j} - u_{i-1,j}) + a^-(u_{i+1,j} - u_{i,j}) \\right] - \\frac{1}{\\Delta y} \\left[ b^+(u_{i,j} - u_{i,j-1}) + b^-(u_{i,j+1} - u_{i,j}) \\right] $$\nNow, we apply the explicit forward Euler time-stepping scheme: $\\frac{u_{i,j}^{n+1} - u_{i,j}^n}{\\Delta t} = \\left(\\frac{du_{i,j}}{dt}\\right)^n$. Let $u_{i,j}^n$ denote the value at time $t_n$.\n$$ u_{i,j}^{n+1} = u_{i,j}^n - \\frac{\\Delta t}{\\Delta x} \\left[ a^+(u_{i,j}^n - u_{i-1,j}^n) + a^-(u_{i+1,j}^n - u_{i,j}^n) \\right] - \\frac{\\Delta t}{\\Delta y} \\left[ b^+(u_{i,j}^n - u_{i,j-1}^n) + b^-(u_{i,j+1}^n - u_{i,j}^n) \\right] $$\nWe rearrange the terms to express $u_{i,j}^{n+1}$ as a linear combination of values at time $n$:\n$$ u_{i,j}^{n+1} = u_{i,j}^n - \\frac{\\Delta t}{\\Delta x}(a^+ - a^-)u_{i,j}^n - \\frac{\\Delta t}{\\Delta y}(b^+ - b^-)u_{i,j}^n + \\frac{\\Delta t}{\\Delta x} a^+ u_{i-1,j}^n - \\frac{\\Delta t}{\\Delta x} a^- u_{i+1,j}^n + \\frac{\\Delta t}{\\Delta y} b^+ u_{i,j-1}^n - \\frac{\\Delta t}{\\Delta y} b^- u_{i,j+1}^n $$\nUsing the identities $|v| = v^+ - v^-$, $v^+ \\ge 0$, and $v^- \\le 0$:\n$$ u_{i,j}^{n+1} = \\left(1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y}\\right) u_{i,j}^n + \\left(\\frac{a^+\\Delta t}{\\Delta x}\\right) u_{i-1,j}^n + \\left(\\frac{-a^-\\Delta t}{\\Delta x}\\right) u_{i+1,j}^n + \\left(\\frac{b^+\\Delta t}{\\Delta y}\\right) u_{i,j-1}^n + \\left(\\frac{-b^-\\Delta t}{\\Delta y}\\right) u_{i,j+1}^n $$\nThis is the full update equation. For the update to be a convex combination, all coefficients of the values $u^n$ must be non-negative and sum to $1$.\nLet's examine the coefficients:\n- Coefficient of $u_{i-1,j}^n$: $\\frac{a^+\\Delta t}{\\Delta x}$. Since $a^+ \\ge 0$, $\\Delta t  0$, and $\\Delta x  0$, this coefficient is non-negative.\n- Coefficient of $u_{i+1,j}^n$: $\\frac{-a^-\\Delta t}{\\Delta x}$. Since $a^- \\le 0$, this coefficient is non-negative.\n- Coefficient of $u_{i,j-1}^n$: $\\frac{b^+\\Delta t}{\\Delta y}$. Since $b^+ \\ge 0$, this coefficient is non-negative.\n- Coefficient of $u_{i,j+1}^n$: $\\frac{-b^-\\Delta t}{\\Delta y}$. Since $b^- \\le 0$, this coefficient is non-negative.\n- Coefficient of $u_{i,j}^n$: $1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y}$. For this to be non-negative, we must have:\n$$ 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\ge 0 $$\nThis leads to the stability condition:\n$$ \\frac{|a|\\Delta t}{\\Delta x} + \\frac{|b|\\Delta t}{\\Delta y} \\le 1 $$\nLet's verify that the sum of coefficients is $1$. The sum is:\n$$ \\left(1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y}\\right) + \\frac{a^+\\Delta t}{\\Delta x} - \\frac{a^-\\Delta t}{\\Delta x} + \\frac{b^+\\Delta t}{\\Delta y} - \\frac{b^-\\Delta t}{\\Delta y} $$\n$$ = 1 - \\left(\\frac{|a| - (a^+ - a^-)}{\\Delta x}\\right)\\Delta t - \\left(\\frac{|b| - (b^+ - b^-)}{\\Delta y}\\right)\\Delta t $$\nSince $|v| = v^+ - v^-$ for any $v$, the terms in the parentheses are zero. The sum of coefficients is exactly $1$.\nTherefore, the condition for a convex combination update (and thus, for stability of this scheme) is:\n$$ \\Delta t \\left( \\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y} \\right) \\le 1 $$\nThe maximal stable time step, $\\Delta t_{max}$, is found when the equality holds:\n$$ \\Delta t_{max} = \\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y}} $$\n\n### Step 4: Numerical Calculation\nNow we substitute the given values: $a=1$ m/s, $b=-0.5$ m/s, $\\Delta x=0.01$ m, and $\\Delta y=0.005$ m.\nFirst, we find the absolute values of the velocities:\n$$ |a| = |1| = 1 \\text{ m/s} $$\n$$ |b| = |-0.5| = 0.5 \\text{ m/s} $$\nNext, we compute the terms in the denominator:\n$$ \\frac{|a|}{\\Delta x} = \\frac{1 \\text{ m/s}}{0.01 \\text{ m}} = 100 \\text{ s}^{-1} $$\n$$ \\frac{|b|}{\\Delta y} = \\frac{0.5 \\text{ m/s}}{0.005 \\text{ m}} = 100 \\text{ s}^{-1} $$\nFinally, we compute $\\Delta t_{max}$:\n$$ \\Delta t_{max} = \\frac{1}{100 \\text{ s}^{-1} + 100 \\text{ s}^{-1}} = \\frac{1}{200 \\text{ s}^{-1}} = 0.005 \\text{ s} $$\nThe problem requires the answer to be rounded to $3$ significant figures.\n$$ \\Delta t_{max} = 0.00500 \\text{ s} = 5.00 \\times 10^{-3} \\text{ s} $$", "answer": "$$ \\boxed{5.00 \\times 10^{-3}} $$", "id": "3372303"}, {"introduction": "While Fourier analysis is powerful, its formal application is restricted to periodic domains. This exercise introduces the discrete energy method, a more versatile tool that can rigorously establish stability for problems on finite domains with specified boundary conditions. By proving that the discrete energy of the system does not grow, you will confirm the stability limit for the upwind scheme in a bounded domain, gaining a deeper appreciation for the interplay between the numerical scheme, boundary data, and stability [@problem_id:3372324].", "problem": "Consider the linear advection initial-boundary value problem $u_{t} + a\\,u_{x} = 0$ on the finite interval $x \\in [0,L]$ with constant advection speed $a  0$. Impose homogeneous inflow boundary data $u(0,t) = 0$ and no boundary condition at $x=L$ (outflow). Discretize space with a uniform grid $x_{i} = i\\,\\Delta x$ for $i = 0,1,\\dots,N$, where $N\\,\\Delta x = L$, and discretize time with $t^{n} = n\\,\\Delta t$ for $n \\in \\mathbb{N}$. Consider the fully discrete, first-order upwind finite difference scheme with forward Euler time stepping for the interior points $i = 1,2,\\dots,N$:\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda\\left(u_{i}^{n} - u_{i-1}^{n}\\right),\n$$\nwhere the Courant number (also called the Courant–Friedrichs–Lewy number) is defined by $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$ and the inflow boundary value is enforced as $u_{0}^{n} = 0$ for all $n$. Using a discrete energy method based on the $\\ell^{2}$ norm,\n$$\nE^{n} = \\Delta x \\sum_{i=1}^{N}\\left(u_{i}^{n}\\right)^{2},\n$$\nderive a sufficient stability condition on $\\Delta t$ that is consistent with the interior Courant–Friedrichs–Lewy constraint, by determining the largest value of the nondimensional Courant number $\\lambda$ for which the discrete energy $E^{n}$ is non-increasing for all time steps. Express your final answer as a single dimensionless number, with no units and no rounding required.", "solution": "The user wants me to solve a problem.\nThe user wants me to act as a meticulous and exacting professor in the STEM fields.\nThe user wants me to first validate the problem statement.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   **Partial Differential Equation (PDE)**: $u_{t} + a\\,u_{x} = 0$.\n-   **Spatial Domain**: $x \\in [0,L]$.\n-   **Advection Speed**: $a  0$, constant.\n-   **Boundary Conditions**: Homogeneous inflow data $u(0,t) = 0$, and an outflow boundary at $x=L$.\n-   **Spatial Discretization**: Uniform grid $x_{i} = i\\,\\Delta x$ for $i = 0,1,\\dots,N$, where $N\\,\\Delta x = L$.\n-   **Temporal Discretization**: $t^{n} = n\\,\\Delta t$ for $n \\in \\mathbb{N}$.\n-   **Finite Difference Scheme**: For interior points $i = 1,2,\\dots,N$, $u_{i}^{n+1} = u_{i}^{n} - \\lambda\\left(u_{i}^{n} - u_{i-1}^{n}\\right)$, where this is a first-order upwind scheme with forward Euler time stepping.\n-   **Courant Number**: $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$.\n-   **Discrete Boundary Condition**: $u_{0}^{n} = 0$ for all $n$.\n-   **Discrete Energy**: $E^{n} = \\Delta x \\sum_{i=1}^{N}\\left(u_{i}^{n}\\right)^{2}$.\n-   **Objective**: Derive a sufficient stability condition by finding the largest value of the Courant number $\\lambda$ for which the discrete energy $E^{n}$ is non-increasing, i.e., $E^{n+1} \\le E^{n}$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is a standard, fundamental topic in the numerical analysis of partial differential equations, specifically in computational fluid dynamics. The linear advection equation, the first-order upwind scheme, the Courant number, and the energy method for stability analysis are all well-established, core concepts. The problem is scientifically and mathematically sound.\n-   **Well-Posedness**: The problem is clearly defined. It provides the governing equation, the numerical scheme, the boundary conditions, and the specific method of analysis (discrete energy method). The objective is unambiguous: to find the maximum value of $\\lambda$ that ensures stability in the sense of a non-increasing discrete $\\ell^2$ norm. The problem is self-contained and has a unique, meaningful solution.\n-   **Objectivity**: The language is precise, mathematical, and free of any subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-posed, scientifically grounded problem from the field of numerical analysis. I will proceed to derive the solution.\n\n**Derivation of the Stability Condition**\n\nThe objective is to find the condition on the Courant number $\\lambda$ such that the discrete energy $E^{n}$ is non-increasing for all time steps $n$. This means we must ensure $E^{n+1} \\le E^{n}$.\n\nThe discrete energy at time level $n+1$ is given by\n$$\nE^{n+1} = \\Delta x \\sum_{i=1}^{N}\\left(u_{i}^{n+1}\\right)^{2}\n$$\nThe finite difference scheme is given for $i = 1, 2, \\dots, N$ as\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n$$\nWe analyze the change in energy, $E^{n+1} - E^{n}$.\n$$\nE^{n+1} - E^{n} = \\Delta x \\sum_{i=1}^{N} \\left[ \\left(u_{i}^{n+1}\\right)^{2} - \\left(u_{i}^{n}\\right)^{2} \\right]\n$$\nTo simplify the term inside the summation, we substitute the scheme into $\\left(u_{i}^{n+1}\\right)^{2}$:\n$$\n\\left(u_{i}^{n+1}\\right)^{2} = \\left[ u_{i}^{n} - \\lambda\\left(u_{i}^{n} - u_{i-1}^{n}\\right) \\right]^{2}\n$$\nExpanding the square gives:\n$$\n\\left(u_{i}^{n+1}\\right)^{2} = \\left(u_{i}^{n}\\right)^{2} - 2\\lambda u_{i}^{n}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) + \\lambda^{2}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2}\n$$\nTherefore, the difference $\\left(u_{i}^{n+1}\\right)^{2} - \\left(u_{i}^{n}\\right)^{2}$ is:\n$$\n\\left(u_{i}^{n+1}\\right)^{2} - \\left(u_{i}^{n}\\right)^{2} = -2\\lambda u_{i}^{n}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) + \\lambda^{2}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2}\n$$\nSubstituting this back into the expression for the change in energy:\n$$\nE^{n+1} - E^{n} = \\Delta x \\sum_{i=1}^{N} \\left[ -2\\lambda u_{i}^{n}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) + \\lambda^{2}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2} \\right]\n$$\nThe condition $E^{n+1} \\le E^{n}$ requires the right-hand side to be less than or equal to zero. As $\\Delta x  0$ and $\\lambda = \\frac{a \\Delta t}{\\Delta x}  0$ (since $a0$, $\\Delta t0$, $\\Delta x0$), we must have:\n$$\n\\lambda^{2} \\sum_{i=1}^{N}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2} - 2\\lambda \\sum_{i=1}^{N} u_{i}^{n}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) \\le 0\n$$\nTo proceed, we use the algebraic identity $ab = \\frac{1}{2}a^{2} + \\frac{1}{2}b^{2} - \\frac{1}{2}(a-b)^{2}$. Rearranging, $a(a-b) = \\frac{1}{2}a^2 - \\frac{1}{2}b^2 + \\frac{1}{2}(a-b)^2$. Let $a = u_{i}^{n}$ and $b = u_{i-1}^{n}$. Then:\n$$\nu_{i}^{n}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) = \\frac{1}{2}\\left[\\left(u_{i}^{n}\\right)^{2} - \\left(u_{i-1}^{n}\\right)^{2}\\right] + \\frac{1}{2}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2}\n$$\nWe apply this identity to the second sum in our inequality:\n$$\n\\sum_{i=1}^{N} u_{i}^{n}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) = \\sum_{i=1}^{N} \\left\\{ \\frac{1}{2}\\left[\\left(u_{i}^{n}\\right)^{2} - \\left(u_{i-1}^{n}\\right)^{2}\\right] + \\frac{1}{2}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2} \\right\\}\n$$\nThis can be split into two sums:\n$$\n\\sum_{i=1}^{N} u_{i}^{n}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) = \\frac{1}{2} \\sum_{i=1}^{N} \\left[\\left(u_{i}^{n}\\right)^{2} - \\left(u_{i-1}^{n}\\right)^{2}\\right] + \\frac{1}{2} \\sum_{i=1}^{N} \\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2}\n$$\nThe first sum is a telescoping series:\n$$\n\\sum_{i=1}^{N} \\left[\\left(u_{i}^{n}\\right)^{2} - \\left(u_{i-1}^{n}\\right)^{2}\\right] = \\left(u_{N}^{n}\\right)^{2} - \\left(u_{0}^{n}\\right)^{2}\n$$\nUsing the given boundary condition $u_{0}^{n} = 0$, this becomes $\\left(u_{N}^{n}\\right)^{2}$.\nSubstituting this result back:\n$$\n\\sum_{i=1}^{N} u_{i}^{n}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) = \\frac{1}{2} \\left(u_{N}^{n}\\right)^{2} + \\frac{1}{2} \\sum_{i=1}^{N} \\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2}\n$$\nNow, substitute this expression into our stability inequality:\n$$\n\\lambda^{2} \\sum_{i=1}^{N}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2} - 2\\lambda \\left[ \\frac{1}{2} \\left(u_{N}^{n}\\right)^{2} + \\frac{1}{2} \\sum_{i=1}^{N} \\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2} \\right] \\le 0\n$$\nSimplifying the expression:\n$$\n\\lambda^{2} \\sum_{i=1}^{N}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2} - \\lambda \\left(u_{N}^{n}\\right)^{2} - \\lambda \\sum_{i=1}^{N} \\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2} \\le 0\n$$\nGroup the terms with the sum:\n$$\n\\left(\\lambda^{2} - \\lambda\\right) \\sum_{i=1}^{N}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2} - \\lambda \\left(u_{N}^{n}\\right)^{2} \\le 0\n$$\nSince this inequality must hold for any discrete solution $u^{n}$, we must analyze the signs of each term. Both $\\left(u_{N}^{n}\\right)^{2}$ and $\\sum_{i=1}^{N}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)^{2}$ are non-negative.\nThe term $-\\lambda \\left(u_{N}^{n}\\right)^{2}$ is always non-positive since $\\lambda  0$.\nTo guarantee that the entire expression is non-positive for any choice of $u_i^n$, the coefficient of the sum term, which is also non-negative, must be non-positive.\nThus, we require a sufficient condition:\n$$\n\\lambda^{2} - \\lambda \\le 0\n$$\n$$\n\\lambda(\\lambda - 1) \\le 0\n$$\nSince $\\lambda  0$, we can divide by $\\lambda$ without changing the inequality's direction:\n$$\n\\lambda - 1 \\le 0 \\implies \\lambda \\le 1\n$$\nCombining this with the fact that $\\lambda  0$, the sufficient condition for stability is $0  \\lambda \\le 1$. The problem asks for the largest value of the nondimensional Courant number $\\lambda$ for which the discrete energy is non-increasing. This corresponds to the upper limit of our derived range.\n\nThe largest value is $\\lambda = 1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "3372324"}]}