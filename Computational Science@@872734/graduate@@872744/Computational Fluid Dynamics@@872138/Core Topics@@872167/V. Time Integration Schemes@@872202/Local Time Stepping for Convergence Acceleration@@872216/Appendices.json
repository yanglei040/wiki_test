{"hands_on_practices": [{"introduction": "This first exercise grounds the concept of local time stepping in the fundamental principles of numerical analysis. By analyzing a simple 1D linear advection problem, you will derive the local time step from the CFL stability condition. This practice directly reveals how the pseudo-time marching scheme can be viewed as a weighted-Jacobi iteration, allowing you to analytically determine its convergence rate. [@problem_id:3341489]", "problem": "Consider the one-dimensional linear advection equation with constant advection speed $a>0$,\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\ndiscretized by a finite-volume method on three contiguous control volumes (cells) with lengths $\\Delta x_1$, $\\Delta x_2$, and $\\Delta x_3$. Assume a first-order upwind numerical flux consistent with $a>0$ and an inflow Dirichlet boundary condition at the left boundary. Let $u_i(t)$ denote the cell-average in cell $i$. The semi-discrete residual in cell $i$ is the difference of numerical fluxes at its faces. To drive the solution to steady state, consider explicit forward-Euler pseudo-time marching with cell-local time steps $\\Delta t_i$:\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\frac{\\Delta t_i}{\\Delta x_i}\\, R_i\\!\\left(u^n\\right),\n$$\nwhere $R_i(u)$ is the finite-volume residual and $\\Delta x_i$ is the cell volume in one dimension.\n\nStart from first principles (the finite-volume balance for linear advection with upwind flux for $a>0$) to derive the residual $R_i(u)$, and then use the Courant–Friedrichs–Lewy (CFL) stability criterion with a chosen Courant–Friedrichs–Lewy (CFL) number $C \\in (0,1]$ to determine the local time steps $\\Delta t_i$ in terms of $(\\Delta x_i, a, C)$. Using the corresponding linear error-propagation form of the iteration, model this pseudo-time stepping as a weighted-Jacobi relaxation for the steady-state linear system and estimate the contraction factor $\\rho$ of one pseudo-time iteration in terms of $C$.\n\nExpress the time steps in seconds and the contraction factor as a unitless decimal. Provide your final answer as a single row matrix containing $\\Delta t_1$, $\\Delta t_2$, $\\Delta t_3$, and $\\rho$ in that order. No numerical substitution for $(\\Delta x_i, a, C)$ is required. The final answer must be a single analytical expression.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\nThe givens are:\n- The governing equation: $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$, with constant advection speed $a>0$.\n- The spatial discretization: A finite-volume method on three contiguous cells with lengths $\\Delta x_1$, $\\Delta x_2$, $\\Delta x_3$.\n- The numerical flux: First-order upwind, consistent with $a>0$.\n- The boundary condition: An inflow Dirichlet condition at the left boundary.\n- The temporal discretization (pseudo-time): Explicit forward-Euler with cell-local time steps $\\Delta t_i$.\n- The update formula: $u_i^{n+1} = u_i^n - \\frac{\\Delta t_i}{\\Delta x_i} R_i(u^n)$, where $u_i$ is the cell-average and $R_i(u)$ is the finite-volume residual.\n- The stability criterion: The Courant–Friedrichs–Lewy (CFL) condition is to be used with a number $C \\in (0,1]$.\n\nThe problem is scientifically grounded, being a standard analysis of a numerical method for a fundamental partial differential equation. It is well-posed, with sufficient information to derive the requested quantities. The terminology is precise and objective. Thus, the problem is deemed valid.\n\nThe solution proceeds in three steps: derivation of the residual $R_i$, determination of the local time steps $\\Delta t_i$, and estimation of the contraction factor $\\rho$.\n\nStep 1: Derivation of the residual $R_i(u)$\nThe finite-volume method applied to the one-dimensional conservation law $\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0$ over a control volume (cell) $\\Omega_i = [x_{i-1/2}, x_{i+1/2}]$ of length $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ yields:\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\,dx + f(u(x_{i+1/2},t)) - f(u(x_{i-1/2},t)) = 0\n$$\nDefining the cell-average $u_i(t) = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\,dx$, the equation becomes:\n$$\n\\Delta x_i \\frac{du_i}{dt} + F_{i+1/2} - F_{i-1/2} = 0\n$$\nwhere $F_{i \\pm 1/2}$ are the numerical fluxes at the cell interfaces. The physical flux for the linear advection equation is $f(u) = au$. The semi-discrete form is:\n$$\n\\frac{du_i}{dt} = -\\frac{1}{\\Delta x_i} (F_{i+1/2} - F_{i-1/2})\n$$\nThe problem provides the explicit Euler time-marching scheme as $u_i^{n+1} = u_i^n - \\frac{\\Delta t_i}{\\Delta x_i} R_i(u^n)$. Approximating the time derivative as $\\frac{du_i}{dt} \\approx \\frac{u_i^{n+1}-u_i^n}{\\Delta t_i}$ (for a single cell's update), we can relate the semi-discrete form to the update formula:\n$$\nu_i^{n+1} - u_i^n \\approx - \\frac{\\Delta t_i}{\\Delta x_i} (F_{i+1/2} - F_{i-1/2})\n$$\nComparing this with the given update formula, we identify the residual $R_i(u)$ as the difference of the numerical fluxes:\n$$\nR_i(u) = F_{i+1/2} - F_{i-1/2}\n$$\nThe problem specifies a first-order upwind flux for $a>0$. This means the flux at an interface is determined by the state in the cell upwind (to the left) of the interface.\nFor the interface at $x_{i+1/2}$ between cells $i$ and $i+1$, the upwind cell is cell $i$. Thus, the numerical flux is $F_{i+1/2} = f(u_i) = a u_i$.\nFor the interface at $x_{i-1/2}$ between cells $i-1$ and $i$, the upwind cell is cell $i-1$. Thus, the numerical flux is $F_{i-1/2} = f(u_{i-1}) = a u_{i-1}$.\nThe residual for an interior cell $i$ is:\n$$\nR_i(u) = a u_i - a u_{i-1} = a(u_i - u_{i-1})\n$$\nThe system consists of three cells, $i=1, 2, 3$. For the first cell, $i=1$, the left boundary is an inflow Dirichlet boundary. Let the value be $u_L$. This value determines the state for the flux calculation at the $x_{1/2}$ interface, effectively acting as $u_0$. So, $F_{1/2} = a u_L$. The residuals for the three cells are:\n$R_1(u) = F_{3/2} - F_{1/2} = a u_1 - a u_L = a(u_1 - u_L)$\n$R_2(u) = F_{5/2} - F_{3/2} = a u_2 - a u_1 = a(u_2 - u_1)$\n$R_3(u) = F_{7/2} - F_{5/2} = a u_3 - a u_2 = a(u_3 - u_2)$\n\nStep 2: Determination of local time steps $\\Delta t_i$\nSubstituting the derived residual into the given update formula:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t_i}{\\Delta x_i} a (u_i^n - u_{i-1}^n)\n$$\nRearranging the terms for $u_i^{n+1}$:\n$$\nu_i^{n+1} = \\left(1 - \\frac{a \\Delta t_i}{\\Delta x_i}\\right) u_i^n + \\frac{a \\Delta t_i}{\\Delta x_i} u_{i-1}^n\n$$\nThis is the update equation for the explicit first-order upwind scheme. For this scheme to be stable (e.g., to satisfy the positivity condition, ensuring no new extrema are created), the coefficients of the states on the right-hand side must be non-negative. This requires:\n$$\n1 - \\frac{a \\Delta t_i}{\\Delta x_i} \\ge 0 \\implies \\frac{a \\Delta t_i}{\\Delta x_i} \\le 1\n$$\nThis is the Courant–Friedrichs–Lewy (CFL) stability condition. The quantity $\\frac{a \\Delta t_i}{\\Delta x_i}$ is the local Courant number. The problem states that a CFL number $C \\in (0,1]$ is chosen to set the time step. This means we set the local Courant number for each cell to this value $C$:\n$$\n\\frac{a \\Delta t_i}{\\Delta x_i} = C\n$$\nSolving for the local time step $\\Delta t_i$ gives:\n$$\n\\Delta t_i = \\frac{C \\Delta x_i}{a}\n$$\nApplying this to each of the three cells, we get:\n$\\Delta t_1 = \\frac{C \\Delta x_1}{a}$\n$\\Delta t_2 = \\frac{C \\Delta x_2}{a}$\n$\\Delta t_3 = \\frac{C \\Delta x_3}{a}$\n\nStep 3: Estimation of the contraction factor $\\rho$\nThe pseudo-time stepping is an iterative method to find the steady-state solution, which is defined by $\\frac{\\partial u}{\\partial t} = 0$. This implies that the semi-discrete residuals must be zero: $R_i(u) = 0$.\nThe steady-state linear system is:\n$a(u_1 - u_L) = 0$\n$a(u_2 - u_1) = 0$\n$a(u_3 - u_2) = 0$\nThe solution is $u_1 = u_2 = u_3 = u_L$.\nThe iterative scheme to solve this system is given by the update formula with $\\frac{a \\Delta t_i}{\\Delta x_i} = C$:\n$u_1^{n+1} = (1-C) u_1^n + C u_L$\n$u_2^{n+1} = (1-C) u_2^n + C u_1^n$\n$u_3^{n+1} = (1-C) u_3^n + C u_2^n$\nThis system can be written in matrix form $\\mathbf{u}^{n+1} = G \\mathbf{u}^n + \\mathbf{c}$, where $\\mathbf{u}^n = [u_1^n, u_2^n, u_3^n]^T$:\n$$\n\\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\\\ u_3^{n+1} \\end{pmatrix} =\n\\begin{pmatrix} 1-C & 0 & 0 \\\\ C & 1-C & 0 \\\\ 0 & C & 1-C \\end{pmatrix}\n\\begin{pmatrix} u_1^n \\\\ u_2^n \\\\ u_3^n \\end{pmatrix} +\n\\begin{pmatrix} C u_L \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe matrix $G$ is the iteration matrix. The convergence rate of the iteration is determined by the spectral radius of $G$, which is the contraction factor $\\rho$.\n$$\nG = \\begin{pmatrix} 1-C & 0 & 0 \\\\ C & 1-C & 0 \\\\ 0 & C & 1-C \\end{pmatrix}\n$$\nSince $G$ is a lower triangular matrix, its eigenvalues are its diagonal entries.\n$$\n\\lambda_1 = \\lambda_2 = \\lambda_3 = 1-C\n$$\nThe spectral radius $\\rho(G)$ is the maximum of the absolute values of the eigenvalues:\n$$\n\\rho = \\rho(G) = \\max_i |\\lambda_i| = |1-C|\n$$\nThe problem specifies that $C \\in (0, 1]$. For this range of $C$, the value of $1-C$ is in the range $[0, 1)$. Therefore, $|1-C| = 1-C$.\nThe contraction factor is:\n$$\n\\rho = 1-C\n$$\nThis scheme is a weighted-Jacobi iteration for the steady-state system with a relaxation factor $\\omega = C$. The iteration converges for any $C \\in (0,1)$, and the convergence is fastest as $C \\to 1$, which gives $\\rho \\to 0$.\n\nFinal Answer Assembly\nThe required quantities are $\\Delta t_1$, $\\Delta t_2$, $\\Delta t_3$, and $\\rho$.\n$\\Delta t_1 = \\frac{C \\Delta x_1}{a}$\n$\\Delta t_2 = \\frac{C \\Delta x_2}{a}$\n$\\Delta t_3 = \\frac{C \\Delta x_3}{a}$\n$\\rho = 1-C$\nThese are combined into a single row matrix as requested.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{C \\Delta x_1}{a} & \\frac{C \\Delta x_2}{a} & \\frac{C \\Delta x_3}{a} & 1 - C \\end{pmatrix}}\n$$", "id": "3341489"}, {"introduction": "A critical challenge in implementing local time stepping, particularly with Adaptive Mesh Refinement (AMR), is maintaining strict conservation across interfaces between different grid levels. This exercise guides you through the derivation of a flux-matching condition that ensures the total flux is consistent between coarse and fine cells over a coarse time step. Mastering this principle is essential for developing robust and accurate multirate numerical schemes for conservation laws. [@problem_id:3341529]", "problem": "Consider a hyperbolic system of conservation laws in $d$ dimensions, written in conservation form as $\\partial_{t}\\mathbf{U} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$, where $\\mathbf{U}$ is a vector of conserved variables and $\\mathbf{F}(\\mathbf{U})$ is the corresponding flux vector. In a finite-volume discretization, the update of a control volume is obtained by integrating the conservation law in space and time and applying the divergence theorem. Assume an Adaptive Mesh Refinement (AMR) hierarchy with level-based subcycling in time: a coarse level indexed by $\\ell$ uses a time step $\\Delta t_{\\ell}$, while a finer level indexed by $\\ell+1$ adjacent to a coarse–fine interface advances with local time steps $\\Delta t_{i}$ that satisfy $\\Delta t_{i} < \\Delta t_{\\ell}$.\n\nFocus on a single coarse–fine interface face. Let the coarse face have area $A_{C}$ and outward unit normal $\\mathbf{n}_{C}$ pointing from the coarse cell into the fine region. The finer level partitions the coarse face into $K$ non-overlapping fine face segments indexed by $k = 1, 2, \\dots, K$, each of area $A_{k}$ and outward unit normal $\\mathbf{n}_{k}$ chosen to be consistent with $\\mathbf{n}_{C}$ on the shared interface. Over one coarse time step, each fine face segment $k$ advances with a sequence of $M_{k}$ local substeps indexed by $m = 1, 2, \\dots, M_{k}$ with durations $\\Delta t_{k}^{(m)}$ such that $\\sum_{m=1}^{M_{k}} \\Delta t_{k}^{(m)} = \\Delta t_{\\ell}$. During each substep $m$ on face segment $k$, the Riemann solver provides a time-averaged normal flux vector $\\bar{\\mathbf{F}}_{k}^{(m)}$ across $A_{k}$, defined so that the space–time integrated flux over that substep is $\\bar{\\mathbf{F}}_{k}^{(m)} \\, A_{k} \\, \\Delta t_{k}^{(m)}$.\n\nStarting from the integral form of conservation over the coarse cell and its fine neighbors and requiring that the net flux through the shared coarse–fine interface be identical when viewed from the coarse and fine levels, derive a single closed-form expression for the coarse-level time-averaged interface flux vector $\\bar{\\mathbf{F}}_{C}$ to be used in the coarse update over $\\Delta t_{\\ell}$ that guarantees exact conservation across the interface. Your expression must be written in terms of $\\Delta t_{\\ell}$, $A_{C}$, the fine face areas $A_{k}$, the fine substep durations $\\Delta t_{k}^{(m)}$, and the fine-level time-averaged fluxes $\\bar{\\mathbf{F}}_{k}^{(m)}$. Express your final answer as a single analytic expression. No rounding is required and no physical units should be included in the final boxed answer.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically concerning conservative numerical schemes for hyperbolic conservation laws on adaptive meshes. The problem is well-posed, objective, and contains sufficient information to derive the requested expression. The terminology and scenario are standard in the field of numerical analysis for partial differential equations.\n\nThe derivation of the coarse-level time-averaged interface flux vector, $\\bar{\\mathbf{F}}_{C}$, is founded upon the principle of exact conservation of fluxes at the interface between computational cells of different refinement levels. This principle requires that the total quantity of a conserved variable $\\mathbf{U}$ that passes through the interface over a given time interval must be identical when calculated from the perspective of the coarse cell and from the perspective of the adjacent fine cells.\n\nLet the shared interface be denoted by $\\Gamma$. In the context of the coarse cell, $\\Gamma$ is a single face with area $A_{C}$. The coarse-level update for this cell occurs over a single time step of duration $\\Delta t_{\\ell}$. The problem defines $\\bar{\\mathbf{F}}_{C}$ as the time-averaged flux vector for the coarse cell. Therefore, the total amount of the conserved quantity $\\mathbf{U}$ that crosses the interface from the coarse side over the time interval $\\Delta t_{\\ell}$, which we denote as $\\Delta\\mathbf{Q}_{\\text{coarse}}$, is given by the product of the flux, the area, and the time duration:\n$$ \\Delta\\mathbf{Q}_{\\text{coarse}} = \\bar{\\mathbf{F}}_{C} \\, A_{C} \\, \\Delta t_{\\ell} $$\n\nFrom the perspective of the fine level, the same interface $\\Gamma$ is composed of $K$ smaller, non-overlapping face segments, indexed by $k = 1, 2, \\dots, K$. Each segment has an area $A_{k}$. The conservation of geometric area implies that $\\sum_{k=1}^{K} A_{k} = A_{C}$.\n\nFurthermore, the temporal evolution on the fine side is more complex due to subcycling. For each fine face segment $k$, the coarse time interval $\\Delta t_{\\ell}$ is spanned by a sequence of $M_{k}$ local time substeps, indexed by $m = 1, 2, \\dots, M_{k}$. Each substep has a duration $\\Delta t_{k}^{(m)}$, with the property that the sum of these substep durations equals the coarse time step: $\\sum_{m=1}^{M_{k}} \\Delta t_{k}^{(m)} = \\Delta t_{\\ell}$ for every $k$.\n\nFor each fine segment $k$ and during each of its substeps $m$, a time-averaged normal flux vector $\\bar{\\mathbf{F}}_{k}^{(m)}$ is provided. As per the problem's definition, the total space-time integrated flux across this segment during this substep is $\\bar{\\mathbf{F}}_{k}^{(m)} \\, A_{k} \\, \\Delta t_{k}^{(m)}$. This represents the net amount of $\\mathbf{U}$ that has passed through segment $k$ during the time interval $\\Delta t_k^{(m)}$.\n\nTo find the total flux from the fine side, $\\Delta\\mathbf{Q}_{\\text{fine}}$, over the entire coarse time step $\\Delta t_{\\ell}$, we must sum the contributions from all substeps for all fine segments.\nFirst, for a single fine face segment $k$, the total flux over $\\Delta t_{\\ell}$ is the sum over its $M_{k}$ substeps:\n$$ \\Delta\\mathbf{Q}_{k} = \\sum_{m=1}^{M_{k}} \\left( \\bar{\\mathbf{F}}_{k}^{(m)} \\, A_{k} \\, \\Delta t_{k}^{(m)} \\right) $$\nSince the area $A_k$ is constant for a given segment $k$, it can be factored out of the summation:\n$$ \\Delta\\mathbf{Q}_{k} = A_{k} \\sum_{m=1}^{M_{k}} \\bar{\\mathbf{F}}_{k}^{(m)} \\, \\Delta t_{k}^{(m)} $$\nNext, the total flux across the entire interface is the sum of the fluxes through all $K$ fine segments:\n$$ \\Delta\\mathbf{Q}_{\\text{fine}} = \\sum_{k=1}^{K} \\Delta\\mathbf{Q}_{k} = \\sum_{k=1}^{K} \\left( A_{k} \\sum_{m=1}^{M_{k}} \\bar{\\mathbf{F}}_{k}^{(m)} \\, \\Delta t_{k}^{(m)} \\right) $$\n\nThe principle of exact conservation requires that $\\Delta\\mathbf{Q}_{\\text{coarse}} = \\Delta\\mathbf{Q}_{\\text{fine}}$. Equating the expressions derived above yields:\n$$ \\bar{\\mathbf{F}}_{C} \\, A_{C} \\, \\Delta t_{\\ell} = \\sum_{k=1}^{K} A_{k} \\sum_{m=1}^{M_{k}} \\bar{\\mathbf{F}}_{k}^{(m)} \\, \\Delta t_{k}^{(m)} $$\nTo obtain the desired expression for the coarse-level time-averaged flux $\\bar{\\mathbf{F}}_{C}$, we solve for it by dividing both sides by the scalar quantity $A_{C} \\Delta t_{\\ell}$:\n$$ \\bar{\\mathbf{F}}_{C} = \\frac{1}{A_{C} \\Delta t_{\\ell}} \\sum_{k=1}^{K} \\sum_{m=1}^{M_{k}} A_{k} \\bar{\\mathbf{F}}_{k}^{(m)} \\Delta t_{k}^{(m)} $$\nThis is the closed-form expression for the coarse-level flux that guarantees exact flux conservation at the coarse-fine interface. It represents a weighted average of all fine-level fluxes, where each fine flux $\\bar{\\mathbf{F}}_{k}^{(m)}$ is weighted by its corresponding space-time area $A_{k} \\Delta t_{k}^{(m)}$, and the sum is normalized by the total coarse space-time area $A_C \\Delta t_{\\ell}$.", "answer": "$$\\boxed{\\frac{1}{A_{C} \\Delta t_{\\ell}} \\sum_{k=1}^{K} \\sum_{m=1}^{M_{k}} A_{k} \\Delta t_{k}^{(m)} \\bar{\\mathbf{F}}_{k}^{(m)}}$$", "id": "3341519"}, {"introduction": "While local time stepping accelerates convergence, its interaction with higher-order time integration schemes requires careful consideration. This practice explores the application of a third-order Strong Stability Preserving (SSP) Runge-Kutta method with cell-local time steps. You will analyze the conditions required to maintain the SSP property, highlighting the constraints and practical feasibility of using such advanced schemes in a multirate context. [@problem_id:3341502]", "problem": "Consider a semi-discrete form of a nonlinear hyperbolic conservation law in Computational Fluid Dynamics (CFD), written componentwise for each cell as the system of ordinary differential equations\n$$\n\\frac{d u_{i}}{d t} = L_{i}\\!\\left(u\\right),\n$$\nwhere $u$ denotes the vector of all cell-averaged solution values and $L_{i}$ is the spatial discretization operator for cell $i$ constructed with a monotone flux so that Forward Euler (FE) time stepping is admissible under a cellwise stability bound. Assume FE applied to the full semi-discrete system with a per-cell time step $\\tau_{i}$ is strongly stable in a chosen monotone norm or semi-norm (for example, total variation or a positivity norm) provided\n$$\n0 \\le \\tau_{i} \\le \\Delta t_{\\mathrm{FE},i},\n$$\nwith $\\Delta t_{\\mathrm{FE},i} > 0$ denoting the maximum admissible FE step for cell $i$ under the given spatial discretization and current stage state.\n\nWe wish to accelerate convergence to steady state by local time stepping: apply a Strong Stability Preserving (SSP) third-order, three-stage Runge–Kutta method, denoted SSP(3,3), with per-cell time steps $\\Delta t_{i}$, stage-synchronized across all cells. The SSP(3,3) method in Shu–Osher form updates as follows:\n- Stage $1$: \n$$\nu^{(1)} = u^{n} + \\Delta t \\, L\\!\\left(u^{n}\\right),\n$$\n- Stage $2$: \n$$\nu^{(2)} = \\frac{3}{4}\\,u^{n} + \\frac{1}{4}\\left(u^{(1)} + \\Delta t \\, L\\!\\left(u^{(1)}\\right)\\right),\n$$\n- Stage $3$ (solution update): \n$$\nu^{n+1} = u^{(3)} = \\frac{1}{3}\\,u^{n} + \\frac{2}{3}\\left(u^{(2)} + \\Delta t \\, L\\!\\left(u^{(2)}\\right)\\right).\n$$\n\nUnder local time stepping, interpret $\\Delta t$ componentwise so that for each cell $i$, the FE-like increments in each stage employ $\\Delta t_{i}$. For SSP to hold, each stage must be representable, for each cell $i$, as a convex combination of FE steps $u_{i}^{(m)} + \\tau_{i}^{(m)} L_{i}\\!\\left(u^{(m)}\\right)$ with nonnegative weights that sum to one and with each $\\tau_{i}^{(m)}$ admissible, i.e., $0 \\le \\tau_{i}^{(m)} \\le \\Delta t_{\\mathrm{FE},i}$.\n\n(a) Rewrite the SSP(3,3) stages for a fixed cell index $i$ so that each stage $u_{i}^{(k)}$ is expressed explicitly as a convex combination of FE steps, identifying all per-cell FE substeps $\\tau_{i}^{(m)}$ that appear.\n\n(b) From this representation, derive the necessary and sufficient cellwise inequalities on $\\Delta t_{i}$ that ensure every stage remains a convex combination of admissible FE steps for cell $i$.\n\n(c) Suppose one chooses a uniform scaling of the local FE bounds $\\Delta t_{i} = s \\, \\Delta t_{\\mathrm{FE},i}$ with a scalar $s \\in \\mathbb{R}$, the same across all cells. Determine the maximum admissible scaling factor $s_{\\max}$ such that the SSP(3,3) method with local time stepping remains SSP in the stated sense. Express the final scaling factor as an exact number (dimensionless).\n\n(d) Briefly discuss, without altering the required calculation, the practical feasibility of satisfying the derived constraints in a multi-cell CFD computation where $L_{i}$ couples neighboring cells, considering stage synchronization and interface flux consistency under local time stepping.", "solution": "The problem requires an analysis of a third-order Strong Stability Preserving (SSP) Runge-Kutta method, SSP(3,3), applied with local time stepping to a system of ordinary differential equations (ODEs) arising from the semi-discretization of a nonlinear hyperbolic conservation law. The analysis will proceed in four parts as requested.\n\nThe semi-discrete system is given for each cell `$i$` as:\n$$\n\\frac{d u_{i}}{d t} = L_{i}\\!\\left(u\\right)\n$$\nwhere `$u$` is the vector of all cell-averaged solutions. The Forward Euler (FE) method is strongly stable for a time step `$\\tau_i$` provided `$0 \\le \\tau_{i} \\le \\Delta t_{\\mathrm{FE},i}$`, where `$\\Delta t_{\\mathrm{FE},i}$` is the maximum admissible FE step for cell `$i$` given the current state. The SSP property relies on decomposing each stage of the Runge-Kutta method into a sequence of convex combinations of admissible FE steps.\n\nThe SSP(3,3) method is given in Shu-Osher form:\n- Stage 1: `$u^{(1)} = u^{n} + \\Delta t \\, L\\!\\left(u^{n}\\right)$`\n- Stage 2: `$u^{(2)} = \\frac{3}{4}\\,u^{n} + \\frac{1}{4}\\left(u^{(1)} + \\Delta t \\, L\\!\\left(u^{(1)}\\right)\\right)$`\n- Stage 3: `$u^{n+1} = u^{(3)} = \\frac{1}{3}\\,u^{n} + \\frac{2}{3}\\left(u^{(2)} + \\Delta t \\, L\\!\\left(u^{(2)}\\right)\\right)`\n\nIn the context of local time stepping, the global `$\\Delta t$` is replaced by a cell-dependent `$\\Delta t_i$`.\n\n**(a) Rewrite stages as explicit convex combinations of FE steps and identify FE substeps**\n\nThe SSP property is guaranteed by the structure of the Shu-Osher form, which expresses each stage update as a convex combination of results from previous stages and FE-like steps. An FE step from a state `$w_i$` is defined as `$w_i + \\tau_i L_i(w)$`.\n\n- **Stage 1:** For cell `$i$`, the update is:\n$$\nu_{i}^{(1)} = u_{i}^{n} + \\Delta t_{i} L_{i}\\!\\left(u^{n}\\right)\n$$\nThis is already in the form of a single FE step starting from `$u_i^n$`. We can express it as a trivial convex combination with a single term and a weight of `$1$`:\n$$\nu_{i}^{(1)} = 1 \\cdot \\left( u_{i}^{n} + \\tau_{i}^{(0)} L_{i}\\!\\left(u^{n}\\right) \\right)\n$$\nThe per-cell FE substep is `$\\tau_{i}^{(0)} = \\Delta t_{i}$`.\n\n- **Stage 2:** For cell `$i$`, the update is:\n$$\nu_{i}^{(2)} = \\frac{3}{4}\\,u_{i}^{n} + \\frac{1}{4}\\left(u_{i}^{(1)} + \\Delta t_{i} L_{i}\\!\\left(u^{(1)}\\right)\\right)\n$$\nThis equation expresses `$u_i^{(2)}$` as a convex combination of the state `$u_i^n$` (with weight `$\\frac{3}{4}$`) and the term `$(u_{i}^{(1)} + \\Delta t_{i} L_{i}(u^{(1)}))$` (with weight `$\\frac{1}{4}$`). The weights are non-negative and sum to `$1$`. The second term is an FE step applied to the state `$u_i^{(1)}$`. The FE substep associated with this step is:\n$$\n\\tau_{i}^{(1)} = \\Delta t_{i}\n$$\n\n- **Stage 3:** The final update for cell `$i$` is:\n$$\nu_{i}^{n+1} = u_{i}^{(3)} = \\frac{1}{3}\\,u_{i}^{n} + \\frac{2}{3}\\left(u_{i}^{(2)} + \\Delta t_{i} L_{i}\\!\\left(u^{(2)}\\right)\\right)\n$$\nThis expresses `$u_i^{n+1}$` as a convex combination of the state `$u_i^n$` (with weight `$\\frac{1}{3}$`) and the term `$(u_{i}^{(2)} + \\Delta t_{i} L_{i}(u^{(2)}))$` (with weight `$\\frac{2}{3}$`). The second term is an FE step applied to the state `$u_i^{(2)}$`. The FE substep associated with this step is:\n$$\n\\tau_{i}^{(2)} = \\Delta t_{i}\n$$\n\nIn summary, the method consists of a sequence of operations (FE steps and convex combinations), and the explicit FE substeps appearing in the formulation at each stage are `$\\tau_{i}^{(0)} = \\Delta t_{i}$`, `$\\tau_{i}^{(1)} = \\Delta t_{i}$`, and `$\\tau_{i}^{(2)} = \\Delta t_{i}`.\n\n**(b) Derive necessary and sufficient cellwise inequalities on `$\\Delta t_i$`**\n\nThe SSP property requires that every FE step involved in the scheme must be admissible. An FE step with substep `$\\tau_i$` from a state `$w$` is admissible if `$0 \\le \\tau_i \\le \\Delta t_{\\mathrm{FE},i}(w)$`, where `$\\Delta t_{\\mathrm{FE},i}(w)$` is the maximum stable FE step size for cell `$i$` at state `$w$`.\n\nFor the SSP(3,3) method to be SSP, each of the FE substeps identified in part (a) must be admissible in the context of the stage in which it appears.\n\n1.  For Stage 1, the substep is `$\\tau_i^{(0)} = \\Delta t_i$`, applied to state `$u^n$`. The admissibility condition is:\n    $$\n    0 \\le \\Delta t_i \\le \\Delta t_{\\mathrm{FE},i}(u^n)\n    $$\n2.  For Stage 2, the substep is `$\\tau_i^{(1)} = \\Delta t_i$`, applied to state `$u^{(1)}$`. The admissibility condition is:\n    $$\n    0 \\le \\Delta t_i \\le \\Delta t_{\\mathrm{FE},i}(u^{(1)})\n    $$\n3.  For Stage 3, the substep is `$\\tau_i^{(2)} = \\Delta t_i$`, applied to state `$u^{(2)}$`. The admissibility condition is:\n    $$\n    0 \\le \\Delta t_i \\le \\Delta t_{\\mathrm{FE},i}(u^{(2)})\n    $$\n\nFor a single time step from `$n$` to `$n+1$` to be SSP, the chosen `$\\Delta t_i$` must satisfy all these conditions simultaneously. Therefore, the necessary condition is:\n$$\n\\Delta t_i \\le \\min\\left( \\Delta t_{\\mathrm{FE},i}(u^n), \\Delta t_{\\mathrm{FE},i}(u^{(1)}), \\Delta t_{\\mathrm{FE},i}(u^{(2)}) \\right)\n$$\nFor the purpose of determining the method's intrinsic SSP coefficient, it is standard practice to assume that `$\\Delta t_{\\mathrm{FE},i}` does not change significantly over the stages of a single time step. This is guided by the problem statement where the admissibility condition `$0 \\le \\tau_{i}^{(m)} \\le \\Delta t_{\\mathrm{FE},i}$` does not explicitly show a state dependency. Under this standard simplifying assumption, we set `$\\Delta t_{\\mathrm{FE},i}(u^n) \\approx \\Delta t_{\\mathrm{FE},i}(u^{(1)}) \\approx \\Delta t_{\\mathrm{FE},i}(u^{(2)}) \\approx \\Delta t_{\\mathrm{FE},i}$` (where the latter is evaluated at state `$u^n$`).\n\nWith this assumption, the three inequalities collapse into a single condition. This condition is both necessary and sufficient under the given SSP definition and the assumption of a constant `$\\Delta t_{\\mathrm{FE},i}$` over the substages:\n$$\n0 \\le \\Delta t_i \\le \\Delta t_{\\mathrm{FE},i}\n$$\n\n**(c) Determine the maximum admissible scaling factor `$s_{\\max}$`**\n\nWe are given the local time step as a uniform scaling of the local FE bound: `$\\Delta t_i = s \\cdot \\Delta t_{\\mathrm{FE},i}$`, where `$s$` is a scalar constant across all cells and `$\\Delta t_{\\mathrm{FE},i}$` is the maximum admissible FE step for cell `$i$` (evaluated at state `$u^n$`).\n\nSubstituting this into the inequality derived in part (b):\n$$\ns \\cdot \\Delta t_{\\mathrm{FE},i} \\le \\Delta t_{\\mathrm{FE},i}\n$$\nThe problem states that `$\\Delta t_{\\mathrm{FE},i} > 0$`. Therefore, we can divide both sides by `$\\Delta t_{\\mathrm{FE},i}$` without changing the direction of the inequality:\n$$\ns \\le 1\n$$\nSince `$s$` is typically chosen to be non-negative for a forward time integration, the full range is `$0 \\le s \\le 1$`. The maximum admissible scaling factor is therefore:\n$$\ns_{\\max} = 1\n$$\nThis value is the well-known SSP coefficient for the SSP(3,3) method.\n\n**(d) Discussion on practical feasibility**\n\nThe derivation in parts (b) and (c) relied on the assumption that the cellwise FE stability bound, `$\\Delta t_{\\mathrm{FE},i}$`, remains effectively constant throughout the three stages of the Runge-Kutta step. In a practical multi-cell CFD computation, several factors complicate this picture:\n\n1.  **State-Dependent Stability:** The stability bound `$\\Delta t_{\\mathrm{FE},i}$` (e.g., from a CFL condition) is a function of the local solution state, e.g., `$\\Delta t_{\\mathrm{FE},i} \\propto 1 / (|\\mathbf{v}_i| + c_i)$`. As the solution evolves through the stages `$u^{(1)}$` and `$u^{(2)}$`, the local velocity `$\\mathbf{v}_i$` and sound speed `$c_i$` can change, altering the true value of `$\\Delta t_{\\mathrm{FE},i}(u^{(k)})$`. If the stability bound decreases significantly during a stage (e.g., due to a strengthening shock), the condition `$\\Delta t_i \\le \\Delta t_{\\mathrm{FE},i}(u^{(k)})$` could be violated even if `$s=1$` based on the initial state `$u^n$`.\n\n2.  **Interface Flux Consistency:** The spatial operator `$L_i(u)$` for cell `$i$` typically depends on the solution in neighboring cells, e.g., through a numerical flux `$F_{i+1/2}(u_i, u_{i+1})$`. In local time stepping, the intermediate stage values `$u_i^{(k)}$` and `$u_{j}^{(k)}$` for neighboring cells `$i, j$` are computed using their respective time steps `$\\Delta t_i$` and `$\\Delta t_j$`. If `$\\Delta t_i \\neq \\Delta t_j$`, the collection of stage values `$u^{(k)}$` does not correspond to the solution of the semi-discrete system at any single intermediate time. This inconsistency at cell interfaces can lead to a degradation of the formal order of accuracy for transient problems. For convergence to a steady state, this loss of transient accuracy is often considered an acceptable trade-off for the acceleration achieved.\n\n3.  **Strict SSP Property:** Due to the combined effects of state-dependent stability and inconsistent interface states, the rigorously proven SSP property may be compromised in practice. Large ratios of `$\\Delta t_i / \\Delta t_j$` between adjacent cells can exacerbate these issues. Consequently, practitioners often use a more conservative scaling factor (`$s < 1$`) and/or limit the maximum ratio of time steps between neighboring cells to maintain robustness and prevent the growth of oscillations.", "answer": "$$\n\\boxed{1}\n$$", "id": "3341502"}]}