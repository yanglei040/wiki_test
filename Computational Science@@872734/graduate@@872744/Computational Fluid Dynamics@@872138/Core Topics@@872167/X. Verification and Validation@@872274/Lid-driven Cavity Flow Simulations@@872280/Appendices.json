{"hands_on_practices": [{"introduction": "The fidelity of a CFD simulation begins with the computational grid. This exercise delves into the fundamental consequences of using an anisotropic mesh, where grid spacings differ in each direction—a common practice for resolving thin boundary layers efficiently. By analyzing the discrete Laplacian operator [@problem_id:3340070], you will directly connect grid dimensions to truncation error and derive the critical time step constraint for an explicit viscous update, providing a foundational skill for designing stable and accurate numerical schemes.", "problem": "Consider the two-dimensional incompressible Navier–Stokes equations in a square lid-driven cavity of side length $L$, with the top lid moving at uniform velocity $U$ in the $x$-direction and no-slip boundary conditions on all walls. A standard projection method is employed to enforce incompressibility: an explicit viscous update produces a provisional velocity field, and then a pressure Poisson problem is solved to project this field onto the divergence-free subspace. The spatial discretization uses second-order centered finite differences on a uniform but anisotropic Cartesian grid with spacings $\\Delta x \\neq \\Delta y$, where $\\Delta x = L/N_{x}$ and $\\Delta y = L/N_{y}$ for given positive integers $N_{x}$ and $N_{y}$. The discrete Laplacian for a scalar field $\\phi$ at interior node $(i,j)$ is defined by\n$$\n(\\nabla_{h}^{2}\\phi)_{i,j} \\equiv \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{\\Delta x^{2}} + \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{\\Delta y^{2}}.\n$$\nStarting from the partial differential equation model and the above discrete operator, perform the following:\n\n(1) Derive the leading-order truncation error of the discrete Laplacian $(\\nabla_{h}^{2}\\phi)_{i,j}$ in terms of continuous derivatives of $\\phi$, explicitly exhibiting the dependence on $\\Delta x$ and $\\Delta y$.\n\n(2) Consider the explicit forward Euler update for the viscous term applied to each component of velocity,\n$$\n\\boldsymbol{u}^{*} = \\boldsymbol{u}^{n} + \\nu\\,\\Delta t\\,\\nabla_{h}^{2}\\boldsymbol{u}^{n},\n$$\nwhere $\\nu$ is the kinematic viscosity and $\\Delta t$ the time step. Using a modal (eigenvalue) analysis of the discrete Laplacian with homogeneous Dirichlet boundary conditions on the cavity walls, derive a stability bound for $\\Delta t$ that depends on $\\Delta x$ and $\\Delta y$. Explain how anisotropy ($\\Delta x \\neq \\Delta y$) enters into this bound.\n\n(3) Justify, using a discrete inner-product argument, why the Helmholtz–Hodge projection step is non-expansive in an appropriate discrete $\\ell^{2}$ norm and therefore does not further restrict the explicit viscous stability bound derived in part $(2)$ when using compatible centered differencing for divergence and gradient.\n\nFinally, for a cavity with $L = 0.1$ $\\mathrm{m}$, $N_{x} = 128$, $N_{y} = 64$, and $\\nu = 1.0 \\times 10^{-6}$ $\\mathrm{m}^{2}/\\mathrm{s}$, compute the maximum stable $\\Delta t$ for the explicit viscous update you derived in part $(2)$. Express your final time step in seconds and round your answer to four significant figures.", "solution": "This problem addresses the numerical analysis of a finite difference scheme for the incompressible Navier-Stokes equations, focusing on truncation error, stability, and the properties of the projection method. We shall address each part of the problem in sequence.\n\n(1) Truncation Error of the Discrete Laplacian\n\nThe truncation error, $\\tau_{i,j}$, of the discrete Laplacian operator, $(\\nabla_{h}^{2}\\phi)_{i,j}$, is defined as the difference between the discrete operator applied to the continuous field $\\phi(x,y)$ and the exact continuous Laplacian operator applied to the same field, evaluated at the grid point $(x_i, y_j)$.\n$$\n\\tau_{i,j} = (\\nabla_{h}^{2}\\phi)_{i,j} - (\\nabla^{2}\\phi)(x_i, y_j)\n$$\nThe continuous Laplacian is $\\nabla^{2}\\phi = \\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\partial^{2}\\phi}{\\partial y^{2}}$. The given discrete Laplacian is\n$$\n(\\nabla_{h}^{2}\\phi)_{i,j} = \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{\\Delta x^{2}} + \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{\\Delta y^{2}}\n$$\nTo find the truncation error, we perform a Taylor series expansion of the terms $\\phi_{i\\pm1, j}$ and $\\phi_{i, j\\pm1}$ around the point $(x_i, y_j)$, assuming $\\phi$ is sufficiently smooth. For the $x$-derivatives, we have:\n$$\n\\phi_{i+1,j} = \\phi(x_i+\\Delta x, y_j) = \\phi_{i,j} + \\Delta x\\frac{\\partial\\phi}{\\partial x} + \\frac{\\Delta x^{2}}{2!}\\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\Delta x^{3}}{3!}\\frac{\\partial^{3}\\phi}{\\partial x^{3}} + \\frac{\\Delta x^{4}}{4!}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + O(\\Delta x^{5})\n$$\n$$\n\\phi_{i-1,j} = \\phi(x_i-\\Delta x, y_j) = \\phi_{i,j} - \\Delta x\\frac{\\partial\\phi}{\\partial x} + \\frac{\\Delta x^{2}}{2!}\\frac{\\partial^{2}\\phi}{\\partial x^{2}} - \\frac{\\Delta x^{3}}{3!}\\frac{\\partial^{3}\\phi}{\\partial x^{3}} + \\frac{\\Delta x^{4}}{4!}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + O(\\Delta x^{5})\n$$\nAdding these two expansions cancels the odd-order derivative terms:\n$$\n\\phi_{i+1,j} + \\phi_{i-1,j} = 2\\phi_{i,j} + \\Delta x^{2}\\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{2\\Delta x^{4}}{24}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + O(\\Delta x^{6})\n$$\nRearranging this expression to match the form of the discrete derivative gives:\n$$\n\\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{\\Delta x^{2}} = \\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\Delta x^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + O(\\Delta x^{4})\n$$\nAn identical analysis for the $y$-direction yields:\n$$\n\\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{\\Delta y^{2}} = \\frac{\\partial^{2}\\phi}{\\partial y^{2}} + \\frac{\\Delta y^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial y^{2}} + O(\\Delta y^{4})\n$$\nSubstituting these expressions back into the definition of the discrete Laplacian, we obtain:\n$$\n(\\nabla_{h}^{2}\\phi)_{i,j} = \\left(\\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\partial^{2}\\phi}{\\partial y^{2}}\\right) + \\frac{\\Delta x^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + \\frac{\\Delta y^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial y^{2}} + O(\\Delta x^{4}, \\Delta y^{4})\n$$\nThe term in the parenthesis is the continuous Laplacian, $\\nabla^{2}\\phi$. Therefore, the leading-order truncation error is:\n$$\n\\tau_{i,j} = \\frac{\\Delta x^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + \\frac{\\Delta y^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial y^{2}}\n$$\nThe discretization is second-order accurate in space, with the error explicitly dependent on the grid spacings $\\Delta x$ and $\\Delta y$.\n\n(2) Stability Bound for the Explicit Viscous Update\n\nThe stability of the explicit forward Euler scheme for the viscous term, $\\boldsymbol{u}^{*} = \\boldsymbol{u}^{n} + \\nu\\,\\Delta t\\,\\nabla_{h}^{2}\\boldsymbol{u}^{n}$, is analyzed by examining the amplification of discrete error modes. The analysis is identical for each velocity component, so we consider a scalar field $u$. A modal analysis requires finding the eigenvalues of the discrete Laplacian operator $\\nabla_{h}^{2}$ with homogeneous Dirichlet boundary conditions.\n\nAn eigenmode of the operator on the discrete domain can be written as $u_{i,j} = \\sin(k_x x_i) \\sin(k_y y_j)$, where $x_i = i\\Delta x$ and $y_j = j\\Delta y$. The wavenumbers are $k_x = m\\pi/L$ and $k_y = p\\pi/L$, for integers $m \\in [1, N_x-1]$ and $p \\in [1, N_y-1]$. Applying the discrete Laplacian to this mode yields:\n$$\n(\\nabla_{h}^{2}u)_{i,j} = \\left( \\frac{\\sin(k_x(i+1)\\Delta x) - 2\\sin(k_x i\\Delta x) + \\sin(k_x(i-1)\\Delta x)}{\\Delta x^2} \\right)\\sin(k_y j\\Delta y) + \\sin(k_x i\\Delta x)\\left( \\frac{\\sin(k_y(j+1)\\Delta y) - 2\\sin(k_y j\\Delta y) + \\sin(k_y(j-1)\\Delta y)}{\\Delta y^2} \\right)\n$$\nUsing the trigonometric identity $\\sin(A+B)+\\sin(A-B) = 2\\sin(A)\\cos(B)$, the numerator of the $x$-term simplifies to $2\\sin(k_x i\\Delta x)\\cos(k_x\\Delta x) - 2\\sin(k_x i\\Delta x) = 2\\sin(k_x i\\Delta x)(\\cos(k_x\\Delta x)-1)$. With the half-angle identity $\\cos(\\theta)-1 = -2\\sin^2(\\theta/2)$, this becomes $-4\\sin(k_x i\\Delta x)\\sin^2(k_x\\Delta x/2)$. A similar result holds for the $y$-term.\nThus, the application of the operator results in:\n$$\n(\\nabla_{h}^{2}u)_{i,j} = \\left[ -\\frac{4}{\\Delta x^2}\\sin^2\\left(\\frac{k_x\\Delta x}{2}\\right) - \\frac{4}{\\Delta y^2}\\sin^2\\left(\\frac{k_y\\Delta y}{2}\\right) \\right] u_{i,j}\n$$\nThe expression in brackets is the eigenvalue, $\\lambda_{m,p}$, corresponding to the mode $(m,p)$. Substituting an eigenmode into the time-stepping scheme gives $u^{n+1} = (1 + \\nu\\Delta t \\lambda_{m,p})u^n$. The amplification factor is $G = 1 + \\nu\\Delta t \\lambda_{m,p}$. For stability, we require $|G| \\leq 1$, which means $-1 \\leq 1 + \\nu\\Delta t \\lambda_{m,p} \\leq 1$.\nThe eigenvalues $\\lambda_{m,p}$ are strictly negative for any non-trivial mode, so the condition $G \\leq 1$ is always satisfied. The remaining condition is $-1 \\leq 1 + \\nu\\Delta t \\lambda_{m,p}$, which implies $\\nu\\Delta t \\lambda_{m,p} \\geq -2$, or $\\Delta t \\leq \\frac{-2}{\\nu\\lambda_{m,p}}$.\n\nTo ensure stability for all possible modes, we must satisfy this condition for the eigenvalue with the largest magnitude (the most negative eigenvalue), which we denote $\\lambda_{min}$. This occurs for the highest frequency modes the grid can support, where the $\\sin^2$ terms are maximized. The arguments are $\\frac{k_x\\Delta x}{2} = \\frac{m\\pi}{L}\\frac{L/N_x}{2} = \\frac{m\\pi}{2N_x}$ and $\\frac{k_y\\Delta y}{2} = \\frac{p\\pi}{2N_y}$. The maximum value of $\\sin^2$ is $1$, which is approached as the argument approaches $\\pi/2$. This corresponds to the highest wavenumbers, $m=N_x-1$ and $p=N_y-1$, for which $k_x \\approx \\pi/\\Delta x$ and $k_y \\approx \\pi/\\Delta y$. For these \"worst-case\" modes, $\\sin^2(k_x\\Delta x/2) \\approx 1$ and $\\sin^2(k_y\\Delta y/2) \\approx 1$.\nThe most negative eigenvalue is thus approximately:\n$$\n\\lambda_{min} \\approx -\\frac{4}{\\Delta x^2} - \\frac{4}{\\Delta y^2}\n$$\nThe stability condition becomes:\n$$\n\\Delta t \\leq \\frac{-2}{\\nu(-\\frac{4}{\\Delta x^2} - \\frac{4}{\\Delta y^2})} = \\frac{1}{2\\nu(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2})}\n$$\nAnisotropy ($\\Delta x \\neq \\Delta y$) enters directly into this bound. The stability limit is determined by the sum of the inverse squared grid spacings. If one grid spacing is much smaller than the other (e.g., $\\Delta x \\ll \\Delta y$), the term with the smaller spacing ($1/\\Delta x^2$) will dominate the sum, making the time step restriction much more severe. The stability is effectively governed by the smallest grid cell dimension in the mesh.\n\n(3) Non-Expansive Nature of the Projection Step\n\nThe projection step decomposes the provisional velocity field $\\boldsymbol{u}^*$ into a divergence-free part $\\boldsymbol{u}^{n+1}$ and the gradient of a scalar potential $\\phi$ (related to pressure), such that $\\boldsymbol{u}^* = \\boldsymbol{u}^{n+1} + \\nabla_h \\phi$. By construction, $\\nabla_h \\cdot \\boldsymbol{u}^{n+1} = 0$. The question is to show that this projection is non-expansive in the discrete $\\ell^2$ norm, i.e., $\\|\\boldsymbol{u}^{n+1}\\|_2 \\leq \\|\\boldsymbol{u}^*\\|_2$.\n\nThe squared $\\ell^2$ norm is defined via the inner product, $\\|\\boldsymbol{v}\\|_2^2 = \\langle \\boldsymbol{v}, \\boldsymbol{v} \\rangle = \\sum_{i,j} \\boldsymbol{v}_{i,j} \\cdot \\boldsymbol{v}_{i,j} \\Delta x \\Delta y$. We evaluate the squared norm of $\\boldsymbol{u}^*$:\n$$\n\\|\\boldsymbol{u}^*\\|^2 = \\langle \\boldsymbol{u}^{n+1} + \\nabla_h \\phi, \\boldsymbol{u}^{n+1} + \\nabla_h \\phi \\rangle = \\|\\boldsymbol{u}^{n+1}\\|^2 + 2\\langle\\boldsymbol{u}^{n+1}, \\nabla_h \\phi\\rangle + \\|\\nabla_h \\phi\\|^2\n$$\nThe crucial step is to analyze the cross-term $\\langle\\boldsymbol{u}^{n+1}, \\nabla_h \\phi\\rangle$. Using the property of summation by parts, which is the discrete analogue of integration by parts, and assuming compatible finite difference operators for the gradient ($\\nabla_h$) and divergence ($\\nabla_h \\cdot$), the inner product can be rewritten. For discrete operators satisfying the negative adjoint relationship $\\langle \\boldsymbol{v}, \\nabla_h \\psi \\rangle = -\\langle \\nabla_h \\cdot \\boldsymbol{v}, \\psi \\rangle$ (with boundary terms vanishing under appropriate conditions), we have:\n$$\n\\langle\\boldsymbol{u}^{n+1}, \\nabla_h \\phi\\rangle = -\\langle\\nabla_h \\cdot \\boldsymbol{u}^{n+1}, \\phi\\rangle\n$$\nBy the definition of the projection, the resulting velocity field $\\boldsymbol{u}^{n+1}$ is discretely divergence-free, so $\\nabla_h \\cdot \\boldsymbol{u}^{n+1} = 0$. Consequently, the inner product is zero:\n$$\n\\langle\\boldsymbol{u}^{n+1}, \\nabla_h \\phi\\rangle = 0\n$$\nThis demonstrates that the space of discrete divergence-free fields and the space of discrete gradient fields are orthogonal under this inner product. The decomposition is orthogonal.\nSubstituting this result back into the expression for $\\|\\boldsymbol{u}^*\\|^2$ gives:\n$$\n\\|\\boldsymbol{u}^*\\|^2 = \\|\\boldsymbol{u}^{n+1}\\|^2 + \\|\\nabla_h \\phi\\|^2\n$$\nThis is a discrete form of the Pythagorean theorem. Since the squared norm $\\|\\nabla_h \\phi\\|^2$ is non-negative, it follows directly that:\n$$\n\\|\\boldsymbol{u}^{n+1}\\|^2 \\leq \\|\\boldsymbol{u}^*\\|^2\n$$\nTaking the square root of both sides, we find $\\|\\boldsymbol{u}^{n+1}\\|_2 \\leq \\|\\boldsymbol{u}^*\\|_2$. This confirms that the projection step is non-expansive. It does not amplify the norm of the velocity field. Therefore, the stability of the overall scheme is governed solely by the explicit viscous (and advective, if present) updates, and the projection step does not impose any additional, more restrictive stability constraint.\n\nFinal Calculation\n\nWe are asked to compute the maximum stable time step $\\Delta t_{max}$ for the given parameters. The formula is:\n$$\n\\Delta t_{max} = \\frac{1}{2\\nu\\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2}\\right)}\n$$\nThe given values are $L = 0.1\\,\\mathrm{m}$, $N_x = 128$, $N_y = 64$, and $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^2/s}$.\nFirst, we compute the grid spacings:\n$$\n\\Delta x = \\frac{L}{N_x} = \\frac{0.1\\,\\mathrm{m}}{128}\n$$\n$$\n\\Delta y = \\frac{L}{N_y} = \\frac{0.1\\,\\mathrm{m}}{64}\n$$\nNext, we calculate the inverse squared spacings:\n$$\n\\frac{1}{\\Delta x^2} = \\left(\\frac{128}{0.1}\\right)^2 = 1280^2 = 1,638,400\\,\\mathrm{m}^{-2}\n$$\n$$\n\\frac{1}{\\Delta y^2} = \\left(\\frac{64}{0.1}\\right)^2 = 640^2 = 409,600\\,\\mathrm{m}^{-2}\n$$\nThe sum is:\n$$\n\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} = 1,638,400 + 409,600 = 2,048,000\\,\\mathrm{m}^{-2}\n$$\nNow, we substitute this into the stability formula:\n$$\n\\Delta t_{max} = \\frac{1}{2(1.0 \\times 10^{-6}\\,\\mathrm{m^2/s})(2,048,000\\,\\mathrm{m}^{-2})} = \\frac{1}{2 \\times 10^{-6} \\times 2.048 \\times 10^{6}\\,\\mathrm{s}^{-1}} = \\frac{1}{4.096\\,\\mathrm{s}^{-1}}\n$$\nPerforming the final division:\n$$\n\\Delta t_{max} = 0.244140625\\,\\mathrm{s}\n$$\nRounding to four significant figures as requested, we obtain:\n$$\n\\Delta t_{max} \\approx 0.2441\\,\\mathrm{s}\n$$", "answer": "$$\\boxed{0.2441}$$", "id": "3340070"}, {"introduction": "While the streamfunction-vorticity formulation simplifies the incompressible Navier-Stokes equations, it introduces the challenge of specifying vorticity at solid boundaries. This practice guides you through the construction of a second-order accurate wall vorticity condition, a classic technique essential for high-fidelity simulations [@problem_id:3340086]. Mastering this derivation reveals the critical link between numerical boundary conditions and the accurate prediction of physical quantities like wall shear stress.", "problem": "Consider the two-dimensional incompressible lid-driven cavity in a square domain of height $H$, discretized on a uniform Cartesian mesh of spacing $h$ in both directions. Use the streamfunction–vorticity formulation of the incompressible Navier–Stokes equations, where the streamfunction $\\psi(x,y)$ satisfies the kinematic relations $u = \\partial \\psi / \\partial y$ and $v = - \\partial \\psi / \\partial x$, and the scalar vorticity $\\omega(x,y)$ is defined by $\\omega = \\partial v / \\partial x - \\partial u / \\partial y$. The streamfunction–vorticity kinematic constraint is $\\nabla^{2} \\psi = - \\omega$, which holds in the entire domain. On all solid walls, the no-penetration condition implies that the streamfunction is constant along the wall; take $\\psi = \\psi_{w}$ on the top lid $y = H$. The top lid moves with a constant tangential velocity $U$ in the $x$-direction, so that $u(x,H) = U$ and $v(x,H) = 0$.\n\nLet $j$ index grid lines in the $y$-direction, with $j = N$ denoting the top wall at $y = H$, $j = N - 1$ the first interior line at $y = H - h$, and $j = N - 2$ the second interior line at $y = H - 2h$. Similarly, let $i$ index grid lines in the $x$-direction. Denote $\\psi_{i,N} = \\psi(x_{i},H)$, $\\psi_{i,N-1} = \\psi(x_{i},H-h)$, and $\\psi_{i,N-2} = \\psi(x_{i},H-2h)$.\n\nStarting from the fundamental definitions above and using Taylor expansions in the wall-normal direction about $y = H$, construct a second-order accurate discrete boundary condition for the top-wall vorticity $\\omega_{i,N} = \\omega(x_{i},H)$ in terms of the quantities $\\psi_{i,N}$, $\\psi_{i,N-1}$, $\\psi_{i,N-2}$, the grid spacing $h$, and the lid speed $U$. Your construction must:\n\n- Use only the definitions $u = \\partial \\psi / \\partial y$, $v = - \\partial \\psi / \\partial x$, $\\omega = \\partial v / \\partial x - \\partial u / \\partial y$, and $\\nabla^{2} \\psi = - \\omega$, together with smoothness (existence of the required derivatives).\n- Enforce consistency to second order in $h$ by explicitly canceling all terms up to order $h$ in the Taylor series remainder for the wall-normal expansion.\n- Explain why $\\psi_{xx}(x,H) = 0$ under no-penetration on the top wall and how this simplifies the relation between $\\omega$ and $\\psi$ at the wall.\n\nThen, analyze the stability and impact of your boundary condition on the computed near-wall vorticity by addressing the following points from first principles:\n\n- Consistency: Show that your boundary condition recovers the exact wall vorticity for any flow whose near-wall streamwise velocity $u(y)$ is linear in $y$ and for uniform lid motion $u(x,H) = U$, $v(x,H) = 0$.\n- Stability: Argue, using an energy or enstrophy-based reasoning for viscous flows, why a boundary condition that is a second-order accurate approximation of $\\omega(x_{i},H) = - \\partial^{2} \\psi / \\partial y^{2}(x_{i},H)$ does not inject spurious enstrophy at the wall in a semi-discrete diffusion-dominated regime, and thus is non-destabilizing relative to a first-order wall vorticity approximation.\n- Near-wall impact: Explain how increasing the order of accuracy in the wall vorticity condition changes the leading-order truncation error and the qualitative behavior of computed vorticity gradients near the lid, particularly in mitigating overshoot or undershoot adjacent to the moving wall and improving the accuracy of shear stress $\\tau_{w} = \\mu \\, \\partial u / \\partial y$.\n\nExpress your final answer as a single, closed-form analytic expression for $\\omega_{i,N}$ in terms of $\\psi_{i,N}$, $\\psi_{i,N-1}$, $\\psi_{i,N-2}$, $h$, and $U$. No numerical evaluation is required, and no units should be included in the final expression.", "solution": "The objective is to derive a second-order accurate finite difference boundary condition for vorticity $\\omega$ on the moving top lid of a square cavity. The derivation will be based on the streamfunction-vorticity formulation of the incompressible Navier-Stokes equations.\n\nThe governing equations and definitions are:\n- Kinematic relations: $u = \\frac{\\partial \\psi}{\\partial y}$ and $v = -\\frac{\\partial \\psi}{\\partial x}$.\n- Vorticity definition: $\\omega = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$.\n- Streamfunction-vorticity equation: $\\nabla^{2} \\psi = \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} = -\\omega$.\n\nThis final equation, the Poisson equation for the streamfunction $\\psi$, holds everywhere in the domain, including on its boundaries. At any point $(x_i, H)$ on the top wall (indexed by $j=N$), we have:\n$$\n\\omega(x_i, H) = -\\left( \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} \\right)\\bigg|_{y=H}\n$$\nWe denote wall quantities at a grid point $i$ as $\\omega_{i,N} = \\omega(x_i, H)$ and $\\psi_{i,N} = \\psi(x_i, H)$.\n\nFirst, we analyze the term $\\frac{\\partial^2 \\psi}{\\partial x^2}(x_i, H)$. The problem states the boundary conditions on the top lid are $u(x,H) = U$ and $v(x,H) = 0$. The no-penetration condition $v=0$ on the line $y=H$ implies:\n$$\nv(x,H) = -\\frac{\\partial \\psi}{\\partial x}(x,H) = 0\n$$\nThis equation holds for all $x$ along the lid. This means that $\\psi(x,H)$ is constant with respect to $x$. The problem statement confirms this by specifying $\\psi = \\psi_w$ on the top lid. Since $\\psi(x,H)$ does not vary with $x$, its first and second partial derivatives with respect to $x$ are zero:\n$$\n\\frac{\\partial \\psi}{\\partial x}(x,H) = 0 \\quad \\text{and} \\quad \\frac{\\partial^2 \\psi}{\\partial x^2}(x,H) = 0\n$$\nThis simplifies the relationship between vorticity and streamfunction at the top wall to:\n$$\n\\omega(x_i, H) = - \\frac{\\partial^2 \\psi}{\\partial y^2}(x_i, H) \\quad \\implies \\quad \\omega_{i,N} = -\\left(\\frac{\\partial^2 \\psi}{\\partial y^2}\\right)_{i,N}\n$$\nOur goal now is to find a second-order accurate finite difference approximation for $\\left(\\frac{\\partial^2 \\psi}{\\partial y^2}\\right)_{i,N}$ using values of $\\psi$ at grid points inside the domain ($j=N$, $j=N-1$, $j=N-2$) and the known velocity boundary condition.\n\nWe write Taylor series expansions for $\\psi$ at $y = H-h$ and $y = H-2h$ around the point $y=H$, for a fixed $x_i$:\n$$\n\\psi_{i,N-1} = \\psi(x_i, H-h) = \\psi_{i,N} - h \\left(\\frac{\\partial \\psi}{\\partial y}\\right)_{i,N} + \\frac{h^2}{2} \\left(\\frac{\\partial^2 \\psi}{\\partial y^2}\\right)_{i,N} - \\frac{h^3}{6} \\left(\\frac{\\partial^3 \\psi}{\\partial y^3}\\right)_{i,N} + O(h^4)\n$$\n$$\n\\psi_{i,N-2} = \\psi(x_i, H-2h) = \\psi_{i,N} - 2h \\left(\\frac{\\partial \\psi}{\\partial y}\\right)_{i,N} + \\frac{(2h)^2}{2} \\left(\\frac{\\partial^2 \\psi}{\\partial y^2}\\right)_{i,N} - \\frac{(2h)^3}{6} \\left(\\frac{\\partial^3 \\psi}{\\partial y^3}\\right)_{i,N} + O(h^4)\n$$\nThe boundary condition for the tangential velocity $u(x,H)=U$ gives us the first derivative of $\\psi$:\n$$\nu(x_i, H) = \\left(\\frac{\\partial \\psi}{\\partial y}\\right)_{i,N} = U\n$$\nSubstituting this and $\\omega_{i,N} = -(\\psi_{yy})_{i,N}$ into the expansions gives:\n$$\n(1) \\quad \\psi_{i,N-1} = \\psi_{i,N} - hU - \\frac{h^2}{2}\\omega_{i,N} - \\frac{h^3}{6}\\left(\\frac{\\partial^3 \\psi}{\\partial y^3}\\right)_{i,N} + O(h^4)\n$$\n$$\n(2) \\quad \\psi_{i,N-2} = \\psi_{i,N} - 2hU - 2h^2\\omega_{i,N} - \\frac{4h^3}{3}\\left(\\frac{\\partial^3 \\psi}{\\partial y^3}\\right)_{i,N} + O(h^4)\n$$\nWe seek an expression for $\\omega_{i,N}$ that is second-order accurate, which means its truncation error must be $O(h^2)$. To achieve this, we must eliminate the unknown third derivative term, $(\\psi_{yyy})_{i,N}$. We can do this by taking a linear combination of equations $(1)$ and $(2)$. To cancel the $h^3$ terms, we multiply equation $(1)$ by $8$ and subtract equation $(2)$:\n$$\n8\\psi_{i,N-1} - \\psi_{i,N-2} = 8\\left(\\psi_{i,N} - hU - \\frac{h^2}{2}\\omega_{i,N}\\right) - \\left(\\psi_{i,N} - 2hU - 2h^2\\omega_{i,N}\\right) + O(h^4)\n$$\nThe $O(h^3)$ term is $8(-\\frac{h^3}{6}) - (-\\frac{8h^3}{6}) = 0$, so it cancels as intended. Now, we simplify the remaining expression:\n$$\n8\\psi_{i,N-1} - \\psi_{i,N-2} = (8\\psi_{i,N} - \\psi_{i,N}) - (8hU - 2hU) - (4h^2\\omega_{i,N} - 2h^2\\omega_{i,N}) + O(h^4)\n$$\n$$\n8\\psi_{i,N-1} - \\psi_{i,N-2} = 7\\psi_{i,N} - 6hU - 2h^2\\omega_{i,N} + O(h^4)\n$$\nFinally, we solve for $\\omega_{i,N}$:\n$$\n2h^2\\omega_{i,N} = 7\\psi_{i,N} - 8\\psi_{i,N-1} + \\psi_{i,N-2} - 6hU + O(h^4)\n$$\n$$\n\\omega_{i,N} = \\frac{7\\psi_{i,N} - 8\\psi_{i,N-1} + \\psi_{i,N-2}}{2h^2} - \\frac{3U}{h} + O(h^2)\n$$\nThis provides the desired second-order accurate expression for the wall vorticity $\\omega_{i,N}$.\n\nNext, we address the required analysis points.\n\n- **Consistency**: To show consistency, we test the formula on a flow where the streamwise velocity is linear in the wall-normal coordinate, $u(y) = A(y-H) + U$. This satisfies $u(H)=U$. The vorticity for this profile is $\\omega = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} = 0 - A = -A$. We must verify that our formula for $\\omega_{i,N}$ yields this exact value.\nFirst, we find the corresponding streamfunction by integrating $u = \\partial\\psi/\\partial y$:\n$\\psi(y) = \\int (A(y-H) + U) dy = \\frac{A}{2}(y-H)^2 + Uy + C$.\nWe evaluate $\\psi$ at the grid points:\n$\\psi_{i,N} = \\psi(H) = UH+C$.\n$\\psi_{i,N-1} = \\psi(H-h) = \\frac{A}{2}(-h)^2 + U(H-h) + C = \\psi_{i,N} + \\frac{A}{2}h^2 - Uh$.\n$\\psi_{i,N-2} = \\psi(H-2h) = \\frac{A}{2}(-2h)^2 + U(H-2h) + C = \\psi_{i,N} + 2Ah^2 - 2Uh$.\nSubstituting these into our derived formula for $\\omega_{i,N}$:\n$$\n\\omega_{i,N} = \\frac{7\\psi_{i,N} - 8(\\psi_{i,N} + \\frac{A}{2}h^2 - Uh) + (\\psi_{i,N} + 2Ah^2 - 2Uh)}{2h^2} - \\frac{3U}{h}\n$$\nThe terms involving $\\psi_{i,N}$ cancel: $(7-8+1)\\psi_{i,N} = 0$. The remaining terms in the numerator are:\n$(-8)(\\frac{A}{2}h^2) + 2Ah^2 + (-8)(-Uh) - 2Uh = -4Ah^2 + 2Ah^2 + 8Uh - 2Uh = -2Ah^2 + 6Uh$.\nSo,\n$$\n\\omega_{i,N} = \\frac{-2Ah^2 + 6Uh}{2h^2} - \\frac{3U}{h} = -A + \\frac{3U}{h} - \\frac{3U}{h} = -A\n$$\nThis matches the exact vorticity $\\omega = -A$. Thus, the boundary condition is consistent and exact for flows with a locally linear velocity profile.\n\n- **Stability**: The stability of a numerical scheme for the vorticity transport equation, $\\frac{D\\omega}{Dt} = \\nu \\nabla^2\\omega$, is related to the behavior of the total enstrophy, $E = \\frac{1}{2}\\int \\omega^2 dA$. The time evolution of $E$ is given by $\\frac{dE}{dt} = \\nu \\oint_{\\partial \\Omega} \\omega \\frac{\\partial \\omega}{\\partial n} dS - \\nu \\int_\\Omega |\\nabla\\omega|^2 dA$. The first term represents enstrophy production at the boundary, while the second term represents viscous dissipation in the interior. Numerical instability can arise if the boundary condition introduces a spurious, non-physical source of enstrophy. The physical generation of vorticity at a no-slip wall is directly linked to the velocity gradients, summarized by the kinematic condition $\\omega = -\\psi_{yy}$ at the wall. A numerical boundary condition for $\\omega$ is an approximation of this physical link. A first-order accurate condition has a truncation error of $O(h)$, which acts as an artificial enstrophy source/sink of this order. If this artificial term is a source, it can pump non-physical energy into the simulation, causing instability. A second-order accurate approximation reduces this error to $O(h^2)$. By representing the physical mechanism of vorticity generation more faithfully, it drastically reduces the magnitude of the spurious enstrophy source at the boundary. This makes the scheme less prone to instability compared to a first-order scheme, as it adheres more closely to the physical energy (enstrophy) balance.\n\n- **Near-wall impact**: The order of accuracy of the wall vorticity condition has a profound impact on the quality of the numerical solution.\n    - **Truncation Error**: By increasing the order of accuracy from first, $O(h)$, to second, $O(h^2)$, the error in the computed wall vorticity decreases quadratically with grid refinement, rather than linearly. This allows for significantly more accurate results with fewer grid points.\n    - **Qualitative Behavior**: The flow near the moving lid is characterized by a thin shear layer with very high vorticity gradients. A lower-order boundary condition can introduce numerical oscillations (overshoot/undershoot) in the computed vorticity profile near the wall, failing to capture these gradients smoothly. The second-order condition provides a more accurate value for $\\omega_{i,N}$, which serves as a better Dirichlet condition for the vorticity transport equation solved in the interior. This leads to a smoother, more physically realistic vorticity field near the wall, mitigating the numerical artifacts common with lower-order schemes.\n    - **Shear Stress Accuracy**: The shear stress on the top wall is $\\tau_w = \\mu (\\partial u / \\partial y)|_{y=H}$. On the wall, we have $\\omega = \\partial v/\\partial x - \\partial u/\\partial y$. Since $v=0$ all along the wall, $\\partial v/\\partial x = 0$, which gives $\\omega|_{y=H} = -(\\partial u / \\partial y)|_{y=H}$. Therefore, the wall shear stress is directly proportional to the wall vorticity: $\\tau_w = -\\mu \\omega_w$. The accuracy of the computed shear stress, a quantity of great engineering importance, is thus determined entirely by the accuracy of the wall vorticity. A second-order accurate vorticity boundary condition yields a second-order accurate shear stress, a substantial improvement over the first-order accuracy provided by simpler schemes.", "answer": "$$ \\boxed{ \\frac{7\\psi_{i,N} - 8\\psi_{i,N-1} + \\psi_{i,N-2}}{2h^2} - \\frac{3U}{h} } $$", "id": "3340086"}, {"introduction": "In high-Reynolds number flows, the subtle errors of a numerical scheme can have profound physical consequences. This exercise uses modified equation analysis to reveal the \"hidden\" numerical diffusion within a first-order upwind scheme and quantifies its impact on enstrophy, a measure of small-scale vortical motion [@problem_id:3340106]. By connecting truncation error to the decay rate of a vortex, you will gain critical insight into how numerical methods can artificially damp turbulence, a key consideration for advanced flow simulation.", "problem": "Consider the two-dimensional incompressible lid-driven square cavity of side length $L$ with top-lid speed $U$, at high Reynolds number $Re = \\dfrac{U L}{\\nu}$, where $\\nu$ is the kinematic viscosity. Focus on enstrophy dynamics in the vorticity formulation of the Navier–Stokes equations. The vorticity equation in two dimensions is given by the transport-diffusion balance for the scalar vorticity field $\\omega(x,y,t)$, where the physical diffusion is negligible at high $Re$. In a Computational Fluid Dynamics (CFD) simulation, the advection of $\\omega$ is discretized by a forward Euler time integrator combined with a first-order upwind spatial discretization on a uniform Cartesian grid with $N \\times N$ points. Let the grid spacing be $\\Delta x = \\Delta y = L/N$, and the time step be chosen to satisfy a Courant–Friedrichs–Lewy (CFL) condition based on the lid speed, i.e., $\\Delta t = C \\, \\Delta x / U$ with $C = 0.6$. At the location of interest inside the cavity core, assume the local mean velocities are $u = 0.5 \\, U$ and $v = 0.5 \\, U$ in the $x$ and $y$ directions, respectively. As a representative small-scale vortical structure, model the local vorticity as a separable Fourier mode\n$$\n\\omega(x,y,t) = \\hat{\\omega}(t) \\cos(k x)\\cos(k y),\n$$\nwith wavenumber $k = \\dfrac{32 \\pi}{L}$, corresponding to a wavelength $\\lambda = \\dfrac{L}{16}$. Define the enstrophy as $E(t) = \\dfrac{1}{2}\\int \\omega^2 \\, \\mathrm{d}A$, and evaluate all area integrals over a local periodic patch so that boundary terms vanish.\n\nUsing only fundamental balances and a leading-order modified-equation analysis of the chosen numerical advection scheme, model the advection truncation error as an anisotropic Laplacian acting on $\\omega$, with directionally distinct effective coefficients that depend on $u$, $v$, $\\Delta x$, and $\\Delta t$. Derive the resulting enstrophy decay rate $\\gamma_{\\text{num}}$ defined by\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = - \\gamma_{\\text{num}} \\, E,\n$$\ndue solely to the scheme-induced numerical diffusion, and then compute its numerical value for the parameter set\n$$\nL = 0.1 \\ \\text{m}, \\quad U = 1.0 \\ \\text{m} \\, \\text{s}^{-1}, \\quad N = 256, \\quad C = 0.6, \\quad u = 0.5 \\, U, \\quad v = 0.5 \\, U.\n$$\n\nExpress the final $\\gamma_{\\text{num}}$ in $\\text{s}^{-1}$ and round your answer to four significant figures. Finally, interpret how the magnitude and $k$-dependence of your result relate to the damping of small-scale vortices at high $Re$ in the cavity, but report only the numerical value of $\\gamma_{\\text{num}}$ as your final answer.", "solution": "The problem requires the derivation of the enstrophy decay rate, $\\gamma_{\\text{num}}$, resulting from the numerical diffusion of a first-order upwind (FOU) scheme applied to the advection of a single vorticity mode.\n\nThe governing equation for vorticity, $\\omega$, in two-dimensional incompressible flow, neglecting physical viscosity, is the advection equation:\n$$\n\\frac{\\partial \\omega}{\\partial t} + u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} = 0\n$$\nThe problem specifies that this equation is discretized using a Forward Euler scheme in time and a first-order upwind scheme in space. Given the local velocities $u=0.5U>0$ and $v=0.5U>0$, the upwind scheme uses backward differences. The fully discrete equation at a grid point $(i,j)$ and time step $n$ is:\n$$\n\\frac{\\omega_{i,j}^{n+1} - \\omega_{i,j}^n}{\\Delta t} + u \\left( \\frac{\\omega_{i,j}^n - \\omega_{i-1,j}^n}{\\Delta x} \\right) + v \\left( \\frac{\\omega_{i,j}^n - \\omega_{i,j-1}^n}{\\Delta y} \\right) = 0\n$$\nwhere $\\Delta x = \\Delta y$ is the uniform grid spacing.\n\nTo find the effect of the discretization error, we perform a modified-equation analysis by expanding each term in a Taylor series around the point $(x_i, y_j, t_n)$.\nThe time derivative term is:\n$$\n\\frac{\\omega_{i,j}^{n+1} - \\omega_{i,j}^n}{\\Delta t} = \\frac{\\partial \\omega}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 \\omega}{\\partial t^2} + O(\\Delta t^2)\n$$\nThe spatial derivative terms are:\n$$\nu \\left( \\frac{\\omega_{i,j}^n - \\omega_{i-1,j}^n}{\\Delta x} \\right) = u \\left( \\frac{\\omega - (\\omega - \\Delta x \\frac{\\partial \\omega}{\\partial x} + \\frac{\\Delta x^2}{2} \\frac{\\partial^2 \\omega}{\\partial x^2} - \\dots)}{\\Delta x} \\right) = u \\frac{\\partial \\omega}{\\partial x} - \\frac{u \\Delta x}{2} \\frac{\\partial^2 \\omega}{\\partial x^2} + O(\\Delta x^2)\n$$\n$$\nv \\left( \\frac{\\omega_{i,j}^n - \\omega_{i,j-1}^n}{\\Delta y} \\right) = v \\left( \\frac{\\omega - (\\omega - \\Delta y \\frac{\\partial \\omega}{\\partial y} + \\frac{\\Delta y^2}{2} \\frac{\\partial^2 \\omega}{\\partial y^2} - \\dots)}{\\Delta y} \\right) = v \\frac{\\partial \\omega}{\\partial y} - \\frac{v \\Delta y}{2} \\frac{\\partial^2 \\omega}{\\partial y^2} + O(\\Delta y^2)\n$$\nSubstituting these into the discrete equation and rearranging gives the modified partial differential equation that the scheme actually solves:\n$$\n\\frac{\\partial \\omega}{\\partial t} + u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} = \\frac{u \\Delta x}{2} \\frac{\\partial^2 \\omega}{\\partial x^2} + \\frac{v \\Delta y}{2} \\frac{\\partial^2 \\omega}{\\partial y^2} - \\frac{\\Delta t}{2} \\frac{\\partial^2 \\omega}{\\partial t^2} + \\dots\n$$\nwhere the right-hand side represents the leading-order truncation error. To express the term $\\frac{\\partial^2 \\omega}{\\partial t^2}$ in terms of spatial derivatives, we can differentiate the original PDE, which to zeroth order is $\\frac{\\partial \\omega}{\\partial t} \\approx -u \\frac{\\partial \\omega}{\\partial x} - v \\frac{\\partial \\omega}{\\partial y}$. This leads to $\\frac{\\partial^2 \\omega}{\\partial t^2} \\approx u^2 \\frac{\\partial^2 \\omega}{\\partial x^2} + v^2 \\frac{\\partial^2 \\omega}{\\partial y^2} + 2uv \\frac{\\partial^2 \\omega}{\\partial x \\partial y}$. The modified equation becomes:\n$$\n\\frac{\\partial \\omega}{\\partial t} + u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} = \\left(\\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2}\\right) \\frac{\\partial^2 \\omega}{\\partial x^2} + \\left(\\frac{v \\Delta y}{2} - \\frac{v^2 \\Delta t}{2}\\right) \\frac{\\partial^2 \\omega}{\\partial y^2} - uv\\Delta t \\frac{\\partial^2 \\omega}{\\partial x \\partial y} + \\dots\n$$\nThe problem asks to model the truncation error as an anisotropic Laplacian, implying we consider the terms $\\nu_{\\text{num},x} \\frac{\\partial^2 \\omega}{\\partial x^2}$ and $\\nu_{\\text{num},y} \\frac{\\partial^2 \\omega}{\\partial y^2}$. Thus, the modified equation is modeled as:\n$$\n\\frac{\\partial \\omega}{\\partial t} + u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} = \\nu_{\\text{num},x} \\frac{\\partial^2 \\omega}{\\partial x^2} + \\nu_{\\text{num},y} \\frac{\\partial^2 \\omega}{\\partial y^2}\n$$\nwith direction-dependent numerical diffusion coefficients:\n$$\n\\nu_{\\text{num},x} = \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right), \\quad \\nu_{\\text{num},y} = \\frac{v \\Delta y}{2} \\left(1 - \\frac{v \\Delta t}{\\Delta y}\\right)\n$$\nSince $\\Delta x = \\Delta y$, these simplify to:\n$$\n\\nu_{\\text{num},x} = \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right), \\quad \\nu_{\\text{num},y} = \\frac{v \\Delta x}{2} \\left(1 - \\frac{v \\Delta t}{\\Delta x}\\right)\n$$\nThe enstrophy is defined as $E(t) = \\frac{1}{2} \\int_A \\omega^2 \\, \\mathrm{d}A$. Its time derivative is:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int_A \\omega \\frac{\\partial \\omega}{\\partial t} \\, \\mathrm{d}A\n$$\nSubstituting the modified equation for $\\frac{\\partial \\omega}{\\partial t}$:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int_A \\omega \\left(-u \\frac{\\partial \\omega}{\\partial x} - v \\frac{\\partial \\omega}{\\partial y} + \\nu_{\\text{num},x} \\frac{\\partial^2 \\omega}{\\partial x^2} + \\nu_{\\text{num},y} \\frac{\\partial^2 \\omega}{\\partial y^2} \\right) \\mathrm{d}A\n$$\nThe advection terms, $\\int \\omega u \\frac{\\partial \\omega}{\\partial x}$ and $\\int \\omega v \\frac{\\partial \\omega}{\\partial y}$, integrate to zero over the specified periodic patch. The remaining terms are handled by integration by parts (using the fact that boundary terms vanish for a periodic domain):\n$$\n\\int_A \\omega \\frac{\\partial^2 \\omega}{\\partial x^2} \\, \\mathrm{d}A = - \\int_A \\left(\\frac{\\partial \\omega}{\\partial x}\\right)^2 \\mathrm{d}A, \\quad \\int_A \\omega \\frac{\\partial^2 \\omega}{\\partial y^2} \\, \\mathrm{d}A = - \\int_A \\left(\\frac{\\partial \\omega}{\\partial y}\\right)^2 \\mathrm{d}A\n$$\nThus, the enstrophy evolution is governed by numerical dissipation:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = - \\nu_{\\text{num},x} \\int_A \\left(\\frac{\\partial \\omega}{\\partial x}\\right)^2 \\mathrm{d}A - \\nu_{\\text{num},y} \\int_A \\left(\\frac{\\partial \\omega}{\\partial y}\\right)^2 \\mathrm{d}A\n$$\nWe now substitute the given vorticity mode, $\\omega(x,y,t) = \\hat{\\omega}(t) \\cos(k x)\\cos(k y)$.\nThe enstrophy is $E(t) = \\frac{1}{2} \\hat{\\omega}(t)^2 \\int_A \\cos^2(kx)\\cos^2(ky) \\, \\mathrm{d}A$.\nThe spatial derivatives are $\\frac{\\partial \\omega}{\\partial x} = -k \\hat{\\omega} \\sin(kx)\\cos(ky)$ and $\\frac{\\partial \\omega}{\\partial y} = -k \\hat{\\omega} \\cos(kx)\\sin(ky)$.\nThe dissipation integrals are:\n$$\n\\int_A \\left(\\frac{\\partial \\omega}{\\partial x}\\right)^2 \\mathrm{d}A = k^2 \\hat{\\omega}^2 \\int_A \\sin^2(kx)\\cos^2(ky) \\, \\mathrm{d}A\n$$\n$$\n\\int_A \\left(\\frac{\\partial \\omega}{\\partial y}\\right)^2 \\mathrm{d}A = k^2 \\hat{\\omega}^2 \\int_A \\cos^2(kx)\\sin^2(ky) \\, \\mathrm{d}A\n$$\nFor a periodic domain, the spatial average of $\\cos^2(\\theta)$ and $\\sin^2(\\theta)$ is $\\frac{1}{2}$. Thus, the average of $\\cos^2(kx)\\cos^2(ky)$, $\\sin^2(kx)\\cos^2(ky)$, and $\\cos^2(kx)\\sin^2(ky)$ are all $\\frac{1}{4}$. Let the area of the patch be $A$.\n$E(t) = \\frac{1}{2} \\hat{\\omega}^2 \\frac{A}{4}$.\n$\\int_A (\\frac{\\partial \\omega}{\\partial x})^2 \\mathrm{d}A = k^2 \\hat{\\omega}^2 \\frac{A}{4}$.\n$\\int_A (\\frac{\\partial \\omega}{\\partial y})^2 \\mathrm{d}A = k^2 \\hat{\\omega}^2 \\frac{A}{4}$.\nSubstituting these into the enstrophy rate equation:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -(\\nu_{\\text{num},x} + \\nu_{\\text{num},y}) k^2 \\hat{\\omega}^2 \\frac{A}{4}\n$$\nWe can write $\\hat{\\omega}^2 \\frac{A}{4}$ in terms of enstrophy: from $E = \\frac{1}{2} \\hat{\\omega}^2 \\frac{A}{4}$, we get $\\hat{\\omega}^2 \\frac{A}{4} = 2E$.\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -2 k^2 (\\nu_{\\text{num},x} + \\nu_{\\text{num},y}) E\n$$\nBy definition, $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = - \\gamma_{\\text{num}} E$. Comparing these gives the decay rate:\n$$\n\\gamma_{\\text{num}} = 2 k^2 (\\nu_{\\text{num},x} + \\nu_{\\text{num},y}) = 2 k^2 \\left( \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right) + \\frac{v \\Delta x}{2} \\left(1 - \\frac{v \\Delta t}{\\Delta x}\\right) \\right)\n$$\n$$\n\\gamma_{\\text{num}} = k^2 \\Delta x \\left( u\\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right) + v\\left(1 - \\frac{v \\Delta t}{\\Delta x}\\right) \\right)\n$$\nNow we substitute the given numerical values:\n$L = 0.1 \\ \\text{m}$, $U = 1.0 \\ \\text{m} \\, \\text{s}^{-1}$, $N = 256$, $C = 0.6$.\n$u = 0.5 \\, U = 0.5 \\ \\text{m/s}$, $v = 0.5 \\, U = 0.5 \\ \\text{m/s}$.\n$k = \\frac{32 \\pi}{L} = \\frac{32 \\pi}{0.1} = 320 \\pi \\ \\text{m}^{-1}$.\n$\\Delta x = \\frac{L}{N} = \\frac{0.1}{256} \\ \\text{m}$.\n$\\Delta t = C \\frac{\\Delta x}{U} = 0.6 \\frac{0.1/256}{1.0} = \\frac{0.06}{256} \\ \\text{s}$.\nThe local Courant numbers are:\n$C_x = \\frac{u \\Delta t}{\\Delta x} = u \\frac{C/U}{1} = 0.5 \\times \\frac{0.6}{1.0} = 0.3$.\n$C_y = \\frac{v \\Delta t}{\\Delta x} = v \\frac{C/U}{1} = 0.5 \\times \\frac{0.6}{1.0} = 0.3$.\nSince $u=v$ and hence $C_x=C_y$, the expression for $\\gamma_{\\text{num}}$ simplifies:\n$$\n\\gamma_{\\text{num}} = k^2 \\Delta x \\left( 2u(1-C_x) \\right)\n$$\nSubstituting the values:\n$$\n\\gamma_{\\text{num}} = (320 \\pi)^2 \\left(\\frac{0.1}{256}\\right) \\left( 2 \\times 0.5 \\times (1-0.3) \\right)\n$$\n$$\n\\gamma_{\\text{num}} = 102400 \\pi^2 \\left(\\frac{0.1}{256}\\right) (1.0 \\times 0.7)\n$$\n$$\n\\gamma_{\\text{num}} = 102400 \\pi^2 \\left(\\frac{0.1}{256}\\right) (0.7)\n$$\nSimplify the numerical factors: $\\frac{102400}{256} = \\frac{1024 \\times 100}{256} = 4 \\times 100 = 400$.\n$$\n\\gamma_{\\text{num}} = 400 \\pi^2 \\times 0.1 \\times 0.7 = 40 \\pi^2 \\times 0.7 = 28 \\pi^2\n$$\nNow, we calculate the final numerical value:\n$$\n\\gamma_{\\text{num}} = 28 \\times (\\pi)^2 \\approx 28 \\times 9.8696044 \\approx 276.34892 \\ \\text{s}^{-1}\n$$\nRounding to four significant figures, we get $276.3$.", "answer": "$$\\boxed{276.3}$$", "id": "3340106"}]}