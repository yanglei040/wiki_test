{"hands_on_practices": [{"introduction": "To truly understand the Deferred Correction (DC) method, we must start with its fundamental building block: the calculation of a single face flux. This exercise guides you through the process of constructing both a low-order (upwind) flux and a high-order flux derived from polynomial interpolation. By calculating the correction term and the final blended flux, you will gain a concrete, numerical feel for how DC operates at the most granular level [@problem_id:3306429].", "problem": "Consider the one-dimensional steady pure convection of a passive scalar on a uniform grid within the Finite Volume Method (FVM). Let the convective velocity be constant and positive, so that the upwind cell for the face between control volumes at indices $i$ and $i+1$ is the cell $i$. Assume non-dimensionalization such that the product of density and face area is unity, so that the face convective flux equals velocity times the advected value. You are to apply the Deferred Correction (DC) framework to construct a higher-order face flux at the face $i+1/2$.\n\nStart from the integral conservation law over a control volume and the definition of the convective face flux as the product of normal velocity and the face value of the scalar. For the low-order (LO) scheme, use first-order upwind for positive velocity. For the high-order (HO) scheme, do not assume any pre-given formula; instead, construct the face value by fitting a cubic polynomial through the scalar values at four consecutive cell centers $x_{i-1}$, $x_{i}$, $x_{i+1}$, and $x_{i+2}$ on a uniform grid, and then evaluate this polynomial at the face location $x_{i+1/2}$. Use this to obtain the high-order face flux.\n\nIn the DC framework, assemble the low-order contribution implicitly and add a fraction of the high-order correction explicitly to the right-hand side. Let the DC blending factor be $\\alpha = 0.8$.\n\nGiven the discrete scalar values $\\phi_{i-1} = 2$, $\\phi_{i} = 3$, $\\phi_{i+1} = 5$, and $\\phi_{i+2} = 7$, and a positive velocity $u = 2.4$, perform the following:\n\n- Derive and evaluate the low-order face flux $F^{LO}_{i+1/2}$, the high-order face flux $F^{HO}_{i+1/2}$, and the deferred correction $\\delta F_{i+1/2} = F^{HO}_{i+1/2} - F^{LO}_{i+1/2}$.\n- State clearly which part is assembled implicitly and which part is added explicitly in DC, and compute their numerical values for the given data.\n- Compute the final deferred-corrected face flux $F^{DC}_{i+1/2} = F^{LO}_{i+1/2} + \\alpha\\,\\delta F_{i+1/2}$.\n\nReport as your final answer the single number $F^{DC}_{i+1/2}$. Round your answer to $4$ significant figures. Since the flux is non-dimensionalized as described, do not include units in your final answer.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary data and definitions are provided for a unique solution. We may proceed with the solution.\n\nThe problem considers the one-dimensional steady pure convection of a passive scalar $\\phi$, governed by the conservation law:\n$$\n\\frac{d}{dx}(\\rho u \\phi) = 0\n$$\nIn the Finite Volume Method (FVM), this equation is integrated over a control volume (CV) from face $i-1/2$ to face $i+1/2$, yielding:\n$$\n(\\rho u A \\phi)_{i+1/2} - (\\rho u A \\phi)_{i-1/2} = 0\n$$\nwhere $A$ is the face area. The problem states that the product of density $\\rho$ and face area $A$ is unity, and the velocity $u$ is constant. The convective flux across a face is thus $F = u\\phi$. For the control volume $i$, the discretized equation is:\n$$\nF_{i+1/2} - F_{i-1/2} = 0\n$$\nWe are asked to compute the flux $F_{i+1/2}$ at the face between cells $i$ and $i+1$ using the Deferred Correction (DC) framework. The given data are the velocity $u = 2.4$ (positive) and the cell-centered scalar values $\\phi_{i-1} = 2$, $\\phi_{i} = 3$, $\\phi_{i+1} = 5$, and $\\phi_{i+2} = 7$. The DC blending factor is $\\alpha = 0.8$.\n\nFirst, we determine the low-order (LO) face flux, $F^{LO}_{i+1/2}$. The problem specifies a first-order upwind scheme. Since the velocity $u$ is positive, the flow is from left to right, and the upwind cell for face $i+1/2$ is cell $i$. Thus, the scalar value at the face is taken from the upwind cell center:\n$$\n\\phi^{LO}_{i+1/2} = \\phi_i\n$$\nThe low-order flux is then:\n$$\nF^{LO}_{i+1/2} = u \\cdot \\phi^{LO}_{i+1/2} = u \\phi_i\n$$\nSubstituting the given numerical values:\n$$\nF^{LO}_{i+1/2} = (2.4)(3) = 7.2\n$$\n\nNext, we determine the high-order (HO) face flux, $F^{HO}_{i+1/2}$. This requires finding the face value $\\phi^{HO}_{i+1/2}$ by fitting a cubic polynomial through the scalar values at the four cell centers $x_{i-1}$, $x_i$, $x_{i+1}$, and $x_{i+2}$, and then evaluating this polynomial at the face location $x_{i+1/2}$.\n\nLet's define a local coordinate system $\\xi$ centered at $x_i$ and scaled by the uniform grid spacing $\\Delta x$: $\\xi = (x - x_i) / \\Delta x$. The cell centers are located at $\\xi_{i-1}=-1$, $\\xi_i=0$, $\\xi_{i+1}=1$, and $\\xi_{i+2}=2$. The face $i+1/2$ is located at $x_{i+1/2} = x_i + \\Delta x/2$, which corresponds to $\\xi_{i+1/2} = 1/2$.\n\nWe use Lagrange interpolation to find the value of the polynomial at $\\xi = 1/2$. The interpolated value is a linear combination of the nodal values:\n$$\n\\phi^{HO}_{i+1/2} = L_{i-1}(1/2)\\phi_{i-1} + L_i(1/2)\\phi_i + L_{i+1}(1/2)\\phi_{i+1} + L_{i+2}(1/2)\\phi_{i+2}\n$$\nThe Lagrange basis polynomials $L_k(\\xi)$ are calculated at $\\xi=1/2$ for the nodes $\\{-1, 0, 1, 2\\}$:\n$$\nL_{i-1}(1/2) = \\frac{(1/2 - 0)(1/2 - 1)(1/2 - 2)}{(-1 - 0)(-1 - 1)(-1 - 2)} = \\frac{(1/2)(-1/2)(-3/2)}{(-1)(-2)(-3)} = \\frac{3/8}{-6} = -\\frac{1}{16}\n$$\n$$\nL_i(1/2) = \\frac{(1/2 - (-1))(1/2 - 1)(1/2 - 2)}{(0 - (-1))(0 - 1)(0 - 2)} = \\frac{(3/2)(-1/2)(-3/2)}{(1)(-1)(-2)} = \\frac{9/8}{2} = \\frac{9}{16}\n$$\n$$\nL_{i+1}(1/2) = \\frac{(1/2 - (-1))(1/2 - 0)(1/2 - 2)}{(1 - (-1))(1 - 0)(1 - 2)} = \\frac{(3/2)(1/2)(-3/2)}{(2)(1)(-1)} = \\frac{-9/8}{-2} = \\frac{9}{16}\n$$\n$$\nL_{i+2}(1/2) = \\frac{(1/2 - (-1))(1/2 - 0)(1/2 - 1)}{(2 - (-1))(2 - 0)(2 - 1)} = \\frac{(3/2)(1/2)(-1/2)}{(3)(2)(1)} = \\frac{-3/8}{6} = -\\frac{1}{16}\n$$\nThe sum of the coefficients is $-1/16 + 9/16 + 9/16 - 1/16 = 16/16 = 1$, as expected.\n\nNow, we substitute the given scalar values to find $\\phi^{HO}_{i+1/2}$:\n$$\n\\phi^{HO}_{i+1/2} = -\\frac{1}{16}\\phi_{i-1} + \\frac{9}{16}\\phi_i + \\frac{9}{16}\\phi_{i+1} - \\frac{1}{16}\\phi_{i+2}\n$$\n$$\n\\phi^{HO}_{i+1/2} = \\frac{1}{16}[-1(2) + 9(3) + 9(5) - 1(7)] = \\frac{1}{16}[-2 + 27 + 45 - 7] = \\frac{63}{16} = 3.9375\n$$\nThe high-order flux is then:\n$$\nF^{HO}_{i+1/2} = u \\cdot \\phi^{HO}_{i+1/2} = (2.4)\\left(\\frac{63}{16}\\right) = \\left(\\frac{12}{5}\\right)\\left(\\frac{63}{16}\\right) = \\left(\\frac{3}{5}\\right)\\left(\\frac{63}{4}\\right) = \\frac{189}{20} = 9.45\n$$\nThe deferred correction term, $\\delta F_{i+1/2}$, is the difference between the high-order and low-order fluxes:\n$$\n\\delta F_{i+1/2} = F^{HO}_{i+1/2} - F^{LO}_{i+1/2} = 9.45 - 7.2 = 2.25\n$$\n\nIn the Deferred Correction framework, the total flux is modeled as $F = F^{LO} + \\text{correction}$. The low-order flux term $F^{LO}$ is treated implicitly, meaning it depends on the unknown solution variables and contributes to the main diagonal and off-diagonal elements of the system matrix. The correction term is treated explicitly, meaning it is calculated from known values (e.g., from the previous iteration) and moved to the right-hand side (source term) of the algebraic system.\nThe problem states that a fraction $\\alpha$ of the high-order correction is added. Thus, the flux is decomposed as:\n$$\nF_{i+1/2} = \\underbrace{F^{LO}_{i+1/2}}_{\\text{implicit}} + \\underbrace{\\alpha(F^{HO}_{i+1/2} - F^{LO}_{i+1/2})}_{\\text{explicit}} = \\underbrace{F^{LO}_{i+1/2}}_{\\text{implicit}} + \\underbrace{\\alpha\\,\\delta F_{i+1/2}}_{\\text{explicit}}\n$$\nThe part assembled implicitly for face $i+1/2$ is $F^{LO}_{i+1/2} = 7.2$.\nThe part added explicitly to the source term is $\\alpha\\,\\delta F_{i+1/2}$. Its numerical value is:\n$$\n\\alpha\\,\\delta F_{i+1/2} = (0.8)(2.25) = 1.8\n$$\nNote that this term contributes with a negative sign to the source term of cell $i$ and a positive sign to the source term of cell $i+1$.\n\nFinally, we compute the total deferred-corrected face flux, $F^{DC}_{i+1/2}$:\n$$\nF^{DC}_{i+1/2} = F^{LO}_{i+1/2} + \\alpha\\,\\delta F_{i+1/2} = 7.2 + 1.8 = 9.0\n$$\nThe problem requires the answer to be rounded to $4$ significant figures. Therefore, $9.0$ is written as $9.000$.", "answer": "$$\n\\boxed{9.000}\n$$", "id": "3306429"}, {"introduction": "After mastering the calculation of individual face fluxes, the next step is to integrate them into the finite volume conservation law for a cell. This practice demonstrates how the flux differences from the DC approach are assembled into an explicit source term on the right-hand side of the discretized equations. By working through a small, periodic domain, you will also verify that this correction is conservative, a critical property for any valid numerical flux scheme [@problem_id:3306397].", "problem": "Consider one-dimensional steady linear advection of a dimensionless passive scalar $\\phi$ with a constant, positive, non-dimensional velocity $u>0$ on a periodic domain discretized by the finite-volume method into three uniform control volumes indexed by $i\\in\\{1,2,3\\}$. The face areas, cell widths, and density have all been non-dimensionalized to unity, so that the convective flux through a face equals $u$ times the face-interpolated value of $\\phi$. Let the cell-centered values be $\\phi=\\left[1,2,3\\right]$, with periodic indexing, so that $\\phi_{0}=\\phi_{3}$, $\\phi_{4}=\\phi_{1}$, and $\\phi_{-1}=\\phi_{2}$.\n\nTo obtain higher-order convection while preserving robustness, employ the Deferred Correction (DC) strategy: treat a first-order upwind discretization of the convective operator implicitly, and move the difference between a higher-order and the low-order convective flux to the right-hand side as a source term. Using DC with coefficient $\\alpha=1$, the right-hand side correction for cell $i$ is\n$$\nb_{i} \\;=\\; \\frac{\\alpha}{\\Delta x}\\left(\\Delta F_{i-\\frac{1}{2}} - \\Delta F_{i+\\frac{1}{2}}\\right),\n$$\nwhere $\\Delta F_{i\\pm\\frac{1}{2}}$ is the difference between the higher-order and the upwind flux at the corresponding face, and $\\Delta x=1$ by non-dimensionalization.\n\nFor $u>0$ on a uniform grid, the first-order upwind face values are\n$$\n\\phi_{i+\\frac{1}{2}}^{\\text{UW}}=\\phi_{i}, \\qquad \\phi_{i-\\frac{1}{2}}^{\\text{UW}}=\\phi_{i-1}.\n$$\nAdopt Quadratic Upwind Interpolation for Convective Kinematics (QUICK) for the higher-order face interpolation. On a uniform grid with $u>0$, QUICK gives\n$$\n\\phi_{i+\\frac{1}{2}}^{\\text{QUICK}}=\\frac{3}{8}\\,\\phi_{i+1}+\\frac{6}{8}\\,\\phi_{i}-\\frac{1}{8}\\,\\phi_{i-1}, \\qquad\n\\phi_{i-\\frac{1}{2}}^{\\text{QUICK}}=\\frac{3}{8}\\,\\phi_{i}+\\frac{6}{8}\\,\\phi_{i-1}-\\frac{1}{8}\\,\\phi_{i-2}.\n$$\nWith these definitions, explicitly compute the DC right-hand side vector $b=\\left[b_{1},\\,b_{2},\\,b_{3}\\right]$ for the given $\\phi$ and $u>0$. Demonstrate the net conservation of the correction by verifying that the sum of the three components of $b$ is zero. Express your final answer as a single row matrix in terms of $u$ using the LaTeX $\\mathrm{pmatrix}$ environment. No numerical rounding is required, and no units should be included in the final expression.", "solution": "The problem requires the computation of the Deferred Correction (DC) source term vector, $b = [b_1, b_2, b_3]$, for a one-dimensional steady linear advection problem on a periodic three-cell domain. The solution will proceed by first establishing the general formulas for the correction terms and then applying them to the specific cell-centered data provided.\n\nThe DC source term for a given cell $i$ is defined as:\n$$\nb_i = \\frac{\\alpha}{\\Delta x} \\left( \\Delta F_{i-\\frac{1}{2}} - \\Delta F_{i+\\frac{1}{2}} \\right)\n$$\nAccording to the problem statement, the DC coefficient is $\\alpha=1$ and the non-dimensional cell width is $\\Delta x=1$. Therefore, the expression simplifies to:\n$$\nb_i = \\Delta F_{i-\\frac{1}{2}} - \\Delta F_{i+\\frac{1}{2}}\n$$\nThe term $\\Delta F_{i\\pm\\frac{1}{2}}$ represents the difference between the higher-order (QUICK) and lower-order (Upwind) convective fluxes at the cell faces $i\\pm\\frac{1}{2}$. Since the convective flux is given by the product of velocity $u$ and the face-interpolated scalar value $\\phi$, we have:\n$$\n\\Delta F_{f} = F_{f}^{\\text{QUICK}} - F_{f}^{\\text{UW}} = u \\phi_{f}^{\\text{QUICK}} - u \\phi_{f}^{\\text{UW}} = u \\left( \\phi_{f}^{\\text{QUICK}} - \\phi_{f}^{\\text{UW}} \\right)\n$$\nwhere $f$ denotes a generic face. Let's define the difference in the interpolated face values as $\\Delta \\phi_f = \\phi_{f}^{\\text{QUICK}} - \\phi_{f}^{\\text{UW}}$.\n\nFor a constant positive velocity $u>0$, the first-order upwind scheme gives the face value as the cell-centered value from the upwind direction. For the face $i+\\frac{1}{2}$, the upwind cell is $i$. Thus:\n$$\n\\phi_{i+\\frac{1}{2}}^{\\text{UW}} = \\phi_i\n$$\nThe higher-order QUICK scheme value at the same face is given as:\n$$\n\\phi_{i+\\frac{1}{2}}^{\\text{QUICK}} = \\frac{3}{8}\\phi_{i+1} + \\frac{6}{8}\\phi_i - \\frac{1}{8}\\phi_{i-1}\n$$\nThe difference in face values $\\Delta\\phi_{i+\\frac{1}{2}}$ is therefore:\n$$\n\\Delta\\phi_{i+\\frac{1}{2}} = \\left( \\frac{3}{8}\\phi_{i+1} + \\frac{6}{8}\\phi_i - \\frac{1}{8}\\phi_{i-1} \\right) - \\phi_i = \\frac{3}{8}\\phi_{i+1} - \\frac{2}{8}\\phi_i - \\frac{1}{8}\\phi_{i-1} = \\frac{1}{8} \\left( 3\\phi_{i+1} - 2\\phi_i - \\phi_{i-1} \\right)\n$$\nConsequently, the flux difference at face $i+\\frac{1}{2}$ is:\n$$\n\\Delta F_{i+\\frac{1}{2}} = \\frac{u}{8} \\left( 3\\phi_{i+1} - 2\\phi_i - \\phi_{i-1} \\right)\n$$\nWe are given the cell-centered values $\\phi_1=1$, $\\phi_2=2$, and $\\phi_3=3$. The domain is periodic with $3$ cells, which implies the following index mapping: $\\phi_0 = \\phi_3$, $\\phi_4 = \\phi_1$, and $\\phi_{-1} = \\phi_2$.\nSubstituting the known values:\n$\\phi_0 = 3$\n$\\phi_4 = 1$\n$\\phi_{-1} = 2$\n\nWe now compute the flux differences $\\Delta F_f$ for the faces of the three cells: $f = \\frac{1}{2}$, $\\frac{3}{2}$, $\\frac{5}{2}$. Note that due to periodicity, face $\\frac{7}{2}$ is identical to face $\\frac{1}{2}$.\n\nFor face $i+\\frac{1}{2} = \\frac{3}{2}$ (between cells $1$ and $2$), we set $i=1$:\n$$\n\\Delta F_{\\frac{3}{2}} = \\frac{u}{8} (3\\phi_2 - 2\\phi_1 - \\phi_0) = \\frac{u}{8} (3(2) - 2(1) - 3) = \\frac{u}{8} (6 - 2 - 3) = \\frac{u}{8}\n$$\n\nFor face $i+\\frac{1}{2} = \\frac{5}{2}$ (between cells $2$ and $3$), we set $i=2$:\n$$\n\\Delta F_{\\frac{5}{2}} = \\frac{u}{8} (3\\phi_3 - 2\\phi_2 - \\phi_1) = \\frac{u}{8} (3(3) - 2(2) - 1) = \\frac{u}{8} (9 - 4 - 1) = \\frac{4u}{8} = \\frac{u}{2}\n$$\n\nFor face $i+\\frac{1}{2} = \\frac{1}{2}$ (between cells $3$ and $1$), we can set $i=0$ for convenience, or use the periodicity rule that this is the same as face $\\frac{7}{2}$ where $i=3$:\n$$\n\\Delta F_{\\frac{1}{2}} = \\Delta F_{\\frac{7}{2}} = \\frac{u}{8} (3\\phi_4 - 2\\phi_3 - \\phi_2) = \\frac{u}{8} (3(1) - 2(3) - 2) = \\frac{u}{8} (3 - 6 - 2) = -\\frac{5u}{8}\n$$\n\nWith the flux differences calculated, we can now find the components of the source vector $b$:\n\nFor cell $i=1$:\n$$\nb_1 = \\Delta F_{1-\\frac{1}{2}} - \\Delta F_{1+\\frac{1}{2}} = \\Delta F_{\\frac{1}{2}} - \\Delta F_{\\frac{3}{2}} = -\\frac{5u}{8} - \\frac{u}{8} = -\\frac{6u}{8} = -\\frac{3u}{4}\n$$\n\nFor cell $i=2$:\n$$\nb_2 = \\Delta F_{2-\\frac{1}{2}} - \\Delta F_{2+\\frac{1}{2}} = \\Delta F_{\\frac{3}{2}} - \\Delta F_{\\frac{5}{2}} = \\frac{u}{8} - \\frac{4u}{8} = -\\frac{3u}{8}\n$$\n\nFor cell $i=3$:\n$$\nb_3 = \\Delta F_{3-\\frac{1}{2}} - \\Delta F_{3+\\frac{1}{2}} = \\Delta F_{\\frac{5}{2}} - \\Delta F_{\\frac{7}{2}} = \\frac{4u}{8} - \\left(-\\frac{5u}{8}\\right) = \\frac{9u}{8}\n$$\n\nThe resulting Deferred Correction source term vector is $b = \\left[-\\frac{3u}{4}, -\\frac{3u}{8}, \\frac{9u}{8}\\right]$.\n\nFinally, we must verify that the net correction is conservative, which means the sum of its components over the domain must be zero.\n$$\n\\sum_{i=1}^{3} b_i = b_1 + b_2 + b_3 = \\left(-\\frac{3u}{4}\\right) + \\left(-\\frac{3u}{8}\\right) + \\left(\\frac{9u}{8}\\right)\n$$\nTo sum these terms, we use a common denominator of $8$:\n$$\n\\sum_{i=1}^{3} b_i = -\\frac{6u}{8} - \\frac{3u}{8} + \\frac{9u}{8} = \\frac{-6u - 3u + 9u}{8} = \\frac{0}{8} = 0\n$$\nThe sum is zero, confirming that the DC source term is conservative. This is an expected and required property for a flux-difference formulation on a periodic domain, as the sum $\\sum_{i=1}^N (\\Delta F_{i-1/2} - \\Delta F_{i+1/2})$ is a telescoping sum that evaluates to $\\Delta F_{1/2} - \\Delta F_{N+1/2}$, and periodicity dictates $\\Delta F_{N+1/2} = \\Delta F_{1/2}$.\n\nThe final answer is the vector $b=\\left[b_{1},\\,b_{2},\\,b_{3}\\right]$ expressed as a row matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{3u}{4}  -\\frac{3u}{8}  \\frac{9u}{8} \\end{pmatrix}}\n$$", "id": "3306397"}, {"introduction": "One of the primary motivations for using advanced convection schemes is to capture sharp features accurately, but this often introduces unphysical oscillations. This computational exercise tackles this central challenge, showing how the DC framework can be combined with a limiter to prevent such overshoots near discontinuities. By comparing a pure high-order scheme with a limited DC scheme, you will see firsthand how to achieve both high accuracy and physical realism in your simulations [@problem_id:3306443].", "problem": "Consider the one-dimensional linear advection equation for a passive scalar, expressed as $\\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x = 0$ over a uniform grid of $N$ finite-volume cells that partition the interval $[0,1]$ with cell width $\\Delta x = 1/N$. Assume a constant advection speed $u > 0$ and consider the nondimensional Courant number $C = u \\Delta t / \\Delta x$. All quantities in this problem are nondimensional, and no physical units are required. Use a cell-centered finite-volume formulation with explicit time stepping for one update from time level $n$ to $n+1$:\n$$\n\\phi_i^{n+1} = \\phi_i^n - C \\left( \\phi_{i+1/2}^n - \\phi_{i-1/2}^n \\right),\n$$\nwhere $\\phi_{i\\pm 1/2}^n$ are reconstructions of face values at cell interfaces. The following face reconstructions are considered:\n- First-order upwind (for $u>0$): $\\phi_{i+1/2}^n = \\phi_i^n$.\n- Quadratic Upwind Interpolation for Convective Kinematics (QUICK): for interior faces, $\\phi_{i+1/2}^n = - \\frac{1}{8} \\phi_{i-1}^n + \\frac{6}{8} \\phi_{i}^n + \\frac{3}{8} \\phi_{i+1}^n$.\n- Deferred Correction (DC): start from the first-order upwind flux and add a limited correction,\n$$\n\\phi_{i+1/2}^{n,\\mathrm{DC}} = \\phi_{i+1/2}^{n,\\mathrm{UP}} + \\alpha_{i+1/2} \\left( \\phi_{i+1/2}^{n,\\mathrm{QUICK}} - \\phi_{i+1/2}^{n,\\mathrm{UP}} \\right),\n$$\nwith a monotonicity-preserving limiter coefficient $\\alpha_{i+1/2} \\in [0,1]$ chosen to be zero at non-monotone regions and one otherwise. Specifically, set\n$$\n\\alpha_{i+1/2} = \n\\begin{cases}\n0,  (\\phi_{i+1}^n - \\phi_i^n)(\\phi_i^n - \\phi_{i-1}^n) \\le 0, \\\\\n1,  \\text{otherwise}.\n\\end{cases}\n$$\nUse inflow boundary at the left domain boundary $x=0$ with $\\phi_{\\mathrm{in}}$ prescribed, and outflow at the right boundary $x=1$ with upwind treatment. For QUICK faces adjacent to boundaries, use one-sided upwind as needed to avoid undefined stencils.\n\nConstruct a step-profile initial condition $\\phi(x,0)$ that transitions from $0$ to $1$ at a discontinuity location $x_0 \\in [0,1]$. Define the initial cell averages $\\phi_i^0$ as the average of the step function over each cell $[i \\Delta x, (i+1) \\Delta x]$:\n$$\n\\phi_i^0 = \n\\begin{cases}\n0,  (i+1)\\Delta x \\le x_0, \\\\\n1,  i \\Delta x \\ge x_0, \\\\\n\\frac{(i+1)\\Delta x - x_0}{\\Delta x},  \\text{otherwise}.\n\\end{cases}\n$$\nPerform one explicit update to compute $\\phi^{1}$ with the QUICK scheme and with the DC scheme. Define the overshoot amplitude as the amount by which the updated solution exceeds the maximum physical bound $1$:\n$$\n\\mathrm{overshoot} = \\max\\left(0, \\max_i \\phi_i^{1} - 1 \\right).\n$$\nYour task is to implement a complete program that:\n- Builds the initial condition for the specified $x_0$ values using the above cell-average definition (for the smooth test case, use $\\phi_i^0 = \\frac{1}{2} + \\frac{1}{2}\\sin(2\\pi x_i)$ with $x_i = (i + 1/2)\\Delta x$).\n- Advances one time step with the QUICK scheme and with the DC scheme using the limiter defined above.\n- Computes and reports the overshoot amplitude for each scheme.\n\nUse the following test suite to ensure coverage:\n- Test $1$ (discontinuity exactly at a face): $N=100$, $u=1$, $C=0.95$, $\\phi_{\\mathrm{in}}=0$, $x_0 = 0.5$.\n- Test $2$ (discontinuity strictly inside a cell): $N=100$, $u=1$, $C=0.95$, $\\phi_{\\mathrm{in}}=0$, $x_0 = 0.5 + \\Delta x/3$.\n- Test $3$ (discontinuity near inflow boundary): $N=100$, $u=1$, $C=0.95$, $\\phi_{\\mathrm{in}}=0$, $x_0 = \\Delta x/2$.\n- Test $4$ (smooth profile for comparison): $N=100$, $u=1$, $C=0.95$, $\\phi_{\\mathrm{in}} = \\frac{1}{2}$, $\\phi_i^0 = \\frac{1}{2} + \\frac{1}{2}\\sin(2\\pi x_i)$.\n\nFor each test case, compute two floats: the overshoot amplitude with QUICK and the overshoot amplitude with DC. Your program should produce a single line of output containing a nested list with two sublists, the first listing QUICK overshoot amplitudes for tests $1$ through $4$, and the second listing DC overshoot amplitudes for tests $1$ through $4$. For example, output format must be exactly of the form $[[q_1,q_2,q_3,q_4],[d_1,d_2,d_3,d_4]]$ with numerical values in place of $q_k$ and $d_k$.", "solution": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(N, u, C, phi_in, ic_type, ic_param=None):\n    \"\"\"\n    Runs a single test case for one time step and calculates overshoots.\n    \n    Args:\n        N (int): Number of cells.\n        u (float): Advection speed.\n        C (float): Courant number.\n        phi_in (float): Inflow boundary condition value.\n        ic_type (str): Type of initial condition ('step' or 'smooth').\n        ic_param (float, optional): Parameter for IC (e.g., x0 for step).\n        \n    Returns:\n        tuple: (overshoot_quick, overshoot_dc)\n    \"\"\"\n    dx = 1.0 / N\n    \n    # 1. Build Initial Condition\n    phi_0 = np.zeros(N)\n    if ic_type == 'step':\n        x0 = ic_param\n        # Vectorized implementation for setting up the step profile\n        cell_indices = np.arange(N)\n        cell_starts = cell_indices * dx\n        cell_ends = (cell_indices + 1) * dx\n        \n        phi_0[cell_ends = x0] = 0.0\n        phi_0[cell_starts >= x0] = 1.0\n        \n        mask_middle = (cell_starts  x0)  (cell_ends > x0)\n        phi_0[mask_middle] = (cell_ends[mask_middle] - x0) / dx\n        \n    elif ic_type == 'smooth':\n        x_c = (np.arange(N) + 0.5) * dx\n        phi_0 = 0.5 + 0.5 * np.sin(2 * np.pi * x_c)\n    \n    # --- Flux Calculation for QUICK Scheme ---\n    phi_f_Q = np.zeros(N + 1)\n    \n    # Boundary faces\n    phi_f_Q[0] = phi_in      # Inflow (face j=0)\n    phi_f_Q[N] = phi_0[N-1]  # Outflow (face j=N), upwind\n    \n    # Face j=1: QUICK stencil i-1=-1 is invalid, fallback to 1st order upwind\n    phi_f_Q[1] = phi_0[0]\n    \n    # Interior faces (j=2 to N-1) where QUICK stencil is valid.\n    # Formula for face i+1/2 (my face j=i+1) uses cells i-1, i, i+1.\n    # This is valid for cell index i = 1 to N-2, which corresponds to\n    # face index j = 2 to N-1.\n    i = np.arange(1, N-1)\n    # CORRECTED FORMULA for u>0\n    phi_f_Q[i+1] = (-1.0/8.0) * phi_0[i-1] + \\\n                   ( 6.0/8.0) * phi_0[i]   + \\\n                   ( 3.0/8.0) * phi_0[i+1]\n    \n    # Time-step for QUICK\n    phi_1_quick = phi_0 - C * (phi_f_Q[1:] - phi_f_Q[:-1])\n\n    # --- Flux Calculation for Deferred Correction (DC) Scheme ---\n    # a. Base first-order upwind fluxes\n    phi_f_UP = np.zeros(N + 1)\n    phi_f_UP[0] = phi_in\n    phi_f_UP[1:] = phi_0  # phi_f_UP[j] = phi_0[j-1] for j=1..N\n    \n    # b. Limiter coefficient alpha_lim\n    alpha_lim = np.zeros(N + 1)\n    # The limiter alpha_{i+1/2} (at face j=i+1) is based on monotonicity\n    # around cell i, using cells i-1, i, i+1.\n    # This is valid for cell index i = 1 to N-2 (faces j=2 to N-1).\n    i_alpha = np.arange(1, N-1)\n    grad_product = (phi_0[i_alpha+1] - phi_0[i_alpha]) * (phi_0[i_alpha] - phi_0[i_alpha-1])\n    # The result of this check at cell i is applied to face i+1/2 (j=i+1).\n    alpha_lim[i_alpha+1] = np.where(grad_product > 0, 1.0, 0.0)\n\n    # c. Compute DC fluxes\n    # Note: where QUICK defaulted to UP, the correction is zero.\n    correction = alpha_lim * (phi_f_Q - phi_f_UP)\n    phi_f_DC = phi_f_UP + correction\n    \n    # Time-step for DC\n    phi_1_dc = phi_0 - C * (phi_f_DC[1:] - phi_f_DC[:-1])\n    \n    # Calculate overshoots\n    max_bound = 1.0\n    overshoot_quick = max(0.0, np.max(phi_1_quick) - max_bound)\n    overshoot_dc = max(0.0, np.max(phi_1_dc) - max_bound)\n    \n    return overshoot_quick, overshoot_dc\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the results.\n    \"\"\"\n    N = 100\n    u = 1.0\n    C = 0.95\n    dx = 1.0 / N\n\n    test_cases = [\n        {'N': N, 'u': u, 'C': C, 'phi_in': 0.0, 'ic_type': 'step', 'ic_param': 0.5},\n        {'N': N, 'u': u, 'C': C, 'phi_in': 0.0, 'ic_type': 'step', 'ic_param': 0.5 + dx / 3.0},\n        {'N': N, 'u': u, 'C': C, 'phi_in': 0.0, 'ic_type': 'step', 'ic_param': dx / 2.0},\n        {'N': N, 'u': u, 'C': C, 'phi_in': 0.5, 'ic_type': 'smooth', 'ic_param': None}\n    ]\n\n    quick_results = []\n    dc_results = []\n\n    for case in test_cases:\n        overshoot_q, overshoot_d = run_case(**case)\n        quick_results.append(overshoot_q)\n        dc_results.append(overshoot_d)\n\n    q_str = ','.join(map(str, quick_results))\n    d_str = ','.join(map(str, dc_results))\n    \n    print(f\"[[{q_str}],[{d_str}]]\")\n\nsolve()\n```", "answer": "[[0.067421875,0.08272569444444444,0.0,0.0],[0.0,0.0,0.0,0.0]]", "id": "3306443"}]}