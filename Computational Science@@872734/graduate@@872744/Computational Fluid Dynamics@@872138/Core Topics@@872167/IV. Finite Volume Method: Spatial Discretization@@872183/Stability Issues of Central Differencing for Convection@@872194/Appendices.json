{"hands_on_practices": [{"introduction": "The Forward-in-Time, Central-in-Space (FTCS) method is often the first scheme students learn due to its simplicity. While stable for parabolic equations like the heat equation, its application to hyperbolic convection problems reveals a critical flaw. This exercise [@problem_id:3365211] guides you through a rigorous von Neumann stability analysis for the 2D linear advection equation, allowing you to derive the amplification factor and prove that this intuitive scheme is unconditionally unstable for pure convection.", "problem": "Consider the two-dimensional linear advection equation on a uniform Cartesian grid,\n$$\\partial_{t}\\phi(x,y,t) + a\\,\\partial_{x}\\phi(x,y,t) + b\\,\\partial_{y}\\phi(x,y,t) = 0,$$\nwhere $a$ and $b$ are constant advection velocities. Let the spatial grid have uniform spacings $\\Delta x$ and $\\Delta y$, and let the time step be $\\Delta t$. Assume periodic boundary conditions in both directions so that Fourier-mode analysis is admissible. Using Forward-in-Time, Central-in-Space (FTCS) differencing, discretize the equation with a first-order explicit time update and second-order central differences for the spatial derivatives. Perform a von Neumann stability analysis by assuming a Fourier mode of the form\n$$\\phi_{p,q}^{n} = \\hat{\\phi}^{n}\\,\\exp\\!\\big(\\mathrm{i}\\,(p\\,\\theta_{x} + q\\,\\theta_{y})\\big),$$\nwith integer grid indices $p$ and $q$, and phase angles $\\theta_{x}$ and $\\theta_{y}$ measured in radians. Define the Courant–Friedrichs–Lewy (CFL) numbers $C_{x} = a\\,\\Delta t / \\Delta x$ and $C_{y} = b\\,\\Delta t / \\Delta y$. Derive the single-step amplification factor $G(\\theta_{x},\\theta_{y})$ associated with the FTCS scheme, expressed explicitly as a closed-form analytic function of $\\theta_{x}$, $\\theta_{y}$, $C_{x}$, and $C_{y}$. Provide the final expression for $G(\\theta_{x},\\theta_{y})$. The final answer must be given as this analytic expression. No rounding is required.", "solution": "The problem statement is evaluated and found to be valid. It is a well-posed, scientifically grounded problem from the field of computational fluid dynamics, specifically concerning the stability analysis of a numerical scheme for a partial differential equation. All necessary information is provided, and the problem is free of contradictions or ambiguities.\n\nThe governing equation is the two-dimensional linear advection equation:\n$$ \\partial_{t}\\phi(x,y,t) + a\\,\\partial_{x}\\phi(x,y,t) + b\\,\\partial_{y}\\phi(x,y,t) = 0 $$\nwhere $\\phi$ is a scalar field, and $a$ and $b$ are constant advection velocities in the $x$ and $y$ directions, respectively.\n\nThe problem specifies the use of the Forward-in-Time, Central-in-Space (FTCS) discretization scheme on a uniform Cartesian grid. Let the grid spacings be $\\Delta x$ and $\\Delta y$, the time step be $\\Delta t$, and let $\\phi_{p,q}^{n}$ represent the numerical approximation of $\\phi(p\\Delta x, q\\Delta y, n\\Delta t)$.\n\nThe partial derivatives are approximated using finite differences as follows:\nThe time derivative $\\partial_{t}\\phi$ is approximated with a first-order forward difference:\n$$ \\partial_{t}\\phi \\approx \\frac{\\phi_{p,q}^{n+1} - \\phi_{p,q}^{n}}{\\Delta t} $$\nThe spatial derivatives $\\partial_{x}\\phi$ and $\\partial_{y}\\phi$ are approximated with second-order central differences:\n$$ \\partial_{x}\\phi \\approx \\frac{\\phi_{p+1,q}^{n} - \\phi_{p-1,q}^{n}}{2\\Delta x} $$\n$$ \\partial_{y}\\phi \\approx \\frac{\\phi_{p,q+1}^{n} - \\phi_{p,q-1}^{n}}{2\\Delta y} $$\n\nSubstituting these into the governing partial differential equation gives the fully discretized equation:\n$$ \\frac{\\phi_{p,q}^{n+1} - \\phi_{p,q}^{n}}{\\Delta t} + a\\left(\\frac{\\phi_{p+1,q}^{n} - \\phi_{p-1,q}^{n}}{2\\Delta x}\\right) + b\\left(\\frac{\\phi_{p,q+1}^{n} - \\phi_{p,q-1}^{n}}{2\\Delta y}\\right) = 0 $$\n\nFor the von Neumann stability analysis, we consider a single Fourier mode of the solution:\n$$ \\phi_{p,q}^{n} = \\hat{\\phi}^{n}\\,\\exp\\!\\big(\\mathrm{i}\\,(p\\,\\theta_{x} + q\\,\\theta_{y})\\big) $$\nwhere $\\hat{\\phi}^{n}$ is the complex amplitude of the mode at time level $n$, $\\mathrm{i} = \\sqrt{-1}$ is the imaginary unit, $p$ and $q$ are integer grid indices, and $\\theta_{x}$ and $\\theta_{y}$ are the dimensionless phase angles per grid cell. The amplification factor, $G(\\theta_x, \\theta_y)$, is defined by the relation $\\hat{\\phi}^{n+1} = G\\,\\hat{\\phi}^{n}$. Thus, we can write $\\phi_{p,q}^{n+1} = G\\,\\phi_{p,q}^{n}$.\n\nWe express the values at neighboring grid points in terms of $\\phi_{p,q}^{n}$:\n$$ \\phi_{p+1,q}^{n} = \\hat{\\phi}^{n}\\,\\exp\\!\\big(\\mathrm{i}\\,((p+1)\\,\\theta_{x} + q\\,\\theta_{y})\\big) = \\phi_{p,q}^{n}\\,\\exp(\\mathrm{i}\\theta_{x}) $$\n$$ \\phi_{p-1,q}^{n} = \\hat{\\phi}^{n}\\,\\exp\\!\\big(\\mathrm{i}\\,((p-1)\\,\\theta_{x} + q\\,\\theta_{y})\\big) = \\phi_{p,q}^{n}\\,\\exp(-\\mathrm{i}\\theta_{x}) $$\n$$ \\phi_{p,q+1}^{n} = \\hat{\\phi}^{n}\\,\\exp\\!\\big(\\mathrm{i}\\,(p\\,\\theta_{x} + (q+1)\\,\\theta_{y})\\big) = \\phi_{p,q}^{n}\\,\\exp(\\mathrm{i}\\theta_{y}) $$\n$$ \\phi_{p,q-1}^{n} = \\hat{\\phi}^{n}\\,\\exp\\!\\big(\\mathrm{i}\\,(p\\,\\theta_{x} + (q-1)\\,\\theta_{y})\\big) = \\phi_{p,q}^{n}\\,\\exp(-\\mathrm{i}\\theta_{y}) $$\n\nSubstituting these expressions and $\\phi_{p,q}^{n+1} = G\\,\\phi_{p,q}^{n}$ into the discretized equation:\n$$ \\frac{G\\,\\phi_{p,q}^{n} - \\phi_{p,q}^{n}}{\\Delta t} + a\\left(\\frac{\\phi_{p,q}^{n}\\,\\exp(\\mathrm{i}\\theta_{x}) - \\phi_{p,q}^{n}\\,\\exp(-\\mathrm{i}\\theta_{x})}{2\\Delta x}\\right) + b\\left(\\frac{\\phi_{p,q}^{n}\\,\\exp(\\mathrm{i}\\theta_{y}) - \\phi_{p,q}^{n}\\,\\exp(-\\mathrm{i}\\theta_{y})}{2\\Delta y}\\right) = 0 $$\n\nFor a non-trivial solution, $\\phi_{p,q}^{n} \\neq 0$, so we can divide by it:\n$$ \\frac{G-1}{\\Delta t} + \\frac{a}{2\\Delta x}\\big(\\exp(\\mathrm{i}\\theta_{x}) - \\exp(-\\mathrm{i}\\theta_{x})\\big) + \\frac{b}{2\\Delta y}\\big(\\exp(\\mathrm{i}\\theta_{y}) - \\exp(-\\mathrm{i}\\theta_{y})\\big) = 0 $$\n\nUsing Euler's identity, $\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta) = 2\\mathrm{i}\\sin(\\theta)$, the equation becomes:\n$$ \\frac{G-1}{\\Delta t} + \\frac{a}{2\\Delta x}(2\\mathrm{i}\\sin(\\theta_{x})) + \\frac{b}{2\\Delta y}(2\\mathrm{i}\\sin(\\theta_{y})) = 0 $$\n$$ \\frac{G-1}{\\Delta t} + \\mathrm{i}\\left(\\frac{a}{\\Delta x}\\sin(\\theta_{x}) + \\frac{b}{\\Delta y}\\sin(\\theta_{y})\\right) = 0 $$\n\nNow, we solve for the amplification factor $G$:\n$$ G-1 = -\\mathrm{i}\\,\\Delta t \\left(\\frac{a}{\\Delta x}\\sin(\\theta_{x}) + \\frac{b}{\\Delta y}\\sin(\\theta_{y})\\right) $$\n$$ G = 1 - \\mathrm{i}\\left(\\frac{a\\Delta t}{\\Delta x}\\sin(\\theta_{x}) + \\frac{b\\Delta t}{\\Delta y}\\sin(\\theta_{y})\\right) $$\n\nThe problem defines the Courant–Friedrichs–Lewy (CFL) numbers as $C_{x} = a\\,\\Delta t / \\Delta x$ and $C_{y} = b\\,\\Delta t / \\Delta y$. Substituting these definitions into the expression for $G$ yields the final result:\n$$ G(\\theta_{x},\\theta_{y}) = 1 - \\mathrm{i}\\big(C_{x}\\sin(\\theta_{x}) + C_{y}\\sin(\\theta_{y})\\big) $$\nThis expression represents the amplification factor as a closed-form analytic function of the phase angles $\\theta_{x}$ and $\\theta_{y}$, and the CFL numbers $C_{x}$ and $C_{y}$.", "answer": "$$\n\\boxed{1 - \\mathrm{i}\\left(C_{x}\\sin(\\theta_{x}) + C_{y}\\sin(\\theta_{y})\\right)}\n$$", "id": "3365211"}, {"introduction": "Having seen the failure of the FTCS scheme, we now investigate an alternative that can achieve stability. The leapfrog scheme, a second-order accurate method in time, offers a path forward when paired with central differencing. In this practice [@problem_id:3365230], you will analyze this combination to discover its conditional stability, deriving the famous Courant-Friedrichs-Lewy (CFL) condition $|r| \\le 1$. You will also uncover a subtle but important consequence of using a multi-level time-stepping scheme: the emergence of a spurious computational mode.", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ for a constant advection speed $a$ on a periodic domain, discretized on a uniform spatial grid $x_{j} = j\\,\\Delta x$ with time levels $t^{n} = n\\,\\Delta t$, where $j$ and $n$ are integers and $\\Delta x, \\Delta t  0$. Approximate the temporal derivative at $t^{n}$ by a centered difference over $[t^{n-1}, t^{n+1}]$ and the spatial derivative at $t^{n}$ by a centered difference over $x$, and define the Courant number $r = a\\,\\Delta t/\\Delta x$. Using a von Neumann Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,\\theta\\,j)$ with dimensionless wavenumber angle $\\theta$ measured in radians, derive the amplification factor $G(\\theta,r)$ associated with leapfrog time stepping combined with central spatial differencing. Then, require uniform stability in the sense $|G(\\theta,r)| \\leq 1$ for all $\\theta \\in [-\\pi,\\pi]$ and determine the largest admissible magnitude of $r$ (the maximum Courant number) that satisfies this bound. Finally, examine the roots obtained for $G(\\theta,r)$ and infer whether a computational (parasitic) mode exists based on their algebraic relation, explaining the mechanism of its appearance. Provide as your final output the closed-form expression for $G(\\theta,r)$ and the single real number equal to the maximal admissible Courant number. No rounding is required, and there are no physical units to report; angles must be interpreted in radians.", "solution": "The problem statement is a valid and well-posed problem in the field of numerical analysis for partial differential equations. It requests the stability analysis of the leapfrog time-stepping scheme combined with a second-order central difference for the spatial derivative, applied to the one-dimensional linear advection equation. All necessary information is provided, and the problem is scientifically grounded.\n\nThe one-dimensional linear advection equation is given by:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x, t)$ is the transported quantity and $a$ is the constant advection speed.\n\nThe problem specifies a discretization on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, where $u_j^n$ approximates $u(x_j, t^n)$. The temporal derivative $\\frac{\\partial u}{\\partial t}$ is approximated at time level $n$ by a centered difference (leapfrog scheme):\n$$\n\\left(\\frac{\\partial u}{\\partial t}\\right)_j^n \\approx \\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t}\n$$\nThe spatial derivative $\\frac{\\partial u}{\\partial x}$ is approximated at grid point $j$ by a centered difference:\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_j^n \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}\n$$\nSubstituting these approximations into the advection equation yields the finite difference equation:\n$$\n\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + a \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0\n$$\nTo perform the von Neumann stability analysis, we substitute a single Fourier mode $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ into the finite difference equation. Here, $\\theta = k\\Delta x$ is the dimensionless wavenumber, where $k$ is the wavenumber.\n$$\n\\frac{\\hat{u}^{n+1}\\exp(i\\theta j) - \\hat{u}^{n-1}\\exp(i\\theta j)}{2\\Delta t} + a \\frac{\\hat{u}^{n}\\exp(i\\theta (j+1)) - \\hat{u}^{n}\\exp(i\\theta (j-1))}{2\\Delta x} = 0\n$$\nWe can divide the entire equation by the common factor $\\exp(i\\theta j)$:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n-1}}{2\\Delta t} + a \\hat{u}^{n} \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2\\Delta x} = 0\n$$\nUsing the Euler identity $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, the equation becomes:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n-1}}{2\\Delta t} + a \\hat{u}^{n} \\frac{2i\\sin(\\theta)}{2\\Delta x} = 0\n$$\nMultiplying by $2\\Delta t$ and rearranging gives a recurrence relation for the amplitude $\\hat{u}^n$:\n$$\n\\hat{u}^{n+1} - \\hat{u}^{n-1} = -2i \\left(\\frac{a\\Delta t}{\\Delta x}\\right) \\sin(\\theta) \\hat{u}^n\n$$\nIntroducing the Courant number $r = a\\Delta t / \\Delta x$, we have:\n$$\n\\hat{u}^{n+1} + \\left(2ir\\sin(\\theta)\\right)\\hat{u}^n - \\hat{u}^{n-1} = 0\n$$\nThe amplification factor $G$ is defined such that $\\hat{u}^{n+1} = G \\hat{u}^n$. Since this is a two-step method, the recurrence relates three time levels. We thus assume a solution of the form $\\hat{u}^n = (\\hat{u}^0)G^n$. Substituting this into the recurrence relation gives:\n$$\n(\\hat{u}^0)G^{n+1} + \\left(2ir\\sin(\\theta)\\right)(\\hat{u}^0)G^n - (\\hat{u}^0)G^{n-1} = 0\n$$\nDividing by $(\\hat{u}^0)G^{n-1}$ (assuming $G \\neq 0$ and $\\hat{u}^0 \\neq 0$), we obtain the characteristic equation for the amplification factor $G$:\n$$\nG^2 + (2ir\\sin(\\theta))G - 1 = 0\n$$\nThis is a quadratic equation for $G$. We solve for its roots using the quadratic formula:\n$$\nG(\\theta,r) = \\frac{-2ir\\sin(\\theta) \\pm \\sqrt{(2ir\\sin(\\theta))^2 - 4(1)(-1)}}{2}\n$$\n$$\nG(\\theta,r) = \\frac{-2ir\\sin(\\theta) \\pm \\sqrt{-4r^2\\sin^2(\\theta) + 4}}{2}\n$$\n$$\nG(\\theta,r) = -ir\\sin(\\theta) \\pm \\sqrt{1 - r^2\\sin^2(\\theta)}\n$$\nThis provides the expression for the two amplification factors associated with the scheme.\n\nFor the scheme to be stable, the magnitude of the amplification factor must satisfy $|G(\\theta,r)| \\leq 1$ for all real $\\theta$. We analyze the term under the square root, $1 - r^2\\sin^2(\\theta)$.\n\nCase 1: $1 - r^2\\sin^2(\\theta) \\geq 0$.\nIn this case, the square root is real. Let $A = r\\sin(\\theta)$ and $B = \\sqrt{1 - r^2\\sin^2(\\theta)}$. Then $G = -iA \\pm B$. The magnitude of $G$ is:\n$$\n|G| = \\sqrt{(\\pm B)^2 + (-A)^2} = \\sqrt{B^2 + A^2} = \\sqrt{(1 - r^2\\sin^2(\\theta)) + (r^2\\sin^2(\\theta))} = \\sqrt{1} = 1\n$$\nSo, if $1 - r^2\\sin^2(\\theta) \\geq 0$, the scheme is neutrally stable, which satisfies the stability requirement $|G| \\leq 1$. For this condition to hold for all $\\theta \\in [-\\pi, \\pi]$, we must check the worst case, which occurs when $|\\sin(\\theta)|$ is maximal. The maximum value of $\\sin^2(\\theta)$ is $1$. Therefore, we must have:\n$$\n1 - r^2(1) \\geq 0 \\implies r^2 \\leq 1 \\implies |r| \\leq 1\n$$\nThis is the Courant-Friedrichs-Lewy (CFL) condition for this scheme. The largest admissible magnitude of the Courant number $r$ is $1$.\n\nCase 2: $1 - r^2\\sin^2(\\theta)  0$.\nThis occurs if $|r|  1$, for a range of $\\theta$ values. In this case, the term under the square root is negative. We can write $\\sqrt{1 - r^2\\sin^2(\\theta)} = i\\sqrt{r^2\\sin^2(\\theta) - 1}$. The amplification factors are:\n$$\nG = -ir\\sin(\\theta) \\pm i\\sqrt{r^2\\sin^2(\\theta) - 1} = i\\left(-r\\sin(\\theta) \\pm \\sqrt{r^2\\sin^2(\\theta) - 1}\\right)\n$$\nThe magnitude of $G$ is $|-r\\sin(\\theta) \\pm \\sqrt{r^2\\sin^2(\\theta) - 1}|$. Let us consider the root with the plus sign for the term in parentheses (this choice leads to amplification). Its magnitude is $|-r\\sin(\\theta) + \\sqrt{r^2\\sin^2(\\theta) - 1}|$. If we assume $r0$, we can choose $\\theta$ such that $\\sin(\\theta)0$ to make the magnitude greater than 1. For example, if $r1$, let's pick $\\theta = -\\pi/2$, so $\\sin(\\theta)=-1$. Then $G=i(r \\pm \\sqrt{r^2 - 1})$. The magnitude is $|r \\pm \\sqrt{r^2 - 1}|$. For the plus sign, the magnitude is $r + \\sqrt{r^2-1}$. Since $r  1$, we have $r^2 - 1  0$, so $r + \\sqrt{r^2 - 1}  r  1$. Thus, one of the roots has a magnitude greater than $1$, leading to exponential growth and instability.\n\nTherefore, the stability of the scheme for all wavenumbers requires $|r| \\leq 1$. The largest admissible magnitude of $r$ is $1$.\n\nFinally, we analyze the roots to understand the computational mode. The characteristic equation $G^2 + (2ir\\sin(\\theta))G - 1 = 0$ yields two distinct roots for $G$, let's call them $G_1$ and $G_2$. The original PDE is first-order in time, so its evolution should depend only on one 'mode'. The numerical scheme, being a three-level (two-step) method, is second-order in the time index $n$, which inherently introduces a second, unphysical solution. This spurious solution is the computational (or parasitic) mode. The algebraic relation between the two roots can be found using Vieta's formulas on the characteristic polynomial: the product of the roots $G_1 G_2$ is the constant term, which is $-1$.\n$$\nG_1 G_2 = -1\n$$\nIn the stable regime ($|r| \\leq 1$), we showed that both roots have magnitude $|G_1| = |G_2| = 1$. One root, $G_1$, approximates the physical wave propagation. For small $r\\theta$, $G_1 \\approx 1 - ir\\theta - \\frac{1}{2}(r\\theta)^2 \\approx \\exp(-ir\\theta)$, which corresponds to the true solution's amplification factor. The other root is $G_2 = -1/G_1 \\approx -\\exp(ir\\theta)$. For small wavenumbers ($\\theta \\to 0$), $G_1 \\to 1$ and $G_2 \\to -1$. This means the computational mode manifests as a high-frequency oscillation in time, flipping sign at every time step ($(-1)^n$), which can contaminate the numerical solution. The existence of this second root is a direct consequence of approximating a first-order temporal derivative with a second-order centered difference.\n\nThe final answer requires the expression for $G(\\theta,r)$ and the maximum admissible Courant number.", "answer": "$$\n\\boxed{G(\\theta,r) = -ir\\sin(\\theta) \\pm \\sqrt{1 - r^2\\sin^2(\\theta)}; \\quad \\text{Max }|r| = 1}\n$$", "id": "3365230"}, {"introduction": "The stability issues of central differencing are not limited to time-dependent problems. This final practice [@problem_id:3365178] shifts our focus to the steady-state convection-diffusion equation, a cornerstone of transport phenomena. By implementing a simple finite volume solver, you will see firsthand how the theoretical instability manifests as non-physical spatial oscillations when convection dominates diffusion, a condition quantified by the grid Peclet number, $Pe$. This coding exercise provides a tangible link between the abstract stability analysis and the practical behavior of numerical simulations.", "problem": "Consider the one-dimensional, steady, linear convection–diffusion boundary value problem for a passive scalar field $\\phi(x)$ on the domain $[0,1]$ with constant material properties and constant velocity. The continuous governing equation is the balance of diffusive and convective fluxes written in conservative form,\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) + \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\rho u \\, \\phi\\right) = 0,\n$$\nwhere $\\Gammagt;0$ is the diffusion coefficient, $\\rhogt;0$ is the density, and $u$ is a constant velocity that may be positive or negative. Dirichlet boundary conditions $\\phi(0)=\\phi_L$ and $\\phi(1)=\\phi_R$ are imposed. All quantities are to be treated as dimensionless. You must work entirely in dimensionless units.\n\nYour task is to construct a numerical example using the cell-centered finite volume method on a uniform grid of $N$ equal control volumes (with cell faces at $x_i = i \\Delta x$, where $\\Delta x = 1/N$ and $i=0,1,\\ldots,N$) and central differencing for the convective flux that illustrates the well-known stability issue: for grid Peclet number with magnitude greater than $2$, i.e., $|Pe| gt; 2$, the central differencing scheme produces non-monotone interior oscillations even though the resulting linear system remains solvable.\n\nStarting from conservation over each control volume, discretize the equation using:\n- A second-order central difference for the diffusive fluxes at faces.\n- A second-order central difference for the convective mass fluxes at faces.\n\nDerive the resulting tri-diagonal linear system for interior cell-center values $\\phi_1,\\ldots,\\phi_{N-1}$ in terms of the diffusion conductance $D=\\Gamma/\\Delta x$, the mass flux $F=\\rho u$, and the grid Peclet number $Pe = F \\Delta x/\\Gamma$. Do not introduce any artificial dissipation or upwinding; use pure central differencing for both fluxes. Assemble the linear system with the Dirichlet boundary conditions incorporated into the right-hand side.\n\nDefine a quantitative detector of non-monotone interior oscillations as follows. Given the computed discrete solution $\\{\\phi_i\\}_{i=0}^N$ including boundaries, declare that an interior oscillation is present if at least one of the following conditions holds:\n- There exists an index $j \\in \\{1,\\ldots,N-1\\}$ such that $\\phi_j$ lies strictly outside the closed interval with endpoints $\\phi_L$ and $\\phi_R$.\n- There exists an index $j \\in \\{1,\\ldots,N-2\\}$ such that the product $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) lt; 0$, i.e., the first difference changes sign, indicating a discrete interior extremum.\n\nImplement a program that:\n- Constructs and solves the linear system for the central-differencing finite volume scheme on a uniform grid as described above, for each specified test case.\n- Reports, for each case, a boolean indicating whether a non-monotone interior oscillation is detected by the above criterion.\n\nUse the following five test cases, each specified by the tuple $(N, Pe, \\phi_L, \\phi_R)$:\n- Case $1$: $(N, Pe, \\phi_L, \\phi_R) = (10, 0.5, 1, 0)$.\n- Case $2$: $(N, Pe, \\phi_L, \\phi_R) = (10, 4.0, 1, 0)$.\n- Case $3$: $(N, Pe, \\phi_L, \\phi_R) = (40, 4.0, 1, 0)$.\n- Case $4$: $(N, Pe, \\phi_L, \\phi_R) = (10, 2.0, 1, 0)$.\n- Case $5$: $(N, Pe, \\phi_L, \\phi_R) = (10, -4.0, 0, 1)$.\n\nNotes:\n- Fix $\\Gamma=1$ and $\\rho=1$ to make all quantities dimensionless. Then $D = 1/\\Delta x$ and $F = Pe/\\Delta x$. The uniform mesh spacing is $\\Delta x = 1/N$.\n- You must use the sign of $Pe$ consistently to determine the sign of the mass flux $F$.\n- The final linear system must be assembled exactly from the central-differencing finite volume formulation; do not regularize, limit, or modify coefficients.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above five cases. For example, the output should be of the form $[r_1,r_2,r_3,r_4,r_5]$ where each $r_k$ is a boolean indicating whether an interior oscillation was detected for case $k$. No angles or physical units occur in this problem; all quantities are dimensionless. The only required output is this one line in the specified format.", "solution": "The user wants to analyze the stability of a central-differencing finite volume scheme for a 1D steady convection-diffusion problem.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equation:** $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) + \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\rho u \\, \\phi\\right) = 0$ on the domain $x \\in [0,1]$.\n*   **Parameters:** Diffusion coefficient $\\Gamma  0$, density $\\rho  0$, and velocity $u$ are constant. All quantities are dimensionless.\n*   **Boundary Conditions (BCs):** Dirichlet, $\\phi(0)=\\phi_L$ and $\\phi(1)=\\phi_R$.\n*   **Numerical Discretization:**\n    *   Finite volume method on a uniform grid of $N$ control volumes.\n    *   Grid nodes are at $x_i = i \\Delta x$ for $i=0, \\ldots, N$, with $\\Delta x = 1/N$. The interior unknowns are $\\phi_1, \\ldots, \\phi_{N-1}$. This implies a vertex-centered scheme where $\\phi_i$ is the value at node $x_i$.\n    *   A second-order central difference is specified for both diffusive and convective fluxes at control volume faces.\n*   **Definitions:**\n    *   Diffusion conductance: $D = \\Gamma / \\Delta x$.\n    *   Mass flux: $F = \\rho u$.\n    *   Grid Peclet number: $Pe = F \\Delta x / \\Gamma$.\n*   **Constants:** Fixed values $\\Gamma=1$ and $\\rho=1$ are specified for the implementation.\n*   **Oscillation Detection:** An interior oscillation is present if at least one of two conditions is met:\n    1.  An interior solution value $\\phi_j$ (for $j \\in \\{1, \\ldots, N-1\\}$) is strictly outside the range $[\\min(\\phi_L, \\phi_R), \\max(\\phi_L, \\phi_R)]$.\n    2.  A discrete interior extremum exists, defined as $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1})  0$ for some index $j \\in \\{1, \\ldots, N-2\\}$.\n*   **Test Cases:**\n    1.  $(N, Pe, \\phi_L, \\phi_R) = (10, 0.5, 1, 0)$\n    2.  $(N, Pe, \\phi_L, \\phi_R) = (10, 4.0, 1, 0)$\n    3.  $(N, Pe, \\phi_L, \\phi_R) = (40, 4.0, 1, 0)$\n    4.  $(N, Pe, \\phi_L, \\phi_R) = (10, 2.0, 1, 0)$\n    5.  $(N, Pe, \\phi_L, \\phi_R) = (10, -4.0, 0, 1)$\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding:** The problem is based on the canonical 1D convection-diffusion equation and standard finite volume methods, a fundamental topic in computational fluid dynamics. The investigation of numerical stability as a function of the grid Peclet number is a classic and crucial subject. The problem is scientifically sound.\n*   **Well-Posed:** The continuous problem is a well-posed linear boundary value problem. The discretization leads to a tridiagonal linear system. For the specified schemes and parameters, this system is non-singular, guaranteeing a unique solution. The question is well-posed.\n*   **Objective:** The problem is formulated with precise mathematical definitions, quantitative criteria, and specific numerical parameters. It is free from subjectivity and ambiguity.\n*   **Completeness:** All necessary information, including the governing equation, boundary conditions, discretization scheme, parameter definitions, and test cases, is provided. The problem is self-contained.\n*   **Consistency:** There are no contradictions. The definitions of $D$, $F$, and $Pe$ are mutually consistent. The structure of the desired linear system (for $\\phi_1, \\ldots, \\phi_{N-1}$) is consistent with a vertex-centered grid interpretation, despite the \"cell-centered\" terminology, which is a common point of mild terminological confusion but does not create a formal contradiction in the setup.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. A reasoned solution will be developed.\n\n### Principle-Based Solution\n\nThe task is to derive and solve the discretized form of the 1D steady convection-diffusion equation and to check the solution for non-physical oscillations.\n\n**1. Discretization via Finite Volume Method**\nThe governing equation in conservative form is $\\frac{\\mathrm{d}}{\\mathrm{d}x} J(x) = 0$, where $J(x)$ is the total flux, given by $J = -\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} + F\\phi$, with $F = \\rho u$. This implies that the total flux is constant throughout the domain.\n\nWe use a vertex-centered finite volume approach. The domain $[0,1]$ is divided into $N$ segments by $N+1$ nodes at locations $x_i = i\\Delta x$ for $i=0, 1, \\ldots, N$, where $\\Delta x = 1/N$. The unknowns are the values $\\phi_i$ at the interior nodes $i=1, \\ldots, N-1$. The boundary values are given: $\\phi_0 = \\phi_L$ and $\\phi_N = \\phi_R$.\n\nWe integrate the governing equation over a control volume (CV) centered around an interior node $x_i$. The CV extends from face $w$ at $x_i - \\Delta x/2$ to face $e$ at $x_i + \\Delta x/2$.\n$$ \\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} \\frac{\\mathrm{d}J}{\\mathrm{d}x} \\mathrm{d}x = 0 $$\n$$ J_e - J_w = 0 $$\nwhere $J_e$ and $J_w$ are the total fluxes at the east and west faces of the CV, respectively.\n\n**2. Flux Approximation using Central Differencing**\nThe fluxes at the faces are approximated using second-order central differences for both diffusion and convection.\n\nAt the east face $e$ (midway between nodes $i$ and $i+1$):\nThe diffusive flux is approximated as:\n$$ \\left(-\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)_e \\approx -\\Gamma \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} = -D(\\phi_{i+1} - \\phi_i) $$\nwhere $D=\\Gamma/\\Delta x$.\nThe convective flux requires the value of $\\phi$ at the face, which is found by linear interpolation:\n$$ (F\\phi)_e \\approx F \\phi_e = F \\frac{\\phi_i + \\phi_{i+1}}{2} $$\nThe total flux at face $e$ is:\n$$ J_e \\approx F \\frac{\\phi_i + \\phi_{i+1}}{2} - D(\\phi_{i+1} - \\phi_i) = \\left(\\frac{F}{2} + D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1} $$\n\nSimilarly, at the west face $w$ (midway between nodes $i-1$ and $i$):\n$$ J_w \\approx F \\frac{\\phi_{i-1} + \\phi_i}{2} - D(\\phi_i - \\phi_{i-1}) = \\left(\\frac{F}{2} - D\\right)\\phi_i + \\left(\\frac{F}{2} + D\\right)\\phi_{i-1} $$\n\n**3. Derivation of the Algebraic Equation**\nSubstituting the flux approximations into the balance equation $J_e - J_w = 0$:\n$$ \\left[\\left(\\frac{F}{2} + D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1}\\right] - \\left[\\left(\\frac{F}{2} - D\\right)\\phi_i + \\left(\\frac{F}{2} + D\\right)\\phi_{i-1}\\right] = 0 $$\nCollecting terms for $\\phi_{i-1}$, $\\phi_i$, and $\\phi_{i+1}$:\n$$ -\\left(D + \\frac{F}{2}\\right)\\phi_{i-1} + \\left(2D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1} = 0 $$\nTo express this in terms of the grid Peclet number, $Pe = F\\Delta x/\\Gamma = F/D$, we divide the entire equation by $D$:\n$$ -\\left(1 + \\frac{Pe}{2}\\right)\\phi_{i-1} + 2\\phi_i - \\left(1 - \\frac{Pe}{2}\\right)\\phi_{i+1} = 0 $$\nThis algebraic equation relates the value at node $i$ to its immediate neighbors.\n\n**4. Assembly of the Linear System**\nThis equation holds for all interior nodes $i=1, \\ldots, N-1$. We assemble a tridiagonal linear system of the form $A\\vec{\\phi} = \\vec{b}$ for the vector of unknowns $\\vec{\\phi} = [\\phi_1, \\ldots, \\phi_{N-1}]^T$.\n\nThe matrix $A$ is an $(N-1) \\times (N-1)$ tridiagonal matrix with the following coefficients:\n-   Main diagonal ($d_i$): $2$\n-   Lower diagonal ($a_i$): $-\\left(1 + \\frac{Pe}{2}\\right)$\n-   Upper diagonal ($c_i$): $-\\left(1 - \\frac{Pe}{2}\\right) = \\frac{Pe}{2} - 1$\n\nThe boundary conditions $\\phi_0 = \\phi_L$ and $\\phi_N = \\phi_R$ are incorporated into the right-hand side vector $\\vec{b}$.\nFor the first equation ($i=1$):\n$$ 2\\phi_1 - \\left(1 - \\frac{Pe}{2}\\right)\\phi_2 = \\left(1 + \\frac{Pe}{2}\\right)\\phi_0 = \\left(1 + \\frac{Pe}{2}\\right)\\phi_L $$\nThus, $b_1 = (1 + Pe/2)\\phi_L$.\n\nFor the last equation ($i=N-1$):\n$$ -\\left(1 + \\frac{Pe}{2}\\right)\\phi_{N-2} + 2\\phi_{N-1} = \\left(1 - \\frac{Pe}{2}\\right)\\phi_N = \\left(1 - \\frac{Pe}{2}\\right)\\phi_R $$\nThus, $b_{N-1} = (1 - Pe/2)\\phi_R$.\n\nFor all other equations ($i=2, \\ldots, N-2$), the right-hand side is zero, $b_i = 0$.\n\n**5. Stability and Oscillations**\nThe central differencing scheme is known to be stable and produce monotonic solutions only when the matrix $A$ is diagonally dominant. This requires $|d_i| \\geq |a_i| + |c_i|$, which translates to:\n$$ |2| \\geq \\left|-\\left(1 + \\frac{Pe}{2}\\right)\\right| + \\left|-\\left(1 - \\frac{Pe}{2}\\right)\\right| $$\n$$ 2 \\geq \\left|1 + \\frac{Pe}{2}\\right| + \\left|1 - \\frac{Pe}{2}\\right| $$\nThis inequality holds only if $|Pe/2| \\leq 1$, or $|Pe| \\leq 2$. When $|Pe|  2$, diagonal dominance is lost, and the coefficients of the neighboring nodes in the stencil can become negative, leading to non-physical, oscillatory solutions. The problem asks to demonstrate this behavior.\n\n**6. Computational Procedure**\nThe program will implement the following steps for each test case:\n1.  Given $N$, $Pe$, $\\phi_L$, and $\\phi_R$.\n2.  Construct the $(N-1) \\times (N-1)$ tridiagonal matrix $A$ and the RHS vector $\\vec{b}$ as derived above.\n3.  Solve the linear system $A\\vec{\\phi} = \\vec{b}$ to find the interior solution values $\\phi_1, \\ldots, \\phi_{N-1}$.\n4.  Create the full solution array $\\{\\phi_i\\}_{i=0}^N$ by prepending $\\phi_L$ and appending $\\phi_R$.\n5.  Apply the two specified criteria to detect oscillations:\n    *   Check if any interior $\\phi_j$ is strictly outside $[\\min(\\phi_L, \\phi_R), \\max(\\phi_L, \\phi_R)]$.\n    *   Check if $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1})  0$ for any $j \\in \\{1, \\ldots, N-2\\}$.\n6.  Report `True` if an oscillation is detected, and `False` otherwise.", "answer": "[False,True,True,False,True]", "id": "3365178"}]}