{"hands_on_practices": [{"introduction": "To understand how information propagates in a fluid, we must analyze the eigenstructure of the governing equations. This practice guides you through the essential derivation of the flux Jacobian for the 1D Euler equations and its relationship to the corresponding system in primitive variables [@problem_id:3304162]. Mastering this analysis is crucial as the resulting eigenvalues and eigenvectors form the bedrock of characteristic-based schemes used in modern CFD.", "problem": "Consider the one-dimensional Euler equations for a calorically perfect gas in conservation form,\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0,\n$$\nwhere the conserved variable vector is $\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$, the flux vector is $\\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}$, the pressure is given by the ideal-gas closure $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$ with $\\gamma > 1$ constant, and the speed of sound is $c^{2} = \\gamma p / \\rho$. Let the primitive variable vector be $\\mathbf{V} = \\begin{pmatrix} \\rho \\\\ u \\\\ p \\end{pmatrix}$.\n\nStarting from these definitions and the conservation laws, do the following:\n- Derive the flux Jacobian in conservative variables, $\\mathbf{A}(\\mathbf{U}) = \\partial \\mathbf{F}/\\partial \\mathbf{U}$, and determine its eigenvalues and a consistent set of right eigenvectors.\n- Compute the transformation matrix $\\mathbf{U}_{\\mathbf{V}} = \\partial \\mathbf{U}/\\partial \\mathbf{V}$ and use it to obtain the quasilinear primitive-variable Jacobian associated with the evolution of $\\mathbf{V}$, $\\mathbf{B}(\\mathbf{V}) = \\mathbf{U}_{\\mathbf{V}}^{-1}\\,\\mathbf{A}(\\mathbf{U})\\,\\mathbf{U}_{\\mathbf{V}}$.\n- Compare the eigenstructures of $\\mathbf{A}(\\mathbf{U})$ and $\\mathbf{B}(\\mathbf{V})$ and explain the distinction between $\\partial \\mathbf{F}/\\partial \\mathbf{V}$ and $\\mathbf{B}(\\mathbf{V})$.\nAs a scalar measure of this comparison, give the determinant of the primitive-variable Jacobian $\\det(\\mathbf{B}(\\mathbf{V}))$ expressed purely in terms of $u$ and $c$. Express your final answer as a single closed-form analytic expression with no units.", "solution": "The problem is well-posed, scientifically grounded, objective, and contains all necessary information for a full derivation. It is a standard exercise in the analysis of hyperbolic conservation laws, specifically the Euler equations, and is therefore valid.\n\nThe process involves several steps: deriving the flux Jacobian in conservative variables and its eigenstructure, finding the transformation matrix to primitive variables, computing the corresponding primitive variable Jacobian, comparing the two systems, and finally calculating the determinant of the primitive variable Jacobian.\n\n**Part 1: Flux Jacobian $\\mathbf{A}(\\mathbf{U})$ and its Eigenstructure**\n\nThe vector of conserved variables is $\\mathbf{U} = (U_1, U_2, U_3)^T = (\\rho, \\rho u, \\rho E)^T$. The flux vector is $\\mathbf{F}(\\mathbf{U}) = (\\rho u, \\rho u^2+p, u(\\rho E+p))^T$. To compute the Jacobian $\\mathbf{A}(\\mathbf{U}) = \\partial \\mathbf{F}/\\partial \\mathbf{U}$, we first express the flux components $F_1, F_2, F_3$ in terms of $U_1, U_2, U_3$.\nThe primitive variables are $\\rho = U_1$ and $u = U_2/U_1$.\nThe pressure $p$ is given by the equation of state:\n$$p = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right) = (\\gamma - 1)\\left(U_3 - \\frac{1}{2}U_1 \\left(\\frac{U_2}{U_1}\\right)^2\\right) = (\\gamma - 1)\\left(U_3 - \\frac{U_2^2}{2U_1}\\right)$$\nThe flux vector components are:\n$$F_1 = \\rho u = U_2$$\n$$F_2 = \\rho u^2 + p = U_1\\left(\\frac{U_2}{U_1}\\right)^2 + (\\gamma - 1)\\left(U_3 - \\frac{U_2^2}{2U_1}\\right) = \\frac{U_2^2}{U_1} + (\\gamma-1)U_3 - \\frac{\\gamma-1}{2}\\frac{U_2^2}{U_1} = \\frac{3-\\gamma}{2}\\frac{U_2^2}{U_1} + (\\gamma-1)U_3$$\n$$F_3 = u(\\rho E + p) = \\frac{U_2}{U_1}(U_3 + p) = \\frac{U_2}{U_1}\\left[U_3 + (\\gamma-1)\\left(U_3 - \\frac{U_2^2}{2U_1}\\right)\\right] = \\frac{U_2}{U_1}\\left[\\gamma U_3 - \\frac{\\gamma-1}{2}\\frac{U_2^2}{U_1}\\right] = \\frac{\\gamma U_2 U_3}{U_1} - \\frac{\\gamma-1}{2}\\frac{U_2^3}{U_1^2}$$\nThe flux Jacobian $\\mathbf{A}(\\mathbf{U})_{ij} = \\partial F_i/\\partial U_j$ is computed by differentiation. For clarity, it is convenient to express the final matrix in terms of primitive variables $\\rho, u, p$ and related quantities like the total enthalpy $H = E + p/\\rho = \\frac{\\rho E + p}{\\rho}$ and speed of sound $c = \\sqrt{\\gamma p/\\rho}$. Total enthalpy can be written as $H = \\frac{c^2}{\\gamma-1} + \\frac{u^2}{2}$. The resulting Jacobian is:\n$$\n\\mathbf{A}(\\mathbf{U}) = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n\\frac{\\gamma-3}{2}u^2 & (3-\\gamma)u & \\gamma-1 \\\\\nu\\left(\\frac{\\gamma-1}{2}u^2 - H\\right) & H - (\\gamma-1)u^2 & \\gamma u\n\\end{pmatrix}\n$$\nThe eigenvalues of this matrix are the characteristic wave speeds of the system. For the one-dimensional Euler equations, these are known to be:\n$$\n\\lambda_1 = u - c, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + c\n$$\nA consistent set of right eigenvectors $\\mathbf{r}_k$ satisfying $\\mathbf{A}\\mathbf{r}_k = \\lambda_k\\mathbf{r}_k$ is:\n$$\n\\mathbf{r}_1 = \\begin{pmatrix} 1 \\\\ u-c \\\\ H-uc \\end{pmatrix}, \\quad\n\\mathbf{r}_2 = \\begin{pmatrix} 1 \\\\ u \\\\ \\frac{1}{2}u^2 \\end{pmatrix}, \\quad\n\\mathbf{r}_3 = \\begin{pmatrix} 1 \\\\ u+c \\\\ H+uc \\end{pmatrix}\n$$\nDifferent scalings exist for these eigenvectors; the choice above is a common and simple one.\n\n**Part 2: Transformation Matrix and Primitive Variable Jacobian**\n\nThe transformation from primitive variables $\\mathbf{V} = (\\rho, u, p)^T$ to conserved variables $\\mathbf{U} = (\\rho, \\rho u, \\rho E)^T$ requires expressing $\\mathbf{U}$ in terms of $\\mathbf{V}$. Using the relation $\\rho E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$, we have:\n$$\n\\mathbf{U}(\\mathbf{V}) = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2 \\end{pmatrix}\n$$\nThe transformation matrix $\\mathbf{U}_{\\mathbf{V}}$ is the Jacobian of this transformation, $\\mathbf{U}_{\\mathbf{V}} = \\partial \\mathbf{U}/\\partial \\mathbf{V}$:\n$$\n\\mathbf{U}_{\\mathbf{V}} = \\begin{pmatrix} \\partial U_1/\\partial \\rho & \\partial U_1/\\partial u & \\partial U_1/\\partial p \\\\ \\partial U_2/\\partial \\rho & \\partial U_2/\\partial u & \\partial U_2/\\partial p \\\\ \\partial U_3/\\partial \\rho & \\partial U_3/\\partial u & \\partial U_3/\\partial p \\end{pmatrix} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\nu & \\rho & 0 \\\\\n\\frac{1}{2}u^2 & \\rho u & \\frac{1}{\\gamma-1}\n\\end{pmatrix}\n$$\nThe inverse transformation matrix $\\mathbf{U}_{\\mathbf{V}}^{-1} = \\partial \\mathbf{V}/\\partial \\mathbf{U}$ can be computed either by direct matrix inversion or by differentiating the expressions for $\\mathbf{V}$ in terms of $\\mathbf{U}$: $\\rho = U_1$, $u=U_2/U_1$, $p=(\\gamma-1)(U_3 - U_2^2/(2U_1))$.\n$$\n\\mathbf{U}_{\\mathbf{V}}^{-1} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n-u/\\rho & 1/\\rho & 0 \\\\\n\\frac{\\gamma-1}{2}u^2 & -(\\gamma-1)u & \\gamma-1\n\\end{pmatrix}\n$$\nThe quasilinear primitive-variable Jacobian $\\mathbf{B}(\\mathbf{V})$ is obtained via a similarity transformation of $\\mathbf{A}$: $\\mathbf{B}(\\mathbf{V}) = \\mathbf{U}_{\\mathbf{V}}^{-1}\\,\\mathbf{A}\\,\\mathbf{U}_{\\mathbf{V}}$. A convenient way to compute this is to first find the product $\\mathbf{A}\\mathbf{U}_{\\mathbf{V}}$, which by the chain rule is equal to $\\partial \\mathbf{F}/\\partial \\mathbf{V}$:\n$$ \\mathbf{A}\\mathbf{U}_{\\mathbf{V}} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}\\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{V}} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{V}} $$\nWe calculate $\\partial \\mathbf{F}/\\partial \\mathbf{V}$ by first expressing $\\mathbf{F}$ in terms of $\\mathbf{V}$:\n$$ \\mathbf{F}(\\mathbf{V}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2+p \\\\ u(\\frac{\\gamma p}{\\gamma-1} + \\frac{1}{2}\\rho u^2) \\end{pmatrix} $$\nDifferentiating yields:\n$$ \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{V}} = \\begin{pmatrix}\nu & \\rho & 0 \\\\\nu^2 & 2\\rho u & 1 \\\\\n\\frac{1}{2}u^3 & \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 & \\frac{\\gamma u}{\\gamma-1}\n\\end{pmatrix}\n$$\nNow we can find $\\mathbf{B}$ as $\\mathbf{B} = \\mathbf{U}_{\\mathbf{V}}^{-1} (\\partial \\mathbf{F}/\\partial \\mathbf{V})$:\n$$\n\\mathbf{B}(\\mathbf{V}) = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n-u/\\rho & 1/\\rho & 0 \\\\\n\\frac{\\gamma-1}{2}u^2 & -(\\gamma-1)u & \\gamma-1\n\\end{pmatrix} \\begin{pmatrix}\nu & \\rho & 0 \\\\\nu^2 & 2\\rho u & 1 \\\\\n\\frac{1}{2}u^3 & \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 & \\frac{\\gamma u}{\\gamma-1}\n\\end{pmatrix} = \\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\gamma p & u\n\\end{pmatrix}\n$$\nUsing $c^2=\\gamma p/\\rho$, we can write this as:\n$$\n\\mathbf{B}(\\mathbf{V}) = \\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\rho c^2 & u\n\\end{pmatrix}\n$$\n\n**Part 3: Comparison of Eigenstructures and Jacobians**\n\nSince $\\mathbf{B}$ is related to $\\mathbf{A}$ by a similarity transformation, they share the same eigenvalues. We can verify this by computing the characteristic polynomial of $\\mathbf{B}$:\n$$ \\det(\\mathbf{B}-\\lambda\\mathbf{I}) = \\begin{vmatrix} u-\\lambda & \\rho & 0 \\\\ 0 & u-\\lambda & 1/\\rho \\\\ 0 & \\rho c^2 & u-\\lambda \\end{vmatrix} = (u-\\lambda)\\left( (u-\\lambda)^2 - (\\rho c^2)(1/\\rho) \\right) = (u-\\lambda)( (u-\\lambda)^2 - c^2 ) = 0 $$\nThis yields the eigenvalues $\\lambda = u, u \\pm c$, identical to those of $\\mathbf{A}$.\n\nHowever, their eigenvectors are different. The right eigenvectors of $\\mathbf{B}$ are:\n$$\n\\mathbf{r}_{B,1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{r}_{B,2} = \\begin{pmatrix} \\rho \\\\ -c \\\\ \\rho c^2 \\end{pmatrix}, \\quad\n\\mathbf{r}_{B,3} = \\begin{pmatrix} \\rho \\\\ c \\\\ \\rho c^2 \\end{pmatrix}\n$$\nThese eigenvectors represent perturbations in primitive variable space $(\\delta\\rho, \\delta u, \\delta p)^T$, whereas the eigenvectors of $\\mathbf{A}$ represent perturbations in conserved variable space.\n\nThe distinction between $\\mathbf{B}(\\mathbf{V})$ and $\\partial \\mathbf{F}/\\partial \\mathbf{V}$ is fundamental. The conservation law $\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = 0$ can be rewritten in terms of primitive variables using the chain rule:\n$$ \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{V}}\\frac{\\partial \\mathbf{V}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{V}}\\frac{\\partial \\mathbf{V}}{\\partial x} = 0 \\implies \\mathbf{U}_{\\mathbf{V}} \\frac{\\partial \\mathbf{V}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{V}} \\frac{\\partial \\mathbf{V}}{\\partial x} = 0 $$\nTo obtain the standard quasilinear form $\\partial_t \\mathbf{V} + \\mathbf{B} \\partial_x \\mathbf{V} = 0$, we must multiply by $\\mathbf{U}_{\\mathbf{V}}^{-1}$:\n$$ \\frac{\\partial \\mathbf{V}}{\\partial t} + \\left(\\mathbf{U}_{\\mathbf{V}}^{-1} \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{V}}\\right) \\frac{\\partial \\mathbf{V}}{\\partial x} = 0 $$\nThus, $\\mathbf{B}(\\mathbf{V}) = \\mathbf{U}_{\\mathbf{V}}^{-1}(\\partial \\mathbf{F}/\\partial \\mathbf{V})$ is the authentic system Jacobian for the primitive variable formulation, and its eigenvalues are the characteristic wave speeds. In contrast, $\\partial \\mathbf{F}/\\partial \\mathbf{V}$ is an intermediate matrix that does not, by itself, represent the system's characteristic structure. The Euler equations in primitive variables are not in conservation form, meaning there is no flux function $\\mathbf{G}(\\mathbf{V})$ such that $\\mathbf{B} = \\partial \\mathbf{G}/\\partial \\mathbf{V}$.\n\n**Part 4: Determinant of the Primitive-Variable Jacobian**\n\nThe determinant of a matrix is the product of its eigenvalues. For $\\mathbf{B}(\\mathbf{V})$, the eigenvalues are $u, u-c, u+c$. Therefore:\n$$ \\det(\\mathbf{B}(\\mathbf{V})) = (u)(u-c)(u+c) = u(u^2-c^2) $$\nThis can be confirmed by direct calculation from the matrix form of $\\mathbf{B}(\\mathbf{V})$:\n$$ \\det(\\mathbf{B}(\\mathbf{V})) = \\det \\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\rho c^2 & u\n\\end{pmatrix} = u \\begin{vmatrix} u & 1/\\rho \\\\ \\rho c^2 & u \\end{vmatrix} - \\rho \\begin{vmatrix} 0 & 1/\\rho \\\\ 0 & u \\end{vmatrix} = u(u^2 - (\\rho c^2)(1/\\rho)) - 0 = u(u^2 - c^2) $$\nThe final expression is in terms of only $u$ and $c$, as requested.", "answer": "$$\n\\boxed{u(u^2 - c^2)}\n$$", "id": "3304162"}, {"introduction": "While conservative variables are ideal for ensuring conservation, physical processes and boundary conditions are often described using primitive variables like pressure $p$ and temperature $T$. This exercise explores the practical and crucial step of converting from the conserved state vector $\\mathbf{U}$ to primitive variables, and asks you to assess the numerical conditioning of this transformation [@problem_id:3304151]. Poor conditioning in this step can lead to robustness issues in a CFD solver, especially in low-Mach or near-vacuum flow regimes.", "problem": "Consider a three-dimensional compressible inviscid ideal-gas flow as modeled in Computational Fluid Dynamics (CFD). The conserved-variable vector is defined as $\\mathbf{U} = [U_{1}, U_{2}, U_{3}, U_{4}, U_{5}]^{\\top} = [\\rho, \\rho u, \\rho v, \\rho w, \\rho E]^{\\top}$, where $\\rho$ is the density, $u$, $v$, and $w$ are the Cartesian velocity components, and $E$ is the total specific energy. The primitive variables are related by the thermodynamic ideal-gas relations: $E = e + \\frac{1}{2}(u^{2} + v^{2} + w^{2})$, $p = (\\gamma - 1)\\rho e$, $p = \\rho R T$, and $c_{v} = \\frac{R}{\\gamma - 1}$, where $p$ is the pressure, $T$ is the temperature, $\\gamma$ is the ratio of specific heats, $R$ is the specific gas constant, and $c_{v}$ is the specific heat at constant volume.\n\nStarting from these fundamental relations, derive the expressions for the partial derivatives $\\frac{\\partial p}{\\partial \\mathbf{U}}$ and $\\frac{\\partial T}{\\partial \\mathbf{U}}$ in terms of the components of $\\mathbf{U}$ for a general state. Then, evaluate these derivatives at the thermodynamic state given by\n$\\rho = 1~\\mathrm{kg/m^{3}}$, $u = v = w = 0~\\mathrm{m/s}$, $T = 300~\\mathrm{K}$, $\\gamma = 1.4$, and $R = 287~\\mathrm{J/(kg\\cdot K)}$.\n\nForm the $2 \\times 5$ Jacobian matrix $\\mathbf{J}$ whose first row is $\\frac{\\partial p}{\\partial \\mathbf{U}}$ and second row is $\\frac{\\partial T}{\\partial \\mathbf{U}}$, both evaluated at the given state. Using $\\mathbf{J}$, assess the local conditioning of primitive recovery for $(p, T)$ from $\\mathbf{U}$ by computing the condition number $\\kappa(\\mathbf{J})$, defined as the ratio of the largest singular value of $\\mathbf{J}$ to its smallest singular value. Use the standard definition of singular values as the square roots of the eigenvalues of $\\mathbf{J}\\mathbf{J}^{\\top}$.\n\nRound your final value of $\\kappa(\\mathbf{J})$ to four significant figures. Express the final answer as a pure number without units.", "solution": "We begin with the definitions of the conserved variables $\\mathbf{U} = [U_{1}, U_{2}, U_{3}, U_{4}, U_{5}]^{\\top} = [\\rho, \\rho u, \\rho v, \\rho w, \\rho E]^{\\top}$ and the thermodynamic relations for an ideal gas. The velocity components are recovered from $\\mathbf{U}$ via\n$$\nu = \\frac{U_{2}}{U_{1}}, \\quad v = \\frac{U_{3}}{U_{1}}, \\quad w = \\frac{U_{4}}{U_{1}}.\n$$\nThe kinetic energy per unit mass is $\\frac{1}{2}(u^{2} + v^{2} + w^{2}) = \\frac{1}{2}\\left(\\frac{U_{2}^{2} + U_{3}^{2} + U_{4}^{2}}{U_{1}^{2}}\\right)$ and the total energy per unit mass is $E = e + \\frac{1}{2}(u^{2} + v^{2} + w^{2})$. The pressure can be written in terms of $\\mathbf{U}$ using $p = (\\gamma - 1)\\rho e$ and $\\rho e = \\rho E - \\frac{1}{2}\\rho(u^{2} + v^{2} + w^{2})$:\n$$\np(\\mathbf{U}) = (\\gamma - 1)\\left(U_{5} - \\frac{1}{2}\\frac{U_{2}^{2} + U_{3}^{2} + U_{4}^{2}}{U_{1}}\\right).\n$$\nDefine the momentum magnitude squared $m^{2} = U_{2}^{2} + U_{3}^{2} + U_{4}^{2}$. Then\n$$\np(\\mathbf{U}) = (\\gamma - 1)\\left(U_{5} - \\frac{1}{2}\\frac{m^{2}}{U_{1}}\\right).\n$$\nDifferentiating $p$ with respect to the components of $\\mathbf{U}$ yields\n$$\n\\frac{\\partial p}{\\partial U_{1}} = (\\gamma - 1)\\left(\\frac{1}{2}\\frac{m^{2}}{U_{1}^{2}}\\right), \\quad\n\\frac{\\partial p}{\\partial U_{2}} = -(\\gamma - 1)\\frac{U_{2}}{U_{1}}, \\quad\n\\frac{\\partial p}{\\partial U_{3}} = -(\\gamma - 1)\\frac{U_{3}}{U_{1}}, \\quad\n\\frac{\\partial p}{\\partial U_{4}} = -(\\gamma - 1)\\frac{U_{4}}{U_{1}}, \\quad\n\\frac{\\partial p}{\\partial U_{5}} = (\\gamma - 1).\n$$\nHence, in vector form,\n$$\n\\frac{\\partial p}{\\partial \\mathbf{U}} = (\\gamma - 1)\\left[\\frac{1}{2}\\frac{m^{2}}{U_{1}^{2}},\\; -\\frac{U_{2}}{U_{1}},\\; -\\frac{U_{3}}{U_{1}},\\; -\\frac{U_{4}}{U_{1}},\\; 1\\right].\n$$\nFor the temperature, we use $p = \\rho R T$, which gives\n$$\nT(\\mathbf{U}) = \\frac{p(\\mathbf{U})}{U_{1} R}.\n$$\nDifferentiate $T$ with respect to $\\mathbf{U}$ via the product rule:\n$$\n\\frac{\\partial T}{\\partial U_{1}} = \\frac{1}{R}\\left(-\\frac{p}{U_{1}^{2}} + \\frac{1}{U_{1}}\\frac{\\partial p}{\\partial U_{1}}\\right), \\quad\n\\frac{\\partial T}{\\partial U_{j}} = \\frac{1}{R}\\frac{1}{U_{1}} \\frac{\\partial p}{\\partial U_{j}}, \\quad j \\in \\{2,3,4,5\\}.\n$$\nTherefore,\n$$\n\\frac{\\partial T}{\\partial \\mathbf{U}} = \\frac{1}{R}\\left[-\\frac{p}{U_{1}^{2}} + \\frac{1}{U_{1}}\\frac{\\partial p}{\\partial U_{1}},\\; \\frac{1}{U_{1}}\\frac{\\partial p}{\\partial U_{2}},\\; \\frac{1}{U_{1}}\\frac{\\partial p}{\\partial U_{3}},\\; \\frac{1}{U_{1}}\\frac{\\partial p}{\\partial U_{4}},\\; \\frac{1}{U_{1}}\\frac{\\partial p}{\\partial U_{5}}\\right].\n$$\n\nWe now evaluate these derivatives at the given state: $\\rho = 1$, $u = v = w = 0$, $T = 300$, $\\gamma = 1.4$, and $R = 287$. First compute auxiliary quantities. Since $u = v = w = 0$, we have $U_{2} = U_{3} = U_{4} = 0$, so $m^{2} = 0$. The specific heat is $c_{v} = \\frac{R}{\\gamma - 1} = \\frac{287}{0.4} = 717.5$. The internal energy per unit mass is $e = c_{v} T = 717.5 \\times 300 = 215{,}250$, and since the velocity is zero, $E = e$. Thus $U_{1} = \\rho = 1$, $U_{2} = U_{3} = U_{4} = 0$, and $U_{5} = \\rho E = 1 \\times 215{,}250 = 215{,}250$. The pressure is $p = \\rho R T = 1 \\times 287 \\times 300 = 86{,}100$, which is also consistent with $p = (\\gamma - 1) U_{5} = 0.4 \\times 215{,}250 = 86{,}100$.\n\nEvaluating $\\frac{\\partial p}{\\partial \\mathbf{U}}$ at this state:\n- Since $m^{2} = 0$, $\\frac{\\partial p}{\\partial U_{1}} = 0$.\n- $\\frac{\\partial p}{\\partial U_{2}} = \\frac{\\partial p}{\\partial U_{3}} = \\frac{\\partial p}{\\partial U_{4}} = 0$ because $U_{2} = U_{3} = U_{4} = 0$.\n- $\\frac{\\partial p}{\\partial U_{5}} = \\gamma - 1 = 0.4$.\n\nHence,\n$$\n\\left.\\frac{\\partial p}{\\partial \\mathbf{U}}\\right|_{\\text{state}} = \\left[0,\\; 0,\\; 0,\\; 0,\\; 0.4\\right].\n$$\n\nEvaluating $\\frac{\\partial T}{\\partial \\mathbf{U}}$, we use\n$$\n\\frac{\\partial T}{\\partial U_{1}} = \\frac{1}{R}\\left(-\\frac{p}{U_{1}^{2}} + \\frac{1}{U_{1}}\\frac{\\partial p}{\\partial U_{1}}\\right) = \\frac{1}{287}\\left(-86{,}100 + 0\\right) = -\\frac{86{,}100}{287} = -300,\n$$\nand for $j \\in \\{2,3,4\\}$,\n$$\n\\frac{\\partial T}{\\partial U_{j}} = \\frac{1}{R U_{1}}\\frac{\\partial p}{\\partial U_{j}} = \\frac{1}{287}\\times 0 = 0.\n$$\nFinally,\n$$\n\\frac{\\partial T}{\\partial U_{5}} = \\frac{1}{R U_{1}}\\frac{\\partial p}{\\partial U_{5}} = \\frac{1}{287}\\times 0.4 = \\frac{0.4}{287} = \\frac{2}{1435} \\approx 0.001393.\n$$\nThus,\n$$\n\\left.\\frac{\\partial T}{\\partial \\mathbf{U}}\\right|_{\\text{state}} = \\left[-300,\\; 0,\\; 0,\\; 0,\\; \\frac{2}{1435}\\right].\n$$\n\nForm the $2 \\times 5$ Jacobian matrix $\\mathbf{J}$ at the state,\n$$\n\\mathbf{J} = \n\\begin{pmatrix}\n0 & 0 & 0 & 0 & 0.4 \\\\\n-300 & 0 & 0 & 0 & \\dfrac{2}{1435}\n\\end{pmatrix}.\n$$\nTo assess conditioning, compute the singular values of $\\mathbf{J}$ as the square roots of the eigenvalues of $\\mathbf{J}\\mathbf{J}^{\\top}$. We have\n$$\n\\mathbf{J}\\mathbf{J}^{\\top} =\n\\begin{pmatrix}\n0.4^{2} & 0.4\\left(\\dfrac{2}{1435}\\right) \\\\\n0.4\\left(\\dfrac{2}{1435}\\right) & (-300)^{2} + \\left(\\dfrac{2}{1435}\\right)^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.16 & \\dfrac{0.8}{1435} \\\\\n\\dfrac{0.8}{1435} & 90{,}000 + \\dfrac{4}{2{,}059{,}225}\n\\end{pmatrix}.\n$$\nDenote this symmetric matrix by\n$$\n\\mathbf{M} =\n\\begin{pmatrix}\nd & e \\\\\ne & f\n\\end{pmatrix},\n\\quad\nd = 0.16,\\quad e = \\frac{0.8}{1435},\\quad f = 90{,}000 + \\frac{4}{2{,}059{,}225}.\n$$\nThe eigenvalues of $\\mathbf{M}$ are the roots of the characteristic equation $\\lambda^2 - (d+f)\\lambda + (df - e^2) = 0$.\nThe determinant is $df - e^{2} = 0.16\\left(90{,}000 + \\frac{4}{2{,}059{,}225}\\right) - \\left(\\frac{0.8}{1435}\\right)^{2} = 14{,}400$.\nThe trace is $d + f \\approx 90{,}000.16$.\nThe eigenvalues are approximately $\\lambda_{+} \\approx d+f \\approx 90000.16$ and $\\lambda_{-} \\approx \\frac{df-e^2}{d+f} \\approx \\frac{14400}{90000.16} \\approx 0.16$.\nMore precisely, $\\sigma_{\\max} = \\sqrt{\\lambda_{+}} \\approx 300.000$ and $\\sigma_{\\min} = \\sqrt{\\lambda_{-}} \\approx 0.400035$.\nThus, the condition number is\n$$\n\\kappa(\\mathbf{J}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} \\approx \\frac{300.000}{0.400035} \\approx 749.96.\n$$\nRounded to four significant figures, the condition number is $750.0$. This large value reflects strong anisotropy in sensitivity: temperature is highly sensitive to changes in $U_{1}$ relative to pressure at this quiescent state, making recovery of $(p, T)$ from $\\mathbf{U}$ moderately ill-conditioned along density-energy directions.\n\nThe requested final answer is the rounded condition number as a pure number.", "answer": "$$\n\\boxed{7.500 \\times 10^{2}}\n$$", "id": "3304151"}, {"introduction": "The core tenet of modern shock-capturing methods is the use of a conservative formulation, but why is this so critical? This numerical experiment provides a first look at this question by tasking you with implementing a scheme based on the non-conservative form of the Burgers' equation and observing its behavior on a shock wave. You will numerically investigate the convergence of the shock speed. While for the specific case of Burgers' equation the non-conservative form happens to yield the correct shock speed, this is a misleading coincidence not true for general conservation laws, and this exercise highlights the nuances in analyzing such schemes.", "problem": "You are asked to design and analyze a numerical method for a one-dimensional scalar conservation law in a way that distinguishes conservative and nonconservative formulations in computational fluid dynamics (CFD). The core focus is to demonstrate, via a reproducible numerical experiment, that a scheme which is consistent but not conservative can converge to a weak solution that violates the Rankine–Hugoniot jump condition.\n\nConsider the scalar conservation law for the inviscid Burgers equation on a one-dimensional domain,\n$$\nu_t + \\left(\\tfrac{1}{2} u^2\\right)_x = 0,\n$$\nposed on a uniform grid on the interval $[-1,1]$ with Riemann initial data\n$$\nu(x,0) = \\begin{cases}\nu_L, & x < 0,\\\\\nu_R, & x \\ge 0.\n\\end{cases}\n$$\nHere $u$ is dimensionless. You may assume standard mathematical smoothness wherever needed for formal consistency analysis.\n\nYour tasks are:\n\n- Construct a finite difference time-marching scheme that is consistent for smooth solutions but not conservative for discontinuous solutions. Base your construction on the quasi-linear form\n$$\nu_t + a(u)\\,u_x = 0,\\quad a(u) = f'(u) = u,\n$$\nand use upwinding based on the local characteristic speed. Choose a time step that satisfies a Courant–Friedrichs–Lewy (CFL) condition with a specified Courant number and the maximum local characteristic speed magnitude. Do not rewrite the scheme in conservative flux-difference form. Your scheme must evolve cell-centered values on a uniform grid, and you must implement outflow (constant extrapolation) boundary conditions at both ends of the interval.\n\n- Using the Rankine–Hugoniot jump condition for the conservation law,\n$$\ns_{\\mathrm{RH}} = \\frac{f(u_L) - f(u_R)}{u_L - u_R},\n$$\nwith $f(u)=\\tfrac{1}{2}u^2$, define a numerical diagnostic to estimate the shock speed at a final time $T$ from the computed profile for a Riemann problem with $u_L > u_R$. Estimate the instantaneous shock position by locating where the numerical solution crosses the midpoint value $m = \\tfrac{1}{2}(u_L + u_R)$ and dividing its position by $T$ to produce an estimated speed. For rarefaction data $u_L < u_R$, compute the $L^1$ error against the exact self-similar rarefaction solution \n$$\nu(x,T) = \\begin{cases}\nu_L, & x/T \\le u_L,\\\\\nx/T, & u_L < x/T < u_R,\\\\\nu_R, & x/T \\ge u_R.\n\\end{cases}\n$$\nFor constant data $u_L = u_R$, compute the $L^\\infty$ error at the final time $T$.\n\n- All quantities are dimensionless. Report speeds in units of grid-length per unit-time implied by the non-dimensionalization. No other unit conversions are needed.\n\nYour program must implement the nonconservative, consistent upwind scheme described above and produce a single line of output containing the aggregated numerical results for the following test suite:\n\n- Test A (shock): $u_L=2$, $u_R=0$, with final time $T=0.2$, Courant number $\\mathrm{CFL}=0.4$, uniform grids with $N \\in \\{200, 400, 800\\}$ cells over $[-1,1]$. For each $N$, estimate the numerical shock speed $s_{\\mathrm{num}}(N)$ as described. Also compute the Rankine–Hugoniot speed $s_{\\mathrm{RH}}$ for these data and the absolute difference $\\lvert s_{\\mathrm{num}}(800) - s_{\\mathrm{RH}}\\rvert$. Additionally, report a boolean indicating whether $\\lvert s_{\\mathrm{num}}(800) - s_{\\mathrm{RH}}\\rvert > 0.25$.\n\n- Test B (rarefaction): $u_L=0$, $u_R=2$, with final time $T=0.2$, Courant number $\\mathrm{CFL}=0.4$, and $N=800$. Compute the $L^1$ error against the exact rarefaction profile on $[-1,1]$.\n\n- Test C (constant state): $u_L=u_R=1$, with final time $T=0.2$, Courant number $\\mathrm{CFL}=0.4$, and $N=200$. Compute the $L^\\infty$ error at time $T$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n$$\n\\big[s_{\\mathrm{num}}(200),\\, s_{\\mathrm{num}}(400),\\, s_{\\mathrm{num}}(800),\\, s_{\\mathrm{RH}},\\, \\lvert s_{\\mathrm{num}}(800)-s_{\\mathrm{RH}}\\rvert,\\, \\text{violation\\_boolean},\\, L^1\\_B,\\, L^\\infty\\_C\\big].\n$$\nThe values $s_{\\mathrm{num}}(N)$ and $s_{\\mathrm{RH}}$ must be floats, the absolute difference must be a float, the violation flag must be a boolean, $L^1\\_B$ must be a float, and $L^\\infty\\_C$ must be a float. The computation must be entirely self-contained, require no user input, and use the given parameter values exactly as specified above. The single line of output must be the only printed output.", "solution": "The problem presented is a valid numerical analysis exercise in computational fluid dynamics. It is scientifically grounded, well-posed, and objective. It tasks us with demonstrating a fundamental concept: the failure of a non-conservative numerical scheme to capture the correct weak solution of a conservation law, specifically by converging to a shock wave that propagates at a speed violating the Rankine-Hugoniot condition.\n\nThe problem centers on the one-dimensional inviscid Burgers' equation, a canonical model for hyperbolic conservation laws. Its conservative form is\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2} u^2 \\right) = 0.\n$$\nFor smooth solutions, the chain rule allows this to be written in the quasi-linear form,\n$$\n\\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} = 0,\n$$\nwhere $a(u) = u$ is the characteristic speed. While these two forms are equivalent for smooth solutions, their weak solutions, which admit discontinuities (shocks), are not equivalent. The conservative form is the physically correct one, derived from an integral balance law. A numerical scheme must be in conservation form to guarantee that its solutions converge to a weak solution satisfying the correct jump conditions.\n\nWe will construct a numerical scheme based on the non-conservative quasi-linear form and observe its behavior. For a Riemann problem generating a shock ($u_L > u_R$), we will see that this scheme converges to a shock wave. For the specific case of Burgers' equation, the predicted shock speed happens to coincide with the correct Rankine-Hugoniot speed. This is a special property of this equation and this type of scheme, and is not true for general conservation laws, where such a non-conservative approach would lead to an incorrect shock speed.\n\n**1. Numerical Discretization**\n\nWe discretize the spatial domain $x \\in [-1, 1]$ into $N$ uniform cells. The grid spacing is $\\Delta x = 2/N$. The solution is represented by cell-centered values $U_j^n$, which approximate the solution $u(x_j, t_n)$ at cell centers $x_j = -1 + (j+0.5)\\Delta x$ for $j=0, 1, \\dots, N-1$ and time $t_n = n\\Delta t$.\n\nThe initial condition is a Riemann problem,\n$$\nu(x,0) = \\begin{cases}\nu_L, & x < 0,\\\\\nu_R, & x \\ge 0.\n\\end{cases}\n$$\nThis is discretized by setting $U_j^0 = u_L$ if $x_j < 0$ and $U_j^0 = u_R$ if $x_j \\ge 0$.\n\n**2. Non-Conservative Upwind Scheme**\n\nWe are tasked to create a scheme based on the quasi-linear form $u_t + u u_x = 0$. We use a forward Euler method for time integration and a first-order upwind scheme for the spatial derivative $u_x$. The upwind direction is determined by the sign of the local characteristic speed, $a(u_j) = U_j^n$.\n\nThe semi-discrete approximation at cell $j$ is\n$$\n\\frac{dU_j}{dt} = -U_j (u_x)_j.\n$$\nThe upwind discretization for $(u_x)_j$ is:\n$$\n(u_x)_j \\approx \\begin{cases}\n(U_j^n - U_{j-1}^n)/\\Delta x, & \\text{if } U_j^n \\ge 0 \\\\\n(U_{j+1}^n - U_j^n)/\\Delta x, & \\text{if } U_j^n < 0\n\\end{cases}\n$$\nCombining these with forward Euler time-stepping, the full update rule is:\n$$\nU_j^{n+1} = U_j^n - \\frac{\\Delta t}{\\Delta x} U_j^n \\times \\begin{cases}\n(U_j^n - U_{j-1}^n), & \\text{if } U_j^n \\ge 0 \\\\\n(U_{j+1}^n - U_j^n), & \\text{if } U_j^n < 0\n\\end{cases}\n$$\nThis scheme is not conservative because it cannot be written in the flux-difference form $U_j^{n+1} = U_j^n - \\frac{\\Delta t}{\\Delta x}(F_{j+1/2} - F_{j-1/2})$, where $F$ is a consistent numerical flux. Summing the updates over the grid does not result in a telescoping sum of fluxes, meaning the discrete total mass $\\sum_j U_j \\Delta x$ is not conserved up to boundary fluxes.\n\n**3. Time Step and Boundary Conditions**\n\nTo ensure numerical stability, the time step $\\Delta t$ is chosen to satisfy a Courant-Friedrichs-Lewy (CFL) condition. For an explicit scheme, we must ensure that the numerical domain of dependence contains the physical domain of dependence. This requires\n$$\n\\Delta t \\le \\mathrm{CFL} \\frac{\\Delta x}{\\max_j |a(U_j^n)|} \\implies \\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{\\max_j |U_j^n|}.\n$$\nThe time step is re-calculated at every iteration based on the current maximum wave speed in the domain. To reach the final time $T$ exactly, the last time step is adjusted if necessary.\n\nOutflow boundary conditions are implemented using ghost cells. We add one ghost cell at each end of the domain, $U_{-1}$ and $U_N$. The values are set by constant extrapolation: $U_{-1}^n = U_0^n$ and $U_N^n = U_{N-1}^n$.\n\n**4. Numerical Diagnostics**\n\n- **Test A (Shock):** For the case $u_L > u_R$, a shock wave forms. The theoretically correct shock speed $s_{\\mathrm{RH}}$ is given by the Rankine-Hugoniot jump condition for the conservative equation with flux $f(u) = \\frac{1}{2}u^2$:\n$$\ns_{\\mathrm{RH}} = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{\\frac{1}{2}u_L^2 - \\frac{1}{2}u_R^2}{u_L - u_R} = \\frac{1}{2}(u_L + u_R).\n$$\nFor $u_L=2$ and $u_R=0$, we have $s_{\\mathrm{RH}} = \\frac{1}{2}(2+0) = 1$. The numerical shock speed $s_{\\mathrm{num}}$ is estimated from the final solution profile at time $T$. We find the position $x_{\\mathrm{shock}}$ where the solution crosses the midpoint value $m = \\frac{1}{2}(u_L+u_R) = 1$. This position is found by linear interpolation between the two grid cells bracketing the value $m$. The speed is then $s_{\\mathrm{num}} = x_{\\mathrm{shock}} / T$.\n\n- **Test B (Rarefaction):** For $u_L < u_R$, a smooth rarefaction wave develops. The exact solution is self-similar, depending only on $\\xi = x/t$. We compare our numerical solution $U_{\\mathrm{final}}$ at time $T$ to the exact solution $u_{\\mathrm{exact}}(x_j, T)$ and compute the $L^1$ error:\n$$\nL^1 \\text{ error} = \\sum_{j=0}^{N-1} |U_{\\mathrm{final},j} - u_{\\mathrm{exact}}(x_j, T)| \\Delta x.\n$$\n\n- **Test C (Constant State):** For $u_L=u_R=c$, the exact solution is $u(x,t)=c$. The non-conservative upwind scheme is exact for this case, as the spatial difference term is zero. The error should be on the order of machine precision. We compute the $L^\\infty$ error:\n$$\nL^\\infty \\text{ error} = \\max_{j} |U_{\\mathrm{final},j} - c|.\n$$\n\nThe specified computations will be performed for the three test cases, and the results will be aggregated as requested. This will numerically show that the non-conservative scheme is consistent for smooth flows (Tests B and C). For Test A, it will show that the scheme converges to the correct shock speed, a result that is specific to Burgers' equation and does not generalize, thus highlighting the danger of drawing broad conclusions from a single test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(u_l, u_r, N, T_final, CFL):\n    \"\"\"\n    Solves the 1D Burgers' equation using a non-conservative upwind scheme.\n    \"\"\"\n    # Grid setup\n    L_domain = 2.0\n    dx = L_domain / N\n    x = -1.0 + (np.arange(N) + 0.5) * dx\n\n    # Initial condition\n    u = np.full(N, u_r)\n    u[x < 0] = u_l\n\n    t = 0.0\n    while t < T_final:\n        # Calculate time step based on CFL condition\n        max_abs_u = np.max(np.abs(u))\n        if max_abs_u == 0:\n            # If u is zero everywhere, dt can be T_final - t\n            # or a large number. Let's make it not infinite.\n            dt = T_final - t\n        else:\n            dt = CFL * dx / max_abs_u\n\n        # Ensure we do not step past the final time\n        if t + dt > T_final:\n            dt = T_final - t\n\n        # Pad the solution array with ghost cells for boundary conditions\n        # Outflow (constant extrapolation)\n        u_padded = np.pad(u, 1, mode='edge')\n        \n        # Vectorized calculation of the spatial derivative term\n        u_conv = np.zeros_like(u)\n\n        # Positive speeds: upwind from left\n        pos_mask = u >= 0\n        if np.any(pos_mask):\n            u_j = u_padded[1:-1][pos_mask]\n            u_jm1 = u_padded[:-2][pos_mask]\n            u_conv[pos_mask] = u_j * (u_j - u_jm1)\n\n        # Negative speeds: upwind from right\n        neg_mask = u < 0\n        if np.any(neg_mask):\n            u_j = u_padded[1:-1][neg_mask]\n            u_jp1 = u_padded[2:][neg_mask]\n            u_conv[neg_mask] = u_j * (u_jp1 - u_j)\n\n        # Forward Euler update\n        u = u - (dt / dx) * u_conv\n        t += dt\n\n    return x, u\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and produce the final output.\n    \"\"\"\n    # --- Test A: Schock Problem ---\n    u_l_A, u_r_A = 2.0, 0.0\n    T_A = 0.2\n    CFL_A = 0.4\n    N_vals_A = [200, 400, 800]\n    \n    s_num_list = []\n    for N in N_vals_A:\n        x, u_final = run_simulation(u_l_A, u_r_A, N, T_A, CFL_A)\n        dx = x[1] - x[0]\n        \n        # Find shock position by interpolation\n        mid_val = 0.5 * (u_l_A + u_r_A)\n        \n        # Find index j where u[j] >= mid_val and u[j+1] < mid_val\n        cross_indices = np.where((u_final[:-1] >= mid_val) & (u_final[1:] < mid_val))[0]\n        \n        if len(cross_indices) > 0:\n            j = cross_indices[0]\n            x_j = x[j]\n            u_j = u_final[j]\n            u_jp1 = u_final[j+1]\n            \n            # Linear interpolation to find x_shock\n            x_shock = x_j + dx * (u_j - mid_val) / (u_j - u_jp1)\n            s_num = x_shock / T_A\n        else:\n            # Fallback if no crossing is found (should not happen for this problem)\n            s_num = np.nan\n            \n        s_num_list.append(s_num)\n\n    s_rh = 0.5 * (u_l_A**2 - u_r_A**2) / (u_l_A - u_r_A)\n    abs_diff = np.abs(s_num_list[-1] - s_rh)\n    violation_boolean = abs_diff > 0.25\n\n    # --- Test B: Rarefaction Problem ---\n    u_l_B, u_r_B = 0.0, 2.0\n    T_B = 0.2\n    CFL_B = 0.4\n    N_B = 800\n    \n    x_B, u_final_B = run_simulation(u_l_B, u_r_B, N_B, T_B, CFL_B)\n    dx_B = x_B[1] - x_B[0]\n    \n    # Exact solution for rarefaction\n    xt = x_B / T_B\n    u_exact_B = np.zeros_like(x_B)\n    mask1 = xt <= u_l_B\n    mask2 = xt >= u_r_B\n    mask3 = (~mask1) & (~mask2)\n    u_exact_B[mask1] = u_l_B\n    u_exact_B[mask2] = u_r_B\n    u_exact_B[mask3] = xt[mask3]\n    \n    l1_error_B = np.sum(np.abs(u_final_B - u_exact_B)) * dx_B\n\n    # --- Test C: Constant State ---\n    u_l_C, u_r_C = 1.0, 1.0\n    T_C = 0.2\n    CFL_C = 0.4\n    N_C = 200\n\n    x_C, u_final_C = run_simulation(u_l_C, u_r_C, N_C, T_C, CFL_C)\n    \n    l_inf_error_C = np.max(np.abs(u_final_C - u_l_C))\n    \n    # --- Final Output ---\n    results = [\n        s_num_list[0],\n        s_num_list[1],\n        s_num_list[2],\n        s_rh,\n        abs_diff,\n        violation_boolean,\n        l1_error_B,\n        l_inf_error_C\n    ]\n    \n    # Format the output string\n    formatted_results = []\n    for r in results:\n        if isinstance(r, bool):\n            formatted_results.append(str(r).lower())\n        else:\n            formatted_results.append(f\"{r}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3304192"}]}