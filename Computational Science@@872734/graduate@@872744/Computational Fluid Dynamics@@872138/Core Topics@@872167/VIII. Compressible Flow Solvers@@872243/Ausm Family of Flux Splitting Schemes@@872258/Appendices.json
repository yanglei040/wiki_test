{"hands_on_practices": [{"introduction": "Before a numerical scheme can be judged on its accuracy, it must first be stable. This first practice explores the fundamental stability constraint for any explicit time-integration scheme, known as the Courant-Friedrichs-Lewy (CFL) condition. By analyzing the core principles of the Advection Upstream Splitting Method (AUSM) in the context of the Euler equations' wave structure, you will derive the maximum permissible time step, connecting the scheme's design to the fastest physical speed at which information propagates in the system [@problem_id:3292940].", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with a constant ratio of specific heats $\\gamma$,\n$$\n\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$ and $\\boldsymbol{F}(\\boldsymbol{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}$, with pressure $p$ given by the ideal-gas equation of state $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$. Let $a = \\sqrt{\\gamma p / \\rho}$ denote the speed of sound and $u$ the flow velocity.\n\nDiscretize the spatial domain using a uniform finite volume mesh with cell width $\\Delta x$ and denote cell averages by $\\boldsymbol{Q}_{i}(t)$. Let the numerical flux at face $x_{i+\\frac{1}{2}}$ be given by a member of the Advection Upstream Splitting Method (AUSM) family (Advection Upstream Splitting Method (AUSM)), constructed by splitting the flux into a convective part and an acoustic (pressure) part through Mach-number-based polynomials that recover exact upwinding in supersonic limits and preserve linearized consistency about a uniform state. Advance in time with an explicit forward Euler update,\n$$\n\\boldsymbol{Q}_{i}^{n+1} = \\boldsymbol{Q}_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(\\boldsymbol{F}_{i+\\frac{1}{2}}^{n} - \\boldsymbol{F}_{i-\\frac{1}{2}}^{n}\\right).\n$$\n\nStarting from the Euler equations’ characteristic structure and the AUSM construction principles stated above, analyze the spectral radius of the semi-discrete spatial operator implied by AUSM at a uniform reference state where $u$ and $a$ are constant across all faces. Identify the relevant wave speeds captured by AUSM and, by linearizing the scheme about this uniform state and invoking the requirement for monotonicity of a first-order upwind flux in each characteristic field, derive a sufficient Courant–Friedrichs–Lewy (CFL) stability bound for the forward Euler update in terms of the maximum characteristic speed.\n\nUnder these assumptions, what is the largest admissible time step $\\Delta t_{\\max}$ that guarantees stability of the forward Euler update with the AUSM flux on this uniform mesh, expressed in terms of $\\Delta x$, $|u|$, and $a$? Express your answer in terms of $\\Delta x$ (in meters), $u$ (in meters per second), and $a$ (in meters per second), so that $\\Delta t_{\\max}$ is in seconds. Your final answer must be a single closed-form analytic expression.", "solution": "The problem requires the derivation of the Courant–Friedrichs–Lewy (CFL) stability bound for a first-order Euler forward time-stepping scheme applied to the one-dimensional compressible Euler equations, discretized using a numerical flux from the Advection Upstream Splitting Method (AUSM) family. The analysis is to be performed for a uniform reference state.\n\nThe semi-discrete finite volume formulation for a cell $i$ is given by the time evolution of the cell-averaged state vector $\\boldsymbol{Q}_i$:\n$$\n\\frac{d\\boldsymbol{Q}_i}{dt} = -\\frac{1}{\\Delta x}\\left(\\boldsymbol{F}_{i+\\frac{1}{2}} - \\boldsymbol{F}_{i-\\frac{1}{2}}\\right)\n$$\nwhere $\\Delta x$ is the uniform cell width and $\\boldsymbol{F}_{i\\pm\\frac{1}{2}}$ are the numerical fluxes at the cell interfaces. The scheme is advanced in time using an explicit forward Euler method:\n$$\n\\frac{\\boldsymbol{Q}_{i}^{n+1} - \\boldsymbol{Q}_{i}^{n}}{\\Delta t} = -\\frac{1}{\\Delta x}\\left(\\boldsymbol{F}_{i+\\frac{1}{2}}^{n} - \\boldsymbol{F}_{i-\\frac{1}{2}}^{n}\\right)\n$$\n\nThe stability of this scheme is determined by analyzing its behavior for small perturbations around a uniform reference state, where the primitive variables—density $\\rho$, velocity $u$, and pressure $p$—and consequently the speed of sound $a$, are constant throughout the domain.\n\nThe governing equations, $\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0}$, form a system of hyperbolic conservation laws. The local propagation of information in such a system is described by the flux Jacobian matrix, $\\boldsymbol{A}(\\boldsymbol{Q}) = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{Q}}$. The eigenvalues of this matrix represent the characteristic speeds of the system, which are the speeds of the physical waves.\n\nFor the one-dimensional Euler equations, the flux Jacobian $\\boldsymbol{A}$ has three real eigenvalues:\n$$\n\\lambda_1 = u - a\n$$\n$$\n\\lambda_2 = u\n$$\n$$\n\\lambda_3 = u + a\n$$\nThese eigenvalues correspond to the speeds of the two acoustic waves (propagating at speed $a$ relative to the flow) and the entropy/contact discontinuity (propagating with the flow velocity $u$), respectively.\n\nThe problem states that the AUSM flux \"preserves linearized consistency about a uniform state\" and is constructed to \"recover exact upwinding in supersonic limits.\" For a first-order scheme, these properties imply that when linearized about a uniform state, the scheme's behavior is equivalent to a first-order upwind discretization applied to each of the characteristic fields.\n\nThe system of partial differential equations can be locally diagonalized into a set of three uncoupled scalar advection equations for the characteristic variables $w_k$:\n$$\n\\frac{\\partial w_k}{\\partial t} + \\lambda_k \\frac{\\partial w_k}{\\partial x} = 0, \\quad k \\in \\{1, 2, 3\\}\n$$\nA first-order upwind, forward Euler discretization for such a scalar equation is stable if and only if the Courant number, $C_k = |\\lambda_k| \\frac{\\Delta t}{\\Delta x}$, satisfies the CFL condition:\n$$\nC_k \\le 1 \\implies |\\lambda_k| \\frac{\\Delta t}{\\Delta x} \\le 1\n$$\nThis condition ensures that the numerical domain of dependence contains the physical domain of dependence for each wave. The problem's \"requirement for monotonicity of a first-order upwind flux in each characteristic field\" is precisely the physical motivation leading to this mathematical constraint on the amplification factor of the discretized scheme.\n\nFor the complete system of Euler equations to be stable, the time step $\\Delta t$ must be small enough to satisfy this condition for all characteristic waves simultaneously. This means the condition must hold for the wave with the largest propagation speed. The maximum characteristic speed is given by the spectral radius of the flux Jacobian matrix, denoted $\\rho(\\boldsymbol{A})$:\n$$\n\\rho(\\boldsymbol{A}) = \\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|) = \\max(|u-a|, |u|, |u+a|)\n$$\nThe stability condition for the coupled system is therefore:\n$$\n\\rho(\\boldsymbol{A}) \\frac{\\Delta t}{\\Delta x} \\le 1\n$$\nTo find the explicit form of $\\rho(\\boldsymbol{A})$, we analyze the term $\\max(|u-a|, |u|, |u+a|)$. The speed of sound $a = \\sqrt{\\gamma p / \\rho}$ is, for any physical gas, a strictly positive quantity ($a > 0$).\nBy the triangle inequality, we know that $|u+a| \\le |u|+|a| = |u|+a$ and $|u-a| \\le |u|+|-a| = |u|+a$.\nLet us prove that $\\max(|u-a|, |u|, |u+a|)$ is exactly $|u|+a$.\n- We have $|u+a| \\ge u+a$ or $|u+a| \\ge -u-a$.\n- We have $|u-a| \\ge u-a$ or $|u-a| \\ge a-u$.\n- Since $a > 0$, it is clear that $|u|+a \\ge |u|$.\n- We must compare $|u|+a$ against $|u+a|$ and $|u-a|$.\n- If $u \\ge 0$, then $|u|=u$. The term becomes $u+a$. Since $a0$, $u+a \\ge |u+a| = u+a$ and $u+a \\ge |u-a|$. The equality holds in the first comparison, and the second is true because $u+a-(u-a) = 2a  0$ if $u \\ge a$, and $u+a-(a-u) = 2u \\ge 0$ if $u  a$.\n- If $u  0$, then $|u|=-u$. The term becomes $a-u$. Since $a0$ and $u0$, $a-u$ is positive. We have $a-u \\ge |u+a|$ and $a-u \\ge |u-a|=|-u+a|=|u|+a$. The equality holds in the second comparison. The first comparison reduces to $a-u \\ge |a-|u||$, which is true since $a-u-(a-|u|) = |u|  0$ if $a|u|$, and $a-u-(|u|-a) = 2(a-|u|)$ can be negative, but $|u|+a$ is the maximum.\nLet's restart the argument more clearly.\nThe speeds are $|u|$, $|u-a|$, and $|u+a|$. By the triangle inequality, $|u-a| \\leq |u|+a$ and $|u+a| \\leq |u|+a$. Also, since $a0$, $|u|  |u|+a$. Thus, the maximum of the three values is $|u|+a$. This is the speed of the fastest-moving acoustic wave relative to the stationary grid.\n\nTherefore, the spectral radius of the flux Jacobian is:\n$$\n\\rho(\\boldsymbol{A}) = |u| + a\n$$\nSubstituting this into the stability condition gives:\n$$\n(|u| + a) \\frac{\\Delta t}{\\Delta x} \\le 1\n$$\nThe problem asks for the largest admissible time step, $\\Delta t_{\\max}$, which corresponds to the limit of this inequality:\n$$\n(|u| + a) \\frac{\\Delta t_{\\max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta t_{\\max}$ yields the final expression:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|u| + a}\n$$\nThis result is the standard CFL condition for first-order explicit upwind schemes applied to the 1D Euler equations. The specific internal machinery of the AUSM scheme is not needed, only its fundamental properties of consistency and adherence to upwinding principles, which guarantee that its linear stability is governed by the physical wave speeds of the underlying system.", "answer": "$$\\boxed{\\frac{\\Delta x}{|u| + a}}$$", "id": "3292940"}, {"introduction": "A key motivation behind the development of AUSM and its variants was to improve the resolution of specific wave phenomena over older schemes. This exercise focuses on a critical test for any advanced flux-splitting method: the exact resolution of a contact discontinuity, a wave characterized by a jump in density but constant pressure and velocity. Deriving the conditions under which an AUSM-type flux achieves this [@problem_id:3292971] reveals the elegant interplay between the convective and pressure components of the scheme and highlights a major source of its accuracy.", "problem": "Consider the one-dimensional Euler equations for a calorically perfect ideal gas with ratio of specific heats $\\gamma$, written in conservative form for the state vector $U = [\\rho, \\rho u, \\rho E]^{\\mathsf{T}}$ and flux $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\mathsf{T}}$. The equation of state and speed of sound are $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$ and $a = \\sqrt{\\gamma p / \\rho}$. A contact discontinuity is defined by left and right states with equal velocity and pressure but different density, i.e., $u_{L} = u_{R}$, $p_{L} = p_{R}$, and $\\rho_{L} \\neq \\rho_{R}$. In the exact solution of the Riemann problem, the contact advects at speed $u$, with $u$ and $p$ constant and the density jump preserved.\n\nAn Advection Upstream Splitting Method (AUSM) flux of the AUSM$+$ family splits the intercell numerical flux at a face into a convective contribution and a pressure contribution. Without prescribing a particular variant, suppose the mass flux can be written as a product of a reference speed of sound $a_{f}$, an interface convective Mach number $\\widehat{M}$, and an upwinded density $\\rho^{\\mathrm{up}}$, while the pressure contribution entering the momentum flux is built from a pressure-splitting that reduces to the physical pressure when $p_{L} = p_{R}$. Assume second-order piecewise linear reconstruction is used on primitive variables $(\\rho,u,p)$ with a limiter that preserves equality when the true solution is constant.\n\nYour tasks:\n\n1) Starting from the Euler equations and the exact-contact property above, derive sufficient conditions on the numerical reconstruction and on the AUSM$+$-type flux parameters so that, for interfacial left/right data with $u_{L} = u_{R}$ and $p_{L} = p_{R}$ (but $\\rho_{L} \\neq \\rho_{R}$), the computed interface fluxes coincide with the exact contact fluxes. Express these conditions as requirements on the reconstructed interfacial primitive variables, the convective Mach number and reference speed of sound used in the mass flux, and the pressure-splitting used in the momentum flux. Your conditions must be sufficient to guarantee exact contact capture for arbitrary $\\rho_{L} \\neq \\rho_{R}$ and any subsonic or supersonic $u$ consistent with the Euler model.\n\n2) Under the sufficient conditions you derived, evaluate the numerical mass flux for the following left/right state with only density differing:\n- Ratio of specific heats $\\gamma = 1.4$,\n- Left and right pressures $p_{L} = p_{R} = 1.0 \\times 10^{5}$ in $\\mathrm{Pa}$,\n- Left and right velocities $u_{L} = u_{R} = 100$ in $\\mathrm{m/s}$,\n- Left and right densities $\\rho_{L} = 1.0$ and $\\rho_{R} = 2.0$ in $\\mathrm{kg/m^{3}}$.\n\nExpress the final mass flux in $\\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s})$, and round your answer to four significant figures. Report only the numerical value of the mass flux.", "solution": "The problem asks for two parts: first, to derive sufficient conditions for an Advection Upstream Splitting Method (AUSM) type scheme to exactly resolve a contact discontinuity, and second, to calculate the numerical mass flux for a specific contact discontinuity under these conditions.\n\n### Part 1: Sufficient Conditions for Exact Contact Resolution\n\nA contact discontinuity is characterized by left ($L$) and right ($R$) states with equal velocity $u_{L} = u_{R} = u_{c}$ and equal pressure $p_{L} = p_{R} = p_{c}$, but unequal density $\\rho_{L} \\neq \\rho_{R}$. In the exact solution to the one-dimensional Euler equations, this discontinuity advects with velocity $u_{c}$ while maintaining the jump in density. The velocity and pressure remain constant at $u_{c}$ and $p_{c}$ everywhere.\n\nThe exact physical flux vector $F(U)$ is given by $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\mathsf{T}}$. For a contact discontinuity moving at speed $u_c$, the state variables on the discontinuity itself are $(u_c, p_c)$, and the density is taken from the upwind direction. If $u_{c}  0$, the left state $(\\rho_{L}, u_{c}, p_{c})$ is on the interface. If $u_{c}  0$, the right state $(\\rho_{R}, u_{c}, p_{c})$ is on the interface. If $u_{c} = 0$, the flux is zero for mass and energy, and $[0, p_c, 0]^\\mathsf{T}$ for momentum. Let $\\rho^{\\mathrm{upwind}}$ denote the density on the upwind side. The exact flux $F_{exact}$ across the contact is:\n$F_{exact} = F(\\rho^{\\mathrm{upwind}}, u_{c}, p_{c}) = \\begin{pmatrix} \\rho^{\\mathrm{upwind}} u_{c} \\\\ \\rho^{\\mathrm{upwind}} u_{c}^{2} + p_{c} \\\\ u_{c}(\\rho^{\\mathrm{upwind}} E^{\\mathrm{upwind}} + p_{c}) \\end{pmatrix}$\nwhere $E^{\\mathrm{upwind}} = \\frac{p_{c}}{(\\gamma - 1)\\rho^{\\mathrm{upwind}}} + \\frac{1}{2}u_{c}^{2}$. The third component can also be written in terms of total enthalpy $H = E + p/\\rho$ as $(\\rho^{\\mathrm{upwind}}u_{c})H^{\\mathrm{upwind}}$.\n\nThe numerical flux $F_{num}$ for an AUSM-type scheme is split into a convective part and a pressure part. Following the problem description, at an interface with reconstructed left ($L$) and right ($R$) states, the numerical flux components are:\n1.  Mass flux: $F_{num, 1} = \\dot{m} = (a_{f}\\widehat{M})\\rho^{\\mathrm{up}}$\n2.  Momentum flux: $F_{num, 2} = \\dot{m}u^{\\mathrm{up}} + p_{num}$\n3.  Energy flux: $F_{num, 3} = \\dot{m}H^{\\mathrm{up}}$\n\nHere, $a_{f}$ is a reference speed of sound, $\\widehat{M}$ is a convective Mach number, and the superscript `up` denotes a value taken from the upwind side, determined by the sign of the convective velocity $u_f = a_f \\widehat{M}$. To achieve exact resolution of the contact, the numerical flux $F_{num}$ must equal the exact flux $F_{exact}$. We analyze the conditions for this equality component by component.\n\n**Condition 1: Reconstruction**\nThe problem states that a second-order piecewise linear reconstruction is applied to the primitive variables $(\\rho, u, p)$ and that the limiter preserves equality for constant data. For a contact discontinuity, the velocity and pressure fields are constant ($u=u_{c}, p=p_{c}$). Therefore, the reconstruction process must yield constant values for $u$ and $p$ at the cell interface. Let these interface values be denoted with subscripts $L$ and $R$:\n$$ u_{L} = u_{R} = u_{c} $$\n$$ p_{L} = p_{R} = p_{c} $$\nThe density $\\rho$ is discontinuous, so the reconstructed values $\\rho_{L}$ and $\\rho_{R}$ will in general be different. This condition on the reconstruction is a prerequisite for the analysis.\n\n**Condition 2: Pressure Flux**\nThe problem states that the pressure contribution $p_{num}$ reduces to the physical pressure when $p_{L} = p_{R}$. Since for a contact we have $p_{L} = p_{R} = p_{c}$, a sufficient condition is:\n$$ p_{num}(p_{L}, p_{R}) = p_{c} \\quad \\text{when} \\quad p_{L} = p_{R} = p_{c} $$\n\n**Condition 3: Convective Velocity and Upwinding**\nWe equate the numerical mass flux to the exact mass flux. Let's assume $u_c \\neq 0$.\n$$ F_{num, 1} = (a_{f}\\widehat{M})\\rho^{\\mathrm{up}} $$\n$$ F_{exact, 1} = u_{c}\\rho^{\\mathrm{upwind}} $$\nFor these to be equal for an arbitrary density jump ($\\rho_L \\neq \\rho_R$), two things must hold simultaneously:\n(a) The numerical scheme must choose the same upwind density as the exact solution, i.e., $\\rho^{\\mathrm{up}} = \\rho^{\\mathrm{upwind}}$. This means the upwinding direction must be determined by the sign of $u_{c}$. Since numerical upwinding is based on the sign of the convective velocity $u_{f} = a_{f}\\widehat{M}$, this implies that $\\mathrm{sgn}(u_f) = \\mathrm{sgn}(u_c)$.\n(b) The magnitude of the convective velocity must match the physical advection speed: $|u_f| = |u_c|$.\nCombining (a) and (b), the convective velocity must be exactly equal to the physical velocity:\n$$ a_{f}\\widehat{M} = u_{c} $$\nThis is a condition on the formulation of $a_f$ and $\\widehat{M}$. When evaluated for states satisfying $u_{L}=u_{R}=u_{c}$ and $p_{L}=p_{R}=p_{c}$, the resulting convective velocity must be $u_c$.\n\n**Momentum and Energy Flux Verification**\nWith these conditions, let's check the other flux components.\nFor the momentum flux:\n$F_{num, 2} = \\dot{m}u^{\\mathrm{up}} + p_{num}$. From the mass flux condition, $\\dot{m} = u_{c}\\rho^{\\mathrm{upwind}}$. The upwinded velocity $u^{\\mathrm{up}}$ is chosen based on the sign of $u_f=u_c$. Since $u_L=u_R=u_c$, $u^{\\mathrm{up}}$ is always $u_c$. From the pressure flux condition, $p_{num} = p_c$.\n$$ F_{num, 2} = (u_{c}\\rho^{\\mathrm{upwind}})u_{c} + p_{c} = \\rho^{\\mathrm{upwind}}u_{c}^{2} + p_{c} $$\nThis exactly matches the exact momentum flux $F_{exact, 2}$.\n\nFor the energy flux:\n$F_{num, 3} = \\dot{m}H^{\\mathrm{up}}$. The upwinded total enthalpy $H^{\\mathrm{up}}$ is chosen from the state $(\\rho^{\\mathrm{upwind}}, u_{c}, p_{c})$. Let's denote this as $H^{\\mathrm{upwind}}$.\n$$ F_{num, 3} = (u_{c}\\rho^{\\mathrm{upwind}})H^{\\mathrm{upwind}} = u_{c}\\rho^{\\mathrm{upwind}}\\left(E^{\\mathrm{upwind}} + \\frac{p_{c}}{\\rho^{\\mathrm{upwind}}}\\right) = u_{c}(\\rho^{\\mathrm{upwind}}E^{\\mathrm{upwind}} + p_{c}) $$\nThis exactly matches the exact energy flux $F_{exact, 3}$.\n\n**Summary of Sufficient Conditions:**\nFor an AUSM$+$ type scheme to exactly resolve a contact discontinuity, the following conditions are sufficient:\n1.  **Reconstruction:** The reconstruction of primitive variables $(\\rho, u, p)$ at a cell interface must yield unique values for velocity and pressure when the underlying data is constant, i.e., $u_{L}=u_{R}=u_{c}$ and $p_{L}=p_{R}=p_{c}$.\n2.  **Pressure Splitting:** The numerical pressure term $p_{num}$ in the momentum flux must evaluate to the common physical pressure $p_{c}$ when $p_{L}=p_{R}=p_{c}$.\n3.  **Convective Velocity:** The formulation for the interface convective velocity $u_f = a_{f}\\widehat{M}$ must reduce to the physical velocity $u_c$ when evaluated for interface states satisfying $u_{L}=u_{R}=u_c$ and $p_{L}=p_{R}=p_c$.\n4.  **Upwinding Consistency:** The upwinded quantities $(\\rho^{\\mathrm{up}}, u^{\\mathrm{up}}, H^{\\mathrm{up}})$ must be selected from the left or right state based on the sign of the convective velocity $u_f$.\n\n### Part 2: Numerical Mass Flux Calculation\n\nWe are asked to evaluate the numerical mass flux for a specific state under the sufficient conditions derived above. The given state is:\n- Ratio of specific heats: $\\gamma = 1.4$\n- Left and right pressures: $p_{L}=p_{R}=1.0 \\times 10^{5} \\, \\mathrm{Pa}$\n- Left and right velocities: $u_{L}=u_{R}=100 \\, \\mathrm{m/s}$\n- Left and right densities: $\\rho_{L}=1.0 \\, \\mathrm{kg/m^{3}}$, $\\rho_{R}=2.0 \\, \\mathrm{kg/m^{3}}$\n\nThis state represents a contact discontinuity where the common velocity is $u_{c} = 100 \\, \\mathrm{m/s}$ and the common pressure is $p_{c} = 1.0 \\times 10^{5} \\, \\mathrm{Pa}$.\n\nThe numerical mass flux is given by the formula $\\dot{m} = (a_{f}\\widehat{M})\\rho^{\\mathrm{up}}$.\nThe sufficient conditions derived in Part 1 ensure that the numerical flux calculation reproduces the exact physical flux. Specifically, Condition 3 requires that the convective velocity $u_f = a_{f}\\widehat{M}$ equals the physical velocity $u_c$.\n$$ u_{f} = a_{f}\\widehat{M} = u_{c} = 100 \\, \\mathrm{m/s} $$\nCondition 4 dictates that the upwinded density $\\rho^{\\mathrm{up}}$ is chosen based on the sign of $u_f$. Since $u_f = 100  0$, the flow is from left to right, and the upwind state is the left state.\n$$ \\rho^{\\mathrm{up}} = \\rho_{L} = 1.0 \\, \\mathrm{kg/m^{3}} $$\nSubstituting these into the formula for the numerical mass flux:\n$$ \\dot{m} = u_{f} \\rho^{\\mathrm{up}} = (100 \\, \\mathrm{m/s}) \\times (1.0 \\, \\mathrm{kg/m^{3}}) = 100 \\, \\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s}) $$\nAlternatively, we can directly state that the conditions enforce $\\dot{m}_{num} = \\dot{m}_{exact}$. The exact mass flux for a contact moving at $u_c  0$ is $\\rho_{L}u_{c}$.\n$$ \\dot{m}_{exact} = \\rho_{L} u_{c} = (1.0 \\, \\mathrm{kg/m^{3}}) \\times (100 \\, \\mathrm{m/s}) = 100 \\, \\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s}) $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\dot{m} = 100.0 \\, \\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s}) = 1.000 \\times 10^{2} \\, \\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s}) $$", "answer": "$$\n\\boxed{1.000 \\times 10^{2}}\n$$", "id": "3292971"}, {"introduction": "Theoretical elegance must often be tempered by practical engineering to create a truly robust numerical method. This final practice, a hands-on coding exercise, addresses a classic failure point for many inviscid flux schemes: the generation of non-physical expansion shocks at sonic transitions. You will implement a common solution, an \"entropy fix\" that smoothly blends the scheme's behavior around the sonic point ($M=1$), and test its effect on the physically critical problem of choked flow in a nozzle [@problem_id:3292964].", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas under quasi-steady, quasi-one-dimensional flow through a nozzle throat. The governing conservation laws for mass, momentum, and energy, along with the ideal-gas equation of state, form the fundamental base. The Advection Upstream Splitting Method (AUSM) family of flux splitting schemes divides the interfacial fluxes into contributions from the left and right states using Mach-number-dependent splitting functions. Near sonic points, where the local Mach number $M$ satisfies $M \\approx 1$, discrete numerical schemes may exhibit non-physical behavior unless an entropy fix is applied. In this problem, you will construct a smooth entropy fix for the AUSM-type Mach-number splitting functions by blending subsonic and supersonic forms across a band of width controlled by a parameter $\\delta$, and then assess its effect on the predicted choking mass flow rate.\n\nStarting from the conservation of mass across an interfacial throat plane of area $A^\\ast$, let the mass flow rate be expressed as the product of an interfacial mass flux and area. Use AUSM-style Mach-number splitting to compute the interfacial mass flux from left and right states, and introduce an entropy fix that smoothly blends the subsonic and supersonic splitting functions across the transition band $|M| \\in [1-\\delta,\\,1+\\delta]$, with a continuously differentiable ramp function. The interfacial speed of sound should be an average constructed from the left and right speeds of sound. The left and right flow states at the throat must be derived consistently from given reservoir (stagnation) conditions using ideal-gas, isentropic relations.\n\nRequirements:\n- Use the compressible Euler equations and ideal-gas assumptions as the foundational basis.\n- Compute left and right primitive states at the throat from a common stagnation pressure $P_0$ and stagnation temperature $T_0$ via isentropic relations, given prescribed left and right Mach numbers $M_L$ and $M_R$.\n- Construct an AUSM-style mass flux at a single interfacial throat using Mach-number splitting functions $M^\\pm(M)$:\n  - Use subsonic polynomial splitting functions in the subsonic regime and the standard upwind supersonic splitting in the supersonic regime.\n  - Blend these two regimes smoothly across the sonic band using a $C^1$ ramp controlled by $\\delta$ to implement the entropy fix.\n- Compute the choking mass flow rate $\\dot{m}$ at the throat as $\\dot{m} = A^\\ast \\,\\Phi$, where $\\Phi$ is the interfacial mass flux produced by the AUSM-style scheme with the entropy fix.\n\nBase relations to be used:\n- Ideal gas equation of state: $p = \\rho R T$.\n- Speed of sound: $a = \\sqrt{\\gamma R T}$.\n- Isentropic relations between stagnation and static conditions:\n  $$T = \\frac{T_0}{1 + \\frac{\\gamma - 1}{2} M^2}, \\quad p = P_0 \\left(\\frac{T}{T_0}\\right)^{\\frac{\\gamma}{\\gamma - 1}}, \\quad \\rho = \\frac{p}{R T}, \\quad u = M a.$$\n- Theoretical choked mass flow under isentropic assumptions for an ideal gas:\n  $$\\dot{m}_\\mathrm{th} = A^\\ast \\, P_0 \\sqrt{\\frac{\\gamma}{R T_0}} \\left(\\frac{2}{\\gamma + 1}\\right)^{\\frac{\\gamma + 1}{2(\\gamma - 1)}}.$$\n\nTask:\n- Implement the AUSM-style interfacial mass flux using Mach-number splitting functions with an entropy fix, where the entropy fix is realized by smoothly blending the subsonic polynomial and supersonic upwind forms inside the sonic band determined by $\\delta$ with a continuously differentiable ramp.\n- Use the interfacial speed of sound constructed as the arithmetic mean of the left and right speeds of sound.\n- Compute the predicted choking mass flow $\\dot{m}$ at the throat for the given test suite.\n\nUnits and numerical output:\n- Express every mass flow rate in $\\mathrm{kg/s}$, rounded to $6$ decimal places.\n- No angles are involved, so no angle unit is required.\n\nTest suite:\nUse the following parameters common to all tests:\n- Ratio of specific heats: $\\gamma = 1.4$.\n- Gas constant: $R = 287\\,\\mathrm{J/(kg\\cdot K)}$.\n- Stagnation pressure: $P_0 = 100000\\,\\mathrm{Pa}$.\n- Stagnation temperature: $T_0 = 300\\,\\mathrm{K}$.\n- Throat area: $A^\\ast = 0.01\\,\\mathrm{m^2}$.\n\nCompute the mass flow rate $\\dot{m}$ for the following four cases:\n- Case $1$: $\\delta = 0$, $M_L = 0.98$, $M_R = 1.02$.\n- Case $2$: $\\delta = 0.05$, $M_L = 0.98$, $M_R = 1.02$.\n- Case $3$: $\\delta = 0.20$, $M_L = 0.98$, $M_R = 1.02$.\n- Case $4$: $\\delta = 0.05$, $M_L = 1.00$, $M_R = 1.00$.\n\nFinal output format:\nYour program should produce a single line of output containing the four computed results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example, $[\\dot{m}_1,\\dot{m}_2,\\dot{m}_3,\\dot{m}_4]$, with each $\\dot{m}_i$ expressed in $\\mathrm{kg/s}$ and rounded to $6$ decimal places.", "solution": "The problem requires the computation of the mass flow rate at a nozzle throat using an Advection Upstream Splitting Method (AUSM) style flux formulation. The crucial part of the problem is the implementation of a smooth entropy fix for the Mach number splitting functions, which are known to cause non-physical oscillations or incorrect shock capturing near sonic conditions ($M=1$). The solution will be constructed step-by-step, following the principles of compressible gas dynamics and numerical flux splitting.\n\nFirst, we must determine the thermodynamic states of the gas on the left (L) and right (R) sides of the computational interface at the throat. These states are defined by their respective Mach numbers, $M_L$ and $M_R$, and are derived from common stagnation (reservoir) conditions, $P_0$ and $T_0$, assuming an isentropic process. For an ideal gas with a ratio of specific heats $\\gamma$, the relations between stagnation and static properties are:\n\nStatic temperature $T$ is given by:\n$$T(M) = \\frac{T_0}{1 + \\frac{\\gamma - 1}{2} M^2}$$\n\nStatic pressure $p$ is given by:\n$$p(M) = P_0 \\left(\\frac{T(M)}{T_0}\\right)^{\\frac{\\gamma}{\\gamma - 1}} = P_0 \\left(1 + \\frac{\\gamma - 1}{2} M^2\\right)^{-\\frac{\\gamma}{\\gamma - 1}}$$\n\nStatic density $\\rho$ is found using the ideal gas law, $p = \\rho R T$:\n$$\\rho(M) = \\frac{p(M)}{R T(M)}$$\n\nThe local speed of sound $a$ is given by:\n$$a(M) = \\sqrt{\\gamma R T(M)}$$\n\nUsing these equations, we can calculate the left-state properties $(\\rho_L, a_L)$ using $M_L$ and the right-state properties $(\\rho_R, a_R)$ using $M_R$.\n\nThe second step is to formulate the interfacial mass flux, $\\Phi$. The AUSM scheme splits the convective flux into components contributed by the left and right states. The mass flux at the interface (denoted by subscript $1/2$) is constructed as:\n$$\\Phi = c_{1/2} \\left( \\rho_L M_L^+ + \\rho_R M_R^- \\right)$$\nwhere $c_{1/2}$ is the interfacial speed of sound and $M^\\pm$ are the split Mach number functions. The problem specifies that the interfacial speed of sound is the arithmetic mean of the left and right values:\n$$c_{1/2} = \\frac{a_L + a_R}{2}$$\n\nThe third and central step is to define the split Mach number functions, $M^+(M)$ and $M^-(M)$, incorporating the entropy fix. These functions must sum to the original Mach number, i.e., $M^+(M) + M^-(M) = M$. We define two sets of splitting functions: one for the subsonic regime ($|M|  1$) and one for the supersonic regime ($|M| \\ge 1$).\n\nFor the supersonic regime, we use the standard upwind splitting:\n$$M^+_{sup}(M) = \\frac{M + |M|}{2} = \\max(0, M)$$\n$$M^-_{sup}(M) = \\frac{M - |M|}{2} = \\min(0, M)$$\n\nFor the subsonic regime, we use the polynomial splits common in AUSM-family schemes:\n$$M^+_{sub}(M) = \\frac{1}{4}(M+1)^2$$\n$$M^-_{sub}(M) = -\\frac{1}{4}(M-1)^2$$\n\nThe entropy fix is implemented by smoothly blending these two forms across a sonic band $|M| \\in [1-\\delta, 1+\\delta]$, where $\\delta$ is a small parameter. A sharp switch between formulas (which corresponds to $\\delta=0$) can cause numerical issues. We introduce a blending function $\\alpha(|M|)$ that is continuously differentiable ($C^1$) and transitions from $0$ to $1$ over the blending interval.\nLet the normalized coordinate in the blending region be $x = \\frac{|M| - (1-\\delta)}{2\\delta}$. This maps the interval $|M| \\in [1-\\delta, 1+\\delta]$ to $x \\in [0, 1]$. We choose a standard $C^1$ smoothstep function:\n$$\\alpha(x) = x^2(3-2x) \\quad \\text{for } x \\in [0,1]$$\nThis function satisfies $\\alpha(0)=0$, $\\alpha(1)=1$, and $\\alpha'(0)=\\alpha'(1)=0$.\n\nThe final, blended split Mach functions are:\n- If $|M| \\le 1-\\delta$: $\\quad M^\\pm(M) = M^\\pm_{sub}(M)$\n- If $|M| \\ge 1+\\delta$: $\\quad M^\\pm(M) = M^\\pm_{sup}(M)$\n- If $1-\\delta  |M|  1+\\delta$:\n  $$M^+(M) = (1-\\alpha) M^+_{sub}(M) + \\alpha M^+_{sup}(M)$$\n  $$M^-(M) = (1-\\alpha) M^-_{sub}(M) + \\alpha M^-_{sup}(M)$$\nFor the case $\\delta=0$, the blending region vanishes, and the scheme defaults to a sharp switch at $|M|=1$.\n\nFinally, with the interfacial mass flux $\\Phi$ calculated, the total mass flow rate $\\dot{m}$ through the throat of area $A^\\ast$ is:\n$$\\dot{m} = A^\\ast \\Phi = A^\\ast c_{1/2} \\left( \\rho_L M_L^+ + \\rho_R M_R^- \\right)$$\nwhere $M_L^+$ is evaluated using $M_L$ and $M_R^-$ is evaluated using $M_R$.\n\nThis procedure is applied to each of the four test cases specified, using the given physical constants and parameters. The final results are rounded to $6$ decimal places.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mass flow rate at a nozzle throat using an AUSM-style flux\n    formulation with a smooth entropy fix for the Mach-number splitting.\n    \"\"\"\n\n    # Common physical and geometric parameters\n    gamma = 1.4\n    R = 287.0  # J/(kg.K)\n    P0 = 100000.0  # Pa\n    T0 = 300.0  # K\n    A_star = 0.01  # m^2\n\n    # Test suite\n    test_cases = [\n        # (delta, M_L, M_R)\n        (0.0, 0.98, 1.02),\n        (0.05, 0.98, 1.02),\n        (0.20, 0.98, 1.02),\n        (0.05, 1.00, 1.00),\n    ]\n\n    def calculate_state(M, P0, T0, gamma, R):\n        \"\"\"\n        Calculates static properties (rho, a) from stagnation conditions and Mach number.\n        \"\"\"\n        temp_ratio = 1.0 / (1.0 + 0.5 * (gamma - 1.0) * M**2)\n        T = T0 * temp_ratio\n        p = P0 * (temp_ratio)**(gamma / (gamma - 1.0))\n        rho = p / (R * T)\n        a = np.sqrt(gamma * R * T)\n        return rho, a\n\n    def get_mach_split(M, delta):\n        \"\"\"\n        Calculates the split Mach numbers M+ and M- with a smooth entropy fix.\n        \"\"\"\n        M_abs = abs(M)\n\n        # Standard subsonic polynomial splitting\n        M_plus_sub = 0.25 * (M + 1.0)**2\n        M_minus_sub = -0.25 * (M - 1.0)**2\n\n        # Standard supersonic upwind splitting\n        M_plus_sup = 0.5 * (M + M_abs)\n        M_minus_sup = 0.5 * (M - M_abs)\n\n        if delta == 0.0:\n            if M_abs  1.0:\n                return M_plus_sub, M_minus_sub\n            else:\n                return M_plus_sup, M_minus_sup\n        else: # delta > 0\n            if M_abs = 1.0 - delta:\n                return M_plus_sub, M_minus_sub\n            elif M_abs >= 1.0 + delta:\n                return M_plus_sup, M_minus_sup\n            else: # Blending region\n                # C^1 smoothstep blending function alpha\n                x = (M_abs - (1.0 - delta)) / (2.0 * delta)\n                alpha = x**2 * (3.0 - 2.0 * x)\n                \n                M_plus_blend = (1.0 - alpha) * M_plus_sub + alpha * M_plus_sup\n                M_minus_blend = (1.0 - alpha) * M_minus_sub + alpha * M_minus_sup\n                return M_plus_blend, M_minus_blend\n\n    results = []\n    for case in test_cases:\n        delta, M_L, M_R = case\n\n        # 1. Calculate left and right states\n        rho_L, a_L = calculate_state(M_L, P0, T0, gamma, R)\n        rho_R, a_R = calculate_state(M_R, P0, T0, gamma, R)\n\n        # 2. Calculate interfacial speed of sound\n        c_interface = 0.5 * (a_L + a_R)\n\n        # 3. Calculate split Mach numbers\n        M_L_plus, _ = get_mach_split(M_L, delta)\n        _, M_R_minus = get_mach_split(M_R, delta)\n\n        # 4. Calculate interfacial mass flux Phi\n        phi_mass_flux = c_interface * (rho_L * M_L_plus + rho_R * M_R_minus)\n\n        # 5. Calculate total mass flow rate\n        m_dot = A_star * phi_mass_flux\n        \n        results.append(m_dot)\n\n    # Format results to 6 decimal places for final output\n    formatted_results = [f\"{round(res, 6):.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3292964"}]}