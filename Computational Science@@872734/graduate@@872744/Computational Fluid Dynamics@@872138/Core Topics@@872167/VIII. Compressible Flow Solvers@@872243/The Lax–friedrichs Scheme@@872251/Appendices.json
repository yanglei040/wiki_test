{"hands_on_practices": [{"introduction": "Mastering a numerical method begins with a hands-on calculation. This first exercise provides a direct application of the Lax-Friedrichs scheme to the inviscid Burgers' equation, a classic model for nonlinear wave phenomena. By computing a single time-step update for a given initial condition, you will make the abstract finite volume formula concrete and see precisely how information from neighboring cells is combined to predict the future state of the system [@problem_id:3413890].", "problem": "Consider the scalar conservation law $u_t + \\partial_x f(u) = 0$ with flux $f(u) = \\frac{u^2}{2}$ (inviscid Burgers equation) on a one-dimensional uniform mesh with spatial step size $\\Delta x$ and explicit time step $\\Delta t$. Starting from the integral form of conservation over a control volume and the finite volume update based on a consistent interface numerical flux, derive the first-order Lax–Friedrichs central scheme numerical flux for a scalar conservation law by enforcing consistency with $f(u)$ and adding a linear dissipative term scaled by a characteristic speed bound. Use the characteristic speed bound $\\alpha_{i+1/2}$ equal to the maximum of the absolute value of the local characteristic speeds on either side of the interface, where the characteristic speed for inviscid Burgers equation is $f'(u) = u$; that is, take $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$.\n\nYou are given the discrete initial profile at time level $n=0$ for three neighboring cells: $u_4^0 = 1.2$, $u_5^0 = 0.4$, and $u_6^0 = -0.8$, together with $\\Delta x = 0.1$ and $\\Delta t = 0.05$. Using the finite volume explicit update based on the derived Lax–Friedrichs central scheme numerical flux, compute the updated value $u_5^1$ after one time step. Express the final answer as a single real number. No rounding is required.", "solution": "The user wants to solve a numerical problem involving the Lax-Friedrichs scheme for the inviscid Burgers' equation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   Scalar conservation law: $u_t + \\partial_x f(u) = 0$.\n-   Flux function: $f(u) = \\frac{u^2}{2}$ (inviscid Burgers' equation).\n-   One-dimensional uniform mesh with spatial step size $\\Delta x$ and time step $\\Delta t$.\n-   Task 1: Derive the first-order Lax-Friedrichs central scheme numerical flux.\n    -   Start from the integral form of conservation.\n    -   Use a finite volume update based on a consistent interface numerical flux.\n    -   Add a linear dissipative term scaled by a characteristic speed bound.\n    -   Characteristic speed for the inviscid Burgers' equation is $f'(u) = u$.\n    -   The characteristic speed bound at interface $i+1/2$ is given by $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$.\n-   Task 2: Compute the updated value $u_5^1$.\n-   Given discrete initial profile at $n=0$: $u_4^0 = 1.2$, $u_5^0 = 0.4$, and $u_6^0 = -0.8$.\n-   Given constants: $\\Delta x = 0.1$ and $\\Delta t = 0.05$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem describes a standard application of the finite volume method (specifically, the local Lax-Friedrichs or Rusanov scheme) to a canonical hyperbolic conservation law (the inviscid Burgers' equation). All concepts are fundamental to the field of numerical partial differential equations. The problem is scientifically sound.\n-   **Well-Posed:** All necessary data ($u_i^0$ values, $\\Delta x$, $\\Delta t$), the flux function, and the specific definition of the numerical scheme are provided. The problem asks for the calculation of a single value, $u_5^1$, which is uniquely determined by the provided information.\n-   **Objective:** The problem is stated using precise, unambiguous mathematical language.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. I will proceed with the solution.\n\n### Derivation and Solution\n\nThe problem is divided into two parts: first, to derive the Lax-Friedrichs numerical flux, and second, to use it to compute a cell value after one time step.\n\n**Part 1: Derivation of the Lax–Friedrichs Scheme**\n\nWe begin with the integral form of the scalar conservation law $u_t + \\partial_x f(u) = 0$ over a control volume $C_i = [x_{i-1/2}, x_{i+1/2}]$ from time $t^n$ to $t^{n+1} = t^n + \\Delta t$.\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^{n+1}) dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx + \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt = 0 $$\nWe define the cell average of $u$ over cell $C_i$ at time $t^n$ as $u_i^n = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx$, where $\\Delta x = x_{i+1/2} - x_{i-1/2}$. Dividing the integral equation by $\\Delta x$ and using the cell average definition, we get:\n$$ u_i^{n+1} - u_i^n + \\frac{1}{\\Delta x} \\left( \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt \\right) = 0 $$\nWe introduce a numerical flux function $F_{i+1/2}$ that approximates the time-averaged flux at the cell interface $x_{i+1/2}$:\n$$ F_{i+1/2} \\approx \\frac{1}{\\Delta t} \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt $$\nSubstituting this into the equation for the cell averages gives the general finite volume update scheme:\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\nThe Lax–Friedrichs scheme is based on a central approximation for the flux term, with an added artificial viscosity or dissipation term to ensure stability. The numerical flux $F_{i+1/2}$ at the interface between cell $i$ (left state $u_L = u_i^n$) and cell $i+1$ (right state $u_R = u_{i+1}^n$) is given by:\n$$ F_{i+1/2} = F(u_i^n, u_{i+1}^n) = \\frac{1}{2} [f(u_i^n) + f(u_{i+1}^n)] - \\frac{1}{2} \\alpha_{i+1/2} [u_{i+1}^n - u_i^n] $$\nHere, the term $\\frac{1}{2} [f(u_i^n) + f(u_{i+1}^n)]$ is a simple central average of the fluxes from the two adjacent cells. The second term, $-\\frac{1}{2} \\alpha_{i+1/2} [u_{i+1}^n - u_i^n]$, is the numerical dissipation. The coefficient $\\alpha_{i+1/2}$ must be a bound on the characteristic speed of propagation at the interface.\nThe problem specifies the flux from the inviscid Burgers' equation, $f(u) = \\frac{u^2}{2}$, for which the characteristic speed is $f'(u) = u$. The problem further specifies the local dissipation coefficient to be $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$. This is a common choice, leading to the local Lax-Friedrichs scheme, also known as the Rusanov scheme.\n\n**Part 2: Computation of $u_5^1$**\n\nWe need to compute the value $u_5^1$ using the finite volume update formula:\n$$ u_5^1 = u_5^0 - \\frac{\\Delta t}{\\Delta x} (F_{5+1/2} - F_{4+1/2}) $$\nThe givens are: $u_4^0 = 1.2$, $u_5^0 = 0.4$, $u_6^0 = -0.8$, $\\Delta x = 0.1$, and $\\Delta t = 0.05$. The ratio of step sizes is $\\frac{\\Delta t}{\\Delta x} = \\frac{0.05}{0.1} = 0.5$.\n\nFirst, we calculate the numerical flux $F_{5+1/2}$ at the interface between cell $5$ and cell $6$.\nThe states are $u_L = u_5^0 = 0.4$ and $u_R = u_6^0 = -0.8$.\nThe physical fluxes are $f(u_5^0) = \\frac{(0.4)^2}{2} = \\frac{0.16}{2} = 0.08$ and $f(u_6^0) = \\frac{(-0.8)^2}{2} = \\frac{0.64}{2} = 0.32$.\nThe dissipation coefficient is $\\alpha_{5+1/2} = \\max(|u_5^0|, |u_6^0|) = \\max(|0.4|, |-0.8|) = \\max(0.4, 0.8) = 0.8$.\nNow we compute the flux $F_{5+1/2}$:\n$$ F_{5+1/2} = \\frac{1}{2} [f(u_5^0) + f(u_6^0)] - \\frac{1}{2} \\alpha_{5+1/2} [u_6^0 - u_5^0] $$\n$$ F_{5+1/2} = \\frac{1}{2} [0.08 + 0.32] - \\frac{1}{2} (0.8) [-0.8 - 0.4] $$\n$$ F_{5+1/2} = \\frac{1}{2} (0.40) - 0.4 (-1.2) $$\n$$ F_{5+1/2} = 0.20 + 0.48 = 0.68 $$\n\nNext, we calculate the numerical flux $F_{4+1/2}$ at the interface between cell $4$ and cell $5$.\nThe states are $u_L = u_4^0 = 1.2$ and $u_R = u_5^0 = 0.4$.\nThe physical fluxes are $f(u_4^0) = \\frac{(1.2)^2}{2} = \\frac{1.44}{2} = 0.72$ and $f(u_5^0) = \\frac{(0.4)^2}{2} = \\frac{0.16}{2} = 0.08$.\nThe dissipation coefficient is $\\alpha_{4+1/2} = \\max(|u_4^0|, |u_5^0|) = \\max(|1.2|, |0.4|) = \\max(1.2, 0.4) = 1.2$.\nNow we compute the flux $F_{4+1/2}$:\n$$ F_{4+1/2} = \\frac{1}{2} [f(u_4^0) + f(u_5^0)] - \\frac{1}{2} \\alpha_{4+1/2} [u_5^0 - u_4^0] $$\n$$ F_{4+1/2} = \\frac{1}{2} [0.72 + 0.08] - \\frac{1}{2} (1.2) [0.4 - 1.2] $$\n$$ F_{4+1/2} = \\frac{1}{2} (0.80) - 0.6 (-0.8) $$\n$$ F_{4+1/2} = 0.40 + 0.48 = 0.88 $$\n\nFinally, we update the value of $u_5^1$ using the fluxes we calculated:\n$$ u_5^1 = u_5^0 - \\frac{\\Delta t}{\\Delta x} (F_{5+1/2} - F_{4+1/2}) $$\n$$ u_5^1 = 0.4 - 0.5 \\times (0.68 - 0.88) $$\n$$ u_5^1 = 0.4 - 0.5 \\times (-0.20) $$\n$$ u_5^1 = 0.4 + 0.1 $$\n$$ u_5^1 = 0.5 $$\nThe updated value for cell $5$ after one time step is $0.5$.", "answer": "$$ \\boxed{0.5} $$", "id": "3413890"}, {"introduction": "A robust numerical scheme must be stable, and its errors must be well-understood. This practice delves into the theoretical properties of the Lax-Friedrichs scheme using von Neumann stability analysis, a cornerstone of numerical methods. You will derive the scheme's amplification factor, $G(\\theta)$, which acts like its 'DNA', revealing its inherent numerical dissipation and phase error as a function of wavenumber, which are critical for predicting its performance in real simulations [@problem_id:3375332].", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$, discretized on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. The Lax–Friedrichs scheme updates the grid function $u_{j}^{n}$ via\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\nLet the Courant–Friedrichs–Lewy (CFL) number be $\\nu = \\dfrac{a\\,\\Delta t}{\\Delta x}$ and consider a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$, where $\\theta \\in \\mathbb{R}$ is the nondimensional wavenumber. Define the one-step amplification factor $G(\\theta)$ by $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$.\n\nStarting from the scheme definition and using the Fourier mode ansatz, derive the expression for $G(\\theta)$ and calculate its magnitude $\\lvert G(\\theta)\\rvert$ and its argument $\\arg(G(\\theta))$ (the principal value in $(-\\pi,\\pi]$) as closed-form analytic functions of $\\theta$ and $\\nu$. Your final answer must be given as two expressions: one for $\\lvert G(\\theta)\\rvert$ and one for $\\arg(G(\\theta))$. If you invoke a branch-sensitive formula for the argument, it must be written explicitly so that the value lies in $(-\\pi,\\pi]$. Express your final answer as a symbolic expression and do not include any units.", "solution": "The problem requires the derivation of the amplification factor $G(\\theta)$, its magnitude $|G(\\theta)|$, and its argument $\\arg(G(\\theta))$ for the Lax–Friedrichs scheme applied to the one-dimensional linear advection equation.\n\nThe linear advection equation is given by:\n$$\nu_{t} + a\\,u_{x} = 0\n$$\nwhere $a > 0$ is a constant.\n\nThe Lax–Friedrichs scheme is:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nLet the Courant–Friedrichs–Lewy (CFL) number be $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$. The scheme can be written as:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n\nWe perform a von Neumann stability analysis by substituting the discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$ into the scheme. The terms in the scheme become:\n- $u_{j}^{n+1} = \\hat{u}^{n+1}\\exp(i j \\theta)$\n- $u_{j+1}^{n} = \\hat{u}^{n}\\exp(i (j+1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta)$\n- $u_{j-1}^{n} = \\hat{u}^{n}\\exp(i (j-1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)$\n\nSubstituting these into the scheme equation:\n$$\n\\hat{u}^{n+1}\\exp(i j \\theta) = \\frac{1}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) + \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) - \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right)\n$$\nThe common factor $\\exp(i j \\theta)$ can be cancelled from every term:\n$$\n\\hat{u}^{n+1} = \\frac{\\hat{u}^{n}}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu\\hat{u}^{n}}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\nBy definition, the amplification factor $G(\\theta)$ is such that $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^{n}$. Dividing by $\\hat{u}^{n}$ (assuming $\\hat{u}^{n} \\neq 0$):\n$$\nG(\\theta) = \\frac{1}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\nUsing Euler's formulas, $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$ and $\\sin(\\theta) = \\frac{\\exp(i \\theta) - \\exp(-i \\theta)}{2i}$, we can simplify the expression for $G(\\theta)$:\n$$\nG(\\theta) = \\cos(\\theta) - \\frac{\\nu}{2}(2i\\sin(\\theta))\n$$\n$$\nG(\\theta) = \\cos(\\theta) - i\\nu\\sin(\\theta)\n$$\n\nNext, we calculate the magnitude $|G(\\theta)|$. For a complex number $z = x+iy$, its magnitude is $|z| = \\sqrt{x^2 + y^2}$. Here, the real part is $\\mathrm{Re}(G(\\theta)) = \\cos(\\theta)$ and the imaginary part is $\\mathrm{Im}(G(\\theta)) = -\\nu\\sin(\\theta)$.\n$$\n|G(\\theta)| = \\sqrt{(\\cos(\\theta))^2 + (-\\nu\\sin(\\theta))^2} = \\sqrt{\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)}\n$$\nThis expression is correct, but it can be written in a more compact form using the double-angle identity for cosine. Using $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$ and $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$:\n$$\n|G(\\theta)|^2 = \\frac{1+\\cos(2\\theta)}{2} + \\nu^2\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) = \\frac{1}{2}(1 + \\cos(2\\theta) + \\nu^2 - \\nu^2\\cos(2\\theta))\n$$\n$$\n|G(\\theta)|^2 = \\frac{1+\\nu^2}{2} + \\frac{1-\\nu^2}{2}\\cos(2\\theta)\n$$\nTherefore, the magnitude is:\n$$\n|G(\\theta)| = \\sqrt{\\frac{1+\\nu^2}{2} + \\frac{1-\\nu^2}{2}\\cos(2\\theta)}\n$$\nFor the scheme to be stable, we require $|G(\\theta)| \\le 1$ for all $\\theta$. This leads to the CFL condition $|\\nu| \\le 1$.\n\nFinally, we calculate the argument (or phase) of $G(\\theta)$, denoted as $\\arg(G(\\theta))$. The problem asks for the principal value, which lies in the interval $(-\\pi, \\pi]$. Let $\\phi(\\theta) = \\arg(G(\\theta))$. The argument is determined by the signs of the real and imaginary parts.\n- Real part: $X = \\cos(\\theta)$\n- Imaginary part: $Y = -\\nu\\sin(\\theta)$\nThe argument is given by the `atan2` function, $\\phi(\\theta) = \\mathrm{atan2}(Y, X) = \\mathrm{atan2}(-\\nu\\sin(\\theta), \\cos(\\theta))$. The problem requires this to be written as an explicit formula. We construct this formula piecewise for one period of $\\theta$, for instance $\\theta \\in (-\\pi, \\pi]$.\n1.  If $X > 0$, i.e., $\\cos(\\theta) > 0$, which for $\\theta \\in (-\\pi, \\pi]$ means $\\theta \\in (-\\pi/2, \\pi/2)$. The argument is $\\phi(\\theta) = \\arctan(Y/X) = \\arctan(-\\nu\\tan(\\theta))$.\n2.  If $X < 0$, i.e., $\\cos(\\theta) < 0$, which for $\\theta \\in (-\\pi, \\pi]$ means $\\theta \\in (\\pi/2, \\pi] \\cup (-\\pi, -\\pi/2)$.\n    - If $Y \\ge 0$, i.e., $-\\nu\\sin(\\theta) \\ge 0$, which implies $\\sin(\\theta) \\le 0$ as $\\nu > 0$. This corresponds to $\\theta \\in (-\\pi, -\\pi/2)$ or $\\theta=\\pi$. The argument is $\\phi(\\theta) = \\arctan(Y/X) + \\pi = \\arctan(-\\nu\\tan(\\theta)) + \\pi$. At $\\theta = \\pi$, $Y=0$ and $X=-1$, so $\\phi(\\pi) = \\pi$.\n    - If $Y < 0$, i.e., $-\\nu\\sin(\\theta) < 0$, which implies $\\sin(\\theta) > 0$. This corresponds to $\\theta \\in (\\pi/2, \\pi)$. The argument is $\\phi(\\theta) = \\arctan(Y/X) - \\pi = \\arctan(-\\nu\\tan(\\theta)) - \\pi$.\n3.  If $X = 0$, i.e., $\\cos(\\theta) = 0$, which for $\\theta \\in (-\\pi, \\pi]$ means $\\theta = \\pm \\pi/2$.\n    - If $\\theta = \\pi/2$, then $Y = -\\nu\\sin(\\pi/2) = -\\nu < 0$. The argument is $\\phi(\\pi/2) = -\\pi/2$.\n    - If $\\theta = -\\pi/2$, then $Y = -\\nu\\sin(-\\pi/2) = \\nu > 0$. The argument is $\\phi(-\\pi/2) = \\pi/2$.\n\nCombining these cases gives the explicit piecewise formula for $\\arg(G(\\theta))$ for $\\theta \\in (-\\pi, \\pi]$:\n$$\n\\arg(G(\\theta)) = \\begin{cases}\n \\arctan(-\\nu\\tan\\theta) + \\pi & \\text{if } \\theta \\in (-\\pi, -\\pi/2) \\\\\n \\pi/2 & \\text{if } \\theta = -\\pi/2 \\\\\n \\arctan(-\\nu\\tan\\theta) & \\text{if } \\theta \\in (-\\pi/2, \\pi/2) \\\\\n -\\pi/2 & \\text{if } \\theta = \\pi/2 \\\\\n \\arctan(-\\nu\\tan\\theta) - \\pi & \\text{if } \\theta \\in (\\pi/2, \\pi) \\\\\n \\pi & \\text{if } \\theta = \\pi\n\\end{cases}\n$$\nThis function correctly gives the principal argument in the interval $(-\\pi, \\pi]$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n|G(\\theta)| = \\sqrt{\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)} & \\arg(G(\\theta)) = \\begin{cases} \\arctan(-\\nu\\tan\\theta) + \\pi & \\text{for } \\cos\\theta < 0, \\sin\\theta < 0 \\\\ \\pi/2 & \\text{for } \\cos\\theta = 0, \\sin\\theta = -1 \\\\ \\arctan(-\\nu\\tan\\theta) & \\text{for } \\cos\\theta > 0 \\\\ -\\pi/2 & \\text{for } \\cos\\theta = 0, \\sin\\theta = 1 \\\\ \\arctan(-\\nu\\tan\\theta) - \\pi & \\text{for } \\cos\\theta < 0, \\sin\\theta > 0 \\\\ \\pi & \\text{for } \\cos\\theta = -1, \\sin\\theta = 0 \\end{cases} \\end{pmatrix}\n}\n$$", "id": "3375332"}, {"introduction": "This final practice bridges the gap from simple scalar models to a full system from computational fluid dynamics: the one-dimensional Euler equations. The exercise focuses on a contact discontinuity, a wave type where density jumps but pressure and velocity remain constant, which poses a unique challenge for numerical schemes. Through a combination of analytical reasoning and programming, you will discover the conditions under which a characteristic-wise scheme can capture this feature perfectly and quantify the 'smearing' effect of numerical diffusion that occurs in less-than-ideal scenarios [@problem_id:3375346].", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma$,\n$$\n\\partial_t U + \\partial_x F(U) = 0,\\quad U = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix},\\quad F(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{bmatrix},\\quad p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right).\n$$\nA contact discontinuity is characterized by constant pressure and velocity across the interface, i.e., $p_L = p_R$ and $u_L = u_R$, with a jump only in density $\\rho$. For this configuration, the exact solution of the Riemann problem advects the contact at the speed $u$ without change in shape.\n\nYou are asked to reason from first principles about the discrete behavior of a finite-volume method using the Lax–Friedrichs flux and to implement a program that quantifies contact preservation and smearing. The Lax–Friedrichs family can be written at an interface in the form\n$$\n\\hat{F}_{\\text{LF}}(U_L,U_R) = \\tfrac{1}{2}\\left(F(U_L)+F(U_R)\\right) - \\tfrac{1}{2} \\alpha \\left(U_R-U_L\\right),\n$$\nwhere $\\alpha$ is a chosen nonnegative dissipation speed. Two paradigms are considered:\n- Scalar Lax–Friedrichs (also called local Lax–Friedrichs or Rusanov) uses a single $\\alpha$ equal to an upper bound on characteristic speeds (for the Euler equations, $\\alpha \\ge \\max(|u|+c)$ where $c$ is the local speed of sound).\n- Characteristic-wise reconstruction transforms jumps into characteristic variables and applies dissipation per wave family, then reconstructs back; assume a Roe-type linearization so the characteristic speeds are $\\lambda_1 = u - c$, $\\lambda_2 = u$, and $\\lambda_3 = u + c$.\n\nTasks:\n1. Starting from the Euler equations, use the defining properties of a contact discontinuity ($p_L=p_R$, $u_L=u_R$) to show that the mass equation reduces to the scalar advection equation for density,\n$$\n\\partial_t \\rho + u\\, \\partial_x \\rho = 0,\n$$\nand that the acoustic characteristic jumps vanish under characteristic-wise reconstruction at a contact.\n2. Using the Lax–Friedrichs form with characteristic-wise reconstruction, deduce the discrete update along the contact characteristic. Derive the necessary and sufficient conditions under which the discrete scheme preserves the contact discontinuity exactly on a uniform grid. Your derivation must identify the roles of:\n   - Equality of pressure and velocity,\n   - The Courant–Friedrichs–Lewy (CFL) number $\\sigma = \\dfrac{u\\, \\Delta t}{\\Delta x}$,\n   - The alignment of the contact with cell faces.\n3. For the scalar Lax–Friedrichs scheme applied to the scalar advection equation $\\partial_t q + a\\, \\partial_x q = 0$ with constant speed $a$, analyze the discrete Fourier mode $q_i^n = \\exp(\\mathrm{i} k x_i)$, where $x_i = i \\Delta x$ and the angle $k \\Delta x$ is in radians. Derive the single-step amplification factor magnitude $\\left|G(k \\Delta x)\\right|$ and obtain the small-wavenumber ($k \\Delta x \\ll 1$) asymptotic smearing rate by matching to a modified equation with an effective diffusion coefficient $D_{\\text{eff}}$ (in $\\mathrm{m}^2/\\mathrm{s}$).\n4. Write a complete program that implements:\n   - A one-step upwind update for the scalar advection of density representing the contact characteristic and checks exact preservation by comparing the numerical result after one time step to the exact translation by one cell. Return a boolean indicating exact preservation within machine precision.\n   - Functions that compute the amplification factor magnitude for scalar Lax–Friedrichs for a given wavenumber and parameters, and that compute the small-wavenumber effective diffusion coefficient $D_{\\text{eff}}$ for the upwind case (i.e., scalar Lax–Friedrichs with $\\alpha = |a|$).\nAll physical units must be respected: speeds in $\\mathrm{m}/\\mathrm{s}$, lengths in $\\mathrm{m}$, times in $\\mathrm{s}$, and diffusion coefficients in $\\mathrm{m}^2/\\mathrm{s}$. Angles must be in radians.\n\nTest suite:\nUse the following test cases to exercise your program. For each case, compute the specified result type.\n\n- Case A (contact preservation check, boolean): $\\gamma = 1.4$, $u = 1\\,\\mathrm{m}/\\mathrm{s}$, $p_L = p_R = 10^5\\,\\mathrm{Pa}$, $\\rho_L = 1.0\\,\\mathrm{kg}/\\mathrm{m}^3$, $\\rho_R = 0.125\\,\\mathrm{kg}/\\mathrm{m}^3$, a periodic domain of length $L = 1\\,\\mathrm{m}$ with $N=100$ cells so $\\Delta x = 0.01\\,\\mathrm{m}$, and $\\Delta t$ chosen such that $\\sigma = \\dfrac{u \\Delta t}{\\Delta x} = 1$ (i.e., $\\Delta t = 0.01\\,\\mathrm{s}$). Place the contact aligned with a cell face. Return a boolean indicating exact preservation after one step.\n- Case B (amplification magnitude for scalar Lax–Friedrichs, float): $a = 1\\,\\mathrm{m}/\\mathrm{s}$, $\\alpha = a$, $\\Delta x = 0.01\\,\\mathrm{m}$, choose $\\sigma = \\dfrac{a \\Delta t}{\\Delta x} = 0.5$, and wavenumber angle $k \\Delta x = \\dfrac{\\pi}{2}\\,\\mathrm{rad}$. Return $\\left|G\\right|$ as a float.\n- Case C (effective diffusion $D_{\\text{eff}}$ for upwind, float): same as Case B, return $D_{\\text{eff}}$ in $\\mathrm{m}^2/\\mathrm{s}$ using the small-wavenumber asymptotics.\n- Case D (amplification magnitude with over-dissipation, float): $a = 1\\,\\mathrm{m}/\\mathrm{s}$, $\\alpha = 2a$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\sigma = 0.5$, and wavenumber angle $k \\Delta x = \\dfrac{\\pi}{2}\\,\\mathrm{rad}$. Return $\\left|G\\right|$ as a float.\n- Case E (amplification magnitude at $\\sigma=1$, float): $a = 1\\,\\mathrm{m}/\\mathrm{s}$, $\\alpha = a$, $\\Delta x = 0.01\\,\\mathrm{m}$, $\\sigma = 1$, and wavenumber angle $k \\Delta x = \\dfrac{\\pi}{3}\\,\\mathrm{rad}$. Return $\\left|G\\right|$ as a float.\n\nFinal output format:\nYour program should produce a single line of output containing the results for Cases A–E, as a comma-separated list enclosed in square brackets, in the order [A,B,C,D,E]. For example, \"[True,0.12,0.0034,0.09,1.0]\".", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of computational fluid dynamics and the theory of hyperbolic conservation laws. The problem is well-posed, with all necessary data and definitions provided for a unique solution. The language is objective and precise. I will now proceed with a detailed solution.\n\n### Part 1: Analysis of the Euler Equations at a Contact Discontinuity\n\nWe begin with the one-dimensional compressible Euler equations for an ideal gas:\n$$\n\\partial_t U + \\partial_x F(U) = 0\n$$\nwhere the vectors of conserved variables $U$ and fluxes $F(U)$ are given by:\n$$\nU = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ E \\end{bmatrix}, \\quad F(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{bmatrix}\n$$\nThe pressure $p$ is related to the conserved variables through the equation of state for an ideal gas:\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)\n$$\nA contact discontinuity is defined by the conditions $u_L = u_R = u$ and $p_L = p_R = p$, with a jump in density $\\rho_L \\neq \\rho_R$. In the vicinity of such a wave, we can treat velocity $u$ and pressure $p$ as constants.\n\nThe first component of the Euler system is the mass conservation equation:\n$$\n\\partial_t \\rho + \\partial_x (\\rho u) = 0\n$$\nApplying the product rule for differentiation to the flux term, we get:\n$$\n\\partial_t \\rho + u\\,\\partial_x \\rho + \\rho\\,\\partial_x u = 0\n$$\nUnder the condition of a contact discontinuity, the velocity $u$ is constant across the interface, which implies that its spatial derivative is zero, i.e., $\\partial_x u = 0$. The mass equation thus simplifies to the scalar linear advection equation for density:\n$$\n\\partial_t \\rho + u\\,\\partial_x \\rho = 0\n$$\nThis demonstrates that the density profile is simply advected at the constant speed $u$.\n\nNext, we analyze the characteristic structure. The jump in the state vector, $\\Delta U = U_R - U_L$, across a contact discontinuity can be expressed using the given conditions. Let $\\Delta \\rho = \\rho_R - \\rho_L$.\nThe jump vector is:\n$$\n\\Delta U = \\begin{bmatrix} \\rho_R - \\rho_L \\\\ \\rho_R u - \\rho_L u \\\\ E_R - E_L \\end{bmatrix} = \\begin{bmatrix} \\Delta\\rho \\\\ u\\Delta\\rho \\\\ E_R - E_L \\end{bmatrix}\n$$\nFrom the pressure condition $p_L = p_R = p$, we have:\n$$\n(\\gamma - 1)\\left(E_L - \\tfrac{1}{2}\\rho_L u^2\\right) = (\\gamma - 1)\\left(E_R - \\tfrac{1}{2}\\rho_R u^2\\right)\n$$\nThis simplifies to $E_R - E_L = \\frac{1}{2}(\\rho_R - \\rho_L)u^2 = \\frac{1}{2}(\\Delta\\rho)u^2$.\nSubstituting this into the jump vector gives:\n$$\n\\Delta U = \\begin{bmatrix} \\Delta\\rho \\\\ u\\Delta\\rho \\\\ \\frac{1}{2}u^2\\Delta\\rho \\end{bmatrix} = \\Delta\\rho \\begin{bmatrix} 1 \\\\ u \\\\ \\frac{1}{2}u^2 \\end{bmatrix}\n$$\nThe right eigenvectors of the Euler system's Jacobian, corresponding to a Roe-type linearization, are associated with the eigenvalues $\\lambda_1 = u-c$, $\\lambda_2 = u$, and $\\lambda_3 = u+c$. The eigenvector for the contact wave (eigenvalue $\\lambda_2 = u$) is:\n$$\n\\vec{r}_2 = \\begin{bmatrix} 1 \\\\ u \\\\ \\frac{1}{2}u^2 \\end{bmatrix}\n$$\n(Note: Some definitions scale this vector, but the direction is what matters).\nBy inspection, the jump vector $\\Delta U$ is precisely a multiple of the eigenvector $\\vec{r}_2$: $\\Delta U = (\\Delta\\rho)\\vec{r}_2$. Any jump vector can be decomposed into a linear combination of the system's eigenvectors: $\\Delta U = \\sum_{k=1}^3 \\alpha_k \\vec{r}_k$. The coefficients $\\alpha_k$ represent the jump strengths in each characteristic field. As the jump at a contact is entirely aligned with $\\vec{r}_2$, the coefficients for the two acoustic waves (associated with $\\vec{r}_1$ and $\\vec{r}_3$) must be zero: $\\alpha_1 = 0$ and $\\alpha_3 = 0$. Therefore, the acoustic characteristic jumps vanish at a contact discontinuity.\n\n### Part 2: Discrete Preservation of a Contact Discontinuity\n\nThe finite volume update for a cell $i$ is given by $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}(\\hat{F}_{i+1/2} - \\hat{F}_{i-1/2})$. The characteristic-wise Lax–Friedrichs scheme uses a numerical flux that adds dissipation specific to each wave family. The flux can be written as:\n$$\n\\hat{F}(U_L, U_R) = \\tfrac{1}{2}\\left(F(U_L)+F(U_R)\\right) - \\tfrac{1}{2} \\sum_{k=1}^3 |\\tilde{\\lambda}_k| \\tilde{\\alpha}_k \\tilde{\\vec{r}}_k\n$$\nwhere $\\tilde{\\lambda}_k$ are the Roe-averaged eigenvalues and $\\tilde{\\alpha}_k \\tilde{\\vec{r}}_k$ is the decomposition of the jump $U_R-U_L$ into eigenvectors. As shown in Part 1, for a contact discontinuity, only the characteristic field corresponding to $\\lambda_2=u$ is active. Thus, the sum simplifies to a single term for $k=2$:\n$$\n\\hat{F}(U_L, U_R) = \\tfrac{1}{2}\\left(F(U_L)+F(U_R)\\right) - \\tfrac{1}{2} |u| (U_R-U_L)\n$$\nwhere we have used the fact that the jump $U_R-U_L$ is proportional to the eigenvector $\\vec{r}_2$. Let's analyze this flux. Assume $u>0$, so $|u|=u$. The flux difference is $F_R-F_L = u(U_R-U_L)$, so $F_R = F_L + u(U_R-U_L)$. Substituting this into the numerical flux:\n$$\n\\hat{F}(U_L, U_R) = \\tfrac{1}{2}\\left(F_L + F_L + u(U_R-U_L)\\right) - \\tfrac{1}{2}u(U_R-U_L) = F_L + \\tfrac{1}{2}u(U_R-U_L) - \\tfrac{1}{2}u(U_R-U_L) = F(U_L)\n$$\nThis is the first-order upwind flux. The update scheme for the full system becomes $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}(F(U_i^n) - F(U_{i-1}^n))$.\n\nFor exact preservation, the discrete solution must match the exact solution, which is a simple translation of the initial profile. Let the contact be aligned with a cell face, at index $j-1/2$, such that $U_k^n = U_L$ for $k < j$ and $U_k^n = U_R$ for $k \\ge j$.\nConsider the update for cell $j$, the first cell with state $U_R$:\n$$\nU_j^{n+1} = U_j^n - \\frac{\\Delta t}{\\Delta x}(F(U_j^n) - F(U_{j-1}^n)) = U_R - \\frac{\\Delta t}{\\Delta x}(F_R - F_L)\n$$\nUsing $F_R - F_L = u(U_R - U_L)$, this becomes:\n$$\nU_j^{n+1} = U_R - \\frac{u\\Delta t}{\\Delta x}(U_R - U_L) = U_R - \\sigma(U_R - U_L)\n$$\nwhere $\\sigma = u\\Delta t / \\Delta x$ is the Courant number.\nThe exact solution after time $\\Delta t$ requires the discontinuity to move a distance $u\\Delta t$. For exact preservation on the grid, this distance must be an integer multiple of the cell width, $\\Delta x$. The simplest non-trivial case is $u\\Delta t = \\Delta x$, which means the Courant number $\\sigma=1$.\nIf we set $\\sigma=1$, the update for cell $j$ is:\n$$\nU_j^{n+1} = U_R - 1 \\cdot (U_R - U_L) = U_L\n$$\nFor any cell $k < j$, $U_k^n=U_{k-1}^n=U_L$, so $F(U_k^n)-F(U_{k-1}^n)=0$ and $U_k^{n+1}=U_L$.\nFor any cell $k > j$, $U_k^n=U_{k-1}^n=U_R$, so $F(U_k^n)-F(U_{k-1}^n)=0$ and $U_k^{n+1}=U_R$.\nThe result is that the state of cell $j$ changes from $U_R$ to $U_L$, and all other cells retain their state. This corresponds to a perfect translation of the discontinuity by one grid cell.\nThe necessary and sufficient conditions are:\n1.  **Equality of pressure and velocity ($p_L=p_R, u_L=u_R$)**: This isolates the jump to the contact characteristic field, reducing the system dynamics to scalar advection.\n2.  **Alignment of the contact with a cell face**: This ensures the initial condition is a perfect step function on the grid.\n3.  **Courant number $\\sigma = 1$**: This synchronizes the physical wave speed with the grid, ensuring the wave front moves exactly one cell per time step, matching the stencil of the upwind scheme.\n\n### Part 3: Fourier Analysis of Scalar Lax–Friedrichs Scheme\n\nConsider the scalar advection equation $\\partial_t q + a\\, \\partial_x q = 0$. The scalar Lax-Friedrichs finite volume scheme can be written by adding a dissipation term to a central difference scheme:\n$$\nq_i^{n+1} = q_i^n - a \\frac{\\Delta t}{2\\Delta x}(q_{i+1}^n - q_{i-1}^n) + \\alpha \\frac{\\Delta t}{2\\Delta x}(q_{i+1}^n - 2q_i^n + q_{i-1}^n)\n$$\nWe substitute a Fourier mode $q_i^n = G^n e^{\\mathrm{i}k x_i}$, where $G$ is the amplification factor and $x_i=i\\Delta x$. Let $\\theta = k\\Delta x$.\n$$\nG e^{\\mathrm{i}k x_i} = e^{\\mathrm{i}k x_i} - \\frac{a\\Delta t}{2\\Delta x}(e^{\\mathrm{i}k(x_i+\\Delta x)} - e^{\\mathrm{i}k(x_i-\\Delta x)}) + \\frac{\\alpha\\Delta t}{2\\Delta x}(e^{\\mathrm{i}k(x_i+\\Delta x)} - 2e^{\\mathrm{i}k x_i} + e^{\\mathrm{i}k(x_i-\\Delta x)})\n$$\nDividing by $e^{\\mathrm{i}k x_i}$ and using the definitions $\\sigma = a\\Delta t/\\Delta x$ and $\\nu = \\alpha\\Delta t/\\Delta x$:\n$$\nG = 1 - \\frac{\\sigma}{2}(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}) + \\frac{\\nu}{2}(e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta})\n$$\nUsing Euler's identities $e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta} = 2\\mathrm{i}\\sin\\theta$ and $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} - 2 = 2\\cos\\theta - 2 = -4\\sin^2(\\theta/2)$:\n$$\nG(\\theta) = 1 - \\sigma (\\mathrm{i}\\sin\\theta) - 2\\nu \\sin^2(\\theta/2) = \\left(1 - 2\\nu \\sin^2(\\frac{\\theta}{2})\\right) - \\mathrm{i} (\\sigma\\sin\\theta)\n$$\nThe magnitude of the amplification factor is $|G(\\theta)| = \\sqrt{\\text{Re}(G)^2 + \\text{Im}(G)^2}$:\n$$\n|G(\\theta)| = \\sqrt{\\left(1 - 2\\nu \\sin^2(\\frac{\\theta}{2})\\right)^2 + (\\sigma\\sin\\theta)^2}\n$$\nTo find the effective diffusion coefficient, we perform a a Taylor series expansion of the scheme to derive its modified equation.\n$$\n\\frac{q_i^{n+1}-q_i^n}{\\Delta t} = -a\\frac{q_{i+1}-q_{i-1}}{2\\Delta x} + \\frac{\\alpha\\Delta x}{2}\\frac{q_{i+1}-2q_i+q_{i-1}}{\\Delta x^2}\n$$\nExpanding in time and space:\n$$\nq_t + \\frac{\\Delta t}{2}q_{tt} + \\mathcal{O}(\\Delta t^2) = -a(q_x + \\frac{\\Delta x^2}{6}q_{xxx} + \\dots) + \\frac{\\alpha\\Delta x}{2}(q_{xx} + \\frac{\\Delta x^2}{12}q_{xxxx} + \\dots)\n$$\nTo leading order, the scheme approximates $q_t = -aq_x$. This allows us to replace the time derivative $q_{tt} \\approx \\partial_t(-aq_x) = -a(q_t)_x \\approx -a(-aq_x)_x = a^2 q_{xx}$. Substituting this back:\n$$\nq_t + \\frac{a^2\\Delta t}{2}q_{xx} + \\dots = -aq_x + \\frac{\\alpha\\Delta x}{2}q_{xx} + \\dots\n$$\nRearranging to match the advection-diffusion form $\\partial_t q + a\\partial_x q = D_{\\text{eff}} \\partial_{xx} q$:\n$$\n\\partial_t q + a\\partial_x q = \\left(\\frac{\\alpha\\Delta x}{2} - \\frac{a^2\\Delta t}{2}\\right) \\partial_{xx} q + \\dots\n$$\nThe effective diffusion coefficient is the coefficient of the second derivative term:\n$$\nD_{\\text{eff}} = \\frac{\\alpha\\Delta x}{2} - \\frac{a^2\\Delta t}{2} = \\frac{\\Delta x}{2}(\\alpha - a \\frac{a\\Delta t}{\\Delta x}) = \\frac{\\Delta x}{2}(\\alpha - a\\sigma)\n$$\nFor the upwind case (assuming $a>0$), we set the dissipation speed $\\alpha=|a|=a$. The effective diffusion becomes:\n$$\nD_{\\text{eff}} = \\frac{a\\Delta x}{2}(1 - \\sigma)\n$$\nThis coefficient quantifies the numerical smearing (diffusion) introduced by the scheme at low wavenumbers.\n\n### Part 4: Program Implementation\n\nThe following program implements the functions required to solve the test cases.\n- `check_contact_preservation` implements the first-order upwind scheme for the scalar advection of density and verifies the exact translation property for $\\sigma=1$.\n- `amp_factor_mag` computes the amplification factor magnitude $|G|$ for the scalar Lax-Friedrichs scheme.\n- `eff_diffusion_upwind` computes the effective diffusion coefficient $D_{\\text{eff}}$ for the upwind scheme.\nThe program then executes the specified test cases and prints the results in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef check_contact_preservation(N, L, rho_L, rho_R, u, sigma):\n    \"\"\"\n    Checks for exact preservation of a contact discontinuity by the \n    first-order upwind scheme for one time step with sigma=1.\n\n    The problem states this check is for the scalar advection of density, \n    with a one-step upwind update. The characteristic-wise scheme for Euler's\n    equations reduces to this for the density component at a contact.\n    \"\"\"\n    dx = L / N\n    dt = sigma * dx / u\n    \n    # Initial condition: contact aligned at the center face\n    # rho_L for i < N/2, rho_R for i >= N/2\n    rho_initial = np.full(N, rho_R)\n    split_index = N // 2\n    rho_initial[:split_index] = rho_L\n    \n    # Exact solution after one time step (for sigma=1, it's a shift by one cell)\n    # np.roll performs a circular shift, which correctly models periodic boundaries.\n    rho_exact = np.roll(rho_initial, 1)\n\n    # Numerical solution after one time step using first-order upwind scheme\n    # rho_new[i] = rho_old[i] - sigma * (rho_old[i] - rho_old[i-1])\n    # For sigma=1, this simplifies to rho_new[i] = rho_old[i-1].\n    \n    rho_numerical = np.zeros_like(rho_initial)\n    for i in range(N):\n        # Periodic boundary for i-1\n        idx_prev = (i - 1 + N) % N\n        rho_numerical[i] = rho_initial[i] - sigma * (rho_initial[i] - rho_initial[idx_prev])\n        \n    # Check if numerical result is identical to exact result within machine precision\n    return np.allclose(rho_numerical, rho_exact)\n\ndef amp_factor_mag(a, alpha, dx, sigma, k_dx):\n    \"\"\"\n    Computes the magnitude of the amplification factor for the scalar Lax-Friedrichs scheme.\n    \"\"\"\n    # sigma = a * dt / dx\n    # nu = alpha * dt / dx\n    dt = sigma * dx / a\n    nu = alpha * dt / dx\n    theta = k_dx\n\n    # G = (1 - 2*nu*sin^2(theta/2)) - i*(sigma*sin(theta))\n    real_part = 1 - 2 * nu * np.sin(theta / 2)**2\n    imag_part = sigma * np.sin(theta)\n    \n    magnitude = np.sqrt(real_part**2 + imag_part**2)\n    return magnitude\n\ndef eff_diffusion_upwind(a, dx, sigma):\n    \"\"\"\n    Computes the effective diffusion coefficient for the upwind scheme.\n    This corresponds to scalar Lax-Friedrichs with alpha = |a|.\n    \"\"\"\n    # Formula derived from modified equation analysis: D_eff = a*dx/2 * (1-sigma) for a > 0\n    if a < 0:\n        # For a < 0, upwind is F_R, sigma = a*dt/dx < 0.\n        # D_eff = |a|*dx/2 * (1-|sigma|)\n        return -a * dx / 2.0 * (1.0 - abs(sigma))\n    return a * dx / 2.0 * (1.0 - sigma)\n\ndef solve():\n    \"\"\"\n    Executes all test cases and prints the results.\n    \"\"\"\n    results = []\n    \n    # Case A: Contact preservation check\n    case_A_result = check_contact_preservation(\n        N=100, L=1.0, \n        rho_L=1.0, rho_R=0.125, \n        u=1.0, sigma=1.0\n    )\n    results.append(case_A_result)\n\n    # Case B: Amplification magnitude for upwind scheme\n    case_B_result = amp_factor_mag(\n        a=1.0, alpha=1.0, dx=0.01, \n        sigma=0.5, k_dx=np.pi/2\n    )\n    results.append(case_B_result)\n\n    # Case C: Effective diffusion for upwind scheme\n    case_C_result = eff_diffusion_upwind(\n        a=1.0, dx=0.01, sigma=0.5\n    )\n    results.append(case_C_result)\n\n    # Case D: Amplification magnitude with over-dissipation\n    case_D_result = amp_factor_mag(\n        a=1.0, alpha=2.0, dx=0.01,\n        sigma=0.5, k_dx=np.pi/2\n    )\n    results.append(case_D_result)\n    \n    # Case E: Amplification magnitude at sigma=1 (upwind)\n    case_E_result = amp_factor_mag(\n        a=1.0, alpha=1.0, dx=0.01,\n        sigma=1.0, k_dx=np.pi/3\n    )\n    results.append(case_E_result)\n\n    # Format the final output string\n    # E.g., \"[True,0.7071067811865476,0.0025,0.5,1.0]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3375346"}]}