{"hands_on_practices": [{"introduction": "In computational fluid dynamics, the thermodynamic state of a gas can be described by different sets of variables, such as the primitive variables $(\\rho, u, T)$ or the conservative variables $(\\rho, \\rho u, \\rho E)$. For a solution to be physically consistent, the pressure calculated from these different sets must be identical. This hands-on practice [@problem_id:3351103] guides you through the process of deriving these two pathways to pressure and using the discrepancy between them as a powerful error indicator, a technique frequently used to guide adaptive mesh refinement near shocks or other regions with large numerical error.", "problem": "Design and implement a program that, for a calorically perfect gas, detects violations of the equation of state (EOS) consistency by independently computing the thermodynamic pressure from two different sets of state variables and comparing the results. Starting strictly from fundamental thermodynamic identities and core definitions applicable to computational fluid dynamics for a perfect gas, derive how to compute the pressure $p$ using the triplet $(\\rho,E,u)$ (density, total energy per unit volume, and bulk velocity) and separately using the pair $(\\rho,T)$ (density and temperature). Use the discrepancy between these two independently computed pressures as an error indicator to decide whether a computational cell should be marked for mesh refinement, as would be needed near shocks.\n\nAll computations must adhere to physically consistent units:\n- Density $\\rho$ in $\\mathrm{kg}/\\mathrm{m}^3$,\n- Velocity $u$ in $\\mathrm{m}/\\mathrm{s}$,\n- Temperature $T$ in $\\mathrm{K}$,\n- Gas constant $R$ in $\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$,\n- Ratio of specific heats $\\gamma$ dimensionless,\n- Total energy per unit volume $E$ in $\\mathrm{J}/\\mathrm{m}^3$,\n- Pressure $p$ in $\\mathrm{Pa}$.\n\nYour program must:\n- For each test case, compute $p$ from $(\\rho,E,u)$ and from $(\\rho,T)$ using principles derived from thermodynamic identities for a calorically perfect gas.\n- Compute a dimensionless discrepancy indicator as the absolute difference between the two pressures normalized by a physically sensible scale to avoid division by zero.\n- Compare this indicator against a refinement threshold $\\tau$ and return a boolean that is `True` if the cell should be refined and `False` otherwise.\n\nImplement the following test suite of parameter values, covering consistency, mild inconsistency, strong shock-like conditions, near-vacuum behavior, and an explicitly inconsistent energy case:\n1. Case A (consistent, moderate flow): $\\rho = 1.225$, $u = 50.0$, $T = 300.0$, $\\gamma = 1.4$, $R = 287.0$, $E = 265212.5$, $\\tau = 0.05$.\n2. Case B (mismatched temperature): $\\rho = 1.225$, $u = 50.0$, $T = 310.0$, $\\gamma = 1.4$, $R = 287.0$, $E = 265212.5$, $\\tau = 0.05$.\n3. Case C (high-speed, high-temperature, consistent): $\\rho = 5.0$, $u = 1500.0$, $T = 1200.0$, $\\gamma = 1.4$, $R = 287.0$, $E = 9930000.0$, $\\tau = 0.05$.\n4. Case D (near vacuum, consistent): $\\rho = 0.01$, $u = 0.0$, $T = 200.0$, $\\gamma = 1.4$, $R = 287.0$, $E = 1435.0$, $\\tau = 0.05$.\n5. Case E (inconsistent energy leading to nonphysical pressure from energy route): $\\rho = 1.0$, $u = 300.0$, $T = 400.0$, $\\gamma = 1.4$, $R = 287.0$, $E = 44000.0$, $\\tau = 0.05$.\n\nIn each case, the value of $E$ is selected to be either consistent with $(\\rho,u,T)$ for a calorically perfect gas or deliberately inconsistent to test detection. In your implementation, handle potential degeneracies (e.g., very small pressures) with a nonzero normalization scale.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the boolean refinement decision for the corresponding test case in the given order (for example, `[False,True,False,False,True]`).", "solution": "The problem requires the development of a method to detect inconsistencies in the thermodynamic state of a calorically perfect gas, a common task in the validation of computational fluid dynamics (CFD) solutions. This is achieved by computing the thermodynamic pressure, $p$, through two independent pathways derived from fundamental principles, and then quantifying the discrepancy between the two results. The decision to refine a computational cell is based on this discrepancy exceeding a given threshold, $\\tau$.\n\nFirst, we establish the thermodynamic framework for a calorically perfect gas. Such a gas adheres to the perfect gas equation of state and has constant specific heats at constant volume ($c_v$) and constant pressure ($c_p$).\n\nThe primary thermodynamic variables and constants are:\n- Pressure: $p$\n- Density: $\\rho$\n- Temperature: $T$\n- Specific gas constant: $R$\n- Ratio of specific heats: $\\gamma = c_p/c_v$\n- Specific internal energy: $e$\n- Total energy per unit volume: $E$\n- Bulk velocity magnitude: $u$\n\nThe fundamental relationships are:\n1.  The perfect gas equation of state:\n    $$p = \\rho R T$$\n2.  The definition of a calorically perfect gas, for which specific internal energy is a linear function of temperature:\n    $$e = c_v T$$\n3.  The relationship between specific heats, the gas constant, and the ratio of specific heats:\n    $$R = c_p - c_v \\quad \\text{and} \\quad \\gamma = \\frac{c_p}{c_v}$$\n    From these, we can derive an expression for $c_v$ in terms of $R$ and $\\gamma$:\n    $$R = (\\gamma c_v) - c_v = c_v (\\gamma - 1) \\implies c_v = \\frac{R}{\\gamma - 1}$$\n4.  The definition of total energy per unit volume, $E$, as the sum of internal energy per unit volume and kinetic energy per unit volume:\n    $$E = \\rho e + \\frac{1}{2} \\rho u^2$$\n\nWith these principles, we can now derive the two distinct formulas for pressure.\n\n**Path 1: Pressure from Density and Temperature $(\\rho, T)$**\n\nThis path is a direct application of the perfect gas equation of state. We will denote the pressure computed this way as $p_T$.\n$$p_T = \\rho R T$$\nThis formula provides the pressure based on the primitive variables $\\rho$ and $T$.\n\n**Path 2: Pressure from Density, Total Energy, and Velocity $(\\rho, E, u)$**\n\nThis path is crucial in CFD solvers, which typically advance the conserved variables $(\\rho, \\rho \\mathbf{u}, E)$ in time. We derive a formula for pressure, denoted $p_E$, from this set of variables.\n\nFirst, we establish a relationship between pressure $p$ and specific internal energy $e$.\nFrom $e = c_v T$ and $T = p / (\\rho R)$, we have:\n$$e = c_v \\frac{p}{\\rho R}$$\nSubstituting $c_v = R / (\\gamma - 1)$:\n$$e = \\left(\\frac{R}{\\gamma - 1}\\right) \\frac{p}{\\rho R} = \\frac{p}{\\rho(\\gamma - 1)}$$\nRearranging for pressure gives the important relation:\n$$p = (\\gamma - 1) \\rho e$$\nNext, we use the definition of total energy $E$ to express $\\rho e$:\n$$\\rho e = E - \\frac{1}{2}\\rho u^2$$\nSubstituting this expression for $\\rho e$ into the pressure equation yields our second formula for pressure, $p_E$:\n$$p_E = (\\gamma - 1) \\left( E - \\frac{1}{2} \\rho u^2 \\right)$$\nThis gives the pressure based on the conserved state variables. A non-physical negative pressure can result from this formula if the total energy $E$ is less than the kinetic energy, $E < \\frac{1}{2}\\rho u^2$, which implies a negative internal energy. This is a clear sign of a severe inconsistency in the data.\n\n**Discrepancy Indicator and Refinement Criterion**\n\nWith two independent calculations for pressure, $p_T$ and $p_E$, we can define a dimensionless discrepancy indicator, $\\Delta$. This indicator quantifies the relative difference between the two values. A symmetric and robust choice for normalization, which avoids division by zero when one pressure is zero and is sensitive to differences in sign, is:\n$$\\Delta = \\frac{|p_E - p_T|}{\\frac{1}{2}(|p_E| + |p_T|)}$$\nThis formula measures the difference relative to the average magnitude of the pressures. If both $p_E$ and $p_T$ are zero, the state is a consistent vacuum, the numerator is zero, and the discrepancy $\\Delta$ should be zero. Our implementation will handle this edge case. If $p_E = -p_T \\neq 0$, the discrepancy is $\\Delta = |-2p_T| / |p_T| = 2$, correctly indicating a maximal inconsistency.\n\nThe final step is to apply the refinement criterion. A computational cell is flagged for refinement if the discrepancy $\\Delta$ exceeds a specified tolerance $\\tau$. The boolean decision is:\n$$\\text{Refine} = (\\Delta > \\tau)$$\n\nThis procedure is implemented for each test case provided. The calculation for each case is as follows:\n1.  Calculate $p_T = \\rho R T$.\n2.  Calculate $p_E = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$.\n3.  Calculate $\\Delta = \\frac{|p_E - p_T|}{0.5 \\times (|p_E| + |p_T|)}$, handling the case where the denominator is zero.\n4.  Return `True` if $\\Delta > \\tau$, otherwise `False`.\n\nThis systematic process, grounded in fundamental thermodynamic identities, provides a reliable method for assessing the local consistency of a numerical solution for a perfect gas.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the EOS consistency problem for a set of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (rho, u, T, gamma, R, E, tau)\n    test_cases = [\n        # Case A (consistent, moderate flow)\n        (1.225, 50.0, 300.0, 1.4, 287.0, 265212.5, 0.05),\n        # Case B (mismatched temperature)\n        (1.225, 50.0, 310.0, 1.4, 287.0, 265212.5, 0.05),\n        # Case C (high-speed, high-temperature, consistent)\n        (5.0, 1500.0, 1200.0, 1.4, 287.0, 9930000.0, 0.05),\n        # Case D (near vacuum, consistent)\n        (0.01, 0.0, 200.0, 1.4, 287.0, 1435.0, 0.05),\n        # Case E (inconsistent energy leading to nonphysical pressure)\n        (1.0, 300.0, 400.0, 1.4, 287.0, 44000.0, 0.05),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, u, T, gamma, R, E, tau = case\n\n        # Path 1: Compute pressure from density and temperature\n        # p_T = rho * R * T\n        p_T = rho * R * T\n\n        # Path 2: Compute pressure from conserved variables\n        # p_E = (gamma - 1) * (E - 0.5 * rho * u^2)\n        kinetic_energy_per_volume = 0.5 * rho * u**2\n        internal_energy_per_volume = E - kinetic_energy_per_volume\n        p_E = (gamma - 1) * internal_energy_per_volume\n\n        # Compute the dimensionless discrepancy indicator\n        # Delta = |p_E - p_T| / (0.5 * (|p_E| + |p_T|))\n        numerator = np.abs(p_E - p_T)\n        denominator = 0.5 * (np.abs(p_E) + np.abs(p_T))\n\n        discrepancy = 0.0\n        # The denominator is zero only if both p_E and p_T are zero.\n        # In this case, the numerator is also zero, so the state is consistent.\n        if denominator != 0:\n            discrepancy = numerator / denominator\n\n        # Compare against the refinement threshold\n        should_refine = discrepancy > tau\n        results.append(should_refine)\n\n    # Format the final output as a single-line string\n    # e.g., [False,False,False,False,True]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str.replace(\"True\", \"True\").replace(\"False\", \"False\"))\n\n# Execute the solver\nsolve()\n```", "id": "3351103"}, {"introduction": "The assumption of a calorically perfect gas, where specific heats $c_p$ and $c_v$ are constant, is a cornerstone of many aerodynamic theories, but it has its limits. For high-temperature flows, such as in hypersonic flight or combustion, the specific heats of gases like air are known to vary significantly with temperature. This exercise [@problem_id:3351072] challenges you to quantify the errors introduced by the constant-property assumption by comparing its predictions against a more accurate, temperature-dependent model for isentropic nozzle flow, providing you with critical insight into the validity of the models you employ.", "problem": "You are asked to design a program that quantifies the deviations induced by assuming constant specific heat at constant pressure and constant ratio of specific heats versus using temperature-dependent specific heat functions for a calorically imperfect but mechanically and thermally perfect gas, under isentropic nozzle expansion. The gas is dry air modeled as a single-component perfect gas with constant composition and a constant mass-specific gas constant. The program should compare the predicted static temperature, static pressure, and local acoustic speed for a nozzle exit at a specified Mach number using two models: (i) a constant-property model using specific heat at constant pressure and ratio of specific heats fixed at the stagnation temperature, and (ii) a temperature-dependent model using specific heat at constant pressure and specific heat at constant volume varying with temperature via a specified polynomial. Start from fundamental laws and core definitions only and do not rely on shortcut formulas. For all computations, use mass-specific quantities.\n\nAssumptions and base definitions:\n- The gas obeys the perfect-gas equation of state $p = \\rho R T$, where $p$ is pressure, $\\rho$ is density, $R$ is the mass-specific gas constant, and $T$ is temperature. Use $R = 287.058 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$ and treat $R$ as constant.\n- The specific heat at constant pressure $c_p(T)$ is temperature dependent according to a calibrated polynomial centered at a reference temperature. Use\n$$\nc_p(T) = a_0 + a_1 \\left(T - T_{\\mathrm{ref}}\\right) + a_2 \\left(T - T_{\\mathrm{ref}}\\right)^2,\n$$\nwith $T_{\\mathrm{ref}} = 300 \\, \\mathrm{K}$, $a_0 = 1005.0 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $a_1 = 0.1 \\, \\mathrm{J\\,kg^{-1}\\,K^{-2}}$, and $a_2 = 1\\times 10^{-4} \\, \\mathrm{J\\,kg^{-1}\\,K^{-3}}$. These coefficients are chosen to be scientifically plausible over the range of temperatures in the test suite and yield increasing $c_p$ with temperature. The specific heat at constant volume is $c_v(T) = c_p(T) - R$, and the ratio of specific heats is $\\gamma(T) = c_p(T)/c_v(T)$.\n- The isentropic expansion is adiabatic and reversible with no body forces, shaft work, or heat transfer, so the stagnation enthalpy is conserved along a streamline and the entropy is constant, implying $h_0 = h + u^2/2$ and $ds = 0$, where $h$ is specific enthalpy, $u$ is flow speed, and $s$ is specific entropy.\n- The local acoustic speed $a$ is defined from the thermodynamic identity $a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$, which for an ideal gas under isentropic conditions leads to $a(T) = \\sqrt{\\gamma(T) R T}$.\n\nYour task:\n- For each test case, compute the static temperature $T$, static pressure $p$, and local acoustic speed $a$ at the nozzle exit for a prescribed exit Mach number $M$, stagnation temperature $T_0$, and stagnation pressure $p_0$, using both of the following models:\n  1. Constant-property model: Fix $c_p$ and $\\gamma$ at $T_0$ (i.e., $c_{p,\\mathrm{const}} = c_p(T_0)$ and $\\gamma_{\\mathrm{const}} = \\gamma(T_0)$). Use the energy conservation and isentropic condition to determine $T$, $p$, and $a$ with these constants.\n  2. Temperature-dependent model: Use $c_p(T)$ and $c_v(T)$ as functions of $T$ in the energy and isentropic conditions. Solve the nonlinear temperature equation implied by $h_0 - h(T) = u^2/2$ with $u = M a(T)$ and $a(T) = \\sqrt{\\gamma(T) R T}$, and compute $p$ from the isentropic condition derived from $ds = 0$.\n- Quantify the deviations as relative differences, defined by $\\Delta T = \\left(T_{\\mathrm{const}} - T_{\\mathrm{var}}\\right) / T_{\\mathrm{var}}$, $\\Delta p = \\left(p_{\\mathrm{const}} - p_{\\mathrm{var}}\\right) / p_{\\mathrm{var}}$, and $\\Delta a = \\left(a_{\\mathrm{const}} - a_{\\mathrm{var}}\\right) / a_{\\mathrm{var}}$, where the subscript “const” refers to the constant-property model and “var” refers to the temperature-dependent model.\n\nImplementation guidance:\n- Compute enthalpy differences through $h_0 - h(T) = \\int_{T}^{T_0} c_p(\\tau)\\,d\\tau$ using numerical quadrature.\n- Use the isentropic condition $ds = 0$ expressed for a perfect gas with temperature-dependent $c_p(T)$ as $ds = c_p(T)dT/T - R dp/p = 0$, then integrate to obtain $p(T)$ relative to $p_0$. Use numerical quadrature for the integral $\\int c_p(T)/(R\\,T)\\, dT$.\n- Use a robust root finding method to solve the nonlinear temperature equation for the temperature-dependent model.\n- For the constant-property model, apply the same base laws with $c_p$ and $\\gamma$ held constant at $T_0$. Compute the acoustic speed from $a(T) = \\sqrt{\\gamma R T}$.\n\nUnits and output:\n- Express temperatures in $\\mathrm{K}$, pressures in $\\mathrm{Pa}$, and speeds in $\\mathrm{m/s}$ internally, but the program’s final output should contain unitless relative deviations as defined above.\n- The final output should be a single line containing the list of results for all test cases as a comma-separated list enclosed in square brackets. Each test case’s result is an inner list of three floats $[\\Delta T, \\Delta p, \\Delta a]$, for example, $[[\\delta_{T,1}, \\delta_{p,1}, \\delta_{a,1}], [\\delta_{T,2}, \\delta_{p,2}, \\delta_{a,2}]]$.\n\nTest suite to cover different regimes:\n- Case $1$: $T_0 = 1000 \\, \\mathrm{K}$, $p_0 = 200000 \\, \\mathrm{Pa}$, $M = 2.0$.\n- Case $2$: $T_0 = 300 \\, \\mathrm{K}$, $p_0 = 101325 \\, \\mathrm{Pa}$, $M = 0.05$.\n- Case $3$: $T_0 = 1500 \\, \\mathrm{K}$, $p_0 = 500000 \\, \\mathrm{Pa}$, $M = 5.0$.\n- Case $4$: $T_0 = 600 \\, \\mathrm{K}$, $p_0 = 300000 \\, \\mathrm{Pa}$, $M = 1.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4]$), where each $\\mathrm{result}_i$ is the inner list $[\\Delta T, \\Delta p, \\Delta a]$ for the $i$-th test case.", "solution": "The user requests a program to quantify the deviation between a constant-property gas model and a temperature-dependent property model for isentropic nozzle flow. Before constructing the program, the problem statement is validated.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Equation of State**: Perfect gas, $p = \\rho R T$.\n- **Gas Constant**: $R = 287.058 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- **Specific Heat ($c_p$) Polynomial**: $c_p(T) = a_0 + a_1 (T - T_{\\mathrm{ref}}) + a_2 (T - T_{\\mathrm{ref}})^2$, with $T_{\\mathrm{ref}} = 300 \\, \\mathrm{K}$, $a_0 = 1005.0 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $a_1 = 0.1 \\, \\mathrm{J\\,kg^{-1}\\,K^{-2}}$, $a_2 = 1\\times 10^{-4} \\, \\mathrm{J\\,kg^{-1}\\,K^{-3}}$.\n- **Related Properties**: $c_v(T) = c_p(T) - R$, $\\gamma(T) = c_p(T)/c_v(T)$.\n- **Flow Conditions**: Isentropic expansion ($ds=0$), implying conservation of stagnation enthalpy ($h_0 = h + u^2/2$).\n- **Acoustic Speed**: $a(T) = \\sqrt{\\gamma(T) R T}$.\n- **Models**: \n  1. Constant-property: $c_p$ and $\\gamma$ fixed at their values at the stagnation temperature $T_0$.\n  2. Temperature-dependent: $c_p(T)$ and $\\gamma(T)$ are functions of the local static temperature $T$.\n- **Task**: For given $(T_0, p_0, M)$, calculate exit static temperature $T$, static pressure $p$, and acoustic speed $a$ for both models.\n- **Output**: Relative differences $\\Delta T = (T_{\\mathrm{const}} - T_{\\mathrm{var}}) / T_{\\mathrm{var}}$, $\\Delta p = (p_{\\mathrm{const}} - p_{\\mathrm{var}}) / p_{\\mathrm{var}}$, $\\Delta a = (a_{\\mathrm{const}} - a_{\\mathrm{var}}) / a_{\\mathrm{var}}$.\n- **Test Cases**: \n  1. ($T_0=1000\\,\\mathrm{K}, p_0=200000\\,\\mathrm{Pa}, M=2.0$)\n  2. ($T_0=300\\,\\mathrm{K}, p_0=101325\\,\\mathrm{Pa}, M=0.05$)\n  3. ($T_0=1500\\,\\mathrm{K}, p_0=500000\\,\\mathrm{Pa}, M=5.0$)\n  4. ($T_0=600\\,\\mathrm{K}, p_0=300000\\,\\mathrm{Pa}, M=1.0$)\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-founded in classical thermodynamics and gas dynamics. The use of a calorically imperfect gas model is a standard, physically accurate extension of the simpler perfect gas model. The governing equations ($p=\\rho R T$, $h_0 = h+u^2/2$, $ds=0$) are fundamental principles. The polynomial for $c_p(T)$ and its coefficients are physically realistic for air at elevated temperatures.\n- **Well-Posedness**: The problem is well-posed. The combination of stagnation conditions ($T_0, p_0$) and an exit Mach number ($M$) for a one-dimensional isentropic flow provides sufficient information to uniquely determine the thermodynamic state at the exit. The nonlinear equation for temperature in the variable-property model can be shown to have a unique, physically meaningful solution.\n- **Objectivity**: The problem is stated in precise, objective, and quantitative terms, free from ambiguity or subjective claims.\n- **Completeness and Consistency**: The problem is self-contained and internally consistent. All necessary data, constants, and governing laws are explicitly provided.\n- **Other Criteria**: The problem is not trivial, tautological, or ill-structured. It represents a meaningful engineering and physics problem.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be developed based on the provided principles.\n\n### Derivation of Governing Equations\n\nThe solution requires solving for the nozzle exit state using two different models for gas properties. Both models stem from the same fundamental laws.\n\n**1. Fundamental Relations**\nFor an adiabatic, reversible (isentropic) flow of a perfect gas from a stagnation state ($T_0, p_0$) to an exit state ($T, p, u, M$):\n- **Energy Conservation**: The stagnation enthalpy is constant: $h_0 = h(T) + u^2/2$. The enthalpy difference is $h_0 - h(T) = \\int_{T}^{T_0} c_p(\\tau) d\\tau$. The flow velocity is $u=Ma(T)$. The speed of sound is $a(T)=\\sqrt{\\gamma(T)RT}$. Combining these gives the central energy balance:\n$$ \\int_{T}^{T_0} c_p(\\tau) \\,d\\tau = \\frac{1}{2} M^2 a(T)^2 = \\frac{1}{2} M^2 \\gamma(T) R T $$\n- **Entropy Conservation**: The entropy is constant ($ds=0$). For a perfect gas, $ds = c_p(T) \\frac{dT}{T} - R \\frac{dp}{p}$. Integrating from the exit state to the stagnation state:\n$$ \\int_T^{T_0} c_p(\\tau) \\frac{d\\tau}{\\tau} - \\int_p^{p_0} R \\frac{dp'}{p'} = 0 \\implies R \\ln\\left(\\frac{p_0}{p}\\right) = \\int_T^{T_0} \\frac{c_p(\\tau)}{\\tau} d\\tau $$\nThis yields the pressure $p$ once $T$ is known:\n$$ p = p_0 \\exp\\left( -\\frac{1}{R} \\int_T^{T_0} \\frac{c_p(\\tau)}{\\tau} d\\tau \\right) $$\n\n**2. Constant-Property Model (Subscript \"const\")**\nHere, $c_p$ and $\\gamma$ are constants evaluated at $T_0$: $c_{p, \\mathrm{const}} = c_p(T_0)$ and $\\gamma_{\\mathrm{const}} = \\gamma(T_0)$.\n- **Temperature**: The energy integral simplifies to $c_{p,\\mathrm{const}}(T_0 - T)$. Using the relation $c_p = \\frac{\\gamma R}{\\gamma-1}$, the energy equation becomes algebraic and yields the well-known isentropic relation:\n$$ \\frac{T_0}{T_{\\mathrm{const}}} = 1 + \\frac{\\gamma_{\\mathrm{const}}-1}{2} M^2 \\implies T_{\\mathrm{const}} = T_0 \\left(1 + \\frac{\\gamma_{\\mathrm{const}}-1}{2} M^2\\right)^{-1} $$\n- **Pressure**: The entropy integral simplifies to $c_{p, \\mathrm{const}}\\ln(T_0/T)$. This yields the standard pressure relation:\n$$ \\frac{p_0}{p_{\\mathrm{const}}} = \\left(\\frac{T_0}{T_{\\mathrm{const}}}\\right)^{\\frac{c_{p,\\mathrm{const}}}{R}} = \\left(\\frac{T_0}{T_{\\mathrm{const}}}\\right)^{\\frac{\\gamma_{\\mathrm{const}}}{\\gamma_{\\mathrm{const}}-1}} \\implies p_{\\mathrm{const}} = p_0 \\left(1 + \\frac{\\gamma_{\\mathrm{const}}-1}{2} M^2\\right)^{-\\frac{\\gamma_{\\mathrm{const}}}{\\gamma_{\\mathrm{const}}-1}} $$\n- **Acoustic Speed**: Evaluated at the exit temperature $T_{\\mathrm{const}}$ using the constant $\\gamma_{\\mathrm{const}}$:\n$$ a_{\\mathrm{const}} = \\sqrt{\\gamma_{\\mathrm{const}} R T_{\\mathrm{const}}} $$\n\n**3. Temperature-Dependent Model (Subscript \"var\")**\nHere, $c_p(T)$ and $\\gamma(T)$ vary with temperature.\n- **Temperature**: The static temperature $T_{\\mathrm{var}}$ must be found by numerically solving the nonlinear energy equation:\n$$ f(T) = \\int_T^{T_0} c_p(\\tau) \\,d\\tau - \\frac{1}{2} M^2 \\gamma(T) R T = 0 $$\nThe integral can be evaluated analytically for higher precision. Let $H(T)=\\int c_p(T)dT$. The equation is $H(T_0) - H(T_{\\mathrm{var}}) - \\frac{1}{2} M^2 \\gamma(T_{\\mathrm{var}}) R T_{\\mathrm{var}} = 0$. This requires a numerical root-finding algorithm.\n- **Pressure**: Once $T_{\\mathrm{var}}$ is found, $p_{\\mathrm{var}}$ is computed from the entropy relation, again using an analytical integral for precision. Let $S(T) = \\int \\frac{c_p(T)}{T} dT$. Then:\n$$ p_{\\mathrm{var}} = p_0 \\exp\\left( -\\frac{1}{R} (S(T_0) - S(T_{\\mathrm{var}})) \\right) $$\n- **Acoustic Speed**: Evaluated at the local exit temperature $T_{\\mathrm{var}}$ using properties at that temperature:\n$$ a_{\\mathrm{var}} = \\sqrt{\\gamma(T_{\\mathrm{var}}) R T_{\\mathrm{var}}} $$\n\n**4. Integral Formulations**\nGiven $c_p(T) = a_0 + a_1(T - T_{\\mathrm{ref}}) + a_2(T - T_{\\mathrm{ref}})^2$:\n- **Antiderivative of $c_p(T)$**: $H(T) = \\int c_p(T)dT = a_0 T + \\frac{a_1}{2}(T-T_{\\mathrm{ref}})^2 + \\frac{a_2}{3}(T-T_{\\mathrm{ref}})^3$.\n- **Antiderivative of $c_p(T)/T$**: $S(T) = \\int \\frac{c_p(T)}{T}dT = (a_1 - 2a_2 T_{\\mathrm{ref}})T + \\frac{a_2}{2}T^2 + (a_0 - a_1 T_{\\mathrm{ref}} + a_2 T_{\\mathrm{ref}}^2) \\ln(T)$.\n\nThese analytical forms will be used in the implementation to solve for the state variables in the temperature-dependent model.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes deviations between constant-property and temperature-dependent\n    gas models for isentropic nozzle expansion.\n    \"\"\"\n    # Define physical and gas property constants\n    R = 287.058  # J/kg/K, mass-specific gas constant for dry air\n    T_ref = 300.0  # K, reference temperature for c_p polynomial\n    a0 = 1005.0  # J/kg/K\n    a1 = 0.1  # J/kg/K^2\n    a2 = 1.0e-4  # J/kg/K^3\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1000.0, 200000.0, 2.0), # T0 (K), p0 (Pa), M\n        (300.0, 101325.0, 0.05),\n        (1500.0, 500000.0, 5.0),\n        (600.0, 300000.0, 1.0),\n    ]\n\n    # --- Helper functions for gas properties ---\n\n    def get_cp(T):\n        \"\"\"Computes specific heat at constant pressure c_p(T).\"\"\"\n        return a0 + a1 * (T - T_ref) + a2 * (T - T_ref)**2\n\n    def get_gamma(T):\n        \"\"\"Computes ratio of specific heats gamma(T).\"\"\"\n        cp = get_cp(T)\n        cv = cp - R\n        return cp / cv\n\n    def enthalpy_antiderivative(T):\n        \"\"\"Analytic antiderivative of c_p(T), H(T) = integral(c_p(T) dT).\"\"\"\n        return a0 * T + (a1 / 2.0) * (T - T_ref)**2 + (a2 / 3.0) * (T - T_ref)**3\n\n    def entropy_integral_antiderivative(T):\n        \"\"\"Analytic antiderivative of c_p(T)/T, S(T) = integral(c_p(T)/T dT).\"\"\"\n        c0_s = a0 - a1 * T_ref + a2 * T_ref**2\n        c1_s = a1 - 2 * a2 * T_ref\n        c2_s = a2\n        return c1_s * T + (c2_s / 2.0) * T**2 + c0_s * np.log(T)\n\n    results = []\n    for T0, p0, M in test_cases:\n        # --- (i) Constant-Property Model Calculation ---\n        gamma_const = get_gamma(T0)\n        \n        temp_ratio_const = 1.0 + (gamma_const - 1.0) / 2.0 * M**2\n        \n        T_const = T0 / temp_ratio_const\n        \n        p_const = p0 / (temp_ratio_const)**(gamma_const / (gamma_const - 1.0))\n        \n        a_const = np.sqrt(gamma_const * R * T_const)\n        \n        # --- (ii) Temperature-Dependent Model Calculation ---\n        \n        # Define the function f(T) = 0 to be solved for T_var\n        H_T0 = enthalpy_antiderivative(T0)\n        def temp_root_func(T):\n            if T <= 0: return np.inf # Avoid math domain errors\n            H_T = enthalpy_antiderivative(T)\n            enthalpy_diff = H_T0 - H_T\n            kinetic_energy = 0.5 * M**2 * get_gamma(T) * R * T\n            return enthalpy_diff - kinetic_energy\n\n        # Solve for T_var using a robust root-finding method\n        # Bracket [epsilon, T0] is safe as T_var must be < T0 for M>0\n        sol = root_scalar(temp_root_func, bracket=[1e-3, T0], method='brentq')\n        T_var = sol.root\n\n        # Calculate p_var using the found T_var\n        S_T0 = entropy_integral_antiderivative(T0)\n        S_T_var = entropy_integral_antiderivative(T_var)\n        p_var = p0 * np.exp(-(S_T0 - S_T_var) / R)\n        \n        # Calculate a_var\n        gamma_var = get_gamma(T_var)\n        a_var = np.sqrt(gamma_var * R * T_var)\n\n        # --- Quantify Deviations ---\n        delta_T = (T_const - T_var) / T_var\n        delta_p = (p_const - p_var) / p_var\n        delta_a = (a_const - a_var) / a_var\n        \n        results.append([delta_T, delta_p, delta_a])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(f\"{results}\")\n\nsolve()\n```", "id": "3351072"}, {"introduction": "The prediction of normal shock waves is a fundamental test for any CFD solver designed for compressible flow, with the governing Rankine-Hugoniot relations derived directly from first principles. The resulting jump in properties, such as the pressure ratio $p_2/p_1$, is critically dependent on both the upstream Mach number $M_1$ and the ratio of specific heats $\\gamma$. This practice [@problem_id:3351075] has you derive this relationship and perform a sensitivity analysis to understand how uncertainty or a mis-specification in the value of $\\gamma$ propagates to the predicted shock strength, a crucial skill for assessing the robustness of simulation results.", "problem": "A steady, planar, one-dimensional normal shock wave in a calorically perfect gas with constant specific heat ratio $\\gamma$ is modeled in Computational Fluid Dynamics (CFD). The upstream state is uniform with Mach number $M_1$, and the gas obeys the ideal-gas equation of state $p=\\rho R T$. In practice, the value of $\\gamma$ used in a CFD simulation may be mis-specified. To assess the impact of this on the predicted shock strength, you will derive the pressure jump and its sensitivity to $\\gamma$.\n\nStarting strictly from the steady one-dimensional conservation laws of mass, momentum, and energy across the shock, together with the ideal-gas equation of state and the calorically perfect gas relation for specific enthalpy, derive an explicit expression for the pressure ratio $p_2/p_1$ across the shock as a function of $\\gamma$ and $M_1$, assuming $M_1>1$. Then, treating $M_1$ as fixed, compute the logarithmic sensitivity\n$$\nS \\equiv \\frac{\\partial \\ln\\!\\left(p_2/p_1\\right)}{\\partial \\ln \\gamma}\n$$\nevaluated at $M_1=2.5$ and $\\gamma=1.4$.\n\nExpress the final value of $S$ as a dimensionless number and round your answer to four significant figures.", "solution": "The problem requires the derivation of the pressure ratio across a steady, one-dimensional normal shock wave in a calorically perfect gas, followed by the calculation of the logarithmic sensitivity of this ratio with respect to the specific heat ratio, $\\gamma$.\n\nThe analysis begins with the fundamental conservation laws for a control volume enclosing the shock wave. Subscripts $1$ and $2$ denote the uniform states upstream and downstream of the shock, respectively.\n\nThe conservation of mass is given by:\n$$\n\\rho_1 u_1 = \\rho_2 u_2\n$$\n\nThe conservation of momentum is:\n$$\np_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2\n$$\n\nThe conservation of energy is:\n$$\nh_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2\n$$\nwhere $h$ is the specific enthalpy.\n\nThese are supplemented by the ideal-gas equation of state:\n$$\np = \\rho R T\n$$\nand the relation for the specific enthalpy of a calorically perfect gas:\n$$\nh = c_p T = \\frac{\\gamma R}{\\gamma-1} T\n$$\nThe speed of sound, $a$, is given by $a^2 = \\gamma R T$, and the Mach number is $M = u/a$.\n\nFirst, we derive the expression for the pressure ratio $p_2/p_1$. Rearranging the momentum equation gives:\n$$\np_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2\n$$\nUsing the mass conservation relation $u_2 = (\\rho_1/\\rho_2)u_1$, we can write:\n$$\np_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 \\left(\\frac{\\rho_1 u_1}{\\rho_2}\\right)^2 = \\rho_1 u_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\n$$\nDividing by $p_1$ and using the relations $u_1^2 = M_1^2 a_1^2$ and $a_1^2 = \\gamma p_1/\\rho_1$, we find:\n$$\n\\frac{p_2}{p_1} - 1 = \\frac{\\rho_1 u_1^2}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = \\frac{\\rho_1 (M_1^2 a_1^2)}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = \\frac{\\rho_1 M_1^2 (\\gamma p_1/\\rho_1)}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\n$$\nThis simplifies to:\n$$\n\\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\n$$\nThis is an intermediate result known as the Rankine-Hugoniot relation. To proceed, we need an expression for the density ratio. By combining all three conservation laws, one can derive the following relation between pressure and density across the shock for a calorically perfect gas:\n$$\n\\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)}{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)}\n$$\nSubstituting $\\rho_1/\\rho_2$ from this into the previous equation for $p_2/p_1$:\n$$\n\\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)}{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)}\\right)\n$$\nLet $P = p_2/p_1$.\n$$\nP - 1 = \\gamma M_1^2 \\left( \\frac{[(\\gamma+1)P + (\\gamma-1)] - [(\\gamma-1)P + (\\gamma+1)]}{(\\gamma+1)P + (\\gamma-1)} \\right)\n$$\n$$\nP - 1 = \\gamma M_1^2 \\left( \\frac{2P - 2}{(\\gamma+1)P + (\\gamma-1)} \\right) = 2 \\gamma M_1^2 \\frac{P - 1}{(\\gamma+1)P + (\\gamma-1)}\n$$\nFor a shock wave, $M_1>1$, which implies $p_2>p_1$ and thus $P \\neq 1$. We can divide both sides by $P-1$:\n$$\n1 = \\frac{2 \\gamma M_1^2}{(\\gamma+1)P + (\\gamma-1)}\n$$\nSolving for $P$:\n$$\n(\\gamma+1)P + (\\gamma-1) = 2 \\gamma M_1^2\n$$\n$$\n(\\gamma+1)P = 2 \\gamma M_1^2 - (\\gamma-1)\n$$\n$$\n\\frac{p_2}{p_1} = \\frac{2 \\gamma M_1^2 - (\\gamma-1)}{\\gamma+1}\n$$\nThis is the required expression for the pressure ratio.\n\nNext, we compute the logarithmic sensitivity, $S$, defined as:\n$$\nS \\equiv \\frac{\\partial \\ln(p_2/p_1)}{\\partial \\ln \\gamma}\n$$\nUsing the chain rule for derivatives, this can be expressed as:\n$$\nS = \\gamma \\frac{\\partial}{\\partial \\gamma} \\left( \\ln\\left(\\frac{p_2}{p_1}\\right) \\right)\n$$\nLet $F(\\gamma, M_1) = p_2/p_1$.\n$$\n\\ln F = \\ln(2 \\gamma M_1^2 - \\gamma + 1) - \\ln(\\gamma+1)\n$$\nDifferentiating with respect to $\\gamma$ while holding $M_1$ constant:\n$$\n\\frac{\\partial (\\ln F)}{\\partial \\gamma} = \\frac{1}{2 \\gamma M_1^2 - \\gamma + 1} \\frac{\\partial}{\\partial \\gamma}(2 \\gamma M_1^2 - \\gamma + 1) - \\frac{1}{\\gamma+1} \\frac{\\partial}{\\partial \\gamma}(\\gamma+1)\n$$\n$$\n\\frac{\\partial (\\ln F)}{\\partial \\gamma} = \\frac{2 M_1^2 - 1}{2 \\gamma M_1^2 - \\gamma + 1} - \\frac{1}{\\gamma+1}\n$$\nPutting this over a common denominator:\n$$\n\\frac{\\partial (\\ln F)}{\\partial \\gamma} = \\frac{(2 M_1^2 - 1)(\\gamma+1) - (2 \\gamma M_1^2 - \\gamma + 1)}{(2 \\gamma M_1^2 - \\gamma + 1)(\\gamma+1)}\n$$\nExpanding the numerator:\n$$\n(2 M_1^2 \\gamma + 2 M_1^2 - \\gamma - 1) - (2 \\gamma M_1^2 - \\gamma + 1) = 2 M_1^2 \\gamma + 2 M_1^2 - \\gamma - 1 - 2 \\gamma M_1^2 + \\gamma - 1 = 2 M_1^2 - 2 = 2(M_1^2 - 1)\n$$\nSo the derivative is:\n$$\n\\frac{\\partial (\\ln F)}{\\partial \\gamma} = \\frac{2(M_1^2 - 1)}{(2 \\gamma M_1^2 - \\gamma + 1)(\\gamma+1)}\n$$\nThe sensitivity $S$ is $\\gamma$ times this expression:\n$$\nS = \\frac{2\\gamma(M_1^2 - 1)}{(2 \\gamma M_1^2 - \\gamma + 1)(\\gamma+1)}\n$$\nFinally, we evaluate $S$ for the given values $M_1=2.5$ and $\\gamma=1.4$.\nFirst, we compute the necessary terms:\n$$\nM_1 = 2.5 \\implies M_1^2 = 6.25\n$$\n$$\nM_1^2 - 1 = 5.25\n$$\n$$\n\\gamma = 1.4\n$$\n$$\n\\gamma+1 = 2.4\n$$\n$$\n\\gamma-1 = 0.4\n$$\nNow, substitute these into the expression for $S$.\nThe numerator is:\n$$\n2\\gamma(M_1^2 - 1) = 2 \\times 1.4 \\times 5.25 = 2.8 \\times 5.25 = 14.7\n$$\nThe denominator is:\n$$\n(2 \\gamma M_1^2 - (\\gamma - 1))(\\gamma+1) = ( (2 \\times 1.4 \\times 6.25) - (0.4) ) \\times (2.4)\n$$\n$$\n= ( (2.8 \\times 6.25) - 0.4 ) \\times 2.4\n$$\n$$\n= (17.5 - 0.4) \\times 2.4\n$$\n$$\n= 17.1 \\times 2.4 = 41.04\n$$\nThe sensitivity is the ratio of the numerator to the denominator:\n$$\nS = \\frac{14.7}{41.04} \\approx 0.35818713...\n$$\nRounding to four significant figures, the result is $0.3582$.", "answer": "$$\n\\boxed{0.3582}\n$$", "id": "3351075"}]}