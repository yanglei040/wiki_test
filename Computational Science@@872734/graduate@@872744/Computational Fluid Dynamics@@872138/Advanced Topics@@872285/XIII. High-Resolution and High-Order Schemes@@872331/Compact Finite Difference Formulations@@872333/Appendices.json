{"hands_on_practices": [{"introduction": "The first step in mastering any numerical method is to understand its construction. This practice guides you through the fundamental process of deriving the coefficients for a compact finite difference scheme from scratch. By matching terms in Taylor series expansions, you will see how these formulations are engineered to achieve a higher order of accuracy than their explicit counterparts, providing a solid foundation for the more advanced topics to follow [@problem_id:3302438].", "problem": "Consider a smooth function $u(x)$ sampled on a uniform grid $x_i = x_0 + i \\,\\Delta x$ with spacing $\\Delta x > 0$. In the context of spatial discretization for Computational Fluid Dynamics (CFD), a compact finite difference formulation approximates derivatives by implicitly coupling neighboring derivative values. You are asked to derive a fourth-order accurate compact relation for the second derivative $u_{xx}$ at grid point $i$ of the form\n$$\n\\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1}\n=\na \\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}\n+\nb \\,\\frac{u_{i+2} - 2 u_i + u_{i-2}}{4\\,\\Delta x^2},\n$$\nwhere $u_i \\equiv u(x_i)$ and $u''_i \\equiv u_{xx}(x_i)$, and $\\alpha$, $a$, $b$ are real constants independent of $i$ and $\\Delta x$. Starting from Taylor series expansions about $x_i$ and the definition of consistency, determine the values of $\\alpha$, $a$, and $b$ such that the truncation error is $\\mathcal{O}(\\Delta x^4)$ as $\\Delta x \\to 0$. Among all coefficient triples $(\\alpha,a,b)$ satisfying fourth-order accuracy, impose the additional design choice that the right-hand-side stencil is as narrow as possible by taking $b=0$. Your final answer must be the ordered triple $(\\alpha, a, b)$ expressed exactly as rational numbers. No rounding is required and no units are needed.", "solution": "The problem requires the derivation of the coefficients $\\alpha$, $a$, and $b$ for a compact finite difference scheme for the second derivative $u_{xx}$, given by the relation:\n$$\n\\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1}\n=\na \\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}\n+\nb \\,\\frac{u_{i+2} - 2 u_i + u_{i-2}}{4\\,\\Delta x^2}\n$$\nThe scheme must have a truncation error of $\\mathcal{O}(\\Delta x^4)$, and we are to select the specific scheme for which $b=0$. The derivation proceeds by performing Taylor series expansions of each term about the grid point $x_i$. For convenience, we let $h = \\Delta x$ and use the notation $u^{(n)}$ to denote the $n$-th derivative of $u(x)$ evaluated at $x_i$.\n\nThe Taylor series expansions for the function values $u_{i \\pm k}$ are:\n$$ u_{i \\pm k} = u(x_i \\pm k h) = u_i \\pm (kh) u^{(1)} + \\frac{(kh)^2}{2!} u^{(2)} \\pm \\frac{(kh)^3}{3!} u^{(3)} + \\frac{(kh)^4}{4!} u^{(4)} \\pm \\frac{(kh)^5}{5!} u^{(5)} + \\frac{(kh)^6}{6!} u^{(6)} + \\mathcal{O}(h^7) $$\nThe Taylor series expansions for the second derivative values $u''_{i \\pm 1}$ are:\n$$ u''_{i \\pm 1} = u^{(2)}(x_i \\pm h) = u^{(2)} \\pm h u^{(3)} + \\frac{h^2}{2!} u^{(4)} \\pm \\frac{h^3}{3!} u^{(5)} + \\frac{h^4}{4!} u^{(6)} \\pm \\frac{h^5}{5!} u^{(7)} + \\mathcal{O}(h^6) $$\n\nFirst, we expand the left-hand side (LHS) of the given relation:\n$$ \\text{LHS} = \\alpha (u''_{i-1} + u''_{i+1}) + u''_i $$\nUsing the expansion for $u''_{i \\pm 1}$:\n$$ u''_{i-1} + u''_{i+1} = \\left(u^{(2)} - h u^{(3)} + \\frac{h^2}{2} u^{(4)} - \\frac{h^3}{6} u^{(5)} + \\frac{h^4}{24} u^{(6)}\\right) + \\left(u^{(2)} + h u^{(3)} + \\frac{h^2}{2} u^{(4)} + \\frac{h^3}{6} u^{(5)} + \\frac{h^4}{24} u^{(6)}\\right) + \\mathcal{O}(h^6) $$\n$$ u''_{i-1} + u''_{i+1} = 2u^{(2)} + h^2 u^{(4)} + \\frac{h^4}{12} u^{(6)} + \\mathcal{O}(h^6) $$\nSubstituting this back into the LHS expression:\n$$ \\text{LHS} = \\alpha \\left(2u^{(2)} + h^2 u^{(4)} + \\frac{h^4}{12} u^{(6)} \\right) + u^{(2)} + \\mathcal{O}(h^6) $$\n$$ \\text{LHS} = (1 + 2\\alpha) u^{(2)} + \\alpha h^2 u^{(4)} + \\frac{\\alpha h^4}{12} u^{(6)} + \\mathcal{O}(h^6) $$\n\nNext, we expand the right-hand side (RHS) of the relation. We analyze the two finite difference terms separately.\nFor the first term, involving points $i-1, i, i+1$:\n$$ u_{i+1} - 2u_i + u_{i-1} = \\left(u_i + h u^{(1)} + \\frac{h^2}{2} u^{(2)} + \\frac{h^3}{6} u^{(3)} + \\dots\\right) - 2u_i + \\left(u_i - h u^{(1)} + \\frac{h^2}{2} u^{(2)} - \\frac{h^3}{6} u^{(3)} + \\dots\\right) $$\nBy collecting terms with even powers of $h$, we get:\n$$ u_{i+1} - 2u_i + u_{i-1} = h^2 u^{(2)} + \\frac{h^4}{12} u^{(4)} + \\frac{h^6}{360} u^{(6)} + \\mathcal{O}(h^8) $$\nSo the first term on the RHS is:\n$$ a \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} = a \\left( u^{(2)} + \\frac{h^2}{12} u^{(4)} + \\frac{h^4}{360} u^{(6)} \\right) + \\mathcal{O}(h^6) $$\nFor the second term, involving points $i-2, i, i+2$, we replace $h$ with $2h$ in the above central difference formula:\n$$ u_{i+2} - 2u_i + u_{i-2} = (2h)^2 u^{(2)} + \\frac{(2h)^4}{12} u^{(4)} + \\frac{(2h)^6}{360} u^{(6)} + \\mathcal{O}(h^8) $$\n$$ u_{i+2} - 2u_i + u_{i-2} = 4h^2 u^{(2)} + \\frac{4h^4}{3} u^{(4)} + \\frac{8h^6}{45} u^{(6)} + \\mathcal{O}(h^8) $$\nSo the second term on the RHS is:\n$$ b \\frac{u_{i+2} - 2u_i + u_{i-2}}{4h^2} = b \\left( u^{(2)} + \\frac{h^2}{3} u^{(4)} + \\frac{2h^4}{45} u^{(6)} \\right) + \\mathcal{O}(h^6) $$\nCombining the two terms to form the full RHS:\n$$ \\text{RHS} = (a+b) u^{(2)} + \\left(\\frac{a}{12} + \\frac{b}{3}\\right) h^2 u^{(4)} + \\left(\\frac{a}{360} + \\frac{2b}{45}\\right) h^4 u^{(6)} + \\mathcal{O}(h^6) $$\n\nFor a fourth-order accurate scheme, the Taylor series expansions of the LHS and RHS must match for the terms up to and including $u^{(4)}$. This means the truncation error, defined as $\\text{LHS} - \\text{RHS}$, must be $\\mathcal{O}(h^4)$. By equating the coefficients of the corresponding derivative terms on the LHS and RHS, we obtain a system of linear equations for the coefficients $\\alpha$, $a$, and $b$.\n\nMatching the coefficient of $u^{(2)}$:\n$$ 1 + 2\\alpha = a + b \\quad (1) $$\nThis condition ensures the scheme is consistent for the second derivative.\n\nMatching the coefficient of $h^2 u^{(4)}$:\n$$ \\alpha = \\frac{a}{12} + \\frac{b}{3} \\quad (2) $$\nSatisfying this condition eliminates the $\\mathcal{O}(h^2)$ error term, elevating the scheme's accuracy to at least fourth order.\n\nThe problem imposes the design choice that the RHS stencil be as narrow as possible, which is achieved by setting $b=0$. Substituting $b=0$ into equations $(1)$ and $(2)$:\n$$ 1 + 2\\alpha = a \\quad (1') $$\n$$ \\alpha = \\frac{a}{12} \\quad (2') $$\nThis is a system of two equations for the two unknowns $\\alpha$ and $a$. We can solve this system by substituting the expression for $a$ from $(1')$ into $(2')$:\n$$ \\alpha = \\frac{1 + 2\\alpha}{12} $$\nMultiplying by $12$:\n$$ 12\\alpha = 1 + 2\\alpha $$\n$$ 10\\alpha = 1 $$\n$$ \\alpha = \\frac{1}{10} $$\nNow we find $a$ using equation $(1')$:\n$$ a = 1 + 2\\alpha = 1 + 2\\left(\\frac{1}{10}\\right) = 1 + \\frac{1}{5} = \\frac{6}{5} $$\nThus, the coefficients are $\\alpha = \\frac{1}{10}$, $a = \\frac{6}{5}$, and $b=0$.\n\nTo confirm the order of accuracy, we examine the leading error term, which is the coefficient of $h^4 u^{(6)}$ in the truncation error $\\text{LHS} - \\text{RHS}$:\n$$ C = \\left(\\frac{\\alpha}{12}\\right) - \\left(\\frac{a}{360} + \\frac{2b}{45}\\right) $$\nSubstituting the derived coefficient values:\n$$ C = \\frac{1/10}{12} - \\left(\\frac{6/5}{360} + 0\\right) = \\frac{1}{120} - \\frac{6}{1800} = \\frac{1}{120} - \\frac{1}{300} $$\n$$ C = \\frac{5}{600} - \\frac{2}{600} = \\frac{3}{600} = \\frac{1}{200} $$\nSince this coefficient is non-zero, the leading term of the truncation error is $\\frac{1}{200} u^{(6)} \\Delta x^4$, and the scheme is indeed fourth-order accurate, i.e., the truncation error is $\\mathcal{O}(\\Delta x^4)$.\n\nThe final ordered triple $(\\alpha, a, b)$ is $(\\frac{1}{10}, \\frac{6}{5}, 0)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{10} & \\frac{6}{5} & 0\n\\end{pmatrix}\n}\n$$", "id": "3302438"}, {"introduction": "Having learned how to construct a compact scheme, it is natural to ask about their limitations. Can we achieve arbitrarily high accuracy simply by adding more terms? This exercise challenges you to think about the theoretical constraints governing the order of a compact scheme, connecting the number of tunable coefficients to the number of error terms that can be eliminated [@problem_id:3302468]. Understanding this limit is crucial for making informed decisions when designing numerical methods.", "problem": "Consider a uniform grid with spacing $h$ on a smooth one-dimensional field $u(x)$, as encountered in Computational Fluid Dynamics (CFD). A family of tridiagonal compact finite difference schemes for the first derivative at interior nodes $x_i$ is defined by coupling three unknown derivative values on the left-hand side to a fixed-width right-hand side stencil of function values:\n$$\n\\alpha\\,u'_{i-1} + u'_i + \\alpha\\,u'_{i+1} \\;=\\; \\frac{1}{h}\\sum_{k=-R}^{R} \\beta_k\\,u_{i+k},\n$$\nwhere $R$ is a fixed positive integer, $\\alpha$ and $\\{\\beta_k\\}_{k=-R}^{R}$ are constant coefficients independent of $i$ and $h$, and $u'_i$ denotes the exact derivative $u^{(1)}(x_i)$. Assume interior points away from boundaries, a smooth $u(x)$, and a central scheme with odd symmetry on the right-hand side for a first derivative (that is, $\\beta_{-k}=-\\beta_k$ and $\\beta_0=0$), intended to avoid spurious even-order contamination.\n\nUsing the definition of local truncation error as the difference between the discrete operator and the exact derivative when applied to a smooth function, and Taylor series expansions about $x_i$,\n$$\nu_{i+k} \\;=\\; \\sum_{m=0}^{\\infty} \\frac{u^{(m)}(x_i)}{m!}(kh)^m,\\quad\nu'_{i\\pm1} \\;=\\; \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}(x_i)}{m!}(\\pm h)^m,\n$$\nargue whether, for fixed right-hand side stencil half-width $R$, arbitrarily high formal order $p$ can be achieved by tuning the coefficients $(\\alpha,\\{\\beta_k\\})$ in this tridiagonal compact scheme. Identify the limiting constraints that determine the maximum achievable order in terms of $R$, and explain their origin based on the Taylor-series moment-matching requirements, consistency, and symmetry for first-derivative approximations.\n\nChoose the single best option:\n\nA. Arbitrarily high formal order $p$ is achievable for any fixed $R$ by optimizing $\\alpha$ alone; the right-hand side width does not limit order on a uniform grid.\n\nB. For fixed $R$, arbitrarily high order cannot be achieved. The maximum formal order satisfies $p \\le 2R+2$. The limiting constraints arise from Taylor-series moment matching with a finite number of free coefficients, the consistency condition $\\sum_{k=-R}^{R}\\beta_k=0$ to eliminate the $h^{-1}$ term, odd symmetry $\\beta_{-k}=-\\beta_k$ forcing vanishing even moments, and the requirement that a finite set of odd moments $\\mu_{2m+1}=\\sum_{k=-R}^{R}\\beta_k k^{2m+1}$ match a linear sequence determined by the tridiagonal left-hand side.\n\nC. Arbitrarily high order is achievable at fixed $R$ if periodic boundary conditions are imposed, because discrete Fourier analysis implies exponential accuracy independent of stencil width.\n\nD. The order is limited to $p \\le R+1$ solely by the number of right-hand side coefficients; left-hand side coefficients do not participate in the order conditions for a tridiagonal compact scheme.\n\nE. Arbitrarily high order requires violating consistency; setting $\\sum_{k=-R}^{R}\\beta_k\\neq 0$ cancels the leading error, allowing unbounded order even for fixed $R$.", "solution": "The user has requested a critical validation of the problem statement, followed by a full derivation and evaluation of the provided options.\n\n### Step 1: Extract Givens\n\n-   **Scheme Definition:** A tridiagonal compact finite difference scheme is given by the relation:\n    $$\n    \\alpha\\,u'_{i-1} + u'_i + \\alpha\\,u'_{i+1} \\;=\\; \\frac{1}{h}\\sum_{k=-R}^{R} \\beta_k\\,u_{i+k}\n    $$\n-   **Grid and Field:** The scheme is applied to a smooth one-dimensional field $u(x)$ on a uniform grid with spacing $h$. The analysis is for interior nodes $x_i$.\n-   **Coefficients:** $\\alpha$ and $\\{\\beta_k\\}_{k=-R}^{R}$ are constants. $R$ is a fixed positive integer.\n-   **Symmetry:** The scheme is central with odd symmetry on the right-hand side, implying $\\beta_{-k}=-\\beta_k$ and $\\beta_0=0$.\n-   **Notation:** $u'_i$ denotes the exact first derivative $u^{(1)}(x_i)$.\n-   **Taylor Series:** The problem provides the standard Taylor series expansions for $u_{i+k}$ and $u'_{i\\pm1}$ about the point $x_i$.\n    $$\n    u_{i+k} \\;=\\; \\sum_{m=0}^{\\infty} \\frac{u^{(m)}(x_i)}{m!}(kh)^m\n    $$\n    $$\n    u'_{i\\pm1} \\;=\\; \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}(x_i)}{m!}(\\pm h)^m\n    $$\n-   **Objective:** Determine if arbitrarily high formal order $p$ can be achieved for a fixed $R$ by tuning the coefficients. Identify the limiting constraints.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding:** The problem is firmly grounded in standard numerical analysis for partial differential equations, specifically in the derivation and analysis of finite difference schemes. The use of Taylor series to determine the local truncation error and, hence, the order of accuracy is a cornerstone of this field. All terms and concepts are standard. The problem is scientifically sound.\n-   **Well-Posedness:** The question is well-posed. It asks for a determination of the maximum achievable order of a specific family of schemes as a function of the stencil width, which is a standard and solvable problem in numerical analysis. The provided information is sufficient to derive a unique conclusion.\n-   **Objectivity:** The problem is stated in precise, objective, and mathematical language. There are no subjective or ambiguous statements.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. It is a standard, well-posed problem in numerical analysis. The solution process will now proceed.\n\n### Derivation\n\nThe formal order of accuracy is determined by analyzing the local truncation error, which is found by substituting the exact solution $u(x)$ into the finite difference formula and expanding all terms in a Taylor series around the point $x_i$. The order $p$ is the lowest power of $h$ in the residual.\n\nLet's expand the left-hand side (LHS) and right-hand side (RHS) of the given scheme.\n\n**Left-Hand Side (LHS) Expansion:**\nThe LHS is $\\alpha\\,u'_{i-1} + u'_i + \\alpha\\,u'_{i+1}$. We expand $u'_{i-1}$ and $u'_{i+1}$ around $x_i$.\n$$\nu'_{i-1} = u'_i - h u''_i + \\frac{h^2}{2!} u'''_i - \\frac{h^3}{3!} u^{(4)}_i + \\dots = \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}_i}{m!} (-h)^m\n$$\n$$\nu'_{i+1} = u'_i + h u''_i + \\frac{h^2}{2!} u'''_i + \\frac{h^3}{3!} u^{(4)}_i + \\dots = \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}_i}{m!} (h)^m\n$$\nSubstituting these into the LHS expression:\n$$\n\\text{LHS} = \\alpha \\left( \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}_i}{m!} (-h)^m \\right) + u'_i + \\alpha \\left( \\sum_{m=0}^{\\infty} \\frac{u^{(m+1)}_i}{m!} (h)^m \\right)\n$$\n$$\n\\text{LHS} = u'_i + \\sum_{m=0}^{\\infty} \\alpha \\frac{u^{(m+1)}_i}{m!} h^m ((-1)^m + 1)\n$$\nThe term $((-1)^m + 1)$ is $2$ if $m$ is even and $0$ if $m$ is odd. The sum is over $m=0, 2, 4, \\dots$. Let $m=2j$.\n$$\n\\text{LHS} = u'_i + \\sum_{j=0}^{\\infty} \\alpha \\frac{u^{(2j+1)}_i}{(2j)!} h^{2j} (2) = u'_i + 2\\alpha u'_i + 2\\alpha \\sum_{j=1}^{\\infty} \\frac{h^{2j}}{(2j)!} u^{(2j+1)}_i\n$$\n$$\n\\text{LHS} = (1+2\\alpha)u'_i + 2\\alpha \\left( \\frac{h^2}{2!}u'''_i + \\frac{h^4}{4!}u^{(5)}_i + \\frac{h^6}{6!}u^{(7)}_i + \\dots \\right)\n$$\n\n**Right-Hand Side (RHS) Expansion:**\nThe RHS is $\\frac{1}{h}\\sum_{k=-R}^{R} \\beta_k\\,u_{i+k}$. We substitute the Taylor expansion for $u_{i+k}$:\n$$\n\\text{RHS} = \\frac{1}{h} \\sum_{k=-R}^{R} \\beta_k \\left( \\sum_{m=0}^{\\infty} \\frac{u^{(m)}_i}{m!} (kh)^m \\right)\n$$\nSwapping the order of summation and defining the moments $\\mu_m = \\sum_{k=-R}^{R} \\beta_k k^m$:\n$$\n\\text{RHS} = \\frac{1}{h} \\sum_{m=0}^{\\infty} \\frac{u^{(m)}_i h^m}{m!} \\left( \\sum_{k=-R}^{R} \\beta_k k^m \\right) = \\sum_{m=0}^{\\infty} \\frac{\\mu_m}{m!} h^{m-1} u^{(m)}_i\n$$\nThe problem specifies odd symmetry, $\\beta_{-k} = -\\beta_k$, and $\\beta_0=0$. This has important consequences for the moments $\\mu_m$:\n- For even powers $m=2j$:\n$$\n\\mu_{2j} = \\sum_{k=-R}^{R} \\beta_k k^{2j} = \\beta_0 \\cdot 0^{2j} + \\sum_{k=1}^{R} (\\beta_k k^{2j} + \\beta_{-k}(-k)^{2j}) = 0 + \\sum_{k=1}^{R} (\\beta_k k^{2j} - \\beta_k k^{2j}) = 0\n$$\nAll even moments are zero. This includes $\\mu_0 = \\sum \\beta_k = 0$, which is the zeroeth order consistency condition that prevents an $O(h^{-1})$ error.\n- For odd powers $m=2j+1$:\n$$\n\\mu_{2j+1} = \\sum_{k=1}^{R} (\\beta_k k^{2j+1} + \\beta_{-k}(-k)^{2j+1}) = \\sum_{k=1}^{R} (\\beta_k k^{2j+1} - \\beta_k (-1) k^{2j+1}) = 2\\sum_{k=1}^{R} \\beta_k k^{2j+1}\n$$\nThe RHS expansion simplifies to terms involving only odd derivatives:\n$$\n\\text{RHS} = \\frac{\\mu_1}{1!} u'_i + \\frac{\\mu_3}{3!} h^2 u'''_i + \\frac{\\mu_5}{5!} h^4 u^{(5)}_i + \\dots = \\sum_{j=0}^{\\infty} \\frac{\\mu_{2j+1}}{(2j+1)!} h^{2j} u^{(2j+1)}_i\n$$\n\n**Moment Matching for High Order:**\nTo achieve a high order of accuracy, the Taylor series expansions of the LHS and RHS must match term-by-term for as many powers of $h$ as possible.\nEquating coefficients of $h^{2j} u^{(2j+1)}_i$:\n- For $j=0$ (coefficient of $u'_i$):\n$$1+2\\alpha = \\mu_1$$\n- For $j \\geq 1$ (coefficients of $h^{2j} u^{(2j+1)}_i$):\n$$\\frac{2\\alpha}{(2j)!} = \\frac{\\mu_{2j+1}}{(2j+1)!} \\implies 2\\alpha(2j+1) = \\mu_{2j+1}$$\nSubstituting the expression for $\\mu_{2j+1}$:\n$$ \\alpha(2j+1) = \\sum_{k=1}^{R} \\beta_k k^{2j+1} $$\n\nTo achieve an order of accuracy $p=2N+2$, we must satisfy the matching conditions for $j=0, 1, \\dots, N$. This gives a system of $N+1$ linear equations:\n1.  ($j=0$): $1+2\\alpha = 2\\sum_{k=1}^{R} \\beta_k k$\n2.  ($j=1$): $3\\alpha = \\sum_{k=1}^{R} \\beta_k k^3$\n3.  ($j=2$): $5\\alpha = \\sum_{k=1}^{R} \\beta_k k^5$\n   ...\n$(N+1)$. ($j=N$): $(2N+1)\\alpha = \\sum_{k=1}^{R} \\beta_k k^{2N+1}$\n\nThe unknowns we can tune are the coefficients $\\alpha, \\beta_1, \\beta_2, \\dots, \\beta_R$. This gives us a total of $R+1$ free parameters.\nA system of linear equations generally has a solution if the number of equations does not exceed the number of independent unknowns. Therefore, to be able to solve for the coefficients, we must have:\n$$\nN+1 \\le R+1 \\implies N \\le R\n$$\nThe maximum value we can choose is $N=R$. This allows us to satisfy the first $R+1$ moment-matching conditions (for $j=0, \\dots, R$).\nWith $N=R$, the lowest-order error term will be the first one we did not cancel, which corresponds to $j=R+1$. The residual of the Taylor series expansions will be:\n$$\n\\tau_i = \\left( \\frac{2\\alpha}{(2(R+1))!} - \\frac{\\mu_{2(R+1)+1}}{(2(R+1)+1)!} \\right) h^{2(R+1)} u^{(2(R+1)+1)}_i + \\text{h.o.t.}\n$$\n$$\n\\tau_i = O(h^{2R+2})\n$$\nThe order of the scheme is therefore $p=2R+2$.\n\nSince $R$ is a fixed positive integer, the maximum achievable order $p_{max}=2R+2$ is also fixed and finite. Arbitrarily high order cannot be achieved because there is a finite number of free parameters ($R+1$) available to satisfy an infinite number of potential moment-matching conditions.\n\n### Option-by-Option Analysis\n\n**A. Arbitrarily high formal order $p$ is achievable for any fixed $R$ by optimizing $\\alpha$ alone; the right-hand side width does not limit order on a uniform grid.**\nThis statement is incorrect. The derivation shows that the maximum order is limited to $p = 2R+2$. The number of available RHS coefficients, determined by $R$, in conjunction with $\\alpha$, fundamentally limits the number of error terms that can be cancelled. Optimizing $\\alpha$ alone is insufficient; it is only one of $R+1$ parameters used to satisfy the system of equations.\n**Verdict: Incorrect.**\n\n**B. For fixed $R$, arbitrarily high order cannot be achieved. The maximum formal order satisfies $p \\le 2R+2$. The limiting constraints arise from Taylor-series moment matching with a finite number of free coefficients, the consistency condition $\\sum_{k=-R}^{R}\\beta_k=0$ to eliminate the $h^{-1}$ term, odd symmetry $\\beta_{-k}=-\\beta_k$ forcing vanishing even moments, and the requirement that a finite set of odd moments $\\mu_{2m+1}=\\sum_{k=-R}^{R}\\beta_k k^{2m+1}$ match a linear sequence determined by the tridiagonal left-hand side.**\nThis statement is a comprehensive and accurate summary of the derivation.\n- It correctly states that arbitrarily high order is not achievable.\n- It correctly identifies the maximum order as $p \\le 2R+2$ (our derivation showed $p_{max}=2R+2$).\n- It correctly identifies the limitation as a finite number of coefficients available for moment-matching.\n- It correctly states that the condition $\\sum\\beta_k=0$ (which I showed is $\\mu_0=0$) is a consequence of the odd symmetry and eliminates the $O(h^{-1})$ error.\n- It correctly notes that odd symmetry forces even moments to vanish, which eliminates error terms proportional to derivatives of even order.\n- It correctly states that the odd moments $\\mu_{2m+1}$ must satisfy a set of relations determined by the LHS (specifically, by the parameter $\\alpha$).\n**Verdict: Correct.**\n\n**C. Arbitrarily high order is achievable at fixed $R$ if periodic boundary conditions are imposed, because discrete Fourier analysis implies exponential accuracy independent of stencil width.**\nThis statement is incorrect. It confuses finite difference methods with pseudospectral methods. The formal order of a finite difference scheme is a local property determined by Taylor series analysis at an interior point. It is independent of the boundary conditions. While pseudospectral methods can achieve very high (so-called \"infinite\" or exponential) order for smooth, periodic functions, the scheme in question is a local, finite difference operator, whose order is algebraically limited by its stencil width.\n**Verdict: Incorrect.**\n\n**D. The order is limited to $p \\le R+1$ solely by the number of right-hand side coefficients; left-hand side coefficients do not participate in the order conditions for a tridiagonal compact scheme.**\nThis statement is incorrect for two reasons. First, the derived maximum order is $p=2R+2$, not $R+1$. The doubling effect comes from the odd symmetry which automatically eliminates half of the error terms. Second, the LHS coefficient $\\alpha$ is a crucial free parameter that actively participates in the system of moment-matching equations. It is not a passive bystander.\n**Verdict: Incorrect.**\n\n**E. Arbitrarily high order requires violating consistency; setting $\\sum_{k=-R}^{R}\\beta_k\\neq 0$ cancels the leading error, allowing unbounded order even for fixed $R$.**\nThis statement is fundamentally incorrect. The condition $\\sum \\beta_k = 0$ (i.e., $\\mu_0=0$) ensures the scheme is consistent by eliminating an error term of order $O(h^{-1})$. Violating this condition would make the truncation error diverge as $h \\to 0$, rendering the method useless. It is a prerequisite for any meaningful notion of accuracy, not an obstacle to it.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "3302468"}, {"introduction": "A spatial discretization scheme is rarely used in isolation; it must be coupled with a time integration method. The stability of this combined scheme is paramount for any successful simulation of time-dependent problems like fluid flow. This practice provides hands-on experience with von Neumann stability analysis, a cornerstone of CFD, allowing you to determine the maximum stable time step for a high-order compact scheme combined with a Runge-Kutta method [@problem_id:3302440]. You will connect the spectral properties of the spatial operator to the stability region of the time integrator, a critical skill for any computational scientist.", "problem": "Consider the one-dimensional linear advection equation $u_t + a u_x = 0$ on a uniform periodic grid with spacing $\\Delta x$ and $N$ points, where $a$ is a constant advection speed. The semi-discrete spatial derivative $u_x$ is approximated by a sixth-order tridiagonal compact finite difference (Padé) formulation. Define the Courant–Friedrichs–Lewy (CFL) number as $\\nu = a \\Delta t / \\Delta x$, where $\\Delta t$ is the time step, and the time integration uses the classical Runge–Kutta fourth-order method (RK4). Use von Neumann analysis to estimate the maximum stable CFL number $\\nu_{\\max}$ such that the fully discrete scheme remains linearly stable for all resolvable Fourier modes on the grid.\n\nStart from the linear advection equation and, for the compact scheme, assume the following implicit relation for the first derivative on a periodic grid:\n$$\n\\alpha f'_{j-1} + f'_j + \\alpha f'_{j+1} = \\frac{c_1}{2 \\Delta x}\\left(f_{j+1}-f_{j-1}\\right) + \\frac{c_2}{4 \\Delta x}\\left(f_{j+2}-f_{j-2}\\right),\n$$\nwith coefficients $\\alpha = 1/3$, $c_1 = 14/9$, and $c_2 = 1/9$. Under a Fourier mode ansatz $f_j = \\exp(i j \\theta)$, where $\\theta \\in [0,\\pi]$ is the discrete angular wavenumber in radians, the compact scheme implies a modified wavenumber $\\kappa(\\theta)$ defined by\n$$\n\\kappa(\\theta) = \\frac{c_1 \\sin(\\theta) + \\frac{c_2}{2} \\sin(2\\theta)}{1 + 2 \\alpha \\cos(\\theta)}.\n$$\nThe semi-discrete operator for the linear advection equation has eigenvalues $\\lambda(\\theta) = -i a \\kappa(\\theta)/\\Delta x$. The classical Runge–Kutta fourth-order method has the stability function\n$$\nR(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}.\n$$\nFor a given Fourier mode with $\\theta$, stability requires $\\lvert R(\\lambda(\\theta) \\Delta t) \\rvert \\le 1$. Therefore the largest stable CFL number is the maximum $\\nu$ such that $\\lvert R(-i \\nu \\kappa(\\theta)) \\rvert \\le 1$ for all resolvable wavenumbers $\\theta$ on the grid.\n\nYour task is to implement a program that:\n- Computes $s_{\\max} = \\sup\\left\\{ s \\ge 0 \\; \\middle| \\; \\lvert R(i s) \\rvert \\le 1 \\right\\}$ numerically for the RK4 stability function restricted to the imaginary axis.\n- For each specified grid size $N$, computes the set of resolvable discrete wavenumbers $\\theta_m = 2\\pi m/N$ for integers $m \\in \\{1,2,\\dots,\\lfloor N/2 \\rfloor\\}$ in radians, and then evaluates $\\kappa(\\theta_m)$ using the formula above.\n- Determines $\\kappa_{\\max}(N) = \\max_{m} \\lvert \\kappa(\\theta_m) \\rvert$.\n- Returns $\\nu_{\\max}(N) = s_{\\max} / \\kappa_{\\max}(N)$.\n\nDesign your algorithm from the base principles described and do not use any pre-tabulated stability bounds. You must express all angles in radians.\n\nTest suite:\n- Case $1$: $N = 8$.\n- Case $2$: $N = 16$.\n- Case $3$: $N = 64$.\n- Case $4$: $N = 512$.\n\nFor each case, produce the float value of $\\nu_{\\max}(N)$ rounded to ten decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite cases. For example, the output should be of the form $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$, where each $\\text{result}_k$ is a float rounded to ten decimal places.", "solution": "The problem requires the determination of the maximum stable Courant–Friedrichs–Lewy (CFL) number, denoted $\\nu_{\\max}$, for a fully discrete numerical scheme applied to the one-dimensional linear advection equation, $u_t + a u_x = 0$. The scheme combines a sixth-order compact finite difference method for spatial discretization and the classical fourth-order Runge-Kutta (RK4) method for time integration. The analysis will be performed using the von Neumann stability method.\n\nThe process involves three main steps:\n1.  Determining the stability region of the RK4 method on the imaginary axis.\n2.  Analyzing the spectral properties of the spatial discretization operator, specifically its modified wavenumber.\n3.  Combining these results to find the stability limit for the fully discrete scheme as a function of the grid size $N$.\n\nFirst, we analyze the temporal integration scheme. The stability of an explicit time-stepping method applied to the semi-discretized equation $\\frac{d\\hat{u}}{dt} = \\lambda \\hat{u}$ is governed by the stability function $R(z)$, where $z = \\lambda \\Delta t$. For the scheme to be stable, the amplification factor $G = R(z)$ must satisfy $|G| \\le 1$.\n\nThe spatial discretization using the specified sixth-order compact scheme on a periodic grid leads to a semi-discrete Fourier-space representation $\\frac{d\\hat{u}(\\theta)}{dt} = -i \\frac{a}{\\Delta x} \\kappa(\\theta) \\hat{u}(\\theta)$, where $\\hat{u}(\\theta)$ is the Fourier coefficient of the solution at wavenumber $\\theta$. Thus, the eigenvalues of the semi-discrete operator are purely imaginary: $\\lambda(\\theta) = -i \\frac{a \\kappa(\\theta)}{\\Delta x}$. The modified wavenumber $\\kappa(\\theta)$ is a real-valued function for real $\\theta$, given by:\n$$\n\\kappa(\\theta) = \\frac{c_1 \\sin(\\theta) + \\frac{c_2}{2} \\sin(2\\theta)}{1 + 2 \\alpha \\cos(\\theta)}\n$$\nwith the provided coefficients $\\alpha = 1/3$, $c_1 = 14/9$, and $c_2 = 1/9$.\n\nThe argument to the stability function is $z = \\lambda(\\theta) \\Delta t = -i \\frac{a \\kappa(\\theta)}{\\Delta x} \\Delta t$. Defining the CFL number as $\\nu = \\frac{a \\Delta t}{\\Delta x}$, this becomes $z = -i \\nu \\kappa(\\theta)$. The stability condition for each Fourier mode is $|R(-i \\nu \\kappa(\\theta))| \\le 1$.\n\nThe stability function for the RK4 method is given as:\n$$\nR(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}\n$$\nWe need to find the stability limit for purely imaginary arguments, $z = is$, where $s$ is a real number. Due to the property $R(\\bar{z}) = \\overline{R(z)}$ for a polynomial with real coefficients, $|R(-is)| = |R(is)|$, so we can analyze for $s \\ge 0$ without loss of generality.\nSubstituting $z=is$ into $R(z)$:\n$$\nR(is) = 1 + (is) + \\frac{(is)^2}{2} + \\frac{(is)^3}{6} + \\frac{(is)^4}{24} = 1 + is - \\frac{s^2}{2} - i\\frac{s^3}{6} + \\frac{s^4}{24}\n$$\nGrouping real and imaginary parts:\n$$\nR(is) = \\left(1 - \\frac{s^2}{2} + \\frac{s^4}{24}\\right) + i\\left(s - \\frac{s^3}{6}\\right)\n$$\nThe stability condition is $|R(is)|^2 \\le 1$:\n$$\n|R(is)|^2 = \\left(1 - \\frac{s^2}{2} + \\frac{s^4}{24}\\right)^2 + \\left(s - \\frac{s^3}{6}\\right)^2 \\le 1\n$$\nExpanding the terms:\n$$\n|R(is)|^2 = \\left(1 - s^2 + \\frac{s^4}{3} - \\frac{s^6}{24} + \\frac{s^8}{576}\\right) + \\left(s^2 - \\frac{s^4}{3} + \\frac{s^6}{36}\\right)\n$$\n$$\n|R(is)|^2 = 1 + \\left(-\\frac{1}{24} + \\frac{1}{36}\\right)s^6 + \\frac{s^8}{576} = 1 - \\frac{s^6}{72} + \\frac{s^8}{576}\n$$\nThe stability inequality becomes:\n$$\n1 - \\frac{s^6}{72} + \\frac{s^8}{576} \\le 1 \\implies \\frac{s^8}{576} - \\frac{s^6}{72} \\le 0\n$$\nFor $s > 0$, we can divide by $s^6$:\n$$\n\\frac{s^2}{576} - \\frac{1}{72} \\le 0 \\implies s^2 \\le \\frac{576}{72} = 8\n$$\nThis gives $s \\le \\sqrt{8} = 2\\sqrt{2}$. The supremum of $s \\ge 0$ for which the RK4 scheme is stable on the imaginary axis is therefore $s_{\\max} = 2\\sqrt{2}$.\n\nThe argument to the stability function is $z = -i\\nu\\kappa(\\theta)$. Its magnitude is $|z| = |\\nu\\kappa(\\theta)|$. For stability, this magnitude must be less than or equal to $s_{\\max}$ for all active Fourier modes on the grid.\n$$\n|\\nu \\kappa(\\theta_m)| \\le s_{\\max} \\quad \\text{for all } m\n$$\nwhere $\\theta_m = \\frac{2\\pi m}{N}$ for $m \\in \\{1, 2, \\dots, \\lfloor N/2 \\rfloor\\}$.\nSince $\\nu$ is a positive constant, this condition is equivalent to:\n$$\n\\nu \\cdot |\\kappa(\\theta_m)| \\le s_{\\max} \\implies \\nu \\le \\frac{s_{\\max}}{|\\kappa(\\theta_m)|}\n$$\nTo ensure stability for all modes simultaneously, $\\nu$ must be less than or equal to the minimum of these upper bounds over all $m$. This is determined by the mode that maximizes $|\\kappa(\\theta_m)|$:\n$$\n\\nu_{\\max}(N) = \\frac{s_{\\max}}{\\max_{m} |\\kappa(\\theta_m)|} = \\frac{s_{\\max}}{\\kappa_{\\max}(N)}\n$$\nwhere $\\kappa_{\\max}(N) = \\max_{m \\in \\{1, \\dots, \\lfloor N/2 \\rfloor\\}} |\\kappa(\\theta_m)|$.\n\nThe algorithm to solve the problem is as follows:\n1.  Calculate the RK4 imaginary stability boundary, $s_{\\max} = 2\\sqrt{2}$.\n2.  Define the function for the modified wavenumber $\\kappa(\\theta)$ using the given coefficients $\\alpha$, $c_1$, and $c_2$.\n3.  For each grid size $N$ provided in the test suite:\n    a. Generate the discrete set of wavenumbers $\\theta_m = \\frac{2\\pi m}{N}$ for $m$ from $1$ to $\\lfloor N/2 \\rfloor$.\n    b. Evaluate $\\kappa(\\theta_m)$ for all these wavenumbers.\n    c. Find the maximum absolute value in this set, $\\kappa_{\\max}(N)$.\n    d. Compute the maximum stable CFL number $\\nu_{\\max}(N) = \\frac{s_{\\max}}{\\kappa_{\\max}(N)}$.\n    e. Round the result to ten decimal places.\n4.  Collect the results and format them as a comma-separated list.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum stable CFL number for a sixth-order compact finite\n    difference scheme with RK4 time integration for the 1D linear advection\n    equation on various grid sizes.\n    \"\"\"\n    \n    # Define the test cases for grid size N\n    test_cases = [8, 16, 64, 512]\n    \n    # Coefficients for the sixth-order compact finite difference scheme\n    alpha = 1.0 / 3.0\n    c1 = 14.0 / 9.0\n    c2 = 1.0 / 9.0\n    \n    # Maximum extent of the stability region of RK4 on the imaginary axis\n    s_max = 2.0 * np.sqrt(2.0)\n    \n    def kappa(theta):\n        \"\"\"\n        Calculates the modified wavenumber for the compact scheme.\n        \n        Args:\n            theta: The discrete angular wavenumber in radians.\n        \n        Returns:\n            The modified wavenumber.\n        \"\"\"\n        numerator = c1 * np.sin(theta) + (c2 / 2.0) * np.sin(2.0 * theta)\n        denominator = 1.0 + 2.0 * alpha * np.cos(theta)\n        return numerator / denominator\n\n    results = []\n    for N in test_cases:\n        # Generate the discrete wavenumbers theta_m for m = 1, 2, ..., floor(N/2)\n        # m must be integers, so we use arange.\n        m_values = np.arange(1, np.floor(N / 2) + 1)\n        theta_values = 2.0 * np.pi * m_values / N\n        \n        # Calculate the modified wavenumbers for all theta values\n        kappa_values = kappa(theta_values)\n        \n        # Find the maximum absolute modified wavenumber\n        kappa_max_N = np.max(np.abs(kappa_values))\n        \n        # Calculate the maximum stable CFL number\n        nu_max_N = s_max / kappa_max_N\n        \n        # Round the result to 10 decimal places and append\n        results.append(nu_max_N)\n        \n    # Format the results for output as specified: \"[res1,res2,res3,res4]\"\n    # using an f-string to handle rounding to 10 decimal places correctly.\n    formatted_results = [f\"{r:.10f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3302440"}]}