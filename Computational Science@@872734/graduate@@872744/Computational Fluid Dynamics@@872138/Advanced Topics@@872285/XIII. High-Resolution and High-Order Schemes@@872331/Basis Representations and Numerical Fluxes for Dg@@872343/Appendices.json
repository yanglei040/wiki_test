{"hands_on_practices": [{"introduction": "The foundation of the Discontinuous Galerkin (DG) method, like other finite element techniques, lies in projecting the governing differential equations onto a finite-dimensional polynomial space within each mesh element. This projection transforms the continuous problem into a system of algebraic equations involving elemental matrices. This practice provides essential experience in computing two fundamental operators: the mass matrix, which arises from the $L^2$ inner product of basis functions, and the stiffness matrix, from the inner product of their gradients. Mastering the assembly of these matrices using numerical quadrature is a cornerstone skill for implementing any DG scheme [@problem_id:3295180].", "problem": "Consider the one-dimensional reference element $[-1,1]$ used in the Discontinuous Galerkin (DG) method. Use the polynomial space $P^2$ spanned by the Legendre basis polynomials $\\{\\phi_0,\\phi_1,\\phi_2\\}=\\{P_0,P_1,P_2\\}$ with $P_0(x)=1$, $P_1(x)=x$, and $P_2(x)=\\tfrac{1}{2}(3x^2-1)$. Define the elemental mass matrix $M$ and the elemental $H^1$ stiffness matrix $K$ by\n$$\nM_{ij}=\\int_{-1}^1 \\phi_i(x)\\,\\phi_j(x)\\,dx, \\qquad K_{ij}=\\int_{-1}^1 \\phi_i'(x)\\,\\phi_j'(x)\\,dx,\n$$\nfor $i,j\\in\\{0,1,2\\}$. Evaluate all entries using the $N_q=3$ Gauss–Legendre quadrature rule on $[-1,1]$ and verify that the mass matrix is diagonal. Then, form the matrix $A=M^{-1}K$ and determine its spectral radius $\\rho(A)$ as an exact number. Provide the explicit entries of $M$ and $K$ in your working, but report only the single final value of $\\rho(A)$ as your final answer. No rounding is required.", "solution": "The problem requires the evaluation of the elemental mass matrix $M$ and stiffness matrix $K$ for a $P^2$ polynomial space on the reference element $[-1,1]$ using a $3$-point Gauss-Legendre quadrature rule. Subsequently, we are to form the matrix $A=M^{-1}K$ and find its spectral radius $\\rho(A)$.\n\nFirst, we list the given Legendre basis polynomials and their derivatives:\n- Basis functions ($\\phi_i(x)$):\n$$\n\\phi_0(x) = 1 \\\\\n\\phi_1(x) = x \\\\\n\\phi_2(x) = \\frac{1}{2}(3x^2 - 1)\n$$\n- Derivatives of basis functions ($\\phi_i'(x)$):\n$$\n\\phi_0'(x) = 0 \\\\\n\\phi_1'(x) = 1 \\\\\n\\phi_2'(x) = 3x\n$$\n\nThe matrices $M$ and $K$ are defined by the integrals $M_{ij}=\\int_{-1}^1 \\phi_i(x)\\,\\phi_j(x)\\,dx$ and $K_{ij}=\\int_{-1}^1 \\phi_i'(x)\\,\\phi_j'(x)\\,dx$. We must evaluate these integrals using the $N_q=3$ Gauss-Legendre quadrature rule, which approximates an integral as $\\int_{-1}^1 f(x) dx \\approx \\sum_{k=1}^{3} w_k f(x_k)$.\n\nFor $N_q=3$, the quadrature points $x_k$ are the roots of the Legendre polynomial $P_3(x)$, and the weights are $w_k$.\n- Quadrature points: $x_1 = -\\sqrt{\\frac{3}{5}}$, $x_2 = 0$, $x_3 = \\sqrt{\\frac{3}{5}}$.\n- Quadrature weights: $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, $w_3 = \\frac{5}{9}$.\n\nWe evaluate the basis functions and their derivatives at these quadrature points.\nValues of $\\phi_i(x_k)$:\n- $\\phi_0(x_k) = 1$ for $k \\in \\{1,2,3\\}$.\n- $\\phi_1(x_1) = -\\sqrt{\\frac{3}{5}}$, $\\phi_1(x_2) = 0$, $\\phi_1(x_3) = \\sqrt{\\frac{3}{5}}$.\n- $\\phi_2(x_1) = \\frac{1}{2}(3(-\\sqrt{\\frac{3}{5}})^2-1) = \\frac{1}{2}(3(\\frac{3}{5})-1) = \\frac{1}{2}(\\frac{9}{5}-1) = \\frac{2}{5}$.\n- $\\phi_2(x_2) = \\frac{1}{2}(3(0)^2-1) = -\\frac{1}{2}$.\n- $\\phi_2(x_3) = \\frac{1}{2}(3(\\sqrt{\\frac{3}{5}})^2-1) = \\frac{2}{5}$.\n\nValues of $\\phi_i'(x_k)$:\n- $\\phi_0'(x_k) = 0$ for $k \\in \\{1,2,3\\}$.\n- $\\phi_1'(x_k) = 1$ for $k \\in \\{1,2,3\\}$.\n- $\\phi_2'(x_1) = 3(-\\sqrt{\\frac{3}{5}}) = -3\\sqrt{\\frac{3}{5}}$.\n- $\\phi_2'(x_2) = 3(0) = 0$.\n- $\\phi_2'(x_3) = 3(\\sqrt{\\frac{3}{5}}) = 3\\sqrt{\\frac{3}{5}}$.\n\nNow, we compute the entries of the mass matrix $M$ using $M_{ij} = \\sum_{k=1}^{3} w_k \\phi_i(x_k) \\phi_j(x_k)$. Due to the orthogonality of Legendre polynomials and the fact that the $3$-point rule integrates polynomials of degree up to $2(3)-1=5$ exactly, we expect a diagonal matrix.\n- $M_{00} = \\sum_{k=1}^{3} w_k \\phi_0(x_k)^2 = (\\frac{5}{9})(1)^2 + (\\frac{8}{9})(1)^2 + (\\frac{5}{9})(1)^2 = \\frac{5+8+5}{9} = \\frac{18}{9} = 2$.\n- $M_{11} = \\sum_{k=1}^{3} w_k \\phi_1(x_k)^2 = (\\frac{5}{9})(-\\sqrt{\\frac{3}{5}})^2 + (\\frac{8}{9})(0)^2 + (\\frac{5}{9})(\\sqrt{\\frac{3}{5}})^2 = (\\frac{5}{9})(\\frac{3}{5}) + 0 + (\\frac{5}{9})(\\frac{3}{5}) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}$.\n- $M_{22} = \\sum_{k=1}^{3} w_k \\phi_2(x_k)^2 = (\\frac{5}{9})(\\frac{2}{5})^2 + (\\frac{8}{9})(-\\frac{1}{2})^2 + (\\frac{5}{9})(\\frac{2}{5})^2 = (\\frac{5}{9})(\\frac{4}{25}) + (\\frac{8}{9})(\\frac{1}{4}) + (\\frac{5}{9})(\\frac{4}{25}) = \\frac{4}{45} + \\frac{2}{9} + \\frac{4}{45} = \\frac{4+10+4}{45} = \\frac{18}{45} = \\frac{2}{5}$.\n- Off-diagonal terms $M_{ij}$ for $i \\ne j$:\n  - $M_{01} = \\sum_{k=1}^{3} w_k \\phi_0(x_k) \\phi_1(x_k) = (\\frac{5}{9})(1)(-\\sqrt{\\frac{3}{5}}) + (\\frac{8}{9})(1)(0) + (\\frac{5}{9})(1)(\\sqrt{\\frac{3}{5}}) = 0$.\n  - $M_{02} = \\sum_{k=1}^{3} w_k \\phi_0(x_k) \\phi_2(x_k) = (\\frac{5}{9})(1)(\\frac{2}{5}) + (\\frac{8}{9})(1)(-\\frac{1}{2}) + (\\frac{5}{9})(1)(\\frac{2}{5}) = \\frac{2}{9} - \\frac{4}{9} + \\frac{2}{9} = 0$.\n  - $M_{12} = \\sum_{k=1}^{3} w_k \\phi_1(x_k) \\phi_2(x_k) = (\\frac{5}{9})(-\\sqrt{\\frac{3}{5}})(\\frac{2}{5}) + (\\frac{8}{9})(0)(-\\frac{1}{2}) + (\\frac{5}{9})(\\sqrt{\\frac{3}{5}})(\\frac{2}{5}) = 0$.\nBy symmetry, $M_{ji} = M_{ij}$. Thus, the mass matrix is:\n$$\nM = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{2}{5} \\end{pmatrix}\n$$\nAs verified, the mass matrix $M$ is diagonal.\n\nNext, we compute the entries of the stiffness matrix $K$ using $K_{ij} = \\sum_{k=1}^{3} w_k \\phi_i'(x_k) \\phi_j'(x_k)$.\n- Since $\\phi_0'(x) = 0$, all entries in the first row and column are zero: $K_{0j} = K_{j0} = 0$.\n- $K_{11} = \\sum_{k=1}^{3} w_k \\phi_1'(x_k)^2 = (\\frac{5}{9})(1)^2 + (\\frac{8}{9})(1)^2 + (\\frac{5}{9})(1)^2 = \\frac{18}{9} = 2$.\n- $K_{22} = \\sum_{k=1}^{3} w_k \\phi_2'(x_k)^2 = (\\frac{5}{9})(-3\\sqrt{\\frac{3}{5}})^2 + (\\frac{8}{9})(0)^2 + (\\frac{5}{9})(3\\sqrt{\\frac{3}{5}})^2 = (\\frac{5}{9})(9 \\cdot \\frac{3}{5}) + 0 + (\\frac{5}{9})(9 \\cdot \\frac{3}{5}) = 3 + 3 = 6$.\n- $K_{12} = \\sum_{k=1}^{3} w_k \\phi_1'(x_k) \\phi_2'(x_k) = (\\frac{5}{9})(1)(-3\\sqrt{\\frac{3}{5}}) + (\\frac{8}{9})(1)(0) + (\\frac{5}{9})(1)(3\\sqrt{\\frac{3}{5}}) = 0$.\nBy symmetry, $K_{21} = K_{12} = 0$. The stiffness matrix is:\n$$\nK = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix}\n$$\n\nNow we form the matrix $A = M^{-1}K$. First, we find the inverse of the diagonal matrix $M$:\n$$\nM^{-1} = \\begin{pmatrix} 2^{-1} & 0 & 0 \\\\ 0 & (\\frac{2}{3})^{-1} & 0 \\\\ 0 & 0 & (\\frac{2}{5})^{-1} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{3}{2} & 0 \\\\ 0 & 0 & \\frac{5}{2} \\end{pmatrix}\n$$\nThen, we compute the product $A = M^{-1}K$:\n$$\nA = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{3}{2} & 0 \\\\ 0 & 0 & \\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\cdot 0 & 0 & 0 \\\\ 0 & \\frac{3}{2} \\cdot 2 & 0 \\\\ 0 & 0 & \\frac{5}{2} \\cdot 6 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 15 \\end{pmatrix}\n$$\nThe final step is to determine the spectral radius $\\rho(A)$. The eigenvalues of a diagonal matrix are its diagonal entries. The eigenvalues of $A$ are $\\lambda_1=0$, $\\lambda_2=3$, and $\\lambda_3=15$.\nThe spectral radius is the maximum of the absolute values of the eigenvalues:\n$$\n\\rho(A) = \\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|) = \\max(|0|, |3|, |15|) = 15\n$$\nThe spectral radius is an exact number as required.", "answer": "$$\\boxed{15}$$", "id": "3295180"}, {"introduction": "Within a DG framework, the approximate solution can be expressed in different but equivalent ways. A *modal* representation uses the coefficients of an orthogonal polynomial basis (like Legendre polynomials), while a *nodal* representation uses the solution's values at a specific set of points. This exercise explores the crucial link between these two viewpoints by constructing the transformation matrix, often called a Vandermonde or interpolation matrix, that maps modal coefficients to nodal values. Analyzing the properties of this matrix provides deep insight into the implementation details and numerical stability of high-order nodal DG schemes [@problem_id:3295158].", "problem": "Consider one spatial reference element $[-1,1]$ in a Discontinuous Galerkin (DG) discretization of a one-dimensional scalar conservation law. Let the modal basis on $[-1,1]$ be the first $k+1$ Legendre polynomials $\\{P_{0}(x),P_{1}(x),\\dots,P_{k}(x)\\}$, where $P_{m}(x)$ denotes the classical Legendre polynomial of degree $m$ on $[-1,1]$ (normalized such that $P_{0}(x)=1$, $P_{1}(x)=x$, and $P_{2}(x)=(3x^{2}-1)/2$). The nodal set is taken as the Gauss–Lobatto quadrature nodes on $[-1,1]$, defined by including the endpoints and the interior nodes given by the roots of $P_{k}'(x)$.\n\nWork with polynomial degree $k=2$, so that there are $(k+1)=3$ Gauss–Lobatto nodes. Starting from the definitions above, do the following:\n\n- Construct the Lagrange nodal basis $\\{\\ell_{i}(x)\\}_{i=1}^{3}$ associated with these $(k+1)$ nodes on $[-1,1]$, ensuring that $\\ell_{i}(x_{j})=\\delta_{ij}$.\n- Define and compute the interpolation matrix $V\\in\\mathbb{R}^{3\\times 3}$ whose $(i,j)$ entry is $V_{ij}=P_{j-1}(x_{i})$, mapping modal Legendre coefficients $(a_{0},a_{1},a_{2})$ to nodal values $(u(x_{1}),u(x_{2}),u(x_{3}))$ by $u(x_{i})=\\sum_{m=0}^{2}a_{m}P_{m}(x_{i})$.\n- Using first principles, verify the invertibility of $V$ and analyze its conditioning in the Euclidean two-norm.\n\nYour final task is to provide the exact two-norm condition number of the interpolation matrix $V$ as a single closed-form analytic expression. No rounding is required; give the exact expression with radicals if they arise.", "solution": "The problem statement is internally consistent, mathematically well-posed, and grounded in the standard theory of numerical methods for partial differential equations, specifically the Discontinuous Galerkin (DG) method. All definitions, parameters, and constants are provided, allowing for a direct and unambiguous solution pathway. The problem is therefore deemed valid.\n\nThe solution proceeds in several steps: first, we determine the required Gauss–Lobatto nodes for the specified polynomial degree. Second, we construct the requested Lagrange basis polynomials for completeness. Third, we assemble the interpolation matrix $V$. Finally, we analyze the properties of $V$, including its invertibility and its two-norm condition number, which is the primary objective.\n\n**Step 1: Determine the Gauss–Lobatto Nodes**\nThe problem specifies a polynomial degree of $k=2$. The Gauss–Lobatto nodes on the reference interval $[-1, 1]$ consist of the endpoints, $x=-1$ and $x=1$, and the interior roots of the derivative of the Legendre polynomial of degree $k=2$, which is $P_{2}'(x)$.\n\nThe Legendre polynomial of degree $2$ is given as $P_{2}(x) = \\frac{1}{2}(3x^{2}-1)$.\nIts derivative is:\n$$\nP_{2}'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}(3x^{2}-1)\\right) = \\frac{1}{2}(6x) = 3x\n$$\nThe root of $P_{2}'(x)=0$ is found by solving $3x=0$, which yields $x=0$.\nTherefore, the set of three $(k+1=3)$ Gauss–Lobatto nodes, ordered from smallest to largest, is:\n$$\nx_{1} = -1, \\quad x_{2} = 0, \\quad x_{3} = 1\n$$\n\n**Step 2: Construct the Lagrange Nodal Basis**\nThe Lagrange basis polynomials $\\{\\ell_{i}(x)\\}_{i=1}^{3}$ are polynomials of degree at most $k=2$ that satisfy the property $\\ell_{i}(x_{j}) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nFor $\\ell_{1}(x)$: It must be zero at $x_{2}=0$ and $x_{3}=1$, and equal to $1$ at $x_{1}=-1$.\n$$\n\\ell_{1}(x) = C_1(x-x_{2})(x-x_{3}) = \\frac{(x-0)(x-1)}{(-1-0)(-1-1)} = \\frac{x(x-1)}{2} = \\frac{1}{2}x^{2} - \\frac{1}{2}x\n$$\n\nFor $\\ell_{2}(x)$: It must be zero at $x_{1}=-1$ and $x_{3}=1$, and equal to $1$ at $x_{2}=0$.\n$$\n\\ell_{2}(x) = C_2(x-x_{1})(x-x_{3}) = \\frac{(x-(-1))(x-1)}{(0-(-1))(0-1)} = \\frac{(x+1)(x-1)}{-1} = 1 - x^{2}\n$$\n\nFor $\\ell_{3}(x)$: It must be zero at $x_{1}=-1$ and $x_{2}=0$, and equal to $1$ at $x_{3}=1$.\n$$\n\\ell_{3}(x) = C_3(x-x_{1})(x-x_{2}) = \\frac{(x-(-1))(x-0)}{(1-(-1))(1-0)} = \\frac{x(x+1)}{2} = \\frac{1}{2}x^{2} + \\frac{1}{2}x\n$$\nThe constructed Lagrange basis is $\\{\\frac{1}{2}(x^{2}-x), 1-x^{2}, \\frac{1}{2}(x^{2}+x)\\}$.\n\n**Step 3: Compute the Interpolation Matrix V**\nThe interpolation matrix $V \\in \\mathbb{R}^{3\\times 3}$ is defined by its entries $V_{ij} = P_{j-1}(x_{i})$, for $i,j \\in \\{1,2,3\\}$. The modal basis functions are the first three Legendre polynomials:\n$P_{0}(x) = 1$\n$P_{1}(x) = x$\n$P_{2}(x) = \\frac{1}{2}(3x^{2}-1)$\n\nWe evaluate these polynomials at the nodes $x_{1}=-1$, $x_{2}=0$, and $x_{3}=1$.\n\nFor the first row ($i=1$, $x_{1}=-1$):\n$V_{11} = P_{0}(-1) = 1$\n$V_{12} = P_{1}(-1) = -1$\n$V_{13} = P_{2}(-1) = \\frac{1}{2}(3(-1)^{2}-1) = \\frac{1}{2}(3-1) = 1$\n\nFor the second row ($i=2$, $x_{2}=0$):\n$V_{21} = P_{0}(0) = 1$\n$V_{22} = P_{1}(0) = 0$\n$V_{23} = P_{2}(0) = \\frac{1}{2}(3(0)^{2}-1) = -\\frac{1}{2}$\n\nFor the third row ($i=3$, $x_{3}=1$):\n$V_{31} = P_{0}(1) = 1$\n$V_{32} = P_{1}(1) = 1$\n$V_{33} = P_{2}(1) = \\frac{1}{2}(3(1)^{2}-1) = \\frac{1}{2}(3-1) = 1$\n\nAssembling these values gives the matrix $V$:\n$$\nV = \\begin{pmatrix} 1 & -1 & 1 \\\\ 1 & 0 & -\\frac{1}{2} \\\\ 1 & 1 & 1 \\end{pmatrix}\n$$\n\n**Step 4: Verify Invertibility and Compute the Condition Number**\nTo verify invertibility, we can compute the determinant of $V$.\n$$\n\\det(V) = 1\\left(0(1) - 1\\left(-\\frac{1}{2}\\right)\\right) - (-1)\\left(1(1) - 1\\left(-\\frac{1}{2}\\right)\\right) + 1\\left(1(1) - 1(0)\\right)\n$$\n$$\n\\det(V) = 1\\left(\\frac{1}{2}\\right) + 1\\left(1+\\frac{1}{2}\\right) + 1(1) = \\frac{1}{2} + \\frac{3}{2} + 1 = \\frac{4}{2} + 1 = 2 + 1 = 3\n$$\nSince $\\det(V) = 3 \\neq 0$, the matrix $V$ is invertible.\n\nThe two-norm condition number of $V$, denoted $\\kappa_{2}(V)$, is the ratio of its largest singular value ($\\sigma_{\\max}$) to its smallest singular value ($\\sigma_{\\min}$): $\\kappa_{2}(V) = \\sigma_{\\max}(V) / \\sigma_{\\min}(V)$. The singular values of $V$ are the square roots of the eigenvalues of the matrix $V^{T}V$.\n\nFirst, we compute $V^{T}V$:\n$$\nV^{T} = \\begin{pmatrix} 1 & 1 & 1 \\\\ -1 & 0 & 1 \\\\ 1 & -\\frac{1}{2} & 1 \\end{pmatrix}\n$$\n$$\nV^{T}V = \\begin{pmatrix} 1 & 1 & 1 \\\\ -1 & 0 & 1 \\\\ 1 & -\\frac{1}{2} & 1 \\end{pmatrix} \\begin{pmatrix} 1 & -1 & 1 \\\\ 1 & 0 & -\\frac{1}{2} \\\\ 1 & 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 3 & 0 & \\frac{3}{2} \\\\ 0 & 2 & 0 \\\\ \\frac{3}{2} & 0 & \\frac{9}{4} \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $V^{T}V$ are the roots of the characteristic equation $\\det(V^{T}V - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} 3-\\lambda & 0 & \\frac{3}{2} \\\\ 0 & 2-\\lambda & 0 \\\\ \\frac{3}{2} & 0 & \\frac{9}{4}-\\lambda \\end{pmatrix} = (2-\\lambda) \\left[ (3-\\lambda)\\left(\\frac{9}{4}-\\lambda\\right) - \\left(\\frac{3}{2}\\right)^{2} \\right] = 0\n$$\nThis immediately gives one eigenvalue $\\lambda_1 = 2$. The other two eigenvalues are the roots of the expression in the brackets:\n$$\n(3-\\lambda)\\left(\\frac{9}{4}-\\lambda\\right) - \\frac{9}{4} = 0\n$$\n$$\n\\frac{27}{4} - 3\\lambda - \\frac{9}{4}\\lambda + \\lambda^{2} - \\frac{9}{4} = 0\n$$\n$$\n\\lambda^{2} - \\left(3+\\frac{9}{4}\\right)\\lambda + \\left(\\frac{27}{4} - \\frac{9}{4}\\right) = 0\n$$\n$$\n\\lambda^{2} - \\frac{21}{4}\\lambda + \\frac{18}{4} = 0 \\implies 4\\lambda^{2} - 21\\lambda + 18 = 0\n$$\nUsing the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$:\n$$\n\\lambda = \\frac{21 \\pm \\sqrt{(-21)^{2} - 4(4)(18)}}{2(4)} = \\frac{21 \\pm \\sqrt{441 - 288}}{8} = \\frac{21 \\pm \\sqrt{153}}{8}\n$$\nSince $153 = 9 \\times 17$, we have $\\sqrt{153} = 3\\sqrt{17}$. The other two eigenvalues are:\n$$\n\\lambda_{2} = \\frac{21 + 3\\sqrt{17}}{8} \\quad \\text{and} \\quad \\lambda_{3} = \\frac{21 - 3\\sqrt{17}}{8}\n$$\nThe eigenvalues of $V^{T}V$ are $\\{2, \\frac{21+3\\sqrt{17}}{8}, \\frac{21-3\\sqrt{17}}{8}\\}$. We check their approximate values: $\\sqrt{17} \\approx 4.123$, so $\\lambda_2 \\approx \\frac{21+12.369}{8} \\approx 4.17$ and $\\lambda_3 \\approx \\frac{21-12.369}{8} \\approx 1.08$. Thus, the maximum and minimum eigenvalues are:\n$$\n\\lambda_{\\max} = \\frac{21 + 3\\sqrt{17}}{8} \\quad \\text{and} \\quad \\lambda_{\\min} = \\frac{21 - 3\\sqrt{17}}{8}\n$$\nThe condition number is the ratio of the square roots of these eigenvalues:\n$$\n\\kappa_{2}(V) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}} = \\sqrt{\\frac{\\frac{21 + 3\\sqrt{17}}{8}}{\\frac{21 - 3\\sqrt{17}}{8}}} = \\sqrt{\\frac{21 + 3\\sqrt{17}}{21 - 3\\sqrt{17}}}\n$$\nWe simplify the expression by factoring out $3$ from the numerator and denominator:\n$$\n\\kappa_{2}(V) = \\sqrt{\\frac{7 + \\sqrt{17}}{7 - \\sqrt{17}}}\n$$\nTo rationalize the expression inside the square root, we multiply the numerator and denominator by the conjugate of the denominator:\n$$\n\\kappa_{2}(V) = \\sqrt{\\frac{7 + \\sqrt{17}}{7 - \\sqrt{17}} \\cdot \\frac{7 + \\sqrt{17}}{7 + \\sqrt{17}}} = \\sqrt{\\frac{(7 + \\sqrt{17})^{2}}{7^{2} - (\\sqrt{17})^{2}}} = \\sqrt{\\frac{(7 + \\sqrt{17})^{2}}{49 - 17}} = \\sqrt{\\frac{(7 + \\sqrt{17})^{2}}{32}}\n$$\nTaking the square root gives:\n$$\n\\kappa_{2}(V) = \\frac{7 + \\sqrt{17}}{\\sqrt{32}} = \\frac{7 + \\sqrt{17}}{4\\sqrt{2}}\n$$\nFinally, rationalizing the denominator of the overall expression:\n$$\n\\kappa_{2}(V) = \\frac{(7 + \\sqrt{17})\\sqrt{2}}{4\\sqrt{2}\\sqrt{2}} = \\frac{7\\sqrt{2} + \\sqrt{34}}{8}\n$$\nThis is the exact, closed-form analytic expression for the two-norm condition number of the matrix $V$.", "answer": "$$\n\\boxed{\\frac{7\\sqrt{2} + \\sqrt{34}}{8}}\n$$", "id": "3295158"}, {"introduction": "Applying DG methods to nonlinear conservation laws, such as the Euler equations of gas dynamics, introduces a significant challenge: the flux term $f(u_h)$ is a nonlinear function of the polynomial approximation $u_h$. The resulting integrand in the weak form is a polynomial of a much higher degree than the solution itself. This practice addresses the critical issue of how to integrate this term accurately, forcing a careful selection of the numerical quadrature rule. By analyzing the polynomial degrees and the exactness properties of Gauss quadrature, you will explore the concept of \"over-integration\" and quantify its impact on computational cost, revealing a fundamental trade-off between accuracy and efficiency in modern CFD solvers [@problem_id:3295141].", "problem": "Consider the scalar conservation law in one spatial dimension,\n$$\n\\partial_t u + \\partial_x f(u) = 0,\n$$\non a single reference element $E=[-1,1]$ discretized by the Discontinuous Galerkin (DG) method. Let the numerical flux at the element boundaries be any two-point, Lipschitz-continuous flux consistent with $f(u)$ (for example, a local Lax–Friedrichs flux), and let the interior approximation be $u_h(x,t) \\in P^k(E)$, the space of polynomials of degree at most $k$ on $E$, expanded in a fixed polynomial basis $\\{\\phi_j(x)\\}_{j=0}^k$. Assume the physical flux is cubic, $f(u)=a u^3$, with $a$ a real constant.\n\nAfter integrating by parts, the semi-discrete DG weak form for the interior (volume) contribution associated with the $i$-th test function is\n$$\nI_i := \\int_{-1}^{1} f(u_h(x,t))\\,\\partial_x \\phi_i(x)\\,dx.\n$$\nTo numerically approximate $I_i$, employ an $N_q$-point Gauss–Legendre quadrature on $[-1,1]$, which is exact for polynomial integrands up to degree $2N_q-1$. You will:\n- Use fundamental properties of polynomial degrees and quadrature exactness to determine the minimal polynomial degree that the quadrature must integrate exactly to render $I_i$ exact for the cubic nonlinearity $f(u)=a u^3$ when $u_h \\in P^k(E)$, and justify that choosing $N_q \\ge 2k+1$ restores exactness.\n- Define a canonical per-element operation count for assembling all volume terms $\\{I_i\\}_{i=0}^{k}$ as follows: for each quadrature point, evaluating $u_h$ by a stable polynomial evaluation (e.g., Horner’s rule) costs a fixed number of floating-point multiply-adds proportional to $k$, evaluating $f(u)$ costs a fixed number not depending on $k$, and accumulating $f(u)\\,\\partial_x \\phi_i$ into all $k+1$ test-function integrals scales linearly with $k+1$. Under these assumptions, the total per-element operation count is proportional to $(k+1)N_q$.\nLet “standard quadrature” mean $N_q^{\\mathrm{std}}=k+1$. Let “over-integration” mean $N_q^{\\mathrm{over}}=2k+1$. Compute, in closed form, the ratio of the over-integration per-element operation count to the standard quadrature per-element operation count, expressed purely as a function of $k$. Your final answer must be a single closed-form analytic expression in $k$ without units.", "solution": "The problem requires an analysis of the numerical integration of the volume term in a Discontinuous Galerkin (DG) formulation for a scalar conservation law with a cubic flux. The first task is to determine the quadrature accuracy needed for exact integration, and the second is to compute the ratio of computational costs for two different quadrature rules.\n\nLet us begin by analyzing the integrand of the volume integral contribution, $I_i$. The integral is given by:\n$$\nI_i := \\int_{-1}^{1} f(u_h(x,t))\\,\\partial_x \\phi_i(x)\\,dx\n$$\nThe approximate solution, $u_h(x,t)$, is an element of $P^k(E)$, the space of polynomials of degree at most $k$ on the reference element $E = [-1,1]$. Therefore, with respect to the spatial variable $x$, $u_h$ is a polynomial of degree at most $k$.\n\nThe physical flux function is defined as $f(u) = a u^3$, where $a$ is a constant. The composition $f(u_h(x,t))$ is therefore given by $a(u_h(x,t))^3$. Since $u_h$ is a polynomial in $x$ of degree at most $k$, the function $f(u_h(x,t))$ is a polynomial in $x$ of degree at most $3 \\times k = 3k$.\n\nThe test function, $\\phi_i(x)$, is a member of the basis for the same polynomial space $P^k(E)$, so its degree is at most $k$. Consequently, its spatial derivative, $\\partial_x \\phi_i(x)$, is a polynomial of degree at most $k-1$.\n\nThe integrand of $I_i$ is the product of two polynomials: $f(u_h)$ and $\\partial_x \\phi_i$. The degree of a product of polynomials is the sum of their individual degrees. Thus, the maximal degree of the integrand polynomial is:\n$$\n\\deg\\left(f(u_h) \\cdot \\partial_x \\phi_i\\right) = \\deg(f(u_h)) + \\deg(\\partial_x \\phi_i) \\le 3k + (k-1) = 4k-1\n$$\nTo evaluate the integral $I_i$ exactly, the numerical quadrature rule must be exact for any polynomial of degree up to this maximum value, $4k-1$.\n\nThe problem states that an $N_q$-point Gauss-Legendre quadrature is employed. This rule is exact for polynomial integrands of degree up to $2N_q-1$. Therefore, for exact integration of $I_i$, the following condition must be met:\n$$\n2N_q - 1 \\ge 4k - 1\n$$\nThis inequality simplifies to $2N_q \\ge 4k$, which means $N_q \\ge 2k$. This gives the minimum number of quadrature points required.\n\nThe problem asks to justify that choosing $N_q = 2k+1$ is sufficient to restore exactness. If we choose $N_q = 2k+1$, the quadrature rule will be exact for polynomials of degree up to $2(2k+1) - 1 = 4k+2-1 = 4k+1$. Since the degree of our integrand is at most $4k-1$, and it holds that $4k+1 \\ge 4k-1$ for all non-negative integers $k$, the choice $N_q = 2k+1$ is indeed sufficient to guarantee that the volume integral is computed exactly. The use of the term \"restores\" is appropriate in the context that a \"standard\" quadrature with $N_q = k+1$ would not be exact, and thus this choice of a higher number of points remedies that deficiency.\n\nNext, we address the second part of the problem: the computation of the ratio of operation counts. The per-element operation count is given to be proportional to $(k+1)N_q$. Let the cost be denoted by $C$, such that $C = \\alpha (k+1) N_q$ for some constant of proportionality $\\alpha$.\n\nThe \"standard quadrature\" scheme is defined by $N_q^{\\mathrm{std}} = k+1$. The associated computational cost, $C_{\\mathrm{std}}$, is:\n$$\nC_{\\mathrm{std}} = \\alpha (k+1) N_q^{\\mathrm{std}} = \\alpha (k+1) (k+1) = \\alpha (k+1)^2\n$$\nThe \"over-integration\" scheme, which ensures exact integration for the cubic flux, is defined by $N_q^{\\mathrm{over}} = 2k+1$. The associated computational cost, $C_{\\mathrm{over}}$, is:\n$$\nC_{\\mathrm{over}} = \\alpha (k+1) N_q^{\\mathrm{over}} = \\alpha (k+1) (2k+1)\n$$\nThe problem asks for the ratio of the over-integration cost to the standard quadrature cost. This ratio is:\n$$\n\\frac{C_{\\mathrm{over}}}{C_{\\mathrm{std}}} = \\frac{\\alpha (k+1) (2k+1)}{\\alpha (k+1)^2}\n$$\nThe constant of proportionality $\\alpha$ cancels out. Since the polynomial degree $k$ is a non-negative integer, the term $k+1$ is never zero, allowing us to cancel one factor of $(k+1)$ from the numerator and the denominator.\n$$\n\\frac{C_{\\mathrm{over}}}{C_{\\mathrm{std}}} = \\frac{2k+1}{k+1}\n$$\nThis expression represents the required ratio in closed form, as a function of $k$.", "answer": "$$\n\\boxed{\\frac{2k+1}{k+1}}\n$$", "id": "3295141"}]}