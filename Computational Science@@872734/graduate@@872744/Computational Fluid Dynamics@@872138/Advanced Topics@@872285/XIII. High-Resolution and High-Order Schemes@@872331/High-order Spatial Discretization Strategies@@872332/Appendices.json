{"hands_on_practices": [{"introduction": "The cornerstone of any Finite Difference Method is the accurate approximation of derivatives. This exercise guides you through the fundamental process of constructing a high-order central difference scheme of arbitrary order $2m$ by systematically using Taylor series expansions. By mastering this technique, you will not only derive the specific coefficients for the scheme but also gain a deep understanding of how a scheme's truncation error is formally defined and determined. [@problem_id:3328996]", "problem": "Consider a smooth scalar field $f(x)$ sampled on a uniform grid $x_i = x_0 + i h$ with spacing $h > 0$. In the context of Computational Fluid Dynamics (CFD), high-order central finite differences are used to approximate spatial derivatives with high accuracy. Construct a centered finite difference formula for the first derivative at $x_0$ that uses a symmetric stencil $\\{x_0 \\pm j h\\}_{j=1}^{m}$ and achieves formal order $2m$, that is, it is exact for all monomials $x^p$ up to degree $2m$. Specifically, approximate $f^{\\prime}(x_0)$ by\n$$\n\\frac{1}{h} \\sum_{j=1}^{m} a_j \\big(f(x_0 + j h) - f(x_0 - j h)\\big),\n$$\nwhere the unknown coefficients $a_j$ depend only on $m$.\n\nStarting from first principles appropriate to high-order spatial discretization, including the Taylor series expansion and polynomial interpolation on a uniform grid, do the following:\n\n- Derive a closed-form expression for the coefficients $a_j$, $j = 1, \\dots, m$, by enforcing exactness on monomials up to degree $2m$.\n- Using the same foundational tools, compute the leading truncation error term of this approximation, in the form\n$$\nE_{2m+1}(x_0; h) \\,=\\, C_m \\, h^{2m} \\, f^{(2m+1)}(x_0) \\,+\\, \\mathcal{O}\\!\\left(h^{2m+2}\\right),\n$$\nand obtain a closed-form expression for the constant $C_m$ that depends only on $m$.\n\nAnswer specification:\n- Your final boxed answer must be the analytic expression for $C_m$ only. Do not include units.\n- No numerical approximation or rounding is required.", "solution": "The user wants to find the coefficients and the leading truncation error for a high-order central finite difference scheme.\n\n### Problem Validation\nThe problem statement is a standard exercise in numerical analysis, specifically in the derivation of finite difference formulas.\n- **Givens**: A smooth scalar field $f(x)$, a uniform grid $x_i = x_0 + ih$, and a finite difference approximation for the first derivative $f'(x_0)$ of the form $D_h[f](x_0) = \\frac{1}{h} \\sum_{j=1}^{m} a_j \\big(f(x_0 + j h) - f(x_0 - j h)\\big)$. The scheme is required to have a formal order of accuracy of $2m$. We need to find the coefficients $a_j$ and the leading truncation error constant $C_m$.\n- **Validation**: The problem is scientifically grounded in the theory of numerical approximations of derivatives. It is well-posed, objective, and contains no internal contradictions or missing information. The request to derive both the coefficients and the error constant is standard. The problem is valid.\n\n### Derivation of the System of Equations and the Error Term\nWe begin by expressing the finite difference operator in terms of Taylor series expansions around the point $x_0$. The Taylor series for $f(x_0 + \\delta)$ is given by:\n$$f(x_0 + \\delta) = \\sum_{k=0}^{\\infty} \\frac{f^{(k)}(x_0)}{k!} \\delta^k$$\nLet's consider the term $f(x_0 + jh) - f(x_0 - jh)$:\n$$f(x_0 + jh) - f(x_0 - jh) = \\sum_{k=0}^{\\infty} \\frac{f^{(k)}(x_0)}{k!} (jh)^k - \\sum_{k=0}^{\\infty} \\frac{f^{(k)}(x_0)}{k!} (-jh)^k$$\n$$= \\sum_{k=0}^{\\infty} \\frac{f^{(k)}(x_0)}{k!} (jh)^k (1 - (-1)^k)$$\nThe term $(1 - (-1)^k)$ is $2$ for odd $k$ and $0$ for even $k$. Let $k = 2l+1$.\n$$f(x_0 + jh) - f(x_0 - jh) = \\sum_{l=0}^{\\infty} \\frac{f^{(2l+1)}(x_0)}{(2l+1)!} (jh)^{2l+1} \\cdot 2$$\nSubstituting this into the approximation for $f'(x_0)$:\n$$D_h[f](x_0) = \\frac{1}{h} \\sum_{j=1}^{m} a_j \\left( 2 \\sum_{l=0}^{\\infty} \\frac{f^{(2l+1)}(x_0)}{(2l+1)!} (jh)^{2l+1} \\right)$$\nBy rearranging the sums, we get:\n$$D_h[f](x_0) = \\sum_{l=0}^{\\infty} \\frac{2 h^{2l} f^{(2l+1)}(x_0)}{(2l+1)!} \\left( \\sum_{j=1}^{m} a_j j^{2l+1} \\right)$$\nFor the scheme to approximate $f'(x_0)$ with an order of accuracy $2m$, the expansion of $D_h[f](x_0)$ must match the Taylor series of $f'(x_0)$ (which is just $f'(x_0)$ itself) up to terms of order $h^{2m-1}$.\nThe term for $l=0$ must equal $f'(x_0)$:\n$$\\frac{2 h^0 f^{(1)}(x_0)}{1!} \\left( \\sum_{j=1}^{m} a_j j^1 \\right) = f'(x_0) \\implies 2 f'(x_0) \\sum_{j=1}^{m} a_j j = f'(x_0)$$\nThis gives the first condition on the coefficients $a_j$:\n$$\\sum_{j=1}^{m} a_j j = \\frac{1}{2}$$\nFor the scheme to be of order $2m$, the coefficients of $h^{2l}f^{(2l+1)}(x_0)$ for $l=1, 2, \\dots, m-1$ must be zero. This leads to the following system of equations:\n$$\\sum_{j=1}^{m} a_j j^{2l+1} = 0 \\quad \\text{for } l = 1, 2, \\dots, m-1$$\nThis gives a system of $m$ linear equations for the $m$ unknown coefficients $a_j$.\n\nThe leading truncation error term is the first non-zero term in the series after $l=0$, which corresponds to $l=m$:\n$$E_{2m+1}(x_0; h) = D_h[f](x_0) - f'(x_0) = \\frac{2 h^{2m} f^{(2m+1)}(x_0)}{(2m+1)!} \\left( \\sum_{j=1}^{m} a_j j^{2m+1} \\right) + \\mathcal{O}(h^{2m+2})$$\nBy comparing this with the given form of the error $E_{2m+1}(x_0; h) = C_m h^{2m} f^{(2m+1)}(x_0) + \\mathcal{O}(h^{2m+2})$, we identify the error constant $C_m$ as:\n$$C_m = \\frac{2}{(2m+1)!} \\sum_{j=1}^{m} a_j j^{2m+1}$$\n\n### Derivation of Coefficients $a_j$\nTo solve for $a_j$, let us define $b_j = j a_j$ and $x_j = j^2$. The system of equations can be written as:\n$$\\sum_{j=1}^{m} b_j (j^2)^l = \\frac{1}{2} \\delta_{l,0} \\quad \\text{for } l=0, 1, \\dots, m-1$$\nThis is a Vandermonde-type system. We can solve for $b_j$ using polynomial interpolation logic. Consider a polynomial $Q_k(x) = \\prod_{i=1, i\\neq k}^m (x-x_i) = \\prod_{i=1, i\\neq k}^m (x-i^2)$. For $j=1, \\dots, m$, $Q_k(x_j)$ is zero unless $j=k$.\n$$\\sum_{j=1}^m b_j Q_k(x_j) = b_k Q_k(x_k) = b_k \\prod_{i=1, i\\neq k}^m (k^2-i^2)$$\nAlso, by expanding $Q_k(x) = \\sum_{l=0}^{m-1} q_{k,l} x^l$:\n$$\\sum_{j=1}^m b_j Q_k(x_j) = \\sum_{j=1}^m b_j \\sum_{l=0}^{m-1} q_{k,l} x_j^l = \\sum_{l=0}^{m-1} q_{k,l} \\left( \\sum_{j=1}^m b_j x_j^l \\right) = \\sum_{l=0}^{m-1} q_{k,l} \\left( \\frac{1}{2}\\delta_{l,0} \\right) = \\frac{1}{2}q_{k,0}$$\nThe constant term is $q_{k,0} = Q_k(0) = \\prod_{i=1, i\\neq k}^m (-i^2) = (-1)^{m-1} \\frac{(m!)^2}{k^2}$.\nEquating the two expressions gives:\n$$b_k \\prod_{i=1, i\\neq k}^m (k^2-i^2) = \\frac{1}{2} (-1)^{m-1} \\frac{(m!)^2}{k^2}$$\nThe product term on the left is $\\prod_{i=1, i\\neq k}^m (k-i)(k+i) = \\left( \\prod_{i=1, i\\neq k}^m (k-i) \\right) \\left( \\prod_{i=1, i\\neq k}^m (k+i) \\right)$.\n$\\prod_{i=1, i\\neq k}^m (k-i) = (k-1)! (-1)^{m-k} (m-k)!$.\n$\\prod_{i=1, i\\neq k}^m (k+i) = \\frac{\\prod_{i=1}^m (k+i)}{2k} = \\frac{(m+k)! / k!}{2k}$.\nSo, $b_k (k-1)! (-1)^{m-k} (m-k)! \\frac{(m+k)!}{2k \\cdot k!} = \\frac{1}{2} (-1)^{m-1} \\frac{(m!)^2}{k^2}$.\n$b_k (-1)^{m-k} (m-k)! \\frac{(m+k)!}{2k^2} = \\frac{1}{2} (-1)^{m-1} \\frac{(m!)^2}{k^2}$.\n$b_k = \\frac{(-1)^{m-1}}{(-1)^{m-k}} \\frac{(m!)^2}{(m-k)!(m+k)!} = (-1)^{k-1} \\frac{(m!)^2}{(m-k)!(m+k)!}$.\nSince $a_j = b_j/j$, we have the closed-form expression for the coefficients:\n$$a_j = \\frac{(-1)^{j-1}}{j} \\frac{(m!)^2}{(m-j)!(m+j)!}$$\n\n### Derivation of the Error Constant $C_m$\nTo find $C_m$, we need to compute the sum $S = \\sum_{j=1}^{m} a_j j^{2m+1}$.\nUsing $b_j = j a_j$ and $x_j=j^2$, this sum is $S = \\sum_{j=1}^{m} b_j (j^2)^m = \\sum_{j=1}^{m} b_j x_j^m$.\nLet's define a monic polynomial $P(x)$ of degree $m$ whose roots are $x_j=j^2$ for $j=1, \\dots, m$:\n$$P(x) = \\prod_{j=1}^{m} (x-x_j) = \\prod_{j=1}^{m} (x-j^2) = x^m + c_{m-1}x^{m-1} + \\dots + c_1 x + c_0$$\nBy construction, $P(x_j)=0$ for all $j=1, \\dots, m$. Consider the sum $\\sum_{j=1}^m b_j P(x_j)$, which is zero.\n$$0 = \\sum_{j=1}^{m} b_j P(x_j) = \\sum_{j=1}^{m} b_j \\left(x_j^m + \\sum_{l=0}^{m-1} c_l x_j^l\\right)$$\n$$0 = \\sum_{j=1}^{m} b_j x_j^m + \\sum_{l=0}^{m-1} c_l \\left(\\sum_{j=1}^{m} b_j x_j^l\\right)$$\nThe first term is the sum $S$ we want to find. The second term simplifies using the conditions on $b_j$:\n$$\\sum_{l=0}^{m-1} c_l \\left(\\frac{1}{2}\\delta_{l,0}\\right) = \\frac{1}{2}c_0$$\nSo, we have the relation $0 = S + \\frac{1}{2}c_0$, which implies $S = -\\frac{1}{2}c_0$.\nThe constant $c_0$ is the value of the polynomial $P(x)$ at $x=0$:\n$$c_0 = P(0) = \\prod_{j=1}^{m} (0-j^2) = \\prod_{j=1}^{m} (-j^2) = (-1)^m \\prod_{j=1}^{m} j^2 = (-1)^m (m!)^2$$\nTherefore, the sum is:\n$$S = \\sum_{j=1}^{m} a_j j^{2m+1} = -\\frac{1}{2} (-1)^m (m!)^2$$\nFinally, we substitute this sum back into the expression for $C_m$:\n$$C_m = \\frac{2}{(2m+1)!} S = \\frac{2}{(2m+1)!} \\left(-\\frac{1}{2} (-1)^m (m!)^2\\right)$$\n$$C_m = -\\frac{(-1)^m (m!)^2}{(2m+1)!} = \\frac{(-1)^{m+1} (m!)^2}{(2m+1)!}$$", "answer": "$$\\boxed{\\frac{(-1)^{m+1} (m!)^2}{(2m+1)!}}$$", "id": "3328996"}, {"introduction": "A numerical scheme's order of accuracy tells only part of the story; the *character* of the error is equally important for predicting its behavior. In this practice, you will analyze a fourth-order central difference scheme to determine its leading error terms when applied to the linear advection equation. This analysis will introduce you to the critical concepts of numerical dispersion and dissipation, which arise from odd and even order derivative terms in the truncation error, respectively. [@problem_id:3329059]", "problem": "Consider the linear advection partial differential equation (PDE) in one dimension (1D), given by $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a$ and a sufficiently smooth solution $u(x,t)$, discretized on a uniform grid $x_{i} = x_{0} + i h$ with spacing $h$. In Computational Fluid Dynamics (CFD), a common high-order spatial discretization for the first derivative $u_{x}$ is the fourth-order central difference operator defined at a grid point $x_{i}$ by\n$$D^{(1)}_{4} u_{i} = \\frac{-u_{i+2} + 8\\,u_{i+1} - 8\\,u_{i-1} + u_{i-2}}{12\\,h}.$$\nStarting from the PDE and the definition of local truncation error (LTE) as the residual obtained by substituting the exact solution into the semi-discrete scheme, derive the leading-order expression for the LTE of the semi-discrete scheme $u_{t} + a\\,D^{(1)}_{4} u = 0$ in terms of spatial derivatives of $u$ at $x_{i}$. Then, using a principled characterization of numerical dispersion and dissipation based on the modified equation or Fourier symbol analysis, identify and express the leading dispersive and dissipative error terms associated with this spatial discretization. Your final answer should report three items, in the following order: the LTE through order $h^{4}$, the leading dispersive error term, and the leading dissipative error term, each as a single closed-form analytic expression involving $a$, $h$, and derivatives of $u$ with respect to $x$. No numerical rounding is required, and no physical units should be included in your final expressions.", "solution": "The problem is subjected to validation and is determined to be valid. It is a well-posed, scientifically grounded problem in the field of computational fluid dynamics, asking for a standard analysis of a numerical scheme.\n\nThe analysis proceeds in three parts as requested by the problem statement: first, the derivation of the Local Truncation Error (LTE); second, the derivation of the leading dispersive error term; and third, the identification of the leading dissipative error term.\n\n1.  **Local Truncation Error (LTE)**\n\nThe semi-discrete scheme is given by $\\frac{\\partial u}{\\partial t} + a\\,D^{(1)}_{4} u = 0$. The Local Truncation Error, $\\tau_i$, at a grid point $x_i$ is the residual obtained by substituting the exact solution $u(x,t)$ of the continuous PDE, $u_t + a\\,u_x = 0$, into the semi-discrete scheme.\n$$ \\tau_i = \\left(\\frac{\\partial u}{\\partial t}\\right)_i + a\\,D^{(1)}_{4} u_i $$\nFor the exact solution $u(x,t)$, we have $\\left(\\frac{\\partial u}{\\partial t}\\right)_i = -a\\,\\left(\\frac{\\partial u}{\\partial x}\\right)_i$. Substituting this into the expression for the LTE yields:\n$$ \\tau_i = -a\\,\\left(\\frac{\\partial u}{\\partial x}\\right)_i + a\\,D^{(1)}_{4} u_i = a \\left( D^{(1)}_{4} u_i - \\left(\\frac{\\partial u}{\\partial x}\\right)_i \\right) $$\nThe LTE of the semi-discrete scheme is therefore the advection speed $a$ multiplied by the truncation error of the spatial finite difference operator $D^{(1)}_{4}$. To find this truncation error, we employ Taylor series expansions for the terms $u_{i \\pm 1}$ and $u_{i \\pm 2}$ around the point $x_i$. We expand up to the term involving the fifth derivative, as we expect a fourth-order scheme. Let $u^{(n)} \\equiv \\frac{\\partial^n u}{\\partial x^n}\\big|_{x_i}$.\n$$ u_{i+k} = u(x_i+kh) = u_i + (kh)u^{(1)} + \\frac{(kh)^2}{2!}u^{(2)} + \\frac{(kh)^3}{3!}u^{(3)} + \\frac{(kh)^4}{4!}u^{(4)} + \\frac{(kh)^5}{5!}u^{(5)} + O(h^6) $$\nWe expand the four necessary terms:\n$$ u_{i+1} = u_i + h u^{(1)} + \\frac{h^2}{2} u^{(2)} + \\frac{h^3}{6} u^{(3)} + \\frac{h^4}{24} u^{(4)} + \\frac{h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i-1} = u_i - h u^{(1)} + \\frac{h^2}{2} u^{(2)} - \\frac{h^3}{6} u^{(3)} + \\frac{h^4}{24} u^{(4)} - \\frac{h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i+2} = u_i + 2h u^{(1)} + \\frac{4h^2}{2} u^{(2)} + \\frac{8h^3}{6} u^{(3)} + \\frac{16h^4}{24} u^{(4)} + \\frac{32h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i-2} = u_i - 2h u^{(1)} + \\frac{4h^2}{2} u^{(2)} - \\frac{8h^3}{6} u^{(3)} + \\frac{16h^4}{24} u^{(4)} - \\frac{32h^5}{120} u^{(5)} + O(h^6) $$\nNow, we substitute these expansions into the definition of the operator $D^{(1)}_{4} u_{i}$:\n$$ D^{(1)}_{4} u_{i} = \\frac{-u_{i+2} + 8\\,u_{i+1} - 8\\,u_{i-1} + u_{i-2}}{12\\,h} $$\nWe group the terms in the numerator by the order of the derivative of $u$:\n-   $u^{(0)}$ term: $(-1 + 8 - 8 + 1)u_i = 0$.\n-   $u^{(1)}$ term: $(-2h + 8(h) - 8(-h) + (-2h))u^{(1)} = ( -2 + 8 + 8 - 2 )h u^{(1)} = 12h u^{(1)}$.\n-   $u^{(2)}$ term: $(-\\frac{4h^2}{2} + 8\\frac{h^2}{2} - 8\\frac{h^2}{2} + \\frac{4h^2}{2})u^{(2)} = ( -2 + 4 - 4 + 2 )h^2 u^{(2)} = 0$.\n-   $u^{(3)}$ term: $(-\\frac{8h^3}{6} + 8\\frac{h^3}{6} - 8(-\\frac{h^3}{6}) - \\frac{8h^3}{6})u^{(3)} = ( -8 + 8 + 8 - 8 )\\frac{h^3}{6} u^{(3)} = 0$.\n-   $u^{(4)}$ term: $(-\\frac{16h^4}{24} + 8\\frac{h^4}{24} - 8\\frac{h^4}{24} + \\frac{16h^4}{24})u^{(4)} = ( -16 + 8 - 8 + 16 )\\frac{h^4}{24} u^{(4)} = 0$.\n-   $u^{(5)}$ term: $(-\\frac{32h^5}{120} + 8\\frac{h^5}{120} - 8(-\\frac{h^5}{120}) - \\frac{32h^5}{120})u^{(5)} = ( -32 + 8 + 8 - 32 )\\frac{h^5}{120} u^{(5)} = -48 \\frac{h^5}{120} u^{(5)} = -\\frac{2}{5} h^5 u^{(5)}$.\n\nSubstituting these results back into the expression for $D^{(1)}_{4} u_{i}$:\n$$ D^{(1)}_{4} u_{i} = \\frac{1}{12h} \\left( 12h u^{(1)} - \\frac{2}{5} h^5 u^{(5)} + O(h^7) \\right) = u^{(1)} - \\frac{2}{5 \\cdot 12} h^4 u^{(5)} + O(h^6) $$\n$$ D^{(1)}_{4} u_{i} = \\frac{\\partial u}{\\partial x} - \\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\nThe truncation error of the spatial operator is the difference $D^{(1)}_{4} u_{i} - (\\frac{\\partial u}{\\partial x})_i$, which is $-\\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6)$.\nThe LTE of the semi-discrete scheme is therefore:\n$$ \\tau_i = a \\left( -\\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) \\right) = -\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\nThe leading-order term of the LTE is $-\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$.\n\n2.  **Dispersive and Dissipative Error Terms**\n\nTo identify the dispersive and dissipative error terms, we derive the modified equation. The modified equation is a PDE that is more accurately solved by the numerical scheme than the original PDE. It is obtained by substituting the Taylor expansion of the discrete operator into the numerical scheme.\n$$ \\frac{\\partial u}{\\partial t} + a D^{(1)}_{4} u = 0 \\implies \\frac{\\partial u}{\\partial t} + a \\left( \\frac{\\partial u}{\\partial x} - \\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) \\right) = 0 $$\nRearranging this equation to match the form of the original PDE on the left-hand side gives:\n$$ \\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\nThe terms on the right-hand side represent the error of the numerical scheme. Error terms with odd-order spatial derivatives are dispersive, while terms with even-order spatial derivatives are dissipative (or anti-dissipative).\n\nThe leading error term is $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$. Since the spatial derivative is of order $5$ (an odd number), this is a **dispersive error term**.\n\nTo find the leading dissipative error term, we look for the lowest-order even-derivative term in the error expansion. The operator $D^{(1)}_{4}$ is a symmetric central difference stencil. A property of such stencils for approximating a first derivative is that all even-order derivative terms in their Taylor series expansion cancel out. As shown in our derivation, the coefficients for $u^{(2)}$ and $u^{(4)}$ are zero. This pattern continues for all higher even-order derivatives ($u^{(6)}, u^{(8)}, \\ldots$). Consequently, the truncation error of $D^{(1)}_{4}$ contains only odd-order derivative terms:\n$$ D^{(1)}_{4} u - u_x = C_5 h^4 u^{(5)} + C_7 h^6 u^{(7)} + C_9 h^8 u^{(9)} + \\dots $$\nThe modified equation will therefore only contain odd-order spatial derivatives on its right-hand side. There are no even-order derivative terms. Because dissipative errors are associated with even-order derivatives, this scheme has no inherent numerical dissipation.\n\nTherefore, the leading dispersive error term is $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$, and the leading dissipative error term is $0$.\n\nThe three requested expressions are:\n1.  LTE: $-\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$\n2.  Leading dispersive error term: $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$\n3.  Leading dissipative error term: $0$", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} & \\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} & 0 \\end{pmatrix} } $$", "id": "3329059"}, {"introduction": "While high-order methods excel for smooth flows, their performance degrades near discontinuities like shock waves. This practice explores a modern solution to this problem within the Discontinuous Galerkin (DG) framework: the use of a modal smoothness sensor to detect shocks and trigger stabilization. You will derive a sensor that measures the solution's smoothness by comparing the energy in the highest polynomial mode to the total energy, providing a powerful tool for building robust, high-fidelity simulations. [@problem_id:3329004]", "problem": "Consider a one-dimensional scalar conservation law discretized by the Discontinuous Galerkin (DG) method on the reference element $\\left[-1,1\\right]$ using a polynomial space of degree $p$. Let the DG approximation be expanded in an $L^{2}$-orthonormal modal basis $\\{\\phi_{k}(x)\\}_{k=0}^{p}$ (for example, orthonormalized Legendre polynomials), so that\n$$\nu_{h}(x) \\;=\\; \\sum_{k=0}^{p} a_{k} \\,\\phi_{k}(x),\n$$\nwith modal coefficients $\\{a_{k}\\}_{k=0}^{p}$. Starting from the definition of the element-wise $L^{2}$ energy $E \\equiv \\int_{-1}^{1} u_{h}(x)^{2}\\,dx$ and the orthonormality of the basis, derive a modal smoothness sensor that compares the energy contained in the highest polynomial mode (i.e., $k=p$) to the total energy. Your derivation must introduce a dimensionless smoothness indicator $s$ that is expressed using a base-$10$ logarithm of an appropriate energy ratio and that remains well-defined even if the highest modal coefficient vanishes.\n\nNext, using only the assumption that the modal amplitudes of a sufficiently smooth function decay asymptotically like $a_{k} \\sim C\\,k^{-q}$ as $k \\to \\infty$ for some $q>0$, derive a polynomial-degree-dependent threshold $s_{\\mathrm{th}}(p)$ that activates artificial viscosity when $s > s_{\\mathrm{th}}(p)$. Specify a practical ramping strategy that transitions the viscosity from zero to a maximum value $\\nu_{\\max}$ between two degree-dependent thresholds $s_{0}(p)$ and $s_{1}(p)$ with $s_{0}(p) < s_{1}(p)$.\n\nFinally, for a specific element with polynomial degree $p = 5$ and modal coefficients\n$$\na_{0} = 1.2,\\quad a_{1} = 0.3,\\quad a_{2} = 0.08,\\quad a_{3} = 0.02,\\quad a_{4} = 0.004,\\quad a_{5} = 0.001,\n$$\nevaluate your sensor $s$ on this element. Round your answer to $4$ significant figures. The sensor is dimensionless; report only the number.", "solution": "The problem requires the derivation of a modal smoothness sensor for the Discontinuous Galerkin (DG) method, an associated threshold for activating artificial viscosity, and a numerical evaluation of the sensor for a specific case. We shall proceed by first validating the problem statement and then providing a rigorous, step-by-step solution.\n\nThe problem is found to be valid. It is scientifically grounded in the established theory of numerical methods for conservation laws, specifically high-order DG methods and shock capturing. The premises, including the use of an orthonormal modal basis and the asymptotic decay of modal coefficients for smooth functions, are standard in this field. The problem is self-contained, well-posed, and objective, with no apparent contradictions or ambiguities.\n\nWe now proceed with the solution.\n\nFirst, we derive the expression for the element-wise $L^2$ energy, $E$, in terms of the modal coefficients. The DG approximation is given by $u_{h}(x) = \\sum_{k=0}^{p} a_{k} \\phi_{k}(x)$. The energy $E$ on the reference element $[-1, 1]$ is defined as:\n$$\nE \\equiv \\int_{-1}^{1} u_{h}(x)^{2}\\,dx\n$$\nSubstituting the modal expansion for $u_h(x)$:\n$$\nE = \\int_{-1}^{1} \\left( \\sum_{j=0}^{p} a_{j} \\phi_{j}(x) \\right) \\left( \\sum_{k=0}^{p} a_{k} \\phi_{k}(x) \\right) \\,dx\n$$\nBy linearity, we can interchange the order of summation and integration:\n$$\nE = \\sum_{j=0}^{p} \\sum_{k=0}^{p} a_{j} a_{k} \\int_{-1}^{1} \\phi_{j}(x) \\phi_{k}(x) \\,dx\n$$\nThe basis functions $\\{\\phi_k(x)\\}$ are stipulated to be $L^2$-orthonormal, which means their inner product satisfies $\\int_{-1}^{1} \\phi_{j}(x) \\phi_{k}(x) \\,dx = \\delta_{jk}$, where $\\delta_{jk}$ is the Kronecker delta. Applying this property simplifies the expression for energy:\n$$\nE = \\sum_{j=0}^{p} \\sum_{k=0}^{p} a_{j} a_{k} \\delta_{jk} = \\sum_{k=0}^{p} a_{k}^{2}\n$$\nThis result is the finite-dimensional version of Parseval's theorem. The total energy $E_{\\mathrm{total}}$ is the sum of the squares of the modal coefficients. The energy contained in a single mode $k$ is simply $E_k = a_k^2$.\n\nNext, we derive the modal smoothness sensor, $s$. The sensor is required to compare the energy in the highest mode ($k=p$), $E_p=a_p^2$, to the total energy, $E_{\\mathrm{total}} = \\sum_{k=0}^{p} a_{k}^{2}$. Let's define the ratio $\\mathcal{R}$ as:\n$$\n\\mathcal{R} = \\frac{E_p}{E_{\\mathrm{total}}} = \\frac{a_p^2}{\\sum_{k=0}^{p} a_{k}^{2}}\n$$\nWe assume the numerical solution is not identically zero, so that $\\sum_{k=0}^{p} a_{k}^{2} > 0$. The smoothness indicator $s$ is defined using the base-$10$ logarithm of this ratio:\n$$\ns = \\log_{10}(\\mathcal{R}) = \\log_{10} \\left( \\frac{a_p^2}{\\sum_{k=0}^{p} a_{k}^{2}} \\right)\n$$\nThis indicator is dimensionless, as required. For a solution with a discontinuity (a shock), a significant portion of the energy is scattered into the high-frequency modes, making $a_p$ relatively large. In the limit of a function composed entirely of the highest mode (e.g., $u_h \\propto \\phi_p$), we have $\\mathcal{R}=1$ and $s=0$. For a very smooth solution, the modal coefficients decay rapidly, making $a_p$ very small, which results in a large negative value for $s$. The problem requires the sensor to be well-defined even if $a_p=0$. In this case, $\\mathcal{R}=0$. The limit of $\\log_{10}(x)$ as $x \\to 0^+$ is $-\\infty$. This limiting value is mathematically well-defined and correctly signifies a solution that is perfectly smooth with respect to the polynomial basis of degree $p$ (i.e., it is a polynomial of degree at most $p-1$). Thus, this formulation satisfies the stated requirements.\n\nSecond, we derive the polynomial-degree-dependent threshold $s_{\\mathrm{th}}(p)$. We are to use the assumption that for a sufficiently smooth function, the modal coefficients decay as $a_k \\sim C k^{-q}$ for some constants $C$ and $q>0$ as $k \\to \\infty$. This asymptotic behavior will be used to characterize the sensor value for a well-resolved numerical solution. Using this relation for $k \\in \\{1, \\dots, p\\}$, we can approximate the coefficients. The coefficient $a_0$ represents the mean of the solution and generally does not follow this decay law. The energy in the highest mode is $a_p^2 \\approx C^2 p^{-2q}$. The total energy is $\\sum_{k=0}^{p} a_k^2 = a_0^2 + \\sum_{k=1}^{p} a_k^2$. For a rapidly convergent series (large $q$), the total energy is dominated by the first few terms, so $E_{\\mathrm{total}} \\approx a_0^2 + C^2\\sum_{k=1}^{p} k^{-2q}$.\nThe ratio $\\mathcal{R}$ for a smooth function is thus:\n$$\n\\mathcal{R}_{\\mathrm{smooth}}(p) \\approx \\frac{C^2 p^{-2q}}{a_0^2 + C^2\\sum_{k=1}^{p} k^{-2q}}\n$$\nAssuming the solution is well-resolved, the energy is dominated by the constant mode $a_0$, so $a_0^2 \\gg C^2\\sum_{k=1}^{p} k^{-2q}$. This simplifies the ratio to:\n$$\n\\mathcal{R}_{\\mathrm{smooth}}(p) \\approx \\frac{C^2}{a_0^2} p^{-2q}\n$$\nThe threshold $s_{\\mathrm{th}}(p)$ is the value of the sensor for such a smooth function:\n$$\ns_{\\mathrm{th}}(p) = \\log_{10}(\\mathcal{R}_{\\mathrm{smooth}}(p)) \\approx \\log_{10}\\left(\\frac{C^2}{a_0^2} p^{-2q}\\right) = \\log_{10}\\left(\\frac{C^2}{a_0^2}\\right) - 2q \\log_{10}(p)\n$$\nThis derivation yields a threshold of the form $s_{\\mathrm{th}}(p) = K_1 - K_2 \\log_{10}(p)$, where $K_1 = \\log_{10}((C/a_0)^2)$ and $K_2 = 2q$ are constants that depend on the specific function being resolved and its smoothness. The functional dependence on the polynomial degree $p$ has been established as required. Artificial viscosity is activated when the measured sensor value $s$ exceeds this threshold, i.e., when $s > s_{\\mathrm{th}}(p)$, indicating that the solution is less smooth than expected for a well-resolved flow.\n\nThird, we specify a practical ramping strategy for the artificial viscosity $\\nu$. The viscosity should smoothly transition from $\\nu=0$ to a maximum value $\\nu_{\\max}$ as the sensor $s$ increases through a range defined by two thresholds, $s_0(p)$ and $s_1(p)$, with $s_0(p) < s_1(p)$. Following the problem, viscosity is activated for $s > s_{\\mathrm{th}}(p)$, so we set the lower threshold $s_0(p) = s_{\\mathrm{th}}(p)$. The upper threshold $s_1(p)$ is typically set based on practical considerations, for example $s_1(p) = s_0(p) + \\Delta s$ for some range $\\Delta s > 0$, or $s_1(p)$ may be set to a constant value like $0$. A general ramping strategy can be formulated as follows:\n$$\n\\nu =\n\\begin{cases}\n    0 & \\text{if } s \\leq s_{0}(p) \\\\\n    \\nu_{\\max} \\cdot f\\left(\\frac{s - s_{0}(p)}{s_{1}(p) - s_{0}(p)}\\right) & \\text{if } s_{0}(p) < s < s_{1}(p) \\\\\n    \\nu_{\\max} & \\text{if } s \\geq s_{1}(p)\n\\end{cases}\n$$\nwhere $f(\\xi)$ is a monotonic function with $f(0)=0$ and $f(1)=1$. A simple and practical choice for $f(\\xi)$ is a linear ramp, $f(\\xi) = \\xi$. A smoother ramp (providing $C^1$ continuity for $\\nu$) can be achieved with a function like $f(\\xi) = \\frac{1}{2}(1 - \\cos(\\pi\\xi))$.\n\nFinally, we evaluate the sensor $s$ for the specific case where the polynomial degree is $p=5$ and the modal coefficients are given as:\n$a_{0} = 1.2$, $a_{1} = 0.3$, $a_{2} = 0.08$, $a_{3} = 0.02$, $a_{4} = 0.004$, and $a_{5} = 0.001$.\n\nThe highest mode is $p=5$, so we need to calculate $a_5^2$:\n$$\na_5^2 = (0.001)^2 = (1 \\times 10^{-3})^2 = 1 \\times 10^{-6}\n$$\nNext, we calculate the total energy, $\\sum_{k=0}^{5} a_k^2$:\n\\begin{align*}\n\\sum_{k=0}^{5} a_k^2 &= (1.2)^2 + (0.3)^2 + (0.08)^2 + (0.02)^2 + (0.004)^2 + (0.001)^2 \\\\\n&= 1.44 + 0.09 + 0.0064 + 0.0004 + 0.000016 + 0.000001 \\\\\n&= 1.536817\n\\end{align*}\nNow we can compute the ratio $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{a_5^2}{\\sum_{k=0}^{5} a_k^2} = \\frac{1 \\times 10^{-6}}{1.536817} \\approx 6.506935 \\times 10^{-7}\n$$\nThe value of the sensor $s$ is the base-$10$ logarithm of this ratio:\n$$\ns = \\log_{10}(6.506935 \\times 10^{-7}) \\approx -6.18663\n$$\nRounding to $4$ significant figures, we get $s = -6.187$.", "answer": "$$\\boxed{-6.187}$$", "id": "3329004"}]}