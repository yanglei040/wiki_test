{"hands_on_practices": [{"introduction": "A cornerstone of the finite element method's power and flexibility is the concept of a master or \"reference\" element. This practice guides you through the fundamental mechanics of constructing the building blocks of a DG simulation, starting from an idealized reference domain. By creating an orthonormal polynomial basis and then mapping it to a physical element, you will gain hands-on experience with how abstract formulations translate into the concrete mass matrices that a computer code would handle [@problem_id:3372733]. This exercise is essential for understanding the practical implementation of any DG or finite element code.", "problem": "Consider the Discontinuous Galerkin finite element method (DG FEM) for Computational Fluid Dynamics (CFD) on a two-dimensional quadrilateral mesh. Let the reference element be the square $\\hat{K} = [-1,1] \\times [-1,1]$. Let $P^{k}(\\hat{K})$ denote the space of all polynomials in two variables whose total degree is at most $k$, and equip $P^{k}(\\hat{K})$ with the $L^{2}$ inner product on $\\hat{K}$ defined by $\\langle f, g \\rangle_{L^{2}(\\hat{K})} = \\int_{\\hat{K}} f(\\hat{\\boldsymbol{x}}) g(\\hat{\\boldsymbol{x}}) \\,\\mathrm{d}\\hat{\\boldsymbol{x}}$. \n\nStarting from the definition of the $L^{2}$ inner product and the integral transformation under an affine map, construct an explicit orthonormal basis for $P^{1}(\\hat{K})$ with respect to $\\langle \\cdot, \\cdot \\rangle_{L^{2}(\\hat{K})}$, and explain how the mass matrix on a physical element arises from the pullback and quadrature. Define the physical element $K$ via the affine map $F_{K} : \\hat{K} \\to K$ given by $F_{K}(\\hat{\\boldsymbol{x}}) = A \\hat{\\boldsymbol{x}} + \\boldsymbol{b}$ for a constant matrix $A \\in \\mathbb{R}^{2 \\times 2}$ and vector $\\boldsymbol{b} \\in \\mathbb{R}^{2}$. The local mass matrix $M^{K}$ has entries $M^{K}_{ij} = \\int_{K} \\phi_{i}^{K}(\\boldsymbol{x}) \\,\\phi_{j}^{K}(\\boldsymbol{x}) \\,\\mathrm{d}\\boldsymbol{x}$, where $\\{\\phi_{i}^{K}\\}$ are the basis functions on $K$ obtained by pullback from the reference basis $\\{\\hat{\\phi}_{i}\\}$ on $\\hat{K}$.\n\nUse tensor-product Gauss quadrature in each coordinate direction on $\\hat{K}$ to approximate the integrals defining $M^{K}$, and justify the required quadrature order for exactness when $k=1$. Finally, for the specific affine map with\n$$\nA = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\qquad \\boldsymbol{b} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix},\n$$\ndetermine the determinant of the physical-element mass matrix $M^{K}$ when $k=1$. Express your final answer as an exact value with no rounding and without units.", "solution": "The problem is well-posed and self-contained, presenting a standard exercise in the formulation of the discontinuous Galerkin finite element method. All terms are defined conventionally, and the requested calculations are mathematically sound and relevant to the field. We may therefore proceed with a solution.\n\nThe problem asks for four main components:\n1.  Construction of an orthonormal basis for the polynomial space $P^{1}(\\hat{K})$.\n2.  An explanation of how the physical element mass matrix $M^K$ is derived.\n3.  Justification of the quadrature order for exact computation of the mass matrix entries for $k=1$.\n4.  Calculation of the determinant of a specific mass matrix $M^K$.\n\nWe shall address these in sequence.\n\nFirst, we construct an orthonormal basis for the space $P^{1}(\\hat{K})$. This is the space of polynomials in two variables, $\\hat{x}$ and $\\hat{y}$, of total degree at most $1$. A canonical monomial basis for $P^{1}(\\hat{K})$ is $\\{\\hat{\\psi}_{1}, \\hat{\\psi}_{2}, \\hat{\\psi}_{3}\\} = \\{1, \\hat{x}, \\hat{y}\\}$. The dimension of this space is $3$. We seek an orthonormal basis $\\{\\hat{\\phi}_{1}, \\hat{\\phi}_{2}, \\hat{\\phi}_{3}\\}$ with respect to the $L^{2}$ inner product on the reference element $\\hat{K} = [-1,1] \\times [-1,1]$:\n$$ \\langle f, g \\rangle_{L^{2}(\\hat{K})} = \\int_{-1}^{1} \\int_{-1}^{1} f(\\hat{x}, \\hat{y}) g(\\hat{x}, \\hat{y}) \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} $$\nWe apply the Gram-Schmidt orthonormalization process to the monomial basis.\n\nLet $\\hat{\\phi}_{1}$ be the normalization of $\\hat{\\psi}_{1} = 1$:\n$$ \\|\\hat{\\psi}_{1}\\|^2_{L^{2}(\\hat{K})} = \\langle 1, 1 \\rangle = \\int_{-1}^{1} \\int_{-1}^{1} 1 \\cdot 1 \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\left(\\int_{-1}^{1} \\mathrm{d}\\hat{x}\\right) \\left(\\int_{-1}^{1} \\mathrm{d}\\hat{y}\\right) = (2)(2) = 4 $$\nSo, $\\|\\hat{\\psi}_{1}\\|_{L^{2}(\\hat{K})} = 2$. The first orthonormal basis function is:\n$$ \\hat{\\phi}_{1}(\\hat{x}, \\hat{y}) = \\frac{\\hat{\\psi}_{1}}{\\|\\hat{\\psi}_{1}\\|} = \\frac{1}{2} $$\n\nNext, we orthogonalize $\\hat{\\psi}_{2} = \\hat{x}$ against $\\hat{\\phi}_{1}$:\n$$ \\langle \\hat{\\psi}_{2}, \\hat{\\phi}_{1} \\rangle = \\left\\langle \\hat{x}, \\frac{1}{2} \\right\\rangle = \\frac{1}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\hat{x} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\frac{1}{2} \\left(\\int_{-1}^{1} \\hat{x} \\,\\mathrm{d}\\hat{x}\\right) \\left(\\int_{-1}^{1} \\mathrm{d}\\hat{y}\\right) = \\frac{1}{2} \\cdot 0 \\cdot 2 = 0 $$\nSince $\\hat{\\psi}_{2}$ is already orthogonal to $\\hat{\\phi}_{1}$, we only need to normalize it:\n$$ \\|\\hat{\\psi}_{2}\\|^2_{L^{2}(\\hat{K})} = \\langle \\hat{x}, \\hat{x} \\rangle = \\int_{-1}^{1} \\int_{-1}^{1} \\hat{x}^{2} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\left(\\int_{-1}^{1} \\hat{x}^{2} \\,\\mathrm{d}\\hat{x}\\right) \\left(\\int_{-1}^{1} \\mathrm{d}\\hat{y}\\right) = \\left[\\frac{\\hat{x}^{3}}{3}\\right]_{-1}^{1} \\cdot 2 = \\left(\\frac{1}{3} - \\frac{-1}{3}\\right) \\cdot 2 = \\frac{2}{3} \\cdot 2 = \\frac{4}{3} $$\nSo, $\\|\\hat{\\psi}_{2}\\|_{L^{2}(\\hat{K})} = \\frac{2}{\\sqrt{3}}$. The second orthonormal basis function is:\n$$ \\hat{\\phi}_{2}(\\hat{x}, \\hat{y}) = \\frac{\\hat{\\psi}_{2}}{\\|\\hat{\\psi}_{2}\\|} = \\frac{\\sqrt{3}}{2}\\hat{x} $$\n\nFinally, we orthogonalize $\\hat{\\psi}_{3} = \\hat{y}$ against $\\hat{\\phi}_{1}$ and $\\hat{\\phi}_{2}$. By symmetry, the integrals are zero:\n$$ \\langle \\hat{\\psi}_{3}, \\hat{\\phi}_{1} \\rangle = \\left\\langle \\hat{y}, \\frac{1}{2} \\right\\rangle = \\frac{1}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\hat{y} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = 0 $$\n$$ \\langle \\hat{\\psi}_{3}, \\hat{\\phi}_{2} \\rangle = \\left\\langle \\hat{y}, \\frac{\\sqrt{3}}{2}\\hat{x} \\right\\rangle = \\frac{\\sqrt{3}}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\hat{x}\\hat{y} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\frac{\\sqrt{3}}{2} \\left(\\int_{-1}^{1} \\hat{x}\\,\\mathrm{d}\\hat{x}\\right) \\left(\\int_{-1}^{1} \\hat{y}\\,\\mathrm{d}\\hat{y}\\right) = 0 $$\nThus, we only need to normalize $\\hat{\\psi}_{3}$. The calculation is symmetric to that for $\\hat{\\psi}_{2}$:\n$$ \\|\\hat{\\psi}_{3}\\|^2_{L^{2}(\\hat{K})} = \\langle \\hat{y}, \\hat{y} \\rangle = \\int_{-1}^{1} \\int_{-1}^{1} \\hat{y}^{2} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\frac{4}{3} $$\nSo, $\\|\\hat{\\psi}_{3}\\|_{L^{2}(\\hat{K})} = \\frac{2}{\\sqrt{3}}$. The third orthonormal basis function is:\n$$ \\hat{\\phi}_{3}(\\hat{x}, \\hat{y}) = \\frac{\\hat{\\psi}_{3}}{\\|\\hat{\\psi}_{3}\\|} = \\frac{\\sqrt{3}}{2}\\hat{y} $$\nThe orthonormal basis for $P^{1}(\\hat{K})$ is $\\{\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\hat{x}, \\frac{\\sqrt{3}}{2}\\hat{y}\\}$.\n\nSecond, we explain the derivation of the physical element mass matrix $M^K$. The entries are defined as $M^{K}_{ij} = \\int_{K} \\phi_{i}^{K}(\\boldsymbol{x}) \\,\\phi_{j}^{K}(\\boldsymbol{x}) \\,\\mathrm{d}\\boldsymbol{x}$. The basis functions $\\phi_{i}^{K}$ on the physical element $K$ are obtained via pullback from the reference basis functions $\\hat{\\phi}_{i}$ using the inverse of the affine map $F_K$. That is, $\\phi_{i}^{K} = \\hat{\\phi}_{i} \\circ F_{K}^{-1}$. To evaluate the integral over $K$, we perform a change of variables to the reference element $\\hat{K}$ using $\\boldsymbol{x} = F_{K}(\\hat{\\boldsymbol{x}})$. The differential element transforms as $\\mathrm{d}\\boldsymbol{x} = |\\det(J_{F_K})|\\,\\mathrm{d}\\hat{\\boldsymbol{x}}$, where $J_{F_K}$ is the Jacobian matrix of the map $F_K$. For the affine map $F_{K}(\\hat{\\boldsymbol{x}}) = A \\hat{\\boldsymbol{x}} + \\boldsymbol{b}$, the Jacobian is the constant matrix $A$. Thus, $\\mathrm{d}\\boldsymbol{x} = |\\det(A)|\\,\\mathrm{d}\\hat{\\boldsymbol{x}}$.\n\nSubstituting these into the integral for $M^{K}_{ij}$:\n$$ M^{K}_{ij} = \\int_{\\hat{K}} \\phi_{i}^{K}(F_{K}(\\hat{\\boldsymbol{x}})) \\phi_{j}^{K}(F_{K}(\\hat{\\boldsymbol{x}})) \\,|\\det(A)|\\,\\mathrm{d}\\hat{\\boldsymbol{x}} $$\nBy the definition of the pullback, $\\phi_{i}^{K}(F_{K}(\\hat{\\boldsymbol{x}})) = (\\hat{\\phi}_{i} \\circ F_{K}^{-1})(F_{K}(\\hat{\\boldsymbol{x}})) = \\hat{\\phi}_{i}(\\hat{\\boldsymbol{x}})$. The expression simplifies to:\n$$ M^{K}_{ij} = |\\det(A)| \\int_{\\hat{K}} \\hat{\\phi}_{i}(\\hat{\\boldsymbol{x}}) \\hat{\\phi}_{j}(\\hat{\\boldsymbol{x}}) \\,\\mathrm{d}\\hat{\\boldsymbol{x}} = |\\det(A)| \\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_{L^{2}(\\hat{K})} $$\nSince the basis $\\{\\hat{\\phi}_{i}\\}$ is orthonormal, we have $\\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_{L^{2}(\\hat{K})} = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. Therefore, the mass matrix entries are given by $M^{K}_{ij} = |\\det(A)| \\delta_{ij}$. This reveals that the physical mass matrix is a scalar multiple of the identity matrix: $M^K = |\\det(A)| I$. The calculation of these integrals is performed using numerical quadrature.\n\nThird, we justify the quadrature order. The integrals to be computed are $\\int_{\\hat{K}} \\hat{\\phi}_{i} \\hat{\\phi}_{j} \\,\\mathrm{d}\\hat{\\boldsymbol{x}}$. For $k=1$, the basis functions $\\hat{\\phi}_i$ are polynomials of total degree at most $1$. The integrand, $\\hat{\\phi}_{i}(\\hat{\\boldsymbol{x}}) \\hat{\\phi}_{j}(\\hat{\\boldsymbol{x}})$, is therefore a polynomial of total degree at most $1+1=2$. For example, $\\hat{\\phi}_{2}\\hat{\\phi}_{2} = (\\frac{\\sqrt{3}}{2}\\hat{x})^{2} = \\frac{3}{4}\\hat{x}^{2}$, which has degree $2$. A tensor-product Gauss quadrature rule employing $N_p$ points in each coordinate direction can exactly integrate polynomials of degree up to $2N_p - 1$ in each variable separately. To exactly integrate any polynomial of total degree $2$ on the square, we need to ensure the rule is exact for all monomials $\\hat{x}^a \\hat{y}^b$ where $a+b \\le 2$. The highest degree in a single variable is $2$ (from terms like $\\hat{x}^2$ and $\\hat{y}^2$). Therefore, we require the one-dimensional Gauss rule to be exact for polynomials of degree up to $2$. This necessitates $2N_p - 1 \\ge 2$, leading to $2N_p \\ge 3$, or $N_p \\ge 1.5$. Since the number of points $N_p$ must be an integer, we must choose $N_p=2$. A $2$-point Gauss rule in each direction (a $2 \\times 2$ tensor-product rule) is exact for polynomials of degree up to $3$ in each variable, which is sufficient to compute the mass matrix exactly.\n\nFourth, we calculate the determinant of $M^K$ for the specific affine map given by $A = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$. The determinant of $A$ is:\n$$ \\det(A) = (2)(2) - (1)(1) = 4 - 1 = 3 $$\nThe absolute value is $|\\det(A)| = 3$. The dimension of the polynomial space $P^{1}(\\hat{K})$ is $3$, so the mass matrix $M^K$ is a $3 \\times 3$ matrix. As derived above, $M^K = |\\det(A)| I_3$, where $I_3$ is the $3 \\times 3$ identity matrix.\n$$ M^K = 3 \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 3  0  0 \\\\ 0  3  0 \\\\ 0  0  3 \\end{pmatrix} $$\nThe determinant of this matrix is:\n$$ \\det(M^K) = \\det(3 I_3) = 3^3 \\det(I_3) = 27 \\cdot 1 = 27 $$\nThe determinant of the physical-element mass matrix is $27$.", "answer": "$$\\boxed{27}$$", "id": "3372733"}, {"introduction": "Once a spatial discretization is formulated, the crucial question becomes: how do we march the solution forward in time in a stable manner? This exercise delves into the stability analysis of the semi-discrete DG system, a critical skill for any practitioner of time-explicit methods. You will estimate the spectral radius of the DG operator for a 1D advection problem, which directly dictates the maximum allowable time step size through the famous Courant-Friedrichs-Lewy (CFL) condition for a given stable time-stepping scheme [@problem_id:3372693]. This analysis bridges the gap between the spatial discretization parameters, like mesh size $h$ and polynomial degree $k$, and the temporal dynamics of the simulation.", "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ on a periodic interval discretized by a uniform mesh of cell size $h$. Use the discontinuous Galerkin (DG) finite element method with polynomial degree $k$ on each cell, an orthonormal modal basis formed by appropriately scaled Legendre polynomials on the reference element, and the upwind numerical flux. Let the semi-discrete system be written as $U'(t) = \\mathcal{L}\\,U(t)$, where $U(t)$ collects all modal degrees of freedom and $\\mathcal{L}$ is the global DG spatial operator. \n\nStarting from the weak form on each element, and mapping to the reference element, derive the element-level structure of the semi-discrete operator under the upwind flux and show how it assembles into the global operator $\\mathcal{L}$. Using only properties of Legendre polynomials, the exact diagonal mass matrix on each element, and norm-equivalence plus inverse estimates appropriate for polynomials on a uniform mesh, provide a rigorous estimate of the spectral radius $\\rho(\\mathcal{L})$ in terms of $a$, $h$, and $k$. You may use Gershgorin-type arguments and known sharp bounds associated with the differentiation operator in a Legendre polynomial basis to conclude a tight estimate. \n\nThen, invoke the Strong Stability Preserving (SSP) theory for explicit Runge-Kutta (RK) methods. Define Strong Stability Preserving (SSP) Runge-Kutta (RK) as explicit RK methods that preserve a contractive property in a given norm under a forward Euler time-step restriction, with an SSP coefficient determining their allowable time step as a multiple of the forward Euler bound. For the classical three-stage third-order SSP Runge-Kutta method with SSP coefficient $C_{\\mathrm{SSP}} = 1$, derive the Courant-Friedrichs-Lewy (CFL) time-step restriction in terms of $a$, $h$, and $k$. \n\nYour final answer must be a single row matrix containing:\n- an analytic expression for the spectral radius $\\rho(\\mathcal{L})$,\n- and an analytic expression for the maximal stable time step $\\Delta t$ under the chosen SSP Runge-Kutta method.\n\nExpress the time-step bound in seconds if $a$ is provided in meters per second and $h$ in meters. No rounding is required.", "solution": "The problem requires a three-part derivation and analysis concerning the discontinuous Galerkin (DG) method for the one-dimensional linear advection equation. First, we must validate the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **PDE:** $u_{t} + a\\,u_{x} = 0$\n-   **Domain:** One-dimensional periodic interval.\n-   **Discretization:** Discontinuous Galerkin (DG) finite element method.\n-   **Mesh:** Uniform with cell size $h$.\n-   **Polynomial Space:** Polynomials of degree $k$ on each cell.\n-   **Basis:** Orthonormal modal basis on each element, formed by scaled Legendre polynomials on the reference element.\n-   **Numerical Flux:** Upwind numerical flux.\n-   **Semi-discrete System:** $U'(t) = \\mathcal{L}\\,U(t)$, where $U(t)$ is the vector of all modal degrees of freedom and $\\mathcal{L}$ is the global DG spatial operator.\n-   **Task 1:** Derive the element-level structure of $\\mathcal{L}$ and its assembly.\n-   **Task 2:** Estimate the spectral radius $\\rho(\\mathcal{L})$ in terms of $a$, $h$, and $k$, using properties of Legendre polynomials, the diagonal mass matrix, norm-equivalence, inverse estimates, and known sharp bounds for the differentiation operator in a Legendre basis.\n-   **Task 3:** Define Strong Stability Preserving (SSP) Runge-Kutta (RK) methods.\n-   **Task 4:** For the classical three-stage third-order SSP RK method with SSP coefficient $C_{\\mathrm{SSP}} = 1$, derive the Courant-Friedrichs-Lewy (CFL) time-step restriction.\n-   **Final Answer:** A single row matrix containing the analytic expression for $\\rho(\\mathcal{L})$ and the maximal stable time step $\\Delta t$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is firmly rooted in the established theory of numerical analysis for partial differential equations, specifically focusing on the discontinuous Galerkin method, spectral properties of the resulting operators, and stable time integration using SSP Runge-Kutta methods. All concepts are standard in computational fluid dynamics and applied mathematics.\n-   **Well-Posed:** The problem is clearly stated and provides all necessary information to proceed with the derivations. It asks for specific analytical expressions based on a well-defined setup. The use of \"known sharp bounds\" is standard practice in advanced problems, directing the solver to use established, non-trivial results from the literature rather than re-deriving them from first principles.\n-   **Objective:** The language is formal, precise, and devoid of any subjective or ambiguous terminology.\n\nThe problem does not violate any of the invalidity criteria. It is a standard, albeit advanced, problem in the analysis of numerical methods.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nLet the computational domain $\\Omega$ be partitioned into cells $K_j = [x_{j-1/2}, x_{j+1/2}]$ of uniform size $h = x_{j+1/2} - x_{j-1/2}$. The DG finite element space is $V_h = \\{ v \\in L^2(\\Omega) : v|_{K_j} \\in P_k(K_j) \\text{ for each } K_j \\}$, where $P_k(K_j)$ is the space of polynomials of degree at most $k$ on cell $K_j$.\n\n**1. Derivation of the Semi-Discrete Operator $\\mathcal{L}$**\n\nThe weak formulation of the PDE $u_t + a u_x = 0$ on an element $K_j$ is obtained by multiplying by a test function $v_h \\in V_h$ and integrating over $K_j$:\n$$ \\int_{K_j} (u_h)_t v_h \\, dx + \\int_{K_j} a (u_h)_x v_h \\, dx = 0 $$\nIntegrating the second term by parts yields:\n$$ \\int_{K_j} (u_h)_t v_h \\, dx - a \\int_{K_j} u_h (v_h)_x \\, dx + a [u_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0 $$\nThe boundary term is written using one-sided limits from within $K_j$:\n$$ [u_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} = u_h(x_{j+1/2}^-) v_h(x_{j+1/2}^-) - u_h(x_{j-1/2}^+) v_h(x_{j-1/2}^+) $$\nIn the DG method, the function $u_h$ at cell interfaces is replaced by a numerical flux, denoted $\\hat{u}$. The formulation becomes:\n$$ \\int_{K_j} (u_h)_t v_h \\, dx = a \\int_{K_j} u_h (v_h)_x \\, dx - a [\\hat{u} v_h]_{\\partial K_j} $$\nwhere $[\\hat{u} v_h]_{\\partial K_j} = \\hat{u}(x_{j+1/2}) v_h(x_{j+1/2}^-) - \\hat{u}(x_{j-1/2}) v_h(x_{j-1/2}^+)$.\nThe problem specifies the upwind flux. For $a>0$, information propagates from left to right, so the flux at an interface is determined by the value from the upwind (left) cell:\n$$ \\hat{u}(x_{j+1/2}) = u_h(x_{j+1/2}^-) \\quad \\text{and} \\quad \\hat{u}(x_{j-1/2}) = u_h(x_{j-1/2}^-) $$\nThe term $u_h(x_{j-1/2}^-)$ is the value of the solution from cell $K_{j-1}$ at the interface.\n\nOn each cell $K_j$, we expand the solution $u_h(x,t)$ in an orthonormal basis $\\{\\phi_l(x)\\}_{l=0}^k$.\n$$ u_h(x,t)|_{K_j} = \\sum_{l=0}^k u_{j,l}(t) \\phi_l(x) $$\nThe basis functions are scaled Legendre polynomials. The reference element is $\\hat{K} = [-1, 1]$. An orthonormal basis on $\\hat{K}$ for the standard $L^2$ inner product is $\\{\\hat{\\phi}_l(\\xi) = \\sqrt{(2l+1)/2} P_l(\\xi)\\}_{l=0}^k$. The physical basis functions $\\phi_l(x)$ are related to $\\hat{\\phi}_l(\\xi)$ by a mapping $x(\\xi) = x_j + (h/2)\\xi$ and scaling to ensure orthonormality on $K_j$: $\\int_{K_j} \\phi_l \\phi_m dx = \\delta_{lm}$. This scaling is $\\phi_l(x) = (1/\\sqrt{h/2})\\hat{\\phi}_l(\\xi(x))$.\nWith an orthonormal basis, the element mass matrix $M_{ml}^{(j)} = \\int_{K_j} \\phi_l \\phi_m dx = \\delta_{lm}$ is the identity matrix.\n\nSubstituting the expansion of $u_h$ into the weak form and using $v_h = \\phi_m$ gives the equation for the $m$-th degree of freedom in cell $j$:\n$$ \\frac{d u_{j,m}}{dt} = a \\sum_{l=0}^k u_{j,l} \\int_{K_j} \\phi_l (\\phi_m)_x dx - a\\left( \\big(\\sum_{l=0}^k u_{j,l} \\phi_l(x_{j+1/2})\\big) \\phi_m(x_{j+1/2}) - \\big(\\sum_{l=0}^k u_{j-1,l} \\phi_l(x_{j-1/2})\\big) \\phi_m(x_{j-1/2}) \\right) $$\nHere, the term with $u_{j-1,l}$ represents the contribution from the upwind cell $K_{j-1}$ evaluated at its right boundary, which couples to cell $K_j$ at its left boundary.\nMapping to the reference element $\\hat{K}$, we have $(\\phi_m)_x = (2/h)(\\hat{\\phi}_m)_\\xi$ and $dx = (h/2)d\\xi$. The equation for the coefficients $U_j = (u_{j,0}, \\dots, u_{j,k})^T$ of cell $j$ becomes (for $a>0$):\n$$ \\frac{dU_j}{dt} = \\mathcal{L}_{jj} U_j + \\mathcal{L}_{j,j-1} U_{j-1} $$\nwhere $\\mathcal{L}_{jj}$ and $\\mathcal{L}_{j,j-1}$ are $(k+1) \\times (k+1)$ matrices representing the intra-element and inter-element contributions, respectively. The global operator $\\mathcal{L}$ is a block matrix composed of these element-level operators. For a periodic domain, $\\mathcal{L}$ is a block circulant matrix.\n\n**2. Spectral Radius Estimate of $\\mathcal{L}$**\n\nThe spectrum of a block circulant matrix is the union of the spectra of smaller matrices formed by Fourier decomposition. The eigenvalues of $\\mathcal{L}$ are the collection of eigenvalues of $\\Lambda(\\theta) = \\mathcal{L}_{jj} + e^{-i\\theta} \\mathcal{L}_{j,j-1}$ for $\\theta \\in [0, 2\\pi)$. A detailed analysis of these matrices is complex, but the problem allows the use of \"known sharp bounds\".\n\nFor the 1D linear advection equation discretized with the DG method of degree $k$ using an orthonormal Legendre basis and an upwind flux, the spectral radius of the semi-discrete operator $\\mathcal{L}$ has been rigorously established. This sharp bound is:\n$$ \\rho(\\mathcal{L}) = \\frac{|a|(2k+1)}{h} $$\nThis result arises from a careful spectral analysis of the operator, which shows that the maximum magnitude of the eigenvalues (which determines the spectral radius) scales linearly with the polynomial degree $k$ and inversely with the mesh size $h$.\n\n**3. CFL Time-Step Restriction for SSP-RK Method**\n\nThe problem asks for the time-step restriction for an explicit SSP Runge-Kutta method. The defining property of an SSP method is that it preserves the contractive property of the forward Euler method.\nThe semi-discrete system is $U'(t) = \\mathcal{L}U(t)$. For the forward Euler method, $U^{n+1} = U^n + \\Delta t \\mathcal{L}U^n$, to be contractive in the $L^2$-norm (i.e., $\\|U^{n+1}\\|_2 \\le \\|U^n\\|_2$), the spectrum of the amplification operator, $\\sigma(I+\\Delta t \\mathcal{L})$, must lie within the unit disk in the complex plane. This means $|1+\\Delta t \\lambda| \\le 1$ for all eigenvalues $\\lambda \\in \\sigma(\\mathcal{L})$.\nFor the DG operator with upwind flux, it is known that all eigenvalues have non-positive real parts, $\\Re(\\lambda) \\le 0$. The condition $|1+\\Delta t \\lambda| \\le 1$ for $\\lambda = x+iy$ with $x \\le 0$ translates to:\n$$ \\Delta t \\le \\frac{-2\\Re(\\lambda)}{|\\lambda|^2} $$\nThis must hold for all eigenvalues, so the forward Euler time-step limit is:\n$$ \\Delta t_{FE} = \\min_{\\lambda \\in \\sigma(\\mathcal{L}), \\lambda \\ne 0} \\frac{-2\\Re(\\lambda)}{|\\lambda|^2} $$\nAn SSP-RK method with SSP coefficient $C_{\\mathrm{SSP}}$ is contractive for a time step $\\Delta t_{RK} \\le C_{\\mathrm{SSP}} \\Delta t_{FE}$.\nThe problem specifies the classical 3-stage, 3rd-order SSP-RK method with an SSP coefficient $C_{\\mathrm{SSP}} = 1$. Therefore, its maximum stable time step is identical to the forward Euler limit:\n$$ \\Delta t = \\Delta t_{FE} $$\nFor the specific DG operator considered, this minimum value is also a known sharp result from the literature, related to the structure of the eigenvalue spectrum. It is given by:\n$$ \\min_{\\lambda \\in \\sigma(\\mathcal{L}), \\lambda \\ne 0} \\frac{-2\\Re(\\lambda)}{|\\lambda|^2} = \\frac{h}{|a|(2k+1)} $$\nThis specific value indicates how the stability-limiting eigenvalues are positioned within the complex plane.\nCombining these results, the maximum stable time step is:\n$$ \\Delta t = 1 \\cdot \\Delta t_{FE} = \\frac{h}{|a|(2k+1)} $$\nThe units are consistent: if $h$ is in meters and $a$ is in m/s, $\\Delta t$ is in seconds.\n\nWe have derived the two required expressions: the spectral radius $\\rho(\\mathcal{L})$ and the maximal stable time step $\\Delta t$.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{|a|(2k+1)}{h}  \\frac{h}{|a|(2k+1)} \\end{pmatrix} } $$", "id": "3372693"}, {"introduction": "While high-order methods like DG excel in smooth regions, they famously produce non-physical oscillations near sharp gradients or discontinuities, which are common in hyperbolic conservation laws. This practice introduces one of the most important practical tools for making DG schemes robust for real-world applications: the slope limiter. You will derive and apply a Total Variation Boundedness (TVB) limiter, learning how to selectively reduce the order of the solution in \"troubled\" cells to maintain physical realism without sacrificing accuracy elsewhere [@problem_id:3372706]. This is a vital technique for simulating phenomena such as shock waves in computational fluid dynamics.", "problem": "Consider the scalar one-dimensional hyperbolic conservation law $u_{t} + f(u)_{x} = 0$ on a uniform mesh with cell width $h$, discretized by the Discontinuous Galerkin (DG) finite element method with piecewise polynomials of degree $k$ in each cell. Let each cell $I_{i}$ be mapped affinely to the reference interval $\\xi \\in [-1,1]$ via $\\xi = \\frac{2}{h}(x-x_{i})$, and represent the solution in $I_{i}$ by a modal expansion in Legendre polynomials, $u_{h}\\big|_{I_{i}}(\\xi) = \\sum_{m=0}^{k} \\hat{u}_{i,m} P_{m}(\\xi)$, where $\\hat{u}_{i,0} = \\bar{u}_{i}$ is the cell average. Limiting is required to enforce physically relevant boundedness of oscillations and to control total variation growth near discontinuities while maintaining high-order accuracy in smooth regions.\n\nStarting from the concepts of Total Variation Boundedness (TVB) and the structure of DG reconstructions, derive a one-dimensional TVB slope limiter that modifies the linear content of the polynomial in cell $I_{i}$ by comparing the reconstructed slope against neighbor-based secant slopes and employing a TVB-modified minmod operator. Explicitly:\n- Derive a TVB minmod operator that protects smooth extrema by introducing a tolerance governed by a TVB parameter $M$, and explain the scaling of this tolerance with the mesh size $h$ arising from Taylor expansions of smooth functions.\n- Formulate a smoothness indicator built from second differences of cell averages, scaled by $h^{2}$, that activates limiting only in the presence of steep gradients.\n- Show how to map the limited slope back to the linear modal coefficient $\\hat{u}_{i,1}$ in the Legendre basis on $[-1,1]$.\n\nThen, for the concrete case of degree $k=2$ with Legendre basis in cell $I_{i}$, take the numerical data\n$\\bar{u}_{i-1} = 1.0$, $\\bar{u}_{i} = 1.2$, $\\bar{u}_{i+1} = 1.5$, $h = 0.2$, $\\hat{u}_{i,1} = 0.25$, $\\hat{u}_{i,2} = -0.05$, and TVB parameter $M = 0.5$. Using your derived limiter and smoothness indicator, compute the limited linear modal coefficient $\\hat{u}_{i,1}^{\\text{new}}$. Express the final answer as a pure number with no units, and do not round unless necessary.", "solution": "The problem requires the derivation of a one-dimensional Total Variation Boundedness (TVB) slope limiter for a Discontinuous Galerkin (DG) method and its application to a concrete numerical case. The validation process confirms that the problem is scientifically grounded, well-posed, and objective. We may proceed with the solution.\n\nThe solution is structured as follows:\n1.  Derivation of the TVB slope limiter, including the TVB-modified minmod operator and its scaling.\n2.  Formulation of a smoothness indicator to selectively apply the limiter.\n3.  Explanation of the relationship between the physical slope and the modal Legendre coefficient.\n4.  Application of the derived limiter and indicator to the provided numerical data.\n\n### Part 1: Derivation of the TVB Slope Limiter\n\nA slope limiter for a DG method aims to control the slope of the polynomial reconstruction within each cell $I_i = [x_i - h/2, x_i + h/2]$ to prevent spurious oscillations near discontinuities. This is achieved by modifying the modal coefficients of the polynomial representation, $u_h\\big|_{I_i}(\\xi) = \\sum_{m=0}^{k} \\hat{u}_{i,m} P_{m}(\\xi)$, where $\\xi = \\frac{2}{h}(x-x_i)$ is the coordinate on the reference element $[-1, 1]$.\n\nThe \"slope\" of the solution is primarily determined by the linear content of the polynomial. The Legendre basis polynomials are $P_0(\\xi)=1$ and $P_1(\\xi)=\\xi$. The linear part of the reconstruction in cell $I_i$ is $u_h^{lin}(x) = \\hat{u}_{i,0}P_0(\\xi) + \\hat{u}_{i,1}P_1(\\xi) = \\bar{u}_i + \\hat{u}_{i,1}\\xi$.\n\nThe physical slope of this linear part is constant throughout the cell:\n$$ s_i = \\frac{d}{dx} u_h^{lin}(x) = \\frac{d}{d\\xi}(\\bar{u}_i + \\hat{u}_{i,1}\\xi) \\frac{d\\xi}{dx} = \\hat{u}_{i,1} \\cdot \\frac{2}{h} $$\nThis shows a direct relationship between the physical slope $s_i$ and the linear modal coefficient $\\hat{u}_{i,1}$. A limiter acting on the slope $s_i$ is equivalent to one acting on the coefficient $\\hat{u}_{i,1}$. We will formulate the limiter in terms of $\\hat{u}_{i,1}$ for consistency with standard literature, which simplifies comparisons.\n\nThe limiter compares the internal \"slope\" information, represented by $\\hat{u}_{i,1}$, against \"slope\" information from neighboring cell averages. The term $\\hat{u}_{i,1}$ represents the change in the solution from the cell center to the cell boundary on the reference element, i.e., $u_h^{lin}(\\xi=1) - u_h^{lin}(\\xi=0) = \\hat{u}_{i,1}$. For comparison, we use half the difference of neighboring cell averages, which corresponds to an average change over a distance of $h/2$:\n-   Forward difference comparator: $\\frac{1}{2}(\\bar{u}_{i+1} - \\bar{u}_i)$\n-   Backward difference comparator: $\\frac{1}{2}(\\bar{u}_i - \\bar{u}_{i-1})$\n\nThe limited coefficient, $\\hat{u}_{i,1}^{\\text{new}}$, is obtained using a TVB-modified minmod operator:\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\text{minmod}_{TVB} \\left( \\hat{u}_{i,1}, \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{2}, \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{2} \\right) $$\n\nThe TVB-modified minmod operator, $\\text{minmod}_{TVB}$, is defined as:\n$$ \\text{minmod}_{TVB}(a, b, c) = \\begin{cases} a,  \\text{if } |a| \\le M h^2 \\\\ \\text{minmod}(a, b, c),  \\text{otherwise} \\end{cases} $$\nwhere $\\text{minmod}(a,b,c)$ is the standard minmod function, which returns the argument with the smallest magnitude if all arguments have the same sign, and zero otherwise.\n\nThe tolerance $M h^2$ is crucial for protecting smooth extrema from being flattened. For a smooth function $u(x)$, consider a Taylor expansion around a local extremum $x_c$. For a cell $I_i$ near this extremum, the deviation of the function value from the cell average, $u(x)-\\bar{u}_i$, can be shown to be of order $O(h^2)$. For instance, for $u(x) = c(x-x_c)^2$, the deviation at the cell boundaries $x_i \\pm h/2$ is $O(h^2)$. The DG modal coefficient $\\hat{u}_{i,1}$ is a high-order approximation to the projection of the solution's linear content; at a symmetric extremum ($x_c=x_i$), $\\hat{u}_{i,1}$ would be zero. More generally, near an extremum, $\\hat{u}_{i,1}$ is of order $O(h^2)$ or smaller. By setting a tolerance of $Mh^2$, we specify that if the \"slope\" coefficient $\\hat{u}_{i,1}$ is already small enough to be consistent with a smooth extremum, it should not be modified. The TVB parameter $M$ is a user-defined constant, often chosen proportional to an estimate of the maximum expected second derivative of the solution, $\\max|u_{xx}|$.\n\n### Part 2: Smoothness Indicator\n\nApplying the limiter everywhere can degrade accuracy in smooth regions. A smoothness indicator is used to activate limiting only in \"troubled\" cells, i.e., those near steep gradients or discontinuities.\n\nA robust indicator can be built from the second difference of cell averages: $\\Delta^2_i \\bar{u} = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}$.\nFor a smooth function, a Taylor series expansion shows that $\\Delta^2_i \\bar{u} \\approx u''(x_i) h^2$. Thus, this quantity is of order $O(h^2)$ in smooth regions. Near a discontinuity, however, the second difference is much larger, typically of order $O(h)$.\n\nThis difference in scaling allows us to formulate a simple and effective indicator. We can compare $|\\Delta^2_i \\bar{u}|$ to the same TVB tolerance, $Mh^2$, that is used to protect extrema. A cell $I_i$ is flagged as troubled, and limiting is applied, if the local curvature estimated from cell averages exceeds this threshold:\n$$ \\text{Activate Limiter if: } |\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}| > M h^2 $$\nThis condition links the limiter's activation to its operating principle: limiting is applied when the local behavior of the cell averages is inconsistent with the assumption of a smooth extremum characterized by the parameter $M$.\n\n### Part 3: Mapping Between Slope and Coefficient\n\nAs established in Part 1, the physical slope of the linear reconstruction, $s_i$, is directly proportional to the modal coefficient $\\hat{u}_{i,1}$:\n$$ s_i = \\frac{2 \\hat{u}_{i,1}}{h} $$\nIf we compute a limited slope $s_i^{\\text{new}}$, the corresponding new modal coefficient is found by inverting this relationship:\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\frac{h}{2} s_i^{\\text{new}} $$\nOur chosen formulation, which limits $\\hat{u}_{i,1}$ directly, incorporates this mapping implicitly. The comparison quantities $(\\bar{u}_{i+1} - \\bar{u}_i)/2$ and $(\\bar{u}_i - \\bar{u}_{i-1})/2$ are equivalent to scaling the secant slopes $\\sigma_F = (\\bar{u}_{i+1} - \\bar{u}_i)/h$ and $\\sigma_B = (\\bar{u}_i - \\bar{u}_{i-1})/h$ by $h/2$.\n\n### Part 4: Numerical Calculation\n\nWe apply the derived procedure to the given data:\n- Cell averages: $\\bar{u}_{i-1} = 1.0$, $\\bar{u}_{i} = 1.2$, $\\bar{u}_{i+1} = 1.5$.\n- Cell width: $h = 0.2$.\n- Initial modal coefficients: $\\hat{u}_{i,1} = 0.25$, $\\hat{u}_{i,2} = -0.05$.\n- TVB parameter: $M = 0.5$.\n\n**Step 1: Check the smoothness indicator.**\nFirst, we compute the second difference of cell averages:\n$$ \\Delta^2_i \\bar{u} = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1} = 1.5 - 2(1.2) + 1.0 = 1.5 - 2.4 + 1.0 = 0.1 $$\nNext, we compute the threshold for the indicator:\n$$ M h^2 = 0.5 \\times (0.2)^2 = 0.5 \\times 0.04 = 0.02 $$\nWe compare the absolute value of the second difference to this threshold:\n$$ |\\Delta^2_i \\bar{u}| = |0.1| = 0.1 $$\nSince $0.1 > 0.02$, the condition $|\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}| > M h^2$ is met. Therefore, the limiter must be activated for cell $I_i$.\n\n**Step 2: Apply the TVB slope limiter.**\nWe compute the arguments for the $\\text{minmod}_{TVB}$ function:\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\text{minmod}_{TVB}(a, b, c) $$\n- The coefficient to be limited: $a = \\hat{u}_{i,1} = 0.25$.\n- The forward difference comparator: $b = \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{2} = \\frac{1.5 - 1.2}{2} = \\frac{0.3}{2} = 0.15$.\n- The backward difference comparator: $c = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{2} = \\frac{1.2 - 1.0}{2} = \\frac{0.2}{2} = 0.1$.\n\nNow, we evaluate the $\\text{minmod}_{TVB}$ operator. First, check the tolerance condition: Is $|a| \\le M h^2$?\n$$ |0.25| \\le 0.02 $$\nThis is false. The coefficient is too large to be considered part of a smooth extremum under the given tolerance. Thus, we proceed to apply the standard `minmod` function:\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\text{minmod}(0.25, 0.15, 0.1) $$\nAll arguments are positive. The standard minmod function for positive arguments returns the minimum value:\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\min(0.25, 0.15, 0.1) = 0.1 $$\n\nThe limited linear modal coefficient is $0.1$. The problem only asks for the new linear coefficient $\\hat{u}_{i,1}^{\\text{new}}$. Depending on the specific limiter implementation, the quadratic coefficient $\\hat{u}_{i,2}$ might be set to zero or left unchanged. Following the prompt, we only provide the result for $\\hat{u}_{i,1}$.", "answer": "$$\\boxed{0.1}$$", "id": "3372706"}]}