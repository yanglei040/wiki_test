{"hands_on_practices": [{"introduction": "A cornerstone of the ILES philosophy is that the convective transport term in the discrete Navier-Stokes equations should ideally conserve kinetic energy, leaving dissipation to other mechanisms, whether physical or numerical. This exercise provides a fundamental look into this property by guiding you through a semi-discrete analysis of a finite volume scheme. By deriving the kinetic energy balance from first principles, you will determine the specific interpolation strategy that prevents the convective term from spuriously generating or destroying kinetic energy, a crucial property for a stable and physically meaningful simulation [@problem_id:3333512].", "problem": "Consider an Implicit Large-Eddy Simulation (ILES) of an incompressible, constant-density flow, discretized by the collocated-cell Finite Volume Method (FVM) on a uniform Cartesian mesh with triply-periodic boundary conditions. The unknown velocity field is stored at cell centers. Let each control volume be denoted by an index $P$ with volume $\\Delta \\Omega_{P}$ and cell-centered velocity $\\boldsymbol{u}_{P}(t)$. Each interior face $f$ connects a pair of neighboring cells $(P,N)$ and has outward area vector $\\boldsymbol{S}_{f}$ measured with respect to cell $P$, so that the same face has area vector $-\\boldsymbol{S}_{f}$ with respect to cell $N$. The constant density is $\\rho$, and the dynamic viscosity is $\\mu$.\n\nThe semi-discrete momentum balance in each cell $P$ is obtained by integrating the incompressible Navier–Stokes equations over the control volume and applying the divergence theorem to each flux term. The convective flux of momentum through face $f$ is represented by the mass flux $m_{f}$ multiplied by an interpolated face velocity $\\boldsymbol{u}_{f}$. The mass flux through face $f$ as seen from cell $P$ is $m_{f} = \\rho\\,\\boldsymbol{u}_{f}\\cdot\\boldsymbol{S}_{f}$, and the same face as seen from cell $N$ has mass flux $-m_{f}$. The face-velocity interpolation is defined by a single parameter $\\alpha \\in [0,1]$ via\n$$\n\\boldsymbol{u}_{f}(\\alpha) = \\alpha\\,\\boldsymbol{u}_{P} + (1-\\alpha)\\,\\boldsymbol{u}_{N}.\n$$\nAssume that the discrete continuity equation is enforced in the usual face-flux form,\n$$\n\\sum_{f\\in \\partial \\Omega_{P}} m_{f} = 0 \\quad \\text{for every cell } P,\n$$\nand that pressure is discretized with a centered, face-based gradient such that the discrete gradient and divergence operators form a summation-by-parts pair under the standard FVM inner product. Viscous fluxes are discretized with symmetric, centered differences that yield a nonnegative quadratic form for the viscous dissipation.\n\nStarting from the above fundamental laws and definitions, derive the semi-discrete kinetic energy balance for the global kinetic energy\n$$\nK(t) = \\sum_{P} \\Delta \\Omega_{P}\\,\\frac{\\rho}{2}\\,|\\boldsymbol{u}_{P}(t)|^{2}.\n$$\nExplicitly identify the contributions of the convective, pressure, and viscous terms to $\\mathrm{d}K/\\mathrm{d}t$, and express the convective contribution in terms of face pairs $(P,N)$, the mass flux $m_{f}$, and the interpolation parameter $\\alpha$. Then, determine the value of $\\alpha$ for which the convective contribution reduces exactly to a telescoping boundary transport of kinetic energy, with no interior production or destruction, so that under triply-periodic boundary conditions there is no spurious kinetic energy production from convection. Provide the final value of $\\alpha$ as your answer. No rounding is required. Your answer must be a single real number without units.", "solution": "The analysis begins with an examination of the problem statement to ensure its validity.\n\n### Step 1: Extract Givens\n- **Flow:** Incompressible, constant-density, Implicit Large-Eddy Simulation (ILES).\n- **Discretization:** Collocated-cell Finite Volume Method (FVM) on a uniform Cartesian mesh.\n- **Boundary Conditions:** Triply-periodic.\n- **Variables:** Cell-centered velocity $\\boldsymbol{u}_{P}(t)$ in control volume $\\Delta \\Omega_{P}$.\n- **Constants:** Density $\\rho$, dynamic viscosity $\\mu$.\n- **Face Geometry:** A face $f$ connects cells $P$ and $N$. Its area vector is $\\boldsymbol{S}_{f}$ pointing outwards from $P$.\n- **Semi-discrete Momentum Equation:** Derived from integrating the Navier-Stokes equations over $\\Delta \\Omega_{P}$.\n- **Mass Flux:** The mass flux through face $f$ is $m_{f} = \\rho\\,\\boldsymbol{u}_{f}\\cdot\\boldsymbol{S}_{f}$.\n- **Face Velocity Interpolation:** $\\boldsymbol{u}_{f}(\\alpha) = \\alpha\\,\\boldsymbol{u}_{P} + (1-\\alpha)\\,\\boldsymbol{u}_{N}$, with $\\alpha \\in [0,1]$.\n- **Discrete Continuity:** $\\sum_{f\\in \\partial \\Omega_{P}} m_{f} = 0$ for every cell $P$.\n- **Pressure-Gradient and Divergence:** The discrete operators form a summation-by-parts pair.\n- **Viscous Term:** Discretized using symmetric, centered differences, yielding a nonnegative quadratic form for viscous dissipation.\n- **Global Kinetic Energy:** $K(t) = \\sum_{P} \\Delta \\Omega_{P}\\,\\frac{\\rho}{2}\\,|\\boldsymbol{u}_{P}(t)|^{2}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, situated in the well-established field of Computational Fluid Dynamics. It is well-posed, objective, and self-contained, providing all necessary definitions and constraints to derive a unique solution for the parameter $\\alpha$. The premises, such as the form of the FVM equations and operator properties, are standard in the literature. The problem is formalizable and asks for a rigorous mathematical derivation. It is not trivial, as it requires careful algebraic manipulation and understanding of the conservation properties of numerical schemes. There are no contradictions, ambiguities, or factual unsoundness.\n\n### Step-3: Verdict and Action\nThe problem is deemed valid. A full, reasoned solution will be provided.\n\n### Derivation of the Semi-Discrete Kinetic Energy Balance\n\nThe semi-discrete momentum equation for a cell $P$ is obtained by integrating the Navier-Stokes equations over the control volume $\\Delta\\Omega_P$. For a constant density $\\rho$, this is:\n$$\n\\Delta\\Omega_P \\rho \\frac{\\mathrm{d}\\boldsymbol{u}_P}{\\mathrm{d}t} = -\\sum_{f \\in \\partial\\Omega_P} (\\rho \\boldsymbol{u}_f \\otimes \\boldsymbol{u}_f) \\cdot \\boldsymbol{S}_f - \\sum_{f \\in \\partial\\Omega_P} p_f \\boldsymbol{S}_f + \\sum_{f \\in \\partial\\Omega_P} \\boldsymbol{\\tau}_f \\cdot \\boldsymbol{S}_f\n$$\nUsing the definition of mass flux, $m_f = \\rho \\boldsymbol{u}_f \\cdot \\boldsymbol{S}_f$, the convective term can be written as $\\sum_{f \\in \\partial\\Omega_P} m_f \\boldsymbol{u}_f$. The momentum equation for cell $P$ is thus:\n$$\n\\Delta\\Omega_P \\rho \\frac{\\mathrm{d}\\boldsymbol{u}_P}{\\mathrm{d}t} = -\\sum_{f \\in \\partial\\Omega_P} m_f \\boldsymbol{u}_f - \\sum_{f \\in \\partial\\Omega_P} p_f \\boldsymbol{S}_f + \\boldsymbol{V}_P\n$$\nwhere $\\boldsymbol{V}_P$ represents the net viscous force on the cell.\n\nThe kinetic energy in cell $P$ is $K_P(t) = \\Delta \\Omega_{P}\\,\\frac{\\rho}{2}\\,|\\boldsymbol{u}_{P}(t)|^{2}$. Its time derivative is:\n$$\n\\frac{\\mathrm{d}K_P}{\\mathrm{d}t} = \\Delta \\Omega_{P}\\,\\rho\\,\\boldsymbol{u}_P \\cdot \\frac{\\mathrm{d}\\boldsymbol{u}_P}{\\mathrm{d}t} = \\boldsymbol{u}_P \\cdot \\left(\\Delta\\Omega_P \\rho \\frac{\\mathrm{d}\\boldsymbol{u}_P}{\\mathrm{d}t}\\right)\n$$\nSubstituting the momentum equation:\n$$\n\\frac{\\mathrm{d}K_P}{\\mathrm{d}t} = \\boldsymbol{u}_P \\cdot \\left( -\\sum_{f \\in \\partial\\Omega_P} m_f \\boldsymbol{u}_f \\right) + \\boldsymbol{u}_P \\cdot \\left( -\\sum_{f \\in \\partial\\Omega_P} p_f \\boldsymbol{S}_f \\right) + \\boldsymbol{u}_P \\cdot \\boldsymbol{V}_P\n$$\nThe rate of change of the global kinetic energy $K(t) = \\sum_P K_P(t)$ is found by summing over all cells $P$:\n$$\n\\frac{\\mathrm{d}K}{\\mathrm{d}t} = \\sum_P \\frac{\\mathrm{d}K_P}{\\mathrmd t} = T_C + T_P + T_V\n$$\nwhere $T_C$, $T_P$, and $T_V$ are the total contributions from convection, pressure, and viscous terms, respectively.\n\n**Contribution of the Pressure Term ($T_P$)**\nThe pressure term is $T_P = \\sum_P \\boldsymbol{u}_P \\cdot \\left( -\\sum_{f \\in \\partial\\Omega_P} p_f \\boldsymbol{S}_f \\right)$. The problem states that the discrete divergence ($D$) and gradient ($G$) operators form a summation-by-parts pair. Let the FVM inner product be $\\langle \\boldsymbol{a}, \\boldsymbol{b} \\rangle = \\sum_P \\Delta\\Omega_P \\boldsymbol{a}_P \\cdot \\boldsymbol{b}_P$. The summation-by-parts property, for periodic boundary conditions, is $\\langle \\boldsymbol{v}, G\\phi \\rangle = - \\langle D\\boldsymbol{v}, \\phi \\rangle$.\nThe pressure term can be written as $T_P = -\\langle \\boldsymbol{u}, Gp \\rangle$. Using the property, this becomes $T_P = \\langle Du, p \\rangle$.\nThe discrete divergence of the velocity field, consistent with the continuity equation, is $(D\\boldsymbol{u})_P = \\frac{1}{\\Delta\\Omega_P \\rho} \\sum_{f \\in \\partial\\Omega_P} \\rho \\boldsymbol{u}_f \\cdot \\boldsymbol{S}_f = \\frac{1}{\\Delta\\Omega_P \\rho} \\sum_{f \\in \\partial\\Omega_P} m_f$.\nThe discrete continuity equation is given as $\\sum_{f \\in \\partial\\Omega_P} m_f = 0$ for all $P$. Therefore, $(D\\boldsymbol{u})_P = 0$ for all $P$.\nThis implies that $T_P = \\sum_P \\Delta\\Omega_P (Du)_P p_P = 0$. The pressure term does no net work on the system.\n\n**Contribution of the Viscous Term ($T_V$)**\nThe viscous term is $T_V = \\sum_P \\boldsymbol{u}_P \\cdot \\boldsymbol{V}_P$. The problem states that the viscous discretization yields a nonnegative quadratic form for viscous dissipation. Viscous dissipation is defined as $\\epsilon = -T_V$. The condition is thus $\\epsilon \\ge 0$, which means $T_V \\le 0$. This term represents the irreversible conversion of kinetic energy into internal energy.\n\n**Contribution of the Convective Term ($T_C$)**\nThe total convective contribution is $T_C = \\sum_P \\left( -\\boldsymbol{u}_P \\cdot \\sum_{f \\in \\partial\\Omega_P} m_f \\boldsymbol{u}_f \\right)$. We can change the order of summation from summing over cells then faces to summing over all unique faces. Each interior face $f$ is shared by two cells, $P$ and $N$. The mass flux from $P$'s perspective is $m_f$, and from $N$'s perspective is $m_{f,N} = \\rho \\boldsymbol{u}_f \\cdot (-\\boldsymbol{S}_f) = -m_f$.\n$$\nT_C = -\\sum_{f(P,N)} \\left( \\boldsymbol{u}_P \\cdot (m_f \\boldsymbol{u}_f) + \\boldsymbol{u}_N \\cdot (m_{f,N} \\boldsymbol{u}_f) \\right) = -\\sum_{f(P,N)} (\\boldsymbol{u}_P \\cdot m_f \\boldsymbol{u}_f - \\boldsymbol{u}_N \\cdot m_f \\boldsymbol{u}_f)\n$$\n$$\nT_C = \\sum_{f(P,N)} m_f (\\boldsymbol{u}_N - \\boldsymbol{u}_P) \\cdot \\boldsymbol{u}_f\n$$\nNow, substitute the interpolation for $\\boldsymbol{u}_f = \\alpha \\boldsymbol{u}_P + (1-\\alpha)\\boldsymbol{u}_N$. A useful identity is $(b-a) \\cdot (\\alpha a + (1-\\alpha)b) = \\frac{1}{2}(|b|^2-|a|^2) - (\\alpha-\\frac{1}{2})|b-a|^2$.\nLetting $\\boldsymbol{a} = \\boldsymbol{u}_P$ and $\\boldsymbol{b} = \\boldsymbol{u}_N$, we have:\n$$\n(\\boldsymbol{u}_N - \\boldsymbol{u}_P) \\cdot \\boldsymbol{u}_f = \\frac{1}{2}(|\\boldsymbol{u}_N|^2 - |\\boldsymbol{u}_P|^2) - \\left(\\alpha - \\frac{1}{2}\\right)|\\boldsymbol{u}_N - \\boldsymbol{u}_P|^2\n$$\nSubstituting this into the expression for $T_C$:\n$$\nT_C = \\sum_{f} m_f \\left[ \\frac{1}{2}(|\\boldsymbol{u}_N|^2 - |\\boldsymbol{u}_P|^2) \\right] - \\sum_{f} m_f \\left(\\alpha - \\frac{1}{2}\\right)|\\boldsymbol{u}_N - \\boldsymbol{u}_P|^2\n$$\nLet's analyze the first term, $T_{C,1} = \\sum_{f} m_f \\frac{1}{2}(|\\boldsymbol{u}_N|^2 - |\\boldsymbol{u}_P|^2) = \\sum_f m_f (E_N - E_P)$, where $E_P = \\frac{1}{2}|\\boldsymbol{u}_P|^2$.\nWe can prove that this term is identically zero. Consider the sum $\\sum_P E_P \\left( \\sum_{f \\in \\partial\\Omega_P} m_f \\right)$. By the discrete continuity equation, this sum is zero.\n$$\n0 = \\sum_P E_P \\left( \\sum_{f \\in \\partial\\Omega_P} m_f \\right) = \\sum_P \\sum_{f \\in \\partial\\Omega_P} E_P m_f\n$$\nChanging the order of summation to be over unique faces:\n$$\n0 = \\sum_{f(P,N)} (E_P m_f + E_N m_{f,N}) = \\sum_{f(P,N)} (E_P m_f - E_N m_f) = \\sum_f m_f (E_P - E_N)\n$$\nThis shows that $\\sum_f m_f (E_P - E_N) = 0$. Therefore, $T_{C,1} = \\sum_f m_f (E_N - E_P) = - \\sum_f m_f(E_P - E_N) = 0$.\n\nThe convective contribution to the kinetic energy budget simplifies to:\n$$\nT_C = - \\left(\\alpha - \\frac{1}{2}\\right) \\sum_{f} m_f |\\boldsymbol{u}_N - \\boldsymbol{u}_P|^2\n$$\nThe problem states that for a specific value of $\\alpha$, the convective contribution should reduce to a telescoping boundary transport. For a domain with periodic boundary conditions, such a transport term evaluates to zero. This means there is no spurious production or destruction of kinetic energy from the convective term in the interior of the domain. For this to be true, we must have $T_C = 0$.\nThe sum $\\sum_{f} m_f |\\boldsymbol{u}_N - \\boldsymbol{u}_P|^2$ is not zero for a general flow. Therefore, for $T_C$ to be zero for any arbitrary flow field, the coefficient must be zero:\n$$\n\\alpha - \\frac{1}{2} = 0 \\implies \\alpha = \\frac{1}{2}\n$$\nThis value of $\\alpha$ corresponds to a centered interpolation for the face velocity, $\\boldsymbol{u}_f = \\frac{1}{2}(\\boldsymbol{u}_P + \\boldsymbol{u}_N)$, which makes the semi-discrete convective operator skew-symmetric and thus non-dissipative with respect to kinetic energy.\n\nThe final kinetic energy balance is:\n$$\n\\frac{\\mathrm{d}K}{\\mathrm{d}t} = T_C + T_V\n$$\nFor $\\alpha = 1/2$, $T_C=0$, and the energy balance becomes $\\frac{\\mathrm{d}K}{\\mathrm{d}t} = T_V \\le 0$. The total kinetic energy can only decrease due to viscous dissipation, which is physically correct.\n\nThe value of $\\alpha$ that ensures the convective term is non-dissipative is $1/2$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3333512"}, {"introduction": "While ideal convective schemes are non-dissipative, many practical ILES methods leverage the inherent numerical dissipation of certain discretization schemes, such as TVD methods, to model the effects of subgrid-scale turbulence. This practice delves into the analysis of such schemes using the powerful tool of modified wavenumber analysis. You will explore how a single parameter, representing the influence of a flux limiter, controls the balance between numerical dissipation and dispersion, and quantify its effect on the \"bottleneck\" phenomenon often seen in under-resolved simulations [@problem_id:3333547].", "problem": "Consider the one-dimensional linear advection equation $u_t + a u_x = 0$ with constant speed $a>0$. In an Implicit Large-Eddy Simulation (ILES) context using a Total Variation Diminishing (TVD) reconstruction, the nonlinear flux limiter can be parameterized to tune the balance between numerical dispersion and dissipation. For a monochromatic mode under linearized analysis, this limiter can be modeled by an equivalent semi-discrete spatial operator that blends a centered difference (dispersive) term with a second-difference (dissipative) term. Specifically, assume the semi-discrete scheme\n$$\nu_t = -a\\, D_{\\beta}(u), \\quad D_{\\beta}(u_i) = \\frac{1}{\\Delta x}\\left(\\frac{1}{2}(u_{i+1} - u_{i-1}) - \\beta (u_{i+1} - 2 u_i + u_{i-1})\\right),\n$$\nwhere $\\beta \\ge 0$ is a limiter-controlled coefficient representing the effective strength of TVD-induced numerical dissipation, and $\\Delta x = L/N$ is the uniform grid spacing on a periodic domain of length $L$ with $N$ points.\n\nLet $u_i = \\hat{u}\\, e^{\\mathrm{i} k x_i}$ with $x_i = i \\Delta x$, where $k$ is the physical wavenumber and $\\mathrm{i} = \\sqrt{-1}$. Define the nondimensional wavenumber $\\theta = k \\Delta x$.\n\n1. Derive the discrete Fourier symbol of $D_{\\beta}$ and the associated modified wavenumber $k^*(k)$, defined through the relation $u_t = -\\mathrm{i}\\, a\\, k^*(k)\\, u$ for the monochromatic mode. Express $k^*(k)$ in terms of $\\theta$, $\\Delta x$, and $\\beta$.\n\n2. Define the phase error $\\phi(k)$ as $\\phi(k) = \\mathrm{Re}(k^*(k)) - k$, where $\\mathrm{Re}(\\cdot)$ denotes the real part. Provide an expression for $\\phi(k)$ in terms of $\\theta$, $\\Delta x$, and $k$.\n\n3. To characterize the bottleneck effect in ILES, use a physically motivated proxy comparing the numerical dissipation rate to molecular (physical) viscosity. Let the numerical dissipation rate induced by the scheme be\n$$\n\\mu(k) = \\frac{2 \\beta}{\\Delta x} \\left(1 - \\cos \\theta\\right),\n$$\nand let the physical viscous dissipation rate be $\\nu k^2$, where $\\nu > 0$ is the kinematic viscosity. Define the bottleneck amplitude $B$ as\n$$\nB = \\max_{k \\in \\mathcal{K}} \\frac{\\mu(k)}{\\nu k^2},\n$$\nwhere $\\mathcal{K}$ is the set of resolvable wavenumbers up to the Nyquist limit on the chosen grid. The angle unit must be radians.\n\nUsing these definitions, write a complete program that, for each test case in the following test suite, computes:\n- The maximum absolute phase error over all resolvable wavenumbers $\\max_{k \\in \\mathcal{K}} |\\phi(k)|$.\n- The bottleneck amplitude $B$.\n\nAssume $a = 1$ (dimensionless). Use the discrete set of wavenumbers $\\mathcal{K} = \\left\\{k_m = \\frac{2\\pi m}{L} \\,\\big|\\, m = 1, 2, \\ldots, \\left\\lfloor\\frac{N}{2}\\right\\rfloor \\right\\}$, so that $\\theta_m = k_m \\Delta x = \\frac{2\\pi m}{N}$. The program must produce the results for each test case as a list $[B, E_{\\phi}]$, where $E_{\\phi} = \\max_{k \\in \\mathcal{K}} |\\phi(k)|$.\n\nTest suite parameters (all quantities are dimensionless, angles in radians):\n- Case 1: $L = 2\\pi$, $N = 64$, $\\beta = 0.05$, $\\nu = 10^{-3}$.\n- Case 2: $L = 2\\pi$, $N = 64$, $\\beta = 0.20$, $\\nu = 10^{-3}$.\n- Case 3: $L = 2\\pi$, $N = 128$, $\\beta = 0.20$, $\\nu = 10^{-3}$.\n- Case 4: $L = 2\\pi$, $N = 32$, $\\beta = 0.40$, $\\nu = 10^{-3}$.\n- Case 5: $L = 2\\pi$, $N = 128$, $\\beta = 0.40$, $\\nu = 10^{-3}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact format:\n$$\n\\text{[[B\\_1,E\\_{\\phi,1}],[B\\_2,E\\_{\\phi,2}],[B\\_3,E\\_{\\phi,3}],[B\\_4,E\\_{\\phi,4}],[B\\_5,E\\_{\\phi,5}]]}\n$$\nwhere $B_i$ and $E_{\\phi,i}$ are floats for the $i$-th case, computed as specified above. No additional text should be printed.", "solution": "The problem is valid as it is scientifically grounded in the numerical analysis of partial differential equations, is self-contained, well-posed, and free of any ambiguities or contradictions.\n\nThe solution proceeds in four steps:\n1.  Derivation of the modified wavenumber $k^*(k)$ for the given semi-discrete scheme.\n2.  Derivation of the phase error $\\phi(k)$ and determination of its maximum absolute value $E_{\\phi}$.\n3.  Derivation of the bottleneck amplitude $B$.\n4.  Statement of the final formulas for implementation.\n\n**1. Derivation of the Modified Wavenumber**\n\nThe semi-discrete scheme for the one-dimensional linear advection equation $u_t + a u_x = 0$ is given by\n$$u_t = -a\\, D_{\\beta}(u)$$\nwhere the spatial operator $D_{\\beta}$ is defined as\n$$D_{\\beta}(u_i) = \\frac{1}{\\Delta x}\\left(\\frac{1}{2}(u_{i+1} - u_{i-1}) - \\beta (u_{i+1} - 2 u_i + u_{i-1})\\right)$$\nTo find the behavior of this scheme for a single Fourier mode, we substitute a monochromatic wave solution $u_j(t) = \\hat{u}(t) e^{\\mathrm{i}k x_j}$ into the operator, where $x_j = j\\Delta x$. The grid shifts are represented as $u_{j\\pm1} = \\hat{u}(t) e^{\\mathrm{i}k(j\\pm1)\\Delta x} = u_j e^{\\pm\\mathrm{i}k\\Delta x}$. Using the nondimensional wavenumber $\\theta = k\\Delta x$, we have $u_{j\\pm1} = u_j e^{\\pm\\mathrm{i}\\theta}$.\n\nSubstituting into the expression for $D_{\\beta}(u_j)$:\n$$D_{\\beta}(u_j) = \\frac{u_j}{\\Delta x}\\left(\\frac{1}{2}(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}) - \\beta (e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta})\\right)$$\nUsing Euler's identities, $e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta} = 2\\mathrm{i}\\sin\\theta$ and $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos\\theta$, we simplify the terms:\n$$ \\frac{1}{2}(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta}) = \\mathrm{i}\\sin\\theta $$\n$$ e^{\\mathrm{i}\\theta} - 2 + e^{-\\mathrm{i}\\theta} = (e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta}) - 2 = 2\\cos\\theta - 2 = -2(1-\\cos\\theta) $$\nThus, the operator becomes:\n$$ D_{\\beta}(u_j) = \\frac{u_j}{\\Delta x} \\left( \\mathrm{i}\\sin\\theta + 2\\beta(1-\\cos\\theta) \\right) $$\nThe semi-discrete equation for the mode amplitude $\\hat{u}$ is then:\n$$ \\frac{d\\hat{u}}{dt} e^{\\mathrm{i} k x_j} = -a \\frac{1}{\\Delta x} \\left( \\mathrm{i}\\sin\\theta + 2\\beta(1-\\cos\\theta) \\right) \\hat{u} e^{\\mathrm{i} k x_j} $$\nThis is rewritten as $\\frac{du}{dt} = \\lambda u$, where $\\lambda$ is the eigenvalue of the spatial discretization. The problem defines the modified wavenumber $k^*(k)$ through the relation $u_t = -\\mathrm{i} a k^*(k) u$. Comparing this with our derived equation:\n$$ -\\mathrm{i} a k^*(k) = -a \\frac{1}{\\Delta x} \\left( \\mathrm{i}\\sin\\theta + 2\\beta(1-\\cos\\theta) \\right) $$\n$$ \\mathrm{i} k^*(k) = \\frac{1}{\\Delta x} \\left( \\mathrm{i}\\sin\\theta + 2\\beta(1-\\cos\\theta) \\right) $$\nSolving for $k^*(k)$ by dividing by $\\mathrm{i}$ (and using $1/\\mathrm{i} = -\\mathrm{i}$):\n$$ k^*(k) = \\frac{1}{\\mathrm{i}\\Delta x} \\left( \\mathrm{i}\\sin\\theta + 2\\beta(1-\\cos\\theta) \\right) = \\frac{1}{\\Delta x} \\left( \\sin\\theta - \\mathrm{i}2\\beta(1-\\cos\\theta) \\right) $$\nThis is the complex modified wavenumber. Its real part governs numerical dispersion, and its imaginary part governs numerical dissipation.\n\n**2. Derivation of the Maximum Absolute Phase Error**\n\nThe phase error is defined as $\\phi(k) = \\mathrm{Re}(k^*(k)) - k$. From the expression for $k^*(k)$:\n$$ \\mathrm{Re}(k^*(k)) = \\frac{\\sin\\theta}{\\Delta x} $$\nThe phase error is therefore:\n$$ \\phi(k) = \\frac{\\sin\\theta}{\\Delta x} - k $$\nSince $\\theta = k\\Delta x$, we have $k = \\theta/\\Delta x$. Substituting this gives the phase error in terms of $\\theta$ and $\\Delta x$:\n$$ \\phi(k) = \\frac{\\sin\\theta - \\theta}{\\Delta x} $$\nWe need to find the maximum absolute phase error, $E_{\\phi} = \\max_{k \\in \\mathcal{K}} |\\phi(k)|$. The set of resolvable wavenumbers is $\\mathcal{K} = \\{k_m = \\frac{2\\pi m}{L} | m = 1, \\dots, \\lfloor\\frac{N}{2}\\rfloor \\}$. This corresponds to nondimensional wavenumbers $\\theta_m = k_m \\Delta x = \\frac{2\\pi m}{L} \\frac{L}{N} = \\frac{2\\pi m}{N}$.\nThe range of $\\theta_m$ is from $\\frac{2\\pi}{N}$ (for $m=1$) to $\\frac{2\\pi \\lfloor N/2 \\rfloor}{N}$. For all test cases, $N$ is even, so $\\lfloor N/2 \\rfloor = N/2$, and the maximum value of $\\theta_m$ is $\\theta_{\\max} = \\pi$ (the Nyquist wavenumber).\n\nThe function to maximize is $|\\phi(k)| = |\\frac{\\sin\\theta - \\theta}{\\Delta x}|$. For $\\theta>0$, $\\sin\\theta < \\theta$, so $\\sin\\theta - \\theta < 0$. Thus, $|\\sin\\theta - \\theta| = \\theta - \\sin\\theta$.\nLet $f(\\theta) = \\theta - \\sin\\theta$. Its derivative is $f'(\\theta) = 1 - \\cos\\theta$. For $\\theta \\in (0, 2\\pi)$, $f'(\\theta) \\ge 0$, meaning $f(\\theta)$ is a monotonically increasing function. The maximum of $|\\phi(k)|$ will therefore occur at the largest value of $\\theta$ in the discrete set, which is $\\theta_{\\max} = \\pi$.\n$$ E_{\\phi} = \\max_{k \\in \\mathcal{K}} |\\phi(k)| = \\frac{\\theta_{\\max} - \\sin(\\theta_{\\max})}{\\Delta x} = \\frac{\\pi - \\sin(\\pi)}{\\Delta x} = \\frac{\\pi}{\\Delta x} $$\nSubstituting $\\Delta x = L/N$, we get the final expression for the maximum absolute phase error:\n$$ E_{\\phi} = \\frac{\\pi N}{L} $$\n\n**3. Derivation of the Bottleneck Amplitude**\n\nThe bottleneck amplitude $B$ is defined as the maximum of the ratio of the numerical dissipation rate $\\mu(k)$ to the physical viscous dissipation rate $\\nu k^2$, over all resolvable wavenumbers:\n$$ B = \\max_{k \\in \\mathcal{K}} \\frac{\\mu(k)}{\\nu k^2} $$\nThe numerical dissipation rate is given as $\\mu(k) = \\frac{2 \\beta}{\\Delta x} \\left(1 - \\cos \\theta\\right)$.\nThe ratio is:\n$$ R(k) = \\frac{\\mu(k)}{\\nu k^2} = \\frac{1}{\\nu k^2} \\frac{2 \\beta}{\\Delta x} \\left(1 - \\cos(k\\Delta x)\\right) $$\nTo find the maximum, we analyze the behavior of the function $g(\\theta) = \\frac{1 - \\cos\\theta}{\\theta^2}$, where $\\theta = k\\Delta x$. The ratio can be written as $R(k) = \\frac{2\\beta \\Delta x}{\\nu} g(k\\Delta x)$.\nThe derivative of $g(\\theta)$ is $g'(\\theta) = \\frac{\\theta \\sin\\theta - 2(1-\\cos\\theta)}{\\theta^3}$. The numerator, $h(\\theta) = \\theta \\sin\\theta - 2(1-\\cos\\theta)$, can be shown to be negative for $\\theta \\in (0, \\pi)$ by analyzing its own derivatives: $h(0)=0$ and $h'(\\theta) = \\theta\\cos\\theta - \\sin\\theta$, which is also negative for $\\theta \\in(0,\\pi)$. Since $g'(\\theta) < 0$, the function $g(\\theta)$ is monotonically decreasing on $(0, \\pi]$.\nConsequently, the ratio $R(k)$ is a monotonically decreasing function of $k$ for $k\\Delta x \\in (0, \\pi]$. The maximum of $R(k)$ over the discrete set $\\mathcal{K}$ must occur at the smallest wavenumber in the set, which is $k_1 = \\frac{2\\pi}{L}$.\nThe corresponding nondimensional wavenumber is $\\theta_1 = k_1 \\Delta x = \\frac{2\\pi}{L} \\frac{L}{N} = \\frac{2\\pi}{N}$.\n\nWe evaluate $R(k)$ at $k=k_1$:\n$$ B = R(k_1) = \\frac{2 \\beta (1 - \\cos(\\theta_1))}{\\nu \\Delta x k_1^2} = \\frac{2 \\beta (1 - \\cos(2\\pi/N))}{\\nu (L/N) (2\\pi/L)^2} $$\n$$ B = \\frac{2 \\beta N (1 - \\cos(2\\pi/N))}{\\nu L (4\\pi^2/L^2)} = \\frac{2 \\beta N L (1 - \\cos(2\\pi/N))}{4\\pi^2 \\nu} = \\frac{\\beta N L}{2\\pi^2 \\nu} (1 - \\cos(2\\pi/N)) $$\nUsing the half-angle identity $1 - \\cos(2x) = 2 \\sin^2(x)$ with $x = \\pi/N$:\n$$ B = \\frac{\\beta N L}{2\\pi^2 \\nu} (2\\sin^2(\\pi/N)) = \\frac{\\beta N L}{\\pi^2 \\nu} \\sin^2(\\pi/N) $$\n\n**4. Final Formulas for Implementation**\n\nFor each test case with parameters $(L, N, \\beta, \\nu)$:\n1.  The maximum absolute phase error is calculated as:\n    $$ E_{\\phi} = \\frac{\\pi N}{L} $$\n2.  The bottleneck amplitude is calculated as:\n    $$ B = \\frac{\\beta N L}{\\pi^2 \\nu} \\sin^2\\left(\\frac{\\pi}{N}\\right) $$\nThese formulas will be implemented in the Python code.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the bottleneck amplitude (B) and maximum phase error (E_phi)\n    for a series of test cases based on a semi-discrete scheme for the\n    linear advection equation.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, N, beta, nu)\n    test_cases = [\n        (2 * np.pi, 64, 0.05, 1e-3),\n        (2 * np.pi, 64, 0.20, 1e-3),\n        (2 * np.pi, 128, 0.20, 1e-3),\n        (2 * np.pi, 32, 0.40, 1e-3),\n        (2 * np.pi, 128, 0.40, 1e-3),\n    ]\n\n    results = []\n    \n    # Constant from problem statement.\n    a = 1.0\n\n    for case in test_cases:\n        L, N, beta, nu = case\n\n        # Formula for maximum absolute phase error: E_phi = pi * N / L\n        # This is derived from maximizing |phi(k)| = |(sin(theta)-theta)/dx|\n        # at the Nyquist wavenumber k_max = pi / dx, where theta_max = pi.\n        E_phi = np.pi * N / L\n\n        # Formula for bottleneck amplitude: B = (beta * N * L / (pi^2 * nu)) * sin^2(pi/N)\n        # This is derived from maximizing R(k) = mu(k) / (nu * k^2) at the\n        # smallest non-zero wavenumber k_1 = 2*pi / L.\n        # B = (2*beta*(1-cos(2*pi/N))) / (nu * (L/N) * (2*pi/L)^2)\n        #   = (beta * N * L / (2 * pi^2 * nu)) * (1 - cos(2*pi/N))\n        # Using 1 - cos(2x) = 2sin^2(x):\n        # B = (beta * N * L / (pi^2 * nu)) * sin^2(pi/N)\n        \n        # We use the sinc function form for better numerical stability, though the direct formula is also accurate for these parameters.\n        # B = (beta * (L/N) / nu) * (sin(pi/N)/(pi/N))^2\n        # For simplicity and directness, let's stick to the derived formula:\n        B = (beta * N * L / (np.pi**2 * nu)) * (np.sin(np.pi / N))**2\n\n        results.append([B, E_phi])\n\n    # Format the final output string as a list of lists.\n    # str([1.2, 3.4]) produces '[1.2, 3.4]', which is what's needed for the comma-separated join.\n    # The final output has no spaces within the sublists, e.g., \"[1.2,3.4]\".\n    # The default string representation of a list includes spaces. To match the implicit format\n    # of the example, we build the string more carefully.\n    \n    # Let's re-read the format example in the prompt.\n    # [[B_1,E_{\\phi,1}],[B_2,E_{\\phi,2}],...]\n    # In Python, str([[1.0, 2.0], [3.0, 4.0]]) produces '[[1.0, 2.0], [3.0, 4.0]]'\n    # The prompt template `f\"[{','.join(map(str, results))}]\"` joins these with commas,\n    # producing '[[1.0, 2.0], [3.0, 4.0]]' -> '[[1.0, 2.0],[3.0, 4.0]]'.\n    # This matches the requested format.\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\n\nsolve()\n```", "id": "3333547"}, {"introduction": "To bridge the gap between theoretical analysis and real-world application, any ILES solver must be rigorously validated against known benchmark cases. This final practice provides a complete, end-to-end framework for verifying a solver's performance using the three-dimensional Taylor-Green vortex, a canonical problem for studying turbulence transition and decay. You will learn to evaluate solver output against a suite of key diagnostics, including energy decay rates, enstrophy evolution, and spectral characteristics, thereby building a practical skill set for assessing the quality and physical fidelity of a complex turbulence simulation [@problem_id:3333480].", "problem": "You are to write a complete, runnable program that formalizes an end-to-end comparison plan between two or more implicit large-eddy simulation (ILES) solvers using the three-dimensional Taylor–Green vortex at Reynolds number $Re=1600$. The plan must start from a valid and explicit mathematical base and verify solver outputs against specified diagnostics with acceptance tolerances. The mathematical base, setup, diagnostics, and acceptance criteria must be encoded and evaluated by your program for a small test suite of hypothetical solver outputs provided below. All quantities are nondimensional (no physical units). The final answer must be produced in a single line as specified.\n\nStart from the incompressible Navier–Stokes equations in a periodic cube, with density $ \\rho = 1 $, domain $ \\Omega = [0,2\\pi]^3 $, characteristic velocity $ U_0 = 1 $, characteristic length $ L_c = 1 $, and kinematic viscosity $ \\nu = U_0 L_c / Re = 1/1600 $. The initial conditions for the Taylor–Green vortex are\n$\nu(x,y,z,0) = \\sin x \\cos y \\cos z,\\quad\nv(x,y,z,0) = -\\cos x \\sin y \\cos z,\\quad\nw(x,y,z,0) = 0,\n$\nand the initial pressure is\n$\np(x,y,z,0) = \\frac{1}{16}\\big(\\cos(2x)+\\cos(2y)\\big)\\big(\\cos(2z)+2\\big).\n$\nLet the volume-average of a quantity $ q $ over $ \\Omega $ be denoted $ \\langle q \\rangle = \\frac{1}{|\\Omega|}\\int_{\\Omega} q \\, d\\Omega $. The domain-averaged kinetic energy and enstrophy are\n$\nE(t) = \\frac{1}{2}\\langle u^2 + v^2 + w^2 \\rangle,\\quad\nZ(t) = \\frac{1}{2}\\langle \\|\\boldsymbol{\\omega}\\|^2 \\rangle,\\quad\n\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}.\n$\nFor the above initial condition one has the exact values\n$\nE(0) = \\frac{1}{8} = 0.125,\\quad Z(0) = \\frac{3}{8} = 0.375.\n$\n\nIn an ILES, the domain-averaged kinetic energy balance can be written as\n$\n\\frac{dE}{dt} = - \\nu \\langle \\|\\boldsymbol{\\omega}\\|^2 \\rangle - \\varepsilon_{\\text{num}}(t) = -2\\nu Z(t) - \\varepsilon_{\\text{num}}(t),\n$\nwhere $ \\varepsilon_{\\text{num}}(t) \\ge 0 $ represents the implicit numerical dissipation. Using a second-order central difference in time on a uniform grid of times $ t_j $ with step $ \\Delta t $, we approximate\n$\n\\left.\\frac{dE}{dt}\\right|_{t_j} \\approx \\frac{E(t_{j+1}) - E(t_{j-1})}{2\\Delta t},\n$\nand define an estimate of the implicit numerical dissipation as\n$\n\\hat{\\varepsilon}_{\\text{num}}(t_j) = -\\left( \\frac{E(t_{j+1}) - E(t_{j-1})}{2\\Delta t} + 2\\nu Z(t_j) \\right).\n$\n\nYour program must implement the following acceptance diagnostics:\n- Initial-condition consistency: check that the solver-reported $ E(0) $ and $ Z(0) $ match the analytic values $ E(0)=0.125 $ and $ Z(0)=0.375 $ within an absolute tolerance $ \\tau_{\\text{IC}} = 10^{-6} $.\n- Energy decay agreement: given the reference energies at times $ t\\in\\{2,4,6,8,10\\} $, \n$\nE_{\\text{ref}}(2)=0.087209540758879,\\quad\nE_{\\text{ref}}(4)=0.0608440319949965,\\quad\nE_{\\text{ref}}(6)=0.0424494407056167,\\quad\nE_{\\text{ref}}(8)=0.0296159698352653,\\quad\nE_{\\text{ref}}(10)=0.0206623610276983,\n$\nrequire the solver energies $ E(t) $ at the same times to satisfy\n$\n\\max_{t\\in\\{2,4,6,8,10\\}} \\frac{|E(t) - E_{\\text{ref}}(t)|}{E_{\\text{ref}}(t)} \\le \\tau_E,\n$\nwith $ \\tau_E = 0.08 $.\n- Enstrophy peak timing: let $ t^* $ be the time in $ \\{2,4,6,8,10\\} $ where $ Z(t) $ attains its maximum over these samples. Require $ |t^* - 8| \\le \\tau_{tZ} $ with $ \\tau_{tZ} = 2.0 $.\n- Inertial-range spectral slope: at time $ t=8 $ the isotropic energy spectrum $ E(k,8) $ over wavenumbers $ k \\in \\{3,4,5,6,7,8\\} $ must have least-squares slope $ s $ in the log–log relation $ \\log E = a + s \\log k $ satisfying\n$\n|s - (-5/3)| \\le \\tau_s,\n$\nwith $ \\tau_s = 0.2 $ and $ -5/3 = -1.6666666666666667 $.\n- Non-negativity of implicit dissipation: compute $ \\hat{\\varepsilon}_{\\text{num}}(t_j) $ at $ t_j \\in \\{2,4,6,8\\} $ using central differences with uniform $ \\Delta t = 2 $. Require $ \\hat{\\varepsilon}_{\\text{num}}(t_j) \\ge -\\tau_{\\varepsilon} $ with $ \\tau_{\\varepsilon} = 10^{-6} $ for all these times.\n\nYour program must evaluate the above diagnostics for the following three hypothetical solver outputs. All times are $ t \\in \\{0,2,4,6,8,10\\} $, and all spectra are provided at $ t=8 $ for wavenumbers $ k \\in \\{1,2,3,4,5,6,7,8,9,10\\} $.\n\nSolver A:\n- Energies $ E_A(t) = [\\,0.125,\\ 0.0870,\\ 0.0609,\\ 0.0426,\\ 0.0292,\\ 0.0207\\,] $.\n- Enstrophies $ Z_A(t) = [\\,0.375,\\ 0.8,\\ 1.5,\\ 2.1,\\ 2.4,\\ 2.2\\,] $.\n- Spectrum at $ t=8 $: $ E_{A}(k,8) = [\\,0.51,\\ 0.15435,\\ 0.0824,\\ 0.044135,\\ 0.03434,\\ 0.02704,\\ 0.021285,\\ 0.0185,\\ 0.0168,\\ 0.01344\\,] $.\n\nSolver B:\n- Energies $ E_B(t) = [\\,0.125,\\ 0.082,\\ 0.054,\\ 0.039,\\ 0.022,\\ 0.014\\,] $.\n- Enstrophies $ Z_B(t) = [\\,0.375,\\ 1.2,\\ 2.3,\\ 2.6,\\ 2.5,\\ 2.0\\,] $.\n- Spectrum at $ t=8 $: $ E_{B}(k,8) = [\\,0.5,\\ 0.2175,\\ 0.1335,\\ 0.0945,\\ 0.0725,\\ 0.058,\\ 0.048,\\ 0.041,\\ 0.0355,\\ 0.0315\\,] $.\n\nSolver C:\n- Energies $ E_C(t) = [\\,0.125,\\ 0.090,\\ 0.062,\\ 0.0415,\\ 0.0280,\\ 0.0198\\,] $.\n- Enstrophies $ Z_C(t) = [\\,0.375,\\ 0.9,\\ 1.6,\\ 2.0,\\ 2.3,\\ 2.5\\,] $.\n- Spectrum at $ t=8 $: $ E_{C}(k,8) = [\\,0.5,\\ 0.1435,\\ 0.069,\\ 0.041,\\ 0.0275,\\ 0.0195,\\ 0.015,\\ 0.012,\\ 0.0095,\\ 0.008\\,] $.\n\nYour program must:\n1) Implement the above diagnostics and tolerances as stated.\n2) Evaluate each solver independently and decide pass ($\\text{True}$) or fail ($\\text{False}$) only if all diagnostics pass or if any diagnostic fails, respectively.\n3) Use the reference energy values exactly as given for the energy-decay agreement test.\n4) Use the wavenumber subset $ k \\in \\{3,4,5,6,7,8\\} $ for the spectral slope test.\n\nFinal output format: Your program should produce a single line of output containing the per-solver pass/fail results as a comma-separated list of booleans enclosed in square brackets, in the order $[A,B,C]$ (e.g., $[\\,\\text{True},\\text{False},\\text{True}\\,]$).", "solution": "The problem is valid. It is a well-posed, scientifically grounded, and objective task rooted in the established principles of computational fluid dynamics (CFD) and turbulence modeling. The problem statement provides a complete, self-contained set of specifications for verifying the output of implicit large-eddy simulation (ILES) solvers against a standard benchmark, the three-dimensional Taylor-Green vortex (TGV). All data, constants, and criteria are explicitly defined, allowing for a unique and verifiable solution.\n\nThe theoretical foundation of this problem is the incompressible Navier-Stokes equations, which govern the motion of a viscous fluid. For a fluid with constant density $\\rho=1$, these are:\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\nu \\nabla^2 \\mathbf{u}\n$$\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\nwhere $\\mathbf{u}=(u,v,w)$ is the velocity vector, $p$ is the pressure, and $\\nu$ is the kinematic viscosity. The problem is set in a periodic cubic domain $\\Omega = [0, 2\\pi]^3$ with a Reynolds number $Re=1600$, which implies a viscosity $\\nu = U_0 L_c / Re = 1 \\cdot 1 / 1600 = 1/1600$.\n\nThe evolution of the flow is typically monitored through global, volume-averaged quantities. The total kinetic energy $E(t)$ and enstrophy $Z(t)$ are defined as:\n$$\nE(t) = \\frac{1}{2}\\langle |\\mathbf{u}|^2 \\rangle = \\frac{1}{2}\\langle u^2 + v^2 + w^2 \\rangle\n$$\n$$\nZ(t) = \\frac{1}{2}\\langle |\\boldsymbol{\\omega}|^2 \\rangle \\quad \\text{where} \\quad \\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}\n$$\nThe rate of change of kinetic energy in a direct numerical simulation (DNS) is given by the exact relation $\\frac{dE}{dt} = -\\nu \\langle |\\boldsymbol{\\omega}|^2 \\rangle = -2\\nu Z(t)$, which describes the dissipation of energy by viscous forces. In an ILES, the numerical discretization scheme introduces its own dissipation, which acts as an implicit subgrid-scale model. The energy balance equation for an ILES is thus modified to:\n$$\n\\frac{dE}{dt} = -2\\nu Z(t) - \\varepsilon_{\\text{num}}(t)\n$$\nwhere $\\varepsilon_{\\text{num}}(t) \\ge 0$ represents the rate of energy dissipation by the numerical scheme. This quantity is fundamental to the behavior of an ILES, and its properties are a key aspect of solver verification.\n\nThe program will implement five diagnostic tests to assess the validity of hypothetical solver outputs.\n\n1.  **Initial-Condition Consistency**: This test verifies that the solver has correctly initialized the flow field. The analytical values for the TGV initial condition are $E(0) = 1/8 = 0.125$ and $Z(0) = 3/8 = 0.375$. The solver's reported values at $t=0$ are checked against these exact values, requiring them to match within an absolute tolerance $\\tau_{\\text{IC}} = 10^{-6}$. This ensures a correct starting point for the simulation.\n\n2.  **Energy Decay Agreement**: This diagnostic compares the solver's kinetic energy evolution $E(t)$ against a high-fidelity reference solution $E_{\\text{ref}}(t)$. This is a crucial test of the solver's overall dissipative properties (a combination of physical and numerical dissipation). The test metric is the maximum relative error over the specified time points $t \\in \\{2, 4, 6, 8, 10\\}$:\n    $$\n    \\max_{t\\in\\{2,4,6,8,10\\}} \\frac{|E(t) - E_{\\text{ref}}(t)|}{E_{\\text{ref}}(t)} \\le \\tau_E\n    $$\n    A solver passing this test with tolerance $\\tau_E = 0.08$ is considered to reproduce the global energy decay with acceptable accuracy.\n\n3.  **Enstrophy Peak Timing**: The evolution of enstrophy $Z(t)$ is characteristic of the TGV flow. It initially grows as vortex stretching intensifies, creating smaller scales, and then decays after reaching a peak, which signifies the onset of maximum dissipation. For $Re=1600$, this peak is expected around $t=8$. This test checks if the time $t^*$ of the maximum reported enstrophy (among the sampled times) is close to this reference time, i.e., $|t^* - 8| \\le \\tau_{tZ}$, with $\\tau_{tZ} = 2.0$. This verifies that the solver correctly captures the timing of this key transitional event.\n\n4.  **Inertial-Range Spectral Slope**: In turbulent flows, the energy spectrum $E(k)$ in the inertial subrange is expected to follow Kolmogorov's power law, $E(k) \\propto k^{-5/3}$. This test verifies this physical property in the solver's output at $t=8$, a time when the flow is expected to be well-developed. It performs a linear least-squares fit to the relation $\\log E(k, 8) = a + s \\log k$ over a specified range of wavenumbers $k \\in \\{3, 4, 5, 6, 7, 8\\}$. The resulting slope $s$ is then compared to the theoretical value of $-5/3$, requiring $|s - (-5/3)| \\le \\tau_s$, where $\\tau_s = 0.2$.\n\n5.  **Non-negativity of Implicit Dissipation**: A physically consistent ILES must remove energy from the resolved scales, meaning $\\varepsilon_{\\text{num}}(t)$ must be non-negative. We can estimate this quantity from the solver's output using a finite-difference approximation of the energy balance equation. Using a second-order central difference for the time derivative with a time step $\\Delta t$, we define the estimated numerical dissipation as:\n    $$\n    \\hat{\\varepsilon}_{\\text{num}}(t_j) = -\\left( \\frac{E(t_{j+1}) - E(t_{j-1})}{2\\Delta t} + 2\\nu Z(t_j) \\right)\n    $$\n    This test computes $\\hat{\\varepsilon}_{\\text{num}}(t_j)$ for $t_j \\in \\{2, 4, 6, 8\\}$ (with $\\Delta t = 2$) and ensures that it is non-negative, allowing for a small numerical tolerance: $\\hat{\\varepsilon}_{\\text{num}}(t_j) \\ge -\\tau_{\\varepsilon}$, with $\\tau_{\\varepsilon} = 10^{-6}$.\n\nA solver's output is deemed to `pass` if and only if it satisfies all five of these diagnostic criteria. The program will systematically apply these checks to the data from Solvers A, B, and C and report the final boolean verdict for each.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates hypothetical ILES solver outputs against a set of diagnostics\n    for the 3D Taylor-Green vortex problem.\n    \"\"\"\n\n    # --- Problem Constants and Reference Data ---\n    RE = 1600.0\n    NU = 1.0 / RE\n    E0_ANALYTIC = 0.125\n    Z0_ANALYTIC = 0.375\n    DT = 2.0\n    \n    # Tolerances\n    TOL_IC = 1e-6\n    TOL_E = 0.08\n    TOL_TZ = 2.0\n    TOL_S = 0.2\n    TOL_EPS = 1e-6\n\n    # Reference data\n    TIMES = np.array([0., 2., 4., 6., 8., 10.])\n    E_REF = {\n        2: 0.087209540758879,\n        4: 0.0608440319949965,\n        6: 0.0424494407056167,\n        8: 0.0296159698352653,\n        10: 0.0206623610276983,\n    }\n\n    # Hypothetical solver data\n    test_cases = [\n        {\n            \"name\": \"Solver A\",\n            \"E\": np.array([0.125, 0.0870, 0.0609, 0.0426, 0.0292, 0.0207]),\n            \"Z\": np.array([0.375, 0.8, 1.5, 2.1, 2.4, 2.2]),\n            \"E_k8\": np.array([0.51, 0.15435, 0.0824, 0.044135, 0.03434, 0.02704, 0.021285, 0.0185, 0.0168, 0.01344]),\n        },\n        {\n            \"name\": \"Solver B\",\n            \"E\": np.array([0.125, 0.082, 0.054, 0.039, 0.022, 0.014]),\n            \"Z\": np.array([0.375, 1.2, 2.3, 2.6, 2.5, 2.0]),\n            \"E_k8\": np.array([0.5, 0.2175, 0.1335, 0.0945, 0.0725, 0.058, 0.048, 0.041, 0.0355, 0.0315]),\n        },\n        {\n            \"name\": \"Solver C\",\n            \"E\": np.array([0.125, 0.090, 0.062, 0.0415, 0.0280, 0.0198]),\n            \"Z\": np.array([0.375, 0.9, 1.6, 2.0, 2.3, 2.5]),\n            \"E_k8\": np.array([0.5, 0.1435, 0.069, 0.041, 0.0275, 0.0195, 0.015, 0.012, 0.0095, 0.008]),\n        },\n    ]\n\n    # --- Diagnostic Functions ---\n\n    def check_initial_conditions(E, Z):\n        e_pass = np.abs(E[0] - E0_ANALYTIC) <= TOL_IC\n        z_pass = np.abs(Z[0] - Z0_ANALYTIC) <= TOL_IC\n        return e_pass and z_pass\n\n    def check_energy_decay(E):\n        errors = []\n        for i, t in enumerate(TIMES[1:], 1):\n            error = np.abs(E[i] - E_REF[t]) / E_REF[t]\n            errors.append(error)\n        return np.max(errors) <= TOL_E\n\n    def check_enstrophy_peak(Z):\n        # We only consider t in {2,4,6,8,10}, which are indices 1 to 5\n        Z_subset = Z[1:]\n        t_subset = TIMES[1:]\n        t_star = t_subset[np.argmax(Z_subset)]\n        return np.abs(t_star - 8.0) <= TOL_TZ\n        \n    def check_spectral_slope(E_k):\n        # Wavenumbers k are from 1 to 10. Indices are k-1.\n        # Fit range k in {3,4,5,6,7,8} corresponds to indices 2 through 7.\n        k_fit = np.arange(3, 9)\n        E_k_fit = E_k[2:8]\n        \n        log_k = np.log(k_fit)\n        log_E_k = np.log(E_k_fit)\n        \n        # polyfit returns [slope, intercept] for degree 1\n        slope, _ = np.polyfit(log_k, log_E_k, 1)\n        \n        target_slope = -5.0 / 3.0\n        return np.abs(slope - target_slope) <= TOL_S\n\n    def check_dissipation_non_negativity(E, Z):\n        # Times for check are t_j in {2,4,6,8}, corresponding to indices j=1,2,3,4\n        for j in range(1, 5):\n            dEdt = (E[j+1] - E[j-1]) / (2 * DT)\n            Z_j = Z[j]\n            \n            eps_num_hat = -(dEdt + 2 * NU * Z_j)\n            \n            if eps_num_hat < -TOL_EPS:\n                return False\n        return True\n\n    def evaluate_solver(case):\n        \"\"\"Runs all diagnostics for a single solver case.\"\"\"\n        if not check_initial_conditions(case[\"E\"], case[\"Z\"]):\n            return False\n        if not check_energy_decay(case[\"E\"]):\n            return False\n        if not check_enstrophy_peak(case[\"Z\"]):\n            return False\n        if not check_spectral_slope(case[\"E_k8\"]):\n            return False\n        if not check_dissipation_non_negativity(case[\"E\"], case[\"Z\"]):\n            return False\n        return True\n\n    # --- Main Evaluation Loop ---\n    results = []\n    for case in test_cases:\n        pass_fail = evaluate_solver(case)\n        results.append(str(pass_fail))\n\n    # --- Final Output ---\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3333480"}]}