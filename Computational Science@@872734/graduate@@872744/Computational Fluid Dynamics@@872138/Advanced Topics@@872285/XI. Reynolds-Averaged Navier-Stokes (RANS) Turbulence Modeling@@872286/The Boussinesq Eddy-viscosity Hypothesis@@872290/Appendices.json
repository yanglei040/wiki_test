{"hands_on_practices": [{"introduction": "The Boussinesq hypothesis fundamentally assumes a linear relationship between the deviatoric Reynolds stress tensor, $a_{ij}$, and the mean rate-of-strain tensor, $S_{ij}$. This exercise provides a rigorous mathematical framework to test this core assumption directly. By decomposing the Reynolds stress tensor and calculating the \"captured fraction,\" you can quantitatively evaluate how well the model's foundational premise holds across different flow archetypes, providing insight into its applicability [@problem_id:3371295].", "problem": "You are to implement a complete program that decomposes the Reynolds stress tensor into isotropic and deviatoric parts, further decomposes the deviatoric part into components aligned with the mean rate-of-strain and misaligned with it, and then quantifies the fraction of the deviatoric content captured by the Boussinesq eddy-viscosity hypothesis. This task must be posed and solved in purely mathematical terms and must be scientifically consistent with computational fluid dynamics.\n\nUse the following definitions and requirements. Let the Reynolds stress tensor be denoted by $R_{ij}$, the mean turbulent kinetic energy by $k$, the identity tensor by $\\delta_{ij}$, and the mean rate-of-strain tensor by $S_{ij}$. Assume all tensors are $3 \\times 3$, real-valued, and symmetric. Define the turbulent kinetic energy as $k = \\frac{1}{2} R_{kk}$ and the isotropic part as $R^{\\mathrm{iso}}_{ij} = \\frac{2}{3} k \\delta_{ij}$. Define the deviatoric part by $a_{ij} = R_{ij} - R^{\\mathrm{iso}}_{ij}$. Equip the space of second-order tensors with the Frobenius inner product $\\langle A, B \\rangle = A_{ij} B_{ij}$ and the Frobenius norm $\\|A\\|_F = \\sqrt{\\langle A, A \\rangle}$.\n\nDecompose $a_{ij}$ into the sum of two components $a_{ij}^{\\parallel}$ and $a_{ij}^{\\perp}$, where $a_{ij}^{\\parallel}$ is the orthogonal projection of $a_{ij}$ onto the one-dimensional subspace spanned by $S_{ij}$, and $a_{ij}^{\\perp}$ is the remainder orthogonal to $S_{ij}$ in the Frobenius inner product. Specifically, if $\\langle S, S \\rangle > 0$, define the projection coefficient $c = \\frac{\\langle a, S \\rangle}{\\langle S, S \\rangle}$ and set $a_{ij}^{\\parallel} = c S_{ij}$ and $a_{ij}^{\\perp} = a_{ij} - a_{ij}^{\\parallel}$. If $\\langle S, S \\rangle = 0$, set $a_{ij}^{\\parallel} = 0$ and $a_{ij}^{\\perp} = a_{ij}$.\n\nDefine the captured fraction $f$ as the fraction of the deviatoric magnitude that is aligned with $S_{ij}$:\n$$\nf = \n\\begin{cases}\n\\frac{\\|a^{\\parallel}\\|_F^2}{\\|a\\|_F^2}, & \\text{if } \\|a\\|_F > 0, \\\\\n1, & \\text{if } \\|a\\|_F = 0,\n\\end{cases}\n$$\nwith the convention that if $\\langle S, S \\rangle = 0$ and $\\|a\\|_F > 0$, then $f = 0$. The value $f$ is dimensionless (unitless). The scientific interpretation is that $f$ quantifies the fraction of the deviatoric Reynolds stress that can be represented by an eddy-viscosity model based on alignment with the mean rate-of-strain.\n\nImplement this decomposition and fraction computation for the following test suite, which includes distinct flow archetypes and Reynolds numbers (Reynolds number is provided as metadata and is dimensionless). Each case specifies $R_{ij}$ and $S_{ij}$ numerically:\n\n- Case $1$ (shear, moderate Reynolds number $Re = 10^4$):\n  - $R = \\begin{bmatrix} 1.0 & -0.6 & 0.0 \\\\ -0.6 & 1.0 & 0.0 \\\\ 0.0 & 0.0 & 1.0 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0 & 10.0 & 0.0 \\\\ 10.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- Case $2$ (solid-body swirl, high Reynolds number $Re = 10^5$):\n  - $R = \\begin{bmatrix} 1.1333333333333333 & 0.0 & 0.0 \\\\ 0.0 & 1.1333333333333333 & 0.0 \\\\ 0.0 & 0.0 & 1.7333333333333334 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- Case $3$ (curved shear, very high Reynolds number $Re = 2 \\times 10^5$):\n  - $R = \\begin{bmatrix} 0.4666666666666667 & 0.3 & 0.0 \\\\ 0.3 & 1.2 & 0.0 \\\\ 0.0 & 0.0 & 0.6666666666666666 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 5.0 & 0.0 & 0.0 \\\\ 0.0 & -5.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- Case $4$ (misaligned anisotropy with shear, Reynolds number $Re = 3 \\times 10^4$):\n  - $R = \\begin{bmatrix} 0.5333333333333333 & 0.0 & 0.0 \\\\ 0.0 & 1.1333333333333333 & 0.0 \\\\ 0.0 & 0.0 & 0.5333333333333333 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0 & 10.0 & 0.0 \\\\ 10.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- Case $5$ (isotropic turbulence with nonzero mean strain, Reynolds number $Re = 5 \\times 10^3$):\n  - $R = \\begin{bmatrix} 0.4 & 0.0 & 0.0 \\\\ 0.0 & 0.4 & 0.0 \\\\ 0.0 & 0.0 & 0.4 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 2.0 & 0.0 & 0.0 \\\\ 0.0 & -2.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n\nYour program must:\n- For each case, compute $k$, $R^{\\mathrm{iso}}_{ij}$, $a_{ij}$, $a_{ij}^{\\parallel}$, $a_{ij}^{\\perp}$, and the captured fraction $f$ as defined above.\n- Implement the boundary conventions exactly as stated.\n- Produce a single line of output containing the captured fractions for all test cases as a comma-separated list enclosed in square brackets. Each fraction must be rounded to six decimal places. For example, the output format must be exactly of the form $[f_1,f_2,f_3,f_4,f_5]$ with each $f_i$ printed as a decimal rounded to six digits after the decimal point.\n- The fractions are unitless, so no physical units are required in the output.\n\nAngles are not involved in this task. No percentages are involved; the fractions must be printed as decimals as specified. Ensure scientific realism and internal consistency with the definitions and conventions above. The algorithm must be numerically robust for the provided inputs, including boundary cases where $S_{ij}$ is the zero tensor or $a_{ij}$ is the zero tensor.", "solution": "The problem requires the implementation of a procedure to quantify the alignment between the Reynolds stress anisotropy tensor and the mean rate-of-strain tensor. This quantification is a crucial step in validating the Boussinesq eddy-viscosity hypothesis, a cornerstone of many turbulence models in computational fluid dynamics (CFD). The hypothesis posits a linear relationship between the deviatoric part of the Reynolds stress tensor, $a_{ij}$, and the mean rate-of-strain tensor, $S_{ij}$, via an eddy viscosity $\\nu_t$: $a_{ij} = -2\\nu_t S_{ij}$. This implies that the tensor $a_{ij}$ is perfectly aligned with (i.e., proportional to) the tensor $S_{ij}$. The \"captured fraction,\" $f$, measures the degree to which this assumed alignment holds true for given flow data.\n\nThe solution proceeds by first formalizing the mathematical framework and then applying it to each specified test case. All tensors are assumed to be $3 \\times 3$, real, and symmetric.\n\nFirst, we define the necessary quantities based on the provided Reynolds stress tensor, $R_{ij}$. The mean turbulent kinetic energy, $k$, is half the trace of $R_{ij}$:\n$$k = \\frac{1}{2} R_{kk} = \\frac{1}{2} \\text{tr}(R)$$\nThe Reynolds stress tensor $R_{ij}$ can be decomposed into an isotropic part, $R^{\\mathrm{iso}}_{ij}$, and a deviatoric (or anisotropic) part, $a_{ij}$. The isotropic part is defined as:\n$$R^{\\mathrm{iso}}_{ij} = \\frac{2}{3} k \\delta_{ij}$$\nwhere $\\delta_{ij}$ is the Kronecker delta (identity tensor). The deviatoric part, $a_{ij}$, is what remains:\n$$a_{ij} = R_{ij} - R^{\\mathrm{iso}}_{ij}$$\nBy this construction, the tensor $a_{ij}$ is always traceless, i.e., $a_{kk} = 0$.\n\nTo measure the \"size\" of and \"angle\" between tensors, we use the Frobenius inner product and its induced norm. For two tensors $A$ and $B$, the inner product is the sum of the products of their corresponding components:\n$$\\langle A, B \\rangle = A_{ij} B_{ij} = \\sum_{i,j} A_{ij} B_{ij}$$\nThe Frobenius norm of a tensor $A$ is given by:\n$$\\|A\\|_F = \\sqrt{\\langle A, A \\rangle} = \\sqrt{\\sum_{i,j} A_{ij}^2}$$\n\nThe core of the problem is to decompose the anisotropy tensor $a_{ij}$ into a component $a_{ij}^{\\parallel}$ that is aligned with the mean rate-of-strain tensor $S_{ij}$, and a component $a_{ij}^{\\perp}$ that is orthogonal to it. This is achieved by an orthogonal projection of $a_{ij}$ onto the one-dimensional subspace spanned by $S_{ij}$.\nThe aligned component $a_{ij}^{\\parallel}$ is found by:\n$$a_{ij}^{\\parallel} = \\text{proj}_{S}(a) = \\frac{\\langle a, S \\rangle}{\\langle S, S \\rangle} S_{ij} = c S_{ij}$$\nwhere $c$ is the projection coefficient. This is valid if $\\langle S, S \\rangle = \\|S\\|_F^2 > 0$. If $S_{ij}$ is the zero tensor, $\\langle S, S \\rangle = 0$, then the projection is defined to be zero, so $a_{ij}^{\\parallel} = 0$.\n\nThe captured fraction, $f$, is defined as the ratio of the squared magnitude of the aligned component to the squared magnitude of the total anisotropy tensor:\n$$f = \\frac{\\|a^{\\parallel}\\|_F^2}{\\|a\\|_F^2}$$\nThis expression is valid when $\\|a\\|_F > 0$. If $\\|a\\|_F = 0$ (i.e., the flow is isotropic), the fraction is defined as $f=1$.\nWe can derive a more direct computational formula for $f$. Substituting the expression for $a^{\\parallel}$:\n$$\\|a^{\\parallel}\\|_F^2 = \\|c S\\|_F^2 = c^2 \\|S\\|_F^2 = \\left(\\frac{\\langle a, S \\rangle}{\\|S\\|_F^2}\\right)^2 \\|S\\|_F^2 = \\frac{\\langle a, S \\rangle^2}{\\|S\\|_F^2}$$\nThus, the captured fraction becomes:\n$$f = \\frac{\\langle a, S \\rangle^2}{\\|a\\|_F^2 \\|S\\|_F^2}$$\nThis is equivalent to the squared cosine of the angle between the tensors $a$ and $S$ when viewed as vectors in the nine-dimensional space of $3 \\times 3$ matrices. This formula is used for calculations when both $\\|a\\|_F > 0$ and $\\|S\\|_F > 0$.\n\nThe complete algorithm is as follows:\n1.  Given tensors $R$ and $S$.\n2.  Calculate $k = \\frac{1}{2} \\text{tr}(R)$.\n3.  Calculate $a = R - \\frac{2}{3} k I$, where $I$ is the identity matrix.\n4.  Calculate $\\|a\\|_F^2 = \\sum_{i,j} a_{ij}^2$.\n5.  If $\\|a\\|_F^2$ is close to zero, $f=1$.\n6.  Calculate $\\|S\\|_F^2 = \\sum_{i,j} S_{ij}^2$.\n7.  If $\\|S\\|_F^2$ is close to zero (and $\\|a\\|_F^2$ is not), $f=0$.\n8.  Otherwise, calculate $\\langle a, S \\rangle = \\sum_{i,j} a_{ij} S_{ij}$.\n9.  Compute $f = \\frac{\\langle a, S \\rangle^2}{\\|a\\|_F^2 \\|S\\|_F^2}$.\n\nWe now apply this procedure to each test case.\n\n**Case 1:**\n$R = \\begin{bmatrix} 1.0 & -0.6 & 0.0 \\\\ -0.6 & 1.0 & 0.0 \\\\ 0.0 & 0.0 & 1.0 \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0 & 10.0 & 0.0 \\\\ 10.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $k = \\frac{1}{2} (1.0 + 1.0 + 1.0) = 1.5$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(1.5)I = 1.0 I$.\n3.  $a = R - I = \\begin{bmatrix} 0.0 & -0.6 & 0.0 \\\\ -0.6 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$.\n4.  $\\|a\\|_F^2 = (-0.6)^2 + (-0.6)^2 = 0.36 + 0.36 = 0.72$.\n5.  $\\|S\\|_F^2 = (10.0)^2 + (10.0)^2 = 100 + 100 = 200$.\n6.  $\\langle a, S \\rangle = (-0.6)(10.0) + (-0.6)(10.0) = -12.0$.\n7.  $f_1 = \\frac{(-12.0)^2}{(0.72)(200)} = \\frac{144}{144} = 1.0$.\n\n**Case 2:**\n$R = \\begin{bmatrix} 1.133... & 0.0 & 0.0 \\\\ 0.0 & 1.133... & 0.0 \\\\ 0.0 & 0.0 & 1.733... \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 1.133333 + 1.133333 + 1.733334 = 4.0$. $k = \\frac{1}{2}(4.0) = 2.0$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(2.0)I = \\frac{4}{3}I$. $4/3 \\approx 1.333333$.\n3.  $a_{11} = a_{22} = 1.133333 - 1.333333 = -0.2$. $a_{33} = 1.733334 - 1.333333 \\approx 0.4$.\n    $a = \\begin{bmatrix} -0.2 & 0.0 & 0.0 \\\\ 0.0 & -0.2 & 0.0 \\\\ 0.0 & 0.0 & 0.4 \\end{bmatrix}$.\n4.  $\\|a\\|_F^2 = (-0.2)^2 + (-0.2)^2 + (0.4)^2 = 0.04 + 0.04 + 0.16 = 0.24 > 0$.\n5.  $S$ is the zero tensor, so $\\|S\\|_F^2 = 0$.\n6.  According to the problem convention for $\\|a\\|_F > 0$ and $\\|S\\|_F = 0$, $f_2 = 0.0$.\n\n**Case 3:**\n$R = \\begin{bmatrix} 0.466... & 0.3 & 0.0 \\\\ 0.3 & 1.2 & 0.0 \\\\ 0.0 & 0.0 & 0.666... \\end{bmatrix}$, $S = \\begin{bmatrix} 5.0 & 0.0 & 0.0 \\\\ 0.0 & -5.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 0.466667 + 1.2 + 0.666667 = 2.333334 = 7/3$. $k = \\frac{1}{2}(7/3) = 7/6$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(7/6)I = \\frac{7}{9}I$. $7/9 \\approx 0.777778$.\n3.  $a_{11} \\approx 0.466667 - 0.777778 = -0.311111 = -14/45$.\n    $a_{22} = 1.2 - 0.777778 = 0.422222 = 19/45$.\n    $a_{33} \\approx 0.666667 - 0.777778 = -0.111111 = -1/9 = -5/45$.\n    $a_{12}=a_{21}=0.3$.\n4.  $\\|a\\|_F^2 = (-14/45)^2 + (19/45)^2 + (-5/45)^2 + 2(0.3)^2 = \\frac{196+361+25}{2025} + 0.18 = \\frac{582}{2025} + 0.18 = \\frac{631}{1350} \\approx 0.467407$.\n5.  $\\|S\\|_F^2 = 5^2 + (-5)^2 = 50$.\n6.  $\\langle a, S \\rangle = (-14/45)(5) + (19/45)(-5) = \\frac{-70-95}{45} = \\frac{-165}{45} = -11/3$.\n7.  $f_3 = \\frac{(-11/3)^2}{(631/1350)(50)} = \\frac{121/9}{631/27} = \\frac{121}{9}\\frac{27}{631} = \\frac{363}{631} \\approx 0.575277$.\n\n**Case 4:**\n$R = \\begin{bmatrix} 0.533... & 0.0 & 0.0 \\\\ 0.0 & 1.133... & 0.0 \\\\ 0.0 & 0.0 & 0.533... \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0 & 10.0 & 0.0 \\\\ 10.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 0.533333 + 1.133333 + 0.533333 = 2.2$. $k = \\frac{1}{2}(2.2) = 1.1$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(1.1)I = \\frac{2.2}{3}I = \\frac{11}{15}I$. $11/15 \\approx 0.733333$.\n3.  $a_{11} \\approx 0.533333 - 0.733333 = -0.2$.\n    $a_{22} \\approx 1.133333 - 0.733333 = 0.4$.\n    $a_{33} \\approx 0.533333 - 0.733333 = -0.2$. Off-diagonals are zero.\n4.  $\\|a\\|_F^2 = (-0.2)^2 + (0.4)^2 + (-0.2)^2 = 0.04 + 0.16 + 0.04 = 0.24$.\n5.  $\\|S\\|_F^2 = (10.0)^2 + (10.0)^2 = 200$.\n6.  $\\langle a, S \\rangle = a_{12}S_{12} + a_{21}S_{21} = (0)(10) + (0)(10) = 0$.\n7.  $f_4 = \\frac{0^2}{(0.24)(200)} = 0.0$.\n\n**Case 5:**\n$R = \\begin{bmatrix} 0.4 & 0.0 & 0.0 \\\\ 0.0 & 0.4 & 0.0 \\\\ 0.0 & 0.0 & 0.4 \\end{bmatrix}$, $S = \\begin{bmatrix} 2.0 & 0.0 & 0.0 \\\\ 0.0 & -2.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n1.  $k = \\frac{1}{2}(0.4 + 0.4 + 0.4) = 0.6$.\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(0.6)I = 0.4I$.\n3.  $a = R - R^{\\mathrm{iso}} = 0.4I - 0.4I = \\mathbf{0}$.\n4.  $\\|a\\|_F^2 = 0$.\n5.  According to the problem convention for $\\|a\\|_F = 0$, $f_5 = 1.0$.\n\nThe final computed values are $f_1 = 1.0$, $f_2 = 0.0$, $f_3 \\approx 0.575277$, $f_4 = 0.0$, and $f_5 = 1.0$.", "answer": "```python\nimport numpy as np\n\ndef calculate_captured_fraction(R: np.ndarray, S: np.ndarray) -> float:\n    \"\"\"\n    Computes the fraction of the deviatoric Reynolds stress captured by a\n    Boussinesq-type linear model aligned with the mean rate-of-strain.\n\n    Args:\n        R: The 3x3 Reynolds stress tensor.\n        S: The 3x3 mean rate-of-strain tensor.\n\n    Returns:\n        The captured fraction f, a dimensionless value between 0 and 1.\n    \"\"\"\n    # Ensure inputs are numpy arrays with double precision for accuracy.\n    R = np.array(R, dtype=np.float64)\n    S = np.array(S, dtype=np.float64)\n\n    # 1. Calculate turbulent kinetic energy k = 0.5 * tr(R)\n    k = 0.5 * np.trace(R)\n\n    # 2. Calculate the isotropic part of the Reynolds stress tensor\n    # R_iso = (2/3) * k * I, where I is the 3x3 identity matrix.\n    R_iso = (2.0 / 3.0) * k * np.identity(3)\n\n    # 3. Calculate the deviatoric Reynolds stress (anisotropy) tensor a\n    # a = R - R_iso\n    a = R - R_iso\n\n    # 4. Calculate the squared Frobenius norm of the anisotropy tensor a\n    # This is equivalent to <a, a>.\n    norm_a_sq = np.sum(a**2)\n\n    # 5. Handle the special case where a is the zero tensor (isotropic turbulence).\n    # Per the problem statement, if ||a||_F = 0, then f = 1.\n    # A small tolerance is used for floating-point comparison.\n    if norm_a_sq < 1e-15:\n        return 1.0\n\n    # 6. Calculate the squared Frobenius norm of the mean rate-of-strain tensor S.\n    # This is equivalent to <S, S>.\n    norm_s_sq = np.sum(S**2)\n\n    # 7. Handle the special case where S is the zero tensor (no mean strain).\n    # Per the problem statement, if <S, S> = 0 and ||a||_F > 0, then f = 0.\n    if norm_s_sq < 1e-15:\n        return 0.0\n\n    # 8. Calculate the Frobenius inner product of a and S.\n    # <a, S> = sum(a_ij * S_ij)\n    inner_prod_a_s = np.sum(a * S)\n    \n    # 9. Compute the captured fraction f.\n    # f = <a,S>^2 / (||a||_F^2 * ||S||_F^2)\n    # This is the squared cosine of the angle between the tensors a and S.\n    f = (inner_prod_a_s**2) / (norm_a_sq * norm_s_sq)\n    \n    return f\n\ndef solve():\n    \"\"\"\n    Defines the test cases from the problem statement, computes the captured\n    fraction for each, and prints the results in the required format.\n    \"\"\"\n    test_cases = [\n        # Case 1: shear\n        {\n            \"R\": np.array([\n                [1.0, -0.6, 0.0],\n                [-0.6, 1.0, 0.0],\n                [0.0, 0.0, 1.0]\n            ]),\n            \"S\": np.array([\n                [0.0, 10.0, 0.0],\n                [10.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        },\n        # Case 2: solid-body swirl (zero strain)\n        {\n            \"R\": np.array([\n                [1.1333333333333333, 0.0, 0.0],\n                [0.0, 1.1333333333333333, 0.0],\n                [0.0, 0.0, 1.7333333333333334]\n            ]),\n            \"S\": np.array([\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        },\n        # Case 3: curved shear\n        {\n            \"R\": np.array([\n                [0.4666666666666667, 0.3, 0.0],\n                [0.3, 1.2, 0.0],\n                [0.0, 0.0, 0.6666666666666666]\n            ]),\n            \"S\": np.array([\n                [5.0, 0.0, 0.0],\n                [0.0, -5.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        },\n        # Case 4: misaligned anisotropy with shear\n        {\n            \"R\": np.array([\n                [0.5333333333333333, 0.0, 0.0],\n                [0.0, 1.1333333333333333, 0.0],\n                [0.0, 0.0, 0.5333333333333333]\n            ]),\n            \"S\": np.array([\n                [0.0, 10.0, 0.0],\n                [10.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        },\n        # Case 5: isotropic turbulence\n        {\n            \"R\": np.array([\n                [0.4, 0.0, 0.0],\n                [0.0, 0.4, 0.0],\n                [0.0, 0.0, 0.4]\n            ]),\n            \"S\": np.array([\n                [2.0, 0.0, 0.0],\n                [0.0, -2.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        R_val = case[\"R\"]\n        S_val = case[\"S\"]\n        f = calculate_captured_fraction(R_val, S_val)\n        results.append(f)\n\n    # Format the output string as a comma-separated list of values\n    # rounded to six decimal places, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3371295"}, {"introduction": "In practical turbulence modeling, it is crucial to connect model parameters to fundamental physical balances, such as the equilibrium between turbulent kinetic energy production ($\\mathcal{P}$) and its dissipation ($\\epsilon$). This practice demonstrates how to use the Boussinesq model to estimate production and compare it against high-fidelity Direct Numerical Simulation (DNS) data. It also introduces the concept of calibrating the eddy viscosity, $\\nu_t$, to enforce the production-dissipation balance, a key principle underlying many turbulence models [@problem_id:3371271].", "problem": "Consider incompressible homogeneous shear turbulence with mean velocity gradient $\\partial \\bar{U}_1/\\partial x_2 = S_0$ that is spatially uniform and constant in time over the averaging window. Let $R_{ij}=\\overline{u_i' u_j'}$ denote the Reynolds stress tensor and $S_{ij}=\\tfrac{1}{2}\\left(\\partial \\bar{U}_i/\\partial x_j + \\partial \\bar{U}_j/\\partial x_i\\right)$ the mean rate-of-strain tensor. The turbulent kinetic energy production rate is $\\mathcal{P}=-R_{ij} S_{ij}$. In homogeneous shear with the given mean gradient, only $S_{12}=S_{21}=S_0/2$ are nonzero. The Boussinesq eddy-viscosity hypothesis models the deviatoric Reynolds stresses as proportional to the mean rate-of-strain with an eddy viscosity $\\nu_t$, and the diagonal part as an isotropic turbulent pressure proportional to the turbulent kinetic energy $k$. In statistically stationary homogeneous shear turbulence, it is often observed that the production $\\mathcal{P}$ approximately balances the dissipation rate $\\epsilon$.\n\nYour task is to write a program that, for each test case described below, uses the above definitions and hypotheses to: compute the production implied by Direct Numerical Simulation (DNS) shear stress data, compare it to a baseline Boussinesq prediction constructed from a common eddy-viscosity closure for $\\nu_t$, and then compute an adjusted eddy viscosity $\\nu_t^\\star$ that enforces the production-dissipation balance ($\\mathcal{P} = \\epsilon$). Use the International System of Units (SI), with $S_0$ in $\\mathrm{s}^{-1}$, $k$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$, $\\epsilon$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$, $\\nu_t$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, and $R_{12}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$. Angles do not appear in this problem. For any ratio or decimal value, express the result as a decimal number; do not use a percentage sign.\n\nFor each test case, your program must:\n- Input parameters: $(S_0, k, \\epsilon, R_{12}^{DNS})$.\n- Compute the DNS-implied production using the homogeneous-shear identity for this setting, as a scalar $\\mathcal{P}^{DNS}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$.\n- Compute a baseline eddy viscosity $\\nu_t^{(0)}$ using the well-tested algebraic closure $\\nu_t^{(0)} = C_\\mu k^2/\\epsilon$ with $C_\\mu = 0.09$ whenever $\\epsilon>0$. If $\\epsilon=0$ and $k>0$, define $\\nu_t^{(0)}=+\\infty$. If $k=0$ and $\\epsilon=0$, define $\\nu_t^{(0)}=0$.\n- Compute the baseline Boussinesq production prediction $\\mathcal{P}^{(0)}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$ implied by $\\nu_t^{(0)}$ for the given homogeneous shear. If $S_0=0$, define $\\mathcal{P}^{(0)}=0$.\n- Compute the adjusted eddy viscosity $\\nu_t^\\star$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ that enforces production to be equal to dissipation. Use $\\nu_t^\\star=\\epsilon/S_0^2$ if $S_0\\ne 0$. If $S_0=0$ and $\\epsilon=0$, define $\\nu_t^\\star=0$. If $S_0=0$ and $\\epsilon>0$, define $\\nu_t^\\star=+\\infty$.\n- Compute the model shear stress implied by $\\nu_t^\\star$, denoted $R_{12}^{model,\\star}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$, using the Boussinesq hypothesis specialized to homogeneous shear. If $S_0=0$, define $R_{12}^{model,\\star}=0$.\n\nTest suite (five cases), each given as $(S_0, k, \\epsilon, R_{12}^{DNS})$ with the units specified above:\n- Case A: $(10.0, 0.5, 1.0, -0.08)$.\n- Case B (boundary with vanishing shear and dissipation): $(0.0, 0.1, 0.0, 0.0)$.\n- Case C (strong shear): $(50.0, 2.0, 50.0, -0.9)$.\n- Case D (weak shear and dissipation): $(2.0, 0.05, 0.01, -0.004)$.\n- Case E (impossible stationary balance under zero shear): $(0.0, 0.1, 0.1, 0.0)$.\n\nFor each case, your program must output a list of four numbers:\n- $\\mathcal{P}^{DNS}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$,\n- $\\mathcal{P}^{(0)}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$,\n- $\\nu_t^\\star$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n- $R_{12}^{model,\\star}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n\nWhen a value is mathematically undefined by the rules given, use the IEEE representation $+\\infty$ for a floating-point value. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test caseâ€™s four-number list in the same order as the test suite, for example, $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],\\dots]$.", "solution": "We start from the Reynolds-averaged momentum equations where Reynolds stresses $R_{ij}=\\overline{u_i' u_j'}$ appear. The mean rate-of-strain tensor is defined as $S_{ij}=\\tfrac{1}{2}\\left(\\partial \\bar{U}_i/\\partial x_j + \\partial \\bar{U}_j/\\partial x_i\\right)$. The turbulent kinetic energy production rate is defined by the exact identity $\\mathcal{P}=-R_{ij}S_{ij}$. For a homogeneous shear flow with mean velocity $\\bar{U}_1=S_0 x_2$ and all other mean velocity components vanishing, only $S_{12}=S_{21}=S_0/2$ are nonzero.\n\nUnder the Boussinesq eddy-viscosity hypothesis, the deviatoric part of $R_{ij}$ is modeled as $-2\\nu_t S_{ij}$. For incompressible mean flow, the diagonal contribution $(2/3)k\\delta_{ij}$ does not contribute to production because $S_{ii}=0$. Hence, inserting the model into the definition of production yields\n$$\n\\mathcal{P}^{model}=-\\left(-2\\nu_t S_{ij}\\right)S_{ij} = 2\\nu_t S_{ij}S_{ij}.\n$$\nIn homogeneous shear with $S_{12}=S_{21}=S_0/2$ and all other $S_{ij}=0$,\n$$\nS_{ij}S_{ij} = S_{12}^2 + S_{21}^2 = \\left(\\frac{S_0}{2}\\right)^2 + \\left(\\frac{S_0}{2}\\right)^2 = \\frac{S_0^2}{2},\n$$\nso that\n$$\n\\mathcal{P}^{model} = 2\\nu_t \\left(\\frac{S_0^2}{2}\\right) = \\nu_t S_0^2.\n$$\nFor the DNS-implied production in homogeneous shear, only $R_{12}$ contributes:\n$$\n\\mathcal{P}^{DNS} = -R_{ij}S_{ij} = -(R_{12}S_{12}+R_{21}S_{21}) = -2 R_{12}\\left(\\frac{S_0}{2}\\right) = -R_{12} S_0.\n$$\n\nIn statistically stationary homogeneous turbulence, the leading-order energy balance is $\\mathcal{P}\\approx \\epsilon$, where $\\epsilon$ is the dissipation rate. Enforcing this balance with the Boussinesq model gives\n$$\n\\nu_t^\\star S_0^2 \\approx \\epsilon \\quad \\Rightarrow \\quad \\nu_t^\\star = \\frac{\\epsilon}{S_0^2},\n$$\nprovided $S_0\\ne 0$. If $S_0=0$ and $\\epsilon=0$, the balance holds for any finite $\\nu_t$, and we set $\\nu_t^\\star=0$ by convention. If $S_0=0$ but $\\epsilon>0$, no finite $\\nu_t$ can satisfy the balance and we set $\\nu_t^\\star=+\\infty$ to flag impossibility.\n\nTo compare with a common baseline closure, we use the widely adopted algebraic relation from the two-equation class of models $\\nu_t^{(0)} = C_\\mu k^2/\\epsilon$ with $C_\\mu=0.09$ when $\\epsilon>0$. For $\\epsilon=0$ with $k>0$, this formula is singular and we set $\\nu_t^{(0)}=+\\infty$. If $k=0$ and $\\epsilon=0$, we set $\\nu_t^{(0)}=0$. The corresponding baseline production for homogeneous shear is then $\\mathcal{P}^{(0)} = \\nu_t^{(0)} S_0^2$. If $S_0=0$, production must be zero regardless of any finite $\\nu_t$, and we explicitly set $\\mathcal{P}^{(0)}=0$ to avoid undefined products such as $+\\infty \\cdot 0$.\n\nFinally, the modeled shear stress under the Boussinesq hypothesis for homogeneous shear is directly related to $\\nu_t$:\n$$\n-R_{12}^{model} = 2\\nu_t S_{12} = \\nu_t S_0 \\quad \\Rightarrow \\quad R_{12}^{model} = -\\nu_t S_0.\n$$\nUsing $\\nu_t^\\star$, we compute $R_{12}^{model,\\star} = -\\nu_t^\\star S_0$. If $S_0=0$, we set $R_{12}^{model,\\star}=0$ by definition because the mean shear vanishes.\n\nAlgorithm for each test case:\n- Read $(S_0,k,\\epsilon,R_{12}^{DNS})$.\n- Compute $\\mathcal{P}^{DNS}=-R_{12}^{DNS} S_0$.\n- Compute $\\nu_t^{(0)}$ with the conditional rules above using $C_\\mu=0.09$.\n- Compute $\\mathcal{P}^{(0)}=\\nu_t^{(0)} S_0^2$; if $S_0=0$, set $\\mathcal{P}^{(0)}=0$.\n- Compute $\\nu_t^\\star$ with the conditional rules above.\n- Compute $R_{12}^{model,\\star}=-\\nu_t^\\star S_0$; if $S_0=0$, set $R_{12}^{model,\\star}=0$.\n- Return $[\\mathcal{P}^{DNS}, \\mathcal{P}^{(0)}, \\nu_t^\\star, R_{12}^{model,\\star}]$.\n\nApplying this to the specified test suite with the given numerical values in $\\mathrm{SI}$ units yields a unique list of numerical outputs for each case, including $+\\infty$ where defined by the rules. The program aggregates these per-case lists into a single list and prints it on one line in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef baseline_nu_t(Cmu, k, eps):\n    # Compute baseline eddy viscosity nu_t^(0) = Cmu * k^2 / eps with guards.\n    if eps > 0.0:\n        return Cmu * (k ** 2) / eps\n    else:\n        if k == 0.0:\n            return 0.0\n        else:\n            return float('inf')\n\ndef adjusted_nu_t(S0, eps):\n    # Compute adjusted eddy viscosity nu_t* = eps / S0^2 with guards.\n    if S0 == 0.0:\n        if eps == 0.0:\n            return 0.0\n        else:\n            return float('inf')\n    else:\n        return eps / (S0 ** 2)\n\ndef production_dns(S0, R12_dns):\n    # Homogeneous shear: P_DNS = - R12_dns * S0\n    return -R12_dns * S0\n\ndef production_boussinesq(S0, nu_t):\n    # Homogeneous shear: P_model = nu_t * S0^2\n    # Guard S0 == 0 to avoid inf * 0 ambiguities.\n    if S0 == 0.0:\n        return 0.0\n    else:\n        return nu_t * (S0 ** 2)\n\ndef modeled_shear_stress(S0, nu_t):\n    # Boussinesq: R12_model = - nu_t * S0\n    if S0 == 0.0:\n        return 0.0\n    else:\n        return -nu_t * S0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (S0 [1/s], k [m^2/s^2], eps [m^2/s^3], R12_DNS [m^2/s^2])\n    test_cases = [\n        (10.0, 0.5, 1.0, -0.08),   # Case A\n        (0.0, 0.1, 0.0, 0.0),      # Case B\n        (50.0, 2.0, 50.0, -0.9),   # Case C\n        (2.0, 0.05, 0.01, -0.004), # Case D\n        (0.0, 0.1, 0.1, 0.0),      # Case E\n    ]\n    Cmu = 0.09\n\n    results = []\n    for S0, k, eps, R12_dns in test_cases:\n        P_dns = production_dns(S0, R12_dns)\n        nu0 = baseline_nu_t(Cmu, k, eps)\n        P0 = production_boussinesq(S0, nu0)\n        nu_star = adjusted_nu_t(S0, eps)\n        R12_model_star = modeled_shear_stress(S0, nu_star)\n\n        # Collect results for this case\n        results.append([P_dns, P0, nu_star, R12_model_star])\n\n    # Final print statement in the exact required format.\n    # Print Python-style list with floats, including inf where applicable.\n    def format_value(v):\n        # Ensure consistent string representation for floats and inf\n        if isinstance(v, float):\n            if np.isinf(v):\n                return \"inf\" if v > 0 else \"-inf\"\n            else:\n                return str(v)\n        elif isinstance(v, int):\n            return str(v)\n        else:\n            return str(v)\n\n    formatted_cases = []\n    for row in results:\n        formatted_row = \"[\" + \",\".join(format_value(x) for x in row) + \"]\"\n        formatted_cases.append(formatted_row)\n\n    print(\"[\" + \",\".join(formatted_cases) + \"]\")\n\nsolve()\n```", "id": "3371271"}, {"introduction": "While powerful in its simplicity, the Boussinesq hypothesis has well-known limitations, particularly in complex flows dominated by strong strain or body forces. This exercise focuses on a canonical stagnation-point flow to reveal two critical failures of the model. You will investigate the violation of physical realizability constraints, which can lead to unphysical predictions, and the inaccurate modeling of scalar transport through a constant turbulent Prandtl number, $\\mathrm{Pr}_t$ [@problem_id:3371220].", "problem": "Consider a three-dimensional incompressible turbulent flow whose mean-velocity gradient tensor has vanishing mean-rotation tensor and strong mean-strain tensor, representative of a stagnation-point boundary layer. Let the mean-strain tensor be denoted by $S_{ij}$ and the mean-rotation tensor by $\\Omega_{ij}$. Assume $\\Omega_{ij} \\approx 0$ and that $S_{ij}$ is diagonalizable with one strongly compressive principal direction aligned with the $x$-axis. For a simple canonical representation, take\n$$\nS_{ij} = \\mathrm{diag}(-a,\\; a,\\; 0),\n$$\nwith $a>0$ and $\\mathrm{tr}(S)=0$.\n\nThe Boussinesq eddy-viscosity hypothesis models the Reynolds stress tensor as\n$$\nR_{ij} \\equiv \\langle u_i' u_j' \\rangle \\approx \\frac{2}{3}k \\, \\delta_{ij} - 2 \\nu_t S_{ij},\n$$\nwhere $k$ is the turbulent kinetic energy and $\\nu_t$ is the turbulent (eddy) kinematic viscosity. Define the anisotropy tensor $b_{ij}$ by\n$$\nb_{ij} \\equiv \\frac{R_{ij}}{2k} - \\frac{1}{3}\\delta_{ij}.\n$$\nA necessary realizability condition for turbulence is that the eigenvalues of $b_{ij}$ lie in the closed interval $[-1/3,\\,2/3]$, which implies the physical bounds $0 \\le R_{ii} \\le 2k$ for each normal stress component $R_{ii}$.\n\nYou will examine two questions in this irrotational strong-strain setting:\n\n1) Overprediction of the streamwise normal stress: Using only the definitions above and the realizability bounds, derive a condition on $(a, k, \\nu_t)$ under which the Boussinesq hypothesis predicts a streamwise normal stress $R_{xx}$ that exceeds its realizability-consistent maximum along the $x$-direction. Implement this as a boolean test that returns true if and only if such an overprediction occurs.\n\n2) Underprediction of passive-scalar heat transfer with a specified turbulent Prandtl number: For a passive scalar with mean gradient $\\partial \\theta / \\partial x \\equiv G_x$, the gradient-diffusion closure gives the turbulent scalar flux along $x$ as\n$$\nq_x \\equiv \\langle u_x' \\theta' \\rangle \\approx - \\alpha_t \\, G_x, \\quad \\alpha_t \\equiv \\frac{\\nu_t}{\\mathrm{Pr}_t},\n$$\nwhere $\\mathrm{Pr}_t$ is the turbulent Prandtl number. It is a well-tested empirical fact that in strong-strain, stagnation-dominated flows with $\\Omega_{ij} \\approx 0$, the effective turbulent Prandtl number decreases toward values near $0.7$, while in weak-strain flows it remains near $0.85$. For the purpose of this problem, model this trend with the following piecewise-constant rule based on the dimensionless strain parameter\n$$\n\\chi \\equiv \\frac{\\nu_t \\, a}{k}:\n$$\n- If $\\chi \\ge 0.5$, set the effective value $\\mathrm{Pr}_{t,\\mathrm{true}} = 0.7$.\n- If $\\chi < 0.5$, set $\\mathrm{Pr}_{t,\\mathrm{true}} = 0.85$.\n\nGiven a user-specified model value $\\mathrm{Pr}_{t,\\mathrm{model}}$, declare that the model underpredicts heat transfer along $x$ if and only if the magnitude of the modeled turbulent heat flux is smaller than the magnitude of the turbulent heat flux using the effective value, that is,\n$$\n\\left|\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} G_x\\right| < \\left|\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}} G_x\\right|.\n$$\n\nYour task is to write a program that, for each test case below, computes two booleans:\n- The first boolean indicates whether Boussinesq overpredicts $R_{xx}$ in the sense of violating the realizability-consistent maximum.\n- The second boolean indicates whether the specified $\\mathrm{Pr}_{t,\\mathrm{model}}$ underpredicts the magnitude of the modeled turbulent heat flux compared to the effective $\\mathrm{Pr}_{t,\\mathrm{true}}$ determined from $\\chi$.\n\nAll quantities are to be treated as dimensionless numbers; do not use physical units.\n\nTest suite (each case is given as $(a, k, \\nu_t, \\mathrm{Pr}_{t,\\mathrm{model}}, G_x)$):\n- Case 1 (happy path, weak strain): $(10.0,\\; 1.0,\\; 0.04,\\; 0.85,\\; 1.0)$.\n- Case 2 (moderately strong strain, below overprediction threshold): $(10.0,\\; 1.0,\\; 0.06,\\; 0.85,\\; 1.0)$.\n- Case 3 (boundary for $R_{xx}$ overprediction): $(10.0,\\; 1.0,\\; 0.06666666666666667,\\; 0.85,\\; 1.0)$.\n- Case 4 (strong strain, clear $R_{xx}$ overprediction): $(10.0,\\; 1.0,\\; 0.08,\\; 0.90,\\; 1.0)$.\n- Case 5 (very strong strain, model with low $\\mathrm{Pr}_{t,\\mathrm{model}}$): $(10.0,\\; 1.0,\\; 0.12,\\; 0.70,\\; 1.0)$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list of pairs, each pair being a two-element list $[b_1,b_2]$ of booleans for one test case, and the whole list enclosed in square brackets. For example, an output for three cases might look like: \"[[True,False],[False,False],[True,True]]\".", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is rooted in the standard theory of turbulence modeling and presents a clear, solvable set of tasks. We proceed to the derivation and solution.\n\nThe solution requires the evaluation of two conditions for each test case provided. The first concerns a realizability violation by the Boussinesq eddy-viscosity model, and the second concerns the accuracy of a scalar-flux model.\n\n**1. Condition for Overprediction of Streamwise Normal Stress ($R_{xx}$)**\n\nThe Boussinesq hypothesis models the Reynolds stress tensor, $R_{ij} \\equiv \\langle u_i' u_j' \\rangle$, as a linear function of the mean-strain tensor, $S_{ij}$:\n$$\nR_{ij} = \\frac{2}{3}k \\, \\delta_{ij} - 2\\nu_t S_{ij}\n$$\nHere, $k$ is the turbulent kinetic energy, $\\nu_t$ is the eddy viscosity, and $\\delta_{ij}$ is the Kronecker delta. The problem specifies a mean-strain tensor for an irrotational stagnation-point flow:\n$$\nS_{ij} = \\mathrm{diag}(-a, a, 0)\n$$\nwith $a > 0$. We are tasked with finding the condition under which the model-predicted streamwise normal stress, $R_{xx}$, exceeds its realizability-consistent maximum value of $2k$. The component $R_{xx}$ corresponds to $i=1$ and $j=1$. Using the provided definition for $S_{ij}$, we have $S_{11} = -a$. The Kronecker delta $\\delta_{11}$ is $1$. Substituting these into the Boussinesq formula yields:\n$$\nR_{xx} = R_{11} = \\frac{2}{3}k \\cdot (1) - 2\\nu_t (-a) = \\frac{2}{3}k + 2\\nu_t a\n$$\nThe model is said to overpredict this stress if it violates the realizability bound $R_{xx} \\le 2k$. The condition for overprediction is therefore:\n$$\nR_{xx} > 2k\n$$\nSubstituting our expression for the modeled $R_{xx}$:\n$$\n\\frac{2}{3}k + 2\\nu_t a > 2k\n$$\nWe solve this inequality for the dimensionless parameters. Assuming $k>0$, we subtract $\\frac{2}{3}k$ from both sides:\n$$\n2\\nu_t a > 2k - \\frac{2}{3}k\n$$\n$$\n2\\nu_t a > \\frac{4}{3}k\n$$\nDividing by $2$ and then by $k$ (since $k>0$), we obtain the condition in terms of the dimensionless strain parameter $\\chi \\equiv \\frac{\\nu_t a}{k}$:\n$$\n\\frac{\\nu_t a}{k} > \\frac{2}{3}\n$$\nThe first boolean result for each test case, $b_1$, is `True` if and only if $\\chi > \\frac{2}{3}$.\n\n**2. Condition for Underprediction of Passive Scalar Flux**\n\nThe turbulent scalar flux along the $x$-direction, $q_x$, is modeled using the gradient-diffusion hypothesis:\n$$\nq_x \\equiv \\langle u_x' \\theta' \\rangle \\approx -\\alpha_t G_x = -\\frac{\\nu_t}{\\mathrm{Pr}_t} G_x\n$$\nwhere $\\mathrm{Pr}_t$ is the turbulent Prandtl number and $G_x$ is the mean scalar gradient. Underprediction of the heat transfer magnitude is defined to occur when the magnitude of the flux calculated with a user-specified model value, $\\mathrm{Pr}_{t,\\mathrm{model}}$, is less than the magnitude of the flux calculated with an empirically determined \"true\" value, $\\mathrm{Pr}_{t,\\mathrm{true}}$:\n$$\n\\left|-\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} G_x\\right| < \\left|-\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}} G_x\\right|\n$$\nGiven that $\\nu_t$, $\\mathrm{Pr}_t$, and $|\\mathrm{G}_x|$ (for a non-trivial gradient) are positive, we can simplify this inequality:\n$$\n\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} < \\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}}\n$$\nDividing by $\\nu_t$ and taking the reciprocal of both sides reverses the inequality sign:\n$$\n\\mathrm{Pr}_{t,\\mathrm{model}} > \\mathrm{Pr}_{t,\\mathrm{true}}\n$$\nThis simple inequality is the condition for underprediction. The value of $\\mathrm{Pr}_{t,\\mathrm{true}}$ is determined by a piecewise-constant function of the dimensionless strain parameter $\\chi = \\frac{\\nu_t a}{k}$:\n$$\n\\mathrm{Pr}_{t,\\mathrm{true}} =\n\\begin{cases}\n    0.7  & \\text{if } \\chi \\ge 0.5 \\\\\n    0.85 & \\text{if } \\chi < 0.5\n\\end{cases}\n$$\nThe second boolean result, $b_2$, is `True` if and only if the given $\\mathrm{Pr}_{t,\\mathrm{model}}$ is greater than the $\\mathrm{Pr}_{t,\\mathrm{true}}$ value determined by this rule.\n\nThe algorithm to be implemented will, for each test case, first compute $\\chi = \\frac{\\nu_t a}{k}$, then evaluate the two boolean conditions derived above.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes two boolean flags for each test case according to the problem statement.\n    1. Boussinesq model overprediction of streamwise normal stress.\n    2. Model underprediction of passive scalar heat transfer.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, k, nu_t, Pr_t_model, G_x)\n    test_cases = [\n        (10.0, 1.0, 0.04, 0.85, 1.0),\n        (10.0, 1.0, 0.06, 0.85, 1.0),\n        (10.0, 1.0, 0.06666666666666667, 0.85, 1.0),\n        (10.0, 1.0, 0.08, 0.90, 1.0),\n        (10.0, 1.0, 0.12, 0.70, 1.0),\n    ]\n\n    results = []\n    \n    # Define constants used in the analysis.\n    RXX_OVERPREDICTION_THRESHOLD = 2.0 / 3.0\n    CHI_PRT_THRESHOLD = 0.5\n    PRT_TRUE_HIGH_STRAIN = 0.7\n    PRT_TRUE_LOW_STRAIN = 0.85\n\n    for case in test_cases:\n        a, k, nu_t, pr_t_model, g_x = case\n\n        # Calculate the dimensionless strain parameter chi.\n        # Assuming k is not zero, which is physically required for turbulence.\n        chi = (nu_t * a) / k\n\n        # Part 1: Check for R_xx overprediction.\n        # The condition derived is chi > 2/3.\n        b1 = chi > RXX_OVERPREDICTION_THRESHOLD\n        \n        # Part 2: Check for heat transfer underprediction.\n        # First, determine the \"true\" turbulent Prandtl number based on chi.\n        if chi >= CHI_PRT_THRESHOLD:\n            pr_t_true = PRT_TRUE_HIGH_STRAIN\n        else:\n            pr_t_true = PRT_TRUE_LOW_STRAIN\n        \n        # The condition for underprediction is Pr_t_model > Pr_t_true.\n        b2 = pr_t_model > pr_t_true\n\n        results.append([b1, b2])\n\n    # Final print statement in the exact required format.\n    # The `map(str, results)` automatically handles the list-to-string conversion\n    # including the boolean capitalization as 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3371220"}]}