{"hands_on_practices": [{"introduction": "Standard turbulence models, such as the $k$-$\\omega$ model, often over-predict turbulent transport in high-speed flows where compressibility effects become significant. This first exercise guides you through the process of developing a correction from first principles by constructing a damping function for the eddy viscosity. By translating physical requirements, such as correct asymptotic behavior at low and high turbulent Mach numbers, into a mathematical form, you will practice a core skill in turbulence model development. [@problem_id:3302839]", "problem": "Consider the Reynolds-Averaged Navier-Stokes (RANS) $k\\text{-}\\omega$ turbulence model for a compressible ideal gas, where the eddy viscosity is modeled via the Boussinesq hypothesis as $\\mu_{t} = \\rho \\, k \\, \\alpha^{*} / \\omega$ with an effective coefficient $\\alpha^{*}$ that may incorporate compressibility effects. Let the turbulent Mach number be defined as $M_{t} = \\sqrt{2 k} / a$, where $k$ is the turbulent kinetic energy and $a = \\sqrt{\\gamma R T}$ is the speed of sound in an ideal gas with ratio of specific heats $\\gamma$, specific gas constant $R$, and absolute temperature $T$.\n\nIn high-speed flows, compressibility introduces additional dilatational effects that modify the turbulence dynamics. Specifically, the dissipation of turbulent kinetic energy can be decomposed into solenoidal and dilatational parts, and for weakly compressible turbulence the dilatational dissipation scales as the square of a suitable Mach number. As a result, eddy-viscosity closures that do not account for this effect may overpredict turbulent transport at elevated $M_{t}$.\n\nStarting from the following foundational bases:\n- The ideal gas relation for speed of sound $a = \\sqrt{\\gamma R T}$,\n- The definition $M_{t} = \\sqrt{2 k} / a$,\n- The dimensional consistency of dissipation and timescales in $k\\text{-}\\omega$ modeling, where the specific dissipation rate $\\omega$ represents an inverse turbulent timescale,\n- The observation that, in the weakly compressible limit, the leading-order compressibility corrections enter as $\\mathcal{O}(M_{t}^{2})$,\n\nderive a dimensionless Mach-number-dependent damping function $f(M_{t})$ to be applied multiplicatively to either the eddy-viscosity coefficient $C_{\\mu}$ or the dissipation coefficient $\\beta^{*}$ in the $k\\text{-}\\omega$ model, such that it satisfies all of the following constraints:\n- Low-Mach asymptotics: $f(0) = 1$ and $f'(0) = 0$, consistent with incompressible behavior and the absence of linear-in-$M_{t}$ corrections.\n- Monotonicity and boundedness: $0  f(M_{t}) \\leq 1$ for all $M_{t} \\geq 0$, and $f(M_{t})$ is strictly decreasing in $M_{t}$.\n- High-Mach limiting behavior: $f(M_{t}) \\to 0$ as $M_{t} \\to \\infty$ so that the eddy viscosity is limited at high turbulent Mach numbers.\n- Single-parameter control: the function includes a single positive parameter $M_{c}$ with the interpretation that $f(M_{t})$ is reduced to $1/2$ when $M_{t} = M_{c}$.\n\nProvide the simplest closed-form analytic expression $f(M_{t})$ that meets the above criteria and is consistent with the $\\mathcal{O}(M_{t}^{2})$ scaling of dilatational effects in the weakly compressible limit. Your final answer must be this explicit function $f(M_{t})$ in terms of $M_{t}$ and $M_{c}$. No numerical evaluation is required, and no units should be included in the final expression.", "solution": "The problem requires the derivation of a dimensionless damping function, $f(M_{t})$, for use in compressible turbulence modeling. This function must satisfy a set of specific mathematical and physical constraints derived from the behavior of turbulence at high speeds. The turbulent Mach number, $M_{t}$, is defined as $M_{t} = \\sqrt{2k}/a$, where $k$ is the turbulent kinetic energy and $a$ is the speed of sound.\n\nThe constraints for the function $f(M_{t})$ are as follows:\n1.  Low-Mach number asymptotics: $f(0) = 1$ and $f'(0) = 0$.\n2.  Monotonicity and boundedness: $0  f(M_{t}) \\leq 1$ for all $M_{t} \\geq 0$, and $f(M_{t})$ must be strictly decreasing for $M_{t}  0$.\n3.  High-Mach number limiting behavior: $\\lim_{M_{t} \\to \\infty} f(M_{t}) = 0$.\n4.  Parameterization: The function must contain a single positive parameter $M_{c}$ such that $f(M_{c}) = 1/2$.\n5.  Physical scaling: The function must be consistent with the leading-order compressibility corrections being of order $\\mathcal{O}(M_{t}^{2})$.\n\nLet us construct the function by systematically incorporating these constraints.\n\nThe fifth constraint, regarding the $\\mathcal{O}(M_{t}^{2})$ scaling, is crucial. It implies that for small values of $M_{t}$, the function $f(M_{t})$ should be well-approximated by its Taylor series expansion around $M_{t}=0$. Combining this with the first constraint, $f(0)=1$ and $f'(0)=0$, the Taylor series must take the form:\n$$\nf(M_{t}) = f(0) + f'(0) M_{t} + \\frac{f''(0)}{2!} M_{t}^{2} + \\mathcal{O}(M_{t}^{3}) = 1 + 0 \\cdot M_{t} + C M_{t}^{2} + \\dots\n$$\nwhere $C = f''(0)/2$ is a constant. The absence of a linear term in $M_{t}$ is consistent with $f'(0)=0$. For the function to be strictly decreasing for $M_{t}0$, the first non-zero derivative after $f'(0)$ must indicate a downward concavity at the maximum, i.e., $f''(0)  0$, which implies $C  0$. This ensures that for small positive $M_t$, $f(M_t)$ is less than $1$.\n\nGiven that the function's behavior is dictated by $M_{t}^{2}$ at low Mach numbers, it is logical to seek a function that depends on $M_{t}$ only through $M_{t}^{2}$. Let us propose a functional form that satisfies the constraints of being bounded between $0$ and $1$, starting at $f(0)=1$, and decaying to zero as $M_{t} \\to \\infty$. A simple and effective choice for such a function is a rational function. We seek the simplest such function.\n\nConsider a function of the form:\n$$\nf(M_{t}) = \\frac{1}{1 + g(M_{t}^{2})}\n$$\nFor this function to satisfy $f(0)=1$, we must have $g(0)=0$. To satisfy $\\lim_{M_{t} \\to \\infty} f(M_{t}) = 0$, we must have $\\lim_{M_{t} \\to \\infty} g(M_{t}^{2}) = \\infty$. The simplest possible function $g(x)$ that satisfies $g(0)=0$ is a linear function, $g(x) = A x$ for some constant $A$. Substituting $x = M_{t}^{2}$, we propose the candidate function:\n$$\nf(M_{t}) = \\frac{1}{1 + A M_{t}^{2}}\n$$\nwhere $A$ is a constant to be determined. Let us verify this candidate against the constraints.\n-   $f(0) = \\frac{1}{1+0} = 1$. (Constraint 1, part 1, satisfied).\n-   The derivative is $f'(M_{t}) = -\\frac{2 A M_{t}}{(1 + A M_{t}^{2})^{2}}$. At $M_{t}=0$, we find $f'(0)=0$. (Constraint 1, part 2, satisfied).\n-   For the function to be strictly decreasing for $M_{t}0$, we need $f'(M_{t})  0$. Since $M_{t}0$ and the denominator is always positive, this requires $A  0$.\n-   If $A0$, then for $M_{t}  0$, the denominator $1+AM_{t}^{2}  1$, which ensures $0  f(M_{t})  1$. At $M_{t}=0$, $f(0)=1$. Thus, $0  f(M_{t}) \\leq 1$ for all $M_{t} \\geq 0$. (Constraint 2 satisfied, provided $A0$).\n-   $\\lim_{M_{t} \\to \\infty} \\frac{1}{1 + A M_{t}^{2}} = 0$. (Constraint 3 satisfied, provided $A0$).\n-   The Taylor expansion for small $M_{t}$ is $(1+AM_{t}^{2})^{-1} = 1 - A M_{t}^{2} + A^{2} M_{t}^{4} - \\dots$, which shows a leading-order correction of $\\mathcal{O}(M_{t}^{2})$. (Constraint 5 satisfied).\n\nThe proposed form $f(M_{t}) = \\frac{1}{1+AM_{t}^{2}}$ with $A0$ is consistent with all constraints except for the parameterization involving $M_{c}$. We now use the fourth constraint, $f(M_{c}) = 1/2$, to determine the constant $A$.\n$$\nf(M_{c}) = \\frac{1}{1 + A M_{c}^{2}} = \\frac{1}{2}\n$$\nSolving for $A$:\n$$\n1 + A M_{c}^{2} = 2\n$$\n$$\nA M_{c}^{2} = 1\n$$\n$$\nA = \\frac{1}{M_{c}^{2}}\n$$\nSince $M_{c}$ is a positive parameter, $A  0$, which is consistent with our earlier finding.\n\nSubstituting this expression for $A$ back into our candidate function gives the final form:\n$$\nf(M_{t}) = \\frac{1}{1 + \\frac{1}{M_{c}^{2}} M_{t}^{2}}\n$$\nThis can be written more elegantly as:\n$$\nf(M_{t}) = \\frac{1}{1 + \\left(\\frac{M_{t}}{M_{c}}\\right)^{2}}\n$$\nThis function is a simple, closed-form analytic expression that satisfies all the stated criteria. It is a rational function of $M_{t}^{2}$, correctly captures the asymptotic behaviors at low and high Mach numbers, and incorporates the single parameter $M_{c}$ as specified. This form is common in the development of compressibility corrections for turbulence models.", "answer": "$$\\boxed{\\frac{1}{1 + \\left(\\frac{M_{t}}{M_{c}}\\right)^{2}}}$$", "id": "3302839"}, {"introduction": "Theoretical models must be grounded in empirical evidence. This practice places you in the role of a research scientist, tasking you with validating a key hypothesis of compressible turbulence theory: that dilatational dissipation, $\\epsilon_d$, scales with the square of the turbulent Mach number, $M_t^2$. You will use regression analysis on synthetic Direct Numerical Simulation (DNS) data to test this scaling law, bridging the gap between theoretical formulation and data-driven validation. [@problem_id:3302802]", "problem": "Consider a compressible, Newtonian fluid governed by the compressible Navier–Stokes equations and the energy equation. The viscous dissipation rate per unit mass can be decomposed into a solenoidal part and a dilatational part. Let $\\epsilon$ denote the total dissipation rate, $\\epsilon_s$ the solenoidal dissipation rate, and $\\epsilon_d$ the dilatational dissipation rate, where the dilatational contribution is associated with the square of the velocity divergence. In homogeneous shear turbulence, under low turbulent Mach number conditions, it is hypothesized that the normalized dilatational dissipation ratio depends quadratically on the turbulent Mach number. Define the turbulent Mach number $M_t$ as $M_t = \\sqrt{2k}/a$, where $k$ is the turbulent kinetic energy per unit mass and $a$ is the speed of sound. The ratio of interest is $R \\equiv \\epsilon_d/\\epsilon$, which is dimensionless. You are given three synthetic datasets derived from plausible Direct Numerical Simulation (DNS) of homogeneous shear turbulence, each consisting of paired values of $M_t$ and $R$. All quantities are dimensionless, so no physical unit conversion is required.\n\nYour task is to implement the following procedure entirely in software logic:\n- For each dataset, compute $X_i = M_{t,i}^2$ and $Y_i = R_i$ for all data points $i$.\n- Estimate the proportionality coefficient for the hypothesized quadratic-in-$M_t$ scaling by a least-squares fit constrained through the origin. That is, fit $Y_i$ versus $X_i$ with zero intercept, and report the slope as the estimated coefficient.\n- Also perform an unconstrained linear least-squares fit with a free intercept to capture possible nonzero offset effects, by fitting $Y_i$ versus $X_i$ with both slope and intercept.\n- Quantify the goodness of fit of the origin-constrained model using the coefficient of determination $R^2$ computed against the sample mean of $Y_i$.\n- Decide whether the quadratic-in-$M_t$ scaling with zero intercept is acceptable for each dataset using the following acceptance rule: accept if and only if the unconstrained fit intercept magnitude is less than $5\\times 10^{-3}$ and the origin-constrained fit has coefficient of determination not less than $0.98$.\n\nUse the following test suite of datasets, each given as an ordered pair of lists $(\\{M_t\\},\\{R\\})$:\n- Dataset $\\mathsf{A}$ (general case): $M_t = [\\,0.05,0.10,0.20,0.30,0.40\\,]$, $R = [\\,0.00355,0.01400,0.05800,0.13200,0.23500\\,]$.\n- Dataset $\\mathsf{B}$ (boundary near zero $M_t$): $M_t = [\\,0.01,0.02,0.03,0.05\\,]$, $R = [\\,0.00015,0.00045,0.00095,0.00255\\,]$.\n- Dataset $\\mathsf{C}$ (edge case with trend not dominated by $M_t^2$): $M_t = [\\,0.20,0.40,0.60,0.80\\,]$, $R = [\\,0.15,0.25,0.35,0.45\\,]$.\n\nYour program must compute, for each dataset, a result list of the form $[\\,C_{\\mathrm{origin}},C_{\\mathrm{free}},b_0,R^2_{\\mathrm{origin}},\\mathrm{accept}\\,]$, where $C_{\\mathrm{origin}}$ is the origin-constrained slope, $C_{\\mathrm{free}}$ is the unconstrained slope, $b_0$ is the unconstrained intercept, $R^2_{\\mathrm{origin}}$ is the coefficient of determination for the origin-constrained fit, and $\\mathrm{accept}$ is a boolean indicating whether the acceptance rule is satisfied.\n\nFinal Output Format: Your program should produce a single line of output containing the three dataset results as a comma-separated list enclosed in square brackets with no spaces. Each dataset result must itself be a bracket-enclosed list $[\\,C_{\\mathrm{origin}},C_{\\mathrm{free}},b_0,R^2_{\\mathrm{origin}},\\mathrm{accept}\\,]$ in that exact order. For example, the output must have the form $[[\\dots],[\\dots],[\\dots]]$ with no spaces anywhere.\n\nAll reported quantities are dimensionless. Angles are not involved. All numerical outputs must be decimals. The boolean outputs must be either $\\mathrm{True}$ or $\\mathrm{False}$.", "solution": "The problem is valid. It is scientifically grounded in the field of compressible turbulence modeling, well-posed as a data analysis task, and presented with objective, unambiguous criteria. The provided data and parameters are self-contained and consistent.\n\nThe core task is to test the hypothesis that the dilatational dissipation ratio, $R \\equiv \\epsilon_d/\\epsilon$, is proportional to the square of the turbulent Mach number, $M_t$. The hypothesized relationship is $R = C M_t^2$ for some proportionality constant $C$. This will be evaluated for three distinct datasets. The procedure involves transforming the variables, performing two types of linear regression, quantifying the goodness of fit, and applying a defined acceptance rule.\n\nFirst, we linearize the hypothesized relationship by setting $Y_i = R_i$ and $X_i = M_{t,i}^2$ for each data point $i$ in a given dataset. The model becomes a simple linear relationship, $Y = C X$.\n\nWe are required to perform two separate linear least-squares fits for the data pairs $(X_i, Y_i)$.\n\nThe first fit is constrained to pass through the origin, consistent with the physical hypothesis that for $M_t=0$, the dilatational dissipation should be zero ($R=0$). The model is $Y_i = C_{\\mathrm{origin}} X_i$. The slope $C_{\\mathrm{origin}}$ is found by minimizing the sum of squared residuals, $S = \\sum_{i=1}^{n} (Y_i - C_{\\mathrm{origin}} X_i)^2$, where $n$ is the number of data points. The value of $C_{\\mathrm{origin}}$ that minimizes $S$ is given by:\n$$ C_{\\mathrm{origin}} = \\frac{\\sum_{i=1}^{n} X_i Y_i}{\\sum_{i=1}^{n} X_i^2} $$\n\nThe second fit is an unconstrained linear regression, which includes an intercept term $b_0$. The model is $Y_i = C_{\\mathrm{free}} X_i + b_0$. This fit helps to detect any systematic offset in the data that would contradict the idealized model. The coefficients $C_{\\mathrm{free}}$ and $b_0$ are determined by minimizing the sum of squared residuals $S = \\sum_{i=1}^{n} (Y_i - (C_{\\mathrm{free}} X_i + b_0))^2$. The standard solution for this minimization problem is:\n$$ C_{\\mathrm{free}} = \\frac{n \\sum_{i=1}^{n} X_i Y_i - \\left(\\sum_{i=1}^{n} X_i\\right)\\left(\\sum_{i=1}^{n} Y_i\\right)}{n \\sum_{i=1}^{n} X_i^2 - \\left(\\sum_{i=1}^{n} X_i\\right)^2} $$\n$$ b_0 = \\bar{Y} - C_{\\mathrm{free}} \\bar{X} $$\nwhere $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ and $\\bar{Y} = \\frac{1}{n} \\sum_{i=1}^{n} Y_i$ are the sample means.\n\nTo evaluate the origin-constrained model, we compute its coefficient of determination, $R^2_{\\mathrm{origin}}$. As specified, this is calculated relative to the total sum of squares about the sample mean of $Y_i$. This is a crucial detail, as there are multiple definitions of $R^2$ for models without an intercept. The specified definition is:\n$$ R^2_{\\mathrm{origin}} = 1 - \\frac{\\mathrm{SS}_{\\mathrm{res}}}{\\mathrm{SS}_{\\mathrm{tot}}} = 1 - \\frac{\\sum_{i=1}^{n} (Y_i - \\hat{Y}_i)^2}{\\sum_{i=1}^{n} (Y_i - \\bar{Y})^2} $$\nwhere $\\hat{Y}_i = C_{\\mathrm{origin}} X_i$ are the predicted values from the origin-constrained model. An $R^2$ value close to $1$ indicates that the model explains a large proportion of the variance in the data.\n\nFinally, a decision rule is applied to determine if the origin-constrained quadratic scaling is an acceptable model for each dataset. The model is accepted if and only if two conditions are met simultaneously:\n$1$. The magnitude of the intercept from the unconstrained fit is negligible, specifically $|b_0|  5 \\times 10^{-3}$.\n$2$. The origin-constrained model provides a good fit, specifically $R^2_{\\mathrm{origin}} \\ge 0.98$.\n\nThis entire procedure will be implemented in a program that processes each of the three provided datasets ($\\mathsf{A}$, $\\mathsf{B}$, and $\\mathsf{C}$) and outputs the calculated parameters $[\\,C_{\\mathrm{origin}}, C_{\\mathrm{free}}, b_0, R^2_{\\mathrm{origin}}, \\mathrm{accept}\\,]$ for each case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import stats # Scipy is allowed but not strictly necessary for this problem.\n\ndef solve():\n    \"\"\"\n    Main function to process datasets and print the final result.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        (\n            [0.05, 0.10, 0.20, 0.30, 0.40],\n            [0.00355, 0.01400, 0.05800, 0.13200, 0.23500]\n        ),\n        # Dataset B\n        (\n            [0.01, 0.02, 0.03, 0.05],\n            [0.00015, 0.00045, 0.00095, 0.00255]\n        ),\n        # Dataset C\n        (\n            [0.20, 0.40, 0.60, 0.80],\n            [0.15, 0.25, 0.35, 0.45]\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        mt_data, r_data = case\n        result = analyze_dataset(mt_data, r_data)\n        results.append(result)\n\n    # Format the final output string as per requirements.\n    # Each sub-list is formatted as a string, then joined by commas.\n    result_strings = []\n    for res_list in results:\n        # str() correctly handles floats and booleans (e.g., True - \"True\")\n        list_str = f\"[{','.join(map(str, res_list))}]\"\n        result_strings.append(list_str)\n    \n    # Final print statement in the exact required format: [[...],[...],[...]]\n    print(f\"[{','.join(result_strings)}]\")\n\ndef analyze_dataset(mt_data, r_data):\n    \"\"\"\n    Performs the required analysis for a single dataset.\n    \n    Args:\n        mt_data (list): A list of turbulent Mach numbers (M_t).\n        r_data (list): A list of dilatational dissipation ratios (R).\n\n    Returns:\n        list: A list containing [C_origin, C_free, b0, R2_origin, accept].\n    \"\"\"\n    # Convert lists to NumPy arrays for vectorized operations.\n    mt = np.array(mt_data, dtype=float)\n    r = np.array(r_data, dtype=float)\n    \n    # Step 1: Compute X_i = M_{t,i}^2 and Y_i = R_i.\n    x = mt**2\n    y = r\n    \n    # Step 2: Estimate the origin-constrained slope C_origin.\n    # C_origin = sum(X*Y) / sum(X^2)\n    sum_xy = np.sum(x * y)\n    sum_x_sq = np.sum(x**2)\n    c_origin = sum_xy / sum_x_sq\n    \n    # Step 3: Perform unconstrained linear fit to get C_free and b0.\n    # Y = C_free * X + b0\n    # A robust way is to use np.polyfit.\n    c_free, b0 = np.polyfit(x, y, 1)\n\n    # Step 4: Quantify goodness of fit of the origin-constrained model.\n    # R2_origin = 1 - SS_res / SS_tot\n    y_mean = np.mean(y)\n    ss_tot = np.sum((y - y_mean)**2)\n    # Handle the case where all Y values are the same (SS_tot = 0) to avoid division by zero.\n    if ss_tot == 0:\n        y_pred_origin = c_origin * x\n        # If model is perfect, SS_res is 0. If not, R^2 is undefined or -inf.\n        # Given the problem context, this case is unlikely, but good practice to handle.\n        # If y is constant and the model is not also constant at that value, the fit is poor.\n        ss_res = np.sum((y - y_pred_origin)**2)\n        r2_origin = 1.0 if ss_res == 0 else -np.inf \n    else:\n        y_pred_origin = c_origin * x\n        ss_res = np.sum((y - y_pred_origin)**2)\n        r2_origin = 1.0 - (ss_res / ss_tot)\n        \n    # Step 5: Apply the acceptance rule.\n    # accept if |b0|  5e-3 AND R2_origin = 0.98\n    is_intercept_small = np.abs(b0)  5e-3\n    is_fit_good = r2_origin = 0.98\n    accept = is_intercept_small and is_fit_good\n    \n    return [c_origin, c_free, b0, r2_origin, accept]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3302802"}, {"introduction": "Incorporating new physics into a model can introduce unforeseen numerical challenges. This final practice explores the practical consequences of implementing compressibility corrections by analyzing the numerical stiffness they can create in a solver. You will derive the Jacobian matrix for a corrected $k$-$\\epsilon$ model and determine its stability limit, gaining insight into the crucial interplay between physical modeling and numerical methods in CFD. [@problem_id:3302823]", "problem": "Consider a single, well-mixed control volume in a compressible turbulent flow, modeled by the Reynolds-Averaged Navier–Stokes (RANS) two-equation turbulence model for turbulent kinetic energy ($k$) and turbulent dissipation rate ($\\epsilon$). Neglecting advection and molecular diffusion, the homogeneous source-only ordinary differential equation system is\n$$\n\\frac{dk}{dt} \\;=\\; P_k \\;-\\; \\epsilon,\n\\qquad\n\\frac{d\\epsilon}{dt} \\;=\\; C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} \\;-\\; C_{\\epsilon 2}\\,f(M_t)\\,\\frac{\\epsilon^2}{k},\n$$\nwhere $P_k$ is the production of turbulent kinetic energy, $C_{\\epsilon 1}$ and $C_{\\epsilon 2}$ are positive model constants, and $f(M_t)$ is a Mach-dependent compressibility correction. Assume a commonly used algebraic damping form\n$$\nf(M_t) \\;=\\; 1 \\;+\\; \\beta\\,M_t^2,\n\\qquad \nM_t \\;=\\; \\frac{\\sqrt{2k}}{a},\n$$\nwhere $M_t$ is the turbulent Mach number, $\\beta$ is a positive coefficient, and $a$ is the local speed of sound.\n\nYou will examine the stiffness introduced by $f(M_t)$ and derive a time-step restriction for an explicit Forward Euler time integrator applied to the above system. Specifically, proceed from the following well-tested bases:\n- The source-only semi-discrete system $\\dot{\\mathbf{U}}=\\mathbf{R}(\\mathbf{U})$ with $\\mathbf{U}=[k,\\epsilon]^T$ and Forward Euler update $\\mathbf{U}^{n+1}=\\mathbf{U}^n+\\Delta t\\,\\mathbf{R}(\\mathbf{U}^n)$ is linearly stable if, upon local linearization $\\mathbf{R}(\\mathbf{U})\\approx \\mathbf{J}(\\mathbf{U}^n)(\\mathbf{U}-\\mathbf{U}^n)$, all eigenvalues $\\lambda$ of the Jacobian $\\mathbf{J}(\\mathbf{U}^n)$ satisfy $|1+\\Delta t\\,\\lambda|1$.\n- The turbulent Mach number definition $M_t=\\sqrt{2k}/a$ and the functional dependence $f(M_t)=1+\\beta M_t^2$.\n\nAssume the following parameter values and instantaneous state at time level $n$:\n- $C_{\\epsilon 1}=1.44$, $C_{\\epsilon 2}=1.92$, $\\beta=1.5$,\n- $a = 340\\,\\mathrm{m/s}$,\n- $k^n = 5.2\\times 10^3\\,\\mathrm{m}^2/\\mathrm{s}^2$, $\\epsilon^n = 5.2\\times 10^6\\,\\mathrm{m}^2/\\mathrm{s}^3$,\n- $P_k^n = 4.16\\times 10^6\\,\\mathrm{m}^2/\\mathrm{s}^3$.\n\nTasks:\n1) Derive the $2\\times 2$ Jacobian $\\mathbf{J}=\\partial \\mathbf{R}/\\partial \\mathbf{U}$, making explicit use of the dependence of $f$ on $k$ through $M_t$, and evaluate $\\mathbf{J}$ at the given state.\n2) Compute the eigenvalues of $\\mathbf{J}$ and determine the largest time step $\\Delta t_{\\max}$ for which Forward Euler is linearly stable.\n3) Briefly state a minimally intrusive implicit treatment that would remove the stiffness originating from the Mach-dependent damping without fully implicit coupling of the entire system (your proposal itself does not need to be computed numerically).\n\nExpress the final $\\Delta t_{\\max}$ in milliseconds, and round your answer to three significant figures. The final answer must be a single real number. Do not include units in the final boxed answer, but use milliseconds in your reasoning and intermediate presentation.", "solution": "The user requests an analysis of the numerical stiffness of a simplified two-equation turbulence model and a derivation of the corresponding explicit time-step limit. The problem is scientifically grounded in computational fluid dynamics and numerical analysis, well-posed, and contains all necessary data. The provided physical parameters are consistent and realistic. The problem is therefore deemed valid.\n\nThe system of ordinary differential equations is given by $\\dot{\\mathbf{U}}=\\mathbf{R}(\\mathbf{U})$, where the state vector is $\\mathbf{U}=[k, \\epsilon]^T$ and the source vector $\\mathbf{R}=[R_k, R_\\epsilon]^T$ is:\n$$\nR_k(k, \\epsilon) = P_k - \\epsilon\n$$\n$$\nR_\\epsilon(k, \\epsilon) = C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} - C_{\\epsilon 2}\\,f(M_t)\\,\\frac{\\epsilon^2}{k}\n$$\nThe compressibility correction function is $f(M_t) = 1 + \\beta\\,M_t^2$, with the turbulent Mach number squared being $M_t^2 = 2k/a^2$. We can substitute this into the expression for $R_\\epsilon$:\n$$\nR_\\epsilon(k, \\epsilon) = C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} - C_{\\epsilon 2}\\,\\left(1 + \\frac{2\\beta k}{a^2}\\right)\\,\\frac{\\epsilon^2}{k} = C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} - C_{\\epsilon 2}\\,\\frac{\\epsilon^2}{k} - C_{\\epsilon 2}\\,\\frac{2\\beta}{a^2}\\,\\epsilon^2\n$$\n\n**1) Derivation and Evaluation of the Jacobian Matrix**\n\nThe Jacobian matrix $\\mathbf{J}$ is defined as $\\mathbf{J} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{U}} = \\begin{pmatrix} \\partial R_k / \\partial k  \\partial R_k / \\partial \\epsilon \\\\ \\partial R_\\epsilon / \\partial k  \\partial R_\\epsilon / \\partial \\epsilon \\end{pmatrix}$. At the time level $n$, $P_k^n$ is treated as a constant parameter.\n\nThe elements of the first row are:\n$$\nJ_{11} = \\frac{\\partial R_k}{\\partial k} = \\frac{\\partial}{\\partial k}(P_k - \\epsilon) = 0\n$$\n$$\nJ_{12} = \\frac{\\partial R_k}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon}(P_k - \\epsilon) = -1\n$$\n\nThe elements of the second row are derived from the expanded expression for $R_\\epsilon$:\n$$\nJ_{21} = \\frac{\\partial R_\\epsilon}{\\partial k} = \\frac{\\partial}{\\partial k}\\left(C_{\\epsilon 1}\\,P_k\\,\\epsilon\\,k^{-1} - C_{\\epsilon 2}\\,\\epsilon^2\\,k^{-1} - C_{\\epsilon 2}\\,\\frac{2\\beta}{a^2}\\,\\epsilon^2\\right) = -C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k^2} + C_{\\epsilon 2}\\,\\frac{\\epsilon^2}{k^2} = \\frac{\\epsilon}{k^2}(C_{\\epsilon 2}\\,\\epsilon - C_{\\epsilon 1}\\,P_k)\n$$\n$$\nJ_{22} = \\frac{\\partial R_\\epsilon}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon}\\left(C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} - C_{\\epsilon 2}\\,\\frac{\\epsilon^2}{k} - C_{\\epsilon 2}\\,\\frac{2\\beta}{a^2}\\,\\epsilon^2\\right) = C_{\\epsilon 1}\\,\\frac{P_k}{k} - 2\\,C_{\\epsilon 2}\\,\\frac{\\epsilon}{k} - 2\\,C_{\\epsilon 2}\\,\\frac{2\\beta}{a^2}\\,\\epsilon\n$$\nFactoring $J_{22}$ and recognizing $f(M_t) = 1 + 2\\beta k/a^2$, we obtain the more compact form:\n$$\nJ_{22} = C_{\\epsilon 1}\\,\\frac{P_k}{k} - 2\\,C_{\\epsilon 2}\\,\\frac{\\epsilon}{k}\\left(1 + \\frac{2\\beta k}{a^2}\\right) = C_{\\epsilon 1}\\,\\frac{P_k}{k} - 2\\,C_{\\epsilon 2}\\,f(M_t)\\,\\frac{\\epsilon}{k}\n$$\nSo, the Jacobian matrix is:\n$$\n\\mathbf{J} = \\begin{pmatrix} 0  -1 \\\\ \\frac{\\epsilon}{k^2}(C_{\\epsilon 2}\\,\\epsilon - C_{\\epsilon 1}\\,P_k)  \\frac{1}{k}(C_{\\epsilon 1}\\,P_k - 2\\,C_{\\epsilon 2}\\,f(M_t)\\,\\epsilon) \\end{pmatrix}\n$$\nWe now evaluate $\\mathbf{J}$ at the given state $n$: $k^n = 5.2\\times 10^3\\,\\mathrm{m}^2/\\mathrm{s}^2$, $\\epsilon^n = 5.2\\times 10^6\\,\\mathrm{m}^2/\\mathrm{s}^3$, $P_k^n = 4.16\\times 10^6\\,\\mathrm{m}^2/\\mathrm{s}^3$, $C_{\\epsilon 1}=1.44$, $C_{\\epsilon 2}=1.92$, $\\beta=1.5$, and $a=340\\,\\mathrm{m/s}$.\nFirst, we compute the required ratios and intermediate values:\n$$\n\\frac{\\epsilon^n}{k^n} = \\frac{5.2\\times 10^6}{5.2\\times 10^3} = 10^{3}\\,\\mathrm{s}^{-1}\n$$\n$$\n\\frac{P_k^n}{\\epsilon^n} = \\frac{4.16\\times 10^6}{5.2\\times 10^6} = 0.8\n$$\n$$\nM_t^{2,n} = \\frac{2k^n}{a^2} = \\frac{2 \\times 5.2 \\times 10^3}{340^2} = \\frac{10400}{115600} \\approx 0.089965\n$$\n$$\nf(M_t^n) = 1 + \\beta M_t^{2,n} = 1 + 1.5 \\times 0.089965 \\approx 1.13495\n$$\nNow we compute the Jacobian elements:\n$$\nJ_{11} = 0\n$$\n$$\nJ_{12} = -1\n$$\n$$\nJ_{21} = \\frac{(\\epsilon^n)^2}{(k^n)^2} (C_{\\epsilon 2} - C_{\\epsilon 1}\\,\\frac{P_k^n}{\\epsilon^n}) = (10^3)^2 (1.92 - 1.44 \\times 0.8) = 10^6 (1.92 - 1.152) = 7.68 \\times 10^5 \\,\\mathrm{s}^{-2}\n$$\n$$\nJ_{22} = \\frac{\\epsilon^n}{k^n}(C_{\\epsilon 1}\\frac{P_k^n}{\\epsilon^n} - 2\\,C_{\\epsilon 2}f(M_t^n)) = 10^3 (1.44 \\times 0.8 - 2 \\times 1.92 \\times 1.13495) = 10^3(1.152 - 4.3582) \\approx -3206.2\\,\\mathrm{s}^{-1}\n$$\nThe evaluated Jacobian is:\n$$\n\\mathbf{J} \\approx \\begin{pmatrix} 0  -1 \\\\ 7.68 \\times 10^5  -3206.2 \\end{pmatrix}\n$$\n\n**2) Eigenvalues and Maximum Time Step**\n\nThe eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(\\mathbf{J}-\\lambda\\mathbf{I}) = 0$.\n$$\n\\det\\begin{pmatrix} -\\lambda  -1 \\\\ 7.68 \\times 10^5  -3206.2 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-3206.2 - \\lambda) - (-1)(7.68 \\times 10^5) = 0\n$$\n$$\n\\lambda^2 + 3206.2 \\lambda + 7.68 \\times 10^5 = 0\n$$\nUsing the quadratic formula $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\n\\lambda = \\frac{-3206.2 \\pm \\sqrt{3206.2^2 - 4(1)(7.68 \\times 10^5)}}{2}\n$$\n$$\n\\lambda = \\frac{-3206.2 \\pm \\sqrt{10279718.44 - 3072000}}{2} = \\frac{-3206.2 \\pm \\sqrt{7207718.44}}{2}\n$$\n$$\n\\lambda = \\frac{-3206.2 \\pm 2684.719}{2}\n$$\nThe two eigenvalues are:\n$$\n\\lambda_1 = \\frac{-3206.2 + 2684.719}{2} = \\frac{-521.481}{2} = -260.74\\,\\mathrm{s}^{-1}\n$$\n$$\n\\lambda_2 = \\frac{-3206.2 - 2684.719}{2} = \\frac{-5890.919}{2} = -2945.46\\,\\mathrm{s}^{-1}\n$$\nBoth eigenvalues are real and negative. For a Forward Euler scheme to be stable, the time step $\\Delta t$ must satisfy $|1+\\Delta t \\lambda|  1$ for all eigenvalues $\\lambda$. For real negative eigenvalues, this condition simplifies to $\\Delta t  \\frac{2}{|\\lambda|}$. To ensure stability for the entire system, $\\Delta t$ must be smaller than the limit imposed by the eigenvalue with the largest magnitude.\n$$\n|\\lambda|_{\\max} = \\max(|\\lambda_1|, |\\lambda_2|) = |-2945.46| = 2945.46\\,\\mathrm{s}^{-1}\n$$\nThe maximum stable time step is:\n$$\n\\Delta t_{\\max} = \\frac{2}{|\\lambda|_{\\max}} = \\frac{2}{2945.46} \\approx 6.7909 \\times 10^{-4}\\,\\mathrm{s}\n$$\nThe problem asks for the result in milliseconds, rounded to three significant figures.\n$$\n\\Delta t_{\\max} \\approx 0.67909\\,\\mathrm{ms} \\approx 0.679\\,\\mathrm{ms}\n$$\n\n**3) Minimally Intrusive Implicit Treatment**\n\nThe stiffness of the system arises primarily from the destruction term in the $\\epsilon$-equation, $-C_{\\epsilon 2}f(M_t)\\epsilon^2/k$. Its partial derivative with respect to $\\epsilon$, which is the dominant part of the $J_{22}$ entry, leads to a large negative eigenvalue and thus a restrictive time-step limit for explicit methods.\n\nA minimally intrusive method to alleviate this stiffness is a point-wise semi-implicit treatment of a single term. Specifically, we treat the stiff destruction term implicitly while keeping all other terms explicit. In the $\\epsilon$-equation, we linearize the implicit term to maintain a simple, uncoupled update procedure. A common and simple way to achieve this is to evaluate one factor of $\\epsilon$ in the destruction term at the new time level $n+1$:\n$$\n\\frac{\\epsilon^{n+1}-\\epsilon^n}{\\Delta t} = C_{\\epsilon 1}\\,\\frac{P_k^n\\,\\epsilon^n}{k^n} - C_{\\epsilon 2}\\,f(M_t^n)\\,\\frac{\\epsilon^n\\epsilon^{n+1}}{k^n}\n$$\nThis is a linear equation for $\\epsilon^{n+1}$ that can be solved algebraically without matrix inversion:\n$$\n\\epsilon^{n+1}\\left(1 + \\Delta t \\, C_{\\epsilon 2}\\,f(M_t^n)\\frac{\\epsilon^n}{k^n}\\right) = \\epsilon^n + \\Delta t \\, C_{\\epsilon 1}\\,\\frac{P_k^n\\,\\epsilon^n}{k^n}\n$$\n$$\n\\epsilon^{n+1} = \\frac{\\epsilon^n \\left(1 + \\Delta t \\, C_{\\epsilon 1}\\,\\frac{P_k^n}{k^n}\\right)}{1 + \\Delta t \\, C_{\\epsilon 2}\\,f(M_t^n)\\,\\frac{\\epsilon^n}{k^n}}\n$$\nThis treatment removes the stiffness associated with the $\\epsilon$-destruction term, greatly relaxing the time-step constraint. The $k$-equation can be subsequently updated using an explicit step, e.g., $\\frac{k^{n+1}-k^n}{\\Delta t} = P_k^n - \\epsilon^{n+1}$. This point-implicit approach avoids forming or inverting the full Jacobian matrix, making it minimally intrusive yet highly effective.", "answer": "$$\\boxed{0.679}$$", "id": "3302823"}]}