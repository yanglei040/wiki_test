{"hands_on_practices": [{"introduction": "A foundational exercise in turbulence theory is to analyze the simplest possible scenario: turbulence that is left to decay on its own, without any source of energy production. This practice guides you through the simplification of the transport equation for turbulent kinetic energy, $k$, for the idealized case of homogeneous isotropic turbulence. By applying a classic closure model for the dissipation rate, $\\varepsilon$, you will derive and solve an equation that predicts how turbulence fades over time, offering a first-hand look at the power and inherent assumptions of turbulence modeling [@problem_id:3379218].", "problem": "Consider incompressible, decaying, homogeneous isotropic turbulence (HIT) of a Newtonian fluid at high Reynolds number in an unbounded domain, with zero mean shear and spatially uniform mean flow. Starting from the instantaneous incompressible Navier–Stokes equations and using Reynolds decomposition, define the Reynolds stress tensor $R_{ij}=\\overline{u_{i}^{\\prime}u_{j}^{\\prime}}$ and the turbulent kinetic energy $k=\\tfrac{1}{2}\\overline{u_{i}^{\\prime}u_{i}^{\\prime}}$. Derive the exact kinetic energy budget implied by the trace of the Reynolds stress transport equation, and then specialize it to this HIT setting to justify the estimates $P=0$ for the production and $T_{k}\\approx 0$ for the net transport of $k$. Close the remaining dissipation term by adopting the commonly used high-Reynolds-number model $\\varepsilon=C_{\\varepsilon}\\,k^{3/2}/L$, where $C_{\\varepsilon}$ is a positive constant and $L$ is an integral length scale. Over a finite decay interval, assume $L$ is approximately time-independent. With initial condition $k(0)=k_{0}0$, solve the resulting ordinary differential equation for $k(t)$ and determine the asymptotic decay exponent $n$ defined by the power-law behavior $k(t)\\sim A\\,t^{-n}$ as $t\\to\\infty$, where $A0$ is a constant. Report the value of $n$ as your final answer. Briefly comment on how this prediction compares to typical experimental decay exponents reported for grid-generated turbulence. The final answer must be a single number with no units and does not require rounding.", "solution": "The transport equation for the turbulent kinetic energy (TKE), $k = \\frac{1}{2}\\overline{u_i'u_i'}$, is derived by taking half the trace of the Reynolds stress transport equation. A more direct derivation proceeds by multiplying the momentum equation for the fluctuating velocity $u_i'$ by $u_i'$ and averaging. The resulting exact TKE budget equation is:\n$$\n\\frac{\\partial k}{\\partial t} + U_j \\frac{\\partial k}{\\partial x_j} = P - \\varepsilon - T_k^{\\text{turb}} + T_k^{\\text{press}} + T_k^{\\text{visc}}\n$$\nwhere the terms are:\n1.  Rate of change of $k$: The left-hand side, $\\frac{Dk}{Dt} = \\frac{\\partial k}{\\partial t} + U_j \\frac{\\partial k}{\\partial x_j}$, is the material derivative of $k$ following the mean flow.\n2.  Production ($P$): $P = -\\overline{u_i'u_j'} \\frac{\\partial U_i}{\\partial x_j}$. This term represents the transfer of kinetic energy from the mean flow to the turbulent fluctuations. It is nonzero only in the presence of mean velocity gradients (shear).\n3.  Dissipation ($\\varepsilon$): $\\varepsilon = \\nu \\overline{\\frac{\\partial u_i'}{\\partial x_j} \\frac{\\partial u_i'}{\\partial x_j}}$. This term represents the rate at which TKE is converted into internal energy (heat) by viscous action at the smallest scales of motion. It is always a sink term ($ \\varepsilon \\ge 0 $).\n4.  Turbulent Transport ($T_k^{\\text{turb}}$): $\\frac{\\partial}{\\partial x_j} \\left(\\frac{1}{2}\\overline{u_i'u_i'u_j'}\\right)$. This term represents the spatial redistribution of TKE by the velocity fluctuations themselves.\n5.  Pressure Transport ($T_k^{\\text{press}}$): $\\frac{\\partial}{\\partial x_j} \\left(\\frac{1}{\\rho}\\overline{p'u_j'}\\right)$. This term describes the spatial redistribution of TKE by pressure fluctuations.\n6.  Viscous Transport ($T_k^{\\text{visc}}$): $-\\nu \\frac{\\partial^2 k}{\\partial x_j \\partial x_j}$. This term describes the spatial redistribution of TKE by viscous forces.\n\nThe net transport of $k$, denoted as $T_k$ in the problem, is the sum of the spatial redistribution terms, which can be written in divergence form:\n$T_k = \\frac{\\partial}{\\partial x_j} \\left( \\frac{1}{2}\\overline{u_i'u_i'u_j'} + \\frac{1}{\\rho}\\overline{p'u_j'} - \\nu \\frac{\\partial k}{\\partial x_j} \\right)$.\n\nThe problem specifies homogeneous isotropic turbulence (HIT). We now apply these conditions to simplify the TKE budget.\n- **Homogeneity**: By definition, in homogeneous turbulence, all single-point statistical quantities (like $k$, $\\overline{u_i'u_j'}$, etc.) are independent of spatial location. Therefore, any spatial derivative of a mean quantity is zero.\n    - The problem states \"zero mean shear\", which means $\\frac{\\partial U_i}{\\partial x_j} = 0$. Consequently, the production term is exactly zero: $P = -\\overline{u_i'u_j'} \\frac{\\partial U_i}{\\partial x_j} = 0$.\n    - The net transport $T_k$ is expressed as a divergence of mean quantities. Since spatial derivatives of all mean quantities are zero in homogeneous turbulence, the net transport is also exactly zero: $T_k = 0$. This justifies the estimate $T_k \\approx 0$ given in the problem (it is exactly zero for ideal homogeneity).\n- **Isotropy**: Isotropic turbulence is statistically invariant to rotations of the coordinate axes. This is a stronger condition than homogeneity but is applied here as well. The main consequence used in validating $P=0$ (if one didn't assume zero shear outright) is that for isotropic turbulence, the Reynolds stress tensor is diagonal: $\\overline{u_i'u_j'} = \\frac{2}{3}k\\delta_{ij}$. For an incompressible mean flow ($\\frac{\\partial U_i}{\\partial x_i}=0$), this also leads to zero production: $P = - \\frac{2}{3}k\\delta_{ij}\\frac{\\partial U_i}{\\partial x_j} = - \\frac{2}{3}k\\frac{\\partial U_i}{\\partial x_i} = 0$.\n\nWith $P=0$ and $T_k=0$, and noting that in homogeneous turbulence $U_j \\frac{\\partial k}{\\partial x_j}=0$, the TKE budget equation simplifies to:\n$$\n\\frac{dk}{dt} = -\\varepsilon\n$$\nThis equation describes decaying turbulence, where the turbulent kinetic energy decreases over time solely due to viscous dissipation.\n\nTo solve this equation, we need a \"closure model\" for $\\varepsilon$. The problem provides the high-Reynolds-number model:\n$$\n\\varepsilon = C_{\\varepsilon} \\frac{k^{3/2}}{L}\n$$\nwhere $C_{\\varepsilon}$ is a positive constant and $L$ is a characteristic length scale of the large eddies, assumed to be constant in time. Substituting this into the simplified TKE equation gives the ordinary differential equation (ODE) for $k(t)$:\n$$\n\\frac{dk}{dt} = - \\frac{C_{\\varepsilon}}{L} k^{3/2}\n$$\nThis is a separable ODE. We separate the variables:\n$$\nk^{-3/2} dk = - \\frac{C_{\\varepsilon}}{L} dt\n$$\nWe integrate this equation from the initial time $t=0$ where $k(0)=k_0$ to a later time $t$:\n$$\n\\int_{k_0}^{k(t)} k'^{-3/2} dk' = \\int_0^t - \\frac{C_{\\varepsilon}}{L} dt'\n$$\n$$\n\\left[ \\frac{k'^{-1/2}}{-1/2} \\right]_{k_0}^{k(t)} = - \\frac{C_{\\varepsilon}}{L} t\n$$\n$$\n-2 \\left( k(t)^{-1/2} - k_0^{-1/2} \\right) = - \\frac{C_{\\varepsilon}}{L} t\n$$\n$$\nk(t)^{-1/2} - k_0^{-1/2} = \\frac{C_{\\varepsilon}}{2L} t\n$$\nSolving for $k(t)$:\n$$\nk(t)^{-1/2} = k_0^{-1/2} + \\frac{C_{\\varepsilon}}{2L} t\n$$\n$$\nk(t) = \\left( k_0^{-1/2} + \\frac{C_{\\varepsilon}}{2L} t \\right)^{-2}\n$$\nThe problem asks for the asymptotic decay exponent $n$ defined by the power-law $k(t) \\sim A t^{-n}$ as $t \\to \\infty$. In this limit, the term linear in $t$ dominates the constant initial condition term $k_0^{-1/2}$:\n$$\nk_0^{-1/2} + \\frac{C_{\\varepsilon}}{2L} t \\approx \\frac{C_{\\varepsilon}}{2L} t \\quad \\text{for } t \\to \\infty\n$$\nSubstituting this approximation back into the solution for $k(t)$:\n$$\nk(t) \\sim \\left( \\frac{C_{\\varepsilon}}{2L} t \\right)^{-2} = \\left( \\frac{C_{\\varepsilon}}{2L} \\right)^{-2} t^{-2}\n$$\nComparing this with the form $k(t) \\sim A t^{-n}$, we identify the constant $A = (\\frac{C_{\\varepsilon}}{2L})^{-2} = \\frac{4L^2}{C_{\\varepsilon}^2}$ and, most importantly, the decay exponent:\n$$\nn = 2\n$$\nAs a brief commentary, this predicted decay exponent of $n=2$ is significantly higher than the values typically observed in experiments for grid-generated turbulence, which is a common laboratory proxy for decaying HIT. Experimental studies generally report decay exponents in the range of $n \\approx 1.1 - 1.4$. The discrepancy arises primarily from the problem's simplifying assumption that the integral length scale $L$ is constant. In reality, as turbulence decays, the large, energy-containing eddies tend to grow in size, meaning $L$ increases with time. More advanced theories that account for the growth of $L$ (e.g., assuming $L \\propto t^{1/2}$) predict exponents closer to $n=1$, which are in better agreement with experimental findings.", "answer": "$$\\boxed{2}$$", "id": "3379218"}, {"introduction": "While simple closures are instructive, a critical skill for any computational fluid dynamics practitioner is to understand their limitations. This exercise directly confronts the deficiencies of the workhorse Boussinesq hypothesis, demonstrating its inability to capture the correct physics of normal stresses in a planar stagnation flow [@problem_id:3379158]. You will not only diagnose this failure but also take the next step: constructing a minimal nonlinear model that can correct for it, bridging the gap between introductory theory and the demands of accurately simulating complex flows.", "problem": "Consider an incompressible planar stagnation flow with mean velocity field defined by $U_{x}(x,y,z) = a\\,x$, $U_{y}(x,y,z) = -a\\,y$, and $U_{z}(x,y,z) = 0$, where $a0$ is a constant strain rate. The symmetric mean rate-of-strain tensor is $S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_{i}}{\\partial x_{j}} + \\frac{\\partial U_{j}}{\\partial x_{i}}\\right)$. This flow is irrotational and has a diagonal $S_{ij}$ with zero trace. In Reynolds-averaged turbulence modeling, the deviatoric kinematic Reynolds stress tensor is defined as $R_{ij} = -\\overline{u_{i}'u_{j}'} + \\frac{2}{3}k\\,\\delta_{ij}$, where $k = \\frac{1}{2}\\overline{u_{m}'u_{m}'}$ is the turbulent kinetic energy and $\\delta_{ij}$ is the Kronecker delta. The classical linear eddy-viscosity (Boussinesq) hypothesis postulates $R_{ij} = 2\\,\\nu_{t}\\,S_{ij}$, with $\\nu_{t}$ the turbulent eddy viscosity.\n\nYour tasks are:\n\n1) Starting from the above definitions and the given mean velocity field, derive $S_{ij}$ explicitly and show that the linear eddy-viscosity hypothesis implies $R_{zz} = 0$ in this flow. Explain why this prediction cannot represent nonzero normal stress differences along the $z$ direction that are observed in Direct Numerical Simulation (DNS) of planar stagnation turbulence.\n\n2) Propose a minimal nonlinear extension for $R_{ij}$ that:\n- is symmetric in $i$ and $j$,\n- is frame-invariant and built solely from the mean strain tensor $S_{ij}$,\n- is traceless (i.e., contributes only to the deviatoric part),\n- is consistent with dimensional analysis using only $k$ and $\\nu_{t}$ as turbulence scales,\nand write down its general form with a single dimensionless coefficient $\\gamma$ to be determined.\n\n3) Using the following DNS data at a point in the flow:\n- strain rate magnitude $a = 100\\,\\mathrm{s}^{-1}$,\n- turbulent kinetic energy $k = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$,\n- eddy viscosity $\\nu_{t} = 5.0\\times 10^{-4}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$,\n- deviatoric normal Reynolds stresses $R_{xx}^{\\mathrm{DNS}} = 0.12\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, $R_{yy}^{\\mathrm{DNS}} = -0.08\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, $R_{zz}^{\\mathrm{DNS}} = -0.04\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$,\n\ncalibrate the coefficient $\\gamma$ in your proposed nonlinear extension by matching the $z$-component of the deviatoric normal stress. Then verify that the same $\\gamma$ recovers the given $R_{xx}^{\\mathrm{DNS}}$ and $R_{yy}^{\\mathrm{DNS}}$.\n\nReport the calibrated $\\gamma$ as your final answer. Round your answer to four significant figures. No units are required for $\\gamma$.", "solution": "**1) Analysis of the Linear Eddy-Viscosity Model**\n\nFirst, we compute the components of the mean rate-of-strain tensor $S_{ij}$ for the given velocity field $U_1 = ax_1$, $U_2 = -ax_2$, $U_3 = 0$. Note that we use index notation with $(x, y, z)$ corresponding to $(x_1, x_2, x_3)$.\nThe diagonal components are:\n$$S_{11} = \\frac{\\partial U_1}{\\partial x_1} = a$$\n$$S_{22} = \\frac{\\partial U_2}{\\partial x_2} = -a$$\n$$S_{33} = \\frac{\\partial U_3}{\\partial x_3} = 0$$\nThe off-diagonal components are all zero. For instance:\n$$S_{12} = \\frac{1}{2}\\left(\\frac{\\partial U_1}{\\partial x_2} + \\frac{\\partial U_2}{\\partial x_1}\\right) = \\frac{1}{2}(0 + 0) = 0$$\nBy symmetry, $S_{21} = 0$. Similarly, all other off-diagonal components involving the $x_3$ direction are zero.\nThus, the mean rate-of-strain tensor is:\n$$S_{ij} = \\begin{pmatrix} a  0  0 \\\\ 0  -a  0 \\\\ 0  0  0 \\end{pmatrix}$$\nThe trace of this tensor is $S_{ii} = a - a + 0 = 0$, which is consistent with the flow being incompressible ($\\nabla \\cdot \\mathbf{U} = S_{ii} = 0$).\n\nNow, we apply the linear eddy-viscosity (Boussinesq) hypothesis, $R_{ij} = 2\\,\\nu_{t}\\,S_{ij}$. Substituting the matrix for $S_{ij}$:\n$$R_{ij} = 2\\,\\nu_{t} \\begin{pmatrix} a  0  0 \\\\ 0  -a  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 2\\nu_{t}a  0  0 \\\\ 0  -2\\nu_{t}a  0 \\\\ 0  0  0 \\end{pmatrix}$$\nFrom this result, the component $R_{33}$ (or $R_{zz}$) is explicitly zero:\n$$R_{zz} = 0$$\nThe DNS data provided states that $R_{zz}^{\\mathrm{DNS}} = -0.04\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, which is non-zero. The discrepancy arises from a fundamental deficiency of the linear model. The Boussinesq hypothesis postulates a direct, linear relationship between the deviatoric Reynolds stress $R_{ij}$ and the mean strain rate $S_{ij}$. In this flow, the mean strain in the $z$-direction is zero ($S_{zz}=0$), forcing the model to predict a zero deviatoric normal stress in that direction ($R_{zz}=0$). However, real turbulent flows are inherently three-dimensional. Even in a planar mean flow, turbulent fluctuations are not confined to the plane, and there is a redistribution of turbulent kinetic energy among all three components via pressure-strain interactions. This leads to non-zero values for all normal Reynolds stresses, a phenomenon known as the return to isotropy. The linear model fails to capture this crucial physical mechanism, predicting a two-dimensional state of turbulence for a two-dimensional mean flow, contrary to experimental and DNS observations.\n\n**2) Proposal for a Nonlinear Extension**\n\nWe seek a minimal nonlinear extension for $R_{ij}$ that is symmetric, frame-invariant, traceless, and built from $S_{ij}$, consistent with dimensional analysis using $k$ and $\\nu_{t}$.\nThe most general expansion for $R_{ij}$ as a function of $S_{ij}$ for an irrotational flow must be a linear combination of tensor products of $S_{ij}$. The linear term is $2\\nu_t S_{ij}$. The next simplest, or minimal, nonlinear term is quadratic in $S_{ij}$. The only symmetric, frame-invariant, second-order tensor that can be constructed from $S_{ij}$ is $S_{ik}S_{kj}$.\nOur proposed model takes the form: $R_{ij} = 2\\nu_t S_{ij} + (\\text{nonlinear term})$.\nThe nonlinear term must be traceless. The trace of $S_{ik}S_{kj}$ is $S_{ik}S_{ki} = S_{ij}S_{ij}$ (using symmetry of $S_{ij}$), which is not generally zero. To make the term traceless, we must subtract its trace multiplied by $\\frac{1}{3}\\delta_{ij}$. The tensorial part of the nonlinear extension is therefore $\\left(S_{ik}S_{kj} - \\frac{1}{3} S_{mn}S_{nm} \\delta_{ij}\\right)$.\nFor dimensional consistency, the pre-factor of this new term must have units that, when multiplied by the units of $S_{ik}S_{kj}$ ($T^{-2}$), yield the units of $R_{ij}$ ($L^2 T^{-2}$). The pre-factor must therefore have units of $L^2$. From the given turbulence scales $k$ (units $L^2 T^{-2}$) and $\\nu_t$ (units $L^2 T^{-1}$), we can construct a quantity with units $L^2$: $\\frac{\\nu_t^2}{k}$. The units are $(L^2 T^{-1})^2 / (L^2 T^{-2}) = (L^4 T^{-2}) / (L^2 T^{-2}) = L^2$.\nCombining these elements, and introducing a single dimensionless coefficient $\\gamma$, the minimal nonlinear extension is:\n$$R_{ij} = 2\\nu_t S_{ij} + \\gamma \\frac{\\nu_t^2}{k} \\left( S_{ik}S_{kj} - \\frac{1}{3} S_{mn}S_{nm} \\delta_{ij} \\right)$$\nThis form satisfies all the stated requirements.\n\n**3) Calibration of the Coefficient $\\gamma$**\n\nWe use the specific flow and the DNS data to calibrate $\\gamma$. First, we compute the tensor terms for this flow. We already have $S_{ij}$.\nThe quadratic term $S_{ik}S_{kj}$ is the matrix product $S^2$:\n$$S_{ik}S_{kj} = \\begin{pmatrix} a  0  0 \\\\ 0  -a  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} a  0  0 \\\\ 0  -a  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} a^2  0  0 \\\\ 0  a^2  0 \\\\ 0  0  0 \\end{pmatrix}$$\nIts trace is $S_{mn}S_{nm} = \\mathrm{Tr}(S^2) = a^2 + a^2 + 0 = 2a^2$.\nNow, we substitute these into the nonlinear model equation for the components of $R_{ij}$.\nFor $R_{zz}$ (i.e., $i=j=3$):\n$$R_{zz} = 2\\nu_t S_{33} + \\gamma \\frac{\\nu_t^2}{k} \\left( (S^2)_{33} - \\frac{1}{3} (2a^2) \\delta_{33} \\right)$$\n$$R_{zz} = 2\\nu_t(0) + \\gamma \\frac{\\nu_t^2}{k} \\left( 0 - \\frac{2a^2}{3}(1) \\right) = -\\frac{2}{3} \\gamma \\frac{\\nu_t^2 a^2}{k}$$\nWe calibrate $\\gamma$ by setting this equal to the DNS value $R_{zz}^{\\mathrm{DNS}} = -0.04\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$:\n$$-0.04 = -\\frac{2}{3} \\gamma \\frac{\\nu_t^2 a^2}{k}$$\nSolving for $\\gamma$:\n$$\\gamma = \\frac{0.04 \\times \\frac{3}{2} \\times k}{\\nu_t^2 a^2} = \\frac{0.06 k}{\\nu_t^2 a^2}$$\nSubstituting the given values $a = 100\\,\\mathrm{s}^{-1}$, $k = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, and $\\nu_{t} = 5.0\\times 10^{-4}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$:\n$$\\gamma = \\frac{0.06 \\times 0.30}{(5.0 \\times 10^{-4})^2 \\times (100)^2} = \\frac{0.018}{(25 \\times 10^{-8}) \\times 10^4} = \\frac{0.018}{25 \\times 10^{-4}} = \\frac{180}{25} = 7.2$$\nNow, we verify this value of $\\gamma$ by checking the predictions for $R_{xx}$ and $R_{yy}$.\nFor $R_{xx}$ (i.e., $i=j=1$):\n$$R_{xx} = 2\\nu_t S_{11} + \\gamma \\frac{\\nu_t^2}{k} \\left( (S^2)_{11} - \\frac{1}{3} (2a^2) \\delta_{11} \\right)$$\n$$R_{xx} = 2\\nu_t a + \\gamma \\frac{\\nu_t^2}{k} \\left( a^2 - \\frac{2a^2}{3} \\right) = 2\\nu_t a + \\frac{1}{3} \\gamma \\frac{\\nu_t^2 a^2}{k}$$\nThe first term is the linear contribution: $2\\nu_t a = 2 \\times (5.0 \\times 10^{-4}) \\times 100 = 0.1\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$.\nThe second term is the nonlinear correction. We can relate this to $R_{zz}$: the nonlinear part of $R_{xx}$ is $-\\frac{1}{2}$ times the nonlinear part of $R_{zz}$.\nNonlinear correction for $R_{xx}$ = $-\\frac{1}{2} R_{zz}^{\\mathrm{DNS}} = -\\frac{1}{2}(-0.04) = 0.02\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$.\nSo, $R_{xx} = 0.1 + 0.02 = 0.12\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$. This perfectly matches $R_{xx}^{\\mathrm{DNS}}$.\n\nFor $R_{yy}$ (i.e., $i=j=2$):\n$$R_{yy} = 2\\nu_t S_{22} + \\gamma \\frac{\\nu_t^2}{k} \\left( (S^2)_{22} - \\frac{1}{3} (2a^2) \\delta_{22} \\right)$$\n$$R_{yy} = 2\\nu_t (-a) + \\gamma \\frac{\\nu_t^2}{k} \\left( a^2 - \\frac{2a^2}{3} \\right) = -2\\nu_t a + \\frac{1}{3} \\gamma \\frac{\\nu_t^2 a^2}{k}$$\nThe linear contribution is $-0.1\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$. The nonlinear correction is the same as for $R_{xx}$, which is $0.02\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$.\nSo, $R_{yy} = -0.1 + 0.02 = -0.08\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$. This also perfectly matches $R_{yy}^{\\mathrm{DNS}}$.\nThe calibrated value $\\gamma=7.2$ is thus validated. The problem requires the answer to four significant figures.", "answer": "$$\\boxed{7.200}$$", "id": "3379158"}, {"introduction": "Modern turbulence modeling is an interdisciplinary field, blending physics with data science and computational methods. This advanced practice places you in the role of a turbulence modeler, using synthetic Direct Numerical Simulation (DNS) data to reverse-engineer a model for the highly complex pressure-strain term, $\\Pi_{ij}$, through linear regression [@problem_id:3379167]. Furthermore, this exercise introduces a crucial verification step by implementing a computational check for \"realizability,\" ensuring that the resulting Reynolds stress tensor adheres to the fundamental laws of physics.", "problem": "You are given a modeling task grounded in the incompressible Navier–Stokes equations and Reynolds-averaged turbulence, and you must implement it as a complete, runnable program. The aim is to reconstruct the pressure–strain redistribution term using Direct Numerical Simulation (DNS) of homogeneous shear, via a constrained regression on an integrity basis formed from the mean rate-of-strain and mean rotation tensors, and then to test realizability of the Reynolds stress tensor by verifying non-negativity along random directions.\n\nStart from the incompressible Navier–Stokes equations, apply Reynolds decomposition, and use the standard definitions:\n- The Reynolds Stress Tensor (RST) is defined as $R_{ij} = \\langle u_i^{\\prime} u_j^{\\prime} \\rangle$, where $u_i^{\\prime}$ are velocity fluctuations and $\\langle \\cdot \\rangle$ denotes averaging.\n- The mean velocity gradient is $G_{ij} = \\partial U_i / \\partial x_j$.\n- The mean rate-of-strain tensor is $S_{ij} = \\left(G_{ij} + G_{ji}\\right)/2$.\n- The mean rotation tensor is $\\Omega_{ij} = \\left(G_{ij} - G_{ji}\\right)/2$.\n- The pressure–strain redistribution term is $\\Pi_{ij}$, which in the Reynolds stress transport equation is symmetric and trace-free (that is, $\\Pi_{ij} = \\Pi_{ji}$ and $\\Pi_{ii} = 0$).\n\nFor homogeneous shear, the mean gradient $G_{ij}$ is constant in space. To respect Galilean invariance and tensorial integrity, consider a basis of symmetric, trace-free tensors built from $S_{ij}$ and $\\Omega_{ij}$ up to quadratic order. Use the following integrity basis:\n- $B_{ij}^{(1)} = S_{ij}$,\n- $B_{ij}^{(2)} = S_{ik}\\Omega_{kj} - \\Omega_{ik}S_{kj}$,\n- $B_{ij}^{(3)} = S_{ik}S_{kj} - \\dfrac{1}{3}\\,\\mathrm{tr}(S^2)\\,\\delta_{ij}$,\n- $B_{ij}^{(4)} = \\Omega_{ik}\\Omega_{kj} - \\dfrac{1}{3}\\,\\mathrm{tr}(\\Omega^2)\\,\\delta_{ij}$,\n\nwhere $\\delta_{ij}$ is the Kronecker delta, $\\mathrm{tr}(\\cdot)$ is the trace, and repeated indices imply summation. In incompressible flow, $\\mathrm{tr}(S) = 0$, so $B_{ij}^{(1)}$ is also trace-free. Each $B_{ij}^{(k)}$ is symmetric and trace-free when $S_{ij}$ is symmetric and $\\Omega_{ij}$ is antisymmetric.\n\nDefine the non-dimensionalized matrices with respect to the shear-rate magnitude $\\gamma$ for each snapshot:\n- $S_{ij}^{\\ast} = S_{ij}/\\gamma$,\n- $\\Omega_{ij}^{\\ast} = \\Omega_{ij}/\\gamma$,\nand correspondingly define $B_{ij}^{(k)\\ast}$ by replacing $S_{ij}$ and $\\Omega_{ij}$ with $S_{ij}^{\\ast}$ and $\\Omega_{ij}^{\\ast}$ in the above basis. Model the normalized pressure–strain term as\n$$\n\\widetilde{\\Pi}_{ij} = \\frac{\\Pi_{ij}}{k} = \\gamma \\sum_{k=1}^{4} c_k\\, B_{ij}^{(k)\\ast},\n$$\nwhere $k$ is the turbulent kinetic energy and $c_k$ are dimensionless regression coefficients to be identified by least squares. The regression is constrained to the symmetric, trace-free subspace by construction of the basis. Your program must reconstruct $c_k$ from synthetic DNS snapshots using linear least squares.\n\nYou are provided a test suite consisting of five homogeneous shear snapshots, each specified by a shear-rate magnitude $\\gamma$ (in $\\mathrm{s}^{-1}$) and a constant mean gradient matrix $G_{ij}$ (in $\\mathrm{s}^{-1}$) as follows. For rotations, use proper orthogonal transformation $Q$ and $G = Q\\,G_0\\,Q^{\\top}$.\n\n- Case $1$ (simple shear in the $x$–$y$ plane): $\\gamma = 1.0$, $G = \\begin{bmatrix} 0  1.0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$.\n- Case $2$ (simple shear in the $x$–$z$ plane): $\\gamma = 1.5$, $G = \\begin{bmatrix} 0  0  1.5 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$.\n- Case $3$ (simple shear in the $y$–$z$ plane): $\\gamma = 2.0$, $G = \\begin{bmatrix} 0  0  0 \\\\ 0  0  2.0 \\\\ 0  0  0 \\end{bmatrix}$.\n- Case $4$ (rotation of Case $1$ about the $z$-axis by angle $\\theta = 45^\\circ$): $\\gamma = 1.2$, $G_0 = \\begin{bmatrix} 0  1.2  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$, $Q = \\begin{bmatrix} \\cos\\theta  -\\sin\\theta  0 \\\\ \\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{bmatrix}$ (angle in radians internally).\n- Case $5$ (rotation of Case $2$ about the $x$-axis by angle $\\theta = 60^\\circ$): $\\gamma = 1.8$, $G_0 = \\begin{bmatrix} 0  0  1.8 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$, $Q = \\begin{bmatrix} 1  0  0 \\\\ 0  \\cos\\theta  -\\sin\\theta \\\\ 0  \\sin\\theta  \\cos\\theta \\end{bmatrix}$ (angle in radians internally).\n\nFor each case, assume synthetic DNS for $\\widetilde{\\Pi}_{ij}$ generated by the above model with unknown true coefficients and no noise. Your program must reconstruct the coefficients $c_k$ using linear least squares with the Frobenius norm objective, constrained implicitly by the chosen symmetric, trace-free basis.\n\nRealizability test: For each case, you are also provided a Reynolds stress matrix $R_{ij}$ (in $\\mathrm{m}^2/\\mathrm{s}^2$) to test realizability. A realizable $R_{ij}$ must be symmetric positive semidefinite, meaning $n_i R_{ij} n_j \\ge 0$ for any unit vector $n_i$. Implement a Monte Carlo realizability check: sample $N$ random unit vectors $n$ uniformly over the unit sphere in $\\mathbb{R}^3$ and verify $n^{\\top} R n \\ge 0$ for all samples, within a numerical tolerance. Use $N = 1000$, a fixed random seed, and treat any value below $-10^{-12}$ as violating realizability.\n\nUse the following $R_{ij}$ matrices:\n- Case $1$: $R = \\begin{bmatrix} 0.8  0.05  0.0 \\\\ 0.05  0.7  0.0 \\\\ 0.0  0.0  0.6 \\end{bmatrix}$.\n- Case $2$: $R = \\begin{bmatrix} 1.0  0.02  0.03 \\\\ 0.02  0.9  0.04 \\\\ 0.03  0.04  0.95 \\end{bmatrix}$.\n- Case $3$: $R = \\begin{bmatrix} 0.6  0.01  0.0 \\\\ 0.01  0.6  0.02 \\\\ 0.0  0.02  0.6 \\end{bmatrix}$.\n- Case $4$: $R = \\begin{bmatrix} 0.7  -0.1  0.05 \\\\ -0.1  0.8  -0.02 \\\\ 0.05  -0.02  0.75 \\end{bmatrix}$.\n- Case $5$: $R = \\begin{bmatrix} 0.5  0.12  -0.08 \\\\ 0.12  0.55  0.06 \\\\ -0.08  0.06  0.5 \\end{bmatrix}$.\n\nYour program must:\n- Compute $S_{ij}$ and $\\Omega_{ij}$ from each provided $G_{ij}$ and $\\gamma$.\n- Build $S_{ij}^{\\ast}$ and $\\Omega_{ij}^{\\ast}$, assemble the four basis tensors $B_{ij}^{(k)\\ast}$, and construct the stacked linear system to regress $c_k$ from synthetic DNS $\\widetilde{\\Pi}_{ij}$.\n- Perform least squares to estimate $c_k$.\n- Carry out the realizability check for each provided $R_{ij}$ using $N = 1000$ random unit vectors, a fixed seed, and tolerance $10^{-12}$.\n\nAngle unit specification: internal trigonometric computations must use radians.\n\nFinal output format: Your program should produce a single line of output containing a list with the four reconstructed coefficients followed by five realizability booleans for the five cases. The coefficients must be floats rounded to six decimal places, and the booleans must be the words True or False. The final output must be:\n$[\\text{c1},\\text{c2},\\text{c3},\\text{c4},\\text{b1},\\text{b2},\\text{b3},\\text{b4},\\text{b5}]$, for example, $[0.850000,-0.300000,0.150000,-0.100000,True,True,True,True,True]$.\n\nTest suite coverage requirements:\n- Include the general case of simple shear in different planes (Cases $1$–$3$).\n- Include rotated frames to ensure basis diversity (Cases $4$–$5$).\n- Use the realizability test to validate symmetry and positive semidefiniteness under random directional sampling.\n\nEnsure scientific realism and internal consistency in your implementation, and produce the output as specified. No external inputs are permitted; all data must be embedded in the program. All quantities that require units have been specified above; the reconstructed coefficients are dimensionless, the shear rates $\\gamma$ are in $\\mathrm{s}^{-1}$, and the Reynolds stress matrices $R_{ij}$ are in $\\mathrm{m}^2/\\mathrm{s}^2$.", "solution": "### Theoretical Formulation and Regression Setup\nThe central task is to solve for the coefficients $c_k$ in the linear model:\n$$ \\widetilde{\\Pi}_{ij} = \\gamma \\sum_{k=1}^{4} c_k\\, B_{ij}^{(k)\\ast} $$\nThis tensor equation holds for each of the $M=5$ snapshots provided. To solve for the four unknown coefficients $c_k$, we can transform this set of tensor equations into a single matrix-vector linear system $A\\mathbf{x} = \\mathbf{b}$, which is then solved using least squares.\n\nA $3 \\times 3$ symmetric trace-free tensor $T_{ij}$ has $5$ independent components. We can define a vectorization map, $\\mathrm{vec}(\\cdot)$, that maps such a tensor to a vector in $\\mathbb{R}^5$. A consistent choice for this map is:\n$$ \\mathrm{vec}(T) = [T_{11}, T_{22}, T_{12}, T_{13}, T_{23}]^T $$\nNote that $T_{33} = -(T_{11} + T_{22})$ due to the trace-free condition, and $T_{ji} = T_{ij}$ due to symmetry.\n\nApplying this vectorization to the model equation for each snapshot $m \\in \\{1, \\dots, 5\\}$ yields:\n$$ \\mathrm{vec}(\\widetilde{\\Pi}^{(m)}) = \\gamma^{(m)} \\sum_{k=1}^{4} c_k\\, \\mathrm{vec}(B^{(k)\\ast,(m)}) $$\nThis is a system of 5 linear equations for the 4 unknowns $c_k$. We can aggregate the equations from all $M=5$ snapshots. Let $\\mathbf{x} = [c_1, c_2, c_3, c_4]^T$ be the vector of unknown coefficients. Let the matrix $A$ be a $(5M \\times 4)$ matrix, where the $k$-th column is formed by vertically stacking the vectors $\\gamma^{(m)} \\mathrm{vec}(B^{(k)\\ast,(m)})$ for each snapshot $m$:\n$$\nA_{\\cdot, k} = \\begin{bmatrix}\n\\gamma^{(1)} \\mathrm{vec}(B^{(k)\\ast,(1)}) \\\\\n\\gamma^{(2)} \\mathrm{vec}(B^{(k)\\ast,(2)}) \\\\\n\\vdots \\\\\n\\gamma^{(5)} \\mathrm{vec}(B^{(k)\\ast,(5)})\n\\end{bmatrix}\n$$\nSimilarly, the vector $\\mathbf{b}$ is a $(5M \\times 1)$ vector formed by stacking the vectorized \"measured\" pressure-strain terms:\n$$\n\\mathbf{b} = \\begin{bmatrix}\n\\mathrm{vec}(\\widetilde{\\Pi}^{(1)}) \\\\\n\\mathrm{vec}(\\widetilde{\\Pi}^{(2)}) \\\\\n\\vdots \\\\\n\\mathrm{vec}(\\widetilde{\\Pi}^{(5)})\n\\end{bmatrix}\n$$\nThe problem is now in the standard form $A\\mathbf{x} \\approx \\mathbf{b}$. The least squares solution for $\\mathbf{x}$ minimizes the Frobenius norm of the residual, $\\|A\\mathbf{x} - \\mathbf{b}\\|_2$, and is given by $\\mathbf{x} = (A^T A)^{-1} A^T \\mathbf{b}$. This will be calculated numerically.\n\nThe synthetic data for $\\mathbf{b}$ will be generated using a set of true coefficients, $c_{\\text{true}} = [0.85, -0.30, 0.15, -0.10]$, as implied by the problem's example output. For each case $m$, we calculate $\\widetilde{\\Pi}_{ij}^{(m)} = \\gamma^{(m)} \\sum_{k=1}^4 c_{k, \\text{true}} B_{ij}^{(k)\\ast, (m)}$ and then construct $\\mathbf{b}$.\n\n### Realizability Test\nThe Reynolds stress tensor $R_{ij}$ must be symmetric positive semidefinite to be physically realizable. The positive semidefinite condition requires that $n_i R_{ij} n_j \\ge 0$ for any non-zero vector $n_i$. It is sufficient to check this for all unit vectors $n_i$.\n\nA direct analytical check involves computing the eigenvalues of $R_{ij}$ and ensuring they are all non-negative. However, the problem specifies a Monte Carlo approach. This involves:\n1.  Generating a large number, $N = 1000$, of random unit vectors $n$ that are uniformly distributed over the surface of a unit sphere in $\\mathbb{R}^3$. A standard method is to generate three-dimensional vectors from a standard normal distribution and then normalize each vector to unit length.\n2.  For each random unit vector $n$, compute the quadratic form $q = n^T R n$.\n3.  The realizability condition is considered violated if any computed value of $q$ is less than a specified numerical tolerance of $-10^{-12}$.\n\n### Computational Algorithm\nThe overall algorithm implemented in the program will be:\n\n1.  **Initialization**: Define the five test cases with their respective $\\gamma$, $G_{ij}$ (or its components for rotation), and $R_{ij}$. Define the \"true\" coefficients $c_{\\text{true}}$. Initialize an empty $25 \\times 4$ matrix $A$ and an empty $25 \\times 1$ vector $\\mathbf{b}$.\n2.  **Loop over Test Cases for Regression**: For each case $m=1, \\dots, 5$:\n    a.  Compute the full mean velocity gradient tensor $G^{(m)}$. For rotational cases, this involves $G = Q G_0 Q^T$.\n    b.  Calculate the mean rate-of-strain $S^{(m)}$ and mean rotation $\\Omega^{(m)}$ tensors from $G^{(m)}$.\n    c.  Normalize these tensors by $\\gamma^{(m)}$ to get $S^{\\ast,(m)}$ and $\\Omega^{\\ast,(m)}$.\n    d.  Compute the four basis tensors $B^{(k)\\ast,(m)}$ using the definitions.\n    e.  Generate the synthetic pressure-strain tensor $\\widetilde{\\Pi}^{(m)} = \\gamma^{(m)} \\sum_{k=1}^4 c_{k, \\text{true}} B^{(k)\\ast,(m)}$.\n    f.  Vectorize $\\widetilde{\\Pi}^{(m)}$ and place the resulting $5$ components into the appropriate rows of $\\mathbf{b}$.\n    g.  For each basis tensor $k=1, \\dots, 4$, vectorize $\\gamma^{(m)} B^{(k)\\ast,(m)}$ and place the resulting $5$ components into the appropriate rows of the $k$-th column of $A$.\n3.  **Solve for Coefficients**: Use a numerical least squares solver (e.g., `numpy.linalg.lstsq`) to find the coefficient vector $\\mathbf{x} = [c_1, c_2, c_3, c_4]^T$ that solves $A\\mathbf{x} = \\mathbf{b}$.\n4.  **Loop over Test Cases for Realizability**: For each case $m=1, \\dots, 5$:\n    a.  Retrieve the given Reynolds stress tensor $R^{(m)}$.\n    b.  Perform the Monte Carlo realizability check with $N=1000$ random unit vectors.\n    c.  Store the boolean result (True for realizable, False for not).\n5.  **Final Output**: Format the four recovered coefficients to six decimal places and combine them with the five boolean results into a single list. Print the list in the specified format.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a turbulence modeling problem: reconstructs pressure-strain model\n    coefficients via least squares and tests Reynolds stress realizability.\n    \"\"\"\n    \n    # Define the \"true\" coefficients to generate synthetic measurement data.\n    # These are inferred from the problem's example output format.\n    c_true = np.array([0.85, -0.30, 0.15, -0.10])\n    \n    # Test cases as defined in the problem statement\n    test_cases = [\n        {\n            \"id\": 1,\n            \"gamma\": 1.0,\n            \"G\": np.array([[0.0, 1.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n            \"R\": np.array([[0.8, 0.05, 0.0], [0.05, 0.7, 0.0], [0.0, 0.0, 0.6]]),\n        },\n        {\n            \"id\": 2,\n            \"gamma\": 1.5,\n            \"G\": np.array([[0.0, 0.0, 1.5], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n            \"R\": np.array([[1.0, 0.02, 0.03], [0.02, 0.9, 0.04], [0.03, 0.04, 0.95]]),\n        },\n        {\n            \"id\": 3,\n            \"gamma\": 2.0,\n            \"G\": np.array([[0.0, 0.0, 0.0], [0.0, 0.0, 2.0], [0.0, 0.0, 0.0]]),\n            \"R\": np.array([[0.6, 0.01, 0.0], [0.01, 0.6, 0.02], [0.0, 0.02, 0.6]]),\n        },\n        {\n            \"id\": 4,\n            \"gamma\": 1.2,\n            \"G0\": np.array([[0.0, 1.2, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n            \"theta_rad\": np.deg2rad(45),\n            \"Q\": lambda th: np.array([[np.cos(th), -np.sin(th), 0], [np.sin(th), np.cos(th), 0], [0, 0, 1]]),\n            \"R\": np.array([[0.7, -0.1, 0.05], [-0.1, 0.8, -0.02], [0.05, -0.02, 0.75]]),\n        },\n        {\n            \"id\": 5,\n            \"gamma\": 1.8,\n            \"G0\": np.array([[0.0, 0.0, 1.8], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n            \"theta_rad\": np.deg2rad(60),\n            \"Q\": lambda th: np.array([[1, 0, 0], [0, np.cos(th), -np.sin(th)], [0, np.sin(th), np.cos(th)]]),\n            \"R\": np.array([[0.5, 0.12, -0.08], [0.12, 0.55, 0.06], [-0.08, 0.06, 0.5]]),\n        },\n    ]\n\n    # Initialize the global regression system matrices\n    A = np.zeros((5 * 5, 4))\n    b = np.zeros(5 * 5)\n    \n    # Vectorization map for symmetric trace-free 3x3 tensors\n    # T - [T11, T22, T12, T13, T23]\n    def vectorize_tensor(T):\n        return np.array([T[0, 0], T[1, 1], T[0, 1], T[0, 2], T[1, 2]])\n\n    for i, case in enumerate(test_cases):\n        gamma = case[\"gamma\"]\n        if \"G\" in case:\n            G = case[\"G\"]\n        else:\n            Q = case[\"Q\"](case[\"theta_rad\"])\n            G0 = case[\"G0\"]\n            G = Q @ G0 @ Q.T\n            \n        # Calculate mean rate-of-strain and rotation tensors\n        S = 0.5 * (G + G.T)\n        Omega = 0.5 * (G - G.T)\n\n        # Non-dimensionalize\n        S_star = S / gamma\n        Omega_star = Omega / gamma\n\n        # Calculate basis tensors\n        I = np.identity(3)\n        B_star = [None] * 4\n        \n        # B_ij^(1) = S_ij\n        B_star[0] = S_star\n        \n        # B_ij^(2) = S_ik * Omega_kj - Omega_ik * S_kj\n        B_star[1] = S_star @ Omega_star - Omega_star @ S_star\n        \n        # B_ij^(3) = S_ik * S_kj - 1/3 * tr(S^2) * delta_ij\n        S_star_sq = S_star @ S_star\n        tr_S_star_sq = np.trace(S_star_sq)\n        B_star[2] = S_star_sq - (1/3) * tr_S_star_sq * I\n        \n        # B_ij^(4) = Omega_ik * Omega_kj - 1/3 * tr(Omega^2) * delta_ij\n        Omega_star_sq = Omega_star @ Omega_star\n        tr_Omega_star_sq = np.trace(Omega_star_sq)\n        B_star[3] = Omega_star_sq - (1/3) * tr_Omega_star_sq * I\n        \n        # Generate synthetic DNS data for Pi_tilde\n        Pi_tilde_synthetic = np.zeros((3, 3))\n        for k in range(4):\n            Pi_tilde_synthetic += c_true[k] * B_star[k]\n        Pi_tilde_synthetic *= gamma\n\n        # Assemble the rows for the global A and b matrices for this case\n        row_start = i * 5\n        row_end = row_start + 5\n        b[row_start:row_end] = vectorize_tensor(Pi_tilde_synthetic)\n        \n        for k in range(4):\n            A[row_start:row_end, k] = vectorize_tensor(gamma * B_star[k])\n\n    # Solve the linear least squares problem A*c = b for c\n    c_estimated, _, _, _ = np.linalg.lstsq(A, b, rcond=None)\n\n    # Perform realizability check for each case\n    def check_realizability(R, N=1000, seed=0, tol=-1e-12):\n        # R must be symmetric positive semi-definite.\n        # Check symmetry first\n        if not np.allclose(R, R.T):\n            return False\n            \n        # Set seed for reproducibility\n        rng = np.random.default_rng(seed)\n        \n        # Generate N random 3D vectors from a standard normal distribution\n        vecs = rng.standard_normal(size=(N, 3))\n        \n        # Normalize them to get uniform distribution on the unit sphere\n        norms = np.linalg.norm(vecs, axis=1, keepdims=True)\n        unit_vecs = vecs / norms\n        \n        # Calculate n^T * R * n for all vectors n\n        # This is equivalent to sum( (n @ R) * n, axis=1 )\n        quadratic_form_values = np.einsum('ni,ij,nj-n', unit_vecs, R, unit_vecs)\n        \n        # Check if any value is below the tolerance\n        if np.any(quadratic_form_values  tol):\n            return False\n        \n        return True\n\n    realizability_results = []\n    for case in test_cases:\n        realizability_results.append(check_realizability(case[\"R\"]))\n\n    # Prepare final output string\n    formatted_coeffs = [f\"{c:.6f}\" for c in c_estimated]\n    formatted_bools = [str(b) for b in realizability_results]\n    \n    final_list = formatted_coeffs + formatted_bools\n    \n    print(f\"[{','.join(final_list)}]\")\n\n\nsolve()\n```", "id": "3379167"}]}