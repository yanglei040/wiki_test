{"hands_on_practices": [{"introduction": "The Spalart–Allmaras model is built around a single transport equation for a working variable, $\\tilde{\\nu}$. For the model to be useful within the Reynolds-Averaged Navier-Stokes (RANS) framework, this variable must be related to the turbulent viscosity, $\\nu_t$. This exercise [@problem_id:3380828] explores the algebraic relationship $\\nu_t = \\tilde{\\nu} f_{v1}(\\chi)$, focusing on the critical role of the viscous damping function $f_{v1}$ in correctly capturing the physics of the near-wall region. By working through this problem, you will gain a concrete understanding of how the model's working variable is translated into a physical quantity and appreciate the design choices that ensure plausible behavior in both the viscous sublayer and the outer turbulent flow.", "problem": "In the one-equation Spalart–Allmaras turbulence model (SA), the turbulent kinematic viscosity is modeled as an algebraic function of a transported working variable and the molecular viscosity to be consistent with the Reynolds-Averaged Navier–Stokes equations and the Boussinesq eddy-viscosity hypothesis. Consider an incompressible flow of air at a location where the molecular kinematic viscosity is $\\nu = 1.50 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$ and the Spalart–Allmaras working variable has the value $\\tilde{\\nu} = 5.00 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$. Take the canonical SA model constant $c_{v1} = 7.1$. The model defines a nondimensional ratio $\\chi \\equiv \\tilde{\\nu} / \\nu$ and uses a viscous damping function to ensure correct near-wall and outer-layer limits.\n\nUsing only well-established relations of the Spalart–Allmaras model and fundamental principles of the Reynolds-Averaged Navier–Stokes closure, compute the turbulent kinematic viscosity $\\nu_t$ implied by these data. Then, analyze the limits of the dimensionless ratio $\\nu_t / \\tilde{\\nu}$ as $\\chi \\to 0$ and as $\\chi \\to \\infty$ and state the limiting values. Interpret these limits in terms of physical plausibility.\n\nReport your final results as follows:\n- Provide $\\nu_t$ in $\\mathrm{m}^2/\\mathrm{s}$, rounded to four significant figures.\n- Provide the two limiting values $\\lim_{\\chi \\to 0} \\left(\\nu_t / \\tilde{\\nu}\\right)$ and $\\lim_{\\chi \\to \\infty} \\left(\\nu_t / \\tilde{\\nu}\\right)$ as pure numbers (dimensionless).\nYour final answer must be presented as three entries in a single row, in the order described above.", "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-contained, providing all necessary data for a solution based on the established principles of the Spalart–Allmaras turbulence model.\n\nThe Spalart–Allmaras (SA) model provides an algebraic relation for the turbulent kinematic viscosity, $\\nu_t$, as a function of a transported working variable, $\\tilde{\\nu}$. This relation is central to the Boussinesq eddy-viscosity hypothesis used in Reynolds-Averaged Navier–Stokes (RANS) equations. The formula is given by:\n$$\n\\nu_t = \\tilde{\\nu} f_{v1}(\\chi)\n$$\nwhere $f_{v1}$ is a viscous damping function designed to correctly model the behavior of turbulence near solid walls. The function $f_{v1}$ depends on the dimensionless ratio $\\chi$, which is defined as:\n$$\n\\chi \\equiv \\frac{\\tilde{\\nu}}{\\nu}\n$$\nHere, $\\nu$ is the molecular kinematic viscosity of the fluid. The canonical form of the damping function $f_{v1}$ in the SA model is:\n$$\nf_{v1}(\\chi) = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}\n$$\nwhere $c_{v1}$ is a model constant.\n\nThe problem provides the following data:\n- Molecular kinematic viscosity: $\\nu = 1.50 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$\n- Spalart–Allmaras working variable: $\\tilde{\\nu} = 5.00 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$\n- SA model constant: $c_{v1} = 7.1$\n\nFirst, we compute the value of the non-dimensional ratio $\\chi$:\n$$\n\\chi = \\frac{\\tilde{\\nu}}{\\nu} = \\frac{5.00 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}}{1.50 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}} = \\frac{5.00}{1.50} = \\frac{10}{3}\n$$\nNext, we calculate the value of the viscous damping function $f_{v1}(\\chi)$ using the given constant $c_{v1} = 7.1$:\n$$\nf_{v1}\\left(\\frac{10}{3}\\right) = \\frac{\\left(\\frac{10}{3}\\right)^3}{\\left(\\frac{10}{3}\\right)^3 + (7.1)^3} = \\frac{\\frac{1000}{27}}{\\frac{1000}{27} + 357.911} \\approx \\frac{37.037037}{37.037037 + 357.911} = \\frac{37.037037}{394.948037} \\approx 0.0937769\n$$\nNow, we can compute the turbulent kinematic viscosity $\\nu_t$:\n$$\n\\nu_t = \\tilde{\\nu} f_{v1}(\\chi) = (5.00 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}) \\times 0.0937769 \\approx 4.688845 \\times 10^{-6}\\,\\mathrm{m}^2/\\mathrm{s}\n$$\nThe problem requires this result rounded to four significant figures:\n$$\n\\nu_t \\approx 4.689 \\times 10^{-6}\\,\\mathrm{m}^2/\\mathrm{s}\n$$\n\nThe second part of the problem requires the analysis of the limits of the dimensionless ratio $\\nu_t / \\tilde{\\nu}$ as $\\chi \\to 0$ and as $\\chi \\to \\infty$. From the model's definition, this ratio is simply the damping function itself:\n$$\n\\frac{\\nu_t}{\\tilde{\\nu}} = f_{v1}(\\chi) = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}\n$$\n\nWe evaluate the limit as $\\chi \\to 0$:\n$$\n\\lim_{\\chi \\to 0} \\frac{\\nu_t}{\\tilde{\\nu}} = \\lim_{\\chi \\to 0} f_{v1}(\\chi) = \\lim_{\\chi \\to 0} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3} = \\frac{0^3}{0^3 + c_{v1}^3} = \\frac{0}{c_{v1}^3} = 0\n$$\nThis limit is physically plausible. The condition $\\chi = \\tilde{\\nu}/\\nu \\to 0$ corresponds to regions where molecular viscosity dominates, such as the viscous sublayer immediately adjacent to a solid surface. In this region, turbulent fluctuations are damped out, and the turbulent viscosity $\\nu_t$ must approach zero. The damping function $f_{v1}$ ensures this proper near-wall behavior.\n\nNext, we evaluate the limit as $\\chi \\to \\infty$:\n$$\n\\lim_{\\chi \\to \\infty} \\frac{\\nu_t}{\\tilde{\\nu}} = \\lim_{\\chi \\to \\infty} f_{v1}(\\chi) = \\lim_{\\chi \\to \\infty} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}\n$$\nTo evaluate this limit, we divide the numerator and the denominator by $\\chi^3$:\n$$\n\\lim_{\\chi \\to \\infty} \\frac{1}{1 + \\frac{c_{v1}^3}{\\chi^3}} = \\frac{1}{1 + 0} = 1\n$$\nThis limit is also physically plausible. The condition $\\chi = \\tilde{\\nu}/\\nu \\to \\infty$ corresponds to regions far from walls where turbulent effects are much stronger than molecular viscous effects (i.e., high Reynolds number turbulence). In these regions, the damping effect of molecular viscosity is negligible, and the model is designed such that the working variable $\\tilde{\\nu}$ becomes equivalent to the turbulent viscosity $\\nu_t$. Therefore, the ratio $\\nu_t / \\tilde{\\nu}$ correctly approaches $1$.\n\nThe three requested results are:\n1.  Turbulent kinematic viscosity $\\nu_t \\approx 4.689 \\times 10^{-6}\\,\\mathrm{m}^2/\\mathrm{s}$.\n2.  The limit $\\lim_{\\chi \\to 0} (\\nu_t / \\tilde{\\nu}) = 0$.\n3.  The limit $\\lim_{\\chi \\to \\infty} (\\nu_t / \\tilde{\\nu}) = 1$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 4.689 \\times 10^{-6} & 0 & 1 \\end{pmatrix}}\n$$", "id": "3380828"}, {"introduction": "A key decision when using the Spalart–Allmaras model is whether to resolve the boundary layer to the wall or use wall functions. For wall-resolved simulations, creating a mesh with adequate resolution in the near-wall region is paramount for accuracy. This practice [@problem_id:3380871] bridges the abstract concept of \"wall units\" like $y^+$ with the tangible task of setting physical grid dimensions, demonstrating how to use boundary layer theory to estimate the required mesh spacing before running a simulation. Completing this exercise will equip you with a critical skill: performing an a priori analysis to design a suitable mesh for a wall-resolved RANS simulation.", "problem": "A smooth, zero-pressure-gradient turbulent boundary layer develops on a flat plate in air. You will use the Spalart–Allmaras (SA) turbulence model without wall functions, so the viscous sublayer must be resolved. Consider a representative streamwise location at $x = 0.5\\,\\mathrm{m}$ from the leading edge, free-stream speed $U_{\\infty} = 30\\,\\mathrm{m/s}$, density $\\rho = 1.225\\,\\mathrm{kg/m^3}$, and kinematic viscosity $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$. Assume incompressible flow and a hydraulically smooth wall.\n\nStarting from fundamental definitions of wall units and the requirement that the viscous sublayer (where the mean velocity follows $u^{+} = y^{+}$) be resolved, proceed as follows:\n\n- Establish the wall-unit relations for the first off-wall point, streamwise spacing, and spanwise spacing: $y_{1}^{+}$, $\\Delta x^{+}$, and $\\Delta z^{+}$ in terms of the viscous length scale and friction velocity.\n- Relate the friction velocity to the local wall shear stress and the local turbulent skin-friction coefficient.\n- To close the derivation for a smooth flat plate at zero pressure gradient, adopt the classical one-seventh power-law correlation for the local turbulent skin-friction coefficient, $C_{f,x} = 0.026\\,\\mathrm{Re}_{x}^{-1/7}$, where $\\mathrm{Re}_{x} = U_{\\infty} x / \\nu$.\n- Impose near-wall resolution targets that are consistent with resolving the viscous sublayer with SA without wall functions: $y_{1}^{+} = 0.5$, $\\Delta x^{+} = 50$, and $\\Delta z^{+} = 15$. Use these as the wall-unit requirements that you convert to physical spacings.\n\nDerive symbolic expressions for $\\Delta x$, $\\Delta z$, and $y_{1}$ in terms of $U_{\\infty}$, $x$, $\\nu$, and the wall-unit targets, then evaluate them numerically for the given conditions. Express the final spacings as a single row vector $\\begin{pmatrix}\\Delta x & \\Delta z & y_{1}\\end{pmatrix}$ in millimeters, and round your answer to three significant figures.", "solution": "The problem statement is critically validated before proceeding to a solution.\n\nStep 1: Extract Givens\n-   **Flow configuration**: Smooth, zero-pressure-gradient turbulent boundary layer on a flat plate. Incompressible flow. Hydraulically smooth wall.\n-   **Fluid properties (air)**: Density $\\rho = 1.225\\,\\mathrm{kg/m^3}$, kinematic viscosity $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$.\n-   **Flow conditions**: Free-stream speed $U_{\\infty} = 30\\,\\mathrm{m/s}$.\n-   **Location**: Streamwise position $x = 0.5\\,\\mathrm{m}$ from the leading edge.\n-   **Turbulence model**: Spalart–Allmaras (SA) model without wall functions.\n-   **Definitions and correlations**:\n    -   Viscous sublayer velocity profile: $u^{+} = y^{+}$.\n    -   Local Reynolds number: $\\mathrm{Re}_{x} = U_{\\infty} x / \\nu$.\n    -   Local skin-friction coefficient correlation: $C_{f,x} = 0.026\\,\\mathrm{Re}_{x}^{-1/7}$.\n-   **Resolution targets (in wall units)**:\n    -   First off-wall point spacing: $y_{1}^{+} = 0.5$.\n    -   Streamwise grid spacing: $\\Delta x^{+} = 50$.\n    -   Spanwise grid spacing: $\\Delta z^{+} = 15$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically sound, well-posed, and objective.\n-   **Scientific Grounding**: The problem is based on fundamental principles of fluid mechanics and computational fluid dynamics (CFD). The concepts of turbulent boundary layers, wall units ($y^{+}$, $u^{+}$), friction velocity ($u_{\\tau}$), skin-friction coefficient ($C_{f,x}$), and Reynolds number ($\\mathrm{Re}_{x}$) are standard. The use of the one-seventh power law for $C_{f,x}$ is a classical empirical approximation for turbulent flat-plate boundary layers. The specified wall-unit resolution targets ($y_{1}^{+} < 1$, $\\Delta x^{+} \\approx 50$, $\\Delta z^{+} \\approx 15$) are typical and appropriate for wall-resolved simulations that aim to resolve the viscous sublayer, as required by the SA model without wall functions. All provided numerical values are physically realistic for air at standard conditions.\n-   **Well-Posedness and Completeness**: The problem is self-contained and provides all necessary data and relationships to derive a unique solution. The path to the solution is logically structured.\n-   **Objectivity**: The language is precise and free of subjective or ambiguous terminology.\n\nStep 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\nThe objective is to determine the required physical grid spacings $y_{1}$ (first cell height), $\\Delta x$ (streamwise spacing), and $\\Delta z$ (spanwise spacing) to meet the specified resolution targets in wall units. The derivation will first establish symbolic expressions and then evaluate them numerically.\n\nThe non-dimensional wall units are defined using the friction velocity, $u_{\\tau}$, and the kinematic viscosity, $\\nu$. The friction velocity is defined as $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$, where $\\tau_{w}$ is the wall shear stress. The viscous length scale is $\\delta_{\\nu} = \\nu/u_{\\tau}$.\n\nThe wall-unit spacings are defined as:\n$$y_{1}^{+} = \\frac{y_{1}}{\\delta_{\\nu}} = \\frac{y_{1} u_{\\tau}}{\\nu}$$\n$$\\Delta x^{+} = \\frac{\\Delta x}{\\delta_{\\nu}} = \\frac{\\Delta x u_{\\tau}}{\\nu}$$\n$$\\Delta z^{+} = \\frac{\\Delta z}{\\delta_{\\nu}} = \\frac{\\Delta z u_{\\tau}}{\\nu}$$\nRearranging these equations gives the physical spacings in terms of the wall-unit targets and flow properties:\n$$y_{1} = \\frac{y_{1}^{+} \\nu}{u_{\\tau}}$$\n$$\\Delta x = \\frac{\\Delta x^{+} \\nu}{u_{\\tau}}$$\n$$\\Delta z = \\frac{\\Delta z^{+} \\nu}{u_{\\tau}}$$\nTo proceed, we must determine the friction velocity, $u_{\\tau}$. This is accomplished using the local skin-friction coefficient, $C_{f,x}$, which is defined as:\n$$C_{f,x} = \\frac{\\tau_{w}}{\\frac{1}{2}\\rho U_{\\infty}^{2}}$$\nSubstituting $\\tau_{w} = \\rho u_{\\tau}^{2}$ into the definition of $C_{f,x}$ gives:\n$$C_{f,x} = \\frac{\\rho u_{\\tau}^{2}}{\\frac{1}{2}\\rho U_{\\infty}^{2}} = \\frac{2 u_{\\tau}^{2}}{U_{\\infty}^{2}}$$\nSolving for $u_{\\tau}$ yields:\n$$u_{\\tau} = U_{\\infty} \\sqrt{\\frac{C_{f,x}}{2}}$$\nThe problem provides the classical one-seventh power-law correlation for $C_{f,x}$ for a smooth flat plate at zero pressure gradient:\n$$C_{f,x} = 0.026\\,\\mathrm{Re}_{x}^{-1/7}$$\nwhere the local Reynolds number, $\\mathrm{Re}_{x}$, is given by:\n$$\\mathrm{Re}_{x} = \\frac{U_{\\infty} x}{\\nu}$$\nBy substituting the expression for $C_{f,x}$ into the equation for $u_{\\tau}$, we derive a symbolic expression for the friction velocity in terms of the given parameters:\n$$u_{\\tau} = U_{\\infty} \\sqrt{\\frac{0.026\\,\\mathrm{Re}_{x}^{-1/7}}{2}} = U_{\\infty} \\sqrt{0.013}\\,\\mathrm{Re}_{x}^{-1/14}$$\nNow, we can substitute this expression for $u_{\\tau}$ back into the equations for the physical spacings. This provides the final symbolic expressions for $y_{1}$, $\\Delta x$, and $\\Delta z$:\n$$y_{1} = \\frac{y_{1}^{+} \\nu}{U_{\\infty} \\sqrt{0.013}\\,\\mathrm{Re}_{x}^{-1/14}} = \\frac{y_{1}^{+} \\nu}{\\sqrt{0.013}\\,U_{\\infty}} \\left( \\frac{U_{\\infty} x}{\\nu} \\right)^{1/14}$$\n$$\\Delta x = \\frac{\\Delta x^{+} \\nu}{U_{\\infty} \\sqrt{0.013}\\,\\mathrm{Re}_{x}^{-1/14}} = \\frac{\\Delta x^{+} \\nu}{\\sqrt{0.013}\\,U_{\\infty}} \\left( \\frac{U_{\\infty} x}{\\nu} \\right)^{1/14}$$\n$$\\Delta z = \\frac{\\Delta z^{+} \\nu}{U_{\\infty} \\sqrt{0.013}\\,\\mathrm{Re}_{x}^{-1/14}} = \\frac{\\Delta z^{+} \\nu}{\\sqrt{0.013}\\,U_{\\infty}} \\left( \\frac{U_{\\infty} x}{\\nu} \\right)^{1/14}$$\nThese are the required symbolic expressions. Next, we evaluate them numerically using the provided values: $U_{\\infty} = 30\\,\\mathrm{m/s}$, $x = 0.5\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $y_{1}^{+} = 0.5$, $\\Delta x^{+} = 50$, and $\\Delta z^{+} = 15$.\n\nFirst, calculate the local Reynolds number $\\mathrm{Re}_{x}$:\n$$\\mathrm{Re}_{x} = \\frac{(30\\,\\mathrm{m/s})(0.5\\,\\mathrm{m})}{1.5\\times 10^{-5}\\,\\mathrm{m^2/s}} = \\frac{15}{1.5\\times 10^{-5}} = 1.0 \\times 10^{6}$$\nNext, calculate the local skin-friction coefficient $C_{f,x}$:\n$$C_{f,x} = 0.026 \\times (1.0 \\times 10^{6})^{-1/7} \\approx 0.026 \\times 0.13895 \\approx 0.0036127$$\nNow, calculate the friction velocity $u_{\\tau}$:\n$$u_{\\tau} = U_{\\infty} \\sqrt{\\frac{C_{f,x}}{2}} \\approx 30\\,\\mathrm{m/s} \\times \\sqrt{\\frac{0.0036127}{2}} \\approx 30 \\times \\sqrt{0.00180635} \\approx 30 \\times 0.042501 \\,\\mathrm{m/s} \\approx 1.2750\\,\\mathrm{m/s}$$\nWe can now determine the required physical spacings in meters:\n$$y_{1} = \\frac{y_{1}^{+} \\nu}{u_{\\tau}} \\approx \\frac{0.5 \\times (1.5\\times 10^{-5}\\,\\mathrm{m^2/s})}{1.2750\\,\\mathrm{m/s}} \\approx 5.882 \\times 10^{-6}\\,\\mathrm{m}$$\n$$\\Delta x = \\frac{\\Delta x^{+} \\nu}{u_{\\tau}} \\approx \\frac{50 \\times (1.5\\times 10^{-5}\\,\\mathrm{m^2/s})}{1.2750\\,\\mathrm{m/s}} \\approx 5.882 \\times 10^{-4}\\,\\mathrm{m}$$\n$$\\Delta z = \\frac{\\Delta z^{+} \\nu}{u_{\\tau}} \\approx \\frac{15 \\times (1.5\\times 10^{-5}\\,\\mathrm{m^2/s})}{1.2750\\,\\mathrm{m/s}} \\approx 1.765 \\times 10^{-4}\\,\\mathrm{m}$$\nThe problem requires the final answer in millimeters, rounded to three significant figures. We convert the results from meters to millimeters ($1\\,\\mathrm{m} = 1000\\,\\mathrm{mm}$):\n$$y_{1} \\approx 5.882 \\times 10^{-3}\\,\\mathrm{mm} \\approx 0.00588\\,\\mathrm{mm}$$\n$$\\Delta x \\approx 0.5882\\,\\mathrm{mm} \\approx 0.588\\,\\mathrm{mm}$$\n$$\\Delta z \\approx 0.1765\\,\\mathrm{mm} \\approx 0.176\\,\\mathrm{mm}$$\nThe final answer is presented as a row vector $\\begin{pmatrix}\\Delta x & \\Delta z & y_{1}\\end{pmatrix}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.588 & 0.176 & 0.00588\n\\end{pmatrix}\n}\n$$", "id": "3380871"}, {"introduction": "Beyond its physical formulation, the robustness of a turbulence model depends on its numerical properties during implementation. The Spalart–Allmaras transport equation contains source and sink terms that can pose significant challenges for numerical stability, particularly the risk of producing unphysical negative values for the turbulence variable. This practice [@problem_id:3380837] delves into the numerical analysis of the discretized SA equation, guiding you through the derivation of a time-step restriction and a positivity-preserving limiter. This advanced exercise will deepen your understanding of the crucial interplay between physical modeling and numerical methods in CFD.", "problem": "Consider the one-equation Spalart–Allmaras (SA) turbulence model for the working variable $\\tilde{\\nu}$ in a one-dimensional channel with uniform mean convection velocity $u>0$. The governing transport equation for $\\tilde{\\nu}$ consists of advection, diffusion, production, and destruction. For the purpose of rigorous analysis, adopt the following physically standard simplification: retain the linear production term proportional to the mean strain $S$ and the quadratic destruction term proportional to $(\\tilde{\\nu}/d)^{2}$, and neglect the nonlinear gradient production term. The resulting partial differential equation reads\n$$\n\\frac{\\partial \\tilde{\\nu}}{\\partial t} + u \\frac{\\partial \\tilde{\\nu}}{\\partial x} = c_{b1} S \\tilde{\\nu} + \\frac{\\partial}{\\partial x}\\!\\left(\\alpha\\,\\frac{\\partial \\tilde{\\nu}}{\\partial x}\\right) - c_{w1}\\left(\\frac{\\tilde{\\nu}}{d}\\right)^{2},\n$$\nwhere $\\alpha \\equiv \\frac{\\nu + \\tilde{\\nu}}{\\sigma}$, with $\\nu$ the molecular kinematic viscosity, $\\sigma$ a positive model constant, $c_{b1}$ the production constant, $c_{w1}$ the destruction constant, and $d>0$ a wall-distance function.\n\nDiscretize this equation on a uniform grid $x_{i} = i\\,\\Delta x$ using explicit Euler in time, first-order upwind advection for $u>0$, and second-order central diffusion with a frozen coefficient $\\alpha$ evaluated at the start of the time step. The semi-discrete update at cell index $i$ is\n$$\n\\tilde{\\nu}_{i}^{n+1} = \\tilde{\\nu}_{i}^{n} - \\lambda\\left(\\tilde{\\nu}_{i}^{n} - \\tilde{\\nu}_{i-1}^{n}\\right) + \\mu\\left(\\tilde{\\nu}_{i+1}^{n} - 2\\tilde{\\nu}_{i}^{n} + \\tilde{\\nu}_{i-1}^{n}\\right) + \\Delta t\\,c_{b1} S \\tilde{\\nu}_{i}^{n} - \\Delta t\\,c_{w1}\\left(\\frac{\\tilde{\\nu}_{i}^{n}}{d}\\right)^{2},\n$$\nwhere $\\lambda \\equiv \\frac{u\\,\\Delta t}{\\Delta x}$ and $\\mu \\equiv \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}$. Assume that the initial data are nonnegative, $\\tilde{\\nu}_{i}^{0}\\ge 0$ for all $i$, and that $\\alpha$ is bounded above by its value at a known bound $\\tilde{\\nu}_{\\max}$, i.e., $\\alpha \\le \\alpha_{\\max}$ with $\\alpha_{\\max} \\equiv \\frac{\\nu + \\tilde{\\nu}_{\\max}}{\\sigma}$.\n\nTask A. Starting from the discrete update and the requirement that a scalar monotone scheme preserves nonnegativity under explicit time stepping, derive a sufficient time-step restriction that guarantees $\\tilde{\\nu}_{i}^{n+1}\\ge 0$ whenever $\\tilde{\\nu}_{i}^{n}\\ge 0$ and $\\tilde{\\nu}_{i\\pm 1}^{n}\\ge 0$. Your derivation must identify the mechanism by which $\\tilde{\\nu}$ can become negative due to the explicit discretization of the destruction term and produce a closed-form bound on $\\Delta t$ in terms of $u$, $\\Delta x$, $\\alpha_{\\max}$, $c_{w1}$, $d$, and $\\tilde{\\nu}_{\\max}$.\n\nTask B. Propose a positivity-preserving limiter that is consistent with the continuous destruction model, obtained by analytically integrating the local ordinary differential equation $\\frac{\\partial \\tilde{\\nu}}{\\partial t} = -c_{w1}\\left(\\frac{\\tilde{\\nu}}{d}\\right)^{2}$ over a single time step while treating advection, diffusion, and production as already applied to produce an intermediate value $\\tilde{\\nu}^{*}$. Provide the closed-form expression that maps $\\tilde{\\nu}^{*}$ to $\\tilde{\\nu}^{n+1}$ and preserves positivity for any $\\tilde{\\nu}^{*}\\ge 0$.\n\nFinally, evaluate your time-step restriction using the following physically consistent parameters:\n- $u = 40\\,\\mathrm{m/s}$,\n- $\\Delta x = 1.0\\times 10^{-4}\\,\\mathrm{m}$,\n- $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$,\n- $\\sigma = 2/3$,\n- $d = 5.0\\times 10^{-4}\\,\\mathrm{m}$,\n- $c_{w1} = 3.239$,\n- $\\tilde{\\nu}_{\\max} = 5.0\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$.\n\nExpress the maximum allowable time step in seconds and round to four significant figures. Also provide the positivity-preserving destruction limiter as a closed-form analytic expression. Your final answer must consist of the numerical time step followed by the analytic limiter, presented together.", "solution": "The problem requires the derivation of a time-step restriction for a positivity-preserving explicit numerical scheme for a simplified Spalart-Allmaras (SA) model, and the formulation of a positivity-preserving limiter for the destruction term. Finally, the derived time-step restriction must be evaluated for a given set of parameters.\n\n### Problem Validation\n\nFirst, the\nproblem statement is validated.\nThe givens are:\n-   The partial differential equation for the SA working variable $\\tilde{\\nu}$:\n    $$\n    \\frac{\\partial \\tilde{\\nu}}{\\partial t} + u \\frac{\\partial \\tilde{\\nu}}{\\partial x} \\;=\\; c_{b1} S \\tilde{\\nu} \\;+\\; \\frac{\\partial}{\\partial x}\\!\\left(\\alpha\\,\\frac{\\partial \\tilde{\\nu}}{\\partial x}\\right) \\;-\\; c_{w1}\\left(\\frac{\\tilde{\\nu}}{d}\\right)^{2}\n    $$\n-   The definitions of associated parameters: $u > 0$, $\\alpha \\equiv \\frac{\\nu + \\tilde{\\nu}}{\\sigma}$, $\\sigma>0$, $d>0$.\n-   The semi-discrete update rule:\n    $$\n    \\tilde{\\nu}_{i}^{n+1} \\;=\\; \\tilde{\\nu}_{i}^{n} \\;-\\; \\lambda\\left(\\tilde{\\nu}_{i}^{n} - \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\mu\\left(\\tilde{\\nu}_{i+1}^{n} - 2\\tilde{\\nu}_{i}^{n} + \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\Delta t\\,c_{b1} S \\tilde{\\nu}_{i}^{n} \\;-\\; \\Delta t\\,c_{w1}\\left(\\frac{\\tilde{\\nu}_{i}^{n}}{d}\\right)^{2}\n    $$\n-   The definitions for the numerical parameters: $\\lambda \\equiv \\frac{u\\,\\Delta t}{\\Delta x}$ and $\\mu \\equiv \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}$.\n-   The initial condition: $\\tilde{\\nu}_{i}^{0}\\ge 0$ for all $i$.\n-   An upper bound on $\\alpha$: $\\alpha \\le \\alpha_{\\max}$ where $\\alpha_{\\max} \\equiv \\frac{\\nu + \\tilde{\\nu}_{\\max}}{\\sigma}$.\n-   Numerical values for evaluation: $u = 40\\,\\mathrm{m/s}$, $\\Delta x = 1.0\\times 10^{-4}\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^{2}/\\mathrm{s}$, $\\sigma = 2/3$, $d = 5.0\\times 10^{-4}\\,\\mathrm{m}$, $c_{w1} = 3.239$, $\\tilde{\\nu}_{\\max} = 5.0\\times 10^{-4}\\,\\mathrm{m}^{2}/\\mathrm{s}$.\n\nThe problem is scientifically grounded in computational fluid dynamics and numerical analysis. It is well-posed, objective, and self-contained, with one minor point of clarification regarding the production term $c_{b1} S \\tilde{\\nu}$. The problem asks for a sufficient time-step restriction for non-negativity. The production term, if $c_{b1}S > 0$, acts as a source for $\\tilde{\\nu}$, which helps maintain positivity. To derive a sufficient condition that is robust, we must consider the worst-case scenario, which is the minimal contribution from this source term. Assuming $c_{b1}S \\ge 0$, the minimal source is zero. Including this term with $c_{b1}S=0$ will yield the most restrictive, and therefore sufficient, time-step limit. The problem is thus deemed valid.\n\n### Task A: Derivation of the Time-Step Restriction\n\nThe goal is to find a sufficient condition on the time step $\\Delta t$ that guarantees $\\tilde{\\nu}_{i}^{n+1} \\ge 0$, given that $\\tilde{\\nu}_{j}^{n} \\ge 0$ for all grid points $j$.\nThe discretized equation is:\n$$\n\\tilde{\\nu}_{i}^{n+1} \\;=\\; \\tilde{\\nu}_{i}^{n} \\;-\\; \\frac{u\\,\\Delta t}{\\Delta x}\\left(\\tilde{\\nu}_{i}^{n} - \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}\\left(\\tilde{\\nu}_{i+1}^{n} - 2\\tilde{\\nu}_{i}^{n} + \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\Delta t\\,c_{b1} S \\tilde{\\nu}_{i}^{n} \\;-\\; \\Delta t\\,c_{w1}\\left(\\frac{\\tilde{\\nu}_{i}^{n}}{d}\\right)^{2}\n$$\nTo analyze for positivity, we rearrange the equation by grouping terms with the same spatial index at time level $n$:\n$$\n\\tilde{\\nu}_{i}^{n+1} \\;=\\; \\left(1 - \\frac{u\\,\\Delta t}{\\Delta x} - \\frac{2\\alpha\\,\\Delta t}{\\Delta x^{2}} + \\Delta t\\,c_{b1} S\\right)\\tilde{\\nu}_{i}^{n} \\;+\\; \\left(\\frac{u\\,\\Delta t}{\\Delta x} + \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}\\right)\\tilde{\\nu}_{i-1}^{n} \\;+\\; \\left(\\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}\\right)\\tilde{\\nu}_{i+1}^{n} \\;-\\; \\Delta t\\,c_{w1}\\frac{(\\tilde{\\nu}_{i}^{n})^{2}}{d^{2}}\n$$\nGiven $\\tilde{\\nu}_{j}^{n} \\ge 0$ for all $j$, and that $u, \\Delta t, \\Delta x, \\alpha$ are all positive, the coefficients of $\\tilde{\\nu}_{i-1}^{n}$ and $\\tilde{\\nu}_{i+1}^{n}$ are non-negative. Therefore, the terms involving neighboring points, $(\\frac{u\\,\\Delta t}{\\Delta x} + \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}})\\tilde{\\nu}_{i-1}^{n}$ and $(\\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}})\\tilde{\\nu}_{i+1}^{n}$, are non-negative.\n\nA sufficient condition to ensure $\\tilde{\\nu}_{i}^{n+1} \\ge 0$ is that the sum of the remaining terms involving $\\tilde{\\nu}_{i}^{n}$ is non-negative. This is a conservative condition, equivalent to demanding positivity in the worst-case scenario where contributions from neighbors are zero (i.e., $\\tilde{\\nu}_{i-1}^{n} = 0$ and $\\tilde{\\nu}_{i+1}^{n} = 0$).\n$$\n\\left(1 - \\frac{u\\,\\Delta t}{\\Delta x} - \\frac{2\\alpha\\,\\Delta t}{\\Delta x^{2}} + \\Delta t\\,c_{b1} S\\right)\\tilde{\\nu}_{i}^{n} - \\Delta t\\,c_{w1}\\frac{(\\tilde{\\nu}_{i}^{n})^{2}}{d^{2}} \\ge 0\n$$\nAssuming $\\tilde{\\nu}_{i}^{n} > 0$, we can divide by $\\tilde{\\nu}_{i}^{n}$ (the case $\\tilde{\\nu}_{i}^{n}=0$ trivially satisfies the inequality, yielding $\\tilde{\\nu}_{i}^{n+1}=0$ if neighbors are also zero).\n$$\n1 - \\frac{u\\,\\Delta t}{\\Delta x} - \\frac{2\\alpha\\,\\Delta t}{\\Delta x^{2}} + \\Delta t\\,c_{b1} S - \\Delta t\\,c_{w1}\\frac{\\tilde{\\nu}_{i}^{n}}{d^{2}} \\ge 0\n$$\nThis inequality identifies the mechanism for creating negative values: the sum of outflows from advection ($u \\tilde{\\nu}_{i}^{n}$) and diffusion ($2\\alpha \\tilde{\\nu}_{i}^{n} / \\Delta x$), plus the explicit destruction, can exceed the local value $\\tilde{\\nu}_{i}^{n}$ in a single time step.\nRearranging to solve for $\\Delta t$:\n$$\n1 + \\Delta t\\,c_{b1} S \\ge \\Delta t \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} + \\frac{c_{w1}\\tilde{\\nu}_{i}^{n}}{d^2} \\right)\n$$\n$$\n\\Delta t \\le \\frac{1 + \\Delta t\\,c_{b1} S}{\\frac{u}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} + \\frac{c_{w1}\\tilde{\\nu}_{i}^{n}}{d^2}}\n$$\nThis is not an explicit bound on $\\Delta t$. We can achieve one by returning to the previous inequality and isolating $\\Delta t$:\n$$\n1 \\ge \\Delta t \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} - c_{b1} S + \\frac{c_{w1}\\tilde{\\nu}_{i}^{n}}{d^2} \\right)\n$$\n$$\n\\Delta t \\le \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} - c_{b1} S + \\frac{c_{w1}\\tilde{\\nu}_{i}^{n}}{d^2} \\right)^{-1}\n$$\nTo obtain a single time-step restriction valid for all grid points and all times, we must choose the most restrictive condition. This corresponds to maximizing the denominator:\n1.  Maximize $\\alpha$: Use the provided bound $\\alpha \\le \\alpha_{\\max}$.\n2.  Maximize $\\tilde{\\nu}_{i}^{n}$: Use the provided bound $\\tilde{\\nu}_{\\max}$.\n3.  Minimize $c_{b1}S$: As argued during validation, the term $c_{b1}S\\tilde{\\nu}$ is a source term (for $S>0$) that aids positivity. The most restrictive (and thus sufficient) condition is obtained by assuming the minimum possible source, which is $c_{b1}S = 0$.\n\nThe resulting sufficient time-step restriction is:\n$$\n\\Delta t \\le \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha_{\\max}}{\\Delta x^2} + \\frac{c_{w1}\\tilde{\\nu}_{\\max}}{d^2} \\right)^{-1}\n$$\n\n### Task B: Positivity-Preserving Limiter for Destruction\n\nThe task is to find a positivity-preserving update for the destruction term by solving the local ODE $\\frac{\\partial \\tilde{\\nu}}{\\partial t} = -c_{w1}\\left(\\frac{\\tilde{\\nu}}{d}\\right)^{2}$ over a time step $\\Delta t$. Let $\\tilde{\\nu}^{*}$ be the value of the variable after the advection, diffusion, and production steps, which serves as the initial condition for the destruction step. We solve:\n$$\n\\frac{d\\tilde{\\nu}}{dt} = -\\frac{c_{w1}}{d^2} \\tilde{\\nu}^2\n$$\nwith initial condition $\\tilde{\\nu}(0) = \\tilde{\\nu}^{*}$. We seek $\\tilde{\\nu}^{n+1} = \\tilde{\\nu}(\\Delta t)$. This is a separable ODE:\n$$\n\\frac{d\\tilde{\\nu}}{\\tilde{\\nu}^2} = -\\frac{c_{w1}}{d^2} dt\n$$\nIntegrating from $t=0$ to $\\Delta t$ (and from $\\tilde{\\nu}^{*}$ to $\\tilde{\\nu}^{n+1}$):\n$$\n\\int_{\\tilde{\\nu}^{*}}^{\\tilde{\\nu}^{n+1}} \\frac{1}{\\nu'^2} d\\nu' = -\\int_{0}^{\\Delta t} \\frac{c_{w1}}{d^2} dt'\n$$\n$$\n\\left[ -\\frac{1}{\\nu'} \\right]_{\\tilde{\\nu}^{*}}^{\\tilde{\\nu}^{n+1}} = -\\frac{c_{w1}\\Delta t}{d^2}\n$$\n$$\n-\\frac{1}{\\tilde{\\nu}^{n+1}} + \\frac{1}{\\tilde{\\nu}^{*}} = -\\frac{c_{w1}\\Delta t}{d^2}\n$$\nSolving for $\\tilde{\\nu}^{n+1}$:\n$$\n\\frac{1}{\\tilde{\\nu}^{n+1}} = \\frac{1}{\\tilde{\\nu}^{*}} + \\frac{c_{w1}\\Delta t}{d^2} = \\frac{d^2 + c_{w1}\\Delta t \\tilde{\\nu}^{*}}{d^2 \\tilde{\\nu}^{*}}\n$$\n$$\n\\tilde{\\nu}^{n+1} = \\frac{d^2 \\tilde{\\nu}^{*}}{d^2 + c_{w1}\\Delta t \\tilde{\\nu}^{*}} = \\frac{\\tilde{\\nu}^{*}}{1 + \\frac{c_{w1}\\Delta t}{d^2}\\tilde{\\nu}^{*}}\n$$\nThis expression provides the mapping from an intermediate state $\\tilde{\\nu}^{*}$ to the final state $\\tilde{\\nu}^{n+1}$. For any non-negative $\\tilde{\\nu}^{*} \\ge 0$, the numerator is non-negative and the denominator is strictly positive (since $c_{w1}, \\Delta t, d^2$ are positive), guaranteeing that $\\tilde{\\nu}^{n+1} \\ge 0$.\n\n### Final Evaluation\n\nWe are asked to evaluate the time-step restriction using the given numerical values.\n1.  Calculate $\\alpha_{\\max}$:\n    $$ \\alpha_{\\max} = \\frac{\\nu + \\tilde{\\nu}_{\\max}}{\\sigma} = \\frac{1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s} + 5.0\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}}{2/3} = \\frac{5.15\\times 10^{-4}}{2/3} = 7.725 \\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s} $$\n2.  Calculate the three components of the inverse time-step:\n    -   Advective frequency: $\\frac{u}{\\Delta x} = \\frac{40\\,\\mathrm{m/s}}{1.0\\times 10^{-4}\\,\\mathrm{m}} = 4.0 \\times 10^{5}\\,\\mathrm{s}^{-1}$\n    -   Diffusive frequency: $\\frac{2\\alpha_{\\max}}{\\Delta x^2} = \\frac{2 \\times 7.725 \\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}}{(1.0\\times 10^{-4}\\,\\mathrm{m})^2} = \\frac{1.545 \\times 10^{-3}}{1.0 \\times 10^{-8}}\\,\\mathrm{s}^{-1} = 1.545 \\times 10^{5}\\,\\mathrm{s}^{-1}$\n    -   Destruction frequency: $\\frac{c_{w1}\\tilde{\\nu}_{\\max}}{d^2} = \\frac{3.239 \\times 5.0\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}}{(5.0\\times 10^{-4}\\,\\mathrm{m})^2} = \\frac{3.239}{5.0\\times 10^{-4}}\\,\\mathrm{s}^{-1} = 6478\\,\\mathrm{s}^{-1}$\n3.  Sum the frequencies to find the denominator for the $\\Delta t$ restriction:\n    $$ \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha_{\\max}}{\\Delta x^2} + \\frac{c_{w1}\\tilde{\\nu}_{\\max}}{d^2} \\right) = (4.0 \\times 10^5 + 1.545 \\times 10^5 + 0.06478 \\times 10^5)\\,\\mathrm{s}^{-1} \\approx 5.6098 \\times 10^5\\,\\mathrm{s}^{-1} $$\n4.  Calculate the maximum allowable time step:\n    $$ \\Delta t_{\\max} = \\frac{1}{5.60978 \\times 10^5\\,\\mathrm{s}^{-1}} \\approx 1.78259 \\times 10^{-6}\\,\\mathrm{s} $$\n    Rounding to four significant figures gives $\\Delta t_{\\max} = 1.783 \\times 10^{-6}\\,\\mathrm{s}$.\n\nThe final answer consists of this numerical value and the analytical expression for the limiter.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.783 \\times 10^{-6} & \\frac{\\tilde{\\nu}^{*}}{1 + \\frac{c_{w1} \\Delta t}{d^2}\\tilde{\\nu}^{*}} \\end{pmatrix}}\n$$", "id": "3380837"}]}