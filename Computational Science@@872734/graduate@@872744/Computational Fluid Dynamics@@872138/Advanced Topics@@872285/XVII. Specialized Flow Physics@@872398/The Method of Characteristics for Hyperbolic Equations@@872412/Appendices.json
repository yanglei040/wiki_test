{"hands_on_practices": [{"introduction": "Understanding how continuous solutions to hyperbolic equations can evolve into discontinuities is a cornerstone of advanced fluid dynamics. This first exercise provides a foundational, hands-on derivation for the inviscid Burgers' equation, the archetypal model for nonlinear wave propagation. By constructing the solution from first principles using characteristic curves, you will gain a deep appreciation for how nonlinearity causes wave steepening and ultimately leads to the formation of shock waves, a phenomenon that classical differentiable solutions cannot describe [@problem_id:3376534].", "problem": "Consider the scalar conservation law for one-dimensional inviscid flow\n$$\nu_{t} + u\\,u_{x} = 0,\\quad (x,t)\\in \\mathbb{R}\\times [0,\\infty),\n$$\nwith initial condition\n$$\nu(x,0)=\\phi(x),\n$$\nwhere $\\phi:\\mathbb{R}\\to\\mathbb{R}$ is a continuously differentiable function with $\\phi\\in C^{1}(\\mathbb{R})$ and $\\phi$ and $\\phi'$ bounded. Starting from the conservation-law structure and the definition of characteristic curves, derive the characteristic ordinary differential equations and integrate them to obtain the Lagrangian flow map from initial footpoint $a$ to current position $x$ at time $t$. Use this to construct the characteristic mapping and state the precise condition under which it is locally invertible. Then, express the classical solution $u(x,t)$, valid up to the earliest time of shock formation, in terms of $\\phi$ and the inverse of the characteristic footpoint mapping. Finally, determine the earliest shock formation time $t_{\\ast}$ in terms of $\\phi'$, understood as the supremum of times for which a classical solution with $u\\in C^{1}$ exists.\n\nYour final answer must consist of:\n- a single explicit expression for $u(x,t)$ written in terms of $\\phi$ and the inverse of the characteristic footpoint map, and\n- a single explicit expression for $t_{\\ast}$ written in terms of $\\phi'$.\n\nNo numerical evaluation or rounding is required. Express your answer symbolically. Do not include units. If your expression is piecewise-defined, you must write it explicitly as such.", "solution": "The problem as stated constitutes a valid initial value problem for the inviscid Burgers' equation, a fundamental scalar hyperbolic conservation law. All provided information is consistent and sufficient to derive the classical solution via the method of characteristics and to determine its time of validity.\n\nThe given partial differential equation is the inviscid Burgers' equation in quasi-linear form:\n$$\nu_{t} + u\\,u_{x} = 0, \\quad (x,t)\\in \\mathbb{R}\\times [0,\\infty)\n$$\nwith the initial condition $u(x,0)=\\phi(x)$. The function $\\phi$ is given to be in $C^{1}(\\mathbb{R})$ with $\\phi$ and its derivative $\\phi'$ being bounded.\n\nWe seek a solution using the method of characteristics. Let a curve in the $(x,t)$-plane be parameterized by $s \\mapsto (x(s), t(s))$. Let's choose $s=t$, so the curve is given by $x(t)$. The total derivative of the solution $u(x(t),t)$ along this curve is:\n$$\n\\frac{d}{dt}u(x(t),t) = u_{t}(x(t),t) + u_{x}(x(t),t) \\frac{dx}{dt}\n$$\nComparing this with the PDE, $u_t = -u u_x$, we see that if we define the characteristic curves by the ordinary differential equation (ODE):\n$$\n\\frac{dx}{dt} = u(x(t),t)\n$$\nthen along these curves, the total derivative of $u$ becomes:\n$$\n\\frac{d}{dt}u(x(t),t) = -u u_x + u_x u = 0\n$$\nThus, the system of characteristic ODEs is:\n$$\n\\frac{du}{dt} = 0\n$$\n$$\n\\frac{dx}{dt} = u\n$$\nThe first ODE, $\\frac{du}{dt}=0$, implies that the value of the solution $u$ is constant along any given characteristic curve. The value of this constant is determined by the initial condition. Let a characteristic curve originate at the point $(a,0)$ on the initial line $t=0$. The value of $u$ along this entire curve is $u(x(0),0) = u(a,0) = \\phi(a)$.\n\nSubstituting this constant value into the second ODE, we get:\n$$\n\\frac{dx}{dt} = \\phi(a)\n$$\nWe integrate this ODE with respect to time $t$, using the initial condition $x(0)=a$:\n$$\n\\int_{a}^{x} d\\xi = \\int_{0}^{t} \\phi(a) d\\tau\n$$\nThis yields the equation for the characteristic lines:\n$$\nx(t) = a + \\phi(a)t\n$$\nThis equation represents the Lagrangian flow map, which we will denote by $x = M(a; t)$. It gives the position $x$ at time $t$ for a characteristic that started at the footpoint $a$ at $t=0$.\n\nThe solution $u$ at any point $(x,t)$ is the value $\\phi(a)$ carried by the characteristic that passes through $(x,t)$. To find this, we must determine the footpoint $a$ corresponding to a given $(x,t)$. This requires inverting the characteristic mapping $M(a;t)$. Let us denote this inverse map by $a(x,t)$, i.e., $a(x,t) = M^{-1}(x;t)$. The function $a(x,t)$ is therefore defined implicitly by the relation:\n$$\nx = a(x,t) + \\phi(a(x,t))t\n$$\nThe classical solution, valid for as long as this inversion is possible and unique, is then given by:\n$$\nu(x,t) = \\phi(a(x,t))\n$$\nThe condition for the characteristic mapping $a \\mapsto x$ to be locally invertible for a fixed $t$ is that its Jacobian does not vanish. In this one-dimensional case, the Jacobian is the derivative $\\frac{\\partial x}{\\partial a}$:\n$$\n\\frac{\\partial M(a;t)}{\\partial a} = \\frac{\\partial}{\\partial a}(a + \\phi(a)t) = 1 + \\phi'(a)t\n$$\nA classical, single-valued solution exists as long as $1 + \\phi'(a)t \\neq 0$ for all $a \\in \\mathbb{R}$. Since $t \\ge 0$, if $\\phi'(a) \\ge 0$ for all $a$, this condition is always satisfied.\n\nA shock wave forms at the earliest time $t_{\\ast} > 0$ when characteristics intersect. This corresponds to the instant when the derivative $u_x$ first becomes infinite, signaling the breakdown of the $C^1$ solution. To find $u_x$, we differentiate the expression for the solution with respect to $x$:\n$$\nu_x(x,t) = \\phi'(a(x,t)) \\frac{\\partial a}{\\partial x}\n$$\nTo find $\\frac{\\partial a}{\\partial x}$, we differentiate the implicit relation $x = a + \\phi(a)t$ with respect to $x$:\n$$\n1 = \\frac{\\partial a}{\\partial x} \\left( 1 + \\phi'(a(x,t))t \\right) \\implies \\frac{\\partial a}{\\partial x} = \\frac{1}{1 + \\phi'(a(x,t))t}\n$$\nSubstituting this back, we get the expression for the gradient of the solution:\n$$\nu_x(x,t) = \\frac{\\phi'(a(x,t))}{1 + \\phi'(a(x,t))t}\n$$\nThe gradient $u_x$ becomes infinite when the denominator is zero:\n$$\n1 + \\phi'(a)t = 0 \\implies t = -\\frac{1}{\\phi'(a)}\n$$\nSince $t$ must be positive, this can only occur for values of $a$ where $\\phi'(a) < 0$. The earliest time of shock formation, $t_{\\ast}$, is the minimum of these times over all possible initial points $a$:\n$$\nt_{\\ast} = \\inf_{a \\in \\mathbb{R} : \\phi'(a)<0} \\left\\{ -\\frac{1}{\\phi'(a)} \\right\\}\n$$\nTo find this infimum, we need to maximize the positive quantity $-\\phi'(a)$, which is equivalent to finding the minimum (most negative) value of $\\phi'(a)$. Let $m = \\inf_{y \\in \\mathbb{R}} \\phi'(y)$.\n\nThere are two cases:\n1.  If $m \\ge 0$, then $\\phi'(y) \\ge 0$ for all $y \\in \\mathbb{R}$. The condition for shock formation is never met. The classical solution exists for all time, so $t_{\\ast} = \\infty$.\n2.  If $m < 0$, a shock will form. The earliest time it can form corresponds to the most negative value of $\\phi'$, which is $m$. The shock time is $t_{\\ast} = -\\frac{1}{m} = -\\frac{1}{\\inf_{y \\in \\mathbb{R}} \\phi'(y)}$.\n\nCombining these cases, we arrive at the expression for the earliest shock formation time.\nThe first requested item is the expression for the classical solution $u(x,t)$ in terms of $\\phi$ and the inverse of the characteristic footpoint mapping. As derived, this is $u(x,t)=\\phi(a(x,t))$, where $a(x,t)$ is the inverse mapping.\nThe second requested item is the expression for the earliest shock time $t_{\\ast}$.", "answer": "$$\n\\boxed{\nt_{*} = \\begin{cases} -\\frac{1}{\\inf_{y \\in \\mathbb{R}} \\phi'(y)} & \\text{if } \\inf_{y \\in \\mathbb{R}} \\phi'(y) < 0 \\\\ \\infty & \\text{if } \\inf_{y \\in \\mathbb{R}} \\phi'(y) \\ge 0 \\end{cases}\n}\n$$", "id": "3376534"}, {"introduction": "Once a classical solution breaks down and a shock forms, we must turn to the framework of weak solutions to describe the system's evolution. This practice tackles this challenge directly by posing a Riemann problem, which involves an initial discontinuity between two constant states. You will apply the Rankine-Hugoniot jump condition to determine the speed of the resulting shock wave, a fundamental skill for analyzing and computing the discontinuous solutions that are ubiquitous in compressible flow and other areas of physics [@problem_id:3376556].", "problem": "Consider the one-dimensional nonlinear scalar conservation law\n$$\nu_{t} + \\partial_{x} f(u) = 0,\n$$\nrepresenting an inviscid conservation of a scalar quantity in computational fluid dynamics, with flux function $$f(u) = \\frac{u^{3}}{3}$$. The initial condition is a Riemann datum\n$$\nu(x,0) = \\begin{cases}\nu_{L}, & x < 0, \\\\\nu_{R}, & x > 0,\n\\end{cases}\n$$\nwhere $$u_{L} = 2$$ and $$u_{R} = -1$$. Using the Method of Characteristics (MOC) and the weak solution framework derived from the integral form of conservation laws, determine whether the resulting self-similar solution is a shock or a rarefaction. If a shock forms, compute its speed using the appropriate conservation and admissibility principles.\n\nExpress the final answer as a single real number for the shock speed (dimensionless). Provide the exact value; do not round.", "solution": "The problem statement has been validated and is deemed sound, well-posed, and scientifically grounded. It presents a classic Riemann problem for a nonlinear scalar conservation law.\n\nThe governing one-dimensional nonlinear scalar conservation law is given by:\n$$\nu_{t} + \\partial_{x} f(u) = 0\n$$\nwhere $u(x,t)$ is the conserved quantity, and the flux function $f(u)$ is specified as:\n$$\nf(u) = \\frac{u^{3}}{3}\n$$\nThe problem is subject to a Riemann initial condition:\n$$\nu(x,0) = \\begin{cases}\nu_{L}, & x < 0 \\\\\nu_{R}, & x > 0\n\\end{cases}\n$$\nwith the constant states $u_{L} = 2$ and $u_{R} = -1$.\n\nTo analyze the evolution of the solution, we first write the partial differential equation in its quasi-linear form, $u_{t} + c(u) u_{x} = 0$, where $c(u)$ is the characteristic speed. The characteristic speed is given by the derivative of the flux function with respect to $u$:\n$$\nc(u) = f'(u) = \\frac{d}{du}\\left(\\frac{u^{3}}{3}\\right) = u^{2}\n$$\nThe Method of Characteristics states that the value of $u$ remains constant along characteristic curves defined by $\\frac{dx}{dt} = c(u)$.\n\nWe evaluate the characteristic speeds for the initial left and right states:\nThe characteristic speed for the left state $u_{L} = 2$ is:\n$$\nc(u_{L}) = c(2) = 2^{2} = 4\n$$\nThe characteristic speed for the right state $u_{R} = -1$ is:\n$$\nc(u_{R}) = c(-1) = (-1)^{2} = 1\n$$\nThe type of solution that emerges from the initial discontinuity depends on the relationship between $c(u_{L})$ and $c(u_{R})$.\n- If $c(u_{L}) < c(u_{R})$, the characteristics diverge, and a continuous solution known as a rarefaction wave forms.\n- If $c(u_{L}) > c(u_{R})$, the characteristics from the left overtake the characteristics from the right. They intersect, leading to a multi-valued solution, which is unphysical. Nature resolves this by forming a discontinuity, or a shock wave.\n\nIn this problem, we have $c(u_{L}) = 4$ and $c(u_{R}) = 1$. Since $c(u_{L}) > c(u_{R})$, the characteristics collide, and a shock wave must form.\n\nThe speed of this shock, denoted by $s$, is determined by the Rankine-Hugoniot jump condition. This condition is derived from the integral form of the conservation law applied across the discontinuity and ensures that the shock correctly conserves the quantity $u$. The condition is:\n$$\ns = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}\n$$\nWe now compute the values of the flux function for the left and right states:\nFor $u_{L} = 2$, the flux is:\n$$\nf(u_{L}) = f(2) = \\frac{2^{3}}{3} = \\frac{8}{3}\n$$\nFor $u_{R} = -1$, the flux is:\n$$\nf(u_{R}) = f(-1) = \\frac{(-1)^{3}}{3} = -\\frac{1}{3}\n$$\nSubstituting these values into the Rankine-Hugoniot condition to find the shock speed $s$:\n$$\ns = \\frac{-\\frac{1}{3} - \\frac{8}{3}}{-1 - 2} = \\frac{-\\frac{9}{3}}{-3} = \\frac{-3}{-3} = 1\n$$\nFor this shock to be physically admissible, it must satisfy an entropy condition. The flux function $f(u) = u^3/3$ is non-convex, since its second derivative $f''(u) = 2u$ changes sign. Therefore, we must use the general Oleinik entropy condition. For a shock connecting $u_{L}$ to $u_{R}$ where $u_{L} > u_{R}$, the condition requires that the graph of $f(u)$ for $u \\in [u_{R}, u_{L}]$ lie below or on the line segment (the chord) connecting the points $(u_{R}, f(u_{R}))$ and $(u_{L}, f(u_{L}))$.\nMathematically, this translates to:\n$$\nf(u) \\le f(u_{R}) + s(u - u_{R}) \\quad \\text{for all } u \\in [u_{R}, u_{L}]\n$$\nPlugging in the known values, with $s=1$, $u_R=-1$, and $f(u_R)=-1/3$:\n$$\n\\frac{u^3}{3} \\le -\\frac{1}{3} + 1(u - (-1)) \\quad \\text{for all } u \\in [-1, 2]\n$$\n$$\n\\frac{u^3}{3} \\le u + 1 - \\frac{1}{3}\n$$\n$$\n\\frac{u^3}{3} \\le u + \\frac{2}{3}\n$$\nMultiplying by $3$ and rearranging gives:\n$$\nu^3 - 3u - 2 \\le 0\n$$\nLet's analyze the polynomial $p(u) = u^3 - 3u - 2$. By construction, its roots must include $u=u_L=2$ and $u=u_R=-1$. Indeed, $p(2) = 2^3 - 3(2) - 2 = 8 - 6 - 2 = 0$ and $p(-1) = (-1)^3 - 3(-1) - 2 = -1 + 3 - 2 = 0$. Since $u=-1$ is a root, $(u+1)$ is a factor. Since $p'(-1) = 3(-1)^2 - 3 = 0$, $u=-1$ is a double root. The polynomial factors as $p(u) = (u-2)(u+1)^2$.\nFor $u \\in [-1, 2]$, the term $(u+1)^2$ is non-negative, and the term $(u-2)$ is non-positive. Consequently, their product $(u-2)(u+1)^2$ is non-positive for all $u$ in the interval $[-1, 2]$. The Oleinik entropy condition is satisfied, confirming that the shock is admissible.\n\nThe resulting self-similar solution is a shock wave propagating with a constant speed $s = 1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "3376556"}, {"introduction": "The true power of the method of characteristics is revealed when applied to systems of equations governing real-world physical phenomena, such as compressible flow through a nozzle. This final practice guides you in bridging mathematical theory with computational implementation, a core competency in CFD. You will derive the characteristic-based ordinary differential equation for the Mach number in a variable-area duct and then develop a numerical marching scheme to compute the supersonic flow field, solidifying your understanding of how MOC is applied to solve practical engineering problems [@problem_id:3376542].", "problem": "You are asked to write a complete, runnable program that computes the supersonic portion of a quasi-one-dimensional, isentropic compressible flow by stepping downstream using the Method of Characteristics (MOC) compatibility relations adjusted by the nozzle-area source term. The flow is governed by the one-dimensional compressible Euler equations for a perfect gas with ratio of specific heats $\\gamma$, under the quasi-one-dimensional area-variation model, assuming isentropic, inviscid, adiabatic conditions and no body forces. The fundamental starting point is:\n- Conservation of mass, momentum, and energy for a perfect gas, with cross-sectional area $A(x)$ varying smoothly with axial coordinate $x$.\n- Equation of state $p = \\rho R T$ and speed of sound $a^2 = \\gamma p/\\rho$.\n- Isentropic relation $p \\propto \\rho^\\gamma$ and Mach number definition $M = u/a$.\n\nFrom the unsteady quasi-one-dimensional equations,\n$$\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} + \\frac{\\rho u}{A}\\frac{dA}{dx} = 0,$$\n$$\\frac{\\partial u}{\\partial t} + u\\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} = 0,$$\n$$\\frac{\\partial p}{\\partial t} + u\\frac{\\partial p}{\\partial x} + \\rho a^2\\left(\\frac{\\partial u}{\\partial x} + \\frac{u}{A}\\frac{dA}{dx}\\right) = 0,$$\nderive the characteristic compatibility relations along the families $dx/dt = u \\pm a$ in the presence of the quasi-one-dimensional source term, and reduce them to the steady hyperbolic regime for supersonic flow. Then, starting only from the above fundamental equations and definitions, further reduce the steady problem to an ordinary differential equation for the Mach number $M(x)$ that incorporates the area-source effect. Your program must implement a stable downstream stepping method based on this compatibility-derived $M(x)$ ordinary differential equation to compute the supersonic branch, using the correct supersonic initial condition selected from the isentropic area–Mach relation at a small positive $x$ near the sonic throat.\n\nAlgorithmic requirements:\n- Use the compatibility relations to derive an ordinary differential equation for $M(x)$ valid for steady supersonic flow with area variation $A(x)$. The equation must contain the source term from $dA/dx$.\n- Initialize at $x = x_0$ with $x_0 > 0$ very small, just downstream of the sonic throat at $x = 0$ where $A(0) = A^\\star$. Use the algebraic isentropic area–Mach relation to select the supersonic root for $M(x_0)$ given the area ratio $A(x_0)/A^\\star$.\n- March downstream using a numerically stable explicit integrator of your choice (for example, a fourth-order Runge–Kutta method) to obtain $M(x)$ at requested locations.\n- Where needed, compute static-to-stagnation pressure ratio $p/p_0$ and static temperature $T$ using isentropic perfect-gas relations:\n  $$\\frac{p}{p_0} = \\left(1 + \\frac{\\gamma - 1}{2} M^2\\right)^{-\\frac{\\gamma}{\\gamma - 1}}, \\quad \\frac{T}{T_0} = \\left(1 + \\frac{\\gamma - 1}{2} M^2\\right)^{-1}.$$\n\nUnits and outputs:\n- The Mach number $M$ is dimensionless.\n- The stagnation pressure $p_0$ must be expressed in pascal (SI unit), and static temperature $T$ must be expressed in kelvin.\n- When an output requires a temperature, express it in kelvin; when an output requires a pressure ratio, express it as a dimensionless decimal without a percentage sign. The final numerical outputs should be rounded as specified below.\n\nTest suite and required outputs:\nImplement your program to evaluate the following five independent parameter sets. For each set, compute the requested quantity or quantities. The area $A(x)$ is in square meters and $x$ is in meters. In all cases, take $A^\\star = A(0)$; your code must infer $A^\\star$ directly from the given $A(x)$ function.\n\n- Test A (happy path, moderate divergence):\n  - Parameters: $\\gamma = 1.4$, $R = 287$, $p_0 = 100000$, $T_0 = 300$, $A(x) = 1 + 0.2 x^2$.\n  - Targets: $x = 0.25$ and $x = 0.75$.\n  - Outputs: $M(0.25)$ and $M(0.75)$, both dimensionless, each rounded to six decimal places.\n\n- Test B (stronger divergence, quartic term):\n  - Parameters: $\\gamma = 1.4$, $R = 287$, $p_0 = 100000$, $T_0 = 300$, $A(x) = 1 + 0.4 x^2 + 0.02 x^4$.\n  - Target: $x = 1.0$.\n  - Output: $M(1.0)$, dimensionless, rounded to six decimal places.\n\n- Test C (different gas, pressure ratio check):\n  - Parameters: $\\gamma = 1.67$, $R = 2077$, $p_0 = 250000$, $T_0 = 300$, $A(x) = 1 + 0.2 x^2$.\n  - Target: $x = 1.0$.\n  - Output: $p/p_0$ at $x = 1.0$, dimensionless, rounded to six decimal places.\n\n- Test D (slow divergence, long duct):\n  - Parameters: $\\gamma = 1.3$, $R = 287$, $p_0 = 200000$, $T_0 = 400$, $A(x) = 1 + 0.02 x^2$.\n  - Target: $x = 5.0$.\n  - Output: $M(5.0)$, dimensionless, rounded to six decimal places.\n\n- Test E (static temperature from stagnation temperature):\n  - Parameters: $\\gamma = 1.4$, $R = 287$, $p_0 = 100000$, $T_0 = 300$, $A(x) = 1 + 0.2 x^2$.\n  - Target: $x = 1.0$.\n  - Output: $T(1.0)$ in kelvin, rounded to three decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n$$[M_A(0.25), M_A(0.75), M_B(1.0), (p/p_0)_C(1.0), M_D(5.0), T_E(1.0)].$$\n\nFor example, your program must print a single line of the form\n$$[1.234567,1.345678,1.456789,0.234567,1.567890,205.123].$$", "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of compressible fluid dynamics, specifically quasi-one-dimensional isentropic flow. The problem is well-posed, providing a complete and consistent set of governing equations, boundary conditions, and parameters, which allows for the existence of a unique and stable solution. All terms are objectively and precisely defined.\n\nThe task is to compute properties of a supersonic flow in a diverging nozzle. This requires the derivation of an ordinary differential equation (ODE) for the Mach number $M$ as a function of the axial coordinate $x$, followed by numerical integration. The derivation proceeds from the steady, quasi-one-dimensional Euler equations, which are a reduction of the provided unsteady equations under the steady-state assumption ($\\partial/\\partial t = 0$).\n\nThe governing equations for steady, inviscid, isentropic, quasi-one-dimensional flow of a perfect gas are:\n1.  **Continuity Equation:**\n    $$ \\frac{d}{dx}(\\rho u A) = 0 $$\n    In differential form, this is:\n    $$ \\frac{1}{\\rho}\\frac{d\\rho}{dx} + \\frac{1}{u}\\frac{du}{dx} + \\frac{1}{A}\\frac{dA}{dx} = 0 $$\n\n2.  **Momentum Equation (Euler's Equation):**\n    $$ \\rho u \\frac{du}{dx} + \\frac{dp}{dx} = 0 $$\n\n3.  **Isentropic Relations:** The flow is isentropic, thus stagnation properties are constant. The change in pressure $p$ and density $\\rho$ are related through the square of the speed of sound, $a^2$:\n    $$ dp = a^2 d\\rho \\implies \\frac{dp}{dx} = a^2 \\frac{d\\rho}{dx} $$\n\nFrom the momentum equation, we express $\\frac{dp}{dx}$ as $-\\rho u \\frac{du}{dx}$. Substituting this into the isentropic relation gives:\n$$ -\\rho u \\frac{du}{dx} = a^2 \\frac{d\\rho}{dx} \\implies \\frac{1}{\\rho}\\frac{d\\rho}{dx} = -\\frac{u}{a^2}\\frac{du}{dx} $$\nRecalling the definition of the Mach number, $M = u/a$, this simplifies to:\n$$ \\frac{1}{\\rho}\\frac{d\\rho}{dx} = -M^2 \\frac{1}{u}\\frac{du}{dx} $$\nSubstituting this expression for the density gradient back into the differential form of the continuity equation yields:\n$$ -M^2 \\frac{1}{u}\\frac{du}{dx} + \\frac{1}{u}\\frac{du}{dx} + \\frac{1}{A}\\frac{dA}{dx} = 0 $$\n$$ (1-M^2)\\frac{1}{u}\\frac{du}{dx} = -\\frac{1}{A}\\frac{dA}{dx} $$\nThis relation, often called the area-velocity relation, can be rearranged to express the velocity gradient:\n$$ \\frac{du}{dx} = \\frac{u}{M^2-1} \\frac{1}{A}\\frac{dA}{dx} $$\n\nTo obtain an ODE for the Mach number $M(x)$, we differentiate the definition $M = u/a$:\n$$ \\frac{dM}{dx} = \\frac{1}{a}\\frac{du}{dx} - \\frac{u}{a^2}\\frac{da}{dx} = \\frac{M}{u}\\frac{du}{dx} - \\frac{M}{a}\\frac{da}{dx} $$\nFor an isentropic flow of a perfect gas, the stagnation temperature $T_0$ is constant. The local static temperature $T$ and speed of sound $a$ are related to $M$ and $T_0$ by:\n$$ \\frac{T}{T_0} = \\left(1 + \\frac{\\gamma-1}{2}M^2\\right)^{-1} \\quad \\text{and} \\quad a^2 = \\gamma R T $$\nFrom this, we find the relation between the speed of sound $a$ and the Mach number $M$:\n$$ a^2 = a_0^2 \\left(1 + \\frac{\\gamma-1}{2}M^2\\right)^{-1} $$\nwhere $a_0 = \\sqrt{\\gamma R T_0}$ is the stagnation speed of sound. Differentiating with respect to $x$:\n$$ 2a\\frac{da}{dx} = -a_0^2 \\left(1 + \\frac{\\gamma-1}{2}M^2\\right)^{-2} (\\gamma-1)M\\frac{dM}{dx} $$\nDividing by $2a^2$ gives the logarithmic derivative:\n$$ \\frac{1}{a}\\frac{da}{dx} = -\\frac{a_0^2}{2a^2}\\frac{(\\gamma-1)M}{ (1 + \\frac{\\gamma-1}{2}M^2)^2 } \\frac{dM}{dx} = -\\frac{1}{2} \\frac{(\\gamma-1)M}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{dx} $$\nSubstituting the expressions for $\\frac{du}{dx}$ and $\\frac{1}{a}\\frac{da}{dx}$ into the equation for $\\frac{dM}{dx}$:\n$$ \\frac{dM}{dx} = \\frac{M}{u} \\left( \\frac{u}{M^2-1} \\frac{1}{A}\\frac{dA}{dx} \\right) - M \\left( -\\frac{1}{2} \\frac{(\\gamma-1)M}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{dx} \\right) $$\n$$ \\frac{dM}{dx} = \\frac{M}{M^2-1} \\frac{1}{A}\\frac{dA}{dx} + \\frac{(\\gamma-1)M^2/2}{1 + (\\gamma-1)M^2/2} \\frac{dM}{dx} $$\nRearranging to solve for $\\frac{dM}{dx}$:\n$$ \\frac{dM}{dx} \\left( 1 - \\frac{(\\gamma-1)M^2/2}{1 + (\\gamma-1)M^2/2} \\right) = \\frac{M}{M^2-1} \\frac{1}{A}\\frac{dA}{dx} $$\n$$ \\frac{dM}{dx} \\left( \\frac{1 + \\frac{\\gamma-1}{2}M^2 - \\frac{\\gamma-1}{2}M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) = \\frac{M}{M^2-1} \\frac{1}{A}\\frac{dA}{dx} $$\nThis simplifies to the final ODE for the Mach number:\n$$ \\frac{dM}{dx} = \\frac{M\\left(1 + \\frac{\\gamma-1}{2}M^2\\right)}{M^2-1} \\frac{1}{A(x)}\\frac{dA(x)}{dx} $$\nThis ODE governs the evolution of the Mach number along the supersonic branch ($M>1$) of the nozzle. The term $\\frac{1}{A}\\frac{dA}{dx}$ acts as a source term driving the change in $M$. For a diverging nozzle ($dA/dx > 0$) and supersonic flow ($M>1$), $\\frac{dM}{dx} > 0$, indicating that the flow accelerates.\n\nThe numerical solution proceeds as follows:\n1.  **Initialization:** The integration cannot start at the throat $x=0$ where $M=1$, as the ODE is singular. We start at a small distance $x_0 > 0$ downstream of the throat. The initial Mach number $M(x_0)$ is determined from the isentropic area-Mach relation by finding the supersonic root ($M>1$) of the equation:\n    $$ \\left(\\frac{A(x_0)}{A^\\star}\\right)^2 = \\frac{1}{M^2}\\left[\\frac{2}{\\gamma+1}\\left(1 + \\frac{\\gamma-1}{2}M^2\\right)\\right]^{\\frac{\\gamma+1}{\\gamma-1}} $$\n    where $A^\\star = A(0)$. This transcendental equation is solved using a numerical root-finding algorithm.\n\n2.  **Integration:** The derived ODE is a first-order initial value problem. It is integrated numerically from $x_0$ to the desired target locations $x_{target}$ using a stable method. We employ the `solve_ivp` function from the SciPy library, which implements an adaptive Runge-Kutta method (RK45), ensuring both accuracy and stability.\n\n3.  **Output Calculation:** Once the Mach number $M$ is found at a target location, the required physical quantities are calculated using the standard isentropic relations:\n    $$ \\frac{p}{p_0} = \\left(1 + \\frac{\\gamma-1}{2}M^2\\right)^{-\\frac{\\gamma}{\\gamma-1}}, \\quad T = T_0 \\left(1 + \\frac{\\gamma-1}{2}M^2\\right)^{-1} $$\n    The stagnation pressure $p_0$ and gas constant $R$ are provided but are not necessary for computing the Mach number $M$, pressure ratio $p/p_0$, or static temperature $T$ given the stagnation temperature $T_0$. Their inclusion serves to specify a complete physical state but does not alter the required computations.\n\nThe following program implements this entire procedure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes supersonic quasi-1D isentropic flow properties by integrating\n    the Mach number ODE derived from the method of characteristics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test A: M(0.25)\n        {'gamma': 1.4, 'T0': 300, \n         'A_coeffs': {'c0': 1.0, 'c2': 0.2, 'c4': 0.0}, 'x_target': 0.25, \n         'output_type': 'M', 'precision': 6},\n        # Test A: M(0.75)\n        {'gamma': 1.4, 'T0': 300,\n         'A_coeffs': {'c0': 1.0, 'c2': 0.2, 'c4': 0.0}, 'x_target': 0.75, \n         'output_type': 'M', 'precision': 6},\n        # Test B: M(1.0)\n        {'gamma': 1.4, 'T0': 300,\n         'A_coeffs': {'c0': 1.0, 'c2': 0.4, 'c4': 0.02}, 'x_target': 1.0, \n         'output_type': 'M', 'precision': 6},\n        # Test C: p/p0(1.0)\n        {'gamma': 1.67, 'T0': 300,\n         'A_coeffs': {'c0': 1.0, 'c2': 0.2, 'c4': 0.0}, 'x_target': 1.0, \n         'output_type': 'p_ratio', 'precision': 6},\n        # Test D: M(5.0)\n        {'gamma': 1.3, 'T0': 400,\n         'A_coeffs': {'c0': 1.0, 'c2': 0.02, 'c4': 0.0}, 'x_target': 5.0, \n         'output_type': 'M', 'precision': 6},\n        # Test E: T(1.0)\n        {'gamma': 1.4, 'T0': 300,\n         'A_coeffs': {'c0': 1.0, 'c2': 0.2, 'c4': 0.0}, 'x_target': 1.0, \n         'output_type': 'T', 'precision': 3},\n    ]\n\n    results = []\n    \n    # Define a small offset from the throat to start integration\n    x0 = 1e-7\n\n    for case in test_cases:\n        gamma = case['gamma']\n        T0 = case['T0']\n        coeffs = case['A_coeffs']\n        x_target = case['x_target']\n\n        # Define area A(x) and its derivative dA/dx from coefficients\n        A = lambda x: coeffs['c0'] + coeffs['c2'] * x**2 + coeffs['c4'] * x**4\n        dA_dx = lambda x: 2 * coeffs['c2'] * x + 4 * coeffs['c4'] * x**3\n\n        # Step 1: Find the initial condition M(x0)\n        A_star = A(0.0)\n        A_ratio_at_x0 = A(x0) / A_star\n\n        # Define the implicit area-Mach relation function to find its root\n        # f(M) = (A/A*)^2 - (1/M^2) * [ ... ] = 0\n        def area_mach_func(M):\n            gm1 = gamma - 1\n            gp1 = gamma + 1\n            term1 = (A_ratio_at_x0)**2\n            term2 = (1 / M**2) * ((2 / gp1) * (1 + gm1 / 2 * M**2))**(gp1 / gm1)\n            return term1 - term2\n\n        # Find the supersonic root (M > 1) of the area-Mach relation\n        M0 = brentq(area_mach_func, 1.0 + 1e-10, 10.0)\n\n        # Step 2: Integrate the ODE for M(x)\n        # dM/dx = f(x, M)\n        def dMdx(x, M):\n            if M <= 1.0:\n                # This should not be reached in the supersonic case\n                return 0.0\n            \n            gm1 = gamma - 1\n            numerator = M * (1 + gm1 / 2 * M**2)\n            denominator = M**2 - 1\n            source_term = (1 / A(x)) * dA_dx(x)\n\n            return (numerator / denominator) * source_term\n\n        # Solve the Initial Value Problem using an adaptive method\n        sol = solve_ivp(\n            dMdx, \n            (x0, x_target), \n            [M0], \n            method='RK45', \n            dense_output=True, \n            rtol=1e-11, \n            atol=1e-13\n        )\n        M_final = sol.sol(x_target)[0]\n\n        # Step 3: Calculate the required output based on the final Mach number\n        output_type = case['output_type']\n        precision = case['precision']\n        \n        if output_type == 'M':\n            result_val = round(M_final, precision)\n        elif output_type == 'p_ratio':\n            gm1 = gamma - 1\n            p_ratio = (1 + gm1 / 2 * M_final**2)**(-gamma / gm1)\n            result_val = round(p_ratio, precision)\n        elif output_type == 'T':\n            gm1 = gamma - 1\n            T_final = T0 * (1 + gm1 / 2 * M_final**2)**(-1)\n            result_val = round(T_final, precision)\n        \n        results.append(f\"{result_val:.{precision}f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3376542"}]}