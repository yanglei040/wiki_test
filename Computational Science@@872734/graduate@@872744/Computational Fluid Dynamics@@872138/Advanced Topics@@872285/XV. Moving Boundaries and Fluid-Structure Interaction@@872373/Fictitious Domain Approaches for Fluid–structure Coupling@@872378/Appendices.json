{"hands_on_practices": [{"introduction": "A core challenge in fictitious domain methods is the enforcement of constraints, often achieved through penalty forces. This exercise explores how such a penalty, when coupled with an explicit time integration scheme, impacts numerical stability. By analyzing a simplified one-dimensional model, you will uncover a fundamental trade-off: stronger penalties enforce the constraint more accurately but introduce numerical stiffness, which can severely restrict the maximum stable time step ([@problem_id:3317734]). Understanding this relationship is crucial for designing and implementing stable and efficient FSI simulations.", "problem": "Consider a one-dimensional linearized model of fluid–structure interaction treated by a fictitious domain approach, where the fluid occupies a channel and a rigid structure imposes an interface displacement $u_{s}(t)$ at the boundary. The fictitious domain method enforces the interface kinematic constraint by a penalty force of the form $f_{\\Gamma} = \\gamma \\left(u_{s}(t) - u_{f}(t)\\right)$, with $\\gamma > 0$ the penalty parameter and $u_{f}(t)$ the fluid-side interface displacement. Assume that the fluid discretization and spatial elimination of bulk degrees of freedom lead to an effective interface inertia described by an interface added mass $M_{a} > 0$, so that the interface dynamics are governed by Newton’s second law,\n$$\nM_{a}\\,\\ddot{u}_{f}(t) = f_{\\Gamma}(t) .\n$$\nIn a partitioned time-stepping algorithm, the constraint is lagged by one step: the fluid solver at time $t^{n+1}$ uses the structure’s interface displacement $u_{s}^{n}$ from the previous time level $t^{n}$ to compute the penalty force. The fluid-side interface displacement $u_{f}(t)$ is advanced in time using the explicit central-difference scheme with a uniform time step $\\Delta t > 0$.\n\nAssume small perturbations about a steady state with $u_{s}(t)$ constant, and analyze the linear homogeneous dynamics relevant for stability. Starting from Newton’s second law and the explicit central-difference time discretization, derive a discrete amplification relation and use it to obtain a rigorous upper bound on the time step $\\Delta t$ that ensures linear stability of the lagged, partitioned coupling in terms of the interface added mass $M_{a}$ and the penalty parameter $\\gamma$. Your final answer must be a single closed-form analytic expression for the largest admissible time step, and you must express it in seconds. No rounding is required; provide the exact expression.", "solution": "The problem requires the derivation of the stability limit for a partitioned, lagged numerical scheme used to solve a one-dimensional fluid-structure interaction problem modeled via a fictitious domain approach.\n\nThe governing equation for the fluid-side interface displacement, $u_f(t)$, is given by Newton's second law with an interface added mass $M_a$:\n$$\nM_{a}\\,\\ddot{u}_{f}(t) = f_{\\Gamma}(t)\n$$\nThe penalty force $f_{\\Gamma}(t)$ enforces the kinematic constraint at the interface and is defined as:\n$$\nf_{\\Gamma}(t) = \\gamma \\left(u_{s}(t) - u_{f}(t)\\right)\n$$\nwhere $u_s(t)$ is the structural displacement, and $\\gamma > 0$ is the penalty parameter.\n\nFor the purpose of linear stability analysis, we consider small perturbations about a steady state where $u_s(t)$ is constant. Let the steady-state displacements be $U_s$ and $U_f$. In a steady state, $\\ddot{u}_f(t) = 0$, which implies $f_{\\Gamma} = 0$, so $U_s = U_f$. We analyze the dynamics of a small perturbation $\\delta u_f(t)$ around this steady state, so $u_f(t) = U_f + \\delta u_f(t)$. The structural displacement is held constant, so $u_s(t) = U_s$. Substituting these into the governing equation yields:\n$$\nM_{a}\\,\\frac{d^2}{dt^2}(U_f + \\delta u_f(t)) = \\gamma \\left(U_s - (U_f + \\delta u_f(t))\\right)\n$$\nSince $U_f$ and $U_s$ are constants and $U_s = U_f$, the equation for the perturbation $\\delta u_f(t)$ simplifies to the homogeneous form. For notational simplicity, we will denote the perturbation $\\delta u_f(t)$ as $u_f(t)$:\n$$\nM_{a}\\,\\ddot{u}_{f}(t) = -\\gamma u_{f}(t)\n$$\nThis is the equation of a simple harmonic oscillator with angular frequency $\\omega = \\sqrt{\\gamma / M_a}$.\n\nThe problem specifies that this equation is discretized in time using the explicit central-difference scheme with a uniform time step $\\Delta t$. The second time derivative at time $t^n = n \\Delta t$ is approximated as:\n$$\n\\ddot{u}_{f}(t^n) \\approx \\frac{u_f^{n+1} - 2u_f^n + u_f^{n-1}}{(\\Delta t)^2}\n$$\nwhere $u_f^n$ denotes the value of $u_f$ at time step $n$. The problem states that the coupling is lagged such that the force term is evaluated at time $t^n$ to compute the state at $t^{n+1}$. For the homogeneous equation, the discrete system is:\n$$\nM_a \\left(\\frac{u_f^{n+1} - 2u_f^n + u_f^{n-1}}{(\\Delta t)^2}\\right) = -\\gamma u_f^n\n$$\nThis is a linear, constant-coefficient difference equation. To analyze its stability, we seek a solution of the form $u_f^n = G^n$, where $G$ is the complex amplification factor. Substituting this ansatz into the difference equation gives:\n$$\nM_a \\left(\\frac{G^{n+1} - 2G^n + G^{n-1}}{(\\Delta t)^2}\\right) = -\\gamma G^n\n$$\nDividing by $G^{n-1}$ (for non-trivial solutions where $G \\neq 0$):\n$$\nM_a \\left(\\frac{G^2 - 2G + 1}{(\\Delta t)^2}\\right) = -\\gamma G\n$$\nThis equation is the discrete amplification relation. We rearrange it into a quadratic characteristic equation for the amplification factor $G$:\n$$\nM_a (G^2 - 2G + 1) = -\\gamma (\\Delta t)^2 G\n$$\n$$\nM_a G^2 - 2M_a G + M_a = -\\gamma (\\Delta t)^2 G\n$$\n$$\nM_a G^2 + \\left(\\gamma (\\Delta t)^2 - 2M_a\\right) G + M_a = 0\n$$\nFor the numerical scheme to be stable, the magnitudes of the roots $G$ of this quadratic equation must not exceed $1$. That is, we require $|G| \\le 1$. Let us solve for $G$:\n$$\nG = \\frac{-\\left(\\gamma (\\Delta t)^2 - 2M_a\\right) \\pm \\sqrt{\\left(\\gamma (\\Delta t)^2 - 2M_a\\right)^2 - 4(M_a)(M_a)}}{2M_a}\n$$\n$$\nG = \\frac{2M_a - \\gamma (\\Delta t)^2 \\pm \\sqrt{\\left(\\gamma (\\Delta t)^2\\right)^2 - 4M_a \\gamma (\\Delta t)^2 + 4M_a^2 - 4M_a^2}}{2M_a}\n$$\n$$\nG = \\frac{2M_a - \\gamma (\\Delta t)^2 \\pm \\sqrt{\\left(\\gamma (\\Delta t)^2\\right)^2 - 4M_a \\gamma (\\Delta t)^2}}{2M_a}\n$$\n$$\nG = \\frac{2M_a - \\gamma (\\Delta t)^2 \\pm \\sqrt{\\gamma (\\Delta t)^2 \\left(\\gamma (\\Delta t)^2 - 4M_a\\right)}}{2M_a}\n$$\nThe nature of the roots depends on the sign of the discriminant, $\\Delta_d = \\gamma (\\Delta t)^2 (\\gamma (\\Delta t)^2 - 4M_a)$. Since $\\gamma > 0$, $(\\Delta t)^2 > 0$, the sign is determined by the term $(\\gamma (\\Delta t)^2 - 4M_a)$.\n\nCase 1: $\\gamma (\\Delta t)^2 - 4M_a > 0$.\nIn this case, $\\Delta_d > 0$, and the roots $G_1, G_2$ are real and distinct. From the characteristic polynomial $M_a G^2 + \\dots + M_a = 0$, the product of the roots is $G_1 G_2 = M_a / M_a = 1$. If the roots are real and their product is $1$, one root must have a magnitude greater than $1$ (unless both are $1$ or both are $-1$, which is not the case here as they are distinct). Therefore, the scheme is unstable. This case corresponds to $(\\Delta t)^2 > 4M_a / \\gamma$.\n\nCase 2: $\\gamma (\\Delta t)^2 - 4M_a = 0$.\nIn this case, $\\Delta_d = 0$, and there is a repeated real root. This corresponds to the stability boundary.\n$$\n\\gamma (\\Delta t)^2 = 4M_a\n$$\nThe root is $G = \\frac{2M_a - \\gamma (\\Delta t)^2}{2M_a} = \\frac{2M_a - 4M_a}{2M_a} = \\frac{-2M_a}{2M_a} = -1$.\nSince $|G|=1$, the scheme is on the boundary of stability.\n\nCase 3: $\\gamma (\\Delta t)^2 - 4M_a < 0$.\nIn this case, $\\Delta_d < 0$, and the roots are a complex conjugate pair.\n$$\nG = \\frac{2M_a - \\gamma (\\Delta t)^2 \\pm i \\sqrt{\\gamma (\\Delta t)^2 \\left(4M_a - \\gamma (\\Delta t)^2\\right)}}{2M_a}\n$$\nThe magnitude of the complex roots is given by $|G|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2$.\n$$\n|G|^2 = \\left(\\frac{2M_a - \\gamma (\\Delta t)^2}{2M_a}\\right)^2 + \\frac{\\gamma (\\Delta t)^2 \\left(4M_a - \\gamma (\\Delta t)^2\\right)}{(2M_a)^2}\n$$\n$$\n|G|^2 = \\frac{4M_a^2 - 4M_a\\gamma(\\Delta t)^2 + (\\gamma(\\Delta t)^2)^2 + 4M_a\\gamma(\\Delta t)^2 - (\\gamma(\\Delta t)^2)^2}{4M_a^2}\n$$\n$$\n|G|^2 = \\frac{4M_a^2}{4M_a^2} = 1\n$$\nIn this case, $|G|=1$, which means the numerical solution has a constant amplitude, representing a neutrally stable behavior. This is acceptable for a non-dissipative scheme. This case corresponds to $(\\Delta t)^2 < 4M_a / \\gamma$.\n\nCombining the cases, the condition for linear stability ($|G| \\le 1$) is satisfied if $\\gamma (\\Delta t)^2 - 4M_a \\le 0$.\n$$\n\\gamma (\\Delta t)^2 \\le 4M_a\n$$\nSince $\\Delta t > 0$, we can solve for the time step:\n$$\n(\\Delta t)^2 \\le \\frac{4M_a}{\\gamma}\n$$\n$$\n\\Delta t \\le \\sqrt{\\frac{4M_a}{\\gamma}}\n$$\n$$\n\\Delta t \\le 2\\sqrt{\\frac{M_a}{\\gamma}}\n$$\nThe largest admissible time step, or the critical time step for stability, is the upper bound of this inequality. The units of $\\sqrt{M_a/\\gamma}$ are $\\sqrt{\\text{kg} / (\\text{N}/\\text{m})} = \\sqrt{\\text{kg} / (\\text{kg}\\cdot\\text{s}^{-2})} = \\sqrt{\\text{s}^2} = \\text{s}$, which is seconds, as requested.\nThe result is $\\Delta t_{\\text{max}} = 2\\sqrt{\\frac{M_a}{\\gamma}}$.", "answer": "$$\\boxed{2\\sqrt{\\frac{M_a}{\\gamma}}}$$", "id": "3317734"}, {"introduction": "Fluid-structure interaction problems often involve disparate time scales, making monolithic time-stepping schemes inefficient. This practice investigates a common and practical solution: structural subcycling within a partitioned, operator-split framework. You will analyze the stability of a scheme that combines an implicit fluid update with explicit structural sub-steps for a Brinkman penalization model ([@problem_id:3317711]). This analysis demonstrates how to ensure the stability of a coupled system, yielding a time step constraint that depends on both the penalization parameter and the chosen subcycling strategy.", "problem": "Consider a fluid–structure interaction in the fictitious domain framework in Computational Fluid Dynamics (CFD), where the fluid velocity field $u$ is coupled to a structure velocity field $v$ through a Brinkman penalization term. In the solid subdomain (characteristic function $\\chi=1$) and for the highest-wavenumber mode that dominates stability, neglect advection and diffusion and model the coupling by the linear momentum exchange\n$$\n\\rho_{f} \\frac{d u}{d t} \\;=\\; -\\alpha \\left(u - v\\right), \\qquad \\rho_{s} \\frac{d v}{d t} \\;=\\; \\alpha \\left(u - v\\right),\n$$\nwhere $\\rho_{f}>0$ is the fluid density, $\\rho_{s}>0$ is the solid density, and $\\alpha>0$ is the Brinkman penalization coefficient imposing near no-slip $u\\approx v$ in the solid region.\n\nYou are to incorporate structural subcycling into a first-order operator-split time integrator over one fluid time step $ \\Delta t > 0 $ as follows:\n- The structure is advanced over $m \\in \\mathbb{N}$ substeps of size $\\Delta t_{s} = \\Delta t/m$ using explicit Euler with the fluid velocity held fixed at its known value at the beginning of the fluid step, $u^{n}$.\n- After completing the $m$ structural substeps to obtain $v^{n+1}$, the fluid velocity is advanced over $\\Delta t$ using backward Euler for the penalization term, with $v^{n+1}$ treated as known.\n\nStarting from these definitions and the fundamental balance laws above, derive the one-step amplification factor for the velocity mismatch $w := u - v$ and use it to establish conditions on $\\alpha$, $\\Delta t$, and $m$ that guarantee linear stability and first-order accuracy of the coupled update. Then, determine the largest fluid time step $\\Delta t_{\\max}$ such that the coupled update is linearly stable for any initial mismatch $w^{n}$.\n\nProvide your final answer as the closed-form expression for $\\Delta t_{\\max}$ in terms of $\\alpha$, $\\rho_{s}$, and $m$. Express $\\Delta t_{\\max}$ in seconds. No numerical substitution is required, and no rounding is needed. The derivation must proceed from the stated laws and the specified subcycling scheme without invoking unstated formulas.", "solution": "We begin from the linear momentum exchange model in the solid region,\n$$\n\\rho_{f} \\frac{d u}{d t} \\;=\\; -\\alpha \\left(u - v\\right), \\qquad \\rho_{s} \\frac{d v}{d t} \\;=\\; \\alpha \\left(u - v\\right),\n$$\nwhich expresses the Brinkman penalization force $-\\alpha (u - v)$ on the fluid and the equal and opposite force $+\\alpha (u - v)$ on the structure. For stability analysis, it is sufficient to consider the evolution of the velocity mismatch\n$$\nw(t) \\;:=\\; u(t) - v(t).\n$$\nDifferentiating and using the governing equations, the continuous-time mismatch dynamics is\n$$\n\\frac{d w}{d t} \\;=\\; \\frac{d u}{d t} - \\frac{d v}{d t} \\;=\\; -\\frac{\\alpha}{\\rho_{f}} \\left(u - v\\right) - \\frac{\\alpha}{\\rho_{s}} \\left(u - v\\right) \\;=\\; -\\alpha \\left(\\frac{1}{\\rho_{f}} + \\frac{1}{\\rho_{s}}\\right) w.\n$$\nThus, the exact continuous-time decay over one fluid time step $\\Delta t$ is\n$$\nw(t^{n} + \\Delta t) \\;=\\; \\exp\\!\\left[-\\alpha \\left(\\frac{1}{\\rho_{f}} + \\frac{1}{\\rho_{s}}\\right) \\Delta t \\right] w(t^{n}).\n$$\nWe now incorporate the specified structural subcycling and fluid update.\n\nStructural subcycling over $m$ explicit Euler substeps with the fluid velocity held fixed at $u^{n}$ uses the discrete update\n$$\nv^{n,(k+1)} \\;=\\; v^{n,(k)} + \\Delta t_{s} \\,\\frac{\\alpha}{\\rho_{s}} \\left(u^{n} - v^{n,(k)}\\right), \\qquad k=0,1,\\dots,m-1,\n$$\nwhere $v^{n,(0)} = v^{n}$ is the initial structure velocity at the beginning of the fluid step, and $v^{n,(m)} = v^{n+1}$ is the structure velocity at the end of subcycling. This can be rewritten as\n$$\nv^{n,(k+1)} - u^{n} \\;=\\; \\left(1 - \\beta\\right) \\left(v^{n,(k)} - u^{n}\\right), \\qquad \\beta \\;:=\\; \\frac{\\alpha}{\\rho_{s}} \\Delta t_{s} \\;=\\; \\frac{\\alpha}{\\rho_{s}} \\frac{\\Delta t}{m}.\n$$\nIterating $m$ times gives\n$$\nv^{n+1} \\;=\\; u^{n} + \\left(v^{n} - u^{n}\\right) s, \\qquad s \\;:=\\; \\left(1 - \\beta\\right)^{m}.\n$$\nNext, the fluid is advanced over $\\Delta t$ using backward Euler for the penalization, with $v^{n+1}$ treated as known:\n$$\n\\rho_{f} \\frac{u^{n+1} - u^{n}}{\\Delta t} \\;=\\; -\\alpha \\left(u^{n+1} - v^{n+1}\\right).\n$$\nSolving for $u^{n+1}$ yields\n$$\nu^{n+1} \\;=\\; \\frac{\\rho_{f}}{\\rho_{f} + \\alpha \\Delta t} \\, u^{n} + \\frac{\\alpha \\Delta t}{\\rho_{f} + \\alpha \\Delta t} \\, v^{n+1}.\n$$\nDefine the fluid implicit factor\n$$\n\\gamma \\;:=\\; \\frac{\\rho_{f}}{\\rho_{f} + \\alpha \\Delta t}, \\qquad \\delta \\;:=\\; \\frac{\\alpha \\Delta t}{\\rho_{f} + \\alpha \\Delta t} \\;=\\; 1 - \\gamma.\n$$\nThe one-step mismatch update can now be derived:\n\n$$\n\\begin{aligned}\nw^{n+1} \\;&=\\; u^{n+1} - v^{n+1} \\;=\\; \\gamma u^{n} + \\delta v^{n+1} - v^{n+1} \\\\\n&=\\; \\gamma u^{n} - (1 - \\delta) v^{n+1} \\;=\\; \\gamma \\left(u^{n} - v^{n+1}\\right) \\\\\n&=\\; \\gamma \\left(u^{n} - \\left[s v^{n} + (1 - s) u^{n}\\right]\\right) \\\\\n&=\\; \\gamma \\left(s u^{n} - s v^{n}\\right) \\;=\\; \\gamma s \\left(u^{n} - v^{n}\\right) \\;=\\; \\lambda_{w} \\, w^{n},\n\\end{aligned}\n$$\n\nwith the mismatch amplification factor\n$$\n\\lambda_{w} \\;=\\; \\gamma s \\;=\\; \\frac{\\rho_{f}}{\\rho_{f} + \\alpha \\Delta t} \\left(1 - \\frac{\\alpha \\Delta t}{\\rho_{s} m}\\right)^{m}.\n$$\n\nStability condition. Linear stability of the mismatch dynamics requires $|\\lambda_{w}| \\leq 1$ for any initial $w^{n}$. Since $\\gamma \\in (0,1)$ for $\\alpha>0$ and $\\Delta t>0$, stability is controlled by the explicit structural factor $s$. The explicit Euler substep for the linear relaxation $dv/dt = (\\alpha/\\rho_{s})(u^{n} - v)$ is stable if and only if\n$$\n\\left|1 - \\beta\\right| \\;\\leq\\; 1 \\quad \\Longleftrightarrow \\quad 0 \\;\\leq\\; \\beta \\;\\leq\\; 2,\n$$\nwhich ensures $|s| = |1 - \\beta|^{m} \\leq 1$ and hence $|\\lambda_{w}| \\leq 1$. In terms of the original parameters,\n$$\n0 \\;\\leq\\; \\frac{\\alpha}{\\rho_{s}} \\frac{\\Delta t}{m} \\;\\leq\\; 2 \\quad \\Longleftrightarrow \\quad \\Delta t \\;\\leq\\; \\frac{2 \\rho_{s} m}{\\alpha}.\n$$\nTherefore, the largest fluid time step that preserves linear stability of the coupled update is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2 \\rho_{s} m}{\\alpha}.\n$$\n\nAccuracy condition. The exact continuous-time mismatch decay over $\\Delta t$ is\n$$\nw^{n+1,\\mathrm{exact}} \\;=\\; \\exp\\!\\left[-\\alpha \\left(\\frac{1}{\\rho_{f}} + \\frac{1}{\\rho_{s}}\\right) \\Delta t \\right] w^{n}.\n$$\nThe discrete mismatch factor is $\\lambda_{w} = \\gamma s$. For small $\\Delta t$,\n\n$$\n\\gamma \\;=\\; \\frac{1}{1 + \\frac{\\alpha \\Delta t}{\\rho_{f}}} \\;=\\; 1 - \\frac{\\alpha \\Delta t}{\\rho_{f}} + \\mathcal{O}(\\Delta t^{2}),\n$$\n\nand, using $s = \\left(1 - \\frac{\\alpha \\Delta t}{\\rho_{s} m}\\right)^{m}$,\n\n$$\ns \\;=\\; 1 - \\frac{\\alpha \\Delta t}{\\rho_{s}} + \\mathcal{O}(\\Delta t^{2}).\n$$\n\nThus,\n\n$$\n\\lambda_{w} \\;=\\; \\left(1 - \\frac{\\alpha \\Delta t}{\\rho_{f}} + \\mathcal{O}(\\Delta t^{2})\\right) \\left(1 - \\frac{\\alpha \\Delta t}{\\rho_{s}} + \\mathcal{O}(\\Delta t^{2})\\right) \\;=\\; 1 - \\alpha \\left(\\frac{1}{\\rho_{f}} + \\frac{1}{\\rho_{s}}\\right) \\Delta t + \\mathcal{O}(\\Delta t^{2}).\n$$\n\nThis matches the first-order term of the exact exponential decay, establishing first-order accuracy in time for any $m \\in \\mathbb{N}$. To reduce the leading $\\mathcal{O}(\\Delta t^{2})$ error in $s$ from structural subcycling, increasing $m$ decreases the discrepancy of $s$ from the exact $\\exp\\!\\left[-\\frac{\\alpha}{\\rho_{s}} \\Delta t\\right]$, because\n\n$$\ns \\;=\\; \\exp\\!\\left[-\\frac{\\alpha}{\\rho_{s}} \\Delta t - \\frac{1}{2 m} \\left(\\frac{\\alpha}{\\rho_{s}} \\Delta t\\right)^{2} + \\mathcal{O}\\!\\left(\\frac{\\Delta t^{3}}{m^{2}}\\right)\\right].\n$$\n\nIn summary:\n- Stability requires $0 \\leq \\frac{\\alpha \\Delta t}{\\rho_{s} m} \\leq 2$, hence $\\Delta t \\leq \\frac{2 \\rho_{s} m}{\\alpha}$.\n- Accuracy to first order is satisfied for any $m$, with reduced second-order error for larger $m$.\n\nTherefore, the largest fluid time step ensuring linear stability of the subcycled Brinkman penalization update is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2 \\rho_{s} m}{\\alpha}.\n$$", "answer": "$$\\boxed{\\frac{2 \\rho_{s} m}{\\alpha}}$$", "id": "3317711"}, {"introduction": "Integrating fictitious domain methods into projection-based solvers for incompressible flow introduces unique challenges for the pressure update step. The constraint forces, such as those from a Distributed Lagrange Multiplier, manifest as a new source term in the pressure Poisson equation, which can violate its mathematical solvability condition. In this final practice, you will use the divergence theorem to derive a precise correction to the boundary conditions that restores the well-posedness of the pressure problem ([@problem_id:3317741]). Mastering this concept is essential for preventing solver failure and suppressing spurious pressure modes in practical CFD implementations.", "problem": "Consider an incompressible flow advanced using a projection method in the Computational Fluid Dynamics (CFD) sense where the pressure increment field $\\,\\phi\\,$ is obtained from a Poisson problem to enforce $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$. In a fictitious domain approach for fluid–structure coupling, a rigid circular inclusion is embedded and the rigid motion constraint is enforced by a Distributed Lagrange Multiplier (DLM) field.\n\nLet $\\,\\Omega = [0,1] \\times [0,1]\\,$ be the nondimensional fluid domain, and let the fictitious rigid body be the closed disk $\\,B = \\{(x,y)\\in\\Omega : (x - \\tfrac{1}{2})^{2} + (y - \\tfrac{1}{2})^{2} \\le r_{0}^{2}\\}\\,$ with $\\,r_{0} = \\tfrac{1}{4}\\,$. The DLM field $\\,\\boldsymbol{\\lambda}(\\boldsymbol{x})\\,$ is supported on $\\,B\\,$ and is taken to be the radially oriented field\n$$\n\\boldsymbol{\\lambda}(\\boldsymbol{x}) = \\alpha \\, r \\, \\boldsymbol{e}_{r} \\quad \\text{for } \\boldsymbol{x} \\in B, \\qquad \\boldsymbol{\\lambda}(\\boldsymbol{x}) = \\boldsymbol{0} \\quad \\text{for } \\boldsymbol{x} \\in \\Omega \\setminus B,\n$$\nwhere $\\,\\alpha > 0\\,$ is a given nondimensional constant, $\\,r = \\sqrt{(x - \\tfrac{1}{2})^{2} + (y - \\tfrac{1}{2})^{2}}\\,$ is the radial coordinate relative to the disk center, and $\\,\\boldsymbol{e}_{r}\\,$ is the radial unit vector. The intermediate velocity $\\,\\boldsymbol{u}^{\\ast}(\\boldsymbol{x})\\,$ is smooth in $\\,\\Omega\\,$ and may be non-divergence-free due to time advancement and rigid-body coupling, but is otherwise arbitrary.\n\nThe pressure increment $\\,\\phi\\,$ is determined from the Poisson equation\n$$\n\\nabla^{2} \\phi \\;=\\; \\frac{1}{\\Delta t} \\, \\nabla \\cdot \\boldsymbol{u}^{\\ast} \\;+\\; \\nabla \\cdot \\big(\\chi_{B} \\, \\boldsymbol{\\lambda}\\big) \\quad \\text{in } \\Omega,\n$$\nwhere $\\,\\Delta t\\,$ is the nondimensional time step and $\\,\\chi_{B}\\,$ is the characteristic function of $\\,B\\,$. At the outer boundary $\\,\\partial \\Omega\\,$, the classical Neumann condition for the projection step would be $\\,\\partial \\phi / \\partial n = (1/\\Delta t) \\, \\boldsymbol{n} \\cdot \\boldsymbol{u}^{\\ast}\\,$, with $\\,\\boldsymbol{n}\\,$ the outward unit normal on $\\,\\partial \\Omega\\,$. However, in the fictitious-domain setting this generally violates the Neumann compatibility condition needed for solvability, and in collocated discretizations it can encourage pressure checkerboarding.\n\nTo regularize the problem and ensure solvability while suppressing checkerboarding at the continuous level by eliminating the flux inconsistency that seeds spurious null modes upon discretization, consider the modified Neumann boundary condition\n$$\n\\frac{\\partial \\phi}{\\partial n} \\;=\\; \\frac{1}{\\Delta t} \\, \\boldsymbol{n} \\cdot \\boldsymbol{u}^{\\ast} \\;+\\; \\delta \\quad \\text{on } \\partial \\Omega,\n$$\nwhere $\\,\\delta\\,$ is a spatially uniform scalar to be determined from first principles so that the Neumann Poisson problem satisfies the global compatibility condition exactly.\n\nUsing only fundamental laws and the divergence theorem, derive the value of $\\,\\delta\\,$ as a closed-form analytic expression in terms of $\\,\\alpha\\,$ and $\\,r_{0}\\,$ for the given $\\,\\boldsymbol{\\lambda}\\,$. You must treat all fields as sufficiently smooth for the required manipulations. Express your final answer for $\\,\\delta\\,$ in exact nondimensional form. No rounding is required. The answer must be a single closed-form analytic expression.", "solution": "The problem requires the derivation of a constant, $\\delta$, which ensures that a given Neumann-Poisson problem for the pressure increment, $\\phi$, is well-posed. The solvability of such a problem is governed by a global compatibility condition, which arises from the divergence theorem.\n\nThe Poisson equation for the pressure increment $\\phi$ is given as:\n$$\n\\nabla^{2} \\phi = \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{\\ast} + \\nabla \\cdot (\\chi_{B} \\boldsymbol{\\lambda}) \\quad \\text{in } \\Omega\n$$\nwith the modified Neumann boundary condition on the boundary $\\partial \\Omega$:\n$$\n\\frac{\\partial \\phi}{\\partial n} = \\frac{1}{\\Delta t} \\boldsymbol{n} \\cdot \\boldsymbol{u}^{\\ast} + \\delta \\quad \\text{on } \\partial \\Omega\n$$\n\nFor a general Poisson problem of the form $\\nabla^{2} \\psi = f$ in a domain $\\Omega$ with Neumann boundary conditions $\\frac{\\partial \\psi}{\\partial n} = g$ on $\\partial \\Omega$, a solution for $\\psi$ exists if and only if the following compatibility (or solvability) condition is satisfied:\n$$\n\\int_{\\Omega} f \\, dV = \\int_{\\partial \\Omega} g \\, dS\n$$\nThis condition ensures that the net source within the domain is balanced by the net flux across its boundary.\n\nWe apply this condition to the given problem. The source term in the domain is $f = \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{\\ast} + \\nabla \\cdot (\\chi_{B} \\boldsymbol{\\lambda})$. The boundary data is $g = \\frac{1}{\\Delta t} \\boldsymbol{n} \\cdot \\boldsymbol{u}^{\\ast} + \\delta$. Substituting these into the compatibility condition yields:\n$$\n\\int_{\\Omega} \\left( \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{\\ast} + \\nabla \\cdot (\\chi_{B} \\boldsymbol{\\lambda}) \\right) dV = \\int_{\\partial \\Omega} \\left( \\frac{1}{\\Delta t} \\boldsymbol{n} \\cdot \\boldsymbol{u}^{\\ast} + \\delta \\right) dS\n$$\nWe can separate the integrals on both sides:\n$$\n\\frac{1}{\\Delta t} \\int_{\\Omega} \\nabla \\cdot \\boldsymbol{u}^{\\ast} \\, dV + \\int_{\\Omega} \\nabla \\cdot (\\chi_{B} \\boldsymbol{\\lambda}) \\, dV = \\frac{1}{\\Delta t} \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot \\boldsymbol{u}^{\\ast} \\, dS + \\int_{\\partial \\Omega} \\delta \\, dS\n$$\nNow, we apply the divergence theorem to the volume integrals on the left-hand side. The divergence theorem states that for a vector field $\\boldsymbol{F}$ defined on $\\Omega$, $\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{F} \\, dV = \\int_{\\partial \\Omega} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, dS$.\n\nFor the first term involving $\\boldsymbol{u}^{\\ast}$, applying the theorem gives:\n$$\n\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{u}^{\\ast} \\, dV = \\int_{\\partial \\Omega} \\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n} \\, dS\n$$\nSubstituting this into our main equation results in:\n$$\n\\frac{1}{\\Delta t} \\int_{\\partial \\Omega} \\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n} \\, dS + \\int_{\\Omega} \\nabla \\cdot (\\chi_{B} \\boldsymbol{\\lambda}) \\, dV = \\frac{1}{\\Delta t} \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot \\boldsymbol{u}^{\\ast} \\, dS + \\int_{\\partial \\Omega} \\delta \\, dS\n$$\nThe terms involving $\\boldsymbol{u}^{\\ast}$ are identical on both sides and thus cancel out, simplifying the equation to:\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\chi_{B} \\boldsymbol{\\lambda}) \\, dV = \\int_{\\partial \\Omega} \\delta \\, dS\n$$\nTo evaluate the integral on the left, we note that the field $\\chi_{B} \\boldsymbol{\\lambda}$ is non-zero only within the disk $B$. Therefore, the integral over $\\Omega$ is equivalent to an integral over $B$. The field $\\boldsymbol{\\lambda}$ is defined to be smooth within $B$. We can apply the divergence theorem to the domain $B$:\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\chi_{B} \\boldsymbol{\\lambda}) \\, dV = \\int_{B} \\nabla \\cdot \\boldsymbol{\\lambda} \\, dV = \\int_{\\partial B} \\boldsymbol{\\lambda} \\cdot \\boldsymbol{n}_{B} \\, dS\n$$\nwhere $\\partial B$ is the boundary of the disk and $\\boldsymbol{n}_{B}$ is the outward-pointing unit normal on $\\partial B$.\n\nThus, our condition becomes:\n$$\n\\int_{\\partial B} \\boldsymbol{\\lambda} \\cdot \\boldsymbol{n}_{B} \\, dS = \\int_{\\partial \\Omega} \\delta \\, dS\n$$\nSince $\\delta$ is a spatially uniform scalar, it can be factored out of the integral on the right-hand side:\n$$\n\\int_{\\partial B} \\boldsymbol{\\lambda} \\cdot \\boldsymbol{n}_{B} \\, dS = \\delta \\int_{\\partial \\Omega} dS\n$$\nFrom this, we can express $\\delta$ as:\n$$\n\\delta = \\frac{\\int_{\\partial B} \\boldsymbol{\\lambda} \\cdot \\boldsymbol{n}_{B} \\, dS}{\\int_{\\partial \\Omega} dS}\n$$\nWe now need to evaluate the two integrals.\n\nThe numerator is the flux of $\\boldsymbol{\\lambda}$ out of the disk $B$. The boundary $\\partial B$ is a circle of radius $r_{0}$. On this boundary, the radial coordinate $r$ is equal to $r_{0}$. The Lagrange multiplier field is given as $\\boldsymbol{\\lambda}(\\boldsymbol{x}) = \\alpha \\, r \\, \\boldsymbol{e}_{r}$ for $\\boldsymbol{x} \\in B$. On $\\partial B$, this becomes $\\boldsymbol{\\lambda} = \\alpha \\, r_{0} \\, \\boldsymbol{e}_{r}$. The outward unit normal $\\boldsymbol{n}_{B}$ on the circular boundary is precisely the radial unit vector $\\boldsymbol{e}_{r}$. Therefore, the dot product is:\n$$\n\\boldsymbol{\\lambda} \\cdot \\boldsymbol{n}_{B} = (\\alpha \\, r_{0} \\, \\boldsymbol{e}_{r}) \\cdot \\boldsymbol{e}_{r} = \\alpha \\, r_{0} \\, |\\boldsymbol{e}_{r}|^{2} = \\alpha \\, r_{0}\n$$\nSince $\\alpha$ and $r_{0}$ are constants, the integrand $\\alpha \\, r_{0}$ is constant over the entire boundary $\\partial B$. The integral is:\n$$\n\\int_{\\partial B} \\alpha \\, r_{0} \\, dS = \\alpha \\, r_{0} \\int_{\\partial B} dS = \\alpha \\, r_{0} \\times (\\text{Circumference of } B) = \\alpha \\, r_{0} \\, (2 \\pi r_{0}) = 2 \\pi \\alpha r_{0}^{2}\n$$\nThe denominator is the total arc length (perimeter) of the boundary $\\partial \\Omega$. The domain $\\Omega$ is the unit square $[0,1] \\times [0,1]$. Its boundary consists of four sides, each of length $1$. The total perimeter is:\n$$\n\\int_{\\partial \\Omega} dS = 1 + 1 + 1 + 1 = 4\n$$\nSubstituting the calculated values for the numerator and denominator into the expression for $\\delta$:\n$$\n\\delta = \\frac{2 \\pi \\alpha r_{0}^{2}}{4} = \\frac{\\pi \\alpha r_{0}^{2}}{2}\n$$\nThe problem provides the specific value for the radius, $r_{0} = \\frac{1}{4}$. Substituting this value:\n$$\n\\delta = \\frac{\\pi \\alpha (\\frac{1}{4})^{2}}{2} = \\frac{\\pi \\alpha (\\frac{1}{16})}{2} = \\frac{\\pi \\alpha}{32}\n$$\nThis is the closed-form analytic expression for $\\delta$ that ensures the solvability of the pressure-Poisson problem.", "answer": "$$\n\\boxed{\\frac{\\pi \\alpha}{32}}\n$$", "id": "3317741"}]}