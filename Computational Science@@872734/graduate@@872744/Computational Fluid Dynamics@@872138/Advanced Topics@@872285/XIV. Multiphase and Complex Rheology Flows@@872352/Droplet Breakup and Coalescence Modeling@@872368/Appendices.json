{"hands_on_practices": [{"introduction": "In interface-capturing methods, the accurate representation of surface tension hinges on the computation of interface curvature. This practice [@problem_id:3312819] provides a foundational exercise in deriving a discrete curvature estimator from the level-set function and rigorously analyzing its numerical error. By performing a formal truncation error analysis, you will gain a deep, first-principles understanding of how grid resolution and interface shape contribute to inaccuracies, a critical skill for any developer of multiphase flow codes.", "problem": "Consider the computation of interface curvature for capillary forces in droplet breakup and coalescence modeling using the level set method. Let the interface be represented implicitly by a level set function $\\phi(x,y)$, and let the curvature be defined by the geometric identity $\\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{|\\nabla \\phi|} \\right)$, where $\\nabla$ denotes the spatial gradient and $|\\cdot|$ denotes the Euclidean norm. Work on a uniform Cartesian mesh with spacings $\\Delta x = \\Delta y = h$.\n\nStart from first principles based on this definition and construct a second-order centered-difference discrete curvature estimator as follows: compute the discrete gradient components at a grid node $(i,j)$ using second-order centered differences, form the discrete unit normal as the normalized gradient at $(i,j)$, and then compute the discrete curvature at $(i,j)$ as the centered-difference divergence of this discrete unit normal.\n\nNow consider a two-dimensional sinusoidal interface parameterized implicitly by the level set\n$\\phi(x,y) = y - \\varepsilon \\cos(\\alpha x)$,\nwhere $\\varepsilon$ is the physical amplitude (with dimensions of length) and $\\alpha$ is the wavenumber (with dimensions of inverse length). Focus on the crest located at $x=0$, where the interface passes through the point $(x,y)=(0,\\varepsilon)$. Assume this interface point is a mesh node.\n\nUsing Taylor expansions about the crest and the discrete procedure described above, perform a truncation error analysis of the discrete curvature at the crest. Introduce the dimensionless parameters $\\tilde{\\varepsilon} \\equiv \\alpha \\varepsilon$ and $\\delta \\equiv \\alpha h$, and expand the dimensionless discrete curvature as\n$\\kappa_h / \\alpha = \\tilde{\\varepsilon} + C(\\tilde{\\varepsilon}) \\, \\delta^2 + \\mathcal{O}(\\delta^4)$,\nwhere $\\kappa_h$ is the discrete curvature computed by the second-order centered-difference procedure.\n\nDerive the closed-form analytical expression for the coefficient $C(\\tilde{\\varepsilon})$. Report your final answer as an exact analytic expression for $C(\\tilde{\\varepsilon})$ with no units. No numerical rounding is required, and you should not include any physical units in the final answer.", "solution": "The user wants to find the coefficient $C(\\tilde{\\varepsilon})$ in the truncation error expansion for a discrete curvature computation.\nThe problem is well-posed, scientifically grounded in computational fluid dynamics and numerical analysis, and all terms are clearly defined. The setup is self-contained and consistent. The problem is valid.\n\nFirst, let's establish the analytical curvature at the crest of the interface, located at the point $(x,y)=(0, \\varepsilon)$. The level set function is given by $\\phi(x,y) = y - \\varepsilon \\cos(\\alpha x)$. The curvature is defined as $\\kappa = \\nabla \\cdot \\mathbf{n}$, where $\\mathbf{n} = \\frac{\\nabla \\phi}{|\\nabla \\phi|}$.\n\nThe gradient of the level set function is:\n$$\n\\nabla \\phi = \\left( \\frac{\\partial \\phi}{\\partial x}, \\frac{\\partial \\phi}{\\partial y} \\right) = (\\alpha \\varepsilon \\sin(\\alpha x), 1)\n$$\nThe magnitude of the gradient is:\n$$\n|\\nabla \\phi| = \\sqrt{(\\alpha \\varepsilon \\sin(\\alpha x))^2 + 1^2} = \\sqrt{1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)}\n$$\nThe unit normal vector field $\\mathbf{n} = (n_x, n_y)$ is:\n$$\n\\mathbf{n} = \\frac{(\\alpha \\varepsilon \\sin(\\alpha x), 1)}{\\sqrt{1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)}}\n$$\nThe curvature $\\kappa$ is the divergence of $\\mathbf{n}$:\n$$\n\\kappa = \\frac{\\partial n_x}{\\partial x} + \\frac{\\partial n_y}{\\partial y}\n$$\nThe component $n_y$ does not depend on $y$, so $\\frac{\\partial n_y}{\\partial y} = 0$. We only need to compute $\\frac{\\partial n_x}{\\partial x}$.\n$$\n\\frac{\\partial n_x}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\alpha \\varepsilon \\sin(\\alpha x)}{\\left(1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)\\right)^{1/2}} \\right)\n$$\nUsing the quotient rule, the numerator of the derivative is $(\\alpha^2 \\varepsilon \\cos(\\alpha x))(1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x))^{1/2}$, and the denominator involves higher-order terms in $\\sin(\\alpha x)$. At the crest, where $x=0$, we have $\\sin(0)=0$ and $\\cos(0)=1$. The expression simplifies significantly:\n$$\n\\kappa(0) = \\left. \\frac{\\partial n_x}{\\partial x} \\right|_{x=0} = \\frac{(\\alpha^2 \\varepsilon \\cos(0))(1 + 0)^{1/2} - (\\dots) \\sin(0)}{1+0} = \\alpha^2 \\varepsilon\n$$\nThe dimensionless analytical curvature is $\\kappa(0) / \\alpha = \\alpha\\varepsilon = \\tilde{\\varepsilon}$. This confirms the leading-order term in the problem's expansion.\n\nNow, we will follow the discrete procedure on a uniform grid with spacing $h$. The point of interest $(0, \\varepsilon)$ is a grid node, which we denote by $(i,j)$. The discrete curvature is $\\kappa_h = (\\nabla_h \\cdot \\mathbf{n}_h)_{i,j}$, where $\\mathbf{n}_h$ is the discrete unit normal. The centered-difference divergence is:\n$$\n\\kappa_h = \\frac{(n_x)_{i+1,j} - (n_x)_{i-1,j}}{2h} + \\frac{(n_y)_{i,j+1} - (n_y)_{i,j-1}}{2h}\n$$\nThis requires the discrete normal vector $\\mathbf{n}_h$ at the four neighbors of $(i,j)$. The discrete normal is defined as $\\mathbf{n}_h = \\frac{\\nabla_h \\phi}{|\\nabla_h \\phi|}$, where $\\nabla_h \\phi$ is computed using centered differences. This means we first need the discrete gradient at these neighboring nodes.\n\nLet's compute the $y$-component term first. At node $(i, j+1)=(0, \\varepsilon+h)$, the discrete gradient components are:\n$$\n(\\phi_x)_h|_{i,j+1} = \\frac{\\phi(h, \\varepsilon+h) - \\phi(-h, \\varepsilon+h)}{2h} = \\frac{[(\\varepsilon+h)-\\varepsilon\\cos(\\alpha h)] - [(\\varepsilon+h)-\\varepsilon\\cos(-\\alpha h)]}{2h} = 0\n$$\n$$\n(\\phi_y)_h|_{i,j+1} = \\frac{\\phi(0, \\varepsilon+2h) - \\phi(0, \\varepsilon)}{2h} = \\frac{[(\\varepsilon+2h)-\\varepsilon] - [(\\varepsilon)-\\varepsilon]}{2h} = \\frac{2h}{2h} = 1\n$$\nSo, $\\nabla_h \\phi|_{i,j+1}=(0,1)$, which leads to $\\mathbf{n}_h|_{i,j+1}=(0,1)$, so $(n_y)_{i,j+1}=1$.\nSimilarly, at node $(i,j-1)=(0, \\varepsilon-h)$,\n$$\n(\\phi_x)_h|_{i,j-1} = 0\n$$\n$$\n(\\phi_y)_h|_{i,j-1} = \\frac{\\phi(0, \\varepsilon) - \\phi(0, \\varepsilon-2h)}{2h} = \\frac{0 - [(\\varepsilon-2h)-\\varepsilon]}{2h} = \\frac{2h}{2h}=1\n$$\nSo, $\\mathbf{n}_h|_{i,j-1}=(0,1)$ and $(n_y)_{i,j-1}=1$. The $y$-contribution to $\\kappa_h$ is $\\frac{1-1}{2h} = 0$.\n\nNow for the $x$-component term. We need $\\mathbf{n}_h$ at $(i+1,j)=(h,\\varepsilon)$ and $(i-1,j)=(-h,\\varepsilon)$.\nLet's find the discrete gradient at $(i+1,j)$:\n$$\n(\\phi_x)_h|_{i+1,j} = \\frac{\\phi(2h, \\varepsilon) - \\phi(0, \\varepsilon)}{2h} = \\frac{[\\varepsilon-\\varepsilon\\cos(2\\alpha h)] - 0}{2h} = \\frac{\\varepsilon(1-\\cos(2\\alpha h))}{2h}\n$$\n$$\n(\\phi_y)_h|_{i+1,j} = \\frac{\\phi(h, \\varepsilon+h) - \\phi(h, \\varepsilon-h)}{2h} = \\frac{[(\\varepsilon+h)-\\varepsilon\\cos(\\alpha h)] - [(\\varepsilon-h)-\\varepsilon\\cos(\\alpha h)]}{2h} = \\frac{2h}{2h} = 1\n$$\nBy symmetry, at $(i-1,j)$, $(\\phi_x)_h|_{i-1,j} = -(\\phi_x)_h|_{i+1,j}$ and $(\\phi_y)_h|_{i-1,j} = 1$.\n\nLet $G_x = (\\phi_x)_h|_{i+1,j}$. We expand $G_x$ for small $h$ using the Taylor series $\\cos(z) = 1 - \\frac{z^2}{2!} + \\frac{z^4}{4!} - \\mathcal{O}(z^6)$:\n$$\n1-\\cos(2\\alpha h) = 1 - \\left(1 - \\frac{(2\\alpha h)^2}{2} + \\frac{(2\\alpha h)^4}{24} - \\dots\\right) = 2\\alpha^2 h^2 - \\frac{2}{3}\\alpha^4 h^4 + \\mathcal{O}(h^6)\n$$\n$$\nG_x = \\frac{\\varepsilon}{2h}\\left(2\\alpha^2 h^2 - \\frac{2}{3}\\alpha^4 h^4 + \\mathcal{O}(h^6)\\right) = \\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3 + \\mathcal{O}(h^5)\n$$\nThe normal component $(n_x)_{i+1,j}$ is given by:\n$$\n(n_x)_{i+1,j} = \\frac{G_x}{\\sqrt{G_x^2 + 1^2}} = G_x (1+G_x^2)^{-1/2}\n$$\nUsing the binomial expansion $(1+z)^{-1/2} = 1 - \\frac{1}{2}z + \\mathcal{O}(z^2)$, with $z=G_x^2$:\n$$\n(n_x)_{i+1,j} = G_x \\left(1 - \\frac{1}{2}G_x^2 + \\mathcal{O}(G_x^4)\\right) = G_x - \\frac{1}{2}G_x^3 + \\mathcal{O}(G_x^5)\n$$\nThe leading term of $G_x$ is $\\mathcal{O}(h)$, so $G_x^3$ is $\\mathcal{O}(h^3)$. We need to keep terms up to $h^3$ in the expansion of $(n_x)_{i+1,j}$:\n$$\nG_x = \\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3 + \\mathcal{O}(h^5)\n$$\n$$\nG_x^3 = \\left(\\varepsilon\\alpha^2 h\\right)^3 + \\mathcal{O}(h^5) = \\varepsilon^3\\alpha^6 h^3 + \\mathcal{O}(h^5)\n$$\nSubstituting these into the expression for $(n_x)_{i+1,j}$:\n$$\n(n_x)_{i+1,j} = \\left(\\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3\\right) - \\frac{1}{2}\\left(\\varepsilon^3\\alpha^6 h^3\\right) + \\mathcal{O}(h^5)\n$$\n$$\n(n_x)_{i+1,j} = \\varepsilon\\alpha^2 h - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^3 + \\mathcal{O}(h^5)\n$$\nDue to symmetry, $(\\nabla_h\\phi)|_{i-1,j} = (-G_x, 1)$, so $(n_x)_{i-1,j} = \\frac{-G_x}{\\sqrt{G_x^2+1}} = -(n_x)_{i+1,j}$.\nNow we assemble the discrete curvature $\\kappa_h$:\n$$\n\\kappa_h = \\frac{(n_x)_{i+1,j} - (-(n_x)_{i+1,j})}{2h} + 0 = \\frac{2(n_x)_{i+1,j}}{2h} = \\frac{(n_x)_{i+1,j}}{h}\n$$\n$$\n\\kappa_h = \\frac{1}{h}\\left[\\varepsilon\\alpha^2 h - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^3 + \\mathcal{O}(h^5)\\right]\n$$\n$$\n\\kappa_h = \\varepsilon\\alpha^2 - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^2 + \\mathcal{O}(h^4)\n$$\nThe problem asks for the expansion of the dimensionless curvature $\\kappa_h / \\alpha$ in terms of $\\tilde{\\varepsilon} = \\alpha\\varepsilon$ and $\\delta = \\alpha h$.\n$$\n\\frac{\\kappa_h}{\\alpha} = \\varepsilon\\alpha - \\frac{1}{\\alpha}\\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^2 + \\mathcal{O}(h^4)\n$$\nLet's rewrite the terms in parentheses using the dimensionless variables:\n$$\n\\frac{1}{3}\\varepsilon\\alpha^4 = \\frac{1}{3}(\\alpha\\varepsilon)\\alpha^3 = \\frac{1}{3}\\tilde{\\varepsilon}\\alpha^3\n$$\n$$\n\\frac{1}{2}\\varepsilon^3\\alpha^6 = \\frac{1}{2}(\\alpha\\varepsilon)^3\\alpha^3 = \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^3\n$$\nSubstituting this back into the expansion for $\\kappa_h/\\alpha$:\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\frac{1}{\\alpha}\\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^3 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^3\\right)h^2 + \\mathcal{O}(h^4)\n$$\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^2 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^2\\right)h^2 + \\mathcal{O}(h^4)\n$$\nNow, substitute $h^2 = \\delta^2/\\alpha^2$:\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^2 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^2\\right)\\frac{\\delta^2}{\\alpha^2} + \\mathcal{O}(\\delta^4)\n$$\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)\\delta^2 + \\mathcal{O}(\\delta^4)\n$$\nComparing this to the given form $\\kappa_h / \\alpha = \\tilde{\\varepsilon} + C(\\tilde{\\varepsilon}) \\, \\delta^2 + \\mathcal{O}(\\delta^4)$, we can identify the coefficient $C(\\tilde{\\varepsilon})$:\n$$\nC(\\tilde{\\varepsilon}) = -\\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)\n$$\nThis expression can also be written as $-\\frac{\\tilde{\\varepsilon}}{6}(2+3\\tilde{\\varepsilon}^2)$.", "answer": "$$\\boxed{-\\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)}$$", "id": "3312819"}, {"introduction": "Numerical errors in curvature computation have tangible consequences, often manifesting as non-physical \"spurious currents\" that can corrupt simulation results. This exercise [@problem_id:3312875] challenges you to use scaling analysis on the Navier-Stokes equations to uncover the root cause of these parasitic flows. Deriving the scaling law for spurious velocities will illuminate the direct link between discretization error and its physical consequences, providing vital intuition for debugging and validating multiphase simulations.", "problem": "Consider a static spherical droplet test in Computational Fluid Dynamics (CFD) with the Continuum Surface Force (CSF) model for surface tension. An initially spherical droplet of radius $R$ is suspended at rest in an otherwise quiescent, incompressible, isothermal fluid. The densities and viscosities are matched across the interface to eliminate buoyancy and viscosity-contrast effects. In the continuous, exact solution, the velocity field is $ \\mathbf{u} = \\mathbf{0} $ and the pressure jump is set by the Laplace law. In the CSF formulation, the surface tension force appears as a volumetric force $ \\mathbf{f}_{s} = \\sigma \\kappa \\nabla C $, where $ \\sigma $ is the surface tension coefficient, $ \\kappa $ is the mean curvature, and $ C $ is a smoothed color function whose gradient approximates a regularized surface delta distribution. Due to discretization, the numerically computed curvature has an error $ \\delta \\kappa $ near the interface. The smearing of $ C $ implies a numerical interface thickness $ w $ such that $ |\\nabla C| $ scales like $ 1/w $ across the interfacial band. Assume low-Reynolds-number conditions so that inertial terms are negligible compared to viscous and capillary effects.\n\nUsing only the incompressible Navier–Stokes equations, the CSF representation of surface tension, and scaling arguments grounded in these, derive the leading-order scaling for the steady-state maximum magnitude of the spurious velocity $ u_{s} $ driven solely by the curvature discretization error in this static droplet test. Define the dimensionless curvature-imbalance measure $ \\Delta \\kappa \\equiv w \\, |\\delta \\kappa| $. Express your final result for $ u_{s} $ in terms of $ \\sigma $, $ \\mu $, and $ \\Delta \\kappa $, where $ \\mu $ is the dynamic viscosity. Express the final velocity in SI units (m/s) by taking $ \\sigma $ in N/m, $ \\mu $ in Pa·s, and $ \\Delta \\kappa $ as dimensionless. Provide your answer as a single closed-form analytic expression for $ u_{s} $ and do not include units in the final boxed expression.", "solution": "The problem requires deriving the leading-order scaling for the maximum spurious velocity, $u_s$, in a numerical simulation of a static droplet using the Continuum Surface Force (CSF) model. The derivation will be based on a scaling analysis of the governing fluid dynamics equations under the specified conditions.\n\nThe fundamental governing equation for an incompressible, isothermal fluid is the Navier-Stokes equation:\n$$ \\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u} \\right) = -\\nabla p + \\nabla \\cdot \\boldsymbol{\\tau} + \\mathbf{f}_b $$\nwhere $\\rho$ is the fluid density, $\\mathbf{u}$ is the velocity field, $p$ is the pressure, $\\boldsymbol{\\tau}$ is the viscous stress tensor, and $\\mathbf{f}_b$ represents body forces.\n\nThe problem specifies several conditions that simplify this equation:\n1.  **Steady State**: The flow is in a steady state, meaning all time derivatives are zero. Thus, $\\frac{\\partial \\mathbf{u}}{\\partial t} = \\mathbf{0}$.\n2.  **Low Reynolds Number**: Inertial effects are negligible compared to viscous effects. This allows us to drop the convective acceleration term, $\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u})$.\n3.  **Newtonian Fluid with Constant Viscosity**: The fluid is Newtonian with a constant dynamic viscosity $\\mu$. The stress tensor is $\\boldsymbol{\\tau} = \\mu (\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$. For an incompressible flow where $\\nabla \\cdot \\mathbf{u} = 0$, the divergence of the stress tensor simplifies to $\\nabla \\cdot \\boldsymbol{\\tau} = \\mu \\nabla^2 \\mathbf{u}$.\n4.  **CSF Model**: The surface tension force is modeled as a volumetric body force $\\mathbf{f}_b = \\mathbf{f}_s = \\sigma \\kappa \\nabla C$, where $\\sigma$ is the surface tension coefficient, $\\kappa$ is the mean curvature, and $C$ is the smoothed color function. In the numerical simulation, the computed curvature contains an error, so we use $\\kappa_{num}$ to denote the numerical curvature.\n\nUnder these conditions, the governing equation reduces to the steady Stokes equation with a surface tension source term:\n$$ \\mathbf{0} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa_{num} \\nabla C $$\nIn the exact physical system, the velocity field is identically zero ($\\mathbf{u} = \\mathbf{0}$), and the surface tension force is perfectly balanced by a static pressure gradient. The spurious velocity $\\mathbf{u}_s$ (which we denote as $\\mathbf{u}$ in the equations) is a non-physical flow driven entirely by the numerical imbalance between the discretized pressure gradient and the surface tension force.\n\nThe most direct method to analyze the rotational flow driven by this imbalance is to eliminate the pressure term. The pressure field $p$ arises to enforce the incompressibility constraint ($\\nabla \\cdot \\mathbf{u} = 0$), and its gradient term, $\\nabla p$, is a conservative field (its curl is zero). By taking the curl of the Stokes equation, we can isolate the non-conservative forces that generate vorticity and thus drive the flow.\n\nApplying the curl operator ($\\nabla \\times$) to the Stokes equation yields:\n$$ \\nabla \\times (\\mathbf{0}) = \\nabla \\times (-\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa_{num} \\nabla C) $$\n$$ \\mathbf{0} = -\\nabla \\times (\\nabla p) + \\mu \\nabla \\times (\\nabla^2 \\mathbf{u}) + \\sigma \\nabla \\times (\\kappa_{num} \\nabla C) $$\nUsing the vector identities $\\nabla \\times (\\nabla p) = \\mathbf{0}$ and $\\nabla \\times (\\nabla^2 \\mathbf{u}) = \\nabla^2 (\\nabla \\times \\mathbf{u})$, and defining the vorticity as $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}$, the equation becomes:\n$$ \\mu \\nabla^2 \\boldsymbol{\\omega} = -\\sigma \\nabla \\times (\\kappa_{num} \\nabla C) $$\nThis is the vorticity transport equation. The term on the right-hand side is the source of vorticity. We analyze it using the product rule for curls, $\\nabla \\times (f \\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + (\\nabla f) \\times \\mathbf{A}$, where we set $f = \\kappa_{num}$ and $\\mathbf{A} = \\nabla C$.\n$$ \\nabla \\times (\\kappa_{num} \\nabla C) = \\kappa_{num} (\\nabla \\times (\\nabla C)) + (\\nabla \\kappa_{num}) \\times (\\nabla C) $$\nSince the curl of a gradient of any scalar field is identically zero, $\\nabla \\times (\\nabla C) = \\mathbf{0}$. The vorticity source term simplifies to:\n$$ \\mu \\nabla^2 \\boldsymbol{\\omega} = -\\sigma (\\nabla \\kappa_{num}) \\times (\\nabla C) $$\nThis equation reveals that spurious vorticity is generated if and only if the gradient of the numerical curvature, $\\nabla \\kappa_{num}$, is not parallel to the gradient of the color function, $\\nabla C$. This non-parallelism is a direct consequence of numerical discretization errors. The numerical curvature is the sum of the exact curvature and an error term: $\\kappa_{num} = \\kappa_{exact} + \\delta \\kappa$. For a sphere, $\\kappa_{exact}$ is a constant, so its gradient is zero. Therefore, $\\nabla \\kappa_{num} = \\nabla(\\delta \\kappa)$. The equation becomes:\n$$ \\mu \\nabla^2 \\boldsymbol{\\omega} = -\\sigma (\\nabla(\\delta \\kappa)) \\times (\\nabla C) $$\nWe now perform a scaling analysis on this equation to find the magnitude of the spurious velocity, $u_s$. The flow structures (vortices) are localized to the numerical interface region. Thus, the characteristic length scale $L$ for this flow is the interface thickness, $w$.\nThe scaling relations for the terms in the vorticity equation are as follows:\n- The magnitude of the spurious velocity is $|\\mathbf{u}| \\sim u_s$.\n- The characteristic length scale is $L \\sim w$.\n- Vorticity magnitude: $|\\boldsymbol{\\omega}| = |\\nabla \\times \\mathbf{u}| \\sim \\frac{u_s}{L} \\sim \\frac{u_s}{w}$.\n- Laplacian of vorticity magnitude: $|\\nabla^2 \\boldsymbol{\\omega}| \\sim \\frac{|\\boldsymbol{\\omega}|}{L^2} \\sim \\frac{u_s/w}{w^2} = \\frac{u_s}{w^3}$.\n- The magnitude of the left-hand side (viscous term) scales as: $|\\mu \\nabla^2 \\boldsymbol{\\omega}| \\sim \\mu \\frac{u_s}{w^3}$.\n\nFor the right-hand side (vorticity source):\n- The magnitude of the gradient of the color function is given to scale as $|\\nabla C| \\sim \\frac{1}{w}$.\n- The curvature error $\\delta \\kappa$ varies over the length scale of the interface, $w$. Therefore, the magnitude of its gradient scales as $|\\nabla(\\delta \\kappa)| \\sim \\frac{|\\delta \\kappa|}{w}$.\n- The magnitude of the right-hand side scales as: $|-\\sigma (\\nabla(\\delta \\kappa)) \\times (\\nabla C)| \\sim \\sigma |\\nabla(\\delta \\kappa)| |\\nabla C| \\sim \\sigma \\left( \\frac{|\\delta \\kappa|}{w} \\right) \\left( \\frac{1}{w} \\right) = \\frac{\\sigma |\\delta \\kappa|}{w^2}$.\n\nEquating the scales of the left-hand side and right-hand side provides the balance between viscous dissipation and the generation of spurious vorticity:\n$$ \\mu \\frac{u_s}{w^3} \\sim \\frac{\\sigma |\\delta \\kappa|}{w^2} $$\nSolving for the spurious velocity magnitude $u_s$:\n$$ u_s \\sim \\frac{\\sigma}{\\mu} \\frac{w^3 |\\delta \\kappa|}{w^2} = \\frac{\\sigma w |\\delta \\kappa|}{\\mu} $$\nThe problem defines the dimensionless curvature-imbalance measure as $\\Delta \\kappa \\equiv w |\\delta \\kappa|$. Substituting this definition into the scaling relation gives:\n$$ u_s \\sim \\frac{\\sigma}{\\mu} \\Delta \\kappa $$\nThis is the derived leading-order scaling. As it is a scaling law, it is determined up to a dimensionless constant of order unity. The problem asks for a single closed-form analytic expression. We provide the simplest form, which sets this constant to $1$, consistent with the standard analysis of this phenomenon.\n$$ u_s = \\frac{\\sigma \\Delta \\kappa}{\\mu} $$\nChecking the units: $\\sigma$ is in N/m or kg/s$^2$, $\\mu$ is in Pa·s or kg/(m·s), and $\\Delta \\kappa$ is dimensionless. The ratio $\\frac{\\sigma}{\\mu}$ has units of $\\frac{\\text{kg}/\\text{s}^2}{\\text{kg}/(\\text{m} \\cdot \\text{s})} = \\frac{\\text{m}}{\\text{s}}$, which is a velocity, as required.", "answer": "$$\\boxed{\\frac{\\sigma \\Delta \\kappa}{\\mu}}$$", "id": "3312875"}, {"introduction": "This practice [@problem_id:3312887] elevates our analysis from understanding numerical artifacts to controlling their impact on physical predictions, such as the critical Weber number for droplet breakup. You will model how curvature errors from different schemes (VOF vs. Level Set) propagate to alter this critical physical threshold. The ultimate goal is to derive and implement an *a posteriori* mesh refinement criterion, a practical tool that allows you to engineer simulations to meet a desired level of accuracy.", "problem": "A droplet of diameter $D$ is placed in a uniform incompressible flow and is subject to hydrodynamic forcing that can lead to bag breakup when the inertial forcing overcomes capillary resistance. Consider the incompressible Navier–Stokes equations with the surface tension force represented by the Continuous Surface Force (CSF) model, where the capillary force density acts as $\\mathbf{f}_{\\sigma}=\\sigma \\kappa \\mathbf{n} \\delta_{\\Gamma}$, with $\\sigma$ the surface tension, $\\kappa$ the mean curvature, $\\mathbf{n}$ the unit normal, and $\\delta_{\\Gamma}$ a surface delta distribution. Define the Weber number as $\\mathit{We}=\\rho U^{2} D / \\sigma$, where $\\rho$ is density, $U$ is a characteristic velocity, and $D$ is the droplet diameter. Assume that the onset of bag breakup is primarily governed by the balance between aerodynamic forcing and capillary resistance.\n\nA numerical method for multiphase flow must reconstruct curvature. Let the reconstructed curvature $\\kappa_{\\text{num}}$ have a relative error $\\varepsilon_{\\kappa}$ with respect to the true curvature $\\kappa$: $\\kappa_{\\text{num}}=(1+\\varepsilon_{\\kappa})\\kappa$. The curvature error depends on the mesh size $h$ and the local radius of curvature $R=1/|\\kappa|$. Consider two interface-capturing methods:\n- Volume of Fluid (VOF): model the curvature error as $\\varepsilon_{\\kappa}^{\\text{VOF}}=\\alpha_{\\text{V}} (h/R)^{2}$ with a positive constant $\\alpha_{\\text{V}}0$ for well-resolved height-function curvature.\n- Level Set (LS): model the curvature error as $\\varepsilon_{\\kappa}^{\\text{LS}}=\\alpha_{\\text{L}} (h/R)^{2} - \\beta_{\\text{L}} (W/R)^{2}$, where $W=k_{W} h$ is the diffuse interface thickness, $\\alpha_{\\text{L}}0$, $\\beta_{\\text{L}}\\ge 0$, and $k_{W}\\ge 1$ denotes the interface thickness in cells.\n\nAssume the critical Weber number in the true physics (with exact surface tension) is $\\mathit{We}_{\\text{crit,true}}$. Using first principles of nondimensionalization and force balance, and viewing curvature error as an effective multiplicative perturbation to the capillary term in the momentum equation, derive:\n1) An expression for the numerically predicted critical Weber number $\\mathit{We}_{\\text{crit,pred}}$ in terms of $\\mathit{We}_{\\text{crit,true}}$ and $\\varepsilon_{\\kappa}$.\n2) An a posteriori mesh criterion that ensures a target bound on the relative error of the predicted critical Weber number, namely $|\\mathit{We}_{\\text{crit,pred}}-\\mathit{We}_{\\text{crit,true}}|/\\mathit{We}_{\\text{crit,true}}\\le \\tau$, for a prescribed tolerance $\\tau \\in (0,1)$. Base the curvature scale on the capillary length $l_{\\sigma}=\\sqrt{\\sigma/(\\rho a)}$, where $a$ is a characteristic acceleration that sets a curvature scale during deformation. Express your bound as an inequality on $h$ in meters, of the form $h \\le h_{\\max}$, in terms of $\\tau$, $l_{\\sigma}$, and the method-specific error coefficients. Use the smallest nonnegative coefficient $C_{\\text{eff}}$ such that $|\\varepsilon_{\\kappa}|\\le C_{\\text{eff}} (h/l_{\\sigma})^{2}$ holds for the assumed model, and report $h_{\\max}$ in meters.\n\nUsing your derived expressions, write a program that, for the test suite below, computes for each case:\n- The predicted critical Weber number $\\mathit{We}_{\\text{crit,pred}}$ (dimensionless).\n- The maximum admissible mesh size $h_{\\max}$ in meters that guarantees the tolerance $\\tau$ using the capillary length criterion.\n- A pass indicator, equal to $1$ if the provided mesh size $h$ satisfies $h \\le h_{\\max}$ and $0$ otherwise.\n\nAll physical inputs must be interpreted in SI units: meters (m), kilograms (kg), seconds (s). Angles are not used. All reported $h_{\\max}$ values must be in meters, and all $We$ values are dimensionless. Round all floating-point outputs to six decimal places.\n\nTest suite (each line defines one case as a tuple $(\\text{method}, \\mathit{We}_{\\text{crit,true}}, R, h, \\alpha, \\beta, k_{W}, \\sigma, \\rho, a, \\tau)$):\n- Case A (happy path, VOF): $(\"VOF\", 12.0, 1.0\\times 10^{-3}, 2.0\\times 10^{-4}, 0.5, 0.0, 1.0, 0.072, 1000.0, 30.0, 0.05)$\n- Case B (coarse, negative bias possible, LS): $(\"LS\", 12.0, 5.0\\times 10^{-4}, 2.5\\times 10^{-4}, 0.2, 0.15, 1.5, 0.072, 1000.0, 200.0, 0.03)$\n- Case C (near-zero error, fine VOF): $(\"VOF\", 15.0, 1.5\\times 10^{-3}, 1.5\\times 10^{-5}, 0.5, 0.0, 1.0, 0.072, 1000.0, 5.0, 0.01)$\n- Case D (fails mesh criterion, LS): $(\"LS\", 12.0, 1.0\\times 10^{-3}, 8.0\\times 10^{-4}, 0.25, 0.05, 2.0, 0.072, 1000.0, 500.0, 0.02)$\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of case results, each case result being a three-element list of the form $[\\mathit{We}_{\\text{crit,pred}}, h_{\\max}, \\text{pass}]$, with floating-point entries rounded to six decimal places and the pass indicator as an integer $0$ or $1$. For example: $[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],\\dots]$.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It presents a standard problem in the analysis of numerical methods for multiphase flow, specifically concerning the impact of curvature estimation errors on the prediction of physical instabilities. The models for curvature error, while simplified, are representative of behaviors observed in Volume of Fluid (VOF) and Level Set (LS) methods. All required data and definitions are provided. Therefore, the problem is valid, and a solution can be constructed.\n\nThe solution is derived in two parts, as requested. First, we derive an expression for the predicted critical Weber number, $\\mathit{We}_{\\text{crit,pred}}$. Second, we derive a mesh refinement criterion to bound the numerical error in this prediction.\n\n**Part 1: Derivation of the Predicted Critical Weber Number, $\\mathit{We}_{\\text{crit,pred}}$**\n\nThe onset of droplet breakup is governed by the balance between the destabilizing inertial force, whose scale is $F_{\\text{inertial}} \\propto \\rho U^2 D^2$, and the stabilizing capillary force, whose scale is $F_{\\text{capillary}} \\propto \\sigma D$. The Weber number, $\\mathit{We} = \\rho U^2 D / \\sigma$, is the ratio of these forces. Physical breakup occurs when $\\mathit{We}$ reaches a critical value, $\\mathit{We}_{\\text{crit,true}}$, which is a constant determined by the underlying fluid dynamics, representing a specific critical ratio of forces.\n\nIn a numerical simulation, the capillary force is computed based on a numerically estimated curvature, $\\kappa_{\\text{num}}$. The problem states that the capillary force density is given by the Continuous Surface Force (CSF) model, $\\mathbf{f}_{\\sigma}=\\sigma \\kappa \\mathbf{n} \\delta_{\\Gamma}$. The numerical implementation of this force is thus $\\mathbf{f}_{\\sigma, \\text{num}}=\\sigma \\kappa_{\\text{num}} \\mathbf{n} \\delta_{\\Gamma}$.\n\nThe numerical curvature is related to the true curvature $\\kappa$ by the relative error $\\varepsilon_{\\kappa}$:\n$$\n\\kappa_{\\text{num}} = (1 + \\varepsilon_{\\kappa}) \\kappa\n$$\nSubstituting this into the numerical force expression gives:\n$$\n\\mathbf{f}_{\\sigma, \\text{num}} = \\sigma (1 + \\varepsilon_{\\kappa}) \\kappa \\mathbf{n} \\delta_{\\Gamma} = (1 + \\varepsilon_{\\kappa}) \\mathbf{f}_{\\sigma}\n$$\nThis shows that the numerical method effectively operates with a modified, or effective, surface tension $\\sigma_{\\text{eff}}$:\n$$\n\\sigma_{\\text{eff}} = \\sigma (1 + \\varepsilon_{\\kappa})\n$$\nThe numerical simulation will predict breakup when the ratio of the inertial force to its *computed* capillary force reaches the true physical critical threshold, $\\mathit{We}_{\\text{crit,true}}$. Let $U_{\\text{pred}}$ be the critical velocity at which the simulation predicts breakup. The balance in the numerical world is:\n$$\n\\frac{\\rho U_{\\text{pred}}^2 D}{\\sigma_{\\text{eff}}} = \\mathit{We}_{\\text{crit,true}}\n$$\nBy definition, the predicted critical Weber number is expressed using the *true* physical parameters:\n$$\n\\mathit{We}_{\\text{crit,pred}} = \\frac{\\rho U_{\\text{pred}}^2 D}{\\sigma}\n$$\nFrom the numerical balance equation, we can write $\\rho U_{\\text{pred}}^2 D = \\mathit{We}_{\\text{crit,true}} \\cdot \\sigma_{\\text{eff}}$. Substituting this into the definition of $\\mathit{We}_{\\text{crit,pred}}$ yields:\n$$\n\\mathit{We}_{\\text{crit,pred}} = \\frac{\\mathit{We}_{\\text{crit,true}} \\cdot \\sigma_{\\text{eff}}}{\\sigma} = \\frac{\\mathit{We}_{\\text{crit,true}} \\cdot \\sigma(1 + \\varepsilon_{\\kappa})}{\\sigma}\n$$\nThis simplifies to the desired expression:\n$$\n\\mathit{We}_{\\text{crit,pred}} = \\mathit{We}_{\\text{crit,true}} (1 + \\varepsilon_{\\kappa})\n$$\nThe relative error $\\varepsilon_{\\kappa}$ is calculated using the given models. For the VOF method, it is:\n$$\n\\varepsilon_{\\kappa} = \\varepsilon_{\\kappa}^{\\text{VOF}} = \\alpha_{\\text{V}} \\left(\\frac{h}{R}\\right)^2\n$$\nFor the LS method, it is:\n$$\n\\varepsilon_{\\kappa} = \\varepsilon_{\\kappa}^{\\text{LS}} = \\alpha_{\\text{L}} \\left(\\frac{h}{R}\\right)^2 - \\beta_{\\text{L}} \\left(\\frac{W}{R}\\right)^2 = \\alpha_{\\text{L}} \\left(\\frac{h}{R}\\right)^2 - \\beta_{\\text{L}} \\left(\\frac{k_{W}h}{R}\\right)^2 = (\\alpha_{\\text{L}} - \\beta_{\\text{L}} k_{W}^2) \\left(\\frac{h}{R}\\right)^2\n$$\n\n**Part 2: Derivation of the Mesh Criterion**\n\nThe goal is to find a condition on the mesh size $h$ that ensures the relative error in the predicted critical Weber number is bounded by a tolerance $\\tau$:\n$$\n\\frac{|\\mathit{We}_{\\text{crit,pred}} - \\mathit{We}_{\\text{crit,true}}|}{\\mathit{We}_{\\text{crit,true}}} \\le \\tau\n$$\nSubstituting the expression for $\\mathit{We}_{\\text{crit,pred}}$ from Part 1:\n$$\n\\frac{|\\mathit{We}_{\\text{crit,true}} (1 + \\varepsilon_{\\kappa}) - \\mathit{We}_{\\text{crit,true}}|}{\\mathit{We}_{\\text{crit,true}}} \\le \\tau\n$$\n$$\n\\frac{|\\mathit{We}_{\\text{crit,true}} \\cdot \\varepsilon_{\\kappa}|}{\\mathit{We}_{\\text{crit,true}}} \\le \\tau\n$$\nAssuming $\\mathit{We}_{\\text{crit,true}}  0$, this simplifies to a condition on the magnitude of the curvature error:\n$$\n|\\varepsilon_{\\kappa}| \\le \\tau\n$$\nThe problem requires basing the mesh criterion on the capillary length, $l_{\\sigma} = \\sqrt{\\sigma/(\\rho a)}$, as the characteristic radius of curvature, i.e., $R = l_{\\sigma}$. We must find the smallest non-negative coefficient $C_{\\text{eff}}$ such that $|\\varepsilon_{\\kappa}| \\le C_{\\text{eff}} (h/l_{\\sigma})^2$. This is achieved by substituting $R=l_{\\sigma}$ into the error models.\n\nFor VOF:\n$$\n|\\varepsilon_{\\kappa}^{\\text{VOF}}| = \\left|\\alpha_{\\text{V}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2\\right| = \\alpha_{\\text{V}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2 \\quad (\\text{since } \\alpha_{\\text{V}}  0)\n$$\nThus, for VOF, $C_{\\text{eff}} = \\alpha_{\\text{V}}$.\n\nFor LS:\n$$\n|\\varepsilon_{\\kappa}^{\\text{LS}}| = \\left|(\\alpha_{\\text{L}} - \\beta_{\\text{L}} k_{W}^2) \\left(\\frac{h}{l_{\\sigma}}\\right)^2\\right| = |\\alpha_{\\text{L}} - \\beta_L k_{W}^2| \\left(\\frac{h}{l_{\\sigma}}\\right)^2\n$$\nThus, for LS, $C_{\\text{eff}} = |\\alpha_{\\text{L}} - \\beta_L k_{W}^2|$.\n\nThe error constraint $|\\varepsilon_{\\kappa}| \\le \\tau$ becomes:\n$$\nC_{\\text{eff}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2 \\le \\tau\n$$\nIf $C_{\\text{eff}}  0$, we can solve for $h$:\n$$\nh^2 \\le \\frac{\\tau \\cdot l_{\\sigma}^2}{C_{\\text{eff}}}\n$$\n$$\nh \\le l_{\\sigma} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}}\n$$\nThis gives the maximum allowable mesh size, $h_{\\max}$:\n$$\nh_{\\max} = l_{\\sigma} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}} = \\sqrt{\\frac{\\sigma}{\\rho a}} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}}\n$$\nIf $C_{\\text{eff}} = 0$, the inequality $0 \\le \\tau$ is always true for $\\tau \\in (0,1)$, implying that any mesh size is acceptable. In this case, $h_{\\max} \\to \\infty$.\n\n**Summary of Calculation Steps for the Program**\n\nFor each test case:\n1.  Identify the method (`VOF` or `LS`) and unpack the parameters $(\\text{method}, \\mathit{We}_{\\text{crit,true}}, R, h, \\alpha, \\beta, k_{W}, \\sigma, \\rho, a, \\tau)$. For VOF, $\\alpha = \\alpha_{\\text{V}}$. For LS, $\\alpha = \\alpha_{\\text{L}}$ and $\\beta = \\beta_{\\text{L}}$.\n2.  Calculate the curvature error $\\varepsilon_{\\kappa}$.\n    - If `VOF`: $\\varepsilon_{\\kappa} = \\alpha (h/R)^2$.\n    - If `LS`: $\\varepsilon_{\\kappa} = (\\alpha - \\beta k_{W}^2) (h/R)^2$.\n3.  Calculate the predicted critical Weber number: $\\mathit{We}_{\\text{crit,pred}} = \\mathit{We}_{\\text{crit,true}}(1 + \\varepsilon_{\\kappa})$.\n4.  Calculate the capillary length: $l_{\\sigma} = \\sqrt{\\sigma/(\\rho a)}$.\n5.  Calculate the effective error coefficient $C_{\\text{eff}}$.\n    - If `VOF`: $C_{\\text{eff}} = \\alpha$.\n    - If `LS`: $C_{\\text{eff}} = |\\alpha - \\beta k_{W}^2|$.\n6.  Calculate the maximum mesh size $h_{\\max}$.\n    - If $C_{\\text{eff}}  0$: $h_{\\max} = l_{\\sigma} \\sqrt{\\tau / C_{\\text{eff}}}$.\n    - If $C_{\\text{eff}} = 0$: $h_{\\max} = \\infty$.\n7.  Determine the pass indicator: Set to $1$ if the given mesh size $h$ satisfies $h \\le h_{\\max}$, otherwise set to $0$.\n8.  Format the results $[\\mathit{We}_{\\text{crit,pred}}, h_{\\max}, \\text{pass}]$ with floating-point values rounded to six decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are imported.\n\ndef solve():\n    \"\"\"\n    Solves the droplet breakup problem for the given test suite.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (method, We_crit_true, R, h, alpha, beta, k_W, sigma, rho, a, tau)\n        (\"VOF\", 12.0, 1.0e-3, 2.0e-4, 0.5, 0.0, 1.0, 0.072, 1000.0, 30.0, 0.05),\n        (\"LS\", 12.0, 5.0e-4, 2.5e-4, 0.2, 0.15, 1.5, 0.072, 1000.0, 200.0, 0.03),\n        (\"VOF\", 15.0, 1.5e-3, 1.5e-5, 0.5, 0.0, 1.0, 0.072, 1000.0, 5.0, 0.01),\n        (\"LS\", 12.0, 1.0e-3, 8.0e-4, 0.25, 0.05, 2.0, 0.072, 1000.0, 500.0, 0.02)\n    ]\n\n    results = []\n    for case in test_cases:\n        method, we_crit_true, R_val, h_val, alpha, beta, k_w, sigma, rho, a_val, tau = case\n\n        # 1. Calculate the relative curvature error, epsilon_kappa\n        h_over_R = h_val / R_val\n        if method == \"VOF\":\n            # For VOF, epsilon_kappa = alpha_V * (h/R)^2\n            epsilon_kappa = alpha * (h_over_R**2)\n        elif method == \"LS\":\n            # For LS, epsilon_kappa = (alpha_L - beta_L * k_W^2) * (h/R)^2\n            epsilon_kappa = (alpha - beta * k_w**2) * (h_over_R**2)\n        else:\n            raise ValueError(\"Unknown method specified.\")\n\n        # 2. Calculate the predicted critical Weber number, We_crit_pred\n        we_crit_pred = we_crit_true * (1.0 + epsilon_kappa)\n\n        # 3. Calculate the maximum admissible mesh size, h_max\n        # Calculate capillary length, l_sigma\n        l_sigma = np.sqrt(sigma / (rho * a_val))\n        \n        # Calculate the effective error coefficient, C_eff\n        if method == \"VOF\":\n            c_eff = alpha\n        elif method == \"LS\":\n            c_eff = np.abs(alpha - beta * k_w**2)\n        \n        # Calculate h_max, handling the case C_eff = 0\n        if c_eff > 0:\n            h_max = l_sigma * np.sqrt(tau / c_eff)\n        else:\n            # If c_eff is 0, the error is always 0, so any mesh size is permitted.\n            h_max = float('inf')\n\n        # 4. Determine the pass indicator\n        pass_indicator = 1 if h_val = h_max else 0\n        \n        # Store the rounded results for the current case\n        results.append([\n            round(we_crit_pred, 6),\n            round(h_max, 6),\n            pass_indicator\n        ])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string.\n    # We replace 'inf' with a very large number for formatting if it occurs, but it doesn't for this test set.\n    formatted_results = []\n    for res in results:\n        we_pred, hmax, p = res\n        if hmax == float('inf'):\n             # Problem does not specify how to format infinity, but rounding will fail.\n             # Let's assume it should be represented as a very large number or a string.\n             # Given the test cases, this path is not taken.\n             hmax_str = \"inf\" \n        else:\n             hmax_str = f\"{hmax:.6f}\"\n        \n        formatted_results.append(f\"[{res[0]:.6f},{hmax_str},{res[2]}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3312887"}]}