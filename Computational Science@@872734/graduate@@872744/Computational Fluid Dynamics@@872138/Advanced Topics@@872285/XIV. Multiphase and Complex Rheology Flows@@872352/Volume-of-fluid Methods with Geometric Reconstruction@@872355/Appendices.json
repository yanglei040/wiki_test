{"hands_on_practices": [{"introduction": "We begin our hands-on exploration of the PLIC method by examining the most fundamental case: an interface oriented parallel to one of the computational cell's faces. This exercise establishes the direct, linear relationship between the volume fraction $F$ and the plane constant $\\alpha$ in this simplified geometry. Understanding this baseline scenario provides a crucial foundation before tackling more complex, arbitrary interface orientations. [@problem_id:3388579]", "problem": "Consider a single computational cell taken as the unit cube $[0,1]^{3}$ in a Volume-of-Fluid (VOF) method with Piecewise-Linear Interface Calculation (PLIC) geometric reconstruction. The reconstructed interface inside the cell is represented by a plane given by $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha$, where $\\mathbf{n}$ is a known unit normal vector and $\\alpha$ is an unknown scalar chosen so that the volume of the set $\\{ \\mathbf{x} \\in [0,1]^{3} : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha \\}$ equals the prescribed liquid volume fraction $F \\in [0,1]$. Assume that the liquid occupies the half-space on the side $\\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha$.\n\n1. Derive $\\alpha$ in terms of $F$ for the special case $\\mathbf{n}=(1,0,0)$ by equating the volume of the region $\\{(x,y,z)\\in[0,1]^3 : x \\le \\alpha\\}$ to $F$. You may assume $0 \\le \\alpha \\le 1$ and $0 \\le F \\le 1$ so that the plane intersects the cell and no saturation occurs at the cell boundaries.\n\n2. Generalize your derivation to any unit normal $\\mathbf{n}$ aligned with a coordinate axis, i.e., $\\mathbf{n}=\\mathbf{e}_{i}$ for $i \\in \\{1,2,3\\}$, with the liquid again on the side $\\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha$ and $0 \\le \\alpha \\le 1$.\n\nExpress your final answer as a single closed-form analytic expression for $\\alpha$ in terms of $F$ (no units required). No rounding is necessary.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It presents a simplified, yet fundamental, geometric problem from the field of computational fluid dynamics, specifically related to the Volume-of-Fluid (VOF) method with Piecewise-Linear Interface Calculation (PLIC).\n\nThe core task is to find the scalar plane constant $\\alpha$ for a given liquid volume fraction $F$. The interface is a plane described by $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha$ within a unit cube computational cell, $[0,1]^3$. The liquid is assumed to occupy the region defined by $\\{ \\mathbf{x} \\in [0,1]^{3} : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha \\}$. The total volume of the cell is $1^3 = 1$. Therefore, the volume of the liquid, $V$, is numerically equal to the volume fraction, $F$.\n$$V = F$$\nWe are asked to find $\\alpha$ such that the volume of the liquid region equals $F$. The volume $V$ is calculated by integrating over the portion of the unit cube where $\\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha$.\n\nPart 1: Derivation for $\\mathbf{n}=(1,0,0)$\n\nFor the special case where the unit normal vector is $\\mathbf{n} = (1,0,0)$, the planar interface equation $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha$ becomes:\n$$ (1,0,0) \\cdot (x,y,z) = x = \\alpha $$\nThe liquid region is defined by the set of points $\\mathbf{x}=(x,y,z)$ inside the unit cube that satisfy $x \\le \\alpha$. The full set of constraints for a point to be in the liquid region is:\n$$ 0 \\le x \\le 1 $$\n$$ 0 \\le y \\le 1 $$\n$$ 0 \\le z \\le 1 $$\n$$ x \\le \\alpha $$\nThe problem specifies the assumption that $0 \\le \\alpha \\le 1$. This ensures that the plane $x=\\alpha$ intersects the cube, creating a simple truncated volume. Combining the constraints on $x$, we have $0 \\le x \\le \\alpha$. The constraints on $y$ and $z$ remain $0 \\le y \\le 1$ and $0 \\le z \\le 1$.\n\nThe volume of this region, $V$, is given by the triple integral over these bounds:\n$$ V = \\int_0^1 \\int_0^1 \\int_0^\\alpha dx \\, dy \\, dz $$\nWe evaluate this integral step-by-step:\n$$ V = \\int_0^1 \\int_0^1 \\left[ x \\right]_0^\\alpha \\, dy \\, dz = \\int_0^1 \\int_0^1 (\\alpha - 0) \\, dy \\, dz = \\int_0^1 \\int_0^1 \\alpha \\, dy \\, dz $$\n$$ V = \\int_0^1 \\left[ \\alpha y \\right]_0^1 \\, dz = \\int_0^1 (\\alpha \\cdot 1 - \\alpha \\cdot 0) \\, dz = \\int_0^1 \\alpha \\, dz $$\n$$ V = \\left[ \\alpha z \\right]_0^1 = \\alpha \\cdot 1 - \\alpha \\cdot 0 = \\alpha $$\nThe volume of the liquid region is simply $V = \\alpha$. By equating this volume to the given liquid volume fraction $F$, we obtain the desired relationship:\n$$ \\alpha = F $$\n\nPart 2: Generalization for $\\mathbf{n} = \\mathbf{e}_i$\n\nWe now generalize the derivation for any unit normal vector $\\mathbf{n}$ aligned with a coordinate axis, i.e., $\\mathbf{n} = \\mathbf{e}_i$ for $i \\in \\{1, 2, 3\\}$, where $\\mathbf{e}_1=(1,0,0)$, $\\mathbf{e}_2=(0,1,0)$, and $\\mathbf{e}_3=(0,0,1)$ are the standard basis vectors.\n\nCase $i=1$: $\\mathbf{n} = \\mathbf{e}_1 = (1,0,0)$. This is the case solved in Part 1, which yielded $\\alpha = F$.\n\nCase $i=2$: $\\mathbf{n} = \\mathbf{e}_2 = (0,1,0)$. The liquid region condition is $\\mathbf{n} \\cdot \\mathbf{x} = y \\le \\alpha$. The integration bounds for the volume are $0 \\le x \\le 1$, $0 \\le y \\le \\alpha$ (using the assumption $0 \\le \\alpha \\le 1$), and $0 \\le z \\le 1$. The volume is:\n$$ V = \\int_0^1 \\int_0^\\alpha \\int_0^1 dx \\, dy \\, dz = \\int_0^1 \\int_0^\\alpha 1 \\, dy \\, dz = \\int_0^1 \\alpha \\, dz = \\alpha $$\nSetting $V=F$ yields $\\alpha = F$.\n\nCase $i=3$: $\\mathbf{n} = \\mathbf{e}_3 = (0,0,1)$. The liquid region condition is $\\mathbf{n} \\cdot \\mathbf{x} = z \\le \\alpha$. The integration bounds for the volume are $0 \\le x \\le 1$, $0 \\le y \\le 1$, and $0 \\le z \\le \\alpha$. The volume is:\n$$ V = \\int_0^\\alpha \\int_0^1 \\int_0^1 dx \\, dy \\, dz = \\int_0^\\alpha \\int_0^1 1 \\, dy \\, dz = \\int_0^\\alpha 1 \\, dz = \\alpha $$\nSetting $V=F$ again yields $\\alpha = F$.\n\nDue to the symmetry of the unit cube, the calculation is identical for any axis-aligned normal vector. In each case, the interface plane is parallel to a face of the cube, and the resulting liquid volume is a rectangular prism with a square base of area $1 \\times 1 = 1$ and a height of $\\alpha$. The volume is thus $1 \\times \\alpha = \\alpha$.\n\nTherefore, for any $\\mathbf{n} \\in \\{ \\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3 \\}$, subject to the constraint $0 \\le \\alpha \\le 1$, the scalar $\\alpha$ is related to the volume fraction $F$ by the same, simple linear expression. The final single closed-form expression for $\\alpha$ in terms of $F$ is $\\alpha = F$.", "answer": "$$\n\\boxed{F}\n$$", "id": "3388579"}, {"introduction": "Building on the simple axis-aligned case, we now consider a more challenging scenario with an oblique interface. This problem is specifically designed to demonstrate the power of geometric reasoning and symmetry arguments in solving for the plane constant $\\alpha$ without resorting to complex integration. By analyzing a diagonally oriented interface where the cell is perfectly half-full, you will see how physical intuition can lead to an elegant analytical solution. [@problem_id:3388584]", "problem": "Consider the Volume-of-Fluid (VOF) method with Piecewise Linear Interface Calculation (PLIC) reconstruction in a single cubic control volume of side length $1$ (the unit cube $[0,1]^{3}$). The interface inside the cell is represented by the plane with unit normal $\\mathbf{n}=\\left(1,1,1\\right)/\\sqrt{3}$ via $\\mathbf{n}\\cdot\\mathbf{x}=\\alpha$, and the fluid occupies the half-space $\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha$ intersected with the unit cube. The volume fraction is prescribed as $F=0.5$.\n\nUsing only fundamental definitions of the VOF volume fraction and geometric symmetry, do the following:\n\n1. Argue from symmetry what the value of $\\alpha$ must be, without evaluating any complicated integrals.\n2. Then verify your result by deriving an explicit analytic expression for the volume $V(\\alpha)$ of the region $\\{\\mathbf{x}\\in[0,1]^{3}:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha\\}$ in terms of $\\alpha$, using first principles. Your derivation must reduce the volume to a scalar integral over a cross-sectional area and evaluate it piecewise for the relevant range of $\\alpha$.\n3. From your explicit volume formula, confirm that the value of $\\alpha$ found by symmetry gives $V(\\alpha)=F$.\n\nExpress the final answer for $\\alpha$ as a single exact expression. No rounding is required and no units should be included in the final answer.", "solution": "We begin from the definition of the Volume-of-Fluid (VOF) fraction. In a control volume $\\Omega=[0,1]^{3}$, with an interface plane $\\mathbf{n}\\cdot\\mathbf{x}=\\alpha$ and unit normal $\\mathbf{n}=\\left(1,1,1\\right)/\\sqrt{3}$, the fluid region is the set\n$$\n\\Omega_{f}(\\alpha)=\\{\\mathbf{x}\\in[0,1]^{3}:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha\\}.\n$$\nThe VOF fraction $F$ is equal to the volume of the fluid region, $\\mathrm{meas}(\\Omega_f(\\alpha))$, because the total cell volume is 1. With $\\mathbf{n}=\\left(1,1,1\\right)/\\sqrt{3}$, the plane condition $\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha$ is equivalent to\n$$\n\\frac{x+y+z}{\\sqrt{3}}\\le \\alpha\\quad\\Longleftrightarrow\\quad x+y+z\\le s,\\quad s:=\\sqrt{3}\\,\\alpha.\n$$\nThus the fluid volume is a function of $s$:\n$$\nV(s)=\\mathrm{meas}\\left(\\{(x,y,z)\\in[0,1]^{3}:x+y+z\\le s\\}\\right),\n$$\nand we need to find $s$ such that $V(s) = F$.\n\n**Step 1: Symmetry Argument**\n\nConsider the transformation $T:[0,1]^{3}\\to[0,1]^{3}$ given by $T(x,y,z)=(1-x,1-y,1-z)$. This transformation reflects the cube through its center and preserves volume (it is a measure-preserving bijection). Under this transformation, the inequality defining the fluid region, $x+y+z\\le s$, becomes:\n$$\n(1-x')+(1-y')+(1-z')\\le s\\quad\\Longleftrightarrow\\quad 3-(x'+y'+z')\\le s\\quad\\Longleftrightarrow\\quad x'+y'+z'\\ge 3-s.\n$$\nThis means that the region of fluid with volume $V(s)$ is mapped to the region of non-fluid for a plane constant of $3-s$. The volume of the non-fluid region is $1-V(s)$. Therefore, we have the symmetry relation:\n$$\n1-V(s) = V(3-s) \\quad \\text{or} \\quad V(s)+V(3-s)=1.\n$$\nWe are given $F=0.5$, so we must solve $V(s)=0.5$. Substituting into the symmetry relation gives:\n$$\n0.5 + V(3-s) = 1 \\implies V(3-s) = 0.5.\n$$\nSince $V(s)$ is a strictly monotonically increasing function of $s$, the only way for $V(s)=V(3-s)$ to be true is if $s = 3-s$, which implies $2s=3$, or $s=3/2$.\nThus, by symmetry, the volume fraction is $0.5$ when $s=3/2$. Since $s=\\sqrt{3}\\,\\alpha$, we have:\n$$\n\\alpha=\\frac{s}{\\sqrt{3}}=\\frac{3/2}{\\sqrt{3}}=\\frac{\\sqrt{3}}{2}.\n$$\n\n**Step 2  3: Explicit Volume Calculation and Confirmation**\n\nTo verify this, we derive an explicit formula for $V(s)$. The volume can be computed by integrating the area of the cross-sections of the cube perpendicular to the vector $(1,1,1)$. Let $A(t)$ be the area of the cross-section defined by $\\{(x,y,z) \\in [0,1]^3 : x+y+z=t\\}$. The total volume is $V(s) = \\int_0^s A(t) dt$ (ignoring a constant scaling factor for now). A more direct method is to integrate over one coordinate:\n$$\nV(s)=\\int_{0}^{1} \\left( \\iint_{[0,1]^2} \\mathbf{1}_{\\{x+y \\le s-z\\}} dx dy \\right) dz = \\int_0^1 A_{\\text{2D}}(s-z) dz,\n$$\nwhere $A_{\\text{2D}}(t)$ is the area of the region $\\{(x,y)\\in[0,1]^2: x+y \\le t\\}$. This area function is:\n- $A_{\\text{2D}}(t) = 0$ for $t \\le 0$\n- $A_{\\text{2D}}(t) = t^2/2$ for $0 \\le t \\le 1$\n- $A_{\\text{2D}}(t) = 1 - (2-t)^2/2$ for $1 \\le t \\le 2$\n- $A_{\\text{2D}}(t) = 1$ for $t \\ge 2$\n\nWe need to evaluate $V(s)$ for $s=3/2$, which is in the range $[1, 2]$. For $s \\in [1,2]$, the variable $t=s-z$ ranges from $s$ (at $z=0$) down to $s-1$ (at $z=1$). We must split the integral at $z=s-1$ (where $t=1$):\n$$\nV(s) = \\int_0^{s-1} A_{\\text{2D}}(s-z) dz + \\int_{s-1}^1 A_{\\text{2D}}(s-z) dz\n$$\nIn the first integral, $z \\in [0, s-1]$, so $t=s-z \\in [1,s]$. Here $A_{\\text{2D}}(t) = 1-(2-t)^2/2$.\nIn the second integral, $z \\in [s-1, 1]$, so $t=s-z \\in [s-1,1]$. Here $A_{\\text{2D}}(t) = t^2/2$.\nChanging variables to $t=s-z$ (so $dz=-dt$):\n$$\nV(s) = \\int_s^1 \\left(1-\\frac{(2-t)^2}{2}\\right)(-dt) + \\int_1^{s-1} \\left(\\frac{t^2}{2}\\right)(-dt)\n$$\n$$\nV(s) = \\int_1^s \\left(1-\\frac{(4-4t+t^2)}{2}\\right) dt + \\int_{s-1}^1 \\frac{t^2}{2} dt = \\int_1^s \\left(2t - 1 - \\frac{t^2}{2}\\right) dt + \\int_{s-1}^1 \\frac{t^2}{2} dt\n$$\nEvaluating the integrals:\n$$\n\\int_1^s \\left(2t - 1 - \\frac{t^2}{2}\\right) dt = \\left[t^2 - t - \\frac{t^3}{6}\\right]_1^s = \\left(s^2 - s - \\frac{s^3}{6}\\right) - \\left(1-1-\\frac{1}{6}\\right) = s^2 - s - \\frac{s^3}{6} + \\frac{1}{6}\n$$\n$$\n\\int_{s-1}^1 \\frac{t^2}{2} dt = \\left[\\frac{t^3}{6}\\right]_{s-1}^1 = \\frac{1}{6} - \\frac{(s-1)^3}{6}\n$$\nCombining these gives:\n$$\nV(s) = s^2 - s - \\frac{s^3}{6} + \\frac{1}{6} + \\frac{1}{6} - \\frac{s^3-3s^2+3s-1}{6} = \\frac{6s^2-6s-s^3+1+1-(s^3-3s^2+3s-1)}{6}\n$$\n$$\nV(s) = \\frac{-2s^3+9s^2-9s+3}{6} = -\\frac{s^3}{3} + \\frac{3}{2}s^2 - \\frac{3}{2}s + \\frac{1}{2}\n$$\nNow, we confirm the value for $s=3/2$:\n$$\nV\\!\\left(\\frac{3}{2}\\right)=-\\frac{(3/2)^{3}}{3}+\\frac{3}{2}\\left(\\frac{3}{2}\\right)^{2}-\\frac{3}{2}\\left(\\frac{3}{2}\\right)+\\frac{1}{2}=-\\frac{27/8}{3}+\\frac{3}{2}\\frac{9}{4}-\\frac{9}{4}+\\frac{1}{2}\n$$\n$$\nV\\!\\left(\\frac{3}{2}\\right)=-\\frac{9}{8}+\\frac{27}{8}-\\frac{18}{8}+\\frac{4}{8} = \\frac{-9+27-18+4}{8} = \\frac{4}{8} = \\frac{1}{2}\n$$\nThis confirms that $s=3/2$ gives $F=0.5$. The plane constant is therefore $\\alpha = s/\\sqrt{3} = \\sqrt{3}/2$.", "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$", "id": "3388584"}, {"introduction": "In practical CFD applications, the interface normal vector can have any orientation, making purely analytical solutions for $\\alpha$ intractable. This final practice bridges the gap between theory and implementation by guiding you through the development of a robust numerical solver. You will derive the essential derivative of the volume with respect to the plane constant, $\\frac{dV}{d\\alpha}$, and then outline a Newton-Raphson iteration, the standard algorithm used in modern VOF codes to solve for $\\alpha$ in the general case. [@problem_id:3388660]", "problem": "Consider a Piecewise Linear Interface Calculation (PLIC) in three dimensions for a unit cube domain, defined as the Cartesian product $[0,1]\\times[0,1]\\times[0,1]$, and a plane interface described by the half-space $\\{\\mathbf{x}\\in\\mathbb{R}^3 \\mid \\mathbf{n}\\cdot\\mathbf{x} \\le \\alpha\\}$, where $\\mathbf{n}\\in\\mathbb{R}^3$ is a nonzero normal vector and $\\alpha\\in\\mathbb{R}$ is a scalar plane constant. Define the function $V(\\alpha;\\mathbf{n})$ to be the volume of the intersection of the unit cube with the half-space, that is,\n$$\nV(\\alpha;\\mathbf{n}) \\;=\\; \\int_{[0,1]^3} H\\!\\left(\\alpha - \\mathbf{n}\\cdot\\mathbf{x}\\right) \\, d\\mathbf{x},\n$$\nwhere $H(\\cdot)$ is the Heaviside step function. In Volume-of-Fluid reconstruction, given a desired volume fraction $F\\in[0,1]$ (dimensionless), one must determine $\\alpha$ such that $V(\\alpha;\\mathbf{n}) - F = 0$.\n\nYour tasks are:\n- Starting from the integral definition above and fundamental calculus, derive the expression for the derivative $dV/d\\alpha$ that is required to perform a Newton iteration for solving $V(\\alpha;\\mathbf{n}) - F = 0$.\n- Outline and implement a robust Newton iteration to solve for $\\alpha$ for general $\\mathbf{n}$ in a unit cube, using your derived $dV/d\\alpha$ and a numerically stable computation of $V(\\alpha;\\mathbf{n})$.\n\nImplementation requirements:\n- The program must treat the cube as $[0,1]^3$ and treat $\\mathbf{n}$ as a general nonzero vector (not necessarily unit length and with arbitrary signs).\n- The quantity $V(\\alpha;\\mathbf{n})$ must be computed numerically in a scientifically sound manner. You are required to compute $V(\\alpha;\\mathbf{n})$ by integrating the cross-sectional area $A(s;\\mathbf{n})$ of the polygon given by the intersection of the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ with the cube, from the minimal intersection level to $s=\\alpha$. That is, $V(\\alpha;\\mathbf{n})$ must be approximated via a composite numerical quadrature of the form\n$$\nV(\\alpha;\\mathbf{n}) \\approx \\int_{\\alpha_{\\min}}^{\\alpha} \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|}\\, ds,\n$$\nwhere $\\alpha_{\\min}$ is the minimal value of $\\mathbf{n}\\cdot\\mathbf{x}$ over the cube.\n- The derivative $dV/d\\alpha$ must be computed using the area of the slice at the level $\\alpha$.\n- The program must implement a combined Newton–bisection scheme to ensure convergence for all admissible cases, enforcing the bracket $[\\alpha_{\\min},\\alpha_{\\max}]$, where $\\alpha_{\\min}$ and $\\alpha_{\\max}$ are the minimum and maximum of $\\mathbf{n}\\cdot\\mathbf{x}$ over the cube, respectively.\n\nInitial guess and bracketing:\n- Use the monotone mapping initial guess\n$$\n\\alpha_0 \\;=\\; \\alpha_{\\min} + F\\,(\\alpha_{\\max} - \\alpha_{\\min}).\n$$\n- Maintain a bracket $[\\alpha_{\\min},\\alpha_{\\max}]$ with $V(\\alpha_{\\min};\\mathbf{n})=0$ and $V(\\alpha_{\\max};\\mathbf{n})=1$, and perform bisection whenever the Newton update leaves the bracket or does not reduce the residual.\n\nNumerical details:\n- The area $A(s;\\mathbf{n})$ of the intersection polygon must be computed by intersecting the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ with all $12$ cube edges to collect polygon vertices, followed by a projection to an orthonormal basis of the plane and evaluation of the polygon area via the shoelace formula. If there are fewer than $3$ intersection points, define $A(s;\\mathbf{n})=0$.\n- Define the tolerance for solving $V(\\alpha;\\mathbf{n}) - F = 0$ as $10^{-8}$ and the maximum number of Newton iterations as $50$. Use a composite Simpson’s rule with an even number of subintervals to evaluate the integral for $V(\\alpha;\\mathbf{n})$.\n\nTest suite:\n- Use the following set of test cases, each specified as a pair $(\\mathbf{n},F)$, where all quantities are dimensionless floats:\n  - Case $1$: $\\mathbf{n}=(0.3,\\,0.5,\\,0.4)$, $F=0.237$.\n  - Case $2$: $\\mathbf{n}=(-1.0,\\,0.5,\\,2.0)$, $F=0.5$.\n  - Case $3$: $\\mathbf{n}=(0.0,\\,1.0,\\,0.0)$, $F=0.25$.\n  - Case $4$: $\\mathbf{n}=(1.0,\\,-1.0,\\,0.0)$, $F=0.0$.\n  - Case $5$: $\\mathbf{n}=(2.0,\\,0.0,\\,-1.0)$, $F=1.0$.\n\nAnswer specification:\n- For each test case, compute the scalar $\\alpha$ that solves $V(\\alpha;\\mathbf{n}) - F = 0$ using your Newton–bisection solver. The final results must be returned as floats.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4,\\alpha_5]$.\n\nThere are no physical units involved in this problem; all quantities are dimensionless. Express all outputs as floats.", "solution": "The user wants to solve for a plane constant `alpha` that defines a specific volume fraction `F` inside a unit cube, as part of a Piecewise Linear Interface Calculation (PLIC) method. This involves two main tasks: deriving the derivative of the volume with respect to `alpha`, and implementing a numerical solver.\n\n### Problem Validation\nThe problem is first validated against the specified criteria.\n\n- **Givens Extraction**:\n  - Domain: Unit cube $[0,1]^3$.\n  - Interface: Half-space $\\{\\mathbf{x}\\in\\mathbb{R}^3 \\mid \\mathbf{n}\\cdot\\mathbf{x} \\le \\alpha\\}$.\n  - Volume function: $V(\\alpha;\\mathbf{n}) = \\int_{[0,1]^3} H(\\alpha - \\mathbf{n}\\cdot\\mathbf{x}) \\, d\\mathbf{x}$.\n  - Goal: Solve for $\\alpha$ such that $V(\\alpha;\\mathbf{n}) = F$ for a given volume fraction $F \\in [0,1]$ and normal vector $\\mathbf{n}$.\n  - Numerical Method: A hybrid Newton-bisection method is required.\n  - Volume computation: $V(\\alpha;\\mathbf{n})$ must be approximated numerically by integrating the cross-sectional area, $V(\\alpha;\\mathbf{n}) \\approx \\int_{\\alpha_{\\min}}^{\\alpha} \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|} ds$, using composite Simpson's rule.\n  - Derivative computation: $dV/d\\alpha$ is to be computed from the area of the slice at $\\alpha$.\n  - Initial Guess and Bracketing: The initial guess is $\\alpha_0 = \\alpha_{\\min} + F(\\alpha_{\\max} - \\alpha_{\\min})$, with the bracket $[\\alpha_{\\min}, \\alpha_{\\max}]$.\n  - Area computation: $A(s;\\mathbf{n})$ is found by intersecting the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ with the 12 cube edges, projecting the resulting vertices, and using the shoelace formula.\n  - Test cases and tolerances are specified.\n\n- **Validation Check**:\n  - The problem is **scientifically grounded** in computational fluid dynamics and VOF methods.\n  - It is **well-posed**; the volume function $V(\\alpha;\\mathbf{n})$ is continuous and monotonically increasing with $\\alpha$, guaranteeing a unique solution for $\\alpha$ for any given $F \\in [0,1]$.\n  - The description is **objective** and provides precise mathematical and algorithmic constraints.\n  - The provided formulation for $V(\\alpha;\\mathbf{n})$ as an integral of cross-sectional area is consistent with the integral definition involving the Heaviside function, as can be shown via the coarea formula. All definitions and constraints are self-consistent and complete.\n\n- **Verdict**: The problem is **valid**.\n\n### Part 1: Derivation of the Derivative $dV/d\\alpha$\n\nThe volume of the fluid, $V(\\alpha;\\mathbf{n})$, is defined by the integral of the scaled cross-sectional area function from the minimum possible value of $\\mathbf{n}\\cdot\\mathbf{x}$ up to the level $\\alpha$:\n$$\nV(\\alpha;\\mathbf{n}) = \\int_{\\alpha_{\\min}}^{\\alpha} \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|} ds\n$$\nwhere $A(s;\\mathbf{n})$ is the area of the polygon formed by the intersection of the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ with the unit cube, and $\\alpha_{\\min} = \\min_{\\mathbf{x} \\in [0,1]^3} (\\mathbf{n}\\cdot\\mathbf{x})$.\n\nTo find the derivative $dV/d\\alpha$, we apply the Leibniz integral rule for differentiating an integral with respect to its upper limit. Specifically, this is an application of the First Fundamental Theorem of Calculus.\nLet the integrand be $g(s) = \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|}$. The volume function is $V(\\alpha;\\mathbf{n}) = \\int_{\\alpha_{\\min}}^{\\alpha} g(s) ds$.\nThe derivative with respect to the upper limit $\\alpha$ is given by:\n$$\n\\frac{dV}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\int_{\\alpha_{\\min}}^{\\alpha} g(s) ds \\right)\n$$\nAssuming the integrand $g(s)$ is continuous at $s=\\alpha$, the theorem states that the derivative is simply the integrand evaluated at $\\alpha$:\n$$\n\\frac{dV}{d\\alpha} = g(\\alpha)\n$$\nSubstituting the expression for $g(s)$, we obtain the required derivative:\n$$\n\\frac{dV}{d\\alpha} = \\frac{A(\\alpha;\\mathbf{n})}{\\|\\mathbf{n}\\|}\n$$\nThis expression is fundamental to the Newton iteration, as it represents the rate of change of volume with respect to the plane's position, which is precisely the area of the cutting plane inside the domain, scaled by $1/\\|\\mathbf{n}\\|$ due to the projection inherent in the definition of $\\alpha$.\n\n### Part 2: Algorithmic Design and Implementation\n\nThe goal is to solve the nonlinear equation $f(\\alpha) = V(\\alpha;\\mathbf{n}) - F = 0$. A robust hybrid Newton-bisection algorithm is implemented.\n\n**1. Newton-Bisection Solver (`solve_for_alpha`)**\nThe solver iteratively finds the root $\\alpha$.\n- **Initialization**:\n  - The extrema $\\alpha_{\\min} = \\sum_i \\min(0, n_i)$ and $\\alpha_{\\max} = \\sum_i \\max(0, n_i)$ are computed. These define the search bracket $[\\alpha_{\\min}, \\alpha_{\\max}]$.\n  - Trivial cases $F=0$ and $F=1$ are handled directly, returning $\\alpha_{\\min}$ and $\\alpha_{\\max}$ respectively.\n  - The initial guess is set to $\\alpha_0 = \\alpha_{\\min} + F(\\alpha_{\\max} - \\alpha_{\\min})$.\n- **Iteration**: The loop continues until the residual $|V(\\alpha) - F|$ is below a tolerance ($10^{-8}$) or a maximum number of iterations ($50$) is reached.\n  - In each step $k$, the residual $f(\\alpha_k) = V(\\alpha_k;\\mathbf{n}) - F$ is computed.\n  - The derivative $f'(\\alpha_k) = dV/d\\alpha|_{\\alpha_k} = A(\\alpha_k;\\mathbf{n})/\\|\\mathbf{n}\\|$ is calculated.\n  - A Newton step is proposed: $\\alpha_{N} = \\alpha_k - f(\\alpha_k)/f'(\\alpha_k)$.\n  - **Hybrid Strategy**: If the Newton step $\\alpha_N$ falls outside the current bracket $[\\alpha_{\\text{low}}, \\alpha_{\\text{high}}]$ or if the derivative $f'(\\alpha_k)$ is close to zero, the method reverts to a bisection step: $\\alpha_{\\text{next}} = (\\alpha_{\\text{low}} + \\alpha_{\\text{high}})/2$. Otherwise, the Newton step is accepted: $\\alpha_{\\text{next}} = \\alpha_N$.\n  - **Bracket Update**: The bracket is narrowed by comparing the sign of the residual at the current iterate $\\alpha_k$. If $f(\\alpha_k)  0$, $\\alpha_k$ becomes the new lower bound $\\alpha_{\\text{low}}$; otherwise, it becomes the new upper bound $\\alpha_{\\text{high}}$.\n\n**2. Volume Computation (`compute_volume`)**\nThis function numerically computes $V(\\alpha;\\mathbf{n}) = \\int_{\\alpha_{\\min}}^{\\alpha} \\frac{A(s;\\mathbf{n})}{\\|\\mathbf{n}\\|} ds$.\n- It uses the composite Simpson's rule with a fixed number of even subintervals ($N=100$) for high accuracy. The function to be integrated, $A(s;\\mathbf{n})$, is piecewise quadratic, making Simpson's rule a highly effective choice.\n- The function discretizes the integration interval $[\\alpha_{\\min}, \\alpha]$ into $N$ subintervals and applies the weighted sum of integrand values at the sample points $s_i$. The integrand at each point is $\\frac{A(s_i;\\mathbf{n})}{\\|\\mathbf{n}\\|}$.\n\n**3. Cross-Sectional Area Computation (`compute_area`)**\nThis function is the geometric core of the algorithm. It computes $A(s;\\mathbf{n})$, the area of the polygon formed by the intersection of the plane $\\mathbf{n}\\cdot\\mathbf{x}=s$ and the unit cube.\n- **Vertex Finding**: The polygon's vertices are the intersection points of the plane with the $12$ edges of the cube. For each edge, parameterized as $\\mathbf{p}_0 + t\\mathbf{d}$ with $t \\in [0,1]$, the intersection parameter $t = (s - \\mathbf{n}\\cdot\\mathbf{p}_0)/(\\mathbf{n}\\cdot\\mathbf{d})$ is calculated. If $t \\in [0,1]$, the point is a vertex of the polygon. A small tolerance is used to handle floating-point inaccuracies. Duplicate vertices (arising from the plane intersecting a cube vertex) are removed.\n- **Area Calculation**: If fewer than $3$ vertices are found, the area is $0$. Otherwise:\n  - **Projection**: The 3D vertices are projected onto a 2D coordinate system. This is done by first defining an orthonormal basis $\\{\\mathbf{u}, \\mathbf{v}\\}$ for the plane.\n  - **Sorting**: The 2D vertices are sorted in angular order (e.g., counter-clockwise) around their centroid. This is essential for the shoelace formula. The angle is computed using `atan2`.\n  - **Shoelace Formula**: The area of the ordered 2D polygon $(x_0, y_0), \\dots, (x_{m-1}, y_{m-1})$ is calculated as Area $= \\frac{1}{2} |\\sum_{i=0}^{m-1} (x_i y_{i+1} - x_{i+1} y_i)|$, where $(x_m, y_m) = (x_0, y_0)$.\n\nThis structured, principle-based approach ensures a robust and accurate solution to the PLIC volume fraction problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n\n    # Cube vertices and edges for geometry calculations\n    CUBE_VERTICES = np.array([\n        [0, 0, 0], [1, 0, 0], [1, 1, 0], [0, 1, 0],\n        [0, 0, 1], [1, 0, 1], [1, 1, 1], [0, 1, 1]\n    ], dtype=float)\n\n    CUBE_EDGES = [\n        (0, 1), (1, 2), (2, 3), (3, 0),  # Bottom face\n        (4, 5), (5, 6), (6, 7), (7, 4),  # Top face\n        (0, 4), (1, 5), (2, 6), (3, 7)   # Vertical edges\n    ]\n\n    def get_alpha_minmax(n):\n        \"\"\"\n        Computes the minimum and maximum of n.x over the unit cube.\n        \"\"\"\n        alpha_min = sum(n[i] for i in range(3) if n[i]  0)\n        alpha_max = sum(n[i] for i in range(3) if n[i] > 0)\n        return alpha_min, alpha_max\n\n    def get_plane_basis(n):\n        \"\"\"\n        Computes an orthonormal basis {u, v} for the plane with normal n.\n        \"\"\"\n        n_norm = np.linalg.norm(n)\n        if n_norm  1e-12:\n            return None, None\n        n_hat = n / n_norm\n        \n        min_idx = np.argmin(np.abs(n_hat))\n        e = np.zeros(3)\n        e[min_idx] = 1.0\n        \n        u = np.cross(n_hat, e)\n        u /= np.linalg.norm(u)\n        \n        v = np.cross(n_hat, u)\n        return u, v\n\n    memo_area = {}\n    def compute_area(s, n):\n        \"\"\"\n        Computes the area of the polygon formed by intersecting the plane\n        n.x = s with the unit cube.\n        \"\"\"\n        n_tuple = tuple(n)\n        if (s, n_tuple) in memo_area:\n             return memo_area[(s, n_tuple)]\n\n        epsilon = 1e-9\n        intersection_points = []\n        \n        for v_start_idx, v_end_idx in CUBE_EDGES:\n            p0 = CUBE_VERTICES[v_start_idx]\n            d = CUBE_VERTICES[v_end_idx] - p0\n            \n            n_dot_d = np.dot(n, d)\n            \n            if abs(n_dot_d)  epsilon:\n                continue\n                \n            t = (s - np.dot(n, p0)) / n_dot_d\n            \n            if -epsilon = t = 1 + epsilon:\n                point = p0 + t * d\n                point = np.clip(point, 0, 1)\n\n                is_duplicate = any(np.linalg.norm(point - p_exist)  epsilon for p_exist in intersection_points)\n                if not is_duplicate:\n                    intersection_points.append(point)\n\n        if len(intersection_points)  3:\n            return 0.0\n\n        u, v = get_plane_basis(n)\n        if u is None: return 0.0\n\n        p0_ref = intersection_points[0]\n        projected_points = []\n        for p in intersection_points:\n            dp = p - p0_ref\n            projected_points.append((np.dot(dp, u), np.dot(dp, v)))\n        \n        centroid = np.mean(projected_points, axis=0)\n        projected_points.sort(key=lambda p: np.arctan2(p[1] - centroid[1], p[0] - centroid[0]))\n        \n        area = 0.0\n        num_verts = len(projected_points)\n        for i in range(num_verts):\n            p1 = projected_points[i]\n            p2 = projected_points[(i + 1) % num_verts]\n            area += p1[0] * p2[1] - p2[0] * p1[1]\n            \n        result = 0.5 * abs(area)\n        memo_area[(s, n_tuple)] = result\n        return result\n\n    memo_volume = {}\n    def compute_volume(alpha, n, N_simpson, F_ref):\n        \"\"\"\n        Computes the volume V(alpha; n) using composite Simpson's rule.\n        A reference F is passed to handle degenerate cases.\n        \"\"\"\n        n_tuple = tuple(n)\n        if (alpha, n_tuple) in memo_volume:\n            return memo_volume[(alpha, n_tuple)]\n\n        alpha_min, alpha_max = get_alpha_minmax(n)\n        norm_n = np.linalg.norm(n)\n\n        if norm_n  1e-12: return 0.5 if F_ref > 0.5 else 0.0\n        if alpha = alpha_min + 1e-9: return 0.0\n        if alpha >= alpha_max - 1e-9: return 1.0\n\n        h = (alpha - alpha_min) / N_simpson\n        s_points = np.linspace(alpha_min, alpha, N_simpson + 1)\n        \n        integrand_values = np.array([compute_area(s, n) for s in s_points]) / norm_n\n        \n        integral = integrand_values[0] + integrand_values[-1]\n        integral += 4 * np.sum(integrand_values[1:-1:2])\n        integral += 2 * np.sum(integrand_values[2:-2:2])\n        \n        result = integral * h / 3.0\n        memo_volume[(alpha, n_tuple)] = result\n        return result\n\n    def solve_for_alpha(n, F):\n        \"\"\"\n        Solves V(alpha; n) = F for alpha using a hybrid Newton-Bisection method.\n        \"\"\"\n        n = np.asarray(n, dtype=float)\n        alpha_min, alpha_max = get_alpha_minmax(n)\n\n        if F = 1e-9: return alpha_min\n        if F >= 1.0 - 1e-9: return alpha_max\n\n        tol = 1e-8\n        max_iter = 50\n        N_simpson = 100\n\n        alpha_low, alpha_high = alpha_min, alpha_max\n        alpha_k = alpha_min + F * (alpha_max - alpha_min)\n        \n        norm_n = np.linalg.norm(n)\n        if norm_n  1e-12:\n            return 0.0 # Degenerate case, n=0 -> n.x=0, V is step function at alpha=0\n\n        # Clear memos for each new case\n        memo_area.clear()\n        memo_volume.clear()\n\n        for _ in range(max_iter):\n            V_k = compute_volume(alpha_k, n, N_simpson=N_simpson, F_ref=F)\n            residual = V_k - F\n            \n            if abs(residual)  tol:\n                return alpha_k\n            \n            # Update bracket based on the current point\n            if residual  0:\n                alpha_low = alpha_k\n            else:\n                alpha_high = alpha_k\n\n            # Propose next step\n            area_k = compute_area(alpha_k, n)\n            dV_dalpha = area_k / norm_n if norm_n > 0 else 0.0\n            \n            use_bisection = False\n            if abs(dV_dalpha)  1e-12:\n                use_bisection = True\n            else:\n                delta_alpha = -residual / dV_dalpha\n                alpha_next_newton = alpha_k + delta_alpha\n                if not (alpha_low  alpha_next_newton  alpha_high):\n                    use_bisection = True\n            \n            if use_bisection:\n                alpha_k = (alpha_low + alpha_high) / 2.0\n            else:\n                alpha_k = alpha_next_newton\n        \n        return alpha_k\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        ((0.3, 0.5, 0.4), 0.237),\n        ((-1.0, 0.5, 2.0), 0.5),\n        ((0.0, 1.0, 0.0), 0.25),\n        ((1.0, -1.0, 0.0), 0.0),\n        ((2.0, 0.0, -1.0), 1.0),\n    ]\n\n    results = []\n    for n, F in test_cases:\n        alpha = solve_for_alpha(n, F)\n        results.append(alpha)\n\n    # Final print statement in the exact required format.\n    # Using 7 decimal places for consistent formatting, as requested by 'float' type\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```", "id": "3388660"}]}