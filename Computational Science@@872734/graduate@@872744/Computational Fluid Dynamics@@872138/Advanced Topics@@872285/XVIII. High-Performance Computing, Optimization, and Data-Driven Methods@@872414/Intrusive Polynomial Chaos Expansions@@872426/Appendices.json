{"hands_on_practices": [{"introduction": "The foundation of any Generalized Polynomial Chaos (gPC) method is a set of polynomials that are orthonormal with respect to the probability measure of the uncertain inputs. This property is crucial as it greatly simplifies the resulting stochastic Galerkin system, often diagonalizing the mass matrix. This first practice invites you to build this foundation from first principles by calculating the normalization constants for Legendre polynomials, the appropriate basis for uniformly distributed random variables as dictated by the Wiener-Askey scheme [@problem_id:3392649].", "problem": "Consider intrusive stochastic Galerkin methods in which a scalar random input is modeled by a uniform random variable $\\xi \\sim \\mathcal{U}(-1,1)$ with probability density function (PDF) $\\rho(\\xi)=\\frac{1}{2}$ for $\\xi \\in [-1,1]$ and $\\rho(\\xi)=0$ otherwise. In the Galerkin projection, the inner product is the expectation $\\mathbb{E}[\\cdot]$ with respect to $\\rho$, so for any square-integrable functions $f$ and $g$ the inner product is defined by $\\langle f, g \\rangle_{\\rho} := \\mathbb{E}[f(\\xi) g(\\xi)] = \\int_{-1}^{1} f(\\xi) g(\\xi) \\rho(\\xi) \\, \\mathrm{d}\\xi$. The polynomial basis is chosen from the classical Legendre polynomials $\\{P_n(\\xi)\\}_{n=0}^{\\infty}$ owing to their orthogonality under the uniform weight on $[-1,1]$. In many intrusive stochastic Galerkin formulations, such as those based on Generalized Polynomial Chaos (gPC), the basis is required to be orthonormal under $\\langle \\cdot, \\cdot \\rangle_{\\rho}$ to obtain simplified algebraic structures.\n\nStarting from the fundamental definitions above, determine the normalization constants $c_n$ such that the scaled basis functions $\\Psi_n(\\xi) := c_n P_n(\\xi)$ form an orthonormal system in $L^{2}_{\\rho}([-1,1])$, that is, $\\mathbb{E}[\\Psi_m(\\xi)\\Psi_n(\\xi)] = \\delta_{mn}$ where $\\delta_{mn}$ denotes the Kronecker delta. Then, using the same definitions, verify the expected-value identity $\\mathbb{E}[P_m(\\xi) P_n(\\xi)]$ in closed form. Your final answer must be the closed-form expression for $c_n$ in terms of $n$; no numerical approximation is required, and no units are involved.", "solution": "The problem will first be validated to ensure its scientific and logical integrity.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- A scalar random input is modeled by a uniform random variable $\\xi \\sim \\mathcal{U}(-1,1)$.\n- The probability density function (PDF) is $\\rho(\\xi)=\\frac{1}{2}$ for $\\xi \\in [-1,1]$ and $\\rho(\\xi)=0$ otherwise.\n- The inner product for square-integrable functions $f$ and $g$ is defined as the expectation $\\langle f, g \\rangle_{\\rho} := \\mathbb{E}[f(\\xi) g(\\xi)] = \\int_{-1}^{1} f(\\xi) g(\\xi) \\rho(\\xi) \\, \\mathrm{d}\\xi$.\n- The polynomial basis is the set of classical Legendre polynomials $\\{P_n(\\xi)\\}_{n=0}^{\\infty}$.\n- The scaled basis functions are $\\Psi_n(\\xi) := c_n P_n(\\xi)$, where $c_n$ are the normalization constants.\n- The orthonormality condition is $\\mathbb{E}[\\Psi_m(\\xi)\\Psi_n(\\xi)] = \\delta_{mn}$, where $\\delta_{mn}$ is the Kronecker delta.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is firmly rooted in the mathematical theory of uncertainty quantification, specifically using Generalized Polynomial Chaos (gPC) expansions with intrusive Galerkin methods. The use of Legendre polynomials as an orthogonal basis for a uniform random variable is a standard and correct application of the Askey scheme. All definitions and properties are consistent with established literature in this field.\n- **Well-Posed**: The problem is well-posed. It asks for the determination of normalization constants $c_n$ based on a clear and complete set of definitions, leading to a unique solution (conventionally, $c_n  0$).\n- **Objective**: The problem is stated using precise and objective mathematical language, free from any subjectivity or ambiguity.\n- **Completeness**: The problem provides all necessary information: the probability distribution, the definition of the inner product, the basis polynomials, and the orthonormality condition. It is self-contained.\n- **Consistency**: There are no internal contradictions. The definitions are standard and mutually compatible.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard and well-defined mathematical exercise in the context of spectral methods for uncertainty quantification. A full solution will be provided.\n\n**Solution Derivation**\n\nThe objective is to find the normalization constants $c_n$ such that the basis functions $\\Psi_n(\\xi) = c_n P_n(\\xi)$ are orthonormal with respect to the inner product defined by the expectation operator $\\mathbb{E}[\\cdot]$. The orthonormality condition is given as:\n$$\n\\mathbb{E}[\\Psi_m(\\xi)\\Psi_n(\\xi)] = \\delta_{mn}\n$$\nwhere $\\delta_{mn}$ is the Kronecker delta, which is $1$ if $m=n$ and $0$ if $m \\neq n$.\n\nSubstituting the definition of $\\Psi_n(\\xi)$ into the condition, we get:\n$$\n\\mathbb{E}[ (c_m P_m(\\xi)) (c_n P_n(\\xi)) ] = \\delta_{mn}\n$$\nSince $c_m$ and $c_n$ are deterministic constants, they can be factored out of the expectation:\n$$\nc_m c_n \\mathbb{E}[P_m(\\xi) P_n(\\xi)] = \\delta_{mn}\n$$\nNext, we evaluate the expectation term $\\mathbb{E}[P_m(\\xi) P_n(\\xi)]$ using its definition in terms of the probability density function $\\rho(\\xi)$. The random variable $\\xi$ is uniformly distributed on $[-1, 1]$, so its PDF is $\\rho(\\xi) = \\frac{1}{2}$ for $\\xi \\in [-1, 1]$.\n$$\n\\mathbb{E}[P_m(\\xi) P_n(\\xi)] = \\int_{-\\infty}^{\\infty} P_m(\\xi) P_n(\\xi) \\rho(\\xi) \\, \\mathrm{d}\\xi = \\int_{-1}^{1} P_m(\\xi) P_n(\\xi) \\left(\\frac{1}{2}\\right) \\, \\mathrm{d}\\xi\n$$\nFactoring out the constant $\\frac{1}{2}$:\n$$\n\\mathbb{E}[P_m(\\xi) P_n(\\xi)] = \\frac{1}{2} \\int_{-1}^{1} P_m(\\xi) P_n(\\xi) \\, \\mathrm{d}\\xi\n$$\nThis expression constitutes the verification of the expected-value identity requested in the problem. To evaluate it in closed form, we use the standard orthogonality property of the Legendre polynomials, which states:\n$$\n\\int_{-1}^{1} P_m(x) P_n(x) \\, \\mathrm{d}x = \\frac{2}{2n+1} \\delta_{mn}\n$$\nSubstituting this known result into our expression for the expectation gives the closed-form identity:\n$$\n\\mathbb{E}[P_m(\\xi) P_n(\\xi)] = \\frac{1}{2} \\left( \\frac{2}{2n+1} \\delta_{mn} \\right) = \\frac{1}{2n+1} \\delta_{mn}\n$$\nNow, we substitute this result back into the orthonormality condition for the scaled basis $\\Psi_n(\\xi)$:\n$$\nc_m c_n \\left( \\frac{1}{2n+1} \\delta_{mn} \\right) = \\delta_{mn}\n$$\nTo find the constants $c_n$, we consider the case where $m = n$. In this case, $\\delta_{nn} = 1$:\n$$\nc_n c_n \\left( \\frac{1}{2n+1} \\delta_{nn} \\right) = \\delta_{nn} \\implies c_n^2 \\left( \\frac{1}{2n+1} \\right) = 1\n$$\nSolving for $c_n^2$:\n$$\nc_n^2 = 2n+1\n$$\nBy convention, the normalization constant is taken to be the positive square root. Therefore:\n$$\nc_n = \\sqrt{2n+1}\n$$\nFor the case where $m \\neq n$, the orthogonality property ensures $\\delta_{mn} = 0$, leading to the identity $0 = 0$, which is consistent.\n\nThus, the orthonormal basis functions are $\\Psi_n(\\xi) = \\sqrt{2n+1} P_n(\\xi)$. The normalization constant $c_n$ depends only on the degree $n$ of the polynomial.", "answer": "$$\n\\boxed{\\sqrt{2n+1}}\n$$", "id": "3392649"}, {"introduction": "With an orthonormal basis in hand, the next step is to perform the \"intrusive\" Galerkin projection, which transforms the original stochastic partial differential equation (PDE) into a larger, coupled system of deterministic PDEs for the chaos coefficients. This practice provides a concrete look at this process for a wave equation with an uncertain wave speed. By calculating a specific entry of the stochastic coupling matrix, you will see directly how uncertainty in the model's parameters creates coupling between the deterministic equations governing the different chaos modes [@problem_id:2448421].", "problem": "Consider the one-dimensional wave equation with random wave speed\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t,\\xi) \\;=\\; c(\\xi)^{2}\\,\\frac{\\partial^{2} u}{\\partial x^{2}}(x,t,\\xi),\n$$\non the spatial domain $x\\in(0,L)$ and time $t\\ge 0$, subject to homogeneous Dirichlet boundary conditions $u(0,t,\\xi)=0$ and $u(L,t,\\xi)=0$, and initial conditions $u(x,0,\\xi)=u_{0}(x)$ and $\\frac{\\partial u}{\\partial t}(x,0,\\xi)=v_{0}(x)$, where $u_{0}$ and $v_{0}$ are deterministic functions. The wave speed is modeled as an affine random field\n$$\nc(\\xi) \\;=\\; c_{0} \\,+\\, \\sigma\\,\\xi,\n$$\nwhere $c_{0}0$, $\\sigma\\ge 0$, and $\\xi$ is a standard normal random variable with probability density $\\rho(\\xi)=\\frac{1}{\\sqrt{2\\pi}}\\exp(-\\xi^{2}/2)$. Consider the generalized Polynomial Chaos (gPC) expansion truncated at total order $p=2$,\n$$\nu(x,t,\\xi) \\;=\\; \\sum_{k=0}^{2} u_{k}(x,t)\\,\\psi_{k}(\\xi),\n$$\nwith the orthonormal probabilists’ Hermite basis $\\{\\psi_{k}\\}_{k=0}^{2}$ under the standard normal measure defined by\n$$\n\\psi_{0}(\\xi)=1,\\quad \\psi_{1}(\\xi)=\\xi,\\quad \\psi_{2}(\\xi)=\\frac{\\xi^{2}-1}{\\sqrt{2}},\n$$\nand the inner product $\\langle f,g\\rangle = \\int_{\\mathbb{R}} f(\\xi)\\,g(\\xi)\\,\\rho(\\xi)\\,\\mathrm{d}\\xi$.\n\nFormulate the intrusive Galerkin system governing the deterministic coefficient fields $\\{u_{k}(x,t)\\}_{k=0}^{2}$ by enforcing orthogonality of the residual to the stochastic basis $\\{\\psi_{i}\\}_{i=0}^{2}$. Let the stochastic coupling matrix entries be\n$$\nA_{ij} \\;=\\; \\int_{\\mathbb{R}} c(\\xi)^{2}\\,\\psi_{i}(\\xi)\\,\\psi_{j}(\\xi)\\,\\rho(\\xi)\\,\\mathrm{d}\\xi \\;=\\; \\mathbb{E}\\big[c(\\xi)^{2}\\,\\psi_{i}(\\xi)\\,\\psi_{j}(\\xi)\\big],\\quad i,j\\in\\{0,1,2\\}.\n$$\n\nProvide a single closed-form analytic expression for the entry $A_{11}$. Your final answer must be a single analytic expression. Do not include units. Do not round.", "solution": "The problem is subjected to validation before a solution is attempted.\n\nFirst, the givens are extracted verbatim from the problem statement.\n- The governing partial differential equation is $\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t,\\xi) = c(\\xi)^{2}\\,\\frac{\\partial^{2} u}{\\partial x^{2}}(x,t,\\xi)$.\n- The spatial domain is $x\\in(0,L)$ and time is $t\\ge 0$.\n- Boundary conditions are homogeneous Dirichlet: $u(0,t,\\xi)=0$ and $u(L,t,\\xi)=0$.\n- Initial conditions are deterministic: $u(x,0,\\xi)=u_{0}(x)$ and $\\frac{\\partial u}{\\partial t}(x,0,\\xi)=v_{0}(x)$.\n- The wave speed is an affine random field: $c(\\xi) = c_{0} + \\sigma\\,\\xi$, where $c_{0}0$ and $\\sigma\\ge 0$.\n- The random variable $\\xi$ is standard normal, with probability density function $\\rho(\\xi)=\\frac{1}{\\sqrt{2\\pi}}\\exp(-\\xi^{2}/2)$.\n- The generalized Polynomial Chaos (gPC) expansion is truncated at order $p=2$: $u(x,t,\\xi) = \\sum_{k=0}^{2} u_{k}(x,t)\\,\\psi_{k}(\\xi)$.\n- The basis functions are orthonormal probabilists' Hermite polynomials: $\\psi_{0}(\\xi)=1$, $\\psi_{1}(\\xi)=\\xi$, $\\psi_{2}(\\xi)=\\frac{\\xi^{2}-1}{\\sqrt{2}}$.\n- The stochastic inner product is defined as $\\langle f,g\\rangle = \\int_{\\mathbb{R}} f(\\xi)\\,g(\\xi)\\,\\rho(\\xi)\\,\\mathrm{d}\\xi$.\n- The stochastic coupling matrix entries are defined as $A_{ij} = \\mathbb{E}\\big[c(\\xi)^{2}\\,\\psi_{i}(\\xi)\\,\\psi_{j}(\\xi)\\big]$ for $i,j\\in\\{0,1,2\\}$.\n- The objective is to find a closed-form analytic expression for the entry $A_{11}$.\n\nSecond, the problem is validated against the required criteria.\n- **Scientifically Grounded:** The problem is a standard application of the intrusive Galerkin method with Polynomial Chaos expansion to a wave equation with stochastic coefficients. This is a fundamental and well-established technique in computational engineering for uncertainty quantification. The mathematical and physical framework is sound.\n- **Well-Posed:** The problem is well-posed. It asks for the calculation of a specific matrix element, $A_{11}$, which is defined by a precise integral (expectation). All necessary components for this calculation are provided.\n- **Objective:** The problem is stated using precise, objective, and unambiguous mathematical language.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity. It is a formalizable and verifiable mathematical problem directly relevant to the specified field.\n\nThe verdict is that the problem is **valid**. We proceed with the derivation.\n\nThe objective is to compute the matrix element $A_{11}$ of the stochastic coupling matrix $A$. By definition, for $i,j \\in \\{0, 1, 2\\}$, the entries are given by:\n$$\nA_{ij} = \\mathbb{E}\\big[c(\\xi)^{2}\\,\\psi_{i}(\\xi)\\,\\psi_{j}(\\xi)\\big]\n$$\nWe are asked to find the specific entry $A_{11}$, which corresponds to setting $i=1$ and $j=1$:\n$$\nA_{11} = \\mathbb{E}\\big[c(\\xi)^{2}\\,\\psi_{1}(\\xi)\\,\\psi_{1}(\\xi)\\big] = \\mathbb{E}\\big[c(\\xi)^{2}\\,(\\psi_{1}(\\xi))^{2}\\big]\n$$\nThe problem provides the expressions for the random wave speed $c(\\xi)$ and the basis function $\\psi_{1}(\\xi)$:\n$$\nc(\\xi) = c_{0} + \\sigma\\,\\xi\n$$\n$$\n\\psi_{1}(\\xi) = \\xi\n$$\nSubstituting these expressions into the formula for $A_{11}$ yields:\n$$\nA_{11} = \\mathbb{E}\\big[(c_{0} + \\sigma\\,\\xi)^{2}\\,\\xi^{2}\\big]\n$$\nWe expand the squared term $(c_{0} + \\sigma\\,\\xi)^{2}$:\n$$\n(c_{0} + \\sigma\\,\\xi)^{2} = c_{0}^{2} + 2c_{0}\\sigma\\xi + \\sigma^{2}\\xi^{2}\n$$\nThe expression for $A_{11}$ becomes:\n$$\nA_{11} = \\mathbb{E}\\big[(c_{0}^{2} + 2c_{0}\\sigma\\xi + \\sigma^{2}\\xi^{2})\\,\\xi^{2}\\big]\n$$\nDistributing the $\\xi^{2}$ term inside the expectation gives:\n$$\nA_{11} = \\mathbb{E}\\big[c_{0}^{2}\\xi^{2} + 2c_{0}\\sigma\\xi^{3} + \\sigma^{2}\\xi^{4}\\big]\n$$\nBy the linearity of the expectation operator, we can write:\n$$\nA_{11} = \\mathbb{E}[c_{0}^{2}\\xi^{2}] + \\mathbb{E}[2c_{0}\\sigma\\xi^{3}] + \\mathbb{E}[\\sigma^{2}\\xi^{4}]\n$$\nThe constants $c_{0}$ and $\\sigma$ can be factored out of the expectations:\n$$\nA_{11} = c_{0}^{2}\\,\\mathbb{E}[\\xi^{2}] + 2c_{0}\\sigma\\,\\mathbb{E}[\\xi^{3}] + \\sigma^{2}\\,\\mathbb{E}[\\xi^{4}]\n$$\nTo evaluate this expression, we must compute the moments of the standard normal random variable $\\xi \\sim \\mathcal{N}(0,1)$. The $n$-th central moment of a Gaussian distribution with mean $\\mu$ and standard deviation $\\varsigma$ is $\\mathbb{E}[(\\xi - \\mu)^n]$. For a standard normal distribution, $\\mu=0$ and $\\varsigma=1$, so the central moments are simply the raw moments $\\mathbb{E}[\\xi^{n}]$.\nThe moments are given by:\n- $\\mathbb{E}[\\xi^{n}] = 0$ for all odd integers $n$.\n- $\\mathbb{E}[\\xi^{n}] = (n-1)!! = (n-1)(n-3)\\cdots 1$ for all even integers $n$.\n\nUsing these properties, we find the required moments:\n- The second moment (variance): $\\mathbb{E}[\\xi^{2}] = (2-1)!! = 1$.\n- The third moment (skewness is zero): $\\mathbb{E}[\\xi^{3}] = 0$.\n- The fourth moment (related to kurtosis): $\\mathbb{E}[\\xi^{4}] = (4-1)!! = 3 \\cdot 1 = 3$.\n\nSubstituting these moment values back into the expression for $A_{11}$:\n$$\nA_{11} = c_{0}^{2}(1) + 2c_{0}\\sigma(0) + \\sigma^{2}(3)\n$$\nSimplifying this expression leads to the final result:\n$$\nA_{11} = c_{0}^{2} + 3\\sigma^{2}\n$$\nThis is the closed-form analytic expression for the stochastic coupling matrix entry $A_{11}$.", "answer": "$$\n\\boxed{c_{0}^{2} + 3\\sigma^{2}}\n$$", "id": "2448421"}, {"introduction": "Intrusive gPC methods are renowned for their rapid \"spectral\" convergence, but this efficiency hinges on the solution being a smooth function of the underlying random variables. This final practice explores a critical failure mode that occurs in many CFD applications: the formation of shocks in nonlinear hyperbolic systems. Using the inviscid Burgers' equation as a model problem, you will investigate how the random formation time of a shock introduces a discontinuity into the stochastic space, destroying the smooth dependency and leading to a dramatic loss of spectral convergence [@problem_id:3337860].", "problem": "Consider the one-dimensional inviscid Burgers equation with a convex quadratic flux on a spatially periodic domain,\n$$u_t + \\left(\\tfrac{1}{2} u^2\\right)_x = 0,$$\nposed for $x \\in [0,1]$ with periodic boundary conditions and dimensionless variables. The initial condition is uncertain and given by\n$$u(x,0,\\xi) = A(\\xi)\\sin(2\\pi x),$$\nwhere $\\xi \\in [-1,1]$ is a uniform random variable with probability density $ \\rho(\\xi) = \\tfrac{1}{2}$, and the random amplitude is\n$$A(\\xi) = A_0 + A_1 \\xi,$$\nwith $A_0$ and $A_1$ deterministic constants. Expand $u(x,t,\\xi)$ in a Generalized Polynomial Chaos (gPC) basis using orthonormal Legendre polynomials $\\{\\phi_n(\\xi)\\}_{n=0}^P$ on $[-1,1]$ with weight $\\rho(\\xi)$, such that\n$$\\int_{-1}^1 \\phi_m(\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,\\mathrm{d}\\xi = \\delta_{mn},$$\nand write\n$$u(x,t,\\xi) = \\sum_{n=0}^P u_n(x,t)\\,\\phi_n(\\xi).$$\nBy performing a Stochastic Galerkin (SG) projection of the Burgers equation onto each basis function $\\phi_k(\\xi)$, derive the coupled deterministic partial differential equation system for the chaos coefficients $\\{u_k(x,t)\\}_{k=0}^P$ in conservative form. In particular, express the nonlinear flux coupling through triple-product coefficients\n$$C_{kmn} = \\int_{-1}^1 \\phi_k(\\xi)\\phi_m(\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,\\mathrm{d}\\xi,$$\nand show that the SG system can be written as\n$$\\partial_t u_k(x,t) + \\partial_x\\left(\\tfrac{1}{2}\\sum_{m=0}^P\\sum_{n=0}^P u_m(x,t)u_n(x,t)\\,C_{kmn}\\right) = 0,\\quad k=0,1,\\dots,P.$$\nNext, analyze spectral convergence in the chaos basis with respect to random shock formation. For inviscid Burgers, shock formation time depends on the initial slope and thus on the random amplitude $A(\\xi)$. Fix a spatial point $x_* \\in [0,1]$ and consider times $t0$. Define the pointwise chaos coefficients\n$$u_n(x_*,t) = \\int_{-1}^1 u(x_*,t,\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,\\mathrm{d}\\xi.$$\nFor $t$ strictly less than the minimal shock time over $\\xi \\in [-1,1]$, the mapping $\\xi \\mapsto u(x_*,t,\\xi)$ is smooth, and the coefficients $\\{u_n(x_*,t)\\}$ should decay rapidly with $n$. When $t$ exceeds the shock time for part of the support of $\\xi$, the dependence $\\xi \\mapsto u(x_*,t,\\xi)$ may become non-smooth due to entropy shocks crossing $x_*$ at $\\xi$-dependent times, and the coefficient decay slows significantly.\n\nImplement a program to:\n- Construct orthonormal Legendre gPC basis functions $\\{\\phi_n(\\xi)\\}_{n=0}^P$ on $[-1,1]$ with respect to $\\rho(\\xi)=\\tfrac{1}{2}$.\n- Compute triple-product coefficients $C_{kmn}$ by numerical quadrature over $\\xi \\in [-1,1]$.\n- For the physical solution $u(x,t,\\xi)$, avoid solving the SG system, and instead compute the exact entropy solution of inviscid Burgers via the Lax–Oleinik variational principle. Define the primitive of the initial condition\n$$G(y;\\xi) = \\int_0^y A(\\xi)\\sin(2\\pi s)\\,\\mathrm{d}s = -\\frac{A(\\xi)}{2\\pi}\\cos(2\\pi y) + \\frac{A(\\xi)}{2\\pi},$$\nand evaluate, for fixed $x_*$ and $t0$, the entropy solution at $x_*$ by\n$$u(x_*,t,\\xi) = \\frac{x_* - y^*(x_*,t;\\xi)}{t},$$\nwhere $y^*(x_*,t;\\xi)$ minimizes\n$$h(y;x_*,t;\\xi) = G(y;\\xi) + \\frac{(x_* - y)^2}{2t}, \\quad y \\in [0,1],$$\nover one period. For $t=0$, use $u(x_*,0,\\xi) = A(\\xi)\\sin(2\\pi x_*)$.\n- Project $u(x_*,t,\\xi)$ onto the gPC basis by numerical quadrature in $\\xi$ to obtain $\\{u_n(x_*,t)\\}_{n=0}^P$.\n\nTo quantify spectral convergence, define the tail energy for orders $n \\in \\{P_{\\mathrm{low}},\\dots,P_{\\mathrm{high}}\\}$,\n$$E_{\\mathrm{tail}}(t;P_{\\mathrm{low}},P_{\\mathrm{high}}) = \\sum_{n=P_{\\mathrm{low}}}^{P_{\\mathrm{high}}} \\left|u_n(x_*,t)\\right|.$$\nUse the following test suite of dimensionless parameters:\n- Basis and quadrature:\n  - Use orthonormal Legendre polynomials, i.e., $\\phi_n(\\xi) = \\sqrt{2n+1}P_n(\\xi)$ where $P_n(\\xi)$ is the $n$th Legendre polynomial.\n  - Use $Q_\\xi = 101$-point Gauss–Legendre quadrature in $\\xi$, with weights scaled by $\\rho(\\xi)=\\tfrac{1}{2}$.\n- Physical and random parameters:\n  - $A_0 = 1.0$, $A_1 = 0.5$.\n  - $x_* = 0.3$.\n  - Consider times $t \\in \\{0.0,\\,0.05,\\,0.12,\\,0.35\\}$.\n- Projection and tail measurement:\n  - Use maximum chaos order $P_{\\mathrm{high}} = 20$ and $P_{\\mathrm{low}} = 10$.\n  - For the Lax–Oleinik minimization, discretize $y \\in [0,1]$ with $N_y = 1024$ equispaced points.\n\nYour program must compute $E_{\\mathrm{tail}}(t;10,20)$ at the specified times, in the listed order. All quantities are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$). Each $r_i$ must be a floating-point number representing $E_{\\mathrm{tail}}(t_i;10,20)$ for the corresponding test case. The numerical method must be robust and scientifically consistent with the described physical model and projections; results must be obtained by first principles as described, without heuristic shortcuts.", "solution": "The problem requires the derivation of a Stochastic Galerkin (SG) system for the one-dimensional inviscid Burgers equation with an uncertain initial condition, followed by a numerical analysis of the spectral convergence of its Generalized Polynomial Chaos (gPC) expansion. The analysis focuses on the behavior of the gPC coefficients as shocks form in the physical solution.\n\nThe governing equation is the inviscid Burgers equation:\n$$\n\\partial_t u + \\partial_x \\left(\\frac{1}{2} u^2\\right) = 0\n$$\non the domain $x \\in [0,1]$ with periodic boundary conditions. The uncertainty is introduced through the initial condition:\n$$\nu(x,0,\\xi) = A(\\xi)\\sin(2\\pi x)\n$$\nwhere $\\xi$ is a random variable uniformly distributed on $[-1,1]$, with probability density function (PDF) $\\rho(\\xi) = 1/2$. The amplitude $A(\\xi) = A_0 + A_1 \\xi$ is a linear function of $\\xi$.\n\nThe solution $u(x,t,\\xi)$ is expanded in a gPC basis using orthonormal Legendre polynomials, $\\{\\phi_n(\\xi)\\}_{n=0}^P$. These basis functions are orthonormal with respect to the inner product weighted by the PDF $\\rho(\\xi)$:\n$$\n\\langle \\phi_m, \\phi_n \\rangle_{\\rho} = \\int_{-1}^1 \\phi_m(\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,\\mathrm{d}\\xi = \\delta_{mn}\n$$\nThe gPC expansion of the solution is:\n$$\nu(x,t,\\xi) = \\sum_{n=0}^P u_n(x,t)\\,\\phi_n(\\xi)\n$$\nwhere $u_n(x,t)$ are the deterministic chaos coefficients.\n\nFirst, we derive the SG system as requested. We substitute the gPC expansion into the Burgers equation:\n$$\n\\partial_t \\left(\\sum_{n=0}^P u_n \\phi_n\\right) + \\partial_x \\left[\\frac{1}{2} \\left(\\sum_{n=0}^P u_n \\phi_n\\right)^2\\right] = 0\n$$\nSince the basis functions $\\phi_n(\\xi)$ are independent of $x$ and $t$, the derivatives can be moved inside the summation:\n$$\n\\sum_{n=0}^P (\\partial_t u_n) \\phi_n + \\partial_x \\left[\\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n \\phi_m \\phi_n\\right] = 0\n$$\nThis equation represents the residual of the PDE in the gPC basis. The Stochastic Galerkin method projects this residual onto each basis function $\\phi_k(\\xi)$ for $k=0,1,\\dots,P$. The projection is defined by taking the inner product $\\langle \\cdot, \\phi_k \\rangle_{\\rho}$:\n$$\n\\left\\langle \\sum_{n=0}^P (\\partial_t u_n) \\phi_n, \\phi_k \\right\\rangle_{\\rho} + \\left\\langle \\partial_x \\left[\\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n \\phi_m \\phi_n\\right], \\phi_k \\right\\rangle_{\\rho} = 0\n$$\nFor the linear term, we use the linearity of the inner product and the orthonormality of the basis:\n$$\n\\sum_{n=0}^P (\\partial_t u_n) \\langle \\phi_n, \\phi_k \\rangle_{\\rho} = \\sum_{n=0}^P (\\partial_t u_n) \\delta_{nk} = \\partial_t u_k\n$$\nFor the nonlinear flux term, the spatial derivative $\\partial_x$ can be moved outside the integral operator as it acts on variables independent of $\\xi$:\n$$\n\\partial_x \\left\\langle \\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n \\phi_m \\phi_n, \\phi_k \\right\\rangle_{\\rho} = \\partial_x \\left[\\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n \\int_{-1}^1 \\phi_k(\\xi)\\phi_m(\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,\\mathrm{d}\\xi\\right]\n$$\nThe integral is the triple-product coefficient $C_{kmn}$. Substituting this definition, the nonlinear term becomes:\n$$\n\\partial_x \\left(\\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n C_{kmn}\\right)\n$$\nCombining the projected terms, we obtain the coupled system of deterministic PDEs for the chaos coefficients $\\{u_k(x,t)\\}$, as required:\n$$\n\\partial_t u_k(x,t) + \\partial_x\\left(\\frac{1}{2}\\sum_{m=0}^P\\sum_{n=0}^P u_m(x,t)u_n(x,t)\\,C_{kmn}\\right) = 0, \\quad k=0,1,\\dots,P\n$$\nThis completes the theoretical derivation.\n\nThe numerical task is to analyze the spectral convergence of the gPC expansion. Instead of numerically solving the complex SG system, we are instructed to compute the exact entropy solution of the Burgers equation for each realization of $\\xi$ and then project this solution onto the gPC basis. This non-intrusive approach allows for accurate assessment of the coefficient decay.\n\nThe entropy solution is found using the Lax–Oleinik variational principle. For a given spatial point $x_*$ and time $t0$, the solution $u(x_*, t, \\xi)$ is given by:\n$$\nu(x_*,t,\\xi) = \\frac{x_* - y^*(x_*,t;\\xi)}{t}\n$$\nwhere $y^*(x_*,t;\\xi)$ is the value of $y \\in [0,1]$ that minimizes the function:\n$$\nh(y;x_*,t;\\xi) = G(y;\\xi) + \\frac{(x_* - y)^2}{2t}\n$$\nHere, $G(y;\\xi)$ is the primitive of the initial velocity profile, $u(y,0,\\xi)$:\n$$\nG(y;\\xi) = \\int_0^y u(s,0,\\xi)\\,\\mathrm{d}s = \\int_0^y A(\\xi)\\sin(2\\pi s)\\,\\mathrm{d}s = -\\frac{A(\\xi)}{2\\pi}\\cos(2\\pi y) + \\frac{A(\\xi)}{2\\pi}\n$$\nFor a fixed $\\xi$, $x_*$, and $t$, the value of $y^*$ is found by a numerical minimization of $h(y;\\dots)$ over a discretized grid of $y$ values in the periodic domain $[0,1]$. For the special case $t=0$, the solution is simply the initial condition evaluated at $x_*$.\n\nOnce the solution $u(x_*, t, \\xi)$ is known as a function of $\\xi$, the gPC coefficients $u_n(x_*, t)$ are computed by projection:\n$$\nu_n(x_*,t) = \\langle u(x_*,t,\\xi), \\phi_n(\\xi) \\rangle_{\\rho} = \\int_{-1}^1 u(x_*,t,\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,\\mathrm{d}\\xi\n$$\nThis integral is computed numerically using Gauss-Legendre quadrature. The orthonormal Legendre polynomials for the weight $\\rho(\\xi)=1/2$ are $\\phi_n(\\xi) = \\sqrt{2n+1}P_n(\\xi)$, where $P_n$ is the standard $n$-th Legendre polynomial.\n\nFinally, to quantify the spectral convergence, the tail energy $E_{\\mathrm{tail}}$ is calculated as:\n$$\nE_{\\mathrm{tail}}(t;P_{\\mathrm{low}},P_{\\mathrm{high}}) = \\sum_{n=P_{\\mathrm{low}}}^{P_{\\mathrm{high}}} \\left|u_n(x_*,t)\\right|\n$$\nThis measures the energy contained in the higher-order modes of the expansion. For smooth functions of $\\xi$, the coefficients $u_n$ decay rapidly, and $E_{\\mathrm{tail}}$ is small. When shocks form, the dependence of the solution $u(x_*,t,\\xi)$ on $\\xi$ becomes non-smooth, leading to a slower decay of coefficients and a larger $E_{\\mathrm{tail}}$. The implementation will follow these steps for the specified parameters.", "answer": "```python\nimport numpy as np\nfrom scipy.special import legendre\n\ndef solve():\n    \"\"\"\n    Computes the tail energy of a gPC expansion for the 1D inviscid Burgers\n    equation with an uncertain initial condition at specified times.\n    \"\"\"\n    # Problem Parameters\n    A0 = 1.0\n    A1 = 0.5\n    x_star = 0.3\n    times_to_test = [0.0, 0.05, 0.12, 0.35]\n    P_low = 10\n    P_high = 20\n    P = P_high  # Maximum chaos order\n    \n    # Numerical Method Parameters\n    Q_xi = 101  # Number of quadrature points for xi\n    N_y = 1024  # Number of grid points for y minimization\n\n    # --- Pre-computation Step ---\n\n    # 1. Orthonormal Legendre basis functions phi_n(xi) = sqrt(2n+1) * P_n(xi)\n    # P_n(xi) are standard Legendre polynomials.\n    # Pre-generate callable polynomial objects for efficiency.\n    legendre_polys = [legendre(n) for n in range(P + 1)]\n    def evaluate_phi_n(n, xi_values):\n        return np.sqrt(2 * n + 1) * legendre_polys[n](xi_values)\n\n    # 2. Gauss-Legendre quadrature for integrals over xi in [-1, 1]\n    # The integral to compute is integral(f(xi) * rho(xi) * dxi) where rho(xi) = 1/2.\n    # The standard quadrature approximates integral(g(xi) * dxi).\n    # So, we use g(xi) = f(xi)/2. The weights must be scaled by 1/2.\n    xi_q, w_q_std = np.polynomial.legendre.leggauss(Q_xi)\n    quad_weights = w_q_std / 2.0\n\n    # 3. Pre-evaluate basis functions at all quadrature points\n    phi_at_quad_points = np.zeros((P + 1, Q_xi))\n    for n in range(P + 1):\n        phi_at_quad_points[n, :] = evaluate_phi_n(n, xi_q)\n\n    # 4. Discretization grid for the minimization problem in y\n    y_grid = np.linspace(0, 1, N_y)\n\n    # --- Helper functions for the Lax-Oleinik solution ---\n    \n    def get_amplitude(xi):\n        return A0 + A1 * xi\n\n    def G_potential(y, xi_val):\n        \"\"\"Primitive of the initial condition.\"\"\"\n        A_val = get_amplitude(xi_val)\n        return -A_val / (2 * np.pi) * (np.cos(2 * np.pi * y) - 1.0)\n\n    def h_function(y, t, xi_val):\n        \"\"\"Function to be minimized for the Lax-Oleinik solution.\"\"\"\n        return G_potential(y, xi_val) + (x_star - y)**2 / (2 * t)\n\n    # --- Main computation loop ---\n\n    results = []\n    \n    for t in times_to_test:\n        # Array to store the solution u(x_star, t, xi) at each quadrature point\n        u_at_quad_points = np.zeros(Q_xi)\n\n        if t == 0.0:\n            # For t=0, the solution is the initial condition\n            A_vals = get_amplitude(xi_q)\n            u_at_quad_points = A_vals * np.sin(2 * np.pi * x_star)\n        else:\n            # For t>0, use the Lax-Oleinik formula\n            for i, xi_val in enumerate(xi_q):\n                # Evaluate h over the y_grid for the current xi_val\n                h_vals_at_y = h_function(y_grid, t, xi_val)\n                \n                # Find the y that minimizes h\n                min_idx = np.argmin(h_vals_at_y)\n                y_star = y_grid[min_idx]\n                \n                # Compute the solution u\n                u_at_quad_points[i] = (x_star - y_star) / t\n\n        # Project u(x_star, t, xi) onto the gPC basis to find coefficients u_n\n        # u_n = integral( u(xi) * phi_n(xi) * rho(xi) dxi )\n        # Numerically: u_n = sum over q of ( u(xi_q) * phi_n(xi_q) * w_q' )\n        # Vectorized computation for all coefficients u_0, ..., u_P\n        u_coeffs = phi_at_quad_points @ (u_at_quad_points * quad_weights)\n        \n        # Calculate the tail energy\n        tail_energy = np.sum(np.abs(u_coeffs[P_low : P_high + 1]))\n        results.append(tail_energy)\n    \n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3337860"}]}